123
Keping Long
Victor C. M. Leung
Haijun Zhang
Zhiyong Feng
Yonghui Li 
Zhongshan Zhang (Eds.)
5G for Future 
Wireless Networks
First International Conference, 5GWN 2017
Beijing, China, April 21–23, 2017
Proceedings
211

Lecture Notes of the Institute
for Computer Sciences, Social Informatics
and Telecommunications Engineering
211
Editorial Board
Ozgur Akan
Middle East Technical University, Ankara, Turkey
Paolo Bellavista
University of Bologna, Bologna, Italy
Jiannong Cao
Hong Kong Polytechnic University, Hong Kong, Hong Kong
Geoffrey Coulson
Lancaster University, Lancaster, UK
Falko Dressler
University of Erlangen, Erlangen, Germany
Domenico Ferrari
Università Cattolica Piacenza, Piacenza, Italy
Mario Gerla
UCLA, Los Angeles, USA
Hisashi Kobayashi
Princeton University, Princeton, USA
Sergio Palazzo
University of Catania, Catania, Italy
Sartaj Sahni
University of Florida, Florida, USA
Xuemin Sherman Shen
University of Waterloo, Waterloo, Canada
Mircea Stan
University of Virginia, Charlottesville, USA
Jia Xiaohua
City University of Hong Kong, Kowloon, Hong Kong
Albert Y. Zomaya
University of Sydney, Sydney, Australia

More information about this series at http://www.springer.com/series/8197

Keping Long
• Victor C. M. Leung
Haijun Zhang
• Zhiyong Feng
Yonghui Li
• Zhongshan Zhang (Eds.)
5G for Future
Wireless Networks
First International Conference, 5GWN 2017
Beijing, China, April 21–23, 2017
Proceedings
123

Editors
Keping Long
University of Science and Technology
Beijing
China
Victor C. M. Leung
The University of British Columbia
Vancouver, BC
Canada
Haijun Zhang
University of Science and Technology
Beijing
China
Zhiyong Feng
Beijing University of Posts
and Telecommunications
Beijing
China
Yonghui Li
Centre of Excellence in Telecommunications
The University of Sydney
Maze Crescent
Australia
Zhongshan Zhang
University of Science and Technology
Beijing
China
ISSN 1867-8211
ISSN 1867-822X
(electronic)
Lecture Notes of the Institute for Computer Sciences, Social Informatics
and Telecommunications Engineering
ISBN 978-3-319-72822-3
ISBN 978-3-319-72823-0
(eBook)
https://doi.org/10.1007/978-3-319-72823-0
Library of Congress Control Number: 2017962877
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of the
material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microﬁlms or in any other physical way, and transmission or information
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology now
known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication
does not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this book are
believed to be true and accurate at the date of publication. Neither the publisher nor the authors or the editors
give a warranty, express or implied, with respect to the material contained herein or for any errors or
omissions that may have been made. The publisher remains neutral with regard to jurisdictional claims in
published maps and institutional afﬁliations.
Printed on acid-free paper
This Springer imprint is published by Springer Nature
The registered company is Springer International Publishing AG
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland

Preface
The EAI International Conference on 5G for Future Wireless Networks (5GWN) is a
comprehensive conference that focuses on 5G wireless networks. The main objective of
5GWN 2017, the ﬁrst conference in the series, was to address and deliberate on the
latest technical status and recent trends in the research and application of 5G
technologies.
5GWN 2017 provided an opportunity for scientists, engineers, industrialists,
scholars, and other professionals from all over the world to interact and exchange new
ideas and research outcomes in related ﬁelds and to pursue possibilities for future
collaboration. The conference is also aimed at gathering research contributions from
the ﬁeld of 5G wireless networks that address the major opportunities and challenges in
applying 5G technologies to the understanding and designing of modern network
systems, with an emphasis on both new analytical techniques and novel application
scenarios.
The proceedings contain 64 papers that were selected from a total of 135 papers
submitted to the conference. In the proceedings, readers can gather cutting-edge
knowledge about the future 5G wireless networks. Each paper was presented, orally or
as a poster, in the frame of the new analytical techniques and novel application
scenarios, with topics on 5G networks including: non-orthogonal multiple access
techniques;
cognitive
radio;
channel
modeling;
D2D;
performance
analysis;
cloud/CRAN-based 5G Networks; small cells; game theory; software-deﬁned net-
works; heterogeneous networks; 5G ultra dense networks; self-organizing networks;
network function virtualization; backhaul/fronthaul; resource allocation; big data;
vehicular networks; massive MIMO; IoT; energy harvesting; radio resource manage-
ment; caching; unlicensed spectrum (LTE-U); network slicing; full duplex techniques;
and MmWave techniques.
We would like to express our grateful thanks to the conference program chairs and
committee members, and all the reviewers for their great professionalism and efforts in
reviewing the submitted papers. We also thank all the participants and sponsors for
their valuable contributions to and support of 5GWN 2017.
14th December 2017
Keping Long
Victor C. M. Leung
Haijun Zhang
Zhiyong Feng
Yonghui Li
Zhongshan Zhang

Organization
Steering Committee
Steering Committee Chair
Imrich Chlamtac
CREATE-NET, Italy
Steering Committee
Victor C. M. Leung
The University of British Columbia, Canada
Haijun Zhang
The University of British Columbia, Canada
Organizing Committee
General Chairs
Keping Long
University of Science and Technology Beijing, China
Victor C. M. Leung
The University of British Columbia, Canada
Haijun Zhang
University of Science and Technology Beijing, China
Technical Program Committee Chairs
Zhiyong Feng
Beijing University of Posts and Telecommunications,
China
Yonghui Li
The University of Sydney, Australia
Zhongshan Zhang
University of Science and Technology Beijing, China
Symposium Chairs
PHY and Massive MIMO Symposium
Feifei Gao
Tsinghua University, China
Gang Wu
UESTC, China
Chengwen Xing
BIT, China
Kai Niu
BUPT, China
Wireless Access Technology and Heterogeneous Networks Symposium
Lingyang Song
Peking University, China
Tianyu Wang
University of California-Davis, USA
Chen Xu
North China Electric Power University, China
5G Networks Symposium
Xiang Cheng
Peking University, China
Chuan Huang
UESTC, China
Xiaotian Zhou
Shandong University, China

Communications Software, Services and SDN Symposium
Liang Zhou
Nanjing University of Posts and Telecommunications,
China
Joel Rodrigues
University of Beira Interior, Portugal
Han Hu
Nanyang Technological University, Singapore
Future Trends and Emerging Technologies Symposium
Yongle Wu
Beijing University of Posts and Telecommunications,
China
Shaoyong Zheng
Sun Yat-Sen University, China
Wenhua Chen
Tsinghua University, China
Workshops Chairs
Zhengguo Sheng
University of Sussex, UK
Lexi Xu
China Unicom, China
Publicity and Social Media Chair
Chunsheng Zhu
UBC, Canada
Sponsorship and Exhibits Chair
Renchao Xie
Beijing University of Posts and Telecommunications,
China
Publications Chair
Chao Xu
Xidian University, China
Tutorials Chair
Chunxiao Jiang
Tsinghua University, China
Local Chairs
Yu Qiu
BUCT, China
Yanliang Chen
BUCT, China
Web Chair
Baobao Wang
BUCT, China
Conference Manager
Lenka Oravska
EAI - European Alliance for Innovation
VIII
Organization

Technical Program Committee
Alagan Anpalagan
Ryerson University, Canada
Mehdi Bennis
University of Oulu, Finland
Shengrong Bu
The University of Glasgow, UK
Wei Chen
Beijing Jiaotong University, China
Xianfu Chen
VTT Technical Research Centre of Finland, Finland
Zhiyong Chen
Shanghai Jiaotong University, China
Xiaoli Chu
University of Shefﬁeld, UK
Lingjie Duan
Singapore University of Technology and Design
Lisheng Fan
Guangzhou University, China
Luoyi Fu
Shanghai Jiaotong University, China
Lin Gao
Chinese University of Hong Kong, SAR China
Fengkui Gong
Xidian University, China
Weisi Guo
University of Warwick, UK
Chunlong He
Shenzhen University, China
Mingyi Hong
Iowa State University, USA
Ekram Hossian
University of Manitoba, Canada
Wen Ji
Chinese Academy of Sciences, China
Chunxiao Jiang
Tsinghua University, China
Long Le
University of Quebec, Canada
Yuan Luo
Chinese University of Hong Kong, SAR China
Dusit Niyato
Nanyang Technological University, Singapore
Miao Pan
University of Houston, USA
Anibal Sanjab
Virignia Tech, USA
Omid Semiari
Virginia Tech, USA
Derrick Wing Kwan Ng
University of New South Wales, Australia
Wei Wang
University of Zhejiang, China
Yong Xiao
University of Houston, USA
Renchao Xie
Beijing University of Posts and Telecommunications,
China
Chungang Yang
Xidian University, Xi’an, China
Guanding Yu
University of Zhejiang, China
Daqiang Zhang
Tongji University, China
Guopeng Zhang
China University of Mining and Technology, China
Tiankui Zhang
BUPT, China
Wensheng Zhang
Shandong University, China
Yan Zhang
Simula Research Laboratory, Norway
Yanru Zhang
University of Houston, USA
Organization
IX

Contents
28 GHz MIMO Channel Characteristics Analysis for 5G
Communication Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
Suiyan Geng, Ningning Fan, Rui Zhang, and Xiongwen Zhao
A Caching Strategy Based on User Interest in Content-Centric Network . . . .
8
Yuehua Huo, Yanyu Sun, Yu Zhang, Donglin Cui, Weiqiang Fan,
and Yinlong Liu
Node Localization Based on Multiple Radio Transmission Power Levels
for Wireless Sensor Networks. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
19
Yikang Xing, Wei Huangfu, Xiaoming Dai, and Xiaoyan Hu
End-to-End Transmission Performance Optimization Based Routing
Selection Algorithm for Software Defined Networking. . . . . . . . . . . . . . . . .
28
Guixiang Jiang, Rong Chai, and Haipeng Li
Research on Video Services with QoE Perception Over Future
Wireless Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
Qinghua Zhu, Jinglu Zhang, Gongsheng Zhu, and Xiaokui Chen
Tree-LSTM Guided Attention Pooling of DCNN for Semantic
Sentence Modeling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
Liu Chen, Guangping Zeng, Qingchuan Zhang, and Xingyu Chen
Multi-base Station Energy Cooperation Based on Nash
Q-Learning Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
Yabo Lv, Baogang Li, Wei Zhao, Dandan Guo, and Yuanbin Yao
Crowdfunding Assisted Cellular System Analysis and Application . . . . . . . .
69
Mingqiang Yuan, Xinzhou Cheng, Tao Zhang, Yongfeng Wang, Lexi Xu,
Chen Cheng, Haina Ye, and Weiwei Chen
SWAT Hydrological Model and Big Data Techniques . . . . . . . . . . . . . . . . .
79
Xi Guo, Biao Wang, Wei Xiong, and Shisheng Jin
A Survey on Security Issues in Big Data of Ubiquitous Network . . . . . . . . .
89
Yuehua Huo, Yanyu Sun, Weiqiang Fan, Xinzhou Cheng, Dong Li,
and Yinlong Liu
Telecom Big Data Based User Analysis and Application
in Telecom Industry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
Guanglu Shao, Weiwei Chen, Xinzhou Cheng, Lexi Xu, Tao Zhang,
and Chen Cheng

Coverage Optimization in Self-organizing Small Cells . . . . . . . . . . . . . . . . .
110
Yu Chen, Wei Li, Xiuqing Yang, Yi Hu, and Qinghua Zhu
Expectation Maximization for Multipath Detection in Wideband Signals . . . .
120
Salem Salem and Mohamed El-Tarhuni
Dynamic Resource Orchestration of Service Function Chaining in Network
Function Virtualizations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
132
Bangchao Yu, Wei Zheng, Xiangming Wen, Zhaoming Lu, Luhan Wang,
and Lu Ma
Support Recovery for Multiband Spectrum Sensing Based on Modulated
Wideband Converter with SwSOMP Algorithm . . . . . . . . . . . . . . . . . . . . .
146
Zhuhua Hu, Yong Bai, Yaochi Zhao, and Yiran Zhang
Traffic Scheduling Algorithms for OFDM Based Radio Systems. . . . . . . . . .
160
Liang Li, Yirong Wang, Hao Zhang, Zhaoyan Qu, Siyuan Zhang,
Yu Zhang, and Xiongwen Zhao
Coverage Performance in Cognitive Radio Networks with Self-sustained
Secondary Transmitters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
170
Xiaoshi Song, Xiangbo Meng, Yuting Geng, Ning Ye, and Jun Liu
A Novel Algorithm of UAV-Mounted Base Station Placement
and Frequency Allocation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
182
Xu Shen, Zhiqing Wei, and Zhiyong Feng
Throughput Analysis for Full-Duplex Based
Device-to-Device Communications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
194
Yajun Shang, Xuehan Meng, Xiaomeng Chai, Tong Liu,
and Zhongshan Zhang
Joint Mode Selection and Resource Allocation in Underlaying
D2D Communication. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
206
Wei Zhang, Wanbing He, Dan Wu, and Yueming Cai
PAPR Reduction with Amplitude Clipping and Subband Filter
in Filtered-OFDM System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
220
Changsen Nie and Yong Bai
Throughput Maximization for Two-Hop Decode-and-Forward Relay
Channels with Non-ideal Circuit Power . . . . . . . . . . . . . . . . . . . . . . . . . . .
228
Hengjing Liang, Xiaojie Wen, Chuan Huang, Zhi Chen, and Shaoqian Li
Big Data-Driven Vehicle Mobility Analysis and Design for 5G . . . . . . . . . .
238
Ruoxi Sun, Kai Zhang, and Yong Ren
XII
Contents

Complexity Analysis of Massive MIMO Signal Detection Algorithms
Based on Factor Graph . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
246
Zhichao Yao, Chao Dong, Kai Niu, and Zhiqiang He
Per-Antenna Maximum Likelihood Detector for Massive MIMO. . . . . . . . . .
257
Senjie Zhang, Zhiqiang He, and Baoyu Tian
Joint User-Association and Resource-Allocation in Virtualized C-RAN . . . . .
265
Xiaohong Zhang, Yong Li, and Mugen Peng
Adaptive Resource Allocation for Device-to-Device Aided
Cellular Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
276
Xianxian Wang, Shaobo Lv, Xiaoyu Liang, Tong Liu, Hongwen Cheng,
and Zhongshan Zhang
A Utility-Based Resource Allocation in Virtualized Cloud
Radio Access Network. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
288
Linna Chen, Chunjing Hu, Yong Li, and Wenbo Wang
Iterative Receiver with Gaussian and Mean-Field Approximation
in Massive MIMO Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
300
Sheng Wu, Linling Kuang, Xincong Lin, and Baosheng Sun
Research and Application of Summer High Temperature Prediction Model
Based on CART Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
317
Yujie Guan, Wei Wang, Fengchang Xue, and Shoudong Liu
Research on Peak-to-Average Power Ratio Reduction for FBMC-Based
5G Transmission. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
327
Wenwan You, Junqi Guo, Ke Shan, and Rongfang Bie
A Machine Learning Based Engine Error Detection Method. . . . . . . . . . . . .
338
Xinsong Cheng, Liang Zhao, Na Lin, Changqing Gong,
and Ruiqing Wang
Beamforming Design for Physical Layer Security and Energy Efficiency
Based on Base Station Cooperation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
347
Wei Zhao, Hao Zhang, Hui Bao, and Baogang Li
A Survey on Big Data Analytics Technologies . . . . . . . . . . . . . . . . . . . . . .
359
Fei Su, Zhenya Wang, Shan Yang, Ke Li, Xin Lu, Yang Wu, and Yi Peng
Classification of Medical Consultation Text Using Mobile Agent System
Based on Naïve Bayes Classifier. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
371
Xingyu Chen, Guangping Zeng, Qingchuan Zhang, Liu Chen,
and Zhuolin Wang
Contents
XIII

Low-Complexity MMSE Signal Detection Based on the AOR Iterative
Algorithm for Uplink Massive MIMO Systems. . . . . . . . . . . . . . . . . . . . . .
385
Zhenyu Zhang, Yuanyuan Dong, Zhongshan Zhang, Xiyuan Wang,
Xiaoming Dai, Linglong Dai, and Haijun Zhang
Outage Performance for IDF Relaying Mobile Cooperative Networks . . . . . .
395
Lingwei Xu, Jingjing Wang, Yun Liu, Jie Yang, Wei Shi,
and T. Aaron Gulliver
AES and SNOW 3G are Feasible Choices for a 5G Phone
from Energy Perspective . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
403
Mohsin Khan and Valtteri Niemi
LR-RZF Pre-coding for Massive MIMO Systems Based on Truncated
Polynomial Expansion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
413
Chi Zhang, Zhengquan Li, Yaoyao Sun, Lianfeng Shen, and Xinxin Ni
A Geographic Packet Forwarding Approach in 3D Mobile
Ad Hoc Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
420
Xiaolin Gao, Guiting Zhong, Jian Yan, and Jianhua Lu
Probabilistic Caching in Wireless Device to Device Networks
with Contention Based Multimedia Delivery. . . . . . . . . . . . . . . . . . . . . . . .
429
Xiaoshi Song, Yuting Geng, Xiangbo Meng, Ning Ye, Jun Liu,
and Weimin Lei
Eigenvalue and Capacity Analysis Based on Measurement of Massive
MIMO System at 3.5 GHZ. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
445
Ruijie Xu, Jianhua Zhang, and Jie Xi
Power Allocation for Downlink of Non-orthogonal Multiple Access System
via Genetic Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
459
Xinli Ma, Juan Wu, Zhenyu Zhang, Zhongshan Zhang, Xiyuan Wang,
Xiaomeng Chai, Linglong Dai, and Xiaoming Dai
Research on the Interference and Coexistence of CBTC in 1.8 GHz Band . . .
471
Ruichen Xu, Xiao Peng, Xiaobo Wang, Ji Fang, and Bo Yuan
Joint C-V-BLAST and DS-NOMA for Massive MIMO . . . . . . . . . . . . . . . .
484
Khawla A. Alnajjar and Mohamed El-Tarhuni
Low-Complexity Equalization of Continuous Phase Modulation Using
Message Passing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
493
Jian Zhang, Zuyao Ni, Sheng Wu, and Linling Kuang
Range-Difference Based Resource Allocation Scheme for D2D-Aided
Heterogeneous Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
506
Shaobo Lv, Xianxian Wang, Hongwen Cheng, and Zhongshan Zhang
XIV
Contents

LTE-WLAN Integrated Virtualization Network Architecture . . . . . . . . . . . . .
517
Fenglin Dai, Qixun Zhang, Yuhang Sun, and Mengyuan Liu
A Phase Difference Based Cooperative Spectrum Sensing Scheme
for Cognitive Radio Network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
529
Zheng Xie, Sai Huang, Yifan Zhang, and Zhiyong Feng
Power Allocation for NOMA System via Dual Sub-gradient Descent. . . . . . .
544
Juan Wu, Xinli Ma, Zhenyu Zhang, Zhongshan Zhang, Xiyuan Wang,
Xiaomeng Chai, Linglong Dai, and Xiaoming Dai
A Differential QAM Scheme for Uplink Massive MIMO Systems. . . . . . . . .
556
Peng Zhang, Shuaishuai Guo, and Haixia Zhang
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network . . . . . . .
568
Daxin Tian, Ziyi Dai, Kunxian Zheng, Jianshan Zhou, Xuting Duan,
Peng Guo, Hui Rong, Wenyang Wang, and Haijun Zhang
A Novel Intrusion Detection System Based on Advanced Naive
Bayesian Classification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
581
Yunpeng Wang, Yuzhou Li, Daxin Tian, Congyu Wang, Wenyang Wang,
Rong Hui, Peng Guo, and Haijun Zhang
Power Allocation in One-Way Untrusted AF Relay System
with Friendly Jamming . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
589
Ronghua Luo, Chao Meng, Guobing Hu, and Hua Shi
A Vehicular Positioning Enhancement with Connected Vehicle Assistance
Using Extended Kalman Filtering . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
597
Daxin Tian, Wenhao Liu, Xuting Duan, Hui Rong, Peng Guo,
Wenyang Wang, and Haijun Zhang
A Multi-queue Aggregation Framework for M2M Traffic in LTE-A
and Beyond Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
609
Wen Feng, Hongjia Li, Ding Tang, Liming Wang, and Zhen Xu
Millimeter Wave Mobile Network with Full-Duplex Mode. . . . . . . . . . . . . .
622
Baiqing Zong, Xiaohong Zhang, Jianli Wang, Xiaotong Li,
and Zhiyong Zhao
Modeling and Simulation on Cooperative Movement of Vehicle Group
Based on the Behavior of Fish . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
630
Daxin Tian, Lu Kang, Kunxian Zheng, Xuting Duan, Hui Rong,
Peng Guo, Wenyang Wang, and Haijun Zhang
Contents
XV

Propagation Characteristics in Indoor Scenario with Different Transmitter
Locations at 3.5 and 6 GHz . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
640
Xinzhuang Zhang, Yawei Yu, Lei Tian, Yu Han, Yu Zhang,
and Jianhua Zhang
Social-Aware Data Caching Mechanism in D2D-Enabled
Cellular Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
650
Miao Liu, Jun Li, Tingting Liu, and Youjia Chen
Two-Tier Matching Game Design for Wireless Caching
in Pico-Cell Networks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
663
Guowei Shi, Jun Li, Haijun Zhang, Feng Shu, and Tingting Liu
A Resource Allocation Scheme Based on Genetic Algorithm for D2D
Communications Underlaying Multi-channel Cellular Networks . . . . . . . . . .
675
Ying Sun, Xijun Yan, Xujie Li, Yan Gu, and Chenming Li
Comparison of Isotropic and 3D Beamforming LTE Systems
Using Simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
685
Cheng Xu and John Cosmas
Author Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
695
XVI
Contents

28 GHz MIMO Channel Characteristics
Analysis for 5G Communication Systems
Suiyan Geng1(&), Ningning Fan1, Rui Zhang2, and Xiongwen Zhao1,2
1 North China Electric Power University, Beijing 102206, China
gsuiyan@ncepu.edu.cn
2 National Key Laboratory of Electromagnetic Environment,
China Research Institute of Radiowave Propagation, Qingdao 266107, China
Abstract. In this paper, 28 GHz MIMO channel capacity and characteristics
are analyzed, based on indoor propagation measurements carried out for both
LOS and NLOS scenarios. Speciﬁcally, MIMO channel link budget, capacity,
path loss, K-factor and delay spreads are studied based on experimental data.
Results show that Gigabit capacity can be achieved in 28 GHz channel with
MIMO (1  4) conﬁguration in indoor corridor. RMS delay spread depends on
both the size and scenario (LOS and NLOS) of environments. CDF of K-factor
can be ﬁtted with normal distribution in the LOS corridor. The provided
parameters are useful for design of 5G wireless communication systems.
Keywords: Multiple-In Multiple-Out (MIMO)  Channel capacity
Link budget  Path loss  K-factor  Delay spread
1
Introduction
Gigabit millimeter wave indoor M2M (Machine-to-machine) communication technol-
ogy is rising all over the world [1, 2]. At present, many countries and regions in the
world have assigned 26 GHz to 38 GHz frequency band to the wireless broadband
application in the local multipoint distribution system (Multipoint Distribution Systems
Local, LMDS) [3, 4]. In particular, the FCC is proposing the use of spectrum at
Ka-band (28 GHz and 39 GHz bands) for 5G mobile communications. At this fre-
quency, the free space wavelength around 10 mm, enabling phased array antennas that
can provide the bandwidth and be small enough to ﬁt into mobile devices such as
laptops, tablets and smartphones.
Multiple-in multiple-out (MIMO) technology has become one of the key tech-
nologies in the ﬁeld of wireless communications. With the continuous development in
recent years, MIMO technology will be more and more applied to a variety of wireless
communication systems. In the wireless broadband access system, IEEE 802.16e,
802.11n and 802.20 which are being developed also adopt MIMO technology. MIMO
technology can make full use of space resources and multiple antennas to improve the
system capacity several times without increasing the spectrum resources or antenna
transmit power.
The 28 GHz outdoor channel modeling has been studied in [5–7]. However, litter
information on indoor channel characteristics in open literature. In this paper, the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 1–7, 2018.
https://doi.org/10.1007/978-3-319-72823-0_1

28 GHz indoor MIMO channel capacity and characteristics are analyzed based on
experimental measurements performed for both LOS and NLOS scenarios, for pro-
viding useful information on design of radio systems.
2
Measurement Environment and Campaigns
The 28 GHz indoor channel measurements were performed for both LOS and NLOS
corridors in North China Electric power University (NCEPU). In the measurement,
MIMO antennas were employed, i.e. antenna elements at transmitter (TX) and receiver
(RX) are of 1 and 4 denoted as MIMO (1  4). In the measurements, the TX was ﬁxed
at certain position at the end of the corridor, and the RX was replaced with different
positions along both LOS and NLOS routes. Figure 1 shows the measurement envi-
ronment and scenarios. Speciﬁcally, 11 LOS positions (RX1 to RX11) and 3 NLOS
positions (RX12 to RX14) were chosen, the LOS distance separations between TX and
RX1 is 2.7 m, RX1 to RX10 is separated by 1.5 m and RX10 to RX11 is separated by
3 m. In NLOS case the TX and RX separations are of 3.4 m, 4.2 m and 5.5 m. The TX
antenna was an omni-directional biconical horn (5 dBi gain), and the RX antenna was a
1  4 array, which was rotated in the azimuth plane from 0° to 360° (step length is
45°) at each measurement position. This means that 36 data was collected in each
measurement position. The bandwidth (B) of system was chosen as 1 GHz in this
measurement. Detailed information on measurement parameters and setup are sum-
marized in Table 1.
Fig. 1. 28 GHz channel measurements for both LOS (RX2-RX11) and NLOS (RX12-RX14)
scenarios
2
S. Geng et al.

3
MIMO Channel Capacity Analysis
MIMO technology can make full use of space resources and use multiple antennas to
improve the system capacity several times without increasing the spectrum resources or
antenna transmit power. The application of MIMO technology makes the space become
a kind of resource that can be used to improve performance and increase the coverage
of wireless system.
3.1
MIMO Capacity
In MIMO, NT and NR are the number of TX and RX antennas, respectively. Assuming
that all antenna signals are spatially uncorrelated, the maximum capacity in MIMO
channel with given bandwidth B can be expressed as:
CMIMO ¼ B log2 det I þ
q
NT
HH þ


:
ð1Þ
where q denotes the average SNR, I is the identity matrix, and H is the normalized
channel matrix, ‘+’ denotes transpose conjugate.
For B = 1 GHz the CDF of MIMO channel capacity is shown in Fig. 2. It is seen
that MIMO (4  4) capacity is about 2 times in MIMO (2  2) channel. MIMO
(2  2) channel capacity is 1 about Gbps larger than in MIMO (1  4) channel at
Table 1. The 28 GHz channel measurement parameters
Measurement frequency 28 GHz
Frequency bandwidth
1 GHz
Code length
1024 ns
Delay resolution ratio
1 ns
TX power
18 dBm
TX antenna
Omni-directional biconical horn, 5 dBi gain
RX antenna
4 array antenna, 5 dBi gain
TX/RX antenna height
1.95/1.95 m
1
0.8
0.6
0.4
N =4, N =4
T 
R
N =1, N =4
T 
R
0.2
N =2, N =2
T 
R
N =1, N =1
T 
R
0 
5 
10
15
Capacity (Gbps)
CDF
Fig. 2. CDF of MIMO channel capacity
28 GHz MIMO Channel Characteristics Analysis for 5G Communication Systems
3

CDF = 0.8. This is because in MIMO (2  2) the spatial multiplexing (number of
parallel channels) makes information streams transmitted independently in channel.
3.2
MIMO Channel Link Budget Analysis
In wireless system, SNR is often determined from radio link budget as:
SNR ¼ Pt þ Gt þ Gr  PLðdÞ  N0  IL:
ð2Þ
where Pt is the transmitted power, Gt and Gr are the TX and RX antenna gains, PL is
channel path loss, N0 is the total noise power, IL denotes the total implementation loss at
the TX and RX. Path loss (PL) can be modeled by mean path loss and fading margin r [8]:
PL d
ð Þ ¼ PL0 þ 10 n log d=d0
ð
Þ þ r
ð3Þ
where PL0 is the free space path loss at d0 ¼ 1 m, n is path loss exponent and r is the
standard deviation (STD) of fading margin in multipath channel.
Path loss model in the 28 GHz channel measurement is shown in Fig. 3. It is seen
that PL exponent (n = 1.94) in LOS case is lower than free-space value of 2 due to the
guided-wave effects in the corridor. The values of PL exponent n and shadowing STD
r are in consistent with the values reported in [1].
In order to estimate 28 GHz MIMO channel capacity, in Eq. (2), parameters
Pt ¼ 18 dBm, Gt and Gr are 5 dB which are chosen as the same values as mea-
surement data. A total of 6 dB IL is estimated. The noise power is calculated as:
N0 ¼ 10 log 10ðkTBÞ þ NF, where k is the Boltzmann’s constant, T ¼ 290K (room
temperature) and the noise ﬁgure NF is assumed to be 6 dB at receiver. Note that
parameters of IL and NF are the same values as in [9] for a 60 GHz radio system.
Figure 4 shows capacity vs. distance in the LOS corridor. It is seen that at the shortest
TX-RX separation d = 2.7 m about 8 Gbps rate can be achieved in channel.
90
85
80
75
70
65
60
2 
4 
6 
8 
10  12 14 16 18 20
Distance(m)
LOS: 60.9+19.4*lg(d)(σ=4.23)
Path Loss (dB)
Fig. 3. Path loss model
4
S. Geng et al.

4
Channel Statistical Parameter Analysis
The statistical parameters and models of the channel are required to describe general
channel properties which are useful for system design. Rms delay spread (DS) is very
important and a common parameter for comparing different multipath channels in order
to develop some general guidelines in system design. Rician K-factor is usually used to
evaluate the performance of wireless systems.
4.1
Delay Spread
Rms delay spread is derived from the square root of the second central moment of a
PDP. The formula for rms delay spread can be found in [8]. Figure 5(a) and (b) are the
CDFs of RMS delay spreads in the LOS and NLOS corridor measurements, respec-
tively. It is seen that the mean values of RMS delay spread in the LOS and NLOS
corridor are of 26.4 ns and 27.6 ns, respectively. As the RMS delay spread depends on
8
6
4
2
0
0 
5 
10
15
20
Distance (m)
Measurement Data 
C(Gbps)=16.6*e[-0.256*d(m)]
Capacity (Gbps)
Fig. 4. Capacity vs. distance in the LOS corridor measurements
CDF
CDF
1 
1
0.8
0.8
0.6
0.6
0.4
0.4
0.2
Measurement Data
Normfit:µ=26.4ns, =17.3ns
0.2
0
Measurement Data
Normfit:µ=27.6ns,
=16.9ns
0
0 
10
20
30
40
50
Delay Spread (ns)
10
20
30
40
50
DelaySpread(ns)
(a)
(b) 
Fig. 5. CDF of RMS delay spread in (a) LOS and (b) NLOS corridors
28 GHz MIMO Channel Characteristics Analysis for 5G Communication Systems
5

both the size and scenario (LOS and NLOS) of environments. Note that the LOS
corridor measurement route is longer (TX to RX11 is 19 m) comparing with the NLOS
corridor measurements (TX to RX14 is 5 m).
4.2
K-factor
K-factor is deﬁned as the ratio between the powers of LOS path and the other random
multipaths. The estimation of Ricean K-factor has been widely studied in literature. The
moment estimation method [10] of K-factor is used in this work. Figure 6 shows the
CDF of K-factor in the LOS corridor measurements. It is seen that normal distribution
can ﬁt well with the measurement data. The mean value of K-factor is of 5.5 dB (with
STD of 7.1 dB) in the LOS corridor measurements.
5
Conclusion
This paper presented an investigation of channel characteristics based on experimental
measurements performed at 28 GHz for both LOS and NLOS scenarios. Speciﬁcally,
MIMO channel link budget, capacity, path loss, K-factor and delay spreads are studied
based on experimental data. Results show that Gigabit capacity can be achieved in
28 GHz channel with MIMO (1  4) conﬁguration in indoor environment. The mean
values of RMS delay spread in the LOS and NLOS corridors are of 26.4 ns and
27.6 ns, respectively. RMS delay spread depends on both the size and scenario (LOS
and NLOS) of environments. Normal distribution can ﬁt well with K-factor in the LOS
corridor measurements. The mean value of K-factor is of 5.5 dB (with STD of 7.1 dB)
in the environment. The presented results are useful for design of 28 GHz high rate
wireless communication systems.
Acknowledgments. This work is supported by National Key Laboratory of Electromagnetic
Environment, China Research Institute of Radiowave Propagation under grant No. JW2016-014.
1 
0.8
Measurement Data
Normfit : µ=5.5 dB, =7.1 dB
0.6
0.4
0.2
0 
-5 
0 
5 
10
15
20
K (dB)
CDF
Fig. 6. CDF of K-factor in the LOS corridor measurements
6
S. Geng et al.

References
1. Rappaport, T.S., MacCartney, G., et al.: Wideband millimeter-wave propagation measure-
ments and channel models for future wireless communication system design. IEEE Trans.
Commun. 63(9), 3029–3056 (2015)
2. Hu, Y., Ji, B.F., Huang, Y.M., et al.: Energy-efﬁcient resource allocation algorithm for
massive MIMO OFDMA downlink system. J. Commun. 36(7), 40–47 (2015). (in Chinese)
3. Hur, S., Cho, Y.J., Lee, J., et al.: Synchronous channel sounder using horn antenna and
indoor measurements on 28 GHz. In: IEEE International Black Sea Conference on
Communications and Networking, pp. 83–87 (2014)
4. Gu, Z.Q., Zhang, Z.P.: Nonlinear robust precoding for coordinated multipoint transmission.
J. Commun. 36(10), 140–148 (2015). (in Chinese)
5. Psychoudakis, D., Zhou, H., Biglarbegian, B., et al.: Mobile station radio frequency unit for
5G communications at 28 GHz. In: 2016 IEEE MTT-S International Microwave Symposium
(IMS), San Francisco, CA, pp. 1–3 (2016)
6. Kim, M., Liang, J., Lee, J., et al.: Directional multipath propagation characteristics based on
28 GHz outdoor channel measurements. In: 10th European Conference on Antennas and
Propagation (EuCAP), Davos, pp. 1–5 (2016)
7. Wang, G., Liu, Y., Qi, X.: Study on the propagation characteristics of 28 GHz radio wave in
outdoor microcellular. In: 2015 Asia-Paciﬁc Microwave Conference (APMC), Nanjing,
pp. 1–3 (2015)
8. Geng, S., Vainikainen, P.: Experimental investigation of the properties of multiband UWB
propagation channels. In: IEEE International Symposium on Personal, Indoor and Mobile
Radio Communications (PIMRC 2007), Greek, 3–7 September 2007
9. Yong, S.K., Chong, C.C.: An overview of multigigabit wireless through millimeter wave
technology: potentials and technical challenges. EURASIP J. Wirel. Commun. Netw. 1, 1–
10 (2007)
10. Greenstein, L.J., Michelson, D.G., Erceg, V.: Moment-method estimation of the Ricean
K-factor. IEEE Commun. Lett. 3(6), 175–176 (1999)
28 GHz MIMO Channel Characteristics Analysis for 5G Communication Systems
7

A Caching Strategy Based on User Interest
in Content-Centric Network
Yuehua Huo1, Yanyu Sun2, Yu Zhang3, Donglin Cui2,
Weiqiang Fan2, and Yinlong Liu3(&)
1 Center of Modern Education Technology,
China University of Mining and Technology, Beijing 100083, China
2 School of Mechatronics and Information Engineering,
China University of Mining and Technology, Beijing 100083, China
3 Institute of Information Engineering, Chinese Academy of Sciences,
Beijing 100093, China
huoyh@cumtb.edu.cn
Abstract. In Content-Centric Networking, content caching is a critical issue.
At present, most researches on content network caching mainly focus on net-
work resource utilization, while user interest is neglected. In this paper, we
propose a caching strategy based on user interest in the Content-Centric Net-
working. Firstly, it divides the users into several interest groups. Then get the
appropriate caching probability for each node by using grey relational analysis
method. Simulation results show that the caching strategy proposed in this paper
can achieve higher cache hit ratio and less average hop count than Leave copy
everywhere (LCE) and ProbCache.
Keywords: Content-Centric Networking  Caching strategy  User interest
Grey relational analysis
1
Introduction
Content-Centric Networking (CCN) is an innovative network model, and it can achieve
the content dissemination effectively. Reference [1] pointed out that CCN content
retrieval depends on content rather than IP address. In the research ﬁeld of CCN,
network caching is a very important issue. In [2], the author proposes a strategy for
allocating more cache space to important nodes. This strategy needs to measure the
importance of each node in the network. Caching metrics such as content popularity,
different application classes, and content type were considered in [3, 4]. Reference [3]
explored that caching only most popular contents could reduce content copies and
cache load at each node. Content types can be used to decide which content ﬁles will be
cached ﬁrst [4].
Leave copy everywhere (LCE) and ProbCache are two simple and common
strategies. LCE strategy means all nodes along he delivery path cache contents. Ref-
erence [5] presented a ProbCache strategy that designed a caching probability with a
function of the remained cache capability and the hop reduction from the router to the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 8–18, 2018.
https://doi.org/10.1007/978-3-319-72823-0_2

content store. The above two strategies mainly considered single layer caching metrics.
It is not efﬁcient and cannot improve cache performance very well.
5G (5th-generation) is the ﬁfth generation of mobile communication technology
short [6], the existing wireless access technology (including 2G, 3G, 4G and WiFi)
technology evolution, 5G system development will be for the 2020 mobile commu-
nications needs, Including key technologies such as architecture, wireless networking,
wireless transmission, new antenna and radio frequency, and new spectrum develop-
ment and utilization. In this paper, we design a caching strategy based on user interests
(CSUI) in CCN. This strategy is implemented by dividing the interest groups and
computing the probability of each node in the return path using the grey relational
analysis method. Simulation results show that the strategy improves the cache hit ratio
and reduces the average number of hops.
2
Related Works
2.1
Introduction of CCN
The traditional IP network has a long exploratory stage. At the beginning, it was
designed for less users, easy application, small ﬂow rate and other characteristics. In
this way, it establish a simple and clear network architecture. It is very suitable for the
requirement of using Internet at that time. However, with the rapid growth in network
size and offered application type, the simple and clear network architecture has become
more and more complicated. Figure 1 shows the difference between the traditional IP
network and Content-Centric Networking.
From the Fig. 1, we can see the CCN replaced the original IP layer with content
identify layer. The middle of the CCN network architecture becomes a simple structure
again. Therefore, this new network architecture works more efﬁciently than the current
complicated network architecture.
Fig. 1. The difference between the traditional IP network and Content-Centric Networking
A Caching Strategy Based on User Interest in Content-Centric Network
9

The mechanism of CCN is on the base of content which is named [7]. CCN takes
full advantage of the network equipment’s characteristics of big capacity memory and
low storage cost. Applying the caching mechanism appropriately can further promote
the network performance. Comparing with traditional IP network, in which require-
ments can be satisﬁed by the producer, requirements in CCN can also be responded by
the intermediate nodes as long as this intermediate node has cached the required
content before [8].
If this intermediate node does not have cached this content, it will forward the
interest packet to neighbor nodes. This process will continue until the content is sat-
isﬁed by the provider or the hit node. Then, the hit node or the provider will respond
with a data packet [9]. When the data packet is transmitted along the reverse path, the
intermediate node which is on the reverse path can cache the content into its content
store.
When the content store becomes full, it will adopt the replacement policy in order
to make a decision on removing one content from the store for the new content.
From Fig. 2, we can see when a user R1 requests a content, it ﬁrst sends the interest
packet to node P1. However, P1 does not have this requested content. So, P1 forwards
the interest packet hop by hop until it ﬁnds the node P which can satisfy the requested
content. Then P sends data packet along the reverse path and nodes which are on the
reverse path cache the requested content in their content stores. Next time, when user
R2 requests the same content, the node P1 can satisfy the request. Therefore, P1
responds the request and send the content back to R2.
2.2
Grey Relational Analysis
The grey relational analysis method is used to compute the two parameters of each
node’s cache probability: the betweenness B [10, 11] and the cache replacement rate R.
In the topology, betweenness is a useful way to judge the importance of nodes in the
network. The higher the betweenness is, the more important the node is. The
betweenness of user uj is shown as:
Fig. 2. An example of CCN caching mechanism
10
Y. Huo et al.

B uj
 
¼
X
s6¼u6¼t2U
Ns;t uj
 
Ns;t
ð1Þ
Where Ns;t is the number of the shortest paths from node s to node t. Ns;t uj
 
represents the number of the shortest paths from node s to node t through node uj.
The caching replacement rate R uj
 
is denoted as:
R uj
 
¼
P
M
i¼1
Sj ci
ð Þ
C uj
 
ð2Þ
Where C uj
 
is the cache size of uj and Sj ci
ð Þ represents the total number of
replaced content for T1 seconds in the content store of uj.
Along the delivery path, interest packet is transmitted. During the transmission,
interest packet records two caching parameters vectors of each node in the path. We
deﬁne
two
parameters
vector
as
a
binary
group,
which
is
represented
as
B uj
 
; R uj
 

T. The providers or the hit nodes receive the interest packet and extract
the set of the binary groups regarding as comparative sequences. Based on Grey
Relational Analysis, the providers or the hit nodes compute the caching probability and
response a data packet with computed caching probability. The data packet is for-
warded along the reverse path [12].
3
Caching Strategy Based on User Interests (CSUI)
3.1
Resource Matrix Construction Based on Dichotomy Network
A system that has a large number of individuals and interpersonal interactions can be
abstracted as a complex network. According to the quantity of node types in the
network, the complex network can be classiﬁed as single peak network, bipartite
network and other forms. Bipartite network has been a research focus.
Bipartite network is made up of two types of nodes and links between two types of
nodes. There is no link between the same types of node [13].
Different users may have the same interest, the same user may have multiple
interests, so the users and the interests generate relations. The existence of interests
depends on the users, because there is no users to have interests, interests do not exist.
The interaction between users and interests can be considered a resource allocation
process. We think nodes in the same group have similar resource vectors. Therefore,
dividing groups toward nodes can be transformed into clustering row vectors of the
resource distribution matrix.
Users-interests presents a characteristic of bipartite [14]. We assume the top nodes
in bipartite network as users and bottom nodes as interests (see Fig. 3). The initial
distribution of resources on the top nodes are x, y and z (see Fig. 3).
A Caching Strategy Based on User Interest in Content-Centric Network
11

All the nodes’ resource in the network can be expressed as three-dimensional
vectors:
x1
x2
x3
y1
y2
y3
y4
0
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
A
¼
7=12
5=12
5=12
5=24
5=12
1=6
5=24
1=6
5=12
1=4
1=2
1=2
1=4
1=2
0
1=4
0
1=2
1=4
0
0
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
x
y
z
0
B
@
1
C
A
ð3Þ
Where x1, x2, x3 represents the resource of the top nodes, y1, y2, y3, y4 represents the
resource of bottom nodes. The matrix that on the right side of the equation is resource
distribution matrix.
3.2
Divide Users into Interest Group
Divide users into interest group by K-means clustering and F-statistics [15], select K
objects as initial cluster center. Then by using the method of iteration, we can divide
objects into different groups. Our purpose is to make objects that in the same group
have a big similarity and objects that in the different group have a small similarity.
Assume
the
resource
distribution
matrix
is
U ¼ u1; u2; . . .; um þ n
ð
ÞT,
uj ¼
xj1; xj2; . . .; xjm


(the number of users is m; the number of interests is n). K is the group
number. ni is the number of nodes in ith group. These nodes are: ui
1, ui
2 to ui
ni.
ui ¼ xi
1; xi
2; . . .; xi
m


is the ith group’s cluster center.
xi
k ¼ 1
ni
X
ni
j¼1
xjk
ð4Þ
Fig. 3. The initial distribution of resources
12
Y. Huo et al.

The deﬁnition of F-statistics is
F ¼
P
K
i¼1
nijjuiujj2
K1
P
K
i¼1
P
ni
j¼1
nijjui
juijj2
nK
ð5Þ
The longer the distance between external groups, the shorter the distance in internal
groups, the bigger value of the F-statistics. Therefore, when the value of F-statistics
reaches its maximum, the effect of dividing groups is the best.
3.3
Calculate the Caching Probability Based on Grey Relational Analysis
When a user requests content ci, the interest packet adds the binary group information
of the requester
Xj ¼ ðBðujÞ; RðujÞÞT
ð6Þ
The node receives interest packet from the previous neighbor node, if the content
store has not the requested content, interest packet is added into binary group infor-
mation of the node, then it is forwarded to the next hop along the path. If the content
store has the requested content [16], they extract the binary groups of the interest
packet as the comparative sequences.
The distance from requester to the providers or hit nodes is n hops. The information
matrix Aʹ is denoted as:
A
0 ¼
X
0
1; X
0
2; . . .; X
0
n


¼
x
0
1 1
ð Þ
x
0
2 1
ð Þ
. . .
x
0
n 1
ð Þ
x
0
1 2
ð Þ
x
0
2 2
ð Þ
. . .
x
0
n 2
ð Þ
 
!
ð7Þ
Since each attribute has different ranges, we need to normalize attributes before we
calculate the grey grade. The xiðkÞ is normalized as:
xi k
ð Þ ¼
x
0
i k
ð Þ  min
1  i  n x
0
i k
ð Þ


max
1  i  n x
0
i k
ð Þ
f
g  min
1  i  n x
0
i k
ð Þ
f
g
ð8Þ
xi k
ð Þ ¼
max
1  i  n x
0
i k
ð Þ


 x
0
i k
ð Þ
max
1  i  n x
0
i k
ð Þ
f
g  min
1  i  n x
0
i k
ð Þ
f
g
ð9Þ
Where k = 1, 2. Pay attention to (8) is used for the-larger-the-better attributes while
(9) is used for the-smaller-the-better attributes. Based on this, we can get
A Caching Strategy Based on User Interest in Content-Centric Network
13

A ¼ X1; X2; . . .; Xn
ð
Þ
¼
x1 1
ð Þ
x2 1
ð Þ
. . .
xn 1
ð Þ
x1 2
ð Þ
x2 2
ð Þ
. . .
xn 2
ð Þ

	
ð10Þ
Deﬁne reference sequence
X0 ¼ ðx0ð1Þ; x0ð2Þ; . . .; x0ðmÞÞT ¼ 1; 1; . . .1
ð
ÞT
ð11Þ
Calculate grey relational coefﬁcient
q x0 jð Þ; xi jð Þ
ð
Þ ¼
Dmin þ sDmax
jx0 jð Þ  xi jð Þ þ lDmaxj
ð12Þ
Dmin ¼
min
1  i  n;1  j  m jx0 jð Þ  xi jð Þj
ð13Þ
Dmax ¼
max
1  i  n;1  j  m jx0 jð Þ  xi jð Þj
ð14Þ
Where u is distinguishing coefﬁcient, and s 2 [0, 1]. The larger grey relation
coefﬁcient is, the closer xiðjÞ is to x0ðjÞ.
The grey relation grade pi can be calculated as
pi ¼
X
m
j¼1
ajq x0 jð Þ; xi jð Þ
ð
Þ
ð15Þ
Where P
m
j¼1
aj ¼ 1 and aj represents the weight of jth attribute.
Providers or hit nodes send data packet that the requester is requiring. Data packet
carries above calculated grey relation grades along the reverse path [17]. Intermediate
node receives data packet and caches content with the corresponding caching proba-
bility, which is equal to the node grey relational grade.
4
Simulation Analysis
4.1
Simulation Environment
We use the software ndnSIM [18] to simulate the GRA-based caching strategy. It is a
chunk-level simulator developed in the NS-3 framework.
The network topology is a 7 * 7 grid network.
We evaluate our caching strategy by comparing two common caching strategies.
(1) LCE, all nodes along the delivery path cache the content.
(2) ProbCache, by which nodes along the delivery path cache the content with the
ﬁxed probability 0.5.
14
Y. Huo et al.

In the evaluation, we consider the independent variable as cache size which is the
cache capacity in terms of content units. The cache size ranges from 50 to 200.
4.2
Evaluation Metrics
Caching hit ratio is deﬁned as:
b ¼ S
R
ð16Þ
Where S denotes the numbers of requests satisﬁed by caching node, and R rep-
resents the total number of requests in the network.
Caching hit ratio gain bgain
bgain ¼ b  bLCE
bLCE
ð17Þ
Where b is the hit ratio of caching strategy, and bLCE is the hit ratio of LCE.
Average hops
Average hops indicates the delay for user to fetch the content and it is a good way to
estimate the access delay to the content. The same as the bgain, hop reduction ratio g is
represented as:
g ¼ H  h
H
ð18Þ
Where H is the average hops from user to the content provider or hid nodes in the
LCE strategy, h is the average hops from the user to content provider or hit nodes for
CSUI and ProbCache.
4.3
Simulation Diagram
In order to better verify the performance of CSUI strategy, the following experiment
was done to draw the relationship between the cache hits and the average hops cor-
responding to different cache sizes.
From Fig. 4, we can see that the cache hit ratio of all compared caching strategies
increases as the cache size increases. When the cache size become larger, the better
diversity of cached contents will satisfy more requests. We can calculate that our CSUI
strategy can achieve about 13%–27% cache hit ratio gain compared with LCE and
ProbCache as the cache size changes.
A Caching Strategy Based on User Interest in Content-Centric Network
15

Figure 5 illustrate the average hops and hop reduction ratio for each strategy with
different cache sizes respectively. When the cache size is 50, the average hops
reduction is little, about 4%. However, when the cache size is 200, hop reduction can
reach 11%.
Therefore, it is obvious that our strategy CSUI performs better than LCE and
ProbCache.
5
Conclusion
In this paper, we design a caching strategy that considers the interest of CCN users. On
the basis of dichotomous network, we divide the users into appropriate interest groups,
and then use the grey correlation analysis method to calculate the cache probabilities of
each node in each interest group. This is a CCN caching strategy that takes into account
Fig. 4. Caching hit ratio with different cache sizes
Fig. 5. Average hops with different cache sizes
16
Y. Huo et al.

user interest. Simulation results show that compared with LCE and ProbCache caching
strategies, the strategy of this paper (CSUI) achieves higher cache hit ratio and fewer
average hops.
References
1. Naboulsi, D., Fiore, M., Ribot, S., Stanica, R.: Large-scale mobile trafﬁc analysis: a survey.
IEEE Commun. Surv. Tutor. 18(1), 124–161 (2015). IEEE Communications Society Press
2. Wu, Y., Zhang, P.: Study on bipartite networks. Complex Syst. Complex. Sci. 7, 1–12
(2010)
3. Bernardini, T., Festor, O.: MPC: popularity-based caching strategy for content centric
networks. In: 2013 IEEE International Conference on Communications, Budapest, pp. 3619–
3623. IEEE Press (2013)
4. Diallo, M., Fdida, S., Sourlas, V., Flegkas, P., Tassiulas, L.: Leveraging caching for
internet-scale content-based publish/subscribe networks. In: 2011 IEEE International
Conference on Communications, Japan, pp. 1–10. IEEE Press (2011)
5. Xu, Y., Li, Y., Lin, T., Ci, S.: A novel cache size optimization scheme based on manifold
learning in content centric networking. J. Netw. Comput. Appl. 37, 273–281 (2014)
6. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23, 48–53 (2016)
7. Cheng, Y., Afanasyev, A., Wang, L., Zhang, B., Zhang, L.: Adaptive forwarding in named
data networking. ACM SIGCOMM Comput. Commun. Rev. 42, 62–67 (2012)
8. Chai, W.K., He, D., Psaras, I., Pavlou, G.: Cache “Less for More” in information-centric
networks (extended version). Comput. Commun. 36, 758–770 (2013)
9. Chai, W.K., He, D., Psaras, I., Pavlou, G.: Cache “Less for More” in information-centric
networks. In: Bestak, R., Kencl, L., Li, L.E., Widmer, J., Yin, H. (eds.) NETWORKING
2012. LNCS, vol. 7289, pp. 27–40. Springer, Heidelberg (2012). https://doi.org/10.1007/
978-3-642-30045-5_3
10. Xu, L., Luan, Y., Cheng, X., Cao, X., Chao, K., Gao, J., Wang, S.: WCDMA data based
LTE site selection scheme in LTE deployment. In: International Conference on Signal and
Information Processing, Networking and Computers, Beijing, pp. 249–260. CRC Press
(2015)
11. Ahlgren, B., Dannewitz, C., Imbrenda, C.: A survey of information centric networking.
IEEE Commun. Mag. 50, 26–36 (2012)
12. Jacobson, V., Smetters, D.K., Thornton, J., Plass, M., Briggs, N., Braynard, R.: Networking
named content. In: 2009 ACM Conference on Emerging Networking Experiments and
Technologies, Rome, pp. 1–12. ACM Press (2009)
13. Jacobson, V., Smetters, D., Thornton, J., Plass, M., Briggs, N., Braynard, R.: Networking
named content. Commun. ACM 55, 117–124 (2012)
14. Caroﬁglio, G., Gallo, M., Muscariello, L.: Modeling data transfer in content-centric
networking. In: Proceedings of the 23rd International Teletrafﬁc Congress, San Francisco,
pp. 111–118. IEEE Computer Society (2011)
15. Katsaros, K., Xylomenos, G., Polyzos, G.C.: Multi cache: an overlay architecture for
information-centric networking. Comput. Netw. 55, 936–947 (2011)
16. Rossi, D., Rossini, G.: Caching performance of content centric networks under multi-path
routing (and more). Technical report, Telecom Paris Tech (2011)
A Caching Strategy Based on User Interest in Content-Centric Network
17

17. Zhang, L., Estrin, D., Burke, J., Jacobson, V.: Named data networking (NDN) project.
Transp. Res. Rec. J. Transp. Res. Board 1892, 227–234 (2012)
18. Xu, L., Chen, Y., Kok, K.C., John, S., Laurie, C.: Self-organising cluster-based cooperative
load balancing in OFDMA cellular networks. Wiley Wirel. Commun. Mob. Comput. 15,
1171–1187 (2015)
18
Y. Huo et al.

Node Localization Based on Multiple Radio
Transmission Power Levels for Wireless
Sensor Networks
Yikang Xing1,2, Wei Huangfu1,2(&), Xiaoming Dai1,2,
and Xiaoyan Hu3
1 University of Science and Technology Beijing, Beijing, China
huangfuwei@ustb.edu.cn
2 Beijing Engineering and Technology Research Center for Convergence
Networks and Ubiquitous Services, Beijing, China
3 China Mobile Group Design Institute Co., Ltd., Beijing, China
Abstract. The range-free node localization techniques are attractive in wireless
sensor networks. However, only based on the connectivity information, the
range-free schemes are usually not accurate. The transmission radio power of
the sensor nodes is often adjustable and multiple levels of the transmission
power correspond to multiple levels of the communication radius. Thus an
improved range-free node localization algorithm inspired by multiscale virtual
forces is proposed, which adopts multiscale connectivity information. The
simulation results showed that the proposed approach performs well in various
scenario and the localization accuracy is improved.
Keywords: Node localization  Range-free  Wireless sensor networks
Virtual force ﬁeld  Multiscale virtual forces
1
Introduction
The Internet of Things (IOT) in 5G wireless networks is predicted to connect billions of
smart devices over the next decades [1]. Wireless Sensor Networks (WSN) [2–4] are
fundamental in the IOT. The position information of sensor nodes is widely used in
many areas such as routing, surveillance and monitoring. A large number of local-
ization algorithms have been proposed.
The node localization can be obtained with the Global Positioning System (GPS).
However, it requires that all the devices are equipped with GPS modules and thus it is
considered to be a costly solution in terms of money and power consumption. Also, the
node position can be calculated with the help of anchor nodes. These techniques are
usually economical [5] and can be classiﬁed into two categories: range-based tech-
niques and range-free ones.
The range-based techniques usually need to measure distance with additional
devices. The range-based techniques perform well with accurate distance measure-
ments. On the contrary, the range-free algorithms only depend on the connectivity
information among sensor nodes, which have some advantages such as low energy
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 19–27, 2018.
https://doi.org/10.1007/978-3-319-72823-0_3

consumption, low cost, low noise sensitivity and high-efﬁciency. Many improved
range-free algorithms have been proposed, and there is still a great room for
improvement in localization accuracy of such range-free algorithms [6].
Note that the Radio Frequency (RF) chips which are equipped in the sensor nodes
can broadcast packets with different radio power levels, and different power levels have
different communication ranges. This feature may help the range-free localization
schemes to obtain high localization accuracy. In this paper, an improved range-free
node localization algorithm inspired by Multiscale Virtual Forces (MVF) based on
multiple transmission power levels is proposed.
The organization of the paper is as follows. In Sect. 2, we review the related to
range-free algorithms. In Sect. 3, we present the system model and the details of MVF
algorithm. In Sect. 4, we present simulation results in various situations. Section 5
concludes this paper.
2
Related Work
Nodes localization problems have been studied for many years. A number of tech-
niques are proposed.
Distance Vector-Hop (DV-Hop) [7] is a kind of typical range-free localization
algorithm. The location process is divided into the three phase. In the ﬁrst phase, nodes
obtain the smallest hop-count from anchor nodes using typical distance vector
exchange protocols. In the second phase, the distance matrix between nodes and anchor
nodes is estimated. In the third phase, the nodes calculate their own position using the
maximum likelihood estimation method [8]. Multidimensional Scaling (MDS-MAP)
[9, 10] is another kind of typical localization algorithm for both range-free and
range-based circumstances. It uses the distance matrix or hop matrix to solve the
eigenvectors
related
to
the
top
two
maximum
eigenvalues
to
construct
a
two-dimensional relative map. Although many improved algorithms have been pro-
posed, the range-free techniques also suffer from the low localization accuracy and the
high computational complexity.
The Virtual Forces algorithm (VF) [11] aims to get effective deployment which can
provide good coverage and connectivity. Each sensor node behaves as a source of
virtual force. If two sensor nodes are placed close enough, i.e. the distance between two
nodes is shorter than the threshold, there will exist a virtual repulsive force. On the
contrary, if a pair of nodes is too far apart from each other, there will be a virtual
attractive force.
The VF algorithm combines the ideas of potential ﬁeld and disk packing. The idea
of VF algorithm can also be used in node localization [12]. If we consider the con-
nectivity between any pair of nodes in the wireless sensor network as a constraint
condition and construct virtual force model according to these conditions. We can use
these virtual forces to push the unknown nodes to where they should be. The VF
algorithm uses the neighbor lists of sensor nodes to estimate the absolute location with
the help of anchor nodes. This algorithm belongs to Heuristic-based location estimation
techniques. The VF algorithm can usually obtain high localization accuracy than other
range-free algorithms.
20
Y. Xing et al.

3
Node Localization Algorithm with Multiscale
Virtual Forces
We propose a novel algorithm named Multiscale Virtual Forces (MVF). This new
algorithm extends the advantages of range-free localization algorithm: low energy
consumption, low cost and low noise sensitivity. Compare with the traditional VF
algorithm, the new algorithm uses multiple groups of neighbor information of each
sensor node. Each sensor node broadcasts packets with multiple transmission power,
each different transmission power level leads to different information. Thus it help
obtain higher accuracy than the traditional virtual force algorithm.
In this section, we will propose a node localization algorithm inspired by the
multiscale virtual forces corresponding to multi-level transmission power in wireless
sensor networks. The underlying assumptions and the localization algorithm are
described as follows.
3.1
Assumptions
We have the following assumptions:
• Each sensor node has its unique ID (identiﬁcation) and can set its RF chip to various
radio power levels.
• Each sensor node is ﬁxed during the positioning process.
• For any pair of sensor nodes there exists at least one routing path, i.e. all sensor
nodes are connected.
• There are a certain number of anchor nodes, which have the GPS modules. It means
these anchor nodes can obtain the location information.
3.2
System Model
All the N sensor nodes including anchor nodes are s1; s2;    ; sN deployed in the
sensing ﬁeld. The coordination of node sið1  i  NÞ is ðxi; yiÞ. We also let~si denote the
vector
ðxi; yiÞ.
Each
sensor
node
has
K
transmission
power
levels:
P1; P2;    ; PK ðP1\P2\    \PKÞ, which corresponds to a series of communication
radius: r1; r2;    ; rK ðr1\r2\    \rKÞ (Fig. 1).
For any pair of sensor node ðsi; sjÞ , we deﬁne neighbor index n1ði; jÞ;
n2ði; jÞ;    ; nKði; jÞ as
n1ði; jÞ ¼
1;
dij  r1
0;
dij  r1

n2ði; jÞ ¼
1;
dij  r2
0;
dij  r2

...
nKði; jÞ ¼
1;
dij  rK
0;
dij  rK

;
ð1Þ
Node Localization Based on Multiple Radio Transmission Power
21

where dij is the Euclidean distance between si and sj.
dij ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxi  xjÞ2 þ ðyi  yjÞ2
q
ð2Þ
Every sensor node has an initial position. We assume that the initial position of
unknown node si is~^si ¼ ð^xi ;^yiÞ, where ^xi and ^yi generated randomly. For each anchor
nodes si, the initial position ð^xi ;^yiÞ is its actual position ðxi; yiÞ.
We deﬁne multiscale virtual force f1ði; jÞ; f2ði; jÞ;    ; fKði; jÞ as
~f1ði; jÞ ¼
kð~^si ~^sjÞ;
^dij [ r1 and n1ði; jÞ ¼ 1
kð~^si ~^sjÞ;
^dij\r1 and n1ði; jÞ ¼ 0
0;
else
8
>
>
<
>
>
:
~f2ði; jÞ ¼
kð~^si ~^sjÞ;
^dij [ r2 and n2ði; jÞ ¼ 1
kð~^si ~^sjÞ;
^dij\r2 and n2ði; jÞ ¼ 0
0;
else
8
>
>
<
>
>
:
...
~fkði; jÞ ¼
kð~^si ~^sjÞ;
^dij [ rk and nkði; jÞ ¼ 1
kð~^si ~^sjÞ;
^dij\rk and nkði; jÞ ¼ 0
0;
else
8
>
>
<
>
>
:
;
ð3Þ
^dij ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ð^xi  ^xjÞ2 þ ð^yi  ^yjÞ2
q
;
ð4Þ
where ^dij is the Euclidean distance between estimated nodes location ~^si and ~^sj;k is a
positive parameter called the learning rate; kð~^si ~^sjÞ represents the attractive force
S1
r1
r2
r3
rK
Fig. 1. Multiscale communication radius
22
Y. Xing et al.

between two nodes, and kð~^si ~^sjÞ represents the repulsive force.
We deﬁne the net force on a node si is the vector sum of all the above the forces:
Fi ¼
X
K
L¼1
X
N
j¼1;i6¼j
~fLði; jÞ
ð5Þ
3.3
Operation of the Localization Algorithm
The detailed steps of the MVF algorithm are as follows:
Step 1. All the sensor nodes broadcast packets with transmission power:
P1; P2;    ; PK. The data packets include ID of the source node, the information of
transmission power level and the current position of the sensor node (Fig. 2).
Step 2. If node si can receive the packets broadcasted with power PK from sj, we
can know that dij  rk. Node receives all the packets and organizes the information
into Table 1 where i and j are ID of the destination node and source node:
Step 3. Each sensor node sends the table to the center node.
Step 4. The center node collects all the table of sensor nodes. Then the location data
is calculated with the following algorithm.
We assume that the initial position of each unknown node is ~^s 0
ð Þ
i
¼ ð^x 0
ð Þ
i
;^y 0
ð Þ
i Þ;
1  i  N. Then we can use (3) (4) to calculate f 0
ð Þ
1 ði; jÞ; f 0
ð Þ
2 ði; jÞ;    ; f 0
ð Þ
K ði; jÞ and
use (5) to calculate the net force F 0
ð Þ
i
. New estimated by locations ð^x 1
ð Þ
i
;^y 1
ð Þ
i Þ are
calculated.
Position 
ID
Power level
( ,
)
i
i
x y
iP
Fig. 2. The packet structure
Table 1. The information of packets that the sensor node receives and organizes
j
1
2
…
N
1( , )
n i j
1
1
…
0
2( , )
n i j
1
1
…
0
…
…
…
…
…
( , )
K
n
i j
0
1
…
0
Node Localization Based on Multiple Radio Transmission Power
23

ð^x 1
ð Þ
i
;^y 1
ð Þ
i Þ ¼~^s 1
ð Þ
i
¼~^s 0
ð Þ
i
þ aF 0
ð Þ
i
ð6Þ
Here the symbol a is a coefﬁcient to indicates the virtual inertia of the nodes.
Step 5. We use the new locations to repeat Step. 4 for the next movement. After the
number of iteration reaches M (the max number of iterations), the algorithm stops.
We denote the ﬁnal results as
~^si ¼~^s M
ð
Þ
i
¼ ð^x M
ð
Þ
i
;^y M
ð
Þ
i
Þ; 1  i  N
ð7Þ
Step 6. The center node sends the ﬁnal positions to all sensor nodes.
4
Performance Evaluation
In order to assess and verify the performance of the proposed algorithm, multiple
simulations have been done using python, numpy and matplotlib. All the sensor nodes
in the network are deployed randomly in area 100  100 (where the distance unit is
arbitrary) and the number of sensor nodes is N. We compare the MVF algorithm and
other similar algorithm, including the basic DV-Hop algorithm, MDS-MAP algorithm
and the VF algorithm. In all of the experiments, the metric used to evaluate the
localization methods is the Mean Localization Error (MLE).
MLE ¼ 1
N
X
N
i;j¼1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxi  ^xiÞ2 þ ðyi  ^yiÞ2
q
;
ð8Þ
where ð^xi;^yiÞ are the coordinates of the estimated location of si and ðxi; yiÞ are the
coordinates of the actual location of node si.
We denote VF(r) as the node localization algorithm with Single Virtual Force,
MDS-MAP(r) as the algorithm with MDS-MAP, DV-Hop(r) as the node localization
algorithm with DV-Hop, where r represents the communication radius corresponding
to the power. We denote MVF ðr1; r2;    ; rKÞ as the node localization algorithm with
Multiscale Virtual Forces, r1; r2;    ; rK represent the multiscale communication radius
sequence.
Figure 3 shows the iteration times of two localization algorithm with VF and MVF.
The number of sensor nodes is 100 and the density of anchor nodes is 15%. The
communication radius of MVF algorithm is set to 10, 15, 20. In order to compare VF
and MVF algorithm, the communication radius of VF algorithm is set to 10, 15, 20
respectively. We ﬁnd that when the iteration count of VF and MVF algorithms
increase, the localization errors of the algorithm decreases. When the iteration count
reach about 100, the localization errors of both VF and MVF algorithms tend to be
24
Y. Xing et al.

steady. The localization errors of MVF algorithms are lower than all the VF algorithms
obviously.
Figure 4 shows the localization errors of MVF algorithm is lower than other
algorithm if the ratio of the anchor nodes is big enough. Note that the MVF algorithm
uses the multiple communication ranges. The wide communication range is for
coarse-grained positioning and the narrow communication range is for ﬁne-grained
positioning. Thus the connectivity information for different communication range
improves the performance of the MVF algorithm.
Fig. 3. Localization performance comparison at different iteration times
Fig. 4. Localization performance comparison at different ratio of anchor node
Node Localization Based on Multiple Radio Transmission Power
25

Figure 5 shows the localization error at different node density. The iteration count
is 100 and the ratio of anchor nodes is 15%. We ﬁnd that with the increasing of the
node density, the localization errors of these algorithm decreases. When the node
density is greater than 100, the localization errors of these algorithms tend to be steady.
The localization error of MVF algorithm is lower than other algorithms if the node
density is reasonable high.
5
Conclusion and Future Work
Positioning is an important technology for the IOT. This paper proposes an improved
node localization algorithm in wireless sensor networks. It does not require additional
hardware and thus suits for a wide range of application scenarios. It depends on
multiple radio power levels to reach high-precision positioning. The results show that
our algorithm can obtain higher localization accuracy than other existing algorithms in
the dense networks. Our future work will address the fundamental questions of how to
choose the best group of transmission power levels.
Acknowledgement. This work was supported by National Natural Science Foundation of China
(No. 61370191) and the Joint Foundation of MoE (Ministry of Education) and China Mobile
Group (No. MCM20160103).
References
1. Condoluci, M., Araniti, G., Mahmoodi, T., Dohler, M.: Enabling the IoT machine age with
5G: machine-type multicast services for innovative real-time applications. IEEE Access 4,
5555–5569 (2016)
Fig. 5. Localization performance comparison at different node density
26
Y. Xing et al.

2. Akyildiz, I.F., Su, W., Sankarasubramaniam, Y., Cayirci, E.: A survey on sensor networks.
IEEE Commun. Mag. 40(8), 102–114 (2002)
3. Hutchison, D.: Self-Organization in Sensor and Actor Networks. Wiley, Hoboken (2007)
4. Zhang, Z., Long, K., Wang, J., Dressler, F.: On swarm intelligence inspired self-organized
networking: its bionic mechanisms, designing principles and optimization approaches. IEEE
Commun. Surv. Tutor. 16(1), 513–537 (2014). First Quarter
5. Kuriakose, J., Amruth, V., Nandhini, N.S.: A survey on localization of wireless sensor
nodes. In: 2014 International Conference on Information Communication and Embedded
Systems (ICICES), Chennai, pp. 1–6 (2014)
6. Zanaj, E., Elbasani, E., Alinci, M., Kotobelli, E., Zanaj, B.: Application of the localization
algorithms in WSN. In: 2014 49th International Universities on Power Engineering
Conference (UPEC), Cluj-Napoca, pp. 1–5 (2014)
7. Niculescu, D., Nath, B.: DV based positioning in ad hoc networks. J. Telecommun. Syst. 22,
267–270 (2003)
8. Liu, Y., Zhang, Y.: A better range-free localization algorithm in wireless sensor networks.
In: 2016 International Symposium on Computer, Consumer and Control (IS3C), Xi’an,
pp. 132–135 (2016)
9. Shang, Y., Ruml, W., Zhang, Y., Fromherz, M.P.J.: Localization from mere connectivity. In:
Proceedings of the 4th ACM International Symposium on Mobile Ad Hoc Networking and
Computing (2003)
10. Shang, Y., Rumi, W., Zhang, Y., Fromherz, M.: Localization from connectivity in sensor
networks. IEEE Trans. Parallel Distrib. Syst. 15(11), 961–974 (2004)
11. Zou, Y., Chakrabarty, K.: Sensor deployment and target localization based on virtual forces.
In: Twenty-Second Annual Joint Conference of the IEEE Computer and Communications,
INFOCOM 2003, vol. 2, pp. 1293–1303. IEEE Societies, San Francisco, CA (2003)
12. Awad, F.H.: Wireless location estimation using virtual forces. In: 2015 IEEE International
Conference on Computer and Information Technology; Ubiquitous Computing and
Communications; Dependable, Autonomic and Secure Computing; Pervasive Intelligence
and Computing (CIT/IUCC/DASC/PICOM), Liverpool, pp. 1481–148 (2015)
13. Assaf, A.E., Zaidi, S., Affes, S., Kandil, N.: Low-cost localization for multihop
heterogeneous wireless sensor networks. IEEE Trans. Wirel. Commun. 15(1), 472–484
(2016)
14. Han, G., Jiang, J., Zhang, C., Duong, T.Q., Guizani, M., Karagiannidis, G.K.: A survey on
mobile anchor node assisted localization in wireless sensor networks. IEEE Commun. Surv.
Tutor. 18(3), 2220–2243 (2016). Third Quarter
15. Zaidi, S., El Assaf, A., Affes, S., Kandil, N.: Accurate range-free localization in multi-hop
wireless sensor networks. IEEE Trans. Commun. 64(9), 3886–3900 (2016)
16. Jayasumana, A.P., Paffenroth, R., Ramasamy, S.: Topology maps and distance-free
localization from partial virtual coordinates for IoT networks. In: 2016 IEEE International
Conference on Communications (ICC), Kuala Lumpur, pp. 1–6 (2016)
17. Chen, Y.S., Deng, D.J., Teng, C.C.: Range-based localization algorithm for next generation
wireless networks using radical centers. IEEE Access 4, 2139–2153 (2016)
Node Localization Based on Multiple Radio Transmission Power
27

End-to-End Transmission Performance
Optimization Based Routing Selection
Algorithm for Software Deﬁned Networking
Guixiang Jiang(B), Rong Chai, and Haipeng Li
Key Lab of Mobile Communication Technology,
Chongqing University of Posts and Telecommunications, Chongqing, China
825882445@qq.com, chairong@cqupt.edu.cn, lihaipeng814@qq.com
Abstract. Software-deﬁned networking (SDN) is a new networking
paradigm enabling innovation through decoupling control plane from
data plane and providing programmability for network application devel-
opment. Speciﬁc research focus has been placed to achieve route optimal
selection in SDN scenario. In this paper, we study the problem of route
selection for a user ﬂow in a SDN scenario consisting of a number of
switches and propose an end-to-end transmission performance optimiza-
tion based routing selection algorithm. We jointly consider the character-
istics of user ﬂow and service capability of the network, and formulate the
arrival curve of user ﬂow and the service curve of switches by applying
Network Calculus theory. The transmission performance of user ﬂow,
deﬁned as eﬀective bandwidth is evaluated and the route oﬀering the
maximum eﬀective bandwidth is selected as the optimal route. Numeri-
cal results demonstrate the eﬀectiveness of the proposed algorithm.
Keywords: SDN · Routing algorithm · Network calculus
Eﬀective bandwidth
1
Introduction
The rapid growth of data services with diﬀerent quality of service (QoS) require-
ments poses challenges to network architecture and management mechanisms.
Traditional Internet technologies can hardly meet the increasing service require-
ments due to tightly coupled control and date plane, inﬂexible network architec-
ture and complicated network and service management mechanisms. To tackle
these challenges, software-deﬁned networking (SDN) technology has been pro-
posed [1].
As an emerging network technology, SDN is one of the most promising
approaches to dynamically programming networks and managing user services
via building customized solutions which are manageable, dynamic, cost-eﬀective
and adaptable. In SDN, controllers in control plane are responsible for control-
ling and managing data forwarding devices such as switches in a centralized
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 28–37, 2018.
https://doi.org/10.1007/978-3-319-72823-0_4

End-to-End Transmission Performance Optimization
29
manner, thus achieving the separation between data forwarding plane and the
control plane. This new network technology permits separating network control
functions, e.g., routing from switches so that routing algorithms can be designed
in controllers [2,3].
In recent years, the problem of routing algorithm design for SDN has been
stressed and several routing algorithms have been proposed. Some references
consider applying network function virtualization (NFV) technology to achieve
performance enhancement of routing algorithms in SDN. In [4], the authors
present a QoS-aware virtualization-enabled routing framework to fulﬁll the QoS
requirement of multiple clients in a SDN. To isolate and prioritize tenants from
diﬀerent clients, a network virtualization algorithm is designed to create a subnet
for each tenant, and then a QoS-aware routing algorithm is proposed to max-
imize the minimum residue bandwidth of links. The authors in [5] present an
approach for building multicast mechanisms over SDN. By applying NFV tech-
nology, transcoding functions are embedded into some of the servers, switches or
routers. A multicast routing algorithm is then proposed to ensure each multicast
ﬂow traverses through the nodes embedded NFV technology before reaching the
destination, while the total routing cost is minimized at the same time.
User QoS requirements and network characteristics are jointly considered in
routing algorithm for SDN. In [6], the authors propose a probabilistic QoS rout-
ing mechanism for SDN which jointly considers link probability and bandwidth
availability of the network. By applying Bayes theorem and Bayesian network
model, link probability is determined based on which the path consisting of the
links of the highest probabilities is selected under that satisﬁes the bandwidth
constraint. The authors in [7] stress resource requirements of ﬂows in the core
network. Deﬁning resource requirements including transmission bandwidth and
ﬂow tables as resource preference, the authors quantize the resource preference
of diﬀerent network ﬂows based on analytic hierarchy process (AHP) method
and propose a resource preference aware routing algorithm which matches each
ﬂow to the path with the largest preference degree.
In [8], the authors consider transmitting a set of unicast sessions in SDN with
each session having a QoS requirement on transmission throughput. Assuming
each session is associated with a collection of packet forwarding rules, the authors
propose a rule multiplexing scheme, in which the same set of rules is deployed
on the common nodes of multiple pathes. Based on the multiplexing scheme,
a route selection and rule placement strategy is proposed with the objective of
minimizing rule space occupation of all the sessions.
In previous works, the transmission characteristics such as network band-
width and throughput are taken into account in designing optimal routing strat-
egy, however, the end-to-end transmission performance fails to be stressed, which
may result in undesired transmission performance. In this paper, we study the
problem of routing algorithm design for one user ﬂow in SDN. Particularly, we
consider service preference on high data rate and propose an end-to-end trans-
mission performance optimization based routing algorithm. To quantitatively
analyze the end-to-end transmission performance of user ﬂow, we apply Network

30
G. Jiang et al.
Calculus theory, which enables the joint consideration of the service arrival char-
acteristics of the user ﬂow and the serving ability of the intermediate switches,
thus achieving comprehensive evaluation of the transmission performance of user
ﬂow.
The rest of this paper is organized as follows. Section 2 describes the system
model considered in this paper. Section 3 discusses the optimal route selection
algorithm. In Sect. 4, we examine the end-to-end transmission performance of
user ﬂow. Simulation results are presented in Sect. 5. Finally, Sect. 6 concludes
the paper.
2
System Model
In this paper, we consider a SDN model as shown in Fig. 1. The system consists
of one SDN controller and a number of switches. We assume that a user ﬂow
needs to be transmitted from a source switch (SS) to a destination switch (DS).
In the case that no direct transmission link between SS and DS exists, route
selection strategy should be designed for the user ﬂow.
Fig. 1. System model
We assume in the SDN scenario considered, there exists M0 switches in addi-
tion to SS and DS. For convenience, we denote Φ as the set containing all the
switches. To characterize the connection status between switches, we introduce
binary connection identiﬁers. Let δi,j denote the connection identiﬁer between
switch i and switch j, i.e., δi,j = 1 if switch i is an adjacent node of switch
j, thus there exists an available link between switch i and switch j; otherwise,
δi,j = 0, i ∈Φ, j ∈Φ, i ̸= j. In this paper, we assume that the network topology
is given, hence, δi,j are known constants.

End-to-End Transmission Performance Optimization
31
3
Optimal Route Selection Algorithm Description
In this paper, we assume that the user ﬂow has a minimum data rate require-
ment, to reduce the computation complexity of route selection, we ﬁrst propose
a candidate route selection scheme based on user rate requirement and network
characteristics, and then an optimal route selection is proposed to select the
optimal route among all the candidate routes.
3.1
Candidate Route Selection Scheme
Given a SDN scenario, we ﬁrst search for all the possible routes connecting SS
and DS. We assume that the number of possible routes connecting SS and DS is
M, and denote the mth route as Lm. For convenience, we denote the switches
along Lm as Sm,0, Sm,1, · · · , Sm,Nm, where Nm denotes the link number of Lm.
We can obtain that Lm is an available route connecting SS and DS provided that
Sm,0 and Sm,Nm are respectively SS and DS and the following condition meets.
For simplicity, we assume that the jth switch of Lm is labeled as the mjth switch
of the network, 1 ≤j ≤Nm, we can achieve that the mj−1th switch and the
mjth switch should be adjacent nodes of the network, i.e.,
δmj−1,mj = 1.
(1)
Denote the data rate of Lm as Rm, 1 ≤m ≤M, we deﬁne R0
m as the minimum
data rate of all the links of Lm, i.e.,
R0
m = min{R0
m,j}, 1 ≤j ≤Nm
(2)
where R0
m,j denotes the data rate of the jth link of Lm. In this paper, we assume
that the link capacity is large enough, thus the data rate of one link is determined
by the port rate of the two switches being connected by the link. We denote the
import and outport rate of Sm,j as Rin
m,j and Rout
m,j, respectively, 0 ≤j ≤Nm.
The data rate of the jth link of Lm can be deﬁned as the smaller one of the
outport rate of Sm,j−1 and the import rate of Sm,j, 1 ≤j ≤Nm, which can be
expressed as:
R0
m,j = min{Rout
m,j−1, Rin
m,j}, 1 ≤j ≤Nm
(3)
Assuming user ﬂow has a minimum data rate requirement, denoted by Rmin,
only the routes meeting this constraint can be selected as the transmission route.
Denoting Ψ as the set of the candidate routes, we obtain:
Ψ = {Lm|R0
m ≥Rmin, 1 ≤m ≤M}.
(4)
3.2
Optimal Route Selection Strategy
To obtain the optimal route, we examine the transmission performance of all
the candidate routes, and select the one oﬀering the best performance. In par-
ticular, we focus on the end-to-end transmission performance and evaluate the

32
G. Jiang et al.
throughput of the candidate routes by jointly considering the characteristics of
user ﬂow and the service capability of the switches. Denote Tm, 1 ≤m ≤M,
as the throughput of the mth route, we obtain the optimal route, denoted by
Lm∗as:
Lm∗= argmax {Tm}.
(5)
The detail evaluation of Tm will be discussed in the following section.
4
End-to-End Transmission Performance Evaluation
In this section, the transmission performance of the candidate routes between SS
and DS is evaluated based on Network Calculus theory [9], which is an eﬃcient
tool to analyze ﬂow control problems in networks mainly from a lower bound (i.e.,
worst case) perspective. The essential idea of network calculus is to transform
complex non-linear network systems into analytically tractable linear systems
by using alternate algebras, i.e., the min-plus algebra and max-plus algebra.
4.1
Brief Introduction of Network Calculus Theory
In this subsection, some concepts deﬁned in the theory of network calculus will
be introduced brieﬂy.
Deﬁnition 1: Min-plus Convolution. Let f and g be two functions or sequences
of time, the min-plus convolution of f and g is deﬁned as follows:
(f ⊗g)(t) =

inf
0≤s≤t{f(t −s) + g(s)}, t > 0
0,
t < 0.
(6)
Deﬁnition 2: Arrival Curve. Given a wide-sense increasing function α(t)
deﬁned for t ≥0, a ﬂow F(t) is constrained by α(t) if for all s ≤t, follow-
ing inequality holds:
F(t) −F(s) ≤α(t −s),
(7)
we say that α(t) is the arrival curve of F(t).
Deﬁnition 3: Service Curve. Consider a system S and a ﬂow with the input
and output functions respectively being F(t) and O(t) passing through S, we say
that S oﬀers a service curve β(t) to the ﬂow if and only if β(t) meets following
conditions:
β(0) = 0,
(8)
O(t) ≥(F ⊗β)(t).
(9)

End-to-End Transmission Performance Optimization
33
Deﬁnition 4: Eﬀective Bandwidth. Consider a ﬂow with arrival curve α(t)
passing through a system S, for a given delay L = θ + sb
r , where θ and sb
denote respectively the service delay and the burst tolerance of S, and r denotes
the service rate of S, we deﬁne the eﬀective bandwidth of the ﬂow, denoted by
eL(α), as the required throughput at t to serve the ﬂow in a work conserving
manner, i.e.:
eL(α) = sup
s≥0
{ α(s)
s + L}.
(10)
From the deﬁnition of eﬀective bandwidth, it can be seen that eﬀective band-
width represents the maximum transmitted data packets for a given time inter-
val, thus is equivalent to transmission throughput, which can be applied to char-
acterize the end-to-end transmission performance of the mth candidate route,
i.e., Tm in (5), when the ﬂow with arrival function being α(t) passes through a
system with the service curve being β(t). In the following subsections, we will
examine the transmission performance of candidate routes based on Network
Calculus theory. The arrival curve of user ﬂow and the service curve of switches
are formulated, then the eﬀective bandwidth of each route is evaluated.
4.2
Modeling Arrival Curve of User Flow
In this paper, referring to [10], we characterize the arrival curve of user ﬂow as
traﬃc-speciﬁcation (T-SPEC) model [11]. We deﬁne the set of T-SPEC param-
eters (r(m), s(m), r(s), s(b)), where r(m) and s(m) represent the maximum arrival
rate and the maximum packet size, respectively, r(s) and s(b) represent the sus-
tainable arrival rate and the burst tolerance, respectively, the arrival curve of
the user ﬂow can be modeled as:
α(t) = min{r(m)t + s(m), r(s)t + s(b)}.
(11)
4.3
Modeling Service Curve of Switches
In this paper, we assume that the switches are latency-rate (LR) system, of which
the service curve can be characterized by the service rate and the transmission
latency. For the jth switch of Lm, the service curve can be modeled as:
βm,j(t) = Rm,j(t −θm,j)+
(12)
where Rm,j and θm,j are respectively the service rate and the latency of the jth
switch of Lm, (x)+ = max{x, 0}. According to Network Calculus theory, the
joint service curve of Lm can be expressed as:
βm(t) = βm,1(t) ⊗βm,2(t) · · · ⊗βm,Nm(t) = Rm(t −θm)+
(13)
where Rm = min{Rm,1, Rm,2, · · ·, Rm,Nm}, θm = Nm
j=1 θm,j.

34
G. Jiang et al.
4.4
Eﬀective Bandwidth of the Candidate Routes
Substituting α(t) obtained in (11) into (10), and calculating L based on βm(t)
obtained in (13), after some simple mathematical manipulations, we can obtain
the eﬀective bandwidth when the user ﬂow transmitting through Lm, i.e.,
Tm = max

r(s), s(m)
θm
, (s(m) + r(m)Γm)
Γm + θm

(14)
where Γm = (s(b) −s(m))/(r(m) −r(s) ).
5
Performance Evaluation
In this section, we examine the performance of the proposed routing selection
algorithm via simulation. We consider a SDN scenario with the size being 100 ×
100 consisting of a SS, a DS and multiple intermediate switches. We assume that
all the switches are randomly located in a area. In the simulation, the numbers
of intermediate switches are chosen from 6 to 12, the parameters of the arrival
curve of the user ﬂow and those of switches are randomly chosen within certain
range, as shown in Table 1. For a randomly generated position distribution of
switches and the characteristics of arrival curve and service curve, the proposed
routing selection algorithm as well as the one proposed in [6] are conducted.
The simulation results are averaged over 1000 independent adaptation processes
where each adaptation process involves diﬀerent positions of switches and various
characteristics of arrival curve and service curve.
Table 1. Simulation parameters
Parameter name
Value
Peak rate (rm) (Mbps)
1.5–10
Maximum packet size (sm) (Kbit)
1–400
Average rate (rs) (Mbps)
0.7–3.5
Burst tolerance (sb) (Kbit)
38–140
Equivalent service rate (Rm,j) (Mbps) 10–100
Equivalent latency (θm,j) (ms)
10–60
The service rate of switches (Mbps)
10–80
The simulation iteration
1000
The simulation results are averaged over 1000 independent adaptation pro-
cesses where each adaptation process involves diﬀerent positions of switches. The
detailed parameters used in the simulation are shown in Table 1. Fig. 2 shows
the eﬀective bandwidth versus the number of switches. It can be seen from the
ﬁgure that the eﬀective bandwidth increases with the increase of the number of

End-to-End Transmission Performance Optimization
35
Fig. 2. Eﬀective bandwidth versus the number of the switches
Fig. 3. Eﬀective bandwidth versus service rate
switches, this is because for a large number of switches may oﬀer more options in
route selection compared to small number of switches, resulting in better trans-
mission performance in turn. Comparing the results obtained from our proposed
scheme and the one proposed in [6], we can see our proposed scheme oﬀers bet-
ter eﬀective bandwidth than previous scheme. The reason is that our proposed

36
G. Jiang et al.
scheme aims of selecting the route with the maximum eﬀective bandwidth, which
jointly considers the characteristics of user ﬂow and service capability of switches,
including both transmission rate and service delay, while the algorithm proposed
in [6] only stresses the transmission rate of switches. In Figs. 3 and 4, we exam-
ine the characteristics of one switch on route selection, for instance, we change
the service rate and service delay of the third switch, and examine the eﬀec-
tive bandwidth of the selected route. In Fig. 3, we plot the eﬀective bandwidth
versus the service rate of the third switch. It can be seen from the ﬁgure that
the eﬀective bandwidth increases slightly with the increase of the service rate
of the switch, this is because higher service rate of the switch will oﬀer better
transmission performance. Comparing the results obtained from our proposed
scheme and the one proposed in [6], we can see our proposed scheme oﬀers better
performance than previous scheme.
Fig. 4. Eﬀective bandwidth versus service delay
In Fig. 4, we plot the eﬀective bandwidth versus the service delay of the third
switch. It can be seen from the ﬁgure that the eﬀective bandwidth decreases with
the increase of the service delay of the switch for small service delay, then the
eﬀective bandwidth will not change clearly with the increase of the service delay.
This is because higher service delay of the switch will result in small eﬀective
bandwidth. However, as the service delay is relatively high, the optimal route
obtained based on the proposed route selection algorithm may not involve the
third switch due to its deteriorated performance, thus the achieved eﬀective
bandwidth will not change. Comparing the results obtained from our proposed
scheme and the one proposed in [6], we can see our proposed scheme oﬀers better
performance.

End-to-End Transmission Performance Optimization
37
6
Conclusion
In this paper, we propose an optimal route selection algorithm for SDN which
aims of achieving end-to-end performance optimization of user ﬂow. Through
applying Network Calculus theory, we jointly take into account the character-
istics of arrival curve and switches of the network, formulate the transmission
performance of user ﬂow as eﬀective bandwidth, and then the route oﬀering the
maximum eﬀective bandwidth is selected as the optimal route. The numerical
results demonstrate that compared to previous algorithm, our proposed algo-
rithm achieves much better performance in terms of eﬀective bandwidth.
Acknowledgement. This work is supported by the National Science and Technology
Speciﬁc Project of China (2016ZX03001010-004) and the 863 project (2014AA01A701),
the special fund of Chongqing key laboratory (CSTC) and the project of Chongqing
Municipal Education Commission (Kjzh11206).
References
1. Matias, J., Garay, J., Toledo, N., et al.: Toward an SDN-enabled NFV architecture.
IEEE Commun. Mag. 53(4), 187–193 (2015)
2. Gantz, J., Reinsel, D.: Extracting value from chaos, Idcemc2 Report, pp. 1–12.
Framingham, MA, USA, White Paper, June 2011
3. Adami, D., Antichi, G., Garroppo, R.G., et al.: Towards an SDN network control
application for diﬀerentiated traﬃc routing. In: IEEE International Conference on
Communications (ICC) (2015)
4. Porxas, A.X., Lin S.C., Luo, M.: QoS-aware virtualization-enabled routing in
software-deﬁned networks. In: IEEE International Conference on Communications
(ICC), pp. 5771–5776, June 2015
5. Zhang, S.Q., Zhang, Q., Bannazadeh, H., et al.: Routing algorithms for network
function virtualization enabled multicast topology on SDN. IEEE Trans. Netw.
Serv. Manag. 12(4), 580–594 (2015)
6. Al-Jawad, A., Trestian, R., Shah, P., et al.: BaProbSDN: A probabilistic-based QoS
routing mechanism for software deﬁned networks. In: IEEE Network Softwarization
(NetSoft), London, pp. 1–5, June 2015
7. Lee, D., Hong, P., Li, J.: RPA-RA: a resource preference aware routing algorithm in
software deﬁned network. In: IEEE Global Communications Conference (GLOBE-
COM), San Diego, pp. 1–6 (2015)
8. Huang, H., Guo, S., Li, P., et al.: Joint optimization of rule placement and traﬃc
engineering for QoS provisioning in software deﬁned network. IEEE Trans. Com-
put. 64(12), 3488–3499 (2015)
9. Le Boudec, J.-Y., Thiran, P. (eds.): Network Calculus: A Theory of Deterministic
Queuing Systems for the Internet. LNCS, vol. 2050. Springer, Heidelberg (2001).
https://doi.org/10.1007/3-540-45318-0
10. Shenker, C.P.S., Guerin, R.: Speciﬁcation of guaranteed quality of service,
RFC2212 (1997)
11. Liu, Y., Jiang, Y.: Stochastic Network Calculus. Springer, London (2008). https://
doi.org/10.1007/978-1-84800-127-5

Research on Video Services with QoE
Perception Over Future Wireless Networks
Qinghua Zhu1(&), Jinglu Zhang1, Gongsheng Zhu1,
and Xiaokui Chen2
1 School of Telecommunication Engineering,
Beijing Polytechnic, Beijing 100176, China
3170312109@QQ.com
2 Beijing University of Posts and Telecommunications, Beijing 100876, China
Abstract. Research on video services with QoE (quality of experience) per-
ception, through the analysis of the characteristics of the video service as well as
its service quality inﬂuence and combined with the practical application of the
scene, this paper presents a QoE perception model based on the characteristics
of video frame. Based on MPEG compression coding and the independence
between the video frames are proposed by this paper, and discussed the frame
structure and the effect of FLR for QoE of video services. Simulation results
show that QoE perception model proposed can effectively evaluate the inﬂuence
of FLR of QoE of video services, and has very strong practicability of this scene
in the real-time video transmission. The results show that in order to ensure the
QoE, the packet loss of video frames must control in the process of transfer.
Keywords: Wireless video services  QoE perception
Future wireless network
1
Introduction
With the rapid development and wide application of in 5G wireless network, video
streaming has taken up most of today’s network trafﬁc, and the digital video services
have brought new challenges to the future wireless network [1, 2], which mainly reﬂect
in: the evaluation on service quality is experiencing the transformation from QoS to
QoE [3]. In the conventional mobile communication system, the band width, time
delay, jitter, packet loss rate and other QoS parameters are typically considered as the
indicator of measuring service quality. For the mobile Internet business especially the
video services, the corresponding evaluation of the service quality is not only related to
the transmission parameters of the wireless network physical layer, but also related to
service characteristics and users’ experience environment, and therefore QoE is gen-
erally used for evaluating the user quality. QoE is an application and service-level
protection mechanism. The service quality evaluated from the perspective of users is
not only based on the relevant QoS parameters, but also combined with the service
characteristics, which can be better able to reﬂect the users’ subjective feelings.
QoS/QoE requirements are varied for different types of services [4–7]. For example, the
ﬁles downloading, web pages browsing and other data services do not have the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 38–51, 2018.
https://doi.org/10.1007/978-3-319-72823-0_5

real-time requirements, but they have the clear requirements for the accuracy of the
transmission data; for example, the real-time video services are more sensitive to time
delay, so it’s essential to make sure that data can be transmitted timely.
The video service QoE perception algorithm plays a signiﬁcant role in video call,
video conferencing, video surveillance, and video on demand and other ﬁelds, which is
the feedback measurement of users towards the video service quality, but even an
important tool to guarantee video quality [8, 9].
The video quality is originally reﬂected through people’s subjective visual feeling
towards the video, but because people’s subjective evaluation will require a lot of time
and efforts, and the differences between individuals have a larger impact on the
evaluation results, people are in an urgent demand for some objective, quantitative
mathematical model to express their subjective feeling towards the wireless video. This
requires to starting from the basic characteristics of the video services of the wireless
network to build an video QoE perception system that can penetrate into the wireless
network and meet different demands, so as to improve the accuracy of video quality
assessment and increase the utilization of wireless network resources as much as
possible, safeguarding the service quality of future wireless network.
Currently, the QoE subjective and QoE objective evaluation methods are mainly
used as the video service QoE assessment method. Among them, the subjective QoE
perception method is to let the subjects to continuously watch the test sequence in a
controlled environment, which will be lasted for about 10–30 min, and then is to
conduct the subjective ratings for the watched video sequences, thus to ﬁnally calculate
MOS (Mean Opinion Score). Wherein the controlled environment includes: The
selection of the test environment, the viewing distance, the test material (video
sequences), and the intervals of time display of the test sequence, etc. For subjective
quality assessment method, currently the widely used method is mainly from ITU
organization, including DSCQS (Double Stimulus Continuous Quality Scale), SSCQE
(Single Stimulus Continuous Quality Scale), DSIS (Double stimulus Impairment
Scale), ACR (Absolute Category Rating) and PC (Pair Comparison), etc.
The objective QoE perception method of video quality is to use a mathematical
model to analyze the test sequence, thus to ﬁnally obtain the perception results of the
video quality. The objective perception method can be divided into the following three
types
according
to
whether
there’s
the
original
video
for
reference:
FR
(Full-Reference), RR (Reduce-Reference) and NR (No-Reference). The corresponding
full reference evaluation method requires a full video reference to compare its quality
with the distorted test sequence, thereby getting the score. Reduced reference evalua-
tion method is mainly to discover the distortion through comparison of the extracted
reduced reference, so these reference characteristics should be able to better reﬂect the
distortion of coding and channel transmission. The vast majority of the algorithm is to
extract the characteristic of space-time domain, as well as to extract the video image
edges, but there’s also the algorithm of extracting the values calculated based on the
pixel values, such as the mean, standard deviation, etc., in addition, there’s also the
algorithm of extracting video spatial or temporal activity [10] (video activity describes
the strong extent of the visual perception motion of video sequences to users [11]).
Saviotti proposed evaluation method based on digital watermark, adding watermark in
Research on Video Services with QoE Perception
39

a video image to predict the video distortion at the receiving end through measurement
of the watermark image distortion [12]. No-reference evaluation method does not
require any reference information, and it derives the video distortion directly through
the evaluation of the distortion video. The method has a very great signiﬁcance for
future wireless video services, and it can reduce the transmission content compared
with the two evaluation methods of full reference and reduced reference, thereby
reducing the band width. However, since no-reference algorithm is too complicated,
there’s limited research results currently.
The subjective evaluation method is not widely used due to its low real-time, cost
of manpower and resources, while the objective method is to use the mathematical
models, there’s no need to consume too much manpower. In the objective evaluation
method, the results of full reference are closer to the results of human eye perception;
and the results of the reduced reference are worse than the results of the full reference
and it requires the additional band width to transmit the reference signal, therefore, it
has little research signiﬁcance; no-reference method is with higher practical value,
because it can use the video features captured currently within a short time to directly
obtain the video QoE indicators, which is with the characteristics of simple calculation
and high real-time, and therefore it is also the research focus.
Through the study of QoE perception method based on pixel-domain and QoE
method based on frame characteristics, this thesis uses mutual independence between
MPEG-based coding-decoding characteristics and video frames to propose the trans-
mission strategy with a combination of modulation and coding strategy, video packet
re-transmission, and service quality, and also the study of the impact of frame structure
and frame loss rate on QoE, and builds the objective evaluation model of the video
service transmission.
2
Service Quality Evaluation Method Based on Video Frame
Characteristics
The wireless video quality is closely related to its consistency of time domain, this
feature determines the real-time of video services, and even does not allow the video to
have any Caton phenomenon. In addition, the video quality is also greatly related to the
audio corresponding to videos, and therefore it needs the received video and audio
information to be strictly synchronous, there’s even more strict requirement for the
synchronization between voice and image of the video on demand, video conferencing,
if the voice is not exactly match with the image, it will seriously affect the viewing
effects of the audience. Since the real-time video feature, the corresponding evaluation
also needs to have real-time feature. Thus, although the full-reference video quality
evaluation method have better performance, it can’t meet the requirements, therefore,
this thesis adopts the no-reference video quality evaluation method considering the
frame loss rate based on video frame characteristics.
In MPEG coding and decoding, the image group includes three categories of frame,
namely I-frame, B-frame and P-frame, the loss of different categories of frame will have
different impacts on decoding quality of the receiving end [13]. The method proposed
40
Q. Zhu et al.

in this thesis is to use the independence between MPEG-based coding-decoding
characteristics and video frames to study the impact of the frame structure and frame
loss rate on QoE.
2.1
MPEG Image Group
The MPEG (Moving Pictures Experts Group) is a video compression coding standard,
which mainly uses inter-frame compression coding technology with motion compen-
sation to reduce the temporal redundancy; using DCT (Discrete Cosine Transform)
technology to reduce the spatial redundancy of the image, the use of the entropy coding
is to reduce the statistical redundancy in terms of information expression. In order to
save network band width, video data will be transmitted after being encoded. There are
three types of frames in MPEG standard video coding sequence: I-frame (Intra-coded
Picture), P-frame (Predictive-coded Picture), B-frame (Bidirectional Predicted Picture).
Wherein I-frame is to code by using its own information without any reference to other
frames; P-frame refers to the preceding I-frame or P-frame, and it is to code based on
the motion differences; B-frame is to make the bidirectional coding by using P-frame
before and after it, so it is with the higher compression ratio. When decoding, if
B-frame loss will not cause too much impact, P-frame loss will not affect the I-frame,
but it will affect P-frame and B- frame associated with it, I-frame loss will make
P-frame and B-frame associated with it can’t be decoded, so the loss of different frames
will have varied impacts on QoE [14].
According to the distance between I-frames in a video sequence, all of the frames
are divided into GOP (Group of Picture), so there’s only one I-frame in each
GOP. A common GOP structure is generally described by using (N, M), wherein N is
the distance between one I-frame and the next I-frame, M is the distance between
Fig. 1. Open GOP structure diagram
Fig. 2. Closed GOP structure diagram
Research on Video Services with QoE Perception
41

I-frame and the next P-frame. For example, one GOP may be such a composition:
IBBPBBPBBPBB, which is referred to as (12, 3), where 12 represent the length of
GOP, 3 is the distance between I-frame and P-frame. For such a frame, the last B-frame
is coded with reference to I-frame of the next GOP, and such GOP is called as the open
GOP, as shown in Fig. 1. The other is such as GOP of (10, 3): IBBPBBPBBP, the last
B-frame is with the reference to P-frame in GOP, so such GOP is called as the closed
GOP as shown in Fig. 2. Suppose N represents the total number of I-frame, P-frame
and B-frame in one GOP, and NI, NP and NB respectively represents the number of
I-frame, P-frame and B-frame, thus it may be inferred that for an open GOP, the
number of P-frame is N=M  1, and for a closed GOP, the number of P-frame is
ðN  1Þ=M, the number of B-frame is N  NP  1. Therefore, regarding to any kind of
GOP, there will be the following formula:
NI ¼ 1
NP ¼
N  1
ð
Þ=M
½

NB ¼ N 
N  1
ð
Þ=M
½
  1:
ð1Þ
In the formula (1),
a½  represents the rounding of a. In an open GOP,
NB ¼ NP þ 1
ð
Þ  M  1
ð
Þ, and in a closed GOP, NB ¼ NP  M  1
ð
Þ, this thesis uses
a variable u to represents the type of GOP, when u ¼ 1, GOP is an open GOP, when
u ¼ 0, indicating that GOP is a closed GOP. Therefore, u value can be calculated
directly from GOP result, as shown in formula (2):
u ¼
NB
M  1  NP ¼ N  1  N1
M
M  1
 N  1
M
:
ð2Þ
2.2
QoE Perception Model Based on Frame Characteristics
Decodable frame rate refers to the part of the video frames that can be completely and
correctly seen by users after they are decoded by the Player, so it is directly related to
the user perception and only related to the video signal received by users. The literature
[15] introduces the decodable frame rate, supposing that the loss of each frame is
independent, and the analytical model of the decodable frame rate depends on the
probability of a frame loss, such analytical model has been used in some research on
wireless transmission network. In some other studies [16, 17], they compare PSNR and
decodable frame rate under the same scene and frame parameters, the conclusion is that
decodable frame rate is consistent with the video quality evaluation result based on
PSNR, both can reﬂect the visual effect quality shown by the video to users, so MOS
video quality can be estimated by decodable frame rate at the reasonable estimation
accuracy.
Decodable frame rate can evaluate the video quality by spending less time on the
receiving end to assess the video quality. Decodable frame rate is also known as Q, in
this thesis Q will be used as the assessment measurement of video services in the
wireless network.
42
Q. Zhu et al.

Prior to the video transmission, the ﬁrst is to divide each frame of the images of
video data into certain number of data packets for transmission, real-time transmission
of video services is conducted according to the corresponding needs, since there’s large
amount of data and demanding real-time, UDP connection is generally adopted for
transmission of video data in order to avoid the network collapse. However, the
characteristics of best efforts of UDP show that the non-reliability of UDP is bound to
make the packet loss become a problem must be considered, the missing of a packet in
one frame will make the whole video impossible to be decoded, and this will certainly
affect the video QoE, and it is also a major factor affecting QoE in wireless network
video services.
Different types of frame loss will make the number of decodable frame loss to be
varied, herein the decodable frame rate is deﬁned as Q to represent the quality of the
video sequence, and Q represents the ratio of the number of decodable frame and the
total number of received frame. Supposing, and respectively represents the loss
probability of I-frame, P-frame and B-frame, and there’s the mutual independence
between frames, then for an open GOP structure that can be expressed as (N, M), the
decodable frame rate Q of its video sequence can be derived as follows:
(1) The mathematical expectation for calculating the number of decodable I-frame is
NDI. In a GOP, I-frame is to code by using its own information without any
reference to other frames, therefore NDI ¼ ð1  FLRIÞ;
(2) The mathematical expectation for calculating the number of decodable P-frame is
NDP. In a GOP, only when the preceding I-frame and P-frame can be decoded, can
P-frame be decoded accordingly. SðPnÞ represents probability for nth P-frame to
be decoded:
SðP1Þ ¼ ð1  FLRIÞ  ð1  FLRPÞ
SðP2Þ ¼ ð1  FLRIÞ  ð1  FLRPÞ2
. . .
SðPNPÞ ¼ ð1  FLRIÞ  ð1  FLRPÞNP
Thus, there’s:
NDP ¼
XNP
i¼1 SðPiÞ ¼ ð1  FLRIÞ
XNP
i¼1 ð1  FLRPÞNP:
ð3Þ
(3) The mathematical expectation for calculating the number of decodable P-frame is
NDB. In a GOP, only when the preceding or the following I-frame and P-frame can
be decoded, can P-frame be decoded accordingly. Especially the last B-frame is
based on the preceding P-frame coding and following I-frame coding, thus the last
B-frame is affected by two I-frames. SðBnÞ represents the probability for nth
B-frame can be decoded:
Research on Video Services with QoE Perception
43

SðB1Þ ¼ ð1  FLRIÞ  ð1  FLRPÞ  ð1  FLRBÞ
SðB2Þ ¼ ð1  FLRIÞ  ð1  FLRPÞ2  ð1  FLRBÞ
. . .
SðBN
M1Þ ¼ ð1  FLRIÞ  ð1  FLRPÞ
N
M1  ð1  FLRBÞ
SðBN
MÞ ¼ ð1  FLRIÞ2  ð1  FLRPÞ
N
M1  ð1  FLRBÞ
Therefore, the formula (4) is concluded:
NDB ¼ ðM  1Þ
XN
M
i¼1 SðBiÞ ¼ ðM  1Þð1  FLRIÞð1  FLRBÞ
XN
M1
j¼1 ð1  FLRPÞ jð1  FLRBÞ þ ð1  FLRIÞð1  FLRPÞ
N
M1
h
i
:
ð4Þ
(4) Calculate the ratio of decodable frame Q, as shown in formula (5).
Q ¼ NDI þ NDP þ NDB
N
:
ð5Þ
Formula (5) can be further expressed as:
Q ¼ 1  FLRI
ð
Þ þ 1  FLRI
ð
Þ PNP
i¼1 1  FLRP
ð
Þi
N
þ M  1
ð
Þ 1  FLRI
ð
Þ 1  FLRB
ð
Þ PNP
i¼1 1  FLRP
ð
Þi þ 1  FLRI
ð
Þ 1  FLRP
ð
ÞNP


N
:
ð6Þ
The last part
1  FLRI
ð
Þ 1  FLRP
ð
ÞNP of formula (6) is only related to the last
B-frame that needs to take a reference of the decoding I-frame in the following GOP, so
decodable frame rate Q of the video sequence for any GOP structure can be expressed
as:
Q ¼ 1  FLRI
ð
Þ þ 1  FLRI
ð
Þ PNP
i¼1 1  FLRP
ð
Þi
N
þ M  1
ð
Þ 1  FLRI
ð
Þ 1  FLRB
ð
Þ PNP
i¼1 1  FLRP
ð
Þi þ u 1  FLRI
ð
Þ 1  FLRP
ð
ÞNP


N
:
ð7Þ
Q is a measurement of the video quality of the receiving end, and we have ﬁnally
established the method for video QoE assessment based on frame loss rate.
44
Q. Zhu et al.

Formula (7) can be further simpliﬁed, it is considered that there’s little change of
the frame loss rate of a video sequence, therefore, it is assumed that each type of frames
has the same frame loss rate, if the frame loss rate of I-frame, P-frame and B-frame is
the
same
when
there’s
the
transmission
of
the
video
services,
namely,
FLR ¼ FLRI ¼ FLRP ¼ FLRB, then
Q ¼ 1  FLR
ð
Þ þ 1  FLR
ð
Þ PNP
i¼1 1  FLR
ð
Þi
N
þ
M  1
ð
Þ 1  FLR
ð
Þ2 PNP
i¼1 1  FLR
ð
Þi þ u 1  FLR
ð
ÞNP þ 1
h
i
N
:
ð8Þ
3
Simulation Results and Performance Analysis
3.1
Experimental Network and Its Encoding Parameter Setting
Figure 3 is the architecture of the experimental network, the entire network environ-
ment is built based on NS2 [18] environment. Network has two emission sources, one
is to generate the background stream of CBR (Constants Bit Rate), which is to transmit
the CBR data packet at a rate of 1 Mbps; and the other is to generate MPEG4 video
stream, which is to transmit the data packet at a rate of 10 Mbps. The router is to
connect the wireless network at a rate of 10 Mbps, the connection frequency is 1 ms.
The wireless network is to transmit the data to the mobile endpoint via WLAN at a rate
of 11 Mbps.
In the simulation, this thesis assumes that: (1) when connected to the network, there
is no loss of the video packet; (2) the loss of a video packet will make it impossible to
decode the entire video frame.
In this thesis, the video can be divided into three types according to the time
characteristics and space characteristics: SM (Slight Movement), GW (Gentle Walking)
and RM (Rapid Movement). Parameter settings based on application layer and the
transport layer are as shown in Table 1.
CBR Background Traffic
1 Mbps
10 Mbps，10 ms
11 Mbps
Fig. 3. Experimental network architecture
Research on Video Services with QoE Perception
45

3.2
Comparative Analysis of Q and PSNR
The experiment of this thesis is to use PSNR and Q indicators in Evalvid [19] to study
the effectiveness of video service quality evaluation. Three different types of videos are
used respectively in the simulation, namely, foreman, highway and coastguard.
Figure 4 is the Q and PSNR comparative ﬁgure of different types of videos.
Table 1. Parameter values of application layer and the transport layer:
Video
sequences
Frame rate
(fbps)
Transmission
rate (kb/s)
Link rate (kb/s) FLR
SM
10, 15, 30
18
32, 64, 128
0.01, 0.05, 0.1,
0.15, 0.2
44
80
GW
10, 15, 30
18
128, 256, 384
0.01, 0.05, 0.1,
0.15, 0.2
44
80
RM
10, 15, 30
80
384, 512, 768
0.01, 0.05, 0.1,
0.15, 0.2
104
512
26
28
30
32
34
36
38
0.4
0.5
0.6
0.7
0.8
0.9
1
PSNR
Decodahie Frame Rate (Q) 
coastguard
foreman
highway
Fig. 4. Comparison of PSNR and Q in different types of video
46
Q. Zhu et al.

It can be known from the simulation results that when Q is increased, PSNR is also
increased accordingly. Based on the relationship between Q and PSNR, it can be
considered that Q indicator is the same to PSNR to reﬂect the service quality of the
video.
3.3
Analysis of Factors Affecting Q
Figure 5 compares the effect of changes in B-frame on video quality. Figures 6 and 7
respectively compares the impact of the total length of the video frame on video quality
under the condition of open and closed GOP. Figure 8 compares the impact of frame on
video quality whether GOP is open.
Through the analysis, it can be found that: (1) With the increase of video frame loss
rate, the video quality at the receiving end shows the decreasing trend, and therefore in
the wireless video transmission, it’s essential to minimize the frame loss rate as much
as possible in order to improve the quality of the service experience; (2) when the frame
loss rate is smaller, the more B-frames in a sequence, the higher the video quality;
(3) when the frame loss rate is smaller, the longer a GOP sequence, its video quality
will be lower; (4) when the frame loss rate is smaller, there’s little impact on the
corresponding service quality whether a video frame is open.
Fig. 5. Effects of changes in B frames on video quality
Research on Video Services with QoE Perception
47

Fig. 6. Effects of open GOP video with different length frame on video quality
Fig. 7. Effects of closed GOP video with different length frame on video quality
48
Q. Zhu et al.

4
Conclusion
The wireless network services are with the interaction, real-time, integration and other
characteristics, thus the evaluation model is required to be a non-parameter evaluation
model with good real-time. The impact of wireless network on the video is mainly for
the packet loss resulting in frame loss, so this thesis is committed to ﬁnding a
frame-level evaluation model. The perception method based on the pixel domain is
simple and intuitive, and easy to calculate, but it only considers the energy of the
signal, overlooking the impact of video content on the perception quality, which
sometimes makes the results to be inconsistent with human eye perception, especially
for the same original signal, two distortion signals with the same PSNR are not nec-
essarily the same. In addition, PSNR needs to take a longer time to compare the
corresponding frames of the original video and distortion video to obtain the evaluation
parameters, and therefore it does not meet the requirements. This thesis presents a
transmission strategy with a combination of modulation and coding strategy, video
packet retransmission and service quality can meet the needs of future wireless network
for the video services.
Fig. 8. The effect of video quality in open or closed GOP
Research on Video Services with QoE Perception
49

References
1. Zhang, H., Dong, Y., Cheng, J., Hossain, M., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
2. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
3. Shao, H., Lu, L., Wen, X., Zhang, H., Chen, Y., Hong, Y.: Content-aware video QoE
coverage analysis in heterogeneous wireless networks. Wirel. Pers. Commun. 90(2), 487–
502 (2016)
4. Shao, H., Wen, X., Jing, W., Lu, Z., Zhang, H., Chen, Y.: Joint optimization of quality of
experience and power consumption in OFDMA multi-cell networks. IEEE Commun. Lett.
20(2), 380–383 (2016)
5. Ma, W., Zheng, W., Zhang, H., Wen, X.: MOS-driven energy efﬁcient power allocation for
wireless video communications. In: Proceedings of IEEE Globecom (2012)
6. Ma, W., Zheng, W., Zhang, H., Wen, X., Lu, Z.: Distortion-guaranteed energy saving power
allocation for downlink OFDMA multiuser video transmission. J. Inf. Comput. Sci. 9, 3011–
3019 (2012)
7. Gómez, G., Hortigüela, L., Pérez, Q., Lorca, J., García, R., Aguayo-Torres, M.C.: YouTube
QoE evaluation tool for android wireless terminals. EURASIP J. Wirel. Commun. Netw.
2014, 1–14 (2014)
8. He, S., Tang, A., Zhang, H.: High-performance implementation of OFDM-MIMO base-band
in wireless video system. Inf. Technol. J. 13, 1678–1685 (2014)
9. Shen, Y., Jiang, C., Quek, T., Zhang, H., Ren, Y.: Device-to-device cluster assisted
downlink video sharing - a base station energy saving approach. In: Proceedings of IEEE
GlobalSIP, Atlanta, Georgia, USA (2014)
10. Yang, C., Ro, C.W.: Resource utilization and QoS analysis for differentiated services in
wireless cellular networks. In: 2012 8th International Conference on IEEE Computing and
Networking Technology (ICCNT), pp. 264–267 (2012)
11. Huo, Y., Jing, T., Zhang, D., Feng, Y.: Error distribution feedback quantization scheme
based on HVS. In: Signal Processing, vol. 25, no. 4, pp. 537–542 (2009)
12. Bucciol, P., et al.: Cross. In: Global Telecommunications Conference, GLOBECOM 2004,
vol. 5, pp. 3027–3031. IEEE (2004)
13. Khan, A., Sun, L., Ifeachor, E.: Impact of video content on video quality for video over
wireless networks. In: Fifth International Conference on Autonomic and Autonomous
Systems, ICAS 2009, pp. 277–282. IEEE (2009)
14. Ma, X., Liu, J., Jiang, H.: Energy-efﬁcient mobile data uploading from high-speed trains.
Mob. Netw. Appl. 17(1), 143–151 (2012)
15. Cheng, R.S., et al.: Improving performance of MPEG-based stream by SCTP multi-
streaming mechanism. In: 2010 5th International ICST Conference on Communications and
Networking in China (CHINACOM), pp. 1–6 (2010)
16. Ke, C.H., et al.: An evaluation framework for more realistic simulations of MPEG video
transmission. J. Inf. Sci. Eng. 24(2), 425–440 (2008)
17. Singh, K.D., Rubino, G.: Quality of experience estimation using frame loss pattern and video
encoding characteristics in DVB-H networks. In: Packet Video Workshop International
2011, pp. 150–157 (2011)
50
Q. Zhu et al.

18. NS2. http://www.isi.edu/nsnam/ns/
19. Klaue, J., Rathke, B., Wolisz, A.: EvalVid – a framework for video transmission and quality
evaluation. In: Kemper, P., Sanders, William H. (eds.) TOOLS 2003. LNCS, vol. 2794,
pp. 255–272. Springer, Heidelberg (2003). https://doi.org/10.1007/978-3-540-45232-4_16
Research on Video Services with QoE Perception
51

Tree-LSTM Guided Attention Pooling
of DCNN for Semantic Sentence Modeling
Liu Chen1,3(&), Guangping Zeng1,3, Qingchuan Zhang2,3,
and Xingyu Chen1,3
1 School of Computer and Communication Engineering,
University of Science and Technology Beijing, Beijing, China
chenliueve@163.com, zgp@ustb.edu.cn, cscserer@sina.com
2 School of Computer and Information Engineering,
Beijing Technology and Business University, Beijing, China
zqc1982@126.com
3 Beijing Key Laboratory of Knowledge Engineering for Materials Science,
Beijing, China
Abstract. The ability to explicitly represent sentences is central to natural
language processing. Convolutional neural network (CNN), recurrent neural
network and recursive neural networks are mainstream architectures. We intro-
duce a novel structure to combine the strength of them for semantic modelling of
sentences. Sentence representations are generated by Dynamic CNN (DCNN, a
variant of CNN). At pooling stage, attention pooling is adopted to capture most
signiﬁcant information with the guide of Tree-LSTM (a variant of Recurrent NN)
sentence representations. Comprehensive information is extracted by the pooling
scheme and the combination of the convolutional layer and the tree long-short
term memory. We evaluate the model on sentiment classiﬁcation task. Experi-
ment results show that utilization of the given structures and combination of
Tree-LSTM and DCNN outperforms both Tree-LSTM and DCNN and achieves
outstanding performance.
Keywords: Dynamic Convolutional Neural Network (CNN)
Tree-Structured Long-Short Term Memory (Tree-LSTM)
Attention Pooling  Semantic Sentence Modeling
1
Introduction
The sentence modelling problem is an essential component of natural language pro-
cessing (NLP) and has drawn mass attention recently. The objective of sentence
modelling is to analyze and represent the semantic content of a sentence for purposes of
sentiment analysis, document summarization, machine translation, discourse analysis,
etc. [1]. Sentence features, the key of sentence modeling, are usually extracted from
features of word representations.
With advances in word vector representation [2, 3], word vectors become a com-
mon practice of word representation for classiﬁcation. Vector representations of words
can even preserve the semantic relationship [4]. In the vector space, words with similar
semantics lie close in Euclidean or cosine distance.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 52–59, 2018.
https://doi.org/10.1007/978-3-319-72823-0_6

Recently, neural network methods have achieved outstanding performance namely
recursive neural networks (Recursive NN) [5], recurrent neural networks (Recurrent
NN) [6] and convolutional neural networks (CNN) [7].
The recursive neural networks of [5, 8, 9] rely on syntactic parse trees and recur-
sively compose sentence representation from child nodes in the parse tree. The learning
performance of recursive neural networks depends much on the construction of the
textual tree which can be quite time-consuming.
The recurrent neural networks of [10, 11] compose word vectors from one end to the
other stores the information of all previous contexts in a ﬁxed-sized hidden layer. RNNs
with Long Short-Term Memory (LSTM) units [12] have re-emerged as a popular
architecture due to their representational power and effectiveness at dealing with van-
ishing gradient problem and capturing long-term dependencies. Studies of [12, 13]
proposed an improved variant of Recurrent NN which integrate Recursive NNs by
feeding syntactic parse tree into LSTM.
CNN was originally proposed in computer vision [14], and recently it becomes
popular in NLP tasks. Different from Recursive and Recurrent NNs, CNN encodes word
vectors by convolution operation and generates a ﬁxed-sized high-level representation by
pooling. [7] proposed a Dynamic Convolutional Neural Network (DCNN) with multiple
layers of convolutional and dynamic pooling operations which handles input sentences of
varying length and forms feature maps which is capable of explicitly capturing syntactic
or semantic relations between nonconsecutive parts within the input sentence.
In this paper, we introduce an attention pooling dynamic CNN architecture (ab-
breviated to AP-DCNN) to combine the beneﬁts of CNN, Recursive and Recurrent
NNs with attention pooling schema. The AP-DCNN can be considered a variant of
APCNN in [15] where the attention pooling scheme is proposed. The Tree-LSTM
model [16] is employed to enhance the information extraction capability of the pooling
layer. The Tree-LSTM model is also concatenated with the convolutional structure to
extract comprehensive information, namely historical, future and local context infor-
mation, of any position in a sequence at the testing phase.
We conduct experiments on sentiment analysis task of Stanford Treebank Datasets
and results show that utilization of the given structures and combination of Tree-LSTM
and DCNN leads to better performance.
2
The Proposed AP-DCNN Model
The architecture of the AP-DCNN model is shown in Fig. 1. The following subsections
describe the proposed model in detail.
2.1
Word Embedding
The input of the model is N sentences with variable lengths. Each sentence S is con-
stituted by words which are represented by vectors. Recent researches have demon-
strated that continuous word representation is a popular and powerful method for
sentence classiﬁcation tasks. A word vector can be formed as follows:
Tree-LSTM Guided Attention Pooling of DCNN
53

x ¼ Wp;
ð1Þ
where p 2 RV is a one-hot vector where the position the word appears is 1 while the others
are 0, W 2 RdV is a word-representation matrix, in which the i th column is the vector
representation of the i th word in the vocabulary, and V denotes the vocabulary size.
We adopt the publicly available word2vec vectors as initial word embedding
matrices to make adequately use of semantic and grammatical associations of words.
The vectors, with dimension of 300, are trained on 100 billion words from the Google
News by using the continuous bag-of-words method [3] and maximizing the average
log probability of all the words [17]. Words not present in the set of pre-trained words
are initialized randomly.
Fig. 1. Architecture of AP-DCNN. Convolution ﬁlters perform convolutions on the input
sentence matrix to generate local Sentence representations. An attention pooling scheme is used
to integrate local representations into the ﬁnal sentence representation with attention weights.
These weights are composed by comparing local representations with Tree-LSTM based
sentence representation by position and optimized during the training phase.
54
L. Chen et al.

2.2
DCNN Based Sentence Representation
Convolutional layers play signiﬁcant roles in the success of the CNN because they can
encode signiﬁcant information contained in input data with signiﬁcantly fewer
parameters than other deep learning architectures. We adopt the Dynamic Convolu-
tional Neural Network (DCNN) for the semantic modelling of sentences. The network
uses Dynamic k-Max Pooling [7], a global pooling operation over linear sequences.
The network handles input sentences of varying length and induces a feature graph
over the sentence which is capable of explicitly capturing short and long-range
relations.
The convolution operation at layer l is conducted between kl ﬁlters WT
l 2 Rmdkl
and a concatenation vector cl1i:i þ m1 which represents a window of m features starting
from the ith feature in the feature maps conducted in the last layer while l ¼ 1 repre-
sents the word embedding in the origin sentence.
The term d is the dimension of word embedding. Multiple ﬁlters with differently
initialized weights are used to improve the model’s learning capability.
The number of ﬁlters ktop is determined using cross-validation and the convolution
operation is governed by:
cli ¼ g WT
l cl1i:i þ m1 þ bl


2 Rkl;
ð2Þ
where kl denotes the number of ﬁlters in the current convolutional layer l, using:
kl ¼ max ktop; L  l
L
T




;
ð3Þ
where L is the total number of convolutional layers in the network.
Following the approach in [4, 18], we also use ﬁlters with varying convolution
window sizes to form parallel DCNNs so that they can learn multiple types of
embedding of local regions so as to complement each other to improve model accuracy.
Sentence representations produced by all the distinct DCNNs are concatenated to form
the ﬁnal feature vector as an input to the top SoftMax classiﬁer.
2.3
Tree-LSTM Based Sentence Representation
Tree-LSTM is a variant of LSTM. A Tree-LSTM unit (indexed by j) contains input and
output gates ij and oj, a memory cell cj and hidden state hj as a standard LSTM do,
while contains one forget gate fjk for each child k, which is the difference. This allows
the Tree-LSTM unit to selectively incorporate information from each child.
A Tree-LSTM unit at each node takes an input word vector xj which depends on the
tree structure used for the network. Given a tree, let C jð ÞK denote the set of K children
of node j. The transition proceeds as follows:
Tree-LSTM Guided Attention Pooling of DCNN
55

ij ¼ r W ið Þxj þ
X
k2C jð ÞK U ið Þ
k hjk þ b ið Þ

	
;
ð4Þ
fjk ¼ r W f
ð Þxj þ
X
l2C jð ÞK U ið Þ
kl hjl þ b f
ð Þ

	
;
ð5Þ
oj ¼ r W o
ð Þxj þ
X
k2C jð ÞK U o
ð Þ
k hjk þ b o
ð Þ

	
;
ð6Þ
uj ¼ tanh W u
ð Þxj þ
X
k2C jð ÞK U u
ð Þ
k hjk þ b u
ð Þ

	
;
ð7Þ
cj ¼ ij  uj þ
X
k2C jð ÞK fjk  ck;
ð8Þ
hj ¼ oj  tanh cj
 
;
ð9Þ
where in Eq. (5), k 2 C jð ÞK.
We use binary tree LSTM (K ¼ 2) because it suits more to constituency trees we
use. When the forgetting node has only one child, the model can be considered as the
standard LSTM. We denote the sentence representation as ~s.
2.4
Attention Pooling
In the attention pooling stage, we compare DCNN-based sentence representation and
Tree-LSTM based sentence representation to calculate the attention weights. By con-
trolling the output dimension of the Tree-LSTM same as the number of convolutional
ﬁlters ktop, we are able to map the both representations into the space of the same
dimension. The higher the similarity between the DCNN sentence representation and
Tree-LSTM representation, the bigger attention weight is assigned to DCNN repre-
sentation. The attention weights is given by:
ai ¼
exp sim ci;~s
ð
Þ
ð
Þ
PT
i¼1 exp sim ci;~s
ð
Þ
ð
Þ
:
ð10Þ
The function sim denotes a method to measure similarity between inputs where
cosine similarity is adopted. The ﬁnal sentence representation guided by the attention
weights is calculated by:
s ¼ a  c 2 RT:
ð11Þ
The ﬁnal sentence representation forms the input of the top classiﬁer.
2.5
Softmax Classiﬁer
The sentence representation s is naturally regarded as an input to the top classiﬁer
during the training phase while s;~s
½
 is used at the testing phase. A linear transfor-
mation layer and a softmax layer are added at the top of the model to produce
56
L. Chen et al.

conditional probabilities over the class space. To avoid overﬁtting, dropout with a
masking probability p is applied to the penultimate layer. The key idea of dropout is to
randomly drop units (along with their connections) from the neural network during the
training phase [19]. This output layer is calculated as follows:
z ¼
Ws s  q
ð
Þ þ bs
training phase
Ws s;~s
½ð
Þ þ bs
testing phase

;
ð12Þ
yc ¼
exp zc
ð Þ
P
c02C exp z0
c
  ;
ð13Þ
where q is the masking vector with dropout rate p which is the probability of dropping
a unit during training, and C is the class number. In addition, a l  2 norm constraint of
the output weights W s is imposed during training as well.
Let ~yc denotes the label of a sentence. Cross entropy loss function is given by:
L ¼ 
X
i2N
X
c2C ~yc Si
ð Þlog yc Si
ð Þ
ð
Þ;
ð14Þ
where ~yc codes in 1-of-K schema whose dimension corresponding to the true class is 1
while all others being 0. The parameters to be determined by the model include all the
weights and bias terms in the convolutional ﬁlters, the Tree-LSTM and the softmax
classiﬁer. The attention weights will be updated during the training phase. Word
embeddings are ﬁne tuned as well. Optimization is performed using the Adadelta
update rule of [20], which has been shown as an effective and efﬁcient back-
propagation algorithm.
3
Experiments and Results
3.1
Classiﬁcation
In this section, we evaluate the performance of the proposed model on the Stanford
Sentiment Treebank [21] benchmark dataset and compare it with several state-of-the-art
approaches.
The Stanford Sentiment Treebank contains about 11,800 sentences from the movie
reviews. The sentences were parsed with the Stanford parser [22]. There are two
subtasks: binary classiﬁcation of sentences excluding neutral reviews with class dis-
tribution of 4955/4663., and ﬁne-grained classiﬁcation over ﬁve classes: very positive,
positive, neutral, negative, very negative, with class distribution of 1837/3118/2237/
3147/1516. Standard binarized constituency parse trees are provided for each sentence
in the dataset, and each node in these trees is annotated with a sentiment label.
[23] provide a guide regarding CNN architecture and hyperparameters for practi-
tioners who deploy CNNs for sentence classiﬁcation tasks. We initialized our word
representations using publicly available 300-dimensional word2vec vectors. Word
representations were updated during training with a learning rate of 0.1. The DCNN
has two wide convolution layers with ﬁlters whose width is 7 and 5 respectively [7] and
Tree-LSTM Guided Attention Pooling of DCNN
57

100 feature maps. The networks use the tanh non-linear function. DCNN models were
trained using Adadelta with a learning rate of 0.05 and a minibatch size of 50.
The output dimension of the Tree-LSTM is set the same as the number of feature
maps in order to compare Tree-LSTM representations with DCNN representations. The
training batch size is set as 100.
All parameters were regularized with a per-minibatch L2 regularization strength of
10–4. The sentiment classiﬁer was additionally regularized using dropout with a
dropout rate of 0.5.
3.2
Result
Experiment results against other methods are listed in Table 1. The performance of
AP-DCNN outperforms the state-of-the-art models like BLSTM and APCNN on the
ﬁne-grained classiﬁcation subtask and achieves accuracy comparable to APCNN and
Tree LSTM on the binary classiﬁcation subtask.
4
Conclusion
In the present work, a new neural semantic sentence model termed Attention Pool-
ing DCNN has been successfully developed. We introduce Tree-LSTM to attention
mechanism to model sentence. Our model is able to capture long term and syntactic
information. We evaluated the learned semantic sentence representations on sentiment
classiﬁcation task with very satisfactory results and good performance.
Acknowledgements. This research was supported by National High-tech R&D Program (863
Program No 2015AA015403) and National Natural Science Foundation of China (No
61370131).
Table 1. Accuracy (%) of our model and other methods from literature. The presented results
are the test set accuracy of the run with the highest accuracy on the validation set.
Method
Fine-grained Binary
CNN-non-static
48.0
87.2
CNN-multichannel
47.4
88.1
DCNN
48.5
86.8
LSTM
46.4
84.9
Bidirectional LSTM 49.1
87.5
Tree-LSTM
51.0
88.0
APCNN
50.1
89.9
This work
50.6
88.7
58
L. Chen et al.

References
1. LeCun, Y., Bengio, Y., Hinton, G.: Deep learning. Nature 521(7553), 436–444 (2015)
2. Bengio, Y., Ducharme, R., Vincent, P., Jauvin, C.: A neural probabilistic language model.
J. Mach. Learn. Res. 3(Feb), 1137–1155 (2003)
3. Mikolov, T., Sutskever, I., Chen, K., Corrado, G.S., Dean, J.: Distributed representations of
words and phrases and their compositionality, pp. 3111–3119 (2013)
4. Kim, Y.: Convolutional neural networks for sentence classiﬁcation. arXiv preprint arXiv:
1408.5882 (2014)
5. Socher, R., Pennington, J., Huang, E.H., Ng, A.Y., Manning, C.D.: Semi-supervised
recursive autoencoders for predicting sentiment distributions. In: Association for Compu-
tational Linguistics, pp. 151–161 (2011)
6. Lawrence, S., Giles, C.L., Fong, S.: Natural language grammatical inference with recurrent
neural networks. IEEE Trans. Knowl. Data Eng. 12(1), 126–140 (2000)
7. Kalchbrenner, N., Grefenstette, E., Blunsom, P.: A convolutional neural network for
modelling sentences. arXiv preprint arXiv:1404.2188 (2014)
8. Socher, R., Lin, C.C., Manning, C., Ng, A.Y.: Parsing natural scenes and natural language
with recursive neural networks, pp. 129–136 (2011)
9. Socher, R., Manning, C.D., Ng, A.Y.: Learning continuous phrase representations and
syntactic parsing with recursive neural networks, pp. 1–9 (2010)
10. Funahashi, K., Nakamura, Y.: Approximation of dynamical systems by continuous time
recurrent neural networks. Neural Netw. 6(6), 801–806 (1993)
11. Schuster, M., Paliwal, K.K.: Bidirectional recurrent neural networks. IEEE Trans. Sig.
Process. 45(11), 2673–2681 (1997)
12. Hochreiter, S., Schmidhuber, J.: Long short-term memory. Neural Comput. 9(8), 1735–1780
(1997)
13. Graves, A., Schmidhuber, J.: Framewise phoneme classiﬁcation with bidirectional LSTM
and other neural network architectures. Neural Netw. 18(5), 602–610 (2005)
14. LeCun, Y., Bottou, L., Bengio, Y., Haffner, P.: Gradient-based learning applied to document
recognition. P IEEE 86(11), 2278–2324 (1998)
15. Er, M.J., Zhang, Y., Wang, N., Pratama, M.: Attention pooling-based convolutional neural
network for sentence modelling. Inf. Sci. 373, 388–403 (2016)
16. Tai,
K.S.,
Socher,
R.,
Manning,
C.D.:
Improved
semantic
representations
from
tree-structured long short-term memory networks. arXiv preprint arXiv:1503.00075 (2015)
17. Mikolov, T., Chen, K., Corrado, G., Dean, J.: Efﬁcient estimation of word representations in
vector space. arXiv preprint arXiv:1301.3781 (2013)
18. Johnson, R., Zhang, T.: Effective use of word order for text categorization with
convolutional neural networks. arXiv preprint arXiv:1412.1058 (2014)
19. Srivastava, N., Hinton, G.E., Krizhevsky, A., Sutskever, I., Salakhutdinov, R.: Dropout: a
simple way to prevent neural networks from overﬁtting. J. Mach. Learn. Res. 15(1), 1929–
1958 (2014)
20. Zeiler, M.D.: ADADELTA: an adaptive learning rate method. arXiv preprint arXiv:1212.
5701 (2012)
21. Socher, R., Perelygin, A., Wu, J.Y., Chuang, J., Manning, C.D., Ng, A.Y., Potts, C.:
Recursive deep models for semantic compositionality over a sentiment treebank, p. 1642.
Citeseer (2013)
22. Klein, D., Manning, C.D.: Accurate unlexicalized parsing. In: Association for Computa-
tional Linguistics, pp. 423–430 (2003)
23. Zhang, Y., Wallace, B.: A Sensitivity Analysis of (and Practitioners’ Guide to) Convolutional
Neural Networks for Sentence Classiﬁcation. arXiv preprint arXiv:1510.03820 (2015)
Tree-LSTM Guided Attention Pooling of DCNN
59

Multi-base Station Energy Cooperation Based
on Nash Q-Learning Algorithm
Yabo Lv, Baogang Li, Wei Zhao(&), Dandan Guo, and Yuanbin Yao
Department of Electronics and Communication Engineering,
North China Electric Power University, Baoding 071000, Hebei, China
yabolv@163.com, baogangli@ncepu.edu.cn,
andyzhaoster@163.com, guodanstyle@163.com,
hdyaoyuanbin@outlook.com
Abstract. In view of the current energy problems of communication base
station, a multi-base station energy cooperation strategy is proposed to reduce
the energy consumption of power grid, which is introducing renewable energy
and energy cooperation between the base station based on the Nash-Q learning
algorithm. We analyze the packet rate and throughput of the system under the
proposed approach. The simulation results show that the proposed algorithm can
enhances the adaptability to the changing environment, effectively improve the
system capacity.
Keywords: Multi-agent reinforcement learning  Nash equilibrium
Q-learning  Energy harvesting
1
Introduction
Recently, with the arrival of the ﬁfth generation (5G) and the rapid development of the
cellular network [1, 2], the number of users and the corresponding trafﬁc have greatly
increased. Therefore, the energy consumption in cellular networks has also increased
signiﬁcantly. According to the statistics, the cellular network consumes more than 0.5%
of the global energy supply [3], the ﬁgure will increase as users’ demand grows. In
some mountainous areas, grasslands and other special areas, communication base
stations are not usually directly connected to the grid, so it is necessary to introduce the
wind power, solar power or other renewable energy in the base station. Because of the
instability and uneven distribution of renewable energy, it is difﬁcult for a single base
station to achieve the optimal utilization of energy, and energy cooperation between the
base stations can solve the above problems.
The optimal energy allocation based on the off-line algorithm, assuming the
non-causal information of the energy and data are known ahead at the transmitter [4].
The other is the study based on the online algorithm, assuming that the transmitter can
not know the statistical information ahead [5]. In [6], a distributed reinforcement
learning algorithm is proposed to solve the problem of energy cooperation between
multi-base stations. In [7], based on a complete model, which is unrealistic, it is
difﬁcult or even impossible to obtain such a priori knowledge in reality. [8] studies the
single-step TD algorithm only modiﬁes the estimate of the neighbor state, leading to
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 60–68, 2018.
https://doi.org/10.1007/978-3-319-72823-0_7

algorithm convergence is too slow. Maximize energy efﬁciency under power con-
straints in each sub-channel is considered [9–12].
In this paper, we consider a wireless communication system equipped with an
energy harvesting device and a limited-capacity rechargeable battery,the base station
can maintain system operation by harvesting renewable energy. Because of the uneven
distribution of energy, a single base station can not meet the requirements, to solve this
problem, we start with general-sum stochastic games, combining with reinforcement
learning, propose an on-line algorithm. and apply proposed algorithm to energy
coordination in wireless communication systems. The simulation results show the
superiority of the proposed algorithm. We compare the data rate under the presence of
energy cooperation, and obtain the desired experimental results.
The remainder of the paper is organized as follows. Section 2 describes the system
model, while Sect. 3 presents the optimization algorithm, and Sect. 3 also details how
the problem is solved using proposed algorithm. Simulation results are presented in
Sect. 4. Finally, the conclusion is given in Sect. 5.
2
System Model
We consider a wireless communication system equipped with an energy harvesting
device and a rechargeable battery with limited storage capacity, assuming energy and
data packets arrive at each time slot (TS), the channel conditions being constant during
each TS, and changes from one TS to the next TS. We believe that the packet trans-
mission has a strict transmission delay constraints, that is, the data packets must be sent
or be dropped before the next TS arrivals, and the arrival of data and energy in each TS
follows a ﬁrst-order discrete-time Markov model. System model is shown in Fig. 1.
There are energy and data package arriving at the transmitter i at TS t, the energy which
in battery can cooperate with other base station (BS) through power line or radio
frequency, user 1 and user 2 connect BS1 and BS2 respectively.
Where DiðtÞ is the data packet arriving at the BS i in the TS t, wherein the data
packet satisﬁes DiðtÞ 2 D ¼ d1; d2. . .dN
f
g, N is the number of elements in D, and di
represents the type of the packet; pdðdj; dkÞ is the probability that the packet changes
from state dj to dk. eiðtÞ is the energy harvested by the BS i in TS t, denoted as
eiðtÞ 2 EH ¼ fe1; e2. . .eNg, and N represents the number of elements in EH, e is the
energy harvested in each TS, peðej; ekÞ is the probability that the harvested energy from
ej to ek in the next TS. HiðtÞ is the channel state of the BS i in TS t, denoted by
HiðtÞ 2 H ¼ fh1; h2. . .hNg, and phðhj; hkÞ is the probability that the next slot channel
state is converted from hj to hk. f1ðtÞ is the energy that BS1 transmits to BS2 in TS t,
f2ðtÞ is the energy transmitted by BS2 to BS1 in slot t, K indicates energy transfer
efﬁciency, with 0\K\1, The battery capacity is Bmax, At any time, the battery power
to meet the 0  BiðtÞ  Bmax, when the battery is full, the harvested energy is no longer
stored in the battery.
At the beginning of the TS t, the transmitter can obtain the channel state HiðtÞ and
packet DiðtÞ. According to the Shannon formula, the energy needed to send the packet
ET
i ðtÞ can be calculated, and the packet can be successfully transmitted by the energy
Multi-base Station Energy Cooperation
61

consumption. According to the causality of energy harvesting, It can be seen that the
energy harvested in TS t can only be used in its subsequent time slot, then the next slot
battery energy meets:
B1ðt þ 1Þ ¼ minfB1ðtÞ þ e1ðtÞ  f1ðtÞ þ kf2ðtÞ  a1ðtÞET
1 ðtÞ; Bmaxg
ð1Þ
a1ðtÞET
1 ðtÞ  B1ðtÞ
ð2Þ
B2ðt þ 1Þ ¼ minfB2ðtÞ þ e2ðtÞ  f2ðtÞ þ kf1ðtÞ  a2ðtÞET
2 ðtÞ; Bmaxg
ð3Þ
a2ðtÞET
2 ðtÞ  B2ðtÞ
ð4Þ
The objective of this paper is to maximize the average transmission data rate of the
system, which is given by:
r
 tð Þ ¼ max lim
T!1
1
T
X
N
i¼1
X
T
t¼0
aiDi
ð5Þ
S.t. (1) (2) (3) and (4).
Fig. 1. System model
62
Y. Lv et al.

3
Optimization Algorithm Analysis
3.1
Basic Q-Learning Algorithm
The Q-learning algorithm was ﬁrst proposed by C. Watkins in his PhD thesis. The
algorithm can only be assumed to be a Markov decision process model based on the
underlying system. The system does not need to know other priori information, and the
algorithm can converge to the optimal strategy by learning to enhance the discount
return value. The iterative calculation formula is
Q st; at
ð
Þ ¼ Q st; at
ð
Þ þ lðr st; at
ð
Þ þ c maxQ st þ 1; at þ 1
ð
Þ  Q st; at
ð
ÞÞ
ð6Þ
Where ðst; atÞ is the state-action pair of MDP at time t, st þ 1 is the state at time t þ 1,
rðst; atÞ is the return at time t, and l [ 0 is the learning factor. When certain conditions
are satisﬁed, the algorithm converges to the optimal solution [13].
From Eq. (6), it can be seen that the update of Q-learning-valued function is carried
out in an iterative way. The value function is the expectation of the reward discount
after the action at selected according to a certain policy under the state st. There are two
ways to achieve Q learning: One method is to use lookup table, the other is the use of
neural network. This paper uses lookup table method. In the initialization phase, all
states and actions are initialized to discrete quantities, and the value functions are
learned according to algorithmic ﬂow and constraints.
3.2
Nash Q Learning Algorithm
Hu and others in 1998 proposed the Nash-Q algorithm, which extends the multi-agent
learning to complete information non-cooperative general and stochastic game with
incompletely antagonistic interests [14].
First, we give the deﬁnition of Nash equilibrium: Nash equilibrium is a joint
strategy, in this state, each participant’s strategy for other participants are excellent. In a
random game process, Nash equilibrium is a n-tuple stratergy ðp1
;   ; pn
Þ, such that
for all s 2 S; i ¼ 1;    ; n, there are:
viðs; p1
;    ; pn
Þ  viðs; p1
;    ; pi1
 ; pi
; pi þ 1

;    ; pn
Þ
ð7Þ
There pi 2 Pi, Pi for the agent i available strategies.
In the Nash Q-learning algorithm, the Nash equilibria are used to deﬁne the value
functions. In this case, the agents can observe each other to obtain information such as
the action taken and the reward they get, etc., and to update their own valued functions.
The value function of other agents is modeled. In a game with n players, the Q value of
all agents in the same state forms a countermeasure form, Q1
t ðsÞ; . . .; Qn
t ðsÞ, and the
value function update formula of Nash Q-learning algorithm is:
Multi-base Station Energy Cooperation
63

Qi
t þ 1ðsi
t; a1
t . . .an
t Þ ¼ ð1  atÞQi
tðsi
t; a1
t . . .an
t Þ þ at ri
t þ bNashQi
tðs0Þ


ð8Þ
S:t: NashQi
tðs0Þ ¼ p1ðs0Þ. . .pnðs0Þ  Qi
tðs0Þ
p1ðs0Þ. . .pnðs0Þ is the Nash equilibrium solution of Q value in the state s0. Indicates
that the participant i selects the winning function of the Nash equilibrium solution
under state s0.
At the same time, the agent needs to update the value function of other agents by
the following equation:
Q j
t þ 1ðs j
t ; a1
t . . .an
t Þ ¼ ð1  atÞQ j
t ðs j
t ; a1
t . . .an
t Þ þ at r j
t þ bNashQ j
t ðs0Þ


ð9Þ
S:t: NashQ j
t ðs0Þ ¼ p1ðs0Þ. . .pnðs0Þ  Q j
t ðs0Þ;
i 6¼ j
Given the Nash Q-learning algorithm steps, the learning process of the agent i can
be described as follows:
Initialization:
Set initial time index t  0, initial state si
t ¼ si
0.
For all si
t 2 S, ai
t 2 A, i ¼ 1; 2;    ; n, t ¼ 0; 1;   , the initialized value functions
Qi
tðsi
t; a1
t . . .an
t Þ ¼ 0, Q j
t ðs j
t ; a1
t . . .an
t Þ ¼ 0, j ¼ 1; 2    n, and j 6¼ i.
Repeat the following steps until the condition is met:
(a) observe the current state si
t, according to the rules and learning process to get
Qi
tðsi
t; a1
t . . .an
t Þ and Q j
t ðs j
t ; a1
t . . .an
t Þ, according to the greedy strategy to select
action ai
t;
(b) Observe the joint reward r1
t . . .rn
t and joint action a1
t . . .an
t in the current state and
update the value functions of themselves and other agents according to (8) and (9).
(c) Let t ¼ t þ 1, observe the next state s0.
In this section, we consider two base stations, and each base station can be regarded
as an agent with learning ability. Agent i calculates p1ðs0Þp2ðs0Þ for the stage game
ðQ1
t ðs0ÞQ2
t ðs0ÞÞ, and update the Q-value according to (8) and (9). the state set consists of
four parts: the harvested energy, arrival data, channel state, and battery capacity. At TS
t, the state is represented by St ¼ \eðtÞ; DðtÞ; HðtÞ; BðtÞ [ , according to the following
simulation parameters set, the system is divided into 48 discrete state. And the action
set is represented by At ¼ \aðtÞ; f ðtÞ [ , where aðtÞ ¼ \0; 1 [ is whether to send
data packets, f ðtÞ ¼ \0; 2 [ Which indicates the energy of cooperation between the
two BS, whether the action can be performed is governed by Eqs. (2) and (4).
4
Simulation Results Analysis
In this paper, simulation parameters similar to the paper [5] are used. Assuming the
length of each TS is DTS ¼ 10 ms, the time that the transmitter transmits data is
DTx ¼ 5 ms, the available bandwidth is W ¼ 2 MHz, the noise power spectral density
of Gaussian channel is N0 ¼ 1020:4 W/Hz, The basic energy unit is 2:5 lj, assuming
64
Y. Lv et al.

that the transmitter in time slot t, the available energy unit is eiðtÞ ¼ f0; 5glj, the
packet size is DiðtÞ ¼ f300; 600g bit/s, the channel state is HiðtÞ ¼ f1:655  1013;
3:311  1013g; set to harvested energy in each TS, the arrival of the packet, the
channel state are random.
In order to ensure the reliable transmission of data, it is necessary to calculate the
energy required to transmit data in each state. From the channel capacity formula
(Shannon formula) under the Gaussian channel, can be described as
DiðtÞ ¼ WDTx log 2ð1 þ HiðtÞP
WN0
Þ
ð10Þ
The channel capacity may be approximately equal to
Dn  DTxHnP
logð2ÞN0
ð11Þ
Where is the energy required to transmit the data in the TS, so we get the energy
required to reliably send a packet is:
ET
i ¼ feðDiðtÞ; HiðtÞÞ ¼ DiðtÞ logð2ÞN0
HiðtÞ
ð12Þ
In the simulation, taking into account the causal nature of energy harvesting, the
renewable energy harvested by the base station is used in the following TS, the system
depends on the current battery remaining capacity to determine whether to send data
packets and co-energy, the data package will be sent successfully if the energy in
battery is enough in current TS, otherwise the package will be dropped.
Figure 2 Shows the relationship between the number of learning iterations and the
transmission data rate. It can be seen that the system throughput increases with the
number of learning times. When the number of iterative times reaches 600, the data rate
reaches 77 kb/s, and the learning data rate is no longer signiﬁcantly improved and
stable. The learning process has been gradually completed. The blue curve is the data
rate under the greedy strategy. If the greedy strategy is adopted, only the local optimal
solution is adopted. The throughput of the system is 52 kb/s, its throughput is much
lower than the Nash Q learning algorithm. It can be seen that the Nash Q learning
algorithm can effectively improve the data rate of the system.
The impact of battery capacity on the system throughout shown in Fig. 3. With the
battery capacity increases, the system throughout gradually increased, because the
energy harvesting probability is a ﬁxed value, in a continuous period of time, the
system will harvest more renewable energy, increased battery capacity can store more
available electrical energy, which can send more data during no energy harvesting time,
so an appropriate increase in battery capacity will help improve the system throughout.
From the curve, we can see that as the battery capacity increases, the data rate increases
slowly, the growth rate decreased signiﬁcantly when the rate increase to 80 kb/s,
because the system throughout is not only determined by the battery capacity, but also
by the packet size, capture Energy probability, channel state and other factors.
Multi-base Station Energy Cooperation
65

0
50
100
150
200
250
40
45
50
55
60
65
70
75
80
Iterative times
Data transmission rate
Nash Q learning
Greedy algorithm
Fig. 2. Inﬂuence of iteration times on rate
1
1.5
2
2.5
3
3.5
4
4.5
5
5.5
6
50
55
60
65
70
75
80
85
battery capacity
Transmission data rate  kbit/s
Nash Q
Greedy algorithm
Fig. 3. Battery capacity on the rate of impact
66
Y. Lv et al.

Figure 4 shows the impact of energy cooperation on the successful transmission of
data packets to the base station. From the simulation results, we can see that when the
energy cooperation is not carried out between the base stations, the data packets
transmission rate of the system is as high as 60%. When the energy cooperation is
carried out, The two base stations can share the excess energy, the current state of
excess energy sharing to another energy-poor base stations, the data packet rate can be
up to 73%. From the comparison we can conclusion that the cooperation energy have a
signiﬁcance on improving the data transmission rate.
5
Conclusion
In order to reduce the energy consumed by the communication base station and
increase the ﬂexibility of the deployment of the base station, more and more researchers
consider the use of renewable energy to the base station power supply. This paper have
studied the energy allocation and the energy cooperation between off-grid base stations.
Based on the knowledge of game theory, we have proposed an online energy man-
agement method. The simulation results of Nash Q learning algorithm have shown that
the information rate of the system can be improved effectively with the agent learning
process. It has been shown that, multi-base station energy cooperation method is
superior to single base station communication system. For the off-grid connected base
station rechargeable battery capacity, we can conclusion that the appropriate increase in
battery capacity can increase the system speed.
0
100
200
300
400
500
600
700
800
900
1000
0.35
0.4
0.45
0.5
0.55
0.6
0.65
0.7
0.75
0.8
Iterative times
Data package transmission rate
Nash Q without coopertion
Nash Q with cooperation
Fig. 4. Effect of energy cooperation on transmit rate under Q-Learning
Multi-base Station Energy Cooperation
67

The following research will be carried out from the following three aspects: The
reinforcement learning algorithm is applied to solve the energy optimization problem in
the coexistence scenario of grid and renewable energy. Improvement of reinforcement
learning algorithm, the emphasis is on improving the robustness and convergence
speed of the algorithm, reducing the complexity of multi-agent learning and exploring
the method of solving the dimension problem. Consider the co-optimization of energy
efﬁciency and spectral efﬁciency.
References
1. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
2. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
3. Tombaz, S., Vastberg, A., Zander, J.: Energy-and cost-efﬁcient ultrahigh-capacity wireless
accross. IEEE Wirel. Commun. 18(5), 18–24 (2011)
4. Gong, J., Zhou, S., Niu, Z.: Optimal power allocation for energy harvesting and power grid
coexisting wireless communication systems. IEEE Trans. Commun. 61(7), 3040–3049
(2013)
5. Pol Blasco, D., Dohler, M.: A learning theoretic approach to energy harvesting communi-
cation system optimization. IEEE Trans. Wirel. Commun. 12(4), 1872–1882 (2013)
6. Lin, W.T., Lai, I.W., Lee, C.H.: Distributed energy cooperation for energy harvesting nodes
using reinforcement learning. In: 2015 IEEE 26th Annual International Symposium on
Personal, Indoor, and Mobile Radio Communications (PIMRC), Hong Kong, pp. 1584–1588
(2015)
7. Udenze, A., McDonald-Msier, K.: Discrete time markov based optimisation for dynamic
control of transmitter power in wireless sensor networks. In: IET Proceedings of the 3rd UK
Embedded Forum, Newcastle, UK, 2–3 April (2007)
8. Alhajry, M., Alvi, F., Ahmed, M.: TD(k) and q-learning based ludo players. In: IEEE
Conference on Computation Intelligence and Games (CIG), pp. 83–90 (2012)
9. Li, W., Zhang, H., Zheng, W., Su, T., Wen, X.: Energy-efﬁcient power allocation with
dual-utility in two-tier OFDMA femtocell. In: Proceedings of IEEE Globecom (2012)
10. Liu, H., Zheng, W., Zhang, H., Zhang, Z., Wen, X.: An iterative two-step algorithm for
energy efﬁcient resource allocation in multi-Cell OFDMA networks. In: Proceedings of
IEEE WCNC (2013)
11. Ma, W., Zheng, W., Zhang, H., Wen, X.: MOS-driven energy efﬁcient power allocation for
wireless video communications. In: Proceedings of IEEE Globecom (2012)
12. Zhang, Z., Zhang, H., Lu, Z., Zhao, Z., Wen, X.: Energy-efﬁcient resource optimization in
OFDMA-based dense femtocell networks. In: Proceedings of IEEE ICT (2013)
13. Dayan, W.P.: Q-Learning. Mach. Learn. 38(2), 362–399 (2002)
14. Hu, J.L., Wellmam, M.P.: Multiagent reinforcement learning: theoretical framework and an
algorithm. In: 15th International Conference on Machine Learning, Washington, pp. 242–
249 (1999)
68
Y. Lv et al.

Crowdfunding Assisted Cellular System
Analysis and Application
Mingqiang Yuan, Xinzhou Cheng, Tao Zhang(&), Yongfeng Wang,
Lexi Xu, Chen Cheng, Haina Ye, and Weiwei Chen
Network Technology Research Institute, China United Network Technology
Corporation, Beijing, People’s Republic of China
zhangt176@chinaunicom.cn
Abstract. In this paper, a novel crowdfunding assisted cellular system ana-
lytical (CCSA) scheme is designed. Its basic idea is that mobile terminals collect
cellular system related data from different telecom operators continuously,
including signal strength, signal quality, data rate, delay etc. Mobile terminals
automatically report the collected data to the analytical system periodically.
Then, the analytical system analyses the performance and competitiveness level
among telecom operators, as well as seeking the problem area for each telecom
operator. Compared to driving test (DT) and call quality test (CQT), the CCSA
scheme can save the capital expenditure (CAPEX) and effectively analyse the
user experience in the cellular system.
Keywords: Cellular system  Mobile terminal  Crowdfunding  APP
1
Introduction
In the past decade, mobile internet experiences fast developments and popularization
[1, 2]. The mobile internet reshapes the traditional inter-personal communication and
effectively promotes the resources integration in the society [3, 4]. In the mobile
internet era, a series of techniques (e.g., big data, data mining, deep learning etc.)
become the driving force of enterprise transformation [5, 6]. These techniques are also
key to industry upgrading in many traditional industries.
For telecom operators, the big data analysis is vital for mobile cellular system
operation and optimization [7, 8]. Employing big data analysis, telecom operators can
be aware of user preference, service feature, system performance, terminal character-
istics [9, 10]. In this way, telecom operators can grasp the service/operation problems
and system development trends [11, 12]. Then, telecom operators can put forward the
solution to these service/operation problems, thus continuously improving the Quality
of Service (QoS) and providing relevant measures for the cellular system operation [13,
14]. In the traditional cellular system performance analysis, acquiring other telecom
operator’s data is difﬁcult with high cost, as well as deviation from the user’s real
perception [15, 16]. This paper tries to address above mentioned problems and designs
a novel crowdfunding assisted cellular system analytical (CCSA) scheme. Initially,
application (APP) equipped in mobile terminals collect cellular system related data
from different telecom operators continuously. Then, mobile terminals automatically
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 69–78, 2018.
https://doi.org/10.1007/978-3-319-72823-0_8

report these collected data to analytical system periodically. Finally, the analytical
system analyses the performance and competitiveness level among telecom operators,
as well as seeking the problem area for each telecom operator.
2
Crowdfunding Assisted Cellular System Analytical Scheme
2.1
System Architecture
The basic structure of the proposed crowdfunding assisted cellular system analytical
scheme is shown in Fig. 1. The CCSA scheme has two characteristics. The ﬁrst
characteristic is the active data acquisition. For a speciﬁc geographic area, mobile
terminals and APP periodically collect both the system related data and the service
related information. Then mobile terminals and APP report these data to the back-
ground server for storage. These collected/stored data can be used in the optimization
supporting system and planning & supporting platform etc. The second characteristic is
to seek the cellular system problem interactively. The CCSA scheme employs user’s
data to assess the cellular system and ﬁnd the problem.
2.2
Key Indicator
The mobile terminal, especially the smart phone, can be regarded as an integrated
sensor system, as well as a comprehensive information processing system. From the
perspective of information collection, a smart phone can be regarded as an integrated
sensor system. In addition to detection of the wireless environment information, the
smart phone also integrates Global Positioning System (GPS), gyroscopes, light sen-
sors, distance sensors, gravity sensors, magnetic sensors, acceleration sensors etc. [9].
Based on these sensors, the smart phone can perceive and record a large amount of
information. Based on the Application Programming Interface (API) of mobile terminal
operation system, developers can access to the public resources of the mobile terminal,
as well as access to the user’s information. A series of information can be collected via
the API, such as phone number, signal strength, network condition, time information,
camera condition, accelerometer information, location information etc. Hence, API also
brings the opportunity of comprehensive analysis. From the perspective of cellular
system analysis, we mainly collect the following data:
Fig. 1. Basic structure of the CCSA scheme
70
M. Yuan et al.

(1) 2G, 3G, 4G mobile system basic information: Cell identiﬁcation (CI), location
area code (LAC), IP address, network identiﬁcation etc. [17].
(2) User location information: Longitude, latitude, altitude etc.
(3) Wireless environment information: Received signal level (RxLev) in 2G, received
signal code power (RSCP) in 3G, reference signal received power (RSRP), signal
to interference plus noise ratio in 4G [2, 4].
(4) User perception information: Uplink data rate, downlink data rate, delay etc.
(5) Terminal related information: International mobile subscriber identiﬁcation
number (IMSI), international mobile equipment identity (IMEI), terminal brand
etc.
2.3
Key Technology
Data collection is the ﬁrst step of the CCSA scheme, as shown in Fig. 2. Some service
related characters can only be collected when the user undergoes services. In order to
drop the worthless raw data, the data pre-process is implemented.
2.3.1
Device Collection
Device collection gets data from the operating system APIs. Appropriate APIs are
chosen and packaged to Software Development Kit (SDK). And then certain logical
operation is implemented to get the ﬁnal results. This can be applied to Android
operation system [18].
2.3.2
Service Collection
Some data are collected when users undergo the service, such as user data volume,
service speed, time delay. Actually, most of the perceptive indexes are collected in this
stage. Downlink speed and uplink speed are calculated as (1) and (2), respectively. In
addition, the APIs involved are listed in Table 1 [18].
Speeddownlink ¼ dataVolumedownlink
Dtime
ð1Þ
Speeduplink ¼ dataVolumeuplink
Dtime
ð2Þ
Fig. 2. Data collection and pre-process procedure
Crowdfunding Assisted Cellular System Analysis and Application
71

2.3.3
Property Association
For further analysis, we associate the data with social properties, such as geographic
information [19, 20]. Based on GPS information, the geographic association is utilized
to classify points to certain areas, including the linear scene and the polygonal scene.
As shown in Fig. 3, the beam method is applied to decide whether a point is in a certain
polygon. The main idea is that: if the point is in the polygon, there are odd crossover
point between the beam of point and the polygon; otherwise, there are even crossover
points.
Besides, the CCSA scheme needs commercial channels to popularize the SDK, in
order to release the SDK to more phones. Ordinarily, there are several ways to pop-
ularize the SDK. To develop and operate an application is a direct way, however, the
cost is high. Another way is to develop an application service platform, where statistic
analysis for application operation is supplied for free. When the SDK from our service
platform is bundled in any APP, the app plays a role as a data collector, continuously
supplying user data. At the same time, the SDK obtains huge number of data in mobile
terminals.
Table 1. APIs for speed calculation
Description
Method name
Purpose
Get current timestamp
System.
currentTimeMillis()
To calculate time
Received bytes
getTotalRxBytes()
To calculate downlink speed
Sent bytes
getTotalTxBytes()
To calculate uplink speed
Received byte in mobile
network
getMobileRxBytes()
To calculate downlink speed in cellular
network
Sent byte in mobile
network
getMobileTxBytes()
To calculate uplink speed in cellular
network
Fig. 3. Beam method to judge whether a point is in a polygon
72
M. Yuan et al.

3
CCSA Scheme Application
3.1
Main Application Aspects
The crowdfunding data can be applied in the following four aspects:
(1) Network Analysis: The crowdfunding data contains the information of operators’
network parameters and network signal. We can get the network overall perfor-
mance from different dimensions and be aware of the gap with competitors, so
that we can provide data support for network construction and optimization [21,
22].
(2) User Analysis: The crowdfunding data also includes the user information, such as
the user phone number, IMSI etc. [19]. Based on different user groups’ service
perception, we can focus on customer care and support for the VIP subscribers.
(3) Terminal Analysis: The crowdfunding data also contains the terminal information.
Therefore, we can analyze the terminal performance in the network, thus to
provide support for terminal marking [5].
(4) Other Analysis: In addition to the analysis of the cellular system, the crowd-
funding data analysis can also be used in WIFI network evaluation.
3.2
Network Competitiveness Analysis
It is beneﬁcial to carry out cellular system competiveness analysis based on the
crowdfunding data, leading to a wider coverage, a lower cost of data acquisition and a
more accurate user perception. Compared with traditional DT/CQT methods, the
CCSA scheme has obvious advantages to provide effective supports for network
development and construction.
3.2.1
Network Competitiveness Analysis Process
The overall process for dealing with the smart phone APP data is shown as Fig. 4.
The ﬁrst and second step are data cleaning and data warehousing, respectively. The
data that is out of reasonable range or incomplete ones should be cleaned [23]. Besides,
each sample point should contain the required ﬁelds for analysis. After data cleaning,
the structured data are saved in a database for subsequent statistical analysis.
The third step is data preprocessing. The main work of data preprocessing is to
decide each sample data point’s features, e.g., the terminal brand model belonging, the
operator belonging, the network type belonging and the geographic area belong.
Data 
Cleaning
Data
Warehousing
Data 
Preprocessing
Algorithm
Formulating 
Data 
Analyzing
Analyzing
Result
Fig. 4. Overall process for dealing with the smart phone APP data
Crowdfunding Assisted Cellular System Analysis and Application
73

The fourth and ﬁfth step are algorithm formulating and data analysis, respectively.
Network competitiveness analysis can be carried out in two dimensions. The ﬁrst
dimension is from different aspects (such as the network coverage, delay, service speed
rate) to set up a single parameter evaluation algorithm to reveal single network
parameter competitiveness among telecom operators. The second dimension is to set up
an operator network competitiveness comprehensive evaluation system, the overall
comprehensive score of network competitiveness for each operator can be obtained.
In the last result demonstration step, the result of the single parameter and com-
prehensive network competitiveness can be demonstrated in various forms such as
diagrams, maps and so on.
3.2.2
Single Parameter Network Competitiveness Analysis
The single parameter network competitiveness analysis can be divided into ﬁve
aspects: the network scale competitiveness analysis, the network coverage competi-
tiveness analysis, the network quality competitiveness analysis, the network speed rate
competitiveness analysis and the network service time delay competitiveness analysis.
Each can be processed from different time granularity (month/quarter/year) and geo-
graphical granularity (provinces/cities/scene/grid).
(1) Network Scale Competitiveness Analysis
Operator network scale competitiveness analysis consists of three aspects: the
number of users, sampling points and cells. These aspects can reﬂect the opera-
tors’ user market share distribution and network size, as exempliﬁed in Fig. 5.
(2) Network Coverage Competitiveness Analysis
Coverage competitiveness analysis can be evaluated via good coverage sample
point ratio and 4G network sample point ratio. Percentage of good coverage
sample point can be used as indicators for evaluation of 2G (RSSI), 3G (RSCP)
and 4G (RSRP) coverage performance, which is deﬁned as: the number of sample
point that its signal strength is greater than a certain threshold accounted for the
proportion of all sampling points, as shown in Fig. 6. While the 4G network
sample point ratio is used to evaluate operators’ 4G signal coverage competi-
tiveness, which can be deﬁned as: the sample points generated by 4G users in the
Fig. 5. Exempliﬁed results of network scale competitiveness
74
M. Yuan et al.

4G network users in the 4G network accounted for the proportion of total sam-
pling points of these users in 2/3/4G.
(3) Network Quality Competitiveness Analysis
Operator network quality competitive analysis can be evaluated via good signal
quality sampling point ratio. 4G good signal quality sampling point ratio is
deﬁned as the number of sample point that its signal quality SINR is greater than a
certain threshold accounted for the proportion of all sampling points.
(4) Network Speed
Download (downlink) speed and upload (uplink) speed are applied to evaluate the
operator competitiveness of speed, as exempliﬁed in Fig. 7. The download speed
and upload speed are affected by the behavior of users.
(5) Network Delay
Network delay is deﬁned as the delay of ping to some typical website, such as
SINA, TAOBAO, YOUKU, IQIYI and etc., which is designed according to
speciﬁc requirements. Network delay includes the delay of each website and the
average delay of all websites, which measures the level of user perception
immediately, as exempliﬁed in Fig. 8.
Fig. 6. Exempliﬁed results of network coverage competitiveness
Fig. 7. Results of speed in 4G
Fig. 8. Results of delay in 4G
Crowdfunding Assisted Cellular System Analysis and Application
75

3.2.3
Global Competitiveness Analysis of Network
In the above subsection, we evaluate the competitiveness of each operator by its
coverage, interference and perception respectively. However, to evaluate the compet-
itiveness of each operator synthetically, we propose an analysis system based on
Analytic Hierarchy Process, which is shown in Table 2.
The score of each index is computed as (3).
Score ¼
xi
maxðxÞ ði ¼ 1; 2; 3Þ
ð3Þ
Where xi is the value of each index and x is a one-dimensional set composited by
three operators. Specially, the score of delay is as (4). A higher score reﬂects a less
delay.
Scoretimedelay ¼ minðxÞ
xi
ði ¼ 1; 2; 3Þ
ð4Þ
The competence of each operator is computed as (5).
CompetenceLTE ¼ Scorecoverage  kcoverage þ Score4Gratio  k4Gratio
þ Scoreupspeed  kupspeed þ Scoredownspeed  kdownspeed þ Scoretimedelay  ktimedelay
ð5Þ
where Score is the level of each index and k is the weight of each index.
Based on practical data and requirements, we present an example result in Table 3.
The result of operator competitiveness evaluation via the CCSA scheme shows that
Operator B (0.93) > Operator C (0.82) > Operator A (0.81). This means the network of
Operator B is the best while the Operator C and the Operator A have similar com-
petition level.
Table 2. Operator network competitiveness evaluation system (4G)
Cover
Interference
Perception
Index
Good
sample
point ratio
Proportion of
4G users in
4G network
Signal
quality
Download
speed
Upload
speed
Delay
Weight
30%
10%
10%
20%
10%
20%
Table 3. 4G network of operator competitiveness evaluation (Example)
Index
Good sample
point ratio
Proportion of 4G
users in 4G network
Download
speed
Upload
speed
Delay Competence
Weight
30%
20%
20%
10%
20%
Operator A 0.88
0.82
0.80
0.58
0.82
0.81
Operator B 1.00
0.98
1.00
1.00
0.67
0.93
Operator C 0.90
1.00
0.58
0.35
1.00
0.82
76
M. Yuan et al.

4
Conclusion
In this paper, we design a crowdfunding assisted cellular system analytical (CCSA)
scheme, including its framework, mainly-used indicators, key technologies as well as
channel expansions. In terms of application, we introduce the content, application of
direction, ﬂow and case of this system. As a novel method, the CCSA scheme changes
the traditional mode of network analysis, expands the category of network analysis,
beneﬁts the network quality of network and expands the range of users. In the future,
the contents of the analysis would be further enriched, and the collection of data would
be more normalized and persistent. In addition, the combination of data from the OSS
and the BSS domain will be enhanced and the CCSA scheme will be constructed to
realize normalizing analysis and application.
References
1. Cao, Y., Sun, Z., Wang, N., Riaz, M., Cruickshank, H., Liu, X.: Geographic-based
spray-and-relay (GSaR): an efﬁcient routing scheme for DTNs. IEEE Trans. Veh. Technol.
64(4), 1548–1564 (2015)
2. Xu, L., Cheng, X., Liu, Y., Chen, W., Luan, Y., Chao, K., Yuan, M., Xu, B.: Mobility load
balancing aware radio resource allocation scheme for LTE-advanced cellular networks. In:
IEEE International Conference on Communication Technology, pp. 806–812. IEEE Press,
Hangzhou (2015)
3. Cheng, C., Cheng, X., Yuan, M., Xu, L., Zhou, S., Guan J., Zhang, T.: Spectrum allocation
based on data mining in heterogeneous cognitive wireless networks. In: International
Conference on Signal and Information Processing, Networking and Computers, pp. 315–
324. CRC Press Taylor & Francis Group, Beijing (2015)
4. Xu, L., Luan, Y., Cheng, X., Cao, X., Chao, K., Gao, J., Jia, Y., Wang, S.: WCDMA data
based LTE site selection scheme in LTE deployment. In: International Conference on Signal
and Information Processing, Networking and Computers, pp. 249–260. CRC Press Taylor &
Francis Group, Beijing (2015)
5. Cheng, X., Xu, L., Zhang, T., Jia, Y., Yuan, M., Chao, K.: A novel big data based telecom
operation architecture. In: International Conference on Signal and Information Processing,
Networking and Computers, pp. 385–396. CRC Press Taylor & Francis Group, Beijing
(2015)
6. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.M.: Cooperative interference
mitigation and handover management for heterogeneous cloud small cell networks. IEEE
Wirel. Commun. 22(3), 92–99 (2015)
7. Xu, L., Chen, Y., Chai, K.K., Schormans, J., Cuthbert, L.: Self-organising cluster-based
cooperative load balancing in OFDMA cellular networks. Wiley Wirel. Commun. Mob.
Comput. 15(7), 1171–1187 (2015)
8. Wang, W., Xu, L., Zhang, Y., Zhong, J.: A novel cell-level resource allocation scheme for
OFDMA system. In: International Conference on Communications and Mobile Computing,
pp. 287–292. IET Press, Kunming (2009)
9. Cao, Y., Wang, N., Kamel, G., Kim, Y.J.: An electric vehicle charging management scheme
based on publish/subscribe communication framework. IEEE Syst. J., 1–14 (2015). https://
doi.org/10.1109/JSYST.2015.2449893
Crowdfunding Assisted Cellular System Analysis and Application
77

10. Liu, Y., Xu, L., Chen, Y., Fan, Y., Xu, B., Nie, J.: A novel power control mechanism based
on interference estimation in LTE cellular networks. In: IEEE International Symposium on
Communications and Information Technologies, pp. 397–401. IEEE Press, Qingdao (2016)
11. Xu, L., Chen, Y., Gao, Y., Cuthbert, L.: A self-optimizing load balancing scheme for ﬁxed
relay cellular networks. In: IET International Conference on Communication Technology
and Application, pp. 306–311. IET Press, Beijing (2011)
12. Cui, G., Lu S., Wang, W., Wang, C., Zhang, Y.: Decentralized antenna selection with no
CSI sharing for multi-cell MU-MIMO systems. In: IEEE International Symposium on
Personal and Indoor, Mobile Radio Communications, pp. 2319–2323. IEEE Press, Sydney
(2012)
13. Zhang, T., Cheng, X., Yuan, M., Xu, L., Cheng, C., Chao, K.: Mining target users for mobile
advertising based on telecom big data. In: IEEE International Symposium on Communi-
cations and Information Technologies, pp. 296–301. IEEE Press, Qingdao (2016)
14. Cui, G., Lu, S., Wang, W., Zhang, Y., Wang, C., Li, X.: Uplink coordinated scheduling
based on resource sorting. In: IEEE Vehicular Technology Conference, pp. 1–5. IEEE Press,
Quebec (2012)
15. Xu, L., Luan, Y., Cheng, X., Xing, H., Liu, Y., Jiang, X., Chen, W., Chao, K.:
Self-optimised joint trafﬁc ofﬂoading in heterogeneous cellular networks. In: IEEE
International Symposium on Communications and Information Technologies, pp. 263–
267. IEEE Press, Qingdao (2016)
16. Cao, Y., Wang, N., Sun, Z., Cruickshank, H.: A reliable and efﬁcient encounter-based
routing framework for delay/disruption tolerant networks. IEEE Sens. J. 15(7), 4004–4018
(2015)
17. Xu, L., Chen, Y., Chai, K.K., Luan, Y., Liu, D.: Cooperative mobility load balancing in
relay cellular networks. In: IEEE International Conference on Communication in China,
pp. 141–146. IEEE Press, Xi’an (2013)
18. Android. Introduction to Android (2016). http://wear.techbrood.com/guide/index.html
19. Cheng, X., Yuan, M., Xu, L., Zhang, T., Jia, Y., Cheng, C., Chen, W.: Big data assisted
customer analysis and advertising architecture for real estate. In: IEEE International
Symposium on Communications and Information Technologies, pp. 312–317. IEEE Press,
Qingdao (2016)
20. Xu, L., Chen, Y., Chai, K.K., Zhang, T., Schormans, J., Cuthbert, L.: Cooperative load
balancing for OFDMA cellular networks. In: European Wireless, pp. 1–7. VDE
Verlag GMBH, Poznan (2012)
21. Zhao, L., Al-Dubai, A.Y., Li, X., Chen, G.: A new efﬁcient cross-layer relay node selection
model for wireless community mesh networks. Comput. Electr. Eng. (2017). https://doi.org/
10.1016/j.compeleceng.2016.12.031
22. Xu, L., Luan, Y., Cheng, X., Fan, Y., Zhang, H., Wang, W., He, A.: Telecom big data based
user ofﬂoading self-optimisation in heterogeneous relay cellular systems. Int. J. Distrib. Syst.
Technol 8(2), 27–46 (2017)
23. Ye, H., Cheng, X., Yuan, M., Xu, L., Gao, J., Cheng, C.: A survey of security and privacy in
big data. In: IEEE International Symposium on Communications and Information
Technologies, pp. 268–272. IEEE Press, Qingdao (2016)
78
M. Yuan et al.

SWAT Hydrological Model and Big
Data Techniques
Xi Guo(B), Biao Wang, Wei Xiong, and Shisheng Jin
GuiZhou Provincial Meteorological Administration Information Center,
GuiYang, GuiZhou, China
guoxiguoxi1989@163.com
Abstract. Meteorological and hydrological data includes a wide range
of items with complex format and large scale. In the era of big
data, it brings great opportunities and challenges to meteorology and
hydrology services. Because isolated information resources and indus-
try data barriers bring incomplete data parameters, which makes the
hydrological model simulate inaccurately. This paper mainly discusses
the application of big data technology in Hydro-Meteorological indus-
try. Firstly, it introduces the background and principal of hydrologi-
cal SWAT model. Secondly, this paper proceeds the SWAT simulation
and estimates runoﬀprediction of WangMo river in GuiZhou province,
and analyzes simulation results. Finally, it proposes a big data plat-
form architecture design combines with SWAT hydrological model as
future research direction. Big data platform will provide libraries of
integrated model, method, component, knowledge database for Hydro-
Meteorological resources management. It also oﬀers decision-making for
ﬂood control, water shortage, water pollution incidents.
Keywords: Hydro-meteorological model · Big data · SWAT model
Forecasting model
1
Introduction
Hydrological model is one of the hot spots and important branches in research
of hydrology. It is an important tool of studying the hydrology natural law and
solving relative practical problems. At present, a new generation of distributed
hydrological model has greatly broaden simulation ﬁelds, which changes water
yield vary simulation in single way to water ecological diversiﬁed situation. The
rapid development technologies of computer, remote sensing, and geographic
information system has greatly promoted hydrological model. However, the dis-
tributed hydrological model is not mature enough. It often performs problems
in following aspects: parameter estimation and model checking of hydrological
This project has been funded with support by 2017 Youth Technology Foundation
of GuiZhou Provincial Meteorological Administration.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 79–88, 2018.
https://doi.org/10.1007/978-3-319-72823-0_9

80
X. Guo et al.
system complexity, diﬀerent space-time scales of hydrological and spatial param-
eters variability, diﬀerent time scales of water cycling dynamic mechanism, and
the limitations of data, etc.
At present, facing water issues in the rapid development of society, distributed
hydrological model is an eﬀective tool to explore complex hydrological process
mechanism for water problems. It becomes an indispensable means for hydro-
logical cycle research, and this will become opportunities and challenges for vast
number of Hydro-Meteorological scientists.
2
Hydrological Model SWAT with Big Data Techniques
2.1
Background of SWAT Model
SWAT is a watershed scale model developed by the US Department of Agri-
cultural Research Center USDA-ARS. The purpose of the model is to predict
the impact of long-term land management inﬂuences on water, sediment and
agricultural pollutants in complex watersheds with diversity of soil, land use
and management conditions [1]. This section introduces the basic structure of
SWAT model, hydrological cycle of land stage, and analyzes the characteristics
of model. Finally, in Sect. 3, we simulated WangMo river of climate change on
hydrological cycle inﬂuenced by SWAT model and put forward the prospects of
hydrological model future work in big data ﬁeld.
2.2
Hydrological Cycle of Land Stage
Water balance is a very important process in SWAT basin simulation. The hydro-
logical simulation of basin can be divided into two main parts: the ﬁrst part is
about land stage hydrological cycle, water quantity control, sediment and nutri-
ents, pesticides; the second part is river hydrological cycle calculation stage,
which can be deﬁned as the movement of water and sediment until the export
process [2]. Hydrological cycle of SWAT model is mainly composed of follow-
ing components: climate, hydrology, sediment, crop growth, soil temperature,
nutrients, pesticides and agricultural management. The hydrological cycle water
balance equation is as follow:
SWt = SW0 +
t

i=1
(Rday −Qsurf −Ea −Wseep −Qgw)
(1)
SWt is ﬁnal moisture content of soil (mm), SW0 is soil moisture content at
earlier stage (mm), t is step (day), Rday is rainfall for the i day (mm), Qsurf is
surface runoﬀfor the i day (mm), Ea is the evaporation for the i day, Wseep is
inﬁltrating and side-ﬂow for the i day of soil bottom section (mm), Qgw is water
ﬂow for the i day (mm) [3].

SWAT Hydrological Model and Big Data Techniques
81
1. Weather and Climate: Watershed climate provides moisture and energy
inputs, which controls the water balance. The climatic variables required by
SWAT are daily precipitation, maximum/minimum temperature, solar radia-
tion, wind speed and relative humidity. The model reads measured data, and
generate climate automatically by weather generator.
2. Hydrological Process: During the precipitation process, it may be intercepted
in vegetation canopy or directly drop to soil surface. Soil surface moisture
will inﬁltrate into the soil or generate proﬁle runoﬀ, which moves relatively
fast and causes short-term river response when it runs into river. Inﬁltration
of water can be retained in soil, and then be evaporated, or move slowly to
surface water system. The physical processes involved include: canopy storage,
inﬁltration, redistribution, evapotranspiration, side runoﬀ, surface runoﬀ, and
return ﬂow.
3. Erosion: Calculate the erosion of each HRU and sediment by soil loss equation
(MUSLE). MUSLE uses runoﬀto simulate erosion and sediment yield, which
can improve the prediction accuracy of model, and estimate the single storm
sediment yield. The hydrological model supports net runoﬀand peak ﬂow
rate, which can be used to calculate runoﬀerosivity combined with subbasin.
Erosion produced by rainfall runoﬀis calculated by Modiﬁed Universal Soil
Loss Equation (MUSLE), and the formula is below:
Y = 11.8(Q × pr)0.56KUSLE × CUSLE × PUSLE × LSUSLE
(2)
Y is quantity of soil erosion (t), Q is surface runoﬀ(mm), pr is peak runoﬀ
(m3/s), KUSLE is soil erosion, CUSLE is vegetation cover and crop manage-
ment factor, PUSLE is conservation measure factor, LSUSLE is terrain factor.
4. Nutrients and Pesticides: SWAT model can track the migration and trans-
formation of nitrogen and phosphorus in several forms. Nutrients run into
the river by surface runoﬀand interﬂow, and be transported to river down-
stream. SWAT model simulates the surface runoﬀcarrying pesticides into
river, through the leakage into the soil proﬁle and aquifer.
5. Agriculture Management: SWAT model can deﬁne in each HRU about the
start date of growing season, the time and amount of fertilization, the use of
pesticides and irrigation of farming schedule according to the management
measures. Beyond these basic management measures, model includes grazing,
automatic fertilization and irrigation, as well as every possible water manage-
ment options. The latest improvement in land management is the integration
of sediment and nutrient loads from urban runoﬀ[4].
2.3
Model Structure
Once the SWAT model determines the main river water, sediment, nutrients and
pesticides load, river network load is calculated by HYMO command structure.
In order to track the material ﬂow in the river, SWAT model simulates the chem-
ical conversion of the river, and computation involves: surface runoﬀ, soil water,
groundwater, river, and the conﬂuence of the water storage. The model structure

82
X. Guo et al.
diagram is in Fig. 1. SWAT model has various parameters, mainly include: DEM,
spatial distribution of hydro-meteorological station data, soil type and land use,
series of evaporation and river data, etc. The list of input parameters could be
referred in Table 1.
Fig. 1. SWAT model structure
3
WangMo River Simulation on SWAT Model
WangMo river is located in the middle of WangMo county, GuiZhou province,
which is slope zone transition of Yunnan-Guizhou plateau to Guangxi hilly, and
basin is consisted of karst and normal landform. Annual rainfall is 1249.3 mm,
ﬂood season happens concentratively between April and October, and rainy sea-
son accounted for 83.14% of the whole year. This river is one of the main branches
of BeiPan river, and rises in DaYi village of WangMo county north, run into
BeiPan river in WangMo county boundary. The study area is the main stream
of river basin, the coordinate is 106◦2′–106◦12′E, 25◦9′–25◦23′N. WangMo river
is 74 km long, drop height 1050 m, basin area 554 km2. Main tributaries includes:
NaBa river, NaGuo river, NaChao river, SongLin river. River basin belongs to
the seasonal mountain river, and ﬂood varies along with the rainfall. Since year of
70s, there has been occurred dozens of severe ﬂoods, collapse, landslide, debris
ﬂow and other geological disasters. At present, there are few research about
WangMo river basin runoﬀ. In this section, we use SWAT model to study vari-
ous factors on the WangMo basin runoﬀ, which can be based on the analysis of
climate change, land use, and land cover.

SWAT Hydrological Model and Big Data Techniques
83
Table 1. SWAT model input datasets
Type
Shape
Parameter
Source
Digital
elevation data
Raster
Elevation, Slope length, River slope
direction
STRM3
arc-seconds
Land use data
GRID
Leaf area index, Vegetation root
depth, Runoﬀcurve number, Pipe
layer height, Manning coeﬃcient
GLC2000
Lucc 1 km
Soil type
GRID
Density, Saturated water
conductivity, Water retention rate,
Particle content, Root depth
HWSD
Meteorological
data
DBF table Max–Min temperature, Daily
precipitation, Relative humidity,
Solar radiation and Wind speed
Meteorological
CMADS
Hydrological
data
DBF table Daily ﬂow, Monthly ﬂow, etc.
Hydrological
site data
Land
management
info.
x
Farming methods, Vegetation type,
Irrigation methods, Fertilization
time and quantity
Investigation
of statistics
SWAT is a data driven model and it requires several types of data, which
are listed in Table 1. Digital Elevation Data (DEM) were obtained from Shut-
tle Radar Topography Mission (STRM3), NASA and NIMA, U.S. Land cover
datasets were adopted from GLC2000 LUCC 1 km CHINA, and China area
datasets is cut from the global data [5]. Soil datasets were from Harmonized
World Soil Database (HWSD). Weather datasets were collected from China
Meteorological Assimilation Driving Datasets for SWAT model (CMADS) [5].
Diﬀerent processes have been carried out when databases were established.
Considering hydrological behavior of the basin with losing productive soil and
water as runoﬀproblems, the study took with SWAT2012 integrated with Arc
GIS10.3.1 to evaluate the surface runoﬀwatershed of WangMo river [6]. SWAT
model is physically based and computationally eﬃcient, uses readily available
inputs and enables users to study long-term impacts. To use the model estimates
WangMo river basin runoﬀ, ﬁrstly, we need to setup a new SWAT project and
load the existed WangMo river DEM from disk and deﬁne the river network.
Figure 2 shows the processes of running SWAT model. The key procedures of
modeling is as follow:
– Load or select the SWAT extension checking the relative box in the BASINS
Extension Manager (Models category). Add three types of nodes: the rivers
export, entry and source point. Generally speaking, one natural basin only
has one export.
– Delineate the watershed and deﬁne the Hydrological Response Units (HRU).
We obtained watershed map when calculated the sub-basin and activated
reservoir button.

84
X. Guo et al.
– Edit SWAT databases and make database index (data including: soil, slope,
land use, weather, etc.). Model analyzes land use, soil coverage and HRU and
make them overlay together. This is the most complex step, because when
establish database, you need calculate lots of parameters by equations.
– Deﬁne the weather data with weather generator (data including: relative
humidity, solar radiation, and wind speed).
– Set up and run SWAT simulation, after then, apply the default input ﬁles
writer.
– Analyze, plot and graph SWAT output (SWATOutput.mdb) with Origin.
Fig. 2. SWAT model simulation of WangMo river
3.1
Results and Discussion
From the simulation of SWAT model, we obtain relationship between precipita-
tion and runoﬀin the watershed of WangMo river, which could be referred to
Fig. 3, and the simulation period is the average of each month from year 2008 to
2016. Firstly, it reﬂects the eﬀect of rainfall intensity. When a rainstorm occurs
in the watershed, it generates large runoﬀ, which makes the runoﬀappear large
jump in result graph. However, in the period of drought, due to the lack of
rainfall, runoﬀdecreases [7,8]. In the case of heavy rainstorm, soil water conser-
vation is diﬃcult to play an eﬀective role. At present, due to human activities,
it causes serious damage to the environment, which also makes the relationship
between runoﬀand rainfall become complicated [9]. While upstream desertiﬁ-
cation phenomenon occurs, it makes groundwater become lower, and reduces
runoﬀstorage. The soil moisture content of various eﬀects will make the runoﬀ
results diﬀerent.
When analyzing the relation between precipitation and runoﬀby SWAT
model, we supposed that temperature T is a constant, and then change the
value of precipitation. We found that there was a positive correlation between
precipitation and runoﬀand the result is shown in Fig. 4. When precipitation P1
increased by 40%, the runoﬀincreased 115.43 mm, and increased by 71.2% on

SWAT Hydrological Model and Big Data Techniques
85
Fig. 3. SWAT model results
the basis of the original runoﬀ; When P2 increased by 20%, the runoﬀincreased
61.42 mm, and increased by 35.23% on the basis of the original runoﬀ; When the
P3 was reduced by 15%, the runoﬀwas reduced 41.55 mm, which was reduced
by 25.24% on the basis of the original runoﬀ; When the P4 was reduced by 30%,
the runoﬀwas reduced 79.48 mm, which was reduced by 54.87% on the basis of
the original runoﬀ.
Fig. 4. Runoﬀvariation with precipitation
3.2
Big Data with Hydrological Models
The arrival of big data era has brought hydro-meteorological information oppor-
tunities and challenges. This section introduces how to enhance the theoretical
basis of hydrological model with big data support, broaden model’s applicabil-
ity, and propose a framework of intelligent real-time hydrological model of big
data driven; discuss on the aspects that we can spare eﬀort to study hydrological
model forecasting precision of big data techniques. More and more people under-
stand and pay close attention to hydro-meteorological model with big data, which
will be widely used in society [10,11]. Big data needs new processing mode to
have a strong decision-making capability, process optimization of massive, high
growth rate and diversiﬁcation of datasets. In other words, if we take big data

86
X. Guo et al.
as an industry, the key of achieving proﬁtability such industry is to improve the
data processing capacity by making value-added data [12,13].
At present, water resource data center mainly uses relational database to
manage structured data and implement geographic spatial data extending; orga-
nizing semi-structured or unstructured data by relational database and ﬁle stor-
age directory management. For water conservancy data storage and application
requirements, the existing data storage structure has a bottleneck on aspects
of data processing and analyzing [14]. Therefore, this section puts forward an
idea about the structure of hydrological model data center based on big data
platform, including data collection, data storage, data processing and analysis,
and data application of four layers, which can be referred in Fig. 5.
Hydrological forecasting plays a very important role in ﬂood control and
disaster reduction. Due to the climate change and human activities, the basic
law of hydrology has changed a lot, and those past hydrological models can not
meet the needs of sustainable development of social economy. The hydrological
runoﬀmonitoring, rainfall, DEM and soil vegetation, remote sensing images
bring increasing rich elements of big data. Research of new hydrology forecast
technology driven by big data has become an inevitable way to solve above
problems.
Fig. 5. SWAT model on big data platform
In the background of big data, we can conduct the thorough research from
the following several aspects about hydrological law in big data mining, runoﬀ
theory method, and the cloud stage of real-time eﬃcient forecasting technology.

SWAT Hydrological Model and Big Data Techniques
87
– Research on ﬂood characteristic pattern and parameter geography big data
mining method. This could study from the characteristics of storm ﬂood and
construct a typical watershed model library.
– Research on precise hydrological model and big data driven intelligent
real-time forecast model, ﬂood forecast integration and real-time correction
method, which is based on water storage capacity curve and terrain index
of semi distributed dynamic combination in order to improve the prediction
accuracy of semi-humid and semi-arid.
– Study on redistribution of ﬂow along the side and water unit exchange
between grid adaptive distributed simulation technology and precise predic-
tion of watershed, which could achieve arbitrary grid unit ﬂow and water
level, improve the accuracy of real-time ﬂood forecasting in complex basin.
– Research of water conservancy satellite remote sensing monitoring system
and hydrological forecasting cloud platform, in order to achieve an integrate
multi system running environment. Multi particle splitting, loose coupling
and service collaboration technology could achieve hydro-meteorological ﬂood
forecast transferring, which can improve the eﬃciency, expand forecast period,
and improve the accuracy of hydrological forecasting.
Flood forecasting plays a very important role in ﬂood control and disaster
reduction. Due to climate change, human activities, social economy development,
ﬂood forecasting encounters new problems and challenges. Study on the develop-
ment of runoﬀtheory, and create model of complex river basin and high accuracy
ﬂood forecasting, which has become the key technical points of national ﬂood
control. In the future, we can carry out the research and application of ﬂood
forecasting methods base on the data mining and big data techniques according
to researches aspects above.
4
Conclusion
To develop a suitable model for the hydrological process for a river basin is
the most important aspect for water resource management. SWAT hydrological
model is applied to WangMo, GuiZhou watershed in order to assess the relation-
ship between runoﬀand precipitation. Input datasets DEM, STRM3, HWSD,
GLC2000, CMADS are quite applicable to run the SWAT model for the basin.
The performance and applicability of SWAT model was successfully evaluated
through model calibration. Average annual prediction of stream ﬂow is 95.54 mm.
As this model has a broaden functions, the model can be utilized not only as a
potential tool for water resource management, but also help assess diﬀerent land
management and evaluate the eﬀect of climate change on soil erosion.
Big data technology promotes water conservancy data acquisition, manage-
ment and application of the rapid development. This paper also proposes a big
data technology data center architecture of hydrological model, and to demon-
strate how it can improve the management. And MapReduce series big data
technology break through traditional data analysis perspective in a completely
diﬀerent way, in order to build the ﬂood forecasting model in a more accurate
way.

88
X. Guo et al.
References
1. Ning, J., Liu, G., Liu, Q., Xie, C.: The hydrologic response unit (HRU) on SWAT
model. Adv. Water Sci. 23(1) (2012)
2. Sun, R., Zhang, X.: The Basin runoﬀstudy based on SWAT model. Geogr. Sci.
Dev. 30(3), 28–32 (2010)
3. Gassman, P.W., Reyes, M.R., Green, C.H., Arnold, J.G.: The Soil and Water
Assessment Tool Historical Development. Applications and Future Research Direc-
tions. Center for Agricultural and Rural Development Lowa State University,
Working Paper 07–WP 443
4. Jayakrishnan, R., Srinivasan, R., Santhi, C., Arnold, J.G.: Advances in the appli-
cation of the SWAT model for water resources management. Hydrol. Process. 19,
749–762 (2005)
5. This data set is provided by Cold and Arid Regions Science Data Center at
Lanzhou. http://westdc.westgis.ac.cn
6. Source for this dataset was Global Land Cover 2000 database. European Commis-
sion, Joint Research Centre (2003). http://www-gem.jrc.it/glc2000/
7. Xu, L., Luan, Y., Cheng, X., Cao, X., Chao, K., Gao, J., Jia, Y., Wang, S.:
WCDMA data based LTE site selection scheme in LTE deployment. In: Inter-
national Conference on Signal and Information Processing, Networking and Com-
puters (ICSINC), Beijing, China, pp. 249–260. CRC Press, Taylor and Francis
Group (2015)
8. Xu, L., Chen, Y., Chai, K. K., Luan, Y., Liu, D.: Cooperative mobility load bal-
ancing in relay cellular networks. In: IEEE International Conference on Commu-
nication in China (ICCC), Xi’an, China, pp. 141–146. IEEE Press (2013)
9. Xu, L., Cheng, X., Liu, Y., Chen, W., Luan, Y., Chao, K., Yuan, M., Xu, B.:
Mobility load balancing aware radio resource allocation scheme for LTE-advanced
cellular networks. In: IEEE International Conference on Communication Technol-
ogy (ICCT), Hangzhou, China, pp. 806–812. IEEE Press (2015)
10. Cao, Y., Wang, N., Sun, Z., Cruickshank, H.: A reliable and eﬃcient encounter-
based routing framework for delay/disruption tolerant networks. IEEE Sens. J.
15(7), 4004–4018 (2015)
11. Cao, Y., Sun, Z., Wang, N., Riaz, M., Cruickshank, H., Liu, X.: Geographic-based
spray-and-relay (GSaR): an eﬃcient routing scheme for DTNs. IEEE Trans. Veh.
Technol. 64(4), 1548–1564 (2015)
12. Rui, X.: Hydrology and big data. In: Advances in Science and Technology of Water
Resources, vol. 36. College of Hydrology and Water Resources, Hohai University
(2016)
13. Xu, L., Chen, Y., Gao, Y., Cuthbert, L.: A self-optimizing load balancing scheme
for ﬁxed relay cellular networks. In: IET International Conference on Communica-
tion Technology and Application (ICCTA), Beijing, China, pp. 306–311. IET Press
(2011)
14. Xu, L., Luan, Y., Cheng, X., Xing, H., Liu, Y., Jiang, X., Chen, W., Chao, K.: Self-
optimised joint traﬃc oﬄoading in heterogeneous cellular networks. In: IEEE Inter-
national Symposium on Communications and Information Technologies (ISCIT),
Qingdao, China, pp. 263–267. IEEE Press (2016)

A Survey on Security Issues in Big Data
of Ubiquitous Network
Yuehua Huo1, Yanyu Sun2, Weiqiang Fan2, Xinzhou Cheng3,
Dong Li1, and Yinlong Liu4(&)
1 Center of Modern Education Technology,
China University of Mining and Technology, Beijing 100083, China
2 School of Mechatronics and Information Engineering,
China University of Mining and Technology, Beijing 100083, China
3 China Unicom Network Technology Research Institute, Beijing 100048, China
4 Institute of Information Engineering, Chinese Academy of Sciences,
Beijing 100093, China
huoyh@cumtb.edu.cn, chinahuo007@163.com
Abstract. In the ubiquitous network, these many devices generate a huge
amount of data. The sharp increase of the diverse devices has led to the various
heterogeneous data types and the booming growth of the data, that is, the
ubiquitous network will bring big data. Due to the heterogeneity and ubiquitous
nature of ubiquitous networks, the big data of ubiquitous network faces a broad
and growing range of security threats and challenges. Based on the basic
knowledge of the big data of ubiquitous network, this paper analyzes the
security threats in the process of data collection, storage, processing and
application. System elaborated the big data of ubiquitous network encryption
and integrity protection, access control, privacy protection, attack detection,
security technology research status. The research direction and future devel-
opment direction are also discussed in this paper.
Keywords: Ubiquitous network  Big data  Information security  Intelligent
1
Introduction
With the rapid development of network technology, both at home and abroad pay more
and more attention to the study of ubiquitous network, increasing investment, making
the network is widely used in social and economic sustainable development and
national development strategy, extensive penetration as part of the network in all walks
of life, become strategy core of each country. A large number of sensor networks,
RFID [1] and other widely used, so that everything can be data, people realize that the
nature of the world is the data, and the data will gradually completely change the future
of the world.
Nowadays, the ubiquitous network plays a central role in the national strategic
development, triggered unprecedented national investment and the further research of
many scholars, and aiming at security problems exist in the process of its development,
put forward the solution. The United States proposed broadband urban planning [2],
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 89–98, 2018.
https://doi.org/10.1007/978-3-319-72823-0_10

the plan for the arrival of the network to pave the way at the same time, will be in the
United States to set up a wide range of urban broadband network. The South Korean
government also proposed the “U-Korea” strategic plan [3], ubiquitous sensor network,
broadband network integration and IPv6 core network is included in the investment
plan of infrastructure construction, the construction of a part of achievements in the
promotion, in city management, medical treatment, military has been widely used. In
China, some research on the ubiquitous network is gradually carried out, such as
“perception of China”, “U-Beijing” and “U-Qingdao” [4] is one of the typical
representative.
With the extensive application of 4G network, 5G [5, 6] as a new wireless access
technology is gradually into people’s lives, it has more powerful features, will be a true
sense of the integration of the network [5, 7]. In this paper, according to the charac-
teristics of ubiquitous network data, generally reveal: safety issues faced in the ubiq-
uitous network of different network structure and big data in different data processing
stages, and the corresponding solutions and technology.
2
Big Data of Ubiquitous Network
2.1
The Concept and Characteristics of Big Data of Ubiquitous Network
Ubiquitous network is wider than the web of things, more extensive content. It is
generally believed that the sensor network, the sensor node is composed of a large
number of networking, personal and social network etc., which refers to at any time
(Anytime) of any location (Anywhere) of any person (Anyone) and (Anything) any
communication [8].
Big data [9], also known as mass data, refers to the size of the data involved to a
huge scale cannot be artiﬁcial or computer, within a reasonable time to achieve
interception, management, processing, and sorting into human interpretations of the
form of information. Ubiquitous network is the root of big data, has a close connection,
the network application can promote the research of big data. Big data is the resources
and wealth, big data analysis makes the decision more scientiﬁc, more intelligent
terminals, will promote the ubiquitous network more intelligent and more widely used
to promote its further rapid development. Big data generated by the ubiquitous net-
work, due to the large amount of data and fast generation and often change charac-
teristics [10], if the encryption and decryption technology and traditional hash
algorithm [11] to achieve the integrity of the identiﬁcation and authentication of data,
the efﬁciency is low and it is hard to meet the real-time, consistency and synchro-
nization so on. The ubiquitous network is still in the stage of the Internet of things, big
data mining, analysis and processing methods are not mature, at the same time, we
must face many security problems of big data, in the ubiquitous network, and more
complex than ever. Therefore, it is necessary for the ubiquitous network security key
problems on the big data of research, for the application of ubiquitous network and big
data cleared.
90
Y. Huo et al.

2.2
Security Challenges for Big Data of Ubiquitous Networks
The doubling of the amount of data challenges the ability to store data; the traditional
database lacks strong scalability and better system availability, and cannot effectively
store unstructured and semi-structured data such as video and audio. Cloud storage in
the application of big data to bring development opportunities at the same time, also
brought a huge security risk. First of all, the user data storage and security entirely by
the cloud computing provider is responsible for the data is transparent to the provider.
Second, in the cloud storage, the user’s data is stored in the Internet server, an increase
of unauthorized access to security issues.
With the increasing scale of data, the time of analysis and processing is corre-
spondingly longer and longer, and the time requirement of information processing is
getting higher and higher under big data condition. The processing of big data requires
more simple and effective artiﬁcial intelligence algorithm and new problem solving
method. Discover new methods, predict predictability of threats, and detect and judge
unknown threats. The Prism Plan is a case of a large data technology for security
analysis. The basic principle is to discover potentially dangerous situations by col-
lecting various types of data from various countries, using safety-related data and
threatening security analysis. Identify the threat before it occurs.
3
Security Problems in Big Data of Ubiquitous Network
3.1
Security Threats in the Acquisition Process
Most of the current privacy protection using location, identiﬁer, anonymous connection
and other methods. But in practice, in addition to face the threat of personal privacy,
people through the vast amounts of data, analysis of people’s living state and behavior,
prediction, through anonymous protection in today’s era of big data is not fully achieve
the purpose of privacy protection. On the one hand, due to the current lack of user data
collection, storage, management and use of norms, lack of supervision and effective
management, mainly rely on self-discipline, cannot guarantee the user privacy infor-
mation purposes; On the other hand, the data traceability and intelligent analysis
technology in the big data age can analyze the sensitive information such as data
sources and obtain the privacy data [12].
3.2
Security Threats to Stored Procedures
The arrival of cloud storage, big data applications with more development opportu-
nities, but also with a huge security risk. Firstly, cloud computing providers are fully
responsible for the storage and security of user data, the data provider is transparent.
Secondly, in the cloud storage, the user’s data is stored in the Internet server, an
increase of unauthorized access to security issues. As shown in Fig. 1, it analyzed
cloud storage ubiquitous network data security; research on big data security of
ubiquitous network based on cloud storage includes data integrity protection and access
control.
A Survey on Security Issues in Big Data of Ubiquitous Network
91

3.3
Process Security Threats
In terms of pattern matching algorithms. In English character environment, classic
DFSA application efﬁciency is very high, if utilized directly match characters, the
construction of a Chinese character storage expansion problems when a Hash table. To
this end, Shen Zhou [13], Wong [14], Gao Peng [15], respectively, put forward dif-
ferent algorithms. In text content analysis, the text content analysis in cloud content
monitoring, the depth of the user identiﬁcation of suspicious information, but also can
ﬁnd the current ﬂow of hot information.
3.4
Application Process Security Threats
In the ubiquitous network environment, the content of the network is richer, and the
ﬂooding of reactionary, pornographic, violent and other undesirable contents has
become a problem to be solved urgently [16]. How to ensure the legitimacy and health
of data content has become a big data analysis And big data security research areas of
hot issues, and cause more and more attention.
4
Security Technology in Big Data of Ubiquitous Network
4.1
Data Encryption
Research on Cloud Storage Key Management and Auditing Proxy Mechanism, Cloud
Storage Service (Cloud Storage Service). In addition to the general personal data
storage, but also to allow enterprises or data owners (Data Owner, DO) to facilitate the
sharing of data services. But when DO wants to share speciﬁc data, especially secret
information to a speciﬁc group or individual, the data access control and key man-
agement information security issues need to be considered. Zhao [17] proposed a
classiﬁcation proxy re-encryption technique, which enables data distributors to
implement ﬁne-grained categorization control of ciphertext delegation. Wu [18] gives a
proxy-re-encryption algorithm with no certiﬁcate and an identity-based key escrow
protocol. Liang [19] studied the identity-based revocable proxy re-encryption
Fig. 1. Big data security analysis of cloud storage
92
Y. Huo et al.

mechanism. Fang [20] proposed an anonymous conditional proxy re-encryption
scheme and a fuzzy condition proxy re-encryption scheme [21] to improve the per-
formance of the algorithm.
4.2
Integrity Protection
Integrity protection consists mainly of two components, POR and PDP. Literature [22]
builds a hierarchical architecture that provides high availability and integrity protection
for data by combining two-dimensional RS coding with a challenge-response mecha-
nism. Literature [23] gives a method to determine the integrity of the data. That is, the
authentication element is generated from each ﬁle data block, in the challenge of the
challenge - response mechanism, adopt the method of pseudo random, draw a small
amount of data blocks, judgment data integrity can be achieved through authentication
of authentication element. Literature [24] proposed method based on the pattern of
challenge - response “Data type to hold Proof” (Proof of Data Possession, PDP),
namely in outsourcing Data, detect is greater than a certain percentage of Data cor-
ruption. Literature [25] to solve ﬁles in multiple servers distributed storage situation,
proposed the CPDP (Cooperative Provable Data Possession). The proposed scheme
utilizes a homomorphic authentication response to combine responses from different
cloud servers into a single response message. Currently, the big data integrity of the
cloud to verify mainly rely on a third party to complete. According to whether to allow
the restoration of the original data, the current data integrity veriﬁcation protocol can be
divided into two categories: only to verify data integrity of the PDP protocol and allow
recovery of data POR protocol. Data integrity veriﬁcation of the general process shown
in Fig. 2.
4.3
Access Control
In the aspect of access control, the decryption rules are embedded in the encryption
algorithm through the algorithms of KP-ABE and CP-ABE [26] (ABE), which can
avoid the frequent occurrence of ciphertext access control Key distribution cost.
Fig. 2. Data integrity veriﬁcation of the general process
A Survey on Security Issues in Big Data of Ubiquitous Network
93

However, when the control strategy changes dynamically, the data owner (the Data
Owner) is required to re-encrypt the data. In literature [27], Cloud service providers
(cloud service provider, CSP) agent in order to reach the goal of user revocation, the
cipher text from an encrypted access structure to another encrypted access structure.
Undo unit has a certain limitation of the scheme, a single user cannot complete the
revocation, only is a set of properties. Literature [28] cipher text access control scheme
is put forward, to support ﬁne-grained access control strategy, but when undo attribute
and user privileges, DO the calculation of the price has a linear relation with the data
ﬁle size. In summary, for the purpose of proﬁt-making CSP, cannot effectively guar-
antee security.
4.4
Privacy Protection
Ubiquitous network game model of big data privacy protection required game basic
research. Based on the previous research, we have fully understood the privacy
requirements and the basic technical means at all levels. It is proposed that participants,
strategy (attack and defense strategy, behavior rule set), information collection (com-
mon knowledge) Action and action sequences, utility (payment) functions and other
basic elements of the game to abstract and extract. Based on the ubiquitous network
heterogeneity, diversity of unstructured characteristics of big data, both offensive and
defensive behavior, the environment, the diversity of information, the incomplete
information dynamic game, combined with Bayesian equilibrium subgame perfect
Nash equilibrium, and the Bayesian inference method, the optimal privacy policy.
4.5
Attack Detection
DDoS attack detection has been a very important research topic in network intrusion
detection. In recent years, a variety of different types of detection platforms and
algorithms have been proposed to solve DDoS attacks, and many technical problems
have been solved and many achievements have been made. Among them, the infor-
mation entropy power system is described as random degree of effective index,
gradually become the research focus in the network anomaly trafﬁc analysis and
detection. We based on the theory of information entropy and chaos phase space
reconstruction theory, through the in-depth study of typical DDoS attack scenario, put
forward the following two methods for intrusion detection: Detection Method Based on
Tsalli Entropy and Lyapunov Exponent. First, the entropy of the source IP address and
the destination IP address in the network trafﬁc packet is counted to reﬂect the ran-
domness of the source IP address and the concentration of the destination IP address in
the response attack. On the basis, the Lyapunov exponent in chaos theory is introduced
to calculate the degree of separation between the source IP address entropy and the
destination IP address entropy, and the attack trafﬁc is distinguished from the normal
trafﬁc. Detection Method Based on Markov Chain and Kolmogorov Entropy. By
analyzing the degree of protocol dependency of various network packets in attack
trafﬁc, the Markov chain model is established, and the complex Markov chain model is
simpliﬁed by entropy rate sequence, and the chaotic phase space reconstruction is
introduced. The data is reconstructed by using the geometric invariant feature
94
Y. Huo et al.

Kolmogorov entropy of the phase space to reﬂect the inherent chaos of the network
trafﬁc model to achieve the purpose of detecting the attack. The above research has
basically reﬂected the advantages of information entropy theory in the analysis of
network anomalies and network intrusion, so the above research provides a theoretical
basis for big data analysis.
5
Prospect of Security Technology in Big Data of Ubiquitous
Network
5.1
Technical Level
On the technical level, the subsystems are independent and closely integrated with each
other. Each part belongs to an indivisible whole, it will be the perfect fusion of the
subsystems together. In general can be divided into the ubiquitous network, the security
of data architecture and technical analysis, related research in information industry and
the practical application of hercynian information industry, and a few kinds big data
pretreatment method in between data key security study four blocks of the model.
By analyzing the security requirements at different levels of the ubiquitous network
and different stages of big data, the preprocessing technology of big data in the
ubiquitous network, the application technology in the information industry and the
speciﬁc key security models are studied. In turn, these three aspects of research are the
key to promoting the development and application of large-scale data security
technologies.
The big data preprocessing technology is the foundation of the research on the
concrete data security model of the big data network. It can also be used in the actual
information industry to solve the difﬁcult problems in the application of the information
industry and promote its further healthy development.
As shown in Fig. 3, the big data processing from front to back into data collection,
data transmission, data analysis, data analysis at different stages. Then the security
problems faced by different stages are analyzed. The security techniques and methods
that may be adopted in each stage are determined. For example, the integrity of the big
data transmission stage can be veriﬁed by digital watermarking technique.
Fig. 3. Ubiquitous network and big data architecture, security requirements and technical
analysis and application
A Survey on Security Issues in Big Data of Ubiquitous Network
95

5.2
Management Level
In the case of big data, a large number of users need to implement the rights man-
agement, and the user speciﬁc authority requirements unknown. In the face of unknown
large amounts of data and users, it is very difﬁcult to set the role in advance. Con-
struction of important sensitive equipment and carrier management and monitoring
system architecture and standards, and based on RFID and other Internet of things
technology, from the production to the retirement of the whole life cycle management
and control system to complete the relevant standards development, system develop-
ment work.
First of all, the establishment of content monitoring knowledge model; then, based
on “people, behavior, content,” the sensitive data-aware platform, the generalized
network of information data sets for preliminary screening, reduce the amount of
redundant information; Finally, the establishment of dynamic awareness of the net-
work, the suspicious, potential portals, forums and users real-time tracking analysis, so
that quickly found, in time to stop. The practical application of big data in the infor-
mation industry can lead to further improvement of big data analysis methods and help
to improve the management level. The security model can be applied directly to the real
information industry.
6
Conclusion
According to the characteristics of big data, we fully analyze the security problems and
research status, and on this basis, we look at the research direction at the technical and
management level. Therefore, the research on the big data and security in the network
has far-reaching theoretical signiﬁcance and practical application value. The research
on it is not only necessary in the construction of the theoretical system, the key
technology and the improvement of the security problems, Mode, laws and regulations
and other aspects of exploration, but also need to carry out theoretical validation and
demonstration of its application, it is better for the community to provide services.
Analysis and utilization of big data in the ubiquitous network can make the future more
common in the network will be more intelligent.
References
1. Van den Elzen, S.V., Wijk, J.J.: Multivariate network exploration and presentation: from
detail to overview via selections and aggregations. Vis. Comput. Graph. 20, 2310–2319
(2014)
2. Xu, X.Q., He, G.N., Zhang, S.Q., Chen, Y., Xu, S.G.: On functionality separation for green
mobile networks: concept study over LTE. Commun. Mag. 51, 82–90 (2013)
3. Kushiro, N., Higuma, T., Nakata, M., Kubota, H., Sato, K.: Practical solution for
constructing ubiquitous network in building and home control system consumer electronics.
IEEE Trans. Consum. Electron. 53, 1387–1392 (2007)
4. Saito, H., Kagami, O., Umehira, M., Kado, Y.: Wide area ubiquitous network: the network
operator’s view of a sensor network. Commun. Mag. 46, 112–120 (2008)
96
Y. Huo et al.

5. Zhang, H., Dong, Y., Cheng, J., Hossain, M., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23, 48–53 (2016)
6. Xu, L., Chen, Y., Chai, K.K.: Cooperative mobility load balancing in relay cellular
networks. In: 2013 IEEE/CIC International Conference on Communications in China, Xi’an,
pp. 141–146. IEEE Press (2013)
7. Xu, L., Cheng, X., Liu, Y.: Mobility load balancing aware radio resource allocation scheme
for LTE-advanced cellular networks. In: IEEE International Conference on Communication
Technology, Hangzhou, pp. 806–812. IEEE Press (2015)
8. Chung, Y.F., Tsai, M.Y., Wu, E.P., Chiang, D.L., Lee, C.C., Hsiao, T.C., Chen, T.S.: Bed
site health care video-phone system. Appl. Mech. Mater. 284–287, 1636–1641 (2013)
9. Hashem, I.A.T., Yaqoob, I., Anuar, N.B.: The rise of “big data” on cloud computing: review
and open research issues. Inf. Syst. 47, 98–115 (2015)
10. Guo, F., Wang, J.M., Li, D.Y.: Finger printing relational databases. In: ACM Symposium on
Applied Computing, Dijon, pp. 487–492. ACM Press (2006)
11. Jiang, C.X., Sun, X.M., Yi, Y.Q., Yang, H.F.: Research on database public watermarking
algorithm based on JADE algorithm. J. Syst. Simul. 18, 1781–1785 (2006)
12. Zhang, H., Xing, H., Cheng, J., Nallanathan, A., Leung, V.: Secure resource allocation for
OFDMA two-way relay wireless sensor networks without and with cooperative jamming.
IEEE Trans. Ind. Inf. 12, 1714–1725 (2016)
13. Shen, C., Wang, Y.C., Liu, G.S.: Improved algorithm of multi-pattern matching for Chinese
string. Acta Agron. Sin. 21, 27–32 (2002)
14. Zhao, J., Zheng, W., Wen, X., Zhang, H., Lu, Z., Jing, W.: Research on the resource
allocation of OFDMA relay network based on secrecy ratio. J. Electron. Inf. Technol. 36,
2816–2821 (2014)
15. Zhao, J., Lu, Z., Wen, X., Zhang, H., He, S., Jing, W.: Resource management based on
security satisfaction ratio with fairness-aware in two-way relay networks. Int. J. Distrib.
Sens. Netw. 2015, 11 (2015)
16. Wang, T., An, B.Y., Peng, Z., Zhang, G.L., Zhong, B.N.: Blue card-green communications
for exchanging information of mobile users. J. Comput. Inf. Syst. 10, 8153–8160 (2014)
17. Schell, R.: Security — a big question for big data. In: 2013 IEEE International Conference
on Big Data, Santa Clara, p. 5. IEEE Press (2013)
18. Bowers, K.D., Luels, A., Oprea, A.: Hail: a high-availability and integrity layer for cloud
storage. In: 16th ACM Conference on Computer and Communications Security, Chicago,
pp. 187–198. ACM Press (2009)
19. Zhao, J., Feng, D.G., Yang, L.: CCA-secure type-based proxyre-encryption without pairings.
Acta Electron. Sin. 39, 2513–2519 (2011)
20. Wu, X.X., Li, X.U., Zhang, X.W.: A certiﬁcateless proxyre-encryption scheme for
cloud-based data sharing. In: 18th ACM Conference on Computer and Communications
Security, Chicago, pp. 869–871. ACM Press (2011)
21. Liang, K., Liu, J.K., Wong, D.S., Susilo, W.: An efﬁcient cloud-based revocable
identity-based proxy re-encryption scheme for public clouds data sharing. In: Kutyłowski,
M., Vaidya, J. (eds.) ESORICS 2014, Part I. LNCS, vol. 8712, pp. 257–272. Springer, Cham
(2014). https://doi.org/10.1007/978-3-319-11203-9_15
22. Weng, J., Deng, R.H., Ding, X.H.: Conditional proxyre-encryption secure against
chosen-ciphertext attack. In: ACM ASIACCS 2009, pp. 322–332 (2009)
23. Fang, L.M., Wang, J.D., Ge, C.P.: Fuzzy conditional proxyre-encryption. Sci. China Inf. Sci.
56, 1–13 (2015)
24. Han, H., Wen, Y.G., Chua, T.S., Li, X.L.: Toward scalable systems for big data analytics: a
technology tutorial. IEEE Access 2, 652–687 (2014)
A Survey on Security Issues in Big Data of Ubiquitous Network
97

25. Yang, C., Liu, C., Nepal, S., Chen, J.: A time efﬁcient approach for detecting errors in big
sensor data on cloud. IEEE Trans. Parallel Distrib. Syst. 26, 329–339 (2015)
26. Zhang, G.L., Wang, Z.N., Du, J.X., Wang, T., Jiang, Z.N.: A generalized visual aid system
for teleoperation applied to satellite servicing. Int. J. Adv. Robot. Syst. 11, 1–7 (2014)
27. Yi, X.M., Liu, F.M., Liu, J.C., Hai, J.: Building a network highway for big data: architecture
and challenges. IEEE Netw. 28, 5–13 (2014)
28. Liang, X., Cao, Z., Lin, H.: Attribute based proxy re-encryption with delegating capabilities.
In: 4th International Symposium on Information, Computer and Communications Security,
pp. 276–286. ACM Press, New York (2009)
98
Y. Huo et al.

Telecom Big Data Based User Analysis
and Application in Telecom Industry
Guanglu Shao, Weiwei Chen, Xinzhou Cheng, Lexi Xu(&),
Tao Zhang, and Chen Cheng
China United Network Technology Corporation,
Beijing, People’s Republic of China
xulx29@chinaunicom.cn
Abstract. Due to the fast progress of mobile internet and smart phone, telecom
operators store massive telecom big data. In this paper, we utilize telecom big
data for the user analysis and application. Initially, this paper studies the content
of telecom big data. Then, 360-degree user portrait is drawn via three types of
factors, including user’s information, user’s consumption behavior and service
behavior. Based on the user portrait, this paper seeks 4G potential users via data
mining technique, which includes the business understanding, data preparation,
model building, model training, model evaluation and model deployment steps.
Based on the 4G potential users, the marketing department can accelerate the
transferring process from 2G/3G users to 4G users.
Keywords: Telecom big data  4G  Telecom operator  Data mining
User portrait
1
Introduction
The telecom industry experiences fast progress in the past decade [1, 2]. The dra-
matically increased network capacity and transmission rate allow a large number of
users to get access to networks [3, 4]. The telecom industries generate abundant
information, which is called telecom big data [5]. It’s generally known that telecom big
data brings great opportunity for telecom operators [6, 7].
Recently, telecom operators utilize telecom big data to generate value and bring
proﬁts, the value chain of telecom big data includes four stages, as shown in Fig. 1.
Fig. 1. Value chain of telecom big data
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 99–109, 2018.
https://doi.org/10.1007/978-3-319-72823-0_11

The ﬁrst stage is the data generation stage since customers generate abundant data
during the telecom services [8]. As the channel to bear these services, networks also
generate massive signaling data and service data [9, 10]. According to the data source,
telecom big data includes BSS data and OSS data. BSS data includes customer personal
information, voice billing details, data billing details, monthly billing etc. OSS data
includes measurement report (MR), counter, performance indicator, call detailed record
(CDR), engineering parameters etc. [11, 12].
The second stage is the data collection stage. The widely used method is telecom
operators set acquisition equipment in the network interface, thus collecting the data
stream, which pass the network interface. Typical network interfaces include A and
Abis interface in the switching network, Gb and Gn interface in GPRS, lu-PS and
lu-CS interface in 3G, S1 and X2 interface in LTE [13, 14].
After collecting the data stream, in the third data storage stage, telecom operators
can resolve data stream and form new-structure data, which suit for storage. Then,
telecom operators store these data. Since telecom big data has the characteristics of
large volume, effective storage is vital and cloud mechanism is a promising technique
to store telecom big data in the future [15].
The key of big data era is to seek the data value in the data analysis and application
stage [16, 17]. On one hand, telecom big data can be utilized in the telecom industry,
for example, telecom big data based network planning and optimisation, telecom big
data assisted market strategy, value-added service, telecom big data analysis of network
quality and performance [18, 19]. On the other hand, telecom big data can be also
utilized for the relevant industries, for example, advertisement, smart ﬁnance, transport,
epidemic control, human ﬂow control, public sentiment monitoring etc. [20].
In order to study the telecom big data application in the telecom industry, this paper
analyses the content of telecom big data and then draw the 360-degree user portrait,
including the characteristics, the resident area, the mainstream services and other
preferences of users. According to the user information and behavior, this paper uses
data mining technique to seek 4G potential users for telecom operators.
This paper is organised as follows: Sect. 2 describes the user portrait. Section 3
introduces the data mining process and presents 4G potential users analysis in details.
Conclusions are given in Sect. 4.
2
360 Degree User Portrait Analysis
Section 2 introduces the telecom big data and extracts user related information to draw
the user portrait. According to the data source, there are twenty-three types of telecom
big data, including seventeen types of OSS domain data and six types of BSS data [21].
The details of telecom big data are list in Table 1.
In this section, we extract user related information from above 23 types of telecom
big data. Then, we get three types of factors to draw the 360-degree portrait for each
user, as shown in Fig. 2.
The ﬁrst type of factors is the user’s information. It includes a series of static
attributes, including the age, the gender, the member level, the network type, the user
state etc. [15, 22].
100
G. Shao et al.

Table 1. Telecom big data source
Index Category Data source
1
OSS
domain
Engineering parameters
2
DT/CQT data
3
IU-PS/Gn/S1 interface data
4
CDR (call detailed record) data
5
MR (measurement report) data
6
Wireless trafﬁc statistical data
7
Wireless parameters
8
Core network data
9
Alarm data
10
Wireless call trace data
11
Equipment version and patch
12
Equipment load data
13
Wireless counter data
14
Core network counter data
15
Complaint data
16
Voice detail data
17
Resource conﬁguration data
18
BSS
domain
User detailed information
19
Monthly bill data
20
Voice service detail data
21
Data service detail data
22
Product information
23
Terminal information
Fig. 2. 360-degree portrait for each user
Telecom Big Data Based User Analysis and Application
101

The second type of factors is the user’s consumption behavior. It includes four
types of sub-factors, including the service character, the consumption character, the
trace, and the channel character [17, 23].
The third type of factors is the service behavior. It includes ﬁve types of sub-factors,
including the time preference, the geography preference, the service preference, the
terminal preference, and the Application (APP) preference [23].
After drawing the 360-degree portrait of each user, we further analyze the
user-group. This user-group analysis aims at studying the corresponding group of user
(e.g., potential value user-group, Iphone terminal user-group, 4G migrated user-group,
youth user-group etc.), according to a speciﬁc service requirement or a speciﬁc char-
acter [19, 24]. Typical user-group/clustering analysis algorithms include K-Means
algorithm, Clarans algorithm, Focused-Clarans algorithm, K-Medoids algorithm etc.
[25, 26].
On the basis of the 360-degree portrait and the user-group clustering analysis, we
can jointly analyse the user information, the consumption behavior, the service
behavior, as well as the network performance [27, 28]. In all, the 360-degree portrait
and the user-group analysis help telecom operators identify serving users and be aware
of the user-group precisely.
3
Data Mining Process for 4G Potential Users
3.1
Overall Process of 4G Data Mining
This section discusses the process of data mining for the 4G potential users targeting.
The data mining process for working a machine learning (ML) problem is illustrated in
Fig. 3. The whole process consists of six phases. This process provides a good cov-
erage of the steps needed, starting with business understanding, data preparation, model
building, model training, model evaluation, model deployment.
3.2
Business Understanding
A data mining project starts with the understanding of the business problem [26, 29].
In this process, data mining experts, business experts, and domain experts work closely
together to deﬁne the project objectives and the requirements from a business per-
spective. The project objective is then formulated into a data mining problem.
As for the 4G potential users targeting problem, the purpose is to target the
potential users from existing 2G or 3G users. It is because the potential 4G users will
contribute a lot to the growth of the services trafﬁc in the near future. In addition, LTE
network deployment is undergoing rapidly in China, telecom operators are trying to
Data
preparati
on
Data
preparati
on
Model
building
Model
building
Business
understan
ding
Business
understan
ding
Model
training
Model
training
Model
evaluation
Model
evaluation
Model
deploym
ent
Model
deploym
ent
Fig. 3. Overall process of data mining for 4G potential users
102
G. Shao et al.

persuade 2G or 3G users to camp on LTE network to provide more efﬁcient data
services and better user experience, as well as the guaranteed quality of service
(QoS) [2, 21].
3.3
Data Preparation
It is generally known that machine learning algorithms learn from data. The quality of
the training data is vital factor that impacts the model performance. Therefore, it is
critical that ML algorithm has the appropriate data for the problem formulation.
For the data preparation, the ﬁrst step is collecting the data related with the
problem. And then we try to be aware of the details of the data. The next step is to
identify data quality problems such as data missing problem, data transformation etc.
With regarding the problem in this paper, the user basic information, user consumption
information, user service behavior information are needed.
3.4
Model Building
Model building actually is deﬁning the abstract problem in a mathematical way that can
be understood by machine. For a certain problem, you can select and apply various
mining functions because you can use different mining functions for the same type of
data mining problem. For example, Logistic Regression, Decision Tree, Support Vector
Machine can all be used to deal with the classiﬁcation problem [23]. However, different
kinds of algorithm has its own applicable scenario and require speciﬁc data types.
For this paper, apparently this is a problem of classiﬁcation, which aims to dis-
tinguish the potential 4G users from all the telecom subscribers. The two different
groups can be expressed in Eq. (1):
4G potential user ðQiÞ ¼
1;
Qi is 4G potential user
0;
Qi is not 4G potential user
(
ð1Þ
Then the problem of this paper can be showed in the following linear mathematical
model:
y ¼ hTz ¼ h0 þ h1z1 þ h2z2 þ ; . . .; þ hnzn
ð2Þ
where h is the weighting value, z is the feature vector.
3.5
Model Training
The process of model training is to train the model built in previous part by using
training data. After the training process, we can get a ML model that attempts to predict
whether a new user will be a potential 4G user or not.
During the model training process, another import issue can determine the corre-
sponding features. This process is called the feature engineering, which aims to
transform original data into features that make ML algorithm work precisely.
Telecom Big Data Based User Analysis and Application
103

The feature engineering can be divided into several parts. Firstly, select the relevant
variables to the target based on the understanding of the data, as for the topic in this
paper, the user smartphone network type, the user trafﬁc consumption etc. will have
great inﬂuence to the 4G user prediction. Secondly, feature construction and feature
selection. Sometimes, the feature can be obtained directly from the raw data, and for
other times, we have to do some transformation to generate some more powerful
features. Then we can evaluate each feature’s contribution to the accuracy of the model,
the unimportant features will be eliminated. Thirdly, we will check weather this set of
features will work with the model precisely. We will choose the set of features gen-
erated the better prediction result. Lastly, if the prediction result is not ideal, then go
back to the beginning part to create more features until the model result is well. From
the above steps, we can see that the process of feature engineering is an iterative
process.
For model training part in this paper, because this is a classiﬁcation problem, we
will choose the classic LR algorithm [15] to predict the 4G potential users. LR algo-
rithm is a binary classiﬁcation problems predict a binary outcome (one of two possible
classes). LR generates the coefﬁcients of a formula to predict a logit transformation of
the probability of presence of the target of interest.
logitðpÞ ¼ b0 þ b1z1 þ . . . þ bkzk
ð3Þ
where p is the probability of presence of the target of interest and total k independent
features z ¼ ðz1; z2; . . .; zkÞ.
The logit transformation is deﬁned as the logged odds:
odds ¼
p
1  p
ð4Þ
where p can be denoted in the Eq. (5):
PðY ¼ 1 j zÞ ¼
1
1 þ egðzÞ
ð5Þ
where gðzÞ ¼ b0 þ b1z1 þ . . . þ bkzk, b is the regression coefﬁcient [26]. Similarity, we
can deﬁne the probability of absence of the characteristic of interest:
PðY ¼ 0 j zÞ ¼ 1  PðY ¼ 1 j zÞ ¼ 1 
egðzÞ
1 þ egðzÞ ¼
1
1 þ egðzÞ
ð6Þ
Based on Eqs. (5) and (6), the Eq. (4) can be expressed as:
logð
p
1  pÞ ¼ logðegðzÞÞ ¼ gðzÞ ¼ b0 þ b1z1 þ . . . þ bkzk
ð7Þ
104
G. Shao et al.

In Eq. (7), the coefﬁcient b is what we want to learn from the training data. The cost
function can be denoted as:
LðbÞ ¼
Y
Pðyi ¼ 1 j ziÞyið1  Pðyi ¼ 1 j ziÞÞ1yi
ð8Þ
We can get the value of each b coefﬁcient via GD (Gradient Descent) algorithm.
3.6
Model Evaluation
Model evaluation metrics are used to assess goodness of ﬁt between model and data, to
compare different models, and to reveal the accuracy of the model predictions. Actu-
ally, there are many ways to do the model evaluation, such as the Conﬁdence Interval,
Confusion Matrix, Gain and Lift Chart and ROC curve etc. In terms of the classiﬁ-
cation problem in this paper, we introduce Confusion Matrix method to measure the
model’s performance.
A confusion matrix is a N  N matrices. N is the number of classiﬁcations.
A 2  2 confusion matrix for two classes (Positive and Negative) is presented in
Table 2.
From Table 2, we can see that the performance of the classiﬁcation models can be
evaluated using the data in the matrix. T11 is called correct positive prediction, these are
cases in which we predicted yes (they are the potential 4G users), and they are actually
potential 4G users. Similarly, T12 is called incorrect positive prediction, T21 is called
correct negative prediction, T22 is called incorrect negative prediction.
Various measures can be derived from a confusion matrix [26]. The ﬁrst metric is
MAccuracy, calculated by Eq. (9). MAccuracy reﬂects the proportion of the total number of
predictions that were correct.
MAccuracy ¼
T11 þ T22
T11 þ T21 þ T12 þ T22
ð9Þ
The second metric is MPrecision, calculated by Eq. (10). MPrecision reﬂects the pro-
portion of actual positive cases which are correctly identiﬁed.
MPrecision ¼
T11
T11 þ T12
ð10Þ
The third metric is MRecall, calculated by Eq. (11). MRecall reﬂects the proportion of
positive cases that were correctly identiﬁed.
Table 2. Parameters in confusion matrix
Target
Positive Negative
Model Positive
T11
T12
Negative T21
T22
Telecom Big Data Based User Analysis and Application
105

MRecall ¼
T11
T11 þ T21
ð11Þ
Finally, we can get the ideal data model for the targeting for 4G potential users.
3.7
Model Deployment
After the model is validated, telecom operator can apply this model to 4G potential user
classiﬁcation. For each existing 2G or 3G user, this model will present the classiﬁcation
results. A data mining process continues after a solution is deployed. Data mining is an
iterative process, since both the data and services are changing during the process.
3.8
Application Deployment and Results Analysis
This paper applies the proposed data mining algorithm based 4G potential users pre-
diction in the city central area of China (named as A-city). Table 3 and Fig. 4 show the
mining results. There are 1807674 2G mobile users in A-city. Employing our proposed
data mining algorithm, 108000 of 2G users are predicted as 4G potential users. Then,
market department of the telecom operator utilises this potential users list to take
relevant marketing measures/methods to persuade these users transferring from 2G to
4G. Finally, 58423 2G users transfer to 4G successfully. Therefore, the 4G user
conversion rate reaches 54.10% (namely, 58423/108000) under 2G scenario.
Similarly, from Table 3 and Fig. 4, there are 1063955 3G users in A-city. The
proposed data mining algorithm predicts that 335000 3G users are 4G potential users.
After employing marketing measures/methods by the market department of the telecom
operator, 216581 3G users transfer to 4G successfully. Hence, the 4G user conversion
rate reaches 64.65% (namely, 216581/335000) under 3G scenario.
Fig. 4. Number and rate of 4G user conversion
106
G. Shao et al.

Figure 5 shows the 4G potential users distribution in the downtown of A-city. Red
area reﬂects that this area has a large number of 4G potential users. From Fig. 5(a),
most of 2G–to–4G potential users are gathered in the very city center. Since many 3G
users surf on the mobile internet, these users are easily upgrade to 4G users. Compared
to 2G–to–4G potential users, 3G–to–4G potential users have larger distribution, as
shown in Fig. 5(b).
4
Conclusion
This paper investigates on telecom big data based user analysis and application for
telecom operators. Initially, this paper studies the content of telecom big data. Then,
360-degree user portrait is drawn via three types of factors, including user’s infor-
mation, user’s consumption behavior and service behavior. Based on the user portrait,
this paper employs data mining to seek 4G potential users. The data mining process
includes the business understand, data preparation, model building, model train, model
evaluation and model deployment steps. Overall, effectively targeting 4G potential
users can beneﬁt telecom operators.
Table 3. Application scenario and results
Network
type
4G User conversion rate
Total
user
4G Potential user
prediction
4G Conversion
user
Conversion
rate
2G
1807674
108000
58423
54.10%
3G
1063955
335000
216581
64.65%
Fig. 5. Distribution of 4G potential users
Telecom Big Data Based User Analysis and Application
107

References
1. Cao, Y., Wang, N., Sun, Z., Cruickshank, H.: A reliable and efﬁcient encounter-based
routing framework for delay/disruption tolerant networks. IEEE Sens. J. 15(7), 4004–4018
(2015)
2. Xu, L., Luan, Y., Cheng, X., Cao, X., Chao, K., Gao, J., Jia, Y., Wang, S.: WCDMA Data
based LTE Site Selection Scheme in LTE Deployment. In: International Conference on
Signal and Information Processing, Networking and Computers, pp. 249–260. CRC Press,
Taylor & Francis Group, Beijing (2015)
3. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.M.: Cooperative interference
mitigation and handover management for heterogeneous cloud small cell networks. IEEE
Wirel. Commun. 22(3), 92–99 (2015)
4. Xu, L., Chen, Y., Chai, K.K., Schormans, J., Cuthbert, L.: Self-organising cluster-based
cooperative load balancing in OFDMA cellular networks. Wiley Wireless Commun. Mob.
Comput. 15(7), 1171–1187 (2015)
5. Zhao, L., Al-Dubai, A.Y., Li, X., Chen, G.: A new efﬁcient cross-layer relay node selection
model for wireless community mesh networks. Comput. Electr. Eng. 61, 361–372 (2017).
https://doi.org/10.1016/j.compeleceng.2016.12.031
6. Cao, Y., Sun, Z., Wang, N., Riaz, M., Cruickshank, H., Liu, X.: Geographic-based
Spray-and-Relay (GSaR): an efﬁcient routing scheme for DTNs. IEEE Trans. Veh. Technol.
64(4), 1548–1564 (2015)
7. Xu, L., Chen, Y., Gao, Y., Cuthbert, L.: A Self-Optimizing Load Balancing Scheme for
Fixed Relay Cellular Networks. In: IET International Conference on Communication
Technology and Application, pp. 306–311. IET Press, Beijing (2011)
8. Wang, W., Xu, L., Zhang, Y., Zhong, J.: A novel cell-level resource allocation scheme for
OFDMA system. In: International Conference on Communications and Mobile Computing,
pp. 287–292. IET Press, Kunming (2009)
9. Zhao, L., Li, Y., Meng, C., Gong, C., Tang, X.: A SVM based routing scheme in
VANETs. In: IEEE International Symposium on Communications and Information Tech-
nologies, pp. 380–383. IEEE Press, Qingdao (2016)
10. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
11. Deng, Y., Wang, L., Zaidi, S.A.R., Yuan, J., Elkashlan, M.: Artiﬁcial-noise aided secure
transmission in large scale spectrum sharing networks. IEEE Trans. Commun. 64(5), 2116–
2129 (2016)
12. Xu, L., Cheng, X., Liu, Y., Chen, W., Luan, Y., Chao, K., Yuan, M., Xu, B.: Mobility load
balancing aware radio resource allocation scheme for LTE-Advanced cellular networks. In:
IEEE International Conference on Communication Technology, pp. 806–812, IEEE Press,
Hangzhou (2015)
13. Xu, L., Chen, Y., Chai, K. K., Luan, Y., Liu, D.: Cooperative mobility load balancing in
relay cellular networks. In: IEEE International Conference on Communication in China,
pp. 141–146. IEEE Press, Xi’An (2013)
14. 3GPP TR 36.814: Further Advancements for E-UTRA Physical Layer Aspects (2010)
15. Zhang, T., Cheng, X., Yuan, M., Xu, L., Cheng, C., Chao, K.: Mining target users for mobile
advertising based on telecom big data. In: IEEE International Symposium on Communi-
cations and Information Technologies, pp. 296–301. IEEE Press, Qingdao (2016)
16. Landset, S., Khoshgoftaar, T.M., Richter, A.N., Hasanin, T.: A survey of open source tools
for machine learning with big data in the Hadoop Ecosystem. J. Big Data 2(1), 24 (2015)
108
G. Shao et al.

17. Cheng, C., Cheng, X., Yuan, M., Song, C., Xu, L., Ye, H., Zhang, T.: A novel cluster
algorithm for telecom customer segmentation. In: IEEE International Symposium on
Communications and Information Technologies, pp. 324–329. IEEE Press, Qingdao (2016)
18. Liu, Y., Xu, L., Chen, Y., Fan, Y., Xu, B., Nie, J.: A novel power control mechanism based
on interference estimation in LTE cellular networks. In: IEEE International Symposium on
Communications and Information Technologies, pp. 397–401. IEEE Press, Qingdao (2016)
19. Xing, H., Xu, L., Qu, R., Qu, Z.: A quantum inspired evolutionary algorithm for dynamic
multicast routing with network coding. In: IEEE International Symposium on Communi-
cations and Information Technologies, pp. 186–190. IEEE Press, Qingdao (2016)
20. Cao, Y., Wang, N., Kamel, G., Kim, Y.J.: An electric vehicle charging management scheme
based on publish/subscribe communication framework. IEEE Syst. J. 11(3), 1822–1835
(2015). https://doi.org/10.1109/JSYST.2015.2449893
21. Xu, L., Luan, Y., Cheng, X., Fan, Y., Zhang, H., Wang, W., He, A.: Telecom big data based
user ofﬂoading self-optimisation in heterogeneous relay cellular systems. Int. J. Distrib. Syst.
Technol. 8(2), 27–46 (2017)
22. Xu, L., Chen, Y., Chai, K.K., Liu, D., Yang, S., Schormans, J.: User relay assisted trafﬁc
shifting in LTE-Advanced systems. In: IEEE Vehicular Technology Conference, pp. 1–7.
IEEE Press, Dresden (2013)
23. Cheng, X., Xu, L., Zhang, T., Jia, Y., Yuan, M., Chao, K.: A novel big data based telecom
operation architecture. In: International Conference on Signal and Information Processing,
Networking and Computers, pp. 385–396. CRC Press Taylor & Francis Group, Beijing
(2015)
24. Xu, L., Luan, Y., Cheng, X., Xing, H., Liu, Y., Jiang, X., Chen, W., Chao, K.:
Self-optimised joint trafﬁc ofﬂoading in heterogeneous cellular networks. In: IEEE
International Symposium on Communications and Information Technologies, pp. 263–
267. IEEE Press, Qingdao (2016)
25. Cao, Y., Wang, N., Kamel, G.: A publish/subscribe communication framework for
managing electric vehicle charging. In: IEEE International Conference on Connected
Vehicles and Expo, pp. 318–324. IEEE Press, Vienna (2014)
26. Cheng, X., Yuan, M., Xu, L., Zhang, T., Jia, Y., Cheng, C., Chen, W.: Big data assisted
customer analysis and advertising architecture for real estate. In: IEEE International
Symposium on Communications and Information Technologies, pp. 312–317. IEEE Press,
Qingdao (2016)
27. Cui, G., Lu, S., Wang, W., Zhang, Y., Wang, C., Li, X.: Uplink coordinated scheduling
based on resource sorting. In: IEEE Vehicular Technology Conference, pp. 1–5. IEEE Press,
Quebec (2012)
28. Cui, G., Lu S., Wang, W., Wang, C., Zhang, Y.: Decentralized antenna selection with no
CSI sharing for multi-cell MU-MIMO systems. In: IEEE International Symposium on
Personal and Indoor, Mobile Radio Communications, pp. 2319–2323. IEEE Press, Sydney
(2012)
29. Xie, L., Pan, D.: On customer segmentation and retention of telecom broadband in Pearl
River Delta. Chinese Control Conference, pp. 5564–5568 (2010)
Telecom Big Data Based User Analysis and Application
109

Coverage Optimization in Self-organizing
Small Cells
Yu Chen1(B), Wei Li2, Xiuqing Yang1, Yi Hu1, and Qinghua Zhu1
1 School of Telecommunication Engineering,
Beijing Polytechnic, Beijing 100176, China
buptchen@163.com
2 The State Radio Monitoring Center, Beijing 100037, China
Abstract. Heterogeneous two-tier network with hybrid deployed small
cells and macrocells is a promising solution for ﬁfth generation (5G)
wireless networks. However, with the higher and higher spectrum band
used in 5G, the coverage and capacity of indoor environment is not good
enough for the users’ increasing demand. In this paper, we proposed a
self-organizing capacity and coverage optimization scheme using power
adaptation to enhance the capacity and improve the coverage. Simula-
tion results show that the proposed self-organizing scheme can eﬀectively
improve the capacity and coverage.
Keywords: Small cells · Coverage optimization
Capacity optimization · Self-organizing network
1
Introduction
In recent years, the mobile data usage has grown by 70–200% per annum. More
worryingly, the bursty nature of wireless data traﬃc makes traditional network
planning for capacity obsolete. Currently, heterogeneous small cell network with
overlay femtocells and macrocell is a most promising solution for the wireless cel-
lular communications of the future [1]. The use of femtocell, which is considered
a promising technique, can provide an eﬀective solution to tackle the challenges
in this respect [2,3]. In heterogeneous small cell network, low power small cells
(such as picocell, relay and femtocell) together with macrocells, can improve the
coverage and capacity of cell-edge users and hotspot by exploiting the spatial
reuse of spectrum [2]. Small cells can also oﬄoad the explosive growth of wireless
data traﬃc from macrocells [3–5]. For example, in an indoor environment WiFi
and femtocells can oﬄoad most of the data traﬃc from macrocells [5–7]. For
mobile operators, small cells such as femtocells can reduce the capital expendi-
ture (CAPEX) and operating expenditure (OPEX) because of the self-installing
and self-operating features of femto basestations [7,8]. The femtocell combined
with cognitive radio can further improve the system performance [9,10]. Resource
allocation of small cells was studied in [9,10]. The authors addressed many criti-
cal issues on femtocells, such as interference mitigation, spectrum access, resource
allocation, and quality-of-service (QoS) provisioning [11–13].
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 110–119, 2018.
https://doi.org/10.1007/978-3-319-72823-0_12

Coverage Optimization in Self-organizing Small Cells
111
In the Long Term Evolution (LTE) system, with the demand of home eNB
(HeNB) deployment within the residual area, the interference between macro
eNB and HeNB becomes major obstacle for operators to deploy HeNB. Figure 1
illustrates a result we simulate the coverage of Macro and home eNB with unsuit-
able transmit power [7]. In this ﬁgure, the red zone is covered by Macro eNB
and the green zone is covered by HeNB. We can see there are three apartments
which are supposed to be covered by Macro eNB covered by a neighbor HeNB
in zone 1. As a result, the UE is in the three apartments can’t work normally
because they aren’t the members of the closed subscriber group (CSG) HeNB
and can’t connect to Macro eNB neither. On the other hand, in zone 2 we can see
that HeNB can’t cover the whole apartment and that means the end-user who
buys HeNB can’t get the advantage from HeNB. From the above description, we
can summary the main issues of HeNB from the coverage aspect as following:
– If transmit power of HeNB is large, non-CSG UEs which is supposed to con-
nect to MeNB will be aﬀected.
– If transmit power of HeNB is small, some place can’t be covered by HeNB
and CSG UEs will be aﬀected.
The number of HeNB involved in a wide-scale deployment will be orders
of magnitude more than the numbers commonly associated with cells used in
macro eNB deployments. With such large numbers, the conventional manual
approach to cell-planning and deployment of base stations would not be feasi-
ble due to the resulting prohibitively high costs. HeNBs therefore have to be
deployed by the end-users themselves, and the HeNB must be able to auto-
conﬁgure all the required parameters and self-optimize them during operation
with minimal human intervention. In this paper, a detail coverage and capacity
optimization (CNC) solution will be proposed which includes the self conﬁgura-
tion and the self optimization. Both of two parts will adjust the transmit power
to optimize the coverage of HeNB in the diﬀerent stage of HeNB running.
Fig. 1. Coverage overview in dense-urban scenario.

112
Y. Chen et al.
2
Detailed Algorithm
2.1
Self Conﬁguration
After power on, HeNB can detect the wireless environment with a downlink
receiver. HeNB can get the RSRP of Macro eNB and its neighbor HeNBs from
this detection. Self conﬁguration process will use the detection result to conﬁgure
a suitable transmit power for the HeNB.
– HeNB has a small coverage area and the boundary is deﬁned as the place that
is x2 dB away from HeNB.
– A close-by MUE or HUE has similar RSRP as the detection of HeNB.
– The SINR of a HUE received from the HeNB is more than x3 dB means HUE
is covered by a HeNB.
– The SINR of a MUE received from the Macro eNB is more than x1 dB means
MUE is covered by a Macro eNB.
With the above assumption, the basic concept of algorithm in self conﬁguration
process can be described as following:
– Maintain an SINR is less than x3 dB for a HUE located more than X2 dB
away from HeNB
– Maintain an SINR is more than x1 dB for a MUE located more than x2 dB
away from HeNB
Figure 2 illustrates how to determine the transmit power of a HeNB [7]. The
left ﬁgure shows the suitable transmit power of HeNB is supposed to guarantee
the HUE is on the boundary has a SINR that is less than x3 dB, thus the HeNB
can’t aﬀect the MUE. The right ﬁgure shows the suitable transmit power of
HeNB is supposed to guarantee the MUE which is on the boundary has a SINR
that is more than x1 dB.
Here is the detail algorithm.
Figure 3 is the ﬂowchart about self conﬁguration process.
Fig. 2. How to determine the transmit power of a HeNB.

Coverage Optimization in Self-organizing Small Cells
113
Algorithm 1. Accumulated-PayoﬀBased Snowdrift Game
1: Input The RSRP of Macro eNB and the neighbor HeNB detected by the considered
HeNB Process:
2: Calculate the RSRP of a HUE which is on the boundary from HeNB: TxPHeNB1−
x2
3: Calculate the interference of the HUE from the Macro eNB and the neighbor
HeNB
N2

i=1
10RxPi/10
Where: N2is the number of the Macro eNB and the all neighbor HeNB RxPiis the
RSRP of the i-th Macro eNB or HeNB. The unit is dBm
4: Calculate the SINR of the HUE (TxPHeNB1−x2)−10∗log10(
N2

i=1
10RxPi/10+noise)
Where: is the basic noise and its unit is mW.
5: Guarantee this SINR is less than x3 dB
(TxPHeNB1 −x2) −10 ∗log10(
N2

i=1
10RxPi/10 + noise) < x3
(1)
.
6: Calculate the RSRP of a MUE which is on the boundary from Macro eNB:
RxPMeNB
Where: the unit of RxPMeNB is dBm.
7: Calculate the interference of the MUE from the HeNB 10(T xPHeNB2−x2)/10
Where: the unit of TxPHeNB2 is dBm
8: Calculate the interference of the MUE from the Macro eNB and the neighbor
HeNB
N1

i=1
10RxPi/10
Where: N1 is the number of the Macro eNB and the all HeNB except the considered
HeNB RxPi is the RSRP of the i-th Macro eNB or HeNB. The unit is dBm
9: Calculate the SINR of the MUE RxPMeNB −10 ∗log 10(10(T xPHeNB2−x2)/10 +
N1

i=1
10RxPi/10 + noise)
10: Guarantee
this
SINR
is
more
than
x1
dB
RxPMeNB
−
10
∗
log 10(10(T xPHeNB2−x2)/10 +
N1

i=1
10RxPi/10 + noise) > x1
11: Get the minimum of these two TxP TxpHeNB = min(TxpHeNB1, TxpHeNB2)
12: Output: TxpHeNB
2.2
Self Optimization
Boundary Algorithm. In the self conﬁguration process, the boundary is ﬁxed,
actually in real environment, the size of an apartment or a house is various, we
are supposed to get the real boundary of every HeNB coverage area. In the self
conﬁguration process, SON system can’t get any information but the RSRP of
Macro eNB and neighbor HeNBs. According to the detection we can’t determine
the exactly boundary. In the self optimization process, there are HUEs work in
the coverage area of HeNB, we can use the measurement of HUE to determine
the boundary. Since when HUE enter an apartment, its RSRP from HeNB will

114
Y. Chen et al.
have a big change because of the penetration loss of wall, we can use the path-
loss form HeNB as the radius of the HeNB coverage. Although according to the
position of a HeNB, this kind of radius isn’t an concise value, i.e. when HeNB is
near to the window (left in Fig. 4), or in the corner (right in Fig. 4). But when
the HeNB is in the central of apartment (in Fig. 5), the boundary is suitable.
And we know that this kind of boundary depends on the real size of apartment
or house, it’s better than a ﬁxed boundary, also, we can optimize the transmit
power in next optimization process.
About this adaptive boundary, there is another thing to be considered. The
measurement report will be sent to eNB only when A3 event occur. However,
when UE enter or go out the door, A3 event doesn’t occur always. So, we need
a new trigger for it. Here we deﬁne a threshold Thresboundary, and a event BT
that the change of RSRP from HeNB between successive two measurements is
more than Thresboundary. Once BT occurs, the measurement the bigger RSRP
is in will be sent to HeNB. For boundary determination, a measurement period
T is needed, boundary is supposed to be determined in two successive T. once
occurs, HeNB will determine the boundary with the RSRP reported by UE from
the this event BT . The ﬁxed boundary will be the initial value of the bound-
ary. If SON server gets a boundary from HeNB, use it in the self optimization
process, if not, use the initial value, namely, the ﬁxed boundary. Figure 6 is the
relationship between boundary process and the self optimization process. Before
t0, there is no boundary is calculated, self optimization process will use the ﬁxed
boundary; when BT occurs at time 3T, SON server will calculate a boundary
Fig. 3. Self conﬁguration ﬂowchart.

Coverage Optimization in Self-organizing Small Cells
115
Fig. 4. Unsuitable position of HeNB.
with two successive measured RSRP, hence when t0 comes, the boundary has
been calculated, self optimization can use the new boundary.
Here is the algorithm.
Simulation Plan
– Run simulation in every position in Fig. 5.
– Run simulation with same penetration loss of outdoor wall and separating
wall, the penetration loss can be 10 and 20 dB.
– Compare the performance of our CNC solution and other similar CNC
solution.
Fig. 5. Suitable position of HeNB.

116
Y. Chen et al.
Algorithm 2. Boundary Algorithm
1: Input The RSRP measured by HUE.
2: In T time, get the average RSRP, and regard it as RSRPi, in next T time, get the
average RSRP, and regard it as RSRPi+1. If the change between this measurement
RSRPi+1and the previous measurement RSRPi isn’t more than the Thresboundary,
do nothing; if crosses it, record the bigger RSRP. |RSRPi −RSRPi+1|
>
Thresboundary RSRPboundary = max(RSRPi, RSRPi+1) Where: RSRPi is the
averaged RSRP of HUE in ith T time period RSRPboundary is the RSRP used
to calculate house boundary
3: Get the RSRPboundary and report the RSRPboundary to HeNB. If there is no
RSRPboundary can be got, doesn’t report anything to HeNB.
4: When HeNB get the report from HUE, it will calculate the boundary with its
transmit power and sends the path-loss to SON server. HeNB will save the bound-
ary for further self optimization. If SON server doesn’t receive any boundary,
use the ﬁxed boundary and enter the next T time to get a suitable boundary.
boundary = TxPHeNB −RSRPaverage
If don’t get a boundary: boundary = boundaryfixed Where: the unit of boundary
is dB
5: Output: Output: boundary
2.3
Shadowing Fading Model
Log-normal shadowing will be applied in our simulation. The standard deviation
for HeNB is assumed to be 10 dB, for Macro eNB, it is assumed to be 8 dB. The
auto-correlation distance for Macro eNB is assumed to be 50 m and for HeNB,
it is 3 m.
Fig. 6. The relationship between boundary process and the self optimization process.

Coverage Optimization in Self-organizing Small Cells
117
3
Simulation Result
3.1
Coverage and Capacity
In this simulation, the blocks will be put into Position 1, Position 2 and Position 3
and get the coverage ratios of Macro eNB and HeNB. When simulator running,
the penetration loss of wall will be set to 10 dB or 20 dB. But in each simulation,
the penetration loss is a ﬁxed value.
Simulation Results in Position 1. The optimized coverage ratio value of
macro eNB and HeNB and comparisons with coverage ratio value of macro eNB
and HeNB with ﬁxed power of HeNB when penetration loss = 10 dB is shown
in the following table and ﬁgure (Table 1).
The distribution of optimized transmitted power of HeNB is shown in the
following ﬁgure where Y axis is the number of HeNB with the same optimized
transmitted power and the X axis is the transmitted power of each HeNB. The
average transmit power is −16.66 dBm.
Fig. 7. Boundary ﬂowchart.

118
Y. Chen et al.
Table 1. Parameters assumption.
Optimized
20 dBm
0 dBm
−10 dBm
−20 dBm
Position1
10 dB
MeNB coverage ratio
90.99%
20.17%
59.72%
83.66%
96.34%
HeNB coverage ratio
75.63%
95.76%
94.90%
90.18%
74.06%
20 dB
MeNB coverage ratio
90.05%
35.23%
72.12%
84.23%
92.59%
HeNB coverage ratio
91.88%
96.44%
96.17%
95.17%
91.52%
Position2
10 dB
MeNB coverage ratio
89.70%
15.47%
48.95%
74.46%
91.50%
HeNB coverage ratio
82.27%
95.86%
95.69%
92.92%
81.69%
20 dB
MeNB coverage ratio
87.33%
28.09%
65.88%
80.59%
89.46%
HeNB coverage ratio
93.37%
95.96%
95.97%
95.52%
92.81%
Position3
10 dB
MeNB coverage ratio
90.22%
16.97%
53.80%
78.10%
93.36%
HeNB coverage ratio
91.56%
96.20%
95.73%
93.04%
82.77%
20 dB
MeNB coverage ratio
89.94%
31.85%
67.86%
81.56%
91.78%
HeNB coverage ratio
93.22%
96.32%
96.26%
95.66%
93.09%
Fig. 8. The position of HeNB blocks
Fig. 9. Comparisons of coverage ratio of macro eNB and HeNB with optimized and
ﬁxed power of HeNB.

Coverage Optimization in Self-organizing Small Cells
119
4
Conclusion
Our optimized target is that, ﬁrst, the coverage ratio of macro eNB is more than
required coverage ratio, then, maximize the coverage ratio of HeNB. The following
table gives the summary results for CNC. From the table list above, We can see
that the optimized coverage ratio of macro eNB is very near the required coverage
ratio of macro eNB 90%. The optimized coverage ratio of HeNB is very big than
that of the most ﬁxed transmitted power when macro eNB meets coverage target.
From the above results, we can see that the optimized coverage ratio is similar to
that of −20 dBM, this is because the HeNB in our simulation conditions is still
densely deployed, so the inter-interference among HeNB is high, as a result, the
transmitted power of HeNB after optimization shall not be high, if the HeNB is
sparse deployed, the optimized power of HeNB shall be higher than −20 dBM.
References
1. Zhang, H., Chu, X., Wen, X.: 4G Femtocells: Resource Allocation and Inter-
ference Management. Springer, New York (2013). https://doi.org/10.1007/978-1-
4614-9080-7
2. Claussen, H., Ho, L.T.W., Samuel, L.G.: Self-optimization of coverage for femtocell
deployments. In: Wireless Telecommunications Symposium, 2008, WTS 2008, pp.
278–285. IEEE (2008)
3. Zhang, H., Jiang, C., Cheng, J., Leung, V.C.M.: Cooperative interference mitiga-
tion and handover management for heterogeneous cloud small cell networks. IEEE
Wirel. Commun. 22(3), 92–99 (2015)
4. Peng, M., Liang, D., Wei, Y., et al.: Self-conﬁguration and self-optimization in
LTE-advanced heterogeneous networks. IEEE Commun. Mag. 51(5), 36–45 (2013)
5. Zhang, H., Chu, X., Guo, W., Wang, S.: Coexistence of wi-ﬁand heterogeneous
small cell networks sharing unlicensed spectrum. IEEE Commun. Mag. 53(3), 158–
164 (2015)
6. Bennis, M., Perlaza, S.M., Blasco, P., et al.: Self-organization in small cell networks:
a reinforcement learning approach. IEEE Trans. Wirel. Commun. 12(7), 3202–3212
(2013)
7. Zhang, H., Jiang, C., Hu, Q., Qian, Y.: Self-organization in disaster resilient het-
erogeneous small cell networks. IEEE Netw. 30(2), 116–121 (2015)
8. Fehske, A.J., Viering, I., Voigt, J., et al.: Small-cell self-organizing wireless net-
works. Proc. IEEE 102(3), 334–350 (2014)
9. Zhang, H., Jiang, C., Beaulieu, N., Chu, X., Wen, X., Tao, M.: Resource allocation
in spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE Trans.
Commun. 62(7), 2366–2377 (2014)
10. Bennis, M., Simsek, M., Czylwik, A., et al.: When cellular meets WiFi in wireless
small cell networks. IEEE Commun. Mag. 51(6), 44–50 (2013)
11. Zhang, H., Jiang, C., Mao, X., Chen, H.: Interference-limited resource optimization
in cognitive femtocells with fairness and imperfect spectrum sensing. IEEE Trans.
Veh. Technol. 65(3), 1761–1771 (2015)
12. Mhiri, F., Sethom, K., Bouallegue, R.: A survey on interference management tech-
niques in femtocell self-organizing networks. J. Netw. Comput. Appl. 36(1), 58–65
(2013)
13. Chen, C.S., Baccelli, F., Roullet, L.: Joint optimization of radio resources in small
and macro cell networks. In: IEEE 73rd Vehicular Technology Conference, VTC
Spring, 2011, pp. 1–5. IEEE (2011)

Expectation Maximization for Multipath
Detection in Wideband Signals
Salem Salem1 and Mohamed El-Tarhuni2(&)
1 Phoenicia University, Beirut, Lebanon
2 American University of Sharjah, Sharjah, UAE
mtarhuni@aus.edu
Abstract. In this paper, a new technique for delay estimation of multipath
components in wideband communication systems is proposed. The proposed
scheme uses the Expectation Maximization algorithm at the output of an energy
detector in order to separate the multipath components from the noise compo-
nents. The proposed scheme provides comparable performance to the conven-
tional scheme based on maximum energy detector in terms of detection
probability. However, it has two major advantages over the conventional
scheme that make it more attractive in practical applications. Firstly, the pro-
posed scheme does not require prior knowledge of the number of multipath
components; and, secondly, it does not need to use a threshold to decide on the
presence or absence of multipath components.
Keywords: Expectation Maximization  Delay estimation  Wideband signals
1
Introduction
Wideband digital communication over wireless channels has been a very important topic
over the past several years. This continues to motivate the development of mobile radio
systems that could support high rate applications with tens of Mbps speed through
wideband transmission. Furthermore, ultra wideband (UWB) systems are of great
interest for achieving even higher data rates and accurate localization applications [1].
However, as a consequence of using wideband signals, multipath propagation is the
main characteristic of the wireless channel. The deployed systems need to not only
mitigate the interference caused by multipath but also to exploit the diversity available in
the multiple received copies of the transmitted signal. Hence, for such communication
systems to operate properly, it is very crucial to device effective schemes for detecting
multipath components. Another reason to detect multipath components is to improve the
performance of location ﬁnding systems such as the Global Positioning Systems
(GPS) and Global Navigation Satellite Systems (GNSS) [2–4].
There have been many techniques for delay estimation based on correlation and
matched ﬁltering for wideband systems using spread spectrum transmission [5–7]. All
these schemes utilize the pseudo random (PN) code used in generating the spread
spectrum signal to search for the multipath delays over a search window of a range of
possible delays. The search window is typically searched at a discrete step that is a
fraction of the PN code chip duration to produce a set of correlation results. These results
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 120–131, 2018.
https://doi.org/10.1007/978-3-319-72823-0_13

are typically compared to a preset threshold to decide on how many multipath com-
ponents are present and what their delays are.
In [8], multipath detection was done for a receiver with soft handover conditions
with either full scanning or sequential scanning of all available multipath components
is performed. The proposed scheme used the combined signal-to-noise ratio (SNR) to
decide on the selection of the multipath components. Multipath detection based on per
path signal-to-noise and interference was introduced in [9]. The authors extended their
work to a system with space-time spreading in [10] and interference cancellation. In
[11], selection of multipath components for a generalized rake (G-Rake) received based
on a maximal weight criterion to maximize the signal energy and minimize interference
was presented.
As indicated earlier, one of the most important reasons for multipath detection is to
improve the accuracy of positioning systems. Multipath results in ranging errors that
could lead to signiﬁcant error in estimating the location. Most of the techniques pre-
sented in the literature were devised to mitigate the impact of multipath by compen-
sating for the presence of multipath or eliminating the multipath after been detected
[12–14]. Other techniques were recently introduced to mitigate multipath delays that
are closely spaced to within a fraction of a chip [15, 16].
One of the difﬁcult tasks in implementing an effective multipath detection scheme
is the selection of the threshold to decide if a multipath component exists at a particular
delay or not. The threshold is usually set to maximize the probability of correctly
detecting the presence of the multipath component (detection probability) while min-
imizing or ﬁxing the probability of deciding that a multipath component exists at a
particular delay while no signal was present (called false alarm probability). The
challenge comes from the fact that the threshold needs to be continuously optimized to
maintain the desired performance due to the variation in the wireless channel. Fur-
thermore, a major drawback of most existing multipath detection schemes is that they
assume the number of multipath components in the received signal is known to the
receiver apriori and they just need to estimate the delays for these components. This
assumption is not realistic since the number of multipath components is actually a
random value that depends on the physical objects surrounding the transmitter and
receiver and how the transmitted wave is affected by these objects. This is further
complicated because, in a mobile radio system, the physical objects vary as the
transmitter, receiver, or both move during the data transmission leading to variation in
the number of multipath components and their delays. These variations are especially
signiﬁcant for fast moving terminals.
In this paper, we develop a multipath detection scheme that overcomes both of the
above issues. Namely, the proposed scheme does not use a threshold at all so there is
no issue with setting the threshold value and optimizing it over time. Furthermore, the
proposed scheme detects all multipath components without assuming prior knowledge
of how many paths exist in the received signal. The proposed scheme works by
modeling the multipath detection problem as a mixture model generated from two
independent and unknown distributions; one for the noise and one for the signal. Then,
each correlation result obtained from a conventional search algorithm is classiﬁed to
belong to either the noise or signal distribution using the Expectation Maximization
(EM) algorithm.
Expectation Maximization for Multipath Detection in Wideband Signals
121

2
System Model
Let us consider a wideband signal generated using a PN code of length N and trans-
mitted over a frequency-selective Rayleigh fading channel with L paths each with delay
sl 2 f0; 1; 2; . . .; N  1g. We assume L to be a random integer value to be estimated by
the receiver as well as to estimate the delays corresponding to these paths. The
equivalent baseband transmitted signal from the mth user can be written as
sm tð Þ ¼
ﬃﬃﬃﬃﬃﬃ
Pm
p
X
i
dðmÞ
i
X
N1
k¼0
cm½kpðt  iTb  kTcÞ;
ð1Þ
where Pm is the transmitted power,
d m
ð Þ
i
2 1
n
o
is the ith information bit,
cm k½  2 1
f
g is the PN code of the desired user, N is the PN code length which is the
same as the number of chips pet bit, i.e. N ¼ Tb=Tc, Tb is the bit duration, Tc is the chip
duration, and p tð Þ is the chip pulse shape.
The signal goes through a mobile radio channel and the received signal in presence
of multiuser interference is written as
r tð Þ ¼
X
M
m¼1
X
L
l¼1
a m
ð Þ
l
tð Þsm t  sml
ð
Þ þ w tð Þ;
ð2Þ
where a m
ð Þ
l
tð Þ and sml are the channel gain and path delay for the lth path of the mth user,
respectively, M is the number of users, and w tð Þ is an additive Gaussian noise (AWGN)
with zero mean and two-sided power spectral density N0=2. The received base-band
signal is sampled at a multiple of the chip rate such that there are Ns samples per chip.
To ﬁnd the delays of these multipath components, the received signal is correlated
with different versions of the PN code each shifted with a speciﬁc delay offset within a
search window of ND offsets. The smallest shift between the different PN codes is
called the step size, D, which is typically equal to 1-chip period or 1/2-chip. The
correlation is done over a long period of time to ensure that enough signal energy is
collected before making a decision. This period is typically the same as the PN code
duration for short codes or could be a fraction of the PN code duration for long codes.
Without loss of generality, we assume that the ﬁrst user is the desired user and a step
size of 1-chip is used, the correlation for every possible offset within the search window
is calculated as:
hnðvÞ ¼ 1
N
X
n þ N
k¼n
r½kc1½k þ v ¼ f1nðvÞ þ fInðvÞ þ fwnðvÞ;
ð3Þ
where n ¼ 0; 1; 2; . . .; and v ¼ 0; 1; 2; . . .; ND  1. The term f1n v
ð Þ depends on the
autocorrelation
function
of
the
desired
user,
while
fIn v
ð Þ
depends
on
the
122
S. Salem and M. El-Tarhuni

cross-correlation function between the desired user and the other users. Finally, fwn v
ð Þ
represents the AWGN contribution. The ﬁrst term in (3) can be represented as:
f1n v
ð Þ ¼
ﬃﬃﬃﬃﬃ
Eb
p
a 1
ð Þ
l
n
ð Þ
v ¼ s1l
0
otherwise

;
ð4Þ
where Eb ¼ TbP1 is the energy per bit for the ﬁrst user and a 1
ð Þ
l
n
ð Þ is the channel
coefﬁcient for the ﬁrst user during the nth bit duration. When a large number of users
exist in the system, the second term in (3) can be represented by a Gaussian process
with zero-mean and variance r2
I .
The receiver non-coherently combines the correlation results for the same offset
over multiple bits to obtain the energy estimates at every offset as
x v
ð Þ ¼ 1
Na
X
Na
i¼1
hi v
ð Þ
j
j2:
ð5Þ
In a conventional multipath detection algorithm, the set of energy estimates {x(v)}
is compared to a preset threshold and the values that exceed this threshold indicate a
presence of a multipath component at that delay offset. Optimization of this threshold is
considered as a difﬁcult task for the conventional algorithm. Another option is to
choose the offsets with L largest energy values as the multipath components. This
assumes that the detector knows in advance that there are L paths in the received signal.
Such assumption is not realistic since the number of paths depends on the channel
conditions and varies in a non-deterministic way with time.
Our proposed scheme for multipath detection is presented in the next section to
overcome both restrictions of the conventional scheme. The proposed scheme uses the
energy estimates in (5) to ﬁnd the maximum likelihood estimates of the delay offsets
based on an iterative Expectation Maximization (EM) algorithm.
3
Expectation Maximization
Suppose a mixture model is composed from K independent, unknown probability
distributions. Let P ¼ pkjk ¼ 1. . .K
f
g be a set of prior probabilities of each kth dis-
tribution, where
X
K
k¼1
pk ¼ 1;
ð6Þ
Let / ¼ f/kjk ¼ 1. . .Kg be a set of parameters that deﬁne the K distributions,
where each kth distribution is deﬁned by its parameters /k. Given a set of ND observed
data points X ¼ fxvjv ¼ 1. . .NDg drawn from this mixture model, what are the
parameters / and prior probabilities P that most likely generated X?
Expectation Maximization for Multipath Detection in Wideband Signals
123

The probability of a data point xv is
p xvj/
ð
Þ ¼
X
K
k¼1
p xvj/k
ð
Þpk;
ð7Þ
therefore the log-likelihood of the mixture model is
‘ /
ð Þ ¼
X
ND1
v¼0
log
X
K
k¼1
p xvj/k
ð
Þpk
 
!
:
ð8Þ
The parameters / and prior probabilities P can be estimated by maximizing (8).
This is achieved by taking the derivative of (8) with respect to / and P then setting it to
zero. For simple models, a solution could be achieved as an explicit function of X.
However, for models that are more complex a numerical solution is achieved through
optimization methods, such as the Expectation Maximization algorithm [17]. The EM
algorithm is a numerical method for maximizing (8) by iteratively estimating the
mixture model parameters and the prior probabilities. The EM algorithm starts with an
initial set of mixture model parameters /. After that, it iterates between the two
following steps:
1. Expectation step: Maximize (8) with respect to prior probabilities P, subject to
constraints in (6). For this one may use Lagrange multipliers [18]
L /
ð Þ ¼
X
ND1
v¼0
log
X
K
k¼1
p xvj/k
ð
Þpk
 
!
 k
X
K
k¼1
pk  1
 
!
:
ð9Þ
Taking the derivative of (9) with respect to p k
ð Þ and equating to zero we get
Dp k
ð ÞL /
ð Þ ¼
X
ND1
v¼0
p xvj/k
ð
Þ
PK
k¼1 p xvj/k
ð
Þpk
 k ¼ 0:
ð10Þ
After some manipulation, we get
p new
ð
Þ
k
¼ NK
ND
;
ð11Þ
where
Nk ¼
X
ND1
v¼0
pkp xvj/k
ð
Þ
PK
k¼1 pkp xvj/k
ð
Þ
¼
X
ND1
v¼0
wvk;
ð12Þ
124
S. Salem and M. El-Tarhuni

where we deﬁne wvk as
wvk ¼
pkp xvj/k
ð
Þ
PK
k¼1 pkp xvj/k
ð
Þ
:
ð13Þ
2. Maximization step: Maximize (8) with respect to mixture model parameters / by
taking the derivative with respect to all model parameters, equating to zero, and
ﬁnding a solution set.
D/‘ /
ð Þ ¼
X
ND1
v¼0
pkD/p xvj/k
ð
Þ
PK
k¼1 pkp xvj/k
ð
Þ
¼ 0;
ð14Þ
where the outcome of (14) is dependent on the probability distribution assumption.
The above two steps are repeated until the value of the log-likelihood function (8)
ceases to change. In the next section we discuss the problem of multipath detection
from the maximum likelihood approach.
4
Problem Formulation
Let X ¼ xvjv ¼ 0; 1; 2; . . .ND  1
f
g be a set of ND possible delays, where each value xv
is calculated as in (5). The set X contains an unknown number of signal delays, denoted
N1, and the remainder are noise delays, denoted by N2, where
N1 þ N2 ¼ ND:
ð15Þ
Our goal is to correctly classify each delay xv as a signal or noise delay. This
problem can be viewed as a classic mixture model problem: Given a set of observed
points X generated from two independent and unknown distributions Q1 and Q2,
where Q1 stands for a noise distribution and Q2 stands for a signal distribution, what
are the parameters and prior probabilities of these two distributions that most likely
generated X? Once we estimate the distribution parameters, we can classify a delay xv
to correspond to a signal complement if p xvjQ2
ð
Þ [ pðxvjQ1Þ else it is classiﬁed as a
noise component. Using the Central Limit Theorem, we may assume that Q1 and Q2
follow a Gaussian distribution, if enough bits are used to generate X in (5). The mixture
model likelihood function in (8) becomes
‘ /
ð Þ ¼
X
ND1
v¼0
log
X
K
k¼1
1
ﬃﬃﬃﬃﬃﬃ
2p
p
rk
e

xvlk
ð
Þ2
2r2
k
pk
 
!
:
ð16Þ
Our goal is to ﬁnd the prior probabilities pk as well the distribution parameters lk
and rk that most likely generated X. Using the EM algorithm outlined previously, we
Expectation Maximization for Multipath Detection in Wideband Signals
125

start with an initial set of model parameters / and prior probabilities pk and we iterate
between calculating the prior probabilities and model parameters:
1. Expectation step:
pðnewÞ
k
¼ 1
ND
X
ND1
v¼0
wvk;
ð17Þ
where
wvk ¼
pkﬃﬃﬃﬃ
2p
p
rk e

xvlk
ð
Þ2
2r2
k
PK
k¼1
pkﬃﬃﬃﬃ
2p
p
rk e

xvlk
ð
Þ2
2r2
k
:
ð18Þ
2. Maximization step:
Dlk‘ /
ð Þ ¼ P
ND1
v¼0
pkDlk p xvj/k
ð
Þ
PK
k¼1 pkDlk p xvj/k
ð
Þ ¼ 0;
) P
ND1
v¼0
pkp xvj/k
ð
Þ
PK
k¼1 pkp xvj/k
ð
Þ 
 xvlk
ð
Þ
r2
k


¼ 0;
) P
ND1
v¼0
wvk 
 xvlk
ð
Þ
r2
k


¼ 0:
After some manipulation, we get
lk ¼
PND1
v¼0 wvkxv
PND1
v¼0 wvk
:
ð19Þ
Now taking the derivative with respect to rk we get
Drk‘ /
ð Þ ¼ P
ND1
v¼0
pkDrk p xvj/k
ð
Þ
PK
k¼1 pkp xvj/k
ð
Þ ¼ 0;
) P
ND1
v¼0
wvk  1
rk þ 2 xvlk
ð
Þ2
2r3
k
h
i
¼ 0;
) P
ND1
v¼0
wvk r2
k þ xv  lk
ð
Þ2
h
i
¼ 0:
126
S. Salem and M. El-Tarhuni

After some manipulation, we get
r2
k ¼
PND1
v¼0 wvk xv  lk
ð
Þ2
PND1
v¼0 wvk
:
ð20Þ
We stop the EM iterations when the log likelihood in (16) stops changing after each
iteration. The delays are then classiﬁed based on their posterior probability: A delay xv
is classiﬁed as a signal delay if p xvjQ2
ð
Þ [ p xvjQ1
ð
Þ, else it is classiﬁed as a noise
delay.
We initialize the model parameters and prior probabilities as follows:
1. Assume signal and noise classes Q1 and Q2 are equally probable, with
p1 ¼ p2 ¼ 0:5
2. Initialize class means as:lk ¼ min X
ð Þ þ k max X
ð Þmin X
ð Þ
3


where min and max are the minimum and maximum values of X, respectively. The
3 in the denominator places l1 at a third of the range of X and l2 at two-thirds of
the range. It ensures the means are well spaced out and symmetric within X.
3. Initialize class standard deviations as rk ¼ rX
2 , where rX is the standard deviation of
the entire data set X. Any other initialization of the standard deviations is possible,
so long as the initializations are not extremely unequal, which might cause one class
to dominate erroneously.
5
Simulation Results
In this section, we compare simulation results from our EM-based algorithm to the
conventional algorithm of picking the ND delays with the highest power. For our
EM-based algorithm, the number of multipath delays is not known apriori, whereas for
the conventional algorithm the number of delays ND is assumed known.
Our simulation is based on the case where the paths are widely spaced apart
(multiples of chips apart). In general, performance is affected by three factors: number
of
delay
paths
(ND),
number
of
non-coherent
accumulations
(Na),
and
the
signal-to-noise ratio (SNR). For each variation of the factors we run the simulation 500
times. We consider a trial successful if the algorithm correctly ﬁnds at least half the
multipath delays without adding a noise delay, else if is considered a failure. The
probability PD is the percentage of the 500 trials that were successful.
Figure 1 shows the probability of multipath detection when the number of
non-coherent accumulations and the SNR are ﬁxed, and only the number of delay paths
is varied. Two simulations are shown, the ﬁrst where SNR ¼ 15 dB (per chip), and
Na = 200, and the second where SNR ¼ 20 dB and Na = 50. The results show that
the performance of our EM-based algorithm improves as the number of signal delays
increases. This is expected with any statistical based approach: as more data is available
for a model, the model estimate improves.
Expectation Maximization for Multipath Detection in Wideband Signals
127

The results of varying the number of non-coherent accumulations Na while ﬁxing
the SNR and number of delay paths is shown in Fig. 2. Two simulations are shown, the
ﬁrst where SNR ¼ 15 dB and the number of delay paths is ND ¼ 3 and the second is
where SNR ¼ 20 dB and the number of delay paths is ND ¼ 4. The ﬁgure shows that
PD improves as Na increases for both the conventional algorithm and our EM based
algorithm. The performance of our EM-based algorithm is comparable to the con-
ventional methods, but trails in the required number of non-coherent accumulations for
proper performance. At lower number of non-coherent accumulations, the delays are
Fig. 1. Detection probability for different number of delay paths.
Fig. 2. Detection probability for different number of non-coherent accumulations.
128
S. Salem and M. El-Tarhuni

sometimes too close to each other to be properly separated by the EM algorithm, and
hence the lower performance at lower Na. As the number of accumulations increases,
the classes are more distinct, and performance of the EM algorithm increases to become
comparable to the conventional algorithm.
Figure 3 shows the effect of SNR on performance, while keeping the number of
delay paths to 5. The ﬁgure shows two simulations, one for Na = 100 and one for
Na = 200. As expected, as SNR decreases performance decreases. This effect is
compounded if the number of non-coherent accumulations is also decreased. Note that
our EM-based algorithm outperforms the conventional algorithm at lower number of
accumulations Na. This is due to the fact that the conventional algorithm has to pick ND
delays, and noise delays can be dominant at low SNR and low Na, whereas our
EM-based algorithm does not make any assumptions about the number of delays.
Tables 1, 2 and 3 show detailed comparison results of our EM-based algorithm to
the conventional algorithm, where a simulation is considered a success if at least 50%
of the signal delays are detected without adding a noise delay. Each experiment is
repeated 500 times.
The data shows that our scheme performs comparably to the conventional one,
without prior knowledge of the number of signal delays or a preset threshold. It
generally requires more accumulations Na for the same performance, and the perfor-
mance increases as the number of delays ND increases. This is typical of any statistical
algorithm where performance increases when more data is available for parameter
estimation.
Fig. 3. Detection probability for different Signal to Noise Ratios
Expectation Maximization for Multipath Detection in Wideband Signals
129

6
Conclusion
We proposed an algorithm for multipath estimation in wideband communication sys-
tems. The proposed scheme is based on classifying an energy detector search results
into either a signal component of a noise component using the Expectation Maxi-
mization algorithm. Simulation results have shown that the performance of our
EM-based algorithm is comparable to the conventional energy detector scheme but
without the need for prior knowledge of the number of multipath components and
without the need to use a preset threshold for detecting the multipath components.
Table 2. Simulation results for L = 3.
Na
50
100
200
500
1000
SNR = −5 dB
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
SNR = −10 dB PEM = 94.6%
Pconv = 100%
PEM = 99%
Pconv = 100%
PEM = 99.8%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
SNR = −15 dB PEM = 68.8%
Pconv = 91.4%
PEM = 82.8%
Pconv = 99.6%
PEM = 94.6%
Pconv = 100%
PEM = 97.6%
Pconv = 100%
PEM = 99.6%
Pconv = 100%
SNR = −20 dB PEM = 21.8%
Pconv = 12.8%
PEM = 26.8%
Pconv = 29.2%
PEM = 45.2%
Pconv = 63.8%
PEM = 73.6%
Pconv = 98.4%
PEM = 87.4%
Pconv = 100%
Table 3. Simulation results for L = 5.
Na
50
100
200
500
1000
SNR = −5 dB
PEM = 99.8%
Pconv = 100%
PEM = 99.8%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
SNR = −10 dB PEM = 93.8%
Pconv = 100%
PEM = 99.2%
Pconv = 100%
PEM = 99.6%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
SNR = −15 dB PEM = 61%
Pconv = 75.8%
PEM = 81.4%
Pconv = 98.6%
PEM = 93.2%
Pconv = 100%
PEM = 98.4%
Pconv = 100%
PEM = 99.8%
Pconv = 100%
SNR = −20 dB PEM = 18.2%
Pconv = 3.4%
PEM = 28.4%
Pconv = 17.2%
PEM = 44.2%
Pconv = 51.2%
PEM = 77%
Pconv = 96%
PEM = 91.4%
Pconv = 100%
Table 1. Simulation results for L = 1.
Na
50
100
200
500
1000
SNR = −5 dB
PEM = 98.4%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
PEM = 100%
Pconv = 100%
SNR = −10 dB PEM = 79.4%
Pconv = 100%
PEM = 92.2%
Pconv = 100%
PEM = 98.4%
Pconv = 100%
PEM = 99.8%
Pconv = 100%
PEM = 99.8%
Pconv = 100%
SNR = −15 dB PEM = 19%
Pconv = 62%
PEM = 33.2%
Pconv = 82.7%
PEM = 61%
Pconv = 96.4%
PEM = 88.2%
Pconv = 100%
PEM = 96.6%
Pconv = 100%
SNR = −20 dB PEM = 1.8%
Pconv = 22.8%
PEM = 2.6%
Pconv = 28.2%
PEM = 8.6%
Pconv = 39.4%
PEM = 16%
Pconv = 66%
PEM = 37%
Pconv = 90.8%
130
S. Salem and M. El-Tarhuni

References
1. Meissner, P., Leitinger, E., Witrisal, K.: UWB for robust indoor tracking: weighting of
multipath components for efﬁcient estimation. IEEE Wireless Commun. Lett. 3(5), 501–504
(2014)
2. Chen, X., Dovis, F., Peng, S., Morton, Y.: Comprehensive studies of GPA multipath
mitigation methods performance. IEEE Trans. Aerosp. Electron. Syst. 49(3), 1555–1568
(2013)
3. Qu, B., Wei, J., Tang, Z., Yan, T., Zhou, Z.H.: Analysis of combined effects of multipath and
CW interference on coherent delay lock loop. Wireless Pers. Commun. 77(3), 2213–2233
(2014)
4. Wildemeersch, M., Slump, C., Rabbachin, A.: Acquisition of GNSS signals in urban
interference environment. IEEE Trans. Aerosp. Electron. Syst. 50(2), 1078–1091 (2014)
5. Holmes, J.: Coherent Spread Spectrum systems. R.E. Krieger Pub. Co., Malabar (1990)
6. Simon, M., Omura, J., Scholtz, R., Levitt, B.: Spread Spectrum Communications Handbook.
McGraw-Hill Telecom Engineering, Electronic edn. McGraw-Hill Education, New York
(2001)
7. Braun, W.R.: PN acquisition and tracking performance in DS/CDMA systems with
symbol-length spreading sequences. IEEE Trans. Commun. 45(12), 1595–1601 (1997)
8. Choi, S., Alouini, M.S., Qaraqe, K.A., Yang, H.C.: Finger assignment schemes for rake
receivers with multiple-way soft handover. IEEE Trans. Wireless Commun. 7(2), 495–499
(2008)
9. Abou-Khousa, M., Ghrayeb, A., El-Tarhuni, M.: An efﬁcient multipath detection scheme for
CDMA systems. IEEE Trans. Wireless Commun. 6(8), 2776–2781 (2007)
10. Abou-Khousa, M., Ghrayeb, A., El-Tarhuni, M.: A multipath detection scheme for CDMA
systems with space-time spreading. IEEE Trans. Veh. Technol. 57(1), 146–156 (2008)
11. Fulghum, T., Cairns, D.A., Cozzo, C., Wang, Y.P.E., Bottomley, G.E.: Adaptive generalized
rake reception in DS-CDMA systems. IEEE Trans. Wireless Commun. 8(7), 3464–3474
(2009)
12. Van Nee, R.D.J.: The multipath estimating delay lock loop. In: ISSTA 1992, pp. 39–42,
August 1992
13. Wilde, A.: The generalized delay-locked loop. Wireless Pers. Commun. 8(2), 113–130
(1998)
14. Sheen, W.H., Tai, C.H.: A noncoherent tracking loop with diversity and multipath
interference cancellation for direct-sequence spread-spectrum systems. IEEE Trans.
Commun. 46(11), 1516–1524 (1998)
15. Brenneman, M., Morton, Y., Zhou, Q.: GPS multipath detection with ANOVA for adaptive
arrays. IEEE Trans. Aerosp. Electron. Syst. 46(3), 1171–1184 (2010)
16. Closas, P., Fernandez-Prades, C.: A statistical multipath detector for antenna array based
GNSS receivers. IEEE Trans. Wireless Commun. 10(3), 916–929 (2011)
17. Dempster, P., Laird, N.M., Rubin, D.B.: Maximum likelihood from incomplete data via the
EM algorithm. J. Roy. Stat. Soc. B 39(1), 1–38 (1977)
18. Arfken, G., Weber, H.: Mathematical Methods for Physicists. Elsevier, Amsterdam (2005)
Expectation Maximization for Multipath Detection in Wideband Signals
131

Dynamic Resource Orchestration of Service
Function Chaining in Network Function
Virtualizations
Bangchao Yu1,2,3(&), Wei Zheng1,2,3, Xiangming Wen1,2,3,
Zhaoming Lu1,2,3, Luhan Wang1,2,3, and Lu Ma1,2,3
1 Beijing Laboratory of Advanced Information Networks, Beijing, China
yubc0321@gmail.com, zhengweius@163.com,
lzy_0372@163.com, wluhan@bupt.edu.cn
2 Beijing Advanced Innovation Center for Future Internet Technology,
Beijing, China
3 Beijing Key Laboratory of Network System Architecture and Convergence,
Beijing University of Posts and Telecommunications, Beijing, China
Abstract. Network Functions Virtualization is a new network architecture
framework and is revolutionizing the way networking service that how to design
and deploy. NFV promotes virtualizing network functions and improves the
ﬂexibility to resource orchestration for request service function chains. How-
ever, how to ﬁnd the most suitable resource in NFV-based network resource is a
challenge. This paper presents a comprehensive state of the NFV resource
orchestration by introducing a dynamic resource orchestration architecture that
can conﬁgure dynamic resources. With consideration of load balance, energy
cost and resource consumption, the resource orchestration is formulated as a
multi-objective optimal problem. Finally, a multi-objective simulated annealing
algorithm is used to obtain the optimal resource strategy to deploy network
functions. Simulation results show that the solution for dynamic resource
orchestration can achieve approximate optimal solution in acceptable time and
reduce 8% energy consumption with a 0.89 Jain’s fairness index.
Keywords: NFV  Service function chains  Performance optimization
Resource orchestration
1
Introduction
Network Function Virtualization (NFV) is revolutionizing the way networking service
are designed and deployed, and is a promising technique to meet the requirements of
explosive data trafﬁc in ﬁfth generation (5G) mobile communications [1]. Compared to
traditional network where dedicated hardware is required for each function (manually
installed into the network), the NFV virtualizes the network functions (NFs) (e.g., local
cache, ﬁrewalls, load balancers, databases), which can be hosted on commodity
hardware (i.e., industry standard servers, storage and switches). NFV transforms the
way that how network operators architect their infrastructure by leveraging the
full-blown virtualization technology to separate software instance from hardware
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 132–145, 2018.
https://doi.org/10.1007/978-3-319-72823-0_14

platform and by decoupling functionally from location for faster networking service
[2]. These functions decoupled from the underlying hardware are knows as Virtualized
Network Functions (VNFs).
Under the paradigm of NFV, the networks provide considerably more ﬂexibility,
leads to efﬁcient and scalable resource usage and reduce costs. Despite the emergence
of NFV, deploying and orchestrating VNFs still requires more research and develop-
ment. To facilitate the service management in NFV environments, service function
chaining technique is proposed. A SFC is describes the various NFs and how they
interact to provide a complete network service [3]. In order to offer various service, the
operator needs to conﬁgure the networking infrastructure to direct the right trafﬁc
through the right service chain. Since the deployment and management of NFs pro-
viding the services usually require a signiﬁcant capital investment, the operators are
seeking ways to optimize the resource utilization of theses NFs. The key to exploiting
the potential of the NFV based networks is the issue of resource orchestration in SFC.
Resource Orchestration (RO) is the set of operations that cloud providers and
application owners undertake for selecting, deploying, monitoring, and dynamically
controlling the conﬁguration of hardware and software resources as a system of quality
of service-assured components that can be seamlessly delivered to end users [4].
Orchestration can signiﬁcantly reduce the cost and the time required for provisioning
new services with respect to today’s standards by allowing the joint allocation of
different types of physical or virtual resource.
However, there are still many issues that need to be tackled in the resource orches-
tration of SFC. In [5], the authors study the network slicing based on 5G and future mobile
network. Oneistoachievedynamicvariationofserviceresourcerequirementsarisefroma
number offactors, including resource capacity demand, failures, end-user access patterns,
andvariationsinresourceprices.Theother isconﬁguringdynamicresources.Theimpetus
behind NFV environment if the ever-increasing demand to manage growth and increase
computing ﬂexibility by dynamic scaling up or down resources based on demand [2].
Moreover, dynamic conﬁguration of resources is a complex issue because of lack of
visibility and control across heterogeneous services at different layers.
Recently, there have been many efforts on how to conﬁgure dynamic resources from
both academia and industry. In [6], the authors study the problem of dynamic and pro-
graming resource orchestration in Mobile Cloud Computing (MCC) environment, and
propose a multi-objective particle swarm optimization algorithm by considering resource
choice for complicatedservicewheremultipletasks are composed together. Another work
in [7] studies NFV resource allocation problem, and proposed a coordinated approach
Jointly Optimize the Resource Allocation in NFV (JoraNFV) to jointly optimization three
phases in NFV resource allocation. While initial research results are promising, more than
that,inmanycasedesigningeffectivedynamicresourceorchestrationtechniquesthatcope
with large-scale NFV environment remains a deeply challenging problem.
In this paper, we focus on the conﬁguring dynamic resources orchestration in NFV
environment. More speciﬁcally, we search for the optimal resource strategies and
dynamically conﬁgure resource to meet requirements and constraints. To solve this
problem, we propose a dynamic resource orchestration framework that contains a
software deﬁned architecture along with the multi-objectives optimization algorithm
aiming to obtain the optimal resource conﬁgurations.
Dynamic Resource Orchestration of Service Function Chaining
133

The rest of this paper is organized as follows: Some related works are presented in
Sect. 2. After that, we present the dynamic resource orchestration architecture in Sect. 3.
The algorithm to solve conﬁguring dynamic resource problem is introduced in Sect. 4.
Section 5, we report performance evaluation results. Section 6 concludes this paper.
2
Related Works
Over the last few years, some works have already been done to study resource
orchestration in NFV environment.
Recent studies show that, in an enterprise network, the number of middle-boxes is
comparable with the number of routers and switches needed to maintain the operation of
the network [8]. Sherry et al. [9] presents a comprehensive state of the art of NFV-RA by
introducing a novel classiﬁcation of the main approaches that pose solutions to solve the
resource allocation of demanded network services in NFV-based network infrastructure.
He proposed three different stages of NFV-RA. In addition, NFV facilitates installation
and deployment of VNFs on general purpose server [10, 11], thus allowing dynamic
migration of VNFs form one server to another, that is, to any place of the network [12].
In [13], a two-layer home-to-home cloud framework which allows intra-home
resources to be shared among consumer electronic devices and inter-home resources to
be shared among neighboring houses is proposed to ﬁnd the most suitable resources in
the home cloud. But the optimal orchestration strategy in [13] fails to scale or down
resources based on demand dynamically.
VNFs can be deployed and reassigned to share different physical and virtual
resource of the infrastructure, so as to guarantee scalability and performance require-
ments. Tao et al. [14] work on the resource service composition in industry grid system,
and exploit the standard particle swarm algorithm to ﬁnd the solution. In [15], the
authors propose two heuristic algorithms to optimize middle-box placement problem.
One is greedy algorithm, and the other is simulated annealing algorithm. Their simu-
lation results show that the Simulated Annealing algorithm outperforms the Greedy
algorithm. However, the resource orchestration techniques mentioned above don’t
effectively support dynamic resource conﬁguration. For example, service or dataﬂow
can’t be dynamically and automatically partitioned or migrated arbitrarily from one
cloud service to another if demand cycles increase.
Therefore, the dynamic resource orchestration in the NFV environment should take
the CPUs and energy consumption into consideration. In this work, a dynamic
NFV-based resource orchestration architecture and a multi-object simulated annealing is
proposed to ﬁnd the appropriate solution for service to meet requirement and constraints.
3
System Architecture
3.1
NFV-Based Resource Orchestration Architecture
In this section we present the proposed integrated NFV Resource Orchestration and
Management Architecture in order to deploy Virtual Network Functions (VNFs) on top
134
B. Yu et al.

of an integrated cloud and network platform (i.e., NFV infrastructure (NFVI)).
The NFVI is composed of heterogeneous multi-domain and multi-layer transport
networks with heterogeneous transport and control technologies interconnecting dis-
tributed Databases Centers, providing computing, storage, and network resources.
Today, cloud computing systems follow a service-driven, layered software architecture
model, with Software as a service, Platform as a service, Infrastructure as a service. On
top of this physical infrastructure, we deploy an NFVI virtualization layer responsible
for virtualizing the computing, storage, and network resources of the NFVI by means
of a virtualized infrastructure manager.
As shown in Fig. 1, the NFV based Resource Orchestration System is composed of
Resource and Management Controller, VNFs (for example, database appliance, load
balancer, auto scaling, virtualized HSS, virtualized MME, virtualized S-PGW) and the
physical infrastructure. The Resource and Management Controller as well as Orches-
tration Controller is a centered controller for resource orchestration by interacting with
distributed ﬂexible Agents. The communication and monitoring functions for the
resources are encapsulated in the Agents.
3.2
Resource Orchestration Controller
The Resource Management and Orchestration Controller is composed of three func-
tional modules: monitor function, decision function and execution function, as show in
Fig. 2(a). They are responsible for the set of operations that cloud providers and
application owners undertake for selecting, deploying, monitoring, and dynamically
controlling the conﬁguration of hardware and software. The abstract resource and
management orchestration operations in the lifecycle of an application or service are
resource selection, deployment, monitoring and control, as shown in Fig. 2(b).
Virtualization platform (OpNFV)
Agent
Charm
Agent
Charm
orchestrator
Juju-based
Controller
Resource
Slice1
Slice2
Agent
Charm
Agent
Charm
KVM
KVM
KVM
KVM
NFs
Slices
Status
Traffic
Interface
Fig. 1. NFV-based Resource Orchestration System
Dynamic Resource Orchestration of Service Function Chaining
135

Monitor Function collects and aggregates the status and performance metrics of
consumer electronic devices. By this function, the Orchestration Controller obtains the
resource parameters such as CPU, storage and communication capability, or the Cache
memory.
Decision Function receives the register message of connection, or the control
message from Agent, and records the resource parameters. It also gathers the perceiving
and monitoring information, and transmits the resource orchestration policy from
orchestration controller to the selected VFs.
Execution Function is calculation module in the Resource Orchestration Controller,
which takes use of the monitoring information and obtains the resource orchestration
policy from the optimization problem. The service function can be abstracted to
application with speciﬁc functions and parameters. Then according to resource
requirements, this function executes the intelligent algorithm and provides the optimal
resource orchestration strategy for a virtual function.
3.3
Interactive Procedure
The could computing resources may not stick to only one service or platform, so taking
advantage of virtualization resource has become a key issue. Based on this, our goal is
to achieve the automatic management of Virtual functions (VFs) and service orches-
tration, meeting the quality of service (QoS)-assured components that can be seam-
lessly delivered to end users. In Fig. 3, for collecting the resource status, Orchestration
Controller subscribes the information for each Agent. When the user’s behavior or the
timer is triggered, Agent sends the information to the monitor function box in
Orchestration Controller. When a service’s request arrives at the Orchestration Con-
troller, it ﬁnishes the virtualization resource orchestration (in the Decision Function
box) and transmits the strategies to the Execution Function box.
When Agent receives the strategy, it performs the service management or
deployment and executes the service. After that, it collects the result of its previous
services, updates the results, deletes the records of itself and transmits the results to the
Orchestration Controller
Monitor 
Function
Decision
Function
Exection 
Function
Resource
selection
Resource
control
Resource
deployment
Resource
monitoring
a
b
Fig. 2. Orchestration controller and operations
136
B. Yu et al.

Orchestration Controller. The interaction message of Agents and Orchestration Con-
troller are implemented by using Representational State Transfer (REST) Application
Programming Interfaces (APIs) that is easy for extending.
4
Resource Orchestration Algorithm
4.1
Problem Deﬁnition
Figure 4 depicts the basic resource orchestration in NFV resource management. The
left part is the service chaining which consist of function units (VFs) hosted on NFV
nodes. By isolation, multiple VFs can run on the same physical could server, e.g. three
units on Infrastructure-based resource area A and four units on Infrastructure-based
resource area B. It should be noted than the CPU, storage, and network resources in A
and B is different. On the right part of Fig. 4, there is mapping part from physical
resources to virtual resources. The NFV resource are abstracted to services with
speciﬁc functions and parameters. The VFs in a complicated service chaining is
modeled as dataﬂow graph and denoted by Directed Acyclic Graph, depicted in Fig. 3.
Due to the difference existing in the hardware resources, the appropriate resource is
chosen for VFs according to the global optimization goal during user’s behaviors. As
the metrics such as resource cost, resource availability and CPU load average are not
relevant or not following the same trend or even conﬂicting with each other, improving
one metric may result in the deterioration of another one.
The multi-objective resource orchestration is to ﬁnd a solution set Resource
Orchestration Path (ROPSET) in which each solution ROPd has extreme optional value
of aggregated metric, i.e.
Service Application/
User’s Behaviors
Orchestration 
Controller
Agent
Agent
Agent
Subscribe
Publish
Subscribe
Subscribe
Publish
Publish
Request
Decision 
&
Execution
Function
Monitor Function
Strategy
Service 
Management and
Execution
Service 
Management and
Execution
Strategy
Strategy
Strategy
Service 
Management and
Execution
Result
Result
Result
Fig. 3. Interactive procedure for resource orchestration
Dynamic Resource Orchestration of Service Function Chaining
137

min FðROPdÞ ¼ a  min EðROPdÞ þ b  min CðROPdÞ þ c  min LðROPdÞ
ð1Þ
where d ¼ 1; . . .; n; ROPd 2 ROPset, a þ b þ c ¼ 1, E(ROPd), C(ROPd) and L(ROPd)
are the energy consumption, resource charges and CPU load average of ROPd
respectively. F is the target vector function.
Energy consumption (Er;i
s ) means the total energy consumption of service i when
VFs node is hosted on the resource r. It is determined by the amount of transmitted
data. er
trans is the energy consumption of transmitting per unit (bit) data to resource r.
Vi
load is the data volume of service i deploy to the NFV resource and Vi
interact is
interaction data volume between NFV resource and resource orchestration controller
during the service i execution. ecomput is the energy consumption of computing per unit
(bit) data and Vi
comput is the local data volume of the service i.
Er;i
S ¼ er
trans  ðVi
load þ Vi
interactÞ þ ecomput  Vi
comput
ð2Þ
Resource charges (Cr;i
S ) refers to the price pay for the speciﬁc NFV resource r
where service i will be ofﬂoad to. Let cr
storage be the storage charge of selected resource
r, cr
comput be the computing charge of selected resource r, and cr;c
commun be the com-
munication cost from resource r to resource orchestrator controller when service i will
be ofﬂoaded to. Vr;c
commun is the data volume transmitted from resource r to resource
orchestrator controller.
Cr;i
S ¼ cr
storage þ cr
comput þ cr;c
commun  Vr;c
commun
ð3Þ
2
3
6
7
5
4
1
VMa1
VMa2
……
VMb1
VMb2
……
Infrastructure-based
resource area A
Infrastructure-based
Resource area B
Service chaining
…
NFs Layer
Infrastructure Layer
1
2
3
4
5
6
7
Fig. 4. Example of resource orchestration in NFV
138
B. Yu et al.

CPU load average (Lr;i
s ) represents the average system load over a period of time.
An idle computer has a number of 0. Each process using or waiting for CPU increments
the load number. For single-CPU systems that are CPU bound, one can think of load
average as a percentage of system utilization during the respective time period. For
system with multiple CPUs, one must divide the number by the number of processors
in order to get a comparable percentage. li
A
is the CPU load average of
infrastructure-based resource area A when service i is hosted and nA is the total number
of service hosted on A.
Lr;i
S ¼ min½
X
nA
i¼0
li
A;
X
nB
i¼0
li
B;   
ð4Þ
4.2
Resource Orchestration Algorithm
The resource orchestration is to select the optimal from all possible candidates con-
sidering multiple objectives (e.g. energy consumption, resource cost, resource avail-
ability), which is known as multi-objective optimization problem. We take use of the
Multi-Objective Simulated Annealing (MOSA) algorithm to solve this problem, for it is
a general random search framework that can get near-optimal solutions of combina-
tional optimization problems. Besides, the advantage of MOSA is it can keep
improving the solution effectively if time allows.
The MOSA algorithm for resource orchestration is stepped as follows:
Algorithm: MOSA for the dynamic resource orchestration
Kprwvu: temperature T ; parameter λ; probability set p
Qwvrwv: resource orchestration strategy 
d
ROP
// Initialization
( )
T t
T
λ
=
,
0
t
t
=
,
/
(
)
F t
p
F
e
−Δ
Δ
=
,
set
IteNum
L
ROP
=
⋅
,
0
i =
yjkng" i
IteNum
<
fq
e
ROP ←generate neighbor of 
d
ROP
calculate 
(
)
(
)
e
d
F
F ROP
F ROP
Δ
=
−
,
(
)
p
F
Δ
kh"
0
F
Δ
<
vjgp
d
e
ROP
ROP
←
kh
(0,1)
(
)
rand
p
F
<
Δ
vjgp
d
e
ROP
ROP
←
with probability p
gpf
gpf
1
i
i
= +
kh
( ,
)
0
mod i L ==
vjgp
t ←update temperature t
gpf
Tgvwtp"
d
ROP
Dynamic Resource Orchestration of Service Function Chaining
139

5
Performance Evaluation
5.1
Simulation Scenarios
The implementation set-up consists of a test bed with seven VMs of desktop PCs
performing as the NFV clouding computing resource. The VFs are all conﬁgured with
1 GB memory, CPU 3.2 GHz, gigabit Ethernet network interfaces, and Linux oper-
ating system, and are deployed with the Resource Controller for orchestration
resources.
In the simulation scenarios, we generate speciﬁc service function chain that include
different types services which hosted on NFV based resources. For each component
service, the Vi
load, Vi
interact, Vi
comput and Vr;c
commun are generated according to a uniform
distribution. We generated serval resource providers to represent different NFV based
resources with er
trans, ecomput, cr
storage, cr
comput and cr;c
commun follow a uniform distribution.
The detailed setting is shown in Table 1. The resource parameters of service functions
are generated while the service function is getting started. The available time Tstart and
Tend are set to 0 and 5 min, respectively. And we take an example of a service function
chain that contains NFs and dataﬂow depicted in Fig. 5.
2
3
6
7
5
4
1
Fig. 5. Service dataﬂow in simulation scenarios
Table 1. Simulation parameters
NFV resource
Service
MOSA
Parameters Values
Parameters Values
Parameters Values
er
trans
[1, 5]
Vi
load
[10,80]
a
0.3
ecomput
3
Vi
interact
[10,50]
b
0.4
cr
storage
[1, 10]
Vi
comput
[20,100] k
0.3
cr
comput
[20,50] Vr;c
commun
[5,30]
li
A
[0.1,0.7]
cr;c
commun
[0,1]
140
B. Yu et al.

5.2
Simulation Results
In order to evaluate the performance of the proposed Resource Orchestration Archi-
tecture and the MOSA algorithm, we carried out the evaluation through a combination
of testbed based experiments and numerical simulations. We use the testbed to evaluate
the real service functions in small scale network with different physical infrastructures.
In our evaluation, we compare the proposed algorithms against a baseline algorithm
(Greedy Algorithm) and a basic resource orchestration (without any algorithm).
(1) Energy evaluation
To evaluate the performance of MOSA algorithm, we generate seven NFs that contains
multiple instances hosted on different hardware resources in total. The physical hard-
ware is different in computing resource, storage resources, etc. We started the resource
orchestration with MOSA algorithm at 40 min when the virtual machine was deployed,
for the installation and conﬁguration of service functions.
As shown in the Fig. 6, we can observe that MOSA-based approach slightly out-
performs GA-based, and both MOSA and GA-based approach outperform basic RO
without any algorithm in the runtime of orchestration operations. There are mainly due
to two reasons. Firstly, both MOSA and GA-based approach are taking the energy
consumption into consideration before conﬁguring resources. Second reason is the
CPU load average of hardware or software resource are also considered in MOSA
approach, which is related to the energy consumption. On average, the MOSA-based
approach will reduce 8% energy consumption than basic RO and reduce 3% than
GA-based algorithm.
Fig. 6. Energy consumption of infrastructure
Dynamic Resource Orchestration of Service Function Chaining
141

(2) Load evaluation
In the MOSA algorithm, we considered the CPU load average of the physical infras-
tructure or service functions. The Jain’s Fairness Index indicates the fairness of dif-
ferent algorithm for resource invocation [16]. It is deﬁned as follows:
f ðx1; x2; x3; . . .; xnÞ ¼ ðPn
i¼1 xiÞ2
n Pn
i¼1 x2
i
ð5Þ
The Jain’s Fairness Index was calculated for each of SFs and is shown in Fig. 7. It
can be observed that the fairness is improved with the MOSA-based or GA-based
approach compared to basic RO. The Jain’s index can achieve about 0.89 with MOSA
and 0.87 with GA, which is higher than basic RO with about 0.77. It shows that,
considering CPU load average and conﬁguring dynamic resources, MOSA approach
perform consistently on different resources. The Jain’s index of MOSA becomes better
when the network scale becomes larger and larger, and more instances are deployed,
which also make resources more fair.
(3) Execution Time
To evaluate the execution time, we use MOSA and GA-based approach to deploy
service functions chain on different physical infrastructure. The request service chain
contains 7 VNFs and the number of virtual nodes in network is set from 10 to 100 with
an interval of 10. The simulation result is shown in Fig. 8. With the increase of the
number of nodes, the execution time are increasing, but the MOSA and GA-based
approach take less time than basic resource orchestration without any algorithm. The
MOSA-based approach can hit optimal solutions of conﬁgure dynamic resource in
acceptable time.
Fig. 7. Jain’s fairness index of CPU load average
142
B. Yu et al.

(4) Multi-object evaluation
To facilitate understanding results, we use the three-dimensional ﬁgures to show the
optimal solutions in resource orchestration. The result is shown in Fig. 9. It contains 30
instances of service functions for each algorithm. Pentagram represent the value of
MOSA algorithm in the objective space. We can ﬁnd that the MOSA can obtain more
optimal results than GA algorithm and basic resource orchestration.
Fig. 8. Execution time performance of algorithms
Fig. 9. Comparisons of resource orchestration results
Dynamic Resource Orchestration of Service Function Chaining
143

6
Conclusion
In this paper, we target the problem of dynamic resource orchestration in NFV envi-
ronment. Our work goes beyond existing approaches by considering resource choice
for service function chaining, while others mainly focus on single inﬂuencing factors or
static deployment problem. We thus designed the NFV-based Resource Orchestration
Architecture to dynamic select the optimal resource candidates for VNFs. We deﬁned
the resource orchestration as an optimization problem with the multi-objective, i.e.
energy consumption of infrastructure, resource charges and CPU load average. To
obtain the optimal results for resource orchestration, we introduce the Multi-Objective
Simulated Annealing in the core of resource orchestration controller. Simulation results
show that the multiple solutions for dynamic resource orchestration can archive the
optimal solutions in acceptable time. The proposed algorithm can be used in many
scenarios, for example, it can be used to dynamically optimize service functions in
NFV-based environment.
Acknowledgment. This work is supported by a grant from the National High Technology
Research and Development Program of China (863 Program), No. 2014AA01A701, and Beijing
Municipal Science and technology Commission research fund project No. Z16111000500000.
References
1. Zhang, H., et al.: Fronthauling for 5G LTE-U ultra dense cloud small cell networks. IEEE
Wireless Commun. 23(6), 48–53 (2016)
2. Chiosi, M., et al.: Network functions virtualisation: an introduction, beneﬁts, enablers,
challenges and call for action. In: SDN and OpenFlow World Congress (2012)
3. Halpern, J., Pignataro, C.: Service Function Chaining (SFC) Architecture. No. RFC 7665
(2015)
4. Ranjan, R., et al.: Cloud resource orchestration programming: overview, issues, and
directions. IEEE Internet Comput. 19(5), 46–56 (2015)
5. Zhang, H., et al.: Network slicing based 5G and future mobile networks: mobility, resource
management, and challenges. IEEE Commun. Mag. 55, 138–145 (2017)
6. Qi, Q., et al.: Dynamic resource orchestration for multi-task application in heterogeneous
mobile cloud computing. In: 2016 IEEE Conference on Computer Communications
Workshops (INFOCOM WKSHPS). IEEE (2016)
7. Wang, L., et al.: Joint optimization of service function chaining and resource allocation in
network function virtualization. IEEE Access 4, 8084–8094 (2016)
8. Fiorani, M., et al.: Challenges for 5G transport networks. In: 2014 IEEE International
Conference on Advanced Networks and Telecommunications Systems (ANTS). IEEE
(2014)
9. Sherry, J., Ratnasamy, S., At, J.S.: A survey of enterprise middlebox deployments (2012)
10. Herrera, J.G., Botero, J.-F.: Resource allocation in NFV: a comprehensive survey. IEEE
Trans. Netw. Serv. Manage. 13, 518–532 (2016)
11. Hirschman, B., et al.: High-performance evolved packet core signaling and bearer processing
on general-purpose processors. IEEE Network 29(3), 6–14 (2015)
12. Bronstein, Z., et al.: Uniform handling and abstraction of NFV hardware accelerators. IEEE
Network 29(3), 22–29 (2015)
144
B. Yu et al.

13. Qi, Q., et al.: Resource orchestration for multi-task application in home-to-home cloud. IEEE
Trans. Consum. Electron. 62(2), 191–199 (2016)
14. Tao, F., et al.: Resource service composition and its optimal-selection based on particle
swarm optimization in manufacturing grid system. IEEE Trans. Industr. Inf. 4(4), 315–327
(2008)
15. Liu, J., et al.: Improve service chaining performance with optimized middlebox placement.
IEEE Trans. Serv. Comput. 10(4), 560–573 (2017)
16. Ma, W.-M., et al.: Utility-based fairness power control scheme in OFDMA femtocell
networks. Dianzi Yu Xinxi Xuebao(J. Electron. Inf. Technol.) 34(10), 2287–2292 (2012)
Dynamic Resource Orchestration of Service Function Chaining
145

Support Recovery for Multiband Spectrum
Sensing Based on Modulated Wideband
Converter with SwSOMP Algorithm
Zhuhua Hu1,2, Yong Bai1,2(&), Yaochi Zhao2, and Yiran Zhang2
1 State Key Laboratory of Marine Resource Utilization in South China Sea,
Hainan University, No. 58, Renmin Avenue, Haikou 570228, Hainan Province,
People’s Republic of China
{eagler_hu,bai}@hainu.edu.cn
2 College of Information Science and Technology, Hainan University, No. 58,
Renmin Avenue, Haikou 570228, Hainan Province, People’s Republic of China
Abstract. The Modulated Wideband Converter (MWC) can provide a
sub-Nyquist sampling approach to sense sparse multiband analog signals and
reconstruct the frequency support set. However, the existing SOMP recon-
struction algorithms need a priori information of signal sparsity. This paper
applies the SwOMP algorithm to the CTF (Continuous-To-Finite) block of
MWC. The SwSOMP algorithm uses stage-wise weak selection in SOMP, and it
can reduce computational cost and solve large scale problems. It does not need
prior information of signal sparsity, and the frequency support can be recon-
structed blindly. The simulation results demonstrate that, MWC system with
SwSOMP algorithm, compared with the SOMP algorithm, can use less number
of channels, achieve higher percentage of correct support recovery blindly, and
reduce the sampling rate of the system.
Keywords: Spectrum sensing  MWC  sub-Nyquist sampling
Compressed sensing  Stage-wise weak Simultaneous OMP(SwSOMP)
1
Introduction
Spectrum sensing is often necessary in communication applications, such as Cognitive
Radio (CR) [1]. Its aim is to solve the spectrum crowdedness. CR should be able to
reliably monitor the spectrum and detect the primary users (PUs) activity. Then, sec-
ondary users (SUs) would opportunistically access frequency bands left vacant by PUs.
Therefore, support recovery of signals is pivotal to exploit the vacant bands in wide-
band spectrum. Generally, the sparse multi-band analog signal is transmitted in CR
network. Multiband RF signals occupy a fairly wideband range, while the frequency
band of each RF signal is narrow and distributed within the given bandwidth without
intersecting.
At the receiver, if the Nyquist sampling theorem is used to reconstruct the high
frequency multiband analog signal, it brings the sampling system a burden of ultra-high
sampling rate and massive sampling data [2]. Therefore, in order to achieve
sub-Nyquist sampling rate, the compressed sensing theory [3] must be extended to the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 146–159, 2018.
https://doi.org/10.1007/978-3-319-72823-0_15

analog domain. First came the method based on AIC (Analog-to-Information Con-
version) [4, 5]; However, the application scenarios of AIC is limited, and sampling
efﬁciency for the multiband signal is low. For this reason, a variety of novel
sub-Nyquist sampling structures have emerged such as CRD (Constrained Random
Demodulation) [6], random equivalent sampling [7] and MWC (Modulated Wideband
Converter) [8]. The sub-Nyquist sampling method of MWC is proposed by Yonina
Eldar and can be applied in the ﬁeld of radar [9], broadband communication [10] and
cognitive radio spectrum sensing [11, 12].
The accurate reconstruction of the signal support set is the core problem of MWC
system. At present, MWC mainly uses CTF (Continuous-To-Finite) reconstruction block
[13]. SOMP (Simultaneous Orthogonal Matching Pursuit) algorithm [14] can be used
commonly as the reconstruction algorithm in CTF block. SOMP is simple and easy to
realize, but its probability of correct reconstruction is not high enough [15]. Under the
case of no noise, the required number of channels for accurate reconstruction is much
higher than the theoretical lower bound. In practical applications, the channels must be
implemented by the hardware, which will greatly increase the development cost of the
system. In addition, the sparsity of signal has to be used as a priori information for the
reconstruction. However, it is difﬁcult to obtain in the CR environment. Therefore, it is
important to investigate better reconstruction algorithms which do not depend on the
signal sparsity, and can signiﬁcantly improve the percentage of the support recovery and
can reduce the number of required sampling channels.
To address the existing problems, this paper applies the SwSOMP (Stage-wise
weak Simultaneous OMP) algorithm based on SwOMP [16] to the support recovery of
MWC. The SwSOMP algorithm uses stagewise weak selection in SOMP, it further
improves StOMP (Stage-wise OMP) [17] and optimizes the threshold settings for the
selection of atoms, which can reduce the dependency for the observation matrix. It can
reduce computational cost and solve large scale problems. It does not need prior
information of signal sparsity, and the frequency support can be reconstructed blindly.
This paper applies the SwSOMP algorithm to the CTF (Continuous-To-Finite) block of
MWC. The simulation results demonstrate that, MWC system with SwSOMP algo-
rithm can use less number of channels, achieve higher percentage of correct support
recovery blindly, and further reduce the sampling rate of the system.
The remainder of this paper is organized as follows. In Sect. 2 we introduce the
signal model and principles of MWC system. Section 3 describes the method of
support recovery of MWC with SwSOMP algorithm. Section 4 gives the simulation
results and discussion. Section 5 concludes this paper.
2
Signal Model and Principles of MWC System
2.1
Sparse Multiband Signal Model
Sparse multiband signal is often found in the CR environment [18]. Suppose that the
received signal xðtÞ is a sparse bandpass analog signal. Its spectrum is distributed in the
frequency range ½fnyq=2; fnyq=2, and fnyq is the Nyquist sampling rate of the signal.
Assume that the spectrum of xðtÞ only contains N sub-bands whose bandwidth are
Support Recovery for Multiband Spectrum Sensing Based on MWC
147

Bi  B ðN  i [ 0Þ (without considering the symmetric band), and the sub-bands do
not overlap. B is the maximum bandwidth of the sub-bands. The center carrier fre-
quency of each sub-band is unknown. All unions of sub-bands and the maximum
bandwidth B can be expressed as:
P2N ¼ [
N
1
ai; bi
ð
Þ [ bi; ai
ð
Þ
f
g B ¼ max
i
bi  ai
ð
Þ
ð1Þ
The minimum needed sampling rate of the multi-band signal, the Landau rate [19],
is deﬁned as:
MðP2NÞ ¼ 2
X
N
i¼1
bi  ai
ð
Þ
ð2Þ
As is shown in Fig. 1, the entire frequency band is divided into L continuous
narrow bands, and each band’s bandwidth is not larger than B. Adding the symmetric
parts, the spectrum of xðtÞ in the entire frequency band has at most 2N parts with signal
energy. The bands are designated as 1; . . .; L
½
, then the set of the indices of sub-band
Xiðf Þ is called the support set of signal xðtÞ which is deﬁned as K ¼ suppðXðf ÞÞ. The
frequency bands corresponding to the indices are called the support bands. Since
2N  L, xðtÞ can be viewed as a sparse multiband signal.
In summary, the support bands of xðtÞ must meet the following two conditions:
(1) it has to be distributed in a very wide frequency range; (2) the signals only exist in a
few discrete frequency bands.
2.2
Sampling Scheme for MWC System
MWC contains a number of sampling channels, and each channel structure is the same,
which is composed of the mixer, low-pass ﬁlter and ADC. The structure of the system
is shown in Fig. 6(a). The received signal xðtÞ is input into m parallel channels at the
same time, each of which multiplies different patterns of periodic mixing signal piðtÞ to
realize the shifting from the frequency spectrum of xðtÞ signal to baseband. The piðtÞ of
each channel is uncorrelated, and the cycle of piðtÞ is Tp ¼ 1=fp. M is used to show the
number of random alternating times of 1 in a cycle. Mfp is deﬁned as the alternating
frequency of the mixing signal. The waveform of piðtÞ is shown in Fig. 2. After
f
1a
1b
ia
ib
N
a
N
b
B
2
nyq
f
2
nyq
f
−
Fig. 1. Spectrum structure of sparse multiband signal
148
Z. Hu et al.

mixing, the signal passes through lowpass ﬁlter whose cut-off frequency is 1=2Ts, as is
shown in Fig. 3. It ﬁnally passes through ADC at sampling rate is fs ¼ 1=Ts and
acquires M groups of low-speed digital sampling sequence yi½n.
On the analysis of the ith channel, the Fourier series expansion of the random
mixing function piðtÞ is:
piðtÞ ¼
X
1
l¼1
cilej2pfplt
ð3Þ
The coefﬁcient cil ¼ dl
P
L1
k¼0
aikej2p
L lk, aik 2 f1; þ 1g: When l ¼ 0, d0 ¼ 1=L, and
when l 6¼ 0; dl ¼ ð1  ej2pl
L Þ=j2pl.
Then, after passing through the lowpass ﬁlter with frequency characteristic
Hðf Þ ¼
1
fj j  fs=2
0
fj j [ fs=2
n
, the relationship between the DTFT (Discrete Time Fourier
Transform) of yi½n and xðtÞ’s Fourier transform Xðf Þ is obtained by sampling is as
follows:
Yiðej2pfTsÞ ¼
X
L0
l¼L0
cilXðf  lfpÞ
ð4Þ
In (4), f 2 fs=2; fs=2
½
; and L0
is the smallest integer that makes L ¼
2L0 þ 1  F ¼ fnyq=f : The Eq. (4) shows that the spectrum of the output sequence Yi n½ 
is changed to the weighted sum of original signal spectrum Xðf Þ with a fp step shifts,
and the spectral segment with a width of fs is intercepted by a low-pass ﬁlter. If taking
Yiðej2pfTsÞ as the ith component of m dimensional column vectors, Xðf  lfpÞ as the lth
components of the 2l0 þ 1 dimensional column vectors zðf Þ; (4) can be expressed as:
yðf Þ ¼ Uzðf Þ; f 2 ½fs=2; fs=2
ð5Þ
In (5), U is a m 	 L matrix. Uil ¼ ci;l ¼ cil
; 1  i  m, and m\L. Apply-
ing IDTFT (Inverse Discrete Time Fourier Transform) transform on (5), we can get the
corresponding relationship between the sequence Z½n ¼ ½z1½n; z2½n; . . .; zL½nT and
the sampling data Y½n ¼ ½y1½n; y2½n; . . .; ym½nT:
Y½n ¼ UZ½n
ð6Þ
...
p
T
p
T
M
0
t
1
+
1
−
( )
ip t
Fig. 2. Periodic mixing signal of the ith channel
f
( )
H f
2
sf
2
sf
−
0
Fig. 3. Ideal low-pass ﬁlter.
Support Recovery for Multiband Spectrum Sensing Based on MWC
149

For any frequency f 2 ½fs=2; fs=2, (6) can be viewed as a typical compressed
sensing problem, where an observed vector Y is known to recover an unknown sparse
vector Z. Therefore, it is viable to recover the support bands of the signal by using the
reconstruction algorithms of compressed sensing.
2.3
Reconstruction of Signal Support Set
Since m\L, (5) is an underdetermined equation. To get the unique solution to the
equation, the sampling parameters of the MWC system must meet the following
conditions [8]:
(1) fs  fp  B; fs
fp \ Mmin þ 1
2
;
(2) m  2K ¼ 4N, K is the sparsity of the sparse vector zðf Þ. N is the number of
signal bands without considering the symmetric bands;
(3) The number of 1 symbols in a periodic sequence piðtÞ must satisfy
M  Mmin ¼
fnyq
fp
l
m
. If fs ¼ fp, then Mmin ¼ L;
(4) Any 4N column of the matrix U is linearly independent.
It has been pointed out in [3] that the sparse solution for (5) is a NP-hard problem.
Nonetheless, such a problem can be transformed into a minimization of the l1 norm
problem provided that the number of sampling channels m  cK logðL=KÞ. c is a
constant, and K is the sparsity (i.e. the number of signal bands). It can be known that
the value of m is much greater than 2K.
The crucial problem of reconstruction is to reconstruct the sparse Z½n from the
sampling sequences Y½n. Since the signal frequency is continuous in ½fs=2; fs=2, (5)
is inﬁnite dimensional, i.e., contains inﬁnite number of SMV (Single Measurement
Vector) problem. A CTF block is proposed for reconstruction in [13], as shown in the
Fig. 4. It was proposed as a transformation framework from inﬁnite dimension to ﬁnite
dimension (Multiple Measurement Vectors, MMV) [15]. Support bands K of the signal
can be estimated by CTF, through which the signal xðtÞ can be further recovered.
SOMP algorithm can be used to the reconstruction in MWC, which achieves recon-
struction in [8]. The experimental results show that algorithm can achieve high per-
centage of correct reconstruction when m  2K logðL=KÞ, but there is still a large gap
compared with the theoretical lower bound.
Construct a MMV matrix V
[ ]
[ ]
H
n
Q
y n y
n
= ∑
H
VV
Q =
[ ]
y n
Recover the joint support 
Solve MMV problem
V=ƒ U
Sparse solution ˆU
Using 
SOMP/ 
SwSOMP
V
( )
ˆ
ˆ
supp U
Λ =
ˆΛ
ˆΛ
Fig. 4. Schematic diagram of the CTF block.
150
Z. Hu et al.

3
Support Recovery of MWC with SwSOMP Algorithm
As mentioned in the introduction, the SOMP reconstruction algorithm has many
shortcomings. As a result, in terms of the success rate of recovery, the needed mini-
mum number of channels, the reconstruction under low SNR and the maximum
number of bands that can be reconstructed, the reconstruction algorithm of MWC still
has a large space for improvement.
SwSOMP adopts the idea of stage-wise. First, atoms are selected according to the
principles of correlation, using threshold to select atoms matched with residual. The
difference with SOMP algorithm is that it does not always choose the most relevant
matching atom in each iteration, but ﬁnds a number of atoms in each iteration
according to atomic selection criteria. Then support set and support matrix are updated,
least square method is used to obtain an approximate solution, and the residual is
updated ﬁnally. At last, the support K is obtained after the end of the iterations. The
procedure of SwSOMP algorithm is shown in the Fig. 5.
The threshold of the atomic selection of the algorithm is deﬁned as:
th ¼ a max
i
gi
j j
ð7Þ
where g represents the correlation matrix obtained after inner product operation with
observation matrix U and the residual. (7) ﬁnds out the largest correlated data in the
matrix and uses its index in the matrix to ﬁnd the corresponding atom in the column of
U. The chosen atom is most relevant with the residual. a is known as weakness
parameter and a 2 ð0; 1. The reason of such a threshold selection is that the obtained
largest value of the inner product operation sometimes may not be the most relevant
one. According to (7), the updated expression of the corresponding support set in
SwSOMP is:
Kk ¼ Kk1 [ i : gi
j j  th
f
g
ð8Þ
Update 
residual
k
R
1
k
k
=
+
No
Yes
Meet the end 
conditions
End
Obtain the 
correlation vector g
{
}
:
k
i
J
i
g
th
=
≥
Input parameters:
V Φ
max(
)
i
i
th
g
α
=
Obtain support ˆΛ
k-1
_
ˆ
k
k
symmtry
J
J
Λ
∪
∪
ˆ
k
Λ
Fig. 5. Procedure of SwSOMP algorithm.
Support Recovery for Multiband Spectrum Sensing Based on MWC
151

Although the StOMP algorithm does not rely on the signal sparsity, but there is a
close relationship between the settings of selection threshold and observation matrix.
Threshold obtained in [17] is only for random Gaussian matrix, thus limits the
application of StOMP. On the other hand, the SwOMP algorithm has no strict
requirement for the observation matrix, and does not need to know the signal sparsity,
thus reduces the matching times, and improves the efﬁciency of the reconstruction. In
the corresponding MMV problem of MWC, compared to the SMV problem handled in
SwOMP, the one-dimensional sampling vector becomes two-dimensional sampling
matrix Y. The MWC reconstruction process with SwSOMP algorithm is shown in
Fig. 6.
The SwSOMP algorithm is a greedier approach for ﬁnding sparse solutions of
underdetermined system. It selects several new elements in each iteration. The algo-
rithm is described as Table 1. In Table 1, ej is the unit column vector of the jth element
that equals 1. The function of diag is to take the diagonal elements of the matrix.
Ksymmetry is the symmetric support bands. U^Kk is the sub-matrix of observation matrix,
and Um	L corresponds to the support band ^Kk.
( )
x t
⊗
⊗
⊗
1( )
x t
( )
ix t
( )
m
x
t
( )
h t
( )
h t
( )
h t
s
t
nT
=
s
t
nT
=
s
t
nT
=
Measurement 
matrix C
m L
×
. . .
. . .
. . .
Low pass filter
Reconstruct-
ion recovery 
algorithm
(SwSOMP)
( )
ip t
( )
m
p
t
1( )
p t
1[ ]
y n
[ ]
iy n
[ ]
m
y
n
1[ ]
z n
[ ]
Lz n
(a) MWC sub-Nyquist sampling
(b) CTF reconstruction
ˆ
ˆ
supp( ( ))
x t
Λ =
Fig. 6. MWC reconstruction process with SwSOMP.
152
Z. Hu et al.

4
Simulation Results and Discussion
In our simulation, the correct support recovery of MWC refers to the criteria of the
successful recovery in [8, 13], i.e., when the estimated support set ^K and real support
set K meets the condition ^K  K and U#^K is a full-rank matrix with columns. In order
to validate the effectiveness of the proposed algorithm, signals with Sinc waveforms are
Table 1. The reconstruction algorithm of support with SwSOMP
Support Recovery for Multiband Spectrum Sensing Based on MWC
153

used to carry out simulations, and we compare the performances of SOMP and
SwSOMP algorithms on the support recovery under different number of bands, sam-
pling channel numbers, and SNRs.
The sparse wideband analog signal with noise is generated by
xðtÞ ¼
X
N=2
i¼1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃ
EiBi
p
sinc Bi t  si
ð
Þ
ð
Þ cos 2pfi t  si
ð
Þ
ð
Þ þ nðtÞ
ð9Þ
In (9), Ei, Bi, fi and si represent energy factor, bandwidth, carrier frequency and
time offset of the produced ith signal, respectively. N represents the number of the
symmetric bands. nðtÞ is Gaussian white noise. The following procedure is repeated
500 times to calculate the percentage of correct support recovery.
(1) Generate the mixing signal piðtÞ randomly;
(2) Generate the carrier frequency fi in the interval ½fnyq=2; fnyq=2 randomly;
(3) Generate new Sinc signal according to fi;
(4) Using SOMP and SwSOMP respectively to estimate the support set and determine
whether it is correctly recovered.
4.1
Impact of the Weakness Parameters on the Support Recovery
In the simulations, the parameters of the signal are N ¼ 6 (3 pairs of symmetry),
Ei 2 f1; 2; 3g, Bi 2 f50; 50; 50g MHz, si 2 0:4; 0:7; 0:2
f
g ls, and carrier frequency fi
is randomly distributed in ½fnyq=2; fnyq=2, and fnyq ¼ 10 GHz. The MWC sampling
parameters are L0 ¼ 97, L ¼ 2L0 þ 1 ¼ 195, fs ¼ fp ¼ fnyq=L ¼ 51:28 MHz, and
m ¼ f15; 20; 25; 30; 35g. The reconstruction parameter is a 2 ð0; 1, and its initial
value is 0.1 with 0.1 as the increasing interval, and here Iters ¼ 10 because the iteration
times
of
SWOMP
has
nothing
to
do
with
the
signal
sparsity.
The
SNR ¼ f10; 20; 30g dB. N is the band number of the signal, and m is the number of the
MWC channels.
When a varies from 0.1 to 1, the percentage of correct support recovery is shown in
Fig. 7 under the different number of channels m and different SNR. It can be seen from
Fig. 7, SwSOMP algorithm performs best for the support recovery when a ¼ 0:9 for
the effective channel number. Therefore, a is set to 0.9 in the following experiments.
154
Z. Hu et al.

4.2
Impact of the Number of Sampling Channels on Support Recovery
The impact of the number of channels on the support recovery are investigated by using
SOMP and SwSOMP algorithm. Figure 8 shows the percentages of correct recovery
with SwSOMP and SOMP algorithms when the number of channels m is increased in
the interval ½15; 40, and other parameters are the same as in Sect. 4.1. It can be seen
from Fig. 8 that the performance of the recovery is improved by 12.4% when m ¼ 22
with SwSOMP algorithm compared to that with SOMP algorithm. When m ¼ 25, the
percentage of correct recovery reaches 90% using SwSOMP algorithm, while the
percentage of correct recovery can reach 90% when m ¼ 30 using SOMP algorithm.
Therefore, the SwSOMP algorithm can achieve higher reconstruction rate with less
number of channels, which can save the hardware cost. Since the number of channels is
directly related with the total sampling rate fR (fR ¼ mfs), SwSOMP algorithm can also
reduce the system sampling rate by using less number of channels.
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
alpha
Percentage recovered
Percentage of input signals recovered correctly(N=6,SNR=10)
m=15
m=20
m=25
m=30
m=35
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
alpha
Percentage recovered
Percentage of input signals recovered correctly(N=6,SNR=20)
m=15
m=20
m=25
m=30
m=35
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
alpha
Percentage recovered
Percentage of input signals recovered correctly(N=6,SNR=30)
m=15
m=20
m=25
m=30
m=35
Fig. 7. Impact of a on the support recovery.
Support Recovery for Multiband Spectrum Sensing Based on MWC
155

4.3
Impact of SNR on the Support Recovery
Now we consider about the impact of SNR on the support recovery by using two
algorithms. The values of SNR are taken from the interval ½6; 20, m ¼ 20; 25
f
g, other
parameters are the same as in Sect. 4.1. It can be seen from Fig. 9, when the number of
channels is 25, SwSOMP algorithm achieves better recovery than SOMP algorithm in
low SNR. When SNR = 6 dB and m ¼ 25, the correct reconstruction with SwSOMP
algorithm is improved 15% compared to that with SOMP algorithm. It can be seen that
the correct reconstruction rate with SwSOMP algorithms is better than SOMP algo-
rithm when the number of the channels is 20 and 25.
20
22
24
26
28
30
32
34
36
38
40
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
0.95
1
Sampling Channels(m)
Percentage recovered
Percentage of input signals recovered correctly(N=6,SNR=10)
SwSOMP
SOMP
Fig. 8. Impact of the number of sampling channels on support recovery.
6
8
10
12
14
16
18
20
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SNR
Percentage recovered
SwSOMP
SOMP
m=25
m=20
Fig. 9. Impact of SNR on the support recovery.
156
Z. Hu et al.

4.4
The Relationship Between the Number of Bands and the Support
Recovery
The effects of number of frequency bands (i.e. signal sparsity) on the support recovery
are investigated by using the two algorithms. The number of symmetric bands are taken
from the interval 2; 16
½
. The relevant parameters setting are as follows, SNR ¼ 15,
m ¼ 20; 25
f
g, Ei 2 f1; 2; 3; 4; 5; 6; 7; 8g, si 2 0:4; 0:7; 0:2; 0:9; 1:2; 1:5; 1:8; 2:1
f
g ls,
and settings of other parameters are the same as in Sect. 4.1. It can be seen from the
Fig. 10, when N\8, the SwSOMP algorithm has a better performance. However,
when N ¼ 8, the performance has a sharp decline. It almost loses the ability of
recovery when N  10. It is mainly due to the fact that the signal can no longer be
viewed as sparse signal under such circumstances. As a whole, SwSOMP algorithm
performs better than SOMP algorithm under the cases of different number of bands.
5
Conclusion
Aiming to improve the performance of sensing multiband sparse signal in practice, this
paper applies the SwSOMP algorithm to the CTF reconstruction block of MWC. The
SwSOMP algorithm ﬁrst obtains the largest matched inner-product value with the
residual, which multiplies with the weakness parameter, and then obtains the atomic
selection threshold. One or more atoms may be selected in each iteration, as a result of
which the accuracy of matching the most relevant atoms is improved. Furthermore, the
algorithm can reconstruct the support set of the signal blindly without knowing the
signal sparsity in advance. By simulation experiments, we investigated the performance
of SwSOMP algorithm in MWC and the impacting parameters. Compared with SOMP
algorithm, SwSOMP algorithm has shown its advantages to be used in MWC for
2
4
6
8
10
12
14
16
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
N
Percentage recovered
SwSOMP
SOMP
m=20
m=25
Fig. 10. The effects of number of signal bands on the support recovery.
Support Recovery for Multiband Spectrum Sensing Based on MWC
157

spectrum sensing on improving the percentage of correct recovery, reducing the
number of required sampling channels, and decreasing the total sampling rate of the
system.
Acknowledgments. This paper was supported by the National Natural Science Foundation of
China (Grant No. 61561017), Open Sub-project of State Key Laboratory of Marine Resource
Utilization in South China Sea (Grant No. 2016013B), Hainan Province Natural Science
Foundation of China (Grant No. 617033), Doctoral Candidate Excellent Dissertation Cultivating
Project of Hainan University, and Postgraduate Practice and Innovation Project of Hainan
University. Oriented Project of State Key Laboratory of Marine Resource Utilization in South
China Sea (Grant No. DX2017012).
References
1. Cohen, D., Akiva, A., Avraham, B., et al.: Centralized cooperative spectrum sensing from
sub-nyquist samples for cognitive radios. In: IEEE International Conference on Commu-
nications (ICC), pp. 8–12. IEEE Press, London (2015)
2. Walden, R.H.: Analog-to-digital converters and associated IC technologies. In: Proceedings
of IEEE Compound Semiconductor Integrated Circuits Symposium, pp. 1–2. IEEE Press,
Monterey (2008)
3. Candes, E.J., Wakin, M.B.: An introduction to compressive sampling. IEEE Signal Process.
Mag. 25(2), 21–30 (2008)
4. Healy, D., Brady, D.J.: Compression at the physical interface. IEEE Signal Process. Mag. 25
(2), 67–71 (2008)
5. Tropp, J.A., Laska, J.N., Duarte, M.F., et al.: Beyond Nyquist: efﬁcient sampling of sparse
band-limited signals. IEEE Trans. Inf. Theory 56(1), 520–544 (2010)
6. Harms, A., Bajwa, W.U., Calderbank, R.: A constrained random demodulator for
sub-Nyquist sampling. IEEE Trans. Signal Process. 61(3), 707–723 (2013)
7. Zhao, Y., Wang, H., Zhuang, X., et al.: Frequency domain sensing system using random
modulation pre-integrator. IET Sci. Meas. Technol. 7(3), 166–170 (2013)
8. Mishali, M., Eldar, Y.C.: From theory to practice: sub-Nyquist sampling of sparse wideband
analog signals. IEEE J. Sel. Top. Sign. Process. 4(2), 375–391 (2010)
9. Eldar, Y.C., Levi, R., Cohen, A.: Clutter removal in Sub-Nyquist radar. IEEE Signal
Process. Lett. 22(2), 177–181 (2015)
10. Lexa, M.A., Davies, M.E., Thompson, J.S.: Reconciling compressive sampling systems for
spectrally sparse continuous-time signals. IEEE Trans. Signal Process. 60(1), 155–171
(2012)
11. Shilian, Z., Xiaoniu, Y.: Wideband spectrum sensing in modulated wideband converter
based cognitive radio system. In: 11th International Symposium on Communications and
Information Technologies, pp. 114–119. IEEE Press, Hangzhou (2011)
12. Cohen, D., Akiva, A., Avraham, B., et al.: Distributed cooperative spectrum sensing from
Sub-Nyquist samples for cognitive radios. In: 16th International Workshop on Signal
Processing Advances in Wireless Communications (SPAWC), pp. 336–340. IEEE Press,
Stockholm (2015)
13. Mishali, M., Eldar, Y.C.: Blind multiband signal reconstruction: compressed sensing for
analog signals. IEEE Trans. Signal Process. 57(3), 993–1009 (2009)
14. Tropp, J.A., Gilbert, A.C., Strauss, M.J.: Algorithms for simultaneous sparse approximation.
Part I: greedy pursuit. Signal Process. 86(3), 572–588 (2006)
158
Z. Hu et al.

15. Chen, J., Huo, X.: Theoretical results on sparse representations of multiple-measurement
vectors. IEEE Trans. Signal Process. 54(12), 4634–4643 (2006)
16. Blumensath, T., Davies, M.E.: Stagewise weak gradient pursuits. IEEE Trans. Signal
Process. 57(11), 4333–4346 (2009)
17. Donoho, D.L., Tsaig, Y., Drori, I., et al.: Sparse solution of underdetermined systems of
linear equations by stagewise orthogonal matching pursuit. IEEE Trans. Inf. Theory 58(2),
1094–1121 (2012)
18. Yang, P., Fan, Y., Huang, Z.T., et al.: Single channel spectrum sensing technique based on
sub-Nyquist sampling. J. Natl. Univ. Defense Technol. 35(4), 121–127 (2013)
19. Landau, H.J.: Necessary density conditions for sampling and interpolation of certain entire
functions. Acta Math. 117, 37–52 (1967)
Support Recovery for Multiband Spectrum Sensing Based on MWC
159

Trafﬁc Scheduling Algorithms for OFDM
Based Radio Systems
Liang Li1(&), Yirong Wang2, Hao Zhang3, Zhaoyan Qu1,
Siyuan Zhang1, Yu Zhang1, and Xiongwen Zhao1
1 North China Electric Power University, Beijing 102206, China
liliang2587@163.com, faszh@yeah.net
2 Guodiantong Corporation, State Grid Information
and Telecommunications Group, Beijing 100070, China
wangyirong@sgitg.sgcc.com.cn
3 State Grid Shandong Electric Power Corporation,
Economic and Technical Research Institute, Jinan 257000, Shandong, China
Abstract. In this paper, trafﬁc scheduler for OFDM based radio system is
studied in detail according to the trafﬁc classes and Round-Robin (RR) series
algorithms. The quantum, quanta and weights for the weighted deﬁcit RR
(WDRR) in downlink, and the basic quantity, quantity, weights for the weighted
RR (WRR) in uplink are derived, respectively. The comprehensive trafﬁc
scheduler and algorithms are offered for the OFDM based radio systems.
Keywords: Trafﬁc scheduling  OFDM  RR  DRR  WRR  WDRR
1
Introduction
Trafﬁc scheduling algorithms for OFDM based radio systems, such as WLAN, LTE
and WiMAX etc. is of importance in mobile wireless communication systems, and
scheduling is also important in 5G networks [1, 2]. In the MAC layer, a very important
issue is how to schedule the MAC protocol data units (MPDUs), and then complete to
ﬁll the created downlink (DL) and uplink (UL) frames. A large number of trafﬁc
scheduling algorithms for wireline networks have been proposed in the literature [3].
However, these algorithms cannot be directly applied to wireless networks because of
fundamental differences between these two types of networks. For OFDM based
scheduling
algorithms,
e.g. Round-Robin (RR),
WRR (Weighted
RR),
DRR
(Deﬁcit RR), DWRR (Deﬁcit-Weighted RR), and proportional fair (PF) etc. are
introduced [3–9], the proportional fair scheduler is of interest in LTE and WiMAX.
However, the main drawbacks of the scheduler are that the algorithms assume there are
inﬁnite packets to be transmitted at time zero and no packet arrivals, which is not a
real-time scheduler. Moreover, the proportional fair scheduling algorithms are com-
plicated to be implemented in practical applications. The criteria for selecting
scheduling algorithms for OFDM based radio systems are: QoS requirement and simple
to be implemented. Round-Robin scheduler can be unfair if different ﬂows have dif-
ferent packet sizes. The DWRR and WRR are the improved Round-Robin family
schedulers which can meet both of the criteria mentioned above. In this paper, the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 160–169, 2018.
https://doi.org/10.1007/978-3-319-72823-0_16

explicit values of the weights for the DWRR and WRR are derived for the DL and UL.
The basic quantum and quanta for the trafﬁc in the DL, the basic quantity, the quantities
of scheduled trafﬁc for the UL are studied and offered. The priority scheduler, the
DWRR and WRR scheduling algorithms, and the parameters introduced for using the
algorithms have clear physical meanings and also easy to be implemented.
2
Trafﬁc Scheduler for OFDM Based Radio Systems
The scheduler for OFDM based radio systems consists of ﬁve classes of trafﬁc in
common, namely, UGS (unsolicited grant), ertPS (extended real-time polling), rtPS
(real-time polling), nrtPS (non-real-time polling), and BE (best effort) services. UGS
can be a CBR (Constant Bit Rate) application, e.g. VoIP (Voice over IP) or video
conference. ertPS/rtPS/nrtPS/BE can be, e.g. VoIP (Voice over IP) with VAD (Voice
Activity Detection)/video and audio streaming (VAS)/FTP (File Transfer Protocol)/
web browsing http applications. The aforementioned trafﬁc classes are for mobile
WiMAX, but they can be also applied to WLAN and LTE and other OFDM based
radio systems.
The diagram of the scheduler is shown in Fig. 1. We use the priority scheduler for
the prioritized trafﬁc. The priority orders of the trafﬁc classes are: (i) MAC management
& control messages, (H)ARQ [(hybrid) Automatic Repeat-reQuest)], (N)ACKs [(Non)
Acknowledgements] and re-transmission, (ii) UGS, (iii) ertPS, (iv) rtPS, (v) nrtPS, and
(vi) BE. We schedule (i) (ii) (iii) trafﬁc when they are available, then the trafﬁc in items
(iv)–(vi) classes are scheduled by using DWRR (Deﬁcit Weighted Round-Robin) and
WRR (Weighted Round-Robin) algorithms for the DL and UL, respectively. In this
paper, we take the joint trafﬁc applications of the rtPS and nrtPS and give the weights
and the scheduled trafﬁc. The key reason is that both rtPS and nrtPS trafﬁc have the
Fig. 1. Trafﬁc scheduler for OFDM based radio systems.
Trafﬁc Scheduling Algorithms for OFDM Based Radio Systems
161

bandwidth requirement. After scheduling items (i)–(iii) trafﬁc, if not enough bandwidth
as required in the rtPS and nrtPS trafﬁc, then both should share the available band-
width. Therefore, when implementing the DWRR and WRR, their weights and the
quantity of scheduled trafﬁc are independent. After this step, the rtPS trafﬁc is
scheduled ﬁrst due to its sensitive to delay. The weights for the DWRR and WRR for
the DL and UL, the basic quantum, quanta for the DL trafﬁc, and the basic quantity,
quantities of scheduled trafﬁc for the UL will be studied in detail in Sects. 3 and 4.
3
The Basic Quantum, Quanta and Weights for the DL
Trafﬁc Applications
Assume that the rtPS, nrtPS, and BE trafﬁc classes can have different applications, e.g.
rtPS class can have video conference, streaming video, streaming audio, and
broad-casting etc. These applications can have different minimum reserved trafﬁc rates
fMRTRigrtPS, and maximum sustained trafﬁc rates fMSTRigrtPS, where i means a
speciﬁc application for rtPS class, and {} means the assemble of applications. Same as
in nrtPS trafﬁc class, the applications (e.g. FTP, web browsing, P2P, large media
downloads etc.) can have fMRTRignrtPS and fMSTRignrtPS as well. For the applications
(e.g. small scale data transfer, web browsing etc.) in BE class, they’re with fMSTRig
but without fMRTRig. In the following discussions, we merge the applications of the
rtPS and nrtPS classes and denote their MRTR and MSTR assembles as fMRTRig and
fMSTRig by removing the trafﬁc classes in the subscripts. Within an application, all the
ﬂows (or users) have the same MSTR and MRTR, and the MSTR of an application is
greater than its MRTR. The MSTR and MRTR can be the operation and management
(O&M) parameters and will be decided by network operators or the agreed parameters
between operators and the users.
(a) Joint trafﬁc applications for rtPS and nrtPS
DWRR in principle is very similar as DRR, a quantum is needed ﬁrst to schedule a
trafﬁc ﬂow. In this paper, we deﬁne a basic quantum and weights for the applications
when implementing the DWRR. Using the weights and deﬁned basic quantum, we can
get the quanta for the trafﬁc ﬂows included in the applications, and further to imple-
ment the DWRR algorithms. For joint applications of rtPS and nrtPS, the basic
quantum (in slots) is deﬁned by using both of the MRTR and MSTR of the
applications.
QB ¼
P
i
ðMSTRi þ MRTRiÞ=2  Tframe
8  S
¼ 1
2
X
i
Qi;min þ
X
i
Qi;max
 
!
ð1Þ
where Tframe is the frame period in ms, and S is the slot size in bytes, which depends on
the modulation and coding schemes (MCSs) and listed in Table 1.
162
L. Li et al.

In (1), MSTR is in Kbps. The basic quantum is deﬁned for a frame, and the trafﬁc is
scheduled frame by frame. Qi;min and Qi;max are the minimum and maximum quanta for
application i and can be calculated as follows
Qi;min ¼ MRTRi  Tframe
8  S
ð2Þ
Qi;max ¼ MSTRi  Tframe
8  S
ð3Þ
The weights of DWRR can be deﬁned and calculated as
Wi ¼
MSTRi
P
i
MSTRi
ð4Þ
In (4), the weights have been normalized. The larger the MSTR, the larger the
weight for an application. The weight deﬁned in (4) is fair regarding of each appli-
cation. We deﬁne the quantum for application i as
Qi ¼ QB  Wi
ð5Þ
From (1), it’s seen that if the application types and the corresponding MSTRs and
MRTRs are pre-decided, the basic quantum QB is ﬁxed. The quantum for a speciﬁc
application i is deﬁned and calculated as a product of the basic quantum and its weight,
which means that when an application with a larger weight, then it can have larger
quantum. Qi shown in (5) generally is larger than Qi;min, but less than Qi;max, namely
Qi;min  Qi  Qi;max. Let’s start prove this inequality. From (1), when using Qi;max
instead of Qi;min
QB ¼ 1
2
X
i
Qi;min þ
X
i
Qi;max
 
!
 1
2
X
i
Qi;max þ
X
i
Qi;max
 
!
¼
X
i
Qi;max
ð6Þ
Table 1. Slot sizes for different MCSs in WiMAX
Modulation
QPSK QPSK 16QAM 16QAM 64QAM 64QAM 64QAM
Coding rate
1/2
3/4
1/2
3/4
1/2
2/3
3/4
Slot size/Bytes 6
9
12
18
18
24
27
Trafﬁc Scheduling Algorithms for OFDM Based Radio Systems
163

From (4), (5) and (6), we can get
Qi ¼QB  Wi 
X
i
Qi;max 
MSTRi
P
i
MSTRi
¼
P
i
MSTRi  Tframe
8  S

MSTRi
P
i
MSTRi
¼ MSTRi  Tframe
8  S
¼Qi;max
ð7Þ
which means that Qi  Qi;max. In (1), when using Qi;min instead of Qi;max, we can get
QB ¼ 1
2
X
i
Qi;min þ
X
i
Qi;max
 
!
 1
2
X
i
Qi;min þ
X
i
Qi;max
 
!
¼
X
i
Qi;min
ð8Þ
From (4), (5) and (8), we can have
Qi ¼QB  Wi 
X
i
Qi;min 
MSTRi
P
i
MSTRi
¼
P
i
MRTRi  Tframe
8  S

MSTRi
P
i
MSTRi
¼ C
ð9Þ
Because of MRTRi  MSTRi, and
P
i
MRTRi
P
i
MSTRi  1, from (9), we can get
C 
P
i
MRTRi
P
i
MSTRi
MRTRi  Tframe
8  S
 MRTRi  Tframe
8  S
¼ Qi;min
ð10Þ
From (9) and (10), Qi  C and Qi;min  C, which means that Qi can be either larger
or smaller than Qi;min. However, if the weight in (4) can also be deﬁned by the MRTR
(We expected that this can be happen due to when an application with larger MSTR,
then it’s with larger MRTR as well, so the weights can be kept as constant), then
164
L. Li et al.

Wi ¼
MRTRi
P
i
MRTRi
¼
MSTRi
P
i
MSTRi
ð11Þ
In such a case, from (5), (8), and (11)
Qi ¼ QB  Wi 
X
i
Qi;min 
MRTRi
P
i
MRTRi
ð12Þ
¼
P
i
MRTRi  Tframe
8  S

MRTRi
P
i
MRTRi
¼ MRTRi  Tframe
8  S
¼ Qi;min
It means that Qi  Qi;min, then the inequality of Qi;min  Qi  Qi;max keeps. The
equal sign can be taken when Qi;min ¼ Qi;max by assuming that the MRTR is equal to
the MSTR. From the results of the above discussions, we can get the following
conclusions:
①The inequality Qi;min  Qi  Qi;max is true when the weight can be deﬁned and
calculated by Eq. (11).
②In this paper, we deﬁne the weight by Eq. (4), then the quantum Qi can be either
larger or smaller than Qi;min.
In conclusion ②, when Qi  Qi;min, we should assign the quantum Qi as Qi;min so
that it can guarantee the requirement of the minimum reserved trafﬁc rate of the
application. The general quantum can be expressed as follows when taking into con-
sideration of (5)
Qi ¼
QB  Wi;
Qimin\QB  Wi
Qimin;
otherwise
(
ð13Þ
(b) Demonstration examples
For joint applications of the rtPS and nrtPS trafﬁc classes, assume the {MSTR} are
within 10 Kbps–2 Mbps, and we have six applications with {MSTR} = {10 100 300
600 1000 2000} in Kbps. The frame period is 5 ms, and the QPSK(1/2) MCS is applied
with slot size of 6 bytes.
Example 1:
Let MRTR = {5 50 150 300 500 1000}. For each application, the
MRTR is taken as the half of its MSTR. The purpose is that the same
weights can be remained by using either the MSTRs or the MRTRs
deﬁned in (11). The results are shown in Fig. 2(a) which shows that
Qi;min\Qi\Qi;max. The basic quantum QB in this case is about 313 slots
(1878 bytes).
Trafﬁc Scheduling Algorithms for OFDM Based Radio Systems
165

Example 2:
Let MRTR = {5 80 200 400 600 1800}. For every application, the
MRTR is taken randomly a smaller value than the corresponding MSTR.
The results are shown in Fig. 2(b). It shows that Qi is less than Qi;max.
However, it cannot always keep that Qi;min is less than Qi. The basic
quantum QB is about 370 slots (2220 bytes).
Fig. 2. Quanta relationships among Qi;min, Qi and Qi;max. (a) The same weights can be deﬁned
by either the MSTRs or the MRTRs as in (11). (b) The weights are deﬁned only by the MSTRs as
in (4).
166
L. Li et al.

(c) Trafﬁc applications for BE class
For BE applications, there are no fMRTRig QoS parameters, the basic quantum can
be calculated by the fMSTRig. The basic quantum in (1) now is changed as
QB ¼
P
i
MSTRi  Tframe
8  S
ð14Þ
Using (14) and the weights deﬁned in (4). Then the quantum for application i is
Qi ¼ QB  Wi ¼
P
i
MSTRi  Tframe
8  S

MSTRi
P
i
MSTRi
¼ MSTRi  Tframe
8  S
¼ Qi;max
ð15Þ
which means that the ﬂows (or users) within an application, e.g. web browsing, will
contend the available bandwidth. Once the contention is successful, then the trafﬁc can
be scheduled based on its MSTR. BE trafﬁc has no QoS requirement and the MSTR is
the only parameter available for scheduling the trafﬁc. Figure 3 shows the ﬂowchart of
how the quanta and weights are deﬁned and calculated in Sect. 3 as a summary.
Fig. 3. The quanta and weights for the DL trafﬁc applications using DWRR
Trafﬁc Scheduling Algorithms for OFDM Based Radio Systems
167

4
Basic Quantity, Quantity of Scheduled Trafﬁc and Weights
for the UL Trafﬁc
For the UL scheduling, the priority orders of the trafﬁc classes are the same as in the
DL. The difference is that in the UL we use WRR to schedule rtPS, nrtPS and BR
trafﬁc. For a speciﬁc application in the DL, the quantum Qi and weight Wi are needed
when implementing DWRR. While implementing the WRR algorithms in the UL, we
need to know the weight and also the scheduled quantity of trafﬁc for an application in
a frame. For the WRR scheduling algorithm, it has no quantum concept, however we
can use the scheduled quantity of trafﬁc X instead of quantum Q in Sect. 3, then all the
equations for the DL scheduling can be applied to the UL case. The speciﬁc
replacements are as follows: we use the basic scheduled trafﬁc XB to replace of the
basic quantum QB, use scheduled trafﬁc Xi to replace the quantum Qi, use the minimum
and maximum scheduled trafﬁc Xi;min and Xi;max for application i to replace the mini-
mum and maximum quanta Qi;min and Qi;max, respectively. Then we can get the cor-
responding formulas for scheduling the UL trafﬁc as well for WRR.
5
Conclusion
The priority scheduler in this paper clearly shows that what kind of trafﬁc class should
be scheduled ﬁrst for OFDM based radio systems. It can meet the QoS requirements
both in throughput and delay. The DWRR and WRR algorithms are used further to
schedule the rtPS, nrtPS and BE trafﬁc in the DL and UL, respectively. DWRR and
WRR have very clear physical meanings, they are straight forward algorithms to be
implemented and are also very efﬁcient scheduling algorithms. Moreover, we devel-
oped the basic quantum, quanta and weights for the applications in the DL by using
WDRR as well as the basic quantity, the quantity of scheduled trafﬁc, and the weights
for the UL by using WRR for OFDM based system, such as mobile WiMAX.
Acknowledgement. This work is supported by the Department of Science and Technology,
State Grid, China.
References
1. Zhang, H., Dong, Y., Cheng, J., Hossain, M., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
2. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
3. Zhang, H.: Service disciplines for guaranteed performance service in packet-switching
networks. Proc. IEEE 83, 1374–1396 (1995)
4. Fattah, H., Leung, C.: An overview of scheduling algorithms in Wireless Multimedia
Networks. IEEE Wirel. Commun. 9(5), 76–83 (2002)
168
L. Li et al.

5. Chaskar, H.M., Malhow, U.: Fair scheduling with tunable latency: a Round-Robin approach.
IEEE/ACM Trans. Netw. 11(4), 592–601 (2003)
6. Shreedhar, M., Varghese, G.: Efﬁcient fair queuing using deﬁcit Round-Robin. IEEE/ACM
Trans. Netw. 4(3), 375–385 (1996)
7. Cicconeti, C., et al.: Quality of service support in IEEE 802.16 networks. IEEE Netw. 20(2),
50–55 (2006)
8. Sayenko, A., et al.: Ensuring the QoS requirements in 802.16 scheduling. In: Proceedings of
the ACM/IEEE International Symposium on Modeling, Analysis and Simulation of Wireless
and Mobile Systems (2006)
9. Veselinovic, N., Zhao, X., Casey, T., Nurmi, J.: Quality of experience in IEEE 802.16e. In:
Proceedings of the 11th International Symposium on Wireless Personal Multimedia
Communications (2008)
10. So-In, C., Jain, R., Tamimi, A.-K.: Scheduling in IEEE 802.16e mobile WiMAX networks:
key issues and a survey. IEEE J. Sel. Areas Commun. 27(2), 156–171 (2009)
11. Huang, C.-Y., Juan, H.-H., Lin, M.-S., Chang, C.-J.: Radio resource management of
heterogeneous services in mobile WiMAX systems. IEEE Wirel. Commun. 14(1), 20–26
(2007)
12. Esmailpour, A., Nasser, N.: Dynamic QoS-based bandwidth allocation framework for
broadband wireless networks. IEEE Trans. Veh. Technol. 60(6), 2690–2700 (2011)
13. Kang, X., Wang, W., Jaramillo, J.-J., Ying, L.: On the performance of largest-deﬁcit-ﬁrst for
scheduling real-time trafﬁc in wireless networks. IEEE/ACM Trans. Netw. 24(1), 72–84
(2016)
14. Mehrjoo, M., Awad, M.K., Dianati, M., Shen, X.: Design of fair weights for heterogeneous
trafﬁc scheduling in multichannel wireless networks. IEEE Trans. Commun. 58(10), 2892–
2902 (2010)
15. Zheng, Q., Zheng, K., Zhang, H., Leung, V.C.M.: Delay-optimal virtualized radio resource
scheduling in software-deﬁned vehicular networks via stochastic learning. IEEE Trans. Veh.
Technol. 65(10), 7857–7867 (2016)
16. Ma, W., Zhang, H., Zheng, W., Wen, X., Lu, Z.: A novel QoS guaranteed cross-layer
scheduling
scheme
for
downlink
multiuser
OFDM
systems.
In:
Proceedings
of
IEEE ICOEIS (2012)
17. Ma, W., Zhang, H., Wen, X., Zheng, W., Lu, Z.: Utility-based cross-layer multiple trafﬁc
scheduling for MU-OFDMA. Adv. Inf. Sci. Serv. Sci. 3(8), 122–131 (2011)
18. Han, B., Zhao, S., Yang, B., Zhang, H., Chen, P., Yang, F.: Historical PMI based multi-user
scheduling for FDD massive MIMO systems. In: Proceedings of the IEEE Vehicular
Technology Conference (VTC), Nanjing, 15–18 May 2016
19. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allocation in
spectrum-sharing OFDMA Femtocells with heterogeneous services. IEEE Trans. Commun.
62(7), 2366–2377 (2014)
20. Zhang, H., Jiang, C., Mao, X., Chen, H.-H.: Interference-limit resource optimization in
cognitive Femtocells with fairness and imperfect spectrum sensing. IEEE Trans. Veh.
Technol. 65(3), 1761–1771 (2016)
Trafﬁc Scheduling Algorithms for OFDM Based Radio Systems
169

Coverage Performance in Cognitive Radio
Networks with Self-sustained Secondary
Transmitters
Xiaoshi Song(B), Xiangbo Meng, Yuting Geng, Ning Ye, and Jun Liu
Northeastern University, Shenyang 110819, China
songxiaoshi@cse.neu.edu.cn
Abstract. In this paper, we investigate the opportunistic spectrum
access (OSA) of self-sustained secondary transmitters (STs) in cogni-
tive radio (CR) network to improve both the spectral eﬃciency and
energy eﬃciency. Particularly, by utilizing energy harvesting, the STs are
assumed to be able to collect and store ambient powers for data trans-
mission. An energy harvesting based OSA protocol, namely the EH-PRA
protocol, is considered, under which a ST is eventually allowed to launch
the transmission only if its battery level is larger than the transmit power
and the estimated interference perceived at the active primary receivers
(PRs) is lower than a threshold Nra. Given that the battery capacity of
STs is inﬁnite, we derive the transmission probability of STs. We then
characterize the coverage performance of the CR network. Finally, sim-
ulation results are provided for the validation of our analysis.
Keywords: Cognitive radio network · Energy harvesting
Opportunistic spectrum access · Stochastic geometry
Transmission probabilty · Coverage probability · Spatial throughput
1
Introduction
Energy harvesting [1–5], widely believed as a promising solution of power gener-
ation for next generation wireless networks, has attracted tremendous interests
over recent years. By utilizing energy harvesting as energy sources for wireless
networks, the corresponding energy costs as well as the adverse eﬀects to the
environment can be signiﬁcantly reduced. Further, the wireless networks pow-
ered by energy harvesting can be ﬂexibly deployed without the need of power
grid [6].
In addition to energy eﬃciency, spectral eﬃciency is another important issue
in mobile networking. Particularly, how to eﬀectively exploiting the underutilized
spectrum resources in mobile networks is consider to be the key challenges for
the enhancement of spectral eﬃciency [7,8]. To address this issue, technologies of
CR [9,10] based OSA [11–13] are proposed such that the under-utilized spectrum
of the primary network can be eﬀectively reused by the secondary network.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 170–181, 2018.
https://doi.org/10.1007/978-3-319-72823-0_17

Coverage Performance in Cognitive Radio Networks
171
In this paper, to simultaneously improve the energy eﬃciency and spectral
eﬃciency of the mobile networks [15–17], the energy harvesting based OSA is
investigated under the CR paradigm. Particularly, with energy harvesting, the
STs become self-sustained. The energy eﬃciency of the CR network is thereby
signiﬁcantly improved. On the other hand, thanks to the OSA of STs, the spec-
tral eﬃciency of the CR network can also be improved.
Energy harvesting powered CR networks has been widely studied over recent
years [18–24]. In [18], assuming perfect spectrum sensing, the myopic spectrum
access policy was studied to maximize the throughput of self-sustained STs pow-
ered by energy harvesting. Further, in [19,20], Park et al. evaluated the eﬀect of
sensing error and temporal correlation of the primary traﬃc on the throughput
of CR network. In [21], Pappas et al. investigated the maximum stable through-
put region for CR networks with self-sustained primary transmitters (PTs). In
[22], Yin et al. optimized the cooperation strategy of self-sustained STs to max-
imize the achievable throughput of the CR network. Further, in [23], with STs
powered by energy harvesting, Yin et al. proposed a generalized multi-slot spec-
trum sensing strategy which jointly optimized the save-ratio, sensing duration,
sensing threshold as well as fusion rule to protect the primary transmissions. In
[24], Chung et al. maximized the average throughput of the energy harvesting
powered CR network by optimizing the sensing duration and energy detectors
sensing threshold of STs. It is worth noting that [18–24] do not consider the
impact of the locations of PTs and STs on the performance of the CR network.
In this paper, diﬀerent from [18–24], we consider the CR networks powered
by energy harvesting with Poisson distributed PTs and STs. By applying energy
harvesting, the STs are assumed to be able to collect and store ambient pow-
ers for data transmissions. Given suﬃcient energy stored in the batteries, the
corresponding STs (denoted by eligible STs) are then allowed to launch the
transmissions only if its estimated inference perceived at the active PRs is lower
than a predeﬁned threshold Nra. We call this kind of OSA protocol as the energy
harvesting based PRA protocol. Given that the battery capacity of STs is inﬁ-
nite, we derive the transmission probability for secondary network. We then
characterize the coverage probability of the primary and secondary networks.
Finally, simulation results are provided for the validation of our analysis.
2
System Model
We studied a CR network on R2. The PTs have higher priority for utilizing
the spectrum, while the STs can only opportunistically access the spectrum by
exploiting the spatial holes of the primary network. The PTs and STs are mod-
eled by two independent HPPPs with intensities given by μ0 and λ0, respectively.
For each PT, its associated PR is at a distance of dp away in a random direction.
Similarly, for each ST, its associated SR is at a distance of ds away in a random
direction. As such, the PRs and SRs also follow two independent HPPPs with
their respective intensities given by μ0 and λ0.
With energy harvesting, the STs are assumed to be able to collect and store
ambient powers for data transmissions. Particularly, the energy harvested by the

172
X. Song et al.
ST located at position y ∈R2 in the t-th time slot is modeled by a nonnegative
random variable Zs
t (y) as
E

Zs
t (y)

= νs
e,
(1)
Var

Zs
t (x)

= δs
e.
(2)
Further, it is assumed that the PTs, PRs and SRs are powered by reliable energy
sources.
For the primary network, the PTs independently access the spectrum with
probability ρp [27]. For the secondary network, the EH-PRA protocol is applied,
under which a ST is allowed to transmit only if the battery level is larger than
the transmit power Ps and the spatial spectrum hole of the primary network is
detected.
Let Bs denote the battery capacities for STs. Further, let Pp and Ps be the
transmit powers of PTs and STs. Then, given Ss
t (y) as the battery level of ST
located at positions y ∈R2 in the t-th slot, it can be obtained that
Ss
t (y) = min

Ss
t−1(y) + Zs
t (y) −Ps · Gs
t , Bs

,
(3)
where
Gs
t = 1Ss
t−1(y)≥Ps · 1M ra
t
(y)≤Nra,
(4)
1A denotes the indicator function with respect to event A.
For the primary network, the locations of active PTs/PRs follow a HPPP
with density μp = μ0pp. For the secondary network, under the energy harvesting
based PRA protocol, the density of the point process formed by the active STs
in the t-th time slot is given by μs
t = ηs
t λ0, where
ηs
t = E

1Ss
t−1(y)≥Ps · 1M ra
t
(y)≤Nra

.
(5)
The propagation channel is modeled by
l(r) = h · r−α,
(6)
where h denotes the exponentially distributed small-scale Rayleigh fading with
unit mean, r denotes the transmission distance, and α denotes the path-loss
exponent [30]. The SIR targets for primary and secondary networks are denoted
by θp and θs, respectively.
3
Transmission Probability with Inﬁnite Battery
Capacity
In this section, assuming inﬁnite battery capacity for STs, we derive the cor-
responding transmission probabilities ηs. Particularly, based on (3), by letting
B →∞, it can be easily obtained that
Ss
t (y) = Ss
t−1(y) + Zs
t (y) −Ps · Gs
t .
(7)
where Gs
t are deﬁned in (4), respectively. Then, based on (5), we characterize
the transmission probability ηs of STs in the following theorems.

Coverage Performance in Cognitive Radio Networks
173
Theorem 1. For CR network with self-sustained STs, assuming inﬁnite battery
capacity and under the EH-PRA protocol, ηs is given by
ηs = min

Qra, νs
e
Ps

.
(8)
where
Qra = exp

−2πμp
Γ( 2
α)( Pp
Nra )
2
α
α
	
.
(9)
Proof. The proof is omitted due to space limitation.
Remark 3.1. Based on Theorem 1, the intensity of the point process formed by
active STs can be immediately obtained as
λs = min

λ0Qra, λ0
νs
e
Ps

.
(10)
4
Coverage Probability in Primary Network with Inﬁnity
Battery Capacity
4.1
Conditional Distribution of Active STs
To derive the coverage probability of primary transmission, we focus on a typical
PR Rp at the origin with its associated PT Tp at a distance of dp away in random
direction. Then, by Slivnyak’s theorem [35], it can be easily veriﬁed that the
rest of the active PRs/PTs follow a HPPP with intensity μp. For the secondary
network, we denote ΦRp
ra (u) as the point process formed by the active STs on a
circle of radius u centered at Rp. Then, we derive the conditional distribution
of the active STs in the following lemma.
Lemma 1. For CR network with self-sustained STs, assuming inﬁnite battery
capacity and under the EH-PRA protocol, ΦRp
ra (u) is isotropic with respect to Rp
and its intensity λRp
ra (u) is given by
λRp
ra (u) = min

λ0QraP(u), λ0
νs
e
Ps

,
(11)
where
P(u) =

1 −e−Nrauα
Pp

.
(12)
Proof. The proof is omitted due to space limitation.
It is worth noting that under the EH-PRA protocol, ΦRp
ra (u) does not follow
a HPPP. Then, due to the fact that the higher order statistics of ΦRp
ra (u) are
intractable, the coverage performance of the primary network is diﬃcult to be
completely characterized. To address this issue, similar to [13,36–39], we make
the following approximation on ΦRp
ra (u).

174
X. Song et al.
Assumption 1. ΦRp
ra (u) follows a HPPP with intensity given by λRp
ra (u).
Under Assumption 1, we then characterize the coverage performance of the
primary network in the following subsection.
4.2
Coverage Probability with Energy Harvesting Based PRA
Protocol
Theorem 2. For CR network with self-sustained STs, under Assumption 1, the
coverage probability of the primary network is given by
τ ra
p
= exp

−
2π2
α sin

 2π
α
θ
2
α
p d2
pμp
	
× exp

−2πλ0Qra
 ζ
0
(1 −ϱ(u)) P(u)udu
	
× exp

−2πλ0
νs
e
Ps
 ∞
ζ
(1 −ϱ(u)) udu

.
(13)
where
ζ =

−Pp
Nra
ln

1 −ηs
Qra
 1
α
,
and
ϱ(u) =

Nrauα
Pp
0
e
−
θpPsgu−α
Ppd−α
p
×
e−g
1 −e−−Nrauα
Pp
dg.
Proof. See Appendix A.
5
Coverage Probability in Secondary Network with
Inﬁnity Battery Capacity
5.1
Conditional Distributions of Active PTs and STs
To derive the coverage probability of the secondary network, we focus on a
typical SR Rs at the origin with its associated ST Ts at a distance of ds away
in random direction. Let Ψ Ts
ra (r) be the point process formed by the active PRs
on a circle of radius r centered at Ts under the ER-PRA protocol. Then, Ψ Ts
ra (r)
is characterized as follows.
Lemma 2. For CR network with self-sustained STs, under the ER-PRA proto-
col, Ψ Ts
ra (r) follows a HPPP with intensity ψTs
ra (r) given by
ψTs
ra (r) = μ0ρpP(r),
(14)
where
P(r) =

1 −e−Nrarα
Pp

.
(15)

Coverage Performance in Cognitive Radio Networks
175
Proof. Based on Lemma 5.1 in [13], it can be easily veriﬁed that Ψ Ts
ra (r) follows
a HPPP with density ψTs
ra (r) as given by (14).
Let Υ Ts
ra (r) be the point process formed by the active PTs on a circle of radius
r centered at Ts under the ER-PRA protocol. Then, with Lemma 2,Υ Ts
ra (r) is
derived in the following lemma.
Lemma 3. For CR network with self-sustained STs, under the ER-PRA proto-
col, Υ Ts
ra (r) follows a HPPP with intensity μTs
ra (r), which is upper-bounded by
μTs
ra (r) ≤μ0ρpP(r + dp).
(16)
Proof. Based on Lemma 2, it can be easily veriﬁed that Υ Ts
ra (r) follows a HPPP
and the upper bound on μTs
ra (r) is given by ψTs
ra (r + dp).
For the secondary network, we denote ΦTs
ra (r) as the point process formed by
the active STs on a circle of radius r centered at Ts under the energy harvesting
based PRA protocol. Then, with Lemma 2, the conditional distribution of ΦTs
ra (r)
under the energy harvesting based PRA protocol is characterized as follows.
Lemma 4. For an overlay CR network with self-sustained STs, under the
energy harvesting based PRA protocol, conditioned on a typical SR at the origin,
ΦTs
ra (r) is isotropic around Ts, and the corresponding density, denoted by λTs
ra (r),
is bounded by
K ≤λTs
ra (r) ≤D,
(17)
where
D = min

λ0βra, λ0
νs
e
Ps

,
K = min

λ0Qra, λ0
νs
e
Ps

,
and
βra = exp

−2π
 ∞
0
e−Nrarα
Pp
μTs
ra (r)rdr

.
(18)
Proof. Based on Lemma 5.3 in [13], (17) is immediately obtained. This thus
completes the proof of Lemma 4.
It is worth noting that under the ER-PRA protocol, similar to the primary
network case, ΦTs
ra (r) or does not follow a HPPP. As such, the coverage proba-
bility of the secondary network under the energy harvesting based PRA protocol
is diﬃcult to be derived. To tackle this diﬃculty, we make the following approx-
imation on ΦTs
ra (r).
Assumption 2. Under the ER-PRA protocol, ΦTs
ra (r) follows a HPPP with
intensity λTs
ra (r).

176
X. Song et al.
With Assumption 2, we then derive the coverage probability of the secondary
network under the ER-PRA protocol in the following subsection.
5.2
Coverage Probability with PRA Protocol
Under the energy harvesting based PRA protocol, we denote Υ Rs
ra (u) as the point
process formed by the active PTs on a circle of radius u centered at Rs. Then,
based on Lemma 3, it can be easily veriﬁed that Υ Rs
ra (u) does not follow a HPPP.
Let μRs
ra (u) be the average density of Υ Rs
ra (u). Then, we characterize μRs
ra (u) in
the following lemma.
Lemma 5. Under the ER-PRA protocol, μRs
ra (u) is upper bounded by
μRs
ra (u) ≤μ0ρpP(u + dp + ds).
(19)
Proof. Based on Lemma 3, it can be easily veriﬁed that the highest density of
μRs
ra (u) is μTs
ra (u + ds).
Based on Lemma 5, we then derive the coverage probability of the secondary
network under the ER-PRA protocol in the following theorem.
Theorem 3. For CR network with self-sustained STs, under the ER-PRA pro-
tocol, based on Assumption 2, the coverage probability of the secondary network
is lower-bounded by
τ ra
s
≥exp

−
2π2
α sin

 2π
α
θ
2
α
s d2
sD
	
× exp
⎧
⎨
⎩−2πμ0ρp
 ∞
0
⎛
⎝1 −e−
Nra(u+dp+ds)α
Pp
1 +
Psuα
θsPpdα
s
⎞
⎠udu
⎫
⎬
⎭,
(20)
Proof. By applying Lemmas 4 and 5, (20) is readily obtained.
6
Numerical Results
In this section, simulation results are provided to validate our analytical results.
Throughout this section, unless speciﬁed otherwise, we set μp = 0.1, λ0 = 0.1,
Pp = 5, Ps = 2, dp = ds = 1, θp = θs = 3, and α = 4.
Figure 1 plots the analytical and simulation results on the transmission prob-
ability of the STs versus μp under the EH-PRA protocol. It is observed that the
transmission probability of STs under the EH-PRA protocol are piecewise func-
tions with μp, which are intuitively expected from Theorem 1. It is also observed
that the simulation results are in accordance with our analytical results.
Figure 2 shows the coverage probability of primary network under the EH-
PRA protocol. It is observed that the simulated values ﬁt closely to our analytical
values, which thereby shows that Assumption 1 is valid.

Coverage Performance in Cognitive Radio Networks
177
0.0
0.1
0.2
0.3
0.4
0.5
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
s
e
s
e
p
Transmission Probability
 Pp/Nth = 1      = 1.6 Analytical 
 Pp/Nth = 1      = 1.6 Simulation
 Pp/Nth = 5      = 1.4 Analytical 
 Pp/Nth = 5      = 1.4 Simulation
 Pp/Nth = 10     = 1.2 Analytical 
 Pp/Nth = 10     = 1.2 Simulation
s
e
s
e
s
e
s
e
s
e
s
e
Fig. 1. Transmission probability of STs.
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0.30
0.35
0.40
0.45
ra
Q
  EH-PRA Simulation
  EH-PRA Approximation
Coverage Probability of the Primary Network
Fig. 2. Coverage probability of primary network.
Figure 3 plots the analytical and simulation results on the coverage proba-
bility of the secondary network under the EH-PRA protocol. As observed from
Fig. 3, the lower bound on the coverage probability of the secondary network
derived in Theorem 3 under Assumption 2 is eﬀective.

178
X. Song et al.
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0.15
0.18
0.21
0.24
ra
Q
  EH-PRA Simulation
  EH-PRA Lower Bound (Approximation)
Coverage Probability of the Secondary Network
Fig. 3. Coverage probability of secondary network.
7
Conclusions
This paper has studied the performance of CR networks with self-sustained STs.
Upon harvesting suﬃcient energy, the STs opportunistically access the spectrum
if the estimated interference at the active PRs is lower than a predeﬁned thresh-
old Nra. Assuming inﬁnite battery capacity, we derived the transmission prob-
ability of STs. We then characterized the coverage probabilities of the primary
and secondary networks. Simulation results are provided to validate our analysis.
Acknowledgements. This work is supported in part by Fundamental Research Funds
for the Central Universities under Grant No. N150403001, the National Natural Science
Foundation of China under Grant 61671141, U14331156, 1151002, 61401079, 61501038,
and the Major Research Plan of the National Natural Science Foundation of China
under Grant 91438117, 91538202.
A
Proof of Theorem 2
Proof. With the energy harvesting based PRA protocol, given a typical PR
located at the origin, the received SIR is given by
SIRp =
Pph0d−α
p

i∈Πt
p
Pphi|Xi|−α +

j∈Πra
s
Psgj|Yj|−α .
(21)
It is worth noting that under the EH-PRA protocol, at the typical PR, the
received interference from the j-th active ST is constrained as Psgj|Yj|−α ≤
PsNra
Pp
. Therefore, under Assumption 1, the coverage probability of the primary
network with the EH-PRA protocol is given by

Coverage Performance in Cognitive Radio Networks
179
τ ra
p
= Pr

SIRp ≥θp
gj|Yj|−α ≤Nra
Pp
	
= Pr
⎧
⎪
⎨
⎪
⎩
Pph0d−α
p

i∈Πtp
Pphi|Xi|−α +

j∈Πra
s
Psgj|Yj|−α ≥θp
gj|Yj|−α ≤Nra
Pp
⎫
⎪
⎬
⎪
⎭
= EX
⎡
⎣
i∈Πtp
Eh

e
−
θphi|Xi|−α
d−α
p
 ⎤
⎦
× EY
⎡
⎣
j∈Πra
s
Eg

e
−
θpPsgj |Yj |−α
Ppd−α
p
gj ≤Nra|Yj|α
Pp
 ⎤
⎦
(a)
= exp

−
2π2
α sin

 2π
α
μpθ
2
α
p d2
p
	
× exp

−2π
 ∞
0
G · λR
ra(u)udu

(b)
= exp

−
2π2
α sin

 2π
α
θ
2
α
p d2
pμp
	
× exp

−2πλ0
νs
e
P
 ∞
ζ
(1 −ϱ(u)) udu

× exp

−2πλ0Qra
 ζ
0
(1 −ϱ(u)) P(u)udu
	
.
(22)
where (a) follows from the fact that the probability density function of g condi-
tioned on g ≤t is given by
f(g|g ≤t) =
e−g
1 −e−t ,
G = 1 −

Nrauα
Pp
0
e
−
θpPsgu−α
Ppd−α
p
×
e−g
1 −e−Nrauα
Pp
dg,
and (b) follows from (8). This thus completes the proof of Theorem 2.
References
1. Ellabban, O., Abu-Rub, H., Blaabjerg, F.: Renewable energy resources: current
status, future prospects and their enabling technology. Renew. Sustain. Energy
Rev. 39, 748–764 (2014)
2. Hasan, Z., Boostanimehr, H., Bhargava, V.K.: Green cellular networks: a survey,
some research issues and challenges. IEEE Commun. Surv. Tutor. 13(4), 524–540
(2011)
3. Kwasinski, A., Kwasinski, A.: Increasing sustainability and resiliency of cellu-
lar network infrastructure by harvesting renewable energy. IEEE Commun. Mag.
53(4), 110–116 (2015)
4. Gunduz, D., Stamatiou, K., Michelusi, N., Zorzi, M.: Designing intelligent energy
harvesting communication systems. IEEE Commun. Mag. 52(1), 210–216 (2014)

180
X. Song et al.
5. Han, T., Ansari, N.: Powering mobile networks with green energy. IEEE Wirel.
Commun. 21(1), 90–96 (2014)
6. Zhao, N., Yu, F.R., Leung, V.C.M.: Wireless energy harvesting in interference
alignment networks. IEEE Commun. Mag. 53(6), 72–78 (2015)
7. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allo-
cation in spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE
Trans. Commun. 62(7), 2366–2377 (2014)
8. Zhang, H., Chu, X., Guo, W., Wang, S.: Coexistence of Wi-Fi and heterogeneous
small cell networks sharing unlicensed spectrum. IEEE Commun. Mag. 53(3), 158–
164 (2015)
9. Wang, B., Liu, K.J.R.: Advances in cognitive radio networks: a survey. IEEE J.
Sel. Top. Sig. Process. 5(1), 5–23 (2011)
10. Zeng, Y.H., Liang, Y.-C., Hoang, A.T., Zhang, R.: A review on spectrum sensing for
cognitive radio: challenges and solutions. EURASIP J. Adv. Sig. Process. (2010).
Article ID 381465
11. Zhao, Q., Sadler, B.: A survey of dynamic spectrum access. IEEE Sig. Process.
Mag. 24(3), 79–89 (2007)
12. Zhang, R., Liang, Y.C., Cui, S.: Dynamic resource allocation in cognitive radio
networks. IEEE Sig. Process. Mag. 27(3), 102–114 (2010)
13. Song, X., Yin, C., Liu, D., Zhang, R.: Spatial throughput characterization in cog-
nitive radio networks with threshold-based opportunistic spectrum access. IEEE
J. Sel. Areas Commun. 32(11), 2190–2204 (2014)
14. Tandra, R., Mishra, S., Sahai, A.: What is a spectrum hole and what does it take
to recognize one. Proc. IEEE 97(5), 824–848 (2009)
15. Zhang, H., Jiang, C., Beaulieu, N., Chu, X., Wang, X., Quek, T.: Resource allo-
cation for cognitive small cell networks: a cooperative bargaining game theoretic
approach. IEEE Trans. Wirel. Wirel. Commun. 14(6), 3481–3493 (2015)
16. Zhao, X., Yang, C., Yao, Y., Chen, Z., Xia, B.: Cognitive and cache-enabled D2D
communications in cellular networks, November 2015. http://arxiv.org/abs/1509.
04747
17. Wang, X., Chen, M., Taleb, T., Ksentini, A., Leung, V.C.M.: Cache in the air:
exploiting content caching and delivery techniques for 5G systems. IEEE Commun.
Mag. 52(2), 131–39 (2014)
18. Park, S., Lee, S., Kim, B., Hong, D., Lee, J.: Energy-eﬃcient opportunistic spec-
trum access in cognitive radio networks with energy harvesting. In: Proceedings
of ACM International Conference on Cognitive Radio and Advanced Spectrum
Management, Barcelona, Spain (2011)
19. Park, S., Kim, H., Hong, D.: Cognitive radio networks with energy harvesting.
IEEE Trans. Wirel. Commun. 12(3), 1386–1397 (2013)
20. Park, S., Hong, D.: Achievable throughput of energy harvesting cognitive radio
networks. IEEE Trans. Wirel. Commun. 13(2), 1010–1022 (2014)
21. Pappas, N., Jeon, J., Ephremides, A., Traganitis, A.: Optimal utilization of a cog-
nitive shared channel with a rechargeable primary source node. In: Proceedings of
IEEE Information Theory Workshop, Paraty, Brazil (2011)
22. Yin, S., Zhang, E., Qu, Z., Yin, L., Li, S.: Optimal cooperation strategy in cognitive
radio systems with energy harvesting. IEEE Trans. Wirel. Commun. 13(9), 4693–
4707 (2014)
23. Yin, S., Qu, Z., Li, S.: Achievable throughput optimization in energy harvesting
cognitive radio systems. IEEE J. Sel. Areas Commun. 33(3), 407–422 (2015)

Coverage Performance in Cognitive Radio Networks
181
24. Chung, W., Park, S., Lim, S., Hong, D.: Spectrum sensing optimization for energy-
harvesting cognitive radio systems. IEEE Trans. Wirel. Commun. 13(5), 2601–2613
(2014)
25. Gallager,
R.G.:
Stochastic
Processes
Theory
for
Applications.
Cambridge
University Press, Cambridge (2013)
26. Baccelli, F., Blaszczyszyn, B.: Stochastic geometry and wireless networks. NOW
Found. Trends Netw. (2010)
27. Baccelli, F., Blaszczyszyn, B., M¨uhlethaler, P.: Stochastic analysis of spatial and
opportunistic aloha. IEEE J. Sel. Areas Commun. 27(7), 1029–1046 (2009)
28. Kingman, J.F.C.: Poisson Processes. Oxford University Press, Oxford (1993)
29. Stoyan, D., Kendall, W., Mecke, J.: Stochastic Geometry and Its Applications, 2nd
edn. Wiley, Chichester (1996)
30. Weber, S., Andrews, J., Jindal, N.: The eﬀect of fading, channel inversion, and
threshold scheduling on ad hoc networks. IEEE Trans. Inf. Theor. 53(11), 4127–
4149 (2007)
31. Vaze, R.: Transmission capacity of spectrum sharing ad hoc networks with multiple
antennas. IEEE Trans. Wirel. Commun. 10(7), 2334–2340 (2011)
32. Huang, K., Lau, V.K.N., Chen, Y.: Spectrum sharing between cellular and mobile
ad hoc networks: transmission-capacity trade-oﬀ. IEEE J. Sel. Areas Commun.
27(7), 1029–1046 (2009)
33. Lee, J., Andrews, J.G., Hong, D.: Spectrum-sharing transmission capacity. IEEE
Trans. Wirel. Commun. 10(9), 3053–3063 (2011)
34. Lee, J., Andrews, J.G., Hong, D.: The eﬀect of interference cancellation on
spectrum-sharing transmission capacity. In: Proceedings of IEEE Conference on
Communications, Kyoto, Japan (2011)
35. Haenggi, M., Andrews, J., Baccelli, F., Dousse, O., Franceschetti, M.: Stochastic
geometry and random graphs for the analysis and design of wireless networks.
IEEE J. Sel. Areas Commun. 27(7), 1029–1046 (2009)
36. Lee, C., Haenggi, M.: Interference and outage in Poisson cognitive networks. IEEE
Trans. Wireless Commun. 11(4), 1392–1401 (2012)
37. Nguyen, T., Baccelli, F.: A probabilistic model of carrier sensing based cognitive
radio. In: Proceedings of IEEE Symposium on New Frontiers in Dynamic Spectrum
Access Networks, Singapore, April 2010
38. Hasan, A., Andrews, J.: The guard zone in wireless ad hoc networks. IEEE Trans.
Wirel. Commun. 6(3), 897–906 (2007)
39. Lee, S.H., Huang, K.B., Zhang, R.: Opportunistic wireless energy harvesting in
cognitive radio networks. IEEE Trans. Wirel. Commun. 12(9), 4788–4799 (2013)
40. Huang, K.: Spatial throughput of mobile ad hoc networks with energy harvesting.
IEEE Trans. Inf. Theor. 59(11), 7597–7612 (2013)

A Novel Algorithm of UAV-Mounted Base
Station Placement and Frequency Allocation
Xu Shen(B), Zhiqing Wei, and Zhiyong Feng
Beijing University of Posts and Telecommunications, Beijing, China
xushen@bupt.edu.cn
Abstract. UAV equipped with base stations have recently gained sig-
niﬁcant development in cases of the terrestrial base station may not
satisfy the communication command. Due to the agility and ﬂexibility of
UAV, it is used widely in disaster resilience, scenarios of unexpected and
temporary events. Although UAV-mounted base station provides a fast
coverage for the terrestrial users, the placement of UAVs is a problem
to solve, especially the area to be covered is large which need multi-
UAVs to cooperate to provide coverage. The diﬀerence of terrestrial and
air-to-ground channel makes it a new coverage problem. Besides, the
interference from UAVs requires a technique to manage the spectrum.
In this paper, we formulate the placement of UAV as a 3-D problem,
and then proposed a soft frequency reuse scheme to dynamically manage
frequency resource. Simulations results show the algorithm is feasible to
operate on resource-limited UAV platforms.
Keywords: Unmanned Aerial Vehicles
Mobile base station placement · User coverage · Soft Frequency Reuse
Spectrum allocation
1
Introduction
With the development of wireless communication, next generation wireless net-
works are in increasing demand of high reliability and availability. This adop-
tion is motivated by the situations which are unexpected or temporary. Be in
a disaster, the ﬁxed infrastructure could be damaged by ﬂoods, earthquake or
tsunamis, the wireless networks is destroyed, and could hinder the rescue works.
Or in battleﬁelds or rural area, it is impossible to invest an infrastructure. In
these cases, utilizing unmanned aerial vehicles (UAVs) is a feasible solution for
realizing wireless networks. However, how to place a UAV-mounted base station
to beneﬁt and assist the network on the ground at most is one of the biggest
challenges.
Although there have been amounts of works on UAV-aided networks, the
placement of UAV-mounted base station is still at its infancy. The authors in
[1] uses p UAVs to serve terrestrial users, which the capacity of the each UAV is
constrained. They use K-means to partition the terrestrial users to be served by
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 182–193, 2018.
https://doi.org/10.1007/978-3-319-72823-0_18

UAV-Mounted Base Station Placement and Frequency Allocation
183
the UAVs, the other unsupported users are served by ﬁxed base stations. In [2],
an algorithm of oﬄoad as many users as possible from the station on the ground
is proposed, the authors study the placement of a single UAV-mounted base
station. An algorithm with successive placement along a spiral path towards the
center is presented [3]. In [4,5], the positioning of UAVs as relays is discussed,
but the placement of UAV is on a line which is not in accordance with practical
coverage. The Interference of UAV-mounted base station with underlaid D2D
network is further investigated in [6]. However, some of the works don’t cover
all the users to be served on the ground, some of the work consists of only one
UAV-mounted base station, there are not multi-UAVs to cooperate to cover the
users. Besides, the works doesn’t determine the height of UAV-mounted base
station. Since the character of the air-to-ground channel is diﬀerent from the
terrestrial channel, solve the problem of placement of UAV must take the height
parameter into consideration.
After the placement of UAV-mounted base stations is determined, we should
consider the spectrum allocation of UAV-mounted base stations. The frequency
resource is limited, in order to satisfy data rate demand, it should adopt fre-
quency reuse scheme in each cell. This will cause inter-cell interference of the
UAV cells. Especially the UAV is deployed according to the nodes on the ground,
if the distribution of the nodes is inhomogenous, the coverage of adjacent UAV-
mounted base station may overlap, it makes the interference more severe. Soft
frequency reuse (SFR) is a widely used scheme to deal with inter-cell interfer-
ence in conventional terrestrial cells. In this paper, we design a similar scheme
to allocate the frequency resource.
SFR is a spectrum reuse method which is used for improving spectrum eﬃ-
ciency and reduce interference in LTE networks in [7]. The frequency is divided
into groups for center region and edge region. Meanwhile, power control is used
with SFR. The authors in [8] divide the bandwidth into two segments, allocating
them to center region and edge region respectively with diﬀerent power level. In
[9], a multi-level SFR is proposed, the spectrum is divided into three segment
and the adjacent cells rotate the use of these segment to reduce interference.
To the best of our knowledge, the works presented have not considered UAV
cells frequency reuse. In this paper, we ﬁrst place the UAV-mounted base stations
according to the distribution of nodes on ground to cover all nodes. Then we
choose an optimal height of each UAV-mounted base station due to the implicit
relation of coverage radius and height which can be seen from the air-to-ground
channel. Sine the 3-D placement of UAV is solved, we determine the spectrum
allocation and power control of UAV stations with interference limitation among
neighboring cells. Diverging from with resource scheduling beforehand, the algo-
rithm we proposed is dynamically allocating spectrum and adjust according to
network traﬃc distribution.
The rest of the paper is organized as follows. In Sect. 2, we describe the system
model and discuss the air-to-ground channel in detail. Then we present the two
main problems, the placement of UAV-mounted base station and the frequency
reuse pattern. Next, in Sect. 3, the algorithm of the solution to the problem

184
X. Shen et al.
mentioned above is proposed. In Sect. 4, numerical simulations to validate our
algorithms is presented. Finally, Sect. 5 concludes this paper.
2
System Model
UAV-mounted mobile base station is used to provide coverage for users in ter-
restrial network without ﬁxed infrastructure, achieve the connectivity of the
network in disasters and relay for the nodes in remote area. UAV-mounted base
station diﬀers from other base stations. In contrary of the macro cell base sta-
tions that used in cellular networks, the base stations on UAV platform can
adjust its position according to the distribution of users on the horizontal plane.
Besides, UAV platform diﬀers from other High Altitude Platforms reaching the
upper layers of the stratosphere, UAV platforms are more easily to employ.
Fig. 1. A wireless network with UAV-mounted base stations
2.1
Channel Model
We consider a wireless network with K users on the ground, denoted by
K = {1, 2, · · · K}. Assuming that the location information of these nodes is
known by UAV-mounted base stations. Each of the known locations is given by
two-dimensional coordinates (xi, yi). The characteristic of UAV-mounted base
station is utilizing air-to-ground link. Air-to-ground channel distinguishes from
the terrestrial channel such as Rayleigh channel or Rice channel. Although dif-
ferent literature use these channels to study air-to-ground channel widely, it is
not in accordance with practical propagation. This is due to the high probability
of Line-of-Sight (LoS) propagation in the air-to-ground channel. Some works on
characterizing the air-to-ground channel are available. One of the most complete
models is derived in [10] with the help of the channel proposed by ITU [11], which
is based on classifying the signal arriving at the receivers into two propagation
groups statistically. We adopt this channel in this paper.
The occurrence of two dominant propagation groups LoS group and NLoS
group correspond to the LoS condition. The probability of having LoS users
depend on the elevation angle θ, as Fig. 1 shows. For the ith user on the ground

UAV-Mounted Base Station Placement and Frequency Allocation
185
located at (xi, yi), the horizontal distance ri between a UAV at (xU, yU) is

(xi −xU)2 + (yi −yU)2. For a UAV at the altitude h, the angle between user
i with it is calculated as θ = arctan(h/ri). According to [10], the LoS probability
is given by
PLoS =
1
1 + a exp (−b[θ −a]),
(1)
where a and b are constant parameters depends on the environment such as
suburban, urban, etc. the probability of NLoS is PNLoS = 1 −PLoS.
Assuming the transmitter and receiver antennas is isotropic, the expecta-
tion of path loss between a UAV-mounted base station and a terrestrial user is
denoted as PL, PL = PLoS × PLLoS + PNLoS × PLNLoS, where PLLoS and
PLNLoS representing the path loss of diﬀerent signal groups in air-to-ground
link. According to [10], PL measured in db is
PL =
A
1 + a exp(−b[θ −a]) + 10 log(h2 + r2) + B,
(2)
where A = ηLoS −ηNLoS, ηLoS and ηNLoS are the losses corresponding to the
LoS and NLoS groups in db, B = 20 log f +20 log(4π/c)+ηNLoS, f is the carrier
frequency.
2.2
UAV-Mounted Base Station Placement
We aim to deploy UAV-mounted base stations so that a terrestrial user is cov-
ered by at least one UAV station. Denote the set of UAV-mounted base stations
by M = {1, 2, · · · M}. The placement of UAV-mounted base stations is a com-
prehensive problem which is diﬀerent from the cell base station on the ground.
This is because that determine the location of the UAV-mounted base station
is actually choosing the projection coordinates on the horizontal plane (xj, yj),
j ∈M, and altitude of UAV hj in addition.
The position information of users to be served by a UAV-mounted base sta-
tion is known, so the area to be covered is determined. However, the coverage area
of a UAV is unknown in advance, this is because that UAV-mounted base station
coverage radius depends on the height of a UAV, which is to be determined. Due
to the characteristic of air-to-ground, the coverage radius of a UAV-mounted
base station is not a monotonic function of its height, which can be seen from
the path loss expression (2).
Unlike terrestrial cells such as macro or micro cells which are ﬁxed, UAV-
mounted base station adjusts the position to serve users on the ground in accor-
dance with the distribution of users changing. So the position of UAV-mounted
base station that can bring the network maximum coverage is to be found to
accommodate the mobility of user on the ground.
Besides, the bandwidth of a UAV is limited, which means the data rate of a
UAV is limited. A UAV-mounted base station can only serve some users on the
ground with limited resources. We assume that the total available bandwidth of a

186
X. Shen et al.
UAV is divided into L diﬀerent links, which means it can serve L terrestrial users
at the same time. In order to cover all the users on the ground, it needs multi-
UAVs to cooperate to provide coverage for the area. So the amount of UAV-
mounted base stations and the placement of the UAVs need to be determined
jointly.
2.3
Frequency Reuse Pattern Allocation
We consider downlink transmission in UAV aided networks since downlink traﬃc
load is larger than uplink. We assume UAV-mounted base station adopts Fre-
quency Division Duplexing (FDD), and the total bandwidth is divided into four
segments (i.e., F1, F2, F3, F4) which are to be assigned to diﬀerent part of the
area as Fig. 2 shows. The distribution of nodes in horizontal plane is not homoge-
nous, some areas where users have heavy traﬃc to transmit forming hot-spot
areas. UAV-mounted base stations to serve users on the ground are more dense
in these areas intuitively and vice versa. Due to the mobility of UAV-mounted
base station, the UAV-mounted base stations are distributed in accordance with
the distribution of traﬃc on the ground, the UAVs are evenly distributed, so
sometimes the UAV cells overlap in edge. In order to decrease interference of
adjacent UAV cells, we adopt SFR scheme to allocate diﬀerent spectrum in cell
edges. According to the four-color problem of graph theory, in order to allocate
diﬀerent spectrum in diﬀerent UAV cells, we need four frequency segments. We
propose a novel soft frequency reuse scheme to allocate the spectrum, which
means distributing the spectrum according to 4-color frequency reuse pattern.
First, a frequency segment is assigned to the edge of the area covered by a UAV-
mounted base station, then we use a SINR-based criterion to allocate the other
three segments, more details of the algorithm can be found in Sect. 3.
Fig. 2. Frequency reuse examples for 4-color frequency reuse pattern
3
UAV Placement and Resource Allocation Algorithm
In this section, we propose an eﬃcient algorithm to solve UAV-mounted base
stations placement problem to provide coverage for all users on the ground in

UAV-Mounted Base Station Placement and Frequency Allocation
187
the condition that the users a UAV-mounted base station can serve are limited.
Then we propose a practical SFR scheme, to allocate frequency resources for
planning UAV cells purpose.
3.1
UAV-Mounted Base Station Placement
The main idea of the UAV-mounted base station placement algorithm is to use
divide-and-conquer which is a recursive technique. Due to the resources a UAV-
mounted base station has are limited, including spectrum, the storage capacity
and the battery, a UAV-mounted base station can only serve a certain number
of users on the ground. As noted earlier in this paper, we assume that the
spectrum a station holds is divided into L sub-carrier, namely, a UAV-mounted
base station can serve at most L users at the same time. The coverage problem
is formulated to use M UAV base stations to provide coverage for all the ground
users cooperatively.
Since the locations of users on the ground are known to UAV-mounted base
stations, ﬁrst, we place a UAV-mounted base station in the middle of the area to
be covered. The UAV-mounted base station detects the amount of the users, if
the number of users is larger than L, then we add the number of UAV-mounted
base stations to provide service for the target area. We divide the target area
into four equal parts. This is because that a square is more accordant with
the coverage circle a UAV-mounted base station projection on the ground. A
square area is isotropic in four directions and can jointly cover a destination
area seamlessly and reduce the occurrence of outlier users to be served.
Then place UAV-mounted base stations in the center of every newly divided
square region, UAV-mounted base stations detect whether the nodes in the
square area it guarantee to cover is provided coverage. If the amount of the
terrestrial users is still larger than a UAV-mounted base station can serve at
the same time, L, then repeat the steps above until the number of nodes a
UAV serve is small or equal to L. After a UAV-mounted base station is placed,
namely a sub-square area is covered by a station, the adjacent UAVs repeat
this algorithm to place the next UAV-mounted base station until all users are
covered. As a result, the process of determining the placement of UAV-mounted
base station uses the recursive technique, which divides the area continuously.
We therefore name our proposed algorithm as the divide-and-conquer algorithm,
which is summarized in Algorithm 1.
Then the radius of each UAV-mounted base station cell can be calculated.
It equals the distance between the projection point of the UAV and the node
which is farthest to it. This base station placement method is simple and easy
to operate on the UAV platform and saves computational resources for UAV
which only has small storage to compute. For our divide-and-conquer algorithm,
the complexity is relatively low, reducing energy consumption beneﬁts for UAV
platform of limited battery. Besides, this algorithm considers the inhomogenous
distribution of the traﬃc on the ground, it places UAV-mounted base stations
according to the distributions of the terrestrial under their conditions where the
number of users a UAV-mounted base station can serve is limited. In hot spots,

188
X. Shen et al.
Algorithm 1. Divide-and-Conquer Placement Algorithm
Input: terrestrial users location information, (xi, yi), i ∈K
Output: UAV-mounted base stations set M, with locations (xj, yj), i ∈M
Initialization: uncovered terrestrial users location; M = ∅, m = 1.
1: while the number of users served by a UAV-mounted base station > L do
2:
Place a UAV-mounted base station in the center of the area to be covered, and
detect the amount of users on the ground.
3:
If the amount of users to be served is larger than L, divide the area into four
equals part, repeat step 2.
4:
Else M ←M ∪{m}, m ←m + 1.
5: end while
the UAV-mounted base stations are more than in the area a relatively small
number of users locate in.
3.2
Frequency Reuse Pattern Allocation
In this section, we address the issue of spectrum allocation and power control
of UAV-mounted base stations. In order to solve these problems, we ﬁst should
determine the height of each UAV-mounted base station. This is because that
the coverage radius of a UAV-mounted base station does not only depend on the
transmitting power but also the height of a UAV. In the case that coverage radius
of a UAV cell is determined, the height has an inﬂuence on the transmitting
power and the interference of each other.
As described above, the air-to-ground link is diﬀerent to the terrestrial chan-
nel. The power of signal is not a monotone decreasing function of distance but
depends on elevation angle θ. To illustrate this, we plot the radius-altitude curve
according to expression (2). We assume a path loss threshold, when path loss
exceeds this threshold, the user is out of coverage of the UAV-mounted base
station. As plots in Fig. 3, as to the same path loss, the UAV-mounted base
station at diﬀerent height corresponds to diﬀerent coverage radius. An inﬂection
point can be seen on each curve, which means for a given path loss, there is an
optimum height can provide a maximum coverage. The optimum height means
an optimum elevation angle θ. However, the path loss equation is implicit, there
is not an explicit function of the coverage radius R with elevation θ. We ﬁnd this
optimum point by setting the derivative of the radius R with respect to elevation
angle θ equals to zero, which yields as follows:
20
ln (10) tan (θOP T ) +
abA exp (−b[θOP T −a])
[aexp (−b[θOP T −a]) + 1]2 = 0.
(3)
From Eq. (3), we can know that the optimum elevation angle θ only depends on
parameters a, b, and A conditioning on environments (i.e. urban, suburban). This
also explains the straight line in Fig. 3, in the same environment the optimum θ
is at the same value. We use the optimum θ to determine the height of the UAV.

UAV-Mounted Base Station Placement and Frequency Allocation
189
0
50
100
150
200
250
300
350
400
UAV altitude (h)[m]
0
50
100
150
200
250
300
350
400
Cell radius (R)[m]
PL=95db
PL=93db
PL=91db
PL=89db
Fig. 3. Cell radius vs. UAV-mounted base station altitude for diﬀerent pathloss in an
urban environment
Since the radius and height of a UAV-mounted base station are determined,
the issue of spectrum allocation and power control is to be solved. Here we
adopt a soft frequency reuse scheme to allocate spectrum. The coverage area of
a UAV-mounted base station is divided into cell edge and cell centers as depicts
in Fig. 4 We set a guard band at the cell edge of each UAV. In order to make any
two adjacent cells have diﬀerent spectrum at the edge, the frequency is divided
into four segments according to the four-color problem of graph theory. Four
spectrum F1, F2, F3, F4 are available for a UAV-mounted base station.
First, a UAV-mounted base station can sense the guard frequency band which
the UAV-mounted base station adjacent to it use. According to the graph col-
oring problem, the UAV-mounted base station selects a segment diﬀerent from
the segment adjacent cells use, then allocate to its edge region. The other seg-
ment is allocated to its center region. We propose an algorithm to design the
transmitting power and radius of diﬀerent frequency segment according to the
power of signal and interference.
The useful signal a terrestrial user receives should be larger than a threshold
that the signal can be accepted correctly, this yields follows:
10 log(P1) −PL ≥10log(PRXth),
(4)
where PT X and PRXth are transmitting power of a UAV-mounted base station
and the receiving signal power of a user on the ground. The formulation is
evaluated in db. The signal received at the user in edge region is the smallest
due to its largest path loss, in order to satisfy the condition in inequation (4),
the power of guard segment should be larger than or equal to the PT X derived
when using the path loss of the very point at the edge of the UAV-mounted base
station coverage area.

190
X. Shen et al.
For determining the power and radius of other segments, we take two adjacent
UAV cells as an example. As shown in Fig. 4, point p1 and point p2 are the
projection point of UAV-mounted base stations, their coordinates are (x1, y1)
and (x2, y2) respectively, and their guard segment is F1 and F2. We assume
a point p3 on the line between p1 and point p2, the coordinate of which is
(x1 + t (x2 −x1) , y1 + t (y2 −y1)), where t ∈(0, 1).
In cell 1, segment F1 is used in edge region, and in cell 2, the same segment
is used in center region. The interference caused by adjacent cell should be
restricted to guarantee communication quality, we set a SIR threshold of the
same spectrum segment. We assume point p3 is the very furthest node to the
UAV-mounted base station in cell 2 using segment F1, so the distance between
p3 and p2 is the coverage radius of segment F1 in cell 2. In order to satisfy the
condition above, we have
10 log(P2) −PL23 ≥10log(PRXth),
10 log(P2) −PL23 −(10 log(P1) −PL13) ≥10 log(SIRth),
(5)
where PLij representing the path loss between node i, j, and Pi denoting the
transmitting power of node i. Substituting the path loss equation, the coordi-
nates of every point, the power and radius of diﬀerent spectrum segment can be
derived.
Fig. 4. Single adjacent interfering cell model
4
Numerical Results
Figure 5 illustrates a result of our algorithm in a snapshot, we apply our divide-
and-conquer placement algorithm to cover 200 users on the ground. The users
are randomly and independently distribute in a square area of 2.6 km2. The sim-
ulation parameter of the air-to-ground channels presented in Table 1 are derived
from [2,10]. It is assumed that a UAV-mounted base station can serve at most 40
users at the same time. After dividing the area into small squares, the position

UAV-Mounted Base Station Placement and Frequency Allocation
191
Table 1. Simulation parameters
Description
Parameter Value
System frequency
fc
2.5 GHz
Diﬀerence of path loss between two propagation groups A
−20
Parameter for dense urban environment
a
4.88
Parameter for dense urban environment
b
0.43
of a UAV-mounted base station is determined, the radius is then calculated and
the optimum height of UAVs is derived by solving the 3-D placement problem
using the algorithm proposed above. Note that the UAV cells size is not equiv-
alent, this is due to the distribution of nodes on the ground. Each terrestrial
user is supplied coverage by a UAV-mounted base station. Some nodes are on
the edge of the UAV cell, and some area isn’t covered by a UAV-mounted base
station, this means that the transmitting power of UAV is not wasted, and the
algorithm is eﬃcient.
Figure 6 shows the frequency allocation using the algorithm we propose. We
choose a snapshot of the wireless networks. In this ﬁgure, frequency segments
are noted next to the edge of circles with diﬀerent radius, which means within
the coverage circle, this segment is available. The coverage radius of diﬀerent
frequency segments are unequal, it depends on the interference of the same
segment used in UAV cells surrounding it. We can further see that edge region
of the UAV cells is separated by guard segment which decreases the interference
from adjacent cells. The other frequency segment is allocated in the center area
of the UAV cell to reuse to elevate spectrum eﬃciency. This algorithm is ﬂexible
and simple to operate on UAV platform which is power and capacity constrained.
-200
0
200
400
600
800
1000
1200
1400
1600
0
200
400
600
800
1000
1200
1400
Fig. 5. Placement of UAV-mounted base stations to cover all users on the ground

192
X. Shen et al.
Fig. 6. Frequency allocation scheme in each UAV cells
5
Conclusion
In this paper, we have proposed a novel UAV-mounted base station placement
solution for coverage problem, termed as divide-and-conquer algorithm. The pro-
posed algorithm is low-complexity and occupies small storage, it is suitable to
operate on UAV which is battery and storage constrained platform. Using this
algorithm the UAV-mounted base stations which can serve a ﬁxed number of
users at the same time can cooperate to cover all terrestrial users. In addition, we
have presented a soft frequency reuse scheme, the allocations of transmit power
and spectrum segment are not ﬁxed prior, it is dynamically deployed according
to the position and interference of adjacent UAV cells. The algorithm achieves a
good performance. We believe that these algorithms can provide guidelines for
UAV-mounted base station design.
Acknowledgment. This work was supported by the National Natural Science Foun-
dation of China (No. 61601055, No. 61631003), and the National Science Fund for
Distinguished Young Scholars (No. 61525101).
References
1. Boris, G., Jacek, K., Luiz, A.D.: Deployment of UAV-mounted access points accord-
ing to spatial user locations in two-tier cellular networks. In: 2016 Wireless Days,
pp. 1–5 (2016)
2. Yaliniz, R.I.B., Elkeyi, A., Yanikomeroglu, H.: Eﬃcient 3-D placement of an aerial
base station in next generation cellular networks. In: IEEE International Confer-
ence on Communications (2016)
3. Lyu, J., Yong, Z., Rui, Z., Teng, J.L.: Placement optimization of UAV-mounted
mobile base stations. http://arxiv.org/abs/1612.01047
4. Rohde, S., Putzke, M., Wietfeld, C.: Ad hoc self-healing of OFDMA networks using
UAV-based relays. Ad Hoc Netw. 11(7), 1893–1906 (2013)

UAV-Mounted Base Station Placement and Frequency Allocation
193
5. Li, X., Guo, D., Yin, H., Wei, G.: Drone-assisted public safety wireless broadband
network. In: Wireless Communications and Networking Conference Workshops, pp.
323–328. IEEE (2015)
6. Mozaﬀari, M., Saad, W., Bennis, M., Debbah, M.: Unmanned aerial vehicle
with underlaid device-to-device communications: performance and tradeoﬀs. IEEE
Trans. Wirel. Commun. 15(6), 3949–3963 (2016)
7. Soft Frequency Reuse Scheme for UTRAN LTE, 3rd Generation Partnership
Project. http://www.3gpp.org
8. Lopez-Perez, D., Chu, X., Vasilakos, A.V., Claussen, H.: Power minimization based
resource allocation for interference mitigation in OFDMA Femtocell networks.
IEEE J. Sel. Areas Commun. 32(2), 333–344 (2014)
9. Giambene, G., Le, V.A., Bourgeau, T., Chaouchi, H.: Soft frequency reuse schemes
for heterogeneous LTE systems. In: IEEE International Conference on Communi-
cations, pp. 3161–3166 (2015)
10. Al-Hourani, A., Kandeepan, S., Lardner, S.: Optimal lap altitude for maximum
coverage. IEEE Wirel. Commun. Lett. 3(6), 569–572 (2014)
11. Propagation data and prediction methods required for the design of terrestrial
broadband radio access systems operating in a frequency range from 3 to 60 GHz.
In: International Telecommunication Union Radiocommunication Sector (ITU-R),
Recommendation ITU-R P.1410-5 (2012)

Throughput Analysis for Full-Duplex Based
Device-to-Device Communications
Yajun Shang1, Xuehan Meng1, Xiaomeng Chai1, Tong Liu2,
and Zhongshan Zhang1(B)
1 Technology Research Center for Convergence Networks and Ubiquitous Services,
University of Science and Technology Beijing (USTB), Beijing 100083, China
zhangzs@ustb.edu.cn
2 Department of Information and Communication Engineering,
Harbin Engineering University, 145 Nantong Street, Harbin, China
liutong@hrbeu.edu.cn
Abstract. The throughput of Device-to-device (D2D) enabled under-
laying cellular networks is analyzed, with either full duplex (FD) or
conventional half duplex (HD) transmission mode considered in D2D
links. Despite of the severe interference imposed on the cellular users
(CUs) by the FD based D2D (FD-D2D) links, the FD-D2D mode always
exhibits its superiority in terms of the network throughput due to its
reduced large-scale fading as well as low transmit-power essences. Numer-
ical results show that the proposed FD-D2D mechanism is capable of
substantially improving the network throughput.
Keywords: Device-to-device · Full duplex · Throughput · Interference
1
Introduction
With the rapid development of wireless communication techniques, the existed
cellular networks become more and more insuﬃcient for supporting the cus-
tomers’ exponentially growing data traﬃc demands [1,2]. In order to successfully
relieve the heavy burden of base stations (BSs), Device-to-Device (D2D) commu-
nication technique allowing proximity users to communicate directly with each
other without relying on the intervention of BS has exhibited several promising
advantages in terms of cell throughput [3], spectral eﬃciency [4], users’ end-to-
end latency [5], radio coverage [6], power consumption [7] and traﬃc oﬄoad-
ing capabilities [8], etc. Unlike the traditional BS-centric communications, D2D
mode possess the characteristics of shorter radio-propagation distance and lower
transmit power, thus leading to a higher signal-to-interference-plus-noise ratio
(SINR) at the receiver. Up to now, D2D technique has attracted a wide attention
in both academia and industry [9,10].
Unlike the conventional half duplex (HD) mode, which has been widely
adopted in the existed D2D studies [8,11], the full duplex (FD) mode is capable
of supporting concurrent transmission and reception in a single time/frequency
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 194–205, 2018.
https://doi.org/10.1007/978-3-319-72823-0_19

Throughput Analysis
195
channel so as to (in theory) improving the attainable spectral eﬃciency by a
factor of two [12–15]. However, FD mode suﬀers from a performance degrada-
tion due to the impact of self-interference (SI) [16], which can be substantially
reduced by employing the state-of-the-art SI cancellation techniques [13].
All the above-mentioned issues have motivated us to investigate the com-
bination of D2D communications and FD techniques [11]. However, there still
exist several challenges to address in D2D systems. For example, interference
management constitutes a major concern of D2D-enabled cellular networks. To
implement the practical D2D-based systems, the D2D links can either be allo-
cated a dedicated resource (i.e. be orthogonal to the cellular bandwidth) [17]
or be allowed to reuse the cellular’s resources [18]. Relative to the former, the
same spectrum is shared between the cellular and the D2D systems in the lat-
ter scenario, leading to a more eﬃcient resource utilization but also a much
more severe interference problem (e.g. cellular-to-D2D interference, D2D-to-D2D
interference, etc.). As compared with the HD mode, the FD based D2D (FD-
D2D) mode will lead to more serious interference problem. Speciﬁcally, the D2D-
induced interference may even deteriorate the throughput of the geographically
closed D2D pairs.
In light of the fact that the D2D mode is essentially service-oriented and a
D2D link is created when and only when a service demand emerges between
a pair of D2D-enabled users, the mute duration of the D2D links can still be
regarded as the interference-free period of the conventional cellular users (CUs).
In this case, it would be critical to complete a given D2D service as quick as pos-
sible in order to minimize the impact of D2D-imposed interference. Therefore, an
eﬃcient and straightforward way to improve the throughput of CUs might resort
to the capability of suppressing the duration of D2D-induced interference. As
compared to the HD mode, FD mode is (in theory) capable of doubling the data
transmission rate of a given D2D link, corresponding to cut the D2D-imposed
interference period by half. For a given block of data to be shared between D2D
pairs, FD-D2D is found to be helpful to substantially expedite the completion of
D2D services. Although the average interference strength imposed on the CUs
by FD-D2D users becomes higher than that induced by the transmissions of
HD-mode D2D pairs, the accumulated performance losses observed in the CUs
due to the FD-D2D induced interference are still lower than that induced by the
latter, because the average transmission time of a given data needed in the latter
is almost two times of that of the former. From this point of view, it would be
beneﬁcial to improving the throughput of the D2D-aided cellular networks by
adopting FD mode rather than HD mode.
In this paper, we investigate the technique of FD-D2D under the scenario
of spatially distributed multiple cells by analyzing the network throughput. The
main contributions of this paper are reﬂected as follows. Based on the the-
ory of stochastic geometry, a theoretical framework is established for modelling
and analyzing either the cellular/D2D links’ data rate and the throughput of
the whole network by considering both the FD and HD modes. We analyze
the throughput gain brought about by enabling FD-D2D in cellular networks.

196
Y. Shang et al.
Despite of a higher interference than the HD mode may be imposed by employ-
ing FD-D2D, the latter still exhibits its superiority in terms of the network
throughput due to its short-distance-communication essence and lower power
consumption, provided that the SI power can be suppressed to a low enough
level1.
The remainder of this paper is organized as follows. In Sect. 2, the system
mode for D2D-aided underlaying cellular networks is described. The theoretical
analysis for the transmission rates in both the FD and the HD modes will be
presented in Sect. 3, followed by numerical results given by Sect. 4. Finally, Sect. 5
concludes this paper.
Notation: ST P{•} denotes the successful transmission probability of a link,
L{•} denotes the Laplace transforms of a random variable, P{•} represents
the probability of a event, E{•} denotes the expectation, and R{•} denotes the
throughput of a link.
2
Uplink System Model for FD-D2D Based Underlaying
Cellular Networks
In this paper, we consider a cellular system comprising multiple BSs and mobile
user equipments (UEs). Without loss of generality, we assume that the BSs are
spatially distributed inside a given geographical area according to a homoge-
neous Poisson point process (PPP) Φb of intensity λb. Furthermore, both the
conventional CUs and the DUs can be served by the system, in which the CUs
and DUs are also assumed to be geographically scattered according to indepen-
dent homogeneous PPPs Φc and Φd, with intensities of λc and λd, respectively.
We assume that each DU has an opportunity to ﬁnd a matched DU close to it to
constitute a D2D pair, in which the average length of the established D2D links
is represented by Dd. In addition, a constant transmit power is assumed in each
user, with Pc and Pd denoting the transmit power of CUs and DUs, respectively.
We consider an FD-D2D based underlaid HD cellular network, in which the
conventional cellular links are assumed to be operated in HD mode, whereas
the D2D links are operated at the FD mode. Furthermore, the uplink recourses
are employed for facilitating the D2D communications. Without loss of general-
ity, the general (large-scale) power law propagation model and the (small-scale)
Rayleigh fading channels are adopted in both the cellular/D2D links and the
interference links. In addition, we assume that all the above-mentioned links in
our model are independent and identically distributed (i.i.d.) random variables
with hij ∼exp(1), i, j ∈{Φb, Φc, Φd}.
In the following, we assume that an orthogonal resource can be assigned to
each CU for eﬀectively mitigating the intra-cell interference. The receive SINR
of both the conventional cellular links and the D2D links can be expressed as
1 According to [13], SI-cancellation capability of up to 110 dB can be attained by
employing proper spatial suppression, analog- and digital-domain cancellations.

Throughput Analysis
197
SINRc =
Pchcbd−α
cb
Idc + Icc + σ2 ,
(1)
SINRd =
PdhdD−α
d
Icd + Idd + ISI + σ2 ,
(2)
respectively, where Idc = 2

Φd
Pdhdibr−α
dib denotes the interference power imposed
on CUs by FD-DUs, Icc =

Φc/c0
Pchcibr−α
cib represents the interference among
CUs, Icd =

Φc
Pchcidr−α
cid stands for the interference power imposed on DUs by
CUs, Idd = 2

Φd
Pdhdidr−α
did, represents the interference among FD-DUs, ISI =
Pdcsi denotes the residual SI observed in the FD devices after performing SI
cancellation, and csi denotes the SI cancellation coeﬃcient (a larger coeﬃcient
corresponds to a higher SI cancellation capability). Furthermore, σ2 denotes the
Additive-White Gaussian Noise (AWGN) covariance.
Note that the average length of D2D links (corresponding to the transmitter-
receiver distance) is shorter than that of the cellular and/or interference links.
Furthermore, the average interference strength imposed on BSs by the active
FD-mode DUs is much higher than that imposed by the HD-mode DUs. It
would thus be reasonable to assume that the former is two times of the latter.
In other words, the interference induced by an FD-D2D pair comes from both
the transmitter and the receiver, resulting in a two-fold interference strength
compared to that induced by the HD-mode D2D pair, in which case only one
out of the D2D peers is allowed to transmit in each time.
We further deﬁne the successful transmission probability (STP) as the prob-
ability that the quality of a randomly chosen link successfully reaches its prede-
termined target SINR threshold ε. The STP of a typical cellular or D2D link can
thus be deﬁne as
ST Pc = Pr

Pchcbd−α
cb
Idc + Icc + σ2 > ε

(3)
and
ST Pd = Pr

PdhdD−α
d
Icd + Idd + ISI + σ2 > ε

,
(4)
respectively.
3
Throughput for FD-D2D Based Underlaying Cellular
Networks
In this section, the throughput for D2D based underlaying cellular networks will
be analyzed. The SI cancellation is assumed to be already performed (but the
residual SI power is always non-zero). The theory of stochastic geometry can be

198
Y. Shang et al.
employed for modelling and analyzing the throughput of the proposed system
by considering both the FD and HD modes.
According to the tractable analysis of PPP in [19], each CU will always
preferentially communicate with the BS having the highest RSS (i.e. the geo-
graphically closest BS), leading to the probability density function (PDF) of the
random CU-BS distances r as
fr(r) = e−πλbr22πλbr.
(5)
3.1
STP of a Typical Cellular Links
From the Slivnyaks theorem [20], the statistical property of a typical node located
at a speciﬁc position holds true for any generic node located at any generic
location. Without loss of generality, we assume that the CU of interest is located
at the origin of the plane and receives signals from the closest BS. The STP of
a typical cellular link in a general FD-D2D underlaying cellular network can be
derived as
ST Pf
c =
 ∞
0
LIcc
εrα
Pc

LIdc
εrα
Pc

× e−εrασ2
Pc
e−λbπr22πλbrdr,
(6)
where LIcc (s) and LIdc (s) denote the Laplace transforms (evaluated at s) of
random variables Icc and Idc, respectively, as deﬁned by
LIcc
εrα
Pc

= exp
−2πλbr2ε
α −2
2F1

1, α −2
α
; 2 −2
α; −ε

(7)
and
LIdc
εrα
Pc

= exp

−2
2
α
Pd
Pc
 2
α
πr2λdε
2
α
1
sinc( 2
α)
	
,
(8)
respectively, the function 2F1(a, b; c; z) denotes the hypergeometric function, and
sinc(x) = sin(πx)
πx
.
3.2
STP of a Typical FD-D2D Links
In the proposed FD-D2D based underlaying cellular networks, a given FD-D2D
link also suﬀers from interference induced by various sources, including the con-
ventional CUs, the neighboring FD-D2D pairs and the residual SI at the FD
devices, etc. The STP of a typical FD-D2D link in a general FD-D2D underlay-
ing cellular network is given by
ST Pf
d = LIcd
εDα
d
Pd

LIdd
εDα
d
Pd

e−εcsiDα
d e−
εDα
d σ2
Pd
,
(9)

Throughput Analysis
199
where LIcd (s) and LIdd (s) denote the Laplace transforms (evaluated at s) of
random variables Icd and Idd, respectively, as deﬁned by
LIcd
εDα
d
Pd

= exp

−πλbD2
d
Pc
Pd
 2
α
ε
2
α
1
sinc( 2
α)
	
(10)
and
LIdd
εDα
d
Pd

= exp

−2
2
α πλdD2
dε
2
α
1
sinc( 2
α)

,
(11)
respectively.
3.3
Throughput Analysis for the FD-D2D Based Underlaying
Cellular Networks
From information theory [21], the average throughput of a typical CU/DU can
be deﬁned as
R = E[log(1 + SINR)] =

ε>0
P(SINR > ε)
ε + 1
dε.
(12)
The throughput of a typical cellular link and FD-D2D link can thus be derived
as
Rf
c =

ε>0
ST Pf
c
ε + 1 dε
=
 ∞
0
 ∞
0
exp

−πr2

2λbε
α −2M +

2Pd
Pc
 2
α
ε
2
α N
	
(13)
× exp

−εrασ2
Pc
−λbπr2

2πλbrdr
1
ε + 1dε
and
Rf
d =

ε>0
ST Pf
d
ε + 1 dε
=
 ∞
0
exp

−πD2
dε
2
α
sinc( 2
α)

λb
Pc
Pd
 2
α
+ 2
2
α λd
	
(14)
× exp

−εcsiDα
d −εDα
d σ2
Pd

1
ε + 1dε,
respectively.
Note that the impact of thermal noise will no longer dominate the perfor-
mance degradation of the D2D-aided networks, which should be interference lim-
ited. In this case, it would be reasonable to assume that σ2 →0, thus enabling
the throughput of the FD-D2D underlaying cellular networks to be simpliﬁed as
Rf = λbRf
c + 2λdRf
d,
(15)

200
Y. Shang et al.
where
Rf
c =
 ∞
0
1
ε + 1 ×
1
2ε
α−2M +

2 Pd
Pc
 2
α ε
2
α N
λb + 1
dε
(16)
and
Rf
d =
 ∞
0
1
ε + 1 exp

−πD2
dε
2
α
sinc( 2
α)F −εcsiDα
d

dε,
(17)
respectively, where F =

λb

Pc
Pd
 2
α + 2
2
α λd

.
For purposes of performance comparison, we also derive the throughput under
HD mode, as given by
Rh = λbRh
c + λdRh
d,
(18)
where
Rh
c =
 ∞
0
1
ε + 1 ×
1
2ε
α−2M +

Pd
Pc
 2
α ε
2
α N
λb + 1
dε
(19)
and
Rh
d =
 ∞
0
1
ε + 1 × exp

−πD2
dε
2
α
sinc( 2
α)

λb
Pc
Pd
 2
α
+ λd
	
dε,
(20)
respectively. Evidently, the superiority of FD-mode over HD-mode is mainly
reﬂected in the potential factor-2 throughput gain. However, this gain is not
attainable in practical designs mainly due to the impact of residual SI as well
as the other non-linear distortions [13]. Since the HD mode may occasionally
outperform the FD mode in terms of attainable throughput if the residual SI
power in the FD devices is high, the latter maintains its advantages only if the
SI power can be suﬃciently suppressed.
4
Numerical Results
In this section, we evaluate the spectral eﬃciency gain oﬀered by underlaying
cellular networks, which combines the beneﬁts of both the FD mode and D2D
communications. The uplink band is shared between the conventional CUs and
the D2D links, with i.i.d. Rayleigh fading considered. Furthermore, the path-loss
exponent is set to α = 4 (i.e. corresponding to the typical urban environment).
In the following simulations, an area of 4000 × 4000 m2 square serving 5 BSs
and 30 D2D links (deployed according to independent PPP) is considered. Fur-
thermore, an orthogonal resource allocation among CUs is assumed. In addition,

Throughput Analysis
201
the average length of D2D links is assumed to be 50 m, with the transmit pow-
ers of CUs and DUs assumed to be 30 dBm and 20 dBm, respectively. Finally,
the noise power spectrum density is assumed to be −174 dBm/Hz. The detailed
parameter settings are shown in Table 1.
As shown in Fig. 1, the numerical results can well validate the theoretical
analysis. In the presence of low SI-cancellation capability (i.e. a relatively higher
power of residual SI is imposed on the FD devices), the HD mode based D2D
outperforms the FD-D2D mode in terms of the spectral eﬃciency. However,
the FD-D2D mode exhibits its superiority over its FD counterpart if the SI-
cancellation capability becomes higher than 85 dB.
70
80
90
100
110
120
50
100
150
200
250
300
350
400
450
Self−interference Cancellation,dB
Throughput,bps/Hz
Throughput of Full duplex,Theoretical
Throughput of Half duplex,Theoretical
Throughput of Full duplex,Simulation
Throughput of Half duplex,Simulation
Fig. 1. Performance comparison of HD-D2D and FD-D2D in terms of throughput by
considering variant SI cancelation.
Figure 2 illustrates the performance comparison between HD-D2D and FD-
D2D modes in terms of spectral eﬃciency under various number of D2D links.
Evidently, the spectral eﬃciency can be improved as the number of D2D link
increases. However, the approach of improving the spectral eﬃciency by inﬁnitely
increasing the number of D2D links is shown to be un-sustainable. As illus-
trated in Fig. 3, when we shrink the simulation area from 4000 × 4000 m2 to
1000 × 1000 m2 (i.e. corresponding to magnifying the density of DUs), the spec-
tral eﬃciency may be eroded by further increasing the D2D numbers once it
approaches a critical threshold. We may explain it as follows: In scenarios with
sparse D2D distributions, activating more D2D pairs implies contributing more
throughput via D2D links. In scenarios with dense D2D distributions, on the
other hand, the whole system becomes interference-overloaded, in which case
the performance improvement brought about by increasing D2D pairs cannot

202
Y. Shang et al.
10
20
30
40
50
60
70
80
90
100
0
100
200
300
400
500
600
700
800
900
Number of D2D UE
Throughput,bps/Hz
Half duplex
Full duplex,SIC=80dB
Full duplex,SIC=85dB
Full duplex,SIC=80dB
Fig. 2. Performance comparison of HD-D2D and FD-D2D in terms of throughput under
diﬀerent D2D-density settings (sparse scenario is considered).
10
20
30
40
50
60
70
80
90
100
30
35
40
45
50
55
60
65
Number of D2D UE
Throughput,bps/Hz
Throughput of Full duplex,Theoretical
Throughput of Half duplex,Theoretical
Throughput of Full duplex,Simulation
Throughput of Half duplex,Simulation
Fig. 3. Performance comparison of HD-D2D and FD-D2D in terms of throughput under
diﬀerent D2D-density settings (dense scenario is considered).
counter-balance the throughput losses induced by the severe interference imposed
by D2D links. Furthermore, a further observation in Fig. 2 indicates that the per-
formance gap between the FD-D2D and the HD-D2D modes becomes larger as

Throughput Analysis
203
the number of D2D pairs increases (i.e. the superiority of the FD-D2D mode is
enhanced). Anyway, as long as the DU density is below the tolerable threshold,
increasing the number of D2D pairs (i.e. corresponding to decreasing the distance
between peer DUs) will always enables a better FD mode communication.
Table 1. Default key parameters in the simulation
Parameter Physical Mean
Value
Pc
Power of CU
30 dBm
Pd
Power of DUs
20 dBm
α
Path loss coeﬃcient
4
Dd
The average distance between a pair of D2D peers 50 m
σ2
Power level of thermal noise
−174 dBm/Hz
Simulation area
4000 m × 4000 m
Nb
Number of BS
5
Nd
Number of D2D link
30
k
Cellular Link Protecting Radius Coeﬃcient
0.5–0.7
csi
SI cancellation coeﬃcient
100 dB
5
Conclusions
In this paper, beneﬁts brought about by implementing FD-D2D aided cellular
networks in terms of spectral eﬃciency was analyzed, showing that the FD-D2D
communication is capable of improving the sum-rate of the network due to its
speciality of short link distance and lower transmit power, despite of a much
more severe interference than the HD-D2D mode imposed on it. Furthermore, it
was shown that the attainable performance gain in terms of throughput cannot
be inﬁnitely increased by simply increasing the number of D2D links, because
the CUs may become interference overloaded, in which case the performance
gain brought by increasing the number of D2D links cannot counter-balance the
throughput loss induced by the severe interference.
Acknowledgement. This work was supported by the key project of the National Nat-
ural Science Foundation of China (No. 61431001), the open research fund of National
Mobile Communications Research Laboratory, Southeast University (No. 2017D02),
Key Laboratory of Cognitive Radio and Information Processing, Ministry of Education
(Guilin University of Electronic Technology), and the Foundation of Beijing Engineer-
ing and Technology Center for Convergence Networks and Ubiquitous Services. The
corresponding author is Dr. Zhongshan Zhang.

204
Y. Shang et al.
References
1. Zhang, Z., Long, K., Wang, J.: Self-organization paradigms and optimization
approaches for cognitive radio technologies: a survey. IEEE Wirel. Commun. Mag.
20(2), 36–42 (2013)
2. Zhang, Z., Long, K., Wang, J., Dressler, F.: On swarm intelligence inspired self-
organized networking: its bionic mechanisms, designing principles and optimization
approaches. IEEE Commun. Surv. Tuts. 16(1), 513–537 (2014). First Quarter
3. Liu, Z., Peng, T., Peng, B., Wang, W.: Sum-capacity of d2d and cellular hybrid
networks over cooperation and non-cooperation. In: 2012 7th International ICST
Conference on Communications and Networking in China (CHINACOM), pp. 707–
711. IEEE (2012)
4. Abu Al Haija, A., Vu, M.: Spectral eﬃciency and outage performance for hybrid
d2d-infrastructure uplink cooperation. IEEE Trans. Wirel. Commun. 14(3), 1183–
1198 (2015)
5. Lianghai, J., Klein, A., Kuruvatti, N., Schotten, H.D.: System capacity optimiza-
tion algorithm for d2d underlay operation. In: 2014 IEEE International Conference
on Communications Workshops (ICC), pp. 85–90. IEEE (2014)
6. Liu, J., Zhang, S., Nishiyama, H., Kato, N., Guo, J.: A stochastic geometry analysis
of d2d overlaying multi-channel downlink cellular networks. In: INFOCOM (2015)
7. Fodor, G., Dahlman, E., Mildh, G., Parkvall, S., Reider, N., Miklos, G., Turanyi, Z.:
Design aspects of network assisted device-to-device communications. IEEE Com-
mun. Mag. 50(3), 170–177 (2012)
8. Lei, L., Kuang, Y., Shen, X., Lin, C., Zhong, Z.: Resource control in network
assisted device-to-device communications: solutions and challenges. IEEE Com-
mun. Mag. 52(6), 108–117 (2014)
9. Asadi, A., Wang, Q., Mancuso, V.: A survey on device-to-device communication
in cellular networks. IEEE Commun. Surv. Tuts. 16(4), 1801–1819 (2014). Fourth
quarter
10. ElSawy, H., Hossain, E., Alouini, M.-S.: Analytical modeling of mode selection and
power control for underlay d2d communication in cellular networks. IEEE Trans.
Comm. 62(11), 4147–4161 (2014)
11. Feng, D., Lu, L., Yuan-Wu, Y., Li, G., Li, S., Feng, G.: Deviceto-device communi-
cations in cellular networks. IEEE Commun. Mag. 52(4), 49–55 (2014)
12. Zhang, Z., Chai, X., Long, K., Vasilakos, A.V., Hanzo, L.: Full duplex techniques
for 5G networks: self-interference cancellation, protocol design, and relay selection.
IEEE Commun. Mag. 53(5), 128–137 (2015)
13. Zhang, Z., Long, K., Vasilakos, A.V., Hanzo, L.: Full-duplex wireless communi-
cations: challenges, solutions and future research directions. Proc. IEEE 104(7),
1369–1409 (2016)
14. Goyal, S., Liu, P., Panwar, S.S., Difazio, R., Yang, R., Bala, E., et al.: Full duplex
cellular systems: will doubling interference prevent doubling capacity? IEEE Com-
mun. Mag. 53(5), 121–127 (2015)
15. Zhang, H., Tabassum, H., Hossain, E., Kim, D.I.: Medium access control design
for full duplex wireless systems: challenges and approaches. IEEE Commun. Mag.
53(5), 112–120 (2015)
16. Wang, L., Tian, F., Svensson, T., Feng, D., Song, M., Li, S.: Exploiting full duplex
for device-to-device communications in heterogeneous networks. IEEE Commun.
Mag. 53(5), 146–152 (2015)

Throughput Analysis
205
17. Zhou, B., Hu, H., Huang, S.-Q., Chen, H.-H.: Intracluster device-to-device relay
algorithm with optimal resource utilization. IEEE Trans. Veh. Technol. 62(5),
2315–2326 (2013)
18. Feng, D., Lu, L., Yuan-Wu, Y., Li, G.Y., Feng, G., Li, S.: Device-to-device com-
munications underlaying cellular networks. IEEE Trans. Comm. 61(8), 3541–3551
(2013)
19. Andrews, J.G., Baccelli, F., Ganti, R.K.: A tractable approach to coverage and
rate in cellular networks. IEEE Trans. Commun. 59(11), 3122–3134 (2011, 2016)
20. Chiu, S.N., Stoyan, D., Kendall, W.S., Mecke, J.: Stochastic Geometry and Its
Applications. Wiley, New York (2013)
21. Cover, T.M., Thomas, J.A.: Elements of Information Theory. Wiley, New York
(1991, 2016)

Joint Mode Selection and Resource Allocation
in Underlaying D2D Communication
Wei Zhang, Wanbing He, Dan Wu(&), and Yueming Cai
Institute of Communications Engineering, PLA UST, Nanjing 210007, Jiangsu,
People’s Republic of China
greenery_jul@sina.com, hewanbing0502@icloud.com,
wujing1958725@126.com, caiym@vip.sina.com
Abstract. Device-to-device (D2D) communication as an underlay to cellular
networks is a promising technology to improve network capacity and user
experience. However, it depends on elegant resource management between
cellular users and D2D pairs. In this work, we study the problem of D2D
communication underlaying cellular networks sharing uplink resources, which
focuses on maximizing the sum rate of D2D pairs while guaranteeing the quality
of existing cellular users. A three-step scheme is proposed. We ﬁrst conduct
mode selection to decide whether a D2D pair can share links with a cellular user.
And then, we match a cellular user with each D2D pair based on the principle of
fairness and try to maximize the sum rate of D2D pairs. Finally, a joint power
control strategy is developed and a closed-form of solution is provided. The
superiority of the proposed scheme is demonstrated in the numerical results.
Keywords: D2D communication  Mode selection  Resource allocation
Non-convexity  Joint optimization
1
Introduction
With the explosive growth of information and the increasing demand of user experi-
ence, device-to-device (D2D) technique, as an effective method to relieve the trafﬁc
load of cellular networks and improve local service ﬂexibility, has attracted much
attention in recent years [1]. By enabling two users in proximity to communicate
directly without being relayed by a base station (BS), D2D communication can bring
four types of beneﬁts, that is, proximity gain, reuse gain, hop gain and paring gain,
which may achieve higher rate, lower power consumption and more efﬁcient resource
utilization [2]. Thus, introducing D2D communications into cellular networks is worth
consideration.
However, enabling D2D communication in a cellular network poses some inevitable
challenges [3, 4]. It will generate interference between D2D pairs and cellular users due
to the sharing of links and furthermore it may decrease the QoS (Quality of Service) of
This work is supported by the National Natural Science Foundation of China (No. 61671474,
No. 61371122).
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 206–219, 2018.
https://doi.org/10.1007/978-3-319-72823-0_20

both users. As such, an elegant resource management to coordinate with the interference
is in urgent demand [5, 6]. Resource management includes mode selection and resource
allocation, which refers to the allocation of link and power. D2D communication
underlaying cellular networks can either exploit cellular mode, in which the commu-
nication will be relayed by the BS, or communicate directly sharing links with primary
cellular users, referred to as reuse mode, which can further improve the spectral efﬁ-
ciency [7]. Link allocation should be jointly considered with mode selection, that is, a
D2D pair with reuse mode chooses which cellular user to share its link. Power control
includes power allocation among D2D pairs, as well as cellular users, which will ulti-
mately achieve optimal network performance with limited power resource.
There are some existing works that study resource management for D2D com-
munication underlaying cellular networks. In particular, an interference limited area
(ILA) is suggested in [8], where a D2D pair cannot be admitted to reuse the links of
cellular users to decrease their quality of communication. To further mitigate the
interference from D2D transmission to cellular communication, a distance-based
resource allocation scheme is developed in [9], based on the outrage probability
analysis while restricting the maximum transmit power of D2D pairs. [10] provides an
optimal resource sharing strategy based on convex optimization, to maximize the rate
of one D2D pair which can share the link resources of all the cellular users in the cell.
However, there is only one D2D pair considered. In [11], a heuristic algorithm is
proposed to match D2D pairs and cellular users, which chooses the cellular users with
higher channel gain to share with D2D pairs with lower interference gain, while in that
case, coordination between both of the users is not considered. [12] jointly considers
three respects of resource management, which exploits maximum weight bipartite
matching based scheme to choose cellular partners for D2D pairs to maximize the
network throughput.
Motivated by the above literature, we investigate D2D communication underlaying
a multi-user cellular network sharing uplink resources. We aim to design a resource
management scheme which jointly considers mode selection, link allocation and power
control to maximize the sum rate of D2D pairs, and meanwhile, to guarantee the QoS
of both cellular users and D2D pairs. The contributions are summarized as follows:
(i) We consider multiple D2D pairs and multiple cellular users in a cell, rather than
only one D2D pair. And we model a joint mode selection and resource allocation
optimization problem, where the QoS requirements of both cellular users and
D2D pairs are simultaneously considered. Moreover, we constrain the total power
budget of D2D pairs.
(ii) We formulate the uplink resource sharing problem into a non-convex optimization
problem, and then, we divide it into three serial subproblems and obtain the
closed-form of the solution. Firstly, we decide an interference limited area
(ILA) for each potential D2D pair and then conduct mode selection based on a
minimum distance metric. Then, we allocate the links of cellular users based on a
principle of fairness to maximize the sum rate of D2D pairs, which will achieve
the tradeoff between the efﬁciency and the fairness of the network [13]. Moreover,
we use Lagrangian Algorithm to simultaneously allocate the power for both
cellular users and D2D pairs.
Joint Mode Selection and Resource Allocation
207

The remainder of the paper is organized as follows. In Sect. 2, we describe the
network model and formulate the optimization problem. The joint mode selection and
resource allocation algorithm is illustrated in Sect. 3. Section 4 presents the numerical
results to demonstrate the performance of the proposed scheme. Finally, Sect. 5 con-
cludes the paper.
2
Problem Formulation
We consider a single cell, where there exist one BS, L cellular users and M D2D pairs,
and the later compose the sets C ¼ 1; . . .; L
f
g and D ¼ 1; . . .; M
f
g, respectively, as
shown in Fig. 1. We assume that each cellular user occupies a frequency band nor-
malized to be one, and then, the transmission links are orthogonal. In order to improve
spectrum efﬁciency, we exploit the underlaying D2D communication sharing uplink
resources with reuse mode. As such, the mutual interference among D2D pairs and
cellular users may become more serious. To facilitate manipulation, we assume that the
link of each cellular user is reused by at most one D2D pair. However, for those lacking
in a proper cellular partner, the D2D pairs conduct cellular mode to communicate
through the BS.
Considering the resource sharing between cellular users and D2D pairs, the SINR
of cellular user i and D2D pair j sharing the link of user i are given respectively by
nc
i ¼
pihc
i
r2
N þ qjgd
j;i
ð1Þ
nd
j ¼
qjhd
j
r2
N þ pigc
i;j
ð2Þ
where r2
N represents Gaussian noise variance on each channel of cellular user i and
D2D pair j. hc
i is denoted as the channel gain from cellular user i to the BS. Similarly,
denote gc
i;j; hd
j , and gd
j;i as the channel gain between cellular user i and the receiver of
D2D pair j, between the transmitter to the receiver of D2D pair j and between the
transmitter of D2D pair j to the BS on frequency i, respectively. Let pi and qj represent
the transmit power of cellular user i and D2D pair j, respectively.
Thus, their rate can be expressed as
Rc
i ðpi; qjÞ ¼ log2ð1 þ nc
i Þ
ð3Þ
Rd
j ðpi; qjÞ ¼ log2ð1 þ nd
j Þ
ð4Þ
Our goal is to maximize the total rate of D2D pairs, and also satisfy the require-
ments of cellular users and D2D pairs, in terms of their individual rate and power limit,
and the total power budget for all D2D pairs sharing the links. The joint mode selection
208
W. Zhang et al.

and resource allocation optimization problem in D2D communication underlaying
cellular system is formulated as
maximize
P
N
j¼1
Rd
j ðpi; qjÞ
ð5Þ
subject to
Rc
i ðpi; qjÞ  qi ; 8i 2 C
ð5aÞ
Rd
j ðpi; qjÞ  cj ; 8j 2 S
ð5bÞ
0  pi  Pi ; 8i 2 C
ð5cÞ
0  qj  Qj ; 8j 2 S
ð5dÞ
X
N
j¼1
qj  Q
ð5eÞ
where SðSD; S 1; . . .; N
f
gÞ denotes the set of D2D pairs. qi and cj represent the rate
threshold of cellular user i and potential D2D pair j, respectively, and hence, (5a) and
(5b) ensure that both cellular users and potential D2D pairs reach their minimum QoS
requirements in terms of rate. (5c) and (5d) guarantee that the transmit power of cellular
users and potential D2D pairs are within the maximize limit Pi and Qj, respectively.
(5e) represents Q is the total power budget of the D2D pairs on all links.
Since it is a nonconvex problem, it is difﬁcult to ﬁnd the solution of (5). To
facilitate manipulation, we will transform it into a convex one and provide a fully
analytical characterization of the optimized solution to (5). We divide the optimization
problem into three subproblems since the matching process of D2D pairs and cellular
users belongs to the problem based on discrete space, while the power allocation
problem belongs to continuous space.
Cellular user 3
Cellular user 2 
Cellular-BS link
Cellular user 4
Cellular user 1 
D2D link
Tx
Interference link
Rx
D2D pair 1 
Fig. 1. System model of D2D communication underlaying cellular networks.
Joint Mode Selection and Resource Allocation
209

3
Joint Mode Selection and Resource Allocation Algorithm
In this section, to solve the joint mode selection and resource allocation optimization
problem in underlaying D2D communication, we divide the joint optimization problem
into three subproblems, referred as mode selection, link allocation and power control.
Then, we propose an optimization algorithm and analyze the properties of the scheme.
3.1
Distance-Oriented Admission Control of D2D Pairs
Before introducing D2D pairs into the cellular network, we ﬁrst consider which mode
to choose for them. That is, we need to determine whether a potential D2D pair can
reuse the links of existing cellular users. If a potential D2D pair is admitted, it selects
reuse mode, and furthermore, we need to decide a reuse cellular partner for it. If not, its
communication will be relayed by the BS with cellular mode.
ForeachpotentialD2Dpair,ifitisadmittedtoreuseacellularuser’slink,theconstraints
in (5a), (5b), (5c), (5d) must be primarily satisﬁed. As such, we obtain a set of reuse
candidates for potential D2D pair j and denote them as Rj and then potential D2D pair j is
admittedifRj ¼ ;.Sincethechannelconditionandthemutualinterferencemainlydepend
on distance, we will divide an ILA for each potential D2D pair based on the distance
between two kinds of users, outside of where the cellular candidates in Rj are distributed.
It can be veriﬁed that it is a linear programming problem, and hence, there will be a
feasible area for potential D2D pair j, as the shadow part shown in Fig. 2. The line lc
and ld represent constraints (5a) and (5b) with equality, respectively. Let pi;min and
qj;min denote the minimum power of cellular user i and D2D pair j, respectively, which
indicate there is no link sharing and no interference between them.
To guarantee that there will be a feasible root of the linear programming problem,
point T,ðpi;T; qj;TÞ, as shown in Fig. 2, must be within the square area, that is, they
satisfy constraints (5c) and (5d). And then, there may be feasible power for both
cellular user i and potential D2D pair j in the shadow area. Computing the intersection
of lc and ld in the ﬁrst place, and point T, ðpi;T; qj;TÞ can be expressed as
pi;T ¼
ð2qi1Þr2
N½hd
j þ ð2cj1Þgd
j;i
hc
i hd
j ð2qi1Þð2cj1Þgc
i;jgd
j;i
qi;T ¼
ð2cj1Þr2
N½hc
i þ ð2qi1Þgc
i;j
hc
i hd
j ð2qi1Þð2cj1Þgc
i;jgd
j;i
8
>
<
>
:
ð6Þ
where pi;T and qi;T represent the transmit power of cellular user i and potential D2D
pair j to meet constraints (5a) and (5b) with equality, respectively. If point T is within
the square area, any point in the shadow area can manage a feasible power pair for
cellular user i and potential D2D pair j. However, if not, potential D2D pair j cannot
reuse the link of cellular user i. As such, the admissible condition is,
0\pi;T  Pi
0\qj;T  Qj

ð7Þ
210
W. Zhang et al.

Accordingly, combining with the distance based path loss model, hi;j ¼ Kda
i;j , we can
impose a distance control between cellular users and potential D2D pairs to decide Rj.
Denote Li;j as the distance between cellular user i and the receiver of potential D2D pair j.
We have the following proposition that characterizes the admission control of a potential
D2D pair.
Proposition 1. Potential D2D pair j can be admitted to reuse the link of cellular user
i, if and only if Li;j  Lmin
i;j , where Lmin
i;j
is the minimum distance limit between cellular
user i and the receiver of potential D2D pair j, and it is given by, (i)
KPið2qi1Þð2cj1Þgd
j;i
Pihc
i hd
j ð2qi1Þr2
N½hd
j þ ð2cj1Þgd
j;i

1
a
, if log2ð1 þ
Pihc
i
Qigd
j;i þ r2
NÞ  qi: (ii) ½
Kð2qi1Þð2cj1ÞðQjgd
j;i þ r2
NÞ
Qjhc
i hd
j ð2cj1Þr2
Nhc
i

1
a,
if log2ð1 þ
Pihc
i
Qjgd
j;i þ r2
NÞ  qi .
Proof. According to constraint (7), we can simplify it into the following
gc
i;j 
Pihc
i hd
j ð2qi1Þr2
N½hd
j þ ð2cj1Þgd
j;i
Pið2qi1Þð2cj1Þgd
j;i
¼ gc
Qjhc
i hd
j ð2cj1Þr2
Nhc
i
ð2qi1Þð2cj1ÞðQjgd
j;i þ r2
NÞ ¼ gd
8
>
>
<
>
>
:
ð8Þ
To move a step forward, it can be transformed into
gc
i;j 
gc;
log2ð1 þ
Pihc
i
Qigd
j;i þ r2
NÞ  qi
gd;
log2ð1 þ
Pihc
i
Qjgd
j;i þ r2
NÞ [ qi
8
>
<
>
:
ð9Þ
Finally, we can get the distance limit Lmin
i;j
according to path loss model.
Fig. 2. Admission control of D2D pair j.
Joint Mode Selection and Resource Allocation
211

Thus, we set an ILA for each potential D2D pair, and a potential D2D pair can only
match with the cellular users outside of its ILA, since the mutual interference between
them cannot be too serious to decrease their QoS, or the D2D pair must be far enough
from the potential cellular partner. If there is no cellular user outside of a potential D2D
pair’s ILA, it can only select cellular mode, instead.
3.2
Link Allocation for D2D Pairs
Here, we investigate how to choose a cellular user in Rj for D2D pairs with reuse
mode to maximize the rate of all these D2D pairs while guaranteeing that each of them
can access a cellular candidate to share its link.
Without loss of generality, we assume that each cellular user and D2D pair has the
same transmit power respectively, which ensures that every D2D pair has the same
chance to reuse links and the same chance for cellular users to be reused. According to
212
W. Zhang et al.

the previous subsection, we have determined Rj for each D2D pair and S by ﬁnding
D2D pair j when it satisﬁes Rj ¼ £.
There are three steps in the link allocation algorithm. We ﬁrstly calculate Rj

,
which denotes the number of Rj, and obtain M, which contains the D2D pairs with
Rj

 in increasing order. According to this, we can try to allocate cellular users with
priority to those with less candidates and ensure each D2D pair will ﬁnd a partner.
Then, considering that different D2D pairs may have only one cellular candidate, if
there is more than one D2D pair that can only share the link of cellular user i, we
allocate link i to D2D pair j which can achieve the maximum rate, as shown in line 4
to 13. Finally, we match the remaining D2D pairs with cellular candidates in the order
of M, as line 14 to 17 indicate. And we will ﬁnd a union of D2D-cellular pairs which
can maximiz P
j2S
Rd
i ðpi; qjÞ. Therefore, we can guarantee a kind of fairness for D2D
pairs, and also achieve the maximum beneﬁt in that case.
3.3
Optimal Power Control for Cellular Users and D2D Pairs
In previous subsections, we have matched D2D pair with appropriate cellular users.
Hence, we denote the cellular user and its link which is reused by D2D pair j as index
j as well. We rewrite problem (5) as,
maximize
P
N
j¼1
Rd
j ðpj; qjÞ
ð10Þ
subject to
Rc
j ðpj; qjÞ  qj ; 8j 2 C
ð10aÞ
Rd
j ðpj; qjÞ  cj ; 8j 2 S
ð10bÞ
0  pj  Pj ; 8j 2 C
ð10cÞ
0  qj  Qj ; 8j 2 S
ð10dÞ
X
N
j¼1
qj  Q
ð10eÞ
Then, we denote aj ¼ hc
j =r2
N, bj ¼ hd
j =r2
N, cj ¼ gd
j =r2
N, and hj ¼ gc
j =r2
N as the
normalized channel gains. And the rate of D2D-cellular pair j is expressed as,
Rc
j ðpj; qjÞ ¼ log2ð1 þ
pjaj
1 þ qjcj
Þ
ð11Þ
Rd
j ðpj; qjÞ ¼ log2ð1 þ
qjbj
1 þ pjhj
Þ
ð12Þ
Joint Mode Selection and Resource Allocation
213

Now, we will propose an optimal power control strategy for all these paired users to
solve the problem in (10).
Proposition 2. Denote ðp
j ; q
j Þ as the optimal power allocation for problem (10), and
kj ¼ 2qj  1.
Then,
for
all
j ¼ 1; . . .; N,
we
deﬁne
Aj ¼ kjcjhjðajbj þ kjcjhjÞ,
Bj ¼ ðaj þ kjhjÞð2kjcjhj þ ajbjÞ,
Cj ¼ ðaj þ kjhjÞð
aj þ kjhjajbj
k
Þ
and
renew
Qj ¼
min Qj; ajPjkj
kjcj
n
o
: We can get the optimal solution as, (i) if P
N
j¼1
Qj  Q, then, q
j ¼ Qj,
p
j ¼
kjð1 þ cjQjÞ
aj
. (ii) if P
N
j¼1
Qj [ Q, then, q
j ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
B2
j 4AjCjðkÞ
p
Bj
2Aj

Qj
0
, p
j ¼
kjð1 þ cjq
j Þ
aj
, where
½ Qj
0 indicates the projection onto the interval 0; Qj

	
.
Proof. The rate of D2D pair j deﬁned in (12) is monotonically decreasing by
increasing pj, when qj is ﬁxed. Moreover, to satisfy the constraint in (10a), we can get
pj 
kjð1 þ cjqjÞ
aj
, and hence, the optimal p
j is obtained when p
j ¼ pj;min ¼
kjð1 þ cjqjÞ
aj
. Then,
we substitute it into (12) and it can be further expressed as
Rd
j ðp
j ; qjÞ ¼ log2ð1 þ
ajbjqj
aj þ kjhj þ kjcjhjqj
Þ
ð13Þ
Now, we investigate how to decide qj in (13) to maximize the sum rate of D2D
pairs.
Denote hðqjÞ ¼
ajbjqj
aj þ kjhj þ kjcjhjqj, we can easily conﬁrm that
h
0ðqjÞ ¼
ajbjðaj þ kjhjÞ
ðaj þ kjhj þ kjcjhjqjÞ2  0
ð14Þ
h
00ðqjÞ ¼  2kjajbjcjhjðaj þ kjhjÞ
ðaj þ kjhj þ kjcjhjqjÞ3  0
ð15Þ
It is obviously that hðqjÞ is a concave function and increases by increasing qj, which
contributes to that Rd
j ðp
j ; qjÞ is also a concave function and increases with the
increasing of qj. Now, we have transformed the problem in (5) which is nonconvex into
a convex one indicated in (10).
In order to maximize Rd
j ðp
j ; qjÞ in (13), it is essential to determine the feasible
region of qj. The power constraint in (10c) is equal to qj  ajPjkjÞ
kjcj , therefore, we renew
the power limit as Qj ¼ min Qj; ajPjkj
kjcj
n
o
. To solve the problem in (10), we consider
two different situations, (i) if P
N
j¼1
Qj  Q, we can take q
j ¼ Qj to maximize Rd
j ðp
j ; q
j Þ.
And accordingly, p
j ¼
kjð1 þ cjQ
j Þ
aj
. (ii) if P
N
j¼1
Qj [ Q we use Lagrangian Algorithm to
214
W. Zhang et al.

solve the problem: lðq,kÞ ¼ ln2 P
N
j¼1
log2ð1 þ
ajbjqj
aj þ kjhj þ kjcjhjqjÞ þ kðQ  P
N
j¼1
qjÞ with k  0.
Then, we will illustrate how to ﬁnd the optimal solution with the constraint P
N
j¼1
q
j ¼ Q.
The ﬁrst partial derivative of lðq,kÞ with respect to k is given as,
@lðq,kÞ
@qj
¼
ajbjðaj þ kjhjÞ
ðaj þ kjhj þ kjcjhjqjÞ2 þ ajbjqjðaj þ kjhj þ kjcjhjqjÞ
 k
ð16Þ
The solution of problem (10) is equal to that @lðq, kÞ
@qj
¼ 0 and it is obvious that there
will be a feasible solution only when k is positive. Therefore, we can get a quadratic
equation expressed as Ajq2
j þ Bjq
j þ CjðkÞ ¼ 0, with Aj; Bj; CjðkÞ deﬁned in proposi-
tion 2, and the projection of the positive solution for the equation is onto ½0; Qj.
By now, we are able to investigate how to get a proper k to determine q
j , which is
difﬁcult with direct computing. We can primarily conﬁrm an interval ½0; kmax, where
kmax ¼ maxj2S
ajbj
aj þ kjhj
n
o
, according to CjðkÞ  0, which ensures B2
j  4AjCjðkÞ in
proposition 2 positive. Moreover, given the condition that q
j
is monotonically
decreasing as k increases, and that we can absolutely ﬁnd a positive root in the feasible
region, bisection method is exploited to obtain the optimal k. Thus, we can ﬁnally
determine an optimal k to get the power allocation strategy as ðp
j ; q
j Þ.
4
Numerical Results
The simulation setup is as follows: Consider a hexagonal cell with a radius of 250 m,
where the BS is centered, and some cellular users and potential D2D pairs are randomly
where the BS is centered, and some cellular users and potential D2D pairs are randomly
distributed. Each potential D2D transmitter is 50 m away from its receiver. The power
spectral density of additive white Gaussian noise is 108 W/Hz, and the QoS threshold
of cellular users is qi ¼ cj ¼ 1 bit=s. It is veriﬁed in [10] that the maximum SNR of
cellular user i is aiPi, and without loss of generality, we set Pi for each cellular user so
that they can reach the same maximum SNR.
Figure 3 shows the sum rate of D2D pairs at different total D2D SNR, which is
denoted by Q=r2
N [10], comparing the performance with different amount of cellular
users. As the number of cellular users increases, the rate of D2D pairs derived by our
proposed scheme also increases, however, the speed of the increasing is slower
gradually. When there are only 8 or 16 cellular users for the 4 D2D pairs we set in the
cell, the sum rate of the D2D pairs increases obviously. However, when the amount of
cellular users is up to 32 and above, the performance tends to approach. Note that, for a
ﬁxed amount of D2D pairs, if there exists only a small number of cellular candidates,
there is a larger space for them to improve the performance, and their rate will increase
Joint Mode Selection and Resource Allocation
215

dramatically with the increasing of cellular users. While if they have well enough
cellular candidates to choose, they can achieve a fairly high rate as a whole and the
effect of increasing cellular users is less obvious.
As Fig. 4 indicates, the sum rate of D2D pairs is almost linearly increased by
increasing the power limit of each D2D pair. And at a ﬁxed power limit, the D2D pairs
with more cellular users to reuse perform better. Actually, with D2D power limit
increasing, D2D pairs will choose different cellular users to reuse and they are more
likely to obtain higher rate.
14
12
10
8
6
4
8 cellular users
16 cellular users
2 
32 cellular users
64 cellular users
128 cellular users
0
0
7
5
6
0
6
75
Total D2D SNR (dB)
Sum Rate of D2D Pairs (bit/s)
Fig. 3. The sum rate of D2D pairs versus total D2D SNR with different amount of cellular users.
12
10
8
6
4
8 cellular users
16 cellular users
2
32 cellular users
64 cellular users
128 cellular users
0
10 
11 
12 
13 
14 
15 
16
D2D Power Limit (dBm)
Sum Rate of D2D Pairs (bit/s)
Fig. 4. The sum rate of D2D pairs versus D2D power limit with different amount of cellular
users.
216
W. Zhang et al.

To comparison, we compare the proposed scheme to two other algorithms,
(i) Global search: it doesn’t divide an ILA for D2D pairs or consider fairness when
D2D pairs choose cellular candidates to share. Since the global search only deals
with link allocation, we incorporate the proposed power control strategy into it.
(ii) Suboptimal power control [10]: it is based on waterﬁlling algorithm, in which the
cellular users simply use their maximum power.
We consider a cell with 16 cellular users and 4 potential D2D pairs. Figure 5
indicates that the proposed scheme can obtain higher D2D rate than suboptimal power
control strategy, while lower than global search. After ILA division in the ﬁrst step, our
proposed scheme performs better than global search in pairing, in terms of computa-
tional complexity. And the suboptimal power control only optimizes the power of D2D
pairs with a ﬁxed cellular users’ power. As shown in Fig. 6, with the increasing of total
D2D SNR, the average energy efﬁciency of cellular users is monotonically decreasing.
Since D2D pairs use a higher power and then cause more severe interference to their
shared cellular users, cellular users have to increase their transmit power to reach the
rate threshold. The proposed scheme can perform better than two other algorithms with
regard to energy efﬁciency of cellular users. As the simulation result indicates, D2D
pairs tend to choose cellular users which are far away from them and the BS which
cause less interference in global search, and in that case, cellular users will use a higher
transmit power. Moreover, in the suboptimal power control scheme, cellular users
simply use their ﬁxed maximum power. Then, by jointly optimizing the power of
D2D-cellular pair while satisfying the total SNR constraint, our scheme achieves better
performance.
14
12
10
8
6
4
2 
Proposed
Global Search
Suboptimal Power Control
0
0
7
5
6
0
6
75
Total D2D SNR (dB)
Sum Rate of D2D Pairs (bit/s)
Fig. 5. The sum rate of D2D pairs versus total D2D SNR.
Joint Mode Selection and Resource Allocation
217

5
Conclusion
In this paper, we investigated D2D communication as an underlay sharing uplink
resources in cellular networks and proposed a joint mode selection and resource
allocation scheme which jointly considers mode selection, link allocation and power
control. In particular, we maximized the sum rate of D2D pairs with guaranteed QoS
requirements of existing cellular users, as well as D2D pairs. Moreover, we set a
fairness principle to ensure that each D2D pair shares links with a cellular user.
Simulation results demonstrated that the proposed scheme brings substantial perfor-
mance improvements.
References
1. Feng, D., Lu, L., Wu, Y.Y., Li, G.Y., Li, S., Feng, G.: Device-to-device communications in
cellular networks. IEEE Commun. Mag. 52(4), 49–55 (2014)
2. Wei, L., Hu, R.Q., Qian, Y., Wu, G.: Enable device-to-device communications underlaying
cellular networks: challenges and research aspects. IEEE Commun. Mag. 52(6), 90–96
(2014)
3. Wu, D., Wang, J., Hu, R.Q., Cai, Y.: Energy-efﬁcient resource sharing for mobile device-to-
device multimedia communications. IEEE Trans. Veh. Technol. 63(5), 2093–2103 (2014)
4. Wu, D., Cai, Y., Hu, R.Q., Qian, Y.: Dynamic distributed resource sharing for mobile D2D
communications. IEEE Trans. Wireless Commun. 14(10), 5417–5429 (2015)
5. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allocation in
spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE Trans. Commun.
62(7), 2366–2377 (2014)
6. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wang, X., Quek, T.: Resource allocation for
cognitive small cell networks: a cooperative bargaining game theoretic approach. IEEE
Trans. Wireless Commun. 14(6), 3481–3493 (2015)
15
10
5
0
-5
-10 
-15 
Proposed
Global Search
Suboptimal Power Control
0
7
5
6
0
6
75
Total D2D SNR (dB)
Average Energy Efficiency of Cellular Users (bps/W)
Fig. 6. Average energy efﬁciency of cellular users versus total D2D SNR.
218
W. Zhang et al.

7. Asadi, A., Wang, Q., Mancuso, V.: A survey on device-to-device communication in cellular
networks. IEEE Commun. Surv. Tuts. 16(4), 1801–1818 (2014). Fourth quarter
8. Min, H., Lee, J., Park, S., Hong, D.: Capacity enhancement using an interference limited area
for device-to-device uplink underlaying cellular networks. IEEE Trans. Wireless Commun.
10(12), 3995–4000 (2011)
9. Duong, Q., Shin, O.: Distance-based interference coordination for device-to-device
communications in cellular networks. In: Proceedings of Ubiquitous and Future Networks
(ICUFN), pp. 776–779, Da Nang, July 2013
10. Wang, J., Zhu, D., Zhao, C., Li, G.Y., Lei, M.: Resource sharing of underlaying device to
device and uplink cellular communications. IEEE Commun. Lett. 17(6), 1148–1151 (2013)
11. Meshgi, H., Zhao, D., Zheng, R.: Joint channel and power allocation in underlay multicast
device-to-device communications. In: Proceedings of the IEEE International Conference on
Communications (ICC), pp. 2937–2942, London, June 2015
12. Feng, D., Lu, L., Wu, Y.Y., Li, G.Y., Feng, G., Li, S.: Device-to-device communications
underlaying cellular networks. IEEE Trans. Commun. 61(8), 3541–3551 (2013)
13. Zhang, H., Jiang, C., Mao, X., Chen, H.H.: Interference-limit resource optimization in
cognitive femtocells with fairness and imperfect spectrum sensing. IEEE Trans. Veh.
Technol. 65(3), 1761–1771 (2016)
Joint Mode Selection and Resource Allocation
219

PAPR Reduction with Amplitude Clipping
and Subband Filter in Filtered-OFDM System
Changsen Nie and Yong Bai(&)
State Key Lab of Marine Resource Utilization in South China Sea,
College of Information Science and Technology, Hainan University,
58 Renmin Ave., Haikou 570228, Hainan, China
bai@hainu.edu.cn
Abstract. To reduce the PAPR (Peak-to-Average Power Ratio) in the
Filtered-OFDM (F-OFDM) system, we propose an amplitude clipping method
working together with the subband ﬁlter in the F-OFDM system. Firstly, a
power level is preset to clip the real and imaginary parts of F-OFDM signals for
reducing the peak energy of transmitted signals. Then the spectrum leakage and
distortion caused by amplitude clipping are mitigated by the designed subband
ﬁlter of F-OFDM system. The simulation results demonstrate that such a
combined method can suppress PAPR effectively and maintains good BER (Bit
Error Rate) performance compared with the traditional OFDM system.
Keywords: F-OFDM  PAPR  Subband ﬁlter  Amplitude clipping
1
Introduction
OFDM (Orthogonal Frequency Division Multiplexing) [1, 2] is the main multi-carrier
modulation technology that is widely used in 4G system. OFDM offers a considerable
high spectral efﬁciency, power efﬁciency, and immunity to the frequency selective
fading channels. There are more challenges for 5G mobile communication technologies
to support stricter transmitting requirements. F-OFDM (Filtered-OFDM) [3–5], OFDM
with subband ﬁlter, is proposed by Huawei as an approach to reduce high frequency
spectrum leakage and large out-of-band interference for 5G system [6–8].
One challenging issue in OFDM system is high Peak-to-Average Power Ratio
(PAPR) of transmitted signals. F-OFDM signals also consist of many independent and
orthogonal sub-carriers, and have the problem of high PAPR [9–11]. Meanwhile, the
subband ﬁlter in the F-OFDM system can also increase the PAPR. Hence, efﬁcient
PAPR reduction is needed for F-OFDM system. The PAPR reduction schemes can
mainly be categorized into signal scrambling techniques (e.g., block codes and PTS)
and signal distortion techniques such as amplitude clipping. Amplitude clipping [12,
13] is the simplest technique for PAPR reduction. It is a predistortion technology that
basically clips the parts of the signals when they are above a preset clipping level.
However, clipping method introduces both in-band distortion and out-of-band radiation
into OFDM signals, which degrades the system performance such as BER and spectral
efﬁciency. To counter the drawbacks of amplitude clipping, one ﬁlter can be added
after clipping to reduce the in-band distortion and out-of-band radiation.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 220–227, 2018.
https://doi.org/10.1007/978-3-319-72823-0_21

This paper proposes to reduce PAPR of F-OFDM system [14, 15] by amplitude
clipping and subband ﬁltering. With our proposed method, the PAPR of the F-OFDM
system can be reduced, and the out-of-band radiation caused by amplitude clipping can
be reduced by the inherent subband ﬁlter in F-OFDM system. Hence, it is not necessary
to design a special ﬁlter after clipping in our approach. The simulation results
demonstrated that our proposed method can suppress PAPR effectively and still
maintains a good BER performance in F-OFDM system.
This paper is organized as follows. In Sect. 2, we describe the PAPR reduction
method for F-OFDM system by using amplitude clipping and subband ﬁlter. Section 3
presents and discusses the simulation results of our proposed method. Section 4 con-
cludes this paper.
2
F-OFDM with Amplitude Clipping and Subband Filter
F-OFDM is an improvement on the basis of OFDM. F-OFDM has lower out-of-band
leakage by dividing the whole band into multiple subbands and add subband ﬁlter in
the sender and receiver of OFDM system. This helps F-OFDM system to have higher
spectral efﬁciency compared with OFDM. Moreover, F-OFDM system enables ﬂexible
waveforms in the 5G networks. Each subband of F-OFDM system can be processed
independently by conﬁguring different parameters, such as sub-carrier spacing, IFFT
points and CP (Cyclic Preﬁx) length, to make the waveform meet the requirements for
different 5G scenarios. The system model of F-OFDM system is shown in Fig. 1.
Compared with traditional OFDM system, the F-OFDM system adds two new mod-
ules, subcarrier mapping and subband ﬁlter.
To reduce the high PAPR in F-OFDM system, our proposal utilizes amplitude
clipping technology and the subband ﬁlter in F-OFDM system. The added clipping
module (in red color) is shown in Fig. 1. The power level is preset to control the peak
values of F-OFDM signals, and the spectrum leakage can be suppressed by the
designed subband ﬁlter.
Subband 1 
data
Subband 2 
data
Subcarrier 
mapping 1
Subcarrier 
mapping 2
IFFT N(2)
IFFT N(1)
Add CP1
Add CP2
D/A
D/A
Carrier 
modulation
Carrier 
modulation
Subband 1 
filter
Subband 2 
filter
Subband 1 
data
Subband 2 
data
 Signal 
detection
FFT N(2)
FFT N(1)
Remove 
CP1
Remove 
CP2
A/D
Carrier 
demodulation
Carrier 
demodulation
Subband 1 
filter
Subband 2 
filter
A/D
 Signal 
detection
Clipping
Clipping
Channel
Fig. 1. F-OFDM system model with PAPR reduction (Color ﬁgure online)
PAPR Reduction with Amplitude Clipping and Subband Filter
221

2.1
Subcarrier Mapping
The F-OFDM algorithm need to give index numbers of all subcarriers and map dif-
ferent subband data to different sub-carriers separated in frequency domain. The sub-
carrier mapping function ensures that different subbands are conﬁgured with different
parameters for simultaneous transmission and the signals can be decoupled in the
receiver.
Figure 2 shows an example by taking two subbands. It is assumed that the number
of subcarriers of the ﬁrst subband is M1, the number of subcarriers of the second
subband is M2, and the size of IFFT points is 2048. The serial number of 2048
subcarriers is [Kmin Kmax]. Kmin and Kmax is the integers within the scope of [−1023,
1024]. We suppose the number of subcarriers of guard band for the ﬁrst subband is N1,
and the number of subcarriers of guard band for the second subband is N2.
The serial number of the sub-carriers of the second subband can be calculated by
½Kmax þ N1
2
þ N2 þ 1; Kmax þ N1
2
þ N2 þ M2
ð1Þ
There Kmax þ N1 must be an even number.
For example, there are two subbands with band width 720 kHz, and suppose that
the sub-carrier spacing of the ﬁrst subband is 15 kHz, the second subband sub-carrier
spacing is 30 kHz, that means M1 = 48, M2 = 24. Then the serial number of the ﬁrst
subband can be set as [−24,−1] [1,24], the sub-carrier with number 0 can be considered
to be the direct current component without data mapping in it. We assume N1 = 0,
N2 = 1, then the sub-carrier number of the second subband will be [14,37]. To
determine the values of N1 and N2, we need to consider the power spectrum, the
interference between subbands and the parameters of all the subbands. To simplify the
analysis, our work in this paper only analyzes the performance of PSD and PAPR in
one subband.
2.2
The PAPR Reduction with Amplitude Clipping
PAPR is deﬁned as the ratio of maximum peak power and mean power, which is
represented as
N1
N2
M1
M2
Subband 1
Subband 2
Fig. 2. Subcarrier mapping between subbands
222
C. Nie and Y. Bai

PAPRdB ¼ 10 lg
max
0  n\N ðjxnj2Þ
1
N
PN1
n¼0 jxnj2
(
)
ð2Þ
Complementary cumulative distribution function (CCDF) can be used to evaluate
the performance of PAPR. CCDF shows the possibility of PAPR that exceeds a given
threshold. Amplitude clipping technology reduces the peak energy of signal by setting
a power level. However, traditional amplitude clipping method can lead to signal
distortion and out-of-band leakage after clipping process, and it needs to add a ﬁlter to
mitigate this issue. Our proposal combines the subband ﬁlter in F-OFDM system and
amplitude clipping technology. Thus, the subband ﬁlter plays another role in our
approach to mitigate the drawbacks of amplitude clipping. The subband ﬁlter in
F-OFDM system can reduce frequency spectrum leakage and out-of-band interference
effectively. Hence, it is not necessary to design a special ﬁlter after clipping in our
proposed approach. Meanwhile, F-OFDM system divides the whole band into multiple
subbands, and we can perform clipping and ﬁltering in each subband.
Denote the send signals as xn, the clipping process on the real part and imaginary
part of the transmitted signals can be represented as
ReðXnÞ ¼
ReðxnÞ
jxnj  A
p  ReðxnÞ
jxnj [ A

ð3Þ
ImðXnÞ ¼
ImðxnÞ
jxnj  A
p  ImðxnÞ
jxnj [ A

ð4Þ
where Xn is the F-OFDM signal after clipping, A is the given power threshold, p is the
limiting factor with scope of [0,1]. The peak energy of F-OFDM signal can be sup-
pressed directly by clipping process. Then Xn will be ﬁltered by the subband ﬁlter,
which can reduce the out-of-band leakage effectively and improve the performance of
transmitted signals. In Sect. 3, the simulation results will demonstrate that our proposed
method can suppress PAPR effectively and still maintains good BER performance in
F-OFDM system.
2.3
Design of Subband Filter
It can be noted in the F-OFDM system block diagram that the F-OFDM signal is
transformed to the time domain after IFFT before the subband ﬁlter. It is discrete time
domain signal on each sub-carrier. We need to design D/A transfer ﬁlter gðtÞ to transfer
the discrete signal to continuous wave signal (e.g., rectangular wave, square-root raised
cosine wave). To reduce high PAPR of the signal, the signal is clipped after carrier
modulation by setting a power level to reduce peak energy and the clipped signal is
further ﬁltered by the subband ﬁlter. The subband ﬁlter can reduce the out-of-band
leakage and the signal distortion caused by clipping process. The design of subband
ﬁlter uses the traditional window function method, that is to add different window
functions to the Sinc function in time domain. It can be expressed by
PAPR Reduction with Amplitude Clipping and Subband Filter
223

Wsin c  Wwin ¼ Wfilter
ð5Þ
The design of subband ﬁlter in this paper is based on Hanning window which is
known as cosine square or ascending cosine window. The time domain form of
Hanning window can be expressed as
W n
ð Þ ¼ 1
2 1  cos
2pn
N  1




RNðnÞ
ð6Þ
The spectral function of Hanning window can be represented as
W ejx


¼
0:5WR x
ð Þ þ 0:25 WR x 
2p
N  1


þ WR x þ
2p
N  1





	
ej N1
2
ð
Þx
ð7Þ
¼ W x
ð Þej N1
2
ð
Þx
ð8Þ
where WR ejx
ð
Þ ¼ WR x
ð Þej N1
2
ð
Þx:
When N is very greater than 1, it can be approximated as
W x
ð Þ  0:5WR x
ð Þ þ 0:25 WR x  2p
N




þ WR x þ 2p
N


ð9Þ
The sum of the three parts makes the sidelobe largely canceled out, and energy is
more concentrated in the main lobe.
When designing the subband ﬁlter, the ﬁlter length N need to be chosen to be an
appropriate value because larger N helps to reduce the spectrum leakage but may lead
to larger PAPR and degrade the BER performance.
3
Simulation and Discussion
3.1
Simulation Parameters of F-OFDM System
In the simulated F-OFDM system, the size of IFFT is 2048, the number of effective
sub-carriers is 336, and the other sub-carriers are set to zero. The sub-carrier spacing is
set to 15 kHz according to 3GPP standard, then the subband band width is 5.04 MHz.
In addition, the CP length is 128. Table 1 shows the parameters of F-OFDM system for
simulation. We choose 4QAM as the modulation method on the subcarriers. The
sending signal before the subband ﬁlter is rectangular wave signal. The order of the
subband ﬁlter (N −1) is chosen to be 128 to balance the tradeoff between the spectrum
leakage reduction and the BER performance.
224
C. Nie and Y. Bai

3.2
Simulation Results and Discussion
Figure 3 shows the respective PSD (Power Spectrum Density) of clipping OFDM
signal and clipping F-OFDM signal. We can see that the subband ﬁlter results in
smaller out-of-band leakage in the clipping F-OFDM signal than that in the clipping
OFDM signal, and the clipping F-OFDM signal has better PSD performance compares
with clipping OFDM signal. Note that
Figure 4 shows the CCDF of OFDM signal, F-OFDM signal, clipping OFDM
signal and clipping F-OFDM signal. The simulation results show that the subband ﬁlter
deteriorates the PAPR performance such that the PAPR of F-OFDM signal is higher
than that of OFDM signal. We can see clearly that the PAPR of clipping F-OFDM
signal is much lower than that of the F-OFDM signal, which means our proposed
method can reduce PAPR effectively.
Figure 5 shows the BER performance of OFDM and F-OFDM system. It can be
seen that clipping F-OFDM system has a better BER performance than the clipping
OFDM system. The BER of clipping F-OFDM system is a little bit higher than that of
F-OFDM due to the fact that the clipping process causes out-of-band interference. Then
we can know that our proposed method not only has good PAPR performance but also
maintains good BER performance.
Table 1. Parameters of simulation
Parameter
Sub-band
Modulation system
4QAM
Sub-carrier spacing
15 kHz
FFT points
2048
Used sub-carriers
336
CP length
128
Bandwidth
5.04 MHz
Symbol period
1/15 K = 66.67us
Carrier frequency
76.8 MHz
0
20
40
60
80
100
120
140
160
-80
-70
-60
-50
-40
-30
-20
-10
Frequency•
MHz•
Power spectral density•
PSD•
Clipping OFDM
Clipping F-OFDM
Fig. 3. PSD of clipping OFDM signal and clipping F-OFDM signal
PAPR Reduction with Amplitude Clipping and Subband Filter
225

4
Conclusion
Filter-OFDM signals for 5G wireless system also have the problem of high PAPR like
OFDM system. This paper proposes to reduce the PAPR of F-OFDM system by
amplitude clipping and subband ﬁltering. Our proposed approach can suppress the
PAPR of the F-OFDM system and reduce the in-band distortion and out-of-band
radiation by the inherent subband ﬁlter in F-OFDM system. Thus, the subband ﬁlter
plays another role in our approach to mitigate the drawbacks of amplitude clipping.
Hence, it is not necessary to design a special ﬁlter after clipping as is required when
using amplitude clipping in the traditional OFDM system. We investigated our pro-
posal by simulation according to the 3GPP transmission parameters and we demon-
strated that our proposed method can suppress PAPR effectively and maintains a good
BER performance in F-OFDM system.
Acknowledgments. This paper was supported by the National Natural Science Foundation of
China (Grant No. 61561017), National Science & Technology Pillar Program (Grant
No. 2014BAD10B04), Hainan Province Major Science & Technology Project (Grant
No. ZDKJ2016015), Open Sub-project of State Key Laboratory of Marine Resource Utilization
in South China Sea (Grant No. 2016013B), and Hainan Province Natural Science Foundation of
China (Grant No. 617033).
0
1
2
3
4
5
6
7
8
9
10
11
12
10
-2
10
-1
10
0
PAPR(dB)
CCDF
OFDM
F-OFDM
Clipping OFDM
Clipping F-OFDM
Fig. 4. PAPR of OFDM and F-OFDM
-2
0
2
4
6
8
10
12
14
16
18
20
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
SNR/dB
BER
F-OFDM
Clipping OFDM
Clipping F-OFDM
Fig. 5. BERs of OFDM and F-OFDM
226
C. Nie and Y. Bai

References
1. Hmood, J.K., Noordin, K.A.: Mitigation of phase noise in all-optical OFDM systems based
on minimizing interaction time between subcarriers. J. Opt. Commun. 355, 313–320 (2015)
2. Berbra, K., Barkat, M.: A fast spectrum sensing for CP-OFDM cognitive radio based on
adaptive thresholding. J. Sig. Process. 128, 252–261 (2016)
3. Zhang, X., Jia, M., Chen, L., Ma, J.: Filtered-OFDM - enabler for ﬂexible waveform in the
5th generation cellular networks. In: 2015 IEEE Global Communications Conference
(GLOBECOM), pp. 1–6. IEEE Press, New York (2015)
4. Abdoli, J., Jia, M., Ma, J.: Filtered OFDM: a new waveform for future wireless systems. In:
2015 IEEE 16th International Workshop on Signal Processing Advances in Wireless
Communications (SPAWC), pp. 66–70. IEEE Press, New York (2015)
5. Huawei, HiSilicon: R1-164033, f-OFDM scheme and ﬁlter design. Nanjing, China (2016)
6. GokulRaj, N., Umapathy, K.: 5G wireless mesh network 802.11 s load balancing
architecture for 802.11 Bgn radio-PCI interface. J. Procedia Comput. Sci. 87, 252–257
(2016)
7. Panwar, N., Sharma, S., Singh, A.K.: A survey on 5G: the next generation of mobile
communication. Phys. Commun. J. 18, 64–84 (2016)
8. Tong, W., Ma, J., Huawei, P.Z.: Enabling technologies for 5G air-interface with emphasis on
spectral efﬁciency in the presence of very large number of links. In: 2015 21st Asia-Paciﬁc
Conference on Communications, Kyoto, Japan, pp. 184–187 (2016)
9. Singh, S., Kumar, A.: Performance analysis of adaptive clipping technique for reduction of
PAPR in alamouti coded MIMO-OFDM systems. J. Procedia Comput. Sci. 93, 609–616
(2016)
10. Zhou, J., Zhang, Z., Zhang, T.: A combined PAPR-reduction technique for asymmetrically
clipped optical OFDM system. J. Opt. Commun. 366, 451–456 (2016)
11. Naeiny, M.F., Marvasti, F.: Iterative clipping recovery in spatially multiplexed OFDM
systems. J. Sci. Iran. 19, 739–744 (2012)
12. Wang, Y.C., Luo, Z.Q.: Optimized iterative clipping and ﬁltering for PAPR reduction of
OFDM signals. In: IEEE Transactions on Communications, pp. 33–37. IEEE Press, New
York (2011)
13. AliHemmati, R., Azmi, P.: Clipping distortion mitigation in OFDM systems over fading
channels by using DFT-based method. J. Comput. Electr. Eng. 31, 431–443 (2005)
14. Petra, W., Jamal, B., Katsutoshi, K.: Adaptive ﬁltered OFDM with regular resource grid. In:
2016 IEEE International Conference on Communications Workshops, pp. 462–467. IEEE
Press, New York (2016)
15. Cheng, X., He, Y., Ge, B.: A ﬁltered OFDM using FIR ﬁlter based on window function
method. In: IEEE Vehicular Technology Conference. IEEE Press, New York (2016)
PAPR Reduction with Amplitude Clipping and Subband Filter
227

Throughput Maximization for Two-Hop
Decode-and-Forward Relay Channels
with Non-ideal Circuit Power
Hengjing Liang1,2(B), Xiaojie Wen2, Chuan Huang1,2, Zhi Chen1,2,
and Shaoqian Li1,2
1 National Key Laboratory of Science and Technology on Communications,
University of Electronic Science and Technology of China,
Chengdu, People’s Republic of China
lianghj@hotmail.com, {huangch,chenzhi,lsq}@uestc.edu.cn
2 Beijing Institute of Satelite Information Engineering,
Beijing, People’s Republic of China
ziwen7189@aliyun.com
Abstract. This paper studies the throughput maximization problem
for a two-hop relay channel considering non-ideal circuit power. In par-
ticular, the relay operates in a half-duplex manner, and the decode-and-
forward (DF) relaying scheme is adopted. Considering the extra power
consumption by the circuits, the optimal power allocation to maximize
the throughput of the considered system over the inﬁnite time horizon is
investigated. By transforming the non-convex problem into the quasicon-
cave one, the closed-form solution shows that the source and the relay
transmit with certain probability, which is determined by the average
power budget, circuit power consumption, and channel gains. Numerical
results show that the optimal power allocation scheme outperforms other
conventional schemes.
Keywords: Green communication · Relay channel
Throughput maximization · Optimal power allocation
Decode-and-forward (Df)
1
Introduction
Green communication has drawn great attention during the past years. The
energy consumed by communication networks constitute a large portion of total
energy consumption, and will still go up in the future [1]. The growing cost
of fossil fuel energy calls for both environmental and economical demands and
motivations for the design of green communications.
Circuit energy consumption amounts for a signiﬁcant part of the total energy
consumption [2]. In order to save energy, green communication associated with
This work was supported by the National Natural Science Foundation of China under
Grand No. 61401030.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 228–237, 2018.
https://doi.org/10.1007/978-3-319-72823-0_22

Throughput Maximization
229
non-ideal circuit power needs to be designed both energy and spectrum eﬃ-
ciently. In [3], a link adaptation scheme that balances circuit power consumption
and transmission power was proposed in frequency-selective channels. Energy
eﬃciency (EE) maximization problems with circuit energy consumption was also
considered in orthogonal frequency division multiple access in [4]. A throughput
optimal policy considering circuit power was proposed for point-to-point chan-
nels with energy harvesting transmitter [5].
Relaying has been considered as a promising technique to mitigate fading
and extend coverage in wireless networks [6]. The capacity of a classical three-
node relay channel, consisting of a source, a destination, and a single half-duplex
DF relay, was investigated in [7]. Green communication problems in relay net-
works were discussed in [8–10]. In [8,9], energy minimization problems consid-
ering channel state information acquiring energy and signaling overhead were
investigated in single relay selection schemes, respectively. In [10], non-zero cir-
cuit power consumption was considered for a total energy minimization prob-
lem in multihop relay channels. Most of the existing problems associated with
the non-ideal circuit power consumptions focused on the total energy consump-
tion minimization, whereas the throughput maximization problems were rarely
investigated.
In this paper, throughput maximization for a two-hop half-duplex Gaussian
relay channels considering non-ideal circuit power is studied over the inﬁnite
time horizon. The transceiver circuitry consumes a constant amount of power
in the active mode and negligible power in the sleep mode. Under this setup,
the optimal power allocations for the throughput maximization of the two-hop
relay channel is investigated. By solving a max-min problem, the optimal power
allocation shows that the source and the relay transmit either at a certain portion
of time slots or constantly according to diﬀerent average power budgets, circuit
power consumptions, and channel power gains. Then, the average throughput
and asymptotic analysis of the relay channel is studied. Finally, simulation results
show that the optimal power allocation scheme outperforms other conventional
schemes.
The rest of this paper is organized as follows. Section 2 introduces the signal
model of this paper. Section 3 introduces the power consumption model. Section 4
studies the optimal power allocation and the throughput performances in low
SNR and high SNR regimes. Section 5 evaluates the throughput performances
by simulations and ﬁnally Sect. 6 concludes the paper.
2
Signal Model
This paper considers a two-hop relay channel as shown in Fig. 1, which consists
of a source, a destination, and a half-duplex relay. The source sends informa-
tion to the destination via the relay, and the direct link is unavailable. Slotted
transmission scheme is adopted, and each time slot is with duration T.

230
H. Liang et al.
Then, channel input and output relationship of the considered relay channel
is introduced. Denote the channel coeﬃcients of the source-relay and the relay-
destination links as gSR and gRD, respectively, and then the channel power gains
of the two links are given by
hSR = |gSR|2,
hRD = |gRD|2,
(1)
which are all constants across the time slots.
Source
Destination
Relay
Fig. 1. A two-hop relay channel.
When the DF relaying scheme is adopted, it operates in a half-duplex manner
(one time slot is then divided into two phases), and the information encoding
and decoding processes are described as follows:
1. In the ﬁrst phase of time slot i, the source transmits x (i) to the relay with
power PS (i);
2. Then, the received signal at the relay during the ﬁrst phase of time slot i is
given as
yR (i) = gSRx (i) + nR (i) ,
(2)
where nR (i) is the independent and identically distributed (i.i.d.) circularly
symmetric complex Gaussian (CSCG) noise with zero mean and unit variance.
Next, the relay decodes the source message, re-encodes it into a new signal
˜x (i), and forwards ˜x (i) to the destination with power PR (i).
3. Finally, the destination receives the signals over the second phase of time slot
i, and the received signal yD (i) at the destination is given as
yD (i) = gRD˜x (i) + nD (i) ,
(3)
where nD (i) is the i.i.d. CSCG noise with zero mean and unit variance.
For the purpose of exposition, consider the case that the two phases in one
time slot are with equal length. Thus, the transmission rate for the DF relaying
scheme at time slot i is given as [7]
R (i) = 1
2 min {C (PS (i) hSR) , C (PR (i) hRD)} ,
(4)
where C (x) = log2 (1 + x) denotes the capacity of the additive white Gaussian
noise channel, where x is the signal-to-noise ratio (SNR) of the channel.

Throughput Maximization
231
3
Power Consumption Model
In this subsection, power consumption model considering the non-ideal circuit
power is discussed. The transceiver circuitry works in two modes: when a signal
is transmitting, all circuits work in the active mode; and when there is no signal
to transmit, they work in the sleep mode.
Active mode: The consumed power is mainly comprised of the transmission
power and the circuit power. The transmission power is determined by the power
allocation PS (i) and PR (i). The circuit power consists of the following two
parts: the transmitting circuit power Pct comes from the power consumed by
the mixer, frequency synthesizer, active ﬁlter, and digital-to-analog converter
[2]; and the receiving circuit power Pcr is composed of the power consumption
of the mixer, frequency synthesizer, low noise ampliﬁer, intermediate frequency
ampliﬁer, active ﬁlter, and analog-to-digital converter [2]. Constant circuit power
model is considered in this paper, i.e., Pct and Pcr are constants [2]. In the sequel,
superscripts “S”, “R”, and “D” are added to Pct and Pcr to distinguish the power
consumed at the source, relay, and destination, respectively.
Sleep mode: It has been shown that the power consumption Psp in the sleep
mode is dominated by the leaking current of the switching transistors and is
usually much smaller than that in the active mode [2]. Therefore, the power
consumption in the sleep mode is set as Psp = 0. It is worth pointing out that
the results of this paper can be readily extended to the case of Psp ̸= 0 by
deducting Psp from the average power budget and the power consumption in the
active mode.
In general, the circuit power consumed in the active mode is larger than that
in the sleep mode, i.e.,
Pcr > Pct > Psp.
(5)
Thus, smartly operating between the two modes can potentially save a signiﬁcant
amount of energy.
Based on the power model discussed above, the power consumptions for the
considered DF relaying is computed as: Denote α as the total circuit power
consumption in the active mode, and it is the sum of the transmitting circuit
power at the source and the relay, the receiving circuit power at the relay and
the destination, i.e.,
α = 1
2

P S
ct + P R
cr

+ 1
2

P R
ct + P D
cr

,
(6)
where the
1
2 penalty is due to the half-duplex constraint for the considered
relaying scheme. With the deﬁned α and Psp = 0, the total power consumption
at time slot i is given as
Ptotal (i) =

0
PS (i) = 0, PR (i) = 0
1
2 (PS (i) + PR (i)) + α
PS (i) > 0, PR (i) > 0,
(7)

232
H. Liang et al.
where the 1
2 penalty is also due to the half-duplex constraint for the considered
relaying scheme. Then, the average power constraint is deﬁned over N time slots,
as N goes to inﬁnity, i.e.,
lim
N→∞
1
N
N

i=1
Ptotal (i) ≤P0,
(8)
where P0 ≥0 is the power budget.
4
Optimal Power Allocation
In this section, the optimal power allocation and throughput performance of the
considered relaying scheme is studied.
4.1
Problem Formulation
The goal is to determine {PS (i)} and {PR (i)} such that the long term average
throughput subject to the average power constraint deﬁned in (8) is maximized
over N time slots as N →∞, i.e., solve the following optimization problem
CDF (P0) =
max
{PS(i)},{PR(i)} lim
N→∞
1
N
N

i=1
R (i)
(9)
s.t.
(8), PS (i) ≥0, PR (i) ≥0,
(10)
where R (i) is given in (4).
It can be checked that the objective function (9) is nonnegative and concave
[11]. Thus, it is easy to check [5] that the optimal power allocation of problem
(9)–(10) is given as: Transmit with power PS (i) = PS > 0 and PR (i) = PR > 0
over p portion of time slots and keep silent for the rest of the slots, where PS
and PR are constants. As a result, problem (9)–(10) can be reformulated as
CDF (P0) =
max
{PS,PR,p}
p
2 min {C (PShSR) , C (PRhRD)}
(11)
s.t.
1
2PS + 1
2PR + α

· p ≤P0,
(12)
0 ≤p ≤1, PS ≥0, PR ≥0,
(13)
where (12) is obtained from (8).
It is easy to check that to achieve the optimal value of problem (11)–(13),
constraint (12) must be satisﬁed with equality; otherwise, increasing the trans-
mission power or transmission probability could still boost the average through-
put. Thus it follows that the optimal transmission probability p∗=
2P0
PS+PR+2α.
Hence, problem (11)–(13) can be further simpliﬁed as
CDF (P0) =
max
{PS,PR}
min {C (PShSR) , C (PRhRD)}
PS + PR + 2α
· P0
(14)
s.t. PS + PR ≥2P0 −2α,
(15)
PS ≥0, PR ≥0,
(16)
where (15) is obtained by substituting p∗into the constraint 0 ≤p ≤1.

Throughput Maximization
233
4.2
Optimal Power Allocation
In this subsection, the optimal power allocation for problem (14)–(16) is inves-
tigated.
For
objective
function
(14),
the
maximum
value
is
achieved
when
C (PShSR) = C (PRhRD); otherwise, decrease the source or relay power could
still achieve the same average throughput. Thus, it can be obtained from
C (PShSR) = C (PRhRD) that PR = PShSR
hRD . Substituting PR = PShSR
hRD
into (14)
and (15), problem (14)–(16) can be rewritten as
CDF (P0) = max
PS≥0
hRDC (PShSR)
(hSR + hRD) PS + 2hRDα · P0
(17)
s.t. (hSR + hRD) PS ≥2hRD (P0 −α) .
(18)
Since objective function (17) is a concave function divided by a linear func-
tion, it is quasiconcave over PS > 0 [11]. Deﬁne
Pee ≜arg max
PS≥0
PChRDC (PShSR)
(hSR + hRD) PS + 2hRDα,
(19)
which achieves the maximum value of (17) without considering constraint (18).
Then, the optimal power allocation of problem (9)–(10) and the average through-
put for the considered relaying scheme are given in the following proposition.
Proposition 1. The optimal power allocation for problem (9)–(10) is given as:
Transmit with power value (P ∗
S, P ∗
R) over p∗portion of time slots and keep silent
for the rest of slots, where
P ∗
S = max

Pee,
2hRD
hSR + hRD
(P0 −α)

,
(20)
P ∗
R = hSR
hRD
P ∗
S,
(21)
and p∗=
2P0
P ∗
S +P ∗
R+2α. With the optimal power allocation, the average throughput
CDF (P0) deﬁned in (9) is given as
CDF (P0) =

hRDC(PeehSR)
(hSR+hRD)Pee+2hRDα · P0
0 ≤P0 ≤hSR+hRD
2hRD
PS + α
1
2C

2hSRhRD
hSR+hRD (P0 −α)
	
P0 > hSR+hRD
2hRD
PS + α.
(22)
Proof. Since objective function (17) is quasiconcave over PS > 0, it is increasing
if 0 ≤P0 ≤hSR+hRD
2hRD
PS + α and decreasing if P0 > hSR+hRD
2hRD
PS + α. Thus, with
the constraint (18), P ∗
S = max

Pee,
2hRD
hSR+hRD (P0 −α)
	
achieves the maximum
value of problem (17)–(18).
Then, P ∗
R = hSR
hRD P ∗
S is obtained from PShSR = PRhRD. Substituting P ∗
S and
P ∗
R into objective function (17), the average throughput CDF (P0) is obtained
as (22).
Thus, Proposition 1 is proved.
⊓⊔

234
H. Liang et al.
Remark 1. Based on Proposition 1, it is worth noting that the transmission
scheme given in Proposition 1 is to transmit with an on-oﬀstructure when the
average power budget P0 is small to maximize the EE of the considered relay
channel, and transmit constantly when the average power budget P0 is large
to maximize the spectral eﬃciency. It is also worth noticing that Pee can be
eﬃciently obtained by a simple bisection search.
4.3
Asymptotic Analysis
In this subsection, the asymptotic performance for the considered relaying
scheme is analyzed.
Low SNR Regime: As P0 →0, the average throughput for the considered
relaying scheme at the low SNR regime is given in (22):
CDF (P0) =
C (PeehSR) hRD
(hSR + hRD) Pee + 2hRDα · P0.
(23)
It is interesting to note that CDF (P0) is a linear function of the average power
budget P0 at the low SNR regime. The scaling factors
C(PeehSR)hRD
(hSR+hRD)Pee+2hRDα is the
maximum EE of the considered relaying scheme.
High SNR Regime: Based on the results in (22), as P0 →∞, the average
throughput of the considered relaying scheme at the high SNR regime is asymp-
totically given as
CDF (P0) ≈1
2 log2
 2hSRhRD
hSR + hRD
(P0 −α)

.
(24)
It is obvious that the multiplexing gain of the considered relaying scheme is
1
2, which is due to the half duplex constraint.
5
Numerical Results
In this section, simulations are performed to compare the performances of the
proposed optimal power allocation for the two-hop relay transmission (THRT)
and various suboptimal schemes.
– DLT: denotes direct link transmission, whose power allocation is to transmit
with power value P ∗
S = max (Pee1, P0 −αA) over p∗portion of time slots
and keep silent for the rest of the slots, where Pee1 ≜arg max
PS>0
C(PShSD)
PS+αA
and
p∗=
PA
P ∗
S +αA , αA is the total power consumption for DLT, and hSD is the
channel gain of the source-destination link.
– CDLT: denotes constant direct link transmission, which transmits only with
the direct link every time slot. The power allocation for CDLT is given as
PS
∗=

P0 −αA
P0 > αA
0
otherwise.
(25)

Throughput Maximization
235
– CTHRT: denotes constant two-hop relay transmission, where the source
transmits to the destination via the relay every time slot. The power allo-
cation for CTHRT is given as
(P ∗
S , P ∗
R) =

P ∗
S , hSR
hRD P ∗
S
	
P0 > α
(0, 0)
otherwise,
(26)
where P ∗
S = max

Pee,
2hRD
hSR+hRD (P0 −α)
	
.
5.1
Average Power Budgets vs. Throughput
Figure 2 compares the performances of several transmission schemes at both low
and high SNR regimes. The circuit power consumptions are set as α = 0.18 W
and αA = 0.2 W. The channel gains are set as hSD = 1, hSR = 10, hRD = 3.
It is easy to see that in the low SNR regime, the throughput curve of THRT
outperforms other throughput curves, which suggests that THRT is more energy
eﬃcient than other transmission schemes. As P0 increases, the curves of THRT
and CTHRT coincide, and the curves of DLT and CDLT coincide. when P0 =
0.8 W, throughput performance of THRT/CTHRT is about 0.3 b/s/Hz larger
than that of DLT/CDLT.
In high SNR regime, the curves of THRT and CTHRT coincide, and the
curves of DLT and CDLT coincide. The curves of DLT and CDLT outperforms
the curves of THRT and CTHRT, which is due to the 1
2 multiplexing gain of
THRT and CTHRT. As P0 increases, the throughput gap between the curves of
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
P0 (W)
Throughput (b/s/Hz)
DLT
CDLT
THRT
CTHRT
0
20
40
0
2
4
6
Fig. 2. The relationship between the power budget and the average throughput in low
SNR and high SNR regimes.

236
H. Liang et al.
DLT/CDLT and THRT/CTHRT enlarges, and the throughput performance of
DLT/CDLT approaches twice as much as that of THRT/CTHRT.
5.2
Channel Gain hSR vs. Throughput
In this subsection, the average throughput of THRT is compared with diﬀerent
channel gain hSR and circuit power consumption α. The channel gain is set as
hRD = 2. The average power budget is set as P0 = 1 W. The circuit power
consumptions are set as α = 0.12, 0.16, 0.2, 0.24, 0.28 W, respectively.
Figure 3 shows that the increase in hSR leads to the increase in the average
throughput. Besides, it can be concluded from the ﬁgure that as α increases,
more power is consumed on the circuits, which leads to the decrease in the
average throughput.
1
1.5
2
2.5
3
0.45
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0.85
0.9
hSR
Throughput (b/s/Hz)
=0.12 W
=0.16 W
=0.2 W
=0.24 W
=0.28 W
Fig. 3. The relationship between the channel gain hSR and the average throughput
with diﬀerent circuit power consumption α.
6
Conclusion
In this paper, the throughput optimal power allocation for a two-hop relay chan-
nel with non-ideal circuit power was studied. By discovering the structure of the
optimal power allocation, the non-convex problem was transformed into a quasi-
concave problem. The closed-form solution showed that the source and the relay
transmit with certain probability, which is determined by the average power
budget, circuit power consumption, and channel gains. Then, asymptotic anal-
ysis was given, and ﬁnally, numerical results showed that the proposed optimal
power allocation outperforms other suboptimal schemes.

Throughput Maximization
237
References
1. Li, G.Y., Xu, Z., Xiong, C., Yang, C., Zhang, S., Chen, Y., Xu, S.: Energy-eﬃcient
wireless communications: tutorial, survey, and open issues. IEEE Wirel. Commun.
Mag. 18(6), 28–35 (2011)
2. Cui, S., Goldsmith, A.J., Bahai, A.: Energy-constrained modulation optimization.
IEEE Trans. Wirel. Commun. 4(5), 2349–2360 (2005)
3. Miao, G., Himayat, N., Li, G.Y.: Energy-eﬃcient link adaptation in frequency-
selective channels. IEEE Trans. Commun. 58(2), 545–554 (2010)
4. Xiong, C., Li, G.Y., Zhang, S., Chen, Y., Xu, S.: Energy- and spectral-eﬃciency
tradeoﬀin downlink OFDMA networks. IEEE Trans. Wirel. Commun. 10(11),
3874–3886 (2011)
5. Xu, J., Zhang, R.: Throughput optimal policies for energy harvesting wireless trans-
mitters with non-ideal circuit power. IEEE J. Sel. Areas Commun. 32(2), 322–332
(2014)
6. Laneman, J.N., Tse, D.N.C., Wornell, G.W.: Cooperative diversity in wireless net-
works: eﬃcient protocols and outage behavior. IEEE Trans. Inf. Theory 50(12),
3062–3080 (2004)
7. Høst-Madsen, A., Zhang, J.: Capacity bounds and power allocation for wireless
relay channels. IEEE Trans. Inf. Theory 51(6), 2020–2040 (2005)
8. Madan, R., Mehta, N.B., Molisch, A.F., Zhang, J.: Energy-eﬃcient cooperative
relaying over fading channels with simple relay selection. IEEE Trans. Wirel. Com-
mun. 7(8), 3013–3025 (2008)
9. Zhou, Z., Zhou, S., Cui, J., Cui, S.: Energy-eﬃcient cooperative communication
based on power control and selective single-relay in wireless sensor networks. IEEE
Trans. Wirel. Commun. 7(8), 3066–3078 (2008)
10. Brante, G., Kakitani, M.T., Souza, R.D.: Energy eﬃciency analysis of some cooper-
ative and non-cooperative transmission schemes in wireless sensor networks. IEEE
Trans. Commun. 59(10), 2671–2677 (2011)
11. Boyd, S., Vandenberghe, L.: Convex Optimization. Cambridge University Press,
Cambridge (2004)

Big Data-Driven Vehicle Mobility Analysis
and Design for 5G
Ruoxi Sun(B), Kai Zhang, and Yong Ren
Department of Electronic Engineering, Tsinghua University, Beijing 100084, China
xysrx@163.com, zhang-k16@mails.tsinghua.edu.cn, reny@tsinghua.edu.cn
Abstract. Each generation of communication technology has a subver-
sion, 5G will have a greater bandwidth, high carrier frequency, extreme
base station and device densities, especially in vehicular network. Mobil-
ity models play a pivotal role in vehicular network, especially for routing
policy evaluation. Relying on big data technology, the big data aided
vehicle mobility analysis and design gets a lot of attentions. In this paper,
we commerce with introducing the data set, i.e., a big GPS data set in
Beijing. Then, a novel vehicle and location collaborative mobility scheme
is proposed relying the GPS data set. We evaluate its performance based
on degree distribution, duration distribution and interval time distribu-
tion. Our works may help the mobility design in vehicular networks.
Keywords: Big data · Vehicle mobility · 5G
1
Introduction
Each generation of communication technology has a subversion, 5G will have a
greater bandwidth, high carrier frequency and extreme base station and device
densities, especially in vehicular network [4,6]. The growing number of vehicles
and the peoples in city, resulting in traﬃc congestion and automobile exhaust,
which greatly reduces people’s life travel experience. To address these issue, many
schemes have been proposed, and intelligent transportation system (ITS) is one
of them. Thanks to the accumulation of vehicle data and the maturer big data
technology, such as parallel computing, machine learning and deep learning, the
vehicular network analysis and design based on big data has got more and more
attention.
As we all known, vehicular network is a dynamic network [1,5,8]. Therefore,
the mobility models are of great importance for evaluating the performance of
upper-layer protocol, and incorrect mobility model even lead to wrong conclu-
sions. In present stage, GPS data for the analysis of the mobility model has
got widespread concern. For vehicular network, mobility models can be roughly
divided into four categories [1]: synthetic models, survey-based models, traﬃc
simulator-based models and the trace-based models. Synthetic models, which
is based on mathematical models, is capable of reﬂecting a realistic physical
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 238–245, 2018.
https://doi.org/10.1007/978-3-319-72823-0_23

Big Data-Driven Vehicle Mobility Analysis and Design for 5G
239
eﬀect, such as random way point [7] and weighted waypoint model [9]. Sur-
vey based Models get the models property by surveys, and the agenda-based
mobility model [11] is a typical example. And the traﬃc simulator-based mod-
els is obviously, which are generated form traﬃc simulator, such as SUMO [13],
VISSIM [14] and TraNS [15]. And the big data contributes to the trace-based
models [16].
In fact, the big data for mobility model analysis is not limited in the race-
based models. Speciﬁcally, the model based on social network belong to the
ﬁrst category [1–3,10,12,18]. Gonzalez et al. [17] analyzed the data collected
tracing mobile phone users, and found that most people traveled around their
familiar place. Song et al. [18] analyzed the distribution of time interval, i.e.,
how much time a user stayed at a location, and found the a truncated power law
distribution. Based on real trajectory data, Musolesi et al. [19] modeled social
relationships by interaction matrix, and the value of matrix elements represented
the relationship between the two users.
Relying on the vehicle GPS data, we conduct the relevant research and our
original contributions are as follows:
– Mobility model design: Inspired form the recommended system, we proposed
three novel vehicular mobility models, which approximates real data and is
easy to interpret.
– Real-world dataset evaluation: Relying on the vehicle GPS data in Beijing,
we evaluate our scheme.
The remainders of this article are outlined as follows. In Sect. 2, we intro-
duce the mobility models and relevant indicators. Section 3 establishes the per-
formance comparison in degree distribution, duration distribution and interval
time distribution, followed by the conclusion in Sect. 4.
2
System Model
In this section, we commerce with introducing the mobility model designed in
Sect. 2.1. Then, in Sect. 2.2, we specify the evaluating indicator, which is utilized
for mobility scheme comparison in this paper.
2.1
Mobility Model
We ﬁrst need to explain the reasons for introducing social attributes. For a
speciﬁc vehicle, we plot all positions in the given time zone. The corresponding
results are presented in the Fig. 1.
As can be seen from the diagram, the driver has a preference for position. And
this property is a traditional random walk mobility model can not be reﬂected.
Typical social features based mobility model need a interaction matrix, i.e.,
R, to reﬂect the relationship between two vehicles or a vehicle to a location. In
this paper, we also consider the distance martrix, i.e., D. And the relationship

240
R. Sun et al.
116.25
116.3
116.35
116.4
116.45
116.5
116.55
39.8
39.85
39.9
39.95
40
Longitude
Latitude
Fig. 1. Moving track of a vehicle.
and the distance of i and j is represented by Rij and Dij. The movement of
vehicle could be modeled by the Markov process, which can be deﬁned as:
Qij =
RijDij
m
j=1 RijDij
(1)
Based on the diﬀerent deﬁnitions of social properties in R, the related solu-
tions include the random initialization scheme (RIS), the global critical location
assessment scheme (GCLAS) and the personalized important location assess-
ment scheme (PCLAS).
Speciﬁcally, if the values in R are random given, then the random initializa-
tion scheme are achieved. In the random initialization scheme (RIS), the Rij is
given by:
Rij = rand(1),
(2)
where rand(1) means a random number between 0 and 1.
Based on the global critical location assessment, i.e., the probability of each
site being accessed is proportional to its frequency, we get the global critical loca-
tion assessment scheme. In global critical location assessment scheme (GCLAS),
the Rij is given by:
Rij =

v

t
transiti→j

v

t

k
transiti→k
,
(3)
where v reﬂects a vehicle, t means a speciﬁc time and k denotes any position
that connects with position i.
Considering the individual characteristics of the vehicle, we evaluate the
importance of the location based on the speciﬁc vehicle history data, which lead
to the personalized important location assessment scheme. In the personalized
important location assessment scheme (PCLAS), the Rij is given by:
Rk
ij =

t
transitk
i→j

t

k
transitk
i→j
.
(4)

Big Data-Driven Vehicle Mobility Analysis and Design for 5G
241
And the Qij should be modiﬁed as follows:
Qk
ij =
Rk
ijDij
m
j=1 Rk
ijDij
(5)
Besides, we adopt the real track data, simpliﬁed trajectory data and random
walk as a comprising. Speciﬁcally, we map the real track data (RTD) into a 25∗25
grid network, then we get the simpliﬁed trajectory data (STD). The mobility in
random walk scheme (RWS) assumes all the vehicles’ movements are random.
2.2
Evaluating Indicator
Speciﬁcally, VANETs can be viewed as a time variant graph G = (No, E, T , ρ).
Vehicles compose the entity in No set and the relationship between them is the E
set. In this paper, the relationship represents a communication link. In dynamic
network, this relationship may chance over time, so T represents the survival
time and T represents the time domain, which satisfy T ⊆T . ρ : E ×T →{0, 1}
indicates survival function, which reﬂects whether a given edge exists at a given
time slot. For time vary graph, there are two important parameters, the duration
of the connection and the length of time interval. In other words
– the duration of the connection: starting from the entity i and entity j con-
nection, to the ﬁrst break time point, ρij(T) = 1 was established in this time
range;
– the length of time interval: starting from the entity i and entity j break, to
the ﬁrst connection time point, ρij(T) = 0 was established in this time range.
And these two parameters will be utilized later to evaluate our mobility
model.
3
Scheme Comparison
In this section, we conduct some simulation analysis on mobility models on
the vehicular networks relying on the dataset introduced in Subsect. 3.1. We
consider three typical indicators, i.e., degree distribution, duration distribution
and interval time distribution, in mobility model assessment. And the relevant
results and analysis are presented in Sects. 3.2, 3.3 and 3.4, respectively.
3.1
Dataset Analysis
This dataset records around ten thousand vehicles’ GPS data in Beijing. For
each vehicle, the travel track of the vehicle is recorded for several days.
And the Fig. 2 depicts the whole vehicle distribution in a speciﬁc time. This
ﬁgure is not only a good reﬂection of the spatial distribution of vehicles, while
reﬂecting the characteristics of Beijing’s road network structure, i.e., the grid
network topology.

242
R. Sun et al.
116.25
116.3
116.35
116.4
116.45
116.5
39.8
39.85
39.9
39.95
40
40.05
Longitude 
Latitude
Fig. 2. System model.
3.2
Degree Distribution Comparison
In this subsection, we evaluate the mobility models based on degree distribution.
Actually, the degree distribution is a very vital indicator in complex network,
especially in distinguishing network types.
Based on the above ﬁve mobility schemes speciﬁed in Sect. 3.2 and the real
data, we plot their degree distribution in Fig. 3. From the results, we can easily
ﬁnd that the real data network shows the characteristics of scale-free. However,
both the simpliﬁed trajectory data and other four mobility schemes are more
like a Gaussian distribution network.
3.3
Duration Comparison
In network communication ﬁeld, we may pay more attention to the latter two
indicators. So in this section, we explore their performance in duration distribu-
tion.
The Fig. 4 represents their comparison in duration distribution. In addition
to the simpliﬁed trajectory data being closer to the real data, the other four
schemes converge. As can be seen from the local magniﬁcation in Fig. 4, although
the latter four programs close to each other, GCLAS and PCLAS is closer to
the real data.
3.4
Interval Time Comparison
Similarly, in this section we explore their performance in interval time distribu-
tion.
The results are revealed in Fig. 5. We can see that the GCLAS and PCLAS
scheme is closer to the simpliﬁed trajectory data, which can verify its superiority.

Big Data-Driven Vehicle Mobility Analysis and Design for 5G
243
0
2
4
6
8
10
12
14
16
18
20
0
0.05
0.1
0.15
0.2
0.25
Node degree K
Degree distribution P(K)
(a) RTD
0
10
20
30
40
50
60
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
Node degree K
Degree distribution P(K)
(b) STD
0
5
10
15
20
25
0
0.02
0.04
0.06
0.08
0.1
0.12
Node degree K
Degree distribution P(K)
(c) RWS
0
5
10
15
20
25
0
0.02
0.04
0.06
0.08
0.1
0.12
Node degree K
Degree distribution P(K)
(d) RIS
0
5
10
15
20
25
30
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
Node degree K
Degree distribution P(K)
(e) GCLAS
0
5
10
15
20
25
30
0
0.02
0.04
0.06
0.08
0.1
0.12
Node degree K
Degree distribution P(K)
(f) PCLAS
Fig. 3. Degree distribution comparison

244
R. Sun et al.
0
50
100
150
200
250
300
350
400
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Duration T
Cumulative probability distribution F(T)
RTD
STD
RWS
RIS
GCLAS
PCLAS
5.5
6
6.5
7
0.955
0.96
0.965
0.97
0.975
0.98
Fig. 4. Duration comparison
0
50
100
150
200
250
300
350
400
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Interval time T
Cumulative probability distribution F(T)
RTD
STD
RWS
RIS
GCLAS
PCLAS
Fig. 5. Interval time comparison
4
Conclusion
To sum, inspired by user to product collaboration scheme in the recommended
system, we propose the corresponding vehicle to location collaboration scheme
in vehicular network. Based on degree distribution comparison, duration distri-
bution comparison and interval time distribution comparison, the performances
of the vehicle to location collaboration scheme are veriﬁed.
References
1. Harri, J., Filali, F., Bonnet, C.: Mobility models for vehicular ad hoc networks:
a survey and taxonomy. IEEE Commun. Surv. Tutor. 11, 19–41 (2009). Fourth
Quarter
2. Jiang, C., Chen, Y., Liu, K.J.R.: Graphical evolutionary game for information
diﬀusion over social networks. IEEE J. Sel. Top. Sig. Process 8(4), 524–536 (2014)

Big Data-Driven Vehicle Mobility Analysis and Design for 5G
245
3. Jiang, C., Chen, Y., Liu, K.J.R.: Evolutionary dynamics of information diﬀusion
over social networks. IEEE Trans. Sig. Process 62(17), 4573–4586 (2014)
4. Andrews, J.G., Buzzi, S., Choi, W., Hanly, S.V., Lozano, A., Soong, A.C., Zhang,
J.C.: What will 5G be? IEEE J. Sel. Areas Commun. 32(6), 1065–1082 (2014)
5. Jiang, C., Zhang, H., Ren, Y., Chen, H.: Energy-eﬃcient non-cooperative cognitive
radio networks: micro, meso and macro views. IEEE Commun. Mag. 52(7), 14–20
(2014)
6. Wang, J., Jiang, C., Han, Z., Ren, Y., Hanzo, L.: Network association strategies for
an energy harvesting aided super-wiﬁnetwork relying on measured solar activity.
IEEE J. Sel. Areas Commun. 34(12), 3785–3797 (2016)
7. Bettstetter, C., Resta, G., Santi, P.: The node distribution of the random waypoint
mobility model for wireless ad hoc networks. IEEE Trans. Mob. Comput. 2(3),
257–269 (2003)
8. Wang, J., Jiang, C., Zhi, B., Quek, T.Q.S., Ren, Y.: Mobile data transactions
in device-to-device communication networks: pricing and auction. IEEE Wirel.
Commun. Lett. 5(3), 300–303 (2016)
9. Hsu, W., Merchant, K., Shu, H., Hsu, C., Helmy, A.: Weighted waypoint mobility
model and its impact on ad hoc networks. ACM SIGMOBILE Mob. Comput.
Commun. Rev. 9(1), 59–63 (2005)
10. Wang, J., Jiang, C., Quek, T.Q.S., Wang, X., Ren, Y.: The value strength aided
information diﬀusion in socially-aware mobile networks. IEEE Access 4, 3907–3919
(2016)
11. Zheng, Q., Hong, X., Liu, J.: An agenda based mobility model21. In: Proceedings of
the 39th Annual Symposium on Simulation, pp. 188–195. IEEE Computer Society,
April 2006
12. Wang, J., Jiang, C., Quek, T.Q.S., Ren, Y.: The value strength aided information
diﬀusion in online social networks. In: IEEE Global Conference on Signal and
Information Processing (GlobalSIP), pp. 1–6, December 2016
13. Sommer, C., German, R., Dressler, F.: Bidirectionally coupled network and road
traﬃc simulation for improved ivc analysis. IEEE Trans. Mob. Comput. 10(1),
3–15 (2011)
14. Fellendorf, M., Vortisch, P.: Microscopic traﬃc ﬂow simulator vissim. In: Barcel´o,
J. (ed.) Fundamentals of Traﬃc Simulation. ISOR, vol. 145, pp. 63–93. Springer,
New York (2010). https://doi.org/10.1007/978-1-4419-6142-6 2
15. Piorkowski, M., Raya, M., Lugo, A.L., Papadimitratos, P., Grossglauser, M.,
Hubaux, J.-P.: Trans: realistic joint traﬃc and network simulator for vanets. ACM
SIGMOBILE Mob. Comput. Commun. Rev. 12(1), 31–33 (2008)
16. Kim, M., Kotz, D., Kim, S.: Extracting a mobility model from real user traces. In:
INFOCOM, vol. 6, pp. 1–13 (2006)
17. Gonzalez, M.C., Hidalgo, C.A., Barabasi, A.-L.: Understanding individual human
mobility patterns. Nature 453(7196), 779–782 (2008)
18. Song, C., Koren, T., Wang, P., Barabasi, A.-L.: Modelling the scaling properties
of human mobility. Nat. Phys. 6(10), 818–823 (2010)
19. Musolesi, M., Mascolo, C.: Designing mobility models based on social network
theory. ACM SIGMOBILE Mob. Comput. Commun. Rev. 11(3), 59–70 (2007)

Complexity Analysis of Massive MIMO Signal
Detection Algorithms Based on Factor Graph
Zhichao Yao(B), Chao Dong, Kai Niu, and Zhiqiang He
Key Lab of Universal Wireless Communications,
Beijing University of Posts and Telecommunications, Beijing, China
{mr cuber,dongchao,niukai,hezq}@bupt.edu.cn
Abstract. Massive MIMO technology is one of the most promising con-
cepts in 5G wireless system. In the uplink of a massive MIMO system,
complexity and performance of signal detection are two key issues been
concerned simultaneously. Many message passing algorithms based on
factor graph have claimed to achieve nearly optimal performance at low
complexity. A uniﬁed factor graph model is introduced to describe two
typical message passing algorithm,approximate message passing (AMP)
and message passing detection (MPD). By analyzing diﬀerent message
calculation methods in the two algorithms, their computational complex-
ity and performance are given in detail. Simulation results have shown
that MPD exceeds AMP in both complexity and performance.
Keywords: Massive MIMO · Signal detection · Factor graph
Message passing · Channel hardening · Computation complexity
1
Introduction
Massive MIMO with tens of hundreds of antennas at the BS can signiﬁcantly
improve the system capacity and spectrum eﬃciency, which is considered as a
candidate technology for 5G standards [1]. However, as the number of antennas
grows, the computational complexity of detectors has become the bottleneck
of its hardware implementation. Some detectors that work well in traditional
MIMO fail in massive MIMO. For example, the complexity of optimal maxi-
mum likelihood (ML) detector scales exponentially in the number of transmit
antennas, and conventional linear detectors like zero-forcing (ZF) and minimum-
mean-square-error (MMSE) involve complicated matrix inversion, are diﬃcult to
simultaneously satisfy high-performance and low-complexity requirement of mas-
sive MIMO. Thus, ﬁnding a low-complexity detection algorithm on the uplink
in massive MIMO, while maintaining good performance, is necessary.
Researches have shown that iterative detection algorithms based on factor
graph can achieve performance that close to ML, meanwhile the computation
complexity scales linearly, rather than exponentially in the number of transmit
antennas [2–4]. There are two main directions to solve this problem. One is
message passing algorithm working in complex-value domain [2,3]. The other
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 246–256, 2018.
https://doi.org/10.1007/978-3-319-72823-0_24

Complexity Analysis of Massive MIMO Detection
247
is message passing exploiting channel-hardening working in real-value domain
[4]. These algorithms all claim that nearly ML performance has been achieved,
but computation complexity comparison between these algorithms has not been
done so far.
Therefore, in this paper, we select two typical algorithms, approximate mes-
sage passing (AMP) and message passing detection (MPD) representing those
two directions previously mentioned. First we described these two algorithms by
using uniﬁed system model and message passing graphical model, then compared
their computation complexity and performance in detail.
The rest of the paper is organized as follows. We ﬁrst introduce the system
model in Sect. 2. Two message passing detection algorithms based on factor
graph are described in Sect. 3. Complexity analysis and simulation results are
presented in Sects. 4 and 5, respectively. Section 6 concludes this paper.
Fig. 1. Multi-user massive MIMO system on the uplink
2
System Model
Consider a multi-user massive MIMO system with N independent users, where
each user is equipped with one transmit antenna, and the receiver is equipped
with an array of M antennas, M is in the range of tens to hundreds [5]. System
load factor ϕ is deﬁned as N/M. The system model is illustrated in Fig. 1. For
each user, every Q information bits are mapped to one modulation symbol. Let
xc = [xc
1, xc
2, ...xc
N]T be the transmitted vector from all the users, where xc
n ∈B
is the symbol transmitted from the nth user and B is the modulation alphabet.
Let Hc ∈CM×N denote the channel gain matrix and hc
ij denote the complex

248
Z. Yao et al.
channel gain from the jth user to the ith BS antenna. The elements of Hc, which
follow CN(0, 1), are assumed to be independent identically distributed (i.i.d.).
It is assumed that the N transmitters and the receiver are perfect synchronized
and all channel gains are known at the receiver. Then the received vector can be
presented as
yc = Hcxc + nc,
(1)
where nc is the additive white Gaussian noise (AWGN) vector whose entries
follow CN(0, σ2
n). The average received SNR per receive antenna is given by
γ = NEs/σ2
n, where Es is the average per transmitted symbol.
The MPD algorithm to be introduced works in real-value domain, so (1) can
be written as
y = Hx + n,
(2)
where
H ≜

ℜ(Hc) −ℑ(Hc)
ℑ(Hc) ℜ(Hc)

, y ≜

ℜ(yc)
ℑ(yc)

, x ≜

ℜ(xc)
ℑ(xc)

, n ≜

ℜ(nc)
ℑ(nc)

,
ℜ(·),ℑ(·) denotes the real and imaginary part, respectively.
For a QAM modulation alphabet B, the elements of x will take value from
the underlying pulse-amplitude modulation (PAM) alphabet A.
3
Two Message Passing Algorithms
In this section, we introduce two message passing algorithms based on factor
graphs dedicated to the detection of massive MIMO. 16-QAM gray-mapping
modulation is considered.
3.1
Factor Graph Model of Message Passing Algorithm
Detection algorithms based on FG (Factor Graph) is brieﬂy introduced in this
section [2]. Consider the MIMO system model in (1) or (2), each entry of
the received vector (or observation vector) is seen as a function node fj,j =
1, 2, n f(number of function nodes) in a factor graph, and each transmitted
symbol as a variable node xi, i = 1, 2, n x(number of variable nodes). Figure 2
illustrates this graph model. The job of MIMO detection is using the knowledge
of received vector and channel matrix to obtain an estimate of transmitted vec-
tor. Message passing algorithms are carried out on the factor graph by passing
messages between the variable and function nodes.
3.2
MPD Algorithm
As proposed in [4], the MPD algorithm exploits channel hardening that occurs
in massive MIMO channel.

Complexity Analysis of Massive MIMO Detection
249
Fig. 2. Message passing between function and variable nodes on FG
Channel Hardening. As the dimension of the channel gain matrix H increases,
the oﬀ-diagonal terms of the HT H matrix become increasingly weaker compared
to the diagonal terms. This phenomenon is called channel hardening in [6].
In Sect. 3.2, we will work with approximations to the oﬀ-diagonal terms of
the HT H matrix, which achieves very good performance in large dimensions at
low-complexity.
MPD Algorithm. By performing matched ﬁlter operation on (2), we have
HT y = HT Hx + HT n.
(3)
From (3), we write the following:
z = Gx + v,
(4)
where
z ≜HT y
M , y ≜HT H
M
, x ≜HT n
M .
The ith element of z can be written as
zi = Giixi +
2N

j=1,j̸=i
Gijxj + vi



≜ki
(5)
where Gij is the (i,j)th of G, xi is the ith element of x, and
vi =
2N

j=1
Hjinj
M
(6)
is the ith element of v, where Hji is the (j,i)th element of H. The variable ki
deﬁned in (5) denotes the interference-plus-noise term, which involves the oﬀ-
diagonal elements of G(i.e., Hji, i ̸= j). The distribution of ki is approximated

250
Z. Yao et al.
as CN(μi, σ2
i ) . By central limit theorem, this approximation is accurate for
large M, N. Since the elements in x , v are independent, the mean and variance
in this approximation are given by
μi = E(ki) =
2N

j=1,j̸=i
GijE(xj)
(7)
σ2
i = Var(ki) =
2N

j=1,j̸=i
G2
ijVar(xj) + σ2
v.
(8)
Denoting the probability of the symbol xj as pj(s),we have
E(xj) =

∀sinA
spj(s), Var(xj) =

∀sinA
s2pj(s) −E(xj)2
where σ2
v = σ2
n/2M. Due to the above Gaussian approximation, the a posteriori
probability (APP) of xi being s ∈A is computed as
pi(s) ∝exp
	 −1
2σ2
i
(zi −Giis −μi)2

.
(9)
Message Passing. First of all, because of the above matched ﬁlter operation,
observation vector became a 2N × 1 vector, which means that the number of
function and variable nodes is 2N. As shown in Fig. 3, the messages passed from
variable node xj to any function node are E(xj) and Var(xj), the computation
of which needs pi(s). Then, we use the knowledge of G, i.e. channel matrix and
the message passed to function node fj to compute the mean μi and variance
σ2
i of interference-plus-noise term kj. Moreover, pi(s) is computed using μi, σ2
i
and jth elements in observation vector. As we can see, the major diﬀerence in
Fig. 3 comparing to Fig. 2 is that computation of messages coming from xj only
needs the messages from function node fj, rather than all 2N function nodes.
Therefore, computation complexity of MPD is signiﬁcantly reduced.
Fig. 3. Message passing between function and variable nodes for MPD

Complexity Analysis of Massive MIMO Detection
251
Damping Message. In the above graphical model, the message passing algo-
rithm may fail to converge, and even if it does converge, the estimated probabil-
ities may be far from exact. In [7], a damping method intended to improve the
rate of convergence is proposed. The damped message to be passed in iteration
t is computed as a weighted average of the message in iteration t−1 and the
message computed at the tth iteration with a damping factor Δ ∈[0, 1). In [3],
it is shown that Δ = 0.33 is optimal, Thus, let ˜pt
i be the computed probability
at the tth iteration, the message at the end of tth iteration is
pt
i = (1 −Δ) ˜pt
i + Δpt−1
i
.
(10)
The algorithm is initialized with pi(s) = 0.25, ∀s ∈A and terminates after a
ﬁxed number of iterations. Finally, the bit as
Pr(bp
i = 1) =

∀s∈A:pth bit in s is 1
pi(s),
(11)
where bp
i is the pth bit in the ith user’s symbol. A hard estimate of bit bp
i can
be obtained as
bp
i =

1 if Pr(bp
i = 1) > 0.5
0 otherwise.
3.3
AMP Algorithm
Message passing algorithms referred as AMP (Approximate Message Passing)
based on factor graph and its variants are proposed in [2]. In typical AMP
algorithm, the message is modeled as Gaussian random variable. In addition,
the messages of all the edges shown in Fig. 2 should be calculated. The focus
of AMP is mainly on the mean and variance updating in message passing. In
the following, NC(x; a, b) = (πb)−1 exp(−|x −a|2/b) denotes complex Gaussian
function, where x, a, b denotes the random variable, the mean, the variance,
respectively. The conditional probability p(yc|xc) can be factorized into:
p(yc|xc) =

j
pj(yc
j|xc),
(12)
where
pj(yc
j|xc) =
1
πσ2n
exp

−|yc
j −
i hc
jixc
i|2
σ2n

.
(13)
This factorization is represented by the factor graph in Fig. 2. Let μt
xi→fj(xc
i)
denotes the message sent from the variable node xi to the function node fj in
the tth iteration, and let μt
fj→xi(xc
i) denotes the opposite message. The message-
update rules are given by
μt
xi→fj(xc
i) =

j′̸=j
μt−1
fj′→xi(xc
i),
(14)

252
Z. Yao et al.
μt
fj→xi(xc
i) =

x\xi
pj(yc
j|xc)

i′̸=i
μt
xi′→fj(xc
i′).
(15)
As the symbols take on values in the discrete set B, the computation of
μt
fj→xi(xc
i) in (15) requires exponential time to marginalize out the random vec-
tor x\xi. To reduce complexity, xc
i is considered as a continuous random variable
and the message μt
xi→fj(xc
i) is approximated into a complex Gaussian function
ˆμt
xi→fj(xc
i) = NC(xc
i; ¯xt
xi→fj, ¯wt
xi→fj), where the parameters ¯xt
xi→fj and ¯wt
xi→fj
are transmitted symbols’ mean and variance, μt
fj→xi(xc
i) can be calculated by
integration:
μt
fj→xi(xc
i) =

x\xi
pj(yc
j|xc)

i′̸=i
NC(xc
i; ¯xt−1
xi→fj, ¯wt−1
xi→fj)
= NC(hc
jixc
i; θt
fj→xi, γt
fj→xi)
(16)
where the parameters θt
fj→xi and γt
fj→xi are given by
θt
fj→xi = yj −

i′̸=i
hji¯xt
xi→fj = yj −

i
hji¯xt
xi→fj



θt
fj
+hji¯xt
xi→fj,
(17)
and
γt
fj→xi = σ2
n +

i′̸=i
|hji′|2 ¯wt
xi′→fj = σ2
n +

i
|hji|2 ¯wt
xi→fj



γt
fj
−|hji|2 ¯wt
xi→fj. (18)
Then, by substituting μt−1
fj→xi(xc
i)
=
NC(hc
jixc
i; θt−1
fj→xi, γt−1
fj→xi) into (14),
μt
xi→fj(xc
i) can be normalized as
μt
xi→fj(xc
i) =
NC(xc
i; αt−1
xi→fj, βt−1
xi→fj)

xc
i ∈B NC(xc
i; αt−1
xi→fj, βt−1
xi→fj)
(19)
where αt−1
xi→fj and βt−1
xi→fj are given by
αt−1
xi→fj =
⎛
⎝
j′̸=j
|hj′i|2
γt−1
fj′→xi
⎞
⎠
−1
=
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎝

j
|hji|2
γt−1
fj→xi



(αt−1
xi )−1
−|hji|2
γt−1
fj→xi
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎠
−1
(20)

Complexity Analysis of Massive MIMO Detection
253
βt−1
xi→fj = αt−1
xi→fj

j′̸=j
h∗
j′iθt−1
fj′→xi
γt−1
fj′→xi
= αt−1
xi→fj
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎝

j
h∗
jiθt−1
fj→xi
γt−1
fj→xi



τ t−1
xi
−h∗
jiθt−1
fj→xi
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎠
.
(21)
In (17–21), θt
fj, γt
fj, αt
xi, τ t
xi are used to reduce complexity. After Tth iterations,
the probability of transmitted symbol from ith user been xc
i ∈B is
p(xc
i) = NC(xc
i; ξT
xi, αT
xi),
(22)
where ξT
xi = τ T
xiαT
xi. A hard estimate of symbol xc
i can be obtained as
xc
i = arg max p(xc
i).
(23)
4
Complexity Analysis
The complexity is evaluated in terms of ﬂoating-point operations(FLOPs) as
in [2]. A FLOP is assumed to be either a real multiplication or a real summa-
tion here. Transposition, Hermitian transposition, conjugate, and real/imaginary
operator require no FLOP. It is also assumed that the operation of exponent can
be implemented by a look-up table. Note that the multiplication of two complex
numbers needs six FLOPs.
4.1
Complexity of MPD
In the preprocessing stage, the MPD algorithm requires 8MN, 16MN 2, 4N 2
FLOPs for the calculation of z, G, |G|2 respectively. For computing the mes-
sages at nodes in each iteration, E(xj) needs 14N FLOPs, Var(xj) needs 18N
FLOPs, {μi, i ∈{1, 2, ...2N}} need 2N(4N−3) FLOPs, {σ2
i , i ∈{1, 2, ...2N}}
need 2N(4N−2) FLOPs, {˜pt
i(s), i ∈{1, 2, ...2N}, s ∈A} need 2N × 4 × 6
FLOPs, the normalization of ˜p needs 2N × 7 FLOPs. Finally, at the end of
each iteration, damping of messages need 2N × 4 × 3 FLOPs.
4.2
Complexity of AMP
In the preprocessing stage, the AMP algorithm requires 3MN FLOPs to com-
pute |Hc|2. For computing the downward messages at the variable nodes,
{μt
xi→fj(xc
i), ∀i, ∀j} and {¯xt
xi→fj, ¯wt
xi→fj, ∀i, ∀j} need (11|B| −1)MN FLOPs
and (6|B| + 1)MN FLOPs, respectively. For computing the upward messages
at the function nodes, {γt
fj→xi, γt
fj, θt
fj→xi, θt
fj, ∀i, ∀j} need 13MN FLOPs. For
computing the messages at the variable nodes, {αt
xi→fj, αt
xi, βt
xi→fj, τ t
xi, ∀i, ∀j}
need 16MN-3N FLOPs.

254
Z. Yao et al.
4.3
Complexity Comparison
Total complexity per iteration for MPD, AMP is listed in Table 1.
Table 1. Complexity Comparison of MPD and AMP
Algorithm Preprocessing
Per iteration
MPD
16MN 2+8MN+4N 2 16N 2+108N
AMP
3MN
(17|B| + 29)MN-3N
5
Simulation Results
Simulation results all base on the same assumption. System model (1) or (2) is
used for simulation. For each simulated point, a minimum of 100 bit errors were
counted.
First, a massive MIMO system with N = 16 users and M = 128 receiving
antennas is considered. Figure 4 presents the BER performance of MPD and
AMP with the number of iterations. It can be seen that 8 iterations are enough
for both MPD and AMP to converge at SNR = 6 dB and SNR = 8 dB.
Fig. 4. BER performance versus number of iterations for MPD and AMP in a 16 × 128
system
Furthermore, Fig. 5 presented complexity versus number of users with ﬁxed
receiving antenna number, M = 128. The number of iterations is set to be 8. It
is shown in Fig. 5 that AMP needs more than ten times FLOPs than MPD at
lightly loaded system (let’s say, ϕ < 0.1). However, as the load factor grows, the
complexity of MPD increase faster than AMP. In [3], several variants of AMP
that can signiﬁcantly reduce complexity are proposed.

Complexity Analysis of Massive MIMO Detection
255
0
10
20
30
40
50
60
70
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
x 10
7
Number of Users
FLOPs
AMP
MPD
Fig. 5. Complexity versus number of users with M = 128
4
6
8
10
12
14
10
−5
10
−4
10
−3
10
−2
10
−1
10
0
SNR(dB)
BER
MPD,N=16,M=128
MPD,N=32,M=128
MPD,N=64,M=128
AMP,N=16,M=128
AMP,N=32,M=128
AMP,N=64,M=128
Fig. 6. BER performance of MPD and AMP for diﬀerent values of N(=16, 32, 64) and
ﬁxed M = 128
Figure 6 presents the BER performance of MPD and AMP for a ﬁxed number
of receiver antennas at the BS (M = 128) and varying number of users (N = 16,
32, 64). The number of iterations is big enough to converge. It can be observed
that when N = 16, MPD performs as well as AMP, when N = 32, MPD out-
performs AMP by about 0.2 dB to achieve BER of 10−3, when N = 64, MPD
performs much better than AMP.

256
Z. Yao et al.
6
Conclusions
In this paper, we introduced a uniﬁed message passing graphical model based on
factor graph to describe two detection algorithms dedicated to massive MIMO.
Then detailed computation complexity is analyzed in detail in the terms of
FLOP. Simulation results had shown that thanks to channel hardening phe-
nomenon, the computation complexity of MPD is far less than AMP. In addi-
tion, as the load factor grows, MPD outperformed AMP. Therefore, MPD is a
promising signal detection algorithm for massive MIMO.
Acknowledgement. This paper is supported by the National Natural Science
Foundation of China (No. 61171099 & No. 61671080).
References
1. Larsson, E., Edfors, O., Tufvesson, F.: Massive MIMO for next generation wireless
systems. IEEE Commun. Mag. 52(2), 186–195 (2013)
2. Som, P., Datta, T., Srinidhi, N., Chockalingam, A.: Low-complexity detection in
large-dimension MIMO-ISI channels using graphical models. IEEE J. Sel. Top. Sig.
Process. 5(8), 1497–1511 (2011)
3. Wu, S., Kuang, L., Ni, Z., Lu, J., Huang, D., Guo, Q.: Low-complexity iterative
detection for large-scale multiuser MIMO-OFDM systems using approximate mes-
sage passing. IEEE J. Sel. Top. Sig. Process. 8(5), 902–915 (2014)
4. Narasimhan, T.L., Chockalingam, A.: Channel hardening-exploiting message pass-
ing (CHEMP) receiver in large-scale MIMO systems. IEEE J. Sel. Top. Sig. Process
8(5), 847–860 (2013)
5. Guo, R., Li, X., Fu, W., Hei, Y.: Low-complexity signal detection based on relaxation
iteration method in massive MIMO systems. Commun. China 12(Supplement), 1–8
(2015)
6. Hochwald, B.M., Marzetta, T.L., Tarokh, V.: Multiple-antenna channel hardening
and its implications for rate feedback and scheduling. IEEE Trans. Inf. Theory
50(9), 1893–1909 (1909)
7. Pretti, M.: A message-passing algorithm with damping. J. Stat. Mech. Theory Exp.
2005(11), 283–292 (2005)

Per-Antenna Maximum Likelihood Detector
for Massive MIMO
Senjie Zhang(B), Zhiqiang He, and Baoyu Tian
Key Laboratory of Universal Wireless Communications, Ministry of Education,
Beijing University of Posts and Telecommunications, Beijing 100876, China
{senjie.zhang,hezq,tianbaoyu}@bupt.edu.cn
Abstract. Massive multiple-input multiple-output (MIMO) systems
have attracted extensive attention recently due to their potentials to pro-
vide high system capacity. The uplink receiver of massive MIMO is with
very high complexity due to the large number of antennas at base station,
while the processing time budget reduces in order of magnitude due to
the low latency requirement in next generation wireless systems like 5G.
In this paper, a per-antenna maximum likelihood (PAML) detector is
proposed to address this issue. The proposed PAML detector separates
and distributes ML detection to a group of observation nodes (VNs).
Each VN associates with a receiving antenna and extracts a fraction
of soft information using ML detection. The soft information from all
VNs is accumulated before being delivered to channel decoder. Thus the
degree of parallelism scales up with antenna number. Furthermore, VN
of PAML detector works independently each other. High localization
beneﬁts parallel processing a lot. Simulation results show that PAML
detector approaches ML detector and outperforms MMSE detector.
Keywords: Massive MIMO · Maximum likelihood detection · MLD
Belief propagation · BP · Parallel processing · 5G
1
Introduction
Massive multiple-input multiple-output (MIMO) systems, also called as large-
scale antenna systems, attracted extensive attention in the past few years as a
promising key technology for next generation wireless systems like 5G [1].
In massive MIMO, dozens of or even hundreds of antennas are employed at
base station (BS) [2,3]. The number of receiving antennas is much higher than
the number of concurrent uplink user equipment (UE). Large antenna array pro-
vides high degrees of freedom and increase the system capacity signiﬁcantly [4–6].
Although asymptotical analysis based on random matrix theory demonstrates
that massive MIMO systems can achieve the capacity gain with simple signal
processing methods, traditional MIMO detectors are still favorite for robust to
diﬀerent channel models. Due to the large number of antennas, traditional MIMO
detectors become very complicated.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 257–264, 2018.
https://doi.org/10.1007/978-3-319-72823-0_25

258
S. Zhang et al.
Another important point is the low latency requirements for next genera-
tion wireless systems like 5G [7]. A widely accepted end-to-end latency value
is 1us. The time budget for signal processing may reduce to be lower than
500 ns. It makes the design of massive MIMO detector further challenging. Var-
ious algorithms were proposed to reduce complexity of massive MIMO detector,
e.g. Neumann series expansion [5] and Gauss-Seidel method [8]. However these
algorithms does not exploit the parallelism among receiving antennas so they
are not eﬃcient for low latency processing.
Belief propagation (BP) detector serves as an alternative solution to this
problem [9–11]. In BP detector, the MIMO channel at a given subcarrier is rep-
resented by a factor graph where each receiving antenna is referred as an obser-
vation node (VN) and each UEs transmitted constellation symbol as a symbol
node (SN). VN and SN is equivalent to variable node and check node in LDPC.
Thus BP algorithm can be applied for detection in similar manner as its appli-
cation in LDPC decoders. BP detector requires exchanging belief information
between observation nodes and symbol nodes iteratively. The amount of infor-
mation exchanged is very high. And iterative processing is less attractive for low
latency processing, although BP detector is with high degree of parallelism.
Based on BP detector, in this paper we proposed the per-antenna maxi-
mum likelihood (PAML) detector for massive MIMO. PAML detector has sim-
ilar framework with BP detector, while it replaces BP detectors SN with code
block node (CN), i.e. PAML detector treats each UEs code block (cross multiple
subcarriers) as the check node in LDPC.
In PAML detector, a group of VNs are employed. Each VN associates with a
receiving antenna. From its associated antenna, VN extracts the log-likelihood
ratio (LLR) for multiple UEs code blocks using maximum likelihood detection
(MLD) described in [12]. The CN of PAML detector accumulates the LLR from
diﬀerent VNs and deliver the combined LLR to channel decoders. The enhanced
LLR of each UE, extracted by channel decoder, can be used for a priori informa-
tion to VNs. By utilizing the diversity provided by channel coding, this improve-
ment reduces iteration number. At typical massive MIMO scenario, where the
number of receiving antennas is much higher than the number of concurrent
uplink UEs, PAML detector with two iterations outperforms MMSE detector
and approaches traditional ML detector. Compared with MMSE and traditional
ML detector, PAML detector is more suitable for low latency parallel processing.
The rest of the paper is organized as follows. Section 2 describes the system
model. Section 3 presents details of PAML detector. Numerical simulation results
are given in Sect. 4. Section 5 concludes the entire paper.
Notation: In this paper, lower-case and upper-case boldface letters are used to
denote vectors and matrices, respectively. The operations (·)H and E {·} stand
for conjugate transpose and expectation, respectively. The entry in the i-th row
and j-th column of A is aij; the k-th entry of a is ak.

Per-Antenna Maximum Likelihood Detector for Massive MIMO
259
2
System Model
Consider a MIMO-OFDM system with M uplink UEs, each with a single
antenna, and one BS having a large number of receiving antennas. Let N denote
the number of BS antennas; N is in the range of tens to hundreds. In massive
MIMO, M ≪N.
Given that the system has Q subcarriers, and the number of bits carried per
constellation symbol is Mc. Each UEs channel encoder generates a code block
with Q · Mc bits.
The code block generated by the j-th UE is separated in Q pieces: x<j>
1
,
x<j>
2
,. . . , x<j>
Q
and transmitted o Q subcarriers, where x<j>
q
is an Mc × 1
vector of bits, j = 1, 2, . . . , M is the index of UE and q = 1, 2, . . . , Q is the index
of subcarrier.
Given the q-th subcarrier, denote sq = [sq,1, sq,2, . . . , sq,M]T as an M × 1
vector representing constellation symbols transmitted by all UEs. The entries of
sq are chosen from some complex constellation C with 2Mc points, e.g. Mc =
2 for quaternary phase-shift keying (QPSK). Constellation C is normalized as
E

∥sq,j∥2
=
1
M so the total transmitted power is one.
The entries of sq is determined by using mapping function sq,j = map(x<j>
q
)
(e.g. gray mapping). The M · MC × 1 vector xq = [xq,1, xq,2, . . . , xq,M·MC]T
representing the transmitted bits from all UE is obtained by stacking x<1>
q
,
x<2>
q
,. . . , x<M>
q
. The k-th bit of xq equals the u-th bits transmitted by the
j-th UE where
k = (j −1) · Mc + u, u ∈[1, Mc], k ∈[1, M · Mc]
(1)
In this paper, the logical zero for a bit is represented by amplitude level
xq,k = −1, and the logical one by xq,k = +1, k = 1, . . . , M · MC.
The vector of constellation symbols and the vector of transmitted bits is
related as
sq = vmap(xq) = [map(x<1>
q
), map(x<2>
q
), . . . , map(x<M>
q
)]
T
(2)
At the q-th subcarrier the vector of received signals can be expressed by
yq = Hq · sq + nq
(3)
where Hq is a N × M complex CSI matrix representing the MIMO channel and
nq is a N × 1 vector of independent zero-mean complex Gaussian noise with
variance σ2 per real component.
For convenience of describing per-antenna maximum likelihood detector,
Eq. (3) can be reformulated as
yq =
⎡
⎢⎢⎢⎣
yq,1
yq,2
...
yq,N
⎤
⎥⎥⎥⎦=
⎡
⎢⎢⎢⎣
hq,11 hq,12 . . . hq,1M
hq,21 hq,22 . . . hq,2M
...
...
...
...
hq,N1 hq,N2 . . . hq,NM
⎤
⎥⎥⎥⎦· sq + nq =
⎡
⎢⎢⎢⎣
hq,1
hq,2
...
hq,N
⎤
⎥⎥⎥⎦· sq + nq
(4)

260
S. Zhang et al.
where hq,i is a 1 × M complex CSI vector representing the MIMO channel
between the i-th antenna and all M uplink UEs at the q-th subcarrier, and
i = 1, 2, . . . , N is the index of the receiving antenna.
The CSI vector hq,i is obtained using the received pilots at the i-th antenna.
The pilot from diﬀerent UE distinguishes each other in frequency domain or code
domain, e.g. ZC sequences in LTE systems. So the VN associated with the i-th
antenna can be assumed to know hq,i.
3
Per-Antenna Maximum Likelihood Detector
Figure 1 gives a ﬂowchart of the proposed PAML detector.
Fig. 1. The ﬂowchart of PAML detector with factor graph based model
As Fig. 1 shown, PAML detector consists of N VNs and M CNs. Each VN
associates with a receiving antenna. Each CN corresponds to an uplink UE. VNs
and CNs are connected in fully meshed manner. Between VNs and CNs, LLR of
each modulated bits are exchanged iteratively. VN sends extrinsic LLR to CN.
CN sends a priori LLR to VN.
VNi takes the received signals from the i-th antenna, and the a priori LLR
from all CNs as its input. It extracts extrinsic LLR of bits transmitted by the j-
th UE, denoted a sLE
i,j, and sends LE
i,j to CNj (j = 1, 2, . . . , M). LE
i,j is a Mc×Q
matrix. The q-th column of LE
i,j contains LLR of the MC bits transmitted at the
q-th subcarrier by the j-th UE.
CNj takes LE
i,j, i = 1, 2, . . . , N as its input. It combines all these LLR
matrices, de-interleaves them, and passes them through the soft in/out channel
decoder for the j-th UE. Channel decoders extrinsic LLR output is interleaved
and sent to VNs as a priori LLR. These a priori LLR from CNj to VNi (inter-
leaved version of the j-th channel decoders extrinsic output), denoted as LA
j,i,
has same dimension and correspondence as LE
i,j. At ﬁrst iteration, LA
j,i is an
all-zero matrix since no channel decoder has been called yet.

Per-Antenna Maximum Likelihood Detector for Massive MIMO
261
3.1
Per-antenna Maximum Likelihood Detection
VNi stacks all of its a priori LLR inputs to be a global M ·Mc ×Q a priori LLR
matrix as
LA =

lA
1 lA
2 . . . lA
Q

=

LA
1,i
T LA
2,i
T . . . LA
M,i
T T
(5)
where lA
q is the q-th column of LA. The k-th entry of lA
q gives the a priori
information of xq,k as
lA
q,k = logP(xk = +1)
P(xk = −1)
(6)
As described in [12], at the q-th subcarrier, extrinsic LLR of bit xq,k can be
obtained using a scalar input yq,i as
lE
q,k = log

xq∈Xk
+1 p(yq,i | xq) · exp(0.5 · xT
[k] · lA
q,[k])

xq∈Xk
−1 p(yq,i | xq) · exp(0.5 · xT
[k] · lA
q,[k])
(7)
where Xk
+1 is the set of 2M·Mc−1 possible values of xq having xq,k = +1; Xk
−1
is the set of 2M·Mc−1 possible values of xq having xq,k = −1; x[k] denotes
the subvector of xq obtained by omitting its k-th entry xk; lA
q,[k] denotes the
subvector of lA
q also omitting its k-th entry lA
q,k.
From (3) and (4) it is easily to found
p(yq,i | xq) = exp(−1
2σ2 · ∥yq,i −hq,i · sq∥2)
2πσ2
(8)
where sq = vmap(xq).
With approximation log(ea1 + ea2) ≈max(a1, a2), the extrinsic LLR of bit
xq,k becomes
lE
q,k =1
2 · max
x∈Xk
+1

−1
σ2 · ∥yq,i −hq,i · sq∥2) + xT
[k] · lA
q,[k]

−
1
2 · max
x∈Xk
−1

−1
σ2 · ∥yq,i −hq,i · sq∥2) + xT
[k] · lA
q,[k]

(9)
where lE
q,k is the u-th entry of the q-th column in VNis output LE
i,j. The indexes
u and k obey the relation in (1).
In uplink MIMO, inter-UE interference and noise constrain system perfor-
mance. Inter-UE interference is mitigated by ML detection described in (9).
Averaging multiple observations, as the essential anti-noise method, cannot be
carried out in VN since each VN has only one observation from the i-th antenna.
To boost performance against noise, multi-antenna combination is introduced
in CN.

262
S. Zhang et al.
3.2
Multi-antenna Combination and Iterative Detection
CNj associates with the j-th UE. For the MC × Q bits in j-th UE’s code block,
CNj has N sets of LLR from N VNs, denoted as LE
i,j, i = 1, 2, . . . , N. Using
typical BP iteration, CNj outputs the a priori LLR of these bits in code block
to VNi as
LA
j,i = dec(

1≤i′≤N,i′̸=i
LE
i′,j)
(10)
where dec(·) represents the procedure of de-interleaving, soft-in/out decoding
and re-interleaving. Any soft-in soft-out channel decoding scheme is applicable,
e.g. BahlCCockeCJelinekCRaviv (BCJR) algorithm.
Introduction of channel decoding in CN utilizes the diversity provided by
channel code. Compared with the typical operations in CN, where simple syn-
thesis of VN output is employed, the iteration number reduces signiﬁcantly. The
typical iteration number of iterative MIMO receiver is less than 10. On the other
hand, we can see therere lots of girth-4 ring in PAML detectors factor graph from
Fig. 1. With this issue no much improvement should be expected using typical
BP algorithm with a huge iteration number.
With small iteration number, the accumulation of a priori information has
negligible impact. So a simple procedure, described as
LA
j,i = LA
j = dec(

1≤i′≤N
LE
i′,j)
(11)
can be used in CN. In this simple procedure, CN does not generate speciﬁc
output for diﬀerent VN. It combines LLR from all VN for channel decoding, and
broadcasts a single version output to all VN.
3.3
Beneﬁt to Parallel Processing
Because of per-antenna detection, a VN in PAML detector does not requires
any information from other VNs. All VNs work independently so a full degree
of parallelism, up to the huge number of receiving antenna N in massive MIMO,
is obtained. High degree of parallelism conduces low latency processing. Similar
independent processing is also obtained among CNs at per-UE level.
Introduction of channel decoding in CN converts the iteration between VN
and CN into the iteration inside the channel decoder in CN. The signiﬁcantly
reduced iteration number between VN and CN beneﬁts PAML detector with low
latency detection and low intra-node communication load. Also a low complexity
CN is obtained since the number of calling channel decoder reduces from N (once
per VN) to 1 (once for the associated UE).
4
Simulation Results
In numerical simulations, two conﬁgurations are used: N = 32, M = 2 and
N = 64, M = 4. Independent and identically distributed (i.i.d.) Rayleigh fading

Per-Antenna Maximum Likelihood Detector for Massive MIMO
263
is used, and CSI is assumed to be known in receiver perfectly. For channel coding,
we use the rate-1/2 LDPC code of MacKay in [13], which is based on a random
regular factor graph with ds = 3, dc = 6. The length of code block is 4000. The
BP iteration number for LDPC decoding in CN is 50. Four types of receivers
are compared: MMSE, MLD, and the proposed PAML detector with one or
two iterations between VN and CN. The simulation results are shown in Figs. 2
and 3.
−11.5
−11
−10.5
−10
−9.5
10
−4
10
−3
10
−2
10
−1
SNR in dB
BER
Coded BER, N=32, M=2, QPSK
MMSE
MLD
PAML,1 it
PAML,2 it
Fig. 2. Coded BER curves of massive MIMO with 32 receiving antennas and 2 con-
current uplink UEs using MMSE, MLD and PAML detector, QPSK
−11.5
−11
−10.5
−10
−9.5
10
−4
10
−3
10
−2
10
−1
SNR in dB
BER
Coded BER, N=64, M=4, QPSK
MMSE
MLD
PAML,1 it
PAML,2 it
Fig. 3. Coded BER curves of massive MIMO with 64 receiving antennas and 4 con-
current uplink UEs using MMSE, MLD and PAML detector, QPSK
Figures 2 and 3 show that MMSE and MLD detector has almost same perfor-
mance in massive MIMO, while PAML detector with one iteration approaches
them with 0.2 0.5 dB gap. With two iterations, PAML detector slightly outper-
forms these two classical receivers.

264
S. Zhang et al.
5
Conclusion
In this paper, the per-antenna maximum likelihood (PAML) detector is pro-
posed. PAML detector beneﬁts low latency parallel processing for massive MIMO
uplink receiver in terms of high degree of parallelism, low iteration number and
low intra-node communication load. Simulation results show PAML detector
slightly outperforms the classical MMSE and MLD detectors with two iterations.
Further work will be directed towards BP-like detection for MIMO systems with
short ring avoidance utilizing CSI feedback and its cooperation with channel
codes.
Acknowledgment. This work is supported by the National Natural Science Founda-
tion of China (No. 61171099), and 863 Program (No. 2015AA01A709).
The authors would also like to thank Mr. Sunny Zhang, the director of Intel Labs
Chinas communication infrastructure research team, for his support.
References
1. Larsson, E.G., Tufvesson, F., Edfors, O., Marzetta, T.L.: Massive MIMO for next
generation wireless systems. IEEE Commun. Mag. 52(2), 186–195 (2014)
2. 3GPP TR 36.873 V12.2.0 (2014-09), Study on 3D channel model for LTE
3. 3GPP TR 36.897 V13.0.0 (2015-12), Study on Elevation Beamforming/ Full-
Dimension (FD) MIMO for LTE
4. Marzetta, T.L.: Noncooperative cellular wireless with unlimited numbers of base
station antennas. IEEE Trans. Wirel. Commun. 9, 3590–3600 (2010)
5. Rusek, F., Persson, D., Lau, B.K., Larsson, E.G., Marzetta, T.L., Edfors, O.,
Tufvesson, F.: Scaling up MIMO: opportunities and challenges with very large
arrays. IEEE Sig. Process. Mag. 30, 40–46 (2013)
6. Lu, L., Li, G.Y., Swinlehurst, A.L., Ashikhmin, A., Zhang, R.: An overview of
massive MIMO: beneﬁts and challenges. IEEE J. Sel. Topics Sig. Process. 8(5),
742–758 (2014)
7. Recommendation ITU-R M.2083 (2015-09), IMT Vision - Framework and overall
objectives of the future development of IMT for 2020 and beyond
8. Dai, L., Gao, X., Su, X., Han, S., Chih-Lin, I., Wang, Z.: Low-complexity soft-
output signal detection based on Gauss-Seidel method for uplink multiuser large-
scale MIMO systems. IEEE Trans. Veh. Technol. 64(99), 4839–4845 (2014)
9. Haroun, A., Nour, C.A., Arzel, M., Jego, C.: Symbolbased BP detection for MIMO
systems associated with non-binary LDPC codes. In: Proceedings of IEEE Wireless
Communications and Networking Conference (WCNC), Istanbul, Turkey, pp. 212–
217, April 2014
10. Yang, J., Zhang, C., Liang, X., Xu, S., You, X.: Improved symbol-based belief prop-
agationdetection for large-scale MIMO. In: IEEE Workshop on Signal Processing
Systems (SiPS), October 2015
11. Lakshmi Narasimhan, T., Chockalingam, A.: Detection in large-scale multiuser SM-
MIMO systems: algorithms and performance. In: IEEE 79th Vehicular Technology
Conference (VTC Spring) (2014)
12. Hochwald, B.M., ten Brink, S.: Achieving near-capacity on a multiple-antenna
channel. IEEE Trans. Commun. 51(3), 389–399 (2003)
13. MacKay, D.J.C.: Online database of low-density parity-check codes. http://wol.ra.
phy.cam.uk/mackay/codes/data.html

Joint User-Association and Resource-Allocation
in Virtualized C-RAN
Xiaohong Zhang(B), Yong Li, and Mugen Peng
The Key Laboratory of Universal Wireless Communication for Ministry of Education,
Beijing University of Posts and Telecommunications, Beijing 100876, China
zhangxh@bupt.edu.cn
Abstract. The Cloud Radio Access Network (C-RAN), which is a novel
architecture, has been proposed as a promising solution to overcome
the challenges of Next Generation (5G) cellular networks, in terms of
eﬃciency, capacity, scalability, ﬂexibility and sustainability in a cost-
eﬀective way. In this paper, we develop an eﬃcient resource allocation
scheme in the fronthaul-constrained C-RAN to support users of diﬀer-
ent slices (service providers). Multiple slices (service providers) share the
resource of an InP, each slice has its own quality-of-service (QoS) require-
ment. In speciﬁc, we formulate an optimization problem for maximizing
network throughput by joint subcarrier, power allocation and user-RRH
association assignment in the downlink transmission of C-RAN. This
problem is NP-hard, therefore, we introduce a two-step suboptimal algo-
rithm to solve it. The original problem is decomposed into joint power
and subcarrier allocation subproblem and user-RRH association assign-
ment subproblem. Firstly, we solving the user-RRH association subprob-
lem under the fronthaul capacity constraint by the binary search algo-
rithm. Then the dual decomposition algorithm is used to solve the power
and subcarrier allocation subproblem. Simulation results demonstrate
the eﬀectiveness of our proposed algorithm.
Keywords: Virtualized C-RAN · Fronthaul constrained
Joint subcarrier · Power and user-RRH association assignment
1
Introduction
Cloud radio access network (C-RAN) is a promising and cost-eﬃcient mobile
network architecture, which can improve network capacity and coverage to han-
dle the ever-growing demand for mobile data transmission in 5G network [1]. The
basic concept of C-RAN is to decouple traditional base station (BS) functions
into two parts: the distributed installed remote radio heads (RRHs) and the
baseband units (BBUs) clustered as a BBU pool in a centralized cloud server.
As presented in the Fig. 1, a mobile user can be associated with one or multi-
ple RRHs through wireless channel, and RRHs are connected to the BBU pool
via the high-speed, low latency ﬁber transport link (fronthaul) [2,3]. Regardless
of reducing the capital expenses (CAPEX) and operational expenses (OPEX)
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 265–275, 2018.
https://doi.org/10.1007/978-3-319-72823-0_26

266
X. Zhang et al.
that is achieved by C-RAN, a practical fronthaul is always capacity constrained,
which will reduce C-RAN performance gain [4].
In C-RAN, supporting for resource sharing among multiple network slices is
an important scenario. Network slicing consists of deploying multiple end-to-end
logical networks in support of independent business operations. In contrast to
deploying an independent network infrastructure, each slice should be possible to
realize as a logical network corresponding to a shared infrastructure, which allows
serving diverse service requirements and satisfy the traﬃc growing demand in
5G network [5,6]. For example, the radio resources of a network operator are
shared among multiple service providers, which can serve their own users and
can be considered as slices [7,8]. Each slice requires a minimum reserved rate
representing its QoS requirement.
Resource management always has a signiﬁcant impact on network perfor-
mance. To achieve eﬃcient network resource utilization, a network operator
requires to dynamically allocate radio resources among service providers (slices).
Previous studies have been performed on resource sharing in cellular networks.
For example, in [8], a resource management scheme for jointing physical resource
block (PRB) and power allocation in LTE system is studied, which schedules the
slices based on a proportional fairness rule with the objective to maximize the
sum rate. In [9], a resource virtualization scheme is studied by introducing two
diﬀerent types of slices, including rate based and resource-based slices, where
the minimum rate and minimum network resources are preserved for each slice,
respectively. Generally, these works have focused on analyzing resource virtual-
ization in a single base station, which can’t be directly extended to a C-RAN with
densely deployed RRHs [10]. An eﬃcient resource sharing mechanism to support
multiple slices in a C-RAN can improve network performance and resource uti-
lization eﬃciency. Therefore, we propose to study the combination of wireless
resource virtualization and C-RAN to achieve eﬃcient resource sharing.
Note that without the fronthaul capacity constraint, each user can be served
by all RRHs, however, considering the practical fronthaul links are capacity
constrained, it is beneﬁcial to optimize the user-RRH association to improve the
system performance in C-RAN [11]. Therefore, the main objective of this paper
is to propose a new model that a number of slices share the C-RAN. Speciﬁcally,
we aim to maximize the network throughput by joint optimizing the power,
subcarrier allocation and user-RRH association assignment for diﬀerent slices’
users of C-RAN.
It is obvious that the optimization problem is NP-hard, in other words, it
can’t be optimally solved with large number of users and RRHs in C-RAN.
Therefore, we introduce a two-step suboptimal algorithm to practically solve
this problem, the optimization problem is decomposed into user-RRH association
assignment subproblem and joint power and subcarrier allocation subproblem;
the ﬁrst subproblem can be solved by the binary search algorithm and the second
one can be solved by the dual decomposition algorithm. This algorithm is proved
to be eﬀective by the simulation results.

Joint User-Association and Resource-Allocation in Virtualized C-RAN
267
The rest of the paper is organized as follows. Section 2 describes the system
model and formalizes the problem. Section 3 proposes an algorithm for dynamic
resource sharing of all slices’ users. In Sect. 4, simulation results demonstrate
that the algorithm is eﬀective. Finally, this paper is concluded in Sect. 5.
2
System Model and Problem Formulation
2.1
System Model
As is shown in Fig. 1, we consider the downlink transmission of fronthaul-
constrained C-RAN, where the coverage of a speciﬁc area is provided by N
RRHs. It is assumed that each RRH n is connected to the BBU pool via a fron-
thaul link with a capacity of Tn. The total system bandwidth of B MHz is divided
into C subcarriers and shared by users through orthogonal frequency-division
multiple access (OFDMA). The bandwidth of each subcarrier i.e., Bc = B/C
is assumed to be smaller compared to the coherent bandwidth of the wireless
channel. Therefore the channel gain of user in each sub-carrier can be considered
ﬂat. The system serves a set of slices, M = {1, · · · , m, · · · , M}, where the slice
m has a set of users denoted by Km = {1, · · · , km, · · · , Km} and requests for a
minimum reserved rate of Rrsv
m
to guarantee a minimum acceptable service level
for its users. Then the total number of users is K = M
m=1 Km.
Fig. 1. System model of the downlink communication in C-RAN

268
X. Zhang et al.
Let pc,km denotes the allocated power to user km on the subcarrier c, and
hn,c,km is the channel power gain of the wireless link between RRH n and user
km of slice m over the subcarrier c, which represents the channel state informa-
tion (CSI). The binary variables αc,km and βn,km represent the assignment of
subcarrier and user-RRH association of user km, respectively, and where
αc,km =

1
if subcarrier c is allocated to user km
0
otherwise
,
βn,km =

1
if RRH n serves user km
0
otherwise
.
Due to the OFDMA limitation, one subcarrier must be allocated to exactly one
user, it is required that M
m=1
Km
k=1 αc,km=1.
2.2
Optimization Problem Formulation
In the downlink of C-RAN, each user has a set of RRHs to provide service, the
BBU pool sends the user messages to each serving RRH via its fronthaul link,
then each serving RRH upconverts the user messages into wireless signals and
sends them to the user [13]. Then the received equivalent baseband transmit
signal of user km at subcarrier c can be expressed as
yc,km =

n∈N
βn,kmhn,c,kmwn,c,kmpc,kmxc,km + zc,km
(1)
where xc,km∼CN(0, 1) denotes the transmit message intended for user km
(which is modeled as a circularly symmetric complex Gaussian (CSCG) ran-
dom variable with zero-mean and unit-variance), and wn,c,km denotes RRH n’s
normalized precoding vector for user km at subcarrier c. zc,km∼CN(0, σ2) is
the additive white Gaussian noise (AWGN) at user km over subcarrier c, σ2 is
the noise power. Without loss of generality, consider σ2 to be the same for users
in all RRHs and subcarriers. In this paper, it is assumed that BBU pool knows
the channels to all the K users perfectly.
According to formulation (1), the decoding SNR for user km at subcarrier c
is thus expressed as
rc,km =

n∈N βn,km |hn,c,km|2 pc,km
σ2
∀c, k
(2)
Then, the achievable rate of user km at subcarrier c in Mbps is given by
Rc,km =Bc log2(1 + rc,km)
=Bc log2(1 +

n∈N βn,km |hn,c,km|2 pc,km
σ2
)
(3)
Considering that all users served by RRH n share its maximum transmit
power Pn, then the power constraint can be formulated as:
C1 :

m∈M

k∈Km

c∈C
αc,kmβn,kmPc,km ≤Pn
∀n
(4)

Joint User-Association and Resource-Allocation in Virtualized C-RAN
269
If user km is served by RRH n, BBU pool will send the digital messages for user
km to RRH n over its fronthaul link n at a rate of Rkm,n, which is the transmitted
rate of user km in all allocated subcarriers from RRH n. Therefore, take the
fronthaul capacity constraint of RRH n into account, it can be expressed as :
C2 :

m∈M

k∈Km

c∈C
αc,kmβn,kmRc,km ≤Tn
∀n
(5)
The required minimum reserve rate of slice m to guarantee its QoS requirement
can be represented as:
C3 :

k∈Km

c∈C
αc,kmRc,km ≥Rrsv
m
∀m
(6)
Next, the constraint of OFDMA in subcarriers allocation can be given below:
C4 :

m∈M

k∈Km
αc,km ≤1
∀c
(7)
Hence, in order to achieve maximum network throughput of users of all slices,
the joint power, subcarrier and RRH assignment for diﬀerent slices’ users in this
system can be formulated as:
max
{p,α,β}

m∈M

k∈Km

c∈C αc,kmRc,km
subject to :
C1, C2, C3 and C4
(8)
3
Joint User-RRH Association and Resource Allocation
The optimization problem (8) is a non-convex mixed-integer problem, which has
one continuous variable p and two binary variables α and β. Such an optimiza-
tion problem is always NP hard [15], therefore, we propose an eﬃcient two-step
algorithm that is based on the decomposition of the original problem to the sep-
arate tasks of RRH assignment and joint subcarrier and power allocation, which
obtains a suboptimal solution in general [14].
3.1
User-RRH Association Optimization Problem
Due to the fronthaul capacity is constrained, a user can’t be served by all the
RRHs, hence, we make attempt to optimize the user-RRH association for slices’
users in C-RAN in problem (8). However, it is diﬃcult to solve. In order to
simplify the original problem (8), we separate the user-RRH association (fron-
thaul link) assignment problem from it, then propose a binary search method to
allocate the fronthaul link by optimization maximizing the total rate gain over
the active fronthaul links. Given the assumptions that average power distribu-
tion pkm and hn,km is the path gain on link RRH n to user km without channel
variations, the rate of user km transmitted by RRH n is
Rn,km = B log 2(1 + |hn,km|2 pkm
σ2
)
(9)

270
X. Zhang et al.
Therefore, this optimization subproblem can be derived as :
max
{β}

m∈M

k∈Km

n∈N
βn,kmRn,km
s.t.

n∈N
βn,km ≤S
∀k

m∈M

k∈Km
βn,kmRn,km ≤Tn
∀n
(10)
where the ﬁrst constraint in problem (10) ensures each user can be connected
with no more than s RRHs, so that to facilitate the simple binary search method
to solve the allocation of fronthaul link. While the second constraint ensures
that the sum-rate of users served by RRH n satisﬁes the capacity limitation of
fronthaul link n. Then the fronthaul link allocation optimization problem can be
solved by the binary search algorithm, it can be shown:
Algorithm 1. Binary-search algorithm
1: Initialization: Rn ,k m = {Rn,km} ∈RN×K
user-RRH association set: β ←0 ∈RN×K
2: for n = 1, 2, ..., N
3: Initialize Rn = 0
4: Repeat
5:
for k = 1, 2, ...km, ..., K
6:
Find the user-RRH association:
(k∗
m, n∗) =argmax(Rn,km)
7:
if Rn + Rn∗,k∗m ≤Tn and 
n∈N βn,km < S
8:
then: Rn ←Rn + Rn∗,k∗m
9:
β(n∗, k∗
m) ←1
10:
Rn ,k m ←Rn ,k m −{Rn∗,k∗m}
11:
end if
12:
end for
13: end for
14: Output β
15: Solve optimization problem (10).
3.2
Joint Subcarrier and Power Allocation Scheme
Given a feasible user-RRH association assignment, the value of β is determined,
then the optimization problem of joint subcarrier and power allocation on dif-
ferent fronthaul links can be separated from problem (8) and expressed as:
max
{p,α}

m∈M

k∈Km

c∈C
αc,kmRc,km
s.t.
constraints
C1, C3, C4
(11)

Joint User-Association and Resource-Allocation in Virtualized C-RAN
271
The problem (11) is still a mixed binary integer nonlinear programming prob-
lem, the decision variables α and p in the problem are binary variables and con-
tinuous variables, respectively. Such an optimization problem is generally hard
to solve. Then the dual decomposition algorithm can be used to solve the prob-
lem eﬀectively [15], since the duality gap between the primal problem and the
dual problem in a multicarrier system is approximately zero for a large number
of subcarriers [16].
First, we obtain the Lagrangian function of the original problem (11) as
follows:
L(p, α, λ, η)
=

m∈M

k∈Km

c∈C
αc,kmRc,km
−

n∈N
λn(

m∈M

k∈Km

c∈C
αc,kmβn,kmpc,km −Pn)
+

m∈M
ηm(

k∈Km

c∈C
αc,kmRc,km −Rrsv
m )
(12)
where λ = [λ1, λ2, ..., λN]T , η = [η1, η2, ..., ηM]T are dual variables. Thus, we can
get the dual objective function of the original problem expressed as:
g(λ, η) = max
{p,α} L(p, α, λ, η)
(13)
The dual problem of the original problem (11) can be expressed as follows:
min
{λ,η}
g(λ, η)
s.t.
λ ≥0, η ≥0
(14)
Then the original problem is divided into one main problem and C × K
subproblems by dual decomposition.
When
the
Lagrange
multipliers
are
determined,

n∈N λnPn
and

m∈M ηmRrsv
m
are constants. For given α, we can ﬁrst derive the optimal power
allocation P ∗from the subproblem below:
max
{p}
(1 + ηm)Rc,km −

n∈N λnβn,kmpc,km
s.t.
pc,km ≥0
∀c, k
(15)
Based on the optimal power allocation P ∗, we can obtain the rate set
{Rc,1, ..., Rc,K} of subcarrier c, therefore, the subcarriers α∗are allocated
according to the rule:
αc,k∗
m =
⎧
⎨
⎩
1
k∗
m = arg max
{k} Rc,km
0
otherwise
(16)
In other word, the idea of this rule is to allocate subcarriers to users that have
high performance gains. After solving above subcarrier assignment problems and
C × K subproblems, the dual objective function g(λ, η) can be obtained.

272
X. Zhang et al.
With the help of sub-gradient method, the dual problem (14) to ﬁnd the
optimal values of dual variables can be solved. Based on the obtained power
value P ∗, subcarrier allocation value α∗
c,km, user-RRH association βn,km and the
initial λ0, η0, the dual variables at the (t + 1)-th iteration can be updated as:
λ(t+1)
n
=

λ(t)
n −δ(t)
1 (Pn −

k∈K

c∈C
α∗
c,kmβ∗
n,kmPc,km)
	+
η(t+1)
m
=

η(t)
m −δ(t)
2 (

k∈Km

c∈C
α∗
c,kmRc,km −Rrsv
m )
	+
(17)
where [x]+ = max{0, x}, δ(t)
1
and δ(t)
2
are appropriate step size of the t-th itera-
tion to guarantee the convergence of the sub-gradient method. In order to solve
the problem (11), the allocated power P ∗and subcarrier α∗should be recom-
puted under λ(t) and η(t). Once converged, the iteration will be stopped. Then
the original optimization problem (8) for jointing power, subcarrier, and user-
RRH association assignment for diﬀerent slices’ users in C-RAN can be solved.
3.3
Comparison Schemes
Besides two-step Algorithm 1 proposed above, we also consider the following
benchmark schemes for network performance comparison.
◦
Benchmark
Scheme
1:
Static
resource
sharing
for
diﬀerent
Slices
(Algorithm 2). According to the service level agreement (SLA) between slices,
diﬀerent slices in system statically share radio resources and RRHs by a cer-
tain percentage. In this paper, we determine the resources allocation percentage
based on the number of users served by diﬀerent slices. Then each slice dynami-
cally allocates the acquired resource to its users with the goal of maximizing the
network throughput.
◦
Benchmark Scheme 2: Average resource allocation algorithm (Algorithm 3).
We distribute subcarrier, power and RRH equally to all users of diﬀerent slices,
regardless of the channel characteristics of the diﬀerent subcarriers and the ser-
vice level agreement (SLA) between slices.
4
Simulation Results
In this section, simulation results are provided to evaluate the performance of
our proposed two-step algorithm for joint power and subcarrier and RRH assign-
ment for users of diﬀerent slices in C-RAN. Let’s consider a virtualized C-RAN
scenario with N = 5 RRHs serving M = 2 slices (service providers). Without loss
of generality, the channels of diﬀerent subcarriers are assumed to be independent
of one another, and taken from i.i.d. complex Gaussian random variables with
zero mean and unit variance. Each slice (service providers) serves a number of
users. Furthermore, the minimum reserved rate Rrsv
m
for each slice m is deter-
mined according to its QoS requirement. For all of our simulations, we assume

Joint User-Association and Resource-Allocation in Virtualized C-RAN
273
Fig. 2. Total throughput versus maximum transmit power of RRH
Fig. 3. Total throughput versus number of users, K
the fronthaul capacity Tn and the available power Pn are same for all RRH n,
and Tn = 1 Mbps, each user could be served by no more than 3 RRHs.
Firstly, we evaluate and compare the total throughput achieved by Algo-
rithm 1, Algorithm 2 and Algorithm 3 versus the maximum transmit power Pn
and the number of users K in Figs. 2 and 3, respectively. Part of simulation
parameters can be set to: in Fig. 2, K = 5, slice 1 has 3 users and the minimum
reserved rate Rrsv
1
= 1 Mbps, while slice 2 has 2 users and Rrsv
2
= 0.6 Mbps. In
Fig. 3, we evaluate the total throughput achieved for diﬀerent number of users
when Pn = 30 watts. The results in both Figs. 2 and 3 indicate that Algorithm 1
considerably outperforms Algorithm 2 and Algorithm 3 for diﬀerent values of
Pn and K.

274
X. Zhang et al.
Fig. 4. Spectral eﬃciency
Then we evaluate and compare the spectral eﬃciency achieved by Algo-
rithm 1, Algorithm 2 and Algorithm 3 for slice 1, slice 2 and the whole network.
Where each slice has 3 users with the Pn = 30 watts, Rrsv
1
= Rrsv
2
= 1 Mbps.
The results can be shown in Fig. 4 revealing that resource utilization achieved
by Algorithm 1 is higher than Algorithm 2 and Algorithm 3. The resource allo-
cation scheme based on Algorithm 1 and Algorithm 2 both can satisfy the SLA
constraint between diﬀerent slices, however, each slice assigns resources to its
own users independently in Algorithm 2, hence, it can’t achieve the dynamic
sharing of resources between diﬀerent slices. For Algorithm 3, lacking of ﬂexi-
bility in resource allocation leads to low resource utilization and can’t achieve
on-demand resources allocation for diﬀerent slices.
5
Conclusion
In this paper, we considered a set of slices (service providers) in C-RAN, each
of which serves its own users and requires a minimum reserved rate, then we
formulate an NP-hard problem for jointing subcarrier and power allocation and
RRH assignment for diﬀerent slices’ users. In order to solve it eﬀectively, a two-
step suboptimization algorithm is proposed. Numerical results conﬁrm that the
proposed algorithm is more eﬃcient than other approaches. Furthermore, they
show the algorithm can satisfy the QoS requirement of diﬀerent slices’ users and
achieve better network performance in both throughput and spectral eﬃciency.
Acknowledgement. This work was supported in part by the National High Tech-
nology Research and Development Program (863 Program) of China under Grant
No. 2014AA01A707.

Joint User-Association and Resource-Allocation in Virtualized C-RAN
275
References
1. Checko, A., Christiansen, H.L., Yan, Y., et al.: Cloud RAN for mobile networks a
technology overview. IEEE Commun. Surv. Tutorials 17(1), 405–426 (2015)
2. Peng, M., Wang, C., et al.: Fronthaul-constrained cloud radio access networks:
insights and challenges. IEEE Wirel. Commun. 22(2), 152–160 (2015)
3. Huang, J., Duan, R., Cui, C., Chih-Lin, I.: Overview of cloud RAN. In: Proceedings
of URSI General Assembly and Scientiﬁc Symposium (URSI GASS), Beijing, pp.
1–4, April 2014
4. Sun, Y., Li, C., Huang, Y., Yang, L.: Energy-eﬃcient resource allocation in C-RAN
with fronthaul rate constraints. In: Proceedings of International Conference on
Wireless Communications Signal Processing (WCSP), Yangzhou, pp. 1–6, August
2016
5. Yoo, T.: Network slicing architecture for 5G network. In: Proceedings of Inter-
national Conference on Information and Communication Technology Convergence
(ICTC), Jeju Island, South Korea, pp. 1010–1014, October 2016
6. Pries, R., Morper, H.J., Galambosi, N., Jarschel, M.: Network as a service - a demo
on 5G network slicing. In: Proceedings of International Teletraﬃc Congress (ITC),
Wrzburg, Germany, pp. 209–211, September 2016
7. Parsaeefard, S., Dawadi, R., Derakhshani, M., Le-Ngoc, T.: Joint user-association
and resource-allocation in virtualized wireless networks. IEEE Access 4, 2738–2750
(2016)
8. Kamel, M.I., Le, L.B., Girard, A.: LTE wireless network virtualization: dynamic
slicing via ﬂexible scheduling. In: Proceedings of IEEE, Vehicular Technology Con-
ference (VTC), Vancouver, BC, pp. 1–5, September 2014
9. Feng, Z., Qiu, C., et al.: An eﬀective approach to 5G: wireless network virtualiza-
tion. IEEE Commun. Mag. 53(12), 53–59 (2015)
10. Niu, B., Zhou, Y., Shah-Mansouri, H., et al.: A dynamic resource sharing mecha-
nism for cloud radio access networks. IEEE Trans. Wirel. Commun. 15(12), 8325–
8338 (2016)
11. Liu, L., Zhang, R.: Downlink SINR balancing in C-RAN under limited fronthaul
capacity. In: Proceedings of IEEE International Conference on Acoustics, Speech
and Signal Processing (ICASSP), Shanghai, pp. 3506–3510, May 2016
12. Kokku, R., Mahindra, R., Zhang, H., Rangarajan, S.: NVS: a substrate for vir-
tualizing wireless resources in cellular networks. IEEE ACM Trans. Netw. 20(5),
1333–1346 (2012)
13. Liu, L., Bi, S., Zhang, R.: Joint power control and fronthaul rate allocation for
throughput maximization in OFDMA-based cloud radio access network. IEEE
Trans. Commun. 63(11), 4097–4110 (2015)
14. Fallgren, M.: An optimization approach to joint cell, channel and power allocation
in multicell relay networks. IEEE Trans. Wirel. Commun. 11(8), 2868–2875 (2012)
15. Boyd, S., Vandenberghe, L.: Convex Optimization. Cambridge University Press,
Cambridge (2004)
16. Yu, W., Liu, R.: Dual methods for nonconvex spectrum optimization of multicarrier
systems. IEEE Trans. Commun. 54(7), 1310–1322 (2006)

Adaptive Resource Allocation
for Device-to-Device Aided Cellular Systems
Xianxian Wang1, Shaobo Lv1, Xiaoyu Liang1, Tong Liu2(B), Hongwen Cheng3,
and Zhongshan Zhang1
1 Technology Research Center for Convergence Networks and Ubiquitous Services,
University of Science and Technology Beijing (USTB), Beijing 100083, China
zhangzs@ustb.edu.cn
2 Department of Information and Communication Engineering,
Harbin Engineering University, 145 Nantong Street, Harbin, China
liutong@hrbeu.edu.cn
3 China Unicom Huangshan Branch, Huangshan Road 170, Tunxi District,
Huangshan City, Anhui Provice, China
hongwencheng@chinaunicom.cn
Abstract. Resource allocation in device-to-device (D2D) aided cellu-
lar systems, in which the proximity users are allowed to communicate
directly with each other without relying on the intervention of base
stations (BSs), is investigated. A new uplink resource allocation pol-
icy is proposed for enabling the D2D user equipments (DUEs) to reuse
the licensed spectrum, provided that the minimum signal-to-interference
(SIR) requirement of conventional cellular user equipments (CUEs) is
satisﬁed. Furthermore, the proposed resource-allocation problem can be
formulated as “maximizing the number of simultaneously activated D2D
pairs subject to the SIR constraints at both CUEs and DUEs”. Numer-
ical results relying on system-level simulation show that the proposed
scheme is capable of substantially improving both the D2D-access prob-
ability and the network throughput without sacriﬁcing the performance
of conventional CUEs.
Keywords: Device-to-device · D2D-access probability
Network throughput
1
Introduction
With the rapid development of wireless communication techniques as well as the
rapid popularity of smart terminals (e.g. ipad and iphone), the existing cellular
networks are becoming increasingly diﬃcult to meet the customers’ exponentially
growing data traﬃc demand [1–3]. Therefore, both wireless spectrum eﬃciency
and network capacity need to be further enhanced [4–6]. Meanwhile, the base
stations (BSs) may often operate at an overloaded state due to the existing BS-
centric architecture of wireless access network (WAN), consequently resulting in
a serious load imbalance over the whole WAN.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 276–287, 2018.
https://doi.org/10.1007/978-3-319-72823-0_27

Adaptive Resource Allocation
277
Device-to-Device (D2D) communication technology is regarded as one of the
eﬀective ways [7–9] for addressing the above-mentioned issues mainly based on
the following beneﬁts. On the one hand, proximity communication is capable of
oﬀering a higher channel quality between proximity-communication peers, corre-
sponding to a higher channel capacity [10] as well as a lower power consumption
[11]. On the other hand, a much lower delay than in conventional cellular commu-
nications can be guaranteed by implementing the scheme of direct transmission
between users [12]. Furthermore, through reusing the licensed spectrum of con-
ventional cellular user equipments (CUEs), the spectral eﬃciency of wireless
networks can be substantially improved by activating D2D links [13,14].
However, activating the D2D links may impose a severe interference on the
conventional CUEs, thus signiﬁcantly eroding the performance of the latter [15].
To achieve a better overall system performance while guaranteeing the min-
imum Quality of Service (QoS) requirement of CUEs, an appropriate interfer-
ence management technique (e.g., in terms of resource allocation, mode selection
and power control) must be implemented in the activated D2D user equipments
(DUEs).
Up to now, interference-management technologies for D2D aided cellular sys-
tem have been widely studied in both academy and industry [15,16]. To coor-
dinate the interference among CUEs and DUEs, the authors in [17] proposed a
new technique for optimizing the sum data rate relying on power control schemes
of diﬀerent modes. Subject to a sum-rate constraint, a distributed power con-
trol algorithm relying on small-scale path losses has been proposed in [18] for
minimizing the overall power consumption. Furthermore, a resource allocation
scheme, in which the local awareness of the interference between CUEs and
DUEs can be generated at the BSs, is proposed for minimizing the interference
imposed on the CUEs [19]. In order to better combine the advantages of resource
allocation and power control techniques, a jointly resource allocation and power
control scheme has been proposed in [20] for maximizing the energy-eﬃciency
(EE) of D2D aided underlaying cellular networks. In addition, a joint scheme
by considering mode selection, channel assignment and power control simulta-
neously in D2D communications has been proposed in [21] for optimizing the
overall system throughput while guaranteeing the SIR of both CUEs and DUEs.
Despite all this, most of the above-mentioned literatures mainly considered
a relatively simple system model (e.g. comprising only a single CUE as well
as D2D pair), in which the licensed spectrum of the objective CUE can be
reused by at most one D2D pair. In this paper, resource allocation in D2D aided
heterogeneous cellular systems is investigated by proposing a heuristic resource
allocation algorithm for maximizing the number of simultaneously activated D2D
pairs. The main contributions of this paper are reﬂected as follows:
1. The main objective of this paper is to maximize the number of simultaneously
activated D2D pairs, while guaranteeing the minimum SIR of both CUEs
and DUEs. Furthermore, a framework of resource allocation for D2D aided
heterogeneous cellular systems is proposed, in which the licensed spectrum of
a single CUE is allowed to be reused by more than one D2D pair.

278
X. Wang et al.
2. Unlike [22], in the proposed system model, we assume that there exists an
interference limited area (ILA) either for BSs or for D2D receivers, inside
which the licensed spectrum is prohibited to be reused by DUEs.
3. By performing system-level simulations, it demonstrates that a signiﬁcant
performance improvement in terms of both the D2D access probability and
the overall network throughput can be obtained, while without signiﬁcantly
sacriﬁcing the performance of conventional CUEs.
The remainder of this paper is organized as follows. Section 2 gives out the
system model. The proposed resource allocation strategy is discussed in Sect. 3,
followed by evaluating the performance of the proposed algorithm using simula-
tions in Sect. 4. Finally, Sect. 5 concludes this paper.
2
System Model
In this section, system model for the proposed D2D aided heterogeneous net-
works is ﬁrst proposed, followed by analyzing the link SIR.
2.1
System Model for D2D Aided Heterogeneous Networks
In this paper, without loss of generality, licensed spectrum allocated to CUEs
is allowed to be fully reused by DUEs, in which scenario a total of Nc CUEs
are assumed to coexist with Nd D2D pairs. Meanwhile, multiple D2D pairs are
allowed to reuse the licensed spectrum of a single CUE. However, an orthogonal
spectrum is assumed to be allocated to an adjacent cell in order to avoid the inter-
cell interference, and a fully-loaded spectrum allocation scenario with uplink
resource sharing is considered in the proposed system model. Furthermore, To
mitigate the D2D-induced interference inside a given cellular coverage, a circle
guard zone, namely the ILA, is pre-set for both BSs and D2D receivers, inside
which area the licensed spectrum is not prohibited to be reused by DUEs. In the
following, the radius of the ILA is denoted by d.
2.2
SIR Analysis for Cellular and D2D Links
In this paper, without loss of generality, a typical Urban Micro (UMi) scenario is
considered in the proposed system model. The performance erosion is assumed
to be mainly induced by the impact of propagation and shadowing eﬀects of
wireless channels. Meanwhile, both the antenna gains of devices (i.e. including
both BSs and CUEs/DUEs) and the feeder loss are taken into account. For
convenience, we use C = {1, 2, ..., Nc} and D = {1, 2, ..., Nd} to denote the index
sets of active CUEs and candidate D2D pairs, respectively, with Nc and Nd
denoting the maximum number of CUEs and candidate D2D pairs, respectively.
Furthermore, φi ⊆D is used to denote the set of admitted D2D pairs (i.e. the
activated DUE pairs), which will reuse the spectrum allocated to the i-th CUE.
In addition, parameters Ci and Dj are used to denote the i-th CUE and j-th
D2D pair, respectively.

Adaptive Resource Allocation
279
The Received SIR of the typical CUE-BS (i.e., Ci-BS) and D2D (i.e., Dj)
links can be respectively represented as
γc
i =
P c
i gi,B
N0 + 
j∈φi
P d
j gj,B
,
(1a)
γd
j =
P d
j gj
N0 +

k∈φi\j
P d
k gk,j + P c
i gi,j
,
(1b)
where P c
i and P d
j stand for the transmit power of Ci and j-th D2D transmitter,
respectively. Without loss of generality, we assume that P c
i = P d
j = P0. Further-
more, gi,B denotes the channel gain between Ci and the corresponding BS, and
gj,B denotes the channel gain between the j-th D2D transmitter and the associ-
ated BS. Thus, gj can be used to denote the corresponding channel gain of Dj,
with gi,j standing for the channel gain between Ci and the j-th D2D receiver.
Finally, N0 is used to denote the power of thermal noise. The sum throughput
of the proposed D2D aided cellular systems can be expressed as
Rsum =

i∈C
⎛
⎝log (1 + γc
i ) +

j∈φi
log

1 + γd
j

⎞
⎠.
(2)
3
Resource Allocation Strategy for D2D Aided Cellular
Systems
It has been shown that the activated D2D links may impose a severe interference
on the CUEs and the interference induced by either CUEs or the geographically
close-by D2D transmitters may also signiﬁcantly erode the quality of a given
activated D2D link during the uplink transmission periods. To mitigate the D2D-
induced interference, a resource allocation strategy aiming at maximizing the
number of simultaneously activated D2D pairs is proposed. For convenience of
analysis, we can form a frequency reuse set comprising the objective CUE and
its co-spectrum DUEs, provided that the minimum QoS (or in other words,
minimum SIR) requirement of each user in this set can be guaranteed. Based
on the above-mentioned principle, a resource-allocation framework can thus be
formulated as:
P1:
max
φ1,φ2,...,φNc
TD
(3)
s.t.
TD =

i∈C
|φi|,
(3a)
TD ≤Nd,
(3b)

280
X. Wang et al.
γc
i ≥γc
min, ∀i ∈C,
(3c)
γd
j ≥γd
min, ∀j ∈D,
(3d)
φp ∩φq = ∅, ∀p, q ∈C&p ̸= q,
(3e)
dj,B > d, dt,j > d, ∀t ∈C||D \ j, ∀j ∈D,
(3f)
where TD denotes the total number of admitted D2D pairs in the whole system,
φi represents the set of admitted D2D pairs reusing the spectrum of Ci, γc
min
and γd
min stand for the minimum SIR requirement of Ci and Dj, respectively.
dj,B denotes the distance between j-th D2D transmitter and BS, dt,j denotes the
distance between interference transmitter (i.e. CUE or other D2D transmitter)
and j-th D2D receiver. Furthermore, (3e) ensures that any single D2D pair
can reuse the spectrum of one and only one CUE. In addition, (3f) is used to
limit the D2D-induced interference imposed on both BSs and D2D receivers (i.e.
corresponding to formulating the function of ILA).
According to (3c) and (3d), the maximum number of simultaneously acti-
vated D2D pairs can be expressed as
– when γc
i ≥γc
min, |φi| ⩽P c
i gi,B
γc
minIc
i −N0
Ic
i ,
– when γd
j ≥γd
min, |φi| ⩽
P d
j gj
γd
minId
j −N0
Id
j ,
thus
|φi| ≤min

P c
i gi,B
γc
minIc
i
−N0
Ic
i
, P d
j gj
γd
minId
j
−N0
Id
j

,
(4)
where Ic
i and Id
j denote the average interference (I) imposed on Ci and Dj
receivers, respectively. Since Ic
i = P d
j gj,B, and Id
j = Ptgt,j, t ∈C||D \ j, we
can identify the minimum-maximum value of |φi| when gj,B = gt,j = gmax,
corresponding to the highest average interference level. From the deﬁnition of
ILA, we can readily conclude that the maximum interference level may happen at
the ILA boundary of the typical receivers, in which case the distance between the
objective receivers and the interfering terminals would be very short. Therefore,
the minimum-maximum value of any spectrum reuse set associated with the
activated D2D pairs can be identiﬁed. When Ic
i = Id
j = Imax satisﬁes, the
minimum-maximum value can be expressed as
|φi| =

gi,B
γc
mingmax −
N0
P0gmax ,
gi,B
γc
min ⩽
gj
γd
min ,
gj
γd
mingmax −
N0
P0gmax ,
otherwise.
(5)
From (5), it is shown that the interference tolerance (IT)1 of CUE is smaller
than that of DUE, if gi,B
γc
min
⩽
gj
γd
min
is satisﬁed. Accordingly, the condition
1 In this paper, the IT of a user is deﬁned as ITk = |φk|I, where k = i, j.

Adaptive Resource Allocation
281
gi,B > γc
mingj,B can be adopted as a criterion for identifying the candidate
D2D pairs that can be activated in order to improve the D2D access ratio, while
guaranteeing the SIR requirements of both CUEs and DUEs. Similarly, we can
also employ the condition gj > γd
mingt,j as a criterion for improving the D2D
access ratio in the presence of gi,B
γc
min
>
gj
γd
min
.
In summary, the D2D pairs having a better channel gain (i.e. gj) will receive
a higher activating priority, and the D2D access probability can be maximized
by fully exploiting the channel gains of each candidate D2D pair, together with
the inter-D2D-interference considered, as expressed as

gi,B > γc
mingj,B,
gi,B
γc
min ⩽
gj
γd
min ,
gj > γd
mingt,j,
otherwise.
(6)
From the above-mentioned analysis, the optimal conditions/constraints for
improving the sum throughput of the proposed D2D aided cellular systems under
the criteria of maximizing the activated D2D pairs can be derived as follows.
Obviously, the sum throughput Rc in the traditional cellular network (i.e. with-
out considering D2D communications) can be expressed as
Rc =

i∈C
(log (1 + ξc
i )) ,
(7)
where ξc
i = P c
i gi,B
N0
. As compared to (4), the throughput gain brought about by
employing D2D mode can be expressed as
RG = Rsum −Rc
=

i∈C
⎛
⎜
⎝log
⎛
⎜
⎝
(1 + γc
i ) 
j∈φi

1 + γd
j

1 + ξc
i
⎞
⎟
⎠
⎞
⎟
⎠,
(8)
leading to
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
RG ≥
i∈C

log

 1+γc
i + 
j∈φi
γd
j
1+ξc
i

,
RG ≤
i∈C

log

Υ
1+ξc
i

,
(9)
where
Υ = 1+
⎛
⎝γc
i +

j∈φi
γd
j
⎞
⎠+C1
m−1
2
⎛
⎝γc
i +

j∈φi
γd
j
⎞
⎠
2
+···+Cm−1
m−1
m
⎛
⎝γc
i +

j∈φi
γd
j
⎞
⎠
m
,
(10)
with m denoting the size of spectrum reuse set. For conventional cellular systems,
as a benchmark, it is easy to derive Rsum = Rc. However, for D2D aided cellular
networks, it is shown that Rsum > Rc can be met if γc
i +

j∈φi
γd
j > ξc
i is satisﬁed.

282
X. Wang et al.
Evidently, the sum throughput of the proposed D2D aided cellular systems (i.e.
γc
i +

j∈φi
γd
j ) relying on the criteria of maximizing the number of simultaneously
activated D2D pairs.
To maximize the number of simultaneously activated D2D pairs, we can
readily make the following approximations, i.e. γc
i ≈γc
min and γd
j ≈γd
min, thus
leading to γc
i + 
j∈φi
γd
j = γc
min + 
j∈φi
γd
min. Without loss of generality, the max-
imum interference imposed on BS and D2D receivers can be denoted by Ic
max
and Id
max, respectively. For any Ci sharing its spectrum with D2D pairs and
inducing interferences Ic
i =

j∈φi
P d
j gj,B = Ic
max and Id
j =

t∈φi\j||Ci
Ptgt,j = Id
max,
the performance gain in terms of SIR can be expressed as
γG
i,j = γc
i +

j∈φi
γd
j −ξc
i
=
N0Δ1 + Ic
maxΔ2
(N0 + Idmax) (N0 + Icmax),
(11)
where
⎧
⎪
⎨
⎪
⎩
Δ1 = 
j∈φi
N0P0gj −Ic
maxP0gi,B,
Δ2 = 
j∈φi
N0P0gj −Id
maxP0gi,B,
(12)
Evidently, γG
i,j > 0 (i.e. RG
i,j > 0) holds if Δ1 > 0 and Δ2 > 0 are satisﬁed
simultaneously, thus leading to
N0gj > max

pd
jgj,Bgi,B, ptgt,jgi,B

,
(13)
Consequently, P1 can be heuristically rewritten as
P2:
max
φ1,φ2,...,φNc
TD
(14)
s.t.
(3a)−(3f),
gi,B > γc
mingj,B, if gi,B
γc
min
⩽
gj
γd
min
,
(14a)
gj > γd
mingt,j,
if gi,B
γc
min
>
gj
γd
min
,
(14b)
N0gj >

pd
jgj,Bgi,B, if gj,B > gt,j,
ptgt,jgi,B, if gj,B ≤gt,j,
(14c)
where i ∈C, j ∈D and t ∈C||D \ j.

Adaptive Resource Allocation
283
4
Numerical Analysis
In this section, numerical analysis for the proposed algorithm is performed rely-
ing on the proposed channel model to explore the attainable beneﬁts brought
about by the proposed algorithm. We consider a wrap-around system conﬁgura-
tion comprising 19 sites (i.e. each comprising 3 cells). Without loss of generality,
the minimum UE-to-BS distance is assumed to be 10 m, and the maximum dis-
tance between a pair of D2D peers is 50 m. In addition, the transmit power of BS
and CUEs assumed to be 42 dBm and 24 dBm, respectively. Finally, the noise
power spectrum density is assumed to be −174 dBm/Hz. The detailed parameter
settings, which come from the standard [23], are elaborated on in Table 1.
Table 1. Parameter settings of the proposed system-level simulation
Parameters
Settings
Scenario environment
UMi
System bandwidth
10 MHz (TDD)
Carrier frequency
2.5 GHz
The min-distance of UE to BS 10 m
Antenna model of Macro BS
A(θ) = −min

12(
θ
θ3 dB )2, Am

Ae(φ) = −min

12( φ−φtilt
φ3 dB )2, Am

−min [−(A(θ) + Ae(φ)), Am]
Am = 20 dB
θ3 dB = 70, φtilt = 15
−180 ≤θ ≤180, −90 ≤φ ≤90
Antenna model of UE
Omnidirectional
Traﬃc pattern
Full buﬀer
BS height
10 m
UE height
1.5 m
BSNoiseFigure
5 dB
UENoiseFigure
7 dB
BS transmit power
42 dBm
UE transmit power
24 dBm
Power level of thermal noise
−174 dBm/Hz
In Fig. 1, the performance of random spectrum allocation and proposed
resource allocation algorithms in terms of the maximum number of simulta-
neously activated D2D pairs is performed by considering variant η values, with
a single CUE considered. It is shown that the number of simultaneously acti-
vated D2D pairs decreases as η increases, because the interference tolerance of
CUE decreases as the SIR threshold increases, thus requiring fewer D2D pairs
to be activated simultaneously so as to impose a lower interference on CUE

284
X. Wang et al.
(i.e. to guarantee the minimum SIR requirement of the CUE). Anyway, the pro-
posed algorithm is shown to always outperform the conventional random spec-
trum allocation scheme in terms of throughput, because the former is capable of
coordinating the interference between CUEs and D2D pairs and optimizing the
spectrum reuse set adaptively according to the instantaneous channel condition.
In Fig. 2, the impacts of ILA radius and CUE-SIR threshold on the number of
simultaneously activated D2D pairs in a single-cellular scenario is investigated. It
is shown that the access probability of the proposed algorithm is a monotonically
decreasing function of η, because the interference tolerance of DUEs decreases
as η increases. Meanwhile, it is also shown that the performance of proposed
algorithm increases ﬁrst, and then decreases as d increases. We can explain this
observation as follows: when ILA radius is small, the interference imposed on
signal receiver from one interference transmitter is more intensive compared with
signal receiver power when the distance of interference link is bigger than D2D
links. But when ILA radius is beyond the distance of D2D links, the probability
of candidate D2D pairs access to network declines with the increase of d, as a
result, the admitted D2D pairs decreases.
Figure 3 demonstrates the impact of ILA on the throughput as a function of
η. Evidently, the throughput is a monotonically decreasing function of η, because
the number of simultaneously activated D2D pairs decreases as the SIR threshold
increases. Meanwhile, the performance of the proposed algorithm is also shown to
increase ﬁrstly, and then decreases as d increases. This is because the interference
is much more intensive when d < 50 (i.e. the maximum allowable distance of
D2D links) compared with receiver signal power, and fewer D2D pairs can access
to the network while guaranteeing the requirement of ILA radius, if ILA radius is
beyond the distance of D2D links. Consequently, the sum throughput decreases.
0
1
2
3
4
5
6
7
8
9
10
11
0.4
0.5
0.6
0.7
0.8
0.9
1
D2DNum
Cumulative Distribution Function
 
 
Random Allocation,  η=10
Random Allocation,  η=20
Random Allocation,  η=30
Random Allocation,  η=40
Random Allocation,  η=50
Random Allocation,  η=60
Proposed,  η=10
Proposed,  η=20
Proposed,  η=30
Proposed,  η=40
Proposed,  η=50
Proposed,  η=60
Fig. 1. Performance comparison of the proposed algorithm and the conventional ran-
dom spectrum allocation scheme in terms of the maximum number of simultaneously
activated D2D pairs for variant SIR thresholds, with a single CUE considered, where
Nc = 50, Nd = 300 and d = 50.

Adaptive Resource Allocation
285
10
15
20
25
30
35
40
45
50
55
60
0
10
20
30
40
50
60
70
80
90
100
 The Qos Requirement Of CUE (dB)
Number Of Simultaneously Activated D2D Pairs
 
 
Random Allocation
Proposed,  d=1
Proposed,  d=50
Proposed,  d=100
Proposed,  d=150
Proposed,  d=200
Proposed,  d=250
Proposed,  d=300
Fig. 2. The maximum number of simultaneously activated D2D pairs in the proposed
system under diﬀerent settings of SIR threshold, with a BS, where Nc = 50, Nd = 300.
10
15
20
25
30
35
40
45
50
55
60
500
600
700
800
900
1000
1100
1200
1300
 The Qos Requirement Of CUE (dB)
The Throughput  Gain (bit/s)
 
 
Random Allocation
Proposed,  d=1
Proposed,  d=50
Proposed,  d=100
Proposed,  d=150
Proposed,  d=200
Proposed,  d=250
Proposed,  d=300
Fig. 3. Performance comparison of the proposed algorithm and the conventional ran-
dom spectrum allocation scheme in terms of the sum throughput gain for variant radius
of ILA, where Nc = 50 and Nd = 300.
5
Conclusions
In this paper, the problem of adaptive spectrum allocation was formulated as
the maximization of the number of simultaneously activated D2D pairs in sce-
nario of D2D reusing the uplink licensed spectrum, with a fully loaded cellular
network considered. To maximize the number of simultaneously activated D2D
pairs without eroding the SIRs of both CUEs and DUEs, a greedy heuristic
algorithm was also implemented for ﬁnding the objective spectrum-reuse set.
Numerical results showed that the proposed algorithm is capable of improving

286
X. Wang et al.
both the D2D-access probability and the sum throughput of the whole system.
It was shown that the proposed algorithm is capable of increasing the admitted
D2D pairs and sum throughput by about 800% and 80% as compared to the
conventional random spectrum allocation algorithm when η=20 dB and d = 50.
Acknowledgement. This work was supported by the key project of the National Nat-
ural Science Foundation of China (No. 61431001), the open research fund of National
Mobile Communications Research LaboratorySoutheast University (No. 2017D02), Key
Laboratory of Cognitive Radio and Information Processing, Ministry of Education
(Guilin University of Electronic Technology), and the Foundation of Beijing Engineer-
ing and Technology Center for Convergence Networks and Ubiquitous Services.
References
1. Zhang, Z., Long, K., Wang, J., Dressler, F.: On swarm intelligence inspired self-
organized networking: its bionic mechanisms, designing principles and optimization
approaches. IEEE Commun. Surv. Tutor. 16(1), 513–537 (2014)
2. Zhang, Z., Long, K., Wang, J.: Self-organization paradigms and optimization
approaches for cognitive radio technologies: a survey. IEEE Wirel. Commun. Mag.
20(2), 36–42 (2013)
3. Dahlman, E., Parkvall, S., Skold, J.: 4G: LTE/LTE-Advanced for Mobile Broad-
band. Academic Press, Oxford (2013)
4. Zhang, Z., Chai, X., Long, K., Vasilakos, A.V., Hanzo, L.: Full duplex techniques
for 5G networks: self-interference cancellation, protocol design, and relay selection.
IEEE Commun. Mag. 53(5), 128–137 (2015)
5. Zhang, Z., Long, K., Vasilakos, A.V., Hanzo, L.: Full-duplex wireless communi-
cations: challenges, solutions and future research directions. Proc. IEEE 104(7),
1369–1409 (2016)
6. Wang, G., Liu, Q., He, R., Gao, F., Tellambura, C.: Acquisition of channel state
information in heterogeneous cloud radio access networks: challenges and research
directions. IEEE Wirel. Commun. 22(3), 100–107 (2015)
7. Xiao, H., Ouyang, S.: Power allocation for a hybrid decodeamplify forward cooper-
ative communication system with two sourcedestination pairs under outage prob-
ability constraint. IEEE Syst. J. 9(3), 797–804 (2015)
8. Wang, G., Gao, F., Tellambura, C.: Ambient backscatter communication systems:
detection and performance analysis. IEEE Trans. Commun. 64, 4836–4846 (2016)
9. Zhang, H., Jiang, C., Mao, X., Chen, H.-H.: Interference-limit resource optimiza-
tion in cognitive femtocells with fairness and imperfect spectrum sensing. IEEE
Trans. Veh. Technol. 65(3), 1761–1771 (2016)
10. Jnis, P., Yu, C.-H., Doppler, K., Ribeiro, C., Wijting, C., Hugl, K., Tirkkonen,
O., Koivunen, V.: Device-to-device communication underlaying cellular communi-
cations systems. Int. J. Commun. Netw. Syst. Sci. 2(3), 169 (2009)
11. Zhang, G., Yang, K., Liu, P., Du, Y.: Using full duplex relaying in device-to-device
(D2D) based wireless multicast services: a two-user case. Sci. Chin. Inf. Sci. 58(8),
1–7 (2015)
12. Ferrus, R., Sallent, O., Baldini, G., Goratti, L.: Lte: the technology driver for future
public safety communications. IEEE Commun. Mag. 51(10), 154–161 (2013)
13. Zhang, G., Liu, P., Yang, K., Du, Y., Hu, Y.: Orthogonal resource sharing scheme
for device-to-device communication overlaying cellular networks: a cooperative
relay based approach. Sci. China Inf. Sci. 58(10), 1–9 (2015)

Adaptive Resource Allocation
287
14. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allo-
cation in spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE
Trans. Commun. 62(7), 2366–2377 (2014)
15. Chai, X., Liu, T., Xing, C., Xiao, H., Zhang, Z.: Throughput improvement in
cellular networks via full-duplex based device-to- device communications. IEEE
Access 4, 7645–7657 (2016)
16. Sun, J., Liu, T., Wang, X., Xing, C., Xiao, H., Vasilakos, A.V., Zhang, Z.: Optimal
mode selection with uplink data rate maximization for D2D-aided underlaying
cellular networks. IEEE Access 4, 8844–8856 (2016)
17. Yu, C.-H., Tirkkonen, O., Doppler, K., Ribeiro, C.: Power optimization of device-
to-device communication underlaying cellular communication. In: 2009 IEEE Inter-
national Conference on Communications, pp. 1–5. IEEE (2009)
18. Fodor, G., Reider, N.: A distributed power control scheme for cellular network
assisted D2D communications. In: 2011 IEEE Global Telecommunications Confer-
ence (GLOBECOM 2011), pp. 1–6. IEEE (2011)
19. Janis, P., Koivunen, V., Ribeiro, C., Korhonen, J., Doppler, K., Hugl, K.,
Interference-aware resource allocation for device-to-device radio under- laying cel-
lular networks. In: IEEE 69th Vehicular Technology Conference: VTC Spring 2009,
pp. 1–5. IEEE (2009)
20. Jiang, Y., Liu, Q., Zheng, F., Gao, X., You, X.: Energy eﬃcient joint resource
allocation and power control for D2D communications (2016)
21. Yu, G., Xu, L., Feng, D., Yin, R., Li, G.Y., Jiang, Y.: Joint mode selection and
resource allocation for device-to-device communications. IEEE Trans. Commun.
62(11), 3814–3824 (2014)
22. Min, H., Lee, J., Park, S., Hong, D.: Capacity enhancement using an interference
limited area for device-to-device uplink underlaying cellular networks. IEEE Trans.
Wirel. Commun. 10(12), 3995–4000 (2011)
23. M Series: Guidelines for evaluation of radio interface technologies for IMT-
advanced (2009)

A Utility-Based Resource Allocation
in Virtualized Cloud Radio Access Network
Linna Chen(B), Chunjing Hu, Yong Li, and Wenbo Wang
Wireless Signal Processing and Network Laboratory,
Key Laboratory of Universal Wireless Communications, Ministry of Education,
Beijing University of Posts and Telecommunications, Beijing 100876, China
chenlinna@bupt.edu.cn
Abstract. Network slicing is an emerging paradigm for 5G networks.
Network slices are considered as diﬀerent and independent virtualized
end-to-end networks on a common physical infrastructure. Wireless
resource virtualization is the key enabler to achieve high resource eﬃ-
ciency and meanwhile to isolate network slices from one another. In this
paper, we propose a slice-speciﬁc utility-based resource allocation scheme
in cloud radio access networks, where two sets of slices with diﬀerent
requirements are supported simultaneously. Every slice can determine
its preference factor in utility function considering the trade-oﬀbetween
bandwidth gain and energy consumption. The objective is to maximize
the sum utility of all slices taking the trade-oﬀof all slices into account,
which can be formulated as a mixed binary integer nonlinear program-
ming problem. The Lagrange dual method is applied to solve the joint
optimization problem. Finally, The performance of the proposed scheme
is evaluated and the results show that the proposed scheme can meet
diﬀerent customized requirements of all slices, and enhance system per-
formance when compared with other methods.
Keywords: Network slicing · Virtualization · Utility · Trade-oﬀ
1
Introduction
With rapid increase of traﬃc volumes and demand for a variety of services, the
traditional one-size-ﬁts-all network architecture is hard to adapt to the require-
ments of emerging use cases and changing subscriber demands. Network slicing
is an emerging paradigm for 5G networks, which will enable operators to provide
networks on an as-a-service basis and meet the wide range of use cases that the
2020 timeframe will demand. Each service provider (SP) can require its own
logical network slice to support speciﬁc subscriber types and varying application
usages on a shared physical infrastructure. In order to handle multiple slices in
a robust way, radio access networks (RANs) shall provide radio resource man-
agement to eﬃciently multiplex traﬃcs from multiple users in diﬀerent network
slice instances onto the available shared radio resources.
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 288–299, 2018.
https://doi.org/10.1007/978-3-319-72823-0_28

Resource Allocation in Virtualized CRAN
289
Wireless network virtualization is an eﬀective means by which an infrastruc-
ture provider can partition the wireless and physical resources among SPs so that
they can serve their subscribers, which facilitates new business models. Due to
resource and infrastructure sharing, wireless network virtualization can reduce
capital expenditure and operational expenditure, which leads to potential energy
and capital savings [1]. Moreover, wireless network virtualization contributes to
better resource utilization due to less unused resource.
The problem of wireless virtualization in LTE is addressed in many papers.
The authors in [2] proposed a slicing scheme to allocate physical resources of
LTE system to diﬀerent SPs, in which fairness requirements of diﬀerent SPs
were considered. In [3], a centralized heuristic to allocate radio resource blocks
in multi-cell LTE networks was proposed, which aimed to maximize the sum rate
of the network. In [4,5], a resource allocation scheme was proposed by introduc-
ing two types of slices, including rate-based slices and resource-based slices. In
[6], the authors introduced an idea of wireless virtualization into full-duplex
relaying networks and proposed a virtual resource management architecture for
virtualized networks. However, the wireless virtualization in cloud RAN (CRAN)
has not been discussed adequately.
In this paper, we consider the joint subcarrier and power allocation problem
in a CRAN downlink system, where two sets of slices with diﬀerent requirements
are supported simultaneously. Our main contribution is to introduce a slice-
speciﬁc utility-based resource allocation scheme. The scheme aims at maximizing
the sum utility of all slices under the service level agreement (SLA) and QoS
requirement constrains, in which the speciﬁc preference requirements of diﬀerent
slices are considered. Every slice can determine a customized weighing factor
in its utility function considering the trade-oﬀbetween spectral eﬃciency and
energy eﬃciency. The proposed allocation algorithm will take the preference
requirements of all slices into account when assigning the subcarriers and power
between diﬀerent slices.
The rest of this paper is organized as follows. First, we present a description
of the system model and the problem formulation in Sect. 2. The approach to
solve the optimal problem is presented in Sect. 3. The simulation results and
their discussions are given in Sect. 4. Finally, we conclude this paper in Sect. 5.
2
System Model and Problem Formulation
We consider the downlink of the CRAN architecture, where the coverage of a
certain geographical area is provided by a cluster of RRHs, as illustrated in
Fig. 1.
2.1
OFDMA-Based Wireless Transmission
We assume that OFDMA is used for downlink transmission. The total channel
bandwidth is B Hz and is divided into N orthogonal subcarriers, thus the band-
width of each subcarrier is B/N. The system consists of G slices, where each

290
L. Chen et al.
Fig. 1. System model.
slice g provides its service to Kg users, and each user is cooperatively served by
its serving cluster of R RRHs.
Each RRH has a total transmit power of Pj,max and let pi,j,n denote the
power allocated to user i on subcarrier n at RRH j. The bandwidth of each
subcarrier is assumed to be small compared with the coherent bandwidth of
the wireless channel. Therefore, hi,j,n is the channel gain of the wireless link
between RRH j and user i on subcarrier n which can be considered ﬂat. Then
the baseband complex symbol yi,n received by user i at subcarrier n can be
expressed as
yi,n =
R

j=1
hi,j,nwi,j,n√pi,j,nsi,n + zi,n,
(1)
where si,n ∼CN(0, 1) is the signal transmitted to UE i at subcarrier n, and
wi,j,n =
h∗
i,j,n
|hi,j,n| denotes the complex precoding symbol, by which the phases of
transmission signals from diﬀerent RRHs could be rotated into the same direction
as the phase of the initial transmission signal. Also zi,n ∼CN(0, σ2) denotes the
received additive white Gaussian noise (AWGN), where σ2 is the noise variance.
Let Ri,n denote the transmission rate of user i on subcarrier n, which can be
calculated as
Ri,n = log2

1 +
| R
j=1 hi,j,nwi,j,n√pi,j,n|2
σ2

= log2

1 +
| R
j=1(|hi,j,n|√pi,j,n)|2
σ2

.
(2)
2.2
Problem Formulation
The system provides services for two speciﬁc sets of slices: (1) One set with
speciﬁc QoS requirements, the slice g in this set requires a minimum reserved

Resource Allocation in Virtualized CRAN
291
rate Rg,min, g = 1, 2, . . . G1; (2) The other set without QoS requirements, the
traﬃc of slice g can be delivered in a best-eﬀort manner, g = G1 + 1, . . . G.
Meanwhile, each slice must be assigned with a minimum amount of resources to
guarantee the SLA, which can ensure isolation between slices to a certain extent.
For example, when a slice is overloaded, the other slices could still obtain its
certain amount of resources.
In this paper, a slice-speciﬁc utility-based resource allocation is proposed.
Utility function varies across slices with diﬀerent requirements considering the
trade-oﬀbetween the gain on throughput and the cost on power consumption,
where εg denotes the preference coeﬃcient. The preference coeﬃcient reﬂects
the speciﬁc need of the individual slice toward the above two types of aspects
in the process of resource allocation. For example, with a higher εg, the slice
needs to pay a higher cost for the allocated power, which means that the slice
prefers to minimize the power consumption. Otherwise, the slice may be less
concerned on power consumption but more concerned on the throughput gain.
The scheduling policy would consider the preferences of all slices to allocate the
resources between diﬀerent slices properly. Let xi,n ∈{0, 1} denote the subcarrier
allocation binary variable, where xi,n = 1 indicates that subcarrier n is assigned
to user i, and otherwise xi,n = 0. Thus the utility function of slice g is deﬁned
as follows
Ug =
Kg

i=1
N

n=1
xi,nRi,n −εg
R

j=1
Kg

i=1
N

n=1
xi,npi,j,n.
(3)
Therefore the problem we considered is to optimize the allocation of subcar-
riers and power jointly so as to maximize the total utility of all slices subject to
the physical limitations and SLA of slices, which can be formulated as
max
x,p
G

g=1
Ug
s.t.
C1 :
G

g=1
Kg

i=1
xi,n ≤1,∀n,
C2 :
G

g=1
Kg

i=1
N

n=1
xi,npi,j,n ≤Pj,max,∀j,
C3 :
Kg

i=1
N

n=1
xi,nRi,n ≥Rg,min,∀g = 1, 2 . . . G1,
C4 :
Kg

i=1
N

n=1
xi,n ≥Nρg,min,∀g = 1, 2 . . . G,
(4)
where C1 represents the exclusive orthogonal constraint which ensures that each
subcarrier is allowed to be assigned to one user at most, and C2 is the individual

292
L. Chen et al.
power constraint of each RRH, and C3 represents the minimum required rate
of each slice g in the set with QoS requirements, and C4 ensures the isolation
between slices such that each slice can access at least a certain number of sub-
carriers to guarantee its SLA, where ρg,min denotes the contracted minimum
portion of resources assigned to slice g, ρg,min ∈[0, 1],∀g and G
g=1 ρg,min ≤1.
3
Problem Solution and Allocation Algorithm
3.1
Problem Solution
The objective function in (4) with its constraints can be classiﬁed as a mixed
binary integer nonlinear programming problem, with the decision variables xi,n
and pi,j,n being binary variable and continuous variable, respectively. The com-
plexity of solving this problem is high, so we will propose an approach to make
the problem tractable using the dual decomposition method, similar to the tech-
niques used in [7–9]. Consequently, the Lagrange function of the above optimiza-
tion problem is given by
L(x, p, λ, μ, ν, u) =
G

g=1
⎡
⎣
Kg

i=1
N

n=1
xi,nRi,n−εg
R

j=1
Kg

i=1
N

n=1
xi,npi,j,n
⎤
⎦
+
N

n=1
λn(1 −
G

g=1
Kg

i=1
xi,n)
+
R

j=1
μj(Pj,max −
G

g=1
Kg

i=1
N

n=1
xi,npi,j,n)
+
G

g=1
νg(
Kg

i=1
N

n=1
xi,nRi,n −Rg,min)
+
G

g=1
ug(
Kg

i=1
N

n=1
xi,n −Nρg,min),
(5)
where λ = (λ1, . . . , λN), μ = (μ1, . . . , μR), ν = (ν1, . . . , νG), u = (u1, . . . , uG)
are the non-negative Lagrange multipliers for the constraints C1 - C4, respec-
tively, and νg = νg when 1 ≤g ≤G1, or νg = 0 when G1 < g ≤G. Herein, we
can give the dual objective function as
g(λ, μ, ν, u) = max
x,p L(x, p, λ, μ, ν, u).
(6)
The dual optimization problem is then formulated as
min
λ,μ,ν,u g(λ, μ, ν, u)
s.t. λ ⪰0, μ ⪰0, ν ⪰0, u ⪰0.
(7)

Resource Allocation in Virtualized CRAN
293
To solve the dual problem, we can re-express the dual objective function as
g(λ, μ, ν, u) =
N

n=1
gn(λ, μ, ν, u)+
N

n=1
λn+
R

j=1
μgPj,max
−
G

g=1
νgRg,min−
G

g=1
ugNρg,min,
(8)
where
gn(λ, μ, ν, u) = max
x,p
⎡
⎣
G

g=1
Kg

i=1
xi,ngi,n(λ, μ, ν, u)
⎤
⎦,
(9)
gi,n(λ, μ, ν, u) = Ri,n−εg
R

j=1
pi,j,n−λn−
R

j=1
μjpi,j,n+νgRi,n+ug.
(10)
We have decomposed the dual function into the above N independent opti-
mization sub-problems given by (9). By evaluating the Hessian matrix of Ri,n
at pi,j,n in (2), we can prove that the function in (2) is concave. Thus, the func-
tion in (10) is concave as any positive linear combination of concave functions is
concave. Suppose subcarrier n is assigned to user i, the optimal p∗
i,j,n that max-
imizes the object function in (10) for ﬁxed Lagrange multipliers can be easily
obtained. Then by comparing all possible user assignments of this subcarrier, we
select user i for which gi,n(λ, μ, ν, u) is maximized, and allocate subcarrier n to
that user. The allocation of all N subcarriers can be obtained in the same way.
Once the optimal x∗, p∗are obtained, we can use them to solve the dual prob-
lem in (7) to ﬁnd the optimal values of dual variables. Note that the Lagrange
function L(x, p, λ, μ, ν, u) is linear in λ, μ, ν, u for ﬁxed x∗and p∗, and
g(λ, μ, ν, u) is the maximum of these linear functions, so the dual problem in
(7) is convex. With the help of the sub-gradient method, we can ﬁnd the optimal
values of dual variables, which can be given by
μt+1
j
=
⎡
⎣μt
j −δj(Pj,max −
G

g=1
Kg

i=1
N

n=1
x∗
i,np∗
i,j,n)
⎤
⎦
+
,
(11)
νt+1
g
=
⎡
⎣νt
g −ξg(
Kg

i=1
N

n=1
x∗
i,nR∗
i,n −Rg,min)
⎤
⎦
+
,
(12)
ut+1
g
=
⎡
⎣ut
g −ζg(
Kg

i=1
N

n=1
x∗
i,n −Nρg,min)
⎤
⎦
+
,
(13)
where δj, ξg and ζg are the appropriate small step sizes to guarantee the con-
vergence of the sub-gradient method. The iteration process will be stopped until
certain criterion is fulﬁlled.

294
L. Chen et al.
3.2
An Iterative Algorithm
The optimization problem is typically required to be decomposed into N sub-
problems to reduce its complexity. After obtaining the optimal dual variables
that minimize the dual function, it remains to ﬁnd the optimal primal solutions
x∗, p∗that maximize the Lagrangian function and satisfy all constraints in the
original problem (4). The ﬁnal optimal solution would be achieved in such an
iterative manner. Our proposed algorithm is proposed as follows:
1. Initialize the optimal variables x0, p0 and the dual variables λ0, μ0, ν0, u0.
2. For each iteration t, solve the N sub-problems in the following steps:
(a) For the given dual variables, compute the optimal p∗
i,j,n that maximizes
the object function in (10).
(b) Update the optimal g∗
i,n for every user i.
(c) Select k = arg max g∗
i,n(λ, μ, ν, u), and set xk,n = 1, otherwise xi,n = 0,
for i ̸= k.
(d) Once the assignment problems are solved for all N subcarriers, the opti-
mal variables x∗, p∗can be obtained.
3. Update the λt+1, μt+1, νt+1, ut+1 using the obtained x∗and p∗and let
t = t + 1.
4. Continue to the next iteration in step (2) until convergence or the maximum
iteration number tmax is reached.
3.3
Complexity of the Algorithm
The optimal solution to (10) can be obtained by using global searching, assuming
that each pi,j,n takes discrete values and requires O(X) computational complex-
ity. Thus, the optimal power allocation solution requires O(XR) computational
complexity. For the given dual variables, the complexity of updating x in each
iteration is O(NGKgXR). Let L be the number of iterations needed to converge
in the sub-gradient method. Therefore the total computation complexity of the
proposed algorithm is O(LNGKgXR).
4
Numerical Results
4.1
System Setup
In this section, the performance evaluation for the proposed allocation algorithm
is presented. There are 3 RRHs considered to cover a certain geographical area.
Without loss of generality, the channels of diﬀerent subcarriers are assumed to
be independent of one another, which are taken from i.i.d. complex Gaussian
random variables with zero mean and unit variance, and the noise variance is
given as σ2 = 0.1. The number of subcarriers is taken as 32. We assume that
the system consists of two slices, each of which serves 10 subscribers. One slice
(Slice 1) has QoS requirement that needs a minimum rate of 120 bit/Hz, and the
other one (Slice 2) has no QoS requirement. Meanwhile, the contracted minimum

Resource Allocation in Virtualized CRAN
295
resources of each slice is given as ρg,min = 0.25. For comparison, we use two base-
line schemes. The ﬁrst scheme is equal power allocation (EPA) algorithm where
the total power is shared equally among subcarriers, and the second scheme
is static sharing (SS) scheme, which statically assigns ﬁxed subcarriers to each
slice.
4.2
Results and Discussion
In Fig. 2, we present the total achievable system throughput of the proposed
scheme, EPA scheme and SS scheme, respectively. In this case, the preference
coeﬃcient εg is set to zero for each slice, which means that both slices would like
to maximize the bandwidth gain no matter how much power is consumed. We
can see that, the maximum achievable throughput of all three schemes increases
monotonically with Pmax, and our proposed scheme outperforms all the other
schemes. SS scheme oﬀers the lowest throughput since users of each slice can
only access their dedicated subcarriers, and have no chance to use underutilized
resources that belong to other slice. Figure 3 depicts the impact of diﬀerent QoS
constraints of Slice 1 on sum utility of the system. In this case, the preference
factors are set as ε1 = 0.6 for Slice 1, and ε2 = 0.2 for Slice 2. The results show
that the sum utility decreases as the rate constraint of Slice 1 increases. This is
because, by increasing Rmin, more transmit power should be consumed to satisfy
the QoS constraints. And the allocated subcarriers for users with best channel
conditions in Slice 2 decreases when the Qos requirement of Slice 1 increases
which leads to ineﬃcient use of the resources hence lowering the sum utility.
Thus the system can hold the strict rate constraint at the cost of sum utility.
In addition, at the same Rmin, the utility of the proposed scheme is larger than
that of EPA scheme since our proposed scheme is a joint subcarrier and power
allocation algorithm but EPA scheme is not.
10
20
30
40
50
60
70
80
90
100
180
200
220
240
260
280
300
Pmax(watts)
Throughput(bps/Hz)
Proposed
SS
EPA
Fig. 2. Throughput of the system versus maximum transmit power Pmax.

296
L. Chen et al.
120
130
140
150
160
170
190
192
194
196
198
200
202
204
206
208
210
Rmin (bit/Hz)
utility
Proposed
EPA
Fig. 3. The total utility of the system versus QoS constrain of Slice 1 Rmin.
10
20
30
40
50
60
70
80
90
100
100
120
140
160
180
200
220
240
Pmax(Watts)
Total Utility
Proposed−0.2
Proposed−0.6
Proposed−1.2
EPA−0.2
EPA−0.6
EPA−1.2
Fig. 4. Total utility versus Pmax with diﬀerent factor of Slice 1.
Figure 4 illustrates the impact of the maximum transmit power of each RRH
on sum utility of the system. The preference coeﬃcient of Slice 2 is given by ε2 =
0.2, while Slice 1 has three coeﬃcient sets, ε1 = 0.2, ε1 = 0.6 and ε1 = 1.2 for
comparison. It can be noticed that the proposed scheme has better performance
than the EPA scheme in all three cases, and the system utility of a higher ε1
is worse than that of a lower ε1, since a higher ε1 means that Slice 1 must pay
much more for the power allocated in order to achieve the same throughput
constraint. Further, we can see that, When the transmit power is relatively
low, the maximum achievable utility increases monotonically with the increasing
power in all schemes. The optimal utility can be achieved with a high power

Resource Allocation in Virtualized CRAN
297
constraint Pmax. In this case, the achievable utility of the proposed scheme
no longer increases with the constraint Pmax as no more power is consumed.
However, the EPA scheme continues to allocate more power in the high Pmax
region, resulting in the system utility dropping dramatically, especially when
the preference coeﬃcient is higher. This is because, the system utility has a
diminishing return with respect to the increase of the transmit power, higher
power consumption counteracts the throughput gain.
To study the impact of diﬀerent preference coeﬃcients to the slice perfor-
mance, we take “bit/Hz/Joule” as the metric for EE [10], and EE is deﬁned
as Rg
Pg where Rg denotes the achieved throughput of the slice g, Pg denotes its
consumed power. In this case, the preference factor of Slice 2 is ﬁxed as ε2 = 0.2,
while the factor of Slice 1 has three options: ε1 = 0.2, ε1 = 0.6 or ε1 = 1.2. From
Fig. 5, we can observe that the higher ε1 leads to higher slice-EE of Slice 1.
This is because the higher ε1 means that Slice 1 prefers to achieve the similar
throughput in a more energy-eﬃcient way, which can also easily explain why the
EE of Slice 1 is much higher than that of Slice 2. In addition, it can be observed
in Fig. 6 that the EE of Slice 2 is lower when the preference factor of Slice 1
is higher. Because Slice 1 is more concerned on power consumption than Slice
2 in such case, and the scheduling policy will consider the preference of both
slices when allocating resources between slices in order to maximize the utility
of whole system. Therefore the resource allocation is energy-eﬃcient to Slice 1,
while it may be opposite from the perspective of Slice 2. However, the two slices
can only achieve very similar slice-EE in EPA scheme regardless of the prefer-
ence coeﬃcients they chose in their utility function, since the power allocation is
unchanged in this scheme. Finally, Our proposed scheme can satisfy the diﬀerent
requirements of slices according to their trade-oﬀbetween throughput gain and
power consumption, which can achieve better system performance.
10
20
30
40
50
60
70
80
90
100
0
1
2
3
4
5
6
7
8
Pmax(Watts)
EE(bit/Hz/J)
Proposed−0.2
Proposed−0.6
Proposed−1.2
EPA−0.2
EPA−0.6
EPA−1.2
Fig. 5. EE of Slice 1 versus Pmax for diﬀerent factor of Slice 1.

298
L. Chen et al.
10
20
30
40
50
60
70
80
90
100
0
1
2
3
4
5
6
7
Pmax(Watts)
EE(bit/Hz/J)
Proposed−0.2
Proposed−0.6
Proposed−1.2
EPA−0.2
EPA−0.6
EPA−1.2
Fig. 6. EE of Slice 2 versus Pmax for diﬀerent factor of Slice 1.
5
Conclusions
In this paper, we studied slice-speciﬁc utility-based resource allocation in
CRANs. In the proposed resource allocation algorithm, each slice has a cus-
tomized utility function taking their speciﬁc trade-oﬀbetween spectral eﬃciency
and energy eﬃciency into account. The objective function is to maximize the sum
utility of all slices through joint subcarriers and power allocation under diﬀerent
QoS requirement constraints of slices. Numerical results demonstrated that the
proposed algorithm signiﬁcantly outperforms other candidates, which can satisfy
the customized preference of slices in terms of throughput gain and power cost.
Acknowledgement. The authors would like to thank DOCOMO Beijing Communi-
cations Laboratories Co., Ltd. for their support in this work. This work was supported
in part by the National High Technology Research and Development Program (863
Program) of China under Grant No. 2014AA01A707.
References
1. Kalil, M., Shami, A., Ye, Y.: Wireless resources virtualization in LTE systems. In:
Proceedings of IEEE INFOCOM Workshops 2014, Toronto, Ontario, Canada, pp.
363–368, April 2014
2. Kamel, M.I., Le, L.B., Girard, A.: LTE wireless network virtualization: dynamic
slicing via ﬂexible scheduling. In: Proceedings of IEEE VTC Fall 2014, Vancouver,
British Columbia, Canada, pp. 1–5, September 2014
3. Kamel, M.I., Le, L.B., Girard, A.: LTE multi-cell dynamic resource allocation
for wireless network virtualization. In: Proceedings of IEEE WCNC 2015, New
Orleans, Louisiana, USA, pp. 966–971, March 2015

Resource Allocation in Virtualized CRAN
299
4. Kokku, R., Mahindra, R., Zhang, H., Rangarajan, S.: NVS: a substrate for vir-
tualizing wireless resources in cellular networks. IEEE/ACM Trans. Netw. 20(5),
1333–1346 (2012)
5. Parsaeefard, S., Jumba, V., Derakhshani, M., Le-Ngoc, T.: Joint resource provi-
sioning and admission control in wireless virtualized networks. In: Proceedings of
IEEE WCNC 2015, New Orleans, Louisiana, USA, pp. 2020–2025, March 2015
6. Liu, G., Yu, F.R., Ji, H., Leung, V.C.M.: Distributed resource allocation in virtu-
alized full-duplex relaying networks. IEEE Trans. Veh. Technol. 65(10), 8444–8460
(2016)
7. Palomar, D.P., Chiang, M.: A tutorial on decomposition methods for network util-
ity maximization. IEEE J. Sel. Areas Commun. 24(8), 1439–1451 (2006)
8. Yu, W., Lui, R.: Dual methods for nonconvex spectrum optimization of multicarrier
systems. IEEE Trans. Commun. 54(7), 1310–1322 (2006)
9. Palomar, D.P., Chiang, M.: Alternative decompositions for distributed maximiza-
tion of network utility: framework and applications. In: Proceedings of IEEE INFO-
COM 2006, Barcelona, Spain, pp. 1–13, April 2006
10. Zou, J., Xi, Q., Zhang, Q., He, C., Jiang, L., Ding, J.: QoS-aware energy-eﬃcient
radio resource allocation in heterogeneous wireless networks. In: Proceedings of
IEEE ICCW 2015, London, UK, pp. 2781–2786, June 2015

Iterative Receiver with Gaussian and Mean-Field
Approximation in Massive MIMO Systems
Sheng Wu1, Linling Kuang1(B), Xincong Lin1, and Baosheng Sun2
1 Tsinghua Space Center, Tsinghua University, Beijing 100084, China
{thuraya,kll}@tsinghua.edu.cn
2 Beijing Space Information Relay and Transmission Technology Research Center,
Beijing 100094, China
Abstract. In this paper, a computationally eﬃcient message-passing
receiver that performs joint channel estimation and decoding is pro-
posed for massive multiple-input multiple-output (MIMO) systems with
OFDM modulation. We combine the loopy belief propagation (LBP)
with the mean-ﬁeld approximation and Gaussian approximation to
decouple frequency-domain channel taps and data symbols from noisy
observations. Speciﬁcally, pair-wise joint belief of frequency-domain
channel tap and symbol is obtained by soft interference cancellation,
after which the marginal belief of frequency-domain channel tap and
symbol are estimated from the pair-wise joint belief by the mean-ﬁeld
approximation. To estimate time-domain channel taps between each pair
of antennas, a Gaussian message passing based estimator is applied. The
whole scheme of joint channel estimation and decoding is assessed by
Monte Carlo simulations, and the numerical results corroborate the supe-
rior performance of the proposed scheme and its superiority to the state
of art.
Keywords: Belief propagation · Channel estimation · Decoding
Massive MIMO · Message passing · Mean-ﬁeld approximation
Orthogonal frequency-division multiplexing (OFDM)
1
Introduction
Recently, massive MIMO systems with a large number of antennas at the base-
station have gained great attention [1–6]. Accurate channel state information
(CSI) is essential in massive MIMO systems, as high data rate and energy eﬃ-
ciency are achievable only when CSI is known. In TDD mode, the available
training resources are limited by the channel coherence interval [7]. In contrast
to conventional MIMO systems with a small number of antennas, the overhead
required for channel estimation in massive MIMO systems may be overwhelm-
ing. Therefore, accurate channel estimation with reduced overhead is critical to
massive MIMO systems.
This work was supported by the National Nature Science Foundation of China (Grant
No. 91438206 and Grant No. 91638205).
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 300–316, 2018.
https://doi.org/10.1007/978-3-319-72823-0_29

Iterative Receiver with Gaussian and Mean-Field Approximation
301
A receiver that jointly estimates channel taps and data symbols can provide
more accurate channel estimation with less pilot overhead [8–11]. Factor graph
and loopy belief propagation (LBP) [12] have been used as a uniﬁed framework
for iterative joint detection, estimation, interference cancellation, and decoding
[13]. LBP algorithm combined with various approximate method has been pro-
posed in [9,14–20]. Speciﬁcally, LBP combined with expectation-maximization
(EM) was proposed in [16]; LBP combined with Gaussian approximation was
studied in [9,16,17,21]. Riegler et al. merged LBP and the mean-ﬁeld (MF)
approximation (so called “BP-MF”) in [19,22], and applied it to both single-
input single-output OFDM systems and MIMO-OFDM systems [19,22,23]. How-
ever, the BP-MF has to learn the noise precision to take into count the interfer-
ence from other users even when the noise power is exact known [24,25]. More-
over, the BP-MF in [22] requires high computational complexity and would only
work in the case of few antennas and subcarriers, since large matrices need to
be inverted to estimate channel coeﬃcients. Although low-complexity BP-MF
variants have been presented in [26,27], their performance are degraded.
In this paper, we consider the massive MIMO-OFDM system over frequency
selective channels. In order to decouple frequency-domain channel taps and
transmit symbols from noisy observations, we use the central-limit theorem to
eﬃciently obtain the joint belief of each pair of frequency-domain channel tap
and transmit symbol, and then employ the mean-ﬁeld method to decouple them.
Given messages of frequency-domain channel taps are extracted from observa-
tions, the time-domain channel taps between each pair of antennas is estimated
by a Gaussian message passing estimator [20]. In addition, the computations at
symbol variables are reduced by the expectation propagation [28–30].
The remainder of this paper is organized as follows. The system model is
described in Sect. 2. Section 3 presents the proposed message passing algorithm
and complexity analysis. Numerical results are presented in Sect. 4, followed by
conclusions in Sect. 5.
Notation: Lowercase letters (e.g., x) denote scalars, bold lowercase letters
(e.g., x) denote column vectors, and bold uppercase letters (e.g., X) denote
matrices. The superscripts (·)T, (·)H and (·)∗denote the transpose operation,
Hermitian transpose operation, and complex conjugate operation, respectively.
Also, X ⊗Y denotes Kronecker product of X and Y ; I or Id denotes an identity
matrix of size d × d, and ln (·) denotes the natural logarithm. Furthermore,
NC (x; ˆx, vx) = (πvx)−1 exp

−|x −ˆx|2 
vx

denotes the Gaussian probability
density function (PDF) of x with mean ˆx and variance v, and Gam (λ; α, β) =
βαλα−1exp (−βλ)

Γ (α) denotes the Gamma PDF of λ with shape parameter
α and rate parameter β, where Γ(·) is the gamma function. Finally, ∝denotes
equality up to a constant scale factor; x\xtnk denotes all elements in x but xtnk;
and Ep(x)· denotes expectation with respect to distribution p (x).

302
S. Wu et al.
Fig. 1. Block-diagram representation of the transmitters.
2
System Model
We consider the up-link of a massive MIMO system with N users. Each user
employs one transmit antenna, and the base station employs an array of M ≥N
antennas. Frequency-selective Rayleigh fading channels are assumed, and OFDM
is employed to combat multipath interference. The transmitters for the users are
shown in Fig. 1. For the nth user, the information bits bn are encoded and inter-
leaved, yielding a sequence of coded bits cn. Then each Q bits in cn are mapped
onto one modulation symbol, which is chosen from a 2Q-ary constellation set A,
i.e., |A| = 2Q. The data symbols xd
n are then multiplexed with pilot symbols
xp
n, forming the transmitted symbols sequence xn. Pilot and data symbols are
arranged in an OFDM frame of T OFDM symbols, each consisting of K subcar-
riers. More speciﬁcally, there are totally Kp pilot subcarriers in an OFDM frame
and the pilot subcarriers are spaced ⌊K/(Kp −1)⌋subcarriers apart. The pilot-
subcarrier set of user n is denoted by Pn = {(t, k) : xtnk is pilot}, |Pn| = TpKp,
and data-subcarrier set is denoted by D = 
n Pn. Note that pilot-subcarrier
sets belong to diﬀerent users are mutual exclusive, i.e., 
n Pn = ∅, and only
one user actually transmits a pilot symbol at a given pilot subcarrier, whereas
the other users keep silent, i.e., if (t, k) ∈Pn, then xtn′k = 0, ∀n′ ̸= n. The
frequency-domain symbols in the tth OFDM symbol transmitted by the nth user
are denoted by xtn = [xtn1, . . . , xtnK]T, where xtnk ∈A represents the symbol
transmitted at the kth subcarrier. To modulate the OFDM symbol, a K-point
inverse discrete Fourier transform (IDFT) is applied to the symbol sequence xtn,
and then a cyclic preﬁx (CP) is added to it before transmission.
The OFDM symbols are transmitted through a wide-sense stationary uncor-
related scattering (WSSUS) channel. It is assumed that the time-domain channel
taps keep static during one OFDM frame but vary from frame to frame. The
time-domain channel taps from the nth user to the mth receive antenna are
denoted by hmn = [hmn1, . . . , hmnL]T, where hmnl is the lth channel tap, and L
is the maximum number of channel taps. Then, the frequency-domain tap wmnk
at the kth subcarrier from the nth user to the mth receiving antenna reads
wmnk =
L

l=1
hmnlexp

−j2πlk
K
	
.
(1)

Iterative Receiver with Gaussian and Mean-Field Approximation
303
At each receive antenna, the CP is ﬁrst removed and the received signal is
then converted into the frequency-domain through a K-point discrete Fourier
transform (DFT). It is assumed that the N transmitters and the receiver are
synchronized and the maximum delays are smaller than the duration of the CP,
whereby the received signal for the tth OFDM symbol can be written as
ytmk =
N

n=1
wmnkxtnk + ϖtmk,
(2)
where ytmk denotes the received signal at the kth subcarrier on the mth receive
antenna, ϖtmk denotes a circularly symmetric complex noise with zero mean and
variance σ2
ϖ. The received signal can be recast in a matrix-vector notation as
y =
N

n=1
W nxn + ϖ = W x + ϖ,
(3)
where y =

yT
1 · · · yT
M
T with ym = [y1m1 · · · y1mK · · · yT m1 · · · yT mK]T denot-
ing the received signal at the mth receive antenna for T OFDM symbols, W n =
[IT ⊗diag {w1n·} · · · IT ⊗diag {wMn·}]T with wmn· = [wmn1 · · · wmnK]T denot-
ing the frequency-domain taps from the nth user to the mth antenna, W =
[W 1 · · · W N], x =

xT
1 · · · xT
N
T with xn =

x1n1 · · · x1nK · · · xT n1 · · · xT nK
T
denoting the symbols transmitted by the nth user, and ϖ =

ϖT
1 · · · ϖT
M
T
with ϖm = [ϖ1m1 · · · ϖ1mK · · · ϖT m1 · · · ϖT mK]T denoting the noise signal at
the mth receive antenna.
3
Message Passing for Joint Detection and Decoding
We aim to jointly estimate the information bits b =

bT
1 · · · bT
N

and channel
taps h =

hT
11· · · · hT
1N· · · · hT
M1· · · · hT
MN·
T
from the noisy observation y. The
joint PDF of all involved random variables can be factorized as follows,
p (b, c, x, y, W , h)
= p (b) p (c | b) p (x | c) p (y | W , x) p (h, W )
= p (b) p (c | b)
N

n=1

(t,k)∈D
Mtnk (xtnk, ctnk)

t,m,k
ftmk (xt·k, wtmk)
×

m,n,k
gmnk (wmnk, hmn·)

m,n,l
p (hmnl) ,
(4)
where Mtnk (xtnk, ctnk) = δ (ϕ (ctnk) −xtnk) denotes the deterministic mapping
xtnk = ϕ (ctnk), ϕ (ctnk) denotes the symbol mapping function, and δ (·) denotes
the Kronecker delta function. The channel transition function ftmk(xt·k, wmnk)
is given by

304
S. Wu et al.
ftmk(xt·k, wmnk) = NC

ytmk;

n
wmnkxmnk, σ2
ϖ
	
.
(5)
As the frequency-domain channel taps wmnk is the DFT (discrete Fourier
transform) of time-domain taps hmn·, we have
gmnk (wmnk, hmn·) = δ

wmnk −
L

l=1
φklhmnl

,
(6)
where Φ ∈CK×L denotes the DFT weighting matrix, and φkl denotes the entry
in the kth row and lth column of DFT weighting matrix Φ. The probabilistic
structure exposed by the factorization (4) can be represented with a factor graph,
as depicted in Fig. 2. Due to high-dimensional integration, directly computing the
marginal probability of information bit is computationally prohibitive. Hence,
we resort to LBP to oﬀer eﬃcient solutions. As shown in Fig. 2, there exist two
groups of loops, the group of detection-decoding-loops in the left and the group
of the channel-estimation-loops in the right. Here, we choose to start passing
messages at the channel transition nodes, then pass messages concurrently in
both the detection-decoding-loop (the left loop) and the channel-estimation-loop
(the right loop). Each of these full cycles of message passing will be referred to
as a “turbo iteration”.
Fig. 2. Factor graph of the Massive MIMO-OFDM system.
The presentation of message passing follows closely with the convention in
[12]. All types of message are speciﬁed in Table 1. Applying the SPA to the factor
graph in Fig. 2, the messages from the channel transition node ftmk at the ith
iteration are given by

Iterative Receiver with Gaussian and Mean-Field Approximation
305
Table 1. SPA message deﬁnitions at iteration i ∈Z.
μ(i)
tnktmk (·)
Message from node ftmk to node xtnk
μ(i)
tnktnk (·)
Message from node xtnk to node Mtnk
μ(i)
tnktnk (·)
Message from node Mtnk to node xtnk
μ(i)
tnktmk (·)
Message from node xtnk to node ftmk
μ(i)
tmkmnk (·)
Message from node ftmk to node wmnk
μ(i)
mnkmnk (·) Message from node wmnk to node gmnk
μ(i)
mnkmnl (·)
Message from node gmnk to node hmnl
μ(i)
mnlmnk (·)
Message from node hmnl to node gmnk
μ(i)
mnkmnk (·) Message from node gmnk to node wmnk
μ(i)
tmkmnk (·)
Message from node wmnk to node ftmk
β(i)
tnk (·)
Belief of xtnk at node xtnk
β(i)
mnk (·)
Belief of wmnk at node wmnk
μ(i)
tnktmk (xtnk) =

xt·k\xtnk

w mk

ftmk (xt·k, wm·k)
×
N

n′=1
μ(i−1)
tmkmn′k (wmn′k)
N

n′′̸=n
μ(i−1)
tn′′ktmk (xtn′′k)
	
, ∀n,
(7)
μ(i)
tmkmnk (wmnk) =

xt·k∈AN

w m·k\wmnk

ftmk (xt·k, wm·k)
×

n′̸=n
μ(i−1)
tmkmn′k (wmn′k)

n′′
μ(i−1)
tn′′ktmk (xtn′′k)
	
, ∀n. (8)
As each symbol of xt·k\xtnk ∈AN−1 takes on values in the discrete set A, the
computations of μ(i)
tnktmk (xtnk) and μ(i)
tmkmnk (wmnk) require exponential time
to marginalize out the random vector xt·k\xtnk, which are obviously intractable
for the problem size of interests. Using (5), the messages with respect to known
pilot symbol boil down to the following simple form
μ(i)
tmkmnk (wmnk) ∝NC

wmnk; ytmk
xtnk
,
σ2
ϖ
|xtnk|2

, ∀(t, k) ∈Pn
(9)
μ(i)
tmkmn′k(wmn′k) ∝NC (wmn′k; 0, ∞) , ∀n′ ̸= n,
(10)
where we make use of the fact that other users keep silent on the pilot subcar-
riers Pn.

306
S. Wu et al.
3.1
LBP Combined with Gaussian Approximation and Mean-Field
Approximation
Note that, to update the outgoing messages from the observation node ftmk, the
received signal in (2) can be rewritten as
ytmk = wmnkxtnk +
N

n′̸=n
wmn′kxtn′k + ϖtmk, ∀n.
(11)
The interference term 
n′̸=n wmn′kxtn′k + ϖtmk in (11) is considered as a
Gaussian variable with mean ˜z(i)
tnktmk and variance τ (i)
tnktmk,
˜z(i)
tnktmk =

n′̸=n
ˆw(i−1)
tmkmn′kˆx(i−1)
tn′ktmk,
τ (i)
tnktmk = σ2
ϖ +

n′̸=n
 ˆw(i−1)
tmkmn′k
2ν(i−1)
tn′ktmk
+
ˆx(i−1)
tn′ktmk
2ν(i−1)
tmkmn′k + ν(i−1)
tn′ktmkν(i−1)
tmkmn′k

.
(12)
where ˆw(i−1)
tmkmn′k and ν(i−1)
tmkmn′k denote the mean and variance of variable
xtnk with respect to the message μ(i−1)
tmkmn′k (wmnk), respectively; ˆx(i−1)
tn′ktmk and
ν(i−1)
tn′ktmk denote the mean and variance of variable wmnk with respect to mes-
sage μ(i−1)
tn′ktmk (xtnk), respectively. As a result, the channel transition function
ftmk can be approximated as
ftmk(xt·k, wk
m) ≈NC(wmnkxtnk; z(i)
tmkmnk, τ (i)
tmkmnk), ∀n,
(13)
where z(i)
tmkmnk = ytmk −˜z(i)
tnktmk.
Using (13), a local joint belief of wmnk and xtnk is deﬁned as
β(i)
tmk (wmnk, xtnk) ∝NC(xtnkwmnk; z(i)
tmkmnk, τ (i)
tmkmnk)
× μ(i−1)
tmkmnk (wmnk) μ(i−1)
tnktmk (xtnk) ,
(14)
In order to maintain the message passing analytically and eﬃciently, we
project
the
joint
belief
β(i)
tmk (wmnk, xtnk)
onto
a
fully
factorized
belief
˜β(i)
tmk (wmnk, xtnk) = ˜β(i)
tmk (xtnk) ˜β(i)
tmk (wmnk), using the criterion of minimum
inclusive KL divergence [31]
min
˜β(i)
tmk(wmnk,xtnk)
KL

˜β(i)
tmk (wmnk, xtnk) ∥β(i)
tmk (wmnk, xtnk)

,
(15)
which amounts to the mean-ﬁeld approximation in statistical physics. However,
ﬁnding a global optimal solution to (15) is diﬃcult, and hence, we instead resort
to a local form of optimization. We use alternative measures to ﬁnd the local
beliefs ˜β(i)
tmk (xtnk) and ˜β(i)
tmk (wmnk) at the function node ftmk

Iterative Receiver with Gaussian and Mean-Field Approximation
307
KL

˜β(i)
tmk (xtnk) ˜β(i−1)
tmk (wmnk) ∥β(i)
tmk (wmnk, xtnk)

,
(16)
KL

˜β(i)
tmk (wmnk) ˜β(i−1)
tmk (xtnk) ∥β(i)
tmk (wmnk, xtnk)

,
(17)
where the local beliefs ˜β(i−1)
tmk (wmnk) and ˜β(i−1)
tmk (xtnk) at variable nodes xtnk
and wmnk, respectively, are deﬁned later. Using variational calculus, ˜β(i)
tmk (xtnk)
and ˜β(i)
tmk (wmnk) fulﬁll following updates1
˜β(i)
tmk (xtnk) = exp

Eβ(i−1)
mnk (wmnk)lnβ(i)
tmk (wmnk, xtnk)

,
(18)
˜β(i)
tmk (wmnk) = exp

Eβ(i−1)
tnk
(xtnk)lnβ(i)
tmk (wmnk, xtnk)

.
(19)
According to the semantics of factor graph, the messages μ(i)
tnktmk (xtnk) , ∀n
and μ(i)
tmkmnk (wmnk) , ∀n then are updated as follows
μ(i)
tnktmk (xtnk) =
˜β(i)
tmk (xtnk)
μ(i−1)
tnktmk (xtnk)
∝NC

xtnk; ˆx(i)
tnktmk, ν(i)
tnktmk

,
μ(i)
tmkmnk (wmnk) =
˜β(i)
tmk (wmnk)
μ(i−1)
tmkmnk (wmnk)
∝NC

wmnk; ˆw(i)
tmkmnk, ν(i)
tmkmnk

,
(20)
where
ν(i)
tnktmk =
τ (i)
tmkmnk
ν(i−1)
mnk +
 ˆw(i−1)
mnk

2 ,
(21)
ˆx(i)
tnktmk = ν(i)
tnktmk
τ (i)
tmkmnk
ˆw(i−1)
mnk
∗z(i)
tnktmk,
(22)
ν(i)
tmkmnk =
τ (i)
tmkmnk
ν(i−1)
tnk
+
ˆx(i−1)
tnk

2 ,
(23)
ˆw(i)
tmkmnk = ν(i)
tmkmnk
τ (i)
tmkmnk
ˆx(i−1)
tnk
∗z(i)
tmkmnk.
(24)
with z(i)
tnktmk and τ (i)
tmkmnk having the same deﬁnitions as that of (12) and
(12), respectively. Next, the local belief at the variable node xtnk is updated by
1 For the sake of eﬃcient implementation, we consider to update all the beliefs con-
currently in this paper.

308
S. Wu et al.
β(i)
tnk (xtnk) =
μ(i)
tnktnk (xtnk) 
m μ(i)
tnktmk (xtnk)

xtnk∈A μ(i)
tnktnk (xtnk) 
m μ(i)
tnktmk (xtnk)
=
μ(i)
tnktnk (xtnk) NC(xtnk; ζ(i)
tnk, γ(i)
tnk)

xtnk∈A μ(i)
tnktnk (xtnk) NC(xtnk; ζ(i)
tnk, γ(i)
tnk)
,
(25)
where
γ(i)
tnk =
1
M
m=1
1
ν(i)
tnktmk
,
(26)
ζ(i)
tnk = γ(i)
tnk
M

m=1
ˆx(i)
tnktmk
ν(i)
tnktmk
.
(27)
Then the message μ(i)
tnktnk (xtnk) from the variable node xtnk to the mapper
node Mtnk is updated by
μ(i)
tnktnk (xtnk) =
M

m=1
μ(i)
tnktmk (xtnk) ∝NC

xtnk; ζ(i)
tnk, γ(i)
tnk

.
(28)
With the message μ(i)
tnktnk (xtnk) and the a priori LLRs

λ(i−1)
a
(cq
tnk) , ∀q

fed
from decoder, the extrinsic LLRs {λ(i)
e (cq
tnk) , ∀q} corresponding to the symbol
xtnk are obtained
λ(i)
e (cq
tnk) = ln

xtnk∈A1
q μ(i−1)
tnktnk (xtnk) μ(i)
tnktnk (xtnk)

xtnk∈A0
q μ(i−1)
tnktnk (xtnk) μ(i)
tnktnk (xtnk)
−λ(i−1)
a
(cq
tnk) .
(29)
Once all the extrinsic LLRs {λ(i)
e (cq
tnk) , ∀t, ∀n, ∀k, ∀q} are available, each chan-
nel decoder performs decoding and updates the a priori LLRs of coded bits.
Then, the a priori LLRs

λ(i)
a (cq
tnk)

are interleaved and converted to the mes-
sage
μ(i)
tnktnk (xtnk) =
Q

q=1
exp

cq
nλ(i)
a (cq
tnk)

1 + exp

λ(i)
a (cq
tnk)
.
(30)
Direct evaluating

ˆx(i)
tnktmk, ν(i)
tnktmk

via μ(i)
tnktmk (xtnk) is expensive, as the
number of

ˆx(i)
tnktmk, ν(i)
tnktmk, ∀t, ∀m, ∀n

is up to TMN. Following the expec-
tation propagation method proposed in [28], we can reduce the computational
complexity of

ˆμ(i)
tnktmk (xtnk)

. We consider every transmitted symbol xtnk as
a continuous random variable and will approximate its message μ(i)
tnktmk (xtnk)
as a complex Gaussian PDF ˆμ(i)
tnktmk (xtnk) = NC

xtnk; ˆx(i)
tnktmk, ν(i)
tnktmk

.

Iterative Receiver with Gaussian and Mean-Field Approximation
309
The symbol belief β(i)
tnk (xtnk) at the variable node is projected into a Gaussian
PDF denoted by ˆβ(i)
n (xtnk) = NC

xtnk; ˆx(i)
tnk, ν(i)
tnk

, where
ˆx(i)
tnk =

αs∈A
αsβ(i)
tnk (xtnk = αs) ,
(31)
ν(i)
tnk =

αs∈A
|αs|2 β(i)
tnk (xtnk = αs) −
ˆx(i)
tnk

2
.
(32)
Then the approximate message ˆμ(i)
tnktmk (xtnk) is computed from the approxi-
mate symbol belief ˆβ(i)
n (xtnk) as following
ˆμ(i)
tnktmk (xtnk) ≈
ˆβ(i)
n (xtnk)
μ(i)
tnktmk (xtnk)
∝NC(xtnk; ˆx(i)
tnktmk, ν(i)
tnktmk),
(33)
where
ˆx(i)
tnktmk = ˆx(i)
tnk + ν(i)
tnk
ˆx(i)
tnk −ˆx(i)
tnktmk
ν(i)
tnktmk −ν(i)
tnk
,
(34)
ν(i)
tnktmk =
ν(i)
tnkν(i)
tnktmk
ν(i)
tnktmk −ν(i)
tnk
.
(35)
We will refer to the proposed message passing as “ BP-GMF”, which is be
summarized in Algorithm 1.
3.2
Complexity Comparisons
Table 2 shows the proposed scheme and other message-passing schemes.
The computationally complexity of these scheme is compared in terms of
ﬂoating-point operations (FLOPs) per iteration. For simplicity, the complex-
ity of addition, subtraction, multiplication, and division is considered as
being identical. Furthermore, we don’t take the operations of exp (·) and

λ(i)
e (cq
tnk)

into accounted. Table 3 shows that the complexity of BP-MF-
GMP, BP-GMF and BP-MF is O (T(M + Q |A|)NK), and that of BP-GA is
Table 2. Receiver schemes and their component algorithms.
Receiver scheme
Channel estimation
Detection & decoding
BP-GA
GMP
BP-GA [32]
BP-GMF
GMP
BP-GMF
BP-MF
Algorithm in [22] using disjoint channel model
BP-MF [19,22]
BP-MF-M
Algorithm in [26] using markov channel model
BP-MF [19,22]
BP-MF-GAMP
GAMP
BP-MF [27]

310
S. Wu et al.
Algorithm 1. The BP-GMF algorithm at the ith turbo iteration.
1: Initialization: ˆ
w(0)
mnktmk = 0, ν(0)
mnktmk =, ∀k, ∀l.
2: for t, n, k, m do
3:
z(i)
tnktmk = 
n′̸=n ˆ
w(i−1)
tmkmn′ ˆx(i−1)
tn′ktmk;
4:
τ(i)
tnktmk = σ2
ϖ +
n′̸=n
 ˆ
w(i−1)
tmkmn′

2 ν(i−1)
tn′ktmk +
ˆx(i−1)
tn′ktmk

2 + ν(i−1)
tn′ktmk

ν(i−1)
tmkmn′

5:
ν(i)
tnktmk =
τ(i)
tnktmk
 ˆ
w(i−1)
mnk

2
+ν(i−1)
mnk
ν(i)
tmkmnk =
τ(i)
tnktmk
ˆx(i−1)
tnk

2
+ν(i−1)
tnk
;
6:
ˆx(i)
tnktmk = ν(i)
tnktmk

ˆ
w(i−1)
mn
	∗z(i)
tnktmk

τ(i)
tnktmk;
7:
ˆ
w(i)
tmkmnk = ν(i)
tnktmk

ˆx(i−1)
tnk
	∗z(i)
tnktmk

τ(i)
tnktmk;
8: end for
9: for
t, n, k do
10:
γ(i)
tnk =

m 1

ν(i)
tnktmk
	−1 ;
11:
ζ(i)
tnk = γ(i)
tnk

m

ˆx(i)
tnktmk

ν(i)
tnktmk
	
;
12:
˜p(i)
eq (xi) = μ(i−1)
tnktnk (xtnk) NC

xtnk; ζ(i)
tnk, γ(i)
tnk
	
;
13:
λ(i)
e

cq
tnk
	
= ln

xtnk∈A1q
˜
p(i)
eq (xi)

xtnk∈A0q
˜
p(i)
eq (xi)
−λ(i−1)
a

cq
tnk
	
.
14: end for
15: for n do
16:
Decode and generate LLRs

λ(i)
a

cq
tnk
	
, ∀t, ∀k, ∀q

;
17: end for
18: for t, n, k do
19:
20:
μ(i)
tnktnk (xtnk) =

q
exp

cq
tnkλ(i)
a

cq
tnk
		
 
1 + exp

λ(i)
a

cq
tnk
			
;
21:
β(i)
tnk (xtnk) =
μ(i)
tnktnk (xtnk) NC

xtnk; ζ(i)
tnk, γ(i)
tnk
	

xtnk∈A μ(i)
tnktnk (xtnk) NC

xtnk; ζ(i)
tnk, γ(i)
tnk
	 ;
22:
ˆx(i)
tnk = 
αs∈A αsβ(i)
tnk(xtnk = αs);
23:
ν(i)
tnk = 
αs∈A |αs|2 β(i)
tnk(xtnk = αs) −
ˆx(i)
tnk
2.
24:
ν(i)
tnktmk = ν(i)
tnkν(i)
tnktmk

(ν(i)
tnktmk −ν(i)
tnk), ∀m;
25:
ˆx(i)
tnktmk = ˆx(i)
tnk + ν(i)
tnk(ˆx(i)
tnk −ˆx(i)
tnktmk)

(ν(i)
tnktmk −ν(i)
tnk), ∀m.
26: end for
Table 3. Complexity of detection and decoding.
Receiver scheme
FLOPs per iteration
BP-GA
(28 |A| + 33) TMNK + (2 |A| + 3Q |A| + Q) TNK
BP-GMF
63TMNK + (23 |A| + 3Q |A| + Q) TNK
BP-MF [22]
22TMNK + (11N + 4) M (K −Kp) + (23 |A| + 3Q |A| + Q) TNK
BP-MF-M [26]
33TMNK + (11N + 4) M (K −Kp) + (23 |A| + 3Q |A| + Q) TNK
BP-MF-GMP
33TMNK + (11N + 4) M (K −Kp) + (23 |A| + 3Q |A| + Q) TNK
O (T(M |A| + Q |A|)NK). Table 4 shows the complexity of algorithms perform-
ing the task of channel estimation, where GMP is O (MNK (log2K + T)), BP-
MF is O

MNK3
, and BP-MF-M is O

MNKG3
.

Iterative Receiver with Gaussian and Mean-Field Approximation
311
Table 4. Complexity of channel estimation.
Receiver scheme
FLOPs per iteration
BP-GA
MN (20Klog2K + 30TK + 11K −26TKp + 13Kp + 14L −2)
BP-GMF
BP-MF-GAMP [27]
BP-MF [22]
MN

16K3 + 12K2 + 17TK −K

+ 2TNK −2NK −2MN
BP-MF-M [26]
MN

118G2 + 68G −4

K −112G3 −92G3 + 5G
4
Simulation Results
The proposed receiver algorithm BP-GMF is compared with the BP-GA [32],
BP-MF variants, the MMSE, and the MFB-PCSI in terms of bit error rate
(BER) and mean square error (MSE) of the channel estimation. A MIMO sys-
tem with N = 8 single-antenna users is considered, each of which employs an
OFDM with K = 64 subcarriers. We choose a R = 1/2 recursive systematic
convolutional (RSC) code with generator polynomial [G1, G2] = [117, 155]oct,
followed by a random interleaver. For bit-to-symbol mapping, multilevel Gray-
mapping is used. Each user employs Kp = 8 pilot subcarriers modulated with
uniformly selected known BPSK symbols and uniformly placed in one selected
OFDM symbol. The channel model in simulations is an 8-tap Rayleigh fading
MIMO channel with equal tap power. At the receiver, the BCJR algorithm is
used to decode the convolutional code. It is assumed that the transmit anten-
nas from diﬀerent users are spatially uncorrelated and that the receive antenna
spacing is suﬃcient so that they are also spatially uncorrelated. The channels
are block-static for the selected 8 transmitted OFDM symbols. For all simula-
tion results, a minimum of 100 frame errors were counted. The energy per bit
to noise power spectral density ratio Eb/N0 is deﬁned as [33]
Eb
N0
= Es
N0
+ 10log10
M
RNQ,
(36)
where Es/N is the average energy per transmitted symbol.
4.1
Channel-Tap NMSE Versus Eb/N0
At the initial turbo iteration, only the pilots can be used for channel estimation.
The BP-GMF, the BP-GA and the BP-MF-GAMP perform 5 inner iterations in
the channel-estimation-loops during the initial turbo iteration and perform only
1 inner iteration during each subsequent turbo iterations. The channel estima-
tor in the BP-MF is equivalent to the pilot-based LMMSE estimator at the ini-
tial turbo iteration and becomes the data-aided LMMSE estimator at subsequent
turbo iterations. The channel estimation in the BP-MF-M is performed by the
Kalman smoother proposed in [26], where the group-size of contiguous channel
weights is set to G = 4. A maximum of 50 turbo iterations are used in all message-
passing receivers, and the NMSE at the ith turbo iteration is calculated by

312
S. Wu et al.
Fig. 3. NMSE of time-domain channel taps versus Eb/N0.
Fig. 4. NMSE of time-domain channel taps versus number of turbo iterations, under
Eb/N0 = 7.25 dB (dashed lines) and Eb/N0 = 8.75 dB (solid lines).
NMSE = 1
Θ
Θ

θ=1
1
MN
M

m=1
N

n=1
L
l=1
hmnl −ˆh(i)
mnl

2
L
l=1 |hmnl|2
,
(37)
where Θ is the number of Monte Carlo runs.
Figure 3 shows the normalized mean-squared error of the channel estimation
versus Eb/N0 in the 16 × 8 MIMO system and the 64 × 8 MIMO system, respec-
tively. It is shown that the NMSE of the proposed BP-GMF outperforms the
MMSE, the BP-MF-M, the BP-MF-GAMP and the BP-MF (which is evaluated
only in the 16 × 8 MIMO system due to complexity issue) in both cases.
Figure 4 presents the NMSE performance versus the number of turbo itera-
tions. Results indicate that the BP-GMF and BP-GA demonstrate almost the
same convergency, and need less than 15 iterations to converge.

Iterative Receiver with Gaussian and Mean-Field Approximation
313
4.2
BER Versus Eb/N0
Figure 5 shows the BER performance versus Eb/N0 in the 16 × 8 MIMO sys-
tem and the 64 × 8 system, respectively. The BP-GA algorithm and BP-GMF
algorithm achieve the same performance that is about 0.8 dB away from the
MFB-PCSI at BER = 10−5; the BP-MF algorithm slightly outperforms the
BP-MF-GMP algorithm, but its performance is about 1.3 dB away from the
MFB-PCSI at BER = 10−5.
Figure 6 presents the BER performance versus the number of turbo iterations.
Results indicate that the BP-GMF and BP-GA demonstrate almost the same
convergency, and need less than 15 iterations to converge.
Fig. 5. BER versus Eb/N0 in MIMO systems with 16QAM.
Fig. 6. BER versus number of turbo iterations, under Eb/N0 = 7.25 dB (dashed lines)
and Eb/N0 = 8.75 dB (solid lines).

314
S. Wu et al.
5
Conclusion
In this paper, a message-passing scheme combining LBP with Gaussian approx-
imation and mean-ﬁeld approximation is proposed for massive MIMO-OFDM
systems. Simulation results show that the proposed scheme can achieve the per-
formance of the BP-GA, within 0.8 dB of the known-channel bound in a 16 × 8
MIMO system and a 64 × 8 MIMO system, and outperforms the BP-MF and its
low-complexity variants considerably.
References
1. Marzetta, T.L.: Noncooperative cellular wireless with unlimited numbers of base
station antennas. IEEE Trans. Wirel. Commun. 9(11), 3590–3600 (2010)
2. Wang, S., Li, Y., Zhao, M., Wang, J.: Energy eﬃcient and low-complexity uplink
transceiver for massive spatial modulation MIMO. IEEE Trans. Veh. Technol.
PP(99), 1–1 (2014)
3. Wu, S., Kuang, L., Ni, Z., Lu, J., (David) Huang, D., Guo, Q.: Expectation propa-
gation based iterative groupwise detection for large-scale multiuser MIMO-OFDM
systems. In: Proceedings of IEEE Wireless Communications and Networking Con-
ference (WCNC), pages 248–253, April 2014
4. Wang, S., Li, Y., Wang, J.: Multiuser detection in massive spatial modulation
MIMO with low-resolution ADCs. IEEE Trans. Wirel. Commun. 14(4), 2156–2168
(2015)
5. Liu, L., Yuen, C., Guan, Y.L., Li, Y., Su, Y.: A low-complexity Gaussian message
passing iterative detector for massive MU-MIMO systems. In: 2015 10th Interna-
tional Conference on Information, Communications and Signal Processing (ICICS),
pp. 1–5, December 2015
6. Liu, L., Yuen, C., Guan, Y.L., Li, Y., Su, Y.: Convergence analysis and assurance
for Gaussian message passing iterative detector in massive MU-MIMO systems.
IEEE Trans. Wirel. Commun. 15(9), 6487–6501 (2016)
7. Dai, L., Wang, Z., Yang, Z.: Spectrally eﬃcient time-frequency training OFDM
for mobile large-scale MIMO systems. IEEE J. Sel. Areas Commun. 3(2), 251–263
(2013)
8. Rossi, P.S., M¨uller, R.R.: Joint twofold-iterative channel estimation and multiuser
detection for MIMO-OFDM systems. IEEE Trans. Wirel. Commun. 7(11), 4719–
4729 (2008)
9. Novak, C., Matz, G., Hlawatsch, F.: IDMA for the multiuser MIMO-OFDM uplink:
a factor graph framework for joint data detection and channel estimation. IEEE
Trans. Sig. Process. 61(16), 4051–4066 (2013)
10. Wu, S., Ni, Z., Meng, X., Kuang, L.: Block expectation propagation for downlink
channel estimation in massive MIMO systems. IEEE Commun. Lett. 20(11), 2225–
2228 (2016)
11. Lin, X., Wu, S., Kuang, L., Ni, Z., Meng, X., Jiang, C.: Estimation of sparse massive
MIMO-OFDM channels with approximately common support. IEEE Commun.
Lett. PP(99), 1 (2017)
12. Kschischang, F.R., Frey, B.J., Loeliger, H.-A.: Factor graphs and the sum-product
algorithm. IEEE Trans. Inf. Theor. 47(2), 498–519 (2001)
13. Worthen, A.P., Stark, W.E.: Uniﬁed design of iterative receivers using factor
graphs. IEEE Trans. Inf. Theor. 47(2), 843–849 (2001)

Iterative Receiver with Gaussian and Mean-Field Approximation
315
14. Liu, Y., Brunel, L., Boutros, J.J.: Joint channel estimation and decoding using
Gaussian approximation in a factor graph over multipath channel. In: Proceedings
of the International Symposium on Personal, Indoor and Mobile Radio Communi-
cation (PIMRC), pp. 3164–3168 (2009)
15. Kirkelund, G.E., Manch´on, C.N., Christensen, L.P.B., Riegler, E., Fleury, B.H.:
Variational message-passing for joint channel estimation and decoding in MIMO-
OFDM. In: Proceedings of IEEE Global Telecommunications Conference (GLOBE-
COM), pp. 1–6 (2010)
16. Guo, Q., (David) Huang, D.: EM-based joint channel estimation and detection
for frequency selective channels using Gaussian message passing. IEEE Trans. Sig.
Process. 59(8), 4030–4035 (2011)
17. Schniter, P.: A message-passing receiver for BICM-OFDM over unknown clustered-
sparse channels. IEEE J. Sel. Top. Sig. Process. 5(8), 1462–1474 (2011)
18. Knievel, C., Hoeher, P.A., Tyrrell, A., Auer, G.: Multi-dimensional graph-based
soft iterative receiver for MIMO-OFDM. IEEE Trans. Commun. 60(6), 1599–1609
(2012)
19. Riegler, E., Kirkelund, G.E., Manch´on, C.N., Badiu, M.-A., Fleury, B.H.: Merging
belief propagation and the mean ﬁeld approximation: a free energy approach. IEEE
Trans. Inf. Theor. 59(1), 588–602 (2013)
20. Wu, S., Kuang, L., Ni, Z., Lu, J., (David) Huang, D., Guo, Q.: Expectation propa-
gation approach to joint channel estimation and decoding for OFDM systems. In:
Proceedings of IEEE International Conference on Acoustics, Speech, and Signal
Processing (ICASSP), pp. 1941–1945, May 2014
21. Schniter, P.: Joint estimation and decoding for sparse channels via relaxed belief
propagation. In: Proceedings of the 44th Asilomar Conference on Signals, Systems
and Computers (ASILOMAR), pp. 1055–1059. IEEE (2010)
22. Manch´on, C.N., Kirkelund, G.E., Riegler, E., Christensen, L.P.B., Fleury, B.H.:
Receiver architectures for MIMO-OFDM based on a combined VMP-SP algorithm.
arXiv:1111.5848 (2011)
23. Badiu, M.-A., Kirkelund, G.E., Manch´on, C.N., Riegler, E., Fleury, B.H.: Message-
passing algorithms for channel estimation and decoding using approximate infer-
ence. In: Proceedings of IEEE International Symposium on Information Theory
(ISIT), pp. 2376–2380 (2012)
24. Dr´emeau, A., Herzet, C., Daudet, L.: Boltzmann machine and mean-ﬁeld approx-
imation for structured sparse decompositions. IEEE Trans. Sig. Process. 60(7),
3425–3438 (2012)
25. Krzakala, F., Manoel, A., Tramel, E.W., Zdeborov´a, L.: Variational free energies
for compressed sensing. In: Proceedings of IEEE International Symposium on Infor-
mation Theory (ISIT), pp. 1499–1503, June 2014
26. Badiu, M.-A., Manch´on, C.N., Fleury, B.H.: Message-passing receiver architecture
with reduced-complexity channel estimation. IEEE Commun. Lett. 17(7), 1404–
1407 (2013)
27. Yuan, Z., Zhang, C., Wang, Z., Guo, Q., Wu, S., Wang, X.: A low-complexity
receiver using combined BP-MF for joint channel estimation and decoding in
OFDM systems. CoRR, abs/1601.05856 (2016)
28. Wu, S., Kuang, L., Ni, Z., Lu, J., (David) Huang, D., Guo, Q.: Low-complexity iter-
ative detection for large-scale multiuser MIMO-OFDM systems using approximate
message passing. IEEE J. Sel. Top. Sig. Process. 8(5), 902–915 (2014)
29. Meng, X., Wu, S., Kuang, L., Ni, Z., Lu, J.: Expectation propagation based itera-
tive multi-user detection for MIMO-IDMA systems. In: 2014 IEEE 79th Vehicular
Technology Conference (VTC Spring), pp. 1–5, May 2014

316
S. Wu et al.
30. Meng, X., Wu, S., Kuang, L., Lu, J.: An expectation propagation perspective on
approximate message passing. IEEE Sig. Process. Lett. 22(8), 1194–1197 (2015)
31. Minka, T.P.: Divergence measures and message passing. Technical report MSR-
TR-2005-173, Microsoft Research Ltd., Cambridge, UK, December 2005
32. Wu, S., Kuang, L., Ni, Z., Huang, D., Guo, Q., Lu, J.: Message-passing receiver
for joint channel estimation and decoding in 3D massive MIMO-OFDM systems.
IEEE Trans. Wirel. Commun. 15(12), 8122–8138 (2016)
33. Hochwald, B.M., ten Brink, S.: Achieving near-capacity on a multiple-antenna
channel. IEEE Trans. Commun. 51(3), 389–399 (2003)

Research and Application of Summer High
Temperature Prediction Model Based
on CART Algorithm
Yujie Guan1, Wei Wang2, Fengchang Xue3(&), and Shoudong Liu1
1 College of Applied Meteorology,
Nanjing University of Information Science and Technology,
Jiangsu 210044, China
2 College of Atmospheric Sciences,
Nanjing University of Information Science and Technology,
Jiangsu 210044, China
3 College of Geographic Information and Remote Sensing,
Nanjing University of Information Science and Technology,
Jiangsu 210044, China
xfc9800@126.com
Abstract. In this paper, the average summer high temperature effective accu-
mulated for many years is used as a judge of the extent of the hot summer
temperatures of standards. Based on data mining, the CART algorithm is applied
to analyze the relationship between high temperature and some climatic factors
such as the East Asian summer monsoon index, summer India Burma trough,
the summer North Atlantic Oscillation (NAO), Equatorial Paciﬁc sea surface
temperature and so on. The high-temperature forecasting model is established
with the setup of the high temperature prediction rules. The data of summer
maximum temperature in summer in Zhangzhou, Fujian Province from 1955 to
2012 are selected to calculate the summer hot temperature of 58a. Then, mul-
tiple climatic factor data of the same period is given to the input variable, and 46
years of data is randomly selected to get 10 classiﬁcations of rule sets, resulting
in the achievement of the accuracy rate to 91.49%. With the remaining data of
12a test, the accuracy rate reaches 91.67%. In general, the results of this paper
validate the feasibility and validity of the high temperature prediction model,
and provide a new idea for the study of the catastrophic weather model.
Keywords: CART  High temperature effective accumulated temperature
Summer high temperature forecast
1
Introduction
In recent years, China is facing more frequent and severs meteorological disasters
under global climate warming and urbanization expansion. As one of the common
meteorological disasters in summer, high temperature will not only affect the social and
economic development, but also affect people’s daily life and safety of life [1–5].
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 317–326, 2018.
https://doi.org/10.1007/978-3-319-72823-0_30

China Meteorological Administration provides the daily maximum temperature
reached or exceeded 35 °C, known as high temperature. The occurrence of
high-temperature events is the result of multi-factor and multi-system. At present, many
factors have been studied on the inﬂuence factors of summer high temperature.
Brabson et al. [5] studied the evolution of extreme temperatures in England and found
that both cold winters and hot summer extreme temperatures were associated with
changes in the lower atmospheric circulation; Lin et al. [6] and Yin et al. [7] found that
summer high temperatures were associated with the West Paciﬁc High anomalies;
According to Sun [8], the extreme high temperature events in China and East Asia over
the atmospheric circulation variation is consistent, and the role of low-level warm
advection is rather important. Facing the high temperature caused by a variety of
reasons, its inﬂuence cannot be underestimated. As a result, this calls for the estab-
lishment of high-temperature forecasting model.
In addition, the current high temperature of the degree of heat is no clear grade
division. Some scholars use the 95th or 90th percentile of daily maximum temperature
as a boundary [9, 10]. However, due to the climatic differences in regional level and
people’s long-term adaptation to local climate [11], the deﬁnition of the degree of hot
does not only rely on the standard temperature, and the impact of high temperature on
the human body or the extent of harm to develop should be taken into consideration.
Therefore, according to the principle of high temperature warning and the impact of high
temperature weather on the human body and crop hazards, high temperature effective
accumulated temperature is adopted to distinguish the hot degree. The high temperature
effective accumulated temperature (EAHT) is the sum of the difference between the
daily maximum temperature and 35 °C. The larger the value is, the severe the hot event
is, and the more harmful to human health, and vice versa. On this basis, the accumulated
effective temperature can be calculated by month or year of high temperature to char-
acterize the degree of hotness of the corresponding statistical period [12].
For the establishment of high-temperature forecasting model, an effective method
of forecasting model is needed apart from the ideal high temperature index. Nowadays,
there are mainly three modeling ideas [13]: The ﬁrst is the statistical type. Through the
statistical study of a large number of related data, we ﬁnd the relationship between the
climatic factors and the high temperature to establish the relationship model. And then
use the change of factors to predict high temperature; The second is the theoretical
analysis. Mainly through the basic principles of the weather science and other disci-
plines, use the numerical model to get the temperature of the forecast value and then
forecast the high temperature [14, 15]. Even though the former is considered to be more
comprehensive, the traditional methods of statistical analysis require numerous data
and the process is too cumbersome and difﬁcult to achieve the desired accuracy [16].
The latter can reﬂect the phenomenon of high temperature weather from a more
essential level, but the parameters are not easy to obtain. Therefore, the third idea,
which is, based on data mining methods, is used in the model.
The high temperature forecasting model based on climatic factors is established by
using a large amount of relevant data. The data mining method has many categories,
which can effectively and quickly extract effective information from a large number of
related data to establish the model. Moreover, the operation is relatively simple, and the
accuracy can reach a higher benchmark [17, 18] in the reasonable set of parameters.
318
Y. Guan et al.

The methods of data mining commonly used in meteorological forecasting model
compose neural network, support vector machine and decision tree algorithm [13]. The
decision tree algorithm is widely used because of its simple calculation, fast processing
speed and easy explanation [13], which has a good application prospect in dealing with
meteorological problems.
Therefore, in this paper, the classiﬁcation regression tree algorithm (CART) is used
to study the relationship between high temperature in summer and some climatic
factors such as the East Asian summer monsoon index, summer India Burma trough,
the summer North Atlantic Oscillation (NAO), Equatorial Paciﬁc sea surface temper-
ature, the landing typhoon, Nino3, Nion4, and Nino3.4 and so on. Then according to
the obtained rule set, a high temperature forecast model based on climatic factors is
established.
The following section will elaborate more on the data and analysis approaches and
the results will be present in Sects. 3 and 4. In the last section, a brief discussion as well
as the concluding remarks will be given.
2
Data and Methods
2.1
Data
The daily maximum temperature and daily mean temperature from the summer of 1955
to 2012 in Zhangzhou, Fujian Province were selected from the meteorological station
data, and the missing data in the original data were excluded. (If no special instructions,
the following research in this article are 6, 7 and 8 months for the study period)
The index data of the western Paciﬁc subtropical high index, intensity index, west
ridge point, ridge line position, north boundary position and Indo-Burmese trough
index were derived from the National Climate Center of China from 1955 to 2012. And
other climatic factors such as monthly mean sea surface temperature data for
Nino1 + 2, Nino3, Nino4 and Nino 3.4 in 1955–2012 are obtained from NOAA
website.
2.2
Research Methods
In this paper, high temperature effective accumulated temperature (EAHT) in summer
is used to judge the hot degree of hot weather. The summer high temperature effective
accumulated temperature is the sum of the daily maximum temperature and the dif-
ference of 35 °C in summer. The mean temperature of effective accumulated temper-
ature in summer is −71.04 which is taken as the boundary of whether or not it is hot.
This accumulated temperature considers the climate and physiology of the human
body, which can better show that the high temperature hot degree.
Decision tree algorithm is an important classiﬁcation method in data mining. It aims
at obtaining decision-making steps, discovering rules, patterns and knowledge from
archived databases [19]. The root node, the branch, and the leaf node are the necessary
components of the decision tree. Where each interior node represents a detection on an
attribute, each branch representing a detected output, and a leaf node of each tree
Research and Application of Summer High Temperature Prediction Model
319

represents a class or class distribution. In this paper, the classiﬁcation and regression
tree algorithm (CART) which is a classic decision tree algorithm [20] proposed by
Breman et al. in 1984 is selected. The algorithm is a nonparametric statistical method
for classifying discrete or continuous dependent variables.
CART is a supervised learning algorithm. Before CART is used to predict, the user
must ﬁrst provide a set of learning samples to build and evaluate CART. CART uses a
learning sample set in the following structure:
L :¼ fXl; X2...Xm; Yg
X1 :¼ ðx11; x12...x1t1Þ; . . .; Xm :¼ ðxm1; xm2...xmtnÞ
Y :¼ ðY1; Y2...YkÞ
Where X1…Xm is called the attribute vectors, and its attributes can be ordered or
discrete. Y is called the label vectors, and its attributes can be ordered or discrete.
When Y is an ordered quantity, it is called a regression tree; when Y is a discrete value,
it is called a classiﬁcation tree [22]. Since the target variables of the high temperature
prediction model are discrete, a classiﬁcation decision tree is generated [21].
The criteria for variable classiﬁcation in CART are the Gini Impurity Criterion and
the Goal Dichotomy Criterion. Whether or not high temperature is a binary classiﬁ-
cation problem is a special case of multivariate classiﬁcation. Given a node t, the
estimated class probability p (j|t) represents the probability that the node belongs to
class j j ¼ 1; 2; 3. . .J
ð
Þ. The formula for determining the impurity of a given node is
iðtÞ ¼ /½pð1=tÞ; . . .; pðJ=tÞ
Where U is the impurity function, the optimal partition is obtained when con-
structing the decision tree nodes, so that the impurity degree of each child node is the
lowest. Impurity function is generally expressed as:
iðtÞ ¼ /ðp1; p1; . . .; p1Þ ¼ 
X
J
j¼1
pj log pj
With the Gini diversity index, the form of the function is as follows
iðtÞ ¼
X
J
j¼1
pðj j tÞ
"
#2

X
J
j¼1
p2ðj j tÞ
This paper discusses the binary classiﬁcation problem; the index can be simpliﬁed
as
iðtÞ ¼ 2pð1 j t Þpð2 j tÞ
320
Y. Guan et al.

At node t, randomly selected objects are assigned to class i according to probability
p (i|t), and the estimated probability of the object actually belongs to class j is p (i|t).
The estimated probability of misclassiﬁcation under this rule is the Gini index,
Gini Index ¼
X
i6¼j
pði j t Þpðj j tÞ ¼ 1 
X
J
j¼1
pj2
In the process of classifying the decision tree with high temperature, the optimal
partitioning threshold and the best test variable are selected according to the Gini
coefﬁcient of the computing node. And the optimal decision tree is generated by
recursive call until the end rule is satisﬁed.
3
Temporal Characteristics and Inﬂuencing Factors
of Summer High Temperature
In this paper, data preprocessing in Zhangzhou area of Fujian Province was used to
analyze the change trend of summer high temperature effective accumulated temper-
ature. And the impact factors of summer high temperature were studied to determine
their inﬂuence on high temperature trend.
3.1
Time Distribution of Summer High Temperature
As shown in Fig. 1, the effective accumulated temperature of high temperature in
summer showed an upward trend during the period of 1955–2012. It is worth
-140
-120
-100
-80
-60
-40
-20
0
1955
1958
1961
1964
1967
1970
1973
1976
1979
1982
1985
1988
1991
1994
1997
2000
2003
2006
2009
2012
Effective accumulated temperature in summer
Effective accumulated temperature multi-year average
Effective accumulated temperature trend
High temperature effective  
accumulated temperature
Year
Fig. 1. The change trend of effective accumulated temperature in summer in Zhangzhou, Fujian
Research and Application of Summer High Temperature Prediction Model
321

mentioning that the effective accumulated temperature in summer was higher than the
average for many years after 2000, where the hot weather appeared.
When constructing a decision tree using CART algorithm, it is necessary to per-
form a preprocess analysis of the data set, which is the target variable and the input
variable needed to be determined. In order to study the inﬂuence of climatic factors on
this trend, we use the multi-year mean summer effective accumulated temperature
(−71.04) as the target variable.
3.2
The Correlation Analysis of Summer High Temperature Index
and Different Factors
Previous studies have found that there are signiﬁcant correlations between the high
temperature and some climatic factors, such as the western Paciﬁc subtropical high, the
intensity index, the west extension point, the landfall typhoon etc. In this paper, the
correlations of summer high temperature effective accumulated temperature and the
data of each factor in the same period in Zhangzhou, Fujian from 1955 to 2012 were
analyzed. The results are as follows:
It can be seen from Table 1 that Nino3, Nino3.4, summer NAO, summer western
Paciﬁc subtropical high west ridge point, Nino1+2 and East Asia summer monsoon
index were negatively correlated with summer high temperature effective accumulated
temperature; Besides, what is positively correlated is Nino4, summer western Paciﬁc
subtropical high Intensity index, the summer western Paciﬁc subtropical high area
index, landing typhoon, summer India and Myanmar and summer high temperature
Table 1. 1955–2012 summer climatic factors and the summer high temperature effective
accumulated temperature correlation coefﬁcient set
Climatic factor
Correlation coefﬁcient
Nino3
−0.023
Summer NAO
−0.331*
Nino4
0.079
Nino3.4
−0.037
Summer Western Paciﬁc
Subtropical High Strength Index
0.417**
Summer Western Paciﬁc
Subtropical High Area Index
0.413**
Summer Western Paciﬁc
Subtropical High West Stretch Point
−0.372**
Nino1+2
−0.026
Landing Typhoon
0.102
Summer East Asian Monsoon Index −0.383**
Summer India Burma Trough
0.399**
Note: ** for the correlation coefﬁcient through the a = 0.01
signiﬁcant test.
* for the correlation coefﬁcient through the a = 0.05 signiﬁcant
test.
322
Y. Guan et al.

effective accumulated temperature. The correlation coefﬁcients of summer western
Paciﬁc subtropical high intensity index, summer western Paciﬁc subtropical high area
index, summer western Paciﬁc subtropical high west ridge point, East Asian summer
monsoon index, summer Indian Burma trough and summer high temperature effective
accumulated temperature were adopted a = 0.01 signiﬁcance test. The correlation
coefﬁcient between summer NAO and summer high temperature effective accumulated
temperature was tested by a = 0.05. The results showed that the summer high tem-
perature is highly related to these, and other factors had some correlation with the
summer high temperature. In this paper, these climatic factors are used as input vari-
ables when constructing decision tree using CART algorithm.
4
Construction and Application of High Temperature
Forecast Model Based on CART Algorithm
Data mining methods (Fig. 2) are used in this research to identify and analyze the
relation between summer temperatures effective accumulated temperature and climatic
factors. The accessibility of the forecast data regarding climatic factors from air-sea
coupled model forecasting together with the use of forecasted factors as input variables
ensure the make prediction of the high temperature in summer.
4.1
Construction of Decision Tree Model Based on CART
In order to make the high temperature forecast more reasonable, this paper uses the
multi-year average of summer high temperature effective accumulated temperature
(−71.04) as the hot index, which is also the target variable when constructing the
model.
The process of establishing a high temperature forecasting model based on the
CART model is as follows: ﬁrstly, the input variable data is obtained (A number of
Select samples
Data analysis
Modularization
Evaluation
N
Fig. 2. Basic ﬂow chart of data mining
Research and Application of Summer High Temperature Prediction Model
323

climatic factor data, and pretreatment); secondly, using the temperature data, calcu-
lating the index of summer hot degree and judging whether it is hot in summer; then
selecting some data randomly as training set, taking the climate data as the input
variables and whether the summer high temperature as a target variable. Using the data
mining software (IBM SPSS Modeler) and the CART algorithm to build the model,
then obtain the forecast rule set. Finally, select the remaining data as the test set to
verify the accuracy of the model.
4.2
Application of High Temperature Prediction Model
Taking Zhangzhou of Fujian Province as an example, the CART algorithm was
selected by IBM SPSS Modeler to build a high temperature forecasting model.
The main contents of the decision tree are constructed by CART algorithm: the
parent node recursively tests the random test variable and the segmentation threshold
with the Gini coefﬁcient until the best test variable and the segmentation threshold are
generated. After entering the child node, the behavior of the parent node continued
until the end condition is satisﬁed. The decision tree (Fig. 3) was obtained by using
CART for a number of climatic factors during the summer of 1955–2000, and the
accuracy of self-learning was 91.49% (Table 2). Each path from the root node to the
child node represents a high-temperature prediction rule. The data in leaf nodes rep-
resent the high temperature, the total sample size and the number of misclassiﬁed
samples respectively. Take “0 (1/0)” as an example: outside of the brackets represent
non-high-temperature 0 (1 on behalf of high temperature), left side of the parentheses
on behalf of a sample of the total number of brackets inside the right 0 represents the
number of high-temperature samples. The difference, that is, 1 – 0 = 1, represents the
1(12/0)
Summer East Asian 
Monsoon Index
≤-0.795
＞-0.795
≤92.333
＞92.333
≤25.167
＞25.167
≤0.640
＞0.640
≤-0.750
＞-0.750
≤0.397
≤0.956
≤-0.430
＞-0.430
Summer Western 
Pacific Subtropical 
High Ridge
Summer Western 
Pacific Subtropical 
High Strength Index
Summer East Asian 
Monsoon Index
Summer East Asian 
Monsoon Index
Nino4
Summer NAO
Nino1+2
0(1/0)
0(13/0)
1(1/0)
Summer East Asian 
Monsoon Index
0(5/0)
1(1/0)
1(4/0)
0(3/0)
＞0.397
1(1/0)
≤1.746
＞1.746
1(8/0)
＞0.956
Fig. 3. The high temperature forecasting decision tree produced by CART algorithm
324
Y. Guan et al.

number of non-high temperature samples correctly classiﬁed. In order to further verify
the reliability, the 2001–2010 climatic factor data was selected and the corresponding
accuracy rate achieved 91.67% (Table 2).
With the high accuracy rate of 91.67%, the high temperature prediction model
established by the data mining method can be considered valid and reliable. This also
provides a new idea for the study of high temperature and other climate prediction.
5
Conclusion
This paper was based on the CART algorithm of data mining, and a high temperature
climate prediction model was established. Taking Zhangzhou, Fujian as an example,
and the following conclusions are obtained:
(1) The inter-annual variation of effective accumulated temperature of summer high
temperature in Zhangzhou, Fujian is an upward trend, especially after 2000.
(2) There were signiﬁcant correlations between summer NAO, summer western
Paciﬁc subtropical high intensity index, summer western Paciﬁc subtropical high
area index, summer western Paciﬁc subtropical high west ridge point, East Asian
summer monsoon index, summer Indian-Burmese trough and summer high
temperature.
(3) Random selection of Zhangzhou from 1955 to 2012 of which 46 years of data, the
establishment of classiﬁcation decision tree to get the rule set, and classiﬁcation
accuracy rate of 91.49%. The remaining data for the inspection accuracy rate of
91.67%, indicating that the model has good reliability.
Although the prediction model established in this paper has reached certain accu-
racy, further studies are still needed. It is helpful to improve the accuracy of disaster
prediction by discovering the potential information and laws concerning weather
through the data mining method.
References
1. Eastcrling, D.R., Evans, J.L., Groisman, P.Y., et al.: Observed variability and trends in
extreme climate events: brief review. Bull. Amerimete Soc. 81(3), 417–425 (2000)
2. Changnon, S.A., Pielke, R.A., Changnon, D., et al.: Human factors explain the increased
losses from weather and climate extremes. Bull. Amerimete Soc. 81(3), 437–442 (2000)
Table 2. High temperature prediction model results table
Training Probability Testing Probability
Correct 43
91.49%
11
91.67%
Wrong
4
8.51%
1
8.33%
Total
47
100%
12
100%
Research and Application of Summer High Temperature Prediction Model
325

3. Karl, T.R., Jones, P.D., Knighta, R.W., et al.: A new perspective on recent global warming:
asymmetrie trends of daily maximum and minimum temperature. Bull. Am. Meteorol. Soc.
74(6), 1007–1023 (1993)
4. Gruaz, G., et al.: Indictors of climate change for the Russian Federation. Clim. Chang. 42,
219–242 (1999)
5. Brabson, B.B., Palutikof, J.P.: The evolution of extreme temperatures in the Central England
temperature record. Geophys. Res. Lett. 29(24), 2163–2166 (2002)
6. Lin, J., Bi, B., He, J.: Study on the variation of the western Paciﬁc subtropical high and the
formation mechanism of high temperature in Southern China in July 2003. Chin. J. Atmos.
Sci. 29(4), 594–599 (2005). (in Chinese)
7. Yin, J., Zhang, C., Zhang, C.: Analysis of rare high temperature climate in summer 2003 in
Jiangxi Province. J. Nanjing Inst. Meteorol. 28(6), 855–861 (2005). (in Chinese)
8. Sun, J., Wang, H., Yuan, W.: Decadal variability of the extreme hot event in China and its
association with atmospheric circulations. Clim. Environ. Res. 16(2), 199–208 (2011). (in
Chinese)
9. Ding, T., Qian, W.H., Yan, Z.W.: Changes in hot days and heat waves in China during
1961–2007. Int. J. Climatol. 30, 1452–1462 (2010)
10. He, S., Dai, E., Ge, Q., et al.: Spatiotemporal pattern prediction of high temperature disaster
risk in China. J. Nat. Disasters 19(2), 91–97 (2010). (in Chinese)
11. Ye, D., Yin, J., Chen, Z., et al.: Temporal and spatial characteristics of summer heat wave in
China during 1961–2010. Chin. J. Clim. Chang. Res. 9(1), 15–20 (2013). (in Chinese)
12. Chen, M., Geng, F., Ma, L., et al.: Analysis of high temperature heat wave in Shanghai area
in recent 138 years. Plateau Meteorol. 32(2), 597–607 (2013). https://doi.org/10.7522/j.issn.
1000-0534.2012.00058. (in Chinese)
13. Shi, D., Geng, H., Chen, J.I., et al.: Construction and application of road icing forecast model
based on C4.5 decision tree algorithm. J. Meteorol. Sci. 35(2), 204–209 (2015). (in Chinese)
14. Gao, X., Zhao, Z.: The experiment of extra seasonal prediction in China by OSU/NCC GCM
for ﬂood season. J. Appl. Meteorol. 11(2), 180–188 (2000). (in Chinese)
15. Wang, Q., Feng, G., Zheng, Z., et al.: Study on objective and quantitative prediction of
multi-factor combination for precipitation optimization in ﬂood season of middle and lower
reaches of Yangtze River. Chin. J. Atmos. Sci. 35(2), 287–297 (2011). (in Chinese)
16. Wang, W., Xue, F., Shi, D., et al.: Research on summer drought prediction model based on
CART algorithm. J. Meteorol. Sci. 36(5) (2016). https://doi.org/10.3969/2015jms.0067. (in
Chinese)
17. Zhang, W., Gao, S., Chen, B., et al.: The application of decision tree to intensity change
classiﬁcation of tropical cyclones in western North Paciﬁc. Geophys. Res. Lett. 40(9), 1883–
1887 (2013)
18. Liu, Z., Du, Z., Chen, H., et al.: Study on the land use and cover classiﬁcation of Zhengzhou
based on decision tree. Meteorolog. Environ. Sci. 31(3), 48–53 (2008). (in Chinese)
19. Friedl, M.A., Brodley, C.E.: Decision tree classiﬁcation of land cover from remotely sensed
data. Remote Sens. Environ. 61(3), 399–409 (1997)
20. Zhao, P., Fu, Y., Zheng, L., et al.: Land use/cover classiﬁcation of remote sensing images
based on classiﬁcation regression tree analysis. J. Remote Sens. 9(6), 708–716 (2005). (in
Chinese)
21. Zhang, W., Leung, Y., Chan, J.C.L.: The analysis of tropical cyclone tracks in the western
North Paciﬁc through data mining. Part I: tropical cyclone recurvature. J. Appl. Meteor.
Climatol. 52(6), 1394–1416 (2013)
22. Ying, T.: Remote Sensing Image Classiﬁcation Based on Texture Information and CART
Decision Tree Technology. Nanjing Forestry University (2008)
326
Y. Guan et al.

Research on Peak-to-Average Power Ratio
Reduction for FBMC-Based 5G Transmission
Wenwan You, Junqi Guo(&), Ke Shan, and Rongfang Bie
College of Information Science and Technology, Beijing Normal University,
Beijing 100875, China
youwenwan@mail.bnu.edu.cn, guojunqi@bnu.edu.cn
Abstract. The pursuit of high-quality modulation has become an inevitable
trend along with a continuous evolution of mobile communication technologies.
The ﬁlter-bank based multicarrier (FBMC) modulation, which has aroused wide
concern recently for its higher spectral efﬁciency than orthogonal frequency
division multiplexing (OFDM), is considered as a promising candidate solution
to the air interface problem in the ﬁfth-generation communication (5G). Since
performance of multicarrier transmission is inevitably and largely affected by
peak-to-average power ratio (PAPR), research on PAPR reduction methods is
essential. After presenting the architecture of an FBMC transmission system and
analyzing structural characteristics of FBMC signals, this paper studies several
PAPR reduction methods which are previously used in OFDM transmission, and
then attempts to apply them to an FBMC transmission environment by giving
theoretical derivation. Computer simulation under different cases also verify their
feasibility and effectiveness on PAPR reduction of FBMC signal waveform.
Keywords: Filter-bank based multicarrier (FBMC)
Peak-to-average power ratio (PAPR) reduction  5G
1
Introduction
The ﬁfth generation mobile communication system (5G) has attracted more and more
attention recently. Under a 5G scenario, the more stringent requirements are put for-
ward for the multicarrier multiple access transmission [1]. Therefore, analysis of
multicarrier technology for 5G mobile communication is of great signiﬁcance.
orthogonal frequency division multiplexing (OFDM), which is one of the key tech-
nologies for the physical layer of the fourth generation mobile communication (4G),
has been widely used for signal transmission over multi-path fading channels [2].
However, competitive power of OFDM in the 5G scenario proves to be weak due to its
sensitivity to carrier frequency offset (CFO) and large peak-to-average power ratio
(PAPR) [3]. Filter-bank based multicarrier (FBMC), which employs specially designed
ﬁlter banks with small out-of-band attenuation in an architecture of multicarrier
modulation, has been considered as a promising candidate solution to the 5G air
interface problem [4]. Compared with OFDM, the FBMC modulation scheme has a
lower spectrum leakage, which makes it very suitable for cognitive radio (CR) appli-
cations in a 5G scenario. However, FBMC signals still suffer from large PAPR due to
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 327–337, 2018.
https://doi.org/10.1007/978-3-319-72823-0_31

the superposition of multicarrier signals at the transmitter, which leads to performance
degradation and attracts much research on PAPR reduction methods for FBMC-based
5G transmission. To the best of our knowledge, there are very few methods that can be
effectively and actually employed for PAPR reduction in an FBMC transmission
architecture. Some papers [2–4] introduce a tone reservation (TR) method and an
overlapped selected mapping (SLM) technique, but they are not directly applicable to
the FBMC scheme due to the fact that the overlap of time-domain symbols leads to a
search with high computational complexity.
Based on the description of FBMC transmission architecture and analysis of
structural characteristics of FBMC signals, this paper studies several PAPR reduction
methods which are previously used in OFDM transmission, and then attempts to apply
them to an FBMC transmission environment by giving detailed theoretical derivation.
Computer simulation under different cases also verify feasibility and effectiveness of
these PAPR reduction methods on the FBMC transmission scenario.
The organization of the paper is as follows. Section 2 brieﬂy described the FBMC
modulation and the structural characteristics of FBMC signals. In Sect. 3 traditional
methods of reducing PAPR in an FBMC transmission system is introduced and
improvement of the traditional algorithm is made. In Sect. 4 the algorithm mentioned
in Sect. 3 is simulated. According to the simulation results, the performance of each
algorithm is analyzed to ﬁnd the algorithm which can reduce the PAPR effectively.
Section 5 summarizes the results and concludes the paper with an overall evaluation of
the discussed PAPR reduction schemes and next is the acknowledgement.
2
FBMC Transmission Architecture
2.1
System Principle
FBMC modulation is widely used in a multi-carrier modulation scheme. Similar to the
OFDM system, multicarrier modulation is performed via IFFT, and then each sub-
channel is ﬁltered by a specially designed prototype ﬁlter which has a positive inﬂu-
ence on the spectral characteristics of the transmitted signal. Through the analysis of
FFT, a prototype ﬁlter which can be applied to FBMC system must have the following
properties: (1) linear phase; (2) satisﬁes the Nyquist theorem to guarantee the mutual
independence between the sub carriers; (3) small out-of-band attenuation. At present,
many studies design a prototype ﬁlter based on an overlap factor [3]. The results show
that this prototype ﬁlter under the conditions of the overlap factor k = 4 have better
out-of-band attenuation performance than the FFT prototype ﬁlter [4].
In an FBMC system, the use of OQAM modulation is a good way to ensure the
same code rate as the FFT ﬁlter bank. The cross-amplitude modulation signal is then
transmitted in the system, in which there is a T/2 time delay between the imaginary and
the real part of the input complex signal. Next, the imaginary part and the real part carry
out the shift addition. The realization of the system block diagram is shown as below
(Fig. 1).
328
W. You et al.

The structure of the FBMC system consists of a synthetic ﬁlter bank located at the
transmitter and an analysis ﬁlter bank used by the receiver. The two ﬁlter banks are
actually prototype ﬁlters after the shift. The status of the two ﬁlter banks in the system
determines the unique nature of the FBMC signal. In the process of FBMC modulation,
A prototype ﬁlter with a pulse response of P0 (represents the intensity of pulse
response) and satisfying the Nyquist interval is applied to the sub carrier. Considering
the superior performance of the prototype ﬁlter, the FBMC signal obviously has higher
spectral efﬁciency than the OFDM signal. The following ﬁgure shows the basic
architecture of the FBMC system (Fig. 2).
The ﬁgure shows that the FBMC system increases OQAM preprocessing module at
the transmitter in order to separate the real and imaginary part of complex signals, then
the synthetic ﬁlter bank, which includes IFFT processing module and PPN phase-multi
structure, is employed to achieve frequency domain extension. Signals are then
transmitted to the channel through the P/S transform. At the receiver, the received
Fig. 1. The block diagram of realization of the system.
Fig. 2. The basic architecture of the FBMC system.
Research on Peak-to-Average Power Ratio Reduction
329

signal is ﬁrst processed by the S/P transform. Next, the information ﬂow is divided into
multiplexed signals which then enter the analysis ﬁlter bank consisting of PPN
phase-multi structure and FFT processing module. Finally, signals are demodulated
through OQAM post-processing module. Since the carriers are orthogonal to each other
in the system, the complete input signal can be restored at the receiver without being
affected by subcarrier interference and inter-symbol interference.
The baseband signal s½n of discrete modulated in FBMC system can be expressed
based on the complex modulation symbol Xm½k at the kth subcarrier during the mth time
slot as follows:
s½n ¼
X
1
m¼1
X
N1
k¼0
ðhk<fXm½kgp0½n  mN þ hk þ 1<fXm½kgp0½n  mN  p
2ejkðnmNÞ2p
n Þ
ð1Þ
hk ¼
1;
k is even
0;
k is odd

ð2Þ
where: j ¼
ﬃﬃﬃﬃﬃﬃﬃ
1
p
and N represent the number of available subcarriers. The overlapping
ratio of continuous symbol is closely related to the length of the prototype ﬁlter. For
simplicity, the ﬁlter is designed with an impulse response of length K * N, which
means that the symbol duration is stretched and there are K symbols overlapping in
time domain to avoid loss of data rate.
2.2
Structural Characteristics of FBMC Signals
In order to make a comprehensive understanding of the FBMC system, we construct
the FBMC signal and study its structural characteristics. In the FBMC signal, there is a
T/2 time delay in the time domain between the imaginary part and the real part of the
signal, where T represents the symbol width. After the input signal is modulated by the
prototype ﬁlter, the adjacent modulation signal frequency difference is 1/T. The
modulated signal can be expressed in time domain as follows:
exðtÞ ¼
X
N1
n¼0
X
M1
M¼0
xn
mðtÞ ¼
X
N1
n¼0
X
M1
M¼0
½an
mhðt  mTÞ þ jbn
mhðt  mT  T
2ÞejnuI
ð3Þ
where: N representing any positive integer. Amn and Bmn respectively represent the real
and imaginary parts of the signal input in the nth sub carrier of the mth data blocks.
Obviously the impulse response of prototype ﬁlter is longer than T. Since the delay
exists between the real and imaginary parts of the signal input, it will overlap between
adjacent FBMC signal blocks.
In order to reﬂect signal PAPR more accurately, we oversample the signal with the
sampling rate T/K, where K = LN and L are over sampling coefﬁcients. From the
330
W. You et al.

literature we know that when sampling coefﬁcient L = 4, the sign changes can be
described well [5]. The sampled signal can be expressed as follows:
xn
m½k ¼
ðan
mh½k  mK þ jbn
mh½k  mK  K
2Þejnð2pk
TK þ p
2Þ; mK  k  mK þ ðA þ 1ÞK  1
0; k\mK; k [ mK þ ðA þ 1ÞK  1
(
ð4Þ
where: A represents the number of overlapping data blocks with time domain signals
xm½k; h½k represents the discrete time ﬁlters obtained by sampling, h½k ¼ h½Tk=K.
3
PAPR Reduction for FBMC Transmission
This section will discuss methods of reducing PAPR in an FBMC transmission system.
Through the study of some effective algorithms in a traditional OFDM system, we
apply them to the FBMC environment and make some theoretical derivation.
3.1
Clipping
Note that the discrete amplitude of FBMC signals in time domain is limited to the
threshold value Amax. Clipping signal can be written as follows:
sc½n ¼
s½n;
js½nj  Amax
Amaxeju½s½nÞ;
js½nj [ Amax

ð5Þ
where: uðs½nÞ is the phase of complex signal. The limiter is characterized by limiting
ratio, which is deﬁned as follows:
CRdB ¼ 10 log10ðcÞ
ð6Þ
where: c ¼ Amax=
ﬃﬃﬃﬃﬃ
Ps
p
; Ps is the average energy of the transmitted signal. The math-
ematical model of the limiting amplitude is derived from the derivation of the Bussgang
theorem for the non-memory nonlinear Gauss input [6]. The limiting signal can be
expressed as:
sc½n ¼ as½n þ d½n
ð7Þ
where: a describes the attenuation; d½n is a limited range of noise which is also known
as Bussgang noise. Attenuation factor can be calculated in the following way:
a ¼ 1  ec2 þ
ﬃﬃﬃp
p
2 cerfcðcÞ
ð8Þ
Research on Peak-to-Average Power Ratio Reduction
331

The energy of clipping noise is then calculated as follows:
Pd ¼ ð1  ec2  a2ÞPs
ð9Þ
Since some literatures study clipping iteration scheme and clipping combined with
ﬁltering scheme [6], we consider to combine the two schemes. Let it be able to reduce
the system PAPR signiﬁcantly and to reduce the nonlinear distortion of the system as
far as possible. In accordance with this idea, an additional signal processing module is
added before the transmitter transmits the signal, then FBMC modulation is performed
on a conventional symbol X, after that the PAPR of the resulting signal s½n is mea-
sured. If it is less than a predetermined limit, it can be transmitted. If the amplitude is
larger, apply clipping to it. After the amplitude is limited, the signal sc is demodulated.
The demodulation of the symbol Xc uses a special selection and processing algorithm.
Then the new symbol Xnew is modulated, and the PAPR of the signal snew is measured.
Repeat this process until the desired PRPR has been reached. The iterative signal is
used to form an analog signal.
3.2
Partial Transmit Sequence (PTS)
The main idea of the traditional PTS methods applied in OFDM is given as follows [7]:
First, the original input data is divided into several equal sub blocks of the combination;
Next, each block is multiplied by the same rotation vector; Finally, signals with the
smallest PAPR are selected to transfer. For the FBMC system, we choose to use a
P-PTS method [7] based on a two-step optimization structure to reduce the PAPR. Due
to the overlap of the FBMC signal structure, we should consider several overlapping
data blocks when we study the reduction of peak power.
The ﬁrst step of this method is similar to the traditional Selected Mapping
(SLM) method [2] used in OFDM. The difference between these two methods is that
optimization of the phase rotation sequence of current symbol is determined by the
prior overlap of the FBMC-OQAM symbol. In other words, all of the symbols that
overlap with the current symbol need to be considered when selecting the optimized
phase rotation sequence. In addition, since each FBMC-OQAM symbol is not gener-
ated until the time FT, we should calculate the value of PAPR during ½0; FT instead of
½0; T to select the optimal rotation vector. The second step is similar to S-PTS which is
mentioned in the reference [7], the main idea of which is to divide the FBMC-OQAM
symbol into segments, and then the intersection of some blocks are separated and
multiplied by the different phase rotation factors. However, as the PTS scheme exists a
certain complexity itself, just using the PTS method to reduce FBMC PAPR will lead
to high computational complexity.
3.3
PTS-Clipping
Here we consider a practical combination of the two methods above, which can achieve
better performance of PAPR reduction for FBMC transmission. On the one hand, we
know that the main idea of the PTS scheme is to divide the raw data into several
332
W. You et al.

disjoint sub blocks. Note that there are three main methods for the segmentation of data
blocks, namely, the random method, the interleaving method and the adjacent method
[8]. Through comparing the performance of the three methods, we ﬁnd that the method
of random segmentation reaches the most satisfying PAPR performance [9]. After the
split, each sub data block is then multiplied by a corresponding phase rotation
sequence, and the phase of the signal is adjusted by the phase rotation factor. Through
ﬁnding the optimal phase factor combination we can minimize FBMC PAPR. On the
other hand, the main idea of the clipping scheme is to set a threshold value. The signal
exceeding the threshold value will be cut, while the one which does not exceed the
threshold value will keep the same original value or be ampliﬁed by small amplitude,
so that PAPR can be effectively reduced in this way. However, the scheme draws into
the nonlinear distortion which leads to performance degradation. Now we consider the
combination of the two methods. Generally, the signal has been selected which has the
minimum limit noise after the original signal is processed by the PTS method, then we
apply the clipping operation. In this way, the system error will be reduced and PAPR
reduction can also be guaranteed.
The implementation steps of the combined method “PTS-Clipping” are given
below:
(1) Block the input signal data, divided it into V sub blocks;
(2) The sub blocks generated by (1) are multiplied by the corresponding phase
rotation factor, and the generated signal is used as an alternative;
(3) Calculation (2) clipping noise power of V road signal respectively.
bPv;Clipping ¼ 1
N
X
n
i¼1
ðjxkj  ThÞ2;
0  k  N; 0  v  V;
ð10Þ
(4) The signal with the minimum limiting noise power is selected from the V road
signal, then apply clipping to it.
bxk ¼
The
juðx0
kÞ;
jx0
kj [ Th
x0
k;
jx0
kjj  Th

ð11Þ
(5) Observe the PAPR performance and bit error rate (BER) performance of the
signal after the above steps.
4
Simulation Results
Here we give some simulation results of the three algorithms above to verify their
feasibility and effectiveness on FBMC PAPR reduction.
4.1
Simulation Result of Clipping
Firstly we need to set up the simulation parameters, number of subcarriers M ¼ 512
and overlap factor K ¼ 4, then the length of the prototype ﬁlter h½k is L ¼ M  N  1,
Research on Peak-to-Average Power Ratio Reduction
333

the clipping ratio is set to 4, which is equivalent to 6 dB. Through the MATLAB
programming and using the complementary cumulative distribution function to
describe the system’s PAPR performance, simulation results are shown as follows
(Fig. 3):
From the above ﬁgure, we can see the difference in the Complementary Cumulative
Distribution Function (CCDF) curve between the signal PAPR after using the clipping
method and the original signal PAPR. The PAPR performance of different clipping
frequency is given, which demonstrates that clipping can effectively reduce PAPR. As
the increase of the number of clipping, the performance of PAPR reduction is also
improved.
4.2
Simulation Result of PTS
The simulation parameters are set as follows: the modulation mode is OQAM modu-
lation, the number of sub carriers M ¼ 128, the sub carriers are divided into 4 groups,
the number of the rotation phase is 4, using random segmentation, simulation results
are shown as follows (Fig. 4):
It can be seen from the above ﬁgure that the PTS is effective for reducing the
peak-to-average power ratio of the FBMC system.
0
2
4
6
8
10
12
10
-4
10
-3
10
-2
10
-1
10
0
PAPR0[dB]
CCDF(Pr[PAPR>PAPR0])
Orignal
One clip and filter
Two clip and filter
Three clip and filter
Four clip and filter
Fig. 3. Simulation results of clipping method
334
W. You et al.

4.3
Simulation Result of PTS-Clipping
The simulation parameters are set as follows: number of subcarriers M ¼ 512, the
number of the rotation phase is 2, using 4 times oversampling. The simulation results
are shown as below (Fig. 5):
4
5
6
7
8
9
10
11
10
-4
10
-3
10
-2
10
-1
10
0
PAPR0 [dB]
CCDF (Pr[PAPR>PAPR0])
V=4
Orignal
PTS
Fig. 4. Simulation results of PTS method
4
5
6
7
8
9
10
11
12
10
-4
10
-3
10
-2
10
-1
10
0
PAPR0[dB]
CCDF(Pr[PAPR>PAPR0])
Orignal
PTS
Clipping
Clipping-PTS
PTS-Clipping
Fig. 5. Simulation result of PTS-Clipping method
Research on Peak-to-Average Power Ratio Reduction
335

From the ﬁgure we can see that using clipping method or PTS algorithm alone can
only have a certain effect on PAPR reduction, but the combination algorithm has
obviously better performance, which demonstrates that PTS-Clipping is a promising
candidate solution to FBMC PAPR reduction.
5
Conclusion
In this paper, we have studied two methods for FBMC PAPR reduction which are
clipping and partial transmit sequence (PTS), and then combined them together to
present an improved method “PTS-Clipping”. From the theoretical derivation and
computer simulation, we ﬁnd that: First, clipping method is undoubtedly the most
simple method to operate in the FBMC system, but it will introduce nonlinear dis-
tortion which leads to BER performance degradation; Next, PTS method can effec-
tively reduce FBMC PAPR, but we also ﬁnd that the number of sub blocks greatly
affect the computational complexity. Reduce the number of sub sequences will lead to
poor PAPR performance; Finally, the combined method “PTS-Clipping” achieves
better performance on PAPR reduction, which demonstrates that PTS-Clipping is a
promising candidate solution to PAPR reduction for FBMC-based 5G transmission.
Acknowledgement. This research is sponsored by National Natural Science Foundation of
China (No. 61401029), the Fundamental Research Funds for the Central Universities
(No. 2012LYB46), Beijing Youth Excellence Program (YETP0296) and Beijing Advanced
Innovation Center for Future Education (BJAICFE2016IR-004).
References
1. He, Z.: Research on key technology of ROF system based on FBMC. University of Science
and Technology Beijing, Beijing (2015)
2. Lu, S.: Non distortion method for reducing peak to average power ratio of FBMC-OQAM
signal. Huazhong University of Science and Technology, Hubei (2013)
3. He, X.: Research on channel estimation of multi-carrier system based on ﬁlter bank.
Zhejiang University, Zhejiang (2013)
4. Guo, T.: Research on reducing peak-to-average power ratio in OFDM systems. Nanjing
University of Aeronautics & Astronautics, Jiangsu (2007)
5. Qu, D., Lu, S., Tao, J.: Multi-block joint optimization for the peak-to-average power ratio
reduction of FBMC-OQAM signals. IEEE Trans. Signal Process. 61(7), 1605–1613 (2013)
6. Kollár, Z., Varga, L., Czimer, K.: Clipping-based iterative PAPR-reduction techniques for
FBMC. In: Proceedings of VDE, pp. 1–7 (2012)
7. Bellanger, M., LeRuyet, D., Roviras, D.: FBMC physical layer: a prime. In: PHYDYAS
(2010)
8. Farhang-Boroujeny, B.: OFDM versus ﬁlter bank multicarrier. IEEE Signal Process. 28(3),
92–112 (2011)
9. Liu, K., Hou, J., Zhang, P., Liu, Y.: PAPR reduction for FBMC-OQAM systems using
P-PTS scheme. J. China Univ. Posts Telecommun. 22(6), 78–85 (2015)
10. Tao, Y., Liu, L., Liu, S., Zhang, Z.: A survey: several technologies of non-orthogonal
transmission for 5G. China Commun. 12, 1–15 (2015)
336
W. You et al.

11. Zhuang, L., Weng, H.: Research on PAPR suppression algorithm for carrier aggregation in
FBMC system. Sci. Technol. Engi. 16(9), 221–225 (2016)
12. He, Y., Qu, D., Lu, S.: Sliding window tone reservation technique for the peak-to-average
power ratio reduction of FBMC-OQAM signals. IEEE Wireless Commun. Lett. 1(4),
268–271 (2012)
Research on Peak-to-Average Power Ratio Reduction
337

A Machine Learning Based Engine Error
Detection Method
Xinsong Cheng1, Liang Zhao1(&), Na Lin1, Changqing Gong1,
and Ruiqing Wang2
1 College of Computer Science, Shenyang Aerospace University,
Shenyang, China
18842458912@163.com,
{lzhao,linna,gongchangqing}@sau.edu.cn
2 International School, Beijing University of Posts and Telecommunications,
Beijing, China
wrq@bupt.edu.cn
Abstract. Nowadays the fault of automobile engines climb due to the growth of
automobiles. Traditional mechanical automobile testing is not efﬁcient enough.
In this paper, the Machine Learning based Engine Error Detection method
(MLBED) is proposed for the complex nonlinear relation and operation param-
eters of automobile engine operating parameters such as large scale data, noise,
fuzzy nonlinear etc. This method is a fault diagnosis and early warning method
designed on the basis of self-organizing neural network, Elman neural network
and probabilistic neural network. The experimental results show that MLBED has
a great advantage in the current fault detection methods of automobile engine. The
method improves the prediction accuracy and efﬁciency.
Keywords: Self-organizing neural network  Elman neural network
Probabilistic neural network  Engine fault
1
Introduction
At the moment, with the development of industry and the improvement of technology,
the integration of automotive engine is very high. The most faults of automobiles is
caused by the engine where the engine is the power source of an automobile. If an
automobile is in a poor working condition, it is a very high possibility due to engine
failure. The most common engine faults are as follows. Firstly, the fuel injection
pressure of ﬁrst cylinder is either too large or too small. Secondly, the needle valve of
ﬁrst cylinder injector is broken. Thirdly, abnormal fuel injection pressure of engine also
can lead a direct impact on the engine’s power efﬁciency, running stability and
emission performance. Fourthly, oil path blockage anomaly can directly cause the
engine fail. Therefore, it is necessary to monitor the working condition to avoid the
failure of the engine [1, 2]. Early typical fault diagnosis methods are designed on the
basis of the engine thermodynamic mathematical model [3, 4]. These methods can
identify the performance loss of each component which detects multiple faults and
quantiﬁes the performance degradation of components. The fault diagnosis is to
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 338–346, 2018.
https://doi.org/10.1007/978-3-319-72823-0_32

identify the pattern of the fault including both feature extraction and state identiﬁcation.
It is unnecessary to disassemble engine for measuring the shocking signal of engine
cylinder. This is convenient and fast. The signal information of vibration and noise is
abundant which can reﬂect the working condition of the engine in real-time [5, 6]. For a
long time, there is still many shortcomings in the engine monitoring system such as the
low frequency of engine examining and the poor reliability of data monitoring.
The rest of this paper is organized as follows. In Sect. 2, related engine fault
diagnosis methods are reviewed. In Sect. 3, the proposed Machine Learning based
Engine Error Detection method is introduced. The experimental results are shown in
Sect. 4. And we conclude this paper and give the future research direction in the last
section.
2
Related Work
There is a list of applications of Machine Learning Algorithms [7–13]. Ye et al. present
a method for qualitative diagnosis of some prototype faults [7]. The Back Propagation
Neural Network (BPNND) and the Probabilistic Neural Network (PNND) are applied
in the qualitative diagnosis for some prototype faults of aero-engine. The proposed
method solves the problem of the qualitative diagnosis of some prototype faults of
aero-engine. The problem is that the collection of the measured data is not clear. This
causes the further analysis cannot be taken based on data.
The adaptive fuzzy neural network is used by Ma et al. to engine fault diagnosis [8].
However, the measured parameters the authors are not collected clearly and a major
process is missed to identify algorithm accurate.
Zhou et al. present a good method which obtains good results in the engine fault
diagnosis [9]. The application of improved BP algorithm in engine fault diagnosis is
studied while an example training process and test results are given. The shortcomings
are basically caused by the structure characteristics of BP neural network. In the
training of large samples and high precision, the network does not converge and easy to
fall into the local optimal.
Gao et al. apply the Elman neural network in a engine performance fault identiﬁ-
cation and fault diagnosis model to prove the relationship between exhaust gas com-
position on engine performance [10]. However, the classiﬁcation of engine operating
conditions is insufﬁcient, which is easy to cause the phenomenon of false positives.
A engine warning system is presented [11]. The patented system detects the
moisture and sends out the warning signal to remind the user that the air ﬁlter is in the
water and the automobile need to be stopped. The problem is the warning is only given
when automobile engine is in bad condition, and there is no fault prediction.
3
Machine Learning Based Engine Error Detection
In view of the limitation and disadvantage of the automobile engine monitoring system,
this paper proposes the Machine Learning based Engine Error Detection method
(MLBED). Two major mechanisms are provided by MLBED methods. First, Component
A Machine Learning Based Engine Error Detection Method
339

analysis is improved with extracting the method of feature values from the vibration
signal and pressure signal parameters. The characteristic value preserves which estab-
lishes a comprehensive evaluation function. The characteristics of the comprehensive
evaluation function are very related to the value of energy parameters, such as the
kurtosis parameter, waveform parameters, margin parameters, pulse parameters and peak
parameters. It allows the comprehensive evaluation value. The range of the experimental
data obtained from the comprehensive evaluation value is from −4.78708 to 26.49655.
Second, the SOM classiﬁes operational parameter of engine and diagnoses its hitch.
There are ﬁve types of faults as off-limits injection pressure of the ﬁrst cylinder fuel, the
broken needle valve of ﬁrst cylinder injector, oil path blockage and exceeded fuel supply
advance angle. Third, the Elman neural network is applied for ﬁnd the characteristic
value of the data to predict failure. In order to show that our results are valid and reliable,
we classiﬁes and diagnose them by using PNN and SOM. This method can predict,
diagnosis and inspect of operating parameters of automobile engine.
Figure 1 is the structure of automobile engine warning system. Automobile engine
early warning system includes wireless sensor device, background monitoring and
early warning system. The following three components are shown.
(1) Wireless sensor data acquisition node is responsible for collecting the tempera-
ture, humidity, current, voltage, speed, torque and other data and transmit these
data to the sink node.
(2) Sink node is responsible for receiving the data which sent from each monitoring
sensor nodes and instantly transfer them to the monitoring background via
wireless network.
Fig. 1. Architecture module
340
X. Cheng et al.

(3) Wireless communication module is in charge of the whole network system. The
network structure of wireless sensor network based on IEEE802.15 which can
realize point to point communication between nodes in the network.
The backstage monitoring and warning system of automobile engine includes main
data backup, data center (data storage), server (data pre-processing, data training and
model building), feedback monitoring and early warning results.
3.1
Self-organizing Neural Network
As shown in Fig. 2, the engine analysis of Self-Organizing Neural network
(SOM) structure schematic diagram can be classiﬁed into the ﬁeld of artiﬁcial intelli-
gence in unsupervised learning. Two dimensional SOM is called KFM (Feature Mapping
Kohonen). The input network is a 6 dimensional vector x ¼ x1; x2; x3; x4; x5; x6
½
 of all 6
values while the output unit is two-dimensional array, the number of 6  6 species. The
input layer and the output layer of each unit is fully connected where W indicates the
connection weights. The KFM of the learning process is iterative learning of G sample
vector and calculates the winning neuron. Until the change of weight W is less than a
certain threshold or a certain number of iterations, the output units of the same sample
vector belonging to the same class. Although KFM has a learning process, it can be seen
that this kind of learning method is automatically acquired from all the samples.
3.2
Elman Neural Network
A schematic diagram of automobile engine structure of Elman neural network is shown in
Fig. 3. Elman neural network analysis can be classiﬁed into the ﬁeld of artiﬁcial intel-
ligence in supervised learning. The acquisition from operation parameters of automobile
engine with 5 kinds of failure modes of vibration signal analysis of vibration waveform
statistical processing including, energy parameters, kurtosis parameter, waveform
parameters, margin parameters, pulse parameters and peak parameters. The prediction
parameter values of the past parameters. Hence it is a problem of time series. If we want to
Fig. 2. SOM neural network structure
A Machine Learning Based Engine Error Detection Method
341

solve problems by applying Elman neural network, one parameter is taken before this
node N to predict a time node of the parameter value. The mapping function can be
expressed as xn ¼ f xn1; xn2; . . .; xnN
ð
Þ. The training samples and test samples are
divided, and the Elman neural network is established.
3.3
PNN Probabilistic Neural Network
A schematic structure of probabilistic neural network engine (PNN) is illustrated in
Fig. 4. The analysis of PNN can be classiﬁed into the ﬁeld of artiﬁcial intelligence in
supervised learning. Acquisition of automobile engine normal operation and ﬁve kinds of
failure modes of vibration signal analysis of vibration waveform statistical processing
including energy parameters, kurtosis parameter, waveform parameters, margin
parameters, pulse parameters and peak parameters. As a fault judgment training sample,
twelve input samples, each sample is six dimensional vector x ¼ x1; x2; x3; x4; x5; x6
½
.
Then the PNN is established for each of the samples, which is six dimensional vector and
the classiﬁcation model is six.
Fig. 3. Structure of Elman neural network
Fig. 4. Structure of PNN neural network
342
X. Cheng et al.

4
Simulation Results and Analysis
4.1
Improved Principal Component Analysis
Table 1 is SPSS results after the operation. The discriminant equation is obtained
according to the coefﬁcient of the non standardized discriminant equation:
D1 ¼ 0:029  EP þ 0:05  MP þ 0:002  PP1 þ 0:009  KP þ 0:017
ð
Þ  PP2  1:182
D2 ¼ 0:045  EP þ 0:029
ð
Þ  MP þ 0:001
ð
Þ  PP1 þ 0:014  KP þ 0:319
ð
Þ
 PP2  0:583
D3 ¼ 0:004  WP þ 0:012  EP þ 0:005  MP þ 0:011  PP1 þ 0:004
ð
Þ
 KP þ 0:457  PP2  2:009
4.2
Results of SOM Self Organizing Neural Network
Table 2 presents the results of Matlab operation. The application of SOM neural network
presents the current operating state of the engine time node under time node from 1 to 4.
The engine running state reﬂects the injector needle wear of ﬁrst cylinder, low or high
fuel injection pressure of the ﬁrst cylinder, or the fuel supply advance angle before 5ʹ*6.
Table 1. Canonical discriminant function coefﬁcient
Function
1
2
3
Waveform parameter (WP)
.000
.000
.004
Energy parameter (EP)
.029
.045
.012
Margin parameter (MP)
.050 −.029
.005
Peak parameters (PP1)
.002 −.001
.011
Kurtosis parameter (KP)
.009
.014
−.004
Pulse parameters (PP2)
−.017 −.319
.457
(constant)
−1.182 −.583 −2.009
Table 2. SOM output result
Time node
1
2
3
4
5
Running statement Statement 2 Statement 1 Statement 1 Statement 2 Statement 2
Time node
6
7
8
9
10
Running statement Statement 2 Statement 2 Statement 2 Statement 2 Statement 4
Time node
11
12
13
14
15
Running statement Statement 4 Statement 4 Statement 2 Statement 3 Statement 4
A Machine Learning Based Engine Error Detection Method
343

4.3
Elman Neural Network Results
As shown in Fig. 5, the left ﬁgure is the prediction results of MLBED method, while
the right ﬁgure is the prediction results by applying [11]. The prediction results are not
good due to the small size of the sample, and the input dimension is high. Therefore for
each input variable relative output characterization can be imprecise. However, if the
sample data is large enough, the model is better.
As shown in Fig. 6, the left ﬁgure is the result of the MLBED method while the
right ﬁgure is the residual error of applying [11]. Fine results of MLBED are shown in
the vicinity of 0 of the residual ﬂuctuations, it does not appear big deviation. However,
compared to method of [11], you will ﬁnd that the residuals are close to 0 near the
convergence of data. If the forecast data is more than 170 of the time, the residual error
appears larger ﬂuctuations and the accuracy of the prediction is also high. Therefore the
prediction of a certain range of data is still very accurate.
Fig. 5. Comparison of test results with other simulation results
Fig. 6. Comparison of test results with other studies
344
X. Cheng et al.

4.4
PNN Probabilistic Neural Network Results
Probabilistic neural network (PNN) is simple in structure and its training process. PNN
model for the robust nonlinear classiﬁcation capability. The fault sample space is
mapped into the fault pattern space to form a fault diagnosis network system with
strong fault tolerant capability and structure adaptive capability, which can improve the
accuracy of fault diagnosis (Table 3).
5
Conclusion
In this paper, the early warning system is designed for automobile engine while the
MLBED method is proposed on the basis of a data acquisition and machine learning
method. It provides the classiﬁcation of the automobile engine fault prediction. The
experimental results show our proposed method provides accurate fault recognition and
prediction.
Acknowledgment. This work is partially supported by the National Student’s Platform for
Innovation and Entrepreneurship Training Program (201610143022), the Research Project of
Education Department of Liaoning Province (L201630) and the Doctoral Start-up Research
Foundation of Shenyang Aerospace University (15YB03).
References
1. Zhou, Z.P.: Analysis and countermeasure of abnormal valve clearance of engine valve.
Diesel Engine Des. Manuf. 18(1), 52–56 (2012)
2. Saravanan, N., Siddab, S., Kumar, R.: A comparative study on classiﬁcation of features by
SVM and PSVM extracted using Morlet wavelet for fault diagnosis of spur bevel gear box.
Expert Syst. Appl. 35(3), 1351–1356 (2008)
3. Doel, D.L.: Temper—a gas-path analysis tool for commercial jet engines. J. Eng. Gas
Turbines Power 116(1), 82–89 (1994). J. Trans. ASME
4. Barwell, M.J.: Ground Based Engine Monitoring Program for General Application. R. SAE
Technical Paper. No. 871734 (1987)
5. Shen, Z.X., Huang, X.Y., Ma, X.: Laugh EMD and support vector machine fault diagnosis
of diesel engine. Vib. Test Diagn. 30(1), 19–22 (2010)
Table 3. PNN output result
Sample Actual Judgement True/False Fault type
1
3
3
True
The broken needle valve of ﬁrst cylinder
2
6
6
True
Normal
3
2
2
True
The ﬁrst cylinder fuel injection pressure
4
5
5
True
Fuel supply advance angle exceeded
5
1
1
True
The ﬁrst cylinder fuel injection pressure
6
4
6
True
Normal
A Machine Learning Based Engine Error Detection Method
345

6. Xu, Y.X., Yang, W.P., Lv, X.: Study on fault diagnosis of automobile engine based on
support vector machine. Vib. Shock 32(8), 143–146 (2013)
7. Xu, L.M., Wang, Q., Chen, J.P., Pan, Y.Z.: Prediction of debris ﬂow average velocity based
on BP neural network. Geol. Eng. Environ. Eng. 31(2), 25–30 (2013)
8. Ye, Z.F., Sun, J.G.: Aeroengine fault diagnosis based on probabilistic neural network.
J. Aeronaut. Sci. 23(2), 155–157 (2002)
9. Ma, J.C., Si, J.P., Niu, J.H., Wang, E.M.: Engine fault diagnosis based on adaptive fuzzy
neural network. Noise Vib. Control 35(2), 165–174 (2015)
10. Qu, C.S., Lu, Y.Z., Tan, Y.: An improved empirical mode decomposition and its application
in signal noise. J. Autom. 36(1), 67–73 (2010)
11. Lian, Y., Feng, L.G., Wu, F.L., Zhao, Y.: Study on fault diagnosis of integrated navigation
based on genetic PNN network. Foreign Electr. Meas. Technol. 33(1), 120–126 (2012)
12. Xu, L., Chen, Y., Chai, K., Schormans, J., Cuthbert, L.: Self-organising cluster-based
cooperative load balancing in OFDMA cellular networks. Wiley Wirel. Commun. Mob.
Comput. 15(7), 1171–1187 (2015)
13. Zhao, L., Li, Y., Meng, C., Gong, C., Tang, X.: A SVM based routing scheme in VANETs.
In: 16th International Symposium on Communications and Information Technologies,
Qingdao, pp. 380–383. IEEE Press (2016)
14. Xu, L., Luan, Y., Cheng, X., Xing, H., Liu, Y., Jiang, X., Chen, W., Chao, K.:
Self-optimised joint trafﬁc ofﬂoading in heterogeneous cellular networks. In: IEEE
International Symposium on Communications and Information Technologies, Qingdao,
pp. 263–267. IEEE Press (2016)
15. Xu, L., Chen, Y., Chai, K.K., Luan, Y., Liu, D.: Cooperative mobility load balancing in
relay cellular networks. In: IEEE International Conference on Communication in China,
Xi’an, pp. 141–146. IEEE Press (2013)
346
X. Cheng et al.

Beamforming Design for Physical Layer
Security and Energy Efﬁciency Based
on Base Station Cooperation
Wei Zhao(&), Hao Zhang, Hui Bao, and Baogang Li
Department of Electronic and Communication Engineering,
North China Electric Power University (NCEPU), Baoding, China
andyzhaoster@gmail.com, winnerzh1991@163.com,
baohui20131228@126.com, baogangli@ncepu.edu.cn
Abstract. The balance problem between physical layer security and energy
efﬁciency of legitimate users is jointly considered in this paper. After using the
cooperation technology of macrocell base station and microcell base station as
well as the derivation of convex optimization theory, we propose a cooperative
beamforming scheme. From the perspective of secrecy energy efﬁciency and
SINR, the simulation results show that the proposed algorithm can meet the
requirements of the system security and energy efﬁciency.
Keywords: Physical layer security  Energy efﬁciency  Beamforming
Base station cooperation
1
Introduction
The rapid development of wireless communication makes the mobile communication
users not only put forward higher requirements on the system security rate, but also
request more harsh conditions for the energy consumption of the system. How to
improve the energy efﬁciency while ensuring the physical layer security of is a hot
issue in the ﬁeld of wireless communication. As one of the key technologies in LTE-A,
the base station cooperation technologyis an effective means to solve the aboveproblem
[1–3]. This paper is organized as follows. In Sect. 2, we summarize the technology of
base station cooperation in heterogeneous networks (HetNet). The system model in the
downlink HetNet is proposed in Sect. 3, in which we introduce the user distribution in
two-layer HetNet in detail. More importantly, the optimization algorithm is designed
about the collaboration between multiple base stationsin Sect. 4 and simulation results
This work was supported by Beijing Natural Science Foundation (Grants No. 4164101), the
Fundamental Research Funds for the Central Universities(Grants No. 2015MS95), National
Natural Science Foundation of China (Grants No. 61501185), and Hebei Province Natural
Science Foundation (Grants No. F2016502062).
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 347–358, 2018.
https://doi.org/10.1007/978-3-319-72823-0_33

show the effectivenessof the proposed algorithms in Sect. 5. Finally, concluding
remarks are provided in Sect. 6.
2
Overview of Base Station Cooperative Technology
The basic idea of cooperative technology is to use the base stations, antennas, relays,
users and other communication nodes in the network to establish a virtual antenna
array, and then get space diversity or multiplexing gain. Figure 1 shows a schematic
diagram of a typical base station cooperative communication [4–6]. Different from the
traditional collaboration techniques, the cooperation between base stations can fully
utilize each antenna to carry out joint signal detection or data transmission on the same
frequency resource block and transform the interference signal between multiple base
stations into the useful one. The technology can achieve multi-point cooperative
transmission at the station level and obtain diversity gain at the receiving node at the
same time.
Note: in (a), the solid line indicates the message signal, and the broken line indi-
cates the interference; in (b), the solid line represents the message signal, and the
dashed line represents the available signal transmitted by the cooperative base station.
There are two main types of cooperative communication at the physical level:
cooperative communication between different base stations and cooperative commu-
nication between base stations and terminals. One of the preconditions for base station
collaboration is to exchange information and data between multiple cooperating base
stations, which is one of the biggest problems for the traditional cellular network.
However, under the LTE-Advanced standard, it’s proposed that the base station can
communicate with each other through the X2 interface, thus providing the possibility
for the base station to cooperate.
(a) The traditional collaboration techniques     (b) The cooperative network 
base station
terminal
Fig. 1. Base station cooperative communication
348
W. Zhao et al.

The optimization of HetNet using base station collaboration technology has the
following advantages:
(1) Increase capacity. In [7], the method of distributed compression is used to limit
the uplink data rate of two users in HetNet with different backhaul rates. In this
way, the cellular uplink capacity can greatly improve.
(2) Improve edge user performance. Since the user at the cell edge is farther from the
central base station, the signal attenuation is more severe. It is possible to signiﬁcantly
improve the communication quality of the cell edge users by the space diversity gain
caused by the cooperative transmission using a plurality of base stations [8].
(3) Saving energy. On the one hand, under the condition of a certain probability of
outage, the transmission power of the system can be greatly reduced by the
cooperative diversity transmission of multi-base stations [9]; on the other hand, by
using the resource dynamic control strategy and the operational state switching
policy between the base stations, the transfer between users can be realized, and
thus achieve the purpose of energy-saving base station [10].
More importantly, the base station collaboration technology is not only applied to
the inter-user performance improvement, but also be used to address the needs of
energy saving. For instance, I. Ashraf et al. proposed a cooperative technology of
different base stations to reduce the energy consumption of the system in the over-
lapping coverage area of the network [11].
It is worth mentioning that most of the research focused on the base station in the
homogeneous network collaboration or only using the base station collaboration
technology to implement the physical layer security or energy efﬁciency. Applying
base station collaboration technology into HetNet is rarely studied, which is a big waste
of system resources.
In order to make full use of the characteristics of HetNet, this paper designs a
collaborative beamforming scheme in the two-layer HetNet by using the collaboration
between the macro base station and the micro base station. What’s more, the inten-
tionally introduced CCI (co-channel interference) is employed. The security rate of the
legitimate users in the micro-cell is combined with the system energy efﬁciency and the
convex optimization theory is used to derive the algorithm. Finally, a power allocation
scheme is obtained. The simulation results show the advantages of the proposed
algorithm in improving system security and reducing energy consumption from the two
aspects of security energy efﬁciency and SINR (the ratio of the power of the message
signal to the interference power plus the noise power).
3
System Model
In the downlink of HetNet, there is one macrocell base station equipped with
NMðNM [ MÞ antennas, which locates at the center of its coverage, and K microcell
base stations equipped with NPðNP [ NÞ antennas. For the sake of convenience, it is
assumed that the macrocell base station and the microcell base station all have a
circular area as shown in the following ﬁgure. The number of legal users in macrocell
and microcell are all single antenna users and each macro cell can cover M number of
Beamforming Design for Physical Layer Security
349

legitimate users, while the number of legitimate users can be N: A single antenna
eavesdropper is within the coverage of the macrocelland attempts to eavesdrop on the
nð1  n  NÞ microcell user located in the kð1  k  KÞ microcell. Assume that all
channels are independent of each other and subject to Rayleigh ﬂat fading. Figure 2 is
the multi-cell system model diagram of HetNet in this paper.
4
Optimization Algorithm Design
As can be seen from Fig. 2, the n-th legitimate user in the k-th microcell is listed as the
reference object. Therefore, the desired message signal comes from the micro base
station in the k-th microcell and the source of the interference includes other N  1
legitimate micro-cell users in the same microcell with the target legitimate user, all
ðk  1Þ  N legal microcell users in other k  1 microcells, M legitimate macrocell
users and eavesdropper in the macrocell. It is assumed that both the macro base station
and the micro base station can obtain a complete CSI.
Suppose there are K0ð1  K0  K  1Þ cooperative microcell base stations can use
CCI to interfere the eavesdroppers. Then according to the knowledge of information
theory, the received signal of the target legitimate user can be expressed as:
ykn ¼ hk;knwknskn
|ﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄ}
Useful signal
þ
X
N
a¼1
a6¼n
hk;knwkaska
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}
Interference signals of other
n1 users under the same microcell
þ
X
K
b¼1
b6¼k
X
N
c¼1
hb;knwbcsbc
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}
Interference from all ðk1Þn
microcell users under all other k1microcells
þ
X
M
m¼1
hknwmsm þ nkn
|ﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ{zﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄﬄ}
Interference from all
M macrocell users
ð1Þ
Target legitimate user
Micro-cell users
Eavesdropper
   
Macro cell users
Fig. 2. System model
350
W. Zhao et al.

Now the meaning of the variables in the formula is explained as follows:
Variable
Deﬁnition
hk;kn
The channel vector from the k-th microcell base station to the target legitimate
user
wkn
The beamforming vector for the target legitimate user
skn
The message signal intended for the target legitimate user; The essence of skn is a
normalized vector, Satisfying E
skn
k
k2


¼ 1
wka
The beamforming vector for other n  1 legitimate microcell users in the k-th
microcell
ska
The message signal intended from the k-th microcell base station to other n  1
legitimate microcell users in the k-th microcell
hb;kn
The channel vector from other k  1 microcell base stations to the target
legitimate user, b 6¼ k
wbc
The beamforming vector from other k  1 microcell base stations to the legitimate
microcell users inside
sbc
The message signal intended from other k  1 microcell base stations to the
legitimate microcell users inside
hkn
The channel vector from the macrocell base station to the target legitimate user
wm
The beamforming vector from the macrocell users to the target legitimate user
sm
The message signal intended from the macrocell base station to the target
legitimate user
nkn
nkn obeying i.i.d. CN  ð0; r2
MÞ
Similarly, the received signal at the eavesdropper is:
yE ¼ hEwknskn þ
X
N
a¼1
a6¼n
hn;Ewkaska þ
X
K
b¼1
b6¼k
X
N
c¼1
hb;kEwbcsbc þ
X
M
m¼1
hEwmsm þ nkn
ð2Þ
Suppose the user’s CSI is known, according to the deﬁnition of SINR, the SINR of
the target legitimate user is:
SINRkn ¼
hk;knwkn

2
P
N
a¼1
a6¼n
hk;knwka

2 þ P
K
b¼1
b6¼k
P
N
a¼1
hb;knwba

2 þ P
M
m¼1
hknwm
j
j2 þ r2
kn
ð3Þ
The SINR of the eavesdropper is:
SINRE ¼
hEwkn
j
j2
P
N
a¼1
a6¼n
hn;Ewka

2 þ P
K
b¼1
b6¼k
P
N
a¼1
hb;kEwba

2 þ P
M
m¼1
hEwm
j
j2 þ r2
E
ð4Þ
Beamforming Design for Physical Layer Security
351

Then, according to the deﬁnition of conﬁdential capacity, the conﬁdential capacity
of the target legitimate user is:
CS ¼ Ckn  CE ¼ B log2ð1 þ SINRknÞ  B log2ð1 þ SINREÞ
ð5Þ
According to the deﬁnition of security energy efﬁciency [12], the conﬁdential
energy efﬁciency of the target legal user can be obtained as:
JS ¼
CS
P þ P0
¼ B log2ð1 þ SINRknÞ  B log2ð1 þ SINREÞ
P þ P0
ð6Þ
In summary, the optimization problem of security energy-efﬁcient beamforming
can be summarizedas follows:
max
wm
f
gM
m¼10
wkn
f
gN
n¼1

K
k¼1
logð1 þ SINRknÞ  logð1 þ SINREÞ
P þ P0
ð7Þ
s:t:
X
M
m¼1
wm
k
k2  PM; m 2 ½1; M
ð8Þ
X
N
n¼1
wkn
k
k2  PP; n 2 ½1; N
ð9Þ
SINRm  cm
ð10Þ
SINRkn  ckn
ð11Þ
Next, we study the base station power optimization part.
The power ampliﬁer is an important device in wireless communication system, the
output power of which affects the transmission distance, thus affecting the entire
coverage of macrocell. At the same time the power ampliﬁer not only occupy a large
weight in the wireless network static energy consumption, but alsoplay an important
role in wireless network dynamic energy consumption. Therefore, from the base station
side, through a reasonable power allocation to adjust the transmit power of base sta-
tioncan reduce the energy efﬁciency of the whole system.
Now optimize base station energy consumption. From the above description, wo
can obtain the energy consumption of the system:
P ¼ PM
gM
þ
X
N
n¼1
Pn
P
gp
þ PC
ð12Þ
352
W. Zhao et al.

where PM, PP is the transmit power of the power ampliﬁer on the macrocell base station
and the microcell base station side respectively; gM, gp is the effectiveness of the power
ampliﬁer; PC is the total ﬁxed circuit loss of the entire system.
Taking the target legitimate user as an example, we can get the transmit power of
the macro base station as:
PM ¼
X
N
n¼1
X
K
k¼1
ðwmÞHEð skn
j
j2Þwm þ
X
M
m¼1
ðwmÞHEð skn
j
j2Þwm
¼
X
N
n¼1
X
K
k¼1
ðwmÞHwm þ
X
M
m¼1
ðwmÞHwm
ð13Þ
Similarly, the transmit power at the base station side is:
PP ¼
X
N
n¼1
X
K
k¼1
ðwknÞHwkn
ð14Þ
Through fractional programming, the above formula can be decomposed into the
external part and the internal part. The external function can eventually be derived as:
max
1 þ GðsÞ
1 þ s
s:t:
0  t  Tr(H1ÞPMmax
ð15Þ
It can be seen that an external function can be solved using a one-dimensional
linear search method. Among them, GðsÞ is the internal function and can be optimized
based on SDP optimization algorithm. The concrete optimization method is as follows:
max
wm
f
gM
m¼10
wkn
f
gN
n¼1

K
k¼1
TrðHmWmÞ
P
M
m¼1
TrðHmWmÞ þ P
N
n¼1
P
K
k¼1
TrðHn;mWknÞ
ð16Þ
s:t:
X
M
m¼1
TrðXmÞ  PM maxf
ð17Þ
X
N
n¼1
X
K
k¼1
TrðXknÞ  PP maxf
ð18Þ
TrðHmWmÞ  cm
X
M
q ¼ 1
q 6¼ m
TrðHmXqÞ þ
X
N
n¼1
X
K
k¼1
TrðHn;mXknÞ þ f
0
B
B
B
B
@
1
C
C
C
C
A
ð19Þ
Beamforming Design for Physical Layer Security
353

TrðHn;knXknÞ  ckn
X
K
t¼1
t6¼k
TrðHn;knXtnÞ þ
X
N
p¼1
p6¼n
X
K
t¼1
TrðHp;knXtpÞ þ
X
M
m¼1
TrðHknXmÞ þ f
0
B
B
@
1
C
C
A
ð20Þ
TrðHEX1Þ  s
X
M
m¼1
TrðHEXmÞ þ
X
N
n¼1
X
K
k¼1
TrðHn;EXknÞ þ f
 
!
ð21Þ
Where H ¼ hHh, W ¼ wHw, Wm ¼ Xm
f , Wkn ¼ Xkn
f and X is the default auxiliary
variable.
The optimization steps of the proposed algorithm can be summarized as follows:
5
Simulation Analysis
In the actual simulation, the number of antennas is deﬁned as follows: the antennas in
the macro base station is NM ¼ 10, in the micro base station is NP ¼ 4, and in the
macro cell is M ¼ 2,
That is a legitimate users for macro cell, and an eavesdropping users. The number
of legitimate microcell users in the microcell is K ¼ 1, which is a microcell contains
only one user. Otherwise, we also assuming that the number of the antenna in
macrocell and in microcell, including the legitimate user and eavesdropping user is
only one, and the channel of the system is Rayleigh fading channel. The simulation
results are as follows (Fig. 3):
354
W. Zhao et al.

The transmission power of the macro base station is not related to the cooperative
interference between the micro base stations. However, according to the proposed
algorithm, a signiﬁcant improvement in security energy efﬁciency can be obtained
(Fig. 4).
According to the simulation results, we can see that because of the cooperation
between the micro base stations:
1. The transmission power is too small when the transmit power of micro-base station
is less than 23 dbm, which leads to a large proportion of interference, therefore, it
has a great inﬂuence on the security energy efﬁciency, so the proposed algorithm is
slightly inferior to the traditional algorithm
35
36
37
38
39
40
41
42
43
44
45
3.2
3.4
3.6
3.8
4
4.2
4.4
4.6
4.8
5
5.2
The transmit power of macro base station(dbm)
The confidential energy effciency of macrocell user (bit/s/J)
The proposed algorithm
The traditional algorithm
Fig. 3. The comparison of the traditional algorithm and the proposed algorithm on the security
energy efﬁciency under different macro base station transmit power
20
22
24
26
28
30
32
34
36
38
40
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
The transmit power of micro base station(dbm)
The confidential energy effciency of microcell user (bit/s/J)
The proposed algorithm
The traditional algorithm
Fig. 4. The comparison of the traditional algorithm and the proposed algorithm on the security
energy efﬁciency under different Micro base station transmit power
Beamforming Design for Physical Layer Security
355

2. The proposed algorithm is better than the traditional algorithm when the transmit
power of micro-base station is exceed than 23 dbm. Because the transmitting power
of the base station is increasing constantly, but the interference power is invariable,
therefore, the curve is ascending.
Because of the presence of eavesdropping, the interference of the microcell
increases larger than the legitimate signal along with the increase in transmission power
at the macro base station, which causes the decreasing trend of SINR (Fig. 5).
Since the proposed algorithm is compromised optimization algorithm between
energy-efﬁcient and physical layer security, the resulting of beamforming vector W is
smaller than the case where energy efﬁciency is not considered, therefore, the SINR is
lower, but within an acceptable range (Fig. 6).
35
36
37
38
39
40
41
42
43
44
45
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
The transmit power of macro base station(dbm)
The SINR of microcell user
No energy efficient algorithm
The proposed algorithm
Fig. 5. Comparison of conventional algorithms and proposed algorithms in SINR at different
transmit powers of the macro base station
20
22
24
26
28
30
32
34
36
38
40
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
The transmit power of micro base station(dbm)
The SINR of microcell user
No energy efficient algorithm
The proposed algorithm
Fig. 6. Comparison of SINRs with traditional algorithms and proposed algorithms at different
micro base station transmit powers
356
W. Zhao et al.

Different from the macro base station, the interference can be used as a means to
interfering with the eavesdropping side. With the micro-base station transmission
power increases, the SINR of micro-cell users also increases. But considering the
energy efﬁciency and physical layer security, so the value is still slightly lower than the
algorithm which the energy efﬁciency is not considered. Simultaneously, we also to
know that with the cooperation of base stations between microcells and the effect of
interference in microcell is larger than macrocell.
6
Concluding Remarks
This paper analyzes the tradeoff between physical layer security and energy efﬁciency
of the legitimate users in HetNet. By using the CCI between cooperative micro-base
stations, a cooperative beamforming scheme which conforms to the system model is
designed; Combining the security rate of legitimate users in the microcell with the
system energy efﬁciency, and using the convex optimization theory to derive the
algorithm, a power allocation scheme is obtained. Finally, Simulation results show that,
in the view of different macro base stations and micro-base station transmit power, a
comparison chart between the traditional algorithm and the proposed algorithm is
given. The results show that the proposed algorithm has the advantage of improving
security and reducing energy consumption.
References
1. Zhang, H., Xing, H., Cheng, J., et al.: Secure resource allocation for OFDMA two-way relay
wireless sensor networks without and with cooperative jamming. IEEE Trans. Industr. Inf.
12(5), 1714–1725 (2016)
2. Zhao, J., Lu, Z., Wen, X., et al.: Resource management based on security satisfaction ratio
with fairness-aware in two-way relay networks. Int. J. Distrib. Sens. Netw. 11(7), 819195
(2015)
3. Zhang, H., Xing, H., Chu, X., et al.: Secure resource allocation for OFDMA two-way relay
networks. In: 2012 IEEE Global Communications Conference (GLOBECOM), pp. 3649–
3654. IEEE (2012)
4. Zhao, J., Zheng, W., Wen, X., Zhang, H., Lu, Z., Jing, W.: Research on the resource
allocation of OFDMA relay network based on secrecy ratio. J. Electr. Inf. Technol. 36(12),
2816–2821 (2014)
5. Zhang, H., Dong, Y., Cheng, J., et al.: Fronthauling for 5G LTE-U ultra dense cloud small
cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
6. Zhang, H., Liu, N., Chu, X., et al.: Network slicing based 5G and future mobile networks:
mobility, resource management, and challenges. IEEE Commun. Mag. (2017)
7. Venturino, L., Prasad, N., Wang, X.: Coordinated scheduling and power allocation in
downlink multicell OFDMA networks. IEEE Trans. Veh. Technol. 58(6), 2835–2848 (2009)
8. Karakayali, M.K., Foschini, G.J., Valenzuela, R.A.: Network coordination for spectrally
efﬁcient communications in cellular systems. IEEE Wirel. Commun. 13(4), 56–61 (2006)
9. Del Coso, A., Simoens, S.: Uplink rate region of a coordinated cellular network with
distributed compression. In: 2008 IEEE International Symposium on Information Theory,
pp. 2091–2095. IEEE (2008)
Beamforming Design for Physical Layer Security
357

10. Jiang, C., Zhang, H., Ren, Y., et al.: Energy-efﬁcient non-cooperative cognitive radio
networks: micro, meso, and macro views. IEEE Commun. Mag. 52(7), 14–20 (2014)
11. Shen, Y., Jiang, C., Quek, T.Q.S., et al.: Device-to-device cluster assisted downlink video
sharing—a base station energy saving approach. In: 2014 IEEE Global Conference on Signal
and Information Processing (GlobalSIP), pp. 108–112. IEEE (2014)
12. Liu, H., Zheng, W., Zhang, H., et al.: An iterative two-step algorithm for energy efﬁcient
resource allocation in multi-cell OFDMA networks. In: 2013 IEEE Wireless Communica-
tions and Networking Conference (WCNC), pp. 608–613. IEEE (2013)
358
W. Zhao et al.

A Survey on Big Data Analytics Technologies
Fei Su1(&), Zhenya Wang1, Shan Yang1, Ke Li1, Xin Lu1, Yang Wu1,
and Yi Peng2
1 China Unicom Network Technology Research Institute, Beijing, China
sufei@chinaunicom.cn
2 National Satellite Meteorological Center, Beijing, China
Abstract. With the beginning of new era, data has grown rapidly in both the
size and the variety. It becomes not only an important cornerstone of all walks of
life, but also the national strategy. The big data collection, parsing, analysis, and
applications are important issues to research. For different scenarios of big data
applications, appropriate big data processing technologies are needed to com-
plete the real-time and rapid data analysis. The objective of this paper is to
analyze the typical big data analysis technologies, ﬁnd out the characteristics
and applicative scenarios, and then provide the reference for big data processing
of all industries.
Keywords: Big data  Hadoop  Spark  NoSQL  Streaming  MPP database
1
Introduction
With the development of big data, a variety of data analysis technologies are arisen.
These technologies are different from the traditional methods of data statistics and data
mining. They have different characteristics and applicable scenarios. To research the
characteristics of big data technologies is a key step to the deployment of big data
strategy and data realization.
Traditional data warehouse architecture based on Oracle is no longer adapted to the
current needs of big data analysis [1]. The open source data analysis architecture is the
main stream. Currently, there are variety of big data analysis techniques [2]. Hadoop is
an open-source software framework for distributed storage and distributed processing
of very large data sets on computer clusters built from commodity hardware. All the
modules in Hadoop are designed with a fundamental assumption that hardware failures
are common and should be automatically handled by the framework. Spark is a fast and
general engine for large-scale data processing. Its performance is better than Hadoop,
because the calculation is processing in memory. Storm is a free and open source
distributed real-time computation system. Storm makes it easy to reliably process
unbounded streams of data, doing for real-time processing what Hadoop did for batch
processing. Spark Streaming is an extension of the core Spark API that enables scal-
able, high-throughput, fault-tolerant stream processing of live data streams. Data can be
ingested from many sources like Kafka, Flume, Twitter, ZeroMQ, Kinesis, or TCP
sockets. Impala (incubating) is the open source, native analytic database for Apache
Hadoop. HBase is an open-source, distributed, versioned, non-relational database
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 359–370, 2018.
https://doi.org/10.1007/978-3-319-72823-0_34

modeled after Google’s Bigtable: A Distributed Storage System for Structured Data by
Chang et al. Just as Bigtable leverages the distributed data storage provided by the
Google File System, Apache HBase provides Bigtable-like capabilities on top of
Hadoop and HDFS.
How to effectively combine these big data techniques, and achieve the data’s
parsing, storage, and analysis for different industries is an important issue to research.
The mainstream big data architecture usually adopts mixed style [3, 4]. Firstly, the
HDFS [5, 6] is used to carry out the underlying storage. Secondly, the MR/SPARK is
used to accomplish batch-processing. Finally, the resulting data set is stored in the
traditional relational database, such as oracle. In this paper, we analyze the typical big
data analysis technologies, ﬁnd out the characteristics and applicative scenarios, and
then provide the reference for big data processing of all industries.
2
Hadoop
Hadoop is an Apache open source framework written in java that allows distributed
processing of large datasets across clusters of computers using simple programming
models. As a result, we can easily write distributed programs which fully take
advantage of the cluster power to do the computing and storage work without knowing
the details of the lower-level of the distributed system. Compared with the other
systems, Hadoop has several advantages [7, 8] such as higher reliability, higher
extendibility, higher efﬁciency, higher fault-tolerance and lower cost, etc. (Fig. 1).
2.1
Hadoop Architecture
Hadoop framework mainly contains four modules:
• MapReduce is a YARN-based framework for parallel processing of large data sets
in a reliable manner.
Fig. 1. Hadoop base framework
Fig. 2. HDFS architecture [9]
360
F. Su et al.

• HDFS (Hadoop Distributed File System) is a distributed ﬁle system that provides
high-throughput access to application data.
• Hadoop Common contains Java libraries and utilities required by other Hadoop
modules. These libraries include OS level abstractions and necessary ﬁles and
scripts to start Hadoop.
• YARN is responsible for job scheduling and cluster resource management.
These four base modules provide base function of Hadoop system. We will focus
on the HDFS and MapReduce in this section.
2.2
HDFS
As one of the top-level project in the Hadoop eco-system, HDFS is the fundamental of
the distributed data storage system. It is based on the Google File System (GFS) and
provides a distributed ﬁle system that is designed to run on large clusters of small
computer machines in a reliable, fault-tolerant manner.
HDFS uses a master/slave architecture which is shown in Fig. 2. The master
machine runs a NameNode software and is responsible for the management of the ﬁle
system namespace and the regulation of the ﬁle access. The slave machines run a
DataNodes software and perform read-write operation on the ﬁle systems according to
the client requests, do block creation, deletion, and replication under the instructions of
the NameNode. We should notice that there is no practical difference between master
and slaver machines, they just run different software to perform different role in the
HDFS system.
A ﬁle in an HDFS namespace is split into several blocks and those blocks are stored
in a set of DataNodes. The NameNode determines the mapping of blocks to the
DataNodes. The DataNodes takes care of read and write operation with the ﬁle system.
They also take care of block creation, deletion and replication based on instruction
given by NameNode (Fig. 3).
2.3
MapReduce
In 2004, Google proposed MapReduce as a parallel computation model in order to
solve the calculation of the big data analysis problem. MapReduce module separates
Input
Data
Map()
Map()
Map()
Reduce()
Reduce()
Output
Data
Fig. 3. Map and Reduce stage
Distributed File System (HDFS, S3, etc.)
Cluster Resource Manager (YARN, Mesos, etc.)
Spark
Mllib
Streaming
SparkSQL
GraphX
Hadoop 
MapReduce
Hive
Fig. 4. Typical Spark deployment plan
A Survey on Big Data Analytics Technologies
361

the parallel computation process into two stage: Map task and Reduce task [10]. Firstly,
the set of data is collected and converts it into another set of data by map task. These
data elements are broken down into key and value pairs. Secondly, the task reduction
takes the output from a map as an input and combines those data tuples into a smaller
set of tuples. Typically both the input and the output are stored in a ﬁle-system. The
MapReduce framework takes care of scheduling tasks, monitoring them and
re-executes the failed tasks.
By adopting MapReduce technique, it is much eases to scale data processing over
multiple computing nodes: Decomposing a data processing application into mappers
and reducers is normally a time-consuming work. However, once we write an appli-
cation in the MapReduce form, scaling the application to run over hundreds, thousands,
or even tens of thousands of machines in a cluster is merely a conﬁguration change.
This simple scalability is what has attracted many programmers to use the MapReduce
model.
3
Spark
3.1
Spark Framework
Spark is an in-memory parallel computing framework which specialized in fast data
analyzing on large-scale dataset. Thanks to its highly active open-source community,
Spark contains several original libraries supporting structured data processing
(SparkSQL), machine learning (MLlib), streaming (Spark Streaming) and graph-parallel
computation (GraphX). It also supports various languages including Scala, Java, Python
and R. Spark was ﬁrst developed in UC Berkeley in 2009 and is currently hosted by
Apache Software Foundation with over 1000 contributors worldwide.
As a data processing framework, Spark extends the MapReduce model to handle
more complicated tasks, especially iterative computing and interactive analytics [11].
The former is commonly found in machine learning algorithms, and the latter is used in
SQL queries on large datasets. On the other hand, Spark inherits those good features
from the MapReduce model such as scalability and fault tolerance. As shown in Fig. 4,
Spark is compatible with some core components of the Hadoop ecosystem including
HDFS, Hive and YARN, making it one of the most universal data processing systems.
3.2
Spark Principles
The key abstraction used in Spark is called Resilient Distributed Dataset (RDD), which
is a collection of partitioned data stored in memory across the nodes in the cluster and
is able to be kept in memory for future reuse. A lineage mechanism is used to keep
track of the data transformations to recovery from failure. In the typical cluster mode, a
Spark application runs as the following procedures:
1. A SparkContext object is ﬁrst created in the driver program, which acts as the
controller of the entire application.
362
F. Su et al.

2. Next, the SparkContext contacts with the cluster resource manager, which assigns
all the cores, memory and network IO required by the application.
3. Once connected, Spark acquires Executors on each worker node, which are col-
lections of computation resources and the application code itself. Each application
has a set of its own Executors.
4. Finally, the SparkContext sends different Tasks to each Executor to run the actual
computation (Fig. 5).
The vanilla Spark supports more than 80 basic operators on RDDs, including map,
ﬁlter, union, join, groupByKey, reduceByKey, etc. On top of RDD, a higher level data
structure, DataFrame, is used in SparkSQL (and other modules as well) to deal with
structured data processing. A DataFrame is similar to a table in a relational database,
and can be created from either HDFS ﬁles or Hive tables. One can perform SQL
queries directly on DataFrames, making it much easier analyzing data stored in an
existing data platform. Likewise, Spark Streaming and MLlib also implement corre-
sponding high-level APIs for real-time and machine learning applications.
3.3
Performance
According to an early research, native Spark runs 25 faster than Hadoop MapReduce
on a Logistic Regression application. In another benchmark dealing with SQL queries,
SparkSQL is generally competitive with Impala, an in-memory MPP database built on
Hadoop [12]. Such result is remarkable considering Impala is written in C++ and is
well-optimized for SQL queries, whereas Spark is a general data processing engine and
runs in JVM. As for graph processing, Spark GraphX achieve a similar runtime per-
formance compared with GraphLab and Giraph, and slightly better scaling performance
than the latter two systems.
In general, Spark is a multi-functional data analyzing framework that excels in
speed, scalability and reliability. It is compatible with Hadoop system and runs much
faster than the MapReduce-based programs. Plus, Spark incorporates a series advanced
APIs which signiﬁcantly enhance the performance of big data applications such as
streaming, SQL queries, machine learning and graph analysis.
Fig. 6. Storm cluster architecture
Client
Driver Program
SparkContext
Cluster Manger
YARN, Mesos, etc
Executor
Executor
Worker Node
Executor
Task
Task
Task
Executor
Executor
Worker Node
Executor
Task
Task
Task
Fig. 5. Spark application running procedures
A Survey on Big Data Analytics Technologies
363

4
Stream
Streaming data as a new form of large data more reﬂects the characteristics of
high-speed and real-time processing. There are two ways to calculate large data: batch
computing and stream computing. Streaming data is disordered and ineffective, so you
can’t store all data as in batch computing model. In the stream computing, streaming
data is stored in memory for real-time computing. Existing streaming computing
platforms are Storm, Spark streaming, Samza and so on, which are open-source dis-
tributed systems, with low latency, scalability and fault tolerance and many other
advantages, allowing you to run the data stream code, tasks will be assigned to a series
of fault-tolerant nodes on the parallel operation.
4.1
Storm
Apache Storm is a free and open source distributed real-time computation system for
processing streams of data. Storm makes it easy to reliably process unbounded streams
of data, doing for real-time processing what Hadoop did for batch processing. A stream
is an unbounded sequence of tuples that is processed and created in parallel in a storm
cluster. Every stream is given an id when declared. The work to process stream is
delegated to different types of components that are each responsible for a simple
speciﬁc processing task.
The input stream of a Storm cluster is handled by a component called a spout [13].
A spout is a source of streams in a topology. Generally spouts will read tuples from an
external source and emit them into the topology. The spout passes the data to a
component called a bolt, which transforms it in some way. Storm guarantees that every
spout tuple will be fully processed by the topology. It does this by tracking the tree of
tuples triggered by every spout tuple and determining when that tree of tuples has been
successfully completed. Every topology has a “message timeout” associated with it. If
Storm fails to detect that a spout tuple has been completed within that timeout, then it
fails the tuple and replays it later.
A bolt either persists the data in some sort of storage, or passes it to some other bolt,
which can do anything from ﬁltering, functions, aggregations, joins, talking to data-
bases, and more. Bolts can do simple stream transformations, while doing complex
stream transformations often requires multiple steps and thus multiple bolts.
The logic for a real-time application is packaged into a Storm topology. A Storm
topology is analogous to a MapReduce job. One key difference is that a MapReduce
job eventually ﬁnishes, whereas a topology runs forever or until it is killed. A topology
is a graph of spouts and bolts that are connected with stream groupings.
As Fig. 6 shows, in a Storm cluster [14], nodes are organized into a master node
that runs continuously. There are two kind of nodes in a Storm cluster: master node and
worker nodes. Master node run a daemon called Nimbus, which is responsible for
distributing code around the cluster, assigning tasks to each worker node, and moni-
toring for failures. Worker nodes run a daemon called Supervisor, which executes a
portion of a topology. A topology in Storm runs across many worker nodes on different
machines. Since Storm keeps all cluster states either in Zookeeper or on local disk, the
daemons are stateless and can fail or restart without affecting the health of the system.
364
F. Su et al.

The following are the features of storm [15]:
• Fast: Storm can process up to 1 million tuples per second per node.
• Horizontally scalable: being fast is a necessary feature to build a high
volume/velocity data processing platform, but a single-node will have an upper
limit on the number of events that it can process per second. Storm is linearly
scalable. More nodes can be added to a Storm cluster to increase the processing
capacity of applications.
• Fault tolerant: units of work are executed by worker processes in a Storm cluster.
When a worker dies, Storm will restart that worker, and if the node on which the
worker is running dies, Storm will restart that worker on some other node in the
cluster.
• Guaranteed data processing: Storm provides strong guarantees that each message
passed on to it to process will be processed at least once. In the event of failures,
Storm will replay the lost tuples.
• Easy to operate: Storm is simple to deploy and manage. Once the cluster is
deployed, it requires little maintenance.
4.2
Spark Streaming
Spark Streaming is an extension of the core Spark API that enables scalable,
high-throughput, fault-tolerant stream processing of live data streams. Much like Spark
is built on the concept of RDDs, Spark Streaming provides an abstraction called
DStreams, which represents a continuous stream of data. Internally, each DStream is
represented as a sequence of RDDs arriving at each time step. DStream can be created
from various input sources, such as Flume [16], Kafka, HDFS, or by applying
high-level operations on other DStreams.
Spark Streaming uses a “micro-batch” architecture, where the streaming compu-
tation is treated as a continuous series of batch computations on small batches of data.
Spark Streaming receives data from various input sources and groups it into small
batches. New batches are created at regular time intervals. At the beginning of each
time interval a new batch is created. At the end of the time interval the batch is done
growing. The size of the time intervals is determined by a parameter called the batch
interval. The batch interval is typically between 500 ms and several seconds, as con-
ﬁgured by the application developer. Each input batch forms an RDD, and is processed
using Spark jobs to create other RDDs. The processed results are pushed out to external
systems in batches. The high-level architecture is shown in Fig. 7.
Fig. 7. Spark Streaming architecture
A Survey on Big Data Analytics Technologies
365

4.3
Samza
Apache Samza is a distributed stream processing framework. Samza processes streams,
which should be composed of immutable messages of a similar type or category.
A Samza job is code that performs a logical transformation on a set of input streams to
append output messages to set of output streams. In order to scale the throughput of the
stream processor, Samza chop streams and jobs up into smaller units of parallelism:
partitions and tasks.
Each partition in the stream is a totally ordered sequence of messages. Each
message in this sequence has an identiﬁer called the offset, which is unique per par-
tition. When a message is appended to a stream, it is appended to only one of the
stream’s partitions. The assignment of the message to its partition is done with a key
chosen by the writer.
The task is the unit of parallelism of the job, just as the partition is to the stream.
Each task consumes data from one partition for each of the job’s input streams. A task
processes messages from each of its input partitions sequentially, in the order of
message offset. There is no deﬁned ordering across partitions. This allows each task to
operate independently. The YARN scheduler assigns each task to a machine, so the job
as a whole can be distributed across many machines. The number of tasks in a job is
determined by the number of input partitions.
As shown in Fig. 8 Samza is made up of three layers: a streaming layer, an
execution layer, a processing layer. In streaming layer, it uses Apache Kafka for
messaging. Samza can better leverage Kafka’s unique architectural strengths. In exe-
cution layer, it uses Apache Hadoop YARN to provide fault tolerance, processor
isolation, security, and resource management. In processing layer, Samaza API provide
service. Both Samza’s execution and streaming layer are pluggable, and allow devel-
opers to implement alternatives if they prefer.
Samza uses YARN and Kafka to provide a framework for stage-wise stream
processing and partitioning. As shown in Fig. 9, everything put together, looks like this
(different colors indicate different host machines).
The Samza client talks to the YARN RM when it wants to start a new Samza job.
The YARN RM talks to a YARN NM to allocate space on the cluster for Samza’s
ApplicationMaster. Once the NM allocates space, it starts the Samza AM. After the
Samza AM starts, it asks the YARN RM for one or more YARN containers to run
SamzaContainers. Again, the RM works with NMs to allocate space for the containers.
Once the space has been allocated, the NMs start the Samza containers.
Fig. 8. Samza architecture
Fig. 9. Samza framework of yarn and kafka
366
F. Su et al.

The Samza client uses YARN to run a Samza job: YARN starts and supervises one
or more SamzaContainers, and users processing code runs inside those containers. The
input and output for the Samza StreamTasks come from Kafka brokers that are usually
co-located on the same machines as the YARN NMs.
Samza’s key features include:
• Managed state: Samza manages snapshotting and restoration of a stream proces-
sor’s state. When the processor is restarted, Samza restores its state to a consistent
snapshot. Samza can handle large amounts of state.
• Scalability: Samza is partitioned and distributed at every level. Kafka provides
ordered, partitioned, repayable, fault-tolerant streams. YARN provides a distributed
environment for Samza containers to run in.
• Fault tolerance: whenever a machine in the cluster fails, Samza works with YARN
to transparently migrate your tasks to another machine.
• Durability: Samza uses Kafka to guarantee that messages are processed in the order
they were written to a partition, and that no messages are ever lost.
• Processor isolation: Samza works with Apache YARN, which supports Hadoop’s
security model, and resource isolation through Linux CGroups (control groups).
• Pluggable: though Samza works out of the box with Kafka and YARN, Samza
provides a pluggable API that lets users run Samza with other messaging systems
and execution environments.
5
MPP Databases
Massive Parallel Processing (MPP) [17, 18] systems use share-nothing architecture
with different computing modules coupling loosely. Unlike some other systems, MPP
databases utilize a cluster of commercial x86 servers to achieve high performance, with
a speed 10x or even 100x greater than traditional databases. Data are typically stored
locally on each node and managed by a distributed ﬁle system. With a high compat-
ibility with SQL, the ability to scale out and fault tolerance, MPP databases offer a cost
efﬁcient solution to big data technology.
Most MPP databases are commercial products, including Teradata, Vertica,
Netezza, Amazon Redshift etc. Teradata targets high-end data warehouse and business
decision-making system. However, with a rapid development of cloud computing and
big data technology, the costly price of Teradata makes it less competitive today.
Vertica is a column-based MPP database which offers high-speed, high-scalability and
low-cost database technology. Netezza offers a warehouse solution, which combines
storage, processing, database and analysis into one system. It is suitable for customers
who intend to build high-level big data analysis with ready-to-use feature. As PB-level
database, Amazon Redshift can easily coordinate with existing BI system. It utilizes
columnar storage and data compression technology to enhance performance. Since
Redshift is fully hosted at Amazon’s cloud end, storage and computing resources can
be assigned dynamically. Greenplum is a distributed relational database focused on
A Survey on Big Data Analytics Technologies
367

OLAP data engine. It consists of several independent small databases. Greenplum has
been accepted as an open-source project by Apache Software Foundation and source
code is currently hosed on GitHub.
6
NoSQL
NoSQL means “Not Only SQL”, which generally refers to all non-relational databases.
It is developed to handle large-scale structured, semi-structured and non-structured data
brought by big data technology. NoSQL databases have several advantages such as
open-source, high scalability, high concurrency, high performance, weak-transactional,
and agility of development. In general, NoSQL databases can be categorized into four
types, which are Key-Value type, Document-Oriented type, Column-Family Type and
Graph type.
6.1
Key-Value
A Key-Value database is like a hash table used in many programming languages. One
speciﬁc key is combined with one pointer, which points to some certain data. Thus, the
key can be used to quickly add, query or delete data. Since data are accessed by a set of
keys, such systems are able to achieve a high performance and high scalability. Redis,
Memcached and other memory-based databases are normally used to in scenarios
where high-speed cache on “hot data” is needed.
6.2
Document-Oriented
Document-oriented database store data as documents. Each document contains a data
unit, which is a series of data collections. Each data unit contains a title and a corre-
sponding value, which is either simple data type or complex data type. The minimum
storage unit is a document. The document attribute stored in the same table can be
difﬁdent. Data can be stored as XML, JSON and JSONB, etc. MongoDB and CouchDB
are the common document-oriented databases.
6.3
Column-Family
Columnar storage databases store data in column families. Frequently queried data are
stored together in the same column family to handle massive data distributed on
different
machines.
Column-Family
databases
typically
store
structured
and
semi-structured data. With aggressive compression technology, queries on certain
columns have a great advantages on system IO. Cassandra, Hbase are the two major
Column-Family databases and are used in social media websites and blogs which
obtain a high volume of data in key-value type.
6.4
Graph-Oriented
Unlike other row-oriented or SQL-based databases, Graph-Oriented databases apply a
more agile graph model and are able to scale out to multiple servers [19, 20]. Such
368
F. Su et al.

systems store data in graph where entities are considered as vertices, and the relations
between entities are considered as edges [21–23]. The prevalent Graph-Oriented
database is Neo4J [24, 25], which is extremely suitable for strong-relationship data
such as recommendation engines.
7
Conclusion
This paper studies the typical big data analysis techniques, such as Hadoop, Spark,
Storm, MPP database, and NoSQL. These technologies all have their own application
scenarios. They are for batch processing, fast memory calculations, real-time com-
puting, fast OLAP, and unstructured data, respectively. The adoption of these tech-
nologies depend on different scenarios. We have put forth some of the challenges in big
data processing techniques and the areas where a lot of work can be done in future.
A lot of issues concerning data parsing and data sharing still remain challenging areas
of research in big data.
References
1. Jie, Z., Yao, X., Han, G.J.: A survey of recent technologies and challenges in big data
utilizations. In: International Conference on Information and Communication Technology
Convergence, pp. 497–499 (2015)
2. Menon, S.P., Hegde, N.P.: A survey of tools and applications in big data. In: 9th IEEE
International Conference on Intelligent Systems and Control, pp. 1–7 (2015)
3. Senbalci, C., Altuntas, S., Bozkus, Z.: Big data platform development with a domain speciﬁc
language
for
telecom
industries.
In:
High
Capacity
Optical
Networks
and
Emerging/Enabling Technologies, pp. 116–120 (2013)
4. Cho, S.Y.: Fast memory and storage architectures for the big data era. In: IEEE Asian
Solid-State Circuits Conference, pp. 1–4 (2015)
5. Tseng, J.-C., Tseng, H.C., Liu, C.W.: A successful application of big data storage techniques
implemented to criminal investigation for telecom. In: 2013 15th Asia-Paciﬁc Network
Operations and Management Symposium, pp. 25–27 (2013)
6. Zhang, X.X., Xu, F.: Survey of research on big data storage. In: International Symposium on
Distributed Computing and Applications to Business, Engineering & Science (DCABES),
pp. 76–80 (2013)
7. Yan, X., Zhang, D.: Big data research. Comput. Technol. Dev., 1–5 (2013)
8. Meng, X., Ci, X.: Big data management: concepts, technology and challenges. J. Comput.
Res. Dev. 50(1), 146–169 (2013)
9. Tan, X., Wang, H.: Big data analytics: competition and coexistence of RDBMS and
MapReduce. J. Softw. 23(1), 32–45 (2012)
10. Arun, M., Vinod, K.V.: Apache Hadoop YARN–Moving Beyond MapReduce and Batch
Processing with Apache Hadoop 2. Addison-Wesley Professional, Reading (2014)
11. Zaharia, M., Chowdhury, M., Franklin, M.J., Shenker, S., Stoica, I.: Spark: cluster
computing with working sets. In: Usenix Conference on Hot Topics in Cloud Computing,
vol. 15, p. 10. USENIX Association (2010)
A Survey on Big Data Analytics Technologies
369

12. Armbrust, M., Xin, R.S., Lian, C., Huai, Y., Liu, D., Bradley, J.K., Meng, X., Kaftan, T.,
Franklin, M.J., Ghodsi, A., Zaharia, M.: Spark SQL: relational data processing in spark. In:
ACM SIGMOD International Conference on Management of Data, pp. 1383–1394. ACM
(2015)
13. Leibiusky, J., Eisbruch, G., Simonassi, D.: Getting Started with Storm, pp. 29–37, 39–42.
O’Reilly Media, Sebastopol (2012)
14. Taylor Goetz, P., O’Neill, B.: Storm blueprints: patterns for distributed real-time
computation, pp. 36–37 (2014)
15. Jain, A., Nalya, A.: Learning Storm, pp. 8–9. Packt Publishing, Birmingham (2014)
16. Karau, H., Konwinski, A., Wendell, P., Zaharia, M.: Learning Spark, pp. 182–211. O’Reilly
Media, Sebastopol (2015)
17. Babu, S., Herodotou, H.: Massively parallel databases and MapReduce systems. Found.
Trends Databases 5(1), 1–104 (2012)
18. Cheng, B., Guan, X., Wu, H.: A hypergraph based task scheduling strategy for massive
parallel spatial data processing on master-slave platforms. In: 23rd International Conference
on Geoinformatics, pp. 1–5 (2015)
19. Xu, L., Luan, Y., Cheng, X., Cao, X., Chao, K., Gao, J., Jia, Y., Wang, S.: WCDMA data
based LTE site selection scheme in LTE deployment. In: International Conference on Signal
and Information Processing, Networking and Computers, Beijing, pp. 249–260. CRC Press
Taylor & Francis Group (2015)
20. Xu, L., Cheng, X., Liu, Y., Chen, W., Luan, Y., Chao, K., Yuan, M., Xu, B.: Mobility load
balancing aware radio resource allocation scheme for LTE-advanced cellular networks. In:
IEEE International Conference on Communication Technology, Hangzhou, pp. 806–812.
IEEE Press (2015)
21. Xu, L., Chen, Y., Chai, K.K., Luan, Y., Liu, D.: Cooperative mobility load balancing in
relay cellular networks. In: IEEE International Conference on Communication in China,
Xi’an, pp. 141–146. IEEE Press (2013)
22. Cao, Y., Sun, Z., Wang, N., Riaz, M., Cruickshank, H., Liu, X.: Geographic-based
spray-and-relay (GSaR): an efﬁcient routing scheme for DTNs. IEEE Trans. Veh. Technol.
64(4), 1548–1564 (2015)
23. Xu, L., Luan, Y., Cheng, X., Xing, H., Liu, Y., Jiang, X., Chen, W., Chao, K.:
Self-optimised joint trafﬁc ofﬂoading in heterogeneous cellular networks. In: IEEE
International Symposium on Communications and Information Technologies, Qingdao,
pp. 263–267. IEEE Press (2016)
24. Xu, L., Chen, Y., Gao, Y., Cuthbert, L.: A self-optimizing load balancing scheme for ﬁxed
relay cellular networks. In: IET International Conference on Communication Technology
and Application, Beijing, pp. 306–311. IET Press (2011)
25. Cao, Y., Wang, N., Sun, Z., Cruickshank, H.: A reliable and efﬁcient encounter-based
routing framework for delay/disruption tolerant networks. IEEE Sens. J. 15(7), 4004–4018
(2015)
370
F. Su et al.

Classiﬁcation of Medical Consultation Text
Using Mobile Agent System Based
on Naïve Bayes Classiﬁer
Xingyu Chen1,4(&), Guangping Zeng1,4, Qingchuan Zhang2,4,
Liu Chen1,4, and Zhuolin Wang3
1 School of Computer and Communication Engineering,
University of Science and Technology Beijing, Beijing, China
cscserer@sina.com, zgp@ustb.edu.cn, chenliueve@163.com
2 School of Computer and Information Engineering,
Beijing Technology and Business University, Beijing, China
zqc1982@126.com
3 School of Humanities and Social Science,
University of Science and Technology Beijing, Beijing, China
zhuolinwang@yeah.net
4 Beijing Key Laboratory of Knowledge Engineering for Materials Science,
Beijing, China
Abstract. Aiming at the interaction model of the Internet medical website, a
classiﬁer of medical text data based on Naive Bayes was proposed and realized
in this paper. Once a user posed questions on the websites, this classiﬁer would
instantly classify the user’s questions and enable accurate question delivery.
Furthermore, a data service platform was realized by taking advantages of
mobile agent technology. With the service platform, companies could avoid
considering the security of data when conducting data analysis. Finally,
experiments were conducted according to the process of data analysis in the
service platform. The experimental results showed: the proposed service plat-
form was feasible, and a medical consultation text classiﬁer with high accuracy
was realized to improve user experience of medical websites.
Keywords: Naive Bayes  Medical big data  Mobile agent
Artiﬁcial intelligence
1
Introduction
With the rapid development of the internet and the great enhancement of people’s
awareness of health, the internet is becoming an important channel to acquire medical
information. By posing questions on medical websites, persons can get answers by
professional doctors. After users having putting forward their questions, there would be
doctors online to browse those questions. They will answer questions belonging to their
special ﬁeld and give their suggestions. Because most medical websites adopt a Q&A
(Question and Answer) system with blackboard mechanism, the time effectiveness is
poor. Users have to wait for doctors to answer them, while doctors have to spend time
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 371–384, 2018.
https://doi.org/10.1007/978-3-319-72823-0_35

browsing questions and deciding which and what to answer. In order to improve the
experience for both users and doctors and increase the effectiveness of the system, data
mining methods based on medical big data can be taken to analyze question texts [1].
With these methods, questions would be pushed prior to the doctors who are most
likely to answer. Besides, users would be offered with reference materials before
getting replied.
Medical big data plays an important role in the ﬁeld of big data [2]. With the
popularity of the mobile medical, internet medical, automatic analysis detectors,
wearable devices, etc., all parties including patients, doctors, companies and the envi-
ronments are becoming direct creators of data, generating mass medical data every day.
Compared with big data of other ﬁelds, medical big data have almost covered all
the personal information of citizens, from the most private information of body and
disease to the information of personal property, accommodation, medical insurance and
so on. Therefore, when using medical big data, technical personnel should not only
consider about security requirements from companies, hospitals and other providers,
but also consider about the privacy of the data. Generally, there are two ways of
conducting big data analysis: the ﬁrst is that the companies which hold data provide
technical supporters with data to carry out data analysis; the second is that the technical
supporters appoint personnel to companies. In the ﬁrst way, technical supporters have
to insure the data security. In the second way, the results of data analysis are hard for
promotion to create greater value. Because of the disadvantages of the ways mentioned
above, what way should be taken to conduct data analysis has become a great concern
of the companies and the academia. A reasonable way can not only reduce the cost of
the enterprise, but also make the new technology produce more value.
In this paper, researchers have realized a text classiﬁer based on Naive Bayes model
with higher accuracy aiming at the process of the Q&A [3–5]. The classiﬁer can help to
quickly classify problem descriptions to different departments and to pre-diagnose the
problems. Furthermore, the authors have designed a data analysis process based on
mobile agent technology where a mobile agent data service platform has been realized
[6, 7]. This service platform can make use of the mobility and self-determination
characteristics of mobile agent. With this platform, the problems concerning the data
security would be solved to some degree. What’s more, the new data analysis tech-
nology would be used by more companies and clients.
2
Paper Preparation
2.1
Naïve Bayes
Naive Bayes classiﬁer model is a kind of simple probability classiﬁer applied in the
independence assumption Bayes theorem. It assumes that each features are not related,
depends on accurate natural probability models and enable to get very good classiﬁ-
cation effect in supervised learning sample sets. The classiﬁcation process shows as
follows:
(1) Using a dimensional feature vector X ¼ x1; x2;    ; xn
f
g to represent each data
sample, which separately describes n features A1; A2;    ; An of samples.
372
X. Chen et al.

(2) Assuming there are m classes C1; C2;    ; Cn. Given an unknown data sample X,
the classiﬁcation would predict that X belongs to the class with the Maximum a
Posteriori (MAP) under the condition X. In other words, Naive Bayes classiﬁ-
cation would allocate the unknown sample X to class Ci 1  i  m
ð
Þ, if and only if
P CijX
ð
Þ [ P CjjX


; j ¼ 1; 2;    ; m; j 6¼ i
ð1Þ
Class Ci which would enable the Maximum a Posteriori P CijX
ð
Þ is called the
Maximum a Posteriori Assumption. According to Bayes’ theorem,
P CijX
ð
Þ ¼ P XjCi
ð
ÞP Ci
ð
Þ
P X
ð Þ
ð2Þ
(3) Because P X
ð Þ is invariant, we just need to ensure the maximum P XjCi
ð
ÞP Ci
ð
Þ. If
the prior probability of class Ci is unknown, we generally assume that these
classes are equiprobable, which is P C1
ð
Þ ¼ P C2
ð
Þ ¼    ¼ P Cm
ð
Þ. Therefore, the
problem is converted to maximize P XjCi
ð
Þ. Otherwise, the prior probability of
class Ci would be calculated by P Ci
ð
Þ ¼ si=S, where si is the number of training
samples in class Ci while S is the total number of training samples.
(4) Given data sets with many features, we might cost too much to calculate P XjCi
ð
Þ.
In order to lower the cost, we could assume that each features of samples are
mutually of conditional independence, which means there is no dependency
among each features, then
P XjCi
ð
Þ ¼
Y
n
k¼1
P xkjCi
ð
Þ
ð3Þ
The probability P XjCi
ð
Þ can be estimated by training samples.
(5) This means that under the above independence assumptions, the conditional
distribution over the class variable C is
P CijX
ð
Þ ¼ P XjCi
ð
ÞP Ci
ð
Þ ¼ P Ci
ð
Þ
Y
n
k¼1
P xkjCi
ð
Þ
ð4Þ
And a Bayes classiﬁer, is the function that assigns a class label ^y ¼ Ci for some i
as follow
^y ¼ argmax
i2 1;...;m
f
g
P Ci
ð
Þ
Y
n
k¼1
P xkjCi
ð
Þ ¼ argmax
y
P y
ð Þ
Y
n
k¼1
P xkjy
ð
Þ
ð5Þ
A class’s prior may be calculated by assuming equiprobable classes, or by calcu-
lating an estimate for the class probability from the training set. To estimate the
parameters for a feature’s distribution, one must assume a distribution or generate
nonparametric models for the features from the training set [5]. The assumptions on
distributions of features are called the event model of the Naive Bayes classiﬁer.
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
373

2.2
Multinomial Event Model
With a multinomial event model [8], the distribution is parameterized by vectors
multinomial py ¼
py1; py2;    ; pyn


for each class y, where n is the number of features
(in text classiﬁcation, the size of the vocabulary) and pyi is the probability P xijy
ð
Þ of
feature i appearing in a sample belonging to class y.
The parameters py is estimated by a smoothed version of maximum likelihood, i.e.
relative frequency counting:
^pyi ¼ fyi þ a
fy þ na
ð6Þ
Where fyi is the eigenvalue of xi, and fy is the total count of all eigenvalue for
class y.
The smoothing priors a  0 accounts for features not present in the learning sam-
ples and prevents zero probabilities in further computations.
2.3
TF-IDF
TF-IDF (Term Frequency–Inverse Document Frequency) is a numerical statistic that is
intended to reﬂect how important a word is to a document in a collection or corpus [9].
It is often used as a weighting factor in information retrieval and text mining. The
TF-IDF value increases proportionally to the number of times that a word appears in
the document, but is offset by the frequency of the word in the corpus, which helps to
adjust for the fact that some words appear more frequently in general.
Term Frequency is the number of times that a term w occurs in a document d. If we
donate the number of times by count w; d
ð
Þ and the total number of word occurs in d by
size d
ð Þ, then
TF w; d
ð
Þ ¼ count w; d
ð
Þ
size d
ð Þ
ð7Þ
The inverse document frequency is a measure of how much information the word
provides, that is, whether the term is common or rare across all documents.
IDF w
ð Þ ¼ logð
n
docs w; D
ð
Þ þ 1Þ
ð8Þ
docs w; D
ð
Þ is the count of documents that contain the word w. If the term is not in
the corpus, this will lead to a division-by-zero. It is therefore common to adjust the
denominator to docs w; D
ð
Þ þ 1.
Then TFIDF w; d
ð
Þ is calculated as
TFIDF w; d
ð
Þ ¼ TF w; d
ð
Þ  IDF w
ð Þ
ð9Þ
374
X. Chen et al.

3
A Medical Consultation Text Classiﬁer Based
on Naive Bayes
With the rapid development on the Internet and the great enhancement on health
awareness, using fence netting is becoming an important way to acquire medical
information. People can put forward questions on medical websites and get answered
by professional doctors. Their questions are generally posed as describing a series of
symptoms to get disease diagnosed or seeking for notes and directions. For example,
(1) The cold is very afﬂictive wow! Rhinitis how should do?
(2) Darling 14 months, cold, have a fever, snorty, sleep to still be met shy, whats do
not eat, how to do?
Those questions would be checked and answered by professional doctors sooner or
later.
Through training analysis on the history Q&A data of medical websites, we have
developed a classiﬁcation method on medical consultation text – a smart consulting and
diagnosing classiﬁer. Once a user has submitted a question, this applied classiﬁer
would immediately deduce what possible disease the user wants to consult and which
department he should turn to. That’s to say, this classiﬁer can not only quickly provide
users with resources of related diseases, but also accurately recommend questions to
experts in related ﬁelds.
3.1
Data Analysis
The hierarchical structure diagram of original data is shown as Fig. 1.
DataBase
Pediatrics
surgical 
deparment
Internal 
Medicine
......
......
Oncology
......
......
......
......
Respiratory 
Medicine
Department of 
Nephrology
Cardiovas
-ology
Gastroent-
erology
......
......
......
......
......
......
Nasopharyngitis
Cough variant asthma
......
......
virus flu
Q&A
Q&A
Q&A
Q&A
Q&A
Q&A
......
......
......
......
......
......
Fig. 1. The ﬁrst layer is the total database. Each node of the second layer represents a
comprehensive department. Each node of the third layer represents a speciﬁc department. Each
node of the fourth ﬂoor represents a speciﬁc disease. Each node of the ﬁfth ﬂoor represents a
speciﬁc set of (Q&A).
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
375

According to requirements, we haven’t carried out data analysis on comprehensive
departments. It means that the nodes of the second layer have been excluded, and the
nodes of speciﬁc departments have directly connected to the root node.
Classifying users’ questions can be separated into two steps. The ﬁrst step is to
classify the departments corresponding to the questions. The second step is to classify
the diseases under the charge of the departments. In this way, the training of the
ﬁrst-step classiﬁer needs all the Q&A data, while the training of the second-step
classiﬁer just needs the Q&A data of a speciﬁc department. Therefore, the data sets
used by the second-step classiﬁer are the subsets of the ﬁrst-step classiﬁer. We have
taken a data set of a speciﬁc department as the sample data. By analyzing the data set,
we have implemented the function module which can ﬁgure out and generate classiﬁer.
3.2
Data Pre-processing
In order to develop a dependable classiﬁer, we have conducted data pre-processing
during which we have acquired the terminology library and set the stop words library.
Then we have conducted Chinese word segmentation and feature abstraction of text
keywords. The terminology library refers to all the words and terms related to the
medical ﬁeld, which are the basic medical knowledge, including names of diseases,
symptoms, body parts, medicines, and so on.
Setting up the terminology library makes contributions to better conducting Chi-
nese word segmentation. Nouns of this part can be obtained from websites such as
Medical Encyclopedia and Baidu Encyclopedia. Having considering that all the data of
hospital departments are needed to design the processes of training classiﬁers, we have
used web-crawler to access all the names of symptoms and diseases.
Setting up the appropriate stop words library can improve the accuracy of classiﬁer.
The speciﬁc operation is to identify the stop words library during feature abstraction of
text keywords. In this way, the words belonging to the stop words library would not be
included in the list of keywords. The stop words library contains words of high
occurrence frequencies but of no prior supports for classiﬁcation. Through sample data
analysis, we conclude that some words with special parts of speech are useless in
classiﬁcation, such as pronouns, conjunctions, idioms, punctuation marks. If we
identify these words as the stop words, the accuracy of our classiﬁcation would be
greatly improved.
The following pseudo-code describes how to access the appropriate stop words
library before data training.
The algorithm of dynamic access to the appropriate stop words library. Input:
D ¼ d1; d2;    ; dn
f
g, referring to the set of question text data; stopProperty ¼
p1; p2;    ; pk
f
g, referring to the set of parts of speech of stop words; Dictionary, referring
to the terminology library used in Chinese word segmentation. Output: stopWords ¼
w1; w2;    ; wm
f
g, referring to the stop words library applied to D.
376
X. Chen et al.

3.3
The Training Process of the Medical Consultation Text Classiﬁer
The training algorithm process of the classiﬁer based on Naive Bayes is as follows:
(1) Read out the Q&A data from database according to the classiﬁcation.
(2) Upload the terminology library and the stop words library;
(3) Carry out word segmentation to all the question data. Because Q&A data are all in
Chinese, Chinese word segmentation is needed;
(4) Calculate the TF-IDF eigenvector of the training data, and use an eigenvector to
represent a question;
(5) Divide data into training data sets and testing data sets;
(6) Use multinomial Naive Bayes classiﬁer model to get data training, and then get a
multinomial Naive Bayes classiﬁer based on TF-IDF;
(7) Use testing sets to test the accessed classiﬁer.
This algorithm is described as the following pseudo-code:
The
training
algorithm
of
the
classiﬁer
based
on
Naive
Bayes.
Input:
D ¼
d1; t1
ð
Þ; d2; t2
ð
Þ;    ; dn; tn
ð
Þ
f
g, referring to the set of question text data with class
identiﬁers; stopWords ¼ w1; w2;    ; wm
f
g, referring to the stop words library;
Dictionary, referring to the terminology library used in Chinese word segmentation.
Output: CLF, referring to the classiﬁer; precision, referring to the accuracy of its tests.
begin
D = readTrainData()
stopProperty = readStopProperty()
Tool.load(Dictionary) 
stopWords = emptyList()
wordPropertyListD = Tool.cut(D) 
foreach doc in wordPropertyListD
foreach (word, prop) in doc
if prop in stopProperty then
stopWords.append(word) 
return stopWords
end
begin
D = readData ()
stopWords = readStopWords()
Tool.load(Dictionary) 
docs = Tool. chineseSplit(D) 
vec = vectorizer(docs, stopWords) 
(dataTrain, dataTest) = dataDivide(vec) 
CLF = MultinomialNB(dataTrain) 
precision = Test(CLF, dataTest)
return CLF, precision
end
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
377

4
The Design of Medical Big Data Service Platform Based
on Agent
With the application of mobile agent technology, the design of big data service plat-
forms can better solve the security and privacy problems of data. A mobile agent is a
program substituting for people or other program to perform certain tasks. It can move
from a mobile agent environment (MAE) to another in the complex and heterogeneous
network system. It can choose when and where to move to search for appropriate
resources. It can be suspended according to requirements, and then restart or continue
to execute. It also can take the advantage of being in the same host as the resources –
processing or using these resources nearby, accomplishing speciﬁc tasks and returning
results and messages in the end.
Mobility and autonomy are the two important characteristics of mobile agent. These
two characteristics can be used to design a new solution which makes efﬁcient use of
distributed resources and the network.
A mobile agent system is made up of mobile agent and mobile agent service
environment (the mobile agent platform). A common agent includes the security ser-
vice module, environment interaction module, function library, internal state set, the
routing policy, constraint condition and the task solving module, and these structures
are mutually related. Generally, a mobile agent carries tasks, while the task solving
module ﬁnally executes these tasks. During solving process, the task solving module
should satisfy the constraint condition assigned by the builder.
4.1
The System Structure of the Medical Big Data Service Platform
The service platform in this paper is designed based on traditional mobile agent
platform, and its system structure is shown as the following Fig. 2.
Fig. 2. The system structure of an agent platform is mainly made up of the following parts:
message agent, management agent, task agent, function library and basic service module.
378
X. Chen et al.

Message agent: in charge of receiving and sending messages between the platform
and the outside, including: ①interacting with clients; ②receiving and sending
messages of other agent platforms and task agent. The massage agent is only
responsible for the interaction with the outside, while the management agent is
responsible for understanding and processing messages.
Management agent: in charge of decision-making of the platform, including: ①
setting up task agent by visiting function library; ②scheduling task agent, including
executing and dispatching; ③understanding and processing mutual information of
message agent; ④informing message agent to send messages or task agent to the outside.
Task agent: in charge of conducting speciﬁc tasks.
Function library: in charge of ①forming function modules; ②storing achievable
and speciﬁc functions of task agent for management agent to schedule. The management
agent can combine several function modules as a task solving module of the task agent.
Basic service module: in charge of providing necessary and basic service including
directory services and security services.
The system structure of Client’s agent platform and the data service platform are
basically the same, but their difference lies in whether the function libraries of master
station provide more function or not.
4.2
The Working Process of the Medical Big Data Service Platform
The working process is shown as the following Fig. 3.
1.6runTask()
Client
Developer
UserMAS
ServerMAS
1.1request()
1.2lookup()
1.3return()
1.4select()
1.5sendMA()
1.7return()
2.1request()
2.2request WithData()
2.5sendMA()
2.3sendData()
2.4addFunction()
2.6runTask()
2.7return()
Fig. 3. Sequence diagram of working process on the medical big data service platform.
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
379

When Client need to take data analysis, he can conduct normal request procedure:
Choose an existing function module of the service platform via his agent platform. The
service platform only needs to put this function module into a task agent and then
remove the task agent to the client’s mobile agent platform. At last, practical data
analysis and work would be accomplished.
If there is no suitable function module in the service platform, or if the client asks
for special designing, technical personnel would write new function models according
to the requirements of the client, as long as sample data and knowledge of the problem
domain are given.
After accomplishing task solving, the task agent would return to service platform
with results or execute operations such as instant death. Operations are determined by
customer requirements and the speciﬁc situation.
5
The Experiment
5.1
Experimental Design
During the experiment, two computers with Linux system have been used to conduct
the experiment. Consult texts provided by a large-scale Chinese medical consultation
website have been taken as experimental examples. According to the provided data, the
amount of texts reached 64060, related to 44 departments and 4801 kinds of diseases.
Among them, 3950 kinds of diseases of 42 departments have texts under the catalogue.
The 1553 texts of respiratory medicine department have been taken as sample data.
The classiﬁcation experiment of sample data was conducted in a PC applied with
mobile agent. Witha multinomial NaiveBayes classiﬁer based onTF-IDF, the conductors
have taken the 1553 texts of respiratory medicine department as the data of the tuning
model. During the experiment, conductors adopted the way of 10-fold cross-validation to
get the accuracy of classiﬁcation. Considering that the order of the data may affect the
resultoftheclassiﬁcationandthatthecross-validationondatasegmentationisrandom,the
average value of experiments have been used as the ﬁnal result.
Sample data were used for parameter tuning of the generative process of the classi-
ﬁcation model. This process would be encapsulated into a task agent after the experiment
and parameter tuning. Then, another platform turned to the service platform for the task
agent, used 64060 Q&A texts for training and tested them by 10-fold cross-validation.
With the above, the average value of experiments represented the ﬁnal result.
5.2
Comparative Experiment
In order to validate the dialectical ability of the algorithm we used in the data set
provided by the enterprise, several mature classiﬁcation algorithms were selected to
participate in testing experiments in this section. Using the classiﬁcation results of all
the data, we have compares the classiﬁcation performances [10–14].
Here listed are the algorithms involved in the experiment:
(1) Decision Tree Algorithm [15]
(2) Random Forest Algorithm [16]
380
X. Chen et al.

(3) k-Nearest Neighbor (KNN) [17]
(4) Support Vector Machine (SVM) [18]
(5) Naive Bayes with Multinomial event model using TF feature (MultinomialNB_TF)
(6) Naive Bayes with Bernoulli event model using TF-IDF feature (BernoulliNB)
(7) Naive
Bayes
with
Multinomial
event
model
using
TF-IDF
feature
(MultinomialNB_TFIDF)
KNN algorithm has a key parameter k value need to be selected. The k value is the
empirical parameter, which indicates the number of the selected neighbours. The
selection of its value has a signiﬁcant effect on the classiﬁcation performance. In the
experiment, the optimal value of k is not determined. We conducted the experiment
using 1 to 20 as the k value, ﬁnding that with the k value increasing, the classiﬁcation
performance decrease. So we choose 1 as the k value.
During the whole experiment, the author used the same Chinese word segmentation
tools, terminology library and stop word library.
5.3
The Classiﬁcation Result
We have conducted 10-fold cross-validation many times on the sample data, expecting
to get the comparatively stable process of generating the classiﬁer. The results of the 5
times classiﬁcation of respiration medicine department are shown as the following
Table 1.
The classiﬁcation results of all the data are shown as the following Table 2.
Table 1. The results of the 5 times classiﬁcation of respiration medicine department
1
2
3
4
5
6
7
8
9
10
Mean
1 86.5 82.7 86.5 83.2 88.4 88.4 88.4 87.7 89.0 87.1 86.8
2 87.8 87.8 81.4 85.2 87.1 89.0 86.5 87.7 85.8 87.7 86.6
3 89.1 89.1 87.2 86.5 85.8 90.3 84.5 87.1 86.5 90.3 87.6
4 90.4 88.5 87.8 82.6 84.5 83.9 89.7 89.7 89.0 88.4 87.5
5 88.5 82.1 86.5 85.8 87.1 84.5 90.3 85.2 87.7 84.5 86.2
Final result: 86.9%.
Table 2. The classiﬁcation results of all the data
1
2
3
4
5
6
7
8
9
10
Mean
1 86.4 86.0 85.0 86.2 85.8 85.2 86.2 85.4 86.0 85.6 85.8
2 86.0 85.7 86.8 85.8 85.5 86.0 85.2 86.2 85.3 86.0 85.9
3 85.5 85.6 86.3 85.9 85.8 85.7 86.6 85.9 86.2 85.2 85.9
4 86.2 85.2 85.8 86.2 85.4 85.7 84.9 86.0 86.3 85.9 85.8
5 85.5 85.5 85.4 86.1 86.3 85.5 85.5 85.5 86.5 85.3 85.7
Final result: 85.8%.
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
381

The results of pre-diagnosing diseases under each department are shown as the
following Fig. 4.
The experimental results of the comparative test are shown as following Fig. 5.
5.4
Experiment Analysis
The experiments above were carried out according to the data analysis process of the
companies in the service platform. The results of the experiment can prove that the
mobile agent data service platform proposed and implemented in this paper is feasible.
First of all, the data in Table 1 show that we have a classiﬁer with the accuracy at
86.9% when experimenting with data from the Department of Respiratory Medicine.
The data in Table 2 show that we can get a classiﬁer with the accuracy at 85.8% for all
data. These number means when the user publishes a new medical consultation
question, the system will recommend the text to the doctors. There are average sev-
enteen recommendations which are successful in twenty, other three recommendations
need to be manually marked and re-pushed. And there are average ﬁfteen people in
Fig. 4. The results of pre-diagnosing diseases under each department.
Fig. 5. The experimental results of the comparative test.
382
X. Chen et al.

twenty will get the right information as soon as possible, other ﬁve will get help after
the question is reposted. And eventually they will get the guidance of doctors.
Secondly, by using the method of classiﬁer generation for text classiﬁcation in each
department, the average classiﬁcation accuracy is 87.7%.
At the last, through the comparison experiment, we can ﬁgure out that the Naive
Bayesian algorithm using TF-IFD characteristic polynomial in this paper has good
accuracy in the general data set. But through the comparison of the sample data, the
accuracy rate of Decision Tree is as high as 92.9%, which indicates that Decision Tree
is more accurate than Naive Bayes algorithm in pre-diagnosing disease under speciﬁed
department. In order to conﬁrm the conclusion, this paper uses Decision Tree to
classify diseases in all departments. Result shows the average accuracy rate of Decision
Tree algorithm is 93.1%. With the conclusion, those two algorithms can be combined
to pre-diagnosing disease to get better performances.
6
Conclusion
The research of this paper is focused on the current research hotspot – medical big data.
First of all, for the purpose of optimizing the user experience on the interaction process
of this kind of websites, researchers have made deep understanding on a famous
large-scale medical consultation website, and have conducted data analysis with the
historical data. Secondly, with the analysis results, a classiﬁer of medical text data
based on Naive Bayes was proposed and realized to ﬁnd out valuable medical logic
knowledge. In addition, in order to meet the requirement for data conﬁdentiality when
doing outsourcing data analysis and to maximize the values of technology or models
from data analysis, this paper has carried on the discussion on the issue. Finally, a
prototype systems of data analysis service platform has been designed and realized
using mobile agent technology based on Naive Bayes medical text classiﬁer.
Through experiment and analysis, we have validated that the classiﬁer based on the
Naive Bayes can realize better classiﬁcation of medical consultation texts and stability
compared with other algorithms. Moreover, Decision Tree can better pre-diagnose the
questions. The two algorithms can be combined to pre-diagnosing disease to get better
performances in the reality.
Acknowledgements. Our work was supported by National High-tech R&D Program (863
Program No. 2015AA015403).
References
1. Russel, S.J., Norvig, P.: Artiﬁcial Intelligence - A Modern Approach. Prentice Hall, Upper
Saddle River (2003)
2. Jee, K., Kim, G.H.: Potentiality of big data in the medical sector: focus on how to reshape the
healthcare system. Healthc. Inf. Res. 19(2), 79–85 (2013)
3. Zhang, H.: The optimality of Naive Bayes. In: Seventeenth International Florida Artiﬁcial
Intelligence Research Society Conference, Miami Beach, Florida, USA (2005)
Classiﬁcation of Medical Consultation Text Using Mobile Agent System
383

4. Metsis, V., Androutsopoulos, I., Paliouras, G.: Spam ﬁltering with Naive Bayes - which
Naive Bayes? In: CEAS 2006 - The Third Conference on Email and Anti-Spam, Mountain
View, California, USA, 27–28 July 2006
5. John, G.H., Langley, P.: Estimating continuous distributions in Bayesian classiﬁers,
pp. 338–345 (2013)
6. Essa, Y.M., Attiya, G., El-Sayed, A.: New framework for improving big data analysis using
mobile agent. Int. J. Adv. Comput. Sci. Appl. 5(3), 25–32 (2014)
7. Gray, R.S., Cybenko, G.: Agent TCL: a ﬂexible and secure mobile-agent system. In:
Proceedings of the 1996 TCL/TK Workshop, pp. 9–23 (1999)
8. Jin, X., Zhou, W., Bie, R.: Multinomial event naive Bayesian modeling for SAGE data
classiﬁcation. Comput. Stat. 22(1), 133–143 (2007)
9. Robertson, S.: Understanding inverse document frequency: on theoretical arguments for
IDF. J. Doc. 60(5), 503–520 (2004)
10. Baker, L.D., McCallum, A.K.: Distributional clustering of words for text classiﬁcation. In:
International ACM SIGIR Conference on Research and Development in Information
Retrieval, pp. 96–103 (2003)
11. Rogati, M., Yang, Y.: High-performing feature selection for text classiﬁcation (2003)
12. Tong, S., Koller, D.: Support vector machine active learning with applications to text
classiﬁcation. J. Mach. Learn. Res. 2(1), 45–66 (2002)
13. McCallum, A., Nigam, K.: A comparison of event models for Naive Bayes text
classiﬁcation. In: AAAI 1998 Workshop on Learning for Text Categorization, vol. 62(2),
pp. 41–48 (2001)
14. Nigam, K.: Using maximum entropy for text classiﬁcation. In: IJCAI 1999 Workshop on
Machine Learning for Information Filtering, pp. 61–67 (1999)
15. Saad, M.K., Ashour, W.: Arabic text classiﬁcation using decision trees. In: International
Workshop on Computer Science and Information Technologies, CSIT 2010 (2010)
16. Bouaziz, A., Dartigues-Pallez, C., da Costa Pereira, C., Precioso, F., Lloret, P.: Short text
classiﬁcation using semantic random forest. In: Bellatreche, L., Mohania, M.K. (eds.)
DaWaK 2014. LNCS, vol. 8646, pp. 288–299. Springer, Cham (2014). https://doi.org/10.
1007/978-3-319-10160-6_26
17. Han, E.-H., Karypis, G., Kumar, V.: Text categorization using weight adjusted k-nearest
neighbor classiﬁcation. In: Cheung, D., Williams, G.J., Li, Q. (eds.) PAKDD 2001. LNCS
(LNAI), vol. 2035, pp. 53–65. Springer, Heidelberg (2001). https://doi.org/10.1007/3-540-
45357-1_9
18. Colas, F., Brazdil, P.: Comparison of SVM and some older classiﬁcation algorithms in text
classiﬁcation tasks. In: Bramer, M. (ed.) Artiﬁcial Intelligence in Theory and Practice.
IFIP AICT, vol. 217, pp. 169–178. Springer, Boston (2006). https://doi.org/10.1007/978-0-
387-34747-9_18
384
X. Chen et al.

Low-Complexity MMSE Signal Detection
Based on the AOR Iterative Algorithm
for Uplink Massive MIMO Systems
Zhenyu Zhang1, Yuanyuan Dong1, Zhongshan Zhang1,
Xiyuan Wang1, Xiaoming Dai1(&), Linglong Dai2,
and Haijun Zhang1
1 University of Science and Technology Beijing, Beijing 100083, China
daixiaoming@ustb.edu.cn
2 Tsinghua University, Beijing 100084, China
Abstract. Massive multiple-input multiple-output (MIMO) systems can sub-
stantially improve the spectral efﬁciency and system capacity by equipping a
large number of antennas at the base station and it is envisaged to be one of the
critical technologies in the next generation of wireless communication systems.
However, the computational complexity of the signal detection in massive
MIMO systems presents a signiﬁcant challenge for practical hardware imple-
mentations. This work proposed a novel minimum mean square error (MMSE)
signal detection method based on the accelerated overrelaxation (AOR) iterative
algorithm. The proposed AOR-based method can reduce the overall complexity
of the classical MMSE signal detection by an order of magnitude from O K3
ð
Þ to
O K2
ð
Þ, where K is the number of users. Numerical results illustrate that the
proposed AOR-based algorithm can outperform the performance of the recently
proposed Neumann series approximation-based algorithm and approach the
conventional MMSE signal detection involving exact matrix inversion with
signiﬁcantly reduced complexity.
Keywords: Accelerated overrelaxation (AOR)  Iterative algorithm
Minimum mean square error (MMSE)  Convergence  Complexity
1
Introduction
Multiple-input multiple-output (MIMO) is widely acknowledged as a key technology
for the fourth generation (4G) wireless communication systems [1, 2] due to the high
diversity gain and system channel capacity. However, the exponential increase of
mobile data trafﬁc enabled by the wide proliferation of smartphones and tablet com-
puters poses great challenges for the current 4G systems [3]. Massive MIMO systems
which scale up the antennas at the base station (BS) by orders of magnitude contrasted
to the current systems (e.g., 4 or 8 antennas in 4G system) [4] can serve multi-users on
the same frequency band simultaneously [5]. Many research show that the large-scale
antennas at the BS can effectively average out non-coherent interference and system
noise. Massive MIMO system with large-scale antennas achieve signiﬁcant enhance-
ments in terms of spectral efﬁciency, multiplexing gains, and robustness compared to
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 385–394, 2018.
https://doi.org/10.1007/978-3-319-72823-0_36

the conventional MIMO systems [6], and it is envisaged to be the promising critical
technology in the ﬁfth generation (5G) wireless communication systems [7].
However, the promised gains on the multiplexing capability of massive MIMO
systems come at the cost of the signiﬁcant increase in signal detection complexity at
both sides of the wireless communication links [1]. The optimal signal detection in
MIMO systems is maximum likelihood (ML) signal detection in which the complexity
increases exponentially with the number of transmitting antennas, which imposes an
insurmountable cost for practical implementation in the massive MIMO systems [8].
The sphere decoding (SD) [9] can be utilized to simplify the hardware implementation
of the ML signal detection; however, the complexity changes along with the channel
condition and it is still quite high if the modulation order and/or the number of
transmitting antennas is high. The K-best algorithm [10] with ﬁxed complexity is also a
popular method to simplify the ML detection, but the linear relationship between the
critical path length and the number of antennas poses serious challenges for the
large-scale MIMO systems. The linear signal detection such as the minimum mean
square error (MMSE) signal detection [1] is utilized in massive MIMO systems to trade
off the complexity and reliability; however, it incurs a complex matrix inversion
operation whose complexity is immense especially for the large dimension of antennas.
The Neumann series (NS) approximation-based algorithm has been proposed recently
in [11, 12] to alleviate the complex matrix inversion operation in traditional MMSE
signal detection, in which algorithm transforms the matrix inversion into a series of the
matrix-vector multiplications and additions. However, the bit error ratio (BER) per-
formance is unsatisfactory with small iteration numbers when the dimension of
antennas is moderately large. Furthermore, the large iteration numbers incur even
higher computational complexity compared to the classical MMSE signal detection.
Hence, it is highly desirable to design low-complexity high-performance signal
detection schemes that deliver acceptable BER performance and scale favorably to the
high-dimensional signal detection problems.
In this paper, we propose a novel MMSE signal detection method based on the
accelerated overrelaxation (AOR) iterative algorithm [13] for uplink massive MIMO
systems. The proposed detection scheme reconstructs the transmitted signal without the
complicated matrix inversion via an iterative operation. The symmetric positive deﬁnite
property of the MMSE ﬁltering matrix is amenable to the AOR-based approach. We
provide a mathematical model of the AOR-based MMSE signal detection with a
convergence and complexity analysis. Numerical results show that the proposed
AOR-based algorithm can approach the BER performance of the classical MMSE
method in a few iterations and outperform the NS-based approach with signiﬁcantly
reduced complexity.
The rest of the paper is structured as follows. In Sect. 2, the system model of the
uplink massive MIMO system is described. In Sect. 3, the low-complexity MMSE
signal detection based on the AOR iterative algorithm for uplink massive MIMO
system is proposed. The convergence and complexity analysis are presented in the
same section. In Sect. 4, the numerical results of the BER performance is speciﬁed.
Finally, conclusions are drawn in Sect. 5.
386
Z. Zhang et al.

Notation: Throughout the paper, upper-case boldface letters S and lower-case boldface
letters s denote matrices and vectors, respectively; S1, ST and SH refer to the matrix
inversion, matrix transpose, and matrix conjugate transpose, respectively; O ð Þ and
E f g stand for the order of complexity and the expectation, respectively; = s
f g and
< s
f g represent the imaginary part and real part of the complex number, respectively; si
denotes the ith element of s; si;j denotes the ith row and jth column entry of matrix S;
Finally, IK is the K  K identity matrix.
2
System Model
Consider a representative uplink multi-user massive MIMO system consisting of N
antennas at the BS to serve K single-antenna users simultaneously [1], in which we
normally have N  K. The transmitted encoded and interleaved bit streams are
mapped to symbols by taking values from an energy-normalized quadrature amplitude
modulation (QAM) constellation.
Let xc 2 CK1 denotes the complex-valued transmitted signal vector. The entries of
the Rayleigh ﬂat fading channel Hc 2 CNK are independently and identically (i.i.d.)
distributed and follow the complex Gaussian distribution CN 0; 1
ð
Þ with zero mean and
unit variance. nc 2 CN1 represents the additive white Gaussian noise (AWGN) vector
whose entries are i.i.d. and follow the distribution CN 0; r2
ð
Þ. yc 2 CN1 denotes the
received signal vector at the BS. Then the complex-valued uplink system model can be
expressed as
yc ¼ Hcxc þ nc:
ð1Þ
For ease of representation, the complex-valued model can be converted into a
corresponding real-valued one as
< yc
f
g
= yc
f
g


¼
< Hc
f
g
= Hc
f
g
= Hc
f
g
< Hc
f
g


< xc
f
g
= xc
f
g


þ
< nc
f
g
= nc
f
g


:
ð2Þ
Then the real-valued uplink system model can be described as
y ¼ Hx þ n:
ð3Þ
We assume the channel state information matrix H is known perfectly by receiver
via the assigned training sequence [14, 15]. Then the transmitted signal can be
reconstructed by the MMSE signal detector as
^x ¼ HHH þ r2I2K

1HHy ¼ W1^y;
ð4Þ
where ^x is the reconstructed signal vector, W ¼ HHH þ r2I2K represents the MMSE
ﬁltering matrix with a size of 2K  2K, and ^y ¼ HHy denotes the matched-ﬁlter output
Low-Complexity MMSE Signal Detection
387

of y. It should be noted that the W1 operation requires cubic computational com-
plexity O K3
ð
Þ and it is extremely high for the massive MIMO systems.
3
Proposed Low-Complexity MMSE Signal Detection
Method
3.1
MMSE Signal Detection Based on the AOR Iterative Algorithm
Unlike the conventional MIMO systems, things that were random before and now start
to look deterministic in large-scale MIMO systems [1]. Owing to the fact that the
column vectors of H are asymptotically orthogonal [1], it is obvious that the MMSE
ﬁltering matrix W is symmetric positive deﬁnite in uplink massive MIMO systems.
This property inspires us to employ the AOR iterative algorithm to solve (4). The AOR
iterative algorithm [13] is a classical iterative scheme for the numerical solution of the
linear system ^x ¼ W1^y. Splitting W as W ¼ D  U  L, where D denotes the
diagonal element of W, U and L represent the negative of the strictly upper and lower
triangular element of W, respectively. Then the transmitted signal reconstructs by the
AOR scheme can be denoted as
^x n
ð Þ ¼ D  rL
ð
Þ1
1  x
ð
ÞD þ x  r
ð
ÞL þ xU
½
^x n1
ð
Þ þ x^y
n
o
;
ð5Þ
where the coefﬁcient x and r represent the relaxation parameter and the acceleration
parameter, respectively; and the superscript n denotes the iteration number. The initial
iteration ^x 0
ð Þ is set as a zero vector and the notation Lr;x ¼ D  rL
ð
Þ1 1  x
ð
ÞD þ
½
x  r
ð
ÞL þ xU denotes the iterative matrix.
3.2
Convergence Analysis
For uplink massive MIMO systems, the necessary and sufﬁcient condition for the
AOR-based MMSE signal detection algorithm being convergent is q Lr;x


\1 [16],
where the notation q Lr;x


denotes the spectral radius of the iterative matrix Lr;x. The
spectral radius is deﬁned as q Lr;x


¼ max kr;x

, where kr;x is the eigenvalue of Lr;x.
Then the convergence condition for the AOR iterative algorithm can be given as
follows [17, 18]
1
ð Þ 0 \ x  r \ 2
2
ð Þ 0 \ r \ x \ 2 mink0;1  0


3
ð Þ max 0; x þ 2  x
mink0;1


\ r \ x \ 2 min k0;1 \ 0


;
ð6Þ
where min k0;1 denotes the minimum eigenvalue of the Jacobi iteration matrix as
L0;1 ¼ D1 L þ U
ð
Þ.
388
Z. Zhang et al.

3.3
Computational Complexity Analysis
In this subsection, we evaluate the complexity of the proposed AOR-based MMSE
signal detection algorithm. The hardware complexity is mainly dominated by the
multipliers, so we deﬁne the complexity as the number of multiplications. Rewrite (5) as
^x n
ð Þ ¼ 1  x
ð
Þ^x n1
ð
Þ þ xD1 ^y þ r
x L^x
n
ð Þ
þ
1  r
x
	

L þ U
h
i
^x n1
ð
Þ


:
ð7Þ
Considering the deﬁnition of the matrix D, L and U, Eq. (7) can be expressed as
^x n
ð Þ
i
¼ 1  x
ð
Þ^x n1
ð
Þ
i
þ x
wi;i
^yi þ r
x
X
i1
j¼1
wi;j^x n
ð Þ
j
þ 1  r
x
	

 X
i1
j¼1
wi;j^x n1
ð
Þ
j
þ
X
2K
j¼i þ 1
wi;j^x n1
ð
Þ
j
 
!
:
ð8Þ
where the parameter r
x can be calculated separately. The number of multiplications
required
for
computation
of
1  x
ð
Þ^x n1
ð
Þ
i
,
r
x
P
i1
j¼1
wi;j^x n
ð Þ
j ,
P
2K
j¼i þ 1
wi;j^x n1
ð
Þ
j
and
1  r
x

 P
i1
j¼1
wi;j^x n1
ð
Þ
j
are 1, i, 2K  i and i, respectively, so the required number of
multiplications for ^x n
ð Þ
i
is 2K þ i þ 3. Thus, the overall complexity for one iteration is
P
2K
i¼1
2K þ i þ 3 ¼ 6K2 þ 7K.
Table 1 compares the complexity of the proposed AOR-based algorithm with that
of NS-based algorithm. The classical MMSE signal detection with exact matrix
inversion operation has cubic computational complexity O K3
ð
Þ. Table 1 illustrates the
complexity of the NS-based algorithm scales with O K2
ð
Þ only for n ¼ 2. However, the
proposed AOR-based algorithm can decrease the complexity by an order of magnitude
from O K3
ð
Þ to O K2
ð
Þ.
4
Simulation Results
To verify the validity of the proposed AOR-based MMSE signal detection, we eval-
uated the BER performance against the signal-to-noise ratio (SNR) and compared it
with the recently proposed NS-based algorithm [11, 12]. The BER performance of the
classical MMSE signal detection with exact matrix inversion was also given as the
Table 1. Computational complexity
Iteration number NS-based algorithm AOR-based algorithm
n ¼ 2
12K2  2K
12K2 þ 14K
n ¼ 3
8K3 þ 4K2
18K2 þ 21K
n ¼ 4
16K3  4K2 þ 2K
24K2 þ 28K
Low-Complexity MMSE Signal Detection
389

benchmark for comparison. A representative massive MIMO system scenario with
N  K ¼ 128  16 and the 64-QAM modulation scheme was adopted.
Figure 1 shows the BER performance of the proposed AOR-based MMSE signal
detection versus the relaxation parameter x and the acceleration parameter r in a
three-dimensional way. The SNR is 15 dB and the iteration number is n ¼ 3. The
optimal parameters can achieve a faster convergence rate and a preferable performance.
As shown in Fig. 1, the BER performance difference is negligible when the parameters
are close to x¼ 1:10 and r ¼ 1:05, indicating the robustness of the proposed method.
So we chose the optimal relaxation and acceleration parameter as xopt ¼ 1:10 and
ropt ¼ 1:05 in the following simulations.
Next we evaluate the inﬂuence of the relaxation and acceleration parameters on the
convergence rate. Figure 2 illustrates the BER performance of the proposed
AOR-based MMSE signal detection versus the relaxation parameter x with the
acceleration parameter r being ﬁxed. Figure 3 illustrates the BER performance of the
proposed AOR-based MMSE signal detection versus the acceleration parameter r with
the relaxation parameter x being ﬁxed. The BER curve behaves like a quadratic
function curve. The BER performance initially improves with the value of x up to
approximately 1.10 and then starts to deteriorate for higher values. It is worth noting
that the BER performance are extremely sensitive to the variation of the relaxation
parameter with the ﬁxed acceleration parameter. So we conclude that the relaxation
parameter x plays a dominant role in the convergence of the algorithm while the
Fig. 1. BER performance of the AOR-based algorithm versus x and r. The SNR is 15 dB and n
is 3.
390
Z. Zhang et al.

Fig. 2. BER performance of the AOR-based algorithm versus x. The SNR is 15 dB and n is 3.
Fig. 3. BER performance of the AOR-based algorithm versus r. The SNR is 15 dB and n is 3.
Low-Complexity MMSE Signal Detection
391

acceleration parameter r can expedite the convergence rate to some extent in the
proposed AOR-based MMSE signal detection. Based on this ﬁnding, a more robust
system can be realized by selecting a proper acceleration parameter despite a small
variation of the relaxation parameter. Numerical results show that the optimal relax-
ation parameter xopt can be set around 1.10 while the corresponding optimal accel-
eration parameter ropt is close to xopt.
Figure 4 provides the BER performance comparison for different detection algo-
rithms. It is apparent that the BER performance improves signiﬁcantly with the
increasing iteration number of the proposed algorithm. The BER performance of the
AOR-based algorithm outperforms the NS-based algorithm with the same iteration
number due to the faster convergence rate of the AOR iterative algorithm. For example,
the proposed AOR-based method with n ¼ 2 can even achieve similar performance
levels as the NS-based method with n ¼ 4. The BER performance of the AOR-based
algorithm approaches the traditional MMSE method within 0:1 dB when the iteration
number is n ¼ 3 for the N  K ¼ 128  16 massive MIMO systems.
5
Conclusions
In this paper, we proposed a low-complexity MMSE signal detection based on the
AOR iterative algorithm for uplink massive MIMO systems. The proposed AOR-based
algorithm reconstructs the transmitting signal via a relaxation and acceleration
Fig. 4. BER performance comparison versus SNR.
392
Z. Zhang et al.

operation to reﬁne the solution estimate in an iterative manner. Numerical results
illustrate that the proposed AOR-based algorithm can obtain better BER performance
than the recently proposed NS-based algorithm and approach the performance of the
classical MMSE signal detection with a signiﬁcantly reduced complexity. Owing to the
superiority of the low-complexity AOR iteration algorithm, it can be utilized to solve
other problems involving complicated matrix inversion operations such as the pre-
coding technique in massive MIMO systems.
Acknowledgments. This work was supported by Huawei Innovation Research Program, the
key project of the National Natural Science Foundation of China (No. 61431001), the 5G
research program of China Mobile Research Institute (Grant No. [2015] 0615), the open research
fund
of
National
Mobile
Communications
Research
Laboratory
Southeast
University
(No. 2017D02), Key Laboratory of Cognitive Radio and Information Processing, Ministry of
Education (Guilin University of Electronic Technology), the Foundation of Beijing Engineering
and Technology Center for Convergence Networks and Ubiquitous Services, and Keysight.
References
1. Rusek, F., et al.: Scaling up MIMO: opportunities and challenges with very large arrays.
IEEE Sig. Process. Mag. 30(1), 40–60 (2013)
2. Zheng,
L.,
Tse,
D.N.C.:
Diversity
and
multiplexing:
a
fundamental
tradeoff
in
multiple-antenna channels. IEEE Trans. Inf. Theory 49(5), 1073–1096 (2003)
3. Dai, X., et al.: Successive interference cancelation amenable multiple access (SAMA) for
future wireless communications. In: 2014 IEEE International Conference on Communication
Systems, Macau, pp. 222–226 (2014)
4. Marzetta, T.L.: Noncooperative cellular wireless with unlimited numbers of base station
antennas. IEEE Trans. Wirel. Commun. 9(11), 3590–3600 (2010)
5. Lu, L., Li, G.Y., Swindlehurst, A.L., Ashikhmin, A., Zhang, R.: An overview of massive
MIMO: beneﬁts and challenges. IEEE J. Sel. Top. Sig. Process. 8(5), 742–758 (2014)
6. Xie, H., Gao, F., Zhang, S., Jin, S.: A uniﬁed transmission strategy for TDD/FDD massive
MIMO systems with spatial basis expansion model. IEEE Trans. Veh. Technol. 66(4), 3170–
3184 (2017)
7. Boccardi, F., Heath, R.W., Lozano, A., Marzetta, T.L., Popovski, P.: Five disruptive
technology directions for 5G. IEEE Commun. Mag. 52(2), 74–80 (2014)
8. Artes, H., Seethaler, D., Hlawatsch, F.: Efﬁcient detection algorithms for MIMO channels: a
geometrical approach to approximate ML detection. IEEE Trans. Signal Process. 51(11),
2808–2820 (2003)
9. Jalden, J., Ottersten, B.: On the complexity of sphere decoding in digital communications.
IEEE Trans. Sig. Process. 53(4), 1474–1484 (2005)
10. Bello, I.A., Halak, B., El-Hajjar, M., Zwolinski, M.: VLSI implementation of a scalable
K-best MIMO detector. In: 2015 15th International Symposium on Communications and
Information Technologies (ISCIT), Nara, pp. 281–286 (2015)
11. Wu, M., Yin, B., Wang, G., Dick, C., Cavallaro, J.R., Studer, C.: Large-scale MIMO
detection for 3GPP LTE: algorithms and FPGA implementations. IEEE J. Sel. Top. Sig.
Process. 8(5), 916–929 (2014)
12. Zhu, D., Li, B., Liang, P.: On the matrix inversion approximation based on neumann series
in massive MIMO systems. In: 2015 IEEE International Conference on Communications
(ICC), London, pp. 1763–1769 (2015)
Low-Complexity MMSE Signal Detection
393

13. Hadjidimos, A.: Accelerated overrelaxation method. Math. Comput. 32(141), 149–157
(1978)
14. Bölcskei, H.: Space-Time Wireless Systems: From Array Processing to MIMO Commu-
nications. Cambridge University Press, New York (2006)
15. Xie, H., Gao, F., Jin, S.: An overview of low-rank channel estimation for massive MIMO
systems. IEEE Access 4, 7313–7321 (2016)
16. Björck, Å.: Numerical Methods in Matrix Computations. TAM, vol. 59. Springer, Cham
(2015). https://doi.org/10.1007/978-3-319-05089-8
17. Zeng, W.: On convergence of AOR method. Journal of Huqiao University (1985)
18. Chen, P.X.: Convergence of AOR Method. Mathematica Numerica Sinica (1983)
394
Z. Zhang et al.

Outage Performance for IDF Relaying
Mobile Cooperative Networks
Lingwei Xu1(&), Jingjing Wang1, Yun Liu1, Jie Yang1,
Wei Shi1, and T. Aaron Gulliver2
1 Department of Information Science and Technology,
Qingdao University of Science and Technology, Qingdao 266061, China
gaomilaojia2009@163.com, kathy1003@163.com,
Lyun-1027@163.com, 463604226@qq.com,
shiwei6670595@126.com
2 Department of Electrical and Computer Engineering,
University of Victoria, Victoria V8W 2Y2, Canada
agullive@ece.uvic.ca
Abstract. Cooperative communication has emerged as a key technique in ﬁfth
generation (5G) mobile wireless networks. In this paper, with incremental
decode-and-forward (IDF) relaying and transmit antenna selection (TAS), we
investigate the outage probability (OP) performance of mobile cooperative
networks. Exact closed-form expressions for OP with optimal TAS are derived.
These expressions are used to evaluate the impact of power allocation on OP
performance. Then we verify the mathematical derivations using Monte Carlo
simulations. The OP performance is inﬂuenced by power-allocation parameter.
Keywords: Mobile cooperative communication
Incremental decode-and-forward  Outage probability
Transmit antenna selection  Power allocation
1
Introduction
The tremendous growth in mobile data trafﬁc has created signiﬁcant interest in the
development of ﬁfth-generation (5G) wireless communication systems [1, 2]. Many
new technologies are being proposed for 5G mobile communications to satisfy the
demands, such as device-to-device (D2D), heterogeneous networks, ultra-dense net-
works, and massive multiple-input-multiple-output (MIMO) systems [3–5]. For
example, in cognitive small cells, the authors used cooperative Nash bargaining game
theory to investigate the power allocation problem in [5].
In 5G mobile wireless networks, cooperative communication is considered to be a
key technology. The authors investigated average bit error probability (BEP) perfor-
mance of threshold digital relaying, and incremental-selective decode-and-forward
(DF) relaying in [6, 7]. In [8], the authors investigated the outage probability
(OP) performance of incremental amplify-and-forward (AF) relaying.
The hardware complexity of MIMO systems increases with the number of anten-
nas. Transmit antenna selection (TAS) has been proposed to reduce this complexity.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 395–402, 2018.
https://doi.org/10.1007/978-3-319-72823-0_37

Using TAS, the authors investigated the OP performance of MIMO systems over
Nakagami-m fading channels in [9]. The authors investigated symbol error rate
(SER) performance of MIMO systems using TAS over η-µ fading channels in [10].
Further, using TAS and AF relaying, [11] provided new analysis results for OP and
SER of MIMO systems over Rayleigh fading channels.
Although there are many results in the literature on TAS, the performance has been
evaluated without considering the actual characteristics of a mobile communications
channel. For example, the performance of TAS has only been investigated over Rayleigh,
η-µ and Nakagami-m fading channels [9–11]. Recently, the N-Nakagami fading channel
has been proposed to more accurately characterize mobile communications channels.
Thus in this paper, TAS is considered for incremental delay-and-forward (IDF) relaying
mobile cooperative networks over N-Nakagami fading channels. We investigate OP
performance of optimal TAS, and the impact of the power allocation on OP performance
is examined. In addition, these expressions are evaluated using Monte Carlo simulation,
to verify the mathematical derivations.
The rest of the paper is organized as follows. Section 2 describes the mobile
cooperative network model. We investigate the OP performance of the optimal TAS
scheme in Sect. 3. Monte Carlo simulations are used to verify the mathematical
derivations in Sect. 4. We give some conclusions in Sect. 5.
2
The System Model
The mobile cooperative model is shown in Fig. 1. With the help of L single-antenna
mobile relay (MR) nodes, the mobile source (MS) node can communicate with the
mobile destination (MD) node. MS has Nt antennas, while MD has Nr antennas.
h ¼ hk; k 2
hSDij; hSRil; hRDlj


represents the complex channel coefﬁcients. h fol-
lows N-Nakagami distribution. The relative gain of the MSi ! MDj link is GSDij = 1,
the relative gain of MSi ! MRl is GSRil, the relative gain of MRl ! MDj is GRDlj. MS
and MRl use the total energy E in the two time slots.
MSi transmits the signal x in the ﬁrst time slot. MDj and MRl receive the signals
rSDij and rSRil as
rSDij ¼
ﬃﬃﬃﬃﬃﬃﬃ
KE
p
hSDijx þ nSDij
ð1Þ
rSRil ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
GSRilKE
p
hSRilx þ nSRil
ð2Þ
where K is the power allocation parameter, the mean and variance of nSRil and nSDij are
0 and N0/2 [12].
The best MR compares cSDij to a threshold cT, and determines whether or not to use
DF cooperation in the second time slot. The best MR is selected as follows
cRDij ¼ max
1  l  LðcRDljÞ
ð3Þ
396
L. Xu et al.

where cRDlj represents the SNR of MRl ! MDj link, and
cRDlj ¼ ð1  KÞGRDlj hRDlj

2E
N0
¼ ð1  KÞGRDlj hRDlj

2c
ð4Þ
If cSDij > cT, the best MR will not participate in cooperation. MDj receives the SNR
as
c0ij ¼ cSDij
ð5Þ
where
cSDij ¼ K hSDij

2E
N0
¼ K hSDij

2c
ð6Þ
If cSDij < cT, the best MR uses DF cooperation protocol. MDj receives the signal as
rRDj ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ð1  KÞGRDjE
q
hRDjxr þ nRDj
ð7Þ
where the mean and variance of nRDj are 0 and N0/2.
MDj uses the selection combining (SC) scheme, and receives the SNR as
cSCij ¼ maxðcSDij; cRDijÞ
ð8Þ
M
MRR11
M
MSS
M
MDD
M
MRR22
M
MRRLL
…
…
…
…
…
…
Fig. 1. The system model
Outage Performance for IDF Relaying Mobile Cooperative Networks
397

MD receives the SNR as
cSCi ¼
max
1  j  NrðcijÞ
ð9Þ
where
cij ¼
c0ij;
cSDij [ cT
cSCij;
cSDij\cT
(
ð10Þ
The transmit antenna w is selected as follows
w ¼ max
1  i  NtðcSCiÞ ¼
max
1  i  Nt;1  j  NrðcijÞ
ð11Þ
3
The Optimal TAS OP
3.1
cth > cT
We obtain the OP as
Foptimal ¼ Prð
max
1  i  Nt;1  j  NrðcijÞ\cthÞ ¼
¼ PrðcT\cSD; c0\cthÞ þ PrðcSD\cT; cSC\cthÞ
ð
ÞNtNr
¼ G1 þ G2
ð
ÞNtNr
ð12Þ
where cth is the threshold.
The G1 is given as
G1 ¼
1
Q
N
d¼1
CðmdÞ
GN;1
1;N þ 1
cth
cSD
Y
N
d¼1
md
Xd
1
m1;...:;mN;0

"
#

1
Q
N
d¼1
CðmdÞ
GN;1
1;N þ 1
cT
cSD
Y
N
d¼1
md
Xd
1
m1;...:;mN;0

"
#
ð13Þ
cSD ¼ Kc
ð14Þ
where G[] is the well-known Meijer’s G-function, the fading coefﬁcient is deﬁned as
m, and the scaling factor is deﬁned as X [13].
398
L. Xu et al.

The G2 is given as
G2 ¼
1
Q
N
d¼1
CðmdÞ
GN;1
1;N þ 1
cT
cSD
Y
N
d¼1
md
Xd
1
m1;...:;mN;0

"
#

1
Q
N
t¼1
CðmtÞ
GN;1
1;N þ 1
cth
cRD
Y
N
t¼1
mt
Xt
1
m1;...:;mN;0

"
#
0
B
B
B
@
1
C
C
C
A
L
ð15Þ
cRD ¼ ð1  KÞGRDc
ð16Þ
3.2
cth < cT
We obtain the OP as
Foptimal ¼ PrðcSD\cT; cSC\cthÞ
ð
ÞNtNr
¼ PrðcSD\cthÞ PrðcRD\cthÞ
ð
ÞNtNr
¼ G11G22
ð
ÞNtNr
ð17Þ
The G11 is given as
G11 ¼ PrðcSD\cthÞ
¼
1
Q
N
d¼1
CðmdÞ
GN;1
1;N þ 1
cth
cSD
Y
N
d¼1
md
Xd
1
m1;...:;mN;0

"
#
ð18Þ
The G22 is given as
G22 ¼ PrðcRD\cthÞ
¼
1
Q
N
t¼1
CðmtÞ
GN;1
1;N þ 1
cth
cRD
Y
N
t¼1
mt
Xt
1
m1;...:;mN;0

"
#
0
B
B
B
@
1
C
C
C
A
L
ð19Þ
4
Numerical Results
In this section, Monte Carlo simulations are used to verify the mathematical deriva-
tions. E = 1. We deﬁne l = GSR/GRD (in decibels) as the relative geometrical gain.
Outage Performance for IDF Relaying Mobile Cooperative Networks
399

Figure 2 presents the OP performance with cth = 5 dB, cT = 6 dB. Figure 3 pre-
sents the OP performance with cth = 5 dB, cT = 2 dB. The simulation parameters used
are as follows: N = 2, m = 2, K = 0.5, Nt = 1, 2, 3, L = 2, Nr = 1, l = 0 dB. From
Figs. 2 and 3, it is clear that Monte-Carlo simulation results and the analysis results
match. Further, increasing Nt improves the OP performance. For example, when
cth = 5 dB, cT = 2 dB, SNR = 10 dB, the OP is 2.9  10−1 with Nt = 1, 8.3  10−2
with Nt = 2, 2.4  10−2 with Nt = 3. With Nt ﬁxed, increasing SNR decreases the OP.
The effect of K on OP performance is evaluated in Fig. 4. The simulation
parameters used are as follows: N = 2, m = 2, l = 0 dB, Nt = 2, L = 2, Nr = 2, cth =
5 dB, cT = 3 dB. Simulation results show that increasing SNR improves the OP per-
formance. For example, when K = 0.7, the OP is 2.8  10−1 with SNR = 5 dB,
2
4
6
8
10
12
14
16
18
20
10
-4
10
-3
10
-2
10
-1
10
0
SNR(dB)
OP
Simulation OP
Theoretical OP
Nt=1,2,3
Fig. 2. The optimal TAS OP performance with cth < cT
2
4
6
8
10
12
14
16
18
20
10
-4
10
-3
10
-2
10
-1
10
0
SNR(dB)
OP
Simulation OP
Theoretical OP
Nt=1,2,3
Fig. 3. The optimal TAS OP performance with cth > cT
400
L. Xu et al.

3.7  10−3 with SNR = 10 dB, 9.1  10−6 with SNR = 15 dB. When SNR = 5 dB,
K = 0.10; SNR = 10 dB, K = 0.10; SNR = 15 dB, K = 0.81. We obtain that K = 0.5
is not the best choice. For most applications, we can store the optimum power allo-
cation (OPA) values in a lookup table.
5
Conclusions
In this paper, with TAS, we investigate the OP performance of IDF relaying mobile
cooperative networks. Monte Carlo simulation was used to verify these expressions,
and to examine the effect of the power allocation on the OP performance. Future
research will consider the impact of correlated channels on the performance.
Acknowledgments. This project was supported by the National Natural Science Foundation of
China (No. 61671261, No. 61304222), Shandong Province Natural Science Foundation (No.
ZR2017BF023), Open Research Fund from Shandong provincial Key Laboratory of Computer
Networks (No. SDKLCN-2017-01), State Key Laboratory of Millimeter Waves (No. K201824),
the Key Research and Development Program of Shandong Province (No. 2016GGX101007),
and
China
Postdoctoral
Science
Foundation
(No.
2017T100490,
No.
2017M612223,
No. 2014M551905).
References
1. Mumtaz, S., Huq, K.M.S., Rodriguez, J.: Direct mobile-to-mobile communication: paradigm
for 5G. IEEE Wirel. Commun. 21, 14–23 (2014)
2. Chen, S., Zhao, J.: The requirements, challenges and technologies for 5G of terrestrial
mobile telecommunication. IEEE Commun. Mag. 52, 36–43 (2014)
3. Zhang, H.J., Liu, H., Jiang, C.X., Nallanathan, A., Wen, X.M.: A practical semi-dynamic
clustering scheme using afﬁnity propagation in cooperative picocells. IEEE Trans. Veh.
Technol. 64, 4372–4377 (2015)
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
10
-6
10
-5
10
-4
10
-3
10
-2
10
-1
10
0
K
OP
SNR=5dB
SNR=10dB
SNR=15dB
Fig. 4. The OP performance versus K
Outage Performance for IDF Relaying Mobile Cooperative Networks
401

4. Ge, X.H., Tu, S., Mao, G.Q., Wang, C.X., Han, T.: 5G ultra-dense cellular networks. IEEE
Wirel. Commun. 23, 72–79 (2015)
5. Zhang, H.J., Jiang, C.X., Beaulieu, N.C., Chu, X.L., Wang, X.B., Quek, T.Q.S.: Resource
allocation for cognitive small cell networks: a cooperative bargaining game theoretic
approach. IEEE Trans. Wirel. Commun. 14, 3481–3493 (2015)
6. Xu, L.W., Zhang, H.: Performance analysis of threshold digital relaying M2M cooperative
networks. Wirel. Netw. 22, 1595–1603 (2016)
7. Xu, L.W., Wang, J.J., Wang, H., Gulliver, T.A.: ABEP performance of ISDF relaying M2M
cooperative networks. KSII Trans. Internet Inf. Syst. 10, 5129–5148 (2016)
8. Xu, L.W., Wang, J.J., Zhang, H., Gulliver, T.A.: Performance analysis of IAF relaying
mobile D2D cooperative networks. J. Franklin Inst. 354, 902–916 (2017)
9. Yeoh, P.L., Elkashlan, M., Yang, N., Costa, D.B.D., Duong, T.Q.: Uniﬁed analysis of
transmit antenna selection in MIMO multi-relay networks. IEEE Trans. Veh. Technol. 62,
933–939 (2013)
10. Kumbhani, B., Kshetrimayum, R.: Analysis of TAS/MRC based MIMO Systems over η −µ
Fading Channels. IETE Tech. Rev. 32, 252–259 (2015)
11. Abdelnabi, A., Fawaz, A.Q., Shaqfeh, M., Ikki, S., Alnuweiri, H.: Performance analysis of
MIMO multi-hop system with TAS/MRC in poisson ﬁeld of interferers. IEEE Trans.
Commun. 64, 525–540 (2016)
12. Ochiai, H., Mitran, P., Tarokh, V.: Variable-rate two-phase collaborative communication
protocols for wireless networks. IEEE Trans. Veh. Technol. 52, 4299–4313 (2006)
13. Karagiannidis, G.K., Sagias, N.C., Mathiopoulos, P.T.: N*Nakagami: a novel stochastic
model for cascaded fading channels. IEEE Trans. Commun. 55, 1453–1458 (2007)
402
L. Xu et al.

AES and SNOW 3G are Feasible Choices
for a 5G Phone from Energy Perspective
Mohsin Khan(B) and Valtteri Niemi
Department of Computer Science, University of Helsinki, P.O. Box 68,
Gustaf H¨allstr¨omin katu 2b, 00014 Helsinki, Finland
{mohsin.khan,valtteri.niemi}@helsinki.fi
Abstract. The aspirations for a 5th generation (5G) mobile network
are high. It has a vision of unprecedented data-rate and extremely per-
vasive connectivity. To cater such aspirations in a mobile phone, many
existing eﬃciency aspects of a mobile phone need to be reviewed. We
look into the matter of required energy to encrypt and decrypt the huge
amount of traﬃc that will leave from and enter into a 5G enabled mobile
phone. In this paper, we present an account of the power consumption
details of the eﬃcient hardware implementations of AES and SNOW 3G.
We also present an account of the power consumption details of LTE
protocol stack on some cutting edge hardware platforms. Based on the
aforementioned two accounts, we argue that the energy requirement for
the current encryption systems AES and SNOW 3G will not impact the
battery-life of a 5G enabled mobile phone by any signiﬁcant proportion.
Keywords: LTE · 5G · Cryptosystem · ASIC
1
Introduction
The aspirations of 5G network are reﬂected in the white papers published by the
leading telecommunication companies [22,24,25]. All of these white papers men-
tion about the vision of more than 1 Gbps data rate. To facilitate our discussion,
we need to know what are the data that will be encrypted and decrypted in a
5G phone. We also need to know where and how many times the encryption and
decryption will take place across the protocol stack on the phone. But 5G is not
yet a reality and we do not have exact answers to these questions. So, we assume
things about a 5G network and argue on the basis of those assumptions. We
turn to the LTE (3GPP deﬁned 4G network) network and diﬀerent white papers
[23,26,27] published by the leading telecommunication companies to make the
assumptions. In an LTE phone, the data that leave and enter the phone can be
broadly classiﬁed into three categories.
1. The control signals in between the phone and the core network
2. The control signals in between the phone and the radio network
3. The user data sent and received at the phone’s application layer
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 403–412, 2018.
https://doi.org/10.1007/978-3-319-72823-0_38

404
M. Khan and V. Niemi
Both of the ﬁrst two categories are conﬁdentiality and integrity protected. For
the third category, only the privacy is protected. Also note that, from the volume
point of view, the major share of data belong to the third category. Comparing
to the third category, the cryptographic computation required for the data of
ﬁrst and second categories is negligible. The user data in an LTE phone is only
once encrypted and decrypted across the protocol stack in PDCP layer. For a
5G phone, we assume the following:
1. User data will remain as the major share of the total data leaving and entering
the phone.
2. The cryptographic computational need for the total volume of control signals
will be negligible in comparison with that of the user data.
3. The user data will only once be encrypted and decrypted somewhere across
the protocol stack.
4. In order to have a pessimistic estimation of energy consumption, we assume
that integrity protection of user data will be introduced in 5G.
Based on these assumptions, we will look into the cryptographic energy require-
ments and also the total energy requirements across the protocol stack of an
LTE phone. Then we will scale up the data-rate from 100 Mbps to 1 Gbps and
see how much extra pressure it puts on the battery of the phone in comparison
with other energy hungry aspects of the phone like display and radio signalling.
The paper is organized by ﬁrst giving a very short introduction to the archi-
tecture, the protocol stack and the cryptographic speciﬁcations of the LTE net-
work in Sect. 2. In Sect. 3, we present the results found in the existing literature
about the energy requirements of the two cryptosystems of interest, which are
AES and SNOW 3G. In this section we also present the results about the energy
consumption across the whole protocol stack of the link layer. In Sect. 4 we
present the energy consumption distribution of the whole phone among its dif-
ferent functional modules and show that the energy needed for cryptographic
computation is not a threat for the battery life of the phone.
2
LTE Speciﬁcations
An LTE network is comprised of broadly three components. The user equipment
(UE), evolved radio network (E-UTRAN) known as radio network and evolved
packet core (EPC) known as core network. The user equipment consists of a
mobile equipment (ME) or a mobile phone for the context of this paper, and a
universal integrated circuit card (UICC). The UICC hosts an application called
subscriber identiﬁcation module (SIM). In this paper when we refer to the user
equipment, we mean it to be the mobile phone since the UICC does not have
much functionality to consume a lot of energy (Fig. 1).
The UE is connected to the network via a radio link only with the radio
network. The entity of the E-UTRAN that has the radio link with the UE is
called eNodeB which is traditionally known as a base station. However, the UE
also establishes a direct logical connection with an entity of the core network

AES and SNOW 3G are Feasible Choices
405
Fig. 1. LTE architecture
known as the mobility management entity (MME). This logical connection is
used only for the control signals for the core network and hence we do not focus
on it in this paper. The user data as mentioned in the introduction travels from
the UE to the eNodeB. Figure 2 shows the protocol stack that the data travel
across at the UE and at eNodeB. The L1 layer is the physical layer. We logically
bundle the packet data convergence protocol (PDCP), radio link control (RLC),
and medium access control (MAC) layers as layer 2 (L2). All the encryption and
decryption takes place at the PDCP layer [1].
Fig. 2. Protocol stack in LTE network
According to [2], there are two mandatory sets of security algorithms in the
4th generation cellular network (LTE) developed by 3GPP. One is EEA1 in
which the stream cipher SNOW 3G is used. The other is EEA2 in which the
block cipher AES is used. The aspiration for the 5G networks is to obtain at
least 1Gbps data-rate. The question arises if there are implementations of these
two encryption systems that can achieve the required throughput and still be
energy eﬃcient enough to be used in a mobile phone.

406
M. Khan and V. Niemi
3
Throughput and Energy Requirements of AES
and SNOW 3G
In [12], the authors showed in their experiment that the computing power of a
single embedded processor even at high clock frequency is not enough to cope
with the L2 requirements of LTE and next generation mobile devices. The AES
decryption was identiﬁed as the major time critical software algorithm, demand-
ing half of the execution time of entire L2 of downlink (DL). So, advanced hard-
ware acceleration methods were required while keeping the energy and area
requirements at a reasonable level for a mobile phone.
In a study conducted on the L2 DL [14], the authors had shown that by
a smart DMA (direct memory access) controller, the required throughput for
LTE which is at most 100 Mbps can be achieved. They used Faraday’s 90 nm
CMOS technology, 128-bit data path and 11 round transformations for AES.
However, to achieve this required throughput, the implementation consumed 9.5
mW of power whereas AES and SNOW 3G each required .5 and .57 mW of
power respectively. So, the decryption consumes around 5% of the power budget
of L2 DL. From energy point of view, it consumes 5.7 mJ of energy to decrypt
1 Gb of data. In [14, Fig. 6] the detailed comparison is presented. In Sect. 4, we
will see that this is indeed a very small amount of energy when compared with
total amount of energy consumed by the phone while exchanging bulk amount
of network data.
From the experience of LTE [16, Fig. 9], we see that the energy requirements
of radio interface technology (downlink) in LTE increases linearly as the data
rate increases but with a small slope. On the other hand, energy requirements
for encryption increases linearly as the data rate increases with slope 1. 5G has
unprecedented data rate of 1 Gbps. Consequently, even though it is evident in
LTE that ciphering is not very expensive, it needs to be rigorously investigated
to conclude that it will not be very expensive in 5G. In the following sub-sections
we present some implementations of AES and SNOW 3G.
3.1
AES
Since the adoption of Rijndael as AES by NIST, there have been a num-
ber of hardware implementations of AES. It is understandable that through-
put and energy consumption are not mutually exclusive. In the beginning, the
focus was completely on achieving high throughput. Over the time the need
for high throughput, yet energy eﬃcient implementations became more pressing
and studies concerning the energy consumption of the implementations became
available.
From Table 1, we ﬁnd the implementations in [9–11] are potential candidates
for using in 5G since they meet the required throughput of 5G and present their
energy requirements which enable us to make a meaningful analysis. In [10],
the authors present an implementation called SAME that achieves 114 Mbps
throughput using 2 cores of the processor of a mobile phone. The implementation

AES and SNOW 3G are Feasible Choices
407
Table 1. AES implementations
Year Ref Tech (nm
CMOS)
TP (Gbps) Gates (K) Power (mW) Energy
(mJ/Gb)
2001 [4]
110
2.6
21.3
−
−
2001 [4]
110
0.311
5.4
−
−
2001 [5]
−
0.24
4
−
−
2006 [8]
180
0.570
−
20.34
35.68
2006 [8]
350
0.569
−
192.5
338.3
2007 [7]
180
0.384
21
−
−
2009 [6]
180
1.16
19.47
−
−
2009 [9]
90
1.00
38
0.78
.78
2011 [10] −
0.114
−
.02
.24
2012 [11] 180
1.6
58.445
22.85
14.28
is based on slicing and merging the bytes of several data blocks to exploit proces-
sor’s architecture width for multi-block encryption. According to [10, Fig. 8] the
implementation is scalable with a speed up factor of 0.9; i.e., if the throughput
achieved by 1 core is T, then n > 1 cores provide throughput 0.9nT. According
to [10, Fig. 9], the SAME implementation achieves 5.5 Mbps/µJ. Consequently,
it spends 114/5.5 Mbps/(Mbps/µJ) = 20.72 µJ = .02 mJ to encrypt/decrypt
114 Mb. Now, by scaling up by 12 diﬀerent 2-cores, it will achieve the throughput
of 0.114 · 12 · 0.9 ≈1 Gbps while it will spend 0.02 · 12 = 0.24 mJ. Even though
this implementation comes up as the most energy eﬃcient in Table 1, it is still
not practical choice in 5G because a mobile phone with 24 cores is a far fetched
idea even for 5G. In [9], the authors present an application speciﬁc integrated cir-
cuit (ASIC) implementation based on Faraday’s 90 nm CMOS technology. They
do not provide the exact throughput but provide the time required for process-
ing one byte and the power need to process at that rate. In LTE, to achieve 100
Mbps, 100 Kb of data is required to be processed by 0.6 ms. Similarly we assume
that in 5G, to achieve 1 Gbps data rate, 1 Mb of data need to be processed in
0.6 ms. Consequently processing time of around 4 ns per byte is required to
achieve 1 Gbps. In [9, Fig. 8] it is claimed that using one AES core with 128-bit
data path, processing time of 4 ns per byte can be achieved while consuming
0.78 mJ of energy per second. In [9, Fig. 10], it is claimed that processing time
of 4 ns per byte can be achieved using 2 AES core by using even less energy,
0.72 mJ per second. This implementation appears to be a very good candidate
for a 5G phone. In [11], the implementation achieves the required throughput
without any need of scaling up but it spends almost 30 times more energy than
that of [9].

408
M. Khan and V. Niemi
3.2
SNOW 3G
It appears that there have not been as many hardware implementations of SNOW
3G as there have been of AES. It may be attributed to the reason that AES is
much more widely used in diﬀerent protocols. As mentioned in Sect. 3, the imple-
mentation in [14] focuses on the throughput and energy eﬃciency of the whole
L2 layer of LTE and doesn’t give any account of the scalability of the SNOW 3G
ciphering unit that can be used for much higher data rates than LTE. In [18],
the authors present a parallel implementation of SNOW 3G by exploiting the
multi-core processor of a smart phone that can provide the required through-
put of LTE. The authors used voltage and frequency scaling (VFS) to reduce
the energy consumption. It achieves the energy eﬃciency of 22 Mbps/µJ while
providing throughput of 100 Mbps. So, it consumes 100/22 Mbps/(Mbps/µJ)
= 4.5 µJ per second to achieve the throughput. If the technology was scalable
to achieve the required throughput of 5G with a reasonable speed up factor, it
would be an energy eﬃcient solution. But the implementation depends on the
cores of the processor of the phone to achieve the parallelism, and it seems it
would take at least 10 times more cores than that of the phone used in the
original implementation. As a result we do not ﬁnd it as an appealing imple-
mentation for a 5G phone. There has been an ASIC implementation by Elliptic
Semiconductor Inc. that achieves 2.5 Gbps throughput at 100 Mhz frequency
and 15K gates as cited in [19]. In [19] the authors presented an ASIC implemen-
tation of SNOW 3G using the 130 nm CMOS library with 1.2 V core voltage
and 25K gates. At 249 MHz they have been able to harness a throughput of
7.9 Gbps. Though both of the implementations provide much more than the
throughput required in 5G, we can’t argue anything with them as no concrete
power ﬁgures are found. In [21], IP Cores Inc. presents two implementations of
SNOW 3G called SNOW3G1 as shown in Table 2. They too do not provide any
power/energy ﬁgures. Fortunately, in [20], the authors have used the SNOW3G
implementation of IP Cores Inc. and have estimated that using 4 parallel blocks
of SNOW3G1 with hard macro storage, a throughput of 30 Gbps is achievable
at 1650 MHz while consuming 14.41 mJ of energy per second. We scale down
the frequency by 30 times and expect the energy consumption per second will
also be scaled down at the same proportion. According to that assumption, at
1650/30 MHz = 55 MHz, we should be able to harness the throughput of 1 Gbps
by spending 14.41/30 mJ = 0.48 mJ of energy. The authors estimated the power
consumption on a gate-level netlist by back-annotating the switching activity
and using Synopsys Power Compiler tool.
Table 2. SNOW3G1 in [21]
Technology
Max frequency Area/Resources Throughput
TSMC 65 nm G+ 302 MHz
7,475 gates
2.4 Gbps
TSMC 65 nm G+ 943 MHz
8,964 gates
7.5 Gbps

AES and SNOW 3G are Feasible Choices
409
4
Overall Comparison
The overall energy consumption of a phone depends on the usage pattern of the
user of the phone. Radio activities of the cellular network, lighting up the screen,
touch screen and CPU are the commonly considered as the most energy hungry
aspects of a smart phone [15].
There are times when a smart phone remains idle and does nothing for a
long duration of time. During this time it switches to a suspended state by
transferring the state of the phone to the RAM. In suspended state the phone
draws a minimal amount of energy from the battery to maintain the state in the
memory and receive very limited control signals from the network to be able to
receive the incoming traﬃc. In [15], the authors conducted an experiment on a
2.5G phone and two cutting edge 3G phones of the time. They showed that in
suspended state, a 2.5G phone drew 103 mJ of energy per second whereas the 3G
phones drew around 25 mJ per second. There is another state when the phone
is awake but no application is running. This state is called the idle state. In [15],
the authors showed on the same phones that during idle state the amount of
energy drawn was less than 350 mJ per second.
Normally, the time duration a smart phone is in a suspended or idle state is
much longer than that of when it remains active. So, the energy consumption
of the phone during idle or suspended state is very critical for the battery life.
However, during these times, the phone hardly encrypts or decrypts any data
except the control signals which are mostly paging messages. The reason is that
the attach procedure takes place only when the user switches on the phone and
tracking area update takes place frequently only when the user is travelling on
a vehicle. However, even though paging itself is a burden for the phone from
energy point of view, the cryptographic energy requirement for paging message
is insigniﬁcant. According to [17], even with traditional paging mechanism, there
are 1000 paging messages for a phone in an hour, which is less than 1 in a second.
According to [3], the paging message is no longer than hundreds of bytes. The
energy requirements for AES for this tiny amount of data is very insigniﬁcant
to the total need 25 mJ per second during the suspended state and of 300 mJ
during the idle state.
To understand the energy expense of encryption, we need to focus on the
total energy expense of the phone during the active states of the phone when
encryption is also being performed. Such active states are phone call, web brows-
ing, email, network data exchange (upload/download) and so on. We choose to
focus on the case of network data exchange to argue our case. We assume that
the phone would utilize its full download or upload capacity from the data vol-
ume point of view during the exchange. We will investigate this case for 2.5G,
3G and 4G phones to see the evolution the energy requirements.
In [15], the authors showed that the 2.5G phone consumed around 700 mJ
of energy per second during the network data exchange. Around 640 mJ of this
energy budget is spend for cellular network activities. We know in 2.5G, the
maximum data rate can be 115 Kbps. At that rate the AES implementation in
[9] would spend around 0.000078 mJ of energy per second which is of course very

410
M. Khan and V. Niemi
insigniﬁcant. The authors of [15] also showed that the 3G phones consumed a
similar amount of total energy during data upload/download which is around
900 mJ per second. Considering the connection exchanged the data at its full
capacity (7.2 Mbps), the energy share for encryption is around 0.005 mJ which
is also very insigniﬁcant.
Both in the 2.5G and 3G phone the major energy share for network data
exchange is attributed to the radio transmission. However, there has been a sig-
niﬁcant change in the LTE radio technology and has become even more expensive
from energy consumption point of view. In LTE, there are diﬀerent radio states
and the phone promotes and demotes to diﬀerent states to save energy. As a
result even though LTE becomes less energy eﬃcient than 3G for small data
transfer, it remains as eﬃcient as 3G in large size data transfer. Also, there is
a signiﬁcant diﬀerence in the energy consumption of LTE uplink and downlink.
According to [16, Fig. 9], the LTE uplink consumes 3.2 J of energy per second
while uploading at the rate of 5 Mbps. From the ﬁgure it appears that the energy
consumption increases linearly with the uploading data rate with a factor of
more than 1. Downloading on the other hand, is less energy expensive, consum-
ing 2.1 J of energy per second at the rate of 19 Mbps. The energy consumption
while downloading also increases almost linearly but with a very small factor
after 10 Mbps. With screen oﬀ, the authors claimed that the energy was mostly
consumed by the radio interfaces. The AES implementation in [10] consumes
.78 mJ of energy per second providing throughput of 1 Gbps. In order to come
up with a loose bound, let us consider that the LTE uplink and downlink would
consume the same amount of energy even when the data rate is at the theoretical
peak, which is 100 Mbps and around 90 Mbps downlink and uplink respectively.
Then the energy share of encryption is still bounded by .04%. It should be noted
here that the high energy requirements in LTE are mostly attributed to its radio
interface technology. Nevertheless, the radio technology will be diﬀerent in 5G
than that of LTE. Let us consider that the LTE draws Elte mJ of energy per sec-
ond while transferring data at the theoretical maximum data rate. Let’s assume
that in 5G, the radio interface will draw Elte/a mJ of energy while providing
the throughput of 1 Gpps by using its new eﬃcient radio technology. We know
implementations of AES and SNOW 3G that take .78 and .48 mJ of energy
per second to provide throughput of 1 Gbps. So, the energy share of encryption
in 5G is .78a
Elte × 100 = .04a percent for AES and .03a percent for SNOW 3G.
Considering that the integrity protection will also be incorporated for user data,
the cryptographic eﬀort will at most be doubled and hence they will be at most
.08a and .06a percent for AES and SNOW 3G respectively.
However, we don’t know the value of a for certain. Energy eﬃciency is a major
concern for 5G network. Operators explicitly mention a reduction of total net-
work energy consumption by 50% despite an expected 1,000-fold traﬃc increase
[22]. In [23], it concludes that 5G systems with high energy performance should
be built on two design principles. One is to only be active and transmit when
needed and the other is to only be active and transmit where needed. In our
above discussion the Elte is considered as the energy only when data is being

AES and SNOW 3G are Feasible Choices
411
transmitted or received and doesn’t include the energy when no data is being
exchanged. We haven’t found any account on how much more energy eﬃcient
5G uplink and downlink will be. It is diﬃcult to answer as there will be diﬀerent
radio interfaces involved. Search for a reasonably accepted value of a would be
a further research question. Very optimistically even we consider the value of a
to be 10, the cryptographic energy share still remains below 1%.
5
Conclusion
Number of energy eﬃcient implementations of AES and SNOW 3G have been
presented. Some of the implementations use the multiple cores of the CPU of the
mobile phone while others use ASIC. We have found that the ASIC implemen-
tations can provide the required throughput of 5G. We made assumptions about
a 5G network. Based on the assumptions and energy consumption related facts
of LTE network available in the literature, we have shown that energy consump-
tion for cryptographic computation is insigniﬁcant compared to the total energy
need of the phone when bulk data transfer takes place. It should be noted that
there might have other implementations of AES and SNOW 3G which are more
energy eﬃcient and provide the required throughput. But we did not look into
any other implementations as it is evident that even with the implementations
presented in this paper keeps the cryptographic energy share very low. However,
as 3GPP advances on deﬁning the 5G standards and more results on the energy
consumption of the radio interfaces of 5G are published, the exact cryptographic
energy share will be clearer.
Acknowledgement. Thanks to Kimmo J¨arvinen for his help to understand the ASIC
implementations and to Jarno Alanko for proofreading.
References
1. 3GPP TS36.323. http://www.3gpp.org/ftp/specs/archive/36 series/36.323/
2. 3GPP TS33.401. http://www.3gpp.org/ftp/specs/archive/33 series/33.401/
3. 3GPP TS36.331. http://www.3gpp.org/ftp/specs/archive/36 series/36.331/
4. Satoh, A., Morioka, S., Takano, K., Munetoh, S.: A compact Rijndael hardware
architecture with S-Box optimization. In: Boyd, C. (ed.) ASIACRYPT 2001. LNCS,
vol. 2248, pp. 239–254. Springer, Heidelberg (2001). https://doi.org/10.1007/3-
540-45682-1 15
5. Rudra, A., Dubey, P.K., Jutla, C.S., Kumar, V., Rao, J.R., Rohatgi, P.: Eﬃcient
Rijndael encryption implementation with composite ﬁeld arithmetic. In: Ko¸c, C¸.K.,
Naccache, D., Paar, C. (eds.) CHES 2001. LNCS, vol. 2162, pp. 171–184. Springer,
Heidelberg (2001). https://doi.org/10.1007/3-540-44709-1 16
6. Cao, Q., Li, S.: A high-throughput cost-eﬀective ASIC implementation of the AES
algorithm. In: 2009 IEEE 8th International Conference on ASIC (2009)
7. Alam, M., Ray, S., Mukhopadhayay, D., Ghosh, S., RoyChowdhury, D., Sengupta,
I.: Eﬃcient Rijndael encryption implementation with composite ﬁeld arithmetic.
In: Proceedings of the Conference on Design, Automation and Test in Europe
DATE 2007, pp. 1116–1121. Springer (2007)

412
M. Khan and V. Niemi
8. Huang, Y.-J., Lin, Y.-S., Hung, K.-Y., Lin, K.-C.: Eﬃcient implementation of AES
IP. In: 2006 IEEE Asia Paciﬁc Conference on Circuits and Systems (2006)
9. Hessel, S., Szczesny, D., Lohmann, N., Bilgic, A., Hausner, J.: Implementation and
benchmarking of hardware accelerators for ciphering in LTE terminals. In: Global
Telecommunications Conference, 2009 (2009)
10. Traboulsi, S., Sbeiti, M., Szczesny, D., Showk, A., Bilgic, A.: High-performance and
energy-eﬃcient sliced AES multi-block encryption for LTE mobile devices. In: 2011
IEEE 3rd International Conference on Communication Software and Networks
(2001)
11. Sriniwas Shastry, P.V., Kulkarni, A., Sutaone, M.S.: ASIC implementation of AES.
In: 2012 Annual IEEE India Conference (2012)
12. Szczesny, D., Showk, A., Hessel, S., Bilgic, A., Hildebrand, U., Frascolla, V.: Per-
formance analysis of LTE protocol processing on an ARM based mobile platform.
In: International Symposium on System-on-Chip, 2009 (2009)
13. Badawi, M., Hemani, A., Lu, Z.: Customizable coarse-grained energy-eﬃcient
reconﬁgurable packet processing architecture. In: 2014 IEEE 25th International
Conference on Application-Speciﬁc Systems, Architectures and Processors (2014)
14. Hessel, S., Szczesny, D., Bruns, F., Bilgic, A., Hausner, J.: Architectural analysis
of a smart DMA controller for protocol stack acceleration in LTE terminals. In:
2010 IEEE 72nd Vehicular Technology Conference Fall (VTC 2010-Fall) (2010)
15. Carroll, A., Heiser, G.: An analysis of power consumption in a smartphone. In:
USENIXATC 2010, Proceedings of the 2010 USENIX Conference on USENIX
Annual Technical Conference (2010)
16. Huang, J., Qian, F., Gerber, A., Morley Mao, Z., Sen, S., Spatscheckr, O.: A close
examination of performance and power characteristics of 4G LTE networks. In:
Proceedings of the 10th International Conference on Mobile Systems, Applications,
and Services (2012)
17. Managing LTE Core Network Signaling Traﬃc by David Nowoswiat. https://
insight.nokia.com/managing-lte-core-network-signaling-traﬃc
18. Traboulsi, S., Sbeiti, M., Bruns, F.: An optimized parallel and energy-eﬃcient
implementation of SNOW 3G for LTE mobile devices. In: 12th IEEE International
Conference on Communication Technology (ICCT) (2010)
19. Kitsos, P., Koufopavlou, O.G.: High performance ASIC implementation of the
SNOW 3G stream cipher. In: IFIP/IEEE VLSI-SOC08 - International Conference
on Very Large Scale Integration, Greece (2008)
20. Gupta, S.S., Chattopadhyay, A., Khalid, A.: Designing integrated accelerator for
stream ciphers with structural similarities. In: 15th International Conference on
Cryptology in India (2014)
21. SNOW 3G Encryption Core. http://www.ipcores.com/Snow3G.htm. Accessed 13
Dec 2016
22. NGMN Alliance, February 2015, NGMN 5G White paper. https://www.ngmn.org/
uploads/media/NGMN 5G White Paper V1 0.pdf
23. Ericsson White Paper on 5G Energy Performance. https://www.ericsson.com/res/
docs/whitepapers/wp-5g-energy-performance.pdf
24. 5G A Technology Vision. http://www.huawei.com/en/industry-insights/huawei-
voices/white-papers
25. 5G radio access. https://www.ericsson.com/res/docs/whitepapers/wp-5g.pdf
26. 5G
Nework
Architecture
Whitepaper.
http://www.huawei.com/en/industry-
insights/huawei-voices/white-papers
27. 5G Scenarios and Security Design. http://www.huawei.com/en/industry-insights/
huawei-voices/white-papers

LR-RZF Pre-coding for Massive MIMO
Systems Based on Truncated Polynomial
Expansion
Chi Zhang1(&), Zhengquan Li1,2, Yaoyao Sun1, Lianfeng Shen1,
and Xinxin Ni3
1 National Mobile Communications Research Laboratory,
Southeast University, Nanjing 210096, China
ci26zhang@163.com, {lzq722,220150799,
Ifshen}@seu.edu.cn
2 State Key Laboratory of Networking and Switching Technology,
Beijing University of Posts and Telecommunications, Beijing 100876, China
3 School of Electronic Engineering of Tongda College,
Nanjing University of Posts and Telecommunications, Yangzhou 225127, China
2215798002@qq.com
Abstract. In order to effectively eliminate multi-user interference at the
transmitter, the transmit signals are needed to be pre-processing, which is called
pre-coding. Traditional linear pre-coding algorithms, especially regularized zero
forcing (RZF) pre-coding, are famous for good performance and low compu-
tation complexity. However, they cause noise ampliﬁcation which requires high
transmit power to prevent. Lattice-reduction aided (LR-aided) technique is used
to deal with the row/column of matrix, which can make the matrix orthogonality
better. Therefore, to avoid noise ampliﬁcation as well as effectively eliminate the
multi-user interference, we propose a LR-RZF pre-coding algorithm which
based on matrix truncated polynomial expansion (TPE) with J terms. TPE
method can decrease the complexity of matrix inversion in RZF. Compared with
RZF pre-coding, LR-RZF pre-coding has lower bit error rate.
Keywords: LR  RZF  TPE  Massive MIMO
1
Introduction
Massive MIMO systems is able to cope with the exponential growth in number of user
terminals (UTs) and data trafﬁc, so recently the deployment of massive MIMO has
received a lot of attention. In this system, in order to effectively eliminate multi-user
interference at the transmitter, the transmit signals are needed to be pre-processing,
which is pre-coding. Pre-coding can be divided into linear and nonlinear pre-coding,
where the nonlinear pre-coding mainly has the dirty paper pre-coding [1] and the
constant envelope pre-coding [2, 3]. The basic idea of the dirty paper pre-coding is to
process the signals at the transmitter, so that the receiver cannot think of the inter-
ference exiting between users in the receive signals, which can increase the total system
capacity. While the basic idea of the constant envelope pre-coding is to pre-process the
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 413–419, 2018.
https://doi.org/10.1007/978-3-319-72823-0_39

information symbols, so that the signal amplitudes are the same, and the receiver can
recover the signals according to the signal phases. Unfortunately, the complexity of two
nonlinearly pre-coding algorithms are very high. Therefore, some scholars proposed
some low complexity pre-coding algorithms, in which the most famous is the regu-
larized zero forcing (RZF) pre-coding algorithm. However, its complexity increases
sharply when the number of antennas is large as it needs to compute matrix inversion.
Therefore, scholars proposed to replace the matrix inversion with approximate algo-
rithm. In [4, 5], authors used the matrix truncated polynomial expansion (TPE) to
replace the matrix inverse operation in RZF pre-coding algorithm to reduce the com-
putation complexity. But in this two references, only the sum of the mean square error
is minimized and the optimal polynomial coefﬁcients through optimization of power
allocation is obtained, respectively. The coherence of the base station transmit antennas
is considered [6, 7], in which the matrix TPE is used to carry out the linear pre-coding,
so as to avoid the computation of matrix inverse in the RZF pre-coding algorithm.
Lattice-Reduction (LR) technology is a kind of mathematical processing method
[8, 9]. The basic idea is that, the columns of a matrix A can be interpreted as the basis
of a lattice. The aim of the lattice reduction is to transform a given basis A into a new
basis consisting of roughly orthogonal basis vectors. For the channel matrix, because
each row/column vector is not orthogonal, and after the lattice reduction technique
processing, it can makes the row/column vector orthogonality better. In this paper, we
propose a LR-RZF pre-coding algorithm based on matrix TPE. The channel matrix is
handled by LR ﬁrst and gets good orthogonality. Then it is applied in RZF and RZF
based on the TPE pre-coding. Furthermore, we simulate the bit error rate of those
pre-coding algorithms.
The paper is organized as follows. In Sect. 2, we describe the system model. The
LR-RZF pre-coding algorithm based on matrix TPE is presented in Sect. 3. The
simulation results are in Sect. 4. Some conclusions are made in Sect. 5.
2
System Model
We consider a downlink massive MIMO system in which a base station (BS), equipped
with N transmit antennas, serves K single-antenna UTs, where N  K. Suppose
hk  CN(0N1; U=KÞ represents the random channel vector between the transmit
antennas at BS and the kth UT (1  k  K), where U is the channel covariance
matrix with N  N, and 0N1 is a zero vector. The signals needed by the K sin-
gle-antenna UTs can be represented by s = [s1,…,sk,…,sK]T, where sk is the signal of
the kth UT which satisﬁes sk * CN(0,1), and ()T denotes the transpose of a matrix.
Suppose G = [g1,…,gk] is the pre-coding matrix with N  K. The signal s is trans-
mitted to the mobile UTs via the base station antennas after the pre-coding. So the
received signal of the kth UT is
yk ¼ hH
k Gs þ nk ¼ hH
k gksk þ
X
K
n¼1;n6¼k
hH
k gnsn þ nk
ð1Þ
414
C. Zhang et al.

where nk is the additive circularly symmetric complex Gaussian noise at the kth UT,
which satisﬁes nk * CN(0,r2), where r2 is the receiver noise variance. And ()H
denotes the conjugate transpose of a matrix or a vector. Suppose that the total transmit
power satisﬁes as follow
1
K trðGGHÞ ¼ P
ð2Þ
where tr() is the trace of a matrix.
Then receive signal is detected as
^s ¼ G1XðykÞ
ð3Þ
where XðÞ is detection rule.
We suppose that the transmitter does not know the perfect instantaneous channel
state information (CSI) ^hk of each mobile UT. Based on the model in [10, 11], we
suppose that the instantaneous channel of the kth UT obey Gauss-Markov distribution.
In other words, ^hk can be expressed as follow
^hk ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  s2
p
hk þ snk
ð4Þ
where s is a scalar parameter which indicates the quality of the instantaneous CSI,
which satisﬁes s 2 [0, 1]. We can get perfect instantaneous CSI and only statistical
knowledge of channel for s = 0 and s = 1, respectively. Assuming that the joint
imperfect channel matrix of all user channels can be denoted by ^H ¼ ½^h1;    ; ^hK	, with
N  K.
3
LR-RZF Pre-coding Algorithm Based on the TPE
We conducted LR decomposition of the channel matrix ^H, assuming that the
decomposition of the matrix ^H into matrix ~H, the two matrices are satisﬁed [8, 9]
~H ¼ ^HT
ð5Þ
where T is a unimodular matrix with K  K, it contains only Gaussian integers and det
(T) = ± 1 or ± j. The LR decomposition algorithm is listed in Algorithm 1.
LR-RZF Pre-coding for Massive MIMO Systems
415

Similar to [6, 11], we deﬁne LR-RZF pre-coding algorithm as
GLRRZF ¼ b~H ~H
H ~H þ nIK

1
¼ b ~H~H
H þ nIN

1 ~H
ð6Þ
where b is the power normalization parameter, which is set such that the pre-coding
matrix GRZF satisﬁes the power constraint in (2). The parameter n depends on the total
transmit power P, the noise variance r2, the scalar parameter s affecting the instan-
taneous CSI, and system dimensions [11, 12].
Inspecting (6) shows that, when the base station antenna number N is very large, the
complexity of the N  N matrix ~H~H
H þ nIN inversion is very high. In order to reduce
the computational complexity, the matrix inversion can be replaced by a matrix TPE.
From [11] we know that for any positive deﬁnite Hermitian matrix X, when the
parameter a is selected such that 0\a\
2
maxn knðXÞ, the inverse of the matrix X can be
expressed as
416
C. Zhang et al.

X1 ¼ a I  I  aX
ð
Þ
ð
Þ1¼ a
X
1
l¼0
I  aX
ð
Þl
ð7Þ
By substituting (7) and the expression a þ b
ð
Þl¼
l
n


alnbn into (6), we can get the
polynomial expansion of the pre-coding matrix GLR-RZF, and we just only consider the
ﬁrst J terms because of the low-order terms are the most inﬂuential ones. So we have
GLRRZF ¼ b ~H~H
H þ nIN

1 ~H 
X
J1
l¼0
xl ~H~H
H

l ~H
ð8Þ
where xl is a scalar parameter, and its value is seen in [11].
4
Simulation results
In this section, we calculate the bit error rate performance of pre-coding algorithms,
including RZF, LR-RZF, RZF based on the TPE and LR-RZF based on the TPE.
The MIMO system has 8 transmit antennas in the BS and 8 antennas at receiver. The
transmit symbols are modulated by BPSK and QPSK respectively. The detection
method is MMSE.
According to Fig. 1, it can be seen that the BER performance of LR-RZF is better
than RZF in the same condition using BPSK modulation. The channel matrix H is
generated randomly which is independent and identically complex Gaussian random
variables. When H is handled by LR algorithm, it is more orthogonal and the channel
condition is improved. Therefore, at the target BER of 104, LR-RZF gains about 4 dB
transmit power compared with RZF which needs 25 dB SNR. What is more, LR-RZF
can get 106 BER performance at 45 dB. However, the BER performance of RZF
Fig. 1. BER performances of RZF pre-coding schemes with BPSK modulation
LR-RZF Pre-coding for Massive MIMO Systems
417

based on the TPE is worse than RZF because it estimates the matrix inversion with
3-order TPE. At low SNR, the performance of LR-RZF based on the 3-order TPE is
worse than RZF based on the 3-order TPE. When SNR is 27 dB, two pre-coding has
similar BER performance. With the increase of SNR, LR-RZF based on the 3-order
TPE gains better performance. Besides, LR-RZF based on the 3-order TPE is able to
get 105 BER performance at 50 dB.
According to Fig. 2, the transmit signal is modulated by QPSK. At the target BER
of 103, RZF needs about 28 dB SNR. LR-RZF gains about 3 dB transmit power
compared with RZF. LR-RZF can get nearly 105 BER performance at 45 dB. At low
SNR, LR-RZF based on 3-order TPE is not good. When SNR is 26 dB, LR-RZF based
on 3-order TPE has similar performance compared with RZF based on the 3-order TPE.
With the increase of SNR, LR-RZF based on 3-order TPE has better BER performance.
At about 50 dB, it can get 105 BER performance.
5
Conclusion
In this paper, we proposed a LR-RZF pre-coding algorithm based on the TPE. We
apply LR algorithm to deal with channel matrix and make it more orthogonal. Then the
improved channel matrix is used in RZF and RZF based on the TPE pre-coding.
Therefore, improved pre-coding algorithm can decrease the noise ampliﬁcation and
multi-user interference. It can be seen that LR-RZF gets good BER performance than
RZF. LR-RZF based on the TPE is not good when SNR is low, but gets better BER
performance with the increase of SNR.
Fig. 2. BER performances of RZF pre-coding schemes with QPSK modulation
418
C. Zhang et al.

Acknowledgments. This work was supported in part by the National Natural Science Foun-
dation of China (61571108), the Open Foundation of State key Laboratory of Networking and
Switching Technology (Beijing University of Posts and Telecommunications) (SKLNST-2016-
2-14), and the China Postdoctoral Science Foundation Funded Project (No. 2012M511175).
References
1. Peel, C.B.: On “Dirty-Paper coding”. IEEE Signal Process. Mag. 20(3), 112–113 (2003)
2. Mohammed, S.K., Larsson, E.G.: Per-antenna constant envelope precoding for large
multi-user MIMO systems. IEEE Trans. Commun. 61(3), 1059–1071 (2013)
3. Pan, J., Ma, W.K.: Constant envelope precoding for single-user large-scale MISO channels:
efﬁcient precoding and optimal designs. IEEE J. Sel. Top. Signal Proces. 8(5), 982–995
(2014)
4. Zarei, S., Gerstacker, W., Muller, R.R., et al.: Low-complexity linear precoding for
downlink large-scale MIMO systems. In: IEEE International Symposium on Personal Indoor
and Mobile Radio Communications, pp. 1119–1124. IEEE (2013)
5. Zarei, S., Gerstacker, W., Schober, R.: A low-complexity linear precoding and power
allocation scheme for downlink massive MIMO systems. In: Asilomar Conference on
Signals, Systems and Computers, pp. 285–290 (2013)
6. Mueller, A., Kammoun, A., Björnson, E., et al.: Linear precoding based on polynomial
expansion: reducing complexity in massive MIMO. EURASIP J. Wirel. Commun. and
Netw. 2016(1), 63 (2016)
7. Kammoun, A., Muller, A., Bjornson, E., et al.: Linear precoding based on polynomial
expansion: large-scale multi-cell MIMO systems. IEEE J. Sel. Top. Signal Proces. 8(5),
861–875 (2014)
8. Yao, H., Wornell, G.W.: Lattice-reduction-aided detectors for MIMO communication
systems. In: Global Telecommunications Conference, GLOBECOM 2002, vol.1, pp. 424–
428. IEEE (2002)
9. Chockalingam, A., Rajan, B.S.: Large MIMO Systems. Cambridge University Press, New
York (2013). IEEE
10. Muller, A., Kammoun, A., Bjornson, E., et al.: Efﬁcient linear precoding for massive MIMO
systems using truncated polynomial expansion. In: Sensor Array and Multichannel Signal
Processing Workshop. pp. 273–276. IEEE (2014)
11. Wagner, S., Couillet, R., Debbah, M., et al.: Large system analysis of linear precoding in
correlated MISO broadcast channels under limited feedback. IEEE Trans. Inf. Theory 58(7),
4509–4537 (2013)
12. Peel, C.B., Hochwald, B.M., Swindlehurst, A.L.: A vector-perturbation technique for
near-capacity multiantenna multiuser communication, Part I: channel inversion and
regularization. IEEE Trans. Commun. 53(1), 195–202 (2005)
LR-RZF Pre-coding for Massive MIMO Systems
419

A Geographic Packet Forwarding Approach
in 3D Mobile Ad Hoc Networks
Xiaolin Gao1,3(&), Guiting Zhong2, Jian Yan2, and Jianhua Lu1
1 Department of Electronic Engineering, Tsinghua University,
Beijing 100084, China
sgyybaby@126.com, lhh-dee@tsinghua.edu.cn
2 Tsinghua Space Center, Tsinghua University, Beijing 100084, China
zhonggt12@mails.tsinghua.edu.cn,
yanjian_ee@tsinghua.edu.cn
3 Beijing Aerospace Control Center, Beijing 100094, China
Abstract. In high dynamic 3D mobile ad hoc network, the mobility of node is
the main factor that causes the topology change and the route instability. In this
paper, we proposed a novel geographic forwarding approach based on node
mobility features (FBMF) and selection of the relay node via distributed
cooperation among receivers for highly dynamic 3D Ad hoc networks. Node
mobility features are deﬁned as the mobility factor which considers not only the
individual node mobility but also the relative mobility of the other node. The
proposed forwarding approach make use of node mobility features to select
relay node. Simulation results show that compared with other methods, the
proposed approach is more efﬁcient in terms of packet delivery ratio and
end-to-end delay, in other words, the stability of route is promoted in the highly
dynamic mobile environment.
Keywords: 3D Ad hoc network  Geographic route  Greed forwarding
Random forwarding  Mobility factor
1
Introduction
In recent years, with the research and application of mobile Ad hoc networks, the
application scenario has been extended from the traditional terrestrial 2D scene to the
spatial 3D scene. Therefore, some new research areas have emerged, such as the Ad
Hoc Network [8], UAV network [3], and underwater ad hoc network [2] and so on. The
general characteristics of these networks are high-speed movement of nodes in 3D
space, large-scale network distribution scenario and highly dynamic topology, which
belong to 3D mobile Ad Hoc Networks (3D MANET). 3D MANET routing protocol is
one of the important technologies to realize the out-of-sight transmission between
network nodes, which has aroused the concern of researchers. The routing protocol
based on geographical position information could realize the packet forwarding only by
keeping the position information of the destination node. So the node does not maintain
the end-to-end route, which is more suitable for such large-scale 3D MANET.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 420–428, 2018.
https://doi.org/10.1007/978-3-319-72823-0_40

References [1, 4, 5, 7, 9] proposed a variety of routing protocol for 3D MANET
based on the position information. This kind of routing protocol adopts the greedy
forwarding approach. However, when a candidate node closer than the current relay
node to the destination does not exist, a routing hole problem of the greedy forwarding
approach would happen, which could degrade the protocol performance. In [6, 10], a
random forwarding approach based on position information is proposed, which uses the
distance between the relay node and the destination node as the route metrics to select
next-hop node set (CNS). In this approach, the broadcast characteristics of the channel
were used to realize multiple potential relay nodes to compete and decide whether to
become the relay node autonomously. It improves the performance of the protocol.
However, the forwarding approach in the above-mentioned protocol only considers
the static characteristics of the nodes. When selecting the relay nodes, the neighbor
nodes are usually selected nearest to the destination nodes. This usually causes the
selected relay nodes to be located near the communication radius of the source node. In
the highly dynamic network such as 3D MANET, when the above-mentioned for-
warding approach is used, the mobility of the node will cause the link to be switched on
and off frequently. In this kind of network, the distance between nodes couldn’t fully
reﬂect the path quality, that is, the stability of the route is also affected by the link
duration (lifetime) between relay nodes. Node mobility will affect the establishment of
reliable routing, and thus affect the reliability of packet delivery performance and delay
performance.
In this paper, we propose a geographic forwarding approach based on mobility
features of the nodes (FBMF). In the selection of relay nodes, the mobility of nodes is
taken into full account. The position information and the stability factor which is the
function of the mobility of nodes and their neighbors are used as the routing metric to
provide the basis for the selection of relay nodes. Because the mobility characteristics
of the node are fully considered in the process of relay node determining, compared
with the other geographic forwarding approach, the performance (which main
parameters are the packet delivery ratio and the end-to-end delay) of the proposed
forwarding approach have improved. Finally, the simulation results prove this point.
2
Positioning Service and Forwarding Policy
In this section, we deﬁne notations and terms used throughout this article. Then the
proposed geographic packet forwarding approach is presented. We assume that:
1. Each node knows its geographic position.
2. Each node knows the geographic position of all other nodes, including the target
node.
We further assume that the geographic position of each node is unique. In general, the
geographic position of the node can be obtained by GPS or any other positioning
algorithms. The position information of neighbor nodes is distributed by the beacon
exchange between each other. The positioning service is essential to accomplish packet
forwarding in the proposed geographic routing protocol.
A Geographic Packet Forwarding Approach
421

We need to get the position information of the destination node through position
service on account of the node mobility. With a focus on the impact of node mobility
on packet forwarding performance, this work assumes that each node has implemented
position service.
The relay node selection scheme is shown in Fig. 1. The communication radius of
all nodes in the network is R. That is, when the distance between two nodes is less than
R, the two-way communication link can be established. When the distance is larger
than R, the link is broken. The nodes are moving at constant speed V. The direction of
the node is unchanged during the move; The movement speed and direction of nodes
are independent of each other.
As shown in Fig. 1, Ps is the position information of the source node S, which is
represented as (xs, ys, zs). The position information of the destination node D is Pd,
which is represented as (xd, yd, zd). N is deﬁned as the neighbor nodes set of source
node, which is represented as N ¼ fn1; n2; . . .; nmg.
N0 is deﬁned as candidate next-hop node set
N0 ¼ fni : Lmin  Li  Rg;
ð1Þ
and N0  N: Lmin is deﬁned as the minimum advance value, which is the condition to
select the relay node set. Li is the distance from the source node S to the destination
node D when the node ni is chosen as the relay node, which is represented as
Li ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxs  xniÞ2 þ ðys  yniÞ2 þ ðzs  zniÞ2
q
 cos a:
ð2Þ
In order to avoid repeating forward, the candidate next hop nodes that received a
packet wait for a back-off time before forwarding the packet. Tni
f is the back-off time of
node ni, which is computed on the position of node ni, source node position, destination
node position and the metrics Mni, following Eq. (3)
Fig. 1. Illustrations of the scheme used to select neighbors as forwarders
422
X. Gao et al.

Tni
f ¼ k  max
ni2N0
1
dðPs; PdÞ  dðPni; PdÞ 
1
dðPni; PsÞ


 Mni:
ð3Þ
The triangle inequality asserts that candidate next-hop nodes could hear packet
forwarding each other. The metrics Mni is determined by the stability factor and the
distance information. The short back-off time should mean good position advancement
and high relatively stable.
FBMF Forwarding Process
– The source node S selects the candidate next-hop node set N0, according to the
position information Pd of the destination node D.
– Sending the packet to the candidate next-hop node set, which includes the ID of the
source node S, the ID of the destination node D, the position information and the
speed information.
– The node that received the packet calculates the back-off time according to the
position information and the metrics in the received packet. Equation (3) shows that
the shorter the back-off time, the higher the probability that the node will be selected
as the relay node, which could cooperate with the other relay nodes to decide the
forwarding order/priority. The metrics information is determined by the stability
factor and the distance information, the calculation method of metrics information is
shown in the following section.
In this forwarding approach, when the candidate relay node receives the packet, it
sends it in the order of the back-off time. Obviously, a node with a short back-off time
has high priority than a node with a long back-off time. After the other candidate relay
node has heard the packet has been forwarded, it discards the local corresponding
packet. When the candidate relay node does not detect that the packet is forwarded
within a certain period of time, it thinks the packet fails to be forwarded, and then
forwards the packet automatically. Therefore, this method does not require message
loss recovery mechanism. Compared to the greedy forwarding strategy, it could reduce
the feedback information. On the other hand, this method is easier to extend than the
GeRaF approach [10], which is based on the handshake mechanism of MAC protocol
to cooperative between the candidate relay nodes’ order/priority.
3
Calculation of Metrics
The selection of the candidate next-hop node set is the key factor which would affect
the performance of the forwarding protocol. The node based on GeRaF [10] measures
the geographical distance, and it only needs to know the position of neighboring nodes
and the destination node. It uses the distance from each neighbor to the destination
node as a measure to select the set of relay nodes. The proposed method uses a static
factor S and distance parameter L as the standard of metrics M calculation. The great
value of the node-static factors and the close to the destination node would mean the
node is in the high the forwarding priority, and the node is more likely to be selected as
a relay node. The metrics M takes into account the mobility of the nodes and the group
A Geographic Packet Forwarding Approach
423

mobility of their neighbors (represented by the static factor S), and the distance
parameter Ld, which is a function of both. The following is a detailed calculation
process.
3.1
Static Factor
The three velocity components of a node ni in the relay node set N0 are vix, viy, viz,
respectively.
The different between the average speed of the node ni and the average speed of the
source node S are
Dv2i ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðvix  vsxÞ2 þ ðviy  vsyÞ2 þ ðviz  vszÞ2
q
ð4Þ
The average velocity components of the group of neighbor nodes of node ni are vx,
vy, vz, respectively.
And
vx ¼ 1
m
X
i2I
vix;vy ¼ 1
m
X
i2I
viy;vz ¼ 1
m
X
i2I
viz;
where I is the neighbor nodes set of node ni, and m is the number of the neighbor nodes.
The difference between the average speed of the node ni and the neighbor group is
Dv1i ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðvix  vxÞ2 þ ðviy  vyÞ2 þ ðviz  vzÞ2
q
ð5Þ
The static factor Si is deﬁned as follows
Si ¼ Dv1i þ Dv2i
2 V
j j
ð6Þ
It represents the relative motion stability of a single node ni relative to the source
node and its neighbor node set.
From the Eq. (6), the small the relative speed of the source node, and the small the
dynamics of the whole neighbor group, would mean the node ni is relatively stable.
3.2
Calculation of Routing Metrics
The metrics Mi of the node ni takes into account the static factor Si and the distance
parameter Ldi.
The formula is:
Mni ¼ ðSi þ 1ÞL00
di
ð7Þ
L00
di is the normalized distance, which is deﬁned as:
424
X. Gao et al.

L00
di ¼
Ldi
Lsd  Lmin
ð8Þ
The inﬂuence of the static factor S and the distance parameter Ld on the metrics
parameters is shown in Fig. 2. As it can be seen from Fig. 2, the great the static factor
S and the great the distance result to the great the metrics. According to Eq. (3) the
node has the longer back-off time, which would have the lower forwarding priority.
Since node only calculates their own metrics M, it may determine the forwarding
order/priority in a distributed manner.
From the calculation process of the metric M, the algorithm actually weighs the
mobility and position characteristics of the nodes and chooses the node with low
mobility and near to the destination node as the relay nodes.
4
Simulation Results
Comparison of three methods of 3D Greedy forwarding (3DGF), 3D random for-
warding (3DRAF) and the forwarding approach based on mobility features (FBMF)
proposed in this paper are carried out. The simulation environment is as follows: 50
nodes are randomly distributed in the
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
L2 þ H2=2
p

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
L2 þ H2=2
p
3D space. L is the
maximum length and width of the node distribution range, the value is 15 km. H is the
maximum height of the node distribution range, the value is 10 km. The node’s
velocity component is given by (−V, +V), and V is the maximum velocity of the node
movement. After the node reaches the boundary of the region, it returned to the
simulation area at the original speed. The bounce angle is randomly selected between
[0, 2p]. Since 3DRAF forwards based strategy of RTS/CTS, the simulation using the
Fig. 2. Inﬂuence of S and L00
di on M
A Geographic Packet Forwarding Approach
425

IEEE 802.11 MAC protocols, the data transfer rate is 2 Mbit/s. Trafﬁc model is the
continuous bit rate (CBR), trafﬁc packet length is 1024 bits, packet interval is 0.1 s.
Each source node randomly selects the nodes in the simulation region as the destination
node.
Figure 3 shows the results of the packet delivery ratio of three forwarding
approaches under different moving speeds. When the node speed is 0, the network is a
static, and the packet delivery ratio of the three methods is all higher than 85%. Due
that 3DRAF and FBMF methods take into account the broadcast characteristics of the
wireless channel and adopt the relay node cooperation mechanism, they achieved
higher packet delivery ratio than 3DGF method. With the increase of the node’s
moving speeds, the dynamic of the network increases gradually, then the packet
delivery ratio of 3DGF and 3DRAF decreases obviously. However, FBMF considers
the mobility of the nodes in the selection of relay nodes, the node with low relative
mobility (high stability) is selected as the relay node, thus maintaining a stable high
packet delivery ratio.
Figure 4 shows the comparison of average end-to-end delay. Since FBMF chooses
a node that is close to the destination node and with a smaller relative mobility (high
stability) as the next-hop forwarding node, it reduces the possibility of routing holes
(no next-hop nodes) which would increase the number of forwarding. Therefore, under
dynamic network conditions compared to the other two forwarding approaches to get a
lower average end to end delay.
Fig. 3. Packet delivery ratio
426
X. Gao et al.

5
Conclusions
In high dynamic 3D mobile ad hoc network, the mobility of node is the main factor that
causes the topology change and affects the route stability. Therefore, taking node
mobility into consideration in the process of relay node selection and path maintenance
can improve the performance of routing algorithm. In this paper, we proposed a routing
metrics based on node mobility, then presented a forwarding strategy make use of the
routing metrics. The simulation results show that the packet delivery and end-to-end
delay are better than the other two types of forwarding approaches when the node
moves at high speed. Therefore, the performance of this approach under high dynamic
conditions has obvious advantages.
Acknowledgment. This work is partially supported by Natural Science Foundation of China
under Grant No. 91338108, 91438206.
References
1. Cadger, F., Curran, K., Santos, J., Moffett, S.: A survey of geographical routing in wireless
Ad-hoc networks. IEEE Commun. Surv. Tutor. 15(2), 621–653 (2013)
2. Foo, K., Atkins, P., Collins, T., Pointer, S., Tiltman, C.: Sea trials of an underwater, Ad-hoc,
acoustic network with stationary assets. IET Radar Sonar Navig. 4(1), 2–16 (2010)
3. Frew, E., Brown, T.: Airborne communication networks for small unmanned aircraft
systems. Proc. IEEE 96(12), 2008–2027 (2008)
4. Liu, C., Wu, J.: Efﬁcient geometric routing in three dimensional Ad-hoc networks.
IEEE INFOCOM 2009, 2751–2755 (2009)
Fig. 4. End to end delay
A Geographic Packet Forwarding Approach
427

5. Liu, S., Fevens, T., Abdallah, A.E.: Hybrid position-based routing algorithms for 3D mobile
ad hoc networks. In: 2008 The 4th International Conference on Mobile Ad-hoc and Sensor
Networks, pp. 177–186, December 2008
6. Odorizzi, A., Mazzini, G.: M-GeRaF: a reliable random forwarding geographic routing
protocol in multisink Ad-hoc and sensor networks. In: 2007 International Symposium on
Intelligent Signal Processing and Communication Systems, pp. 416–419, November 2007
7. Tahan, A.M.A., Watfa, M.K.: A position-based routing algorithm in 3D sensor networks.
Wirel. Commun. Mob. Comput. 12(1), 33–52 (2010)
8. Zheng, B., Zhang, H., Huang, G., Ren, Q.: Status and development of aeronautical Ad-hoc
networks. Telecommun. Sci. 27(5), 38–47 (2011)
9. Zhou, J., Chen, Y., Leong, B., Sundaramoorthy, P.S.: Practical 3D geographic routing for
wireless sensor networks. In: Proceedings of the 8th ACM Conference on Embedded
Networked Sensor Systems, pp. 337–350. ACM (2010)
10. Zorzi, M., Rao, R.: Geographic random forwarding (GeRaF) for Ad-hoc and sensor
networks: energy and latency performance. IEEE Trans. Mob. Comput. 2(4), 349–365
(2003)
428
X. Gao et al.

Probabilistic Caching in Wireless Device
to Device Networks with Contention Based
Multimedia Delivery
Xiaoshi Song(&), Yuting Geng, Xiangbo Meng, Ning Ye, Jun Liu,
and Weimin Lei
Northeastern University, Shenyang 110819, China
songxiaoshi@cse.neu.edu.cn
Abstract. This paper studies the optimal probabilistic caching placement in
large-scale cache-enabled D2D networks to maximize the cache hit performance,
which is deﬁned as the probability that a random user request can be served by
mobile helpers (MHs) in the vicinity. To avoid collisions of the concurrent
transmissions, a contention based multimedia delivery protocol is proposed,
under which a MH is allowed to transmit only if its back-off timer is the smallest
among its associated contenders. By applying tools from stochastic geometry, the
optimal caching probability is derived and analyzed. It is shown that the optimal
solution of the probabilistic caching placement depends on the density of MHs,
the D2D communication range, and the user request distribution. With the
derived optimal caching probabilities, we further characterize the transmission
probability of MHs and thereby the successful content delivery probability of the
cache-enabled D2D network. Simulations are provided to validate our analysis.
Keywords: Cache-enabled D2D networks
Contention based multimedia delivery protocol
Optimal probabilistic caching strategy  Stochastic geometry
Transmission probability  Cache hit probability
Successful content delivery probability
1
Introduction
The proliferation of smart mobile devices has triggered an explosive increase of data
trafﬁc over recent years, mainly driven by the ever-growing demand of bandwidth-
intensive multimedia services. Predicted by Cisco [1], the mobile data trafﬁc is
expected to reach 30.6 exabytes per month by 2020, an eightfold increase over 2015, in
which more than 80% would be contributed by multimedia streaming. Facing such an
unprecedented growth of multimedia data trafﬁc over the air, it is crucial for mobile
operators to seek and leverage more advanced techniques to facilitate the content-
centric design of next generation wireless networks [2–4].
The emerging cache-enabled device-to-device (D2D) communication paradigm is
considered to be an effective approach to tackle the mobile data tsunami induced by
massive demands on multimedia content delivery [5–9]. Particulary, with caching
abilities enabled at the proximate mobile devices (helpers), the D2D communication
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 429–444, 2018.
https://doi.org/10.1007/978-3-319-72823-0_41

can cost-effectively bring the multimedia contents closer to users, and simultaneously
exploit the spatial recuse and (coded or uncoded) multicasting opportunities in data
dissemination to relieve the heavy burden of the fast growing trafﬁc.
Existing works on the modeling and analysis of cache-enabled D2D communica-
tion has taken two main directions. The ﬁrst line of work [10, 11] focuses on the
theoretical analysis of asymptotic scaling laws for cache-enabled D2D networks under
the classic protocol model, where the reception of a data packet from source u to
destination v is assumed to be successful only if their transmission distance d(u, v) is
less than or equal to a predeﬁned collaboration range r, and no other concurrent
transmissions is within distance ð1 þ DÞr from destination v for D [ 0: Particularly, in
[10], Ji et al. characterized the optimal throughput-outage tradeoff for cache-enabled
D2D networks in terms of scaling laws, under the assumption that both the number of
users n and the library size m grow to inﬁnity. With decentralized random caching and
unicast delivery, it was shown in [10] that, for arbitrary outage probability q 2 (0, 1),
the per-user throughput of the cache-enabled D2D networks can achieve a bit rate of
order M
m, where M denotes the caching capacity of each device and M  M
m. Based on
[10], in [11], Ji et al. further characterized the scaling laws of the same cache-enabled
D2D network by applying both spatial reuse and coded multicasting. Interestingly and
somehow counterintuitively, it was shown in [11] that the gain of spatial reuse and the
gain of the coded multicasting do not accumulate in the order sense.
The second line of work [12–17] considers the physical model, where the suc-
cessful communication between two nodes is based on the received signal-to-
interference ratio (SIR) or signal-to-interference-plus-noise ratio (SINR). Tools from
stochastic geometry have been widely applied in this category for tractable charac-
terization of key network performance metrics, such as coverage, rate, and spatial
throughput. Particularly, in [12], Jarray et al. studied the hit performance of caching in
D2D networks for different degrees of node mobility. In [13], Malak et al. developed
the optimal spatially-independent content caching strategies that aim to maximize the
average density of successful receptions under different fading distributions. In [14],
Malak et al. further investigated the optimal geographic content placement problem for
D2D networks, and proposed spatially correlated caching strategies to maximize the
D2D cache hit probability. In [15], Afshang et al. characterized the performance of
cluster-centric content placement in a cache-enabled D2D network by developing a
comprehensive analytical framework with foundations in stochastic geometry. In [16],
Chen et al. provided analytical and numerical results to compare the performance of
caching at mobile devices and caching at small cells, in terms of the cache hit prob-
ability, the density of cache-served requests and average power consumption. In [17],
Chen et al. studied the optimal caching probabilities with numerical optimization by
analyzing a closed-form approximation of cache-aided throughput, which measures the
density of successfully served requests by local device caches.
Interference management is of critical importance in the design of cache-enabled
D2D networks. With elaborate interference management schemes, the effective spatial
reuse and thereby the overall performance of cache-enabled D2D networks can be sig-
niﬁcantly improved. It is worth noting that in the above prior works [10–17], the inter-
ference management issue of cache-enabled D2D networks has not been well addressed.
430
X. Song et al.

Particularly, in [10, 11], the studied protocol model and the corresponding guard-zone
based interference avoidance strategy failed to capture the effect of small-scale fading and
aggregate interference on the performance of successful reception. While in [12–17],
though tractable analytical results on network performance were characterized under the
physical model, the interference management problem was not discussed. As such, the
beneﬁts of advanced interference management mechanisms in enhancing the perfor-
mance of cache-enabled D2D networks remain to be explored.
In this paper, we investigate the optimal probabilistic caching strategy in large-scale
cache-enabled D2D networks under the physical model to maximize the cache hit
performance, which is deﬁned as the probability that a random user request can be
served by mobile helpers (MHs) in the vicinity. Different from that in [12–17], a
contention based multimedia delivery protocol is proposed to tackle the interference
management issue, which is described as follows.
Contention based Multimedia Delivery Protocol: In the content delivery phase, to
avoid collisions among the concurrent transmissions, the MHs under requests are
assumed to each start with a random back-off timer, which is uniformly distributed on
[0, 1]. By monitoring the medium, a MH then makes decision to initiate its trans-
mission if no contender with contention threshold Nd is detected prior to the expiration
of its back-offer timer, while otherwise it defers. In other words, in the content delivery
phase, under the proposed contention based multimedia delivery protocol, a MH under
request is allowed to transmit only if it has the minimal back-off timer among its
contenders with contention threshold Nd.
It is worth noting that under the proposed contention based multimedia delivery
protocol, due to the interactions among the concurrent transmissions, the positions of
the active MHs are in general dependent. As a result, how to effectively characterize the
dependencies among the active MHs is the major challenge to be tackled in this paper.
The remainder of this paper is organized as follows. The system model and per-
formance metrics are described in Sect. 2. The optimal probabilistic caching placement
is characterized in Sect. 3. The transmission probability of MHs is derived in Sect. 4.
The successful content delivery probability of the cache-enabled D2D networks is
analyzed in Sects. 5. Simulation results are presented in Sect. 6. Finally, we conclude
the paper in Sect. 7.
2
Model and Metrics
2.1
System Model
We consider a large-scale cache-enabled D2D network formed by dedicated MHs,
intended UEs, and a library of multimedia ﬁles F :¼ f1; 2;    ; Fg on R2 as illustrated
in Fig. 1. The locations of MHs and UEs are modeled as two independent HPPPs with
density km and ku, respectively. To simplify the analysis, it is assumed that the ﬁles in
library F are of the same size, and each MH has a cache memory of M = 1 ﬁle.
A decentralized probabilistic caching strategy is investigated in this paper, under which
the MH randomly caches the f -th ﬁle in F with probability cf. We further assume that
the popularity of the f-th ﬁle in F follows the Zipf distribution as
Probabilistic Caching in Wireless Device to Device Networks
431

pf ¼
1=f c
RF
j¼11=jc ;
ð1Þ
where 0 < c < 1 denotes the Zipf parameter.
The propagation channel is modeled as the combination of the small-scale Rayleigh
fading and the large-scale path-loss given by
gðdÞ ¼ hda;
ð2Þ
where h denotes the exponentially distributed power coefﬁcient with unit mean, d de-
notes the propagation distance, and a denotes the path-loss exponent. The transmit
power of MHs is denoted by Pd. For the sake of simplicity, we ignore the thermal noise
in the regime of interest and simply focus on the received signal-to-interference ratio
(SIR). Let Rd denote the collaboration distance of D2D transmission between MH and
UE. We further denote hd as the SIR target for successful data receptions under D2D
communication.
To avoid collisions among the concurrent transmissions, a contention based mul-
timedia delivery protocol with contention threshold Nd is proposed, under which a
content request from the UE can be served iff:
MH
UE
Cache
File Request
D2D Link
MH
UE
Cache
File Request
D2D Link
Fig. 1. Cache-enabled D2D network formed by dedicated MHs, intended UEs, and a library of
multimedia ﬁles F.
432
X. Song et al.

1. The requested ﬁle is available at the MHs (denoted by eligible MHs) within a
distance of Rd.
2. At least one of the eligible MHs has the minimal back-off timer among its con-
tenders1 with contention threshold Nd.
Upon ﬁnding the eligible MHs, the UEs then associate with the nearest ones for
data transmission.
2.2
Performance Metric
The performance metrics studied in this paper are speciﬁed as follows.
Transmission Probability: The transmission probability of MH, denoted by qd, is
deﬁned as the probability that a MH is eligible to launch the transmission.
Cache Hit Probability: The cache hit probability, denoted by nd; is deﬁned as the
probability that a randomly requested ﬁle can be found at the caches of eligible MHs
which are able to launch the transmissions within a distance of Rd Let nf denote the
conditional cache hit probability for the f-th ﬁle in F. Then, the cache hit probability nd
of the cache-enabled D2D network is given by
nd ¼
X
F
f ¼1
pf  nf :
ð3Þ
Coverage Probability: The coverage probability of a randomly requested ﬁle is
deﬁned as the probability that a UE succeeds in decoding the received data packets of
the ﬁle from its associated MH. In particular, for the f-th ﬁle in F, given the received
SIR SIRf ; and the SIR target hd; the coverage probability Cf is deﬁned as
cf ¼ Pr SIRf  hd


:
ð4Þ
Successful Content Delivery Probability: The successful content delivery probability
in cache-enabled D2D networks, denoted by sd; is deﬁned as the probability that a
random UE request is successfully served by MHs within a distance of Rd. In particular,
for the f-th ﬁle in F, given the conditional cache hit probability nf ; and the coverage
probability Cf ; the successful content delivery probability sd of the cache-enabled D2D
network is deﬁned as
sd ¼
X
F
f ¼1
pf  nf  Cf
ð5Þ
1 For two eligible MHs located at x and y, we say y is a contender of x with contention threshold
Nd if Pdhjy  xja  Nd:
Probabilistic Caching in Wireless Device to Device Networks
433

3
Optimal Probabilistic Caching Placement
In this section, we derive the optimal probabilistic caching placement to maximize the
cache hit performance. We ﬁrst obtain the following lemma.
Lemma 1. The cache hit probability of the studied large-scale cache-enabled D2D
network is given by
qd ¼ 1 
X
F
f ¼1
pf ekmcf pR2
d;
ð6Þ
where F denotes the size of library F
Proof. Given pf, cf, and Rd, (6) can be immediately obtained by characterizing the void
probability that none of the MHs within a distance of Rd caches the requested ﬁle. This
thus completes the proof of Lemma 1.
Based on (6), the optimization problem for maximizing the cache hit probability is
deﬁned as
max
cf
qd
ð7Þ
s:t: cf  0;
ð8Þ
X
F
f ¼1
cf ¼ 1:
ð9Þ
It is worth noting that the second order derivative of the objective function (7) is
strictly negative over the feasible set of cf. As such, qd is a concave function with
respect to cf. By introducing the Lagrangian multipliers cf and m on (8) and (9),
respectively, we obtain the Lagrangian function of (7) as
L ¼ qd 
X
F
f ¼1
cf cf þ vð
X
F
f ¼1
cf  1Þ;
ð10Þ
which leads to the following Karush-Kuhn-Tucker (KKT) optimality conditions [18]
kmpf pR2
d:ekmcf pR2
d  cf þ v ¼ 0; 8f ;
ð11Þ
X
F
f ¼1
cf  1 ¼ 0;
ð12Þ
cf :cf ¼ 0; 8f ;
ð13Þ
434
X. Song et al.

cf  0; 8f ;
ð14Þ
cf  0; 8f :
ð15Þ
Further, with (11), (13) and (15), it can be easily veriﬁed that
v  kmpf pR2
d:ekmcf pR2
d  0; 8f ;
ð16Þ
and
ðv  kmpf pR2
d:ekmcf pR2
dÞ:cf ¼ 0; 8f ;
ð17Þ
respectively.
It is worth noting that for m\kmpf pR2
d; (16) holds only if cf > 0. As such, based on
(17), we have
cf ¼ 
1
kmpR2
d
ln
v
kmpf pR2
d


;
ð18Þ
for m\kmpf pR2
d: On the other hand, for m  kmpf pR2
d; it can be easily veriﬁed from (17)
that
cf ¼ 0:
ð19Þ
By combining the results derived in (18) and (19), we then obtain that
cf ¼

1
kmpR2
d
ln
v
kmpf pR2
d



 þ
;
ð20Þ
where (z)+ = max {0, z}. To characterize the optimal solutions of cf, we substitute (20)
for cf into (12) and obtain that
X
F
f ¼1

1
kmpR2
d
ln
v
kmpf pR2
d



 þ
¼ 1:
ð21Þ
Then, based on (21), by applying a computational procedure, the optimal value of
cf, which is denoted by c
f ; is readily obtained.
Remark 3.1. It can be observed from the analysis that the optimal solution c
f ; depends
on the density of MHs km, the D2D communication range Rd, and the user request
distribution pf.
Probabilistic Caching in Wireless Device to Device Networks
435

4
Transmission Probability
In this section, we characterize the transmission probability of MHs in large-scale
cache-enabled D2D networks under the proposed contention based multimedia delivery
protocol. Particularly, let fd denote the probability that a MH is under request. We ﬁrst
derive fd in the following lemma.
Lemma 2. For large-scale cache-enabled D2D networks, the probability that a MH is
under request is given by
1d
X
F
f ¼1
cf : 1  ekupf pR2
d


:
ð22Þ
Proof. Given pf, cf, and Rd, (22) can be immediately obtained by considering the void
probability that there is no UE request of the ﬁle cached at the tagged MH within a
distance of Rd. This thus completes the proof of Lemma 2.
Let Wr
m be the point process formed by the MHs under request and let kr
m be the
corresponding density. Then, based on Lemma 2, we obtain the following corollary.
Corollary 1. For large-scale cache-enabled D2D networks, the density of Wr
m is given
by
kr
m ¼ km:1d:
ð23Þ
It is worth noting that for MHs within a distance of Rd, the requests of UEs are
spatially correlated. As such, Wr
m does not follow a HPPP. Furthermore, since the
higher order statistics of Wr
m are intractable, the transmission probability of MHs, which
depends on the probability generating functional (PGFL) [19] of Wr
m is difﬁcult to be
characterized exactly. To tackle this difﬁculty, similar to [20–22], we make the fol-
lowing approximation on Wr
m, which will be veriﬁed later by simulations in Sect. 6.
Assumption 1. For large-scale cache-enabled D2D networks, Wr
m follows a HPPP
with density kr
m
With (22) and (23), based on Assumption 1, we are ready to evaluate the trans-
mission probability of MHs under the proposed contention based multimedia delivery
protocol, as given by following theorem.
436
X. Song et al.

Theorem 1. For large-scale cache-enabled D2D networks, under the proposed con-
tention based multimedia delivery protocol, based on Assumption 1, the transmission
probability of MHs is given by
qd ¼ fd  #d;
ð24Þ
where #d denotes the probability that a MH in Wr
m is eventually allowed to launch the
transmission as
#d ¼ 1  e
pkr
mC 1 þ 2
a
ð
Þ
Nd
pd
 2a
pkr
mC 1 þ 2
a


Nd
pd
 2
a :
ð25Þ
Proof. The proof of Theorem 1 is omitted due to space limitation.
Remark 4.1. It can be easily veriﬁed from Theorem 1 that nd < 1 and thereby qd < fd.
Let Wa
m be the point process formed by active MHs under the proposed contention
based multimedia delivery protocol and let ka
m be the corresponding density. Based on
Theorem 1, we obtain the following corollary
Corollary 2. For large-scale cache-enabled D2D networks, under the proposed
contention based multimedia delivery protocol, based on Assumption 1, the density of
Wa
m is given by
ka
m ¼ km:qd:
ð26Þ
ªU(u)
m
ªM(r)
m
¸M(u + d )
m
f
U
M
r
u
¸M(r)
m
df
Fig. 2. Conditional distribution of active MH under the proposed contention based multimedia
delivery protocol.
Probabilistic Caching in Wireless Device to Device Networks
437

In the following section, with Theorem 1, we characterize the successful content
delivery probability of large-scale cache-enabled D2D networks under the proposed
contention based multimedia delivery protocol.
5
Successful Content Delivery Probability
To analyze the successful content delivery probability of the studied large-scale
cache-enabled D2D networks, thanks to the stationarity of the point processes formed
by the MHs and UEs, we focus on a typical UE at the origin denoted by U with its
associated MH at a random distance of df away denoted by M. Let WU
mðuÞ and WM
m ðuÞ
be the point processes formed by the active MHs on a circle of radius u centered at
U and M, respectively, as illustrated in Fig. 2. Further, let kU
mðuÞ and kM
m ðuÞ be the
average density of WU
mðuÞ and WM
MðuÞ; respectively.
In the following, we ﬁrst characterize the distributions of WU
mðuÞ and WM
m ðuÞ;
respectively, and then derive the successful content delivery probability of the
large-scale cache-enabled D2D network.
Lemma 3. Under the proposed contention based multimedia delivery protocol, based
on Assumption 1, conditioned on a typical UE at the origin, WM
m ðuÞ is isotropic2 with
respect to M with density kM
m ðuÞ given by
kM
m ðuÞ ¼ ka
m 1  e
Ndua
Pd


:
ð27Þ
Proof. Conditioned on a typical UE at the origin, under Assumption 1, the probability
that a MH on a circle of radius u centered at M is active is given by qd: Pr
h  Ndua
Pd


;
where h denotes an exponentially distributed random variable with unit mean. Based on
this result, it can be easily veriﬁed that WM
m ðuÞ is isotropic around M with density
kM
m ðuÞ given by (27). This thus completes the proof of Lemma 3.
It is worth noting that due to the contentions among the MHs, even under
Assumption 1, WM
m ðuÞ does not follow a HPPP. As a result, with only the ﬁrst-order
moment measures (average densities) of WM
m ðuÞ being obtained, the successful content
delivery probability of the studied large-scale cache-enabled D2D network is difﬁcult to
be characterized exactly. To tackle this difﬁculty, we make the following approxima-
tion on the conditional distribution of the active MHs, which will be veriﬁed later by
simulations in Sect. 6.
Assumption 2. Under the proposed contention based multimedia delivery protocol,
based on Assumption 2, conditioned on a typical UE at the origin, WM
m ðuÞ follows a
HPPP with density kM
m ðuÞ.
2 A point process N is isotropic if its characteristics are invariant under rotation [24].
438
X. Song et al.

Based on Lemma 3 and Assumption 2, we characterize the distribution of WU
mðuÞ in
the following two lemmas.
Lemma 4. Under the proposed contention based multimedia delivery protocol, con-
ditioned on a typical UE at the origin, an upper bound on kU
mðuÞ is given by
kU
mðuÞ  ka
m: 1  e
Ndðu þ df Þa
pd


:
ð28Þ
Proof. The proof immediately follows from Fig. 2 by observing that the highest
density of WU
mðuÞ is kM
m ðu þ df Þ:
Lemma 5. Under the proposed contention based multimedia delivery protocol, based
on Assumption 2, conditioned on a typical UE at the origin, the following inequality on
kU
mðuÞ holds:
Z 1
0
kU
mðuÞ
1 þ
ua
hdda
f
udu 
Z 1
0
kM
m ðuÞ
1 þ
ua
hdda
f
udu:
ð29Þ
Proof. The proof of Lemma 5 is omitted due to space limitation.
With Lemmas 4 and 5, we are ready to evaluate the successful content delivery
probability of this D2D network, as given by the following theorem.
Theorem 2. For large-scale cache-enabled D2D networks, under the proposed con-
tention based multimedia delivery protocol, based on Assumption 2, the successful
content delivery probability is lower-bounded and upper-bounded, respectively, by
sd 
X
F
f ¼1
pf
Z Rd
0
exp ð1  cf Þ
Z 1
0
gðu þ df Þudu

	
 exp
cf
Z 1
df
gðu þ df Þudu
(
)
:-f ðdf Þddf ;
ð30Þ
sd 
X
F
f ¼1
pf
Z Rd
0
exp ð1  cf Þ
Z 1
0
gðuÞudu

	
 exp
cf
Z 1
df
gðu  df Þudu
(
)
:-f ðdf Þddf ;
ð31Þ
where η(x) is given by
Probabilistic Caching in Wireless Device to Device Networks
439

gðxÞ ¼ 2pka
m 
1  e
Ndxa
Pd


1 þ
ua
hdda
f
;
ð32Þ
and -f ðdf Þ is given by
-f ðdf Þ ¼ 2ka
mcf pdf  eka
mcf pd2
f :
ð33Þ
Proof. The proof of Thereom 2 is omitted due to space limitation.
6
Numerical Results
In this section, we present simulation results on the performance of the cache-enabled
D2D network to validate our analytical results. Throughout this section, unless spec-
iﬁed otherwise, we set up Pd ¼ 10; Pd=Nd ¼ 5; hd ¼ 2; Rd ¼ 25; c ¼ 1; and a ¼ 4:
6.1
Cache Hit Probability
Figure 3 shows the cache hit probability qd versus the number of ﬁles in library F when
km = 0.05 and 0.01, respectively. It is observed in Fig. 3 that cache hit probability is a
decreasing function of F and km. We also compare the proposed optimal probabilistic
caching strategy with the random caching strategy in terms of the cache hit perfor-
mance. It is also observed that the proposed optimal probabilistic caching strategy
outperforms the Zipf-like random caching strategy.
1.0
0.9
0.8
0.7 
0.6 
0.5 
A =0.05 Optimal 
m
A =0.05 Zipf 
m
A =0.01 Optimal 
m
A =0.01 Zipf 
m
10
20
30
40
50
Numbers of Files in Library F
Cache Hit Probability
Fig. 3. Cache hit probability qd versus the number of ﬁles in library F.
440
X. Song et al.

6.2
Transmission Probability
Figure 4 shows the analytical and simulated results on the transmission probability qd
versus the density of UEs ku when km = 0.005, 0.01, and 0.05, respectively, with
F = 20. It is observed that the transmission probability in the cache-enabled D2D
network is an increasing function of ku, while a decreasing function of km, which are
intuitively expected according to Theorem 4.1. It is also observed that the simulation
results ﬁt closely to our analytical results.
6.3
Successful Content Delivery Probability
Figure 5 compares the analytical and simulated results on the successful content
delivery probability sd versus the transmission probability ku, when km = 0.005, and
0.01, respectively. It is observed that the simulated successful content delivery prob-
ability of the cache-enabled D2D network falls between the upper and lower bounds
derived in Theorem 5.1 as expected. It is also observed that the successful content
delivery probability sd is an increasing function of the density of UEs ku.
1.0
0.9
0.8
0.7 
0.6 
0.5 
0.4 
A =0.005 Analytical 
m
A =0.005 Simulation 
m
A =0.01  Analytical 
m
A =0.01  Simulation 
m
A =0.05  Analytical 
m
A =0.05  Simulation 
m
0.010 
0.015 
0.020 
0.025 
0.030 
0.035 
0.040 
0.045 
0.050
Density of UEs A 
u
Fig. 4. Transmission probability qd versus the density of UEs ku.
Probabilistic Caching in Wireless Device to Device Networks
441

7
Conclusion
This paper has studied the performance of large-scale cache-enabled D2D networks
with contention based multimedia delivery protocol. By applying tools from stochastic
geometry, the optimal caching probability is derived and analyzed. It is shown in the
Fig. 5. Successful content delivery probability sd versus the density of UEs ku for F = 5, where
CBMD stands for the contention based multimedia delivery protocol.
442
X. Song et al.

analytical results that the optimal solution of the probabilistic caching placement
depends on the density of MHs, the D2D communication range, and the user request
distribution. With the derived optimal caching probabilities, we further characterize the
transmission probability of MHs and thereby the successful content delivery proba-
bility of the cache-enabled D2D network. Simulations are provided to validate our
analysis. It is hoped that the results in this paper will provide new insights to the
optimal design of large-scale cache-enabled D2D networks.
Acknowledgements. This work was supported in part by Fundamental Research Funds for the
Central Universities under Grant No. N150403001, the National Natural Science Foundation of
China under Grant 61671141, U14331156, 1151002, 61401079, 61501038, and the Major
Research
Plan
of
the
National
Natural
Science
Foundation
of
China
under
Grant
91438117,91538202.
References
1. Cisco: Cisco visual networking index: global mobile data trafﬁc forecast update, 2015–2020,
Whitepaper, June 2016
2. Liu, H., Chen, Z., Tian, X., Wang, X., Tao, M.: On content-centric wireless delivery
networks. IEEE Wirel. Commun. 21(6), 118–125 (2014)
3. Liu, H., Chen, Z., Qian, L.: The three primary colors of mobile systems. arXiv preprint
arXiv:1603.03551 (2016)
4. Zhao, Z., Peng, M., Ding, Z., Wang, W., Poor, H.V.: Cluster content caching: an
energy-efﬁcient approach to improve quality of service in cloud radio access networks.
IEEE J. Sel. Areas Commun. 34(5), 1 (2016)
5. Ji, M., Caire, G., Molisch, A.F.: Wireless device-to-device caching networks: basic
principles and system performance. IEEE J. Sel. Areas Commun. 34(1), 176–189 (2016)
6. Sheng, M., Xu, C., Liu, J., Song, J.: Enhancement for content delivery with proximity
communications in caching enabled wireless networks: architecture and challenges. IEEE
Commun. Mag. 54(8), 70–76 (2016)
7. Bai, B., Wang, L., Han, Z., Chen, W., Svensson, T.: Caching based socially-aware D2D
communications in wireless content delivery networks: a hypergraph framework. IEEE
Wirel. Commun. 23(4), 74–81 (2016)
8. Liu, D., Chen, B., Yang, C., Molisch, A.F.: Caching at the wireless edge: design aspects,
challenges, and future directions. IEEE Commun. Mag. 54(9), 22–28 (2016)
9. Golrezaei, N., Molisch, A.F., Dimakis, A.G., Caire, G.: Femtocaching and device-to-device
collaboration: a new architecture for wireless video distribution. IEEE Commun. Mag. 51(4),
142–149 (2013)
10. Ji, M., Caire, G., Molisch, A.F.: The throughput-outage tradeoff of wireless one-hop caching
networks. In: 2013 IEEE International Symposium on Information Theory Proceedings
(ISIT), pp. 1461–1465. IEEE (2013)
11. Ji, M., Caire, G., Molisch, A.F.: Fundamental limits of caching in wireless D2D networks.
IEEE Trans. Inf. Theory 62(2), 849–869 (2014)
12. Chedia, J., Giovanidis, A.: The effects of mobility on the hit performance of cached D2D
networks. Spatial Stochastic Models for Wireless Networks (2016)
13. Derya, M., Al-Shalash, M., Andrews, J.G.: Optimizing the spatial content caching
distribution for device-to-device communications. In: IEEE International Symposium on
Information Theory (2016)
Probabilistic Caching in Wireless Device to Device Networks
443

14. Derya, M., Al-Shalash, M., Andrews, J.G.: Spatially correlated content caching for
device-to-device communications. arXiv preprint arXiv:1609.00419 (2016)
15. Afshang, M., Dhillon, H.S., Chong, P.H.J.: Fundamentals of cluster-centric content
placement in cache-enabled device-to-device networks. IEEE Trans. Commun. 64(6), 2511–
2526 (2015)
16. Chen, Z., Kountouris, M.: D2D caching vs. small cell caching: where to cache content in a
wireless network? In: IEEE International Workshop on Signal Processing Advances in
Wireless Communications (2016)
17. Chen, Z., Pappas, N., Kountouris, M.: Probabilistic caching in Wireless D2D Networks:
Cache Hit Optimal vs. Throughput Optimal. arXiv preprint arXiv:1611.03016 (2016)
18. Boyd, S., Vandenberghe, L.: Convex Optimization. Cambridge University Press, Cambridge
(2003)
19. Haenggi, M., Ganti, R.K.: Interference in Large Wireless Networks. Foundations and Trends
in Networking. NOW, Hanover (2009)
20. Lee, C., Haenggi, M.: Interference and outage in Poisson cognitive networks. IEEE Trans.
Wirel. Commun. 11(4), 1392–1401 (2012)
21. Song, X., Yin, C., Liu, D., Zhang, R.: Spatial throughput characterization in cognitive radio
networks with threshold-based opportunistic spectrum access. IEEEJ. Sel. Areas Commun.
32(11), 2190–2204 (2014)
22. Nguyen, T., Baccelli, F.: A probabilistic model of carrier sensing based cognitive radio. In:
Proceedings of IEEE Symposium on New Frontiers in Dynamic Spectrum Access Networks,
Singapore, April 2010
23. Kingman, J.F.C.: Poisson Processes. Oxford University Press, New York (1993)
24. Stoyan, D., Kendall, W., Mecke, J.: Stochastic Geometry and Its Applications, 2nd edn.
Wiley, New York (1996)
444
X. Song et al.

Eigenvalue and Capacity Analysis Based
on Measurement of Massive MIMO
System at 3.5 GHZ
Ruijie Xu(B), Jianhua Zhang, and Jie Xi
Key Lab of Universal Wireless Communications, State Key Lab of Networking
and Switching Technology, Ministry of Education,
Beijing University of Posts and Telecommunications,
P.O. Box 92, Beijing 100876, China
{superjerry1992,jhzhang,xijie}@bupt.edu.cn
Abstract. This paper mainly focus on the analysis of the eigenvalues
and capacity for massive multiple-input multiple-output (MIMO) sys-
tems based on the channel measurements conducted at 3.5 GHz with
200 MHz. The measurements are conducted under three typical deploy-
ment scenarios: the Outdoor to Indoor (O2I), the Urban Macro cell
(UMa) and the Urban Micro cell (UMi). Then we investigate the results
of the normalized eigenvalues of the channel correlation matrix and angu-
lar spread (AS) for both azimuth and elevation direction. Under the line
of sight (LoS) condition, the cumulative density function (CDF) of the
normalized eigenvalues under O2I has the most uniform distribution fol-
lowed by UMi, and UMa in the last. The eigenvalues and the orthogo-
nality between sub-channels are aﬀected by the angular spread. The AS
of both azimuth and elevation arrival angle under UMi scenario are the
biggest, and smallest under UMa. Finally, ergodic capacity for all scenar-
ios is investigated and the advantages of the Massive MIMO system are
highlighted. With same signal to noise ratio (SNR), the largest capacity
is achieved under UMi in non-line of sight (NLoS) condition.
1
Introduction
Multiple input multiple output (MIMO) has been used in downlink transmission
as a must-option in long term evolution (LTE) system. However, with the limits
of MIMO channels, to achieve higher data rates is particularly challenging for
systems that are power, bandwidth, and complexity limited [1]. Massive MIMO
has drawn concern since the concept was ﬁrstly introduced by Marzetta [2].
Massive MIMO system takes advantage of multiple transmit and receive anten-
nas, another way signiﬁcantly increase channel capacity. The basic idea behind
massive MIMO is to achieve all the beneﬁts of conventional MIMO on a much
larger antenna number scale. Massive MIMO scales conventional MIMO by an
order or two in magnitude [3], and extra antennas help by focusing energy into
ever smaller regions of space to transmit the signal to desired users and bring
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 445–458, 2018.
https://doi.org/10.1007/978-3-319-72823-0_42

446
R. Xu et al.
huge improvements in throughput and radiated energy eﬃciency by reducing
intra-cell interference. Other advantages include extensive use of inexpensive
low-power components, reduced latency, simpliﬁcation of the MAC layer, and
robustness against intentional jamming [4].
There has been researches about the massive MIMO system with measure-
ments conducted at 2.6 GHz with 50 MHz [5], the eﬀects on the singular value
and capacity of uniform cylindrical array (UCA) and uniform linear array (ULA)
antennas at base station (BS) are presented. Some other measurements are con-
ducted at 5.8 GHz with 100 MHz [6] and the analysis mainly focuses on the eﬀect
of antenna aperture on frequency dependence. So the propagation characteris-
tics, changing along with the frequency of electromagnetic wave and surrounding
environment, play important roles for the performance of the wireless commu-
nication systems [7]. One problem worthy of study is that how the massive
MIMO system performs under diﬀerent scenarios at another frequency. Consid-
ering 3.5 GHz being a test frequency for the 5th generation wireless communica-
tion, we conduct a series of ﬁeld measurements at 3.5 GHz with 200 MHz. And
besides analysing eigenvalues and capacity of the system, we furthermore relate
them to the AS.
The distribution of eigenvalues is the most basic property of the channel
correlation matrix. It directly represents the spatial correlation of the channel,
the number of parallel independent sub-channels that can be used, the multi-
plexing gain and maximum beam forming gain of massive MIMO system. So
another problem worthy of attention is that how the correlation of the sub-
channels changes with the number of antennas at BS or mobile station (MS)
side changes. With the help of the normalized eigenvalues and the direct obser-
vation of the correlation matrix, we will have a more profound understanding.
The mean value of the angular spread (AS) shows the degree of freedom (DOF)
in the propagation and aﬀects the spatial correlation between the sub-channels.
Also the reciprocal of the angular spread is the coherence distance. Finally to
evaluate the performance of Massive MIMO system, the capacity results calcu-
lated from the real measurement data are compared to the capacity results of
simulation for independent identically distributed (i.i.d) channel.
This paper is organized as follows. In Sect. 2, there is the description of both
the measurement and the scenarios. The illustration of the data post processing
in Sect. 3. Then the analysis of the parameters is given in Sect. 4. Finally, the
conclusions are drawn in Sect. 5.
2
Measurement
2.1
Measurement Description
The channel measurements are conducted in Beijing University of Post
and Telecommunications, China, utilizing the Elektrobit Propsound Sounder
described. Three measurements scenarios are the O2I scenario, the UMa sce-
nario and the UMi scenario. The massive MIMO system considered is that of
128 antenna elements at the BS side and 32 antenna elements at the MS side.

Massive MIMO
447
(a) Layout of UPA at
MS
(b) Layout of ODA at
MS
Fig. 1. Layout of antennas
Fig. 2. Illustration of the virtual uniform planar array
At the BS side, the inter element spacing is deﬁned as d and it is ﬁxed on λ/2
(λ refers to the wave length) for both the horizonal and elevational direction. In
the literature [8], it is shown that mutual coupling among antenna elements will
have an impact on the system capacity when d ≤0.2λ (Fig. 2).
The layout of the antenna arrays at BS and MS side is illustrated in Fig. 1.
Two dual-polarized omnidirectional array (ODA) consisting of 16 antenna ele-
ments with 8 adjacent sides and a top surface were used at the MS side. At the
BS side, there is a dual-polarized uniform planar array (UPA) with 32 antenna
elements. In order to meet the requirement, the UPA is moved to four diﬀerent
position to form a virtual uniform planar array with 128 antenna elements. The
rationality of the virtual measurement was proved in [9]. The conﬁguration of the
antenna arrays along with other measurement parameters are shown in Table. 1.
2.2
Scenario Description
For the UMi scenario, a residential quarter inside the campus is chosen, a typical
one. The concrete scenario is illustrated in Fig. 3. The UPA is set on a building
with a height of 14.4 m as shown in Fig. 3(a). The mobile MS is located on
nine positions of the streets around the building, which are shown in Fig. 3(b),
covering both the line of sight (LoS) and non line of sight (NLoS) conditions.
When it comes to the UMa scenario, the UPA is set on the rooftop of the main
teaching building with 71 m height. The positions for MS are chosen around the

448
R. Xu et al.
Table 1. The speciﬁcations of measurement
Parameter
Value
Antenna type
ODA (MS)
UPA (BS)
Number of antenna ports 32
32
Number of elements
8 dual polarized 16 dual polarized
Polarized
±45◦
±45◦
Angle range Azimuth
−180◦∼180◦
−70◦∼70◦
Elevation
−70◦∼90◦
−70◦∼70◦
Center frequency
3.5 GHz
Band width
200 MHz
TX power
UMi
32.1 dBm
O2I
31.1 dBm
UMa
32.8 dBm
PN sequence
127 chips (UMi, O2I), 255 chips (UMa)
(a) BS Position for UMi
(b) MS Position for UMi
Fig. 3. Illustration of UMi scenario
(a) BS Position for UMa
(b) MS Position for UMa
Fig. 4. Illustration of UMa scenario

Massive MIMO
449
(a) BS Position for O2I
(b) MS Position for O2I
Fig. 5. Illustration of O2I scenario
building right in front of the main teaching building to cover both the LoS and
NLoS conditions. Figure 4 is for the illustration. Finally, for the O2I scenario,
the UPA is on the rooftop of the no. 1 teaching building of a height of 13.4m.
The MS are planned to be on the 4th ﬂoor with a height of 14.4 m and 7th ﬂoor
with a height of 26 m in the building shown in Fig. 5(a). The ﬂoor plan display
is shown in Fig. 5(b). Detailed values of the scenarios are shown in Table. 2.
Table 2. The speciﬁcations of scenario
Scenario
UMi UMa O2I 4th ﬂoor O2I 7th ﬂoor
Height of UPA (m)
14.4
71
13.4
13.4
Height of ODA (m) 1.9
1.9
14.4
26.0
Parameter
Horizontal distance (m) BS to MS
Pos1
28
58
28
28
Pos2
27.5
97
28
28
Pos3
51
154
28
28
Pos4
74.5
78
-
-
Pos5
75
101
-
-
Pos6
72.5
149
-
-
Pos7
29
172
-
-
Pos8
48
167
-
-
Pos9
58
-
-
-
3
Data Processing
Measurement data acquired using Elektrobit Propsound sounder [10] enables us
to analyze how the massive MIMO system performs. After getting the chan-
nel impulse response (CIR) from the original data, the frequency response can
be acquired.

450
R. Xu et al.
3.1
Eigenvalue
H(j, k)M,N is deﬁned as a discrete sample of the CIR matrix H(t, f)M,N, which
can be written as
HM,N(j, k) = HM,N(t, f)|t=j·Δt,f=k·Δf
= H(j · Δt, k · Δf)
(1)
where the row number M is the number of the transmitter antenna and the col-
umn number N is the number of the antenna at the receiver side. And Δt and
Δf respectively represent discrete interval in the time domain and frequency
domain. H(j, k)M,N is the form of the CIR matrix after fast fourier transforma-
tion (FFT). To the CIR matrix at moment j and frequency point k, the singular
value decomposition (SVD) of it can be written as
H(j, k) = USV D(j, k)

(j, k)V T
SV D(j, k)
=
r

i=1
ξi(j, k)ui(j, k)vi(j, k)
(2)
1 ≤r ≤min(M, N) refers to the rank of the channel impulse response matrix at
moment j and frequency point k. ξi is the ith biggest singular value of matrix
H(j, k). The distribution of eigenvalues of channel correlation matrix plays a
very important role for the performance analysis of MIMO transmission systems.
When calculating the channel correlation matrix from the BS side, it is deﬁned as
R (j) = E

H(j, k)M,NHT (j, k)M,N

= E {R (j, k)}
(3)
R (j) is the average of all the correlation matrix R (j, k) by dimension k.
R (j) = UΛU T
(4)
So ξi =

λ(i), λ(i) is the ith biggest eigenvalue of the channel correlation
matrix. Then CDF of the normalized eigenvalues can be written by
F(l) =

1≤l≤i
λ(l) \

1≤l≤rank(h(t,f)M,N)
λ(l)
(i = 1, 2, ..., rank(H(j, k)M,N))
(5)
3.2
Angular Spread (AS)
Root mean square angle spread σAS can reﬂect the dispersion of the propagation
path gain in the spatial domain, that is, the two order statistics. The mean angle
spread μ and the circular angle spread (CAS) σAS can be calculated by [11]. The
concept of CAS is adopted to avoid the angle ambiguity problem.
μ(Δ) =
M
m=1 φm(Δ)Pm
M
m=1 Pm
(6)

Massive MIMO
451
σAS =



	
M
m=1 (φm −μ(Δ))2Pm
M
m=1 Pm
(7)
φm(Δ) = φm + Δ
(8)
φm =
⎧
⎨
⎩
2π + φm φm < −π
φm |φm| ≤π
2π −φm φm > π
(9)
where M, Pm, and φm (Δ) denote the number of paths, the power of the mth
path and the angle of the mth path adding a shifted angle which denotes a
certain angular shift. To get the angular spread, the CIR is processed with the
SAGE algorithm [12] to extract the above parameters. Then the angular spread
σAS can be calculated by Eq. 6.
3.3
Capacity
Channel capacity of the jth time index can be caculated by [13]
C (j) = 1
K
K

k=1
log2 det

IN +
ρ
βM HM,N (j; k) HM,N
H (j; k)

(10)
where ρ is the signal-to-noise ratio (SNR) and β is a common normalization
factor to remove the eﬀects of pathloss, deﬁned by
E
 1
β ∥HM,N (j; k)∥2
F

= M · N
(11)
4
Analysis of the Measurement Results
4.1
Eigenvalues
The antenna number of the BS side is denoted as Nbs and Nbs = 128. The
antenna number of the mobile station is denoted as Nms. We study the nor-
malized eigenvalues of one mobile station for two cases: case1-Nms = 4 and
case2-Nms = 16. And we display the result with the LoS condition under the
UMi scenario in Fig. 6. So for the case2, the number of the sub-carrier are deﬁ-
nitely more than that of case1. The main eigenvalues are emphatically focused,
especially the largest eigenvalue. Taking 0.5 CDF value as an example, the largest
eigenvalue of case2 is smaller than that of case1 by 0.1 for sum ratio. The dis-
tribution of main eigenvalues is also more concentrated. From Fig. 6, we can see
that for case1 the ﬁrst two eigenvalues count for over 90% of the whole, while
for case2 seven eigenvalues count the same. The largest eigenvalue referred to
the path with the best transmitting ability and the main eigenvalues referred
to the paths that make a major contribution in the Massive MIMO system per-
formance. As the transmitting power staying unchanged, the main eigenvalues

452
R. Xu et al.
0.5
0.6
0.7
0.8
0.9
1
0
0.2
0.4
0.6
0.8
1
eigenvalue sum ratio
Probability
(a) Case1
0.5
0.6
0.7
0.8
0.9
1
0
0.2
0.4
0.6
0.8
1
eigenvalue sum ratio
Probability
(b) Case2
Fig. 6. The normalized eigenvalues of diﬀerent antenna numbers of one MS
decrease as the power is more evenly allocated to each sub channel and more
paths are contributing. Thus in the picture the level of dispersion grows, how-
ever, the speed of growth gets slower as the number of MS antennas growing
from 8 to 128.
Then the comparison for the orthogonality of the antennas at the MS side
is displayed in Fig. 7. Here, we deﬁne the orthogonality of the mobile stations
as Oant1,ant2:
Oant1,ant2 =
1
ρant1,ant2
(12)
ρant1,ant2 denotes the correlation between the antennas at the MS side,
ant1, ant2 refers to the antenna index. As mentioned in Sect. 2, there are two
ODAs each with 16 antennas as two mobile stations. One ODA has antennas
with the indices from 1 to 16 and connected to the ports with the same indices
on the ODA. Another ODA with antenna indices from 17 to 32 also has the
antennas connected to ports from 1 to 16. For the two ODA, the antenna pair
consisting of antenna 1 and 2 or antenna 17 and 18 facing directly to the UPA,
which means that these antennas correspond to the main sub-channels when
under LoS condition. The two mobile stations are placed at symmetric positions
to the receiver with a interval-dms = 20λ. The examples in Fig. 7(a) and (b) show
the orthogonality between the antennas with indices: 1, 2, 17, 18 with the LoS

Massive MIMO
453
1
2
17
18
1
2
17
18
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(a) UMi Correlation LoS
1
2
17
18
1
2
17
18
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(b) UMi Correlation NLoS
1
2
17
18
1
2
17
18
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(c) UMa Correlation LoS
1
2
17
18
1
2
17
18
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(d) UMa Correlation NLoS
1
2
17
18
1
2
17
18
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1
2
17
18
1
2
17
18
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
(e) O2I Correlation LoS
(f) O2I Correlation NLoS
Fig. 7. Correlation of the users
condition and NLoS condition under the UMi scenario. In Fig. 7(c) and (d) the
corresponding results under the UMa scenario are shown. For the LoS condition
under the UMi scenario, the orthogonality between antenna1 and antenna 17 is
the lowest than that of other antenna combination of antenna1 or antenna17,
with O1,17 = 1.8, while the highest orthogonality woulde be O17,18 > 10. Then
as a comparison, with NLoS condition, Oant1,ant2 > 5 for any two antennas. A
similar phenomenon that can be observed for the UMa scenario. So orthogonality
between antennas increases when changing from LoS condition to NLoS condi-
tion. However, when it comes to the O2I scenario, the results shown in Fig. 7(e)
and (f) become irregular due to the shadow fading which leads to a random scat-
tering environment. So considering the narrow space, the aﬀect of space interval
between the two ODAs counts more when compared to other scenarios.
Then considering case3-Nbs changes and the receive antenna number remains
ﬁxed. Four antenna elements of one mobile station are chosen. For all scenarios,
we picked the measurment location with the LoS condition and results of a
conﬁguration with three kind of BS antenna element numbers are shown in Fig. 8.

454
R. Xu et al.
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
eigenvalue sum ratio
Probability
EV#1 of 8TX
EV#2 of 8TX
EV#3 of 8TX
EV#1 of 32TX
EV#2 of 32TX
EV#3 of 32TX
EV#1 of 128TX
EV#2 of 128TX
EV#3 of 128TX
EV#4 of all
(a) O2I(200M)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
eigenvalue sum ratio
Probability
EV#1 of 8TX
EV#2 of 8TX
EV#3 of 8TX
EV#1 of 32TX
EV#2 of 32TX
EV#3 of 32TX
EV#1 of 128TX
EV#2 of 128TX
EV#3 of 128TX
EV#4 of all
(b) UMa(200M)
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
eigenvalue sum ratio
Probability
EV#1 of 8TX
EV#2 of 8TX
EV#3 of 8TX
EV#1 of 32TX
EV#2 of 32TX
EV#3 of 32TX
EV#1 of 128TX
EV#2 of 128TX
EV#3 of 128TX
EV#4 of  all 
(c) UMi(200M)
Fig. 8. Main eigenvalue for diﬀerent scenarios
In case3, as Nbs grows, similar law appears in the CDF of the normalized
eigenvalues as Nms grows. Besides, we can see the diﬀerence between the CDF
of the normalized eigenvalues under diﬀerent scenarios. The largest eigenvalue
under the UMa scenario is the biggest among the three scenarios and the eigen-
value distribution is also the most dispersed. Then for UMi and O2I scenario,
when Nbs = 32/128, the largest eigenvalues are almost the same meaning that
the power of LoS path for the two scenarios are close. However, the O2I sce-
nario have other three resolvable paths while the UMi scenario have another
strong path, thus the power allocation is more uniform under the O2I scenario.

Massive MIMO
455
But when Nbs = 8, there is mainly one LoS path for both UMi and UMa as only
8 antennas take use of part of the space. With more antennas at the BS side,
the size of the antenna array is larger and makes better use of the space.
Comparing the results of cases with antenna numbers changing whether at
the BS side or the MS side, the main eigenvalue distribution of the less antenna
numbers is relatively dispersed, which indicates that most of the energy of the
channel is mainly distributed in one sub channel. Because the energy of other
sub channels is weak, the data transmission ability is poor and unstable to
interference. In this way, the multiplexing gain of the whole channel is limited
and the spatial correlation of the channel is relatively high. One testiﬁcation has
been drawn from the result that no mater how large the number of antennas
grows, the largest 2–4 eigenvalues occupy more than 60% of the whole.
4.2
Angular Spread (AS)
From the values of the azimuth angle spread of arrival (AASA) shown in Table 3,
azimuth angle spread of departure (AASD), elevation angle spread of arrival
(EASA), elevation angle spread of departure (EASD), we can see that UMa sce-
nario gets the smallest AASA and EASA with LoS condition, while the UMi
scenario gets the largest. To explain this, we go to the illustration picture Fig. 4,
we can see that under the UMa scenario, due to a broad space and geograph-
ical location in the suburbs, there is not much scatterers such as: pedestrians,
vehicles between the UPA and ODA, only some of the sparse distributed tall
buildings. Then compared to the UMa scenario, the UMi scenario gets densely
distributed pedestrians, vehicles and tall buildings around on, as a result, the
mobile stations face a much richer scattering environment. Due to a richer scat-
tering environment, the degree of dispersion of energy increases and brings bigger
AS, so the AS of arrival for both horizon and elevation plane under UMi scenario
are the largest. With bigger AS, there is a bigger DOF [14] meaning lower spatial
correlation for the sub-channels. Then we have more concentrated eigenvalue as
Fig. 8 displays.
Table 3. AS (Nbs = 32) for LoS condition under all scenarios
Scenario
Variable UMi
UMa
O2I
AASA(lg(◦)) μσ
1.7524
0.76616 1.54042
εσ
0.0473
0.1643
0.0412
AASD(lg(◦)) μσ
1.12561 1.37954 1.38654
εσ
0.0818
0.0394
0.0536
EASA(lg(◦)) μσ
1.59731 1.06604 1.33906
εσ
0.0243
0.0616
0.0698
EASD(lg(◦)) μσ
1.46058 1.42876 1.418
εσ
0.0445
0.0161
0.0256

456
R. Xu et al.
As for the O2I scenario, the MSs are placed indoor and on diﬀerent ﬂoors.
Walls, doors, rooms and other objects in the building on the speciﬁc ﬂoor con-
tribute as the scatters. Compared to the UMi scenario, the distribution of the
scatterer for the MS mainly changes on the elevation direction. Thus, with the
LoS condition, there is the LoS path directly from the BS to the antenna of
the MS facing to the UPA dominating the channel. The power of the strongest
sub-channel depends on the propagation distance. And we pcik the measure-
ment data of position2 of the UMi scenario and position1 on the 4th ﬂoor of the
O2I scenario to analysis. Figure 3(b) shows the concrete scene for position2 of
the UMi scenario. The horizontal distances are both 28 m and the propagation
distances are very close. So as Fig. 8 shows, the largest eigenvalue are almost the
same. However, the distribution of the 2th, 3rd, 4th eigenvalue is more uniform
than that of the UMi scenario. As an explanation, we can see that the 1st and
2nd strongest paths can directly arrive at the MS side under the UMi scenario,
so compared to other paths, the power of the 1st, 2nd paths are much stronger.
But under the O2I scenario, the 1st stongest path can pass through the win-
dows, while the 2nd, 3rd, 4th paths pass through walls, rooms and doors and
get weaker.
4.3
Capacity
Capacity for diﬀerent scenarios with a conﬁguration of 128 antennas at the BS
side and 32 antennas at the MS side and for the i.i.d channel is shown in Fig. 9.
From the picture, we can see that under one scenario, capacity for NLoS condi-
tion is bigger than that for LoS condition and better SNR improve more capacity
for NLoS condition than LoS condition. The capacity for i.i.d channel with an
antenna conﬁguration of 128 transmitting antennas and 32 receiving antennas
and another antenna conﬁguration of 8 transmitting antennas and 8 receiving
antennas as a typical conventional MIMO system are displayed. Taking SNR =
15 dB, the capacity under UMi scenario and NLoS condition, C = 100 bps/Hz,
−5
0
5
10
15
20
25
0
50
100
150
200
250
300
SNR [dB]
Capacity (bps/Hz)
i.i.d channel 128x32
UMi 200M NLoS
UMi 200M LoS 
UMa 200M NLoS
UMa 200M LoS 
O2I 200M NLoS
O2I 200M LoS
i.i.d channel 8x8
Fig. 9. Capacity

Massive MIMO
457
approaches that of the 128 × 32 i.i.d channel the most closely. However, the dif-
ference is still impressive as the capacity gap is almost 50 bps/Hz. So increasing
the number of BS or MS antenna elements can still help improve the practical
capacity of the multiuser MIMO system [15]. But over all, the performance of
the massive MIMO system is even better than the ideally achieved capacity of
the conventional MIMO system.
5
Conclusion
Based on the measurement data, we study that how the distribution of eigenval-
ues changes for three cases. Case1: a growing receiving antenna number. From
result, it can be seen that orthogonality between the users increased. So dis-
tinguishing the user will be easier. Case2: the growing number at the BS side.
And we see that more transmitting antennas will bring bigger multiplexing gain
and deteriorative spatial correlation between the sub-channels. Case3: diﬀerent
propagation characteristics. We see that a richer scattering environment can also
reduce the spatial correlation and improve the system performance.
After getting the result of AS, it is explained by analyzing the scenarios. So
the AS can reﬂect the eﬀect of propagation characteristics on spatial correlation.
Finally, we display the real capacity under diﬀerent scenarios and comparison to
the i.i.d channels. According to the result of performance, the massive MIMO
system do have its advantages at the frequency 3.5 GHz, but the gap to ideal
channel performance shows us there is still a lot of work to do to accomplish the
5G goal of providing higher capacity.
Acknowledgment. This research is supported in part by National Science and Tech-
nology Major Project of the Ministry of Science and Technology (2015ZX03002008),
and in part by MOE-CMCC 1-5, and in part by National Natural Science Foundation
of China (61322110, 61461136002), and by 863 Program (2015AA01A703) and Doc-
toral Fund of Ministry of Education (20130005110001). The authors would also like to
thank the support from the Huawei Technologies Co., Ltd.
References
1. Goldsmith, A., Jafar, S.A., Jindal, N., et al.: Capacity limits of MIMO channels.
IEEE J. Sel. Areas Commun. 21(5), 684–702 (2006)
2. Marzetta, T.L.: Noncooperative cellular wireless with unlimited numbers of base
station antennas. IEEE Trans. Wirel. Commun. 9(11), 3590–3600 (2010)
3. Rusek, F., Persson, D., Lau, B.K., et al.: Scaling up MIMO: opportunities and
challenges with very large arrays. IEEE Sign. Process. Mag. 30(1), 40–60 (2012)
4. Larsson, E., Edfors, O., Tufvesson, F., et al.: Massive MIMO for next generation
wireless systems. IEEE Commun. Mag. 52(2), 186–195 (2014)
5. Gao, X., Edfors, O., Rusek, F., et al.: Massive MIMO performance evaluation based
on measured propagation data. IEEE Trans. Wirel. Commun. 14(7), 1–1 (2015)
6. Martinez, A.O., Carvalho, E.D., Nielsen, J.O., et al.: Frequency dependence of
measured massive MIMO channel properties. In: IEEE Vehicular Technology Con-
ference (2016)

458
R. Xu et al.
7. Goldsmith, A.: Wireless Communications. Stanford University, California (2008)
8. Liu, X., Bialkowski, M.E.: Eﬀect of antenna mutual coupling on MIMO channel
estimation and capacity. Int. J. Antennas Propag. 2010(6), 252–260 (2010)
9. Yu, H., Zhang, J.H., Zheng, Q., et al.: The rationality analysis of massive MIMO
virtual measurement at 3.5 GHz. In: IEEE/CIC International Conference on Com-
munications in China (2016)
10. Zhang, J.H.: Review of wideband MIMO channel measurement and modeling for
IMT-advanced systems. Sci. Bullet. 57(19), 2387–2400 (2012)
11. Rappaport, T.S.: Wireless Communications: Principles and Practice, 2nd edn.
Prentice Hall, Upper Saddle River (2001)
12. Fleury, B.H., Tschudin, M., Heddergott, R., et al.: Channel parameter estima-
tion in mobile radio environments using the SAGE algorithm. IEEE J. Sel. Areas
Commun. 17(3), 434–450 (1999)
13. Heath, R.W., Paulraj, A.J.: Switching between diversity and multiplexing in
MIMO systems[J]. IEEE Trans. Commun. 53(6), 962–968 (2005)
14. Gesbert, D., Kountouris, M., Heath, R.W., et al.: Shifting the MIMO paradigm.
IEEE Sign. Process. Mag. 24(5), 36–46 (2007)
15. Zhang, J.H., Pan, C., Pei, F., et al.: Three-dimensional fading channel models: a
survey of elevation angle research. IEEE Commun. Mag. 52(6), 218–226 (2014)

Power Allocation for Downlink
of Non-orthogonal Multiple Access System
via Genetic Algorithm
Xinli Ma1, Juan Wu1, Zhenyu Zhang1, Zhongshan Zhang1,
Xiyuan Wang1, Xiaomeng Chai1, Linglong Dai2,
and Xiaoming Dai1(&)
1 Technology Research Center for Convergence Networks
and Ubiquitous Services, University of Science and Technology Beijing (USTB),
Beijing 100083, China
dxmsjtu@sohu.com
2 Department of Electronic Engineering, Tsinghua University,
Room 709, Tsinghua-Rohm EE Hall, Beijing 100084, China
daill@tsinghua.edu.cn
Abstract. Non-orthogonal multiple access (NOMA) is a promising technology
in future communication systems due to high spectral efﬁciency. In this paper,
we propose an efﬁcient power allocation method based on the genetic algorithm
(GA) to solve the non-linear optimization problem for maximizing the achiev-
able sum rate under a total power constraint and the users’ quality of service
(QoS) in the downlink NOMA systems. Different power allocation coefﬁcients
can be obtained with different objective functions and optimization criteria.
Simulation results demonstrate that the NOMA systems with power allocation
using GA can achieve better performance than the orthogonal multiple access
(OMA) systems in terms of the achievable sum rate.
Keywords: Non-orthogonal multiple access (NOMA)
Quality of service (QoS)  Power allocation  Genetic algorithm
1
Introduction
Along with the development of wireless communication technology, spectral scarcity
has become a serious problem [1]. Spectrum efﬁciency has ignited great interest from
both academia and industry. The traditional mobile communication systems are faced
with drastic changes and enormous challenges, including the explosive growth of
mobile data services and massive machine-type communications. The 5th generation of
communication systems (5G) will support high data rate communications, massive
device connections, ultra-low latency, high reliability, and so on [2]. But the con-
ventional multiple access technique-orthogonal multiple access (OMA) schemes, for
instance, frequency division multiple access (FDMA), time division multiple access
(TDMA), and code division multiple access (CDMA), will hardly meet those
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 459–470, 2018.
https://doi.org/10.1007/978-3-319-72823-0_43

requirements and challenges in 5G. Non-orthogonal multiple access (NOMA) is a
promising multiple access technique for 5G communication systems with utilizing
superposition coding (SC) at the transmitter and successive interference cancellation
(SIC) [3] at the receiver. Compared to the conventional OMA, NOMA can be able to
support multi-users to share the same time-frequency resources [4]. In essence, the
NOMA systems achieve high spectral efﬁciency at the cost of increased receiver
complexity.
Power allocation in OFDMA has been well studied in [5, 6], however, power
allocation in the NOMA systems is still a challenging open problem and important for
optimizing the achievable sum rate under a total power constraint in the NOMA
downlink systems. Many previous works have already focused on power allocation for
the NOMA systems. In [7], a minorization-maximization algorithm (MMA) was
applied to maximize the downlink sum rate and the nonconvex optimization problem
was converted into a convex optimization problem. In [8], Choi proposed an approach
to
optimize
the
sum
capacity
of
multiple-input
multiple
output
NOMA
(MIMO-NOMA) systems with layered transmissions which allocated power to multiple
layers and used the alternating maximization (AM) algorithm that can be regarded as a
two-block Gauss-Seidel method. In [9], the mutual information was chosen as the
optimal objective function to optimize power allocation for the maximum achievable
rate. In [10], Liu demonstrated that the performance of MIMO-NOMA is better than
MIMO-OMA in terms of the sum channel capacity (except for the case in which there
is only one user being communicated to).
The existing works about NOMA power allocation under the users’ QoS con-
straints are mostly analyzed for two users. In [11], a bisection search algorithm was
proposed along with a low complexity suboptimal algorithm to optimize two users’
ergodic capacity of MIMO-NOMA system under the total transmission power con-
straint and the minimum achievable rate constraint of the weak user. In [12], Wang
utilized the Karush–Kuhn–Tucker (KKT) conditions to obtain closed-form solutions
for maximizing the channel capacity in terms of two users’ power allocation under a
total power constraint and the QoS constraints of each user, and moreover extended the
solutions to a MIMO scenario. In [13], Oviedo proposed a Fair-NOMA that means the
two users are capable of achieving higher capacity in the NOMA systems than the
OMA systems. In [14], Choi proposed proportional fairness scheduling (PFS) to obtain
two users’ optimal power allocation with different criteria in the downlink NOMA
systems.
In this paper, we analyze the multi-user NOMA power allocation under a total
power constraint and the users’ QoS constraints, regardless of the user selection cri-
teria, and utilize the effective methods based on the genetic algorithm (GA) to solve the
nonconvex optimal problem. The rest of the paper is organized as follows. The system
model is outlined in Sect. 2. Section 3 formulates an optimization problem of power
allocation in the NOMA systems. Section 4 introduces the genetic algorithm. The
simulation results are presented and discussed in Sect. 5. Finally, the conclusions are
given in Sect. 6.
460
X. Ma et al.

2
System Model
Consider a downlink communication scenario, with a base station B equipped with a
single antenna and N users each equipped with a receive antenna; the base station B
transmits signal data to each user and the total transmitted total power is P; aiði ¼
1; 2. . .NÞ are the fractions of the total power allocated to the i-th user. The 1st user is the
weakest user (the furthest from the base station B), and the N-th user is the strongest user
(the nearest from the base station B). The channel fading coefﬁcients hiði ¼ 1; 2. . .NÞ
satisfy the Gaussian distribution with zero mean and variance r2
hn. The channels are
sorted as 0  h1
j
j2  h2
j
j2. . .  hN
j
j2. The additive white Gaussian noise (AWGN) is
assumed to be normalized with zero mean and variance r2
n. According to the NOMA
principle, the system will allocate more power to the users with weak channel conditions
and less power to the users with strong channel conditions. The users’ power allocation
coefﬁcients are ordered as: a1  a2  . . .  aN. The weak user decodes its signal
information, and perceives the signal information from the strong user as interference
due to its less power. The strong user utilizes the SIC at the receiver and decodes its own
signal information after decoding and removing the reference induced by the weak user.
The multi-user NOMA scheme is shown as Fig. 1. It is shown that the i-th user can
decode and remove the m-th (when m\i) user’s signal information and perceive the
signal information from the k-th (when k [ i) users as interference since they are
negligible
to
the
i-th
user.
In
this
way,
the
achievable
rate
for
the
i-th
i ¼ 1; 2;    ; N  1
ð
Þ user is formulated as follows:
Fig. 1. Multiuser downlink system topology.
Power Allocation
461

Ri ¼ log2
1 þ
aiP hi
j j2
P hi
j j2PN
k¼i þ 1 ak þ r2
n
 
!
ð1Þ
The N-th user can decode and remove all the other users’ signal information. Thus,
the achievable rate of the N-th user is formulated as follows:
RN ¼ log2
1 þ aNP hN
j
j2
r2
n
 
!
ð2Þ
Therefore, the system achievable sum rate is formulated as follows:
Rsum ¼
X
N1
i¼1
log2 1 þ SINRi
ð
Þ þ log2
1 þ aNP hN
j
j2
r2
n
 
!
ð3Þ
where SINRi ¼
aiP hi
j j2
P hi
j j2PN
k¼i þ 1 ak þ r2n
; i ¼ 1; 2;    ; N  1.
3
NOMA Power Allocation Problem Formulation
The different optimization power allocation coefﬁcients can be obtained with different
optimization criteria, and the following describes two different optimization criteria.
One is to maximize the achievable sum rate to get the optimal power allocation; the
other is to maximize the weighted sum rate for obtaining the power allocation coefﬁ-
cients to calculate the capacity.
3.1
Maximize the Achievable Sum Rate
The optimal capacity is obtained by maximizing the achievable sum rate when each
user meets its quality of service (QoS) that refers to the minimum rate requirement. For
instance, the i-th user has to satisfy the inequality SINRi  ci, and the optimization
problem can be formulated as follows:
max
ai
Rsum
s:t: ðiÞ P
N
i¼1
ai ¼ 1
ðiiÞ 0  ai  1
ðiiiÞ a1  a2  . . .  aN
ðivÞ SINRi  ci; i ¼ 1; 2;    N
ð4Þ
where 4; i
ð
Þ represents the sum of all the users’ power is P; 4; ii
ð
Þ represents that the
lower bound and the upper bound of all the users’ power allocation coefﬁcients; 4; iii
ð
Þ
represents the NOMA principle that power allocated to the weaker user must be more
than that of the stronger user; and 4; iv
ð
Þ expresses the constraints that the SINR of each
user must meet the targeted SINR ci to guarantee the QoS.
462
X. Ma et al.

Subsequently, the constraint 4; iv
ð
Þ is analyzed and can be described in detail as (5).
aiP hi
j j2
P hi
j j2PN
k¼i þ 1 ak þ r2n
 ci; i ¼ 2; 3; . . .; N  1
ð
Þ
aNP hN
j
j2
r2n
 cN
8
>
<
>
:
ð5Þ
The bound of the power allocation coefﬁcients a can be obtained and formulated as
follows:
1  ai 
ci
hi
j j2h þ 1
q
ð
Þ
1 þ ci
ð
Þ hi
j j2 ; i ¼ 1; 2; . . .; N  1
ð
Þ
1  aN 
cN
q hN
j
j2
8
>
<
>
:
ð6Þ
where q is the transmission SNR, q ¼ P
r2n, set a0 ¼ 0, and get h ¼ 1  P
i1
k¼0
ak;
0  h  1
ð
Þ. The inequalities in (6) show the constraints between the users’ power
allocation coefﬁcients induced by the users’ QoS constraints. The lower bound of
ai i ¼ 1; 2; . . .; N
ð
Þ are denoted as bi i ¼ 1; 2; . . .; N
ð
Þ. If bi  1; i ¼ 1; 2; . . .; N
ð
Þ, it
means that the i-th user can’t be supported to meet the QoS, even if the BS allocates the
total power to the user.
We utilize 4 users to analyze the problem in detail as follows:
max P
3
i¼1
log2 1 þ SINRi
ð
Þ þ log2 1 þ a4P h4
j
j2
r2n


s:t: ðiÞ a1 þ a2 þ a3 þ a4 ¼ 1
ðiiÞ 0  a1  1; 0  a2  1; 0  a3  1; 0  a4  1
ðiiiÞ  a1 þ a2  0; a2 þ a3  0; a3 þ a4  0
ðivÞ  a1   g1;
k2a1  a2   g2;
k3a1  k3a2  a3   g3;
a4  
c4
q h4
j
j2
ð7Þ
where ki ¼
ci
1 þ ci, gi ¼
ci
hi
j j2 þ 1
q
ð
Þ
1 þ ci
ð
Þ hi
j j2, and the constraints in (7) correspond to that in (4)
respectively.
3.2
Maximize the Weighted Sum Rate
We consider the weighted sum rate as the optimization objective function to allocate
power for multi-users and the objective function is shown as (8):
max
ai
Rweighted
sum ¼
X
N
i¼1
RiNOMA
RiOMA
ð8Þ
Power Allocation
463

where RiNOMA equals to Ri shown as Eqs. (1) and (2), RiOMA ¼ log2 1 þ P hi
j j2=r2
n


represents the users’ OMA capacity. The constraints of the problem (8) are the same
as (4). The optimal power allocation coefﬁcients are obtained by optimizing the
problem (8) and substituted into (3) to obtain the optimal achievable sum rate.
In general, there is no analytical solutions for the multivariable optimization
problem, and the GA function in MTLAB can be used to obtain optimal power allo-
cation coefﬁcients, but the computational process of the genetic algorithm is complex
and time-consuming.
4
Genetic Algorithm
Genetic algorithm is an optimization method inspired by the process of natural
selection that belongs to the evolutionary algorithms [15]. Traditionally, a population is
represented in binary as strings of 0s and 1s. In the genetic algorithm, a population of
candidate solutions to an optimization problem evolves towards to better solutions. The
solutions selected based on their ﬁtness will be mutated and altered, and offspring will
be used to form a new population. The new population will be better than the old one.
The process will be repeated until there’s a solution satisﬁed.
The genetic algorithm process is as follows [16] and the ﬂowchart of the algorithm
is shown as Fig. 2.
Step 1: Represent the problem domain as a chromosome of ﬁxed length and
determine the number of chromosomes, generations, and mutation rate and cross-
over rate value;
Step 2: Choose the initial population;
Step 3: Evaluate the ﬁtness of each individual chromosome by calculating the
objective function;
Step 4: Select a pair of chromosomes from the current population for mating, based
on their ﬁtness scores (the better ﬁtness, the bigger chance to be selected);
Step 5: Crossover from those parents to create a pair of offspring chromosomes;
Step 6: Mutation (maintain genetic diversity from one generation of a population to
the next);
Step 7: Return to Step3 and repeat the process until the termination (or optimiza-
tion) criterion is met;
Step 8: Get the solution.
The general iterative algorithm can easily fall into the local minimum, But GA is a
good way to overcome the drawback due to its good global search capabilities that can
ﬁnd the best possible solution with a high probability. Compared with the traditional
optimization methods (enumeration, heuristic, etc.), GA has a good convergence and
high explorative ability. In addition, GA is widely used to solve function optimization
problems, combinatorial optimization problems, production scheduling problems,
adaptive control, robotics, image processing, genetic programming, data mining,
robotic learning, and artiﬁcial life. Although the genetic algorithm is applied in various
ﬁelds, it has its own shortcomings, for example, the local search ability and
464
X. Ma et al.

convergence is poor, and it takes a long time to ﬁnd the optimal solution. The primary
problem is to improve the search ability and the convergence speed of the algorithm.
5
Numerical Results
In this section, the performance of the downlink NOMA systems with power allocation
using genetic algorithm is compared to that achieved by the OMA systems. For a given
downlink NOMA scheme with a base station and N users, the channel gains are
generated as hi ¼
ﬃﬃﬃﬃﬃﬃﬃﬃ
dl
i
p
gi, where gi  CN 0; 1
ð
Þ (i.e. r2
hn ¼ dl), l is the pass-loss
exponent l ¼ 2, and the distances between the base station and the users are ﬁxed and
uniformly distributed between 1 and D. The noise power for each user is normalized to
r2
n ¼ 1. The i-th user’s OMA capacity is given as: Comai ¼ 1=N
ð
Þlog2 1 þ
ð
P hi
j j2


=r2
nÞ; ði ¼ 1; 2; . . .; NÞ.
Figures 3 and 4 show the capacity of a user and the sum capacity versus P (dB) for
the NOMA schemes with power allocation using genetic algorithm and for the OMA
schemes.
Figure 3 compares three users’ achievable rate and the maximum sum rate of the
NOMA scheme acquired by maximizing the sum rate to that of the OMA scheme.
Simulation parameters for performance evaluation are given as follows. We will take
D = 11 and the distance vector between the three users and the base station is d0 ¼
11; 6; 1
½
 meters. The vector of the users’ QoS is c0 ¼ ½20; 15; 5 dB. The channels
crossover
mutation
Whether meet the 
termination criterion
Best 
solution
Selection
Roulette Wheel 
Fig. 2. The ﬂowchart of genetic algorithm.
Power Allocation
465

need to satisfy the order of h1
j
j2  h2
j
j2  h3
j
j2 to ensure that the users’ signal infor-
mation can be decoded. The sum capacity and the third user’s capacity of the NOMA
system is higher than the capacity of the OMA system. The NOMA capacity of the ﬁrst
user and the second user is lower than the OMA capacity.
Figure 4 depicts the four users’ capacity and the sum capacity for the NOMA and
OMA systems, and the NOMA power allocation is optimized by maximizing the sum
rate. Simulation parameters are set as follows. The distance vector is d00 ¼ 11; 7:67;
½
4:33; 1 meters and the users’ QoS vector is c00 ¼ ½30; 25; 20; 10 dB. The
channels need to satisfy the order of h1
j
j2  h2
j
j2  h3
j
j2  h4
j
j2. The sum capacity and
the fourth user’s capacity of the NOMA system are higher than the capacity of the
OMA system while the others are lower than the capacity of the OMA system
respectively.
Figures 5 and 6 depict the achievable rate of 3 users and 4 users with power
allocation obtained by maximizing the weighted sum rate under the same simulation
parameters as Figs. 3 and 4, respectively. In both Figs. 5 and 6, the sum capacity of the
NOMA system is higher than the capacity of the OMA system. In Fig. 5, the NOMA
capacity of the ﬁrst user and the third user is higher than the OMA capacity while the
second user’s capacity of the NOMA system is lower than the capacity of the OMA
system. In the Fig. 6, the NOMA capacity of the ﬁrst user and the fourth user is higher
than the OMA capacity while the NOMA capacity of the second user and the third user
is lower than the OMA capacity.
Figure 7 compares the NOMA sum capacity optimized by maximizing sum rate
and weighted sum rate for three users and four users. The sum capacity obtained by
maximizing the weighted sum rate is lower than that obtained by maximizing the sum
rate for both three users and four users.
For the maximizing sum rate scenario, only the strongest user’s capacity and the
sum capacity of the NOMA system are higher than the capacity of the OMA system,
5
10
15
20
25
30
0
1
2
3
4
5
6
7
8
9
10
P(dB),N=3
Capacity(bps/Hz)
Csum-noma
Csum-oma
user 3-noma
user 3-oma
user 2-noma
user 2-oma
user 1-noma
user 1-oma
Fig. 3. Three users’ capacity analysis of NOMA and OMA by maximizing the sum rate.
466
X. Ma et al.

respectively, while the other users’ capacity of the NOMA system is lower than that of
the OMA system, grows slowly and only satisfy the required SNR. For the maximizing
weighted sum rate scenario, except for the strongest user, the weakest user’s NOMA
capacity is also higher than the OMA capacity at the cost of the reduction of the sum
capacity shown as Fig. 7. Different optimal criteria will lead to different results, but the
NOMA systems is better than the OMA systems in terms of the sum capacity whatever
criteria is chosen.
5
10
15
20
25
30
0
1
2
3
4
5
6
7
8
9
P(dB),N=4
Capacity(bps/Hz)
Csum-noma
Csum-oma
user 4-noma
user 4-oma
user 3-noma
user 3-oma
user 2-noma
user 2-oma
user 1-noma
user 1-oma
Fig. 4. Four users’ capacity analysis of NOMA and OMA by maximizing the sum rate.
5
10
15
20
25
30
0
1
2
3
4
5
6
7
8
P(dB),N=3-weighted
Capacity(bps/Hz)
Csum-noma
Csum-oma
user 3-noma
user 3-oma
user 2-noma
user 2-oma
user 1-noma
user 1-oma
Fig. 5. Three users’ capacity analysis of NOMA and OMA by maximizing the weighted sum rate.
Power Allocation
467

6
Conclusion
In this paper, we studied the capacity maximization problem under a total power
constraint and users’ QoS constraints for power allocation by utilizing GA in NOMA
downlink systems. We derived the optimal power allocation and obtained the optimal
capacity by maximizing the sum rate and the weighted sum rate. The simulation results
show that the performance of the NOMA system based on GA can achieve higher gain
5
10
15
20
25
30
0
1
2
3
4
5
6
7
8
P(dB),N=4-weighted
Capacity(bps/Hz)
Csum-noma
Csum-oma
user 4-noma
user 4-oma
user 3-noma
user 3-oma
user 2-noma
user 2-oma
user 1-noma
user 1-oma
Fig. 6. Four users’ capacity analysis of NOMA and OMA by maximizing the weighted sum rate.
5
8
11
14
17
20
23
26
29
0
1
2
3
4
5
6
7
8
9
10
P(dB)
Capacity(bps/Hz)
Csum-noma-4
Csum-noma-4-weighted
Csum-noma-3
Csum-noma-3-weighted
Fig. 7. The comparison of NOMA capacity optimized by maximizing the sum rate and
weighted sum rate.
468
X. Ma et al.

than the traditional OMA schemes when the channel state information is available to
the transmitters and different optimization criteria will induce different results. The
values of the users’ QoS is ﬁxed in this paper and the dynamic QoS will be considered
in the future work. On the other hand, the solution obtained by a simple genetic
algorithm is time-consuming and the genetic algorithm is prone to premature con-
vergence in practical application. Therefore, the combination of genetic algorithm and
other algorithms will be studied in the future work.
Acknowledgements. This work was supported by Huawei Innovation Research Program, the
key project of the National Natural Science Foundation of China (No. 61431001), the 5G
research program of China Mobile Research Institute (Grant No. [2015] 0615), the open research
fund
of
National
Mobile
Communications
Research
Laboratory
Southeast
University
(No. 2017D02), Key Laboratory of Cognitive Radio and Information Processing, Ministry of
Education (Guilin University of Electronic Technology), the Foundation of Beijing Engineering
and Technology Center for Convergence Networks and Ubiquitous Services, and Keysight. The
Corresponding author is Dr. Xiaoming Dai.
References
1. Dai, L., Wang, B., Yuan, Y., et al.: Non-orthogonal multiple access for 5G: solutions,
challenges, opportunities, and future research trends. IEEE Commun. Mag. 53(9), 74–81
(2015)
2. Vision IMT: Framework and overall objectives of the future development of IMT for 2020
and beyond. Working document toward preliminary draft new recommendation ITU-R M
[IMT. Vision] (2014)
3. Dai, X., Chen, S., Sun, S., Kang, S., Wang, Y., Shen, Z., Xu, J.: Successive interference
cancelation amenable multiple access (SAMA) for future wireless communications. In:
Proceedings of IEEE ICCS 2014, pp. 1–5, November 2014
4. Benjebbour, A., Saito, Y., Kishiyama, Y., et al.: Concept and practical considerations of
non-orthogonal multiple access (NOMA) for future radio access. In: 2013 International
Symposium on Intelligent Signal Processing and Communications Systems (ISPACS),
pp. 770–774. IEEE (2013)
5. Zhang, H., Nie, Y., Cheng, J., Leung, V.C.M., Nallanathan, A.: Sensing time optimization
and power control for energy efﬁcient cognitive small cell with imperfect hybrid spectrum
sensing. IEEE Trans. Wirel. Commun. 16(2), 730–743 (2017)
6. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allocation in
spectrum -sharing OFDMA femtocells with heterogeneous services. IEEE Trans. Commun.
62(7), 2366–2377 (2014)
7. Hanif, M.F., Ding, Z., Ratnarajah, T., et al.: A minorization-maximization method for
optimizing sum rate in the downlink of non-orthogonal multiple access systems. IEEE Trans.
Sig. Process. 64(1), 76–88 (2016)
8. Choi, J.: On the power allocation for MIMO-NOMA systems with layered transmissions.
IEEE Trans. Wirel. Commun. 15(5), 3226–3237 (2016)
9. Choi, J.: On the power allocation for a practical multiuser superposition scheme in NOMA
systems. IEEE Commun. Lett. 20(3), 438–441 (2016)
10. Liu, Y., Pan, G., Zhang, H., et al.: On the capacity comparison between MIMO-NOMA and
MIMO-OMA. IEEE Access 4, 2123–2129 (2016)
Power Allocation
469

11. Sun, Q., Han, S., Chin-Lin, I., et al.: On the ergodic capacity of MIMO NOMA systems.
IEEE Wirel. Commun, Lett. 4(4), 405–408 (2015)
12. Wang, C.L., Chen, J.Y., Chen, Y.J.: Power allocation for a downlink non-orthogonal
multiple access system. IEEE Wirel. Commun. Lett. 5(5), 532–535 (2016)
13. Oviedo, J.A., Sadjadpour, H.R.: A new NOMA approach for fair power allocation. In: 2016
IEEE Conference on IEEE Computer Communications Workshops (INFOCOM WKSHPS),
pp. 843–847 (2016)
14. Choi, J.: Power allocation for max-sum rate and max-min rate proportional fairness in
NOMA. IEEE Commun. Lett. 20(10), 2055 (2016)
15. Sivanandam, S.N., Deepa, S.N.: Introduction to Genetic Algorithms. Springer, Heidelberg
(2007). https://doi.org/10.1007/978-3-540-73190-0
16. Gen, M., Cheng, R.: Genetic Algorithms and Engineering Design. Wiley, New York (1997)
470
X. Ma et al.

Research on the Interference and Coexistence
of CBTC in 1.8 GHz Band
Ruichen Xu(&), Xiao Peng, Xiaobo Wang, Ji Fang, and Bo Yuan
The State Radio Monitoring Center Testing Center, Beijing 100041, China
{xuruichen,pengxiao,wangxiaobo,fangji,
yuanbo}@srtc.org.cn
Abstract. The current Communication Based Train Control (CBTC) system is
assigned to 2.4 GHz unlicensed band, which can be easily interfered. To
enhance safety, the state radio regulatory commission assigned 1785 MHz–
1805 MHz band to CBTC system. However, under the interference of ﬁrst use
telecommunication system in identical and adjacent frequency, it’s a problem to
guarantee the safety isolation distance between interfere and interfered party, so
that to improve CBTC system safety. To solve this problem, this paper ﬁrstly
analyzes relative domestic frequency assignment situation to determine interfere
party, and then ﬁnds out study scenario based on ﬁeld testing data. Afterward,
obtain isolation distance between interfere and interfered party by ACIR mod-
eling and deterministic calculations. Based on the research above, the advice
that CBTC system should be assigned in 1790 MHz–1800 MHz band is given.
Keywords: 1.8 GHz  TDD-LTE  CBTC  Interference  Isolation distance
1
Introduction
Communication Based Train Control (CBTC) [1] system realizes bi-directional train
ground communication, which makes the train break through from ﬁxed blocked system
to moving blocked system. And the ability of carrying capacity of a section is increasing
by adding in-train entertainment information service, which has widely application
prospect. However, China assigned CBTC system in 2.4 GHz unlicensed frequency
band, which can be easily interfered by hand-held WiFi hot spot devices. As a result,
several subway emergency brake accidents were caused in Shenzhen and Beijing.
Security risks are brought out. To solve above issue, MIIT [2015] No. 65 document is
published by China radio regulatory, which indicated that 1785 MHz–1805 MHz pri-
vate band is assigned to TDD-LTE CBTC system, to enhance security of train transit.
Besides that, CBTC system may apply 5G communication technology [3, 4] in
forseeable future, which has higher spectrum efﬁciency.
However, under the interference of 3 kinds of ﬁrst use telecommunication systems
[5–7] in identical and adjacent frequency, it’s a problem that guarantee the safety
isolation distance between interfere and interfered party, so that to improve CBTC
system safety. Reference [8–10] study on the overall framework, system function and
interface speciﬁcation of TD-LTE based CBTC system, respectively.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 471–483, 2018.
https://doi.org/10.1007/978-3-319-72823-0_44

Base on reference review of this paper, there is only 1 reference [11] focused on
interference and coexistence of radio access system in 1785 MHz–1805 MHz fre-
quency band, which includes CBTC system. Reference [11] applies deterministic cal-
culations to study on interference and coexistence problem of 1785 MHz–1805 MHz
radio access system base station and adjacent band IMT system base station. The
security isolation between interfered and interfere base station is given, but radio access
system downlink system interference is not take into consider.
Therefore, based on analysis on frequency distribution situation on 1785 MHz–
1805 MHz, according to test and deterministic calculation methodology, this paper obtains
the safety isolation distance between CBTC system and the other 4 interfere parties.
2
Frequency Assignment Situation in 1785 MHz–1805 MHz
2.1
Adjacent Frequency Assignment Situation in 1785 MHz–1805 MHz
According to reference [11] and [12], IMT spectrum assignment around 1.8 GHz in
China is shown in Fig. 1. From Fig. 1 and reference [12], 1785 MHz–1805 MHz
adjacent frequency is used for LTE FDD uplink in 1765 MHz–1785 MHz and GSM
downlink in 1805 MHz–1820 MHz. GSM and FDDLTE network has wide coverage,
especially in the city where CBTC has greater density. Therefore, it’s necessary to
study the interference of GSM downlink and FDDLTE uplink to CBTC terminal.
2.2
Frequency Assignment Situation in 1785 MHz–1805 MHz
According to reference [2], 1785 MHz–1805 MHz is assigned to city rail transportation,
electric, fuel and telecommunication industries. Currently, McWill broadband wireless
access system has been deployed in this band. According to the data of The State Radio
Monitoring Center,McWill system, which works in 1785 MHz–1805 MHz, is widely
used in urban wireless access, heavy haul rail, petroleum ﬁelds, harbours, airports and
other ﬁelds. The deployed McWill system has covered the entire 20 MHz band of
1785 MHz–1805 MHz. Single base station bandwidth range is [1 MHz–5 MHz],
transmit power range is [1 W, 3 W], which is deployed over the ground. As the city
wireless access systems, airports and other areas may overlap with the CBTC system
operating area, it is necessary to study the interference of the McWill system to the
CBTC train terminal.
TDD
Radio Access 
System
FDDLTE UpLink
China 
Communicaon
FDDLTE UpLink
China Telecom
GSM UPlink
China 
Communicaon
GSM DownLink
China Mobile
1755MHz
1765MHz
1785MHz
1805MHz
1830MHz
1850MHz
Fig. 1. Domestic frequency allocation situation in 1.8 GHz
472
R. Xu et al.

3
Interference Scenarios
This section analyzes interference scenario requirement from systematic perspective.
Afterwards, study scenario is determined from ﬁeld test data.
As shown in Fig. 2, the interference source of interfered CBTC train is LTE FDD
uplink, GSM downlink and McWill uplink and downlink. Therefore, interference from
GSM base station, McWill base station, McWill terminal and LTE FDD terminal to
CBTC train should be taken into consideration.
After determination of interference source, study scenario need to be found out.
CBTC system can be divided to underground subway and over ground rail. The
propagation environment is quite different. So test method is applied to determine
CBTC train interference scenario.
To analyze scenario, by using test method in Beijing subway line 2, line 5 and line 13
underground and over ground respectively, the power level of 1710 MHz–1785 MHz,
1785 MHz–1805 MHz and 1805 MHz–1880 MHz can be obtained. The test settings
can be found in Table 1, and test instrument and attachment list is shown in Table 2.
FDDLTE
BS
FDDLTE
UE
McWiLL
BS
McWiLL
UE
CBTC
BS
CBTC
Train
GSM
BS
GSM
UE
Fig. 2. Analysis on interference source to CBTC train
Table 1. Test setting
Setting
Value
Test frequency
1710 MHz–1785 MHz;
1785 MHz–1805 MHz;
1805 MHz–1880 MHz
Scan method
Clear Write
Internal attenuation 0 dB
Reference level
−10 dBm
VBW
1 MHz
RBW
1 MHz
Scan type
Auto
Pre-release state
OFF
Detection mode
Max Hold
Interference and Coexistence of CBTC in 1.8 GHz Band
473

As shown in Fig. 3, test section of line 2 is underground, test section of line 13 is
over ground, and test section of line 5 is combination of underground and over ground.
The test screen print for Beijing subway line 2, line 5 and line 13 can be found in
Fig. 4. The test result of line 2 is shown in Table 3, line 13 in Table 4, and line 5 in
Table 5.
As indicated in Table 3, when the train is underground, the power spectrum density
stays stable and nearly identical. Since there is no McWill base station underground,
−75 dBm/MHz– −74 dBm/MHz is almost underground electromagnetic environment
background noise. This power spectrum density (PSD) matches the test result of line 5
underground part.
From Tables 4 and 5, we know when the train is over ground, the PSD of 3 test
frequency band changes signiﬁcant. 1710 MHz–1785 MHz over ground PSD is 35 dB
higher than underground. And the result changes on various test interval, which is
affect by uplink assignment and different population densities, like PSD in Xizhimen
section is larger than other sections. The average value of 1785 MHz–1805 MHz
over-ground is about −50 dBm/MHz, which changes on different test interval. For
example, the PSD value of line 13 is larger than the one of line 5, which is related to
McWill base station assignment density. According to in use radio station data from
The State Radio Monitoring Center, Mcwill base station density along line 13 is higher
than line 5, which matches test data. The average PSD of 1805 MHz–1880 MHz
Table 2. Test instruments and accessories
Device name
Version
Manufacturer
Spectrum analyzer
N9344C
Agilent
Lazer range ﬁnder
LRB5000 FeiXunDianZi
LapTop
X230
ThinkPad
Log periodic antenna LM1250
FeiChuang
Fig. 3. Test section of CBTC
474
R. Xu et al.

Beijing Line 2, Test secon from ChongWen 
to Qian Men,  Recepon Lever in 1710MHz-
1785MHz
Beijing Line 2, Test secon from ChongWen 
to Qian Men,  Recepon Lever in 1785MHz-
1805MHz
Beijing Line 2, Test secon from ChongWen 
to Qian Men,  Recepon Lever in 1805MHz-
1880MHz
Beijing Line 13, Test secon from Xizhimen to 
Dazhongsi,  Recepon Lever in 1710MHz-
1785MHz
Beijing Line 13, Test secon from Xizhimen to 
Dazhongsi,  Recepon Lever in 1785MHz-
1805MHz
Beijing Line 13, Test secon from Xizhimen to 
Dazhongsi,  Recepon Lever in 1805MHz-
1880MHz
Beijing Line 5, Test secon from Lishuiqiao to 
Lishuiqiaonan,  Recepon Lever in 1710MHz-
1785MHz
Beijing Line 5, Test secon from Lishuiqiao to 
Lishuiqiaonan,  Recepon Lever in 1785MHz-
1805MHz
Beijing Line 5, Test secon from Lishuiqiao to 
Lishuiqiaonan,  Recepon Lever in 1805MHz-
1880MHz
Fig. 4. The test screen print for Beijing subway line 2, line 5 and line 13
Table 3. Reception level testing result of Beijing line 2
Testing frequency
band
1710 MHz–1785 MHz
(dBm/MHz)
1785 MHz–1805 MHz
(dBm/MHz)
1805 MHz–1880 MHz
(dBm/MHz)
Section 1
Under ground
−75.92
−75.45
−76.36
Section 2
Under ground
−75.47
−74.98
−75.51
Section 3
Under ground
−75.62
−75.70
−74.72
Section 4
Under ground
−75.76
−75.18
−71.71
Section 5
Under ground
−76.36
−75.55
−74.82
Section 6
Under ground
−75.23
−75.76
−75.00
Section 7
Under ground
−76.24
−75.31
−75.88
Section 8
Under ground
−75.79
−79.68
−75.69
Average
−75.81
−75.95
−74.96
Interference and Coexistence of CBTC in 1.8 GHz Band
475

Table 4. Reception level testing result of Beijing line 13
Testing
frequency band
1710 MHz–1785 MHz
(dBm/MHz)
1785 MHz–1805 MHz
(dBm/MHz)
1805 MHz–1880 MHz
(dBm/MHz)
Section 1
Over ground
−27.70
−44.61
−36.71
Section 2
Over ground
−41.67
−56.22
−36.17
Section 3
Over ground
−35.74
−44.39
−33.96
Section 4
Over ground
−41.22
−43.76
−35.80
Section 5
Over ground
−49.36
−52.73
−34.21
Section 6
Over ground
−44.19
−56.33
−36.87
Section 7
Over ground
−49.36
−41.18
−38.40
Section 8
Over ground
−41.30
−61.17
−37.18
Average
−41.30
−50.04
−36.18
Table 5. Reception level testing result of Beijing line 5
Testing
frequency band
1710 MHz–1785 MHz
(dBm/MHz)
1785 MHz–1805 MHz
(dBm/MHz)
1805 MHz–1880 MHz
(dBm/MHz)
Section 1
Over ground
−51.16
−66.18
−36.22
Section 2
Over ground
−52.51
−61.40
−36.87
Section 3
Over ground
−53.91
−65.07
−39.08
Section 4
Over ground
−48.71
−64.41
−34.21
Section 5
Under ground
−75.45
−76.26
−76.19
Section 6
Under ground
−76.87
−76.11
−76.86
Section 7
Under ground
−75.98
−76.58
−76.79
Section 8
Under ground
−77.17
−75.54
−75.83
Average
−63.97
−70.19
−56.51
476
R. Xu et al.

over-ground is about −36 dBm/MHz, and changes little in different sections, which is
GSM downlink and related to stable density of GSM BS assignment. Moreover, the
PSD of 1785 MHz–1805 MHz is smaller than other 2 bands, since Mcwill base station
transmitting power is 6 dB smaller than GSM, and the number of public network UE is
huge, etc.
According to above analysis, the CBTC downlink interfered scenario is chosen to
be over-ground scenario. The upcoming scenario setting, parameter setting and prop-
agation model should be set up as over-ground scenario.
4
Safety Isolation and Safety Isolation Distance
This section ﬁrstly introduces interfere and interfered RF parameters. Then ACIR of
different situation can be obtained by calculation of interfere side’s ACLR and inter-
fered side’s ACS. The secured isolation distance between CBTC train side and interfere
side can be got from backward deduction of propagation model.
4.1
RF Parameters of Interfered and Interfere Sides
The system parameters [11, 12] of 4 kinds of interfere side can be found as Table 6.
The RF parameters of CBTC system [10] can be found as Table 7.
Table 6. System parameters of 4 kinds of interfere side
System
parameters
GSM
BS
LTE FDD
UE
McWill
BS
McWill
UE
Frequency band
1805 MHz–
1820 MHz
1765 MHz–
1785 MHz
1785 MHz–
1805 MHz
1785 MHz–
1805 MHz
Carrier bandwidth
200 kHz
5 MHz
5 MHz
5 MHz
Maximum transmit power
46 dBm
23 dBm
40 dBm
30 dBm
Thermal noise power spectral
density
−174
dBm/Hz
−174
dBm/Hz
−174
dBm/Hz
−174
dBm/Hz
Noise ﬁgure
5 dB
9 dB
5 dB
9 dB
Cell radius
250 m
–
250 m
Maximum antenna gain
(including feeder loss)
15 dB
0 dB
15 dB
0 dB
Antenna height
30 m
1.5 m
30 m
1.5 m
Interference and Coexistence of CBTC in 1.8 GHz Band
477

4.2
ACIR Analysis and Calculation
It’s identical frequency interference that McWill system interferes CBTC system.
And LTE FDD and GSM to CBTC system is adjacent frequency interference. 4 kinds
of interference scenarios are taken into account in this paper: (1) The bandwidth of
CBTC system is 5 MHz, which has 5 MHz frequency isolation with adjacent interfere
system; (2) The bandwidth of CBTC system is 10 MHz, which has 5 MHz frequency
isolation with adjacent interfere system; (3) The bandwidth of CBTC system is 5 MHz,
which adjoin adjacent interfere system; (4) The bandwidth of CBTC system is
10 MHz, which adjoin adjacent interfere system. Since the modulation feature of
GSMK, there is 200 kHz isolate bandwidth between adjoin GSM and CBTC system.
To begin with, ACIR calculation model is introduced. Then, ACIR value of different
interference situation is determined depending on the calculation of ACLR and ACS.
ACIR can be obtained by Eq. (1), where dB is applied as unit, and ACS is Adjacent
Channel Selectivity, unit is dB.
ACIR ¼ 10 lg 1= 1=10ACLR=10 þ 1=10ACS=10




ð1Þ
Based on reference [13], Spectrum Emission Mask of LTE FDD can be found as
Table 8.
According to different frequency interval and data in Table 8, subsection integra-
tion is applied to get the power leakage P(mW) from LTE FDD side to CBTC side.
Then ACLR of different frequency isolation can be obtained by Eq. (2) as Table 9,
where PT is transmitting power of LTE FDD terminal, whose unit is dBm.
ACLR ¼ PT  10 logðPÞ
ð2Þ
Table 7. System parameters of CBTC system
System
parameters
CBTC
BS
CBTC
Train
Frequency band
1785 MHz–1805 MHz
1785 MHz–1805 MHz
Bandwidth
5 MHz/10 MHz
5 MHz/10 MHz
Maximum transmit power
40 dBm/43 dBm
30 dBm/33 dBm
Noise ﬁgure
5 dB
9 dB
Maximum antenna gain(including
feeder loss)
15 dB
0 dB
Antenna height
20 m
5 m
Protection criterion(I/N)
−6 dB
−6 dB
Receiving sensitivity
–
−93 dBm
478
R. Xu et al.

The ACLR model that GSM base station interferes CBTC Train is shown as Fig. 5.
Based on reference [14], the spectrum emission mask of GSM base station can be
found as Table 10. And according to reference [14] Sect. 4.2.1.1, subsection integra-
tion is applied on the speciﬁed measurement bandwidth and data in Table 10, to get the
power leakage P(mW) from GSM base station to CBTC Train. Then ACLR that GSM
base station interferes CBTC Train, in different frequency isolation can be obtained by
Eq. (2) as Table 11.
CBTC train terminal belongs to TD-LTE terminal. Depending on reference [11],
the ACS of CBTC train side can be obtained by Eq. (3).
ACS ¼ PInterfer  N  10  log10ð10M=10  1Þ
ð3Þ
Table 8. Spectrum emission mask of LTE FDD
DfOOB
(MHz)
1.4 MHz 3.0 MHz 5 MHz 10 MHz 15 MHz 20 MHz Measurement
bandwidth
±0–1
−10
−13
−15
−18
−20
−21
30 kHz
±1–2.5
−10
−10
−10
−10
−10
−10
1 MHz
±2.5–2.8 −25
−10
−10
−10
−10
−10
1 MHz
±2.8–5
−10
−10
−10
−10
−10
1 MHz
±5–6
−25
−13
−13
−13
−13
1 MHz
±6–10
−25
−13
−13
−13
1 MHz
±10–15
−25
−13
−13
1 MHz
± 15–20
−25
−13
1 MHz
± 20–25
−25
1 MHz
12
7
8
9
10
11
6
1
2
3
4
5
2.4MHz
GSM BS
CBTC
UE
ACLR1
12
Carrier Interval
Fig. 5. The ACLR model that GSM base station interferes CBTC train
Table 9. ACLR from LTE FDD side to CBTC side in different frequency isolation
Case
Adjoin adjacent
interfere/5 MHz
bandwidth
Adjoin adjacent
interfere/10 MHz
bandwidth
5 MHz frequency
isolation/5 MHz
bandwidth
5 MHz frequency
isolation/10 MHz
bandwidth
ACLR(dB) 21.37
21.19
35.02
35.02
Interference and Coexistence of CBTC in 1.8 GHz Band
479

where PInterfer stands for in band blocking, whose unit is dBm. and N is noise ﬂoor,
whose unit is dBm. M stands for uplift measure of noise ﬂoor whose unit is dB.
(1) ACS calculation of CBTC terminal interfered by GSM base station
According to reference [14], it’s narrow band signal interference that GSM base
station interferes CBTC terminal. However, the B/2 bandwidth narrow out band
blocking limit is not given. Where B stands for system bandwidth of CBTC. To be
more strictly, assume that PInterfer is identical between CBTC and GSM isolation
5 MHz or 10 MHz. Based on reference [14] Table 7.6.3.1–1 and reference [12], we
know PInterfer = −55 dBm.When CBTC bandwidth is 5 MHz, N = −98.01 dBm,
M = 13 dB. And when CBTC bandwidth is 10 MHz, N = −95 dBm, M = 10 dB.
(2) ACS calculation of CBTC terminal interfered by LTE FDD terminal
Depending on reference [13], when the frequency interval between CBTC terminal
and LTE FDD terminal is under 15 MHz, then it belongs to in band blocking. As a
result, PInterfer is identical in situation 5 MHz and 10 MHz isolation between CBTC
and LTE FDD system. Based on reference [13] Table 7.6.1.1–1, it can be found that
PInterfer = −44 dBm. When bandwidth of CBTC is 5 MHz, N = −98.01 dBm,
M = 6 dB. And when bandwidth of CBTC is 10 MHz, N = −95 dBm, M = 6 dB.
The above calculation parameters are taken into Eq. (3). Then ACS of CBTC train
side in different condition can be found in Table 12.
Table 10. Spectrum emission mask of GSM base station
Power
level
100
200 250 400
 600
 1 800
 3 000
 6 000
 39
+0,5 –30 –33 –60
–66
–69
–71
–77
37
+0,5 –30 –33 –60
–64
–67
–69
–75
35
+0,5 –30 –33 –60
–62
–65
–67
–73
 33
+0,5 –30 –33 –60* –60
–63
–65
–71
Table 11. ACLR from GSM side to CBTC side in different isolation cases
Case
200 kHz
frequency
isolation/5 MHz
bandwidth
200 kHz frequency
isolation/10 MHz
bandwidth
5 MHz frequency
isolation/5 MHz
bandwidth
5 MHz frequency
isolation/10 MHz
bandwidth
ACLR(dB) 21.26
21.25
57.97
54.97
Table 12. The ACS of CBTC train side in different condition
Case
GSM interfere
CBTC/Bandwidth
of CBTC is
5 MHz
GSM interfere
CBTC/Bandwidth
of CBTC is
10 MHz
FDD LTE interfere
CBTC/Bandwidth
of CBTC is 5 MHz
FDD LTE interfere
CBTC/Bandwidth
of CBTC is
10 MHz
ACS(dB) 30.23
30.45
49.26
46.25
480
R. Xu et al.

The ACLR and ACS obtained are taken into Eq. 1. The ACIR of 4 categories
CBTC train interfered by interference system can be found as Table 13.
4.3
Calculation of Safety Isolation Distance
Safety isolation can be obtained by Eq. (4).
LP ¼ PT þ GT þ GR  LT  LR  ACIR  I
ð4Þ
PT stands for maximum transmit interfere power, whose unit is dBm. And GT is
antenna gain of interfere system, whose unit is dB. GR stands for antenna gain of
interfered system, whose unit is dB. LT stands for feed line loss of interfere system,
whose unit is dB. And LR stands for feed line loss of interfered system, whose unit is
dB. ACIR is adjacent channel interference power ratio, whose unit is dB. I stands for
maximum interference signal power of interfered system, whose unit is dBm, which
can be obtained by protection principle of interfered system I/N = −6 dB.
Vehicle environment model [15] of UMTS is applied as BS to terminal path loss,
which can be described as Eq. (5), where d is distance, unit is km, f is carrier frequency,
unit is MHz, H is height of antenna, unit is m, h is benchmark roof height, which is set
to be 15 m, and s is log normal distribution, which is set to be 5 dB.
LP ¼ 40  ð1  4  103  ðH  hÞÞ lgðdÞ  18 lgðH  hÞ þ 21  lgðf Þ þ 80 þ s
ð5Þ
PCS micro cell model [16] is applied as terminal to terminal path loss, which can be
described as (6), where n1 and n2 are path loss index, which are valued 2.3 and 3.1
respectively, k is wavelength, d is distance between transmit and receive antenna,
whose unit is m, df is distance of ﬁrst Fresnel zone, whose unit is m, s is transit path loss
of 1 m, which can be obtained by free space model, whose unit is dB, ht and hr stand
for antenna height of transmitter and receiver respectively, whose unit is m.
LP ¼ 10n1 lg d
ð Þ þ s
1\d\df
LP ¼ 10n1 lg d=df


þ 10n2 lg df


þ s
d [ df
df ¼ 1
k
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
16h2
t h2
r  k2 h2
t þ h2
r


þ k4=16
q
ð6Þ
By taking data of Tables 6, 7 and 13 into Eqs. (5) and (6), the safety isolation and
isolation distance between CBTC train side and interfere system can be found in
Table 14.
Table 13. The ACS of CBTC train side in different condition
Case
Adjoin adjacent
interfere/5 MHz
bandwidth
Adjoin adjacent
interfere/10 MHz
bandwidth
5 MHz frequency
isolation/5 MHz
bandwidth
5 MHz frequency
isolation/10 MHz
bandwidth
Interfere side
GSM
FDDLTE
GSM
FDDLTE
GSM
FDDLTE
GSM
FDDLTE
ACIR(dB)
20.74
21.36
20.75
21.17
30.22
34.85
30.43
34.70
Interference and Coexistence of CBTC in 1.8 GHz Band
481

From above analysis, the isolation distance between GSM base station, LTE FDD
terminal, McWill base station, McWill terminal and CBTC train side is quite long. It is
inappropriate to deploy CBTC system in the area where McWill system exists. The
method that assigns CBTC system in 1790 MHz–1800 MHz can be used to realize
minimum isolation distance between CBTC system and interfere systems. However,
only apply isolation distance measures is not enough. For example, when CBTC
system works in 1790 MHz–1800 MHz band, safety isolation between CBTC train and
GSM base station is 0.643 km. The cell radius of GSM is 250 m, which can not fulﬁll
isolation distance requirement. Hence, additional isolation measures are needed to
guarantee that GSM base station and LTE FDD terminal do not cause harmful inter-
ference to CBTC system.
5
Conclusion
To solve 1785 MHz–1805 MHz CBTC downlink interference problem, this paper
ﬁrstly analyzes domestic identical and adjacent frequency band assignment situation.
Then this paper ﬁnds out study scenario based on ﬁeld testing data. Afterward, this
paper calculates isolation distance between interfere and interfered party by ACIR
modeling and deterministic calculations. Depending on the research results mentioned
above, the advice is given that CBTC system should be assigned to 1790 MHz–
1800 MHz.
Table 14. Isolation and isolation distance between CBTC train and interferes in different
condition
Case
Adjoin adjacent
interfere/5 MHz bandwidth
Adjoin adjacent
interfere/10 MHz bandwidth
5 MHz frequency
isolation/5 MHz
bandwidth
5 MHz frequency
isolation/10 MHz
bandwidth
Interfere side
GSM
FDD
LTE
GSM
FDD
LTE
GSM
FDD
LTE
GSM
FDD
LTE
Safety
Isolation
(dB)
138
102
135
100
128
89
125
86
Isolation
distance
(km)
1.427
0.384
1.187
0.331
0.773
0.146
0.643
0.117
Case
Same frequency
band/5 MHz bandwidth
Same frequency
band/10 MHz bandwidth
Interfere side
McWill BS
McWill UE
McWill BS
McWill UE
Safety
Isolation
(dB)
156
128
153
131
Isolation
distance
(km)
4.297
2.64
3.576
3.31
482
R. Xu et al.

References
1. Wan, Y., Wang, D., Mei, M., Waterman, M.S.: Composable modeling method for generic
test platform for CBTC system based on the port. J. Int. J. Adv. Comput. Sci. Appl. 12(6)
(2015)
2. MIIT No. 65 Document (2015)
3. Zhang, H., Dong, Y., Cheng, J., Hossain, Md.J., Leung, V.C.M.: Fronthauling for 5G
LTE-U Ultra Dense Cloud Small Cell Networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
4. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
5. Wang, C.Y., Wei, H.Y., Chen, W.T.: Resource block allocation with carrier-aggregation: a
strategy-proof auction design. J. IEEE Trans. Mob. Comput. 15(12), 3142–3155 (2016)
6. Cui, Y., Yang, L., Liu, B., Li, R.: Multiband planar antenna for LTE/GSM/UMTS and
WLAN/WiMAX handsets. J. IET Microwaves Antennas Propag. 10(5), 502–506 (2016)
7. Zhu, G.: McWill and its applications in power communication system. [J]. Telecommu-
nications for Electric Power System (2009)
8. Terminal Equipment Speciﬁcation for LTE-M. http://www.camet.org.cn
9. General System Architecture and Function Speciﬁcation for LTE-M. http://www.camet.org.cn
10. LTE-M Interface Speciﬁcation for CBTC. http://www.camet.org.cn
11. Jingdi, L., Jian, F., Ge, M.: Research on Interference and Coexistence between Radio Access
System in 1785 MHz–1805 MHz Band and Adjacent IMT System. Technical report, CCSA
TC5 WG8 82th Meeting, Chang Sha (2016)
12. Liyan, Y., Jian, J.: Research on Interference and Coexistence between GSM in
900/1800 MHz Band and LTE(FDD/TDD). Technical Report, CCSA TC5 WG8 63th
Meeting, Zhang Jia Jie (2013)
13. 3GPP TS 36.101 V13.5.0(2016-09). http://www.3gpp.org/DynaReport/36-series.htm
14. 3GPP TS 45.005 V13.2.1(2016-09). http://www.3gpp.org/DynaReport/45-series.htm
15. 3GPP TR 36.942 V13.0.0(2016-01). http://www.3gpp.org/DynaReport/36-series.htm
16. Propagation Model. http://wenku.baidu.com
Interference and Coexistence of CBTC in 1.8 GHz Band
483

Joint C-V-BLAST and DS-NOMA
for Massive MIMO
Khawla A. Alnajjar1(B) and Mohamed El-Tarhuni2
1 Department of Electrical and Computer Engineering, University of Sharjah,
Sharjah, United Arab Emirates
kalnajjar@sharjah.ac.ae
2 Department of Electrical Engineering, American University of Sharjah,
Sharjah, United Arab Emirates
mtarhuni@aus.edu
Abstract. We investigate the performance of modiﬁed non orthogonal
multiple access (NOMA) which uses the modiﬁed low complexity Ver-
tical Bell Laboratories Layered Space Time (C-V-BLAST) in an uplink
massive multiple-input-multiple-output (MIMO) deployment with dis-
tributed single-antenna users and a large base-station array. Unlike pre-
vious work which assumes no spreading, we focus on the scenario where
signal spreading is included by using the Gold Code family. It is shown
that the proposed scheme provides a signiﬁcant performance improve-
ment over the conventional V-BLAST system for a large MIMO deploy-
ment when the number of transmit and receive antennas are comparable
by exploiting the extra dimension added by the spreading to mitigate
the interference. However, for a massive MIMO system, both schemes
provide similar performance. We also show that the proposed scheme
has a much better performance when the average received power for the
users is the same, a scenario that the C-V-BLAST scheme struggles with
due to its dependence on the ordering of users according to their power
levels.
Keywords: Gold code · Massive MIMO · MRC
Non Orthogonal Multiple Access (NOMA) · V-BLAST
1
Introduction
It has been shown that massive multi-input multi-output (MIMO) systems
increase throughput, the degrees of freedom, energy eﬃciency and reliability
of wireless systems [1,2]. Hence, massive MIMO is one of the key proposed tech-
nologies for ﬁfth generation (5G) systems. Due to the large number of base
station (BS) antennas, ﬁnding the right tradeoﬀbetween system performance
and receiver complexity is a critical concern.
One of the most successful receiver strategies for traditional MIMO is the
Vertical Bell Laboratories Layered Space Time (V-BLAST) method. It is a multi-
layer symbol detection scheme. It combines linear (interference suppression) and
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 484–492, 2018.
https://doi.org/10.1007/978-3-319-72823-0_45

Joint C-V-BLAST and DS-NOMA for Massive MIMO
485
nonlinear algorithms (serial cancellation). The majority of works on traditional
V-BLAST consider the use of minimum-mean-square-error (MMSE) or zero forc-
ing (ZF) detection. Therefore, conventional V-BLAST is too computationally
intensive for massive MIMO. In [3], a modiﬁed V-BLAST scheme was proposed
by replacing ZF or MMSE receivers with maximal ratio combining (MRC) and
using a one-shot ordering method based on channel norms. This scheme, which
is denoted as C-V-BLAST, has similar performance to linear ZF detection, but
lower complexity. Both MRC and the single ordering technique were needed in
[3] to obtain the reduction in complexity.
Non-Orthogonal Multiple Access (NOMA) techniques introduce redundancy
by coding/spreading to facilitate the users signals separation at the receiver. In
NOMA, multiple users are encouraged to transmit at the same time, code and
frequency, but with diﬀerent power levels. In fact, NOMA allocates less power
to the users with better channel conditions, and these users can decode their
own information by applying successive interference cancellation. Conventional
V-BLAST with code division multiple access (CDMA) has been studied in [4–6].
NOMA for 5G has been studied such as in [7–10].
To the best of our knowledge, the performance of NOMA with C-V-BLAST
in the context of massive MIMO has not been investigated. Thus, in this paper,
our contribution is that we proposed a modiﬁed NOMA algorithm to investi-
gate massive MIMO system performance. Instead of applying successive inter-
ference cancellation at each stage, we use the idea of C-V-BLAST by sorting the
users once and this will reduce the receiver complexity. Each user data is spread
using a Gold Code to provide further separation among the users resulting in
an improved performance of the C-V-BLAST scheme with minor increase in
complexity. We study the eﬀect of power distribution of users and system size.
The rest of the paper is organized as follows. Section 2 introduces the system
model. Section 3 gives an overview of receiver structures used in this work. Sim-
ulation results are provided in Sect. 4, and ﬁnally our conclusions are in Sect. 5.
2
System Model
We consider an uplink system with Nt single antenna user equipments (UEs)
and a base station (BS) with Nr receive antennas. The vector, s, of size Nt × 1
is s = [s1, s2, . . . sNt]T , where sj is the data symbol of UE j drawn form a
ﬁnite alphabet. The spreading code matrix Cc = [c1, c2, . . . cNt] and has a size
of Nt × Lc, where Lc is the code length. Note that cj is vector of size Lc × 1
representing the code of user j. In this paper we consider Gold Code for with
Lc = 127. Suppose the transmitted data symbol matrix X = [x1, x2, . . . , xNt]
where, xj = sjcj, sj = {−1, 1} and j = 1, . . . , Nt. The channel matrix of size
Nr × Nt is H = [h1 · · · hNt], where hi = [hi1hi2 . . . hiNr]T . The noise matrix,
N, of size Nr × Lc has independent and identically distributed (i.i.d.) complex
Gaussian elements, i.e., ni ∼CN(0, σ2). The received signal, Y of size Nr × Lc,
is given by
Y = HX + N = HsCT
c + N.
(1)

486
K. A. Alnajjar and M. El-Tarhuni
The transmitted signal power is e[|xj|2] = Es = 1 and the noise power is
e[|ni|2] = σ2. When there is no spreading, C = 1 and Lc = 1.
BS
User 1
User 2
User N
P1
P2
PN t
1
2
Nr
t
Fig. 1. System diagram where UEs are located randomly in a circular coverage area.
The channel matrix is given by
H = UP
1
2 .
(2)
The channel coeﬃcient, hij, from UE j to receive antenna i has a link gain
e[|hij|2] = Pj. The elements of U are i.i.d. CN(0, 1), and the link gain matrix is
P = diag(P1, P2, . . . , PNt) where Pj is the link gain of user j, which accounts for
path loss, shadowing, etc. We utilize a simple model [11] so that the link gain of
the jth user can be calculated as Pj = Aβj−1, where β controls the rate of decay
of the link gains (0 < β ≤1), and A is the link gain of the strongest UE. This
model gives ordered link gains of the users such that P1 > P2 > · · · > PNt. This
has no eﬀect on the generality of the results because the user order is arbitrary.
As β →0 the link gains are dominated by one strong UE, while as β →1 the
link gains become equal. This simple model is used in order to control the Pj’s
with a single parameter, β, which has a physical interpretation. Additionally,
this model is useful because of the importance of the decay rate in V-BLAST,
which is heavily dependent on the diﬀerences between the link gains.
3
Receivers
In this paper, we focus on MRC within a low complexity V-BLAST structure
(C-V-BLAST) [3]. The simplest linear combiner, MRC, of the form, HHY ,

Joint C-V-BLAST and DS-NOMA for Massive MIMO
487
where HH represents the complex conjugate transpose of H. The linear zero
forcing combiner in general performs better than MRC. The combining matrix of
ZF is calculated by W = H(HHH)−1. Note that ZF combiner involves matrix
inversion which may be undesirable in massive MIMO because of stability and
complexity issues.
The C-V-BLAST method [3] utilizes V-BLAST combined with MRC detec-
tion and a single ordering based upon instantaneous channel norms. This tech-
nique provides results similar to V-BLAST combined with linear ZF [3] while
avoiding the computational bottlenecks of conventional V-BLAST. Assume
ordered set S(C) = {k(C)
1
, k(C)
2
, . . . , k(C)
Nt } be a permutation of {1, 2, . . . , Nt},
which decides the detecting order of x. The ordering for C-V-BLAST is calcu-
lated by [3]
k(C)
i
=
arg max
j /∈{k1,k2,...,ki−1}
||hj||2.
(3)
We used the same receiver structure as the C-V-BLAST scheme but with
an additional operation that processes the baseband received spread message
for each user and de-spread it with its corresponding Gold Code. The output of
the de-spreading block is applied to the C-V-BLAST detector for normal pro-
cessing. Algorithm 1 shows the pseudo-code algorithm of the proposed (Gold
C-V-BLAST) scheme. The de-spreading operation is relatively simple to imple-
ment with a total number of additional NtLc complex multiplications.
In terms of the number of complex multiplications, the complexity of C-V-
BLAST is O(NrNt), but that of ZF is O(NrN 2
t ) [3]. Table 1 shows a comparison
of the implementation complexity of the proposed scheme to the ZF and C-V-
BLAST.
Table 1. Complexity comparison
Technique
Complexity
ZF
O(NrN 2
t )
C-V-BLAST
O(NrNt)
Gold C-V-BLAST O(NrNt + NtLc)
4
Simulation Results
In this section, we use numerical simulations to investigate the performance of
massive MIMO receivers.
Performance is measured by the symbol error rate (SER) assuming quadra-
ture phase shift keying (QPSK) modulation. The results were averaged over the
users and 10,000 independent channel realizations. In the ﬁgures, the SNR is the
SNR of the strongest UE, given by
A
σ2 , where A = 1 without loss of generality.
The C-V-BLAST receiver is used with and without spreading. Gold Code is
used for spreading but other types of codes might be used as well. In this paper,

488
K. A. Alnajjar and M. El-Tarhuni
Algorithm 1. Gold C-V-BLAST Algorithm
1) Initialization:
i = 1
i is the iteration number.
c
c is the code matrix.
y
y is the received signal.
H
H is the channel matrix.
k
Sort decently based on ki.
ki =
arg max
j /
∈{k1,k2,...,ki−1}
||hj||2.
2) Iterative Process:
W = H
Calculate the MRC linear combiner.
G = WH
Find the Hermitian of the linear combiner, W.
mki = (Gi)ki.
mki is the ith row of G.
˜
xi = mkiy
Calculate the estimated input signal ˜
xi.
ˆ
xi = ˆ
Q[Lc
i=1 ˜
xicki]
ˆ
Q(.) is the quantization (slicing) operation appropriate to the
constellation in use.
yi+1 = yi −hki( ˆ
xkicki)
The interference due to
ˆ
xkicki is canceled.
Hi+1 = H
¯
ki
i
Update H at iteration i by zeroing the ki column.
This is denoted by H
¯
ki
i .
i = i + 1
Update i,.
ki = k(i).
Update ki index.
we consider the length of Gold Code with Lc = 127. We use [1 0 0 0 1 0 0] and
[1 0 0 0 1 1 1] as the preferred polynomials for length 127 code generation [12].
We assume that the code is ﬁxed for each user.
The baseline parameters are: β = 0.7, Nt = 10, Nr = 100 and the modiﬁed
NOMA which C-V-BLAST uses Gold Code with length 127 (Gold C-V-BLAST
127). Where other parameters are used, they are given in the ﬁgure captions.
Figure 2 shows the SER performance of C-V-BLAST and Gold C-V-BLAST
127 vs SNR with Nt = 10, β = 0.7, Nr ∈{10, 50, 100}. We notice that as
Nr decreases and approaches Nt, spreading becomes beneﬁcial since the C-V-
BLAST system cannot cope with the high interference with the small number of
antennas and the extra dimension added by the spreading is exploited to mitigate
the interference. Note that when Nr > Nt, spatial diversity will improve the C-
V-BLAST system performance and there is no gain from using the spreading
scheme.
Figure 3 shows the SER performance of C-V-BLAST and Gold C-V-BLAST
127 vs SNR with Nr = 10, β = 0.7, Nt ∈{10, 50, 100}. As Nt exceeds Nr with
larger size, C-V-BLAST performance is already poor and hence spreading will
not help much. When the ratio Nr/Nt = 1, coding becomes beneﬁcial when the
system size is small, i.e. small number of base station antennas.
Figure 4 shows the SER performance of C-V-BLAST and Gold C-V-BLAST
127 vs SNR with Nr = 100, β = 0.7, Nt ∈{10, 50, 100}. It is observed that as Nt
increases, the performance of both schemes improve but there is no performance
diﬀerence with or without spreading. We have noticed that for systems with a
large size (i.e. Nr/Nt exceeds 10), spreading is not beneﬁcial.

Joint C-V-BLAST and DS-NOMA for Massive MIMO
489
SNR
-20
-15
-10
-5
0
5
10
15
20
SER
10-4
10-3
10-2
10-1
100
Without spreading, Nr =10
With spreading, Lc = 127, Nr =10
Without spreading, Nr =50
With spreading, Lc = 127, Nr =50
Without spreading, Nr =100
With spreading, Lc = 127, Nr =100
Fig. 2. SER versus SNR for C-V-BLAST (without spreading) and Gold C-V-BLAST
127 (with spreading). Nt = 10, β = 0.7, Nr ∈{10, 50, 100}.
−20
−15
−10
−5
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR
SER
Without spreading, Nt =10
With Spreading, Lc = 127, Nt =10
Without spreading, Nt =50
With Spreading, Lc = 127, Nt =50
Without spreading, Nt =100
With Spreading, Lc = 127, Nt=100
Fig. 3. SER versus SNR for C-V-BLAST (without spreading) and Gold C-V-BLAST
127 (with spreading). Nr = 10, β = 0.7, Nt ∈{10, 50, 100}.
Figure 5 shows the SER performance of C-V-BLAST and Gold C-V-BLAST
127 with Nt = 10, Nr = 10, β ∈{0.5, 0.9, 0.7}. The system performance is
strongly aﬀected by β. As β increases, the proposed scheme provides more
improvement over the C-V-BLAST scheme, which suﬀers from poor performance
when the channel link gain are not widely distinctive.

490
K. A. Alnajjar and M. El-Tarhuni
SNR
-20
-15
-10
-5
0
5
10
15
20
SER
10-4
10-3
10-2
10-1
100
Without spreading, Nt =10
With spreading, Lc = 127, Nt =10
Without spreading, Nt =50
With spreading, Lc = 127, Nt =50
Without spreading, Nt =100
With spreading, Lc = 127, Nt=100
Fig. 4. SER versus SNR for C-V-BLAST (without spreading) and Gold C-V-BLAST
127 (with spreading). Nr = 100, β = 0.7, Nt ∈{10, 50, 100}.
−20
−15
−10
−5
0
5
10
15
20
10
−4
10
−3
10
−2
10
−1
10
0
SNR
SER
Without spreading, β = 0.5
With spreading, Lc = 127, β = 0.5
Without spreading, β = 0.7
With spreading, Lc = 127, β = 0.7
Without spreading, β = 0.9
With spreading, Lc = 127, β = 0.9
Fig. 5. SER versus SNR for C-V-BLAST (without spreading) and Gold C-V-BLAST
127 (with spreading). Nt = 10, Nr = 10, β ∈{0.5, 0.9, 0.7}.
For more clariﬁcation of Fig. 5, the SER performance of C-V-BLAST and
Gold C-V-BLAST 127 vs β with Nt = {10, 100}, Nr = {10, 100} at SNR = 0
dB is presented in Fig. 6. It is noted that as β increases, the SER performance
degrades. This is because C-V-BLAST works best when there is a wide diﬀerence
among the users’ powers but fails to perform adequately when the channel links
have similar power levels. However, spreading the users’ data using the Gold
Codes results in good performance when the users have almost equal powers.

Joint C-V-BLAST and DS-NOMA for Massive MIMO
491
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
SER
10-3
10-2
10-1
100
Without spreading, Nt=10 , Nr = 100
With spreading, Nt=10 , Nr = 100
Without spreading, Nt=10 , Nr = 10 
With spreading, Nt=10 , Nr = 10
Without spreading, Nt=100 , Nr = 100 
With spreading, Nt=100 , Nr = 100
Fig. 6. SER versus β for C-V-BLAST (without spreading) and Gold C-V-BLAST 127
(with spreading). Nt = {10, 100}, Nr = {10, 100} and SNR = 0 dB.
5
Conclusions
In this paper, we propose a modiﬁed NOMA scheme for uplink massive MIMO
applications. The user data is spread using a Gold Code prior to transmission
and a reduced complexity receiver based on C-V-BLAST structure is used. It
is shown that spreading results in improved symbol error rate performance for
large size MIMO system. However, for a massive MIMO system with a large
number of receive antennas, there is no gain from spreading. Finally, the impact
of the link gain diﬀerence among the users is investigated.
Acknowledgment. This research was supported in part by the Distributed and
Networked Systems Research Group Operating Grant number 150410, University of
Sharjah, and Seed Grant No. 1602040224-P.
References
1. Ngo, H.Q., Larsson, E.G., Marzetta, T.: Energy and spectral eﬃciency of very
large multiuser MIMO systems. IEEE Trans. Commun. 61(4), 1436–1449 (2013)
2. Rusek, F., Persson, D., Kiong, B.L., Larsson, E., Marzetta, T.L., Edfors, O.,
Tufvesson, F.: Scaling up MIMO: Opportunities and challenges with very large
arrays. IEEE Signal Process. Mag. 30(1), 40–60 (2013)
3. Alnajjar, K.A., Smith, P.J., Woodward, G.K.: Low complexity V-BLAST for mas-
sive MIMO. In: Proceedings of Australian Communications Theory Workshop
(AusCTW), pp. 22–26. IEEE (2014)
4. Zhao, J., Li, X.: A novel iterative equalization algorithm for multicode CDMA
system with V-BLAST architecture. In: Proceedings of Consumer Communications
and Networking (CCNC), pp. 211–214. IEEE (2005)

492
K. A. Alnajjar and M. El-Tarhuni
5. Fu, H., Tao, Y.: A novel nonlinear precoding detection algorithm for VBLAST in
MIMO-MC-CDMA downlink system. Phys. Procedia 24, 1133–1139 (2012)
6. Samardzija, D., Wolniansky, P., Ling, J.: Performance evaluation of the VBLAST
algorithm in W-CDMA systems. In: Proceedings of Vehicular Technology (VTC),
vol. 2, pp. 723–727 (2001)
7. Ding, Z., Peng, M., Poor, H.V.: Cooperative non-orthogonal multiple access in 5G
systems. IEEE Commun. Lett. 19(8), 1462–1465 (2015)
8. Al-Imari, M., Xiao, P., Imran, M.A., Tafazolli, R.: Uplink non-orthogonal multi-
ple access for 5G wireless networks. In: Proceedings of Wireless Communications
Systems (ISWCS), pp. 781–785. IEEE (2014)
9. Lei, L.: From Orthogonal to Non-orthogonal Multiple Access: Energy-and
Spectrum-Eﬃcient Resource Allocation. Linkoping University Electronic Press,
Linkoping (2016)
10. Ali, M.S., Hossain, Kim, D.I.: Non-Orthogonal Multiple Access (NOMA) for Down-
link Multiuser MIMO Systems: User Clustering, Beamforming, and Power Alloca-
tion. arXiv preprint arXiv:1611.07425 (2016)
11. Gao, H., Smith, P.J., Clark, M.V.: Theoretical reliability of MMSE linear diversity
combining in Rayleigh-fading additive interference channels. IEEE Trans. Com-
mun. 46(5), 666–672 (1998)
12. Peterson, W.W., Weldon, E.J.: Error-Correcting Codes. MIT press, Cambridge
(1972)

Low-Complexity Equalization of Continuous
Phase Modulation Using Message Passing
Jian Zhang1(&), Zuyao Ni2, Sheng Wu2, and Linling Kuang2
1 Department of Electronic Engineering, Tsinghua University, Beijing, China
jian-zha14@mails.tsinghua.edu.cn
2 Tsinghua Space Center, Tsinghua University, Beijing, China
{nzy,thuraya,kll}@tsinghua.edu.cn
Abstract. In this paper, based on factor graphs and Laurent decompositions,
we propose an iterative receiver of CPM signals over interference (ISI) channels.
We adopt the Gaussian message passing to simplify the message passing in
factor graphs. Compared with the conventional receivers with the minimum
mean squared error (MMSE) frequency domain equalization (FDE) and the
BCJR demodulator, the proposed algorithm has advantages in terms of com-
plexity. And the proposed algorithm can achieve better performance with the
convolutional code.
Keywords: Continuous phase modulation  Iterative receivers
Factor graphs  ISI
1
Introduction
Continuous phase modulation (CPM) is a nonlinear modulation in which the phase is a
continuous function of time [1]. CPM is attractive for its good spectral efﬁciency and
constant envelope. However, the optimal receiver of CPM using maximum-likelihood
sequence detection (MLSD) is consists of a ﬁlter bank followed by a Viterbi decoder.
As a consequence, the optimal receiver of M-ary CPM signals requires a bank of 2ML
matched ﬁlters and a trellis diagram with pML1 states, where L is the memory of the
CPM pulse and p is the number of phase states.
Considering the practical applications of CPM, several methods have been pro-
posed in the literature to reduce the complexity of the receiver, such as Rimoldi
decomposition [2], Walsh decomposition [3] and Laurent decomposition (LD) [4]. In
[4], by Laurent decomposition (LD), the binary CPM signal is decomposed into a sum
of pulse amplitude modulation (PAM) signals. Moreover, Mengali and Morelli extend
the LD from binary CPM signals to M-ary CPM signals [5]. The LD can signiﬁcantly
reduce both the number of matched ﬁlters and the number of states in trellis diagram,
and is more popular used than the other methods. Such as, a reduced-complexity
suboptimal detection of CPM signals is proposed based on the extended Laurent
representation in [6].
To mitigate the inter-symbol interference (ISI) caused by multipath environments,
the equalization is necessary at the receiver to mitigate the ISI for CPM. The optimum
receiver of CPM with ISI is a kind of maximum likelihood sequence estimation
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 493–505, 2018.
https://doi.org/10.1007/978-3-319-72823-0_46

(MLSE) receiver in the time domain. The complexity of this receiver is effected by both
the memory of CPM signals and the delay spread of the multipath channel. As the
complexity grows exponentially with the length of the spread, the MLSE receiver is
unfeasible for the channel with long delay multipath taps. To solve this problem, the
frequency domain equalization (FDE) approach is extended to the CPM scenarios.
A series of literature concerned on the study of FDE in CPM receivers appears since
2000s. In 2005, Tan and Stuber study the application of linear single-carrier
frequency-domain equalization (SC-FDE) to CPM [7]. Their method can provide better
BER performance and lower complexity cost than the optimal receivers for multipath
channels having long delay components. A year later, Pancaldi and Vitetta combined
the frequency-domain equalization and iterative information exchange [8]. In [9], a
frequency domain double turbo equalizer of CPM is proposed by combining the
soft-input soft-output (SISO) FDE, the SISO CPM demodulator and the SISO decoder.
Iterative receivers based on factor graphs (FG) and the sum-product algorithm
(SPA) have been widely used in linear modulation scenarios to solve the problem of the
inter-symbol interference. Moreover, various approximate inference algorithms have
been proposed to reduce the complexity of message passing in graphical models, such
as the Gaussian message passing (GMP) [10], the expectation propagation [11–13].
However, less attention has been devoted to the application of this method to CPM
scenario. In [14], the FG and SPA is used in the detection of CPM signals over channel
affected by phase noise.
In this paper, we consider the equalization and detection of CPM signals over
multipath channels based on factor graphs and the SPA. By using the Laurent
decomposition
and
the
Gaussian
message
passing,
we
proposed
a
kind
of
low-complexity time-domain turbo equalization of CPM signals. It will be shown that
the designed receivers have similar performance with respect to the optimal detectors
regardless of the code part. Considering the convolutional code, it has better perfor-
mance than the MMSE-FDE and optimal detectors.
The paper is organized as follows. In Sect. 2, we describe the system model
including the signal model of CPM based on the Laurent decomposition and the model
of received signals after multipath channel. The system model is used in Sect. 3 to
realize the low-complexity turbo equalization. Section 4 shows the simulation results
and conclusions are drawn in Sect. 5 ﬁnally.
2
Signal Model
In this paper, only single modulation index CPM is considered. In general, a CPM
signal can be expressed as [1]:
sðt;~aÞ ¼
ﬃﬃﬃﬃﬃﬃﬃ
2Es
T
r
expfj2ph
X
n
anqðt  nTÞg
ð1Þ
where Es is the energy per symbol, T is the symbol period, h ¼ r=p is the modulation
index (r and p are relatively prime integers), fang are the transmitted information
494
J. Zhang et al.

symbols, an 2 f1; 3; . . .; M  1g, n ¼ 0; . . .; N  1. The function qðtÞ is the
phase response and has the form as:
qðtÞ ¼
0;
if t  0
R t
0 gðsÞds;
if 0\t\LT
1=2;
if t  LT
8
<
:
ð2Þ
where the gðsÞ is the frequency pulse deﬁned over a ﬁnite time interval 0  t  LT.
Exploiting the extended Laurent decomposition [4, 5], the CPM signals can be
expressed as a sum of linearly modulated signals:
sðt;~aÞ ¼
X
K1
k¼0
X
n
ak;npkðt  nTÞ
ð3Þ
in which K  Qlog2 MðM  1Þ, Q ¼ 2L1 and pkðtÞ is the k th PAM component and the
symbols fak;ng are the function of the transmitted information symbols {an}. The
Laurent
decomposition
in
(3)
can
exactly
express
the
CPM
signals
when
K ¼ Qlog2 MðM  1Þ. Considering most of the signal power is concentrated on the ﬁrst
M  1 PAM components, a value of K ¼ M  1 is usually be used to attain a good
tradeoff between the complexity of the system and the approximation quality of
Laurent decomposition. In this paper, we only consider the ﬁrst PAM component to
further reduce the complexity of the receiver. As a consequence, we obtain an
approximation of sðt;~aÞ:
sðt;~aÞ 
X
n
a0;np0ðt  nTÞ:
ð4Þ
As shown in [6], the symbol a0;n can be expressed as a function of a0;n1 and an:
a0;n ¼ a0;n1ejphan:
ð5Þ
Furthermore, we employ an equivalent representation of information symbols:
an ¼ an þ ðM  1Þ
2
ð6Þ
in which an 2 f0; 1; . . .; M  1g. Substituting (6) into (5), we can get a new expression
about a0;n:
a0;n ¼ ejphðM1Þðn þ 1Þej2ph/n
ð7Þ
/n ¼ ½/n1 þ anp
ð8Þ
where /n is the accumulation of phase, /n 2 f0; 1; . . .; p  1g and ½p denotes the
“modulo p” operator.
Considering the multipath channels, the received signals can be expressed as:
Low-Complexity Equalization of Continuous Phase Modulation
495

rðtÞ ¼
X
NL1
l¼0
hlsðt  slTÞ þ wðtÞ
ð9Þ
where hl and sl (fslg are positive integers in this paper) are the gain and the symbol
number of the propagation delay for the lth path and NL is the number of channel paths.
The function wðtÞ is complex-valued Additive White Gaussian Noise(AWGN) with
variance r2
w. Exploiting the Laurent decomposition of CPM signals, a discrete-time
expression of received signals can be written as:
rn ¼
X
NL1
l¼0
hlsnsl þ wn
ð10Þ
rn ,
Z
rðtÞp0ðt  nTÞdt
ð11Þ
sn ,
Z
sðtÞp0ðt  nTÞdt ¼
X
N1
m¼0
Z
p0ðt  mTÞp0ðt  nTÞdta0;m
ð12Þ
where wn is assumed to be independent identical distributed Gaussian sequence with
variance r2
n. As shown in [5], p0ðtÞ is the ﬁrst component of pulse amplitude modu-
lation (PAM) signals. The integral value of
R
p0ðt  mTÞp0ðt  nTÞdt varies with the
value of m  n
j
j which is maximum when m  n
j
j is zero and takes zero when m  n
j
j
is big enough. Based on this property, we can further simplify the expression (12):
sn 
X
n þ Lm
m¼nLm
Z
p0ðt  mTÞp0ðt  nTÞdta0;m ¼
X
n þ Lm
m¼nLm
p mn
j
ja0;m
ð13Þ
where Lm is an integer associated with M and L.
3
The Proposed Algorithm
Based on the signal model mentioned in Sect. 2, we derive the factor graph based
receiver of CPM signals in this section. Our goal is to restore the transmitted infor-
mation bits b from the received signals r. Generally, we use the Maximum a Posteriori
(MAP) strategy to estimate the information sequence:
bbi ¼ arg max
bi
p bijr
ð
Þ
ð14Þ
where bi denotes the i th information bit and p bijr
ð
Þ is the marginal probability mass
function of the joint posterior probability distribution pðbjrÞ. According to the Baye-
sian rule, pðbjrÞ can be expressed as:
496
J. Zhang et al.

pðbjrÞ / pðrjsÞpðsjaÞpðaj/Þpð/jaÞpðajcÞpðcjbÞpðbÞ
ð15Þ
where / denotes proportionality and c is the code bits. The element cq
n denotes the q th
information bit of the n th symbol an. Using (10) in Sect. 2, the conditional probability
pðrjsÞ can be factorized into:
p rjs
ð
Þ ¼
Y
n
fn rnjs
ð
Þ ¼
Y
n
exp

rn  P
NL1
l¼0
hlsnsl

2
r2
n
8
>
>
>
<
>
>
>
:
9
>
>
>
=
>
>
>
;
ð16Þ
in which n ¼ 0; 1; . . .; N  1 and we assumed the channel is already known to the
receiver – in other words, the hl and sl are already known. Similarly, we can get the
factorization of the conditional probabilities pðsjaÞ,pðaj/Þ and pð/jaÞ using Eqs. (13),
(7) and (8)
p sja
ð
Þ ¼
Y
n
gn sn; a
ð
Þ ¼
Y
n
d sn 
X
n þ Lm
m¼nLm
p mn
j
ja0;m
 
!
ð17Þ
p aj/
ð
Þ ¼
Y
n
In a0;n; /n


¼
Y
n
d a0;n  ejphðM1Þðn þ 1Þej2ph/n


ð18Þ
p /ja
ð
Þ ¼
Y
n
Jn an; /n; /n1
ð
Þ
ð19Þ
in which gnðÞ, InðÞ and JnðÞ are the indicator functions and fang are assumed to be
unipolar symbols, an 2 f0; 1; . . .; M  1g. The conditional probability pðajcÞ in (15)
can be factorized into
p ajc
ð
Þ ¼
Y
n
p anjcn
ð
Þ ¼
Y
n
d an  u cn
ð
Þ
ð
Þ
ð20Þ
where dðÞ is the Kronecker delta function and uðcnÞ is the mapping function and cn is
comprised of
cq
n; 8q
	

, q ¼ 0; 1; . . .; Q,Q ¼ log2 M  1.
According to the factorization (16)–(20), we can get the factor graph representation
of the receiver, as depicted in Fig. 1. In Fig. 1, fn denotes the channel transition
function fnðrnjsÞ, gn denotes the Laurent decomposition constraint gnðsn; aÞ, Mn
denotes the mapping constraint pðanjcnÞ,Pð/1Þ and Pð/N1Þ denotes the initial
probabilities of the variables /1 and /N1,Pð/1Þ ¼ Pð/N1Þ ¼ 1=p.
Given the factor graph representation, the marginals can be computed exactly by
message passing. Before study the detailed message computation, we introduce the rep-
resentation of messages that follows. The messages passing between the function nodes A
and variable nodes B of the ith iteration are denoted as li
A!BðBÞ and li
B!AðBÞ. For
example, the messages passing between the nodes ffng and fsng are denoted as li
fn!skðskÞ
and li
sn!ftðsnÞ respectively, k ¼ n  sl, t ¼ n þ sl, l ¼ 0; . . .; NL  1, n ¼ 0; . . .; N  1.
Low-Complexity Equalization of Continuous Phase Modulation
497

Firstly, we focus on the equalization part of the factor graph. By applying the
updating rules of the SPA in the factor graph, messages li
fn!skðskÞ and li
sn!ftðsnÞ can be
calculated by
li
sn!ftðsnÞ ¼
Y
t06¼t
li1
ft0!snðsnÞli
gn!snðsnÞ
ð21Þ
li
fn!skðskÞ ¼
Z
s!=sk
fnð s!Þ
Y
k06¼k
li
sk0!fnðsk0Þ:
ð22Þ
However,
a
direct
computation
of
Eqs. (21)
and
(22)
is
intractable
for
high-dimensional integral. Hence, we derive the reduced-complexity receiver based on
the Gaussian message passing method.
Considering the practical application scenarios, we can assume that sn is a con-
tinuous complex Gaussian random variable. According to the Eq. (10), wn is a
Gaussian variable, and then ðrn  PNL1
l¼0
hlsnslÞ is also a Gaussian variable. We can
reasonably assume that the messages li
fn!skðskÞ and li
sn!fmðsnÞ are approximated as
Gaussian density function:
li
sn!ftðsnÞ ¼ NCðsn; xi
sn!ft; vi
sn!ftÞ
ð23Þ
li
fn!skðskÞ ¼NCðhlsk; xi
fn!sk; vi
fn!skÞ
ð24Þ
where xi
sn!ft and vi
sn!ft respectively denote the mean and the variance of the variable sn
with respect to the message li
sn!ftðsnÞ, xi
fn!sk and vi
fn!sk denote the mean and the
variance of the variable hlsk with respect to the message li
fn!skðskÞ . According to
Fig. 1. Factor graph representation.
498
J. Zhang et al.

Eqs. (13) and (17), considering the linear relationship between variables sn and a0;n, we
can assume a0;n is a continuous complex Gaussian random variable too. According to
SPA, the messages passing between nodes sn and gn can be express as:
li
sn!gnðsnÞ ¼ NCðsn; xi
sn!gn; vi
sn!gnÞ
ð25Þ
li
gn!snðsnÞ ¼ NCðsn; xi
gn!sn; vi
gn!snÞ :
ð26Þ
Similarly, the messages passing between nodes a0;n and gn can be express as:
li
a0;n!gjða0;nÞ ¼ NCða0;n; xi
a0;n!gj; vi
a0;n!gjÞ
ð27Þ
li
gn!a0;mða0;mÞ ¼ NCðp mn
j
ja0;m; xi
gn!a0;m; vi
gn!a0;mÞ
ð28Þ
where n ¼ 0; . . .; N  1, n  Lm  j  n þ Lm, n  Lm  m  n þ Lm.
According to the properties of Gaussian distribution and the rules of SPA, the
means and the variances mentioned above can be exactly calculated as:
xi
fn!sk ¼ rn 
X
l06¼l
hl0xi
snsl0 !fn; vi
fn!sk ¼ r2
n þ
X
l06¼l
hl0
j
j2vi
snsl0 !fn
ð29Þ
vi
sn!ft ¼
1
ui
gn!sn
þ
X
l06¼l
hl0
j
j2
vi1
fn þ sl0 !sn
 
!1
; xi
sn!ft¼ vi
sn!ft
xi
gn!sn
vi
gn!sn
þ
X
l06¼l
hl0
j
jxi1
fn þ sl0 !sn
vi1
fn þ sl0 !sn
 
!
ð30Þ
vi
sn!gn ¼
X
l
hl
j j2
vi
fn þ sl!sn
 
!1
; xi
sn!gn ¼ vi
sn!gn
X
l
hlxi
fn þ sl!sn
vi
fn þ sl!sn
ð31Þ
xi
gn!sn ¼
X
n þ Lm
m¼nLm
p mn
j
jxi
a0;m!gn; vi
gn!sn ¼
X
n þ Lm
m¼nLm
p mn
j
j

2vi
a0;m!gn
ð32Þ
xi
gn!a0;m ¼ xi
sn!gn 
X
m06¼m
p m0n
j
jyi1
a0;m0!gn; vi
gn!a0;m ¼ vi
sn!gn þ
X
m06¼m
p m0n
j
j

2vi1
a0;m0!gn
ð33Þ
vi
a0;n!gj ¼
1
vi
In!a0;n
þ
X
j06¼j
p j0n
j
j

2
vi
gj0!a0;n
 
!1
; xi
a0;n!gj ¼ vi
a0;n!gj
xi
In!a0;n
vi
In!a0;n
þ
X
j06¼j
p j0n
j
jxi
gj0!a0;n
vi
gj0!a0;n
 
!
ð34Þ
where p mn
j
j ,
R
p0ðt  mTÞp0ðt  nTÞdt.
Low-Complexity Equalization of Continuous Phase Modulation
499

Next we study the demodulation part of the factor graph in Fig. 1. By applying the
rules of SPA continually, the message li
a0;n!Inða0;nÞ can be computed:
li
a0;n!Inða0;nÞ ¼
Y
j
li
gj!a0;nða0;nÞ:
ð35Þ
Considering the equations in (34), we can further compute the message
li
a0;n!Inða0;nÞ as:
vi
a0;n!In ¼
X
j
p jn
j
j

2
vi
gj!a0;n
 
!1
; xi
a0;n!In ¼ vi
a0;n!In
X
j
p jn
j
jxi
gj!a0;n
vi
gj!a0;n
 
!
ð36Þ
where xi
a0;n!In and vi
a0;n!In are the mean and the variance of the message li
a0;n!Inða0;nÞ.
Before computing the message li
/n!Inð/nÞ, we focus on the value of the variable
a0;n. According to the Eq. (7), a0;n is actually a discrete random variable with p values.
The probability distribution of a0;n can be calculated by
P#ða0;nÞ ¼
NCða0;n; xi
a0;n!In; vi
a0;n!InÞ
P
a0;n
NCða0;n; xi
a0;n!In; vi
a0;n!InÞ :
ð37Þ
By applying the updating rules of the SPA, messages with reference to the
demodulation part can be recursively computed as:
li
In!/nð/nÞ ¼
X
a0;n
Inða0;n; /nÞli
a0;n!Inða0;nÞ
ð38Þ
li
/n!Inð/nÞ ¼ li
Jn!/nð/nÞli
Jn þ 1!/nð/nÞ
ð39Þ
li
In!a0;nða0;nÞ ¼
X
/n
Inða0;n; /nÞli
/n!Inð/nÞ
ð40Þ
li
Jn!/nð/nÞ ¼
X
an
X
/n1
Jnðan; /n; /n1Þli1
an!JnðanÞli
/n1!Jnð/n1Þ
ð41Þ
li
/n!Jn þ 1ð/nÞ ¼ li
Jn!/nð/nÞli
In!/nð/nÞ
ð42Þ
li
Jn!/n1ð/n1Þ ¼
X
an
X
/n
Jnðan; /n; /n1Þli1
an!JnðanÞli
/n!Jnð/nÞ
ð43Þ
li
/n!Jnð/nÞ ¼ li
Jn þ 1!/nð/nÞli
In!/nð/nÞ
ð44Þ
li
Jn!anðanÞ ¼
X
/n
X
/n1
Jnðan; /n; /n1Þli
/n!Jnð/nÞli
/n1!Jnð/n1Þ
ð45Þ
500
J. Zhang et al.

In Eqs. (41) and (44), the messages li
/n1!Jnð/n1Þ and li
Jn þ 1!/nð/nÞ have the
following initial conditions:
li
/1!J0ð/1Þ ¼ li
JN!/N1ð/N1Þ ¼ 1=p:
ð46Þ
In Eq. (38), the message li
In!/nð/nÞ is a discrete probability distribution function
about the variable /n and can be computed just like the means in Eq. (37). As for the
message li
In!a0;nða0;nÞ in Eq. (40), it can be approximated as Gaussian density function
and can be computed using the message li
/n!Inð/nÞ:
li
In!a0;nða0;nÞ ¼ NCða0;n; xi
In!a0;n; vi
In!a0;nÞ
ð47Þ
P"ða0;nÞ ¼ Pð/nÞ ¼ li
/n!Inð/nÞ
ð48Þ
xi
In!a0;n ¼ EP"ða0;nÞ½a0;n; vi
In!a0;n ¼ EP"ða0;nÞ½ a0;n

2  xi
In!a0;n


2
:
ð49Þ
Finally,
we
focus
on
the
decoder
part
of
the
factor
graph
in
Fig. 1.
A soft-input-soft-output (SISO) decoder is used to implement the turbo iteration with
the demodulation part. According to the rules of SPA, the message li
an!MnðanÞ can be
updated by
li
an!MnðanÞ ¼ li
Jn!anðanÞ:
ð50Þ
Using the message li
an!MnðanÞ in Eq. (50) and the a priori logarithm likelihood
ratios (LLRs)
ki1
a ðcq
nÞ; 8q
	

fed back from the SISO decoder at previous turbo iter-
ation, the extrinsic LLRs
ki
eðcq
nÞ; 8q
	

which are the input of the SISO decoder can be
obtained as follows:
ki
eðcq
nÞ ¼ ln
P
an2A1q li
an!MnðanÞ
P
an2A0q li
an!MnðanÞ  ki1
a ðcq
nÞ:
ð51Þ
Once the extrinsic LLRs
ki
eðcq
nÞ; 8q
	

are available, the decoder performs decoding
and feeds back the a priori logarithm likelihood ratios (LLRs)
ki
aðcq
nÞ; 8q
	

which can
be used to compute the message li
Mn!anðanÞ.
b an
ð
Þ ¼
Y
q
exp cq
nki
a cq
n


	

1 þ exp cq
nki
a cq
n
ð
Þ
	

ð52Þ
li
Mn!anðanÞ ¼
b an
ð
Þ
P
an
b an
ð
Þ :
ð53Þ
Low-Complexity Equalization of Continuous Phase Modulation
501

In Eq. (53), li
Mn!anðanÞ is a discrete probability distribution function about the
discrete random variable an. By applying the updating rules of SPA, the message
li
an!JnðanÞ can be expressed as:
li
an!JnðanÞ ¼ li
Mn!anðanÞ:
ð54Þ
In summary, the messages passing in one turbo iteration are exactly derived as the
equations in this section shown. Because of the factor graph in Fig. 1 is loopy, we
consider a message passing form the bottom to the top and then back again as one turbo
iteration. At the beginning of the ﬁrst turbo iteration, we set l0
/n!Inð/nÞ ¼ 1=p, 8n,
k0
aðcq
nÞ ¼ 0, 8q, 8n.
4
Simulation Results
In this section, we present the simulation results for the proposed algorithm. The
performance of the proposed algorithm is assessed in terms of bit error rate
(BER) versus Eb=N0. For each considered channel, we compare the proposed algorithm
with the conditional receiver of the CPM signals which uses the minimum mean
squared error (MMSE) frequency domain equalization (FDE) and the optimal BCJR
demodulator. In both receivers, we consider the 1=2  rate convolutional code with
generators G1 ¼ 91 and G2 ¼ 121 (octal notation) and the encoding length is 1024.
In Fig. 2, we consider a relatively simple scenario, AWGN channel, to verify the
performance of the algorithm proposed in Sect. 3. A binary CPM signal with frequency
pulse of duration L ¼ 1 symbol interval and the modulation index h ¼ 1=2 is
Fig. 2. 1RC modulation with h = 1/2 and M = 2 for AWGN channel.
502
J. Zhang et al.

considered. When using the proposed algorithm, we set the parameters as follows
NL ¼ 1 and Lm ¼ 1. As shown in Fig. 2, we compare the BER performance of the
proposed algorithm and the BCJR method with and without the convolutional code
respectively. The performance of the two algorithms is similar in the scenario without
the convolutional code. When we consider the convolutional code in both systems, the
performance of the proposed algorithm using the turbo iteration is better than the BCJR
demodulation.
In Fig. 3, we consider an ISI channel (channel I) characterized by NL ¼ 2 and
h ¼ ½0:8165 0:5773; s ¼ ½0 20
ð55Þ
in which the vector h denotes the gain of each path of the channel and the vector s
denotes the symbol number of the propagation delay for each path of the channel.
A quaternary CPM signal with frequency pulse of duration L ¼ 1 symbol interval and
the modulation index h ¼ 1=4 is considered. We set the parameters of the proposed
algorithm NL ¼ 2 and Lm ¼ 2. The length of FFT in the MMSE-FDE method is 1024.
In this scenario, the receiver with the MMSE-FDE and the BCJR demodulator and the
receiver using the proposed algorithm are considered. Similar to Fig. 2, we compare
the BER performance of the two methods with and without the convolutional code
respectively. As shown in Fig. 3, the performance of the two methods is similar
without the convolutional code. When take the convolutional code into account, the
performance of the proposed algorithm is better than the MMSE-FDE-BCJR receiver.
Fig. 3. 1RC modulation with h = 1/4 and M = 4 for Channel I
Low-Complexity Equalization of Continuous Phase Modulation
503

In Fig. 4, we consider an ISI channel (channel II) characterized by NL ¼ 5 and
h ¼ ½0:7 0:2 0:05 0:03 0:02; s ¼ ½0 5 10 15 20
ð56Þ
where the vector h denotes the gain of each path of the channel and the vector s denotes
the symbol number of the propagation delay for each path of the channel. A quaternary
CPM signal with frequency pulse of duration L ¼ 1 symbol interval and the modu-
lation index h ¼ 1=4 is considered. The parameters of the proposed algorithm are set as
NL ¼ 5, Lm ¼ 2. As shown in Fig. 4, the performance of the two methods is similar
without the convolutional code. And the performance of the proposed algorithm is
better than the MMSE-BCJR receiver with the convolutional code.
In terms of computational complexity, we point out that the decode parts in both
receivers is the same. They differ in the equalization part and the demodulation
part. For the equalization part, the computational complexity of the MMSE-FDE is
OðN log2 NÞ and that of the proposed algorithm is OðNNLÞ which is associated with the
number of the path of the channel. For the demodulation part, the computational
complexity of the BCJR algorithm is OðpMLNÞ while that of the proposed algorithm is
OðpðN þ 1ÞÞ.
5
Conclusion
Based on the Laurent decomposition and the Gaussian message passing, we presented a
low-complexity turbo iterative receiver of CPM signals. According the simulations of
different scenarios as shown in Sect. 4, the performance of the proposed algorithm is
similar to the receiver with the MMSE-FDE and the BCJR demodulator in uncoded
systems. When take the coding module into account, the proposed algorithm can
achieve better performance. Moreover, the proposed algorithm has lower computa-
tional complexity than the receiver with the MMSE-FDE and the BCJR demodulator.
Fig. 4. 1RC modulation with h = 1/4 and M = 4 for Channel II.
504
J. Zhang et al.

Acknowledgments. This work was supported by the National Natural Science Foundation of
China under Grant Nos. 91438206.
References
1. Anderson, J.B., Aulin, T., Sundberg, C.E.: Digital Phase Modulation. Springer Science &
Business Media, New York (2013). https://doi.org/10.1007/978-1-4899-2031-7
2. Rimoldi, B.E.: A decomposition approach to CPM. IEEE Trans. Inf. Theory 34(2), 260–270
(1988)
3. Tang, W., Shwedyk, E.: A quasi-optimum receiver for continuous phase modulation. IEEE
Trans. Commun. 48(7), 1087–1090 (2000)
4. Laurent, P.: Exact and approximate construction of digital phase modulations by
superposition of amplitude modulated pulses (AMP). IEEE Trans. Commun. 34(2),
150–160 (2003)
5. Mengali, U., Morelli, M.: Decomposition of M-ary CPM signals into PAM waveforms.
IEEE Trans. Inf. Theory 41(5), 1265–1275 (1995)
6. Colavolpe, G., Raheli, R.: Reduced-complexity detection and phase synchronization of CPM
signals. IEEE Trans. Commun. 45(9), 1070–1079 (1997)
7. Tan, J., Stuber, G.L.: Frequency-domain equalization for continuous phase modulation.
IEEE Trans. Wireless Commun. 4(5), 2479–2490 (2005)
8. Pancaldi, F., Vitetta, G.M.: Equalization algorithms in the frequency domain for continuous
phase modulations. IEEE Trans. Commun. 54(4), 648–658 (2006)
9. Ozgul, B., Koca, M., Deliç, H.: Double turbo equalization of continuous phase modulation
with frequency domain processing. IEEE Trans. Commun. 57(2), 423–429 (2009)
10. Guo, Q., Huang, D.: GMP-based channel estimation for single-carrier transmissions over
doubly selective channels. IEEE Sig. Process. Lett. 17(1), 8–11 (2010)
11. Wu, S., Kuang, L., Ni, Z., Lu, J., Huang, D., Guo, Q.: Low-complexity iterative detection for
large-scale
multiuser
MIMO-OFDM
systems
using
approximate
message
passing.
IEEE J. Sel. Top. Sig. Process. 8(5), 902–915 (2014)
12. Wu, S., Kuang, L., Ni, Z., Huang, D., Guo, Q., Lu, J.: Message-passing receiver for joint
channel estimation and decoding in 3D massive MIMO-OFDM systems. IEEE Trans. Wirel.
Commun. 15(12), 8122–8138 (2016)
13. Wu, S., Kuang, L., Ni, Z.: Expectation propagation based iterative group wise detection for
large-scale multiuser MIMO-OFDM systems. In: 2014 IEEE Wireless Communications and
Networking Conference (WCNC) (2014)
14. Barbieri, A., Colavolpe, G.: Simpliﬁed soft-output detection of CPM signals over coherent
and phase noise channels. IEEE Trans. Wirel. Commun. 6(7), 2486–2496 (2007)
Low-Complexity Equalization of Continuous Phase Modulation
505

Range-Diﬀerence Based Resource Allocation
Scheme for D2D-Aided Heterogeneous Networks
Shaobo Lv1, Xianxian Wang1, Hongwen Cheng2, and Zhongshan Zhang1(B)
1 Beijing Engineering and Technology Research Center for Convergence Networks
and Ubiquitous Services, University of Science and Technology Beijing (USTB),
Beijing, China
zhangzs@ustb.edu.cn
2 China Unicom, Huangshan Branch, Huangshan Road 170, Tunxi District,
Huangshan City, Anhui Province, China
Abstract. In this paper, the resource allocation issues in Device-to-
Device (D2D) aided heterogeneous networks are investigated, with suc-
cessive interference cancellation (SIC) capabilities enabled in base sta-
tions (BSs). The problem of maximizing the sum throughput of whole
network by considering real-time transmissions is formulated. After that,
the globally optimal power control is carried out relying on both the enu-
meration and Kuhn-Munkres methods. To both guarantee the success-
ful transmission probability (STP) of cellular users (CUEs) and reduce
the system’s management overhead, a range-diﬀerence based resource
allocation scheme is proposed. Numerical results show that the average
throughput of CUEs can be substantially improved without sacriﬁcing
the performance of CUEs by invoking the proposed resource allocation
scheme.
Keywords: Heterogeneous network · Device-to-Device (D2D)
Resource allocation · Successive Interference Cancellation (SIC)
Range-diﬀerence
1
Introduction
With the rapid development of mobile communication technologies, the telecom
operators are struggling to meet the customers’ exponentially increasing demand
of mobile data traﬃc, thus requiring both spectral eﬃciency and throughput
of the wireless networks to be substantially improved [1–3]. Furthermore, the
existing wireless access networks (WANs) architecture is based on the centralized
control of base stations (BSs), which have often been operating at overload state,
it is highly required to oﬄoad the mobile traﬃcs from the BS side to the mobile
terminal side [4,5].
Device-to-Device (D2D) communications mode, which enables the geograph-
ically close-by user equipments (UEs) to form D2D pairs by creating a direct
wireless link between them (i.e. without relying on the intervention of BSs),
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 506–516, 2018.
https://doi.org/10.1007/978-3-319-72823-0_47

Range-Diﬀerence Based Resource Allocation Scheme
507
has been regarded as a promising traﬃc-oﬄoading technique [6,7]. Note that
either half-duplex mode or full-duplex [8–10] mode can be implemented in D2D
devices. Meanwhile, in light of the fact that the negative eﬀect of large-scale
power loss due to the relatively longer BS-to-UE distance in conventional cellular
networks can be eﬀectively relieved by implementing D2D mode, the power eﬃ-
ciency as well as spectral eﬃciency of the wireless networks can be substantially
improved [11]. Thus, the underlaying cellular networks that support both the
conventional cellular communications and the D2D mode can be implemented
for both substantially improving the network throughput and eﬀectively enhanc-
ing the load balance capability of the whole networks.
Despite of the promising beneﬁts in terms of spectral/power eﬃciencies
oﬀered by D2D-aided heterogeneous networks, the potential performance gains
may still be degraded due to the frequency reuse between these two tiers. Thus,
a reasonable resource allocation strategy must be implemented for eﬀectively
mitigating the impact of D2D induced interference [12].
A variety of works associated with intelligent power control and resource allo-
cation strategies have been carried out for facilitating the D2D-induced interfer-
ence coordination and management [13–16]. For instance, in [13], a pricing-based
mechanism is proposed for managing the interference imposed on the cellular
users (CUEs) by D2D users (DUEs) through controlling the prices on the cor-
responding sub-channels. Combining with a non-cooperative Nash game among
D2D pairs, the quality of service (QoS) of both CUEs and DUEs can be guaran-
teed in the pricing-based mechanism. Furthermore, in [16], a centralized power
control strategy is proposed to guarantee a suﬃciently high coverage probability
of CUEs by limiting the D2D-induced interference (while scheduling as many
D2D links as possible). In addition, advanced signal processing techniques can
also be employed for performing interference cancellation in D2D-aided heteroge-
neous networks [17,18]. Relying on the successive interference cancellation (SIC)
capabilities [19,20] of both BSs and DUEs, authors in [18] attempted to adjust
both transmit power and data rate for managing the interference between cel-
lular and D2D tiers, whereas the authors in [17] mainly analyzed the successful
transmission probability (STP) of the multi-cell networks by using stochastic
geometry method.
While most of the existing resource allocation algorithms are carried out
by solving complicated optimization or game problems, both of which gener-
ally require accurate channel state information (CSI), the system’s manage-
ment overhead will thus be signiﬁcantly increased. Besides the above-mentioned
algorithms, guard zone based interference management schemes have also been
widely investigated [21,22] for oﬀering innovated resource allocation strategies.
In this paper, we mainly focus our attention on maximizing the (real-time) sum
throughput, with a range-diﬀerence based scheme proposed for the D2D-aided
heterogeneous networks. The main contributions of this paper are reﬂected in
the following aspects:
1. The resource allocation problem for D2D-aided underlaying cellular networks
is formulated, with SIC capabilities considered in terminals.

508
S. Lv et al.
2. The optimization model of maximizing the (real-time) sum throughput of the
whole network is provided.
3. The globally optimal solution of the proposed algorithm is derived relying on
the enumeration and Kuhn-Munkres methods.
4. A range-diﬀerence based resource allocation scheme is proposed for simul-
taneously improving the average STP of CUEs and reducing the system’s
management overhead.
The remainder of this paper is organized as follows. Section 2 describes the
system model for D2D-aided heterogeneous networks, together with the for-
mulation of the problem of sum throughput maximization. In Sect. 3, a range-
diﬀerence based resources allocation scheme is proposed. After that, the numer-
ical results are given out in Sect. 4. Finally, Sect. 5 concludes this paper.
2
System Model and Problem Formulation
In this section, we ﬁrst describe the system model for the proposed D2D aided
heterogeneous networks, followed by formulating the resource allocation problem
of the proposed system, with SIC capabilities enabled in the devices. After that,
we derive the globally optimal solution of the above-mentioned optimization
problem relying on the enumeration and Kuhn-Munkres methods.
Fig. 1. D2D aided heterogeneous network, in which the uplink licensed spectrum is
assumed to be reused by DUEs.

Range-Diﬀerence Based Resource Allocation Scheme
509
2.1
System Model for D2D-Aided Heterogeneous Networks
In this paper, we consider the D2D-aided underlaying cellular networks, in which
the uplink licensed spectrum is allowed to be reused by D2D pairs, as illustrated
in Fig. 1. To ease our analysis, we consider the scenario in which a total of
N CUEs share spectrum resources with N D2D pairs simultaneously. Mean-
while, we assume that the i-th CUE operates at transmit power P c
i , where
i ∈{1, 2, · · · , N}. Without loss of generality, the transmit power of j-th DT
is assumed to be P d
j = βi,jP c
i , where the coeﬃcient βi,j is no less than 0 for
any i, j ∈{1, 2, · · · , N}. Furthermore, the radius of the cell is denoted by R.
Distances associated with the i-th CUE-to-BS link and the j-th DT-to-BS link
are represented by ri,b and rj,b, respectively. Meanwhile, the distance between
i-th CUE and j-th D2D receiver (DR) is denoted by ri,j. Similarly, rjj denotes
the distance between the peers of the j-th D2D pair. In addition, both CUEs and
DTs are assumed to be distributed randomly and uniformly within the cellular
coverage, with DRs uniformly located within the radius-50 m circle area that is
centered by the corresponding DTs.
At the BS side, the received signal power from CUE and DT can be denoted
by P c
i,b = hi,br−α
i,b P c
i and P d
j,b = hj,br−α
j,b P d
i , respectively, under assumption of
Rayleigh fading channels with small scale fading coeﬃcients hi,b, hj,b ∼exp(1),
where hi,b and hj,b denote the corresponding channel attenuations, and α >
2 denotes the path-loss exponent. According to the aforementioned uniform-
distribution properties of both CUEs and DTs, the probability density function
(pdf) of ri,b and rj,b can be represented by f(ri,b) = 2ri,b/R2 and f(rj,b) =
2rj,b/R2, respectively. Furthermore, through sample variable substitutions, we
can readily derive both P c
i,b ∼exp(rα
i,b/P c
i ) and P d
j,b ∼exp(rα
j,b/βi,j/P c
i ).
2.2
Problem Formulation
In this paper, we aim to maximize the network’s sum throughput relying an
appropriately designed resource allocation algorithm as
P1: max

i∈C,j∈D
αi,jRi,j
(1)
s.t.

i∈C
αi,j = 1,
(1a)

j∈D
αi,j = 1,
(1b)
αi,j = {0, 1},
∀i ∈C, j ∈D,
(1c)
where C and D denote the index sets of CUEs and D2D paris, respectively,
Ri,j is the aggregative rates of i-th CUE (i.e. Rc
i) and j-th D2D pairs (i.e. Rd
j),

510
S. Lv et al.
i.e. Ri,j = Rc
i + Rd
j, αi,j denotes the resource sharing relationship between i-th
CUE and j-th D2D pair, and αi,j = 1 when the i-th CUE and j-th D2D pair
share the same spectrum resource (otherwise αi,j = 0). On one hand, constraints
in (1a) and (1b) guarantee the one-to-one correspondence between CUEs and
D2D pairs, requiring that any single D2D pair must reuse the spectrum of one
and only one CUE. On the other hand, any individual CUE must coexist with
one and only one D2D pair. We can readily show that P1 is identical to a
maximum weighted bipartite matching problem that can be faultlessly solved
out via Kuhn-Munkres method [23], where CUE and D2D pair are the bipartite
vertexes, Ri,j stands for the weight.
In the following, we will focus on mitigating the D2D-induced interference,
thus enhancing the sum throughput of the network. Without loss of generality,
we assume that the BSs are capable of implementing SIC. From information
theory, the desired signal from CUE in the SIC-enabled BS receiver side will
not be deteriorated by the DT-induced interference, and consequently we have
Rc
i = log2

1 + P c
i gi,b
ΓN0

if Rd
j ≤log2

1 +
P d
j gj,b
Γ (P c
i gi,b + N0)

can be satisﬁed1.
Otherwise, the interference caused by DT cannot be totally eliminated, thus
leading to Rc
i = log2

1 +
P c
i gi,b
Γ

P d
j gj,b + N0


, where Γ denotes the signal-to-
interference-plus-noise ratio (SINR) gap [24] that is set to be Γ = 8.8 dB in this
paper. The problem of Ri,j-maximization can thus be rewritten as
P2: max Rc
i + Rd
j
(2)
s.t.
Rc
i = A log2

1 +
P c
i gi,b
Γ

P d
j gj,b + N0


(2a)
+ (1 −A) log2

1 + P c
i gi,b
ΓN0

,
Rd
j = log2

1 +
P d
j gj,j
Γ (P c
i gi,j + N0)

,
(2b)
A = 1
	
Rd
j > log2

1 +
P d
j gj,b
Γ (P c
i gi,b + N0)

,
(2c)
P th
c
≤P c
i ≤P max
c
,
(2d)
1 In other words, the transmission rate of DT is not beyond its channel capacity,
therefore the interference caused by DT can be cancelled completely in theory.

Range-Diﬀerence Based Resource Allocation Scheme
511
P th
d
≤P d
j ≤P max
d
,
(2e)
where (P th
c , P max
c
) and (P th
d , P max
d
) are the minimum and maximum values of
transmit power of CUE and DT, respectively. Denoting f

P c
i , P d
j

= Ri,j =
Rc
i+Rd
j, it has been shown in [25], f(λP c
i , λP d
j ) > f(P c
i , P d
j ) will always hold that
in the interior of the feasible space when λ > 1. Thus, f(P c
i , P d
j ) would reach its
maximum if either of the following conditions, i.e. P c
i = P max
c
and P d
j = P max
d
,
can be satisﬁed. Furthermore, it has also been proved in [25] that f

P c
i , P d
j

would be a convex function of P c
i (or P d
j ) if P d
j = P max
d
(or P c
i = P max
c
) is
satisﬁed. Evidently, the maximum of f

P c
i , P d
j

must be reachable at one of the
extreme points of the feasible space.
By substituting (2b) into (2c), we can readily derive that A = 0 if
gj,j
P c
i gi,j + N0
≤
gj,b
P c
i gi,b + N0
(3)
is satisﬁed. Otherwise, we have A = 1 when
gj,j
P c
i gi,j + N0
>
gj,b
P c
i gi,b + N0
.
(4)
If A = 0 is met, we can readily conclude that the extreme points of P c
i (denoted
by P c
i,0) are just happened at the apexes of the intersection of (2d) and (3).
Similarly, when A = 1 is met, we can obtain the extreme points P c
i,1, which
correspond to the apexes of the intersection of (2d) and (4). In addition, we
will get the optimal solution of problem P2 relying on the enumeration method,
with the optimal power pair (P c∗
i , P d∗
j ) represented by
(P c∗
i , P d∗
j ) =
arg max
(P c
i ,P d
j )∈U0∪U1∪U
Ri,j,
(5)
where U0 = (P c
i ∈P c
i,0, P max
d
), U1 = (P c
i ∈P c
i,1, P max
d
), and U = (P max
c
, P th
d ) ∪
(P max
c
, P max
d
).
Following the above-mentioned derivations, we can always derive the maxi-
mum Ri,j for any i ∈C and j ∈D settings, which will be saved as the weight
of the edges between bipartite vertexes C and D. Eventually, the maximum sum
throughput can be obtained.
3
Range-Diﬀerence Based Resource Allocation
In this section, a heuristic range-diﬀerence based resource allocation strategy
is proposed for reducing the system complexity. At the SIC-enabled BS side,
the desired signal from CUE will be decoded correctly, if P c
i,b > P d
j,b is satisﬁed.
Otherwise, if P d
j,b > P c
i,b is met, the signal of interfering DT will be ﬁrstly decoded
and eliminated from the received superposition signal, followed by decoding the

512
S. Lv et al.
CUE’s message from the interference-free signal. For a given decoding threshold
η, the CUE’s STP as a function of (η, ri,b, rj,b) can be expressed as
PSTP(η, ri,b, rj,b) = Pr

P c
i,b
N0
≥η,
P d
j,b
P c
i,b + N0
≥η, P d
j,b > P c
i,b

+ Pr

P c
i,b
P d
j,b + N0
≥η, P c
i,b ≥P d
j,b

.
(6)
It has been shown in [21] that PSIC (η, ri,b, rj,b)
=
Pr

P d
j,b > P c
i,b

+
Pr

P d
j,b ≤P c
i,b

= 1 will be met in interference-limited networks (i.e. N0 →0),
if η < 1 is satisﬁed. Otherwise, when η ≥1, PSIC (η, ri,b, rj,b) is shown to be a
convex function of rj,b, with its minimum value attainable at rj,b = ri,bβ1/α
i,j .
As inspired by the aforementioned results, we should try to prevent CUE
and D2D pair with special properties (i.e. rj,b ≊ri,bβ1/α
i,j ) from sharing the same
spectrum, when we perform resource allocation. Heuristically speaking, we aim
to maximize the distance between CUEs and DTs, thus proposing the range-
diﬀerence based resource allocation optimization model as
P3: max

i∈C,j∈D
αi,jdi,j
(7)
s.t.(2a) −(2c),
P c
i = P max
c
,
(7a)
P d
j = βP c
i = P max
d
,
(7b)
where di,j = |rj,b −ri,bβ1/α|. Similarly, P3 can also be viewed as a maximum
weighted bipartite matching problem, which can be successfully solved by using
Kuhn-Munkres algorithm. Compared with the power control strategy in P1,
scheme in P3 does not require accurate channel state information (CSI) and has
ah lower computational complexity.
4
Numerical Results
In this section, we will numerically validate the proposed analysis as well as evalu-
ate the performance of the proposed scheme. We consider the scenario comprising
100 geographically randomly and uniformly distributed CUEs that coexist with
100 D2D pairs inside a single-cell coverage having a radius of 500 m. The distri-
butions of both DTs and DRs are shown in Sect. 2. Furthermore, the maximum
distance between a D2D pair is assumed to be 100 m. The path loss exponent α
is set to be 4, with rayleigh fading channels assumed in each link. Meanwhile, the
SINR gap is set to 8.8 dB. In addition, the maximum transmit powers of CUEs
and DTs are assumed to be P max
c
= 30 dBm and P max
d
= 21 dBm, respectively,

Range-Diﬀerence Based Resource Allocation Scheme
513
corresponding to twice the minimum transmit powers, i.e. P th
c
= 1/2P max
c
and
P th
d
= 1/2P max
d
. Finally, the noise power density is assumed to be −174 dBm/Hz.
In Fig. 2, the CUE’s STP as a function of rj,b is evaluated under variant
ri,b and decoding thresholds η. For a given set of parameters, the CUE’s STP
will ﬁrst decrease and then increase as rj,b increases, implying that there always
exists an attainable minimum value.
Fig. 2. Successful transmission probability of CUE as a function of the distance between
DT and BS rj,b under variant CUE-to-BS distances ri,b and decoding thresholds η.
Fig. 3. Performance comparisons of the proposed scheme and scheme with power con-
trol in terms of CDF of the average aggregative throughput of a single CUE and/or
D2D pair.

514
S. Lv et al.
In Fig. 3, the cumulative distribution function (CDF) of the average aggrega-
tive throughput of one CUE/D2D pair is evaluated. As a performance bench-
mark, numerical results associated with scheme using power control are also pro-
vided. It is obvious that the maximum possible throughput of the two schemes
are reasonably identical. Furthermore, it is shown that the sum throughput of the
proposed scheme is slightly lower than that using power control aided scheme.
In Fig. 4, the CDF of the average throughput of CUE is evaluated. For com-
paring and analyzing the impact of the proposed scheme, numerical results asso-
ciated with the scheme using power control are also presented. It is observed
that the CUE’s average throughput will be improved by using the proposed
scheme, since the range-diﬀerence based technique will successfully prevent the
geographically speciﬁc UEs from sharing the same spectrum, thus guaranteeing
the QoS of CUEs.
Fig. 4. Performance comparisons of the proposed scheme and scheme with power con-
trol in terms of CDF of the average throughput of CUE.
5
Conclusion
In this paper, a range-diﬀerence based resource allocation scheme was proposed
for D2D-aided heterogeneous networks. We ﬁrst formulated the resource allo-
cation problem by enabling the SIC capabilities in terminals. After that, the
system model associated with maximizing the sum throughput was provided,
followed by deriving the globally optimal solution relying on the enumeration
and Kuhn-Munkres methods. Furthermore, by analyzing the impacting factors
of CUEs’ STP, a range-diﬀerence based resource allocation scheme was proposed
for both guaranteeing the QoS of CUEs and reducing the system’s management
overhead. Numerical results validated the proposed analysis, showing that the

Range-Diﬀerence Based Resource Allocation Scheme
515
average throughput of CUEs can be substantially improved by invoking the pro-
posed range-diﬀerence based resource allocation scheme.
Acknowledgement. This work was supported by the key project of the National Nat-
ural Science Foundation of China (No. 61431001), the open research fund of National
Mobile Communications Research Laboratory Southeast University (No. 2017D02),
Key Laboratory of Cognitive Radio and Information Processing, Ministry of Educa-
tion (Guilin University of Electronic Technology), and the Foundation of Beijing Engi-
neering and Technology Center for Convergence Networks and Ubiquitous Services.
(Corresponding author: Zhongshan Zhang).
References
1. Chen, S., Zhao, J.: The requirements, challenges, and technologies for 5G of ter-
restrial mobile telecommunication. IEEE Commun. Mag. 52(5), 36–43 (2014)
2. Zhang, Z., Long, K., Wang, J., Dressler, F.: On swarm intelligence inspired self-
organized networking: its bionic mechanisms, designing principles and optimization
approaches. IEEE Commun. Surv. Tuts. 16(1), 513–537 (2014). First Quarter
3. Zhang, Z., Long, K., Wang, J.: Self-organization paradigms and optimization
approaches for cognitive radio technologies: a survey. IEEE Wirel. Commun. Mag.
20(2), 36–42 (2013)
4. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allo-
cation in spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE
Trans. Commun. 62(7), 2366–2377 (2014)
5. Zhang, H., Jiang, C., Mao, X., Chen, H.-H.: Interference-limited resource optimiza-
tion in cognitive femtocells with fairness and imperfect spectrum sensing. IEEE
Trans. Veh. Technol 65(3), 1761–1771 (2016)
6. Doppler, K., Rinne, M., Wijting, C., Ribeiro, C.B., Hugl, K.: Device-to-device
communication as an underlay to LTE-advanced networks. IEEE Commun. Mag.
47(12), 42–49 (2009)
7. Feng, D., Lu, L., Yuan-Wu, Y., Li, G., Li, S., Feng, G.: Device-to-device commu-
nications in cellular networks. IEEE Commun. Mag. 52(4), 49–55 (2014)
8. Zhang, Z., Chai, X., Long, K., Vasilakos, A.V., Hanzo, L.: Full duplex techniques
for 5G networks: self-interference cancellation, protocol design, and relay selection.
IEEE Commun. Mag. 53(5), 128–137 (2015)
9. Zhang, Z., Long, K., Vasilakos, A.V., Hanzo, L.: Full-duplex wireless communi-
cations: challenges, solutions and future research directions. Proc. IEEE 104(7),
1369–1409 (2016)
10. Chai, X., Liu, T., Xing, C., Xiao, H., Zhang, Z.: Throughput improvement in cellu-
lar networks via full-duplex based device-to-device communications. IEEE Access
4, 7645–7657 (2016)
11. Asadi, A., Wang, Q., Mancuso, V.: A survey on device-to-device communication
in cellular networks. IEEE Commun. Surv. Tuts. 16(4), 1801–1819 (2014)
12. Phunchongharn, P., Hossain, E., Kim, D.I.: Resource allocation for device-to-
device communications underlaying LTE-advanced networks. IEEE Wirel. Com-
mun. 20(4), 91–100 (2013)
13. Yin, R., Yu, G., Zhang, H., Zhang, Z., Li, G.Y.: Pricing-based interference coordi-
nation for D2D communications in cellular networks. IEEE Trans. Wirel. Commun.
14(3), 1519–1532 (2015)

516
S. Lv et al.
14. Yin, R., Zhong, C., Yu, G., Zhang, Z., Wong, K.K., Chen, X.: Joint spectrum and
power allocation for D2D communications underlaying cellular networks. IEEE
Trans. Veh. Technol. 65(4), 2182–2195 (2016)
15. Sun, J., Liu, T., Wang, X., Xing, C., Xiao, H., Vasilakos, A.V., Zhang, Z.: Optimal
mode selection with uplink data rate maximization for D2D-aided underlaying
cellular networks. IEEE Access 4, 8844–8856 (2016)
16. Lee, N., Lin, X., Andrews, J.G., Heath, R.: Power control for D2D underlaid cellular
networks: modeling, algorithms, and analysis. IEEE J. Sel. Areas Commun. 33(1),
1–13 (2015)
17. Ma, C., Wu, W., Cui, Y., Wang, X.: On the performance of successive interfer-
ence cancellation in D2D-enabled cellular networks. In: 2015 IEEE Conference on
Computer Communications (INFOCOM), pp. 37–45, April 2015
18. Song, H., Ryu, J.Y., Choi, W., Schober, R.: Joint power and rate control for
device-to-device communications in cellular systems. IEEE Trans. Wirel. Com-
mun. 14(10), 5750–5762 (2015)
19. Saito, Y., Kishiyama, Y., Benjebbour, A., Nakamura, T., Li, A., Higuchi, K.: Non-
orthogonal multiple access (NOMA) for cellular future radio access. In: Proceedings
of IEEE Vehicular Technology Conference (VTC Spring), pp. 1–5, June 2013
20. Sen, S., Santhapuri, N., Choudhury, R.R., Nelakuditi, S.: Successive interference
cancellation: carving out MAC layer opportunities. IEEE Trans. Mob. Comput.
12(2), 346–357 (2013)
21. Lv, S., Xing, C., Zhang, Z., Long, K.: Guard zone based interference management
for D2D-aided underlaying cellular networks. IEEE Trans. Veh. Technol. 66(6),
5466–5471 (2016)
22. Chen, Z., Kountouris, M.: Guard zone based D2D underlaid cellular networks with
two-tier dependence. In: IEEE International Conference on Communication Work-
shop (ICCW), pp. 222–227 (2015)
23. Kuhn, H.W.: The Hungarian method for the assignment problem. Naval Res. Logis-
tics Q. 2(1–2), 83–97 (1955)
24. Garcia-Armada, A.: SNR gap approximation for M-PSK-based bit loading. IEEE
Trans. Wirel. Commun. 5(1), 57–60 (2006)
25. Gjendemsjo, A., Gesbert, D., Oien, G.E., Kiani, S.G.: Optimal power allocation
and scheduling for two-cell capacity maximization. In: Proceedings of 2006 IEEE
International Symposium on Modeling and Optimization in Mobile, Ad Hoc and
Wireless Networks, pp. 1–6 (2006)

LTE-WLAN Integrated Virtualization
Network Architecture
Fenglin Dai(B), Qixun Zhang, Yuhang Sun, and Mengyuan Liu
Beijing University of Posts and Telecommunications, Beijing 100876,
People’s Republic of China
{dfl2011212800,zhangqixun,SunYuhang613,lmy19931117}@bupt.edu.cn
Abstract. Heterogeneous network is an inevitable trend for the ﬁfth
generation wireless communications (5G). The existing scheme for the
interworking of the Long Term Evolution (LTE) system and Wireless
Local Area Network (WLAN) system is achieved by Packet Data Net-
work Gateway (PGW) at the core network. However, it is not eﬃcient
enough since 5G may bring in signaling storm for some increasing popular
scenarios, such us instant messaging, device-to-device communications.
In this paper, we propose a new LTE-WLAN integrated architecture.
This architecture is designed based on Software Deﬁned Mobile Network
(SDMN) and network virtualization. A new entity called Macrocell Inte-
grated Controller (Ma-IC) is introduced in the new architecture. It can
shield the diﬀerences of the two systems for core network to simplify
the management procedure and minimize the change of the core network
to be adaptive to this proposed architecture. In addition, some control
functions originally in core network are immigrated into Ma-IC, which
can help save some backhaul signaling overhead. Another main function
of Ma-IC is to coordinate the LTE system and WLAN system to provide
user equipment (UE) more available resources. Besides, a new mechanism
of handover for UE is designed based on this proposed architecture, and
the simulation shows that handover signaling can be reduced by 29.8%
compared with existing mechanism deﬁned in 3GPP standards.
Keywords: LTE · WLAN · Architecture · Handover
1
Introduction
Recently, enormous multi-media equipment rushes into the market. The demand
of high-speed wireless communications is increased [1]. Many advanced tech-
nologies, such as Orthogonal Frequency Division Multiplexing (OFDM) and
Multiple-Input Multiple-Output (MIMO), are adopted to improve the user expe-
rience. However, in the traditional network architecture, interaction among base
station (BS) is unable to support a uniﬁed resource scheduling and high perfor-
mance mobility management. To some extent, the architecture is a bottleneck
to the development of the wireless network. A more intelligent architecture is
the key of the research in 5G. Moreover, the diversity of the user services and
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 517–528, 2018.
https://doi.org/10.1007/978-3-319-72823-0_48

518
F. Dai et al.
the explode of the traﬃc pose a huge challenge to the LTE network since the
spectrum resource has already been extremely scarce [2,3]. Meanwhile, WLAN
can use the unlicensed frequency band to provide high-speed data transmission
service, so it forms a great advantage in resource utilization. Besides, as a low-
cost, easy-deployment wireless access network, WLAN has been wildly used. So
converge LTE and WLAN is an eﬀective way to alleviate the shortage of resource.
Except from diﬀerent modes, 5G will also converge base stations that with
diﬀerent coverages [4], diﬀerent powers and diﬀerent service bearing capabili-
ties to constitute a complex heterogeneous network. Heterogeneous network can
increase the density of the access networks in an area [5], so how to manage and
coordinate these networks to make full advantage of every one of them is another
problem. The proposal of the SDMN [6] provides a new thought to this problem.
SDMN is an extension of SDN, which is used to be applied in computer ﬁeld.
One of the core concepts of SDN is to decouple the control plane and the data
plane [7,8]. In SDMN, a centralized control plane can dispatch diﬀerent access
networks for users, thus realize the network virtualization. And some network
equipment only takes charge of data plane, and forward data according to the
signaling from centralized control plane. Ijaz Ahmad et al. [2] do a survey about
SDMN, but they give no technical details. In this paper, we conduct a thor-
ough study about SDMN and apply it to a new wireless network architecture.
LTE network and WLAN network are integrated in this architecture, to realize
the eﬀective utilization of diﬀerent frequency bands and take full advantages
of multi modes access network. Except from diﬀerent modes, the coverages of
access points are also diﬀerent. With control-service split technology [10], the
control signaling and service data are decoupled, and are respectively forwarded
by access points in macrocells and microcells. The employment of SDMN facil-
itates the management of heterogeneous networks and also reduces the service
response time. Meanwhile, frequent handover caused by dense deployment is
reduced, which help avoid extra signaling overhead and negative eﬀect on user
experience.
The rest of the paper is organized as follows. Section 1 introduces the back-
ground information and some related work is described in Sect. 2. Then, the
proposed architecture is presented in Sect. 3. After that, Sect. 4 is about the new
mechanism of handover and Sect. 5 is the simulation results. Finally, a conclusion
is given in Sect. 6.
2
Related Work
The existing system in Fig. 1 integrates LTE and WLAN at the PGW in core
network [11], and the high throughput may make it a bottleneck to the perfor-
mance of the whole network. Besides, instant messaging is wildly used, and in
the existing network, every short message has to go through the backhaul to
core network, which may cause a severe signaling overhead.
In [12], the author proposes three diﬀerent LTE-WLAN integration architec-
tures. In the ﬁrst one, the Mobility Management Entity (MME) serves as the

5G Architecture
519
Fig. 1. Existing integrated network [11]
control plane integration point while the Serving Gateway (S-GW) serves as the
user plane integration point. The second one integrates LTE and WLAN system.
The integration point is moved out of the EPC to a proposed ISW Gateway. In
the third architecture, an enhanced X2 interface is proposed directly between
the WLAN AP and the HeNB. However, all these networks give no consideration
to the coordination of all these densely-deployed access networks. And the mod-
iﬁcation of the existing network is signiﬁcant, which will cause a great expense
to adopt this architecture.
To address these problems, an optimized architecture is proposed in this
paper and the details are described in the following sections.
3
Controller-Based Converged Architecture
The Controller-Based Converged Architecture (CBCA) is deployed as Fig. 2. Ma-
IC, a new added entity, mainly takes charge of control signaling, and the data
forwarding is accomplished by Microcell Connection Point (MiCP): Microcell
Wi-Fi Access Point (Mi-WAP) and Microcell LTE Base Station (Mi-LBS). To
realize the above functions, the protocol stack of CBCA network is designed
as Fig. 3, which demonstrates an obvious control-service split design. UE sends
control signaling to Ma-IC, after processing, it is sent to MME in core network.
As for service data, multi-mode UE send them through two individual link:
Mi-LBS and Mi-WAP, and are both received by SGW.
3.1
Ma-IC
Ma-IC is the core entity of CBCA. It can implement basic function of a base
station, but with a larger coverage. And there are some enhancements in the

520
F. Dai et al.
Fig. 2. Controller-based converged architecture
Fig. 3. Protocol stack of CBCA
control plane. The current core network gateway devices, such as MME and S-
GW, forward both service data and control signaling, which are coupled together.
However, Ma-IC adopts the idea of SDN, that is, decoupling control plane from
data plane. The relevant control functions in core network gateways and base
stations are extracted into Ma-IC to achieve a centralized control.
Since Ma-IC has the ability to communicate with both cellular network and
WLAN network, so the entire WLAN protocol is added to the original LTE
protocol. The PHY layer, MAC layer and LLC layer in WLAN protocol, corre-
sponding to the PHY layer, MAC layer, RLC layer, PDCP layer and RRC layer
in LTE protocol are stay unchanged. Above these layers and below the TCP/IP
layer of LTE protocol, a new layer called CTRL layer is added. And there are
mainly three function modules in this layer:

5G Architecture
521
1. Data Processing Module
When communicate with MiCP, this module demultiplexes signaling from
upper layer, and encapsulates them respectively into LTE and WLAN format,
then send them down to the corresponding lower layers, and then to the
corresponding MiCP. And when Ma-IC responds to Mi-WAPs’ request, it
can transform packets from WLAN LLC into LTE format and integrate them
with those from LTE lower protocol, then send the complete packets to upper
layer to be processed. By this way, the diﬀerences of access networks can be
shielded from the core network, and WLAN network can be easily integrated
into the LTE system. In this design, UE is a dual-link device, and it can
simultaneously connect with Mi-LBS and Mi-WAP to receive data. So the
protocol stack of UE also integrates both LTE and WLAN protocol. But
when interact with Mi-IC, to streamline the process, only LTE protocol is
used.
2. Information Management Module
By broadcast channel, every Ma-IC establishes a RAN Table. This table
tracks the location information, conﬁguration information, and connection
status of Mi-WAPs, Mi-LBSs as well as UEs that are connected to that Ma-
IC. This can help Ma-IC have an overall view about the entire network. And
when there are some changes in those connected Mi-WAPs, Mi-LBSs or UEs,
Ma-IC will update these RAN Table. In addition, information about Ma-IC
itself is also recorded in the table to decide whether there is enough resource
for another connection. Furthermore, Home Subscriber Server (HSS) in core
network can also obtain information from RAN Table.
3. Connection Control Module
Ma-IC executes access procedure when there are some new Mi-WAPs, Mi-
LBSs or UEs. Two diﬀerent sets of access process are executed correspond-
ingly for LTE system and WLAN system, which are the same as the existing
standard process for users. So users can arrange their own microcell access
networks based on requirement. And the Ma-IC can dynamically adjust the
resource allocation according to user demand and network traﬃc statistical
characteristic. Besides, the handover process of the access equipment is also
executed by this module. And the details will be described in Sect. 4.
3.2
Mi-CP
The features of Mi-WAP and Mi-LBS are dense deployment and high-speed
transmission. Work principle is still in accordance with the 3GPP standards.
However, since UE can simultaneously connect to a Mi-WAP and a Mi-LBS to
receive packets, so every packets will be labeled in order to be rearranged by
UE. And when a packet needs to be retransmitted, the only information that
needs to be feedback is the label. It can help reduce the signaling overhead.
With the change of the architecture, the interaction among network entities
is also changed. Take a basic data request scenario for example to illustrate how
Mi-CP works. As shown in Fig. 4:

522
F. Dai et al.
Fig. 4. Interaction among entities in CBCA
Step 1 UE sends data request to Ma-IC.
Step 2 Ma-IC obtains UE connection status from the RAN Table and calculates
a Distribution Ratio (DR). RAN Table keeps records about the conﬁg-
uration information, available resources, network status of the Mi-CPs
under the coverage of that Ma-IC. It also keeps real-time updates of UEs
connection status of Mi-CPs.
Step 3 Ma-IC send DR and data request together to core network, which informs
core network to split downlink data transmission to the corresponding
access network according to DR.
Step 4 Core network encapsulates data and send them to Mi-LBS and Mi-WAP
respectively.
Step 5 Then Mi-CPs forward data to UE.
4
Handover Scenario
There are two scenarios: Microcell Handover (MiHO) and Macrocell Handover
(MaHO). As in Fig. 5, MiHO occurs when UE handovers between two microcells
while the Ma-IC stay connected; MaHO occurs when UE handovers between two
macrocells, both Ma-IC and MiCP need to be reselected.
The detailed procedure of MiHO is:
Step 1 Ma-IC checks for real time update of RAN Table, and when strength of
signal UE receives from Source MiCP is smaller than a threshold, Ma-
IC trigger the Mi-HO and send Handover Preparation signaling to UE,
including relevant information of optimal Target MiCP selected from
RAN Table.
Step 2 UE sends Handover ACK back to Ma-IC.
Step 3 Ma-IC then sends the same information of Target MiCP to Core Net-
work., in order to inform core network to send the data packet to both
source MiCP and Target MiCP.

5G Architecture
523
Fig. 5. MiHO and MaHO
Step 4 Ma-IC sends Handover Request to Target MiCP to prepare it for UE’s
access.
Step 5 UE sends synchronization information to Target MiCP, receive acknowl-
edgement information and execute access procedure. After successful
access, UE begins to receive packets from Target MiCP that prepared in
step (3).
Step 6 Target MiCP send successful handover ACK back to Ma-IC.
Step 7 Ma-IC send Resource Release to Source MiCP and Core Network, so
UE disconnects with Source MiCP and Core Network stops to send data
packets to Source MiCP (Fig. 6).
Fig. 6. Microcell handover procedure

524
F. Dai et al.
The Detail procedure of MaHO is:
Step 1 Source Ma-IC checks for real time update of RAN Table, and when
strength of signal UE receives from Source MA-IC is smaller than a
threshold, Ma-IC trigger the Ma-HO and send Handover Decision to
Core Network.
Step 2 Core Network send relevant information of optimal Target Ma-IC
selected from HSS to Source Ma-IC.
Step 3 Source Ma-IC send Handover Request and information of UE to Target
Ma-IC.
Step 4 Target Ma-IC select Target MiCP using information of local RAN Table,
then send relevant information and handover acknowledgement back to
Source Ma-IC.
Step 5 Source Ma-IC then sends the information of Target MiCP and Target
Ma-IC to Core Network and UE, in order to inform core network to send
the data packet to both source MiCP and Target MiCP.
Step 6 UE sends synchronization information to Target MiCP, receive acknowl-
edgement information and execute access procedure. After successful
access, UE begins to receive packets from Target MiCP that prepared in
Step 5.
Step 7 Target Ma-IC send successful handover ACK back to Source Ma-IC.
Step 8 Source Ma-IC send Resource Release to Source MiCP and Core Network,
so UE disconnects with Source MiCP and Core Network stops to send
data packets to Source MiCP (Fig. 7).
Fig. 7. Macrocell handover procedure
It can be noticed that the procedure of MiHO is simpliﬁed to a great extent,
and both MiHO and MaHO are soft handover. Under the wide area of an Ma-
IC, only MiHO will be triggered. So, the overall handover signaling overhead is
reduced.

5G Architecture
525
5
Simulation Results and Analysis
In order to testify the performance of the CBCA, a simulation is performed
using OPNET. OPNET is a fully functional network simulation platform, and it
has the complete network entity modules with standard conﬁguration. Based on
these modules, we reprogram to realize the Ma-IC and the corresponding UE.
5.1
Simulation Setup
The simulation parameter is set as Table 1. Contrast network is the network that
used in the present LTE system, in which the UE can only access one network
and handover procedure is hard handover.
Table 1. Simulation parameter
Parameter
CBCA network
Contrast network
Ma-IC
Mi-LBS
Mi-WAP
Mi-LBS Mi-WAP
Quantity
1
3
1
3
1
Quantity of UE
12
3
3
3
3
Eﬀective UE
3 in Mi-LBS2
Transmission power
46 dbm 30 dbm
17 dbm
30 dbm
17 dbm
Radius of coverage
100 m
50 m
10 m
50 m
10 m
Cell selection metric RSRQ
RAN table RAN table RSRQ
RSRQ
Service
Video Conference
The CBCA is deployed as in Fig. 8, and the contrast architecture is deployed
as in Fig. 9.
Fig. 8.
Controller-based
converged
architecture deployment
Fig. 9. Contrast network deployment
The mixUE in CBCA deployment is a new developed entity, which can access
to LTE and WLAN simultaneously. Its protocol is designed in accordance with

526
F. Dai et al.
Fig. 3, and the process of UE is shown in Fig. 10. The lower layer protocol of
WLAN is added into the original LTE protocol. So mixUE can receive data
from both LTE port and WLAN port, then integrate them at CTRL layer and
forward to upper layer.
Fig. 10. Process of UE
As for the Ma-IC, to simplify the programming, we put the code of it in core
network (EPC in ﬁgure), as shown in Fig. 11. The modules in the green square
is used for interaction with WLAN network.
Fig. 11. Ma-IC in core network (Color ﬁgure online)
In contrast network, due to the limitation of OPNET, we split a UE into two
part to simulate the UE that can only access one network during the handover:

5G Architecture
527
one part can access LTE system and the other one can only access WLAN
network. For example, UE2-1 and STA1-1 forms a complete UE handovering
from LTE to WLAN network.
5.2
Simulation Results
When simulation starts, mixUE in CBCA ﬁrstly execute the access procedure to
Mi-LBS2, that is, LTE system. And then when the handover is triggered, mixUE
connect to WLAN AP without breaking the connection with eNB2 as described
in Sect. 4. The throughput of mixUE is shown in Fig. 12. We can see that the
soft handover is achieved since the data transmission is successive during the
handover.
And in contrast network, take UE2-1 and STA1-1 as an example again. When
simulation starts, UE2-1 initiate the access procedure to Mi-LBS2, that is, LTE
system. And then when the handover is triggered, STA1-1 access to Mi-WAP
and then UE2-1 disconnects with Mi-LBS2, simulating the hard handover. From
Fig. 13, we can see that there is a break-oﬀof the data transmission when han-
dover to the WLAN network.
Three hundred simulation is performed, and the average handover signaling
overhead in CBCA network is 73 entries and in contrast network is 104 entries.
By contrast, the signaling overhead in CBCA network is reduced by 29.8%.
Fig. 12. MixUE throughput
Fig. 13. Existing UE throughput
6
Conclusion
In this paper, we have proposed a new integrated architecture and a correspond-
ing handover mechanism to improve the current interworking between LTE sys-
tem and WLAN system. A centralized controller which includes data processing
module, information management module and connection control module has
been employed. It possesses the ability to ﬂexibly dispatch resources among Mi-
CPs and also it has a global view of the attached entities to maintain a RAN
table, which can be utilized to control the network. The simulation results show
that the performance of handover mechanism is enhanced by decoupling the

528
F. Dai et al.
control signaling and service data, since that the control procedure is simpliﬁed
and thus release more spectrum occupation. In summary, the controller-based
integrated architecture satisﬁed the trend of 5G.
Acknowledgment. This work was supported by the National High-Tech R&D Pro-
gram (863 Program 2015AA01A705), the National Natural Science Foundation of
China (No. 61601055).
References
1. Gupta, A., Jha, R.K.: A survey of 5G network: architecture and emerging tech-
nologies. IEEE Access 3, 1206–1232 (2015)
2. Zhang, H., Chu, X., Guo, W., Wang, S.: Coexistence of Wi-Fi and heterogeneous
small cell networks sharing unlicensed spectrum. IEEE Commun. Mag. 53(3), 158–
164 (2015)
3. Abinader, F.M., Almeida, E.P., Chaves, F.S., Cavalcante, A.M., Vieira, R.D.,
Paiva, R.C., Sousa, V.A.: Enabling the coexistence of LTE and Wi-Fi in unlicensed
bands. IEEE Commun. Mag. 52(11), 54–61 (2014)
4. Ling, J., Kanugovi, S., Vasudevan, S., Pramod, A.K.: Enhanced capacity and cov-
erage by Wi-Fi LTE integration. IEEE Commun. Mag. 53(3), 165–171 (2015)
5. Kim, D.S., Noishiki, Y., Kitatsuji, Y., Yokota, H.: Eﬃcient ANDSF-assisted Wi-Fi
control for mobile data oﬄoading. In: International Wireless Communications and
Mobile Computing Conference (IWCMC), pp. 343–348 (2013)
6. Chen, T., Matinmikko, M., Chen, X., Zhou, X.: Software deﬁned mobile networks:
concept, survey, and research directions. Commun. Mag. IEEE 53(11), 126–133
(2015)
7. Wood, T., Ramakrishnan, K.K., Hwang, J., Liu, G., Zhang, W.: Toward a software-
based network: integrating software deﬁned networking and network function vir-
tualization. IEEE Netw. 29(3), 36–41 (2015)
8. An, X., Kiess, W., Perez-Caparros, D.: Virtualization of cellular network EPC
gateways based on a scalable SDN architecture. In: IEEE Global Communications
Conference, pp. 2295–2301 (2014)
9. Ahmad, I., Liyanage, M., Namal, S., Ylianttila, M.: New concepts for traf-
ﬁc, resource and mobility management in software-deﬁned mobile networks. In:
Conference on Wireless On-Demand Network Systems and Services, pp. 1–8
(2016)
10. Jha, S.C., Sivanesan, K., Vannithamby, R., Koc, A.T.: Dual connectivity in LTE
small cell networks. In: IEEE Globecom Workshops (GC Wkshps), pp. 1205–1210
(2014)
11. 3GPP TS 23.402: Architecture Enhancements for Non-3GPP Accesses (2016)
12. Tomici, J., Starsinic, M., Mohamed, A.S.I., Li, Q.: Integrated small cell and
Wi-Fi networks. In: IEEE Wireless Communications and Networking Conference
(WCNC), pp. 1261–1266 (2015)

A Phase Diﬀerence Based Cooperative Spectrum
Sensing Scheme for Cognitive Radio Network
Zheng Xie(B), Sai Huang, Yifan Zhang, and Zhiyong Feng
Key Laboratory of Universal Wireless Communications, Ministry of Education,
Wireless Technology Innovation Institute (WTI), Beijing University of Posts
and Telecommunications, Beijing 100876, People’s Republic of China
xiexiaozheng@bupt.edu.cn
Abstract. The increasing scarcity of spectrum resources is one of the
most challenging issues to cognitive radio systems in 5G era. Traditional
schemes fail to gain the balance between accuracy and complexity, which
are the two of the most signiﬁcant parameters to evaluate the perfor-
mance of the spectrum sensing. In this paper, in order to improve the
sensing accuracy and reduce the computation complexity, we propose
a novel cooperative spectrum sensing scheme based on phase diﬀerence
is proposed. By using the mean of Phase Diﬀerence (PD) as the test
statistics, the proposed PD mean detection is formulated for eﬃcient
spectrum sensing and its performance is analyzed under Rayleigh fading
channel and Gaussian noise, which has a low complexity of O(K) and
is immune to the noise uncertainty in contrast to the energy detection
scheme. Moreover, to improve performance of the sensing scheme based
on phase diﬀerence by a single CR, we consider the cooperative scenario
with multiple CR nodes. Simulation veriﬁes that our scheme obtains
3–4 dB gains comparing with energy detection.
Keywords: Cognitive radio · Spectrum sensing · Means
Phase diﬀerence · Fading · Cooperative sensing
1
Introduction
In 4G era, the mobile telecommunication pursues 1 Gb/s for ﬁxed or low mobil-
ity and 100 Mb/s for high mobility with regard to user data rate, but this has
not been satisﬁed due to the dramatically increasing numbers of mobile devices
nowadays. With the approaching of the 5G which is being promoted by various
organization, the mobile telecommunication needs more frequency to satisﬁed
those needs. But with the spectrum resources become more and more scarce,
some measurement shows the average utilization rate of current spectrum below
3 GHz is merely 5.2%, which unveils that the spectrum resources are heavily
under utilized [1]. To improve the spectrum utilization greatly, we can allow a
secondary user to access licensed band when the primary user (PU) is absent.
In 3GPP Release 13, Long Term Evolution-Unlicensed (LTE-U) [2] is newly
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 529–543, 2018.
https://doi.org/10.1007/978-3-319-72823-0_49

530
Z. Xie et al.
proposed to struggle for performance in unlicensed bands. LTE-U adopts car-
rier aggregation (CA) technology and operates on unlicensed frequency bands in
5 GHz, aiming to achieve higher data rate by eliminating interference from the
industrial, scientiﬁc, and medical (ISM) bands. Therefore, Cognitive Radio (CR)
is playing a key role in working out the circumstance of scarce spectrum and pro-
moting the 5G. Cognitive radio, as an agile radio technology, has been proposed
to promote the eﬃcient use of the spectrum [3]. Cognitive radio is booming
technology which has the capacity to deal with the stringent requirement and
scarcity of the radio spectrum. The evolution of this technology has revealed a
phenomenon that the design of wireless systems will consider more and more
about the ability of radio spectrum sensing, self-adaptation, and dynamic spec-
trum sharing. The above considerations are nothing more than to achieve higher
spectral eﬃciency. Cooperative communications and networking is another new
communication technology paradigm that allows distributed terminals in a wire-
less network to collaborate through some distributed transmission or signal pro-
cessing so as to realize a new form of space diversity to combat the detrimental
eﬀects of fading channels.
The essence of cognitive radio technology is that the SU (secondary user)
share the spectrum with the primary user (PU) and will not interference the
PU. Thus it is crucial to obtain the status of PU for CR in a way. As an essen-
tial way to obtain the status of PU, spectrum sensing is the basis for eﬃcient
spectrum utilization in CR [4]. Energy detection (ED) [5], matched ﬁltering [6]
and cyclostationary detection [7] are three most widely used spectrum sensing
methods. All of these methods have their own advantages and disadvantages [8].
The Matched Filtering scheme maximizes the SNR of the received signal and
needs less time to achieve high processing gain but the prior information must
be known. Energy detection can be implemented without prior information but
it has poor performance under low SNR environment. Cyclostationary Detection
still has better sensing performance under low SNR circumstance but this scheme
needs high algorithm complexity and prior information still needs. Traditional
spectrum sensing schemes fail to resolve the contradiction between accuracy and
complexity. And they focus on the amplitude of signal, which is extremely sen-
sitive to the noise uncertainty and multi-path fading such as Rayleigh fading.
Therefore, it is important to design a new scheme to sense the spectrum.
In [9–11], Pawula and Adachi derived the distribution of phase diﬀerence
(PD) of the noise-perturbed signal. These promote us to use the phase diﬀer-
ence of received signal to design the spectrum sensing scheme. Through careful
analysis, it is noticed that there is an obvious diﬀerence in the PD’s distributions
between Gaussian noise and noise-perturbed signal. Besides, this diﬀerence still
exist in Rayleigh Fading channel and we will prove this regular by formulas. We
take advantage this PD’s character and set test statistics in order to sense the
status of PU with low complexity. All the scheme above implemented by one
CR, but a signal CR will face more problems such as blocking by buildings thus
this paper will let more CRs to join the scheme to further improve the accuracy.

Cooperative Spectrum Sensing
531
The rest of this paper is organized as follows. Section 2 introduces the system
model and the deﬁnition of PD, analyzes the distribution of signal’s PD. Section 3
formulates the test statistics and analyzes the scheme’s performance for a signal
CR, the last part of this section put more attention on analyzing the performance
of cooperative detection for multi CRs. Simulation analysis is provided in Sect. 4.
Finally, the paper is concluded in Sect. 5.
2
System Model and Phase Diﬀerence
2.1
System Model
The spectrum sensing problem can be considered as a binary hypothesis test
problem and two hypotheses can be formulated as follows:
Hi
0 : ri(n) = wi(n)
n = 1, 2, ..., N
i = 1, 2, ...Nc
Hi
1 : ri(n) = wi(n) + his(n)
n = 1, 2, ..., N
i = 1, 2, ...Nc
(1)
where ri(n) is the nth sample of received signal from the ith CR, hi is the
instantaneous channel gain between PU and the ith CR, w(n) is the Additive
White Gaussian Noise (AWGN) samples and s(n) is the PU signal. Hi
0 is the
hypothesis stating that only noise is present and PU is absent, while Hi
1 indicates
that PU is present and all the hypothesis are made from the ith CR decision.
N represents the length of signal samples and also denotes that our scheme
handles ﬁnite length samples. Nc represents the number of CRs. In the ideal
situation, the ith CR will make false alarm decision Hi
1 when the PU is present,
while make the opposite decision Hi
0 when the PU is not present by our scheme.
However, the CRs sometimes make wrong decisions because of the AWGN and
Rayleigh fading. Therefore, to evaluate the performance of our scheme, we made
P i
d presents the detection probability and P i
f presents false alarm probability for
the ith CR, P i
d and P i
f can be formulated as follows:
P i
d = P(Hi
1|H1)
P i
f = P(Hi
1|H0)
(2)
P i
d represents the detection probability that the ith CR makes correctly decision
when the PU is presents and larger P i
d indicates that the CRs has little interfer-
ence to PU. P i
f represents the probability that the ith CR makes wrong decision
when the PU is not present and lower P i
f indicates more access opportunity. So
an excellent scheme means lower Pf and higher Pd. However, there is a trade-
oﬀbetween Pf and Pd for most sensing schemes, which makes it impossible to
improve Pd and reduce Pf at the same time. Thus receiver operating charac-
teristic (ROC) curve (Pf vs Pd) is usually used as the performance metric of
sensing schemes. Next, we will discuss the phase diﬀerence on the case of single
CR. Moreover, the case of more CRs is same as the case of signal CR, thus the
following discussion is under one CR case.

532
Z. Xie et al.
2.2
Deﬁnition of Phase Diﬀerence
The received signal can be formulated as follows:
r(n) = [s(nT)ej2πfcnT ]h(nT) + w(nT)
(3)
where, T is the sampling interval, and s(nT) is the instantaneous value of PU
signal, fc represents the residual carrier frequency after down conversion, h(nT)
is channel impulse responses, w(nT) is Gaussian noise. The phase θ of received
data sample, r(n) can be calculated through following formula:
θ′
n =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
arctan(Im(r(n))
Re(r(n)))
(Re(r(n) ≥0)
(arctan(Im(r(n))
Re(r(n)) + π)
(Re(r(n) < 0)
θn = θ′
n mod 2π
(4)
where, Re(r(n)) and Im(r(n)) represent the real and imaginary part respectively
of the received data sample. Where needs paying special attention is that we
introduce the modulo 2π operation to ensure phase θn is in the range of [0, 2π].
Then, the phase diﬀerence ϕn between two adjacent samples is deﬁned as follows:
ϕn = (θn+1 −θn) mod 2π
(5)
2.3
PD Distribution of Gaussian Noise
We all know that the instantaneous phase θn of Gaussian noise follows a uniform
distribution in [0, 2π], which means θn ∼U(0, 2π). According to the nature
of Gaussian noise, the two adjacent phases are completely irrelevant and in
other words, the two adjacent phases are completely independently identically
distributed. Thus, ϕ′
n = θn+1 −θn follow a triangular distribution from −2π to
2π which can be expressed as:
Pϕ′
n =
⎧
⎪
⎨
⎪
⎩
1
2π + ϕ′
n
4π2
−2π ≤ϕ′
n < 0
1
2π −ϕ′
n
4π2
0 ≤ϕ′
n ≤2π
(6)
Considering that the ϕ′
n is in the range of [0, 2π], then we make ϕn
=
ϕ′
n mod (2π). When the ϕ′
n is in the range [−2π, 0], ϕn = ϕ′
n mod (2π). So
the distribution of the ϕn can be expressed as follows:
Pϕn = Pϕ′
n(ϕn) + Pϕ′
n(ϕn −2π) =
1
2π
(7)
We can conclude that the PD ϕn of Gaussian noise complying with a uniformly
distributed in [0, 2π] based the above analysis. Therefore, according to the nature
of uniformly distributed, it is easy to obtain the mean and variance value of PD

Cooperative Spectrum Sensing
533
of Gaussian noise by the following formula and the mean and variance are π and
π2
3 respectively.
μϕ =
 2π
0
ϕPϕdϕ
(8)
σ2
ϕ =
 2π
0
(ϕ−μϕ)2Pϕdϕ
(9)
There is no signal component in our analysis under this circumstance, i.e. hypoth-
esis H0 and all the results are about noise. Then, in the next section, we will pay
more attention to the PD distribution of signal perturbed by Gaussian noise.
Besides, that problem will be discussed in two diﬀerent channel conditions, the
ﬁrst channel condition is AWGN channel without fading, and kind channel con-
dition is AWGN channel with Rayleigh fading which is more in line with the
actual scenarios.
2.4
PD Distribution of Signal Perturbed by Gaussian Noise
(AWGN Channel)
Regard to the noise-perturbed signal, papers [9–11] has already derived formulas
that illustrate the characteristics of PD distribution. Thus, in this paper, we are
not doing a detailed derivation for that and the formula of CDF is as following:
Fϕn(ϕn) =
1
4π
π
2
−π
2
e−E 
W sin(Δω)
E
+ ξ

dt
(10)
where
E = U −V sin t −W cos Δω cos t
(11)
U = (SNRn+1 −SNRn)/2
(12)
V = (SNRn+1 + SNRn)/2
(13)
W =
	
SNRn+1SNRn =
	
U 2 −V 2
(14)
ξ =
α sin ϕn −β cos ϕn
1 −(α cos ϕn + β sin ϕn) cos t
(15)
Δω = φn −ϕn
(16)
in which, SNRn and SNRn+1 are the instantaneous SNR of the nth and the n+
1th sampling point respectively, ϕn is phase diﬀerence between the nth sampling
point and the n + 1th sampling point of PU signal without noise and Rayleigh
fading. It’s worthy to noted that α + βj represents the complex correlation
of the sum of Rayleigh fading signal and noise and ξ = 0 because of AWGN
channel. Continuous wave only be considered here, so the SNRn will be equal
to SNRn+1, and we can assume the SNRn+1 = SNRn = γ. And then, after
substituting and derivation of CDF, the formula of PDF is as follows:
Pϕn(ϕn) = [1 + 2γ −γ(1 −cos Δω cos t)]e−γ(1−cos Δω cos t)
(17)

534
Z. Xie et al.
2.5
PD Distribution of Signal Perturbed by Gaussian Noise
and Rayleigh Fading
In this section, we consider the PU signal’s PD distribution which perturbed by
Gaussian noise and Rayleigh fading. Thus, the complex correlation of the sum
of Rayleigh fading signal and noise cannot be neglect and it can be expressed
as α + βj. Similarly, only continuous wave be considered, so we can still assume
the SNRn+1 = SNRn = γ. According to the condition α + βj and SNRn+1 =
SNRn = γ, we can obtain the following formula:
α + βj =
	
α2 + β2ejφn = γejφn
γ+1
(18)
As our spectrum detect scheme work under low SNR condition, so the term
approximate to constant one. Thus, the CDF of PD distribution can be expressed
as following:
Fϕn(ϕn)
= 1
4π
π/2

−π/2
[
sin Δω
1 −cos Δω cos t+
γ sin Δω
γ(1 −cos Δω cos t) + 1]dt
=
sin Δω
π |sin Δω| arctan
cot Δω
2

+
sin Δω
π

(1 + 1/γ)2 −cos2Δω
arctan

(γ + 1) + γ cos Δω
(γ + 1) −γ cos Δω
(19)
and the distribution of Δω can be described as following:
FΔω(Δω) =

Fϕn(Δω) −Fϕn(−π)
Δω ≤0
Fϕn(Δω) −Fϕn(−π) + 1
Δω > 0
(20)
After transformation of the terms arctan, a simpliﬁed form of FΔω(Δω) can
be expressed by following formula:
FΔω(Δω) = 1/2 + Δω/2π + sin ΔωT (Δω)
2πQ(Δω)
(21)
where
T(Δω) = π
2 + arcsin γ cos Δω
γ + 1
(22)
Q(Δω) =

(1 + 1
γ )
2
−cos2Δω
(23)
and as Δω = φn −ϕn, so
fϕn (ϕn) = fΔω(φn −ϕn) = F ′
Δω(φn −ϕn)
(24)

Cooperative Spectrum Sensing
535
Thus, after the derivation, the PDF of PD can be represents by following:
fϕn(ϕn) = 1
2π + cos ΔωT(Δω)
2πQ(Δω)
−cos Δωsin2ΔωT(Δω)
2Q(Δω)
−
γsin2Δω
2π(γ + 1)Q(Δω)

1 −γ2cos2Δω
(γ+1)2
(25)
3
Test Statistics and Cooperative Sensing
3.1
Test Statistics
After the derivation above, we can easily obtain the conclusion that the mean
and variance of signal perturbed by noise are very diﬀerent from the Gaussian
noise. Thus, every CR can take advantage those characteristic to sense the status
of PU. So, in this paper, we design a scheme that every CR makes the mean of
PD as test statistics and the mean of PD is:
Si
θ = 1
N
N

i=1
ϕi
n
(26)
where the Si
θ is test statistic calculated by the ith CR, N represents the number
of PDs, and the ϕi
n is the PD between the nth sampling point and the (n + 1)th
sampling point of the receive signal from ith CR, calculated by formula (3) (4)
(5). When the mean of PD Si
θ falls in the range of

π −ϕi
0, π −ϕi
0

, the ith CR
will make the decision that the PU in not present and the ith CR’s decision
model is expressed as follows:
Di =
Hi
0
Si
θ −π
 ≤ϕi
0
Hi
1
Si
θ −π
 > ϕi
0
(27)
where, Di is the ith CR’s decision and ϕi
0 is the decision threshold.
3.2
Threshold Setting
If the number of ϕi
n is large enough, the test statistics Si
θ can be approximated
as a Gaussian distribution according to the central limit theorem, whose mean
and variance are π and π2
3N respectively. Thus, the PDF of test statistics Si
θ can
be expressed as follows:
f(Si
θ|H0) =
1

2π3
3N
e
−
(Si
θ−π)2
2π2/3N
(28)

536
Z. Xie et al.
We can easily obtain the false alarm probability P i
f by following formula:
P i
f = 1 −
π+ϕi
0

π−ϕi
0
1

2π3
3N
e
−
(Si
θ−π)2
2π2/3N dSi
θ
= erfc(
Si
θ
	
2π2/3N
)
(29)
In practice, the threshold is usually chosen according to a ﬁxed false alarm
probability, which can be expressed as follows:
ϕi
0 =
	
2π2/3Nerfc−1(Pf)
(30)
As the case the PU is presents, we can easily obtain the value of mean μi and the
variance σ2
i by formulas (17) or (25). For the case H1, according to the central
limit theorem, the PDF of test statistics Si
θ can be expressed as follows:
f(Si
θ|H1) =
1
	
2πσ2
i /N
e
−
(Si
θ−μi)2
2σ2
i /N
(31)
Thus, the detection probability P i
d of the ith CR can be expressed as follows:
P i
d = 1 −
π+ϕi
0

π−ϕi
0
1
	
2πσ2
i
e
−
(Si
θ−μi)2
2σ2
i
dSi
θ
= erfc(
Si
θ
	
2σ2
i
)
(32)
3.3
Cooperative Sensing
In an actual scenario, the hidden terminal problem which occurs when the CR
is sheltered by giant buildings especially in urban area and that become an
urgent issue to tackle. In this case, the CR cannot detect the existence of PU,
and will access the spectrum which the PU is occupying. Thus certainly caused
a series severe interference to the PU. In our sensing scheme, we deploy more
CRs to collaborate [12]. The cooperative spectrum structure is illustrated in
the Fig. 1, the overall process works like this: Firstly, every CR performs their
local spectrum sensing scheme based on PD independently and make a local
decision on whether the PU is present or not. And then, every CR forward
their local decisions to the fusion center. Finally, the fusion center fuses the all
CR’s decisions by fusion algorithm and makes the ﬁnal decision of the status
of PU. There are mainly two fusion algorithms, which are decision fusion and
data fusion respectively. In decision fusion case, fusion center receive all one-bit
binary decisions from CRs, and fused together according to an OR logic. Instead,

Cooperative Spectrum Sensing
537
Fig. 1. Cooperative spectrum sensing structure
in data fusion case, fusion center not receive one-bit binary decisions but receive
the observation value from all CRs. In our scheme, decision fusion algorithm is
employed as CRs transmit less amount of data [13,14]. In this paper, we use
the number 0 to denote the decision Hi
0 and number 1 to denote the decision
Hi
1 from the ith CR. So the decision from the ith CR Di has only two values,
0 or 1, which can be expressed by Di ∈{0, 1}. On one side of the fusion center,
all decisions from the CRs are fused together according to the following logic:
D =
K

i=1
Di

≥n, H1
< n, H0
(33)
where, H1 and H0 represent the ﬁnal decision of status of PU from the fusion
center. If the fusion center makes the decision, i.e. H1, there must be at least
n out of K CRs making decision Hi
1 and transmit 1s to the fusion center, vice
versa. It is worthy to noted that when the n is set to be 1, this logic can be seen
as OR rule and this logic rule can be seen as AND logic rule when the n is K.
Under the circumstance of OR rule, the fusion center makes the decision that
the PU is presence when at least one CR make the local decision H1.
The OR logic can be seen as a kind of conservative logic when the CR access
the spectrum and OR logic will lower the interference to the PU because of higher
Pd. For the AND logic rule, it can be seen as more radical logic and improve the
utilization ratio of spectrum, but at the cost of higher collision probability with
the PU. In this paper, we discuss only two basic fusion algorithms, there are also
many more fusion algorithms that can be studied and diﬀerent algorithms are
suitable for diﬀerent actual scenes. The ﬁnal detection probability Pd and false

538
Z. Xie et al.
alarm probability Pf of cooperative spectrum sensing based on the OR rule is
presented by following formulas:
Pd = 1 −
K

i=1
(1 −P i
d)
(34)
Pf = 1 −
K

i=1
(1 −P i
f)
(35)
All the CRs can be considered in the same radio condition, thus they have same
test statistics distribute. So here replaces the P i
d and P i
f by formula (32) and
formula (29) respectively and makes Si
θ = Sθ, σi = σ, μi = μ. The ﬁnal Pd and
Pf can be expressed by following formulas:
Pd = 1 −(1 −erfc( Sθ
√
2σ2 ))K
(36)
Pf = 1 −(1 −erfc(
Sθ
	
2π2/3N
))K
(37)
And for the AND logic rule, the ﬁnal detection probability Pd and false alarm
probability Pf of cooperative spectrum sensing can be expressed by following
formulas:
Pd =
K

i=1
P i
d = (erfc( Sθ
√
2σ2 ))K
(38)
Pf =
K

i=1
P i
f = (erfc(
Sθ
	
2π2/3N
))K
(39)
3.4
Performance Analysis
According to the nature of our scheme, only N + 1 sampling points need to be
store for every CR and the computational complexity is O(N). To be contrasted
with the other more sophisticated schemes such as sensing scheme based on
cyclostationary feature, our sensing cost every CR’s lower computing resource.
4
Simulation Analysis
In this section, the method of Monte Carlo Simulation is applied in our simula-
tion to oﬀset the random error, thus improving the accuracy of our simulation
and simulation times is set to 1000. According to the analysis above, the per-
formance of our scheme is related to many factors, such as the length of sample
points, the number of CRs, the fusion logic rules and channel condition. All of

Cooperative Spectrum Sensing
539
the simulations are implemented under the Rayleigh fading channel condition as
it is more similar to the practical radio environment.
Figure 2 compares the detection probability Pd of our scheme with the detec-
tion probability Pd that of scheme by energy detection for several basic modu-
lation signals, when the N = 1000, Pf = 0.01 and the number of CR is set to
8(K = 8). With the SNR increasing, detection probability Pd is also increas-
ing, so those curves are accord with the general regular. We can observe that
our scheme obtains 3–4 dB gains when the Pd is above 90% comparing with the
scheme based on energy detection. The overlapping of curves in most parts prove
that our scheme is robust to modulation mode which is similarly as energy detec-
tion. The curves in small parts are not overlapping and detection probability of
sine wave signal is higher than signals modulated by other modulation in those
parts, that is because the phase of sine wave signal is more continuous than the
others.
Fig. 2. Detection probability for diﬀerent ways of modulation
Figure 3 shows the detection probability versus signal length N, when the Pf
is set to 0.01 and the number of CRs is set to 8. According to the Fig. 3, we can
obtained the regular that when three curves reached the same level of Pd, the
curve whose length of sample data is longer needs the lower SNR. This regular

540
Z. Xie et al.
can be explained by the reason that the length of sample data is longer, the
test statistics, i.e. the mean of PD will converge to mathematical expectation
according to the law of large numbers.
Fig. 3. Detection probability Pd for diﬀerent length of sampling points
Figure 4 shows the relation between the number of CRs represented by K and
detection probability. We can get that with the number of CRs increasing, the
detection probability Pd is increasing too when all the curves are in the same
SNR condition. That can be explained by formula (34), the detection probability
Pd is less to 1, so the larger K become, the larger Pd becomes.
Figure 5 shows the receiver operating characteristic (ROC) curves which
describe the relation between detection probability Pd and false alarm probabil-
ity Pf under the condition that K = 8, N = 1000. That lists the performance
results of cooperative spectrum sensing for diﬀerent fusion rules and the case of
ED over Rayleigh fading channels with the SNR = −14 dB. With the false alarm
probability Pf increasing, detection probability Pd of three curves increase too,
but in the area of lower Pf, the Pd of our scheme based on OR fusion logic rule
increases sharply. So the OR rule is the better rule than the AND rule, and our
scheme based on OR fusion logic rule have the best performance than others.

Cooperative Spectrum Sensing
541
Fig. 4. Detection probability Pd for diﬀerent number of CRs
Fig. 5. ROC curves at −14 dB

542
Z. Xie et al.
5
Conclusion
In this paper we proposed a novel cooperative spectrum scheme based on phase
diﬀerence which can improve the spectrum sensing performance compared with
traditional sensing scheme. Firstly, we analyze the distributions of the phase
diﬀerence between two adjacent samples under the condition of Gaussian noise,
the signal perturbed by noise and the signal perturbed by Rayleigh fade, and
ﬁnd that the mean and variance of those signal are very diﬀerent as the their
distributions are very diﬀerent. On that basis, we select the mean of PD as
test statistics, which follows Gaussian distribution and needs lower computer
resource. According to the analysing above, we obtain the threshold of detection.
Cooperative spectrum sensing was then considered and shown to be a powerful
method for dealing with the hidden terminal problem. Simulation shows that our
scheme has best performance compared to energy detection under the Rayleigh
Faded channel and OR rules has better performance than AND performance.
Acknowledgment. This work was supported by the National Natural Science Foun-
dation of China (61227801), the National Key Technology R&D Program of China
(2015ZX03002008-002).
References
1. August, P., Mchenry, M.A.: NSF spectrum occupancy measurements project sum-
mary (2005)
2. Al-Dulaimi, A., Al-Rubaye, S., Ni, Q., Sousa, E.: 5G communications race: pursuit
of more capacity triggers LTE in unlicensed band. IEEE Veh. Technol. Mag. 10(1),
43–51 (2015)
3. Mitola, J., Maguire, G.Q.: Cognitive radio: making software radios more personal.
IEEE Pers. Commun. 6(4), 13–18 (1999)
4. Ghasemi, A., Sousa, E.S.: Spectrum sensing in cognitive radio networks: require-
ments, challenges and design trade-oﬀs. IEEE Commun. Mag. 46(4), 32–39 (2008)
5. Zhao, Y., Li, S., Zhao, N., Wu, Z.: A novel energy detection algorithm for spectrum
sensing in cognitive radio. Inf. Technol. J. 9(8), 1659–1664 (2010)
6. Price, R., Abramson, N.: Part 4: detection theory. Inf. Theor. IRE Trans. 7(3),
135–139 (1961)
7. Kim, K., Akbar, I.A., Bae, K.K., Um, J.S., Spooner, C.M., Reed, J.H.: Cyclo-
stationary approaches to signal detection and classiﬁcation in cognitive radio. In:
IEEE International Symposium on New Frontiers in Dynamic Spectrum Access
Networks, pp. 212–215 (2007)
8. Bhargavi, D., Murthy, C.R.: Performance comparison of energy, matched-ﬁlter and
cyclostationarity-based spectrum sensing. In: IEEE Eleventh International Work-
shop on Signal Processing Advances in Wireless Communications, pp. 1–5 (2010)
9. Pawula, R.F., Rice, S.O., Roberts, J.: Distribution of the phase angle between two
vectors perturbed by Gaussian noise. IEEE Trans. Commun. 30(8), 1828–1841
(1982)
10. Pawula, R.F.: Distribution of the phase angle between two vectors perturbed by
Gaussian noise II. IEEE Trans. Veh. Technol. 50(2), 576–583 (2001)

Cooperative Spectrum Sensing
543
11. Adachi, F., Tjhung, T.T.: Distribution of phase angle between two Rayleigh vectors
perturbed by Gaussian noise. Electr. Lett. 28(10), 923–925 (1992)
12. Cabric, D., Mishra, S.M., Brodersen, R.W.: Implementation issues in spectrum
sensing for cognitive radios. In: Conference Record of the Thirty-Eighth Asilomar
Conference on Signals, Systems and Computers, vol. 1, pp. 772–776 (2004)
13. Letaief, K., Zhang, W.: Cooperative communications for cognitive radio. Proc.
IEEE 97(5), 878–893 (2009)
14. Chen, X., Chen, H.H., Meng, W.: Cooperative communications for cognitive radio
networks from theory to applications. IEEE Commun. Surv. Tutorials 16(3), 1180–
1192 (2014)

Power Allocation for NOMA System via Dual
Sub-gradient Descent
Juan Wu1, Xinli Ma1, Zhenyu Zhang1, Zhongshan Zhang1,
Xiyuan Wang1, Xiaomeng Chai1, Linglong Dai2,
and Xiaoming Dai1(&)
1 Technology Research Center for Convergence
Networks and Ubiquitous Services, University of Science and Technology
Beijing (USTB), Beijing 100083, China
dxmsjtu@sohu.com, daixiaoming@ustb.edu.cn
2 Tsinghua-Rohm EE Hall, Department of Electronic Engineering,
Tsinghua University, Beijing 100084, China
daill@tsinghua.edu.cn
Abstract. Non-orthogonal multiple access (NOMA) has attracted great atten-
tion as a promising downlink multiple access technique for the next generation
cellular networks (5G) due to its superior spectral efﬁciency. Power allocation of
multi-user scenario in NOMA is a challenging issue and most of existing works
focus on two-user scenario. In this work, we develop a dual sub-gradient descent
algorithm based on Lagrange dual function to optimize multi-user power allo-
cation for the multiple-input single-output (MISO) downlink NOMA system.
The objective function is a non-convex optimization problem and we can solve
it with a log-convex method and an approximation based approach. Numerical
results demonstrate that the proposing scheme is able to achieve higher capacity
performance for a NOMA transmission system compared with the traditional
orthogonal multiple access (OMA) with a few iterations.
Keywords: Non-orthogonal multiple access  Power allocation
Log-convex  Dual sub-gradient descent
1
Introduction
The power domain based NOMA utilizes superposition coding (SC) [1] at transmitter
and successive interference cancellation (SIC) [2] at the receiver to achieve a higher
spectral efﬁciency. Compared with the contemporary orthogonal multiple access
approaches, non-orthogonal communication techniques have more advantages, such as
larger system capacity, higher spectral efﬁciency and reduced latency, making NOMA
an attractive option for implementation in future wireless standards.
There are two key techniques contained in NOMA: (1) NOMA utilizes SIC to
process the received signals on the user equipment where users are sorted based on
their effective channel gains. At the receiving terminal, the stronger user can eliminate
interference imposed by the weaker user through SIC operation. (2) NOMA is a
multiplexing scheme which is applied in power domain. User de-multiplexing is
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 544–555, 2018.
https://doi.org/10.1007/978-3-319-72823-0_50

ensured by large power difference between paired users. Theoretically, pairing the user
having the worst channel gain with the user having the best channel gain in each cluster
can obtain a better channel capacity. In a word, employing SC and SIC in NOMA can
achieve a better system performance [3].
NOMA applying non-orthogonal transmission technique between the sub-channels,
thus there is no apparent near-far effect and multiple access interference (MAI) com-
pared with the traditional CDMA and OFDMA in 3G. However, it would be rather
complex than other receivers as a non-orthogonal transmission receiver and the
power-domain multiplexing is still on the researching stage, NOMA is facing some
challenges in technical implementation, and there is still much of work to do.
Power allocation in NOMA has been studied in many existing works and has been
extended to various systems and different schemes. In [4], a power allocation approach
named Fair-NOMA is introduced. The key idea of Fair-NOMA is that the capacity of
two mobile users has the opportunity to always achieve that of the OMA system.
According to the Shannon capacity equation, if the capacity of NOMA is greater than
or equal to OMA, a reasonable power allocation coefﬁcient can be derived. In both
single-input single-output (SISO) and multiple-input multiple-output (MIMO) scenar-
ios, two optimal power allocation solutions with closed form based on the
Karush-Kuhn-Tucker (KKT) condition have been studied in [5]. For MIMO-NOMA
with layered transmission, Choi [6] explored an approach based on alternating maxi-
mization (AM) algorithm and showed that the sum rate optimization problem is con-
cave in allocated powers to multiple layers of users. Energy efﬁcient (EE) resource
allocation problem has not been well studied for NOMA system until [7], where the
author proposed a low-complexity suboptimal matching scheme for sub-channel
assignment (SOMSA) algorithm to maximize the system energy efﬁciency and
numerical simulation results in this work have shown that NOMA has much better sum
rate and superior EE performance compared with OMA.
In [8] Ding utilized an approximation of the original non-convex optimization
problem with a minorization-maximization algorithm (MMA) in downlink MISO-
NOMA system. In each step of the MMA, the author utilized a second-order cone
program to get a subset of the feasibility set of the original problem and the algorithm is
numerically shown to converge within a few iterations. Finally, a linear multiuser
superposition transmission (MUST) scheme is studied in [9], in which a Monte Carlo
simulations based approach is devised to maximizing the total mutual information with
a reasonable power allocation scheme.
Compared to the previous power allocation schemes in NOMA system, our main
contributions can be summarized as follows:
(i)
The prior studies of power allocation about NOMA have focused on two-user
scenarios. In this paper, we will investigate multi-users power allocation prob-
lems in the downlink of a MISO-NOMA system. Furthermore, constraints are
also included to guarantee the capacity of the weaker users fulﬁlling their target
data rates and it should be noted that this power allocation scheme is not
quality-of-service (QoS) guaranteed for the strong user because the minimum
rate requirement of the strong user is always accessibility in our algorithm.
Power Allocation
545

(ii)
Using the log-convex concept, and combined with the Lagrange dual function,
we develop a dual sub-gradient descent algorithm that solves the NOMA sum
capacity maximization problems. We also show that the proposed algorithm is
convergent in a few iterations.
(iii)
We present an approximation to the original optimization problem to reduce the
complexity of the proposed method. To provide more insight, we perform this
approximation speciﬁcally designed for the characteristics of log-convex.
Finally, numerical examples are presented to show the validity of the proposed
algorithm.
The rest of the paper is organized as follows: The system model for downlink
MISO-NOMA is outlined in Sect. 2. The based approach for the optimal power allo-
cation to maximize the sum capacity is investigated in Sect. 3. Simulation results are
presented in Sect. 4. Finally, Sect. 5 concludes the paper with some remarks and
discussed the future works to be considered.
2
System Model
In this section, we present a multiple-input single-output (MISO) downlink NOMA
transmission system. We consider that the base station (BS) in a cellular system is
equipped with N antennas and K single antenna users. The channel gain between the k-
th user and the BS is denoted by hk. It is assumed that hk ¼ dh
k gk, with dk being the
distance from the BS to the k-th user, where gk  CNð0; 1Þ and h is the pass loss
exponent. Furthermore, we assume that the distances from the users to the BS are ﬁxed
and users are equally spaced in the cellular system. We allocate powers for each user
based on their channel state information (CSI) and user who have better channel gain
will obtain lower power. Thus, the stronger users can detect the weaker users according
to SIC at the receiving terminals. Generally, the distances are sorted as d1  . . .  dk.
The channel gains of each user are sorted as jh1j2  . . .  jhkj2 and the powers of them
are then allocated as p1  . . .  pk, accordingly. Based on NOMA transmission pro-
tocol, the BS will send PK
k¼1
ﬃﬃﬃﬃﬃﬃﬃﬃ
pksk
p
to each user, where the message for the k-th user is
sk, and pk is the transmission power for user k. Therefore, the received signal at the k-th
user is given as:
yk ¼ hk
X
K
k¼1
ﬃﬃﬃﬃﬃ
pk
p
sk þ nk;
ð1Þ
Here nk denotes the additive noise and nk  CNð0; r2Þ. The k-th user signal to
interference plus noise ratio (SINR) is
SINRk ¼
jhkj2pk
jhkj2 PK
i¼k þ 1 pi þ r2 ;
ð2Þ
The SINR of the K-th user is
546
J. Wu et al.

SINRK ¼ jhKj2pK
r2
:
ð3Þ
The target rate for each user will be set as to achieve an acceptable QoS require-
ment. Therefore, for user k, we can deﬁne
log2ð1 þ SINRkÞ  Rtarget:
ð4Þ
This constraint provides a guarantee that all users can meet their QoS requirements.
3
Problem Formulation
In this section, a dual sub-gradient descent algorithm based on Lagrange dual function
is used to maximize the sum capacity of NOMA system. Firstly, we express the
optimization function as:
X
K
k¼1
Rk ¼
X
K
k¼1
log2ð1 þ SINRkÞ
ð5Þ
To solve the optimization problem (5), a mathematical model is developed
according to standardized Lagrange dual function as follows:
max P
K
k¼1
Rk
s:t:
C1 : Rk  Rtarget
C2 : 0  pk  P; k ¼ 1; 2. . .; K
C3 : P
K
k¼1
pk ¼ P
8
>
>
<
>
>
:
ð6Þ
In this optimization problem, constraint C1 represents the fact that the capacity of
each user must meet their corresponding QoS requirement, and constraint C2 reﬂects
the NOMA principle that the power allocation of the weak user must be greater than
that of the strong user. By deﬁning Ak as the upper bound of interference plus noise, we
can deﬁne that
jhkj2 XK
i¼k þ 1 pi þ r2 ¼ Ak:
ð7Þ
In NOMA, power allocation is of importance to enhance the achievable capacity of
each user and it is a non-convex optimization problem. Inspired from the results
presented in [10, 11], we devise a new power allocation algorithm named dual
sub-gradient descent in the NOMA system based on Lagrange dual function. The core
idea of Lagrange function is to embed constraint conditions into the objective function,
adding weighted sum of the constraint conditions to obtain an augmented objective
function. The Lagrange dual function is the minimum value of Lagrange function.
Power Allocation
547

Even though the Lagrange function has no lower bound on x, the value of dual function
is 1 [12]. The dual function is a kind of afﬁne function on x, so even if the original
question is non-convex, the dual function is still a concave function. Thus, on account
of using log-convex algorithm, it is obvious that maximizing the sum capacity in (5) is
equivalent to maximizing the objective function in (8).
max
X
K
k¼1
lnðjhkj2pkA1
k Þ
ð8Þ
Through logarithm transformation, we can deﬁne pk ¼ exk, Ak ¼ eyk and substitute
(8) into (6), then the mathematical model in (6) can be rewritten as:
max P
K
k¼1
lnðexkyk þ lnð hk
j
j2ÞÞ
s:t:
C1 : jhkj2eykxkð2Rtarget  1Þ  1  0
C2 : exkP1  1  0; k ¼ 1; 2. . .; K
C3 : P1 P
K
k¼1
exk  1 ¼ 0
8
>
>
<
>
>
:
ð9Þ
548
J. Wu et al.

Proving the optimization model in (9) is a convex optimization problem, amounts
to proving the objective function is being a convex function and all of the constraint
inequalities are being the convex set of these optimization variables. Since the left side
of these constraint inequalities in (9) are the sum of exponential functions after
transformation, we can conclude that these constraint inequalities are the convex sets of
optimization variables x and y. Meanwhile, the logarithmic function is a kind of
monotone increasing function and the objective function after variable substitution is a
convex function on x and y. Therefore, we can prove that the problem in (9) is a convex
optimization problem.
To solve the above-mentioned problem, we adopt the convex optimization algo-
rithm to obtain the globally optimal solution of this log-convex problem. Combined
with the characteristics of NOMA system, we draw Lagrange multipliers into each
communication link and assume that k; l; c denote the Lagrange dual variables of
formulae C1, C2 and C3, respectively. The corresponding Lagrange dual function is
shown as follows:
Lðx; y; k; l; cÞ ¼ 
X
K
k¼1
lnðexkyk þ lnð hk
j
j2ÞÞ
þ kk½jhkj2eykxkð2Rtarget  1Þ  1
þ lkðP1exk  1Þ þ ckðP1 X
K
i¼1
exk  1Þ
ð10Þ
Deﬁning v ¼ x; y; k; l; c
f
g to express the optimization variables and Lagrange dual
variables, we use grad rLðvÞ to iterate and update them until the algorithm converges.
Detailed steps are given in Algorithm 1.
In Algorithm 1, we ﬁx the total power of users and allocate it to each user according
to their CSI by deﬁning xk ¼ pk, yk ¼ hk
j
j2PK
i¼k þ 1 pi þ r2 to initialize xk and yk, where
k ¼ 1; 2; . . .; K. After the algorithm converges, we can obtain the optimal value of each
user’s power pk and interference plus noise Ak through inverse the transformation.
Finally, we use the Shannon Formula to compute each user’s capacity.
4
Simulation Results
In this section, we investigate the performance of the proposed method to the NOMA
power allocation problem. It should be noted that in simulations the user distances are
ﬁxed, we adopt the common path-loss model with pass-loss exponent h ¼ 2 for a
fading channel, where the mean value of each user’s channel is 0 and whose variance is
taken to be unity.
For comparison, we also consider OMA transmission as a reference scheme. In
[13], we studied a kind of power allocation scheme in the TDMA system which
requires K time slots to support K users, while NOMA can support K users during a
single time slot. Thus, the achievable rate of user k in OMA system is given as
Power Allocation
549

Rk;OMA ¼ aðkÞlog2ð1 þ bðkÞPjhkj2
aðkÞr2 Þ
ð11Þ
where aðkÞ and bðkÞ are the time division weighting coefﬁcient and power allocation
coefﬁcient for user k, respectively, P is the total power of all users and jhkj2 is the k-th
user effective channel gain. Then we assume that aðkÞ ¼ bðkÞ, which yields a modiﬁed
format as
Rk;OMA ¼ aðkÞlog2ð1 þ Pjhkj2
r2 Þ
ð12Þ
The sum rate of OMA system is obtained via full search to meet the user rate
requirements as well as to maximize the system capacity.
4.1
Convergence Veriﬁcation
In [5], the KKT algorithm needs 2NRNT þ 4 and 2NRNT þ 8 iterations to calculate the
value of minimum and maximum power coefﬁcients in two users scenario, where NR
and NT are the numbers of antennas equipped at the BS and mobile users, respectively.
In this paper, we set that NT ¼ 3 and NR ¼ 1, thus the iteration number is 24 with KKT
algorithm. In the proposed method, the calculation of the Lagrange dual variables
k; l; c, results of power allocation and rate for each user using less than 50 iterations for
the three users’ scenario. The results are shown in Figs. 1, 2, 3, 4 and 5, where the
update step a ¼ 0:1.
Figures 1, 2 and 3 depict the convergence features of Lagrange dual variables
k; l; c. In Fig. 1, the value of lamda3 is always be zero due to which always being
smaller than or equal to zero. In Fig. 3, the value of c in each communication link is the
same because c is the dual variable of formula C3 in (9), which is a constraint of sum
transmit power and is unrelated to an individual user power.
Figure 4 provides the characteristics of the convergent power allocation, where
UE1 is the weakest user and UE3 is the strongest user, and it is clearly depicting that
UE1 gets more power than others. UE 3 is allocated the lowest power, simultaneously.
In Fig. 5, it is shown that UE1 has the lowest user rate because it is the weakest user
and UE3 has the highest rate. Both of the power allocation and user rate have good
convergent property.
In Fig. 6, the solid lines give the shapes of the target function Rk, where Capacity1
represents user one’s capacity, and the remaining are the same. The dotted lines express
the value of dual function for each user, where Lower Bound 1 represents the lower
bound of dual function for user one. Since dual function gives the lowest bound of
Lagrange function, which is always smaller than the target function Rk. Therefore, we
can conclude that the solutions of our target function are in the feasibility region.
Furthermore, after those Lagrange dual variables k; l; c converging, we substituted
them into the original optimal model (9) and proved that all constraints are satisﬁed,
which means that the algorithm we proposed is exact in calculation.
550
J. Wu et al.

4.2
Comparison with OMA
In this subsection, we provide some simulation results to evaluate the system perfor-
mance of the proposed power allocation algorithm. All the simulations are conducted
by averaging 105 channel realizations to guarantee the accuracy of the proposed
algorithm.
Fig. 2. Convergence behavior of Lagrange dual variable l
Fig. 1. Convergence behavior of Lagrange dual variable k
Power Allocation
551

Figure 7 provides a comparison for the proposed NOMA system power allocation
algorithm and traditional OMA communication scheme by depicting the achievable
ergodic capacity of one user or the sum capacity of all users versus transmit signal to
noise ratio (TX-SNR), where NOMA-UE1 and NOMA-UE3 denote the capacities of
strongest user and the weakest user, respectively, achieved by the proposed NOMA.
Similarly, OMA-UE1 and OMA-UE3 represent those for the OMA system; where
NOMA Sum-Capacity and OMA Sum-Capacity represent the sum capacity in NOMA
and OMA system, respectively. Figure 7 demonstrates that the performance of the
NOMA system is better than the performance of an OMA system.
Fig. 4. Convergence behavior of user allocated powers
Fig. 3. Convergence behavior of Lagrange dual variable c
552
J. Wu et al.

Fig. 6. The lower bound of dual function compared with target function Rk.
Fig. 5. Convergence behavior of user rates
Power Allocation
553

5
Conclusions
This work proposed a dual sub-gradient descent algorithm based on Lagrange dual
function and approximation-function based approach to optimize the power allocation
for downlink NOMA systems. Numerical results illustrate that the proposed
approximation-function based method can signiﬁcantly speed up the convergence.
Simulation results show that the NOMA system based on the proposed power allo-
cation scheme outperforms OMA system by 20% – 25% in terms of sum capacity. It
must be stressed that the extension of this proposed scheme to other difﬁcult
non-convex optimization problems is straightforward.
Acknowledgment. This work was supported by Huawei Innovation Research Program, the key
project of the National Natural Science Foundation of China (No. 61431001), the 5G research
program of China Mobile Research Institute (Grant No. [2015] 0615), the open research fund of
National Mobile Communications Research Laboratory Southeast University (No. 2017D02),
Key Laboratory of Cognitive Radio and Information Processing, Ministry of Education (Guilin
University of Electronic Technology), the Foundation of Beijing Engineering and Technology
Center for Convergence Networks and Ubiquitous Services, and Keysight. The Corresponding
author is Dr. Xiaoming Dai.
References
1. Cover, T.M., Thomas, J.A.: Elements of Information Theory, pp. 155–183. Wiley, Tsinghua
University Press, New York, Beijing (1990)
2. Dai, X., Chen, S., Sun, S., et al.: Successive interference cancelation amenable multiple
access (SAMA) for future wireless communications. In: 2014 IEEE International Conference
on Communication Systems (ICCS), pp. 222–226. IEEE (2014)
Fig. 7. The ergodic capacity of one user or the sum capacity versus TX-SNR for the proposed
NOMA scheme compared with the OMA scheme.
554
J. Wu et al.

3. Dai, L., Wang, B., Yuan, Y., et al.: Non-orthogonal multiple access for 5G: solutions,
challenges, opportunities, and future research trends. IEEE Commun. Mag. 53(9), 74–81
(2015)
4. Oviedo, J.A., Sadjadpour, H.R.: A New NOMA approach for fair power allocation (2016).
arXiv preprint arXiv:1605.00390
5. Wang, C.L., Chen, J.Y., Chen, Y.J.: Power allocation for a downlink non-orthogonal
multiple access system. IEEE Wirel. Commun. Lett. 5(5), 532–535 (2016)
6. Choi, J.: On the power allocation for MIMO-NOMA systems with layered transmissions.
IEEE Trans. Wirel. Commun. 15(5), 3226–3237 (2016)
7. Fang, F., Zhang, H., Cheng, J., et al.: Energy efﬁciency of resource scheduling for
non-orthogonal multiple access (NOMA) wireless network. In: 2016 IEEE International
Conference on Communications, ICC 2016, pp. 1–5. IEEE (2016)
8. Hanif, M.F., Ding, Z., Ratnarajah, T., et al.: A minorization-maximization method for
optimizing sum rate in the downlink of non-orthogonal multiple access systems. IEEE Trans.
Signal Process. 64(1), 76–88 (2016)
9. Choi, J.: On the power allocation for a practical multiuser superposition scheme in NOMA
systems. IEEE Commun. Lett. 20(3), 438–441 (2016)
10. Tu, H.U., Jing, Z.H., Zhang, L., et al.: Power control algorithm based on convex
optimization in cognitive ad hoc networks. J. Air Force Eng. Univ. (2012)
11. Zhang, H., Jiang, C., Mao, X., et al.: Interference-limited resource optimization in cognitive
femtocells with fairness and imperfect spectrum sensing. IEEE Trans. Veh. Technol. 65(3), 1
(2015)
12. Boyd, S., Vandenberghe, L.: Convex Optimization. Cambridge University Press, New York
(2004)
13. Shariatpanahi, S.P., Khalaj, B.H., et al.: Power allocation scheme in time division multiple
access distributed multiple-input multiple-output interference channels. IET Commun. 7(5),
391–396 (2013)
Power Allocation
555

A Differential QAM Scheme for Uplink
Massive MIMO Systems
Peng Zhang1(&), Shuaishuai Guo2, and Haixia Zhang2
1 School of Computer Engineering, Weifang University,
Weifang, People’s Republic of China
sduzhangp@163.com
2 School of Information Science and Engineering,
Shandong University, Jinan, People’s Republic of China
guoshuai@mail.sdu.edu.cn, haixia.zhang@sdu.edu.cn
Abstract. An uplink massive MIMO system with a single antenna transmitter
and a single receiver with a large number of antennas is considered. For this
system we propose one new differential QAM scheme based on the division
operation. Specially, by designing one looking-up table, we provide the trans-
mitted differential QAM symbol generating process and the non-coherent
detection method, which is only based on two adjacent received signals, while
not using any instantaneous channel state information. At last the bit error rate
(BER) performance is simulated and the simulation results have shown that the
new proposed differential QAM scheme achieves much better performance than
the other differential QAM or differential amplitude phase shift keying (DAPSK)
schemes in uplink massive MIMO systems, especially for higher dimensional
modulation constellations.
Keywords: Differential modulation  QAM  Massive MIMO
1
Introduction
Recently, in order to improve the transmission performance and spectrum efﬁciency, an
increasing number of antennas are being used in the transmitter and receiver of wireless
communications. In fact, massive multiple input multiple output (MIMO) has become
the preferred technology for the development of 5G communications. By using hun-
dreds of antennas, a signiﬁcant antenna array gain can be achieved [1–4]. However, in
massive MIMO systems, channel estimation is really one challenging problem.
Because, the huge number of antennas greatly increases the complexity of the channel
estimation algorithms. Furthermore, if using pilots to perform channel estimation, there
may be no enough orthogonal pilot sequences available for use, and the pilot overhead
will also become an important issue. Aiming at the channel estimation problem, there
are two main research branches. One is trying to ﬁnd the channel estimation algorithms
with reduced pilot overhead, such as the recent literatures [5–7]. The other is to adopt
non-coherence detection approaches, such as [8–12].
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 556–567, 2018.
https://doi.org/10.1007/978-3-319-72823-0_51

In this paper, we only focus on the non-coherence schemes for the uplink massive
MIMO systems. Hereafter, let’s give a brief overview of the research results in this
area. In [8, 9], one non-coherent detection method for massive MIMO systems is
proposed based on the concept of autocorrelation-based detection by using differential
M-ary PSK constellation. In [10, 11], the non-coherent detection for uplink multi-users
massive MIMO systems is proposed based on the received average signal energy,
which need that the signal constellation for each user is different and should be further
designed. Obviously, these studies of [8–11] did not involve the cases of QAM
modulation. As we have known, in order to pursue higher spectrum efﬁciency, M-ary
QAM constellation is often used. Especially, for the uplink massive MIMO Systems,
the combined signal to noise ratio will be good enough to use QAM constellation.
Therefore, it is of great signiﬁcance to study the differential schemes based on QAM
constellation for uplink massive MIMO systems. The latest research in [12] has
addressed differential non-coherence detections in uplink massive MIMO systems by
utilizing the channel statistics information, wherein the differential quadrature ampli-
tude modulation (QAM) based on the ﬁnite group theory of [13] is adopted.
But it is really regrettable that there exists the detection performance ﬂoor, especially
when the number of receive antennas is not large enough, or higher dimensional QAM
constellation is adopted.
In order to overcome the shortcomings of the current schemes for uplink massive
MIMO systems, we proposed one new differential QAM scheme based on the division
operation. At the transmitter, the transmit symbol is derived from the QAM constel-
lation, and the next transmit symbol are generated by looking up one table based on the
last transmit symbol and current input source information. At the receiver, the differ-
ential non-coherence detection is only based on two adjacent received signals while
without considering any channel state information. The simulation results have shown
that the new proposed differential QAM scheme achieves much better performance
than the previous differential QAM scheme in [12] and other differential amplitude
phase shift keying (DAPSK) [13].
In this paper, the following notations are adopted. Upper and lower bold face letters
denote matrices and vectors, respectively. The superscripts T and H stand for the
transpose and Hermitian operators, respectively. x with the top mark , i.e., x, denotes
the conjugate of x. j ¼
ﬃﬃﬃﬃﬃﬃﬃ
1
p
. The capital letter of the Greek alphabet accounts for the
symbol set.
2
System Model and Differential Design for Uplink
Massive MIMO Systems
2.1
System Model
Here, the uplink massive MIMO system is considered which contains only one transmit
antenna at the mobile station and a large number of receive antennas at the base station.
In the following, N denotes the number of receive antennas. The transmitted symbols
are generated from one M-ary QAM constellation, which denoted as CM. hit denotes
the channel gain between the transmit antenna and the i-th receive antenna at the t-th
A Differential QAM Scheme for Uplink Massive MIMO Systems
557

time instant, which is supposed to be independent and identically distributed, and
satisfy the complex normal distribution with zero mean and one variance, i.e.,
hit  CNð0; 1Þ. And the channel vector at the t-th time instant is deﬁned as
ht ¼ ½h1t; h2t; . . .; hNt.
At the receiver, the received signals at two adjacent t-th and (t + 1)-th time instants
could be written as
yt ¼ stht þ nt
ð1Þ
yt þ 1 ¼ st þ 1ht þ 1 þ nt þ 1
ð2Þ
where st 2 CM and st þ 1 2 CM denote the transmit modulation symbols at the t-th and
(t + 1)-th time instant, respectively; yt ¼ y1t; y2t; . . .; yNt
½
, yt þ 1 ¼ y1t þ 1; y2t þ 1; . . .;
½
yNt þ 1 with yit, yit þ 1, i ¼ 1; 2; . . .; N denoting the received signal from the i-th receive
antenna at the t-th and (t + 1)-th time instant, respectively; nt ¼ n1t; n2t; . . .; nNt
½
,
nt þ 1 ¼ n1t þ 1; n2t þ 1; . . .; nNt þ 1
½
 with nit, nit þ 1, i ¼ 1; 2; . . .; N denoting the additive
white Gaussian noise (AWGN) with mean zero and variance r2 received from the i-th
receive antenna at the t-th and (t + 1)-th time instant, respectively. In order to achieve
the non-coherent signal detection without the need of channel estimation, here we
assume that the channel remains unchanged at the two adjacent time instants, i.e.,
ht ¼ ht þ 1.
2.2
Differential Design for Uplink Massive MIMO Systems
From (1) and (2), we have
yt þ 1yH
t þ 1
ytyH
t þ 1
¼ st þ 1ht þ 1 þ nt þ 1
ð
Þ st þ 1ht þ 1 þ nt þ 1
ð
ÞH
stht þ nt
ð
Þ st þ 1ht þ 1 þ nt þ 1
ð
ÞH
¼ st þ 1st þ 1ht þ 1hH
t þ 1 þ st þ 1ht þ 1nH
t þ 1 þst þ 1nt þ 1hH
t þ 1 þ nt þ 1nH
t þ 1
stst þ 1hthH
t þ 1 þ sthtnH
t þ 1 þst þ 1nthH
t þ 1 þ ntnH
t þ 1
ð3Þ
Note that, when the number of receive antennas is very large, it could be obtained
that
lim
N!1
sthtnH
t þ 1 þst þ 1nthH
t þ 1 þ ntnH
t þ 1
N
¼ 0
ð4Þ
lim
N!1
st þ 1ht þ 1nH
t þ 1 þst þ 1nt þ 1hH
t þ 1
N
¼ 0
ð5Þ
lim
N!1
nt þ 1nH
t þ 1
N
¼ r2
ð6Þ
Then, with the massive receive antennas as well as ht ¼ ht þ 1 (3) can be approx-
imately rewritten as
558
P. Zhang et al.

yt þ 1yH
t þ 1  Nr2
ytyH
t þ 1
 st þ 1st þ 1ht þ 1hH
t þ 1
stst þ 1hthH
t þ 1
¼ st þ 1
st
ð7Þ
According to the received signals (1) and (2), (7) has given one non-coherent signal
detection method. In fact, there is another non-coherent signal detection method as
follows.
yt þ 1yH
t
ytyH
t  Nr2  st þ 1stht þ 1hH
t
stsththH
t
¼ st þ 1
st
ð8Þ
Here, the transmitted differential constellation is denoted as CM with st 2 CM and
st þ 1 2 CM. For simplicity, we use a special mapping operator F ½  to denote differ-
ential operation. Specially, st þ 1 ¼ F dt; st
½
 with dt 2 CM denoting the transmit source
symbol, which carries the source information bits. On the basis of (7), our hope is to
ﬁnd one differential operator F ½  to achieve the source information detection directly
only based on two adjacent receive signals yt and yt þ 1 while without considering any
channel state information. That is to say, for the differential operator st þ 1 ¼ F dt; st
½
,
it should have one corresponding reverse differential operator denoted as dt ¼
F1 st þ 1; st
½
. According to (7), the reverse differential operator dt ¼ F1 st þ 1; st
½

should be based on the division operation st þ 1
st , i.e., the transmit source symbol dt should
be only determined by the division st þ 1
st . For the sake of clarity, we deﬁne the reverse
differential operation as dt ¼ F1 st þ 1; st
½
 ¼ F1 st þ 1
st
h
i
.
It must be noted that for the traditional differential M-ary PSK constellation [8, 9],
st þ 1 ¼ F dt; st
½
 ¼ dt  st. However, for the new differential QAM constellation st þ 1 ¼
F dt; st
½
 will represent a more general mapping operation instead of the multiplication
operation.
In order to ensure the correct detection, the operation dt ¼ F1 st þ 1; st
½
 ¼
F1 st þ 1
st
h
i
should satisfy the following properties for any complex modulation symbols
st 2 CM, s0
t 2 CM, st þ 1 2 CM and s0
t þ 1 2 CM.
If st þ 1
st
¼ s0
t þ 1
s0
t
; F1 st þ 1
st


¼ F1 s0
t þ 1
s0
t


:
ð9Þ
If st þ 1 6¼ s0
t þ 1; F1 st þ 1
st


6¼ F1 s0
t þ 1
st


:
ð10Þ
(9) means that the same division results will generate the same differential detection
results. While (10) expresses that with the same t-th transmit symbol st, different input
source symbols will produce different (t + 1)-th transmit symbols. At this point, as long
as we can ﬁnd a mapping operator st þ 1 ¼ F dt; st
½
 to meet (9) and (10), then we can
achieve the non-coherent detection on the base of (7).
A Differential QAM Scheme for Uplink Massive MIMO Systems
559

In the following section, we will present the detailed differential QAM design
process based on (7), (9) and (10).
3
Differential QAM Design for Uplink Massive MIMO
Systems
3.1
Differential QAM Design
For
the
sake
of
clarity,
M-ary
QAM
constellation
CM
are
listed
as
CM ¼ fg1; g2; . . .; gMg. Furthermore, one looking-up table TM with M rows and M
columns is constructed to express the differential operation with the properties of (9)
and (10), and TMðu; vÞ stands for the element of the u-th, u ¼ 1; 2; . . .; M row and the v-
th, v ¼ 1; 2; . . .; M column of TM. And then, the reverse differential operator dt ¼
F1 st þ 1
st
h
i
could be represented by TMðu; vÞ ¼ gx with st þ 1 ¼ gu, st ¼ gv and dt ¼ gx,
i.e., gx ¼ F1 gu
gv
h i
. With the help of such deﬁnitions, the differential properties (7), (9)
and (10) could be further rewritten as
TMðu; vÞ ¼ i; if F1 gu
gv


¼ gi
ð11Þ
TMðu; vÞ ¼ TMðu0; v0Þ; if gu
gv
¼ gu0
gv0
ð12Þ
TMðu; vÞ 6¼ TMðu0; vÞ; if gu 6¼ gu0
ð13Þ
According to (13), we could know that each symbol of CM ¼ fg1; g2; . . .; gMg will
appear in each column of TM and will appear only once. Therefore, for given gi, there
are a total of M different combinations of gu; gv
f
g satisfying F1 gu
gv
h i
¼ gi. Obviously,
these M different divisions should be as close as possible in order to combat the
incorporated noise interference in the transmission process. In other words, if the two
different while very close divisions mapped to different source symbols, the result is
very small noise pollution may cause the demodulation error. We deﬁne this design
idea as the nearest group theory.
In order to facilitate the practical design process, a heuristic algorithm is designed
based on the nearest group theory. Firstly, deﬁne one set containing all the division
elements gu
gv, i.e., Q ¼
gu
gv jgu 2 CM; gv 2 CM
n
o
. It should be noted that for two different
pairs fgu; gvg and fgu0; gv0g with the same division result, i.e., gu
gv ¼ gu0
gv0, they will be
consider one element in Q. Correspondingly, one counting number set is deﬁne as
N ¼ n gu=gv
ð
Þjgu 2 CM; gv 2 CM
f
g with its element n gu=gv
ð
Þ denoting the total
number of fgu; gvg with the same division result. We further deﬁne one counting vector
c ¼ c1; c2; . . .; cn
½
 with ci; i ¼ 1; 2; . . .; M denoting the number of TMðu; vÞ ¼ i in the
560
P. Zhang et al.

looking-up table TM, which will be equal to M after ﬁnishing the construction of TM.
Deﬁne the group set Xgi ¼
gu
gv F1 gu
gv
h i
¼ gi;

gu 2 CM; gv 2 CM
n
o
.
Without loss of generality and for simplicity, we deﬁne g1 ¼ e ¼ 1, and then the
heuristic algorithm to design the reverse differential table TM corresponding to (11) is
presented as follows.
Step 1: Set ci ¼ 0 and Xgi ¼ ;, i ¼ 1; 2; . . .; M with ; denoting empty set. Let
TMðu; vÞ ¼ 0 with 0 denoting an invalid symbol; F1 gu
gv
h i
¼ 0 denotes that the
division gu
gv has not been assign one valid differential symbol.
Step 2: Examine symbol pair fgu; gvg one by one. If gu
gv ¼ gi, let TMðu; vÞ ¼ i,
ci ¼ ci þ 1 and Xgi ¼ Xgi [ gi
f g, i.e., F1 gu
gv
h i
¼ gi.
Step 3: Find one valid gu0
gv0 and its nearest group set Xgi, do differential symbol
assignment for gu0
gv0 6¼ gi.
(A) Divide the division set Q ¼
gu
gv jgu 2 CM; gv 2 CM
n
o
into two subset, one is QY
with its elements having been assigned one differential symbol successfully, the
other is QN with its elements having not completed assignment. Correspondingly,
the number set N ¼ n gu=gv
ð
Þjgu 2 CM; gv 2 CM
f
g is also divided into two sub-
sets with NY and NN corresponding to QY and QN, respectively.
(B) For each gu
gv 2 QN, determine the nearest group set Xgi close to gu
gv, and calculate the
minimum distance between gu
gv and the nearest group set Xgi as follows:
Xgi ¼ arg
min
gx2CMMcx  n gu=gv
ð
Þ
min
ay2Xgx
gu
gv
 ay




ð14Þ
d gu
gv


¼
min
gx2CMMcx  n gu=gv
ð
Þ
min
ay2Xgx
gu
gv
 ay




ð15Þ
In (14), the condition M  cx  n gu=gv
ð
Þ means that the total number of fgu; gvg
with the same division result (n gu=gv
ð
Þ) should be no more than the number of
symbol pair fgu; gvg that can be accepted by Xgx(M  cx).
(C) Find one valid gu0
gv0 2 QN and its nearest group set Xgi by examining (14) and (15),
specially,
gu0
gv0 ; Xgi


¼ arg min
gu
gv2QN
min
gx2CMMcx  n gu=gv
ð
Þ
min
dy2Xgx
gu
gv
 dy






ð16Þ
Which further satisfy the following condition (17).
Deﬁne c0 ¼ c0
1; c0
2; . . .; c0
n

	
¼ c ¼ c1; c2; . . .; cn
½
, and update c0
i ¼ ci þ n gu0=gv0
ð
Þ.
Deﬁne N0
N ¼ NN
n gu0=gv0
ð
Þ
f
g
j
, i.e., N0
N is formed by deleting element n gu0=gv0
ð
Þ from
NN. And then, for all elements np 2 N0
N; p ¼ 1; 2; . . .; PN with PN denoting the total
A Differential QAM Scheme for Uplink Massive MIMO Systems
561

element number of N0
N, we should be able to ﬁnd PN elements c
^
p; p ¼ 1; 2; . . .; PN in
c0 ¼ c0
1; c0
2; . . .; c0
n

	
to satisfy
M  c
^
p  np
ð17Þ
Condition (17) can ensure the convergence of the algorithm.
(D) For the valid selection
gu0
gv0 ; Xgi
h
i
, by examining symbol pair fgu; gvg one by
one, if gu
gv ¼ gu0
gv0, let TMðu; vÞ ¼ i, i.e., F1 gu
gv
h i
¼ gi. After ﬁnishing assignment, update
ci ¼ ci þ nðgu0=gv0Þ and Xgi ¼ Xgi [
gu0
gv0
n
o
.
Return to step 3 to re-execute until all elements of table TM are assigned
successfully.
3.2
Simpliﬁed Differential Design for Square QAM
In this sub-section, we mainly consider a square M-ary QAM constellation with
M ¼ 2m, just because square M-ary QAM constellation has a wide range of practical
applications, and has very good symmetrical properties. From the above analysis of the
nearest group theory we will conclude that these symmetrical properties are of great
signiﬁcance to simplify the differential operation design.
As we have known, for a square M-ary QAM constellation with M ¼ 2m, if
gx 2 CM, we have jgx 2 CM, gx 2 CM and jgx 2 CM. It is not difﬁcult to know that
the division gu
gv also have these symmetrical properties. Therefore, it is reasonable to
assume that the differential operation also have these symmetrical properties, speciﬁ-
cally, we have
F1 gu
gv


¼ gx; F1 j gu
gv


¼ jgx;
F1  gu
gv


¼ gx; F1 j gu
gv


¼ jgx
ð18Þ
Therefore, in the heuristic algorithm to design the differential table TM, we could
only focus on a quarter of division elements to complete all division elements
assignment. More details could be found in the following design examples.
3.3
Differential 16QAM Design Example
Here, the 16QAM constellation set C16 is deﬁned as
C16 ¼ fg1 ¼ e ¼ 1; g2 ¼ 3;
g3 ¼ 2 þ 1j; g4 ¼ 2  1j;
g5 ¼ jg1;
g6 ¼ jg2;
g7 ¼ jg3;
g8 ¼ jg4;
g9 ¼ g1;
gA ¼ g2;
gB ¼ g3;
gC ¼ g4;
gD ¼ jg1;
gE ¼ jg2;
gF ¼ jg3;
gG ¼ jg4g
ð19Þ
562
P. Zhang et al.

herein, A = 10, B = 11, C = 12, D = 13, E = 14, F = 15, G = 16 .
As shown in Fig. 1, the mark “	” denotes the symbols of 16QAM set C16, and the
mark “
” accounts for the division results of gu
gv with gu 2 C16; gv 2 C16.
Based on symmetrical properties of Fig. 1, we only focus on a quarter of plane
located between the two straight lines y ¼ x with x [ 0. In which there are only 4
baseband 16QAM symbols fg1 ¼ e ¼ 1; g2 ¼ 3; g3 ¼ 2 þ 1j; g4 ¼ 2  1jg and 13
division symbols. And hereby the design complexity is really very small. Once one
division symbol in the focus area has completed assignment, we could use (18) to
realize the other symmetric division symbols’ assignment.
By carry out the heuristic algorithm presented in sub-Sect. 3.1, the reverse differ-
ential looking-up table T16 is constructed, as demonstrated in Table 1.
It should be noted that Table 1 is the reverse differential looking-up table corre-
sponding to F1 gu
gv
h i
¼ gx. In the practical applications one differential looking-up table
corresponding to st þ 1 ¼ F dt; st
½
 could be also constructed according to F1 gu
gv
h i
¼ gx,
which will be used to accelerate the transmitted differential symbols generation.
3.4
Differential 64QAM Design Example
Here, the 64QAM constellation set C64 is deﬁned as
C64 ¼ fC1
16; j  C1
16; 1  C1
16; j  C1
16g
ð20Þ
Fig. 1. 16QAM constellation (“	”) and gu
gv results (“
”)
A Differential QAM Scheme for Uplink Massive MIMO Systems
563

with
C1
16 ¼ fg1 ¼ e ¼ 1; g2 ¼ 3; g3 ¼ 5; g4 ¼ 7;
g5 ¼ 2 þ 1j, g6 ¼ 2  1j, g7 ¼ 4 + 1j, g8 ¼ 4  1j,
g9 ¼ 6 þ 1j, gA ¼ 6  1j, gB ¼ 3 + 2j, gC ¼ 3  2j,
gD ¼ 5 þ 2j, gE ¼ 5  2j, gF ¼ 4 + 3j, gG ¼ 4  3jg
ð21Þ
The reverse differential looking-up table for 64QAM is constructed as shown in
Table 2. It should be noted that Table 2 only provides a part of elements, just because
other elements could be derived from these elements according to (18). For example,
F1 g40
g18


¼ F1 1  g8
j  g2


¼ F1 j g8
g2


¼ jF1 g8
g2


:
4
Simulation Results
In this section, the BER (Bit Error Rate) performances of the new differential 16QAM
and 64QAM are simulated over Rayleigh fading channels. Gray mapping is adopted for
the transmitted 16QAM and 64QAM constellations. The simulation results are shown
in Figs. 2 and 3, in which N denotes the number of receive antennas. “Old DQAM”,
“New DQAM” and “DAPSK” represent the differential QAM schemes provided in
[12], the new proposed differential QAM schemes and the differential amplitude phase
shift keying (DAPSK) schemes [12, 14], respectively.
Table 1. Reverse differential looking-up Table (16QAM).
1
2
3
4
5
6
7
8
9
A B C D E F
G
1
1
4
2
2
D G E E 9
C A A 5
8
6
6
2
2
1
3
3
E D F
F
A 9
B B 6
5
7
7
3
3
2
1
8
F
E D 4
B A 9
G 7
6
5
C
4
4
3
G 1
G F
C D C B 8
9
8
7
4
5
5
5
8
6
6
1
4
2
2
D G E E 9
C A A
6
6
5
7
7
2
1
3
3
E D F
F
A 9
B B
7
7
6
5
C 3
2
1
8
F
E D 4
B A 9
G
8
8
7
4
5
4
3
G 1
G F
C D C B 8
9
9
9
C A A 5
8
6
6
1
4
2
2
D G E E
A A 9
B B 6
5
7
7
2
1
3
3
E D F
F
B B A 9
G 7
6
5
C 3
2
1
8
F
E D 4
C C B 8
9
8
7
4
5
4
3
G 1
G F
C D
D D G E E 9
C A A 5
8
6
6
1
4
2
2
E E D F
F
A 9
B B 6
5
7
7
2
1
3
3
F
F
E D 4
B A 9
G 7
6
5
C 3
2
1
8
G G F
C D C B 8
9
8
7
4
5
4
3
G 1
564
P. Zhang et al.

From Fig. 2 we could know that new designed differential 16QAM is superior to
DAPSK schemes [12, 14]. Furthermore, our design method could be easily extend to
higher dimensional modulation constellations, such as 64QAM, which is really difﬁcult
for the traditional DAPSK schemes.
Table 2. Part of reverse differential looking-up Table (64QAM).
1
2
3
4
5
6
7
8
9
A
B
C
D
E
F
G
1
1
11 16 16 12 13 14 14 16 16 13 13 16 16 12 13
2
2
1
7
9
2
2
2
2
11 11 7
7
7
7
10 10
3
3
12 1
4
6
5
3
3
3
3
14 14 5
5
14 15
4
4
8
6
1
11 11 10 10 2
2
2
2
9
9
15 14
5
5
4
13 14 1
30 6
11 12 15 3
25 12 30 7
28
6
6
5
12 15 63 1
11 6
15 12 57 3
62 12 61 7
7
7
2
2
7
3
3
1
7
5
7
4
32 2
10 6
27
8
8
3
3
8
4
4
7
1
7
5
64 4
10 2
59 6
9
9
13 4
2
7
16 9
12 1
6
8
15 4
13 8
32
A 10 15 5
3
16 7
12 9
6
1
15 8
13 4
64 8
B 11 9
10 12 13 24 4
29 10 13 1
21 6
27 2
21
C 12 10 11 13 56 12 61 4
13 10 53 1
59 6
53 2
D 13 6
8
5
14 25 5
15 4
9
11 28 1
15 3
25
E 14 7
9
6
57 15 15 5
9
4
60 11 15 1
57 3
F
15 14 15 10 10 22 8
32 8
30 6
26 3
24 1
20
G 16 16 14 11 53 10 64 8
62 8
58 6
56 3
52 1
Fig. 2. BER performance of differential 16QAM and 16DAPSK
A Differential QAM Scheme for Uplink Massive MIMO Systems
565

From Figs. 2 and 3, we also see that the new designed differential QAM schemes
completely eliminates the performance ﬂoor compared with the differential QAM
schemes provided in [12, 13]. Especially, for higher dimensional modulation con-
stellations, such as 64QAM, the new designed differential QAM schemes are greatly
superior to that of the differential 64QAM schemes presented in [12, 13] and the latter
has very serious performance ﬂoor. This result proves that the new differential QAM
schemes are very suitable for the applications in the next generation wireless
communications.
5
Conclusions
In this paper, a new differential QAM scheme is proposed for the uplink massive MIMO
systems. Specially, one looking-up table is constructed based on the division operation
between two transmitted QAM symbols, which is used to generate the transmitted
differential QAM symbols at the transmitter and to carry out the non-coherent detection
at the receiver. The new differential detector only uses two adjacent received signals
without requiring any channel state information. And hereby, there is no so-called
phenomena of performance ﬂoor, while the performance ﬂoor really exists and may by
very harmful for the newly presented differential QAM schemes in [12]. Furthermore,
the new differential QAM schemes provides a better ﬂexibility compared with the
traditional DAPSK schemes, especially for higher dimensional constellations. Taken
together, the new differential QAM schemes are especially suitable for massive MIMO
systems to achieve great performance while without the requirement of large amounts of
pilots and complicated channel estimations.
Fig. 3. BER performance of differential 64QAM.
566
P. Zhang et al.

Acknowledgment. This research was supported by National Natural Science Foundation of
China (No. 61471269, 61622111, 61671278, 61501461, 61601269), Doctoral Scientiﬁc
Research Fund Project of Weifang University (No. 2014BS12), Weifang Science and Tech-
nology Development Plan Project (No. 2014GX021), and Shangdong Province Young and
Middle-Aged Scientists Research Awards Fund (No. BS2013DX040).
References
1. Xiang, G., Edfors, O., Rusek, F., Tufvesson, F.: Massive MIMO performance evaluation
based on measured propagation data. IEEE Trans. Wirel. Commun. 14(7), 3899–3911
(2015). IEEE Press, New York
2. Jin, S., Liang, X., Wong, K.-K., Gao, X., Zhu, Q.: Ergodic rate analysis for multipair
massive MIMO two-way relay networks. IEEE Trans. Wirel. Commun. 14(3), 1480–1491
(2015). IEEE Press, New York
3. Lu, L., Li, G., Swindlehurst, A.L., Ashikhmin, A., Zhang, R.: An overview of massive
MIMO: beneﬁts and challenges. IEEE J. Sel. Top. Sig. Process. 8(5), 742–758 (2014). IEEE
Press, New York
4. Bogale, T.E., Le, L.B.: Massive MIMO and Millimeter Wave for 5G Wireless HetNet:
Potentials and Challenges. IEEE Vehicular Technology Magazine (to appear)
5. Wen, C.K., Jin, S., Wong, K.K., Chen, J.C.: Channel estimation for massive MIMO using
gaussian-mixture Bayesian learning. IEEE Trans. Wirel. Commun. 14(3), 1356–1368
(2015). IEEE Press, New York
6. Ngo, B.Q., Larsson, E.G.: EVD-based channel estimation in multicell multiuser MIMO
systems with very large antenna arrays. In: IEEE International Conference on Acoustics,
Speech and Signal Processing, pp. 3249–3252. IEEE Press, New York (2012)
7. Wang, R., Chen, Y., Tan, H.: Data-assisted channel estimation for uplink massive MIMO
systems. In: IEEE Global Communications Conference, pp. 3766–3771. IEEE Press,
New York (2014)
8. Schenk, A., Fischer, R.F.H.: Noncoherent detection in massive MIMO systems. In:
International ITG Workshop on Smart Antennas, pp. 1–8. IEEE Press, New York (2013)
9. Yammine, G., Fischer, R.F.H.: Soft-decision decoding in noncoherent massive MIMO
systems. In: International ITG Workshop on Smart Antennas, pp. 53–59. IEEE Press,
New York (2016)
10. Manolakos, A., Chowdhury, M., Goldsmith, A.J.: Constellation design in noncoherent
massive SIMO systems. In: IEEE Global Communications Conference, pp. 3690–3695.
IEEE Press, New York (2014)
11. Chowdhury, M., Manolakos, A., Goldsmith, A.J.: Design and Performance of Noncoherent
Massive SIMO Systems. In: Annual Conference on Information Sciences and Systems,
pp. 1–6. IEEE Press, New York (2014)
12. Kong, D., Xia, X.-G., Jiang, T.: A differential QAM detection in uplink massive MIMO
systems. IEEE Trans. Wirel. Commun. 15(9), 6371–6383 (2016)
13. Egri, R.G., Homgan, F.A.: A ﬁnite group of complex integers and its application to
differentially coherent detection of QAM signals. IEEE Trans. Inf. Theory 40(1), 216–219
(1994). IEEE Press, New York
14. Adachi, F., Sawahashi, M.: Decision feedback differential detection of differentially encoded
16APSK signals. IEEE Trans. Commun. 44(4), 416–418 (1996). IEEE Press, New York
A Differential QAM Scheme for Uplink Massive MIMO Systems
567

REFF: REliable and Fast Forwarding
in Vehicular Ad-hoc Network
Daxin Tian1,4,5,6(&), Ziyi Dai1,4, Kunxian Zheng1,4, Jianshan Zhou1,4,
Xuting Duan1,4, Peng Guo2, Hui Rong2, Wenyang Wang2,
and Haijun Zhang3
1 Beijing Advanced Innovation Center for Big Data and Brain Computing,
Beihang University, XueYuan Road No. 37, Beijing 100191, China
dtian@buaa.edu.cn
2 China Automotive Technology and Research Center,
Automotive Engineering Research Institute,
East Xianfeng Road No. 68, Tianjin 300300, China
3 School of Computer and Communication Engineering,
University of Science and Technology Beijing,
XueYuan Road No. 30, Beijing 100083, China
4 Beijing Key Laboratory for Cooperative Vehicle Infrastructure Systems
and Safety Control, School of Transportation Science and Engineering,
Beihang University, XueYuan Road No. 37, Beijing 100191, China
5 Jiangsu Province Collaborative Innovation Center of Modern Urban
Trafﬁc Technologies, Si Pai Lou. 2, Nanjing 210096, China
6 Key Lab of Urban ITS Technology Optimization and Integration,
The Ministry of Public Security of China, Hefei 230088, China
Abstract. Vehicular Ad-Hoc Network (VANET) has emerged as an increas-
ingly dominant technology for future connected vehicle and vehicular networks,
where the focus of the development of VANET lies in the standardization of
message transmission and dissemination via multi-hop broadcasting. However,
the current communication protocols concerning VANET face many challenges,
including data ﬂooding and collision, transmission delay and other problems.
Most of the challenges are closely related to next-hop selection. Therefore, this
paper proposes a new routing protocol named REliable and Fast Forwarding
(REFF) to optimize the selection of nodes in VANET. In this protocol, node
ﬁltering and node evaluation are two main steps. Distance between previous
node and candidate node, relative velocity between previous node and candidate
nodes, included angle between direction of target node’s velocity and candidate
node’s velocity and transmission power of candidate node are adopted as
indexes to help select a speciﬁc node as the next hop using Technique for Order
of Preference by Similarity to Ideal Solution (TOPSIS). By using this technique,
the number of candidates as next-hop is largely reduced, avoiding the data
ﬂooding and resulting transmission relay. In addition, simulations based on
experiments are done to verify the feasibility. The results show that message
achieves a faster and more reliable transmission using REFF.
Keywords: VANET  Multi-hop broadcasting  Next-hop selection  TOPSIS
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 568–580, 2018.
https://doi.org/10.1007/978-3-319-72823-0_52

1
Introduction
Fifth Generation Mobile Networks (5G) has emerged as a more advanced way in
telecommunications with faster speed, broader coverage and higher capacity. In recent
years, 5G have also extended its use in the ﬁeld of connected vehicles [4]. 5G serve as
an important kind of networking wireless technology in Vehicular Ad-hoc Network
(VANET). Cooperative transmission is an effective approach for vehicular networks to
improve wireless transmission capacity and reliability in the ﬁfth-generation small-cells
networks, as denser and smaller cells are expected to provide a higher transmission rate
for users [6, 19]. 5G technologies also propose a device-to-device (D2D) approach for
direct and short-range communications between vehicles since the data transmission is
easily inﬂuenced by surrounding environment. D2D communications can also enhance
the communication capacity by allowing nearby devices to establish links, thusly
accommodating a large number of data-heavy mobile devices and multiapplication
services to face the challenge of dealing with an ever-increasing demand of mobile
trafﬁc [18]. Therefore, 5G can be adopted as a critical network technology supporting
VANET.
Vehicular Ad-hoc Network (VANET) is an embranchment of Mobile Ad-hoc
Network (MANET), which is the spontaneous establishment of a wireless network for
the purpose of real-time data transmission and exchange in the ﬁelds of vehicle net-
works. In recent years, Vehicular Ad-hoc Network (VANET) has become an
increasingly important component in Connected Vehicle in Intelligent Transportation
System (ITS). Communication in ITS consists of two parts, the Vehicle-to-Vehicle
(V2V)
communication
and
the
Vehicle-to-Infrastructure
(V2I)
communication.
VANET is mainly adopted as the paradigm in V2V communication. In the future,
V2V, V2I and D2D network are expected to be interworking as the integrated network
so as to support Intelligent Transportation Space (ITSP) and Intelligent Transportation
System-Smart Grid (ITS-SG) [14].
In order to realize the real-time transmission of data and information in VANET,
two essential conditions are required in V2V network; ﬁrstly, every vehicle is required
to be equipped with on-board wireless network devices and multiple sensors, such as
GPS, Bluetooth, monocular camera and radar, secondly, one type of networking
wireless technology is needed as the basis for VANET. One type of prominent tech-
nology is Dedicated Short Range Communication (DSRC), under which 75 MHz in
5.9 GHz band in IEEE 802.11p is allocated to the ﬁelds of vehicular network. In
addition, cellular technologies can also be used as the basis, both the Long-term
Evolution Vehicle (LTE-V) and Fifth Generation Mobile Networks (5G) are promoted,
while 5G achieves a faster speed, broader coverage, higher capacity and reduced
latency [1].
With the V2V technology, a safer and well-organized trafﬁc environment is pre-
sumed. Several speciﬁc scenarios and applications have been proposed, including
reliable trafﬁc density estimation and the detection and avoidance of forward obstacle
and approaching emergency vehicle warning [7]. Vehicle chain cooperative collision
avoidance (CCA) systems or cooperative adaptive cruise control (CACC) are typical
safety applications of inter-vehicle communications (IVC) [15]. As VANET develops,
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
569

some non-safety applications are also expected, mostly aiming at the optimization of
trafﬁc ﬂow like platooning and some additional entertainment.
In VANET, the most noticeable characteristic is its high changeability and insta-
bility, which make it different from the traditional MANET. The velocity of nodes in
VANET can achieve up to 40 [m/s] while the average velocity of nodes in traditional
MANET is 5 [m/s] [10]. Due to the high mobility of vehicles in VANET, the topology
network is highly active and changing all the time [20]. And in a typical vehicular
environment, the number of vehicles is always huge, which can lead to congestion in
trafﬁc environment, making the data transmission and rebroadcasting even more
complex [2]. In addition, the vehicular networks may not have connections all the time.
Furthermore, large numbers of vehicles are usually restricted to a certain spatial pattern.
These reasons lead to the failing of some protocols in MANET to be applied in
VANET [16]. Thusly, the study and performance evaluation of routing protocols in
vehicular networks are of great importance [11]. Among many aspects, the study of
VANET performance is critical in evaluating the performance in V2V communication;
experts and professionals have also proposed a series of methods working on vehicular
networks such as stochastic learning model, environment-speciﬁc propagation model
and etc. [5, 8, 9, 21].
In VANET, multi-hop broadcasting is adopted as a primary method to realize the
transmission of messages. Since the messages in the domain of vehicular network are
mostly related to safety ﬁelds, it is required that the transmission of messages to related
vehicles has to be punctual and allows little delay and few mistakes. Considering the
process of message transmission, next-hop selection is a key section. However, the
current routing protocols of VANET still face many problems in next-hop selection.
The most prominent one is that due to the large number and high density of vehicles
within an area, the nodes for rebroadcasting messages can be plentiful, which can cause
several undesirable scenarios, i.e. (i) data ﬂooding, which will lead to the chaotic
collisions in data transmission and further lead to the delay and latency of safety-related
messages, (ii) repetition of message transmission; a node is likely to implement an
unnecessary repeated transmission while a neighboring node has already received and
subsequently rebroadcasted the message and (iii) instability in rebroadcasting; stability
and reliability are compromised in message transmission in VANET in order to realize
the longest distance of a single transmission, connectivity is less stable as the distance
between two nodes increases. Other problems are related to the different level of
network capacity and transmission power in each vehicle.
In this paper, we bring forward a new routing protocol named REliable and Fast
Forwarding (REFF), targeting at solving the redundancy of nodes as next hop and
increasing the level of stability in message rebroadcasting in VANET. This routing
protocol optimizes the total multi-hop broadcasting process by reducing the nodes in
message transmission, therefore avoiding the data ﬂooding and collision. Before a
vehicle initiates its message transmission to the next hop, two steps are proceeded.
A node-ﬁltering step and a calculation step are proceeded by the vehicle to wipe out
redundant unnecessary nodes and evaluate the suitability of the rest potential node to be
chosen as the next hop. Then the suitability of every potential node as the next hop is
ranked in descending order, and the node that ranks the top will be ﬁnally selected as
the exclusive next-hop in the vicinity, thusly reducing the number of nodes used in a
570
D. Tian et al.

complete message transmission from the original node to the target node. We name this
type of node as the Optimal Node (ON). This preliminary work is indeed a
decision-making process, which plays an essential role in the relay selection in
cooperative communication considering the selﬁsh and greedy behavior of users in
reality [13].
We organize this paper as follows. In Sect. 2, we introduce REliable and Fast
Forwarding (REFF), containing the two major phases in next-hop selection, indexes
we choose as evaluation criteria and the process of evaluation using TOPSIS. In
Sect. 3, we present and assess the performance of REFF by adopting it in different
trafﬁc scenarios; both the simulation environment and simulation results are shown,
conﬁrming the feasibility and advancement of this routing protocol. In Sects. 4, con-
clusions are drawn and outlooks are put forward.
2
REliable and Fast Forwarding
In a real trafﬁc environment, there are multiple scenarios in which sudden change in the
velocity of trafﬁc ﬂow can happen. Assume a situation where an accident happened in
the front of a trafﬁc ﬂow, due to hindrance of drivers’ eyesight in the rear,message
notifying the occurrence of the trafﬁc accident in the front should reach vehicles in the
back in time to function in these two way, i.e., (i) to remind drivers in the rear to
decelerate the vehicle to avert severe brakes and collisions and (ii) to notify drivers in
the rear of the accident to spare them some time to choose and change to an alternative
path to avoid heavier congestion in the accident spot. By adopting the REFF method,
situations like this can be efﬁcaciously assuaged.
In REFF, we leverage on several preconditions, i.e. (i) vehicles driving in the lanes
come in a Poisson Distribution, (ii) all the vehicles have a constant transmission range
and (iii) all vehicles are installed with GPS and sensors to acquire basic information
about positions and routes.
2.1
Node Filtering
In a common situation where a vehicle needs to transmit the Cooperative Awareness
Message (CAM) to designated vehicles, the transmission is unidirectional in most
cases. Since the transmission range of vehicles is circular, nodes that are unnecessary in
this unidirectional transmission should be ﬁltered out primarily, this step can effectively
prevent data ﬂooding and redundant transmission, which also help to save some net-
work capacity. We ﬁlter these redundant nodes out by drawing two circles, i.e. (i) circle
A with the position of the original vehicle (which is ready to rebroadcast the message to
the next node) as the center and its transmission length as the radius, and (ii) circle B
with the position of the target vehicle as the center and distance between the original
vehicle and the target vehicle as the radius. Then the overlapping range of these two
circles are determined and chosen, we deﬁne this overlapping range as valid vicinity
(VV) in this paper. Every node in the valid vicinity qualiﬁes as a potential next hop for
the rebroadcasting of messages. We deﬁne these nodes as candidate node (CN).
A further next-hop selection and decision is based on the completion of this
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
571

node-ﬁltering phase. After a vehicle ﬁnishes one next-hop selection, the node selected
becomes the new ‘original’ vehicle, initiating a new round of next-hop selection by
using the same node-ﬁltering method, drawing circles with new center and new radius
and determining new valid vicinity.
In a typical two-way four-lane highway as shown in Fig. 1, we assume the source
node (where the message transmission initiates) and destination node (where the
message transmission terminates) of a complete transmission to be ﬁxed in our sim-
ulation environment. The vehicle in blue is a message carrier, preparing to select its
next hop and rebroadcast the message to it. By using node-ﬁltering method, we can
draw the cross range of these two circles and deﬁne it as valid vicinity (VV) in this
paper. Vehicles inside this valid vicinity (which are in red) are identiﬁed as candidate
nodes. After a next-hop selection by using TOPSIS, optimal node can be determined
and message can be rebroadcasted to the target node.
2.2
Next-Hop Selection Using TOPSIS
After the primary node-ﬁltering phase, the original vehicle will ﬁrstly send a
Request-To-Broadcast (RTB) message to all candidate nodes and establish a link with
all candidate nodes in the valid vicinity, so that basic information about the candidate
nodes can be achieved to make further evaluation and comparison. At this time,
cooperative awareness message (CAM) packets are at state of readiness to be trans-
mitted. But the original vehicle preparing to rebroadcast CAM is required to execute a
calculating process ﬁrstly to evaluate the suitability of every candidate node for
potential rebroadcasting, then the matching degree and performance level of every node
are ranked in descending order. Finally, the node that performs the best is selected as
the only candidate for next hop, sending back a Clear-To-Broadcast message to the
original vehicle, then realizing a reliable and fast forwarding.
To execute the calculation process, several indexes are picked to form a compre-
hensive evaluating system.
Notation: Throughout this paper, we use boldface letter to denote vectors, which
are all column vectors. We use regular font letters to denote random quantities (such as
Di; hi). We use k k2 to denote operator of Euclidean norm (norm-2). The original node
Fig. 1. Two-way four-lane road map. (Color ﬁgure online)
572
D. Tian et al.

is denoted as o in the subscript, candidate node is denoted as i in the subscript and
target node (which is ready to receive message from candidate node) is denoted as t.
• Distance between candidate node and original node Di:
Di ¼ pi  po
k
k2
ð1Þ
A longer distance between the candidate node and original node ensures a longer
broadcasting length, reducing the number of nodes used in a single complete trans-
mission and precipitating the transmission.
• Relative velocity between candidate node and original node DVi:
DVi ¼ vi  vo
k
k2
ð2Þ
A lower relative velocity improves the stability between these two nodes, pre-
venting the candidate node from suddenly leaving the valid vicinity and improving the
reliability of forwarding.
• Angle-related criteria Ci: we use the Sigmoid function to calculate the criteria
related to the included angle hi between velocity direction of candidate node and
velocity direction of target node:
hi ¼ arccos
vi  vt
vi
j j  vt
j j


2
ð3Þ
If 0
  hi  90
, a smaller included angle between the direction of vi and vt is
preferred because it ensures a more reliable and stable transmission, while a larger
angle implies a larger probability to disconnect.
If 90
\hi  180
, a larger included angle between the direction of vi and vt is
preferred because it ensures a faster and more robust transmission, while a smaller
angle implies a larger probability to disconnect.
Thusly,
Ci h
ð Þ ¼
1
1 þ exp 4a
p hia
ð
Þ 0  hi  p
2


1
1 þ exp 4a
p hi þ 3a
ð
Þ ðp
2 \hi  pÞ
8
<
:
ð4Þ
in this equation, a is used as the calibration parameter. A larger Ci brings about a more
stable and faster transmission (Fig. 2).
Results of Ci are shown in a different variation degree as we change the calibration
parameter a. But a general variation tendency is sure in these two ways, i.e., (i) if hi is
near 0
 or 180
, Ci will appear near 1, which is the best condition and (ii) if hi is near
90
, Ci will appear near 0, which is the worst condition.
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
573

• Transmission power of the candidate node Pi: an increase in the transmission power
improves the probability of successful data transmissions if the link reliability is
below a certain threshold. With a higher transmission power, the physical layer can
use modulation and coding schemes with a higher bit ratio, increasing the band-
width under heavy workloads [3].
Considering the conﬂicting characteristics in these indexes, we adopt the Technique
for Order of Performance by Similarity to Ideal Solution (TOPSIS) as the calculating
principle in consideration of its compensatory property that one poor result in one
criterion can be negated by a good result in another criterion. Then an optimal can-
didate node can be conﬁrmed and selected. The calculation is conducted in the fol-
lowing way:
• Step 1. Creating an evaluation matrix consisting of m CNs and 4 indexes
Xij ¼
x1;1
  
x1;4
..
.
..
.
..
.
xm;1
  
xm;4
0
B
@
1
C
A
ð5Þ
• Step 2. Normalizing the matrix considering incongruous dimensions of four indexes
R ¼ ðrijÞm4
ð6Þ
by using the normalization method, rij ¼
Xij
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Pm
i¼1 X2
ij
p
i ¼ 1; 2;    ; m; j ¼ 1; 2; 3; 4
ð
Þ.
• Step 3. Calculating the weighted normalized decision matrix
tij ¼ rij  wj i ¼ 1; 2;    ; m; j ¼ 1; 2; 3; 4
ð
Þ
ð7Þ
where wj ¼ Wj= P4
j¼1 Wj j ¼ 1; 2; 3; 4
ð
Þ, so that P4
j¼1 wj ¼ 1; wj is the original
weight assigned to each index.
Fig. 2. Variation trend of Ci with different value of parameter a
574
D. Tian et al.

• Step 4. Determining the worst candidate Cw and the best candidate Cb
Cw ¼
maxtijjj 2 J


; mintijjj 2 J þ



	
 ftwjjj ¼ 1; 2; 3; 4g
ð8Þ
Cb ¼
mintijjj 2 J


; maxtijjj 2 J þ



	
 ftwjjj ¼ 1; 2; 3; 4g
ð9Þ
where,
J þ ¼ fj ¼ 1; 2; 3; 4jj associated with the index having a positive impact;
J ¼ fj ¼ 1; 2; 3; 4jj associated with the index having a negative impact.
• Step 5. Calculating the L2-distance between candidate nodes to the worst condition
Cw and best condition Cb
diw ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X4
j¼1 tij  twj

2
r
i ¼ 1; 2;    ; m
ð
Þ
ð10Þ
dib ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X4
j¼1 tij  tbj

2
r
i ¼ 1; 2;    ; m
ð
Þ
ð11Þ
where diw and dib are Euclidean norm (norm-2) distances from the candidate node
i to the worst and best conditions, respectively.
• Step 6. Calculating the similarity to the worst conditions
siw ¼
diw
diw þ dib
i ¼ 1; 2;    ; m
ð
Þ
ð12Þ
where 0  siw  1,
siw ¼ 1 if and only if the candidate node meets the best condition;
siw ¼ 0 if and only if the candidate node meets the worst condition.
• Step 7. Rank m candidate nodes according to their siw in descending order
i ¼ 1; 2;   ; m
ð
Þ.
Finally, after the original vehicle acquires a list of all candidate nodes ranking on
basis of their siw in descending order, the one that ranks the top is determined as the
optimal node and then selected as the next hop for message rebroadcasting. At this
time, the original vehicle will release its link with other candidate nodes and transmit
CAM to the optimal node to continue message transmission. If a message transmission
needs multiple rebroadcasting in VANET, the same technique is adopted every time to
select the next hop.
3
Performance Evaluation
3.1
Simulation Settings
We conduct our simulation based on a real trafﬁc scenario that vehicles arrive
according to Poisson distribution in a two-way four-lane road. To evaluate the per-
formance of REFF in such trafﬁc scenarios, we set some factors as quantitative and
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
575

some indexes as variables, comparing the ﬁnal performance as indexes change and
drawing the variation tendency corresponding to each index. We list the simulation
environment parameters in Table 1:
In a highly mobile and dense trafﬁc environment, cooperation is affected by the
constant addition and deletion of nodes [12]. And in such an environment, a node’s
position and velocity are inﬂuenced by its vicinity structure, which means that the
dynamics of a node’s position and velocity are denoted by the move of the node in
front of it. Hence, we assume all nodes in the simulation environment moves according
to the Intelligent Driver Model (IDM), which is a time-continuous car-following model.
For vehicle i, Xi denotes its position and Vi denotes its velocity at time t. Furthermore, li
denotes the length of vehicle. Net distance and velocity difference are also deﬁned as
si ¼ xi1  xi  li1 and Dvi ¼ vi  vi1, in which i−1 refers to the vehicle directly in
front of vehicle i. Thusly, the dynamics of vehicle i can be described in these two
ordinary differential equations:
_xi ¼ dxi
dt ¼ vi
ð13Þ
_vi ¼ dvi
dt ¼ a 1 
vi
v0

r
 s vi; Dvi
ð
Þ
si

2
 
!
ð14Þ
with s vi; Dvi
ð
Þ ¼ s0 þ vi  T þ viDvi
2 ﬃﬃﬃﬃ
ab
p
.
v0, s0, T, a and b are model parameters that have the following meaning, i.e.,
(i) desired velocity v0: the velocity the vehicle could drive at in free trafﬁc, (ii) mini-
mum spacing s0: a minimum desired net distance. A car cannot move if the distance
from the car in the front is not at least s0, (iii) desired time headway T: the desired time
headway to the vehicle in the front, (iv) acceleration a: the maximum vehicle accel-
eration and (v) comfortable braking deceleration b: a positive number. The exponential
r is usually set to 4.
Table 1. Simulation environment parameters
Simulation parameter Value
Length of lane
3 km
Width of lane
3.75 m
Number of lane
4
Transmission range
300 m
Duration
100 s
Vehicle density
[10,60] veh/km
576
D. Tian et al.

3.2
Simulation Results
In evaluating the performance of message transmission in VANET, an important metric
is the average transmission delay from one node to the next node. A longer trans-
mission delay has a negative impact on the total performance of V2V communication
considering the signiﬁcance of timeliness in communication. Thusly, we comparing the
average delay in message rebroadcasting from hop to hop under two different routing
techniques: REliable and Fast Protocol (REFF) as a type of unicast routing and
Epidemic Routing as a common type of broadcast routing.
In Fig. 3(a) the variation trend of average delay is shown with trafﬁc density
changing. As expected, the average transmission delay decreases as trafﬁc density
increases because a denser trafﬁc environment ensures a larger number of nodes to
rebroadcast messages and more stable transmission. When compared with Epidemic
Routing, REFF displays a sharply decrease in average transmission delay from one
node to the next. The average transmission delay under REFF is 2.41 [s] while the
transmission delay under Epidemic Routing is 2.41 [s]. With initial speed of vehicles
remaining constant at 25 [m/s] and as trafﬁc density varies from 10 [veh/km] to
60 [veh/km], a 49.3% decrease in average transmission delay is seen in REFF when
compared to Epidemic Routing on average. A lower trafﬁc density experiences a larger
difference in average delay between REFF and Epidemic Routing.
In Fig. 3(b) the variation trend of average delay is shown with average vehicle
velocity changing. As expected, the average transmission delay decreases as initial
speed of vehicles increases because a faster speed ensures a more stable link and a faster
transmission. When compared with Epidemic Routing, REFF displays an evident
decrease in average transmission delay from one node to the next. The average trans-
mission delay in REFF is 2.06 [s] while the average transmission delay is 4.86 [s]. With
trafﬁc density remaining constant at 60 [veh/km] and as initial speed of vehicles varies
from 10 [m/s] to 30 [m/s], a 56.95% decrease in average transmission delay is seen in
REFF when compared to the performance of Epidemic Routing. A slower speed
experiences a larger difference in average delay between REFF and Epidemic Routing.
Fig. 3. Average transmission delay under two routing protocols
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
577

When we compare the performance of REFF and Epidemic Routing in message
rebroadcasting, another important fact that we cannot ignore is the collision phenomena
in broadcast routing. Data collision can lead to the failure of message being transmitted
to the destination vehicle.
In a complex trafﬁc environment, due to the large number and high density of
vehicles, the transmission of one node has the probability to collide with the trans-
mission of another node if waiting time difference between them is short. Thusly, we
calculate the collision probability (CP) of one node with another node under the
ﬂooding-based routing protocol by using the formula introduced in RObust and Fast
Forwarding (ROFF) routing protocol [17]:
CP ¼ PðRange  minDiff
MaxWT [ dfN  dfN1


Þ
ð15Þ
In this equation, CP is equal to the probability that Range  minDiff
MaxWT is bigger than the
space headway of vehicle fN and fN1, where Range is the transmission range of node,
minDiff is the minimum waiting time difference between vehicle fN and fN1, MaxWT is
the maximum waiting time and dfi is the distance between fi and previous node.
We calculate collision probability of Epidemic Routing as trafﬁc density varies
from 10 [veh/km] to 60 [veh/k], which corresponds to different trafﬁc scenarios.
In measuring the collision probability, different maximum waiting time is a critical
inﬂuencing factor. As expected, from the variation trend we can tell that the collision
probability when rebroadcasting a message increases as the trafﬁc density increases
because smaller vehicle headway on the road can lead to data ﬂooding and collision.
Moreover, as shown by three different curves, a smaller maximum waiting time adds to
the probability of collision between nodes because a smaller maximum waiting time
Fig. 4. Collision probability under different value of MaxWT
578
D. Tian et al.

results in a smaller minimum waiting time difference between nodes in the vicinity. The
result concerning collision probability is shown in Fig. 4. On the contrast, unicast
routing usually displays zero probability in collision. Thusly, the REFF we propose
which belongs to unicast routing outperforms Epidemic Routing when taking collision
probability into account.
4
Conclusions
Aiming at solving the data ﬂooding problem and transmission delay in VANET sup-
ported by 5G, LTE-V, DSRC and etc. in V2V communication, we introduce the
REliable and Fast Forwarding (REFF) in this paper. In REFF, two phases are essential
before rebroadcasting the message from one node to the next, which are node ﬁltering
and next-hop selection using TOPSIS. These two steps targets at eliminating the
redundant node and determine the only optimal candidate node for rebroadcasting the
message. By adopting this technique, the number of nodes in a complete message
transmission is largely reduced and a more reliable and faster transmission is thusly
guaranteed. Compared with some other routing protocols, REFF performs better at
transmission delay and it is not disturbed by the problem of data collision. In the future,
how to more effectively merging the REFF technique with cross-layer technique will be
our main focus.
Acknowledgments. This research was supported in part by no. Beijing Science and Technology
Program no. D171100000317003 and the National Natural Science Foundation of China under
Grant nos. 61672082, U1564212.
References
1. Chen, S., Hu, J., Shi, Y., Zhao, L.: LTE-V: A TD-LTE based V2X solution for future
vehicular network. IEEE Internet Things J. 3(6), 997–1005 (2016)
2. Chen, S., Zhao, J.: The requirements, challenges and technologies for 5G of terrestrial
mobile telecommunication. IEEE Commun. Mag. 52(5), 36–43 (2014)
3. Correia, L.H.A., Macedo, D.F., Dos Santos, A.L., Loureiro, A.A.F., Nogueira, J., Marcos,
S.: Transmission power control techniques for wireless sensor networks. Comput. Netw.
51(17), 4765–4779 (2007)
4. Cortéspolo, D., Callecancho, J., Carmonamurillo, J., Gonzálezsánchez, J.: Future trends in
mobile-ﬁxed integration for next generation networks: classiﬁcation and analysis. Int. J. Veh.
Telematics Infotain. Syst. (IJVTIS) 1(1), 33–53 (2017)
5. Gaamel, A.M., Maratha, B.P., Sheltami, T.R., Shakshuki, E.M.: Fault-tolerance evaluation
of VANET under different data dissemination models. Int. J. Veh. Telematics Infotain. Syst.
(IJVTIS) 1(1), 54–68 (2017)
6. Ge, X., Cheng, H., Mao, G., Yang, Y.: Vehicular communication for 5G cooperative small
cell networks. IEEE Trans. Veh. Technol. 65, 1 (2016)
7. Huang, Y., Wang, J., Jiang, C., Zhang, H., Leung, V.C.M.: Vehicular network based reliable
trafﬁc density estimation. In: Proceedings of the IEEE Vehicular Technology Conference
(VTC), Nanjing, 15–18 May 2016
REFF: REliable and Fast Forwarding in Vehicular Ad-hoc Network
579

8. Jiang, C., Zhang, H., Han, Z., Cheng, J., Ren, Y., Hanzo, L.: On the outage probability of
information sharing in cognitive vehicular networks. In: Proceedings of IEEE International
Conference on Communications (ICC), Kuala Lampur, Malaysia, 23–27 May 2016
9. Mir, Z.H., Filali, F.: A simulation-based study on the environment-speciﬁc propagation
model for vehicular communications. Int. J. Veh. Telematics Infotain. Syst. (IJVTIS) 1(1),
15–32 (2017)
10. Mostafa, A., Vegni, A.M., Agrawal, D.P.: Review article: A probabilistic routing by using
multi-hop retransmission forecast with packet collision-aware constraints in vehicular
networks. Ad Hoc Netw. 14(3), 118–129 (2014)
11. Pressas, A., Özpolat, M., Sheng, Z., Ali, F.: Performance evaluation of networking protocols
for connected vehicles. Int. J. Veh. Telematics Infotain. Syst. (IJVTIS) 1(1), 1–14 (2017)
12. Shivshankar, S., Jamalipour, A.: An evolutionary game theory-based approach to
cooperation in vanets under different network conditions. IEEE Trans. Veh. Technol.
64(5), 2015–2022 (2015)
13. Tian, D., Zhou, J., Sheng, Z., Ni, Q.: Learning to be energy-efﬁcient in cooperative
networks. IEEE Commun. Lett. 20(12), 2518–2521 (2016)
14. Tian, D., Zhou, J., Wang, Y., Lu, Y.: A dynamic and self-adaptive network selection method
for multimode communications in heterogeneous vehicular telematics. IEEE Trans. Intell.
Transp. Syst. 16(6), 1–17 (2015)
15. Tian, D., Zhou, J., Wang, Y., Sheng, Z., Xia, H., Yi, Z.: Modeling chain collisions in
vehicular networks with variable penetration rates. Transp. Res. Part C Emerg. Technol. 69,
36–59 (2016)
16. Tian, D., Zhou, J., Wang, Y., Zhang, G., Xia, H.: An adaptive vehicular epidemic routing
method based on attractor selection model. Ad Hoc Netw. 36(P2), 465481 (2015)
17. Yoo, H., Kim, D.: Roff: Robust and fast forwarding in vehicular ad-hoc networks. IEEE
Trans. Mobile Comput. 14(7), 1490–1502 (2015)
18. Yu, R., Ding, J., Huang, X., Zhou, M.T.: Optimal resource sharing in 5G-enabled vehicular
networks: A matrix game approach. IEEE Trans. Veh. Technol. 65(10), 1 (2016)
19. Zhang, H., Dong, Y., Cheng, J., Leung, V.C.M.: Fronthauling for 5G LTE-U ultra dense
cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
20. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A.H., Leung, V.C.M.: Network slicing
based 5G and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
21. Zheng, Q., Zheng, K., Zhang, H., Leung, V.C.M.: Delay-optimal virtualized radio resource
scheduling in software-deﬁned vehicular networks via stochastic learning. IEEE Trans. Veh.
Technol. 65(12), 9479–9492 (2016)
580
D. Tian et al.

A Novel Intrusion Detection System Based
on Advanced Naive Bayesian Classiﬁcation
Yunpeng Wang1,4,5,6, Yuzhou Li1,4, Daxin Tian1,4(&),
Congyu Wang1,4, Wenyang Wang2, Rong Hui2, Peng Guo2,
and Haijun Zhang3
1 Beijing Advanced Innovation Center for Big Data and Brain Computing,
Beihang University, XueYuan Road No. 37, Beijing 100191, China
dtian@buaa.edu.cn
2 China Automotive Technology and Research Center,
Automotive Engineering Research Institute,
East Xianfeng Road No. 68, Tianjin 300300, China
3 School of Computer and Communication Engineering,
University of Science and Technology Beijing,
XueYuan Road No. 30, Beijing 100083, China
4 Beijing Key Laboratory for Cooperative Vehicle Infrastructure Systems
and Safety Control, School of Transportation Science and Engineering,
Beihang University, XueYuan Road No. 37, Beijing 100191, China
5 Jiangsu Province Collaborative Innovation Center of Modern Urban
Trafﬁc Technologies, Si Pai Lou. 2, Nanjing 210096, China
6 Key Lab of Urban ITS Technology Optimization and Integration,
The Ministry of Public Security of China, Hefei 230088, China
Abstract. Intrusion Detection System is a pattern recognition task whose aim is
to detect and report the occurrence of abnormal or unknown network behaviors
in a given network system being monitored. In this paper, we propose a machine
learning model, advanced Naive Bayesian Classiﬁcation (NBC-A) which is
based on NBC and ReliefF algorithm, to be used in the novel IDS. We use
ReliefF algorithm to give every attribute of network behavior in KDD’99 dataset
a weight that reﬂects the relationship between attributes and ﬁnal class for better
classiﬁcation results. The novel IDS has a higher True Positive (TP) rate and a
lower False Positive (FP) rate in detection performance.
Keywords: IDS  Information security  NBC  ReliefF
Detection performance  KDD’99
1
Introduction
Network in a profound impact on people’s lives and ways of working at the same time, it
also brings a lot of security risks and threats. A variety of viruses, security vulnerabilities,
attacks have caused the loss of users, enterprise, government, even national security. With
increasing network security incidents in recent years, people have a strong sense of
security and privacy protection. Therefore, the well-designed security system is a very
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 581–588, 2018.
https://doi.org/10.1007/978-3-319-72823-0_53

important and urgent problem in the ﬁeld of network information security especially in
next generation networks (5G) [1, 2] with great security challenges.
At present, the network information security protection measures are divided into
passive security and active security. Passive security includes data encryption [3, 4],
security authentication [5], ﬁrewall [6] and other measures and these Active security is
a technology represented by Intrusion Detection System (IDS) [7] which detect pos-
sible intrusion by collecting network datasets or information, and sending alerts and
responding before an intrusion occurs, or before a hazard occurs. With the development
of IDS, even that it could replace the traditional network security measures.
In recent years, with the rise of machine learning (ML)-related models [8], it is
becoming a trend to apply machine learning methods into intrusion detection system. In
the ﬁeld of machine learning, Naive Bayesian Classiﬁcation (NBC) [9] is widely used
as the most classical learning algorithm with good classiﬁcation accuracy. However,
the NBC is based on the independence of event attributes, which is difﬁcult to achieve
in realistic network behaviors especially in future networks (such as 5G) with great
complexity [10]. In response to this shortage, many scholars have put forth an
improved method which is based on different attribute weights. Paper [11] propose a
weighted BNC model based on Rough Set, it could performance well in small data sets
and could do some changes in original information. Paper [12] use the value of every
attribute to be as weights, but the attributes attribute are more, each weighted coefﬁ-
cients are small, it cannot play its role in real complex networks. Paper [13] propose a
weighted NBC based on correlation coefﬁcient, and it could improve the classiﬁcation
ability of the Bayesian, but the current measure formula is not described accurately for
all conditions.
In this paper, we propose a novel IDS based on machine learning an advanced
Naive Bayesian Classiﬁcation (NBC-A) which we give every attributes a weight to
reﬂect the relations between attributes and ﬁnal classiﬁcation results. We use the
ReliefF [14] algorithm that is robust [15] and can deal with incomplete and noisy data
to estimate weights and we get a higher True Positive (TP) rate and a lower False
Positive (FP) rate [16] in detection performance that means it has better performance
than NBC.
In this paper, we introduce some network information security related works and
machine learning works in Sect. 2; we proposed the IDS based on NBC-A in Sect. 2.1;
detection performance based on dataset KDD’99 and analysis is in Sect. 3; conclusion
and outlook are in Sect. 4.
2
Advanced Naive Bayesian Classiﬁcation (NBC-A) Model
in Intrusion Detection System (IDS)
The method of intrusion detection is to design a network behavior classiﬁer to dis-
tinguish the normal and abnormal data in the dataset, simulation or realistic network, so
as to realize the alarm function of the attacking behavior. At the same time, intrusion
detection by IDS is an uncertain behavior, and Naive Bayes theory is suitable for
uncertain probabilistic events. Therefore, the introduction of intrusion detection tech-
nology based on NBC in IDS research design is completely reasonable.
582
Y. Wang et al.

2.1
Naive Bayesian Classiﬁcation (NBC)
The Bayesian decision-making theory provides a probabilistic approach to reasoning. It
assumes that the variables to be investigated follow certain probability distributions and
can reason from these probabilities and observed data to make optimal decisions. Naive
Bayesian Classiﬁcation (NBC) model based on Bayesian decision-making theory [17],
is a simpliﬁed Bayesian probability model. The classiﬁcation model is simple in
implementation, fast in classiﬁcation and high in accuracy. It is one of the most widely
used classiﬁcation models in machine learning.
Given a data set of K attributes and assumed that the values of the K attributes are
discrete, the purpose of classiﬁcation is to predict the type of every case in the test set
which is a part of dataset (the other part is train set whose task is to make the NBC’s
train). We can give a speciﬁc example, whose attributes are from a1 to ak. The
probability of the example belonging to class Ci is P C ¼ cijA1 ¼ a1; . . .; Ak ¼ ak
ð
Þ.
Obviously, according to Bayesian decision-making theory:
P C ¼ cijA1 ¼ a1; . . .; Ak ¼ ak
ð
Þ ¼ PðA1 ¼ a1; . . .; Ak ¼ akjC ¼ ciÞP C ¼ ci
ð
Þ
P A1 ¼ a1; . . .; Ak ¼ ak
ð
Þ
ð1Þ
Here, P C ¼ ci
ð
Þ is a prior probability and can be easily calculated from train set. In
data set, P A1 ¼ a1; . . .; Ak ¼ ak
ð
Þ is same to every class ci and it assumes that the
values of attributes are independent, we can know:
P A1 ¼ a1; . . .; Ak ¼ ak
ð
Þ ¼ 1
ð2Þ
P A1 ¼ a1; . . .; Ak ¼ akjC ¼ ci
ð
Þ ¼ PðA1 ¼ a1jC ¼ ciÞ. . .PðAk ¼ akjC ¼ ciÞ
ð3Þ
Putting Formula (2) and (3) in to Formula (1), we can get the method used by Naive
Bayesian Classiﬁcation, that is:
VNBC x
ð Þ ¼ arg max P C ¼ ci
ð
Þ
Y
P Aj ¼ ajjC ¼ ci


ð4Þ
Here VNBC x
ð Þ is indicated the target value out by NBC indicated that the output
target. In theory, NBC has the minimum misclassiﬁcation rate, compared with all the
other classiﬁcation algorithms and it is suitable to be used in IDS to ﬁnd abnormal
behaviors in network.
2.2
Attribute Weighted Naive Bayesian Classiﬁcation
However, the independence assumption is difﬁcult to meet in the real network
behaviors, each network behavior has its own attributes, which have complex rela-
tionships and can directly affect the results of intrusion detection judgments. Paper [18]
established an attribute weighted NBC, is assigned to give different weights to each
attribute to make these relationships effect on NBC:
A Novel Intrusion Detection System
583

VwNBC x
ð Þ ¼ arg max P C ¼ ci
ð
Þ
Y
P Aj ¼ ajjC ¼ ci

Wj
ð5Þ
Here, Wj is the weight of Aj. Different Wj has different inferences on NBC, great Wj
makes great impacts on IDS. The key of NBC in IDS is how to determine the weights
of different attributes.
2.3
The Wj Determined by ReliefF Algorithm
In the next generation network (such as 5G), the network behavior of the relationship
will be far more complex than the current network. However, the algorithm for
determining wj are focusing on relations among on attributes instead of class Ci, these
algorithms be very difﬁcult to play a role because of the high complexity. Therefore, we
propose to use ReliefF algorithm, which directly focuses on the relationship between
attribute and ﬁnal classiﬁcation (class Ci) results rather than the relationship between
attribute and attribute. The ReliefF algorithm as follows:
ReliefF algorithm is a multi-class attribute selection algorithm proposed by
Kononenko. Its basic idea is to assign a weight value to each attribute in the attribute
set, assign a higher weight to the attribute which could has direct and high relation to
ﬁnal classiﬁcation (class Ci). For that purpose, given a randomly selected network
behavior Xi (line 3), ReliefF searches for its two nearest neighbors: one from the same
class, called nearest hit H, and the other from the different classes (class Ci, o 6¼ i),
called nearest miss M (line 4). Function diff A; I1; I2
ð
Þ (line 6) calculates the difference
between the values of the attribute A for two network behaviors I1 and I2. The whole
process is repeated for m (line 2) times, where m is a user-deﬁned parameter. i; j; o and
k are count constants.
ReliefF Algorithm for determining Wj:
Input:for eachbehaviorXi intrainsetattributes AðA1 ¼ a1; . . .; Aj ¼ aj; . . .; Ak ¼ akÞ
values and the class Ci.
Output: the vector WðW1 ¼ w1; . . .; Wj ¼ wj; . . .; Wk ¼ wkÞ of weights of the
qualities of attributes A.
Step1 set all W as an initial value Wj ¼ 0;
Step2 for i :¼ 1 to m do begin
Step3 randomly select a network behavior Xi;
Step4 ﬁnd nearest Hsðs ¼ 1; 2; . . .; qÞ in hit H and nearest Msðs ¼ 1; 2; . . .; qÞ in
miss M;
Step5 for j :¼ 1 to k do
Step6
Wj := Wj  Pq
s¼1
diff A;Xi;Hs
ð
Þ
mq
þ P
Y6¼class Ci
Y¼class Cio
P Y
ð Þ
1P classCi
ð
Þ
Pq
s¼1 diff A;Xi;Ms
ð
Þ
h
i
= mq
ð
Þ;
Step7 end;
584
Y. Wang et al.

ReliefF Algorithm does not set the value range of Wj, it may be negative, in order to
avoid this situation, the proposed standardized operation [19] of Wj, the formula is as
follows:
W0
j ¼
Wj  minW
maxW  minW
ð6Þ
Here W0
j is the standard Wj, minW is the minimum value of W and maxW is the
maximum one.
2.4
The Processes of the Novel IDS Based on Model NBC-A
Combining 3.1–3.3, we get the advanced NBC (NBC-A) which be used in the novel
IDS proposed in this paper is:
VNBCA x
ð Þ ¼ arg max P C ¼ ci
ð
Þ
Y
P Aj ¼ ajjC ¼ ci

W0
j
ð7Þ
W0
j ¼
Wj  minW
maxW  minW
ð8Þ
Wj := Wj  Pq
s¼1 diff A; Xi; Hs
ð
Þ= mq
ð
Þ
þ P
Y6¼class Ci
Y¼class Cio
P Y
ð Þ
1P classCi
ð
Þ
Pq
s¼1 diff A;Xi;Ms
ð
Þ
h
i
= mq
ð
Þ
ð9Þ
We divide the IDS into two processes: in the train process, the Train Set includes
the known network behavior data and the marked classes, and then Preprocesses:
discretization and feature selection. Finally, we use the ReliefF algorithm to weight the
feature to get NBC-A; in the test process, the Test Set includes unknown network
behavior data, and then discretization, and ﬁnally the use of NBC-A to get behavior
classiﬁcation results. The processes of the novel IDS as follows (Fig. 1):
Fig. 1. The whole process is divided into 2 parts: Train Process and Test process, the model
NBC-A based on NBC and ReliefF algorithm is used to get the network behavior class in Test
Process.
A Novel Intrusion Detection System
585

3
Detection Performance and Analysis
3.1
Dataset KDD’99 for Detection Performance
We utilize dataset KDD Cup 1999 (KDD’99) [20] to be as the data for detection
performance. KDD’99 is the standard dataset of intrusion detection and consists of two
parts: 7 weeks of train data set, about 5,000,000 network connections; 2 weeks of test
data set, about 2,000,000 network connections. Each network connection record is
marked as normal (Normal) or abnormal (Anomaly), abnormal type is divided into 4
categories of 39 kinds of attack types. For time saving and computer performance, we
utilize 10% KDD’99 to be the performance data. The distribution of data as follows
(Table 1):
3.2
Performance Analysis
In detection performance, the experimental platform environment is: Operation System:
Windows 7 ultimate, CPU 3.00 GHz, RAM 8 GB, Hard Disk 500G; Programming
tools: Spyder (Python 2.7), Dataset: 10% KDD’99 (80% Train Set and 20% Test Set),
the detection performance results as follows:
Table 1. The distribution of intrusion types in 10% KDD’99
Type
Train examples Test examples 10% KDD’99
Train distribution
10% KDD’99
Test distribution
Normal
97,278
60,593
19.69%
19.48%
Probe
4,107
4,166
0.83%
1.34%
DOS
391458
229,853
79.24%
73.90%
U2R
52
228
0.01%
0.07%
R2L
1,126
16,189
0.23%
5.20%
Total
497,021
31,1029
100%
100%
Fig. 2. Accuracy and error rate are the accuracy of NBC-A is higher than NBC and the error rate
is lower than NBC, it means NBC-A has a better performance than NBC in detection
performance.
586
Y. Wang et al.

(1) From Fig. 2, we could ﬁnd that the accuracy of NBC-A is greatly higher than
NBC one, and the error rate of NBC-A is lower than the NBC in intrusion
detection performance. Actually, the average of NBC-A accuracy is 98.50% and
NBC is 91.73%. The average of NBC-A error rate is 5.79% and the NBC is
11.98%. It means that model NBC-A can performance greatly better than in NBC
in data mining by using ReliefF algorithm.
(2) From Fig. 3, for different types of intrusion attacks, the TP of NBC-A is generally
higher than that of NBC and the FP of NBC-A is much lower than that of NBC.
This means the novel IDS we propose in this paper, uses ReliefF algorithm to
weight the class attributes to obtain a good effect, can effectively detect the
intrusion behaviors in the networks, to ensure the safety of the system.
4
Conclusion and Outlook
Aiming at the massive and complex network attacks on the current Internet or next
generation network 5G (the more massive and complex), it is reasonable to apply the
NBC of Naive Bayes decision theory to IDS. We propose a novel IDS based on
NBC-A which makes improvements on the NBC. The novel IDS we propose in this
paper utilizes ReliefF algorithm to estimate attribute. Compared with other algorithm,
Relief is more robust and efﬁcient, it directly reﬂects the relationship between attributes
and ﬁnal class results. Model NBC-A is more suitable for large-scale and
high-complexity networks. The detection performance shows that we get a higher TP
rate and a lower FP rate in detection performance that means that NBC-A has better
performance than NBC and practical application signiﬁcance.
In this novel IDS, we have a lot of improvement in the performance of classiﬁer
space, in the future work, how to more effectively combine ReliefF algorithm and
relationship of attributes between attributes, and other machine learning classiﬁcation
algorithm, which can further enhance the classiﬁer’s ability of intrusion detection for
complex network.
Fig. 3. TP of NBC-A is high than NBC and FP of NBC-A is lower, that means novel IDS based
on NBC-A is more secure and useful the NBC one.
A Novel Intrusion Detection System
587

Acknowledgments. This research was supported by the National Key Research and Develop-
ment Program of China (2016YFB0100902).
References
1. Rappaport, T.S., Sun, S., Mayzus, R., Zhao, H.: Millimeter wave mobile communications for
5G cellular: it will work! IEEE Access 1(1), 335–349 (2013)
2. Boccardi, F., Heath, R.W., Lozano, A., Marzetta, T.L.: Five disruptive technology directions
for 5G. IEEE Commun. Mag. 52(2), 74–80 (2013)
3. Matsui, M.: The ﬁrst experimental cryptanalysis of the data encryption standard. In:
Desmedt, Y.G. (ed.) CRYPTO 1994. LNCS, vol. 839, pp. 1–11. Springer, Heidelberg
(1994). https://doi.org/10.1007/3-540-48658-5_1
4. Biryukov, A., Cannière, C.D.: Data encryption standard (DES) (2005)
5. Lowe, G.: An attack on the Needham-Schroeder public-key authentication protocol. Inf.
Process. Lett. 56(3), 131–133 (1995)
6. Manner, J., Karagiannis, G., Mcdonald, A.: NSIS signaling layer protocol (NSLP) for
quality-of-service signaling. IETF 31(2), 152–160 (2010)
7. Huang, M.Y., Jasper, R.J., Wicks, T.M.: A large scale distributed intrusion detection
framework based on attack strategy analysis. Comput. Netw. 31(23–24), 2465–2475 (1998)
8. Bache, K., Lichman, M.: UCI Machine Learning Repository (2013)
9. Flach, P.A., Lachiche, N.: Naive Bayesian classiﬁcation of structured data. Mach. Learn. 57
(3), 233–269 (2004)
10. Muirhead, D., Imran, M.A., Arshad, K.: Insights and approaches for low-complexity 5G
small-cell base-station design for indoor dense networks. IEEE Access 3, 1562–1572 (2015)
11. Deng, W., Wang, G., Wang, Y.: Weighted Naive Bayes classiﬁcation algorithm based on
rough set. Comput. Sci. 34(2), 204–205 (2007)
12. Cheng, K., Zhang, C.: Feature-based weighted Naive Bayesian classiﬁer (2006)
13. Yao, S., Li, L.: Weighted Naïve Bayesian classiﬁcation algorithm based on correlation
coefﬁcients. Int. J. Adv. Comput. Technol. 4(20), 29–35 (2012)
14. Robnikšikonja, M., Kononenko, I.: Theoretical and empirical analysis of ReliefF and
RReliefF. Mach. Learn. 53(1), 23–69 (2003)
15. Deng, Z., Chung, F.L., Wang, S.: Robust relief-feature weighting, margin maximization, and
fuzzy optimization. IEEE Trans. Fuzzy Syst. 18(4), 726–744 (2010)
16. Hamid, Y., Sugumaran, M., Journaux, L.: Machine learning techniques for intrusion
detection: a comparative analysis. In: International Conference on Informatics and Analytics
(2016)
17. Fei, Z., Guo, J., Wan, P., Yang, W.: Fast automatic image segmentation based on Bayesian
decision-making theory. In: International Conference on Information and Automation (2009)
18. Zhang, C., Wang, J.: Attribute weighted Naive Bayesian classiﬁcation algorithm.
Microcomputer Information, pp. 27–30 (2010)
19. Han, J., Kamber, M., Pei, J.: Data Mining: Concepts and Techniques, 2nd edn. (The Morgan
Kaufmann Series in Data Management Systems) (2006)
20. Pfahringer, B.: Winning the KDD99 classiﬁcation cup: bagged boosting. ACM SIGKDD
Explor. Newsl. 1(2), 65–66 (2000)
588
Y. Wang et al.

Power Allocation in One-Way Untrusted AF
Relay System with Friendly Jamming
Ronghua Luo1(&), Chao Meng1, Guobing Hu2, and Hua Shi1
1 School of Networks and Telecommunications Engineering
in Jinling Institute of Technology, Nanjing, China
{lrh,mengchao,shihuawindy}@jit.edu.cn
2 School of Electronical and Information Engineering
in Jinling Institute of Technology, Nanjing, China
s0304152@jit.edu.cn
Abstract. In this paper, the physical layer security in one-way untrusted AF
relay system is considered. For improving the physical layer security, external
friendly jammers offer help through transmitting interference signal to the
untrusted relay. It is indicated that a nonzero secrecy rate is achievable in
one-way untrusted AF relay system with the help of friendly jammers. The
source optimization problem is further formulated. In this optimization problem,
in order to increasing the secrecy rate, the source must pay the jammers for
exchanging their service of jamming. Finally, an optimal transmit power allo-
cation of all the nodes is provided for the system. And simulation results verify
the properties.
Keywords: Physical layer security  Secrecy rate  Friendly jammer
Source optimization problem  Power allocation
1
Introduction
Recently, physical layer based security attracting much attention due to the broad-
casting nature of wireless communication. The theoretical foundation to study the
secure communication at the physical layer is the wiretap channel and the
information-theoretic notion of secrecy introduced by Wyner [1]. It has been proved
that if the main channel condition is worse than the wiretap channel, the secrecy
capacity will be zero [2], in order to overcoming this limitation, cooperative relaying
[3, 4] and cooperative jamming [5, 6] has been proposed in wireless communication
networks. And, physical layer security is also very important in 5G networks, such as
ultra dense networks [7], LTE-U [8], and network slicing [9].
When the channel between the source and destination is worst, the relay node must
be utilized to forward the information of source. However, in some cases, the relay
node is untrusted. For example, the relay has a lower sense of security, and so, it does
not trust the conﬁdential messages it is relaying. How to communicate securely with
the untrusted relay has been studied in [10, 11]. In [12], the destination can perform
cooperative jamming, and which disable the untrusted relay from deciphering what it
relaying. And recently, considering physical layer security in two-way untrusted relay
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 589–596, 2018.
https://doi.org/10.1007/978-3-319-72823-0_54

system was also studied in [13]. In this paper, with the help of friendly jammers, the
secrecy rate of the sources can be effectively improved.
In this paper, the physical layer security of AF untrusted one-way relay system with
friendly jamming is investigated. Because there is no direct communication link
between the source and the destination, an essential relay is needed, meanwhile, this
relay is also a malicious eavesdropper. In [14], it is indicated that the secrecy rate is
zero. Because that the untrusted relay can decipher the conﬁdential message from the
source. Therefore, the destination can only receive the signals from the untrusted relay
who knows all the conﬁdential message the destination knows. And then, it is
impossible to make the source-destination pairs keeping secret from the untrusted relay.
So, in this paper, we utilize the jammers as helpers that confusing the eavesdropping
relay. After more analysis, it is indicated that a non-zero secrecy rate is indeed available
by utilizing proper jamming power from the friendly jammers. The source optimization
problem is further formulated. In the optimization problem, in order to improve the
secrecy rate, the source must pay the jammers for interfering the malicious relay. The
friendly jammers charge the sources with a certain price for their service of jamming.
And the simulation results verify the properties.
The paper is organized as follows. Section 2 presents the channel model, two-phase
protocol that utilizes cooperative jamming and the secrecy rate for the destination is
deﬁned. In Sect. 3, we formulate the source optimization problem and analyze the
optimizing problem of physical layer security with jammers. In Sect. 4, simulation
results are presented. And main conclusions are drawn in Sect. 5.
2
System Model
As shown in Fig. 1, we consider a one-way AF relay network consisting of one source
node, one untrusted relay node, one destination and N friendly jammer nodes, which
are denoted by S, R, D and FJi, i = 1, 2,…, N, respectively. It is assumed that all nodes
are half-duplex and there includes two phases, called phase one and phase two
respectively. In phase one, the source transmits signal Xs with power ps. At the same
time, the jammer nodes transmit jamming signals XJi with pJ
i ; j ¼ 1; 2; . . .; N for con-
fusing the relay node. We deﬁne the received signal at the relay in phase one as XR
XR ¼
ﬃﬃﬃﬃ
ps
p
XshS;R þ
X
N
i¼1
ﬃﬃﬃﬃﬃ
pJ
i
q
XJihJi;R þ Z1
ð1Þ
Where Z1 is an additive white Gaussian noise (AWGN), the mean is zero and variance
is r2.
In phase two, the relay node ampliﬁes and forward (AF) the received signal XR with
a factor b. And b is deﬁned as
b ¼ ðps hS;R

2 þ
X
N
i¼1
pJ
i hJi;R

2 þ r2Þ1=2
ð2Þ
590
R. Luo et al.

The received signal at the destination in phase two is deﬁned as YD, which is
expressed as
YD ¼ b
ﬃﬃﬃﬃﬃ
pr
p
XRhR;D þ
X
N
i¼1
ﬃﬃﬃﬃﬃ
pJ
i
q
XJihJi;D þ Z2
ð3Þ
Where Z2 is also an AWGN with zero-mean and variance of r2. Assuming that the
signal XJi is known to the destination. After calculation, YD can be given as
YD ¼ b
ﬃﬃﬃﬃﬃﬃﬃﬃ
pspr
p
XshS;RhR;D þ b
ﬃﬃﬃﬃﬃ
pr
p
hR;DZ1 þ Z2
ð4Þ
Then, the corresponding SINR (signal-to-interference-and-noise ratio) at the relay,
deﬁned as cR, can be given by
cR ¼
ps hS;R

2
r2 þ P
N
i¼1
pJ
i hJi;R

2
ð5Þ
The corresponding SINR at the destination deﬁned as cD, can be given by
cD ¼
prps hS;R

2 hR;D

2
r2ðps hS;R

2 þ P
N
i¼1
pJ
i hJi;R

2 þ r2 þ pr hR;D

2Þ
ð6Þ
And then, the untrusted relay node has the capacity as
Fig. 1. System model of the one-way relay network
Power Allocation in One-Way Untrusted AF Relay System
591

CR ¼ W
2 log2ð1 þ cRÞ
ð7Þ
The destination has the capacity as
CD ¼ W
2 log2ð1 þ cDÞ
ð8Þ
Then, the secrecy rate for the destination can be deﬁned as
Cs
D ¼ ðCD  CRÞ þ
ð9Þ
Where ðxÞ þ denotes max{x, 0}.
3
Physical Layer Security with Jammers
From [14], we know that the secrecy rate of the destination is zero without friendly
jammers. However, when using friendly jammers, these jammers can transmit inter-
ference signal to confuse the malicious relay, meanwhile, the interference signal is
known for the destination. Then, a non-zero secrecy rate of the destination with the
help of friendly jammers may be indeed available at some power vectors of ðps; pr; pJ
i Þ.
In this section, after further analyzing, it is found that the secrecy rate of the destination
can be effectively improved through buying jamming power from the friendly jammers.
And then, the problem comes to how to optimize the secrecy rate of the destination by
allocating the jamming power from different friendly jammers.
From (7), (8) and (9), we have
Cs
D ¼ W
2
log2
1 þ
prps hS;R

2 hR;D

2
r2ðpsjhS;Rj2 þ P
N
i¼1
pJ
i jhJi;Rj2 þ r2 þ prjhR;Dj2Þ
0
B
B
B
@
1
C
C
C
A
2
6664
 log2
1 þ
ps hS;R

2
r2 þ P
N
i¼1
pJ
i hJi;R

2
0
B
B
B
@
1
C
C
C
A
3
7775
þ
ð10Þ
From (10), we can ﬁnd that if
r2
pr hR;D
j
j
2 \1, in some region of the jamming power pJ
i ,
the secrecy rate will be positive, which implies that the secrecy rate can be improved
with friendly jammers’ help compared to the secrecy rate without friendly jammers.
And @Cs
D
@pr [ 0 is always hold, which means that Cs
D is a monotonically increasing
function of pr. Thus, when pr ¼ pmax, the secrecy rate Cs
D reaches the maximum, where
pmax denotes the optimal relay power. In this paper, our main interested thing is how to
592
R. Luo et al.

optimize the utility value of the source by allocating the jamming power, and mean-
while, all the nodes transmit with independent power, we can consider the source
power ps as a constant. If the source wants to improve the secrecy rate with the help of
jammers, they must pay the cost to the jammers. So, in this paper, the utility function of
the source is deﬁned as
Us ¼ aCs
D  M
ð11Þ
Where the constant a [ 0 is a factor that converts utility units to currency. M is the cost
to pay for the jammers, which is deﬁned as
M ¼
X
N
i¼1
kipJ
i
ð12Þ
Where ki is the price per unit power charged by the friendly jammer i.
So, subject to the secrecy rate constraint and individual power constraint, the source
optimization problem can be formulated as
max
Us ¼ aCs
D  M
st:
Cs
D [ 0
0  pJ
i  pmax; fixed
pr; ps
ð13Þ
For maximizing the optimization problem, we can calculate the ﬁrst derivative of
Us, we have
@Us
@pJ
i
¼ aW
2 ln 2 ½
A hJi;R

2
ðB þ P
N
i¼1
pJ
i hJi;R

2 þ AÞðB þ P
N
i¼1
pJ
i hJi;R

2Þ

ps hS;R

2 hJi;R

2
ðr2 þ P
N
i¼1
pJ
i hJi;R

2 þ ps hS;R

2Þðr2 þ P
N
i¼1
pJ
i hJi;R

2Þ
  ki
ð14Þ
Where A ¼ prps hS;R

2 hR;D

2, B ¼ ps hS;R

2 þ pr hR;D

2 þ r2. When @Us=@pJ
i ¼ 0, we
can obtain the forth-order polynomial equation as
pJ
i

4 þ Ci;3 pJ
i

3 þ Ci;2 pJ
i

2 þ Ci;1pJ
i þ Ci;0 ¼ 0
ð15Þ
Where Ci;n; n ¼ 0; 1; 2; 3 are formulas of A, B, ki and pJ
i . Because that the solutions of
the forth-order polynomial equation are very complex and not necessary for our fol-
lowing work, so our main interest is the parameters that affect these optimalsolutions.
Then, the optimal power solutions of the friendly jammer i can be denoted as
Power Allocation in One-Way Untrusted AF Relay System
593

pJ
i ¼ pJ
i ðA; B; fPJ
j gj6¼i; kiÞ
ð16Þ
Further, subject to the constraints, the optimal jamming power can be denoted as
pJ
i
opt ¼ minðmaxðpJ
i ; 0Þ; pmaxÞ
ð17Þ
4
Simulation Results
The proposed scheme has been simulated numerically using MATLAB software. In the
simulation, we consider a one-way AF relay network with one source, one relay, one
destination which are located at (−1, 0), (0, 0) and (1, 0) respectively. The other
parameters are deﬁned as: pmax ¼ 10, the transmission bandwidth W = 1, the noise
variance r2 ¼ 0:01 ,the path loss factor is 2, and a = 1.
When only one friendly jammer helps to the source, the two friendly jammer
locations are considered as (0.3, 0.4) and (0.6, 0.8). In Fig. 2, the power of source is set
up to pmax ¼ 10 and k ¼ 0:1, we can ﬁnd that the utility of source can be maximized,
when the jammers power is 2 and 4 respectively. And we can see, if the friendly
jammer is close to the untrusted relay, the utility function can be improved more
effectively. Figure 3 shows that the optimal jamming power is decreased with the
asking price creasing, and it is foreseeable that the jamming power which buys from the
jammer will be zero. So, when setting the price k, a tradeoff must be considered for the
friendly jammer.
In Fig. 4, two different scenarios are considered in simulations. On the one hand,
there is no sufﬁciently effective friendly jammer, which implies that maximum secrecy
rate cannot be achieved with the help of only one friendly jammer. And meanwhile, in
this scenario, the secrecy rate increases with the number of friendly jammers. When the
Fig. 2. The source’s utility versus the jamming power
594
R. Luo et al.

number of friendly jammers is 20, the secrecy rate can reach the maximum. However,
on the other hand, when there is at least one sufﬁciently effective friendly jammer,
which means that multiple friendly jammers can offer sufﬁciently effective help, we can
see that the secrecy rate remains unchanged with the number of friendly jammers
increasing.
5
Conclusions
In this paper, we have investigated the one-way untrusted relay communications with
friendly jammers. The source optimization problem is deﬁned, and the optimal solution
of jammer power is obtained. Simulation results show that the utility function of the
Fig. 3. The optimal jamming power versus asking price
Fig. 4. Secrecy rate versus the number of friendly jammers
Power Allocation in One-Way Untrusted AF Relay System
595

source can be improved with friendly jammers’ help. And there exists a tradeoff for the
price of jammers, otherwise, the source will not select the jammers as cooperators.
Acknowledgement. This work was supported by the Natural Science Foundation of Jiangsu
Province (Grants No. BK20161104), The Scientiﬁc Research Fund Project of JIT (2016 incentive
program, jit-2016-jlxm-24), the Natural Science Foundation of the Jiangsu Higher Education
Institutions of China (16KJB510011), the Doctoral Scientiﬁc Research Foundation of JIT
(jit-b-201409, jit-b-201408, jit-b-201633) and Incubation Project of Science Foundation of JIT
(jit-fhxm-201605).
References
1. Wyner, A.D.: The wire-tap channel. Bell Syst. Tech. J. 54(8), 1355–1387 (1975)
2. Csiszar, I., Korner, J.: Broadcast channels with conﬁdential messages. IEEE Trans. Inf.
Theory 24(3), 339–348 (1978)
3. Dong, L., Han, Z., Petropulu, A.P., Poor, H.V.: Amplify-and-forward based cooperation for
secure wireless communications. In: Proceedings of the IEEE International Conference on
Acoustics, Speech and Signal Processing, Taipei, Taiwan, pp. 2613–2616. IEEE Press
(2009)
4. Dong, L., Han, Z., Petropulu, A.P., Poor, H.V.: Improving wireless physical layer security
via cooperating relays. IEEE Trans. Signal Process. 58(3), 1875–1888 (2010)
5. Tekin, E., Yener, A.: The general gaussian multiple-access and two-way wiretap channels:
achievable rates and cooperative jamming. IEEE Trans. Inf. Theory 54(6), 2735–2751
(2008)
6. Zheng, G., Choo, L.-C., Wong, K.-K.: Optimal cooperative jamming to enhance physical
layer security using relays. IEEE Trans. Signal Process. 59(3), 1317–1322 (2011)
7. Zhang, H., Dong, Y., Cheng, J., Hossain, M., Leung, V.C.M.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–56 (2016)
8. Zhang, H., Chu, X., Guo, W., Wang, S.: Coexistence of Wi-Fi and heterogeneous small cell
networks sharing unlicensed spectrum. IEEE Commun. Mag. 53(3), 158–164 (2015)
9. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Magazine 55(8), 138–145 (2017)
10. Oohama, Y.: Coding for relay channels with conﬁdential messages. In: Proceedings of IEEE
Information Theory Workshop, Caims, Australia, pp. 87–89. IEEE Press (2001)
11. Oohama, Y.: Capacity theorems for relay channels with conﬁdential messages. In:
Proceedings IEEE International Symposium Information Theory, Nice, France, pp. 926–
930. IEEE Press (2007)
12. He, X., Yener, A.: Two-hop secure communication using an untrusted relay: a case for
cooperative jamming. In: Proceedings of IEEE Global Communications Conference, New
Orleans, LA, pp. 1–5. IEEE Press (2008)
13. Zhang, R., Song, L., Han, Z., Jiao, B., Debbah, M.: Physical layer security for two-way
untrusted relaying with friendly jammers. IEEE Trans. Veh. Technol. 61(8), 3693–3703
(2012)
14. He, X., Yener, A.: Cooperation with untrusted relay: a secrecy perspective. IEEE Trans. Inf.
Theory 56(8), 3807–3827 (2010)
596
R. Luo et al.

A Vehicular Positioning Enhancement
with Connected Vehicle Assistance
Using Extended Kalman Filtering
Daxin Tian1,4,5,6(&), Wenhao Liu1,4, Xuting Duan1,4, Hui Rong2,
Peng Guo2, Wenyang Wang2, and Haijun Zhang3
1 Beijing Advanced Innovation Center for Big Data and Brain Computing,
Beihang University, XueYuan Road No. 37, Beijing 100191, China
dtian@buaa.edu.cn
2 China Automotive Technology and Research Center, Automotive Engineering
Research Institute, East Xianfeng Road No. 68, Tianjin 300300, China
3 School of Computer and Communication Engineering, University of Science
and Technology Beijing, XueYuan Road No. 30, Beijing 100083, China
4 Beijing Key Laboratory for Cooperative Vehicle Infrastructure Systems
and Safety Control, School of Transportation Science and Engineering, Beihang
University, XueYuan Road No. 37, Beijing 100191, China
5 Jiangsu Province Collaborative Innovation Center of Modern
Urban Trafﬁc Technologies, Si Pai Lou. 2, Nanjing 210096, China
6 Key Lab of Urban ITS Technology Optimization and Integration,
The Ministry of Public Security of China, Hefei 230088, China
Abstract. In this paper, we consider the problem of vehicular positioning
enhancement with emerging connected vehicles (CV) technologies. In order to
actually describe the scenario, the Interacting Multiple Model (IMM) ﬁlter is
used for depicting varies of observation models. A CV-enhanced IMM ﬁltering
approach is proposed to locate a vehicle by data fusion from both coarse GPS
data and the Doppler frequency shifts (DFS) measured from dedicated
short-range communications (DSRC) radio signals. Simulation results state the
effectiveness of the proposed approach called CV-IMM-EKF.
Keywords: Vehicular positioning enhancement  Target vehicle (TV)
GPS  CV-IMM-EKF
1
Introduction
Due to the development of the ﬁfth-generation (5G) mobile communications, this new
communicated method attracts more and more attention because of its faster transfer
speed, high adaptability and better end-to-end performance [2, 3]. And the more
transfer technologies such like the ultra dense cloud small cell network (UDCSNet) [1]
are used in the construction of vehicular network. About applications, some of the
communications problems in the society have been resolved such as LTE-V systematic
and integrated V2X solution [4], software-deﬁned heterogeneous vehicular network
(SERVICE) [5], credible RTI sharing mechanism [6], trafﬁc density estimation [7] and
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 597–608, 2018.
https://doi.org/10.1007/978-3-319-72823-0_55

the physical layer outage performance of information sharing [8], and the effectiveness
in the application has improved greatly [9–11].
The availability of high-accuracy location-awareness is essential for a diverse set of
vehicular applications including intelligent transportation systems, location-based
services (LBS), navigation, as well as a couple of emerging cooperative vehicle-
infrastructure systems (CVIS) [12]. Typically, as an important technique, the real-time
vehicle positioning system has drawn great attention in the ﬁelds of transportation and
mobile communications [13]. However, it still faces a big challenge in the areas with
inconsistent availability of satellite networks, especially in dense urban areas where the
standalone global navigation satellite systems (GNSSs) (e.g., GPS). Even the high
precision GNSS equipment associated with a high cost (e.g., DGPS), sometimes pro-
vides serious outliers caused by non-line-of-sight (NLOS) (e.g., buildings, walls, trees,
vehicles, and more obstructions) and severe multipath issues [14].
The accurate positioning with sub-meter error is signiﬁcant for vehicles in vehicle
ad-hoc networks (VANETs). Because any vehicle with this capability and wireless
communications would be able to sense others accurately and simply, which is an
extremely essential factor for vehicular collision avoidance, lane change assistance and
so on [15, 16]. In [14, 18, 19], the fundamental techniques in positioning systems have
been presented based on the real-time measurements of time of arrival (TOA), time
difference of arrival (TDOA), direction of arrival (DOA), received signal strength
indicator (RSSI), Doppler frequency shift (DFS), ﬁngerprinting, and wireless channel
state information (CSI) techniques and so on. Especially, cloud-based wireless network
proposed in [20] is expected to provide ﬂexible virtualized network functions for
vehicular positioning. Recent researches indicate that these measurements are chal-
lenged by some drawbacks varying from complexities of the time synchronization,
occupations of the high-bandwidth, to huge costs on the implementations [14].
Although there already exist some location systems, such as those presented in [17],
which can achieve lane-level location performance, these systems require the accurate
detection on unique driving events through smart phones or the deployment of lane
anchors.
To tackle the aforementioned problems, a new class of cooperative positioning
(CP) methods that relies on vehicle-to-vehicle (V2V) communications and data fusion
ﬁltering [20–22] has been presented in recent years, which can further improve the
accuracy of positioning. Actually, such concern raised in CP is the reliability of the
localization approaches in heavy multipath and NLOS scenarios, which is similar to
that in indoor environment [19, 20].
Because of the low speed of vehicles, the DFS is too difﬁcult to be extracted from
noise, and thus for DFS vehicular positioning methods, the standard deviation (STD) of
positioning error increases as the relative speed between the target vehicle and the other
vehicles decreases. So we will investigate the method to overcome this problem. In this
paper, We will focus on the scenario that the neighbor vehicles travel in the opposite
direction of the target vehicle (TV), for this case can provide obviously detectable
Doppler Effect.
In this paper, we design a CV-enhanced Interacting Multiple Model Extended
Kalman ﬁlter (CV-IMM-EKF) for vehicular positioning. Firstly a ﬁrst-order Tylor
series expansion is used to transform a nonlinear problem to a linear problem.
598
D. Tian et al.

Secondly, a multiple-model is used to describe the variation of the DFS measurements.
Finally, IMM-EKF is used to estimate the target vehicle’s state. The next, we integrate
the GPS measurements from both a target vehicle and its neighbors into a vehicular
positioning ﬁlter and set a relatively conservative number of neighbors for the basic set,
which can reduce the dispensable computation complexity. And the information fusion
provides a great enhancement compared with GPS-only localization from the simu-
lation results.
The problem to be solved and the analytical models are presented in Sect. 2, the
CV-IMM-EKF steps are described in detail in Sect. 3, and the simulation results are
revealed and compared in Sect. 4. Finally, Sect. 5 concludes this paper.
2
Problem Statement
The problem to be solved is to estimate the position of a TV moving on a 2-D road,
where there are many other neighbors around the TV. All of the vehicles are able to
know their own state information, including position, velocity, etc., provided by coarse
GPS receiver and they can know the neighbors’ state information via vehicular com-
munications as well. Consequently, this case can be treated as a simple but practical
CV scenario. A TV is considered as a research object for positioning enhancement
based on CV, and a neighbor is considered as the vehicle who is within a certain
communication range to the TV and travel in the opposite direction of the TV. Each
vehicle is assumed to be with an OBU providing both the DSRC and the DFS mea-
surements [24].
Considering the ith moving vehicle at time instant k with a state vector
hi
k ¼ pi
x;k; pi
y;k; vi
x;k; vi
y;k
h
iT
, i ¼ 1; . . .; np, where the ðpi
x;k; pi
y;kÞ and
vi
x;k; vi
y;k


denote
the ith vehicle’s position and velocity, respectively, and np is the total number of the
vehicles driving on the road, and T is a transpose operator. The dynamic state can be
modeled by the following system:
hi
k ¼ Fi
k1hi
k1 þ Gi
k1 ui
k1 þ wi
k1


ð1Þ
where Fi
k1 is the state transition matrix, and Gi
k1 is the noise distribution matrix. ui
k1
is the control vector and wi
k1 is zero-mean white Gaussian noise with covariance
matrix Qi
k1.
For the dynamic model presented by (1), the following observation model can be
deﬁned:
Wk ¼ h hk
ð
Þ þ !k re
ð Þ
ð2Þ
where h ¼ pi
x;k; pi
y;k; vi
x;k; vi
y;k; x1
k; . . .; x j
k
h
iT
is a nonlinear observation vector in terms
of hk. x j
k is the DFS of the received signal from the jth neighbor, j ¼ 1; . . .; nk; nk\np,
and nk is the total number of the neighbors on the road.  k re
ð Þ is the observation noise
that can be used to describe the M types of observation errors by assuming a set of
A Vehicular Positioning Enhancement with Connected Vehicle
599

another covariance matrixes. The transition among M types of the errors is generally
modeled as a ﬁrst-order M-state homogeneous Markov chain re, e ¼ 1; 2; . . .; M.
Speciﬁcally, assuming that the DFS measurements from the OBU can be modeled
in a derivative form of the DSRC carrier frequency, f , as follows:
x j
k ¼  f
c rt d j
k þ # j
kre


ð3Þ
d j
k ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
px;k  p j
x;k

2
þ py;k  p j
y;k

2
r
ð4Þ
where c is the speed of light, d j
k is the relative distance between the TV and its neighbor
j, and # j
k is the DFS observation noise of neighbor j. Substituting (4) into (3) yields
x j
k ¼  f
c
px;k  p j
x;k


vx;k  v j
x;k


þ py;k  p j
y;k


vy;k  v j
y;k


ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
px;k  p j
x;k

2
þ py;k  p j
y;k

2
r
2
664
3
775 þ  k re
ð Þ
ð5Þ
where ðpi
x;k; pi
y;kÞ and
vi
x;k; vi
y;k


is the position and velocity vector of the neighbor j.
To solve this nonlinear observation function, with the ﬁrst-order Taylor expansion of
(5) around an arbitrary state vector, h can be transformed to a ﬁxed form of matrix, in
which all of the components are supposed to obtain from both the GPS and OBU. As a
result, the observation model of the TV can be reformulated as a linear one:
Zk ¼ Hkhk þ  k re
ð Þ
ð6Þ
and with the observation transition matrix:
Hk ¼
1
0
0
0
0
1
0
0
0
0
1
0
0
0
0
1
h11
k
h12
k
h13
k
h14
k
...
...
...
...
hj1
k
hj2
k
hj3
k
hj4
k
2
6666666664
3
7777777775
ð7Þ
where
hj1
k ¼ rpx;k x j
k


¼  f
c
py;k  p j
y;k


d j
k

3
py;k  p j
y;k


vx;k  v j
x;k


þ px;k  p j
x;k


vy;k  v j
y;k


h
i
ð8Þ
600
D. Tian et al.

hj2
k ¼ rpy;k x j
k


¼  f
c
px;k  p j
x;k


d j
k

3
px;k  p j
x;k


vy;k  v j
y;k


þ py;k  p j
y;k


vx;k  v j
x;k


h
i
ð9Þ
hj3
k ¼ rvx;k x j
k


¼  f
c
px;k  p j
x;k


d j
k
ð10Þ
hj4
k ¼ rvy;k x j
k


¼  f
c
py;k  p j
y;k


d j
k
ð11Þ
Based on the aforementioned models from (1) and (6), it is reasonable to assume
that Fi
k1 and Gi
k1 in the system model are invariable at both each time instant and
vehicle. Therefore, the position estimation of the TV can be formulated as the problem
of linear ﬁltering for M-state jump Markov systems and the model can be simpliﬁed as:
hi
k ¼ Fhi
k1 þ G ui
k1 þ wi
k1


Zk ¼ Hkhk þ  k re
ð Þ
(
ð12Þ
Because Hk can be estimated by data fusion from both the GPS and OBU at each
time instant k, a CV-enhanced Interacting Multiple Model Extended Kalman ﬁlter
(IMM-EKF) can be deployed.
3
Connected Vehicles-Enhanced Interacting Multiple Model
Extended Kalman Filtering for Vehicular Positioning
In this section, we adopt the IMM approach to propose a vehicular positioning
enhancement algorithm based on CV. The structure of the vehicular positioning system
is illustrated in Fig. 1.
And the steps of this algorithm is as followed:
Step (1) Mixing Probabilities and State Estimates
lk þ 1;sjt ¼ pstlk;s=ct
ð13Þ
where lk þ 1;sjt is known as the mixing probability in the IMM estimator, lk;s is the
probability of the event that the sth motion model is in effect at time step k, s; t ¼
1; 2; . . .; M, correspond to the s; tth mode of the Markov chain re, and
ct ¼
XM
s¼1 pstlk;s
ð14Þ
A Vehicular Positioning Enhancement with Connected Vehicle
601

where ct is a normalization constant and
h0
kjk;t ¼
XM
s¼1 lk þ 1;sjth0;0
kjk;t
ð15Þ
P0
kjk;t ¼
XM
s¼1 lk þ 1;sjt 
P0;0
kjk;t þ h0;0
kjk;t  h0
kjk;t
h
i
h0;0
kjk;t  h0
kjk;t
h
iT


ð16Þ
Step (2) Mode Update and Prediction Steps
Calculate hj1
k ; hj2
k ; hj3
k ; hj4
k , according to the Eqs. (8)–(11) and then update the
observation transition matrix Hk deﬁned in (7).
The CV-IMM-EKF advanced prediction is given by
hkjk1;t  Fkhk1jk1;t ¼ Fhk1jk1;t
ð17Þ
and the State prediction error covariance matrix is as follows:
Pkjk1;t  FkPk1jk1;t Fk
ð
ÞT þ Qk1 ¼ FPk1jk1;tFT þ Qk1
ð18Þ
From the previous data, the CV-IMM-EKF gain is given by
Kk ¼ Pkjk1;tHT
k uk N
ð Þ
ð
Þ

Hk uk N
ð Þ
ð
ÞPkjk1;tHT
k uk N
ð Þ
ð
Þ þ Rk re N
ð Þ
ð
Þ
	

1
ð19Þ
where uk N
ð Þ and re N
ð Þ are functions of N and can change the dimension of the
observation transition matrix Hk and the covariance matrix Rk, respectively.
Fig. 1. Vehicular positioning system with information fusion of the DFS and GPS measure-
ments from both itself and the other neighbors
602
D. Tian et al.

The CV-IMM-EKF update steps are given by
h0
kjk;t ¼ h0
kjk1;t þ Kk Zk  Hk uk N
ð Þ
ð
Þh0
kjk1;t
n
o
ð20Þ
P0
kjk;t ¼ P0
kjk1;t  Kk Zk  Hk uk N
ð Þ
ð
Þh0
kjk1;t þ Rk re N
ð Þ
ð
Þ
n
o
KT
k
ð21Þ
The CV-IMM-EKF prediction steps are given by
h0
k þ 1jk;t ¼ Fh0
kjk;t þ Glk;t
ð22Þ
P0
k þ 1jk;t ¼ Fh0
kjk;tFT þ GQGT
ð23Þ
The likelihood function Kk;t and predicted mode probability lk;t are given by
Kk;t ¼ N
Zk  Hk uk N
ð Þ
ð
Þh0
kjk1;t;
0; Hk uk N
ð Þ
ð
ÞP0
kjk1;tHT
k uk N
ð Þ
ð
Þ þ Rk re N
ð Þ
ð
Þ
 
!
ð24Þ
lk;t ¼ Kk;tct=c
ð25Þ
where c is a normalizing constant deﬁned as follows:
c ¼
XM
t¼1 Kk;tct
ð26Þ
Step (3) Estimates Combination
hkjk ¼
XM
t¼1 lk;thkjk;t
ð27Þ
Pkjk ¼
XM
t¼1 lk;t 
Pkjk;t þ hkjk;t  hkjk


hkjk;t  hkjk

T
n
o
ð28Þ
4
Numerical Study
4.1
Simulation Scenario
A basic set with N neighbors for the TV can be formed through Algorithm
CV-IMM-EKF. Considering a section of urban roads, which is with a width of four
lanes (each one is 3:5 m wide) and a length of one kilometer. It is assumed that the
trafﬁc density of the road section is 20 vehicies=km and the average speed of trafﬁc is
generated stochastically in duration from 50 km=h to 60 km=h following a uniform
distribution. The initial positions of the neighbors are generated stochastically on the
road following a uniform distribution as well. The vehicle dynamics described in (12)
is with
A Vehicular Positioning Enhancement with Connected Vehicle
603

F ¼
I
DtI
O
I


; G ¼
1
2 Dt2I
DtI


ð29Þ
where I is a 2  2 identity matrix, O is a 2  2 zero matrix, and Dt is the sampling
period. The control vector in (12) is ui ¼ 0 0:01
½
T. The noise vector wi
k1 ¼
rax;k1; ray;k1

T  N 0; Q
ð
Þ, with covariance matrix Q ¼ diag r2
ax; r2
ay
h
i
; where the
elements rax;k1 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
0:99=2
p
and ray;k1 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
0:01=2
p
are the acceleration noises along
the X and Y-axis, respectively, with standard deviation (STD) in m=s2. The covariance
matrix R re
ð Þ of observation noise !k re
ð Þ  N 0; R re
ð Þ
ð
Þ is described as a ﬁrst-order
Markov
chain
switching
between
two
models
R r1
ð Þ ¼ diag r2
px; r2
py; r2
vx; r2
vy;
h
r2
x1 r1
ð Þ; . . .; r2
xN r1
ð Þ
and
R r2
ð Þ ¼ diag r2
px; r2
py; r2
vx; r2
vy; r2
x1 r2
ð Þ; . . .; r2
xN r2
ð Þ
h
i
,
of
which the elements are with STDs in units of m; m=s2 and Hz. The transition proba-
bility for this Markov chain is pr1r2 ¼
0:9
0:1
0:1
0:9


and their initial probability is
l0 ¼ 0:5 0:5
½
. According to the achievable performance discussed in [12, 19], as the
number of the neighbors is increasing, the performance enhancement can be less
obvious and lead to more additionally computational burden. Therefore, we set N ¼ 4,
which is a relatively conservative number of the neighbors for the basic set, which is
mentioned in Algorithm CV-IMM-EKF.
The vehicles that start at the ﬁrst two lanes from the bottom move towards the
positive direction of the X-axis in Fig. 2. On the contrary, the vehicles that start at the
ﬁrst two lanes from the top move towards the negative direction of the X-axis. The
‘black dot’ and ‘red note’ denote the initial positions of the TV and the neighbors,
respectively. The TV starts at position (300,5) in m, with the initial velocity vector
(60,0) in m=s2. However, because of the system noise and control vector set in the
dynamics model, the actual velocity is changing slightly over the sampling period.
In the simulations, the sampling period and length are taken to be 0:2 s and 100,
respectively, and the communication range of the DSRC is 300 m. As the DFS mea-
surements presented in [19, 22], the Probability Density Function (PDF) of the DFS is
approximately zero-mean asymmetric Gaussian with the left and right STDs of 100 Hz
and 120 Hz, when the vehicles travel at the speed of 60 km=h, broadcasting the DSRC
packets with a frequency of 5:89 GHz and a rate of 100 packets=s. It is worth noting
that the PDF of the DFS remains a fairly consistent estimation from LOS to NLOS.
Fig. 2. Initial scenario (Color ﬁgure online)
604
D. Tian et al.

Considering the noise of the DFS measurements as zero-mean Gaussian with two states
of STDs: rwN r1
ð Þ ¼ 100 Hz and rwN r2
ð Þ ¼ 120 Hz. Speciﬁcally, the state of the
observation noise remains unchanged in r1 between 0 to 6 s, and changes in the
following 10 s to r2. Finally, the state changes back to r1 for another 4 s. The position
and velocity measured by GPS are assumed to be added noise with the variance
rpx ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
200=2m
p
; rpy ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
200=2
p
m


and
rvx ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
15=2m
p
; rvy ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
15=2
p
m


,
respectively.
4.2
Simulation Results
From the Fig. 3, the Mean-CV-EKF has a higher order of magnitude than the Mean-
CV-IMM-KF and the Mean-GPS, and change curve ﬂuctuates greatly. So the inter-
acting multiple model is necessary and we should ignore the huge error on numerical
value and put the next two in the Fig. 4 to compare the errors.
To quantify the performance of the proposed approach, the root mean square error
(RMSE) of vehicular positioning is calculated to assess the closeness of the estimated
trajectory
^px;k; ^py;k


to the true trajectory
px;k; py;k


at each time instant over Nm ¼
500 Monte Carlo simulations. In (28), ^px;k m
ð Þ; ^py;k m
ð Þ


denotes the estimated position
vector in the mth Monte Carlo run at the kth step.
RMSE ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1
Nm
XNm
m¼1
^px;k m
ð Þ  px;k

2 þ ^py;k m
ð Þ  py;k

2
h
i
r
ð30Þ
The performance comparison between the proposed CV-IMM-EKF and the
GPS-only approach is shown in Fig. 3 with respect to the RMSE in distance. It is
obvious that the proposed CV-IMM-EKF method outperforms the GPS alone
Fig. 3. CV-EKF, CV-IMM-EKF and GPS performance in positioning error
A Vehicular Positioning Enhancement with Connected Vehicle
605

localization. In order to indicate the enhancement of vehicular positioning of the
proposed approach, the enhancement indicator l is calculated as follows:
l ¼
1  A RMSE
B RMSE


 100%
ð31Þ
The enhancement of vehicular positioning is shown in Table 1. Compared to the
GPS-based localization, the proposed CV-IMM-EKF approach achieves the enhance-
ment of l ¼ 40:15%.
If A RMSE is better than B RMSE, l will be greater than zero. And the increase of
l is link to the good performance of A RMSE. By describing the transition of the
measurement noise as a ﬁrst-order M-state jump Markov chain, the proposed
CV-IMM-EKF approach has been proved to achieve better performance in a scenario
that is similar to a practical one.
5
Conclusion
In this paper, a vehicular positioning algorithm has been proposed. The observation
transition matrix and the covariance matrix of observation noise are updated by the
fusion data at each time instant with the assistance of CV, which provide additional
Fig. 4. CV-IMM-EKF and GPS performance in positioning error
Table 1. CV-IMM-EKF and GPS error comparison
Method
RMSE
Enhancement
GPS
14.3268 N/A
CV-IMM-EKF
8.5032 40.15%
606
D. Tian et al.

useful information compared to the traditional ﬁltering approach. Finally, the simula-
tion results show that the proposed approach outperforms the GPS-based localization.
Acknowledgments. This research was supported in part by no. Beijing Science and Technology
Program no. D171100000317003 and the National Natural Science Foundation of China under
Grant nos. 61672082, U1564212.
References
1. Chen, S., Hu, J., Shi, Y., Zhao, L.: LTE-V: A TD-LTE based V2X solution for future
vehicular network. IEEE Internet Things J. 3(6), 997–1005 (2016)
2. Chen, S., Zhao, J.: The requirements, challenges and technologies for 5G of terrestrial
mobile telecommunication. IEEE Commun. Mag. 52(5), 36–43 (2014)
3. Cortéspolo, D., Callecancho, J., Carmonamurillo, J., Gonzálezsánchez, J.: Future trends in
mobile-ﬁxed integration for next generation networks: classiﬁcation and analysis. Int. J. Veh.
Telematics Infotain. Syst. (IJVTIS) 1(1), 33–53 (2017)
4. Gaamel, A.M., Maratha, B.P., Sheltami, T.R., Shakshuki, E.M.: Fault-tolerance evaluation
of VANET under different data dissemination models. Int. J. Veh. Telematics Infotain. Syst.
(IJVTIS) 1(1), 54–68 (2017)
5. Huang, Y., Wang, J., Jiang, C., Zhang, H., Leung, V.C.M.: Vehicular network based reliable
trafﬁc density estimation. In: Proceedings of the IEEE Vehicular Technology Conference
(VTC), Nanjing, 15–18 May 2016
6. Jiang, C., Zhang, H., Han, Z., Cheng, J., Ren, Y., Hanzo, L.: On the outage probability of
information sharing in cognitive vehicular networks. In: Proceedings of IEEE International
Conference on Communications (ICC), Kuala Lampur, Malaysia, 23–27 May 2016
7. Mir, Z.H., Filali, F.: A simulation-based study on the environment-speciﬁc propagation
model for vehicular communications. Int. J. Veh. Telematics Infotain. Syst. (IJVTIS) 1(1),
1–18 (2017)
8. Pressas, A., Özpolat, M., Sheng, Z., Ali, F.: Performance evaluation of networking protocols
for connected vehicles. Int. J. Veh. Telematics Infotain. Syst. (IJVTIS) 1(1), 1–14 (2017)
9. Zhang, H., Dong, Y., Cheng, J., Leung, V.C.M.: Fronthauling for 5G LTE-U ultra dense
cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
10. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A.H., Leung, V.C.M.: Network slicing
based 5G and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. 55(8), 138–145 (2017)
11. Zheng, Q., Zheng, K., Zhang, H., Leung, V.C.M.: Delay-optimal virtualized radio resource
scheduling in software-deﬁned vehicular networks via stochastic learning. IEEE Trans. Veh.
Technol. 65(12), 9479–9492 (2016)
12. Alam, N., Dempster, A.G.: Cooperative positioning for vehicular networks: facts and future.
IEEE Trans. Intell. Transp. Syst. 14, 1708–1717 (2013)
13. Rappaport, T.S., Reed, J.H., Woerner, B.D.: Position location using wireless communica-
tions on highways of the future. IEEE Commun. Mag. 34, 33–41 (1996)
14. Zekavat, R., Buehrer, R.M.: Handbook of Position Location: Theory, Practice and
Advances, vol. 27. Wiley, Hoboken (2011)
15. Jiang, S., Ji, Y.: Artiﬁcial ﬁsh swarm algorithm for solving road network equilibrium trafﬁc
assignment problem. Comput. Simul. (2011). ISSN 1006-9348, 06-0326-04
A Vehicular Positioning Enhancement with Connected Vehicle
607

16. Sengupta, R., Rezaei, S., Shladover, S.E., Cody, D., Dickey, S., Krishnan, H.: Cooperative
collision warning systems: concept deﬁnition and experimental implementation. J. Intell.
Transp. Syst. 11, 143–155 (2007)
17. Shladover, S.E., Tan, S.-K.: Analysis of vehicle positioning accuracy requirements for
communication-based cooperative collision warning. J. Intell. Transp. Syst. 10(3), 131–140
(2006). http://www.tandfonline.com/doi/abs/10.1080/15472450600793610
18. Alam, N., Balaei, A.T., Dempster, A.G.: A DSRC Doppler-based cooperative positioning
enhancement for vehicular networks with GPS availability. IEEE Trans. Veh. Technol. 60,
4462–4470 (2011)
19. Tian, D., Zhu, K.: Swarm model for cooperative multi-vehicle mobility with inter-vehicle
communications. J. IET Intell. Transp. Syst. 9, 887–896 (2015)
20. Sayed, A.H., Tarighat, A., Khajehnouri, N.: Network-based wireless location: challenges
faced in developing techniques for accurate wireless location information. IEEE Sig.
Process. Mag. 22, 24–40 (2005)
21. Duan, X., Wang, Y., Tian, D., et al.: A vehicular positioning enhancement with connected
vehicle assistance. In: IEEE Vehicular Technology Conference, pp. 1–5. IEEE (2015)
22. Schmidl, T.M., Cox, D.C.: Robust frequency and timing synchronization for OFDM. IEEE
Trans. Commun. 45, 1613–1621 (1997)
608
D. Tian et al.

A Multi-queue Aggregation Framework
for M2M Traﬃc in LTE-A
and Beyond Networks
Wen Feng, Hongjia Li(B), Ding Tang(B), Liming Wang, and Zhen Xu
State Key Laboratory of Information Security, Institute of Information Engineering,
Chinese Academy of Sciences, Beijing 100093, China
{lihongjia,tangding}@iie.ac.cn
Abstract. Traﬃc aggregation has been considered as an eﬀective app-
roach to improve the radio resource utilization for M2M communication
in LTE-A and beyond networks. In the LTE-A speciﬁcation, the Relay
Node (RN) is recommended to aggregate uplink M2M small-sized pack-
ets. However, the delay brought by the packets aggregation is inevitably
increased, which is a vital metric for M2M packets with low delay require-
ment, such as emergency alerting. In this paper, we propose a new frame-
work for optimal aggregation implemented in the PDCP of RN, which
features balancing a tradeoﬀbetween QoS requirements of packets and
the utilization eﬃciency of Physical Radio Blocks (PRBs). Speciﬁcally,
(1) the RN dispatches the new arrival M2M packets into correspond-
ing virtual queues according to their priorities set by M2M devices.
Then, an Optimal Aggregating Scheme (OAS) is designed to minimize
the PRB usage in condition satisfying the speciﬁc restriction of waiting
time of packets in virtual queues. (2) The optimal aggregating problem is
proved to be a NP-hard problem, which is solved by the Priority Branch
and Bound Algorithm (PBBA) and the Priority Aggregating Heuristic.
Numerical results illustrate that OAS achieves a tradeoﬀof QoS and
PRB utilization eﬃciency in comparison with four existing schemes.
Keywords: M2M · Quality of service · Packet aggregation · LTE-A
1
Introduction
Massive Machine-to-Machine (M2M) communication is considered as the poten-
tial important research direction in 5G networks. M2M communication is a pat-
tern which identiﬁes the evolving paradigm of interconnected devices communi-
cating with each other without or with limited human interaction. The applica-
tion domain of M2M traﬃc includes smart metering, e-health, surveillance and
security, intelligent transportation, city automation, smart monitoring and many
more. M2M traﬃc patterns vary in diverse application domains and in most of
the applications, and especially some M2M devices mainly are small packets that
consist of a few bytes. Because the payload of the data packets associated with
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 609–621, 2018.
https://doi.org/10.1007/978-3-319-72823-0_56

610
W. Feng et al.
M2M applications is usually smaller than a Physical Resource Block (PRB) [1].
Thus, M2M traﬃc is supposed to degrade the utilization of radio spectrum. In
addition, M2M devices can have diﬀerent delay tolerances based on their appli-
cations, ranging from a few milliseconds (ms) to several minutes or even hours,
e.g., emergency alerting may need to provide a very stringent low delay, while
temperature monitoring can owe a great delay tolerance [2]. Therefore, it is a
signiﬁcant problem for the evolution of M2M communication to improve the
utilization of radio spectrum and satisfy delay requirement.
Packets or traﬃc aggregation, which collects and accumulates data packets
from multiple nodes before transmitting to the next hop, is supposed to eﬀec-
tively improve the utilization of radio spectrum for M2M traﬃc in future 5G
networks because of reducing the extra overhead and adding the size of data in
a PRB. For example, packets aggregation signiﬁcantly improves the PRB utiliza-
tion compared to the conventional without multiplexing approach [3]. However,
packets aggregation inevitably results in the delay increasing of M2M appli-
cation. Because the incoming packets can be transmitted only when certain
aggregation conditions are satisﬁed. Therefore, it is a fundamental problem to
obtain a tradeoﬀbetween Quality-of-Service (QoS) requirements of packets and
the utilization eﬃciency of Physical Radio Blocks (PRBs).
Some eﬀorts have been separately made to improve radio spectrum utiliza-
tion and reduce time delay of M2M communication. For instance, in [4], the
authors propose a data aggregation scheme which aggregates uplink M2M traf-
ﬁc by sharing the PRBs to increase the number of M2M packet in a PRB.
Reference [5] eﬃciently integrates M2M traﬃc into cellular networks to take
advantage of uplink transmission time slot and reduce resource wastage at both
the network and device. Authors in [6] propose an optimal aggregation for multi-
rate WLANs to minimize overall transmission time. In [7], a packet chunking
is introduced which need multiple buﬀers and then classiﬁes the arrival packets
to one buﬀer based on their acceptable waiting time to take the best use of
the core router’s forwarding capacity. However, few arts have delved into the
combination of improving radio spectrum utilization and reducing time delay of
M2M packets.
Thus motivated, we propose a new framework for optimal aggregation, which
features balancing a tradeoﬀbetween QoS requirements of packets and the uti-
lization eﬃciency of PRBs. For this purpose, a Relay Node (RN) of LTE-A are
introduced to aggregate uplink M2M traﬃc. The main contributions are sum-
marized below. (1) The RN dispatches the new arrival M2M packets into cor-
responding virtual queues according to their priorities set by the M2M devices.
Then, an Optimal Aggregating Scheme (OAS) is designed to minimize the PRB
usage in condition satisfying the speciﬁc restriction of waiting time of packets in
virtual queues. (2) In order to solve the optimal aggregating problem which is
proved to be a NP-hard problem, we propose a Priority Branch and Bound Algo-
rithm (PBBA). Due to the low computational eﬃciency of PBBA, the Priority
Aggregating Heuristic is introduced.

A Multi-queue Aggregation Framework for M2M Traﬃc
611
The rest of this paper is organized as follows. Section 2 overviews the frame-
work of optimal traﬃc aggregation. Section 3 presents the optimal aggregating
problem formulation and the solution algorithms. Section 4 evaluates the perfor-
mance of our proposed algorithms. Finally, Sect. 5 concludes the paper.
2
The Framework of Optimal Traﬃc Aggregation
2.1
System Framework
In this part, we propose a new framework for optimal aggregation implemented
in the Packet Data Convergence Protocol (PDCP) of RN as shown in Figs. 1 and
2. Traﬃc from M2M devices located in the proximity of an RN is accumulated
at the RN. According to 3GPP speciﬁcation [8], the access link (Uu) and the
backhaul link (Un) antennas of the RN are assumed to be well separated in order
to avoid self-interference. We have made two changes in RN. First, in order to
satisfy delay requirement of diverse applications, multiple queues are introduced
in the PDCP of RN, which are used to distinguish various applications. Second,
the operation of de-multiplexes is made in the GPRS Tunnelling Protocol (GTP)
of Public Data Network GateWay (P-GW) to reduce the additional overheads.
Fig. 1. An illustration of M2M packet ﬂow with the packets aggregation in from UE
to DeNB.
We consider an uplink priority aggregated scenario in RN. As shown in Fig. 1,
packets of User Equipment (UE) are aggregated by the RN, and then are tran-
sited to DeNB. Packets are aggregated at the PDCP layer of RN in order to
maximize the multiplexing gain. The main functionalities and services of PDCP
layer for the user plane include header compression and decomposition, user data
transfer, delivery of upper layer packet data units (PDUs) in sequence, as well
as retransmission of the lost PDCP service data units (SDUs), etc. On the other
hand, the control plane services include ciphering and integrity protection and
transfer of control plane data.

612
W. Feng et al.
When arriving at the PDCP layer of RN, the incoming data packet is
scheduled to one of six virtual queues which are mapping six priority levels
as p ∈{1, 2, 3, 4, 5, 6}. We assume that p = 1 (resp. p = 6) corresponds to the
highest (resp. lowest) priority level. The six virtual queues are used to distin-
guish six services as shown in Table 1. According to 3GPP TS 36.107 [9], the
typical Human-to-Human (H2H) services are divided into four diﬀerent QoS
classes, namely conversational, streaming, interactive and background, in which
the diﬀerentiation have mainly considered the delay requirement. However, some
of M2M applications cannot be properly mapped to the four QoS classes, espe-
cially emergency alerting and some applications of delay tolerant as shown in
[10]. Thus, we extend the typical H2H services classiﬁcation scheme. An indica-
tive classiﬁcation scheme, adding two service classes (i.e. emergency alerting and
time tolerant), is shown in Table 1.
Table 1. M2M applications classiﬁcation
Priority level Service classes
Waiting time
1
Emergency Alerting 0 ms
2
Conversational
10 ms
3
Streaming
100 ms
4
Interactive
1 s
5
Background
10 s
6
Time Tolerant
100 s
By scheduling, some packets in six virtual queues are aggregated and sent
to GTP. Then, the RN adds the additional overheads such as the GTP, User
Datagram Protocol/Internet Protocol (UDP/IP), PDCP and Radio Link Control
(RLC), and sends to P-GW via a GTP tunnel. A GTP option is added before
packet is sent to P-GW, which can provide the needed information for extracting
the original small packets in the aggregated packet. The aggregated packet ﬂow
from RN to P-GW when adding the GTP option is given in Fig. 2.
When receiving the aggregated packet, the P-GW de-multiplexes and
extracts the original transmitted standalone packets according to the GTP
option information, and then sends them to Public Data Network (PDN).
Finally, the original small packets are sent to the application servers. The P-GW
also serves the regular LTE-A traﬃc. If the packets are received from regular
users, then the P-GW directly forwards them to PDN. On the other hand, if
the aggregated packet are received from the RN, the original small packets are
extracted by P-GW, and then sent to PDN.
2.2
Optimal Aggregating Scheme (OAS)
In this part, an Optimal Aggregating Scheme (OAS) is designed, which minimize
the PRB usage in condition satisfying the speciﬁc restriction of waiting time of

A Multi-queue Aggregation Framework for M2M Traﬃc
613
Fig. 2. The aggregated packet ﬂow from RN to P-GW when adding the GTP option.
packets in virtual queues. Here, we denote L as the total size of all the packets
in the virtual queues, and Lmax as the maximum size that RN can aggregates
the incoming M2M packets according to the size of available transport block
- RN Un protocol overhead, see Fig. 1. The size of available transport block is
determined by the number of PRB allocated by DeNB in a transmission time
interval (TTI). According to [11], The minimum scheduling resource unit in LTE
that are allocated to a single UE is a PRB in a TTI. A PRB can transmit several
hundred bits under favorable channel conditions [12]. For example, 712 bits are
sent in a TTI with an Modulation and Coding Scheme (MCS) of 26 when a PRB
allocated by DeNB. The RN Un protocol overhead is 46 bytes: 12 bytes for GTP,
8 bytes for UDP, 20 bytes for IP, 1 byte for PDCP, 2 bytes for RLC, and 3 bytes
for the MAC overhead. The payload of the data packets associated with M2M
applications is IP packet. it will increases when the GTP option is added.
Priority Classiﬁcation when arriving at the PDCP layer of RN, the incoming
data packet is scheduled as shown in Step A of Fig. 3, which dispatchs it to
one of the virtual queues according to its priority level. Before sent to RN, the
packet’s priority level p would be set at the Type of Service (ToS) segment of IP
header by M2M devices. In the Transmission Control Protocol/Internet Protocol
(TCP/IP), ToS segment of IP header has three bits that indicate six priority
levels as shown by Table 1.
Packets Scheduling after priority classiﬁcation, the M2M packet is placed into
the tail of the corresponding virtual queue as shown in Step B of Fig. 3. Each
arrival packet starts a waiting timer when in the virtual queue, which records
the waiting time t of the incoming packet. The waiting time t is the time that the
packet stay in PDCP of RN. Due to diﬀerent delay requirements for the virtual
queues, a waiting time T is introduced for the virtual queues, which denote the
current waiting time of the virtual queues and is equal to the waiting time of
head-of-line packet in that virtual queue. Without loss of generality, let Tmax
denotes the maximum waiting time of the virtual queues.

614
W. Feng et al.
Fig. 3. The M2M schedule procession of packets at the PDCP layer of RN.
Aggregation when some aggregating conditions are satisﬁed, a optimal aggre-
gating sequence of M2M packets is selected and aggregated into a large aggre-
gated packet as shown in Step C of Fig. 3. We set two aggregating conditions:
(a) The total size L exceed the maximum aggregated size of RN Lmax; (b) The
waiting time Tp (p ∈{1, 2, 3, 4, 5, 6}) is greater than the maximum waiting time
T p
max. Tmax is set a suitable value for six virtual queues according to character-
istic of M2M packets in virtual queue. For example, the packet of the highest
priority will be served immediately when incoming, and the packet of the lowest
priority can be set a high value due to delay tolerance.
Packets Sending the aggregated packet is sent through one of M channels
that are mapping the size of transport block allocated by DeNB, as shown in
Step D of Fig. 3. Which channels are selected is determined by the number of
PRB allocated by DeNB.
3
Optimal Aggregating Problem Formulation
and Solution Algorithm
3.1
Optimal Aggregating Problem Formulation
We denote the set of all the packets in the PDCP of RN as I with integer index
i ∈{1, 2, 3, ...}, and each packet has two attributes: the priority pi and the length
li. We assume that 0-1 decision variable ρi indicate whether the data packet i is
selected by RN, which is deﬁned as
ρi =

1,
if the packet i is selected
0,
else
.
(1)
Meanwhile, the weight value of each UE’s packet i in virtual queues, denoted
by vi, is deﬁned as follows
vi = ti
pi
,
(2)

A Multi-queue Aggregation Framework for M2M Traﬃc
615
where pi and ti separately are the priority level and the waiting time of the
packet i, and vi represents the weight value of the packet i that is a signiﬁcant
parameter that distinct priority packets can be treated diﬀerently. vi has two
main purposes: let the high priority packet can be served faster than the low,
and increase the probability that the low priority packets are served.
The goal of the following formulated problem is to obtain the optimal aggre-
gating sequence of M2M packets such that the total weight value P(ρ) is maxi-
mized at any TTI.
max
ρ
P(ρ) =
n

i=1
viρi,
s.t.
n

i=1
liρi ≤Lmax, (A)
ρi ∈{0, 1}, ∀i ∈I, (B)
,
(3)
where ρ = {ρi, i ∈I} is the set of decision variables for the UE’s packet in the
PDCP of RN, and n is the total number of all UE’s packets in the virtual queues.
Due to constraint (B), this problem has been well proved NP-hard in [13].
3.2
Priority Branch and Bound Algorithm
In order to solve the proposed optimal aggregating problem in (3), we propose a
priority branch and bound algorithm (PBBA) as given in Algorithm 1. Branch
and bound algorithm (BBA) has the attractive feature to reach the optimal
solution, it is suﬃcient to enumerate only some of the possible by branching
and bounding strategies. Speciﬁcally, the proposed algorithm consists of two
stages: the waiting stage and the aggregating stage. In the waiting stage, the
proposed algorithm distributes the incoming packet to one of the virtual queues,
and checks the aggregating conditions. If satisfying the aggregating condition,
it comes into the aggregating stage. If not, it go to the next cycle. In the aggre-
gating stage, it sorts packets descending order by the weight value, and then get
the aggregated packet with ρ by BBA. Finally it send the aggregated packet
to DeNB.
The principle behind BBA is perform a systematic enumeration of candidate
solutions. The search process is done in a tree structure manner, which starts
at the root node and goes down in the tree. Taking problem (3) as the root
problem, we denote the optimal variables as ρ∗(0)
i
and its optimal solution as
P∗(0). Then if all ρ∗(0)
i
in ρ∗(0)
i
are binary, the root problem is terminated and
the optimal to the original problem (3) is found. If not, the root problem on
the ﬁrst non-integer ρi, which is named as the branching variable, will be split
into two more subproblems S(P(0)
1 ) and S(P(0)
2 ) by adding two upper bound
and lower bound constraints. The new formed sub-problems can be generally
expressed as

616
W. Feng et al.
Algorithm 1. PBBA
Set Lmax = (available TBS - RN Un overhead) and L = 0;
Initialize Tp and T p
max for each queue p;
while packet arrival == TRUE do
The incoming packet i is put into one of virtual queue p according to it’s priority;
Starts the waiting timer ti for the incoming packet i and update L and Tp;
if L ≥Lmax && Tp ≥T p
max then
Update the value v for all the incoming packets;
Get ρ via algorithm 2;
Aggregate all the packets that satisfy ρi = 1;
Send large aggregated packet to RN PHY via RN Un protocols;
Add RN Un protocols overhead;
Route multiplexed packet to DeNB in next TTI;
Update Lmax from the DeNB;
Break;
end if
end while
max
ρ
P(ρ),
s.t.
n

i=1
liρi ≤Lmax, ∀i, (A)
ρi ≥0, ∀i\(i′), ∀i ∈I, (B′)
ρi′ = 0
(4)
and
max
ρ
P(ρ),
s.t.
n

i=1
liρi ≤Lmax, ∀i, (A)
ρi ≥0, ∀i\(i′), ∀i ∈I, (B′)
ρi′ = 1
,
(5)
where i′ is the index of the branching variable. The depth ﬁrst strategy [14] is
adopted, where the search goes down the tree until it reaches the ﬁrst binary
solution or reaches infeasibility, and then it backtracks the non-visited nodes
recorded by a last-in-ﬁrst-out stack. Therefore, we ﬁrst go down to sub-problem
(4). The optimal variables and optimal objective function is solved as ρ∗(1) and
P∗(1) respectively. Again if any value of ρ∗(1) is not binary, problem (4) is split
into two more sub-problems. This branch and bound process will be repeated
until the optimal solution to the relaxed sub-problem satisﬁes all constraints
with maximum objective function.

A Multi-queue Aggregation Framework for M2M Traﬃc
617
Algorithm 2. BBA
Set the best lower bound P(low) = 0 and ρ = ∅;
Initialize the problem stack with the root problem as S = {S(P(0))};
while S ̸= ∅do
Pop a node problem S(P(j)) from stack S;
Solve S(P(j)) to obtain the optimal variables; ρ∗(j) and the optimal objective
value P∗(j);
if P∗(j) ≥P(low) then
if ρ∗(j) are all integers then
Set P(low) = P∗(j) and ρ∗= ρ∗(j);
Delete S(P(j)) from stack S, i.e., S := S\S(P(j));
Continue;
else
Branch S(P(j)) into two sub-problems S(P(j)
1 ) and S(P(j)
2 ) as (4) and (5);
Push S(P(j)
1 ) and S(P(j)
2 ) to S;
end if
end if
Delete S(P(j)) from stack S, i.e., S := S\S(P(j));
end while
3.3
Priority Aggregating Heuristic
The OAS improves performance by maximizing the utilization eﬃciency of PRB,
while the potential loss in performance comes from increase of the waiting time,
especially in high arrival rate, a sharp increase of the waiting time. Therefore, we
design a Priority Aggregating Heuristic (PAH) that can be implemented in real
system. The PAH is identical to adopting the greedy algorithm (GA) instead
of BBA in PBBA. The GA has given in Algorithm 3. It work as follows. First,
deﬁne six pointers, which respectively point to the HOL packet of the six virtual
queues. Then get the packet which is the largest weight value among six packets
that the six pointers point to. If the size of the aggregating buﬀer is smaller
than Lmax when the packet is put into the aggregating buﬀer, the packet is
marked as ρ = 1 and put into the aggregating buﬀer. If not, marked as ρ = 0
and the pointer of the corresponding packet is moved to the next packet, until
all the packets of the virtual queues have been marked. This is a low-complexity
implementation of OAS that does not consider complex BBA. The PAH is an
online algorithm that generates one aggregated packet at a time. If there are n
packets in the virtual queues, the algorithm is O(n).
4
Performance Evaluation
4.1
Simulation Setups
The network model Setup: The 1000 × 1000 m2 square simulation scenario is set
up, where RN is placed near the centre, UEs are uniformly and independently

618
W. Feng et al.
Algorithm 3. GA
Set six pointers which point to the head-of-line (HOL) packet in virtual queues;
The current size S == 0;
for all the packets in virtual queues do
CP == the packet of the maximum weight value v among six pointers;
if S + the size of packet CP > Lmax then
Set ρCP = 1;
S = S + the size of packet CP;
else
Set ρCP = 0;
end if
The corresponding pointer of CP point to the next packet;
end for
distributed in RN’s coverage, and DeNB is randomly dropped beyond RN’s cov-
erage but can smoothly communicate with RN to perform packets aggregation.
RN’s coverage radius is approximately 350 m. Each UE send packet to RN ran-
domly with the access link (Uu). We assume that the number of packets arrived
in RN is satisﬁed with poisson distribution. The small-sized M2M data packets
are considered in the simulation, and have the randomly size between 21 and
120 bytes and the randomly priority between 1 and 6. The DeNB allocates only
ﬁve PRBs to the RN, and the position of RN corresponds to MCS 20 with a
TBS 2344 bits per TTI of 1 ms duration.
Comparison Scenarios: (a) In the ﬁrst group, M2M data packets are for-
warded in PDCP of RN without aggregating. (b) In the second group, the data
packets are aggregated at the Uu PDCP layer, in which the aggregated packet
are served when their size is equal to the maximum total sizes Lmax for all the
packets or the waiting time reach the maximum waiting time Tmax. (c) In the
third group, the data packets are aggregated at the Uu PDCP layer by PBBA,
but set diﬀerent Tmax for each queue. (d) In the fourth group, we the data pack-
ets are aggregated by PBBA but use the GA to replace BBA. The four groups
respectively are No Aggregating Scheme (NAS), Simple Aggregating Scheme
(SAS), the proposed Optimal Aggregating Scheme (OAS) and the proposed Pri-
ority Aggregating Heuristic (PAH). The maximum waiting time of the second
group are set as 10 ms. However, the maximum waiting time T p
max are set as {0,
0.01, 0.1, 1, 10, 100} seconds for the virtual queues p={1, 2, 3, 4, 5, 6}.
4.2
Performance Analysis
The simulation results in Fig. 4 clearly show the eﬃcient utilization of PRBs in
all four aforementioned schemes. In the NAS scenario with 200 data packet, the
average number of PRBs usage is almost utilize 1 PRB, and in the case of SAS,
only half of the PRBs are used with 200 data packets. However, in the case of
OAS, the average number of PRBs usage is the lowest in comparison of NAS,
SAS and OAS. The average number of PRBs usage is slightly higher than the

A Multi-queue Aggregation Framework for M2M Traﬃc
619
Fig. 4. Average number of PRBs usage for the four groups.
Fig. 5. Average waiting delay of all the packets for the four groups.
Fig. 6. Average waiting delay of the highest priority for the four groups.
case of SAS between 400 and 1000 data packets. Because the high priority data
packets are sent quickly when reach the RN, and the size of all the packets aren’t
ﬁll with the its maximum capacity. In particular, in low loaded scenarios, the
average number of PRBs usage in the case of OAS is lower than the case of SAS,
because the packets of lower priority are aggregated that the waiting time Tmax
of the lower priority is set more longer than the second group. Compared with
the case of OAS, the average number of PRBs usage is slightly of lower in the
PAH scenario, but the total delay is slightly higher. Because the purpose of OAS
is to use the least amount of time, while PAH is to get to send more packets.

620
W. Feng et al.
Figure 5 plots the average waiting time in the PDCP of RN in all four afore-
mentioned schemes. In the case of NAS, its average waiting time more than the
waiting time of SAS and OAS when the average number of packet arrival exceed
1400 data packets, because its average number of PRBs usage reach the maxi-
mum capacity. However, in the case of SAS with 2900 data packets, the average
number of packet arrival is much larger than the case of OAS, because its aver-
age number of PRBs usage also reach the maximum capacity. In contrast, in low
loaded scenarios, the average waiting time of all the packets of OAS are higher
than the cases of NAS and SAS, this is due to the maximum waiting time of
lower priority queue is higher than the high priority queue and thus the whole
waiting time increase. However, the average waiting time of the highest priority
is maintained at a low level as depicted in Fig. 6, because the packets of the
highest priority are immediately forwarded to DeNB when arriving at the RN.
5
Conclusion and Future Work
In this paper, we explored the problem of optimal packets aggregation among
M2M applications. A new framework for optimal aggregation implemented in the
PDCP of RN, which features balancing a tradeoﬀbetween QoS requirements of
packets and the utilization eﬃciency of PRBs. Numerical results illustrate that
OAS achieves a tradeoﬀof QoS and PRB utilization eﬃciency in comparison with
four existing schemes. Last but not least, OAS provides an optimal scheduling
scheme for uplink M2M traﬃcs, and more key techniques will be systematically
studied for the downlink M2M traﬃcs in our future work.
Acknowledgments. This work was supported by the National Natural Science Foun-
dation of China (No. 61302108).
References
1. Wang, K., Alonso-Zarate, J., Dohler, M.: Energy-eﬃciency of LTE for small data
machine-to-machine communications. In: Proceedings of the IEEE ICC, pp. 4120–
4124 (2013)
2. Wu, G., Talwar, S., Johnsson, K., Himayat, N., Johnson, K.D.: M2M: From mobile
to embedded internet. IEEE Commun. Mag. 49(4), 36–43 (2011)
3. Mehmood, Y., Khan Marwat, S.N., G¨org, C., et al.: Evaluation of M2M data
traﬃc aggregation in LTE-A uplink. In: Proceedings of the ITG-Fachbericht-
Mobilkommunikation, pp. 24–29, August 2015
4. Marwat, S.N.K., Mehmood, Y., G¨org, C., Timm-Giel, A.: Data aggregation of
mobile M2M traﬃc in relay enhanced LTE-A networks. EURASIP J. Wirel. Com-
mun. Networking 2016(1), 1–14 (2016)
5. Devi, U.M., Goyal, M., Madhavan, M., et al.: SERA: A hybrid scheduling frame-
work for M2M transmission in cellular networks. In: Proceedings of the IEEE
COMSNETS, pp. 1–8 (2015)
6. Majeed, A., Abu-Ghazaleh, N.B.: Packet aggregation in multi-rate wireless LANs.
In: Proceedings of the IEEE SECON, pp. 452–460 (2012)

A Multi-queue Aggregation Framework for M2M Traﬃc
621
7. Sawabe, A., Tsukamoto, K., Oie, Y.: QoS-aware packet chunking schemes for M2M
cloud services. In: Proceedings of the IEEE WAINA, pp. 166–173 (2014)
8. http://www.3gpp.org/technologies/keywords-acronyms/97-lte-advanced.
Accessed 12 Sep 2016
9. 3GPP TS 23.107, 3rd Generation Partnership Project. Technical Speciﬁcation
Group Services and System Aspects. Quality of Service (QoS) concept and archi-
tecture (Release 13), V13.0.0, December 2015
10. Liu, R., Wu, W., Zhu, H., et al.: M2M-oriented QoS categorization in cellular
network. In: Proceedings of the IEEE WiCOM, pp. 1–5 (2011)
11. 3GPP TS 36.300, 3rd Generation Partnership Project. Technical Speciﬁcation
Group Radio Access Network. Evolved Universal Terrestrial Radio Access (E-
UTRA) and Evolved Universal Terrestrial Radio Access Network (E-UTRAN)
(Release 12), V13.4.0, June 2016
12. 3GPP TS 36.213, 3rd Generation Partnership Project; Technical Speciﬁcation
Group Radio Access Network; Evolved Universal Terrestrial Radio Access (E-
UTRA); Physical layer procedures (Release 13), V13.2.0, June 2016
13. Sahni, S., Gonzalez, T.: P-complete approximation problems. J. Assoc. Comput.
Mach. 23(3), 555–565 (1976)
14. Lawler, E.L., Wood, D.E.: Branch-and-bound methods: A survey. J. Oper. Res.
14(4), 699–719 (1966)

Millimeter Wave Mobile Network
with Full-Duplex Mode
Baiqing Zong(&), Xiaohong Zhang, Jianli Wang, Xiaotong Li,
and Zhiyong Zhao
R&D Center (Shanghai), ZTE Corporation, Zhangjiang High-Tech Park,
Shanghai 201203, China
Zong.baiqing@zte.com.cn
Abstract. To converge full-duplex and mm-wave is attractive to high spectral
efﬁciency and huge capacity in 5G mobile networks. However, this conjunction
will bring more difﬁculties to design mobile networks. Except for the previous
problems of inter-site interference and UE-UE interference, new challenge of
ultra-broadband self-interference cancellation about wider bandwidth of mm-
wave band occurs. In this paper, we propose a hierarchical mobile network of
FDD/TDD massive MIMO and full-duplex mm-wave communications, which
has the features of beam division multiple access and ﬁltered sub-band reuse
against inter-site interference and UE-UE interference. In addition, we also give a
feasible analysis and system consideration of ultra-broadband self-interference
cancellation based on microwave photonics and integrated polarization based
antenna.
Keywords: Full-duplex  5G  mm-wave mobile communication
Beam division multiple access  Self-interference cancellation
CU split  Microwave photonics
1
Introduction
In communication research, 5G is now one of the most popular events. There are
several initiatives proposed for 5G, in which spectral efﬁciency is one of the most
important ones. To improve the spectral efﬁciency by full-duplex (FD), in which
transmission and reception can occur simultaneously in the same frequency band, is
one of the most promising techniques. In our previous presentation, we investigated the
challenges and potential application scenarios of FD in future 5G network [1]. For
macrocell (with 47 dBm of average output power), 147 dB self-interference cancel-
lation (SIC), and about 87 dB dynamic range of receiver are needed, which are great
challenges for algorithm and receiver frontend. For smallcell (with 27 dBm of average
output power), 127 dB self-interference cancellation, and about 67 dB dynamic range
of receiver are needed, which are somewhat less than macrocell. Furthermore, for FD
cellular network, inter-site interference and UE-UE interference are big issues. Simu-
lations show 36 dB and 23 dB UL SINR degradation for macro and small cell
respectively due to inter-site and UE-UE interferences. As for massive MIMO, large
scale analog and digital cancellation matrix will bring much complexity. So our
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 622–629, 2018.
https://doi.org/10.1007/978-3-319-72823-0_57

previous studies conclude that FD could be applied in the scenarios of single TX output
power <27 dBm, the numbers of antenna less than 8, new spectrum and new air
interface. This implies that possible application scenarios of FD would be smallcell,
new introduced mm-wave band, and wireless fronthaul and backhaul.
The mm-wave frequency bands (deﬁned as frequency band in 6–100 GHz) have
much more available bandwidth than the legacy bands in the sub-6 GHz used today.
They can therefore support the much higher data rates that are required in future mobile
broadband access and backhaul networks. Although the conjunction of FD and
mm-wave is more attractive to improving spectral efﬁciency and data capacity of 5G
mobile networks, FD mm-wave communications would bring new challenges. The
feature of wider bandwidth of mm-wave band results in more difﬁculties in designing
FD SIC transceivers, especially analog front end (AFE).
In this paper, to deal with the problems of inter-site interference and UE-UE
interference, we propose a hierarchical mobile network of FDD/TDD massive MIMO
and FD mm-wave communication, which has the features of beam division multiple
access (BDMA) and ﬁltered sub-band reuse (FSR). In addition, we also introduce and
discuss microwave photonics based SIC and integrated polarization based SIC antenna
suitable to ultra-broadband FD mm-wave AFE.
2
Architecture of FD mm-wave Mobile Network
2.1
CU Split and Hierarchical FD mm-wave Mobile Network
As mentioned above, FD is suitable for using in new frequency band and new air
interface. Therefore, new introduced mm-wave band can be considered as a FD fre-
quency band in the future 5G because backward compatibility is not required. In order to
ensure the robustness of control signaling, we consider the split of control plane and user
plane of hierarchical FD mm-wave mobile network. Macro coverage by FDD/TDD
massive MIMO below 6 GHz band mainly carries signaling, some data services such as
broadcasting services (mobile CDN), as well as data services in the areas of coverage
hole of mm-wave. 28 GHz or 38 GHz mm-wave band builds mm-wave smallcell.
Figure 1 shows the hierarchical network of FDD/TDD massive MIMO and FD
mm-wave networks, in which the C-plane and the U-plane are decoupled from each
other by ensuring that the C-plane signaling seamlessly covers the whole networks. The
high data rate is served by the mm-wave base stations. In the macro-coverage cells, radio
resource control (RRC) manages signaling, trafﬁc control and low data rate services.
At the same time, for a UE within a coverage area of the mm-wave base station, it
keeps dual connections with mm-wave base stations and macro stations. The mm-wave
base station is only responsible for the dynamic resource allocation of U-plane while
the RRC connection and mobility control remain in the C-plane based on FDD/TDD
macro station. In addition, macrocells and mm-wave cells are coordinated with each
other through CloudRAN. The information such as the user’s preferred content,
moving speed and direction of the user beam is stored and held in the mobile edge
computing (MEC) node, which front hauls all related services and information to the
base station.
Millimeter Wave Mobile Network with Full-Duplex Mode
623

2.2
Filtered Sub-band Reuse Between FD mm-wave Smallcell
For FD mobile networks, inter-cell interference is the biggest challenge. Although the
narrow-beam characteristics of mm-wave reduces the interference of line of sight
(LOS), interference of none line of sight (NLOS) caused by reﬂection becomes the
main problem. Related research shows that in the worst case, due to the reﬂection
caused by environments the background noise ﬂoors up about 46 dB. In order to solve
the challenge of inter-cell interference of FD mm-wave networks, the mm-wave fre-
quency band can be divided into several sub-bands of 300 MHz–500 MHz. Fortu-
nately, there is about 1–3 GHz bandwidth of the candidate spectra of mm-wave bands
in several main areas around the world [2]. Filtered sub-band reuse (FSR) is used
throughout the FD mm-wave mobile network. Figure 2 is a typical 1  3 FSR or
multiplexing. For example, the available mm-wave band of 28 GHz or 38 GHz is
divided into three ﬁltered sub-bands FS1, FS2 and FS3. Each cell is in a single
sub-band FD, meanwhile, the self-interference cancellation of single sub-band
full-duplex can be achieved through various cancellation technologies in Sect. 3.
For FSR, sub-band ﬁlter is added on top of OFDM, UFMC of FBMC, without any
change on existing OFDM. Independent subcarrier spacing, CP length and TTI con-
ﬁguration could be for each sub-band. Rather low guard tone overhead between
neighboring sub-band can be designed. FSR also supports asynchronous inter-band
transmission due to perfect OOB performance.
Furthermore, dynamic FSR can be employed, i.e., different bandwidths are
dynamically allocated to different cells according to trafﬁc conditions.
Fig. 1. Architecture of FD mm-wave mobile network.
624
B. Zong et al.

2.3
FD mm-wave Smallcell and BDMA
UE-UE interference is also a major challenge for FD mobile networks. To the inter-
ference of UE-UEs, beam division multiple access (BDMA) is introduced, as shown in
Fig. 3, which can compress the interference of UE-UE in mm-wave FD scenario, on
the other hand, achieve the virtual personal cell.
BDMA is the latest resource allocation technique in which orthogonal beams are
allocated to each UE. Several beams of base station will be formed and point to
different UEs to provide multiple accesses. If the UE and the base station are in LOS,
they can transmit beams pointing to each other for proper communication without
causing any interference to the other UE. The base station, after evaluating the position
and the moving speed of the UE, assigns a separate beam to each UE. Based on the
position and the moving speed, the base station also calculates the widths and the
directions of the beams of all the UEs. Usually, all beams are different for each UE, so
that different UEs can simultaneously transmit data at the same frequency with different
angles.
Narrow and strong directional beam is the inherent property of mm-wave trans-
mission. If coupled with beamforming, the mm-wave beam can be much narrower,
which is more beneﬁt to BDMA and FD transmission. Depending on various propa-
gation environments, the base station can also more ﬂexibly change the directions,
numbers and beam-width of the beams.
For CU-separated and hierarchical FD mm-wave mobile networks, the UE will be a
dual-connected terminal. The UE is assigned a signaling beam from FDD/TDD mas-
sive MIMO macro-cell as well as being assigned a mm-wave beam from FD smallcell.
Fig. 2. Filtered sub-band reuse of FD mm-wave mobile network.
Millimeter Wave Mobile Network with Full-Duplex Mode
625

3
Key Enabling Technologies: FD Ultra-Broadband Analog
Frontend
3.1
Integrated Polarization-Based Antenna
Although, to a certain extent, the FD mm-wave mobile network architecture solves the
interference of BS-BS and UE-UE, the ultra-broadband SIC, especially ultra-broadband
analog SIC, is still the most critical technology, because to achieve ultra-broadband
analog SIC is more difﬁcult. At ﬁrst, analog SIC can be performed at the antenna.
Fortunately, an ultra-broadband polarization-based SIC antenna has been proposed and
designed, as shown in Fig. 4 [3]. An auxiliary port AUX is introduced on the RX
antenna that is co-polarized with TX and terminated with a reﬂective termination to
achieve ultra broadband SIC.
The cross-polarized TX and RX antennas are used to improve the initial isolation
between the TX output and the RX input. This increases the TX-to-RX isolation from
12–22 dB to 32–36 dB at 54–66 GHz. To improve TX-to-RX isolation and further
suppression from ambient scattering, the SIC is aided by introducing a sub-antenna
co-polarized with TX antenna. The sub-antenna is set on the AUX port on the RX
antenna. The AUX port creates an indirect path from the TX output to the RX input.
The indirect path indicates that the ﬁrst cancellation signal is coupled to the AUX port
and then reﬂects the reconﬁgurable terminal from the reﬂector chip and eventually
couples to the RX input to cancel the self-interference from the direct path. The SIC
bandwidth depends on how well the amplitude and phase match across the frequency
band. A detailed algorithmic design technique for the SIC antenna is described in
reference [3], in which 50 dB isolation over 300 MHz at 4.6 GHz is achieved.
Reﬂective termination can be reconﬁgured to combat the variable self-interference
scattering from the environment. Total self-interference suppression >70 dB over
1 GHz bandwidth at 59 GHz is demonstrated even in the presence of an environmental
reﬂector [3]. RF canceller does not have any effect on RX noise ﬂoor due to antenna
cancellation.
Fig. 3. BDMA of FD mm-wave smallcell.
626
B. Zong et al.

3.2
Ultra-Broadband RF Self-interference Cancellation Based
on Microwave Photonics
For ultra-broadband analog SICs, the need for accurate amplitude and phase matching
of large bandwidths places a heavy burden on the RF circuits, which are limited by the
poor frequency ﬂatness. In particular, RF delay lines and phase shifters are inherently
narrowband and lack of the precision to achieve high performances of SIC. In the
microwave photonics based SIC, simulated interference signals and received signals
are all modulated onto the optical carriers and processed in the optical domain. In spite
of exploiting the small portion of the bandwidth of the RF modulated optical signal, the
microwave photonics based SIC can show an ultra-broadband cancellation.
In microwave photonics based ultra-broadband SIC system, each RF signal passes
through an orthogonal bias M-Z modulator that modulates the RF signal onto an optical
carrier. By high-precision channel matching, the amplitude and phase of the interfer-
ence signals should be nearly the same in both receiver and cancellation paths, if
subtracted by a balanced photodetector.
However, in the application scenario of mm-wave mobile network, the multipath
and reﬂection of the beam must be considered in the ultra-broadband SIC. This is also
the most critical factor to realize ultra-broadband SIC. Due to the antenna beamforming
in the mm-wave system, the LOS interference is suppressed and the NLOS interference
is ampliﬁed. In some environments, NLOS interference may be the primary interfer-
ence. Because of the delay associated with the NLOS reﬂection, the interference
canceller will need to adapt to larger dynamic delays. Therefore, multi-tap microwave
photon FIR ﬁlter is a viable option. Considering the compactness and applicability, the
photonic integrated circuits (PIC) is promising for the ultra-broadband SIC. Figure 5 is
the ultra-broadband SIC system architecture based on PIC [4]. The PIC-based SIC
replicates the transmitter interference as really as possible before subtracting the real
Fig. 4. FD integrated polarization based mm-wave antenna.
Millimeter Wave Mobile Network with Full-Duplex Mode
627

interference from the received signal. To estimate the channel effect, the PIC based SIC
uses a channel matched ﬁlter, which consists of N pairs of tunable weights and delays.
Each pair may be used, for example, to represent different multipath effect in the
transmitter-receiver path. In general, the channel matched ﬁlter is an optical FIR
matched ﬁlter that attempts to simulate the channel response as really as possible and
maximize self-interference cancellation. The received signal is carried by the top path
in the Fig. 5 and represents a normal optical RF link. The simulated interference signal
is tapped from the transmitter antenna and modulated onto the N different wavelengths
in the bottom path of Fig. 5. The N wavelength signals propagate to a channel matched
ﬁlter that assigns each wavelength to a separated tap. After each component is weighted
and delayed by the semiconductor optical ampliﬁer (SOA) and the true time delay
(TTD), the wavelength signals are recombined. The resulting sum represents the
estimated interference signal after the channel effect. The received signal and the
estimated interference signal are then fed to the opposite port of the balanced pho-
todetector to perform the subtraction. It should be noted that the balanced photodetector
subtraction is suitable for both in-band and out-of-band interference, making it more
efﬁcient than simple ﬁltering. Based on PIC, about 40 dB SIC over 1 GHz RF band-
width has been demonstrated [4].
4
Conclusion
In summary, to combine FD and mm-wave can boost the spectral efﬁciency and data
capacity. A hierarchical network of FDD/TDD massive MIMO and FD mm-wave
communications has the potential to realize FD mm-wave mobile networks, in which
the features of CU split, BDMA and FSR make a true FD mobile network more
feasible. On the other hand, PIC based ultra-broadband SIC and integrated polarization
based antenna have respectively achieved self-interference suppression about 40 dB
and 70 dB over 1 GHz bandwidth, opening a promising future of FD mm-wave mobile
network of 5G.
Fig. 5. FD mm-wave ultra-broadband SIC based on integrated microwave photonics.
628
B. Zong et al.

References
1. Baiqing, Z., Shenlin, Z.: Challenges and potential application scenario of full duplex in future
5G network. In: VTC2015-Spring Workshop on Full Duplex, 11–14 May 2015, Glasgow,
Scotland, UK (2015)
2. Shimodaira, H., Tran, G.K., Sakaguchi, K., Araki, K.: Investigation on millimeter-wave
spectrum. In: 2015 IEEE Conference on Standards for Communications and Networking
(CSCN) (2015)
3. Dinc, T., Chakrabarti, A., Krishnaswamy, H.: A 60 GHz CMOS full-duplex transceiver and
link with polarization-based antenna and RF cancelation. IEEE J. Solid-State Circ. 51(5),
1125–1140 (2016)
4. Chang, M.P., Tait, A., Chang, J., Prucnal, P.R.: An integrated optical interference cancellation
system. In: WOCC (2014)
Millimeter Wave Mobile Network with Full-Duplex Mode
629

Modeling and Simulation on Cooperative
Movement of Vehicle Group Based
on the Behavior of Fish
Daxin Tian1,4,5,6(&), Lu Kang1,4, Kunxian Zheng1,4, Xuting Duan1,4,
Hui Rong2, Peng Guo2, Wenyang Wang2, and Haijun Zhang3
1 Beijing Advanced Innovation Center for Big Data and Brain Computing,
Beihang University, XueYuan Road No.37, Beijing 100191, China
dtian@buaa.edu.cn
2 China Automotive Technology and Research Center,
Automotive Engineering Research Institute,
East Xianfeng Road No.68, Tianjin 300300, China
3 School of Computer and Communication Engineering,
University of Science and Technology Beijing,
XueYuan Road No.30, Beijing 100083, China
4 Beijing Key Laboratory for Cooperative Vehicle Infrastructure Systems
and Safety Control, School of Transportation Science and Engineering,
Beihang University, XueYuan Road No.37, Beijing 100191, China
5 Jiangsu Province Collaborative Innovation Center of Modern Urban
Trafﬁc Technologies, Si Pai Lou. 2, Nanjing 210096, China
6 Key Lab of Urban ITS Technology Optimization and Integration,
The Ministry of Public Security of China, Hefei 230088, China
Abstract. Fatigue driving might affect the trafﬁc safety when the vehicles are
on the cruising state in highway. Trying to solve this problem, this paper uses
the movement pattern of the ﬁsh to the vehicles ﬂeet, and develops a model of
vehicle group with realistic restrictions based on the existed ﬁsh algorithms, the
mobile behavioral model and cluster behavior model, and then demonstrates the
feasibility of applying the ﬁsh behavior to the cooperative movement of vehicle
groups through analyzing the trajectory, velocity and spacing of vehicles.
Keywords: Fish behavior  Internet of vehicle  Groups move  Vehicle cruise
1
Introduction
Vehicles stay a long-term cruise state on highway or urban expressway. Relative to the
general road, the vehicles are in a simple status where there are no trafﬁc lights and
reverse trafﬁc interferences. But in this situation, it is easy for driver to feel fatigue,
which will affect the safety and comfort of driving. And fatigue is the major reason
resulting trafﬁc accidents. In this case, we urgently need an auxiliary driving system or
automatic driving system which can replace the driver to operate in a relatively simple
closed environment.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 630–639, 2018.
https://doi.org/10.1007/978-3-319-72823-0_58

Internet of Vehicles is a simply self-organizing network which is different from the
ordinary. Because it uses the radio frequency to identify different Vehicles which
equipped with electronic labels in the road, so that to achieve the extraction, super-
visory and efﬁcient use of state information from all vehicles in the net [1]. It imple-
ments the network interconnection between vehicles and travel environment by
gathering a lot of basic information, such as the states of vehicles, road congestion and
so on, and then communicates with other vehicles, thus make the travel of vehicles
more secure, more convenient and more intelligent.
On the other hand, however, there is a certain defect in the existing communication
technology, in spite of AODV showing better performance in average End-to-End
delay and throughput under DSDD and SSDD techniques [2]. Moreover, the simulation
results in [3] show that building and vehicle obstructions signiﬁcantly attenuate the
signal thus resulting in lower received signal strength, lower packet delivery ratio, and
shorter effective transmission range, and the growth in the number of heterogeneous
interconnected systems, as well as the emergence of new requirements in applications
and services are progressively changing the original simplicity and transparency of the
Internet architecture [4].
And the 5G network, which is proposed in recent years, can be a good solution to
these problems [5]. And there are lots of works have studied in 5G network and
vehicular network. For instance, in [6], Haijun Zhang present an overview of the
challenges and requirements of the fronthaul technology in 5G LTE-U UDCSNets. In
[7, 8], Shanzhi Chen present a potential step change for the evolution toward 5G, and
propose long-term evolution (LTE)-V as a systematic and integrated V2X solution
based on time-division LTE(TD-LTE). In [9], a delay-optimal virtualized radio
resource scheduling scheme is proposed via stochastic learning. In [10–12], Chunxiao
Jiang propose a credible information-sharing mechanism capable of ensuring that the
vehicles do share genuine road trafﬁc information (RTI), and study the outage prob-
ability of road trafﬁc information sharing in underlay cognitive vehicular networks
under both a general scenario and a speciﬁc highway scenario. In [13], a uniﬁed
networking architecture is presented, starting from the inside of the vehicle and the
interconnection of various control units and ultimately targeting Car-to-Car commu-
nications which enable smarter, safer and more efﬁcient transportation.
In addition, the scientists get inspirations from some speciﬁc behavior of the bio-
logical community, such as Ant Colony Optimization (the ACO) and particle swarm
Optimization (PSO), which are the most widely applied. And we will apply ﬁsh
behavior into this paper.
So far, the Fish Principle has been widely used in Combinatorial optimization, grid
planning, wireless coverage and other various ﬁelds [14, 15], and in the transportation
ﬁeld: Wang Jian and Ren Zihui proposed the application of artiﬁcial ﬁsh algorithm in
vehicle behavior under serious trafﬁc incident [16]; Scientists in Ministry of Transport
Highway Science Research Institute, Jiang Shan put forward artiﬁcial ﬁsh school
algorithm in the ﬁeld of trafﬁc distribution applications [17]; Lai Lei carried out the
idea of applying the ﬁsh group model to the direction of multi-vehicle coordination
driving control [18]; The core idea of Fish Principle is that the ﬁsh’s behavior at the
next time depends on the state and the environment mostly. At the same time, it will
also affect the activities of the ﬁsh around it. We can easily think of the vehicle group
Modeling and Simulation on Cooperative Movement of Vehicle Group
631

from the ﬁsh group. The driving condition of every vehicle at next time depends on the
condition of surrounding vehicles at this time and the road conditions, and its condi-
tions at this time will also affect the activities chosen by the surrounding vehicles at
next time [19]. Vehicles which cooperate with others just like the ﬁsh swimming in the
highway.
Aim at the problems like long-time driving, low efﬁciency, and trafﬁc accident, this
paper put forward an improved model which based on the swarm intelligence, ﬁsh
behavior and vehicle cruise state. We use the simulation software to analysis the
trajectory, speed changes and separation distance between vehicles, then achieve the
formation of team driving within the limits of road and avoid collisions. So as to
improve the trafﬁc efﬁciency, enhance driving comfort and make unmanned driving
become true. Simultaneously, it is also beneﬁt to driving safety and energy
conservation.
2
Cooperative Model of Vehicle Group
There is a ﬁnite observable vehicle in the agreed two-dimensional road space, and each
vehicle moves at its own speed. At the same time, each vehicle can exchange infor-
mation, such as position, speed and acceleration, with other vehicles within a certain
range in the surrounding area, we call this range R0, and these vehicles neighborhood.
Based on the current vehicle communication distance, the communication range of
each vehicle is set to 300 m [20].
The target vehicle, which is randomly deﬁned, is denoted as vehicle i. The position
of vehicle i at time t is denoted as Pi tð Þ ¼ xi tð Þ; yi tð Þ
½
. The neighbor of i is deﬁned as
Ni tð Þ ¼
j : xi tð Þ  xj tð Þ

2 þ yi tð Þ  yj tð Þ

2  R2
0
n
o
ð1Þ
And the number of neighbor is donated as ni tð Þ.
At the same time, the speed of i and j at time t is denoted as vi tð Þ and vj tð Þ, the
acceleration of i and j is ai tð Þ and aj tð Þ.
According to the analysis, the forces which are acting on vehicle i at time t can be
described as
F ¼ F1 þ F2 þ F3 þ F4
ð2Þ
In which, F1 is mobile behavioral model, F2 is the cluster behavior model, F3 is the
force from lane line. And they can be described as follow:
(1) Similar to the alignment principle of ﬁsh group mentioned in [21], each vehicle
also tends to maintain a consistent orientation with its neighbor vehicle, that is, the
moving direction of i at time t is the average acceleration of its neighborhood at
time t  1.
The moving direction of i is expressed as
632
D. Tian et al.

ai tð Þ ¼
1
ni t  1
ð
Þ
X
j2Ni t1
ð
Þ
aj t  1
ð
Þ
ð3Þ
And F1 is
F1 ¼ miai tð Þ
ð4Þ
In which, mi is the mass of vehicle i, and the value of mi is 1 in simulation.
(2) Suppose that j 2 Ni tð Þ and j is front of i, the position of j is Pj tð Þ ¼ xj tð Þ; yj tð Þ


.
The distance between i and j is
dij tð Þ ¼
Pi tð Þ  Pj tð Þ

 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
xi tð Þ  xj tð Þ

2 þ yi tð Þ  yj tð Þ

2
q
ð5Þ
If the vehicle j brakes, j will slide forward for a while. The distance traveled by
vehicle j during this time is denoted as sj tð Þ, and sj tð Þ can be described as
sj tð Þ ¼ vj tð Þ

2
2lg
ð6Þ
In which, g is the gravitational acceleration, and l is the friction coefﬁcient between
tire and road. In general, the friction coefﬁcient of asphalt pavement is 0.4–0.8 [22]. In
order to facilitate the calculation, and considering that the road may be put into use for
many years, the friction coefﬁcient is set as 0.5.
As we mentioned previously, the information of target vehicle i is known to its
neighbor vehicles in the environment of IOV. If i receives the information that j is
broken, i will also brake immediately.
Likewise, if i brakes
si tð Þ ¼ vi tð Þ tr þ td
ð
Þ þ vi tð Þ
ð
Þ2
2lg
ð7Þ
In which, tr is the reaction time of machine, td is the delay time for information
exchange of vehicles, tr þ td
ð
Þ is set to be (0.75 s + 0.054 s) [23, 24]. And during the
time tr þ td
ð
Þ, i is still running in the speed vi tð Þ.
The distance difference of sliding forward between the two cars is donated as sij tð Þ,
and
sij tð Þ ¼ si tð Þ  sj tð Þ ¼ vi tð Þ
ð
Þ2 vj tð Þ

2
2lg
þ vi tð Þ tr þ td
ð
Þ
ð8Þ
According to the works in [25], we can know that the force between the vehicles is
divided into repulsion force and attraction force. When the distance dij tð Þ between i and
j is further than sij tð Þ, F2 is attraction force, recorded as Fattract. And the larger dij tð Þ is,
Modeling and Simulation on Cooperative Movement of Vehicle Group
633

the greater Fattract is. If vehicle i accelerate toward vehicle j, the distance between i and j
becomes smaller, and thereby the transportation efﬁciency can be improved; when the
distance dij tð Þ between i and j is shorter than sij tð Þ, F2 is repulsive force, recorded as
Fexclude. In order to avoid collision, vehicle i slows down to maintain the distance with
the vehicle j; when dij tð Þ is equal to sij tð Þ, F2 ¼ 0 As shown in Fig. 1, the force
between i and j exerted on vehicle i is expressed as an attractive force.
In order to ensure trafﬁc efﬁciency, we compress the distance between the front and
rear vehicles to a safe distance sij tð Þ. The trafﬁc accidents generally occur between the
front and rear vehicles on the highway, So in this paper, we give priority to the front
and rear vehicles. That is, the range of the force of i applied to the surrounding vehicle
is all set to be sij tð Þ
Here we introduce a negative exponential function to characterize the forces acting
on the vehicle which is changing with the distance. So, the attraction force and
repulsive force can be expressed as:
Fattract ¼ miA0exp dij=sij tð Þ


 pj tð Þ  pi tð Þ
pj tð Þ  pi tð Þ


ð9Þ
Fexclude ¼ miA1exp dij=sij tð Þ


 pi tð Þ  pj tð Þ
pi tð Þ  pj tð Þ


ð10Þ
Finally, F2 can be expressed as
F2 ¼
X
j2Ni tð Þ Fattract þ Fexclude
ð11Þ
Where, A0, A1 are parameters of system. And after a number of tests, A0, A1 are set
as 5,25 ﬁnally, and
pj tð Þpi tð Þ
pj tð Þpi tð Þ
k
k,
pi tð Þpj tð Þ
pi tð Þpj tð Þ
k
k are the direction of force.
(3) In order to ensure that the vehicles are running within the limits of the lane, i will
be subjected to the forces from both road sides. When i is in the position shown in
Fig. 1, the vehicle will be repelled by the upper boundary, and attracted by the
lower boundary at the same time. Similarly, the closer (farther) vehicle i
approaches (gets away from) to upper (lower) boundary,, the greater the repulsive
(attraction) force is. When the vehicle is in the middle of the road, the total force
Fig. 1. The diagram of forces acting on the vehicle i
634
D. Tian et al.

from both sides of the road is 0. Suppose the upper bound is b1, lower bound is b2,
the force between b1 and vehicle i is F31, the other is F32, just as shown in Fig. 1.
Therefore, we can get the expression of F3.
F3 ¼ F31 þ F32
ð12Þ
Where,
F31 ¼
miA2exp  wyi tð Þ
w=2

	
;
w=2\yi tð Þ\w
miA3exp  yi tð Þ
w=2

	
;
0\yi tð Þ\w=2
8
>
<
>
:
ð13Þ
And
F32 ¼
miA4exp  wyi tð Þ
w=2

	
;
w
2 \ w  yi tð Þ
ð
Þ\w
miA5exp  wyi tð Þ
w=2

	
; 0\ w  yi tð Þ
ð
Þ\ w
2
8
<
:
ð14Þ
Finally,
F3 ¼
miA2exp  yi tð Þ
w=2

	
 miA5exp  wyi tð Þ
w=2

	
;
w
2 \yi tð Þ\w
0;
yi tð Þ ¼ w
2
miA3exp  yi tð Þ
w=2

	
þ miA4exp  wyi tð Þ
w=2

	
;
0\yi tð Þ\ w
2
8
>
>
<
>
>
:
ð15Þ
Where, A2, A3, A4, A5 are parameters of the system, and A2 ¼ 1, A3 ¼ 20, A4 ¼ 2,
A5 ¼ 15. And w is the width of road, w is equal to 3.75 in general.
(4) In addition to controlling the initial vehicle speed, we also need to keep the
vehicles in the model running within the range of speed limit like the actual
situation of highway.
For the above reasons, we introduce the vehicle speed control model [26].
F4 ¼
A6vi t  1
ð
Þ;
when
vi t  1
ð
Þ\15
A7vi t  1
ð
Þ;
when
vi t  1
ð
Þ [ 30

ð16Þ
Where, A6, A7 are positive constants, A6 ¼ 2, A7 ¼ 4, and the unit of vi t  1
ð
Þ is
m/s.
When the speed is too fast, for example, it exceed the maximum speed of highway,
i will be subject to a force whose direction is opposite to that of the speed in order to
ensure trafﬁc safety.
When the speed is lower than a certain value, i will be subject to a force whose
direction is the same as that of the speed, which is set to ensure high driving efﬁciency
and avoid congestion.
Modeling and Simulation on Cooperative Movement of Vehicle Group
635

3
Simulation and Analysis
The simulation experiments and analysis are all accomplished by MATLAB in this
paper. At the beginning of the simulation, 10 cars are randomly generated in the initial
simulation area of 20  200 m, the initial speed of all vehicles is set to be 15–30 m/s,
and the simulation time is set to be one hour. In addition, the information of all vehicles
is updated every 0.01 s.
3.1
Analysis of Vehicle Trajectory in Simulation
First of all, we establish a Cartesian coordinate system in the plane of road, and the x
coordinate is lateral distance of road, y coordinate is longitudinal distance of road. The
schematic view of vehicle locus is shown in Fig. 2(a) and (b) is an image obtained by
enlarging the initial trajectory of the vehicle in Fig. 2(a), different curves represent the
travel trajectories of different vehicles, we can see from the picture that the trajectories
overlap together after the initial small amplitude swing. It indicates that vehicles are
running in a row at this time. And it’s consistent with the expected objectives of the
paper. In addition, the total driving distance of vehicles is 110 km during the simu-
lation time, and it is basically consistent with the actual situation of highway.
3.2
Analysis of Vehicle Speed in Simulation
Figure 3 shows the relationship between speed of vehicles and time, the horizontal axis
represents time and the vertical axis represents vehicle speed. We can see that the speed
remaining at 30 m/s ﬁnally. It is also consistent with the initial goals set by the
simulation.
Fig. 2. (a). The schematic view of vehicle locus, (b). The initial trajectory of the vehicle in
simulation
636
D. Tian et al.

3.3
Analysis of Relative Distance of Vehicles in Simulation
Figure 4(a) is a graph showing the change in the distance between any two vehicles with
time, there are {
2
10 ¼ 45 lines for ten vehicles. And the horizontal axis represents time and
the vertical axis represents distances. We can see the distances between any two cars
maintain stability ﬁnally. Likely, Fig. 4(b) is an image obtained by enlarging the initial
distance between the vehicles in Fig. 4(a). And due to the instability of vehicle speed and
location in the early simulation, the range of changes of vehicle spacing is large. The
spaces of vehicles also maintain steady after the speeds become stable.
4
Conclusion
In this paper, the group moving model is established based on the ﬁsh behavior model
and the actual situation of vehicle cruising, we not only ensure the speed, acceleration
and trajectory of vehicles are all within the reasonable range during the simulation, but
also make all vehicles driven in a line and ensure the stability of the vehicle, so that to
Fig. 3. The relationship between speed of vehicles and time
Fig. 4. (a). The change in the distance between any two vehicles, (b). The initial distance
between the vehicle in simulation
Modeling and Simulation on Cooperative Movement of Vehicle Group
637

avoid the collision between the front and rear vehicles. The results of simulation
experiment are proved the feasibility of applying the theory of ﬁsh behavior to the
research of cooperative movement of multi-vehicle in the environment of Internet of
Vehicle.
In the other hand, there are still many shortcomings in the research of this paper.
For example, we treat all the vehicles as an individual with the same motion charac-
teristics, without considering the differences between vehicles. And further improve-
ment is needed in the following studies.
Acknowledgments. This research was supported in part by no. Beijing Science and Technology
Program no. D171100000317003 and the National Natural Science Foundation of China under
Grant nos. 61672082, U1564212.
References
1. Chen, G., Guo, D.: Research and development on internet of vehicle. J. Mob. Commun. 17,
23–26 (2011)
2. Gaamel, A.M., Maratha, B.P., Sheltami, T.R., Shakshuki, E.M.: Fault-tolerance evaluation
of VANET under different data dissemination models. Int. J. Veh. Telemat. Infotain. Syst.
(IJVTIS) 1(1), 54–68 (2017)
3. Mir, Z.H., Filali, F.: A simulation-based study on the environment-speciﬁc propagation
model for vehicular communications. Int. J. Veh. Telemat. Infotain. Syst. (IJVTIS) 1(1), 1–
18 (2017)
4. Cortéspolo, D., Callecancho, J., Carmonamurillo, J., Gonzálezsánchez, J.: Future trends in
mobile-ﬁxed integration for next generation networks: classiﬁcation and analysis. Int. J. Veh.
Telemat. Infotain. Syst. (IJVTIS) 1(1), 33–53 (2017)
5. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A.H., Leung, V.C.M.: Network slicing
based 5G and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag.
6. Zhang, H., Dong, Y., Cheng, J., Leung, V.C.M.: Fronthauling for 5G LTE-U ultra dense
cloud small cell networks. IEEE Wirel. Commun. 23(6), 48–53 (2016)
7. Chen, S., Zhao, J.: The requirements, challenges and technologies for 5G of terrestrial
mobile telecommunication. IEEE Commun. Mag. 52(5), 36–43 (2014)
8. Chen, S., Hu, J., Shi, Y., Zhao, L.: LTE-V: a TD-LTE based V2X solution for future
vehicular network. IEEE Internet Things J. 3(6), 997–1005 (2016)
9. Zheng, Q., Zheng, K., Zhang, H., Leung, V.C.M.: Delay-optimal virtualized radio resource
scheduling in software-deﬁned vehicular networks via stochastic learning. IEEE Trans. Veh.
Technol. 65(12), 9479–9492 (2016)
10. Jiang, C., Zhang, H., Han, Z., Cheng, J., Ren, Y., Leung, V.C.M., Hanzo, L.:
Information-sharing outage-probability analysis of vehicular networks. IEEE Trans. Veh.
Technol. 65(12), 9479–9492 (2016)
11. Jiang, C., Zhang, H., Han, Z., Cheng, J., Ren, Y., Hanzo, L.: On the outage probability of
information sharing in cognitive vehicular networks. In: Proceedings of IEEE International
Conference on Communications (ICC), Kuala Lampur, Malaysia, 23–27 May 2016
12. Huang, Y., Wang, J., Jiang, C., Zhang, H., Leung, V.C.M.: Vehicular network based reliable
trafﬁc density estimation. In: Proceedings of the IEEE Vehicular Technology Conference
(VTC), Nanjing, 15–18 May 2016
638
D. Tian et al.

13. Pressas, A., Özpolat, M., Sheng, Z., Ali, F.: Performance evaluation of networking protocols
for connected vehicles. Int. J. Veh. Telemat. Infotain. Syst. (IJVTIS) 1(1), 1–14 (2017)
14. Zhu, Y., Chen, H., Shen, H.: Bio-inspired Computing Individual, Swarm and Community
Evolution Models and Methods, pp. 35–38. Tsinghua University Press, Beijing (2013)
15. Huth, A., Wissel, C.: The simulation of the movement in ﬁsh schools. J. Theor. Biol. 156,
365–385 (1992)
16. Wang, J., Ren, Z.: Application if artiﬁcial ﬁsh algorithm in vehicle behavior under serious
trafﬁc incident. J. Syst. Simul. 23 (2011)
17. Jiang, S., Ji, Y.: Artiﬁcial ﬁsh swarm algorithm for solving road network equilibrium trafﬁc
assignment problem. Comput. Simul. 28(6), 326–329 (2011). ISSN 1006-9348
18. Lei, L., Shiru, Q.: An effective swarm vehicle coordinative trafﬁc control design based on
ﬁsh swarm grouping behavior. J. Northwestern Polytechn. Univ. 30 (2012)
19. Ban, X., Ning, S.: Research on advanced self-organization behavior for artiﬁcial ﬁsh school.
Acta Automatica Sin. 34(10), 1328–1331 (2008)
20. Tang, A., Yip, A.: Collision avoidance timing analysis of DSRC-based vehicles. Accid.
Anal. Prev. 42(1), 182–195 (2010)
21. Chu, T.G., Wang, L., Mu, S.M.: Collective behavior analysis of an anisotropic swarm
model. In: Proceedings of the 16th International Symposium on Mathematical Theory of
Network and Systems. Mathematical Theory of Network and Systems (2004)
22. He, S., Xia, L.: Friction coefﬁcient mesurement and evaluation for lane surface of
expressway. J. Highway Transp. Res. Devel. 19 (2002)
23. Johansson, G., Rumar, K.: ‘Driver’s brake reaction times’, human factors. J. Hum. Factors
Ergon. Soc. 13, 23–27 (1971)
24. Taoka, G.: Break reaction times of unalerted drivers. ITE J. 59, 19–21 (1989)
25. Tian, D., Zhu, K.: Swarm model for cooperative multi-vehicle mobility with inter-vehicle
communications. IET Intell. Transp. Syst. 9, 887–896 (2015)
26. Yang, D., Pu, Y., Yang, F.: Car-following model based on optimal distance and its
characteristics analysis. J. Northwest Transp. Univ. 47 (2012)
Modeling and Simulation on Cooperative Movement of Vehicle Group
639

Propagation Characteristics in Indoor Scenario
with Diﬀerent Transmitter Locations
at 3.5 and 6 GHz
Xinzhuang Zhang1(B), Yawei Yu1, Lei Tian1, Yu Han1, Yu Zhang3,
and Jianhua Zhang1,2
1 Key Lab of Universal Wireless Communications, Ministry of Education,
Beijing University of Posts and Telecommunications,
Mailbox NO. 92, Beijing 100876, China
{zxzhuang,tianlbupt,jhzhang}@bupt.edu.cn
2 State Key Laboratory of Networking and Switching Technology,
Beijing University of Posts and Telecommunications,
Mailbox NO. 92, Beijing 100876, China
3 Qualcomm Inc., 6/F, Tower C, Beijing Global Trade Center,
36 North 3rd Ring East Road, Beijing 100013, China
zhangyu@qti.qualcomm.com
Abstract. This paper presents results from the measurement in indoor
conference scenario at 3.5 GHz and 6 GHz. The measurement was
performed by using multiple-input multiple-output (MIMO) antennas
including uniform planar array (UPA) at transmitter end (Tx) and
omni-directional array (ODA) at receiver end (Rx). Two cases includ-
ing UPA on the wall and the ceiling, have been measured and com-
prehensive propagation characteristics have been investigated in detail.
Based on the measurement, delay and spatial parameters are analyzed
and then compared with the standard model. The delay spread mea-
sured shows smaller value than standard model due to the small size of
the scenario and the elevation angle spread is presented for establish-
ing three-dimensional (3D) channel model. Further, the capacity perfor-
mances of the channel in diﬀerent cases are evaluated, and the results
indicate that the system with transmitter antenna mounted on the wall
performs better.
Keywords: MIMO channel · Elevation angle spread
Channel capacity
1
Introduction
With the continuous development of mobile internet, as well as the emergence of
new technology such as Virtual Reality (VR) and Augmented Reality (AR), the
demand for data rate has increased greatly. The ﬁfth generation (5G) commu-
nication has been widely researched to provide higher data rate and frequency
eﬃciency to satisfy this requirement in the near future. MIMO technology has
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 640–649, 2018.
https://doi.org/10.1007/978-3-319-72823-0_59

MIMO Channel Characteristics
641
been veriﬁed as a key technology for 5G system. In order to achieve better per-
formance of the technology, understanding the MIMO channel characteristics
deeply is necessary. The ﬁeld measurement is an essential way to obtain the
channel properties. Meanwhile it can also provide guideline for system designing
and network planning.
As an important deployment scenario for 5G, indoor scenario has been
depicted in 3GPP TR 36.900 [1]. So the study of channel characteristics and
modeling in indoor scenarios arises researchers’ great interests. There are plenty
of measurements conducted by diﬀerent researchers for various channel environ-
ments. In [2], the comparison of channel parameters at 3.5 GHz in room-room,
room-corridor and corridor-corridor cases was made, the result indicates that
the root mean square delay spread (rms DS) in corridor-corridor case has the
maximum value for existing obvious reﬂection paths. And in [3], Central Hall as
indoor scenario was measured at three frequency band including 2 GHz, 4 GHz
and 6 GHz, and the analysis results demonstrate that the delay spread has no
clear dependency on carrier frequency.
In [1], indoor scenarios include oﬃce environments and shopping malls, with
transmitter antennas mounted on the ceilings or walls. However, there is little
literature on investigating the channel characteristics diﬀerence between dissim-
ilar Tx location in indoor environment. The attention should be paid more on
that.
In this paper, propagation characteristics in indoor conference scenario at
3.5 GHz and 6 GHz were investigated. Two cases including Tx antenna array on
the wall and on the ceiling have been measured in detail. We present and compare
the key channel parameters such as delay spread and angle spread in two cases.
Further, the performances of antenna system in two cases are discussed. The
results can provide guideline for 5G communication system design, especially
for small cell system.
The rest of this paper is organized as follows. Section 2 gives a detailed
description of the measurement campaign. Data post process methods are intro-
duced in Sect. 3. Then analysis results follow in Sect. 4 and Sect. 5 draws the
conclusions.
2
Measurement Description
2.1
Measurement System
In ﬁeld measurement, the channel sounder described in [4] was utilized to con-
duct the measurement campaign. It consists of three units: transmitter sounder,
receiver sounder, and receiver baseband processing unit (RBPU). The RBPU is
used to store the raw data received by the receiver sounder. With diﬀerent radio
frequency converter placed in the sounders, measurement at diﬀerent frequency
band such as 3.5 GHz and 6 GHz can be achieved. To capture propagation rays in
3D environment eﬃciently, full dimensional arrays are equipped at both sides of
a measurement link. During our ﬁeld measurements, dual-polarized (±45◦) ODA
consisting of 56 antenna elements is used at the Rx, while UPA with 32 antenna

642
X. Zhang et al.
elements at the Tx, as described in Fig. 1. The array elements are microstrip
patches and their 6 dB beamwidths are approximately 110◦in both vertical and
horizontal planes. The gain of each antenna element is 6 dBi, and angle reso-
lution is 2◦. In Table 1, measurement parameters including antenna height are
listed.
(a) UPA (Tx)
(b) ODA (Rx)
Fig. 1. Layout of antenna arrays
Table 1. The speciﬁcations of measurement
Items
Tx-W
Tx-C
CF (GHz)
3.5/6
3.5/6
Bandwidth (MHz)
100
100
Length of PN code (Chips)
127
127
Transmitter antenna/Number UPA/32
UPA/32
Receiver antenna/Number
ODA/56 ODA/56
Polarized
±45◦
±45◦
Height of Tx antenna (m)
1.8
2.4
Height of Rx antenna (m)
1.2
1.2
2.2
Measurement Scenario
We carried out the ﬁeld measurement for 3D channel impulse response (CIR)
in a conference room for indoor scenarios. The room is 5.85 m long, 5.10 m wide
and 2.40 m high with gypsum ceiling and concrete block wall. And there are no
windows in the room. In the middle, there is a long wooden table. The UPA
is ﬁxed on diﬀerent locations-the wall and the ceiling, namely Tx-W and Tx-
C case, respectively. The UPA location for Tx-C case is showed in Fig. 2(a).

MIMO Channel Characteristics
643
And the ODA is positioned at the marked spots from number 1 to 20 for static
measurement in each case, as depicted in Fig. 2(b). There is no obstruction
between transmitter and receiver, so all the measurements are line of sight (LoS)
condition. For each case and each central frequency, approximately 20 diﬀerent
spots are measured with 500 snapshots collected for each spot.
(a) The Propagation Environment in
Tx-C case for UPA
(b) The location of the measured
spots for two cases
Fig. 2. The overview of the measurement scenario
3
Data Post-processing
After measurement, post processing is implemented with two steps: ﬁrstly,
obtaining CIR from the measured raw data; then extracting channel parame-
ters such as delay, power and angle from CIR. The CIR is converted from the
raw data through eliminating the system impulse response by correlating the
received signals with calibration signal. When extracting channel parameters,
channel model needs to be introduced. The 3D channel model for LTE has been
introduced in 3GPP TR 36.873 [5] and for any given delay τ, it is given by
hu,s(τl; t) =
L

l=1

Frx,u,θ(Ωl)
Frx,u,φ(Ωl)
T 
αl,θ,θ αl,θ,φ
αl,φ,θ αl,φ,φ
 
Ftx,s,θ(Φl)
Ftx,s,φ(Φl)

× exp(j2πλ−1
0 (Ωl · ¯rrx,u)) exp(j2πλ−1
0 (Φl · ¯rtx,s)) × exp(j2πfd,lt)
(1)
Where, L is the total number of multiple components (MPC), λ is the wave-
length of the carrier frequency. The SAGE algorithm [6] is applied in order
to estimate channel parameters from CIRs. As an extension of the maxi-
mal likelihood estimation (MLE) algorithm, taking the antenna pattern into
account, the SAGE algorithm provides a joint estimation of the parameter set,
θl = {τl, Φl, Ωl, fd,l, Al} , l = 1, 2, ..., L, where τl, fd,l, Φl, Ωl and Al denote the
propagation delay, the Doppler shift, the direction of departure, the direction

644
X. Zhang et al.
of arrival, and the complex polarization matrix of the lth path, respectively.
Specially, Φl = (θT,l, φT,l), Ωl = (θR,l, φR,l), where θT,l, φT,l, θR,l and φR,l
denote the elevation of departure (EoD), azimuth of departure (AoD), elevation
of arrival (EoA), and azimuth of departure (AoA) of the lth path, respectively.
For each measurement snapshot, L = 200 paths are estimated by the SAGE
algorithm.
3.1
Delay Parameters
The main parameters of time domain dispersion include mean excess delay τmean
and rms DS τrms. They can be determined from a power delay proﬁle (PDP).
The rms DS is deﬁned as the root mean square of second central moment of the
power delay proﬁle. So rms DS can be calculated as below [7]
τrms =







l
(τl −τmean)2Pl

l
Pl
(2)
where
τmean =

l
τlPl

l
Pl
(3)
These delays τl are measured relative to the ﬁrst detective arriving path at the
receiver.
3.2
Spatial Parameters
Root mean square angle spread σAS is a key factor to characterize the dispersion
in spatial domain. As mentioned in the former part of Sect. 3, the azimuth and
elevation angles of the MPC can be extracted from CIRs. The mean angle spread
μ (Δ) and the circular angle spread (CAS) [8] σAS can be calculated by [7]
σAS = min
Δ σAS (Δ) =








L

l=1
(φl (Δ) −μ (Δ))2Pl
L

l=1
Pl
(4)
μ (Δ) =
L

l=1
φl (Δ) Pl
L

l=1
Pl
(5)

MIMO Channel Characteristics
645
φl (Δ) = φl + Δ
(6)
φl =
⎧
⎨
⎩
2π + φl
φl
2π −φl
φ < −π
|φ| ≤π
φ > π
(7)
where L, Pl, and φl (Δ) denote the number of paths, the power of the lth path
and the angle of the lth path adding a shifted angle which denotes a certain
angular shift.
3.3
Channel Capacity
The channel capacity is an important metric of the MIMO channel. For the
CIR of each measurement location, the Discrete Fourier Transform is applied to
obtain the channel response matrix HU,S (f; t), where f denotes the subcarrier
indice. The mean capacity of frequency selective fading channel over all sub-
carriers at all ﬁxed spots of diﬀerent ones is given [9] by
C = 1
Q
Q

q=1
log2 det(IN +
ρ
βM Hu,s,qHH
u,s,q)
(8)
Where Q is the number of channel realizations, ρ is the signal to noise ratio
(SNR) and β is a common normalization factor for all channel realizations within
one snapshot which satisﬁes
E[ 1
β ∥Hu,s,q∥2
F ] = US
(9)
where ∥•∥2
F denotes the Frobenius norm.
4
Results of Measurements
4.1
Delay Characteristics
Delay spread expresses the delay dispersion of the channel and is probably the
most important metric describing a radio channel characteristics. When consid-
ering delay spread from PDP, the noise cut threshold has to be mentioned. A 20
dB noise threshold criterion [10] has been utilized meaning that incoming paths
with higher than 20 dB power diﬀerence compared to the most powerful path
have been removed. According to the former part, the rms DS is obtained for
two cases, and then summarized in Table 2. CF denotes central frequency. The
mean excess delay and rms DS obey the lognormal distribution. For example,
the ﬁtted cumulative probability density curve of the rms DS obtained in Tx-C
case at 6 GHz is depicted in Fig. 3.
From the Table 2, we can observe that the mean excess delay’s variation
range is from 20 ns to 28 ns in all cases. And in Tx-C case at 3.5 GHz it is
smaller than that in Tx-W case, while at 6 GHz, it shows opposite tendency in

646
X. Zhang et al.
Tx-W case. So there is no obvious changing rules for excess delay when Tx loca-
tion vares. In terms of rms DS, the values in two cases are almost the same, for
the tiny diﬀerence in a few nanoseconds can be ignored. So there are no obvious
dependency between rms DS and frequency. Compared to the InH scenario in
[10], the value is smaller as a result of the small size of the room.
Table 2. Delay parameters for two cases
CF (GHz)
3.5
6
3.4
Case
Tx-C Tx-W Tx-C Tx-W InH
τmean (ns) 20.08 24.00
28.37 22.68
N/A
τrms (ns)
10.41 13.38
14.23 13.50
19.95
10
15
20
25
30
35
40
0
0.2
0.4
0.6
0.8
1
ns
Cumulative probability
DS measured
lognormal fit [14.23 4.10]
Fig. 3. Fitting results of DS in Tx-C case at 6 GHz
4.2
Spacial Characteristics
The rms AS including EoD, EoA, AoD and AoA can be calculated according to
Eqs. 4, 5, 6 and 7 in Sect. 3.2 and the mean values of rms angle spread for Tx-C
and Tx-W cases are listed in Table 3.
It is easily observed that arrival angle spread is larger than departure angle.
For example, ASA is greater than ASD in Tx-C case as well as Tx-W case.
This is due to that Tx antenna is mounted at one place while Rx antenna is
set along the measured route so receiver enjoys more scatters than transmitter.
As we predict, AS decreases when the frequency increases in a given case, for
arrival azimuth angle spread shows greater value at 3.5 GHz than that at 6 GHz
in identical case. It is due to the fact that the smaller the wavelength of carrier
is, the less scattering paths arrive at the receiver. It is worth noting that ESA

MIMO Channel Characteristics
647
Table 3. The statistical spatial parameters in two cases
CF (GHz) 3.5
6
3.4
Case
Tx-C Tx-W Tx-C Tx-W InH
ASD (◦)
30.2
33.8
28.8
25.7
39.8
ESD (◦)
24.0
30.2
26.9
26.9
N/A
ASA (◦)
53.7
58.8
50.1
51.3
41.7
ESA (◦)
27.5
42.6
26.9
38.9
N/A
in Tx-C case is much smaller than that in Tx-W case at 3.5 GHz and 6 GHz.
It is resulted from the fact that there are more reﬂection and scattering paths
from the walls and table arriving receiver when the UPA is equipped on the
wall. As for ASA, the variation is not obvious. Above all, in conference room,
the Tx antenna location has an obvious inﬂuence on angle spread, especially for
elevation angle. The deep understanding of spacial parameter can be utilized for
beamforming.
4.3
Capacity Analysis
Using the channel matrix H from the CIR, channel capacity can be obtained
by Eq. 8. The capacities were calculated in two cases to predict the capacity in
conference scenario. For the inter element spacing impacts the capacity, here half
wavelength spacing is adopted for 3.5 GHz and 6 GHz, respectively.
From Fig. 4, the antenna-on-wall system performs better compared to the
antenna-on-ceiling system no matter at 3.5 GHz or 6 GHz. At an SNR of
30 dB, the antenna-on-wall system at 3.5 GHz provides an ergodic capacity of
−10
0
10
20
30
0
50
100
150
200
250
SNR/dB
Capacity bps/Hz
Tx−W 6G
Tx−C  6G
Tx−W 3.5G
Tx−C  3.5G
Fig. 4. The capacity of 56 receiving antenna and 32 transmitting antenna

648
X. Zhang et al.
0.35
0.4
0.45
0.5
0.55
0.6
0.65
0.7
0.75
0.8
0
0.2
0.4
0.6
0.8
1
eigenvalue cumulative ratio
CDF
1st W
2nd
3rd
4th
1st C
2nd
3rd
4th
Fig. 5. The cumulative ratio of eigenvalues of channel for two cases at 3.5 GHz
216.5 bits/s/Hz. It is known that channel correlation between subchannels
impacts the channel capacity. So the eigenvalues of the MIMO channel were
analyzed to ﬁnd the reason. We chose spot 7 described in Fig. 2(b) for example.
The CDF curves for cumulative ratio of the ﬁrst four eigenvalues in Tx-C case
and Tx-W case are depicted in Fig. 5. As emphasized by the rad ellipse, We can
ﬁnd that the main eigenvalue in Tx-C case is larger than that in Tx-W case, indi-
cating antenna system in Tx-W case has lower correlation between subchannels,
so it obtains better capacity performance.
5
Conclusion
In this paper, we have reported the results from the measurement in indoor
conference scenario. The 3.5 GHz and 6 GHz frequency bands are candidate
bands for 5G system, and the measurement scenario is of importance to indoor
scenarios.
In LoS condition, two cases including Tx antenna array on the wall and
the ceiling at 3.5 GHz and 6 GHz have been measured with UPA and ODA to
obtain delay and spacial domain parameters, as well as capacity performance.
We compared channel characteristics in two cases in detail. For delay domain
dispersion parameters, rms DS has no clear dependency on frequency, and the
values are around 14 ns in two cases. For spacial domain parameters, elevation
arrival angle spread shows a large diﬀerence between Tx-W and Tx-C case, and
in Tx-C case it is about ten degrees larger than that in Tx-W case. And the
MIMO system with transmitter antenna on the wall has a better performance
at 3.5 GHz, obtaining up to 216.5 bits/s/Hz. So transmitter antenna mounted
on the wall may be a good choice for indoor small cell system deployment.

MIMO Channel Characteristics
649
Acknowledgments. This research is supported in part by National Science and Tech-
nology Major Project of the Ministry of Science and Technology (2015ZX03002008),
and by National Natural Science Foundation of China (61322110, 6141101115), and by
Doctoral Fund of Ministry of Education (20130005110001), and by Qualcomm Incor-
porated.
References
1. 3GPP TR 36.900: Study on Channel Model for Frequency Spectrum above 6 GHz
(Release 14) (2016)
2. Zeng, J., Zhang, J.: Propagation characteristics in indoor oﬃce scenario at 3.5
GHz. In: 8th International ICST Conference on Communications and Networking
in China (CHINACOM), Guilin, pp. 332–336. IEEE Press (2013)
3. Li, J., et al.: Measurement-based characterizations of indoor massive MIMO chan-
nels at 2 GHz, 4 GHz, and 6 GHz frequency bands. In: 83rd Vehicular Technology
Conference (VTC Spring), Nanjing, pp. 1–5. IEEE Press (2016)
4. Zhang, J.: Review of wideband MIMO channel measurement and modeling for
IMT-advanced systems. Chin. Sci. Bull. 57(19), 2387–2400 (2012)
5. 3GPP TR 36.873: Study on 3D Channel Model for LTE (Release 12) (2014)
6. Fleury, B.H., Jourdan, P., Stucki, A.: High-resolution channel parameter estimation
for MIMO applications using the SAGE algorithm. In: International Zurich Sem-
inar on Broadband Communications Access - Transmission - Networking, Zurich,
p. 30-1 (2002)
7. Rappaport, T.S.: Wireless Communications: Principles and Practice. Prentice Hall,
New Jersey (2001)
8. 3GPP TR 25.966: Spatial Channel Model for Multiple Input Multiple Output
(MIMO) Simulations (2003)
9. Yu, K., Bengtsson, M., Ottersten, M., McNamara, D., Karlsson, P., Beach, M.:
Modeling of wide-band MIMO radio channels based on NLoS indoor measurements.
IEEE Trans. Veh. Technol. 53(3), 655–665 (2004)
10. ITU-R M.2135: Guidelines for Evaluation of Radio Interface Technologies for IMT-
Advanced (2009)

Social-Aware Data Caching Mechanism
in D2D-Enabled Cellular Networks
Miao Liu1, Jun Li1(B), Tingting Liu1, and Youjia Chen2
1 School of Electronic and Optical Engineering,
Nanjing University of Science and Technology, Nanjing, China
{miao.liu,jun.li}@njust.edu.cn, liutingting1026@hotmail.com
2 College of Photonic and Electronic Engineering,
Fujian Normal University, Fuzhou, China
chenyoujia@fjnu.edu.cn
Abstract. In this paper, we investigate the problem of content caching
in wireless cellular networks (CN) using device-to-device (D2D) trans-
mission method to reduce subscriber’s download delay. We focus on how
to eﬃciently allocate ﬁles to the selected important nodes (INs), and
propose a novel approach for minimizing the downloading latency. In
particular, we ﬁrst model the problem of minimizing delay as a matching
game. Then we tackle this game by exploiting the popularity of contents
as well as users’ social properties to generate the utility functions of two-
side players: INs and ﬁles. Based on the utility function, the preference
lists of cache entities is developed. For solving this game, we design a
user-ﬁle caching (UFC) algorithm to achieve a stable matching between
INs and ﬁles. Simulation and analytical results show that the proposed
mechanism is capable of oﬀering a better delay performance than bench-
marks, e.g., random caching and recent-used-ﬁle caching scheme.
Keywords: Cellular network · Content caching · D2D
Social property
1
Introduction
With the proliferation of smartphones and other derivative intelligent equip-
ments, the network traﬃc has witnessed a trend of explosive growth. It is
expected to increase by 40 fold over the next ﬁve years [1], due to mobile video
stream and social network traﬃc. This increasing need for high rate transmis-
sion and low-cost power has impelled mobile operators to redesign and ﬁnd more
eﬃcient techniques to meet the increase. In this respect, device-to-device (D2D)
communication [2,3] has emerged as a promising technique to achieve high eﬃ-
ciency. User equipments can obtain data from other mobile devices or small
base station rather than the cellular base station (BS) by employing D2D com-
munications [4]. Although it is a promising technology for the next generation
communication to meet unprecedented traﬃc demands, D2D has to overcome
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 650–662, 2018.
https://doi.org/10.1007/978-3-319-72823-0_60

Social-Aware Data
651
some challenges such as mutual interference and transmission distance limita-
tion. However, most researches on D2D communications have focused on the
physical layer. In fact, the social-aware networks among the D2D participators
can be investigated to further increase the transmission rate.
Social network provides various platforms to users for the purpose of online
content sharing with their friends, or searching someone who has common inter-
ests in the virtual network. Interestingly, the connection established in the virtual
network actually is tightly associated with our oﬄine life. For example, on cam-
pus our connected friends in Facebook, Twitter, Youtube, or Sina Blog, usually
have a very close physical distance. The authors in [5] make a detailed sum-
mary and analysis to the features of social network and propose a social-aware
D2D communication architecture. As shown in [5], the social network charac-
teristics consist of ties, community, centrality and bridge. Moreover, eigenvector
centrality, closeness centrality and betweenness centrality are commonly used in
the identiﬁcation of social importance. In [6], the authors present a novel app-
roach utilizing eigenvector centrality to judge the relationship in social network.
Recently, social network has been proposed to combine with the caching mech-
anism [7,8]. In [9], the placement of popular content is proposed considering
the importance of nodes in social layer. However, how to eﬃciently match the
contents with users remains a challenge.
Matching theory is an eﬀective method for solving the combinatorial prob-
lem of matching players in two distinct sets. In [10], the classic classiﬁcation
of matching problem includes one to one matching, many to one matching and
many to many matching. Specially, the many to one matching game is utilized
in resources allocation, where two players have diﬀerent preferences towards net-
work resources [11]. Additionally, many to many has been widely applied to the
resource and spectrum allocation in wireless network [12].
In this paper, we are inspired to research on the social-aware content allo-
cation in wireless cellular networks (CN) using matching algorithm. Popular
contents and important nodes (INs) are modeled as two sides of the matching
game. To this end, we model the content allocation problem as a matching game.
Our main contributions can be summarized as follows:
1. We present an framework of INs selecting where three social characteristics
are considered.
2. We propose a many to one matching game to solve the content allocation
problem. In this game, the two sides of players establish their preferences
towards each other considering content popularity, social connection features,
and the wireless physical layer metrics.
3. The stability of the proposed matching algorithm is proved. Simulation is
carried out to evaluate the performance of the proposed algorithm.
The rest of this paper is organized as follows. In Sect. 2, we describe the system
model in detail and present the content allocation problem. In Sect. 3, we propose
the many to one matching framework. In addition, we design a novel matching
algorithm and prove that the algorithm is stable. Simulation results are shown
in Sect. 4, the performance of the proposed method is analysed. Finally, we draw
the conclusions in Sect. 5.

652
M. Liu et al.
2
System Model and Problem Formulation
We focus our attention on a cellular network consisting of one BS and an amount
of mobile users randomly located in the cellular area. Mobile users would like to
acquire some interested ﬁles that belong to content providers, such as YouTube
and Youku. A sample model of combination of social network and D2D commu-
nication is shown in Fig. 1. Such a system can be divided into two layers: the
physical layer and social layer and each node in social layer can be projected
onto a real user equipment in physical layer. In the social layer, the virtual con-
nections between social users can reﬂect their oﬄine activities [13]. Thus, we
can infer the close degree of user’s relationship by observing their behaviors in
social network platform. Besides, in the physical layer, users can access to the
cellular network or establish D2D connection to obtain required ﬁles. Taking the
social characteristics of D2D communication pairs into account, we can select
INs for caching popular ﬁles. For example, in physical layer of Fig. 1, if V6 and
V9 are active in social layer, the popular ﬁles can be downloaded within their
storage capacity for disseminating to their linked users. The problem of how to
select INs will be introduced in the following. However, there exists some dif-
ference between social layer and physical layer. For example, node V6 has social
link with node V8, but in physical layer the D2D link does not exist between
them due to the faraway distance. Also, In physical layer, V1 and V3 have close
distance, but they don’t have a social link.
In this paper, we construct the network model considering both the social
layer and physical layer [14]. If the D2D link and social link exist simultaneously
between two users, we say that the two users are connected, which means that if
the connection exists, the connecting users are not only within the transmission
range but also have certain social relationship. We denote the set of M user
equipments by V = {V1, · · · , Vm, · · · , VM}, where Vm, m ∈{1, 2, 3, · · · , M} rep-
resents the mth user equipment. Moreover, the set of INs is Mc = {1, 2, · · · , mc},
which is chosen by BS for sake of proactive caching within their storage.
The set of Md = {1, 2, · · · , md} represents the general users. In addition,
F = {f1, f2, · · · , fL} denotes requesting ﬁle set controlled by content provider.
Fig. 1. A detailed description of combination of social network and D2D communica-
tion.

Social-Aware Data
653
2.1
System Description
We suppose that the probability of content requests pq obeys the Zipf distribution
pq =
1/qα
L
i=1 1/iα ,
for
q = 1, · · · , L
(1)
where α characterizes the skewness of the distribution, reﬂecting diﬀerent content
popularity. However, generally speaking, people usually have diﬀerent preference
towards ﬁles. Thus, The content popularity matrix for all users is given by P ∈
RM×L where each entry Pm,fi represents the probability that the mth user
requests the ith ﬁle fi. The relation between Pm,i and pq is illustrated in [15] in
detail.
Here, we use G = (V, E) to denote a social relationship graph, in which
V = Mc ∪Md represents the set of all nodes and E is the set of edges connecting
Mc and Md. Adjacent nodes (mc, md) are connected by a bidirectional edge
e(mc, md) ∈E, where mc ∈Mc and md ∈Md. For simplicity, e(mc, md) = 1
represents the connection between mc and md, while e(mc, md) = 0 represents
the disconnection.
We suppose that a dedicated frequency band of bandwidth W is allocated to
the downlink channels. The wireless channels with path-loss is considered here.
For the purpose of oﬄoading data from BS, we assume that each user will ﬁrstly
try to download data from its connected INs. If a user cannot ﬁnd its requested
ﬁles from INs, it will then turn to BS for help. The cellular BS contains the whole
content library and can serve all user terminals in the system. Moreover, the
channels of D2D connection and cellular connection is assumed to be orthogonal
in the frequency domain.
In general, BS is far away from the mobile users. Therefore, the download
rate supported by the base station is generally lower than that supported by
the D2D link. It will not only encourage the users to download from the D2D
transmission ﬁrst, but also eﬀectively reduce the data traﬃc of BS imposed by
ﬁles downloading. In addition, general users can only communication with INs
that the connection exists between them.
According to the CN model, the transmission rates of directly cellular net-
work and D2D connections can be expressed as
Rb,Vm = W log2

1 +
Pb,VmG2
b,Vm
σ2

,
(2)
and
Rmc,md = W log2

1 +
Pmc,mdG2
mc,md

m′
d∈Md Pmc,m′
dG2
mc,m′
d + σ2

,
(3)
respectively [9], where Pmc,md, and Pb,Vm denote the transmission powers by the
mcth IN and BS, respectively. Gmc,md is the D2D channel gain and Gb,Vm is
BS’s the channel gain, and σ2 is the noise variance.

654
M. Liu et al.
2.2
Social Importance Analysis
Taking social importance and battery capacity into account, to choose the INs,
we deﬁne the following importance measurement matrix X
X = μB + νS + υC,
(4)
where B = {bj,k}, S = {sj,k}, and C denote the matrices of betweenness central-
ity, similarity, and battery capacity, respectively, and μ, ν and υ are adjustable
parameters with constraint μ + ν + υ = 1. bj,k is the edge betweenness of the
link between nodes j and k, and sj,k is the degree of similarity between j and
k. Betweenness centrality is one commonly used way to measure the nodes cen-
trality property. The betweenness centrality of node i can be calculated as
bj,k =

j,k∈V
djk(i)
djk
,
(5)
according to [16]. In this equation above, djk is the number of shortest distance
paths of connecting from node j to node k, and djk(i) is the number of geodesic
paths including node i. In order to facilitate the calculation, a normalized element
(j, k) of matrix B is as follows
B(j, k) =
bj,k
(M −1)2 .
(6)
Similarity Matrix: in [9], for a pair of nodes, (j, k), their similarity matrix is
deﬁned as
sj,k =

z∈M(j)∩M(k)
1
k(z)
if j is connected with k,
0
otherwise,
(7)
where M(j) is the set of neighbors of j, z ∈M(j) ∩M(k) denotes the set
of the common neighbors between node j and k. k(z) is the number of nodes
connected with z. Similarly, in order to facilitate the calculation, the simple
additive weighting (SAW) method is considered. Also, the normalized entries of
S are
S(j, k) =
sj,k
max sj
,
(8)
where sj denotes the jth row of S. In the Eq. (4), because of the adjustability
of parameters, we formulate a constraint on the value as shown below
h

n=1
Rm,n ≥γ,
(9)
where n ∈Θ ≜{1, 2, · · · , h} denotes the nodes connected with node m, and γ
represents the predeﬁned minimum sum-rate threshold according to network

Social-Aware Data
655
performance. In this case, if the node m is selected as IN, it transmission should
meet the limitation.
Through analysis and calculation of the centrality of all nodes, we sort the
element of X in a descending order and then choose top |Mc| as INs. A number
of vital users in our cellular network are selected. Thus, these nodes can be
exploited for proactive caching. We will elaborate on the problem of content
allocation to the INs and will focus on this issue in the next subsection.
2.3
Problem Formulation
To formulate the allocation problem between ﬁles and INs, we set up a ﬁle
distribution matrix A|Mc|×L, where L is the total number of ﬁles cached. The
entry λmc,fi ∈{0, 1} in A|Mc|×L indicates whether fi is cached by the mcth IN
or not as follows
λmc,fi =

1,
if fi is cached by mcth IN,
0,
otherwise.
(10)
In the CN, the strategy of D2D users is selecting caching ﬁles for sake of
minimizing the transmission delay by optimizing the matrix A|Mc|×L. According
to the consideration, the delay of downloading the ﬁle fi by user n can be
calculated as
Tn,fi =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
Y
max{Rmc,n} ,
∃λmc,fi ̸= 0, e(mc, n) = 1,
∞,
∃λmc,fi ̸= 0, e(mc, n) = 0,
Y
Rb,n ,
otherwise,
(11)
where Y denotes the size of the requested ﬁle fi. In this case, If general users
request the INs that have no connection between them, we suggest that the delay
is inﬁnite. Based on the request probability of each ﬁle, the delay for user n to
download a ﬁle from F can be written as
Tn = Pn,fi · Tn,fi
for fi ∈F,
(12)
where fi ∈F and Pn,fi ∈P. Thus, the content allocation strategy can be solved
by the following optimization problem
min
A

n∈Md

mc∈Mc
L

i=1
λmc,fiTn,
s.t.
①
L

i=1
λmc,fi ≤1,
mc ∈Mc,
②λmc,fi ∈{0, 1},
③
|Mc|

mc=1
λmc,fi ≤Q,
fi ∈F.
(13)

656
M. Liu et al.
In the above optimization, constraint ①states that a maximum number 1 of ﬁles
can be matched for an IN, and condition ②guarantees that λmc,fi is a binary
variable. Also, condition ③denotes a maximum number Q of nodes that can
be selected for caching by ﬁle fi. The optimization problem (13) is a NP-hard
combinatorial binary optimization problem [17]. However, since (13) contains
only one binary variable, it can be modeled as a matching problem. Thus, in
the next section, we propose a matching algorithm to solve the optimization
problem.
3
Matching Algorithm
Caching ﬁles in INs can make other users to require ﬁles directly from the caching
nodes rather than from the cellular network. In this section, we propose a novel
content allocation method of utilizing matching game in allocating ﬁles.
3.1
Matching Related Deﬁnitions
We ﬁrst introduce some notations to facilitate the solving process. There are two
non-intersect sets of participants: M = {Mi}I
i=1 and F = {Fj}J
j=1. Here ≻M=
{≻Mi} and ≻F = {≻Fj} denote, respectively, the set of preference relations of
two players.
Deﬁnition 1. A matching relationship Φ is deﬁned as a function from the set
M ∪F based on the preference list.
Let Vm(·) and Uf(·) denote the utility function of user m and pre-cached
ﬁle f, respectively. Given these utilities, we can get the following instructions
Vm(fi) > Vm(fj) ⇔fi ≻m fj,
(14)
Above shows that a user m prefers ﬁle fi to fj. Similarly, a pre-cached ﬁle f
prefers user mi to mj can be expressed as
Uf(mi) > Uf(mj) ⇔mi ≻f mj.
(15)
Consequently, we denote this matching function Φ:(Mc, F, Q), where (Mc, F)
is the set of matching pairs and Q denotes the maximum number of INs that
per ﬁle can be cached in.
3.2
Proposed Matching Algorithms
User-ﬁle caching (UFC) problem is further comprised of two types of game play-
ers including D2D users and ﬁles regulated by BS. The matching problem that
we elaborate on is a many-to-one game. Based on the above deﬁnition, in the
system model, limited by the storage capacity of mobile users, an IN can save
only one ﬁle set but one ﬁle can be stored many times at INs of D2D links.

Social-Aware Data
657
The strategy of both D2D users and BS is to maximize their respective
proﬁts in matching algorithm based on the preference over opposite sets. On
the other hand, BS makes its content allocation decision based on its local
information without relying on a central coordination. So the UFC matching
algorithm attend to solve the optimization problem in (13). To design the algo-
rithm, we ﬁrst design an algorithm for allocating ﬁles for one BS. Denote by
Hmc = {Hm1, Hm2, · · · , Hmh} the index set of nodes connected with IN mc.
Based on this consideration, D2D utility function over the ﬁle fi is deﬁned as
Vmc(fi) =
1
|Hmc|

n∈Hmc
Pn,fi,
(16)
where Pn,fi represents the connected node n’s preference degree to the ﬁle fi
and the above equation illustrates that the INs’ preference over ﬁles is ranked
based on the degree of content popularity. Furthermore, the favourite ﬁle can
be obtained by sorting the utility function in a descending order. Similarly, the
utility for ﬁle fi∈F to be matched with the mcth IN can be written as
Ufi(mc) =
1
|Hmc|

n∈Hmc
Pn,fiTn,fi.
(17)
The utility function over D2D users is aﬀected by the average transmission delay
and social network structure. Besides, by sorting the utility function in a ascend-
ing order, we can obtain the preference list.
The matching problem proposed in this paper is not a traditional match-
ing game, since the preference lists of ﬁles and INs depend not solely on the
information available locally but on the character of social-layer architecture.
Our proposed matching problem exhibits externality such as peer eﬀects, which
means that the users and ﬁles may change their preferences during the game,
due to the constantly updated social relationship among users. Nevertheless,
traditional matching game algorithm may not be able to converge to a stable
matching, especially when the game has peer eﬀects [3]. Therefore, we need to
develop a new algorithm to ﬁnd a stable solution of this problem in this paper.
Let A(Mc, F) denotes the set of ultimate matching pairs, and η(m, f) denotes
the subset of A(Mc, F), where (m, f) are matched. Thus, the concept of blocking
pair and stability is introduced as follows.
Deﬁnition 2. A matching η∗(m, f ′) ⊈A(Mc, F), but comparing with the
matching pair η(m, f), there exists relation that η∗≻m η, that it to say, the
current matching does not maximize the utility. We deﬁne this matching pair
η∗(m, f ′) as the blocking pair. If and only if there is no blocking pair, the pro-
posed matching algorithm is stable.
The UFC matching algorithm considers one BS, and is the solution to the
problem in (13). The algorithm is displayed in Table 1. In the following, we
describe the process of the algorithm brieﬂy. The preferences are calculated by
INs and ﬁles, respectively. Then, INs make proposals to the most prefer ﬁles,

658
M. Liu et al.
and in turn, the content provider’s ﬁles decide to accept or reject these proposals
based on their preference lists. For a particular user, if it requests for the top of
ﬁle fi within the set F, the ﬁle fi updates its utility and accepts the request if
the action do not yield a degradation of its utility.
Table 1. Proposed UFC matching algorithm
We prove the stability of the algorithm proposed in Table 1. Here, we merely
discuss the situation in a stable community, which means all the nodes may not
readily add or remove any connections established between them. This condition
guarantees that the peer eﬀects cannot make any change in community. Observ-
ing from our algorithm, the preference is strictly monotone and subjects to (13).
In this case, the blocking pairs can not exist because all the players select their
matching pairs based on the preference. Moreover, the number of storage is ﬁnite
and our matching pair selecting method always adheres to the utility maximum
principle. Accordingly, under the situation of a stable community, our proposed
algorithm is stable.
4
Simulation Results
In this section, we study a wireless network consisting of one BS. This BS is
designed as a regulator with 300 meters coverage. And in this range, M = 20

Social-Aware Data
659
and user equipments are randomly distributed in the community. The relation-
ship among them considers both the social online connections and their oﬀ-line
physical locations.
In this simulation, we set the path-loss exponent β = 4, noise power σ2 =
10−10 and transmission power of BS Pb,Vm = 20W and D2D transmission power
Pmc,md = 2W. In addition, we assume that there are L = 10 ﬁles and the
distance between equipments and BS is randomly generated within a certain
range, besides, Q = 2, the tunable variables μ, v and ν are set to 1/3.
In this simulation, we compare the proposed UFC matching algorithm with
random ﬁle allocation (randomly choosing ﬁles), RUC (caching most recent used
ﬁles) [18], and no caching algorithms. In the random allocation algorithm, we
assign the ﬁles randomly to the INs. In the RUC algorithm, the recently used ﬁles
are allocated to the INs. Figure 2 shows the average download delay for diﬀerent
caching strategies varying with the number of INs. It can be seen that as the INs
number increases, all the three algorithms employing caching mechanism show
a declining trend. While the download delay of no caching algorithm is ﬁxed at
15 units, due to the reason that no caching method acquires ﬁles only through
the BS. However, it is clear that the proposed UFC algorithm yields signiﬁcant
performance improvements compared with other methods.
1
2
3
4
5
6
7
8
9
6
7
8
9
10
11
12
13
14
15
16
 Number of INs
Average download delay(unit)
Proposed UFC algorithm
No caching
Randonmly caching
RUC algorithm
Fig. 2. Average download delay vs. the number of INs
In the ﬁle allocation stage, it is critical to choose the INs. Figure 3 depicts
the diﬀerences between the proposed algorithm and the random ﬁle allocation
algorithm. As we expected, the proposed algorithm taking the social importance
into consideration can bring prominent improvement than the random ﬁle allo-
cation algorithm. It can be seen from Fig. 3, when the number of INs is 6, the
proposed algorithm’s average transmission delay is 8.47 units, while the random
ﬁle allocation algorithm is 9.24 units.
Figure 4 illustrates that the quota value has a great impact on the transmis-
sion delay. We set the quotas to be 1 and 2, respectively. It inspires us that we
need to make full use of the storage space of user equipments for the purpose of
gaining low transmission delay.

660
M. Liu et al.
1
2
3
4
5
6
7
8
9
7
8
9
10
11
12
13
14
15
Number of INs
Average download delay(unit)
Proposed method select
Random select method
Fig. 3. Average download delay vs. diﬀerent selecting method of INs
1
2
3
4
5
6
7
8
9
7
8
9
10
11
12
13
14
15
16
Number of INs
Average download delay(unit) 
Q=1
No caching
Q=2
Fig. 4. Average download delay vs. diﬀerent matching games
5
Conclusion
In this paper, we design a novel distributed caching optimization algorithm to
solve the cache allocation problem in D2D underlaid cellular networks. We for-
mulate a many to one matching game combining the social relationship with
physical locations in order to minimize the average transmission delay. To solve
the D2D transmission problem, we propose a UFC matching algorithm. Also, we
prove the stability of the proposed algorithm. At last, the simulation results are
provided to demonstrate the validity of this algorithm that considering the social
importance can greatly reduce the transmission delay. Furthermore, increasing
the quota of ﬁles can also reduce the transmission delay.
Acknowledgement. This work is supported in part by the National Natural Sci-
ence Foundation of China under Grant (Nos. 6150123861602245 and 61472190), in
part by the Jiangsu Provincial Science Foundation under Project BK20150786 and
BK20150791, in part by the Specially Appointed Professor Program in Jiangsu
Province, 2015, in part by the Fundamental Research Funds for the Central Universities

Social-Aware Data
661
under Grant 30916011205, in part by the Open Research Fund of National Mobile Com-
munications Research Laboratory, Southeast University, under grant No. 2017D04, in
part by he China Postdoctoral Science Foundation (2016M591852), and in part by
Postdoctoral research funding program of Jiangsu Province (1601257C).
References
1. Cisco: Cisco visual networking index: global mobile data traﬃc forecast update,
2013–2018. http://www.cisco.com/c/en/us/solutions/collateral/service-provider/
visual-networking-index-vni/white paper c11-520862.pdf
2. Doppler, K., Rinne, M., Wijting, C., Ribeiro, C.B., Hugl, K.: Device-to-device
communication as an underlay to lte-advanced networks. IEEE Commun. Mag.
47, 42–49 (2009)
3. Hakola, S., Chen, T., Lehtomaki, J., Koskela, T.: Device-to-device communication
in cellular network - performance analysis of optimum and practical communi-
cation mode selection. In: 2010 IEEE Wireless Communication and Networking
Conference, pp. 1–6 (2010)
4. Zhang, H., Liu, H., Jiang, C., Chu, X., Nallanathan, A., Wen, X.: A practical
semidynamic clustering scheme using aﬃnity propagation in cooperative picocells.
IEEE Trans. Veh. Technol. 64(9), 4372–4377 (2015)
5. Li, Y., Wu, T., Hui, P., Jin, D., Chen, S.: Social-aware D2D communications:
qualitative insights and quantitative analysis. IEEE Commun. Mag. 52(6), 150–
158 (2014)
6. Hu, J., Yang, L.L., Poor, H.V., Hanzo, L.: Bridging the social and wireless net-
working divide: Information dissemination in integrated cellular and opportunistic
networks. IEEE Access 3, 1809–1848 (2015)
7. Shanmugam, K., Golrezaei, N., Dimakis, A.G., Molisch, A.F., Caire, G.: Femto-
caching: wireless content delivery through distributed caching helpers. IEEE Trans.
Inf. Theory 59(12), 8402–8413 (2013)
8. Li, J., Chen, Y., Lin, Z., Chen, W., Vucetic, B., Hanzo, L.: Distributed caching
for data dissemination in the downlink of heterogeneous networks. IEEE Trans.
Commun. 63(10), 3553–3568 (2015)
9. Ma, C., Lin, Z., Marini, L., Li, J., Vucetic, B.: Learning automaton based dis-
tributed caching for mobile social networks. In: 2016 IEEE Wireless Communica-
tions and Networking Conference, pp. 1–6 (2016)
10. Gu, Y., Saad, W., Bennis, M., Debbah, M., Han, Z.: Matching theory for future
wireless networks: fundamentals and applications. IEEE Commun. Mag. 53(5),
52–59 (2015)
11. Semiari, O., Saad, W., Valentin, S., Bennis, M., Poor, H.V.: Context-aware small
cell networks: how social metrics improve wireless resource allocation. IEEE Trans.
Wireless Commun. 14(11), 5927–5940 (2015)
12. Jiang, L., Cai, H., Chen, Y., Zhang, J., Li, B.: Many-to-many matching for com-
binatorial spectrum trading. In: 2016 IEEE International Conference on Commu-
nications (ICC), pp. 1–6 (2016)
13. Boyd, D.M., Ellison, N.B.: Social network sites: deﬁnition, history, and scholarship.
IEEE Eng. Manage. Rev. 38, 16–31 (2010). Third
14. Wang, L., Wu, H., Wang, W., Chen, K.C.: Socially enabled wireless networks:
resource allocation via bipartite graph matching. IEEE Commun. Mag. 53, 128–
135 (2015)

662
M. Liu et al.
15. Chang, Z., Gu, Y., Han, Z., Chen, X., Ristaniemi, T.: Context-aware data caching
for 5G heterogeneous small cells networks. In: 2016 IEEE International Conference
on Communications (ICC), pp. 1–6 (2016)
16. Ashraf, M.I., Bennis, M., Saad, W., Katz, M.: Exploring social networks for opti-
mized user association in wireless small cell networks with device-to-device com-
munications. In: 2014 IEEE Wireless Communications and Networking Conference
Workshops (WCNCW), pp. 224–229 (2014)
17. Gale, D.: College admissions and the stability of marriage. Am. Math. Mon. 69(1),
9–15 (1962)
18. Gu, J., Wang, W., Huang, A., Shan, H., Zhang, Z.: Distributed cache replacement
for caching-enable base stations in cellular networks. In: 2014 IEEE International
Conference on Communications (ICC), pp. 2648–2653, June 2014

Two-Tier Matching Game Design for Wireless
Caching in Pico-Cell Networks
Guowei Shi1, Jun Li1(B), Haijun Zhang2, Feng Shu1, and Tingting Liu1
1 School of Electronic and Optical Engineering,
Nanjing University of Science and Technology, Nanjing, China
{guowei.shi,jun.li,shufeng}@njust.edu.cn, liutingting1026@hotmail.com
2 School of Computer and Communication Engineering,
University of Science and Technology Beijing, Beijing, China
zhanghaijun@ustb.edu.cn
Abstract. Wireless caching brings network content close to mobile users
(MU), and has been identiﬁed as an eﬀective solution for reducing MUs’
transmission delay. In this paper, we concentrate on how to eﬃciently
allocate network ﬁles to the storage of pico-cells and associate MUs with
the pico-cells. To deal with the series of resource allocation problems,
we ﬁrst separate these problems as two distinct many-to-one matching
games. Then, we tackle these problems by proposing diﬀerent concepts to
generate the preference lists respectively. The deferred-acceptance algo-
rithm is designed in this paper to achieve stable matchings in these two
separated games. It is shown in numerical results that our proposed
design demonstrates a better performance compared to state-of-the-art
benchmarks.
Keywords: Matching game · Wireless caching
Content-oriented communications · Pico-cell networks
1
Introduction
Along with the developments of mobile communication technologies, mobile
users (MUs) show growing interests in using various multimedia services [1]. To
deal with the explosive growth of demands in high speed data transmissions by
MUs, an low-cost and low-power pico-cell access architecture is proposed which
can coexist with any wireless technology and can be deployed in any area under-
laid on Macro-cell network [2]. But when pico-cell network density increases,
backhaul capacity limitations would be a big problem [3].
Content caching is one of the eﬃcient solutions to eﬀectively handling this
problem. With observations that a large amount of data traﬃc is caused by
a small portion of popular network contents, i.e., movies, as well as the price
of storage medium is relatively cheaper compared to the price of backhaul,
c
⃝ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 663–674, 2018.
https://doi.org/10.1007/978-3-319-72823-0_61

664
G. Shi et al.
caching in network facilities, such as small-cell, femto-cell, pico-cell and D2D
nodes, to release backhaul pressure becomes a potential solution in these
years [4–6].
Specially in [4], a fetmo-cell caching system is proposed for assigning ﬁles
to the femto-cells, in order to minimize the downloading time. Moreover, the
authors of [5] proposed a caching system for D2D based cellular network relaying
on the MUs’ caching of popular ﬁles, in order to increase the throughput of net-
works. In addition, the authors of [6] have proposed a distributed caching scheme
using Stackelberg game, in order to deal with resource allocation problems in a
small cell network. Although many problems have been solved as above, how to
eﬀectively allocate resource in pico-cell networks still remains a great challenge
to face.
In this paper, we leverage matching game theory to handle resource alloca-
tion problems in cache enabled system. As in [7], authors introduce fundamentals
and conventional classiﬁcation of matching theory for future wireless networks,
where matching games are split into three kinds, i.e., one-to-one matching games,
many-to-one matching games and many-to-many matching games. In [8], authors
utilize many-to-one matching games in wireless small cell networks with a com-
bination of context-aware of information about trajectory proﬁle and quality of
service requirements of users, in order to maximum satisfaction ratio and reduce
downloading delay. Many-to-many matching games has been used in [9] to reduce
backhaul loads and the experienced delay in small cell networks. From discussion
above, we are motivated to use matching game theory in pico-cell networks to
explore the optimal allocation with caching.
In this paper, we concentrate on proposing a two-tier matching game in
wireless caching systems to handle the resource allocation problem. We ﬁrstly
match network contents with pico-cells and then match the pico-cells with mobile
users. The key contributions can be summarized as follows.
1. We model a pico-cell based caching system with the objective to minimize
the system transmission delay.
2. We decouple the resource allocation problems into two many-to-one matching
games, and address them by using the deferred-acceptance algorithm. We
then generate preference lists in the two matching games to obtain a stable
matching.
3. We demonstrate that the proposed algorithm has near-optimal outcomes with
numerical results.
The rest of this paper is organized as follows. We describe the system model
and formulate system objective in Sect. 2. We then decouple the optimization
problems and propose matching games to solve the optimization problems in
Sect. 3. Our numerical results are illustrated in Sect. 4, while our conclusions are
draw in Sect. 5.

Two-Tier Matching
665
2
System Model and Problem Formulation
Let us consider a pico-cell based caching network composed of M MUs which
have priorities to connect to pico-cells. As shown in Fig. 1, there exists a Macro-
cell serving MUs in its coverage assisted by N pico-cells. Also, we deﬁne the
set of M MUs by M = {M1, M2, · · · , MM} and the set of pico-cell by N =
{N1, N2, · · · , NN} which are both randomly located in system. We assume that
each pico-cell has the same storage size that could cache only one ﬁle.
Fig. 1. Pico-cells based caching system model
There are two resource allocation problems in this network. In the ﬁrst stage,
ﬁles are allocated to pico-cells and then MUs are associated to pico-cells in
second stage. In what follows, we will introduce some key concepts to facilitate
the problem formulation.
2.1
File Popularity
Firstly, we model the popularity of ﬁles. Let us denote the ﬁle set by V =
{V1, V2, · · · , VV } consisting of V popular ﬁles which belong to content providers
(CP). Intuitively, the majority of MUs request popular ﬁles more frequently than
the others. Thus, we assume that the popularity proﬁle of ﬁles characterized by
the Zipf-like distribution as the requests of any ﬁles are inversely proportional

666
G. Shi et al.
to ﬁle’s rank in the request table [6]. Then, the popularity distribution qv of Vv
is characterized as
qv =
1/vβ
V
j=1 1/jβ ,
∀v,
(1)
where the exponent β is a positive skewness parameter and v means v-th ﬁle.
Also, the ﬁle with a small index v corresponds to a high popularity.
2.2
Transmission Rate of MUs
Secondly, we deﬁne the transmission rate of each pico-cells to MUs as
Rmn = W log2

1 +
Pnd−α
mnh2
mn

n′∈N \n Pn′d−α
mn′h2
mn′ + σ2

,
(2)
where W means the transmission bandwidth of downlink channels and Pn is the
transmission power at pico-cell Nn. dmn represents distance between pico-cell
Nn and MU Mm and α is the path-loss exponent. The random channel between
Nn and Mm is Rayleigh fading, whose coeﬃcient hmn has the average power of
one. σ2 is the variance of the Gaussian noise.
For the sake of simplicity, we assume that the Macro-cell will support a
ﬁxed download rate, denoted by Rma, for the MUs in the channels which are
orthogonal to those spanning from the pico-cells to MUs.
2.3
Caching Related Issue
Next, we introduce the pico-cell caching system with details. In the ﬁrst stage,
each pico-cell cache one ﬁle of V. The ﬁle placement commence during oﬀ-peak
time on backhaul links. It is clear that MUs show diﬀerent preferences towards
diﬀerent ﬁles. Thus, we could deﬁne the preference from MU Mm to ﬁle Vv as
pmv = αmvqv,
(3)
where αmv is a factor that inﬂuence MUs’ preferences to ﬁle Vv and qv is the
popularity of the ﬁle Vv. Then, the pico-cells will download a ﬁle relying on
collecting the serving MUs’ preferences. We deﬁne the preference pnv of pico-cell
Nn to ﬁle Vv as
pnv = 1
Cn

k∈Cn
pkv,
(4)
where k means the k-th serving MU of the pico-cell and Cn is the serving MUs set
of Nn. Pico-cells will cache the most preference ﬁle of its serving MUs according
to (4) during oﬀ-peak time.
In the second stage, MUs start to request ﬁles. In general, an MU can be
covered by multiple pico-cells. When an MU Mm request ﬁle Vv, it tries to
connect to the nearest pico-cell which cached ﬁle Vv. Otherwise, the MU Mm

Two-Tier Matching
667
will download the requesting ﬁle from Macro-cell directly. Thus, the transmission
delay τ v
ml of MUs can be represented as follows.
τ v
ml =
⎧
⎨
⎩
τ v
ma =
S
Rma if MU connects to Macro-cell,
τ v
mn =
S
Rmn if MU connects to pico-cell,
(5)
where S is the ﬁle size.
2.4
Problem Formulation
In this subsection, we formulate the ﬁle allocation problem to minimize the
transmission delay of MUs. The problem can be formulated as
min
X,Y

n∈N

m∈M

v∈V
xnvynmτ v
ml,
s.t. (a)

v∈V
xnv ≤1,
(b)

n∈N
ynm ≤1,
(c)

n∈N
xnv ≤Q1,
(d)

m∈M
ynm ≤Q2,
(e)xnv, ynm ∈{0, 1},
(6)
where xnv is the element of matrix X and xnv = 1 represents the pico-cell Nn
caches the ﬁle Vv, otherwise xnv = 0. ynm is the element of matrix Y , and
ynm = 1 denotes that the pico-cell Nn is serving MU Mm, if not ynm = 0.
Condition (a) guarantees that each pico-cell could only cache one ﬁle, condition
(b) states a user will be served by one pico-cell, condition (c) concerning ﬁle
variety is to make sure that ﬁle Vv could only be cached Q1 duplication in this
network, condition (d) assures that each pico-cell can serve Q2 MUs at most,
and condition (e) states that the values of xnv and ynm can be neither 0 or 1.
3
Proposed Matching Algorithm
3.1
Decoupling the Optimization Problem
The optimization in (6) is a generalized knapsack problem which is proved to be
an NP-hard combinatorial problem [10]. It is hard to ﬁnd a global optimal solu-
tion for these association problems. Hence, to solve the optimization problem in
(6), we resort to a suboptimal approach and split the optimization problem into
two independent sub-problems: (i) optimal ﬁle selection problem, (ii) optimal
pico-cell selection problem.

668
G. Shi et al.
Optimal File Selection Problem
min
X

n∈N

v∈V
xnvτ v
ml,
s.t. (a)

v∈V
xnv ≤1,
(b)

n∈N
xnv ≤Q1,
(c)xnv ∈{0, 1}.
(7)
Optimal Pico-Cell Selection Problem
min
Y

n∈N

m∈M
ynmτ v
ml,
s.t. (a)

n∈N
ynm ≤1,
(b)

m∈M
ynm ≤Q2,
(c)ynm ∈{0, 1},
(8)
These two suboptimal problems are still NP-hard combinatorial problems [10].
Since they both contain one binary variable, they can be modeled as two distinct
many-to-one matching problems respectively [11].
3.2
Matching Related Deﬁnition
Matching has been introduced in [12] as a eﬀective way to solve the allocate
resource problem. These resources will be divided into two ﬁnite and disjoint sets
of players. Diﬀerent sets of players have diﬀerent preferences over the opposite
sets. To construct the preference lists in our model, we use the symbol ≻to
represent that the players prefer one player to another player in the opposite
set. For example, when a pico-cell Nn shows V1 ≻V2 in its preference lists, it
means that Nn prefers ﬁle V1 than ﬁle V2. In this paper, we use μ1 to represent
the ﬁrst many-to-one matching of sub-problem 1.
For Vv ∈V and Nn ∈N , a matching μ1 is V 	 N →2V  N , which satisﬁes
1. μ1(Nn) ∈V and |μ1(Nn)| ≤1,
2. μ1(Vv) ∈N and |μ1(Vv)| ≤Q1,
3. μ1(Vv) = Nn ⇐⇒μ1(Nn) = Vv.
The second many-to-one matching μ2 of sub-problem 2 has the following
properties.
For Mm ∈M and Nn ∈N , a matching μ2 is M 	 N →2M  N , which
satisﬁes
1. μ2(Mm) ∈N and |μ2(Mm)| ≤1,
2. μ2(Nn) ∈M and |μ2(Nn)| ≤Q2,
3. μ2(Mm) = Nn ⇐⇒μ2(Nn) = Mm.

Two-Tier Matching
669
3.3
File Selection Algorithm
Next, Deferred Acceptance (DA) algorithm [11] is proposed to solve these two
many-to-one matching games. We ﬁrst focus on modeling the preference lists in
the ﬁrst matching.
Deﬁnition 1. For MUs C ⊆M, the corresponding pico-cell’s preference over
ﬁle Vv ∈V is
Γv = pnv,
(9)
where Γv ∈CN∗V is pico-cells’ preference matrix over ﬁles.
Also, the ﬁles of CPs have certain preference towards diﬀerent pico-cells
considering their transmission delay. A pico-cell can serve C MUs so that we
take the average transmission delay of Cn serving MUs as CP’s preference over
this pico-cell. We deﬁne it as follows.
Deﬁnition 2. For Vv ∈V, its preference over pico-cell Nn ∈N can be given as
Γn = 1
Cn

k∈Cn
τkn,
(10)
where Γn ∈CV ∗N is the ﬁles’ preference matrix over pico-cells.
The detailed algorithm of sub-problem 1 is shown in Algorithm 1. We propose
a distributed algorithm where both ﬁles and pico-cells selﬁshly and rationally
interact in a way that the MUs sum-transmission delay is minimized. As shown
in Algorithm 1, we use Γv and Γn as preference lists. We assume that the number
of ﬁles is far more larger than the number of pico-cells. At ﬁrst, the pico-cells
send their ﬁrst choices according to their preference lists. Since a ﬁle can be
Algorithm 1. File Selection Matching Algorithm
Require: Γv Γn
Initialize:
Set Q1 and construct lists of Unmatched pico-cells to ﬁles as sets of Unmatch1 =
{N1, N2, · · · , Nn}
Main Process:
(1)Each pico-cell sends oﬀer to ﬁrst ﬁle in its preference list.
(a)If the number of oﬀers is more than Q1, then the CP choose most preferred
pico-cells and remove these Q1 pico-cells from Unmatch1 and the others will be
rejected.
(b)Else the oﬀers will all be accepted.
(2)The rejected pico-cells will remove the most preferred ﬁles from its preference
lists and go on to take part in Unmatch1.
(3)The algorithm continues until Unmatch1 is empty.
Ensure: stable matching µ1.

670
G. Shi et al.
cached in Q1 pico-cells, we need judge whether the requests from pico-cells for a
ﬁle are more than the quota Q1. If there are more than Q1 pico-cells requesting
the same ﬁle, CP will select its most preferred Q1 pico-cells. If the requests for a
ﬁle are less than or equal to the quota Q1, ﬁles accept these requests all. Then,
the remaining pico-cells will be rejected and continue to take part in next round
of oﬀers until each pico-cell gets a ﬁle to cache.
3.4
Pico-Cell Selection Algorithm
After the ﬁle allocation problem solved by Algorithm 1, we turn- to handle the
pico-cell selection problem. The transmission delay from the pico-cell to each MU
is employed to construct the preference of this pico-cell. Thus, the preference of
pico-cell over MU is written as follows.
Deﬁnition 3. For a pico-cell Nn ∈N , its preference over MU Mm ∈M can
be given as
Γm = τ v
mn,
(11)
where Γm ∈CN∗M is the pico-cells’ preference matrix over MUs.
Moreover, the preference over pico-cells by MUs will be eﬀected by sub-
problem 1. When the pico-cells cached ﬁles, they broadcasts information about
the cached ﬁles to all serving MUs. Accordingly, the MUs’ preference over pico-
cell is also based on pmv, since diﬀerent ﬁles have diﬀerent attraction for MUs.
Then, the MU’s preference over pico-cells is written as follows.
Deﬁnition 4. For Mm ∈M, its preference over pico-cell Nn ∈N can be
given as
Γn′ = τ v
mnpmv,
(12)
where Γn′ ∈CM∗N is the MUs’ matrix preference over pico-cells.
The speciﬁc algorithm of sub-problem 2 is shown in Algorithm 2. The dis-
tributed Algorithm 2 has been proposed to minimize sum-transmission delay
by allocate the MUs to pico-cells eﬀectively. The distributed Algorithm 2 pro-
gresses as MUs send their oﬀers to most select pico-cells. Then, if the requests
for a pico-cell are more than the quota Q2, the pico-cell will decide to accept
the more preferred MUs according to preference lists, and reject the others. Else,
pico-cells will accept all requests. The rejected MUs remove the most select pico-
cells and continue to take part in progress till all pico-cells could not construct
more links to MUs. At the last, if there still exists a MU without links, it will
connect to Macro-cell.

Two-Tier Matching
671
Algorithm 2. Pico-cell Selection Matching Algorithm
Require: Γm Γn′
Initialize:
Set Q2 and construct lists of Unmatched MUs to pico-cells as sets of Unmatch2 =
{M1, M2, · · · , Mm}
Main Process:
(1)Each MU makes an oﬀer to pico-cell which is in ﬁrst place in MUs’ preference
list.
(a)If the number of oﬀers is more than Q2, then the pico-cell choose most pre-
ferred MUs and remove these MUs from Unmatch2. The others are rejected and
still be active in Unmatch2.
(b)Else, the all oﬀers will be accepted by pico-cells.
(2)The rejected ones delete the most preferred pico-cell from its preference lists.
(3)The process repeats (1) and (2) until Unmatch2 is empty or all pico-cells can
not accept any other MUs.
(4)The unmatched MUs will have a connection with Macro-cell.
Ensure:
stable matching µ2.
3.5
Stability of Matching
At last, it is critical to ﬁnd a stable matching between two opposite sides, because
it guarantees that none of players have motivations to change their matched
players. Since the matching μ1 obeys the similar matching rules with μ2, we will
analysis the stability of the second matching μ2 for brevity.
We prove it by contradiction. Given a blocking pair (M1, N1) for μ2. In this
case, N1 prefers M1 to μ2(N1) and M1 prefers N1 to at least one element in
μ2(M1), i.e., the MU matches with another pico-cell which is in a higher order
in preference list than its previous matched player, and hence both opposite
sides will improve their outcomes. But it is contrary to the original deﬁnition
of matching, i.e., the opposite two sides will change its order in preference list
ﬁrstly in order to get a better outcome. Thus, there exists no blocking pair in
matching games and μ2 is proved to be a stable matching.
4
Numerical Results
In this section, we evaluate the performance of the proposed two algorithms by
some numerical results. We assume the quota of V is 20 and Q1 = 2. Moreover,
the quota of M is ∈[16, 34] and the quota of N is ∈[8, 20]. In this simulations,
we assume all MUs and pico-cells are randomly located and the physical layer
parameters are set to be practical. The transmit power of a pico-cell is typically
2W, the pass loss α is 4 and the noise power is set to 10−10.
In the following ﬁgures, we compare our proposed algorithms with no caching,
random allocation and exhaustive searching algorithms. In the no caching algo-
rithm, the pico-cell caches no ﬁle. If MUs connect to the pico-cells, the pico-
cells would download the requesting ﬁles via backhaul channels ﬁrstly and then

672
G. Shi et al.
transmit the ﬁles to MUs. Thus, no caching algorithm will lead to high latency.
In the random allocation algorithm, we assign that ﬁles are randomly cached. In
the exhaustive searching algorithm, the problems are addressed by centralized
solution with high complexity.
In Fig. 2, the number of MUs is 60 and the pico-cell number varies from
8 to 20 with each pico-cell serving at most 2 MUs. As observed from Fig. 2,
with the increasing of pico-cell number, the average delay of both the exhaustive
searching algorithm curve and proposed algorithm curve have a decreasing trend.
Though the exhaustive searching algorithm shows better performance to the
proposed one, the proposed algorithm has less computation complexity O(M ×
N) while the exhaustive searching algorithm complexity increases exponentially
over network size. It is easy to verify that with low complexity, the proposed
algorithm will reduce a big cost of server processing power. Also, it can be
observed that no caching algorithm’s average downloading delay is ﬁxed with
the 0.5 s delay. And we ﬁnd that random allocation algorithm exhibits a inferior
performance compared with proposed algorithm.
In Fig. 3, we ﬁx the pico-cell number to be 10 and vary the MUs’ number from
16 to 34. Figure 3 displays that the proposed one has similar delay performance
with the exhaustive searching algorithm, and they both descend as the increase
of MUs’ numbers. In random allocation algorithm, it shows inferior performance
compared with proposed algorithm.
Fig. 2. Average delay vs Number of pico-cells

Two-Tier Matching
673
Fig. 3. Average delay vs Number of MUs
5
Conclusion
In this paper, we solve the resource allocation problems in a pico-cell based
caching network. The problems are ﬁrstly decoupled into two sub-problems.
Then, we construct the preference lists of pico-cells, MUs and CPs, respectively.
Then, two algorithms is proposed to ﬁnd stable matchings in these two matching
games. At last, simulation results are shown to demonstrate that the proposed
algorithm has similar performance with the exhaustive searching algorithm in
reducing average transmission delay and shows better performance than the ran-
dom allocation and no caching algorithms.
References
1. Golrezaei, N., Molisch, A.F., Dimakis, A.G., Caire, G.: Femtocaching and device-
to-device collaboration: a new architecture for wireless video distribution. IEEE
Commun. Mag. 51(4), 142–149 (2013)
2. Zhang, H., Liu, H., Jiang, C., Chu, X.: A practical semidynamic clustering scheme
using aﬃnity propagation in cooperative picocells. IEEE Trans. Veh. Technol.
64(9), 4372–4377 (2015)
3. Quek, T., De, G., Guvenc, I., Kountouris, M.: Small Cell Networks - Deployment,
PHY Techniques, and Resource Management. Cambridge University Press, New
York (2013)
4. Shanmugam, K., Golrezaei, N., Dimakis, A.G., Molisch, A.F., Caire, G.: Femto-
caching: wireless content delivery through distributed caching helpers. IEEE Trans.
Inf. Theor. 59(12), 8402–8413 (2013)

674
G. Shi et al.
5. Golrezaei, N., Mansourifard, P., Molisch, A.F., Dimakis, A.G.: Base-station
assisted device-to-device communications for high-throughput wireless video net-
works. Comput. Sci. 13(7), 7077–7081 (2012)
6. Li, J., Chen, H., Chen, Y., Lin, Z., Vucetic, B., Hanzo, L.: Pricing and resource
allocation via game theory for a small-cell video caching system. IEEE J. Sel. Areas
Commun. 34(8), 2115–2129 (2016)
7. Gu, Y., Saad, W., Bennis, M., Debbah, M., Han, Z.: Matching theory for future
wireless networks: fundamentals and applications. IEEE Commun. Mag. 53(5),
52–59 (2015)
8. Namvar, N., Saad, W., Maham, B., Valentin, S.: A context-aware matching game
for user association in wireless small cell networks. In: 2014 IEEE International
Conference on Acoustics, Speech and Signal Processing (ICASSP), pp. 439–443,
May 2014
9. Hamidouche, K., Saad, W., Debbah, M.: Many-to-many matching games for proac-
tive social-caching in wireless small cell networks. In: 2014 12th International Sym-
posium on Modeling and Optimization in Mobile, Ad Hoc, and Wireless Networks
(WiOpt), pp. 569–574, May 2014
10. Boyd, S., Vandenberghe, L.: Convex Optimization. Cambridge University Press,
New York (2004)
11. Roth, A., Sotomayor, M.: Two Sided Matching: A Study in Game-Theoretic Mod-
eling and Analysis, 1st edn. Cambridge University Press, Cambridge (1989). Ideas
Help Page
12. Gale, D., Shapley, L.S.: College admissions and the stability of marrige. Am. Math.
Mon. 69(1), 9–15 (1962)

A Resource Allocation Scheme Based
on Genetic Algorithm for D2D
Communications Underlaying Multi-channel
Cellular Networks
Ying Sun1, Xijun Yan1, Xujie Li1,2(&), Yan Gu1, and Chenming Li1
1 College of Computer and Information, Hohai University,
Nanjing 210098, China
lixujie@hhu.edu.cn
2 School of Engineering, University of Warwick, Coventry CV4 7AL, UK
Abstract. In this paper, a resource allocation scheme based on genetic algo-
rithm for device-to-device (D2D) communication underlaying Muti-channel
cellular networks is proposed. In our scenarios, N cellular user equipments
(CUEs) and M D2D user equipments (DUEs) coexist and share total channel
resources. One DUE pair includes a D2D transmitting user equipment (DTUE)
and a D2D receiving user equipment (DRUE). The introduction of additional
between CUEs and DUEs leads to increases in complexity of resource alloca-
tion. First of all, the system model of D2D communications is presented. Then
the resource allocation problem based on genetic algorithm is formulated. Next a
resource allocation scheme based on genetic algorithm is proposed. Finally, the
analysis and simulation results show the performance of proposed scheme
outperform that of random algorithm and is very close to that of exhaustive
algorithm. This result can provide an effective solution for resource allocation
and optimization of D2D communications.
Keywords: D2D communications  Resource allocation  Genetic algorithm
1
Introduction
With the development of society, demands of users for data service increase rapidly. The
rare of frequency resource makes the problem more troublesome. Device-to-device
(D2D) communications is proposed as an efﬁcient method to resolve this problem [1–3].
As the key technology of 5G, D2D communications can effectively improve resource
utilization for cellular networks [4–6].
Resource allocation is a crucial issue in D2D communications [7–12]. In recent
years, many researchers adopt various traditional optimization methods to solve
resource allocation problem in various application scenarios [13–20]. Meanwhile, there
are some papers about the resource allocation based on genetic algorithm. In [21], a
genetic algorithm based joint resource allocation and user matching scheme is proposed
to minimize the intra-cell interference. This algorithm is used to globally search optimal
user matching solution to maximize system throughput. In [22], a genetic algorithm
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 675–684, 2018.
https://doi.org/10.1007/978-3-319-72823-0_62

based
user
machine
scheme
with
optimal
power
allocation
to
achieve
the
multi-dimension optimization is proposed and discussed. The genetic algorithm is
applied to obtain the near-optimal user matching in the whole network. In [23], based
on the optimization target focusing on device energy efﬁciency under certain system
throughput insurance rather than the traditional system throughput, a modiﬁed genetic
algorithm-based
scheme
is
applied
to
address
the
facing
non-deterministic
polynomial-time hard problem with higher convergence and lower complexity. In
[24], the authors consider the design of link assignment, channel allocation and power
control in D2D-aided content delivery scenario for both user fairness and system
throughput under QoS requirement. The genetic algorithm is adopted optimize link
assignment. And when deriving the ﬁtness of each chromosome, power control opti-
mization will be involved. In [25], a heuristic genetic algorithm to evaluate the secrecy
rate is represented. In addition, the authors also propose approximated optimization
solutions by considering power allocation of upper and lower bounds to simplify the
problem, by leveraging the fractional programming oriented Dinkelbach-type algo-
rithm. In [26], the authors investigate the optimization of the connectivity of different
UEs with the target to minimize the total transmission power. An optimization
framework and a distributed strategy based on Q-learning and softmax decision making
is presented.
However, these papers mainly focus the situation that one CUE and one DUE pairs
share the channel resource. To full use of the superiority introduced by D2D tech-
nology, we analyse the resource allocation problem under the condition that the number
of DUE pairs is far than that of CUEs. In this paper, a resource allocation scheme based
genetic algorithm for D2D communications underlaying Muti-channel cellular net-
works is proposed. In our scenarios, the number of DUE pairs is far more than that of
CUEs. The main contributions of our work are as follows:
(1) We propose a resource allocation scheme based genetic algorithm for D2D
communications underlaying Muti-channel cellular networks.
(2) We evaluate the capacity of D2D communications and the average transmission
power of CUEs.
The rest of this paper is organized as follows. In Sect. 2, we elaborate our system
model. We then propose a resource allocation scheme based genetic algorithm for D2D
communications and evaluate the capacity of D2D communications and the average
transmission power of CUEs in Sect. 3. Simulation results are presented in Sect. 4, and
the conclusion is drawn out in Sect. 5.
2
System Model
2.1
Network Model
In cellular networks such as frequency division duplex long term evolution
(FDD-LTE), at most one CUE can be allocated to a single sub-channel generally. We
assume that the communication system only provides N sub-channels. The means that
the communication system can accommodate up to N CUEs. Let us consider a single
676
Y. Sun et al.

cellular network, where N CUEs and M DUE pairs coexist, as illustrated in Fig. 1.
Every DUE pair consists of a D2D transmitting user equipment (DTUE) and a D2D
receiving user equipment (DRUE). Meanwhile, we consider that the CUE and the
DTUE follow a uniform distribution in the cell with the radius of R and the DRUE
uniformly locates in the circle with center at the DTUE and radius equal to L (the
allowed maximum communication distance for D2D communications). Every CUE
occupies one sub-channel, and M DUE pairs share the total sub-channel resources. To
full use of the superiority introduced by D2D technology, we analyze the resource
allocation problem under the condition that the number of DUE pairs is far than that of
CUEs. Because it is advantageous to use uplink resources for the D2D link, we only
focus the case that the D2D links use uplink cellular resources in this paper.
2.2
Channel Model
In conventional cellular network, power-control scheme is applied into CUEs. Given
the complexity of implementation for D2D communication, power-control scheme is
not applied into DUE pairs. Here we assume that the transmitting powers for all
DTUEs are the same and denoted as PT. Meanwhile, we assume that the UE links
follow a median path loss model having the form Pr=Pt ¼ 1=ra [27]. Here Pr is the
received power at the UE or BS, Pt is transmitting power of the UE, r is the distance
between the transmitter and receiver of a pair of DUEs, a is path loss exponent.
3
Problem Formulation and Solution
As mentioned above, N CUEs and M DUE pairs share total sub-channel resources. Let
S ¼ ðN; MÞ. In cellular networks such as frequency division duplex long term evolu-
tion (FDD-LTE), at most one CUE can be allocated to a single sub-channel in general.
We assume that there are N sub-channels. Then each CUE is allocated one sub-channel,
and all DUE pairs share total sub-channels. For the convenience, we assume that CUE
Fig. 1. System model of D2D communications
A Resource Allocation Scheme Based on Genetic Algorithm
677

i use ith sub-channel. Now, we can consider one sub-channel as one package. Then
there are N packages. What we need to do is to allocate all DUE pairs to N packages.
The goal we pursue is the maximum capacity. The ith package is denoted as <i,
i ¼ ð1; 2;    ; NÞ. The diagram below shows an example of S ¼ ð3; 8Þ (Fig. 2).
The genetic algorithm can be divided into ﬁve main steps:
1. Coding
For CUEs, CUE i is allocated to ith sub-channel (package i) by default. For DUE
pair j, the corresponding gene-bit is the sequence number of the assigned package
for DUE pair j. Then every chromosome is coded as a M dimensional row vector
like G ¼ ðg1;    ; gj;    ; gMÞ gj 2 ð1; 2;    ; NÞ.
For example of S ¼ ð3; 8Þ as shown above, the corresponding chromosome is
ð1; 2; 1; 3; 2; 3; 1; 3Þ. That means DUE pair 1, 3, 7 are allocated to package1, DUE
pair 2, 5 are allocated to package2 and DUE pair 4, 6, 8 are allocated to package3.
2. Population Initialization
We initiate the population number as 10 * N. For every chromosome, the element
gj in G is a discrete random variable between 1 and N. We deﬁne the probability
mass function p(a) of X by pðaÞ ¼ PfX ¼ ag. We assume that the every DUE pairs
is equivalent. For gj, we have
pð1Þ ¼ pð2Þ ¼    ¼ pðMÞ ¼ 1=M
ð1Þ
3. Set Fitness Function
In D2D communications, we need to get the maximum capacity. To guaranty the
QoS of UEs, the signal to interference plus noise ratio (SINR) value should greater
than SINR threshold. Therefore, for the CUE i, the SINR can be written as
bi ¼
Pi=ra
i
P
k2<i
PT=da
k þ N0
ð2Þ
Here, Pi is the transmitting power of CUE i, ri is the distance between CUE i and
the BS, PT is the transmitting power of the DTUE k, dk is the distance between
DTUE k and the BS, a is the path loss exponent, N0 is noise power.
At the same time, for the DRUE j, the SINR can written as
CUE1
DUE1
DUE3
DUE7
CUE2
CUE3
DUE2
DUE5
DUE4
DUE6
DUE8
Channel 1(Package1)
Channel 2(Package2)
Channel 3(Package3)
Fig. 2. An example of channel resource allocation
678
Y. Sun et al.

cj ¼
PT=la
j
Pm=dm;j þ
P
k2<m
k62m
PT=da
k;j þ N0
ð3Þ
Here, lj is the distance between DTUE j and DRUE j, dm;j is the distance
between CUE m and DRUE j, dk;j is the distance between DTUE k and DRUE j.
Obviously, the total capacity consists of two parts: CUEs and DUE pairs.
For CUE i, the capacity is written as
Cci ¼ B log2ð1 þ biÞ
ð4Þ
Here, B is the bandwidth of one sub-channel.
Similarly, for DUE pairs, we consider that DUE pairs j is belong to package m,
i.e. j 2 <m. Then, we have
Cdj ¼ B log2ð1 þ cjÞ
ð5Þ
Therefore, the ﬁtness function is denoted as
CðUxÞ ¼
X
N
i¼1
Cci þ
X
M
j¼1
Cdj ¼ B
X
N
i¼1
log2ð1 þ biÞ þ B
X
M
j¼1
log2ð1 þ cjÞ
ð6Þ
Here, Ux represent some chromosome.
4. Breeding Process
The population of genetic algorithm evolves toward the optimal solution by
breeding process, which consists of 4 steps: selection, crossover, mutation,
amendment.
(1) Selection
Based on classical roulette wheel selection scheme, individual Uk is selected
with probability p(Uk) which is denoted as
pðUkÞ ¼
CðUkÞ
P
10N
x¼1
CðUxÞ
ð7Þ
(2) Crossover
The function of crossover is to get the better next-generation. A single point
crossover operator is adopted in our algorithm. The crossover point of the
chromosome is selected randomly, and the right parts of points of two parent
chromosomes are exchanged to generate next-generation. We denote the
crossover probability as P0. The algorithm of crossover is as follows:
A Resource Allocation Scheme Based on Genetic Algorithm
679

The crossover point is randomly selected between 1 and M.
(3) Mutation
We denote the probability of mutation as P1. If the value of the gene bit is x,
then the mutated value is randomly selected from the set x (The universal set is
S ¼ 1    N).
(4) Amendment
To guaranty the QoS of UEs, the SINR value must be greater than SINR
threshold (bi  C for i = 1…N, cj  C for j = 1…M, here C is the SINR
threshold). Sometimes, for one chromosome, the corresponding channel
allocation result maybe violates the QoS conditions. This can happen during
three statuses: population initialization, mutation, amendment. Therefore, we
need repeat the relative process to amend the chromosome.
(5) Stopping criteria
Usually, by iterating for Num generations, the population will eventually
evolve to a convergence. Finally, we get the best chromosome and calculate
the optimal result.
4
Simulations and Discussions
In this section, we discuss some important observations obtained from the simulation
results. In our simulations, we assume that CUEs and DTUEs follow a uniform dis-
tribution in the cell with the radius of R and the DRUEs uniformly locates in the circle
with center at the corresponding DTUE and radius equal to L. Simulation parameters
are summarized in Table 1.
Table 1. Simulation parameters
Parameter
Value
Parameter
Value
Cell radius (R)
600 m
Crossover probability P0
0.2
L
20 m
The number of DUE pairs
10
Path loss factor (a) 4
The maximum transmission power of CUE 2 W
SINR threshold (b) 6 dB
The transmission power of DTUE
0.001 W
N0
−105 dBm The number of CUEs
3
Iteration number
50
Probability of mutation as P1
0.2
Begin
k=0;
While k < 10*N
if random number <
0P
then
Uk is selected as the parents for crossover.
End
k = k + 1
End
End
680
Y. Sun et al.

Figure 3 shows the capacity comparisons of D2D communications among these
three algorithms. Obviously, exhaustive algorithm can get the maximum capacity
because every feasible solution is calculated. The capacity performance based on
genetic algorithm is very close to the optimal value based on the exhaustive algorithm,
and far greater than that based on random algorithm. Meanwhile, it can be seen that the
proposed genetic algorithm has fast convergence speed. We can get the objective
function’s optimal value only go through about 11 iterations.
Similarly, Fig. 4 demonstrates the average transmission power of CUEs based on
the three algorithms. The genetic algorithm proposed in this paper can get the minimal
average transmission power of CUEs compared with exhaustive algorithm and random
5
10
15
20
25
30
35
40
45
50
1695
1700
1705
1710
1715
1720
1725
1730
Number of iterations
Capacity(bit/s)
Genetic Algorithm
Random Algorithm
Exhaustive  Algorithm
Fig. 3. The capacity of D2D communications
5
10
15
20
25
30
35
40
45
50
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
Number of iterations
The average transmission power of CUE (W)
Random Algorithm
Generic Algorithm
Exhaustive  Algorithm
Fig. 4. The average transmission power of CUEs
A Resource Allocation Scheme Based on Genetic Algorithm
681

algorithm. This is because the power control scheme for CUEs is applied into our
algorithm. Likewise, the proposed genetic algorithm can obtain very fast convergence
speed.
5
Conclusions
In this paper, D2D system model where M DUE pairs and N CUEs coexist is described.
Then the resource allocation problem based on genetic algorithm is formulated and
analyzed. Next, a resource allocation scheme based on genetic algorithm is proposed.
Finally, the analysis and simulation results show the performance of proposed scheme
outperform that of random algorithm and is close to that of exhaustive algorithm. This
result can be applied for design and optimization of D2D communications.
Acknowledgments. This work was supported in part by “Technical research and demonstration
of emergency operation and distributed control of the main and middle routes of South-to-North
Water Diversion Project” of the National Key Technology R&D Program in the 12th Five-year
Plan of China (2015BAB07B03), “Key technology integration and demonstration of optimum
dispatching of pumping stations of east route of South-to-North Water Diversion Project” of the
National Key Technology R&D Program in the 12th Five-year Plan of China (2015BAB07B01),
the Project of National Natural Science Foundation of China (61301110), the Project funded by
the Priority Academic Program Development of Jiangsu Higher Education Institutions, and the
Project of Jiangsu Overseas Research & Training Program for University Prominent Young &
Middle-Aged Teachers and Presidents.
References
1. Li, X., Wang, Z., Sun, Y., Gu, Y., Hu, J.: Mathematical characteristics of uplink and
downlink interference regions in D2D communications underlaying cellular networks. Wirel.
Pers. Commun. 93, 917–932 (2017)
2. Li, X., Zhang, W., Zhang, H., Li, W.: A combining call admission control and power control
scheme for D2D communications underlaying cellular networks. China Commun. 13, 137–
145 (2016)
3. Li, X., Zhang, H., Zhang, W., Yan, F.: A call admission control scheme on the uplink of
D2D communications underlaying cellular networks. Intell. Autom. Soft Comput. 22, 605–
612 (2016)
4. Khoshkholgh, M., Zhang, Y., Chen, K., Shin, K., Gjessing, S.: Connectivity of cognitive
device-to-device communications underlying cellular networks. IEEE J. Sel. Areas
Commun. 33, 81–99 (2015)
5. Zhang, H., Dong, Y., Cheng, J., Hossain, M.J., Leung, V.C.: Fronthauling for 5G LTE-U
ultra dense cloud small cell networks. IEEE Wirel. Commun. 23, 48–53 (2016)
6. Zhang, H., Liu, N., Chu, X., Long, K., Aghvami, A., Leung, V.: Network slicing based 5G
and future mobile networks: mobility, resource management, and challenges. IEEE
Commun. Mag. (2017)
7. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wen, X., Tao, M.: Resource allocation in
spectrum-sharing OFDMA femtocells with heterogeneous services. IEEE Trans. Commun.
62, 2366–2377 (2014)
682
Y. Sun et al.

8. Zhang, H., Jiang, C., Beaulieu, N.C., Chu, X., Wang, X., Quek, T.Q.: Resource allocation
for cognitive small cell networks: a cooperative bargaining game theoretic approach. IEEE
Trans. Wirel. Commun. 14, 3481–3493 (2015)
9. Zhang, H., Jiang, C., Mao, X., Chen, H.-H.: Interference-limited resource optimization in
cognitive femtocells with fairness and imperfect spectrum sensing. IEEE Trans. Veh.
Technol. 65, 1761–1771 (2016)
10. Liu, D., Zhang, H., Zheng, W., Wen, X.: The sub-channel allocation algorithm in femtocell
networks based on ant colony optimization. In: 2012-MILCOM, pp. 1–6 (2012)
11. Zhang, Z., Zhang, H., Liu, H., Jing, W., Wen, X.: Energy-efﬁcient resource optimization in
spectrum sharing two-tier femtocell networks. In: 2013 IEEE International Conference on
Communications Workshops (ICC), pp. 571–575 (2013)
12. Zhang, Z., Zhang, H., Lu, Z., Zhao, Z., Wen, X.: Energy-efﬁcient resource optimization in
OFDMA-based dense femtocell networks. In: Energy-Efﬁcient Resource Optimization in
OFDMA-Based Dense Femtocell Networks Telecommunications (ICT), pp. 1–5 (2013)
13. Han, J., Cui, Q., Yang, C., Tao, X.: Bipartite matching approach to optimal resource
allocation in device to device underlaying cellular network. Electron. Lett. 50, 212–214
(2014)
14. Li, Y., Jin, D., Yuan, J., Han, Z.: Coalitional games for resource allocation in the
device-to-device uplink underlaying cellular networks. IEEE Trans. Wirel. Commun. 13,
3965–3977 (2014)
15. Song, L., Niyato, D., Han, Z., Hossain, E.: Game-theoretic resource allocation methods for
device-to-device communication. IEEE Wirel. Commun. 21, 136–144 (2014)
16. Xu, C., Song, L., Han, Z., Zhao, Q., Wang, X., Cheng, X., Jiao, B.: Efﬁciency resource
allocation for device-to-device underlay communication systems: a reverse iterative
combinatorial auction based approach. IEEE J. Sel. Areas Commun. 31, 348–358 (2013)
17. Wang, F., Li, Y., Wang, Z., Yang, Z.: Social-community-aware resource allocation for D2D
communications underlaying cellular networks. IEEE Trans. Veh. Technol. 65, 3628–3640
(2016)
18. Zhang, R., Cheng, X., Yang, L., Jiao, B.: Interference graph-based resource allocation
(InGRA) for D2D communications underlaying cellular networks. IEEE Trans. Veh.
Technol. 64, 3844–3850 (2015)
19. Ye, Q., Al-Shalash, M., Caramanis, C., Andrews, J.G.: Distributed resource allocation in
device-to-device enhanced cellular networks. IEEE Trans. Commun. 63, 441–454 (2015)
20. Hoang, T.D., Le, L.B., Le-Ngoc, T.: Resource allocation for D2D communication underlaid
cellular networks using graph-based approach. IEEE Trans. Wirel. Commun. 15, 7099–7113
(2016)
21. Yang, C., Xu, X., Han, J., Rehman, W.U., Tao, X.: GA based optimal resource allocation
and user matching in device to device underlaying network. In: 2014 IEEE Wireless
Communications and Networking Conference Workshops (WCNCW), pp. 242–247. IEEE
(2014)
22. Yang, C., Xu, X., Han, J., Tao, X.: GA based user matching with optimal power allocation in
D2D underlaying network. In: 2014 IEEE 79th Vehicular Technology Conference (VTC
Spring), pp. 1–5. IEEE (2014)
23. Yang, C., Xu, X., Han, J., Tao, X.: Energy efﬁciency-based device-to-device uplink resource
allocation with multiple resource reusing. Electron. Lett. 51, 293–294 (2015)
24. Tang, R., Zhao, J., Qu, H.: Joint optimization of channel allocation, link assignment and
power control for device-to-device communication underlaying cellular network. China
Commun. 12, 92–100 (2015)
A Resource Allocation Scheme Based on Genetic Algorithm
683

25. Wang, L., Wu, H., Liu, L., Song, M., Cheng, Y.: Secrecy-oriented partner selection based on
social trust in device-to-device communications. In: 2015 IEEE International Conference on
Communications (ICC), pp. 7275–7279 (2015)
26. Pérez-Romero, J., Sánchez-González, J., Agustí, R., Lorenzo, B., Glisic, S.: Power-efﬁcient
resource allocation in a heterogeneous network with cellular and D2D capabilities. IEEE
Trans. Veh. Technol. 65, 9272–9286 (2016)
27. Gupta, P., Kumar, P.R.: The capacity of wireless networks. IEEE Trans. Inf. Theor. 46, 388–
404 (2000)
684
Y. Sun et al.

Comparison of Isotropic and 3D
Beamforming LTE Systems Using Simulation
Cheng Xu(&) and John Cosmas
Department of Electronic and Computer Engineering, Brunel University,
Uxbridge, Middlesex, UK
{Cheng.xu,John.cosmas}@brunel.ac.uk
Abstract. 4G LTE system uses an isotropic antenna to transmit radio wave
power uniformly in all directions. In contrast, 3D beamforming is a 5G tech-
nology that directs the radio wave beam power towards those user equipment
intended for communication thereby increasing SINR and decreasing the BER
experienced at the User Equipment (UE). This paper compares the performance
of an isotropic LTE system with a 3D beamforming system by quantifying the
average Signal Noise Ratio (SNR) and Bit Error Rate (BER) received by all UEs
in its coverage area.
Keywords: 3D beamforming  5G  LTE  Simulation  BER
1
Introduction
There are several technologies for 5G designers that promise improved system per-
formance and the 3D MIMO beamforming is one of the key technologies for 5G
system [1]. This paper develops a methodology for estimating the parameters of the
beamforming weighting function of a 3D antenna array and shows how the 3D MIMO
beamforming is applied in the LTE system. This idea is based on “Study on 3D channel
model for LTE, 3GPP TR 36.873” [2]. The advantage of directing a 3D beamforming
to a group of users is that the very high bandwidth channel can be shared between a
large number of users using time and frequency division multiplexing in Orthogonal
Frequency Division Multiplexing (OFDM) without signiﬁcantly changing the beam-
forming direction thereby simplifying the control at the BS and simplifying the syn-
chronization of the user terminals with the transmitted channel. The cost is that the user
terminals experience a range of BER qualities.
This paper simulates a 3D beamforming system to quantify the range of BER
qualities that are obtained when directing a beamforming towards a group of user
terminals. The simulation results show better performance than the original LTE sys-
tem. The energy from each antenna is focused so the received signal strength at the user
terminal is strong, which inﬂuence the signal quality. For example, if mobile phone
may not receive a signal when the user is in the building or is far from the base station
then a weighting function is necessary, which can focus the total energy from antenna
array so that the signal can be sent further and the signal quality is enhanced at the user
equipment. The simulations show that mean BER for the population of user terminals is
improved compared to an isotropic LTE system.
© ICST Institute for Computer Sciences, Social Informatics and Telecommunications Engineering 2018
K. Long et al. (Eds.): 5GWN 2017, LNICST 211, pp. 685–694, 2018.
https://doi.org/10.1007/978-3-319-72823-0_63

Section 2 establishes the channel model and the weight matrix for directing the 3D
beamforming towards the UEs. Section 3 explains how the 3D beamforming tech-
nology is applied to LTE system. Section 4 explains the parameters in the simulation.
Section 5 presents and analyses the results from the simulation. Section 6 provides a
conclusion for the whole paper.
2
3D Beamforming Channel Model
2.1
Calculating Channel Coefﬁcients
The channel coefﬁcients have been obtained from “3GPP TR 36.873” [2]. In next para-
graphs, the H is the channel coefﬁcient. Figure 1 shows the two kinds of path in the
channel model.One of them is Non-lineof sight (NLOS) and other is Line-of-sight (LOS).
There are two kinds of channel coefﬁcients. The channel coefﬁcient for the
NLOS is [2]:
Hu;s;nðtÞ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Pn=M
p
X
M
m¼1
Frx;u;h hn;m;ZOA; un;m;AOA


Frx;u;u hn;m;ZOA; un;m;AOA


"
#T
exp jUhh
n;m


ﬃﬃﬃﬃﬃﬃﬃﬃ
j1
n;m
q
exp jUhu
n;m


ﬃﬃﬃﬃﬃﬃﬃﬃ
j1
n;m
q
exp jUuh
n;m


exp jUuu
n;m


2
64
3
75
Ftx;s;h hn;m;ZOD; un;m;AOD


Ftx;s;u hn;m;ZOD; un;m;AOD


"
#
 exp j2p21
0
^rT
rx;n;m:drx;u




 exp j2p21
0
^rT
tx;n;m:dtx;s




 exp j2p2n;mt


ð1Þ
Fig. 1. The single channel model. In ﬁgure, the NLOS is Non-line of sight and the LOS is line
of sight. The lines are the path.
686
C. Xu and J. Cosmas

The channel coefﬁcient for the LOS is [2]:
Hu;s;nðtÞ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1
KR þ 1
r
H0
u;s;n tð Þ þ d n  1
ð
Þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
KR
KR þ 1
r
Frx;u;h hLOS;ZOA; uLOS;AOA


Frx;u;u hLOS;ZOA; uLOS;AOA


"
#T
exp jULOS
ð
Þ
0
0
exp jULOS
ð
Þ


Ftx;s;h hLOS;ZOD; uLOS;AOD


Ftx;s;u hLOS;ZOD; uLOS;AOD


"
#
: exp j2p21
0
^rT
rx;LOS: drx;u




: exp j2p21
0
^rT
tx;LOS: dtx;s




ð2Þ
Since the propagation paths over which the signal is transmitted is not deterministic,
the probability of existence for each path must be set. The calculation for probability of
the LOS is deﬁned in Ref. [2]. This probability deﬁnes how the power is distributed for
different paths. If the power is less than −25 dB, then this path is ignored.
2.2
Calculating the Weight Matrix
A BS (base station) is equipped with antenna array that consists of MN antenna
elements which is shown in Fig. 2.
In order to represent the different location of antenna elements, the direction matrix
D is introduced.
Fig. 2. There are N elements in the y-direction and M elements in the x-direction.
Comparison of Isotropic and 3D Beamforming LTE Systems
687

D ¼
d11
d12
  
d1M
d21
d22
  
d2M
...
...
  
...
dN1
dN2
  
dNM
2
6664
3
7775
dik ¼ ej½ði1Þbx þ ðk1Þby
where bx ¼  2p
k dx sin h0 cos /0 ¼ p sin h0 cos /0, by ¼  2p
k dV sin h0 sin /0 ¼ p
sin h0 sin /0.
2.3
Calculating the Weight Vector
In order to allow the desired signal to be received without modiﬁcation and reject the
undesired interfering signals, we let AF = 1 in the desired direction and AF = 0 in the
undesired interfering direction. That is in the desired direction, we hope AFx = 1 is for
am and AFy = 1 is for bn. in the undesired direction, we hope AFx = 0 and AFy = 0.
(1) Calculating the weight vector in x-direction a1
a2
  
aM
½
T
AFx ¼
X
M
m¼1
amejðm1Þðkdxsinhinhu þ bxÞ
¼
1
ejðkdxsinhinhu þ bxÞ
. . .
ejðm1Þðkdxsinhinhu þ bxÞ
	

a1
a2
. . .
aM
2
6664
3
7775
ð3Þ
In our paper, there are four beams, so we can let the one desired direction is h ¼ h0
and u ¼ u0; three undesired direction are respectively:
h ¼ h1 and u ¼ u1
h ¼ h2 and u ¼ u2
h ¼ h3 and u ¼ u3
In the desired direction, from (3), we have:
AFx ¼
1
ejðkdxsinh0cosu0 þ bxÞ
. . .
ejðm1Þðkdxsinh0cosu0 þ bxÞ
	

a1
a2
. . .
aM
2
664
3
775 ¼ 1
ð4Þ
In undesired direction, from (3), we have
688
C. Xu and J. Cosmas

AFx ¼
1
ejðkdxsinh0cosu0 þ bxÞ
. . .
ejðm1Þðkdxsinh0cosu0 þ bxÞ
	

a1
a2
. . .
aM
2
664
3
775 ¼ 0
ð5Þ
AFx ¼
1
ejðkdxsinh0cosu0 þ bxÞ
. . .
ejðm1Þðkdxsinh0cosu0 þ bxÞ
	

a1
a2
. . .
aM
2
664
3
775 ¼ 0
ð6Þ
AFx ¼
1
ejðkdxsinh0cosu0 þ bxÞ
. . .
ejðm1Þðkdxsinh0cosu0 þ bxÞ
	

a1
a2
. . .
aM
2
664
3
775 ¼ 0
ð7Þ
According to (4)–(7), we obtain
1
ejðkdxsinh0cosu0 þ bxÞ
. . .
ejðm1Þðkdxsinh0cosu0 þ bxÞ
1
ejðkdxsinh1cosu1 þ bxÞ
. . .:
ejðm1Þðkdxsinh1cosu1 þ bxÞ
1
ejðkdxsinh2cosu2 þ bxÞ
. . .:
ejðm1Þðkdxsinh2cosu2 þ bxÞ
1
ejðkdxsinh3cosu3 þ bxÞ
. . .:
ejðm1Þðkdxsinh3cosu3 þ bxÞ
2
664
3
775
a1
a2
. . .
aM
2
664
3
775 ¼
1
0
0
0
2
664
3
775
ð8Þ
To obtain the weight vector a1
a2
  
aM
½
T, we solve the equation
AX ¼ b
ð9Þ
where
A ¼
1
ejðkdx sin h0 cos u0 þ bxÞ
. . .
ejðm1Þðkdx sin h0 cos u0 þ bxÞ
1
ejðkdx sin h1 cos u1 þ bxÞ
. . .
ejðm1Þðkdx sin h1 cos u1 þ bxÞ
1
ejðkdx sin h2 cos u2 þ bxÞ
. . .
ejðm1Þðkdx sin h2 cos u2 þ bxÞ
1
ejðkdx sin h3 cos u3 þ bxÞ
. . .
ejðm1Þðkdx sin h3 cos u3 þ bxÞ
2
664
3
775
bT ¼ 1
0
. . .
0
½

Since X ¼ pinvðAÞ  b is the solution of (9), we obtain
a1
a2
  
aM
½
T¼ pinvðAÞ  b
Repeat these steps to calculate the weight vector in Y-direction; and then com-
bining those two weight vectors and direction matrix D obtained in Sect. 2.2 to
determine the weight for transmitted signal.
Comparison of Isotropic and 3D Beamforming LTE Systems
689

3
Applying the 3D Beamforming in LTE System
The simulation of LTE system is according to “PDSCH Throughput Conformance Test
for Single Antenna (TM1), Transmit Diversity (TM2), Open Loop (TM3) and Closed
Loop (TM4/6) Spatial Multiplexing” from the LTE System Toolbox in Matlab 2016a.
The downlink reference measurement channel conﬁguration is from “3GPPTS 36.101,
Table A.3.1.1-1” [3] as Table 1 shown.
The simulation program chooses the R.0 and R.5 to simulate because the LTE system
is a SISO system and the environment channel is Rayleigh fading channel model. The
modulation method is 16-QAM, which is R.0 and it is 64-QAM, which is R.5.
4
The Simulation of Program
The simulation program is about the LTE system using the 3D beamforming tech-
nology. The simulation results compare with the LTE system. The GUI Fig. 3 is:
Table 1. Overview of DL reference measurement channels.
Reference channels
Reference channels
R.0 (Port0, 1 RB, 16QAM,
CellRefP = 1, R = 1/2)
R.26 (Port5, 50 RB, 16QAM, CellRefP = 1, R = 1/2)
R.1 (Port0, 1 RB, 16QAM,
CellRefP = 1, R = 1/2)
R.27 (Port5, 50 RB, 64QAM, CellRefP = 1, R = 3/4)
R.2 (Port0, 50 RB, QPSK,
CellRefP = 1, R = 1/3)
R.28 (Port5, 1 RB, 16QAM, CellRefP = 1, R = 1/2)
R.3 (Port0, 50 RB, 16QAM,
CellRefP = 1, R = 1/2)
R.10 (TxDiversity|SpatialMux, 50 RB, QPSK,
CellRefP = 2, R = 1/3)
R.4 (Port0, 6 RB, QPSK,
CellRefP = 1, R = 1/3)
R.11 (TxDiversity|SpatialMux|CDD, 50 RB,
16QAM, CellRefP = 2, R = 1/2)
R.5 (Port0, 15 RB, 64QAM,
CellRefP = 1, R = 3/4)
R.12 (TxDiversity, 6 RB, QPSK, CellRefP = 4,
R = 1/3)
R.6 (Port0, 25 RB, 64QAM,
CellRefP = 1, R = 3/4)
R.13 (SpatialMux, 50 RB, QPSK, CellRefP = 4,
R = 1/3)
R.7 (Port0, 50 RB, 64QAM,
CellRefP = 1, R = 3/4)
R.14 (SpatialMux|CDD, 50 RB, 16QAM,
CellRefP = 4, R = 1/2)
R.8 (Port0, 75 RB, 64QAM,
CellRefP = 1, R = 3/4)
R.25 (Port5, 50 RB, QPSK, CellRefP = 1, R = 1/3)
R.9 (Port0, 100 RB, 64QAM,
CellRefP = 1, R = 3/4)
R.11-45RB (CDD, 45 RB, 16QAM, CellRefP = 2,
R = 1/2)
690
C. Xu and J. Cosmas

The operating time takes more than 8 h so there is the option about reading the data
from operated in before.
5
Analysis Results
Choose a 10 users random distribution in one cell. The each beam is sent from 8  8
antenna array. The environment is UMa and the modulation is 64-QAM (R.5). More
parameters for simulation are shown in Table 2. Figures 4 and 5 show the constellation
diagram of received symbols for one user when the modulation methods are 64-QAM
in LTE system and 3D LTE system respectively.
Fig. 3. The ﬁrst box is the options of parameters for the simulation. The second box is the
options for showing which beam. The third box is the options for calculating the BER. The last
box is choice of the SNR for BER in 3D LTE system.
Comparison of Isotropic and 3D Beamforming LTE Systems
691

Table 2. The setting of simulation parameters.
Options
Parameters
NO. Simulation
20 times
NO. Users
10
Size of antenna element
8  8
The min distance of cell
200 m
The max distance of cell 5000 m
Environment
UMa
Modulation
R.5
SNR range (dB)
[10 20 30 40]
Fig. 4. The constellation diagram of received symbols in 64-QAM LTE system
Fig. 5. The constellation diagram of received symbols in 64-QAM 3D beam LTE system
692
C. Xu and J. Cosmas

Comparing Figs. 4 and 5, the received symbols in 64-QAM 3D beam LTE are
better than the 64-QAM LTE system.
The Fig. 6 shows the comparison with BER between LTE system and 3D beam
LTE system in 64-QAM.
In Fig. 6, if the modulation method is 64-QAM, the BER of 3D LTE system is
closed zero, but the BER of SISO LTE system is more than 7%, which is larger than
the BER of 3D LTE system too much.
Therefore, the 3D LTE system has a better BER than the SISO LTE system when
the modulation method is 64-QAM. Then we test the effect from the number of users
and different environments on the BER in 3D LTE system when the SNR is 20 dB. The
results are shown in Fig. 7 and the Table 3 explains the signiﬁcance of all parameters
in Fig. 7.
Fig. 6. The red line is the BER of 3D beam LTE system and the blue is the BER of LTE system.
(Color ﬁgure online)
Table 3. The setting of simulation parameters.
Name
Explain
BER (%) The median values of all BER
UEs
The number of users
UMiR.5
The modulation methods is 64-QAM in UMi
UMiR.0
The modulation methods is 16-QAM in UMi
UMaR.5
The modulation methods is 64-QAM in UMa
UMaR.0
The modulation methods is 16-QAM in UMa
Comparison of Isotropic and 3D Beamforming LTE Systems
693

6
Conclusion
This paper ﬁrst develops a methodology for estimating the parameters of the beam-
forming weighting function of a 3D antenna array for directing the beam towards one
user terminal. The weighting makes the direction of energy from each antenna to be
focused on one direction. Moreover, the weighting makes the SINR between every two
beams to be smaller. The simulation of 3D beamforming applied to the LTE system
show that mean BER for the population of user terminals is improved compared to an
isotropic LTE system transmission but this is at the cost of the variability of the BERs
experienced by a small number of user terminals.
References
1. Agiwal, M., Roy, A., Saxena, N.: Next generation 5G wireless networks: comprehensive
survey. IEEE Commun. Surv. Tutor. 18(3), 1617–1655 (2016)
2. Study on 3D channel model for LTE (2012). http://www.3gpp.org
3. User Equipment (UE) radio transmission and reception (2016). http://www.3gpp.org
Fig. 7. The BER for different environments in 20 dB when the number of users are 2, 4, 6, 8 or 10.
694
C. Xu and J. Cosmas

Author Index
Aaron Gulliver, T.
395
Alnajjar, Khawla A.
484
Bai, Yong
146, 220
Bao, Hui
347
Bie, Rongfang
327
Cai, Yueming
206
Chai, Rong
28
Chai, Xiaomeng
194, 459, 544
Chen, Linna
288
Chen, Liu
52, 371
Chen, Weiwei
69, 99
Chen, Xiaokui
38
Chen, Xingyu
52, 371
Chen, Youjia
650
Chen, Yu
110
Chen, Zhi
228
Cheng, Chen
69, 99
Cheng, Hongwen
276, 506
Cheng, Xinsong
338
Cheng, Xinzhou
69, 89, 99
Cosmas, John
685
Cui, Donglin
8
Dai, Fenglin
517
Dai, Linglong
385, 459, 544
Dai, Xiaoming
19, 385, 459, 544
Dai, Ziyi
568
Dong, Chao
246
Dong, Yuanyuan
385
Duan, Xuting
568, 597, 630
El-Tarhuni, Mohamed
120, 484
Fan, Ningning
1
Fan, Weiqiang
8, 89
Fang, Ji
471
Feng, Wen
609
Feng, Zhiyong
182, 529
Gao, Xiaolin
420
Geng, Suiyan
1
Geng, Yuting
170, 429
Gong, Changqing
338
Gu, Yan
675
Guan, Yujie
317
Guo, Dandan
60
Guo, Junqi
327
Guo, Peng
568, 581, 597, 630
Guo, Shuaishuai
556
Guo, Xi
79
Han, Yu
640
He, Wanbing
206
He, Zhiqiang
246, 257
Hu, Chunjing
288
Hu, Guobing
589
Hu, Xiaoyan
19
Hu, Yi
110
Hu, Zhuhua
146
Huang, Chuan
228
Huang, Sai
529
Huangfu, Wei
19
Hui, Rong
581
Huo, Yuehua
8, 89
Jiang, Guixiang
28
Jin, Shisheng
79
Kang, Lu
630
Khan, Mohsin
403
Kuang, Linling
300, 493
Lei, Weimin
429
Li, Baogang
60, 347
Li, Chenming
675
Li, Dong
89
Li, Haipeng
28
Li, Hongjia
609
Li, Jun
650, 663
Li, Ke
359
Li, Liang
160
Li, Shaoqian
228
Li, Wei
110
Li, Xiaotong
622

Li, Xujie
675
Li, Yong
265, 288
Li, Yuzhou
581
Li, Zhengquan
413
Liang, Hengjing
228
Liang, Xiaoyu
276
Lin, Na
338
Lin, Xincong
300
Liu, Jun
170, 429
Liu, Mengyuan
517
Liu, Miao
650
Liu, Shoudong
317
Liu, Tingting
650, 663
Liu, Tong
194, 276
Liu, Wenhao
597
Liu, Yinlong
8, 89
Liu, Yun
395
Lu, Jianhua
420
Lu, Xin
359
Lu, Zhaoming
132
Luo, Ronghua
589
Lv, Shaobo
276, 506
Lv, Yabo
60
Ma, Lu
132
Ma, Xinli
459, 544
Meng, Chao
589
Meng, Xiangbo
170, 429
Meng, Xuehan
194
Ni, Xinxin
413
Ni, Zuyao
493
Nie, Changsen
220
Niemi, Valtteri
403
Niu, Kai
246
Peng, Mugen
265
Peng, Xiao
471
Peng, Yi
359
Qu, Zhaoyan
160
Ren, Yong
238
Rong, Hui
568, 597, 630
Salem, Salem
120
Shan, Ke
327
Shang, Yajun
194
Shao, Guanglu
99
Shen, Lianfeng
413
Shen, Xu
182
Shi, Guowei
663
Shi, Hua
589
Shi, Wei
395
Shu, Feng
663
Song, Xiaoshi
170, 429
Su, Fei
359
Sun, Baosheng
300
Sun, Ruoxi
238
Sun, Yanyu
8, 89
Sun, Yaoyao
413
Sun, Ying
675
Sun, Yuhang
517
Tang, Ding
609
Tian, Baoyu
257
Tian, Daxin
568, 581, 597, 630
Tian, Lei
640
Wang, Biao
79
Wang, Congyu
581
Wang, Jianli
622
Wang, Jingjing
395
Wang, Liming
609
Wang, Luhan
132
Wang, Ruiqing
338
Wang, Wei
317
Wang, Wenbo
288
Wang, Wenyang
568, 581, 597, 630
Wang, Xianxian
276, 506
Wang, Xiaobo
471
Wang, Xiyuan
385, 459, 544
Wang, Yirong
160
Wang, Yongfeng
69
Wang, Yunpeng
581
Wang, Zhenya
359
Wang, Zhuolin
371
Wei, Zhiqing
182
Wen, Xiangming
132
Wen, Xiaojie
228
Wu, Dan
206
Wu, Juan
459, 544
Wu, Sheng
300, 493
Wu, Yang
359
Xi, Jie
445
Xie, Zheng
529
Xing, Yikang
19
Xiong, Wei
79
696
Author Index

Xu, Cheng
685
Xu, Lexi
69, 99
Xu, Lingwei
395
Xu, Ruichen
471
Xu, Ruijie
445
Xu, Zhen
609
Xue, Fengchang
317
Yan, Jian
420
Yan, Xijun
675
Yang, Jie
395
Yang, Shan
359
Yang, Xiuqing
110
Yao, Yuanbin
60
Yao, Zhichao
246
Ye, Haina
69
Ye, Ning
170, 429
You, Wenwan
327
Yu, Bangchao
132
Yu, Yawei
640
Yuan, Bo
471
Yuan, Mingqiang
69
Zeng, Guangping
52, 371
Zhang, Chi
413
Zhang, Haijun
385, 568, 581, 597, 630, 663
Zhang, Haixia
556
Zhang, Hao
160, 347
Zhang, Jian
493
Zhang, Jianhua
445, 640
Zhang, Jinglu
38
Zhang, Kai
238
Zhang, Peng
556
Zhang, Qingchuan
52, 371
Zhang, Qixun
517
Zhang, Rui
1
Zhang, Senjie
257
Zhang, Siyuan
160
Zhang, Tao
69, 99
Zhang, Wei
206
Zhang, Xiaohong
265, 622
Zhang, Xinzhuang
640
Zhang, Yifan
529
Zhang, Yiran
146
Zhang, Yu
8, 160, 640
Zhang, Zhenyu
385, 459, 544
Zhang, Zhongshan
194, 276, 385, 459, 506,
544
Zhao, Liang
338
Zhao, Wei
60, 347
Zhao, Xiongwen
1, 160
Zhao, Yaochi
146
Zhao, Zhiyong
622
Zheng, Kunxian
568, 630
Zheng, Wei
132
Zhong, Guiting
420
Zhou, Jianshan
568
Zhu, Gongsheng
38
Zhu, Qinghua
38, 110
Zong, Baiqing
622
Author Index
697

