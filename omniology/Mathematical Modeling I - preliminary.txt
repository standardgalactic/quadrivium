Hao Wang
Mathematical Modeling I -
preliminary
Download free books at

2 
 
Hao Wang
Mathematical Modeling I – preliminary
Download free eBooks at bookboon.com

3 
 
Mathematical Modeling I – preliminary
© 2012 Hao Wang & bookboon.com
ISBN 978-87-403-0248-6
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
4 
Contents
Contents
	
Preface	
6
1	
Introduction	
7
2	
Discrete-time models	
9
2.1	
Motivation	
9
2.2	
An example – bacterial reproduction	
9
2.3	
Solution and equilibrium of a discrete model	
12
2.4	
Cobwebbing	
14
2.5	
General theory and analytical methods	
17
2.6	
Optimization of discrete models	
23
3	
Continuous-time models	
25
3.1	
Motivation and derivation of continuous models	
25
3.2	
Differential equation models	
29
3.4	
Separation of variables	
33
3.5	
Linear equations	
35
3.6	
Optimization of continuous models	
41
4	
Sensitivity analysis	
45
Download free eBooks at bookboon.com
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

Mathematical Modeling I – preliminary
5 
Contents
5	
Systems of difference equations (discrete)	
51
5.1	
Analytical methods	
51
5.2	
Some examples	
53
6	
Systems of differential equations (continuous)	
58
6.1	
Some motivation examples	
58
6.2	
Nondimensionalization	
60
6.3	
Analytical methods	
62
6.4	
Higher dimensional systems	
73
7	
Bifurcation analysis	
75
7.1	
Saddle-node bifurcation	
75
7.2	
Transcritical bifurcation	
76
7.3	
Pitchfork bifurcation	
78
7.4	
Generic saddle-node bifurcation	
81
7.5	
Saddle-node, transcritical, and pitchfork bifurcations in two-dimensional systems	
83
7.6	
Introduction of Hopf bifurcations	
85
7.7	
Normal form of Hopf bifurcation	
88
7.8	
Generic Hopf bifurcation	
91
8	
Matlab programming	
94
9	
Data fitting	
103
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

Mathematical Modeling I – preliminary
6 
Preface
Preface
Mathematical Modeling I – preliminary is designed for undergraduate students. Two other followup 
books, Mathematical Modeling II – advanced and Mathematical Modeling III – case studies in biology, 
will be published. II and III will be designed for both graduate students and undergraduate students. 
All the three books are independent and useful for study and application of mathematical modeling in 
any discipline.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
7 
Introduction
1	 Introduction
Mathematical models are of broad use in physics, life sciences, engineering, economics, management, 
social sciences, and many other disciplines. However, all mathematical models are “wrong”, but some 
are useful to help us better understand real-world systems. Models should be made for specific goals 
with clear assumptions since they are only “valid” under certain conditions.
Figure 1:  A flow chart of the modeling process
Modeling Process:
Step 1. Identify the problem with specific goals and questions 
Step 2. Post assumptions unambiguously 
Step 3. Define variables and construct the model 
Step 4. Analyze and simulate the model 
Step 5. Validate the model with real phenomena or empirical data 
Step 6. Apply the model to make predictions 
Step 7. Possibly calibrate and extend the model 
We can always improve the model with more details, but meanwhile we want to keep the model as simple 
as possible such that we can obtain useful and in-depth results.
There have been many famous yet simple mathematical models in literature, such as the following ones: 
• Newton’s law F = ma, where F  is force, m  is mass, a is acceleration. 
• Ohm’s law V = IR, where V  is voltage, I is current, R is resistance. 
• Kepler’s third law T = cR3/2, where T  is the orbital period of the planet, R is the mean 
distance from the planet to the sun. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
8 
Introduction
• Einstein’s relativity theory E = Mc2, where E is energy, M is mass, c  is light speed. 
• Metabolic theory of ecology B = B0M3/4, where B is organism metabolic rate, B0 is a 
mass-independent normalization constant, M is organism mass. 
• Logistic population model dN
dt = rN

1 −N
K

, where N is population size, r is the maximum 
per capita growth rate, K is carrying capacity. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
9 
Discrete-time models
2	 Discrete-time models
2.1	
Motivation
Discrete-time models are constructed to describe phenomenon in terms of fixed time steps. In general, 
we consider a sequence of quantities, x0, x1, x2, ..., where xi denotes the quantity after i time steps. If 
xn+1 depends only on xn, a discrete-time (in abbreviation, discrete) model is expressed by 
xn+1 = f(xn),
n = 0, 1, 2, ...
with some initial condition x0. This discrete model is called a difference equation.
This discrete model gives 
x1
=
f(x0)
x2
=
f(x1) = f(f(x0)) = f [2](x0)
x3
=
f(x2) = f(f(x1)) = f(f(f(x0))) = f [3](x0)
...
The resulting sequence x0, x1, x2, x3, ... is called an orbit of the map f.
xn in the discrete model can represent the population size of lemmings in month n, or the number of 
bacterial cells in a culture on day n, or the concentration of oxygen in the lung after the nth breath.
The difficulty is how choose the map f: 
• Start with a knowledgable guess and necessary assumptions. 
• Make adjustments to get a better model by comparing behavior of the current model to 
reality. 
• A good model should be in close agreement with the real-world data. 
2.2	
An example – bacterial reproduction
Bacterial cells divide into more cells after one sampling time. The number of bacterial cells in the next 
measurement will be some multiple of the current number. We assume that this multiple is a constant 
over several sample times. Note that this assumption is obviously invalid for many sampling times due 
to resource and space limitations.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
10 
Discrete-time models
Denote Bn as the cell number observed at the nth sampling time, then the model can be written as 
Bn+1 = rBn
(Malthus model, 1798)
where the constant r is called the growth rate.
Solution: Given the initial cell number B0, 
B1
=
rB0
B2
=
rB1 = r2B0
B3
=
rB2 = r3B0
...
Bn
=
rnB0
which is the solution of this discrete model.
In reality, the growth rate r usually depends on the cell number because of competition for resource 
and space. r = r(Bn) is a decreasing function of Bn. The more general model than Malthus model is 
of the form 
Bn+1 = r(Bn)Bn.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

Mathematical Modeling I – preliminary
11 
Discrete-time models
For instance, Verhulst model assumes 
r(Bn) =
2
1 + Bn
K
and thus the model becomes 
Bn+1 =
2Bn
1 + Bn
K
.
The function r(Bn) is a decreasing function of Bn with the maximum 2 occurring at Bn = 0. When 
Bn = K, r(Bn) = 1, one-half of its maximum.
Solution: Direct iteration does not work. However, if we introduce a new variable Rn = 1/Bn, then the 
sequence R0, R1, R2, ... satisfies the linear relationship 
Rn+1 = Rn
2 + 1
2K .
Hence, 
Rn
=
Rn−1
2
+ 1
2K
=
1
2
Rn−2
2
+ 1
2K

+ 1
2K
=
Rn−2
22
+ 1
2K

1 + 1
2

=
1
22
Rn−3
2
+ 1
2K

+ 1
2K

1 + 1
2

=
Rn−3
23
+ 1
2K

1 + 1
2 + 1
22

...
=
R0
2n + 1
2K

1 + 1
2 + · · · +
1
2n−1




a
geometric
series
=
R0
2n + 1
2K · 1 · (1 −( 1
2)n)
1 −1
2
=
R0
2n + 1 −( 1
2)n
K
.
Equivalently, 
Bn =
1
1
2nB0 +
1−( 1
2 )n
K
.
The asymptotic behavior is 
Bn →K,
as
n →∞.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
12 
Discrete-time models
2.3	
Solution and equilibrium of a discrete model
The solution of a linear discrete model xn+1 = rxn  (r is a constant) is xn = rnx0, n = 0, 1, 2, 3, ... , 
since xn = rxn−1 = r2xn−2 = · · · = rn−1x1 = rnx0.
The long-term behavior as n →∞ is given as follows:
If r > 1, xn = rnx0 →∞ as n →∞. 
If r = 1, xn = x0 →x0 as n →∞. 
If −1 < r < 1, xn = rnx0 →0 as n →∞. 
If r = −1, xn = (−1)nx0 =
 x0,
n
even,
−x0,
n
odd, and thus no convergence as n →∞. 
If r < −1, xn = rnx0, thus |xn| = |r|n|x0| →∞ as n →∞, thus no convergence as n →∞. In 
addition, rn is positive when n is even, negative when n is odd. 
Now we start to discuss equilibrium or fixed point.
Definition 1 A number x∗ is called an equilibrium or fixed point of xn+1 = f(xn), if xn = x∗ for all 
n = 1, 2, 3, ... when x0 = x∗. That is, xn = x∗ is a constant solution to the discrete model. 
For the model xn+1 = rxn, an equilibrium satisfies x∗= rx∗. If r ̸= 1, x∗= 0 is the only equilibrium. 
If r = 1, every number is an equilibrium.
Now let’s look at a slightly more complicated discrete model 
xn+1 = rxn + b,
where r and b are constants. An equilibrium x∗ satisfies x∗= rx∗+ b. If r ̸= 1, x∗=
b
1 −r  . If 
r = 1, x∗= x∗+ b ⇒ b = 0, then there are two subcases: every number is an equilibrium if b = 0 ; 
no equilibrium exists if b ̸= 0.
As a summary, results for equilibria are listed below: 
• 
 x∗=
b
1 −r is the only equilibrium if r ̸= 1. 
• Every number is an equilibrium if r = 1 and b = 0. 
• no equilibrium exists if r = 1 and b ̸= 0. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
13 
Discrete-time models
Solution of the model xn+1 = rxn + b : 
xn
=
rxn−1 + b
=
r(rxn−2 + b) + b
=
r2xn−2 + b(1 + r)
=
r2(rxn−3 + b) + b(1 + r)
=
r3xn−3 + b(1 + r + r2)
...
=
rnx0 + b(1 + r + r2 + · · · + rn−1)
=
rnx0 + b · 1 · (1 −rn)
1 −r
(if
r ̸= 1)
=
rnx0 +
b
1 −r −
b
1 −rrn
=
rn

x0 −
b
1 −r

+
b
1 −r.
If r = 1, xn+1 = xn + b, then xn = xn−1 + b = xn−2 + 2b = · · · = x0 + nb.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

Mathematical Modeling I – preliminary
14 
Discrete-time models
As a summary, the solution is 
xn
=
rn

x0 −
b
1 −r

+
b
1 −r
if
r ̸= 1;
xn
=
x0 + nb
if
r = 1.
Now let’s discuss the long-term behavior for the case b ̸= 0, since b = 0 reduces the model to 
xn+1 = rxn  which has been discussed before.
Then if r ̸= 1, xn = rn 
x0 +
b
1−r

+
b
1−r. There are two cases: 
• When |r| < 1, xn →
b
1−r (the only equilibrium) as n →∞. We call the equilibrium 
x∗=
b
1−r  stable. 
• When |r| > 1, xn is not convergent as n →∞. We call the equilibrium x∗=
b
1−r  
unstable. 
If r = 1, xn = x0 + nb →

∞
if
b > 0
−∞
if
b < 0 as n →∞. We have known that no equilibrium 
exists in this case (r = 1, b ̸= 0).
2.4	
Cobwebbing
Revisit the nonlinear bacterial reproduction model 
Bn+1 =
2Bn
1 + Bn
K
≜F(Bn).
Equilibria B∗ satisfy B∗=
2B∗
1 + B∗
K
 ⇒ B∗= 0 or B∗= K. In the first panel of Figure 2, we plot the curve 
F(Bn) and the diagonal line, whose intersections are equilibria. The red curves represent two sample 
solutions. For the left one, we start from B0 = 0.2, then plot a vertical line and find its intersection with 
the curve F(Bn). The y  value of the intersection is B1 . Plot a horizontal line from the intersection 
(B0, B1) and then find the intersection (B1, B1) with the diagonal line. From this intersection, we 
plot a vertical line and find the intersection (B1, B2) with the curve F(Bn). Repeat this process, we 
can find the orbit {B0, B1, B2, ...}. Graphically we can see that this orbit is increasing and tends to 
the equilibrium B∗= K . For the right solution, we start from B0 = 1.8 and use the same graphic 
approach to see that the orbit is decreasing but also tends to the equilibrium B∗= K. This graphical 
method is called cobwebbing.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
15 
Discrete-time models
The second panel of Figure 2 exhibits the above two solutions in cobwebbing analysis. Both solutions 
tend to the equilibrium B∗= K (in this simulation K = 1). Actually all solutions with B0 > 0 tend 
to K. Hence, the equilibrium B∗= K is called stable, while the trivial equilibrium B∗= 0 is called 
unstable. We will discuss the stability theorem in the next section.
In reality there should be a threshold size below which bacteria go extinct due to predation. Hence, a 
more complicated nonlinear bacterial reproduction model is given as 
Bn+1 =
rB2
n
1 + ( Bn
K )2 ≜F(Bn).
Equilibria B∗ satisfy B∗=
rB∗2
1 + ( B∗
K )2  ⇒ B∗= 0 or 1 =
rB∗
1 + ( B∗
K )2. 
The second case leads to a quadratic equation B∗2 −rK2B∗+ K2 = 0 whose roots are 
B∗= K

rK
2 ±

( rK
2 )2 −1

 . There are three cases: 
If rK > 2, there are three equilibria B∗= 0, B∗= K

rK
2 −

( rK
2 )2 −1

, 	
	
	
	
	 	
B∗= K

rK
2 +

( rK
2 )2 −1

 . 
If rK = 2, there are two equilibria B∗= 0, B∗= K . 
0
0.5
1
1.5
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Cobwebbing for Bn+1=2Bn/(1+Bn/K)
Stable
Unstable 
Bn 
F(Bn) 
Bn+1 
0
5
10
15
20
25
30
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
n
Bn
Two sample solutions from cobwebbing
Figure 2: Cobwebbing analysis for the model  
If rK < 2, there is only one equilibrium B∗= 0. 
See the first two panels of Figure 3 for the case rK > 2, the third panel for the case rK = 2, and the 
fourth panel for the case rK < 2.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
16 
Discrete-time models
0
0.5
1
1.5
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Cobwebbing for Bn+1=rBn
2/(1+(Bn/K)2)
Bn+1 
Unstable 
F(Bn) 
Stable
Bn 
Stable
rK>2 
0
5
10
15
20
25
30
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Bn
n
Three sample solutions from cobwebbing (rK>2)
0
0.5
1
1.5
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Semi−stable
Bn+1 
Bn 
Cobwebbing for Bn+1=rBn
2/(1+(Bn/K)2)
rK=2 
Stable
0
0.5
1
1.5
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
Cobwebbing for Bn+1=rBn
2/(1+(Bn/K)2)
Bn+1 
rK<2 
Bn 
Stable
Figure 3: Cobwebbing analysis for the model Bn+1 =
rB2
n
1+(Bn/K)2
For the case rK > 2, we can observe from the cobwebbing that solutions with 
B0 > K

rK
2 −

( rK
2 )2 −1

 tend to K

rK
2 +

( rK
2 )2 −1

, while solutions with 
B0 < K

rK
2 −

( rK
2 )2 −1

 tend to 0 (extinction).  The equilibria B∗= 0 and 
B∗= K

rK
2 +

( rK
2 )2 −1

 are stable, while the equilibrium B∗= K

rK
2 −

( rK
2 )2 −1

 
is unstable. The interval (0, K

rK
2 −

( rK
2 )2 −1

) is a pit of extinction. The extinction scenario, 
generated by the stable trivial equilibrium is the main difference between the model with predation 
and the model without predation.
For the case rK = 2, solutions with B0 ≥K  tend to K, while solutions with 0 ≤B0 < K tend to 0. 
The equilibrium B∗= K  is semi-stable (stable from right, unstable from left), while the equilibrium B∗= 0 
is stable.
For the case rK < 2, all solutions tend to 0. The only equilibrium B∗= 0 is stable.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
17 
Discrete-time models
2.5	
General theory and analytical methods
In this section, we discuss the linear stability analysis for a discrete-time model xn+1 = f(xn).
Let x∗ be an equilibrium of the model xn+1 = f(xn), that is, x∗= f(x∗). Consider a perturbation 
of x∗: xn = x∗+ yn with tiny yn . Substitute it into the model to obtain x∗+ yn+1 = f(x∗+ yn). 
Apply Taylor’s series to obtain x∗+ yn+1 = f(x∗) + f ′(x∗)yn + higher order terms, which leads 
to yn+1 = f ′(x∗)yn + higher order terms. For tiny yn , higher order terms are negligible compared 
the first order term f ′(x∗)yn : yn+1 ≈f ′(x∗)yn . We call yn+1 = f ′(x∗)yn  the linearized equation, 
where f ′(x∗) is a constant. Given the initial condition y0, the solution is 
yn = (f ′(x∗))ny0.
There are four cases for the deviation yn : 
• f ′(x∗) > 1: the deviation has geometric growth, thus the equilibrium x∗ is unstable. 
• 0 < f ′(x∗) < 1, the deviation has geometric decay, thus the equilibrium x∗ is stable. 
• −1 < f ′(x∗) < 0: the deviation has geometric decay with sign switch, thus the 
equilibrium x∗ is stable. 
• f ′(x∗) < −1, the deviation has geometric growth with sign switch, thus the equilibrium 
x∗ is unstable. 
As a summary of all the above cases, we arrive at the following theorem: 
Theorem 1 (Stability Criterion) Let x∗ be an equilibrium of xn+1 = f(xn), then we have the results: 
If |f ′(x∗)| < 1, x∗ is stable. 
If |f ′(x∗)| > 1, x∗ is unstable. 
If |f ′(x∗)| = 1, there is no conclusion about the stability of x∗. Higher order terms need to be examined 
to determine stability. 
The constant f ′(x∗) is called the eigenvalue of the map f  at x∗. 
Let’s look at a few examples to apply this theorem.
Example 1 Consider the discrete logistic equation yn+1 = ryn(1 −yn/K), where the parameters r ≥0 , 
K > 0. Find all equilibria and determine their stability. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
18 
Discrete-time models
Solution: Let xn = yn/K , then xn+1 = rxn(1 −xn). Note that xn ≥0 represents population size, 
and r ≥0 is the maximum growth rate. Equilibria satisfy 
x∗= rx∗(1 −x∗)
which leads to x∗= 0 or x∗= r−1
r . The nontrivial equilibrium x∗= r −1
r
> 0 if and only if r > 1.
To check stability, we compute the eigenvalue: 
f ′(x∗) = r(1 −2x∗).
For the trivial equilibrium x∗= 0, the eigenvalue f ′(0) = r , thus x∗= 0 is stable if 0 ≤r < 1 and 
unstable if r > 1.
For the nontrivial equilibrium x∗= r−1
r , the eigenvalue f ′( r−1
r ) = 2 −r , thus x∗= r−1
r  is stable if 
1 < r < 3 (from |2 −r| < 1) and unstable if r > 3 (from |2 −r| > 1 and r > 1).
Example 2 Consider the Beverton-Holt model xn+1 =
rxn
1 + r−1
K xn
 with r > 0 and K > 0. Find all 
equilibria and determine their stability. 
Solution: Equilibria x∗ satisfy 
x∗=
rx∗
1 + r−1
K x∗
which leads to x∗= 0 or x∗= K  (if r ̸= 1). Note that for r = 1 the model becomes xn+1 = xn, 
which is not interesting.
To check stability, we compute the eigenvalue 
f ′(x∗) =
r
(1 + r−1
K x∗)2.
For the trivial equilibrium x∗= 0, the eigenvalue f ′(0) = r , thus x∗= 0 is stable if 0 < r < 1 and 
unstable if r > 1.
For the nontrivial equilibrium x∗= K , the eigenvalue f ′(K) = 1
r , thus x∗= K  is stable if r > 1 
and unstable if 0 < r < 1.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
19 
Discrete-time models
Example 3 Revisit the bacterial reproduction models:w
Model I: 
Bn+1 = rBn;
Model II: 
Bn+1 =
2Bn
1 + Bn
K
;
Model III: 
Bn+1 =
rB2
n
1 + ( Bn
K )2.
Solution: For Model I, equilibria B∗ satisfy B∗= rB∗. If r ̸= 1, B∗= 0 is the only 
equilibrium. If r = 1, every nonnegative number is an equilibrium. The eigenvalue is 
f ′(B∗) = r . For the case r ̸= 1, B∗= 0 is stable if 0 < r < 1, unstable if r > 1. 
This result is consistent to cobwebbing analysis. For the case r = 1, |f ′(B∗)| = 1 for all equilibria, 
there is no conclusion about stability from the stability theorem. Actually this case is a trivial case 
Bn+1 = Bn  whose solutions are obvious.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

Mathematical Modeling I – preliminary
20 
Discrete-time models
For Model II, equilibria B∗ satisfy B∗=
2B∗
1+ B∗
K
 which has two roots B∗= 0 or B∗= K . The 
eigenvalue at B∗ is f ′(B∗) =
2
(1 + B∗
K )2 . For the trivial equilibrium B∗= 0, |f ′(0)| = 2 > 1, 
thus B∗= 0 is unstable. for the nontrivial equilibrium B∗= K , |f ′(K)| = 1
2 < 1, thus B∗= k  
is stable. The results are consistent to cobwebbing analysis.
For Model III, equilibria B∗ satisfy B∗=
rB∗2
1 + ( B∗
K )2   whose roots are B∗= 0, 
B∗= K

rK
2 −
rK
2
2
−1

, B∗= K

rK
2 +
rK
2
2
−1

.  
Hence, there are three equilibria if rK > 2. The eigenvalue at B∗ is ′(B∗) =
2rB∗
[1+( B∗
K )2]2.
For B∗= 0, |f ′(0)| = 0 < 1, thus B∗= 0 is stable.
For B∗= K

rK
2 −
rK
2
2
−1

, the eigenvalue 
f ′

K

rK
2 −
rK
2
2
−1




=
2rK

rK
2 −

( rK
2 )2 −1


1 +

rK
2 −

( rK
2 )2 −1
22
=
2rK

rK
2 −

( rK
2 )2 −1


r2K2
2
−rK

( rK
2 )2 −1
2
=
2
rK

rK
2 −

( rK
2 )2 −1

=
2

rK
2 +

( rK
2 )2 −1

rK

rK
2 −

( rK
2 )2 −1
 
rK
2 +

( rK
2 )2 −1

=
rK + 2

( rK
2 )2 −1
rK
= 1 +
2

( rK
2 )2 −1
rK
> 1,
thus B∗= K

rK
2 −
rK
2
2
−1

 is unstable.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
21 
Discrete-time models
We can apply the same idea to obtain 
f ′

K

rK
2 +
rK
2
2
−1



= 1 −
2

( rK
2 )2 −1
rK
.
Since 0 <
2

( rK
2 )2 −1
rK
=

( rK
2 )2 −1
rK
2
=

( rK
2 )2 −1

( rK
2 )2
< 1, then 
0 < f ′

K

rK
2 +
rK
2
2
−1



= 1 −
2

( rK
2 )2 −1
rK
< 1,
thus B∗= K

rK
2 +
rK
2
2 −1

 is stable.
For the case rK < 2, the only equilibrium is B∗= 0 which is stable. The case rK = 2 is the degenerate 
case in which there are two equilibria B∗= 0 (stable) and B∗= K  (semi-stable).
All these results are consistent to cobwebbing analysis.
Example 4 Consider the annuity for retirement with 0.5% as the monthly interest rate and a monthly 
withdrawal of $2000. Develop a discrete-time model to describe the annuity problem. Determine equilibria 
and stability. How much of an initial deposit is needed to deplete the annuity in 30 years?  
Solution: Let xn  be the amount in the account after n  months, then the discrete-time model is provided 
by 
xn+1 = xn(1 + 0.5%) −2000
which can be simplified as 
xn+1 = 1.005xn −2000
with the initial deposit x0.
Equilibria x∗ satisfy x∗= 1.005x∗−2000 which leads to x∗= 400000. The eigenvalue is 
f ′(x∗) = 1.005 > 1, thus the only equilibrium x∗= 400000 is unstable.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
22 
Discrete-time models
Recall that the solution of xn+1 = rxn + b  is 
xn
=
rn

x0 −
b
1 −r

+
b
1 −r
if
r ̸= 1;
xn
=
x0 + nb
if
r = 1.
In this example, r = 1.005 ̸= 1 and b = −2000, thus we use the first formula to obtain 
0 = a360 = 1.005360

x0 −
−2000
1 −1.005

+
−2000
1 −1.005
from which we solve for the initial deposit: x0 = 333580.
As a conclusion, an initial deposit of $333580 allows the withdrawal of $2000 per month from the 
account from 30 years. The total withdrawal is $720000, and at the end of 30 years the account is 
depleted.
For discrete models, we have three ways to judge stability of equilibrium values: 
1.	 Solving the model; 
2.	 Cobwebbing analysis; 
3.	 Stability criterion. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

Mathematical Modeling I – preliminary
23 
Discrete-time models
2.6	
Optimization of discrete models
The basic optimization model is given as 
Optimize (maximize or minimize)
f(X)
subject to 





g1(X)
g2(X)
...
gn(X)








≥
=
≤








b1
b2
...
bn





Here, 
• X  is a vector with a group of decision variables whose values are discrete. 
• f(X) is called the objective function. 
• 
g1(X), g2(X), ..., gn(x) are called constraint functions, and their associated side 
conditions are called constraints. 
Goal: We seek the vector X = X0 to optimize the objective function f(X) and meanwhile to satisfy 
all constraints gi(X)



≥
=
≤


bi , i = 1, 2, ..., n .
Example 5 A carpenter wants to decide how many chairs and how many benches he should make each 
month. One chair contributes to $20 net profit, and one bench contributes to $18 net profit. A chair requires 
10 board-feet of lumber and 5 hours of labor, and a bench requires 20 board-feet of lumber and 4 hours of 
labor. Every month the carpenter has lumber up to 1000 board-feet and labor up to 360 hours. 
Solution: Let x1 and x2 are the number of chairs and the number of benches produced each month, 
respectively. The optimization problem can be described as 
Maximize the total net proﬁt
f(x1, x2) = 20x1 + 18x2
subject to 
10x1 + 20x2
≤
1000
(lumber)
5x1 + 4x2
≤
360
(labor)
x1
≥
0
(nonnegativity)
x2
≥
0
(nonnegativity)
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
24 
Discrete-time models
0
20
40
60
80
100
0
10
20
30
40
50
60
70
80
90
100
x1
x2
(160/3, 70/3) 
Figure 4: The convex set (shaded region) formed by constraints.
If an optimal solution to a linear problem (both the object function and all constraints are linear) exists, 
it must occur among the extreme points of the convex set formed by the set of constraints (see the 
shaded region of Figure 4). A set C  is convex if for any two vectors x, y ∈C , (1 −r)x + ry ∈C  
for all 0 ≤r ≤1.
The shaded region generated by constraints has four extreme points: (0, 0), (72, 0), (0, 50), 
(160/3, 70/3) . We evaluate the objection function at each extreme point: f(0, 0) = 0, f(70, 0) = 1440 , 
f(0, 50) = 900 , f(160/3, 70/3) = 1486.7. Hence, the maximum monthly profit is $1486.7, occurring 
at the internal extreme point (160/3, 70/3), about 53 chairs and 23 benches.
Note: The maximum monthly profit can occur at a boundary extreme point. For instance, if we assume 
that one chair contributes to $20 net profit and one bench contributes to $15 net profit, then the maximum 
monthly profit occurs at (70, 0).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
25 
Continuous-time models
3	 Continuous-time models
3.1	
Motivation and derivation of continuous models
We derive a continuous model from a discrete model for population prediction. Let N(t) be the 
population size at time t. In a small time period ∆t, a percentage b of the population is born, and a 
percentage d  of the population dies. Thus the change of the population size during the time period ∆t is 
N(t + ∆t) −N(t) = bN(t)∆t −dN(t)∆t.
Note that b and d have the unit per time, and they are called growth and death rates. Divide both sides 
by ∆t to obtain 
N(t + ∆t) −N(t)
∆t
= (b −d)N(t).
Let ∆t →0, we have 
dN(t)
dt
= (b −d)N(t)
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
26 
Continuous-time models
using the definition of derivative. Let α = b −d, then the model becomes 
dN
dt = αN.
Give the initial condition N(t0) = N0, the continuous-time model dN
dt = αN  is defined for t ≥t0.
Solution: We apply separation of variables to obtain 
 dN
N =

αdt
which leads to 
ln N = αt + C
for some constant C . We then use the initial condition N(t0) = N0 to obtain ln N0 = αt0 + C , thus 
C = ln N0 −αt0. Substitute it back into the solution, then ln N = αt + ln N0 −αt0, which leads 
to ln(N/N0) = α(t −t0), and thus 
N(t) = N0eα(t−t0),
which is the solution of the continuous model.
We apply this model to the Chinese census data: the 2000 census for the population of China was 
1262600000 and in 1980 it was 981235000. Substitute these values into the solution by letting t0 = 1980 
and N0 = 981235000: 
1262600000 = 981235000eα(2000−1980),
from which we solve for α : α = 0.0126. Hence the model becomes 
N(t) = 981235000e0.0126(t−1980),
which can be used to predict future population. For example, in 2010 the Chinese population size should 
be N(2010) = 981235000e0.0126(2010−1980) = 1432000000, overestimate the realistic number 
1338300000. How about the year 2100?  N(2100) = 981235000e0.0126(2100−1980) = 4450700000, 
obviously unsustainable in China. Clearly the model is oversimplified.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
27 
Continuous-time models
We improve the model with limited growth. The constant α should be a decreasing function of the 
population size N and becomes zero when N reaches the sustainable maximum populations size M. 
The simplest to incorporate the population ceiling is 
α = r(M −N)
which is 
• positive when N < M; 
• zero when N = M; 
• negative when N > M. 
Therefore, the improved model is provided by 
dN
dt = r(M −N)N,
called logistic population growth model.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

Mathematical Modeling I – preliminary
28 
Continuous-time models
Solution: We apply separation of variables to obtain 

dN
(M −N)N =

rdt

1
M

1
M −N + 1
N

dN =

rdt
1
M (−ln |M −N| + ln N) = rt + C
ln N −ln |M −N| = M(rt + C)
Use the initial condition N(t0) = N0 < M ⇒ln N0 −ln(M −N0) = M(rt0 + C), from which 
we solve for C : C = 1
M ln
N0
M −N0
−rt0. Hence, 
ln N −ln |M −N| = M

rt + 1
M ln
N0
M −N0
−rt0

Consider the case N < M  which is usually valid according to the definition of M , then 
ln N(M −N0)
N0(M −N) = rM(t −t0)
N(M −N0) = N0(M −N)erM(t−t0)
N(M −N0) + N0NerM(t−t0) = N0MerM(t−t0)
N(t) =
N0MerM(t−t0)
M −N0 + N0erM(t−t0)
N(t) =
MN0
N0 + (M −N0)e−rM(t−t0)
This is the solution of the improved model with limited growth. We can easily observe that 
N(t) →M
as
t →∞.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
29 
Continuous-time models
M 
N 0 
t0 
N(t) 
t 
logistic curve 
Figure 5: The logistic curve: the solution of the model dN
dt = r(M −N)N  with the initial condition N(t0) = N0.
3.2	
Differential equation models
Consider a general first-order differential equation: 
dx
dt = f(t, x).
Definition 2 The collection of short line segments of slope f(t, x) at selected points (t, x) in tx-plane is 
called a slope field. Solution curves follow these tangents.
If f(t, x) is independent of t, i.e. dx
dt = f(x), then the differential equation is called autonomous. The 
values of x such that dx
dt = 0 are called equilibrium values or steady states or fixed points. A phase line is 
a plot on the x axis that shows all fixed points together with the intervals where we can determine the signs 
of dx
dt  and d2x
dt2 , from which we know the monotonicity and concavity of solution curves.
Given an initial condition x(t0) = x0, the solution curve of the initial value problem (IVP) 
dx
dt = f(t, x), x(t0) = x0 passes through the point (t0, x0) and has slope f(t0, x0) there. 
Let’s look at a simple example to perform the phase line analysis.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
30 
Continuous-time models
Example 6 For the autonomous differential equation dx
dt = x(x −1), determine equilibrium values and 
perform the phase line analysis. 
Equilibrium values are x∗= 0 and x∗= 1, i.e. the equation has two constant solutions x = 0 for all 
t  and x = 1 for all t.
It is easy to determine that
dx
dt = x(x −1) is positive if x < 0 or x > 1; negative if 0 < x < 1.
We can compute d2x
dt2 = d
dt(dx
dt ) = d
dt(x(x −1)) = (2x −1)dx
dt = (2x −1)x(x −1), which is 
positive if x > 1 or 0 < x < 1/2; negative if 1/2 < x < 1 or x < 0. According to these facts, we 
can plot the phase line as in Figure 6.
 
Figure 6: The phase line analysis of dx
dt = x(x −1).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

Mathematical Modeling I – preliminary
31 
Continuous-time models
Without solving the differential equation, we can also sketch representative solution curves using the 
phase line (see Figure 7). It is not difficult to observe that Figures 6&7 are consistent.
The equilibrium x = 0 is stable since solution curves near x = 0 tend toward to x = 0 as t  increases. 
The equilibrium x = 1 is unstable since solution curves near x = 1 (except x = 1 itself) move away 
from x = 1 as t  increases. Note that the phase line is enough to judge stability of equilibrium values. 
Strict definitions of stability can be found in most ordinary differential equation textbooks.
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
1.5
2
t
x
equilibrium 
equilibrium 
Figure 7: Some representative solution curves of dx
dt = x(x −1).
3.3	
Some basic theorems
For the differential equation dx
dt = f(t, x), we have the following basic theorems that can be useful for 
the preliminary analysis of a differential equation model.
Theorem 2 (Existence and Uniqueness) Under some mild conditions (f(t, x) and df
dx(t, x) are continuous 
with respect to t  and x) most differential equation models satisfy, we have the following basic results for 
dx
dt = f(t, x):
• Existence of solutions  Each point in tx-plane has a solution passing through it. 
• Uniqueness of solutions  Only one solution passes through each point (t, x). 
• Continuous dependence  Solution curves through nearby initial points remain close over a 
short time. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
32 
Continuous-time models
Theorem 3 (Stability Criterion) Let x∗ be an equilibrium of an autonomous equation dx
dt = f(x). Then 
• x∗ is stable when f ′(x∗) < 0; 
• 
x∗ is unstable when f ′(x∗) > 0; 
• there is no conclusion about the stability of x∗ when f ′(x∗) = 0. 
Note that f ′(x∗) is called the eigenvalue of x∗.
Example 7 Determine equilibrium values and their stability for the differential equation 
dx
dt = (x + 1)(x −2).
Solution: Equilibrium values are x∗= −1 and x∗= 2.
f(x) = (x + 1)(x −2) = x2 −x −2,
then f ′(x) = 2x −1, thus f ′(x∗) = 2x∗−1.
f ′(−1) = −3 < 0, hence the equilibrium solution x = −1 is stable.
f ′(2) = 3 > 0, hence the equilibrium solution x = 2 is unstable.
Example 8 Revisit the logistic population growth model dN
dt = r(M −N)N  to determine equilibrium 
values and their stability. 
Solution: Equilibrium values are N∗= M  and N∗= 0.
f(N) = r(M −N)N = rMN −rN2,
then f ′(N) = rM −2rN , thus f ′(N∗) = rM −2rN∗.
f ′(M) = −rM < 0, hence the equilibrium solution N = M  is stable.
f ′(0) = rM > 0 , hence the equilibrium solution N = 0 is unstable.
Similar to discrete models, we have three ways to judge stability of equilibrium values of autonomous 
differential equations (a group of continuous models): 
1.	 Solving the model; 
2.	 Phase line analysis; 
3.	 Stability criterion. 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
33 
Continuous-time models
3.4	
Separation of variables
Consider the nonautonomous differential equation 
dx
dt = f(t, x),
which is separable if 
f(t, x) = p(t)q(x).
Note that p(t)  or q(x) may be a constant function. For a separable equation, we can express it as 
dx
dt = p(t)q(x)
⇒

dx
q(x) =

p(t)dt,
from which we can obtain the general solution to the differential equation.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
34 
Continuous-time models
Example 9 Solve the differential equation dx
dt = t2 + (xt)2. 
Solution: This equation is separable because we can rewrite it as 
dx
dt = t2(1 + x2),
then 

dx
1 + x2 =

t2dt,
tan−1(x) = t3/3 + C,
x = tan(t3/3 + C),
where C  is a constant determined by the initial condition.
Example 10 Solve dx
dt =
t
et+x . 
Solution: This equation is separable because it is equivalent to 
dx
dt = t
et
1
ex.
Thus, 

exdx =

t
etdt
⇒ex =

te−tdt = integration by parts = −(te−t −

e−tdt)+C = −(te−t +e−t)+C =
−(t + 1)e−t + C. Hence, the general solution is x(t) = ln[−(t + 1)e−t + C], where the
constant C depends on the initial condition.
For instance, given the initial condition x(0) = 0, then 
x(0) = ln[−1 + C] = 0,
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
35 
Continuous-time models
which leads to C = 2. Then the solution of the IVP 



dx
dt =
t
et+x,
(0) = 0,
is x(t) = ln[−(t + 1)e−t + 2].
Example 11 Solve the IVP 



dx
dt = ex
t2x,
(1) = 0.
 
Solution: We apply separation of variables to obtain 

xe−xdx =

t−2dt,
−(xe−x −

e−xdx) = −t−1 + C,
−(xe−x + e−x) = −t−1 + C,
−(x + 1)e−x = −t−1 + C.
Then use the initial condition x(1) = 0 to obtain −(0 + 1)e−0 = −1−1 + C , which gives  
C = 0. Hence, the solution to IVP is 
−(x + 1)e−x = −1
t −1
2,
which provides an implicit formula for x(t) . There is no explicit formula for x(t) since the resulting 
algebraic equation is a transcendental equation.
3.5	
Linear equations
Let’s start with a lake pollution problem, which is a common and extremely severe issue in many lakes 
around the world. We let V (t) be the lake volume at time t , and p(t) be the amount of pollutant in 
the lake at time t. Then the concentration of pollutant is the ratio 
c(t) = p(t)
V (t).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
36 
Continuous-time models
Over the time interval [t, t + △t], the change in the amount of pollutant △p is the amount of pollutant 
that enters the lake minus the amount that leaves: 
△p = amount input −amount output.
If water enters the lake with a constant concentration cin  at a rate rin , then 
amount input = rincin△t.
If water leaves the lake at a constant rate rout , since the concentration of pollutant in lake is p(t)
V (t)
, then 
amount output = rout
p(t)
V (t)△t.
Thus, 
△p = rincin△t −rout
p(t)
V (t)△t,
△p
△t = rincin −rout
p(t)
V (t).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

Mathematical Modeling I – preliminary
37 
Continuous-time models
Let △t →0, we have 
dp
dt = rincin −rout
V p.
Suppose V (0) = V0 is the volume of the lake initially, then V (t) = V0 + (rin −rout)t , then the 
model becomes 
dp
dt = rincin −
rout
V0 + (rin −rout)tp.
We can rewrite this differential equation as 
dp
dt +
rout
V0 + (rin −rout)tp = rincin,
dp
dt + g(t)p = rincin,
where (t) =
rout
V0+(rin−rout)t , is the lake pollution model.
This is an example of a linear first-order differential equation. Can we solve this equation to find the 
amount p(t) of pollutant in the lake at time t ?  The answer is positive. We will discuss the general 
method and then come back to the lake pollution example.
In general, the first-order linear equation is of the form 
a1(t)x′ + a0(t)x = b(t),
x′ + a0(t)
a1(t)x = b(t)
a1(t),
x′ + P(t)x = Q(t),
which is the standard form of the linear equation. The method is to multiply both sides by an integrating 
factor 
µ(t) = e
 P (t)dt.
(Note that we introduce no arbitrary constant of 
P(t)dt  since only one function is needed for  
µ(t).) Then the equation becomes 
µ(t)x′ + P(t)µ(t)x = µ(t)Q(t).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
38 
Continuous-time models
Because µ′(t) = p(t)µ(t), then the equation becomes 
(µ(t)x(t))′ = µ(t)Q(t),
µ(t)x(t) =

µ(t)Q(t)dt + C,
then we obtain the general solution x(t) =
C
µ(t) +
1
µ(t)

µ(t)Q(t)dt = Ce−

P(t)dt +  
e−

P(t)dt

e

P(t)dtQ(t)dt



.
t in the first factor is different from t in the second factor
Example 12 (Lake pollution problem) Return to the lake pollution example: 
dp
dt + g(t)p = rincin,
where g(t) =
rout
V0 + (rin −rout)t .
Let α = rincin , then dp
dt + g(t)p = α . 
Solution: Multiple both sides by an integrating factor 
µ(t) = e
 g(t)dt = e

rout
V0+(rin−rout)t dt = e
rout
rin−rout ln |V0+(rin−rout)t|,
then 
d
dt(µ(t)p(t)) = αµ(t),
µ(t)p(t) =

αµ(t)dt + C,
p(t) =
C
µ(t) +
α
µ(t)

µ(t)dt,
where µ(t) = e
rout
rin−rout ln |V0+(rin−rout)t|  and C  is a constant determined by the initial condition. Note 
that µ(t) in the second term cannot be canceled out.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
39 
Continuous-time models
If we assume that V0 + (rin −rout)t > 0 for all t  in the studied interval [0, T], then 
µ(t) = e
rout
rin−rout ln(V0+(rin−rout)t) = eln(V0+(rin−rout)t)
rout
rin−rout = (V0+(rin−rout)t)
rout
rin−rout .
Then µ(t)dt =

(V0 + (rin −rout)t)
rout
rin−rout dt =
1
rin −rout
1
rout
rin−rout + 1(V0 + (rin −
rout)t)
rout
rin−rout +1 =
1
rin −rout
rin −rout
rin
(V0 + (rin −rout)t)
rin
rin−rout =
1
rin
(V0 + (rin −
rin
rout)t)
rin
rin−rout .No arbitrary constant is needed in the above calculation since C  is already 
incorporated in the expression of p(t).
Therefore, the solution is
,
p(t) = C(V0+(rin−rout)t)
rout
rout−rin +α(V0+(rin−rout)t)
rout
rout−rin
1
rin(V0+(rin−rout)t)
rin
rin−rout =
C(V0 + (rin −rout)t)
rout
rout−rin +
α
rin(V0 + (rin −rout)t).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.mastersopenday.nl
Visit us and find out why we are the best!
Master’s Open Day: 22 February 2014
Join the best at
the Maastricht University
School of Business and
Economics!
Top master’s programmes
• 33rd place Financial Times worldwide ranking: MSc 
International Business
• 1st place: MSc International Business
• 1st place: MSc Financial Economics
• 2nd place: MSc Management of Learning
• 2nd place: MSc Economics
• 2nd place: MSc Econometrics and Operations Research
• 2nd place: MSc Global Supply Chain Management and 
Change
Sources: Keuzegids Master ranking 2013; Elsevier ‘Beste Studies’ ranking 2012; 
Financial Times Global Masters in Management ranking 2012
Maastricht
University is
the best specialist
university in the
Netherlands
(Elsevier)

Mathematical Modeling I – preliminary
40 
Continuous-time models
Example 13 Find the general solution of the linear equation 
tx′ + x = cos(t),
t > 0.
Solution: Rewrite the linear equation in the standard form 
x′ + 1
t x = cos(t)
t
,
thus P(t) = 1
t , Q(t) = cos(t)
t
. An integrating factor satisfies 
µ(t) = e
 P (t)dt = e
 1
t dt = eln t = t.
Multiply both sides of the linear equation by µ(t) to obtain 
tx′ + x = cos(t),
(tx)′ = cos(t),
tx =

cos(t)dt + C,
tx = sin(t) + C,
x = sin(t)
t
+ C
t ,
t > 0.
Hence, the general solution is (t) = sin(t)
t
+ C
t  for t > 0.
Example 14 Solve the IVP 
 x′ + x = et,
t ≥0
x(0) = 1.
Solution: An integrating factor is µ(t) = e

1dt = et . Multiply both sides of the linear equation by et  
to obtain 
etx′ + etx = e2t,
(etx)′ = e2t,
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
41 
Continuous-time models
etx =

e2tdt + C,
etx = 1
2e2t + C,
x = 1
2et + Ce−t.
The general solution is x(t) = 1
2et + Ce−t . The initial condition x(0) = 1 implies that 1
2 + C = 1, 
thus C = 1
2
. Therefore, the solution to IVP is 
x(t) = 1
2et + 1
2e−t = et + e−t
2
= cosh(t)
(a hyperbolic cosine function).
3.6	
Optimization of continuous models
We study the optimization problem: 
Optimizef(X)
subject to constraints 
gi(X)
 ≥
≤

bi
for all
i ∈I,
where the objective function f  is continuous but nonlinear. We discuss a representative example to 
show how to construct and solve an optimization problem.
Example 15  A PC company plans to introduce two new products: 21-inch all-in-one computer and 27-
inch all-in-one computer. The cost of a 21-inch all-in-one computer is $500, the cont of a 27-inch all-in-one 
computer is $600, and the fixed cost is $100,000. The suggested retail price of a 21-inch all-in-one computer 
is $900, and the suggested retail price of a 27-inch all-in-one computer is $1050. In the competitive market, 
for each additional computer of a particular type sold, the selling price falls by $0.10. Furthermore, the 
selling price for each 21-inch computer is reduced by $0.03 for each 27-inch computer sold, and the selling 
price for each 27-inch computer is reduce by $0.04 for each 21-inch computer sold. If we assume that all 
computers made by this company can be sold at the above prices, how many computers of each type should 
the company manufacture to maximize its profit?  
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
42 
Continuous-time models
Solution: We define the variables for the two types of computers ( i = 1, 2):
x1  — number of 21-inch all-in-one computers
x2 — number of 27-inch all-in-one computers
Pi  — selling price of xi
R  — revenue obtained from computer sales
C  — cost to produce the computers
P  — net profit from the sales of the computers
We have two independent variables x1 and x2, all other variables defined above can be expressed as 
functions of x1 and x2: 
P1 = 900 −0.1x1 −0.03x2
P2 = 1050 −0.04x1 −0.1x2
R = P1x1 + P2x2
C = 100000 + 500x1 + 600x2
P = R −C
and 
x1 ≥0,
x2 ≥0.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
43 
Continuous-time models
Optimization problem:
To maximize the profit function 
P(x1, x2)
=
R −C
=
(P1x1 + P2x2) −(100000 + 500x1 + 600x2)
=
(900 −0.1x1 −0.03x2)x1 + (1050 −0.04x1 −0.1x2)x2
−(100000 + 500x1 + 600x2)
=
400x1 −0.1x2
1 + 450x2 −0.1x2
2 −0.07x1x2 −100000
The necessary conditions of obtaining the maximum net profit are 
∂P
∂x1
= 0
and
∂P
∂x2
= 0,
that is, 
∂P
∂x1
=
400 −0.2x1 −0.07x2
= 0
∂P
∂x2
=
450 −0.2x2 −0.07x1
= 0
⇒
x1 ≈1382,
x2 ≈1766.
At x1 = 1382, x2 = 1766, the total net profit is 
P(1382, 1766) = $573790.
This should be the maximum profit or the minimum profit. We have three ways to judge whether it is 
the maximum profit:
1)	 Compute P(x1, x2) at some positive integers ¯x1 and ¯x2 (we can choose(¯x1, ¯x2) 
near (1382, 1766)), and compare with P(1382, 1766). It is easy to see that 
(¯x1, ¯x2) < P(1382, 1766), thus P(1382, 1766) is the maximum profit.
2)	 Use the second-derivative test from multivariable calculus: 
∂2P
∂x2
1
(1382, 1766) = −0.2 < 0
and

∂2P
∂x2
1
∂2P
∂x2
2
−
 ∂2P
∂x1∂x2
2
(1382, 1766) = 0.0351 > 0.
These two inequalities imply that P(1382, 1766) is the maximum profit.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
44 
Continuous-time models
3)	 Sketch P(x1, x2) for x1 ≥0, x2 ≥0, which can show that the profit P(x1, x2) at 
(1382, 1766) is indeed the maximum profit.
Another important type of optimization problems is listed as follows:
maximize or minimize f(x) subject to g(x) = c . Here x ∈Rn .
To find the local maxima and minima of the function f(x) subject to equality constraints g(x) = c
, we introduce a new variable λ  called a Lagrange multiplier and study the Lagrange function defined 
by L(x, λ) = f(x) + λ[g(x) −c], where the λ  term may be either added or subtracted. If f(x) is 
a maximum or minimum, then there exists λ such that (x, λ) is a stationary point for the Lagrange 
function. Note that the method of Lagrange multipliers provides a necessary condition for optimality, 
that is, not all stationary points of the Lagrange function yield a solution of the optimization problem.
Example 16 Maximize f(x1, x2) = x1 + x2 subject to the constraint x2
1 + x2
2 = 1. 
Solution: We apply the method of Lagrange multipliers to obtain the Lagrange function 
L(x1, x2, λ) = f(x1, x2) + λ(g(x1, x2) −c) = x1 + x2 + λ(x2
1 + x2
2 −1).
Stationary points satisfy 
∂L
∂x1
= 1 + 2λx1
=
0
∂L
∂x2
= 1 + 2λx2
=
0
∂L
∂λ = x2
1 + x2
2 −1
=
0
⇒λ = ±
√
2/2 which lead to two stationary points (−
√
2/2, −
√
2/2) and (
√
2/2,
√
2/2).
We evaluate the objective function f(x1, x2) at these stationary points: 
f(−
√
2/2, −
√
2/2) = −
√
2
and 
f(
√
2/2,
√
2/2) =
√
2.
Hence, similar to the example 15, we can judge that the maximum is 
√
2, occurring at (
√
2/2,
√
2/2).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
45 
Sensitivity analysis
4	 Sensitivity analysis
Sensitivity analysis is to study how the variation in the output of a mathematical model depends on 
different sources of variation in the input of a mathematical model.
One common type of sensitivity analysis is to determine how a focused quantity (depending on variables) 
is related to perturbation of each parameter.
Sensitivity analysis is of important use in many ways. For instance, we perform sensitivity analysis to test 
robustness of model predictions, or to understand (relative) importance of parameters to the focused 
quantity and check their relationships (positively or negatively related, strength of relationships).
Definition 3 The normalized forward sensitivity index of a variable, u , that depends differentiably on a 
parameter, p , is defined as 
γu
p := ∂u
∂p × p
u.
We now look at some examples to show how to use sensitivity analysis.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Get Help Now
Go to www.helpmyassignment.co.uk for more info
Need help with your
dissertation?
Get in-depth feedback & advice from experts in your 
topic area. Find out what you can do to improve
the quality of your dissertation!

Mathematical Modeling I – preliminary
46 
Sensitivity analysis
Example 17 We consider the logistic population growth model 
dx
dt = rx

1 −x
K

.
Assume the experiment (or field observation) is terminated at t = 10, how does the final population size 
depend on the parameters r  and K ? 
Here, given the initial condition x(0) = 1, and the default parameter values are r = 0.1, K = 5, 
compute the normalized forward sensitivity index of the final population size that depends on r  or K . 
Solution: We apply Separation of Variables to find the solution 
x(t) =
K
1 + (K −1)e−rt.
In the end of the experiment, the final population size is 
x(10) =
K
1 + (K −1)e−10r .
The r -related sensitivity index is 
γx(10)
r
=
∂x(10)
∂r
×
r
x(10)
=
−K[(K −1)(−10)e−10r]
(1 + (K −1)e−10r)2
r
K/[1 + (K −1)e−10r]
=
10r(K −1)e−10r
1 + (K −1)e−10r .
At default parameter values, γx(10)
r
|r=0.1,K=5 = 0.5954. 
γx(10)
K
=
∂x(10)
∂K
×
K
x(10)
=
1 + (K −1)e−10r −Ke−10r
(1 + (K −1)e−10r)2
K
K/[1 + (K −1)e−10r]
=
1 −e−10r
1 + (K −1)e−10r .
At default parameter values, γx(10)
K
|r=0.1,K=5 = 0.2558.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
47 
Sensitivity analysis
The sign of the sensitivity index means positive or negative dependence of the studied quantity on the 
parameter. The absolute value of the sensitivity index indicates how sensitive the studied quantity depends 
on the parameter. Positive γx(10)
r
 and positive γx(10)
K
 mean that the final population size is positively 
related to r and K. And |γx(10)
r
| > |γx(10)
K
|  means that the final population size is more sensitive to r 
(growth rate) than to K  (carrying capacity), or r has larger effect on the final population size than K.
Note 1: If we cannot find an explicit expression for u , we can still compute γu
p  numerically: 
γu
p = ∂u
∂p × p
u ≈u(p + △p) −u(p)
△p
p
u(p),
in which △p  should be tiny, for example, 1% of the default p  value. We can use Matlab solver to obtain 
u  at p and u  at p + △p , then we can compute γu
p  numerically. Of course, the above discussion is 
under default parameter values, which are needed in Matlab simulations.
Note 2: The sensitivity index can be applied to any mathematical model, for instance, a discrete equation, 
a system of differential equations, a system of discrete equations, etc.
Example 18 Revisit the discrete bacterial reproduction model: 
Bn+1 =
rB2
n
1 +
 Bn
K
2.
Determine sensitivity of the stable internal equilibrium with respect to the parameters r and K. The default 
parameters values are r = 1, K = 4. 
Solution: Equilibrium values satisfy 
B∗=
rB∗2
1 +
 B∗
K
2
⇒B∗= 0, B∗= K

rK
2 −
 rK
2
2 −1

, B∗= K

rK
2 +
 rK
2
2 −1

. As we have discussed 
in Chapter 2, the stable internal equilibrium is B∗= K

rK
2 +
rK
2
2 −1

. The sensitivity indices are 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
48 
Sensitivity analysis
γB∗
r |r=1,K=4
=
∂B∗
∂r × r
B∗

r=1,K=4
=
K

K
2 +
2 · rK
2 · K
2
2
rK
2
2 −1

·
r
K

rK
2 +
rK
2
2 −1


r=1,K=4
=
4

2 +
8
2
√
3

·
1
4(2 +
√
3)
≈
1.15,
γB∗
K |r=1,K=4
=
∂B∗
∂K × K
B∗

r=1,K=4
=



rK
2 +
rK
2
2
−1

+ K

r
2 +
2 · rK
2 · r
2
2
rK
2
2 −1




·
K
K

rK
2 +
 rK
2
2 −1


r=1.K=4
=

(2 +
√
3) + 4
1
2 +
2
2
√
3

·
1
2 +
√
3
≈
2.15.
Hence, the stable internal equilibrium is positively related to the parameters r  and K, and it is more 
sensitive to K than to r .
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
By 2020, wind could provide one-tenth of our planet’s 
electricity needs. Already today, SKF’s innovative know-
how is crucial to running a large proportion of the 
world’s wind turbines. 
Up to 25 % of the generating costs relate to mainte-
nance. These can be reduced dramatically thanks to our 
systems for on-line condition monitoring and automatic 
lubrication. We help make it more economical to create 
cleaner, cheaper energy out of thin air. 
By sharing our experience, expertise, and creativity, 
industries can boost performance beyond expectations. 
Therefore we need the best employees who can 
meet this challenge!
The Power of Knowledge Engineering
Brain power
Plug into The Power of Knowledge Engineering. 
Visit us at www.skf.com/knowledge

Mathematical Modeling I – preliminary
49 
Sensitivity analysis
Example 19 We consider nearly pristine coral reefs where much of the prey use coral as refuge and are 
inaccessible to the predators. Singh, Wang, Morrison, Weiss (2012) constructed a mathematical model 
with an explicit refuge to illustrate a new biologically plausible mechanism that can explain stable inverted 
biomass pyramids in nearly pristine coral reefs. New modeling components include a refuge of explicit size, 
a refuge size dependent functional response, and refuge size dependent prey growth rate. The prey-predator 
model in a coral reef is provided by 
dx
dt
=
a(r)x

1 −x
K

−bf(x, r)y,
dy
dt
=
cbf(x, r)y −dy,
where x  is the prey biomass, y  is the predator biomass, b  is the maximum predation rate, K  is the prey 
carrying capacity, r  is the refuge size in coral reef, c  is the biomass conversion efficiency, and d  is the pre-
dator death rate. The functions in the model are the prey growth rate function a(r) = 0.003 +

0.004r12
0.1+r12

;
the predation response function f(x, r) =
1
1+e−10(x−r).
Compute sensitivity indices of the biomass ratio (predator to prey) at the coexistence equilibrium with 
respect to all parameters.
Note: We will learn how to analyze such a model in Chapter 6. Usually explicit solutions cannot be obtained, 
thus qualitative analysis is of necessary use. 
Solution: Similar to the case of one differential equation, equilibrium points (x∗, y∗) satisfy 
dx
dt
=
0
dy
dt
=
0
⇒ 
a(r)x(1 −x/K) −bf(x, r)y
=
0
cbf(x, r)y −dy
=
0
⇒ three possibilities: (0, 0), (K, 0), and the coexistence equilibrium (¯x, ¯y) where 
¯x = r −
1
10 ln
 bc
d −1

> 0, ¯y = a(r)c
d ¯x

1 −¯x
K

> 0. The biomass ratio at the coexistence 
equilibrium is 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
50 
Sensitivity analysis
BR = ¯y
¯x = a(r)c
d

1 +
1
10K ln
bc
d −1

−r
K

,
from which we can compute γBR
r
, γBR
c
, γBR
d
, γBR
K , γBR
b
. Given default parameter values: 
r = 0.9, c = 0.15, d = 0.0005, K = 2.0, b = 0.24, we can obtain the sensitivity table: 
Parameters
Sensitivity index
r
1.55
c
0.61
d
-0.61
K
0.11
b
0.05
The biomass ratio is most sensitive to variation in the refuge size (r) and least sensitive to variation in 
the predation response (b). The signs of the sensitivity indices illustrate that the biomass ratio is an 
increasing function of r (per unit area coral reef refuge size), b (maximum predation rate), c (biomass 
conversion efficiency) and K (prey carrying capacity) and a decreasing function of d (predator death rate).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
51 
Systems of difference equations (discrete)
5	 Systems of difference equations 
(discrete)
5.1	
Analytical methods
We consider a two-dimensional discrete-time system: 
xn+1
=
f(xn, yn),
yn+1
=
g(xn, yn).
The qualitative analysis of a higher dimensional discrete-time system is, although more complicated, 
similar to a two-dimensional discrete-time system.
Same logic as the scalar case, equilibria (x∗, y∗) satisfy 
x∗
=
f(x∗, y∗),
y∗
=
g(x∗, y∗).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
52 
Systems of difference equations (discrete)
Stability of an equilibrium (x∗, y∗) can be determined by the following theorem: 
Theorem 4 (Linear stability analysis) Let (x∗, y∗) be an equilibrium of 
xn+1
=
f(xn, yn),
yn+1
=
g(xn, yn),
and f, g  are at least twice continuously differentiable. Let 
J(x∗, y∗) =

∂f
∂xn(x∗, y∗)
∂f
∂yn(x∗, y∗)
∂g
∂xn(x∗, y∗)
∂g
∂yn(x∗, y∗)

be the Jacobian matrix of 
f
g

, evaluated at (x∗, y∗). Then
(x∗, y∗) is stable if all eigenvalues of J  have magnitude less than one;
(x∗, y∗) is unstable if at least one of the eigenvalues has magnitude greater than one. 
Note 1: Eigenvalues λ  of J  are obtained from the characteristic equation det(J −λI) = 0 where 
I  denotes the identity matrix.
Note 2: Magnitude of a real eigenvalue is absolute value, while magnitude of a complex eigenvalue 
|a + bi| =
√
a2 + b2 .
Note 3: This stability theorem can be easily extended to a higher dimensional system. For a system of m  
difference equations, the Jacobian matrix will be m × m , and there will be m  eigenvalues (counting 
multiplicity).
Note 4: For a two-dimensional system, the characteristic equation det(J −λI) = 0 is equivalent to 
λ2 −(trJ)λ + det J = 0. We can show that |trJ| < 1 + det J < 2 (Jury conditions) are sufficient 
and necessary conditions for all eigenvalues of J  to have magnitude less than one, then the equilibrium 
(x∗, y∗) is stable.
If additionally (trJ)2 −4 det J > 0, then (x∗, y∗) is a stable node (real eigenvalues);
If additionally (trJ)2 −4 det J < 0, then (x∗, y∗) is a stable spiral (complex eigenvalues).
We will apply the above definition and theorem to analysis some discrete-time systems.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
53 
Systems of difference equations (discrete)
5.2	
Some examples
Example 20 We consider love affairs between Romeo and Juliet. Let xn  be Romeo’s love/hate for Juliet on 
day n , and let yn  be Juliet’s love/hate for Romeo on day n . xn > 0 implies Romeo loves Juliet, xn < 0 
implies Romeo hates Juliet, and xn = 0 implies Romeo is neutral to Juliet. The larger |xn| , the stronger 
feeling of love/hate. Parallel assumptions hold for yn . A simple linear model is provided by 
xn+1
=
axn + byn,
yn+1
=
cxn + dyn,
where a  and d  are response rates to their own feelings, b  and c  are response rates to the feelings of the 
other. The sign of b  or c  determines a particular romantic style. Analyze this linear model mathematically. 
Solution: Equilibria (x∗, y∗) satisfy 
x∗
=
ax∗+ by∗
y∗
=
cx∗+ dy∗
⇔ 
(a −1)x∗+ by∗
=
0
cx∗+ (d −1)y∗
=
0
⇔ 
a −1
b
c
d −1
 x∗
y∗

=
0
0

Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
54 
Systems of difference equations (discrete)
Two cases: i) det
a −1
b
c
d −1

̸= 0; ii) det
a −1
b
c
d −1

= 0. We discuss these two cases 
one by one.
i) If det
a −1
b
c
d −1

̸= 0, then (x∗, y∗) = (0, 0) is the only equilibrium. Stability of this unique 
equilibrium is determined by the Jacobian matrix J =
a
b
c
d

⇒ trJ = a + d , det J = ad −bc . 
According to Jury conditions, (0, 0) is stable if |a + d| < 1 + ad −bc < 2.
If det
a −1
b
c
d −1

= 0, then (a −1)(d −1) −bc = 0, that is a −1
c
=
b
d −1
, thus the two 
algebraic equations are identical, we only need to solve from one equation, e.g. the first equation: 
∗= 1−a
b x∗, which is the only condition for equilibria to



Figure 8: Different showcases of Romeo and Juliet’s love affairs.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
55 
Systems of difference equations (discrete)
satisfy. Hence, all points of the form (x∗, y∗) = (x∗, 1 −a
b
x∗) are equilibria. All equilibria have 
the same Jacobian matrix because the system is linear. Therefore, any equilibrium (x∗, 1 −a
b
x∗) 
is stable if |a + d| < |1 + ad −bc < 2|  which is equivalent to |a + d| < a + d < 2 (since 
det
a −1
b
c
d −1

= 0 ⇒ad −bc + 1 = a + d ). However, the first Jury condition is never satisfied, 
then at least one eigenvalue has magnitude greater than or equal to one. To determine stability, We need 
to examine more details.
Actually when a + d > 0, |a + d| = a + d , at least one eigenvalue has magnitude one with the proof: 
λ2 −(trJ)λ + det J = 0 ⇒λ2 −(a + d)λ + ad −bc = 0 ⇒ 
λ
=
a + d ±

(a + d)2 −4(ad −bc)
2
=
a + d ±

(a + d)2 −4(a + d −1)
2
=
a + d ±

(a + d −2)2
2
=
a + d ± (a + d −2)
2
which leads to eigenvalues λ1 = a + d −1, λ2 = 1. In general, we may need to look at higher order 
terms of the right hand side of the system when one or a few eigenvalues have magnitude one and all 
other eigenvalues have magnitudes less than one. Fortunately the system here is linear (no high order 
terms), then the stability is determined by the eigenvalue whose magnitude is not one. Hence, all equilibria 
(x∗, 1 −a
b
x∗) are stable if |a + d −1| < 1 ⇔0 < a + d < 2.
When a + d < 0, |a + d| > a + d , the eigenvalues λ1 = a + d −1 < −1, λ2 = 1. Since 
|λ1| = |a + d −1| > 1, then the stability theorem implies that all equilibria (x∗, 1 −a
b
x∗) are 
unstable.
Figure 8 shows various possible relations between Romeo and Juliet, depending on different parameter 
values. We only vary the parameters in the first equation since xn  and yn  are symmetric. From the 
figure, we can observe that when Romeo and Juliet have opposite response rates of their own feelings 
(first and second panels), or when the response rates of the feeling of the other have opposite signs 
(fifth and sixth panels), oscillations occur, that is, Romeo and Juliet love or hate each other alternatively. 
When all response rates are nonnegative, there are two possibilities: the feeling variables are increasing 
functions of time when at least one response rate of the feeling of the other is large ( b = 0.8 in the 
third panel), that is, Romeo and Juliet love each other more and more if one of them loves the other 
deeply; the feeling variables are decreasing functions of time when both response rates of the feeling of 
the other are small (b = 0.3 in the fourth panel), that is, Romeo and Juliet love each other less and less 
if both of them only love each other a little bit.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
56 
Systems of difference equations (discrete)
Example 21 We consider host-parasitoid interactions (see Figure 9). Parasitoids lay eggs on hosts, and thus 
hosts are separated into two groups. Parasitized hosts give rise to the next generation of parasitoids, while 
non-parasitized hosts give rise to the next generation of hosts. Write up a simple model for host-parasitoid 
interactions and perform mathematical analysis. 
 
Figure 9: A flowchart of host-parasitoid model.
Solution: Let Hn  be the number of hosts at generation n , Pn be the number of parasitoids at generation 
n . Let f(Hn, Pn) be the fraction of hosts that are not parasitized, then the number of hosts not 
parasitized is f(Hn, Pn)Hn, and the number of hosts parasitized is [1 −f(Hn, Pn)]Hn. To simplify 
the model, we assume that the host population grows geometrically in the absence of the parasitoids 
with the reproduction rate b > 1, and that the average number of eggs laid in one host that give rise 
to adult parasitoids is c > 0. With these assumptions, we obtain the discrete model: 
Hn+1
=
bf(Hn, Pn)Hn,
Pn+1
=
c[1 −f(Hn, Pn)]Hn.
If we assume that the fraction of hosts not parasitized is a decreasing function of the parasitoid population 
and independent of the host population, then we can choose f(Hn, Pn) = e−aPn . Hence, the model 
becomes 
Hn+1
=
bHne−aPn,
Pn+1
=
cHn[1 −e−aPn],
which is the classic Nicholson and Bailey’s model.
Equilibria satisfy 
H∗
=
bH∗e−aP ∗,
P ∗
=
cH∗[1 −e−aP ∗],
which leads to (H∗, P ∗) = (0, 0) and (H∗, P ∗) = (
b ln b
ac(b−1), ln b
a ) (it makes sense since b > 1).
We determine stability by evaluating the Jacobian matrix 
J(H∗, P ∗) =

be−aP ∗
−abH∗e−aP ∗
c[1 −e−aP ∗]
acH∗e−aP ∗

Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
57 
Systems of difference equations (discrete)
at each equilibrium: J(0, 0) =
 b
0
0
0

 which leads to eigenvalues λ1 = b > 1, λ2 = 0, thus (0, 0) 
is unstable; J(
b ln b
ac(b−1), ln b
a ) =

1
−b ln b
c(b−1)
c(b−1)
b
ln b
b−1

 whose trace and determinant are trJ = 1 + ln b
b−1 , 
det J = ln b + ln b
b−1. Since b > 1, |trJ| < 1 + det J , the first Jury condition is satisfied. Since 
det J > 1 for all b > 1, then the second Jury condition (1 + det J < 2) is never satisfied (the 
inequality has the opposite direction without equal). Hence, (
b ln b
ac(b−1), ln b
a ) is unstable. A natural question 
appears: where do solutions go?  A stable cycle or chaotic attractor!  This is out of the scope of this book.
Note: If 1 + det J = 2, then the situation can be more complicated. Besides the Jacobian matrix, high 
order terms need to be examined to determine stability. Same logic holds for the first Jury condition.
A sample simulation will be provided in Chapter 8 (see Figure 20).
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
EXPERIENCE THE POWER OF 
FULL ENGAGEMENT…
     RUN FASTER.
          RUN LONGER..
                RUN EASIER…
READ MORE & PRE-ORDER TODAY 
WWW.GAITEYE.COM
Challenge the way we run

Mathematical Modeling I – preliminary
58 
Systems of differential equations (continuous)
6	 Systems of differential equations 
(continuous)
6.1	
Some motivation examples
Example 22  (A competition model) Consider a pond that supports two fish types: trout and bass. They 
compete for food. Let x(t) be the population of trout at time t  and y(t) be the population of bass at 
time t . The model is provided by 
dx
dt
=
ax −bxy,
(growth-competition)
dy
dt
=
my −nxy,
(growth-competition)
where a, b, m, n > 0, x, y ≥0. The parameters a  and m  represent the per capita growth rates of trout 
and bass, respectively. The parameters b  and n  represent the competition strengths between trout and bass. 
The mathematical analysis of this model will be discussed later. This model only considers the between-
species competition. To incorporate both between-species and within-species competitions, we have the 
following well-known model.
Example 23  (The Lotka-Volterra competition model) Let y1(t) be the population of species 1 and y2(t) 
be the population of species 2. The model incorporating both between-species and within-species competitions 
can be provided by 
dy1
dt
=
r1y1(1 −y1 −a1y2),
dy2
dt
=
r2y2(1 −y2 −a2y1),
where r1, r2, a1, a2 > 0, y1, y2 ≥0. The right hand side of either equation is formulated as growth – 
within species competition – between species competition. This model is usually called the Lotka-Volterra 
competition model. 
We will return to this example as well after we study basic analytical methods.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
59 
Systems of differential equations (continuous)
Example 24  (A basic epidemic model) Epidemic models are constructed for understanding the spread of 
an infectious disease in a host population.
We define the variables and the parameters as follows:
S  — the number of susceptible individuals
I  — the number of infected&infectious individuals
R  — the number of recovered individuals
β > 0 — the transmission coefficient
α > 0 — the recovery rate
γ > 0 — the rate for the loss of immunity
 
Figure 10: A flowchart of SIR epidemic model.
Infected individuals can infect susceptible individuals and can be recovered. It is possible for recovered 
individuals to lose their immunity after some time. The classical SIR (susceptible-infected-recovered) model 
describing the above process is provided by 
S′
=
−βSI + γR,
I′
=
βSI −αI,
R′
=
αI −γR,
where βSI  is the rate of new incidences via direct contact between S  and I , using the mass-action form. 
(S + I + R)′ = 0 ⇒S + I + R = constant, say N , then 
S′
=
−βSI + γ(N −S −I),
I′
=
βSI −αI,
R
=
N −S −I,
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
60 
Systems of differential equations (continuous)
which is actually a two-dimensional system of differential equations since the third equation is an 
algebraic equation.
If we assume permanent immunity, then γ = 0, then 
S′
=
−βSI,
I′
=
βSI −αI,
R′
=
αI,
or equivalently 
S′
=
−βSI,
I′
=
βSI −αI,
R
=
N −S −I,
6.2	
Nondimensionalization
Nondimensionalization is a technique to reduce the number of free parameters without losing any 
property of the model. We discuss this technique in two examples.
Example 25 Nondimensionalize the logistic growth model N ′ = rN

1 −N
K

. 
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
PDF components for PHP developers
www.setasign.com
SETASIGN
This e-book  
is made with 
SetaPDF

Mathematical Modeling I – preliminary
61 
Systems of differential equations (continuous)
Let ˜N = N
K  which has no unit, then 
N′
K = rN
K

1 −N
K

,
which leads to 
˜N′ = r ˜N(1 −˜N).
Let ˜t = rt which has no unit, then 
˜N
dt = d ˜N
d˜t
d˜t
dt = rd ˜N
d˜t ,
thus 
rd ˜N
d˜t = r ˜N(1 −˜N),
d ˜N
d˜t = ˜N(1 −˜N).
If we delete tilde, then we obtain the nondimensionalized model N′ = N(1 −N) which has no 
parameters! 
Example 26 Nondimensionalize the competition model 
x′
=
ax −bxy,
y′
=
my −nxy.
Let ˜x = n
ax , ˜y = b
ay , ˜t = at , µ = m
a
, all of which have no units, then the model becomes 
˜x′
=
˜x −˜x˜y,
˜y′
=
µ˜y −˜x˜y.
Delete tilde to obtain the nondimensionalized model: 
x′
=
x −xy,
y′
=
µy −xy,
which has only one parameter! 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
62 
Systems of differential equations (continuous)
6.3	
Analytical methods
For a system of differential equations, usually we cannot solve it explicitly, thus qualitative analysis is 
useful to understand dynamical behaviors of a system. In this section, we study the qualitative analysis 
of a system of two differential equations: 
x′
1
=
f1(x1, x2),
x′
2
=
f2(x1, x2).
Let x =
 x1
x2

, f(x) =
 f1(x)
f2(x)

=
 f1(x1, x2)
f2(x1, x2)

, we have the vector form: 
x′ = f(x).
Actually, for any number of autonomous differential equations, we can always write the system as this 
vector form.
Nullclines
The x1-nullcline is the set of points (x1, x2) such that x′
1 = f1(x1, x2) = 0.
The x2-nullcline is the set of points (x1, x2) such that x′
2 = f2(x1, x2) = 0.
Equilibrium points (or fixed points or steady states)
All equilibrium points (x∗
1, x∗
2) satisfy 
f1(x∗
1, x∗
2)
=
0,
f2(x∗
1, x∗
2)
=
0,
the intersection(s) of x1- and x2-nullclines.
Stability of equilibrium points
Jacobian matrix at (x∗
1, x∗
2): J(x∗
1, x∗
2) =

∂f1
∂x1(x∗
1, x∗
2)
∂f1
∂x2(x∗
1, x∗
2)
∂f2
∂x1(x∗
1, x∗
2)
∂f2
∂x2(x∗
1, x∗
2)

 Characteristic equation: 
det(J(x∗
1, x∗
2) −λI) = 0 whose roots λ1, λ2 are eigenvalues.
Stability criterion:
The equilibrium point (x∗
1, x∗
2) is (asymptotically) stable if all eigenvalues have negative real parts.
The equilibrium pint (x∗
1, x∗
2) is unstable if at least one of the eigenvalues has positive real part.
For a system of two differential equations, the condition “all eigenvalues have negative real parts” is 
equivalent to det J(x∗
1, x∗
2) > 0 and trJ(x∗
1, x∗
2) < 0.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
63 
Systems of differential equations (continuous)
 
Figure 11: Types and stability of an equilibrium point.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
www.sylvania.com
We do not reinvent  
the wheel we reinvent 
light.
Fascinating lighting offers an infinite spectrum of 
possibilities: Innovative technologies and new  
markets provide both opportunities and challenges. 
An environment in which your expertise is in high 
demand. Enjoy the supportive working atmosphere 
within our global group and benefit from international 
career paths. Implement sustainable ideas in close 
cooperation with other specialists and contribute to 
influencing our future. Come and join us in reinventing 
light every day.
Light is OSRAM

Mathematical Modeling I – preliminary
64 
Systems of differential equations (continuous)
Besides stability, we can classify equilibria in more detail (see Figure 11). 
• When both eigenvalues are real and negative, then the equilibrium point (x∗
1, x∗
2) is a stable 
node (see panel (a)). 
• When both eigenvalues are real and positive, then the equilibrium point (x∗
1, x∗
2) is an 
unstable node (see panel (b)). 
• When one eigenvalue is negative (real) and one eigenvalue is positive (real), then the 
equilibrium point (x∗
1, x∗
2) is a saddle (unstable) (see panel (c)). 
• When both eigenvalues are complex and have negative real parts, then the equilibrium point 
(x∗
1, x∗
2) is a stable spiral (see panel (d), counterclockwise versus clockwise). 
• When both eigenvalues are complex and have positive real parts, then the equilibrium point 
(x∗
1, x∗
2) is an unstable spiral (see panel (e), counterclockwise versus clockwise). 
Note: For a system of two differential equations, complex eigenvalues are complex conjugates which have 
the same real parts, thus the following two cases are impossible: i) one complex eigenvalue has positive 
real part while the other complex eigenvalue has negative real part; ii) one eigenvalue is complex while 
the other eigenvalue is real.
Revisit Example 22: 
dx
dt
=
ax −bxy,
dy
dt
=
my −nxy,
where a, b, m, n > 0, x, y ≥0.
Equilibrium points (x∗, y∗) satisfy 
ax∗−bx∗y∗
=
0
my∗−nx∗y∗
=
0
There are two possibilities: (0, 0), (m/n, a/b).
We can determine their stability by checking the Jacobian matrix 
J(x, y) =
 a −by
−bx
−ny
m −nx

.
At each equilibrium point (x∗, y∗), J(x∗, y∗) =
 a −by∗
−bx∗
−ny∗
m −nx∗

.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
65 
Systems of differential equations (continuous)
For the equilibrium (0, 0), 
J(0, 0) =
 a
0
0
m

det(J(0, 0) −λI) = 0
det
 a −λ
0
0
m −λ

(a −λ)(m −λ) = 0
Eigenvalues: λ1 = a > 0, λ2 = m > 0. Thus, the equilibrium (0, 0) is an unstable node.
For the equilibrium (m/n, a/b), 
J(m/n, a/b) =

0
−bm/n
−na/b
0

det(J(m/n, a/b) −λI) = 0
det

−λ
−bm/n
−na/b
−λ

= 0
λ2 −am = 0
λ = ±√am
Since am > 0, we obtain two real eigenvalues: λ1 = √am > 0, λ2 = −√am < 0. Thus the 
equilibrium (m/n, a/b) is a saddle (unstable).
Revisit Example 23: 
dy1
dt
=
r1y1(1 −y1 −a1y2),
dy2
dt
=
r2y2(1 −y2 −a2y1),
where r1, r2, a1, a2 > 0, y1, y2 ≥0.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
66 
Systems of differential equations (continuous)
Equilibrium points (¯y1, ¯y2) satisfy 
r1¯y1(1 −¯y1 −a1¯y2)
=
0
r2¯y2(1 −¯y2 −a2¯y1)
=
0
There are four possibilities: (0, 0), (1, 0), (0, 1), (y∗
1, y∗
2) where y∗
1, y∗
2  satisfy 
1 −y∗
1 −a1y∗
2
=
0
1 −y∗
2 −a2y∗
1
=
0
⇒ y∗
1 =
1−a1
1−a1a2 , y∗
2 =
1−a2
1−a1a2 .
Jacobian matrix 
J(¯y1, ¯y2)
=

∂f1
∂y1
∂f1
∂y2
∂f2
∂y1
∂f2
∂y2

(¯y1,¯y2)
=

r1(1 −2y1 −a1y2)
−r1a1y1
−r2a2y2
r2(1 −2y2 −a2y1)

=

r1(1 −2¯y1 −a1¯y2)
−r1a1¯y1
−r2a2¯y2
r2(1 −2¯y2 −a2¯y1)

.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
360°
thinking.
© Deloitte & Touche LLP and affiliated entities.
Discover the truth at www.deloitte.ca/careers 

Mathematical Modeling I – preliminary
67 
Systems of differential equations (continuous)
For the equilibrium point (0, 0), the Jacobian matrix J(0, 0) =
 r1
0
0
r2

 has eigenvalues 
λ1 = r1 > 0, λ2 = r2 > 0, thus the equilibrium (0, 0) is an unstable node.
For the equilibrium point (1, 0), the Jacobian matrix J(1, 0) =
 −r1
−r1a1
0
r2(1 −a2)

 has eigenvalues 
λ1 = −r1 < 0, λ2 = r2(1 −a2). Thus the equilibrium (1, 0) is asymptotically stable (a stable node) 
if a2 > 1, and it is unstable (a saddle) if a2 < 1.
For the equilibrium point (0, 1), the Jacobian matrix J(0, 1) =
 r1(1 −a1)
0
−r2a2
−r2

 has eigenvalues 
λ1 = r1(1 −a1), λ2 = −r2 < 0. Thus the equilibrium (0, 1) is asymptotically stable (a stable node) 
if a1 > 1, and it is unstable (a saddle) if a1 < 1.
For the coexistence/internal equilibrium point (y∗
1, y∗
2), the Jacobian matrix 
J(y∗
1, y∗
2)
=
 r1(1 −2y∗
1 −a1y∗
2)
−r1a1y∗
1
−r2a2y∗
2
r2(1 −2y∗
2 −a2y∗
1)

=

r1(1 −2−2a1
1−a1a2 −a1−a1a2
1−a1a2 )
−r1
a1−a2
1
1−a1a2
−r2
a2−a2
2
1−a1a2
r2(1 −2−2a2
1−a1a2 −a2−a1a2
1−a1a2 )

=

r1(1−a1a2−2+2a1−a1+a1a2)
1−a1a2
r1(a2
1−a1)
1−a1a2
r2(a2
2−a2)
1−a1a2
r2(1−a1a2−2+2a2−a2+a1a2)
1−a1a2

=
1
1 −a1a2

r1(a1 −1)
r1a1(a1 −1)
r2a2(a2 −1)
r2(a2 −1)

.
Now we check the conditions trJ(y∗
1, y∗
2) < 0 and det J(y∗
1, y∗
2) > 0. All eigenvalues have negative 
real parts if and only if 
trJ = r1(a1 −1) + r2(a2 −1)
1 −a1a2
< 0
and 
det J = r1r2(a1 −1)(a2 −1)
(1 −a1a2)2
−a1a2r1r2(a1 −1)(a2 −1)
(1 −a1a2)2
= r1r2(a1 −1)(a2 −1)
1 −a1a2
> 0.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
68 
Systems of differential equations (continuous)
We consider four cases: 
(i)	
a1 > 1 and a2 > 1 ⇒ r1r2(a1 −1)(a2 −1)
1 −a1a2
< 0, the second inequality is violated, 
thus the coexistence equilibrium (y∗
1, y∗
2) is unstable. 
(ii)	
a1 < 1 and a2 < 1 ⇒ both inequalities are valid, thus the coexistence equilibrium 
(y∗
1, y∗
2) is asymptotically stable. 
(iii)	
a1 > 1 and a2 < 1 ⇒ it is difficult to determine whether any of the two inequalities are 
valid. 
(iv)	
a1 < 1 and a2 > 1 ⇒ it is difficult to determine whether any of the two inequalities are 
valid. 
Since populations y1, y2 are nonnegative, we only consider the first quadrant of the phase plane  
( y1-y2 plane). We need to examine whether y∗
1, y∗
2  are nonnegative.
For case (iii) and case (iv), y∗
1 y∗
2 = (1−a1)(1−a2)
(1−a1a2)2
< 0, thus either y∗
1  or y∗
2  is negative. This means that 
the coexistence equilibrium (y∗
1, y∗
2) is unfeasible.
For case (i) and case (ii), the coexistence equilibrium (y∗
1, y∗
2) is obviously feasible in the first quadrant.
As a conclusion, there are four cases under different values of a1 and a2.
y1-nullcline: f1(y1, y2) = 0 ⇔ y1 = 0 or 1 −y1 −a1y2 = 0.
y2-nullcline: f2(y1, y2) = 0 ⇔ y2 = 0 or 1 −y2 −a2y1 = 0.
Intersections of different nullclines provide equilibrium points.
We plot phase portraits for the four cases in Figure 12 accordingly. Nullclines and equilibria are sketched 
with some representative solutions. Solid points represent stability while circles represent instability. The 
dotted curve in the first panel represents the separatrix (stable manifold of the internal saddle) for the 
attracting basins of the two stable equilibrium points. This panel indicates that when both species are 
strong in between-species competition (a1 > 1, a2 > 1), who wins the competition depends on the 
initial population sizes. All solutions in the second panel tend to the only stable equilibrium (y∗
1, y∗
2). This 
panel indicates that when the between-species competition is weak (a1 < 1, a2 < 1), the two competing 
species can coexist. All solutions in the third panel tend to the only stable equilibrium (0, 1), and the 
intersection of the two internal nullclines is in the second quadrant. This panel indicates that when 
species 1 is stronger than species 2 (a1 > 1 > a2), species 1 always wins the competition. All solutions 
in the fourth panel tend to the only stable equilibrium (1, 0), and the intersection of the two internal 
nullclines is in the fourth quadrant. This panel indicates that when species 1 is weaker than species 2  
(a1 < 1 < a2), species 2 always wins the competition. These results are all reasonable in biology, thus the 
simple Lotka-Volterra competition model captures the main qualitative features of species competition.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
69 
Systems of differential equations (continuous)
 
Figure 12: Phase portrait of the Lotka-Volterra competition model.
Revisit Example 24: 
S′
=
−βSI
I′
=
βSI −αI
d
dt
 S
I

=

−βSI
βSI −αI

which is simple but still a nonlinear system.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
70 
Systems of differential equations (continuous)
Equilibria (S∗, I∗) satisfy 
−βS∗I∗
=
0,
βS∗I∗−αI∗
=
0.
The first equation implies that S∗= 0 or I∗= 0.
When S∗= 0, the second equation implies that I∗= 0.
When I∗= 0, the second equation is always satisfied, thus S∗ can be any nonnegative number.
Hence, we have infinitely many equilibria ( ¯S, 0), ¯S ≥0.
To determine the type and stability of equilibria, we need to consider the Jacobian matrix at each 
equilibrium and compute eigenvalues. The Jacobian matrix J(S, I) =
 −βI
−βS
βI
βS −α

 
⇒ 
J( ¯S, 0) =
 0
−β ¯S
0
β ¯S −α

 
⇒ 
Eigenvalues 
are 
λ1 = 0 
(neutral 
for 
stability), 
λ2 = β ¯S −α
 > 0
if
¯S > α/β;
< 0
if
¯S < α/β.
Based on the value of ¯S , should the model have a group of equilibria unstable and a group of equilibria 
stable? 
dI
dS = dI/dt
dS/dt = βSI −αI
−βSI
= −1 + α
βS ,
then I =
 
−1 +
α
βS

dS = −S + α
β ln S + C .
If the initial point is (S0, I0), then I 0 = −S0 + α
β ln S0 + C ⇒C = I0 + S0 −α
β ln S0. Hence, 
I = α
β ln S −S + (I0 + S0 −α
β ln S0).
Phase portrait is sketched in Figure 13 that shows the following observations:
If S0 > α/β , then I  initially increases, reaching its maximum at S = α/β , and then decreases. 
Therefore, there is an outbreak (or epidemic) in this case.
If S0 < α/β , then no epidemic is possible, and I decreases from the beginning.
Obviously, the value α/β  represents the critical population size for causing an epidemic.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
71 
Systems of differential equations (continuous)
 
Figure 13: Phase portrait of the SIR epidemic model.
We look at one more example, which will be discussed again in Chapter 7.
Example 27 Analyze the model 
dx1
dt
=
−x2 + x1(µ −x2
1 −x2
2),
dx2
dt
=
x1 + x2(µ −x2
1 −x2
2).
Solution:
x1-nullcline: −x2 + x1(µ −x2
1 −x2
2) = 0,
x2-nullcline: x1 + x2(µ −x2
1 −x2
2) = 0,
both of which are not straight lines.
Equilibria (x∗
1, x∗
2) satisfy 
−x∗
2 + x∗
1(µ −x∗
1
2 −x∗
2
2)
=
0
x∗
1 + x∗
2(µ −x∗
1
2 −x∗
2
2)
=
0
⇔ 
x∗
1(µ −x∗
1
2 −x∗
2
2)
=
x∗
2
x∗
2(µ −x∗
1
2 −x∗
2
2)
=
−x∗
1
⇒ 
(x∗
1
2 + x∗
2
2)(µ −x∗
1
2 −x∗
2
2) = 0
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
72 
Systems of differential equations (continuous)
⇒ 
x∗
1
2 + x∗
2
2 = 0
or
µ −x∗
1
2 −x∗
2
2 = 0
⇒ 
x∗
1 = x∗
2 = 0.
The system has only one equilibrium point (0, 0).
To determine its stability, we examine its Jacobian matrix: 
J(x1, x2) =
 µ −3x2
1 −x2
2
−1 −2x1x2
1 −2x1x2
µ −x2
1 −3x2
2

J(0, 0) =
 µ
−1
1
µ

det(J(0, 0) −λI) = 0
det
 µ −λ
−1
1
µ −λ

= 0
(µ −λ)2 + 1 = 0
(µ −λ)2 = −1
(λ −µ)2 = −1
λ −µ = ±i
λ = µ ± i
Eigenvalues are two complex conjugates: λ1 = µ + i , λ2 = µ −i .
Hence, the only equilibrium point (0, 0) is 
• a stable spiral when µ < 0, 
• an unstable spiral when µ > 0. 
This example provides the canonical form for the Hopf bifurcation, from which the limit cycle occurs. 
We will discuss basic bifurcations in Chapter 7.
Stability of an equilibrium we discuss in this book is local stability (initial points are close to the 
equilibrium). Global stability of an equilibrium in a two dimensional system can be determined by 
Poincaré-Bendixson theorem (to claim all possibilities) and Dulac criterion (to exclude limit cycles).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
73 
Systems of differential equations (continuous)
6.4	
Higher dimensional systems
In this section, we briefly mention the analysis of a system with dimension three or higher. The general 
system can be expressed as 
dx1
dt
=
f1(x1, · · · , xn)
...
dxn
dt
=
fn(x1, · · · , xn)
In the vector notation, the system is dx
dt = f(x), where =



x1
...
xn


, f(x) =



f1(x)
...
fn(x)


=



f1(x1, · · · , xn)
...
fn(x1, · · · , xn)


.
Equilibria x∗ satisfy f(x∗) = 0 ⇔ 
f1(x∗)
=
0
...
fn(x∗)
=
0
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
We will turn your CV into 
an opportunity of a lifetime
Do you like cars? Would you like to be a part of a successful brand?
We will appreciate and reward both your enthusiasm and talent.
Send us your CV. You will be surprised where it can take you.
Send us your CV on
www.employerforlife.com

Mathematical Modeling I – preliminary
74 
Systems of differential equations (continuous)
⇔ 
f1(x∗
1, x∗
2, · · · , x∗
n)
=
0
...
fn(x∗
1, x∗
2, · · · , x∗
n)
=
0
Stability of each equilibrium x∗ is determined by the associated Jacobian matrix 
J(x∗) =



∂f1
∂x1(x∗)
· · ·
∂f1
∂xn(x∗)
...
· · ·
...
∂fn
∂x1 (x∗)
· · ·
∂fn
∂xn(x∗)



det(λI −J(x∗)) = 0 ⇒ Eigenvalues λ1, λ2, · · · , λn (some of them may be same) ⇒ Stability of 
x∗ and local solution behaviors.
The characteristic equation det(λI −J(x∗)) = 0 is a polynomial with degree n . Here n ≥3, thus 
it is likely that we cannot obtain all eigenvalues explicitly. We usually apply Routh-Hurwitz theorem that 
provides conditions for all eigenvalues to have negative real parts.
Global stability of an equilibrium in a system with dimension three or higher is extremely complicated 
and may be determined by Lyapunov functions or theory of monotone dynamics systems or compound 
matrices if lucky.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
75 
Bifurcation analysis
7	 Bifurcation analysis
Bifurcation analysis is an important technique to understand the role of key parameters in the output 
of the studied model and to examine the robustness of theoretical results. In this textbook, we only 
consider one bifurcation parameter. Multiple bifurcation parameters are more complicated but follow 
similar ideas. We will discuss one-dimensional flows (generated from one equation) for typical bifurcation 
types: saddle-node bifurcation, transcritical bifurcation, pitchfork bifurcation. We will also discuss two-
dimensional flows (generated from a system of two equations) for typical bifurcation types: saddle-node 
bifurcation, transcritical bifurcation, pitchfork bifurcation, Hopf bifurcation. Note that Hopf bifurcation 
can only occur in a system of two or more equations. These typical bifurcation types frequently appear 
in higher dimensional equations as well.
7.1	
Saddle-node bifurcation
T﻿he saddle-node bifurcation occurs when equilibrium points are created and destroyed. As the bifurcation 
parameter varies, two equilibrium points move toward each other, collide, and finally disappear.
Example 28  For the equation dx
dt = r + x2, discuss how equilibrium points and their stability change 
as the parameter r varies. 
Solution: When r < 0, there are two equilibrium points: x = √−r  (unstable), x = −√−r  (stable).
When r = 0, the only equilibrium point x = 0 is half-stable.
When r > 0, no equilibrium points exist.
These three cases are plotted in Figure 14.
We can plot these results in a bifurcation diagram (the last panel of Figure 14) which sketches the key 
dynamical features (equilibria, limit cycles, etc.) versus the bifurcation parameter. The saddle-node 
bifurcation occurs at r = 0.
Example 29 For the equation dx
dt = r −x2, discuss how equilibrium points and their stability change as 
the parameter r  varies. Plot the bifurcation diagram. 
We leave this problem to readers since the process is same as Example 28.
Other names of saddle-node bifurcation include fold bifurcation, turning-point bifurcation.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
76 
Bifurcation analysis
 
Figure 14: Three cases of Example 28 and the bifurcation diagram.
7.2	
Transcritical bifurcation
The transcritical bifurcation occurs when an equilibrium point always exists but changes its stability as 
the bifurcation parameter varies.
Example 30  Perform bifurcation analysis of the equation dx
dt = rx −x2. 
Solution: Equilibrium points are x = 0 and x = r.
When r < 0, the equilibrium point x = 0 is stable and the equilibrium point x = r  is unstable.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
77 
Bifurcation analysis
When r = 0, the equilibrium point x = 0 and the equilibrium point x = r  collide and are half-stable.
When r > 0, the equilibrium point x = 0 is unstable and the equilibrium point x = r  is stable.
These three cases are plotted in Figure 15.
The equilibrium point x = 0 exists for all values of r. As r  increases from negative to positive, the two 
equilibrium points exchange their stabilities. We conclude these results in a bifurcation diagram (the 
last panel of Figure 15). The transcritical bifurcation occurs at r = 0.
Figure 15: Three cases and the bifurcation diagram of Example 30.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
78 
Bifurcation analysis
7.3	
Pitchfork bifurcation
There are two types of pitchfork bifurcation: supercritical and subcritical. The supercritical pitchfork 
bifurcation occurs when the following dynamical switch occurs: As the bifurcation parameter varies, 
a forever existing equilibrium changes its stability from stable to unstable, and two new equilibrium 
points appear and are stable. The subcritical pitchfork bifurcation occurs when the following dynamical 
switch occurs: As the bifurcation parameter varies, a forever existing equilibrium changes its stability 
from unstable to stable, and two new equilibrium points appear and are unstable.
Example 31 Perform bifurcation analysis of the equation dx
dt = rx −x3 (supercritical case). 
Solution: When r ≤0, x = 0 is the only equilibrium and stable.
When r > 0, there are three equilibria: x = 0 is unstable, and x = ±√r  are stable.
The first two panels of Figure 16 show the phase portraits of these two cases.
We conclude the supercritical pitchfork bifurcation (occurring at r = 0) in a bifurcation diagram (the 
third panel of Figure 16). We can observe that as the bifurcation parameter r  increases from negative 
to positive, the trivial equilibrium changes its stability from stable to unstable, and two new stable 
equilibria appear.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
AXA Global 
Graduate Program
Find out more and apply

Mathematical Modeling I – preliminary
79 
Bifurcation analysis
Example 32 Perform bifurcation analysis of the equation dx
dt = rx + x3 (subcritical case). 
Solution: When r > 0, x = 0 is the only equilibrium and unstable.
When r ≤0, there are three equilibria: x = 0 is stable, and x = ±√−r  are unstable.
The fourth and fifth panels of Figure 16 show the phase portraits of these two cases.
We conclude the subcritical pitchfork bifurcation (occurring at r = 0) in a bifurcation diagram (the 
last panel of Figure 16). We can observe that as the bifurcation parameter r decreases from positive 
to negative, the trivial equilibrium changes its stability from unstable to stable, and two new unstable 
equilibria appear.
The supercritical pitchfork bifurcation is also called a forward bifurcation. The subcritical pitchfork 
bifurcation is also called an inverted or backward bifurcation.
7.4	
Generic saddle-node bifurcation
In this section, we discuss the generic form of saddle-node bifurcation which can be extended from the 
normal from of saddle-node bifurcation (Section 7.1). Similar ideas can be applied to discuss generic 
transcritical or pitchfork bifurcation.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
80 
Bifurcation analysis
Figure 16: The first three panels are for supercritical pitchfork bifurcation  
and the last three panels are for subcritical pitchfork bifurcation.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
81 
Bifurcation analysis
The normal form of saddle-node bifurcation is dx
dt = r + x2. We first discuss the extension of this 
normal form with a higher order term, and then we discuss the generic form.
Lemma 1  The equation dx
dt = r + x2 + O(x3) is locally topologically equivalent near the origin to the 
equation dx
dt = r + x2. 
Topological equivalence means that one object can be continuously deformed to the other, i.e. there is a 
homeomorphism of one onto the other, i.e. there is a one-to-one map between them that is continuous 
in both directions. This lemma claims that adding a higher order term will not change the existence of 
saddle-node bifurcation. The proof can be found in “Elements of Applied Bifurcation Theory” by Yuri 
A. Kuznetsov.
Generic case: dx
dt = f(x, r), x ∈R1, r ∈R1, with s smooth function f , and at r = 0, the equilibrium 
x = 0 has the eigenvalue λ = fx(0, 0) = 0 (saddle-node bifurcation condition).
Expand f(x, r) as a Taylor series with respect to x  at x = 0: 
f(x, r) = f0(r) + f1(r)x + f2(r)x2 + O(x3).
Equilibrium condition: f(0, 0) = 0, i.e. f0(0) = 0;
Saddle-node bifurcation condition: fx(0, 0) = 0, i.e. f1(0) = 0.
When solutions are near the bifurcation point, the generic equation becomes the normal equation plus 
higher order terms.
Theorem 5  Suppose that a one-dimensional system dx
dt = f(x, r), x ∈R1, r ∈R1, with smooth f , 
has the equilibrium x = 0 at r = 0. Assume that 
(A1) λ = fx(0, 0) = 0 
(A2) fxx(0, 0) ̸= 0 
(A3) fr(0, 0) ̸= 0 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
82 
Bifurcation analysis
where (A2) and (A3) are for invertibility. Then there exist invertible coordinate and parameter changes 
transforming the system into 
dˆx
dτ = ˆr ± ˆx2 + O(ˆx3).
Theorem 5 together with Lemma 1 implies that the generic case dx
dt = f(x, r) with (A1),(A2),(A3) 
and the equilibrium x = 0 at r = 0, is locally topologically equivalent near the origin to one of the 
normal forms: 
dˆx
dτ = ˆr ± ˆx2.
Is this useful?  No doubt! 
Even if we cannot compute bifurcation points by hand, the existence conditions of bifurcations provide 
underlying ideas for programming of bifurcation diagrams (Matlab, xppaut, etc.).
Example 33 Determine whether the equation dx
dt = r −x −e−x ≜f(x, r) possesses saddle-node 
bifurcation. 
Solution: At r = 0, x = 0 is not an equilibrium, since f(0, 0) = −1 ̸= 0.
Rewrite the equation as dx
dt = (r −1) + 1 −x −e−x .
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
ibili
because 
e Graduate Programme  
for Engineers and Geoscientists
Month 16
I was a construction
supervisor in 
the North Sea 
advising and 
helping foremen 
solve problems
I was a
he
s
Real work 
International opportunities 

ree work placements
al 
Internationa
or

ree wo
I wanted real responsibili 
 I joined MITAS because 
www.discovermitas.com

Mathematical Modeling I – preliminary
83 
Bifurcation analysis
Let ¯r = r −1, then dx
dt = ¯r + 1 −x −e−x ≜¯f(x, ¯r).
Now ¯f(0, 0) = 0, i.e. x = 0 is an equilibrium at ¯r = 0. We can check the three conditions in 
Theorem 5: 
(A1) λ = ¯fx(0, 0) = −1 + e−x|(0,0) = 0 
(A2) ¯fxx(0, 0) = −e−x|(0,0) = −1 ̸= 0 
(A3) ¯f¯r(0, 0) = 1 ̸= 0 
Hence, there exists a saddle-node bifurcation as the bifurcation parameter ¯r  (or r ) varies. The bifurcation 
value of the parameter for the original equation is r = 1 (i.e. ¯r = 0). The bifurcation diagram can be 
plotted using Matlab or xppaut.
7.5	
Saddle-node, transcritical, and pitchfork bifurcations in two-dimensional 
systems
We start our discussion from an example.
Example 34  Perform bifurcation analysis of a simple decoupled system: 
dx
dt
=
µ −x2,
dy
dt
=
−y.
Solution: If µ > 0, there are two equilibria (√µ, 0), (−√µ, 0). Their stability can be determined by 
their Jacobian matrices:
J(√µ, 0) =
 −2√µ
0
0
−1

 ⇒ (√µ, 0) is a stable node;
J(−√µ, 0) =
 2√µ
0
0
−1

 ⇒ (−√µ, 0) is a saddle.
If µ = 0, the system has a unique equilibrium (0, 0). The Jacobian matrix is J(0, 0) =
 0
0
0
−1

 
which cannot tell the stability. However, we can solve the decoupled system easily to obtain that the 
equilibrium (0, 0) is a saddle-node (one side like a saddle and one side like a stable node). This may be 
the reason for the name “saddle-node” bifurcation.
If µ < 0, no equilibria exist since µ −x2 < 0.
These three cases are plotted in Figure 17.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
84 
Bifurcation analysis
Figure 17: Three cases and the bifurcation diagram of Example 34.
As µ  decreases from positive to negative, the saddle and the node approach each, then collide when 
µ = 0, and finally disappear when µ < 0. We conclude these results in a bifurcation diagram (the last 
panel of Figure 17) in which we plot x  versus µ  since the change of equilibria occurs in x -coordinate. 
The bifurcation diagram is the same as the one-dimensional case dx
dt = µ −x2.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
85 
Bifurcation analysis
Typical examples for transcritical and pitchfork bifurcations of two dimensional flows are listed below:
(transcritical) 
dx
dt
=
µx −x2
dy
dt
=
−y
(supercritical pitchfork) 
dx
dt
=
µx −x3
dy
dt
=
−y
(subcritical pitchfork) 
dx
dt
=
µx + x3
dy
dt
=
−y
More complicated examples can be found in “Nonlinear dynamics and chaos” by S.H. Strogatz.
7.6	
Introduction of Hopf bifurcations
As the bifurcation parameter varies, a real eigenvalue passes through λ = 0 (see the first panel of Figure 
18). This is the case for saddle-node, transcritical, or pitchfork bifurcation.
As the bifurcation parameter varies, two complex conjugate eigenvalues simultaneously cross the 
imaginary axis into the right half-plane (see the second panel of Figure 18). This is the case for Hopf 
bifurcations.
Hopf bifurcation has two main types: supercritical and subcritical.
Example 35  Perform bifurcation analysis for the system 
dr
dt
=
µr −r3
θ
dt
=
ω + br2
in polar coordinates where µ  is the bifurcation parameter. (supercritical case) 
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
86 
Bifurcation analysis
Figure 18: Two complex planes, and two phase portraits and the bifurcation diagram of supercritical Hopf bifurcation (Example 35), 
and two phase portraits and the bifurcation diagram of subcritical Hopf bifurcation (Example 36).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
87 
Bifurcation analysis
Solution: In Cartesian coordinates, x = r cos θ, y = r sin θ, then 
(ω + b(x2 + y2))y
dx
dt = dr
dt cos θ −rdθ
dt sin θ = (µr −r3) cos θ −r(ω +br2) sin θ = (µ−(x2 +y2))x−
; similar for dy
dt . Hence the system becomes 
dx
dt
=
µx −ωy + cubic terms
dy
dt
=
ωx + µy + cubic terms
The Jacobian matrix at the origin (the trivial equilibrium) is 
A =
 µ
−ω
ω
µ

Eigenvalues λ = µ ± iω  cross the imaginary axis from left to right as µ  increases from negative to 
positive values.
When µ < 0, the origin is a spiral sink.
When µ > 0, the origin is a spiral source, and all solutions tend to a limit cycle.
The third and fourth panels of Figure 18 exhibit the phase portraits of these two cases.
We conclude these results in a bifurcation diagram (the fifth panel of Figure 18). The supercritical Hopf 
bifurcation occurs at µ = 0. It is usually difficult to prove existence of a limit cycle and its stability, but 
we can definitely check them numerically.
Example 36  Perform bifurcation analysis for the system 
dr
dt
=
µr + r3 −r5
dθ
dt
=
ω + br2
in polar coordinates where µ  is the bifurcation parameter. (subcritical case) 
Solution: Similar to Example 35, we can obtain the system in Cartesian coordinates 
x = r cos θ, y = r sin θ, and perform local stability analysis.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
88 
Bifurcation analysis
When −1/4 < µ < 0, the origin is a spiral sink. There is an unstable limit cycle and a stable limit 
cycle. Bistability occurs with the unstable limit cycle as the separatrix.
When µ > 0, the origin is a spiral source, and there is a stable limit cycle.
The sixth and seventh panels of Figure 18 exhibit the phase portraits of these two cases.
We conclude these results in a bifurcation diagram (the last panel of Figure 18). The subcritical Hopf 
bifurcation occurs at µ = 0.
Readers may be curious about the case µ ≤−1/4. Actually µ = −1/4 is a saddle-node bifurcation of 
limit cycles (a type of global bifurcations). When µ < −1/4, no limit cycles exist. When µ = −1/4 , 
one limit cycle exists and is half-stable. When −1/4 < µ < 0, two limit cycles exist (one stable, one 
unstable). We do not expand the details of this global bifurcation since we only discuss local bifurcations 
in this textbook.
7.7	
Normal form of Hopf bifurcation
The normal form of supercritical case is provided by 
dx
dt
=
µx −y −x(x2 + y2)
dy
dt
=
x + µy −y(x2 + y2)
The normal form of subcritical case is provided by 
dx
dt
=
µx −y + x(x2 + y2)
dy
dt
=
x + µy + y(x2 + y2)
Supercritical case:
The system has the equilibrium (0, 0) for all µ  values (additional equilibria are possible). The Jacobian 
matrix J(0, 0) =
 µ
−1
1
µ

 ⇒ Eigenvalues λ = µ ± i.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
89 
Bifurcation analysis
Figure 19: Two phase portraits and two bifurcation diagrams of supercritical Hopf bifurcation (normal form),  
and two phase portraits and two bifurcation diagrams of subcritical Hopf bifurcation (normal form).
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
90 
Bifurcation analysis
Introduce the complex variable z = x + iy , then ¯z = x −iy , |z|2 = z¯z = x2 + y2.

.
Let z = reiθ , where r =

x2 + y2 ≥0, tan θ = y/x , then
dz
dt = dr
dteiθ + ridθ
dt eiθ.
Hence, 
dr
dt eiθ + irdθ
dt eiθ = (µ + i)z −z|z|2 = z(µ + i −|z|2) = reiθ(µ + i −r2).
There are two groups in this equality: eiθ  and ieiθ . Setting the coefficients of them equal on both sides 
to obtain 
dr
dt
=
r(µ −r2)
dθ
dt
=
1
dz
dt = dx
dt + idy
dt = µ(x + iy) + i(x + iy) −(x + iy)(x2 + y2) = (µ + i)z −z|z|2
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
MASTER IN MANAGEMENT
mim.admissions@ie.edu
Follow us on IE MIM Experience
www.ie.edu/master-management
#10 WORLDWIDE
MASTER IN MANAGEMENT 
FINANCIAL TIMES
55 Nationalities
in class
5 Specializations
Personalize your program 
Length: 1O MONTHS
Av. Experience: 1 YEAR
Language: ENGLISH / SPANISH
Format: FULL-TIME
Intakes: SEPT / FEB
• STUDY IN THE CENTER OF MADRID AND TAKE ADVANTAGE OF THE UNIQUE OPPORTUNITIES
  THAT THE CAPITAL OF SPAIN OFFERS
• PROPEL YOUR EDUCATION BY EARNING A DOUBLE DEGREE THAT BEST SUITS YOUR
  PROFESSIONAL GOALS
• STUDY A SEMESTER ABROAD AND BECOME A GLOBAL CITIZEN WITH THE BEYOND BORDERS
  EXPERIENCE
93%
OF MIM STUDENTS ARE
WORKING IN THEIR SECTOR 3 MONTHS
FOLLOWING GRADUATION

Mathematical Modeling I – preliminary
91 
Bifurcation analysis
The second equation implies that all orbits keep rotating in the counterclockwise direction with a 
constant speed.
When µ < 0, we have dr
dt < 0 for r > 0 (actually r > 0 is always true except for the origin where 
r = 0), and thus the only equilibrium (of the original system) r = 0 is a spiral sink.
When µ = 0, we have dr
dt = −r3 < 0 for r > 0, and thus the only equilibrium r = 0 is still a spiral 
sink.
When µ > 0, we have dr
dt = r(µ −r2) > 0 for 0 < r < √µ . In this case, there are two possibilities 
from dr
dt = 0: r = 0 and r = √µ  (since r ≥0, the negative one is not feasible). r = 0 is corresponding 
to an unstable equilibrium, and r = √µ  is corresponding to a stable limit cycle.
The first two cases above are combined in the first panel of Figure 19, and the third case is plotted in 
the second panel of Figure 19.
We conclude the above results in bifurcation diagrams (the third and fourth panels of Figure 19). Similar 
analysis can be done for the subcritical case, for which we also plot phase portraits (the fifth and sixth 
panels of Figure 19) and bifurcation diagrams (the seventh and eighth panels of Figure 19).
7.8	
Generic Hopf bifurcation
We start this section with a lemma.
Lemma 2  The system 
d
dt
 x
y

=
 µ
−1
1
µ
  x
y

± (x2 + y2)
 x
y

+ O

 x
y
 
4
is locally topologically equivalent near the origin to the system 
d
dt
 x
y

=
 µ
−1
1
µ
  x
y

± (x2 + y2)
 x
y

.
Any generic two-dimensional system undergoing a Hopf bifurcation can be transformed into one of the 
normal forms (supercritical “-” in cubic terms, subcritical “+” in cubic terms) plus some higher order 
terms.
Consider d
dt
 x
y

= f(x, y, µ), with a smooth vector function f, which has at µ = 0 the equilibrium 
(0, 0) with eigenvalues λ = ±iω0, ω0 > 0.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
92 
Bifurcation analysis
Theorem 6  Suppose a two-dimensional system d
dt
 x
y

= f(x, y, µ) with smooth f, has the equilibrium 
(0, 0) with eigenvalues λ(µ) = α(µ) ± iβ(µ) for all sufficiently small |µ|. Assume the following 
conditions are satisfied: 
(B1) α(0) = 0, β(0) = ω0 > 0 (key Hopf bifurcation condition). 
(B2) l1(0) ̸= 0, where l1 is the first Lyapunov coefficient (nondegeneracy condition). 
(B3) α′(0) ̸= 0 (transversality condition). 
Then there exist invertible coordinate and parameter changes and a time reparametrization transforming 
the system d
dt
 x
y

= f(x, y, µ) into 
d
dτ
 ¯x
¯y

=
 ¯µ
−1
1
¯µ
  ¯x
¯y

± (¯x2 + ¯y2)
 ¯x
¯y

+ O

 ¯x
¯y
 
4
.
Theorem 6 together with Lemma 2 leads to the following theorem.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
93 
Bifurcation analysis
Theorem 7 (Topological normal form of Hopf bifurcation) Any generic (=(B2)+(B3)) two-dimensional, 
one-parameter system d
dt
 x
y

= f(x, y, µ), having at µ = 0 the equilibrium (0, 0) with eigenvalues 
((B1) ⇔) λ1(0) = iω0, λ2(0) = −iω0, ω0 > 0, is locally topologically equivalent near the origin to 
one of the following normal forms: 
d
dτ
 ¯x
¯y

=
 ¯µ
−1
1
¯µ
  ¯x
¯y

± (¯x2 + ¯y2)
 ¯x
¯y

.
Example 37 Consider a predator-prey model 
dx
dt
=
rx(1 −x) −cxy
α + x
dy
dt
=
cxy
α + x −dy
to examine whether Hopf bifurcation exists. 
See the solution in “Elements of Applied Bifurcation Theory” by Yuri A. Kuznetsov.
The bifurcations we discussed so far are popular ones, but there are many other bifurcations we have not 
discussed, for example, saddle-node bifurcation of limit cycles, infinite-period bifurcation, homoclinic 
bifurcation, etc.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
94 
Matlab programming
8	 Matlab programming
All basic Matlab knowledge can be learned from Matlab manual. All Matlab commands and the way to 
use them can be found from Matlab help files. In this chapter, we use Matlab to run simulations for some 
typical examples that are relevant to contents we have learned so far. Readers can modify these sample 
Matlab files for similar models. To change the model dimension, we need to change the dimensions of 
vectors and matrices.
The Matlab .m file for the host-parasitoid model is listed below.
% TwoDifferenceEquations.m – this MATLAB file simulates the host-parasitoid model
k=1.8; %parameter input
a=1; %parameter input
c=1; %parameter input
x0=1; %input initial population of host
y0=1; %input initial population of parasitoid
n=30; %input time period of run
x=zeros(n+1,1);
y=zeros(n+1,1);
t=zeros(n+1,1);
x(1)=x0;
y(1)=y0;
for i=1:n
t(i)=i-1;
x(i+1)=k*x(i)*exp(-a*y(i));
y(i+1)=c*x(i)*(1-exp(-a*y(i)));
end
t(n+1)=n;
figure
subplot(221)
plot(t,x,t,x,’o’)
title(’Host population’)
subplot(222)
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
95 
Matlab programming
plot(t,y,t,y,’*’)
title(’Parasitoid population’)
subplot(223)
plot(t,y,t,x,t,x,’o’,t,y,’*’)
title(’Host and parasitoid populations’)
subplot(224)
plot(x,y,’o-’)
title(’Host vs parasitoid’);
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
“The perfect start 
of a successful, 
international career.”
CLICK HERE 
to discover why both socially 
and academically the University 
of Groningen is one of the best 
places for a student to be 
www.rug.nl/feb/education
Excellent Economics and Business programmes at:

Mathematical Modeling I – preliminary
96 
Matlab programming
0
10
20
30
0
10
20
30
40
50
60
70
Host population
0
10
20
30
0
10
20
30
40
50
60
70
Parasitoid population
0
10
20
30
0
10
20
30
40
50
60
70
Host and parasitoid populations
0
20
40
60
80
0
10
20
30
40
50
60
70
Host vs parasitoid
 
Figure 20: The sample simulation for the host-parasitoid model.
The simulation results of this program are sketched in Figure 20. Readers can simply modify this program 
to run simulations for any model with a group of difference equations.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
97 
Matlab programming
0
2
4
6
8
10
12
14
16
18
20
−1.5
−1
−0.5
0
0.5
1
1.5
Figure 21: The sample simulation for a system of three dierential equations.
Matlab programs for a system of differential equations are simple. We provide an example of three 
differential equations below.
%ThreeDmodel.m
function dy = ThreeDmodel(t,y)
dy = zeros(3,1); % a column vector
dy(1) = y(2) * y(3);
dy(2) = -y(1) * y(3);
dy(3) = -0.5 * y(1) * y(2);
%ThreeDifferentialEquations.m
options = odeset(’RelTol’,1e-3,’AbsTol’,[1e-3 1e-3 1e-4]);
[T,Y] = ode45(@ThreeDmodel,[0 20],[0 1 1],options);
plot(T,Y(:,1),’-’,T,Y(:,2),’-.’,T,Y(:,3),’.’)
The simulation result is sketched in Figure 21.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
98 
Matlab programming
pplane8.m, copyright by John C. Polking at Rice University, is a useful program for a system of two 
differential equations, more specifically for planar autonomous systems. We can use it to simply plot 
equilibria, nullclines, sample solutions, etc.. pplane8.m can be downloaded from John C. Polking’s 
website. We show how to use pplane8.m in Figures 22 and 23. We first download pplane8.m into our own 
computer and run it in Matlab. A user friendly interface shows up. We can define our two dimensional 
system, parameters, plotting window size, and the type of direction field. Click “proceed” on the right-
bottom corner to obtain the phase plane in which we can plot all dynamical features we want, such as 
equilibria and nullclines. We can also sketch sample solutions by simply clicking on the phase plane. 
The point we click will be used as the initial point for the generated solution.
pplane8.m can be applied to plot phase portraits of all the two dimensional examples in Chapters 6 and 7.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
American online      
LIGS University 
▶▶enroll by September 30th, 2014 and 
▶▶save up to 16% on the tuition!
▶▶pay in 10 installments / 2 years
▶▶Interactive Online education
▶▶visit www.ligsuniversity.com to 
      find out more!
is currently enrolling in the
Interactive Online BBA, MBA, MSc, 
DBA and PhD  programs:
Note: LIGS University is not accredited by any 
nationally recognized accrediting agency listed 
by the US Secretary of Education. 
More info here. 

Mathematical Modeling I – preliminary
99 
Matlab programming
Figure 22: pplane8.m guidance.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
100 
Matlab programming
Figure 23: pplane8.m guidance – continued.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
101 
Matlab programming
Two sample .m files to plot the Hopf bifurcation are provided below. The first one defines the model, 
and the second one sketches the Hopf bifurcation diagram using a “for” loop.
%bif    odef.m
function xprime=bif    odef(t,x)
global R;
us=12;
Km=2000;
A=15;
B=70;
Gs=.44*A;
Gw=.63*A;
alpha=0.5;
l=0.01;
ut=us/6;
Gt=5*Gw/6+Gs/6;
xprime=[ut*x(1)*(1-x(1)/Km)-alpha*A*x(1)*x(2)/(alpha*x(1)+B)
R*x(2)*(A*alpha*x(1)/(alpha*x(1)+B)-Gt)-l*x(2)^2
];
%bif    odemain.m
rect = [200 80 700 650]; %fix the window size and position
set(0, ’defaultfigureposition’,rect);
global R;
option=odeset(’AbsTol’,1e-8,’RelTol’,1e-5);
inc=[0:0.1:50]’;
time=[ inc ] ;
limit=[ 400:1:500];
for R=0:0.01:1;
IC=[1000,20];
[t,U] = ode23s(’bif    odef’,time,IC,option);
u2=U(limit,2);
usmin=min(u2);
usmax=max(u2);
plot(R, usmax,’b.’,’MarkerSize’, 5);
plot(R, usmin,’r.’,’MarkerSize’, 5);
hold on
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
102 
Matlab programming
0
0.2
0.4
0.6
0.8
1
0
50
100
150
200
250
300
conversion rate, R
lemming
Figure 24: A sample Hopf bifurcation diagram.
end
xlim([0 1]);
ylim([0 300]);
xlabel(’conversion rate, R’);
ylabel(’lemming’);
The Hopf bifurcation, sketched by these two .m files, is shown in Figure 24. The main idea is to take 
maxima and minima of the tail of the solution. We need to run the simulation for a sufficiently long 
time such that the solution is stabilized, and we need to choose the length of the tail reasonably long 
such that at least one period of the limit cycle is included.
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
103 
Data fitting
9	 Data fitting
In this chapter, we focus on the most popular and simplest technique – least-square method – to perform 
data fitting. Given a model and a data set, how to obtain optimal parameter values to fit data?  If the 
model with optimal parameter values cannot fit data well, then either the model is problematic or the 
data is not accurate.
The least-square data fitting method is defined as follows:
Consider a system of differential equations 
y′ = f(t, y, p),
y ∈Rn,
f ∈Rn,
p ∈Rm,
where p is the vector of m parameters. Given a group of k data points: 
(t1, y1), (t2, y2), · · · , (tk, yk),
we can compute optimal parameter values for the parameters p by minimizing the error 
error(p) =
k

i=1
|y(ti, p) −yi|2.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more

Mathematical Modeling I – preliminary
104 
Data fitting
Sample .m files to apply this technique are provided below. The first file is to define the model, the second 
file is to compute the error function defined in least-square method, and the third file is to find optimal 
parameter values and use them to run the solution for a comparison with data.
%PPmodel.m
function value = PPmodel(t,y,p)
%Predator-prey model
%Parameters: p(1)=a, p(2) = b, p(3) = c, p(4) = d.
value=[p(1)*y(1)-p(2)*y(1)*y(2)
p(3)*y(1)*y(2)-p(4)*y(2)];
%PPerror.m
function error = PPerror(p)
%Error function for the predator-prey model
clear y;
years = 0:20;
DataX = [20.0 45.1 70.2 78.3 36.4 21.5 18.6 21.7 22.8 25.9 27.0 40.1 57.2 77.3 52.4 19.5 11.6 8.7 15.8 
16.9 25.0];
DataY = [5.0 6.1 10.2 35.3 60.4 42.5 19.6 13.7 8.8 9.9 7.0 8.1 12.2 20.3 46.4 51.5 30.6 16.7 10.8 11.9 9.0];
[t,y] = ode23(@PPmodel,years,[DataX(1); DataY(1)],[],p);
Download free eBooks at bookboon.com

Mathematical Modeling I – preliminary
105 
Data fitting
0
2
4
6
8
10
12
14
16
18
20
0
20
40
60
80
100
0
2
4
6
8
10
12
14
16
18
20
0
20
40
60
80
100
Figure 25: Least-square data fitting of the Lotka-Volterra predator-prey model to a data set.
Download free eBooks at bookboon.com
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
Click on the ad to read more
 
  
 
                . 

Mathematical Modeling I – preliminary
106 
Data fitting
value = (y(:,1)-DataX’).^2+(y(:,2)-DataY’).^2;
error = sum(value);
%LeastSquareDataFitting.m
%Parameter estimation and run the simulation to compare with data
guess = [0.5; 0.02; 0.02; 0.8];
[p,error] = fminsearch(@PPerror, guess)
[t,y] = ode23(@PPmodel,[0, 20],[20.0; 5.0],[],p);
years = 0:20;
DataX = [20.0 45.1 70.2 78.3 36.4 21.5 18.6 21.7 22.8 25.9 27.0 40.1 57.2 77.3 52.4 19.5 11.6 8.7 15.8 
16.9 25.0];
DataY = [5.0 6.1 10.2 35.3 60.4 42.5 19.6 13.7 8.8 9.9 7.0 8.1 12.2 20.3 46.4 51.5 30.6 16.7 10.8 11.9 9.0];
subplot(2,1,1)
plot(t,y(:,1),’r’,years,DataX,’ko’)
axis([0 20 0 100])
subplot(2,1,2)
plot(t,y(:,2),’r’,years,DataY,’ko’)
axis([0 20 0 100])
The least-square data fitting for the Lotka-Volterra predator-prey model is shown in Figure 25. We can 
observe that the model fits the data well with the optimal parameter values.
The optimal values of the parameters a, b, c, d  can be read from the command window of Matlab as 
below. The vector p  gives optimal parameter values a, b, c, d in the order.
>>
p =
0.7571
0.0374
0.0234
0.6547
error =
2.0503e+003
Download free eBooks at bookboon.com

