Guochang Xu · Yan Xu
GPS
Theory, Algorithms and Applications
 Third Edition 

GPS  Theory, Algorithms and Applications

Guochang Xu
• Yan Xu
GPS
Theory, Algorithms and Applications
Third Edition
With 62 Figures
123

Guochang Xu
Shandong University at Weihai
Institute of Space Sciences
Weihai
China
Yan Xu
GFZ German Research Centre for Geosciences
Geodesy
Potsdam
Germany
ISBN 978-3-662-50365-2
ISBN 978-3-662-50367-6
(eBook)
DOI 10.1007/978-3-662-50367-6
Library of Congress Control Number: 2016937942
© Springer-Verlag Berlin Heidelberg 2003, 2007, 2016
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part
of the material is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations,
recitation, broadcasting, reproduction on microﬁlms or in any other physical way, and transmission
or information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar
methodology now known or hereafter developed.
The use of general descriptive names, registered names, trademarks, service marks, etc. in this
publication does not imply, even in the absence of a speciﬁc statement, that such names are exempt from
the relevant protective laws and regulations and therefore free for general use.
The publisher, the authors and the editors are safe to assume that the advice and information in this
book are believed to be true and accurate at the date of publication. Neither the publisher nor the
authors or the editors give a warranty, express or implied, with respect to the material contained herein or
for any errors or omissions that may have been made.
Printed on acid-free paper
This Springer imprint is published by Springer Nature
The registered company is Springer-Verlag GmbH Berlin Heidelberg

To
Liping, Jia, Yuxi, and Pan

Preface to the Third Edition
After the ﬁrst edition of this book was published at the end of 2003, Springer
requested a revision for the second edition around 2006, and that was published at
the end of 2007. The original edition was written based on experience with the
software design of KSGsoft (Xu et al. 1998) and KGsoft (Xu 1999), and related
research and practice in Germany and Denmark. The second edition beneﬁted from
the design of the multi-functional GPS/Galileo software (MFGsoft, Xu 2004). The
new model of solar radiation for satellite orbit determination discovered through
GPS research led to an attempt to solve the equations of satellite motion affected by
second-order disturbances, which resulted in the book Orbits, published at the end
of 2008, with a second edition in 2013, combined with intensive research (cf. Xu
et al. 2010a,b, 2011; Xu and Xu 2012, 2013a,b). During that time, the author was
further involved in GPS activities through his role in the supervision of Ph.D.
studies and software development (cf. Wang et al. 2010; He 2015). In 2011, the
second edition of GPS was translated into Chinese by the Peking Institute of
Satellite Controlling and Telecommunication and was published by Tsinghua
University Press Peking, and was sold out around 2015. In 2014, GPS was trans-
lated into Persian, and that edition was published by Dhahran University. The
preparation of the third edition of GPS was contracted with Springer several years
ago, but was interrupted by work on the books Orbits (2008, 2013) and Sciences of
Geodesy (2010, 2012), as well as other scientiﬁc endeavours. In 2014 the author
moved from Germany to a position at Shandong University in Weihai to create a
new area of study comprising navigation, remote sensing, and celestial mechanics.
The rapid development of the GPS, GLONASS, Galileo, and BeiDou systems, and
the realisation of net-based multi-system real-time civil GNSS applications at GFZ
in Germany and at Shandong University, provided the impetus for this most recent
revision of the book. Dr.-Ing. Yan Xu, who has played an important role, was asked
to be the second author.
A fully new Chap. 12 has been added, which highlights the newly developed
singularity-free theory of analytical satellite orbits. A brief historical review of the
singularity problem is presented, and the solution is derived mathematically. The
vii

study was conducted by the ﬁrst author of this book with his friends from 2007 to
2015, and the most elegant formulas—the Lagrange-Xu and Gauss-Xu equations of
motion—were derived rigorously and mathematically and are described here for the
ﬁrst time. Three singularity criteria with clear geometric meaning are deﬁned. This
theory opened up a new area of study in orbit determination using analytical theory
and is believed to be extremely important with respect to GNSS applications for
onboard orbit determination.
Chapters that have been intensively revised and supplemented are the ﬁrst,
“Introduction”; the ﬁfth, “Physical Inﬂuences of GPS Surveying”; the eighth,
“Cycle Slip Detection and Ambiguity Resolution”; and the ninth, “Parameterisation
and Algorithms of GPS Data Processing”. The others are minorly revised. These are
reviews of the works of scientists around the world. The supplemented content
concerns the following 25 points.
1. Review of GPS modernisation
2. Review of the key developments of GLONASS
3. Review of the development of the Galileo system
4. Review of the development of the Compass (BeiDou) system
5. Review of progress in ionospheric studies
6. Review of tropospheric research
7. Research concerning the GPS clock
8. Review of the use of an external clock
9. Introduction of water vapour measurements
10. Review of activities involving GPS altimetry
11. Review of the study of GPS equivalence algorithms
12. The evaluation of ambiguity search criteria
13. Review of research progress in adaptive ﬁltering
14. Research on GPS data processing by combined and uncombined methods
15. Research on reference satellite changes in the GPS difference algorithm
16. Research on tropospheric models in airborne kinematic positioning
17. Research on reference station changes in the GPS difference algorithm
18. Review of ﬂoat ambiguity ﬁxing
19. Outline of the progress in precise point positioning
20. GPS software introduction
21. Review of satellite orbital theory
22. Review of numerical orbit determination
23. Summary of GEO satellite orbit determination
24. Research on independent parameterisation
25. Summary of problems remaining in GPS research
With such intensive content supplementation, the authors hope that this new
edition of GPS can better serve as a reference for GNSS research and study. The
theoretical contributions and new ﬁndings in the original edition of this book can be
summarised as follows:
1. The soft equivalence of differencing and undifferenced GPS algorithms
2. The uniﬁed GPS data processing algorithm
viii
Preface to the Third Edition

3. The general ambiguity search criterion
4. The equivalent ambiguity search criterion
5. The diagonalisation algorithm
6. Yang’s ﬁlter—adaptive robust Kalman ﬁltering
7. Theory of numerical orbit determination using GPS
8. The algebraic solution of the variation equation
9. The problem of the ambiguity function criterion
The new ﬁndings supplemented in the second edition are as follows:
1. The equivalence of combined and uncombined GPS algorithms
2. The independent parameterisation method
3. The equivalence theorem of GPS algorithms
4. The optimal differential GPS baseline network
5. The new model of solar radiation
6. The new model of atmospheric drag
New theoretical content in this third edition can be described as follows:
1. The equivalent equations of triple differences
2. The idea of an intelligent Kalman ﬁlter
3. Float ambiguity ﬁxing in the case of ionosphere-free combination
4. The singularity-free Lagrange-Xu equations of motion
5. The singularity-free Gauss-Xu equations of motion
6. The criteria of singularity and their geometric meaning
The extended content is derived in part from published international papers and
has been subjected to individual review. We thank Academician Yuanxi Yang
of the Institute of Surveying and Mapping in Xian, Prof. Ta-Kang Yeh of Taibei
University of Taiwan, Prof. Wu Chen of Hong Kong Polytech University, Prof.
Yunzhong Shen of TongJi University, and Prof. Zhiping Lv of the Institute of
Surveying and Mapping in Zhengzhou for their valuable review of portions of the
supplemented content of this book.
The ﬁrst author extends sincere thanks to Prof. Dr. D. Lelgemann of TU Berlin
for supervision of the author’s Ph.D. study and work many years ago. Thanks go to
the directors Prof. Dr. Ch. Reigber, Prof. Dr. Markus Rothacher, and Prof.
Dr. Harald Schuh of GFZ for their support and faith in the author during his
approximately 20 years of research activities at GFZ. Prof. Ming Li of the China
Academy of Space Technology (CAST) is thanked for the unwavering support
since the author’s involvement at CAST as Thousand Talents expert. Of course,
Shandong University at Weihai is thanked for the opportunity to develop a new
study area and form an international team, as well as obtaining internal and external
funding support. The second author is thanked for taking over most of the text
processing work for this new edition.
The navigation/remote sensing team members of Shandong University at Weihai
are thanked for their warm support. Special thanks go to Thousand Talents expert
Prof. Hermann Kaufmann of Germany, Guest Prof. Pierre Rochus of Belgium,
Preface to the Third Edition
ix

Guest Prof. Luisa Bastos of Portugal, Guest Prof. Anna Jenssen of Sweden, scientist
Nina Boesche, and guest engineer Nan Jiang of Germany, senior engineers Wenlin
Yan and Zhangzheng Sun, engineers Chunhua Jiang and Fangzhao Zhang,
post-doctoral researchers Yujun Du and Fang Gao, and Ph.D. candidate Wenfeng
Nie.
January 2016
Guochang Xu
Yan Xu
References
He KF (2015) GNSS Kinematic Position and Velocity Determination for Airborne Gravimetry. PhD
Thesis, (Scientiﬁc Technical Report; 15/04). Potsdam: Deutsches GeoForschungsZentrum GFZ.
http://doi.org/10.2312/GFZ.b103-15044
Wang Q, Xu G, Chen Z (2010) Interpolation Method of Tropospheric Delay of High Altitude
Rover Based on Regional GPS Network. Geomatics and Information Science of Wuhan
University, 35(12), 1405–1408
Xu G (1999): KGsoft – Kinematic GPS Software – Software User Manual, Version of 1999, Kort
& Matrikelstyrelsen (National Survey and Cadastre – Denmark), ISBN 87-7866-158-7, ISSN
0109-1344, 35 pages, in English
Xu G (2004) MFGsoft – Multi-Functional GPS/(Galileo) Software – Software User Manual,
(Version of 2004), Scientiﬁc Technical Report STR04/17 of GeoForschungsZentrum
(GFZ) Potsdam, ISSN 1610-0956, 70 pages, www.gfz-potsdam.de/bib/pub/str0417/0417.pdf
Xu G, Schwintzer P, Reigber Ch (1998) KSGSoft – Kinematic/Static GPS Software – Software user
manual (version of 1998). Scientiﬁc Technical Report STR98/19 of GeoForschungsZentrum
(GFZ) Potsdam
Xu G, Xu J (2012) On the Singularity Problem of Orbital Mechanics, MNRAS, 2013, Vol.429,
pp1139-1148
Xu G, Xu J (2013a) On Orbital Disturbance of Solar Radiation, MNRAS, 432 (1): 584-588
doi:10.1093/mnras/stt483
Xu G, Xu J (2013b) Orbits – 2nd Order Singularity-free Solutions, second edition, Springer
Heidelberg, ISBN 978-3-642-32792-6, 426 pages, in English
Xu G, Xu TH, Chen W, Yeh TK (2010b) Analytic Solution of Satellite Orbit Perturbed by
Atmospheric Drag, MNRAS, Vol. 410, Issue 1, pp 654-662 87.
Xu G, Xu TH, Yeh TK, Chen W (2010a) Analytic Solution of Satellite Orbit Perturbed by Lunar
and Solar Gravitation, MNRAS, Vol. 410, Issue 1, pp 645-653
Xu Y, Yang Y, Zhang Q, Xu G (2011) Solar Oblateness and Mercury’s Perihelion Precession,
MNRAS, Vol. 415, 3335-3343
x
Preface to the Third Edition

Preface to the Second Edition
After the ﬁrst edition of this book was published at the end of 2003, I was very
happy to put the hard work of book writing behind me and concentrate with my
small team on the development of multi-functional GPS/Galileo software
(MFGsoft). The experiences from the practice and implementation of the theory and
algorithms into high-standard software caused me to strongly feel that I would like
to revise and to supplement the original book, to modify some of the content, and to
report on the new developments and knowledge. Furthermore, with the EU Galileo
system now being realised and the Russian GLONASS system under development,
GPS theory and algorithms needed to be re-described so that they would be valid
for the Galileo and GLONASS systems as well. Therefore, I am grateful to all of the
readers of this book, whose interest led Springer to ask me to complete this second
edition.
I remember that I was in a hurry during the last check of the layout of the ﬁrst
edition. The description of a numerical solution to the variation equation in
Sect. 11.5.1 was added to the book at the last minute, and comprised exactly one
page. Traditionally, variation equations in orbit determination (OD), geopotential
mapping, and OD Kalman ﬁltering, have been solved by integration, which is
complicated and compute-intensive. This marks the ﬁrst time in the history of OD
that the variation equation is not integrated, but is solved by a linear algebraic
equation system. However, this was mentioned neither in the preface nor at the
beginning of the chapter. The high precision of this algebraic method is veriﬁed by
a numerical test.
The problems discussed in Chap. 12 of the ﬁrst edition are largely solved and are
now described by the so-called independent parameterisation theory, which points
out that in both undifferenced and differencing algorithms, the independent ambi-
guity vector is double-differencing. With the use of this parameterisation method,
the GPS observation equations are regular equations, and can be solved without any
a priori information. Many conclusions may be derived from this new knowledge.
For example, synchronisation of the GPS clocks may not be realised by the
carrier-phase observables because of the linear correlations between the clock error
xi

parameters and the ambiguities. The equivalence principle is extended to show that
the equivalences are valid not only between the undifferenced and differencing
algorithms, but also between uncombined and combining algorithms and their
mixtures. In other words, the GPS data processing algorithms are equivalent under
the same parameterisation of the observation model. Different algorithms are
beneﬁcial for different data processing purposes. One consequence of the equiva-
lence theory is that a so-called secondary data processing algorithm is created. Thus
the complete GPS positioning problem may be separated into two steps (ﬁrst to
transform the data to the secondary observables and then to process the secondary
data). Another consequence of the equivalence is that any GPS observation equa-
tion can be separated into two sub-equations, which is very advantageous in
practice. Furthermore, it shows that the combinations under traditional parameter-
isation
are
inexact
algorithms
compared
with
those
under
independent
parameterisation.
The additional content features a more detailed introduction, which includes not
only GPS developments, but also those of the EU Galileo and Russian GLONASS
systems, as well as the combination of the GPS, GLONASS, and Galileo systems.
The book thus covers the theory, algorithms, and applications of the GPS,
GLONASS, and Galileo systems. The equivalence of GPS data processing algo-
rithms and the independent parameterisation of GPS observation models is dis-
cussed in detail. Other new content includes the concept of optimal network
formation, application of the diagonalisation algorithm, and adjustment models of
radiation pressure and atmospheric drag, as well as discussions and comments of
what are currently, in the author’s opinion, key research problems. Application
of the theory and algorithms in the development of GPS/Galileo software is also
outlined. The content concerning the ambiguity search is reduced, whereas the
content regarding ionosphere-free ambiguity ﬁxing is cancelled out, although it was
reported by Lemmens (2004) as new. Some of the content of various sections has
also been reordered. In this way, I hope this edition may better serve as a reference
and handbook of GPS/Galileo research and applications.
The extended content is partly the result of the development of MFGsoft, and
has been subjected to individual review. I thank Prof. Lelgemann of the TU Berlin,
Prof. Yuanxi Yang of the Institute of Surveying and Mapping in Xian, Prof.
Ta-Kang Yeh of ChingYun University of Taiwan, and Prof. Yunzhong Shen of
TongJi University for their valuable reviews. I am grateful to Prof. Jiancheng Li and
Dr. Zhengtao Wang of Wuhan University, as well as Mr. Tinghao Xiao of Potsdam
University, for their cooperation during the development of the software from 2003
to 2004 at the GFZ.
I sincerely thank Prof. Dr. Markus Rothacher for his support and faith in me
during my research activities at the GFZ. I also thank Dr. Jinghui Liu of the
educational department of the Chinese Embassy in Berlin, Prof. Heping Sun and
Jikun Ou of IGG in Wuhan, and Prof. Qin Zhang of ChangAn University for their
warm support during my scientiﬁc activities in China. The Chinese Academy of
Sciences is thanked for the Outstanding Overseas Chinese Scholars Fund. During
this work, several interesting topics have been carefully studied by some of my
xii
Preface to the Second Edition

students. I am grateful to Ms. Daniela Morujao of Lisbon University, Ms. Jamila
Bouaicha of TU Berlin, Dr. Jiangfeng Guo and Ms. Ying Hong of IGG in Wuhan,
and Mr. Guanwen Huang of ChangAn University. I am also thankful for the
valuable feedback from readers and from students through my professorships at
ChangAn University and the IGG CAS.
June 2007
Guochang Xu
Preface to the Second Edition
xiii

Preface to the First Edition
The contents of this book cover static, kinematic, and dynamic GPS theory,
algorithms, and applications. Most of the content comes from the source code
descriptions of the Kinematic/Static GPS Software (KSGsoft), which was devel-
oped at GFZ before and during the EU AGMASCO project. The principles
described here have been largely applied in practice, and are carefully revised from
a theoretical perspective. A portion of the content is dealt with on a theoretical basis
and applied to the development of quasi-real-time GPS orbit determination software
at GFZ.
The original purpose in writing this book was, indeed, to have it for myself as a
GPS handbook and as a reference for a few of my friends and students who worked
with me in Denmark. The desire to describe the theory in an exact manner comes
from my mathematical education. My extensive geodetic research experience has
led to a detailed treatment of most topics. The comprehensiveness of the content
reﬂects my nature as a software designer.
Some of the results of research carried out in GFZ are published here for the ﬁrst
time. One example is the uniﬁed GPS data processing method using selectively
eliminated equivalent observation equations. Methods including zero-, single-,
double-, triple-, and user-deﬁned differential GPS data processing are uniﬁed in a
unique algorithm. This method has advantages of both un-differential and differential
methods, in that the un-correlation property of the original observations is retained,
and the unknown number may be greatly reduced. Another example is the general
criterion and its equivalent criterion for integer ambiguity search. A search using this
criterion can be carried out in ambiguity or coordinate domains, or both. The opti-
mality and uniqueness properties of the criterion are proved. Further examples
include the diagonalisation algorithm of the ambiguity search problem, the
ambiguity-ionospheric equations for ambiguity and ionosphere determination, and
the use of the differential Doppler equation as system equation in the Kalman ﬁlter.
The book includes 12 chapters. After a brief introduction, the coordinate and
time systems are described in the second chapter. Because orbit determination is
also an important topic of the book, the third chapter is dedicated to Keplerian
xv

satellite orbits. The fourth chapter deals with the GPS observables, including code
range, carrier phase, and Doppler measurements.
The ﬁfth chapter covers all physical inﬂuences on GPS observations, including
ionospheric, tropospheric, and relativistic effects, earth tide and ocean loading tide
effects, clock errors, antenna mass centre and phase centre corrections, multipath
effects, anti-spooﬁng, and historical selective availability, as well as instrumental
biases. Theories, models, and algorithms are discussed in detail.
The sixth chapter ﬁrst covers GPS observation equations, including their for-
mation, linearisation, related partial derivatives, and linear transformation and error
propagation. Useful data combinations are then discussed, particularly with respect
to the introduction of the concept of ambiguity-ionospheric equations and related
weight matrix. The equations include only ambiguity, ionospheric, and instrumental
error parameters and can also be solved independently in kinematic applications.
Traditional differential GPS observation equations, including the differential
Doppler equations, are also discussed in detail. The method of selectively elimi-
nated equivalent observation equations is proposed to unify the un-differential and
differential GPS data processing methods.
The seventh chapter covers all adjustment and ﬁltering methods that are suitable
and necessary for GPS data processing. The main adjustment methods described are
classical, sequential, block-wise, and conditional least squares. The key ﬁltering
methods include classical and robust ﬁltering, as well as adaptively robust Kalman
ﬁlters. In addition, a priori constraints, a priori datum, and quasi-stable datum
methods are discussed for dealing with rank-deﬁcient problems. The theoretical
basis of equivalently eliminated equations is derived in detail.
The eighth chapter is dedicated to cycle slip detection and ambiguity resolution.
Several cycle slip detection methods are outlined, with emphasis on deriving a
general criterion for integer ambiguity search in ambiguity or coordinate domains,
or both. Although the criterion is derived from conditional adjustment, in the end, it
has nothing to do with any condition. An equivalent criterion is also derived, and
shows that the well-known least squares ambiguity search criterion is just one of the
terms of the equivalent criterion. A diagonalisation algorithm is proposed for use
with ambiguity search, which can be done within one second after the normal
equation is diagonalised. The ambiguity function and ﬂoat ambiguity ﬁxing
methods are also outlined.
The ninth chapter describes GPS data processing in static and kinematic appli-
cations, and data pre-processing is outlined. Emphasis is given to solving the
ambiguity-ionospheric equations and single point positioning, relative positioning,
and velocity determination using code, phase, and combined data. The equivalent
un-differential and differential data processing methods are discussed, and a method
of Kalman ﬁltering using velocity information is described. The accuracy of the
observational geometry is outlined at the end of the chapter.
The tenth chapter covers the concepts of kinematic positioning and ﬂight-state
monitoring. The use of the IGS station, multiple static references, airport height
information, kinematic tropospheric modelling, and the known distances of the
xvi
Preface to the First Edition

multiple antennas on aircraft are discussed in detail. Numerical examples are also
given.
The 11th chapter deals with the topic of perturbed orbit determination. Perturbed
equations of satellite motion are derived, and perturbation forces of satellite motion
are discussed in detail, including the earth’s gravitational ﬁeld, earth tide and ocean
tide, the sun, moon, and planets, solar radiation pressure, atmospheric drag, and
coordinate perturbation. Orbit correction is outlined based on the analytical solution
of C20 perturbation. Precise orbit determination is also discussed, including its
principle and related derivatives, as well as numerical integration and interpolation
algorithms.
The ﬁnal chapter is a brief discussion regarding the future of GPS and comments
on some remaining problems.
The book was subjected to an individual review of chapters and sections or
according to content. I am grateful to reviewers Prof. Lelgemann of the Technical
University (TU) Berlin, Prof. Leick of the University of Maine, Prof. Rizos of the
University of New South Wales (UNSW), Prof. Grejner-Brzezinska of Ohio State
University, Prof. Yuanxi Yang of the Institute of Surveying and Mapping in Xian,
Prof. Jikun Ou of the Institute of Geodesy and Geophysics (IGG) in Wuhan, Prof.
Wu Chen of Hong Kong Polytechnic University, Prof. Jiancheng Li of Wuhan
University, Dr. Chunfang Cui of TU Berlin, Dr. Zhigui Kang of the University of
Texas at Austin, Dr. Jinling Wang of UNSW, Dr. Yanxiong Liu of GFZ,
Mr. Shfaqat Khan of KMS of Denmark, Mr. Zhengtao Wang of Wuhan University,
and Dr. Wenyi Chen of the Max-Planck Institute of Mathematics in Sciences
(Leipzig, Germany). The book was subjected to a general review by Prof.
Lelgemann of TU Berlin. A grammatical check of technical English writing was
performed by Springer-Verlag Heidelberg.
I offer my sincere thanks to Prof. Dr. Ch. Reigber for his support and faith in me
throughout my scientiﬁc research activities at GFZ. Dr. Niels Andersen, Dr. Per
Knudsen, and Dr. Rene Forsberg at KMS of Denmark are thanked for their support
for starting work on this book, and Prof. Lelgemann of TU Berlin for his
encouragement and help. During this work, many valuable discussions were held
with many specialists. My thanks go to Prof. Grafarend of the University Stuttgart,
Prof. Tscherning of Copenhagen University, Dr. Peter Schwintzer of GFZ,
Dr. Luisa Bastos of the Astronomical Observatory of University Porto, Dr. Oscar
Colombo of Maryland University, Dr. Detlef Angermann of German Geodetic
Research Institute Munich, Dr. Shengyuan Zhu of GFZ, Dr. Peiliang Xu of the
University Kyoto, Prof. Guanyun Wang of IGG in Wuhan, Dr. Ludger Timmen
of the University of Hannover, and Ms. Daniela Morujao of Coimbra University.
I thank Dr. Jürgen Neumeyer of GFZ and Dr. Heping Sun of IGG in Wuhan for
their support. Dipl.-Ing. Horst Scholz of TU Berlin is thanked for redrawing a
portion of the graphics. I am also grateful to Dr. Engel of Springer-Verlag
Heidelberg for his advice.
Preface to the First Edition
xvii

I thank my wife Liping, son Jia, and daughters Yuxi and Pan for their loving
support and understanding, as well as for their help on part of the text processing
and graphing.
March 2003
Guochang Xu
xviii
Preface to the First Edition

Contents
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
1.1
A Key Note on GPS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
2
1.1.1
GPS Modernization . . . . . . . . . . . . . . . . . . . . . . . . .
4
1.2
A Brief Message About GLONASS . . . . . . . . . . . . . . . . . . . .
7
1.2.1
The Development of GLONASS . . . . . . . . . . . . . . . .
7
1.3
Basic Information on Galileo. . . . . . . . . . . . . . . . . . . . . . . . .
9
1.3.1
The Development of Galileo . . . . . . . . . . . . . . . . . . .
10
1.4
Introduction of BeiDou. . . . . . . . . . . . . . . . . . . . . . . . . . . . .
11
1.4.1
The Development of BeiDou. . . . . . . . . . . . . . . . . . .
12
1.5
A Combined Global Navigation Satellite System . . . . . . . . . . .
13
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2
Coordinate and Time Systems . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.1
Geocentric Earth-Fixed Coordinate Systems . . . . . . . . . . . . . .
17
2.2
Coordinate System Transformations . . . . . . . . . . . . . . . . . . . .
21
2.3
Local Coordinate System . . . . . . . . . . . . . . . . . . . . . . . . . . .
22
2.4
Earth-Centred Inertial Coordinate System . . . . . . . . . . . . . . . .
24
2.5
IAU 2000 Framework. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
28
2.6
Geocentric Ecliptic Inertial Coordinate System. . . . . . . . . . . . .
32
2.7
Time Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
36
3
Satellite Orbits. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3.1
Keplerian Motion. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
37
3.1.1
Satellite Motion in the Orbital Plane. . . . . . . . . . . . . .
40
3.1.2
Keplerian Equation. . . . . . . . . . . . . . . . . . . . . . . . . .
44
3.1.3
State Vector of the Satellite. . . . . . . . . . . . . . . . . . . .
46
3.2
Disturbed Satellite Motion. . . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.3
GPS Broadcast Ephemerides . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.4
IGS Precise Ephemerides . . . . . . . . . . . . . . . . . . . . . . . . . . .
51
3.5
GLONASS Ephemerides. . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
xix

3.6
Galileo Ephemerides. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
3.7
BDS Ephemerides . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53
4
GPS Observables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
4.1
Code Pseudoranges . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
55
4.2
Carrier Phases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
57
4.3
Doppler Measurements . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
59
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
5
Physical Inﬂuences of GPS Surveying . . . . . . . . . . . . . . . . . . . . . .
63
5.1
Ionospheric Effects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
5.1.1
Code Delay and Phase Advance. . . . . . . . . . . . . . . . .
63
5.1.2
Elimination of Ionospheric Effects . . . . . . . . . . . . . . .
66
5.1.3
Ionospheric Models . . . . . . . . . . . . . . . . . . . . . . . . .
69
5.1.4
Mapping Functions. . . . . . . . . . . . . . . . . . . . . . . . . .
73
5.1.5
Introduction of Commonly Used Ionospheric
Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
76
5.2
Tropospheric Effects. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
5.2.1
Tropospheric Models . . . . . . . . . . . . . . . . . . . . . . . .
81
5.2.2
Mapping Functions and Parameterisation. . . . . . . . . . .
85
5.2.3
Introduction of Commonly Used Tropospheric
Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
5.2.4
Tropospheric Model for Airborne Kinematic
Positioning . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
5.2.5
Water Vapour Research with Ground-Based GPS
Measurement. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93
5.3
Relativistic Effects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
94
5.3.1
Special Relativity and General Relativity. . . . . . . . . . .
94
5.3.2
Relativistic Effects on GPS . . . . . . . . . . . . . . . . . . . .
97
5.4
Earth Tide and Ocean Loading Tide Corrections . . . . . . . . . . .
99
5.4.1
Earth Tide Displacements of GPS Stations . . . . . . . . .
99
5.4.2
Simpliﬁed Model of Earth Tide Displacements . . . . . .
101
5.4.3
Numerical Examples of Earth Tide Effects . . . . . . . . .
103
5.4.4
Ocean Loading Tide Displacement . . . . . . . . . . . . . . .
105
5.4.5
Computation of the Ocean Loading Tide
Displacement. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
108
5.4.6
Numerical Examples of Loading Tide Effects . . . . . . .
109
5.5
Clock Errors . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
110
5.5.1
Introduction of Commonly Used Clock
Error Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
112
5.5.2
Impact of Frequency Reference of a GPS Receiver
on the Positioning Accuracy . . . . . . . . . . . . . . . . . . .
114
xx
Contents

5.6
Multipath Effects . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
115
5.6.1
GPS Altimetry, Signals Reﬂected from the Earth’s
Surface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
117
5.6.2
Reﬂecting Point Positioning. . . . . . . . . . . . . . . . . . . .
117
5.6.3
Image Point and Reﬂecting Surface Determination . . . .
119
5.6.4
Research Activities in GPS Altimetry . . . . . . . . . . . . .
120
5.7
Anti-spooﬁng and Selective Availability Effects. . . . . . . . . . . .
121
5.8
Antenna Phase Centre Offset and Variation . . . . . . . . . . . . . . .
122
5.9
Instrumental Biases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
126
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
127
6
GPS Observation Equations and Equivalence Properties . . . . . . . .
133
6.1
General Mathematical Models of GPS Observations . . . . . . . . .
133
6.2
Linearisation of the Observation Model . . . . . . . . . . . . . . . . .
135
6.3
Partial Derivatives of Observation Function. . . . . . . . . . . . . . .
137
6.4
Linear Transformation and Covariance Propagation . . . . . . . . .
141
6.5
Data Combinations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
142
6.5.1
Ionosphere-Free Combinations. . . . . . . . . . . . . . . . . .
144
6.5.2
Geometry-Free Combinations. . . . . . . . . . . . . . . . . . .
145
6.5.3
Standard Phase–Code Combination . . . . . . . . . . . . . .
148
6.5.4
Ionospheric Residuals . . . . . . . . . . . . . . . . . . . . . . . .
149
6.5.5
Differential Doppler and Doppler Integration . . . . . . . .
150
6.6
Data Differentiations. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
152
6.6.1
Single Differences . . . . . . . . . . . . . . . . . . . . . . . . . .
153
6.6.2
Double Differences. . . . . . . . . . . . . . . . . . . . . . . . . .
156
6.6.3
Triple Differences. . . . . . . . . . . . . . . . . . . . . . . . . . .
158
6.7
Equivalence of the Uncombined and Combining
Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
160
6.7.1
Uncombined GPS Data Processing Algorithms . . . . . .
161
6.7.2
Combining Algorithms of GPS Data Processing. . . . . .
163
6.7.3
Secondary GPS Data Processing Algorithms . . . . . . . .
168
6.7.4
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
171
6.8
Equivalence of Undifferenced and Differencing Algorithms . . . .
172
6.8.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
172
6.8.2
Formation of Equivalent Observation Equations. . . . . .
173
6.8.3
Equivalent Equations of Single Differences . . . . . . . . .
175
6.8.4
Equivalent Equations of Double Differences . . . . . . . .
179
6.8.5
Equivalent Equations of Triple Differences . . . . . . . . .
181
6.8.6
Method of Dealing with the Reference Parameters . . . .
182
6.8.7
Summary of the Uniﬁed Equivalent Algorithm . . . . . .
183
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
184
Contents
xxi

7
Adjustment and Filtering Methods . . . . . . . . . . . . . . . . . . . . . . . .
187
7.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
187
7.2
Least Squares Adjustment . . . . . . . . . . . . . . . . . . . . . . . . . . .
187
7.2.1
Least Squares Adjustment with Sequential
Observation Groups . . . . . . . . . . . . . . . . . . . . . . . . .
189
7.3
Sequential Least Squares Adjustment . . . . . . . . . . . . . . . . . . .
191
7.4
Conditional Least Squares Adjustment . . . . . . . . . . . . . . . . . .
193
7.4.1
Sequential Application of Conditional Least Squares
Adjustment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
195
7.5
Block-Wise Least Squares Adjustment . . . . . . . . . . . . . . . . . .
196
7.5.1
Sequential Solution of Block-Wise Least Squares
Adjustment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
198
7.5.2
Block-Wise Least Squares for Code–Phase
Combination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
200
7.6
Zhou’s Theory: Equivalently Eliminated Observation
Equation System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
201
7.6.1
Zhou–Xu’s Theory: Diagonalised Normal Equation
and the Equivalent Observation Equation . . . . . . . . . .
204
7.7
Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
206
7.7.1
Classic Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . .
206
7.7.2
Kalman Filter: A General Form of Sequential Least
Squares Adjustment . . . . . . . . . . . . . . . . . . . . . . . . .
208
7.7.3
Robust Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . .
209
7.7.4
Yang’s Filter: Adaptively Robust Kalman Filtering . . .
212
7.7.5
Progress in Adaptively Robust Filter Theory
and Application . . . . . . . . . . . . . . . . . . . . . . . . . . . .
216
7.7.6
A Brief Introduction to the Intelligent
Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
218
7.8
A Priori Constrained Least Squares Adjustment . . . . . . . . . . . .
218
7.8.1
A Priori Parameter Constraints. . . . . . . . . . . . . . . . . .
219
7.8.2
A Priori Datum . . . . . . . . . . . . . . . . . . . . . . . . . . . .
220
7.8.3
Zhou’s Theory: Quasi-Stable Datum. . . . . . . . . . . . . .
222
7.9
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
224
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
226
8
Cycle Slip Detection and Ambiguity Resolution . . . . . . . . . . . . . . .
229
8.1
Cycle Slip Detection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
229
8.2
Method of Dealing with Cycle Slips. . . . . . . . . . . . . . . . . . . .
231
8.3
A General Criterion of Integer Ambiguity Search. . . . . . . . . . .
231
8.3.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
231
8.3.2
Summary of Conditional Least Squares Adjustment . . .
232
8.3.3
Float Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
234
8.3.4
Integer Ambiguity Search in Ambiguity Domain . . . . .
235
8.3.5
Integer Ambiguity Search in Coordinate
and Ambiguity Domains . . . . . . . . . . . . . . . . . . . . . .
236
xxii
Contents

8.3.6
Properties of Xu’s General Criterion. . . . . . . . . . . . . .
238
8.3.7
An Equivalent Ambiguity Search Criterion
and Its Properties . . . . . . . . . . . . . . . . . . . . . . . . . . .
239
8.3.8
Numerical Examples of the Equivalent Criterion . . . . .
242
8.3.9
Conclusions and Comments. . . . . . . . . . . . . . . . . . . .
244
8.4
Ambiguity Resolution Approach Based on the General
Criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
245
8.5
Ambiguity Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
247
8.5.1
Xu’s Conjecture: Maximum Property of Ambiguity
Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
248
8.6
Ionosphere-Free Ambiguity Fixing . . . . . . . . . . . . . . . . . . . . .
251
8.6.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
251
8.6.2
Concept of Ionospheric Ambiguity Correction . . . . . . .
253
8.6.3
Determination of the Ionospheric Ambiguity
Correction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
256
8.6.4
Integer Ambiguity Fixing Through
Ambiguity-Ionospheric Equations. . . . . . . . . . . . . . . .
257
8.6.5
Float Ambiguity Fixing. . . . . . . . . . . . . . . . . . . . . . .
257
8.7
PPP Ambiguity Fixing . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
257
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
259
9
Parameterisation and Algorithms of GPS Data Processing . . . . . . .
263
9.1
Parameterisation of the GPS Observation Model . . . . . . . . . . .
263
9.1.1
Evidence of the Parameterisation Problem
of the Undifferenced Observation Model . . . . . . . . . . .
264
9.1.2
A Method of Uncorrelated Bias Parameterisation . . . . .
265
9.1.3
Geometry-Free Illustration. . . . . . . . . . . . . . . . . . . . .
271
9.1.4
Correlation Analysis in the Case of Phase–Code
Combinations . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
272
9.1.5
Conclusions and Comments. . . . . . . . . . . . . . . . . . . .
273
9.2
Equivalence of the GPS Data Processing Algorithms . . . . . . . .
274
9.2.1
Equivalence Theorem of GPS Data Processing
Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
275
9.2.2
Optimal Baseline Network Forming
and Data Condition . . . . . . . . . . . . . . . . . . . . . . . . .
277
9.2.3
Algorithms Using Secondary GPS Observables . . . . . .
279
9.2.4
Simpliﬁed Equivalent Representation of GPS
Observation Equations . . . . . . . . . . . . . . . . . . . . . . .
280
9.3
Non-equivalent Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . .
287
9.4
Reference Changing in GPS Difference Algorithm . . . . . . . . . .
287
9.4.1
Changing Reference Satellite . . . . . . . . . . . . . . . . . . .
287
9.4.2
Changing Reference Station. . . . . . . . . . . . . . . . . . . .
288
9.5
Standard Algorithms of GPS Data Processing . . . . . . . . . . . . .
291
9.5.1
Preparation of GPS Data Processing . . . . . . . . . . . . . .
291
Contents
xxiii

9.5.2
Single Point Positioning . . . . . . . . . . . . . . . . . . . . . .
292
9.5.3
Standard Un-differential GPS Data Processing . . . . . . .
297
9.5.4
Equivalent Method of GPS Data Processing . . . . . . . .
300
9.5.5
Relative Positioning . . . . . . . . . . . . . . . . . . . . . . . . .
301
9.5.6
Velocity Determination . . . . . . . . . . . . . . . . . . . . . . .
302
9.5.7
Kalman Filtering Using Velocity Information . . . . . . .
305
9.6
Accuracy of the Observational Geometry . . . . . . . . . . . . . . . .
306
9.7
Introduction to the Real-Time Positioning System . . . . . . . . . .
308
9.7.1
Network RTK . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
308
9.7.2
PPP-RTK . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
311
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
311
10
Applications of GPS Theory and Algorithms. . . . . . . . . . . . . . . . .
313
10.1
Software Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
313
10.1.1
Functional Library . . . . . . . . . . . . . . . . . . . . . . . . . .
313
10.1.2
Data Platform . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
318
10.1.3
A Data Processing Core . . . . . . . . . . . . . . . . . . . . . .
320
10.2
Introduction of GPS Software . . . . . . . . . . . . . . . . . . . . . . . .
321
10.3
Concept of Precise Kinematic Positioning and Flight-State
Monitoring . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
323
10.3.1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
324
10.3.2
Concept of Precise Kinematic Positioning . . . . . . . . . .
326
10.3.3
Concept of Flight-State Monitoring . . . . . . . . . . . . . .
330
10.3.4
Results, Precision Estimation, and Comparisons. . . . . .
333
10.3.5
Conclusions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
338
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
339
11
Perturbed Orbit and Its Determination. . . . . . . . . . . . . . . . . . . . .
341
11.1
Perturbed Equation of Satellite Motion . . . . . . . . . . . . . . . . . .
341
11.1.1
Lagrangian Perturbed Equation of Satellite Motion. . . .
342
11.1.2
Gaussian Perturbed Equation of Satellite Motion . . . . .
345
11.2
Perturbation Forces of Satellite Motion . . . . . . . . . . . . . . . . . .
348
11.2.1
Perturbation of the Earth’s Gravitational Field . . . . . . .
348
11.2.2
Perturbations of the Sun, the Moon,
and the Planets . . . . . . . . . . . . . . . . . . . . . . . . . . . .
353
11.2.3
Earth Tide and Ocean Tide Perturbations . . . . . . . . . .
354
11.2.4
Solar Radiation Pressure . . . . . . . . . . . . . . . . . . . . . .
358
11.2.5
Atmospheric Drag . . . . . . . . . . . . . . . . . . . . . . . . . .
362
11.2.6
Additional Perturbations . . . . . . . . . . . . . . . . . . . . . .
365
11.2.7
Order Estimations of Perturbations . . . . . . . . . . . . . . .
367
11.2.8
Ephemerides of the Moon, the Sun, and Planets. . . . . .
368
11.3
Analysis Solution of the C20 Perturbed Orbit. . . . . . . . . . . . . .
372
11.4
Orbit Correction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
379
11.5
Principle of GPS Precise Orbit Determination . . . . . . . . . . . . .
383
11.5.1
Xu’s Algebraic Solution to the Variation Equation . . . .
385
xxiv
Contents

11.6
Numerical Integration and Interpolation Algorithms . . . . . . . . .
387
11.6.1
Runge–Kutta Algorithm . . . . . . . . . . . . . . . . . . . . . .
387
11.6.2
Adams Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . .
391
11.6.3
Cowell Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . .
394
11.6.4
Mixed Algorithms and Discussions . . . . . . . . . . . . . .
396
11.6.5
Interpolation Algorithms . . . . . . . . . . . . . . . . . . . . . .
397
11.7
Orbit-Related Partial Derivatives . . . . . . . . . . . . . . . . . . . . . .
398
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
407
12
Singularity-Free Orbit Theory . . . . . . . . . . . . . . . . . . . . . . . . . . .
409
12.1
A Brief Historical Review of the Singularity Problem. . . . . . . .
409
12.2
On the Singularity Problem in Orbital Mechanics. . . . . . . . . . .
412
12.2.1
Basic Lagrangian and Gaussian Equations
of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
412
12.2.2
Solving Algorithm for the Singularity Problem . . . . . .
417
12.2.3
Xu’s Criteria for Singularity . . . . . . . . . . . . . . . . . . .
418
12.2.4
Derivation of Lagrange-Xu Equations of Motion . . . . .
419
12.2.5
Derivation of Gauss Equations from Lagrange
Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
429
12.2.6
Derivation of Gauss-Xu Equations of Motion . . . . . . .
431
12.3
Bridge Between Analytical Theory and Numerical
Integration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
434
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
435
13
Discussions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
439
13.1
Independent Parameterisation and A Priori Information. . . . . . .
439
13.2
Equivalence of the GPS Data Processing Algorithms . . . . . . . .
441
13.3
Other Comments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
442
Appendix A: IAU 1980 Theory of Nutation . . . . . . . . . . . . . . . . . . . . . 445
Appendix B: Numerical Examples of the Diagonalisation
of the Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 449
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 455
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 483
Contents
xxv

Abbreviations and Constants
Abbreviations
AF
Ambiguity Function
AS
Anti-Spooﬁng
AU
Astronomical Units
C/A
Coarse Acquisition
CAS
Chinese Academy of Sciences
CIO
Conventional International Origin
CHAMP
Challenging Mini-Satellite Payload
CRF
Conventional Reference Frame
CTS
Conventional Terrestrial System
DD
Double Difference
DGK
Deutsche Geodätische Kommission
DGPS
Differential GPS
DOP
Dilution of Precision
ECEF
Earth-Centred Earth-Fixed (system)
ECI
Earth-Centred Inertial (system)
ECSF
Earth-Centred Space-Fixed (system)
ESA
European Space Agency
EU
European Union
Galileo
Global Navigation Satellite System of the EU
GAST
Greenwich Apparent Sidereal Time
GDOP
Geometric Dilution of Precision
GFZ
GeoForschungsZentrum Potsdam
GIS
Geographic Information System
GLONASS
Global Navigation Satellite System of Russia
GLOT
GLONASS Time
GMST
Greenwich Mean Sidereal Time
GNSS
Global Navigation Satellite System
GPS
Global Positioning System
xxvii

GPST
GPS Time
GRACE
Gravity Recovery and Climate Experiment
GRS
Geodetic Reference System
GST
Galileo System Time
GXu
Guochang Xu, ﬁrst author of this and other books
HDOP
Horizontal Dilution of Precision
IAG
International Association of Geodesy
IAT
International Atomic Time
IAU
International Astronomical Union
IERS
International Earth Rotation Service
IGS
International GPS Geodynamics Service
INS
Inertial Navigation System
ION
Institute of Navigation
ITRF
IERS Terrestrial Reference Frame
IUGG
International Union for Geodesy and Geophysics
JD
Julian Date
JPL
Jet Propulsion Laboratory
KMS
National Survey and Cadastre (Denmark)
KSGsoft
Kinematic/Static GPS Software
LEO
Low-Earth Orbit (satellite)
LS
Least Squares (adjustment)
LSAS
Least Squares Ambiguity Search (criterion)
MEO
Medium-Earth Orbit (satellite)
MFGsoft
Multi-Functional GPS/Galileo Software
MIT
Massachusetts Institute of Technology
MJD
Modiﬁed Julian Date
NASA
National Aeronautics and Space Administration
NAVSTAR
Navigation System with Time and Ranging
NGS
National Geodetic Survey
OD
Orbit Determination
OTF
On-the-Fly
PC
Personal Computer
PDOP
Position Dilution of Precision
PRN
Pseudorandom Noise
PZ-90
Parameters of the Earth Year 1990
RINEX
Receiver Independent Exchange (format)
RMS
Root Mean Square
RTK
Real-Time Kinematic
SA
Selective Availability
SC
Semicircles
SD
Single Difference
SINEX
Software Independent Exchange (format)
SLR
Satellite Laser Ranging
SNR
Signal-to-Noise Ratio
SST
Satellite–Satellite Tracking
xxviii
Abbreviations and Constants

SV
Space Vehicle
TAI
International Atomic Time
TD
Triple Difference
TDB
Barycentric Dynamic Time
TDOP
Time Dilution of Precision
TDT
Terrestrial Dynamic Time
TEC
Total Electron Content
TJD
Time of Julian Date
TOPEX
(Ocean) Topography Experiment
TOW
Time of Week
TRANSIT
Time Ranging and Sequential
TT
Terrestrial Time
UT
Universal Time
UTC
Coordinated Universal Time
UTCSU
Moscow Time UTC
VDOP
Vertical Dilution of Precision
WGS
World Geodetic System
ZfV
Zeitschrift für Vermessungswesen
Constants
Symbol
Value
Unit
Explanation
cf.
ae
6,378,137
m
Semi-major axis of WGS-84
§2.1
fe
1/298.2572236
Flattening factor of WGS-84
§2.1
ap
6,378,136
m
Semi-major axis of PZ-90
§2.1
fp
1/298.2578393
Flattening factor of PZ-90
§2.1
aeI
6,378,136.54
m
Semi-major axis of ITRF-96
§2.1
feI
1/298.25645
Flattening factor of ITRF-96
§2.1
ε
84,381.''412
Obliquity of the ecliptic at J2000.0
§2.4
JDGPS
2,444,244.5
JD
Julian Date of GPS standard epoch
(1980 Jan. 6, 0 h)
§2.6
JD2000.0
2,451,545.0
JD
Julian Date of 2000 January 1, 12 h
§2.6
G
6.67259e–11
m3s−2kg−1
Constant of gravitation
§3.1
μe
3.986004418e14
m3s−2
Geocentric gravitational constant
§3.1
ωe
7.292115e–5
rads−1
Nominal mean angular velocity
of the earth
§3.3
c
299,792,458
ms−1
Speed of light
§4.1
μs
1.327124e20
m3s−2
Heliocentric gravitational constant
§5.4
μm
μe(M/Me)
m3s−2
Gravitational constant of the moon
§5.4
M/Me
0.0123000345
Moon–Earth mass ratio
§5.4
(continued)
Abbreviations and Constants
xxix

(continued)
Symbol
Value
Unit
Explanation
cf.
h2, h3
0.6078, 0.292
Love number
§5.4
l2
0.0847
Shida number
§5.4
f0
10.23
MHz
Fundamental frequency of GPS
§8.5
f1
154f0
MHz
First carrier frequency of GPS
§8.5
λ1
19.029
cm
Wavelength of f1
§8.5
f2
120f0
MHz
Second carrier frequency of GPS
§8.5
λ2
24.421
cm
Wavelength of f2
§8.5
f5
115f0
MHz
Third carrier frequency of GPS
§8.5
λ5
25.482
cm
Wavelength of f5
§8.5
Ps
4.5605e–6
Nm−1
Luminosity of the sun
§11.2
as
1.0000002AU
m
Semi-major axis of the orbit of the
sun
§11.2
AU
149597870691
m
Astronomical units
§11.2
am
384,401,000
m
Semi-major axis of the orbit of the
moon
§11.2
fg1
1602
MHz
First carrier frequency of
GLONASS
§1.2
Δfg1
0.5625
MHz
First carrier frequency interval of
GLONASS
§1.2
fg2
1246
MHz
Second carrier frequency of
GLONASS
§1.2
Δfg2
0.4375
MHz
Second carrier frequency interval
of GLONASS
§1.2
xxx
Abbreviations and Constants

Chapter 1
Introduction
The Global Positioning System (GPS) is a navigation system based on satellite
technology. Its fundamental technique involves measuring the ranges between the
receiver and a few simultaneously observed satellites, and the positions of the
satellites are forecasted and broadcasted along with the GPS signal to the user.
Through several known positions (of the satellites) and the measured distances
between the receiver and the satellites, the position of the receiver can be deter-
mined. The position change, which can also be determined, is then the velocity of
the receiver. The most important applications of GPS are positioning and
navigation.
Through its evolution over the past few decades, GPS has now come to be
known even by school children. It has been extensively applied in several areas,
including air, sea, and land navigation, low-earth orbit (LEO) satellite orbit deter-
mination, static and kinematic positioning, and ﬂight-state monitoring, as well as
surveying. Its wide utility has made GPS a necessity for industry, research, edu-
cation, and daily life.
For example, joggers wishing to determine their location using a GPS watch can
do so very simply, merely by pressing a key. The underlying principles of such an
application, however, are complex, and include knowledge of electronics, orbital
mechanics, atmospheric science, geodesy, relativity theory, mathematics, adjust-
ment and ﬁltering, and software engineering. Many scientists and engineers have
devoted efforts toward making GPS theory easier to understand and its applications
more precise.
Galileo is the European global positioning system, and GLONASS is the
Russian system. In China, the BeiDou Navigation Satellite System has undergone
rapid development in recent years. The positioning and navigation principles of
these systems are nearly the same as those of the US GPS system. With very few
exceptions, GPS theory and algorithms can be directly used for the Galileo,
GLONASS, and BeiDou systems. The global navigation satellite system (GNSS)
of the future will likely feature a combination of the GPS, GLONASS, Galileo, and
BeiDou systems.
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_1
1

In order to describe the distance measurement using a mathematical model,
coordinates, and time systems, the orbital motion of the satellite and GPS observa-
tions must be discussed (Chaps. 2–4). The physical inﬂuences on GPS measurement
such as ionospheric and tropospheric effects also must be dealt with (Chap. 5).
Linearised observation equations can then be formed using various methods, such as
data combination and differentiation as well as the equivalent technique (Chap. 6).
The equation system may be full-rank or rank-deﬁcient and may need to be solved in
a post-processing or a quasi-real-time way, so the various adjustment and ﬁltering
methods shall be discussed (Chap. 7). For precise GPS applications, phase obser-
vations must be used, and therefore the ambiguity problem must be dealt with
(Chap. 8). The algorithms of parameterisation and the equivalence theorem as well as
standard algorithms of GPS data processing can then be discussed (Chap. 9).
Applications of GPS theory and algorithms to GPS/Galileo software development
will be sequentially outlined, and the concept of precise kinematic positioning and
ﬂight-state monitoring from practical experience will be present (Chap. 10). The
theory of dynamic GPS applications for perturbed orbit determination based on the
above-referenced theory will then be described (Chap. 11). Singularity-free orbits
theory will be outlined and discussed for the purpose of a combined analytical and
numerical orbit determination (Chap. 12). Discussions and comments will be pre-
sented in the ﬁnal chapter. Thus the contents and structure of this book are organised
in a logical sequence.
The book covers kinematic, static, and dynamic GPS theory and algorithms.
Most of the content is reﬁned theory that has been applied to the independently
developed scientiﬁc GPS software, KSGSoft (Kinematic and Static GPS Software)
and MFGSoft (Multi-Functional GPS/Galileo Software), and which was obtained
from extensive research on individual problems. Because of our strong research and
application background, we are able to describe complex theories comfortably and
with conﬁdence. A brief summary of the contents is given in the preface.
Numerous GPS and GPS-related books are frequently quoted and carefully
studied. Some of these are strongly suggested for further reading, e.g., Bauer
(1994), Hofmann-Wellenhof et al. (2001), King et al. (1987), Kleusberg and
Teunissen (Eds.) (1996), Leick (1995), Liu et al. (1996), Parkinson and Spilker
(Eds.) (1996), Remondi (1984), Seeber (1993), Strang and Borre (1997), Wang
et al. (1988), Xu (1994), Xu (2003b, 2007, 2008, 2010, 2012), Xu and Xu (2013).
1.1
A Key Note on GPS
The US Global Positioning System was designed and built and is operated and
maintained by the US Department of Defense (cf., e.g., Parkinson and Spilker
1996). The ﬁrst GPS satellite was launched in 1978, and the system was fully
operational by the mid-1990s. The GPS constellation consists of 24 satellites in six
2
Chapter 1  Introduction

orbital planes, with four satellites in each plane. The ascending nodes of the orbital
planes are equally spaced 60° apart, and the orbital planes are inclined at 55°.
Each GPS satellite is in a nearly circular orbit, with a semi-major axis of 26,578 km
and a period of about 12 h. The satellites continuously orient themselves to ensure
that their solar panels stay pointed toward the sun and their antennas toward the
earth. Each satellite carries four atomic clocks, is roughly the size of a car, and
weighs about 1000 kg. The long-term frequency stability of the clocks reaches
better than a few parts in 10−13 over the course of a day (cf. Scherrer 1985). The
atomic clocks aboard the satellite produce the fundamental L-band frequency,
10.23 MHz.
The GPS satellites are monitored by ﬁve base stations. The main base station is
in Colorado Springs, CO, and the other four are located on Ascension Island
(Atlantic Ocean), Diego Garcia (Indian Ocean), Kwajalein, and Hawaii (both
Paciﬁc Ocean). All stations are equipped with precise caesium clocks and receivers
to determine the broadcast ephemerides and to model the satellite clocks.
Ephemerides and clock adjustments are transmitted to the satellites, which in turn
use these updates in the signals that they send to GPS receivers.
Each GPS satellite transmits data on three frequencies: L1 (1575.42 MHz), L2
(1227.60 MHz), and L5 (1176.45 MHz). The L1, L2, and L5 carrier frequencies
are generated by multiplying the fundamental frequency by 154, 120, and 115,
respectively. Pseudorandom noise (PRN) codes, along with satellite ephemerides,
ionospheric models, and satellite clock corrections are superimposed onto the
carrier frequencies L1, L2, and L5. The measured transmission times of the signals
that travel from the satellites to the receivers are used to compute the pseudoranges.
The course/acquisition (C/A) code, sometimes called the Standard Positioning
Service (SPS), is a pseudorandom noise code that is modulated onto the L1 carrier.
The precision (P) code, sometimes called the Precise Positioning Service (PPS), is
modulated onto the L1, L2, and L5 carriers, allowing for the removal of the effects
of the ionosphere.
GPS was conceived as a ranging system from known positions of satellites in
space to unknown positions on land and sea, as well as in air and space. The orbits
of the GPS satellites are available by broadcast or by the International Geodetic
Service (IGS) . IGS orbits are precise ephemerides after post-processing or
quasi-real-time processing. All GPS receivers have an almanac programmed into
their computer, which tells them where each satellite is at any given moment. The
almanac is a data ﬁle containing information on orbits and clock corrections for all
satellites. It is transmitted by a GPS satellite to a GPS receiver, where it facilitates
rapid satellite vehicle acquisition within the GPS receivers. The GPS receivers
detect, decode, and process the signals received from the satellites to create the data
for code, phase, and Doppler observables. The data may be available in real time or
saved for downloading. The receiver internal software is usually used to process the
real-time data with the single point positioning method and to output the infor-
mation to the user. Because of the limitation of the receiver software, precise
positioning and navigating are usually carried out by an external computer with
1.1  A Key Note on GPS
3

more powerful software. The fundamental contribution of GPS for users of the
system is to inform them of their location, movements, and timing.
As the GPS technology has moved into the civilian sector, its applications have
become almost limitless, and understanding GPS has become a necessity.
1.1.1
GPS Modernization
GPS modernization is an ongoing effort to upgrade with new, advanced capabilities
to meet growing military, civil, and commercial needs (GPS.gov 2015). A major
focus of the GPS modernization program is the addition of new navigation signals
to the satellite constellation. The program also involves a series of consecutive
satellite acquisitions (Shaw 2011) and improvements to the GPS control segment
(Bailey 2014). The speciﬁc initiatives involved in GPS modernization include the
following.
Ending Selective Availability
The ﬁrst step in the GPS modernization program occurred in May 2000, when
the use of Selective Availability (SA) was ended. SA was an intentional degradation
of civilian GPS accuracy implemented on a global basis from the GPS satellites.
Prior to its deactivation, civil GPS readings could be off by up to 100 m. After SA
was turned off, civil GPS accuracy was instantly improved by an order of magni-
tude, beneﬁting civil and commercial users worldwide.
In September 2007, the US government announced its decision to procure the
future generation of GPS satellites, known as GPS III, without the SA feature. This
makes the policy decision of 2000 permanent and eliminates a source of uncertainty
in GPS performance that had been of concern to civil GPS users worldwide.
New Civil Signals
The central focus of the GPS modernization program is the addition of new
navigation signals to the satellite constellation (Enge 2003). Three new signals are
designed for civilian use: L2C, L5, and L1C. The legacy civil signal, called L1 C/A
or C/A at L1, will continue broadcasting in the future, for a total of four civil GPS
signals. The new signals are phasing in incrementally as new GPS satellites are
launched to replace older ones. Most of the new signals will be of limited use until
they are broadcast from 18 to 24 satellites.
L2C is the second civilian GPS signal, designed speciﬁcally to meet commercial
needs. When combined with L1 C/A in a dual-frequency receiver, L2C enables
ionospheric correction. Civilians with dual-frequency GPS receivers can achieve
the same accuracy as the military. L2C delivers faster signal acquisition, enhanced
4
Chapter 1  Introduction

reliability, and greater operating range. It also broadcasts at a higher effective power
than the legacy L1 C/A signal, making it easier to receive under trees and even
indoors.
L5 is the third civilian GPS signal, broadcast in a radio band reserved exclu-
sively for aviation safety services. With protected spectrum, higher power, greater
bandwidth features, L5 is designed to support safety-of-life transportation and other
high-performance applications. It will provide users worldwide with the most
advanced civilian GPS signal. In combination with L1 C/A, L5 will be used to
improve accuracy through ionospheric correction and robustness via signal
redundancy. When used in combination with L1 C/A and L2C, L5 will provide a
highly robust service.
L1C is the fourth civilian GPS signal, designed to enable interoperability
between GPS and international satellite navigation systems. The design will
improve mobile GPS reception in cities and other challenging environments.
Japan’s Quasi-Zenith Satellite System (QZSS), the Indian Regional Navigation
Satellite System (IRNSS), and China’s BeiDou system also adopt L1C-like signals
for international interoperability.
New GPS Satellites
The GPS constellation is a mix of new and legacy satellites. And the GPS
modernization program involves a series of consecutive satellite acquisitions,
including GPS IIR(M), GPS IIF, and GPS III.
The IIR(M) series of satellites is an upgraded version of the IIR series, com-
pleting the backbone of today’s GPS constellation. The new civil and military GPS
signal known as L2C is added to this generation of spacecraft. It has a 7.5-year
design lifespan. It was launched in 2005–2009, and there are seven healthy IIR(M)
satellites in the GPS constellation.
The IIF series expands on the capabilities of the IIR(M) series with the addition
of a third civil signal on the L5 frequency for safety-of-life transportation appli-
cations. Compared to previous generations, GPS IIF satellites have a longer life
expectancy and a higher accuracy requirement. Each spacecraft uses advanced
atomic clocks. The IIF series will improve the accuracy, signal strength, and quality
of GPS. It has a 12-year design lifespan. It was launched in 2010, and there are ten
operational IIF satellites in the GPS constellation.
The III series is the most currently developed and the newest block of GPS
satellites, adding a fourth civil signal on L1 (L1C). GPS III will provide more
powerful signals in addition to enhanced signal reliability, accuracy, and integrity,
all of which will support position, navigation, and timing services. It has a 15-year
design lifespan and is planned to begin launching in 2016.
The Control Segment Upgrades
As part of the GPS modernization program, the GPS control segment has been
continuously upgraded, including the Legacy Accuracy Improvement Initiative
(L-AII); Architecture Evolution Plan (AEP); Launch and early orbit, Anomaly
1.1  A Key Note on GPS
5

resolution, and Disposal Operations (LADO); Next Generation Operational Control
System (OCX), and Launch Checkout Capability (LCC).
The L-AII, completed in 2008, expanded the number of monitoring sites in the
operational control segment from 6 to 16, which is a 10–15 % improvement in the
accuracy of the information broadcast from the GPS constellation. Ten operational
GPS monitoring sites were added to help deﬁne the earth reference frame used by
GPS.
In September 2007, the original legacy master control station was upgraded to an
entirely new one. The AEP improved the ﬂexibility and responsiveness of GPS
operations and paved the way forward for the next generation of GPS space and
control capabilities. AEP improves both monitoring stations and ground antennas,
substantially improving the sustainability and accuracy of GPS. AEP is capable of
managing all satellites in the constellation, including the new Block IIF satellites. It
also features an alternate master control station, a fully operational backup for the
master control station.
The GPS master control station can command and control a constellation of up
to 32 satellites. The LADO system serves three primary functions. The ﬁrst is
telemetry, tracking, and control. The second is the planning and execution of
satellite movements during LADO. The third function is LADO simulation of
different telemetry tasks for GPS payloads and subsystems. The LADO system has
been upgraded several times since 2007. In October 2010, a new version adding
GPS Block IIF capability was accepted, following testing during the launch of the
ﬁrst GPS IIF satellite.
The OCX was developed in 2008, and will add many new capabilities to the
GPS control segment, including the ability to fully control the modernized civil
signals (L2C, L5, and L1C). It will be delivered in increments. OCX Block 1 will
replace the existing command and control segment and support the mission oper-
ations of the initial GPS III satellites. This version will introduce the full capabilities
of the L2C navigation signal. OCX Block 1 is scheduled to enter service in 2016.
OCX Block 2 will support, monitor, and control additional navigation signals,
including L1C and L5. OCX Block 3 will support new capabilities added to future
versions of GPS III. Any increments beyond OCX Block 3 will be phased to
support future satellite generations.
The LCC is a command and control centre that will check out all GPS III
satellites. The LCC will be fully integrated with OCX, which will allow the
operation of a single OCX-centric system that can sustain the GPS constellation
from launch to disposal. The LCC component of OCX will be delivered prior to
OCX Block 1 in order to support the launch and check out of the ﬁrst GPS III
satellite, scheduled for launch in 2015. The LCC will ensure a timely launch so
constellation availability remains optimal and not impacted by the late discovery of
problems.
6
Chapter 1  Introduction

1.2
A Brief Message About GLONASS
GLONASS is the GNSS managed by the Russian Space Forces and is operated by
the Coordination Scientiﬁc Information Centre (KNITs) of the Russian Defence
Ministry. The system is comparable to the US GPS, and the two systems share the
same principles of data transmission and positioning methods. The ﬁrst GLONASS
satellite was launched into orbit in 1982. The system consists of 21 satellites in
three orbital planes, with three in-orbit spares. The ascending nodes of the three
orbital planes are separated by 120°, and the satellites within the same orbital plane
are equally spaced 45° apart. The difference in arguments of latitude for satellites in
equivalent slots in two different orbital planes is 15°. Each satellite operates in
nearly circular orbit, with a semi-major axis of 25,510 km. Each orbital plane has
an inclination angle of 64.8°, and each satellite completes an orbit in approximately
11 h 16 min.
Caesium clocks are used on board the GLONASS satellites. The stability of the
clocks reaches better than a few parts in 10−13 over a day. The satellites transmit
coded signals in two frequencies located on two frequency bands, 1602–
1615.5 MHz and 1246–1256.5 MHz, with a frequency interval of 0.5625 and
0.4375 MHz, respectively. The antipodal satellites, which are separated by 180° in
the same orbital plane in argument of latitude, transmit on the same frequency. The
signals can be received by users anywhere on the earth’s surface to identify their
position and velocity in real time based on ranging measurements. Coordinate and
time systems used in GLONASS are different from those of the US GPS, and
GLONASS satellites are distinguished by slightly different carrier frequencies
rather than PRN codes. The ground control stations of GLONASS are maintained
only in the territory of the former Soviet Union, for historical reasons. This lack of
global coverage is not optimal for the monitoring of a GNSS.
GLONASS and GPS are not entirely compatible; however, they are generally
interoperable. Combining the GLONASS and GPS resources will beneﬁt the GNSS
user community not only in increased accuracy, but also in higher system integrity
on a worldwide basis.
1.2.1
The Development of GLONASS
GLONASS is once again approaching full operation (Urlichich et al. 2011).
Twenty-four satellites are currently in service, providing continuous global cov-
erage (Mirgorodskaya 2013; Testoyedov 2015). These are modernized GLONASS
or GLONASS-M satellites, transmitting the legacy frequency division multiple
access (FDMA) navigation signals in the L1 and L2 frequency bands.
1.2  A Brief Message About GLONASS
7

The structure of the navigation signals transmitted by the satellites determines
the accuracy of the pseudorange measurements and affects a user’s position ac-
curacy. Evolution of the GLONASS navigation signals is a top priority for overall
system development. A new version of the satellites, GLONASS-K, will broadcast
a code division multiple access (CDMA) signal in the L3 band for the ﬁrst time in
the system’s history. In addition to the change in signal parameters, new navigation
information will be transmitted to users through this signal and will also become
available in the L1 and L2 bands (Urlichich et al. 2010, 2011). The evolution of
GNSS augmentation is another important aspect in the development of GLONASS.
The Russian satellite-based augmentation system (SBAS) and the System for
Differential Correction and Monitoring (SDCM) are in the deployment phase. Thus,
interoperability and compatibility with other SBASs become important.
Navigation Signals
The main aspect for GLONASS development is an extension of the ensemble of
navigation signals (Revnivykh 2007). This extension means that new CDMA
signals in the L1, L2, and L3 bands are being added to the existing FDMA signals.
The GLONASS satellites will continue to broadcast the legacy signals until the last
receiver stops working.
The ﬁrst phase in the implementation of CDMA technology on GLONASS-K
satellites includes a new signal in the L3 band on a carrier frequency of
1202.025 MHz. The ranging code chipping rate for the CDMA signal is 10.23
megachips per second with a period of 1 ms. It is modulated onto the carrier using
quadrature phase-shift keying (QPSK), with an in-phase data channel and a
quadrature pilot channel.
GLONASS Augmentation Development
SDCM has been under development since 2002. The main elements of the
system, including the network of reference stations in Russia and abroad, the central
processing facility (CPF), and the SDCM information distribution channel, have
been designed.
Ground Stations. The SDCM uses 14 monitoring stations in Russia and two in
Antarctica. Eight more monitoring stations are being added in Russia and several
more outside Russia (Revnivykh 2010).
Central Processing. Raw measurements (GLONASS and GPS L1 and L2
pseudorange and carrier phase measurements) from the ground stations come to the
SDCM CPF. The CPF calculates the precise satellite ephemerides and clocks,
controls integrity, and generates the SBAS messages. The format of these messages
is compliant with the international standards also used by the Wide Area
Augmentation System (WAAS), the European Geostationary Navigation Overlay
Service (EGNOS), and the Japanese Multifunctional Transport Satellite (MTSAT)
Satellite Augmentation System (MSAS).
Format Limitations. The current SBAS format has limited capacity for broad-
casting corrections for GLONASS and GPS satellites combined. There is space for
8
Chapter 1  Introduction

only 51 satellites, insufﬁcient for the current number of satellites in orbit, and
studies are looking into the efﬁciency of SDCM data broadcasting in an attempt to
resolve this contradiction. The three main options involve using a dynamic satellite
mask, using two CDMA signals, or providing an additional SBAS message.
Distribution. The main advantage of SBAS is its universal space channel to
users. The SDCM orbit constellation will consist of three geostationary satellites
from the multifunctional space relay system Luch, which will be used to relay
communications between low earth-orbiting spacecraft and ground facilities in
Russia. The satellites will also include transponders for relaying SDCM signals
from CPF to users.
The development of GLONASS is entering a new historical phase. New CDMA
navigation signals and deployment of a national SBAS system will provide not only
a new quality of navigation service, but the basis for a regional precise navigation
system with an accuracy of a few decimetres for users in Russia and neighbouring
countries.
1.3
Basic Information on Galileo
Galileo is a GNSS created by the European Union (EU) and the European Space
Agency (ESA) to provide a highly accurate, guaranteed global positioning service
under civilian control (cf., e.g., ESA homepage). While it is designed as an inde-
pendent navigation system, Galileo will nonetheless be interoperable with the other
two global satellite navigation systems, GPS and GLONASS. A user will be able to
position with the same receiver from any of the satellites in any combination.
Galileo will guarantee availability of service with higher accuracy.
The ﬁrst Galileo satellite, 2.7 × 1.2 × 1.1 m in size and weighing 650 kg, was
launched in December 2005. The Galileo constellation consists of 30 Medium Earth
orbit (MEO) satellites in three orbital planes with nine equally spaced operational
satellites in each plane plus one inactive spare satellite. The ascending nodes of the
orbital planes are equally spaced by 120°. The orbital planes are inclined 56°. Each
Galileo satellite is in a nearly circular orbit, with a semi-major axis of 29,600 km
(cf. ESA homepage) and a period of about 14 h. The Galileo satellite rotates about
its earth-pointing axis such that the ﬂat surface of the solar array always faces the
sun to collect maximum solar energy. The deployed solar array spans 13 m. The
antennas always point toward the earth. Once the fully deployed Galileo system is
achieved, the Galileo navigation signals will provide good coverage even at lati-
tudes up to 75°N. The large number of satellites together with the carefully opti-
mised constellation design, plus the availability of the three active spare satellites,
will ensure that the loss of one satellite has no discernible effect on the user.
1.2  A Brief Message About GLONASS
9

The Galileo satellite has four clocks, two of each type (passive maser and
rubidium, stabilities: 0.45 and 1.8 ns over 12 h, respectively). At any time, only one
of each type is operational. The operating maser clock produces the reference
frequency from which the navigation signal is generated. If the maser clock were to
fail, the operating rubidium clock takes over instantaneously, and the two reserve
clocks start up. The second maser clock takes the place of the rubidium clock after a
few days when it is fully operational. The rubidium clock then goes on stand-by or
reserve again. In this way, the Galileo satellite is guaranteed to generate a navi-
gation signal at all times.
Galileo will provide ten navigation signals in right-handed circular polarization
(RHCP) in the frequency ranges 1164–1215 MHz (E5a and E5b), 1215–1300 MHz
(E6), and 1559–1592 MHz (E2-L1-E1) (cf. Hein et al. 2004). The interoperability
and compatibility of Galileo and GPS is realized by having two common centre
frequencies in E5a/L5 and L1 as well as adequate geodetic coordinate and time
reference frames.
1.3.1
The Development of Galileo
On 21 October 2011, the ﬁrst two of four satellites designed to validate the Galileo
concept both in space and on land became operational. Two more followed on 12
October 2012. This in-orbit validation (IOV) phase is now followed by additional
satellite launches to reach initial operational capability (IOC) by mid-decade
(Blanchard 2012). Galileo services will come with quality and integrity guarantees,
marking the key difference of this ﬁrst complete civil positioning system from the
military systems that have come before. A range of services will be extended as the
system is built up from IOC to reach full operational capability (FOC) by 2020.
Two Galileo Control Centres (GCCs) have been implemented in Europe to
provide control of the satellites and to perform navigation mission management.
The data provided by a global network of Galileo Sensor Stations (GSSs) will be
sent to the GCCs through a redundant communications network. The GCCs will use
the data from the sensor stations to compute the integrity information and to syn-
chronise the time signal of all satellites with the ground station clocks. The
exchange of data between the control centres and the satellites will be performed
through up-link stations.
As an additional feature, Galileo provides a global search and rescue
(SAR) function, based on the operational Cospas-Sarsat system (Bosco 2011). To
do so, satellites are equipped with a transponder, which is able to transfer the
distress signals from the user transmitters to regional rescue coordination centres,
which will then initiate the rescue operation. At the same time, the system will send
a response signal to the user, informing them that their situation has been detected
and that help is on the way. This latter feature is new and is considered a major
10
Chapter 1  Introduction

upgrade compared to the existing system, which does not provide feedback to the
user (cf. ESA homepage 2015).
1.4
Introduction of BeiDou
The BeiDou Navigation Satellite System (BDS) , also known as BeiDou-2, is
China’s second-generation satellite navigation system that will be capable of pro-
viding positioning, navigation, and timing services to users on a continuous
worldwide basis (ESA Navipedia 2014).
BDS consists of three major components: the space constellation, the ground
control segment and the user segment. The space constellation consists of ﬁve GEO
satellites, 27 MEO satellites, and three IGSO satellites. The GEO satellites are
positioned at 58.75°E, 80°E, 110.5°E, 140°E, and 160°E, respectively. The MEO
satellites operate in orbit at an altitude of 21,500 km and an inclination of 55° and
are evenly distributed in three orbital planes. The IGSO satellites operate in orbit at
an altitude of 36,000 km and an inclination of 55° and are evenly distributed in
three IGSO planes. The tracks of sub-satellite points for those IGSO satellites
coincide, with the intersection point at a longitude of 118°E, and a phase difference
of 120°. The ground control segment consists of a Master Control Station (MCS),
Time Synchronization/Upload Stations (TS/US), and Monitor Stations (MS). The
main tasks of MCS are collecting observational data from each MS, processing
data, generating satellite navigation messages, uploading navigation messages,
monitoring satellite payload, performing mission planning and scheduling, and
conducting system operation and control. The main tasks of TS/US are uploading
navigation messages, exchanging data with MCS, and carrying out time synchro-
nization and measurement under the general coordination of MCS. The main tasks
of MS are the continuous tracking and monitoring of navigation satellites, receiving
navigation signals, and providing observational data to the MCS for generating
navigation messages. Three signals are designed for use: B1, B2, and B3. The user
segment encompasses various BeiDou user terminals, including those compatible
with other navigation satellite systems, to meet various application requirements
from different ﬁelds and industries.
The BeiDou Time (BDT) system is used as the time reference for BDS, and the
China Geodetic Coordinate System 2000 (CGCS2000) is used as the coordinate
framework of BDS. Upon full system completion, BDS can provide positioning,
velocity measurement, and timing services to users worldwide. It can also provide
wide area differential services with accuracy of better than 1 m, as well as short
message services with a capacity of 120 Chinese characters per message.
1.3  Basic Information on Galileo
11

1.4.1
The Development of BeiDou
BDS is steadily accelerating construction based on a “three-step” development
strategy as follows:
Step I
BeiDou
Navigation
Satellite
Demonstration
System.
The
BeiDou
Navigation Satellite Demonstration System consists of three major
components: the space constellation, the ground control segment, and the
user segment. The space constellation includes three GEO satellites,
positioned at 80°E, 110.5°E, and 140°E, respectively, above the equator.
The ground control segment consists of the ground control centre and a
number of calibration stations. The ground control centre completes
satellite orbit determination, ionospheric correction, user location deter-
mination, and user short message information exchanging and processing.
The calibration stations mainly provide the distance measurement and six
correction parameters to the ground control centre. The user segment
includes hand-held type, vehicle type, command type, and other types of
terminals, which are capable of sending positioning requests and
receiving location information.
Step II
BDS regional services. In 2004, China initiated the construction of the
BeiDou Navigation Satellite System. By the end of 2012, BDS consisted
of 14 operational satellites in orbit, including ﬁve GEO satellites, ﬁve
IGSO satellites, and four MEO satellites, and possessed FOC for China
and the surrounding areas.
Step III
BDS global services. From 2014, additional satellites were launched,
while regional service performances are advanced and expanded to the
worldwide scope. Approximately 40 BeiDou navigation satellites in total
will have been launched by about 2020, and the system with global
coverage will be fully established.
Currently, BDS is under continuous and stable operation. As of 25 October
2012, 16 BeiDou navigation satellites had been launched to form the constellation,
and they had entered into operation by the end of 2012. It possesses FOC and
provides continuous passive positioning, navigation, and timing services to China
and surrounding areas (China Satellite Navigation Ofﬁce 2013).
Along with the construction of BDS and the development of service capabilities,
BDS has been widely applied in many ﬁelds including transportation, marine
ﬁsheries, disaster forecasting, weather forecasting, forest ﬁre prevention, time
synchronization for telecommunication systems, power distribution, and disaster
relief and reduction.
12
Chapter 1  Introduction

1.5
A Combined Global Navigation Satellite System
With the development of the Galileo and BeiDou systems, the GPS and GLONASS
systems now face direct competition. Without a doubt, this has a positive inﬂuence
on the modernisation of the GPS system and the further development of the
GLONASS system. Multiple navigation systems operating independently help
increase awareness and accuracy of real-time positioning and navigation. The
GNSS of the future will inevitably comprise a combined system featuring an
aggregation of the GPS, GLONASS, Galileo, and BeiDou systems. A constellation
of hundreds of satellites among the four systems greatly increases the visibility of
the satellites, especially in critical areas such as urban canyons. Many studies on
multi-GNSS combinations have been conducted in recent years (Wang et al. 2001;
Cai and Gao 2013; Li et al. 2015). It is expected that multi-GNSS combinations will
signiﬁcantly increase the number of observed satellites, optimize spatial geometry
and the dilution of precision, and improve convergence, accuracy, continuity, and
reliability. However, a minimum requirement for fusion of multi-GNSS data is the
calibration of inter-system biases (ISB). Research related to ISB estimation and its
applications, as well as ISB modelling, has been brought to the forefront recently
(cf. e.g., Jiang et al. 2016).
Because GPS, GLONASS, Galileo, and BeiDou are independent systems, their
time and coordinate systems differ. The four time systems are all based on UTC,
and the four coordinate systems are all Cartesian systems; therefore, their rela-
tionships can be determined, and any system can be transformed from one to
another. The origins of the GPS and GLONASS coordinates are meters apart from
each other. The origins of GPS and Galileo coordinates have differences of a few
centimetres. The GPS and BeiDou coordinates have the same origin. Several carrier
frequencies are used in each system for the removal of the effects of the ionosphere.
The frequency differences within the GLONASS system and between the GPS,
GLONASS, Galileo, and BeiDou systems are generally not a serious problem if the
carrier phase observables are considered distance surveys by multiplying the
wavelength. Table 1.1 summarizes the frequencies each GNSS constellation used.
Table 1.1 Frequencies of each GNSS constellation
GNSS
system
Frequency band
Frequency (MHz)
GPS
L1/L2/L5
1575.42/1227.60/1176.45
GLONASS
G1/G2/G3
1602 + n*9/16
1246 + n*716
1202.025
n = −7 * +12
Galileo
E1/E5a/E5b/E5
(E5a + E5b)/E6
1575.42/1176.45/1207.140/1191.795/1278.75
BDS
B1/B2/B3
1561.098/1207.14/1268.52
1.5  A Combined Global Navigation Satellite System
13

In the present edition of this book, the theory and algorithms of GPSs will be
discussed in more general terms in order to take into account the differences among
the GPS, GLONASS, Galileo, and BeiDou systems.
References
Bailey Brian K (2014) GPS Modernization Update. June 2014.
Bauer M (1994) Vermessung und Ortung mit Satelliten. Wichmann Verlag, Karslruhe
Blanchard D (2012) Galileo Programme Status Update. ION GNSS 2012, November 20,
pp553-587
Bosco M (2011) The European GNSS Programmes EGNOS and Galileo International Challenges
Ahead. November 23, 2011.
Cai C, Gao Y (2013) Modeling and assessment of combined GPS/GLONASS precise point
positioning. GPS Solutions 17(2), 223-236.
China Satellite Navigation Ofﬁce (2013) Report on the Development of BeiDou (COMPASS)
Navigation Satellite System (V2.2). December 2013.
Enge P (2003) GPS Modernization: Capabilities of New Civil Signals. Australian International
Aerospace Congress, Brisbane, 29 July-1 August 2003.
ESA (2015) http://www.esa.int/Our_Activities/Navigation/The_future_-_Galileo/What_is_Galileo.
ESA Navipedia (2014) http://www.navipedia.net/index.php/BeiDou_General_Introduction.
GPS.gov, National Coordination Ofﬁce for Space-Based Positioning, Navigation and Timing
(2015) GPS Modernization, http://www.gps.gov/systems/gps/modernization/
Hein GW, Irsigler M, Avila-Rodriguez JA, Pany T (2004) Performance of Galileo L1 Signal
Candidates. Proc. ENC-GNSS 2004, Rotterdam, The Netherlands, May 2004.
Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997, 2001) GPS theory and practice.
Springer-Press, Wien
Jiang N, Xu Y, Xu T, Xu G, Sun Z, Schuh H (2016) GPS/BDS short-term ISB modelling and
prediction. GPS Solutions, DOI: 10.1007/s10291-015-0513-x
King RW, Masters EG, Rizos C, Stolz A, Collins J (1987) Surveying with Global Positioning
System. Dümmler-Verlag, Bonn
Kleusberg A, Teunissen PJG (eds) (1996) GPS for geodesy. Springer-Verlag, Berlin
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York
Li X, Zhang X, Ren X, Fritsche M, Wickert J, Schuh H (2015) Precise positioning with current
multi-constellation Global Navigation Satellite Systems: GPS, GLONASS, Galileo and
BeiDou. Scientiﬁc reports 5, 8328.
Liu DJ, Shi YM, Guo JJ (1996) Principle of GPS and its data processing. TongJi University Press,
Shanghai, (in Chinese)
Mirgorodskaya T (2013) GLONASS Government Policy, Status and Modernization Plans. IGNSS
2013, Gold Coast, Queensland, Australia, July 16, 2013.
Parkinson BW, Spilker JJ (eds) (1996) Global Positioning System: Theory and applications, Vol. I,
II. American Institute of Aeronautics and Astronautics, Progress in Astronautics and
Aeronautics, Vol. 163
Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative
geodesy: Modelling, processing, and results. University of Texas at Austin, Center for Space
Research
Revnivykh S (2007) GLONASS Status, Development and Application. International Committee
on Global Navigation Satellite Systems (ICG), Bangalore, India, September 4-7, 2007.
Revnivykh S (2010) GLONASS Status and Progress. ION GNSS 2010, Portland, Oregon,
September 21-24, 2010.
14
Chapter 1  Introduction

Scherrer R (1985) The WM GPS primer. WM Satellite Survey Company, Wild, Herrbrugg,
Switzerland
Seeber G (1993) Satelliten-Geodaesie. Walter de Gruyter 1989
Shaw M (2011) GPS Modernization: On the Road to the Future GPS IIR / IIR-M and GPS III. UN/
UAE/ US Workshop On GNSS Applications, Dubai, 2011.
Strang G, Borre K (1997) Linear algebra, geodesy, and GPS. Wellesley-Cambridge Press
Testoyedov N (2015) Space Navigation in Russia: History of Development. United Nations /
Russian Federation Workshop on the Applications of Global Navigation Satellite Systems,
Krasnoyarsk, May 18-22, 2015.
Urlichich Y, Subbotin V, Stupak G, et al. (2010) GLONASS Developing Strategy. ION GNSS
2010, the 23rd International Technical Meeting of the Institute of Navigation, Portland, Oregon,
September 21-24, 2010.
Urlichich Y, Subbotin V, Stupak G, et al. (2011) Innovation: GLONASS Developing strategies for
the Future, GPS World, April, pp42-49
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese)
Wang J, Rizos C, Stewart MP, Leick A (2001) GPS and GLONASS integration-Modeling and
Ambiguity Resolution Issues. GPS Solutions 5(1), 55-64.
Xu
QF
(1994)
GPS
navigation
and
precise
positioning.
Army
Press,
Peking,
ISBN
7-5065-0855-9/P.4, (in Chinese)
Xu G (2003a) A diagonalization algorithm and its application in ambiguity search. J. GPS 2(1):
35-41
Xu G (2003b) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English
Xu G (2007) GPS – Theory, Algorithms and Applications, second edition, Springer Heidelberg,
ISBN 978-3-540-72714-9, 350 pages, in English
Xu G (2008) Orbits, Springer Heidelberg, ISBN 978-3-540-78521-7, 230 pages, in English
Xu G (2010) (Ed.): Sciences of Geodesy - I, Advances and Future Directions, Springer Heidelberg,
chapter topics (authors): Aerogravimetry (R Forsberg), Superconducting Gravimetry (J
Neumeyer), Absolute and Relative Gravimetry (L Timmen), Deformation and Tectonics (L
Bastos et al.), Analytic Orbit Theory (G Xu), InSAR (Y Xia), Marine Geodesy (J Reinking),
Kalman Filtering (Y Yang), Equivalence of GPS Algorithms (G Xu et al.), Earth Rotation (F
Seitz, H Schuh), Satellite Laser Ranging (L Combrinck), in English, 507 pages
Xu G (2012) (Ed.): Sciences of Geodesy - II, Advances and Future Directions, Springer
Heidelberg, chapter topics (authors): General Relativity and Space Geodesy (L Comblinck),
Global Terrestrial Reference Systems and their Realizations (D Angermann et al), Ocean Tide
Loading (M Bos, HG Scherneck), Photogrammetry (P Redweik), Regularization and
Adjustment (Y Shen, G Xu), Regional Gravity Field Modelling (H Denker), VLBI (H
Schuh, J Boehm), in English, 400 pages
Xu G, Xu J (2013) Orbits – 2nd Order Singularity-free Solutions, second edition, Springer
Heidelberg, ISBN 978-3-642-32792-6, 426 pages, in English
References
15

Chapter 2
Coordinate and Time Systems
GPS satellites orbit the earth over time. GPS surveys are conducted mostly on land.
To describe the GPS observation (distance) as a function of GPS orbit (satellite
position) and the measuring position (station location), suitable coordinate and time
systems must be deﬁned.
2.1
Geocentric Earth-Fixed Coordinate Systems
The Earth-Centred Earth-Fixed (ECEF) coordinate system is useful for describing
the location of a station on the earth’s surface. This system is a right-handed
Cartesian system (x, y, z). Its origin and the earth’s centre of mass coincide, while
its z-axis and the mean rotational axis of the earth coincide; the x-axis points to the
mean Greenwich meridian, while the y-axis is directed to complete a right-handed
system (cf. Fig. 2.1). In other words, the z-axis points to a mean pole of the earth’s
rotation. The mean pole, deﬁned by international convention, is called the
Conventional International Origin (CIO). Then the xy-plane is called mean equa-
torial plane, and the xz-plane is called mean zero-meridian.
The ECEF coordinate system is also known as the Conventional Terrestrial
System (CTS). The mean rotational axis and mean zero-meridian used here are
necessary. The true rotational axis of the earth changes its direction with respect to
the earth’s body all the time. If such a pole were used to deﬁne a coordinate system,
the coordinates of the station would also be continuously changing. Because the
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_2
17

survey is made in our true world, the polar motion obviously must be taken into
account, and this will be discussed later.
Of course, the ECEF coordinate system can be represented by a spherical
coordinate system (r, ϕ, λ), where r is the radius of the point (x, y, z), and ϕ and λ
are the geocentric latitude and longitude, respectively (cf. Fig. 2.2). λ is counted
eastward from the zero-meridian. The relationship between (x, y, z) and (r, ϕ, λ) is
obvious:
x
y
z
0
@
1
A ¼
r cos / cos k
r cos / sin k
r sin /
0
@
1
A;
or
r ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2 þ z2
p
tan k ¼ y=x
tan / ¼ z=
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2
p
8
<
:
:
ð2:1Þ
An ellipsoidal coordinate system (φ, λ, h) may also be deﬁned based on the
ECEF coordinates; however, geometrically, two additional parameters are needed
to deﬁne the shape of the ellipsoid (cf. Fig. 2.3). φ, λ, and h are geodetic latitude,
longitude, and height, respectively. The ellipsoidal surface is a rotational ellipse.
Fig. 2.1 Earth-centred
earth-ﬁxed coordinates
Fig. 2.2 Cartesian and
spherical coordinates
18
Chapter 2  Coordinate and Time Systems

The ellipsoidal system is also called the geodetic coordinate system. Geocentric
longitude and geodetic longitude are identical. The two geometric parameters can
be the semi-major radius (denote by a) and the semi-minor radius (denote by b) of
the rotating ellipse, or the semi-major radius and the ﬂattening (denote by f) of the
ellipsoid. They are equivalent sets of parameters. The relationship between (x, y,
z) and (φ, λ, h) is (cf., e.g., Torge 1991):
x
y
z
0
@
1
A ¼
ðN þ hÞ cos u cos k
ðN þ hÞ cos u sin k
ðNð1  e2Þ þ hÞ sin u
0
@
1
A;
ð2:2Þ
or
tan u ¼
zﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2
p
1  e2
N
N þ h

1
tan k ¼ y
x
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2
p
cos u
 N
8
>
>
>
<
>
>
>
:
;
ð2:3Þ
where
N ¼
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2 sin2 u
p
:
ð2:4Þ
N is the radius of curvature in the prime vertical, and e is the ﬁrst eccentricities. The
geometric meaning of N is shown in Fig. 2.4. In Eq. 2.3, φ and h must be solved by
iteration; however, the iteration process converges quickly, since h ≪N. The
ﬂattening and the ﬁrst eccentricities are deﬁned as:
Fig. 2.3 Ellipsoidal
coordinate system
2.1  Geocentric Earth-Fixed Coordinate Systems
19

f ¼ a  b
a
;
and
e ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
a2  b2
p
a
:
ð2:5Þ
In cases where φ = ±90° or h is very large, the iteration formulas of Eq. 2.3 are
unstable. Alternatively, using (cf. Lelgemann 2002)
ctan u ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2
p
z þ Dz ;
Dz ¼ e2N sin u ¼
ae2 sin u
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2 sin2 u
p
;
may lead to a stably iterated result of φ. Δz and e2N are the lengths of OB and AB
(cf. Fig. 2.4), respectively. h can be obtained by using Δz, i.e.
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2 þ ðz þ DzÞ2
q
 N:
The two geometric parameters used in the World Geodetic System 1984
(WGS-84) are (a = 6,378,137 m, f = 1/298.2572236). In International Terrestrial
Reference Frame 1996 (ITRF-96), the two parameters are (a = 6,378,136.49 m,
f = 1/298.25645). ITRF uses the International Earth Rotation Service (IERS)
Conventions (cf. McCarthy 1996). In PZ-90 (Parameters of the Earth Year 1990)
coordinate system of GLONASS, the two parameters are (a = 6,378,136 m,
f = 1/298.2578393).
The relation between the geocentric and geodetic latitude ϕ and φ may be given
by (cf. Eqs. 2.1 and 2.3):
tan / ¼
1  e2
N
N þ h


tan u:
ð2:6Þ
Fig. 2.4 Radius of curvature
in the prime vertical
20
Chapter 2  Coordinate and Time Systems

2.2
Coordinate System Transformations
Any Cartesian coordinate system can be transformed to another Cartesian coordi-
nate system through three successive rotations if their origins are the same and if
they are both right-handed or both left-handed systems. These three rotation
matrices are:
R1ðaÞ ¼
1
0
0
0
cos a
sin a
0
 sin a
cos a
0
@
1
A;
R2ðaÞ ¼
cos a
0
 sin a
0
1
0
sin a
0
cos a
0
@
1
A;
ð2:7Þ
R3ðaÞ ¼
cos a
sin a
0
 sin a
cos a
0
0
0
1
0
@
1
A;
where α is the rotating angle, which has a positive sign for a counter-clockwise
rotation as viewed from the positive axis to the origin. R1, R2, and R3 are called the
rotating matrix around the x-, y-, and z-axis, respectively. For any rotation matrix R,
there are R−1 (α) = RT(α) and R−1(α) = R(−α); that is, the rotation matrix is an
orthogonal one, where R−1 and RT are the inverse and transpose of the matrix R.
For two Cartesian coordinate systems with different origins and different length
units, the general transformation can be given in vector (matrix) form as
Xn ¼ X0 þ lRXold; or,
ð2:8Þ
xn
yn
zn
0
@
1
A ¼
x0
y0
z0
0
@
1
A þ lR
xold
yold
zold
0
@
1
A;
where µ is the scale factor (or the ratio of the two length units), and R is a
transformation matrix that can be formed by three suitably successive rotations. Xn
and Xold denote the new and old coordinates, respectively; X0 denotes the transla-
tion vector and is the coordinate vector of the origin of the old coordinate system in
the new one.
If rotational angle α is very small, then one has sinα ≈α and cosα ≈0. In such a
case, the rotation matrix can be simpliﬁed. If the three rotational angles α1, α2, α3 in
R of Eq. 2.8 are very small, then R can be written as (cf., e.g., Lelgemann and Xu
1991):
2.2  Coordinate System Transformations
21

R ¼
1
a3
a2
a3
1
a1
a2
a1
1
0
@
1
A;
ð2:9Þ
where α1, α2, α3 are small rotating angles around the x-, y-, and z-axis, respectively.
Using the simpliﬁed R, the transformation 2.8 is called the Helmert transformation.
As an example, the transformation from WGS-84 to ITRF-90 is given by
McCarthy (1996):
xITRF90
yITRF90
zITRF90
0
@
1
A ¼
0:060
0:517
0:223
0
@
1
A þ l
1
0:007000
0:000300
0:007000
1
0:018300
0:000300
0:018300
1
0
@
1
A
xWGS84
yWGS84
zWGS84
0
@
1
A;
where µ = 0.999999989, the translation vector has the unit of meter.
The transformations between the coordinate systems of GPS, GLONASS, and
Galileo can be generally represented by Eq. 2.8 with the scale factor µ = 1 (i.e. the
length units used in the three systems are the same). A formula of velocity trans-
formations between different coordinate systems can be obtained by differentiating
the Eq. 2.8 with respect to the time.
2.3
Local Coordinate System
The local left-handed Cartesian coordinate system (x′, y′, z′) can be deﬁned by
placing the origin to the local point P1(x1, y1, z1), whose z′-axis points to the
vertical, x′-axis is directed to the north, and y’ points to the east (cf. Fig. 2.5). The x′
y′-plane is called the horizontal plane; the vertical is deﬁned perpendicular to the
ellipsoid. Such a coordinate system is also called a local horizontal coordinate
system. For any point P2, whose coordinates in the global and local coordinate
system are (x2, y2, z2) and (x′, y , z′), respectively, one has relations of
Fig. 2.5 Astronomical
coordinate system
22
Chapter 2  Coordinate and Time Systems

x0
y0
z0
0
@
1
A ¼ d
cos A sin Z
sin A sin Z
cos Z
0
@
1
A;
and
d ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x02 þ y02 þ z02
p
tan A ¼ y0=x0
cos Z ¼ z0=d
0
@
1
A;
ð2:10Þ
where A is the azimuth, Z is the zenith distance, and d is the radius of the P2 in the
local system. A is measured from the north clockwise; Z is the angle between the
vertical and the radius d.
The local coordinate system (x′, y′, z′) can indeed be obtained by two successive
rotations of the global coordinate system (x, y, z) by R2(90 −φ)R3(λ) and then by
changing the x-axis to a right-handed system. In other words, the global system
must be rotated around the z-axis with angle λ, then around the y-axis with angle
90 −φ, and then change the sign of the x-axis. The total transformation matrix R is
then
R ¼
 sin u cos k
 sin u sin k
cos u
 sin k
cos k
0
cos u cos k
cos u sin k
sin u
0
@
1
A;
ð2:11Þ
and there are:
Xlocal ¼ RXglobal
and
Xglobal ¼ RTXlocal;
ð2:12Þ
where Xlocal and Xglobal are the same vector represented in local and global coor-
dinate systems. (φ, λ) are the geodetic latitude and longitude of the local point.
If the vertical direction is deﬁned as the plump line of the gravitational ﬁeld at
the local point, then such a local coordinate system is called an astronomic hori-
zontal system (its x′-axis points to the north, left-handed system). The plump line of
gravity g and the vertical line of the ellipsoid at point p generally do not coincide;
however, the difference is very small, and is omitted in GPS in practice.
Combining Eqs. 2.10 and 2.12, the zenith angle and azimuth of a point P2
(satellite) related to the station P1 can be directly computed by using the global
coordinates of the two points by
cos Z ¼ z0
d
and
tan A ¼ y0
x0 ;
ð2:13Þ
where
d ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðx2  x1Þ2 þ ðy2  y1Þ2 þ ðz2  z1Þ2
q
;
x0 ¼  ðx2  x1Þ sin u cos k  ðy2  y1Þ sin u sin k þ ðz2  z1Þ cos u;
y0 ¼  ðx2  x1Þ sin k þ ðy2  y1Þ cos k
and
z0 ¼ðx2  x1Þ cos u cos k þ ðy2  y1Þ cos u sin k þ ðz2  z1Þ sin u:
2.3  Local Coordinate System
23

2.4
Earth-Centred Inertial Coordinate System
To describe the motion of the GPS satellites, an inertial coordinate system must be
deﬁned. The motion of the satellites follows Newtonian mechanics, and Newtonian
mechanics is valid and expressed in an inertial coordinate system. The
Conventional Celestial Reference Frame (CRF) is suitable for our purpose. The
xy-plane of the CRF is the plane of the earth’s equator; the coordinates are celestial
longitude, measured eastward along the equator from the vernal equinox, and
celestial latitude. The vernal equinox is a crossover point of the ecliptic and the
equator. Thus, the right-handed earth-centred inertial (ECI) system uses the earth
centre as the origin, the CIO as the z-axis, and its x-axis is directed to the equinox
of J2000.0 (Julian date for 1 January 2000 at 12 h). Such a coordinate system is
also called equatorial coordinates of date. Because of the motion (acceleration) of
the earth’s centre, ECI is indeed a quasi-inertial system, and the general relativistic
effects must be taken into account. The system moves around the sun, however,
without rotating with respect to the CIO. This system is also called the earth-centred
space-ﬁxed (ECSF) coordinate system.
An excellent ﬁgure has been given by Torge (1991) to illustrate the motion of
the earth’s pole with respect to the ecliptic pole (cf. Fig. 2.6). The earth’s ﬂattening,
combined with the obliquity of the ecliptic, results in a slow turning of the equator
on the ecliptic due to the differential gravitational effect of the moon and the sun.
The slow circular motion with a period of about 26,000 years is called precession,
and the other quicker motion with periods from 14 days to 18.6 years is called
nutation. Taking the precession and nutation into account, the earth’s mean pole
(related to the mean equator) is transformed to the earth’s true pole (related to the
true equator). The x-axis of the ECI is pointed to the vernal equinox of date.
Fig. 2.6 Precession and
nutation
24
Chapter 2  Coordinate and Time Systems

The angle of the earth’s rotation from the equinox of date to the Greenwich
meridian is called Greenwich Apparent Sidereal Time (GAST) . Taking GAST into
account (called the earth’s rotation), the ECI of date is transformed to the true
equatorial coordinate system. The difference between the true equatorial system and
the ECEF system is the polar motion. Thus, we have transformed the ECI system in
a geometric way to the ECEF system. Such a transformation process can be written
as
XECEF ¼ RMRSRNRPXECI;
ð2:14Þ
where RP is the precession matrix, RN is the nutation matrix, RS is the earth rotation
matrix, RM is the polar motion matrix, X is the coordinate vector, and indices ECEF
and ECI denote the related coordinate systems.
Precession
The precession matrix consists of three successive rotation matrices (cf., e.g.,
Hofman-Wellenhof et al. 1997; Leick 1995; McCarthy 1996), i.e.
RP ¼ R3ðzÞR2ðhÞR3ðfÞ
¼
cos z cos h cos f  sin z sin f
 cos z cos h sin f  sin z cos f
 cos z sin h
sin z cos h cos f þ cos z sin f
 sin z cos h sin f þ cos z cos f
 sin z sin h
sin h cos f
 sin h sin f
cos h
0
B
@
1
C
A;
ð2:15Þ
where z, θ, ζ are precession parameters and
z ¼ 2306:002181T þ 1:0009468T2 þ 0:00018203T3
h ¼ 2004:003109T  0:0042665T2  0:00041833T3
f ¼ 2306:002181T þ 0:0030188T2 þ 0:00017998T3
ð2:16Þ
where T is the measuring time in Julian centuries (36,525 days) counted from
J2000.0 (cf. Sect. 2.6 time systems).
Nutation
The nutation matrix consists of three successive rotation matrices (cf., e.g.,
Hoffman-Wellenhof et al. 1997; Leick 1995; McCarthy 1996), i.e.
2.4  Earth-Centred Inertial Coordinate System
25

RN ¼ R1ðe  DeÞR3ðDwÞR1ðeÞ
¼
cos Dw
 sin Dw cos e
 sin Dw sin e
sin Dw cos et
cos Dw cos et cos e þ sin et sin e
cos Dw cos et sin e  sin et cos e
sin Dw sin et
cos Dw sin et cos e  cos et sin e
cos Dw sin et sin e þ cos et cos e
0
B
@
1
C
A

1
Dw cos e
Dw sin e
Dw cos et
1
De
Dw sin et
De
1
0
B
@
1
C
A;
ð2:17Þ
where ε is the mean obliquity of the ecliptic angle of date, Δψ and Δε are nutation
angles in longitude and obliquity, εt = ε + Δε, and
e ¼ 84381:00448  46:008150T  0:0000059T2 þ 0:00001813T3:
ð2:18Þ
The approximation is made by letting cosΔψ = 1 and sinΔψ = Δψ for very small
Δψ. For precise purposes, the exact rotation matrix shall be used. The nutation
parameters Δψ and Δε can be computed by using the International Astronomical
Union (IAU) theory or IERS theory:
DW ¼
X
106
i¼1
ðAi þ A0
iTÞ sin b;
De ¼
X
106
i¼1
ðBi þ B0
iTÞ cos b
or
DW ¼
X
263
i¼1
ðAi þ A0
iTÞ sin b þ A00
i cos b;
De ¼
X
263
i¼1
ðBi þ B0
iTÞ cos b þ B0
i cos b;
where argument
b ¼ N1il þ N2il0 þ N3iF þ N4iD þ N5iX;
where l is the mean anomaly of the moon, l′ is the mean anomaly of the Sun,
F = L −Ω, D is the mean elongation of the moon from the sun, Ω is the mean
longitude of the ascending node of the moon, and L is the mean longitude of the
moon. The formulas of l, l′, F, D, and Ω, are given in Sect. 11.2.8. The coefﬁcient
values of N1i, N2i, N3i, N4i, N5i, Ai, Bi, A′, Bi′, Ai″, and Bi″ can be found in, e.g.,
McCarthy (1996). The updated formulas and tables can be found in updated IERS
26
Chapter 2  Coordinate and Time Systems

conventions. For convenience, the coefﬁcients of the IAU 1980 nutation model are
given in Appendix 1.
Earth Rotation
The earth rotation matrix can be represented as
RS ¼ R3ðGASTÞ;
ð2:19Þ
where GAST is Greenwich Apparent Sidereal Time and
GAST ¼ GMST þ DW cos e þ 0:0000264 sin X þ 0:00000063 sin 2X;
ð2:20Þ
where GMST is Greenwich Mean Sidereal Time. Ω is the mean longitude of the
ascending node of the Moon; the second term on the right-hand side is the nutation
of the equinox. Furthermore,
GMST ¼ GMST0 þ aUT1;
ð2:21Þ
GMST0 ¼ 6  3600:000 þ 41  60:000 þ 50:0054841
þ 8640184:00812866T0 þ 0:00093104T2
0  6:002  106T3
0;
a ¼ 1:002737909350795 þ 5:9006  1011T0  5:9  1015T2
0;
where GMST0 is Greenwich Mean Sidereal Time at midnight on the day of interest.
α is the rate of change. UT1 is the polar motion corrected Universal Time (cf.
Sect. 2.6). T0 is the measuring time in Julian centuries (36,525 days) counted from
J2000.0 to 0hUT1 of the measuring day. By computing GMST, UT1 is used (cf.
Sect. 2.6).
Polar Motion
As shown in Fig. 2.7, the polar motion is deﬁned as the angles between the pole
of date and the CIO pole. The polar motion coordinate system is deﬁned by xy-plane
coordinates, whose x-axis is pointed to the south and is coincided to the mean
Greenwich meridian, and whose y-axis is pointed to the west. xp and yp are the angles
of the pole of date, so the rotation matrix of polar motion can be represented as
RM ¼ R2ðxpÞR1ðypÞ ¼
cos xp
sin xp sin yp
sin xp cos yp
0
cos yp
 sin yp
 sin xp
cos xp sin yp
cos xp cos yp
0
B
@
1
C
A

1
0
xp
0
1
yp
xp
yp
1
0
B
@
1
C
A:
ð2:22Þ
2.4  Earth-Centred Inertial Coordinate System
27

The IERS determined xp and yp can be obtained from the home pages of IERS.
2.5
IAU 2000 Framework
At its 2000 General Assembly, the International Astronomical Union (IAU)
adopted a set of resolutions that provide a consistent framework for deﬁning
barycentric and geocentric celestial reference systems (Petit 2002). The conse-
quence of the resolution is that coordinate transformation from celestial reference
system (CRS, i.e. the ECI system) to the terrestrial reference system (TRS, i.e. the
ECEF system) has the form
XECEF ¼ RMRSRNPXECI;
ð2:23Þ
where RNP is the precession-nutation matrix, RS is the earth rotation matrix, RM is
the polar motion matrix, X is the coordinate vector, and indices ECEF and ECI
denote the related coordinate systems. The rotation matrices are functions of time T,
which is deﬁned (see McCarthy and Petit 2003) by
T ¼ ðTT  2000 January 1d 12h TT) in days/36,525,
ð2:24Þ
where TT is the Terrestrial Time (for details see Sect. 2.7) and
RM ¼ R2ðxpÞR1ðypÞR3ðs0Þ;
RS ¼ R3ð#Þ; and
ð2:25Þ
RNP ¼ R3ðsÞR3ðEÞR2ðdÞR3ðEÞ;
Fig. 2.7 Polar motion
28
Chapter 2  Coordinate and Time Systems

where xp and yp are the angles of the pole of date (or polar coordinates of the
Celestial Intermediate Pole (CIP) in TRS), and s0 is a function of xp and yp:
s0 ¼ 1
2
ZT
T0
ðxp_yp  _xpypÞdt or
approximately (see McCarthy and Capitaine 2002)
s0 ¼ ð47lasÞ T;
ð2:26Þ
where T is time in Julian century counted from J2000.0 and
# ¼ 2pð0:7790572732640 þ 1:00273781191135448 TuÞ;
ð2:27Þ
where Tu = (Julian UT1 date - 2,451,545.0) and UT1 = UTC + (UT1-UTC).
(UT1-UTC) is published by the IERS.
E and d are such that the coordinates of the CIP in the CRS are
X ¼ sin d cos E
Y ¼ sin d sin E
Z ¼ cos d
ð2:28Þ
Equivalently, RNP can be given by
RNP ¼ R3ðsÞ 
1  aX2
aXY
X
aXY
1  aY2
Y
X
Y
1  aðX2 þ Y2Þ
0
@
1
A
1
ð2:29Þ
where
a ¼
1
1 þ cos d  1
2 þ 1
8 ðX2 þ Y2Þ:
ð2:30Þ
The developments of X and Y can be found on the website of the IERS Conventions
and have the following form (in mas: microarcseconds) (Capitaine 2002):
X ¼ 16616:9900 þ 2004191742:8800T  427219:0500T2
 198620:5400T3  46:0500T4 þ 5:9800T5
þ
X
i
ðas;0Þi sin b þ ðac;0Þi cos b


þ
X
i
ðas;1ÞiT sin b þ ðac;1ÞiT cos b


þ
X
i
ðas;2ÞiT2 sin b þ ðac;2ÞiT2 cos b


þ   
ð2:31Þ
2.5  IAU 2000 Framework
29

Y ¼ 6950:78
00  25381:9900T  22407250:9900T2
þ 1842:2800T3  1113:0600T4 þ 0:9900T5
þ
X
i
ðbs;0Þi sin b þ ðbc;0Þi cos b


þ
X
i
ðbs;1ÞiT sin b þ ðbc;1ÞiT cos b


þ
X
i
ðbs;2ÞiT2 sin b þ ðbc;2ÞiT2 cos b


þ   
ð2:32Þ
In Eq. 2.29, s is the accumulated rotation between the reference epoch and the date
T of CEO on the true equator due to the celestial motion of CIP and can be
expressed as
sðTÞ ¼  1
2 XðTÞYðTÞ  XðT0ÞYðT0Þ
½
 þ
ZT
T0
_XYdt 
r0N0 
X
0 N0


where σ0 and P
0 are the positions of CEO at J2000.0 and the x-origin of CRS,
respectively, and N0 is the ascending node at J2000.0 in the equator of CRS. In
above equation, term sðTÞ þ 1
2 ½XðTÞYðTÞ can be expressed as (in mas)
s þ XY=2 ¼ 94:0 þ 3808:35T  119:94T2
 72574:09T3 þ 27:70T4 þ 15:61T5
þ
X
i
ðcs;0Þi sin b þ ðcc;0Þi cos b


þ
X
i
ðcs;1ÞiT sin b þ ðcc;1ÞiT cos b


þ
X
i
ðcs;2ÞiT2 sin b þ ðcc;2ÞiT2 cos b


þ   
ð2:33Þ
In Eqs. 2.31–2.33, coefﬁcients ðas;jÞi; ðac;jÞi, ðbs;jÞi; ðbc;jÞi and ðcs;jÞi; ðcc;jÞi can
be extracted from Table 5.2a–c (available at ftp://tai.bipm.org/iers/conv2003/
chapter5/). b is the combination of the fundamental arguments of nutation theory:
b ¼
X
14
j¼1
NjFj
ð2:34Þ
The ﬁrst ﬁve Fj are the Delaunay variables l, l′, F, D, Ω (given in Sect. 11.2.8);
the amplitudes of sines and cosines β can be derived from the amplitudes of the
precession and nutation series (see McCarthy and Petit 2003); F6 to F13 are
the mean longitudes of the planets (Mercury to Neptune), including the earth; F14 is
the general precession in longitude. They are given in radians and T in Julian
30
Chapter 2  Coordinate and Time Systems

centuries of TDB (see Sect. 2.7). The coefﬁcients Nj are functions of index i and can
be found in the IERS website:
F6 ¼ lMe ¼ 4:402608842 þ 2608:7903141574T
F7 ¼ lVe ¼ 3:176146697 þ 1021:3285546211T
F8 ¼ lE ¼ 1:753470314 þ 628:3075849991T
F9 ¼ lMa ¼ 6:203480913 þ 334:0612426700T
F10 ¼ lJu ¼ 0:599546497 þ 52:9690962641T
F11 ¼ lSa ¼ 0:874016757 þ 21:3299104960T
F12 ¼ lUr ¼ 5:481293872 þ 7:4781598567T
F13 ¼ lNe ¼ 5:311886287 þ 3:8133035638T
F14 ¼ Pa ¼ 0:024381750T þ 0:00000538691T2
ð2:35Þ
Using the new paradigm, the complete procedure of transforming GCRS to
ITRS, which is compatible with the IAU2000 precession-nutation, is based on the
expressions of 2.31–2.33.
An equivalent way to realise the transformation between TRS and CRS under
the deﬁnition of IAU 2000 can be implemented in a classical way by adding
IAU2000 corrections to the corresponding rotating angles. This is done by using the
transformation formula 2.14, where the three precession rotating angles (see
McCarthy and Petit 2003) are
z ¼  2:597617600 þ 2 306:080322600 T þ 1:094779000 T
þ 0:018227300 T þ 0:000047000T4  0:000000300T5
h ¼ 2 004:191747600 T  0:426935300 T  0:041825100 T
 0:000060100T4  0:000000100T5
f ¼ 2:597617600 þ 2 306:080950600 T þ 0:301901500 T
þ 0:017966300 T  0:000032700T4  0:000000200T5
ð2:36Þ
The IAU 2000 nutation model is given by two series for nutation in longitude
Δψ and obliquity Δε, referred to the mean equator and equinox of date, with
T measured in Julian centuries from epoch J2000.0:
Dw ¼
X
N
i¼1
ðAi þ A0
iTÞ cos b þ ðA00
i þ A000
i TÞ cos b;
ð2:37Þ
De ¼
X
N
i¼1
ðBi þ B0
iTÞ cos b þ ðB00
i þ B000
i TÞ cos b;
2.5  IAU 2000 Framework
31

where argument β can be found on the IERS website. For these two formulas, rate
and bias corrections are necessary because of the new deﬁnition of the Celestial
Intermediate Pole and the Celestial and Terrestrial Ephemeris Origin:
dDw ¼ ð0:0166170  0:0000100Þ00 þ ð0:29965  0:00040Þ00T;
dDe ¼ ð0:0068192  0:0000100Þ00 þ ð0:02524  0:00010Þ00T:
ð2:38Þ
The earth’s rotation angle (i.e. the apparent Greenwich Sidereal Time GST or
GAST) can be computed by adding a correction EO to the GMST in Eq. 2.27 (in
mas):
EO ¼ 14; 506 þ 4; 612; 157; 399:66T þ 1; 396; 677:21T2  93:44T3 þ 18:82T4
þ Dw cos e þ
X
i
ðds;0Þi sin b þ ðdc;0Þi cos b


þ
X
i
ðds;1ÞiT sin b þ ðdc;1ÞiT cos b


þ   
ð2:39Þ
where coefﬁcients ðds;jÞi; ðdc;jÞi can be extracted from Table 5.4 (available at ftp://
tai.bipm.org/iers/conv2003/chapter5/). Dw is deﬁned in Eq. 2.37 and e is deﬁned in
Eq. 2.18.
Similarly, the rotation matrix of polar motion shall be represented as the ﬁrst
formula of 2.25 and 2.26.
2.6
Geocentric Ecliptic Inertial Coordinate System
As discussed above, ECI used the CIO pole in space as the z-axis (through con-
sideration of the polar motion, nutation, and precession). If the ecliptic pole is used
as the z-axis, then an ecliptic coordinate system is deﬁned, and it may be called the
Earth-Centred Ecliptic Inertial (ECEI) coordinate system. ECEI places the origin at
the mass centre of the earth, its z-axis is directed to ecliptic pole (or the xy-plane is
the mean ecliptic), and its x-axis points to the vernal equinox of date. The coor-
dinate transformation between the ECI and ECEI systems can be represented as
XECEI ¼ R1ðeÞXECI;
ð2:40Þ
where ε is the ecliptic angle (mean obliquity) of the ecliptic plane related to the
equatorial plane. The formula for ε is given in Sect. 2.4. Usually, coordinates of the
sun and the moon as well as planets are given in the ECEI system.
32
Chapter 2  Coordinate and Time Systems

2.7
Time Systems
Three time systems are used in satellite surveying. They are sidereal time, dynamic
time, and atomic time (cf., e.g., Hofman-Wellenhof et al. 1997; Leick 1995;
McCarthy 1996; King et al. 1987).
Sidereal time is a measure of the earth’s rotation and is deﬁned as the hour angle
of the vernal equinox. If the measure is counted from the Greenwich meridian, the
sidereal time is called Greenwich Sidereal Time. Universal Time (UT)
is the
Greenwich hour angle of the apparent sun, which orbits uniformly in the equatorial
plane. Because the angular velocity of the earth’s rotation is not a constant, sidereal
time is not a uniformly scaled time. The oscillation of UT is also partly caused by
the polar motion of the earth. The universal time corrected for the polar motion is
denoted by UT1.
Dynamic time is a uniformly scaled time series used to describe the motion of
bodies in a gravitational ﬁeld. Barycentric Dynamic Time (TDB) is applied in an
inertial coordinate system (its origin is located at the centre-of-mass, or barycentre).
Terrestrial Dynamic Time (TDT) is used in a quasi-inertial coordinate system (such
as ECI). Because of the motion of the earth around the sun (or in the sun’s grav-
itational ﬁeld), TDT will vary with respect to TDB. However, both the satellite and
the earth are subject to almost the same gravitational perturbations. TDT may be
used for describing the satellite motion without taking into account the inﬂuence of
the gravitational ﬁeld of the sun. TDT is also called Terrestrial Time (TT).
Atomic time is a system based on the output of atomic clocks, such as that used
in the International Atomic Time (TAI) scale. It is uniformly scaled and is used in
the ECEF coordinate system. In practice, TDT is realised by TAI with a constant
offset (32.184 s). To take into account the slowing of the earth’s rotation with
respect to the sun, Coordinated Universal Time (UTC) was introduced in order to
maintain the synchronisation of TAI to the solar day (by inserting leap seconds).
GPS Time (GPST) is also an atomic time scale.
The relationships between different time systems are given as follows:
TAI ¼ GPST þ 19:0 s
TAI ¼ TDT  32:184 s
TAI ¼ UTC þ n s
UT1 ¼ UTC þ dUT1
;
ð2:41Þ
where dUT1 can be obtained by IERS, (dUT1 < 0.7 s, cf. Zhu et al. 1996), (dUT1
is also broadcasted with the navigation data), n is the number of leap seconds of
date and is inserted into UTC on 1 January and 1 July for the years. The
actual n can be found in the IERS report.
Time argument T (Julian centuries) is used in the formulas given in Sect. 2.4.
For convenience, T is denoted by TJD, and TJD can be computed from the civil
date (Year, Month, Day, and Hour) as follows:
2.7  Time Systems
33

JD ¼ INTð365:25YÞ þ INTð30:6001 ðM þ 1ÞÞ þ Day þ Hour=24 þ 1; 720; 981:5
and
TJD ¼ JD=36525;
ð2:42Þ
where
Y ¼ Year1;
M ¼ Month þ 12;
if
Month  2;
Y ¼ Year;
M ¼ Month;
if
Month [ 2;
where JD is the Julian date (JD), Hour is the time of UT, and INT denotes the
integer part of a real number. The JD counted from JD2000.0 is then
JD2000 = JD −JD2000.0, where JD2000.0 is the JD for 1 January 2000 at 12 h,
and has a value of 2,451,545.0 days. One Julian century is 36,525 days.
Inversely, the civil date (Year, Month, Day and Hour) can be computed from the
JD as follows:
b ¼ INTðJD þ 0:5Þ þ 1537;
c ¼ INT b  122:1
365:25


;
d ¼ INTð365:25cÞ;
e ¼ INT
b  d
30:6001


;
Hour ¼ JD þ 0:5  INTðJD þ 0:5Þ;
Day ¼ b  d  INTð30:6001eÞ;
Month ¼ e  1  12INT
e
14


; and
Year ¼ c  4 715  INT 7 þ Month
10


;
ð2:43Þ
where b, c, d, and e are auxiliary numbers.
Because
the
GPS
standard
epoch
is
deﬁned
as
JD = 2,444,244.5
(6
January 1980, 0 h), GPS week and the day of week (denoted by Week and N) can
be computed by
N ¼ moduloðINTðJD þ 1:5Þ; 7Þ and
Week ¼ INT JD  2; 444; 244:5
7


;
ð2:44Þ
where N is the day of week (N = 0 for Monday, N = 1 for Tuesday, and so on).
34
Chapter 2  Coordinate and Time Systems

For saving digits and counting the date from midnight instead of noon, the
modiﬁed Julian date (MJD) is deﬁned as
MJD ¼ JD2; 400; 000:5
ð
Þ:
ð2:45Þ
GLONASS time (GLOT) is deﬁned by Moscow time UTCSU, which equals
UTC plus three hours (corresponding to the offset of Moscow time to Greenwich
time), theoretically. GLOT is permanently monitored and adjusted by the
GLONASS Central Synchroniser (cf. Roßbach 2000). UTC and GLOT then has a
simple relation
UTC ¼ GLOT þ tc3h;
ð2:46Þ
where τc is the system time correction with respect to UTCSU, which is broadcasted
by the GLONASS ephemerides and is less than one microsecond. Therefore, there
is approximately
GPST ¼ GLOT þ m3h;
ð2:47Þ
where m refers to the number of “leap seconds” between GPS and GLONASS
(UTC) time and is given in the GLONASS ephemerides. m is indeed the leap
seconds since GPS standard epoch (6 January 1980, 0 h).
Galileo system time (GST) will be maintained by a number of UTC laboratory
clocks. GST and GPST are time systems of various UTC laboratories. After the
offset of GST and GPST is made available to the user, the interoperability will be
ensured. GST is apart from small differences (tens of nanoseconds), nearly identical
to GPS time. The Galileo week starts at midnight Saturday/Sunday at the same
second as the GPS week; The GST week as transmitted by the satellites is a 12-bit
value with a roll-over after week 4095. The GST week started at zero at the ﬁrst
roll-over of the broadcast GPS week after 1023, i.e. on Sunday, 22 August 1999, at
00:00:00 GPS time.
The BDS Time (BDT) system is a continuous timekeeping system, with length
of seconds being an SI second. BDT zero time started at 00:00:00 UTC on 1
January 2006 (GPS week 1356); therefore, BDT is 14 s behind GPS time. BDT is
synchronized with UTC within 100 ns (modulo 1 s). The BDT week starts at
midnight Saturday/Sunday. The BDT week is transmitted by the satellites as a
13-bit number. It has a roll-over after week 8191.
Apart from the small errors in the realizations of the different time systems, the
relations between systems are:
GLOT ¼ UTC ¼ GPST  DtLS
ð2:48Þ
GST ¼ GPST ¼ UTC þ DtLS
ð2:49Þ
BDT ¼ UTC þ DtLSBDS
ð2:50Þ
2.7  Time Systems
35

where ΔtLS is the delta time between GPST and UTC due to leap seconds, such that
(2005: ΔtLS = 13; 2006: ΔtLS = 14; 2008: ΔtLS = 15; 2012: ΔtLS = 16 and 2015:
ΔtLS = 17). ΔtLSBDS is the delta time between BDT and UTC due to leap seconds,
such that (2006: ΔtLSBDS = 0; 2008: ΔtLSBDS = 1; 2012: ΔtLSBDS = 2 and 2015:
ΔtLSBDS = 3).
References
Captinaine N (2002) Comparison of “Old” and “New” Concepts: The Celestrial Intermediate Pole
and Earth Orientation Parameters. In: Proceedings of the IERS Workshop on the
Implementation of the New IAU Resolutions, Paris, France, April 18-19, 2002, (Capitaine
N et al, ed). IERS Technical Note No. 29.
Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997, 2001) GPS theory and practice.
Springer-Press, Wien.
King RW, Masters EG, Rizos C, Stolz A, Collins J (1987) Surveying with Global Positioning
System. Dümmler-Verlag, Bonn.
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York.
Lelgemann D (2002) Lecture notes of geodesy, Technical University Berlin.
Lelgemann D, Xu G (1991) Zur Helmert-Transformation von terrestrischen und GPS-Netzen.
ZfV (1).
McCarthy DD (1996) International Earth Rotation Service. IERS conventions, Paris, 95 pp. IERS
Technical Note No. 21.
McCarthy DD, Capitaine N (2002) Practical Consequences of Resolution B1.6 “IAU2000
Precession-Nutation Model”, Resolution B1.7 “Deﬁnition of Celestial Intermediate Pole”, and
Resolution B1.8 “Deﬁnition and Use of Celestrial and Terrestrial Ephemeris Origin”. In:
Proceedings of the IERS Workshop on the Implementation of the New IAU Resolutions, Paris,
France, April 18-19, 2002 (Capitaine N et al, ed.) IERS Technical Note No. 29.
McCarthy DD, Petit G (Ed) (2003) International Earth Rotation Service. IERS conventions (2003),
IERS Technical Note No. 32.
Petit G (2002) Comparison of “Old” and “New” Cocepts: Coordinate Times and Time
Transformations, in Proceedings of the IERS Workshop on the Implementation of the
New IAU Resolutions, Paris, France, April 18-19, 2002 (Capitaine N et al, ed), IERS Technical
Note No. 29.
Torge W (1991) Geodesy. Walter de Gruyter, Berlin.
Zhu SY, Reigber Ch, Massmann FH (1996) The German PAF for ERS, ERS standards used at
D-PAF. D-PAF/GFZ ERS-D-STD-31101.
36
Chapter 2  Coordinate and Time Systems

Chapter 3
Satellite Orbits
The principle of the GPS system is to measure the signal transmission paths from
the satellites to the receivers. Therefore, the satellite orbits are very important topics
in GPS theory. In this chapter, the basic orbits theory is brieﬂy described. For the
GPS applications in orbits correction and orbits determination, the advanced orbits
perturbation theory will be discussed in Chap. 11.
3.1
Keplerian Motion
The simpliﬁed satellite orbiting is called Keplerian motion, and the problem is
called the two-body problem. The satellite is supposed to move in a central force
ﬁeld. The equation of satellite motion is described by Newton’s second law of
motion by
~f ¼ m  a ¼ m  €~r;
ð3:1Þ
where~f is the attraction force, m is the mass of the satellite, a, or alternatively, €~r is
the acceleration of the motion (second-order differentiation of vector~r with respect
to the time), and according to Newton’s law,
~f ¼  GMm
r2
~r
r ;
ð3:2Þ
where G is the universal gravitational constant, M is the mass of the earth, r is the
distance between the mass centre of the earth and the mass centre of the satellite.
The equation of satellite motion is then
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_3
37

€~r ¼  l
r2
~r
r ;
ð3:3Þ
where μ (=GM) is called the earth’s gravitational constant.
Equation 3.3 of satellite motion is valid only in an inertial coordinate system, so
the ECSF coordinate system discussed in Chap. 2 will be used for describing the
orbit of the satellite. The vector form of the equation of motion can be rewritten
through three x, y, and z components ð~r ¼ ðx; y; zÞÞ as
€x ¼  l
r3 x
€y ¼  l
r3 y
€z ¼  l
r3 z:
ð3:4Þ
Multiplying y, z to the ﬁrst equation of 3.4, and x, z to the second, x, y to the third,
and then forming differences of them, one gets
y€z  z€y ¼ 0
z€x  x€z ¼ 0
x€y  y€x ¼ 0;
ð3:5Þ
or in vector form:
~r  €~r ¼ 0:
ð3:6Þ
Equations 3.5 and 3.6 are equivalent to
dðy_z  z_yÞ
dt
¼ 0
dðz_x  x_zÞ
dt
¼ 0
dðx_y  y_xÞ
dt
¼ 0;
ð3:7Þ
dð~r  _~rÞ
dt
¼ 0:
ð3:8Þ
Integrating Eqs. 3.7 and 3.8 lead to
y_z  z_y ¼ A
z_x  x_z ¼ B
x_y  y_x ¼ C;
ð3:9Þ
38
Chapter 3  Satellite Orbits

~r  _~r ¼ ~h ¼
A
B
C
0
@
1
A;
ð3:10Þ
where A, B, C are integration constants; they form the integration constant vector ~h:
That is:
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
A2 þ B2 þ C2
p
¼ ~r  _~r

:
ð3:11Þ
The constant h is two times of the area that the radius vector sweeps during a unit
time. This is indeed Kepler’s second law. Then h/2 is called the area velocity of the
radius of the satellite.
Multiplying x, y, and z to the three equations of 3.9 and adding them together,
one has
Ax þ By þ Cz ¼ 0:
ð3:12Þ
That is, the satellite motion fulﬁls the equation of a plane, and the origin of the
coordinate system is in the plane. In other words, the satellite moves in a plane in
the central force ﬁeld of the earth. The plane is called the orbital plane of the
satellite.
The angle between the orbital plane and the equatorial plane is called inclination
of the satellite (denoted by i, cf. Fig. 3.1). Alternatively, the inclination i is the
angle between the vector ~z ¼ ð0; 0; 1Þ and ~h ¼ ðA; B; CÞ i.e.
cos i ¼ ~z ~h
~zj j  ~h


¼ C
h :
ð3:13Þ
Fig. 3.1 Orbital plane
3.1  Keplerian Motion
39

The orbital plane cuts the equator at two points. They are called ascending node
N and descending node. (See the next section for details). Vector ~s denotes the
vector from the earth’s centre pointed to the ascending point. The angle between the
ascending node and the x-axis (vernal equinox) is called the right ascension of the
ascending node (denoted by Ω). Thus,
~s ¼~z ~h;
and
cos X ¼ ~s ~x
~sj j  ~xj j ¼
B
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
A2 þ B2
p
;
sin X ¼ ~s ~y
~sj j  ~yj j ¼
A
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
A2 þ B2
p
:
ð3:14Þ
Parameters i and Ω uniquely deﬁned the place of orbital plane and therefore are
called orbital plane parameters. Ω, i, and h are then selected as integration constants,
which have signiﬁcant geometric meanings of the satellite orbits.
3.1.1
Satellite Motion in the Orbital Plane
In the orbital plane, a two-dimensional rectangular coordinate system is given in
Fig. 3.2. The coordinates can be represented in polar coordinate r and ϑ as
p ¼ r cos #
q ¼ r sin #:
ð3:15Þ
Fig. 3.2 Polar coordinates in
the orbital plane
40
Chapter 3  Satellite Orbits

The equation of motion in pq-coordinates is similar to the Eq. 3.4 as
€p ¼  l
r3 p
€q ¼  l
r3 q:
ð3:16Þ
From Eq. 3.15, one has
_p ¼ _r cos #  r _# sin #
_q ¼ _r sin # þ r _# cos #
€p ¼ ð€r  r _#2Þ cos #  ðr€# þ 2_r _#Þ sin #
€q ¼ ð€r  r _#2Þ sin # þ ðr€# þ 2_r _#Þ cos #:
ð3:17Þ
Substituting Eqs. 3.17 and 3.15 into Eq. 3.16, one gets
ð€r  r _#2Þ cos #  ðr€# þ 2_r _#Þ sin # ¼  l
r2 cos #
ð€r  r _#2Þ sin # þ ðr€# þ 2_r _#Þ cos # ¼  l
r2 sin #:
ð3:18Þ
The point from which the polar angle ϑ is measured is arbitrary. So setting ϑ as zero,
the equation of motion is then
€r  r _#2 ¼  l
r2
r€# þ 2_r _# ¼ 0:
ð3:19Þ
Multiplying r to the second equation of 3.19, it turns out to be
dðr2 _#Þ
dt
¼ 0:
ð3:20Þ
Because r _# is the tangential velocity, r2 _# is the two times of the area velocity of the
radius of the satellite. Integrating Eq. 3.20 and comparing it with the discussion in
Sect. 3.1, one has
r2 _# ¼ h:
ð3:21Þ
h/2 is the area velocity of the radius of the satellite.
3.1  Keplerian Motion
41

For solving the ﬁrst differential equation of 3.19, the equation must be trans-
formed into a differential equation of r with respect to variable f. Let
u ¼ 1
r ;
ð3:22Þ
then from Eq. 3.21, one gets
d#
dt ¼ hu2
ð3:23Þ
and
dr
dt ¼ dr
d#
d#
dt ¼ d
d#
1
u
 
hu2 ¼ h du
d#
d2r
dt2 ¼  h d2u
d#2
d#
dt ¼ h2u2 d2u
d#2 :
ð3:24Þ
Substituting Eqs. 3.22 and 3.24 into the ﬁrst equation of 3.19, the equation of
motion is then
d2u
d#2 þ u ¼ l
h2 ;
ð3:25Þ
and its solution is
u ¼ d1 cos # þ d2 sin # þ l
h2 ;
where d1 and d2 are constants of integration. The above equation may be simpliﬁed
as
u ¼ l
h2 1 þ e cosð#  xÞ
ð
Þ;
ð3:26Þ
where
d1 ¼ l
h2 e cos x;
d2 ¼ l
h2 e sin x:
Thus the moving equation of satellite in the orbital plane is
r ¼
h2=l
1 þ e cosð#  xÞ :
ð3:27Þ
42
Chapter 3  Satellite Orbits

Comparing Eq. 3.27 with a standard polar equation of conic:
r ¼ að1  e2Þ
1  e cos / ;
ð3:28Þ
orbit Eq. 3.27 is obviously a polar equation of conic section with the origin at one
of the foci. Where parameter e is the eccentricity, for e = 0, e < 1, e = 1, e > 1, the
conic is a circle, an ellipse, a parabola, and a hyperbola, respectively. For the
satellite orbiting around the earth, generally, e < 1. Thus, the satellite orbit is an
ellipse, and this is indeed the Kepler’s ﬁrst law. Parameter a is the semimajor axis
of the ellipse, and
h2
l ¼ að1  e2Þ:
ð3:29Þ
It is obvious that parameter a has greater signiﬁcance in a geometric sense than
h, so the use of a is preferred. Parameters a and e deﬁne the size and shape of the
ellipse and are called ellipse parameters. The ellipse cuts the equator at the
ascending and descending nodes. Polar angle φ is counted from the apogee of the
ellipse. This can be seen by letting φ = 0; thus r = a(1 + e). φ has a 180° difference
with the angle ϑ −ω. Letting f = ϑ −ω, where f is called the true anomaly of the
satellite counted from the perigee, then the orbit Eq. 3.27 can be written as
r ¼ að1  e2Þ
1 þ e cos f :
ð3:30Þ
In the case of f = 0, i.e. the satellite is in the point of perigee, ω = ϑ, ϑ is the
polar angle of the perigee counted from the p-axis. Supposing the p-axis is an axis
in the equatorial plane and points to the ascending node N, then ω is the angle of
perigee counted from the ascending node (cf. Fig. 3.3) and is called the argument of
perigee. The argument of perigee deﬁnes the axis direction of the ellipse related to
the equatorial plane.
Fig. 3.3 Ellipse of the
satellite motion
3.1  Keplerian Motion
43

3.1.2
Keplerian Equation
Thus far, ﬁve integration constants have been derived. They are inclination angle i,
right ascension of ascending node Ω, semimajor axis a, eccentricity e of the ellipse,
and argument of perigee ω. Parameters i and Ω decide the place of the orbital plane,
a and e decide the size and shape of the ellipse and ω decides the direction of the
ellipse (cf. Fig. 3.4). To describe the satellite position in the ellipse, velocity of the
motion must be discussed.
The period T of the satellite motion is the area of ellipse divided by area velocity:
T ¼ pab
h
2
¼
2pab
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
lað1  e2Þ
p
¼ 2pa3=2l1=2:
ð3:31Þ
The average angular velocity n is then
n ¼ 2p
T ¼ a3=2l1=2:
ð3:32Þ
Equation 3.32 is the Kepler’s third law. It is obvious that it is easier to describe
the angular motion of the satellite under the average angular velocity n in the
geometric centre of the ellipse (than in the geocentre). To simplify the problem, an
angle called the eccentric anomaly is deﬁned (denoted by E, cf. Fig. 3.5). S0 is the
vertical projection of the satellite S on the circle with a radius of a (semimajor axis
of the ellipse). The distance between the geometric centre O0 of the ellipse and the
geocentre O is ae. Thus,
x ¼ r cos f ¼ a cos E  ae
y ¼ r sin f ¼ b sin E ¼ a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E;
ð3:33Þ
Fig. 3.4 Orbital geometry
44
Chapter 3  Satellite Orbits

where the second equation can be obtained by substituting the ﬁrst into the standard
ellipse equation ((x + ae)2/a2 + y2/b2 = 1), where b is the semiminor axis of the
ellipse. The orbit equation can then be represented by variable E as
r ¼ að1  e cos EÞ:
ð3:34Þ
The relation between true and eccentric anomalies can be derived by using
Eqs. 3.33 and 3.34:
tan f
2 ¼
sin f
1 þ cos f ¼
sin E
1 þ cos E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1  e
¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ e
p
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e
p
tan E
2 :
ð3:35Þ
If the xyz-coordinates are rotated such that the xy-plane coincides with the orbital
plane, then the area velocity formulas of Eqs. 3.9 and 3.10 have only one com-
ponent along the z-axis, i.e.
x_y  y_x ¼ h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
lað1  e2Þ
p
:
ð3:36Þ
From Eq. 3.33, one has
_x ¼  a sin E dE
dt
_y ¼ a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2 cos E
p
dE
dt
ð3:37Þ
Fig. 3.5 Mean anomaly of
satellite
3.1  Keplerian Motion
45

Substituting Eqs. 3.33 and 3.37 into Eq. 3.36 and taking Eq. 3.32 into account, a
relation between E and t is obtained
ð1  e cos EÞdE ¼
ﬃﬃﬃl
p a3=2dt ¼ ndt:
ð3:38Þ
Suppose at the time tp satellite is at the point perigee, i.e. E(tp) = 0, and at any time
t, E(t) = E, then integration of Eq. 3.38 from 0 to E, namely from tp to t is
E  e sin E ¼ M;
ð3:39Þ
where
M ¼ nðt  tpÞ:
ð3:40Þ
Equation 3.39 is the Keplerian equation. E is given as a function of M, namely
t. Because of Eq. 3.34, the Keplerian equation indirectly assigns r as a function of
t. M is called the mean anomaly. M describes the satellite as orbiting the earth with a
mean angular velocity n. tp is called the perigee passage and is the sixth integration
constant of the equation of satellite motion in a centre-force ﬁeld.
Knowing M to compute E, the Keplerian Eq. 3.39 may be solved iteratively.
Because of the small e, the convergence can be achieved very quickly.
Three anomalies (true anomaly f, eccentric anomaly E and mean anomaly M) are
equivalent through the relations of Eqs. 3.35 and 3.39. They are functions of time
t (including the perigee passage tp), and they describe the position changes of the
satellite with the time in the ECSF coordinates.
3.1.3
State Vector of the Satellite
Consider the orbital right-handed coordinate system: if the xy-plane is the orbital
plane, the x-axis points to the perigee, the z-axis is in the direction of vector~h, and the
origin is in the geocentre, the position vector~q of the satellite is then (cf. Eq. 3.33)
~q ¼
aðcos E  eÞ
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
0
0
@
1
A ¼
r cos f
r sin f
0
0
@
1
A:
ð3:41Þ
Differentiating Eq. 3.41 with respect to time t and taking Eq. 3.38 into account,
the velocity vector of the satellite is then
_~q ¼
 sin E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos E
0
0
@
1
A
na
1  e cos E ¼
 sin f
e þ cos f
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
:
ð3:42Þ
46
Chapter 3  Satellite Orbits

The second part of the above equation can be derived from the relation between
E and f. The state vector of the satellite in the orbital coordinate system can be
rotated to the ECSF coordinate system by three successive rotations. First, a
clockwise rotation around the 3rd-axis from the perigee to the node is given by
(cf. Fig. 3.4)
R3ðxÞ:
Next, a clockwise rotation around the 1st-axis with the angle of inclination i is
given by
R1ðiÞ:
Finally, a clockwise rotation around the 3rd-axis from the node to the vernal
equinox is given by
R3ðXÞ:
So the state vector of the satellite in the ECSF coordinate system is then
~r
_~r
 
¼ R3ðXÞR1ðiÞR3ðxÞ ~q
_~q


;
ð3:43Þ
where
~r ¼
x
y
z
0
@
1
A;
_~r ¼
_x
_y
_z
0
@
1
A:
For the six given Keplerian elements (Ω, i, ω, a, e, M0) of t0, where M0 = n
(t0 −tp), the satellite state vector of time t can be computed, e.g., as follows:
1. Using Eq. 3.32 to compute the mean angular velocity n;
2. Using Eqs. 3.40, 3.39, 3.33, and 3.30 to compute the three anomalies M, E, f,
and r;
3. Using Eqs. 3.41 and 3.42 to compute the state vector ~q and _~q in orbital
coordinates;
4. Using Eq. 3.43 to rotate state vector ~q and _~q to the ECSF coordinates.
Keplerian elements can be given in practice at any time. For example, with t0,
where only f is a function of t0, other parameters are constants. In this case, the
related E and M can be computed by Eqs. 3.35 and 3.39; thus tp can be computed
by Eq. 3.40.
3.1  Keplerian Motion
47

From Eq. 3.42, one has
v2 ¼
a2n2
ð1  e cos EÞ2 ½sin2 E þ ð1  e2Þ cos2 E ¼ a2n2ð1 þ e cos EÞ
1  e cos E
:
ð3:44Þ
Taking Eqs. 3.32 and 3.34 into account leads to
v2 ¼ lð1 þ e cos EÞ
r
¼ lð2  r=aÞ
r
¼ lð2
r  1
aÞ;
ð3:45Þ
where v2/2 is the kinetic energy scaled by mass, μ/r is the potential energy, and a is
the semimajor axis of the ellipse. This is the total energy conservative law of
mechanics.
Rotate the vector ~q and _~q in Eqs. 3.41 and 3.42 by R3(–ω) and denote by ~p and
_~p, i.e.
~p ¼
p1
p2
p3
0
@
1
A ¼ R3ðxÞ
r cos f
r sin f
0
0
@
1
A ¼
r cosðx þ f Þ
r sinðx þ f Þ
0
0
@
1
A;
ð3:46Þ
and
_~p ¼
_p1
_p2
_p3
0
@
1
A ¼ R3ðxÞ
 sin f
e þ cos f
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
¼
 sinðx þ f Þ  e sin x
cosðx þ f Þ þ e cos x
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
:
ð3:47Þ
The reverse problem of Eq. 3.43, i.e. for given rectangular satellite state vector
ð~r; _~rÞT to compute the Keplerian elements, can be carried out as follows. ω + f is
called argument of latitude and denoted by u.
1. Using the given state vector to compute the modulus r and v ðr ¼ ~rj j; v ¼ _~r

Þ;
2. Using Eqs. 3.10 and 3.11 to compute vector ~h and its modulus h;
3. Using Eqs. 3.13 and 3.14 to compute inclination i and the right ascension of
ascending node Ω;
4. Using Eqs. 3.45, 3.29, and 3.32 to compute semimajor axis a, eccentricity e and
average angular velocity n;
5. Rotating ~r by ~p ¼ R1ðiÞR3ðXÞ~r and then using Eq. 3.46 to compute ω + f;
6. Rotating _~r by _~p ¼ R1ðiÞR3ðXÞ _~r and then using Eq. 3.47 to compute ω and f;
7. Using Eqs. 3.33, 3.39, and 3.40 to compute E, M and tp.
48
Chapter 3  Satellite Orbits

To transform the GPS state vector from the ECSF coordinate system to other
coordinate systems, the formulas discussed in Chap. 2 can be used.
3.2
Disturbed Satellite Motion
Keplerian motion of a satellite is a motion under the assumption that the satellite is
only attracted by the central force of the earth. This is, of course, an approximation.
For a satellite problem, the earth cannot be considered a mass point or a
homogenous sphere. The earth’s total force of attraction can be considered the
central force plus the non-central force. The latter is called the earth’s disturbing
force, which has an order of 10−4 compared with the central force. The other
attraction forces, which are simply called disturbing forces, are the attraction forces
of the sun and the moon, the earth and ocean tide, and surface forces such as solar
radiation pressure and atmospheric drag. The satellite motion can then be consid-
ered a nominal motion (e.g., Keplerian motion) plus a disturbed motion.
If we further use the Keplerian elements to describe the disturbed motion of the
satellite, all elements should be functions of time. Keplerian elements (Ω(t), i(t),
ω(t), a(t), e(t), M(t)) can be represented by σj(t), j = 1, …, 6, thus the polynomial
approximations are
rjðtÞ ¼ rjðt0Þ þ drjðtÞ
dt

t¼t0
ðt  t0Þ þ . . .
j ¼ 1; . . .; 6:
ð3:48Þ
In other words, the disturbed orbit can be further represented by Keplerian ele-
ments; however, all elements are time variables. If the initial elements and their
changing rates are given, the instantaneous elements can be obtained. This principle
is used in the broadcast ephemerides.
Detailed disturbing theory and orbit correction as well as orbit determination will
be discussed in Chap. 11 later.
3.3
GPS Broadcast Ephemerides
GPS broadcast ephemerides are forecasted, predicted or extrapolated satellite orbits
data, which are transmitted from the satellite to the receiver in the navigation
message. Because of the nature of the extrapolation, broadcast ephemerides do not
have enough high qualities for precise applications. The predicted orbits are curve
ﬁtted to a set of relatively simple disturbed Keplerian elements and transmitted to
the users.
3.1  Keplerian Motion
49

The broadcast messages are
SV-id
satellite number;
tc
reference epoch of the satellite clock;
a0, a1, a2
polynomial coefﬁcients of the clock error;
toe
reference epoch of the ephemerides;
ﬃﬃﬃa
p
square root of the semimajor axis of the orbital ellipse;
e
numerical eccentricity of the ellipse;
M0
mean anomaly at the reference epoch te;
ω0
argument of perigee;
i0
inclination of the orbital plane;
Ω0
longitude of the ascending node at the weekly epoch;
Δn
mean motion difference;
idot
rate of inclination angle;
_X
rate of node’s right ascension;
Cuc, Cus
correction coefﬁcients (of argument of latitude);
Crc, Crs
correction coefﬁcients (of geocentric distance);
Cic, Cis
correction coefﬁcients (of inclination).
The satellite position at epoch t can be computed as follows:
M ¼ M0 þ ð
ﬃﬃﬃﬃﬃl
a3
r
þ DnÞðt  toeÞ;
X ¼ X0 þ _Xðt  toeÞ;
x ¼ x0 þ Cuc cosð2u0Þ þ Cus sinð2u0Þ;
r ¼ r0 þ Crc cosð2u0Þ þ Crs sinð2u0Þ;
and
i ¼ i0 þ Cic cosð2u0Þ þ Cis sinð2u0Þ þ idotðt  toeÞ;
ð3:49Þ
where
E ¼ M þ e sin E;
r0 ¼ að1  e cos EÞ;
f ¼ 2 tan1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ e
p
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e
p
tan E
2


;
and
u0 ¼ x0 þ f :
ð3:50Þ
μ is the earth’s gravitational constant (which can be read from the IERS
Conventions, cf. table of constants). The satellite position in the orbital plane
coordinate system (the 1st-axis points to the ascending node, the 3rd-axis is vertical
to the orbital plane, and the 2nd-axis completes a right-handed system) is then
50
Chapter 3  Satellite Orbits

x0
y0
z0
0
@
1
A ¼
r cos u
r sin u
0
0
@
1
A;
where u = ω + f. The position vector can be rotated to the ECSF coordinate system
by R3ðXÞR1 i
ð
Þ and then rotated to the ECEF coordinate system by R3ðHÞ,
where H is Greenwich Sidereal Time and
H ¼ xeðt  toeÞ þ xetoe;
ð3:51Þ
where ωe is the angular velocity of the earth (can be read from the IERS
Conventions, cf. table of constants). The satellite position vector in the ECEF
coordinate system is then
x
y
z
0
@
1
A
ECEF
¼ R3ðX þ HÞR1ðiÞ
r cos u
r sin u
0
0
@
1
A:
ð3:52Þ
The ﬁrst equation of 3.50 is the Keplerian equation, which may be solved
iteratively. It is notable that the time t above should be the signal transmission time.
(t – toe) should be the actual total time difference of the two time epochs and must
account for the beginning and end of week crossovers (cf. Spilker 1996). That is, if
the difference is greater (or less) than 302,400 s, subtract (or add) 604,800 s. The
satellite clock error can be computed by (denoting k as the satellite’s id)
dtk ¼ a0 þ a1ðt  tcÞ þ a2ðt  tcÞ2:
ð3:53Þ
Unit seconds are used for the time variable; the computed clock error has units
of 10−6 s.
3.4
IGS Precise Ephemerides
GPS satellite precise orbits are available through the International GPS Service
(IGS) in the form of post-processed results. Such orbits data are called IGS precise
ephemerides. They can be downloaded for free from several internet homepages
(e.g., www.gfz-potsdam.de).
IGS data are given in the ECEF coordinate system. For all possible satellites, the
position vectors are given in x, y, z three components (units: km), and the related
clock errors are also given (units: 10−6 s). The data are given in a suitable time
interval (15 min).
To obtain the ephemerides of any interested epoch, a Lagrange polynomial is
used to ﬁt the given data and then to interpolate the data at the needed epoch. The
general Lagrange polynomial is (e.g., Wang et al. 1979):
3.3  GPS Broadcast Ephemerides
51

yðtÞ ¼
X
m
j¼0
LjðtÞ  yðtjÞ;
ð3:54Þ
where
LjðtÞ ¼
Y
m
k¼0
ðt  tkÞ
ðtj  tkÞ ;
k 6¼ j;
ð3:55Þ
where symbol P is a multiplying operator from k = 0 to k = m, m is the order of the
polynomial, y(tj) are given data at the time tj, Lj(t) is called the base function of
order m, and t is the time on which data will be interpolated. Generally speaking,
t should be placed around the middle of the time duration (t0, tm) if possible.
Therefore, m is usually selected as an odd number. For IGS orbit interpolation, a
standard m is selected as 7 or 9 from experience.
For the equal distance Lagrange interpolation there is
tk ¼ t0 þ kDt
t  tk ¼ t  t0  kDt
tj  tk ¼ ðj  kÞDt;
then
LjðtÞ ¼
Y
m
k¼0
ðt  t0  kDtÞ
ðj  kÞDt
;
k 6¼ j;
ð3:56Þ
where Δt is the data interval.
In order to deal with the broadcast ephemerides in a manner similar to IGS
precise ephemerides, the broadcast orbit may be ﬁrst computed and then trans-
formed to IGS-like data for use.
The forecasted IGS ephemerides are now also available to download for free.
3.5
GLONASS Ephemerides
GLONASS broadcast ephemerides are forecasted, predicted, or extrapolated
satellite orbit data, which are transmitted from the satellite to the receiver in the
navigation message. The broadcast messages include the following: satellite
number, reference epoch of the ephemerides, relative frequency offset, satellite
clock offset, satellite position, satellite velocity, satellite acceleration, time system
correction with respect to UTCSU, the time difference between GLONASS time,
and GPS time.
52
Chapter 3  Satellite Orbits

The satellite position and velocity at desired epoch t can be interpolated by using
the Lagrange polynomial discussed in Sect. 3.4, or alternatively, by a ﬁve-order
polynomial discussed in Sect. 5.4.2 where the position, velocity, and acceleration
data are used.
The precise GLONASS ephemerides are similarly available. The data has nearly
the same format as that of GPS and includes the message of the time differences of
the GLONASS time and GPS time.
3.6
Galileo Ephemerides
The Galileo Open Service allows access to two navigation message types: F/NAV
(freely accessible navigation) and I/NAV (integrity navigation). The content of the
two messages differs in various items; however, in general it is very similar to the
content of the GPS navigation message. But there are items in the navigation
message that depend on the origin of the message (F/NAV or I/NAV): The SV
clock parameters actually deﬁne the satellite clock for the dual-frequency
ionosphere-free linear combination. F/NAV reports the clock parameters valid for
the E5a-E1 combination; the I/NAV reports the parameters for the E5b-E1
combination.
3.7
BDS Ephemerides
The BDS open service broadcast navigation message is similar in content to the
GPS navigation message. The header section and the ﬁrst data record (epoch,
satellite clock information) are equal to the GPS navigation ﬁle. The following six
records are similar to GPS. Details can be referred to IGS RINEX format (2015).
References
IGS, RTCM-SC104 (2015) RINEX- The Receiver Independent Exchange Format (Version 3.03).
ftp://igs.org/pub/data/format/rinex303.pdf
Spilker JJ (1996) GPS navigation data. In: Parkinson BW, Spilker JJ (eds) Global Positioning
System: Theory and applications, Vol. I, Chapter 4
Wang LX, Fang ZD, Zhang MY, Lin GB, Gu LK, Zhong TD, Yang XA, She DP, Luo ZH,
Xiao BQ, Chai H, Lin DX (1979) Mathematic handbook. Educational Press, Peking, ISBN
13012-0165
3.5  GLONASS Ephemerides
53

Chapter 4
GPS Observables
The basic GPS observables are code pseudoranges and carrier phases as well as
Doppler measurements. The principle of the GPS measurements and their mathe-
matical expressions are described.
4.1
Code Pseudoranges
The pseudorange is a measure of the distance between the satellite and the recei-
ver’s antenna. The distance is measured by measuring the GPS signal transmission
time from the satellite to the GPS receiver’s antenna. Therefore, this refers to the
distance between the satellite at the time of GPS signal emission and the GPS
antenna at the time of GPS signal reception. The transmission time is measured
through maximum correlation analysis of the receiver code and the GPS signal. The
receiver code is derived from the clock used in the GPS receiver. The GPS signal,
of course, is generated by the clock used in the GPS satellite. The measured
pseudorange is different from the geometric distance between the satellite and the
receiver’s antenna because of both the errors of the clocks and the inﬂuence of the
signal transmission mediums. It is also notable that the path of the signal trans-
mission differs slightly from the geometric path. The transmission medium not only
delays transmission of the signal, but also bends its transmission path.
The GPS signal emission time of the satellite is denoted by te, and the GPS
signal reception time of the receiver is denoted by tr. In case of vacuum medium and
error-free situation, the measured pseudorange is equal to the geometric distance
and can be presented by
Rs
rðtr; teÞ ¼ ðtr  teÞc;
ð4:1Þ
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_4
55

where c denotes the speed of light, and subscript r and superscript s denote the
receiver and satellite, respectively. On the left-hand side, tr denotes the epoch at
which the pseudorange is measured.
te and tr are considered true emission time and reception time of the GPS signal.
Taking both the satellite and receiver clock errors into account, the pseudorange can
be represented as
Rs
rðtr; teÞ ¼ ðtr  teÞc  ðdtr  dtsÞc;
ð4:2Þ
where δtr and δts denote the clock errors of the receiver and satellite, respectively.
The GPS satellite clock error term δts is indeed known through GPS satellite orbit
determination. The clock errors are usually modelled by polynomials of time. The
constant term represents the bias and the linear term the drift of the clocks. These
coefﬁcients are transmitted along with the navigation message to the users. More
precisely, the satellite clock error corrections can also be obtained from all IGS data
centres (cf., e.g., www.gfz-potsdam.de). They are determined along with the precise
IGS orbits and have higher resolution in time.
The geometric distance of the ﬁrst term on the right-hand side of Eq. 4.2 is
given by
qs
rðtr; teÞ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxs  xrÞ2 þ ðys  yrÞ2 þ ðzs  zrÞ2
q
;
ð4:3Þ
where the satellite coordinate vector (xs, ys, zs) is a vector function of the time te,
and the receiver coordinate (xr, yr, zr) is a function of the time tr. Therefore, the
geometric distance is indeed a function of two time variables. Furthermore, the
emission time te is unknown in practice. Denoting the transmission time as Δt,
there is
Dt ¼ tr  te:
ð4:4Þ
For illustrating the transmission time computation, the geometric distance can be
generally written as
qs
rðtr; teÞ ¼ qs
rðtr; tr  DtÞ:
ð4:5Þ
The transmission time of the signal travelling from the GPS satellite to the receiver
is about 0.07 s. The geometric distance function on the right-hand side of Eq. 4.5
can be expanded into a Taylor series at the reception time tr with respect to the
transmission time by
qs
r(tr,te) = qs
r(tr) + dqs
rðtrÞ
dt
Dt;
ð4:6Þ
where dρr
s(tr)/dt denotes the time derivation of the radial distance between satellite
and receiver. The second term on the right-hand side of Eq. 4.6 is called the
56
Chapter 4  GPS Observables

transmission time correction. It is notable that the coordinates of GPS antennas are
usually given in the ECEF coordinate system. During the signal transmission, the
receiver rotates with the earth; therefore, in computing the distance of Eq. 4.3, the
so-called earth rotation correction must be considered.
Taking the ionospheric effects, tropospheric effects, the earth’s tide and loading
tide effects, multipath and relativistic effects, as well as remaining errors into
account, the pseudorange model Eq. 4.2 can be completed by
Rs
r(tr,te) = qs
r(tr,te)  (dtr  dts)c + dion + dtro + dtide + dmul + drel + e: ð4:7Þ
where the measured pseudorange is on the left-hand side, it equals to the geometric
distance between the satellite at the emission time and the antenna at the reception
time plus or minus several corrections. The clock error corrections are scaled by the
velocity of light c. δion and δtro denote the ionospheric and tropospheric effects of
the station r. δtide denotes the earth’s tide and ocean loading tide effects, δmul
denotes the multipath effects, and δrel denotes the relativistic effects. The remaining
errors are denoted by ε. For convenience, unit meter is used for all terms and
instrumental biases are omitted here.
The height of the GPS satellite is about 20,200 km; thus, the GPS signal
transmission time is about 0.07 s. The earth rotates during the signal transition. The
angular velocity of the earth’s rotation is about 15 arcsecs–1. The related earth
rotation correction is about 1 arcsec (cf. Goad 1996a, b). The effects of such a
correction depend on the latitude of the station. At the equator, 1 arcsec rotation is
equivalent to about 31 m position displacement. The clock errors can be very big.
There are examples where the negative pseudoranges are observed in practice.
The above-discussed pseudorange model is generally valid for both C/A code and
P code. The precision of the pseudorange measurements depends on the electronic
abilities. Generally speaking, it is no problem nowadays to measure with precision
up to 1 % of the chip length. Therefore, the C/A code has a precision of about 3 m,
and the P code 30 cm. The mentioned corrections will be discussed later in detail.
4.2
Carrier Phases
The carrier phase is a measure of the phase of the received satellite signal relative to
the receiver-generated carrier phase at the reception time. The measurement is made
by shifting the receiver-generated phase to track the received phase. The number of
full carrier waves between the receiver and the satellite cannot be accounted for at
the initial signal acquisition. Therefore, measuring the carrier phase is to measure
the fractional phase and to keep track of changes in the cycles. The carrier phase
observable is indeed an accumulated carrier phase observation. The fractional
carrier phase can be measured by electronics with precision better than 1 % of the
wavelength, which corresponds to millimetre precision. This is also the reason why
4.1  Code Pseudoranges
57

the phase measurement is more precise than that of the code. A full carrier wave is
called a cycle. The ambiguous integer number of cycles in the carrier phase mea-
surement is called ambiguity. The initial measuring has correct fractional phase and
an arbitrary integer counter setting at the start epoch. Such an arbitrary initial setting
will be adjusted to the correct one by modelling with ambiguity parameters.
In the case of a vacuum medium and an error-free situation, the measured phase
can be presented by
Us
rðtrÞ ¼ UrðtrÞ  UsðtrÞ þ Ns
r ;
ð4:8Þ
where subscript r and superscript s denote the receiver and satellite, respectively. tr
denotes the GPS signal reception time of the receiver. Φr denotes the phase of
receiver’s oscillator. Φs denotes the received signal phase of the satellite. Ns
r is the
ambiguity related to receiver r and satellite s.
There is an interesting property of the signal phase transmission, i.e. the received
phase of the satellite signal at the reception time is exactly the same as the phase of
the emitted satellite signal at the emission time (Remondi 1984; Leick 1995), i.e.
UsðtrÞ ¼ Us
eðtr  DtÞ;
ð4:9Þ
where Us
e denotes the satellite emitted phase and Δt is the GPS signal transmission
time. This can be represented by
Dt ¼ qs
rðtr; teÞ
c
;
ð4:10Þ
where qs
rðtr; teÞ is geometric distance between the satellite at the emission time te,
and the GPS antenna at the reception time tr, c is the speed of light. Then Eq. 4.8
can be written as:
Us
rðtrÞ ¼ UrðtrÞ  Us
eðtr  DtÞ þ Ns
r :
ð4:11Þ
Suppose the initial time is zero and the received satellite signal and the reference
carrier of the receiver have the nominal frequency f. Then one has
UrðtrÞ ¼ f tr and
ð4:12Þ
Us
eðtr  DtÞ ¼ f ðtr  DtÞ:
ð4:13Þ
Substituting Eqs. 4.10, 4.12, and 4.13 into Eq. 4.11 gives
Us
rðtrÞ ¼ qs
rðtr; teÞf
c
þ Ns
r :
ð4:14Þ
Taking both the satellite and receiver clock errors into account, the carrier phase can
be represented as
58
Chapter 4  GPS Observables

Us
rðtrÞ ¼ qs
rðtr; teÞf
c
 f ðdtr  dtsÞ þ Ns
r ;
ð4:15Þ
where δtr and δts denote the clock errors of the receiver and satellite, respectively.
The frequency f and wavelength λ have the relation of
c ¼ f k:
ð4:16Þ
Taking the ionospheric effects, tropospheric effects, the earth’s tide and loading
tide effects, multipath and relativistic effects as well as remaining errors into
account, the carrier phase model Eq. 4.15 can be completed by
Us
rðtrÞ ¼ qs
rðtr; teÞ
k
 f ðdtr  dtsÞ þ Ns
r
 dion
k
þ dtro
k þ dtide
k
þ dmul
k
þ drel
k þ e
k
ð4:17Þ
or
kUs
rðtrÞ ¼ qs
rðtr; teÞ  ðdtr  dtsÞc þ kNs
r
 dion þ dtro þ dtide þ dmul þ drel þ e;
ð4:18Þ
where the measured phase on the left-hand side with a factor of λ equals the
geometric distance between the satellite at the emission time and the antenna at the
reception time plus or minus several corrections. The clock error corrections are
scaled by the speed of light c. δion and δtro denote the ionospheric and tropospheric
effects of the station r. δtide denotes the earth tide and ocean loading tide effects. The
multipath and relativistic effects as well as remaining errors are denoted by δmul,
δrel, ε respectively. Equation 4.18 is convenient to use, because all terms have units
of length (meter). It is notable that the sign of the ionospheric term is negative,
whereas in the pseudorange model it is positive (see Sect. 4.1). This will be dis-
cussed later in Sect. 5.1 in detail.
During GPS signal tracking, the phase and the integer account are continuously
modelled and frequently measured. In this way, the changing oscillator frequency is
accounted for. Every time the phase is measured, the coefﬁcients in the tracking loop
model are updated (Remondi 1984) to ensure sufﬁcient precision of measurement.
4.3
Doppler Measurements
The Doppler effect is a phenomenon of frequency shift of the electromagnetic signal
caused by the relative motion of the emitter and receiver. Supposing the emitted
signal has the nominal frequency f, the radial velocity of the satellite related to the
receiver is
4.2  Carrier Phases
59

Vq ¼ ~V  ~Uq ¼ ~V
  cos a;
ð4:19Þ
where ~V is the velocity vector of the satellite related to the receiver, V ¼ ~V
 ; ~Uq is
the identity vector in the direction from the receiver to the satellite, α is the pro-
jection angle of the vector ~V to ~Uq (see Fig. 4.1), index ρ is the distance from the
receiver to satellite. Then the received signal has a frequency of
fr ¼ f
1 þ Vq
c

1
 f
1  Vq
c


;
ð4:20Þ
where c is the speed of light. The Doppler frequency shift is then
fd ¼ f  fr  f Vq
c ¼ Vq
k ¼ dq
kdt ;
ð4:21Þ
where λ = (f/c) is the wavelength.
The Doppler count (or integrated Doppler) D is the historical observable of the
TRANSIT satellite and is the integration of the frequency shift over a time interval
(ca. 1 min). If the time interval is selected small enough, the Doppler count is the
same as the instantaneous frequency shift, or
D ¼ dq
kdt :
ð4:22Þ
The approximate predicted Doppler frequency shift is required to get the satellite
signal acquired. Prediction of D is a part of the GPS signal tracking process. The
predicted D is used to predict the phase change ﬁrst, and then the phase change is
compared with the measured value to get the precise value of the Doppler frequency
shift. The accumulated integer account of cycles is obtained through a polynomial
ﬁtting of a series of predicted phase changes and measured values (Remondi 1984).
Therefore, the Doppler frequency shift is a by-product of the carrier phase
Fig. 4.1 Doppler effects
60
Chapter 4  GPS Observables

measurements. However, the Doppler frequency shift is an independent observable
and a measure of the instantaneous range rate.
Note that in an error-free environment, dρ/(λdt) is the same as dΦ/dt and Φ is the
phase measurement discussed in Sect. 4.2. Then the model of Eq. 4.22 can be
obtained by differentiating the Eq. 4.17 with respect to the time t:
D ¼ dqs
rðtr; teÞ
kdt
 f db
dt þ df þ e;
ð4:23Þ
where β is the term of clock error (δtr – δts), δf is the frequency correction of the
relativistic effects and ε is error. Effects with low frequency properties such as
ionosphere, troposphere, tide, and multipath effects are cancelled out.
References
Goad C (1996a) Single-site GPS models. In: Kleusberg A, Teunissen PJG (eds) GPS for geodesy.
Springer-Verlag, Berlin
Goad C (1996b) Short distance GPS models. In: Kleusberg A, Teunissen PJG (eds) GPS for
geodesy. Springer-Verlag, Berlin
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York
Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative
geodesy: Modelling, processing, and results. University of Texas at Austin, Center for Space
Research
4.3  Doppler Measurements
61

Chapter 5
Physical Inﬂuences of GPS Surveying
This chapter covers all physical inﬂuences of GPS observations, including iono-
spheric effects, tropospheric effects, relativistic effects, earth tide and ocean loading
tide effects, clock errors, antenna mass centre and phase centre corrections, mul-
tipath effects, anti-spooﬁng and historical selective availability, and instrumental
biases. Theories, models, and algorithms are discussed in detail.
5.1
Ionospheric Effects
The ionospheric effect is an important error source in GPS measurements. The amount
of ionospheric delay or advance of the GPS signal can vary from a few metres to more
than 20 m within 1 day. It is generally difﬁcult to model the ionospheric effects
because of complicated physical interactions between the geomagnetic ﬁeld and solar
activity. However, the ionosphere is a dispersive medium, i.e. the ionospheric effect is
frequency-dependent. This property is used to design the GPS system with several
working frequencies such that ionospheric effects can be measured or corrected.
5.1.1
Code Delay and Phase Advance
The phase velocity vp of an electromagnetic wave with one frequency propagating
in space can be represented by
vp ¼ kf ;
ð5:1Þ
where λ is the wavelength and f is the frequency; index p denotes phase. This
formula is valid for both GPS L1 and L2 phase signals.
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_5
63

A modulated signal will propagate in space with a velocity that is called group
velocity. Group velocity is different from phase velocity. The relationship between
group velocity and phase velocity was described more than 100 years ago by
Rayleigh (Seeber 1993):
mg ¼ mp  k dvp
dk ;
ð5:2Þ
where dvp/dλ is the differentiation of vp with respect to wave length λ; index g
denotes group. This group velocity is valid for GPS code measurements.
From Eq. 5.1, one has the total differentiation
dk
k ¼  df
f ;
ð5:3Þ
and Eq. 5.2 can be rewritten as
vg ¼ vp þ f dvp
df :
ð5:4Þ
If the electromagnetic wave is transmitted in vacuum space, the phase velocity
and the group velocity are the same and are equal to the speed of light in a vacuum.
In such a case, the medium is called non-dispersive; otherwise, the medium is called
dispersive. Two factors np and ng are introduced so that both
vgng ¼ c
and
ð5:5Þ
vpnp ¼ c
ð5:6Þ
are valid. These two factors np and ng are called refractive indices. The refractive
index characterises how the medium delays or advances the signal propagating
velocity from the speed of light in a vacuum.
Differentiation of vp with respect to frequency f can then be obtained from
Eq. 5.6 by
dvp
df ¼  c
n2
p
dnp
df


:
ð5:7Þ
Substituting the above three formulas into Eq. 5.4 yields
c
ng
¼ 1
n2
p
cnp  fc dnp
df


or
ng ¼
n2
p
np  f dnp
df
:
ð5:8Þ
64
Chapter 5  Physical Inﬂuences of GPS Surveying

Using the mathematical expansion
ð1  xÞ1 ¼ 1 þ x  x2    
xj j\1;
ð5:9Þ
Equation 5.8 can be approximated to the ﬁrst order by
ng ¼ np þ f
dnp
df


:
ð5:10Þ
The phase refractive index can be represented by
np ¼ 1 þ a1
f 2 þ a2
f 3 þ    ;
ð5:11Þ
where coefﬁcients a1 and a2 depend on the electron density Ne and can be deter-
mined. Substituting Eq. 5.11 into Eq. 5.10 yields
ng ¼ 1  a1
f 2  2a2
f 3 :
ð5:12Þ
The change of the length of the signal transmitting path in the medium with
refractivity n is
Dr ¼
Z
ðn  1Þds:
ð5:13Þ
Integration is done along the signal transmitting path. Therefore, the ionospheric
effects on the phase and code signal transmission can be represented as
dp ¼
Z
ðnp  1Þds ¼
Z
a1
f 2 þ a2
f 3


ds
and
dg ¼
Z
ðng  1Þds ¼
Z
 a1
f 2  2a2
f 3


ds:
ð5:14Þ
Omitting the second term on the right-hand side, one gets
dp ¼ dg ¼
Z
a1
f 2


ds:
ð5:15Þ
Thus the ionospheric effects on the phase and code measurements have opposite
signs and have approximately the same value. The coefﬁcient a1 was estimated by
cf. Seeber (1993)
a1 ¼ 40:3Ne;
ð5:16Þ
where Ne is the electron density.
5.1  Ionospheric Effects
65

The total electron content (TEC) in the zenith direction can be deﬁned as
TEC ¼
Z
zenith
Neds;
ð5:17Þ
which can be computed from special models. To combine the TEC in the zenith and
in the signal transmitting path, a so-called slant factor or mapping function must be
introduced, which will be discussed in detail in Sect. 5.1.4.
The electron density always has a positive value; therefore, δg has a positive
value and δp is negative. In other words, the ionosphere delays the code signal
transmission and advances the phase signal transmission.
5.1.2
Elimination of Ionospheric Effects
Dual-Frequency Combination
The ionospheric effects on the phase (cf. Sect. 5.1.1) is rewritten as
dp ¼ A1
f 2 ;
where
A1 ¼
Z
a1ds:
ð5:18Þ
For the dual-frequency GPS phase observations, the ionospheric effects can be
written as
dpðf1Þ ¼ A1
f 2
1
and
ð5:19Þ
dpðf2Þ ¼ A1
f 2
2
:
ð5:20Þ
It is clear that the following combination leads to an elimination of the ionospheric
effects:
f 2
1 dpðf1Þ  f 2
2 dpðf2Þ ¼ 0:
ð5:21Þ
In other words, through linear combination of the GPS phase observations, the
ionospheric effects can be eliminated. The above discussion is valid for both the
code and carrier phase measurements of dual-frequencies, i.e. there is
f 2
1 dgðf1Þ  f 2
2 dgðf2Þ ¼ 0:
ð5:22Þ
66
Chapter 5  Physical Inﬂuences of GPS Surveying

It should be pointed out that such ionosphere-free combination is indeed a
ﬁrst-order approximation because of the omission of the terms of the second-order
ionospheric effects of Eqs. 5.14 in 5.15. Furthermore, the combinations of
Eqs. 5.21 and 5.22 have to be standardised by dividing f1
2 −f2
2, so that the combined
code and phase observations also have the sense that they are code and phase
observables at a special frequency. The standard (ﬁrst-order) ionosphere-free phase
and code combinations can be represented then as
f 2
1 dpðf1Þ  f 2
2 dpðf2Þ
f 2
1  f 2
2
¼ 0
and
ð5:23Þ
f 2
1 dgðf1Þ  f 2
2 dgðf2Þ
f 2
1  f 2
2
¼ 0:
ð5:24Þ
Formally the combined observations are observed at frequency
f ¼ f 2
1 f1  f 2
2 f2
f 2
1  f 2
2
;
ð5:25Þ
which has a wavelength of λ = c/f, where c is the speed of light in a vacuum.
Triple-Frequency Combination
As mentioned above, a dual-frequency combination can only eliminate the
ﬁrst-order ionospheric effects. It is clear that a triple-frequency combination can
eliminate the ionospheric effects up to the second order.
The ionospheric effects on the phase (cf. Sect. 5.1.1) are rewritten as
dp ¼ A1
f 2 þ A2
f 3 ;
where
A1 ¼
Z
a1ds;
A2 ¼
Z
a2ds:
ð5:26Þ
For the triple-frequency GPS phase observations, the ionospheric effects can be
written as
dpðf1Þ ¼ A1
f 2
1
þ A2
f 3
1
;
ð5:27Þ
dpðf2Þ ¼ A1
f 2
2
þ A2
f 3
2
and
ð5:28Þ
dpðf5Þ ¼ A1
f 2
5
þ A2
f 3
5
:
ð5:29Þ
5.1  Ionospheric Effects
67

The ﬁrst-order ionosphere-free combinations can be formed as
f 2
1 dpðf1Þ  f 2
2 dpðf2Þ ¼ A2
f1
 A2
f2
and
ð5:30Þ
f 2
1 dpðf1Þ  f 2
5 dpðf5Þ ¼ A2
f1
 A2
f5
;
or
ð5:31Þ
f 2
1 dpðf1Þ  f 2
2 dpðf2Þ
1
f1  1
f2
¼ A2
and
ð5:32Þ
f 2
1 dpðf1Þ  f 2
5 dpðf5Þ
1
f1  1
f5
¼ A2:
ð5:33Þ
Then the second-order ionosphere-free combination can be formed by
ðf 2
1 dpðf1Þ  f 2
2 dpðf2ÞÞðf1f2Þ
ðf2  f1Þ
 ðf 2
1 dpðf1Þ  f 2
5 dpðf5ÞÞðf1f5Þ
ðf5  f1Þ
¼ 0
ð5:34Þ
or
B1dpðf1Þ þ B2dpðf2Þ þ B5dpðf5Þ ¼ 0;
ð5:35Þ
where
B1 ¼ f 3
1 f1
ðf5  f2Þ
ðf2  f1Þðf5  f1Þ ;
ð5:36Þ
B2 ¼  f 3
2 f1
f2  f1
and
ð5:37Þ
B5 ¼
f 3
5 f1
f5  f1
:
ð5:38Þ
A standardisation of the combination in Eq. 5.35 can be made through
B1dpðf1Þ þ B2dpðf2Þ þ B5dpðf5Þ
B1 þ B2 þ B5
¼ 0
or
ð5:39Þ
C1dpðf1Þ þ C2dpðf2Þ þ C5dpðf5Þ ¼ 0;
ð5:40Þ
68
Chapter 5  Physical Inﬂuences of GPS Surveying

where
C1 ¼ f 3
1 ðf5  f2Þ
C4
;
ð5:41Þ
C2 ¼  f 3
2 ðf5  f1Þ
C4
;
ð5:42Þ
C5 ¼ f 3
5 ðf2  f1Þ
C4
and
ð5:43Þ
C4 ¼ f 3
1 ðf5  f2Þ  f 3
2 ðf5  f1Þ þ f 3
5 ðf2  f1Þ:
ð5:44Þ
The
above
discussion
is
also
valid
for
the
code
measurements
of
triple-frequencies, i.e. there is
C1dgðf1Þ þ C2dgðf2Þ þ C5dgðf5Þ ¼ 0:
ð5:45Þ
Phase-Code Combination
Recalling the discussion in Sect. 5.1.1 and limiting ourselves to the ﬁrst-order
approximation, the ionospheric effects on the phase and code measurements have
opposite signs and have approximately the same value, i.e.
dp ¼ dg ¼ A1=f 2;
where
A1 ¼
Z
a1ds:
ð5:46Þ
Therefore, a straightforward method to eliminate the ionospheric effects is then to
combine the phase and code observables at the same frequency f together, i.e.
dpðf Þ þ dgðf Þ ¼ 0:
ð5:47Þ
It is notable that such a combination has lower precision than that of the carrier
phase and code measurements, respectively.
5.1.3
Ionospheric Models
The Broadcast Ionospheric Model
The GPS broadcast message includes the parameters of a predicted ionospheric
model (Klobuchar 1996; Leick 1995). Using the model parameters, the ionospheric
effects can be computed and corrected.
5.1  Ionospheric Effects
69

The input parameters of the broadcast ionospheric model are the eight model coef-
ﬁcients of αi, βi, i = 1, 2, 3, 4, geodetic latitude φ and longitude λ of the GPS antenna,
GPS observing time T in seconds, as well as the azimuth A and elevation E of the
observed satellite. All four angular arguments φ, λ, A, and E have units of semicircles
(SC), and 1 SC equals 180 degrees. The formulas are given below:
F ¼ 1 þ 16ð0:53  EÞ3;
ð5:48Þ
W ¼ 0:0137
E þ 0:11  0:022;
ð5:49Þ
ui ¼ u þ W cos A;
ð5:50Þ
ui ¼ 0:416ui
ui
j
j
;
if
ui
j
j [ 0:416;
ð5:51Þ
ki ¼ k þ w sin A
cos ui
;
ð5:52Þ
/ ¼ ui þ 0:064 cosðki  1:167Þ;
ð5:53Þ
t ¼ ki43;200 þ T;
ð5:54Þ
t ¼ t  86;400;
if
t  86;400;
ð5:55Þ
t ¼ t þ 86;400;
if
t\0;
ð5:56Þ
P ¼
X
4
i¼1
bi/i;
ð5:57Þ
P ¼ 72;000;
if
P\72;000;
ð5:58Þ
x ¼ 2pðt  50;400Þ
P
;
ð5:59Þ
Q ¼
X
4
i¼1
ai/i;
ð5:60Þ
Q ¼ 0;
if
Q\0;
ð5:61Þ
dgðf1Þ ¼ cF5  109;
if
xj j [ 1:57
and
ð5:62Þ
dgðf1Þ ¼ cF 5  109 þ Q 1  x2
2 þ x4
24




;
if
xj j\1:57:
ð5:63Þ
70
Chapter 5  Physical Inﬂuences of GPS Surveying

φi and λi are the geodetic latitude and longitude of the sub-ionospheric point. The
ionospheric point is deﬁned as the point on the sight of the satellite, which has the
average ionospheric height (350 km), and the sub-ionospheric point is the projec-
tion point of the ionospheric point onto the earth’s surface, which has a height of
50 km, ϕ being the geomagnetic latitude of the sub-ionospheric point. ψ is the
earth’s central angle between the GPS station and the ionospheric point. F is the
slant factor or mapping function that maps the ionospheric effects of the zenith
direction onto the signal transmitting path. The local time at the sub-ionospheric
point is denoted by t. P and Q are the period and amplitude in seconds. The phase is
denoted by x. c is the speed of light. Frequency of L1 is denoted by f1.
The ionospheric group delay on the L2 frequency can be computed by
dgðf2Þ ¼ f 2
1
f 2
2
dgðf1Þ:
ð5:64Þ
The phase advance has only an opposite sign if the phase has been scaled to have
units of length. Dividing the length with the wavelength can transform units of
length to units of cycle.
Figure 5.1 shows the ionospheric effects of the broadcasted ionospheric model
of 9 September 2001. The ionospheric parameters are
ðaiÞ ¼
3073
1490
11;920
11;920
ð
Þ  1011
and
ðbiÞ ¼
1372
1638
1966
3932
ð
Þ  10 þ 2:
Station coordinates are selected as (φ = 45°, λ = 0°). Computation has been carried
out for a whole day of 24 h in GPS time. The continuous line shows the ionospheric
effects on a satellite that repeats its orbit every 4 h and changes its elevation and
azimuth regularly from (5–85–5°) and (30–150°), respectively. The broken line
shows the (zenith) ionospheric effects of a space ﬁxed satellite in the zenith
direction (elevation = 90°, azimuth = 180°). It shows the strong dependency of the
Fig. 5.1 Broadcasted
ionospheric model
5.1  Ionospheric Effects
71

ionospheric effects on the time and zenith angle of the satellite. In the zenith
direction, the ionospheric effects remain constant (1.5 m) before 9:00 and after
19:00. Strong changes happen at the time of sunrise and sunset and the ionospheric
noon (14:00). Depending on the elevation of the satellite, the ionospheric effects
may be ampliﬁed up to three times.
The broadcast ionospheric model can remove the ionospheric delay more than
50 % (Langley 1998a, b).
Dual-Frequency Ionosphere Measuring Model
In pseudorange measurement only the ionospheric effects depend on the working
frequency.
Therefore,
a
simple
difference
of
the
pseudoranges
of
the
dual-frequencies can eliminate all other effects except the ionospheric effects and
subsequently can be used for determining the ionospheric delay:
R1  R2 ¼ dgðf1Þ  dgðf2Þ ¼
1  f 2
1
f 2
2


dgðf1Þ
or
ð5:65Þ
dgðf1Þ ¼ R1  R2
1 
f 2
1
f 2
2
;
ð5:66Þ
where R1 and R2 are the L1 and L2 pseudoranges, and f1 and f2 are the frequencies
of the L1 and L2 carriers. Here the random measurement error and un-modelled
bias are omitted.
Similarly, the ionospheric effects can be determined by dual-frequency phase
observables. Recall the phase observable model discussed in Sect. 4.2 where a
simple differential combination of both phase pseudoranges can be formed as
k1U1  k2U2 ¼ dpðf1Þ  dpðf2Þ þ k1N1  k2N2
¼ ð1  f 2
1
f 2
2
Þdpðf1Þ þ k1N1  k2N2;
ð5:67Þ
or
dpðf1Þ ¼ k1U1  k2U2  k1N1 þ k2N2
1 
f 2
1
f 2
2
;
ð5:68Þ
where Φ1 and Φ2 are the L1 and L2 phase pseudoranges (in units of cycles), and N1
and N2 are the ambiguities of the L1 and L2 carriers. The random measurement
error and un-modelled bias are omitted here. As long as the phase measurements are
continuous (no cycle slips), the λ1N1 −λ2N2 remains a constant. Through a
long-term statistic comparison of Eqs. 5.66 and 5.68, the constant λ1N1 −λ2N2 can
be approximately determined. The variation of the ionospheric effects can be
determined very well by using this method.
72
Chapter 5  Physical Inﬂuences of GPS Surveying

5.1.4
Mapping Functions
As mentioned in Sect. 5.1.1, in order to combine the TEC in the zenith direction and in
the signal transmitting path, the slant factor or mapping function F is needed such that
TECq ¼ TECzF;
ð5:69Þ
where indices ρ and z denote the path and zenith directions, respectively.
Generally, the ionosphere begins at a height of 50 km and ends at a height of
about 750 km. It is therefore assumed that the ionosphere has an average height of
350 km (see Fig. 5.2). The sight line of the satellite crosses over the shell at the
so-called ionospheric point. The projection of the ionospheric point at a height of
50 km is called the sub-ionospheric point. The point at the sight line of the satellite
at a height of 50 km is called the sub-ionospheric point in sight. The point at the
sight line of the satellite at a height of 750 km is called the sup-ionospheric point in
sight. These four points are denoted by Pip, Psip, Psips, and Psupip respectively.
Projection Mapping Function
Based on a single layer model, a homogeneous distribution of the free electrons
is assumed (Fig. 5.2). This is equivalent to assuming all free electrons are con-
centrated in a shell of inﬁnitesimal thickness at a height of 350 km. In such a case,
the mapping function may be written as
F ¼
1
cos zip
;
ð5:70Þ
where zip is the satellite zenith angle at the ionospheric point. Using the sinus
theorem, the relationship between the zip and zenith distance (z) of the satellite
viewed from the receiver can be obtained by
sin zip ¼
r
r þ 350 sin z;
ð5:71Þ
Fig. 5.2 Single-layer
ionospheric model
5.1  Ionospheric Effects
73

where r is the mean radius of the earth in km. This mapping function is called a
single layer mapping function or projection mapping function. It is notable that
Eq. 5.71 is exactly valid only for the spherical zenith angles.
Geometric Mapping Function
If a height-dependent homogeneous distribution of the free electrons is assumed,
then the mapping function is a geometric one and is equivalent to
dq ¼ dHF;
ð5:72Þ
where dρ and dH are the ionospheric path delay and zenith delay respectively.
The zenith angle of the satellite at the sub-ionospheric point (in sight) Psips is
denoted by zsips (Fig. 5.3). It can be computed by using the sinus theorem
sin zsips ¼
r
r þ 50 sin z;
ð5:73Þ
where z is the zenith angle of the satellite viewed from the receiver and r is the
mean radius of the earth in km. In the geometry, the spherical zenith angles are used
here.
The difference between the spherical zenith and geodetic zenith depends on the
latitude of the station and the azimuth of the satellite. The maximum difference is
the difference between geodetic latitude and geocentric latitude of the computing
point; this is about (e2/2)sin(2φ) (Torge 1991), where e2 is the ﬁrst numerical
eccentricity (<0.0067) and φ is the geodetic latitude of the computing point.
Therefore, the small angle difference can be omitted. Of course, for correctness the
spherical zenith angle should be used here. It is the angle of the sight line to satellite
with respect to the earth centred radius vector of the station. Using the cosines
theorem, one has
ðr þ 50 þ HÞ2 ¼ ðr þ 50Þ2 þ q2  2ðr þ 50Þq cosð180  zsipsÞ
ð5:74Þ
Fig. 5.3 Spherical
ionospheric model
74
Chapter 5  Physical Inﬂuences of GPS Surveying

or
q2 þ 2ðr þ 50Þ cosðzsipsÞq þ ðr þ 50Þ2  ðr þ 50 þ HÞ2 ¼ 0;
ð5:75Þ
where ρ and H are the lengths of lines from the sup-ionospheric point to the
sub-ionospheric point in sight and sub-ionospheric point, respectively. The
second-order equation can be solved by
q ¼ ðr þ 50Þ cosðzsipsÞ 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ 50Þ2 cos2ðzsipsÞ  ðr þ 50Þ2 þ ðr þ 50 þ HÞ2
q
ð5:76Þ
or
q ¼ ðr þ 50Þ cosðzsipsÞ 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ 50 þ HÞ2  ðr þ 50Þ2 sin2ðzsipsÞ
q
:
ð5:77Þ
Because ρ > 0, Eq. 5.75 has a unique solution,
q ¼ ðr þ 50Þ cosðzsipsÞ þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ 50 þ HÞ2  ðr þ 50Þ2 sin2ðzsipsÞ
q
:
ð5:78Þ
Comparing Eqs. 5.72 with 5.78, one gets the geometric mapping function
F ¼  r þ 50
H
cosðzsipsÞ þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ 50 þ HÞ2  ðr þ 50Þ2 sin2ðzsipsÞ
q
H
ð5:79Þ
or approximately
F ¼ 9:183 cosðzsipsÞ þ 10:183
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  0:81 sin2ðzsipsÞ
q
;
ð5:80Þ
where r = 6378 km and H = 700 km are used.
Above, the derived geometric mapping function of Eq. 5.79 is a spherical
approximation if r is considered a constant. This mapping function could be called
Xu’s geometric mapping function (Xu 2003).
Ellipsoidal Mapping Function
Taking the dependency of the radius r on the latitude φ into account, an ellip-
soidal mapping function can be derived. According to Torge (1991),
r2 ¼ a2 cos2 b þ b2 sin2 b
and
tan b ¼ b
a tan u;
ð5:81Þ
5.1  Ionospheric Effects
75

where r is the radius of the rotational ellipsoid, a and b are the semi-major axis and
semi-minor axis of the ellipsoid, and β is an angle that has the relation with
geodetic latitude φ. Using the triangle formula
2 cos2 b  1 ¼ 1  2 sin2 b ¼ 1  tan2 b
1 þ tan2 b ;
ð5:82Þ
Equation 5.81 can be rewritten as
r2 ¼ a2
2
1  tan2 b
1 þ tan2 b þ 1


þ b2
2
1  1  tan2 b
1 þ tan2 b


;
ð5:83Þ
or
r2 ¼ a2
2
a2  b2 tan2 u
a2 þ b2 tan2 u þ 1


þ b2
2
1  a2  b2 tan2 u
a2 þ b2 tan2 u


:
ð5:84Þ
In an ellipsoid case, Eqs. 5.74 and 5.79 turn out to be
ðrs þ 50 þ HÞ2 ¼ ðri þ 50Þ2 þ q2  2ðri þ 50Þq cosð180  zsipsÞ
and
F ¼  ri þ 50
H
cosðzsipsÞ þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðrs þ 50 þ HÞ2  ðri þ 50Þ2 sin2ðzsipsÞ
q
=H;
ð5:85Þ
where rs and ri denote the geocentric radius of the sub-ionospheric point and
sub-ionospheric point in sight, respectively. They can be obtained by substituting
the geodetic latitudes φs and φi of the related two positions into Eq. 5.84. The
ellipsoidal mapping function is then Eq. 5.85. This mapping function could be
called Xu’s ellipsoidal mapping function (Xu 2003).
The mapping functions are needed if the ionospheric effects have to be deter-
mined. In Eq. 5.72, dρ may be considered to be an ionospheric path delay observed
by GPS, and dH may be considered to be an ionospheric model, which is inde-
pendent of the path zenith such as that given in Eq. 5.27. The determined param-
eters then have the physical meaning of the TEC in the zenith direction.
5.1.5
Introduction of Commonly Used Ionospheric Models
Ionospheric delay models can generally be grouped into two types: (1) empirical
models, which are based on data to represent the characteristic variation patterns
seen in long data records (e.g., Klobuchar model, IRI model, NeQuick model,
NTCM-GL model); and (2) mathematical function models, which are ﬁtted by
mathematical functions based on the actual measured ionospheric delay of a certain
76
Chapter 5  Physical Inﬂuences of GPS Surveying

region over a period time, to better meet the positioning demand of the users in that
region (e.g., POLY model, TSF model, SH function model, GIM).
Klobuchar Model
The GPS broadcast ephemeris uses Klobuchar model (1987) to correct the
ionospheric delay of single frequency receivers (cf. Sect. 5.1.3). Klobuchar model
has advantages of simple structure and convenient calculation, which is suitable for
the ionospheric delay correction of real-time single-frequency receiver positioning.
Klobuchar model takes the amplitude and periodic changes of daily scale of the
ionosphere into account when setting the parameters, which can reﬂect the variation
characteristics of the ionosphere and ensure the reliability of ionospheric forecasts
from large scale. The downside is that it has a limited precision on the ionospheric
delay correction, which is only suitable for the mid-latitude area. Because of the
high-frequency activity of the ionosphere in high- and low-latitude regions, this
model cannot reﬂect the true state of the ionosphere. Experience shows that the
Klobuchar model can correct 50–60 % of the ionospheric delay generally.
Since July 2000, the Centre for Orbit Determination in Europe (CODE) began
providing post-processing Klobuchar coefﬁcients to make the eight broadcast
coefﬁcients consistent with the global ionosphere maps (GIM) products. Results
show that the consistency of the post-processing Klobuchar model is better than the
broadcast Klobuchar model. In the meanwhile, CODE also provides forecast
Klobuchar model coefﬁcients. Petrie et al. (2011) proved that the effect of the
forecast Klobuchar model is not as signiﬁcant as the post-processing model.
IRI Model
The International Reference Ionosphere (IRI) is the standard model for iono-
spheric densities and temperatures developed and updated by a joint working group
of the Committee on Space Research (COSPAR) and the International Union of
Radio Science (URSI) (Bilitza 2001). IRI is an empirical standard model of the
ionosphere based on all available data sources. Several steadily improved editions
of the model have been released. The latest version is IRI-2012 (Bilitza et al. 2014).
For a given location, time, and date, IRI describes monthly averages of electron
density, electron temperature, ion temperature, ion composition, and several addi-
tional parameters in the altitude range from 60 to 2000 km, and also the electron
content. The National Space Science Data Center (NSSDC) provides access to
on-line IRI computations through its World Wide Web (WWW) models interface
at http://nssdc.gsfc.nasa.gov/model/ionospheric/iri.html.
IRI
provides
monthly
averages in the non-auroral ionosphere for magnetically quiet conditions. For
high-precision observations, the instantaneous change in ionosphere should be
considered.
As an empirical model, IRI has the advantage that it does not depend on an
evolving theoretical understanding of the processes that shape the ionospheric
plasma. A disadvantage of the empirical model is the strong dependence on the
5.1  Ionospheric Effects
77

underlying database. Regions and time periods not well covered by the database
will result in diminished reliability of the model in these areas (Bilitza et al. 2014).
NeQuick Model
The NeQuick is an empirical model based on the model introduced by Di
Giovanni and Radicella in 1990. The NeQuick algorithm is used by the IRI model
as a default option for the upper ionosphere computation. The NeQuick is able to
calculate electron density at any given location in the ionosphere. Therefore, it can
provide TEC and electron density proﬁle between any two given points (Nava et al.
2008).
NTCM-GL Model
A new global
ionospheric model, the Global Neustrelitz
TEC Model
(NTCM-GL), was developed at the Institute of Communications and Navigation at
the German Aerospace Centre (DLR) in Neustrelitz, Germany. The model can
provide values of vertical TEC (VTEC) at any given time and location. The core of
the model consists of 12 coefﬁcients, which can be autonomously used for full solar
cycle. The model does not use any integration of electron density proﬁle; therefore,
it is very simple and fast (Jakowski et al. 2011). The model analytically describes
daily variation, seasonal variation, equatorial altitude anomaly, and solar ﬂux
dependency as harmonic functions. All the formulas of the model algorithm can be
found in Jakowski et al. (2011).
Polynomial (POLY) Model
The POLY model is based on the difference of sun angle and latitude difference
between the ionospheric pierce point (IPP) and the regional centre, which can be
expressed as (Komjathy 1997)
VTEC ¼
X
n
i¼0
X
m
k¼0
Eikðu  u0ÞiðS  S0Þk;
ð5:86Þ
where Eik are the unknown model coefﬁcients, φ and S are the geographic latitude
and sun angle at the IPP, respectively, and φ0 and S0 are the geographic latitude and
sun angle at the regional centre, respectively.
The POLY model has a simple structure and takes into account ionospheric
changes related to latitude and sun angle. This model is used widely in regional
ionospheric modelling analysis because it can obtain better results than other
models over a certain period and within a certain range.
Trigonometric Series Function (TSF) Model
Georgiadiou proposed using a trigonometric series model to build a regional
ionospheric model, which further improved the simulation capabilities of local daily
ionospheric variations. Based on a trigonometric series, a generalised trigonometric
78
Chapter 5  Physical Inﬂuences of GPS Surveying

series with variable parameters in geomagnetic coordinates can be formed as
(Mannucci et.al. 1998)
VTEC ¼ A1 þ
X
N2
i¼1
Ai þ 1ui
m


þ
X
N3
i¼1
Ai þ N2 þ 1hi

þ
X
NiNj
i¼1;j¼1
Ai þ N2 þ N3 þ 1ui
mh j

þ
X
N4
i¼1
A2 þ N2 þ N3 þ Ni1 cosðihÞ þ A2i þ N2 þ N3 þ Ni sinðihÞg
f
;
ð5:87Þ
the geomagnetic latitude at the IPP, and h represents variables relative to local time.
h = 2π(t −14)/T, T = 24 h, where t is the local time at IPP in units of hours.
φm = φ + 0.064cos(λ −1.617), where φ and λ are the geographical latitude and
longitude, respectively, in units of radians.
Spherical Harmonic (SH) Function Model
The spherical harmonic function has been widely used in global ionospheric
models. A global spherical harmonic model with 15 × 15 order coefﬁcients has
been released by CODE. In global modelling, the zero-order term is the global
ionosphere average TEC values. In regional modelling, although the spherical
harmonic coefﬁcients do not have orthogonality, a lower-order spherical harmonic
function model can still be used to study the ionospheric region. The function
model can be expressed as follows (Schaer 1999)
VTEC ¼
X
nmax
n¼0
X
n
m¼0
Pnmðsin bÞðAnm cosðmsÞ þ Bnm sinðmsÞÞ;
ð5:88Þ
where s is the longitudinal difference between the pierce point and sun direct spot,
Pnm(sinβ) is the Legendre function, and Anm and Bnm are unknown model
coefﬁcients.
Grid Ionospheric Model (GIM)
The grid ionospheric model is mainly applied in the Wide Area Augmentation
System (WAAS). This model is based on the approximation that the ionosphere is
considered to be a thin layer, an ionospheric spherical shell, to a height of 350 km
above the earth’s surface (Otsuka et al. 2002). The grid ionospheric model values
are the vertical ionospheric delays or vertical total electron content at the speciﬁc
ionospheric grid points (IGPs, the intersection points of the selected longitude and
latitude lines) covering the area. The electron content of the station is usually
interpolated according to the four grid points. Therefore, in order to obtain the
electron content with high accuracy, space and time interpolations are needed.
5.1  Ionospheric Effects
79

The effect of the empirical ionospheric model is generally not as good as the
mathematical model. This is because there are many factors that can affect the
ionosphere, and these factors may contain strong randomness. Moreover, the inter-
action of the various factors, the change law, and internal mechanism that cause the
anomalous variation of the ionospheric delay are not entirely clear, thus making it
more difﬁcult to infer only via empirical data. For the mathematical ﬁtting function
model, it can be established without the demand of deep understanding of the internal
mechanism of the ionosphere. A number of small-scale changes over time are already
reﬂected in the model. Furthermore, with the increased number of global navigation
system (GNSS) satellites and their dense and uniform distribution, the regional
ionospheric model can be well ﬁtted and established within 2 to 4 h. Therefore, more
desirable results can be achieved through the mathematical function model.
5.2
Tropospheric Effects
The troposphere is the lower part of the atmosphere over the earth’ssurface. Unlike the
ionosphere, the troposphere is a non-dispersive medium at GPS carrier frequencies.
That is, the tropospheric effects on the GPS signal transmission are independent of the
working frequency. The electromagnetic signals are affected by the neutral atoms and
molecules in the troposphere. These effects are called tropospheric delay, or tropo-
spheric refraction. Indeed, the word “tropospheric” is not used here in the exact sense;
historically, tropospheric effects are simply considered to be the effects of the atmo-
sphere below the ionosphere. The amount of tropospheric delay in the zenith direction
is about 2 m, and it increases with the increase in the zenith angle of the sight line to the
satellite. In the case of a lower satellite elevation by a few degrees, the tropospheric
delay of the GPS signal can be a few metres or more. Therefore, the tropospheric effect
is an important error source in precise GPS applications.
Generally speaking, the tropospheric delay depends on temperature, pressure,
and humidity, as well as the location of the GPS antenna. Similar to the ionospheric
path delay, the tropospheric path delay can be written as
d ¼
Z
ðn  1Þds;
ð5:89Þ
where n is the refractive index of the troposphere, the integration is taken along the
signal transmitting path, which could be simpliﬁed as the geometric path. Scaling of
the refractive index anomaly (n −1) is usually made by
N ¼ 106ðn  1Þ;
ð5:90Þ
where N is called tropospheric refractivity. N can be separated into wet (about
10 %) and dry (about 90 %) parts:
80
Chapter 5  Physical Inﬂuences of GPS Surveying

N ¼ Nw þ Nd;
ð5:91Þ
where indices w and d denote the wet and dry. They are caused by water vapour and
dry atmosphere, respectively. Therefore Eq. 5.89 becomes
d ¼ dw þ dd ¼ 106
Z
Nds;
ð5:92Þ
where
dw ¼ 106
Z
Nwds
and
ð5:93Þ
dd ¼ 106
Z
Ndds:
ð5:94Þ
If the integrations are made along the zenith direction, then the related mapping
functions should be deﬁned by
dw ¼ dwzFw;
ð5:95Þ
dd ¼ ddzFd
and
ð5:96Þ
d ¼ dzF;
ð5:97Þ
where index z denotes the tropospheric delays in the zenith direction, and Fw and Fd
are mapping functions related to the wet and dry components. Analogous to the
discussions made in Sect. 5.1.4, mapping functions are needed to determine the
related delay models in the zenith direction. All empirical tropospheric path delay
models have their own mapping functions.
5.2.1
Tropospheric Models
Modiﬁed Saastamoinen Model
The modiﬁed Saastamoinen tropospheric model (Saastamoinen 1972, 1973) for
calculating the tropospheric path delay can be outlined as
d ¼ 0:002277
cos z
P þ
1255
T
þ 0:05


e  B tan2 z


þ dR;
ð5:98Þ
where z is the zenith angle of the satellite, T is the temperature at the station (in units
of Kelvin [K]), P is the atmospheric pressure (in units of millibars [mb]), e is the
partial pressure of water vapour (in mb). B and δR are the corrections terms that
5.2  Tropospheric Effects
81

depend on H and z, respectively. H is the height of the station. δ is the tropospheric
path delay (in metres), and cf., e.g., Wang et al. (1988)
e ¼ Rh expð37:2465 þ 0:213166T  0:000256908T2Þ;
ð5:99Þ
where Rh is the relative humidity (in %) and exp() is the exponential function. B and
δR can be interpolated from Tables 5.1 and 5.2, respectively.
To transform the unit of the temperature T from K (Kelvin) to °C (Celsius), one
may use
TðKÞ ¼ TðCelsiusÞ þ 273:15:
ð5:100Þ
In the model, either measured values of pressure, temperature, and humidity or
the values derived from a standard atmospheric model may be used. The
height-dependent values of pressure, temperature, and humidity may be obtained by
the equations
P ¼ P0½1  0:0000266ðH  H0Þ5:225;
ð5:101Þ
T ¼ T0  0:0065ðH  H0Þ;
and
ð5:102Þ
Rh ¼ Rh0 exp½0:0006396ðH  H0Þ;
ð5:103Þ
where P0, T0, and Rh0 are called standard pressure, temperature, and humidity at the
reference height H0. It is clear that the values are dependent on the geographic
position of the station and time as well as the weather. Without the values of P0, T0,
and Rh0, a direct correction using the model is not possible. In such a case, the
tropospheric effects are usually estimated through the factor parameters of the
mapping function, which will be discussed later. Additionally, the following values
will be used as standard input:
H0 ¼ 0 m;
ð5:104Þ
P0 ¼ 1013:25 mbar;
ð5:105Þ
T0 ¼ 18 C;
and
ð5:106Þ
Rh0 ¼ 50 %:
ð5:107Þ
The original Saastamoinen tropospheric model has a constant value of B and
δR = 0 in the modiﬁed model of Eq. 5.98. Three types of mapping functions are
Table 5.1 Function of B(H)
Height (km)
0.0
0.5
1.0
1.5
2.0
2.5
3.0
4.0
5.0
B (mbar)
1.156
1.079
1.006
0.938
0.874
0.813
0.757
0.654
0.563
82
Chapter 5  Physical Inﬂuences of GPS Surveying

used in the modiﬁed model. The ﬁrst is obviously 1/cosz; this is the mapping
function of the ﬂat earth model or single layer model. The second one is
tan2z/cosz (cf. Eq. 5.98). The third one is implicit, represented by the numerical
Table 5.2.
Modiﬁed Hopﬁeld Model
The modiﬁed Hopﬁeld model (Hopﬁeld 1969, 1970, 1972) for calculating the
tropospheric path delay can be summarised as
d ¼ dd þ dw
and
ð5:108Þ
di ¼ 106Ni
X
9
k¼1
fk;i
k rk
i ;
i ¼ d; w:
ð5:109Þ
Subscript i is used to identify the dry and wet components of the tropospheric delay,
and
ri ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðRE þ hiÞ2  R2
E sin2 z
q
 RE cos z;
f1;i ¼ 1;
f2;i ¼ 4ai;
f3;i ¼ 6a2
i þ 4bi;
f4;i ¼ 4aiða2
i þ 3biÞ;
f5;i ¼ a4
i þ 12a2
i bi þ 6b2
i ;
f6;i ¼ 4aibiða2
i þ 3biÞ;
f7;i ¼ b2
i ð6a2
i þ 4biÞ;
f8;i ¼ 4aib3
i ;
f9;i ¼ b4
i ;
ð5:110Þ
Table 5.2 Function of δR(H, z)
z(degrees)
\Height(km)
0.0
0.5
1.0
1.5
2.0
3.0
4.0
5.0
60.00
0.003
0.003
0.002
0.002
0.002
0.002
0.001
0.001
66.00
0.006
0.006
0.005
0.005
0.004
0.003
0.003
0.002
70.00
0.012
0.011
0.010
0.009
0.008
0.006
0.005
0.004
73.00
0.020
0.018
0.017
0.015
0.013
0.011
0.009
0.007
75.00
0.031
0.028
0.025
0.023
0.021
0.017
0.014
0.011
76.00
0.039
0.035
0.032
0.029
0.026
0.021
0.017
0.014
77.00
0.050
0.045
0.041
0.037
0.033
0.027
0.022
0.018
78.00
0.065
0.059
0.054
0.049
0.044
0.036
0.030
0.024
78.50
0.075
0.068
0.062
0.056
0.051
0.042
0.034
0.028
79.00
0.087
0.079
0.072
0.065
0.059
0.049
0.040
0.033
79.50
0.102
0.093
0.085
0.077
0.070
0.058
0.047
0.039
79.75
0.111
0.101
0.092
0.083
0.076
0.063
0.052
0.043
80.00
0.121
0.110
0.100
0.091
0.083
0.068
0.056
0.047
5.2  Tropospheric Effects
83

ai ¼  cos z
hi
;
bi ¼  sin2 z
2hiRE
;
hd ¼ 40;136 þ 148:72ðT  273:15Þ ðmÞ;
hw ¼ 11;000 ðmÞ;
Nd ¼ 77:64P
T
ðK mb1Þ;
Nw ¼  12:96e
T
þ 371800e
T2
;
and
RE ¼ 6378137 m;
ð5:111Þ
where z is the zenith angle of the satellite, T is the temperature at the station (in units
of Kelvin [K]), P is the atmospheric pressure (in units of millibars [mb]), and e is
the partial pressure of water vapour (in mb, cf. Eq. 5.99). RE is the earth’s radius. δ
is the tropospheric path delay (in metres).
In the model, either measured values of pressure, temperature, and humidity or
the values derived from a standard atmospheric model may be used. The
height-dependent values of pressure, temperature, and humidity may be obtained
using Eqs. 5.101–5.107. As mentioned before, the tropospheric effects are usually
estimated through suitable parameterisation, which will be discussed in the next
section.
A graph of the modiﬁed Hopﬁeld model with standard input parameters is given
in Fig. 5.4.
There are still many other models for computing the tropospheric delay, such as
the Davis model (Davis and Herring 1984), original Hopﬁeld and Saastamoinen
models (cf., e.g., Hofmann-Wellenhof et al. 1997), Niellis model, and Yionoulis
Fig. 5.4 Modiﬁed hopﬁeld
tropospheric model
(troposphere delay of GPS
signal)
84
Chapter 5  Physical Inﬂuences of GPS Surveying

model (Zhu 2001). The differences between these models are generally very small
for a zenith distance less than 75°.
5.2.2
Mapping Functions and Parameterisation
In Sect. 5.1.4, the ionospheric mapping functions are discussed under the assump-
tions of symmetry of the sphere and rotating ellipsoid shapes of the ionosphere. For
similar assumptions of the troposphere shapes, all mapping functions discussed in
Sect. 5.1.4 can be directly used here for troposphere by changing the related values.
Projection Mapping Function
Because the troposphere has a maximum height of 50 km, the zenith angle of the
satellite at the observation point may simply be used in the single layer mapping
function:
F ¼
1
cos z :
ð5:112Þ
Geometric Mapping Function
It can be similarly derived as in Sect. 5.1.4 by
F ¼  r
H cos z þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ HÞ2  r2 sin2 z
q
H
;
ð5:113Þ
where r = 6378 km, H = 50 km, and z is the spherical zenith distance of the
satellite viewed from the station. This mapping function can be called Xu’s geo-
metric mapping function (Xu 2003).
Because of the complexity of the troposphere, the so-called co-mapping function
is needed. If a height-dependent homogeneous distribution of the troposphere is
assumed, then the co-mapping function is a geometric one and is deﬁned as
dq ¼ dSFc;
ð5:114Þ
where dρ and dS are the tropospheric path delay and the delay mapped to the line
from station to the sub-tropospheric point. In the case of zenith angle z equals zero,
the dS is zero and co-mapping function is undeﬁned. Index c in Fc is used to denote
the co-mapping function. It is clear that the projection co-mapping function is
Fc ¼
1
sin z :
ð5:115Þ
5.2  Tropospheric Effects
85

Geometric Co-mapping Function
The zenith angle of the satellite at the sup-tropospheric point is denoted by zst
(Fig. 5.5). It can be computed by using the sinus theorem
sin z ¼
r
r þ 50 sin zst;
ð5:116Þ
where z is the zenith angle of the satellite viewed from the receiver and r is the
mean radius of the earth in km. Using the cosines theorem, one has
S2 ¼ H2 þ q2  2Hq cos zst
ð5:117Þ
or
S ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
H2 þ q2  2Hq cos zst
p
;
ð5:118Þ
where ρ and S are the lengths of lines from the station to the sup-tropospheric point
and sub-tropospheric point, respectively. Then the geometric co-mapping function
is
Fc ¼
q
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
H2 þ q2  2Hq cos zst
p
;
ð5:119Þ
where
q ¼ r cos z þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðr þ HÞ2  r2 sin2 z
q
;
ð5:120Þ
where r = 6378 km, H = 50 km. Above, the derived geometric co-mapping func-
tion of Eq. 5.119 is a spherical approximation if r is considered a constant and can
be called Xu’s geometric co-mapping function (Xu 2003).
Fig. 5.5 Spherical
troposphere model
86
Chapter 5  Physical Inﬂuences of GPS Surveying

The mapping and co-mapping functions are necessary for two purposes: one for
the determination of a related tropospheric model, and the other for the determi-
nation of the tropospheric path delay effects on the GPS observations. Recall the
deﬁnitions of dρ = dH  F (cf. Eq. 5.72). Here, dH may be considered a tropo-
spheric model that is independent of the zenith distance of the signal transmitting
path, whereas dρ represents observed tropospheric delays of path direction. With
the observed dρ and known mapping function F, the parameters of the model
dH can be determined. The model dH is generally a function of temperature,
pressure, and humidity as seen in the models discussed in Sect. 5.2.1. To correct for
the tropospheric effects on GPS observations, one needs tropospheric models.
However, the input parameters of the models are usually not measured together
with the GPS measurements. The standard method of dealing with such a problem
includes two steps. First, the standard temperature, pressure, and humidity values
for everywhere and any time will be used as the input of the tropospheric model to
compute the path delay dρ. Then, the computed dρ should be ampliﬁed with a
functional factor g, and the g must be determined by GPS data processing. The
formulation of g is called parameterisation of the tropospheric path delay effects.
Two factorisation methods are given here:
gqdq;
gz
dq
F þ ga
dq
Fc
ð5:121Þ
Physically, gρ, gz, and ga are factors in the path direction and zenith direction, and in
the azimuth component, respectively. Mapping function F and co-mapping function
Fc are used to map the computed dρ to the desired directions.
A step function or a ﬁrst-order polynomial function
g ¼ gðtÞ ¼ gi;
if
ti1 	 t\ti;
i ¼ 1; . . .; n
ð5:122Þ
or
g ¼ gðtÞ ¼ gi1 þ ðgi  gi1Þ ðt  ti1Þ
Dt
;
if
ti1 	 t\ti;
i ¼ 1; . . .; n
ð5:123Þ
may be used as path factor gρ. Where in Eqs. 5.122 and 5.123 Δt = (te −t0)/n, t0
and te are the beginning time and ending time of the GPS surveying, n is an integer
that may be selected with a reasonable value, ti = t0 + (i −1)Δt, gi are constant
unknowns which shall be determined.
The azimuth dependency may be assumed as
ga ¼ g1 cos a þ g2 sin a;
ð5:124Þ
5.2  Tropospheric Effects
87

where a is the azimuth of the satellite at the station, and g1 and g2 in turn may be a
step function or a ﬁrst-order polynomial function given in Eqs. 5.122 and 5.123.
5.2.3
Introduction of Commonly Used Tropospheric Models
The tropospheric delay can be represented as the product of the tropospheric re-
fraction in zenith direction and a mapping function related to the elevation angle (cf.
Eqs. 5.95 and 5.96). With the approximate position and the meteorological data, the
zenith delay can be easily computed by the Saastamoinen model (cf. Sect. 5.2.1).
Generally, the meteorological data can be obtained from actual observations or
derived using a standard atmospheric value at sea level and the height of the station
(Berg 1948). Meteorological data can also be determined by empirical models
called GPT (Global Pressure and Temperature model, Boehm et al. 2007) or the
later GPT2 model (Lagler et al. 2013). According to the computation formula of the
Saastamoinen model, 1 mbar pressure change at sea level can cause a change of
about 2.3 mm in a priori zenith hydrostatic delay, thus it is essential to use as
accurate meteorological data as possible (Tregoning and Herring 2006). The
commonly used Saastamoinen model and Hopﬁeld model have been introduced and
analysed in the Sect. 5.2.1. Therefore, the recently developed meteorological
models and mapping functions are focused on in this section.
Many mapping functions were proposed in the past, such as NMF (Niell
Mapping Function, Niell 1996), VMF1 (Vienna Mapping Function 1, Boehm et al.
2006b), GMF (Global Mapping Function, Boehm et al. 2006a), which were com-
monly researched in the recent years. By comparison, a general form of the map-
ping functions can be outlined as (Herring 1992; Kouba 2009)
MF ¼
1 þ
a
1 þ
b
1 þ c
sin e þ
a
sin e þ
b
sin e þ c
;
ð5:125Þ
where MF is the mapping function, e is the elevation angle, a, b, and c are empirical
coefﬁcients with different values in various mapping functions. ðah; bh; chÞ and
ðaw; bw; cwÞ are used for the hydrostatic and wet components, respectively.
The accuracy of the mapping function would deﬁnitely affect the precision of the
slant delay, thus affecting the positioning precision. And when the elevation cut-off
angle is lower, the impact is more signiﬁcant. Applying a rule of thumb (MacMillan
and Ma 1994; Boehm et al. 2006b), an error in the wet mapping function of 0.01 or
in the hydrostatic mapping function of 0.001 would cause an error of 4 mm in the
station height under a 5° elevation cut-off angle.
NMF Model
The NMF model was derived by Niell (1996) based on data from 26 globally
distributed balloons stations. It is widely used because of its global validity and its
88
Chapter 5  Physical Inﬂuences of GPS Surveying

independence from surface meteorological observations. NMF uses 15° latitude
grid tables and models the seasonal amplitudes for each of the three coefﬁcients of
Eq. (5.125). The parameter a can be given as
aðu; tÞ ¼ aavgðuÞ þ aampðuÞcosð2pðt  28Þ=365:25Þ;
ð5:126Þ
where u is the latitude of the station, t is the day of year, parameters aavg and aamp
can be obtained by the linear interpolation between the nearest latitudes. For
parameters b and c, the same procedure can be applied.
The parametrisation of NMF is based on ray traces of radiosonde proﬁles
spanning the latitudes 43°S to 75°N. It was extended globally by assuming lon-
gitudinal homogeneity and symmetry between the southern and the northern
hemisphere. The polar regions with latitudes higher than 75° on the northern and
southern hemisphere are both approximated by the 75°N latitude values, thus the
precision of NMF in polar regions is poor.
VMF1 Model
VMF1 model was derived by Boehm et al. (2006b). The coefﬁcients ah and aw
were derived from a rigorous ray tracing through pressure levels of the European
Centre for Medium-Range Weather Forecasts (ECMWF) operational analysis data.
These coefﬁcients are provided by TU Vienna as site-speciﬁc or global grid
(2° × 2.5°) time series with 6-hourly temporal spacing. The coefﬁcients bh and bw
were derived from 1 year of ECMWF data in a least squares ﬁt. Whereas bh is
constant, ch depends on the day of year and the latitude. bw and cw were taken from
the Niell mapping function at 45° latitude, since the coefﬁcient aw is sufﬁcient to
model the dependence of the wet mapping function on latitude. VMF1 is currently
the mapping function providing globally the most accurate and reliable geodetic
results. The related program is available at the ofﬁcial website of TU Vienna http://
ggosatm.hg.tuwien.ac.at/DELAY/SOURCE.
GMF/GPT Model
The GMF is an empirical mapping function (input arguments are only the day of
year and the site location) that is consistent with VMF1 (Boehm et al. 2006a).
Expressions for the coefﬁcients ah and aw (mean values and annual signal) were
derived from 3 years of ECMWF data and are provided as a spherical harmonic
expansion of degree and order 9. The coefﬁcients b and c are taken from the VMF1.
The GPT is an empirical model proposed by Boehm et al. (2007), which can be
downloaded from http://www.hg.tuwien.ac.at/*ecmwf1. It is based on spherical
harmonics up to degree and order 9 and provides pressure and temperature at any
site in the vicinity of the earth’s surface. The GPT model can be used for geodetic
applications such as the determination of a priori hydrostatic zenith delays, refer-
ence pressure values for atmospheric loading, or thermal deformation of
very-long-baseline interferometry (VLBI) radio telescopes. Input parameters of
GPT are the station coordinates and the day of the year, thus also allowing one to
model the annual variations of the parameters. As an improvement compared to
5.2  Tropospheric Effects
89

previous models, it reproduces the large pressure anomaly over Antarctica, which
can cause station height errors in the analysis of space-geodetic data of up to 1 cm if
not considered properly in troposphere modelling. The pressure biases can be
reduced substantially using GPT instead of the very simple approaches applied to
various global navigation satellite system (GNSS) software packages. GPT also
provides an appropriate model for the annual variability of global temperature.
Compared to VMF1, GMF/GPT greatly simpliﬁes the estimation process, since
no external data are required. It provides consistency with VMF1 with only a slight
degradation in precision.
GPT2 Model
The GPT2 model was proposed by TU Vienna at the end of 2012 (Lagler et al.
2013). Monthly mean proﬁles provided by ECMWF from 2001 to 2010 were
analysed. After the calculation of mean, annual, and semi-annual terms of meteo-
rological data based on global grid points, the results were expressed globally in the
form of a 5° grid at mean earth surface heights. In addition, hydrostatic and wet
mapping function coefﬁcients were also able to be obtained. GPT2 largely eradi-
cates the weakness in GMF/GPT, speciﬁcally their limited spatial and temporal
variability. A comprehensive overview of the improvements of GPT2 in relation to
GMF/GPT is given in Table 5.3.
The beneﬁts and the improved performance of GPT2 with respect to the previous
models GPT/GMF have been validated by Lagler et al. (2013). GPT2 yields a 40 %
reduction in annual and semi-annual amplitude differences in station heights with
Table 5.3 Improvements of GPT2 with respect to GMF/GPT
GMF/GPT
GPT2
NWM data
Monthly mean proﬁles from
ERA-40 (23 pressure levels):
1999–2002
Monthly mean proﬁles from
ERA-Interim (37 levels): 2001–2010
Representation
Spherical harmonics up to
degree and order 9 at mean sea
level
5° grid at mean ETOPO5-based heights
Temporal
variability
Mean and annual terms
Mean, annual, and semi-annual terms
Phase
Fixed to January 28
Estimated
Temperature
reduction
Constant lapse rate: 6.5 °C/km
assumed
Mean, annual, and semi-annual terms of
temperature lapse rate estimated at every
grid point
Pressure
reduction
Exponential based on standard
atmosphere
Exponential based on virtual temperature
at each point
Output
parameters
Pressure (p), temperature (T),
mapping function coefﬁcients
ðah; awÞ
p, T, lapse rate (dT), water vapour
pressure (e), ah, aw
90
Chapter 5  Physical Inﬂuences of GPS Surveying

respect to a solution based on instantaneous local pressure values and VMF1, as
shown with a series of global VLBI solutions. Thus, it is recommended the
replacement of the old GMF/GPT with GPT2 as empirical model in the analysis of
radio space geodetic observations.
5.2.4
Tropospheric Model for Airborne Kinematic Positioning
Despite the commonly used global tropospheric delay models, data from GPS
ground networks have been widely used to construct precise regional tropospheric
models. Thus, the tropospheric delay of a kinematic station within the region can be
obtained through interpolation of the regional tropospheric model. Commonly used
interpolation methods include the direct interpolation method (DIM) (Wanninger
1997) and the remove–restore method (RRM) (Zhang and Lachapelle 2001).
In DIM, the tropospheric delays at a kinematic station are directly interpolated from
those at reference stations. In RRM, ﬁrstly, the delays from the standard tropo-
spheric model are removed, then the remaining values are used for interpolation.
Finally, the delays from standard tropospheric model are restored. DIM is simple
and applied for the ﬂat areas while the property of RRM is suitable for the undu-
lating areas. However, both methods are only appropriate for a kinematic station on
the ground (Xu 2000). If the kinematic station is several kilometres higher than the
ground reference stations, the precision of tropospheric delay will decrease rapidly
(Collins and Langley 1997; Mendes and Langley 1998). Therefore, the projection
extension method (PEM), proposed by Wang et al. (2010, 2011) to establish an
airborne tropospheric model for high-altitude kinematic stations, is introduced in
this section.
The basic concept of PEM is that the kinematic station in the air is ﬁrst projected
onto the average elevation of the surveyed area; the tropospheric delays at projected
points are then interpolated from those of reference stations; and ﬁnally, the delays
at projected points are extended upward to the airborne platform.
Suppose that the tropospheric delays dtropði; tÞ at an arbitrary reference station
can be expressed as
dtropði; tÞ ¼ aði; tÞ  saas dtropðiÞ;
ð5:127Þ
where saas dtropðiÞ are the tropospheric delays from a standard tropospheric model
such as the Saastamoinen model, aði; tÞ is the unknown factor, i is the reference
station ID, and t is the time. The unknown factor aði; tÞ can be expressed as
aði; tÞ ¼ a1 þ a2  t þ    þ ak  tk1 þ    þ an  tn1;
ð5:128Þ
5.2  Tropospheric Effects
91

where akðk ¼ 1; 2; . . .; nÞ are the polynomial coefﬁcients, which can be determined
by a least squares ﬁtting. The order of the polynomial can be determined based on
the statistical signiﬁcance (Xu and Yang 2001).
The geodetic coordinates of reference stations B(i), L(i), H(i), and kinematic
station BðtÞ, LðtÞ, HðtÞ are converted into the Gauss-Kruger coordinates x(i), y(i),
h(i), and xðtÞ, yðtÞ, hðtÞ, respectively. In the projection conversion, the central
meridian is the mean longitude of the reference network. The projection plane is the
average height of all reference stations.
The unknown factor aðtÞ of the projected points is obtained by interpolating the
aði; tÞ of reference stations based on the inverse distance weighted method as
follows:
aðtÞ ¼
X
n
i¼1
aði; tÞ  Pði; tÞ;
ð5:129Þ
Pði; tÞ ¼
rði; tÞ2
P
n
i¼1
rði; tÞ2 ;
ð5:130Þ
rði; tÞ2 ¼ xðiÞ  xðtÞ
ð
Þ2 þ yðiÞ  yðtÞ
ð
Þ2 þ hðiÞ  hðtÞ
ð
Þ
2;
ð5:131Þ
where Pði; tÞ can be considered a kind of weight of aði; tÞ; rði; tÞ is the distance
between the reference stations and projected points.
The standard model tropospheric delays at projected points are extended upward
to the kinematic station in the air based on the following formula (Syndergaard
1999):
Dh ¼ rover hðtÞ  hðtÞ;
ð5:132Þ
pressðtÞ ¼ press  1  0:0000226  Dh
ð
Þ5:225;
ð5:133Þ
tempðtÞ ¼ temp  0:0065  Dh;
ð5:134Þ
rhðtÞ ¼ rh  eð0:0006396DhÞ;
ð5:135Þ
rover saasðtÞ ¼ SAAS pressðtÞ; tempðtÞ; rhðtÞ
ð
Þ;
ð5:136Þ
where Dh is the elevation difference between kinematic station in the air and
projected point. rover hðtÞ is the elevation of the kinematic station; press, temp, rh
are the pressure, temperature, and relative humidity of the projected point; pressðtÞ,
tempðtÞ, rhðtÞ are the pressure, temperature, and relative humidity of the kinematic
station; SAAS pressðtÞ; tempðtÞ; rhðtÞ
ð
Þ is the standard model tropospheric delay
when given pressure and temperature and humidity. The units of height, pressure,
and temperature are metres, millibars, and Kelvin, respectively.
92
Chapter 5  Physical Inﬂuences of GPS Surveying

Therefore, the tropospheric delays of the kinematic station rover dropðtÞ can be
obtained by
rover dropðtÞ ¼ aðtÞ  rover saasðtÞ;
ð5:137Þ
The numerical example for validation of this method can be referred to Wang
et al. (2011).
5.2.5
Water Vapour Research with Ground-Based GPS
Measurement
Water vapour is mainly distributed at the bottom of the troposphere, constituting
approximately 99 % of total atmospheric water vapour. It is one of the most active
and variable parts of the atmospheric components and one of the most difﬁcult
meteorological parameters to characterise (Rocken et al. 1993). Water vapour plays
a key role in a range of spatial and temporal scales of atmospheric processes, and its
distribution is directly related to the distribution of clouds and precipitation.
Research on the distribution of water vapour in the atmosphere will be of great
assistance in weather forecasting and climate prediction.
Traditional water vapour measurement methods include radiosonde, water
vapour radiometer, and satellite remote sensing, which may have disadvantages of
heavy workload, high equipment costs, or low spatial and temporal resolution.
Therefore, using GPS to detect water vapour has become an interesting area of
research to meet the increasing demands of meteorological development.
Precipitable water vapour (PWV) has been highlighted in GPS meteorological
calculation. By means of speciﬁc methods we can estimate zenith wet delays
(ZWD) based on GPS observation data, and the relationship between ZWD and
PWV can be expressed as (Bevis et al. 1992):
PWV ¼
Y
 ZWD;
ð5:138Þ
where Q is a water vapour conversion factor. It can be expressed as
Y
¼
106
qWRV ðk3=TmÞ þ k0
2
	

 ;
ð5:139Þ
where qW is the density of water, RV is the speciﬁc gas constant for water vapour, k2
′
and k3 are the atmospheric refractivity constants (Davis et al. 1985; Bevis et al.
1994), Tm is the key variable to calculate the conversion factor Q.
Tm is an important parameter in ground-based GPS meteorology, and is usually
expressed asa linear functionof surface temperature Ts. Thelinearrelationship between
Tm and Ts has been explored by many scientists. Bevis et al. (1992) came up with the
5.2  Tropospheric Effects
93

equation Tm = 70.2 + 0.72Ts based on analysis of 8718 radiosonde proﬁles, which is
suitablefor mid-latituderegion. However,the formula hasa limited application because
of the lack of surface temperature measurement at some GPS stations. Based on the
analysis of 23 years of radiosonde data from 53 stations, Ross and Rosenfeld (1997)
noted that the correlation between Tm and Ts generally weakens in the equatorial region
and becomes weaker in summer than in winter. Gu et al. (2005) researched the varia-
tions of Tm and computed a regional Tm. Li et al. (2006) veriﬁed the applicability of
Bevis Tm −Ts relationship in speciﬁc areas. Mao (2006) systematically studied the
method of using GPS to detect water vapour. Wang et al. (2007a) derived precipitable
water (PW) using the zenith path delay (ZPD) obtained from the existing ground-based
GPS measurementsona globalscale,and applied thattoproduce a near-global 2-hourly
PW data set. Ding (2009) introduced the fundamental of the GPS meteorology and
related calculation methods in detail. Several regionally applicable linear models were
established by scientists, such as Li et al. (1999), Liu et al. (2000), Gu (2004), Wang
et al. (2007b), and Lv et al. (2008). Considering seasonal variations, Yao et al. (2012)
established the globally applicable GTm-I model independent of surface temperature,
using radiosondedata of 135 stations in 2005–2009. To address the abnormalities of the
model in some areas because of the lack of radiosonde data at sea, Yao et al. (2013)
employedthe GPT model and the Bevis Tm −Ts relationshiptoprovide simulated Tm at
sea and recomputed GTm model coefﬁcients to improve the model’s accuracy. Yeh
et al. (2014) used a water vapour radiometer (WVR) to verify the PWV measured by
GPS. Choy et al. (2015) compared the PWV derived from GPS with traditional
radiosondemeasurementandVLBItechniques,whichshowedgoodagreement.Details
can be found in the respective references.
5.3
Relativistic Effects
5.3.1
Special Relativity and General Relativity
Einstein’s special relativity is based on two postulates. The ﬁrst is called the
principle of relativity: “No inertial system is preferred. The equations expressing the
laws of physics have the same form in all inertial systems.” The second is called the
principle of the constancy of the speed of light: “The speed of light is a universal
constant independent of the state of motion of the source. Any light ray moves in
the inertial system of coordinates with constant velocity c, whether the ray is
emitted by a stationary or by a moving source.” Of course, the speed of light refers
to velocity in a vacuum (Ashby and Spilker 1996).
Consider two inertial coordinate systems S′ and S in Fig. 5.6, where the x′-axis
and x-axis coincide. Two origins are placed at points A and B, respectively.
Origin A of system S′ moves with a constant velocity v along the x-axis toward B.
The distance between A and B viewed in system S is Δx. The mirror surface is
94
Chapter 5  Physical Inﬂuences of GPS Surveying

parallel to the x-axis and is faced to the x-axis. The perpendicular distance of the
mirror to the x-axis is ΔL. Suppose a light ﬂash is emitted from A and the reﬂected
light is received at B by the moving system S′. Then the transmitting time of the
light measured in system S is
Dt ¼
2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðDLÞ2 þ ðDx=2Þ2
q
c
:
ð5:140Þ
According to our assumption, one gets Δx = vΔt. Substituting this into
Eq. 5.140, Δt can be obtained by
Dt ¼
2DL=c
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
:
ð5:141Þ
Because of Einstein’s postulates, the speed of light, c, is the same in two systems.
Therefore, 2ΔL/c is the light ﬂash transmitting time viewed in the moving system
S′, i.e. Δt′ = 2ΔL/c, and
Dt ¼
Dt0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
:
ð5:142Þ
This indicates that the time interval viewed in the system at rest is shorter than the
time interval viewed in the system, which is moving with velocity v.
Again, because of the constant c in the two systems, one may denote
Δs = cΔt and Δs′ = cΔt′, where Δs and Δs′ are the lengths of the light transmitting
paths viewed in the two systems. Multiplying c by Eq. 5.142 gets
Ds ¼
Ds0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
:
ð5:143Þ
This indicates that the length viewed in the moving system is lengthened.
Fig. 5.6 Light transmission
viewed in two inertial frames
5.3  Relativistic Effects
95

Consider the relation c = fλ, where c is constant in both systems, λ is wave-
length, and f is the related frequency. Because the wavelength λ viewed in two
systems is different, denoted by λ = Δs and λ′ = Δs′, the relationship of the fre-
quencies f and f′, which are viewed in two systems, can be obtained by dividing
c into Eq. 5.143:
f ¼ f 0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
:
ð5:144Þ
This indicates that the frequency f′ viewed in the moving system is reduced to
f when it is viewed by a resting system.
Using mathematical expansions
1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
¼ 1 þ 1
2
v
c
 2
. . .;
ð5:145Þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  ðv=cÞ2
q
¼ 1  1
2
v
c
 2
. . .;
ð5:146Þ
for Eqs. 5.142, 5.143 and 5.144, we have
Dt  Dt0
Dt0
¼ Ds  Ds0
Ds0
¼  f  f 0
f 0
¼ 1
2
v
c
 2
:
ð5:147Þ
This is the formula of the special relativity effects caused by a constant motion of a
moving inertial coordinate system viewed from a resting inertial coordinate system.
Einstein’s general relativity incorporates gravitation by virtue of the principle of
equivalence. The mathematics of general relativity is extremely complex. However,
for treatment of the relativistic effects on GPS, only a simpliﬁed and small fraction
of the theory is required. Note that the right-hand side of Eq. 5.147 is indeed the
point-mass (or unit mass) kinetic energy (v2/2) scaled by the speed of light c (ex-
actly 1/c2). That is, the special relativity effects may be interpreted as the effects
caused by kinetic energy due to motion. The analogous effects may also be caused
by potential energy ΔU due to the presence of the gravitation ﬁeld U. Then
Dt  Dt0
Dt0
¼ Ds  Ds0
Ds0
¼  f  f 0
f 0
¼ DU
c2
ð5:148Þ
represents the relativistic relations in the case of the presence of a gravitational ﬁeld
U. Thus, the total relativistic effects may be formulated as
Dt  Dt0
Dt0
¼ Ds  Ds0
Ds0
¼  f  f 0
f 0
¼ 1
2
v
c
 2
þ DU
c2 :
ð5:149Þ
96
Chapter 5  Physical Inﬂuences of GPS Surveying

The presence of a gravitational ﬁeld indicates an acceleration of the frame S′ with
respect to the system S at rest.
The special relativity effects of rotation may be similarly discussed. Details can
be found, for example, in Ashby and Spilker (1996).
5.3.2
Relativistic Effects on GPS
The inertial coordinate system at rest, its origin located at the centre of the earth, is
taken as reference to view all GPS related activities. Because of the large motion
velocities and near circular orbits of the GPS satellite, the non-negligible gravita-
tional potential difference between the satellite and the users, as well as the rotation
of the earth, the relativistic effects have to be taken into account. For convenience,
we may imagine that the whole GPS process is viewed in an inertial reference at a
point where the gravitational potential is the same as that of the geoid of the earth.
Taking the earth’s rotational effects into account, the view point is equivalent to the
point of the GPS user on the geoid of the rotating earth.
Frequency Effects
The fundamental frequency f0 of the GPS system is selected as 10.23 MHz. All
clocks on the GPS satellites and GPS receivers operate based on this frequency. If
all the GPS satellites are working simply on the frequency f′ = f0, then we will view
a frequency f at our reference point, and f is not the same as f0 due to relativistic
effects. In order to view the fundamental frequency f = f0, the desired working
frequency f′ of the GPS satellites can be computed using Eq. 5.149 by
 f0  f 0
f 0
¼ 1
2
v
c
 2
þ DU
c2 ;
ð5:150Þ
where v is the velocity of the satellite and ΔU is the difference of the earth’s
gravitational potential between the satellite and the geoid. The difference between
the setting frequency f′ of the satellite clock and the fundamental frequency f0 is
referred to as the offset in the satellite clock frequency. Such an offset of relativistic
effects has been implemented in the satellite clock settings, and therefore, users do
not need to consider this effect. The offset can be computed by using the mean
velocity of the satellite and ΔU = µ/(RE + H)–µ/RE, where µ is the gravitational
constant of the earth, RE is the earth’s radius (ca. 6370 km), and H is the height of the
satellite above the earth (ca. 20,200 km). The offset is approximately 0.00457 Hz; in
other words, the satellite clock frequency is set to f0 −4.57 × 10−9 MHz.
For the receiver ﬁxed on the earth’s surface, the frequency of the clock in the
receiver is also affected by the relativistic effects. The effects can be represented
analogously by Eq. 5.150, where ΔU = 0 and v is the velocity of the receiver due to
the rotation of the earth. Such effects are corrected by the software of the receiver.
5.3  Relativistic Effects
97

Path Range Effects
The general relativity effects of the signal transmitted from the GPS satellite to
the receiver can be represented by the Holdridge (1967) model:
Dqrel ¼ 2l
c2 ln q j þ qi þ q j
i
q j þ qi  q j
i
;
ð5:151Þ
where ρj and ρi are the geocentric distances of the satellite j and station i, respec-
tively, ρi
j is the distance between the satellite and the observing station, and Δρrel has
units of metres and a maximum value of about 2 cm. It is notable that by computing
the distance ρi
j, the effect of the rotation of the earth during signal transmission must
be taken into account (if it is done in the earth’s ﬁxed system).
Earth’s Rotational Effects
All corrections related to the rotation of the earth are called Sagnac corrections.
The geocentric vector of the GPS satellite is denoted by~rs, the geocentric vector of
the receiver by~rr, and the velocity vector of the receiver by~vr. These are the vectors
during GPS signal emission. Suppose the transmitting time between the signal
emission from satellite and signal reception of receiver is Δt. During the time of GPS
signal transmission, the receiver has moved to position~rr þ~vrDt. Observing from the
non-rotating frame, the distance of the signal transmission can be represented by
cDt ¼ ~rr þ~vrDt ~rs
j
j:
ð5:152Þ
Therefore, the transmitting path correction due to the rotation of the earth can be
presented as
Dq ¼ ~rr þ~vrDt ~rs
j
j  ~rr ~rs
j
j:
ð5:153Þ
This can be simpliﬁed as (Ashby and Spilker 1996)
Dq ¼ ð~rr ~rsÞ ~vr
c
:
ð5:154Þ
The correction can reach up to 30 m and must be taken into account.
If the signal transmitting time Δt has been solved through iteration of Eq. 5.152,
then the Sagnac correction will automatically be taken into account.
This term of correction is also valid for the kinematic GPS receivers that are not
ﬁxed on the earth’s surface. The velocity vector in Eq. 5.154 is
~vr ¼ ~xe ~rr þ~vk;
ð5:155Þ
where the ﬁrst term on the right-hand side is the velocity vector of the receiver due
to the earth’s rotation, and the second term~vk is the kinematic velocity vector of the
receiver related to the earth’s surface. A kinematic motion of 100 km h−1 related to
the earth’s surface can cause additional Sagnac effects up to 2 m.
98
Chapter 5  Physical Inﬂuences of GPS Surveying

The Sagnac correction also must be taken into account for low-earth orbit
(LEO) satellites (e.g., TOPEX, CHAMP, and GRACE), which are equipped with
onboard GPS receivers for satellite-satellite tracking (SST).
Relativistic Effects due to Orbit Eccentricity
The theoretical formula of the clock correction of the satellite can be written as
(Ashby and Spilker 1996)
Dte ¼ 2
c2
ﬃﬃﬃﬃﬃﬃ
la
p
e sin E þ const:;
ð5:156Þ
where a is the semi-major axis of the satellite orbit, e is the eccentricity of the orbit,
E is the eccentric anomaly of the orbit, µ is the gravitational constant of the earth,
and Δte is the clock correction due to the eccentricity of the orbit. The second term
on the right-hand side is a constant that cannot be separated from the clock offset.
This total correction has already been taken into account in the GPS orbits deter-
mination and is broadcasted in the navigation message by the parameters of the
clock error polynomial. Therefore, this term of correction only needs to be con-
sidered in the satellite orbit determination.
Using the relation of esinE ¼ ðxvx þ yvy þ zvzÞ=
ﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðlaÞ
p
(c.f. Kaula 1966), the
Eq. 5.156canbepresentedbytheposition(x,y,z)andvelocity(vx,vy,vz)ofthesatellite.
General Relativity Acceleration of the Satellite
The International Earth Rotation and Reference Systems Service (IERS) stan-
dard correction for the acceleration of the earth satellite is (McCarthy 1996)
D~a ¼
l
c2r3
4 l
r  v2
h
i
~r þ 4ð~r ~vÞ~v
n
o
;
ð5:157Þ
where c is the speed of light, µ is the gravitational constant of the earth, r;~v and ~a
are the geocentric satellite position, velocity, and acceleration vectors, respectively.
5.4
Earth Tide and Ocean Loading Tide Corrections
5.4.1
Earth Tide Displacements of GPS Stations
The earth tide is a phenomenon of the deformation of the elastic body of the earth
caused by the gravitational attracting force of the moon and the sun. Such a
deformation depends not only on the changing of the force, but also on the physical
structure and motion of the earth (Melchior 1978).
Generally, the sun-moon-earth system may be separated into two two-body
systems to discuss the effects of the sun and the moon on the earth, respectively. For
5.3  Relativistic Effects
99

the moon-earth system, the mass centre can be found out according to the deﬁni-
tion. It lies on a straight line between the centres of the earth and the moon, and has
a distance to the centre of the earth of about 0.73 RE, where RE is the radius of the
earth (Fig. 5.7). For the point-mass p (with unit mass) on the earth, the tidal
potential generated by the moon can be derived as
Wp ¼ lm
1
r0  1
r  q
r2 cos z


;
ð5:158Þ
where r is the geocentric distance of the moon, ρ is the geocentric distance of point
p, µm is the gravitational constant of the moon, z is the geocentric zenith angle of
the moon, and r′ is the distance between the point p and the centre of the moon. The
1/r′ in Eq. 5.158 can be developed by Legendre polynomials, and then
Wp ¼ lm
X
1
n¼2
qn
rn þ 1 Pnðcos zÞ;
ð5:159Þ
where Pn(cosz) is the conventional Legendre polynomials of n degree. Applying the
well-known formula of spherical astronomy (cf., e.g., Lambeck 1988),
cos z ¼ sin u sin d þ cos u cos d cos H;
ð5:160Þ
to Eq. 5.159 and using the addition theorem (cf., e.g., Lambeck 1988), Laplace’s
formula of the tidal potential can be obtained by
Wp ¼ l m
X
1
n¼2
qn
rn þ 1 ½Pnðsin uÞPnðsin dÞ þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin dÞ cos kH;
ð5:161Þ
Fig. 5.7 The earth-moon system
100
Chapter 5  Physical Inﬂuences of GPS Surveying

where φ is the latitude of computing point p, δ, and H are the declination and local
hour angle of the moon, and Pnk(x) is the associated Legendre polynomials of
degree n and order k. Laplace’s formula shows the signiﬁcant geometric and
periodic characters of the tidal potential. Similar discussions can be made for the
earth-sun system, and the related tidal potential can be obtained by substituting the
gravitational constant of the sun µs and geocentric distance of the sun into
Eq. 5.161. The total tidal potential is the summation of both potentials generated by
the moon and the sun. The truncating order of the summation can be selected due to
the precision requirement and the truncating errors can be estimated by considering
µm, µs and the ratio RE/r of the moon and the sun.
The tidal displacements resulting from the tidal potential are then
DSr ¼ h Wp
g ¼
X
1
n¼2
hn
WpðnÞ
g
;
ð5:162Þ
DSu ¼ l @Wp
g@u ¼
X
1
n¼2
ln
@WpðnÞ
g@u
and
ð5:163Þ
DSk ¼ l
@Wp
g cos u@k ¼
X
1
n¼2
ln
@WpðnÞ
g cos u@k;
ð5:164Þ
where ΔSr, ΔSφ, and ΔSλ are the tidal displacements in the radial, north, and east
directions, respectively; h and l are the Love and Shida numbers (in more detailed
words, hn and ln are the Love and Shida numbers of degree n); Wp(n) is the tidal
potential of degree n, g ≈µ/RE
2; µ is the gravitational constant of the earth; and RE
is the radius of the earth.
It is notable that the tidal potential includes a permanent (i.e. time-independent)
part. This part of the tide is now included in the geoid deﬁnition, which was already
accepted by the International Association of Geodesy (IAG) in 1983 (Poutanen
et al. 1996). Therefore, such a term must be dealt with carefully. Examples to move
or to keep the permanent tidal term from the above formulas may be found in the
IERS standard (McCarthy 1996).
5.4.2
Simpliﬁed Model of Earth Tide Displacements
The vector displacement of the station due to degree 2 of the tidal potential is
(McCarthy 1996; Zhu et al. 1996)
D~q ¼
X
2
j¼1
ljR4
E
lr3
j
h2^q 3
2 ð^rj  ^qÞ2  1
2


þ 3l2ð^rj  ^qÞ½^rj  ð^rj  ^qÞ^q


;
ð5:165Þ
5.4  Earth Tide and Ocean Loading Tide Corrections
101

where µ is the gravitational constant of the earth, RE is the equatorial radius of
the earth, j = 1, 2 are indices for the moon and sun, respectively, ^rj and ^q are the
geocentric identity vectors of the moon (or sun) and station, rj and ρ are the
magnitude of the related geocentric vectors, and h2 and l2 are nominal degree 2
Love and Shida numbers (for an elastic earth model, the nominal values are 0.6078
and 0.0847). In Eq. 5.165, the terms factorised by h2 and l2 are the radial and
transverse components of the tidal displacement. Taking the latitude dependence
into account, h2 and l2 shall have the forms of
h2 ¼ 0:6078  0:0006 3 sin2 u  1
2
and
l2 ¼ 0:0847 þ 0:0002 3 sin2 u  1
2
:
ð5:166Þ
The vector displacement of the station due to degree 3 of the tidal potential is
(McCarthy 1996)
D~q ¼ l1R5
E
lr4
1
h3^q 5
2 ð^r1  ^qÞ3  3
2 ð^r1  ^qÞ


;
ð5:167Þ
where h3 = 0.292. Here only the radial component of the moon is considered.
As discussed in Sect. 5.4.1, there is a permanent part of the tidal deformation
included in the degree 2 tidal potential. The projections of the permanent dis-
placement into the radial and north directions are
0:0603 3sin2u1


and
0:0252sin2u:
This must be removed from the computation of Eq. 5.165 according to the IERS
standard. Generally, the tidal displacements computed using the model given above
have accuracy on a millimetre level.
In GPS applications, the computing time is usually the GPS time, and the
coordinates of the stations are given in the CTS system. However, the ephemerides
of the sun and moon are given in the CIS coordinate system with time TDT.
Therefore, time and coordinates have to be transformed to a unique time-coordinate
system. The details of the time-coordinate system can be found in Chap. 2.
The ephemerides of the sun and the moon are usually computed or forecasted
every half-day (12 h). The ephemerides of the sun and the moon at a required epoch
are interpolated from the data of the two adjacent epochs (t1, t2) by using a
ﬁfth-order polynomial:
f ðtÞ ¼ a þ bðt  t1Þ þ cðt  t1Þ2 þ dðt  t1Þ3 þ eðt  t1Þ4 þ f ðt  t1Þ5:
102
Chapter 5  Physical Inﬂuences of GPS Surveying

For data at two epochs, e.g.,
t1 : x1; y1; z1; _x1; _y1; _z1;€x1;€y1;€z1
and
t2 : x2; y2; z2; _x2; _y2; _z2;€x2;€y2;€z2;
where
_x and €x are the velocity and acceleration components related to
x. Considering the formulas of f(t), df(t)/dt, d2f ðtÞ=dt2, and letting t = t1, one gets
a = x1, b ¼ _x1 and c ¼ €x1=2. Letting t = t2, coefﬁcients of d, e, f can be derived
theoretically, e.g., in the case of t2 −t1 = 0.5:
d ¼ 80ðx2  x1Þ  16_x2  24_x1 þ€x2  3€x1;
e ¼ 240ðx2  x1Þ þ 56_x2 þ 64_x1  4€x2 þ 6€x1
f ¼ 192ðx2  x1Þ  48_x2  48_x1 þ 4€x2  4€x1:
For y and z components, the formulas are similar. This interpolating algorithm is
accurate enough to use the given half-day ephemerides of the sun and moon to get
the data at the required epoch. The computation of the ephemerides of the sun and
moon will be discussed in Sect. 11.2.8.
5.4.3
Numerical Examples of Earth Tide Effects
The displacement caused by earth tide effects can reach as high as 60 cm in certain
parts of the world (Melchior 1978; Poutanen et al. 1996); in Greenland, effects of
30 cm are observed (Xu and Knudsen 2000). The effects of earth tides on GPS
positioning is a well-known correction term, and must be taken into account in
many cases as soon as this effect is greater than the accuracy required for the GPS
results. The tidal parameters (Love and Shida numbers) can also be determined
through global GPS observations.
Only the GPS positioning, which is carried out on the air without ﬁxed reference
on the earth, is free from the earth tide effects. For the GPS relative positioning of a
small regional area, the tidal effects may be neglected because of the small dif-
ferences in the tidal displacements. In the relative airborne kinematic GPS posi-
tioning, the airborne antennas are free from earth tide effects. However, the static
references ﬁxed on the earth are not free from tidal effects. In this case, the tidal
displacements are independent of the size of the applied area or lengths of the
baselines and have to be taken into account.
Three examples are given to illustrate the tidal displacements (Xu and Knudsen
2000). The IERS standards are used as the principle of the earth tide effect com-
putation (McCarthy 1996).
Three stations in Greenland were selected for computation of a whole day (GPS
time used) of tidal displacements on 31 December 1998. Coordinates were quite
5.4  Earth Tide and Ocean Loading Tide Corrections
103

roughly selected for Narsarsuaq (60°, 315°), Scoresbysund (70°, 339°), and Thule
(77°, 290°). Heights were selected as 50 m. Results of the vertical components are
illustrated as 2-D graphics with the ﬁrst axis time in hours and the second axis
displacement in meters. Solid, dotted, and dashed lines represent the results of the
ﬁrst, second, and third stations, respectively (Fig. 5.8, units: meters). The tidal
displacements of the three stations in Greenland have a maximum difference of
about 15 cm. The size of the triangle of the three stations is about 2000 km. The
change in the tidal displacements in the vertical component is about 27 cm. That
change could happen within a duration of 4–5 h.
Two grid data points of 0.2° × 0.3° for Denmark (54.0° ≤φ ≤57.8°,
8° ≤λ ≤12.9°) and 1° × 1° for Greenland (59.5° ≤φ ≤84°, 285° ≤λ ≤350°)
with real topography height are used to compute vertical tidal displacements at time
1:00 and 1:45, respectively. The displacements are illustrated with contour lines
(units: meters) plotted in Figs. 5.9 and 5.10, with the ﬁrst axis longitude in degrees
and the second axis latitude in degrees. In Fig. 5.9 there is a tidal difference of
15 mm, which shows that within an 80-km distance or area in Denmark the tidal
difference can reach up to 5 mm. Figure 5.10 shows that there is a vertical tidal
difference of about 17 cm in Greenland.
These computations indicate that in differential GPS kinematic airborne (not
touching the earth) applications, a lack of the earth tide correction could cause an
accuracy of less than 30 cm in Denmark and Greenland. For the earth-touched
kinematic and static differential GPS applications, a lack of earth tide correction
would cause an accuracy of less than 2 cm in Denmark and 15 cm in Greenland.
It is worth mentioning that the average value of the earth tide effects on a GPS
station during 24 h is generally not zero (it may be up to a few cm). This is because
the earth tide is an effect that includes many periodical components. This indicates
that the earth tide effects cannot be eliminated through daily averaging.
Fig. 5.8 Earth tide
displacements at three stations
in Greenland (vertical
component; date: 31 Dec.
1998)
104
Chapter 5  Physical Inﬂuences of GPS Surveying

5.4.4
Ocean Loading Tide Displacement
The ocean tide is a time varying load on the earth’s surface. The displacement of the
earth’s surface due to loading is called the ocean tide loading effect. Similar to the
earth tide, the loading Love numbers are introduced to describe the relationships of
the loading potential and the loading displacement as
DSr ¼ h0 Wp
g ¼
X
1
n¼0
h
0
n
WpðnÞ
g
;
ð5:168Þ
DSu ¼ l0 @Wp
g@u ¼
X
1
n¼0
l
0
n
@WpðnÞ
g@u
and
ð5:169Þ
DSk ¼ l0
@Wp
g cos u@k ¼
X
1
n¼0
l
0
n
@WpðnÞ
g cos u@k;
ð5:170Þ
Fig. 5.9 Earth tide
displacement (in metres) in
Denmark (31 Dec. 1998; GPS
time 1:00; height component)
5.4  Earth Tide and Ocean Loading Tide Corrections
105

where ΔSr, ΔSφ, and ΔSλ are the loading tide displacements in the radial, north, and
east directions, respectively, h′ and l′ are the loading Love numbers (in more detail,
h0
n and l0
n are the loading Love numbers of degree n), Wp(n) is the loading potential
of degree n, g ≈µ/RE
2, µ is the gravitational constant of the earth, and RE is the
radius of the earth. It is notable that the zero degree loading Love number and
1 degree loading displacement exist and in the case of n ! 1; h0
n ! h1; nl0
n ! l1.
Loading Love numbers can be obtained from a theoretical model.
The loading displacement shall fulﬁl the elastic balance equation under the
boundary condition of loading. This is called the Boussinesq boundary value
problem. The response of the spherical earth under the loading of a point-mass (or
unit mass) is called the Green’s function. In other words, the Green’s function is the
solution of the partial differential equation of the Boussinesq problem under a
certain spherical boundary condition of a point-mass loading. For a related
boundary condition, the related Green’s function can be derived. Farrell derived the
following loading displacement Green’s functions (Farrel 1972):
Fig. 5.10 Earth tide
displacement (in metres) in
Greenland (31 Dec. 1998;
GPS time 1:45; height
component)
106
Chapter 5  Physical Inﬂuences of GPS Surveying

uðkÞ ¼
Rh0
1
2Me sinðk=2Þ þ R
Me
X
N
n¼0
ðh0
n  h0
1ÞPnðcos kÞ
and
ð5:171Þ
vðkÞ ¼ R cosðk=2Þ½1 þ 2 sinðk=2Þ
2Me sinðk=2Þ½1 þ sinðk=2Þ þ R
Me
X
N
n¼1
ðnl0
n  l0
1Þ
n
@Pnðcos kÞ
@k
;
ð5:172Þ
where R is the radius of the earth, Me is the mass of the earth, k is the geocentric
zenith distance of the loading point (related to the computing point, see Fig. 5.11),
Pn(cosk) is the Legendre function, and u(k) and v(k) are the radial and tangential
loading displacement Green’s functions, respectively.
According to the deﬁnition of the Green’s function, the loading displacements of
the ocean tide of the whole earth can be obtained by multiplying the tidal mass to
the Green’s function and integrating that over the whole ocean
ur ¼
ZZ

ocean
dHuðkÞdr;
ð5:173Þ
uu ¼
ZZ

ocean
dHvðkÞ cos adr;
and
ð5:174Þ
uk ¼
ZZ

ocean
dHvðkÞ sin adr;
ð5:175Þ
Fig. 5.11 Ocean loading
5.4  Earth Tide and Ocean Loading Tide Corrections
107

where a is the azimuth of the integrating surface element dσ, δ is the density of the
oceanic water (δ ≈1.03), H is the height of ocean tide, and ur, uφ, and uλ are the
loading displacements of radial, north, and east components, respectively. It is
obvious that an ocean tide model is needed here.
One of the most commonly used models is the Schwiderski global ocean tide
model, which has a resolution of 1° × 1° and represents the tidal amplitude and
phase (Schwiderski 1978, 1979, 1980, 1981a, b, c). The accuracy of the loading
tide modelling depends on the accuracy of the loading response and ocean tide
model. Because of the irregularity of coastlines, and because the loading response is
more dependent on the local variable properties of the lithosphere (Farrel 1972),
modelling of the loading effects cannot be done very accurately.
Let
H ¼
X
I
i¼1
Hi;
ZZ

ocean
Fdr ¼
X
N
n¼1
FðnÞdrn;
X
N
n¼1
drn ¼ total surface of the ocean;
where Hi is the ocean tide constituent with angular velocity ωi, I is the truncating
wave number, F is any to be integrated function, F(n) and dσn are the functional
value and the size of the nth surface element, and N is the total elements number. If
one changes the order sequence of the summations, then Eqs. 5.173–5.175 will be
ur ¼
X
I
i¼1
X
N
n¼1
dHiuðkÞdrn;
ð5:176Þ
uu ¼
X
I
i¼1
X
N
n¼1
dHivðkÞ cos adrn;
and
ð5:177Þ
uk ¼
X
I
i¼1
X
N
n¼1
dHivðkÞ sin adrn:
ð5:178Þ
In other words, the loading displacements can be represented by summations of
displacements of the different wave of frequencies, and the amplitude and phase of
the related wave are dependent on the computing position.
5.4.5
Computation of the Ocean Loading Tide Displacement
Computation of the loading displacement depends on which ocean tide model is
used. Because of the strong dependence of the loading on the coast near tide,
besides a global ocean tide model a modiﬁed model near the coastlines is added
quite often to raise the precision of computation. Taking advantage of the fact that
the amplitude and phase of the related wave depends only on the computing
108
Chapter 5  Physical Inﬂuences of GPS Surveying

position, the computation can be greatly simpliﬁed. Generally, only 11 tidal con-
stituents are taken into account. These are the semi-diurnal waves M2, S2, K2, and
N2, the diurnal waves O1, K1, P1, and Q1, and the long-period waves Mf, Mm, and
Msa. The loading displacement vector in IERS standard (McCarthy 1996) is
Dqj ¼
X
11
i¼1
fi  ampjðiÞ  cos½argði; tÞ  phasejðiÞ
and
ð5:179Þ
argði; tÞ ¼ xit þ vi þ ui;
ð5:180Þ
where j = 1, 2, 3 represents the displacement in radial, west, and south directions,
respectively, ampj(i) and phasej(i) are the amplitude and phase of the ith wave
related to the computing station of jth component, arg(i, t) is the argument of ith
wave at the computing time t, ωi is the angular velocity of the ith wave, χi is the
astronomical argument at 0 h, and fi and ui depend on the longitude of the lunar
node. ωi, fi, and ui can be found in Table 26 of Doodson (1928). The ampj(i) and
phasej(i) are computed for a list of stations by Scherneck (McCarthy 1996). The
coefﬁcients and software are available by Scherneck.
5.4.6
Numerical Examples of Loading Tide Effects
Loading tide effects could reach up to 10 cm at some special coast regions (cf., e.g.,
Andersen 1994; Khan 1999). The loading displacements affect mostly only the GPS
stations near the coast. The displacements at most continental stations are less than
1 cm. Loading correction has not been commonly considered in GPS data pro-
cessing because the computation is more complicated and modelling is less accu-
rate. However, for precise applications, loading effects have to be taken into
account. Using software, e.g., designed by Scherneck, the loading amplitude and
phase of the signiﬁcant waves can be obtained for static stations. The coefﬁcients
can
be
computed
beforehand
and
used
for
even
real
time
applications.
Kinematic GPS receivers on the air are free of loading effects. Car-borne kinematic
GPS applications are generally limited within regional areas, and the relative effects
are generally very small. For exactness, the loading effects can be interpolated from
that of the surrounding static stations.
An example is given to illustrate the loading tide displacements of a vertical
component (Fig. 5.12). The AG95 model is used as the principle of the loading
effects computation (Andersen 1994). Loading displacements of two stations are
computed for a whole day (GPS time used) on the 18 March 1999. Coordinates are
quite
roughly
selected
for
station
Brst
(48.3805°,
355.5034°)
and
International GNSS Service (IGS) station Wtzr (49.1442°, 12.8789°). Results of the
height components are illustrated as 2-D graphics with the ﬁrst axis as time in hours
and the second axis displacement in metres. Continuous and broken lines represent
5.4  Earth Tide and Ocean Loading Tide Corrections
109

the results of the ﬁrst and second stations, respectively. The loading displacements
of the two stations have a maximum difference of about 6 cm.
This computation indicates that a lack of loading tide correction could cause an
accuracy of a few centimetres for some applications. Even for differential appli-
cations, a lack of loading tide correction could cause an accuracy of less than 6 cm
in the given example.
It is worth mentioning that the average value of the loading effects on a GPS
station during 24 h is generally very small. This indicates that the loading effects
can be eliminated through daily averaging. In a static case, either loading correction
or no loading correction may cause a difference of the standard deviation of the
length of a baseline up to 0.5 cm (Khan 1999).
As an analogue to the tropospheric model parameterisation, a loading parameter
may be introduced for a static station near the coast due to less accuracy of the
loading modelling. The parameter (e.g., a factor of the total loading vector) may be
determined through GPS data processing.
5.5
Clock Errors
As discussed in Chap. 4 in the models of GPS observables, the clocks on the
satellites and receivers play a very important role in precise GPS surveying. The
inﬂuences of the clock errors on the GPS may be grouped into three types. One is
factored with the speed of light, c. Another is factored with the speed of satellites.
And the third is factored with the working frequency.
The inﬂuence of the ﬁrst type of clock error is obvious. For code measurements,
one measures the transmitting time of the signal and multiplies the transmitting time
with c to obtain the transmitting path length. A clock error of δt will cause a path
length error of cδt. Similarly, a clock error of δt will cause a phase error of cδt/λ.
Because of the factor c, a small clock error may cause a very large code and phase
Fig. 5.12 Ocean loading tide
effects of two GPS stations
(height components)
110
Chapter 5  Physical Inﬂuences of GPS Surveying

error. Therefore, high quality clocks have to be used on the satellites and receivers.
Meanwhile, clock errors must be carefully modelled. A simple model may be
expressed as
dt ¼ b þ dt þ at2;
t1 	 t 	 t2;
ð5:181Þ
where b is the bias, d is the drift, and a is the acceleration of the related clock. Time
interval (t1, t2) is the valid period of clock error polynomial. The length of the
interval depends directly on the stability of the clock. Such a model describes that
the clock has a small drift and acceleration, and the drift and acceleration as well as
bias are stable. The interval may be estimated by using the drift and acceleration
accordingly.
In the case of SA (selective availability, for details cf. Sect. 5.7), the frequency
of the clock on the satellite is manipulated artiﬁcially. In other words, the scale of
the clock on the satellite is no longer a constant; i.e. the clock is no longer stable.
Therefore, in such a case, the model of Eq. 5.181 is not good enough for use. An
alternative model of the satellite clock error in the case of SA is
dt ¼ bi;
t ¼ ti:
ð5:182Þ
Thus the clock bias must be modelled for every measuring epoch. The clock error
parameters must be determined or equivalently eliminated every epoch.
The inﬂuence of the second type of clock error is more or less implicit. Recalling
the code and phase models discussed in Chap. 4, there is a geometric distance
between the satellite at the signal emission time and the receiver at the signal
reception time. The position and velocity of the satellite are functions of time.
Therefore, a clock error causes a computing error of the position of the satellite by
~vsdt, where ~vs is the velocity vector of the satellite. These errors pass through the
distance function and cause errors of the computed distance. Such an inﬂuence is
implicitly presented in all the GPS observation models and cannot be eliminated
through forming differences. However, the inﬂuence of the clock error is factorised
by the velocity of the satellite (about 3 km s−1), so an estimation of δt up to an
accuracy of 10−6 would be enough to ensure the required accuracy of the computed
satellite position. Such estimation is usually made through the single point posi-
tioning of every station at every epoch (details, cf. the section of single point
positioning in Sect. 9.5.2). Of course, we must also take the relativistic effects into
account.
As discussed above, the clock error causes a phase error of cδt/λ; this is
equivalent to a frequency error of fδt. Obvious, this correction must be taken into
account in Doppler data processing.
Synchronisation of the clocks on the satellites and receivers is a basic prereq-
uisite of a meaningful GPS measurement. Clock modelling automatically leads to
the synchronisation of all clocks.
A recent study showed that clock error parameters were linearly correlated with
the ambiguity parameters (for details, see Sect. 9.1).
5.5  Clock Errors
111

5.5.1
Introduction of Commonly Used Clock Error Models
As we know, the measurement of the precise satellite navigation position is actually
accurate time measurement; therefore, the highly precise satellite clock is the basis
of the navigation system. The satellite clock error parameter must be precisely
known when using satellite navigation systems in order to achieve rapid positioning
and time synchronisation; thus the estimation and prediction of the satellite clock
error are essential (Huang 2012).
In researching a satellite clock error, a precise clock error model must ﬁrst be
constructed. In this section, we introduce the commonly used polynomial model,
spectral
analysis
(SA),
and
grey
models
(GM),
and
the
autoregressive–
moving-average (ARMA) model.
Polynomial model
The polynomial model (Kosaka 1987) is the most widely used for the prediction
and ﬁtting of clock errors, and encompasses linear, quadratic, and high-order
polynomial models, which can be expressed as
xi ¼ a0 þ a1ti þ a2t2
i þ    þ amtm
i þ eið0 	 i 	 nÞ;
ð5:183Þ
where xi is the clock error at time ti, a0, a1, a2,…, am denotes a number of m clock
error parameters, m is the order of the polynomial, and ei denotes the model error.
The polynomial model is simple and practical, with clear physical meaning, and has
high precision for short-term prediction and ﬁtting. As such, it has been extensively
applied in GNSS real-time navigation positioning. The linear and quadratic models are
used in the real-time satellite clock error prediction of broadcast ephemeris in GPS and
GLONASS, respectively. The determination of the order of the polynomial model
mainly depends on the frequency stability and frequency drift characteristics of the
atomicclock.Generally,thelinearpolynomialissuitablefor thepredictionandﬁtting of
caesium atomicclocksincetheshort-termfrequencystabilityofcaesium atomicclockis
somewhat poor and the frequency drift is not obvious. The quadratic polynomial is
suitable for rubidium atomic clock since its good short-term frequency stability.
Spectral Analysis (SA) Model
Clock error series typically comprise not only linear and quadratic variation, but
also periodic terms. Thus, SA (Percival 2006) can be used to ﬁnd the obvious
periodic term in the clock error series to establish a more accurate clock error
model. When taking into account the linear trend term, the SA model for the clock
error can be expressed as
xi ¼ a0 þ b0ti þ
X
p
k¼1
Ak sinð2pfkti þ ukÞ þ eið0 	 i 	 nÞ;
ð5:184Þ
112
Chapter 5  Physical Inﬂuences of GPS Surveying

where a0 and b0 are the coefﬁcients of the linear trend term, p is the number of the
obvious periodic terms, fk is the frequency of the corresponding periodic term, Ak
and φk are amplitude and phase of the corresponding periodic term, respectively, ei
denotes the residual error of xi. p, and fk can be determined by the SA.
Grey Model (GM)
The grey system is an information processing method ﬁrst proposed by Deng
(1987). It works largely on system analysis that has produced poor, incomplete, or
uncertain messages. The GM for the clock error can be expressed as
xð0ÞðkÞ ¼ 1  ea
ð
Þ xð0Þð1Þ  u
a
h
i
eaðk1Þ;
ð5:185Þ
where xð0ÞðkÞ is the k element of the original clock error series, and a and u are
model parameters. According to the principle of least squares, a and u can be
estimated by nðn  4Þ observations.
The advantage of the GM is that it needs only a few data points (as few as four
original data points) to estimate an unknown system, which can reduce data usage
and improve the efﬁciency of model establishment.
Autoregressive Moving Average (ARMA) model
The ARMA model is a conventional random time-sequence model invented by
Box and Jenkins, known also as the B-J method (Box et al. 1994). There are three
basic types of ARMA models: autoregressive (AR), moving average (MA), and
autoregressive moving average (ARMA) models. The ARMA (p, q) can be
expressed as
xt ¼ u1xt1 þ    þ upxtp þ at  h1at1      hqatq;
ð5:186Þ
where xt, xt−1,…,xt−p is the observation sequence, φ1,…,φp are autoregressive
coefﬁcients, θ1,…,θp are moving average coefﬁcients, p and q are the order of
autoregressive model and moving average model, respectively, at, at−1,…,at−p is
stationary white noise with a mean value of zero and a variance of σa
2.
The ARMA model is suitable only for a stationary random sequence. In practical
applications, however, few observations can meet such a requirement, and thus
difference processing is essential. The model based on the differential time sequence
is called the autoregressive integrated moving average (ARIMA) model, which can
be denoted as {xt} * ARIMA(p, d, q), where d is the order of difference.
Parameter estimation methods
The coefﬁcients of the clock error model mentioned above must be estimated
through appropriate parameter estimation methods. Two methods are commonly
used: the sequential least squares and the kinematic Kalman ﬁlter. Details of these two
methods can be found in Sects. 7.3 and 7.7. Currently, the sequential least squares is
most commonly applied in the real-time prediction of the GNSS clock error because
5.5  Clock Errors
113

of the stability and not divergence of the algorithm, while the kinematic Kalman ﬁlter
is widely used in the post-processing of precise clock error by IGS.
5.5.2
Impact of Frequency Reference of a GPS Receiver
on the Positioning Accuracy
As we know, the vertical precision of the GPS is two to three times less accurate than
its horizontal counterpart, mainly due to difﬁculties in correcting clock errors, mul-
tipath, tropospheric delay, antenna phase centre variations, and the asymmetry in the
observed GPS constellation in the height direction (Leick 2004). Most GPS data
analysis procedures utilise double differences to reduce clock and orbital errors.
Carrier-phase ambiguities, cycle slips, and clock errors can be repaired by processing
pseudorange signals and triple-differenced phases, while ionospheric delay can be
corrected by modelling or dual-frequency combinations (Bock and Doerﬂinger 2001;
Yeh et al. 2008). To correct clock errors, the IGS provides users with GPS satellite
clock errors via the internet to increase positioning accuracy (Ray and Senior 2005;
Dow et al. 2009). Therefore, the GPS receiver clock error is an important factor
affecting positioning accuracy. In a study by Yeh et al. (2009), a positioning error of
1–2 cm was found due to improperly modelled receiver clock errors. In this section,
we emphasise the research by Yeh et al. (2012), which explored the impact of the
frequency offset and the frequency stability of the internal quartz oscillator or of an
externally supplied rubidium oscillator on the positioning accuracy.
To assess the dependence of the positioning performance of the receiver on the
frequency performance of its internal oscillator, this study sequentially used the
receiver’s clock steering function to change its clock between the internal quartz (the
steering switched off) and external rubidium oscillators. The clock steering uses GPS
observations to synchronise the internal quartz oscillator to GPS time. Furthermore,
as the rubidium oscillator frequency may vary in time, a regular frequency cali-
bration should be made via direct method (using a counter to calibrate the rubidium
oscillator directly) or remote method (using GPS data to calculate the clock error).
In this study, undifferentiated GPS phase observables were employed to calculate
frequency offsets and frequency stabilities of the GPS receivers based on the method
developed by Dach et al. (2003). Bernese GPS software version 5.0 (Dach et al.
2007) was used to estimate receiver clock errors and then the clock errors in each
epoch were employed to compute frequency offset and frequency stability by Allan
deviation (Allan and Weiss 1980; Lesage and Ayi 1984). Experimental results
showed, the rubidium oscillator on average outperformed quartz oscillators by 1–6
orders of magnitude in terms of frequency stability, while the offset of the quartz
oscillator was smaller than that of the rubidium oscillator in this study since, clock
steering was able to compensate for the phase difference of the quartz oscillator.
After conﬁrming the accuracy of the frequency offset and frequency stability of
both quartz and the rubidium oscillators, the effects of clock errors on GPS
114
Chapter 5  Physical Inﬂuences of GPS Surveying

positioning accuracy were analysed. Three baselines (short, medium, and long)
were selected to conduct static relative positioning. Experimental results showed
that rubidium oscillators achieved higher positioning accuracy than quartz oscil-
lators, regardless of whether the baseline was short, medium, or long. In this study,
the accuracy with short-, middle-, and long-distance static relative positioning using
rubidium oscillators was higher than that of quartz oscillators by 5, 11, and 15 %,
respectively, indicating that clock quality is more inﬂuential for long-baseline GPS
relative positioning. The results also showed that the average improvement of the
vertical direction was twice as large as that of the horizontal direction, which agrees
with the statement described at the beginning of the section.
In terms of the respective performance of the rubidium and quartz oscillators in
frequency offset and frequency stability, the rubidium oscillator was much better than
the quartz oscillators in frequency stability. However, for frequency offset, the quartz
oscillator was better than the rubidium oscillator on average. Therefore, a conclusion
that the GPS receiver with a rubidium oscillator has higher positioning accuracy than
the GPS receivers with quartz oscillator because it is equipped with a relatively more
stable internal frequency can be inferred. Notably, although the rubidium oscillator has
a frequency offset, as long as this offset is steady and can be calculated and removed, its
impact on positioning accuracy is not appreciable. Thus, the frequency stability of a
receiver clock is far more critical than the frequency offset (Yeh et al. 2012).
5.6
Multipath Effects
Multipath is the phenomenon whereby a GPS signal arrives at a receiver’s antenna
via more than one path. Multipath propagation affects both pseudorange and carrier
phase measurements. In GPS static and kinematic precise positioning, the multipath
effect is an error source that must be taken into account. Related studies have been
carried out for many years to reduce or eliminate the multipath effects (cf., e.g.,
Braasch 1996; Langley 1998a, b; Hofmann-Wellenhof et al. 1997).
Multipath is a highly localised effect, which is dependent only on the local
environment surrounding the antenna. As illustrated in Fig. 5.13, the receiver may
receive both the directly transmitted signal and the reﬂected (indirect) signal. The
indirect path is clearly dependent on the reﬂecting surface and the satellite position.
The reﬂecting surface is usually static and is related to the receiver; however, the
satellite moves with time. Therefore, the multipath effect is also a variable of time.
Consider the direct signal s(t) = Acos(ωt + φ), where A is the amplitude, ω is the
angular velocity, and φ is the phase; the indirect signal can then be represented as
f  s(t + δt), where f is a factor with the physical meaning of reduced energy
through reﬂection, and δt is the time delay. The multipath effect is indeed the
inﬂuence of the indirect signal on the observations of the receiver. Because different
receiver deals with the signals with a different manner, multipath error is highly
dependent upon the architecture of the receivers.
5.5  Clock Errors
115

Theoretically (Braasch 1996; Langley 1998a, b), the multipath effect may reach
up to 15 m for P-code measurements and 150 m for C/A-code. Because of the chip
length, P-code is much less sensitive to the indirect signal. Typically, multipath
error of the carrier phase is on the order of a few cm.
GPS signals are right-handed circularly polarised (RHCP); therefore, conven-
tional GPS antennas are designed as RHCP antennas. This property helps to reject
the multipath signal because the reﬂected signal has changed its polarisation. The
pure reﬂected signals received by the RHCP antenna usually have only one-third of
the signal-to-noise ratio compared with that of the direct signals (Knudsen et al.
1999). This may also be used to detect multipath effects. The simplest method to
avoid the inﬂuence of the multipath effects is to set up the antenna far away from
possible reﬂecting surfaces. Using only the carrier phase measurement is possibly
the other method. (Code is usually used for clock error correction for the satellite
coordinates computation; this would be accurate enough even if the multipath
effects existed in code; for details, see the discussion in Sect. 5.5.) In the case of
code positioning, a phase-smoothed code should be used. This can reduce the
maximum multipath effects to a few cm.
An exact method to deal with the multipath effects is to detect the multipath
using code-phase data and then reject the related phase data or set the phase data to
a lower weight for phase data processing. Recalling the models of the code and
phase observables discussed in Sects. 4.1 and 4.2, a code-phase difference can be
formed by using Eqs. 4.7 and 4.18 as
Rs
rðtr; teÞ  kUs
rðtrÞ ¼ 2dion þ kNs
r þ dmul þ e;
ð5:187Þ
where Rs
r tr; te
ð
Þ and Us
r tr
ð Þ are the measured pseudorange and phase, λ is the
wavelength, te is the GPS signal emission time, and tr the signal reception time, δion
denotes the ionospheric effects of the station r, Ns
r is the integer ambiguity
parameter, δmul is the multipath effect of code measurements, and ε is error of code
measurements. The errors of phase and frequency as well as multipath in phase
Fig. 5.13 Geometry of
multipath effects
116
Chapter 5  Physical Inﬂuences of GPS Surveying

measurements are omitted here. Using the above formula, multipath effects in code
measurements can be determined or detected. Because of the higher noise level of
the code measurements, detection over a given period of time is reasonable so that
the noise can be smoothed.
5.6.1
GPS Altimetry, Signals Reﬂected from the Earth’s Surface
The existence of multipath effects indicates that a GPS receiver can be used to
receive the reﬂected GPS signal. In other words, by receiving the reﬂected GPS
signal, GPS may be used to measure the reﬂecting surface topography. Early in
1993, the European Space Agency’s Manuel Martin-Neira ﬁrst suggested using a
GPS reﬂected signal as a signal source for measurement. The accidental acquisition
of ocean-reﬂected GPS signals by an airborne receiver was reported by French
engineers in 1994. Katzberg and Garrison (1996) discussed how the GPS signal
reﬂected from the ocean could be used for the determination of ionospheric effects
in satellite altimetry. Komjathy et al. (1999) used the GPS signal reﬂected from the
ocean to determine wave height, wind speed, and direction. In Denmark, in
cooperation with Xu, Knudsen et al. (1999) used a downward-pointing GPS
antenna to receive the reﬂected GPS signal to explore the possibility of using it for
determining the topography of the sea surface and ice sheet as well as snow-covered
land.
The
CHAllenging
Minisatellite
Payload
(CHAMP)
satellite
has
a
downward-pointing GPS antenna on board for an experiment in GPS altimetry.
Proﬁles of footprints over the sea surface are typically measured using satellite or
airborne altimetry. By using GPS altimetry, however, every footprint proﬁle has a
bandwidth, and thus GPS altimetry can be used to cover the topography of the
reﬂecting surface. The sea and ice sheet as well as snow-covered land are good
reﬂecting surfaces for the GPS signals (Knudsen et al. 1999).
The polarisation of the reﬂected signal changes after the reﬂection. A conventional
GPS antenna is RHCP; therefore, to receive the reﬂected GPS signals, a left-handed
circularly polarised antenna will be used (Komjathy et al. 1999; Katzberg and
Garrison 1996). Such an antenna was designed and used in the experiments reported.
The power of the reﬂected signal is then reduced insigniﬁcantly.
5.6.2
Reﬂecting Point Positioning
The method for processing the downward-pointing antenna-measured GPS data is
quite different from the known method for processing the GPS data obtained by an
upward-pointing antenna. As shown in Fig. 5.14, the GPS signal is transmitted
from the satellite to the downward-pointing antenna through the reﬂecting point R
5.6  Multipath Effects
117

(or more exactly, a small zone surrounding R, cf. Komjathy et al. 1999) of the
reﬂecting
surface.
The
satellite
orbit
is
known.
The
position
of
the
downward-pointing antenna can be determined by using the data received from an
upward-looking antenna. Thus the purpose of GPS altimetry is to determine the
unknown point R. The vertical line of the satellite and the antenna forms a plane.
Such a plane will intersect the earth’s surface and form a curved line, and the
reﬂecting point will be on the line. Because of the principle of reﬂection, the angle
of fall in and the angle of fall out must be equal. In other words, the elevation of the
antenna and that of the satellite related to the reﬂecting surface at the reﬂecting
point must be the same. Therefore, the reﬂecting point will generally be unique if
the reﬂecting surface is a ﬁxed surface. Even in a static case, i.e. the GPS antenna
does not move, the reﬂecting point R is a kinematic point, because of the movement
of the satellite. Different satellites generally have different reﬂecting points. These
points are independent if one does not take into account the a priori knowledge of
the reﬂecting surface.
For every observed satellite of every epoch there are three new coordinate
unknowns. A straightforward solution is mathematically impossible. However,
suppose the reﬂecting surface is a geoid or a known sea surface, and the latitude and
longitude of the reﬂecting point can be computed from the satellite position and the
known antenna position. Then the remaining unknown is just one parameter of
height. Suppose the reﬂecting surface needs to be determined only up to, say, a
resolution of 2 km. The height of every point located within the 1-km radius can
then be considered the same, and in this case, the GPS altimetry problem is clearly
solvable.
Fig. 5.14 Geometry of the
reﬂecting signal
118
Chapter 5  Physical Inﬂuences of GPS Surveying

The signal transmitting distance d can be described as
d ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxs  xrÞ2 þ ðys  yrÞ2 þ ðzs  zrÞ2
q
þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxk  xrÞ2 þ ðyk  yrÞ2 þ ðzk  zrÞ2
q
;
ð5:188Þ
where indices s, r, and k denote satellite, reﬂecting point, and downward-pointing
GPS antenna, respectively. Of course, the transmission time correction must also be
taken into account. Cartesian coordinates x, y, and z of the reﬂecting point can be
represented by geodetic coordinates φ, λ, and h. φ and λ of the reﬂecting point will
fulﬁl the following linear equation:
ðu  ukÞ ¼ ðk  kkÞ us  uk
ks  kk
:
ð5:189Þ
For any given φ between values φk and φs, a related λ can be obtained, and the
zero-height reﬂecting point in Cartesian coordinates can then be obtained. The
zenith distances of the downward-pointing GPS antenna and the GPS satellite in
relation to the reﬂecting point can be then computed. By using the criterion that
both zenith distances shall be the same, a best set of φ and λ can be found. Taking
the known coordinates of the zero-height reﬂecting point into account, there is just
one parameter of height remaining as an unknown in Eq. 5.188.
By reducing the resolution rate to every two epochs—suppose that within every
two epochs, the height of the reﬂecting point remained the same—the problem
including the receiver clock error and ambiguity can be solved with sufﬁcient
redundancy.
5.6.3
Image Point and Reﬂecting Surface Determination
An alternative method for determining the reﬂecting surface is proposed below.
The reﬂecting surface is considered a mirror, and the downward-pointing
antenna is an image point behind the mirror. If the reﬂecting surface is a plane, then
the image point positioning can be carried out using the same method as in kine-
matic positioning of the upward-looking antenna. The longitude and latitude of the
image point can typically be obtained from the results of the upward-looking
antenna;
therefore,
the
image
point
positioning
problem
has
just
one
coordinate-unknown height, and can be easily determined. Now one has two
heights: the height of the downward-pointing antenna, and the height of the image
point. The average value of these two heights is then the footprint height of the
downward-pointing antenna on the reﬂecting surface. The longitude and latitude of
the reﬂecting point can be determined using the method discussed in Sect. 5.6.2,
and in this way, the reﬂecting point can be determined.
5.6  Multipath Effects
119

However, the reﬂecting surface is usually not a plane; therefore, the
above-discussed image point positioning result is a kind of average height. For
convenience, we deﬁne the reﬂecting point, which has such an average height, as a
nominal reﬂecting point. The distances between the nominal reﬂecting point and the
satellite and downward-pointing antenna can be computed. Comparing the com-
puted value with the true signal transmission distance, the bias of heights of the real
reﬂecting point and the nominal reﬂecting point can be determined. In this way, the
reﬂecting surface can be calculated.
5.6.4
Research Activities in GPS Altimetry
As mentioned in Sect. 5.6.1, remote sensing of the sea surface with reﬂected GPS
signals was ﬁrst introduced in 1993, when Martin-Neira (1993) proposed the
concept of the PAssive Reﬂectometry and Interferometry System (PARIS), which
uses existing GPS signals for mesoscale ocean altimetry. Further discussion about
the potential use of GPS signals as ocean altimetry observables can be found in Wu
et al. (1997). During tests of a GPS-based vehicle tracking system, Auber et al.
(1994) reported multipath errors, especially when aircraft ﬂew at low altitudes
above the sea. Reﬂections from the sea surface were nearly as strong as the incident
signals and caused the GPS receiver to lock to the reﬂected signals, yielding false
positioning information. Thus, the ﬁrst documented GPS reﬂections were measured.
Since then, many theoretical and experimental studies have been carried out with
different receiver designs, at different observation heights and platforms. In this
section, research activities involving GPS altimetry will be brieﬂy introduced,
referring to Helm (2008).
GPS altimetry is one of the main research activities with the ﬁeld of GPS
reﬂectometry, which tries to achieve highly accurate height measurements com-
parable to accuracies of conventional radar altimetry (RA). Airborne campaigns
have been conducted (e.g., Garrison et al. 1998; Garrison and Katzberg 2000; Rius
et al. 2002) and reached a 5-cm height precision (Lowe et al. 2002b). The MEBEX
balloon experiment (Cardellach et al. 2003) was conducted in August 1999 in the
earth’s stratosphere. The experiment conﬁrms the feasibility of GPS reﬂectometry
from a height of about 37 km. Lowe et al. (2002a) observed the ﬁrst earth-reﬂected
GPS signal from space by analysing SIR-C data collected on board the space shuttle
during the Shuttle Radar Laboratory-2 mission in October 1994. Beyerle and Hocke
(2001) found evidence of earth-reﬂected GPS signals in GPS/MET and CHAMP
occultation data (Beyerle et al. 2002; Cardellach et al. 2004). While the CHAMP
and Satelite de Aplicaciones Cientiﬁcas C (SAC-C) satellites are already equipped
with
earth/nadir-looking
GPS
antennas,
work
is
under
way
to
establish
satellite-based GPS altimetry (Hajj and Zuffada 2003). In 2004, Gleason et al.
(2005)
recorded
waveforms
of
ocean-reﬂected
GPS
signals
that
were
120
Chapter 5  Physical Inﬂuences of GPS Surveying

experimentally detected on board the UK Disaster Monitoring Constellation
(UK-DMC) satellite.
The experimental demonstration of ground-based sea surface altimetry using
reﬂected GPS signals followed in 1997 with the BRIDGE experiment. Only the
C/A code was used for correlation, leading to an altimetric accuracy of about 3 m
(Martin-Neira et al. 2001). In 1998, Anderson (2000) placed GPS antennas about
10 m above the water surface and determined the water level and tides with
interferometric observations of GPS signals, with an accuracy of about 12 cm.
During the Crater Lake Experiment in October 1999, Treuhaft et al. (2001) were
able to obtain accuracy of 2-cm using GPS L1 carrier phase data. In the pond
experiment, Martin-Neira et al. (2002) reached accuracy of 1 cm. On a calm water
surface inside a harbour phase altimetry was possible with the Oceanpal instrument,
reaching an accuracy of about 3.1 cm (Soulat et al. 2006).
Various approaches have already been realised for using the former error source
“multipath”
as measurement quantity in GPS receiver design. A standard GPS
receiver, either for navigation or geodetic purposes, normally does not grant access
to the necessary information within the GPS signal. Access to the raw GPS signal is
required to recover the altimetric information. One approach (e.g., Garrison et al.
1998; Garrison and Katzberg 2000) is to record this data stream with high rate data
recorders. In a second step—in real-time or during post-processing—the data
stream is analysed and processed with software, giving the receiver type also the
name “software radio”. Fundamentals of GPS software receivers are described in
Tsui (2000). PC-based GPS civilian L1 software receivers, or so-called GPS radios,
have been developed by Akos et al. (2001), Kelley et al. (2002), Beyerle (2003),
Ledvina et al. (2003), Pany et al. (2004), and MacGougan et al. (2005), and have
been extended to dual-frequency civilian GPS software receivers (Ledvina et al.
2004). In order to obtain adequate gain from reﬂected GPS signals, research has
been done with multi-element digital beam-steered antenna arrays and High-gain
Advanced GPS Receivers (HAGRs) (Gold et al. 2005).
5.7
Anti-spooﬁng and Selective Availability Effects
Anti-spooﬁng
The function of anti-spooﬁng (AS)
of the GPS system is designed for an
anti-potential spoofer (or jammer). A spoofer generates a signal that mimics the
GPS signal and attempts to cause the receiver to track the wrong signal. When the
AS mode of operation is activated, the P code will be replaced with a secure Y code
available only to authorised users, and the unauthorised receiver becomes a single
L1 frequency receiver. AS has been tested frequently since 1 August 1992 and was
formally activated at 00:00 UT on 31 January 1994 and now is in continuous
operation on all Block II and later satellites.
5.6  Multipath Effects
121

The broadcasted ionospheric model (in the navigation message) may be used to
overcome the problem of absence of the dual frequencies, which were originally
implemented to eliminate the ionospheric effects. Of course, the method using the
ionospheric model cannot be as accurate as the method using dual-frequency data,
and consequently the precision is degraded. Carrier phase smoothed C/A code may
be used to replace the absence of the P code.
Selective Availability
Selective availability (SA) is a degradation of the GPS signal with the objective
of denying full position and velocity accuracy to unauthorised users by dithering
the satellite clock and manipulating the ephemerides. When SA is on, the funda-
ment frequency of the satellite clock is dithered such that the GPS measurements
are affected. The broadcast ephemerides are manipulated so that the computed orbit
will have slow variations. Several levels of SA effects are possible. SA is enabled
on Block II and later satellites (Graas and Braasch 1996).
Authorised users may recover the un-degraded data and exploit the full system
potential. To do so they must possess a key that allows them to decrypt correction
data transmitted in the navigation message (Georgiadou and Daucet 1990). For
high-precision users, IGS precise orbit and forecast orbit data may be used. Using
known positions (or monitor stations), the range corrections can be computed.
Differential GPS may also at least partially eliminate the SA effects.
SA has been switched off since May 2000.
5.8
Antenna Phase Centre Offset and Variation
Satellite Antenna Phase Centre Correction
The geometric distance between the satellite (at signal emission time) and the
receiver (at signal reception time) is, in fact, the distance between the phase centres
of the two antennas. However, the orbit data, which describes the position of the
satellite, usually refers to the mass centre of the satellite. Therefore, a phase centre
correction (also called mass centre correction) must be applied to the satellite
coordinates in precise applications.
A satellite ﬁxed coordinate system will be set up for describing the antenna
phase centre offset to the mass centre of the satellite. As shown in Fig. 5.15, the
origin of the frame coincides with the mass centre of the satellite, the z-axis is
parallel to the antenna pointing direction, the y-axis is parallel to the solar-panel
axis, and the x-axis is selected to complete the right-handed frame. A solar vector is
a vector from the satellite mass centre pointed to the sun. During the motion of the
satellite, the z-axis is always pointing to the earth, and the y-axis (solar-panel axis)
will be kept perpendicular to the solar vector. In other words, the y-axis is always
perpendicular to the plane formed by the sun, the earth, and the satellite. The solar
122
Chapter 5  Physical Inﬂuences of GPS Surveying

panel can be rotated around its axis to keep it perpendicular to the ray of the sun for
optimal collection of the solar energy. The solar angle β is deﬁned as the angle
between the z-axis and the solar identity vector ~nsun (see Fig. 5.16). Denoting the
identity vector of the satellite ﬁxed frame as ð~ex~ey~ezÞ, the solar identity vector can
then be represented as
~nsun ¼
sin b
0
cos b
ð
Þ:
ð5:190Þ
β is needed for computation of the solar radiation pressure in orbit determination.
Denoting~r as the geocentric satellite vector and~rs as the geocentric solar vector
(Fig. 5.17),
Fig. 5.15 Satellite ﬁxed
coordinate system
Fig. 5.16 The sun vector in
satellite ﬁxed frame
5.8  Antenna Phase Centre Offset and Variation
123

~r ¼
X
Y
Z
0
@
1
A;
~rS ¼
Xsun
Ysun
Zsun
0
@
1
A;
ð5:191Þ
then in a geocentric coordinate system, one has
~ez ¼  ~r
~rj j ;
ð5:192Þ
~ey ¼ ~ez ~nsun
~ez ~nsun
j
j ;
ð5:193Þ
~ex ¼~ey ~ez;
ð5:194Þ
~nsun ¼ ~rS ~r
~rS ~r
j
j ;
and
ð5:195Þ
cos b ¼ ~nsun ~ez;
ð5:196Þ
or
~ez ¼ 1
r
X
Y
Z
0
@
1
A;
r ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X2 þ Y2 þ Z2
p
;
ð5:197Þ
~nsun ¼ 1
R
Xsun  X
Ysun  Y
Zsun  Z
0
@
1
A;
ð5:198Þ
Fig. 5.17 The earth-sun
satellite vectors
124
Chapter 5  Physical Inﬂuences of GPS Surveying

~ey ¼ 1
S
YZsun  YsunZ
ZXsun  ZsunX
XYsun  XsunY
0
@
1
A;
and
ð5:199Þ
~ex ¼
1
S  r
ðZXsun  ZsunXÞZ  ðXYsun  XsunYÞY
ðXYsun  XsunYÞX  ðYZsun  YsunZÞZ
ðYZsun  YsunZÞY  ðZXsun  ZsunXÞX
0
@
1
A;
ð5:200Þ
where
R ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðXsun  XÞ2 þ ðYsun  YÞ2 þ ðZsun  ZÞ2
q
and
ð5:201Þ
S ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðYZsun  YsunZÞ2 þ ðZXsun  ZsunXÞ2 þ ðXYsun  XsunYÞ2
q
:
ð5:202Þ
Suppose the satellite antenna phase centre in the satellite ﬁxed frame is (x, y, z).
The offset vector in the geocentric frame can then be obtained by substituting
Eqs. 5.197, 5.199, and 5.200 into the following formula:
~d ¼ x~ex þ y~ey þ z~ez;
ð5:203Þ
which may be added to the vector ~r.
Beginning 5 November 2006, IGS has used different antenna phase centre
vectors even within the same GPS satellite block. An example of GPS satellite
antenna phase centre offsets in the satellite ﬁxed frame are given in Table 5.4.
The dependence of the phase centre on the signal direction and frequencies is not
considered for the satellite here. A mis-orientation of the~ey (~ex also) of the satellite
with respect to the sun may cause errors in the geometrical phase centre correction.
In the earth’s shadow (for up to 55 min), the mis-orientation becomes worse. The
geometrical mis-orientation may be modelled and estimated.
Receiver Antenna Phase Centre Correction
In the case of receiver antenna phase centre correction, the dependence of the
phase centre on the signal direction and frequencies has to be taken into account.
Both the phase centre offset and variation should be modelled. Generally, the phase
centre corrections can be obtained through careful calibration. Receiver antenna
phase centre offset is also antenna type dependent. For a GPS network, antenna
phase centre corrections are usually predetermined and listed in a table for use.
5.8  Antenna Phase Centre Offset and Variation
125

5.9
Instrumental Biases
The study of ionospheric effects using GPS observations indicates the existence of
instrumental biases (cf., e.g., Yuan and Ou 1999). These biases are systematic
errors, and are different from frequency to frequency and from code to phase
measurements. However, they are constant for a given frequency and given
Table 5.4 GPS satellite
antenna phase centre offset
Satellites of
PRN
x
y
z
Block I
0.2100
0.0
0.8540
Block II/IIA
0.2794
0.0
1.0259
Block IIR-A
11
0.0000
0.0
1.1413
13
0.0000
0.0
1.3895
14
0.0000
0.0
1.3454
16
0.0000
0.0
1.5064
18
0.0000
0.0
1.2909
20
0.0000
0.0
1.3436
21
0.0000
0.0
1.4054
28
0.0000
0.0
1.0428
Block IIR-B
2
0.0000
0.0
0.7786
19
0.0000
0.0
0.8496
22
0.0000
0.0
0.9058
23
0.0000
0.0
0.8082
Block IIR-M
4
0.0000
0.0
0.9656
5
0.0000
0.0
0.8226
7
0.0000
0.0
0.8529
12
0.0000
0.0
0.8408
15
0.0000
0.0
0.6811
17
0.0000
0.0
0.8271
29
0.0000
0.0
0.8571
31
0.0000
0.0
0.9714
Block IIF
1
0.3940
0.0
1.5613
3
0.3940
0.0
1.6000
6
0.3940
0.0
1.6000
8
0.3940
0.0
1.6000
9
0.3940
0.0
1.6000
10
0.3940
0.0
1.6000
24
0.3940
0.0
1.6000
25
0.3940
0.0
1.5973
26
0.3940
0.0
1.6000
27
0.3940
0.0
1.6000
30
0.3940
0.0
1.6000
32
0.3940
0.0
1.6000
126
Chapter 5  Physical Inﬂuences of GPS Surveying

observable type as well as a given instrument (receiver or GPS satellite). For code,
phase, and Doppler observable of receiver i, satellite j at working frequency k,
instrumental biases can be modelled as
dIcði; kÞ þ dJcðj; kÞ
dIpði; kÞ þ dJpðj; kÞ
dIdði; kÞ þ dJdðj; kÞ
and
ð5:204Þ
respectively, where indices c, p, and d denote the code, phase, and Doppler
observables. δI and δJ denote the instrumental biases of the GPS receiver and GPS
satellite. The separation of the instrumental biases and the ambiguities are possible
because the biases of the receiver and satellite are independent of each other,
whereas the ambiguity parameters are dependent on both the receiver and the
satellite. However, in modelling and solving the problem, the correlation between
the parameters must be carefully studied. Instrumental biases of one of the fre-
quencies and one of the channels are linearly correlated with the clock biases.
Without modelling of the instrumental biases, they may merge into the ambiguity
parameters such that the integer property of the ambiguities is destroyed.
References
Akos D, Hansson A, Normark P, Rosenlind C, Stahlberg A, Svensson F (2001) Real-time software
radio architectures for GPS receivers. GPS World, pages 28–33, July 2001.
Allan D, Weiss M (1980) Accurate time and frequency transfer during common-view of a GPS
satellite. In: Proceedings of 1980 IEEE frequency control symposium, Philadelphia, pp 334–
356
Andersen OB (1994) M,2, and S,2, ocean tide models for the North Atlantic Ocean and adjacent
seas from ERS-1 altimetry, Space at the service of our environment. In: Proceedings of the
second ERS-1 symposium, Hamburg, 11–14 October 1993, Vol. 2., January 1994, Noordwijk,
pp 789–794
Anderson K (2000) Determination of water level and tides using interferometric observations of
GPS signals. Journal of Atmospheric and Oceanic Technology, 17: 1118-1127
Ashby N, Spilker JJ (1996) Introduction to relativistic effects on the Global Positioning System.
In:Parkinson BW, Spilker JJ (eds) Global Positioning System: Theory and applications, Vol. I,
Chapter 18
Auber J, Bibaut A, Rigal J (1994) Characterization of multipath on land and sea at GPS
frequencies. In Proceedings of the 7th International Technical Meeting of the Satellite Division
of the Institute of Navigation, pages 1155–1171, Salt Lake City, UT; US, 20–23 September
1994.
Berg, H (1948) Allgemeine Meteorologie. Ferdinand Duemmler Verlag, Bohn
Bevis M, Businger S, Herring AT, et al. (1992) GPS meteorology: remote sensing of atmospheric
water vapor using the global positioning system. J Geophys Res 97(D14):15787–15801
Bevis M, Businger S, Chiswell S, et al. (1994) GPS meteorology: mapping zenith wet delays onto
precipitable water. J Appl Meteorol 33:379–386
Beyerle G (2003) Opengpsrec: An open source gps receiver. http://www.geocities.com/gbeyerle/
software/ download.html, July 2003.
5.9  Instrumental Biases
127

Beyerle G, Hocke K (2001) Observation and simulation of direct and reﬂected GPS signals in
radio occultation experiments. Geophys. Res. Lett., 28(9):1895–1898, 2001
Beyerle G, Hocke K, Wickert J, Schmidt T, Marquardt C, Reigber C (2002) GPS radio
occultations with CHAMP: A radio holographic analysis of GPS signal propagation in the
troposphere and surface reﬂections. J. Geophys. Res., 107(D24): ACL 27-1-ACL 27-14
Bilitza D (2001) International reference ionosphere 2000. Radio Science, 36(2): 261-275
Bilitza D, Altadill D, Zhang Y, et al. (2014) The international reference ionosphere 2012—a model
of international collaboration. J. Space Weather Space Clim., 4, A07
Bock O, Doerﬂinger E (2001) Atmospheric modeling in GPS data analysis for high accuracy
positioning. Phys Chem Earth 26(6–8):373–383
Boehm J, Niell A, Tregoning P, Schuh H (2006a) Global Mapping Function (GMF): A new
empirical mapping function based on numerical weather model data. Geophys. Res. Lett. 33
(7), L07304
Boehm J, Werl B, Schuh H (2006b) Troposphere mapping functions for GPS and very long
baseline interferometry from European Centre for Medium-Range Weather Forecasts
operational analysis data. J. Geophys. Res. 111, B02406
Boehm J, Heinkelmann R, Schuh H (2007) Short Note: A global model of pressure and
temperature for geodetic applications. J. Geodesy 81(10), 679-683
Box G, Jenkins G, Reinsel G (1994) Time Series Analysis, Forecasting and Control, 3rd Edition.
Prentice Hall, Englewood Clifs
Braasch MS (1996) Multipath effects. Parkinson BW, Spilker JJ (eds) Global Positioning System:
Theory and applications, Vol. I
Cardellach E, Rufﬁni G, Pino D, Rius A, Komjathy A, Garrison J (2003) Mediterranean ballon
experiment: ocean wind speed sensing from the stratosphere, using GPS reﬂections. Remote
Sensing of Environment, 88(3): 351-362
Cardellach E, Ao C, Torre Juarez M, Hajj G (2004) Carrier phase delay altimetry with
GPS-reﬂection / occultation interferometry from low Earth orbiters. Geophys. Res. Lett., 31
(L10402)
Choy S, Wang CS, Yeh TK, Dawson J, Jia M, Kuleshov Y (2015) Precipitable water vapor
estimates in the Australian region from ground-based GPS observations. Advances in
Meteorology 2015, 956481
Collins J, Langley R (1997) Estimating the residual tropospheric delay for airborne differential
GPS positioning. In: Proceedings of ION GPS-97, Kansas City, Mo., pp. 1197–1206
Dach R, Beutler G, Hugentobler U, Schaer S, Schildknecht T, Springer T, Dudle G, Prost L (2003)
Time transfer using GPS carrier phase: error propagation and results. J Geodesy 77:1–14
Dach R, Hugentobler U, Fridez P, Meindl M (2007) Bernese GPS software version 5.0 user
manual. Astronomical Institute University of Bern, Bern
Davis J, Herring T (1984) New atmospheric mapping function. Center of Astrophysics,
Cambridge, Mass., Manuscript July 1984
Davis JL, Herring TA, Shapiro II, Rogers AEE, Elgered G (1985) Geodesy by radio
interferometry: effects of atmosphericmodeling errors on estimates of baseline length. Radio
Sci 20:1593–1607
Deng J (1987) The Primary Methods of Grey System Theory. Huazhong University of Science and
Technology (HUST) Press. Wuhan, China
Ding JC (2009) GPS meteorology and its applications. China Meteorological Press, Beijing, pp 1–
10
Doodson AT (1928) The analysis of tidal observations. Philos Tr R Soc S-A 227:223–279
Dow JM, Neilan RE, Rizos C (2009) The International GNSS service in a changing landscape of
global navigation satellite systems. J Geodesy 83(3–4):191–198
Farrell WE (1972) Deformation of the Earth by surface loads. Rev Geophys Space Ge 10(3):761–
797
Garrison JL, Katzberg SJ (2000) The application of reﬂected GPS signals to ocean remote sensing.
Remote Sens Environ 73(2):175–187
128
Chapter 5  Physical Inﬂuences of GPS Surveying

Garrison JL, Katzberg SJ, Hill M (1998) Effect of sea roughness on bistatically scattered range
coded signals from the global positioning system. Geophys. Res. Lett., 25(13):2257–2260
Georgiadou Y, Doucet KD (1990) The issue of selective availability. GPS World 1(5):53–56
Gleason S, Hodgart S, Sun Y, Gommenginger C, Mackin S, Adjrad M, Unwin M (2005) Detection
and processing of bistatically reﬂected GPS signals from low earth orbit for the purpose of
ocean remote sensing. IEEE Trans. Geosci. and Remote Sensing, 43(6): 1229-1241
Gold K, Brown A, Stolk K (2005) Bistatic sensing and multipath mitigation with a 109-element
GPS antenna array and digital beam steering receiver. In ION National Technical Meeting, San
Diego, CA, January 2005.
Graas FV, Braasch MS (1996) Selective availability. In: Parkinson BW, Spilker JJ (eds) Global
Position-ing System: Theory and applications, Vol. I, Chapter 17
Gu XP (2004) Research on retrieval of GPS water vapor and method of rainfall forecast. Doctorial
dissertation, China Agricultural University pp 1–15
Gu XP, Wang CY, Wu DX (2005) Research on the local algorithm for weighted atmospheric
temperature used inGPSremote sensingwater vapor. Sci Metero Sin 25(1):79–83
Hajj G, Zuffada C (2003) Theoretical description of a bistatic system for ocean altimetry using the
GPS signal. Radio Sci., 38(5)
Helm A (2008) Ground-based GPS altimetry with the L1 OpenGPS receiver using carrier
phase-delay observations of reﬂected GPS signals. Scientiﬁc Technical Report STR 08/10.
DOI:10.2312/GFZ.b103-08104.
Herring T (1992) Modeling atmospheric delays in the analysis of space geodetic data. In: J., M.,
T., S., (Eds.). Netherlands Geodetic Commision. Delft, pp. 157-164
Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997, 2001) GPS theory and practice.
Springer-Press, Wien
Holdridge DB (1967) An alternate expression for light time using general relativity. JPL Space
Pro-gram Summary 37–48, III, pp 2–4
Hopﬁeld HS (1969) Two-quartic tropospheric refractivity proﬁle for correcting satellite data.
J Geophys Res 74(18):4487–4499
Hopﬁeld HS (1970) Tropospheric effect on electromagnetically measured ranges: Prediction from
surface weather data. Applied Physics Laboratory, Johns Hopkins University, Baltimore, MD,
July 1970
Hopﬁeld HS (1972) Tropospheric range error parameters – further studies. Applied Physics
Labora-tory, Johns Hopkins University, Baltimore, MD, June 1972
Huang G (2012) Research on Algorithms of Precise Clock Offset and Quality Evaluation of GNSS
Satellite clock. Chang’an University. Xi’an, China
Jakowski N, Hoque MM, Mayer C (2011) A new global TEC model for estimating
transionospheric radio wave progation errors. Journal of Geodesy, 85: 965-974
Katzberg SJ, Garrison JL (1996) Utilizing GPS to determine ionospheric delay over the ocean.
NASA Technical Mernorandum TM-4750, NASA Langley Research Center
Kaula WM (1966, 2001) Theory of satellite geodesy. Blaisdell Publishing Company, Dover
Publications, New York
Kelley C, Barnes J, Cheng J (2002) Open Source GPS: Open source software for learning about
GPS. In ION GPS 2002, pages 2524–2533, Portland, USA, September 2002.
Khan SA (1999) Ocean loading tide effects on GPS positioning. MSc. thesis, Copenhagen
University
Klobuchar JA (1996) Ionospheric effects on GPS. In: Parkinson BW, Spilker JJ (eds) Global
Position-ing System: Theory and applications, Vol. I, Chapter 12
Klobuchar J A (1987) Ionospheric time-delay algorithm for single-frequency GPS users.
Aerospace and Electronic Systems, IEEE Transactions on, (3): 325-331
Knudsen P, Olsen H, Xu G (1999) GPS-altimetry tests – Measuring GPS signal reﬂected from the
Earth surface. Poster on the 22st IUGG General Assembly, IAG Symposium, England
Komjathy A (1997) Global ionospheric total electron content mapping using the Global
Positioning System. University of New Brunswick, Fredericton, New Brunswick, Canada
References
129

Komjathy A, Garrison J, Zavorotny V (1999) GPS: A new tool for ocean science. GPS World 10
(4):50–56
Kosaka M (1987) Evaluation method of polynomial models’ prediction performance for random
clock error. Journal of Guidance, Control, and Dynamics 10(6): 523-527
Kouba J (2009) Testing of global pressure/temperature (GPT) model and global mapping function
(GMF) in GPS analyses. J. Geodesy 83(3-4), 199-208
Lagler K, Schindelegger M, Bohm J, Krasna H, Nilsson T (2013) GPT2: Empirical slant delay
model for radio space geodetic techniques. Geophys. Res. Lett. 40(6), 1069-1073
Lambeck K (1988) Geophysical geodesy – The slow deformations of the Earth. Oxford Science
Publications
Langley RB (1998a) Propagation of the GPS signals. In: Kleusberg A, Teunissen PJG (eds) GPS
for geodesy. Springer-Verlag, Berlin
Langley RB (1998b) GPS receivers and the observables. In: Kleusberg A, Teunissen PJG
(eds) GPS for geodesy. Springer-Verlag, Berlin
Ledvina B, Psiaki M, Powell S, Kintner P (2003) A 12-channel real-time GPS L1 software
receiver. In Proc. of the Institute of Navigation National Technical Meeting, Anaheim, CA,
January 22-24, 2003.
Ledvina B, Psiaki M, Sheinfeld D, Cerruti A, Powell S, Kintner P (2004) A real-time GPS civilian
L1/L2 software receiver. In Proc. of the Institute of Navigation GNSS, Long Beach, CA,
September 21–24 2004.
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York
Leick A (2004) GPS Satellite Surveying (3rd ed.) xxiv + 664 p. John Wiley, New York, NY
Lesage P, Ayi T (1984) Characterization of frequency stability: analysis of the modiﬁed allan
variance and properties of its estimate. IEEE Trans Instrum Measure IM-33(4):332–336
Li JG, Mao JT, Li CC (1999) The approach to remote sensing of water vapor based on GPS and
linear regression Tm in eastern region of China. Acta Meteor Sin 57(3):283–292
Li GP, Huang GF, Liu BQ (2006) Experiment on driving precipitable water vapor form
ground-basedGPS network inChengdu Plain. Geomat Inf Sci 31(12):1086–1089
Liu M, Yang Y, Stein S, Zhu S, Engeln J (2000) Crustal shortening in the Andes: Why do GPS
rate differ from geological rates? Geophys Res Lett 27(18):3005–3008
Lowe S, LaBrecque J, Zuffada C, Romans L, Young L, Hajj G (2002a) First spaceborne
observation of an earth reﬂected GPS signal. Radio Sci., 37(1)
Lowe S, Zuffada C, Chao Y, Kroger P, Young J (2002b) 5-cm-precision aircraft ocean altimetry
using GPS reﬂections. Geophys. Res. Lett., 29(10)
Lv YP, Yin HT, Huang DF (2008) Modeling of weighted mean atmospheric temperature and
application in GPS/PWV of Chengdu region. Sci Survey Mapp 33(4):103–105
MacGougan G, Normark P-L, Ståhlberg C (2005) Satellite navigation evolution. The software
GNSS receiver. GPS World 16(1): 48-52
MacMillan D, Ma C (1994) Evaluation of very long baseline interferometry atmospheric modeling
improvements. J. Geophys. Res. 99(B1), 637-651
Mannucci A J, Wilson B D, Yuan D N, et al. (1998) A global mapping technique for GPS—
derived ionospheric total electron content measurements. Radio Science 33(3): 565–582
Mao JT (2006) Research of remote sensing of atmospheric water vapor using Global Positioning
System (GPS). Doctorial dissertation, Beijing University pp 1–5
Martin-Neira M (1993) A passive reﬂectometry and interferometry system (PARIS): Application
to ocean altimetry. ESA Journal, 17:331–355
Martin-Neira M, Caparrini M, Font-Rossello J, Lannelongue S, Serra C (2001) The paris concept:
An experimental demonstration of sea surface altimetry using GPS reﬂected signals. IEEE
Trans. Geosci. and Remote Sensing, 39:142–150
Martin-Neira M, Colmenarejo P, Rufﬁni G, Serra C (2002) Altimetry precision of 1 cm over a
pond using the wide-lane carrier phase of gps reﬂected signals. Ca. J. Remote Sensing, 28(3):
pp. 394–403
McCarthy DD (1996) International Earth Rotation Service. IERS conventions, Paris, 95 pp. IERS
Technical Note No. 21
130
Chapter 5  Physical Inﬂuences of GPS Surveying

Melchior P (1978) The tides of the planet Earth. Pergamon Press
Mendes V, Langley R (1998) Tropospheric zenith delay prediction accuracy for airborne GPS
high-precision positioning, Proceedings of ION 54th Annual Meeting, Denver, Colorado,
pp. 337–348
Nava B, Coïsson P, Radicella S M (2008) A new version of the NeQuick ionosphere electron
density model. Journal of Atmospheric and Solar-Terrestrial Physics, 70(15): 1856-1862
Niell AE (1996) Global mapping functions for the atmosphere delay at radio wavelengths.
J. Geophys. Res. 101(B2), 3227-3246
Otsuka Y, Ogawa T, Saito A, Tsugawa T, et al. (2002) A new technique for mapping of total
electron content using GPS network in Japan. Earth Planets Space 54: 63-70
Pany T, Eisfeller B, Hein G, Moon S, Sanroma D (2004) ipexSR: A PC based software GNSS
receiver completely developed in Europe. In Europeen Navigation Conference GNSS 2004,
Rotterdam, May 2004.
Percival D (2006) Spectral Analysis of Clock Noise: A Primer. Metrologia 43(4): S299-S310
Petrie EJ, Hernández-Pajares M, Spalla P, et al. (2011) A review of higher order ionospheric
refraction effects on dual frequency GPS. Surveys in Geophysics, 32(3): 197-253
Poutanen M, Vermeer M, Maekinen J (1996) The permanent tide in GPS positioning. J Geodesy
70: 499–504
Ray J, Senior K (2005) Geodetic techniques for time and frequency comparisons using GPS phase
and code measurements. Metrologia 42(3):215–232
Rius A, Aparicio J, Cardellach E, Martin-Neira M, Chapron B (2002) Sea surface state measured
using GPS reﬂected signals. Geophys. Res. Lett., 29(23): 371-374
Rocken C, Ware R,VanHove T, Solheim F, Alber C, Johnson J, Bevis M, Businger S (1993)
Sensing atmospheric water vapor with the global positioning system. Geophys Res Lett 20
(23):2631–2634
Ross RJ, Rosenfeld S (1997) Estimating mean weighted temperature of the atmosphere for Global
Positioning System. J Geophys Res 102(18):21719–21730
Saastamoinen J (1972) Contribution to the theory of atmospheric refraction. B Geod 105–106
Saastamoinen J (1973) Contribution to the theory of atmospheric refraction. B Geod 107
Schaer S (1999) Mapping and predicting the earth’s ionosphere using the global positioning
system. Astronomical Institute, University of Berne, Switzerland
Schwiderski EW (1978) Global ocean tide, I. A detailed hydrodynamical interpolation model.
Rep. NSWC/DL TR 3866, Nav. Surf. Weapons Cent. Dahlgren, Va.
Schwiderski EW (1979) Ocean tide, II. The semidiurnal principal lunar tide (M2). Rep. NSWC TR
79–414, Nav. Surf. Weapons Cent. Dahlgren, Va.
Schwiderski EW (1980) On charting global ocean tide. Rev Geophys 18:243–268
Schwiderski
EW
(1981a)
Ocean
tide,
III.
The
semidiurnal
principal
solar
tide
(S2).
Rep. NSWC TR 81–122, Nav. Surf. Weapons Cent. Dahlgren, Va.
Schwiderski EW (1981b) Ocean tide, IV. The diurnal luni-solar declination tide (K1),
Rep. NSWC TR 81–142, Nav. Surf. Weapons Cent. Dahlgren, Va.
Schwiderski EW (1981c) Ocean tide, V. The diurnal principal lunar tide (O1). Rep. NSWC TR
81–144, Nav. Surf. Weapons Cent. Dahlgren, Va.
Seeber G (1993) Satelliten-Geodaesie. Walter de Gruyter 1989
Soulat F, Caparrini M, Farres E, Dunne S, Chapron B, Buck C, Rufﬁni G (2006) Oceanpal
experimental campaigns. Proceedings of the GNSSR’06 workshop, ESTEC, Noordwijk, the
Netherlands, 14-15 June 2006.
Syndergaard S (1999) Retrieval analysis and methodologies in atmospheric limb sounding using
the GNSS radio occultation technique. Dissertation, Niels Bohr Institute for Astronomy,
Physics and Geophysics, Faculty of Science, University of Copenhagen
Torge W (1991) Geodesy. Walter de Gruyter, Berlin
Tregoning P, Herring TA (2006) Impact of a priori zenith hydrostatic delay errors on GPS
estimates of station heights and zenith total delays. Geophys. Res. Lett. 33, L23303
Treuhaft R, Lowe S, Zuffada C, Chao Y (2001) 2-cm GPS altimetry over Crater Lake. Geophys.
Res. Lett., 22(23):4343–4346
References
131

Tsui J (2000) Fundamentals of Global Positioning System Receivers: A Software Approach,
volume ISBN: 0-471-38154-3. John Wiley & Sons, Inc., 1 edition, May 2000.
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese)
Wang JH, Zhang LY, Dai AG, Van Hove T, Van Baelen J (2007a) A near-global, 2-hourly data set
of atmosoheric precipitable water from ground-based GPS measurements. J Geophys Res 112,
D11107
Wang Y, Liu LT, Hao XG et al (2007b) The application study of the GPS meteorology network in
wuhan region. Acta Geodaet Cartogr Sinica 36(2):141–145
Wang Q, Xu T, Xu G (2010) HALO_GPS (High Altitude and Long Range Airborne GPS
Positioning Software) – Software User Manual, Scientiﬁc Technical Report, German Research
Centre for Geosciences, 2010, ISSN: 1610-0956
Wang Q, Xu T, Xu G (2011) Adaptively Changing Reference Station Algorithm and Its
Application in GPS Long Range Airborne Kinematic Relative Positioning. Acta Geodaetica et
Cartographica Sinica, 40(4): 429-434
Wanninger L (1997) Real-time differential GPS error modeling in regional reference station
networks. In: Proc. 1997 IAG Symposium, 86–92, Rio de Janeiro, Brazil
Wu S, Meehan T, Young L (1997) The potential use of GPS signals as ocean altimetry
observables. 1997 national technical meeting, Santa Monica, California, January 1997.
Xu G (2000) A concept of precise kinematic positioning and ﬂight-state monitoring from the
AGMASCO practice. Earth Planets Space 52(10):831–836
Xu G (2003) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English
Xu G, Knudsen P (2000) Earth tide effects on kinematic/static GPS positioning in Denmark and
Greenland. Phys Chem Earth 25(A4):409–414
Xu T, Yang Y. (2001) The hypothesis testing of scale parameter in coordinate transformation
model. Geomatics and Information Science of Wuhan University, 26, 70–74
Yao YB, Zhu S, Yue SQ (2012) A globally applicable, seasonspeciﬁc model for estimating the
weighted mean temperature of the atmosphere. J Geod 86:1125–1135
Yao YB, Zhang B, Yue SQ, Xu CQ, Peng WF (2013) Global empirical model for mapping zenith
wet delays onto precipitable water. J Geod 87: 439-448
Yeh TK, Hwang C, Xu G (2008) GPS height and gravity variations due to ocean tidal loading
around Taiwan. Surv Geophys 29(1):37–50
Yeh TK, Hwang C, Xu G, Wang CS, Lee CC (2009) Determination of global positioning system
(GPS) receiver clock errors: impact on positioning accuracy. Meas Sci Technol 20:075105
Yeh TK, Chen CH, Xu G, Wang CS, Chen KH (2012) The impact on the positioning accuracy of
the frequency reference of a GPS receiver. Surv Geophys 34: 73-87
Yeh TK, Hong JS, Wang CS, Hsiao TY, Fong CT (2014) Applying the water vapor radiometer to
verify the precipitable water vapor measured by GPS. Terr. Atmos. Ocean. Sci. 25: 189-201
Yuan YB, Ou JK (1999) The effects of instrumental bias in GPS observations on determining
ionospheric delays and the methods of its calibration. Acta Geod Cartogr Sinica 28(2)
Zhang J, Lachapelle G (2001) Precise estimation of residual tropospheric delays using a regional
GPS network for real-time kinematic applications. Journal of Geodesy 75, 255–266
Zhu SY (2001) Private communication and the source code of the EPOS-OC software
Zhu SY, Reigber Ch, Massmann FH (1996) The German PAF for ERS, ERS standards used at
D-PAF. D-PAF/GFZ ERS-D-STD-31101
132
Chapter 5  Physical Inﬂuences of GPS Surveying

Chapter 6
GPS Observation Equations
and Equivalence Properties
In this chapter, we begin with a discussion of the general mathematical model of
GPS observation and its linearisation. All partial derivatives of the observation
function are given in detail. These are necessary for forming GPS observation
equations. We then outline the linear transformation and covariance propagation. In
the section on data combinations, we discuss all meaningful and useful data
combinations, such as ionosphere-free, geometry-free, code–phase combinations,
and ionospheric residuals, as well as differential Doppler and Doppler integration.
In the data differentiation section, we discuss single, double, and triple differences
and their related observation equations and weight propagation. The parameters in
the equations are greatly reduced through difference forming; however, the
covariance derivations are tedious. In the last two sections, we discuss the equiv-
alent properties between the uncombined and combining and the undifferenced and
differencing algorithms. We propose a uniﬁed GPS data processing method, which
is described in detail. The method is selectively equivalent to the zero-, single-,
double-, triple-, and user-deﬁned differential methods.
6.1
General Mathematical Models of GPS Observations
Recalling the discussions in Chap. 4, the GPS code pseudorange, carrier phase, and
Doppler observables are formulated as (cf. Eqs. 4.7, 4.18 and 4.23)
Rk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ dion þ dtrop þ dtide þ drel þ ec;
ð6:1Þ
kUk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ kNk
i  dion þ dtrop þ dtide þ drel þ ep; and
ð6:2Þ
D ¼ dqk
i ðtr; teÞ
kdt
 f dðdtr  dtkÞ
dt
þ drel
f þ ed;
ð6:3Þ
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_6
133

Where ionospheric effects can be approximated as (cf. Sect. 5.1.2, Eq. 5.26)
dion ¼ A1
f 2 þ A2
f 3 ;
and R is the observed pseudorange, Φ is the observed phase, D is Doppler mea-
surement, te denotes the GPS signal emission time of the satellite k, tr denotes the
GPS signal reception time of the receiver i, c denotes the speed of light, subscript
i and superscript k denote the receiver and satellite, and δtr and δtk denote the clock
errors of the receiver and satellite at the time tr and te, respectively. The terms δion,
δtrop, δtide, and δrel denote the ionospheric, tropospheric, tidal, and relativistic
effects, respectively. Tidal effects include earth tides and ocean tidal loading. The
multipath effect was discussed in Sect. 5.6 and is omitted here. εc, εp. and εd are the
remaining errors, respectively. f is the frequency, wavelength is denoted by λ, A1,
and A2 are ionospheric parameters, Nk
i is the ambiguity related to receiver i and
satellite k, δrel_f is the frequency correction of the relativistic effects, the qk
i is the
geometric distance, and (cf. Eq. 4.6)
qk
i ðtr; teÞ ¼ qk
i ðtrÞ þ dqk
i ðtrÞ
dt
Dt;
ð6:4Þ
where Δt denotes the signal transmitting time and Dt ¼ tr  te: dqk
i ðtrÞ=dt denotes
the time derivation of the radial distance between the satellite and receiver at time tr.
All terms in Eqs. 6.1 and 6.2 have units of length (metres).
Considering Eq. 6.4 in the ECEF coordinate system, the geometric distance is a
function of station state vector ðxi; yi; zi; _xi; _yi; _ziiÞ (denoted by Xi) and satellite state
vector ðxk; yk; zk; _xk; _yk; _zkÞ (denoted by Xk). GPS observation Eqs. 6.1, 6.2, and 6.3
can then be generally presented as
O ¼ FðXi; Xk; dti; dtk; dion; dtrop; dtide; drel; Nk
i ; drel
f Þ;
ð6:5Þ
where O denotes observation and F denotes implicit function. In other words, the
GPS observable is a function of state vectors of the station and satellite, and
numbers of physical effects as well as ambiguity parameters. In principle, GPS
observations can be used to solve for the desired parameters of the function in
Eq. 6.5. This is why GPS is now widely used for positioning and navigation (to
determine the state vector of the station), orbit determination (to determine the state
vector of satellite), timing (to synchronise clocks), meteorological applications (i.e.
tropospheric proﬁling), and ionospheric occultation (i.e. ionospheric sounding). In
turn, the satellite orbit is a function of the earth’s gravitational ﬁeld and the number
of disturbing effects such as solar radiation pressure and atmospheric drag. GPS is
now also used for gravity ﬁeld mapping and for solar and earth system study.
It is obvious that Eq. 6.5 is non-linear. The straightforward mathematical
method for solving problem 6.5 is to search for the optimal solution using various
effective search algorithms. The so-called ambiguity function (AF, see Sects. 8.5
134
Chapter 6  GPS Observation Equations and Equivalence Properties

and 12.2) method is an example. Generally speaking, solving a non-linear problem
is much more complicated than ﬁrst linearising the problem and then solving the
linearised problem.
It is worth noting that the satellite and station state vectors will be represented in
the same coordinate system; otherwise, coordinate transformation, as discussed in
Chap. 2, will be carried out. Because the rotations are “distance-keeping” trans-
formations, the distances computed in two different coordinate systems must be the
same. However, because of the earth’s rotation, the velocities expressed in the ECI
and ECEF coordinate systems are not the same. Generally, the station coordinates
and both the ionospheric and tropospheric effects are given and presented in the
ECEF system. A satellite state vector may be given in both the ECSF and ECEF
systems, depending on the need of the speciﬁc application.
6.2
Linearisation of the Observation Model
The non-linear multivariable function F in Eq. 6.5 can be further generalised as
O ¼ FðYÞ ¼ Fðy1; y2; . . .; ynÞ;
ð6:6Þ
where variable vector Y has n elements. The linearisation is accomplished by
expanding the function in a Taylor series to the ﬁrst order (linear term) as
O ¼ FðY0Þ þ @FðYÞ
@Y

Y0dY þ eðdYÞ;
ð6:7Þ
where
@FðYÞ
@Y
¼
@F
@y1
@F
@y2
. . .
@F
@yn


;
and
dY ¼ Y  Y0


¼
dy1
dy2
...
dyn
0
B
B
B
@
1
C
C
C
A;
the symboljy0 means that the partial derivative ∂F(Y)/∂Y takes the value of Y = Y0
and ε is the truncation error, which is a function of the second-order partial derivative
and dY. Y0 is called the initial value vector. Equation 6.7 turns out then to be
OC ¼
@F
@y1
@F
@y2
  
@F
@yn


Y0
dy1
dy2
..
.
dyn
0
B
B
B
@
1
C
C
C
A þ e;
ð6:8Þ
6.1  General Mathematical Models of GPS Observations
135

where F(Y0) is denoted by C (or say, the computed value). So GPS observation
Eq. 6.6 is linearised as a linear equation (Eq. 6.8). Denoting the observation and
truncation errors as v and O–C as l, partial derivative (∂F/∂yj)jy0 = aj, then Eq. 6.8
can be written as
li ¼
ai1
ai2
. . .
ain
ð
Þ 
dy1
dy2
..
.
dyn
0
B
B
B
@
1
C
C
C
A þ vi;
ði ¼ 1; 2; . . .; mÞ;
ð6:9Þ
where l is also often called “observable” in adjustment or O–C (observed minus
computed), and j and i are indices of unknowns and the observations. Equation 6.9
is a linear error equation. A set of GPS observables then forms a linear error
equation system:
l1
l2
..
.
lm
0
B
B
B
@
1
C
C
C
A ¼
a11
a12
. . .
a1n
a21
a22
. . .
a2n
..
.
..
.
..
.
..
.
am1
am2
. . .
amn
0
B
B
B
@
1
C
C
C
A 
dy1
dy2
..
.
dyn
0
B
B
B
@
1
C
C
C
A þ
v1
v2
..
.
vm
0
B
B
B
@
1
C
C
C
A;
or in matrix form (dY is denoted by X)
L ¼ AX þ V;
ð6:10Þ
where m is the observable number. A number of adjustment and ﬁltering methods
(cf. Chap. 7) can be applied for solving GPS problem 6.10. The solved parameter
vector is X (or dY). The original unknown vector Y can be obtained by adding dY to
Y0. V is the residual vector. Statistically, V is assumed to be a random vector, and is
normally distributed with zero expectation and variance var(V). To characterise the
different qualities and correlation situations of the observables, a so-called weight
matrix P is introduced to Eq. 6.10. Supposing all observations are linearly inde-
pendent or uncorrelated, the covariance of observable vector L is
QLL ¼ covðLÞ ¼ r2E
ð6:11Þ
or
P ¼ Q1
LL ¼ 1
r2 E;
ð6:12Þ
where E is an identity matrix of dimension m × m, superscript −1 is an inversion
operator, and cov(L) is the covariance of L.
Generally, the linearisation process is considered to have been done well only
when the solved unknown vector dY is sufﬁciently small. Therefore, the initial
vector Y0 must be carefully given. In cases in which the initial vector is not well
known or not well given, the linearisation process must be repeated. In other words,
136
Chapter 6  GPS Observation Equations and Equivalence Properties

the initial vector that is not well known must be modiﬁed by the solved vector dY,
and the linearisation process must be repeated until dY converges. If X = 0, then
L = V; therefore, the “observable” vector L is sometimes also called a residual
vector. If the initial vector Y0 is well known or well given, then the residual vector
V can also be used as a criterion to judge the “goodness or badness” of the original
observable vector. This property is used in robust Kalman ﬁltering to adjust the
weight of the observable (cf. Chap. 7).
6.3
Partial Derivatives of Observation Function
Partial Derivatives of Geometric Path Distance with Respect to the State Vector
ðxi; yi; zi; _xi; _yi; _ziÞ of the GPS Receiver
The signal transmitting path is described by (cf. Eqs. 4.3 and 4.6 in Chap. 4)
qk
i ðtr; teÞ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxkðteÞ  xiÞ2 þ ðykðteÞ  yiÞ2 þ ðzkðteÞ  ziÞ2
q
;
and
ð6:13Þ
qk
i ðtr; teÞ  qk
i ðtr; trÞ þ dqk
i ðtr; trÞ
dt
Dt;
ð6:14Þ
where index k denotes the satellite, and the satellite coordinates are related to the
signal emission time te, i denotes the station, and station coordinates are related to
the signal reception time tr, Δt = te −tr. Then one has
dqk
i ðtr; trÞ
dt
¼
1
qk
i ðtr; trÞ
 ðxk  xiÞð_xk  _xiÞ
ðyk  yiÞð_yk  _yiÞ
ðzk  ziÞð_zk  _ziÞ
ð
Þ;
ð6:15Þ
where the satellite state vector is related to the time tr, and
@qk
i ðtr; teÞ
@ðxi; yi; ziÞ ¼
1
qk
i ðtr; teÞ xk  xi
yk  yi
zk  zi
ð
Þ;
ð6:16Þ
@qk
i ðtr; teÞ
@ð_xi; _yi; _ziÞ ¼
Dt
qk
i ðtr; trÞ xk  xi
yk  yi
zk  zi
ð
Þ:
ð6:17Þ
Partial Derivatives of Geometric Path Distance with Respect to the State Vector
ðxk; yk; zk; _xk; _yk; _zkÞ of the GPS Satellite
6.2  Linearisation of the Observation Model
137

Similar to above, one has
@qk
i ðtr; teÞ
@ðxk; yk; zkÞ ¼
1
qk
i ðtr; teÞ xk  xi
yk  yi
zk  zi
ð
Þ;
ð6:18Þ
@qk
i ðtr; teÞ
@ð_xk; _yk; _zkÞ ¼
Dt
qk
i ðtr; trÞ xk  xi
yk  yi
zk  zi
ð
Þ:
ð6:19Þ
Partial Derivatives of the Doppler Observable with Respect to the Velocity Vector
of the Station
The time differentiation of the geometric signal path distance can be derived as
dqk
i ðtr; teÞ
dt
¼
1
qk
i ðtr; teÞ
ðxkðteÞ  xiÞð_xkðteÞ  _xiÞ þ ðykðteÞ  yiÞð_ykðteÞ  _yiÞ þ ðzkðteÞ  ziÞð_zkðteÞ  _ziÞ
ð
Þ;
ð6:20Þ
then one has
@ðdqk
i ðtr; teÞ=dtÞ
@ð_xi; _yi; _ziÞ
¼
1
qk
i ðtr; teÞ xkðteÞ  xi
ykðteÞ  yi
zkðteÞ  zi
ð
Þ:
ð6:21Þ
Partial Derivatives of Clock Errors with Respect to the Clock Parameters
If the clock errors are modelled by Eq. 5.163 (cf. Sect. 5.5)
dti ¼ bi þ dit þ eit2;
dtk ¼ bk þ dkt þ ekt2;
ð6:22Þ
where i and k are the indices of the clock error parameters of the receiver and
satellite, then one has
@dti
@ bi; di; ei
ð
Þ ¼
1
t
t2


and
@dtk
@ bk; dk; ek
ð
Þ ¼
1
t
t2


:
ð6:23Þ
If the clock errors are modelled by Eq. 5.164 (cf. Sect. 5.5)
dti ¼ bi;
dtk ¼ bk;
ð6:24Þ
138
Chapter 6  GPS Observation Equations and Equivalence Properties

then
@dti
@bi
¼ 1;
@dtk
@bk
¼ 1:
ð6:25Þ
The above derivatives are valid for both the code and phase observable equa-
tions. For the Doppler observable, denote (cf. Eq. 6.3)
dclock ¼ f dðdti  dtkÞ
dt
;
ð6:26Þ
then for the clock error model of Eq. 6.22 one has
@dclock
@ðdi; eiÞ ¼
1
2t
ð
Þf
and
@dclock
@ðdk; ekÞ ¼
1
2t
ð
Þf :
ð6:27Þ
Partial Derivatives of Tropospheric Effects with Respect to the Tropospheric
Parameters
If the tropospheric effects can be modelled by (cf. Sect. 5.2)
I :
dtrop ¼ fpdq
and
II :
dtrop ¼ fzdq
F
þ fadq
Fc
;
ð6:28Þ
where dρ is the tropospheric effect computed by using the standard tropospheric
model, fp, fz, fa are parameters of the tropospheric delay in path, zenith, azimuth
directions, and F and Fc are the mapping and co-mapping functions discussed in
Sect. 5.2. The derivatives with respect to the parameters fp, fz, fa are then
I :
@dtrop
@fp
¼ dq
and
II :
@dtrop
@ðfz; faÞ ¼
dq
dq
F
Fc

	
:
ð6:29Þ
Furthermore, if the tropospheric parameters are deﬁned as a step function or
ﬁrst-order polynomial (cf. Sect. 5.2) by
I :
fp ¼ fz ¼ fj
if
tj1\t  tj;
j ¼ 1; 2; . . .; n
and
II :
fp ¼ fz ¼ fj1 þ ðfj  fj1Þ t  tj1
Dt
if
tj1\t  tj;
j ¼ 1; 2; . . .; n þ 1;
ð6:30Þ
6.3  Partial Derivatives of Observation Function
139

where Δt = (tn −t0)/n, t0 and tn are the beginning and the ending times of the GPS
survey, and Δt is usually selected by 2–4 h. Then one has
I :
@fp
@fj
¼ @fz
@fj
¼ 1
and
II :
@fp
@ðfj1; fjÞ ¼
@fz
@ðfj1; fjÞ ¼
1 þ t þ tj1
Dt
ttj1
Dt


:
ð6:31Þ
The azimuth dependence may be assumed to be (cf. Eq. 5.121)
fa ¼ g1 cos a þ g2 sin a;
ð6:32Þ
where a is the azimuth, and g1 and g2 are called azimuth-dependent parameters.
Then one gets
@fa
@ðg1; g2Þ ¼
cos a
sin a
ð
Þ:
ð6:33Þ
If parameters g1 and g2 are also deﬁned as step functions or ﬁrst-order polynomials
like Eq. 6.30, the partial derivatives can be obtained in a similar manner to
Eq. 6.31.
Partial Derivatives of the Phase Observable with Respect to the Ambiguity
Parameters
Depending on the scale that one prefers, there is
@kN
@kN ¼ 1
or
@kN
@N ¼ k:
ð6:34Þ
Partial Derivatives of Tidal Effects with Respect to the Tidal Parameters
If the earth tide model in Eqs. 5.147 and 5.149 is used, then the tidal effects can
generally be written as
dearthtide ¼ s1h2 þ s2l2 þ s3h3;
ð6:35Þ
where s1, s2, and s3 are the coefﬁcient functions, which are given in Sect. 5.4.2 in
detail, and h2, h3, and l2 are the love numbers and Shida number, respectively. Then
one has
@dearthtide
@ðh2; l2; h3Þ ¼
s1
s2
s3
ð
Þ:
ð6:36Þ
140
Chapter 6  GPS Observation Equations and Equivalence Properties

Ocean loading tide effects can be modelled as
dloadingtide ¼ fload dxload
dyload
dzload
ð
Þ;
ð6:37Þ
where fload is the factor of the computed ocean loading effect vector (dxload dyload
dzload). Then one has
@dloadingtide
@fload
¼
dxload
dyload
dzload
ð
Þ:
ð6:38Þ
6.4
Linear Transformation and Covariance Propagation
For any linear equation system
L ¼ AX
ð6:39Þ
or
l1
l2
..
.
lm
0
B
B
B
@
1
C
C
C
A ¼
a11
a12
. . .
a1n
a21
a22
. . .
a2n
..
.
..
.
..
.
..
.
am1
am2
. . .
amn
0
B
B
B
@
1
C
C
C
A
x1
x2
..
.
xn
0
B
B
B
@
1
C
C
C
A;
a linear transformation can be deﬁned as a multiplying operation of matrix T to
Eq. 6.39, i.e.
TL ¼ TAX
ð6:40Þ
or
t11
t12
. . .
t1m
t21
t22
. . .
t2m
...
...
...
...
tk1
tk2
. . .
tkm
0
B
B
B
@
1
C
C
C
A
l1
l2
...
lm
0
B
B
B
@
1
C
C
C
A ¼
t11
t12
. . .
t1m
t21
t22
. . .
t2m
...
...
...
...
tk1
tk2
. . .
tkm
0
B
B
B
@
1
C
C
C
A
a11
a12
. . .
a1n
a21
a22
. . .
a2n
...
...
...
...
am1
am2
. . .
amn
0
B
B
B
@
1
C
C
C
A
x1
x2
...
xn
0
B
B
B
@
1
C
C
C
A;
where T is called the linear transformation matrix and has a dimension of k × m. An
inverse transformation of T is denoted by T−1. An invertible linear transformation
does not change the property (and solutions) of the original linear equations. This
may be veriﬁed by multiplying T−1 to Eq. 6.40. A non-invertible linear transfor-
mation is called a rank-deﬁcient (or not full rank) transformation.
The covariance matrix of L is denoted by cov(L) or QLL (cf. Sect. 6.2); the
covariance of the transformed L (i.e. TL) can then be obtained by the covariance
propagation theorem by (cf., e.g., Koch 1988)
6.3  Partial Derivatives of Observation Function
141

covðTLÞ ¼ T covðLÞTT ¼ TQLLTT;
ð6:41Þ
where superscript T denotes the transpose of the transformation matrix.
If transformation matrix T is a vector (i.e. k = 1) and L is an inhomogeneous and
independent observable vector (i.e. covariance matrix QLL is a diagonal matrix with
elements of r2
j , where r2
j is the variance (σj is called standard deviation) of the
observable lj), then Eqs. 6.40 and 6.41 can be written as
t1
t2
. . .
tm
ð
Þ
l1
l2
...
lm
0
B
B
B
B
@
1
C
C
C
C
A
¼
t1
t2
. . .
tm
ð
Þ
a11
a12
. . .
a1n
a21
a22
. . .
a2n
...
...
...
...
am1
am2
. . .
amn
0
B
B
B
B
@
1
C
C
C
C
A
x1
x2
...
xn
0
B
B
B
B
@
1
C
C
C
C
A
and
covðTLÞ ¼
t1
t2
. . .
tm
ð
Þ
r2
1
0
. . .
0
0
r2
2
. . .
0
..
.
..
.
..
.
..
.
0
0
. . .
r2
m
0
B
B
B
B
@
1
C
C
C
C
A
t1
t2
..
.
tm
0
B
B
B
B
@
1
C
C
C
C
A
:
ð6:42Þ
Denoting cov(TL) as r2
TL, one gets
r2
TL ¼ t2
1r2
1 þ t2
2r2
2 þ . . . þ t2
mr2
m ¼
X
m
j¼1
t2
j r2
j :
ð6:43Þ
Equation 6.43 is called the error propagation theorem.
6.5
Data Combinations
Data combinations are methods of combining GPS data measured with the same
receiver at the same station. Generally, the observables are the code pseudoranges,
carrier phases and Doppler at working frequencies such as C/A code, P1 and P2
codes, L1 phase Φ1 and L2 phase Φ2, and Doppler D1 and D2. In the future, there
will also be P5 code, L5 phase Φ5 and Doppler D5. According to the observation
equations of the observables, a suitable combination can be advantageous for
understanding and solving GPS problems.
For convenience, the code, phase, and Doppler observables are simpliﬁed and
rewritten as (cf. Eqs. 6.1–6.3)
Rj ¼ q  ðdtr  dtkÞc þ dionðjÞ þ dtrop þ dtide þ drel þ ec;
ð6:44Þ
142
Chapter 6  GPS Observation Equations and Equivalence Properties

kjUj ¼ q  ðdtr  dtkÞc þ kjNj  dionðjÞ þ dtrop þ dtide þ drel þ ep;
ð6:45Þ
Dj ¼ dq
kjdt  fj
dðdtr  dtkÞ
dt
þ ed;
and
ð6:46Þ
dionðjÞ ¼ A1
f 2
j
þ A2
f 3
j
:
ð6:47Þ
where j is the index of frequency f, the means of the other symbols are the same as
the notes of Eqs. 6.1–6.3. Equation 6.47 is an approximation for code.
A general code–code combination can be formed by n1R1 + n2R2 + n5R5, where
n1, n2, and n5 are arbitrary constants. However, in order to make such a combination
that still has the sense of a code survey, a standardised combination has to be
formed by
R ¼ n1R1 þ n2R2 þ n5R5
n1 þ n2 þ n5
:
ð6:48Þ
The newly formed code R can then be interpreted as a weight-averaged code
survey of R1, R2, and R5. The mathematical model of the observable Eq. 6.44 is
generally still valid for R. Denoting the standard deviation of code observable Ri as
σci(i = 1, 2, 5), the newly-formed code observation R has the variance of
r2
c ¼
1
ðn1 þ n2 þ n5Þ2 n2
1r2
c1 þ n2
2r2
c2 þ n2
5r2
c5


:
Because
n1 þ n2 þ . . . þ nm
m

 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
n2
1 þ n2
2 þ . . . þ n2
m
m
r
;
(cf., e.g., Wang et al. 1979; Bronstein and Semendjajew 1987), one has the property of
ðn1 þ n2 þ . . . þ nmÞ2  mðn2
1 þ n2
2 þ . . . þ n2
mÞ;
where m is the maximum index. Therefore, in our case, one has
r2
c  m  min r2
c1; r2
c2; r2
c5


;
m ¼ 2 or 3
for combinations of two or three code observables.
A general phase–phase linear combination can be formed by
U ¼ n1U1 þ n2U2 þ n5U5;
ð6:49Þ
6.5  Data Combinations
143

where the combined signal has the frequency and wavelength
f ¼ n1f1 þ n2f2 þ n5f5
and
k ¼ c
f :
ð6:50Þ
λΦ means the measured distance (with ambiguity!) and can be presented alterna-
tively as
kU ¼ 1
f n1f1k1U1 þ n2f2k2U2 þ n5f5k5U5
ð
Þ:
ð6:51Þ
The mathematical model of Eq. 6.45 is generally still valid for the newly formed
λΦ. Denoting the standard deviation of phase observable λiΦ as σi (i = 1, 2, 5), the
newly formed observation has a variance of
r2 ¼ 1
f 2 n2
1f 2
1 r2
1 þ n2
2f 2
2 r2
2 þ n2
5f 2
5 r2
5


ð6:52Þ
and
r2  m  min r2
1; r2
2; r2
5


;
with m = 2 or 3 for combinations of two or three phases.
That is, the data combination will degrade the quality of the original data.
Linear combinations ΦW = Φ1 −Φ2 and ΦX = 2Φ1 −Φ2 are called wide-lane
and x-lane combinations with wavelengths of about 86.2 and 15.5 cm. They reduce
the ﬁrst-order ionospheric effects on frequency f2 to 40 % and 20 %, respectively.
ΦN = Φ1 + Φ2 is called a narrow-lane combination.
6.5.1
Ionosphere-Free Combinations
Due to Eqs. 6.44–6.47, phase–phase and code–code ionosphere-free combinations
can be formed by (cf. Sect. 5.1)
kU ¼ f 2
1 k1U1  f 2
2 k2U2
f 2
1  f 2
2
¼ kðf1U1  f2U2Þ
and
ð6:53Þ
R ¼ f 2
1 R1  f 2
2 R2
f 2
1  f 2
2
:
ð6:54Þ
144
Chapter 6  GPS Observation Equations and Equivalence Properties

The related observation equations can be formed from Eqs. 6.44 and 6.45 as
R ¼ q  ðdtr  dtkÞc þ dtrop þ dtide þ drel þ ecc
and
ð6:55Þ
kU ¼ q  ðdtr  dtkÞc þ kN þ dtrop þ dtide þ drel þ epc;
ð6:56Þ
where
N ¼ f1N1  f2N2;
k ¼
c
f 2
1  f 2
2
;
ð6:57Þ
εcc and εpc denote the residuals after the combination of code and phase,
respectively.
The advantages of such ionosphere-free combinations are that the ionospheric
effects have disappeared from the observation Eqs. 6.55 and 6.56 and the other
terms of the equations have remained the same. However, the combined ambiguity
is not an integer anymore, and the combined observables have higher standard
deviations.
Equations 6.55
and
6.56
are
indeed
ﬁrst-order
ionosphere-free
combinations.
Second-order ionosphere-free combinations can be formed by (see Sect. 5.1.2
for details)
kU ¼ C1k1U1 þ C2k2U2 þ C5k5U5
and
ð6:58Þ
R ¼ C1R1 þ C2R2 þ C5R5;
ð6:59Þ
where
C1 ¼ f 3
1 ðf5  f2Þ
C4
;
C2 ¼ f 3
2 ðf5  f1Þ
C4
;
C5 ¼ f 3
5 ðf2  f1Þ
C4
;
C4 ¼ f 3
1 ðf5  f2Þ  f 3
2 ðf5  f1Þ þ f 3
5 ðf2  f1Þ;
k ¼ c
C4
;
N ¼ C4ðC1N1 þ C2N2 þ C5N5Þ:
The related observation equations are the same as Eqs. 6.55 and 6.56, with λ and
N given above.
6.5.2
Geometry-Free Combinations
Given Eqs. 6.44–6.46, code–code, phase–phase, and phase–code geometry-free
combinations can be formed by
6.5  Data Combinations
145

R1  R2 ¼ dionð1Þ  dionð2Þ þ Dec ¼ A1
f 2
1
 A1
f 2
2
þ Dec;
ð6:60Þ
k1U1  k2U2 ¼ k1N1  k2N2  A1
f 2
1
þ A1
f 2
2
þ Dep;
ð6:61Þ
k1D1  k2D2 ¼ Ded;
ð6:62Þ
kjUj  Rj ¼ kjNj  2dionðjÞ þ Depc;
and
j ¼ 1; 2; 5;
ð6:63Þ
where
Ddion ¼ dionð1Þ  dionð2Þ ¼ A1
f 2
1
 A1
f 2
2
:
ð6:64Þ
For an ionospheric model of the second order, one has approximately
Ddion ¼ dionð1Þ  dionð2Þ ¼ A1
f 2
1
 A1
f 2
2
þ A2
f 3
1
 A2
f 3
2
:
The geometry-free code–code and phase–phase combinations cancel out all
other terms in the observation equations except the ionospheric term and the
ambiguity parameters. Recalling the discussions of Sect. 5.1, δion is the ionospheric
path delay and can be considered a mapping of the zenith delay dz
ion or δion = dz
ionF,
where F is the mapping function (cf. Sect. 5.1). So one has
dionð1Þ ¼ Az
1
f 2
1
F ¼ A1
f 2
1
;
ð6:65Þ
where A1 and Az
1 have the physical meaning of total electron content at the signal
path direction and the zenith direction, respectively. Az
1 is then independent from the
zenith angle of the satellite. If the variability of the electron content at the zenith
direction is stable enough, Az
1 can be modelled by a step function or a ﬁrst-order
polynomial with a reasonably short time interval Δt by
Az
1 ¼ gj
if
tj1\t  tj;
j ¼ 1; 2; . . .; n þ 1
ð6:66Þ
or
Az
1 ¼ gj1 þ gj  gj1

 t  tj1
Dt
if
tj1\t  tj; j ¼ 1; 2; . . .; n þ 1;
ð6:67Þ
where Δt = (tn −t0)/n, and t0 and tn are the beginning and ending time of the GPS
survey. Δt can be selected, for example, as 30 min. gj is the coefﬁcient of the
polynomial.
146
Chapter 6  GPS Observation Equations and Equivalence Properties

Geometry-free combinations of Eqs. 6.60, 6.61, and 6.63 (only for j = 1) can be
considered
a
linear
transformation
of
the
original
observable
vector
L = (R1 R2 λ1Φ1 λ2Φ2)T by
1
1
0
0
0
0
1
1
1
0
1
0
0
@
1
A 
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
g
k1
k2
g
k1
0
d
0
@
1
A 
N1
N2
A1
0
@
1
A þ
Dec
Dep
Depc
0
@
1
A;
ð6:68Þ
where Eq. 6.65 is used and
g ¼
1
f 2
1
 1
f 2
2

	
;
d ¼  2
f 2
1
and
T ¼
1
1
0
0
0
0
1
1
1
0
1
0
0
@
1
A:
Equation 6.68 is called an ambiguity-ionospheric equation. For any viewed GPS
satellite, Eq. 6.68 is solvable. If the variance vector of the observable vector is
r2
c
r2
c
r2
p
r2
p

T;
then the covariance matrix of the original observable vector is (cf. Sect. 6.2)
QLL ¼
r2
c
0
0
0
0
r2
c
0
0
0
0
r2
p
0
0
0
0
r2
p
0
B
B
@
1
C
C
A;
and the covariance matrix of the transformed observable vector (left side of
Eq. 6.68) is (cf. Sect. 6.4)
covðTLÞ ¼ TQLLTT ¼
2r2
c
0
r2
c
0
2r2
p
r2
p
r2
c
r2
p
r2
c þ r2
p
0
@
1
A;
and
P ¼ ðcovðTLÞÞ1 ¼ 1
2
h þ r2
c
h
2h
h
h þ r2
p
2h
2h
2h
4h
0
@
1
A;
h ¼
1
r2
c þ r2
p
:
ð6:69Þ
Taking all measured data at a station into account, the ambiguity and ionospheric
parameters (as a step function of the polynomial) can be solved by using Eq. 6.68
with the weight of Eq. 6.69. Taking into account the data station by station, all
6.5  Data Combinations
147

ambiguity and ionospheric parameters can be determined. The different weights of
the code and phase measurements are considered exactly here. Because of the
physical property of the ionosphere, all solved ionospheric parameters will have the
same sign. Even though observation Eq. 6.68 is already a linear equation system, an
initialisation is still helpful to avoid numbers from ambiguities that are too large.
The broadcasting ionospheric model can be used for initialisation of the related
ionospheric parameters.
A geometry-free combination of Eq. 6.62 can be used as a quality check of the
Doppler data.
6.5.3
Standard Phase–Code Combination
Traditionally, phase and code combinations are used to compute the wide-lane
ambiguity (cf. Sjoeberg 1999; Hofmann-Wellenhof et al. 1997). The formulas can
be derived as follows. Dividing λj into Eq. 6.63 and forming the difference for j = 1
and j = 2, one gets
Uw  R1
k1
þ R2
k2
¼ Nw  2A1
c
1
f1
þ 1
f2

	
;
ð6:70Þ
where ΦW = Φ1–Φ2, NW = N1 −N2, and they are called wide-lane observable and
ambiguity; c is the velocity of light and A1 is the ionospheric parameter. The error
term is omitted here. Equation 6.60 can be rewritten (by omitting the error term) as
A1 ¼ ðR1  R2Þ f 2
1 f 2
2
f 2
2  f 2
1
;
ð6:71Þ
and then one gets
A1
c
1
f1
 1
f2

	
¼
R1
k1f1
 R2
k2f2

	 f1f2
f2 þ f1
¼ R1
k1
f2
ðf1 þ f2Þ  R2
k2
f1
ðf1 þ f2Þ :
ð6:72Þ
Substituting Eq. 6.72 into 6.70 yields
Nw ¼ Uw  f1  f2
f1 þ f2
R1
k1
þ R2
k2

	
:
ð6:73Þ
Equation 6.73 is the most popular formula for computing wide-lane ambiguities
using phase and code observables. The undifferenced ambiguity N1 can be derived
as follows. Setting Φ2 = Φ1 −ΦW, N2 = N1–NW into Eq. 6.61 and omitting the
error term, one has
148
Chapter 6  GPS Observation Equations and Equivalence Properties

k1N1  k2 N1  Nw
ð
Þ ¼ A1
f 2
1
 A1
f 2
2
þ k1U1  k2 U1  Uw
ð
Þ;
N1 ¼ U1  ðUw  NwÞ f1
fw
þ A1
c
f1 þ f2
f1f2
or
N1 ¼ U1  ðUw  NwÞ f1
fw
 R1
k1
f2
fw
þ R2
k2
f1
fw
;
ð6:74Þ
where fw = f1 −f2 is the wide-lane frequency.
Compared with the adjustment method derived in Sect. 6.5.2, it is obvious that
the quality differences of the phase and code data are not considered using Eqs. 6.
73 and 6.74 for determining the ambiguity parameters. Therefore, we suggest that
the method proposed in Sect. 6.5.2 be used.
6.5.4
Ionospheric Residuals
Considering the GPS observables as a time series, the geometry-free combinations
of Eqs. 6.60–6.64 can be rewritten as
R1ðtjÞ  R2ðtjÞ ¼ DdionðtjÞ þ Dec;
ð6:75Þ
k1U1ðtjÞ  k2U2ðtjÞ ¼ k1N1  k2N2  DdionðtjÞ þ De
and
ð6:76Þ
kiUiðtjÞ  RiðtjÞ ¼ kiNi  2dionði; tjÞ þ Depc;
i ¼ 1; 2; 5;
ð6:77Þ
where
DdionðtjÞ ¼ dionð1; tjÞ  dionð2; tjÞ ¼ A1ðtjÞ
f 2
1
 A1ðtjÞ
f 2
2
;
j ¼ 1; 2; . . .; m:
ð6:78Þ
The differences of the above observable combinations at the two consecutive
epochs tj and tj–1 can be formed as
DtR1ðtjÞ  DtR2ðtjÞ ¼ DtDdionðtjÞ þ DtDec;
ð6:79Þ
k1DtU1ðtjÞ  k2DtU2ðtjÞ ¼ k1DtN1  k2DtN2  DtDdionðtjÞ þ DtDep;
and
ð6:80Þ
kiDtUiðtjÞ  DtRiðtjÞ ¼ kiDtNi  2Dtdionði; tjÞ þ DtDepc;
i ¼ 1; 2; 5;
ð6:81Þ
6.5  Data Combinations
149

where Δt is a time difference operator, and for any time function G(t), ΔtG(tj) = G
(tj)–G(tj−1) is valid.
Because the time differences of the ionospheric effects Δt δion and Δt Δδion are
generally very small, they are called ionospheric residuals. In the case of no cycle
slips, i.e. ambiguities N1 and N2 are constant, ΔN1 and ΔN2 equal zero.
Equations 6.79–6.81 are called ionospheric residual combinations. The ﬁrst com-
bination of Eq. 6.79 can be used for a consistency check of two code measure-
ments. Equations 6.80 and 6.81 can be used for a cycle slip check. Equation 6.81 is
a phase–code combination, due to the lower accuracy of the code measurements; it
can be used only to check for large cycle slips. Equation 6.80 is a phase–phase
combination, and therefore it has higher sensitivity to cycle slips. However, two
special cycle slips, ΔN1 and ΔN2, can lead to a very small combination of
δ1ΔtN1 −δ2ΔtN2.
Examples
of
such
combinations
can
be
found
in
Hofmann-Wellenhof et al. (1997). Thus even the ionospheric residual of Eq. 6.80 is
very small; it may not guarantee that there are no cycle slips.
6.5.5
Differential Doppler and Doppler Integration
Differential Doppler
The numerical differentiation of the original observables given in Eqs. 6.44 and
6.45 at the two consecutive epochs tj and tj−1 can be formed as
DtRj
kjDt ¼ Dtq
kjDt  fj
Dtðdtr  dtkÞ
Dt
þ Dtec
kjDt ;
j ¼ 1; 2;
and
ð6:82Þ
DtUj
Dt ¼ Dtq
kjDt  fj
Dtðdtr  dtkÞ
Dt
þ Dtep
kjDt ;
j ¼ 1; 2;
ð6:83Þ
where Δt/Δt is a numerical differentiation operator and Δt = tj −tj−1.
The left-hand side of Eq. 6.83 is called differential Doppler. Ionospheric resid-
uals are negligible and are omitted here. The third terms of Eqs. 6.82 and 6.83 on
the right-hand side are small residual errors. For convenience of comparison, the
Doppler observable model of Eq. 6.46 is copied below:
Dj ¼ dq
kjdt  fj
dðdtr  dtkÞ
dt
þ ed:
ð6:84Þ
It is clear that Eqs. 6.83 and 6.84 are nearly the same. The only difference is that
in Doppler Eq. 6.84, the observed Doppler is an instantaneous one, and its model is
presented by theoretical differentiation, whereas the term on the left-hand side of
Eq. 6.83 is the numerically differenced Doppler (formed by phases), and its model
is presented by numerical differentiation. Doppler measurement measures the
150
Chapter 6  GPS Observation Equations and Equivalence Properties

instantaneous motion of the GPS antenna, whereas differential Doppler describes a
kind of average velocity of the antenna over two consecutive epochs. The velocity
solution of Eq. 6.83 (denoted by
_x
_y
_z
ð
ÞT) can be used to predict the future
kinematic position by
xj þ 1
yj þ 1
zj þ 1
0
@
1
A ¼
xj
yj
zj
0
@
1
A þ
_xj
_yj
_zj
0
@
1
A  Dt:
ð6:85Þ
In other words, differential Doppler can be used as the system equation of a
Kalman ﬁlter for kinematic positioning. The Kalman ﬁlter will be discussed in the
next chapter. A Kalman ﬁlter using differential Doppler will be discussed in Sect. 9.8.
Doppler Integration
Integrating the instantaneous Doppler Eq. 6.84, one has
kj
Ztj
tj1
Djdt ¼ Dtq  Dtðdtr  dtkÞc þ ed:
Using the operator Δt to the undifferenced phase Eq. 6.45 and code Eq. 6.44, one
gets
kjDtUj ¼ Dtq  Dtðdtr  dtkÞc þ kjDtNj þ ep
and
DtRj ¼ Dtq  Dtðdtr  dtkÞc þ ec;
ð6:86Þ
where the same symbols are used for the error terms (later too). Differencing the
ﬁrst equation of Eq. 6.86 with the integrated Doppler leads to
kjDtNj ¼ kjDtUj  kj
Ztj
tj1
Djdt þ e1
or
DtNj ¼ DtUj 
Ztj
tj1
Djdt þ e1;
j ¼ 1; 2; 5:
ð6:87Þ
Thus, integrated Doppler can be used for cycle slip detection. This detection
method is very reasonable. The phase is measured by keeping track of the partial
phase and accumulating the integer count. If any loss of lock of the signal happens
during this time, the integer accumulation will be wrong, i.e. a cycle slip occurs.
Therefore, an external instantaneous Doppler integration can be used as an alter-
native method of cycle slip detection. The integration can be achieved by ﬁrst ﬁtting
6.5  Data Combinations
151

the Doppler with a suitable order polynomial, and then integrating that within the
time interval.
Code Smoothing
Comparing the two formulas of Eq. 6.86, one has
DtRj ¼ kjDtUj  kjDtNj þ e2
or
DtRj ¼ kjDtUj þ e3:
ð6:88Þ
Equation 6.88 can be used for smoothing the code survey by phase if there are no
cycle slips.
Differential Phases
The ﬁrst formula of Eq. 6.86 is the numerical difference of the phases at the two
consecutive epochs tj and tj−1
kjDtUj ¼ Dtq  Dtðdtr  dtkÞc þ kjDtNj þ ep;
j ¼ 1; 2:
All terms on the right-hand side except the ambiguity term are of low variation.
Any cycle slips will lead to a sudden jump in the time difference of the phases.
Therefore, the time-differenced phase can be used as an alternative method of cycle
slip detection.
6.6
Data Differentiations
Data differentiations are methods of combining GPS data (of the same type)
measured at different stations. For the convenience of later discussions, tidal effects
and relativistic effects are considered corrected before forming the differences. The
original code, phase, and Doppler observables as well as their standardised com-
binations can be rewritten as (cf. Eqs. 6.44–6.47)
Rk
i ðjÞ ¼ qk
i  cdti þ cdtk þ dionðjÞ þ dtrop þ ec;
ð6:89Þ
kjUk
i ðjÞ ¼ qk
i  cdti þ cdtk þ kjNk
i ðjÞ  dionðjÞ þ dtrop þ ep;
ð6:90Þ
dionðjÞ ¼ A1
f 2
j
þ A2
f 3
j
;
and
ð6:91Þ
Dk
i ðjÞ ¼ dqk
i
kjdt  fj
dðdti  dtkÞ
dt
þ ed;
ð6:92Þ
152
Chapter 6  GPS Observation Equations and Equivalence Properties

where j (j = 1,2,5) is the index of frequency f, subscript i is the index of the station
number, and superscript k is the ID number of the satellite.
6.6.1
Single Differences
Single difference (SD) is the difference formed by data observed at two stations on
the same satellite as
SDk
i1;i2ðOÞ ¼ Ok
i2  Ok
i1;
ð6:93Þ
where O is the original observable, and i1 and i2 are the two ID numbers of the
stations. Supposing the original observables have the same variance of σ2, then the
single-difference observable has a variance of 2σ2. Considering Eqs. 6.89–6.92, one
has
SDk
i1;i2ðRðjÞÞ ¼ qk
i2  qk
i1  cdti2 þ cdti1 þ ddionðjÞ þ ddtrop þ dec;
ð6:94Þ
SDk
i1;i2ðkjUðjÞÞ ¼ qk
i2  qk
i1  cdti2 þ cdti1 þ kjNk
i2ðjÞ  kjNk
i1ðjÞ
 ddionðjÞ þ ddtrop þ dep;
and
ð6:95Þ
SDk
i1;i2ðDðjÞÞ ¼ _qk
i2  _qk
i1
kj
 fj
dðdti2  dti1Þ
dt
þ ded;
ð6:96Þ
where _q is the time differentiation of ρ, and dδion(j) and dδtrop are the differenced
ionospheric and tropospheric effects at the two stations related to the satellite k,
respectively.
The most important property of single differences is that the satellite clock error
terms in the model are eliminated. However, it should be emphasised that the
satellite clock error, which implicitly affects the computation of satellite position,
must still be carefully considered. Ionospheric and tropospheric effects are reduced
through difference forming, especially for those stations that are not very far
apart. Because of the identical mathematical models of the station clock errors and
ambiguities, not all clock and ambiguity parameters can be resolved in the
single-difference equations of Eqs. 6.94–6.96.
For the original observable vector of station i1 and i2,
O ¼
Ok1
i1
Ok2
i1
Ok3
i1
Ok1
i2
Ok2
i2
Ok3
i2

T;
covðOÞ ¼ r2E;
the single differences
6.6  Data Differentiations
153

SDðOÞ ¼
Ok1
i1;i2
Ok2
i1;i2
Ok3
i1;i2

T;
can be formed by a linear transformation
SDðOÞ ¼ C  O
and
C ¼
1
0
0
1
0
0
0
1
0
0
1
0
0
0
1
0
0
1
0
B
@
1
C
A ¼
E
E
ð
Þ:
ð6:97Þ
Where common satellites k1, k2, k3 are observed, E is an identity matrix whose size
is that of the observed satellite number; in the above example the size is 3 × 3.
The covariance matrix of the single differences is then
covðSDðOÞÞ ¼ C  covðOÞ  CT ¼ r2C  CT ¼ 2r2E;
ð6:98Þ
i.e. the weight matrix is
P ¼ 1
2r2 E:
In other words, the single differences are uncorrelated observables in the case
of a single baseline. C in Eq. 6.97 is a general form, so C is denoted by
Cs = (−En×n En×n), and n is the number of commonly viewed satellites.
Single differences can be formed for any baselines as long as the two stations
have common satellites in sight. However, these should be a set of “independent”
baselines. The most widely used methods involve the formation of radial or
transverse baselines. Supposing the stations’ ID vector is (i1, i2, i3,…, i(m −1),
im), and the baseline between station i1 and i2 is denoted by (i1, i2), then the radial
baselines can be formed, for example, by (i1, i2),(i1, i3),…,(i1, im), and the
transverse baselines by (i1, i2), (i2, i3),…,(i(m −1), im). Station i1 is called a
reference station and is freely selectable. In some cases, mixed radial and transverse
baselines must be formed—for example, by (i1, i2), (i1, i3), (i3, i4),…,(i3,
i(m −1)), (i3, im). Sometimes the baselines must be formed by several groups, and
thus several references must be selected. A method of forming independent and
optimal baseline networks will be discussed in Sects. 9.1 and 9.2.
In the case in which three stations are used to measure the GPS data, the original
observable vector of stations i1, i2 and i3 is
Oi ¼
Ok1
i
. . .
Okn
i

T;
covðOiÞ ¼ r2Enn;
i ¼ i1; i2; i3;
154
Chapter 6  GPS Observation Equations and Equivalence Properties

where n is the commonly observed satellite number. The single differences of the
baseline (i, j) are
SDi;jðOÞ ¼
Ok1
i;j
. . .:
Okn
i;j

T
i; j ¼ i1; i2; i3;
i 6¼ j:
If the baselines are formed in a radial way, i.e. as (i1, i2) and (i1, i3), then one
has
SDi1;i2ðOÞ
SDi1;i3ðOÞ

	
¼
E
E
0
E
0
E

	
Oi1
Oi2
Oi3
0
@
1
A;
and
covðSDÞ ¼ r2
E
E
0
E
0
E

	
E
E
E
0
0
E
0
B
@
1
C
A ¼ r2
2E
E
E
2E

	
and
Ps ¼ ½covðSDÞ1 ¼ 1
3r2
2E
E
E
2E

	
:
ð6:99Þ
If the baselines are formed in a transverse way, i.e. as (i1, i2) and (i2, i3), then
one has
SDi1;i2ðOÞ
SDi2;i3ðOÞ

	
¼
E
E
0
0
E
E

	
Oi1
Oi2
Oi3
0
B
@
1
C
A;
covðSDÞ ¼ r2
E
E
0
0
E
E

	
E
0
E
E
0
E
0
B
@
1
C
A ¼ r2
2E
E
E
2E

	
and
Ps ¼ ½covðSDÞ1 ¼ 1
3r2
2E
E
E
2E

	
:
It is obvious that the single differences are correlated if the number of stations is
greater than two, and the correlation depends on the ways the baselines are formed.
Therefore, it is not possible to derive a general covariance formula for the single
differences of a network. Furthermore, the commonly viewed satellite number
n could be different from baseline to baseline, further complicating the formulation
of the covariance matrix.
A baseline-wise processing of the GPS data of a network using single differences
is equivalent to an omission of the correlation between the baselines.
6.6  Data Differentiations
155

6.6.2
Double Differences
Double differences are formed between two single differences related to two
observed satellites as
DDk1;k2
i1;i2 ðOÞ ¼ SDk2
i1;i2ðOÞ  SDk1
i1;i2ðOÞ
ð6:100Þ
or
DDk1;k2
i1;i2 ðOÞ ¼ ðOk2
i2  Ok2
i1 Þ  ðOk1
i2  Ok1
i1 Þ;
ð6:101Þ
where k1 and k2 are the two id numbers of the satellites. Supposing the original
observables have the same variance of σ2, then the double-differenced observables
have a variance of 4σ2. Considering Eqs. 6.89–6.92, one has
DDk1;k2
i1;i2 ðRðjÞÞ ¼ qk2
i2  qk2
i1  qk1
i2 þ qk1
i1 þ dddionðjÞ þ dddtrop þ ddec;
ð6:102Þ
DDk1;k2
i1;i2 ðkjUðjÞÞ ¼ qk2
i2  qk2
i1  qk1
i2 þ qk1
i1 þ kjðNk2
i2 ðjÞ  Nk2
i1 ðjÞ
 Nk1
i2 ðjÞ þ Nk1
i1 ðjÞÞ  dddionðjÞ þ dddtrop þ ddep;
and
ð6:103Þ
DDk1;k2
i1;i2 ðDðjÞÞ ¼ _qk2
i2  _qk2
i1  _qk1
i2 þ _qk1
i1
kj
þ dded;
ð6:104Þ
where ddδion(j) and ddδtrop are the differenced ionospheric and tropospheric effects
at the two stations related to the two satellites, respectively. For the ionosphere-free
combined observables (denoted by j = 4 for distinguishing), the ionospheric error
terms have vanished from above equations.
The most important property of double differences is that the clock error terms in
the equation (model) are completely eliminated. It should be emphasised that the
clock error, which implicitly affects the computation of the position of the satellite,
must still be carefully considered. Ionospheric and tropospheric effects are reduced
greatly through difference forming, especially for those stations that are not far
apart. Double-differenced Doppler directly describes the geometry change.
Double-differenced ambiguities can be denoted by
Nk1;k2
i1;i2 ðjÞ ¼ Nk2
i2 ðjÞ  Nk2
i1 ðjÞ  Nk1
i2 ðjÞ þ Nk1
i1 ðjÞ:
ð6:105Þ
For convenience, the original ambiguities used in Eq. 6.103 are for the case of the
reference satellite changing.
For the single-difference observable vector
SDðOÞ ¼
Ok1
i1;i2
Ok2
i1;i2
Ok3
i1;i2

T
and
covðSDðOÞÞ ¼ 2r2E;
ð6:106Þ
156
Chapter 6  GPS Observation Equations and Equivalence Properties

the double differences
DDðOÞ ¼
Ok1;k2
i1;i2
Ok1;k3
i1;i2

T
ð6:107Þ
can be formed by a linear transformation
DDðOÞ ¼ Cd  SDðOÞ;
ð6:108Þ
Cd ¼
1
1
0
1
0
1

	
¼
Im
E mm


here m ¼ 2
ð
Þ;
ð6:109Þ
where E is an identity matrix of size m × m, I is a 1 vector of size m (all elements of
the vector are 1), m is the number of formed double differences, and m = n −1. The
covariance matrix of the double differences is then
covðDDðOÞÞ ¼ Cd  covðSDðOÞÞ  CT
d ¼ 2r2Cd  CT
d ¼ 2r2
2
1
1
2

	
:
ð6:110Þ
For single and double differences
SDðOÞ ¼
Ok1
i1;i2
Ok2
i1;i2
Ok3
i1;i2
Ok4
i1;i2

T;
covðSDðOÞÞ ¼ 2r2E;
and
ð6:111Þ
DDðOÞ ¼
Ok1;k2
i1;i2
Ok1;k3
i1;i2
Ok1;k4
i1;i2

T
;
ð6:112Þ
the linear transformation matrix Cd and the covariance matrix can be obtained by
Cd ¼
1
1
0
0
1
0
1
0
1
0
0
1
0
@
1
A ¼
I
E
ð
Þ
and
ð6:113Þ
covðDDðOÞÞ ¼ Cd  covðSDðOÞÞ  CT
d ¼ 2r2Cd  CT
d ¼ 2r2
2
1
1
1
2
1
1
1
2
0
@
1
A:
ð6:114Þ
For the general case of
SDðOÞ ¼
Ok1
i1;i2
Ok2
i1;i2
Ok3
i1;i2
. . .
Okn
i1;i2

T;
covðSDðOÞÞ ¼ 2r2E;
and
DDðOÞ ¼
Ok1;k2
i1;i2
Ok1;k3
i1;i2
. . .
Ok1;km
i1;i2

T
;
ð6:115Þ
it is obvious that the general transformation matrix Cd and the related covariance
matrix can be represented as
6.6  Data Differentiations
157

Cd ¼
Im
E mm


and
ð6:116Þ
covðDDðOÞÞ ¼ CdcovðSDðOÞÞCT
d ¼ 2r2CdCT
d ¼ 2r2 Imm þ Emm
ð
Þ
ð6:117Þ
where Im×m is an m × m matrix whose elements are all 1, and the weight matrix has
the form of
P ¼ ½covðDDðOÞÞ1 ¼
1
2r2n nEmm  Imm
ð
Þ;
ð6:118Þ
where n = m + 1. Equation 6.118 can be veriﬁed by an identity matrix test (i.e.
P  cov(DD(O)) = E).
In the case of three stations, supposing n common satellites (k1, k2,…, kn) are
viewed, then the single and double differences can be written as
SDi;jðOÞ ¼
Ok1
i;j
Ok2
i;j
Ok3
i;j
. . .
Okn
i;j

T
and
DDi;jðOÞ ¼
Ok1;k2
i;j
Ok1;k3
i;j
. . .
Ok1;km
i;j

T
i; j ¼ i1; i2; i3; 4
i 6¼ j:
ð6:119Þ
Then one has the transformation and covariance
DDi1;i2ðOÞ
DDi1;i3ðOÞ

	
¼
Cd
0
0
Cd

	
SDi1;i2ðOÞ
SDi1;i3ðOÞ

	
and
covðDDÞ ¼
Cd
0
0
Cd

	
covðSDÞ
Cd
0
0
Cd

	T
¼ r2
2E
E
E
2E

	
ðCdCT
d Þ:
Because of the dependence of the cov(SD) on the baselines forming, cov(DD) is
also dependent on the baselines forming. A baseline-wise processing of a network
GPS data using double differences is equivalent to an omission of the correlation
between the baselines.
6.6.3
Triple Differences
Triple differences are formed between two double differences related to the same
stations and satellites at the two adjacent epochs as
TDk1;k2
i1;i2 ðOðt1; t2ÞÞ ¼ DDk1;k2
i1;i2 ðOðt2ÞÞ  DDk1;k2
i1;i2 ðOðt1ÞÞ
158
Chapter 6  GPS Observation Equations and Equivalence Properties

or
TDk1;k2
i1;i2 ðOðt1; t2ÞÞ ¼ Ok2
i2 ðt2Þ  Ok2
i1 ðt2Þ  Ok1
i2 ðt2Þ þ Ok1
i1 ðt2Þ
 Ok2
i2 ðt1Þ þ Ok2
i1 ðt1Þ þ Ok1
i2 ðt1Þ  Ok1
i1 ðt1Þ;
ð6:120Þ
where t1 and t2 are two adjacent epochs. Supposing the original observables have
the same variance of σ2, then the triple-differenced observables have a variance of
8σ2. Considering Eqs. 6.102–6.104, one has
TDk1;k2
i1;i2 ðRðj; t1; t2ÞÞ ¼ qk2
i2 ðt2Þ  qk2
i1 ðt2Þ  qk1
i2 ðt2Þ þ qk1
i1 ðt2Þ  qk2
i2 ðt1Þ
þ qk2
i1 ðt1Þ þ qk1
i2 ðt1Þ  qk1
i1 ðt1Þ þ tdec;
ð6:121Þ
TDk1;k2
i1;i2 ðkjUðj; t1; t2ÞÞ ¼ qk2
i2 ðt2Þ  qk2
i1 ðt2Þ  qk1
i2 ðt2Þ þ qk1
i1 ðt2Þ  qk2
i2 ðt1Þ
þ qk2
i1 ðt1Þ þ qk1
i2 ðt1Þ  qk1
i1 ðt1Þ þ dN þ tdep;
and
ð6:122Þ
TDk1;k2
i1;i2 ðDðj; t1; t2ÞÞ ¼ _qk2
i2 ðt2Þ  _qk2
i1 ðt2Þ  _qk1
i2 ðt2Þ þ _qk1
i1 ðt2Þ
kj
 _qk2
i2 ðt1Þ  _qk2
i1 ðt1Þ  _qk1
i2 ðt1Þ þ _qk1
i1 ðt1Þ
kj
þ tded;
ð6:123Þ
where
dN ¼ kjðNk1;k2
i1;i2 ðj; t2Þ  Nk1;k2
i1;i2 ðj; t1ÞÞ:
ð6:124Þ
Ionospheric and tropospheric effects are eliminated. If there are no cycle slips
during the time, the term of Eq. 6.124 is zero. Therefore, triple differences of
Eq. 6.122 can also be used as a check for the cycle slips. Through triple-difference
forming, the systematic cycle slip turns out to be an effect like an outlier.
The most important property of triple differences is that only the geometric
change is left in the models. Triple differences of Doppler describe the acceleration
of the position.
For double differences
DDðOðtÞÞ ¼
Ok1;k2
i1;i2 ðtÞ
Ok1;k3
i1;i2 ðtÞ
. . .
Ok1;km
i1;i2 ðtÞ

T
;
ð6:125Þ
one has
TDðOðt1; t2ÞÞ ¼ CT 
DDðOðt1ÞÞ
DDðOðt2ÞÞ

	
;
ð6:126Þ
6.6  Data Differentiations
159

where
CT ¼
Emm
E mm


:
ð6:127Þ
Then the related covariance matrix can be represented as
covðTD(Oðt1; t2ÞÞÞ ¼ CT  covðDD(OÞÞ  CT
T
¼ CT  Cd2 covðSD(OÞÞ  CT
d2CT
T ¼ 2r2CTCd2CT
d2CT
T;
ð6:128Þ
where Cd2 is the double-difference transformation matrix of two epochs. Because
double differences are independent epoch wise, Cd2 is a diagonal matrix of Cd, i.e.
Cd2 ¼
Cd
0
0
Cd

	
:
ð6:129Þ
It is worth noting that the triple differences formed by epochs (t1, t2) are cor-
related to the differences formed by epochs (t0, t1) and (t1, t2). Such correlation
makes a sequential processing of the triple-difference data very complicated.
Sequentially using the above covariance formula indicates an omission of the
correlation related to the previous epoch and the next epoch.
Taking the correlation between the baselines into account, an exact correlation
description of the triple differences of a GPS network becomes very difﬁcult.
6.7
Equivalence of the Uncombined and Combining Algorithms
Uncombined and combining algorithms are standard GPS data processing methods,
which
can
often
be
found
in
the
literature
(cf.,
e.g.,
Leick
2004;
Hofmann-Wellenhof et al. 2001). Different combinations own different properties
and are beneﬁcial for dealing with the data and solving the problem in different
cases (Hugentobler et al. 2001; Kouba and Heroux 2001; Zumberge et al. 1997).
The equivalence between the undifferenced and differencing algorithms was proved
and a uniﬁed equivalent data processing method proposed by Xu (2002, cf.
Sect. 6.8). The question of whether the uncombined and combining algorithms are
also equivalent is an interesting topic and will be addressed here in detail (cf. Xu
et al. 2006a).
160
Chapter 6  GPS Observation Equations and Equivalence Properties

6.7.1
Uncombined GPS Data Processing Algorithms
Original GPS Observation Equations
The original GPS code pseudorange and carrier phase measurements represented
in Eqs. 6.44 and 6.45 (cf. Sect. 6.5) can be simpliﬁed as
Rj ¼ Cq þ dionðjÞ;
ð6:130Þ
kjUj ¼ Cq þ kjNj  dionðjÞ;
j ¼ 1; 2
ð6:131Þ
where
Cq ¼ q  ðdtr  dtkÞc þ dtrop þ dtide þ drel þ ei;
i ¼ c; p
ð6:132Þ
dionðjÞ ¼ A1
f 2
j
¼ Az
1
f 2
j
F ¼ f 2
s B1
f 2
j
¼ f 2
s Bz
1
f 2
j
F:
ð6:133Þ
Where symbols have the same meanings as those of Eqs. 6.44–6.47. j is the index
of the frequency f and wavelength λ. A1 and A1
z are the ionospheric parameters in
the path and zenith directions; B1 and Bz
1 are scaled A1 and Az
1 with f 2
s for numerical
reasons. c denotes the speed of light, index c denotes code. Cρ is called geometry
and Nj is the ambiguity. For simplicity, the residuals of the codes (and phases) are
denoted with the same symbol εc (and εp) and have the same standard deviations of
σc (and σp). Equations 6.130 and 6.131 can be written in a matrix form with weight
matrix P as (Blewitt 1998)
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
1
0
f 2
s =f 2
1
1
0
1
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A;
P ¼
r2
c
0
0
0
0
r2
c
0
0
0
0
r2
p
0
0
0
0
r2
p
0
B
B
@
1
C
C
A
1
:
ð6:134Þ
Solutions of Uncombined Observation Equations
Equation 6.134 includes the observations of one satellite viewed by one receiver
at one epoch. Alternatively, Eq. 6.134 can be considered a transformation between
the observations and unknowns, and the transformation is a linear and invertible
one. Denoting
a ¼
f 2
1
f 2
1  f 2
2
;
b ¼
f 2
2
f 2
1  f 2
2
;
g ¼ 1
f 2
1
 1
f 2
2
;
q ¼ gf 2
s ;
ð6:135Þ
6.7  Equivalence of the Uncombined and Combining Algorithms
161

then one has relations of
1  a ¼ b;
1
f 2
1 g ¼ b;
1
f 2
2 g ¼ a
ð6:136Þ
and
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
1
0
f 2
s =f 2
1
1
0
1
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
1
¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A ¼ T:
ð6:137Þ
Where a and b are the coefﬁcients of the ionosphere-free combinations of the
observables of L1 and L2. The solution of Eq. 6.134 has a form of (by multiplying
the transformation matrix T to Eq. 6.134)
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:138Þ
The related covariance matrix of the above solution vector is then
Q ¼ cov
k1N1
k2N2
B1
Cq
0
B
B
B
@
1
C
C
C
A ¼ T
r2
c
0
0
0
0
r2
c
0
0
0
0
r2
p
0
0
0
0
r2
p
0
B
B
B
B
@
1
C
C
C
C
A
TT
¼
ð1  2aÞ2 þ 4b2 þ
r2
p
r2c
4a2  4ab  2a þ 2b
12a þ 2b
q
a  2a2  2b2
4a2  4ab  2a þ 2b
8a2  4a þ 1 þ
r2
p
r2c
14a
q
2a2 þ 2ab  b
12a þ 2b
q
14a
q
2
q2
ab
q
a  2a2  2b2
2a2 þ 2ab  b
ab
q
a2 þ b2
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
r2
c:
ð6:139Þ
Equation 6.139 can be simpliﬁed by using the relation of 1 −a = b and
neglecting the terms of (σp/σc)2 (because (σp/σc) is less than 0.01) as well as letting
fs = f1 (so that q = 1/b). Taking the relationships of ratios of the frequencies into
account (f1 = 154f0 and f2 = 120f0, f0 is the fundamental frequency), one has
approximately
162
Chapter 6  GPS Observation Equations and Equivalence Properties

cov
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
26:2971
33:4800
11:1028
15:1943
33:4800
42:6629
14:1943
19:2857
11:1028
14:1943
4:7786
6:3243
15:1943
19:2857
6:3243
8:8700
0
B
B
@
1
C
C
Ar2
c
ð6:140Þ
The precision of the solutions will be further discussed in Sect. 6.7.3. The
parameterisation of the GPS observation models is an important issue and can be
found in Chap. 9 or (Blewitt 1998; Xu 2004) if interested.
6.7.2
Combining Algorithms of GPS Data Processing
Ionosphere-Free Combinations
Letting transformation matrix
T1 ¼
1
1
0
0
a
b
0
0
0
0
a
b
1=2
0
1=2
0
0
B
B
@
1
C
C
A;
ð6:141Þ
and applying the transform to the Eq. 6.134, one has
T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
q
0
0
0
0
1
a
b
0
1
1=2
0
0
1
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A:
ð6:142Þ
The ionospheric parameter in Eq. 6.142 is free in the last three equations, which
are traditionally called ionosphere-free combinations. Solving the ionosphere-free
equations or the whole Eq. 6.142 will lead to the same results. Equation 6.142 has a
unique solution vector of
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
0
2
0
2
0
ð2a  1Þ=b
1=b
2a=b
1=q
0
0
0
0
1
0
0
0
B
B
@
1
C
C
AT1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A;
ð6:143Þ
or (noticing (1 −a) = b, cf. Eq. 6.136)
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:144Þ
6.7  Equivalence of the Uncombined and Combining Algorithms
163

Equations 6.144 and 6.138 are identical. Therefore, the covariance matrix of the
solution vector on the left side of Eq. 6.144 is the same as that given in Eq. 6.139.
This shows that the uncombined algorithms and the ionosphere-free combinations
are equivalent in this case.
Geometry-Free Combinations
Letting transformation matrix
T2 ¼
a
b
0
0
1
1
0
0
0
0
1
1
1
0
1
0
0
B
B
@
1
C
C
A;
ð6:145Þ
and applying the transformation to Eq. 6.134, one has
T2
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
0
1
0
0
q
0
1
1
q
0
1
0
2f 2
s =f 2
1
0
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A:
ð6:146Þ
The geometric component in Eq. 6.146 is free in the last three equations, which
are traditionally called geometry-free combinations. Solving the geometry-free
equations or Eq. 6.146 will lead to the same results. Equation 6.146 has a unique
solution vector of
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
0
2=ðf 2
1 gÞ
0
1
0
2=ðf 2
1 gÞ  1
1
1
0
1=q
0
0
1
0
0
0
0
B
B
@
1
C
C
AT2
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A;
ð6:147Þ
or (noticing 1/(f1
2g) = b, cf. Equation 6.136)
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
2b  1
2b
1
0
2b  2
1  2b
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:148Þ
Taking the relations of Eq. 6.136 (i.e. b = 1 −a) into account, Eqs. 6.148 and
6.138 are identical. Therefore, the covariance matrix of the solution vector on the left
side of Eq. 6.148 is identical with that of Eq. 6.139. This shows that the uncombined
algorithms and the geometry-free combinations are equivalent in this case.
Ionosphere-Free and Geometry-Free Combinations
Letting transformation matrix
164
Chapter 6  GPS Observation Equations and Equivalence Properties

T3 ¼
1
0
0
0
0
1
0
0
0
1
1
0
0
1
0
1
0
B
B
@
1
C
C
A;
ð6:149Þ
one then has
T3T1 ¼
1
0
0
0
0
1
0
0
0
1
1
0
0
1
0
1
0
B
B
@
1
C
C
A
1
1
0
0
a
b
0
0
0
0
a
b
1=2
0
1=2
0
0
B
B
@
1
C
C
A
¼
1
1
0
0
a
b
0
0
a
b
a
b
1=2  a
b
1=2
0
0
B
B
@
1
C
C
A:
ð6:150Þ
Applying the transformation 6.150 to Eq. 6.134 or applying the transformation
6.149 to Eq. 6.142 leads to the same results, and one has
T3T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
q
0
0
0
0
1
a
b
0
0
1=2
0
0
0
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A
ð6:151Þ
or
R1  R2
aR1 þ bR2
ak1U1 þ bk2U2  aR1  bR2
ðk1U1 þ R1Þ=2  aR1  bR2
0
B
B
@
1
C
C
A ¼
0
0
q
0
0
0
0
1
a
b
0
0
1=2
0
0
0
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A:
ð6:152Þ
The ionosphere and geometry are both free in the last two equations, which are
called ionosphere-geometry-free combinations. Solving the ionosphere-free and
geometry-free equations or directly solving Eq. 6.152 will lead to the same results.
Equation 6.152 has a unique solution vector of
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
0
0
0
2
0
0
1=b
2a=b
1=q
0
0
0
0
1
0
0
0
B
B
@
1
C
C
AT3T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A;
ð6:153Þ
or (noticing (1 −a)/b = 1, cf. Eq. 6.136)
6.7  Equivalence of the Uncombined and Combining Algorithms
165

k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:154Þ
Equations 6.154 and 6.138 are identical. This shows that the uncombined
algorithms and the ionosphere-geometry-free combinations are equivalent in this
discussed case.
Diagonal Combinations
Letting transformation matrix
T4 ¼
1
0
0
0
0
1
0
0
0
0
1
2a
0
0
0
1
0
B
B
@
1
C
C
A;
ð6:155Þ
one has
T4T3T1 ¼
1
0
0
0
0
1
0
0
0
0
1
2a
0
0
0
1
0
B
B
@
1
C
C
A
1
1
0
0
a
b
0
0
a
b
a
b
1=2  a
b
1=2
0
0
B
B
@
1
C
C
A
¼
1
1
0
0
a
b
0
0
2ab
bð2a  1Þ
0
b
1=2  a
b
1=2
0
0
B
B
@
1
C
C
A:
ð6:156Þ
If applying the transformation 6.156 to Eq. 6.134 or applying the transformation
6.155 to Eq. 6.151, one has the same results of
T4T3T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
q
0
0
0
0
1
0
b
0
0
1=2
0
0
0
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A:
ð6:157Þ
In the above equation, the ionosphere and geometry as well as the ambiguities
are diagonal to each other. Such combinations are called diagonal ones. The
solution vector of Eq. 6.157 may be easily derived
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
0
0
0
2
0
0
1=b
0
1=q
0
0
0
0
1
0
0
0
B
B
@
1
C
C
AT4T3T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A
ð6:158Þ
166
Chapter 6  GPS Observation Equations and Equivalence Properties

or
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:159Þ
Equations 6.159 and 6.138 are identical, which shows that the uncombined
algorithms and diagonal combinations are equivalent in the case discussed.
General Combinations
For arbitrary combinations, once the transformation matrix is invertible, the
transformed equations are equivalent to the original equations based on algebraic
theory. The solution vector and the variance–covariance matrix are identical. In
other words, regardless of the combinations used, neither the solutions nor the
precision of the solutions obtained will differ. Various combinations lead to an
easier resolution of speciﬁc related problems.
Wide- and Narrow-Lane Combinations
Denoting
T5 ¼
0
0
0
2
0
0
1=b
0
1=q
0
0
0
0
1
0
0
0
B
B
@
1
C
C
A
ð6:160Þ
and letting transformation matrix
T6 ¼
1
k1
1
k2
0
0
1
k1
1
k2
0
0
0
0
1
0
0
0
0
1
0
B
B
@
1
C
C
A;
ð6:161Þ
one may form the wide and narrow lanes (Petovello 2006) directly by multiplying
Eq. 6.161 by Eq. 6.158 to obtain the related wide- and narrow-lane ambiguities
N1  N2
N1 þ N2
B1
Cq
0
B
B
@
1
C
C
A ¼ T6T5T4T3T1
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A:
ð6:162Þ
Indeed, there is T5T4T3T1 = T. Because of the unique properties of the solutions
of different combinations, any direct combinations of the solutions must be
equivalent to each other. No one combination will lead to a better solution or
greater precision of solutions than any other combination. From this rigorous
6.7  Equivalence of the Uncombined and Combining Algorithms
167

theoretical aspect, the traditional wide-lane ambiguity ﬁxing technique may lead to
a more effective search, but not a better solution and precision of the ambiguity.
6.7.3
Secondary GPS Data Processing Algorithms
In the Case of More Satellites in View
Up to now, the discussions have been limited for the observations of one satellite
viewed by one receiver at one epoch. The original observation equation is given in
Eq. 6.134. The solution vector and its covariance matrix are given in Eqs. 6.138
and 6.139, respectively. The elements of the covariance matrix depend on the
coefﬁcients of Eq. 6.134, and the coefﬁcients of the observation equation depend on
the method of parameterisation. For example, if instead of B1, Bz
1 is used, then
Eq. 6.134 becomes
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A ¼
0
0
Fkf 2
s =f 2
1
1
0
0
Fkf 2
s =f 2
2
1
1
0
Fkf 2
s =f 2
1
1
0
1
Fkf 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1ðkÞ
k2N2ðkÞ
Bz
1
CqðkÞ
0
B
B
@
1
C
C
A;
ð6:163Þ
where k is the index of the satellite. Ionospheric mapping function Fk is dependent
on the zenith distance of the satellite k. The solution vector of Eq. 6.163 is then
similar to that of Eq. 6.138:
k1N1ðkÞ
k2N2ðkÞ
Bz
1
CqðkÞ
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=qk
1=qk
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A;
Q k
ð Þ;
ð6:164Þ
where qk = qFk and Q(k) is the covariance matrix, which can be similarly derived
and given by adding the index k to q in Q of Eq. 6.139. The terms on the right-hand
side can be considered secondary “observations” of the unknowns on the left-hand
side. If K satellites are viewed, one has the observation equations of one receiver
168
Chapter 6  GPS Observation Equations and Equivalence Properties

k1N1ð1Þ
k2N2ð1Þ
Bz
1
Cqð1Þ
...
k1N1ðKÞ
k2N2ðKÞ
Bz
1
CqðKÞ
0
B
B
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
C
C
A
¼
1  2a
2b
1
0
. . .. . .:
0
0
0
0
2a
2a  1
0
1
. . .. . .:
0
0
0
0
1=q1
1=q1
0
0
. . .. . .:
0
0
0
0
a
b
0
0
. . .. . .:
0
0
0
0
...
...
...
...
. . .. . .
...
...
...
...
0
0
0
0
. . .. . .:
1  2a
2b
1
0
0
0
0
0
. . .. . .:
2a
2a  1
0
1
0
0
0
0
. . .. . .:
1=qK
1=qK
0
0
0
0
0
0
. . .. . .:
a
b
0
0
0
B
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
C
A
R1ð1Þ
R2ð1Þ
k1U1ð1Þ
k2U2ð1Þ
...
R1ðKÞ
R2ðKÞ
k1U1ðKÞ
k2U2ðKÞ
0
B
B
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
C
C
A
;
ð6:165Þ
and variance matrix
QK ¼
Qð1Þ
. . .. . .:
0
..
.
. . .. . .
..
.
0
. . .. . .:
QðKÞ
0
B
@
1
C
A:
ð6:166Þ
Multiplying a transformation matrix
TðKÞ ¼
1
0
0
0
. . .. . .:
0
0
0
0
0
1
0
0
. . .. . .:
0
0
0
0
0
0
1=K
0
. . .. . .:
0
0
1=K
0
0
0
0
1
. . .. . .:
0
0
0
0
..
.
..
.
..
.
..
.
. . .. . .
..
.
..
.
..
.
..
.
0
0
0
0
. . .. . .:
1
0
0
0
0
0
0
0
. . .. . .:
0
1
0
0
0
0
0
0
. . .. . .:
0
0
0
1
0
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
A
ð6:167Þ
to Eq. 6.165, one has the solutions of GPS observation equations of one station
k1N1ð1Þ
k2N2ð1Þ
Bz
1
Cqð1Þ
...
k1N1ðKÞ
k2N2ðKÞ
CqðKÞ
0
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
A
¼ TðKÞ
1  2a
2b
1
0
. . .. . .:
0
0
0
0
2a
2a  1
0
1
. . .. . .:
0
0
0
0
1=q1
1=q1
0
0
. . .. . .:
0
0
0
0
a
b
0
0
. . .. . .:
0
0
0
0
..
.
..
.
..
.
..
.
. . .. . .
..
.
..
.
..
.
..
.
0
0
0
0
. . .. . .:
1  2a
2b
1
0
0
0
0
0
. . .. . .:
2a
2a  1
0
1
0
0
0
0
. . .. . .:
1=qK
1=qK
0
0
0
0
0
0
. . .. . .:
a
b
0
0
0
B
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
C
A
R1ð1Þ
R2ð1Þ
k1U1ð1Þ
k2U2ð1Þ
..
.
R1ðKÞ
R2ðKÞ
k1U1ðKÞ
k2U2ðKÞ
0
B
B
B
B
B
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
C
C
C
C
C
A
;
ð6:168Þ
and the related
6.7  Equivalence of the Uncombined and Combining Algorithms
169

Q ¼ TðKÞQKðTðKÞÞT
ð6:169Þ
where mapping function is used to combine the K ionospheric parameters into one.
Similar discussions can be made for the cases of using more receivers. The original
observation vector and the so-called secondary “observation” vector are
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A;
k1N1ðkÞ
k2N2ðkÞ
B1ðkÞ
CqðkÞ
0
B
B
@
1
C
C
A:
ð6:170Þ
The two vectors are equivalent, as proved in Sect. 6.7.2, and they can be
uniquely transformed from one to the other. Any further data processing can be
considered processing based on the secondary “observations”. The secondary
“observations” own the equivalence property whether they are uncombined or
combining. Therefore the equivalence property is valid for further data processing
based on the secondary “observations”.
GPS Data Processing Using Secondary “Observations”
A by-product of the above equivalence discussions is that GPS data processing
can be performed directly using so-called secondary observations. In addition to the
two ambiguity parameters (scaled with the wavelengths), the other two secondary
observations are the electron density in the observation path (scaled by square of f1)
and the geometry. The geometry includes the whole observation model with the
exception of the ionospheric and ambiguity terms. For a time series of the sec-
ondary “observations”, the electron density (or, for simplicity, “ionosphere”) and
the “geometry” are real-time observations, whereas the “ambiguities” are constants
in case no cycle slip occurs (Langley 1998a, b). Sequential adjustment or ﬁltering
methods can be used to deal with the observation time series. It is worth noting that
the secondary “observations” are correlated with one another (see the covariance
matrix Eq. 6.139). However, the “ambiguities” are direct observations of the
ambiguity parameters, and the “ionosphere” and “geometry” are modelled by
Eqs. 6.132
and
6.133,
respectively.
The
“ambiguity”
observables
are
ionosphere-geometry-free. The “ionosphere” observable is geometry-free and
ambiguity-free. The “geometry” observable is ionosphere-free. But although some
algorithms may be more effective, the results and the precision of the solutions are
equivalent regardless of the algorithm used. It should be emphasised that all the
above discussions are based on the observation model 6.134. The problem con-
cerning the parameterisation of the GPS observation model will not affect the
conclusions of these discussions and will be further explored in Chap. 9.
Precision Analysis
If the sequential time series of the original observations are considered
time-independent,
as
they
traditionally
have
been,
then
the
secondary
170
Chapter 6  GPS Observation Equations and Equivalence Properties

“observations” and their precision are also independent time series. From
Eq. 6.140, the standard deviations of the L1 and L2 ambiguities are approximately
5.1281σc and 6.5317σc, respectively. The standard deviation of ionosphere and
geometry “observations” are about 2.1860σc and 2.9783σc, respectively. Thus the
precision of the “observed” ambiguities is lower than that of the others at one
epoch.
If
the
standard
deviation
of the
P
code
is
approximately
1 dm
(phase-smoothed), then the precision of the ambiguities determined by one epoch is
lower than 0.5 m. However, an average ﬁlter of m epoch data will raise the pre-
cision by a factor of sqrt(m) (square root of m). After 100 or 10,000 epochs, the
ambiguities are able to be determined with precision of about 5 cm or 5 mm.
“Ionospheric” effects are observed with better precision. However, due to the high
dynamic of the electron movements, ionospheric effects may not be easily
smoothed to improve precision. The “geometry” model is the most complicated,
and discussions on static, kinematic, and dynamic applications can be found in
numerous publications (cf., e.g., ION proceedings, Chap. 10).
6.7.4
Summary
Here, the equivalence properties between uncombined and combining algorithms
have been proved theoretically by algebraic linear transformations. The solution
vector and related covariance matrix are identical regardless of the algorithms used.
Different combinations can lead to a more effective and easier way of dealing with
the data. So-called ionosphere-geometry-free and diagonal combinations have been
derived, which have better properties than those of the traditional combinations.
A data processing algorithm using the uniquely transformed secondary “observa-
tions” has been outlined and used to prove the equivalence. Because of the unique
properties of solutions for different combinations, any direct combination of solu-
tions must be equivalent to each other. No one combination will yield a better
solution or one with greater precision than any other combination. In this respect,
the traditional wide-lane ambiguity ﬁxing technique may lead to a more effective
search of ambiguity, but it will not lead to a better solution and precision of the
ambiguity. The equivalence of the uncombined and combining algorithms can be
called Xu’s equivalence theory of GNSS data combinations (Xu 2003, 2007).
6.7  Equivalence of the Uncombined and Combining Algorithms
171

6.8
Equivalence of Undifferenced and Differencing Algorithms
In Sect. 6.6, the single, double, and triple differences and their related observation
equations were discussed. The number of unknown parameters in the equations was
greatly reduced through difference forming; however, the covariance derivations are
tedious, especially for a GPS network.
In this section, a uniﬁed GPS data processing method based on equivalently
eliminated equations is proposed, and the equivalence between undifferenced and
differencing algorithms is proved. The theoretical background of the method is also
given. By selecting the eliminated unknown vector as a vector of zero, a vector of
satellite clock error, a vector of all clock error, a vector of clock and ambiguity
parameters, or a vector of user-deﬁned unknowns, the respective selectively elim-
inated equivalent observation equations can be formed. The equations are equiva-
lent to the zero-, single-, double-, triple-, or user-deﬁned differencing equations.
The advantage in such a technique is that the different GPS data processing methods
are uniﬁed into one unique method, while the original observation vector is
retained, and the weight matrix maintains the uncorrelated diagonal form. In other
words, the use of this equivalent method allows one to selectively reduce the
unknown number, without having to deal with the complicated correlation problem.
Several special cases of single, double, and triple difference are discussed in detail
to illustrate the theory. The reference-related parameters are dealt with using the a
priori datum method.
6.8.1
Introduction
In practice, the common methods for GPS data processing are the so-called
zero-difference
(non-differential),
single-difference,
double-difference,
and
triple-difference methods (Bauer 1994; Hofmann-Wellenhof et al. 1997; King et al.
1987; Leick 1995; Remondi 1984; Seeber 1993; Strang and Borre 1997; Wang
et al. 1988). It is well known that the observation equations of the differencing
methods can be obtained by carrying out a related linear transformation to the
original equations. When the weight matrix is similarly transformed according to
the law of covariance propagation, all methods are equivalent theoretically.
A theoretical proof of the equivalence between the non-differential and differential
methods was described by Schaffrin and Grafarend (1986). A comparison of the
advantages and disadvantages of the non-differential and differential methods can
be found, for example, in de Jong (1998). The advantage of the differential methods
is that there are fewer unknown parameters, and the whole problem to be solved
thus becomes smaller. The disadvantage of the differential methods is that there is a
172
Chapter 6  GPS Observation Equations and Equivalence Properties

correlation problem that appears in cases of multiple baselines of single difference
and in all double as well as triple differences. The correlation problem is often
complicated and difﬁcult to deal with exactly (compared with the uncorrelated
problem). The advantages and disadvantages reach a balance. If one wants to deal
with a reduced problem (cancellation of many unknowns), then one has to deal with
the correlation problem. As an alternative, we use the equivalent observation
equation approach to unify the non-differential and differential methods while
retaining all the advantages of both methods.
In the following sections, the theoretical basis of the equivalently eliminated
equations is presented, based on the derivation described by Zhou (1985). Several
cases are then discussed in detail to illustrate the theory. The reference-related
parameters are dealt with using the a priori datum method. A summary of the
selectively eliminated equivalent GPS data processing method is outlined at the
end.
6.8.2
Formation of Equivalent Observation Equations
For convenience of later discussion, the method for forming an equivalently
eliminated equation system is outlined here. The theory is given in Sect. 7.6 in
detail. In practice, there may be only one group of unknowns of interest, and it is
better to eliminate the other group of unknowns (called nuisance parameters), for
example, because of their size. In this case, the use of the so-called equivalently
eliminated observation equation system can be very beneﬁcial (Wang et al. 1988;
Xu and Qian 1986; Zhou 1985). The nuisance parameters can be eliminated directly
from the observation equations instead of from the normal equations.
The linearised observation equation system can be represented using the matrix
V ¼ L  A
B
ð
Þ
X1
X2

	
and
P;
ð6:171Þ
where L is an observation vector of dimension n, A and B are coefﬁcient matrices of
dimension n × (s −r) and n × r, X1 and X2 are unknown vectors of dimension
s −r and r, V is residual error, s is the total number of unknowns, and P is the
weight matrix of dimension n × n.
The related least squares normal equation can then be formed as
A
B
ð
ÞTP A
B
ð
Þ
X1
X2

	
¼
A
B
ð
ÞTPL
ð6:172Þ
6.8  Equivalence of Undifferenced and Differencing Algorithms
173

or
M11X1 þ M12X2 ¼ B1
and
ð6:173Þ
M21X1 þ M22X2 ¼ B2;
ð6:174Þ
where
B1 ¼ ATPL;
B2 ¼ BTPL
and
ATPA
ATPB
BTPA
BTPB

	
¼
M11
M12
M21
M22

	
:
ð6:175Þ
After eliminating the unknown vector X1, the eliminated equivalent normal
equation system is then
M2X2 ¼ R2;
ð6:176Þ
where
M2 ¼ M21M1
11 M12 þ M22 ¼ BTPB  BTPAM1
11 ATPB
and
ð6:177Þ
R2 ¼ B2  M21M1
11 B1
ð6:178Þ
The related equivalent observation equation of Eq. 6.176 is then (cf. Sect. 7.6;
Xu and Qian 1986; Zhou 1985)
U ¼ L  ðE  JÞBX2;
P;
ð6:179Þ
where
J ¼ AM1
11 ATP:
ð6:180Þ
E is an identity matrix of size n, L and P are the original observation vector and
weight matrix, and U is the residual vector, which has the same property as V in
Eq. 6.171. The advantage of using Eq. 6.179 is that the unknown vector X1 has
been eliminated; however, L vector and P matrix remain the same as the originals.
Similarly, the X2-eliminated equivalent equation system is
U1 ¼ L  ðE  KÞAX1
and
P;
ð6:181Þ
where
K ¼ BM1
22 BTP;
M22 ¼ BTPB;
and U1 is the residual vector (which has the same property as V).
We have separated the observation Eq. 6.171 into two equations, Eqs. 6.179 and
6.181; each equation contains only one of the unknown vectors. Each unknown
174
Chapter 6  GPS Observation Equations and Equivalence Properties

vector can be solved independently and separately. Equations 6.179 and 6.181 are
called equivalent observation equations of Eq. 6.171.
The equivalence property of Eqs. 6.171 and 6.179 is valid under three implicit
assumptions. The ﬁrst is that an identical observation vector is used, the second is
that the parameterisation of X2 is identical, and the third is that the X1 is able to be
eliminated. Otherwise, the equivalence does not hold.
6.8.3
Equivalent Equations of Single Differences
In this section, equivalent equations are ﬁrst formed to eliminate the satellite clock
errors from the original zero-difference equations, and then the equivalence of the
single differences (in two cases) related to the original zero-difference equations is
proved.
Single differences cancel all satellite clock errors out of the observation equa-
tions. This can also be achieved by forming equivalent equations where satellite
clock errors are eliminated. Considering Eq. 6.171 the original observation equa-
tion, and X1 the vector of satellite clock errors, the equivalent equations of single
differences can be formed as outlined in Sect. 6.8.2.
Suppose n common satellites (k1, k2,…, kn) are observed at stations i1 and i2.
The original observation equation can then be written as
Vi1
Vi2

	
¼
Li1
Li2

	

E
Bi1
E
Bi2

	

X1
X2

	
and
P ¼ 1
r2
E
0
0
E

	
;
ð6:182Þ
where X1 is the vector of satellite clock errors and X2 is the vector of other
unknowns. For simplicity, clock errors are scaled by the speed of light c and
directly used as unknowns; the X1-related coefﬁcient matrix is then an identity
matrix, E.
Comparing Eq. 6.182 with Eq. 6.171, one has (cf. Sect. 6.8.2)
A ¼
E
E

	
;
B ¼
Bi1
Bi2

	
;
L ¼
Li1
Li2

	
and
V ¼
Vi1
Vi2

	
;
and
6.8  Equivalence of Undifferenced and Differencing Algorithms
175

M11 ¼
E
E
ð
Þ 1
r2
E
0
0
E

	
E
E

	
¼ 2
r2 E;
J ¼
E
E

	 r2
2 E E
E
ð
ÞP ¼ 1
2
E
E
E
E

	
;
E2n2n  J ¼ 1
2
E
E
E
E

	
and
E2n2n  J
ð
ÞB ¼ 1
2
Bi1  Bi2
Bi2  Bi1

	
:
So the equivalently eliminated equation system of Eq. 6.182 is
Ui1
Ui2

	
¼
Li1
Li2

	
 1
2
Bi1  Bi2
Bi2  Bi1

	
 X2;
P ¼ 1
r2
E
0
0
E

	
;
ð6:183Þ
where the satellite clock error vector X1 is eliminated, and the observable vector and
weight matrix are unchanged.
Denoting Bs = Bi2 −Bi1, the least squares normal equation of Eq. 6.183 can
then be formed as (cf. Chap. 7) (suppose Eq. 6.183 is solvable)
1
2 BT
s
BT
s


 P 
Bs
Bs

	
 X2 ¼
BT
s
BT
s


 P 
Li1
Li2

	
or
BT
s Bs  X2 ¼ BT
s ðLi2  Li1Þ:
ð6:184Þ
Alternatively, a single-difference equation can be obtained by multiplying
Eq. 6.182 with a transformation matrix Cs
Cs ¼
E
E
ð
Þ;
giving
Cs 
Vi1
Vi2

	
¼ Cs 
Li1
Li2

	
 Cs 
E
Bi1
E
Bi2

	

X1
X2

	
or
Vi2  Vi1 ¼ ðLi2  Li1Þ  ðBi2  Bi1ÞX2
ð6:185Þ
and
176
Chapter 6  GPS Observation Equations and Equivalence Properties

covðSDðOÞÞ ¼ Csr2
E
0
0
E

	
CT
s ¼ 2r2E
and
Ps ¼ 1
2r2 E;
ð6:186Þ
where Ps is the weight matrix of single differences, and cov(SD(O)) is the
covariance of the single-difference (SD)
observation vector (O). Supposing
Eq. 6.185 is solvable, the least squares normal equation system of Eq. 6.185 is then
ðBi2  Bi1ÞTðBi2  Bi1ÞX2 ¼ ðBi2  Bi1ÞTðLi2  Li1Þ:
ð6:187Þ
It is clear that Eqs. 6.187 and 6.184 are identical. Therefore, in the case of two
stations, the single-difference Eq. 6.185 is equivalent to the equivalently eliminated
Eq. 6.183, and is consequently equivalent to the original zero-difference equation.
Suppose n common satellites (k1, k2,…, kn) are observed at stations i1, i2 and i3.
The original observation equation can then be written as
Vi1
Vi2
Vi3
0
@
1
A ¼
Li1
Li2
Li3
0
@
1
A 
E
Bi1
E
Bi2
E
Bi3
0
@
1
A 
X1
X2

	
and
P ¼ 1
r2
E
0
0
0
E
0
0
0
E
0
@
1
A:
ð6:188Þ
Comparing Eq. 6.188 with Eq. 6.171, one has (cf. Section 6.8.2)
A ¼
E
E
E
0
@
1
A;
B ¼
Bi1
Bi2
Bi3
0
@
1
A;
L ¼
Li1
Li2
Li3
0
@
1
A
and
V ¼
Vi1
Vi2
Vi3
0
@
1
A;
and
M11 ¼ ATPA ¼ 3
r2 E;
J ¼ A r2
3 EATP ¼ 1
3
E
E
E
E
E
E
E
E
E
0
B
@
1
C
A;
E3n3n  J ¼ 1
3
2E
E
E
E
2E
E
E
E
2E
0
B
@
1
C
A;
and
E3n3n  J
ð
ÞB ¼ 1
3
2Bi1  Bi2  Bi3
Bi1 þ 2Bi2  Bi3
Bi1  Bi2 þ 2Bi3
0
B
@
1
C
A:
So the equivalently eliminated equation system of Eq. 6.188 is
6.8  Equivalence of Undifferenced and Differencing Algorithms
177

Ui1
Ui2
Ui3
0
@
1
A ¼
Li1
Li2
Li3
0
@
1
A  1
3
2Bi1  Bi2  Bi3
Bi1 þ 2Bi2  Bi3
Bi1  Bi2 þ 2Bi3
0
@
1
A  X2;
P ¼ 1
r2
E
0
0
0
E
0
0
0
E
0
@
1
A;
ð6:189Þ
and the related least squares normal equation can be formed as
1
3
2Bi1  Bi2  Bi3
Bi1 þ 2Bi2  Bi3
Bi1  Bi2 þ 2Bi3
0
@
1
A
T
2Bi1  Bi2  Bi3
Bi1 þ 2Bi2  Bi3
Bi1  Bi2 þ 2Bi3
0
@
1
AX2
¼
2Bi1  Bi2  Bi3
Bi1 þ 2Bi2  Bi3
Bi1  Bi2 þ 2Bi3
0
@
1
A
T
Li1
Li2
Li3
0
@
1
A:
ð6:190Þ
Alternatively, for Eq. system 6.188, single differences can be formed using
transformation (cf. Sect. 6.6.1)
Cs ¼
E
E
0
0
E
E

	
and
Ps ¼ ½covðSDÞ1 ¼ 1
3r2
2E
E
E
2E

	
:
The correlation problem appears in the case of single differences of multiple
baselines. The related observation equations and the least squares normal equation
can be written as
Vi2  Vi1
Vi3  Vi2

	
¼
Li2  Li1
Li3  Li2

	

Bi2  Bi1
Bi3  Bi2

	
X2;
Ps
and
ð6:191Þ
Bi2  Bi1
Bi3  Bi2

	T
2E
E
E
2E

	
Bi2  Bi1
Bi3  Bi2

	
X2
¼
Bi2  Bi1
Bi3  Bi2

	T
2E
E
E
2E

	
Li2  Li1
Li3  Li2

	
:
ð6:192Þ
Equations 6.190 and 6.192 are identical. This may be proved by expanding both
equations and comparing the results. Again, this shows that the equivalently
eliminated equations are equivalent to the single-difference equations, but without
the need to deal with the correlation problem.
178
Chapter 6  GPS Observation Equations and Equivalence Properties

6.8.4
Equivalent Equations of Double Differences
Double differences cancel all clock errors out of the observation equations. This can
also be achieved by forming equivalent equations where all clock errors are
eliminated. Considering Eq. 6.171 the original observation equation, and X1 the
vector of all clock errors, the equivalent equation of double differences can be
formed as outlined in Sect. 6.8.2.
In the case of two stations, supposing n common satellites (k1, k2,…, kn) are
observed at station i1 and i2, the equivalent single-difference observation equation
is then Eq. 6.183. Denoting Bs1 = Bi2 −Bi1, the station clock error parameter as
δti1 −δti2 (cf. Eqs. 6.89–6.92), and assigning the coefﬁcients of the ﬁrst column to
the station clock errors, i.e. Bs1 = (In×1 Bs), Eq. 6.183 turns out to be
Ui1
Ui2

	
¼
Li1
Li2

	
 1
2
In1
Bs
In1
Bs

	
Xc
X3

	
and
P ¼ 1
r2
E
0
0
E

	
;
ð6:193Þ
where Xc is the station clock error vector, X3 is the other unknown vector, Bs is the
X3-related coefﬁcient matrix, In1 is a 1 matrix (where all elements are 1), and clock
errors are scaled by the speed of light.
Comparing Eq. 6.193 with Eq. 6.171, one has (cf. Sect. 6.8.2)
A ¼ 1
2
In1
In1

	
;
B ¼ 1
2
Bs
Bs

	
;
L ¼
Li1
Li2

	
and
V ¼
Ui1
Ui2

	
;
and
M11 ¼ 1
4 IT
n1
IT
n1

 1
r2
E
0
0
E

	
In1
In1

	
¼ n
2r2 ;
J ¼
In1
In1

	 r2
2n IT
n1
IT
n1


 P ¼ 1
2n
Inn
Inn
Inn
Inn

	
;
and
E2n2n  J
ð
Þ 1
2
Bs
Bs

	
¼ 1
2
Enn þ 1
n Inn
Enn  1
n Inn
 
!
Bs:
So the equivalently eliminated equation system of Eq. 6.193 is
Ui1
Ui2

	
¼
Li1
Li2

	
 1
2
Enn þ 1
n Inn
Enn  1
n Inn

	
BsX3
and
P ¼ 1
r2
E
0
0
E

	
;
ð6:194Þ
where the receiver clock error vector Xc is eliminated, observable vector and weight
matrix are unchanged. The normal equation has a simple form of
6.8  Equivalence of Undifferenced and Differencing Algorithms
179

BT
s
Enn  1
n Inn

	
BsX3 ¼ BT
s
Enn  1
n Inn

	
Li2  Li1
ð
Þ:
ð6:195Þ
Alternatively, the traditional single-difference observation Eqs. 6.185 and 6.186
can be rewritten as
Vi2  Vi1 ¼ ðLi2  Li1Þ  In1
Bs
ð
Þ
Xc
X3

	
or
V1
i2  V1
i1
Vk
i2  Vk
i1

	
¼
L1
i2  L1
i1
Lk
i2  Lk
i1

	

1
B1
s
Im1
Bk
s

	
Xc
X3

	
ð6:196Þ
and
covðSDðOÞÞ ¼ Csr2
E
0
0
E

	
CT
s ¼ 2r2E
and
Ps ¼ 1
2r2 E;
where m = n −1, and the superscript 1 and k denote the ﬁrst row and remaining
rows of the matrices (or columns in case of vectors), respectively. The
double-difference transformation matrix and covariance are (cf. Sect. 6.6.2,
Eqs. 6.116–6.118)
Cd ¼
Im1
E mm


;
covðDDðOÞÞ ¼ Cd covðSDðOÞÞCT
d ¼ 2r2CdCT
d ¼ 2r2 Imm þ Emm
ð
Þ
and
Pd ¼ ½covðDDðOÞÞ1 ¼
1
2r2n nEmm  Imm
ð
Þ:
The double-difference observation equation and related normal equation are
Cd
V1
i2  V1
i1
Vk
i2  Vk
i1

	
¼ Cd
L1
i2  L1
i1
Lk
i2  Lk
i1

	
 Cd
1
B1
s
Im1
Bk
s

	
Xc
X3

	
or
Cd
V1
i2  V1
i1
Vk
i2  Vk
i1

	
¼ Cd
L1
i2  L1
i1
Lk
i2  Lk
i1

	
 Cd
B1
s
Bk
s

	
X3;
i.e.
CdðVi2  Vi1Þ ¼ CdðLi2  Li1Þ  CdBsX3
ð6:197Þ
180
Chapter 6  GPS Observation Equations and Equivalence Properties

and
BT
s CT
d PdCdBsX3 ¼ BT
s CT
d PdCdðLi2  Li1Þ;
ð6:198Þ
where
CT
d PdCd ¼
1
2r2n Im1
E mm

T nEmm  Imm
ð
Þ Im1
E mm


;
ð6:199Þ
Im1
E mm

T nEmm  Imm
ð
Þ ¼
Im1
nE mm  Imm

T
and ð6:200Þ
Im1
nE mm  Imm

T Im1
E mm


¼ nEnn  Inn:
ð6:201Þ
The above three equations can be readily proved. Substituting Eqs. 6.199–6.201
into Eqs. 6.198, 6.198 then becomes the same as Eq. 6.195, thus proving the
equivalence between the double-difference equation and the directly formed
equivalent Eq. 6.193.
6.8.5
Equivalent Equations of Triple Differences
Triple differences cancel all clock errors and ambiguities out of the observation
equations. This can also be achieved by forming equivalent equations where all
clock errors and ambiguities are eliminated. Considering Eq. 6.171 the original
observation equation, and X1 the parameter vector of all clock errors and ambi-
guities, the equivalent equations of triple differences can then be formed as outlined
in Sect. 6.8.2.
It is well known that traditional triple differences are correlated between adjacent
epochs and between baselines. In the case of sequential (epoch-by-epoch) data
processing of triple differences, the correlation problem is difﬁcult to deal with.
However, with the use of the equivalently eliminated equations, the weight matrix
remains diagonal, and the original GPS observables are retained.
An alternative method for proving the equivalence between triple differences and
zero-difference is proposed and derived in Xu (2016). Considering the deﬁnition of
triple differences and Eq. 6.120 given in Sect. 6.6.3, the triple-difference equation
can be rearranged as
TDk1;k2
i1;i2 ðOðt1; t2ÞÞ ¼
Ok2
i2 ðt2Þ  Ok2
i2 ðt1Þ


 Ok2
i1 ðt2Þ  Ok2
i1 ðt1Þ





Ok1
i2 ðt2Þ  Ok1
i2 ðt1Þ


 Ok1
i1 ðt2Þ  Ok1
i1 ðt1Þ




¼ ðDt  Ok2
i2  Dt  Ok2
i1 Þ  ðDt  Ok1
i2  Dt  Ok1
i1 Þ;
ð6:202Þ
6.8  Equivalence of Undifferenced and Differencing Algorithms
181

where Dt represents the time difference observables between time t1 and t2.
From Eq. 6.202, triple differences can be regarded ﬁrst as forming the time
difference of the same satellite between two adjacent epochs at the station, and then
to be formed by double differences between two single differences related to two
observed satellites. The time difference equation is proved to be equivalent to the
zero-difference equation in Xu (2016), and the time-differenced observable between
two adjacent epochs has the same property as the original one, which is still
uncorrelated. Moreover, considering the equivalence between the double-difference
and zero-difference equations (cf. Sect. 6.8.4), we can thus conclude that the
triple-difference equation is equivalent to the zero-difference equation.
6.8.6
Method of Dealing with the Reference Parameters
In differential GPS data processing, the reference-related parameters are usually
considered to be known and are ﬁxed (or not adjusted). This may be realised by the
a priori datum method (for details cf. Sect. 7.8.2). Here we outline only the basic
principle.
The equivalent observation Eq. system 6.179 can be rewritten as
U ¼ L  D1
D2
ð
Þ
X21
X22

	
and
P;
ð6:203Þ
where
D ¼
D1
D2
ð
Þ
and
X2 ¼
X21
X22

	
:
Suppose there are a priori constraints of (cf. e.g. Zhou et al. 1997)
W ¼ X22  X22
and
P2;
ð6:204Þ
where X22 is the “directly observed” parameter sub-vector, P2 is the weight matrix
with respect to the parameter sub-vector X22, and W is a residual vector, which has
the same property as U. Typically, X22 is “observed” independently, so P2 is a
diagonal matrix. If X22 is a sub-vector of station coordinates, then the constraint of
Eq. 6.204 is referred to as a datum constraint (this is also the reason that the term a
priori datum is used). Here we consider X22 a vector of reference-related parameters
(such as clock errors and ambiguities of the reference satellite and reference sta-
tion). Generally, the a priori weight matrix P2 is given by covariance matrix QW and
182
Chapter 6  GPS Observation Equations and Equivalence Properties

P2 ¼ Q1
W :
ð6:205Þ
In practice, the sub-vector X22 is usually a zero vector; this can be achieved
through careful initialisation by forming observation Eq. 6.171.
A least squares normal equation of the a priori datum problem of Eqs. 6.203 and
6.204 can be formed (cf. Sect. 7.8.2). Compared with the normal equation of Eq. 6.
203, the only difference is that the a priori weight matrix P2 has been added to the
normal matrix. This indicates that the a priori datum problem can be dealt with
simply by adding P2 to the normal equation of observation Eq. 6.203.
If some diagonal components of the weight matrix P2 are set to zero, the related
parameters (in X22) are then free parameters (or free datum) of the adjustment
problem (without a priori constraints). Otherwise, parameters with a priori con-
straints are called a priori datum. Large weight values indicate strong constraint and
small weight values indicate soft constraint. The strongest constraint is keeping the
datum ﬁxed. The reference-related datum (coordinates and clock errors as well as
ambiguities) can be ﬁxed by applying the strongest constraints to the related
parameters, i.e. by adding the strongest constraints to the datum-related diagonal
elements of the normal matrix.
6.8.7
Summary of the Uniﬁed Equivalent Algorithm
For any linearised zero-difference GPS observation Eq. system 6.171
V ¼ L  A
B
ð
Þ
X1
X2

	
and
P;
ð6:206Þ
the X1-eliminated equivalent GPS observation equation system is then Eq. 6.179:
U ¼ L  ðE  JÞBX2
and
P;
ð6:207Þ
where
J ¼ AM1
11 ATP;
M11 ¼ ATPA;
E is an identity matrix, L is original observation vector, P is original weight matrix,
and U is residual vector, which has the same property as V.
Similarly, the X2 eliminated equivalent equation system is Eq. 6.181
U1 ¼ L  ðE  KÞAX1
and
P;
ð6:208Þ
where
6.8  Equivalence of Undifferenced and Differencing Algorithms
183

K ¼ BM1
22 BTP;
M22 ¼ BTPB;
and U1 is the residual vector (which has the same property as V).
Fixing the values of sub-vector X22 (of X2) can be realised by adding the
strongest constraints to the X22-related diagonal elements of the normal matrix
formed by Eq. 6.207. Alternatively, we may ﬁrst apply the strongest constraints
directly to the normal equation formed by Eq. 6.206. In this way, the
reference-related parameters (clock errors, ambiguities, coordinates, etc.) are ﬁxed.
We may then form the equivalently eliminated observation Eq. 6.207. Thus, rela-
tive and differential GPS data processing can be realised by using Eq. 6.207 after
selecting the X1 to be eliminated.
The GPS data processing algorithm using Eq. 6.207 is then a selectively elim-
inated equivalent method. Selecting X1 in Eq. 6.206 as a zero vector, the algorithm
is identical to the zero-difference method. Selecting X1 in Eq. 6.206 as the satellite
clock error vector, the vector of all clock errors, the clock error and ambiguity
vector,
and
any
user-deﬁned
vector,
the
algorithm
is
equivalent
to
the
single-difference, double-difference, triple-difference, and user-deﬁned elimination
methods, respectively. The eliminated unknown X1 can be solved separately if
desired.
The advantages of this method (compared with non-differential and differential
methods) are as follows:
• Non-differential and differential GPS data processing can be dealt with in an
equivalent and uniﬁed way. The data processing scenarios can be selected by a
switch and used in a combinative way.
• The eliminated parameters can also be solved separately with the same
algorithm.
• The weight matrix remains the original diagonal one.
• The original observations are used; no differencing is required.
It is clear that the described algorithm has all the advantages of both
non-differential and differential GPS data processing methods. The equivalence
theory of the undifferenced and differencing GPS data processing algorithms may
be described as Xu’s equivalence theory.
References
Bauer M (1994) Vermessung und Ortung mit Satelliten. Wichmann Verlag, Karslruhe
Blewitt G (1998) GPS data processing methodology. In: Teunissen, P.J.G., and Kleusberg, A.
(eds), GPS for Geodesy, Springer-Verlag, Berlin, Heidelberg, New York, 231-270.
Bronstein
IN,
Semendjajew
KA
(1987)
Taschenbuch
der
Mathematik.B.
G.
Teubner
Verlagsgesellschaft, Leipzig, ISBN 3-322-00259-4
Jong PJ de (1998) A processing strategy of the application of the GPS in networks. PhD theis,
Nether-lands Geodetic Commision, Delft, The Netherland
184
Chapter 6  GPS Observation Equations and Equivalence Properties

Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997) GPS theory and practice. Springer-Press,
Wien
Hofmann-Wellenhof B, Lichtenegger H, Collins J (2001) GPS theory and practice. Springer-Press,
Wien
Hugentobler U, Schaer S, Fridez P (2001) Bernese GPS Software: Version 4.2. Astronomical Inst.
Univ. of Berne, Switzerland.
King RW, Masters EG, Rizos C, Stolz A, Collins J (1987) Surveying with Global Positioning
System. Dümmler-Verlag, Bonn
Koch KR (1988) Parameter estimation and hypothesis testing in linear models. Springer-Verlag,
Berlin
Kouba J, Heroux P (2001) Precise point positioning using IGS orbit and clock products. GPS
Solutions, 5(2):12-28
Langley RB (1998a) Propagation of the GPS signals. In: Kleusberg A, Teunissen PJG (eds) GPS
for geodesy. Springer-Verlag, Berlin
Langley RB (1998b) GPS receivers and the observables. In: Kleusberg A, Teunissen PJG
(eds) GPS for geodesy. Springer-Verlag, Berlin
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York
Leick A (2004) GPS Satellite Surveying (3rd ed.) xxiv + 664 p. John Wiley, New York, NY
Petovello MG (2006) Narrowlane: is it worth it? GPS Solutions, DOI 10.1007/s10291-006-0020-1
Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative
geodesy: Modelling, processing, and results. University of Texas at Austin, Center for Space
Research
Schaffrin B, Grafarend E (1986) Generating classes of equivalent linear models by nuisance
parameter elimination. Manuscr Geodaet 11:262–271
Seeber G (1993) Satelliten-Geodaesie. Walter de Gruyter 1989
Sjoeberg LE (1999) Unbiased vs biased estimation of GPS phase ambiguities from dual-frequency
code and phase observables. J Geodesy 73:118–124
Strang G, Borre K (1997) Linear algebra, geodesy, and GPS. Wellesley-Cambridge Press
Wang LX, Fang ZD, Zhang MY, Lin GB, Gu LK, Zhong TD, Yang XA, She DP, Luo ZH,
Xiao BQ, Chai H, Lin DX (1979) Mathematic handbook. Educational Press, Peking, ISBN
13012-0165
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese)
Xu G (2002) GPS data processing with equivalent observation equations, GPS Solutions, Vol. 6,
No. 1-2, 6:28-33
Xu G (2003) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English
Xu G (2004) MFGsoft – Multi-Functional GPS/(Galileo) Software – Software User Manual,
(Version of 2004), Scientiﬁc Technical Report STR04/17 of GeoForschungsZentrum
(GFZ) Potsdam, ISSN 1610-0956, 70 pages, www.gfz-potsdam.de/bib/pub/str0417/0417.pdf
Xu G (2007) GPS – Theory, Algorithms and Applications, second edition, Springer Heidelberg,
ISBN 978-3-540-72714-9, 350 pages, in English
Xu Y (2016) GNSS Precise Point Positioning with Application of Equivalence Principle.
Dissertation, Technical University of Berlin, Berlin, Germany
Xu G, Qian Z (1986) The application of block elimination adjustment method for processing of the
VLBI Data. Crustal Deformation and Earthquake, Vol. 6, No. 4, (in Chinese)
Xu G, Guo J, Yeh TK (2006a) Equivalence of the uncombined and combining GPS algorithms
Zhou J (1985) On the Jie factor. Acta Geodaetica et Geophysica 5 (in Chinese)
Zhou J, Huang Y, Yang Y, Ou J (1997) Robust least squares method. Publishing House of
Huazhong University of Science and Technology, Wuhan
Zumberge JF, Heﬂin MB, Jefferson DC, Watkins MM, Webb FH (1997) Precise point positioning
for the efﬁcient and robust analysis of GPS data from large networks. J. Geophysical Res., 102
(B3): 5005-5017.
References
185

Chapter 7
Adjustment and Filtering Methods
7.1
Introduction
In this chapter, we outline the most useful and necessary adjustment and ﬁltering
algorithms for statistical and kinematic as well as dynamic GPS data processing.
We derive the necessary estimators, and provide a detailed discussion of the rela-
tionships between the methods presented.
The adjustment algorithms discussed here include least squares adjustment,
sequential application of least squares adjustment via accumulation, sequential least
squares adjustment, conditional least squares adjustment, a sequential application of
conditional least squares adjustment, block-wise least squares adjustment, a
sequential application of block-wise least squares adjustment, a special application
of block-wise least squares adjustment for code–phase combinations, an equivalent
algorithm to form the eliminated observation equation system, and an algorithm to
diagonalise the normal and equivalent observation equations.
The ﬁltering algorithms discussed here include the classic Kalman ﬁlter, the
sequential least squares adjustment method as a special case of Kalman ﬁltering, the
robust Kalman ﬁlter, and the adaptively robust Kalman ﬁlter.
A priori constrained adjustment and ﬁltering are discussed for solving
rank-deﬁcient problems. After a general discussion on a priori parameter con-
straints, a special case of the so-called a priori datum method is provided.
A quasi-stable datum method is also discussed.
A summary is presented at the end of this chapter, and applications of the GPS
data processing methods discussed are outlined.
7.2
Least Squares Adjustment
The principle of least squares adjustment can be summarised as outlined below
(Gotthardt 1978; Cui et al. 1982):
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_7
187

1. The linearised observation equation system can be represented by
V ¼ L  AX; P
ð7:1Þ
where
L
observation vector of dimension m,
A
coefﬁcient matrix of dimension m × n,
X
unknown parameter vector of dimension n,
V
residual vector of dimension m,
n
number of unknowns,
m
number of observations, and
P
symmetric and deﬁnite weight matrix of dimension m × m.
2. The least squares criterion for solving the observation equations is well known
as
VTPV ¼ min;
ð7:2Þ
where
VT
the transpose of the related vector V.
3. To solve X and compute V, a function F is set as
F ¼ VTPV:
ð7:3Þ
The function F reaches minimum value if the partial differentiation of F with
respect to X equals zero, i.e.
@F
@X ¼ 2VTPðAÞ ¼ 0
or
ATPV ¼ 0;
ð7:4Þ
where
AT
transpose matrix of A.
4. Multiplying ATP with Eq. 7.1, one has
ATPAX  ATPL ¼ ATPV:
ð7:5Þ
Setting Eq. 7.4 into 7.5, one has
ATPAX  ATPL ¼ 0:
ð7:6Þ
5. For simpliﬁcation, let M = ATPA, Q = M−1, where superscript −1 is an inverse
operator, and M is usually called a normal matrix. The least squares solution of
Eq. 7.1 is then
188
Chapter 7  Adjustment and Filtering Methods

X ¼ QðATPLÞ:
ð7:7Þ
6. The precision of the ith element of the estimated parameter is
p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i½i
p
;
ð7:8Þ
where i is the element index of a vector or a matrix, m0 is the so-called standard
deviation (or sigma), p[i] is the ith element of the precision vector, Q[i][i] is the
ith diagonal element of the cofactor matrix Q, and
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n
r
;
if
ðm [ nÞ:
ð7:9Þ
7. For convenience of sequential computation, VTPV can be calculated by using
VTPV ¼ LTPL  ðATPLÞTX:
ð7:10Þ
This can be obtained by substituting Eq. 7.1 into VTPV and considering Eq. 7.4.
Thus far, we have derived the complete formulas of least squares adjustment.
7.2.1
Least Squares Adjustment with Sequential Observation
Groups
Suppose one has two sequential observation equation systems
V1 ¼ L1  A1X
and
ð7:11Þ
V2 ¼ L2  A2X;
ð7:12Þ
with weight matrices P1 and P2. These two equation systems are uncorrelated or
independent and have the common unknown vector X. The combined problem can
be represented as
V1
V2


¼
L1
L2



A1
A2


X
and
P ¼
P1
0
0
P2


:
ð7:13Þ
The least squares normal equation can be formed then as
AT
1
AT
2


P1
0
0
P2


A1
A2


X ¼
AT
1
AT
2


P1
0
0
P2


L1
L2


7.2  Least Squares Adjustment
189

or
ðAT
1P1A1 þ AT
2P2A2ÞX ¼ ðAT
1P1L1 þ AT
2P2L2Þ:
ð7:14Þ
This is indeed the accumulation of the two least squares normal equations
formed from Eqs. 7.11 and 7.12, respectively:
ðAT
1P1A1ÞX ¼ AT
1P1L1
and
ð7:15Þ
ðAT
2P2A2ÞX ¼ AT
2P2L2:
ð7:16Þ
The solution is then
X ¼ ðAT
1P1A1 þ AT
2P2A2Þ1ðAT
1P1L1 þ AT
2P2L2Þ:
ð7:17Þ
The precision of the ith element of the estimated parameter is
p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i½i
p
;
ð7:18Þ
where
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n
r
;
if
ðm [ nÞ; and
ð7:19Þ
Q ¼ ðAT
1P1A1 þ AT
2P2A2Þ1;
ð7:20Þ
where m is the number of total observations and n is the number of unknowns. And
VTPV can be calculated by using
VTPV ¼ VT
1 P1V1 þ VT
2 P2V2
¼ LT
1P1L1 þ LT
2P2L2  ðAT
1P1L1ÞTX  ðAT
2P2L2ÞTX:
¼ ðLT
1P1L1 þ LT
2P2L2Þ  ðAT
1P1L1 þ AT
2P2L2ÞTX
ð7:21Þ
Equation 7.17 indicates that the sequential least squares problem can be solved
by simply accumulating the normal equations of the observation equations. The
weighted squares residuals can also be computed by accumulating the individual
quadratic forms of the residuals using Eq. 7.21.
For further sequential and independent observation equation systems,
V1 ¼ L1  A1X;
P1;
ð7:22Þ
V2 ¼ L2  A2X;
P2;
ð7:23Þ
190
Chapter 7  Adjustment and Filtering Methods

. . .
Vi ¼ Li  AiX;
Pi;
ð7:24Þ
the solution can be similarly derived as
X ¼ ðAT
1P1A1 þ AT
2P2A2 þ    þ AT
i PiAiÞ1ðAT
1P1L1 þ AT
2P2L2 þ    þ AT
i PiLiÞ
ð7:25Þ
and
VTPV ¼ ðLT
1P1L1 þ LT
2P2L2 þ    þ LT
i PiLiÞ
 ðAT
1P1L1 þ AT
2P2L2 þ    þ AT
i PiLiÞTX:
ð7:26Þ
Obviously, if a solution is needed for every epoch, then the accumulated
equation system must be solved at each epoch. The accumulations must always be
made with the sequential normal equations. Of course, the solutions can be com-
puted after a deﬁned epoch or at the last epoch, which could be very useful if the
solution to the problem is unstable at the beginning.
7.3
Sequential Least Squares Adjustment
Recalling the discussions in Sect. 7.2, one has sequential observation equation
systems
V1 ¼ L1  A1X;
P1
and
ð7:27Þ
V2 ¼ L2  A2X;
P2:
ð7:28Þ
These two equation systems are uncorrelated. The sequential problem can then be
solved by accumulating the individual normal equations as discussed in Sect. 7.2:
ðAT
1P1A1 þ AT
2P2A2ÞX ¼ ðAT
1P1L1 þ AT
2P2L2Þ
or
ð7:29Þ
X ¼ ðAT
1P1A1 þ AT
2P2A2Þ1ðAT
1P1L1 þ AT
2P2L2Þ:
ð7:30Þ
And VTPV can be calculated by using
VTPV ¼ ðLT
1P1L1 þ LT
2P2L2Þ  ðAT
1P1L1 þ AT
2P2L2ÞTX:
ð7:31Þ
7.2  Least Squares Adjustment
191

If Eq. 7.27 is solvable, the least squares solution can then be represented as
X ¼ ðAT
1P1A1Þ1ðAT
1P1L1Þ
and
ð7:32Þ
VTPV ¼ LT
1P1L1  ðAT
1P1L1ÞTX:
ð7:33Þ
For convenience, the estimated vector of X using the ﬁrst group of observations
is denoted by X1 and the quadratic form of the residuals by (VTPV)1 as well as
Q1 ¼ ðAT
1P1A1Þ1.
Using the formula (Cui et al. 1982; Gotthardt 1978)
ðD þ ACBÞ1 ¼ D1  D1AKB D1;
ð7:34Þ
where A and B are any matrices, C and D are matrices that can be inverted and
K ¼ ðC1 þ B D1AÞ1;
ð7:35Þ
the inversion of the accumulated normal matrix can be represented as Q:
Q ¼ ðAT
1P1A1 þ AT
2P2A2Þ1
¼ ðAT
1P1A1Þ1  ðAT
1P1A1Þ1AT
2KA2ðAT
1P1A1Þ1 and
¼ Q1  Q1AT
2KA2Q1
¼ ðE  Q1AT
2KA2ÞQ1
ð7:36Þ
K ¼ ðP1
2 þ A2Q1AT
2Þ1;
ð7:37Þ
where E is an identity matrix. The total term in the parentheses on the right-hand
side of Eq. 7.36 can be interpreted as a modifying factor for Q1 matrix; in other
words, due to the sequential Eq. 7.28, the Q matrix can be computed by multi-
plying a factor to the Q1 matrix. Thus the sequential least squares solution of
Eqs. 7.27 and 7.28 can be obtained:
X ¼ ðQ1  Q1AT
2KA2Q1ÞðAT
1P1L1 þ AT
2P2L2Þ:
¼ ðE  Q1AT
2KA2ÞX1 þ QðAT
2P2L2Þ
ð7:38Þ
Mathematically, the solutions to the sequential problem of Eqs. 7.27 and 7.28
will be the same regardless of whether they are solved using accumulation of the
least squares, as discussed in Sect. 7.2.1, or using sequential adjustment, as dis-
cussed above. However, in practice, the accuracy of the computation is always
limited by the effective digits of the computer being used. Such limitations cause
inaccuracy in numerical computation, and this inaccuracy will be accumulated and
propagated in further computing processes. By comparing the results obtained with
the above-mentioned methods, we note that the sequential method will produce a
192
Chapter 7  Adjustment and Filtering Methods

drift in the results. This drift will increase with time and will generally become
non-negligible after a long time interval.
7.4
Conditional Least Squares Adjustment
The principle of least squares adjustment with condition equations can be sum-
marised as follows (Gotthardt 1978; Cui et al. 1982):
1. The linearised observation equation system can be represented by Eq. 7.1
(cf. Sect. 7.2).
2. The corresponding condition equation system can be written as
CX  W ¼ 0;
ð7:39Þ
where
C
coefﬁcient matrix of dimension r × n,
W
constant vector of dimension r, and
r
number of conditions.
3. The least squares criterion for solving the observation equations with condition
equations is well known as
VTPV ¼ min;
ð7:40Þ
where VT is the transpose of the related vector V.
4. To solve X and compute V, a function F can be formed as
F ¼ VTPV þ 2KTðCX  WÞ;
ð7:41Þ
where K is a gain vector (of dimension r) to be determined.
The function F reaches minimum value if the partial differentiation of F with
respect to X equals zero, i.e.
@F
@X ¼ 2VTPðAÞ þ 2KTC ¼ 0;
then one has
ATPV þ CTK ¼ 0
ð7:42Þ
or
ATPAX þ CTK  ATPL ¼ 0;
ð7:43Þ
where AT, CT are transposed matrices of A and C, respectively.
7.3  Sequential Least Squares Adjustment
193

5. Combining Eqs. 7.43 and 7.39, one has
ATPAX þ CTK  ATPL ¼ 0
and
ð7:44Þ
CX  W ¼ 0:
ð7:45Þ
6. For simpliﬁcation, let M = ATPA, W1 = ATPL, Q = M−1, where superscript −1 is
an inverse operator. The solutions of Eqs. 7.44 and 7.45 are then
K ¼ ðCQCTÞ1ðCQW1  WÞ;
X ¼ QðCTK  W1Þ
ð7:46Þ
or
X ¼ ðATPAÞ1ðATPLÞ  ðATPAÞ1CTK:
¼ ðATPAÞ1ðATPL  CTKÞ
ð7:47Þ
7. The precision of the solutions is then
p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Qc½i½i
p
;
ð7:48Þ
where i is the element index of a vector or a matrix,
ﬃ
p is the square root
operator, m0 is the so-called standard deviation (or sigma), p[i] is the ith element
of the precision vector, Qc[i][i] is the ith diagonal element of the quadratic
matrix Qc, and
Qc ¼ Q  QCTQ2CQ;
ð7:49Þ
Q2 ¼ ðCQCTÞ1
and
ð7:50Þ
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n þ r
s
;
if
ðm [ n  rÞ:
ð7:51Þ
8. For convenience of sequential computation, VTPV can be calculated using
VTPV ¼ LTPL  ðATPLÞTX  WTK:
ð7:52Þ
This can be obtained by substituting Eq. 7.1 into VTPV and using the relations
of Eqs. 7.39 and 7.42.
Thus far, we have derived the complete formulas of conditional least squares
adjustment.
194
Chapter 7  Adjustment and Filtering Methods

7.4.1
Sequential Application of Conditional Least Squares
Adjustment
Recalling the least squares adjustment discussed in Sect. 7.2, the linearised
observation equation system
V ¼ L  AX;
P
ð7:53Þ
has the solution
X ¼ ðATPAÞ1ðATPLÞ:
ð7:54Þ
The precision of the solutions can be obtained by
p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i½i
p
;
ð7:55Þ
where
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n
r
;
if
ðm [ nÞ;
ð7:56Þ
and VTPV can be calculated by using
VTPV ¼ LTPL  ðATPLÞTX:
ð7:57Þ
For convenience, the least squares solution vector is denoted by X0 and weighted
residuals square by (VTPV)0.
Similarly, in the conditional least squares adjustment discussed in Sect. 7.4, the
linearised observation equation system and conditional equations read
V ¼ L  AX
and
ð7:58Þ
CX  W ¼ 0;
ð7:59Þ
the solution follows
X ¼ ðATPAÞ1ðATPL  CTKÞ;
ð7:60Þ
where K is the gain, and
K ¼ ðCQCTÞ1ðCQW1  WÞ:
ð7:61Þ
7.4  Conditional Least Squares Adjustment
195

The precision vector of the solution vector can be obtained by using Eqs. 7.48–
7.52. Using the notations obtained in least squares solution, one has
X ¼ X0  QCTK
ð7:62Þ
and
VTPV ¼ ðVTPVÞ0 þ ðATPLÞTQCTK  WTK:
ð7:63Þ
Equation 7.62 indicates that the conditional least squares problem can be solved
ﬁrst without the conditions, and then through the gain K to compute a modiﬁcation
term. The change of the solution is caused by the conditions. For computing the
weighted squares of the residuals, Eq. 7.63 can be used (by adding two modiﬁ-
cation terms to the weighted squares of residuals of the least squares solution). This
property is very important for many practical applications such as ambiguity ﬁxing
or coordinates ﬁxing. For example, after the least squares solution and ﬁxing the
ambiguity values, one needs to compute the ambiguity ﬁxed solution. Of course,
one can put the ﬁxed ambiguities as known parameters and go back to solve the
problem once again. However, using the above formulas, one can use the ﬁxed
ambiguities as conditions to compute the gain and the modiﬁcation terms to get the
ambiguity ﬁxed solution directly. Similarly, this property can be also used for
solutions with some ﬁxed station coordinates.
7.5
Block-Wise Least Squares Adjustment
The principle of block-wise least squares adjustment can be summarised as follows
(Gotthardt 1978; Cui et al. 1982):
1. The linearised observation equation system can be represented by Eq. 7.1
(cf. Sect. 7.2).
2. The unknown vector X and observable vector L are rewritten as two
sub-vectors:
V1
V2


¼
L1
L2



A11
A12
A21
A22


X1
X2


and
P ¼
P1
0
0
P2


:
ð7:64Þ
The least squares normal equation can then be formed as
A11
A12
A21
A22

T
P1
0
0
P2


A11
A12
A21
A22


X1
X2


¼
A11
A12
A21
A22

T
P1
0
0
P2


L1
L2


:
ð7:65Þ
196
Chapter 7  Adjustment and Filtering Methods

The normal equation can be denoted by
M11
M12
M21
M22


X1
X2


¼
B1
B2


ð7:66Þ
or
M11X1 þ M12X2 ¼ B1
and
ð7:67Þ
M21X1 þ M22X2 ¼ B2;
ð7:68Þ
where
M11 ¼ AT
11P1A11 þ AT
21P2A21;
ð7:69Þ
M12 ¼ MT
21 ¼ AT
11P1A12 þ AT
21P2A22;
ð7:70Þ
M22 ¼ AT
12P1A12 þ AT
22P2A22;
ð7:71Þ
B1 ¼ AT
11P1L1 þ AT
21P2L2
and
ð7:72Þ
B2 ¼ AT
12P1L1 þ AT
22P2L2:
ð7:73Þ
3. Normal Eqs. 7.67 and 7.68 can be solved as follows: from Eq. 7.67, one has
X1 ¼ M1
11 ðB1  M12X2Þ:
ð7:74Þ
Substituting X1 into Eq. 7.68, one gets a normal equation related to the second
block of unknowns:
M2X2 ¼ R2;
ð7:75Þ
where
M2 ¼ M22  M21M1
11 M12
and
ð7:76Þ
R2 ¼ B2  M21M1
11 B1:
ð7:77Þ
The solution of Eq. 7.75 is then
X2 ¼ M1
2 R2:
ð7:78Þ
From Eqs. 7.78 and 7.74, the block-wise least squares solution of Eqs. 7.1 and
7.64 can be computed. For estimating the precision of the solved vector, one has
(see discussion in Sect. 7.2):
7.5  Block-Wise Least Squares Adjustment
197

p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i½i
p
ð7:79Þ
where
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n
r
;
if
ðm [ nÞ:
ð7:80Þ
Q is the inversion of the total normal matrix M. m is the number of total obser-
vations, and n is the number of unknowns.
Furthermore,
Q ¼
M11
M12
M21
M22

1
¼
Q11
Q12
Q21
Q22


is denoted;
ð7:81Þ
where (Gotthardt 1978; Cui et al. 1982)
Q11 ¼ ðM11  M12M1
22 M21Þ1;
ð7:82Þ
Q22 ¼ ðM22  M21M1
11 M12Þ1;
ð7:83Þ
Q12 ¼ M1
11 ðM12Q22Þ; and
ð7:84Þ
Q21 ¼ M1
22 ðM21Q11Þ:
ð7:85Þ
And VTPV can be calculated by using
VTPV ¼ LTPL  ðATPLÞTX:
ð7:86Þ
One ﬁnds very important applications in GPS data processing by separating the
unknowns into two groups, which will be discussed in the next sub-section.
7.5.1
Sequential Solution of Block-Wise Least Squares Adjustment
Suppose one has two sequential observation equation systems
Vt1 ¼ Lt1  At1Yt1
and
ð7:87Þ
Vt2 ¼ Lt2  At2Yt2;
ð7:88Þ
198
Chapter 7  Adjustment and Filtering Methods

with weight matrices Pt1 and Pt2. The unknown vector Y can be separated into two
sub-vectors; one is sequence-dependent and the other is time-independent. Let us
assume
Yt1 ¼
Xt1
X2


and
Yt2 ¼
Xt2
X2


;
ð7:89Þ
where X2 is the common unknown vector, and Xt1 and Xt2 are sequential (time)
independent unknowns (i.e. they are different from each other).
Equations 7.87 and 7.88 can be solved separately using the block-wise least
squares method, as follows (cf. Sect. 7.5):
Xt1 ¼ ðM11Þ1
t1 ðB1  M12X2Þt1;
ð7:90Þ
ðM2Þt1X2 ¼ ðR2Þt1
and
ð7:91Þ
X2 ¼ ðM2Þ1
t1 ðR2Þt1;
ð7:92Þ
and
Xt2 ¼ ðM11Þ1
t2 ðB1  M12X2Þt2;
ð7:93Þ
ðM2Þt2X2 ¼ ðR2Þt2
and
ð7:94Þ
X2 ¼ ðM2Þ1
t2 ðR2Þt2;
ð7:95Þ
where indices t1 and t2 outside of the parenthesis indicate that the matrices and
vectors are related to Eqs. 7.87 and 7.88, respectively.
The combined solution of Eqs. 7.87 and 7.88 then can be derived as
Xt1 ¼ ðM11Þ1
t1 ððB1Þt1  ðM12Þt1ðX2ÞtaÞ;
ð7:96Þ
Xt2 ¼ ðM11Þ1
t2 ððB1Þt2  ðM12Þt2ðX2ÞtaÞ;
ð7:97Þ
ððM2Þt1 þ ðM2Þt2ÞðX2Þta ¼ ðR2Þt1 þ ðR2Þt2
and
ð7:98Þ
ðX2Þta ¼ ððM2Þt1 þ ðM2Þt2Þ1ððR2Þt1 þ ðR2Þt2Þ;
ð7:99Þ
where index ta means that the solution is related to all equations. The normal
equations related to the common unknowns are accumulated and solved for. The
solved common unknowns are used for computing sequentially different unknowns.
In the case of many sequential observations, a combined solution could be
difﬁcult or even impossible because of the large number of unknowns and the
requirement of the computing capacities. Therefore, a sequential solution could be a
good alternative. For the sequential observation equations
7.5  Block-Wise Least Squares Adjustment
199

Vt1 ¼ Lt1  At1Yt1;
Pt1;
ð7:100Þ
Vti ¼ Lti  AtiYti;
Pti;
ð7:101Þ
the sequential solutions are
Xt1 ¼ ðM11Þ1
t1 ðB1  M12X2Þt1;
ð7:102Þ
ðM2Þt1X2 ¼ ðR2Þt1;
ð7:103Þ
X2 ¼ ðM2Þ1
t1 ðR2Þt1;
ð7:104Þ
Xti ¼ ðM11Þ1
ti ððB1Þti  ðM12ÞtiX2Þ;
ð7:105Þ
ððM2Þt1 þ    þ ðM2ÞtiÞX2 ¼ ðR2Þt1 þ    þ ðR2Þti;
and
ð7:106Þ
X2 ¼ ððM2Þt1 þ    þ ðM2ÞtiÞ1ððR2Þt1 þ    þ ðR2ÞtiÞ:
ð7:107Þ
It is notable that the sequential solution of the second unknown sub-vector X2 is
exactly the same as the combined solution at the last step. The only difference
between the combined solution and the sequential solution is that the X2 used are
different. In the sequential solution, only the up-to-date X2 is used. Therefore, at end
of the sequential solution (Eq. 7.107), the last obtained X2 has to be substituted into
all Xtj computing formulas, where j < i. This can be done in two ways. The ﬁrst way
is to remember all formulas for computing Xtj, after X2 is obtained from Eq. 7.107,
using X2 to compute Xtj. The second way is to go back to the beginning after the X2
is obtained, and use X2 as the known vector to solve Xtj once again. In these ways,
the combined sequential observation equations can be solved exactly in a sequential
way.
7.5.2
Block-Wise Least Squares for Code–Phase Combination
Recalling the block-wise observation equations discussed in Sect. 7.5, one has
V1
V2


¼
L1
L2



A11
A12
A21
A22


X1
X2


and
P ¼
P1
0
0
P2


:
ð7:108Þ
Such an observation equation can be used for solving the problem of code-phase
combination. Supposing L1 and L2 are phase and code observation vectors,
respectively, and they have the same dimensions, then X2 is a sub-vector that only
exists in phase observation equations. Then one has A22 = 0, and A11 = A21, as well
as P1 = wpP0, P2 = wcP0, where P0 is the weight matrix, and wp and wc are weight
200
Chapter 7  Adjustment and Filtering Methods

factors of phase and code observables. In order to keep the coefﬁcient matrices
A11 = A21,
the
observable
vectors
L1
and
L2
must
be
carefully
scaled.
Equation 7.108 can be rewritten as
V1
V2
 
!
¼
L1
L2
 
!

A11
A12
A11
0


X1
X2


and
P ¼
wpP0
0
0
wcP0


:
ð7:109Þ
The least squares normal equation can then be formed as
A11
A12
A11
0

T
wPP0
0
0
wcP0


A11
A12
A11
0


X1
X2


¼
A11
A12
A11
0

T
wPP0
0
0
wcP0


L1
L2
 
!
:
ð7:110Þ
The normal equation can be denoted by
M11
M12
M21
M22


X1
X2


¼
B1
B2


;
ð7:111Þ
where
M11 ¼ ðwp þ wcÞAT
11P0A11;
ð7:112Þ
M12 ¼ MT
21 ¼ wpAT
11P0A12;
ð7:113Þ
M22 ¼ wpAT
12P0A12;
ð7:114Þ
B1 ¼ AT
11P0ðwpL1 þ wcL2Þ;
and
ð7:115Þ
B2 ¼ wpAT
12P0L1:
ð7:116Þ
Normal Eq. 7.111 can be solved using the general formulas derived in Sects. 7.2
and 7.5.
7.6
Zhou’s Theory: Equivalently Eliminated Observation
Equation System
In least squares adjustment, the unknowns can be divided into two groups and then
solved in a block-wise manner, as discussed in Sect. 7.5. In practice, sometimes
only one group of unknowns is of interest, and it is better to eliminate the other
7.5  Block-Wise Least Squares Adjustment
201

group of unknowns (called nuisance parameters) because of its size, for example. In
this case, using the so-called equivalently eliminated observation equation system
could be very beneﬁcial (Wang et al. 1988; Xu and Qian 1986; Zhou 1985). The
nuisance parameters can be eliminated directly from the observation equations
instead of from the normal equations.
The linearised observation equation system can be represented by
V ¼ L  A
B
ð
Þ
X1
X2


;
P:
ð7:117Þ
where
L
observation vector of dimension m,
A, B
coefﬁcient matrices of dimension m × (n −r) and m × r,
X1, X2
unknown vectors of dimension n–r and r,
V
residual vector of dimension m,
n
number of total unknowns,
m
number of observations, and
P
symmetric and deﬁnite weight matrix, of dimension m × m.
The least squares normal equation can then be formed by
M11
M12
M21
M22


X1
X2


¼
B1
B2


;
ð7:118Þ
where
M11
M12
M21
M22


¼
ATPA
ATPB
BTPA
BTPB


;
ð7:119Þ
B1 ¼ ATPL ; B2 ¼ BTPL:
ð7:120Þ
The elimination matrix
E
0
Z
E


is formed,
ð7:121Þ
where E is the identity matrix, 0 is a zero matrix, and Z = M21M–
1
1
1. M–
1
1
1 is the
inversion of M11. Multiplying the elimination matrix Eq. 7.121 to the normal
Eq. 7.118 one has
E
0
Z
E


M11
M12
M21
M22


X1
X2


¼
E
0
Z
E


B1
B2


;
202
Chapter 7  Adjustment and Filtering Methods

or
M11
M12
0
M2


X1
X2


¼
B1
R2


ð7:122Þ
where
M2 ¼ M21M1
11 M12 þ M22
¼ BTPB  BTPAM1
11 ATPB ¼ BTPðE  AM1
11 ATPÞB:
ð7:123Þ
R2 ¼ B2  M21M1
11 B1 ¼ BTPðE  AM1
11 ATPÞL:
ð7:124Þ
If we are interested only in the unknown vector X2, then only the second
equation of Eq. 7.122 needs to be solved. The solution is identical to that obtained
by solving all of Eq. 7.122. The above elimination process is similar to the
Gauss-Jordan algorithm, which has often been used for the inversion of the normal
matrix (or for solving linear equation systems). Indeed, the second equation of
Eq. 7.122 is identical to Eq. 7.75 derived in the block-wise least squares adjustment
(cf. Section 7.5).
Letting
J ¼ AM1
11 ATP;
ð7:125Þ
one has properties of
J2 ¼ ðAM1
11 ATPÞðAM1
11 ATPÞ ¼ AM1
11 ATP AM1
11 ATP ¼ AM1
11 ATP ¼ J;
ðE  JÞðE  JÞ ¼ E2  2EJ þ J2 ¼ E  2J þ J ¼ E  J
and
PðE  JÞ
½
T¼ ðE  JTÞP ¼ P  ðAM1
11 ATPÞTP ¼ P  PAM1
11 ATP ¼ PðE  JÞ;
i.e. matrices J and (E–J) are idempotent and (E–J)TP is symmetric, or
J2 ¼ J;
ðE  JÞ2 ¼ E  J
and
ðE  JÞTP ¼ PðE  JÞ:
ð7:126Þ
Using the above derived properties, M2 in Eq. 7.123 and R2 in Eq. 7.124 can be
rewritten as
M2 ¼ BTPðE  JÞB ¼ BTPðE  JÞðE  JÞB ¼ BTðE  JÞTPðE  JÞB
and
ð7:127Þ
R2 ¼ BTPðE  JÞL ¼ BTðE  JÞTPL:
ð7:128Þ
7.6  Zhou’s Theory: Equivalently Eliminated Observation Equation System
203

Denoting
D2 ¼ ðE  JÞB;
ð7:129Þ
then the eliminated normal equation (the second equation of Eq. 7.122) can be
rewritten as
BTðE  JÞTPðE  JÞBX2 ¼ BTðE  JÞTPL
or
ð7:130Þ
DT
2PD2X2 ¼ DT
2PL:
ð7:131Þ
This is the least squares normal equation of the following linear observation
equation:
U2 ¼ L  D2X2;
P
ð7:132Þ
or
U2 ¼ L  ðE  JÞBX2;
P;
ð7:133Þ
where L and P are the original observation vector and weight matrix, and U2 is the
residual vector, which has the same property as V in Eq. 7.117.
The advantage in using Eq. 7.133 is that the unknown vector X1 has been
eliminated; however, L vector and P matrix remain the same as the originals.
Applications of this theory can be found in Sect. 6.8, 8.3, and 9.2. The theory was
proposed by Jiangwen Zhou in 1985.
7.6.1
Zhou–Xu’s Theory: Diagonalised Normal Equation and the
Equivalent Observation Equation
In least squares adjustment, the unknowns can be divided into two groups. One
group of unknowns can be eliminated by matrix partitioning to obtain an equiva-
lently eliminated normal equation system of the other group of unknowns. Using
the elimination process twice for the two groups of unknowns respectively, the
normal equation can be diagonalised. The algorithm can be outlined as follows.
A linearised observation equation and the normal equations can be represented
by Eqs. 7.117 and 7.118. From the ﬁrst equation of 7.118, one has
X1 ¼ M1
11 ðB1  M12X2Þ:
ð7:134Þ
204
Chapter 7  Adjustment and Filtering Methods

Setting X1 into the second equation of 7.118, one gets an equivalently eliminated
normal equation of X2:
M2X2 ¼ R2;
ð7:135Þ
where
M2 ¼ M22  M21M1
11 M12:
R2 ¼ B2  M21M1
11 B1
ð7:136Þ
Similarly, from the second equation of 7.118, one has
X2 ¼ M1
22 ðB2  M21X1Þ:
ð7:137Þ
Setting X2 into the ﬁrst equation of 7.118, one gets an equivalently eliminated
normal equation of X1:
M1X1 ¼ R1;
ð7:138Þ
where
M1 ¼ M11  M12M1
22 M21:
R1 ¼ B1  M12M1
22 B2
ð7:139Þ
Combining Eqs. 7.138 and 7.135, one has
M1
0
0
M2


X1
X2


¼
R1
R2


;
ð7:140Þ
where (cf., e.g., Cui et al. 1982; Gotthardt 1978)
Q11 ¼ M1
1 ;
Q22 ¼ M1
2
Q12 ¼ M1
11 ðM12Q22Þ;
Q21 ¼ M1
22 ðM21Q11Þ :
ð7:141Þ
It is obvious that Eqs. 7.118 and 7.140 are two equivalent normal equations. The
solutions of the both equations are identical. Equation 7.140 is a diagonalised
normal equation related to X1 and X2. The process of forming Eq. 7.140 from
Eq. 7.118 is called the diagonalisation process of a normal equation.
As discussed in Sect. 7.6, the equivalently eliminated observation equation of
the second equation of Eq. 7.140 is Eq. 7.133. Similarly, if
I ¼ BM1
22 BTP and
D1 ¼ ðE  IÞA;
7.6  Zhou’s Theory: Equivalently Eliminated Observation Equation System
205

then the equivalently eliminated observation equation of the ﬁrst normal equation of
Eq. 7.140 has the form
U1 ¼ L  ðE  IÞAX1;
P;
where U1 is a residual vector that has the same property as V in Eq. 7.117. L and
P are the original observation vector and weight matrix.
The above equation and Eq. 7.133 can be written together as
U1
U2


¼
L
L



D1
0
0
D2


X1
X2


;
P
0
0
P


:
ð7:142Þ
Equation 7.142 is derived from the normal Eq. 7.140; therefore, it is true
inversely, i.e. Equation 7.140 is the least squares normal equation of the observa-
tion Eq. 7.142. Equations 7.118 and 7.140 are normal equations of the observation
Eqs. 7.117 and 7.142. Thus, Eq. 7.142 is an equivalent observation equation of
Eq. 7.117. Equations 7.140 and 7.142 are called diagonalised equations of 7.118
and 7.117, respectively. This diagonalised normal equation and the equivalent
observation equation could be called Zhou–Xu diagonalisation and equivalent
theory (Xu 2003).
7.7
Kalman Filter
7.7.1
Classic Kalman Filter
The principle of the classical Kalman ﬁlter can be summarised as follows (Yang
et al. 1999):
The linearised observation equation system can be represented by
Vi ¼ Li  AiXi;
Pi;
ð7:143Þ
where
L
observation vector of dimension m,
A
coefﬁcient matrix of dimension m × n,
X
unknown vector of dimension n,
V
residual vector of dimension m,
n
number of unknowns,
m
number of observations,
i
sequential index, i = 1,2,3,…, and
Pi
weight matrix of index i.
206
Chapter 7  Adjustment and Filtering Methods

Suppose the system equations are known and can be presented as
Ui ¼ Xi  Fi;i1Xi1;
i ¼ 2; 3; . . .;
ð7:144Þ
where
F
transition matrix of dimension n × n, and
U
residual vector of dimension n.
U and V are uncorrelated and have zero expectations. Using the covariance prop-
agation law, one has from Eq. 7.144
QðXiÞ ¼ Fi;i1QðXi1ÞðFi;i1ÞT þ QU:
ð7:145Þ
The normal Eq. 7.143 can be formed as
MiXi ¼ Bi:
ð7:146Þ
For the initial step or epoch, i.e. i = 1, Eq. 7.146 has the solution under the least
squares principle
~Xi ¼ QiBi;
where
Qi ¼ M1
i
;
ð7:147Þ
and here one will assume
~Qi ¼ Qi;
ð7:148Þ
where ~Xi and ~Qi are called estimated values. Using the estimated values and
transition matrix, one can predict the unknown values and covariance matrix of the
next epoch (say i = 2):
Xi ¼ Fi;i1~Xi1
and
ð7:149Þ
Qi ¼ Fi;i1 ~Qi1ðFi;i1ÞT þ QU;
ð7:150Þ
where Xi and Qi are called predicted values (vector and matrix). Then estimated
values of this epoch can be calculated by
~Xi ¼ X i þ KðLi  AiX iÞ;
ð7:151Þ
~Qi ¼ ðE  KAiÞQ i;
and
ð7:152Þ
K ¼ Q iAT
i ðAiQ iAT
i þ QVÞ1;
ð7:153Þ
where K is the gain matrix.
7.7  Kalman Filter
207

For the next sequential step i, the predicted values must be computed by using
Eqs. 7.149 and 7.150, and the estimated values can be computed by using
Eqs. 7.151 and 7.152. This iterative process is called Kalman ﬁltering.
In classical Kalman ﬁltering, it is assumed that for the problem of Eq. 7.143
there exists a system transition matrix Fi,i−1 in Eq. 7.144 and the cofactor QU.
Therefore, the estimated values in the Kalman ﬁlter process are dependent on Fi,i−1
and QU. The transition matrix will be based on strengthened physical models, and
the cofactor will be well known or reasonably given. If the system description is
accurate enough, of course Kalman ﬁltering will lead to a more precise solution.
However, if the system is not sufﬁciently well known, the results of Kalman ﬁlter
will sometimes not converge to the true values (divergence). Furthermore, a
kinematic process is generally difﬁcult to be precisely represented by theoretical
system equations. However, for a dynamic process (such as onboard GPS for
satellite to satellite tracking or orbit determination) the system equation can be well
formulated (by an orbital equation of motion). Another problem of Kalman ﬁltering
is the strong dependency of the given initial values. Many studies have been made
in this area to overcome the above-mentioned shortages.
7.7.2
Kalman Filter: A General Form of Sequential Least Squares
Adjustment
The sequential least squares problem is a special case of the classic Kalman ﬁlter. If
one lets
Fi;i1 ¼ E;
ð7:154Þ
then the system Eq. 7.144 in Sect. 7.7.1 turns out to be
Xi ¼ Xi1;
U ¼ 0
and
QU ¼ 0:
ð7:155Þ
The Kalman ﬁlter process is then as follows, for the initial step or epoch, i.e. i = 1,
Eq. 7.27 in Sect. 7.3 has the solution under the least squares principle:
~Xi ¼ QiBi; Qi ¼ M1
i
;
ð7:156Þ
with
~Qi ¼ Qi;
ð7:157Þ
where ~Xi and ~Qi are called estimated values. The predicted unknown values and
covariance matrix of the next epoch (say i = 2) of Eqs. 7.149 and 7.150 in
Sect. 7.7.1 are then
208
Chapter 7  Adjustment and Filtering Methods

X i ¼ ~Xi1 and
ð7:158Þ
Q i ¼ ~Qi1:
ð7:159Þ
The estimated values of Eqs. 7.151, 7.152 and 7.153 in Sect. 7.7.1 can be
simpliﬁed as
~Xi ¼ ~Xi1 þ GðLi  Ai~Xi1Þ;
ð7:160Þ
~Qi ¼ ðE  GAiÞ~Qi1;
and
ð7:161Þ
G ¼ ~Qi1AT
i ðAi ~Qi1AT
i þ QVÞ1;
ð7:162Þ
where G denotes the gain matrix. If one notices that QV = (Pi)−1 and applies the
formula of Bennet (Cui et al. 1982; Koch 1986), one has
~Qi1AT
i ðAi ~Qi1AT
i þ QVÞ1 ¼ ~Qi1AT
i Pi:
ð7:163Þ
Equation 7.160 can then be rewritten as
~Xi ¼ ðE  GAiÞ~Xi1 þ GLi:
¼ ðE  GAiÞ~Xi1 þ ~QiAT
i PiLi
ð7:164Þ
Comparing the derived Eqs. 7.161 and 7.164 with the Eqs. 7.36 and 7.38
derived in Sect. 7.3, one can easily determine that they are identical. Therefore, the
sequential least squares adjustment is a special case of Kalman ﬁltering.
7.7.3
Robust Kalman Filter
The classical Kalman ﬁlter is suitable for real-time applications. The chief problem
in Kalman ﬁltering is the divergence caused by the inexact descriptions of system
equations and its statistical properties, as well as the divergence caused by data with
inhomogeneous precision.
Efforts have been made to modify the performance of Kalman ﬁltering. In the
classical Kalman ﬁlter, the weight matrix P of the observables is static, i.e. P is
assumed to be a deﬁnite matrix. Taking the residuals of Kalman ﬁltering into
account, one may adjust the weight P of the observables accordingly. This process
is called robust Kalman ﬁltering (Koch and Yang 1998a, b; Yang 1999).
Generally, observations are either accepted or rejected in least squares adjust-
ment and the classical Kalman ﬁlter. In other words, the weight is either set as 1
7.7  Kalman Filter
209

(accepted) or zero (rejected). In the robust Kalman ﬁlter, a continuous weight
between 1 and zero is introduced.
Originally, one has P = (QV)−1, the adjusted P is denoted by P; then the
Eq. 7.153 in the classical Kalman ﬁlter can be rewritten as
K ¼ Q i AT
i ðAiQ i AT
i þ P1
i Þ1:
ð7:165Þ
In the case of independent observations, Pi is a diagonal matrix. Taking the
residuals into account, Pi may be adjusted as (Huber 1964; Yang et al. 2000)
PiðkÞ ¼
PiðkÞ
PiðkÞ
c
ViðkÞ=ri
j
j

;
if
ViðkÞ=ri
j
j  c
ViðkÞ=ri
j
j [ c ;
ð7:166Þ
where Vi(k) is the kth element of the vector V, Pi(k) is the diagonal element of
matrix Pi, and c is a constant, which is usually chosen as 1.3–2.0 (Yang et al.
2000). Vi is the residual of the observation Li, σi is the standard deviation of the
ith epoch, and Pi = 1/σi. In this way, the weight of the observation Li is adjusted
due to the related residual.
If the observations are correlated with each other, the weight matrix may be
given by (Yang et al. 2000)
Pkj ¼
Pkj
Pkj
c
maxf ViðkÞ=ri
j
j; ViðjÞ=ri
j
jg

;
if
ViðkÞ=ri
j
j  c
and
ViðjÞ=ri
j
j  c
ViðkÞ=ri
j
j [ c
or
ViðjÞ=ri
j
j [ c :
ð7:167Þ
It is obvious that an adjusted weight matrix can better reﬂect the different data
quality and can better ﬁt the reality of the observations.
Usually the outlier will be rejected if the absolute value of the residual is greater
than eσi, i.e. |Vi| > eσi, where e is a constant, e may be selected as 3–4, σi is the
standard deviation, and i is the iterative calculation index. That is, P–i = 0 if
|Vi/σi| ≥e. Setting |Vi/σi| = e into Eq. 7.166 one gets Pi ¼ ðc=eÞPi. In other words,
the weight deﬁnitions of Eqs. 7.166 and 7.167 are not continuous at point e.
A modiﬁcation (Xu 2003) of Eq. 7.166 can be made by deﬁning
PiðkÞ ¼
piðkÞ
y1PiðkÞ
y2PiðkÞ
0
8
>
>
<
>
>
:
;
if
jViðkÞ=rij  c
c\jViðkÞ=rij  d
d\jViðkÞ=rij  e
jViðkÞ=rij  e
8
>
>
<
>
>
:
;
ð7:168Þ
where
y1 ¼ 1 
1  b
ðd  cÞ2
ViðkÞ
ri

  c

2
and
ð7:169Þ
210
Chapter 7  Adjustment and Filtering Methods

y2 ¼
b
ðe  dÞ2
e  ViðkÞ
ri



2
;
ð7:170Þ
where b is the value of y1 if |Vi(k)/σi| = d. c, d, e are constants, and 0 < c<d < e. For
simpliﬁcation, if one lets b = (e–d)/(e–c), then one has 1 −b = (d −c)/(e −c).
One may let d = (e + c)/2 for further simpliﬁcation and have
y1 ¼ 1 
2
ðe  cÞ2
ViðkÞ
ri

  c

2
and
y2 ¼
2
ðe  cÞ2
e  ViðkÞ
ri



2
:
By selecting c = 1, e = 3, and using the above assumptions, the weight functions
of Eqs. 7.166 and 7.168 are shown in Fig. 7.1 with broken and continuous lines. It
is obvious that Eq. 7.168 is a more reasonable weight function, which may make
the Kalman ﬁlter more robust.
Similar determinations can be made similarly for correlated cases. Denoting
|Vi(k)/σi| as v(k), a modiﬁcation of Eq. 7.167 can be rewritten as (Xu 2007)
Piðk; jÞ ¼
piðk; jÞ
z1Piðk; jÞ
z2Piðk; jÞ
0
8
>
>
<
>
>
:
;
if
maxfvðkÞ; vðjÞg  c
c\maxfvðkÞ; vðjÞg  d
d\maxfvðkÞ; vðjÞg  e
maxfvðkÞ; vðjÞg [ e
8
>
>
<
>
>
:
;
ð7:171Þ
where
z1 ¼ 1 
1  b
ðd  cÞ2 ðmaxfvðkÞ; vðjÞg  cÞ2
and
ð7:172Þ
Fig. 7.1 Weight functions
7.7  Kalman Filter
211

z2 ¼
b
ðe  dÞ2 ðe  maxfvðkÞ; vðjÞgÞ2;
ð7:173Þ
where b is the value of z1 if max{v(k), v(j)} = d. For simpliﬁcation, if one lets
b = (e −d)/(e −c), then one has 1 −b = (d −c)/(e −c). Further if one lets
d = (e −c)/2, then one has
z1 ¼ 1 
2
ðe  cÞ2 ðmaxfvðkÞ; vðjÞg  cÞ2
and
z2 ¼
2
ðe  cÞ2 ðe  maxfvðkÞ; vðjÞgÞ2:
7.7.4
Yang’s Filter: Adaptively Robust Kalman Filtering
The reliability of the linear ﬁltering results, however, will degrade when the noise of
the kinematic model is not accurately modelled in ﬁltering or the measurement
noise at any measurement epoch is not normally distributed. In this section, we
introduce a new adaptively robust ﬁltering technique proposed by Yang et al.
(2001a, b) based on the robust M (maximum likelihood type) estimation. It consists
in weighting the inﬂuence of the updated parameters in accordance with the
magnitude of the discrepancy between the updated parameters and the robust
estimates obtained from the kinematic measurements, and in weighting individual
measurements at each discrete epoch. The new procedure is different from func-
tional model error compensation; it changes the covariance matrix or, equivalently,
changes the weight matrix of the predicted parameters to cover the model errors.
A general estimator for an adaptively robust ﬁlter is presented, which includes the
estimators of the classical Kalman ﬁlter, adaptive Kalman ﬁlter, robust ﬁlter,
sequential least squares (LS) adjustment, and robust sequential adjustment. The
procedure not only resists the inﬂuence of outlying kinematic model errors, but also
controls the effects of measurement outliers. In addition to the robustising prop-
erties, feasibility in implementation of the new ﬁlter is achieved through the
equivalent weights of the measurements and the predicted state parameters.
Applications of the Kalman ﬁlter in dynamic or kinematic positioning have
sometimes encountered difﬁculties, which have been referred to as divergences.
These divergences can often be traced to three factors: (1) insufﬁcient accuracy in
modelling the dynamics or kinematics (functional model errors of the state equa-
tions); (2) insufﬁcient accuracy in modelling the observations (functional model
errors of observation equations); and (3) insufﬁcient accuracy in modelling the
distributions or the priori covariance matrices of the measurements and the updated
parameters (stochastic model errors).
212
Chapter 7  Adjustment and Filtering Methods

The current basic procedure for the quality control of a Kalman ﬁlter consists of
the following:
• Functional model compensation for model errors by introducing uncertain
parameters into the state and/or the observation equations. Any model error term
can be arbitrarily introduced into the models, and the state can then be aug-
mented (Jazwinski 1970, p. 308). A similar approach was developed by
Schaffrin (1991, pp. 32–34). Here, the state vector is partitioned into h groups,
each affected by a common scale error, and h × 1 vectors of scale parameters
are then introduced into the models. This type of approach may, of course, lead
to a high-dimensional state vector, which in turn greatly increases the ﬁlter
computational load (Jazwinski 1970, p. 305).
• Stochastic model compensation by introducing a variance–covariance matrix of
the model errors. In taking this approach to prevent divergence, one must
determine which covariance matrix to add. A reasonable covariance matrix may
compensate for the model errors. An ineffective covariance matrix, however,
adds to the model divergence. For instance, when the model is accurate in some
dynamic or kinematic periods, an unsuitable increase of the covariance matrix of
model error will degrade the state estimators. Thus an effective covariance
matrix for model errors can be determined only by trial and error.
• The DIA procedure—detection, identiﬁcation, and adaptation (Teunissen 1990).
This approach employs a recursive testing procedure to eliminate outliers. In the
detection step, one looks for unspeciﬁed model errors, and in the identiﬁcation
step, one tries to ﬁnd the cause of the model error and its most likely starting
time. After a model error has been detected and identiﬁed, the bias in the state
estimate caused by the model error must be eliminated as well. This model
recovery from errors is called adaptation (Salzmanm 1995). The identiﬁcation of
the model, however, is quite difﬁcult, especially when the measurements are not
accurate enough to detect the unspeciﬁed model errors.
• The sequential least squares procedure. A rather different procedure frequently
used for kinematic positioning does not use the dynamic model information at
all, but determines discrete positions at the measurement epochs (Cannon et al.
1986). In this case, there is no assumption made on a dynamic model, and only
the measurements at the discrete epoch are employed to estimate the state
parameters. The model error, therefore, does not affect the estimates of new state
parameters. This method is typically presented as a sequential least squares
algorithm (Schwarz et al. 1989). The current limitation to this approach is that it
wastes the good information of the state model in cases when the model
accurately describes the dynamic process.
• Adaptive Kalman ﬁltering. An innovation-based adaptive Kalman ﬁlter for an
integrated INS/GPS was developed by Mohamed and Schwarz (1999), based on
the maximum likelihood criterion by proper choice of the ﬁlter weight. Another
adaptive Kalman ﬁlter algorithm to directly estimate the variance and covariance
components for the measurements was studied by Wang et al. (1999). Both
7.7  Kalman Filter
213

algorithms need to collect the residuals of the measurements or the updated
series to calculate the state variance–covariance matrices.
• A robust ﬁlter based on the min–max robust theory. The deviation of obser-
vation error distribution from Gaussian distribution may also seriously degrade
the performance of Kalman ﬁltering. Thus, there appears to be considerable
motivation for considering ﬁlters which are robustised to perform fairly well in
non-Gaussian environments. To address this problem, Masreliez and Martin
(1977) applied the inﬂuence function of the min–max robust theory to replace
the score function of the classical Kalman ﬁlter. The key disadvantages with this
kind of robust ﬁlter are that the estimator requires symmetric distribution of the
unknown contamination, and this ﬁlter does not work as well as the standard
Kalman ﬁlter in Gaussian noise.
• A robust ﬁlter based on M estimation theory (Huber 1964) and Bayesian
statistics. To resist the negative inﬂuence of both state model errors and mea-
surement outliers, a robust M–M ﬁlter was developed (Yang 1991, 1997a, b;
Zhou et al. 1997, p. 299). Here, measurement outliers are controlled by robust
equivalent weights of the measurements, and the model errors are resisted by the
equivalent weights of the updated parameters according to the divergence of the
predicted parameters from the estimated parameters. In addition, a robust ﬁlter
for rank-deﬁcient observation models was developed by Koch and Yang (1998a,
b), using Bayesian statistics and applying the robust M estimate.
All of the methods described above require knowledge of the dynamic model
errors, with which the functional or stochastic models to compensate for the model
errors and the equivalent weights for the robust ﬁlter are constructed. In practical
applications, it is very difﬁcult to predict the error distribution or the error type of
the updated parameters or the dynamic model errors, and thus it is very difﬁcult to
construct functional and stochastic models. Furthermore, when a moving vehicle
accelerates from zero or decelerates to a stop, the acceleration proﬁle is discon-
tinuous. If this discontinuity falls between two measurement epochs, the dynamics
cannot be accurately modelled or predicted by state equations; in this case, one
should not rely too heavily on the information predicted from the dynamic model.
Thus, the ﬁltering procedure should weaken the effects of the updated parameters.
In addition, if the updated parameter vector is contaminated by model error, it is
generally distorted in its entirety. Therefore, it is not necessary to consider the error
inﬂuence of the individual element of the updated parameter vector as is done with
the robust M–M ﬁlter. In this case, an adaptive ﬁlter is suitable for balancing the
dynamic model information and the measurements.
1. General Estimator of Adaptively Robust Filtering
An adaptively robust ﬁlter is constructed as (cf. Yang et al. 2001a, b)
~Xi ¼ ðAT
i PiAi þ aPXiÞ1ðAT
i PiLi þ aPXiXiÞ
and
ð7:174Þ
214
Chapter 7  Adjustment and Filtering Methods

Q~Xi ¼ ðAT
i PiAi þ aPXiÞ1r2
0;
ð7:175Þ
where Pi is the equivalent weight matrix of the observation vector, PXi is the weight
matrix of the predicted vector Xi, Q~Xi is the covariance matrix of the estimated state
vector, σ0
2 is a scale factor, and α is an adaptive factor, which can be chosen as
a ¼
1
D~Xi

  c0
c0
D~Xi
j
j ð
c1 D~Xi
j
j
c1c0 Þ2
c0\ D~Xi

  c1
0
D~Xi

 [ c1
8
>
>
<
>
>
:
;
ð7:176Þ
where c0 and c1 are constants that are experienced, valued as c0 = 1.0–1.5,
c1 = 3.0–4.5,
D~Xi ¼
^Xi  ^Xi
		
		
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
trfQ^Xig
q
;
ð7:177Þ
and ^Xi is a robust estimate of state vector (state position), which is evaluated only
by new measurements at epoch i, and the raw velocity observations are not included
in it. ^Xi is a predicted position from Eq. 7.149 in which the a priori velocity
components are not included. The change in the position expressed by Eq. 7.177
can also reﬂect the stability of the velocity (cf. Yang et al. 2001a, b).
Expression 7.174 is a general estimator of an adaptively robust ﬁlter. In the case
of α ≠0, Eq. 7.174 is changed, using the matrix identities (Koch 1988, p. 40), into
~Xi ¼ Xi þ QXiAT
i ðAiQXiAT
i þ aQVÞ1ðLi  AiXiÞ:
ð7:178Þ
2. Special Estimators
The adaptive factor α changes between zero and one, which balances the con-
tribution of the new measurements and the updated parameters to the new estimates
of state parameters.
Case 1: If α = 0 and Pi ¼ Pi, then
~Xi ¼ ðAT
i PiAiÞ1AT
i PiLi;
ð7:179Þ
which is an LS estimator by using only the new measurements at epoch i. This
estimator is suitable in the case where the measurements are not contaminated by
outliers and the updated parameters are biased to such a degree that Δ~Xi in
Eq. 7.177 is larger than c1 (rejecting point), and the information of updated
parameters is completely forgotten.
7.7  Kalman Filter
215

Case 2: If α = 1 and Pi ¼ Pi, then
~Xi ¼ ðAT
i PiAi þ PXiÞ1ðAT
i PiLi þ PXiXiÞ;
ð7:180Þ
which is a general estimator of the classical Kalman ﬁlter.
Case 3: If α is determined by Eq. 7.177 and Pi ¼ Pi, then
~Xi ¼ ðAT
i PiAi þ aPXiÞ1ðAT
i PiLi þ aPXiXiÞ;
ð7:181Þ
which is an adaptive LS estimator of the Kalman ﬁlter. It balances the contribution
of the updated parameters and the measurements. The only difference between
Eqs. 7.174 and 7.181 is the weight matrix of Li. The former uses the equivalent
weights and the latter uses the original weights of Li.
Case 4: If α = 0, we obtain
~Xi ¼ ðAT
i PiAiÞ1AT
i PiLi;
ð7:182Þ
which is a robust estimator by using only the new measurements at epoch i.
Case 5: If α = 1, then
~Xi ¼ ðAT
i PiAi þ PXiÞ1ðAT
i PiLi þ PXiXiÞ;
ð7:183Þ
which is an M–LS ﬁlter estimator (Yang 1997a, b).
Further Development of the Theory
The adaptive factor α was considered a diagonal matrix by Ou (2004) and
grouped by the physical meaning of the parameters by Yang and Xu (2004). Since
then, several advances have been made (cf. Yang and Cui 2006; Yang and Gao
2005a, b, 2006a, b, c, Yang et al. 2006).
7.7.5
Progress in Adaptively Robust Filter Theory and Application
A new adaptively robust ﬁltering technique for use in kinematic navigation and
positioning has been systematically established and developed in recent years
(Yang et al. 2013). The adaptively robust ﬁlter applies a robust estimation principle
to resist the effects of measurement outliers, and introduces an adaptive factor to
control the inﬂuence of dynamic model disturbances. It can thus balance the con-
tribution of the dynamic model information and the measurements in accordance
with the magnitude of their discrepancy (Yang et al. 2001a). In this section, we
introduce the major advancements in the theory and application of the adaptively
robust ﬁlter.
216
Chapter 7  Adjustment and Filtering Methods

Following the development of adaptively robust ﬁltering, four learning statistics
and four adaptive factors were established based on experiences, and these have been
proven effective in practical applications. An accompanying adaptive factor was
created that features a three-segment descending function and a learning statistic
constructed using the discrepancy between the predicted state from the kinematic
model and the state estimated from the measurements. Three other types of adaptive
factors have been developed: a two-segment descending function (Yang et al.
2001b), an exponential function (Yang and Gao 2005), and a zero/one function for
state component adaptation (Ou et al. 2004; Ren et al. 2005). Three additional
learning statistics have also been set up, which include a predicted residual statistic
(Xu and Yang 2000; Yang and Gao 2006b), a variance component ratio statistic
from both the measurements and the predicted states (Yang and Xu 2003), and a
velocity discrepancy between the predicted velocity from the kinematic model and
the velocity evaluated from the measurements (Cui and Yang 2006).
A key problem has been in constructing an adaptive factor suitable for balancing
the contribution of the measurements and the predicted dynamic model information.
Two optimal adaptive factors have been established that satisfy the conditions that
the theoretical uncertainty of the predicted state outputted from the adaptive ﬁl-
tering is equal or nearly equal to its actual estimated uncertainty, or that the the-
oretical uncertainty of the predicted residual vector is equal or nearly equal to its
actual estimated uncertainty (Yang and Gao 2006a). An adaptively robust ﬁlter with
classiﬁed adaptive factors (Cui and Yang 2006) was also developed, which is more
effective in tracking the disturbances of the vehicle movements. In addition, an
adaptively robust ﬁlter with multi-adaptive factors (Yang and Cui 2008) was cre-
ated, which is more general in theory and contains adaptively robust ﬁlters with
single and classiﬁed adaptive factors.
To control the inﬂuence of the measurement outliers and disturbances of the
dynamic model, an adaptively robust ﬁlter based on the current statistical model (Gao
et al. 2006b) was developed. In addition, an adaptively robust ﬁlter based on a neural
network (Gao et al. 2007a, b) was studied to solve the construction of the dynamic
model. The adaptively robust ﬁlter can also be integrated with error detection,
identiﬁcation, and application (DIA). To control the nonlinear disturbances of the
dynamic model, an adaptive unscented Kalman ﬁlter (UKF) algorithm for improving
the generalization of neural networks (Gao et al. 2008) and an adaptively robust ﬁlter
based on the Bancroft algorithm (Zhang et al. 2007) have been derived.
In terms of applications, the adaptively robust ﬁlter has been successfully
applied to satellite orbit determination (Yang and Wen 2004) and data processing in
repeated observations of geodetic networks (Sui et al. 2007). An adaptively robust
ﬁlter with constraints has also been studied for navigation applications (Yang et al.
2011). In integrated navigation applications, an adaptive Kalman ﬁltering algorithm
for the IMU/GPS integrated navigation system (Gao et al. 2006a) and a two-step
adaptively robust Kalman ﬁltering algorithm for a GPS/INS integrated navigation
system (Wu and Yang 2010) have been developed. A comparison of several
adaptive ﬁltering algorithms for controlling the inﬂuence of coloured noise was
analysed in order to simultaneously control the inﬂuence of coloured noise and
7.7  Kalman Filter
217

dynamic model disturbances (Cui et al. 2006). In research on the estimation and
prediction of the satellite clock offset, an adaptively robust sequential adjustment
with opening window classiﬁed adaptive factors (Huang et al. 2011) and an
adaptively robust Kalman ﬁlter with classiﬁed adaptive factors for real-time esti-
mation of satellite clock offset (Huang and Zhang 2012) were derived.
Improvements in adaptive ﬁltering have also been made with regard to estimation
of deformation parameters in relation to geometric measurements and geophysical
models (Yang and Zeng 2009).
7.7.6
A Brief Introduction to the Intelligent Kalman Filter
Considering the ﬁltering methods applied in kinematic navigation, the motion state
models of the moving vehicles are described and set empirically without exception.
However, the actual motion rules of the moving carriers are unpredictable. In
Kalman ﬁltering, the unknown motion is described by an a priori empirical model,
while GNSS observations are used to obtain the unknown motion. For this case, a
method called intelligent Kalman ﬁltering is proposed in this section, for the pur-
pose of upgrading and extending the adaptive ﬁlter theory. The original concept of
the intelligent Kalman ﬁlter was introduced in 2007 by Guochang Xu, and was
funded for study by the Chinese Natural Science Foundation in 2012.
The purpose of this so-called intelligent Kalman ﬁlter is to apply the Doppler
observation information in constructing the system equation. The system descrip-
tions—which until now, without exception, have used a few empiric system
equations—will be upgraded using co-determined Doppler measurements, thus
providing more realistic descriptions. Because of the additional velocity informa-
tion (nearly as much as the positioning information), the much more objective
description of the system, and the more reasonable and precise estimation of the
error disturbances, intelligent Kalman ﬁltering can provide for greater stability and
can yield more accurate results. Furthermore, the additional velocity information
will be considered in determining a more reasonably adaptive factor, which is a new
and advanced extension in adaptive ﬁltering. Application of the intelligent Kalman
ﬁlter in kinematic GNSS navigation and positioning is ongoing, and its application
for autonomous orbit determination and manoeuvring in particular is expected to
yield outstanding results.
7.8
A Priori Constrained Least Squares Adjustment
Thus far in the chapter, we have discussed several adjustment and ﬁltering methods,
all of which are suitable for full-rank linear equation problems. A full-rank quad-
ratic matrix can be inverted to obtain its inversion. A rank-deﬁcient linear equation
218
Chapter 7  Adjustment and Filtering Methods

system is sometimes referred to as an over-parameterised problem. Except for the
conditional least squares adjustment method, none of the methods discussed above
can be directly used for solving a rank-deﬁcient problem. The conditional least
squares adjustment method with extra conditions can make the problem solvable.
The conditions, of course, should be mathematically well formulated and physically
well reasoned. In other words, the conditions are considered as exactly known. In
practice, the conditions are quite often known with certain a priori precision.
Adjustment that uses such a priori information as constraints is called an a priori
constrained adjustment, which will be discussed in this section.
7.8.1
A Priori Parameter Constraints
1. A linearised observation equation system can be represented by
V ¼ L  AX;
PL;
ð7:184Þ
where
PL
symmetric and deﬁnite weight matrix of dimension m × m.
2. The corresponding a priori condition equation system can be written as
U ¼ W  BX;
PW;
ð7:185Þ
where
B
coefﬁcient matrix of dimension r × n,
W
constant vector of dimension r,
U
residual vector of dimension r,
PW
a priori (symmetric and deﬁnite) weight matrix of dimension r × r, and
r
number of condition equations; r < n.
3. One may interpret the constraints of Eq. 7.185 as additional pseudo-
observations or as ﬁctitious observations. This leads to the total observation
equations
V
U


¼
L
W



A
B


X;
P ¼
PL
0
0
PW


:
ð7:186Þ
The least squares normal equations are then well known, as (see, e.g., Sect. 7.2.1)
AT
BT


PL
0
0
PW


A
B


X ¼
AT
BT


PL
0
0
PW


L
W


7.8  A Priori Constrained Least Squares Adjustment
219

or
ðATPLA þ BTPWBÞX ¼ ðATPLL þ BTPWWÞ:
ð7:187Þ
For convenience, a factor k (here k = 1) is introduced in Eq. 7.187:
ðATPLA þ kBTPWBÞX ¼ ðATPLL þ kBTPWWÞ:
ð7:188Þ
Equation 7.188 shows that the a priori information constraints can be added to
the original least squares normal equations. In other words, the a priori information
can be used for solving the rank-deﬁcient problem and makes it possible to invert
the normal matrix. Of course, these a priori information constraints should be
reasonable and realistic; otherwise, the solutions could be disturbed by more serious
a priori constraints. In the case of k = 0, the normal Eq. 7.188 turns out to be the
original one, and will yield the free solution (without any a priori constraints).
The solution to the a priori constrained least squares solution is then
X ¼ ðATPLA þ kBTPWBÞ1ðATPLL þ kBTPWWÞ;
ð7:189Þ
where k = 1. Generally, the a priori weight matrix is given by covariance
matrix QW and
PW ¼ Q1
W :
ð7:190Þ
The a priori constraints cause only two additional terms in both sides of the
normal equations; therefore, all the adjustment and ﬁltering methods discussed
above can be directly used for solving the a priori constrained problem.
7.8.2
A Priori Datum
Suppose the B matrix in the a priori constraints of Eq. 7.185 is an identity matrix,
and the parameter vector W is just a coordinate sub-vector of the total parameter
vector. This results in a special case called a priori datum. The observation equa-
tions and a priori constraints may be rewritten as
V ¼ L  A1
A2
ð
Þ
X1
X2


;
PL
and
ð7:191Þ
U ¼ X2  X2;
P2;
ð7:192Þ
where X2 is the “observed” parameter sub-vector, P2 is the weight matrix with
respect to the parameter sub-vector X2 and is generally a diagonal matrix, and U is a
residual vector that has the same property as V. Generally, X2 is “observed”
220
Chapter 7  Adjustment and Filtering Methods

independently, so P2 is a diagonal matrix. If X2 is a sub-vector of station coordi-
nates, then the constraint of Eq. 7.192 is called the datum constraint (this is also the
reason for the name “a priori datum”).
The least squares normal equation of problems 7.191 and 7.192 can then be
formed (similar to what discussed in Sect. 7.8.1) as
M11
M12
M21
M22


X1
X2


¼
B1
B2


ð7:193Þ
or
M11X1 þ M12X2 ¼ B1
and
ð7:194Þ
M21X1 þ M22X2 ¼ B2;
ð7:195Þ
where
M11 ¼ AT
1PLA1;
ð7:196Þ
M12 ¼ MT
21 ¼ AT
1PLA2;
ð7:197Þ
M22 ¼ AT
2PLA2 þ P2;
ð7:198Þ
B1 ¼ AT
1PLL;
and
ð7:199Þ
B2 ¼ AT
2PLL þ P2X2:
ð7:200Þ
The least squares principle used here is
VTPLV þ UTP2U ¼ min:
ð7:201Þ
The normal Eq. 7.193 can be also derived by differentiating Eq. 7.201 with
respect to X, and then letting it equal zero and taking Eq. 7.192 into account. In
practice, the sub-vector X2 is usually a zero vector; this can be achieved through
careful initialisation by forming the observation Eq. 7.191. Comparing the normal
equation system of the a priori datum problem of Eqs. 7.191 and 7.192 with the
normal equation of Eq. 7.191, the only difference is that the a priori weight matrix P2
has been added to M22. This indicates that the a priori datum problem can be dealt
with simply by adding P2 to the normal equation of the observation Eq. 7.191.
If some diagonal components of the weight matrix P2 are set to zero, then the
related parameters (X2) are free parameters (or free datum) of the adjustment
problem (without a priori constraints). Otherwise, parameters with a priori con-
straints are called a priori datum. Large weight values indicate strong constraint and
small weight values indicate soft constraint. The strongest constraint is keeping the
datum ﬁxed.
7.8  A Priori Constrained Least Squares Adjustment
221

7.8.3
Zhou’s Theory: Quasi-Stable Datum
The quasi-stable datum method was proposed by Zhou et al. (1997). Its basic
premise is that the network is dynamic, i.e. most parameters are changing all the
time. However, a few points are relatively stable, or their geometric centre is
relatively stable. All assumptions and observation equations are the same as in
Sect. 7.8.2:
V ¼ L  A1
A2
ð
Þ
X1
X2


;
PL
and
ð7:202Þ
U ¼ X2  X2;
P2:
ð7:203Þ
The least squares principles for the quasi-stable datum are
VTPLV ¼ min
ð7:204Þ
and
UTP2U ¼ min:
ð7:205Þ
Equation 7.204 is the same as the original least squares principle. From
Eq. 7.204, one has the normal equation
M11
M12
M21
M22


X1
X2


¼
B1
B2


;
ð7:206Þ
where
M11 ¼ AT
1PLA1;
M12 ¼ MT
21 ¼ AT
1PLA2;
M22 ¼ AT
2PLA2;
B1 ¼ AT
1PLL;
and
B2 ¼ AT
2PLL:
ð7:207Þ
Even if Eq. 7.206 is a rank-deﬁcient equation, one may ﬁrst solve Eq. 7.206 to
get an explicit expression for X2. Recalling the discussion in Sect. 7.5, one gets a
normal equation related to X2:
M2X2 ¼ R2;
ð7:208Þ
222
Chapter 7  Adjustment and Filtering Methods

where
M2 ¼ M22  M21M1
11 M12
and
R2 ¼ B2  M21M1
11 BT
1:
ð7:209Þ
The new condition can be considered by forming
F ¼ UTP2U þ 2KTðM2X2  R2Þ
and
@F
@X ¼ 2UTP2 þ 2KTM2 ¼ 0:
Considering the symmetry of M2, we have
U ¼ P1
2 M2K:
ð7:210Þ
Substituting Eq. 7.210 into 7.203, one gets
X2 ¼ X2 þ P1
2 M2K
ð7:211Þ
or
M2X2 ¼ M2X2 þ M2P1
2 M2K:
ð7:212Þ
Substituting Eq. 7.208 into 7.212, one has
K ¼ ðM2P1
2 M2Þ1ðM2X2  R2Þ:
ð7:213Þ
Thus,
X2 ¼ X2 þ P1
2 M2K;
ð7:214Þ
X1 ¼ M1
11 ðAT
1PLL  M12X2Þ;
and
ð7:215Þ
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPLV
n  r
r
;
ð7:216Þ
where m0 is the standard deviation, n is the number of observations, and r is the
summation of the both ranks of the matrices A1 and A2.
7.8  A Priori Constrained Least Squares Adjustment
223

7.9
Summary
In this chapter, we have outlined the most applicable and necessary algorithms for
static and kinematic as well as dynamic GPS data processing.
Least squares adjustment is the most basic adjustment method. It starts by
establishing observation equations and forming normal equations, and then solves
the unknowns. The sequential application of least squares adjustment by accumu-
lating the sequential normal equations makes applications of least squares adjust-
ment more effective. Normal equations can be formed epoch-wise and then
accumulated. This method can be used not only for ultimately solving the problem,
but also for obtaining epoch-wise solutions. It is suitable for static GPS data pro-
cessing. The equivalent sequential least squares adjustment, which can be found in
various publications, was also derived. This is an epoch-wise solving method and
thus is generally not suitable for static GPS data processing. Xu (author) and
Morujao (Coimbra University, Portugal) have independently reported that results
obtained by applying such an algorithm will differ from those obtained by the
accumulation method. The differences increase with time and are generally
non-negligible. Therefore, when this method is used, the numerical process must be
carefully examined to avoid the accumulation of numerical errors.
If there are constraints that have to be taken into account, a conditional least
squares adjustment is needed. The commonly used least squares ambiguity search
criterion is derived from this principle (cf. Sect. 8.3.4), and the general criterion of
integer ambiguity search is also based on this theory (cf. Sect. 8.3.5). This method
is typically applied in GPS data processing to take into account the known distance
of multiple kinematic antennas. The sequential application of conditional least
squares adjustment was discussed here in terms of practical needs. The problem
may be solved ﬁrst without conditions, after which conditions may be applied.
Constraints such as the known distances of multiple antennas ﬁxed on an aircraft
must be considered for every epoch.
We also discussed lock-wise least squares adjustment for separating the
unknowns into two groups—for example, one group of time-dependent parameters
such as kinematic coordinates, and the other a group of time-independent param-
eters such as ambiguities. The sequential application of block-wise least squares
adjustment makes it possible to give up some unknowns (say, out-of-date
unknowns, such as past coordinates) and to keep the information related to the
common unknowns during processing. This method avoids problems that may be
caused by a rapid increase in the number of unknowns. There are two ways to keep
the solution equivalent to a solution that is not sequential. One is to use the
time-independent unknowns at the end of data processing as known, and to then go
back to process the data again. The other is to remember all sequential normal
equations until the best solution of the time-independent unknowns is obtained,
after which the coordinates can be recomputed. A special application of block-wise
224
Chapter 7  Adjustment and Filtering Methods

least squares adjustment was discussed for a code–phase combination model. Of
course, the two observables must be suitably scaled and weighted.
We discussed the equivalently eliminated observation equation system for
eliminating some nuisance parameters. This method is nearly the same as
block-wise least squares adjustment if one carefully compares the normal equations
of the second group of unknowns (see Sect. 7.5) and the eliminated normal
equations (see Sect. 7.6). However, the most important point here is that the
equivalently eliminated observation equations have been derived. Instead of solving
the original problem, one may directly solve the equivalently eliminated observa-
tion equations, where the unknowns are greatly reduced, whereas the original
observation vector and weight matrix remain (i.e. the problem remains uncorre-
lated). The precision estimation can also be made more easily by using the formulas
derived in least squares adjustment. The derivation of such an equivalent obser-
vation equation was ﬁrst described by Zhou (1985) and was then applied in GPS
theory by Xu (2002). The uniﬁed GPS data processing method is derived using this
principle (cf. Sect. 6.8). Based on the derivation of the equivalent equation, a
diagonaliation algorithm of the normal equation and the observation equation was
presented. The diagonalisation algorithm can be used for separating one adjustment
problem into two sub-problems.
The classic Kalman ﬁlter was also discussed. It is suitable for real-time appli-
cations. A key problem of the classic Kalman ﬁlter is the divergence caused by the
inexact description of system equations and its statistical properties as well as the
inhomogeneity of the data. Furthermore, the solutions can be strongly dependent on
the given initial values. The sequential least squares adjustment method as a special
case of Kalman ﬁltering was outlined.
Efforts have been made to modify the performance of classic Kalman ﬁltering. In
the classic Kalman ﬁlter, the weight matrix P of observables is static, i.e. P is
assumed to be a deﬁnitive deﬁned matrix. Taking the residuals of Kalman ﬁltering
into account, one may adjust the weight P of the observables accordingly; this
process is called robust Kalman ﬁltering (Koch and Yang 1998a, b). This principle
can be also used for controlling the outliers of observations (Yang 1999). This idea
indeed can be also used in all of the adjustment methods. The weight of an
observation is usually either one (be accepted) or zero (be rejected). In robust
Kalman ﬁltering, a continuous weight between one and zero was deﬁned and
introduced. A modiﬁed weight function was also discussed and given for use.
Generally speaking, the robust weighting method may modify the convergence
process of the ﬁltering procedure.
As soon as the system is deﬁned, the Kalman ﬁlter also obtains memory abilities.
However, if the system makes a discontinuous change (for example, aircraft that is
static begins to run), the Kalman ﬁlter should be able to forget a part of the updated
parameters. A robust Kalman ﬁlter with the addition of this ability is called an
adaptively robust Kalman ﬁlter (Yang et al. 2001a, b), and was discussed in detail.
A priori constrained least squares adjustment was discussed in Sect. 7.8 for
solving the rank-deﬁcient problems, and a general discussion on the a priori
parameter constraints was provided. This method makes it possible to form the
7.9  Summary
225

observation equations in a general way, and then a priori information can be added
to keep some references ﬁxed, such as the clock error of the reference satellite and
the coordinates of the reference station. As a special case of the a priori parameter
constraints, a so-called a priori datum method was discussed. The advantage of this
method is that the a priori constraints just change the normal equation by adding a
term (the a priori weight matrix), so that all discussed least squares adjustment and
ﬁltering methods can be directly used for solving the rank-deﬁcient problems.
Linear conditions related to the coordinate parameters can be introduced using this
method. A quasi-stable datum method was also discussed. From the point of view
of the dynamic earth, none station is ﬁxed. The quasi-stable datum method takes
such dynamic behaviour of the stations into account.
References
Cui X, Yang Y (2006) Adaptively Robust Filtering with Classiﬁed Adaptive Factors. Progress in
Natural Science 16(8):846–851
Cui X, Yang Y, Gao W (2006) Comparison of Adaptive Filter Arithmetics in Controlling
Inﬂuence of Colored Noises. Geomatics and Information Science of Wuhan University 31
(8):731-735
Cui X, Yu Z, Tao B, Liu D (1982) Adjustment in surveying. Surveying Press, Peking, (in Chinese)
Gao W, Feng X, Zhu D (2007a) GPS/INS Adaptively Integrated Navigation Algorithm Based on
Neural Network. Journal of Geodesy and Geodynamics 27(2):64-67
Gao W, Yang Y, Cui X, Zhang S (2006a) Application of Adaptive Kalman Filtering Algorithm in
IMU/GPS Integrated Navigation System. Geomatics and Information Science of Wuhan
University 31(5):466-469
Gao W, Yang Y, Zhang S (2006b) Adaptive Robust Kalman Filter Based on the Current Statistical
Model. Acta Geodaetica et Cartographica Sinica 35(1):15-18
Gao W, Yang Y, Zhang T (2007b) Neural Network Aided Adaptive Filtering for GPS/INS
Integrated Navigation. Acta Geodaetica et Cartographica Sinica 36(1):26-30
Gao W, Yang Y, Zhang T (2008) An Adaptive UKF Algorithms for Improving the Generalizaiton
of Neural Network. Geomatics and Information Science of Wuhan University 33(5):500-503
Gotthardt E (1978) Einführung in die Ausgleichungsrechnung. Herbert Wichmann Verlag,
Karlsruhe
Huang G, Yang Y, Zhang Q (2011) Estimate and Predict Satellite Clock Error Using Adaptively
Robust Sequential Adjustment with Classiﬁed Adaptive Factors Based on Opening Windows.
Acta Geodaetica et Cartographica Sinica 40(1):15-21
Huang G, Zhang Q (2012) Real-time estimation of satellite clock offset using adaptively robust
Kalman ﬁlter with classiﬁed adaptive factors. GPS Solutions 16(4):531-539
Huber PJ (1964) Robust estimation of a location parameter. Ann Math Stat 35:73–101
Jazwinski AH (1970) Stochastic processes and ﬁltering theory. In: Mathematics in science and
engineering, Vol. 64. Academic Press, New York and London
Koch KR (1986) Maximum likelihood estimate of variance components. Bulletin Géodésique,
60:329–338
Koch KR (1988) Parameter estimation and hypothesis testing in linear models. Springer-Verlag,
Berlin
Koch
KR,
Yang
Y
(1998a)
Konﬁdenzbereiche
und
Hypothesentests
für
robuste
Parameterschätzungen. ZfV 123(1):20–26
226
Chapter 7  Adjustment and Filtering Methods

Koch KR, Yang Y (1998b) Robust Kalman ﬁlter for rank deﬁcient observation model. J Geodesy
72: 436–441
Masreliez CJ, Martin RD (1977) Robust Bayesian estimation for the linear model and robustifying
the Kalman ﬁlter. IEEE T Automat Contr AC-22:361–371
Mohamed AH, Schwarz KP (1999) Adaptive Kalman ﬁltering for INS/GPS. J Geodesy 73:
193–203
Ou J, Chai Y, Yuan Y (2004) Adaptive ﬁltering for kinematic positioning by selection of the
parameter weights. In: Zhu, Y. and Sun, H. (eds) Progress in Geodesy and Geodynamics.
Hubei Science & Technology Press, Hubei, 816–823 (in Chinese)
Ou JK (2004) Private communication
Ren C, Ou J, Yuan Y (2005) Application of adaptive ﬁltering by selecting the parameter weight
factor in precise kinematic GPS positioning. Prog. Nat. Sci., 15(1), 41–46
Salzmann M (1995) Real-time adaptation for model errors in dynamic systems. B Geod 69:81–91
Schaffrin B (1991) Generating robustiﬁed Kalman ﬁlters for the integration of GPS and INS.
Techni-cal Report, No. 15, Institute of Geodesy, University of Stuttgart
Schwarz K-P, Cannon ME, Wong RVC (1989) A Comparison of GPS kinematic models for the
determination of position and velocity along a trajectory. Manuscr Geodaet 14:345–353
Sui L, Liu Y, Wang W (2007) Adaptive Sequential Adjustment and Its Application. Geomatics
and Information Science of Wuhan University 32(1):51-54
Teunissen P (1990) An integrity and quality control procedure for use in multi sensor integration.
In: Proceedings ION GPS90, pp. 513–522
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese)
Wu F, Yang Y (2010) A New Two-Step Adaptive Robust Kalman Filtering in GPS/INS Integrated
Navigation System. Acta Geodaetica et Cartographica Sinica 39(5):522-533
Xu G (2002) GPS data processing with equivalent observation equations, GPS Solutions, Vol. 6,
No. 1-2, 6:28-33
Xu G (2003) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English
Xu G (2007) GPS – Theory, Algorithms and Applications, 2nd Ed. Springer Heidelberg, ISBN
978-3-540-72714-9, 350 pages
Xu G, Qian Z (1986) The application of block elimination adjustment method for processing of the
VLBI Data. Crustal Deformation and Earthquake, Vol. 6, No. 4, (in Chinese)
Xu T, Yang Y (2000) The Improved Method of Sage Adaptive Filtering. Science of Surveying and
Mapping 25(3):22-24
Yang M, Tang CH, Yu TT (2000) Development and assessment of a medium-range real-time
kinematic GPS algorithm using an ionospheric information ﬁlter. Earth Planets Space 52
(10):783–788
Yang Y (1991) Robust Bayesian estimation. B Geod 65:145–150
Yang Y (1997a) Estimators of covariance matrix at robust estimation based on inﬂuence functions.
ZfV 122(4):166–174
Yang Y (1997b) Robust Kalman ﬁlter for dynamic systems. Journal of Zhengzhou Institute of
Surveying and Mapping 14:79–84
Yang Y (1999) Robust estimation of geodetic datum transformation. J Geodesy 73:268–274
Yang Y, Chai H, Song L (1999) Approximation for Contaminated Distribution and Its
Applications. Acta Geodaetica et Cartographic Sinica 28(3):209–214
Yang Y, Cui X (2006) Adaptively Robust Filter with Multi Adaptive Factors. J. Surv. Eng.
Yang Y, Cui X (2008) Adaptively Robust Filter with Multi Adaptive Factors. Survey Review 40
(309):260-270
Yang Y, Gao W (2006a) A New Learning Statistic for Adaptive Filter Based on Predicted
Residuals. Progress in Natural Science 16(8):833-837
Yang Y, Gao W (2006b) An Optimal Adaptive Kalman Filter. Journal of Geodesy 80(4):177-183
Yang
Y,
Gao
W
(2005)
Comparison
of
Adaptive
Factors
on
Navigation
Results.
The J. Navigation, 2005, 58: 471-478.
References
227

Yang Y, Gao W (2005) Inﬂuence comparison of adaptive factors on navigation results. Journal of
Navigation 58, 471–478
Yang Y, Gao W (2006c) Optimal Adaptive Kalman Filter with Applications in Navigation.
J Geodesy
Yang Y, He H, Xu G (2001a) Adaptively robust ﬁltering for kinematic geodetic positioning.
J Geodesy 75:109–116
Yang Y, Ren X, Xu Y (2013) Main Progress of Adaptively Robust Filter with Application in
Navigation. Journal of Navigation and Positioning 1(1):9-15
Yang Y, Tang Y, Li Q and Zou Y (2006) Experiments of Adaptive Filters for Kinemetic GPS
Positioning Applied in Road Information Updating in GIS. J. Surv. Eng. (in press)
Yang Y, Wen Y (2004) Synthetically adaptive robust ﬁltering for satellite orbit determination.
Science in China Series D Earth Sciences 47(7):585-592
Yang Y, Xu T (2003) An Adaptive Kalman Filter Based on Sage Windowing Weights and
Variance Components. Journal of Navigation 56(2):231-240
Yang Y, Xu T (2004) An Adaptively Regularization Method with Combination of Priori and
Posterior Information. In: Zhu, Y. and Sun, H. (eds) Progress in Geodesy and Geodynamics.
Hubei Science & Technology Press, Hubei
Yang Y, Xu T, He H (2001b) On adaptively kinematic ﬁltering. Selected Papers for English of
Acta Geodetica et Cartographica Sinica, pp. 25–32
Yang Y, Zeng A (2009) Adaptive Filtering for Deformation Parameter Estimation in
Consideration of Geometrical Measurements and Geopgysical Models. Science in China
Series D Earth Sciences 52(8):1216-1222
Yang Y, Zhang X, Xu J (2011) Adaptively Constrained Kalman Filtering for Navigation
Applications. Survey Review 43(322):370-381
Zhang S, Yang Y, Zhang Q (2007) An Adaptively Robust Filter Based on Bancroft Algorithm in
GPS Navigation. Geomatics and Information Science of Wuhan University 32(4):309-311
Zhou J (1985) On the Jie factor. Acta Geodaetica et Geophysica 5 (in Chinese)
Zhou J, Huang Y, Yang Y, Ou J (1997) Robust least squares method. Publishing House of
Huazhong University of Science and Technology, Wuhan
228
Chapter 7  Adjustment and Filtering Methods

Chapter 8
Cycle Slip Detection and Ambiguity
Resolution
Ambiguity problems can arise during phase measurement when the receiver loses
its lock on the signal, and phase measurement must be reinitiated. This phe-
nomenon is called cycle slip, i.e. the cycle count must begin again because of a
signal interruption. The consequence of a cycle slip is an observable jump by an
integer number of cycles in the adjacent carrier phase, and a new ambiguity
parameter is required in the related observation model. Accurate cycle slip detection
thus ensures correct ambiguity parameterisation. Here, we begin with a discussion
of cycle slip detection, after which we will focus on integer ambiguity resolution,
including integer ambiguity search criteria. We also provide an outline and dis-
cussion of the historical ambiguity function method.
8.1
Cycle Slip Detection
Recalling the discussions in Sect. 6.5, several methods of cycle slip detection can
be summarised as follows.
1. Phase–Code Comparison
Using the ﬁrst equation of 6.88
DtRj ¼ kjDtUj  kjDtNj þ e;
ð8:1Þ
cycle slips of the phase observable in working frequency j can be detected. Δt, Rj,
Φj, Nj, λj, ε, and j are the time difference operator, code range, phase, ambiguity,
wavelength, residual, and index of the frequency, respectively. In the case of no
cycle slips, the time difference of the ambiguity is zero, i.e. ΔtNj = 0. Because the
noise level of the code range is much higher than that of the phase, this method can
be used only for the detection of large cycle slips.
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_8
229

2. Phase–Phase Ionospheric Residual
Using Eq. 6.80
k1DtU1ðtjÞ  k2DtU2ðtjÞ ¼ k1DtN1  k2DtN2  DtDdionðtjÞ þ DtDep;
ð8:2Þ
cycle slips of the two phase observables in frequencies 1 and 2 can be detected.
ΔtΔδion(tj) is the so-called ionospheric residual. Generally speaking, the computed
ionospheric residual of the two adjacent epochs should be very small. Any unusual
change of the ionospheric residual may indicate cycle slips in one or two phases.
However, two special cycle slips, ΔN1 and ΔN2, can lead also to a very small
combination of λ1ΔtN1–λ2ΔtN2. Examples of such combinations can be found, for
example, in Hofmann-Wellenhof et al. (1997). Therefore, a large ionospheric
residual indicates cycle slips, but a small ionospheric residual does not guarantee
the absence of cycle slips. Another shortcoming of this method is that the iono-
spheric residual itself provides no means of determining the speciﬁc phase in which
the cycle slip occurs.
3. Doppler Integration
Using Eq. 6.87
DtNj ¼ DtUj 
Ztj
tj1
Djdt þ e;
j ¼ 1; 2; 5;
ð8:3Þ
cycle slips of the phase observable in working frequency j can be detected. Dj is the
Doppler observable of frequency j. Recalling the discussions made in Chap. 4,
the phase is measured by keeping track of the partial phase and accumulating the
integer count. If there is any loss of lock of the signal during this time, the integer
accumulation will be inaccurate, i.e. a cycle slip occurs. Therefore, external
instantaneous Doppler integration is a good choice for cycle slip detection. The
integration can be made ﬁrst by ﬁtting the Doppler data with a polynomial of
suitable order, and then integrating that within the desired time interval. Polynomial
ﬁtting and numerical integration methods can be found in Sects. 11.5.2 and 3.4.
4. Differential Phases (of Time)
Using the ﬁrst equation of 6.86
kjDtUj ¼ Dtq  Dtðdtr  dteÞc þ kjDtNj þ ep;
j ¼ 1; 2;
ð8:4Þ
cycle slips can be detected. Except for the ambiguity term, all other terms on the
right side are of low variation. Any cycle slips will lead to a sudden jump of the
time difference of the phases. The differenced data may be ﬁtted with polynomials,
and the polynomials can be used for interpolating or extrapolating the data at the
checking epoch; the computed and differenced data then can be compared to decide
if there are any cycle slips.
230
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

8.2
Method of Dealing with Cycle Slips
As soon as the cycle slips have been detected, there are two ways to deal with them.
One is to repair the cycle slips; the other is to set a new ambiguity unknown parameter
in the GPS observation equations. To repair the cycle slips, the cycle slips have to be
known exactly. Any incorrect reparation will affect all later observations. Setting a
new unknown ambiguity parameter after a cycle slip is a more secure method, as there
will be more unknowns in the observation equations. However, there exists a con-
dition between the former ambiguity parameter N(1) and the new one N(2), i.e.
Nð1; i; j; kÞ ¼ Nð2; i; j; kÞ þ Iði; j; kÞ;
ð8:5Þ
where I is an integer constant, and i, j, and k are indices of the receiver, satellite, and
observing frequency, respectively. For any solution of N(1) and N(2) with good
qualities, the integer constant should be able to be easily distinguished. If I = 0,
then no cycle slips have actually occurred.
If instrumental biases have not been modelled, the biases may destroy the integer
property of the original ambiguity parameters. However, in such a case, the
double-differenced ambiguities are still integers.
8.3
A General Criterion of Integer Ambiguity Search
In this section, we propose an integer ambiguity search method based on condi-
tional adjustment theory. By taking the coordinate and ambiguity residuals into
account, a general criterion for ambiguity searching is derived. The search can be
carried out in both ambiguity and coordinate domains. The optimality and
uniqueness properties of the general criterion are also discussed. A numerical
explanation of the general criterion is outlined. An equivalent criterion of the
general criterion is derived based on a diagonalised normal equation, which shows
that the commonly used least squares ambiguity search (LSAS) criterion is just one
of the terms of the equivalent general criterion. Numerical examples are given to
illustrate the two components of the equivalent criterion.
8.3.1
Introduction
It is well known that ambiguity resolution is a major problem that must be solved in
GPS precise positioning. Some well-derived ambiguity ﬁxing and search algorithms
have been published over the last ten years. Four types of methods have been
8.2  Method of Dealing with Cycle Slips
231

categorised. The ﬁrst includes Remondi’s static initialisation approach (cf., e.g.,
Remondi 1984; Wang et al. 1988; Hofmann-Wellenhof et al. 1997), which requires
a static survey time to solve the ambiguity unknowns even after a complete loss of
lock. Normally, the results are good enough to take a round up ambiguity ﬁxing.
The second type includes the so-called phase–code combined methods (cf., e.g.,
Remondi 1984; Han and Rizos 1997; Sjoeberg 1999); the phase and code must be
used in the derivation as though they have the same precision, and in the case of
anti-spooﬁng (AS), the C/A code must be used. A search process is still needed in
this case. The third type is the so-called ambiguity function method (Remondi
1984; Han and Rizos 1997); its search domain is geometric. The fourth type
includes approaches in which the search domain is only in the domain of ambiguity,
including some optimal algorithms for reducing the search area and accelerating the
search process (cf., e.g., Euler and Landau 1992; Teunissen 1995; Cannon et al.
1997; Han and Rizos 1997). Because of the statistical nature of validation criteria, it
is possible that no valid result will have been obtained at the end of the search
process. Gehlich and Lelgemann (1997) separated the ambiguities from the other
parameters; this is similar to the equivalent method (cf. Sect. 6.7).
The effort to develop KSGsoft (Kinematic/Static GPS Software) at the
GeoForschungsZentrum (GFZ) in Potsdam was initiated at the beginning of 1994 due
to requirements of kinematic GPS positioning in aerogravimetry applications (Xu et al.
1998). An optimal ambiguity resolution method was needed in order to integrate it into
the software; however, selecting the published algorithms has proven to be a difﬁcult
task. This has led to the independent development of this so-called integer ambiguity
search method, which appears to be a very promising algorithm. This general criterion
canbeusedtosearchfor and ﬁndanoptimal solutionvector. Thesearchresultisoptimal
under the least squares principle and integer ambiguity property.
In the following sections, a brief summary of the conditional adjustment is given
for convenience of discussion. Ambiguity searches in the ambiguity domain and
both ambiguity and coordinate domains are then discussed. Properties of the gen-
eral criterion are discussed, and an equivalent criterion of the general criterion is
derived. Numerical examples, conclusions, and comments are provided.
8.3.2
Summary of Conditional Least Squares Adjustment
The principle of least squares adjustment with condition equations can be sum-
marised as follows (for details cf. Sect. 7.4; Gotthardt 1978; Cui et al. 1982):
1. The linearised observation equation system can be represented by
V ¼ L  AX; P;
ð8:6Þ
where L is the observation vector of dimension m, A is the coefﬁcient matrix of
dimension m × n, X is the unknown vector of dimension n, V is the residual
232
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

vector of dimension m, n, and m are numbers of unknowns and observations,
and P is the symmetric and quadratic weight matrix of dimension m × m.
2. The condition equation system can be written as
CX  W ¼ 0;
ð8:7Þ
where C is the coefﬁcient matrix of dimension r × n, W is the constant vector of
dimension r, and r is the number of conditions.
3. The least squares criterion for solving the observation equations with condition
equations is well-known as
VTPV ¼ min;
ð8:8Þ
where VT is the transpose of the related vector V.
4. The solution of the conditional problem in Eqs. 8.6 and 8.7 under the least
squares principle of Eq. 8.8 is then
Xc ¼ ðATPAÞ1ðATPLÞ  ðATPAÞ1CTK
¼ ðATPAÞ1ðATPL  CTKÞ
ð8:9Þ
and
K ¼ ðCQCTÞ1ðCQW1  WÞ;
ð8:10Þ
where AT and CT are the transpose matrices of A and C, superscript −1 is an
inversion operator, Q = (ATPA)−1, K is a gain vector (of dimension r), index c is
used to denote the variables related to the conditional solution, and W1 = ATPL.
5. The precisions of the solutions are then
p½i ¼ sd
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Qc½i½i;
p
ð8:11Þ
where i is the element index of a vector or a matrix,
ﬃ
p is the square root
operator, sd is the standard deviation (or sigma) of unit weight, p[i] is the ith
element of the precision vector, Qc[i][i] is the ith diagonal element of the
quadratic matrix Qc, and
Qc ¼ Q  QCTQ2CQ;
ð8:12Þ
Q2 ¼ ðCQCTÞ
1;
ð8:13Þ
sd ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðVTPVÞc
m  n þ r
r
;
if ðm [ n  rÞ:
ð8:14Þ
8.3  A General Criterion of Integer Ambiguity Search
233

6. For recursive convenience, (VTPV)c can be calculated by using
ðVTPVÞc ¼ LTPL  ðATPLÞTXc  WTK:
ð8:15Þ
Above are the complete formulas of conditional least squares adjustment. The
application of such an algorithm for the purpose of integer ambiguity search will be
further discussed in later sections.
8.3.3
Float Solution
GPS observation equation can be represented with Eq. 8.6. Considering the case
without condition (Eq. 8.7), i.e. C = 0 and W = 0, the least squares solution of
Eq. 8.6 is
X0 ¼ QðATPLÞ ¼ QW1;
ð8:16Þ
and
ðVTPVÞ0 ¼ LTPL  ðATPLÞTX0;
ð8:17Þ
sd ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðVTPVÞ0
m  n
r
;
if ðm [ nÞ and
ð8:18Þ
p½i ¼ sd
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i½i
p
;
ð8:19Þ
where index 0 is used for convenience to denote the variables related to the least
squares solution without conditions. X0 is the complete unknown vector including
coordinates and ambiguities and is called a ﬂoat solution later on. Solution X0 is the
optimal one under the least squares principle. However, because of the observation
and model errors as well as method limitations, ﬂoat solution X0 may not be exactly
the right one, e.g., the ambiguity parameters are real numbers and do not ﬁt to the
integer property. Therefore, one sometimes needs to search for a solution, say X,
which not only fulﬁls some special conditions, but also meanwhile keeps the
deviation of the solution as small as possible (minimum). This can be represented by
VT
x PVx ¼ min;
ð8:20Þ
or equivalently by a symmetric quadratic form of (cf. also Eq. 8.35 derived later)
ðX0  XÞTQ1ðX0  XÞ ¼ min:
ð8:21Þ
234
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

In Eq. 8.20, Vx is the residual vector in the case of solution X. For simpliﬁcation,
let
X ¼
Y
N


;
Q ¼
Q11
Q12
Q21
Q22


;
W1 ¼ ATPL ¼
W11
W12


;
M ¼ ATPA ¼
M11
M12
M21
M22


;
M ¼ Q1;
ð8:22Þ
where Y is the coordinate vector, N is the ambiguity vector (generally, a real vector).
The ﬂoat solution is denoted by
X0 ¼
Y0
N0


¼
Q11W11 þ Q12W12
Q21W11 þ Q22W12


;
where X0 is the solution of Eq. 8.6 without Condition 8.7.
8.3.4
Integer Ambiguity Search in Ambiguity Domain
To use the conditional adjustment algorithm for integer ambiguity searching in the
ambiguity domain, the condition shall be selected as N = W; here W of course is an
integer vector. Generally, letting C = (0, E), then Condition 8.7 becomes
N ¼ W:
ð8:23Þ
Using the deﬁnitions of C and Q, one has
CQ ¼
Q21
Q22
ð
Þ
and
CQCT ¼ Q22:
The gain KN can be computed by using Eq. 8.10:
KN ¼ Q1
22 ðCQW1  WÞ ¼ Q1
22 ðN0  WÞ:
ð8:24Þ
So under Condition 8.23, the conditional least squares solution in Eq. 8.9 can be
written as
Xc ¼
Yc
Nc


¼
Q11
Q12
Q21
Q22


W11
W12  KN


¼
Y0
N0



Q12
Q22


KN:
ð8:25Þ
8.3  A General Criterion of Integer Ambiguity Search
235

Simplifying Eq. 8.25, one gets
Yc ¼ Y0  Q12KN
ð8:26Þ
and
Nc ¼ N0  Q22KN ¼ N0  Q22Q1
22 ðN0  WÞ ¼ W:
ð8:27Þ
The precision computing formulas under Condition 8.23 can be derived as
follows:
Qc ¼ Q  QCTQ1
22 CQ ¼
Q11  Q12Q1
22 Q21
0
0
0


and
ð8:28Þ
ðVTPVÞc ¼ LTPL  ðATPLÞTXc  WTKN
¼ LTPL  ðATPLÞTX0 þ ðATPLÞT
Q12
Q22


KN  WTKN
¼ ðVTPVÞ0 þ WT
1
WT
2


Q12
Q22


KN  WTKN
¼ ðVTPVÞ0 þ ðN0  WÞTKN
¼ ðVTPVÞ0 þ ðN0  WÞTQ1
22 ðN0  WÞ
;
ð8:29Þ
where (VTPV)0 is the value obtained without Condition 8.23. The second term on
the right side of the last line in Eq. 8.29 is the often-used LSAS criterion for an
integer ambiguity search in the ambiguity domain, which can be expressed as
dðdNÞ¼ ðN0  NÞTQ1
22 ðN0  NÞ:
ð8:30Þ
It indicates that any ambiguity ﬁxing will cause an enlargement of the standard
deviation. However, one may also notice that here only the enlargement of the
standard deviation caused by ambiguity parameter changing has been considered.
Furthermore, Condition 8.23 does not really exist. Ambiguities are integers; how-
ever, they are unknowns. The formula to compute the accuracy vector of the
ambiguity also does not exist, because the ambiguity condition is considered
exactly known in conditional adjustment.
8.3.5
Integer Ambiguity Search in Coordinate and Ambiguity
Domains
In order to see the enlargement of the standard deviation caused by the ﬁxed solu-
tion, the condition shall be selected as X = W; here, W consists of two sub-vectors
236
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

(coordinate and ambiguity parameter-related sub-vectors), and only the ambiguity
parameter-related sub-vector is an integer type. Letting C = E, Condition 8.7 is then
X ¼ W:
ð8:31Þ
One has
CQ ¼ CQCT ¼ Q:
Denote X0 = QW1; here X0 is the solution of Eq. 8.6 without Condition 8.31.
The gain K can be computed using Eq. 8.10:
K ¼ Q1ðCQW1  WÞ ¼ Q1ðX0  WÞ:
ð8:32Þ
Thus, under Condition 8.31, the conditional least squares solution in Eq. 8.9 can be
written as
Xc ¼ X0  QK ¼ X0  QQ1ðX0  WÞ ¼ W:
ð8:33Þ
Precision computing formulas under Condition 8.31 can be derived as follows:
Qc ¼ 0;
ðVTPVÞc ¼ LTPL  ðATPLÞTXc  WTK
¼ LTPL  ðATPLÞTX0 þ ðATPLÞTðX0  XcÞ  WTK
¼ ðVTPVÞ0 þ WT
1 QK  WTK
¼ ðVTPVÞ0 þ ðX0  WÞTK
¼ ðVTPVÞ0 þ ðX0  WÞTQ1ðX0  WÞ
;
ð8:34Þ
where (VTPV)0 is the value obtained without Condition 8.31.
Condition 8.31 will force the observation Eq. 8.6 to take the condition W as the
solution and will take the zero value as the precision of the conditional solution (i.e.
the precision is undeﬁned). The reason for this is that the condition is considered
exactly known in conditional adjustment. The second term on the right side of
Eq. 8.34 is denoted as
d ¼ X0X
ð
ÞTQ1 X0X
ð
Þ:
ð8:35Þ
This term in Eq. 8.34 indicates that any solution vector X that is different from
the ﬂoat solution vector X0, will enlarge the weighted squares residuals. It is well
known that the ﬂoat solution is the optimal solution under the least squares prin-
ciple. Therefore, statistically, the optimal solution X shall be the X that takes the
minimum value of δ in Eq. 8.35. Mathematically speaking, Eq. 8.35 is the “dis-
tance” between vector X and X0 in the solution space (of dimension n). If one
considers n = 3 and Q−1 to be a diagonal matrix, then δ is the geometric distance of
point X and X0 in a cubic space. So Eq. 8.35 can be used as a general criterion to
8.3  A General Criterion of Integer Ambiguity Search
237

express the nearness of the two vectors. By using criterion of Eq. 8.35, one may
search for solution X in the area being searched so that the value of δ reaches the
minimum. Under such a criterion, the deviation of the result vector X related to the
ﬂoat vector X0 is homogenously considered.
Furthermore, Condition 8.31 is considered exactly known in conditional ad-
justment. However, in integer ambiguity, searching, we just know the ambiguities
are integers, but their values are indeed not known, or they are known with
uncertainty (precision) within an area around the ﬂoat solution. So the best solution
shall be searched for. For computing the precision of the searched X, the formulas
of least squares adjustment shall be further used, and meanwhile the enlarged
residuals shall be taken into account by
p½i ¼ sd
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q½i][i]
p
;
sd ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðVTPVÞc
m  n
r
;
if m [ n
ð
Þ
and
ðVTPVÞc ¼ ðVTPVÞ0 þ d:
ð8:36Þ
In other words, the original Q matrix and (VTPV)0 of the least squares problem in
Eq. 8.6 are further used. The δ has the function of enlarging the standard deviation.
The precision computing formulas have nothing to do with the conditions.
Searching for a minimum δ leads to a minimum of standard deviation sd, and
therefore the best precision values.
Equation 8.35 is called the general criterion (Xu’s general criterion) of an integer
ambiguity search, which may be used for searching for the optimal solution in the
ambiguity domain, or both coordinate and ambiguity domains (cf. Xu 2002a). In
most cases, the search will be started from the ambiguity domain. An integer vector
N can be selected in the search area, then the related coordinate vector Y can be
computed using the consistent relation of Y and N (cf. Eqs. 8.26 and 8.24). The
optimal solution searched shall be that X which leads Eq. 8.35 to a minimum value.
In the case of searching in the ambiguity domain, X consists of the selected
sub-vector of Nc in Eq. 8.27 and the computed coordinate sub-vector Yc in
Eq. 8.26, i.e.
W ¼
Yc
Nc


:
ð8:37Þ
8.3.6
Properties of Xu’s General Criterion
1. Equivalence of the Two Search Scenarios
It should be emphasised that the same search criterion of Eq. 8.35 and the same
formulas of precision estimation in Eq. 8.36 are used in the two integer ambiguity
238
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

search scenarios. And the same normal equation of 8.6 is used to compute the Yc
using the selected Nc if necessary. The two search processes indeed deal with the
same problem, just with different methods of searching.
Suppose that by searching in the ambiguity domain, the vector X = (Yc Nc)T is
found so that δ reaches the minimum, where Nc is the selected integer sub-vector
and Yc is computed. And in the case of searching in both coordinate and ambiguity
domains, a candidate vector X = (Y N)T is selected so that δ reaches the minimum,
where N is the selected integer sub-vector and Y is the selected coordinate vector.
Because of the optimality and uniqueness properties of the vector X in Eq. 8.35
(please refer to 2, which is discussed next), here the selected (Y N)T must be equal
to (Yc Nc)T. Thus the theoretical equivalence of the two search processes is
conﬁrmed.
2. Optimality and Uniqueness Properties
The ﬂoat solution X0 is the optimal and unique solution of Eq. 8.6 under the
principle of least squares. A minimum of δ in Eq. 8.35 will lead to a minimum of
(VTPV)c in Eq. 8.36. Therefore, using the criterion of Eq. 8.35 analogously, the
searched vector X is the optimal solution of Eq. 8.6 under the least squares principle
and integer ambiguity properties. The uniqueness property is obvious. If X1 and X2
are such that δ(X1) = δ(X2) = min or δ(X1) −δ(X2) = 0, then by using Eq. 8.35,
one may assume that X1 must be equal to X2.
3. Geometric Explanation of Xu’s General Criterion
Geometrically, d ¼ ðX0  XÞTQ1ðX0  XÞ is the “distance” between the vector
X and ﬂoat vector X0. The distance contributed to enlarge the standard deviation sd
(cf. Eq. 8.36). Ambiguity searching is then the search for the solution vector with
the integer ambiguity property and with the minimum distance to the ﬂoat solution
vector.
8.3.7
An Equivalent Ambiguity Search Criterion and Its Properties
Suppose the undifferenced GPS observation equation and related LS normal
equation are
V ¼ L  A1
A2
ð
Þ
X1
X2


;
P
ð8:38Þ
M11
M12
M21
M22


X1
X2


¼
W1
W2


;
ð8:39Þ
8.3  A General Criterion of Integer Ambiguity Search
239

where
AT
1PA1
AT
1PA2
AT
2PA1
AT
2PA2
 
!
¼
M11
M12
M21
M22


¼ M;
M1 ¼ Q ¼
Q11
Q12
Q21
Q22


;
W1 ¼ AT
1PL
and
W2 ¼ AT
2PL:
ð8:40Þ
Where all symbols have the same meanings as that of Eqs. 7.117 and 7.118.
Equation 8.39 can be diagonalised as (cf. Sect. 7.6.1)
M1
0
0
M2


X1
X2


¼
B1
B2


;
ð8:41Þ
where
Q11 ¼ M1
1 ;
Q22 ¼ M1
2
Q12 ¼ M1
11 ðM12Q22Þ;
Q21 ¼ M1
22 ðM21Q11Þ :
ð8:42Þ
The related equivalent observation equation of the diagonal normal Eq. 8.41 can be
written (cf. Sect. 7.6.1)
U1
U2


¼
L
L



D1
0
0
D2


X1
X2


;
P
0
0
P


;
ð8:43Þ
where all symbols have the same meanings as that of Eqs. 7.140 and 7.142.
Suppose the GPS observation equation is Eq. 8.38 and the related least squares
normal equation is Eq. 8.39, where X2 = N (N is the ambiguity sub-vector) and
X1 = Y (Y is the other unknown sub-vector). The general criterion is (cf. Eq. 8.35)
dðdXÞ ¼ X0X
ð
ÞTQ1 X0X
ð
Þ;
ð8:44Þ
where X = (Y N)T, X0 = (Y0 N0)T, dX = X0 −X and index 0 denotes the ﬂoat
solution. The search process in the ambiguity domain is to ﬁnd a solution X (which
includes N in the search area and the computed Y) so that the value of δ(dX) reaches
the minimum. The optimality property of this criterion is obvious.
For the equivalent observation Eq. 8.43, the related least squares normal equa-
tion is Eq. 8.41. The related equivalent general criterion is then (putting the diag-
onal cofactor of Eq. 8.41 into Eq. 8.44 and taking Eqs. 8.40 and 8.42 into account)
d1ðdXÞ ¼ ðY0  YÞTQ1
11 ðY0  YÞ þ ðN0  NÞTQ1
22 ðN0  NÞ
¼ dðdYÞ þ d dN
ð
Þ;
ð8:45Þ
240
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

where index 1 is used to distinguish criterion of Eq. 8.45 from Eq. 8.44. The
observation Eqs. 8.38 and 8.43 are equivalent, and the related normal Eqs. 8.39 and
8.41 are also equivalent. Therefore, Criterion 8.45 is called an equivalent criterion
(or Xu’s equivalent criterion) of Xu’s general Criterion 8.44. Zhang et al. (2016)
proved that the equivalent criterion was identical to the general criterion by
expanding the general criterion. The equivalent criterion is clearly better and easier
for use in practice than the general criterion.
Furthermore, Y and N shall be consistent with each other because they are
presented in the same normal Eqs. 8.39 and 8.41. Using condition W = N and
notation of Eq. 8.42, one has from Eqs. 8.26 and 8.24
Y0  Y ¼ Q12Q1
22 ðN0  NÞ:
ð8:46Þ
Putting Eq. 8.46 into Eq. 8.45, one has
d1ðdXÞ ¼ ðN0  NÞT½Q1
22 ðE þ Q21Q1
11 Q12Q1
22 ÞðN0  NÞ:
ð8:47Þ
It is notable that the second term δ(dN) of the equivalent criterion Eq. 8.45 is
exactly the same as the commonly used LSAS criterion of Eq. 8.30 (cf., e.g.,
Teunissen 1995; Leick 1995; Hofmann-Wellenhof et al. 1997; Euler and Landau
1992; Han and Rizos 1997). Through Eq. 8.47 one may clearly see the differences
between the criteria of Eqs. 8.30 and 8.45. When the results searched using
Eq. 8.30 are different from that of using Eq. 8.45, the results from the search using
Eq. 8.30 shall be only sub-optimal ones due to the optimality and uniqueness
property of Eq. 8.45. The ﬁrst term on the right side of Eq. 8.45 signiﬁes an
enlarging of the residuals due to the coordinate change caused by ambiguity ﬁxing
(cf. Sect. 8.3.3). The second term on the right side of Eq. 8.45 signiﬁes an enlarging
of the residuals due to the ambiguity change caused by ambiguity ﬁxing (cf.
Sect. 8.3.4). Equation 8.45 takes both effects into account.
1. Optimality and Uniqueness Properties of Xu’s Equivalent Criterion
The ﬂoat solution X0 is the optimal and unique solution of Eq. 7.117 under the
least squares principle. Criterion Eq. 8.45 is equivalent to criterion Eq. 8.44.
A X leads to the minimum of δ1(dX) in Eq. 8.45, which will lead to the minimum of
δ(dX) in Eq. 8.44 and consequentially the minimum of (VTPV)c in Eq. 8.36;
therefore, using criterion of Eq. 8.45, analogously, the searched vector X is the
optimal solution of Eq. 8.38 under the least squares principle and integer ambiguity
properties. The uniqueness property is obvious. If one has X1 and X2 so that
δ1(dX1) = δ2(dX2) = min., or δ1(dX1) −δ1(dX2) = 0, then by using Eq. 8.45, one
may assume that X1 must be equal to X2.
It is notable that Eqs. 8.44 and 8.45 are equivalent for use in searching; however,
the equivalent one is preferred.
8.3  A General Criterion of Integer Ambiguity Search
241

8.3.8
Numerical Examples of the Equivalent Criterion
Several numerical examples are given here to illustrate the behaviour of the two
terms of the criterion. The ﬁrst and second terms on the right-hand side of Eq. 8.45
are denoted as δ(dY) and δ(dN), respectively. δ1(dX) = δ(dY) + δ(dN) is the
equivalent criterion of the general criterion and is denoted as δ(total). The term
δ(dN) is the LSAS criterion. Of course, the search is made in the ambiguity domain.
The search area is determined by the precision vector of the ﬂoat solution. All
possible candidates are tested one by one, and the related δ1(dX) are compared with
each other to ﬁnd the minimum.
In the ﬁrst example, precise orbits and dual-frequency GPS data of 15 April
1999 at station Brst (N 48.3805°, E 355.5034°) and Hers (N 50.8673°, E 0.3363°)
are used. The session length is 4 h. The total search candidate number is 1020.
Results of the two delta components are illustrated as 2-D graphics with the ﬁrst
axis of search number and the second axis of delta in Fig. 8.1. The red and blue
lines represent δ(dY) and δ(dN), respectively. δ(dY) reaches the minimum at search
no. 237, and δ(dN) at no. 769. δ(total) is plotted in Fig. 8.2, and it shows that the
general criterion reaches the minimum at search no. 493. For more detail, a portion
of the results are listed in Table 8.1.
δ(dN) reaches the second minimum at search no. 771. This example shows that
the minimum of δ(dN) may not lead to the minimum of total delta, because the
related δ(dY) is large. If the delta ratio criterion is used in this case, the LSAS
Fig. 8.1 Two components of the equivalent ambiguity search criterion
242
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

method will reject the found minimum and explain that no signiﬁcant ambiguity
ﬁxing can be made. However, because of the uniqueness principle of the general
criterion, the search reaches the total minimum uniquely.
The second example is very similar to the ﬁrst. The delta values of the search
process are plotted in Fig. 8.3, where δ(dY) is much smaller than δ(dN). δ(dN)
reaches the minimum at search no. 5 and δ(dY) at 171. δ(total) reaches the minimum
at search no. 129. The total 11 ambiguity parameters are ﬁxed and listed in
Table 8.2. Two ambiguity ﬁxings have just one cycle difference at the 6th ambi-
guity parameter. The related coordinate solutions after the ambiguity ﬁxings are
listed in Table 8.3. The coordinate differences at component x and z are about
5 mm. Even the results are very similar; however, two criteria do give different
results.
In the third example, real GPS data of 3 October 1997 at station Faim (N
38.5295°, E 331.3711°) and Flor (N 39.4493°, E 328.8715°) are used. The delta
values of the search process are listed in Table 8.4. Both δ(dN) and δ(total) reach
the minimum at search no. 5. This indicates that the LSAS criterion may sometimes
reach the same result as that of the equivalent criterion being used.
Fig. 8.2 Equivalent ambiguity search criterion
Table 8.1 Delta values of
search process
Search No.
δ(dN)
δ(dY)
δ(total)
237
183.0937
97.8046
280.8984
493
181.7359
97.9494
279.6853
769
93.3593
315.2760
408.6353
771
96.0678
343.5736
439.6414
8.3  A General Criterion of Integer Ambiguity Search
243

8.3.9
Conclusions and Comments
1. Conclusions
A general criterion and its equivalent criterion of integer ambiguity searching are
proposed in this section. Using these two criteria, the searched result is optimal and
Fig. 8.3 Example of equivalent ambiguity search criterion
Table 8.2 Two kinds of
ambiguity ﬁxing due to two
criteria
Ambiguity No.
1
2
3
4
5
6
7
8
9
10
11
LSAS ﬁxing
0
0
1
0
0
0
−1
0
0
−1
−1
General ﬁxing
0
0
1
0
0
−1
−1
0
0
−1
−1
Table 8.3 Ambiguity ﬁxed
coordinate solutions (in
meters)
Coordinates
x
y
z
LSAS ﬁxing
0.2140
−0.0449
0.1078
General ﬁxing
0.2213
−0.0465
0.1127
Table 8.4 Delta values of
the ambiguity search process
Search No.
δ(dN)
δ(dY)
δ(total)
1
248.5681
129.0555
377.6236
2
702.6925
58.9271
761.6195
3
889.5496
107.9330
997.4825
4
452.1952
42.3226
494.5178
5
186.7937
112.3030
299.0967
6
739.0487
55.9744
795.0231
7
931.4125
89.9074
1021.3199
8
592.1887
38.0969
630.2856
244
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

unique under the least squares minimum principle and under the condition of
integer ambiguities. The general criterion has a clear geometrical explanation. The
theoretical relationship between the equivalent criterion and the commonly used
LSAS criterion is obvious. It shows that the LSAS criterion is just one of the terms
of the equivalent criterion of the general criterion (this does not take into account
the residual enlarging effect caused by coordinate change due to ambiguity ﬁxing).
Numerical examples show that a minimum δ(dN) may have a relatively large δ(dY),
and therefore, a minimum δ(dN) may not guarantee a minimum δ(total). For an
optimal search, the equivalent criterion or the general criterion shall be used.
2. Comments
The ﬂoat solution is the optimal solution to the GPS problem under the least
squares minimum principle. Using the equivalent general criterion, the searched
solution is the optimal solution under the least squares minimum principle and
under the condition of integer ambiguities. However, the ambiguity search criterion
is just a statistical criterion. Statistical correctness does not guarantee correctness in
all applications. Ambiguity ﬁxing makes sense only with sufﬁciently good GPS
observables and accurate data processing models.
8.4
Ambiguity Resolution Approach Based on the General
Criterion
A general criterion and its equivalent criterion of integer ambiguity searching are
proposed in Sect. 8.3. In addition, the optimal criterion for ambiguity search is also
discussed in Xu et al. (2010). In this section we highlight an ambiguity resolution
approach called General Criterion Cascading Ambiguity Resolution (GECCAR),
proposed by Morujao and Mendes (2008), which selects the integer set of ambi-
guities using the general ambiguity search criterion.
The GECCAR is designed to instantaneous resolve the ambiguities for GPS and
galileo and it uses (1) a cascading procedure; (2) an a priori transformation to
decorrelate the ambiguities; (3) a search algorithm, where each ambiguity is con-
strained with the values of previously selected ambiguities; and (4) the general
ambiguity search criterion or the equivalent general criterion for integer ambiguity
selection.
The cascading procedure for the three-frequency systems was introduced by
Forsell et al. (1997), who developed the Three-Carrier Ambiguity Resolution
(TCAR) method for the galileo carrier phase ambiguity resolution, and by Jung
(1999), who suggested the Cascade Integer Resolution (CIR) method for the
modernised GPS. Although proposed for different systems, both methods are based
on the idea of wide-laning to take advantage of the stepwise-improved precision in
carrier phase ranges from the longest wavelength to the shortest wavelength. Both
methods are geometry-free, instantaneous integer ambiguity resolution methods,
8.3  A General Criterion of Integer Ambiguity Search
245

using integer rounding. Other approaches have been developed based on this
principle, such as the Integrated Three-Carrier Ambiguity Resolution (ITCAR)
(Vollath et al. 1998) and the geometry-based cascading ambiguity resolution
methods (Zhang et al. 2003).
The linear combinations used in the implemented algorithm are based on the set
of frequencies established for modernised GPS (L1, L2, L5) and for galileo (E1,
E5a, E5b).
The full GECCAR procedure consists of three steps: (1) The EWL (extra-wide
lane) ambiguities are estimated using the most precise pseudorange available and
the EWL phase combination as observables. (2) With the ranges based on the
results obtained in the ﬁrst step, the WL (wide lane) or the ML (medium lane)
ambiguities are estimated using the most precise pseudorange and the WL or the
ML phase combination as observables. (3) The L1/E1 ambiguities are estimated—
the observables used are the L1/E1, L2/E5b, and L5/E5a carrier phases, and the
unknown ambiguities are just the L1/E1 ambiguities as the L2/E5b and L5/E5a
ambiguities may be written in function of L1/E1, ML, WL, and EWL ambiguities
and the ML, WL, and EWL ambiguities have been estimated in the second and ﬁrst
steps, respectively.
In each step, we follow the decorrelation process proposed by Teunissen (1993).
Before estimating the ambiguities as integers, the ﬂoat ambiguities ^a are transformed
into an equivalent but less correlated set of ambiguities ^z, and the corresponding
variance-covariance matrix Q^a is transformed into the variance-covariance matrix
Q^z, using the Z-transformation:
^z ¼ ZT^a;
Q^z ¼ ZTQ^zZ;
ð8:48Þ
This Z-matrix needs to fulﬁl certain requirements in order to be admissible, as
the integer nature of the ambiguities should be maintained. Therefore, all entries in
the Z-matrix should be integers and the inverse of the Z-matrix should exist and its
entries should be integers as well (Teunissen 1994). The Z-transformation should
aim for maximum possible decorrelation of the ambiguities to make the search
algorithm more efﬁcient.
After the decorrelation, the search is performed over the search space region to
estimate the correct values of the ambiguity parameter vector. This is done by
constraining each ambiguity candidate on the values of the previously selected
ambiguities. In order to select the correct ambiguity set a
^ using the equivalent
general criterion, for each candidate a, the following should be performed: (1) the
computation of da; (2) the computation of b and db; (3) the computation of da +
db; (4) the selection of a
^ that minimises da + db, where da represents enlargement
of the residuals due to the ambiguity change caused by ambiguity ﬁxing, and db
represents an enlargement of the residuals due to the coordinate changes caused by
ambiguity ﬁxing.
To verify the effectiveness of the algorithm, real GPS data and simulated data from
a modernised GPS-only system, a galileo-only system, and both systems were used m.
Details can be found in Morujao and Mendes (2008). Results showed that the general
246
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

ambiguity search criterion represented a clear improvement in the selection of the
correct set of ambiguities. Thus we may conclude that the GECCAR approach is a
promising algorithm for instantaneous ambiguity resolution. Simulation runs have
shown that single-epoch ambiguity resolution was possible for 99 % of the considered
epochs when the three frequencies from both systems were used together.
8.5
Ambiguity Function
It is well known that in GPS precise positioning, ambiguity resolution is one of the
key problems that must be solved. Some well-derived ambiguity ﬁxing and search
algorithms have been published in the past. One of these methods is the ambiguity
function (AF) method, which can be found in many standard publications (Remondi
1984; Wang et al. 1988; Han and Rizos 1995; Hofmann-Wellenhof et al. 1997).
The principle of the ambiguity function method is to use the single-differenced
phase observation
UjðtkÞ¼ 1
k qjðtkÞ þ Nj  cðtkÞ;
ð8:49Þ
to form an exponential complex function
ei2p½UjðtkÞqjðtkÞ=k ¼ ei2p½NjcðtkÞ
ð8:50Þ
or
ei2p½UjðtkÞqjðtkÞ=k ¼ ei2pcðtkÞ;
ð8:51Þ
where Φ is the phase observable, ρ is the geometric distance of the signal trans-
mitting path, λ is the wavelength, index j denotes the observed satellite, tk is the kth
observational time, N is ambiguity, γ is the model of the receiver clock errors, and
i is the imaginary unit. All terms in Eq. 8.49 have the units of cycles and are
single-differenced terms. Property
ei2pNj ¼ 1
is used in order to get Eq. 8.51.
Making a summation over all satellites and then taking the modulus operation,
one has
X
nj
j¼1
ei2p½UjðtkÞqjðtkÞ=k

 ¼ njðkÞ;
ð8:52Þ
8.4  Ambiguity Resolution Approach Based on the General Criterion
247

where property
ei2pcðtkÞ

 ¼ 1
is used, nj is the satellite number and nj(k) is the observed satellite number at epoch k.
Making a summation of Eq. 8.52 over all the observed time epochs, one has
X
nk
k¼1
X
nj
j¼1
ei2p½UjðtkÞqjðtkÞ=k

 ¼
X
nk
k¼1
njðkÞ;
ð8:53Þ
where nk is the total epochs number. The left side of Eq. 8.53 is called the ambiguity
function, where unknowns are the coordinates of the remote station. The values of
the ambiguity function have to be computed for all candidates of coordinates, and the
optimum solution is found if the function reaches the maximum, i.e.
X
nk
k¼1
X
nj
j¼1
ei2p½UjðtkÞqjðtkÞ=k

 ) maximum:
ð8:54Þ
The search area can be determined by the standard deviations (σ) of the initial
coordinates (e.g., a cube with side lengths of 3σ or a sphere with a radius of 3σ).
The AF method is indeed an ambiguity free method. The ambiguity can be com-
puted using the optimal coordinate solution of Eq. 8.54.
Further discussion on the AF method is given in the next sub-section.
8.5.1
Xu’s Conjecture: Maximum Property of Ambiguity Function
The ambiguity function is discussed in Sect. 8.5. Here a numerical study of the
maximum property of the ambiguity function (AF)
is given. It seems that the
maximum value of the AF trends to be reached at the boundary of any given search
area. Numerical examples are given to illustrate the conclusion. However, a theo-
retical proof has still not yet been found; even the author tried to ﬁnd one, but
failed.
Numerical Examples
Several numerical examples are given here to illustrate the behaviours of the
ambiguity function criterion. The GPS data of the EU AGMASCO project (cf., e.g.,
Xu et al. 1997a) are used. Data are combined with the data of IGS network and
solved for precise coordinates as references. The station Faim (N 38.5295°,
E 331.3711°) is used as the reference and Flor (N 39.4493°, E 328.8715°) is used as
248
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

the remote station. The baseline length is about 240 km. The data length is about
4 h on 3 October 1997. KSGsoft (Xu et al. 1998) is used for computing a static
solution of the coordinates of Flor. The differences of the KSGsoft solution and IGS
solution are (0.26,1.93,1.37) cm in the global Cartesian coordinate system. Related
standard deviations of the KSGsoft solution are (0.04,0.04,0.02) cm. The differ-
ences are caused partly by the different data lengths. This assures a good standard
for the software being used.
The search step is selected as 1 mm. Tropospheric and ionospheric effects are
corrected. In the ﬁrst example, 3 h of data are used. The search area is a 3-D cube
with side lengths of ±(0.7,0.7,0.4) cm in (x, y, z). Results show that the AF
maximum is reached at point (–0.7,0.7,0.4) cm, which is on the boundary of the
area being searched.
A search process (with a search area of ±7 mm and 1 h of data) is illustrated in
2-D graphics with the ﬁrst axis containing search numbers and the second axis
containing AF values in Fig. 8.4. The graphic looks like a 3-D AF projection of the
cubic search area (the picture could be quite different in other examples). Figure 8.4
clearly shows the boundary maximum effect of the AF criterion. Expanding the
searched area (and, of course, its boundary), the maximum is reached on the new
boundary (of the new cubic surface).
Alternatively, the search may be made on a spherical surface with an expanding
radius. The results of such an example are illustrated in Fig. 8.5, where only radii of
1,2,…,10 mm are given. As the radius expands, the AF maximum becomes greater
and is always reached over the spherical surface with the maximum radius.
Fig. 8.4 3-D coordinate search using ambiguity function
8.5  Ambiguity Function
249

Theoretical Indications
The AF Eq. 8.54 is rewritten as
X
nk
k¼1
GðtkÞ ) max;
ð8:55Þ
GðtkÞ ¼ Sk
j
j;
Sk ¼
X
nj
j¼1
ei2pvjðtkÞ;
ð8:56Þ
vjðtkÞ ¼ UjðtkÞ  qjðtkÞ=k;
Y 2 X
and,
ð8:57Þ
ei2pvjðtkÞ ¼ cos(2pvjðtkÞÞ þ i sinð2pvjðtkÞÞ;
ð8:58Þ
where Y is the coordinate vector, Ω is to be the searched coordinate area and is a
closed area (i.e. it includes the boundary Γ), vj(tk) are the residuals of GPS obser-
vation equations (a continuous function of Y), Sk is a complex function of Y, and
G(tk) is the modulus of Sk.
If the GPS data sampling intervals are sufﬁciently close and the numerical
integration error is negligible (cf. Xu 1992), then one has
1
nk
X
nk
k¼1
GðtkÞ ¼ 1
T
Zte
t1
GðtÞ  dt;
ð8:59Þ
Fig. 8.5 Spherical coordinate search using ambiguity function
250
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

where T = te −t1, te = t(nk), and t1 and te are the beginning and end time of the
observations. According to the middle value theorem of the integration (cf., e.g.,
Bronstain and Semendjajew 1987; Wang et al. 1979) (such a theorem can be found
in all integration related books), one has a time point ξ(t1 < ξ<te) so that
1
T
Zte
t1
GðtÞ  dt ¼ GðnÞ;
ð8:60Þ
i.e. the AF can be represented by a unique G(t) at time ξ (the constant factor is
omitted here). Equation 8.54 turns out to be
GðnÞ ) max:
ð8:61Þ
Because of the deﬁnition of AF, G(ξ) is a modulus of a complex function.
In complex function analysis theory, there is a so-called maximum theorem (cf.,
e.g., Bronstain and Semendjajew 1987; Wang et al. 1979):
Maximum Modulus Theorem: if complex function f(z) is analytic within a limited
area Z and is continuous over the closed Z, then modulus |f(z)| reaches the maxi-
mum on the boundary Γ of Z.
However, this theorem cannot be directly used for Eq. 8.61 because it is valid
only for the analytic complex function deﬁned over a complex plane, whereas
function G(ξ) is a complicated three-dimensional complex function.
Perhaps the interested reader will consider this in detail and determine a theo-
retical proof.
8.6
Ionosphere-Free Ambiguity Fixing
Ionosphere-free ambiguity ﬁxing is called ﬂoat ambiguity ﬁxing, and will be dis-
cussed in this section. The theory proposed here was reported by Lemmens in 2004
as “NEW” in a published book review on GPS (Xu 2003).
8.6.1
Introduction
It is well known that in GPS data processing, the longer the baselines or the larger
the measured area, the greater the number of problems caused by ambiguity res-
olution that will be encountered (Wang et al. 1988; Hofmann-Wellenhof et al.
1997). This phenomenon indicates that the ambiguity resolution is inﬂuenced by
certain effects, and those amounts increase with the increasing length of the
8.5  Ambiguity Function
251

baselines (Klobuchar 1996; Wanninger 1995a, b). Clock errors and multipath
effects can be excluded from the candidate list because they have nothing to do with
the length of the baseline. Ionospheric and tropospheric effects are different from
station to station. In general, the longer the baseline, the larger the differences will
be. Because the effects of ionospheric delay are usually ten times those of the
troposphere, the main difﬁculty in ambiguity resolution is caused by the ionospheric
effects.
For larger-area GPS applications, ionosphere-free combination Lc must be used
(Hofmann-Wellenhof et al. 1997). As a consequence of the Lc combination,
ambiguities obtained are no longer a set of integers. However, numerically
speaking, only ﬂoat numbers of the combination N1 −N2(f2/f1) are possible solu-
tions, where N1 and N2 are integers. Practically, research has shown that Nc
ambiguity ﬁxing is necessary for precise applications (Xu et al. 1997b). The most
common method involves the use of the wide lane and other linear combinations to
compute and ﬁx the ambiguity N1 and N2, and then to form the Nc; however, in this
case, the residual ionospheric effects are not modelled. The solved ambiguity will
include a constant part of the ionospheric effects, and this may make ambiguity
ﬁxing more complicated (Hofmann-Wellenhof et al. 1997). For ﬁxing integer
ambiguities, many methods have been developed (Han and Rizos 1995, 1997;
Merbart 1995; Teunissen 1995; Euler and Landau 1992; cf. Sect. 8.3).
To gain a better understanding of the inﬂuence of the ionospheric effects on
ambiguity resolution and ways to ﬁx ionosphere-free ambiguity, an intensive study
was carried out during the extensive AGMASCO GPS data processing (Xu et al.
1997b). Ionospheric effects that are not well modelled or well eliminated will be
distributed to all parameters that are obtained through adjustment or ﬁltering.
However, because of the constant properties of the ambiguity parameters, only the
constant parts of the residuals of ionospheric effects will affect the ambiguity
results. Numerical results have shown that these constant parts of ionospheric
effects on ambiguity parameters can be eliminated in any case through an
ionosphere-free ambiguity combination. In other words, the ionosphere-free
ambiguities can be obtained by combining the non-ionosphere-free ambiguity
parameters. The inﬂuence of the higher-order ionospheric effects, which has not
been eliminated by the ionosphere-free combination, can be separated into two
parts. The constant part will go into the ambiguities; the time variance part will
affect the coordinate or other parameters. Therefore, for precise ambiguity resolu-
tion, a constant ionospheric correction or model is necessary. After such correction
or model parameterisation, the ambiguity resolution is independent from the length
of the baselines.
In the following section, a concept of ionospheric ambiguity correction, deter-
mination of the ionospheric ambiguity correction using ambiguity-ionospheric
equations, methods of integer and ﬂoat ambiguity ﬁxing, and a condition for an
integer ambiguity under the second-order ionosphere-free combination are
discussed.
252
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

8.6.2
Concept of Ionospheric Ambiguity Correction
In double-difference GPS data processing, ionosphere-free ambiguities can be
computed from ambiguities obtained by using any non-ionosphere-free combina-
tions without modelling the ionospheric effects. For example, without modelling the
ionospheric effects and by using Φ1 and Φ2 solutions, one gets ambiguity vectors
N1 and N2, respectively. One can form the ionosphere-free ambiguity Nc by using
N1 and N2, and solve for the ionosphere-free ambiguity Ncs separately. The
numerical results shown that the relation Nc = Ncs is always valid. This indicates
that the inﬂuence of ionospheric effects on the ambiguity parameters can only be a
set of constant values, and for these values the ionosphere-free formula is always
valid, i.e. when these values are set into the ionosphere-free combination, a zero
value results in any case. The time variation part of the ionospheric effects does not
affect the ambiguity solution.
The mathematical model of the carrier phase observations can be written as
Uji
k ¼ qji=kk + Nji
k þ adqkðion)/kk + dqðothers)/kk
ð8:62Þ
or
kkUji
k ¼ qji þ kkNji
k þ adqkðion) + dq (others),
ð8:63Þ
where Φ is the measured carrier phase in the cycle, λ is the wavelength, ρ is the
distance between the satellite j and station i, N is the ambiguity parameter, dρk(ion)
is the ionospheric effects, dρ(others) is the summation of other effects, k is the
observational frequency index, frequency f1 = 154f0, and f2 = 120f0, where f0 is the
fundamental frequency (10.23 MHz), the future frequency (announced by U.S.
Vice President Gore, March 1998, see ION homepage http://www.ion.org/) f3 =
115f0. α is a switch; α = 1,0 indicates whether or not the residuals of ionospheric
effects are modelled. The ambiguity parameter N is a set of integers, physically.
However, if there are any constant effects not modelled or not well modelled, these
effects will be absorbed by the ambiguities. Therefore, integer ambiguity ﬁxing then
makes sense only if all constant errors are well modelled or separated. One choices
for avoiding the separation problem of the constant ionospheric effects and the
ambiguities is through parameterisation of the ionospheric residuals.
Recalling the discussions in Sect. 5.1.2, the ﬁrst-order ionosphere-free obser-
vation can be formed by
f 2
1 k1Uji
1  f 2
2 k2Uji
2
f 2
1  f 2
2
ð8:64Þ
8.6  Ionosphere-Free Ambiguity Fixing
253

or
kc Uji
1  Uji
2
f2
f1


;
ð8:65Þ
where
kc ¼
f 2
1 k1
f 2
1  f 2
2
:
ð8:66Þ
The above combination has units of length. λc is the wavelength of the combined
phase. The second-order ionospheric model can be presented as (units: length)
d qkðion) ¼ F A1
f 2
k
þ A2
f 3
k


;
ð8:67Þ
where A1 and A2 are unknowns and have the physical meaning of the total electron
content in the zenith direction and F is the mapping function discussed in Sect. 5.1.4
to map the zenith delay to the path direction. Forming the ﬁrst-order ionosphere-free
combination (Eq. 8.64), one gets the second-order ionospheric residuals
f 2
1 d q1ðiono)  f 2
2 dq2ðiono)
f 2
1  f 2
2
¼ F
1
f1
 1
f2


A2
f 2
1  f 2
2
¼  kcFðf1  f2Þ
A2
f2f 3
1 k1
¼  kcF 17
60
A2
f 3
1 k1
;
ð8:68Þ
The amount of the second-order ionospheric effects is only about 1/1000 of the
ﬁrst-order effects (Syndergaard 1999). Thus the second-order effects can reach a
level of a few centimetres, and therefore must be taken into account or modelled.
The observation equation of the ﬁrst-order ionosphere-free combination can be
written as
kc Uji
1  Uji
2
f2
f1


¼ kc
qji
1
k1

f2
f1
k2
 
!
þ
Nji
1  60
77 Nji
2


þ Dc þ adqðothersÞ
1
k1

f2
f1
k2
 
!
8
>
>
>
>
>
<
>
>
>
>
>
:
9
>
>
>
>
>
=
>
>
>
>
>
;
ð8:69Þ
254
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

or
kcUji
c ¼ qji þ kcNji
c þ FakcDc + dq ðothers),
ð8:70Þ
where
Nji
c ¼ Nji
1  60
77 Nji
2;
Dc ¼  17
60
A2
f 3
1 k1
and
Uji
c ¼ Uji
1  Uji
2
f2
f1
:
ð8:71Þ
Nji
c is the (ﬁrst order) ionosphere-free ambiguity, λcDc is the ionospheric residuals in
the zenith, and Uji
c is the phase of the ionosphere-free combination (in cycles).
Because of the integer property of the ambiguities, the ionospheric effects can
only affect the ambiguities with a constant part; therefore, a so-called ionospheric
ambiguity correction can be given as
dN ¼
Z
T
Fkc  17
60

 A2
f 3
1 k1
dt
T ;
ð8:72Þ
where the integration time interval T is the same as that of the individual ambiguity
parameters. This term also explains why sometimes a very good ﬂoat solution has
ambiguity values that cannot easily be rounded up. Such a term also destroys the
integer property of the ambiguity parameter. Without this correction, ambiguity is
not separable from the constant part of ionospheric residuals. The ambiguity
parameters will absorb all similar constant effects. If these constant effects have not
been separated from the ambiguity parameters, ambiguity ﬁxing cannot be carried
out correctly. In such cases, a ﬂoat solution is preferred. This also explains why
ﬂoat solutions are typically used for precise applications such as deformation or
plate movement studies.
In the case of α = 0 (i.e. the remaining ionospheric error is not modelled; this is
the case for most GPS software), an ionospheric ambiguity correction must be
applied to the ambiguity solutions before ambiguity ﬁxing. After ambiguity ﬁxing,
such correction must again be added to the ambiguity parameters, because it pre-
sents the constant effects of the ionospheric residuals, and therefore must be taken
into account.
Taking such a correction into account or modelling the ionospheric residuals, the
problem of the dependence of the ambiguity resolution on the distances of the
baselines can been solved.
8.6  Ionosphere-Free Ambiguity Fixing
255

8.6.3
Determination of the Ionospheric Ambiguity Correction
To determine the ionospheric ambiguity correction, the ambiguity-ionospheric
equations are suggested for use. Recalling the discussion of Sect. 6.5.2, there only
the
ﬁrst-order
ionospheric
effects
are
modelled
in
the
so-called
ambiguity-ionospheric
equations.
Using
Eq. 8.68, the
ambiguity-ionospheric
equations (cf. Sect. 6.5.2) can be written as
R1  R2  Ddion þ Dec ¼ F
1
f 2
1
 1
f 2
2


A1 þ F
1
f 3
1
 1
f 3
2


A2 þ Dec;
ð8:73Þ
k1U1  k2U2 ¼ k1N1  k2N2  Ddion þ Dep
and
ð8:74Þ
kjUj  Rj  kjNj  2dionðjÞ þ Depc;
j ¼ 1;
ð8:75Þ
where
dionðjÞ ¼ dqjðionÞ ¼ F
A1
f 2
j
þ A2
f 3
j
 
!
¼ Fa2;
j ¼ 1; 2
and
Ddion ¼ dionð1Þ  dionð2Þ ¼ F
1
f 2
1
 1
f 2
2


A1 þ F
1
f 3
1
 1
f 3
2


A2 ¼ Fa1:
ð8:76Þ
The weight matrix can be found in Sect. 6.5.2. In a dual-frequency case, for
every observed satellite, there are two ambiguity unknowns and a total of two
ionospheric parameters (a1 and a2). Under usual conditions, if there are four
satellites observed (12 observables), then there are eight ambiguities and two
ionospheric parameters. Obviously the problem is solvable. The solution to the
ambiguity-ionospheric equations was already mentioned in Sect. 8.6.1 and will be
discussed again in Chap. 9 in detail.
Total electron content A1 and A2 can be determined by using the ionospheric
parameters a1 and a2 afterward. No matter what kind of value A1 has been obtained,
it will be eliminated through the ﬁrst-order ionosphere-free combination. However,
the A2 will be needed for computing the ionospheric ambiguity correction. After the
ionospheric ambiguity correction, the ionosphere-free ambiguity can be then ﬁxed
and will be outlined in next section. Physically, A2 should be very small compared
with A1, and the A1 of all stations and all time intervals should have negative values
(cf. Eqs. 5.16 and 5.18).
256
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

8.6.4
Integer Ambiguity Fixing Through
Ambiguity-Ionospheric Equations
It is advantageous to ﬁx the integer ambiguities through the ambiguity-ionospheric
equations. The whole equation system includes only the ambiguity and the iono-
spheric parameters. Even the code observables are also used; through a suitable
weight matrix derived in Sect. 6.5.2, the problem can be solved very accurately.
Because original (or zero-difference, un-combined) ambiguity parameters are used
here, the integer ambiguity search methods discussed in Sect. 8.3 can be directly
used for ﬁxing the integer ambiguities N1 and N2.
8.6.5
Float Ambiguity Fixing
Using the ﬁrst-order ionosphere-free combination, the ﬁrst-order ionosphere-free
ambiguity Ncs can be obtained. Through the ambiguity ﬁxing, the ionosphere-free
ambiguity can be computed by Nc(=N1–N260/77). The ionospheric ambiguity
correction dN (cf. Eq. 8.72) can be also computed. Then according to the above
discussions, the ﬂoat ambiguity Ncs should be ﬁxed to the value of Nc + dN.
The dN represents the constant part of ionospheric effects, which are not mod-
elled by an ionosphere-free combination and have been absorbed into the ambiguity
parameters.
8.7
PPP Ambiguity Fixing
In traditional precise point positioning (PPP), the zero-difference ambiguity of a
satellite-receiver pair is naturally not an integer value due to the existence of a
fractional part of the uncalibrated phase delays (FCBs) originating in the receiver
and satellite (Collins 2008; Ge et al. 2008; Mercier and Laurichesse 2008).
Research in PPP ambiguity resolution has been a focus throughout the world over
the past decade, since it can signiﬁcantly improve positioning quality, especially for
the east component (Blewitt 1989; Dong and Bock 1989; Geng et al. 2010). In this
section, we will brieﬂy describe these research efforts. The basic principle of PPP
ambiguity resolution is that the a priori information, which recovers the integer
property of PPP zero-difference ambiguity, is ﬁrst obtained through a regional
network solution, and thus the rover station can then apply the a priori information
as constraints to ﬁx the PPP ambiguity. The a priori constraints obtained from
regional network solutions could be FCBs products, wide-lane and narrow-lane
ambiguity, or double-differenced ambiguity.
8.6  Ionosphere-Free Ambiguity Fixing
257

1. Ambiguity constraint based on the single-difference-between-satellites method
The single-difference-between-satellites method for PPP integer ambiguity res-
olution was proposed by Ge et al. (2008). This method decomposes zero-difference
ambiguity into wide-lane and narrow-lane, and applies the difference between
satellites to remove the receiver-dependent FCBs. Based on a network of reference
stations, the wide-lane FCBs can be determined by averaging the fractional parts of
all pertinent wide-lane ambiguities derived from the Melbourne-Wübbena combi-
nation measurements (Melbourne 1985; Wübbena 1985). Similarly, narrow-lane
FCBs can be determined by averaging the fractional parts of all pertinent
narrow-lane
ambiguities
derived
from
the
wide-lane
ambiguities
and
ionosphere-free combination ambiguities. For a single rover station, these wide-lane
and narrow-lane FCBs are used as a priori constraints to recover the integer
property of the PPP ambiguities. The constraints can be represented as
Ni;j
3;m ¼
f1f2
f 2
1  f 2
2
ni;j
w;m þ
f1
f1 þ f2
ni;j
1;m þ D/i;j
1;m

	
;
ð8:77Þ
where the superscript (i, j) denotes the single-difference between satellites i and j, f1,
and f2 are the frequencies of carrier phase, Ni;j
3;m is the ionosphere-free combination
ambiguities at single rover station m, ni;j
w;m and ni;j
1;m are the wide-lane integer
ambiguities and narrow-lane integer ambiguities, D/i;j
1;m is the narrow-lane FCBs,
which can be determined from regional net work solution.
2. Ambiguity constraint based on integer phase clock estimates
Integer phase clock estimation was proposed by Laurichesse et al. (2009), who
applied the same decomposition as that of the single-difference-between-satellites
method, but directly ﬁxed the zero-difference ambiguities to integers. Therefore, an
arbitrary value should be assigned to the FCBs of a speciﬁc receiver to obtain the
satellite-dependent FCBs. Their wide-lane FCB determination is the same as that of
the single-difference-between-satellites method. Nevertheless, the narrow-lane
FCBs are not determined but assimilated into the clock estimates. Based on a
network of reference stations, the narrow-lane ambiguities can be ﬁxed to integers
before estimating the clocks. Thus, the clocks containing the narrow-lane FCBs are
called integer-recovery clocks and can be obtained. For the single rover station, the
integer-recovery clocks are used to guarantee the integer property of the
narrow-lane ambiguities. Therefore, PPP ambiguity resolution can be achieved
through the constraints of wide-lane FCBs and integer-recovery clocks.
3. Ambiguity constraint based on double-difference integer ambiguities method
The double-difference integer ambiguities method was proposed by Bertiger
et al. (2010). This method calculates the ﬂoat ambiguities, including the FCBs,
directly. For the network of the reference stations, the ﬂoat wide-lane ambiguities
can be derived from the Melbourne-Wübbena combination measurements, while
258
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

the ﬂoat ionosphere-free combination ambiguities can be obtained through a tra-
ditional PPP algorithm. The single rover station utilises the same method as that of
the reference station to calculate its ﬂoat wide-lane ambiguities and ﬂoat
ionosphere-free combination ambiguities. The double-difference integer wide-lane
ambiguities between reference station and rover station can then be formed and
ﬁxed, since the receiver-dependent FCBs and satellite-dependent FCBs both can be
eliminated via double difference. Therefore, the double-difference ionosphere-free
ambiguities between reference station and rover station can be formed and ﬁxed and
set as the double-difference constraints in PPP ambiguity resolution.
With the integer ambiguities resolved, the precision of PPP can be signiﬁcantly
improved over that with a ﬂoat solution. Moreover, the convergence time in PPP
can be reduced and the practicability of PPP consequently promoted.
References
Bertiger W, Desai S, Haines B, Harvey N, Moore A, Owen S, Weiss J (2010) Single receiver
phase ambiguity resolution with GPS data. J Geod 84(5):327-337.
Blewitt G (1989) Carrier phase ambiguity resolution for the global positioning system applied to
geodetic baselines up to 2000 km. J Geophys Res 94(B8):10187–10203.
Bronstein
IN,
Semendjajew
KA
(1987)
Taschenbuch
der
Mathematik.B.
G.
Teubner
Verlagsgesellschaft, Leipzig, ISBN 3-322-00259-4.
Cannon ME, Lachapelle G, Goddard TW (1997) Development and results of a precision farming
sys-tem using GPS and GIS technologies. Geomatica 51,1:9–19.
Collins P (2008) Isolating and estimating undifferenced GPS integer ambiguities. In: Proceedings
of ION national technical meeting, San Diego, US, pp 720–732.
Cui X, Yu Z, Tao B, Liu D (1982) Adjustment in surveying. Surveying Press, Peking, (in
Chinese).
Dong D, Bock Y (1989) Global positioning system network analysis with phase ambiguity
resolution applied to crustal deformation studies in California. J Geophys Res 94(B4):3949–
3966.
Euler H-J, Landau H (1992) Fast GPS ambiguity resolution on-the-ﬂy for real-time applications.
In: Proceedings of 6th Int. Geod. Symp. on Satellite Positioning. Columbus, Ohio, pp 17–20.
Forsell B, Martín-Neira M, Harris R (1997) Carrier phase ambiguity resolution in GNSS-2.
Proceedings of ION GPS-97, The 10th International Technical Meeting of the Satellite Division
of the Institute of Navigation, Kansas City, Missouri, September 16-19, pp. 1727-1736.
Ge M, Gendt G, Rothacher M, Shi C, Liu J (2008) Resolution of GPS carrier-phase ambiguities in
precise point positioning (PPP) with daily observations. J Geod 82(7):389–399.
Gehlich U, Lelgemann D (1997) Zur Parametrisierung von GPS-Phasenmessungen. ZfV 6:262–
270.
Geng J, Meng X, Dodson A, Teferle F (2010) Integer ambiguity resolution in precise point
positioning: method comparison. J Geod 84:569-581.
Gotthardt E (1978) Einführung in die Ausgleichungsrechnung. Herbert Wichmann Verlag,
Karlsruhe.
Han S, Rizos C (1995) On-the-ﬂy ambiguity resolution for long range GPS kinematic positioning.
In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG
General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag,
Berlin, pp 290–294.
Han S, Rizos C (1997) Comparing GPS ambiguity resolution techniques. GPS World 8(10):54–61.
8.7  PPP Ambiguity Fixing
259

Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997, 2001) GPS theory and practice.
Springer-Press, Wien.
Jung, J (1999) High integrity carrier phase navigation for future LAAS using multiple civilian GPS
signals. Proceedings of ION GPS-99, The 12th International Technical Meeting of the Satellite
Division of the Institute of Navigation, Nashville, USA, September 14-17, pp. 727-736.
Klobuchar JA (1996) Ionospheric effects on GPS. In: Parkinson BW, Spilker JJ (eds) Global
Position-ing System: Theory and applications, Vol. I, Chapter 12.
Laurichesse D, Mercier F, Berthias J, Broca P, Cerri L (2009) Integer ambiguity resolution on
undifferenced GPS phase measurements and its application to PPP and satellite precise orbit
determination. Navig J Inst Navig 56(2):135–149.
Leick A (1995) GPS satellite surveying. John Wiley & Sons Ltd., New York.
Melbourne W (1985) The case for ranging in GPS-based geodetic systems. In: Proceedings of ﬁrst
international symposium on precise positioning with the global positioning system, Rockville,
US, pp 373–386.
Merbart L (1995) Ambiguity resolution techniques in geodetic and geodynamic applications of the
Global Positioning System. Dissertation an der Philosophisch-naturwissenschaftlichen Fakultät
der Universität Bern.
Mercier
F,
Laurichesse
D
(2008)
Zero-difference
ambiguity
blocking
properties
of
satellite/receiver widelane biases. In: Proceedings of European navigation conference,
Toulouse, France.
Morujao D, Mendes V (2008) Investigation of Instantaneous Carrier Phase Ambiguity Resolution
with the GPS/GALILEO Combination using the General Ambiguity Search Criterion. J. GPS,
7(1): 35-45.
Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative
geodesy: Modelling, processing, and results. University of Texas at Austin, Center for Space
Research.
Sjoeberg LE (1999) Unbiased vs biased estimation of GPS phase ambiguities from dual-frequency
code and phase observables. J Geodesy 73:118–124.
Syndergaard S (1999) Retrieval analysis and methodologies in atmospheric limb sounding using
the GNSS radio occultation technique. Dissertation, Niels Bohr Institute for Astronomy,
Physics and Geophysics, Faculty of Science, University of Copenhagen.
Teunissen P (1993) Least squares estimation of the integer GPS ambiguities. Invited lecture,
Section IV: Theory and methodology, IAG General Meeting, Beijing, China, August 1993.
Also in LGR-Series n.6, Delft Geodetic Computing Centre, Delft University of Technology,
Delft.
Teunissen P (1994) The invertible GPS ambiguity transformations. Manuscripta Geodaetica, 20
(6): 489-497.
Teunissen P (1995) The least-squares ambiguity decorrelation adjustment: A method for fast GPS
integer ambiguity estimation. J Geodesy 70(1–2):65–82.
Vollath U, Birnbach S, Landau H (1998) An analysis of three-carrier ambiguity resolution (TCAR)
technique for precise relative positioning in GNSS-2. Proceedings of ION GPS-98, The 11th
International Technical Meeting of the Satellite Division of the Institute of Navigation,
Nashville, Tennessee, USA, September 15-18, pp. 417-426.
Wang LX, Fang ZD, Zhang MY, Lin GB, Gu LK, Zhong TD, Yang XA, She DP, Luo ZH,
Xiao BQ, Chai H, Lin DX (1979) Mathematic handbook. Educational Press, Peking, ISBN
13012-0165.
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese).
Wanninger L (1995) Enhancing differential GPS using regional ionospheric models. B Geod
69:283–291.
Wanninger L (1995) Einﬂuß ionosphärischer Störungen auf präzise GPS-Messungen in
Mitteleuropa. Schriftenreihe
des Deutschen Vereins
für Vermessungswesen,
Bd. 18,
Stuttgart, pp 218–232.
260
Chapter 8  Cycle Slip Detection and Ambiguity Resolution

Wuebbena G (1985) Software developments for geodetic positioning with GPS using TI-4100
code and carrier measurements. In: Proceedings of ﬁrst international symposium on precise
positioning with the global positioning system, Rockville, US, pp 403–412.
Xu
G
(1992)
Spectral
analysis
and
geopotential
determination
(Spektralanalyse
und
Erdschwerefeldbestimmung). Dissertation, DGK, Reihe C, Heft Nr. 397, Press of the
Bavarian Academy of Sciences, ISBN 3–7696–9442–2, 100 p, (with very detailed summary in
German).
Xu G (2002a) A general criterion of integer ambiguity search, J. GPS, Vol. 1 No.2: 122-131.
Xu G (2003) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English.
Xu G, Bastos L, Timmen L (1997) GPS kinematic positioning in AGMASCO campaigns –
Strategic goals and numerical results. In: Proceedings of ION GPS-97 meeting in Kansas City,
September 16–19, 1997, pp 1173–1184.
Xu G, Fritsch J, Hehl K (1997) Results and conclusions of the carborne gravimetry campaign in
northern Germany. Geodetic Week Berlin ’97, Oct. 6–11, 1997, electronic version published in
http://www.geodesy.tu-berlin.de.
Xu G, Schwintzer P, Reigber Ch (1998) KSGSoft – Kinematic/Static GPS Software – Software
user
manual
(version
of
1998).
Scientiﬁc
Technical
Report
STR98/19
of
GeoForschungsZentrum (GFZ) Potsdam.
Xu G, Shen Y, Yang Y, Sun H, Zhang Q, Guo J, Yeh T (2010) Equivalence of GPS Algorithms
and Its Inference. Sciences of Geodesy-I: Advances and Future Directions, Springer,
Heidelberg, Berlin.
Zhang FZ, Xu Y, Jiang CH (2016) An alternative derivation of the equivalent criterion, Surveying
Journal of China, in review.
Zhang W, Cannon M, Julien O, Alves P (2003) Investigation of combined GPS/GALILEO
cascading ambiguity resolution schemes. Proceedings of ION GPS/GNSS 2003, The 16th
International Technical Meeting of the Satellite Division of the Institute of Navigation,
Portland, OR, USA, September 9-12, pp. 2599-2610.
References
261

Chapter 9
Parameterisation and Algorithms of GPS
Data Processing
The parameterisation problems of the bias parameters in the GPS observation model
are outlined in Sect. 12.1 of the ﬁrst edition of this book. The problems are then
mostly solved, and the theory will be addressed here in detail (cf. Xu 2004; Xu et al.
2006b). The equivalence properties of the algorithms of GPS data processing are
described, and the standard algorithms are outlined.
9.1
Parameterisation of the GPS Observation Model
The commonly used GPS data processing methods are the so-called uncombined
and
combining,
and
the
undifferenced
and
differencing
algorithms
(e.g.,
Hofmann-Wellenhof et al. 2001; Leick 2004; Remondi 1984; Seeber 1993; Strang
and Borre 1997; Blewitt 1998). The observation equations of the combining and
differencing methods can be obtained by carrying out linear transformations of the
original (uncombined and undifferenced) equations. As soon as the weight matrix is
similarly transformed according to the law of variance–covariance propagation, all
methods are theoretically equivalent. The equivalences of combining and differencing
algorithms are discussed in Sects. 6.7 and 6.8, respectively. The equivalence of the
combining methods is exact, whereas the equivalence of the differencing algorithms is
slightly different (Xu 2004, cf. Sect. 9.2). The parameters are implicitly expressed in
the discussions; therefore, the parameterisation problems of the equivalent methods
have not been discussed in detail. At that time, this topic was considered one of the
remaining GPS theoretical problems (Xu 2003, pp. 279–280; Wells et al. 1987, p. 34),
and it will be discussed in the next subsection.
Three pieces of evidence of the parameterisation problem of the undifferenced
GPS observation model are given ﬁrst. Then the theoretical analysis and numerical
derivation are made to show how to parameterise the bias effects of the
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_9
263

undifferenced GPS observation model independently. A geometry-free illustration
and a correlation analysis in the case of a phase–code combination are discussed. At
the end, conclusions and comments are given.
9.1.1
Evidence of the Parameterisation Problem
of the Undifferenced Observation Model
Evidence from Undifferenced and Differencing Algorithms
Suppose the undifferenced GPS observation equation and the related LS normal
equation are
V ¼ L  A1
A2
ð
Þ
X1
X2


;
P
ð9:1Þ
M11
M12
M21
M22


X1
X2


¼
W1
W2


;
ð9:2Þ
where all symbols have the same meanings as that of Eqs. 7.117 and 7.118.
Equation 9.2 can be diagonalised as (cf. Sect. 7.6.1)
M1
0
0
M2


X1
X2


¼
B1
B2


:
ð9:3Þ
The related equivalent observation equation of the diagonal normal Eq. 9.3 can
be written (cf. Sect. 7.6.1)
U1
U2


¼
L
L



D1
0
0
D2


X1
X2


;
P
0
0
P


;
ð9:4Þ
where all symbols have the same meanings as that of Eqs. 7.142 and 7.140. If X1 is
the vector containing all clock errors, then the second equation of Eq. 9.3 is the
equivalent double-differencing GPS normal equation. It is well known that in a
double-differencing algorithm, the ambiguity sub-vector contained in X2 must be the
double-differencing ambiguities; otherwise, the problem will be generally singular.
It is notable that X2 is identical with that of in the original undifferenced observation
Eq. 9.1. Therefore, the ambiguity sub-vector contained in X2 (in Eq. 9.1) must be a
set of double-differencing ambiguities (or an equivalent set of ambiguities). This is
the ﬁrst piece of evidence (or indication) of the singularity of the undifferenced GPS
observation model in which the undifferenced ambiguities are used.
Evidence from Uncombined and Combining Algorithms
Suppose the original GPS observation equation of one viewed satellite is (cf. Eq. 6.
134)
264
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
1
0
f 2
s =f 2
1
1
0
1
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A;
P;
ð9:5Þ
then the uncombined or combining algorithms have the same solution of (cf. Eq. 6.
138)
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A;
ð9:6Þ
where all symbols have the same meanings as that of Eqs. 6.134 and 6.138. Then
one notices that the ionosphere (B1) and geometry (Cρ) are functions of the codes
(R1 and R2) and are independent from phases (Φ1 and Φ2) in Eq. 9.6. In other
words, the phase observables contribute nothing to the ionosphere and geometry,
and this is not possible. Such an illogical conclusion is caused by the parameteri-
sation of the ambiguities given in the observation model of Eq. 9.5. If one takes the
ﬁrst evidence discussed above into account, and deﬁnes that for each station one of
the satellites in view must be selected as reference, and the related ambiguity must
be merged into the clock parameter, then the phases do contribute to ionosphere and
geometry. One can see again that parameterisation is a very important topic and
must be discussed more speciﬁcally. An improper parameterisation of the obser-
vation model will lead to incorrect conclusions through the derivation from the
model.
Evidence from Practice
Without using a priori information, a straightforward programming of the GPS data
processing using an undifferenced algorithm leads to no results (i.e. the normal
equation is singular, cf. Xu 2004). Therefore, an exact parameterisation description
is necessary and will be discussed in the next section.
9.1.2
A Method of Uncorrelated Bias Parameterisation
Here we restrict our discussion to the parameterisation problem of the bias
parameters (or constant effects, i.e. the clock errors and ambiguities).
Recall the discussions of the equivalence of undifferenced and differencing
algorithms in Sect. 6.8. The equivalence property is valid under three conditions:
observation vector L used in Eq. 9.1 is identical; parameterisation of X2 is identical;
and X1 is able to be eliminated (cf. Sect. 6.8).
9.1
Parameterisation of the GPS Observation Model
265

The ﬁrst condition is necessary for the exactness of the equivalence because,
through forming differences, the unpaired data will be cancelled out in the
differencing.
The second condition states that the parameterisation of the undifferenced and
differencing model should be the same. This may be interpreted as the following:
the rank of the undifferenced and differencing equations should be the same if the
differencing is formed by a full rank linear transformation. If only the differencing
equations are taken into account, then the rank of the undifferenced model should
equal the rank of the differencing model plus the number of eliminated independent
parameters.
It is well known that one of the clock error parameters is linearly correlated with
the others. This may be seen in the proof of the equivalence property of the double
differences, where the two receiver clock errors of the baseline may not be separated
from each other and have to be transformed to one parameter and then eliminated
(Xu 2002, Sect. 6.8). This indicates that if in the undifferenced model all clock
errors are modelled, the problem will be singular (i.e. rank defect). Indeed, Wells
et al. (1987) noticed that the equivalence is valid if measures are taken to avoid rank
defect in the bias parameterisation. Which clock error has to be kept ﬁxed is
arbitrary. Because of the different qualities of the satellite and receiver clocks, a
good choice is to ﬁx a satellite clock error (the clock is called a reference clock). In
practice, the clock error is an unknown; therefore, there is no way to keep that ﬁxed
except to ﬁx it to zero. In this case, the meaning of the other bias parameters will be
changed and may represent the relative errors between the other biases.
The third condition is important to ensure a full-ranked parameterisation of the
parameter vector X1 which is going to be eliminated.
The undifferenced Eq. 9.1 is solvable if the parameters X1 and X2 are not
over-parameterised. In the case of single differences, X1 includes satellite clock
errors and is able to be eliminated. Therefore, to guarantee that the undifferenced
model Eq. 9.1 is not singular, X2 in Eq. 9.1 must be not over-parameterised. In the
case of double differences, X1 includes all clock errors except the reference one.
Here we notice that the second observation equation of 9.1 is equivalent to the
double-differencing observation equation and the second equation of 9.2 is the
related normal equation. In a traditional double-differencing observation equation,
the ambiguity parameters are represented by double-differencing ambiguities.
Recall that for the equivalence property, the number (or rank) of ambiguity
parameters in X2 that are not linearly correlated must be equal to the number of the
double-differencing ambiguities. In the case of triple differences, X1 includes all
clock errors and ambiguities. The fact that X1 should able to be eliminated leads
again to the conclusion that the ambiguities should be linearly independent.
The two equivalent linear equations should have the same rank. Therefore, if all
clock errors except the reference one are modelled, the number of independent undif-
ferenced ambiguity parameters should be equal to the number of double-differencing
266
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

ambiguities. According to the deﬁnition of the double-differencing ambiguity, one has
for one baseline
Nk1;k2
i1;i2 ¼ Nk2
i2  Nk2
i1  Nk1
i2 þ Nk1
i1
Nk1;k3
i1;i2 ¼ Nk3
i2  Nk3
i1  Nk1
i2 þ Nk1
i1
Nk1;k4
i1;i2 ¼ Nk4
i2  Nk4
i1  Nk1
i2 þ Nk1
i1
. . .. . .
Nk1;kn
i1;i2 ¼ Nkn
i2  Nkn
i1  Nk1
i2 þ Nk1
i1 ;
ð9:7Þ
where i1 and i2 are station indices, kj is the jth satellite’s identiﬁcation, n is the
common observed satellite number and is a function of the baseline, and N is
ambiguity. Then there are n −1 double-differencing ambiguities and 2n undiffer-
enced ambiguities. Taking the connection of the baselines into account, there are
n −1 double-differencing ambiguities and n new undifferenced ambiguities for any
further baseline. If i1 is deﬁned as the reference station of the whole network and k1
as the reference satellite of station i2, then undifferenced ambiguities of the refer-
ence station cannot be separated from the others (i.e. they are linearly correlated
with the others). The undifferenced ambiguity of the reference satellite of station i2
cannot be separated from the others (i.e. it is linearly correlated with the others).
That is, the ambiguities of the reference station cannot be determined, and the
ambiguities of the reference satellites of non-reference stations cannot be deter-
mined. Either they should not be modelled or they should be kept ﬁxed.
A straightforward parameterisation of all undifferenced ambiguities will lead to
rank defect, and the problem will be singular and not able to be solved.
Therefore, using the equivalence properties of the equivalent equation of GPS
data processing, we come to the conclusion that the ambiguities of the reference
station and ambiguities of the reference satellite of every station are linearly cor-
related with the other ambiguities and clock error parameters. However, a general
method of parameterisation should be independent of the selection of the references
(station and satellite). Therefore, we use a two-baseline network to further our
analysis. The original observation equation can be written as follows:
Lk1
i1 ¼    di1 þ dk1 þ Nk1
i1 þ   
Lk2
i1 ¼    di1 þ dk2 þ Nk2
i1 þ   
Lk3
i1 ¼    di1 þ dk3 þ Nk3
i1 þ   
Lk4
i1 ¼    di1 þ dk4 þ Nk4
i1 þ   
Lk5
i1 ¼    di1 þ dk5 þ Nk5
i1 þ   
Lk6
i1 ¼    di1 þ dk6 þ Nk6
i1 þ   
ð9:8Þ
9.1
Parameterisation of the GPS Observation Model
267

Lk1
i2 ¼    di2 þ dk1 þ Nk1
i2 þ   
Lk2
i2 ¼    di2 þ dk2 þ Nk2
i2 þ   
Lk3
i2 ¼    di2 þ dk3 þ Nk3
i2 þ   
Lk4
i2 ¼    di2 þ dk4 þ Nk4
i2 þ   
Lk5
i2 ¼    di2 þ dk5 þ Nk5
i2 þ   
Lk7
i2 ¼    di2 þ dk7 þ Nk7
i2 þ   
ð9:9Þ
Lk2
i3 ¼    di3 þ dk2 þ Nk2
i3 þ   
Lk3
i3 ¼    di3 þ dk3 þ Nk3
i3 þ   
Lk4
i3 ¼    di3 þ dk4 þ Nk4
i3 þ   
Lk5
i3 ¼    di3 þ dk5 þ Nk5
i3 þ   
Lk6
i3 ¼    di3 þ dk6 þ Nk6
i3 þ   
Lk7
i3 ¼    di3 þ dk7 þ Nk7
i3 þ    ;
ð9:10Þ
where only the bias terms are listed and L and δ represent observable and clock
error, respectively. Observation equations of station i1, i2, and i3 are Eqs. 9.8, 9.9,
and 9.10. Deﬁne that the baseline 1, 2 are formed by station i1 and i2, as well as i2
and i3, respectively. Select i1 as the reference station and then keep the related
ambiguities ﬁxed (set to zero for simpliﬁcation). For convenience of later discus-
sion, select δi1 as the reference clock (set to zero, too) and select k1, k2 as reference
satellites of the station i2, i3 (set the related ambiguities to zero), respectively. Then
Eqs. 9.8–9.10 become
Lk1
i1 ¼    dk1 þ   
Lk2
i1 ¼    dk2 þ   
Lk3
i1 ¼    dk3 þ   
Lk4
i1 ¼    dk4 þ   
Lk5
i1 ¼    dk5 þ   
Lk6
i1 ¼    dk6 þ   
ð9:11Þ
Lk1
i2 ¼    di2 þ dk1 þ   
Lk2
i2 ¼    di2 þ dk2 þ Nk2
i2 þ   
Lk3
i2 ¼    di2 þ dk3 þ Nk3
i2 þ   
Lk4
i2 ¼    di2 þ dk4 þ Nk4
i2 þ   
Lk5
i2 ¼    di2 þ dk5 þ Nk5
i2 þ   
Lk7
i2 ¼    di2 þ dk7 þ Nk7
i2 þ   
ð9:12Þ
268
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

Lk2
i3 ¼    di3 þ dk2 þ   
Lk3
i3 ¼    di3 þ dk3 þ Nk3
i3 þ   
Lk4
i3 ¼    di3 þ dk4 þ Nk4
i3 þ   
Lk5
i3 ¼    di3 þ dk5 þ Nk5
i3 þ   
Lk6
i3 ¼    di3 þ dk6 þ Nk6
i3 þ   
Lk7
i3 ¼    di3 þ dk7 þ Nk7
i3 þ   
ð9:13Þ
Differences can be formed through linear operations. The total operation is a full
rank linear transformation, which does not change the least squares solution of the
original equations. Single differences can be formed by the following (Eq. 9.11
remains unchanged and, therefore, will not be listed again):
Lk1
i2  Lk1
i1 ¼    di2 þ   
Lk2
i2  Lk2
i1 ¼    di2 þ Nk2
i2 þ   
Lk3
i2  Lk3
i1 ¼    di2 þ Nk3
i2 þ   
Lk4
i2  Lk4
i1 ¼    di2 þ Nk4
i2 þ   
Lk5
i2  Lk5
i1 ¼    di2 þ Nk5
i2 þ   
Lk7
i2 ¼ . . .di2 þ dk7 þ Nk7
i2 þ   
ð9:14Þ
Lk2
i3  Lk2
i2 ¼    di3  di2  Nk2
i2 þ   
Lk3
i3  Lk3
i2 ¼    di3  di2 þ Nk3
i3  Nk3
i2 þ   
Lk4
i3  Lk4
i2 ¼    di3  di2 þ Nk4
i3  Nk4
i2 þ   
Lk5
i3  Lk5
i2 ¼    di3  di2 þ Nk5
i3  Nk5
i2 þ   
Lk6
i3 ¼    di3 þ dk6 þ Nk6
i3 þ   
Lk7
i3  Lk7
i2 ¼    di3  di2 þ Nk7
i3  Nk7
i2 þ   
ð9:15Þ
where two observations are unpaired due to the baseline deﬁnitions. Double dif-
ferences can be formed by
Lk1
i2  Lk1
i1 ¼    di2 þ   
Lk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 ¼    Nk2
i2 þ   
Lk3
i2  Lk3
i1  Lk1
i2 þ Lk1
i1 ¼    Nk3
i2 þ   
Lk3
i2  Lk3
i1  Lk1
i2 þ Lk1
i1 ¼    Nk3
i2 þ   
Lk4
i2  Lk4
i1  Lk1
i2 þ Lk1
i1 ¼    Nk4
i2 þ   
Lk5
i2  Lk5
i1  Lk1
i2 þ Lk1
i1 ¼    Nk5
i2 þ   
Lk7
i2  Lk1
i2 þ Lk1
i1 ¼    dk7 þ Nk7
i2 þ   
ð9:16Þ
9.1
Parameterisation of the GPS Observation Model
269

Lk2
i3  Lk2
i2 ¼    di3  di2  Nk2
i2 þ   
Lk3
i3  Lk3
i2  Lk2
i3 þ Lk2
i2 ¼    Nk3
i3  Nk3
i2 þ Nk2
i2 þ   
Lk4
i3  Lk4
i2  Lk2
i3 þ Lk2
i2 ¼    Nk4
i3  Nk4
i2 þ Nk2
i2 þ   
Lk5
i3  Lk5
i2  Lk2
i3 þ Lk2
i2 ¼    Nk5
i3  Nk5
i2 þ Nk2
i2 þ   
Lk6
i3 ¼    di3 þ dk6 þ Nk6
i3 þ   
Lk7
i3  Lk7
i2  Lk2
i3 þ Lk2
i2 ¼    Nk7
i3  Nk7
i2 þ Nk2
i2 þ   
ð9:17Þ
Using Eqs. 9.16 and 9.11, Eq. 9.17 can be further modiﬁed to
Lk2
i3  Lk2
i2 þ ðLk1
i2  Lk1
i1 Þ þ ðLk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 Þ ¼    di3 þ   
Lk3
i3  Lk3
i2  Lk2
i3 þ Lk2
i2 þ ðLk3
i2  Lk3
i1  Lk1
i2 þ Lk1
i1 Þ  ðLk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 Þ ¼    Nk3
i3 þ   
Lk4
i3  Lk4
i2  Lk2
i3 þ Lk2
i2 þ ðLk4
i2  Lk4
i1  Lk1
i2 þ Lk1
i1 Þ  ðLk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 Þ ¼    Nk4
i3 þ   
Lk5
i3  Lk5
i2  Lk2
i3 þ Lk2
i2 þ ðLk5
i2  Lk5
i1  Lk1
i2 þ Lk1
i1 Þ  ðLk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 Þ ¼    Nk5
i3 þ   
Lk6
i3  Lk6
i1 ¼    di3 þ Nk6
i3 þ   
Lk7
i3  Lk7
i2  Lk2
i3 þ Lk2
i2 þ ðLk7
i2  Lk1
i2 þ Lk1
i1 Þ  ðLk2
i2  Lk2
i1  Lk1
i2 þ Lk1
i1 Þ ¼     dk7 þ Nk7
i3 þ   
ð9:18Þ
or
Lk2
i3  Lk2
i1 ¼    di3 þ   
Lk3
i3  Lk3
i1  Lk2
i3 þ Lk2
i1 ¼    Nk3
i3 þ   
Lk4
i3  Lk4
i1  Lk2
i3 þ Lk2
i1 ¼    Nk4
i3 þ   
Lk5
i3  Lk5
i1  Lk2
i3 þ Lk2
i1 ¼    Nk5
i3 þ   
Lk6
i3  Lk6
i1  Lk2
i3 þ Lk2
i1 ¼    Nk6
i3 þ   
Lk7
i3  Lk2
i3 þ Lk2
i1 ¼     dk7 þ Nk7
i3 þ   
ð9:19Þ
From the last equation of Eqs. 9.16 and 9.19, it is obvious that the clock error
and the ambiguities of satellite k7, which is not observed by the reference station,
are linearly correlated. Keeping one of the ambiguities of the satellite k7 at station
i2 or i3 is necessary and equivalent. Therefore, for any satellite that is not observed
by the reference station, one of the related ambiguities should be kept ﬁxed (station
selection is arbitrary). In other words, one of the ambiguities of all satellites has to
be kept ﬁxed. In this way, every transformed equation includes only one bias
parameter and the bias parameters are linearly independent (regular). Furthermore,
the differencing cannot be formed for the unpaired observations of every baseline.
However, in the case of an undifferenced adjustment, the situation would be dif-
ferent. We notice that the equation for k6 in Eq. 9.18 can be transformed to a
double-differencing one in Eq. 9.19. If more data is used in the undifferenced
270
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

algorithm than in the differencing method, the number of undifferenced ambiguity
parameters will be larger than that of double-differencing parameters. Therefore, we
must drive the so-called data condition to guarantee that the data are able to be
differenced, or equivalently, we must extend the method of double-difference for-
mation such that the differencing will not be limited by special baseline design.
Both will be discussed in Sect. 9.2.
The meanings of the parameters are changed by independent parameterisation,
and they can be read from Eqs. 9.11–9.13. The clock errors of the satellites
observed by the reference station include the errors of receiver clock and ambi-
guities. The receiver clock errors include the error of ambiguity of the reference
satellite of the same station. Due to the inseparable property of the bias parameters,
the clock error parameters no longer represent pure clock errors, and the ambigu-
ities represent no longer pure physical ambiguity. Theoretically speaking, the
synchronisation applications of GPS may not be realised using the carrier-phase
observations. Furthermore, Eq. 9.19 shows that the undifferenced ambiguities of i3
have the meaning of double-differencing ambiguities of the station i3 and i1 in this
case.
Up to now, we have discussed the correlation problem of the bias parameters and
found a method of how to parameterise the GPS observations regularly to avoid the
problem of rank defect. Of course, many other ways to parameterise the GPS
observation model can be similarly derived. However, the parameter sets should be
equivalent to each other and can be transformed from one set to another uniquely as
long as the same data is used.
9.1.3
Geometry-Free Illustration
The reason why the reference parameters have to be ﬁxed lies in the nature of range
measurements, which cannot provide information of the datum origin (cf., e.g.,
Wells et al. 1987, p. 9). Suppose d is the direct measurement of clock errors of
satellite k and receiver i, i.e. dk
i ¼ di þ dk, no matter how many observations were
made and how the indices were changed, one parameter (i.e. reference clock) is
inseparable from the others and has to be ﬁxed. Suppose h is the direct measure-
ment of ambiguity N and clock errors of satellite k and receiver i, i.e.
hk
i ¼ di þ dk þ Nk
i , the number of over-parameterised biases is exactly the number
of total observed satellites and used receivers. This ensures again that our param-
eterisation method to ﬁx the reference clock and one ambiguity of every satellite as
well as one ambiguity of the reference satellite of every non-reference station is
reasonable. The case of combination of d and h (as code and phase observations)
will be discussed in the next section.
9.1
Parameterisation of the GPS Observation Model
271

9.1.4
Correlation Analysis in the Case of Phase–Code
Combinations
A phase–code combined observation equation can be written by (cf. Sect. 7.5.2)
V1
V2
 
!
¼
L1
L2
 
!

A11
A12
A11
0


X1
X2


and
P ¼
wpP0
0
0
wcP0


; ð9:20Þ
where L1 and L2 are the observational vectors of phase (scaled in length) and code,
respectively; V1 and V2 are related residual vectors; X2 and X1 are unknown vectors
of ambiguity and others; A12 and A11 are related coefﬁcient matrices; P0 is a
symmetric and deﬁnite weight matrix; and wp and wc are weight factors of the phase
and code observations.
The phase, code and phase–code normal equations can be formed respectively
by
N11
N12
N21
N22


X1
X2


¼
R1
R2


;
N11X1 ¼ Rc;
and
M11
M12
M21
M22


X1
X2


¼
B1
B2


;
ð9:21Þ
where
M11 ¼ ðwp þ wcÞAT
11P0A11 ¼ ðwp þ wcÞN11;
M12 ¼ MT
21 ¼ wpAT
11P0A12 ¼ wpN12;
M22 ¼ wpAT
12P0A12 ¼ wpN22;
B1 ¼ AT
11P0ðwpL1 þ wcL2Þ ¼ wpR1 þ wcRc;
and
B2 ¼ wpAT
12P0L1 ¼ wpR2:
ð9:22Þ
The covariance matrix Q is denoted
Q ¼
M11
M12
M21
M22

1
¼
Q11
Q12
Q21
Q22


;
ð9:23Þ
272
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

where (Gotthardt 1978; Cui et al. 1982)
Q11 ¼ ðM11  M12M1
22 M21Þ1;
Q22 ¼ ðM22  M21M1
11 M12Þ1;
Q12 ¼ M1
11 ðM12Q22Þ
and
Q21 ¼ M1
22 ðM21Q11Þ:
ð9:24Þ
i.e.
Q11 ¼ ððwp þ wcÞN11  wpN12N1
22 N21Þ1;
Q22 ¼ ðwpN22  w2
pðwp þ wcÞ1N21N1
11 N12Þ1
and
Q21 ¼ N1
22 N21ððwp þ wcÞN11  wpN12N1
22 N21Þ1:
ð9:25Þ
Thus the correlation coefﬁcient Cij is a function of wp and wc, i.e.
Cij ¼ f ðwp; wcÞ;
ð9:26Þ
where indices i and j are the indices of unknown parameters in X1 and X2. For
wc = 0 (only phase is used, X1 and X2 are partly linear correlated) and wc = wp (X1
and X2 are uncorrelated), there exists indices ij, so that
Cij ¼ f ðwp; wc ¼ 0Þ ¼ 1
and
Cij ¼ f ðwp; wc ¼ wpÞ ¼ 0:
ð9:27Þ
In other words, there exists indices i and j, the related unknowns are correlated if
wc = 0 and uncorrelated if wc = wp. In the case of a phase–code combination,
wc = 0.01wp can be selected, and one has
Cij ¼ f ðwp; wc ¼ 0:01wpÞ
ð9:28Þ
whose value is very close to 1 (strongly correlated) in the discussed case.
Equations 9.26, 9.27, and 9.28 indicate that for the correlated unknown pair ij the
correlation situation may not change much by combining the code to the phase
because of the lower weight of the code related to the phase. A numerical test
conﬁrmed this conclusion (Xu 2004).
9.1.5
Conclusions and Comments
In this section, the singularity problem of the undifferenced GPS data processing is
pointed out and an independent parameterisation method is proposed for bias
parameters of the GPS observation model. The method is implemented into
9.1
Parameterisation of the GPS Observation Model
273

software, and the results conﬁrm the correctness of the theory and algorithm.
Conclusions can be summarised by the following:
1. Bias parameterisation of undifferenced GPS phase observations with all clock
errors except the reference one, and all undifferenced ambiguities are linearly
correlated. The linear equation system of undifferenced GPS is then singular and
cannot be solved theoretically.
2. A linear independent bias parameterisation can be reached by ﬁxing the refer-
ence clock of the reference station, ﬁxing one of the ambiguities of every
satellite of arbitrary station (called reference station of every satellite), and ﬁxing
the ambiguities of the reference satellite of every non-reference station. The
selections of the references are arbitrary; however, the selections are not allowed
to be duplicated.
3. The linear independent ambiguity parameter set is equivalent to the parameter
set of double-differencing ambiguities, and they can be transformed from one to
another uniquely if the same data is used.
4. The physical meanings of the bias parameters are varied depending on the way
of parameterisation. Because of the inseparable property of the bias parameters,
the synchronisation applications of GPS may not be realised using the
carrier-phase observations.
5. The phase–code combination does not change the correlation relation between
the correlated biases signiﬁcantly.
It is noteworthy to comment on the use of the undifferenced algorithm:
1. In the undifferenced algorithm, the observation equation is rank defect if the
over-parameterisation problem has not been taken into account. The numerical
inexactness introduced by eliminating the clock error parameters and the use of
a priori information of some other parameters are the reason why the singular
problem is solvable in practice thus far.
2. Using the undifferenced and differencing methods, solutions of the common
parameters must be the same if the undifferenced GPS data modelling is really
an equivalent one and not over-parameterised.
3. A singular undifferenced parameterisation may become regular by introducing
conditions or by ﬁxing some of the parameters through introducing a priori
information.
9.2
Equivalence of the GPS Data Processing Algorithms
The equivalence theorem, an optimal method for forming an independent baseline
network, and a data condition, as well as the equivalent algorithms using secondary
observables are discussed in this section (cf. Xu et al. 2006c).
274
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

9.2.1
Equivalence Theorem of GPS Data Processing Algorithms
In Sect. 6.7, the equivalence properties of uncombined and combining algorithms
of GPS data processing are given. Whether uncombined or combining algorithms
are used, the results obtained are identical and the precisions of the solutions are
identical, too. It is notable that the parameterisation is very important. The solutions
depend on the parameterisation. For convenience, the original GPS observation
equation and the solution are listed as (cf. Sect. 6.7)
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A ¼
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
1
0
f 2
s =f 2
1
1
0
1
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A;
P ¼
r2
c
0
0
0
0
r2
c
0
0
0
0
r2
p
0
0
0
0
r2
p
0
B
B
@
1
C
C
A
1
;
ð9:29Þ
and
k1N1
k2N2
B1
Cq
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1
R2
k1U1
k2U2
0
B
B
@
1
C
C
A
ð9:30Þ
where the meanings of the symbols are the same as that of Eqs. 6.134 and 6.138.
In Sect. 6.8, the equivalence properties of undifferenced and differencing algo-
rithms of GPS data processing are given. Whether undifferenced or differencing
algorithms are used, the results obtained are identical and the precisions of the
solutions are equivalent. It is notable that the equivalence here is slightly different
from the equivalence in combining algorithms. To distinguish them, we call the
equivalence in the differencing case a soft equivalence. The soft equivalence is
valid under three so-called conditions. The ﬁrst is a data condition, which guar-
antees that the data used in undifferenced or differencing algorithms are the same.
The data condition will be discussed in the next section. The second is a param-
eterisation condition, i.e. the parameterisation must be the same. The third is the
elimination condition, i.e. the parameter set to be eliminated should be able to be
eliminated. (Implicitly, the parameter set of the problem should be a regular one).
Because of the process of elimination, the cofactor matrices of the undifferenced
and differencing equations are different. If the cofactor of an undifferenced normal
equation has the form of
M11
M12
M21
M22

1
¼ Q ¼
Q11
Q12
Q21
Q22


;
ð9:31Þ
9.2
Equivalence of the GPS Data Processing Algorithms
275

then we call the diagonal part of the cofactor
Qe ¼
M1
0
0
M2

1
¼
Q11
0
0
Q22


ð9:32Þ
an equivalent cofactor. The equivalent cofactor has the same diagonal element
blocks as the original cofactor matrix Q and guarantees that the precision relation
between the unknowns remains the same. The soft equivalence is deﬁned as fol-
lows: the solutions are identical and the covariance matrices are equivalent. This
deﬁnition is implicitly used in the traditional block-wise least squares adjustment. It
is notable that the parameterisation is very important and the rank of the normal
equation of the undifferenced observation equation must be equal to the rank of the
normal equation of the differencing observation equation plus the number of the
eliminated independent parameters. For convenience, the original GPS observation
equation and the equivalent differencing equation can be generally written as (cf.
Eqs. 9.1 and 9.4)
V ¼ L  A1
A2
ð
Þ
X1
X2


;
P
ð9:33Þ
U1
U2


¼
L
L



D1
0
0
D2


X1
X2


;
P
0
0
P


:
ð9:34Þ
In Sect. 9.1 the way to parameterise the GPS observables independently is
proposed. A correct and reasonable parameterisation is the key to a correct con-
clusion by combining and differencing derivations. An example is given in Sect. 6.
7 where an illogical conclusion is derived due to the inexact parameterisation.
For any GPS survey with a deﬁnitive space-time conﬁguration, observed GPS
data can be parameterised (or modelled) in a suitable way and listed together in a
form of linear equations for processing. Combining and differencing are two linear
transformations. Because the uncombined and combining data (or equations) are
equivalent, differencing the uncombined or combining equations is (soft) equiva-
lent. Inversely, the combining operator is an invertible transformation; making or
not making the combination operation on the equivalent undifferenced or differ-
encing equations (Eqs. 9.33 and 9.34) is equivalent. That is, the mixtures of the
combining and differencing algorithms are also equivalent to the original undif-
ferenced and uncombined algorithms. The equivalence properties can be sum-
marised in a theorem as follows.
Equivalence Theorem of GPS Data Processing Algorithms
Under the three so-called equivalence conditions and the deﬁnition of the
so-called soft equivalence, for any GPS survey with deﬁnitive space-time conﬁg-
uration, GPS data processing algorithms—uncombined and combining algorithms,
undifferenced and differencing algorithms, as well as their mixtures—are at least
276
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

soft equivalent. That is, the results obtained by using any algorithm or any mixture
of the algorithms are identical. The diagonal elements of the covariance matrix are
identical. The ratios of the precisions of the solutions are identical. None of the
algorithms are preferred in view of the results and precisions. Suitable algorithms or
mixtures of the algorithms will be speciﬁcally advantageous for special kinds of
data dealings.
The implicit condition of this theorem is that the parameterisation must be the
same and regular. The parameterisation depends on different conﬁgurations of the
GPS surveys and strategies of the GPS data processing. The theorem says that if the
data used are the same and the model is parameterised identically and regularly,
then the results must be identical and the precision should be equivalent. This is a
guiding principle for the GPS data processing practice.
9.2.2
Optimal Baseline Network Forming and Data Condition
It is well known that for a network with n stations there are n −1 independent
baselines. An independent baseline network can be stated in words: all stations are
connected through these baselines, and the shortest way from one station to any
other stations is unique. Generally speaking, a shorter baseline leads to a better
common view of the satellites. Therefore, the baseline should be formed so that the
length of the baseline falls as short as possible. For a network, an optimal choice
should be that the summation of weighted lengths of all independent baselines
should be minimal. This is a speciﬁc mathematic problem called a minimum
spanning tree (cf., e.g., Wang et al. 1979).
Algorithms exist to solve this minimum spanning tree problem with software.
Therefore, we will just show an example here. An IGS network with ca. 100 sta-
tions and the related optimal and independent baseline tree is shown in Fig. 9.1.
The average length of the baselines is ca. 1300 km. The maximum distance is ca.
3700 km.
In the traditional double-differencing model, the unpaired GPS observations of
every designed baseline have to be omitted because of the requirement of differ-
encing (in the example of Sect. 1.2, two observations of k6 will be omitted.
However, if the differencing is not limited by baseline design, no observations have
to be cancelled out). Therefore, an optimal means of double differencing should be
based on an optimal baseline design to form the differencing ﬁrst, then, without
limitation of the baseline design, to check for the unpaired observations in order to
form possible differencing. This measure is useful for raising the rate of data used
by the differencing method. An example of an IGS network with 47 stations and a
1-day observations has shown (Xu 2004) that 87.9 % of all data is used in dif-
ference forming based on the optimal baseline design, whereas 99.1 % of all data is
used in the extended method of difference forming without limitation of the
9.2
Equivalence of the GPS Data Processing Algorithms
277

baseline design. That is, the original data may be nearly 100 % used for such a
means of double differencing.
In the undifferenced model, in order to be able to eliminate the clock error
parameters, it is sufﬁcient that every satellite is observed at least at two stations (for
eliminating the satellite clock errors) and at every station there is a satellite com-
bined with one of the other satellites that are commonly viewed by at least one of
the other stations (for eliminating the receiver clock errors). The condition ensures
that extended double differencing can be formed from the data. The data has to be
cancelled out if the condition is not fulﬁlled or the ambiguities including in the
related data have to be kept ﬁxed.
For convenience, we state the data condition as follows.
Data Condition: All satellites must be observed at least twice (for forming single
differences) and one satellite combined with one of the other satellites should be
commonly viewed by at least one of the other stations (for forming double
differences).
It is notable that the data condition above is valid for single and double differ-
encing. For triple differencing and user deﬁned differencing the data condition may
be similarly deﬁned. The data condition is one of the conditions of the equivalence
of the undifferenced and differencing algorithms. The data condition is derived from
the difference forming; however, it is suggested to use it also in undifferenced
methods to reduce the singular data. The optimal baseline network forming is
beneﬁcial for differencing methods to raise the rate of used data.
Fig. 9.1 Independent and optimal IGS GPS baseline network (100 stations)
278
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

9.2.3
Algorithms Using Secondary GPS Observables
As stated in Sects. 6.7 and 9.2, the uncombined and combining algorithms are
equivalent. A method of GPS data processing using secondary data is outlined in
Sect. 6.7.3. However, a concrete parameterisation of the observation model is only
possible after the method of independent parameterisation is discussed in Sect. 9.1.
The data processing using secondary observables leads to equivalent results of any
combining algorithms. Therefore, the concrete parameterisation of the GPS
observation model has to be speciﬁcally discussed again. The observation model of
m satellites viewed at one station is (cf. Eqs. 6.134 and 9.5)
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A ¼
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
1
0
f 2
s =f 2
1
1
0
1
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1ðkÞ
k2N2ðkÞ
B1ðkÞ
CqðkÞ
0
B
B
@
1
C
C
A;
k ¼ 1; . . .m;
ð9:35Þ
where the relation
Bz
1 ¼ 1
m
X
m
k¼1
B1ðkÞ=Fk
ð9:36Þ
can be used to map the ionospheric parameters in the path directions to the
parameter in the zenith direction. The meanings of the symbols are the same as
stated in Sect. 6.7. Solutions of Eq. 9.35 are (similar to Eq. 9.6)
k1N1ðkÞ
k2N2ðkÞ
B1ðkÞ
CqðkÞ
0
B
B
@
1
C
C
A ¼
1  2a
2b
1
0
2a
2a  1
0
1
1=q
1=q
0
0
a
b
0
0
0
B
B
@
1
C
C
A
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A;
QðkÞ; k ¼ 1; . . .; m;
ð9:37Þ
where the covariance matrix Q(k) can be obtained by variance-covariance propa-
gation law. The vector on the left side of Eq. 9.37 is called the secondary obser-
vation vector. In the case where K satellites are viewed, the traditional combinations
of the observation model and the related secondary solutions are the same as the
Eqs. 9.35 and 9.37, where the m = K. However, taking the parameterisation method
into account, at least one satellite has to be selected as reference and the related
ambiguities cannot be modelled. If one were to suppose that the satellite of index
K is the reference, then the ﬁrst m = K −1 observation equations are the same as
Eq. 9.35. The satellite K related observation equations can be written as
9.2
Equivalence of the GPS Data Processing Algorithms
279

R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A ¼
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
0
0
f 2
s =f 2
1
1
0
0
f 2
s =f 2
2
1
0
B
B
@
1
C
C
A
k1N1ðkÞ
k2N2ðkÞ
B1ðkÞ
CqðkÞ
0
B
B
@
1
C
C
A;
k ¼ K;
ð9:38Þ
where the ambiguities are not modelled and the constant effects will be absorbed by
the clock parameters. Solutions of Eq. 9.38 are
k1N1ðkÞ
k2N2ðkÞ
B1ðkÞ
CqðkÞ
0
B
B
@
1
C
C
A ¼ 1
2
0
0
0
0
0
0
0
0
1=q
1=q
1=q
1=q
1=2
1=2
1=2
1=2
0
B
B
@
1
C
C
A
R1ðkÞ
R2ðkÞ
k1U1ðkÞ
k2U2ðkÞ
0
B
B
@
1
C
C
A;
QðKÞ: ð9:39Þ
It is notable that the solutions of the traditional combinations are Eq. 9.37 with
m = K, whereas for the combinations with independent bias parameterisation, the
solutions are the combinations of the Eq. 9.37 with m = K −1 and Eq. 9.39. It is
obvious that the two solutions are different. Because the traditional observation
model used is inexact, the solutions of the traditional combinations are also inexact.
The bias effects (of ambiguities) that are not modelled are merged into the clock
bias parameters. Because the bias effects cannot be absorbed into the non-bias
parameters, only the clock error parameters will be different in the results and the
clock errors will have the different meanings. Further, the ionosphere-free and
geometry-free combinations are correct under the independent parameterisation.
It shows that through exact parameterisation, the combinations are no longer
independent from satellite to satellite. For surveys with multiple stations, through
correct parameterisation the combinations will no longer be independent from
station to station. Therefore, traditional combinations will lead to incorrect results
because of the inexact parameterisation.
The so-called secondary observables on the left-hand side of Eqs. 9.37 and 9.39
can be further processed. The original observables can be uniquely transformed to
secondary observables. The secondary observables are equivalent and direct mea-
surements of the ambiguities and ionosphere as well as geometry. Any further GPS
data processing can be based on the secondary observables (cf. Sect. 6.7).
9.2.4
Simpliﬁed Equivalent Representation of GPS Observation
Equations
The GPS observation models, the data differentiation (single, double, and triple
differences) and the equivalent property between un-differenced and differencing
algorithms were discussed in Chap. 6. According to the theorem of equivalent
property, Shen and Xu (2008) developed the simpliﬁed equations which
280
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

equivalently represent the single and double-differenced observation equations
using corresponding pseudo-observations in single or multi-baseline solutions.
However, this study was based on the assumption of all stations tracking the same
satellites with identical weights, thus the simpliﬁed equations were expanded in the
case of each station tracking different satellites with elevation-dependent weights
(Shen et al. 2009). The derived simpliﬁed equivalent algorithm was shown to be
very convenient for programming and efﬁcient in computation, which would
potentially aid the development of efﬁcient GNSS software and beneﬁt the local,
regional and even global GNSS multi-baseline solutions. The speciﬁc algorithm is
emphatically introduced in this section.
Single-Differenced Simpliﬁed Equivalent Observation Equations
The GNSS observation equations for one epoch can be symbolically expressed as
e ¼ Ax þ By þ Cz  l;
P;
ð9:40Þ
where y and z are the vectors of station and satellite biases, B and C denote the
respective coefﬁcient matrices with full column rank; x is a column vector with
t parameters, A is its coefﬁcient matrix also with full column rank; l and e are the
column vectors of observables and normally distributed observation errors; P is the
weight matrix of observations. Here elevation-dependent weights are used and
different stations can track the different satellites, but the correlations among the
observables (temporal, cross, and channel) are not considered. Thus, the weight
matrix P is diagonal with varying elements. Refer to Leick (2004) for the detailed
interpretation of these parameters. If there are total of k stations and each station
only tracks the subset of the total n satellites, then y = (y1 y2 … yk)T and z = (z1 z2
… zn)T. The coefﬁcient matrices, vector of observables and weight matrix are
grouped with the following sub-blocks in the order of satellites as
A ¼
A1
A2
..
.
An
0
B
B
B
B
@
1
C
C
C
C
A
; B ¼
B1
B2
..
.
Bn
0
B
B
B
B
@
1
C
C
C
C
A
; C ¼
ek1
ek2
  
..
.
ekn
0
B
B
B
B
@
1
C
C
C
C
A
;
l ¼
l1
l2
...
ln
0
B
B
B
B
@
1
C
C
C
C
A
; P ¼
P1
P2
..
.
Pn
0
B
B
B
B
@
1
C
C
C
C
A
ð9:41Þ
9.2
Equivalence of the GPS Data Processing Algorithms
281

where
A j ¼
a j
S jð1Þ
a j
S jð2Þ
..
.
a j
S jðkjÞ
0
B
B
B
B
B
@
1
C
C
C
C
C
A
; l j ¼
l j
S jð1Þ
l j
S jð2Þ
..
.
l j
S jðkjÞ
0
B
B
B
B
B
@
1
C
C
C
C
C
A
; P ¼
P j
S jð1Þ
P j
S jð2Þ
..
.
P j
S jðkjÞ
0
B
B
B
B
B
@
1
C
C
C
C
C
A
:
The symbols a j
S jðiÞ and l j
S jðiÞ denote respectively the coefﬁcient row vector and
observable of the satellite j tracked by the station S jðiÞ, P j
S jðiÞ is its weight. The
symbol S j represents the set of all stations that simultaneously track the satellite
j and S jðiÞ is the order of the ith station in the total set. The letter kj denotes the
number of stations that track the satellite j, ekj ¼
1
1
  
1
ð
ÞT is a kj vector.
The coefﬁcient for the jth satellite is a kj  k matrix B j consisting of kj canonical
row vectors, in each canonical row vector all elements are zeros expect the element
associated with the tracking receiver is one. For example, if there are ﬁve stations
and the 2nd station does not track the 3rd satellite, then the matrix B3 is
B3 ¼
1
0
0
0
0
0
0
1
0
0
0
0
0
1
0
0
0
0
0
1
0
B
B
@
1
C
C
A:
The satellite-speciﬁc parameter vector z can be eliminated by single differencing
in the station domain or by right-multiplying the original observation equations
with the transformation matrix R. The transformation matrix is (Teunissen 1997a, b;
Shen and Xu 2008)
R ¼ IP
k  C CTPC

1CTP ¼
Rk1
Rk2
..
.
Rkn
0
B
B
B
@
1
C
C
C
A;
ð9:42Þ
where the dimension of identity matrix IP
k is P k ¼ Pn
j¼1 kj, and
Rkj ¼ Ikj 
1
P
i2S j p j
i
ekjeT
kjP j ¼ Ikj 
1
p
P
j P j  eT
kj;
ð9:43Þ
where p
P
j ¼ P
i2S j p j
i being the sum of weights of observables for all stations that
tack the jth satellites.
282
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

Multiplying Eq. 9.40 with matrix R, we obtain the equivalently transformed
observation equations
~e ¼ ~Ax þ ~By ~l;
P;
ð9:44Þ
where ~A ¼ RA, ~B ¼ RB, ~l ¼ Rl, and ~e ¼ Re. As shown in Eq. 9.42, the matrix R is
diagonal with sub-matrix Rkj. Therefore, Eq. 9.44 can be further simpliﬁed as
~e j ¼ ~A jx þ ~B jy ~l j;
P j; j ¼ 1; 2; . . .; n;
ð9:45Þ
with
~A j ¼ RkjA j;
~B j ¼ RkjB j;
~l j ¼ Rkjl j;
ð9:46Þ
It is obvious that Rkj has a rank defect of one. This means that one
station-speciﬁc parameter can be linearly represented with the others, i.e. only k −1
station-speciﬁc parameters can be independently parameterised.
In the single-differenced equivalent observation equations, the independent
parameterised station-speciﬁc parameters are generally merged into x, and Eq. 9.45
becomes
~e j ¼ ~A jx ~l j;
P j; j ¼ 1; 2; . . .; n;
ð9:47Þ
where the transformed coefﬁcient matrix and observation vector can also be further
simpliﬁed as
~A j ¼ RkjA j ¼ A j 
1
p
P
j ekjeT
kjP jA j ¼ A j  dA j;
ð9:48Þ
~l j ¼ Rkjl j ¼ l j 
1
p
P
j ekjeT
kjP jl j ¼ l j  dl j;
ð9:49Þ
with
dA j ¼
1
p
P
j ekjeT
kjP jA j ¼
1
p
P
j ekj
X
i2S j
ðp j
i a j
i Þ ¼
1
p
P
j ekj½a j;
ð9:50Þ
dl j ¼
1
p
P
j ekjeT
kjP jl j ¼
1
p
P
j ekj
X
i2S j
ðp j
i l j
i Þ ¼
1
p
P
j ekj½l j;
ð9:51Þ
where ½a j ¼ P
i2S j ðp j
i a j
i Þ and ½l j ¼ P
i2S j ðp j
i l j
i Þ. Each element of the column
vector dl j and each column vector of dA j are the weighted means of their corre-
sponding column vectors. Therefore, the transformed vector ~l j is the centrobaric
9.2
Equivalence of the GPS Data Processing Algorithms
283

vector of l j, and the transformed matrix ~A j is the column centrobaric matrix of A j.
In other words, the equivalent observation Eq. 9.47 can also be simply obtained
through the centrobaric operation to the column vectors of A j and l j.
In addition, the Eq. 9.47 can alternatively be expanded in the same way as
described by Shen and Xu (2008) in the form of pseudo-observations,
~e j ¼ A jx  l j;
P j; j ¼ 1; 2; . . .; n;
ð9:52Þ
½e j ¼ ½a jx  ½l j;  1=p
P
j;
j ¼ 1; 2; . . .; n;
ð9:53Þ
where ½~e j denotes the residual of the jth sum pseudo-observation. The same normal
equations can be obtained by the equivalent observation Eqs. 9.47, 9.52, and 9.53.
Once the unknown parameter vector ^x is solved, the residual vector is computed by
v j ¼ ~A j^x ~l j;
P j; j ¼ 1; 2; . . .; n;
ð9:54Þ
Double-Differenced Simpliﬁed Equivalent Observation Equations
If there are more than two stations and each station tracks a subset of the total
n satellites, the double-differenced equivalent observation equations for multi-
baseline solutions will be much more complicated than single-differenced ones. In
order to derive the simpliﬁed double-differenced equivalent observation equations,
we rearrange Eq. 9.44 with the sub-blocks in the order of receivers and use the
same symbols as used in Eq. 9.44 to represent the rearranged single-differenced
observation equations as
~e ¼ ~Ax þ ~By ~l;
P;
ð9:55Þ
where
~A ¼
~A1
~A2
..
.
~Ak
0
B
B
B
@
1
C
C
C
A;
~Ai ¼
~aSið1Þ
i
~aSið2Þ
i
..
.
~aSiðniÞ
i
0
B
B
B
B
@
1
C
C
C
C
A
¼
aSið1Þ
i
 ½aSið1Þ=p
P
Sið1Þ
aSið2Þ
i
 ½aSið2Þ=p
P
Sið2Þ
..
.
aSiðniÞ
i
 ½aSiðniÞ=p
P
SiðniÞ
0
B
B
B
B
@
1
C
C
C
C
A
:
ni is the number of satellites tracked by the station i and Si denotes a set comprising
these ni satellites. Si(l) is the order of the lth satellite in the total set, that
284
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

~l ¼
~l1
~l2
..
.
~lk
0
B
B
B
B
@
1
C
C
C
C
A
;~li ¼
~lSið1Þ
i
~lSið2Þ
i
..
.
~lSiðniÞ
i
0
B
B
B
B
B
@
1
C
C
C
C
C
A
;
P ¼
P1
P2
..
.
Pk
0
B
B
B
B
@
1
C
C
C
C
A
; Pi ¼
pSið1Þ
i
pSið2Þ
i
..
.
pSiðniÞ
i
0
B
B
B
B
B
@
1
C
C
C
C
C
A
and ~B ¼
~b2
~b3
. . .
~bk


. The ﬁrst element in y is ﬁxed to zero to achieve
independent parameterisation. According to Eqs. 9.45 and 9.46, we can determine
the rearranged column vector ~bi as
~bi ¼
ðQ1GiaiÞT
. . .
ðQi1GiaiÞT
ðQ1ðen  aiÞÞT
ðQi þ 1GiaiÞT
  
ðQkGiaiÞT

T
ð9:56Þ
where ai ¼
p1
i
p
P
1
p2
i
p
P
2
  
pn
i
p
P
n

T
, Gi is a n  n diagonal matrix and its
diagonal element is equal to either one (corresponding to tracked satellite) or zero
(corresponding to non-tracked satellite). The ni non-zero row vectors of Gi con-
struct the ni  n matrix Qi. If there are six satellites and the 3rd station does not
track the 2nd and 5th satellites, the matrices G3 and Q3 are expressed as
G3 ¼
1
0
1
1
0
1
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
;
Q3 ¼
1
0
0
0
0
0
0
0
1
0
0
0
0
0
0
1
0
0
0
0
0
0
0
1
0
B
B
@
1
C
C
A;
ð9:57Þ
Gi ¼ QT
i Qi;
QiGi ¼ Qi;
Gi ¼ GT
i ;
GiGi ¼ Gi;
ð9:58Þ
In order to determine the transformation matrix ~R for eliminating station-speciﬁc
parameters, the following matrix is computed
9.2
Equivalence of the GPS Data Processing Algorithms
285

~BTP~B ¼
~bT
2P~b2
~bT
2P~b3
  
~bT
2P~bk
~bT
2P~b2
~bT
3P~b3
  
~bT
3P~bk
..
.
..
.
..
.
..
.
~bT
k P~b2
~bT
k P~b3
  
~bT
k P~bk
0
B
B
B
@
1
C
C
C
A;
ð9:59Þ
According to Eqs. 9.56 and 9.58, the expressions for the submatrices of ~BTP~B
are
~bT
i P~bi ¼ p
P
i 
X
l2Si
pl
ipl
i
p
P
l;
ð9:60Þ
~bT
i P~bj ¼ 
X
l2Sij
pl
ipl
j
p
P
l;
ð9:61Þ
where p
P
i ¼ P
j2Si p j
i is the sum of weights of observables for all satellites tracked
by the ith station. Sij is an intersection set of Si and Sj, denoted by Sij ¼ Si \ Sj and
refers to the set of satellites that are simultaneously tracked by both station i and
station j. The matrix ~BTP~B can be efﬁciently computed by Eqs. 9.60 and 9.61, but
its inverse is rather complicated and not symbolically expressible. Therefore, the
transformation matrix is numerically computed by
~R ¼ IP
k  ~Bð~BTP~BÞ1~BTP ¼ IP
k  ~J;
ð9:62Þ
Analogously, multiplying the transformation matrix
~R by Eq. 9.55, the
double-differenced equivalent equations are obtained as
e ¼ Ax l;
P;
ð9:63Þ
with
A ¼ ~R~A ¼ ~A  ~J~A;
ð9:64Þ
l ¼ ~R~l ¼ ~l  ~J~l;
ð9:65Þ
where the arrays ~A and ~l consist of all sub-matrices ~A j and sub-vectors ~l j,
respectively, and can be very efﬁciently computed by centrobaric operation to their
column vectors. The ðk  1Þ  ðk  1Þ square matrix ~BTP~B and its inverse are
needed to determine the transformation matrix ~R. The matrix ~BTP~B can be efﬁ-
ciently implemented by Eqs. 9.60 and 9.61, its inverse matrix can be trivially
computed, which is certainly more efﬁcient than computing the weight matrix of
286
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

double-differenced observables for multi-baseline solutions. Once the least squares
solution to parameter vector ^x is obtained, the residuals can be exactly computed by
v ¼ A^x l;
ð9:66Þ
The simpliﬁed equivalent algorithm and its efﬁciency for computation have been
veriﬁed by numerical examples; the details can be referred to Shen et al. (2009).
9.3
Non-equivalent Algorithms
As stated in the equivalence theorem of GPS algorithms, the equivalence properties
are valid for GPS surveys with deﬁnitive space-time conﬁguration. As long as the
measures are the same and the parameterisation is identical and regular, the GPS
data processing algorithms are equivalent. It is notable that if the surveys and the
parameterisation are different, then the algorithms are not equivalent to each other.
For example, algorithms of single point positioning and multi-points positioning,
algorithms of orbit-ﬁxed and orbit co-determined positioning, algorithms of static
and kinematic, as well as dynamic applications, etc., are non-equivalent algorithms.
9.4
Reference Changing in GPS Difference Algorithm
9.4.1
Changing Reference Satellite
The single baseline solution with single reference station is the most simpliﬁed and
commonly used processing mode in the GPS kinematic relative positioning.
Compared to network solutions with multiple reference stations, a single baseline
solution has advantages of fewer unknown parameters, simple weight determination
method, no baseline correlation, and a small amount of data processing. However, it
can hardly meet the requirement of long endurance and long range airborne GNSS
kinematic positioning. The problem of reference satellite changing is inevitable in
the long time airborne relative positioning. This problem was studied by Wang et al.
(2010) and Wang (2013). The details of the method are introduced in this section.
The main idea of the reference satellite changing method is that when the old
reference satellite is disappeared or in the case that the reference satellite should be
changed since cycle slip happens in its observation data, the double-differenced
ambiguity after reference satellite changing can be obtained through multiplying the
double-differencedambiguitybeforechangingreferencesatellitebyatransformmatrix.
9.2
Equivalence of the GPS Data Processing Algorithms
287

Assuming the relationship between un-differenced ambiguity and double-
differenced ambiguity before changing reference satellite can be expressed as
rDN ¼ AN0;
ð9:67Þ
where rDN denotes the double-differenced ambiguity before changing reference
satellite, N0 denotes the un-differenced ambiguity, A is the transform matrix.
The double-differenced ambiguity after changing the reference satellite can be
expressed as
rDN ¼ BN0;
ð9:68Þ
where rDN denotes the new double-differenced ambiguity after changing reference
satellite, B is the new transform matrix.
Thus, the relationship between the new double-differenced ambiguity and the old
double-differenced ambiguity can be assumed as:
rDN ¼ CrDN;
ð9:69Þ
where C is the transform matrix between old and new double-differenced
ambiguities.
Therefore, how to get the matrix C is the key problem to deal with the reference
satellite changing. Substituting Eqs. 9.67 and 9.68 into Eq. 9.69 and dividing out
N0, one has
CA ¼ B;
ð9:70Þ
Multiplying the both sides of Eq. 9.70 by ATðAATÞ1, one has
C ¼ BATðAATÞ1;
ð9:71Þ
Therefore it can be inferred that through multiplying the double-differenced
ambiguity before changing reference satellite by the transform matrix of Eq. 9.71,
the double-differenced ambiguity after reference satellite changing can be obtained.
The numerical example of this method can be referred to Wang (2013).
9.4.2
Changing Reference Station
Although the single baseline solution has been widely applied in the kinematic
relative positioning, it is generally not appropriate for the case of long range air-
borne positioning. Because of the long distance between the reference station and
kinematic station, many types of common errors cannot be eliminated directly by
288
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

the difference method. And the number of common satellites will be reduced with
the increase of baseline length. If a closer reference station can be used in place of
the original reference station, these problems may be well solved. Therefore, a
method for adaptively changing reference station for long distance airborne GPS
applications developed by Wang et al. (2010, 2011) is introduced in this section.
The basic idea of the adaptively changing reference station method is that the
positioning model always keeps the single baseline model during the whole solu-
tion. When the distance between kinematic station and reference station is longer
than the maximum distance, which is deﬁned by the user, the new reference station
is used to replace the old one. At the same time, all information of old observation
equation including covariance matrix will be transferred to the new observation
equation based on the equivalent eliminated parameter method. The calculation
steps of adaptively changing reference station are described below.
Suppose that the observation equations before and after changing reference
station can be respectively expressed as follows:
L  A
X1
X2
rDNi1;i2
2
4
3
5 ¼ V;
P;
ð9:72Þ
L0  B
X2
X3
rDNi3;i2
2
4
3
5 ¼ V0;
P0;
ð9:73Þ
where L and L0 are the double-differenced observations, A and B are the design
matrices, X1 and X3 are the position parameters of the old and new reference
stations, respectively, X2 is the position parameter of the kinematic station, ∇ΔNi1,i2
is the double-differenced ambiguities between old reference station i1 and kine-
matic station i2, ∇ΔNi3,i2 is the double-differenced ambiguities between new ref-
erence station i3 and kinematic station i2, V, V0; P, P0 are the residual vectors and
weight matrices respectively.
The Eq. 9.72 can be rewritten as
L  A1
A2
½
 X2
X


¼ V;
P;
ð9:74Þ
where X includes X1 and rDNi1;i2.
The normal equation of Eq. 9.74 can be formed as
M11
M12
M21
M22


X2
X


¼
U1
U2


;
ð9:75Þ
9.4
Reference Changing in GPS Difference Algorithm
289

where
M11
M12
M21
M22


¼
AT
1PA1
AT
1PA2
AT
2PA1
AT
2PA2


;
U1
U2


¼
AT
1PL
AT
2PL


;
ð9:76Þ
The equivalently eliminated equation (cf. Sect. 7.6) of Eq. 9.75 can be formed as
M1
0
M21
M22


X2
X


¼
R1
U2


;
ð9:77Þ
where M1 ¼ AT
1ðE  JÞTPðE  JÞA1, R1 ¼ AT
1ðE  JÞTPL, J ¼ A2M1
22 AT
2P.
Let D1 ¼ ðE  JÞA1, the ﬁrst equation of Eq. 9.77 can be expressed as
DT
1PD1X2 ¼ DT
1PL;
ð9:78Þ
Therefore the equivalent observation equation of Eq. 9.78 is
L  D1X2 ¼ V;
P;
ð9:79Þ
The normal equation of Eq. 9.73 can be formed as
BTP0B
X2
X3
rDNi3;i2
2
4
3
5 ¼ BTP0L0;
ð9:80Þ
Since the Eqs. 9.78 and 9.80 have the same position parameter X2, the corre-
sponding element of the two normal equations can be accumulated directly, then
one has
BTP0B
X2
X3
rDNi3;i2
2
4
3
5 ¼ BTL0L0;
ð9:81Þ
where B and L0 are the design matrix and observation matrix after accumulation, P0
is the weight matrix.
Therefore using the sequential least squares, the position parameter and ambi-
guity parameter of the kinematic station can be estimated based on the Eq. 9.81.
The numerical example for validation of this method can be found in Wang et al.
(2011).
290
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

9.5
Standard Algorithms of GPS Data Processing
9.5.1
Preparation of GPS Data Processing
Preparation of GPS data processing can be carried out either in pre-processing or in
the main data processing. It depends on the strategy and the purpose of the data
processing. Only in the case of data post-processing (i.e. data are available before
the processing) is pre-processing possible. In the case of data quasi real time or real
time processing, usually data are only available up to the instantaneous epoch. Data
availability also causes different strategies of the data processing.
Data preparation may include raw GPS data decoding. ASCII code data are
usually given in RINEX format (Gurthner 1994). Even in the uniﬁed format, dif-
ferent decoders may work a little bit differently from one another. This has to be
noted only if one is going to process the data decoded by using different decoders.
Usually, most GPS data processing software has its own internal input data format.
Transforming the data from the RINEX format (maybe also from multiple stations)
into the internal input data format should be no principle problem.
Cycle slip detection is one of the most important works in data preparation.
Marks are given for further use in the data where the cycle slips are detected. There
are two types of cycle slips; one is repairable, and another is not repairable.
Non-repairable cycle slips have to be modelled by new ambiguity unknowns.
Repairing and setting new unknowns are equivalent if the repair is made correctly
and the new unknown is well-solved. By real time data processing, this process has
to be done in the main data processing process.
Orbit data are also needed. Depending on the purposes of the data processing,
broadcast navigation data, IGS precise orbits, and IGS predicted orbits can be used
where the satellite clock error model is also included. In broadcast data, there is also
an ionospheric model available. Even for the GPS precise orbit determination,
initial orbits are still needed.
Further preparations depend on the organisation and purpose of the data pro-
cessing. Generally speaking, standard tropospheric models are needed for use
(cf. Sect. 5.2). An ionospheric model (from broadcast) can be used as an initial
model (cf. Sect. 5.1) if the non-ionosphere-free combination is used. An iono-
spheric model can be also obtained from the ambiguity-ionospheric equations (see
discussions in Sect. 6.5.2). Earth tide and ocean loading tide, as well as relativistic
effects have to be computed for use (cf. Sect. 5.4).
In the case of orbit determination and/or geopotential determination, an initial
geopotential model is needed. The initial models of the solar radiation and air drag
have to be computed. All corrections can be computed in real time or in advance
and then listed in tables for use. Coordinate transformations between the ECEF
system and the ECSF system are also needed.
9.5
Standard Algorithms of GPS Data Processing
291

9.5.2
Single Point Positioning
Single point positioning is a sub-process of GPS data processing, which is needed
in almost all GPS data processing. Station coordinates and receiver clock error are
determined with such a sub-process. Depending on the accuracy requirement, single
point positioning can be done with single frequency code or phase data,
dual-frequency code or phase data, and combined code-phase data. Generally
speaking, single point positioning has a lower accuracy than that of relative posi-
tioning, where systematic errors are reduced (through keeping the reference ﬁxed).
However, the receiver clock bias determined by single point positioning is accurate
enough to correct the second type of clock error inﬂuence (the inﬂuence scaled by
the velocity of the satellite, cf. Sect. 5.5).
Code Data Single Point Positioning
The GPS code pseudorange model is (cf. Sect. 6.1):
Rk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ dion þ dtrop þ dtide þ drel þ e;
ð9:82Þ
where R is the observed pseudorange, te denotes the GPS signal emission time of
the satellite k, tr denotes the GPS signal reception time of the receiver i, c is the
speed of light, subscript i and superscript k denote the receiver and satellite, and δtr
and δtk are the clock errors of the receiver and satellite at the times tr and te,
respectively. The terms δion, δtrop, δtide, and δrel denote the ionospheric, tropo-
spheric, tidal, and relativistic effects, respectively. The multipath effect is omitted
here. The remaining error is denoted as ε. qk
i is the geometric distance. The com-
puted value (denoted as C) of the pseudorange is
C ¼ qk
i ðtr; teÞ þ dtkc þ dion þ dtrop þ dtide þ drel;
ð9:83Þ
where the clock error of the satellites can be interpolated from the IGS orbit data or
broadcast navigation message, models of other effects can be found in Chap. 5, and
the initial value of receiver clock error is assumed to be zero. It should be
emphasised that the earth rotation correction has to be taken into account by the
geometric distance computation no matter if it is done in the Earth or space ﬁxed
coordinate systems (cf. Sect. 5.3.2).
The linearised observation Eq. 9.82 is then (cf. Sects. 6.2 and 6.3)
lk ¼
1
qk
i ðtr; teÞ xk  xi0
yk  yi0
zk  zi0
ð
Þ
Dx
Dy
Dz
0
@
1
A  Dt þ vk;
ð9:84Þ
where lk is the so-called O–C (observed minus computed pseudorange), vk is the
residual, vector (Δx Δy Δz)T is the difference between the coordinate vector (xi yi zi)T
292
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

and the initial coordinate vector (xi0 yi0 zi0)T, Δt is the receiver clock error in length
(i.e. Δt = δtrc), and the initial coordinate vector is used for computing the geometric
distance. Equation 9.84 can be written in a more general form as
lk ¼
ak1
ak2
ak3
1
ð
Þ
Dx
Dy
Dz
Dt
0
B
B
@
1
C
C
A þ vk;
ð9:85Þ
where akj is the related coefﬁcient given in Eq. 9.84. Putting all of the equations
from all observed satellites together, we ﬁnd the single point positioning equation
system has a general form of
L ¼ AX þ V;
P;
ð9:86Þ
where L is called the observation vector, X is the unknown vector, A is the coef-
ﬁcient matrix, V is the residual vector, and P is the weight matrix of the observation
vector. The least squares solution of observational Eq. 9.86 is then (cf. Sect. 7.2)
X ¼ ATPA

1ATPL:
ð9:87Þ
The formulas for computing the precision vector of the solved X can be found in
Sect. 7.2. It is notable that the coefﬁcients of the equation are computed using the
initial coordinate vector, and the initial coordinate vector is usually not (exactly)
known; therefore, an iterative process has to be carried out to solve the single point
positioning problem. For the given initial vector, a modiﬁed one can be obtained by
solving the above problem; the modiﬁed initial vector can be used in turn as the
initial vector to form the equations, and the problem can be solved again until the
process converges. Because there are four unknowns in the single point positioning
equation, at least four observables are needed to make the problem solvable. In
other words, as soon as four or more satellites are observed, single point positioning
is always possible.
For static reference stations, as soon as the coordinates are known with sufﬁcient
accuracy, the unknown vector (Δx Δy Δz)T can be considered zero. Then the
Eq. 9.85 turns out to be
lk ¼ Dt þ vk;
ð9:88Þ
and the receiver clock error can be computed directly by
Dt ¼ 1
K
X
K
k¼1
lk;
ð9:89Þ
where K is the total number of observed satellites at this epoch. Equation 9.89 can
be used to compute the receiver clock error of the static reference.
9.5
Standard Algorithms of GPS Data Processing
293

Dual-Code Ionosphere-Free Single Point Positioning
The above-mentioned single point positioning (using single frequency code data) is
accurate enough for correcting the second type of clock error inﬂuence (the inﬂu-
ence scaled by the velocity of the satellite). For more precise single point posi-
tioning, dual-frequency code data can be used to form the ionosphere-free
combinations (cf. Sect. 6.5). Assuming that for frequencies 1 and 2, the single point
positioning equation of Eq. 9.86 can be formed as
L1 ¼ AX þ V1;
P1
ð9:90Þ
L2 ¼ AX þ V2;
P2;
then the ionosphere-free combination can be formed by (cf. Sect. 6.5.1)
f 2
1
f 2
1  f 2
2
L1 
f 2
2
f 2
1  f 2
2
L2 ¼ AX þ V;
P;
ð9:91Þ
where
P ¼ Q1;
Q ¼
f 2
1
f 2
1  f 2
2

2
P1
1 þ
f 2
2
f 2
1  f 2
2

2
P1
2 ;
and V is the residual vector. Because the ionospheric effects have been cancelled out
of Eq. 9.91, the ionospheric model can be also omitted by computing L1 and L2 in
Eq. 9.90. The solution of Eq. 9.91 is then the solution to the dual-code
ionosphere-free single point positioning problem.
Phase Single Point Positioning
GPS carrier phase model is (cf. Sect. 6.1)
kUk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ kNk
i  dion þ dtrop þ dtide þ drel þ e; ð9:92Þ
where λΦ is the observed phase in length, Φ is the phase in cycle, wave length is
denoted as λ, and Nk
i is the ambiguity related to receiver i and satellite k, except for
the ambiguity term and the sign difference of the term of ionospheric effect; other
terms are the same as that of the pseudorange discussed at the beginning of this
section.
The computed value (denoted as C) of phase is
C ¼ qk
i ðtr; teÞ þ dtkc þ kNk
i0  dion þ dtrop þ dtide þ drel;
ð9:93Þ
where Nk
i0 is the initial ambiguity parameter related to the receiver i and satellite
k. Scaling the ambiguity parameter in length and denoting
294
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

DNk
i ¼ kNk
i  kNk
i0;
ð9:94Þ
the phase single point positioning equation is (very similar to Eq. 9.85)
lk ¼
ak1
ak2
ak3
1
ð
Þ
Dx
Dy
Dz
Dt
0
B
B
@
1
C
C
A þ DNk
i þ vk:
ð9:95Þ
Putting all equations related to all observed satellites together, the single point
positioning equation system has a general form of
L ¼ AX þ EN þ V;
P;
ð9:96Þ
where L is called the observation vector, X is the unknown vector of coordinates
and clock error, A is the X related coefﬁcient matrix, E is an identity matrix of order
K, K is the number of observed satellites, N is the unknown vector of ambiguity
parameters DNk
i ; V is the residual vector, and P is the weight matrix. If K satellites
are observed, then there are K ambiguity parameters, three coordinate parameters
and one clock parameter, so that the phase single point positioning problem is not
solvable at the ﬁrst few epochs. Using the ambiguity parameters obtained from the
ambiguity-ionospheric equations (cf. Sect. 6.5) as the initial ambiguity values, N is
then zero (can be cancelled), and Eq. 9.96 has the same form as that of Eq. 9.86. In
this way, the equation system of single-frequency phase point positioning can be
formed and solved every epoch. Even the codes are used in the ambiguity-
ionospheric equations, ambiguity parameters can be obtained with high accuracy
through a reasonable weight and instrumental bias model (cf. Sects. 6.7 and 9.2).
Dual-Phase Ionosphere-Free Single Point Positioning
The single point positioning equation of the dual-phase observables for frequencies
1 and 2 can be formed as
L1 ¼ AX þ EN1 þ V1;
P1 and
L2 ¼ AX þ EN2 þ V2;
P2:
ð9:97Þ
Then the ionosphere-free combinations can be formed by (cf. Sect. 6.5.1)
f 2
1
f 2
1  f 2
2
L1 
f 2
2
f 2
1  f 2
2
L2 ¼ AX þ ENc þ V;
P;
ð9:98Þ
9.5
Standard Algorithms of GPS Data Processing
295

where
Nc ¼
f 2
1
f 2
1  f 2
2
N1 
f 2
2
f 2
1  f 2
2
N2
and
ð9:99Þ
P ¼ Q1;
Q ¼
f 2
1
f 2
1  f 2
2

2
P1
1 þ
f 2
2
f 2
1  f 2
2

2
P1
2 :
ð9:100Þ
V is the residual vector, and index c is used to denote the ionosphere-free combi-
nations. Equation 9.98 is the dual-phase ionosphere-free single point positioning
equation system. The solution of Eq. 9.98 is then the solution of the dual-phase
ionosphere-free single point positioning problem.
Phase–Code Combined Single Point Positioning
Phase and code ionosphere-free single point positioning Eqs. 9.98 and 9.91 can be
written in more compact form as
Lp ¼ A11X1 þ A12N þ Vp;
Pp and
Lc ¼ A11X1 þ Vc;
Pc;
ð9:101Þ
where index p and c denote the phase and code related variables, X1 is the vector of
the coordinate and receiver clock error, N is the ambiguity vector, P is the weight
matrix, and V is the residual vector. To guarantee the same coefﬁcient matrix A11 for
both the phase and code observation equations, data of commonly observed
satellites have to be used.
Usually the code single point positioning problem (second equation system of
Eq. 9.101) is always solvable (as soon as more than four satellites are observed).
And the ambiguity parameter number is equal to the number of phase observables.
Therefore, the phase–code combined single point positioning problem in Eq. 9.101
is usually solvable at every epoch.
Block-wise least squares adjustment for solving the phase–code combined
problem has been discussed in Sect. 7.5.2. The algorithm can be used directly to
solve the combined Eq. 9.101.
Precise Point Positioning
The availability of precise GPS satellite orbit and clock products from the
International GNSS Service (IGS) has enabled) the development of a positioning
technology known as precise point positioning (PPP). Based on the processing of
un-differenced pseudorange and carrier phase observations from a single GPS
receiver, this approach effectively eliminates the inter-station limitations introduced
by differential GPS processing as no base station is necessary. As a result, it offers
an alternative to differential GPS that is logistically simpler and almost as accurate
(Zumberge et al. 1997; Kouba and Héroux 2001). Although PPP does not require
296
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

any base station, it requires accurate knowledge of the GPS satellite coordinates and
the state of their clocks. The algorithm of PPP is described in the following.
With a single GPS dual-frequency receiver, the following ionosphere-free
combinations can be applied to facilitate PPP positioning using un-differenced
observations.
PIF ¼ f 2
1  P1  f 2
2  P2
f 2
1  f 2
2
¼ q þ c  dt þ dtrop þ dmIF þ ePIF;
ð9:102Þ
UIF ¼ f 2
1  U1  f 2
2  U2
f 2
1  f 2
2
¼ q þ c  dt þ dtrop þ cf1N1  cf2N2
f 2
1  f 2
2
þ dmIF þ eUIF;
ð9:103Þ
where PIF is the ionosphere-free code observation, ΦIF is the ionosphere-free phase
observation, Pi and Φi (i = 1, 2) are the pseudorange observation and phase
observation on Li, respectively, fi is the frequency of Li, ρ is the geometric distance
between the satellite and the receiver, c is the speed of light, dt denotes the receiver
clock error, dtrop denotes the tropospheric delay, Ni is the integer phase ambiguity
on Li, dmIF, and δmIF denote a series of error corrections including relativistic effect,
earth tide, ocean tide, and hardware delay in pseudorange observation and phase
observation, respectively, εP and εΦ denote the remaining errors not modelled such
as multipath and observation noise of code and phase, respectively. Satellite orbit
and clock errors are not present in Eqs. 9.102 and 9.103 since they can be removed
by the use of precise orbit and clock products. The remaining receiver clock and
tropospheric delays in Eqs. 9.102 and 9.103 will be estimated in PPP.
The potential impact of PPP on the positioning community is expected to be
signiﬁcant. It brings great ﬂexibility to ﬁeld operations and also reduces labour and
equipment cost and simpliﬁes operational logistics by eliminating the need for base
stations. The performance of PPP for positioning determination has been demon-
strated in various papers—for example, Zumberge et al. (1997), Kouba and Héroux
(2001), Gao and Shen (2002), Gao et al. (2003)—using post-mission precise orbit
and clock from IGS. Following the availability of real-time precise GPS satellite
orbit and clock products, PPP has also been applied to real-time kinematic posi-
tioning (Gao and Chen 2004; Chen et al. 2013).
9.5.3
Standard Un-differential GPS Data Processing
In single point positioning, un-differenced GPS data are used. Usually, only four
unknowns are solved for, as discussed in Sect. 5.2. Single point positioning has also
a speciality of epoch-wise solution. Based on the algorithms of single point posi-
tioning, standard static un-differential GPS data processing should take more
9.5
Standard Algorithms of GPS Data Processing
297

unknown models and more station data into account. In a kinematic case, because
of the movement of the receiver, coordinates of the receiver are time variables;
therefore, model parameters are usually pre-determined or determined with another
algorithm in order to reduce the number of the unknowns.
The GPS code pseudorange and carrier phase are modelled as (cf. Sect. 6.1,
Eqs. 6.1 and 6.2, or Eqs. 9.82 and 9.92)
Rk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ dion þ dtrop þ dtide þ drel þ ec
and
ð9:104Þ
kUk
i ðtr; teÞ ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ kNk
i  dion þ dtrop þ dtide þ drel þ ep:
ð9:105Þ
Except for the ambiguity parameter and the sign of the ionospheric effect term, the
other terms on the right sides of Eqs. 9.104 and 9.105 are the same.
For any standard data combinations (cf. Sect. 6.5 for details) as given in Eqs. 6.
48 and 6.51, the above models of Eqs. 9.104 and 9.105 are still valid. Of course, on
the left sides of Eqs. 9.104 and 9.105 the combined pseudorange and combined
phase (scaled by wavelength) are used, and on the right side the ambiguity and
ionospheric effect are combined ones respectively. Exactly, for combinations of
R ¼ n1R1 þ n2R2
n1 þ n2
;
ð9:106Þ
U ¼ n1U1 þ n2U2;
ð9:107Þ
or
kU ¼ 1
f ðn1f1k1U1 þ n2f2k2U2Þ;
ð9:108Þ
where the combined signal has the frequency and wavelength
f ¼ n1f1 þ n2f2;
and
k ¼ c=f ;
ð9:109Þ
the combined ambiguity and ionospheric effects are
Ncom ¼ n1N1 þ n2N2;
ð9:110Þ
dion
comc ¼ n1dion1 þ n2dion2
n1 þ n2
and
dion
comp ¼ 1
f
n1f1dion1 þ n2f2dion2
ð
Þ;
ð9:111Þ
298
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

where n1 and n2 are the selected real constants, indices 1 and 2 are referred to
frequencies 1 and 2, and indices comc and comp denote the code and phase
combined terms.
The computed pseudorange and phase range are
Cc ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ d0
ion
comc þ d0
trop þ d0
tide þ drel
and
ð9:112Þ
Cp ¼ qk
i ðtr; teÞ  ðdtr  dtkÞc þ kNk
i0
com  d0
ion
comp þ d0
trop þ d0
tide þ drel; ð9:113Þ
where superscript 0 denotes the initial values of individual models, indices c and p
denote the terms related to the code and phase measurements, and index com
denotes the combined terms. In the case of ionosphere-free combinations, the
ionospheric effect terms will vanish. Otherwise, we should assume that the iono-
spheric effects are known by the given model or by the ambiguity-ionospheric
equations.
The linearisation of GPS observation equations is generally discussed in Sect. 6.2,
and the related partial derivatives are given in Sect. 6.3. Equations 9.106 and 9.108
can be linearised as
Lc ¼ A11Xcoor þ A12Xclock þ A13Xtrop þ A14Xtide þ Vc;
Pc and
Lp ¼ A11Xcoor þ A12Xclock þ A13Xtrop þ A14Xtide þ A15N þ Vp;
Pp;
ð9:114Þ
where Xcoor is the coordinate vector, Xclock is clock error vector, indices trop and
tide are used to denote the related unknown vectors, N is the ambiguity vector, P is
the weight matrix, V is the residual vector, and A is the related coefﬁcient matrix.
The data of commonly observed satellites have to be used to guarantee the common
coefﬁcient matrices A for both phase and code observation equations.
To process the data of more stations, Eq. 9.114 shall be formed station by station
and then combine them together. It is notable that some of the parameters are
common ones for all stations, such as satellite clock errors and Love numbers of the
earth tide. In the case of orbit determination (cf. Chap. 11 for details), the orbit
parameters and force model parameters are also common ones. The total obser-
vation equations of the un-differential GPS can then be written symbolically as
Lc ¼ A1X1 þ A4X4 þ Vc;
Pc and
Lp ¼ A1X1 þ A4X4 þ A5X5 þ Vp;
Pp
ð9:115Þ
where X1 is a sub-vector of the common variables of the both equations, X4 is the
other variable vector of the both equations, and X5 is the ambiguity vector. Adding
0X5 to the ﬁrst equation and denoting X2 ¼ ½ X4
X5 T, Eq. 9.115 can be further
simpliﬁed as
9.5
Standard Algorithms of GPS Data Processing
299

Lc ¼ A1X1 þ A2X2 þ Vc;
Pc and
Lp ¼ A1X1 þ A3X2 þ Vp;
Pp:
ð9:116Þ
Equation 9.116 can be considered an epoch-wise formed observation equation
or observation equation of all observed epochs. Most adjustment algorithms dis-
cussed in Chap. 7 can be used directly to solve the above equation system.
9.5.4
Equivalent Method of GPS Data Processing
As already discussed in Sect. 6.8, the equivalently eliminated equations of Eq. 9.16
can be formed as (cf. Sects. 6.8 and 7.6 for details)
Uc ¼ Lc  ðE  JcÞA2X2;
Pc and
Up ¼ Lp  ðE  JpÞA3X2;
Pp;
ð9:117Þ
where
Jc ¼ A1M1
11cAT
1Pc;
Jp ¼ A1M1
11pAT
1Pp;
M11c ¼ AT
1PcA1;
and
M11p ¼ AT
1PpA1:
ð9:118Þ
E is an identity matrix of size J, L, and P are the original observation vector and
weight matrix, and U is the residual vector, which has the same statistic property as
V in Eq. 9.116. As soon as the X1 in Eq. 9.116 is able to be eliminated, the
equivalent Eq. 9.117 can be formed whether Eq. 9.116 is an epoch-wise equation
or an all epoch equation.
Equation 9.117 is the zero-difference (un-differential) GPS observation equation
system if the variable vector X1 in Eq. 9.116 is considered a zero vector.
Equation 9.117 is the equivalent single-difference GPS observation equation
system if the variable vector X1 in Eq. 9.116 is considered an unknown vector of
satellite clock errors.
Equation 9.117 is the equivalent double-difference GPS observation equation
system if the variable vector X1 in Eq. 9.116 is considered an unknown vector of
satellite and receiver clock errors.
The second equation of 9.117 is the equivalent triple-difference GPS observation
equation system if the variable vector X1 in the second equation of 9.116 is con-
sidered an unknown vector of all clock errors and ambiguities.
300
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

The un-differential and differential GPS data processing can be dealt with in an
equivalent and uniﬁed way. The advantages of this method are:
1. The weight remains the original one, so one does not have to deal with the
correlation problem;
2. The original data are used, so one does not need to form the differences;
3. The un-differential and differential GPS data processing can be easily selected
by a switch or can be used in a combined way, so that the number of unknowns
(i.e. matrix size) of the whole adjustment and ﬁltering problem can be greatly
reduced.
The combinative way of using the equivalent method can be realised as follows.
First, equivalent triple differences are used to determine the unknowns other than
the clock error and ambiguity parameters. Taking these parameters as known, the
observation equation system 9.116 can be reduced so that only the clock error and
ambiguity parameters are included. Then second, equivalent double differences are
used to determine the ambiguity vector. Again, taking the ambiguity vector as
known, Eq. 9.116 can be further reduced so that only the clock error parameters are
included. Then third, equivalent single differences are used to determine the
receiver clock errors. At the end, Eq. 9.116 can be reduced so that only satellite
clock errors are included in the equations, and they can be determined. The last two
steps can be also done together in one step.
By the way, the ambiguity parameters are usually dealt with in an un-differential
form for all methods, so that the problems caused by changing the reference satellite
in a double-difference case can be avoided. This is especially important for kine-
matic GPS applications.
9.5.5
Relative Positioning
Relative positioning is traditionally carried out with differential positioning. The
key point of relative positioning is to keep the coordinates of the reference station
ﬁxed. In other words, the initial coordinate values of the reference station are
considered true values so that the related unknowns are either not necessary to be
adjusted or equal to zero. Therefore, the following two methods outline how rel-
ative positioning can be done. (1) Cancelling the reference coordinate unknowns
out of Eq. 9.116; (2) The a priori datum method discussed in Sects. 7.8.2 and 6.8.6
is used to keep the coordinates ﬁxed on the initial values. Both methods are
equivalent. The a priori datum method (cf. Sects. 7.8.2 and 6.8.6) can be also used
to keep some of the un-differential ambiguity parameters and clock parameters
ﬁxed. Keeping the reference coordinates ﬁxed in relative positioning may lead to a
better determination of the other parameters in the reference-related equations and,
therefore, may lead to an indirect reduction of the residuals.
9.5
Standard Algorithms of GPS Data Processing
301

9.5.6
Velocity Determination
Single Point Velocity Determination
Analogous to the single point positioning discussed in Sect. 5.2, single point
velocity determination can be carried out by using Doppler data. The GPS Doppler
observation is modelled as (cf. Eq. 6.46)
D ¼ dqk
i ðtr; teÞ
kdt
 f dðdtr  dtkÞ
dt
þ drel
f þ e;
ð9:119Þ
where D is the observed Doppler measurement, te denotes the GPS signal emission
time of the satellite k, tr denotes the GPS signal reception time of the receiver i,
subscript i and superscript k denote receiver and satellite, and δtr and δtk denote the
clock errors of the receiver and satellite at the time tr and te, respectively. The
remaining error is denoted as ε, f is the frequency, wavelength is denoted as λ, δrel_f
is the frequency correction of the relativistic effects, qk
i is the geometric distance,
and dk
l =dt denotes the time derivation of the radial distance between satellite and
receiver at the time tr.
The computed value (denoted as C) of Doppler is
C ¼ dqk
i ðtr; teÞ
kdt
þ f dðdtkÞ
dt
þ drel
f ;
ð9:120Þ
where the ﬁrst term on the right-hand side can be computed by using Eqs. 6.14 and
6.15.
The time derivative of the satellite clock error and the satellite position as well as
velocity can be computed from the IGS orbit data or broadcast navigation message;
the relativistic effect on frequency can be found in Chap. 5. It is obvious that the
initial position of the receiver is also needed for computing Eq. 9.120. Initial
velocity of the receiver is assumed zero. It should be emphasised that the earth
rotation correction has to be taken into account by the geometric distance com-
putation (cf. Sect. 5.3.2).
The linearised observation Eq. 9.120 is then (cf. Sects. 6.2 and 6.3 as well as
partial derivative Eq. 6.20)
lk ¼
1
kqk
i ðtr; teÞ xk  xi
yk  yi
zk  zi
ð
Þ
_xi
_yi
_zi
0
@
1
A  DD þ vk;
ð9:121Þ
where lk is the O–C (observed minus computed Doppler), vk is the residual, the
receiver’s velocity vector is
_x; _y; _z
ð
ÞT; x
y
z
ð
ÞT is the coordinate vector with
302
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

index k for satellite and i for receiver. ΔD is the receiver clock drift in cycle/second
(i.e. ΔD = f(dδtr/dt). Equation 9.121 can be written in a more general form as
lk ¼
ak1
ak2
ak3
1
ð
Þ
_x
_y
_z
DD
0
B
B
@
1
C
C
A þ vk;
ð9:122Þ
where akj is the related coefﬁcient given in Eq. 9.122. If one puts all of the equa-
tions that are related to all of the observed satellites together, the equation system of
single point velocity determination has a general form of
L ¼ AX þ V;
P;
ð9:123Þ
where L is called the observation vector, X is the unknown velocity vector including
clock drift, A is the coefﬁcient matrix, V is the residual vector, and P is the weight
matrix of observation vector. The least squares solution of observation Eq. 9.123 is
then (cf. Sect. 7.2)
X ¼ ATPA

1ATPL:
ð9:124Þ
The formulas for computing the precision vector of the solved X can be found in
Sect. 7.2. It is notable that the coefﬁcients of the equation are computed using the
initial velocity vector, and the initial velocity vector is usually not known; therefore,
an iterative process has to be carried out to solve the single point velocity deter-
mining problem. For the given initial velocity vector, a modiﬁed one can be
obtained by solving the problem; the modiﬁed initial velocity vector can be used in
turn to form the equation and solve it again until the process converges. This
iterative process is needed if the kinematic motion is very fast. Because there are
four unknowns in the single velocity determining equation, at least four observables
are needed to make the problem solvable; in other words, when four or more
satellites are observed, it is always possible to determine the single point velocity.
For static stations, the unknown velocity vector
_x; _y; _z
ð
ÞT can be considered the
zero one. Then the Eq. 9.121 turns out to be
lk ¼ DD þ vk;
ð9:125Þ
and the receiver frequency error can be computed directly by
DD ¼ 1
K
X
K
k¼1
lk;
ð9:126Þ
where K is the total number of observed satellites. Equation 9.126 can be used to
compute the frequency drift of the static reference receiver. The frequency drift of
kinematic receiver can be also computed by static initialisation.
9.5
Standard Algorithms of GPS Data Processing
303

Differential Doppler Data Processing
A more general model of Doppler data processing takes the satellite clock fre-
quency bias (clock drift) into account:
lk ¼
ak1
ak2
ak3
1
ð
Þ
_x
_y
_z
DDi
0
B
B
@
1
C
C
A þ DDk þ vk;
ð9:127Þ
where index i and k denote the receiver and satellite, and ΔD is the related fre-
quency bias. For the satellite frequency bias, the initial value from the IGS data or
navigation data can be used. If one puts together all of the equations related to all
observed satellites of all of the stations, Eq. 9.127 has a general form of
LD ¼ A1X1 þ A2X2 þ VD;
PD:
ð9:128Þ
where X1 is a sub-vector of the common variables, X2 is the vector of the other
variable, and A is the related coefﬁcient matrix. The equivalently eliminated
equations of Eq. 9.128 can be formed as (cf. Sect. 6.8 for details)
UD ¼ LD  ðE  JDÞA2X2;
PD;
ð9:129Þ
where
JD ¼ A1M1
11DAT
1PD
and
M11D ¼ AT
1PDA1:
ð9:130Þ
E is an identity matrix of size JD, L, and P are the original observation vector and
weight matrix, and U is the residual vector, which has the same property as V in
Eq. 9.128.
Equation 9.129 is the equivalent single-difference GPS Doppler observation
equation if the variable vector X1 in Eq. 9.128 is considered a vector of satellite
clock frequency bias.
Equation 9.129 is the equivalent double-difference GPS Doppler observation
equation if the variable vector X1 in Eq. 9.128 is considered a vector of the satellite
and receiver clock frequency bias.
Relative Velocity Determination
Relative velocity determining is usually carried out with a differential method. The
key point of relative velocity determination is to keep the velocity of the reference
station as ﬁxed or zero. Therefore, relative velocity determination can be done the
following two ways: (1) Cancel the reference velocity unknowns out of the
Eq. 9.128; (2) Use the method of a priori datum discussed in Sect. 7.8.2 to keep the
reference velocity ﬁxed on the initial values.
304
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

9.5.7
Kalman Filtering Using Velocity Information
As already discussed in Sect. 6.5.5, velocity information from the differential
Doppler can be used to describe the system that is needed in Kalman ﬁltering.
Whether the receiver is moving or resting, the differential Doppler includes infor-
mation about the motion state of the receiver. Therefore, using velocity information
as a system description should be better than any empirical model.
The principle of Kalman ﬁltering using velocity information can be outlined as
follows (cf. also Sect. 7.7).
For the initial (or predicted) vector Z, the normal equation of the phase obser-
vation equation can be formed by
MzZ ¼ Bz;
Z ¼
X
N


;
ð9:131Þ
where Mz is the normal matrix, and Bz is the vector on the right side of the equation.
These are formed by using initial vector Z; Z includes sub-vector X (coordinates)
and N (ambiguities). The estimated solution of Eq. 9.131 is then
~Z ¼ ~QzBz;
~Qz ¼ M1
z :
ð9:132Þ
The normal equation of the differential Doppler observation equation (cf.
Eq. 9.129, only the velocity vector is unknown) can be formed by
M_x _X ¼ B_x;
ð9:133Þ
where _X is the velocity vector of the receiver; it is also used as an index to denote
the related normal matrix and vector on the right side of the equation. The solution
of Eq. 9.133 is then
_X ¼ Q_xB_x;
Q_x ¼ M1
_x :
ð9:134Þ
Thus for the next epoch, denoted as k, the predicted vector turns out to be
ZðkÞ ¼ ~Zðk  1Þ þ _Zðk  1Þ  Dt;
ð9:135Þ
where Δt is the time interval of the epoch k–1 and k, and
_Zðk  1Þ ¼
_Xðk  1Þ
0


:
ð9:136Þ
9.5
Standard Algorithms of GPS Data Processing
305

Equation 9.135 indicates that the differential Doppler has to be used in
Eq. 9.134 as observations, because the velocity is considered an average one here.
The related covariance matrix of the predicted vector is then
QzðkÞ ¼ ~Qzðk  1Þ þ ðDtÞ2
Q_x
0
0
0


:
ð9:137Þ
The weight matrix is
PzðkÞ ¼ Q1
z ðkÞ:
ð9:138Þ
The normal Eq. 9.131 of epoch k is
MzðkÞZðkÞ ¼ BzðkÞ;
ð9:139Þ
and the Kalman ﬁlter solution of Eq. 9.139 is then
~ZðkÞ ¼ ~QzðkÞBzðkÞ;
~QzðkÞ ¼ ðMzðkÞ þ PzðkÞÞ1:
ð9:140Þ
It is notable that the normal equation 9.139 must be computed using the pre-
dicted vector Z(k) of Eq. 9.135.
Repeating the steps from Eqs. 9.133 to 9.140 for the further epoch is a process of
Kalman ﬁltering using velocity information. The algorithm outlined above is
suitable both for the kinematic and static data processing. This is true especially for
static data processing, because the station has not been exactly assumed as ﬁxed (as
described by Eq. 9.133); such an algorithm will modify the property of the strong
dependency on the initial value of the Kalman ﬁlter. The forming of normal
Eq. 9.133 is an iterative process (cf. Sect. 5.6), i.e. the velocity information has to
be used for forming the equation. Equation 9.89 represents a realistic system
description.
9.6
Accuracy of the Observational Geometry
Recalling the discussions made in the adjustment of Chap. 7, the precision vector of
the solved vector is usually represented as (cf., e.g., Eq. 7.8)
p½i ¼ m0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
Q[i][i]
p
and
ð9:141Þ
m0 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
VTPV
m  n
r
;
if ðm [ nÞ:
306
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

where i is the element index, m0 is the so-called standard deviation (or sigma),
p[i] is the ith element of the precision vector, Q[i][i] is the ith diagonal element of
the quadratic matrix Q (the inverse of the normal matrix), V is the residual vector,
superscript T is the transpose of the vector, P is the weight matrix, n is the unknown
number, and m is the observation number.
Equation 9.141 is used to describe the precision of the individual parameter of
the unknown vector X. The parameters can be usually classiﬁed into several groups
according to their physical properties, e.g., position unknowns and clock
unknowns; in turn the position unknowns can be classiﬁed by stations, and the
clock errors can be classiﬁed by satellites and receivers, etc. To describe the pre-
cision of a group of unknowns, a so-called mean-squares-root precision can be
deﬁned as
pjJ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1
n
X
J
i¼j
p½i2
v
u
u
t
;
ð9:142Þ
where j is the ﬁrst index and J is the last index of the parameters of the discussed
group, and n is the total parameter number of the group. Of course, here we assume
the parameters are ordered in groups. Putting Eq. 9.141 into above, one has
pjJ ¼ m0ﬃﬃﬃn
p DOP;
DOP ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X
J
i¼j
Q½i½i
v
u
u
t
;
ð9:143Þ
where DOP is the shortening of the Dilution of Precision factor. So we see that the
DOP factor is a very important factor to describe the precision of a group of
parameters that are the same type. Supposing in the unknown vector X[i], i = 1, 2, 3
are coordinate x, y, z of a receiver, and i = 4 is the receiver clock error, then the
Position DOP (PDOP) is deﬁned by j = 1, J = 3 in Eq. 9.143, and the Time DOP
(TDOP) is deﬁned by j = J = 4 in Eq. 9.143. The Geometric DOP (GDOP) is
deﬁned by j = 1, J = 4 in Eq. 9.143 (cf. Hofmann-Wellenhof et al. 1997). For the
case of multiple stations, the deﬁnition can be similarly extended.
The PDOP is a factor that indicates the factor of precision of the position. Quite
often, one would prefer to express the position precision in a local coordinate
system, i.e. in horizontal and vertical components. Recalling the relation between
the global and local coordinates (cf. Sect. 2.3), there are
Xlocal ¼ RXglobal;
and
Xglobal ¼ RTXlocal;
ð9:144Þ
where Xlocal and Xglobal are identical vectors represented in local and global coor-
dinate systems. R is the rotation matrix given in Eq. 2.11. According to the
covariance propagation theorem, one has then
9.6
Accuracy of the Observational Geometry
307

Qlocal ¼ RQglobalRT;
and
Qglobal ¼ RTQlocalR;
ð9:145Þ
where Qglobal is the sub-matrix of Q, which is related to the coordinates
part. Supposing in the unknown vector Xlocal[i], i = 1, 2, 3 are coordinates of
horizontal x, y, and vertical z of a receiver, then the Horizontal Dilution of Precision
(HDOP) and Vertical Dilution of Precision (VDOP) are deﬁned as
HDOP ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X
2
i¼1
Qlocal½i½i
v
u
u
t
;
and
VDOP ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
X
3
i¼3
Qlocal½i½i
v
u
u
t
:
ð9:146Þ
For many stations, the deﬁnition can be similarly given.
9.7
Introduction to the Real-Time Positioning System
Nowadays, real-time positioning is a hotspot in the GNSS ﬁeld. Two of the main
methods for precise real-time positioning, Network RTK (NRTK) and PPP-RTK,
are introduced in this section.
9.7.1
Network RTK
In the traditional RTK a single reference station is used, and the rover station needs
to work within a short range from the reference station because of the distance limit
of radio communication and the spatial decorrelation of distance-dependent errors
caused by the orbital ionosphere and troposphere errors. Thus, the operating area of
RTK positioning is dependent on the atmospheric conditions and is usually limited
to a distance of 10–20 km. Network RTK (NRTK) is a method that can overcome
the restraint of the limited range of classic RTK. The range of each station in
network is usually less than 100 km, and each reference station sends the obser-
vations to a processing centre, where the observations are processed with a network
adjustment and both errors and corrections of observation are computed. Then the
observation corrections are sent to the users through a satellite link or the Internet.
Users in the coverage area of the network can mitigate their observation errors with
these corrections (Mowafy 2012).
The principle of Network RTK begins with all reference stations within the RTK
Network continuously streaming satellite observations to a central server running
308
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

Network RTK software, such as Trimble RTKNet, Leica GNSS Spider, and Geo++.
The aim of Network RTK is to minimise the inﬂuence of the distance dependent
errors on the rovers computed position within the bounds of the network. NRTK
usually requires a minimum of three reference stations to generate corrections for
the network area. In general there is no restriction concerning the network size, it
can be regional, national, or even global.
In principle, the RTK network approach consists of four basic steps (cf.
Fig. 9.2): data collection at the reference stations; manipulation of the data and
generation of corrections at the network processing centre; broadcasting the cor-
rections, and ﬁnally positioning at the rover using information from the NRTK. In
the ﬁrst step, multiple reference stations simultaneously collect GNSS satellite
observations and send them to the control centre where ambiguity ﬁxing is per-
formed. Only observations with ﬁxed ambiguities can be used for the precise
modelling of the distance-dependent biases. The rather long distances between each
reference station and the requirement to ﬁx the ambiguities in real-time makes this
step as the main challenge of Network RTK.
Fig. 9.2 Principle of network RTK
9.7
Introduction to the Real-Time Positioning System
309

Normally, a NRTK server system would consist of the following components
(Leica Geo. systems 2011):
• A station server managed and connected to each reference station receiver.
• A network server that acquires the data from the station servers and sends it to
the processing centre.
• A cluster server that hosts the network processing software. The software per-
forms several tasks including: quality check of data, apply antenna phase centre
corrections, ambiguity ﬁxing, modelling, and estimation of systematic errors,
interpolation of errors (corrections) in some techniques (e.g., VRS, PRS) and
generation of virtual observations, or model coefﬁcients in other techniques
(e.g., FKP, Mac).
• A ﬁrewall is usually established to protect the above servers from being
accessed by a user.
• RTK proxy server to deal with requests from the users and send back network
information.
• The user interface to send/receive data from the NRTK centre.
The most signiﬁcant advantages of the Network RTK can be summarised as
follows:
• Compared with single reference station RTK, cost and labour are both reduced,
as there is no need to set up a base reference station for each user.
• Accuracy of the computed rover positions are more homogeneous and consis-
tent as error mitigation refers to one processing software, which uses the same
functional and stochastic modelling and assumptions and use the same data.
• Accuracy is maintained over larger distances between the reference stations and
the rover.
• The same area can be covered with fewer reference stations compared to the
number of permanent reference stations required using single reference RTK.
The separation distances between network stations are tens of kilometres,
usually kept less than 100 km.
• NRTK provides higher reliability and availability of RTK corrections with
improved redundancy, such that if one station suffers from malfunctioning a
solution can still be obtained from the rest of the reference stations.
• Network RTK is capable of supporting multiple users and applications.
However, Network RTK has some disadvantages, which are:
• The cost of subscription with a NRTK provider.
• The cost of wireless communication with the network (typically via a wireless
mobile using for example GPRS technology).
• The dependence on an external source to provide essential information.
310
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

9.7.2
PPP-RTK
PPP is limited in accuracy since the ionosphere-free linear combination is currently
mandatory. Accurate ionospheric models are generally not available. Since the
ionosphere-free linear combination is not based on integer coefﬁcients and the state
information currently does not preserve the integer nature of ambiguities, it is not
possible to resolve ambiguities adequately to access the full GNSS carrier phase
accuracy levels. Therefore, long integration or observation times are required for
PPP. The limitations of PPP can be overcome with RTK (Real-Time Kinematic) net-
works using state space modelling. These RTK networks can consistently derive all
individual GNSS errors in real time. The atmospheric GNSS effects are modelled and
state information is also present for ionosphere and troposphere. The complete state
information is ready for distribution to users in real time. So users are capable to resolve
ambiguitiesandtoachievetheknownRTKaccuracylevel.Thisconceptofprecisepoint
positioning enabling ambiguity resolution is PPP-RTK (Wübbena et al. 2005).
In a PPP mode, un-differenced observations are used and the satellite related
errors are reduced by using precise satellite clock corrections and employing precise
orbits to avoid the orbital errors. These precise satellite products are normally
provided
from
a
processing
centre
analysing
global
data
such
as
the
International GNSS Service (IGS). Since only one receiver is used in PPP, the
ambiguities are solved as part of the unknowns with ﬂoat numbers and not ﬁxed. As
a result, several minutes of data are needed when processing to achieve a reliable
convergence of the solution. As the ambiguities are solved as ﬂoat numbers, the
PPP accuracy can only reach at the level of sub-decimetre. However, it is possible
to integrate PPP and NRTK into a seamless positioning service, which can provide
an accuracy of a few centimetres. The concept of PPP-RTK is to augment PPP
estimation with precise un-differenced atmospheric corrections and satellite clock
corrections from a reference network, so that instantaneous ambiguity ﬁxing is
available for users within the network coverage.
References
Blewitt G (1998) GPS data processing methodology. In: Teunissen, P.J.G., and Kleusberg, A.
(eds), GPS for Geodesy, Springer-Verlag, Berlin, Heidelberg, New York, 231-270.
Chen J, Li H, Wu B, Zhang Y, Wang J, Hu C (2013) Performance of Real-Time Precise Point
Positioning. Marine Geodesy, 36: 98-108
Cui X, Yu Z, Tao B, Liu D (1982) Adjustment in surveying. Surveying Press, Peking, (in Chinese)
Gao Y, Shen X. (2002) A New Method for Carrier Phase Based Precise Point Positioning.
Navigation, Journal of the Institute of Navigation, 49(2)
Gao Y, Chen K (2004) Performance Analysis of Precise Point Positioning Using Real-Time Orbit
and Clock Products. Journal of Global Positioning Systems, 3(1-2): 95-100
Gao Y, Chen K, Shen X (2003) Real-Time Kinematic Positioning Based on Un-Differenced
Carrier Phase Data Processing. Proceedings of ION National Technical Meeting, Anaheim,
California, January 22-24, 2003.
9.7
Introduction to the Real-Time Positioning System
311

Gotthardt E (1978) Einführung in die Ausgleichungsrechnung. Herbert Wichmann Verlag, Karlsruhe
Gurtner W (1994) RINEX: The receiver independent exchange format. GPS World 5(7):48–52
Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997) GPS theory and practice. Springer-Press,
Wien
Hofmann-Wellenhof B, Lichtenegger H, Collins J (2001) GPS theory and practice. Springer-Press,
Wien
Kouba J, Heroux P (2001) Precise point positioning using IGS orbit and clock products. GPS
Solutions, 5(2):12-28
Leica Geo. Systems (2011). Using Network RTK, Available from: http://smartnet.leica-
geosystems.eu/spiderweb/2fNetworkRTK.html.
Leick A (2004) GPS Satellite Surveying (3rd ed.) xxiv+664 p. John Wiley, New York, NY
Mowafy A(2012). Precise real-time positioning using network RTK. J. Shuanggen (Ed.), Global
Navigation Satellite Systems: Signal Theory and Applications, InTech (2012) ISBN:
978-953-307-843-4
Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative geodesy:
Modelling, processing, and results. University of Texas at Austin, Center for Space Research
Seeber G (1993) Satelliten-Geodaesie. Walter de Gruyter 1989
Shen Y, Xu G (2008) Simpliﬁed equivalent representation of GPS observation equations. GPS
Solut 12: 99–108
Shen
Y,
Li
B,
Xu
G
(2009)
Simpliﬁed
equivalent
multiple
baseline
solutions
with
elevation-dependent weights. GPS Solut 13: 165–171
Strang G, Borre K (1997) Linear algebra, geodesy, and GPS. Wellesley-Cambridge Press
Teunissen P (1997a) GPS double difference statistics: with and without using satellite geometry.
J Geod 71: 137–148
Teunissen P (1997b) Closed form expressions for the volume of the GPS ambiguity search spaces.
Artiﬁcial Satellites, Journal of Planetary Geodesy 32(1):5–20
Wang LX, Fang ZD, Zhang MY, Lin GB, Gu LK, Zhong TD, Yang XA, She DP, Luo ZH, Xiao BQ,
Chai H, Lin DX (1979) Mathematic handbook. Educational Press, Peking, ISBN 13012-0165
Wang Q (2013) Adaptively Changing Strategy of Reference Satellite and Reference Station for
Long Endurance and Long Range Airborne GNSS Kinematic Positioning. Journal of
Navigation and Positioning, 1(1): 28-33
Wang Q, Xu G, Chen Z (2010) Interpolation Method of Tropospheric Delay of High Altitude
Rover Based on Regional GPS Network. Geomatics and Information Science of Wuhan
University, 35(12), 1405–1408
Wang Q, Xu G, Petrovic S, Schaefer U, Meyer U, Xu T (2011) A regional tropospheric model for
airborne GPS applications. Advances in Space Research 48, 362-369
Wells D, Lindlohr W, Schaffrin B, Grafarend E (1987) GPS Design: Undifferenced Carrier Beat
Phase Observations and the Fundamental Differencing Theorem, University of New Brunswick
Wübbena G, Schmitz M, Bagge A (2005) PPP-RTK: Precise Point Positioning Using State-Space
Representation in RTK Networks, Proceedings of the 18th International Technical Meeting of
the Satellite Division of The Institute of Navigation ION GNSS 2005, Long Beach, California,
September 13-16, 2005, pp. 2584-2594
Xu G (2002) GPS data processing with equivalent observation equations, GPS Solutions, Vol. 6,
No. 1-2, 6:28-33
Xu G (2003) GPS – Theory, Algorithms and Applications, Springer Heidelberg, ISBN
3-540-67812-3, 315 pages, in English
Xu G (2004) MFGsoft – Multi-Functional GPS/(Galileo) Software – Software User Manual,
(Version of 2004), Scientiﬁc Technical Report STR04/17 of GeoForschungsZentrum
(GFZ) Potsdam, ISSN 1610-0956, 70 pages, www.gfz-potsdam.de/bib/pub/str0417/0417.pdf
Xu G, Sun H, Shen YZ (2006b) On the parameterisation of the GPS observation models
Xu G, Yang YX, Zhang Q (2006c) Equivalence of the GPS data processing algorithms
Zumberge JF, Heﬂin MB, Jefferson DC, Watkins MM, Webb FH (1997) Precise point positioning
for the efﬁcient and robust analysis of GPS data from large networks. J. Geophysical Res., 102
(B3): 5005-5017.
312
Chapter 9  Parameterisation and Algorithms of GPS Data Processing

Chapter 10
Applications of GPS Theory
and Algorithms
In this chapter, we discuss software development using GPS theory and algorithms,
and present a concept of precise kinematic positioning and ﬂight-state monitoring
of an airborne remote sensing system.
10.1
Software Development
GPS/Galileo software generally consists of three basic components: a functional
library, a data platform, and a data processing core. The functional library provides
all of the physical models, algorithms, and tools that may be needed. The data
platform prepares all data that may be needed, which is performed in a time
loop. The data processing core forms the observation equations, accumulates them
within the time loop, and solves the problem if desired. Software can be developed
using the theory and algorithms outlined in this reference and handbook.
10.1.1
Functional Library
A functional library consists of physical models, algorithms, and tools. For con-
venience, the functions are listed below, with the references referring to the contents
described in this book (cf. Figs. 10.1, 10.2 and 10.3).
Physical Models
1. Tropospheric models for correcting or determining the tropospheric effects
(cf. Sect. 5.2)
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_10
313

2. Ionospheric model for correcting the ionospheric effects (cf. Sect. 5.1)
3. Relativity models for correcting the relativistic effects (cf. Sect. 5.3)
4. Earth tide model for the correction of the tidal displacements of the earth-ﬁxed
stations (cf. Sect. 5.4)
5. Ocean loading tide model for computing corrections of the ocean loading
displacements especially for the stations near the coast (cf. Sect. 5.4)
Fig. 10.1 Physical models
314
Chapter 10  Applications of GPS Theory and Algorithms

6. Satellite mass centre model for transformation between the mass centre and
receiver antenna centre of the GPS satellite (cf. Sect. 5.8)
7. Solar radiation model for orbit determination (cf. Sect. 11.2.4)
8. Atmospheric drag model for LEO orbit determination (cf. Sect. 11.2.5)
9. Geopotential disturbance model for dynamic orbit determination and LEO
satellite geopotential determination (cf. Sect. 11.2.1)
Fig. 10.2 Algorithms
10.1  Software Development
315

10. Tidal potential disturbance model for precise dynamic orbit determination and
LEO satellite geopotential determination (cf. Sect. 11.2.3)
11. Multi-body disturbance models for the correction of the perturbations
(cf. Sect. 11.2.2)
12. Dynamic orbit ﬁtting model for orbit correction in a regional network
(cf. Sect. 11.4)
13. Sun, Moon, and planet orbit models for computing the ephemerides of the Sun,
Moon and planets, the multi-body disturbance and the Earth tide effects
(cf. Sects. 11.2.8, 11.2.2 and 5.4)
14. Tropospheric mapping functions (cf. Sect. 5.2)
15. Ionospheric mapping functions (cf. Sect. 5.1)
16. Tropospheric model for kinematic receiver (cf. Sect. 10.3.2)
17. Keplerian orbit model (cf. Sect. 3.1.3)
Fig. 10.3 Tools
316
Chapter 10  Applications of GPS Theory and Algorithms

18. Jacobian matrices of the Keplerian elements and the state vector of the satellite
(cf. Sects. 3.1.1, 3.1.2, 3.1.3, 11.3 and 11.7)
Algorithms
1. Data pre-processing (cf. Sect. 9.5.1)
2. Forming GPS observation equations (cf. Sects. 4.1, 4.2, 4.3, and 6.1)
3. Differential Doppler data creation if necessary (cf. Sect. 6.5.5)
4. Cycle slip detections (cf. Sect. 8.1)
5. Independent parameterisation algorithms (cf. Sect. 9.1)
6. Linearisation and covariance propagation (cf. Sects. 6.3, 6.4, 11.5, and 11.7)
7. Equivalent algorithms of uncombined and combining methods (cf. Sects. 6.5,
6.7, and 9.2)
8. Equivalentalgorithms of undifferenced anddifferencingalgorithms(cf. Sects. 6.6,
6.8, 7.6, and 9.2)
9. Diagonalisation algorithm (cf. Sects. 7.6.1 and 9.1)
10. Algebraic solution of the variation equation (cf. Sect. 11.5.1)
11. Ambiguity search using general and equivalent criteria (cf. Sect. 8.3)
12. Classical adjustment tools (least squares adjustment [LSA], sequential LSA,
conditional LSA, block-wise LSA, and equivalent algorithms, cf. Sects. 7.1–7.5)
13. Filtering algorithms (Kalman ﬁlter, robust Kalman ﬁlter, and adaptive robust
Kalman ﬁlter, cf. Sects. 7.7.1, 7.7.2, and 7.7.3)
14. A priori constrained LSA (cf. Sects. 7.8.1 and 7.8.2)
15. Clock error corrections (cf. Sect. 5.5)
16. Single point positioning (cf. Sect. 9.5.2)
17. Single point velocity determination (cf. Sect. 9.5.6)
18. Accuracy of the observational geometry (cf. Sect. 9.6)
Tools
1. Coordinate transformation tools (cf. Sects. 2.1, 2.3, 2.4, and 2.5)
2. Time system transformation functions (cf. Sect. 2.6)
3. Broadcast orbit transformation in IGS format (cf. Sect. 3.3)
4. Interpolation tools (cf. Sects. 3.4, 5.4.2, and 11.6.5)
5. Integration methods (cf. Sects. 11.6.1, 11.6.2, 11.6.3, and 11.6.4)
6. Matrix inverse functions (Gauss-Jordan and Cholesky algorithms)
7. Helmert transformation (cf. Sect. 2.2)
8. Flight-state computation (cf. Sect. 10.3.3)
9. Minimum spanning tree method for forming optimal baseline network
(cf. Sect. 9.2)
10. Spectral analysis methods (cf. Xu 1992)
11. Statistical analysis (cf. Sects. 6.4 and 7.2)
12. Graphic representation
10.1  Software Development
317

10.1.2
Data Platform
A data platform consists of three parts: the common part, the sequential time loop
part, and the summary part. For convenience, the functions are listed below, with
the references referring to the contents described in this book (cf. Fig. 10.4).
Common Part
1. Program start
2. Read input parameter ﬁle for controlling the run of the software (an example of
the deﬁnition of the input parameter ﬁle, cf., e.g., Xu 2004)
3. Read all possible data ﬁles necessary for the run of the software (e.g., satellite
information ﬁle, station information ﬁle, geopotential data ﬁle, ocean loading
coefﬁcients, GPS orbit data ﬁle, polar motion data ﬁle)
4. Read or create the sun-moon-planet orbit data
5. Compute earth/ocean loading tide displacements
6. GPS satellite orbit data transformation if necessary
7. Data pre-processing if possible
8. Optimal baseline network construction and initialisations
Sequential Time Loop Part
1. Sequential time loop start
2. Get the needed data for use at the related epoch (e.g., initial coordinates of the
receivers)
3. Compute all possible parameters and model values for use at the related epoch
(e.g., transformation matrices, interpolated orbit data, values of correcting
models)
4. Read the GPS observation data and transform to a suitable form for use
5. Single point positioning (e.g., for the second type of clock error correction)
6. Single point velocity determination (velocity belongs to the state vector of the
station)
7. Data processing core (cf. Sect. 10.1.3)
8. End of the sequential time loop
Summary Part
1. Statistical analysis and spectral analysis of the results
2. Quality control and report
3. Iteration if necessary
4. Documentation and graphic representation
5. Forecast if needed
6. End of the run of the program
318
Chapter 10  Applications of GPS Theory and Algorithms

Fig. 10.4 Program common part, sequential time loop part, summary part
10.1  Software Development
319

10.1.3
A Data Processing Core
A data processing core is a collection of GPS data processing algorithms controlled
by switches. Based on the above functional library and data platform, the realisation
of a speciﬁc function of GPS software becomes a relatively simple job—one just
needs to construct the function and add it to the data processing core.
A multifunctional data processing core is a collection of individual functions and
can be switched from one to the other through input parameters. Therefore, a data
processing core is a list of speciﬁc program functions with switches. A speciﬁc
function can be called a sub-core, which is dependent on the speciﬁc purposes of
the data processing. Indeed, the single point positioning and velocity determination
functions are two functions of the data processing core. A list of the possible
functions of a multifunctional data processing core and the structure of a sub-core
are given below as examples.
Functions of a Multi-functional Data Processing Core
1. Single point state vector determination for static and kinematic as well as
dynamic applications
2. Relative positioning for static and kinematic applications
3. Ionospheric and atmospheric soundings
4. Regional tectonic monitoring with orbit corrections
5. Global network positioning and GPS orbit determination
6. LEO orbit determination and geopotential determination
Structure of a Sub-core
1. Computing the computed observables using the orbit and station data as well as
the values of the physical models (may be used for system simulation)
2. Computing the coefﬁcients of linearised observation equations
3. In the case of dynamic applications, solving the variance equations for forming
the orbit related observation equations
4. Forming the normal equations
5. Accumulation of the normal equations
6. Solving the problem if desired
320
Chapter 10  Applications of GPS Theory and Algorithms

10.2
Introduction of GPS Software
In this section, we will introduce several GPS software programs commonly used
around the world.
1. GAMIT/GLOBK/TRACK
The GAMIT, GLOBK, and TRACK (http://www-gpsg.mit.edu/*simon/gtgk/)
form a comprehensive suite of programs for analysing GPS measurements primarily
to study crustal deformation. The software was developed by the Massachusetts
Institute of Technology (MIT), Scripps Institution of Oceanography, and Harvard
University, with support from the National Science Foundation (NSF). The soft-
ware is available, without written agreement or royalty fee, to individuals, univer-
sities, and governmental agencies for any non-commercial purpose. The download
password and software updates can be obtained by contacting Dr. Robert W. King
(rwk@chandler.mit.edu).
GAMIT is a collection of programs used for the analysis of GPS data. It uses the
GPS
broadcast
carrier-phase
and
pseudorange
observables
to
estimate
three-dimensional relative positions of ground stations and satellite orbits, atmo-
spheric zenith delays, and earth orientation parameters. The software is designed to
run under any UNIX operating system. GLOBK is a Kalman ﬁlter whose primary
purpose is to combine various geodetic solutions such as GPS, VLBI, and SLR
experiments. It accepts as data, or “quasi-observations”, the estimates and covari-
ance matrices for station coordinates, earth orientation parameters, orbital param-
eters, and source positions generated from analysis of the primary observations. The
input solutions are generally performed with loose a priori uncertainties assigned to
all global parameters, so that constraints can be uniformly applied in the combined
solution. TRACK is a GPS differential-phase kinematic positioning program.
TrackRT is a real-time GPS kinematic processing program.
2. GIPSY–OASIS II
GIPSY-OASIS (GOA II) (https://gipsy-oasis.jpl.nasa.gov/) is a rapid automated
ultra-high-precision GPS data processing software package with strict data quality
control, which is supported by the National Aeronautics and Space Administration
(NASA) Jet Propulsion Laboratory (JPL) in Pasadena, California.
Features of GOA II include demonstrated centimetre-level accuracy (ground and
space); automated, unattended low-cost operations; innovative GPS and non-GPS
analysis capabilities; real-time capability (with RTG, Real-Time GIPSY); a unique
ﬁlter/smoother without equal in GPS estimation capabilities and accuracy; and
adaptability to non-GPS orbiters and non-NASA programs (FAA, military, com-
mercial). With GOA II, one can carry out orbit determination (individual spacecraft
or satellite constellations); precise positioning and timing on land, sea, and air; and
automated (unattended) operations, with near-real-time capability and real-time
capability with RTG.
10.2  Introduction of GPS Software
321

In addition, the Automatic Precise Positioning Service (APPS, replaces
Auto-GIPSY) is an e-mail/ftp interface to GIPSY. It performs basic analysis of GPS
data in a RINEX ﬁle. You do not need GIPSY to use APPS; all processing occurs
on a computer at JPL. E-mail is used to inform APPS about the location of your
data. E-mail is sent from APPS to inform you about the location of the results.
Anonymous ftp is used by APPS to fetch your data, and you use anonymous ftp to
fetch the results.
3. Bernese
The Bernese GNSS Software (http://www.bernese.unibe.ch/) is a scientiﬁc,
high-precision, multi-GNSS data processing software developed at the Astronomical
Institute of the University of Bern (AIUB). It is used by CODE (Centre for Orbit
Determination in Europe) for its international (IGS) International GPS Service for
Geodynamics (IGS) and European (EUREF/EPN) activities.
Bernese has features that include state-of-the-art modelling, detailed control over
all relevant processing options, performance automation tools, adherence to
up-to-date internationally adopted standards, and inherent ﬂexibility due to a highly
modular design. It is particularly well suited for rapid processing of small-size
single- and dual-frequency combination surveys; automatic processing of perma-
nent networks; processing of data from a large number of receivers; a combination
of different receiver types, taking antenna phase centre variations into account;
combined processing of GPS and GLONASSGLONASS observations; ambiguity
resolutionAmbiguityresolution on long baselinesBaseline (2000 km and longer);
ionospheric and tropospheric monitoring; clock estimation and time transfer; gen-
eration of minimum-constraint network solutions; and orbit determination and
estimation of earth orientation parameters.
4. RTKLIB
RTKLIB (http://www.rtklib.com/) is an open source program package for GNSS
positioning. RTKLIB has a number of features. It supports standard and precise
positioning algorithms with GPS, GLONASS, Galileo, QZSS, BeiDou, and SBAS.
It supports various positioning modes with GNSS for both real-time and
post-processing (single, DGPS/DGNSS, kinematic, static, moving-baseline, ﬁxed,
PPP-kinematic, PPP-static, and PPP-ﬁxed). It also supports many standard formats
and protocols for GNSS, and several GNSS receiver proprietary messages. It
supports external communication via serial, TCP/IP, NTRIP, local log ﬁle (record
and playback), and FTP/HTTP (automatic download), and it provides many library
functions and APIs for GNSS data processing.
322
Chapter 10  Applications of GPS Theory and Algorithms

10.3
Concept of Precise Kinematic Positioning
and Flight-State Monitoring
A concept of precise kinematic positioning and ﬂight-state monitoring of an air-
borne remote sensing system is presented here, based on the practical experiences
from the EU project AGMASCO. Within the project, about 2 months of kinematic
GPS ﬂight data and static reference data have been collected in Europe during four
campaigns over 3 years. An independently developed GPS software package and
several commercial GPS software packages have been used for data processing. In
this chapter, we discuss the methods of creating the tropospheric model for the
aircraft trajectory and the use of static ambiguity results as conditions in the
kinematic positioning. These concepts are implemented in the kinematic/static
GPS software KSGsoft, and they have demonstrated excellent performance
(cf. Xu 2000).
Fig. 10.5 Measured areas of the four ﬂight campaigns
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
323

10.3.1
Introduction
The European Union (EU) project AGMASCO (Airborne Geoid Mapping System
for Coastal Oceanography), in which ﬁve European institutions participated, has
collected about 2 months of multiple static and airborne kinematic GPS data for the
purpose of kinematic positioning and ﬂight-state monitoring of an airborne remote
sensing system. This system includes an aerogravimeter, accelerometer, radar and
laser altimeter, INS, and datalogger. During the project, four ﬂight campaigns were
performed in Europe (Fig. 10.5): the test campaign in Braunschweig in June 1996
(Fig. 10.6), the Skagerrak campaign in September 1996 (Fig. 10.7), the Fram Strait
campaign in July 1997 (Fig. 10.8), and the Azores campaign in October 1997
(Fig. 10.9). Two to three kinematic GPS antennas were mounted on the fuselage,
Fig. 10.6 Flights in the Braunschweig campaign (June 1996)
Fig. 10.7 Flights in the Skagerrak campaign (September 1996)
324
Chapter 10  Applications of GPS Theory and Algorithms

the back, and the wing of the aircraft, and at least three GPS receivers were used as
static reference receivers.
The above-mentioned remote sensing system has two very important objectives:
to measure the gravity acceleration of the earth and to determine the sea surface
Fig. 10.8 Flights in the Fram Strait campaign (July 1997)
Fig. 10.9 Flights in the
Azores campaign (October
1997)
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
325

topography. Because the aerogravimeter (or accelerometer) and the altimeter are
ﬁrmly attached to the aircraft, kinematic positioning and ﬂight-state monitoring
using GPS plays a key role for determining the ﬂight acceleration, velocity and
position, as well as orientation of the aircraft. The high sensitivity of the sensors
requires high quality aircraft positioning and ﬂight-state monitoring. Therefore, new
strategies and methods have been studied, developed, tested, and implemented for
GPS data processing.
The adopted concept of precise kinematic positioning and ﬂight-state monitoring
are discussed in Sects. 10.3.2 and 10.3.3, respectively.
10.3.2
Concept of Precise Kinematic Positioning
A vast amount of literature exists on the topic of precise kinematic positioning (see,
e.g., Remondi 1984; Wang et al. 1988; Schwarz et al. 1989; Cannon et al. 1997a, b;
Hofmann-Wellenhof et al. 1997). Based on AGMASCO practice, a modiﬁed
concept has been developed and applied to data processing.
10.3.2.1
Combining the Static References with IGS Station
It is well known that differential GPS positioning results depend on the accuracy of
the reference station(s). However, it is not quite clear how strong this dependency is
—or in the other words, how accurately the reference coordinates should be
determined for use in kinematic differential positioning. During AGMASCO data
processing, it was noted that the accuracy of the reference coordinates is very
important. A bias in the reference station coordinates will cause not only a bias in
the kinematic ﬂight path, but also a signiﬁcant linear trend. Such a liner trend
depends on the ﬂight direction and the location of the reference receiver(s).
Therefore, in precise kinematic positioning, the coordinates of the static reference
station should be carefully determined by, for example, connecting these stations to
the nearby IGS stations. A detailed study of the relationship between the accuracy
of the reference station coordinate and the quality of kinematic and static posi-
tioning was carried out by Jensen (1999).
10.3.2.2
Earth Tide and Loading Tide Corrections
A detailed study of the earth tide effects on GPS kinematic/static positioning is
given in Xu and Knudsen (2000). For airborne kinematic differential GPS
326
Chapter 10  Applications of GPS Theory and Algorithms

positioning, one needs to correct for the earth tide effects on the static reference
station. Such tidal effects can reach 30 cm in Denmark and Greenland, and 60 cm at
other locations in the world. Tidal effects can induce a “drift” over a few hours of
measurement duration. For ground-based kinematic and static differential GPS
positioning with baseline lengths less than 80 km, the impact of the earth tide
effects can reach more than 5 mm. In precise application of GPS positioning, both
in kinematic and static cases, the earth tide effects must therefore be taken into
account even for a relatively small local GPS network.
Ocean loading tide effects could also reach up to a few cm in magnitude, in
special cases (Ramatschi 1998). Generally, ocean loading tide effects should be
considered at the centimetre level in coastal areas so that these effects have to be
corrected for GPS data processing. However, unlike the earth tide, ocean loading
tide effects can only be modelled by ocean tide models at about 60–90 %
(Ramatschi 1998). Therefore, simply using a model to correct for the effects is not
enough, and a detailed study of ocean loading tide effects is necessary for precise
positioning. It is, however, possible to use GPS for determining the parameters of
the local ocean loading tide effects (Khan 1999).
10.3.2.3
Multiple Static References for Kinematic Positioning
In differential GPS kinematic positioning, usually there is only one static reference
used. It is obvious that if multiple static references are used, the reference
station-dependent errors, such as those due to the troposphere and ionosphere as
well as ocean loading tide effects, can be reduced and the geometric stability can be
strengthened. For simplicity, only the case of using two static reference receivers
will be discussed here. In Fig. 10.10, 1 and 2 denote the static reference receivers,
and k denotes the kinematic object. Suppose the two static stations are placed close
by and both have the same GPS satellites in view. Using one static reference
receiver for kinematic positioning, one has unknown vector (Xk N1k), where X is the
coordinate sub-vector and N is the ambiguity sub-vector. Using two static
Fig. 10.10 Multiple static
references for kinematic
positioning
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
327

references, one has unknown vector (Xk N1k N2k), because the unknown coordinate
sub-vector X is the same. The number of elements of the sub-vector N compared
with that of X is very small in the kinematic case. Therefore, by using multiple static
reference receivers for kinematic positioning, the total number of observations is
increased, but the total number of unknowns remains almost the same; thus, the
results will be modiﬁed.
Furthermore, according to the deﬁnition of double-differenced ambiguities, one
has
N1k ¼ N j
1  N j
k  NJ
1 þ NJ
k ;
ð10:1Þ
N2k ¼ N j
2  N j
k  NJ
2 þ NJ
k
ð10:2Þ
and
N12 ¼ N j
1  N j
2  NJ
1 þ NJ
2;
ð10:3Þ
where N on the right sides is un-differenced ambiguity, indices j and J denote
satellites, 1 and 2 denote the static stations, and k denotes the kinematic station.
Then one gets
N1k  N2k ¼ N12;
ð10:4Þ
where N12 is the double-difference ambiguity vector of the static baseline, which
can be obtained from the static solution. Using relation Eq. 10.4, N2k can be rep-
resented by (N1k −N12). Thus, using two static references for kinematic position-
ing, one has nearly doubled the number of observables, yet the unknowns remain
the same, if in addition the static results are used (typically, static measuring can be
made over a longer time, and hence precise static results can be obtained).
In the case of a single difference, one has
N1k ¼ N j
1  N j
k;
ð10:5Þ
N2k ¼ N j
2  N j
k;
ð10:6Þ
and
N12 ¼ N j
1  N j
2;
ð10:7Þ
where N on the right sides is un-differenced ambiguity, index j denotes the satellite,
1, 2 denote the static stations, and k denotes the kinematic station. Then one gets the
same relation as in the case of double difference:
328
Chapter 10  Applications of GPS Theory and Algorithms

N1k  N2k ¼ N12:
ð10:8Þ
For un-differenced data processing, ambiguity vectors are ðN j
1N j
kÞ and ðN j
2N j
kÞ in
kinematic data processing using a single reference. ðN j
1N j
2Þ is the ambiguity vector
in static data processing. Regardless of how one deals with the reference-related
ambiguities, the common part of the ambiguities obtained from static data pro-
cessing can be used in kinematic data processing.
The accuracy of the kinematic positioning can be signiﬁcantly increased by
using multiple static reference receivers and by introducing the ambiguities from
the static solution as conditions. An example showing the differences in the height
of the front antenna determined using multiple reference receivers, with and without
the use of the static ambiguity condition, is given in Fig. 10.14 (the ambiguity ﬂoat
solutions are used). The average and standard deviation of the differences are 27.07
and 4.34 cm, respectively. These results clearly indicate that the multiple static
conditions have modiﬁed the results. A change in ambiguity resulted in not only a
bias in the position solution, but also a high frequency variation. The base–base
separation is about 200 km, and the length of the kinematic path is about 400 km
(cf. Fig. 10.9).
For three or more static references receivers, similar arguments and improved
results can be presented.
10.3.2.4
Introducing Height Information as a Condition
Even after using multiple static reference receivers and static conditions, the
ambiguities in kinematic positioning can still be wrong. In this case, there could be
a bias and a variation in the kinematic trajectory (see Sect. 10.3.4.2 and Fig. 10.14).
Therefore, introducing the height information of the aircraft at the start and/or
resting point into the data processing is of great help, especially in airborne al-
timetry applications. The bias of the results obtained with the use of different
software can then be eliminated.
10.3.2.5
Creation of a Kinematic Tropospheric Model
The multiple static reference receivers can be used to determine the parameters of
the tropospheric model. Using these parameters, the tropospheric model parameters
for the kinematic receiver can be interpolated. Such a model, however, is generally
suitable only for the footprint point of the kinematic platform. Therefore, the ver-
tical gradient of temperature and the exponential changes in pressure and humidity
(Syndergaard 1999) are introduced into the standard model to create a tropospheric
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
329

model for the kinematic station in the air. Of course, this is not an ideal model, but it
is a very reasonable one.
10.3.2.6
Higher-Order Ionospheric Effect Correction
For long-distance kinematic positioning, the ionosphere-free combination must be
used to eliminate the ionospheric effects. It is well known that the ionosphere-free
combination is indeed only a ﬁrst-order approximation (Klobuchar 1996). The
second-order ionospheric effects are about 0.1 % of those of the ﬁrst order
(Syndergaard 1999). Therefore, the residual ionospheric effects can reach a level of
a few centimetres. This must be taken into account using some form of modelling of
the total ionospheric effects.
10.3.2.7
A General Method of Integer Ambiguity Fixing
An integer ambiguity search method based on the conditional adjustment theory was
proposed in Sect. 8.3. This method has been implemented in the GPS software
KSGsoft (Kinematic/Static GPS Software), developed in GFZ Potsdam (Xu et al.
1998), and used extensively for real data processing in the EU project AGMASCO
(Xu et al. 1997a, b). The search can be carried out in the coordinate domain,
ambiguity domain, or both domains. Most other least squares ambiguity search
methods (Euler and Landau 1992; Teunissen 1995; Merbart 1995; Han and Rizos
1995, 1997) are special cases of this algorithm, if only the ambiguity search domain
is selected and without considering the uncertainty of the coordinates caused by
ambiguity ﬁxing. By taking the coordinate and ambiguity residuals into account, a
general criterion for ambiguity searching is proposed to ensure an optimal search
result. Detailed formulas are derived, and their use is described in Sect. 8.3. The
theoretical relationship between the general criterion and the least squares ambiguity
search criterion is also derived and illustrated by numerical examples in Sect. 8.3.
10.3.3
Concept of Flight-State Monitoring
For ﬂight-state monitoring of an aircraft, several GPS antennas must be used, and
the relative positions between the multiple antennas must be determined. As an
example, using the method presented in Sect. 10.3.2, the position and velocity of
one of the kinematic antennas can be determined. Using this point as a reference,
330
Chapter 10  Applications of GPS Theory and Algorithms

the related position differences of other antennas can be determined. Because the
distances between the multiple antennas are only a few metres, the atmospheric and
ionospheric effects are nearly identical, and therefore only the single-frequency L1
observations are needed for relative positioning. In addition, due to the short ranges,
this relative positioning can be performed with high accuracy.
Early stage tests of multiple kinematic GPS antennas mounted on a platform
were made for checking purposes, using the known baseline length. Typically, such
checks indicate that the distance has a systematic bias if the distance is computed
from the two positions, and these two positions are determined separately.
However, a combined solution of multiple kinematic positioning does not over-
come the distance bias problem completely, because of inaccuracies in the ambi-
guity solution. Therefore, for precise ﬂight-state monitoring, it is necessary to
introduce the known distances between the antennas ﬁxed on the aircraft as addi-
tional constraints in the data processing.
The distance condition can be represented as
q ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðDXÞ2 þ ðDYÞ2 þ ðDZÞ2
q
;
ð10:9Þ
where ΔX, ΔY, and ΔZ are the coordinate differences between two antennas, and ρ is
the distance. Because of the short distances, the linearisation of the condition cannot
be done precisely in the initial step, and thus an iterative process must be used. The
conditions can be used in a conditional adjustment, or they can be used for elim-
inating unknowns. The two methods are equivalent.
Flight state is usually represented by so-called state angles (heading, pitch, and
roll). They are rotation angles between the body and the local horizontal coordinate
frames of the aircraft. The axes of the local horizontal frame are selected as follows:
the xb axis points out the nose, the yb axis points to the right parallel to the wing,
and the zb axis points out the belly to form a right-handed coordinate system,
where b denotes the body frame. The body frame can be rotated to be aligned to the
local horizontal frame in a positive, right-handed sense, which is outlined in three
steps. First, the body frame is rotated about the local vertical downward axis z by
angle ψ (heading). Then the body frame is rotated about the new yb axis by angle θ
(pitch). Finally, the body frame is rotated about the new xb axis by angle ϕ (roll). In
the local horizontal coordinate system, the heading is the azimuth of axis xb of the
body frame, the pitch is the elevation of axis xb of the aircraft and the roll is the
elevation of axis yb of the aircraft. Note that the directions of the axis xb and the
velocity vector of aircraft are usually not the same. Through kinematic positioning,
the three ﬂight-state monitoring angles can be computed (Cohen 1996).
Suppose three kinematic GPS antennas are mounted on the aircraft at the front,
the back and the right wing (denoted as f, b, w), so that the y components of the
coordinates of front and back antennas in the body frame are zero, i.e. yb
f ¼ yb
b ¼ 0,
and x, z components of the coordinates of the wing antenna in the body frame are
zero, i.e. xb
w ¼ zb
w ¼ 0. Then the coordinates of three antennas in body ﬁxed frame
are Pf xb
f ; 0; zb
f


; Pb xb
b; 0; zb
b


, and Pw 0; yb
w; 0


. Because the antennas are mounted
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
331

as above supposed and because the ﬂight state is computed by the positions of three
antennas, there are pitch and roll correction angles that can be computed from the
three coordinates by
tanðh0Þ ¼ zb
f  zb
b
xb
f  xb
b
and
ð10:10Þ
tanð/0Þ ¼  z0
yb
w
;
ð10:11Þ
where
z0 ¼ zb
f  xb
f tanðh0Þ:
ð10:12Þ
Through kinematic positioning and coordinate transformation, one has the
coordinates of the three points in the local horizontal frame Pf(xf, yf, zf), Pb(xb, yb,
zb), and Pw(xw, yw, zw). Then the three ﬂight-state monitoring angles can be
computed by
tanðwÞ ¼ yf  yb
xf  xb
;
ð10:13Þ
tanðh  h0Þ ¼ zf  zb
S
;
ð10:14Þ
S ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxf  xbÞ2 þ ðyf  ybÞ2
q
;
ð10:15Þ
tanð/  /0Þ ¼ zw  z0
s
;
and
ð10:16Þ
s ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðxw  x0Þ2 þ ðyw  y0Þ2
q
;
ð10:17Þ
where
ﬃ
p is the squares root operator and
x0 ¼ xf  ðxf  xbÞK;
ð10:18Þ
y0 ¼ yf  ðyf  ybÞK;
ð10:19Þ
z0 ¼ zf  ðzf  zbÞK
and
ð10:20Þ
K ¼
xb
f
xb
f  xb
b
:
ð10:21Þ
Comparisons of numerical GPS ﬂight-state monitoring results are made with the
results of INS. It is possible to use GPS to determine the heading with an accuracy
332
Chapter 10  Applications of GPS Theory and Algorithms

up to 0.1°, and pitch and roll up to 0.2°. In this case, the distances between the three
antennas were 5.224, 5.510, and 4.798 m.
10.3.4
Results, Precision Estimation, and Comparisons
Examples
demonstrating
the
above-mentioned
methods
are
given
through
kinematic/static processing of a set of kinematic/static GPS data collected on
3 October 1997 at the islands of Portugal in the Atlantic Ocean within the Azores
campaign. Two reference stations (Faim and Flor) served as static references, with a
distance of about 239.4 km. Three antennas are ﬁxed at the front, the back, and the
Fig. 10.11 One ﬂight trace determined by kinematic GPS
Fig. 10.12 Height proﬁle of one ﬂight determined by kinematic GPS
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
333

wing of the aircraft for determining the ﬂight state. The distances between the
baselines of front-back, front-wing, and back-wing are 5224, 5510, and 4798 m,
respectively. The ﬂight time is about 4 h. The length of the area is about 400 km
(Fig. 10.11), and the height of the ﬂight is about 400 m (Fig. 10.12).
57000
61000
65000
69000
Time(s)
-0.4
-0.2
0
0.2
0.4
Height difference (m)
Flor-Faim
Faim-2ref
Flor-2ref
Fig. 10.13 Height differences caused by static references
Table 10.1 Statistics of the
differences in the heights
determined
Height differences
Average
Deviation
Flor-2ref
1.62
3.52
Faim-2ref
−0.27
4.76
Flor-Faim
1.89
6.27
Fig. 10.14 Height differences caused by static references
334
Chapter 10  Applications of GPS Theory and Algorithms

10.3.4.1
Multiple Static References for Kinematic Positioning
The ﬂight trajectory determined using multiple references is a kind of weighted
average path of the trajectories determined separately using a single reference. The
heights of the front antenna are determined using a single reference and multiple
references, respectively. The height differences of Flor-Faim, Flor-2ref, and
Faim-2ref are given in Fig. 10.13, indicated by blue, red, and green lines, where
“Flor-Faim” indicates the height differences between the results obtained using Flor
and Faim separately as a static reference, and “2ref” indicates that two references
were used. The difference statistics are given in Table 10.1 (units: cm), which
shows that the multiple references helped to stabilise the results.
10.3.4.2
Ambiguity of Multiple Static References as a Condition
for Kinematic Positioning
In the case of multiple static references, a static solution between the static refer-
ences can be made for obtaining the static ambiguity vector, which can usually be
obtained with excellent quality. By introducing such results as conditions for
kinematic positioning, the accuracy of the position solution can be modiﬁed. The
differences of the heights of the front antenna determined by using multiple ref-
erences with and without static ambiguities as conditions are given in Fig. 10.14.
The average and standard deviation of the differences are 27.07 and 4.34 cm,
Fig. 10.15 Heading determined by GPS
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
335

57000
61000
65000
69000
Time (s)
-10
0
10
Angles (degrees)
Pitch
Roll
Fig. 10.16 Pitch and roll determined by GPS
57000
61000
65000
69000
Time (s)
-2
-1
0
1
2
3
Differences (degrees)
Heading
Roll
Pitch
Fig. 10.17 Differences in ﬂight state determined by GPS and INS
Table 10.2 Statistics of the
differences in ﬂight-state
angles determined by GPS
and INS
Differences of
Average
Deviation
Heading
0.230
0.238
Pitch
0.233
0.596
Roll
−0.249
0.612
336
Chapter 10  Applications of GPS Theory and Algorithms

respectively. These have shown that the multiple static conditions have helped to
modify the results. A change in ambiguity caused not only a bias, but also a
variation in the results.
Using multiple static references and introducing the static ambiguities as con-
ditions, accuracy of the kinematic positioning can rise signiﬁcantly. However, the
airborne altimetry results have shown that the GPS height solution still has a bias.
Therefore, airport height information is introduced as a condition for modifying
ambiguity resolution and eliminating the height bias of the GPS solution. To
introduce tropospheric parameters for the aircraft, statically determined parameters
and the vertical temperature gradient have been used.
10.3.4.3
Multiple Kinematic GPS for Flight-State Monitoring and Its
Comparison with INS
GPS-determined heading, pitch, and roll are given in Figs. 10.15 and 10.16 (with
red and green lines), respectively, and the results are compared with those of INS.
The differences in ﬂight-state angles determined by GPS and INS are given in
Fig. 10.18 Height changes by static data kinematic processing
Table 10.3 Statistics of the
differences in velocity
Velocity difference
dVs
dVe
dVh
Average
0.03
−0.01
−0.06
Deviation
0.27
0.17
0.53
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
337

Fig. 10.17, with differences in the heading, pitch, and roll represented by blue, red,
and green lines, respectively. The statistics of the differences in heading, pitch, and
roll are given in Table 10.2 (units: degrees). The larger deviations of the pitch and
roll are due to larger uncertainties of the height components determined by GPS.
Considering the large deviation around epoch 66,000 and the data gap in INS
around epoch 68,000, it is possible to use GPS to determine the heading with
accuracy up to 0.1° and pitch and roll up to 0.2°.
10.3.4.4
Static GPS Data Kinematic Processing
Static GPS data kinematic processing is one of the methods used to check the
reliability of the GPS software working in a kinematic module. Such data pro-
cessing has been used for studying earth tide effects (Xu and Knudsen 2000) and
ocean loading tide effects. Faim has been used as a reference, and the position of
Flor has been solved with static and kinematic modules. The static height of Flor is
98.257 m. The kinematic height average is 98.272 m, and its standard deviation is
3.8 cm. This indicates that kinematic data processing can reach an accuracy of
about 4 cm with a baseline length of about 240 km. Although these results seem
very good, the kinematic height graphic (see Fig. 10.18) shows a clear ambiguity
problem in kinematic data processing. As soon as a satellite moves up or down, a
jump will occur in the solution trajectory.
10.3.4.5
Doppler Velocity Comparisons
Previous research (Xu et al. 1997a, b) has shown high accuracy for velocity
solutions derived from Doppler measurements, and it appears that the velocity
solutions are independent from the static references. A statistical analysis of the
differences in velocity solved using different static references (Flor or Faim) is
given in Table 10.3 (units: cm s−1), which again conﬁrms the previous conclusion.
The nominal ﬂight velocity is about 80 m s−1 in the horizontal. In the vertical
component, the maximum velocity is about 5 m s−1.
10.3.5
Conclusions
GPS research during the AGMASCO project has revealed that GPS can be used for
airborne kinematic positioning and ﬂight-state monitoring to fulﬁl the needs of
338
Chapter 10  Applications of GPS Theory and Algorithms

navigating a remote sensing system for applications in aerogravimetry and
oceanography.
A methodology has been proposed for precise kinematic GPS positioning that
addresses the following issues:
• Using IGS stations to obtain precise reference coordinates, and introducing earth
tide and ocean loading tide corrections
• Introducing multiple static reference receivers and using static ambiguity solu-
tions as conditions
• Introducing the initial height information as a condition, and introducing the
tropospheric model to the aircraft kinematic GPS receivers
• Modelling the higher-order ionospheric effects, and using the general method of
ambiguity searching in coordinate and ambiguity domains.
For ﬂight-state monitoring, the kinematic reference and data of the single-
frequency L1 are used. Known distances between the multiple kinematic antennas
are used as additional constraints.
Results have shown adequate performance for this methodology.
References
Cannon ME, Lachapelle G, Goddard TW (1997) Development and results of a precision farming
sys-tem using GPS and GIS technologies. Geomatica 51,1:9–19
Cannon ME, Lachapelle G, Szarmes M, Herbert J, Keith J, Jokerst S (1997) DGPS kinematic
carrier phase signal simulation analysis for precise velocity and position determination.
Proceedings of ION NTM 97, Santa Monica, CA
Cohen CE (1996) Altitude determination. Parkinson BW, Spilker JJ (eds) Global Positioning
System: Theory and applications, Vol. II
Euler H-J, Landau H (1992) Fast GPS ambiguity resolution on-the-ﬂy for real-time applications.
In: Proceedings of 6th Int. Geod. Symp. on Satellite Positioning. Columbus, Ohio, pp 17–20
Han S, Rizos C (1995) On-the-ﬂy ambiguity resolution for long range GPS kinematic positioning.
In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG
General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag,
Berlin, pp 290–294
Han S, Rizos C (1997) Comparing GPS ambiguity resolution techniques. GPS World 8(10):54–61
Hofmann-Wellenhof B, Lichtenegger H, Collins J (1997) GPS theory and practice. Springer-Press,
Wien
Jensen A (1999) Inﬂuences of references on precise static/kinematic GPS positioning.
Khan SA (1999) Ocean loading tide effects on GPS positioning. MSc. thesis, Copenhagen
University
Klobuchar JA (1996) Ionospheric effects on GPS. In: Parkinson BW, Spilker JJ (eds) Global
Position-ing System: Theory and applications, Vol. I, Chapter 12
Merbart L (1995) Ambiguity resolution techniques in geodetic and geodynamic applications of the
Global Positioning System. Dissertation an der Philosophisch-naturwissenschaftlichen Fakultät
der Universität Bern
Ramatschi M (1998) Untersuchung von Vertikalbewegungen durch Meeresgezeitenauﬂasten an
Referenzstationen auf Grönland. Dissertation, Technische Universität Clausthal
10.3  Concept of Precise Kinematic Positioning and Flight-State Monitoring
339

Remondi B (1984) Using the Global Positioning System (GPS) phase observable for relative
geodesy: Modelling, processing, and results. University of Texas at Austin, Center for Space
Research.
Schwarz K-P, Cannon ME, Wong RVC (1989) A Comparison of GPS kinematic models for the
determination of position and velocity along a trajectory. Manuscr Geodaet 14:345–353
Syndergaard S (1999) Retrieval analysis and methodologies in atmospheric limb sounding using
the GNSS radio occultation technique. Dissertation, Niels Bohr Institute for Astronomy,
Physics and Geophysics, Faculty of Science, University of Copenhagen
Teunissen P (1995) The least-squares ambiguity decorrelation adjustment: A method for fast GPS
integer ambiguity estimation. J Geodesy 70(1–2):65–82
Wang G, Chen Z, Chen W, Xu G (1988) The principle of GPS precise positioning system.
Surveying Press, Peking, ISBN 7-5030-0141-0/P.58, 345 p, (in Chinese)
Xu
G
(1992)
Spectral
analysis
and
geopotential
determination
(Spektralanalyse
und
Erdschwerefeldbestimmung). Dissertation, DGK, Reihe C, Heft Nr. 397, Press of the Bavarian
Academy of Sciences, ISBN 3–7696–9442–2, 100 p, (with very detailed summary in German)
Xu G (2000) A concept of precise kinematic positioning and ﬂight-state monitoring from the
AGMASCO practice. Earth Planets Space 52(10):831–836
Xu G (2004) MFGsoft – Multi-Functional GPS/(Galileo) Software – Software User Manual,
(Version of 2004), Scientiﬁc Technical Report STR04/17 of GeoForschungsZentrum
(GFZ) Potsdam, ISSN 1610-0956, 70 pages, www.gfz-potsdam.de/bib/pub/str0417/0417.pdf
Xu G, Knudsen P (2000) Earth tide effects on kinematic/static GPS positioning in Denmark and
Greenland. Phys Chem Earth 25(A4):409–414
Xu G, Bastos L, Timmen L (1997a) GPS kinematic positioning in AGMASCO campaigns –
Strategic goals and numerical results. In: Proceedings of ION GPS-97 meeting in Kansas City,
September 16–19, 1997, pp 1173–1184
Xu G, Fritsch J, Hehl K (1997b) Results and conclusions of the carborne gravimetry campaign in
northern Germany. Geodetic Week Berlin ’97, Oct. 6–11, 1997, electronic version published in
http://www.geodesy.tu-berlin.de
Xu G, Schwintzer P, Reigber Ch (1998) KSGSoft – Kinematic/Static GPS Software – Software user
manual (version of 1998). Scientiﬁc Technical Report STR98/19 of GeoForschungsZentrum
(GFZ) Potsdam
340
Chapter 10  Applications of GPS Theory and Algorithms

Chapter 11
Perturbed Orbit and Its Determination
Satellites are attracted not only by the central force of the earth, but also by the
non-central force, the attraction forces of the sun and the moon, and the drag force
of the atmosphere. They are also affected by solar radiation pressure, earth and
ocean tides, general relativity effects (cf. Chap. 5), and coordinate perturbations.
Equations of satellite motion must be represented by perturbed equations. In this
chapter, after discussions of the perturbed equations of motion and the attraction
forces, for convenience of the earth tide and ocean loading tide computations, the
ephemerides of the sun and the moon are described. Orbit correction is discussed
based on an analysis solution of the C20 perturbation. Emphasis is given to the
precise orbit determination, which includes the principle of orbit determination,
algebraic solution of the variation equation, numerical integration, and interpolation
algorithms, as well as the related partial derivatives.
11.1
Perturbed Equation of Satellite Motion
The perturbed equation of motion of the satellite is described by Newton’s second
law in an inertial Cartesian coordinate system as
m€~r ¼~f ;
ð11:1Þ
where ~f is the summated force vector acting on the satellite, and ~r is the radius
vector of the satellite with mass m. €~r is the acceleration. Equation 11.1 is a
second-order differential equation. For convenience, it can be written as two
ﬁrst-order differential equations as
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_11
341

d~r
dt ¼ _~r
d _~r
dt ¼ 1
m
~f :
ð11:2Þ
Denoting the state vector of the satellite as
X! ¼
~r
_~r
 
;
ð11:3Þ
then Eq. 11.2 can be written as
_
X! ¼ F!;
ð11:4Þ
where
F! ¼
_~r
~f =m


:
ð11:5Þ
Equation 11.4 is called the state equation of the satellite motion. Integrating
Eq. 11.4 from t0 to t, one has
X!ðtÞ ¼ X!ðt0Þ þ
Zt
t0
F!dt;
ð11:6Þ
where X!ðtÞ is the instantaneous state vector of the satellite, X!ðt0Þ is the initial state
vector at time t0, and F! is a function of the state vector X!ðtÞ and time t. Denoting
the initial state vector as X!
0, then the perturbed satellite orbit problem turns out to
be a problem of solving the differential state equation under the initial condition as
_
X!ðtÞ ¼ F!
X!ðt0Þ ¼ X!
0
(
:
ð11:7Þ
11.1.1
Lagrangian Perturbed Equation of Satellite Motion
If the force~f includes only the conservative forces, then there is a potential function
V so that
342
Chapter 11  Perturbed Orbit and Its Determination

~f
m ¼ gradV ¼
@ V
@ x
@ V
@ y
@ V
@ z


¼
@ V
@ r
@ V
@u
@ V
@k


;
ð11:8Þ
where (x, y, z) and (r, φ, λ) are Cartesian coordinates and spherical coordinates,
respectively. Denoting R as the disturbance potential, V0 as the potential of the
centred force ~f0, then
R ¼ V  V0;
~f ~f0
m
¼ gradR:
ð11:9Þ
The perturbed Eq. 11.2 of satellite motion in Cartesian coordinates is then
dx
dt ¼ _x
dy
dt ¼ _y
dz
dt ¼ _z
d_x
dt ¼  l
r3 x þ @ R
@ x
d_y
dt ¼  l
r3 y þ @ R
@ y
d_z
dt ¼  l
r3 z þ @ R
@ z ;
ð11:10Þ
where μ is the gravitational constant of the earth. The state vector (~r; _~r) of the
satellite corresponds to an instantaneous Keplerian ellipse (a, e, ω, i, Ω, M). Using
the relationships between the two sets of parameters (cf. Chap. 3), the perturbed
equation of motion 11.10 can be transformed into a so-called Lagrangian perturbed
equation system (cf., e.g., Kaula 1966):
da
dt ¼ 2
na
@ R
@ M
de
dt ¼ 1  e2
na2e
@ R
@ M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@ R
@x
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@ R
@ e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@ R
@ i
di
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
cos i @ R
@x  @ R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@ R
@ i
dM
dt ¼ n  2
na
@ R
@ a  1  e2
na2e
@ R
@ e :
ð11:11Þ
Based on the above equation system, Kaula derived the ﬁrst-order perturbed
analysis solution (cf. Kaula 1966). In the case of a small e(e ≪1), the orbit is
11.1  Perturbed Equation of Satellite Motion
343

nearly circular, so that the perigee and the related Keplerian elements f and ω are
not deﬁned (this is not to be confused with the force vector ~f and true anomaly f).
To overcome this problem, let u = f + ω, and a parameter set of (a, i, Ω, ξ, η, λ) is
used to describe the motion of the satellite, where
n ¼ e cos x
g ¼ e sin x
k ¼ M þ x:
ð11:12Þ
Thus, one has
dn
dt ¼ n
e
de
dt þ g dx
dt
dg
dt ¼ g
e
de
dt  n dx
dt
dk
dt ¼ dM
dt þ dx
dt
ð11:13Þ
and
@R
@x ¼
@R
@ n; g; k
ð
Þ
@ n; g; k
ð
Þ
@x
¼
@R
@ n; g; k
ð
Þ g; n; 1
ð
ÞT¼ g @R
@n  n @R
@g þ @R
@k
@R
@e ¼
@R
@ n; g; k
ð
Þ
@ n; g; k
ð
Þ
@e
¼
@R
@ n; g; k
ð
Þ
n
e ; g
e ; 0

T
¼ n
e
@R
@n þ g
e
@R
@g
@R
@M ¼
@R
@ n; g; k
ð
Þ
@ n; g; k
ð
Þ
@M
¼
@R
@ n; g; k
ð
Þ 0; 0; 1
ð
ÞT¼ @R
@k :
ð11:14Þ
Substituting Eq. 11.14 into Eq. 11.11 and then substituting the second, third,
and sixth equations into Eq. 11.13, one has
da
dt ¼ 2
na
@R
@k
di
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
cos i g @R
@n  n @R
@g þ @R
@k


 @R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
dn
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
@R
@g  g
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ n 1  e2 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e2
@R
@k
dg
dt ¼ 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
@R
@n þ n
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ g 1  e2 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e2
@R
@k
dk
dt ¼ n  2
na
@R
@a 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i  1  e2 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e2
n @R
@n þ g @R
@g


:
ð11:15Þ
344
Chapter 11  Perturbed Orbit and Its Determination

The new variables of Eq. 11.12 do not have clear geometric meanings. An
alternative is to use the Hill variables (cf., e.g., Cui 1990).
11.1.2
Gaussian Perturbed Equation of Satellite Motion
Considering the non-conservative disturbance forces such as solar radiation and air
drag, no potential functions exist for use; therefore, the Lagrangian perturbed
equation of motion cannot be directly used in such a case. The equation of motion
perturbed by non-conservative disturbance force must be derived.
Considering any force vector~f ¼ fx fy fz
	

T in ECSF coordinate system, one has
fx
fy
fz
0
@
1
A ¼ R3ðXÞR1ðiÞR3ðuÞ
fr
fa
fh
0
@
1
A;
ð11:16Þ
where (fr fα fh)T is a force vector with three orthogonal components in an orbital
plane coordinate system, the ﬁrst two components are in the orbital plane, fr is the
radial force component, fα is the force component perpendicular to fr and pointed in
the direction of satellite motion, and fh completes a right-handed system. For
convenience, the force vector may also be represented by tangential, central com-
ponents in the orbital plane (ft, fc) as well as fh (cf. Fig. 11.1). It is obvious that
fr
fa
fh
0
@
1
A ¼ R3ðbÞ
ft
fc
fh
0
@
1
A;
ð11:17Þ
where
tan b ¼ r df
dr ¼ að1  e2Þ
1 þ e cos f
df
að1e2Þ
ð1 þ e cos f Þ2 e sin f df
¼ 1 þ e cos f
e sin f
ð11:18Þ
or
sin b ¼
1 þ e cos f
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ 2e cos f þ e2
p
cos b ¼
e sin f
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ 2e cos f þ e2
p
:
ð11:19Þ
In order to replace the partial derivatives ∂R/∂σ by force components, the
relationships between them must be derived, where σ is a symbol for all Keplerian
elements. Using the regulation of partial derivatives, one has
11.1  Perturbed Equation of Satellite Motion
345

@R
@r ¼ @R
@~r  @~r
@r ¼~f 
@r
@r~er þ r @~er
@r


¼ R3ðXÞR1ðiÞR3ðuÞ
fr
fa
fh
0
B
@
1
C
A 
@r
@r~er þ r @~er
@r


;
ð11:20Þ
where~er is the radial identity vector of the satellite, the dot is the vector dot product,
and
~er ¼
e1
e2
e3
0
B
@
1
C
A ¼ R3ðXÞR1ðiÞR3ðuÞ
1
0
0
0
B
@
1
C
A ¼
cos X cos u  sin X cos i sin u
sin X cos u þ cos X cos i sin u
sin i sin u
0
B
@
1
C
A
@~er
@r ¼
sin X sin i sin u @ i
@r  e2 @X
@r  ðcos X sin u þ sin X cos i cos uÞ @u
@r
 cos X sin i sin u @ i
@r þ e1 @X
@r  ðsin X sin u  cos X cos i cos uÞ @u
@r
cos i sin u @ i
@r þ sin i cos u @u
@r
0
B
@
1
C
A:
ð11:21Þ
Substituting Eq. 11.21 into Eq. 11.20 and simplifying it, one has
@R
@r ¼ @ r
@r fr þ r cos i @X
@r þ @u
@r


fa þ r sin u @ i
@r  sin i cos u @X
@r


fh:
ð11:22Þ
For deriving the partial derivatives of r and u(= f + ω) with respect to the six
Keplerian elements, the following basic relations (cf. Chap. 3) are used
Fig. 11.1 Relation of radial
and tangential forces
346
Chapter 11  Perturbed Orbit and Its Determination

r ¼ að1  e2Þ
1 þ e cosf ¼ að1  e cos EÞ
r cos f ¼ aðcos E  eÞ
r sin f ¼ a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
tan f
2 ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ e
1  e
r
tan E
2
E  e sin E ¼ M;
ð11:23Þ
where E is a function of (e, M), f is a function of (e, E), i.e. (e, M), r is a function of
(a, e, M), and u is a function of (ω, f), i.e. (ω, e, M). Thus,
@E
@ðe; MÞ ¼
a
r sin E; a
r


@f
@ðe; MÞ ¼
2 þ e cos f
1  e2
sin f ; a
r
 2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p


@ r
@M ¼ ae sin E @E
@M ¼ a2e
r sin E ¼
ae
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin f
@ r
@ða; e; i; X; xÞ ¼
r
a ; a cos f ; 0; 0; 0


@u
@e ¼ @u
@f
@f
@e ¼ 2 þ e cos f
1  e2
sin f
@u
@M ¼ @u
@f
@f
@M ¼
a
r
 2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@u
@ða; i; X; xÞ ¼ 0; 0; 0; 1
ð
Þ:
ð11:24Þ
Substituting Eq. 11.24 into Eq. 11.22, one has
@R
@a ¼ r
a fr
@R
@e ¼ a cos f  fr þ r sin f
1  e2 ð2 þ e cos f Þ  fa
@R
@ i ¼ r sin u  fh
@R
@X ¼ cos i  fa  r sin i cos u  fh
@R
@x ¼ r  fa
@R
@M ¼
ae
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin f  fr þ að1 þ e cos f Þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fa:
ð11:25Þ
11.1  Perturbed Equation of Satellite Motion
347

Putting Eq. 11.25 into Lagrangian perturbed equations of motion 11.11, the
so-called Gaussian perturbed equations of motion are then
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

de
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos E þ cos f Þ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dX
dt ¼ ð1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


 cos i dX
dt
dM
dt ¼ n  1  e2
nae
 cos f 
2e
1 þ e cos f


 fr þ 2 þ e cos f
1 þ e cos f sin f  fa


:
ð11:26Þ
The force components of (fr, fα, fh) are used. Using Eq. 11.17, the Gaussian per-
turbed equations of motion can be represented by a disturbed force vector of (ft, fc, fh).
11.2
Perturbation Forces of Satellite Motion
Perturbation forces of satellite motion will be discussed in this section. These are
the gravitational forces of the earth, the attraction forces of the sun, the moon, and
the planets, the drag force of the atmosphere, solar radiation pressure, and earth and
ocean tides, as well as coordinate perturbations.
11.2.1
Perturbation of the Earth’s Gravitational Field
After a brief review of the earth’s gravitational ﬁeld, the perturbation force of the
earth will be outlined here.
11.2.1.1
The Earth’s Gravitational Field
The complete real solution of the Laplace equation is called potential function V of the
earth. In spherical coordinates, V can be expressed by Moritz (1980), Sigl (1989):
348
Chapter 11  Perturbed Orbit and Its Determination

V ¼
X
lmi
1
rl þ 1Vlmi ¼
X
1
l¼0
X
l
m¼0
1
rl þ 1 Plmðsin uÞ½Clm cos mk þ Slm sin mk;
ð11:27Þ
where r is the radius, φ is the latitude, and λ is the longitude measured eastward
(counterclockwise looking toward the origin from the positive end of the z-axis).
One can, of course, use the co-latitude ϑ (or polar distance) instead of the latitude φ
(sin φ = cos ϑ). The subscript i in the ﬁrst term denotes the cos mλ or sin mλ term.
Plm(sin φ) is the so-called associated Legendre function, Vlmi denotes surface
spherical harmonics, Clm, Slm are coefﬁcients of the spherical functions, and
Plmðsin uÞ ¼ cosm u
X
k
t¼0
Tlmt sinlm2t u;
ð11:28Þ
where k is the integer part of (l −m)/2, and
Tlmt ¼
ð1Þtð2l  2tÞ!
2lt!ðl  tÞ!ðl  m  2tÞ! :
ð11:29Þ
An important property of surface spherical harmonics Vlmi is that they are
orthogonal. Namely, for the integration over the surface of a sphere, there is
(Heiskanen and Moritz 1967; Kaula 1966)
Z
sphere
VLMIVlmidr ¼ 0;
if L 6¼ l
or M 6¼ m
or I 6¼ i:
ð11:30Þ
The integral of the square of Vlmi for Clm = 1 or Slm = 1 is
Z
sphere
V2
lmidr ¼
ðl þ mÞ!
ðl  mÞ!ð2l þ 1Þð2  d0mÞ


4p;
ð11:31Þ
where the Kronecker delta δ0m is equal to 1 for m = 0 and 0 for m ≠0.
The normalised Legendre functions can be deﬁned and denoted by
PlmðxÞ ¼ PlmðxÞ ðl  mÞ!ð2l þ 1Þð2  d0mÞ
ðl þ mÞ!

1=2
;
ð11:32Þ
where x = sin φ = cos ϑ. Recurrence formulae can be easily derived (Wenzel
1985):
11.2  Perturbation Forces of Satellite Motion
349

Pðl þ 1Þðl þ 1ÞðxÞ ¼ PllðxÞ
ð2l þ 3Þ
ðl þ 1Þð2  d0lÞ

1=2
ð1  x2Þ1=2;
Pðl þ 1ÞlðxÞ ¼ PllðxÞ 2l þ 3
½
1=2x
l  1;
Pðl þ 1ÞmðxÞ ¼ PlmðxÞ
ð2l þ 1Þð2l þ 3Þ
ðl þ m þ 1Þðl  m þ 1Þ

1=2
x
 Pðl1ÞmðxÞ
ðl þ mÞðl  mÞð2l þ 3Þ
ðl þ m þ 1Þðl  m þ 1Þð2l  1Þ

1=2
; and
P00ðxÞ ¼ 1;
P10ðxÞ ¼
ﬃﬃﬃ
3
p
x;
P11ðxÞ ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
3ð1  x2Þ
p
:
ð11:33Þ
Since the ﬁrst term of V (i.e. l = 0) is represented by GM/r, the fully normalised
geopotential function is taken as follows (Torge 1989; Rapp 1986):
Vðr; u; kÞ ¼ GM
r
1 þ
X
1
l¼2
X
l
m¼0
a
r
 
P
l
lmðsin uÞ½Clm cos mk þ Slm sin mk
"
#
; ð11:34Þ
where GM is the geocentric gravitational constant, Clm; Slm are normalised coefﬁ-
cients and a is the mean equatorial radius of the earth. The ﬁrst term of V is the
potential of the central force of the earth. The perturbation potential of the earth is
then (denoting GM = μ)
Rgeoðr; u; kÞ ¼ l
r
X
1
l¼2
X
l
m¼0
a
r
 
P
l
lmðsin uÞ Clm cos mk þ Slm sin mk


:
ð11:35Þ
For any initial external potential of the earth
Uðr; u; kÞ ¼ l
r
1 þ
X
L
l¼2
X
l
m¼0
a
r
 
P
l
lmðsin uÞ C
N
lm cos mk þ S
N
lm sin mk
h
i
"
#
;
ð11:36Þ
the disturbing potential T is then
T ¼ V  U ¼ l
r
X
1
l¼2
X
l
m¼0
a
r
 
P
l
lmðsin uÞ½DClm cos mk þ DSlm sin mk
"
#
;
ð11:37Þ
where C
N
lm; S
N
lm are known normalised coefﬁcients of the disturbing potential and
Clm ¼ DClm  C
N
lm; Slm ¼ DSlm  S
N
lm; ðl  LÞ:
ð11:38Þ
350
Chapter 11  Perturbed Orbit and Its Determination

11.2.1.2
Perturbation Force of the Earth’s Gravitational Field
Denoting (x′, y′, z′) as three orthogonal Cartesian coordinates in ECEF system, then
the force vector is
~fECEF ¼
@V
@x0
@V
@y0
@V
@z0
0
B
@
1
C
A ¼
@V
@ðr;u;kÞ
@ðr;u;kÞ
@x0
@V
@ðr;u;kÞ
@ðr;u;kÞ
@y0
@V
@ðr;u;kÞ
@ðr;u;kÞ
@z0
0
B
B
@
1
C
C
A ¼
@V
@ðr; u; kÞ
@ðr; u; kÞ
@ðx0; y0; z0Þ

T
:
ð11:39Þ
From the relation between the Cartesian and spherical coordinates
x0
y0
z0
0
@
1
A ¼
r cos u cos k
r cos u sin k
r sin u
0
@
1
A;
r ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x02 þ y02 þ z02
p
u ¼ tan1
z0
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x02 þ y02
p
k ¼ tan1 y0
x0
0
B
@
1
C
A;
ð11:40Þ
one has
@ðr; u; kÞ
@ðx0; y0; z0Þ ¼
cos u cos k
cos u sin k
sin u
 1
r sin u cos k
 1
r sin u sin k
1
r cos u

1
r cos u sin k
1
r cos u cos k
0
0
@
1
A:
ð11:41Þ
For differentiations of the associated Legendre function, from Eq. 11.33, one has
similar recurrence formulae:
dP00ðsin uÞ
du
¼ 0;
dP10ðsin uÞ
du
¼
ﬃﬃﬃ
3
p
cos u;
dP11ðsin uÞ
du
¼ 
ﬃﬃﬃ
3
p
sin u;
dPðl þ 1Þðl þ 1Þðsin uÞ
du
¼ q sin uPllðsin uÞ þ q cos u dPllðsin uÞ
du
;
q ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2l þ 3
2l þ 2
r
;
l  1;
dPðl þ 1Þlðsin uÞ
du
¼ g cos uPllðsin uÞ þ g sin u dPllðsin uÞ
du
;
l  1;
g ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
2l þ 3
p
;
dPðl þ 1Þmðsin uÞ
du
¼ h cos uPlmðsin uÞ þ h sin u dPlmðsin uÞ
du
 k dPðl1Þmðsin uÞ
du
;
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ð2l þ 1Þð2l þ 3Þ
ðl þ m þ 1Þðl  m þ 1Þ
s
;
k ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
ðl þ mÞðl  mÞð2l þ 3Þ
ðl þ m þ 1Þðl  m þ 1Þð2l  1Þ
s
ð11:42Þ
11.2  Perturbation Forces of Satellite Motion
351

and
d2P00ðsin uÞ
du2
¼ 0;
d2P10ðsin uÞ
du2
¼ 
ﬃﬃﬃ
3
p
sin u;
d2P11ðsin uÞ
du2
¼ 
ﬃﬃﬃ
3
p
cos u;
d2Pðl þ 1Þðl þ 1Þðsin uÞ
du2
¼ q cos uPllðsin uÞ  2q sin u dPllðsin uÞ
du
þ q cos u d2Pllðsin uÞ
du2
;
d2Pðl þ 1Þlðsin uÞ
du2
¼ g sin uPllðsin uÞ þ 2g cos u dPllðsin uÞ
du
þ g sin u d2Pllðsin uÞ
du2
;
l  1;
d2Pðl þ 1Þmðsin uÞ
du2
¼ h sin uPlmðsin uÞ þ 2h cos u dPlmðsin uÞ
du
þ h sin u d2Plmðsin uÞ
du2
 k d2Pðl1Þmðsin uÞ
du2
:
ð11:43Þ
The partial derivatives of the potential function with respect to the spherical
coordinates are
@V
@r ¼  l
r2 1 þ
X
1
l¼2
X
l
m¼0
ðl þ 1Þ a
r
 l
Plmðsin uÞ Clm cos mk þ Slm sin mk


"
#
@V
@u ¼ l
r
X
1
l¼2
X
l
m¼0
a
r
 ldPlmðsin uÞ
du
Clm cos mk þ Slm sin mk


@V
@k ¼ l
r
X
1
l¼2
X
l
m¼0
m a
r
 l
Plmðsin uÞ Clm sin mk þ Slm cos mk


:
ð11:44Þ
Using the transformation formula of Eq. 2.14, the perturbation force of the
earth’s gravitational ﬁeld in the ECSF system is then
~fECSF ¼ R1
P R1
N R1
S R1
M ~fECEF:
ð11:45Þ
The computation process of disturbance force of the earth’s gravitational ﬁeld in
the ECSF coordinate system may be carried out as follows:
1. Using Eq. 2.14 to transform the satellite coordinates in the ECSF system to the
ECEF system;
2. Using Eq. 11.40 to compute the spherical coordinates of the satellite in the
ECEF system;
352
Chapter 11  Perturbed Orbit and Its Determination

3. Using Eq. 11.39 to compute the force vector in the ECEF system;
4. Using Eq. 11.45 to transform the force vector to the ECSF system.
11.2.2
Perturbations of the Sun, the Moon, and the Planets
The equations of motion of two point-masses M and m under their mutual action
can be given by
M€~rM ¼ GMm~rMm
r3
Mm
and
m€~rm ¼ GMm~rmM
r3
mM
;
ð11:46Þ
where r is the length of the vector ~r, index Mm means the vector is pointing from
point-mass M to m, and single index M or m means the vector is pointing to
point-mass M or m. Introducing additional point-masses m(j), j = 1, 2, …, the
attractions of m(j) on M and m can be given as equations similar to Eq. 11.46, and
the total attractions may be obtained by summations
M€~rM ¼ GMm~rMm
r3
Mm
þ
X
j
GMmðjÞ~rMmðjÞ
r3
MmðjÞ
m€~rm ¼ GMm~rmM
r3
mM
þ
X
j
GmmðjÞ~rmmðjÞ
r3
mmðjÞ
:
ð11:47Þ
By dividing the above two equations with −M and m, respectively, then adding
them together, one has
€~rm  €~rM ¼ GðM þ mÞ~rMm
r3
mM
þ
X
j
GmðjÞ ~rmmðjÞ
r3
mmðjÞ
~rMmðjÞ
r3
MmðjÞ
"
#
:
ð11:48Þ
Letting ~r ¼~rm ~rM, i.e. using the point-mass M as the origin, substituting
~rmmðjÞ ¼ ð~rm ~rmðjÞÞ in the right side of Eq. 11.48 and omitting the mass m (mass
of satellite), one has
€~r ¼ GM ~r
r3 
X
j
GmðjÞ
~r ~rmðjÞ
~r ~rmðjÞ

3 þ ~rmðjÞ
r3
mðjÞ
"
#
:
ð11:49Þ
It is obvious that the ﬁrst term on the right side is the central force of the earth;
therefore, the disturbance forces of multiple point-masses acting on the satellite are
then
11.2  Perturbation Forces of Satellite Motion
353

~fm ¼ m
X
j
GmðjÞ
~r ~rmðjÞ
~r ~rmðjÞ

3 þ ~rmðjÞ
r3
mðjÞ
"
#
;
ð11:50Þ
where Gm(j) are the gravitational constants of the sun and the moon as well as the
planets.
11.2.3
Earth Tide and Ocean Tide Perturbations
As discussed in Sect. 5.4, the tidal potential generated by the moon and the sun can
be written as
WP ¼
X
2
j¼1
lj
X
1
n¼2
qn
rn þ 1
j
Pnðcos zjÞ
or
WP ¼
X
2
j¼1
lj
X
1
n¼2
qn
rn þ 1
j
Pnðsin uÞPnðsin djÞ
þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin djÞ cos khj
2
64
3
75;
ð11:51Þ
where j is the index of the moon (j = 1) and the sun (j = 2), μj is the gravitational
constant of body j, ρ is the geocentric distance of the earth’s surface (set as ae), rj is
the geocentric distance of the body j, Pn(x) and Pnk(x) are the Legendre function and
associated Legendre function, zj is the zenith distance of the body j, δj and hj are the
declination and local hour angle of body j, hj = Hj −λ, and Hj is the hour angle of
j. The tidal deformation of the earth caused by the tidal potential can be considered
a tidal deformation potential acting on the satellite by Dirichlet’s theorem (Melchior
1978; Dow 1988):
dV ¼
X
2
j¼1
lj
X
1
n¼2
kn
q
r
 n þ 1 qn
rn þ 1
j
Pnðcos zjÞ
or
dV ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
Pnðsin uÞPnðsin djÞ
þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin djÞ cos khj
2
64
3
75;
ð11:52Þ
354
Chapter 11  Perturbed Orbit and Its Determination

where kn is the Love number, (r, φ, λ) is the spherical coordinate of the satellite in
the ECEF system, and N is the truncating number. The recurrence formulas of the
Legendre function are (cf., e.g., Xu 1992)
ðn þ 1ÞPn þ 1ðxÞ ¼ ð2n þ 1ÞxPnðxÞ  nPn1ðxÞ
ð1  x2Þ dPnðxÞ
dx
¼ nPn1ðxÞ  nxPnðxÞ
P0ðxÞ ¼ 1 P1ðxÞ ¼ x:
ð11:53Þ
The disturbing force vector of the tidal potential in the ECEF coordinate system
is then
~fECEF ¼
@dV
@x0
@dV
@y0
@dV
@z0
0
B
@
1
C
A ¼
@dV
@ðr;u;kÞ
@ðr;u;kÞ
@x0
@dV
@ðr;u;kÞ
@ðr;u;kÞ
@y0
@dV
@ðr;u;kÞ
@ðr;u;kÞ
@z0
0
B
B
@
1
C
C
A ¼
@dV
@ðr; u; kÞ
@ðr; u; kÞ
@ðx0; y0; z0Þ

T
;
ð11:54Þ
where
@dV
@r ¼
X
2
j¼1
lj
X
N
n¼2
kn
ðn þ 1Þa2n þ 1
e
rn þ 2rn þ 1
j
Pnðsin uÞPnðsin djÞ
þ 2 P
n
k¼1
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin djÞ cos khj
2
4
3
5;
@dV
@u ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
n
cos u ðPn1ðsin uÞ  sin uPnðsin uÞÞPnðsin djÞ
þ 2 P
n
k¼1
ðnkÞ!
ðn þ kÞ! ðPnðk þ 1Þðsin uÞ  k tan uPnkðsin uÞÞ
Pnkðsin djÞ cos khj
2
6664
3
7775
and
@dV
@k ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! kPnkðsin uÞPnkðsin djÞ sin khj
"
#
:
ð11:55Þ
Other partial derivatives in Eq. 11.54 were given in Sect. 11.2.1. The transfor-
mation of the force vector from the ECEF to the ECSF coordinate system can be
done by Eq. 11.45.
As discussed in Sect. 5.4, the ocean tidal potential generated by tide element
σHds can be written as
GrHds
r0
or
GrHds
X
1
n¼0
an
e
rn þ 1 Pnðcos zÞ;
ð11:56Þ
11.2  Perturbation Forces of Satellite Motion
355

where H is the ocean tide height of the area ds, G is the gravitational constant, σ is
the water density, r′ is the distance between the satellite and the water element ds,
r is the geocentric distance of the satellite, z is the zenith distance of the ds, and ae is
the radius of the earth. Using the spherical triangle
cos z ¼ sin u sin us þ cos u cos us cosðks  kÞ;
where (φs, λs) is the spherical coordinate of ds and (r, φ, λ) is the spherical coor-
dinate of satellite in the ECEF system, Eq. 11.56 turns out to be (denoted by Q)
Q ¼ GrHds
X
1
n¼0
an
e
rn þ 1
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
4
3
5:
ð11:57Þ
The direct ocean tide potential is then the integration of Q/ds over the ocean
(denotes by O), including the potential of the deformation of the ocean loading. The
ocean tide potential is then
dV1 ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
4
3
5ds;
ð11:58Þ
where k0
n is the ocean loading Love number. Equation 11.58 does not include the
potential changing due to the loading deformation over the continents, which may
give a non-negligible contribution to the orbit motion of the satellite (cf. Knudsen
et al. 2000). Recalling the discussion in Sect. 5.4, the loading deformation gener-
ated by the ocean tide can be represented as
urðu; kÞ ¼
ZZ

ocean
rHuðzÞds
and
uðzÞ ¼
aeh0
1
2M sinðz=2Þ þ ae
M
X
N
n¼0
ðh0
n  h0
1ÞPnðcos zÞ;
ð11:59Þ
where ae is the radius of the earth, M is the mass of the earth, z is the geocentric
zenith distance of the loading point (related to the computing point, see Fig. 5.11),
Pn(cos z) is the Legendre function, u(z) is the radial loading displacement Green’s
function, h0
n is the loading Love number of order n, and ur is the radial loading
deformation. Substituting ur for H in Eq. 11.57 and integrating Q/ds over the
continents (denoted by C), the potential of the loading deformation is then
356
Chapter 11  Perturbed Orbit and Its Determination

dV2 ¼
ZZ

C
Greur
X
1
n¼0
an
e
rn þ 1
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ

X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
64
3
75ds;
ð11:60Þ
where σe is the density of the mass ur ds on the earth’s surface. The total ocean tide
potential disturbance is the summation of Eqs. 11.58 and 11.60. Similar to above,
the disturbing force can be derived and transformed to the ECSF system. There are
~fECEF ¼
@ðdV1 þ dV2Þ
@x0
@ðdV1 þ dV2Þ
@y0
@ðdV1 þ dV2Þ
@z0
0
B
B
B
B
B
@
1
C
C
C
C
C
A
¼
@ðdV1 þ dV2Þ
@ðr; u; kÞ
@ðr; u; kÞ
@ðx0; y0; z0Þ

T
;
ð11:61Þ
where
@dV1
@r
¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ ðn þ 1Þan
e
rn þ 2
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
4
3
5ds;
@dV1
@u ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
dPnðsin uÞ
du
Pnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞ cos kðks  kÞ
2
664
3
775ds;
@dV1
@k ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk sin kðks  kÞ
2
4
3
5ds;
@dV2
@ r
¼
ZZ

C
Greus
X
1
n¼0
ðn þ 1Þan
e
rn þ 2
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
4
3
5ds;
@dV2
@u ¼
ZZ

C
Greus
X
1
n¼0
an
e
rn þ 1
dPnðsin uÞ
du
Pnðsin usÞ þ ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞ cos kðks  kÞ
2
664
3
775ds
and
@dV2
@k ¼
ZZ

C
Greus
X
1
n¼0
an
e
rn þ 1
ð2  d0nÞ
 P
n
k¼0
ðnkÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk sin kðks  kÞ
2
4
3
5ds:
ð11:62Þ
11.2  Perturbation Forces of Satellite Motion
357

11.2.4
Solar Radiation Pressure
Solar radiation pressure is force acting on the satellite’s surface caused by the
sunlight. The radiation force can be represented as (cf., e.g., Seeber 1993)
~fsolar ¼ mcPsCrr2
sun
S
m
~r ~rsun
~r ~rsun
j
j3 ;
ð11:63Þ
where γ is the shadow factor, Ps is the luminosity of the Sun, Cr is the surface
reﬂectivity, rsun is the geocentric distance of the sun, (S/m) is the surface to mass
ratio of the satellite, and~r and~rsum are the geocentric vector of the satellite and the
sun. Usually, Ps has the value of 4.5605 × 10−6 N/m, Cr has values from 1 to 2, 1 is
for the complete absorption of the sunlight, and for aluminium, Cr = 1.95.
The shadow factor is deﬁned as
c ¼ 1  Ass
As
;
ð11:64Þ
where As is the sight surface of the sun viewed from the satellite, and Ass is the
shadowed sight surface of the sun. The sunlight may be shadowed by the earth and
the moon. For convenience, we will discuss both parameters that are only in the
satellite-earth-sun system (cf. Fig. 11.2). It is obvious that the half sight angles of
the earth and the moon as well as the sun viewed from the satellite are
ae ¼ sin1
ae
~rj j


am ¼ sin1
am
~rm ~r
j
j


as ¼ sin1
as
~rs ~r
j
j


;
ð11:65Þ
Fig. 11.2 Satellite-Earth-Sun system
358
Chapter 11  Perturbed Orbit and Its Determination

where ae, as and am are semi-major radii of the earth, sun, and moon, respectively;
am = 0.272493 ae, and as = 959.63 π/(3600 × 180) (AU). For the GPS satellite,
αs < 0.3°, αe ≈16.5° and αm ≈αs ± 0.03°. Furthermore, As ¼ a2
sp and Am ¼ a2
mp.
The angles between the centre of the earth and the sun, as well as the centre of the
moon and the sun are
bes ¼ cos1 ~r  ð~rs ~rÞ
r ~rs ~r
j
j


bms ¼ cos1 ð~rm ~rÞ  ð~rs ~rÞ
~rm ~r
j
j  ~rs ~r
j
j


;
ð11:66Þ
where the vectors with indices s and m are the geocentric vectors of the sun and
moon, respectively. The vector without an index is the geocentric vector of the
satellite, and r ¼ _r
*

. If βes ≥αe + αs, then the satellite is not in the shadow of the
earth (i.e. Ass = 0). If βes ≥αe −αs, then the sun is not in view of the satellite (i.e.
Ass = As). If αe −αs < βes < αe + αs, then the sunlight is partly shadowed by the
earth. The formula of the shadowed surface can be derived as follows (cf.
Fig. 11.3). The two circles with radius αe and αs cut each other at point p and q, line
p q is called a chord (denoted by 2a), the chord-related central angle at origin os is
denoted by ϕ1, the surface area between the chord and the arc of the circle αs on the
right side of the chord is denoted by A1. Line p q cuts Os Oe at point g, while Os g
and g Oe are denoted by b and b1. Then one has
a2 ¼ a2
s  b2;
b1 ¼ a2
e þ b2
es  a2
s
2bes
b ¼
bes  b1
if
b1  ae
b1  bes
if
b1 [ ae

/1 ¼
2 cos1
b
as
 
if
b1  ae
2p  2 cos1
b
as
 
if
b1 [ ae
8
>
<
>
:
A1 ¼
1
2 /1a2
s  ab
if
b1  ae
1
2 /1a2
s þ ab
if
b1 [ ae
(
:
ð11:67Þ
Similarly, the chord-related central angle at origin oe is denoted by ϕ2, while the
surface area between the chord and the arc of the circle αe on the left side of chord is
denoted by A2. Then one has
/2 ¼ 2 cos1 b1
ae


;
A2 ¼ 1
2 /2a2
e  ab1
ð11:68Þ
11.2  Perturbation Forces of Satellite Motion
359

and
c ¼ 1  A1 þ A2
a2
sp
:
ð11:69Þ
A similar discussion can be made for the moon. If βms ≥αm + αs, then the
satellite is not in the shadow of the moon, i.e. Ass = 0. If βms ≥αm −αs, then the
full shadow has occurred, i.e. Ass = min(As, Am). If |αm −αs| < βms < αm + αs, then
the sunlight is partially shadowed by the moon. The formula of the shadowed
surface can be similarly derived by changing the index e to m in Eqs. 11.67 and
11.68. Because of the small sight angle of the moon viewed from the satellite, the
shadowed time will be very short if it happens. By GPS satellite dynamic orbit
determination (e.g., in IGS orbit determination), only the data that have the γ value
of 0 or 1 are used.
Because of the complex shape of the satellite, the use of constant reﬂectivity and
homogenous luminosity of the sun, as well as the existence of indirect solar radi-
ation (reﬂected from the earth’s surface), the model of Eq. 11.63 discussed above is
not accurate enough for precise purposes and will be used as a ﬁrst-order
approximation. A further model for the adjustment to ﬁt solar radiation effects is
needed.
The force vector is pointed from the sun to the satellite. The satellite ﬁxed
coordinate system is introduced in Sect. 5.8 (cf. Sect. 5.8 for details). The solar
radiation force vector in the ECSF system is then
~fsolar ¼ mcPsCr
S
m
r2
sun
~r ~rsun
j
j2~nsun
¼ mcPsCr
S
m
r2
sun
~r ~rsun
j
j2 sin b ~ex þ cos b ~ez
ð
Þ;
ð11:70Þ
Fig. 11.3
Shadowed surface
area
360
Chapter 11  Perturbed Orbit and Its Determination

where
~ez ¼  ~r
~rj j ;
~ey ¼ ~ez ~nsun
~ez ~nsun
j
j ;
~ex ¼~ey ~ez
and
~nsun ¼ ~r ~rsun
~r ~rsun
j
j :
ð11:71Þ
Further formulas of Eq. 11.71 can be found in Sect. 5.8. Taking the remaining
error of the radiation pressure into account, the solar radiation force model can be
represented as (cf. Fliegel et al. 1992; Beutler et al. 1994)
~fsolarforce ¼~fsolar þ
a11
a12
a13
a21
a22
a23
a31
a32
a33
0
@
1
A
1
cos u
sin u
0
@
1
A:
ð11:72Þ
That is, nine parameters are used to model the solar radiation force error for
every satellite.
An alternative adjustment model of solar radiation is given by introducing a
so-called disturbance coordinate system and will be outlined below (cf. Xu 2004).
Disturbance Coordinate System and Radiation Error Model
The solar radiation force vector is pointed from the sun to the satellite. If the
shadow factor is computed exactly, the luminosity of the sun is a constant, and the
surface reﬂectivity of the satellite is a constant, then the length of the solar force
vector can be considered as a constant, because
r2
sun
ðrsun þ rÞ2 
r2
sun
~r ~rsun
j
j2 
r2
sun
ðrsun  rÞ2 ;
ð11:73Þ
and
r2
sun
ðrsun 	 rÞ2 ¼
rsun
rsun 	 r

2

1  r
rsun
	 . . .

2

 1  2r
rsun

 1  3  105:
Any bias error in Ps, Cr and (S/m) may cause a model error of a~fsolar, where α is a
parameter. So the a~fsolar can be considered a main error model of the solar radiation.
Because the ratio of the geocentric distances of the satellite and the sun is so small,
the direction and distance changes of the sun-satellite vector are negligible. With
the motion of the sun, the solar radiation force vector changes its direction with the
time in the ECSF (Earth-Centred-Space-Fixed) coordinate system ca. 1° per day.
Such an effect can only be considered a small drift, not a periodical change for the
orbit determination. To model such an effect in the ECSF system, one needs three
bias parameters in three coordinate axes and three drift terms instead of a few
periodical parameters. It is obvious that to model this effect in the direction of ~n,
just one parameter α is needed. Therefore, it is very advantageous to deﬁne a
so-called disturbance coordinate system as follows: the origin is the geo-centre, and
11.2  Perturbation Forces of Satellite Motion
361

the three axes are deﬁned by ~r (radial vector of the satellite), ~n (the sun-satellite
identity vector), and ~p (the atmospheric drag identity vector). These three axes are
always in the main disturbance directions of the indirect solar radiation (reﬂected
from the earth’s surface), direct solar radiation and atmospheric drag, respectively.
This coordinate system is not a Cartesian one and the axes are not orthogonal to
each other. The parameters in individual axes are mainly used to model the related
disturbance effects, and meanwhile to absorb the remained error of other
un-modelled effects.
In the so-called disturbance coordinate system, the solar radiation pressure error
model can be represented alternatively by (cf. Xu 2004)
a~fsolar ¼
a1
b1
a2
b2
a3
b3
0
@
1
A
1
t


;
ð11:74Þ
where b-terms are very small. Equation 11.74 can be called Xu’s adjustment model
of solar radiation.
11.2.5
Atmospheric Drag
Atmospheric drag is the disturbance force acting on the satellite’s surface caused by
the air. Air drag force can be represented as (cf., e.g., Seeber 1993; Liu and Zhao
1979)
~fdrag ¼ m 1
2
CdS
m


r _~r  _~rair

 _~r  _~rair


;
ð11:75Þ
where S is the cross section (or effective area) of the satellite, Cd is the drag factor,
m is the mass of the satellite, _~r and _~rair are the geocentric velocity vectors of the
satellite and the atmosphere, and σ is the density of the atmosphere. Usually, S has a
value of one-fourth of the outer surface area of the satellite, and Cd has labour
values of 2.2 ± 0.2. The velocity vector of the atmosphere can be modelled by
_~rair ¼ k~x ~r ¼ kx
y
x
0
0
@
1
A;
ð11:76Þ
where x
! is the angular velocity vector of the earth’s rotation, and ω = |x
!|, k is the
atmospheric rotation factor. For the lower layer of the atmosphere, k = 1, i.e. the
lower layer of the atmosphere is considered to rotate with the earth. For the higher
362
Chapter 11  Perturbed Orbit and Its Determination

layer, k = 1.2, because the higher ionosphere is accelerated by the earth’s magnetic
ﬁeld.
Gravity balanced atmospheric density model has the exponential form of (cf. Liu
and Zhao 1979)
r ¼ r0ð1 þ qÞ exp  r  q
H


;
ð11:77Þ
where σ0 is the atmospheric density at the reference point ρ, q is the daily change
factor of the density, r is the geocentric distance of the satellite, and H is the
density-height scale factor. For the spherical and rotating ellipsoidal layer atmo-
spheric models, one has
q ¼ ae þ hi
ð11:78Þ
and
q ¼ ðae þ hiÞ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ tan2 u
1 þ tan2 u  e2
s
;
ð11:79Þ
respectively. Where ae is the semi-major radius of the earth, hi(i = 1, 2, …) is a set
of numbers, φ is the geocentric latitude of the satellite, and e is the eccentricity of
the ellipsoid. Equations 11.78 and 11.79 are sphere with radius ae + hi and rotating
ellipsoid with semi-major axis ae + hi. Equation 11.79 can be derived from the
relation of tan φ and the ellipsoid equation
z2 ¼ ðx2 þ y2Þ tan2 u
x2 þ y2 þ z2
1
1  e2 ¼ ðae þ hiÞ2:
A reference of atmospheric densities can be read from Table 11.1, which is
given by Cappellari (1976) (cf. Seeber 1993).
The density-height scale H between every two layers can then be computed from
the above values. It is notable that the air density may change its value up to a factor
of 10 due to the radiation of the sun. The density of the atmosphere at a deﬁned
Table 11.1 Reference of
atmospheric densities
hi (in km)
σ0(i) (in
g/km3)
hi (in km)
σ0(i) (in
g/km3)
100
497400
600
0.08–0.64
200
255–316
700
0.02–0.22
300
17–35
800
0.07–0.01
400
2.2–7.5
900
0.003–0.04
500
0.4–2.0
1000
0.001–0.02
11.2  Perturbation Forces of Satellite Motion
363

point reaches its maximum value at 14 h local time and its minimum at 3.5 h. The
most signiﬁcant period of change is the daily change, and is represented by the daily
change factor as
q ¼ f  1
f þ 1 cos w;
ð11:80Þ
where f is the ratio of the maximum density and the minimum density, and ψ is the
angle between the satellite vector ~r and the daily maximum density direction ~rðmÞ.
The f may have the value of 3 and
cos w ¼ ~r ~rm
~rj j  ~rm
j
j ;
ð11:81Þ
where
x
y
z
0
B
@
1
C
A
sun
¼
r cos d cos a
r cos d sin a
r sin d
0
B
@
1
C
A;
r ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2 þ z2
p
d ¼ tan1
zﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
x2 þ y2
p
a ¼ tan1 y
x
0
B
B
@
1
C
C
A
~rm ¼
x
y
z
0
B
@
1
C
A
m
¼
r cos d cosða þ p=6Þ
r cos d sinða þ p=6Þ
r sin d
0
B
@
1
C
A;
ð11:82Þ
where (α, δ) are the coordinates (right ascension, latitude) of the sun in the ECSF
coordinate system.
Taking the remaining error of the atmospheric drag into account, the air drag
force model can be represented as
~fairdrag ¼~fdrag þ ð1 þ qÞD~fdrag:
ð11:83Þ
Where the force error vector is denoted by D~fdrag and the time variation part of
atmospheric density is considered in parameter q.
Error Model in Disturbance Coordinate System
In the atmospheric drag model Eq. 11.75, the velocity vector of the atmosphere
is always perpendicular to the z-axis of the ECSF coordinates and the satellite
velocity vector is always in the tangential direction of the orbit. The variation of the
term
_~r  _~rair

 (denoted by g) is dominated by the direction changes of the velocity
vectors of the satellite and the atmosphere. Any bias error in S (effective area of the
satellite), Cd (drag factor), and σ (density of the atmosphere) may cause a model
error of l~fdrag, where μ is a parameter. So the l~fdrag can be considered a main error
model of the un-modelled atmospheric drag. To simplify our discussion, we
364
Chapter 11  Perturbed Orbit and Its Determination

consider that the velocities of the satellite and atmosphere are constants, and call the
satellite positions with max(z) and -max(z) the highest and lowest points, respec-
tively. With the satellite at the lowest point, the two velocity vectors are in the same
direction, and therefore the g reaches the minimum. At the ascending node, the two
vectors have the maximum angle of inclination i and the g reaches the maximum.
Then g reaches the minimum again at the highest point and reaches the maximum
again at the descending node, and at the end reaches the minimum at the lowest
point. It is obvious that, in addition to the constant part, g has a dominant periodical
component of cos 2f and sin 2f, where f is the true anomaly of the satellite.
In the so-called disturbance coordinate system, the atmospheric drag error model
can be represented alternatively by (cf. Xu 2004)
l~fdrag ¼ a þ buð2xÞ cosð2f Þ þ cuð3xÞ cosð3f Þ þ duðxÞ cos f
½
~p;
ð11:84Þ
where
uðkxÞ ¼
sin kx
if cos kx ¼ 0
1
cos kx
if cos kx 6¼ 0

;
k ¼ 1; 2; 3
ð11:85Þ
where ω is the angle of perigee and f is the true anomaly of the satellite, and a, b, c,
and d are model parameters to be determined. According to the simulation, the a-
term and b-term are the most signiﬁcant terms. The amount of d is just about 1 % of
the amount of c, and the amount of c is about 1 % of that of b. Equation 11.84 can
be called Xu’s adjustment model for atmospheric drag error.
11.2.6
Additional Perturbations
As mentioned above, the disturbed equation of motion of the satellite is valid only
in an inertial coordinate system, or ECSF system. Therefore, the state vector and
force vectors as well as the disturbing potential function have also to be represented
in the ECSF system. As seen above, for some reason, the state vector and the force
vectors as well as the disturbing potential function R are sometimes given in the
ECEF system and then transformed to the ECSF system by (cf. Sect. 11.2.4)
X!
ECSF ¼ Rt  X!
ECEF
~fECSF ¼ Rt ~fECEF
RECSF ¼ RðR1
t XECSFÞ
for
RðXECEFÞ;
ð11:86Þ
where Rt is the transformation matrix in general. Variable transformation is further
denoted by XECSF = RtXECEF. We have also seen that sometimes the state vectors
11.2  Perturbation Forces of Satellite Motion
365

(of the satellite, the sun, the moon) in the ECSF system must be transformed to the
ECEF system for use, and then the result vectors will be transformed back to the
ECSF system again. However, due to the complication of transformation R1
t , quite
often a simpliﬁed R1
s is used. (cf. in later discussions, for example to represent the
disturbing potential function using Keplerian elements, only the earth rotation is
considered). Thus,
RECSF ¼ fRðR1
t XECSFÞ  RðR1
s XECSFÞg þ RðR1
s XECSFÞ;
ð11:87Þ
where the ﬁrst term on the right side is the correction because of the approximation
using the second term. The transformations of Eqs. 11.86 and 11.87 are exact
operations, and their differentiation with respect to time t and the partial derivatives
with respect to variable XECSF are then
dX!
ECSF
dt
¼ dRt
dt X!
ECEF þ Rt
dX!
ECEF
dt
d~fECSF
dt
¼ dRt
dt
~fECEF þ Rt
d~fECEF
dt
@RECSF
@XECSF
¼ @ RðR1
t XECSFÞ  RðR1
s XECSFÞ


@XECSF
þ @RðR1
s XECSFÞ
@XECSF
:
ð11:88Þ
That is, the time differentiations of the state vector and force vectors cannot be
transformed directly like in Eq. 11.86. In other words, if the state vector and force
vectors are not directly given in the ECSF system, they are not allowed to be
differentiated as usual afterward. An approximated and transformed perturbing
potential function will introduce an error. The ﬁrst term on the right-hand side of
Eq. 11.88 signiﬁes additional perturbations, or coordinate perturbations. The order
of such perturbations can be estimated by the ﬁrst term on the right-hand side. If the
relationship between two coordinate systems changes with time or the transfor-
mation has not been made exactly, such perturbations will occur. Recalling
R ¼ R1
P R1
N R1
S R1
M
and their deﬁnitions (cf. Chap. 2), one has
dR
dt ¼ R1
P R1
N R1
S
dR1
M
dt
þ R1
P R1
N
dR1
S
dt
R1
M
þ R1
P
dR1
N
dt
R1
S R1
M þ dR1
P
dt
R1
N R1
S R1
M ;
ð11:89Þ
366
Chapter 11  Perturbed Orbit and Its Determination

where
dR1
M
dt
¼
0
0
_xp
0
0
_yp
_xp
_yp
0
0
B
@
1
C
A;
dR1
S
dt
¼ dR3ðGASTÞ
dt
dR1
N
dt
¼ dR1ðeÞ
dt
R3ðDwÞR1ðe þ DeÞ þ R1ðeÞ dR3ðDwÞ
dt
R1ðe þ DeÞ
þ R1ðeÞR3ðDwÞ dR1ðe þ DeÞ
dt
dR1
P
dt
¼ dR3ðfÞ
dt
R2ðhÞR3ðzÞ þ R3ðfÞ dR2ðhÞ
dt
R3ðzÞ þ R3ðfÞR2ðhÞ dR3ðzÞ
dt
;
ð11:90Þ
where all elements are deﬁned and given in Chap. 2, (_xp; _yp) is the polar motion rate
of time, and
dR1ðaÞ
dt
¼
0
0
0
0
 sin a
cos a
0
 cos a
 sin a
0
B
@
1
C
A da
dt
dR2ðaÞ
dt
¼
 sin a
0
 cos a
0
0
0
cos a
0
 sin a
0
B
@
1
C
A da
dt
dR3ðaÞ
dt
¼
 sin a
cos a
0
 cos a
 sin a
0
0
0
0
0
B
@
1
C
A da
dt :
ð11:91Þ
Further formulas may be easily derived.
11.2.7
Order Estimations of Perturbations
Perturbation forces that are scaled by the mass of the satellite are the accelerations.
The accelerations caused by the forces discussed have been estimated for the GPS
satellite by several authors and are summarised in Table 11.2.
If the coordinate system is used without taking precession and nutation into
account, additional perturbation acceleration can reach 3 × 10−10. Additional
acceleration of gravitational potential can reach 1 × 10−9 (cf. Liu and Zhao 1979).
11.2  Perturbation Forces of Satellite Motion
367

Table 11.2 Accelerations
(m s−2) caused by forces (cf.
Seeber 1993; Kang 1998)
Central force acceleration
0.56
Gravitational C2 acceleration
5 × 10−5
Other gravitational acceleration
3 × 10−7
The moon’s central force acceleration
5 × 10−6
The sun’s central force acceleration
2 × 10−6
Planets’ central force acceleration
3 × 10−10
The earth’s tidal acceleration
2 × 10−9
Ocean’s tidal acceleration
5 × 10−10
Solar pressure acceleration
1 × 10−7
Atmospheric drag acceleration (Topex)
4 × 10−10
General relativity acceleration
3 × 10−10
11.2.8
Ephemerides of the Moon, the Sun, and Planets
The ephemerides of the sun and the moon are used above for the computation of
shadow functions of the sun and moon (solar radiation pressure), the tidal distur-
bance forces, and tidal and loading deformations (cf. Sect. 5.8). The computation of
the ephemerides of the sun and the moon can be simpliﬁed by considering the orbit
of the sun (indeed it is the earth!) and the moon as Keplerian motion. Consider the
orbital right-handed coordinate system, the origin in the geocentre, the xy-plane as
the orbital plane, the x-axis pointing to the perigee, and the z-axis pointing in the
direction of ~q × _~q where ~q and _~q are the position and velocity vectors of the sun or
the moon. The two vectors are (cf. Eqs. 3.41 and 3.42)
~q ¼
aðcos E  eÞ
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
0
0
@
1
A ¼
q cos f
q sin f
0
0
@
1
A;
_~q ¼
 sin f
e þ cos f
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
; ð11:92Þ
where
q ¼ að1  e2Þ
1 þ e cos f :
ð11:93Þ
The position and velocity vectors of the sun or the moon in the ECEI and ECSF
coordinate systems are then (cf. Sect. 2.5 and Eq. 3.43)
~p
_~p


¼ R3ðXÞR1ðiÞR3ðxÞ ~q
_~q


~r
_~r
 
¼ R1ðeÞ ~p
_~p


;
ð11:94Þ
where a and i are the semi-major axis of the orbit and the inclination angle of the
orbital plane of the moon or the sun in the ecliptic coordinate system (ECEI). Ω is
368
Chapter 11  Perturbed Orbit and Its Determination

the ecliptic right ascension of the ascending node, e is the eccentricity of the ellipse,
ω is the argument of perigee, f is the true anomaly of the moon or the sun, and ε is
the mean obliquity (the formula is given in Sect. 2.4). Because the sun moves along
the ecliptic and the ascending node is deﬁned as the equinox, parameters i and Ω are
zero. True anomaly f, eccentric anomaly E and mean anomaly M are given by the
Keplerian equation and the following formulas
E  e sin E ¼ M
q cos f ¼ a cos E  ae
q sin f ¼ b sin E ¼ a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E:
ð11:95Þ
For the moon, eccentricity em = 0.05490, inclination im = 5:145396 and
semi-major axis am = 384401 km. For the sun, eccentricity es = 0.016709114 −
0.000042052T −0.000000126T2 and semi-major axis as = 1.0000002 AU. AU
signiﬁes the astronomical units (AU = 1.49597870691 × 108 km). The fundamental
arguments are given in the IERS Conventions (cf. McCarthy 1996) as follows:
l ¼ 134:96340251 þ 1717915923:002178T þ 31:008792T2 þ 0:00051635T3  0:0000024470T4
l0 ¼ 357:52910918 þ 129596581:000481T  0:005532T2 þ 0:00000136T3  0:0000001149T4
F ¼ 93:27209062 þ 1739527262:008478T  12:007512T2  0:00001037T3 þ 0:0000000417T4
D ¼ 297:85019547 þ 1602961601:002090T  6:003706T2 þ 0:00006593T3  0:0000003169T4
X ¼ 125:04455501  6962890:002665T þ 7:004722T2 þ 0:00007702T3  0:0000005939T4;
ð11:96Þ
where l and l′ are the mean anomalies of the moon and the sun, respectively. D is
the mean elongation of the moon from the sun. Ω is the mean longitude of the
ascending node of the moon. F = L −Ω, L is the mean longitude of the moon (or
Lmoon), and T is the Julian centuries measured from epoch J2000.0. Formulas of
Eq. 11.96 are the arguments used to compute the nutation. Mean angular velocities
n of the sun and moon are the coefﬁcients of the linear terms of l and l′ (units:
s/century), respectively.
For computation of the ephemerides of the Sun, l′ is set as M in Eq. 11.95, so that
E and f of the sun can be computed. Using D = Lmoon −Lsun = F + Ω −Lsun, the
mean longitude Lsun can be computed. ω can be computed by relation Lsun = ω + f.
For computation of the ephemerides of the moon, l is set as M in Eq. 11.95, so
that E and f of the moon can be computed. ω can be computed using the spherical
triangle formula:
tanðx þ f Þ ¼ tan F= cos im;
ð11:97Þ
where angles u (= ω + f) and F are in the same compartment.
Substituting the above values of the moon and the sun into Eqs. 11.92–11.94,
respectively, ephemerides of the moon and the sun are obtained in the ECSF
11.2  Perturbation Forces of Satellite Motion
369

coordinate system. For more precise computation of the ephemerides of the moon,
several corrections must be considered (cf. Meeus 1992; Montenbruck 1989).
Equivalently, a correction dF can be added to F, and the change of du in Eq. 11.97
can be considered df and added to f, where dF has the form of (units: seconds)
dF ¼ 22640 sin l þ 769 sinð2lÞ þ 36 sinð3lÞ  125 sin D þ 2370 sinð2DÞ  668 sin l0
 412 sinð2FÞ þ 212 sinð2D  2lÞ þ 4586 sinð2D  lÞ þ 192 sinð2D þ lÞ
þ 165 sinð2D  l0Þ þ 206 sinð2D  l  l0Þ  110 sinðl þ l0Þ þ 148 sinðl  l0Þ:
The orbits of the planets are given in the sun-centred ecliptic coordinate system
by six Keplerian elements. They are the mean longitude (L) of the planet, the
semi-major axis (a, units: AU) of the orbit of the planet, the eccentricity (e) of the
orbit, the inclination (i) of the orbit to the ecliptic plane, the argument (ω) of the
perihelion, and the longitude (Ω) of the ascending node. The orbital elements are
expressed as a polynomial function of the instant of time T (Julian centuries) for
Mercury, Venus, Mars, Jupiter, Saturn, Uranus, and Neptune, as follows (see
Meeus 1992, we use ω instead of π in this book. The argument of perihelion, ω can
be obtained through the relation: ω = π −Ω):
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Mercury
¼
252:250906
149474:0722491
0:00030397
0:00000002
0:38709831
0
0
0
0:20563175
0:000020406
0:0000000284
0:0000000002
7:0049860
0:0018215
0; 00001809
0:000000053
29:1252260
0:3702885
0:00012002
0:000000155
48:3308930
1:1861890
0:00017587
0:000000211
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A;
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Venus
¼
181:979801
58519:2130302
0:00031060
0:000000015
0:72332982
0
0
0
0:00677118
0:000047766
0:0000000975
0:00000000044
3:3946620
0:00100370
0; 00000088
0:000000007
54:883787
0:50109980
0:00148002
0:000005235
76:6799200
0:90111900
0:00040665
0:00000008
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A;
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Mars
¼
355:4332750
19141:6964746
0:00031097
0:000000015
1:523679342
0
0
0
0:09340062
0:000090483
0:0000000806
0:00000000035
1:8497260
0:0006010
0:00012760
0:000000006
286:502141
1:0689408
0:00011910
0:000002007
49:558093
0:7720923
0:00001605
0:000002325
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A;
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Jupiter
¼
34:351484
3036:3027889
0:00022374
0:000000025
5:202603191
0:0000001913
0
0
0:04849485
0:000163244
0:0000004719
0:00000000197
1:303270
0:00549660
0:00000465
0:000000004
273:866868
0:5917118
0:00063010
0:000005138
100:464441
1:0209550
0:00040117
0:000000569
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A
370
Chapter 11  Perturbed Orbit and Its Determination

and
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Saturn
¼
50:0774710
1223:5110141
0:00051952
0:000000003
9:554909596
0:0000021389
0
0
0:05550862
0:000346818
0:0000006456
0:00000000338
2:488878
0:0037363
0:00001516
0:000000089
339:391263
1:0866715
0:00095824
0:000007279
113:665524
0:8770979
0:00012067
0:00000238
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A;
L
a
e
i
x
X
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
Uranus
¼
314:055005
429:8640561
0:00030434
0:000000026
19:218446062
0:0000000372
0:00000000098
0
0:04629590
0:000027337
0:0000000790
0:00000000025
0:773196
0:0007744
0:00003749
0:000000092
98:999212
0:9652526
0:00112532
0:000018083
74:005159
0:5211258
0:00133982
0:000018516
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
B
@
1
C
C
C
A;
and
L
a
e
i
x
X
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
Neptune
¼
304:348655
219:8833092
0:00030926
0:000000018
30:110386869
0:0000001663
0:00000000069
0
0:00898809
0:000006408
0:0000000008
0:00000000005
1:769952
0:0093082
0:00000708
0:000000028
276:337634
0:3240620
0:00011912
0:000000633
131:784057
1:1022057
0:00026006
0:000000636
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
1
T
T2
T3
0
B
B
@
1
C
C
A
where except for the semi-major axis a and eccentricity e, all elements have units of
degrees. F = L −Ω, and f and E can be computed using Eqs. 11.97 and 11.95.
Mean angular velocities n of the planets are the coefﬁcients of the linear term of
L (units: degrees/century). The coordinate vector of the planet can then be com-
puted using Eqs. 11.92–11.94. The results are in the sun-centred equatorial coor-
dinate system. The results must be transformed to the ECSF coordinate system by a
translation
~r
_~r
 
ECSF
¼
~r
_~r
 
sun
þ
~r
_~r
 
SCES
;
ð11:98Þ
where vectors with an index of sun and SCEF are geocentric position and velocity
vectors of the sun and the planet in the sun-centred equatorial system.
Gravitational constants of the sun, the moon, and planets are given in
Table 11.3.
11.2  Perturbation Forces of Satellite Motion
371

11.3
Analysis Solution of the C20 Perturbed Orbit
The geopotential term of C20 is a zonal term. Compared with other geopotential
terms, C20 has a value that is at least 100 times larger. According to the order
estimation discussed in Sect. 11.2.7, C20 term perturbation is one of the most
signiﬁcant disturbing factors. C20 disturbance is a perturbation of ﬁrst order. The
analysis solution of the C20 perturbation will give a clear insight of the orbit
disturbance. The related perturbing potential is (cf. Sect. 11.2.1.1)
R2 ¼ la2
e
r3 C20P20ðsin uÞ
or
R2 ¼ b
r3 ð3 sin2 u  1Þ;
ð11:99Þ
where
b ¼
ﬃﬃﬃ
5
p
la2
e
2
C20:
The variables (r, φ, λ) of the geopotential disturbance function in the ECEF
system are transformed into orbital elements in the ECSF system using the fol-
lowing relations (cf. Fig. 11.4, cf. Kaula 1966):
Table 11.3 Gravitational
constants of the sun, the
moon, and planets
Gravitational constant of
Gravitational constant (m3s−2)
Sun
1.3271240000000E + 20
Moon
4.9027993000000E + 12
Earth
3.9860044180000E + 14
Mercury
2.2032070000000E + 13
Venus
3.2485850000000E + 14
Mars
4.2828300000000E + 13
Jupiter
1.2671270000000E + 17
Saturn
3.7940610000000E + 16
Uranus
5.8894334680000E + 15
Neptune
6.8364650040000E + 15
372
Chapter 11  Perturbed Orbit and Its Determination

sin u ¼ sin i sin u
k ¼ a  H ¼ X  H þ ða  XÞ
cosða  XÞ ¼ cos u
cos u
sinða  XÞ ¼ sin u cos i
cos u
:
ð11:100Þ
where α is the right ascension of the satellite, u = ω + f, Θ is the Greenwich
Sidereal Time, and other parameters are Keplerian elements. It is obvious that such
a coordinate transformation takes only the earth’s rotation into account; this will
cause a coordinate perturbation (cf. Sect. 11.2.6). But such an effect can be
neglected by the ﬁrst-order solution. Substituting the ﬁrst formula of Eq. 11.100
into Eq. 11.99 and taking the triangle formula (for reducing the order) into account,
one has
R2 ¼ b
r3
3
2 sin2 i 1  cos 2u
ð
Þ  1


;
ð11:101Þ
where
r ¼ að1  e2Þ
1 þ e cos f ;
ð11:102Þ
where Ω has not appeared in the zonal disturbance. Taking the partial derivatives of
f with respect to (M, e) and r with respect to (a, M, e) into account (cf. Sect. 11.1),
the derivatives of R2 with respect to Keplerian elements are then
Fig. 11.4 Orbit-equator-meridian triangle
11.3  Analysis Solution of the C20 Perturbed Orbit
373

@R2
@a ¼ @R2
@r
@r
@a ¼ 3
a R2;
@R2
@X ¼ 0;
@R2
@ i ¼ b
r3
3
2 sin 2i 1  cos 2u
ð
Þ


;
@R2
@ x ¼ b
r3 3 sin2 i sin 2u @u
@x


¼ 3b
r3 sin2 i sin 2u;
@R2
@e ¼ 3R2
r
@r
@e þ b
r3 3 sin2 i sin 2u @u
@e


¼ 3a cos f
r
R2 þ b
r3 3 sin2 i sin 2u 2 þ e cos f
1  e2
sin f


and
@R2
@ M ¼ 3R2
r
@r
@M þ b
r3 3 sin2 i sin 2u @u
@ M


¼ 3ae sin f
r
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
R2 þ b
r3 3 sin2 i sin 2u a
r
 2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p


:
ð11:103Þ
Substituting the above derivatives and R2 into the equation of motion 11.103,
one has
da
dt ¼ 6b
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na4
e
ð1  e2Þ
a4
r4 sin f 3
2 sin2 i 1  cos 2u
ð
Þ  1


þ a5
r5 sin2 i sin 2u




;
de
dt ¼ 3bð1  e2Þ3=2
na5e
e
ð1  e2Þ
a4
r4 sin f 3
2 sin2 i 1  cos 2u
ð
Þ  1


þ a5
r5 sin2 i sin 2u




 3b
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na5e
a3
r3 sin2 i sin 2u;
dx
dt ¼ 3b
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na5e
a4
r4 cos f 3
2 sin2 i 1  cos 2u
ð
Þ  1


þ a3
r3 sin2 i sin 2u 2 þ e cos f
1  e2
sin f





3b
na5
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
a3
r3 cos2 i 1  cos 2u
ð
Þ


;
di
dt ¼
3b
2na5
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
a3
r3 sin 2i sin 2u;
dX
dt ¼
3b
na5
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
a3
r3 cos i 1  cos 2u
ð
Þ
½

and
dM
dt ¼ n þ 6b
na5
a3
r3
3
2 sin2 i 1  cos 2u
ð
Þ  1


 3bð1  e2Þ
na5e
a4
r4 cos f 3
2 sin2 i 1  cos 2u
ð
Þ  1


þ a3
r3 sin2 i sin 2u 2 þ e cos f
1  e2
sin f


8
>
>
>
<
>
>
>
:
9
>
>
>
=
>
>
>
;
:
ð11:104Þ
374
Chapter 11  Perturbed Orbit and Its Determination

For convenience the right-hand side of the above equations will be separated into
three parts:
dri
dt ¼
dri
dt


0
þ
dri
dt


x
þ
dri
dt


f
ð11:105Þ
or
dri
dt ¼ _ri0 þ
dri
dt


x
þ
dri
dt  _ri0  _rix


;
ð11:106Þ
where the ﬁrst term (denoted by _ri0) on the right-hand side includes all terms that
are only functions of (a, i, e), the second term includes all terms of ω (without
f) (denoted by _rix), and the third term includes all terms of f. They are denoted by
the sub-index of 0, ω, and f, respectively. Equation 11.106 is needed for later
integral variable transformation. The second terms on the right-hand side of the
above two equations are the same. It is notable that the r is a function of f. The
solution of the R2 perturbed orbit is the integration of the above equations between
initial epoch t0 and any instantaneous epoch t. The three terms on the right side can
be integrated with the integral variable of t, ω, and f respectively. The integral
variable dt can be changed to df by
dt ¼ @t
@f df ¼
1
@f
@M
@M
@t
df ¼
r
a
 2
1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1
n df :
ð11:107Þ
All terms of ω are presented in the terms of sin 2u and cos 2u. Omitting the
terms of sin 2u and cos 2u in Eq. 11.104, the remaining terms of f are included in
the following functions:
a
r
 3
;
a
r
 4
sin f and
a
r
 4
cos f ;
ð11:108Þ
where
a
r ¼ 1 þ e cos f
1  e2
;
a
r
 2
¼ 1 þ 0:5e2 þ 2e cos f þ 0:5e2 cos 2f
ð1  e2Þ2
;
a
r
 3
¼ 1 þ 1:5e2 þ ð3e þ 0:75e3Þ cos f þ 1:5e2 cos 2f þ 0:25e3 cos 3f
ð1  e2Þ3
;
a
r
 4
¼
1
ð1  e2Þ4
1 þ 3e2 þ 3
8 e4


þ ð4e þ 3e3Þ cos f
þ ð3e2 þ 0:5e4Þ cos 2f þ e3 cos 3f þ 1
8 e4 cos 4f
2
664
3
775;
11.3  Analysis Solution of the C20 Perturbed Orbit
375

a
r
 4
sin f ¼
1
ð1  e2Þ4
1 þ 1:5e2 þ 1
8 e4


sin f þ ð2e þ e3Þ sin 2f
þ
1:5e2 þ 3
16 e4


sin 3f þ 0:5e3 sin 4f þ 1
16 e4 sin 5f
2
6664
3
7775;
a
r
 4
cos f ¼
1
ð1  e2Þ4
ð2e þ 1:5e3Þ þ
1 þ 4:5e2 þ 5
8 e4


cos f
þ ð2e þ 2e3Þ cos 2f þ
1:5e2 þ 5
16 e4


cos 3f
þ 0:5e3 cos 4f þ 1
16 e4 cos 5f
2
666666664
3
777777775
;
ð11:109Þ
and
sin jf sin mf ¼ 0:5 cosðj þ mÞf  cosðj  mÞf
½

cos jf cos mf ¼ 0:5 cosðj þ mÞf þ cosðj  mÞf
½

sin jf cos mf ¼ 0:5 sinðj þ mÞf þ sinðj  mÞf
½
:
ð11:110Þ
Then the ﬁrst term (long term perturbation) in Eq. 11.106 is
da
dt


0
¼
de
dt


0
¼
di
dt
 
0
¼ 0
dx
dt


0
¼
3b
na5ð1  e2Þ3:5
4 sin2 i  3 þ 15
4 e2 sin2 i  3e2


dX
dt


0
¼ 3b
2na5 cos i ð2 þ 3e2Þ
ð1  e2Þ3:5
dM
dt


0
¼ n þ 9b
2na5
3
2 sin2 i  1


e2
ð1  e2Þ3 :
ð11:111Þ
Due to the slow changing property of the variable ω, the integral variable
changing between t and ω can be approximated by
dt ¼
dx
dt

1
0
dx:
ð11:112Þ
376
Chapter 11  Perturbed Orbit and Its Determination

The second term (long period perturbation) in Eq. 11.106 exists only in
sin 2u and cos 2u related terms. All sin 2u and cos 2u terms are factorised by the
following functions:
a
r
 3
;
a
r
 5
;
a
r
 4
sin f ;
a
r
 4
cos f and
a
r
 32 þ e cos f
1  e2
sin f ;
ð11:113Þ
where
a
r
 5
¼
1
ð1  e2Þ5
1 þ 5e2 þ 1 7
8 e4


þ
5e þ 7:5e3 þ 5
8 e5


cos f
þ ð5e2 þ 2:5e4Þ cos 2f þ
2:5e3 þ 5
16 e5


cos 3f
þ 5
8 e4 cos 4f þ 1
16 e5 cos 5f
2
666666664
3
777777775
and
a
r
 32 þ e cos f
1  e2
sin f ¼
1
ð1  e2Þ4
2 þ 2:25e2 þ 1
8 e4


sin f
þ ð3:5e þ 0:25e3Þ sin 2f
þ
2:5e2 þ 3
16 e4


sin 3f
þ 5
8 e3 sin 4f þ 1
16 e4 sin 5f
2
666666666664
3
777777777775
:
ð11:114Þ
From properties of Eq. 11.110 and
sin 2u ¼ sin 2X cos 2f þ cos 2X sin 2f
cos 2u ¼ cos 2X cos 2f  sin 2X sin 2f ;
ð11:115Þ
it is obvious that all ω terms (without f) may be created only by multiplying
sin 2u and cos 2u by sin 2f and cos 2f in Eq. 11.113. In other words, only
sin2 2f and cos2 2f will lead to a constant of 0.5. Therefore when seeking the ω
terms (without f), just sin 2f and cos 2f related terms in Eq. 11.113 must be taken
into account. Thus,
11.3  Analysis Solution of the C20 Perturbed Orbit
377

da
dt


x
¼ 3be2ð2 þ e2Þ
na4ð1  e2Þ4:5 sin2 i sin 2x;
de
dt


x
¼ 3beð1 þ 5e2Þ
4na5ð1  e2Þ3:5 sin2 i sin 2x;
dx
dt


x
¼
3b
4na5ð1  e2Þ3:5 ð1  5:5e2Þ sin2 i þ 3e2 cos2 i
	

cos 2x;
di
dt
 
x
¼
9be2
8na5ð1  e2Þ3:5 sin 2i sin 2x;
dX
dt


x
¼
9be2
4na5ð1  e2Þ3:5 cos i cos 2x
and
dM
dt


x
¼  3bð2 þ 7e2Þ
8na5ð1  e2Þ3 sin2 i cos 2x:
ð11:116Þ
The third term of Eq. 11.106 includes all terms of f and can be denoted and
represented by
dri
dt


f
¼
dri
dt  _ri0  _rix


¼
X
mðiÞ
m¼1
ðA000
im cos mf þ B000
im sin mf Þ;
ð11:117Þ
where m(i) is the upper limit of the summation, m(i) = (7, 7, 7, 5, 5, 7) for the
related Keplerian elements, A000
im, B000
im are coefﬁcients as well as functions of (a, e, i,
ω) and can be derived from Eqs. 11.104, 11.111, and 11.116. Through integral
variable transformation (cf. Eq. 11.107), one has
dri
dt


f
r
a
 2
1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1
n ¼
X
mðiÞ2
m¼1
ðA00
im cos mf þ B00
im sin mf Þ;
ð11:118Þ
where the upper limit of the summation is reduced by 2. A00
im, B00
im are transformed
coefﬁcients. It is notable that in Eq. 11.118 the constant term (m = 0) doesn’t exist
because of the property of the short periodic term perturbations.
For the integral area of (t0, t), related areas for ω and f are (ω0, ω) and (f0,
f) respectively. For any f there is an integer k, so that k2π + f0 ≤f ≤(k + 1)2π + f0.
Using the periodic property, the integration of the terms of Eq. 11.118 over the
area of (f0, f0 + 2 kπ) is zero; therefore, Eq. 11.118 just needs to be integrated over
the area of (f0 + 2 kπ, f). Denoting the coefﬁcients of sin 2ω and cos 2ω in
Eq. 11.116 as
dri
dt


xs
and
dri
dt


xc
;
378
Chapter 11  Perturbed Orbit and Its Determination

the total integration of Eq. 11.106 is then
Zt
t0
dri ¼
Zt
t0
_ri0dt þ
Zx
x0
dri
dt


x
dx
dt

1
0
dx þ
Z f
k2p þ f0
dri
dt


f
r
a
 2
1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1
n df
ð11:119Þ
or
riðtÞ ¼ riðt0Þ þ _ri0ðt  t0Þ
þ 1
2
dx
dt

1
0
dri
dt


xc
ðsin 2x  sin 2x0Þ 
dri
dt


xs
ðcos 2x  cos 2x0Þ


þ
X
mðiÞ2
m¼1
1
m A00
imðsin mf  sin mf0Þ  B00
imðcos mf  cos mf0Þ


:
ð11:120Þ
That is, the C20 term perturbation of the orbit has a linear term (long-term
perturbation), a long periodic term (with argument of ω), and a short period term
(with argument of f). The instantaneous Keplerian elements are equal to the initial
elements plus the perturbations.
Such a C20 disturbed orbit solution provides an indication of a general model of
the perturbed orbit, which will be used as a basis for orbit correction purposes and
will be discussed in the next section.
11.4
Orbit Correction
When the orbit errors of GPS satellites become not negligible for special GPS
applications, a process of orbit correction is the ﬁrst option. Generally, orbit cor-
rection is applied to the regional or very long baseline of GPS precise positioning.
Even IGS precise GPS orbits are not homogenously precise, because they are
dependent on the distribution of the IGS reference stations and the length of the data
used. The orbit correction is an adjustment or ﬁltering process in which, besides the
station position, the orbit errors are also modelled, determined, and corrected based
on a known orbit.
Keplerian elements also describe the orbit geometry for instantaneous time.
Orbit errors can be considered geometric element errors of the orbit in general.
Recalling above discussions of the C20 perturbed orbit solution, a general orbit
model can be written as
11.3  Analysis Solution of the C20 Perturbed Orbit
379

rjðtÞ ¼ rjcðtÞ þ _rj0ðt  t0Þ þ Ajx cos 2x þ Bjx sin 2x
þ
X
mðjÞ
m¼1
A0
jm cos mf þ B0
jm sin mf
h
i
;
ð11:121Þ
where σj(t),σjc(t), _rj0 are true orbit element at time t, computed element at t, element
rate with respect to the initial epoch t0, Ajω, Bjω, A0
jm, B0
jm are the coefﬁcients of the
long and short periodic perturbations respectively, and m(j) is the truncating integer
of index m related to the jth Keplerian element. ω and f are Keplerian elements.
Generally speaking, the coefﬁcients of A0
jm, B0
jm are also functions of ω, and ω can
be considered in the short periodic term as a constant. Therefore, Eq. 11.121 is
equivalent to
rjðtÞ ¼ rjcðtÞ þ _rj0ðt  t0Þ þ Ajx cos 2x þ Bjx sin 2x
þ
X
mðjÞ
m¼1
Ajm cos mu þ Bjm sin mu


;
ð11:122Þ
where u = ω + f. The order of the polynomial term can be raised to the second
order, further terms of ω may also be added, and m(j) is selectable. The selection of
the number of the order depends on the need and the situation of orbit errors.
In the GPS observation equations (cf. Chap. 6), the orbit state vector is presented
in the range or range rate functions. It depends on the use of the GPS observables.
We denote the range and range rate function generally as ρ; their partial derivatives
with respect to the orbit state vector are given in Sect. 6.3 and have the forms of
@q
@~r
and
@q
@ _r
* ;
where the satellite state vector is (~r; _r
*Þ. The relations between (~r; _r
*Þ and Keplerian
elements σj are discussed in Sect. 3.1. Also, the relations between σj and the
parameters of the orbit correction model are given in Eq. 11.122. Therefore, the
orbit correction parts in the GPS observation equations are then
@q
@~r
@~r
@~r
@~r
@~y D~yT þ @q
@ _r
*
@ _~r
@~r
@~r
@~y D~yT;
ð11:123Þ
where ~y; D~y are the parameter vector in model 11.122 and the parameter correction
vector of the model, and ~r is the vector of Keplerian elements. If the initial
parameter vector is selected as zero, then ~y ¼ D~y. It is obvious that
~y ¼
_rj0; Ajx; Bjx; Ajm; Bjm
	

ð11:124Þ
380
Chapter 11  Perturbed Orbit and Its Determination

and
@rj
@ð_rj0; Ajx; Bjx; Ajm; BjmÞ ¼ ðt  t0Þ; cos 2x; sin 2x; cos mu; sin mu
ð
Þ:
ð11:125Þ
Here, parameters Ajm, Bjm represent symbolically the unknowns of all m. For the
convenience of presenting the partial derivatives of the state vector with respect to
the Keplerian elements, the Keplerian element vector is reordered as
~r ¼ X; i; x; a; e; M
ð
Þ:
ð11:126Þ
This does not affect Eq. 11.125, because the right-hand side of the equation has
nothing to do with index j. According to the formulas in Sect. 3.1.3 (Eqs. 3.41–3.43)
~r
_~r
 
¼ R3ðXÞR1ðiÞR3ðxÞ ~q
_~q


;
ð11:127Þ
where
~q ¼
aðcos E  eÞ
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
0
0
@
1
A ¼
r cos f
r sin f
0
0
@
1
A
and
ð11:128Þ
_~q ¼
 sin E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos E
0
0
@
1
A
na
1  e cos E ¼
 sin f
e þ cos f
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
;
ð11:129Þ
one has
@~r
@ X; i; x
ð
Þ ¼
@R
@ X; i; x
ð
Þ~q
and
@ _~r
@ X; i; x
ð
Þ ¼
@R
@ X; i; x
ð
Þ
_~q;
ð11:130Þ
where (~q; _~qÞ are position and velocity vectors of the satellite in the orbital plane
coordinate system, and
R ¼ R3ðXÞR1ðiÞR3ðxÞ
and
ð11:131Þ
@R
@ X; i; x
ð
Þ ¼
@R3ðXÞ
@X
R1ðiÞR3ðxÞ; R3ðXÞ @R1ðiÞ
@i
R3ðxÞ; R3ðXÞR1ðiÞ @R3ðxÞ
@x


;
11.4  Orbit Correction
381

where
@R1ðiÞ
@i
¼
0
0
0
0
 sin i
 cos i
0
cos i
 sin i
0
B
@
1
C
A;
@R3ðXÞ
@X
¼
 sin X
 cos X
0
cos X
 sin X
0
0
0
0
0
B
@
1
C
A
and
@R3ðxÞ
@x
¼
 sin x
 cos x
0
cos x
 sin x
0
0
0
0
0
B
@
1
C
A:
For the Keplerian elements in the orbital plane (a, e, M), one has
@~r
@ a; e; M
ð
Þ ¼ R
@~q
@ a; e; M
ð
Þ
and
@ _~r
@ a; e; M
ð
Þ ¼ R
@ _~q
@ a; e; M
ð
Þ ;
ð11:132Þ
where
@~q
@ a; e; M
ð
Þ ¼
cos E  e
a sin2 E
1e cos E  a
a sin E
1e cos E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin 2E
2ð1e cos EÞ  e sin E
1e2


a ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
cos E
1e cos E
0
0
0
0
B
@
1
C
A
and
@ _~q
@ a; e; M
ð
Þ ¼
n sin E
2ð1e cos EÞ
na sin Eðe2 cos E þ e cos2 EÞ
ð1e cos EÞ3
naðecos EÞ
ð1e cos EÞ3
n ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
cos E
2ð1e cos EÞ
na 1 þ e22e cos E þ sin2 Eðe cos E2Þ
½

ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
ð1e cos EÞ3
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
sin E
ð1e cos EÞ3
0
0
0
0
B
B
@
1
C
C
A:
The partial derivatives formulas given in Sect. 11.1 and the relation in Eq. 3.32
between n and a (mean angular velocity and semi-major axis of the satellite) given
in Chap. 3 are used, i.e.
@E
@ðe; MÞ ¼
a
r sin E; a
r


and
n2 ¼ l=a3:
382
Chapter 11  Perturbed Orbit and Its Determination

11.5
Principle of GPS Precise Orbit Determination
Recalling the discussions in Sect. 11.1, the perturbed orbit of the satellite is the
solution (or integration)
X!ðtÞ ¼ X!ðt0Þ þ
Zt
t0
F!dt;
ð11:133Þ
which can be obtained by integrating the differential state equation under the initial
condition
_
X!ðtÞ ¼ F!
X!ðt0Þ ¼ X!
0
(
;
ð11:134Þ
where X!ðtÞ is the instantaneous state vector of the satellite, X!ðt0Þ is the initial state
vector at time t0 (denoted by X!
0), F! is a function of the state vector X!ðtÞ and time
t, and
X! ¼
~r
_~r
 
and
F! ¼
_~r
~f =m


;
Where f! is the summated force vector of all possible force vectors acting on the
satellite, m is the mass of satellite, and ~r; _r
* are the position and velocity vectors of
the satellite.
If the initial state vector and the force vectors are precisely known, then the
precise orbits can be computed through the integration in Eq. 11.133. Expanding
the integration time t into the future, the so-called forecasted orbits can be obtained.
Therefore, suitable numerical integration algorithms are needed (see next section).
In practice, we must determine the precise initial state vector and force models,
which are related to the approximate initial state vector and force models. These can
be realised through suitable parameterisation of the models in the GPS observation
equations, and the parameters can then be solved by adjustment or ﬁltering.
We denote the range and range rate function generally by ρ; and their partial
derivatives with respect to the orbit state vector are given in Sect. 6.3 and have the
forms of
@q
@~r ; @q
@ _r
* ;
or
@q
@ X!:
11.5  Principle of GPS Precise Orbit Determination
383

Therefore, the orbit parameter-related parts in the linearised GPS observation
equation are
@q
@ð~r; _r
*Þ
@ð~r; _r
*Þ
@~y
D~yT;
or @q
@ X!
@ X!
@~y D~yT;
ð11:135Þ
where
~y ¼
X!
0; Y!


;
D~yT ¼
DX!
0; D Y!

T
;
@ X!
@~y ¼
@ X!
@ðX!
0; Y!Þ
:
X!; Y!are the state vector of satellite and the parameter vector of the force models, and
index 0 denotes the related initial vectors of time t0. y! is the total unknown vector of
the orbit determination problem, the related correction vector is D y! ¼ y!  y!
0, and
DX!
0 is the correction vector of the initial state vector. The partial derivatives of X!
with respect to y!are called transition matrix, which has the dimensionof 6 × (6 + n),
where n is the dimension of vector Y!. The partial derivatives of the equation of motion
of the satellite (cf., Eq. 11.134) with respect to the vector y! are
@
_
X!ðtÞ
@~y
¼ @ F!
@~y ¼ @ F!
@ X!
@ X!
@~y þ
@ F!
@~y
 
!
;
ð11:136Þ
where the asterisk (*) denotes the partial derivatives of F! with respect to the
explicit parameter vector y! in F!, and
DðtÞ ¼
@ F!
@ X!
 
!
¼
033
E33
1
m
@~f
@~r
1
m
@~f
@ _~r
0
B
@
1
C
A ¼
033
E33
AðtÞ
BðtÞ


;
CðtÞ ¼
@ F!
@~y
 
!
¼
036
03n
036
1
m
@~f
@ Y!
0
B
@
1
C
A ¼
03ð6 þ nÞ
GðtÞ


;
ð11:137Þ
where E is an identity matrix; the partial derivatives will be discussed and derived in
detail in a later section. It is notable that the force parameters are not functions of t.
Therefore, the order of the differentiations can be exchanged. Denoting transition
matrix by Φ(t, t0), then Eq. 11.136 turns out to be
dUðt; t0Þ
dt
¼ DðtÞUðt; t0Þ þ CðtÞ:
ð11:138Þ
384
Chapter 11  Perturbed Orbit and Its Determination

Equation 11.138 is called a differential equation of the transition matrix or
variational equation (cf., e.g., Montenbruck and Gill 2000). Denoting
Uðt; t0Þ ¼
Wðt; t0Þ
_Wðt; t0Þ


;
ð11:139Þ
an alternate expression of Eq. 11.138 can be obtained by substituting Eqs. 11.139
and 11.137 into Eq. 11.138
d2Wðt; t0Þ
dt2
¼ AðtÞWðt; t0Þ þ BðtÞ dWðt; t0Þ
dt
þ GðtÞ:
ð11:140Þ
The initial value matrix is (initial state vector does not depend on force parameters)
Uðt0; t0Þ ¼
E66
06n
ð
Þ:
ð11:141Þ
That is, in the GPS observation equation, the transition matrix must be obtained by
solving initial value problem of the variation Eq. 11.138 or 11.140. The problem is
solved by integration traditionally.
11.5.1
Xu’s Algebraic Solution to the Variation Equation
The variation equation can also be solved by numerical differentiation, ﬁrst derived
by Xu around 2003 (cf. preface of Xu GPS 2007).
Equation 11.140 is a matrix differential equation system of size 3 × (6 + n).
Because A(t) and B(t) are 3 × 3 matrices, the differential equations are independent
from column to column. That is, we need only discuss the solution of the equation
of a column. For column j, the Eqs. 11.140 and 11.141 are
d2WijðtÞ
dt2
¼
X
3
k¼1
AikðtÞWkjðtÞ þ BikðtÞ dWkjðtÞ
dt


þ GijðtÞ;
i ¼ 1; 2; 3;
ð11:142Þ
Wijðt0Þ
_Wijðt0Þ


¼
dij
dði þ 3Þj


;
i ¼ 1; 2; 3; dkj ¼
1
if k ¼ j
0
if k 6¼ j

;
where index ij denotes the related element of the matrix. For time interval [t0, t] and
differentiation step h = (t −t0)/m, one has tn = t0 + nh, n = 1,…,m and
d2WijðtÞ
dt2

t¼tn
¼ Wijðtn þ 1Þ  2WijðtnÞ þ Wijðtn1Þ
h2
;
i ¼ 1; 2; 3;
dWijðtÞ
dt

t¼tn
¼ Wijðtn þ 1Þ  Wijðtn1Þ
2h
;
WijðtÞ

t¼tn¼ WijðtnÞ;
i ¼ 1; 2; 3:
ð11:143Þ
11.5  Principle of GPS Precise Orbit Determination
385

Then Eq. 11.142 turns out to be
Wijðt0Þ ¼ Wijðt0Þ;
Wijðt1Þ ¼ Wijðt0Þ þ h _Wijðt0Þ;
i ¼ 1; 2; 3:
Wijðtn þ 1Þ  2WijðtnÞ þ Wijðtn1Þ
h2
¼
X
3
k¼1
AikðtnÞWkjðtnÞ þ BikðtnÞ Wkjðtn þ 1Þ  Wkjðtn1Þ
2h


þ GijðtnÞ;
i ¼ 1; 2; 3;
ð11:144Þ
where n = 1, 2, …, m −1. For i = 1, 2, 3 and the sequential number n, there are
three equations and three unknowns of time tn+1; so that the initial value problem
has a set of unique solutions sequentially. Equation 11.144 can be rewritten as
E
h2  BðtnÞ
2h


W1jðtn þ 1Þ
W2jðtn þ 1Þ
W3jðtn þ 1Þ
0
@
1
A ¼
R1
R2
R3
0
@
1
A;
ð11:145Þ
where
R1
R2
R3
0
@
1
A ¼
2E
h2 þ AðtnÞ


W1jðtnÞ
W2jðtnÞ
W3jðtnÞ
0
@
1
A

E
h2 þ BðtnÞ
2h


W1jðtn1Þ
W2jðtn1Þ
W3jðtn1Þ
0
@
1
A þ
G1jðtnÞ
G2jðtnÞ
G3jðtnÞ
0
@
1
A:
For n = 1, …, m −1, above equation is solvable. It is notable that the three
matrices
E
h2  BðtnÞ
2h


;
2E
h2 þ AðtnÞ


;
E
h2 þ BðtnÞ
2h


are independent from the column number j. The solutions of Eq. 11.145 are vectors
W1jðtn þ 1Þ
W2jðtn þ 1Þ
W3jðtn þ 1Þ
0
@
1
A
and
_W1jðtn þ 1Þ
_W2jðtn þ 1Þ
_W3jðtn þ 1Þ
0
@
1
A;
n ¼ 1; . . .; m  1;
ð11:146Þ
where the velocity vector can be computed using deﬁnition of Eq. 11.143. Solving
the equations of all column j, the solutions of the initial value problem of
Eqs. 11.140 and 11.141 can be obtained. It is notable that the needed values are the
values of tn and can be computed by averaging the values of tn+1 and tn−1.
A recent study carried out by the team at Shandong University led by the ﬁrst
author demonstrated the successful use of the algebraic solution derived here, and
will be published very soon by Nie et al. (2016).
386
Chapter 11  Perturbed Orbit and Its Determination

11.6
Numerical Integration and Interpolation Algorithms
The Runge–Kutta algorithm, Adams algorithm, Cowell algorithm, and mixed
algorithm, as well as interpolation algorithms, are discussed in this section (cf., e.g.,
Brouwer and Clemence 1961; Bate et al. 1971; Herrick 1972; Xu 1994; Liu et al.
1996; Press et al. 1992).
11.6.1
Runge–Kutta Algorithm
The Runge–Kutta algorithm is a method that can be used to solve the initial value
problem of
dX
dt ¼ Fðt; XÞ
Xðt0Þ ¼ X0;
ð11:147Þ
where X0 is the initial value of variable X at time t0, and F is the function of t and
X. For step size h, the Runge–Kutta algorithm can be used to compute X(t0 + h). By
repeating such process, a series of solutions can be obtained as X(t0 + h),
X(t0 + 2 h), …, X(t0 + nh), where n is an integer. Denoting tn = t0 + nh,
X(tn + h) can be represented by the Taylor expansion at tn by
Xðtn þ hÞ ¼ XðtnÞ þ hdX
dt

t¼tn
þ h2
2
d2X
dt2

t¼tn
þ    þ hn
n!
dnX
dtn

t¼tn
þ    ;
ð11:148Þ
where
dX
dt ¼ F;
d2X
dt2 ¼ dFðt; XÞ
dt
¼ @F
@ t þ @F
@X
@X
@ t ¼ @F
@ t þ @F
@X F;
d3X
dt3 ¼ @2F
@ t2 þ 2 @2F
@t@X F þ @2F
@t@X þ @2F
@X2 F2 þ
@F
@X

2
F
and
d4X
dt4 ¼ @3F
@t3 þ @3F
@t2@X ð3F þ 1Þ þ @3F
@t@X2 ð5F2 þ 2FÞ þ 2 @2F
@t@X
@F
@t þ 4 @3F
@X3 F3
þ 2 @2F
@X2
@F
@t F þ 4 @F
@X
@2F
@t@X F þ 6 @F
@X
@2F
@X2 F2 þ
@F
@X

2@F
@t þ
@F
@X

2@F
@X 2F:
. . .
ð11:149Þ
11.6  Numerical Integration and Interpolation Algorithms
387

The principle of the Runge–Kutta algorithm is to use a set of combinations of the
ﬁrst-order partial derivatives around the (tn, X(tn)) to replace the higher-order
derivatives in Eq. 11.148; that is,
Xðtn þ 1Þ ¼ XðtnÞ þ
X
L
i¼1
wiKi;
ð11:150Þ
where
K1 ¼ hFðtn; XðtnÞÞ
and
Ki ¼ hFðtn þ aih; XðtnÞ þ
X
i1
j¼1
bijKjÞ; i ¼ 2; 3; . . .
ð
Þ;
ð11:151Þ
where wi, αi, and βij are constants to be determined, and L is an integer. The Taylor
expansions of Ki (i = 2, 3,…) at (tn, X(tn)) to the ﬁrst order are
Ki ¼ hFðtn; XðtnÞÞ þ h2ai
@F
@t þ h @F
@X
X
i1
j¼1
bijKj or
ð11:152Þ
K2 ¼ hFðtn; XðtnÞÞ þ h2 a2
@F
@t þ b21
@F
@X F


;
K3 ¼ hF þ h2 a3
@F
@t þ ðb31 þ b32Þ @F
@X F


þ h3b32
@F
@X
a2
@F
@t þ b21
@F
@X F


;
K4 ¼ hF þ h2 a4
@F
@ t þ ðb41 þ b42 þ b43Þ @F
@X F


þ h3 ðb42a2 þ b43a3Þ @F
@X
@F
@t þ b42b21 þ b43ðb31 þ b32Þ
ð
Þ @F
@X
@F
@X F


þ h4b43b32
@F
@X
@F
@X
a2
@F
@t þ b21
@F
@X F


;
K5 ¼ hF þ h2 a5
@F
@t þ ðb51 þ b52 þ b53 þ b54Þ @F
@X F


þ h3 @F
@X
a2
@F
@t þ b21
@F
@X F þ b53 a3
@F
@t þ ðb31 þ b32Þ @F
@X F


þ b54 a4
@F
@t þ ðb41 þ b42 þ b43Þ @F
@X F


0
B
B
B
@
1
C
C
C
A
þ h4 @F
@X
ðb53b32a2 þ b54ðb42a2 þ b43a3ÞÞ @F
@X
@F
@t
þ ðb54 b42b21 þ b43ðb31 þ b32Þ
ð
Þ þ b32b21Þ @F
@X
@F
@X F
0
B
B
@
1
C
C
A
þ h5 @F
@X b54 b43b32
@F
@X
@F
@X
a2
@F
@t þ b21
@F
@X F




. . .
ð11:153Þ
388
Chapter 11  Perturbed Orbit and Its Determination

where F and the related partial derivatives have values at (tn, X(tn)). Substituting the
above formulas into Eq. 11.150 and comparing the coefﬁcients of hn(=1/n!) with
Eq. 11.148, a group of equations of constants wi, αi, and βij can be obtained by
separating them through the partial derivative combinations. For example, for
L = 4, one has
w1 þ w2 þ w3 þ w4 ¼ 1;
w2a2 þ w3a3 þ w4a4 ¼ 1
2 ;
w2b21 þ w3ðb31 þ b32Þ þ w4ðb41 þ b42 þ b43Þ ¼ 1
2 ;
w3a2b32 þ w4ða2b42 þ a3b43Þ ¼ 1
6 ;
w3b21b32 þ w4ðb21b42 þ b31b43 þ b32b43Þ ¼ 1
6 ;
w4a2b43b32 ¼ 1
24 ;
and
w4b21b43b32 ¼ 1
24 :
ð11:154Þ
There are 13 coefﬁcients in the seven equations above, so the solution set of
Eq. 11.154 is not unique. Considering w has the meaning of weight, and α is the
step factor, one may set, e.g., w1 = w2 = w3 = w4 = 1/4, α2 = 1/3, α3 = 2/3, α4 = 1
into the above equations and have
b21 þ b31 þ b32 þ b41 þ b42 þ b43 ¼ 2;
b32 þ b42 þ 2b43 ¼ 2;
b21b32 þ b21b42 þ b31b43 þ b32b43 ¼ 2
3 ;
b43b32 ¼ 1
2 ;
and
b21b43b32 ¼ 1
6 :
Letting β32 = 1, one has β42 = 0, β31 = –1/3, and β41 = 1/2. Thus, a fourth order
Runge–Kutta formula is
Xðtn þ 1Þ ¼ XðtnÞ þ 1
4
X
4
i¼1
Ki;
ð11:155Þ
11.6  Numerical Integration and Interpolation Algorithms
389

where
K1 ¼ hFðtn; XðtnÞÞ;
K2 ¼ hF tn þ 1
3 h; XðtnÞ þ 1
3 K1


;
K3 ¼ hF tn þ 2
3 h; XðtnÞ  1
3 K1 þ K2


;
and
K4 ¼ hF tn þ h; XðtnÞ þ 1
2 K1 þ 1
2 K3


:
ð11:156Þ
Similarly, a commonly used eighth-order Runge–Kutta formula can be derived.
It is quoted as follows (cf. Xu 1994; Liu et al. 1996):
Xðtn þ 1Þ ¼ Xn þ
1
840 ð41K1 þ 27K4 þ 272K5 þ 27K6 þ 216K7 þ 216K9 þ 41K10Þ;
ð11:157Þ
where
K1 ¼ hFðtn; XnÞ; Xn ¼ XðtnÞ;
K2 ¼ hF tn þ 4
27 h; Xn þ 4
27 K1


;
K3 ¼ hF tn þ 2
9 h; Xn þ 1
18 K1 þ 1
6 K2


;
K4 ¼ hF tn þ 1
3 h; Xn þ 1
12 K1 þ 1
4 K3


;
K5 ¼ hF tn þ 1
2 h; Xn þ 1
8 K1 þ 3
8 K4


;
K6 ¼ hF tn þ 2
3 h; Xn þ 1
54 ð13K1  27K3 þ 42K4 þ 8K5Þ


;
K7 ¼ hF tn þ 1
6 h; Xn þ
1
4320 ð389K1  54K3 þ 966K4  824K5 þ 243K6Þ


;
K8 ¼ hF tn þ h; Xn þ 1
20 ð231K1 þ 81K3  1164K4 þ 656K5  122K6 þ 800K7Þ


;
K9 ¼ hF
tn þ 5
6 h; Xn þ
1
288 ð127K1 þ 18K3  678K4 þ 456K5
9K6 þ 576K7 þ 4K8Þ
 
!
;
and
K10 ¼ hF
tn þ h; Xn þ
1
820 ð1481K1  81K3 þ 7104K4  3376K5
þ 72K6  5040K7  60K8 þ 720K9Þ


:
ð11:158Þ
390
Chapter 11  Perturbed Orbit and Its Determination

From the derivation process, it is obvious that the Runge–Kutta algorithm is an
approximation of the same-order Taylor expansions. For every step of the solution,
the function values of F must be computed several times. The Runge–Kutta
algorithm is also called the single-step method and is commonly used for com-
puting the start values for other multiple step methods.
Errors of the integration are dependent on the step size and the properties of
function F. To ensure the needed accuracy of the orbit integration, a step size
adaptive control is also meaningful in computing efﬁciency (cf. Press et al. 1992).
Because of the periodical motion of the orbit, the step control just needs to be made
in a few special cycles of the motion. A step doubling method is suggested by Press
et al. (1992). Integration is taken twice for each step, ﬁrst with a full step, then
independently with two half steps. Through comparing the results, the step size can
be adjusted to ﬁt the accuracy requirement.
To apply the above formulas for solving the initial value problem of the equation
of motion 11.134, Eq. 11.147 shall be rewritten as
dXk
dt ¼ _Xkðt; XÞ
d _Xk
dt ¼ fkðt; XÞ=m;
Xkðt0Þ ¼ Xk0
_Xkðt0Þ ¼ _Xk0;
k ¼ 1; 2; 3;
where X ¼ ðX1; X2; X3; _X1; _X2; _X3Þ . Using the Runge–Kutta algorithm to solve the
above problem, an additional index k shall be added to all X and K in Eq. 11.157:
Xkðtn þ 1Þ ¼ Xkn þ
1
840 ð41Kk1 þ 27Kk4 þ 272Kk5 þ 27Kk6 þ 216Kk7 þ 216Kk9 þ 41Kk10Þ;
and the same index k shall be added to K on the left side and F on the right side of
Eq. 11.158. For the last three equations, Fk = fk/m, so _Xk can be computed. For the
ﬁrst three equations, Fk ¼ _Xk , so Fk can be computed through computing _Xk at the
needed coordinates t and X.
11.6.2
Adams Algorithms
For the initial value problem of
dX
dt ¼ Fðt; XÞ
Xðt0Þ ¼ X0;
ð11:159Þ
11.6  Numerical Integration and Interpolation Algorithms
391

there exists
Xðtn þ 1Þ ¼ XðtnÞ þ
Ztn þ 1
tn
Fðt; XÞdt:
ð11:160Þ
The Adams algorithm uses the Newtonian backward differential interpolation
formula to present the function F by
Fðt; XÞ ¼ Fn þ t  tn
h
rFn þ ðt  tnÞðt  tn1Þ
2!h2
r2Fn þ   
þ ðt  tnÞðt  tn1Þ    ðt  tnk þ 1Þ
k!hk
rkFn;
ð11:161Þ
where Fn is the value of F at the time tn, h is the step size, ∇kF is the kth-order
backward numerical difference of F, and
rFn ¼ Fn  Fn1
r2Fn ¼ rFn  rFn1 ¼ Fn  2Fn1 þ Fn2;
. . .
rmFn ¼
X
m
j¼0
ð1Þ jC j
mFnj;
C j
m ¼
m!
j!ðm  jÞ! ;
ð11:162Þ
where Ci
m is the binomial coefﬁcient. Letting s = (t −tn)/h, then dt = hds, s = 0 if
t = tn, s = 1 if t = tn+1, so that Eqs. 11.161 and 11.160 turn out to be
Fðt; XÞ ¼
X
k
m¼0
Cm
s þ m1rmFn
and
Xðtn þ 1Þ ¼ XðtnÞ þ
Ztn þ 1
tn
X
k
m¼0
Cm
s þ m1
X
m
j¼0
ð1Þ jC j
mFnjhds:
ð11:163Þ
By denoting
cm ¼
Z1
0
Cm
s þ m1ds
bj ¼
X
k
m¼j
ð1Þ jC j
mcm;
ð11:164Þ
392
Chapter 11  Perturbed Orbit and Its Determination

one has
Xðtn þ 1Þ ¼ XðtnÞ þ h
X
k
j¼0
bjFnj;
ð11:165Þ
where the sequences of the two sequential summations have been changed. For the
ﬁrst equation of 11.164, there is (cf. Xu 1994)
c0 ¼ 1;
cm ¼ 1 
X
m
j¼1
1
j þ 1 cmj;
ðm  1Þ:
ð11:166Þ
Equation 11.165 is also called the Adams–Bashforth formula. It uses the function
values of {Fn−j, j = 0, …, k} to compute the Xn+1. When the order of the algorithm is
selected, the coefﬁcients of βj are constants. This makes the computation using
Eq. 11.165 very simple. For every integration step, just one function value of Fn
must be computed. However, the Adams algorithm needs {Fn−j, j = 0, …, k} as
initial values, whereas to compute those values, the states {Xn−j, j = 0, …, k} are
needed. In other words, the Adams algorithm is not able to start the integration itself.
The Runge–Kutta algorithm is usually used for computing the start values.
The Adams–Bashforth formula does not take the function value Fn+1 into
account. Using Fn+1, the Adams algorithm is expressed by the Adams–Moulton
formula. Similar to the above discussions, function F can be represented by
Fðt; XÞ ¼ Fn þ 1 þ t  tn þ 1
h
rFn þ 1 þ ðt  tn þ 1Þðt  tnÞ
2!h2
r2Fn þ 1 þ   
þ ðt  tn þ 1Þðt  tnÞ    ðt  tnk þ 2Þ
k!hk
rkFn þ 1;
ð11:167Þ
where
rmFn þ 1 ¼
X
m
j¼0
ð1Þ jC j
mFn þ 1j:
ð11:168Þ
If one lets s = (t −tn+1)/h, then dt = hds, s = −1 if t = tn, and s = 0 if t = tn+1;
similar formulas of Eqs. 11.165 and 11.164 can be obtained:
Xðtn þ 1Þ ¼ XðtnÞ þ h
X
k
j¼0
b
j Fn þ 1j;
ð11:169Þ
11.6  Numerical Integration and Interpolation Algorithms
393

b
j ¼
X
k
m¼j
ð1Þ jC j
mc
m
c
m ¼
Z0
1
Cm
s þ m1ds
ð11:170Þ
and (cf. Xu 1994)
c
0 ¼ 1;
c
m ¼ 
X
m
j¼1
1
j þ 1 c
mj;
ðm  1Þ:
ð11:171Þ
Because of the use of Fn+1 to approximate F, the Adams–Moulton formula may
reach a higher accuracy than that of the Adams–Bashforth formula. However,
before Xn+1 has been computed, Fn+1 might not have been computed exactly, and so
an iterative process is needed to use the Adams–Moulton formula. A simpliﬁed way
to use the Adams–Moulton formula is to use the Adams–Bashforth formula to
compute Xn+1 and Fn+1, and then to use the Adams–Moulton formula to compute
the modiﬁed Xn+1 using Fn+1. Experience shows that such a process will be accurate
enough for many applications.
11.6.3
Cowell Algorithms
For the initial value problem of
d2X
dt2 ¼ Fðt; XÞ
_Xðt0Þ ¼ _X0
Xðt0Þ ¼ X0;
ð11:172Þ
there is
_XðtÞ ¼ _XðtnÞ þ
Zt
tn
Fðt; XÞdt
ð11:173Þ
It is notable that here X is the position coordinate of the satellite. In other words,
the disturbing force F is not the function of the velocity of the satellite.
394
Chapter 11  Perturbed Orbit and Its Determination

By integrating Eq. 11.173 in areas of [tn,tn+1] and [tn,tn–1] respectively, one has
Xðtn þ 1Þ  XðtnÞ  _XðtnÞðtn þ 1  tnÞ ¼
Ztn þ 1
tn
Zt
tn
Fðt; XÞdtdt
and
ð11:174Þ
Xðtn1Þ  XðtnÞ  _XðtnÞðtn1  tnÞ ¼
Ztn1
tn
Zt
tn
Fðt; XÞdtdt;
ð11:175Þ
where (tn+1 −tn) = h=(tn −tn−1). Adding the equations together, one has
Xðtn þ 1Þ  2XðtnÞ þ Xðtn1Þ ¼
Ztn þ 1
tn
Zt
tn
þ
Ztn1
tn
Zt
tn
Fðt; XÞdtdt:
ð11:176Þ
Similar to the Adams–Bashforth formula, function F can be represented by
Fðt; XÞ ¼ Fn þ t  tn
h
rFn þ ðt  tnÞðt  tn1Þ
2!h2
r2Fn þ   
þ ðt  tnÞðt  tn1Þ    ðt  tnk þ 1Þ
k!hk
rkFn:
ð11:177Þ
Substituting Eq. 11.177 into Eq. 11.176, one has (similar to the derivation of the
Adams algorithms) (cf. Xu 1994)
Xðtn þ 1Þ ¼ 2XðtnÞ  Xðtn1Þ þ h2 X
k
j¼0
bjFnj;
ð11:178Þ
where
bj ¼
X
k
m¼j
ð1Þ jC j
mrm;
r0 ¼ 1; rm ¼ 1 
X
m
j¼1
2
j þ 2 bj þ 1rmj; ðm  1Þ;
bj ¼
X
j
i¼1
1
i:
ð11:179Þ
11.6  Numerical Integration and Interpolation Algorithms
395

Equation 11.178 is called the Stormer formula. Similar to the discussions in
Adams algorithms, taking Fn+1 into account, one has
Fðt; XÞ ¼ Fn þ 1 þ t  tn þ 1
h
rFn þ 1 þ ðt  tn þ 1Þðt  tnÞ
2!h2
r2Fn þ 1 þ . . .
þ ðt  tn þ 1Þðt  tnÞ    ðt  tnk þ 2Þ
k!hk
rkFn þ 1
ð11:180Þ
and (cf. Xu 1994)
Xðtn þ 1Þ ¼ 2XðtnÞ  Xðtn1Þ þ h2 X
k
j¼0
b
j Fn þ 1j;
ð11:181Þ
where
b
j ¼
X
k
m¼j
ð1Þ jC j
mr
m;
r
0 ¼ 1; r
m ¼ 
X
m
j¼1
2
j þ 2 bj þ 1r
mj;
ðm  1Þ; and
bj ¼
X
j
i¼1
1
i:
ð11:182Þ
Equation 11.181 is called the Cowell formula. Because of the use of Fn+1 to
approximate F, the Cowell formula may reach a higher accuracy than the Stormer
formula. However, before Xn+1 has been computed, Fn+1 may not be computed
exactly, and so an iterative process is needed to use the Cowell formula. A simpliﬁed
way to use the Cowell formula is to use the Stormer formula to compute Xn+1 and Fn+1,
and then to use the Cowell formula to compute the modiﬁed Xn+1 using Fn+1.
Experience shows that such a process will be accurate enough for many applications.
11.6.4
Mixed Algorithms and Discussions
Above we discussed three algorithms for solving the initial value problem of the
orbit differential equation. The Runge–Kutta algorithm is a single-step method. The
formulas of different order Runge–Kutta algorithms do not have simple relation-
ships, and even for a deﬁnite order the formulas are not unique. For every step of
integration, several function values of F must be computed for use. The most
important property of the Runge–Kutta algorithm is that the method is a
self-starting one. Generally, the Runge–Kutta algorithm is often used for providing
the starting values for multiple-step algorithms.
396
Chapter 11  Perturbed Orbit and Its Determination

Adams algorithms are multiple-step methods. The order of the formulas can be
easily raised because of their sequential relationships. However, the Adams algo-
rithms cannot start themselves. For every step of integration, only one function
value must be computed. The disturbing function is considered a function of time
and the state of the satellite. Thus the Adams methods can be used in orbit deter-
mination problems without any problem with the disturbing function. In the case of
a higher accuracy requirement, a mixed Adams–Bashforth method and Adams–
Moulton methods can be used in an iterative process.
Cowell algorithms are also multiple-step methods, and the order can easily be
changed. Cowell methods also need starting help from other methods. Analysis
shows that Cowell algorithms have a higher accuracy than that of Adams algo-
rithms when the same orders of formulas are used. However, Cowell formulas are
only suitable for that kind of disturbing function F, which is the function of the time
and the position of the satellite. It is well known that the atmospheric drag is a
disturbing force, which is a function of the velocity of the satellite. Therefore,
Cowell algorithms can only be used for integrating a part of the disturbing forces.
A mixed Cowell method still keeps this property.
Obviously, the forces of the equation of motion must be separated into two parts,
one includes the forces that are functions of the velocity of the satellite, and the
other includes all remaining forces. The ﬁrst part can be integrated using Adams
methods, and the other can be integrated using Cowell methods. The Runge–Kutta
algorithm will be used for providing the needed starting values.
The selections of the order number and step size are dependent on the accuracy
requirements and the orbit conditions. Usually, the order and the step size are
selectable input variables of the software, and can be properly selected after several
test runs. Scheinert suggested using eighth-order Runge–Kutta algorithms, as well
as 12th-order Adams and Cowell algorithms (cf. Scheinert 1996). It is notable that
by order selection, it is not the higher the order is, the higher the accuracy will be.
For the step size selection, it is not the smaller the step size is, the better the results
will be.
11.6.5
Interpolation Algorithms
Orbits are given through integration at the step points t0 + nh (n = 0, 1, …).
For GPS satellites, h is usually selected as 300 s. However, GPS observations are
made, usually in IGS, every 15 s. For linearisation and formation of the GPS
observation equations, the orbit data must sometimes be interpolated to the needed
epochs, and therefore we must discuss the method of interpolation. The often-used
Lagrange interpolation algorithm was discussed in Sect. 3.4. A ﬁfth-order poly-
nomial interpolation method was given in Sect. 5.4.2. By deriving the Adams and
Cowell algorithms, the Newtonian backward differentiation formula was used to
11.6  Numerical Integration and Interpolation Algorithms
397

represent the disturbing function F. By simply considering F as a function of t (t is
any variable), then one has
FðtÞ ¼ FðtnÞ þ t  tn
h
rFn þ ðt  tnÞðt  tn1Þ
2!h2
r2Fn þ . . .
þ ðt  tnÞðt  tn1Þ    ðt  tnk þ 1Þ
k!hk
rkFn:
ð11:183Þ
This is an interpolating formula of F(t) using a set of function values of {Fn−j,
j = 0, …, k}.
11.7
Orbit-Related Partial Derivatives
As mentioned in Sect. 11.5.1, the partial derivatives of
@~f
@~r ;
@~f
@ _~r
and
@~f
@ Y!
ð11:184Þ
will be derived in this section in detail, where the force vector is a summated vector
of all disturbing forces in the ECSF coordinate system. If the force vector is given
in the ECEF coordinate system, there is
@~f
@~r ; @~f
@ _~r
 
!
¼ R1
P R1
N R1
S R1
M
@~fECEF
@~r
; @~fECEF
@ _~r
 
!
:
ð11:185Þ
Because of
~r ¼ R ~rECEF
~f ¼ R ~fECEF;
one may have the velocity transformation formula
d~r
dt ¼ dR
dt ~rECEF þ R  d~rECEF
dt
;
where
R ¼ R1
P R1
N R1
S R1
M :
398
Chapter 11  Perturbed Orbit and Its Determination

Therefore, one has
@~rECEF
@~r
¼ R1;
@ _~rECEF
@ _~r
¼ R1;
and
@~fECEF
@~r
¼ @~fECEF
@~rECEF
@rECEF
@~r
¼ @~fECEF
@~rECEF
R1;
@~fECEF
@ _~r
¼ @~fECEF
@ _~rECEF
@_rECEF
@ _~r
¼ @~fECEF
@ _~rECEF
R1:
1. Geopotential Disturbing Force
The geopotential disturbing force vector (cf. Sect. 11.2) has the form of
~fECEF ¼
fx0
fy0
fz0
0
@
1
A ¼
b11 @V
@r þ b21 @V
@u þ b31 @V
@k
b12 @V
@r þ b22 @V
@u þ b32 @V
@k
b13 @V
@r þ b23 @V
@u
0
B
@
1
C
A;
ð11:186Þ
where
@ðr; u; kÞ
@ðx0; y0; z0Þ ¼
b11
b12
b13
b21
b22
b23
b31
b32
b33
0
@
1
A ¼
cos u cos k
cos u sin k
sin u
 1
r sin u cos k
 1
r sin u sin k
1
r cos u

1
r cos u sin k
1
r cos u cos k
0
0
@
1
A;
and (x′, y′, z′) are the three orthogonal Cartesian coordinates in the ECEF system.
Thus,
@~fECEF
@~r
¼
@fx0
@ðx0; y0; z0Þ
@fy0
@ðx0; y0; z0Þ
@fz0
@ðx0; y0; z0Þ
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
¼
@ðfx0; fy0; fz0Þ
@ðr; u; kÞ
@ðr; u; kÞ
@ðx0; y0; z0Þ

T
:
ð11:187Þ
11.7  Orbit-Related Partial Derivatives
399

Using index j (=1, 2, 3) to denote index (x′, y′, z′), one has
@fj
@ðr; u; kÞ ¼
@b1j
@r
@V
@r þ @b2j
@r
@V
@u þ @b3j
@r
@V
@k þ b1j
@2V
@ r2 þ b2j
@2V
@r@u þ b3j
@2V
@r@k
@b1j
@u
@V
@r þ @b2j
@u
@V
@u þ @b3j
@u
@V
@k þ b1j
@2V
@r@u þ b2j
@2V
@u2 þ b3j
@2V
@u@k
@b1j
@k
@V
@r þ @b2j
@k
@V
@u þ @b3j
@k
@V
@k þ b1j
@2V
@r@k þ b2j
@2V
@u@k þ b3j
@2V
@k2
0
B
B
B
B
B
B
B
B
@
1
C
C
C
C
C
C
C
C
A
T
;
ð11:188Þ
where
@
@r
b11
b12
b13
b21
b22
b23
b31
b32
b33
0
B
@
1
C
A ¼
0
0
0
1
r2 sin u cos k
1
r2 sin u sin k
1
r2 cos u
1
r2 cos u sin k
1
r2 cos u cos k
0
0
B
@
1
C
A;
@
@u
b11
b12
b13
b21
b22
b23
b31
b32
b33
0
B
@
1
C
A ¼
 sin u cos k
 sin u sin k
cos u
 1
r cos u cos k
 1
r cos u sin k
 1
r sin u

sin u
r cos2 u sin k
sin u
r cos2 u cos k
0
0
B
@
1
C
A
and
@
@k
b11
b12
b13
b21
b22
b23
b31
b32
b33
0
B
@
1
C
A ¼
 cos u sin k
cos u cos k
0
1
r sin u sin k
 1
r sin u cos k
0

1
r cos u cos k

1
r cos u sin k
0
0
B
@
1
C
A
ð11:189Þ
and
@2V
@r2 ¼ l
r3 2 þ
X
1
l¼2
X
l
m¼0
ðl þ 1Þðl þ 2Þ a
r
 l
Plmðsin uÞ½Clm cos mk þ Slm sin mk
"
#
;
@2V
@r@u ¼  l
r2
X
1
l¼2
X
l
m¼0
ðl þ 1Þ a
r
 ldPlmðsin uÞ
du
½Clm cos mk þ Slm sin mk;
@2V
@r@k ¼  l
r2
X
1
l¼2
X
l
m¼0
ðl þ 1Þ a
r
 l
Plmðsin uÞm½Clm sin mk þ Slm cos mk
"
#
;
@2V
@u2 ¼ l
r
X
1
l¼2
X
l
m¼0
a
r
 ld2Plmðsin uÞ
du2
½Clm cos mk þ Slm sin mk;
@2V
@u@k ¼ l
r
X
1
l¼2
X
l
m¼0
a
r
 ldPlmðsin uÞ
du
m½Clm sin mk þ Slm cos mk;
and
@2V
@k2 ¼  l
r
X
1
l¼2
X
l
m¼0
m2 a
r
 l
Plmðsin uÞ½Clm cos mk þ Slm sin mk;
ð11:190Þ
400
Chapter 11  Perturbed Orbit and Its Determination

where
dPlmðsin uÞ
du
¼ bðmÞPlðm þ 1Þðsin uÞ  m tan uPlmðsin uÞ;
d2Plmðsin uÞ
du2
¼ bðmÞ dPlðm þ 1Þðsin uÞ
du
 m
1
cos2 u Plmðsin uÞ  m tan u dPlmðsin uÞ
du
¼ bðmÞbðm þ 1ÞPlðm þ 2Þðsin uÞ  bðmÞ tan uð2m þ 1ÞPlðm þ 1Þðsin uÞ
þ
m2 tan2 u  m
1
cos2 u


Plmðsin uÞ;
bðmÞ ¼
1
2 ð2  d0mÞðl  mÞðl þ m þ 1Þ

1=2
and
bðm þ 1Þ ¼
1
2 ðl  m  1Þðl þ m þ 2Þ

1=2
:
ð11:191Þ
Other needed functions are already given in Sect. 11.1. Because the force is not
a function of velocity, it is obvious that
@~fECEF
@ _~r
¼ ½033:
ð11:192Þ
Only non-zero partial derivatives will be given in later text.
Supposing the geopotential parameters C
N
lm; S
N
lm are known (as initial values),
Clm; Slm are true values, and DC!
lm; D S!
lm are searched corrections (unknowns),
then the geopotential force is
~fECEFðClm; SlmÞ ¼~fECEFðC
N
lm; S
N
lmÞ þ~fECEFðClm; SlmÞ ~fECEFðC
N
lm; S
N
lmÞ
¼~fECEFðC
N
lm; S
N
lmÞ þ~fECEFðDClm; DSlmÞ;
ð11:193Þ
and
@~fECEF
@ðDClm; DSlmÞ ¼
b11
b12
b13
b21
b22
b23
b31
b32
b33
0
B
@
1
C
A
T
@
@ðDClm; DSlmÞ
@V
@r
@V
@u
@V
@k
0
B
B
@
1
C
C
A;
@
@ðDClm; DSlmÞ
@V
@r


¼  l
r2 ðl þ 1Þ a
r
 l
Plmðsin uÞ cos mk
sin mk
ð
Þ;
@
@ðDClm; DSlmÞ
@V
@u


¼ l
r
a
r
 ldPlmðsin uÞ
du
cos mk
sin mk
ð
Þ
and
@
@ðDClm; DSlmÞ
@V
@k


¼ l
r m a
r
 l
Plmðsin uÞ  sin mk
cos mk
ð
Þ:
ð11:194Þ
11.7  Orbit-Related Partial Derivatives
401

2. Perturbation Forces of the Sun, the Moon, and the Planets
The perturbation forces of the sun, the moon, and the planets are given in
Sect. 11.2.2 as (cf. Eq. 11.50)
~fm ¼ m
X
j
GmðjÞ
~r ~rmðjÞ
~r ~rmðjÞ

3 þ ~rmðjÞ
r3
mðjÞ
"
#
;
ð11:195Þ
where Gm(j) are the gravitational constants of the sun and the moon, as well as the
planets, and the vector with index m(j) are the geocentric vector of the sun, the
moon, and the planets. The partial derivatives of the perturbation force with respect
to the satellite vector are then
@~fm
@~r ¼ m
X
j
GmðjÞ
~r ~rmðjÞ

3
E þ
3
~r ~rmðjÞ

2
x  xmðjÞ
y  ymðjÞ
z  zmðjÞ
0
@
1
A
x  xmðjÞ
y  ymðjÞ
z  zmðjÞ
0
@
1
A
T
0
@
1
A;
ð11:196Þ
where E is an identity matrix of size 3 × 3. The partial derivatives of the force
vector with respect to the velocity vector of the satellite are zero. The disturbances
of the sun, moon, and planets are considered well modelled; therefore, no param-
eters will be adjusted. In other words, the partial derivatives of the force vector with
respect to the model parameters do not exist.
3. Tidal Disturbing Forces
Similar to the geopotential attraction force, the tidal force (cf. Sect. 11.2.3) has
the form
~fECEF ¼
fx0
fy0
fz0
0
@
1
A ¼
b11
@V
@r þ b21
@V
@u þ b31
@V
@k
b12
@V
@r þ b22
@V
@u þ b32
@V
@k
b13
@V
@ r þ b23
@V
@u
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
;
ð11:197Þ
where V = δV + δV1 + δV2, it is a summation of the earth tide potential and the two
parts of ocean loading tide potentials. The Eq. 11.188 is still valid for this case.
Other higher-order partial derivatives can be derived as follows:
@2dV
@r2 ¼
X
2
j¼1
lj
X
N
n¼2
kn
ðn þ 1Þðn þ 2Þa2n þ 1
e
rn þ 3rn þ 1
j
Pnðsin uÞPnðsin djÞ
þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin djÞ cos khj
2
664
3
775;
402
Chapter 11  Perturbed Orbit and Its Determination

@2dV
@r@u ¼
X
2
j¼1
lj
X
N
n¼2
kn
ðn þ 1Þa2n þ 1
e
rn þ 2rn þ 1
j
dPnðsin uÞ
du
Pnðsin djÞ
þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin djÞ cos khj
2
66664
3
77775
;
@2dV
@r@k ¼
X
2
j¼1
lj
X
N
n¼2
kn
ðn þ 1Þa2n þ 1
e
rn þ 2rn þ 1
j
2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin djÞk sin khj
"
#
;
@2dV
@u2 ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
d2Pnðsin uÞ
du2
Pnðsin djÞ
þ 2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ!
d2Pnkðsin uÞ
du2
Pnkðsin djÞ cos khj
2
66664
3
77775
;
@2dV
@u@k ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin djÞk sin khj
"
#
;
@2dV
@k2 ¼
X
2
j¼1
lj
X
N
n¼2
kn
a2n þ 1
e
rn þ 1rn þ 1
j
2
X
n
k¼1
ðn  kÞ!
ðn þ kÞ! k2Pnkðsin uÞPnkðsin djÞ cos khj
"
#
;
@2dV1
@r2
¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ ðn þ 1Þðn þ 2Þan
e
rn þ 3
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
664
3
775ds;
@2dV1
@ r@u ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ ðn þ 1Þan
e
rn þ 2
dPnðsin uÞ
du
Pnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞ cos kðks  kÞ
2
66664
3
77775
ds;
@2dV1
@r@k ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ ðn þ 1Þan
e
rn þ 2
ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk sin kðks  kÞ
2
664
3
775ds;
@2dV1
@u2 ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
d2Pnðsin uÞ
du2
Pnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
d2Pnkðsin uÞ
du2
Pnkðsin usÞ cos kðks  kÞ
2
66664
3
77775
ds;
@2dV1
@u@k ¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞk sin kðks  kÞ
2
664
3
775ds;
@2dV1
@k2
¼
ZZ

O
GrH
X
1
n¼0
ð1 þ k0
nÞ an
e
rn þ 1
 ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk2 cos kðks  kÞ
2
664
3
775ds;
11.7  Orbit-Related Partial Derivatives
403

@2dV2
@r2
¼
ZZ

C
Greur
X
1
n¼0
ðn þ 1Þðn þ 2Þan
e
rn þ 3
Pnðsin uÞPnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞ cos kðks  kÞ
2
664
3
775ds;
@2dV2
@ r@u ¼
ZZ

C
Greur
X
1
n¼0
ðn þ 1Þan
e
rn þ 2
dPnðsin uÞ
du
Pnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞ cos kðks  kÞ
2
66664
3
77775
ds;
@2dV2
@r@k ¼
ZZ

C
Greur
X
1
n¼0
ðn þ 1Þan
e
rn þ 2
ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk sin kðks  kÞ
2
664
3
775ds;
@2dV2
@u2 ¼
ZZ

C
Greur
X
1
n¼0
an
e
rn þ 1
d2Pnðsin uÞ
du2
Pnðsin usÞ þ ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
d2Pnkðsin uÞ
du2
Pnkðsin usÞ cos kðks  kÞ
2
66664
3
77775
ds;
@2dV2
@u@k ¼
ZZ

C
Greur
X
1
n¼0
an
e
rn þ 1
ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ!
dPnkðsin uÞ
du
Pnkðsin usÞk sin kðks  kÞ
2
664
3
775ds
and
@2dV2
@k2
¼
ZZ

C
Greur
X
1
n¼0
an
e
rn þ 1
 ð2  d0nÞ
X
n
k¼0
ðn  kÞ!
ðn þ kÞ! Pnkðsin uÞPnkðsin usÞk2 cos kðks  kÞ
2
664
3
775ds;
ð11:198Þ
where
dPnðsin uÞ
du
¼
n
cos u ðPn1ðsin uÞ  sin uPnðsin uÞÞ
and
dPnkðsin uÞ
du
¼ Pnðk þ 1Þðsin uÞ  k tan uPnkðsin uÞ:
ð11:199Þ
4. Solar Radiation Pressure
Solar radiation force acting on the satellite’s surface is (cf. Sect. 11.2.4)
~fsolar ¼ mcPsCrr2
sun
S
m
~r ~rsun
~r ~rsun
j
j3 ;
ð11:200Þ
the partial derivatives of the perturbation force with respect to the satellite vector are
then
404
Chapter 11  Perturbed Orbit and Its Determination

@~fsolar
@~r
¼ mcPsCrr2
sun
S
m
1
~r ~rsun
j
j3
E 
3
~r ~rsun
j
j2
x  xsun
y  ysun
z  zsun
0
@
1
A
x  xsun
y  ysun
z  zsun
0
@
1
A
T
0
@
1
A;
ð11:201Þ
where E is an identity matrix of size 3 × 3. The partial derivatives of the force
vector with respect to the velocity vector of the satellite are zero. The disturbance of
the solar radiation is considered not well modelled; therefore, unknown parameters
will also be adjusted. The total model is (cf. Sect. 11.2)
~fsolarforce ¼~fsolar þ
a11
a12
a13
a21
a22
a23
a31
a32
a33
0
@
1
A
1
cos u
sin u
0
@
1
A:
ð11:202Þ
Thus,
@~fsolarforce
@~r
¼ @~fsolar
@~r
þ
a11
a12
a13
a21
a22
a23
a31
a32
a33
0
@
1
A
0
 sin u
cos u
0
@
1
A @u
@~r ;
ð11:203Þ
where
@u
@~r ¼
@u
@ðX; i; x; a; e; MÞ
@ðX; i; x; a; e; MÞ
@ð~r; _~rÞ
@ð~r; _~rÞ
@~r
:
ð11:204Þ
On the right-hand side of above equation there are three matrices, the ﬁrst one is
a 1 × 6 matrix (vector) and is given in Sect. 11.1.2 (cf. Eq. 11.24), the second one
is given as its inverse in Sect. 11.4 (cf. Eqs. 11.130 and 11.132), and the third one
is a 6 × 3 matrix, or
@u
@ðX; i; x; a; e; MÞ ¼ ð0; 0; 1; 0; 2 þ e cos f
1  e2
sin f ; a
r
 2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
Þ;
@ðX; i; x; a; e; MÞ
@ð~r; _~rÞ
¼
@ð~r; _~rÞ
@ðX; i; x; a; e; MÞ
 
!1
¼
@R
@ðX; i; xÞ~q
R
@~q
@ða; e; MÞ
@R
@ðX; i; xÞ
_~q
R
@ _~q
@ða; e; MÞ
0
B
B
B
@
1
C
C
C
A
1
and
@ð~r; _~rÞ
@~r
¼
E33
033


:
ð11:205Þ
11.7  Orbit-Related Partial Derivatives
405

@u
@ _~r
¼
@u
@ðX; i; x; a; e; MÞ
@ðX; i; x; a; e; MÞ
@ð~r; _~rÞ
@ð~r; _~rÞ
@ _~r
and
@ð~r; _~rÞ
@ _~r
¼
033
E33


:
ð11:206Þ
The partial derivatives of the force vector with respect to the model parameters
are (for i = 1, 2, 3)
@~fsolarforce
@aij
¼
1
if j ¼ 1
cos u
if j ¼ 2
sin u
if j ¼ 3
8
<
:
:
ð11:207Þ
If Xu’s Model 11.74
a~fsolar ¼
a1
b1
a2
b2
a3
b3
0
@
1
A
1
t


ð11:208Þ
is used, then one has
@~fsolarforce
@ðai; biÞ ¼ ð1; tÞ;
i ¼ 1; 2; 3:
ð11:209Þ
5. Atmospheric Drag
Atmospheric drag force has a form of (cf. Sect. 11.2.5)
~fdrag ¼ m 1
2
CdS
m


r _~r  _~rair

 _~r  _~rair


;
ð11:210Þ
and the air drag force model is
~fairdrag ¼~fdrag þ ð1 þ qÞD~fdrag;
ð11:211Þ
where (cf. Eqs. 11.84 and 11.85)
D~fdrag ¼ a þ buð2xÞ cosð2f Þ þ cuð3xÞ cosð3f Þ þ duðxÞ cos f
½
~p;
ð11:212Þ
uðkxÞ ¼
sin kx
if cos kx ¼ 0
1
cos kx
if cos kx 6¼ 0

;
k ¼ 1; 2; 3
ð11:213Þ
406
Chapter 11  Perturbed Orbit and Its Determination

It is obvious that the partial derivatives of the air drag force with respect to the
satellite position vector are zero, and
@~fdrag
@ _~r
¼ m 1
2
CdS
m


r
_~r  _~rair

E þ
1
_~r  _~rair


_x  _xair
_y  _yair
_z  _zair
0
@
1
A
_x  _xair
_y  _yair
_z  _zair
0
@
1
A
T
0
B
@
1
C
A;
ð11:214Þ
@D~fdrag
@f
¼ 2buð2xÞ sinð2f Þ  cuð3xÞ sinð3f Þ  duðxÞ sin f
½
~p;
ð11:215Þ
@D~fdrag
@x
¼
b cosð2f Þ @uð2xÞ
@x
þ c cosð3f Þ @uð3xÞ
@x
þ d cos f @uðxÞ
@x


~p; ð11:216Þ
@uðkxÞ
@x
¼
k cos kx
if cos kx ¼ 0
k tan kx
cos kx
if cos kx 6¼ 0

; k ¼ 1; 2; 3
ð11:217Þ
@D~fdrag
@ð~r; _~rÞ
¼ @D~fdrag
@ðx; f Þ
@ðx; f Þ
@ðX; i; x; a; e; MÞ
@ðX; i; x; a; e; MÞ
@ð~r; _~rÞ
@ð~r; _~rÞ
@ð~r; _~rÞ
;
ð11:218Þ
where
@x
@ðX; i; x; a; e; MÞ ¼ 0; 0; 1; 0; 0; 0
ð
Þ;
@f
@ðX; i; x; a; e; MÞ ¼
0; 0; 0; 0; 2 þ e cos f
1  e2
sin f ; a
r
 2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p


Some of the formulas have been derived previously in this subsection. The
partial derivatives of the force vector with respect to the model parameters can be
obtained from Eq. 11.215.
References
Bate RR, Mueller DD, White JE (1971) Fundamentals of astrodynamics. Dover, New York.
Beutler G, Brockmann E, Gurtner W, Hugentobler U, Mervart L, Rothacher M, Verdun A (1994)
Extended orbit modelling techniques at the CODE Processing Center of the IGS: Theory and
initial results. Manuscr Geodaet 19:367–386.
Brouwer D, Clemence GM (1961) Methods of celestial mechanics. Academic Press, New York.
Cappellari JO (1976) Mathematical theory of the Goddard trajectory determination system.
Cui C (1990) Die Bewegung künstlicher Satelliten im anisotropen Gravitationsfeld einer
gleichmässig rotierenden starren Modellerde. Deutsche Geodätische Kommission, Reihe C:
Dissertationen, Heft Nr. 357.
11.7  Orbit-Related Partial Derivatives
407

Dow JM (1988) Ocean tides and tectonic plate motions from Lageos. Deutsche Geodätische
Kommission, Rheihe C, Dissertation, Heft Nr. 344.
Fliegel HF, Gallini TE, Swift ER (1992) Global Positioning System radiation force model for
geodetic applications. J Geophys Res 97(B1):559–568.
Heiskanen WA, Moritz H (1967) Physical geodesy. W. H. Freeman, San Francisco/ London.
Herrick S (1972) Astrodynamics, Vol. II. Van Nostrand Reinhold, London.
Kang Z (1998) Präzise Bahnbestimmung niedrigﬂiegender Satelliten mittels GPS und die Nutzung
für
die
globale
Schwerefeldmodellierung.
Scientiﬁc
Technical
Report
STR
98/25,
GeoForschungsZentrum (GFZ) Potsdam.
Kaula WM (1966, 2001) Theory of satellite geodesy. Blaisdell Publishing Company, Dover
Publications, New York.
Knudsen P, Andersen O, Khan SA, Hoeyer JL (2000) Ocean tide effects on GRACE gravimetry.
IAG Symposia.
Liu L, Zhao D (1979) Orbit theory of the Earth satellite. Nanjing University Press, (in Chinese).
Liu DJ, Shi YM, Guo JJ (1996) Principle of GPS and its data processing. TongJi University Press,
Shanghai, (in Chinese).
McCarthy DD (1996) International Earth Rotation Service. IERS conventions, Paris, 95 pp. IERS
Technical Note No. 21.
Meeus J (1992) Astronomische Algorithmen. Johann Ambrosius Barth.
Melchior P (1978) The tides of the planet Earth. Pergamon Press.
Montenbruck O (1989) Practical Ephemeris calculations. Springer-Verlag, Heidelberg.
Montenbruck O, Gill E (2000) Satellite Orbits: Models, Methods and Applications. Springer.
Moritz H (1980) Advanced physical geodesy. Herbert Wichmann Verlag, Karlsruhe.
Nie WF, Du YJ, Gao F, Ji CN, Wang TH, Xu G (2016) Validation of the numerical algebra
solution for the state transition matrix in precise orbit determination. In review.
Press WH, Teukolsky SA, Vetterling WT, Flannery BP (1992) Numerical recipes in C, 2nd Ed.
Cam-bridge University Press, New York.
Rapp RH (1986) Global geopotential solutions. In: Sunkel H (ed) Mathematical and numerical
tech-niques in physical geodesy. Lecture Notes inEarth Sciences, Vol. 7, Springer-Verlag,
Heidelberg.
Scheinert M (1996) Zur Bahndynamik niedrigﬂiegender Satelliten. DGK, Reihe C, Heft 435,
Verlag der Bayerischen Akademie der Wissenschaften,, DGK, Reihe C, Heft 435.
Seeber G (1993) Satelliten-Geodaesie. Walter de Gruyter 1989.
Sigl R (1989) Einführung in die Potentialtheorie. Wichmann Verlag, Karlsruhe.
Torge W (1989) Gravimetrie. Walter de Gruyter, Berlin.
Wenzel H-G (1985) Hochauﬂösende Kugelfunktionsmodelle für das Gravitationspotential der
Erde. Wissenschaftliche Arbeiten der TU Hannover, Nr. 137.
Xu
G
(1992)
Spectral
analysis
and
geopotential
determination
(Spektralanalyse
und
Erdschwerefeldbestimmung). Dissertation, DGK, Reihe C, Heft Nr. 397, Press of the Bavarian
Academy of Sciences, ISBN 3–7696–9442–2, 100 p, (with very detailed summary in German).
Xu QF (1994) GPS navigation and precise positioning. Army Press, Peking, ISBN 7-5065-0855-9/P.4,
(in Chinese).
Xu G (2004) MFGsoft – Multi-Functional GPS/(Galileo) Software – Software User Manual,
(Version of 2004), Scientiﬁc Technical Report STR04/17 of GeoForschungsZentrum
(GFZ) Potsdam, ISSN 1610-0956, 70 pages, www.gfz-potsdam.de/bib/pub/str0417/0417.pdf.
408
Chapter 11  Perturbed Orbit and Its Determination

Chapter 12
Singularity-Free Orbit Theory
The previous chapter (Chap. 11) of this book covered the most important content
regarding numerical satellite orbit determination theory and algorithms. In this
chapter, the emphasis will be on singularity-free orbit theory. We begin with a brief
historical review of the singularity problem. We further discuss the problem of
singularity of equations of motion, singularity-free theory, singularity criteria,
analytical solutions, and the application of analytical orbit solutions.
12.1
A Brief Historical Review of the Singularity Problem
The universal gravitational force and equation of motion and the N-body problem
were ﬁrst introduced by Isaac Newton (1687) in his Principles. Although it is
believed that Newton found the solution to the two-body problem, this solution (i.e.
Keplerian orbit) was published by the Swiss mathematician Bernoulli (1710)
(Goldstein 1980; Landau and Lifshitz 1976). It was quickly recognized that ﬁnding
general solutions to the three-body problem was very difﬁcult. The Swiss mathe-
matician and physicist Euler (1767) and the French mathematician and astronomer
Lagrange (1772) solved the three-body problem under planar and spatial restric-
tions. The French astronomer and mathematician Delaunay (1860, 1867) introduced
solutions for the sun-earth-moon three-body case (Tisserand 1894; Hagihara 1970).
King Oscar II of Sweden and Norway established an award in 1885 to seek the
solution to the three-body problem (Mittag-Lefﬂer 1885). The French mathemati-
cian and theoretical physicist Poincare received the award in 1887 received the
award—even though he failed to solve the problem. He provided the proof that
there is no general closed-formed solution to the N-body problem when N is greater
than 2 (Poincare 1992; Barrow-Green 1996; Dvorak and Lhotka 2013). Based on
the contribution of Poincare, the theoretical study of the N-body problem was
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_12
409

concentrated in two directions: studying the singularity problem (including the
problem of collisions; Xia 1992) and deriving a series solution (Aarseth et al. 2008).
The Finnish mathematician Sundman (1906, 1909) obtained an analytical solution
to the three-body problem (Sundman 1912); however, it included singularity
problems in the solution. Also, the series converged very slowly and thus cannot be
considered practical (Diacu 1996). The American mathematician Wang (1991)
extended Sundman’s solution to N greater than 3 by ignoring singular equations
(cf. also Diacu 1996). A historical review of the N-body problem was provided by
Diacu (1992, 1996) and Diacu and Holmes (1996). There are also numerical studies
on the N-body problem (e.g., Havel 2008; Aarseth 2003).
Lagrangian and Gaussian equations of satellite (and/or planet) motion describe
the two-body problem disturbed by the potential function and the non-conservative
force, respectively. The singularity problems exist in cases of circular, equatorial,
and circular and equatorial orbits. The critical inclination problem exists in cases of
long-periodic disturbances which are functions of ω. Celestial mechanics textbooks
typically recommend the approach of Keplerian variable transformation (including
canonical transformations) in the Lagrange equations (Boccaletti and Pucacco
1998; Kaula 1966, 2001; Liu and Zhao 1979; Xu and Xu 2013b; Brouwer and
Clemence 1961; Chobotov 1991; Herrick 1972; Vallado 2007). After transforma-
tion, the singularity disappears, and solutions can then be derived. Philosophically
speaking, after the transformed equations are solved, the solutions must be trans-
formed inversely back to Keplerian elements, and either the singularity will
still exist or the inverse transformation will not exist (Xu and Xu 2012, 2013b). In
other words, the variable transformation does not really solve the singularity
problem, and it persists. Furthermore, the transformed variables no longer have
clear geometric properties. And ignoring all singular equations will degrade a three-
dimensional perturbation problem to a two-dimensional problem, and this may not
be correct (Xu 2010a, b). The singularity problem in equations of satellite motion is
one that has existed since the science of celestial mechanics was established and the
satellite era began.
The satellite orbit of the earth is studied using the so-called two-body disturbing
theory based on Lagrangian and Gaussian equations of motion, because the per-
turbations are relatively small compared with the central force of the earth (Battin
1999). Studies are mostly concentrated on the solution of geopotential disturbance
which is of the ﬁrst order (Kaula 1966, 2001; Cui 1990; Shapiro 1962; Wnuk
1990).
Xu (2008, 2010a, b) suggested an alternative method to simplify the equations in
the case of singularity (cf. Xu and Xu 2013b, Sect. 10.1). However, the method is
similar to that used for extending Sundman’s three-body solutions to the N-body by
omitting the singular equations (Sundman 1912; Wang 1991). On one hand, this is
reasonable, because the Lagrangian equations are derived under the assumption that
no singularity will occur; in cases of singularity, the related Lagrangian brackets are
zero, so the related equation part disappears (Chobotov 1991; Xu 2008, 2013b;
410
Chapter 12  Singularity-Free Orbit Theory

Kaula 2001). On the other hand, in the case of circular and equatorial orbits, only
the terms of semi-major axis a and the mean anomaly M exist in the Lagrangian
equations of motion (cf. Xu and Xu 2013b, Eq. 10.3), so that the three-dimensional
perturbations are degraded to two-dimensions (within the orbital plane), and this is
not reasonable.
Analytical orbit solutions have been derived for Lagrangian equations 10.8
(Xu and Xu 2013b) disturbed by the geopotentials (see, e.g., Chap. 6 of Xu and
Xu 2013b; Wnuk 1990; Shapiro 1962; Kaula 2001; Xu 2008). By integrating the
differential Eqs. 10.8 (Xu and Xu 2013b), the mean value theorem for integration is
used, and the coefﬁcient functions of the long and long-periodic terms (functions of
a, e, i, ω, and Ω) are considered as constants over suitably selected time intervals
(Wnuk 1990; Xu et al. 2010a, b; Xu et al. 2011). In other words, the functions of
(a, e, i, ω, Ω) are considered ﬁrst as constants by the indeﬁnite integration. The time
variations of the slow-changing elements (a, e, i, ω, Ω) are taken then into account
by step-wise integration of the equations.
Disturbing solutions of the second order due to the multi-body and solar radi-
ation, as well as atmosphere perturbations, are given by Xu et al. (2010a, b, 2011)
and Xu and Xu (2013a, b). Again, there exists a singularity problem in cases of
circular and equatorial obits. We must emphasize that Xu’s solutions in Xu and Xu
2013b (cf. also Xu et al. 2010a, b, 2011; Xu and Xu 2012, 2013a) are based on the
so-called basic Lagrange and Gauss equations; therefore, the solutions are general
and are further valid for the singularity-free equations discussed later in this chapter.
A so-called singularity-free theory was proposed in Xu and Xu (2012), mainly
via logical derivation and in the form of indeﬁnite integrals. A better-formulated
version in the form of a differential equation was given in Xu and Xu (2013b), and
these are called singularity-free Lagrange-Xu and Gauss-Xu equations. Because the
equation of motion with factors e and/or sin i as divisor may lead to singularity, the
factors are called singular factors (Xu and Xu 2012). Xu and Xu also noted in 2012
that using e2 and cos i as variables instead of e and i would lead to three Lagrange
equations of motion singularity-free (Xu and Xu 2012, 2013b).
Two rigorous and pure mathematical proofs for the correctness of the
singularity-free Lagrange-Xu and Gauss-Xu equations of motion are given in Xu
et al. (2014a, b) and Xu et al. (2015a, b). Importantly, three singularity criteria are
deﬁned in Xu and Xu (2012) to give boundaries of the three cases of singularity
with orbital geometric meaning. Through the study of the continuousness of the
motion equations conducted by Chunhua Jiang, supervised by GXu, the optimal
formulations of the singularity-free equations were found at the beginning of 2016.
Because in two-body or N-body problems, the same Lagrange equations are used
to describe the motions of the second or the Nth body, the derived singularity-free
equations of motion lead to the conclusion that the singularity problem in the N-body
problem is also solved [Dvorak agrees with this opinion (Xu and Xu 2013b)].
A breakthrough on the singularity problem was achieved by Xu and Xu (2012,
2013b), and the so-called singularity-free Lagrange-Xu and Gauss-Xu equations were
12.1
A Brief Historical Review of the Singularity Problem
411

thus derived. The following section is based on the papers of Xu et al. (2014a, b) and Xu
etal.(2015a,b),aswellastheresearchresultsofXu’steamatShandongUniversity.The
key members of the team who contributed to the formulation of the optimal
singularity-free equations of motion are GXu, Jia Xu, Wu Chen, Yunzhong Shen,
Ta-kang Yhe, Chunhua Jiang, Nan Jiang, Jing Qiao, Wenfeng Nie, and Yujun Du.
12.2
On the Singularity Problem in Orbital Mechanics
In this section, we outline the basic Lagrange and Gauss equations of motion (Xu
and Xu 2012), which are important for solving equations without singularity
problems. We also introduce an algorithm proposed to deal with the singularity
problem in orbital mechanics (cf. Xu and Xu 2012, with minor modiﬁcations).
Criteria with geometric meaning for singularity are introduced, and the so-called
singularity-free Lagrange-Xu and Gauss-Xu equations of motion are derived using
rigorous mathematical methods.
12.2.1
Basic Lagrangian and Gaussian Equations of Motion
The Lagrangian equations of satellite motion are represented by Battin (1999),
Brouwer and Clemence (1961), Van Kamp (1967), Boccaletti and Pucacco (2001),
and Eberle et al. (2008).
da
dt ¼ 2
na
@V
@M
de
dt ¼ 1  e2
na2e
@V
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@V
@x
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@V
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@V
@i
di
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
cos i @V
@x  @V
@X


@X
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@V
@i
@M
dt ¼ n  2
na
@V
@a  1  e2
na2e
@V
@e
:
ð12:1Þ
412
Chapter 12  Singularity-Free Orbit Theory

Here, n is the mean angular velocity and will be omitted later on. The Keplerian
elements (a, e, ω, i, Ω, M, f) are the semi-major axis, the eccentricity of the ellipse,
the argument of perigee, the inclination angle, the right ascension of the ascending
node, the mean anomaly, and the true anomaly, respectively. V is the disturbing
potential function.
The Lagrangian equations can be written as (cf. Eqs. 6.23 or 7.94 in Xu and Xu
2013b)
da
dt ¼ 2
na
da1
dt ¼ h1
da1
dt
de
dt ¼ 1  e2
na2e
da1
dt 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
de1
dt ¼ h2
da1
dt  h3
de1
dt
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
dx1
dt  cos i dX
dt ¼ h3
dx1
dt  h5ðcos i= sin iÞ dX1
dt
di
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
cos i de1
dt  di1
dt


¼ h4
1
sin i
cos i de1
dt  di1
dt


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
dX1
dt ¼ h5
1
sin i
dX1
dt
dM
dt ¼ n  2
na
dM1
dt  1  e2
na2e
dx1
dt ¼ n  h1
dM1
dt  h2
dx1
dt
ð12:2Þ
where coefﬁcients (h1, h2, h3, h4, h5) are deﬁned, and
da1
dt ¼ @R
@M ;
de1
dt ¼ @R
@x ;
dx1
dt ¼ @R
@e ;
di1
dt ¼ @R
@X ;
dX1
dt ¼ @R
@i ;
dM1
dt ¼ @R
@a :
ð12:3Þ
Equations 12.3 are called basic Lagrangian equations of motion. By integrating the
Eqs. 12.2, the mean value theorem for integration is used where the functions of
variables (a, e, i) are considered constants. The simplest way to solve the
Lagrangian equations of motion 12.1 or 12.2 is to solve the basic Lagrangian
Eqs. 10.10. Substituting solutions of 12.3 into 12.2, the solutions of 12.2 can be
obtained. Therefore, without exception, the potential force disturbing orbit problem
turns out to be the problem of solving the basic Lagrangian equations of motion 12.
3. It is notable that the basic Lagrangian equations of motion are singularity-free.
The Gaussian perturbed equations of motion are (Kaula 2001)
12.2  On the Singularity Problem in Orbital Mechanics
413

da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

de
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos E þ cos f Þ  fa
½

dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


 cos i dX
dt
di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dX
dt ¼ ð1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
dM
dt ¼ n  2
na
1  e2
1 þ e cos f


 fr  1  e2
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


ð12:4Þ
and
u ¼ x þ f ;
cos E ¼ e þ cos f
1 þ e cos f :
ð12:5Þ
Here (fr, fα, fh)T is a force vector in an orbital plane coordinate system, the ﬁrst two
components are in the orbital plane, fr is the radial component, fα is the component
perpendicular to fr and points in the direction of the satellite motion (see Fig. 12.1,
where o is the focus of the orbital ellipse and f is the true anomaly counted from the
perigee of the orbital ellipse) and fh completes a right-handed system. E is the
eccentric anomaly. The relation between eccentric anomaly E and true anomaly f is
Fig. 12.1 Radial force vector
and its perpendicular one in
the orbital plane
414
Chapter 12  Singularity-Free Orbit Theory

given in Fig. 12.2 (where S0 is the vertical projection of the satellite S on the circle
with a radius of a (semi-major axis of the ellipse), b is the semi-minor axis of the
ellipse, O0 is the centre of the circle and O is the focus of the ellipse).
The Gaussian equations can be rewritten as
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
da1
dt ¼ h1
da1
dt
de
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
de1
dt ¼ h2
de1
dt
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
dx1
dt  cos i dX
dt ¼ h3
dx1
dt  cos i dX
dt ¼ h3
dx1
dt  h7
dX1
dt
di
dt ¼
1
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
di1
dt ¼ h4
di1
dt
dX
dt ¼
1
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
dX1
dt ¼ h5
dX1
dt ¼ h4
1
sin i
dX1
dt
dM
dt ¼ n  2 1  e2
na

 dM1
dt  1  e2
nae
dx1
dt ¼ n  2h6e dM1
dt  h6
dx1
dt
ð12:6Þ
where coefﬁcients of (h1, h2, h3, h4, h5, h6, h7 = h5cos i = h4cosi/sin i) are deﬁned,
and
Fig. 12.2 The eccentric and
true anomalies (f and E) of a
satellite
12.2  On the Singularity Problem in Orbital Mechanics
415

da1
dt ¼ e sin f  fr þ ð1 þ e cos f Þ  fa
de1
dt ¼ sin f  fr þ ðcos E þ cos f Þ  fa
dx1
dt ¼  cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa
di1
dt ¼ ð1  e cos EÞ cos u  fh
dX1
dt ¼ ð1  e cos EÞ sin u  fh
dM1
dt ¼
1
1 þ e cos f  fr
ð12:7Þ
Equations 12.7 are called basic Gaussian equations of motion. By integrating the
Eqs. 12.6 the mean value theorem for integration is used where the functions of
variables (a, e, i) are considered constants. For solving the Gaussian equations of
motion 12.6, the simplest way is to solve the basic Gaussian Eq. 12.7. Substituting
solutions of 12.7 into 12.6 the solutions of 12.6 can be obtained. Therefore, without
exception, the non-conservative force disturbing orbit problem turns out to be the
problem of solving the basic Gaussian equations of motion 12.7. It is notable that
the basic Gaussian equations of motion are singularity-free.
In both the Lagrangian and Gaussian equations of motion 12.2 and 12.6, there
exist singular problems. In the case of e ≪1, the orbit is nearly circular, so that the
perigee and the related Keplerian elements f and ω are not deﬁned, and the problem is
singular. To overcome this problem, traditionally, let u = f + ω, and a parameter set of
(a, i, Ω, ξ = ecos ω, η = −esin ω, λ = M + ω) can be used to describe the motion of
the satellite. The related Lagrangian equations of motion can be derived and the
singularity of e disappears. Using another set of variables (a, h = sin icos Ω,
k = −sini sin Ω, ξ = ecos(ω + Ω), η = −esin(ω + Ω), λ = M + ω + Ω), both the
singularities caused by e = 0 and sini = 0 may disappear. Furthermore, a possible
variable set is (a, h = tan(i/2)sin Ω, k = tan(i/2)cos Ω, ξ = esin(ω + Ω), η = ecos
(ω + Ω), λ = M + ω + Ω) (see, e.g., Chobotov 1991). Also often employed are the
canonical transformations using, for example, Hill variables (Cui 1990, 1997;
Schneider and Cui 2005) and Delaunay elements (Kaula 2001; Wnuk 1990). These
are traditional methods that may be used to solve the singularity problem; however,
except for Keplerian variables, they do not have a clear geometric meaning.
In orbit determination practice for an equatorial satellite, to avoid the inclina-
tional singularity problem, the coordinate system will be rotated ﬁrst so that the
orbital plane will not coincide with the equatorial plane; after the orbits are
determined, the results will be rotated inversely.
416
Chapter 12  Singularity-Free Orbit Theory

12.2.2
Solving Algorithm for the Singularity Problem
For convenience, we call e and sin i singular factors. Any singular factor as divisor
in the equations of motion could lead to a singularity; however, it could also not.
The partial derivatives of the potential function with respect to the Keplerian ele-
ments are not responsible for singularity (cf. Xu 2008, 2010a, b). The singularity
problem (if it exists) exists in the equations from the beginning.
Rewrite Eqs. 12.1 or 12.2 as follows (Xu and Xu 2012, 2013b):
da
dt ¼ da;
de
dt ¼ de1
ae þ de2
ae ;
dx
dt ¼ dx1
ae þ
dx2
a sin i ;
di
dt ¼
di1
a sin i þ
di2
a sin i ;
dX
dt ¼
dX
a sin i ;
dM
dt ¼ dM1 þ dM2
ae :
ð12:8Þ
Here, δ with indices represent terms on the right-hand side of Eqs. 12.1 or 12.2.
The relationship between δ and the basic Lagrangian Eqs. 12.3 can be seen by
comparing Eqs. 12.2 and 12.8. δs are in the same magnitude order (comparing
Eqs. 12.1 and 12.8). Keplerian elements on the left-hand side of Eq. 12.1 will be
represented by σ with indices later on. Multiplying e by the second and sixth
equation of 12.8, sin i by the fourth and ﬁfth, and esini by the third, it follows that
da
dt ¼ da;
e de
dt ¼ de1
a þ de2
a ;
e sin i dx
dt ¼ sin i dx1
a þ edx2
a
;
sin i di
dt ¼ di1
a þ di2
a ;
sin i dX
dt ¼ dX
a ;
e dM
dt ¼ edM1 þ dM2
a :
ð12:9Þ
The above equations are singularity-free Lagrangian (n in the sixth equation is
omitted). The solutions (i.e. the indeﬁnite integrals of 12.9) can be derived using
methods described in Wnuk (1990), Xu et al. (2010a, b), (2011), and Kaula (2001),
or formed using the solutions of the basic Lagrangian equations derived in this
book, and have the forms
Da ¼ Dda;
eDe ¼ Dde1
a
þ Dde2
a
;
e sin iDx ¼ sin iDdx1
a
þ eDdx2
a
;
sin iDi ¼ Ddi1
a
þ Ddi2
a ;
sin iDX ¼ DdX
a ;
eDM ¼ eDdM1 þ DdM2
a
:
ð12:10Þ
Here Δσ represents the change (or delta) of σ and Δδ represents indeﬁnite integrals
of δ with respect to time. Deriving the Kepler element change Δσ from Eqs. 12.1 or
12.8 thus becomes a task of deriving solutions Δσ from Eq. 12.10. On the right-hand
side, the integrals Δδ are the solutions of the basic Lagrangian Eq. 12.3 multiplied
by factors which can be obtained by comparing Eqs. 12.2, 12.3, and 12.9.
The equations at 12.10 are called intermediate solutions. We see now why the
basic Lagrangian equations are deﬁned and solved systematically in Orbits
12.2  On the Singularity Problem in Orbital Mechanics
417

(Xu and Xu 2013b). In the case of non-singularity, dividing e by the second and sixth
equation of 12.10, sin i by the fourth and ﬁfth, and esin i by the third, it follows that
Da ¼ Dda;
De ¼ Dde1
ae
þ Dde2
ae ;
Dx ¼ Ddx1
ae
þ Ddx2
a sin i ;
Di ¼ Ddi1
a sin i þ Ddi2
a sin i ;
DX ¼ DdX
a sin i ;
DM ¼ DdM1 þ DdM2
ae :
ð12:11Þ
The equations at 12.11 are the solutions of 12.8 in the case of non-singularity.
The problem happens only in the case of singularity, i.e. e and/or sin i (≈i)
approaching zero. Dividing any extremely small number could disproportionally
amplify the error in the result (lead to singularity), and this must be avoided.
To summarize, the singularity-free intermediate solutions of 12.10 can be
obtained by the solutions of the basic Lagrangian equations. Then, in the singularity-
free case, the ﬁnal solutions 12.11 of the Lagrangian equations of motion can be
formed. Thus the problem now is how to form the ﬁnal solutions from the inter-
mediate solutions in cases of singularities. Several criteria are deﬁned and introduced
to distinguish the type of the singularity and to decide how to form the related ﬁnal
solutions in different singular cases from Eq. 12.10, which are described in Xu
(2012a, b) in reasonable and rigorous detail.
12.2.3
Xu’s Criteria for Singularity
Deﬁne radial and equatorial biases as (Xu and Xu 2012, 2013b)
ee ¼ ae;
ei ¼ a sin i:
ð12:12Þ
Here the radial bias ae is the distance between the orbital geometric centre O and
the geocentre O′ (see Fig. 12.2). The expression of the satellite radius can be
expanded to order e for the case of f = 0; it holds that (Bronstein and Semendjajew
1987; Wang et al. 1979)
r ¼ að1  e2Þ
1 þ e cos f  að1  e cos f Þ 
f ¼0 a  ae:
ð12:13Þ
Hence, ae is also the maximal radius correction (error) which could be caused
by e. The equatorial bias asin i ≈ai is the maximal distance of the satellite vertical
to the equator which could be caused by i (inclination i is the maximal latitude of
the satellite and is a small angle). At the initial time of integration t0 = 0, e and/or
i are approaching zero, and therefore, at the integration time t, the correction of e is
Δe and the correction of i is Δi. Thus Eq. 12.12 turns out to be
418
Chapter 12  Singularity-Free Orbit Theory

ee ¼ ae ¼ aDe;
ei ¼ a sin i  aD sin i  aDi:
ð12:14Þ
An orbital bias can be deﬁned as follows:
eo ¼ aðDx þ DMÞ;
for circular orbit
eo ¼ aðDX þ DxÞ;
for equatorial orbit
eo ¼ aðDX þ Dx þ DMÞ;
for circular and equatorial orbit
:
ð12:15Þ
eo has the meaning of the maximal bias in the orbital motion direction, which could
be caused by DX; Dx; DM. Therefore, the radial, equatorial, and orbital biases are
the maximal orbit errors in the three related components. The three biases represent
the maximal error area of the orbit caused by the disturbance of (e, ω, i, Ω, M).
In practice, for a required orbital precision (standard deviation or sigma) of 0.33 m,
εe, εi, and εo are ca. 1 m (three sigma), respectively. This means that εe, εi, and εo are
predeﬁned numbers which can be used as criteria.
Similarly we can deﬁne
eM ¼ aDM;
for non - singular orbit
ex ¼ aDx;
for non - singular orbit
eX ¼ aDX;
for non - singular orbit
:
They are the biases caused by changes in satellite mean anomaly, satellite perigee,
and ascending node of the satellite, respectively.
12.2.4
Derivation of Lagrange-Xu Equations of Motion
The perturbed equation of motion of a satellite or a planet is described by Newton’s
second law in an inertial Cartesian coordinate system as (Kaula 1966, 2001; Xu and
Xu 2013b; Brouwer and Clemence 1961; Chobotov 1991; Herrick 1972; Vallado
2007)
d
dt xj ¼ _xj;
j ¼ 1; 2; 3
d
dt _xj ¼ @V
@xj
;
j ¼ 1; 2; 3
:
ð12:16Þ
Here, V is the potential function of the force. The time derivatives of the position
and velocity components x and _x in the above left-hand side can be expressed as
functions of the rates of change of the Keplerian elements (a, e, ω, i, Ω, M) (they are
the semi-major axis, the eccentricity of the ellipse, the argument of perigee, the
12.2  On the Singularity Problem in Orbital Mechanics
419

inclination angle, the right ascension of the ascending node, and the mean anomaly,
and will be represented generally by sk). It then yields
X
6
k¼1
@xj
@sk
d
dt sk ¼ _xj;
j ¼ 1; 2; 3
X
6
k¼1
@_xj
@sk
d
dt sk ¼ @V
@xj
;
j ¼ 1; 2; 3
:
ð12:17Þ
Multiplying the ﬁrst equation of 12.17 by  @_xj
@sl and the second by @xj
@sl and then
adding them together for index j, one has
X
6
k¼1
X
3
j¼1
 @_xj
@sl
@xj
@sk
þ @xj
@sl
@_xj
@sk

 d
dt sk ¼
X
3
j¼1
 @_xj
@sl
_xj þ @xj
@sl
@V
@xj


;
ð12:18Þ
i.e.
X
6
k¼1
sl; sk
½
 d
dt sk ¼ @F
@sl
:
ð12:19Þ
where Lagrange brackets sl; sk
½
 and the term on the right-hand side are deﬁned by
sl; sk
½
 ¼
X
3
j¼1
 @_xj
@sl
@xj
@sk
þ @xj
@sl
@_xj
@sk


@F
@sl
¼
X
3
j¼1
 @
@sl
ð_x2
j =2Þ þ @V
@sl
¼ @ðV  TÞ
@sl

 :
ð12:20Þ
where F is called force function and T the kinetic energy
T ¼
X
3
j¼1
ð_x2
j =2Þ:
ð12:21Þ
Take the following relations into account (Kaula 1966, 2001, Xu and Xu 2013b)
~r
_~r
 
¼ R3ðXÞR1ðiÞR3ðxÞ ~q
_~q


¼ R ~q
_~q


ð12:22Þ
420
Chapter 12  Singularity-Free Orbit Theory

~q ¼
aðcos E  eÞ
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
0
0
@
1
A ¼
r cos f
r sin f
0
0
@
1
A
ð12:23Þ
_~q ¼
 sin E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos E
0
0
@
1
A
na
1  e cos E ¼
 sin f
e þ cos f
0
0
@
1
A
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 ¼ e2
p
ð12:24Þ
@~r
@ðX; i; xÞ ¼
@R
@ðX; i; xÞ~q
and
@ _~r
@ðX; i; xÞ ¼
@R
@ðX; i; xÞ
_~q;
ð12:25Þ
@~r
@ða; e; MÞ ¼ R
@~q
@ða; e; MÞ
and
@ _~r
@ða; e; MÞ ¼ R
@ _~q
@ða; e; MÞ ;
ð12:26Þ
where
@~q
@ða; e; MÞ ¼
cos E  e
a sin2 E
1e cos E  a
a sin E
1e cos E
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin 2E
2ð1e cos EÞ  e sin E
1e2


a ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
cos E
1e cos E
0
0
0
0
B
@
1
C
A
ð12:27Þ
and
@ _~q
@ða; e; MÞ ¼
n sin E
2ð1e cos EÞ
na sin Eðe2 cos E þ e cos2 EÞ
ð1e cos EÞ3
naðecos EÞ
ð1e cos EÞ3
n ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
cos E
2ð1e cos EÞ
na 1 þ e22e cos E þ sin2 Eðe cos E2Þ
½

ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
ð1e cos EÞ3
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
sin EÞ
ð1e cos EÞ3
0
0
0
0
B
B
@
1
C
C
A
ð12:28Þ
Here the left-hand side of 12.22 are position and velocity vectors in the Cartesian
coordinate system; the left-hand sides of 12.23–12.24 are the position and velocity
vectors in the orbital ellipse; R with indices are the rotational matrices around the
index related axis; R without index is the product of the three rotational matrices.
E and f are eccentric anomaly and true anomaly, respectively. n is the mean angular
velocity.
From the deﬁnition of the Lagrange bracket 12.20, one has properties of
sl; sk
½
 ¼  sk; sl
½

and
sl; sl
½
 ¼ 0:
ð12:29Þ
12.2  On the Singularity Problem in Orbital Mechanics
421

Noting that the Lagrange bracket ½sl; sk is time-invariant (Kaula 2000), or
@
@t ½sl; sk ¼
X
3
j¼1
 @2_xj
@sl@t
@xj
@sk
 @_xj
@sl
@2xj
@sk@t þ @2xj
@sl@t
@_xj
@sk
þ @xj
@sl
@2_xj
@sk@t


¼
X
3
j¼1
@
@sl
@xj
@t
@_xj
@sk
 @_xj
@t
@xj
@sk


þ @
@sk
@xj
@sl
@_xj
@t  @_xj
@sl
@xj
@t




¼
X
3
j¼1
@
@sl
_xj
@_xj
@sk
 @xj
@sk
€xj


þ @
@sk
@xj
@sl
€xj  @_xj
@sl
_xj




¼
X
3
j¼1
@
@sl
@ð_x2
j =2Þ
@sk
 
!
 @
@sl
@xj
@sk
€xj


þ @
@sk
@xj
@sl
€xj


 @
@sk
@ð_x2
j =2Þ
@sl
 
!
 
!
¼
X
3
j¼1
 @
@sl
@xj
@sk
@ðl=rÞ
@xj


þ @
@sk
@xj
@sl
@ðl=rÞ
@xj




¼
X
3
j¼1
 @
@sl
@ðl=rÞ
@sk


þ @
@sk
@ðl=rÞ
@sl




¼ 0
ð12:30Þ
Therefore, the Lagrange bracket ½sl; sk can be computed, for example, at the
perigee, or E = 0. Then non-zero Lagrange brackets are
½X; i ¼ na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
½X; a ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i na=2
½X; e ¼ na2e cos i
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
½x; a ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na=2
½x; e ¼ na2e=
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
½a; M ¼ na=2
:
ð12:31Þ
Then we have 12.19 in forms of
½sl; a d
dt a þ ½sl; e d
dt e þ ½sl; x d
dt x þ ½sl; i d
dt i þ ½sl; X d
dt X þ ½sl; M d
dt M þ @F
@sl
l ¼ 1; 2; 3; 4; 5; 6
ð12:32Þ
Of special note, a Lagrange bracket ½sl; sk ¼ 0 means that the time derivative of
the Kepler element sk has nothing to do with the partial derivative of the force
function F with respect to the element sl.
422
Chapter 12  Singularity-Free Orbit Theory

For all sl one has the non-singular equation system (Xu et al. 2014a, b)
½a; x d
dt x þ ½a; X d
dt X þ ½a; M d
dt M ¼ @F
@a ;
ð12:33Þ
½e; x d
dt x þ ½e; X d
dt X ¼ @F
@e ;
ð12:34Þ
½x; a d
dt a þ ½x; e d
dt e ¼ @F
@x ;
ð12:35Þ
½i; X d
dt X ¼ @F
@i ;
ð12:36Þ
½X; a d
dt a þ ½X; e d
dt e þ ½X; i d
dt i ¼ @F
@X ;
ð12:37Þ
½M; a d
dt a ¼ @F
@M :
ð12:38Þ
From 12.38, it yields
d
dt a ¼ 2
na
@F
@M :
ð12:39Þ
From 12.36 one has
sin i d
dt X ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@F
@i :
ð12:40Þ
Substituting 12.39 into 12.35, one has
½x; a 2
na
@F
@M þ ½x; e d
dt e ¼ @F
@x ;
ð12:41Þ
i.e.
e d
dt e ¼ 1
na2
ð1  e2Þ @F
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@F
@x


;
ð12:42Þ
or
d
dt
e2
2


¼ 1
na2
ð1  e2Þ @F
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@F
@x


:
ð12:43Þ
12.2  On the Singularity Problem in Orbital Mechanics
423

Reformulating 12.37 using 12.39 and 12.31, as well as 12.43, yields
½X; a 2
na
@F
@M  na2 cos i
1
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
d
dt ðe2=2Þ þ ½X; i d
dt i ¼ @F
@X ;
ð12:44Þ
i.e.
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @F
@M  cos i
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@F
@M  @F
@x


þ ½X; i d
dt i ¼ @F
@X ;
ð12:45Þ
or
cos i @F
@x  na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i d
dt i ¼ @F
@X ;
ð12:46Þ
i.e.
sin i d
dt i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @F
@x  @F
@X


:
ð12:47Þ
or
d
dt cos i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @F
@x  @F
@X


:
ð12:48Þ
From 12.34 and 12.40, one has
e sin i dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
sin i @F
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e @F
@i
ð12:49Þ
From 12.33 one has

ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
2
d
dt x 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i na
2
d
dt X  na
2
d
dt M ¼ @F
@a ;
ð12:50Þ
i.e.
d
dt M ¼ 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
d
dt x 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i d
dt X ¼ 2
na
@F
@a :
ð12:51Þ
Taking into account 12.40 and 12.49, it yields
e d
dt M ¼ ne  e 2
na
@F
@a  1  e2
na2
@F
@e :
ð12:52Þ
424
Chapter 12  Singularity-Free Orbit Theory

Equations 12.40, 12.49, and 12.52 are the motion equations in common
non-singular case.
We denote (here the energy conservative relation is used)
F ¼ V  T ¼ l
r þ R  T ¼ l
2a þ R;
ð12:53Þ
where function R is called the disturbing potential, including all terms of V except
the central term μ/r (note that here we redeﬁned R). μ is the gravitational constant of
the earth. Hence, in all the above Eqs. 12.39, 12.40, 12.43, 12.48, 12.49, and 12.53,
F can be replaced by R and become (Kepler’s third law is used)
da
dt ¼ 2
na
@R
@M
d
dt
e2
2


¼ 1
na2
ð1  e2Þ @R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@x


e sin i dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
sin i @R
@e 
e cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@i
d
dt cos i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


sin i dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@i
e dM
dt ¼ ne  2e
na
@R
@a  1  e2
na2
@R
@e
:
ð12:54Þ
Equation 12.54 is the solution to the equation system 12.33–12.38. An important
contribution of Xu and Xu (2012) is that the second and fourth equations of 12.54
will never be singular. Lagrange equations of motion in common non-singular case
(i.e. sin i 6¼ 0 and e 6¼ 0) are then
da
dt ¼ 2
na
@R
@M
d
dt
e2
2


¼ 1
na2
ð1  e2Þ @R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@x


dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
d
dt cos i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
dM
dt ¼ n  2
na
@R
@a  1  e2
na2e
@R
@e
ð12:55Þ
12.2  On the Singularity Problem in Orbital Mechanics
425

Xu and Xu noted in 2012 that using e2 and cos i as variables instead of e and i,
would lead the second and fourth Lagrange equations of motion 12.55 to be
singularity-free (Xu and Xu 2012, 2013b). According to orbital geometry (cf.
Fig. 3.4 in Sect. 3.1.1) and different singular cases, for circular orbit (e = 0),
(implicit sin i 6¼ 0), the perigee is ambiguous, and a new M0 which denotes the
angle between satellite and ascending node should be redeﬁned as
M0 ¼ M þ x
ð12:56Þ
For equatorial orbit (sin i = 0), (implicit e 6¼ 0), the ascending node is ambiguous,
and a new x0 which denotes the angle between perigee and vernal equinox should be
redeﬁned as
x0 ¼ X þ x
ð12:57Þ
For circular and equatorial orbit (e = 0 and sin i = 0), a new M00 which denotes
the angle between satellite and vernal equinox should be redeﬁned as
M00 ¼ M þ x þ X
ð12:58Þ
For simplicity, we deﬁne
h ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 1  e2
ð
Þ
e
¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p


e
0
@
1
A¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
p


ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1 þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
p
0
@
1
A:
ð12:59Þ
Using a mathematical expansion formula, it yields (truncation to e4)
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 1  e2
2  e4
8 ;
ð12:60Þ
and therefore,
h  e 4  e2
ð
Þ
8
:
ð12:61Þ
We note that this factor h will never be singular in the case of e = 0. We further
note that
1  cos i
sin i
¼ tan i
2 :
ð12:62Þ
426
Chapter 12  Singularity-Free Orbit Theory

In cases of singularity, the singularity-free equations of motion should be as
follows (Chunhua Jiang and Yan Xu contributed in part to the following
derivations):
1. In the case of circular singularity (e = 0), (implicit sin i 6¼ 0), we have
dM
dt þ dx
dt ¼n  2
na
@R
@a  1  e2
na2e
@R
@e þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
¼ n  2
na
@R
@a 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ h
na2
@R
@e
ð12:63Þ
Therefore, the motion equations in the case of circular singularity can be formed
as
d
dt a ¼ 2
na
@R
@M
d(e2=2Þ
dt
¼ 1  e2
na2
@R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
@R
@x
d cos i
dt
¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
dM0
dt ¼ n  2
na
@R
@a 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ h
na2
@R
@e
;
ð12:64Þ
which are singularity-free in the case of circular orbit and are called general
Lagrange-Xu singularity-free equations of motion.
2. In the case of equatorial singularity (sin i = 0), (implicit e 6¼ 0), we have
dX
dt þ dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
1  cos i
sin i
@R
@i
¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
ð12:65Þ
Therefore, the motion equations in the case of equatorial singularity can be
formed as
12.2  On the Singularity Problem in Orbital Mechanics
427

d
dt a ¼ 2
na
@R
@M
d(e2=2Þ
dt
¼ 1  e2
na2
@R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
@R
@x
d cos i
dt
¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dM
dt ¼ n  2
na
@R
@a  1  e2
na2e
@R
@e
dx0
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
;
ð12:66Þ
which are singularity-free in the case of equatorial orbit and are called general
Lagrange-Xu singularity-free equations of motion.
3. In the case of circular and equatorial singularity (sin i = 0 and e = 0), we have
dM
dt þ dx
dt þ dX
dt ¼ n  2
na
@R
@a  1  e2
na2e
@R
@e þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
¼ n  2
na
@R
@a þ h
na2
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
ð12:67Þ
Therefore, the motion equations in the case of circular and equatorial singularity
can be formed as
d
dt a ¼ 2
na
@R
@M
d(e2=2Þ
dt
¼ 1  e2
na2
@R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2
@R
@x
dcosi
dt
¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dM00
dt
¼ n  2
na
@R
@a þ h
na2
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
ð12:68Þ
which are singularity-free in the case of circular and equatorial orbit and are
called general Lagrange-Xu singularity-free equations of motion.
The above derivations of Eqs. 12.64, 12.66, and 12.68 are the so-called Lagrange-Xu
singularity-free equations of motion in different singular cases (Xu and Xu 2012, 2013b).
The derivations are rigorous and mathematically exact. Thus, the Lagrange-Xu
singularity-free equations of motion can be summarized as follows, as Eq. 12.69:
428
Chapter 12  Singularity-Free Orbit Theory

da
dt ¼ 2
na
@R
@M
d
dt
e2
2


¼ 1
na2
ð1  e2Þ @R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@x


d
dt cos i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
ðif e 6¼ 0 and sin i 6¼ 0Þ
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
ðif e 6¼ 0 and sin i 6¼ 0Þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
ðif e 6¼ 0 and sin i ¼ 0Þ
8
>
>
>
<
>
>
>
:
dM
dt ¼
n  2
na
@R
@a  1  e2
na2e
@R
@e
ðif e 6¼ 0 and sin i 6¼ 0Þ
n  2
na
@R
@a 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ h
na2
@R
@e
ðif e ¼ 0 and sin i 6¼ 0Þ
n  2
na
@R
@a þ h
na2
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
ðif e ¼ 0 and sin i ¼ 0Þ
8
>
>
>
>
>
>
>
<
>
>
>
>
>
>
>
:
ð12:69Þ
12.2.5
Derivation of Gauss Equations from Lagrange Equations
As discussed in Sect. 12.2.4, the Lagrange equations of motion in common
non-singular case (i.e. sin i 6¼ 0 and e 6¼ 0) are
da
dt ¼ 2
na
@R
@M
d
dt
e2
2


¼ 1
na2
ð1  e2Þ @R
@M 
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
@R
@x


dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
d
dt cos i ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
cos i @R
@x  @R
@X


dX
dt ¼
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i
dM
dt ¼ n  2
na
@R
@a  1  e2
na2e
@R
@e
ð12:70Þ
Here, R is the disturbing potential function. The Keplerian elements (a, e, ω, i, Ω,
M, f) are the semi-major axis, the eccentricity of the ellipse, the argument of
12.2  On the Singularity Problem in Orbital Mechanics
429

perigee, the inclination angle, the right ascension of ascending node, the mean
anomaly, and the true anomaly, respectively.
The partial derivatives of the Keplerian elements can be represented as (Xu et al.
2015a, b)
@R
@a ¼ r
a fr
@R
@e ¼ a cos f  fr þ r sin f
1  e2 ð2 þ e cos f Þ  fa
@R
@i ¼ r sin u  fh
@R
@X ¼ r cos i  fa  r sin i cos u  fh
@R
@x ¼ r  fa
@R
@M ¼
ae
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin f  fr þ að1 þ e cos f Þ
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fa
ð12:71Þ
Here, (fr, fα, fh)T is a force vector in an orbital plane coordinate system; the ﬁrst two
components are in the orbital plane, fr is the radial component, fα is the component
perpendicular to fr and points in the direction of the satellite motion. Furthermore,
the Keplerian variables have the following relationships:
r ¼ að1  e2Þ
1 þ e cos f ¼ að1  e cos EÞ
r cos f ¼ aðcos E  eÞ
r sin f ¼ a
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin E
ð12:72Þ
Here E is the eccentric anomaly. Substituting Eqs. 12.71 and 12.72 into 12.70, it
yields
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

dðe2=2Þ
dt
¼ e
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos f þ cos EÞ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


 cos ið1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
dX
dt ¼ ð1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
dM
dt ¼ n  1  e2
nae
 cos f þ
2e
1 þ e cos f


 fr þ ð2 þ e cos f Þ sin f
1 þ e cos f
 fa


ð12:73Þ
430
Chapter 12  Singularity-Free Orbit Theory

Therefore, the Gaussian equations of motion in the common non-singular case
(i.e. sin i 6¼ 0 and e 6¼ 0) of Eq. 12.73 are derived.
12.2.6
Derivation of Gauss-Xu Equations of Motion
On the basis of the derivation of Lagrange-Xu singularity-free equations of motion
in Sect. 12.2.4, Gauss-Xu singularity-free equations of motion in different singular
cases can be similarly derived as follows (cf. Xu et al. 2015a, b). For simplicity, we
deﬁne h the same as mentioned in Sect. 12.2.4. Chunhua Jiang and Yan Xu con-
tributed part to the following derivations.
1. In the case of circular singularity (e = 0), (implicit sin i 6¼ 0), we have
dM
dt þ dx
dt ¼ n  2
na
@R
@a 
cos i
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
@R
@i þ h
na2
@R
@e
¼ n 
2ð1  e2Þ
nað1 þ e cos f Þ  fr  cos ið1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
þ h
na
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


¼ n 
2ð1  e2Þ
nað1 þ e cos f Þ þ h
na cos f


 fr þ 2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ
 fa
 cos ið1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
ð12:74Þ
Therefore, the motion equations in the circular singularity case can be formed as
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

dðe2=2Þ
dt
¼ e
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos f þ cos EÞ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dX
dt ¼ ð1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
dM0
dt ¼ n 
2ð1  e2Þ
nað1 þ e cos f Þ þ h
na cos f


 fr þ 2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ
 fa
 cos ið1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
ð12:75Þ
12.2  On the Singularity Problem in Orbital Mechanics
431

which are singularity-free in the case of circular orbit and are called general
Gauss-Xu singularity-free equations of motion.
2. In the case of equatorial singularity (sin i = 0), (implicit e 6¼ 0), we have
dX
dt þ dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na2e
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


þ 1  e cos E
ð
Þ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2  fh
ð12:76Þ
Therefore, the motion equations in the case of equatorial singularity can be
formed as
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

dðe2=2Þ
dt
¼ e
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos f þ cos EÞ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dM
dt ¼ n  1  e2
nae
 cos f þ
2e
1 þ e cos f


 fr þ ð2 þ e cos f Þ sin f
1 þ e cos f
 fa


dx0
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa


þ 1  e cos E
ð
Þ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2  fh
ð12:77Þ
which are singularity-free in the case of equatorial orbit and are called general
Gauss-Xu singularity-free equations of motion.
3. In the case of circular and equatorial singularity (sin i = 0 and e = 0), we have
dM
dt þ dx
dt þ dX
dt ¼ n  2
na
@R
@a þ h
na2
@R
@e þ
1
na2
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2
@R
@i
¼ n 
2ð1  e2Þ
nað1 þ e cos f Þ þ h
na cos f


 fr þ 2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ
 fa
þ 1  e cos E
ð
Þ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2  fh
ð12:78Þ
432
Chapter 12  Singularity-Free Orbit Theory

Therefore, the motion equation in circular and equatorial singularity case can be
formed as
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

dðe2=2Þ
dt
¼ e
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos f þ cos EÞ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dM00
dt ¼ n 
2ð1  e2Þ
nað1 þ e cos f Þ þ h
na cos f


 fr þ 2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ
 fa
þ 1  e cos E
ð
Þ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
tan i
2  fh
ð12:79Þ
which are singularity-free in the case of circular and equatorial orbit and are
called general Gauss-Xu singularity-free equations of motion.
The above derivations of Eqs. 12.75, 12.77, and 12.79 are the so-called
Gauss-Xu singularity-free equations of motion in different singular cases. The
derivations are rigorous and mathematically exact. Thus, the Gauss-Xu singularity-
free equations of motion can be summarized as follows as Eq. 12.80:
da
dt ¼
2
n
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
e sin f  fr þ ð1 þ e cos f Þ  fa
½

dðe2=2Þ
dt
¼ e
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
na
sin f  fr þ ðcos f þ cos EÞ  fa
½

di
dt ¼ ð1  e cos EÞ cos u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
 fh
dX
dt ¼ ð1  e cos EÞ sin u
na
ﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃﬃ
1  e2
p
sin i
 fh
ðif e 6¼ 0 and sin i 6¼ 0Þ
dx
dt ¼
ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa
h
i
 cos ið1e cos EÞ sin u
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
sin i
 fh
ðif e 6¼ 0 and sin i 6¼ 0Þ
ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
nae
 cos f  fr þ 2 þ e cos f
1 þ e cos f sin f  fa
h
i
þ
1e cos E
ð
Þ sin u
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
tan i
2  fh
ðif e 6¼ 0 and sin i ¼ 0Þ
8
>
<
>
:
dM
dt ¼
n  1e2
nae
ð cos f þ
2e
1 þ e cos fÞ  fr þ ð2 þ e cos f Þ sin f
1 þ e cos f
 fa
h
i
ðif e 6¼ 0 and sin i 6¼ 0Þ
n 
2ð1e2Þ
nað1 þ e cos f Þ þ h
na cos f
h
i
 fr þ
2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ  fa  cos ið1e cos EÞ sin u
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
sin i
 fh
ðif e ¼ 0 and sin i 6¼ 0Þ
n 
2ð1e2Þ
nað1 þ e cos f Þ þ h
na cos f
h
i
 fr þ
2 þ e cos f
ð
Þh sin f
na 1 þ e cos f
ð
Þ  fa þ
1e cos E
ð
Þ sin u
na ﬃﬃﬃﬃﬃﬃﬃﬃ
1e2
p
tan i
2  fh
ðif e ¼ 0 and sin i ¼ 0Þ
8
>
>
>
>
<
>
>
>
>
:
ð12:80Þ
12.2  On the Singularity Problem in Orbital Mechanics
433

12.3
Bridge Between Analytical Theory and Numerical
Integration
In 2010, Tianhe Xu worked as a visiting scientist at the GFZ with GXu, and is the
second author of two very important papers concerning extraterrestrial gravitational
disturbances and atmospheric drag on satellite orbits (Xu et al. 2010a, b) using
so-called basic Lagrangian and Gaussian equations of motion. He then applied
these in orbital analytical solutions. However, the theoretical integrals and nu-
merical integration showed certain large differences. Either the theoretical integrals
were wrong by derivation, or the numerical integration was wrong. But both
mistakes seemed to be impossible: the theoretical integrals were not wrong by
derivation, and the numerical integration was not wrong. A bridge between ana-
lytical theory and numerical integration was needed so that the analytical theory
could be used to obtain the same results as those using numerical integration.
It took two years for GXu to understand the reason for the difference. By
numerical integration, the variables are updated by every integration step, whereas
by theoretical integration they are not. With this insight, GXu discussed organising
PhD studies for these topics with Wu Chen. In 2012, Jing Qiao started her study
with Wu Chen at Hong Kong Polytech University and is expected to ﬁnish part of
her PhD thesis with GXu at Shandong University. In 2016, Jing Qiao was able to
demonstrate how to use the derived analytical solutions in Xu and Xu (2013a, b) to
compute the comparable results obtained by numerical integrator. Thus, for the ﬁrst
time in the history of celestial mechanics, analytical solutions could be used for
orbit determination and orbit optimization.
It worth to note that the navigation and remote sensing as well as celestial
mechanics team of Shandong University at Weihai is making several progresses on
the satellite orbit-related topics. The so-called Xu’s algebra solution of the variation
equation (Xu 2007 Chap. 11.5.1) is proved to have good performance in practice by
Wenfeng Nie and Yujun Du. Jing Qiao contributed greatly for how to use the
analytical solution to obtain comparable results with that of numerical integration.
Chunhua Jiang contributed largely for the singularity-free problem. Fangzhao
Zhang worked out ﬁrst timely the inﬂuences of the precession and nutation as well
as polar motion on the Kepler elements. Nan Jiang is using the Gauss-Xu
singularity-free equations for BeiDou GEO satellite orbits maneuver detection and
determination. Wenfeng Nie is working on using Xu’s solar radiation and atmo-
sphere drag models for precise orbits determination.
434
Chapter 12  Singularity-Free Orbit Theory

References
Aarseth SJ (2003) Gravitational N-Body simulations Tools and Algorithms, Cambridge University
Press
Aarseth SJ, Tout CA, Mardling RA (2008) The Cambridge N-Body Lectures, Springer
Heidelsberg
Barrow-Green J (1996) Poincare and the Three Body Problem, Amer. Math. Soc.
Battin R.H. (1999) An Introduction to the Mathematics and Methods of Astrodynamics, revised
version, AIAA Education Series
Bernoulli JI (1710) Extrait de la réponse de M. Bernoulli à M. Hermann, datée de Basle le 7
Octobre 1710 Joh. B. Op LXXXVI. Both letters were published in the Mémoires de 1’Ac
Royale des Sciences, Boudot, Paris
Boccaletti D, Pucacco G (1998) Theory of Orbits (two volumes). Springer-Verlag
Boccaletti D, Pucacco G (2001) Theory of Oribts, Vol. 1: Integrable systems and non-perturbative
methods; Vol. 2: Perturbative and geometrical methods, Springer Berlin
Bronstein
IN,
Semendjajew
KA
(1987)
Taschenbuch
der
Mathematik.B.
G.
Teubner
Verlagsgesellschaft, Leipzig, ISBN 3-322-00259-4
Brouwer D, Clemence GM (1961) Methods of celestial mechanics. Academic Press, New York
Chobotov VA (ed) (1991) Orbital mechanics. Published by AIAA, Washington
Cui C (1990) Die Bewegung künstlicher Satelliten im anisotropen Gravitationsfeld einer
gleichmässig rotierenden starren Modellerde. Deutsche Geodätische Kommission, Reihe C:
Dissertationen, Heft Nr. 357
Cui C (1997) Satellite orbit integration based on canonical transformations with special regard to
the resonance and coupling effects. Dtsch Geod Komm bayer Akad Wiss, Reihe A, Nr. 112,
128 pp
Delaunay (1860) Mem. De l’des Sci. 28
Delaunay (1867) Mem. De l’des Sci. 29
Diacu, F (1992) Singularities of the N-Body Problem, Les Publications CRM, Montreal
Diacu F (1996) The solution of the n-body problem, The Mathematical Intelligencer, 1996, 18,
p. 66–70
Diacu F, Holmes P (1996) Celestial Encounters: The origins or chaos and stability, Princeton
University Press, Princeton, NJ
Dvorak R, Lhotka C (2013) Celestial dynamics – chaoticity and dynamics of celestial systems,
Wiley, Weinheim
Eberle J, Cuntz M, Musielak ZE (2008) The instability trasition for the restricted 3-body problem -
I. Theoretical approach, Astronomy & Astrophysics, Vol. 489 No.3
Euler L (1767) Nov. Comm. Acad. Imp. Petropolitanae, 10, pp207-242, 11, pp152-184; Memories
de IAcad. De Berlin, 11, 228-249
Goldstein H (1980) Classical Mechanics (2nd Ed), New York, Addison-Wesley
Hagihara, Y: Celestial Mechanics. (Vol I and Vol II pt 1 and Vol II pt 2.) MIT Press, 1970
Havel K (2008) N-Body Gravitational Problem: Unrestricted Solution, Brampton: Grevyt Press,
2008
Herrick S (1972) Astrodynamics, Vol. II. Van Nostrand Reinhold, London
Kaula WM (2000) Theory of satellite geodesy: applications of satellites to geodesy. Courier
Corporation
Kaula WM (1966, 2001) Theory of satellite geodesy. Blaisdell Publishing Company, Dover
Publications, New York
Kaula WM (2001) Theory of satellite geodesy. Blaisdell Publishing Company, Dover
Publications, New York
Lagrange JL (1772) Miscellanea Taurinensia, 4, 118-243; Oeuvres, 2, pp67-121; Mechanique
Analytique, 1st Ed, pp262-286; 2nd Ed, 2, pp108-121; Oeuvres, 12, pp101-114
Landau LD, Lifshitz EM (1976) Mechanics (3rd Ed), New York, Pergamon Press
Liu L, Zhao D (1979) Orbit theory of the Earth satellite. Nanjing University Press, (in Chinese)
References
435

Mittag-Lefﬂer G. The n-body problem (Price Announcement), Acta Matematica, 1885/1886, 7
Newton I(1687): Philosophiae Naturalis Principia Mathematica, London, 1687: also English
translation of 3rd (1726) edition by I. Bernard Cohen and Anne Whitman (Berkeley, CA, 1999)
Poincare (1892) Les Methodes Nouevelles de la Mechanique ce’leste Guthier villars, Paris,
Chap. V, p. 250, (published in English in three volumes)
Poincare H (1992) New Methods of Celestial Mechanics, AIP
Schneider M, Cui CF (2005) Theoreme über Bewegungsintegrale und ihre Anwendung in
Bahntheorien, Bayerischen Akad Wiss, Reihe A, Heft Nr. 121, 132pp, München
Shapiro II (1962) The prediction of satellite orbits, in IUTAM Symposium Paris 1962, M Roy
(ed) Dynamics of Satellites
Sundman K (1906) Recherches sur le problème des trois corps, Acta Soc. Sei. Fenn. 34
Sundman K (1909) Nouvelles recherches sur le problème des trois corps, Acta Soc. Sei. Fenn. 35
Sundman KE (1912) Memoire sur le probleme de trois corps, Acta Mathematica 36 (1912):
105–179.
Tisserand F-F (1894) Mecanique Celeste, tome III (Paris, 1894), ch.III, at p. 27
Vallado David A (2007) Fundamentals of Astrodynamics and Applications (3rd Ed), Microcosm
Press & Springer
Van Kamp PD (1967) Principles of Astronomy. W.H. Freemann and Company, San Francisco,
CA/London
Wang QD (1991) The global solution of the n-body problem (Celestial Mechanics and Dynamical
Astronomy (ISSN 0923-2958), vol. 50, no. 1, 1991, p. 73–88., URI retrieved on 2007-05-05)
Wang LX, Fang ZD, Zhang MY, Lin GB, Gu LK, Zhong TD, Yang XA, She DP, Luo ZH,
Xiao BQ, Chai H, Lin DX (1979) Mathematic handbook. Educational Press, Peking, ISBN
13012-0165
Wnuk E (1990) Tesseral harmonic perturbations in the Keplerian orbital elements, Acta.
Astronomica Vol.40, No.1-2, p.191-198
Xia ZH (1992) The existence of noncollision singularities in Newtonian system, Annals Math.
135(3): 411–468
Xu (2013b) Private communication with an editor of MNRAS concerning two submitted papers
and the decision letters of MNRAS editorial board (for review available upon request
gcxu@sdu.edu.cn)
Xu G (2008) Orbits, Springer Heidelberg, ISBN 978-3-540-78521-7, 230 pages, in English
Xu G (2010) Analytic Orbit Theory, chapter 4 in G Xu (Ed) Sciences of Geodesy - I, Advances
and Future Directions, Springer, pp 105-154
Xu G (2010) (Ed.): Sciences of Geodesy - I, Advances and Future Directions, Springer Heidelberg,
chapter topics (authors): Aerogravimetry (R Forsberg), Superconducting Gravimetry (J
Neumeyer), Absolute and Relative Gravimetry (L Timmen), Deformation and Tectonics (L
Bastos et al.), Analytic Orbit Theory (G Xu), InSAR (Y Xia), Marine Geodesy (J Reinking),
Kalman Filtering (Y Yang), Equivalence of GPS Algorithms (G Xu et al.), Earth Rotation (F
Seitz, H Schuh), Satellite Laser Ranging (L Combrinck), in English, 507 pages
Xu Y (2012) Studies on Antarctic GNSS Precise Positioning. Chang’an University. Xi’an, China
Xu G (2012) (Ed.): Sciences of Geodesy - II, Advances and Future Directions, Springer
Heidelberg, chapter topics (authors): General Relativity and Space Geodesy (L Comblinck),
Global Terrestrial Reference Systems and their Realizations (D Angermann et al), Ocean Tide
Loading (M Bos, HG Scherneck), Photogrammetry (P Redweik), Regularization and
Adjustment (Y Shen, G Xu), Regional Gravity Field Modelling (H Denker), VLBI (H
Schuh, J Boehm), in English, 400 pages
Xu G, Xu J (2012) On the Singularity Problem of Orbital Mechanics, MNRAS, 2013, Vol.429,
pp1139-1148
Xu G, Xu J (2013a) On Orbital Disturbance of Solar Radiation, MNRAS, 432 (1): 584-588 doi:10.
1093/mnras/stt483
Xu G, Xu J (2013b) Orbits – 2nd Order Singularity-free Solutions, second edition, Springer
Heidelberg, ISBN 978-3-642-32792-6, 426 pages, in English
436
Chapter 12  Singularity-Free Orbit Theory

Xu G, Xu TH, Yeh TK, Chen W (2010a) Analytic Solution of Satellite Orbit Perturbed by Lunar
and Solar Gravitation, MNRAS, Vol. 410, Issue 1, pp 645-653
Xu G, Xu TH, Chen W, Yeh TK (2010b) Analytic Solution of Satellite Orbit Perturbed by
Atmospheric Drag, MNRAS, Vol. 410, Issue 1, pp 654-662 87.
Xu Y, Yang Y, Zhang Q, Xu G (2011) Solar Oblateness and Mercury’s Perihelion Precession,
MNRAS, Vol. 415, 3335-3343
Xu G, Lv ZP, Shen YZ, Yeh TK (2014) A mathematical derivation of singularity-free Lagrange
equations of planetary motion, Special issue for celebration 80th birthday of academician
Houze Xu, Journal of Surveying and Mapping, 2014 89.
Xu Y, Yang Y, Xu G (2014) Analysis on Tropospheric Delay in Antarctic GPS Positioning.
Journal of Geodesy and Geodynamics, 34(1): pp104-107
Xu G, Chen W, Shen YZ, Jiang N, Jiang CH (2015) A mathematical derivation of singularity-free
Gauss equations of planetary motion, Special issue for celebration 70th birthday of Prof Jikun
Ou, Journal of Surveying and Mapping, 2015
Xu Y, Jiang N, Xu G, Yang Y, Schuh H (2015) Inﬂuence of meteorological data and horizontal
gradient of tropospheric model on precise point positioning. Adv. Space Res. 56(11),
pp2374-2383
References
437

Chapter 13
Discussions
The previous chapters of this book covered the most important material regarding
static, kinematic, and dynamic GPS, including theory, algorithms, and applications.
At the end of the book, the authors will emphasize, discuss, and comment on some
important topics and remaining problems with GPS.
13.1
Independent Parameterisation and A Priori Information
A Priori Information
As discussed earlier with regard to the parameterisation of the GPS observation
model (Sects. 9.1 and 9.2), clock errors and instrumental biases, as well as ambi-
guities, are partially over-parameterised or linearly correlated (related to and
between themselves). Generally speaking, cancelling the over-parameterised
unknowns out of the equation or modelling them ﬁrst and then keeping them
ﬁxed using the a priori method (Sect. 7.8) will be equivalent. As long as one knows
which parameters should be kept ﬁxed, the a priori information used is true, and is
just used as a tool for ﬁxing the parameters to zero. If the model is not parame-
terised regularly, and one does not know exactly which parameters are
over-parameterised, then the normal equation will be singular and cannot be solved.
Again, using a priori information may make the equation solvable. However, in this
case, the a priori information has the meaning of direct “measures” on the related
parameters. Therefore, the a priori information used must be true and reasonable;
otherwise, the given a priori information will affect the solution in unreasonable
ways. If different a priori information is given, different results will be obtained.
Therefore, the a priori information used should be based on true information.
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6_13
439

Independent Parameterisation of the Observation Model
A priori information can be obtained from external surveys or from the expe-
rience of long-term data processing that does not use a priori information. A regular
(independent) parameterisation of the GPS observation model is a precondition for
a stable solution of a normal equation without using a priori information. As
mentioned above, parameterising the model independently and ﬁxing the
over-parameterised unknowns are equivalent. However, in order to keep some
parameters ﬁxed, one must know which parameters are over-parameterised and
need to be ﬁxed. Therefore, in any case, one must understand how to parameterise
the GPS observation model in a regular manner. Fixing the over-parameterised
unknowns after a general parameterisation is equivalent to a direct independent
parameterisation. Therefore, regular parameterisation of the GPS observation model
is important.
Inseparability of Some of the Bias Effects
Independent parameterisation is necessary because of the linear correlation of
some parameters. The linear correlation party merges the different effects so that
they cannot be exactly separated from each other. The constant parts of the different
effects are nearly impossible to separate without precise physical models, whereas
many model parameters are presented in the GPS observation equation and have to
be codetermined. The inseparability of the bias effects comes partly from the
physics of the surveys and is dependent on the survey strategy. Understanding the
inseparability of the bias effects is important in designing surveys. The physical
models must be determined more precisely in order to separate the constant parts of
the effects.
Change in the Physical Meaning of the Parameters
Because of the linear correlation and inseparability of some parameters, the
parameters that are to be adjusted may change their physical meaning. For example,
the instrumental biases of the reference frequency and channel are linearly corre-
lated with the clock errors. This indicates that these biases cannot be modelled
separately so that the clock error parameters represent the summation of the clock
errors and the related instrumental biases. They may be separated only through
extra surveys or alternative models. If the clock errors of the reference satellite and
receiver are not adjusted, then the other clock errors represent the relative errors
between the other clocks and the reference clocks. If the other instrumental biases
are not modelled, they will be partially absorbed into the ambiguities. In this case,
the ambiguities represent not only the ambiguities, but also part of the instrumental
biases, such that the ambiguities are no longer integers. The double difference may
eliminate the instrumental biases so that the double-differenced ambiguities are free
from the effects of instrumental biases, whereas the undifferenced ambiguities
include those biases. If the instrumental errors are not modelled, the undifferenced
ambiguities are no longer integers, whereas the double-differenced ambiguities are
integers (no data combinations are considered here).
440
Chapter 13  Discussions

Zero Setting and Fixing of the Parameters
Setting a parameter to zero or ﬁxing the parameter to a deﬁnite value must be
done carefully. Any incorrect setting or ﬁxing is similar to a linear transformation
(translation) of the linearly correlated parameters. For example, the clock errors and
instrumental biases of the reference station and satellite are generally not zero.
Keeping the clock errors and instrumental biases of the reference as zero is similar
to carrying out a time system translation with an unknown amount, and such a
translation is inhomogeneous, because the orbit data are given in the GPS time
system. External surveys may help for a correct zero setting.
Independent Parameterisation of Physical Models
Independent parameterisation of the bias parameters of the GPS observation
model indicates the need for further study of the parameterisation problem. As long
as the parameters of the physical models must be codetermined by the GPS ob-
servation equations, parameterisation of the physical models should be investigated
with great care.
13.2
Equivalence of the GPS Data Processing Algorithms
Equivalence Principle
For deﬁnitive measurement and parameterisation of the observation model, the
uncombined and combining algorithms, undifferenced and differencing algorithms,
and their mixtures are equivalent. The results must be identical and the precision
equivalent. The practical results should obey this principle.
The equivalence comes from the deﬁnite information contents of the surveys and
the deﬁnitive parameterisation of the observation model. For better results or better
precision of the results, better measurements are necessary.
Traditional Combinations
Under traditional parameterisation, the combinations are equivalent. Under
independent parameterisation, the combinations are also equivalent. However, the
combinations under the traditional parameterisation and independent parameteri-
sation are not equivalent. Because of the inexactness of traditional parameterisation,
traditional combinations will lead to inexact results.
Traditional Differencing Algorithms
Traditional differencing algorithms usually take into account only the differ-
encing equations and leave the undifferenced part aside. In this way, the differ-
encing part of equations includes fewer parameters and the systematic effects are
13.1  Independent Parameterisation and A Priori Information
441

reduced. Meanwhile, however, the information content of the observables is also
reduced proportionally. The results of the parameters of interest remain the same.
Equivalent Algorithms
Equivalent algorithms are general forms of undifferenced and differencing
algorithms. The observation equation can be separated into two diagonal parts.
Each part uses the original observation vector (therefore the original weight matrix);
however, the equation possesses only a part of the unknown parameters. The
normal equation of the original observation equation can also be separated into two
parts. This indicates that any solvable adjustment problem can be separated into two
sub-problems.
13.3
Other Comments
Data Communication in Real-Time GNSS Positioning
Real-time GNSS positioning technology has become a fast, efﬁcient navigation
tool that can yield survey-grade coordinates for use in a variety of applications. One
of the most important rules for real-time positioning is that a robust communication
link is needed for acquiring the data from the rover station or corrections to the
observables at the base station (as in relative positioning methodology). When
considering data communication, there are several methods to choose from. The use
of radios is one option, which is robust, but its range of communication can be
limited, especially in urban areas where interference and frequency usage are high.
On the other hand, wireless data modems are typically CDMA (Code Division
Multiple Access), GSM (Global System for Mobile communications), and GPRS
(General
Packet
Radio
Service)
communication
formats
using
TCP/IP
(Transmission Control Protocol/Internet Protocol) over cellular provider net-
works. This will allow longer ranges in the case of good cell coverage areas.
Maintaining a strong, continuous communication link for data communication in
real-time GNSS positioning can still be a challenge.
Indoor Positioning
Indoor positioning has become a focus of research and development over the
past decade, and has been widely applied in many areas, such as indoor
location-based service (LBS). It is apparent that the widely used GNSS performs
poorly within indoor environments due to signal outages. Technologies using FM
radios,
radars,
cellular
networks,
DETC
phones,
WLAN,
ZigBee,
RFID,
ultra-wideband, high-sensitivity GNSS, and pseudolite systems have been devel-
oped. The integration of different techniques in a multi-sensor positioning system is
another solution in indoor positioning. However, the indoor environment lacks a
system that can provide excellent performance with high accuracy, short latency,
442
Chapter 13  Discussions

high availability, high integrity, and low user costs like GNSS in outdoor envi-
ronments. Current capable indoor positioning systems have different levels of
accuracy, and the provision of global indoor positioning at a low cost and with
accuracy of 1 m is far from a reality. Many indoor positioning applications are still
waiting for a satisfactory solution.
13.3  Other Comments
443

Appendix A
IAU 1980 Theory of Nutation
Table A.1 The units of Ai and Bi are 0.″0001, units of Ai′ and Bi′ are 0.″00001 (cf. McCarthy
1996)
Coefﬁcients of
Values of
l
l′
F
D
Ω
Ai
Ai′
Bi
Bi′
0
0
0
0
1
−171996
−1742
92025
89
0
0
2
−2
2
−13187
16
5736
−31
0
0
2
0
2
−2274
−2
977
−5
0
0
0
0
2
2062
2
−895
5
0
−1
0
0
0
−1426
34
54
−1
1
0
0
0
0
712
1
−7
0
0
1
2
−2
2
−517
12
224
−6
0
0
2
0
1
−386
−4
200
0
1
0
2
0
2
−301
0
129
−1
0
−1
2
−2
2
217
−5
−95
3
−1
0
0
−2
0
158
0
−1
0
0
0
2
−2
1
129
1
−70
0
−1
0
2
0
2
123
0
−53
0
1
0
0
0
1
63
1
−33
0
0
0
0
2
0
63
0
−2
0
−1
0
2
2
2
−59
0
26
0
−1
0
0
0
1
−58
−1
32
0
1
0
2
0
1
−51
0
27
0
−2
0
0
2
0
−48
0
1
0
−2
0
2
0
1
46
0
−24
0
0
0
2
2
2
−38
0
16
0
2
0
2
0
2
−31
0
13
0
1
0
2
−2
2
29
0
−12
0
2
0
0
0
0
29
0
−1
0
0
0
2
0
0
26
0
−1
0
0
0
2
−2
0
−22
0
0
0
(continued)
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6
445

Table A.1 (continued)
Coefﬁcients of
Values of
l
l′
F
D
Ω
Ai
Ai′
Bi
Bi′
−1
0
2
0
1
21
0
−10
0
0
2
0
0
0
17
−1
0
0
−1
0
0
2
1
16
0
−8
0
0
2
2
−2
2
−16
1
7
0
0
1
0
0
1
−15
0
9
0
1
0
0
−2
1
−13
0
7
0
0
−1
0
0
1
−12
0
6
0
2
0
−2
0
0
11
0
0
0
−1
0
2
2
1
−10
0
5
0
1
0
2
2
2
−8
0
3
0
0
0
2
2
1
−7
0
3
0
0
−1
2
0
2
−7
0
3
0
0
1
2
0
2
7
0
−3
0
1
1
0
−2
0
−7
0
0
0
1
0
2
−2
1
6
0
−3
0
0
0
0
2
1
−6
0
3
0
2
0
2
−2
2
6
0
−3
0
1
0
0
2
0
6
0
0
0
−2
0
0
2
1
−6
0
3
0
2
0
2
0
1
−5
0
3
0
1
−1
0
0
0
5
0
0
0
0
0
0
−2
1
−5
0
3
0
0
−1
2
−2
1
−5
0
3
0
0
0
0
1
0
−4
0
0
0
1
0
−2
0
0
4
0
0
0
0
1
0
−2
0
−4
0
0
0
1
0
0
−1
0
−4
0
0
0
0
1
2
−2
1
4
0
−2
0
2
0
0
−2
1
4
0
−2
0
0
−1
2
2
2
−3
0
1
0
3
0
2
0
2
−3
0
1
0
−1
−1
2
2
2
−3
0
1
0
1
−1
2
0
2
−3
0
1
0
1
0
2
0
0
3
0
0
0
1
1
0
0
0
−3
0
0
0
1
−1
0
−1
0
−3
0
0
0
−2
0
2
0
2
−3
0
1
0
−1
0
2
4
2
−2
0
1
0
0
0
2
1
2
2
0
−1
0
(continued)
446
Appendix A: IAU 1980 Theory of Nutation

Table A.1 (continued)
Coefﬁcients of
Values of
l
l′
F
D
Ω
Ai
Ai′
Bi
Bi′
3
0
0
0
0
2
0
0
0
1
0
0
0
2
−2
0
1
0
2
0
0
0
1
2
0
−1
0
−1
0
2
−2
1
−2
0
1
0
1
1
2
0
2
2
0
−1
0
−2
0
0
0
1
−2
0
1
0
0
−2
2
−2
1
−2
0
1
0
0
1
0
1
0
1
0
0
0
0
0
2
4
2
−1
0
0
0
2
0
0
2
0
1
0
0
0
1
0
−2
2
0
−1
0
0
0
1
1
0
−2
1
−1
0
0
0
0
−1
2
0
1
−1
0
0
0
1
0
−2
−2
0
−1
0
0
0
0
1
0
2
0
−1
0
0
0
0
0
2
−1
2
−1
0
0
0
0
0
−2
0
1
−1
0
0
0
−1
−1
0
2
1
1
0
0
0
0
1
2
0
1
1
0
0
0
1
0
2
−2
0
−1
0
0
0
3
0
2
−2
2
1
0
0
0
0
0
4
−2
2
1
0
0
0
1
0
0
2
1
−1
0
0
0
2
0
2
2
2
−1
0
0
0
2
0
2
−2
1
1
0
−1
0
1
−1
0
−2
0
1
0
0
0
−1
0
4
0
2
1
0
0
0
−2
0
2
4
2
−1
0
1
0
1
0
2
2
1
−1
0
1
0
1
1
2
−2
2
1
0
−1
0
2
0
0
−4
0
−1
0
0
0
−2
0
2
2
2
1
0
−1
0
1
0
0
−4
0
−1
0
0
0
−1
0
0
0
2
1
0
−1
0
0
1
2
−2
0
−1
0
0
0
−1
0
0
1
1
1
0
0
0
0
1
0
0
2
1
0
0
0
0
1
−2
2
0
−1
0
0
0
0
0
−2
2
1
1
0
0
0
(continued)
Appendix A: IAU 1980 Theory of Nutation
447

Table A.1 (continued)
Coefﬁcients of
Values of
l
l′
F
D
Ω
Ai
Ai′
Bi
Bi′
2
1
0
−2
0
1
0
0
0
2
0
−2
0
1
1
0
0
0
448
Appendix A: IAU 1980 Theory of Nutation

Appendix B
Numerical Examples
of the Diagonalisation of the Equations
As discussed in Sect. 8.3.7, a normal equation can be diagonalised and the related
observation equation can be formed.
For the linearised observation equation (cf. Eq. 8.38)
V ¼ L  A1
A2
ð
Þ
X1
X2


; P;
ðB:1Þ
the least squares normal equation can be written as (cf. Eqs. 8.39 and 8.40)
M11
M12
M21
M22


X1
X2


¼
W1
W2


;
ðB:2Þ
where
AT
1PA1
AT
1PA2
AT
2PA1
AT
2PA2
 
!
¼
M11
M12
M21
M22


¼ M;
M1 ¼ Q ¼
Q11
Q12
Q21
Q22


;
W1 ¼ AT
1PL;
W2 ¼ AT
2PL;
ðB:3Þ
The normal Eq. B.2 can be diagonalised as (cf. Eq. 8.41)
M1
0
0
M2


X1
X2


¼
B1
B2


ðB:4Þ
where
M1 ¼ M11  M12M1
22 M21 and
B1 ¼ W1  M12M1
22 W2
ðB:5Þ
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6
449

M2 ¼ M22  M21M1
11 M12
B2 ¼ W2  M21M1
11 W1
;
ðB:6Þ
The above diagonalisation process can be repeated r −1 times to the second
normal equation of Eq. B.4, so that the second equation of Eq. B.4 can be fully
diagonalised and Eq. B.4 can be represented as:
M1
0
0
M
0
2


X1
X2


¼
B1
B
0
2


;
ðB:7Þ
where M'2 is a diagonal matrix, r is the dimension of X2, and B'2 is a vector.
Normal Eq. B.4 related observation equation is (cf. Eq. 8.43)
U1
U2


¼
L
L



D1
0
0
D2


X1
X2


;
P
0
0
P


;
ðB:8Þ
where
D1 ¼ ðE  IÞA1;
D2 ¼ ðE  JÞA2;
and
ðB:9Þ
I ¼ A2M1
22 AT
2P;
J ¼ A1M1
11 AT
1P;
ðB:10Þ
where E is an identity matrix, and U1 and U2 are residual vectors which have the
same property as V in Eq. B.1.
By similarly repeating the above process r −1 times to the observation equation
of X2 (i.e. the second equation of Eq. B.8), then Eq. B.8 turns out to have the form
U1
U
0
2


¼
L
L
0



D1
0
0
D
0
2


X1
X2


;
P
0
0
P
0


;
ðB:11Þ
where D'2 is in a form of a diagonal matrix where all elements are vectors of
dimension r, P' is a diagonal matrix of P, L' is a vector of L, and U'2 is a residual
vector that has the same property as V in Eq. B.1. Equation B.11 is the observation
equation of normal Eq. B.7.
Numerical examples to illustrate the diagonalisation process of the normal
equation and observation equation are given below.
1. The Case of Two Variables
For the observation equation (where σ is set to 1, which does not affect all results)
V1
V2
V3
0
@
1
A ¼
1
2
1
0
@
1
A 
1
1
1
2
1
1
0
@
1
A
X1
X2


;
P ¼ 1
r2
1
0
0
0
1
0
0
0
1
0
@
1
A;
ðB:12Þ
450
Appendix B: Numerical Examples of the Diagonalisation of the Equations

the least squares normal equation is
3
4
4
6


X1
X2


¼
2
4


:
ðB:13Þ
Because
M1 ¼ 34 1=6
ð
Þ4 ¼ 1=3;
B1 ¼ 24 1=6
ð
Þ4 ¼ 2=3;
and
M2 ¼ 64 1=3
ð
Þ4 ¼ 2=3;
B2 ¼ 44 1=3
ð
Þ2 ¼ 4=3;
Eq. B.13 is diagonalised as
1=3
0
0
2=3


X1
X2


¼
2=3
4=3


:
ðB:14Þ
The solution (X1 = −2, X2 = 2) of Eq. B.14 is the same as that of Eq. B.13.
Furthermore, to form the equivalent observation equation, there are
M11 ¼ AT
1A1 ¼
1
1
1
ð
Þ
1
1
1
0
B
@
1
C
A ¼ 3;
M22 ¼ AT
2A2 ¼
1
2
1
ð
Þ
1
2
1
0
B
@
1
C
A ¼ 6;
I ¼
1
2
1
0
B
@
1
C
A 1
6 1
2
1
ð
Þ ¼ 1
6
1
2
1
2
4
2
1
2
1
0
B
@
1
C
A;
J ¼
1
1
1
0
B
@
1
C
A 1
3 1
1
1
ð
Þ ¼ 1
3
1
1
1
1
1
1
1
1
1
0
B
@
1
C
A;
D1 ¼ ðE  IÞA1 ¼ 1
6
5
2
1
2
2
2
1
2
5
0
B
@
1
C
A
1
1
1
0
B
@
1
C
A ¼ 1
3
1
1
1
0
B
@
1
C
A;
and,
D2 ¼ ðE  JÞA2 ¼ 1
3
2
1
1
1
2
1
1
1
2
0
B
@
1
C
A
1
2
1
0
B
@
1
C
A ¼ 1
3
1
2
1
0
B
@
1
C
A;
thus, the observation equation related to Eq. B.14 is
U1
U2


¼
1
2
1
0
@
1
A
1
2
1
0
@
1
A
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A

1
3
1
1
1
0
@
1
A
031
031
1
3
1
2
1
0
@
1
A
0
B
B
B
B
B
B
@
1
C
C
C
C
C
C
A
X1
X2


;
P
0
0
P


:
ðB:15Þ
Appendix B: Numerical Examples of the Diagonalisation of the Equations
451

The normal equation of the observation Eq. B.15 is exactly the same as
Eq. B.14. This numerical example shows that the normal equation and the related
observation equation can be diagonalised.
2. The Case of Three Variables
For the observation equation (where σ is set to 1, which does not affect all results)
V1
V2
V3
V4
0
B
B
@
1
C
C
A ¼
2
1
0
2
0
B
B
@
1
C
C
A 
1
1
1
2
1
1
1
1
2
1
1
1
0
B
B
@
1
C
C
A
X1
X2
X3
0
@
1
A;
P ¼ 1
r2 E44;
ðB:16Þ
the least squares normal equation is
7
5
6
5
4
5
6
5
7
0
@
1
A
X1
X2
X3
0
@
1
A ¼
2
1
1
0
@
1
A:
ðB:17Þ
Because
M1
22 ¼
4
5
5
7

1
¼ 1
3
7
5
5
4


;
M1
11 ¼ 1
7 ;
M1 ¼ 7  5
6
ð
Þ 1
3
7
5
5
4


5
6


¼ 2
3 ;
B1 ¼ 2  5
6
ð
Þ 1
3
7
5
5
4


1
1


¼ 2
3 ;
M2 ¼
4
5
5
7



5
6

 1
7 5
6
ð
Þ ¼ 1
7
3
5
5
13


and
B2 ¼
1
1



5
6

 1
7  2 ¼ 1
7
3
5


;
ðB:18Þ
Eq. B.17 is diagonalised as
2=3
0
0
0
3=7
5=7
0
5=7
13=7
0
@
1
A
X1
X2
X3
0
@
1
A ¼
2=3
3=7
5=7
0
@
1
A:
ðB:19Þ
The X2 and X3 related normal equation can be further diagonalised. Because of
M
0
1 ¼ 3=7  5ð1=13Þð5=7Þ ¼ 2=13;
B
0
1 ¼ 3=7  5ð1=13Þð5=7Þ ¼ 2=13;
M
0
2 ¼ 13=7  5ð1=3Þð5=7Þ ¼ 2=3;
B
0
2 ¼ 5=7  5ð1=3Þð3=7Þ ¼ 0;
452
Appendix B: Numerical Examples of the Diagonalisation of the Equations

Eq. B.19 is further diagonalised as
2=3
0
0
0
2=13
0
0
0
2=3
0
@
1
A
X1
X2
X3
0
@
1
A ¼
2=3
2=13
0
0
@
1
A:
ðB:20Þ
The solution (X1 = 1, X2 = −1, X3 = 0) of Eq. B.20 is the same as that of
Eqs. B.17 and B.19. Furthermore, to form the equivalent observation equation of
Eq. B.19, there are
I ¼
1
1
1
1
1
2
1
1
0
B
B
B
@
1
C
C
C
A
1
3
7
5
5
4


1
1
1
1
1
1
2
1


¼ 1
3
1
1
0
1
1
1
0
1
0
0
3
0
1
1
0
1
0
B
B
B
@
1
C
C
C
A;
J ¼
1
2
1
1
0
B
B
B
@
1
C
C
C
A
1
7 1
2
1
1
ð
Þ ¼ 1
7
1
2
1
1
2
4
2
2
1
2
1
1
1
2
1
1
0
B
B
B
@
1
C
C
C
A;
D1 ¼ ðE  IÞA1 ¼ 1
3
1
2
0
1
0
B
B
B
@
1
C
C
C
A
and
D2 ¼ ðE  JÞA2 ¼ 1
7
2
1
3
5
2
8
2
1
0
B
B
B
@
1
C
C
C
A;
thus the observation equation related to Eq. B.19 is
U1
U2


¼
L
L



D1
0
0
D2


X1
X2
X3
0
@
1
A;
P
0
0
P


;
where
L ¼
2
1
0
2
0
B
B
@
1
C
C
A:
ðB:21Þ
Appendix B: Numerical Examples of the Diagonalisation of the Equations
453

The X2 and X3 related observation equation can be further diagonalised as fol-
lows. Because
I0 ¼ 1
7
1
5
8
1
0
B
B
B
@
1
C
C
C
A
7
13  1
7 1
5
8
1
ð
Þ ¼ 1
91
1
5
8
1
5
25
40
5
8
40
64
8
1
5
8
1
0
B
B
B
@
1
C
C
C
A;
J0 ¼ 1
7
2
3
2
2
0
B
B
B
@
1
C
C
C
A
7
3  1
7 2
3
2
2
ð
Þ ¼ 1
21
4
6
4
4
6
9
6
6
4
6
4
4
4
6
4
4
0
B
B
B
@
1
C
C
C
A;
and
D0
21 ¼ A0
1  I0A0
1 ¼ 1
7
2
3
2
2
0
B
B
B
@
1
C
C
C
A 
1
7  91
35
175
280
35
0
B
B
B
@
1
C
C
C
A ¼ 1
13
3
2
2
3
0
B
B
B
@
1
C
C
C
A;
D0
22 ¼ A0
2  J0A0
2 ¼ 1
7
1
5
8
1
0
B
B
B
@
1
C
C
C
A 
1
21  7
70
105
70
70
0
B
B
B
@
1
C
C
C
A ¼ 1
3
1
0
2
1
0
B
B
B
@
1
C
C
C
A;
the observation equation related to Eq. B.20 is
U1
U
0
2
U
0
3
0
@
1
A ¼
L
L
L
0
@
1
A 
D1
0
0
0
D
0
21
0
0
0
D
0
22
0
@
1
A
X1
X2
X3
0
@
1
A;
P
0
0
0
P
0
0
0
P
0
@
1
A:
ðB:22Þ
The normal Eq. B.17 and its related observation Eq. B.16 are fully diagonalised
as Eqs. B.20 and B.22, respectively. These numerical examples show that the
normal equation and the related observation equation can be diagonalised as
described in Sect. 8.3.7.
454
Appendix B: Numerical Examples of the Diagonalisation of the Equations

References
Abidin HZ (1995) GPS and hydro-oceanographic surveying in Indonesia. Int J Geomatics 9(4):35–
37
Abidin HZ et al. (2004) The deformation of Bromo volcano as detected by GPS surveys method.
J. GPS 3(1-2): 16-24
Abramowitz M, Stegun IA (1965) Handbook of mathematical functions. Dover Publications, Inc.,
New York
Adami D, Garroppo RG, Giordano S, Lucetti S (2003) On synchronization techniques:
Performance and impact on time metrics monitoring. Int. J. Comm. Syst. 16(4): 273-290
Afraimovich EL, Kosogorov EA, Leonovich LA (2000) The use of the international GPS network
as the global detector (GLOBDET) simultaneously observing sudden ionospheric disturbance.
Earth Planets Space 52(11):1077–1082
Akos DM (2003) The role of Global Navigation Satellite System (GNSS) software radios in
embedded systems. GPS Solutions 7(1): 1-4
Al-HaiﬁY, Corbett S, Cross P (1997) Performance evaluation of GPS single-epoch on-the-ﬂy
ambigu-ity resolution. J Inst Navig 44,4:479–487
Albertella A, Sacerdote F (1995) Spectral analysis of block averaged data in geopotential global
model determination. J Geodesy 70,3:166–175
Andersen PH, Kristiansen O, Zarraoa N (1995) Analysis of data from the VLBI-GPS collocation
ex-periment CONT94. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne
Applications: 21st IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–
4, 1995, Springer-Verlag, Berlin, pp 315–319
Angermann D, Becker M (2000) Untersuchungen zu Genauigkeit und systematischen Effekten in
großräumigen GPS-Netzen am Beispiel von GEODYSSEA. ZfV 125(3):88–95
Angermann D, Baustert G, Klotz J (1995) The impact of IGS on the analysis of regional GPS-
network. In: GPS Trends in Precise Terrestrial Airborne, and Spaceborne Applications: 21st
IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995, Springer-
Verlag, Berlin, pp 35–41
Arikan F, Erol CB, Arikan O (2003) Regularized estimation of vertical total electron content from
Global Positioning System data. J. Geophys. Res. 108(A12): SIA20/1-12
Arnold D, Meindl M, Beutler G, Dach R, Schaer S, Lutz S, Prange L, Sosnica K, Mervart L,
Jaeggi A (2015) CODE’s new solar radiation pressure model for GNSS orbit determination.
J Geodesy 89(8), pp775-791
Artese G, Cefalo R, Vettore A (1997) Real time kinematic GPS to bathymetry. Rep Geod 5
(28):77–87
Ashkenazi V, Beamson G, Bingley R (1995) Monitoring absolute changes in mean sea level. In:
Pro-ceedings of the First Turkish International Symposium on Deformations “Istanbul-94”,
Istanbul, September 5–9, pp 40–46
Ashkenazi V, Park D, Dumville M (2000) Robot positioning and the global navigation satellite
system. Ind Robot 27(6):419–426
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6
455

Aw York Bin, Goh Pong Chai (1996) Improving cadastral survey controls using GPS surveying in
Singapore. Survey rev 33:488–495
Axelsson O (1994) Iterative Solution Methods. Cambridge University Press, London/New York
Ayres F (1975) Differential- und Integralrechnung, Schaum’s Outline. McGraw-Hill Book , New
York
Babu R (2005) Web-based resources on software GPS receivers. GPS Solutions 9(3): 240-242
Baertlein H, Carlson B, Eckels R, Lyle S, Wilson S (2000) A high-performance, high-accuracy
RTK GPS machine guidance system. GPS Solutions 3(3):4–11
Bailey Brian K (2014) GPS Modernization Update. June 2014.
Baldi P, Bonvalot S, Briole P, Marsella M (2000) Digital photogrammetry and kinematic GPS
applied to the monitoring of Vulcano Island, Aeolian Arc, Italy. Geophys J Int 142(3):801–811
Balmino G, Schrama E, Sneeuw N (1996) Compatibility of ﬁrst-order circular orbit perturbations
theories: Consequences for cross-track inclination functions. J Geodesy 70(9):554–561
Banyai L, Gianniou M (1997) Comparison of Turbo-Rogue and Trimble SSI GPS receivers for
iono-spheric investigation under anti-spooﬁng. ZfV 3:136–142
Bar-Sever YE (1996) A new model for GPS yaw attitude. J Geodesy 70:714-723
Barthelmes F (1996) Die Wavelet-Transformation zur Zeitreihenanalyse. Erste Geodätische
Woche, Stuttgart, 7.–12. Oktober 1996, 15 Blatt
Bastos L, Landau H(1988) Fixing cycle slips in dual-frequency kinematic GPS-application using
Kalman ﬁltering. Manuscr Geodaet 13:249–256
Bastos L, Osorio J, Hein G (1995) GPS derived displacements in the Azores Triple Junction
Region. In: GPS Trends in Precise Terrestrial Airborne, and Spaceborne Applications: 21st
IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995, Springer-
Verlag, Berlin, pp 99–104
Baugh CM (2006) A Primer on Hierarchical Galaxy Formation: the Semi-Analytical Approach,
Reports on Progress in Physics, Vol 69, Issue 12, p3101-3156
Bause
F,
Toelle
W
(1993)
Programmieren
mit
C++,
Version
3.
Vieweg
&
Sohn,
Verlagsgesellschaft mbH, Braunschweig
Becker M, Angermann D, Nordin S, Reigber C, Reinhart E (2000) Das Geschwindigkeitsfeld in
Südostasien aus einer kombinierten GPS Lösung der drei GEODYSSEA Kampagnen von 1994
bis 1998. ZfV 125(3):74–80
Berrocoso M, Garate J, Martin J (1996) Improving the local geoid with GPS. In: Proceedings of
the Techniques for local geoid determination, session G7 European Geophysical Society XXIst
General Assembly The Hague, The Netherlands, 6–10 May, 1996, Masala, pp 91–96
Beutler G (1994) GPS trends in precise terrestrial, airborne, and space borne applications.
Springer-Verlag, Heidelberg
Beutler G (1996) GPS satellite orbits. In Kleusberg A, Teunissen PJG (eds) GPS for geodesy.
Springer-Verlag, Berlin
Beutler G (1996) The GPS as a tool in global geodynamics. In: Kleusberg A, Teunissen PJG (eds)
GPS for geodesy. Springer-Verlag, Berlin
Beutler G, Brockmann E, Hugentobler U (1996) Combining consecutive short arcs into long arcs
for precise and efﬁcient GPS orbit determination. J Geodesy 70,5:287–299
Beutler G, Schildknecht T, Hugentobler U, Gurtner W (2003) Orbit determination in satellite
geodesy. Adv. Space Res. 31(8): 1853-1868
Beyerle G, Wickert J, Schmidt T, Reigber C (2004) Atmos. sounding by global navigation satellite
system radio occultation: An analysis of the negative refractivity bias using CHAMP
observations. J. Geophys. Res. 109(D01106): 1-8
Bian S (1996) Topography supported GPS leveling. ZfV 121,3:109–113
Bian S, Jin J, Fang Z (2005) The Beidou satellite positioning system and its positioning accuracy.
Navigation 52(3): 123-129
Bilitza D, Altadill D, Zhang Y, et al. (2014) The International Reference Ionosphere 2012 – a
model of international collaboration. J. Space Weather Space Clim., 4, A07
456
References

Bisnath S, Wells D, Howden S, Dodd D, Wiesenburg D (2004) Development of an operational
RTK GPS-equipped buoy for tidal datum determination. Int. Hydrogr. Rev. 5(1): 54-64
Blanchard D (2012) Galileo Programme Status Update. ION GNSS 2012, November 20, pp553-
587
Blomenhofer H (1996) Untersuchungen zu hochpräzisen kinematischen DGPS-Echtzeitverfahren
mit besonderer Berücksichtigung atmosphärischer Fehlereinﬂüsse. Neubiberg, 166 S
Bock H, Dach R, Jaeggi A, Beutler G (2009) High-rate GPS clock corrections from CODE:
support of 1 Hz applications. J Geodesy 83:1083
Bock Y (1996) Reference systems. In: Kleusberg A, Teunissen PJG (eds) GPS for geodesy.
Springer-Verlag, Berlin
Bock Y (1996) Medium distance GPS measurements. In: Kleusberg A, Teunissen PJG (eds) GPS
for geodesy. Springer-Verlag, Berlin
Bock Y, Beutler G, Schaer S, Springer TA, Rothacher M (2000) Processing aspects related to
permanent GPS arrays. Earth Planets Space 52(10):657–662
Bock Y, Prawirodirdjo L, Melbourne TI (2004) Detection of arbitrarily large dynamic ground
motions with a dense high-rate GPS network. Geophys. Res. Lett. 31(L06604): 1-4
Boehme S (1970) Zum Einﬂuß eines Quadrupolmoments der Sonne auf die Bahnlage der Planeten,
Astron. Nachr., Bd. 292, H. 1
Boey SS, Coombe LJ, Gerdan GP (1996) Assessing the accuracy of real time kinematic GPS
positions for the purposes of cadastral surveying. Aust Surveyor 41,2:109–120
Bona P (2000) Precision, cross correlation, and time correlation of GPS phase and code
observations. GPS Solutions 4(2):3–13
Boomkamp H, Dow J (2005) Use of double difference observations in combined orbit solutions for
LEO and GPS satellites. Adv. Space Res. 36(3): 382-391
Borge TK, Forssell B (1994) A new real time ambiguity resolution strategy based on polynomial
indentiﬁcation, In: Proceedings of the International Symposium on Kinematic Systems in
Geod-esy, Geomatics and Navigation, Banff, Canada, 30 August–2 September, pp 233–240
Borre K (2003) The GPS Easy Suit-Matlab code for the GPS newcomer. GPS Solutions 7(1): 47-
51
Borre K, Akos DM, Bertelsen N, Rinder P, Jensen SH (2007) A Software-Deﬁned GPS and
Galileo Receiver, A Single-Frequency Approach, Birkhaüser, Boston, M.A. ISBN 978-0-8176-
4390-4
Bosco M (2011) The European GNSS Programmes EGNOS and Galileo International Challenges
Ahead. November 23, 2011.
Bottke WF, Cellino A, Paolicchi P, Binzel RP (ed 2002) Asteroids III, Space Science Series,
Univetrsity of Arizona Press
Bouin M-N, Vigny C (2000) New constraints on Antarctic plate motion and deformation from
GPS data. J Geophys Res 105(B12):28279–28293
Boulton WJ, 1983, The effect of solar radiation pressure on the orbit of a cylindrical satellite,
Planet. Space Sci. Vol. 32, No. 3, pp. 287-296Bauer M (1994) Vermessung und Ortung mit
Satelliten. Wichmann Verlag, Karslruhe, Germany
Brodin G, Cooper J, Walsh D, Stevens J (2005) The effect of helicopter rotors on GPS signal
reception. J. Navig. 58(3): 433-450
Broederbauer V, Weber R (2003) Results of modelling GPS satellite clocks. Osterr. Z. Vermess.
Geoinf. 91(1): 38-47
Brumberg VA (1995) Analytical Techniques of Celestial Mechanics, Springer
Brunner FK (1998) Advances in positioning and reference frames. Springer-Verlag, Heidelberg
Brunner FK, Gu M (1991) An improved model for the dual frequency ionospheric correction of
GPS observations. Manuscr Geodaet 16:205–214
Brunner FK, Welsch WM (1993) Effect of the troposphere on GPS measurements. GPS World
4:42–51
Burns JA, Lamy PL, Soter S (1979) Radiation force on small particles in the solar system, Icarus,
Vol 40 p1-48
References
457

Bust GS, Coco D, Makela JJ (2000) Combined Ionospheric Campaign 1: Ionospheric tomography
and GPS total electron content (TEC) depletions. Geophys Res Lett 27(18):2849–2852
Cai C, Gao Y (2013) Modeling and assessment of combined GPS/GLONASS precise point
positioning. GPS Solutions 17(2), 223-236.
Campbell J, Goerres B, Siemens M, Wirsch J, Becker M (2004) Zur Genauigkeit der GPS
Antennenkalibrierung auf der Grundlage von Labormessungen und deren Vergleich mit
anderen Verfahren. Allgemeine Vermessungs-Nachrichten 111(1): 2-11
Campbell L, Moffat JW (1983) Quadrupole Moment of the Sun and the Planetary Orbits,
Astrophysical Journal, 275:L77-L79
Campbell L, Mcdow JC, Moffat JV, Vincent D (1983) The Sun’s quadrupole moment and
perihelion precession of Mercury, Nature, Vol. 305, P508
Campos MA, Krueger CP (1995) GPS kinematic real-time applications in rivers and train. In: GPS
Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General
Assem-bly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin,
pp 222–225
Cangahuala L, Muellerschoen R, Yuan D-N (1995) TOPEX/Poseidon precision orbit determi-
nation with SLR and GPS anti-spooﬁng data. In: GPS Trends in Precise Terrestrial Airborne,
and Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium No. 115,
Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 123–127
Cannon E, Weisenburger S (2000) The use of multiple receivers for constraining GPS carrier
phase ambiguity resolution. Lighthouse 57:7–18
Cannon ME, Skone S, Karunanayake MD, Kassam A (2004) Performance analysis of the real-time
Canada-Wide DGPS Service (CDGPS). Geomatica 58(2): 95-105
Cardellach E, Behrend D, Rufﬁni G, Rius R (2000) The use of GPS buoys in the determination of
oceanic variables. Earth Planets Space 52(11):1113–1116
Casotto S, Zin A (2000) An assessment of the beneﬁts of including GLONASS data in GPS-based
precise orbit determination – I: S/A analysis. Advances in the Astronautical Sciences 105
(1):237–256
Castleden et al. (2004) First results from Virtual Reference Station (VRS) and precise point
positioning (PPP) GPS research at the Western Australian Centre for Geodesy. J. GPS 3(1-2):
79-84
Celebi M (2000) GPS in dynamic monitoring of long-period structures. Soil Dyn Earthq Eng 20
(5–8): 477–483
Celleti A (2010) Stability and Chaos in celestial mechanics, Springer
Chang C-C (2000) Estimation of local subsidence using GPS and leveling data. Surveying and
Land Information Systems 60(2):85–94
Chang C-C, Sun Y-D (2004) Application of a GPS-based method to tidal datum transfer. Hydrogr.
J. 112: 15-20
Chen CS, Chen Y-J, Yeh T-K (2000) The impact of GPS antenna phase center offset and variation
on the positioning accuracy. Bull Geod Sci Afﬁni 59(1):73–94
Chen D (1994) Development of a fast ambiguity search ﬁltering (FASF) method for GPS carrier
phase ambiguity resolution. Reports of the Department of Geomatics Engineering of the
University of Calgary, Vol. 20071
Chen D, Lachapelle G (1994) A comparison of the FASF and least-squares search algorithms for
ambiguity resolution on the ﬂy. In: Proceedings of the International Symposium on Kinematic
Systems in Geodesy, Geomatics and Navigation, Banff, Canada, August 30–September 2, pp
241–253
Chen H, Dai L, Rizos C, Han S (2005) Ambiguity recovery using the triple-differenced carrier
phase type approach for long-range GPS kinematic positioning. Mar. Geod. 28(2): 119-135
Chen W et al. (2004) Kinematic GPS precise point positioning for sea level monitoring with GPS
buoy. J. GPS 3(1-2): 302-307
458
References

Chen X, Langley RB, Dragert H (1995) The Western Canada Deformation Array: An update on
GPS solutions and error analysis. In: GPS Trends in Precise Terrestrial Airborne, and
Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium No. 115, Boulder,
USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 70–74
Chen Y-Q, Wang J-L (1996) Reliability measures for correlated observations. ZfV 121,5:211–219
Chen Y-Q, Ding XL, Huang DF, Zhu JJ (2000) A multi-antenna GPS system for local area
deformation. Earth Planets Space 52(10):873–876
China Satellite Navigation Ofﬁce (2013) Report on the Development of BeiDou (COMPASS)
Navigation Satellite System (V2.2). December 2013.
Christou AA, Asher DJ (2011) A long-lived horseshoe companion to the Earth, MNRAS 414,
2965 - 2969
Clark TA (1995) Low-cost GPS time synchronization: The “Totally Accurate Clock”. In: GPS
Trends in Precise Terrestrial,Airborne, and Spaceborne Applications: 21st IUGG General
Assembly,IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin,
pp 325–327
Collins GW (2004) The foundations of celestial mechanics, Pachart Publishing House
Colombo OL (1984a) Altimetry, orbits and tides. NASA Technical Memorandum 86180
Colombo OL (1984b) The global mapping of gravity with two satellites. Netherlands Geodetic
Commission, Delft, The Netherlands Publications on Geodesy, Vol. 7, No. 3, 253pp
Colombo OL, Rizos C, Hirsch B (1995) Testing high-accuracy, long-range carrier phase DGPS in
Australasia. In: GPS Trends in Precise Terrestrial,Airborne, and Spaceborne Applications: 21st
IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-
Verlag, Berlin, pp 226–230
Colombo OL, Hernández-Pajares M, Juan JM, Sanz J, Talaya J (1999) Resolving carrier-phase
ambigu-ities on the ﬂy, at more than 100 km from nearest reference site, with the help of
ionospheric topography. ION GPS 99 14–17, September 1999, pp 1635–1642
Conway BA (Ed, 2010) Spacecraft Trajectory Optimization, Cambridge University Press
Cooray A, Sheth R (2002) Halo models of large scale structure, Physics Reports, Vol 372, Issue 1,
P1-129
Corbett SJ, Cross PA (1995) GPS single epoch ambiguity resolution. Survey rev 33(257):149–160
Cross PA, Ramjattan AN (1995) A Kalman ﬁlter model for an integrated land vehicle navigation
sys-tem. In: Proceedings of the 3rd international workshop on high precision navigation: High
preci-sion navigation 95. University of Stuttgart, April 1995, Bonn, pp 423–434
Cui C, Lelgemann D (1995) Analytical dynamic orbit improvement for the evaluation of geodetic-
geodynamic satellite data. J Geodesy 70:83–97
Cui X, Yang Y (2006) Adaptively Robust Filtering with Classiﬁed Adaptive Factors. Progress in
Natural Science 16(8):846-851
Dach R, Boehm J, Lutz S, Steigenberger P, Beutler G (2011) Evaluation of the impact of
atmospheric pressure loading modeling on GNSS data analysis. J Geodesy 85(2), pp75-91
Dach R, Dietrich R (2000) Inﬂuence of the ocean loading effect on GPS derived precipitable water
vapor. Geophys Res Lett 27(18):2953–2956
Dam T van, Larson KM, Wahr J, Gross S, Francis O (2000) Using GPS and gravity to infer ice
mass changes in Greenland. EOS Trans. AGU 81(37):421, 426–427
Davis JL, Cosmo ML, Elgered G (1995) Using the Global Positioning System to study the
atmosphere of the Earth: Overview and prospects. In: GPS Trends in Precise Terrestrial,
Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium
No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 233–242
Davis P, Rabinowitz P (1984) Methods of numerical integration, 2nd Ed. Academic Press, INC
Davis PJ (1963) Interpolation and approximation. Dover Publications Inc., New York
Denker
H
(1995)
Grossräumige
Höhenbestimmung
mit
GPS-
und
Schwerefelddaten.
Schriftenreihe des Deutschen Vereins für Vermessungswesen, Bd. 18, Stuttgart, pp 233–258
Desai SD, Haines BJ (2003) Near-real-time GPS-based orbit determination and sea surface height
observations from The Jason-1 mission. Mar. Geod. 26(3-4): 383-397
References
459

Desmars J, Arlot S, Arlot JE, Lainey V, Vienne A (2009) Estimating the accuracy of satellite
ephemrides using the bootstrap method, Astronomy & Astrophysics, Vol. 499 No.1
Dick G (1997) Nutzung von GPS zur Bahnbestimmung niedrigﬂiegender Satelliten. GPS-
Anwendungen und Ergebnisse ’96: Beiträge zum 41. DVW-Fortbildungsseminar vom 7. bis 8.
November 1996 am Geo-Forschungszentrum Potsdam, pp 241–249
Dick G, Gendt G (1997) GPS-Anwendungen und Ergebnisse ’96: Beiträge zum 41. DVW-
Fortbildungs-seminar vom 7. bis 8. November 1996 am Geo-Forschungszentrum Potsdam.
Geodesia: Nederl. geod. t., Stuttgart
Dicke RH (1970) The solar oblateness and the gravitational quadrupole moments, Ap. J. 159, 1-23
Dicke RH, Kuhn JR, Libbrecht KG (1987) Is the solar oblateness variable? Measurements of 1985,
Astrophysical Journal 318: 451-458
Dierendonck AJ Van, Hegarty C (2000) The new L5 civil GPS signal. GPS World 11(9):64–71
Dietrich R (1997) Untersuchung von vertikalen Krustendeformationen wegen wechselnder
Eislauﬂasten in Grönland. GPS-Anwendungen und Ergebnisse ’96: Beiträge zum 41. DVW-
Fortbildungsseminar vom 7. bis 8. November 1996 am Geo-Forschungszentrum Potsdam, pp
94–102
Dietrich R, Rulke A, Scheinert M (2005) Present-day vertical crustal deformations in West
Greenland from repeated GPS observations. Geophys. J. Int. 163(3): 865-874
Diggelen F (1998) GPS accuracy: Lies, damm lies, and statistics. GPS World 9,1:41–44
Diggelen F, Martin W (1997) GPS + GLONASS RTK: A quantum leap in RTK performance. Int J
Geo-matics 11(11):69–71
Ding X, Coleman R (1996) Multiple outlier detection by evaluating redundancy contributions of
observations. J Geodesy 708:489–498
Ding X, Coleman R (1996) Adjustment of precision metrology networks in three dimension.
Survey rev 33,259:305–315
Ding XL et al. (2005) Seasonal and secular positional variations at eight co-located GPS and VLBI
stations. J. Geod. 79(1-3): 71-81
Dittrich J, Kuehmstedt E, Richter B, Reinhart E (1997) Accurate positioning by low frequency
(ALF) and other services for emission of DGPS correction data in Germany. Rep Geod 6
(29):97–108
Dodson AH, Shardlow PJ, Hubbard LCM (1995) Wet tropospheric effects on precise relative GPS
height determination. J Geodesy 70(4):188–202
Douša J (2004): Precise orbits for ground-based GPS meteorology: processing strategy and quality
assessment of the orbits determined at geodetic observatory Pecny. J. Meteor. Soc. Japan 82
(1B): 371-380
Dow JM, Romay-Merino MM, Piriz R (1993) High precision orbits for ERS-1: 3-day and 35-day
repeat cycles. In: Proceedings of the Second ERS-1 symposium: Space at the service of our
environment, Hamburg, 11–14 October 1993, Vol. 2, Jan. 1994, Noordwijk, pp 1349–1354
Dragert H, James TS, Lambert A (2000) Ocean loading corrections for continuous GPS: A case
study at the Canadian coastal site Holberg. Geophys Res Lett 27(14):2045–2048
Drewes H (1996) Kinematische Referenzsysteme für die Landesvermessung. ZfV 121(6):277–285
Drewes H (1997) Realisierung des geozentrischen Referenzsystems für Südamerika (SIRGAS).
GPS-Anwendungen und Ergebnisse ’96: Beiträge zum 41. DVW-Fortbildungsseminar vom 7.
bis 8. No-vember 1996 am Geo-Forschungszentrum Potsdam, pp 54–63
Du RL, Qiao XJ, Wang Q, Xing CF, You XZ (2005) Deformation in the Three Gorges Reservoir
after the ﬁrst impoundment determined by GPS measurements. Progress Natural Sci. 15(6):
515-522
EI-Mowafy A (2013) GNSS multi-frequency receiver single-satellite measurement validation
method. GPS Solutions 18(4), pp553-561
Eissfeller B, Ameres G, Kropp V, et al. (2007) Performance of GPS, GLONASS and Galileo.
Dieter Fritsch, Wichmann, pp185-199
Eissfeller B, Teuber A, Zucker P (2005) Untersuchungen zum GPS-Satellitenempfang in
Gebaeuden. Allgemeine Vermessungs-Nachrichten 112(4): 137-145
460
References

Elosequi P, Davis JL, Jaldehag RTK (1995) Geodesy using the global positioning system: The
effects of signal scattering on estimates of site position. J Geophys Res 100(B6):9921–9934
Elsobeiey M, AI-Harbi S (2015) Performance of real-time Precise Point Positioning using IGS
real-time service. GPS Solutions, DOI: 10.1007/s10291-015-0467-z
Emardson TR, Jarlemark POJ (1999) Atmospheric modelling in GPS analysis and its effect on the
estimated geodetic parameters. J Geodesy 73:322–331
Enge P (2003) GPS Modernization: Capabilities of New Civil Signals. Australian International
Aerospace Congress, Brisbane, 29 July-1 August 2003.
Engel F, Heiser G, Mumford P, Parkinson K, Rizos C (2004) An open GNSS receiver platform
architecture. J. GPS 3(1-2): 63-69
Engelhardt G, Mikolaiski H (1996) Concepts and results of the GPS data processing with Bernese
and GIPSY Software. In: German Contributions to the SCAR 95 Epoch Campaign, 1996: The
Geodetic Antarctic Project GAP95, Muenchen, pp 37–51
Ephishov II, Baran LW, Shagimuratov II, Yakimova GA (2000) Comparison of total electron
content obtained from GPS with IRI. Phys Chem Earth 25C(4):339–342
ESA (2015) http://www.esa.int/Our_Activities/Navigation/The_future_-_Galileo/What_is_Galileo.
ESA nauipedia (2014) http://www.navipedia.net/index.php/BeiDou_General_Introduction.
Euler H-J (1995) Statische/Kinematische Echtzeitvermessung mit GPS. Schriftenreihe des
Deutschen Vereins für Vermessungswesen, Bd. 18, Stuttgart, pp 271–286
Euler HJ, Seeger S, Takac F (2004) Analysis of biases inﬂuencing successful rover positioning
with GNSS-network RTK. J. GPS 3(1-2): 70-78
Even-Tzur G, Agmon E (2005) Monitoring vertical movements in Mount Carmel by means of
GPS and precise leveling. Surv. Rev. 38(296): 146-157
Exertier P, Bonnefond P (1997) Analytical solution of perturbed circular motion: Application to
satellite geodesy. J Geodesy 71(3):149–159
Farguhar R (2011) Fifty Years on the Space Frontier: Halo Orbits, Comets, Asteroids, and more,
Outskirts Press, Inc. Denver, Colorado
Faruqi FA, Turner KJ (2000) Extended Kalman ﬁlter synthesis for integrated global positioning/
iner-tial navigation systems. Appl Math Comput 115(2–3):213–227
Featherstone W, Dentith M, Kirby J (1998) Strategies for the accurate determination of orthometric
heights from GPS. Survey rev 34(267):278–296
Featherstone WE (2004) Evidence of a north-south trend between AUSGeoid98 and the Australian
height datum in southwest Australia. Survey Rev. 37(291): 334-343
Feltens
J
(1991)
Nicht
gravitative
Störeinﬂüsse
bei
der
Modellierungen
von
GPS-
Erdumlaufbahnen. DGK, Reihe C, Heft 371, Verlag der Bayerischen Akademie der
Wissenschaften
Feng Y, Kubik K (1997) On the internal stability of GPS solutions. J Geodesy 72:1–10
Feng Y (2005) Future GNSS performance. Predictions using GPS with a virtual Galileo
constellation. GPS World 16(3): 46-52
Fivian M, Hudson H, Lin RP, Zahid J (2008) A Large Excess in Apparent Solar Oblateness Due to
Surface Magnetism, Science, Vol. 322, 24 Oct 2008
Fivian M, Hudson H, Lin RP, Zahid J (2009) Response to Comment on “A Large Excess in
Apparent Solar Oblateness Due to Surface Magnetism”, Sciences, Vol. 324, 1143, 29 May
2009
Flores A, Escudero A, Sedo MJ, Rius A (2000) A near real time system for tropospheric
monitoring using GPS hourly data. Earth Planets Space 52(10):681–684
Fotopoulos G, Kotsakis C, Sideris MG (2003) How accurately can we determine orthometric
height differences from GPS and geoid data. J. Surv. Eng., ASCE 129(1): 1-10
Forsberg R, Olesen AV, Timmen L, Xu GC, Bastos L, Hehl K, Solheim D (1998) Airborne gravity
in Skagerrak and elsewhere: The AGMASCO project and a nordic outlook. In: Proceedings
NKG meeting Gvle, May 1998
References
461

Forsberg R, Keller K, Nielsen CS, Gundestrup N, Tscherning CC, Madsen SN, Dall J (2000)
Elevation change measurements of the Greenland Ice Sheet. Earth Planets Space 52(11):1049–
1053
Freda P, Angrisano A, Gaglione S, Troisi S (2015) Time-differenced carrier phases technique for
precise GNSS velocity estimation. GPS Solutions 19(2), pp335-341
Fry WG (1997) GPS ﬂies high in Midwest ﬂood study: The Mississippi River Project
demonstrates viability of large-area airborne GPS-controlled mapping. EOM: mag. geogr,
mapp, Earth inf 6(1):28–31
Gabor MJ, Nerem RS (2004) Characteristics of satellite-satellite single difference widelane
fractional carrier-phase biases. Navigation 51(1): 77-92
Galas R, Reigber C (1997) Status of the IGS stations provided by GFZ. International GPS Service
for Geodynamics: 1996 annual report, Pasadena, pp 393–396
Galas R, Reigber C, Baustert G (1995) Permanent betriebene GPS-Stationen in globalen und
regionalen Netzen. ZfV 1209:431–438
Gallimore J, Maini A (2000) Galileo: The public-private partnership. GPS World 11(9):58–63
Gao Y, McLellan J, Schleppe J (1998) Integrating GPS with barometry for high-precision real-
time kinematic seismic survey, Survey. Land Inf Syst 58(2):115–119
Gao Y, Wojciechowski, Chen K (2005) Airborne kinematic positioning using precise point
positioning methodology. Geomatica 59(1): 29-36
Ge LL, Han SW, Rizos C (2000) Multipath mitigation of continuous GPS measurements using an
adap-tive ﬁlter. GPS Solutions 4(2):19–30
Ge L (2003) Integration of GPS and radar interferometry. GPS Solutions 7(1): 52-54
Ge M, Calais E, Haase J (2000) Reducing satellite orbit error effects in near real-time GPS zenith
tropospheric delay estimation for meteorology. Geophys Res Lett 27(13):1915–1918
Ge M, Gendt G, Dick G, Zhang FP, Reigber C (2005) Impact of GPS satellite antenna offsets on
scale changes in global network solutions. Geophys. Res. Lett. 32(L06310): 1-4
Geiger A, Hirter H, Cocard M (1995) Mitigation of tropospheric effects in local and regional GPS
networks. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st
IUGG General As-sembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-
Verlag, Berlin, pp 263–267
Gendt G (1997) Analysen der IGS-Daten und Ergebnisse, GPS-Anwendungen und Ergebnisse ’96:
Beiträge zum 41. DVW-Fortbildungsseminar vom 7. bis 8. November 1996 am Geo-
Forschungs-zentrum Potsdam, 1997, Stuttgart, pp 43–53
Gendt G, Dick G, Reigber C (1995) Global plate kinematics estimated by GPS data of the IGS
core network. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications:
21st IUGG General As-sembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995.
Springer-Verlag, Berlin, pp 30–34
Gianniou M (1996) Genauigkeitssteigerung bei kurzzeit-statischen und kinematischen Satelliten-
messungen bis hin zur Echtzeitanwendung. DGK, Reihe C, Heft 458, Verlag der Bayerischen
Akademie der Wissenschaften
Gili JA, Corominas J, Rius J (2000) Using Global Positioning System techniques in landslide
monitoring. Eng Geol 55(3):167–192
Gilvarry JJ, Sturrock PA (1967) Sloar Oblateness and the Perihelion Advances of Planets, Nature,
Vol. 216, December 30, 1967
Gleason DM (1996) Avoiding numerical stability problems of long duration DGPS/INS Kalman
ﬁlters. J Geodesy 70(5):263–275
Goad C (1996) Single-site GPS models. In: Kleusberg A, Teunissen PJG (eds) GPS for geodesy.
Springer-Verlag, Berlin
Goad C (1996) Short distance GPS models. In: Kleusberg A, Teunissen PJG (eds) GPS for
geodesy. Springer-Verlag, Berlin
Goad C, Yang M (1997) A new approach to precision airborne GPS positioning for
photogrammetry. Photogramm Eng Rem S 63(9):1067–1077
462
References

Goad C, Dorota A, Brzezinska G, Yang M (1996) Determination of high-precision GPS orbits
using triple differencing technique. J Geodesy 70:655–662
Godier S, Rozelot JP (1999) Quadrupole moment of the Sun. Gravitational and rotational
potentials, A&A 350, 310-317
Godier S, Rozelot JP (2000) The solar oblateness and its relationship with the structure of the
tachocline and of the Sun’s subsurface, A&A 355, 365-374
Goerres B, Campbell J (1998) Bestimmung vertikaler Punktbewegungen mit GPS. ZfV 123
(7):222–230
Goodhue J (1997) Experiments aloft: Balloon-borne payloads reach near space. GPS World 8
(9):34–42
GPS.gov, National Coordination Ofﬁce for Space-Based Positioning, Navigation and Timing
(2015) GPS Modernization, http://www.gps.gov/systems/gps/modernization/
Grafarend EW (2000) Mixed integer-real valued adjustment (IRA) problems: GPS initial cycle
ambi-guity resolution by means of the LLL algorithm. GPS Solutions 4(2):31–44
Grafarend E, Ardalan AW (1997) An estimate in the Finnish Height Datum N60, epoch 1993.4,
from twenty-ﬁve GPS points of the Baltic Sea Level Project. J Geodesy 71(11):673–679
Grejner-Brzezinska D, Toth C, Yi YD (2005) On improving navigation accuracy of GPS/INS
systems. Photogramm. Eng. Remot Sens. 71(4): 377-389
Grejner-Brzezinska DA et al. (2004) An analysis of the effects of different network-based
ionosphere estimation models on rover positioning accuracy. J. GPS 3(1-2): 115-131
Grewal MS, Weill LR, Andrews AP (2001) Global Positioning System, Inertial Navigation, and
Integration. John Wiley & Sons, Inc., New York: 392 p.
Grifﬁths J, Ray JR (2009) On the precision and accuracy of IGS orbits. J Geodesy 83(3), pp277-
287
Groten E (1979) Geodesy and the Earth’s gravity ﬁeld, Vol. I: Principles and conventional
methods. Dümmler-Verlag, Bonn
Groten E (1980) Geodesy and the Earth’s gravity ﬁeld, Vol. II: Geodynamics and advanced
methods. Dümmler-Verlag, Bonn
Guinn J, Muellerschoen R, Cangahuala L (1995) TOPEX/Poseidon precision orbit determination
us-ing combined GPS, SLR and DORIS. In: GPS Trends in Precise Terrestrial, Airborne and
Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium No. 115, Boulder,
USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 128–132
Guo JF, Ou JK, Ren C (2005) Partial continuation model and its application in mitigating
systematic errors of doubled-differenced GPS measurements. Progress in Natural Sci. 15(3):
246-251
Gurtner W, Mader G (1990) Receiver independent exchange format version 2. GPS Bulletin 3
(3):1–8
Gurtner W, Boucher C, Bruyninx C (1997) The use of the IGS/EUREF permanent network for
EUREF densiﬁcation campaigns. In: Symposium of the IAG Subcommission for Europe
(EUREF), Soﬁa, Bulgaria, June 4–7, 1997, 3 pp
Guo Q (2015) Precision comparison and analysis of four online free PPP services in static
positioning and tropospheric delay estimation. GPS Solutions 19(4), pp537-544
Haines BJ, Christensen EJ, Guinn JR (1995) Observations of TOPEX/Poseidon orbit errors due to
gravitational and tidal modeling errors using the Global Positioning System. In: GPS Trends in
Precise Terrestrial,Airborne, and Spaceborne Applications: 21st IUGG General Assembly,IAG
Sym-posium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 133–138
Haines B, Bar-Server Y, Bertiger W, Desai S, Willis P (2004) One-centimeter orbit determination
for Jason-1: New GPS-based strategies. Mar. Geod. 27(1-2): 299-318
Hajj GA, Kursinski ER, Bertiger WI (1995) Initial results of GPS-LEO occultation measurements
of Earth’s atmosphere obtained with the GPS-MET experiment. In: GPS Trends in Precise
Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG
Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 144–153
References
463

Hamilton GS, Whillans IA (2000) Point measurements of mass balance of the Greenland Ice Sheet
using precision vertical Global Positioning System (GPS) surveys. J Geophys Res 105(B7):
16295–16301
Han S (1997) Quality-control issues relating to instantaneous ambiguity resolution for real-time
GPS kinematic positioning. J Geodesy 71(6):351–361
Han S, Rizos C (1996) Validation and rejection criteria for integer least-squares estimation. Survey
rev 33(260):375–382
Han S, Rizos C (2000) GPS multipath mitigation using FIR ﬁlters. Survey rev 35(277):487–498
Han S, Rizos C (2000) An instantaneous ambiguity resolution technique for medium-range GPS
kinematic positioning. J Inst Navig 47(1):17–31
Han S, Rizos C (2000) Airborne GPS kinematic positioning and its application to oceanographic
mapping. Earth Planets Space 52(10):819–824
Hariharan R, Krumm J, Horvitz E (2005) Web-enhanced GPS. Lect. Notes Comput. Sci. 3479: 95-
104
Harwood NM, Swinerd GG (1995) Long-periodic and secular perturbations to the orbit of a
spherical satellite due to direct solar radiation pressure, Celestial Mechanics and Dynamical
Astronomy 62: 71-80
Hatanaka Y, Tsuji H, Iimura Y, Kobayashi K, Morishita H (1995) Application of GPS kinematic
method for detection of crustal movements with high temporal resolution. In: GPS Trends in
Precise Ter-restrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly,
IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 105–
112
Hatch RR (1996) The promise of a third frequency, GPS World, 7(1996)5, 55–58
Hatch RR (2004) Those scandalous clocks. GPS Solutions 8(2): 67-73
Hatch RR, Sharpe RT (2004) Recent improvements to the SDtar Fire global DGPS navigation
software. J. GPS 3(1-2): 143-153
Hauschild A, Montenbruck O (2009) Kalman-ﬁlter-based GPS clock estimation for near real-time
positioning. GPS Solutions 13(3), pp173-182
Hay C, Wong J (2000) Enhancing GPS: Tropospheric delay prediction at the Master control
Station. GPS World 11(1):56–62
He HB, Li JL, Yang YX, Xu JY, Guo HR, Wang AB (2014) Performance assessment of single-
and dual-frequency BeiDou/GPS single-epoch kinematic positioning. GPS Solutions 18(3),
pp393-403
He JK, Cai DS, Li YX, Gong ZS (2004) Active extension of the Shanxi rift, north China: does it
result from anticlockwise block rotations? Terra Nova 16(1): 38-42
He K, Xu G, Xu T, Flechtner F (2014) GNSS navigation and positioning for the GEOHALO
experiment in Italy. GPS Solutions, DOI: 10.1007/s10291-014-0430-4.
He XF, Guang Y, Ding XL, Chen YQ (2004) Application and evaluation of a GPS-multi-antenna
system for dam deformation monitoring. Earth Planets and Space 56(11): 1035-1039
Heck B (1995a) Grundlagen der SatellitenGeodaesie. Schriftenreihe des Deutschen Vereins für
Vermessungswesen, Bd. 18, Stuttgart, pp 10–31
Heck B (1995b) Grundlagen der erd- und himmelsfesten Referenzsysteme. Schriftenreihe des
Deutschen Vereins für Vermessungswesen, Bd. 18, Stuttgart, pp 138–153
Hefty J, Rothacher M, Springer T, Weber R, Beutler G (2000) Analysis of the ﬁrst year of Earth
rotation parameters with a sub-daily resolution gained at the CODE processing center of the
IGS. J Geodesy 74(6):479–487
Hehl K, Xu G, Fritsch J (1995) Results from ﬁeld tests of an airborne gravity meter system. In:
Proceed-ings of IUGG XXI General Assembly, IAG meeting at Boulder,Colorado, USA,July
1995, IAG Sympo-sium G4, pp 169–174
Hein GW (2000) From GPS and GLONASS via EGNOS to Galileo. Position and navigation in the
third millennium. GPS Solutions 3(4):39–47
464
References

Hein GW, Riedl B (1995) High precision deformation monitoring using differential GPS. In: GPS
Trends in Precise Terrestrial,Airborne, and Spaceborne Applications: 21st IUGG General
Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin,
pp 180–184
Hein GW, Eisfeller B, Pielmeier J (1995) Developments in airborne “high precision” digital photo
ﬂight navigation in “realtime”. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne
Applications: 21st IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–
4, 1995. Springer-Verlag, Berlin, pp 175–179
Hein GW et al. (2003) Galileo frequency & signal design. GPS World 14(6): 30-37
Heinrich G et al. (2004) HIGAPS. A highly integrated Galileo/GPS chipset for consumer
applications. GPS World 15(9): 38-47
Heitz S (1988) Coordinates in geodesy. Springer-Verlag, Berlin
Hernández-Pajares M, Juan JM, Sanz J, Colombo OL (2000) Application of ionospheric
tomography to real-time GPS carrier-phase ambiguities resolution, at scales of 400–1 000 km
and with high geomagnetic activity. Geophys Res Lett 27(13):2009–2012
Hernandez-Pajares M, Juan JM, Sanz J, Colombo OL (2003) Impact of real-time ionospheric
determination on improving precise navigation with GALILEO and next-generation GPS.
Navigation 50(3): 205-218
Herring T (2003) MATLAB Tools for viewing GPS velocities and time series. GPS Solutions 7
(3): 194-199
Hess D, Keller W (1999) Gradiometrie mit GRACE Teil I, Fehleranalyse künstlicher
Gradiometerdaten. ZfV 5:137–144
Hess D, Keller W (1999) Gradiometrie mit GRACE Teil II, Simulationsstudie. ZfV 7:205–211
Highsmith D, Axelrad P (1999) Relative state estimation using GPS ﬂight data from co-orbiting
space-craft. ION GPS ’99, 14–17 September 1999, pp 401–409
Hill HA, Clayton PD, Patz DL, Healy AW, Stebbins RT, Oleson JR, Zanoni CA (1974) Solar
oblateness, Excess Brightness, and Relativity. Physical Review Letters, Vol. 33 No. 25, 1497-
1500
Hilla S (2004) Plotting pseudorange multipath with respect to satellite azimuth and elevation. GPS
Solutions 8(1): 44-48
Hiller W, Lauterbach P, Wlaka M (1997) Seeking sovereignty: A European navigation satellite
system. GPS World 8(9):56–60
Hirahara K (2000) Local GPS tropospheric tomography. Earth Planets Space 52(11):935–939
Hofmann-Wellenhof B, Legat K, Weiser M (2003) Navigation, Principles of Positioning
Guidance. Springer-Verlag, New York, NY: xxix+427p
Hong Y, Ou JK (2006) Algebra solution of the variation equation and its numerical validation. (in
Chinese)
Horvath I, Essex EA (2000) Using observations from the GPS and TOPEX satellites to investigate
night-time TEC enhancements at mid-latitudes in the southern hemisphere during a low
sunspot number period. J Atmos Sol-Terr Phy 62(5):371–391
Hostetter GH (1987) Handbook of digital signal processing. Engineering Applications, Academic
Press, San Diego, CA
Hotine M (1991) Differential geodesy. Springer-Verlag, Berlin
Hsu R, Li S (2004) Decomposition of deformation primitives of horizontal geodetic networks:
application to Taiwan’s GPS network. J. Geod. 78(4-5): 251-262
Hu GR, Khoo HS, Goh PC, Law CL (2003) Development and assessment of GPS virtual reference
station for RTK positioning. J. Geod. 77(5-6): 292-302
Hugentobler U, Ineichen D, Beutler G (2003) GPS satellites: Radiation pressure, attitude and
resonance. Adv. Space Res. 31(8): 1917-1926
Hughes S (1977) Satellite Orbits Perturbed by Direct Solar Radiation Pressure: General Expansion
of the Disturbing Function, Planet. Space Sci. Vol 25 pp 809-815
Hünerbein K von, Hamann HJ, Rüter E, Wiltschko W (2000) A GPS-based system for recording
the ﬂight paths of birds. Naturwissenschaften 87(6):278–279
References
465

Ifadis IM (2000) A new approach to mapping the atmospheric effects for GPS. Earth Planets Space
52(10):703–708
IGS, RTCM-SC104 (2015) RINEX- The Receiver Independent Exchange Format (Version 3.03).
ftp://igs.org/pub/data/format/rinex303.pdf
Ihde J (1996) Geoidbestimmung unter Nutzung von GPS und Nivellement. Erste Geodätische
Woche, Stuttgart, 7.–12. Oktober 1996, 6 Blatt
Ince CD, Sahin M (2000) Real-time deformation monitoring with GPS and Kalman Filter. Earth
Plan-ets Space 52(10):837–840
ION, The Institute of Navigation. Proceedings of ION GPS-91, 92, 93, 94, 95, 96, 97, 98, 99, 00,
01, 02, 03, 04, 05, 06, 07, 08, 09, 10, 11, 12, 13, 14, 15
Iorio L (2005) On the possibility of measuring the solar oblateness and some relativistic effects
from planetary ranging, A&A 433, 385-393
Jaggi A, Beutler G, Hugentobler U (2005) Reduced-dynamic orbit determination and the use of
accelerometer data. Adv. Space Res. 36(3): 438-444
Jakowski N, Mayer C, Hoque MM, Wilken V (2011) Total electron content models and their use
in ionosphere monitoring. Radio Science, 46(6)
Jakowski N, Sardon E, Engler E (1995) About the use of GPS measurements for ionospheric
studies. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st
IUGG General As-sembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-
Verlag, Berlin, pp 248–252
Jerde CL, Visscher DR (2005) GPS measurement error inﬂuences on movement model
parameterization. Ecological Appl. 15(3): 806-810
Jekeli C, Garcia R (1997) GPS phase accelerations for moving – base vector gravimetry.
J Geodesy 71:630–639
Jeyapalan K (2004) Local geoid determination using global positioning systems. Surv. Land
Information Sci. 64(1): 65-75
Jiang N (2013) Studies on error analysis of positioning and real-time precise point positioning.
Chang’an University. Xi’an, China
Jiang N, Xu T (2013) An improved velocity determination method based on GOCE kinematic
orbit. Geodesy and Geodynamics 4(2): pp47-52
Jiang N, Xu T, Xu Y (2012) An Improved Method for Determination of GOCE Orbital Velocity of
the Geometric Method. Bulletin of Surveying and Mapping, 11: pp7-10
Jiang N, Xu T, Xu Y (2013) A real-time precise point positioning method without precise clock
bias. Journal of Central South University (Science and Technology), 44(11): pp4520-4526
Jiang N, Xu T, Xu Y (2013) Inﬂuence of the Receiver Antenna random to GPS Positioning
Precision. Geomatics and Information Science of Wuhan University, 38(5): pp566-570
Jiang N, Xu T, Xu Y (2013) Multipath error estimation and its improved algorithm for Chinese
IGS stations. Journal of Geodesy annd Geodynamics, 33(2): pp143-146
Jiang N, Xu T, Xu Y (2013) Real-time estimation of satellite clock and PPP precision analysis
based on IGS regional net. Journal of Geodesy and Geodynamics, 33(5): pp44-48
Jiang N, Xu Y, Xu T, Xu G, Sun Z, Schuh H (2016) GPS/BDS short-term ISB modelling and
prediction. GPS Solutions, DOI: 10.1007/s10291-015-0513-x
Jin SG, Zhu WY (2003) Active motion of tectonic blocks in East Asia: Evidence from GPS
measurements. Acta Geologica Sinica 77(1): 59-63
Jin X-X (1995) A recursive procedure for computation and quality control of GPS differential
corrections. Delft University of Technology, Faculty Geod. Engin., Delft Geodetic Computing
Centre, Delft, 83 S
Jin X-X, Jong K de, Cees D (1996) Relationship between satellite elevation and precision of GPS
code observations. Leipzig, 13 S
Jong K de (1999) The Inﬂuence of Code Multipath on the Estimated Parameters of the Geometry-
Free GPS Model. GPS Solutions, Vol. 3, No. 2, 11-18
Jong K de (2000) Minimal detectable biases of cross-correlated GPS observations. GPS Solutions
3(3): 12–18
466
References

Jong K de, Teunissen PJG (2000) Minimal detectable biases of GPS observations for a weighted
ionosphere. Earth Planets Space 52(10):857–862
Jonkman NF, Jong K de (2000) Integrity monitoring of IGEX-98 data, Part I: Availability. GPS
Solu-tions 3(4):10–23
Jonkman NF, Jong K de (2000) Integrity monitoring of IGEX-98 data, Part II: Cycle slip and
outlier detection. GPS Solutions 3(4):24–34
Jonkman NF, Jong K de (2000) Integrity monitoring of IGEX-98 data, Part III: Broadcast
navigation message validation. GPS Solutions 4(2):45–53
Joosten J (2000) The GPS integer least-squares statistics. Phys Chem Earth 25(A9–A11):687–692
Joosten P, Tiberius C (2000) Fixing the ambiguities. Are you sure they’re right? GPS World 11
(5):46–51
Kaczorowski M (1995) Calculation of the Green’s loading functions. Part 1: Theory. Artiﬁcial
Satellites, Journal of Planetary Geodesy 30(1):77–93
Kälber S, Jäger R, Schwäble R (2000) A GPS-based online control and alarm system. GPS
Solutions 3(3):19–25
Kammeyer P (2000) A UT1-like quantity from analysis of GPS orbit planes. Celest Mech Dyn
Astr 77(4):241–272
Kamp PD van (1967) Principles of astrometry. W. H. Freemann and Company, San Francisco and
London
Kang Z, Nagel P, Pastor R (2003) Precise orbit determination for GRACE. Adv. Space Res. 31(8):
1875-1881
Kaniuth K, Kleuren D, Tremel H (1998) Sensitivity of GPS height estimates to tropospheric delay
modelling. Allgemeine Vermessungsnachrichten 105(6):200–207
Kaniuth K, Kleuren D, Tremel H, Schlueter W (1998) Elevationabhängige Phasenzentrums-
variationen geodätischer GPS-Antennen. ZfV 10:320–325
Karslioglu MO (2005) An interactive program for GPS-based dynamic orbit determination of
small satellites. Comput. and Geosci. 31(3): 309-317
Kashani I, Wielgosz P, Grejner-Brzezinska D (2003) Datum deﬁnition in the long range
instantaneous RTK GPS network solution. J. GPS 2(2): 100-108
Kechine MO, Tiberius CCJM, van der Marel H (2004) An experimental performance analysis of
real-time kinematic positioning with NASA's Internet-based Global Differential GPS. GPS
Solutions 8(1): 9-22
Keshin MO (2004) Directional statistics of satellite-satellite single-difference widelane phases
biases. Artiﬁcial Satellites 39(4): 305-324
Kezerashvili RY, Vazquez-Poritz J (2009) Solar Radiation Pressure and Deviations from
Keplerian Orbits, Physics Letters B 675, 18-21
Khan SA, Scherneck HG (2003) The M-2 ocean tide loading wave in Alaska: vertical and
horizontal displacements, modeled and observed. J. Geod. 77(3-4): 117-127
Khan SA, Tscherning CC (2001) Determination of semi-diurnal ocean tide loading constituents us-
ing GPS in Alaska. Geophys Res Lett 28(11):2249–2252
Khazaradze G, Klotz J (2003) Short- and long-term effects of GPS measured crustal deformation
rates along the south central Andes. J. Geophys. Res. 108(B6): ETG5/1-15
Kelley K, Bologlu A (1995) DGPS on the waterfront: tracking cargo and equipment in maritime
terminals. GPS World 6(9):62–71
Keong J, Lachapelle G (2000) Heading and pitch determination using GPS/GLONASS. GPS
Solutions 3(3):26–36
Khodabandeln A, Teunissen PJG (2015) An analytical study of PPP-RTK corrections: precision,
correlation and user-impact. J Geodesy 89(11), pp1109-1132
Kim D, Langley RB (2000) A search space optimization technique for improving ambiguity
resolution and computational efﬁciency. Earth Planets Space 52(10):807–812
Kim D, Langley RB (2003) On ultrahigh-precision GPS positioning and navigation. Navigation 50
(2): 103-116
References
467

King-Hele D (1964) Theory of satellite orbits in an atmosphere, Butterworths Mathematical Texts,
Butterworths & Co. Publ., London
King MA, Penna NT, Clarke PJ, King EC (2005) Validation of ocean tide models around
Antarctica using onshore GPS and gravity data. J. Geophys. Res. 110(B08401): 1-21
King M, Coleman R, Morgan P (2000) Treatment of horizontal and vertical tidal signals in GPS
data: A case study on a ﬂoating ice shelf. Earth Planets Space 52(11):1043–1047
Kislik MD (1983) On the solar oblateness, Sov. Astron. Lett. 9(5)
Kistler M, Geiger A (2000) GPS am Seil herunterlassen: das Global Positioning System im
Dienste des Seilbahnwesen. Vermess Photogramm Kulturtech 98(7):441–445
Kleusberg A (1995) Mathematics of attitude determination with GPS. GPS World, 6(9):72–78
Kleusberg A, Teunissen PJG (eds) (1996) GPS for geodesy. Springer-Verlag, Berlin
Klotz J, Angermann D, Reinking J (1995) Großräumige GPS-Netze zur Bestimmung der rezenten
Kinematik der Erde. ZfV 120(9):449–460
Knickmeyer ET, Knickmeyer EH, Nitschke M (1996) Zur Auswertung kinematischer Messungen
mit dem Kalman-Filter. Schriftenreihe des Deutschen Vereins für Vermessungswesen, Bd. 22,
Stuttgart, pp 141–166
Knudsen P, Andersen O (1997) Global marine gravity and mean sea surface from multi mission
satel-lite altimetry. Scientiﬁc Assembly of the International Association of Geodesy in
conjunction with 28th Brazilian Congress of Cartography; Rio de Janeiro, 3–9 September 1997,
4 pp
Koch KR (1980) Parameterschätzung und Hypothesentests in linearen Modellen. Dümmler-
Verlag,Bonn
Koch KR (1996) Robuste Parameterschätzung. Allgemeine Vermessungsnanchrichten 103(1):1–
18
Komjathy A, Langley RB, Vejrazka F (1995) Assessment of two methods to provide ionospheric
range ernror corrections for single-frequency GPS users. In: GPS Trends in Precise Terrestrial,
Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium
No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 253–257n
Komjathy A, Zavorotny VU, Axelrad P, Born GH, Garrison JL (2000) GPS signal scattering from
sea surface: Wind speed retrieval using experimental data and theoretical model. Remote Sens
Environ 73(2):162–174
Konig R, Schwintzer P, Bode A (1996) GFZ-1: A small laser satellite mission for gravity nﬁeld
model improvement. Geophys Res Lett 23(22):3143–3146
Konig R, Reigber C, Zhu SY (2005) Dynamic model orbits and earth system parameters from
combined GPS and LEO data. Adv. Space Res. 36(3): 431-437
Kraus JD (1966) Radio astronomy. McGraw-Hill, New York
Kristiansen O (1995) Experiences with high precision GPS processing in Norway. Rep Finnish
Geod Inst 4:77–84
Krivov AV, Sokolov LL, Dikarev VV (1996) Dynamics of Mars-Orbiting Dust: Effects if Light
Pressure and Planetary Oblateness, Celestial Mechanics and Dynamical Astronomy 63: 313-
339
Kroes R, Montenbruck O (2004) Spacecraft formation ﬂying: Relative positioning using dual-
frequency carrier phase. GPS World 15(7): 37-42
Kroes R, Montenbruck O, Bertiger W, Visser P (2005) Precise GRACE baseline determination
using GPS. GPS Solutions 9(1): 21-31
Kuang D, Rim HJ, Schutz BE (1996) Modeling GPS satellite attitude variation for precise orbit
determination. J Geodesy 70(9):572–580
Kuang D, Rim HJ, Schutz BE, Abusali PAM (1996) Modeling GPS satellite attitude variation for
precise orbit determination. J Geodesy 70:572–580
Kubo-oka T, Sengoku A (1999) Solar Radiation Pressure Model for the Relay Satellite of
SELENE, Earth Planets Space, 51, 979-986
468
References

Kudak VI, Klimik VU, Epishev VP (2010) Evalution of disturbances from solar radiation in orbital
elements of geosychronous satellite based on harmonics, Astrophysical Bulletin, Vol. 65,
No. 3, pp. 300-310
Kudryavtsev SM (2007) Long-term harmonic development of lunar ephemeris, Astronomy &
Astrophysics, Vol. 472 No.2
Kuhn JR, Bush RI, Scheick X, Scherrer P (1998) The Sun’s Shape and Brightness, Nature, Vol.
392, P155
Kuhn JR, Emilio M, Bush R (2009) Comment on “A Large Excess in Apparent Solar Oblateness
Due to Surface Magnetism, Sciences, Vol. 324, 1143, 29 May 2009
Kumar M (1997) Time-invariant bathymetry: A new concept to deﬁne and survey it using GPS. In:
Proceedings of Fourteenth United Nations Regional Cartograﬁc Conference for Asia and the
Pa-ciﬁc, Bangkok, 3–7 February 1997. Bangkok, 4 pp
Kwon JH, Grejner-Brzezinska D, Bae TS, Hong CK (2003) A triple difference approach to Low
Earth Orbiter precision orbit determination. J. Navig. 56(3): 457-473
Lachapelle G (1995) Post-mission GPS absolute kinematic positioning at one-metre accuracy
level. Int J Geomatics 9(1):37–39
Lachapelle G, Cannon ME, Qiu W, Varner C (1996) Precise aircraft single-point positioning using
GPS post-mission orbits and satellite clock corrections. J Geodesy 70:562–571
Lachapelle G (2004) GNSS indoor location technologies. J. GPS 3(1-2): 2-11
Lachapelle G, Kuusniemi H, Dao DTH, Macgougan G, Cannon ME (2004) HSGPS signal
analysis and performance under various indoor conditions. Navigation 51(1): 29-43
Lambert A, Pagiatakis SD, Billyard AP, Dragert H (1988) Improved ocean tide loading correction
for gravity and displacement: Canada and northern United States. J Geophys Res 103
(B12):30231–30244
Landau H (1988) Zur Nutzung des Global Positioning Systems in Geodaesie und Geodynamik:
Modell-bildung, Software-Entwicklung und Analyse. Universität der Bundeswehr Müchen,
Studiengang Vermessungswesen, Schriftenreihe, Heft 36
Landspersky D, Mervart L (1997) A contribution to the study of modelling of the troposphere
biases of GPS observations with high accuracy. In: Proceedings of the EGS symposium G14
‘Geodetic and Geodynamic programmes of the CEI’: 22 General Assembly of the EGS,
Vienna, Austria, 21– 25 April 1997. Warszawa, pp 207–211
Langley RB (1997a) GLONASS: Review and update. GPS World 8(7):46–51
Langley RB (1997b) The GPS error budget. GPS World 8(3):51–56
Langley RB (2000) GPS, the ionosphere, and the solar maximum. GPS World 11(7):44–49
Langley RB (2003) Getting your bearings. The magnetic compass and GPS. GPS World 14(9): 70
+
Lapucha D (1994) Real-time centimeter-accuracy positioning with on-the-ﬂy carrier phase
ambiguity resolution. Rep Geod 1:52–59
Larson WJ, Wertz JR (1995) Space mission analysis and design, 2nd Ed, Microcosm, Inc.
California and Kluwer Academic Publishers Boston
Lechner
W
(1995)
Telemetriekonzepte
für
die
GPS-unterstützte
Echtzeitvermessung.
Schriftenreihe des Deutschen Vereins für Vermessungswesen, Bd. 18, pp 260–286
Lee HK, Hewitson S, Wang J (2004) Web-based resources on GPS/INS integration. GPS
Solutions 8(3): 189-191
Lee J-T, Mezera DF (2000) Concerns related to GPS-derived geoid determination. Survey rev 35
(276):379–397
Lee YC, O’Laughlin DG (2000) Performance analysis of a tightly coupled GPS/Inertial system for
two integrity monitoring methods. J Inst Navig 47(3):175–189
Leinen S (1997) Hochpräzise Positionierung über große Entfernungen und in Echtzeit mit dem
Global Positioning System. DGK, Reihe C, Heft 472,Verlag der Bayerischen Akademie der
Wissenschaften
Lelgemann D (1983) A linear solution of equation of motion of an Earth-orbiting satellite based on
a Lie-series. Celestial Mech 30:309
References
469

Lelgemann D (1996) Geodaesie im Weltraumzeitalter. Dtsch Geod Komm 25:59–77
Lelgemann D, Petrovic S (1997) Bemerkungen über den Höhenbegriff in der Geodaesie. ZfV 122
(11): 503–509
Lemmens R (2004) Book review: GPS – Theory, Algorithms and Applications, Xu G 2003,
International J. Applied Earth Observation and Geoinformation 5 (2004) 165-166
Leroy E (1995) GPS real-time levelling on the world’s longest suspension bridge. Int J Geomatics
9(8):6–8
Levin E (1968) Solar radiation pressure perturbations of earth satellite orbits, AIAA Journal, vol.
6, issue 1, pp. 120-12
Levine J (2001) GPS and the legal traceability of time. GPS World 12(1):52–58
Li H, Xu G, Xue H, Zhao H, Chen J,Wang G (1999) Design of GPS application program. Science
Press, Peking, ISBN 7-03-007204-9/TP.1049, 337 p (in Chinese and in C)
Li X (2004) The advantage of an integrated RTK-GPS system in monitoring structural
deformation. J. GPS 3(1-2): 191-199
Li X, Zhang X, Ren X, Fritsche M, Wickert J, Schuh H (2015) Precise positioning with current
multi-constellation Global Navigation Satellite Systems: GPS, GLONASS, Galileo and
BeiDou. Scientiﬁc reports 5, 8328.
Licandro J, Alvarenz-Candal A, Leon Jde, Pinilla-Aloso N, Lazzaro D, Hampins H (2008) Spectral
properties of asteroids in cometary orbits, Astronomy & Astrophysics, Vol. 481 No.3
Lightsey EG, Blackburn GC, Simpson JE (2000) Going up: A GPS receiver adapts to space. GPS
World 11(9):30–34
Linkwitz K, Hangleiter U (eds) (1995) High precision navigation 95. Dümmler-Verlag, Bonn
Liu D, Liu J, Liu G (1993) The three-dimensional combined adjustment of GPS and terrestrial
surveying data. Acta Geod Cartogr Sinica 41–54 (select. papers Engl. ed.)
Liu YX, Chen YQ, Liu JN (2000) Determination of weighted mean tropospheric temperature using
ground meteorological measurement. J Wuhan Techn Univ Survey Mapp 25(5):400–403
Liu Z (2011) A new automated cycle slip detection and repair method for a single dual-frequency
GPS receiver. J Geodesy 85(3), pp171-183
Lowe S, Zuffada C, Chao Y, Kroger P, Young J (2002b) 5-cm-precision aircraft ocean altimetry
using GPS reﬂections. Geophys. Res. Lett., 29(10)
Ludwig R (1969) Methoden der Fehler- und Ausgleichsrechnung. Vieweg & Sohn, Braunschweig
Lynden-Bell D (2009) Analytical orbits in any central potential, MNRAS Vol. 402 Issue 3 (p1937-
1941)
Mackenzie R, Moore P (1997) A geopotential error analysis for a non planar satellite to satellite
tracking mission J Geodesy 71(5):262–272
Mackie JB (1985) The elements of astronomy for surveyors. Charles Grifﬁn & Company Ltd.
Mader GL (1995) Kinematic and rapid static (KARS) GPS positioning: Techniques and recent
experiences. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications:
21st IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995.
Springer-Verlag, Berlin, pp 170–174
Madsen FB, Madsen F (1994) Realization of the EUREF89 reference frame in Denmark. Report
on the Symposium of the IAG Subcommission for the European Reference Frame (EUREF)
held in Warsaw 8–11 June 1994. Reports of the EUREF Technical Working Group, Muenchen,
pp 270–274
MalekiL, Prestage J(2005) Applications of clocks and frequency standards: from the routine to
tests of fundamental models.Metrologia42(3):S145-S153
Mander A, Bisnath S (2013) GPS-based precise orbit determination of Low Earth Orbiters with
limited resources. GPS Solutions 17(4), pp587-594
Manning J, Johnston G (1995) A ﬁducial GPS network to monitor the motion of the Australien
plate. In: Proceedings of the First Turkish International Symposium on Deformations
“Istanbul-94”, Istanbul, Sept. 5–9, 1995, Istanbul, pp 85–89
Mannucci A J, Wilson B D, Yuan D N, et al. (1998) A global mapping technique for GPS‐derived
ionospheric total electron content measurements. Radio Science, 33(3): 565-582
470
References

Mansfeld W (2004) Satellitenortung und Navigation, 2nd Edition, Wiesbanden: Vieweg Verlag,
352 p.
McCarthy DD (1996) International Earth Rotation Service. IERS conventions, Paris, 95 pp. IERS
Technical Note No. 21
McCarthy DD, Capitaine N (2002) Practical Consequences of Resolution B1.6 “IAU2000
Precession-Nutation Model”, Resolution B1.7 “Deﬁnition of Celestial Intermediate Pole”, and
Resolution B1.8 “Deﬁnition and Use of Celestrial and Terrestrial Ephemeris Origin”. In:
Proceedings of the IERS Workshop on the Implementation of the New IAU Resolutions, Paris,
France, April 18-19, 2002 (Capitaine N et al, ed.) IERS Technical Note No. 29
McCarthy DD, Luzum BJ (1995) Using GPS to determine Earth orientation. In: GPS Trends in
Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly,
IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 52–58
McCarthy DD , Petit G (Ed) (2003) International Earth Rotation Service. IERS conventions
(2003), IERS Technical Note No. 32
McInnes CR (1999) Solar Sailing: Technology, Dynamics and Missions Applications, Springer
Berlin
Mertikas SP, Rizos C (1997) On-line detection of abrupt changes in the carrier-phase
measurements of GPS. J Geodesy 71(8):469–482
Mervart L (1995) Ambiguity resolution techniques in geodetic and geodynamic applications of the
Global Positioning System. Dissertation an der Philosophisch- naturwissenschaftlichen
Fakultät der Universität Bern
Mervart L, Beutler G, Rothacher M (1995) The impact of ambiguity resolution on GPS orbit
determination and on global geodynamics studies. In: GPS Trends in Precise Terrestrial,
Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium
No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 285–289
Michel GW, Becker M, Angermann D, Reigber C, Reinhart E (2000) Crustal motion in E- and SE-
Asia from GPS measurements. Earth Planets Space 52(10):713–720
Mickler D, Axelrad P, Born G (2004) Using GPS reﬂections for satellite remote sensing. Acta
Astronautica 55(1): 39-49
Milani A, Rossi A, Vokrouhlicky D, Villani D, Bonanno C (2001) Gravity ﬁeld and rotation state
of Mercury from the BepiColombo Radio Science Experiments, Planetary and Space Science
49, pp 1579-1596
Milbert D(2005) Correction to ``Inﬂuence of pseudorange accuracy on phase ambiguity resolution
in various GPS modernization scenarios''.Navigation52(3): 121-121
Milbert D(2005) Inﬂuence of pseudorange accuracy on phase ambiguity resolution invarious GPS
modernization scenarios.Navigation52(1):29-38
Miller KM (2000) A review of GLONASS. Hydrographic Journal 98:15–21
Minovitch M (1961) A method for determining interplanetary free-fall reconnaissance trajectories.
Jet Propulsion Laboratory Technical Memo TM-312-130, pages 38-44 (23 August 1961)
Mirgorodskaya T (2013) GLONASS Government Policy, Status and Modernization Plans. IGNSS
2013, Gold Coast, Queensland, Australia, July 16, 2013.
Mireault Y, Kouba J, Lahaye F (1995) IGS combination of precise GPS satellite ephemerides and
clock. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st
IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-
Verlag, Berlin, pp 14–23
Mitchell S, Jackson B, Cubbedge S (1996) Navigation solution accuracy from a spaceborne GPS
receiver, GPS World, 7(1996)6, 42, 44, 46–48, 50
Montenbruck O (2003) Kinematic GPS positioning of LEO satellites using ionospheric-free single
frequency measurements. Aerospace Sci. Technol. 7(5): 396-405
Montenbruck O, Gill E, Kroes R (2005) Rapid orbit determination of LEO satellites using IGS
clock and ephemeris products. GPS Solutions 9(3):226-235
Montenbruck O, Kroes R (2003) In ﬂight performance analysis of the CHAMP BlackJack GPS
receiver. GPS Solutions 7(2): 74-86
References
471

Montenbruck O, van Helleputte T, Kroes R, Gill E (2005) Reduced dynamic orbit determination
using GPS code and carrier measurements. Aerospace Sci. Technol.9(3): 261-271
Moore T, Zhang K, Close G, Moore R (2000) Real-time river level monitoring using GPS
heighting. GPS Solutions 4(2):63–67
Moreau MC, Axelrad P, Garrison JL, Long A (2000) GPS receiver architecture and expected
performance for autonomous navigation in high earth orbits. J Inst Navig 47(3):191–204
Mostafa MMR(2005) Airborne GPS augmentation alternatives. Potogramm. Eng. Remote Sens.71
(5): 545+
Mostafa MMR(2005) Direct georeferencing - Airborn GPS augmentation alternatives - Part II
satellite-based correction service. Potogramm. Eng. Remote Sens.71(7): 783-783
Mueller II (1964) Introduction to satellite geodesy. Frederick Ungar Publishing Co.
Murakami M (1996) Precise determination of the GPS satellite orbits and its new applications:
GPS orbit determination at the Geographical Survey Institute. J Geod Soc Japan 42(1):1–14
Murray CD, Dermott SF (1999) Solar system dynamics, Cambridge University Press
Musen P (1960) The Inﬂuence of the Solar Radiation Pressure on the Motion of an Artiﬁcial
Satellite, Journal of Geophysical Research, Vol. 65, No. 5, p.1391-1396
Musman S (1995) Deriving ionospheric TEC from GPS observations. In: GPS Trends in Precise
Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG
Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 258–262
Mysen E (2009) On the predictability of unstable satellite motion around elongated elestial bodies,
Astronomy & Astrophysics, Vol. 506 No.2
Niell AE (2000) Improved atmospheric mapping functions for VLBI and GPS. Earth Planets Space
52(10):703–708
Ning F, Sun Y (1992) The center form of the n-body problem generalized force potential (I): Basic
equations and theoretical analysis, Astronomy, 1992 vol 2 page 8
Ning F, Sun Y (1992) The center form of the n-body problem generalized force potential (II) - 2 ≤
n ≤4 cases Center conformation number and shape, Astronomy, 1992 vol 3
Obana K, Katao H, Ando M (2000) Seaﬂoor positioning system with GPS-acoustic link for crustal
dynamics observations. A preliminary result from experiments in the sea. Earth Planets Space
52(6):415–423
Odijk D, Marel H van der, Song I (2000) Precise GPS positioning by applying ionospheric
corrections from an active control network. GPS Solutions 3(3):49–57
O’Keefe K, Stephen J, Lachapelle G, Gonzales RA (2000) Effect of ice loading of a GPS antenna.
Geomatica 54(1):63–74
Ou J (1995) On atmospheric effects on GPS surveying. In: GPS Trends in Precise Terrestrial, Air-
borne, and Spaceborne Applications: 21st IUGG General Assembly, IAG Symposium No. 115,
Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 243–247
Ou JK, Wang ZJ (2004) An improved regularization method to resolve integer ambiguity in rapid
positioning using single frequency GPS receivers. Chinese Sci. Bull. 49(2): 196-200
Pachelski W (1995) GPS phases: Single epoch ambiguity and slip resolution. In: GPS Trends in
Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly,
IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 295–
299
Pal A (2009) An analytical solution for Kepler’s problem, MNRAS Vol. 396 Issue 3 (p1737-1742)
Pan M, Sjoeberg LE (1995) Uniﬁcation of regional vertical datums using GPS. In: GPS Trends in
Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly,
IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 94–98
Parkinson BW, Spilker JJ (eds) (1996) Global Positioning System: Theory and applications, Vol. I,
II. American Institute of Aeronautics and Astronautics, Progress in Astronautics and
Aeronautics, Vol. 163
Parkinson RW, Jones HM, Shapiro II (1960) Effects of Solar Radiation Pressure on Earth Satellite
Orbits, Science, V. 131, Issue 3404, pp. 920-921
472
References

Pavlis EC, Beard RL (1995) The Laser Retroreﬂector Experiment on GPS-35 and 36. In: GPS
Trends in Precise Terrestrial,Airborne, and Spaceborne Applications: 21st IUGG General
Assembly,IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin,
pp 154–158
Perozzi E, Ferraz-Mello S (Ed, 2010) Space manifold dynamics, Springer
Petovello MG, Lachapelle G (2000) Estimation of clock stability using GPS. GPS Solutions 4
(1):21–33
Pireaux S, Rozelot JP (2003) Solar quadrupole moment and purely relativistic gravitation
contributions to Mercury’s perihelion Advance, Astrophysics and Space Science, Vol, 284,
No. 4, P1159-1194
Pireaux S, Barriot JP, Rosenblatt P (2006) (SC)RMI: A (S)emi-(C)lassical (R)elativistic (M)otion
(I)integrator, to model the orbits of space probes around the Earth and other planets, Acta
Astronautica, Vol, 59, Issue 7, P517-523
Pitjeva EV (2005) Relativistic Effects and Solar Oblateness from Radar Observations of Planets
and Spacecraft, Astronomy Letters, Vol. 31 No. 5, p340-349
Plumb J, Larson KM, White J, Powers E (2005) Absolute calibration of a geodetic time transfer.
IEEE Trans. Ultrason.Ferr.Freq. Contr.52(11):1904-1911
Psiaki ML, Powell SP, Kintner PM Jr. (2000) Accuracy of the Global Positioning System-derived
acceleration vector. J Guid Control Dynam 23(3):532–538
Puglisi G, Briole P, Bonforte A (2004) Twelve years of ground deformation studies on Mt. Etna
volcano based on GPS surveys. Geophys. Monogr. 143: 321-341
Rabaeijs A, Grosso D, Huang X, Qi D (2003) GPS receiver prototype for integration into system-
on-chip. IEEE Trans. on Consumer Electronics 49(1): 48-58
Rajal BS, Madhwal HB (1997) Kinematic Global Positioning System survey as the solution for
quick large scale mapping. Survey rev 34(265):159–162
Reigber
C
(1997)
Geowissenschaftlicher
Kleinsatellit
CHAMP.
GPS-Anwendungen
und
Ergebnisse ’96: Beiträge zum 41. DVW-Fortbildungsseminar vom 7. bis 8. November 1996
am Geo-Forschungs-zentrum Potsdam, pp 266–273
Reigber C (1997) IERS und IGS: Stand und Perspektiven. GPS-Anwendungen und Ergebnisse
’96: Beitraege zum 41. DVW-Fortbildungsseminar vom 7. bis 8. November 1996 am Geo-
Forschungs-zentrum Potsdam, pp 34–42
Reigber C, Feissel M (1997) IERS missions, present and future. International Earth Rotation
Service (ed) Report on the 1996 IERS workshop, Paris, 50 p (IERS technical note 22)
Reigber C, Schwintzer P, Luehr H (1996) CHAMP – a challenging mini-satellite payload for
geoscientiﬁc research and application. Erste Geodaetische Woche, Stuttgart, 7.-12. Oktober
1996, 4 p)
Reigber C et al. (2003) Global gravity ﬁeld recovery using solely GPS tracking and accelerometer
data from CHAMP. Space Sci. Reviews 108(1-2): 55-66
Reigber C et al. (2005) An Earth gravity ﬁeld model complete to degree and order 150 from
GRACE: EIGEN-GRACE25.J. Geodyn. 39(1): 1-10
Reinhart E, Franke P, Habrich H, Schlueter W, Seeger H, Weber G (1997) Implications of
permanent GPS-arrays for the monitoring of geodetic reference frames. Sixth United Regional
Cartographic Conference for the America, New York, 2–6 June 1997, 10 pp
Reinking J (2009) Book review: GPS – Theory, Algorithms and Applications, Xu G 2007 2nd Ed.
ZfV - Zeitschrift für Geodäsie, Geoinformation und Landmanagement, 2009, Vol. 134 (2):
122-123
Reinking J, Angermann D, Klotz J (1995) Zur Anlage und Beobachtung grossräumiger GPS-Netze
für geodynamische Untersuchungen. Allgemeine Vermessungsnachrichten 102(6):221–231
Remondi BW, Brown G (2000) Triple differencing with Kalman ﬁltering: Making it work. GPS
Solu-tions 3(3):58–64
Remondi BW (2004) Computing satellite velocity using the broadcast ephemeris. GPS Solutions 8
(3): 181-183
References
473

Remondi BW, Brown RG (2004) A comparison of a Hi/Lo GPS constellation with a populated
conventional GPS constellation in support of RTK: A covariance analysis. GPS Solutions 8(2):
82-92
Retscher G, Chao CHJ (2000) Precise real-time positioning in WADGPS networks. GPS Solutions
4(2):68–75
Revnivykh S (2010) GLONASS Status and Progress. ION GNSS 2010, Portland, Oregon,
September 21-24, 2010.
Revnivykh S (2007) GLONASS Status, Development and Application. International Committee
on Global Navigation Satellite Systems (ICG), Bangalore, India, September 4-7, 2007.
Rizos C, Han S, Chen HY (2000) Regional-scale multiple reference stations for carrier phase-
based GPS positioning: A correction generation algorithm. Earth Planets Space 52(10):795–
800
Rizos C, Han S, Ge L, Chen HY, Hatanaka Y, Abe K (2000) Low-cost densiﬁcation of permanent
GPS networks for natural hazard navigation: First tests on GSI’s GEONET network. Earth
Planets Space 52(10):867–871
Roberts GW, Dodson AH, Ashkenazi V (2000) Experimental plan guidance and control by
kinematic GPS. Proc. Institution of Civil Engineers, Civil Engineering 138(1):19–25
Rochus P (2010) Book Review: Orbits, Xu G 2008. MatheSciNet, American Mathematical
Society, MR2494776 (2010a:70033) 70M20 (74F05 74F15)
Rochus P (2008) Private communication, for review upon request under gcxu@sdu.edu.cn
Rodolpho Vilhena De Moraes (1981) Combined solar radiation pressure and drag effects on the
orbits of artiﬁcial satellites, Celestial Mechanics, V. 25, Issue 3, pp.281-292
Rothacher M, Gurtner W, Schaer S (1995) Azimuth- and elevation-dependent phase center
corrections for geodetic GPS antennas estimated from calibration campaigns. In: GPS Trends
in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly,
IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 333–
338
Rothacher M, Mervart L (1996) Bernese GPS Software Version 4.0. Astronomical Institute of
Univer-sity of Bern
Rothacher M, Schaer S (1995) GPS-Auswertetechniken. Schriftenreihe des Deutschen Vereins für
Vermessungswesen, Bd. 18, pp 107–121
Rozelot JP and Damiani C (2011) History of solar oblateness measurements and interpretation,
The European Physical Journal H 36, 407-436
Rozelot JP, Damiani C, Lefebvre S, Kilcik A, Kosovichev AG (2011) A brief history of the solar
oblateness. A Review. Journal of Atmospheric and Solar-Terrestrial Physics 73, 2-3 (2011)
241-250
Rozelot JP, Godier S, Lefebvre S (2001) On the Theory of the Oblateness of the Sun, Solar
Physics 198, 223-240
Rozelot JP, Pireaux S, Lefebvre S, Ajabshirizadeh A (2004) Solar Rotation and Gravitational
Moments: Some Astrophysical outcomes, Proceedings of the 14/GONG 2004 Workshop, New
Haven, Connecticut, USA
Roßbach U (2006) Positioning and Navigation Using the Russian Satellite System GLONASS,
Universität der Bundeswehr München, URN: de:bvb:707-648
Rummel R, Gelderen M van (1995) Meissl scheme: Spectral characteristics of physical geodesy.
Manuscr Geodaet 20(5):379–385
Rummel
R,
Ilk
KH
(1995)
Height
datum
connection
–
the
ocean
part.
Allgemeine
Vermessungsnachrichten 102(8/9):321–330
Rush J (2000) Current issues in the use of the global positioning system aboard satellites. Acta
Astronaut 47(2–9):377–387
Rutten JAc (2004) Book review: GPS – Theory, Algorithms and Applications, Xu G 2003,
European Journal of Navigation Vol. 2 Number 1(2004) 94
474
References

Saad Nadia A, Khalil Kh I, Amin Magdy Y (2010) Analytical Solution for the Combined Solar
Radiation Pressure and Luni-Solar Effects on the Orbits of High Altitude Satellites, The Open
Astronomy Journal, vol. 3, issue 1, pp. 113-122
Salazar D, Hernandez-Pajares M, Juan-Zornoza JM, Sanz-Subirana J, Aragon-Angel A (2011)
EVA: GPS-based extended velocity and acceleration determination. J Geodesy 85(6), pp329-
340
Sandlin A, McDonald K, Donahue A (1995) Selective availability: To be or not to be? GPS World
6(9): 44–51
Satirapod C, Wang J, Rizos C (2003) Comparing different Global Positioning System data
processing techniques for modeling residual systematic errors. J. Surv. Eng. ASCE 129(4):
129-135
Schaal RE, Netto NP (2000) Quantifying multipath using MNR ratios. GPS Solutions 3(3):44–48
Schaffrin B (1995) On some alternative to Kalman ﬁltering. In: Sanso F (ed) Geodetic theory
today. Springer-Verlag, Berlin, pp 235–245
Scherrer R (1985) The WM GPS primer. WM Satellite Survey Company, Wild, Herrbrugg,
Switzerland
Schildknecht T, Dudle G (2000) Time and frequency transfer: High precision using GPS phase
measurements. GPS World 11(2):48–52
Schmid R, Rothacher M, Thaller D, Steigenberger P(2005) Absolute phase center corrections of
satellite and receiver antennas. Impact of global GPS solutions and estimation of azimuthal
phase center variations of the satellite antenna. GPS Solutions 9(4): 283-293
Schneider M (1988) Satellitengeodaesie. Wissenschaftsverlag, Mannheim
Schneider M, Cui CF (2005) Theoreme über Bewegungsintegrale und ihre Anwendung in
Bahntheorien, Bayerischen Akad Wiss, Reihe A, Heft Nr. 121, 132pp, München
Schoene T, Reigber C, Braun A (2003) GPS offshore buoys and continuous GPS control of tide
gauges. Int. Hydrogr. Rev. 4(3): 64-70
Scholl H, Marzari F, Tricarico P (2005) Dynamics of Mars Trojans, Icarus 175, 397-408
Schutz BE (2000) Numerical studies in the vicinity of GPS deep resonance. Advances in the
Astronautical Sciences 105(1):287–302
Schwarz K-P, El-Sheimy N (1995) Multi-sensor arrays for mapping from moving vehicles. In:
GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General
Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin,
pp 185–189
Schwintzer P, Kang Z, Reigber C (1995) GPS satellite-to-satellite tracking for TOPEX/Poseidon
precise orbit determination and gravity ﬁeld model improvement. J Geodyn 20(2):155–166
Seeber G (1996) Grundprinzipien zur Vermessung mit GPS. Vermessungsingenieur 47(2):53–64
Seeber G (2003) Satellite Geodesy: Foundations, Methods, and Applications, Berlin: Walter de
Gruyter, xx+589
Seeger H, Franke P, Schlueter H, Weber G (1997) The signiﬁcance and results of permanent GPS
arrays. In: Proceedings Fourteenth United Nations Regional Cartograﬁc Conference for Asia
and the Paciﬁc, Bangkok, 3–7 February 1997. 10 p
Seitz K, Urakawa MJ, Heck B, Krueger C(2005) Zu jeder Zeit an jedem Ort – Studie zur
Verfuegbarkeit und Genauigkeit von GPS-Echtzeitmessungen im SAPOS-Service HEPS.Z.
Geod.Geoinf.Landmanag.130(1):47-55
Shank C (1998) GPS navigation message enhancements. GPS World 7(4):38–44
Shapiro II (1999) A century of relativity, Reviews of Modern Physics, Vol. 71, No. 2
Shapiro II (1963) The prediction of satellite orbits, in Maurice Roy (ed) Dynamics of satellites,
pp257-312
Shaw M (2011) GPS Modernization: On the Road to the Future GPS IIR / IIR-M and GPS III. UN/
UAE/ US Workshop On GNSS Applications, Dubai, 2011.
Shen YZ, Chen Y, Zheng DH (2006) A Quaternion-based geodetic datum transformation
algorithm, J. Geodesy 80:233-239
References
475

Shen Y, Li B, Chen Y (2011) An iterative solution of weighted total least-squares adjustment.
J Geodesy 85(4), pp229-238
Shi J, Xu C, Li Y, Gao Y (2015) Impact of real-time satellite clock errors on GPS precise point
positioning-based troposphere zenith delay estimation. J Geodesy 89(8), pp747-756
Sien-Chong Wu, William GM (1993) An optimal GPS data processing technique for precise
positioning. IEEE Transactions on Geoscience and Remote Sensing, 31:146–152, January
1993.
Sigl R (1978) Geodätische Astronomie. Wichmann Verlag, Karlsruhe
Sjoeberg LE (1998) On the estimation of GPS phase ambiguities by triple frequency phase and
code data. ZfV 1235:162–163
Skaloud J, Schwarz KP (2000) Accurate orientation for airborne mapping systems. Photogramm
Eng Rem S 66(4):393–401
Smith AJE, Hesper ET, Kuijper DC, Mets GJ, Visser PN, Ambrosius BAC, Wakker KF (1996)
TOPEX/ Poseidon orbit error assessment. J Geodesy 70:546–553
Snow KB, Schaffrin B (2003) Three-dimensional outlier detection for GPS networks and their
densiﬁcation via the BLIMPBE approach. GPS Solutions 7(2): 130-139
Spilker JJ (1996) GPS navigation data. In: Parkinson BW, Spilker JJ (eds) Global Positioning
System: Theory and applications, Vol. I, Chapter 4
Springer TA, Beutler G, Rothacher M (1999) Improving the orbit estimates of GPS satellites.
J Geodesy 73:147–157
Steigenberger P, Boehm J, Tesmer V (2009) Comparison of GMF/GPT with VMF1/ECMWF and
implications for atmospheric loading. J Geodesy 83:943
Sterle O, Stopar B, Preseren PP (2015) Single-frequency precise point positioning: an analytical
approach. J Geodesy 89(8), pp 793-810
Stoew B, Elgered G (2004) Characterization of atmospheric parameters using a ground based GPS
network in north Europe. J. Meteor. Soc. Japan 82(1B): 587-596
Stowers D, Moore A, Iijima B, Lindqwister U, Lockhart T, Marcin M, Khachikyan R (1996) JPL-
supported permanent tracking stations. International GPS Service for Geodynamics: 1996
annual report, Nov. 1997, Pasadena, pp 409–420
Sturrock PA, Gilvarry JJ (1967) Sloar Oblateness and Magnetic Field, Nature, Vol 216
Sun HP, Ducarme B, Dehant V (1995) Effect of the atmospheric pressure on surface
displacements. J Geodesy 70:131–139
Tapley BD, Schutz BE, Eanes RJ, Ries JC, Watkins MM (1993) Lageos laser ranging
contributions to geodynamics, geodesy, and orbital dynamics. In: Contributions of Space
Geodesy to Geodynamics: Earth Dynamics, Geodyn. Ser. 24:147–174
Testoyedov N (2015) Space Navigation in Russia: History of Development. United Nations /
Russian Federation Workshop on the Applications of Global Navigation Satellite Systems,
Krasnoyarsk, May 18-22, 2015.
Tetreault P, Kouba J, Heroux P, Legree P (2005) CSRS-PPP: An Internet service for GPS user
access to the Canadian Spatial reference Frame. Geomatica 59(1): 17-28
Teunissen P (1996) An analytical study of ambiguity decorrelation using dual frequency code and
carrier phase. J Geodesy 70(8):515–528
Teunissen P (1997) Closed form expressions for the volume of the GPS ambiguity search spaces.
Artiﬁcial Satellites, Journal of Planetary Geodesy 32(1):5–20
Teunissen P (2005) GNSS ambiguity resolution with optimally controlled failure-rate. Artiﬁcial
Satellites40(4):219-227
Teunissen P (1996) GPS carrier phase ambiguity ﬁxing concepts. In: Kleusberg A, Teunissen PJG
(eds) GPS for geodesy. Springer-Verlag, Berlin
Teunissen P (1998) Minimal detectable biases of GPS data. J Geodesy 72:630–639
Teunissen P (2004) Penalized GNSS Ambiguity resolution. J. Geod. 78(4-5): 235-244
Teunissen P (2003) Towards a uniﬁed theory of GPS ambiguity resolution. J. GPS 2(1): 1-12
Teunissen P, Jonge P, Tiberius C (1997) Performance of the LAMBDA method for fast GPS
ambiguity resolution. J Inst Navig 44(3):373–383
476
References

Teunissen PJG, Kleusberg A (1996) GPS observation equations and positioning concepts. In:
Kleusberg A, Teunissen PJG (eds) GPS for geodesy. Springer-Verlag, Berlin
Theakstone WH, Jacobsen FM, Knudsen NT (2000) Changes of snow cover thickness measured
by conventional mass balance methods and by global positioning system surveying.
Geograﬁska Annaler 81(A4):767–776
Tiberius CCJM, Kenselaar F (2000) Estimation of the stochastic model for GPS code and phase
observables. Survey rev 35(277):441–454
Tiberius C (2003) Standard Positioning Service: Handheld GPS receiver accuracy. GPS World 14
(2): 46-51
Timmen L, Ye X (1997) SAR-Interferometrie unterstützt durch GPS zur Überwachung von
Erdoberﬂächendeformationen. GPS-Anwendungen und Ergebnisse ’96: Beiträge zum 41.
DVW-Fortbildungsseminar vom 7. bis 8. November 1996 am GeoForschungszentrum
Potsdam, pp 104–114
Timmen L, Bastos L, Boebel T, Cunha S, Forsberg R, Gidskehaug A, Hehl K, Meyer U,
Nesemann M, Olesen AV, Rubek F, Xu G (1998) The European Airborne Geoid Mapping
System for Coastal Oceanography (AGMASCO). Progress in Geodetic Science at GW 98. In:
Proceedings of the Geodetic Week 1998. University of Kaiserslautern, Germany, Shaker press,
Aachen
Touma JR, Tremaine S, Kazandjian MV (2009) Gauss’s methods for secular dynamics, softened,
MNRAS Vol. 394 Issue 1 (p 1085-1108)
Tsai C, Kurz L (1983) An adaptive robustiﬁng approach to Kalman ﬁltering. Automatica 19:279–
288
Tscherning C, Rubek F, Forsberg R (1997) Combining airborne and ground gravity using
collocation, Scientiﬁc Assembly of the International Association of Geodesy in conjunction
with 28th Brazilian Congress of Cartography; Rio de Janeiro, 3–9 September 1997, 6 pp
Tsujii T, Harigae M, Inagaki T, Kanai T (2000) Flight tests of GPS/GLONASS precise positioning
versus dual frequency KGPS proﬁle. Earth Planets Space 52(10):825–829
Tregoning P, van Dam T (2005) Atmospheric pressure loading corrections applied to GPS data at
the observing level. Geophys. Res. Lett.32(L22310):1-4
Urlichich Y, Subbotin V, Stupak G, et al. (2010) GLONASS Developing Strategy. ION GNSS
2010, the 23rd International Technical Meeting of the Institute of Navigation, Portland, Oregon,
September 21-24, 2010.
Urlichich Y, Subbotin V, Stupak G, et al. (2011) Innovation: GLONASS Developing strategies for
the Future, GPS World, April, pp42-49
UrschlC, Dach R, Hugentobler U, Schaer S, Beutler G(2005) Validating ocean tide loading models
using GPS.J. Geod.78(10):616-625
van Dam T, Francis O (eds) (2004) The state of GPS vertical positioning precision: Separation of
Earth processes by space geodesy. Centre Europeen de Geodynamique et de Seismologie,
Luxembourg, Cahiers 23: xxii+176.
van Sickle J (2003) GPS for Land Surveyors (2nd ed.) Chelsea, MI, Sleeping Bear Press: xii+284
Verhagen S (2004) Integer ambiguity validation: An open problem? GPS Solutions 8(1): 36-43
Visser PNAM, IJssel J van den (2000) GPS-based precise orbit determination of the very low
Earth-orbiting gravity mission GOCE. J Geodesy 74(7/8):590–602
Vittorini LD, Robinson B (2003) Receiver frequency standards. Optimizing indoor GPS
performance. GPS World 14(11): 40-42, 44, 46-48
Vokrouhlický D, Milani A (2000) Direct Solar Radiation Pressure on orbits of small near-Earth
asteroids: observable effects? A&A, v.362, p.746-755
Vokrouhlicky D, Farinella P, Mignard F (1993) Solar radiation pressure perturbations for Earth
satellites, I: A complete theory including penumbra transitions, A&A v. 280, p. 295-312
Vokrouhlicky D, Farinella P, Mignard F (1994) Solar radiation pressure perturbations for Earth
satellites, II. an approximate method to model penumbra transitions and their long-term orbital
effects on LAGEOS, A&A V. 285, 333-343
References
477

Vollath U, Birnbach S, Landau H (1998) An analysis of three-carrier ambiguity resolution (TCAR)
technique for precise relative positioning in GNSS-2. Proceedings of ION GPS-98, The 11th
International Technical Meeting of the Satellite Division of the Institute of Navigation,
Nashville, Tennessee, USA, September 15-18, pp. 417-426
Wagner C, Klokocnik J (2003) The value of ocean reﬂections of GPS signals to enhance satellite
altimetry: data distribution and error analysis. J. Geod. 77(3-4): 128-138
Wagner J, Bauer M (1997) GPS-Vermessung mit Echtzeitauswertung (RTK-Vermessung): ein
Beitrag zur Einschätzung der Praxistauglichkeit und Praxisrelevanz. Vermessungsingenieur 48
(2):87–92
Wagner JF (2005) GNSS/INS integration: still an attractive candidate for automatic landing
systems? GPS Solutions9(3):179-193
Wang CM, Hajj G, Pi XQ, Rosen IG, Wilson B (2004) Development of the Global Assimilative
Ionospheric Model. Radio Sci. 39(1) RS1S06: 1-11
Wang G, Wang H, Xu G (1995) The principle of the satellite altimetry. Science Press, Peking,
ISBN 7-03-004499-1/P.797, 390 p, (in Chinese)
Wang J (2000) An approach to GLONASS ambiguity resolution. J Geodesy 74(5):421–430
Wang J, Rizos C, Stewart MP, Leick A (2001) GPS and GLONASS integration-Modeling and
Ambiguity Resolution Issues. GPS Solutions 5(1), 55-64.
Wang J, Steward MP, Tsakiri M (1999) Adaptive Kalman ﬁltering for integration of GPS with
GLONASS and INS. Presentation in the XXIIth IUGG, Birmingham, England
Wang J, Stewart MP, Tsakiri M (2000) A comparative study of the integer ambiguity validation
procedures. Earth Planets Space 52(10):813–817
Wang JG (1997) Filtermethoden zur fehlertoleranten kinematischen Positionsbestimmung.
Neubiberg, 135 S
Wanninger L (1999) Der Einﬂuss ionosphärischer Störungen auf die präzise GPS-Positionierung
mit Hilfe virtueller Referenzstationen. ZfV 10:322–330
Wanninger L (2003) Permanent GPS-Stationen als Referenz fuer praezise kinematische
Positionierung. Photogramm. Fernerkund. Geoinf. 7(4): 343-348
Wanninger
L
(2003)
Virtuelle
GPS-Referenzstationen
fuer
großraeumige
kinematische
Anwendungen. Z.f. Verm.wessen 128(3): 196-202
Ware RH, Fulker DW, Stein SA, Anderson DN, Avery SK, Clark RD, Droegemeier KK, Kuettner
JP, Minster J, Sorooshian S (2000) Real-time national GPS networks: Opportunities for
atmospheric sensing. Earth Planets Space 52(11):901–905
Warnant R, Pottiaux E (2000) The increase of the ionospheric activity as measured by GPS. Earth
Planets Space 52(11):1055–1060
Wayte R (2010) On the Estimated Precession of Mercury's Orbit, submitted to PMC Physics A
Weber G (1994) Initial operational capability für das GPS: aktuelle Entwicklungen der US
Satellitennavigation.
SATNAV
94:
Satellitennavigationssysteme
–
Grundlagen
und
Anwendungen, DGON-Seminar, Hamburg 24.–26. Oktober 1994, pp 1–14
Weber R (1996) Monitoring Earth orientation variations at the Center for Orbit Determination in
Europe (CODE). Oesterr Z Vermess Geoinf 84(3):269–275
Weiland C (2010) Computational space ﬂight mechanics, Springer
Wickert J, Schmidt T, Beyerle G, Konig R, Reigber C (2004) The radio occultation experiment
aboard CHAMP: Operational data analysis and validation of vertical atmospheric proﬁles.
J. Meteor. Soc. Japan 82(1B): 381-395
Wicki F (1998) Robuste Schätzverfahren für die Parameterschätzung in geodätischen Netzen.
Technische Hochschule Zürich
Wieser A, Brunner FK (2000) An extended weight model for GPS phase observations. Earth
Planets Space 52(10):777–782
Williams SDP (2003) Offsets in Global Positioning System time series. J. Geophys. Res 108(B6):
ETG12/1-13
Witte TH, Wilson AM (2004) Accuracy of non-differential GPS for the determination of speed
over ground. J. Biomechanics 37(12): 1891-1898
478
References

Wolverton M (2004) The depths of space: the Pioneer planetary probes, Joseph Henry Press, ISBN
0-309-09050-4
Won J-H,Lee J-S(2005) A note on the group delay and phase advance phenomenon associated
with GPS signal propagation through theionosphere.Navigation52(2):95-97
Wu CC, Kuo HC, Hsu HH, Jou BJD (2000) Weather and climate research in Taiwan: Potential
application of GPS/MET data. Terr Atmos Ocean Sci 11(1):211–234
Wu J, Lin SG (1995) Height accuracy of one and a half centimetres by GPS rapid static surveying.
Int J Remote Sens 16(15):2863–2874
Wuebbena
G
(1991)
Zur
Modellierung
von
GPS-Beobachtungen
für
die
hochgenaue
Positionsbestimmung. Unversität Hannover
Wuebbena G, Seeber G (1995) Developments in real-time precise DGPS applications: concepts
and status. In: GPS Trends in Precise Terrestrial, Airborne, and Spaceborne Applications: 21st
IUGG General Assembly, IAG Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-
Verlag, Berlin, pp 212–216
Xia Y, Michel GW, Reigber C, Klotz J, Kaufmann H (2003) Seismic unloading and loading in
northern central Chile as observed by differential Synthetic Aperture Radar Interferometry (D-
INSAR) and GPS. Int. J. Remote Sensing 24(22): 4375-4391
Xu CJ, Liu JN, Song CH, Jiang WP, Shi C (2000) GPS measurements of present-day uplift in the
Southern Tibet. Earth Planets Space 52(10):735–739
Xu G (1984) Very long baseline interferometry and tidal theories. The Institute of Geodesy and
Geophysics, Chinese Academy of Sciences, M.Sc. Thesis No. 84011, (in Chinese)
Xu G (1999): KGsoft – Kinematic GPS Software – Software User Manual, Version of 1999, Kort
& Matrikelstyrelsen (National Survey and Cadastre – Denmark), ISBN 87-7866-158-7, ISSN
0109-1344, 35 pages, in English
Xu G (2003a) A diagonalization algorithm and its application in ambiguity search. J. GPS 2(1):
35-41
Xu G (2011): GPS – Theory, Algorithms and Applications, 1st Ed in Chinese, Tschinghua
University Press Peking, ISBN 978-7-302-27164-2, 332 pages, translated from Xu (2007):
GPS – Theory, Algorithms and Applications, 2nd Ed, Springer, in translation series of Space
Technology of Springer, translation organised by the Peking Institute of Satellite Controlling
and Telecommunication, translated by Qiang Li, Guangjun Liu, Hailiang Yu, Bo Li, and
Haiying Luo, proved by Xurong Dong.
Xu, G. (2014): GPS – Theory, Algorithms and Applications, 1st Ed in Persian, Iran Technical
University Press, ISBN 978-7-302-27164-2, 332 pages, translated from Xu (2007): GPS –
Theory, Algorithms and Applications, 2nd Ed, Springer, translation organized by the Iran
Technical University.
Xu G, Hehl K, Angermann D (1994) GPS software development for use in aerogravimetry:
Strategy, realisation, and ﬁrst results. In: Proceedings of ION GPS-94, pp 1637–1642
Xu G, Timmen L (1997) Airborne gravimetry results of the AGMASCO test campaign in
Braunschweig. Geodetic Week Berlin ’97, Oct. 6–11, 1997, electronic version published in
http://www.geodesy.tu-berlin.de
Xu P, Ando M, Tadokoro K (2005) Precise, three-dimensional seaﬂoor geodetic deformation
measurements using differential techniques. Earth, Planetsand Space57(9): 795-808
Xu P (1995) Estimating the state vector in observable and singular hybrid INS/GPS systems
without the knowledge of initial conditions. Bull Geod Sci Afﬁni 54(4):389–406
Xu Y, Yang Y, Xu G, Jiang N (2013) Ionospheric delay in the Antarctic GPS positioning. Journal
of Beijing University of Aeronautics and Astronautics, 39(10), pp1370-1375
Xu Y, Yang Y, Xu G (2012) Precise determination of GNSS trajectory in the Antarctic airborne
kinematic positioning. In: Proceedings / China Satellite Navigation Conference (CSNC) 2012:
revised selected papers, (Lecture Notes in Electrical Engineering; vol. 159), Springer, pp 95-
105
Yang M (2005) Noniterative method of solving the GPS doubled-differenced pseudorange
equations. J. Surv. Eng. ASCE 131(4):130-134
References
479

Yang Y (1993) Robust estimation and its applications. Bayi Publishing House, Peking
Yang Y (1994) Robust estimation for dependent observations. Manuscr Geodaet 19:10–17
Yang Y, Gao W (2010) Robust Kalman ﬁltering with constraints: a case study for integrated
navigation. J Geodesy 84(6), pp373-381
Yang YX, Xu TH, Song LJ (2005) Robust estimation of variance components with application in
global positioning system network adjustment. J. Surv.Eng.ASCE131(4): 107-112
Yang Y, Zha M, Song L, Wei Z et al. (2005) Combined adjustment project of national
astronomical geodetic networks and 2000’ national GPS control network. Progress Natural
Sci.15(5):435-441
Yeh TK, Chen CS (2006) Clarifying the relationship between the clock errors and positioning
precision of GPS receiver, VI Hotline-Marussi Symposium of Theoretical and Computational
Geodesy Wuhan.
Yeh TK, Chen CS, Lee CW (2004) Sensing of precipitable water vapor in atmosphere using GPS
technology. Boll. Geod. Sci. Afﬁni 63(4): 251-258
Yi ZH, Li GY, Luo YJ, Xia Y, Zhao HB (2010) Common orbital plane restricted three-body
problem and its application - Science in China: G Series, 2010
Yonetoku D, Murakami T, Gunji S, et al (2010) Gamma-Ray Burst Polarimeter – GAP – aboard
the Small Solar Power Sail Demonstrator IKAROS, arXiv: 1010.5305v1 [astro-ph.IM] 26 Oct
2010
Yoon JC, Lee BS, Choi KH (2000) Spacecraft orbit determination using GPS navigation solutions.
Aerosp Sci Technol 4(3):215–221
Yuan YB, Ou JK (2003) Preliminary results and analyses of using IGS GPS data to determine
global ionospheric TEC. Progress Natural Sci. 13(6):446-450
Yuan YB, Ou JK (2004) Ionospheric eclipse factor method (IEFM) for determining the
ionospheric delay using GPS data. Progress Natural Sci. 14(9): 800-804
Yunck TP, Melbourne WG (1995) Spaceborne GPS for earth science. In: GPS Trends in Precise
Terrestrial, Airborne, and Spaceborne Applications: 21st IUGG General Assembly, IAG
Symposium No. 115, Boulder, USA, July 3–4, 1995. Springer-Verlag, Berlin, pp 113–122
Zehentner N, Mayer-Guerr T (2015) Precise orbit determination based on raw GPS measurements.
J Geodesy, DOI: 10.1007/s00190-015-0872-7.
Zhang Q, Qiu H (2004) A dynamic path search algorithm for tractor automatic navigation. Trans.
ASAE 47(2): 639-646
Zhang Q, Moore P, Hanley J, Martin S (2006) Auto-BAHN: Software for Near Real-time GPS
Orbit and Clock Computation.
Zhang X, Forsberg R (2009) Assessment of long-range kinematic GPS positioning errors by
comparison with airborne laser altimetry and satellite altimetry. J Geodesy 81(3), pp201-211
Zhang W, Cannon M, Julien O, Alves P (2003) Investigation of combined GPS/GALILEO
cascading ambiguity resolution schemes. Proceedings of ION GPS/GNSS 2003, The 16th
International Technical Meeting of the Satellite Division of the Institute of Navigation,
Portland, OR, USA, September 9-12, pp. 2599-2610
Zhao CM, Ou JK, Yuan YB (2005) Positioning accuracy and reliability of GALILEO, integrated
GPS-GALILEO system based on single positioning model. Chinese Sci. Bull.50 (12): 1252-
1260
Zhao CM, Yuan YB, Ou JK, Chen JP(2005) Variation properties of ionospheric eclipse factor and
ionospheric inﬂuence factor. Progress Natural Sci.15(6): 573-576
Zheng DW, Zhong P, Ding XL, Chen W(2005) Filtering GPS time-series using aVondrak ﬁlter
and cross-validation.J.Geod.79(6-7): 363-369
Zhou J (1989) Classical theory of errors and robust estimation. Acta Geod Cartogr Sinica 18:115–
120
Zhu J (1996) Robustness and the robust estimate. J Geodesy 70(9):586–590
Zhu SY (1997) GPS-Bahnfehler und ihre Auswirkung auf die Positionierung. GPS-Anwendungen
und Ergebnisse ’96: Beiträge zum 41. DVW-Fortbildungsseminar vom 7. bis 8. November
1996 am GeoForschungszentrum Potsdam, pp 219–226
480
References

Zhu S, Reigber C, Koenig (2004) Integrated adjustment of CHAMP, GRACE, and GPS data.
J. Geod. 78(1-2): 103-108
Zhu WY, Fu Y, Li Y (2003) Global elevation vibration and seasonal changes derived by the
analysis of GPS height. Science in China, Ser. D 46(8): 765-778
Ziebart M, Cross P (2003) LEO GPS attitude determination algorithm for a micro-satellite using
boon-arm deployed antennas. GPS Solutions 6(4): 242-256
Zizka J, Vokrouhlicky D (2011) Solar radiation pressure on (99942) Apophis, Icarus, V. 211, Issue
1, p. 511-518
References
481

Index
A
A priori constraint, 182, 183, 220, 221, 226,
257, 258
A priori datum, 173, 182, 183, 187, 220, 221,
226, 301, 304
A priori information, 219, 220, 225, 257, 265,
274, 437, 438
Accuracy, 4, 5, 7–9, 11, 13, 79, 88, 94,
102–104, 108, 110, 111, 114, 121, 122,
150, 192, 212, 236, 293, 306, 311, 321,
326, 329, 331, 332, 337, 338, 391, 394,
396, 397, 440
Adams algorithms, 391, 395, 397
Adaptively robust Kalman ﬁlter, 187, 212, 217,
225
Additional perturbation, 365–367
Adjustment, 1–3, 136, 149, 170, 183, 187,
191–196, 198, 201, 203, 204, 208, 209,
212, 218, 220, 221, 224, 225, 231, 232,
234–238, 271, 276, 296, 300, 306, 308,
330, 331, 360–362, 365, 379, 383, 440
Airborne, 91, 103, 104, 117, 120, 287, 288,
313, 324, 329, 337
Aircraft, 120, 224, 225, 323, 325, 329–331,
334, 337, 339
Altimetry, 117, 118, 120, 329, 337
Ambiguity, 243, 244
criterion, 224, 231, 232, 236, 238, 239,
241, 243–245, 247, 248, 330
ﬁxing, 168, 171, 196, 231, 236, 241, 243,
245–247, 251–253, 255, 257, 309, 311,
330
function, 134, 229, 232, 247–250
ionospheric equation, 147, 252, 256, 257,
291, 295, 299
resolution, 231, 232, 245–247, 251, 252,
255, 257–259, 311, 337
search, 224, 229, 231, 232, 234–236, 238,
239, 241–245, 247, 257, 330, 339
Antenna phase centre, 122, 125, 126
Anti-spooﬁng (AS), 63, 121, 232
Apogee, 43
Apparent sidereal time, 25, 27
Argument
of latitude, 7, 48, 50
of perigee, 43, 44, 369, 413, 419, 429
Ascending node, 3, 7, 9, 26, 27, 30, 40, 43, 44,
50, 365, 369, 370, 413, 419, 420, 426,
430
Astronomical coordinate system, 23
Atmospheric
drag, 49, 134, 362, 364, 397, 406, 434
pressure, 81, 84
Attraction, 353
Azimuth, 23, 70, 71, 74, 87, 108, 139, 140, 331
B
Barycentre, 33
Barycentric Dynamic Time (TDB), 33
Baseline, 89, 103, 110, 115, 154, 155, 158,
160, 178, 181, 249, 251, 252, 255,
266–269, 271, 274, 277, 278, 287–289,
327, 331, 334, 338, 379
BeiDou Navigation Satellite System (BDS), 1,
12, 11, 12, 35, 53
Block-wise least squares adjustment, 187, 196,
198, 203, 276, 296
Broadcast ephemerides, 3, 49, 52, 122
Broadcast ionospheric model, 70, 72
C
Carrier phase, 13, 55, 57, 66, 116, 133, 253,
294, 298, 321
Cartesian coordinates, 119, 343, 351, 399
Celestial Reference Frame (CRF), 24
Central force, 37, 39, 49, 350, 410
© Springer-Verlag Berlin Heidelberg 2016
G. Xu and Y. Xu, GPS, DOI 10.1007/978-3-662-50367-6
483

Clock
bias, 56, 111, 265
drift, 303, 304
error, 51, 56, 57, 59, 61, 99, 110–114,
116, 119, 138, 139, 153, 156, 172,
176, 179, 184, 225, 266, 267, 270,
271, 274, 278, 280, 291–297, 299,
301, 302, 307, 318, 438
frequency, 97, 304
offset, 52, 99
parameter, 265, 295
Code
delay, 63
phase combination, 200, 246
pseudorange, 133, 161, 292, 298
smoothing, 152
Cofactor matrix, 189, 276
Combining algorithms, 163–171, 264, 265,
275, 276, 279, 439
Conditional least squares adjustment, 187, 193,
195, 219, 232, 234
Constrained adjustment, 187, 219
Conventional International Origin (CIO), 17,
24
Conventional Terrestrial System (CTS), 17
Coordinate
system, 11, 13, 17, 21–24, 28, 38, 47, 49,
51, 97, 135, 307, 345, 360, 361, 365,
368, 371, 398, 414, 430
transformation, 28, 32, 135, 317, 373
Correlation, 55, 94, 121, 136, 155, 160, 178,
273, 438
Covariance
matrix, 141, 147, 155, 157, 160, 164, 170,
208, 213, 306
propagation, 133, 141, 207, 307
Cowell algorithms, 387, 394, 397
Cycle slip
detection, 151, 152, 229, 230, 291
D
Data
combination, 2, 133, 142, 144, 171, 298
condition, 271, 274, 275, 277, 278
differentiation, 133, 152, 280
processing, 2, 87, 109, 111, 116, 160, 168,
170–172, 182, 198, 224, 225, 277, 291,
304, 320, 329, 439
Diagonalisation, 205, 206, 225, 448
Differencing algorithms, 133, 160, 172, 263,
265, 275, 278, 439, 440
Differential
Doppler, 133, 150, 151, 305, 317
equation, 42, 106, 342, 385, 396, 411
GPS, 104, 122, 182, 184, 296, 301, 326,
327
phases, 152, 230
positioning, 301, 326
Dilution of Precision (DOP), 13, 307
Disturbed Satellite Motion, 49
Disturbing
force, 49, 355, 357, 394, 397, 402
potential, 350, 365, 413, 429
Doppler
data, 111, 148, 230, 302, 304
effect, 60
frequency shift, 60
integration, 133, 150, 151, 230
Double difference, 114, 156–158, 160, 179,
182, 253, 266, 301, 328, 438
Drag, 291, 341, 348, 364, 407
Dry component, 81
Dual frequency, 322
Dynamic time, 33
E
Earth
Centred–Earth–Fixed (ECEF), 17
Centred–Ecliptic–Inertial Coordinate
System (ECEI), 24
Centred–Inertial system (ECI), 24
Centred–Space–Fixed (ECSF), 24, 38, 47,
49, 352, 357, 361, 365, 369
gravitational ﬁeld, 134, 348, 352
potential, 350
rotation, 20, 25, 27, 28, 32, 57, 302, 366
rotational effect, 97, 98
tide displacement, 99, 101, 104
Eccentric anomaly, 44, 46, 99, 369, 414, 430
Eccentricity, 43, 44, 50, 99, 363, 413, 429
Ecliptic, 24, 26, 369, 370
Electronic density, 65, 66, 170
Elevation, 70, 71, 88, 92, 331
Ellipsoidal
coordinates, 18
height, 18
mapping function, 75, 85
Emission time, 55, 57, 58, 111, 122, 137, 302
Ephemerides
of satellite, 3
of the Sun, the Moon and planets, 102, 316,
341, 368, 369
484
Index

Equatorial
plane, 17, 32, 33, 39, 43, 416
system, 25
Equivalence
theorem, 2, 274, 276, 287
Equivalent criterion, 231, 232, 241, 242, 244
Equivalent observation equation, 172–175,
187, 204, 206, 225, 240, 281, 283, 284,
290, 451
F
Fictitious observations, 219
Flight state monitoring, 324, 331
Float
ambiguity, 251, 257
solution, 234, 235, 237, 239, 242, 255
Frequency
drift, 112, 303
effect, 97
offset, 52, 114
reference, 114
Fundamental frequency, 3, 97, 253
G
Gain matrix, 207, 209
Galileo, 1, 2, 9, 10, 13, 14, 22, 35, 53, 246, 313
Galileo carrier phase ambiguity resolution, 245
Gaussian equations, 410, 412, 415, 416, 431,
434
Gauss-Xu equations
derivation, 411, 431
General criterion, 224, 231, 237–240, 242, 243,
245, 246, 330
General relativity, 94, 96, 98, 99, 341
Geocentric
distance, 50, 98, 100, 101, 354, 356, 358,
361, 363
latitude, 18, 74, 363
Geometric co-mapping function, 86
Geometric dilution of precision (GDOP), 307
Geometric mapping function, 74, 75
Geometry-free combination, 145, 147–149,
164, 165, 167, 280
GLONASS, 1, 7–9, 13, 14, 20, 22, 35, 52, 53,
112, 322
GNSS, 1, 7–9, 13, 80, 90, 112–114, 171, 218,
281, 287, 296, 308, 309, 322, 440, 441
GPS, 1–10, 13, 14, 22–24, 33–35, 37, 49,
51–53, 55–60, 63, 64, 66, 67, 69–71,
76, 77, 80, 87, 93, 94, 96–99, 102–104,
109–112, 114–122, 125–127, 133, 134,
136, 137, 140, 142, 146, 147, 149, 151,
152, 154, 155, 158, 160, 161, 163, 168,
170, 172, 181–184, 187, 198, 208, 217,
224, 231, 232, 234, 239, 240, 242, 243,
245–248, 250–253, 255
GPS
altimetry, 118, 120
modernization, 4, 5
observation equation, 133, 142, 145, 146,
161, 168, 169, 172–175, 177–181, 183,
187–191, 193, 195, 196, 198–200, 202,
204–206, 219, 231, 234, 239, 240, 250,
264, 275, 276, 280, 299, 300, 380, 383,
385, 397, 438, 439
software, 2, 114, 121, 232, 255, 318, 320,
321, 323, 330, 338
time, GPST, 33, 35
week, 34, 35
Gravitational
constant, 37, 50, 97, 99–102, 106, 343, 350,
354, 356, 371, 372, 402, 425
ﬁeld, 23, 33, 96, 134, 348, 351, 352
force, 348, 409
potential, 97, 367
Greenwich
hour angle, 33
meridian, 17, 25, 27, 33
sidereal, 32, 33, 51, 373
Greenwich Apparent Sidereal Time (GAST),
25, 27, 32
Greenwich Mean Sidereal Time (GMST), 27
Group delay, 71
H
Helmert transformation, 22
Hopﬁeld model, 83, 84, 88
Horizontal dilution of precision (HDOP), 308
Horizontal plane, 22
Hour angle, 33, 101, 354
I
IAU 2000, 28, 31
Inertial navigation system (INS), 332, 336, 337
Initial
state, 342, 383–385
value, 135, 208, 225, 292, 299, 301, 304,
306, 385–387, 391, 393, 394, 396, 401
Index
485

value problem, 385–387, 391
Instrumental bias, 57, 63, 126, 231, 295,
437–439
Integer ambiguity, 116, 224, 229, 231–236,
238, 239, 241, 244, 245, 253, 257, 258,
330
Integration, 39, 40, 42, 44, 46, 60, 65, 78, 80,
81, 133, 230, 251, 255, 311, 349, 356,
375, 378, 383, 385, 391, 393, 396, 397,
411, 413, 416, 418, 434, 440
Intelligent Kalman ﬁlter, 218
International
Atomic Time, TAI, 33
Earth Rotation Service, IERS, 31–33, 51,
369
GPS Service for Geodynamics, IGS, 51, 52,
56, 109, 122, 296
International Astronomical Union (IAU),
26–28, 31, 443
International Earth Rotation Service (IERS),
20, 26, 28, 29, 31–33, 50, 51, 99,
101–103, 109, 369
International GNSS Service (IGS), 114
International GPS Service for Geodynamics
(IGS), 3, 51, 52, 56, 109, 114, 122, 125,
248, 277, 291, 292, 296, 297, 302, 304,
311, 326, 360, 379, 397
International Terrestrial Reference Frame
(ITRF), 20
Interpolation, 52, 79, 89, 91, 310, 341, 387,
392, 397
Ionosphere-free combination, 67, 68, 144, 145,
162–164, 252–258, 291, 294, 295, 297,
299, 330
Ionospheric
ambiguity correction, 252, 253, 255–257
effect, 57, 59, 63, 65–67, 69, 71, 72, 76,
116, 122, 134, 135, 144, 145, 150, 249,
252–257, 294, 298, 330, 331, 339
model, 3, 69, 71–74, 76, 78–80, 122, 146,
148, 254, 291, 294, 311
residual, 133, 149, 150, 230, 253–255
J
Julian Date (JD), 24, 34
K
Kalman ﬁlter, 113, 137, 151, 187, 206, 208,
209, 212, 213, 216, 218, 225, 305, 306,
321
Keplerian
elements, 47–49, 344–346, 366, 370, 373,
378–382, 410, 413, 416, 417, 419, 429
ellipse, 343
equation, 44, 46, 51, 369
motion, 37, 49, 368
Kinematic
ionospheric model, 3, 69, 71–73, 76,
78–80, 122, 254, 291, 311
positioning, 1, 2, 91, 119, 151, 212, 213,
287, 297, 313, 321, 323, 324, 326–332,
335, 339
L
Lagrange
interpolation, 52, 397
polynomial, 51, 53
Lagrange-Xu equations
derivation, 419
Lagrangian equations, 410–413, 416–418
Least squares adjustment (LS Adjustment),
187, 189, 191, 193, 195, 198, 201, 204,
208, 210, 219, 224, 225, 232, 234
Least squares ambiguity search criterion
(LSAS criterion), 242, 243, 245
Linear
combination, 53, 66, 143, 144, 246, 252,
311
correlation, 438
transformation, 133, 141, 147, 157, 171,
172, 263, 266, 269, 276, 439
Linearization, 133, 135, 136, 299, 331, 397
Loading tide, 57, 59, 63, 99, 105, 106,
108–110, 134, 141, 291, 327, 338, 341,
402
Local coordinate system, 22, 23, 307
Lock-wise least squares adjustment, 224
Loss of lock, 151, 229, 230, 232
M
Mapping function, 66, 71, 73–76, 81, 82,
85–90, 146, 168, 170, 254
Mean anomaly, 26, 45, 46, 369, 411, 413, 415,
419, 420, 430
Minimum spanning tree, 277
Modiﬁed Julian Date (MJD), 34
Multipath, 57, 59, 61, 63, 114–117, 120, 121,
134, 292, 297
Multiple static references, 327, 334, 335, 337
486
Index

N
Narrow lane, 167
Navigation message, 11, 49, 52, 53, 56, 99,
122, 292, 302
Normal equation, 173, 176–180, 183, 187,
189–191, 196, 197, 199, 201, 202,
204–206, 219–222, 224–226, 239, 240,
264–266, 272, 275, 283, 289, 290, 305,
306, 437, 438, 440, 447, 448, 450, 452
Numerical
differentiation, 150, 385
eccentricity, 74
integration, 230, 250, 341, 383
Integration, 387, 434
Nutation, 24–27, 30–32, 367, 369, 443
O
Observational Model, 135
Ocean loading tide displacement, 105
Ocean tide, 49, 105, 107, 108, 297, 327, 341,
348, 354, 356, 357
Optimal baseline, 154, 277, 278
Orbit
correction, 49, 341, 379, 380
determination, 1, 2, 12, 49, 56, 77, 123,
134, 208, 217, 218, 291, 299, 321, 322,
341, 360, 361, 383, 384, 397, 409, 416,
434
Orbital
coordinate system, 47
mechanics, 1, 412
plane, 3, 7, 9, 11, 39, 40, 42, 44–46, 50,
345, 368, 381, 411, 414, 416, 430
P
Parameterisation, 2, 84, 85, 87, 110, 163, 168,
170, 175, 229, 252, 253, 263–267, 271,
273–276, 279, 280, 287, 383, 437–439
Partial derivatives, 133, 137–140, 299, 341,
345, 346, 352, 355, 366, 373, 380–384,
388, 389, 398, 401, 402, 404, 406, 407,
417, 430
Path delay, 74, 76, 80, 81, 83–85, 87, 146
Path range effect, 98
P-code, 116
Perigee, 43, 44, 46, 47, 344, 365, 368, 369,
413, 414, 416, 419, 422, 426, 429
Perturbation
of point mass, 341, 353
of tide, 354–356, 402
order, 366, 372, 402
Perturbation force, 348, 351, 352, 367, 402,
404
Perturbed
equation of satellite motion, 341, 342, 345
orbit, 2, 375, 379
Phase
advance, 63, 71
centre, 63, 122, 125
code combination, 67, 69, 148, 150, 264,
272–274
combination, 146, 150, 246
difference, 11, 114
model, 59, 111
Point positioning, 111, 119, 120, 293, 294,
296, 297, 317
Polar motion, 18, 25, 27, 32, 33, 318
Post processing, 3, 77, 121, 322
Precession, 24, 25, 31, 367
Precipitable Water Vapor (PWV), 93
Precise ephemerides, 3, 51
Precise point positioning
ambiguity ﬁxing, 257, 311
Pre-processing, 291, 317, 318
Projection mapping function, 73, 74, 85
Pseudorange, 3, 8, 55, 57, 59, 72, 114, 116,
133, 292, 298, 321
Q
Quasi-stable datum, 187, 222, 226
R
Radial
component, 102, 414, 430
velocity, 59
Range rate, 61, 380, 383
Real-time
positioning, 77, 112, 308, 440
Receiver
clock, 56, 58, 114, 119, 266, 278, 292, 293,
297, 301, 307
Index
487

independent exchange format (rinex), 291
Receiver independent exchange format
(RINEX), 53, 291, 322
Reference
frequency, 10, 438
satellite, 156, 183, 225, 267, 271, 274, 287,
288, 301, 438
station, 8, 91, 92, 154, 226, 258, 259, 270,
274, 289, 308–310, 326, 327, 333, 439
Refractive index, 64, 65, 80
Relative positioning, 301
Relativistic effect, 94, 97, 99
Relativity, 1
Right ascension, 40, 44, 48, 50, 364, 369, 413,
420, 430
Robust Kalman ﬁlter, 187, 209, 218, 225
Rotational
angle, 21
matrix, 21
Runge-Kutta algorithms, 387, 388, 391, 393,
396, 397
S
Saastamoinen model, 81, 84, 88, 91
Sagnac effect, 98
Satellite
antenna, 122, 125
clock, 3, 51, 53, 56, 97, 112, 122, 172, 175,
184, 218, 266, 299, 302, 311
motion, 33, 37, 40, 44, 49, 342, 345, 348,
412, 430
orbit, 1, 2, 37, 43, 52, 99, 134, 296, 318,
342, 410, 434
Selective availability (SA), 4, 63, 111, 122
Sequential Least Squares Adjustment, 113,
187, 191, 212, 290
Shadow, 125, 358, 360, 368
Sidereal time, 25, 33
Single
difference, 153–156, 175, 177, 179, 269,
328
point positioning, 3, 111, 287, 292–297,
320
Singularity
criteria, 409, 411
criterion, 412
free, 438
Solar radiation, 49, 123, 134, 291, 341, 345,
348, 358, 360–362, 368, 404, 411
Special relativity, 94, 96, 97
Speed of light, 56, 58–60, 64, 67, 71, 94, 95,
99, 110, 134, 161, 175, 179, 292, 297
Spherical coordinate, 18, 249, 343, 348, 351,
352, 355, 356
Spherical harmonics, 89, 349
Standard deviation, 110, 142–145, 161, 171,
189, 194, 210, 223, 233, 236, 238, 239,
248, 249, 307, 329, 335, 338, 419
State vector, 46–49, 134, 135, 137, 213, 215,
342, 343, 365, 366, 380, 381, 383, 384
Static reference, 103, 293, 303, 323, 325–329,
334, 335, 337, 338
T
Terrestrial
Dynamic Time, TDT, 33
Time, TT, 28, 33
Terrestrial dynamic time (TDT), 33, 102
Tidal
deformation, 102, 354
effect, 103, 134, 140, 152, 327
potential, 100–102, 354, 355
Time dilution of precision (TDOP), 307
Time system, 2, 7, 13, 25, 33, 35, 52, 439
Total electron content (TEC), 66, 73, 78, 79
Transition matrix, 207, 208, 384, 385
Transmitting time, 3, 51, 55–58, 95, 98, 110,
119, 134
Triple difference, 133, 158–160, 172, 173, 181,
182, 266, 280, 301
Triple-frequency combination, 67
Tropospheric
delay, 80, 81, 83, 84, 87, 88, 91–93, 114,
139, 297
effect, 2, 57, 59, 63, 80, 82, 84, 87, 135,
139, 153, 156, 159, 252
model, 81, 82, 87, 88, 91, 110, 139, 291,
323, 329, 339
True anomaly, 43, 46, 344, 365, 369, 413, 414,
421, 430
U
Uncombined algorithm, 164, 167
Undifferenced algorithm, 265, 271, 274
Uniﬁed equivalent algorithm, 183
Universal
Time (UT), 27, 33
Time Coordinated (UTC), 13, 33, 35
Universal Time (UT), 27, 33
488
Index

Universal Time Coordinated (UTC), 33, 35
UT1, polar motion corrected UT, 27
V
Variational equation, 385
Velocity
determination, 302–304, 320
vector, 46, 60, 98, 111, 302, 303, 305, 331,
362, 364, 368, 371, 381, 383, 386, 402,
405, 421
Vernal equinox, 24, 32, 33, 40, 47, 426
Vertical dilution of precision (VDOP), 308
W
Water vapor, 93, 94
Weight matrix, 136, 161, 172–174, 176, 177,
179, 181–183, 188, 200, 204, 206, 209,
210, 212, 215, 216, 220, 221, 225, 226,
233, 256, 257, 263, 272, 281, 286, 290,
293, 295, 296, 299, 300, 303, 304, 306,
307, 440
Wide lane, 246
World Geodetic System (WGS), 20
Y
Yang’s Filter, 212
Z
Zenith delay, 74, 88, 89, 146, 254, 321
Index
489

