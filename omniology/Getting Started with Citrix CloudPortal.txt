www.allitebooks.com

Getting Started with Citrix® 
CloudPortal™
Get acquainted with Citrix Systems®' CPSM and CPBM 
in order to administer cloud services smoothly and 
comprehensively
Puthiyavan Udayakumar
BIRMINGHAM - MUMBAI
www.allitebooks.com

Getting Started with Citrix® CloudPortal™
Copyright © 2013 Packt Publishing
All rights reserved. No part of this book may be reproduced, stored in a retrieval 
system, or transmitted in any form or by any means, without the prior written 
permission of the publisher, except in the case of brief quotations embedded in 
critical articles or reviews.
Every effort has been made in the preparation of this book to ensure the accuracy 
of the information presented. However, the information contained in this book is 
sold without warranty, either express or implied. Neither the author, nor Packt 
Publishing, and its dealers and distributors will be held liable for any damages 
caused or alleged to be caused directly or indirectly by this book.
Packt Publishing has endeavored to provide trademark information about all of the 
companies and products mentioned in this book by the appropriate use of capitals. 
However, Packt Publishing cannot guarantee the accuracy of this information.
First published: October 2013
Production Reference: 1211013
Published by Packt Publishing Ltd.
Livery Place
35 Livery Street
Birmingham B3 2PB, UK.
ISBN 978-1-78217-682-4
www.packtpub.com
Cover Image by Gerard Eykhoff (gerard@eykhoff.nl)
www.allitebooks.com

Credits
Author
Puthiyavan Udayakumar
Reviewers
Jakir Hayder
Aviad Ravivash
Acquisition Editor
Pramila Balan
Commissioning Editor
Shaon Basu
Technical Editors
Dennis John
Gaurav Thingalaya
Copy Editors
Mradula Hegde
Sayanee Mukherjee
Lavina Pereira
Kirti Pai
Tanvi Gaitonde
Dipti Kapadia
Project Coordinator
Esha Thakker
Proofreader
Christopher Smith
Indexer
Monica Ajmera Mehta
Production Coordinator
Shantanu Zagade
Cover Work
Shantanu Zagade
www.allitebooks.com

Notice
The statements made and opinions expressed herein belong exclusively to the author 
and reviewers of this publication, and are not shared by or represent the viewpoint 
of Citrix Systems®, Inc. This publication does not constitute an endorsement of any 
product, service, or point of view. Citrix® makes no representations, warranties 
or assurances of any kind, express or implied, as to the completeness, accuracy, 
reliability, suitability, availability, or currency of the content contained in this 
publication or any material related to this publication. Any reliance you place 
on such content is strictly at your own risk. In no event shall Citrix®, its agents, 
officers, employees, licensees, or affiliates be liable for any damages whatsoever 
(including, without limitation, damages for loss of profits, business information, 
or loss of information) arising out of the information or statements contained in 
the publication, even if Citrix® has been advised of the possibility of such loss 
or damages.
Citrix®, Citrix Systems®, XenApp® , XenDesktop® and CloudPortal™ are 
trademarks of Citrix Systems®, Inc. and/or one or more of its subsidiaries, 
and may be registered in the United States Patent and Trademark Office and 
in other countries.
www.allitebooks.com

About the Author
Puthiyavan Udayakumar has more than five years' IT experience of expertise 
in Citrix®, VMware, and Microsoft products. Puthiyavan has extensive experience 
in designing and implementing virtualization solutions using various Citrix® and 
VMware products. He is an IBM certified Solution Architect and Citrix® certified 
Enterprise Engineer along with 15+ certifications in infrastructure products. 
Puthiyavan holds a Master of Science Degree in System Software from Birla 
Institute of Technology and Science, Pilani and IEEE Pattern and National 
award from the Indian Society for technical education.
I dedicate this book to my beloved mom, Dr. K. Managaikarasai, 
to my dad, Dr. P. Udayakumar, and to my bro, Kathiravan U.
www.allitebooks.com

About the Reviewers
Jakir Hayder graduated with Computer Science from South East University and is 
currently pursuing his MS in Computer Science and Engineering from North South 
University in Bangladesh. He has been building websites and social networking 
apps since 1999. He has been developing Facebook apps since 2007. He gave a 
talk at Facebook Developer Garage, Dhaka. He has developed websites with deep 
integration with Facebook, Twitter, LinkedIn, and YouTube API. He writes tests with 
RSpec, Cucumber, and Capybara, with Selenium. He follows agile methodologies 
of software development and he is specially fond of Scrum and stand-up. Beside 
his full-time job, Jakir writes his blog at blog.jambura.com. He can be followed on 
Twitter @jakirhayder and by using his LinkedIn profile bd.linkedin.com/in/
zakirhyder. Jakir Hayder lives in Bangladesh with his wife, Fathema and his 
son, Arham.
Jakir is working as Sr. Software Engineer at Cellbazaar, which is the biggest 
classifieds ad site in Bangladesh.
I would like to thank my wife for taking care of my three-month old 
boy day in and day out, while I reviewed the book and did my job. I 
would also like to thank Apeksha Chitnis for being patient with me.
www.allitebooks.com

Aviad Ravivash was born and raised in the southern tip of Israel. He 
developed auto-didactic skills in order to satisfy his passion for IT and 
technology infrastructures.
These acquired skills led him to a variety of positions, including the one at 
Neocleus (later acquired by Intel), where he served as an IT admin for this 
virtualization research and development company.
With the aid of the unbelievable talent in the company, in the form of seasoned 
Linux/Unix admins and top-class Linux kernel developers, all working in Agile 
methodologies and developing for both the consumer and enterprise markets, 
he was able to take a pragmatic look at the art and business of IT.
He has an MCSE certification and a Bachelor's Degree in Engineering with 
specialization in Power Electronics.
www.allitebooks.com

www.PacktPub.com
Support files, eBooks, discount offers and more
You might want to visit www.PacktPub.com for support files and downloads related 
to your book. 
Did you know that Packt offers eBook versions of every book published, with PDF 
and ePub files available? You can upgrade to the eBook version at www.PacktPub.
com and as a print book customer, you are entitled to a discount on the eBook copy. 
Get in touch with us at service@packtpub.com for more details.
At www.PacktPub.com, you can also read a collection of free technical articles, sign 
up for a range of free newsletters and receive exclusive discounts and offers on Packt 
books and eBooks.
TM
http://PacktLib.PacktPub.com 
Do you need instant solutions to your IT questions? PacktLib is Packt's online digital 
book library. Here, you can access, read and search across Packt's entire library 
of books. 
Why Subscribe?
•	
Fully searchable across every book published by Packt
•	
Copy and paste, print and bookmark content
•	
On demand and accessible via web browser
Free Access for Packt account holders
If you have an account with Packt at www.PacktPub.com, you can use this to access 
PacktLib today and view nine entirely free books. Simply use your login credentials 
for immediate access.
www.allitebooks.com

Table of Contents
Preface	
1
Chapter 1: Getting Started with Citrix® CloudPortal™	
5
Cloud computing and its business model	
5
Cloud computing	
5
Cloud business model	
6
Overview of Citrix® CloudPortal™	
6
Features of Citrix® CloudPortal™	
7
Citrix® CloudPortal™ architecture	
10
How CPBM works	
10
How CPSM works	
13
About CPSM licensing	
15
Terminology and concepts of CPSM	
15
Planning our CPSM deployment and platform	
21
Summary	
21
Chapter 2: Installing CloudPortal™ Services Manager 11.0	
23
Metrics to verify before CPSM deployment	
23
Verification of environment prerequisites	
23
How to deploy SQL Server and Reporting Services	
25
Installation of the CPSM role using GUI	
27
Configuration of parameters of CPSM roles using GUI	
28
Role 1 – selecting role Directory Web Service and configuring Directory Web Service	
28
Role 2 – selecting role Provisioning Service and configuring queue monitoring 
services, directory monitoring services, and the Mail server	
29
Role 3 – selecting role Reporter Mailer and configuring Licensing Reporting 
and Mail server for report mailers	
30
Role 4 – selecting role reporting, configuring the Reporting DB, Mail server, 
and previewing the service package import, reporting database, Data Transfer 
notifications, Reporting Services Details, and Data warehouse service	
30
www.allitebooks.com

Table of Contents
[ ii ]
Role 5: selecting a web role and configuring service package import and the web server	
32
Configuring the location of the CPSM role using GUI	
33
Installing CPSM roles using command line	
34
Cortex	
35
Core installation using CLI	
35
Configuring the CPSM role using command line	
35
Configuring database objects	
36
Configuring the Provisioning and Directory Web Service server roles	
36
Configuring the primary location	
37
Configuring the remote location	
37
Configuring the reporting options for deploying reports	
37
Configuring the reporting [Data warehouse] object	
38
Configuring the report mailer object	
38
Summary	
39
Chapter 3: Deploying CloudPortal™ Services Manager 11.0	
41
An overview of CPSM service deployment	
41
Scenario 1 – Citrix® Service deployment	
43
Citrix Service deployment overview on CPSM 11.0	
43
Step 1 – deploying Citrix® web services on a server in the Citrix® farm	
44
Step 2 – Service Configuration using the Control Panel	
45
Step 3 – importing App Hub from the Citrix® farm to the server collection	
47
Step 4 – provisioning the service to consumers and to resellers	
48
Scenario 2 – hosted Exchange Service deployment	
48
Step 1 – installing Exchange-hosted web services	
49
Step 2 – configuring hosted web services	
50
Step 3 – provisioning the hosted Exchange service to consumers	
53
Scenario 3 – Virtual Machine Service deployment	
54
Step 1 – deploying VM web service on a server	
54
Step 2 – Service Configuration using the VM service	
55
Step 3 – provisioning VM services to clients	
58
Exporting and importing service packages	
59
Summary	
61
Chapter 4: Managing CloudPortal™ Services Manager 11.0	
63
Creating and managing cloud consumers and tenants	
63
An overview of customer creation	
64
Creating users	
64
Managing security roles and provisioning services	
68
Approval stage	
70
Managing reports	
70
Summary	
71

Table of Contents
[ iii ]
Chapter 5: Installing CloudPortal™ Business Manager 2.0	
73
Installation of CPBM	
73
Configuring CPBM	
76
Enabling CAS authentication	
78
Integration with CloudPlatform	
80
Starting and stopping CPBM	
83
Summary	
83
Chapter 6: Managing CloudPortal™ Business Manager 2.0	
85
Managing profiles	
85
Managing products	
87
Adding a product	
88
Editing a product	
88
Retiring a product	
89
Adding a product to replace an existing one	
89
Managing workflows	
90
Managing accounts	
92
Managing billing	
93
Retail postpaid accounts	
94
CPBM subscription handling	
94
Summary	
96
Chapter 7: Operating CloudPortal™ Business Manager 2.0	
97
Job scheduling	
97
Notifications and health	
99
CRM and reports	
100
Custom reports	
102
Summary	
103
Appendix: CCP Connections	
105
Index	
107


Preface
You are aware that cloud computing will generate some 14 million new jobs 
worldwide by 2015, according to a study commissioned by Microsoft and 
conducted by International Data Corporation (IDC).
Cloud computing enables the world of business to reduce IT costs, increase 
scalability, provide business continuity, and fulfill the needs on demand for 
IT resources on demand with self-provision functionality.
Citrix® CloudPortal™ Business Manager and CloudPortal™ Services Manager are 
emerging as the leaders in cloud, with a crystal clear objective of providing anything 
as a service. As you go through chapter by chapter, for sure you will get an insight of 
both the products and their essential functionalities.
What this book covers
Chapter 1, Getting Started with Citrix® CloudPortal™, serves as a quick reference for 
readers new to CloudPortal™ features, such as architecture, system requirements, 
planning CPSM deployment, and platform.
Chapter 2, Installing CloudPortal™ Services Manager 11.0, serves as a brief reference 
for readers to understand about the system, to verify the essentials, and install and 
configure CPSM using GUI and CLI.
Chapter 3, Deploying CloudPortal™ Services Manager 11.0, serves as a brief reference 
for readers to get an overview of services such as Citrix® service deployment, VM 
service deployment, and Hosted Exchange service deployment.
Chapter 4, Managing CloudPortal™ Services Manager 11.0, serves as a brief reference for 
readers to get an overview of managing customers, users, security roles, managing 
reports, and provisioning changes.

Preface
[ 2 ]
Chapter 5, Installing CloudPortal™ Business Manager 2.0, serves as a brief reference for 
readers to understand system requirements, how to install and configure CPBM, 
and starting and stopping CPBM.
Chapter 6, Managing CloudPortal™ Business Manager 2.0, serves as a brief reference 
for readers to understand profile management, product management, workflow 
management, account management, and billing.
Chapter 7, Operating CloudPortal™ Business Manager 2.0, serves as a brief reference for 
readers to understand operating CPBM.
What you need for this book
The following is a list of software required for deployment of CPBM and CPSM:
•	
Citrix® CPSM: http://www.citrix.com/downloads.html
•	
Citrix® CPBM: http://www.citrix.com/downloads.html
•	
Cent OS: 
http://www.centos.org/modules/tinycontent/index.php?id=15
•	
Windows OS: http://windows.microsoft.com/en-us/windows/home
Who this book is for
This book will help people who are actively looking for jobs in the IT industry, as 
well as people working in the IT industry. It is of great help to people who want to 
be skilled in Citrix® CloudPortal™ usage. Here are other roles for which this book 
will be essential:
•	
Citrix® CloudPlatform Administrator, Engineer, Architect
•	
Citrix® CloudPortal™ Administrator, Engineer, Architect
•	
Cloud Administrator, Engineer, Architect
Conventions
In this book you will find a number of styles of text that distinguish between 
different kinds of information. Here are some examples of these styles, and an 
explanation of their meaning.
Code words in text are shown as follows: "We can include other contexts through the 
use of the include directive."

Preface
[ 3 ]
Any command-line input or output is written as follows:
CortexConfigConsole.exe/ConfigFile:XML-file /Configure: Objects /task-
options [/Help]
New terms and important words are shown in bold. Words that you see on the 
screen, in menus or dialog boxes for example, appear in the text like this: "clicking 
the Next button moves you to the next screen".
Tips and tricks appear like this.
Reader feedback
Feedback from our readers is always welcome. Let us know what you think about 
this book—what you liked or may have disliked. Reader feedback is important for 
us to develop titles that you really get the most out of.
To send us general feedback, simply send an e-mail to feedback@packtpub.com, 
and mention the book title via the subject of your message.
If there is a topic that you have expertise in and you are interested in either writing 
or contributing to a book, see our author guide on www.packtpub.com/authors.
Customer support
Now that you are the proud owner of a Packt book, we have a number of things to 
help you to get the most from your purchase.
Errata
Although we have taken every care to ensure the accuracy of our content, mistakes 
do happen. If you find a mistake in one of our books—maybe a mistake in the text or 
the code—we would be grateful if you would report this to us. By doing so, you can 
save other readers from frustration and help us improve subsequent versions of this 
book. If you find any errata, please report them by visiting http://www.packtpub.
com/submit-errata, selecting your book, clicking on the errata submission form link, 
and entering the details of your errata. Once your errata are verified, your submission 
will be accepted and the errata will be uploaded on our website, or added to any list of 
existing errata, under the Errata section of that title. Any existing errata can be viewed 
by selecting your title from http://www.packtpub.com/support.

Preface
[ 4 ]
Piracy
Piracy of copyright material on the Internet is an ongoing problem across all media. 
At Packt, we take the protection of our copyright and licenses very seriously. If you 
come across any illegal copies of our works, in any form, on the Internet, please 
provide us with the location address or website name immediately so that we can 
pursue a remedy.
Please contact us at copyright@packtpub.com with a link to the suspected 
pirated material.
We appreciate your help in protecting our authors, and our ability to bring you 
valuable content.
Questions
You can contact us at questions@packtpub.com if you are having a problem with 
any aspect of the book, and we will do our best to address it.

Getting Started with Citrix® 
CloudPortal™
Thank you for choosing the right book to get a technical insight into Citrix 
CloudPortal. Throughout this book, you are going to learn about two different 
products from Citrix Systems: Citrix CloudPortal Business Manager (CPBM) 
and Citrix CloudPortal Service Manager (CPSM). In a nutshell, CloudPortal 
is an all-inclusive portal for provisioning services on demand from the cloud.
In this chapter we will discuss the following topics:
•	
Cloud computing and its business model
•	
Features of CloudPortal
•	
CloudPortal architecture
•	
Terminology of CPSM
•	
System requirements of CPSM and CPBM
•	
Planning our CPSM deployment and platform
Cloud computing and its business model
Before we start with Citrix CloudPortal, let us understand what cloud computing is 
and how its business model works.
Cloud computing
Cloud computing is a solution that provides "Computing as a Service" over the 
Internet and delivers on-demand computing resources. Resources include everything 
from desktop to data center and the most essential characteristics of every cloud 
product are self-service, pay-for-use, elastic resources, and so on.

Getting Started with Citrix® CloudPortal™
[ 6 ]
Citrix CloudPortal fulfills the characteristics of cloud such as self-service, 
pay-as-you-go, on-demand, and so on.
Cloud business model
Cloud computing services are defined and classified into three major categories: 
Infrastructure as a Service (IaaS), Platform as a Service (PaaS), and Software as 
a Service (SaaS).
Citrix CloudPortal fulfills the needs of Cloud IaaS with CPSM and CPBM.
Overview of Citrix® CloudPortal™
I believe that by now you're very excited to know about CloudPortal. Let us now 
look at the basic functionality of Citrix CloudPortal.
Citrix CloudPortal is a product from Citrix Systems Inc. As a product, it aims to 
fulfill the cloud computing essentials, such as automated operations, business 
support for cloud providers, and cloud services delivery platform for self-service IT.
•	
CloudPortal Business Manager (CPBM): This wide-ranging business 
operations product qualifies cloud builders to run any cloud through 
all-inclusive cloud services platforms. This is coupled with consumer 
management, provisioning services, and operational features for running 
a cloud. IT consumers can combine any cloud, IT services, or value-added 
services, and qualify consumers to provision services themselves, while 
running accounts through a trouble-free, self-service portal. The flexible 
architecture makes it effortless to deliver a broad array of in-house, off-
premise, and third-party cloud services, while being joined together with 
current business services and service models.
•	
CloudPortal Services Manager (CPSM): This user-friendly web portal helps 
service providers manage the delivery of cloud services and offerings to their 
clients. It also converts cloud offerings into money-spinning cloud businesses 
with all-inclusive platforms to manage business services, operations support 
services, clients, and cloud offerings. It provides out of the box support 
for Desktop as a Service (DaaS) and Windows apps (powered by Citrix® 
XenApp®/XenDesktop®), as well as popular business applications such 
as Lync, Exchange, Office, SharePoint, web hosting, and more. With no IT 
expertise, customers can add, remove, or modify any service.

Chapter 1
[ 7 ]
Features of Citrix® CloudPortal™
Hopefully, now we have set the tone of what Citrix CloudPortal is all about and also 
had a peek into CPBM and CPSM. Now it is time to explore more features of both 
CPBM and CPSM.
The following features are defined by Citrix Systems for CPBM:
Feature
Service
Description
Cloud 
Services 
Delivery 
Platform
Cloud services 
automation
A feature that helps to orchestrate and automate the 
formation of provisioning and modification of cloud 
services. It is robustly run, and delivers instances of cloud 
solutions as ITaaS.
Business and 
operations 
systems 
automation
A feature that helps to globalize consumer management, 
CRM, BOM, pricing, reporting, and IT as a service into 
a single, all-inclusive services delivery platform. This 
framework makes it easy to plug in to existing (in-house) 
and external (off-premise) business systems.
Simple 
management 
interface
A feature that enables things to run more easily on the 
cloud by using a single interface for cloud provisioning 
services, managing consumers, monitoring, and reporting.
Customer 
relationship 
management
A feature that helps to define the norms of account types 
such as staffs, business units, and try-out accounts to 
control services and utilities that are available for it. It 
uses CRM tools to open/view tickets, track activity, and 
reports.
Anything-
as-a-
Service
Cloud services 
catalog
A feature that helps to create a custom instance of services 
including cloud-IaaS, 3rd Party, and ITaaS, which are 
delivered to users through a self-service instance.
Infrastructure-
as-a-Service 
management
A feature that helps to deliver and run cloud-IaaS built 
with Citrix CloudPlatform power-driven by Apache 
CloudStack. Hypervisor provision includes XenServer, 
vSphere, Oracle VM, and Linux KVM. Consumers are 
allowed operations such as add, start, and stop virtual 
machines, allocate storage, and configure networking 
settings.
Custom 
pricing and 
packaging
A feature that helps to fit rising price summits, packages, 
and utilization models for different consumers/cloud 
users.
Extensible 
platform
A feature that helps to effortlessly deliver any service from 
CloudPortal using the SDK, working along with partners, 
and stretch our portfolio of services to differentiate and 
boost values.
www.allitebooks.com

Getting Started with Citrix® CloudPortal™
[ 8 ]
Feature
Service
Description
Self-
service IT
Self-service 
provisioning
A feature that helps users to simplify and gain an 
insight to purchase cloud services, quickly provision 
services, lower operational costs, and achieve higher user 
satisfaction.
Metering and 
reports
A feature that helps to get synchronized access to service 
utilization, billing, and reports through a single insightful 
dashboard.
Complete 
cloud 
visibility
A feature that helps consumers with a solo, global 
view of their cloud services, ease of use, system health, 
performance and consumer utilization, pricing, helpdesk, 
alerts, and so on.
Delegated 
control
A feature that helps CloudPortal consumers to perform 
day-to-day management without calling support or 
opening support tickets, with lower operating costs.
Pricing, 
metering 
and billing
Billing and 
payments
A feature that helps CloudPortal administration to 
configure pricing models such as monthly subscriptions, 
fractional pricing, and pay-as-you-go, and then robotically 
calculate the usage, generates invoices, and routes to 
payments.
Metering and 
monitoring
A feature that helps to track service usage with 
instantaneous reports and proactively watches over 
a system's health with integral alerts. It generates 
customized reports for current and historical activity with 
deep-dive analytics.
Fraud 
protection
A feature that helps to prevent fake actions with integral 
account certification: password policies, domain white/
black citation, and account spend limits. 3rd Party plugins 
are also supported.
Open by 
design
Cloud Service 
SDK
A feature that helps to deliver custom put up, 3rd Party, 
and IT as a Service from your Services catalog via SDK. 
You can configure, provision, meter, and bill services 
flawlessly.
Partner 
ecosystem
A feature that helps to influence associate ecosystems 
to easily add differentiating cloud services such as 
monitoring, capacity management, Storage as a Service, 
and Platform as a Service to extend the value of your 
cloud.

Chapter 1
[ 9 ]
Feature
Service
Description
Enterprise 
ready
Workflow 
approvals
A feature that helps to define workflow policy for new 
account activations and provisioning to ensure that the 
business unit requirements and financial plan approvals 
are met.
Role-based 
access control
A feature that helps to farm out administration 
responsibilities by mapping AD users and groups to 
CloudPortal profiles.
AD integration
A feature that helps to incorporate with AD to qualify the 
provisioning services based on the AD users and groups.
Business and 
operations sys 
integration
A feature that helps to modernize IT, business, and 
operations by integrating them with existing systems such 
as help desks, trouble tickets, and chargebacks.
CloudPortal Services Manager mechanizes the business and operations systems, 
and simplifies the cloud provisioning services. The following table enumerates the 
features defined by Citrix Systems for CPSM:
Account on 
boarding and 
management
A feature that helps to set up new consumers and manage consumer 
accounts from a simple web portal. CRM capabilities let you view/
update customers in sequence, monitor actions, and perform report 
handling. Different consumer account types can be set up for customers, 
partners, resellers, and trial accounts as well.
Customer 
self-service 
and delegated 
control
A feature that helps to empower our clients with self-service control 
that's trouble-free for anyone. Consumers can shop for the cloud 
services they want, and perform day-to-day management without 
calling support. Delegated access ensures the right level of organization 
for all cloud consumers, resellers, and partners.
Extensible 
and open 
architecture
A feature that helps to extend CloudPortal Services Manager to fit in 
our entire cloud portfolio and services using the SDK, commerce APIs, 
and 3rd Party apps and plugins.
Dashboards, 
metering, and 
billing
A feature that helps to give consumers and partners a complete view 
into their cloud so they can track usage, view available services, watch 
over a system's health, and receive warnings. Concurrent and historic 
reports with deep-dive analytics make it easy to create customer, 
reseller, and partner reports. Billing modules can robotically calculate 
the usage, generate Bill of Lading, and process the payments.

Getting Started with Citrix® CloudPortal™
[ 10 ]
Cloud services 
and IaaS 
automation
A feature that helps to automate association, provisioning, and add/
move/change of our cloud portfolio. CloudPortal Services Manager 
lets you deliver and run a complete hosting solution, including cloud 
infrastructure, enterprise and livelihood requests, desktops, and IT 
services.
Built-in support 
for leading 
hosted services
A feature that helps to run a complete cloud services solution including 
messaging and collaboration, VDI, and venture line-of-business 
applications.
Citrix support
Citrix XenApp® – hosted apps and desktops
3rd Party applications
Microsoft hosted Microsoft Exchange, Lync, Office Communication 
Server, SharePoint Services, Dynamics CRM, Dynamic Datacenter, 
and BlackBerry Enterprise Server
Infrastructure and datacenter services
Microsoft Active Directory and synchronization
Windows File Shares
Microsoft IIS: Web hosting
Microsoft SQL: Data hosting, DNS
Citrix® CloudPortal™ architecture
As we have now understood the various features of CloudPortal, let us move on to 
the next section to understand the skeleton structure of CPBM.
How CPBM works
CloudPortal Business Manager is a cloud services delivery platform for access and 
authorization, service catalogs, self-service fulfillment, and helpdesk support. Cloud 
providers can deliver a broad array of services, including cloud-IaaS constructed 
with Citrix CloudPlatform, and it enables the features of catalog management, 
user management, workflow management, and metering management both for 
on-premise and off-premise cloud admins.

Chapter 1
[ 11 ]
Cloud
Admin
Users
Customers
Self Service
Fulfillment
Helpdesk
Support
Citrix CloudPlatform
Cloud Services
Catalog
Management
User
Management
Workflow
Management
Metering
Management
Infrastructure
Service Catalog
Access and
Authorization
Infrastructure
Software
Storage
IT Services
Custom Services
CPBM architecture defined by Citrix Systems from a functional standpoint
The following table has an explanation of the use for each component from a user's/
customer's standpoint:
Access and 
Authorization
This functionality helps consumers to self-register on portals; 
authorization requirements are confirmed and offered services are 
robotically mapped to the registered account.
Service Catalog
This functionality helps consumers to browse through the self-
service portal to catalog, view pricing options, and pick up the 
options of services they need.
Self Service 
Fulfillment
This functionality helps to provision services, backend businesses, 
and helps operational workflows to be robotically triggered as 
well, without waiting or any manual intermediation by cloud 
workers.
Helpdesk Support
This functionality helps consumers to open tickets and interact 
with the support team using the built-in CRM support.

Getting Started with Citrix® CloudPortal™
[ 12 ]
The following table has explanations of the use of each component from an 
administrator's/cloud worker's standpoint:
Catalog 
Management
This functionality helps to tailor services wrapped and hustled by 
fitting price and utilizations replicas. This defines the readiness for 
different user forms and business units.
User Management
This functionality helps to set account types, run users, monitor 
accounts and service tasks, and respond to support tickets. Users 
perform their own additions/moves/changes without calling IT.
Workflow 
Management
This functionality helps to automate and orchestrate provisioning 
of service and business systems and workflows operations, as well 
as define normalization rules for account tasks and provisioning 
service needs.
Metering 
Management 
This functionality helps to track usage/consumption, produce 
invoices, and systematize payment processing.
Self-Service Portal
API
Xaas / ITaas
Sercice Orchestration
Servers
Hypervisor
Storage
Firewall
Load Balancer
Cloud Console
Resource
Management
Usage
Metering
Users
Customers
Cloud
Admin
API
RBAC
Cloud
Management
Commerce
Billing
Catalog
Management
CPBM architecture defined by Citrix Systems from a technical standpoint

Chapter 1
[ 13 ]
Here, I would like to share some information about cloud computing. It is 
transforming the industry and catching the attention of business and IT leaders, 
forcing them to re-examine their IT strategies and identify ways to modernize, 
distinguish, and gain proficiency in their IT societies. Today, many enterprises are 
gradually turning to hybrid clouds to combine the benefits of constructing public 
and private clouds, along with using current IT infrastructure to cut charges, 
maximize significance, and improve the way IT services are supplied.
With Citrix's market-leading CloudPortal solutions, we can quickly and effortlessly 
convert the virtualized data center resources into robotic, elastic, self-service clouds 
that ensure the best performance, security, and reliability whether they are running 
in on-premise or off-premise datacenters.
If you are interested in learning more about these hybrid cloud solutions offered 
by Citrix, please refer to http://www.citrix.com/solutions/hybrid-cloud/
overview.html.
Now, let us jump back to exploring the architecture of CPSM.
How CPSM works
Citrix CloudPortal Services Manager product is a multi-occupier, self-service portal 
offering simple workflows for on-boarding consumers, clients, and resellers. It also 
offers provisioning services, a catalog of cloud offerings for infrastructure, and the 
enabling of self-service and billing usage.
Onboard Account
Provisioning Services
Enable Self Services
Usage and Billing
CPSM architecture defined by Citrix Systems from a functional standpoint

Getting Started with Citrix® CloudPortal™
[ 14 ]
The following table has explanations of each component's usage from a consumer's/
user's standpoint:
Onboard Account
This functionality helps to add new consumers, clients, 
partners, or resellers by robotically processing the 
business services and operational services required to 
manage accounts.
Provisioning Services
This functionality helps to configure a catalog of cloud 
aids for hosted apps, servers, desktops, IaaS, and 
robotically provision them to your consumers.
Qualify Self Services
This functionality helps to empower consumers with self-
service controls so that they can run their accounts.
Usage and Billing
This functionality helps to produce customized real-time 
and historic consumption reports with deep-dive analytics 
to better recognize usage patterns.
Active Directory
CloudPortal Services
Manager Agent
CloudPortal
Provisioning Engine &
System Databases
Service Manager
API
Customer AD
Active Directory
CloudPortal Services
Manager Agent
Application Servers
(XenApp, Mail,
SharePoint, Messaging)
CloudPortal
Service Manager
Web enabled
Anywhere access
Cloud Services
Provider
Cloud
Subscriber
CPSM architecture defined by Citrix Systems from a technical standpoint

Chapter 1
[ 15 ]
About CPSM licensing
CloudPortal Services Manager license is obtainable exclusively to Citrix Service 
Provider partners via certified Citrix Service Provider Distributors. Citrix 
CloudPortal Services Manager aids cloud suppliers in consumption-based 
licensing, empowering billing on a monthly basis for the services they consume.
CloudPortal Services Manager is completely free to affiliates of the Citrix Service 
Provider Program. The program is free for Enterprise customers to join. All they 
have to do is to reach out to their local Citrix Service Provider.
Terminology and concepts of CPSM
By now, I believe you will have understood the architecture of CPBM and CPSM 
from a functional and technical standpoint. Now, let us look at the terminology 
and concepts of CPSM. The following table explains the terminologies versus 
their notions:
Terminology
Notion
Active Directory 
Location 
Services
Active Directory Location Services refers to the level at which settings 
are configured for services that are qualified for a particular location. 
By default, services deployed within a location inherit the settings 
configured at the top environment level.
Control panel
Control panel refers to the web-based interface that CSPs, resellers, 
and delegated administrators use to configure and run services and 
resources.
Customer 
administrator
Customer administrator refers to the first consumer created for a 
client. This consumer has permissions to create and modify consumer 
accounts and to provision services to consumers.
Customer plan
Customer plan refers to a collection of configured settings that apply to 
all customers provisioned with a specific service.
Location
Location refers to an Active Directory domain and is used to create 
links between specific services, clients, and consumers.
Provisioning
Provisioning refers to the process of fulfilling requests made to the 
engine for precise tasks such as creating customers, assigning security 
roles, and removing users.
Service provider 
administrator 
Service provider administrator refers to the first administrator the user 
created, when the first location was created for the Services Manager 
deployment.
Top 
Environment 
Services 
Top Environment Services refers to the level at which default settings 
are configured for the SM deployment. Settings configured at this level 
are inherited by all locations in the deployment.

Getting Started with Citrix® CloudPortal™
[ 16 ]
Terminology
Notion
User plan
User plan refers to a collection of configured settings that apply to all 
users linked with a specific client.
Web service
Web service refers to the installed self-services portal, which integrates 
service-specific utilities into the Services Manager control panel.
The following are the system requirements of various components of CPSM:
•	
Component: Active Directory and Exchange requirements
°°
OS requirements: Windows Server 2012, Windows Server 2008, 
and 2008 R2
°°
Security requirements:
Group name (required for)
CPSM installation
Extending AD schema
Domain Admins
Yes
Yes
Enterprise Admins
No
Yes
Schema Admins
No
Yes
°°
DNS requirements:
Platform component
Alias
Database server
CORTEXSQL
Provisioning server
CORTEXPROVISIONING
Web server
CORTEXWEB
Reporting Services
CORTEXREPORTS
Citrix specifies that before the Services Manager platform can be 
deployed, the AD schema must be extended to include the standard 
Exchange attributes and prepare the environment for multi-tenancy. 
You can extend the schema by executing the following command:
setup /p /on:OrganizationName
•	
Component: Database server requirements are as follows
°°
OS requirements: Windows Server 2008 R2 Standard, Enterprise, 
and Datacenter editions
°°
DB requirements: Microsoft SQL Server 2008 R2

Chapter 1
[ 17 ]
°°
Authentication: Mixed mode must be qualified (SQL and Windows 
Authentication)
°°
UAC: Must be disabled
Citrix says that when you install SQL Server, make note of the instance 
name (default=default) and port (default=1433). We need this 
information when we configure the server for use with Services Manager.
The following DBs are created during the installation:
•	
OLM: The core database for customer and user information
•	
OLMReports: Stores legacy reporting data and some system 
settings
•	
OLMReporting: Stores reporting data, additionally, the 
upcoming SQL accounts are created for accessing the 
databases: CortexProp, OLMUser, OLMReportsUser, and 
OLMReportingUser
Two SQL jobs are installed on the database server: Gather Daily Stats 
Data and Gather Monthly Stats Data.
•	
Component: Provisioning server requirements
°°
OS requirements: Windows Server 2008 R2 Standard, Enterprise, 
and Datacenter editions
°°
.NET requirements: .NET Framework 4.0
°°
UAC: Must be disabled
°°
Windows features: Qualify the following features: Message Queuing 
Server and HTTP Support (only if the server is not in the domain) 
features by navigating to Message Queuing | Message Queuing 
Services, and also the Telnet client, Windows PowerShell features
Citrix says that if you are installing the Provisioning server role on a 
domain controller, give the Provisioning Users security group the Allow 
logon locally permission. However, Citrix does not recommend installing 
Provisioning on domain controller.
SQL Server Management: Install the 64-bit variant of the Microsoft SQL 
Server 2008 Shared Management Objects (SMO).
www.allitebooks.com

Getting Started with Citrix® CloudPortal™
[ 18 ]
•	
Component: Directory Web server requirements
°°
OS Requirements: Windows Server 2008 R2 Standard, Enterprise, 
and Datacenter editions
°°
.NET requirements: .NET Framework 4.0
°°
UAC: Must be disabled
°°
Windows features: Qualify the following features: the ASP.NET 
feature by navigating to Web Server | Application Development, 
the Basic Authentication and Windows Authentication features by 
navigating to Web Server | Security, the IIS Management Console 
and IIS Management Scripts and Tools features under Management 
Tools, and the PowerShell 2.0 feature
Citrix says that Directory Web Service is installed on the 
same server that hosts the Provisioning server role. If you are 
installing the Directory Web Service on a domain controller, 
give the CortexWS Users and the Proxy Users groups the 
Allow logon permission locally. Citrix does not recommend 
installing this role on a Domain Controller.
•	
Component: Web server requirements
°°
OS requirement: Windows Server 2008 R2 Standard, Enterprise, and 
Datacenter editions
°°
.NET requirements: .NET Framework 4.0
°°
Report Viewer: Microsoft Report Viewer 2008 SP1
°°
UAC: Must be disabled
°°
Windows features: Qualify the following features: the ASP.NET 
feature by navigating to Web Server | Application Development, 
the Basic Authentication and Windows Authentication features 
by navigating to Web Server | Security, the IIS Management 
Console and IIS Management Scripts and Tools features under 
Management Tools
°°
Web Browsers Supported: Internet Explorer 8, 9, and 10, Firefox 17.x 
and 18.x, Chrome 25.x, Safari 5.x

Chapter 1
[ 19 ]
Citrix says that during platform configuration, you will need to know the 
host header required for the website and when you install the web server 
role, the following items are installed:
•	
CortexMgmt Application Pool: Runs the management site.
•	
Cortex Management Site: CortexDotNet is the service that runs 
the control panel.
•	
CortexAPI: This is the XML-based web service that automates 
management tasks.
•	
SQL Server Management Object: Installs the 32-bit variant of the 
Microsoft SQL Server 2008 Shared Management Objects (SMO). 
This is available in the Support folder of the Services Manager 
installation media.
•	
Component: SQL Server Reporting Services and Data Warehouse 
requirements
°°
OS requirements: Windows Server 2008 R2 Standard, Enterprise, 
and Datacenter editions
°°
.NET requirements: .NET Framework 4.0
°°
DB requirements: Microsoft SQL Server 2008 R2
°°
Report Viewer: Microsoft Report Viewer 2008 SP1
°°
UAC: Must be disabled
°°
Service account: SQL Reporting Services account must be 
Network Service
°°
SQL connection types: Local and remote SQL connections qualified
Verify that the Report Server configuration file (C:\Program Files\
Microsoft SQL Server\MSRS10.MSSQLSERVER\Reporting Services\
ReportServer\rsreportserver.config) contains the entry <Authe
nticationTypes><RSWindowsNTLM/>,<RSWindowsNegotiate/>,</
AuthenticationTypes>.

Getting Started with Citrix® CloudPortal™
[ 20 ]
Citrix says that SQL Reporting service and data warehouse are deployed 
on the same server.
They need a user with a system administration role; we will need this 
sys admin info when we configure the Reporting platform role with the 
CPSM Configuration Tool.
CPSM setup installs Microsoft SQL Server 2008 Shared Management 
Objects automatically when the data warehouse role is deployed. SMTP is 
needed for the data warehouse.
The following table is a generic guideline for firewall expectations required to be set 
on the infrastructure:
Traffic/Port
Sources
Target
Purpose
TCP 8095
Web Server
Provisioning Engine
Helps to authenticate users 
and read-time AD lookups
MSMQ#, HTTP, 
or HTTPS
Web Server
Provisioning Engine
Helps to process provisioning 
requests
TCP 1433##
Provisioning 
Engine
SQL Server
Helps to access the 
provisioning guidelines write 
statistics
TCP 1433##
Web Server
SQL Server
Helps to access the customer 
and user material
TCP 80
Web Server
SQL Reporting 
Services server
Helps to access SQL Reporting 
Services
# MSMQ contains numerous ports, as stated by Microsoft
## Supported SQL uses TCP 1433 only for the default instance
The following are the system requirements for CPBM Server:
•	
H/W: Four vCPUs, 8 GB RAM with 40 GB HDD
•	
OS: CentOS release 5.6, 6.2, 6.3
•	
Component: Java 1.6 and above
•	
SQL: MySQL Server 5.1.x
•	
Browser support: Microsoft Internet Explorer 8 and 9, Mozilla Firefox 19, 
Google Chrome 25, Apple Safari 5/iOS 6.0.1.

Chapter 1
[ 21 ]
Planning our CPSM deployment and 
platform
Hopefully, now you will have understood the system requirements from a technical 
standpoint. Let us now look at the strategic way in which we can plan our CPSM 
deployment and platform.
Citrix says that you can plan your deployment with a three-phased approach: 
Service management platform deployment as the first phase, Service deployment 
as the second phase, Customer and user provisioning as the third and last phase. 
In the upcoming chapter, you will understand how to apply this phased approach.
•	
Service manager deployment phase: The Services Manager platform 
characterizes a series of servers that accomplishes provisioning tasks, 
hosts the control panel interface, authenticates, manages consumers 
and API services, stores and processes data from the main database, 
and manages billing and usage.
•	
Service deployment phase: The installation of any service includes 
installing and configuring services for assets such as Citrix apps and 
desktops, Microsoft Exchange, and SharePoint. Before deploying any 
service, you must ensure the resources supporting the service are 
completely deployed.
•	
Customer and user provisioning phase: The provisioning of customers and 
users represents a series of tasks, such as empowering resellers to sell specific 
services, making these services accessible to end-clients, enabling client 
consumers to access services, and conveying security roles.
Summary
In this chapter, we have learned about CloudPortal and various features of CPSM 
and CPBM, the functional and technical architectures of CPSM and CPBM, the 
key technical system requirements of CPSM and CPBM, as well as approaches 
on planning the deployment and platform of CPSM.
In the next chapter, we are going to discuss how to verify system requirements 
for CPSM installation and configuration using GUI and command-line interface.


Installing CloudPortal™ 
Services Manager 11.0
With the knowledge gained in Chapter 1, Getting Started with Citrix® CloudPortal™, 
you would have understood the Citrix CloudPortal concepts and the system 
requirements to install it. Now let us look at the measures to verify system 
readiness before getting CPSM up and running.
In this chapter, we will learn the following:
•	
Metrics to verify before CPSM deployment
•	
Installing and configuring CPSM using GUI
•	
Installing and configuring CPSM using the command line
Metrics to verify before CPSM 
deployment
Until now, you have learned about the most obvious requirements to install CPSM; 
now, in the upcoming session, we will have a look at how to verify essentials for 
CPSM deployment.
Verification of environment prerequisites
We will look at the core components that should essentially be verified right at the 
outset before the installation.

Installing CloudPortal™ Services Manager 11.0
[ 24 ]
The first component that needs to be verified is the Active Directory (AD) schema, 
which is necessary to accommodate Citrix CloudPortal Services Manager. As 
you are aware, the operation can be performed using the Microsoft Exchange 
installation tools.
The following steps need to be performed:
1.	 Open the command prompt on your planned Exchange server.
2.	 Then execute the following command:
setup /p /on:OrganizationName
The second component that needs to be cross-checked is whether DNS aliases have 
been configured. Citrix CloudPortal Services Manager uses DNS aliases to discover 
the servers where the platform modules will be positioned. For this, the following 
steps need to be performed:
1.	 On AD, create CNAME records.
2.	 There should be one record against each of your servers as shown in the 
following table:
Server
EX Name
Database server
CORTEXSQL
Provisioning server
CORTEXPROVISIONING
Web server
CORTEXWEB
Reporting Services
CORTEXREPORTS
Use the Citrix CloudPortal Services Manager Setup utility to verify the preceding 
items. The utility probes our settings and if it is positive, displays a green check 
mark next to each confirmed item. If it is negative, the Setup utility shows a 
Validate button, so you can execute the checks over again.
Perform the following steps:
1.	 From your file cluster or from the installation media, execute Setup.exe.
2.	 On the CloudPortal Services Manager splash screen, click on Get Started.
3.	 On the Choice Deployment Task screen, choose Install CloudPortal 
Services Manager.
4.	 In the CloudPortal Services Manager screen, choose check environment 
prerequisites.
5.	 The Prepare Environment screen displays the status of the verified items.

Chapter 2
[ 25 ]
As the next step, we will now create the system database.
The heart of the deployment is the Config.xml file, which will be useful 
throughout the wizard run-through.
How to deploy SQL Server and Reporting 
Services
For Cloud IT providers, it is recommended that they use the SQL Server deployment 
and Reporting Services. This should be done in a dedicated cluster for high 
availability, especially when providing for multiple consumers.
With regards to installation, configuration, and performance tuning of SQL Server 
and Reporting Services, please refer to http://technet.microsoft.com/en-us/
library/ms143219(v=sql.105).aspx.
The next step is to create the DB.
We have to perform this activity post deployment of SQL Server 
and SQL Server Reporting Services. The system databases are 
created using the Services Manager Configuration Tool, which is 
installed as a part of this process.
Perform the following steps:
1.	 From the source location where the installation media is located, execute the 
Setup.exe file.
2.	 On the CloudPortal Services Manager splash screen, click on Get Started.
3.	 On the Choose Deployment Task screen, choose Install CloudPortal 
Services Manager.
4.	 On the Install CloudPortal Services Manager screen, choose Deploy Server 
Roles & Primary Location.
5.	 On the Deploy Server Roles & Primary Location screen, choose Create 
System Databases.

Installing CloudPortal™ Services Manager 11.0
[ 26 ]
6.	 Now let us install the Citrix CloudPortal Services Manager 
Configuration Tool:
1.	 When prompted, click on Install to deploy the Configuration utility.
2.	 On the License Agreement screen, read and accept the license 
agreement and then select commit next.
3.	 On the Ready to install screen, click on Install. The setup utility 
installs the Configuration Tool and the prerequisites that are required 
as well.
4.	 Now, let us click on Finish to continue creating the system databases.
7.	 The next step of the installation is to create a Configuration File screen. 
Browse to the directory where you want to store the Config.xml file and 
provide a filename. Then click on Next.
8.	 Now, let us go to the Create Primary Databases screen and configure 
the following information about the SQL Server that will store system 
configuration information:
°°
Server address: This is used to specify the DB server using the DNS 
alias, IP address, or the FQDN.
°°
Server port: This is used to declare the port number used by 
SQL Server.
The port for a default instance of SQL Server is 1433.
°°
Authentication mode: This is used to choose whether to apply 
Integrated Windows and SQL or SQL authentication. By default, 
Integrated is chosen. (Mixed Mode is recommended to be used).
°°
Connect as: This is used to declare Consumer name and password 
of the SQL administrator Consumer (Super account). Fields are 
accessible when we choose the SQL authentication mode for 
our installation.
°°
Auto-create SQL logins: This checkbox is available only if we 
want the required SQL Server Consumer accounts to be created 
automatically. If you do not choose this checkbox, we can later 
provide the login details manually on the Configure Database 
Logins screen.
9.	 Run through the Test Connection to make sure the Configuration utility can 
make contact with the SQL Server and then click on Next.

Chapter 2
[ 27 ]
10.	 On the Configure Database Logins screen, proceed with Generate IDs 
chosen if you want passwords created automatically for CortexProp, 
OLMReports, and OLM DB accounts. Clear this choice if you want to provide 
the passwords for these accounts. CortexProp, OLM DB, and OLMReports 
accounts are formed to make sure the cross-domain right of entry is available 
to the server DBs.
11.	 On the Summary screen, assess the DB configuration in sequence. 
If you want to change anything, click on Back to return to the suitable 
configuration screen.
12.	 Upon completion of the entire configuration as per the guideline, 
go ahead and click on Commit. The Applying Configuration screen 
displays the progress.
13.	 After the server DBs are effectively created, click on Finish.
After the system databases are created, you can install Provisioning Directory Web 
Service and the web platform server roles on the other servers.
Installation of the CPSM role using GUI
By now you would have crystal clear understanding of the system requirements for 
a CPSM installation. In order to start the installation using GUI, we need to perform 
the following activity on the server you will be using to host each server role 
you planned:
Deploy and configure the Reporting server role after the primary location 
has been configured. If you deploy Reporting Services before the primary 
location has been configured, configuration of Reporting Services fails.
1.	 From the source location where the installation media is located, execute the 
Setup.exe file.
2.	 On the Setup Tool splash screen, click on Get Started.
3.	 On the Choose Deployment Task screen, choose Install CloudPortal 
Services Manager and click on Next.
4.	 Now on the Install CloudPortal Services Manager screen, choose Deploy 
Server Roles & Primary Location and click on Next.
5.	 Now on the Deploy Server Roles & Primary Location screen, choose Install 
Server Roles and click on Next.
www.allitebooks.com

Installing CloudPortal™ Services Manager 11.0
[ 28 ]
6.	 Now on the License Agreement screen, agree to the license agreement and 
then click on Next.
7.	 On the Choose Server Roles screen, choose the roles to install and then click 
on Next.
8.	 On the Review Prerequisites screen, evaluate the prerequisite objects that 
will be deployed and then click on Next.
9.	 On the Ready to install screen, evaluate the chosen roles and prerequisites 
that will be deployed. Click on Install. The Deploying Server Roles 
screen shows the installation of the prerequisites and the chosen roles, 
and the outcome.
10.	 On the Deployment Complete screen, click on Finish.
Configuration of parameters of CPSM roles 
using GUI
The configuration carries out a unique technique for each server role we deploy. 
However, some server roles consist of supplementary configuration choices. This 
topic assumes we have installed the server roles we want to configure; the Services 
Manager Setup utility is operating and displaying the Install Server Roles & 
Primary Location screen.
1.	 On the Deploy server Roles & Primary Location screen of the Setup utility, 
choose Configure Server Roles.
2.	 Now on the Load Deployment Configuration file screen, browse to the 
location where we have created the XML configuration file (or a directory), 
choose the XML file, and then click on Next.
3.	 Now on the Select Configuration task screen, select one or more roles to 
configure and then click on Next.
Role 1 – selecting role Directory Web Service and 
configuring Directory Web Service
The following parameters need to be configured:
•	
Auto-generate IDs: Select this choice to create the Directory Web Service 
account with auto-generated IDs.
•	
Consumer name: Provide the consumer name of a domain administrator 
for the service account. The default consumer name is cortex_dirws_svc. 
This field is not available if you select Auto-generate IDs.

Chapter 2
[ 29 ]
•	
Password: Provide a password for this account that conforms to your 
domain's password policy. This field is not available if you select 
Auto-generate IDs.
•	
Create if doesn't exist: Select this to create a service account if it does not 
already exist, else provide your account.
•	
Service port: Provide the port that the Directory Web Service will use. 
By default, the port number is 8095.
Role 2 – selecting role Provisioning Service and 
configuring queue monitoring services, directory 
monitoring services, and the Mail server
The following parameters need to be configured. Firstly, we need to configure queue 
monitoring services and directory monitoring services:
•	
Auto-generate IDs: Select this choice to produce the monitoring service 
account with auto-generated IDs. Ignore this choice to specify your own 
IDs for this account.
•	
Consumer name: Provide the consumer name of a domain administrator 
for the service account. For the Queue Monitor service, the default consumer 
alias is cortex_qmon_svc. For the Directory Monitor service, the default 
consumer alias is cortex_dirmon_svc. This field will not be available if 
you choose to auto-generate IDs.
•	
Password: Provide a password for this account that conforms to your 
domain's password policy. This field will be unavailable if you choose 
to auto-generate IDs.
•	
Create if doesn't exist: Select this choice to create a service account if it does 
not already exist, else provide your account.
For the Mail server setup, the following needs to be done:
•	
Specify the SMTP server address and port number the provisioning server 
will use to send e-mail messages, such as system updates to administrators, 
account notifications to end consumers, and usage reporting to Citrix. Click 
on Test Connectivity to ensure that the Configuration Tool can communicate 
with the SMTP server.

Installing CloudPortal™ Services Manager 11.0
[ 30 ]
Role 3 – selecting role Reporter Mailer and 
configuring Licensing Reporting and Mail server 
for report mailers
To configure Licensing Reporting, the following parameters need to be set:
•	
Customer ID: Provide your Citrix customer ID.
•	
Auto-generate IDs: Select this choice to create the service account with 
auto-generated IDs.
•	
Consumer name: Provide a unique Consumer name for the service account. 
The default consumer name is cortex_RM_svc. This field is not available if 
you elect to auto-generate IDs.
•	
Password: Provide a password for this account that conforms to your 
domain's password policy. This field is not available if you choose to 
auto-generate IDs.
•	
Create if doesn't exist: Select this choice to create a service account if it does 
not already exist, else provide your account.
To configure the Mail server for report mailers, the following needs to be done:
•	
Specify the address and port number of the SMTP server that the Report 
Mailer server will use to send e-mail messages to administrators, end 
consumers, and Citrix. If you have previously configured SMTP settings for 
the provisioning server, the Use shared mail settings checkbox is selected 
by default.
•	
Additionally, specify the From Address that will be used to send e-mail 
messages. The default address is ReportMailer@domain.com.
Role 4 – selecting role reporting, configuring the 
Reporting DB, Mail server, and previewing the 
service package import, reporting database, Data 
Transfer notifications, Reporting Services Details, 
and Data warehouse service
For Reporting DB, the following parameters need to be configured:
•	
Auto-generate IDs: Choose this to create the Reporting Services account with 
auto-generated IDs.

Chapter 2
[ 31 ]
•	
Consumer name: Provide a unique consumer name for the service account. 
The default consumer name is OLMReportingConsumer (provided by 
Citrix Systems).
•	
Password: Provide a password for this account that conforms to your 
domain's password policy. This field is not available if you elect to 
auto-generate IDs.
For configuring the Mail server, the following needs to be done:
•	
Provide the e-mail address and port number of the SMTP system that 
Reporting Services will utilize to trigger e-mails to Cloud Admin, 
Cloud Consumer, Cloud Clients, and to Citrix as well.
For the Service package import, the following needs to be done:
•	
Analyze (go through) the chosen service components that will be imported 
when Reporting Services is configured.
For the Reporting database, the following parameters need to be set:
•	
Use primary database settings: A choice should be made as to whether we 
want to configure a secondary DB server to hold the system reporting and 
pricing (billing).
•	
Server address: Provide FQDN, the IP address, or the DNS alias of the DB.
•	
Use specific port: The default port number is 1433.
•	
Authentication mode: The DB authentication we want to use. Windows (in-
built) is chosen by default. The SQL Server login for the reporting DB needs 
to be cross-domain for ease of access.
•	
Connection IDs: Provide a consumer name and password for the DB 
administrator. This field will be disabled in case the SQL authentication 
is not chosen.
•	
Click on Test Connection to confirm that the configuration tool can talk to 
the DB server.
For data transfer notifications, the following needs to be done:
•	
Provide source and target e-mail addresses for sending success and 
failure alerts.
•	
Data transfer activity sends e-mail notifications with the results of data 
warehouse operations. This permits administrators to respond quickly to 
disruptions in the reporting functionality.

Installing CloudPortal™ Services Manager 11.0
[ 32 ]
For details on Reporting Services, the following parameters need to be set:
•	
Report server URL: Specify the URL of the reporting server as it becomes 
visible in the SQL Reporting Services Server Configuration Manager.
•	
Consumer name and password: Provide the IDs of the report server 
administrator consumer. The password for this consumer account 
should never expire in order to avoid probable service disruptions.
•	
Click on Test Connection to confirm that the configuration tool can talk to 
the reporting server.
For Data Warehouse Service, the following parameters need to be set:
•	
Auto-generate ID: Select this option to create the service account with 
automatically generated IDs. Leave this option cleared to stipulate our 
own ID for this account.
•	
Consumer name: Provide a unique consumer name for the service account. 
The default name is csm_dataw_svc.
•	
Password: Provide a password for this ID that conforms to our 
domain's password policy. This field will be unavailable if you 
choose to auto-generate IDs.
•	
Create if doesn't exist: Select this to create a service account if it does not 
already exist, else provide your account.
•	
Service port: Default port is 80, you can customize as well.
•	
Data purge window (months): Select Configure and then specify the number 
of months after which older historical data should be deleted. For example, 
specify 84 to delete data that is older than seven years.
Role 5: selecting a web role and configuring service 
package import and the web server
For the service package import, the following needs to be done:
•	
Analyze (go through) the selected service components that will be imported 
when the Web Server role is configured.
For configuring the web server, the following parameters need to be set:
•	
External address: Provide an externally resolvable FQDN that can be 
reached. The default alias is cortexweb.
•	
Binding IP: Default that all IP addresses are built-in.

Chapter 2
[ 33 ]
•	
Use SSL: Provide your Enterprise SSL Servers (if required); for POC/Lab, 
leave it unchecked.
•	
SSL certificate: Stipulate the SSL certificate you wish to utilize for the server.
•	
Summary screen: Evaluate the configuration information for the server role. 
If you want to modify something, return to the apt configuration page. 
When the summary contains the settings you want, click on Commit.
•	
Post configuration completion: Click on Finish to go back to the Deploy 
Server Roles & Primary Location screen.
Configuring the location of the CPSM role 
using GUI
Configuring the primary location initializes the control panel, specifies service 
provider details, and provisions the first administrator. Configure the primary 
location once per deployment.
Perform the following steps for primary location configuration:
1.	 On the Deploy Server Roles & Primary Location screen, choose Configure 
Primary Location and then click on Next.
2.	 On the Load Deployment Configuration File screen, browse to the XML file 
you have stored, select it, and then click on Next.
3.	 On the Specify Location Details screen, enter the following information and 
then click on Next:
°°
For the Location Settings, provide the Name and Description values 
for Primary location.
°°
For the Customers' OU, provide the OU name and the display name 
for the top-level Client OU. The default OU name is Consumer and 
the default display name is Client OU.
4.	 On the Enter Service Provider Details screen, provide the following 
information and then click on Next:
°°
For Display Name, provide the service provider's name.
°°
For Short Name, enter a description of the display name.
5.	 For UPN Suffixes, enter one or more UPN suffixes to subordinate with the 
Active Directory in our infrastructure. This assists us in providing client or 
consumer user-specific UPN logons. The default UPN suffix is csp.local.
6.	 For Contact name & email, provide the name and e-mail ID of the Primary 
contact for the location.

Installing CloudPortal™ Services Manager 11.0
[ 34 ]
7.	 On the Create First Administrator screen, enter the full name and login IDs 
for the top-level/Super administrator Consumer for the location, then click 
on Next.
8.	 On the Summary page, review the location settings and administrator 
information you provided. If you want to change anything, go back to 
the required screen. Upon finalization, click on Commit.
Perform the following steps for the remote location configuration:
1.	 From your file cluster or from the installation media execute Setup.exe and 
then click on Get Started.
2.	 From the Deployment Task screen, choose Add Services & Locations.
3.	 Now on the Add Services & Locations page, select Add Remote Location.
4.	 Now on the Configure Remote Location page, select Configure Location.
5.	 From the Load Deployment Configuration File screen, browse to the XML 
file you have stored, select it, and then click on Next.
6.	 On the Specify Location Name Details screen, provide the following 
information and then click on Next:
°°
For the Location Settings, provide the Name and Description values 
for Primary Location.
°°
For the Customers' OU, provide the OU name and the display name 
for the top-level Client OU. The default OU name is Consumer and 
the default display name is Client OU.
7.	 On the Summary page, review the location settings and administrator 
information you provided. If you want to change anything, go back to 
the required screen. Upon finalization, click on Commit.
Installing CPSM roles using command 
line
In the previous section, we have seen how to install CPSM using the GUI mode. Now 
it is time for us to learn about installing CPSM using the command line. Moreover, 
we would come across a term called Cortex in the command prompt which is 
explained in the following section.

Chapter 2
[ 35 ]
Cortex
In February 2011, Citrix broadcasted that they have acquired the company called 
EMS Cortex. EMS Cortex offers varieties of products and solutions which are purely 
web-based controls, capable of integrating into a lot of products from Microsoft and 
Citrix, thereby making administration easy.
Core installation using CLI
Please execute the following command to install CPSM using the CLI:
CortexSetupConsole.exe /install: objects /Help
The following are the objects that required to be installed for each role:
•	
ConfigTool
•	
Provisioning
•	
DirectoryWebService
•	
Web
•	
Reporting
•	
ReportMailer
Perform the following steps:
1.	 Log on to the server with the administrator privilege.
2.	 Open Command Prompt via Run.
3.	 Execute the specific server role.
Configuring the CPSM role using command 
line
As the next step, we are going to configure the CPSM role using the command-line 
interface and the following syntax to configure the server:
CortexConfigConsole.exe/ConfigFile:XML-file /Configure: Objects /task-
options [/Help]

Installing CloudPortal™ Services Manager 11.0
[ 36 ]
Configuring database objects
Perform the following steps to configure database objects:
1.	 Log on to the server with the administrator privilege.
2.	 Open Command Prompt via Run.
3.	 Execute the following command to enable the DB server role:
/CortexSql:DB_Name [DB_Name refers to SQL DB]
/CortexSqlAuthMode:SQL|Windows[Option to set authentication mode]/
CortexSqlUsername:username [Option to set DB Admin User ID]
/CortexSqlPassword:password[Option to set DB Admin password]
/CortexSqlPort:port[Option to set port no of SQL DB | Default 
:1433]
/GenerateCortexSqlCredentials:True | False [In case option set to 
True, CortexProp, ExchangeLogs, OLMReports, and OLMUser SysDB IDs 
are generated robotically ]
/CortexPropPassword:password
/ExchangeLogsUserPassword:password
/OlmReportsUserPassword:password
/OlmUserPassword:password
/GenerateConfigFile:XMLname[Option to set Location and file name 
for XML configuration file]
Configuring the Provisioning and Directory Web 
Service server roles
Perform the following steps to configure the Provisioning and Directory Web Service 
server roles:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enabled the Provisioning and DBWS 
server role:
CortexConfigConsole.exe/ConfigFile:\\server-name\config-file.
xml /Configure:Provisioning,DirectoryWebService/SmtpServer:mail.
takahepubs.com/DirectoryServiceUsername:cortex_dirws_svc /Director
yServicePassword:password

Chapter 2
[ 37 ]
Configuring the primary location
Perform the following steps to configure the primary location:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enable the primary location:
CortexConfigConsole.exe/ConfigFile:\\server-name\config-file.
xml /Configure:Location/PrimaryLocation:True /LocationName:My 
First Location /LocationOU:Organization-Name /LocationOULabel:My 
Organization /CspAdminPassword:password /CspContact:CSP-Name /
CspContactEmail:cspadmin@my-org.com /CspUPN:my-org.com
Configuring the remote location
Perform the following steps to configure the remote location:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enable the remote location:
CortexConfigConsole.exe /ConfigFile:\\server-name\config-file.
xml /Configure:Location /PrimaryLocation:False /LocationName:My 
Second Location /LocationOU:Organization-Name /LocationOULabel:My 
Organization 
Configuring the reporting options for deploying 
reports
Perform the following steps to configure the reporting options:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enable reporting options for 
deployment reports:
/ReportingServer:url [Report server unified resources location]
/ReportsUserName:username
/ReportsPassword:password
/PublishReports:report[,report]… [Reports of various services such 
as Lync,Citrix Apps,Dns,Exchange, File Server,Billing, Metering, 
OCS etcs..!]
/PublishAllReports:True | False
www.allitebooks.com

Installing CloudPortal™ Services Manager 11.0
[ 38 ]
Configuring the reporting [Data warehouse] object
Perform the following steps to configure the reporting object:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enable the reporting object:
/SuccessEmailFrom:address [Source Email ID for success 
notification]
/SuccessEmailTo:address[Target Email ID for success notification]
/FailureEmailFrom:address[Source Email ID for failure 
notification]
/FailureEmailTo:address[Source Email ID for failure notification]
/GenerateDataTransferCredentials:True | False
/DataTransferUserName:username
/DataTransferPassword:password
/SmtpServer:address
/SmtpServerPort:port
Configuring the report mailer object
Perform the following steps to configure the report mailer object:
1.	 Log on to the server with the administrator privilege.
2.	 Open the Command Prompt via Run.
3.	 Execute the following command to enable the reported mailer object:
/CustomerId [Client ID]
/ReportMailerEmailServer:name [SMTP Server Name]
/GenerateUserCredentials:True | False 
/ReportMailerTaskUserName=username
/ReportMailerTaskUserPassword:password
/ReportMailerEmailServerPort:port [ Default = 25]
/ReportMailerEmailUserName:username
/ReportMailerEmailPassword:password

Chapter 2
[ 39 ]
Summary
In this chapter, we learned about installing CPSM using GUI and CLI with a detailed 
step-by-step approach and also about the metrics to be verified prior to installation. 
In the next chapter, we are going to discuss how to deploy and support services on 
CPSM along with the deployment of service scenario, with a three-phased approach 
recommended by Citrix Systems.


Deploying CloudPortal™ 
Services Manager 11.0
In Chapter 2, Installing CloudPortal™ Services Manager 11.0, you will have obtained 
the knowledge to install and configure CPSM using the GUI and the command-line 
interface. Now let us learn about and explore deploying services using CPSM.
In this chapter we will learn about the following:
•	
An overview of CPSM service deployment
•	
Scenario 1: Citrix service deployment
•	
Scenario 2: Microsoft SharePoint Service deployment
•	
Scenario 3: VM Service deployment
•	
Exporting and importing service packages
An overview of CPSM service 
deployment
CPSM supports a variety of cloud services that can be provided to cloud consumers 
such as clients and resellers. CPSM Service deployment has a crystal clear workflow 
that has to be followed:
•	
Step 1: Install the service that to be provided
•	
Step 2: Configure the service that is to be provided

Deploying CloudPortal™ Services Manager 11.0
[ 42 ]
•	
Step 3: Provide the service to cloud consumers and cloud clients
Step 1:
Install Services
Step 2:
Configure Services
Step3:
Provision to Users
Process of CPSM service deployment
Now let us look at the procedure to install the service. Before we get started with 
installing the service, some customization is required in place; that is, most of the 
services require web services to be installed mandatorily.
A list of services that require a web service is: ADFS (for use with the CRM 2011 
service), Citrix XenApp, Hosted Exchange, Lync Enterprise, Lync 2010 for Hosting 
MySQL, Office Communication Server 2007, SharePoint 2010, Virtual Machine, and 
Windows Web Hosting. During the installation and configuration of the web service, 
the Service Manager Setup tool creates an IIS pool. Web applications and websites 
need to be configured so that the site works for cloud consumers.
By default, all the configuration files are stored in C:\inetpub on the server on 
which the web service is installed. Some services do not require a web service and 
only need the Control Panel configuration. These services are AD Sync, CRM, DNS, 
File Sharing, Archiving Mail, and Microsoft SQL Server DB Hosting.
Upon successful completion of installation, we need to follow a standard procedure 
for service configuration on CPSM. The following steps need to be performed:
1.	 Permit the service at the Top environment and Location levels.
2.	 Add IDs for accessing the Servers and Management tools.
3.	 Add the servers connected with Service.
4.	 Allocate service roles to the servers.
5.	 Add service associations to add the servers into CPSM.
6.	 Allocate the servers to a collection and arrange the service settings.

Chapter 3
[ 43 ]
Once the service configuration is successfully completed, we can move on to the 
client provisioning in order to permit client and consumer plans. A condition must 
be fulfilled: we need to set the cloud Service Provider's Reseller service permitting 
them to stay at the Top environment and Location levels. After this, the consumer 
can provide services to clients.
If a service that is provided to consumers cannot be disabled at the Top 
environment level, it has to be de-provisioned from all consumers and 
resellers; after that, it can be deleted from the Location level.
Scenario 1 – Citrix® Service deployment
In this scenario of Citrix Service deployment, which uses a workflow approach (as 
recommended by Citrix Systems), let us understand the high-level approach to be 
followed for the deployment. Before that, from a support perspective, we need to 
keep in mind that XenApp is the only version that is supported. Most importantly, 
a Citrix web service component needs to be installed on all Citrix XenApp member 
servers that make hosted apps and desktops available for provisioning to users.
The supported versions of Citrix XenApp on CPSM 11.0 are Citrix XenApp 5.0 for 
Windows Server 2008, Citrix XenApp 6.0 for Windows Server 2008 R2, and Citrix 
XenApp 6.5 for Windows Server 2008 R2.
Citrix Service deployment overview on CPSM 
11.0
Hopefully, by now you will have understood the high-level operations and essentials 
for CPSM to be deployed. Now let us go ahead and apply the same learning to the 
scenario of Citrix Service deployment. The following is a step-by-step approach to 
enable Citrix Services via CPSM:
•	
Step 1: Deploying Citrix web services on a server in the Citrix farm
•	
Step 2: Service Configuration using the Control Panel
•	
Step 3: Importing App Hub from the Citrix farm to the server collection
•	
Step 4: Providing the service to consumers

Deploying CloudPortal™ Services Manager 11.0
[ 44 ]
Step 1 – deploying Citrix® web services on a 
server in the Citrix® farm
Let us look at the step-by-step approach in deploying Citrix web services 
using CPSM:
1.	 From the Choose Deployment Task screen, choose Add Services 
& Locations.
2.	 From the Add Services & Locations screen, choose Install Services.
3.	 Read and accept the license agreement and then click on Next.
4.	 From the Web Services screen, choose Citrix Web Service and then 
click on Next.
5.	 From the Ready to install screen, review your choice and then click 
on Install.
6.	 After the installation, click on Finish.
7.	 From the Installed Services screen, click on Configure near the Citrix web 
service list item.
8.	 On the Configure IIS screen, provide the following information and then 
click on Next:
°°
Auto-generate IDs: Choose this option to create a monitoring service 
account with autogenerated credentials. Leave this option cleared to 
specify your own credentials for this account.
°°
User name: Provide a user ID for the Citrix web service account. 
The default username is csm_citrix_svc. This field is not available 
if you elect to autogenerate IDs.
°°
Password: Provide a password for the Citrix web service account. 
This field is not available if you elect to autogenerate credentials.
°°
Service port: Provide a port used by the Citrix web service. By 
default, the port is 8095.
9.	 On the Summary screen, review the configuration details. If you want 
to change anything, go back to the appropriate configuration screen. 
When the summary holds the settings we want, click on Next. Finally, the 
Configuration Tool configures the Citrix web service and shows the progress. 
Click on Finish upon completion.

Chapter 3
[ 45 ]
Step 2 – Service Configuration using the 
Control Panel
Now that we have installed CPSM Citrix Web Services, let us take a step-by-step 
approach to configure Citrix web services using CPSM:
1.	 Permit the service from the Top and Location levels:
For the Top level:
1.	 Open Service Manager.
2.	 Go to the menu bar.
3.	 Navigate to Configuration | System Manager.
4.	 Then choose Service Deployment.
For the Location level:
1.	 Open Service Filter.
2.	 Choose AD Location Services.
3.	 Then choose a value for Location Filter.
2.	 Examine IDs:
1.	 Open Service Manager.
2.	 Go to the menu bar.
3.	 Navigate to Configuration | System Manager.
4.	 Choose IDs; meanwhile, do ensure that the Admin account for Citrix 
Services is enabled.
While adding IDs, we have to ensure that encryption is 
permitted on the console.
3.	 Enable the Citrix server:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Servers (verify whether Citrix Server is enabled).

Deploying CloudPortal™ Services Manager 11.0
[ 46 ]
4.	 Allocate server roles:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Server Roles and then expand the entry of the server.
4.	 Under Server Connection, choose the Citrix App server and then 
click on Save.
5.	 Add a server connection:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose a server connection (choose a new connection).
4.	 Options to be filled are shown in the following table:
Option
Description
Server Role
Choose Citrix XenApp.
Server
Choose the Citrix XenApp member server where the 
Services Manager web service is installed.
Credentials
Choose the IDs for the Citrix XenApp member server.
Protocol
The default value is http.
Port
The default value is 8095. If you change the port here, 
change it in the Services Manager Web Service as well.
Timeout
The default value is 200000 MS.
5.	 Upon completion, click on Save.
6.	 Open Service Manager.
7.	 Go to the menu bar and navigate to Configuration | 
System Manager.
8.	 Choose Server Connections and click on the Test icon. The XenApp 
icon changes to green when the connection is successful and changes 
to red to indicate an unsuccessful connection.

Chapter 3
[ 47 ]
6.	 Create a server collection:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Navigate to Server Collections | Filter and choose the relevant 
location from the record.
4.	 Click on New Server Collection.
5.	 Provide a name for the collection; we cannot change or delete a 
collection name after providing the server collection to a customer 
or after saving applications, application groups, or resources on the 
server collection.
6.	 From the Service list, choose Citrix.
7.	 From the Servers list, choose each Citrix XenApp member server to 
be managed under the server collection and then click on Save.
Step 3 – importing App Hub from the Citrix® 
farm to the server collection
After configuring the Citrix service, let us now take a step-by-step approach to 
import apps; in order to do so, perform the following steps:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | System Manager.
3.	 Choose Server Collections and then modify New Application Settings 
as required for the server collection.
4.	 Choose the Set new applications to default for customer option to 
automatically choose it for providing to customers and users. You can 
override this setting at the reseller level.
5.	 Choose the Make new applications public to all customers option to 
provide all new applications for public access.
6.	 Choose the Generate missing application groups option to automatically 
create a security group in the Active Directory for applications. The 
application group name is in the form of CitrixApp {DatabaseID} or 
CitrixApp {Name} based on the Application Group Name Service setting.
www.allitebooks.com

Deploying CloudPortal™ Services Manager 11.0
[ 48 ]
7.	 Click on Refresh to start the import operation.
8.	 If a time-out occurs during the import operation, change the Timeout value 
on the connection (Configuration | System Manager | Server Connections).
9.	 Reiterate steps 1 to 3 for each server collection.
Step 4 – provisioning the service to 
consumers and to resellers
The final step of this scenario is to provide apps to the cloud consumers. In order to 
do so, perform the following steps:
1.	 From the Services Manager menu bar, click on Customers and choose the 
customer for whom you want to provide the services.
2.	 Choose Services. The Customer Services screen appears.
3.	 Click on the Citrix service name and a screen appears that allows you to 
grant access to Citrix applications.
4.	 Choose the server collection that the customer can use to access resources.
If only one server collection is available, only that collection's 
resources appear. If multiple server collections are available, 
you can only configure one collection for the customer.
5.	 Choose the application groups, applications, and resources that the customer 
can access.
6.	 Click on Provision to enable the customer to provide Citrix services to users.
Scenario 2 – hosted Exchange Service 
deployment
I hope Scenario 1 helped you understand about Citrix Apps as a service via CPSM. 
Now let us explore Exchange as a service using CPSM through the following steps:
•	
Step 1: Installing Exchange-hosted web services
•	
Step 2: Configuring the hosted web services
•	
Step 3: Providing the hosted Exchange service to consumers

Chapter 3
[ 49 ]
Step 1 – installing Exchange-hosted web 
services
Exchange-hosted web services are installed on a system that hosts the Exchange 
Management console. We can now install the Exchange web service using either 
the GUI or the command-line interface.
Perform the following steps to do so:
1.	 Navigate to the Deployment Task screen and choose Add Services 
& Locations.
2.	 From the Add Services & Locations screen, choose Install Services.
3.	 Read and accept the license agreement and click on Next.
4.	 Go to the Web Services screen, choose Exchange Web Service, and then click 
on Next.
5.	 From the Ready to install screen, click on Install. The Deploying Server 
Roles screen displays the installation progress.
6.	 After the installation finishes, click on Finish.
7.	 From the Installed Services screen, click on Configure next to the Exchange 
web service list item.
8.	 From the Configure IIS screen, provide the following info and then click 
on Next:
°°
Auto-generate IDs: Choose this option to create the monitoring 
service account with autogenerated credentials. Leave this option 
cleared to specify your own credentials for this account.
°°
User name: Provide a user ID for the Exchange web service account. 
The default username is csm_exchange_svc. This field is not 
available if you elect to autogenerate IDs.
°°
Password: Provide a password for the Citrix web service account. 
This field is not available if you elect to autogenerate credentials.
9.	 Keep the Create if doesn't exist checkbox selected to allow the web service 
account to be created if it does not already exist in AD.
10.	 Use Service port to provide the port to be used by the Exchange web service. 
By default, the port is 8095.

Deploying CloudPortal™ Services Manager 11.0
[ 50 ]
11.	 On the Exchange Deployment Details screen, provide the following 
information and then click on Next:
°°
Exchange version: Choose the version of Exchange that is deployed 
in your environment.
°°
Mixed-mode deployment: Choose this checkbox if your Exchange 
deployment includes servers running different versions of Exchange.
°°
Preferred domain controller: Provide the FQDN of the domain 
controller you want to use with the web service.
°°
From the Configure Exchange for Multi-Tenancy screen, choose 
Apply multi-tenancy permissions to ensure customers will be 
isolated appropriately when the Exchange service is provided to 
them. Then click on Next.
12.	 From the Summary screen, review the configuration information. If you want 
to change anything, return to the appropriate configuration screen. When the 
summary contains the settings you want, click on Next. The Configuration 
tool configures the Exchange web service and displays the progress.
13.	 Click on Finish and then click on Exit to close the Configuration Tool.
Step 2 – configuring hosted web services
1.	 Permit the service from Top and Location levels.
For the Top level:
1.	 Open Service Manager.
2.	 Go to the menu bar.
3.	 Navigate to Configuration | System Manager.
4.	 Choose Service Deployment.
5.	 Expand Hosted Exchange.
6.	 Choose User Plan, provide a name for it, and click on Create.
7.	 Choose Consumer Plan, create a customer plan, click on Create, 
and save it.
For the Location level:
1.	 Open Service Filter.
2.	 Choose AD Location Services.
3.	 Then choose a value for Location Filter.
4.	 Expand Hosted Exchange and save it.

Chapter 3
[ 51 ]
2.	 Examine IDs:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | System 
Manager.
3.	 Choose IDs; in between, do ensure that the Admin account for Citrix 
Services is enabled.
While adding IDs, we have to ensure that encryption 
is permitted.
3.	 Enable the Exchange server:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Servers (verify whether Citrix Server is enabled).
4.	 Verify whether the Citrix Server is enabled and then choose Enable 
Server accordingly.
4.	 Allocate server roles:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Server Roles and expand the entry of the server.
4.	 Under Server Connection, choose Hosted Exchange server and then 
click on Save.
5.	 Add a server connection:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Server connection (choose a new connection).

Deploying CloudPortal™ Services Manager 11.0
[ 52 ]
4.	 Options to be filled are shown in the following table:
Option
Description
Server Role
Choose Hosted Exchange Server.
Server
Choose the Hosted Exchange MC server where the 
Services Manager Web Service is installed.
Credentials
Choose the IDs for the Hosted Exchange MC server.
URL Base
Use the /ExchangeWS/HostedExchange.asmx URL.
Protocol
The default value is http.
Port
The default value is 8095. If you change the port here, 
change it in the Services Manager Web Service as well.
Timeout
The default value is 200000 MS.
Version
Choose the Exchange version.
5.	 Upon completion, click on Save.
6.	 Update the required Service settings:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Service Deployment and choose AD Location Services and 
Location Filter.
4.	 Expand Hosted Exchange and choose the Service settings.
5.	 Any setting that has a value of [ExchangeServer] needs to be 
changed to the Exchange server's name.
6.	 Provide the sys domain name in Sys Domain, else you may end up 
with a provisioning service failure.
7.	 Choose a mail database in Preferred Mail Services.
8.	 Navigate to Public folder | Public folder enable.
9.	 Then navigate to Public folder | Public folder server.
10.	 Offline Address book can be spread using Public folder.

Chapter 3
[ 53 ]
7.	 Create a mailbox during user provision:
1.	 Keeping ADSL chosen, expand Hosted Exchange and click on 
User Plans.
2.	 Choose the Mail Databases checkbox, click on Reload, and then 
choose at least one mail database.
3.	 Choose the Mailbox storage limit checkbox and provide the 
maximum amount of storage allocated to each provisioned user.
4.	 Click on Apply and then on Save.
Step 3 – provisioning the hosted Exchange 
service to consumers
After the configuration of hosted Exchange services, our next primary objective is to 
provide the service to clients. In order to do so, please perform the following steps to 
provision the end users:
1.	 From the Services Manager menu bar, click on Customers and choose the 
customer for whom you want to provide services.
2.	 Choose Services. The Customer Services screen appears.
3.	 Click on the Exchange service name. The Grant access to "Hosted" Exchange 
applications screen appears.
4.	 On Customer Plan, choose the package you want to provide to the client.
5.	 On Exchange Domain, the domain needs are to be selected for the purpose 
of inbound e-mail routing.
6.	 Then, on the Exchange Domains pattern choose either Force customer wide 
primary address or Manage individual user primary e-mail addresses.
7.	 Ensure that the appropriate Exchange version is selected.
8.	 Resource restriction and resource configuration are possible under their 
respective tabs.
9.	 Billing can be enabled with suitable charges.
10.	 Click on Provision to enable the customer to provide Exchanges services 
to users.

Deploying CloudPortal™ Services Manager 11.0
[ 54 ]
Scenario 3 – Virtual Machine Service 
deployment
I hope that Scenario 2 has helped you understand using messaging and collaboration 
as a service via CPSM. Now let us explore VM as a service using CPSM:
The overall steps involved in VM as a service are as follows:
•	
Step 1: Deploying the VM web service on a server
•	
Step 2: Service Configuration using the VM service
•	
Step 3: Providing the VM service to clients
Step 1 – deploying VM web service on a 
server
Virtual machine as service via CPSM requires installation of CPSM components. 
In order to deploy the components, perform the following steps:
1.	 On the Choose Deployment Task screen, choose Add Services & Locations.
2.	 On the Add Services & Locations screen, choose Install Services.
3.	 Read and accept the license agreement and then click on Next.
4.	 On the Choose Web Services screen, choose Virtual Machine Web Service 
and then click on Next.
5.	 On the Ready to install screen, review your choice and then click on Install.
6.	 After installation, click on Finish.
7.	 From the Installed Services screen, click on Configure next to the Virtual 
Machine web service list item.
8.	 On the Summary screen, review the configuration info. If you want to change 
anything, go back to the suitable configuration screen. When the summary 
contains the settings we want, click on Next. The Configuration Tool 
configures the VM webs service and exhibits progress.
9.	 Click on Finish and then click on Exit to close the Configuration Tool.

Chapter 3
[ 55 ]
Step 2 – Service Configuration using the VM 
service
As of now, we have installed the required VM service, and as the next step, let us 
start configuring each component required for the VM service.
1.	 Permit the service from Top and Location levels:
For the Top level:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Service Deployment.
4.	 Expand Virtual Machine.
5.	 Choose Consumer Plan, create a customer plan, click on Create, 
and save it.
For the Location level:
1.	 Open Service Filter.
2.	 Choose AD Location Services.
3.	 Choose a value for Location Filter.
4.	 Expand VM and save it.
5.	 Verify whether the following settings have values as shown in the 
following table:
Setting
Value
RDP Console URL
VMconnection.aspx
Self Service Role
Self-service
VMPath
If the consumer is in a clustered Hyper-V host, 
change the path from {PreferredDrive}Images\
{CustomerShortName} to {PreferredDrive}\
{CustomerShortName}

Deploying CloudPortal™ Services Manager 11.0
[ 56 ]
2.	 Examine IDs:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose IDs; in between, do ensure that the Admin account for Citrix 
Services is enabled.
While adding IDs, we have to ensure that encryption 
is permitted.
3.	 Enable the Exchange server:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Servers.
4.	 Verify whether Citrix Server is enabled and then choose Enable 
Server accordingly.
4.	 Allocate the server roles:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Server Roles and then expand the entry of the server.
4.	 Under Server Connection, choose the hosted Exchange server and 
then click on Save.
5.	 Add a server connection:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 Choose Server connection (choose a new connection).

Chapter 3
[ 57 ]
4.	 Options to be filled are shown in the following table:
Options
Description
Server Role
Choose Virtual Machine.
Server
Choose the VM server where the Services Manager 
Web Service is installed.
Credentials
Choose the IDs for the VM Server.
URL Base
Enter /VirtualMachine/VirtualMachine.asmx. 
as the value.
Protocol
It defaults to http.
Port
It defaults to 8095. If you change the port here, change 
it in the Services Manager Web Service as well.
Timeout
It defaults to 200000 MS.
Version
Choose the Exchange version.
5.	 Upon completion, click on Save.
6.	 Test the connection when needed.
6.	 Synchronize resources needed:
1.	 Open Service Manager.
2.	 Go to the menu bar and navigate to Configuration | 
System Manager.
3.	 On Environment, choose Location and SCVMM servers.
4.	 Check the contents and import the existing Hyper-V.
5.	 Import the Hyper-V settings (if required).
7.	 Configure the virtual network:
We can create all four types of VLANs : Dedicated, Shared, Reserved, 
and Mandatory.
We can also assign multiple subnets to a VLAN and use the Service Manager 
for the default gateway configuration.
Perform the following steps to do so:
1.	 Open Service Manager.
2.	 Go to VM and navigate to Configuration | Virtual 
network Manager.
www.allitebooks.com

Deploying CloudPortal™ Services Manager 11.0
[ 58 ]
Step 3 – provisioning VM services to clients
After configuring VM services and primary objects of provision, the service 
configured to cloud consumers has to start. In order to do so, please perform 
the following steps:
1.	 On the CPSM menu bar, navigate to Customers | Customer Services.
2.	 Then on Customer Search, find the customer for whom you want to provide 
the Virtual Machine service.
3.	 In the Services list, click on Virtual Machine. The Service Plan 
Configuration screen appears.
4.	 On Customer Plan, we need to choose the plan that we want to assign to 
the customer.
5.	 In Management Server, choose the SCVMM server for handling customer 
requests generated through Services Manager.
6.	 Under Virtual Resources, perform the following actions:
1.	 Expand the Hosts & Networks node, and choose the server you want 
to host the VMs and the network under each host.
2.	 Expand the Machine Templates node, and choose the templates the 
customer administrator can use to create VMs.
3.	 Expand the Guest OS Profiles node, and choose the OS the customer 
administrator can assign to the machine templates.
4.	 Expand the DVD Images node, and choose the images the customer 
administrator can mount on virtual machines.
5.	 Expand the CPU Types node, and choose the CPUs the customer 
administrator can use for virtual machines.
7.	 Under Networking, Expand the node for the type of VLAN you want to 
assign and choose the VLAN to assign as the customer's virtual environment.
8.	 Under Resource Configuration, customize the settings assigned by the 
package template we have selected earlier.
9.	 Click on Advanced Settings and perform the following actions:
1.	 On Maximum Users, choose the Enable checkbox and enter the total 
number of users the customer can provide.
2.	 On Billing, ensure the Enabled checkbox is selected so that the 
service generates charges to the cloud customers.
10.	 Click on Provision to enable the customer to create virtual machines.

Chapter 3
[ 59 ]
Other services that can be deployed via CPSM and can be provided to cloud 
consumers or cloud resellers are as follows:
•	
CRM 2011
•	
DNS
•	
File Sharing
•	
Lync Enterprise and Lync Hosted
•	
Mail Archiving
•	
Microsoft SQL Server Hosting
•	
MySQL
•	
Office Communication Server 2007
•	
SharePoint 2010
•	
Windows Web Hosting
For detailed deployment methods, refer to http://support.citrix.com/
proddocs/topic/ccps-11/ccps-services-deploy.html.
Exporting and importing service 
packages
For exporting and importing service packages, you need to ensure the following 
requirements are met:
•	
Validate that the source and destination environments for the service 
package have the unique version of CPSM installed.
•	
Verify that a user is configured with the two schema administrator roles: 
All Services Schema Administrator and Service Schema Administrator. 
It is mandatory to create a custom service or import or export a service.
•	
Create the service (Configuration | System Manager | Service Deployment) 
or configure the property.
•	
Test and verify the service to be exported.

Deploying CloudPortal™ Services Manager 11.0
[ 60 ]
Please perform the following steps to export a service package:
1.	 Log on to the CPSM control panel.
2.	 From the Services Manager menu bar, navigate to Configuration | System 
Manager | Service Schema.
3.	 Expand the service to be exported.
4.	 Click on Export to save the file to a required store.
5.	 (Optional best practice:) Specify the creator, URL, and version for the service.
6.	 On the Preview area, review the items to be included in the export file and 
update as needed.
7.	 To add an assembly file (.dll) to the export package for a custom service, 
perform the following steps:
1.	 In the Add file area, click on Browse, navigate to the .dll file, and 
click on Open.
2.	 Choose the folder for the DLL file and then click on Add.
8.	 Click on Export and save the exported file.
Please perform the following steps to import a service package:
1.	 Log on to the CSPM control panel. This operation requires the user roles of 
All Services Schema Administrator and Service Schema Administrator.
2.	 From the CPSM menu bar, navigate to Configuration | System Manager | 
Service Schema.
3.	 On Service Management, click on Import a service.
4.	 Click on Browse to navigate to and select the service, and then click 
on Open.
5.	 To review the items included in the package file, click on Preview 
and update the selections as needed.
6.	 Click on Import. An Import Complete message gets displayed, 
followed by a list of the actions performed during the import.
7.	 Restart all provisioning servers across all locations.
8.	 We need to use the CPSM control panel to update customer and user plans 
and service settings as needed.

Chapter 3
[ 61 ]
Summary
In this chapter, we learned about the overall steps involved in deploying services 
using CPSM and also went through the process of deploying services such as Citrix 
as a service, VM as a service, and Hosted Exchange as a service. Along with that, we 
also learned about importing and exporting services using the CPSM control panel. 
In the next chapter, we will learn about CPBM installation and configuration.


Managing CloudPortal™ 
Services Manager 11.0
With the knowledge gained in Chapter 3, Deploying CloudPortal™ Services Manager 
11.0, you will have understood about services deployment. Now let us get into the 
CPSM functionality, followed by the CPSM's wizard-driven system to simplify 
operational tasks. It's a unique solution as a role-based system, characterized by 
flexibility and scalability. Let us start with creating and managing cloud consumers.
In this chapter we will learn about the following:
•	
Creating and managing cloud consumers and tenants
•	
Managing security roles and provisioning changes
•	
Managing reports
Creating and managing cloud consumers 
and tenants
Until now, you have learned a lot about services deployment using the CPSM 
deployment tool; now, we will have a look at how to create and manage cloud 
consumers and clients using CPSM.
Customer creation using CPSM involves the following:
•	
Hosted services: These are the deployed services
•	
Customer's users: These are the consumer admin accounts
•	
Consumers/users: These are the cloud clients who have access to one or more 
provisioned services
•	
Self-Service resellers: These are the resellers who can create and manage 
their own accounts

Managing CloudPortal™ Services Manager 11.0
[ 64 ]
An overview of customer creation
In this section, we will learn about the initial steps in the creation of a customer. 
In order to create a new user, we need to perform the following steps:
1.	 Create a new consumer by navigating to Customers | New Customer from 
the Citrix Portal Services Manager menu bar.
2.	 Create a customer Admin user to manage their users and perform 
operational services in the consumer's organization.
3.	 Provision Service is available to consumers (an operation that can only be 
performed by a cloud service provider or a cloud reseller).
4.	 Create a consumer to provision the services later (an operation that can be 
performed by a cloud consumer admin user).
5.	 Provision services to consumers (an operation that can be performed by a 
cloud consumer admin user).
To create a consumer, a cloud service provider provisions a customer and their 
consumers with the Resellers option. The Resellers option, in turn, creates its own 
consumers and enables them to be resellers as well. Service providers should be able 
to access the advanced CPSM control panel for configuration functions.
Creating users
The following list enumerates the various entities via which cloud consumers 
can be created:
•	
Create new users using the New wizard
•	
Import many users using Bulk User Import
•	
Transfer consumers from one cloud tenant to another (client)
In order to create a user, we need to perform the following steps:
1.	 Click on Users and choose New User from the CloudPortal Services 
Manager menu bar.
2.	 The mandatory information to be provided is Name, Display Name, User 
Name, and Password.
3.	 After this, service provision will be instantly available to the consumers.

Chapter 4
[ 65 ]
For configuring the account settings for the newly created user, perform the 
following steps:
1.	 Click on Additional User Properties to update the required information 
about the created user.
2.	 Under Account Settings, configure the following:
°°
For Change password at next logon, choose Yes to require the user 
to set a password when first logging in. Choose No to disable the 
change password option.
°°
For Set passwords to never expire, choose Yes to prevent user 
passwords from expiring. Choose No to permit the user password 
to expire at systematic intervals.
°°
For Account Disabled, choose Yes or No to disable/enable the user 
account respectively.
°°
For Account Locked, No is the only option, which is opted 
by default.
°°
For Account Expires, choose Never to prevent account expiration. 
Choose End of to choose the date when the account expires.
3.	 Click on Advanced Options to choose security roles for the user. The 
Configure a custom role collection checkbox and all the security roles 
are chosen by default.
4.	 For Configure a custom role collection, choose and allocate one 
preconfigured role using the drop-down list.
(Optional) Use Magnify Email Addresses to configure one or more e-mail 
addresses for the user. Else, the CPSM automatically configures an e-mail 
address constructed from the UPN.
5.	 Upon completion, we can select Provision to create the user.
Before we start, we need to provision the service to the consumers using CPSM. 
Now let's go ahead and see how to create a new template by performing the 
following steps:
1.	 On the CPSM menu bar, click on Users.
2.	 On Management, click on New Template User. On clicking, we will be able 
to see the Create User wizard.
3.	 For Display Name, provide a username for the template, and choose 
Additional Properties to add address, organizational, and other information.

Managing CloudPortal™ Services Manager 11.0
[ 66 ]
4.	 Click on Account Settings to configure the password change and 
expiration options.
5.	 Click on Advanced Options to choose a security role for the template user. 
To optimize the security role, choose Configure a custom role collection 
and commit it by clicking on Save. On doing that, the Provision Services 
wizard appears.
6.	 Choose the services that you want to provision when the template is used to 
create a new user and commit it by clicking on Save.
The process of importing bulk users or editing existing users in the current customer 
hierarchy can be performed by using Bulk User Import wizard. This tool is used in 
the Microsoft Excel 97-2003 format.
Bulk User Import defined by Citrix Systems from a functional standpoint
Perform the following steps:
1.	 Click on Users and choose the Bulk User Import option.
2.	 For Upload User Import File, choose Browse, steer to your new or edited 
workbook, and select it.
3.	 Update the description for the workbook and click on Upload.

Chapter 4
[ 67 ]
4.	 On the file list, click on the upload date of the file you uploaded and under 
Import File Management, click on Import. The User Import screen appears.
5.	 Click on New Users or Existing Users to view the uploaded users. (Optional) 
Expand a user to view the account properties associated with it.
6.	 Click on Save to import the selected users.
The upcoming option is a flexible feature (Transfer (Move/Copy)) for CPSM, 
which helps to move a cloud consumer from one cloud tenant to another. Migrating 
the user info and provisioned services to the new cloud tenant will require the 
following settings:
•	
Both cloud tenants must belong to the same CPSM location (that is, 
AD Domain).
•	
Provisioned services that will be transferred with the cloud consumers are 
limited to Hosted Exchange and Office Communications Server (OCS). 
If the user is provisioned with any other service, we have to undergo a 
process of de-provisioning that service before attempting the migration.
We can also make a copy of an existing cloud consumer within the customer 
hierarchy. The copied user resides in the original cloud consumer (customer) 
hierarchy and possesses the original consumer-provisioned services.
For performing Move operations:
1.	 From the CPSM menu bar, choose Users and navigate to Configuration | 
User Move.
2.	 In Customer Search, type a customer name (cloud tenant) and click on Next.
3.	 In User Search, type a username (cloud consumer) and click on Next.
4.	 Accept or edit the defaults and click on Next.
5.	 Click on Finish to move the cloud consumer (user).
For performing Copy operations:
1.	 Choose Users to display all the cloud consumers (users) for a cloud tenant 
(customer), then click on a user to access the User Functions wizard.
2.	 Click on Copy User. The Create User screen pops up.
3.	 Provide the user info and password for the new consumer and configure the 
consumer account settings.
4.	 Click on Copy Services and uncheck the boxes for any provisioned services 
that are not required.

Managing CloudPortal™ Services Manager 11.0
[ 68 ]
5.	 Click on Provision. The Provision Services screen displays all the 
provisioned and unprovisioned services.
6.	 Click on Provision for the service you want to provision to the user.
Managing security roles and provisioning 
services
A security role is a set of rules for setting up permissions that describe the cloud 
tenant, admin, and cloud consumer accesses to precise tasks in the CPSM. For this 
case, the first or default user created for a cloud tenant is a cloud tenant consumer 
admin. The cloud tenant admin is robotically assigned the customer admin security 
role. The cloud tenant admin can then assign one or more security roles to cloud 
consumers in the customer hierarchy. A security role can also consist of multiple 
security roles.
CPSM provides a security service to manage cloud tenants (customers), cloud 
consumers (users), cloud service tasks, cloud user services, and cloud reporting.
The following table lists the features of security roles installed by default on 
deployment of the CPSM:
Role
AD Sync Admin
DNS Service Admin
My Exchange Service
Advanced User View
Everyone
My Hosted Apps and 
Desktops Service
All Schema Admin
Exchange Service Admin
My Services Management
API User
Exchange Users
MySQL Admin
Authenticated Users
File Sharing Service Admin
OCS Service Admin
Citrix Service Admin
Hosted Apps and Desktops 
Service Admin
OCS User
Content Management 
Service Admin
Hosted Apps and Desktops User
Virtual Machine Admin
CRM 2011 Admin
Lync 2010 for Hosting Service 
Admin
Windows Web Hosting 
Service Admin
CRM 2011 User
Lync 2010 for Hosting User
Workflow Approval Admin
Customer Admin
Lync Enterprise Service Admin
Workflow Approval User
Partial User Admin 
Lync Enterprise User
Service Provider Admin
Reporting Users
Mail Archiving Service Admin
Service Schema Admin

Chapter 4
[ 69 ]
Role
Reseller Full Admin
My Account and Services 
Management
SharePoint 2010 Admin
Reseller Partial 
Admin
My Account Management
SQL Service Admin
Service Admin
Template User and Service 
Admin
User and Service Admin
SQL Users
User Admin
 
To manage and maintain changes on demand, there needs to be a change in the 
billing and pricing. A workflow helps us to approve or reject the changes as well as 
helps cloud consumers to control their cloud. By default, a workflow is not enabled 
in CPSM.
In order to enable a workflow operation, we need to perform the following steps:
1.	 From the CPSM menu bar, choose Configuration and navigate to System 
Manager | Workflow Setup.
2.	 On the Workflow Setup screen, click on Enable. The Workflow Setup screen 
shows configuration choices for workflow approval.
3.	 In Components, choose the workflow approval chain forms to be enabled 
in the control panel. By default, Manager Approval and Group Approval 
are selected.
4.	 For Email, configure the following objects:
°°
Reply Email Address: Address to be used for approval notifications
°°
Reply Email From: Email customization
°°
Web URL: External URL for the CPSM control panel
5.	 For Maintenance, in Retention Days, customize the number of days to keep 
the resolved approval requests in the database. By default, requests are kept 
for 30 days.
6.	 In order to enable self-service security roles for Workflow Approval, choose 
Allows users to manage their own account and services.
7.	 If required, choose Reset to default role settings to reapply the security role.

Managing CloudPortal™ Services Manager 11.0
[ 70 ]
Approval stage
There are the following three scenarios to look at here:
•	
Manager approval chains: These consist of consumers who are designated as 
managers. We can specify a user's manager using the Manager field on the 
User Details screen in the control panel. In this chain, activities are approved 
at successive levels in the consumers' organization.
•	
Group approval chains: These consist of consumers who elect to 
receive notifications for precise types of requests. In this chain, actions 
are approved by consumers who perform specific tasks within the cloud 
tenants' organization.
•	
Workflow can be enabled with security: While enabling workflow approval, 
we can also enable security roles that permit users to change their own 
account or provision services to themselves without additional approval.
Managing reports
CPSM includes the following billing formats:
•	
Customer Detail: Shows the billing details for services at the customer level
•	
Distributor Summary: Shows the usage data for reporting to the 
CSP distributor
•	
Reseller Detail: Shows the billing details for services at the reseller level
For generating reporting views, we need to ensure that the foundation for data 
transfer to the data warehouse is set. Please perform the following steps for 
generating a reporting view:
1.	 From the CPSM menu bar, click on Reports and navigate to Configuration | 
Data Warehouse.
2.	 On Refresh, click on Refresh report views from reporting services.
3.	 On Filter, select the service for which you want to generate views.
4.	 Under Generate, click on either of following:
°°
Views for all services: Click on this option to generate views for all 
deployed services
°°
Views for selected service: Click on this option to generate views for 
the service that we have selected in step 3

Chapter 4
[ 71 ]
In order to create a new reporting view, we need to ensure that it can transfer data 
to the data warehouse. Please perform the following steps for setting up a new 
report view:
1.	 From the CPSM menu bar, click on Reports and navigate to Configuration | 
Data Warehouse.
2.	 On the Filter option, select the service for which you want to create a 
new view.
3.	 Under Management, click on New Reporting View.
4.	 Under Reporting View Configuration, configure the following settings:
1.	 In Description and Base View, enter a friendly name and select an 
existing template on which to base the new view.
2.	 Under View Name, select the options you want for creating a unique 
view name.
5.	 Under Data Set, click on Keys or Filters to define the data included in the 
new view. Select Optimize for Large Datasets to improve the performance 
when a large number of records will be processed.
6.	 Under Properties, click on Properties and select to include properties from 
the selected base view or from the reporting object ID.
7.	 Under Property & Counter Aggregation, specify aggregate and non-
aggregate properties and counters.
8.	 Click on Apply Changes to save your selections and click on Save.
Summary
In this chapter, we learned about how to create a cloud user from CPSM using a 
variety of methods, such as the new user wizard, Bulk Import, and Transfer (Move/
Copy). We also learned about the various default security roles available on CPSM, 
how to provision a workflow, and then about how to manage reports. In the next 
chapter, we will see how to install and configure CPBM.


Installing CloudPortal™ 
Business Manager 2.0
In Chapter 4, Managing CloudPortal™ Services Manager 11.0, you learned about 
managing CloudPortal Service Manager. Now, let us learn and explore the 
installation and configuration of CloudPortal Business Manager.
In this chapter, we will learn about the following topics:
•	
Installation of CPBM
•	
Configuration of CPBM
•	
Starting and stopping CPBM
Installation of CPBM
In this section, let us learn about the installation of CPBM. CPBM helps cloud service 
providers by offering the following features:
•	
It runs Anything-as-a-Service (XaaS) from a modifiable catalog 
of services capable of running IaaS, PaaS, SaaS, as well as third-party 
cloud services.
•	
It permits users to have self-service access to the cloud infrastructure and 
client account management tools.
•	
It makes cloud services management simpler by unifying and mechanizing 
the provision services, BSS/OSS systems, pricing, billing, metering, and 
consumer management under a single, flexible platform.

Installing CloudPortal™ Business Manager 2.0
[ 74 ]
Now, let us get ready for CPBM installation and configuration. In order to get the 
sources for installation, visit https://www.citrix.com/downloads.html.
Upon downloading CPBM from Citrix, log in to CentOS with root credentials and 
extract the installation source package tarball using the following command in the 
required path of the server:
# tar -xvf CloudPortal-11.0-centos.tar.gz
Then go to the extracted folder on CentOS:
# tar -xvf CloudPortal-x.y.z-centos.tar.gz
In the next step, let us go ahead and install the MySQL database. MySQL can be 
installed on the same node where CPBM is to be deployed or it can be installed 
on a different node. CloudPortal Business Manager mainly uses the InnoDB 
storage engine.
You are already aware that CPBM 11.0 can be only installed on CentOS 
releases 5.6, 6.2, and 6.3, with a minimal requirement of Java JDK and JRE 
1.6 and later, along with MySQL Server 5.1.X.
Perform the following steps to install the MySQL DB:
1.	 Read and accept the license agreement on the CPBM wizard.
2.	 Run the script ./install.sh and choose option D to install the MySQL DB 
server as shown in the following screenshot:

Chapter 5
[ 75 ]
3.	 When prompted, provide a username and password. We can use preferred 
values that are valid for MySQL DB.
DB password is obligatory.
4.	 Copy vast.cnf to yourfile.cnf using the following command:
cp -rf /usr/share/mysql/my-huge.cnf /etc/my.cnf
5.	 Modify the my.cnf file under /etc/ and insert the following lines of code 
under the ["mysqld"] fragment:
default-time-zone='+00:00'
max_connections=200
6.	 Restart the MySQL service using the following command:
# service mysqld restart
Now MySQL DB is installed successfully on the selected CentOS node. Let us now 
go ahead and install the CPBM using the following steps:
1.	 Switch on the planned CPBM CentOS node and run the install.sh script 
from the downloaded package.
2.	 Select option I to start the installation on the CPBM node as shown in the 
following screenshot:

Installing CloudPortal™ Business Manager 2.0
[ 76 ]
3.	 Upon selecting I, we will get the following pop-up on the CentOS screen:
4.	 After the successful installation of CPSM, we will get another pop up on the 
CentOS screen as shown in the following screenshot:
Configuring CPBM
Upon the selection of option G to configure CPBM, we need to perform the 
following steps:
1.	 The first step is to provide CPBM public server information:
Public host name - <OUR CloudPortal IP> 
Public host port - 8080 
Public host protocol
2.	 Configure the CPBM startup with an encryption key. The encryption key 
length should be set to 16 characters. For security purposes, we need to 
provide an encryption key during the CPBM startup. The provided key 
will be used to encrypt the password field in the Cloud properties file.

Chapter 5
[ 77 ]
In case you select the encryption key option, you must memorize the 
encryption key because we will need to enter it every time we start 
the CPBM. The CPBM startup choice can be disabled in the following 
manner:
[root@localhost CloudPortal-2.0.0-100-centos]# Chkconfig 
--list cloud-portal
Cloud-portal 0: off 1: off 2: off 3: off 4: off 5: off 6: 
off
In case we do not choose the encryption key, we will not need to enter 
the key when we start CPBM. The upcoming startups of CPBM options 
are enabled as specified in the following successive modes; so, when we 
reboot the system, the CPBM service will start naturally in the successive 
modes (3, 4, 5, and so on):
[root@localhost CloudPortal-2.0.0-100-centos]# Chkconfig 
--list cloud-portal
Cloud-portal 0: off 1: off 2: off 3: on 4: off 5: on 6: 
off
3.	 Provide CPBM DB with the upcoming configuration information:
°°
Provide a host name, database username, and a database password.
°°
Now provide a CPBM database encryption key. As you are already 
aware, the encryption key length should be 16 characters.
4.	 Select Yes (Y) or No (N) only if we need to configure LDAP (configuring 
LDAP is discussed later in this chapter).
5.	 In the next step of configuration, please provide the following e-mail 
configuration details of the sender (SMTP/SMTPS):
E-mail protocol (please ensure it is SMTP), e-mail host (server that hosts 
the exchange), mail port (to use for to and fro communication), e-mail 
username and password (one should be a privileged user to access, 
send, and receive e-mails)
6.	 Provide all the active currencies and choose only one default currency for 
our CPBM deployment from the active currency code loaded on our screen.
7.	 Provide the liquibase settings.
8.	 For security reasons, please provide a reCAPTCHA configuration. 
The following parameters are required to be configured:
°°
A reCAPTCHA public key
°°
A reCAPTCHA private key
°°
A reCAPTCHA server

Installing CloudPortal™ Business Manager 2.0
[ 78 ]
Enabling CAS authentication
In order to enable Single Sign on (SSO), Citrix CloudPortal supports the CAS 
authentication mechanism to access multiple password-protected systems after 
logging in the credentials. In order to make this work, the following configuration 
steps need to be followed:
1.	 Log in as the root user of CPBM, which is running the CentOS host.
2.	 Modify the cloud.properties file under /usr/share/vts3/repository/
prop/ and lay down the following parameters; by default, native 
authentication is enabled:
vmops.authentication.service=cas
In case new users are using the CPBM Configuration tool, it is not necessary 
to perform the preceding steps; the CPBM Configuration tool will take care 
of the parameters mentioned in the following table:
Parameter
Description
URL
Login URL
cas.login.url mainly 
provides the public URL of the 
page where a user can log in to 
SSO.
http:// 
ourpacktpublichostname: 8080/
cas
Logout URL
cas.logout.url mainly 
provides the public URL of the 
page where a user can log out 
of SSO.
http://
ourpacktpublichostname:8080/
cas/logout
Service URL
cas.service.url mainly 
provides the public callback 
URL used by CAS to readdress 
reverts to Citrix CPBM.
http://
ourpacktpublichostname:8080/
portal/j_spg_cas_sc_ck
Validation 
URL
cas.validator.url mainly 
provides the private URL used 
in internal calls from Citrix 
CPBM to a CAS server to 
validate the CAS ticket.
http://
ourpacktprivatehostname:8080/
cas

Chapter 5
[ 79 ]
3.	 If any other application needs to be authenticated via CAS, some changes 
must be provides. Edit the deployerConfigContext.xml file as follows:
1.	 Unzip the cas.war file in the $VIRGO_HOME/pickup directory to a 
different location such as /tmp/cas/:
	
$ mkdir –p /tmp/cas
	
$ cp /usr/share/vts3/pickup/cas.war /tmp/cas/
	
$ cd /tmp/cas
	
$ jar –xvf cas.war
2.	 Open the deployerConfigContext.xml file found at /tmp/cas/WEB-
INF/deployerConfigContext.xml:
	
/tmp/cas $ vi WEB-INF/deployerConfigContext.xml
3.	 Add your new service in the deployerConfigContext file by 
searching for the serviceRegistryDao bean in the XML file and 
adding a new bean to its registeredServices property. The 
template is as follows:
	
<bean class="org.jasig.cas.services.RegisteredServiceImpl">
	
<property name="id" value="<Unique id>"/>
	
<property name="name" value="<Name of the application>"/>
	
<property name="description" value="<description of the 
         application>"/>
	
<property name="serviceId" value="<Callback URL used by CAS 
         to redirect back to the new application>"/>
	
</bean>
4.	 Recreate cas.war again using the jar utility as follows:
	
/tmp/cas $ jar cvf cas.war *
4.	 To copy the cas.war file back to the pickup directory, execute the 
following command:
/tmp/cas $ cp cas.war /usr/share/vts3/pickup/
5.	 To restart CPBM, execute the following command:
# Service cloud-portal restart

Installing CloudPortal™ Business Manager 2.0
[ 80 ]
Integration with CloudPlatform
On the Citrix CPBM server, execute the ./install.sh script and select Integrate 
with Citrix CloudPlatform from the menu. This will place the files required for SSO 
integration in CPBM:
After files are copied over for integration, we will not able to access the 
CloudPlatform Management System using http://<hostname>:8080/
client. Citrix recommends accessing the CPBM Management 
UI by first logging into CPBM and then clicking on Launch Cloud 
Console in the CPBM dashboard. As an alternative, the CloudPlatform 
Management UI can be accessed by using http://<hostname>:8080/
client/?direct=true.
In order to set up a proxy, we need to add an AD alias with the same-origin security 
policy for web source code. Another mandatory need is that CPBM should be 
accessible with a fully-qualified domain name. To fulfill this, requests must go 
through a proxy server that provides a single point of failure for both CPBM Portal 
and CPBM systems. This can be fulfilled in different ways. The following steps 
demonstrate a technique using an Apache HTTP system running on CentOS 5.x 
and CentOS 6.x:
1.	 On the Apache server, install the following module that provides SSL and 
TLS sustainability:
# yum install httpd mod_ssl

Chapter 5
[ 81 ]
2.	 Create a file named cloud.conf under /etc/httpd/conf.d/ and add 
proxying directives. To perform a single-node installation on the Apache 
system where the CloudPortal and CloudPlatform are installed, perform the 
following steps on the command line:
ProxyPreserveHost on
ProxyPass /portal http://CPIP:8080/portal
ProxyPass /cas http://CPIP:8080/cas
ProxyPassReverse /cas http://CPIP:8080/cas
ProxyPass /client http://CSIP:8080/client
ProxyPass /client/api http://CPIP:8080/portal/client/api
ProxyPass / http://CPIP:8080/portal
3.	 To perform a three-node installation where Apache is installed, 
CloudPortal and CloudPlatform all run on separate nodes. In order 
to replace CloudPortalNode and CloudPlatformNode with the private 
hostname or IP on our own machines, execute the following commands:
ProxyPass /portal ajp://CloudPortalNode:20410/portal
ProxyPass /client ajp://CloudPlatformNode:20400/client
CloudPortalNode will show 8009 by default. Modify 
the tomcat-server.xml file under /usr/share/vts3/
config/ and change the value of the port from 8009 to 20410 
in the following line:
<Connector port="8009" protocol="AJP/1.3" 
redirectPort="8443"
URIEncoding="UTF-8"/>
4.	 To perform a five-node installation where Apache is on one node, 
CloudPlatform on two other nodes, and CloudPortal on two additional 
nodes, use directives such as the following. In order to replace 
CloudPortalNode and CloudPlatformNode, place the following 
with the private hostnames or IPs of your own machine:
<Location /client> 
Header add Set-Cookie "rte=.%{BALANCER_WORKER_ROUTE}e; path=/
client; HttpOnly"
env=BALANCER_ROUTE_CHANGED
</Location> 
<Location /portal> 
Header add Set-Cookie "rte=.%{BALANCER_WORKER_ROUTE}e; path=/
portal; HttpOnly"

Installing CloudPortal™ Business Manager 2.0
[ 82 ]
env=BALANCER_ROUTE_CHANGED
</Location> 
<Proxy balancer://portalcluster> 
BalancerMember ajp://CloudPortalNode1:20410 route=ps1
BalancerMember ajp://CloudPortalNode2:20410 route=ps2
</Proxy> 
ProxyPass /portal balancer://portalcluster/portal 
stickysession=rte
<Proxy balancer://cscluster> 
BalancerMember ajp://CloudPlatformNode1:20400 route=cs1
BalancerMember ajp://CloudPlatformNode2:20400 route=cs2
</Proxy> 
ProxyPass /client balancer://cscluster/client stickysession=rte
5.	 To configure CAS authentication, use the following code:
<Location /cas>  
Header add Set-Cookie "rte=.%{BALANCER_WORKER_ROUTE}e; path=/cas; 
HttpOnly"
env=BALANCER_ROUTE_CHANGED
</Location> 
ProxyPass /cas ajp://CloudPortalNode:20410/cas
6.	 Insert the following line to avoid Cross-site request forgery (CSRF) 
related errors:
ProxyPreserveHost on
7.	 If we modify the configuration later, such as to add more nodes, we can use 
the following command to reload the configuration:
# apachectl graceful or # service httpd restart
To configure AD LDAP for CPSM, perform the following steps:
1.	 Log in to the CPBM as the root user.
2.	 Click on ROOT USER at the top-right corner of the CPSM UI.
3.	 Choose Administration from the dropdown.
4.	 On the Configuration dashboard, glance through the tab and select BSS/OSS 
Integration from the shown categories.
5.	 Select Directory Server and then click on Configure.
6.	 In the window that appears, click on Edit.
7.	 Enable the Field service by setting it to true.

Chapter 5
[ 83 ]
8.	 Update the field directory mode based on the following:
°°
To enable the LDAP push model, enable the Field Directory mode to 
push and then go to step 9.
°°
To enable the LDAP pull model, enable the Field Directory mode to 
pull. Update all the fields in the Edit window.
9.	 Click on Save and Close.
After configuring of the CPSM portal, let us learn how to log in to the CPSM portal. 
By now, we should be able to access CloudPortal from the web browser.
Open a compatible browser and navigate to http://<Hostname>:8080/portal/. 
Use the following credentials to log in:
•	
Username: root
•	
Password: Portal123#
Starting and stopping CPBM
CPSM maintenance options, such as start, stop, or restart, are in-built. To perform 
any operation, we need to log in to CPSM as the root user for the system, where 
CloudPortal Business Manager is installed and running, and issue the respective 
commands to perform their own operations.
The following table lists the various commands:
Operations
Command to perform operations
Starting CPBM
# Service cloud-portal start
Stopping CPBM
# Service cloud-portal stop
Restarting CPBM
# Service cloud-portal restart
Summary
In this chapter, we've learned about the overall steps involved in installing and 
configuring CPBM as well as operational steps such as starting and stopping the 
CPBM services. In the next chapter, we will learn about managing CPBM.


Managing CloudPortal™ 
Business Manager 2.0
In Chapter 5, Installing CloudPortal™ Business Manager 2.0, you gained knowledge 
of installing and configuring CPBM. Now let us learn about and explore managing 
various functionalities of CPBM.
In this chapter we will learn about the following:
•	
Managing profiles
•	
Managing products
•	
Managing workflows
•	
Managing accounts
•	
Managing billing
Managing profiles
A profile is nothing but a set of permissions saved under a unique name, such as 
Cloud "Administrator" or "Manager". Each and every user of our portal is allocated 
a profile. The profile is allocated to a user as soon as the user is added to the CPBM.
Profiles are useful for saving the most commonly used sets of permissions, so that 
they can be easily allocated to a user in a single operational step. This is much easier 
and less error-prone than setting up each user. Profiles ensure that a collection of 
users with equivalent duties and needs are all given same permissions.
Citrix CPBM ships with a predefined set of profiles. We cannot add or delete a 
profile. If we need a Create/Manage Profile permission, we can choose which 
permissions to permit under each profile name.

Managing CloudPortal™ Business Manager 2.0
[ 86 ]
The following table lists various profiles built into CPBM by Citrix:
Customer profile (predefined)
Service provider profile (predefined)
Root
Master User
Ops Admin, Finance Admin
Billing Admin
Sales Support, Help Desk
User
Product Manager
Power User
Perform the following steps for profile creation using CPBM:
1.	 Click on Root user on the top-right corner of the CPBM UI.
2.	 Choose Administration from the drop-down list.
3.	 Move to the Profiles dashboard and choose the Service Provider or 
Customer tab based on the profile that needs to be created.
4.	 We can see the default list of profiles on the left-hand side pane.
5.	 Select the checkboxes under Allow for the roles that you would like to set for 
the profile and click on Save.
Users who have already been assigned the profile will find that their 
permissions have changed.
Citrix CloudPortal Business Manager comes with a predefined set of profiles, and 
those profiles are built-in without the Modify option.
USER 1: Master, USER 2: User, USER 3: Billing Admin, USER 4: User, 
USER 5: Power User
Roles are certain common functions that are created with an objective to accomplish 
certain tasks. The following table lists the various roles in CPBM:
Role
Description
Account create
This role has the capacity to create, read, update, and delete 
any customer account.
Account manage
This role has the capacity to view and update information on 
any customer account.
User create manage
This role has the capacity to create, read, update, and delete a 
user belonging to any customer account. 

Chapter 6
[ 87 ]
Role
Description
Finance create manage
This role has the capacity to create, read, update, and delete 
financial information of any customer account (Account), for 
example, making payments or issuing credit. It depends on 
the Account create or Account manage roles.
Cloud manage
This role has the capacity to create, read, update, and delete 
resources via the Cloud Console.
Ops Comm
This role has the capacity to create, read, update, and delete 
updates that are published through the Cloud Health page.
Profile create manage
This role has the capacity to create, read, update, and delete 
profiles on the CloudPortal.
Config manage
This role has the capacity to view and update global 
configuration properties. 
Product create manage
This role has the capacity to create, read, update, and delete 
any product.
Support Ticket 
manage
This role has the capacity to manage support tickets. 
Salesforce should be enabled. 
Reports Admin view/
download/e-mail
This role has the capacity to view/generate reports.
Managing products
A product is any component that can be measured with an associated price; it 
requires one or more brokerage rules. Brokerage rules should match the accurate 
usage from the service to product. Product definitions are set by the service 
providers based on the norms they would like to use to segregate the pricing. 
Service providers must set a product price according to services or offerings.
Operations that can be performed while managing a product using CPBM are 
as follows:
•	
Adding a product
•	
Editing a product
•	
Retiring a product
•	
Adding a product to replace an existing one

Managing CloudPortal™ Business Manager 2.0
[ 88 ]
Adding a product
We can create a new product to target new resources or to replace a retired product. 
If it is a fresh product, it has to be created first.
Perform the following steps:
1.	 Log in to CPBM as the root user or ops admin.
2.	 Click on the Catalog tab and select Plan from the dropdown.
3.	 Click on the Add New button from the Products dashboard to add a product.
4.	 The Add Product wizard appears. Provide the details (Name, Code, Display 
Name, and Unit of Measurement).
5.	 Click on Next.
6.	 Select the usage types that will impact this product. Provide the conversion 
factor and choose the appropriate aggregation handler/operator (combine or 
exclude) for each and every usage type.
7.	 Click on the + sign to enter the next usage type. After providing the details, 
click on Next.
8.	 Enter the mediation rules for the usage type. The mediation rules will be 
applied on how usage needs are to be collected. Click on Next.
9.	 Enter the utility or product charges for the active currencies in the channel. 
Click on Next.
10.	 Review all the details that we provided and then click on Add.
11.	 Click on Finish.
Editing a product
To perform an edit of a product, perform the following steps:
1.	 Log in to CPBM as the root user or ops admin.
2.	 Click on the Catalog tab and select Plan from the dropdown.
3.	 We can view the products on the left-hand side pane. Select the product that 
needs to be modified.
4.	 We can view the details of the selected product on the right-hand side pane. 
Place your cursor over the gear wheel icon and click on Edit.
5.	 Verify the product details in every section in the Edit Product wizard. 
Update the details wherever applicable.
6.	 Click on Save after you have made all the changes.

Chapter 6
[ 89 ]
Retiring a product
We can either retire a product directly or can replace it with a new product. If we 
only want to retire the product, it will remain active in CPBM and charge the users 
based on the usage in the active subscriptions. If we want to retire an existing 
product and replace it with a new product, we have to ensure that we replace the 
existing product with the new product(s) as an entitlement in all the bundles. This 
replaced product will not be charged from the next plan of a channel catalog after 
it gets synced with the reference catalog, when this catalog appears in the future 
revision of the channel catalog.
Perform the following steps to retire a product:
1.	 Log in to CPBM as the root user or ops admin.
2.	 Click on the Catalog tab and select Plan from the dropdown.
3.	 We can view the products on the left-hand side pane. Select the product that 
you wish to retire.
4.	 We can see the details of the selected product on the right-hand side pane. 
Place your cursor over the gear wheel icon and click on Retire.
5.	 Select No if you wish to retire (or remove) the product in the Retire Product 
window. The product will not appear in the future reference catalogs.
Adding a product to replace an existing one
To add a new product in order to replace an existing one, the following steps need to 
be performed:
1.	 Log in to CPBM as the root user or ops admin.
2.	 Click on the Catalog tab and select Plan from the dropdown.
3.	 Click on the Add New button in the Products dashboard to add a product.
4.	 The Add Product wizard appears. Enter the required details (Name, Code, 
Display Name, and Unit of Measurement) to define the product.
5.	 Check the This product is replacing one or more products checkbox.
6.	 This product will appear in the current reference catalog. The product 
will appear in the channel catalogs once they are synced with the 
reference catalog.

Managing CloudPortal™ Business Manager 2.0
[ 90 ]
7.	 Click on Next and select the usage types that will impact this product. Enter 
the adaptation factor and choose the appropriate aggregation handling 
(combine or exclude) for every usage type. Click on the + sign to enter the 
next usage type. After entering the details for the next usage type, click on 
Next and enter the mediation rules for the usage type. The mediation rule 
will be applied on how usage needs to be collected. Then click on Next.
8.	 Enter the utility or product charges for the active currencies in the channel. 
Click on Next.
9.	 Review the details you entered. Click on Add if they are correct.
10.	 Finally, click on Finish.
Managing workflows
In CPBM (user action), a business transaction is a store where users can achieve 
a desired business goal; it has information about the planned change. A business 
transaction is started and activated from the point where a workflow can be inserted. 
A workflow is a multistaged approval and dashboard system. An activity is the 
tiniest part of work in a workflow. A phase is a logical set of activities, which need to 
be performed concurrently. Each workflow consists of one or more phases, and each 
phase has one or more activities. Each phase consists of activities that can be either 
manual or automated. The different states of an activity are given as follows:
•	
New: Activity is yet to begin
•	
In-Progress: Activity is running
•	
Waiting: User input is required
•	
Success: Activity has been successfully completed
•	
Failure: Activity was declined or rejected
•	
Error: There has been some unexpected behavior or exception that needs to 
be fixed
Every phase holds a set of activities that should be finished effectively. All phases 
should be finished to complete a business transaction; the following are the 
occurrences in which a task is shaped:
•	
InternalApprovalActivity: This activity creates a task for the users with a 
role mentioned in the property to approve or decline the business transaction
•	
CollectPaymentInfoActivity: This activity creates a task for a user having 
the ROLE_ACCOUNT_BILLING_ADMIN role probing for credit card info
•	
TenantOwnerApprovalActivity: This activity creates a task for users having 
the ROLE_ACCOUNT_ADMIN role to approve or decline the business transaction

Chapter 6
[ 91 ]
In CPBM, the following types of business transactions initiate a workflow:
•	
Tenant activation
•	
Account type conversion
•	
Subscription activation
•	
Payment information change
Different states of a workflow are given as follows and it are defined based on the 
status of activities:
•	
New: This indicates that the workflow is yet to be started
•	
Running: This indicates that there are pending activities in this workflow
•	
Completed: This indicates that the workflow was successful
•	
Error: This indicates that the workflow failed or is partially complete with an 
error message
In tenant activation, there are three default types of workflow: trial account 
activation, retail account activation, and corporate account activation.
Default activities for this workflow are listed as follows:
•	
For trial account activation: Verify the master user's e-mail
•	
For retail account activation: Verify the master user's e-mail and collect 
credit card info
•	
For corporate account activation: Receive approval from finance admin
In CPBM, there are various account type conversion workflows available, which are 
listed as follows:
•	
Any conversion to retail
•	
Any conversion to corporate
•	
Trial to corporate
•	
Retail to corporate
In order to enable subscription workflow on CPBM, perform the following steps:
1.	 In the CPBM main menu, click on Accounts.
2.	 Click on All Accounts.
3.	 Select an account from the left-hand side pane. We will be able to see the 
information of the account on the right-hand side pane.
4.	 Click on the gear wheel icon on the right-hand side pane.

Managing CloudPortal™ Business Manager 2.0
[ 92 ]
5.	 Select the View Billing History option from the dropdown.
6.	 The Usage and Billing dashboard appears. Click on Subscription.
7.	 The Workflow option is visible next to the Status field.
In order to view workflow status on CPBM, perform the following steps to enable 
the master user to view all tenant scope workflows:
1.	 In the CPBM main menu, click on Accounts.
2.	 Click on All Accounts.
3.	 Select an Account on the left-hand side pane. We will able to see the 
information of the account on the right-hand side pane.
4.	 Click on History tab on the right-hand side pane. We can view the workflows 
for this account.
5.	 Click on View under Workflow. We can see the status of the selected 
workflow in the Workflow Status window.
Managing accounts
In CPBM, Account Type reflects the payment deal that has been agreed upon by both 
parties on cloud usage. To add to this, the signup process varies in part depending 
on the account type.
To add to it, the system account should be a service provider and it can be 
customized during installation. CPBM offers three account types. They are 
listed as follows:
•	
Retail account: This account type is periodically billed to a credit card on file.
•	
Corporate account: These accounts are assigned to corporates with 
established credit. This account type requires additional processing 
and hence additional time to activate.
•	
Trial account: This is a trial account type.
In order to access the Account Types page, perform the following steps:
1.	 In CPBM, log in as the root user.
2.	 Navigate to Home | Accounts.
3.	 Select an account type to view and edit its properties.

Chapter 6
[ 93 ]
Managing billing
CPBM helps to track the resources utilized by cloud customers, calculate the 
amounts owned, handle invoicing, and manage payments for cloud customers 
automatically.
In billing, we will see the invoice types, payments, retail postpaid accounts, 
subscription handling, view payment activity, refunds, chargeback, and so on.
The following are the classified invoice types in CPBM:
•	
Subscription invoice: This is an invoice that will get produced any time a 
new subscription is created.
•	
Close-out invoice: This is an invoice that will get generated every day for 
each and every user; it contains a utilization report for the day. A master user 
or a user with billing admin role will be able to see all the close-out invoices 
for all the users in their own account(s).
•	
Renewal invoice: This is an invoice that will get produced whenever the 
renewal is outstanding for a subscription.
•	
Debit note: This is an invoice that will get produced only when there is 
imbursement setback or cancellation.
The following are the classified invoice states in CPBM:
•	
Posted: This shows that the invoice has been produced and sent to the 
account and the invoice will be exhibited in the account report.
•	
Provisional: This shows that the invoice has been produced for a user but it 
will be exhibited in the account statement based on the subscription grade.
The following are the classified invoice types in CPBM, and the imbursement is 
collected through an authorized payment doorway:
•	
Auto-payment: This payment is collected either through an authorized 
payment gateway, such as authorize.net or credit card details provided 
by the cloud customer.
•	
Manual payment: This payment is made manually by the cloud consumer 
with a card.
•	
Record payment: This payment is made through checks. These payments 
are recorded and parallel invoices are marked as paid by the cloud 
service provider.

Managing CloudPortal™ Business Manager 2.0
[ 94 ]
•	
Notional payment: This payment can be made any time. To do so, the 
account should be active and we need to ensure that account statements 
are updated.
•	
Issue credit: Pay as you go with an available credit limit.
Retail postpaid accounts
The upcoming categories of items are charged to the customer's credit card at the end 
of every billing cycle.
•	
Full subscription: This is all about the renewal fee for the upcoming 
billing period.
•	
Resource usage: This is all about the present billing period over and above 
the amount included in the customer's subscription plan.
•	
Any annual: This is all about fee renewals where the anniversary date of the 
original subscription fell within the present billing period.
•	
Prorated periodic: This is all about the fees for subscriptions that were 
started in the middle of the present billing period.
•	
Other options are One-time setup fee and Annual fee.
CPBM subscription handling
The following steps give an overview of how billing is handled for product bundle 
subscriptions in retail postpaid accounts:
1.	 The root user logs in to CPBM and clicks on Catalog.
2.	 The root user chooses a product bundle and goes through the 
Subscription wizard.
3.	 If the subscription has a monthly fee, it is prorated for the present month.
4.	 CPBM begins tracking the customer's usage of the entitlements in the 
subscription. Any usage discussed previously involves an amount, which in 
turn results in additional charges being added to the customer's total for the 
present billing period.
5.	 An invoice is produced on the renewal date and the credit card on the file is 
billed for the total amount used.
6.	 These steps are repeated to add more subscriptions and collect payments for 
each and every client.
7.	 At any time, the customer or a representative at the service provider can 
cancel one of the cloud customer's subscriptions.

Chapter 6
[ 95 ]
The master users and billing admin users of a cloud customer account can see the 
account's payment activity. Perform the following steps to view the payment activity:
1.	 Click on Accounts, navigate to Usage & Billing, and then navigate to 
Payment Activity.
2.	 Things we can do in this wizard are as follows:
°°
View the list of invoices and payments.
°°
Issue a chargeback to refund money to the customer's credit card. 
Select a payment in the list and click on Issue Charge Back.
The master user and billing admin user of a cloud customer account can modify their 
payment systems. If we have the Finance Create/Manage permission, we can modify 
a customer's payment details. Credit card details can be set as follows.
1.	 Click on Accounts and then navigate to Usage & Billing.
2.	 Navigate to Payment Info and then click on Edit.
3.	 Provide the required information and then click on Save.
Refunding options on CPBM are quite possible; if we have the Finance Create/
Manage permission, we can make a refund and find ways of giving money back 
to customers via credits and chargebacks.
A credit adds funds to the customer's balance in CPBM. Any future charges incurred 
by the customer will be paid for first out of this credit balance. To do so, perform the 
following steps:
1.	 Click on Accounts.
2.	 Select All Accounts.
3.	 Select the appropriate customer. The customer's details appear, including the 
current positive balance (credit).
4.	 Click on Issue Credit.
A chargeback returns funds through the customer's credit card at the request of the 
bank that issued the card. The chargeback is processed through the same payment 
gateway that is used for routine invoice payments. To use chargeback for getting the 
money refunded, perform the following steps:
1.	 Click on Accounts.
2.	 Click on Usage & Billing.
3.	 Click on Payment Activity.
4.	 Select the disputed payment and click on Issue Charge Back.

Managing CloudPortal™ Business Manager 2.0
[ 96 ]
Summary
In this chapter, we learned about managing CPBM profiles, CPBM products, CPBM 
workflows, CPBM accounts, CPBM billings, and their fundamental essentials. In the 
next chapter we will get to know about operating CPBM 2.0.

Operating CloudPortal™ 
Business Manager 2.0
In Chapter 6, Managing CloudPortal™ Business Manager 2.0, you will have learned 
about of managing the CPBM essentials. Now let us learn about and explore the 
various operations of CPBM.
In this chapter we will learn about the following:
•	
Job scheduling
•	
Notifications and health
•	
CRM and reports
Job scheduling
On the cloud arena, running of jobs essentially needs to be automated. Jobs are 
system-generated tasks that have to be run in a given time period to accomplish 
certain actions such as billing. Now let's look at various CPBM jobs provided by 
Citrix Systems.
•	
Daily_Billing_Job
•	
Trial_Expiry
•	
Consistency_Checker_Job
•	
Cloud_Service_Event_Processing
•	
Workflow_Job
•	
Subscription_Validation_Job

Operating CloudPortal™ Business Manager 2.0
[ 98 ]
To configure jobs on CPBM, perform the following steps:
1.	 Log in to CPBM as the root user or Ops Admin.
2.	 Select the configuration.
3.	 Choose Portal.
4.	 Then choose Jobs.
The difference between the previous versions of CPBM and CPBM 2.0 is the billing 
subprocess. In CPBM 2.0, all the billing processing is done by DailyBillingJob. 
This job is, by default, scheduled to run at 1 A.M. server time. The following are the 
two subprocesses scheduled in the main job:
•	
Scanning through all the service instances and fetching their usage data for 
the previous day. This data is converted into useful information which CPBM 
can understand and maintains.
•	
Scanning through all the tenants, picking up the information from the 
previous sub process, and using it to update/post account statements and 
make payments.
Both of these sub processes are transactional; as in, if any of the service instances 
should fail during the reporting of daily usage, it is skipped and the next service 
instance is requested for its usage data.
CPBM uses numerous batch jobs to perform its regular routine processes, such as 
tracking practice and generating invoices. Jobs are planned to be run at a specified 
time and recur at a set interval. In CPBM, batch jobs are deployed using JavaBeans 
and delivered using the Spring platform. In order to view the grade of the batch jobs 
that are currently running, or have been run in the past, we can use the CPBM UI. 
The batch jobs are present in two XML files in the CPBM installation path:
•	
XML Format 1: applicationContext-jobs.xml
•	
XML Format 2: applicationContext-scheduler.xml
Batch jobs are planned using cron-like time expression syntax in XML.
To configure a batch on CPBM, perform the following steps:
1.	 Navigate to \usr\share\cloud\portal\webapps\admin\WEB-INF\lib\ 
and copy the vmops.admin-1.0-SNAPSHOT.jar file to the \tmp directory.
2.	 Unzip the JAR file, vmops.admin-1.0-SNAPSHOT.jar, and copy it over to 
applicationContext-jobs.xml and applicationContext-scheduler.xml.

Chapter 7
[ 99 ]
3.	 Modify the applicationContext-jobs.xml file under cloud-portal\
vmops.admin\src\main\resources\META-INF\spring\, and modify the 
XML elements for each and every job that we want to work with.
4.	 Now let us look at the Job Scheduling syntax in applicationContext-jobs.
xml.
5.	 Edit the applicationContext-scheduler.xml file under cloud-portal\
vmops.admin\src\main\resources\META-INF\spring\ and ensure that 
every trigger ID distinct in applicationContext-jobs.xml is listed in the 
triggers property of the org.springframework.scheduling.quartz.
SchedulerFactoryBean bean element. If we need more help, we can have 
a look into the Job Scheduling Syntax in applicationContext-scheduler.
xml.
6.	 Copy these files to \usr\share\cloud\portal\webapps\admin\WEB-INF\
classes\.
After editing the files, the CPBM server needs to be restarted for 
the changes to take place.
Notifications and health
CPBM provides a monitoring technique with a variety of notifications for both 
the regular routine events and the known services alerts that require monitoring 
in place.
The CPBM notifications are visible in the CPBM portal; alerts are triggered as per the 
e-mail addresses provided in the CPBM portal. Since this is a "getting started" book, 
explaining each and every notification is beyond the scope of this book.
The CPBM notification sources come in the following two different formats:
•	
CPBM events and alerts for creation of a new account
•	
Citrix CloudStack events and alerts are triggered
In order to configure the notification, perform the following steps:
1.	 Log in to CPBM with administrative privileges.
2.	 Choose Root User on the CPBM UI.
3.	 Choose Administration from the pop-up list.
4.	 Scroll using < or > in the tab and choose Server.

Operating CloudPortal™ Business Manager 2.0
[ 100 ]
5.	 Click on Notifications and navigate to Configure.
6.	 And now an Edit window pops up. Click on Edit.
7.	 Update the required Notification to field and click on Save.
Now let's explore a little about service health. Service health is all about exploring 
the status of our portal that can be outlined in a total rating termed as health. Health 
status is fixed manually. It is visible to cloud customer users; service health is a quick 
way to personalize a notification.
In order to view a notification, perform the following steps:
1.	 Log in to CPBM with administrative privileges.
2.	 Choose Root User. Click on the Support tab and navigate to Status.
3.	 Our Service Health screen is shown.
4.	 Click on Add Status to add a status.
5.	 (Optional) We can also add a scheduled maintenance.
6.	 Click on Service Health and navigate to the Maintenance tab.
CRM and reports
CPBM provides CRM features to aid in the management of cloud consumer 
associations. We can adopt the identity of any cloud consumer and they can have 
a look at the same CPBM UI, but it needs to be conditioned to the CRM system's 
master operator. It will be useful to track the cloud customer's utilization in real time 
to compare the prices accumulated till date with the budget perimeters set by the 
cloud customer. CPBM CRM has the ability to, in effect, log in as the cloud customer, 
which is very beneficial for performing actions on the cloud customer's behalf.
CPBM is unified with http://www.salesforce.com for the very purpose of ticket-
logging for support requests (CRM trouble and service tickets) by cloud customers. 
We can have a look at the created, existing tickets and we can also submit tickets, 
which are later stockpiled in Salesforce CRM.
In order to create a trouble ticket, we need either an Account Create / Account 
Manage permission, along with a Trouble Ticket Manage permission; we can raise 
a trouble ticket on behalf of a cloud customer user. In order to do so, we need to 
perform the following steps:
1.	 Log in to CPBM with the cloud user privilege.
2.	 Click on Accounts.
3.	 On the Tickets area of the CPBM dashboard, click on Submit Ticket.

Chapter 7
[ 101 ]
4.	 Click on Add New Ticket.
5.	 Provide values for Subject and Description.
6.	 Click on Submit.
Now let's look at how we can view a ticket. We require the Account Manage 
permission for CPBM and need to perform the following steps:
1.	 Log in to CPBM with a cloud user privilege.
2.	 Click on Accounts.
3.	 On the drop-down list, select the name of the cloud customer we want to 
work with.
4.	 The following objects to need be configured on the wizard:
1.	 A VM for cloud customers.
2.	 Choose Usage & Billing to view the resources expended by a cloud 
customer during the billing period.
3.	 Choose Resources to manage a cloud customer's infrastructure.
4.	 Choose Submit Ticket to create a trouble ticket for a cloud customer.
5.	 Choose View All Tickets to see all the concerns filed by a cloud 
customer.
6.	 Choose Users to add, deactivate, change, and remove cloud 
customer's users and more operations associated with users.
7.	 Choose Alerts to set a maximum budget for a cloud customer to 
view or create alerts.
8.	 Click on Notifications to see the notifications from CPBM and Citrix 
Cloud Platform that are visible to the selected cloud customer.
Finally, let's look at how to close a created ticket. To do so, we require a cloud 
customer user who produced a ticket, the cloud Master User of the account under 
whom the ticket was created, or any cloud user with the Trouble Ticket Manage 
permission, to close a created ticket. We have the following two options:
1.	 Using the CPBM menu bar:
1.	 Click on Support.
2.	 Then click on the Tickets tab.
2.	 Alternatively, via the CPBM cloud customer's dashboard:
1.	 Click on Accounts.
2.	 In the Tickets screen of the dashboard, click on View All Tickets.

Operating CloudPortal™ Business Manager 2.0
[ 102 ]
Once we are in the Tickets screen, perform the following steps:
1.	 Choose the ticket that you want to work with. Information about that ticket 
appears below in the CPBM screen.
2.	 Choose the ticket and close it.
With this, we have learned about working with a ticket. Now let us explore CPBM 
reporting. Reports supply a graphical summary of a cloud service. A report can be 
exported in a diversity of formats, including PNG, JPEG, PDF, or SVG vectors. To 
view our reports, we need to navigate to the Reports tab in the CPBM main menu. 
The following table illustrates the different types of reports in CPBM:
Report
Description 
New Registrations
Helps to create a new report
Top Customers
Helps to create a report for a top customer for a specific month 
and year
Product Usage
Helps to create a report to view product usage for a specific 
month and year
Bundle Usage
Helps to create a report to view monthly usage by product 
bundle for a particular month and year
Custom Reports
Helps to create a custom report by choosing on the popped up 
list and selecting Generate
Custom reports
The first installation of CPBM provides a set of prebuilt reports. With the aid of 
CPBM Professional Services, we can also insert custom reports to meet our precise 
reporting requests. Custom reports are fully generated as unplanned reports via 
CPBM where we can accept effort parameters. In order to configure the report 
settings, perform the following steps:
1.	 Log in to CPBM as a root user.
2.	 Choose Root user on the CPBM UI.
3.	 Choose Administration from the popped up list.
4.	 Scroll using < or > and choose Reports.

Chapter 7
[ 103 ]
Export option configuration:
1.	 Click on Exports and navigate to Configure.
2.	 In the Edit window, click on Edit.
3.	 Provide a value for registrations.reportpath.
4.	 Click on Save.
Mediation option configuration:
1.	 Click on Mediation and navigate to Configure.
2.	 In the Edit window, click on Edit.
3.	 Provide the value for aggregation.category.
4.	 Click on Save.
Notifications option configuration:
1.	 Click on Notifications and navigate to Configure.
2.	 In the Edit window, click on Edit.
3.	 Provide the value for reports.email.
4.	 Click on Save.
Summary
In this chapter, we learned about operating the Citrix CPBM with scheduling jobs, 
batch management, setting notifications, operating health checks, and system 
support—CRM reporting. With the knowledge gained in this book, you should now 
be confident enough to work on CPBM and CPSM. Thanks for reading this book.


CCP Connections
CPBM is developed based on the Java OSGi framework model for pluggable 
components. Service connectors are developed by DIY. DIY is a Citrix ISV partner 
and CCP is the abbreviation of Connector Citrix Portal. The objective of CCP is to 
act like a bridge between service terminals and CPBM, and provide any service as a 
catalog of instances. CCP is an independent product from CPBM; lifecycles can be 
managed separately. In order to deploy and use CCP, all developers should be aware 
of high-level essentials, which are as follows:
•	
CloudService on-boarding and merchandizing
•	
CloudService provisioning
•	
CloudService UX
•	
CloudService usage and billing
A Cloud Service Connector will provide the following information:
•	
Metadata
•	
SPI implementation
•	
Resource Files

CCP Connections
[ 106 ]
The following are the key terms used in CCP:
•	
Instances: Virtual Machines are called instances on the Citrix Cloud Portal
•	
Volumes: Storage allocated to physical and virtual machines
•	
Snapshot: A representation of a virtual machine configuration when the 
snapshot is taken
•	
IP Address: The unique ID assigned for your service provider
•	
Network Name: The network name, zone, and VLAN
•	
Security Group: The default security group offered by your service provider
•	
Adding a user: Creating a user and managing permissions
•	
Modifying a user: User create/manage permissions
•	
Editing our company setup: Changing the company address
•	
Edit user profile: Editing your personal profile and storing details
•	
View API IDs: Custom API that can be viewed under API credentials

Index
A
Access and Authorization  11
account create role  86
account manage role  86
Account on boarding and management  9
accounts
managing  92
accounts, types
corporate account  92
retail account  92
trial account  92
account type conversion workflows  91
Active Directory (AD) schema  24
Active Directory Location Services  15
activity
about  90
CollectPaymentInfoActivity  90
InternalApprovalActivity  90
stages  90
TenantOwnerApprovalActivity  90
activity, stages
error  90
failure  90
in-progress  90
new  90
success  90
waiting  90
AD LDAP
configuring, for CPSM  82, 83
any annual, retail postpaid accounts  94
Anything-as-a-Service (XaaS)  7, 73
App Hub
importing, from Citrix farm to server 
collection  47
auto-payment  93
B
batch jobs
about  98
configuring, on CPBM  98, 99
billing
CPBM subscription handling  94
managing  93, 94
bundle usage report  102
business transaction
about  90
types  91
C
CAS authentication
enabling  78, 79
Catalog Management  12
CCP
about  105
API IDs, viewing  106
company setup, editing  106
instances  106
IP address  106
network name  106
security group  106
Snapshot  106
user, adding  106
user, modifying  106
user profile, editing  106
volumes  106
chargeback  95
Citrix® CloudPortal™
about  6
CloudPortal™ Business Manager (CPBM)  6

[ 108 ]
CloudPortal™ Services Manager (CPSM)
features  7-9
Citrix® CloudPortal™, architecture
CPBM, working  10013
CPSM licensing  15
CPSM, working  13
Citrix® CloudPortal™ Business Manager. 
See  CPBM
Citrix® CloudPortal™ Services Manager. See  
CPSM
Citrix® farm
Citrix® web services, deploying on server  
44
Citrix® Service deployment
about  43
on CPSM 11.0  43
Citrix Systems®
for CPSM, features  9, 10
Citrix® web services
App Hub importing from Citrix® farm, to 
server collection  47
deploying, on server in Citrix® farm  44
Service Configuration, control panel used  
45-47
service, provisioning to customers  48
service, provisioning to resellers  48
CLI. See  command line
clients
VM web service, provisioning  58
close-out invoice  93
cloud computing  5
cloud consumers
creating  63
cloud manage role  87
CloudPlatform  80, 81
CloudPortal™ Business Manager. See  CPBM
CloudPortal™ Services Manager. See  CPSM
Cloud services and IaaS automation  10
Cloud Services Delivery Platform  7
CollectPaymentInfoActivity  90
command line
about  34
used, for configuring CPSM  35
used, for installing CPSM  34
completed workflow  91
computing as a service  5
config manage role  87
configuration, CPSM
command line used  35
GUI used  28
Connector Citrix Portal. See  CCP
Control panel  15
Copy operations
performing  67
corporate account  92
Cortex  34
CortexAPI  19
Cortex Management Site  19
CortexMgmt Application Pool  19
CPBM
about  6, 73, 105
batch jobs, configuring  98, 99
business transactions  91
configuring  76, 77
downloading, from Citrix  74
export option, configuration  103
features, by Citrix Systems  7-9
installation  73-76
installation sources, URL  74
integration, with CloudPlatform  80, 81
invoice types  93
jobs, configuring  98
mediation option, configuration  103
notifications  99
notifications option, configuration  103
profiles  85, 86
reports  102
report settings, configuring  102
restarting  83
starting  83
stopping  83
working  10, 11
CPBM Server
requisites  20
CPSM
about  5, 6, 24
AD LDAP, configuring for  82, 83
components, Data Warehouse requirements  
19
components, Directory Web server 
requirements  18
components, requisites  16
components, SQL Server Reporting Services  
19

[ 109 ]
components, system requirements  16, 17
configuring, command line used  35
configuring, GUI used  28
core components, verifying  23, 24
deployment, planning  21
installing, command line used  34
installing, GUI used  27
primary location, configuring  33, 34
remote location, configuring  34
terminologies  15, 16
working  13
CPSM 11.0
Citrix Service deployment  43
CPSM components, requisites
Active Directory and Exchange 
requirements  16
Database server requirements  16
Data Warehouse requirements  19
Directory Web server requirements  18
Provisioning server requirements  17
SQL Server Reporting Services require­
ments  19
Web server requirements  18
CPSM, deployment
about  21
Customer and user provisioning phase  21
essentials, verifying  23
Service deployment phase  21
Service manager deployment phase  21
CPSM service
deploying  41-43
credit  95
CRM
and reports  100-102
Cross-site request forgery (CSRF)  82
customer
creation  64
creation, CPSM used  63
Customer administrator  15
Customer and user provisioning phase  21
customer creation  64
Customer plan  15
customer profile
Ops Admin, Finance Admin  86
Product Manager  86
root  86
Sales Support, Help Desk  86
Customer self-service and delegated control  
9
custom reports  102
D
Dashboards, metering and billing  9
database objects
configuring  36
data transfer notifications
configuring  31
data warehouse service
configuring  32
debit note invoice  93
directory monitoring services
configuring  29
Directory Web Service
configuring  28
DIY  105
E
Enterprise ready  9
error activity  90
error workflow  91
Exchange-hosted web services
configuring  50-53
installing  49, 50
provisioning, to consumers  53
export option
configuration  103
Extensible and open architecture  9
F
failure activity  90
finance create manage role  87
For corporate account activation  91
For retail account activation  91
For trial account activation  91
full subscription, retail postpaid accounts  
94
G
group approval chains  70
GUI
used, for configuring CPSM  28
used, for installing CPSM  27

[ 110 ]
H
Helpdesk Support  11
hybrid cloud solutions
URL  13
I
Infrastructure as a Service (IaaS)  6
in-progress activity  90
installation
CPBM  73-76
MySQL DB  74, 75
installation, CPSM
command line used  34
GUI used  27
instances  106
InternalApprovalActivity  90
invoice states, CPBM
posted  93
provisional   93
invoice types, CPBM
about  93
auto-payment  93
close-out invoice  93
debit note invoice  93
issue credit  94
manual payment  93
notional payment  94
record payment  93
renewal invoice  93
subscription invoice  93
IP address  106
issue credit  94
J
jobs
batch jobs  98
configuring, on CPBM  98
scheduling  97
subprocesses  98
L
licensing reporting
configuring  30
Location  15
Login URL parameter  78
M
mail server
configuring  29-31
manager approval chains  70
manual payment  93
meditation option
configuration  103
Metering Management  12
MySQL DB
installing, steps  74, 75
N
network name  106
new activity  90
new registration report  102
new workflow  91
notifications
configuring  99, 100
viewing  100
notifications option
configuration  103
notional payment  94
O
Office Communications Server (OCS)  67
OLM  17
OLMReporting  17
OLMReports  17
Onboard Account  14
Open by design  8
ops column role  87
P
phase  90
Platform as a Service (PaaS)  6
Pricing, metering and billing  8
primary location
configuring  33, 34, 37
product create manage role  87
products
about  87

[ 111 ]
adding  88
adding, to replace existing one  89, 90
editing  88
retiring  89
product usage report  102
profile create manage role  87
profiles
about  85
creating, CPBM used  86
customer profile  86
Service provider profile  86
prorated periodic, retail postpaid accounts  
94
Provisioning  15
Provisioning Directory Web Service
about  27
configuring  36
Provisioning Services  14
Q
Qualify Self Services  14
queue monitoring services
configuring  29
R
record payment  93
remote location
configuring  34, 37
renewal invoice  93
reporting database
configuring  31
reporting DB
configuring  30
reporting object
configuring  38
reporting options
configuring  37
reporting services
configuring  32
report mailer object
configuring  38
reports
about  102
and CRM  100, 101
in CPBM  102
managing  70, 71
Reports Admin view/download/e-mail role  
87
reports, CPBM
bundle usage report  102
custom reports  102
new registration report  102
product usage report  102
top customers report  102
report settings
configuration  102
Resellers option  64
resource usage, retail postpaid accounts  94
retail account  92
retail postpaid accounts
about  94
annual fee  94
any annual  94
full subscription  94
One-time setup fee  94
prorated periodic  94
resource usage  94
roles
about  86
account create role  86
account manage role  86
cloud manage role  87
config manage role  87
finance create manage role  87
ops column role  87
product create manage role  87
profile create manage role  87
Reports Admin view/download/e-mail 
role  87
support ticket manage role  87
user create manage role  86
running workflow  91
S
security group  106
security role  68
Self Service Fulfillment  11
Self-service IT  8
server
VM web service, deploying  54
Service Catalog  11

[ 112 ]
Service Configuration
VM service used  55-57
Service deployment phase  21
Service manager deployment phase  21
service package import
configuring  31, 32
service packages
exporting  59, 60
Service provider administrator  15
Service provider profile
Billing Admin  86
Master User  86
Power User  86
Service URL parameter  78
Snapshot  106
Software as a Service (SaaS)  6
SQL Server
deploying  25-27
SQL Server Management Object  19
SQL Server Reporting Services
deploying  25-27
subscription
handling  94
subscription invoice  93
success activity  90
support ticket manage role  87
T
TenantOwnerApprovalActivity  90
ticket
closing  101
viewing  101
top customers report  102
Top Environment Services  15
trial account  92
U
Usage and Billing  14
user create manage role  86
User Management  12
User plan  16
users
creating, steps for  64-66
V
Validation URL parameter  78
VM web service
deploying, on server  54
provisioning, to clients  58, 59
used, for Service Configuration  55-57
volumes  106
W
waiting activity  90
web server
configuring  32
Web service  16
workflow
account type conversion workflows  91
business transactions  91
default activities  91
managing  90
states  91
status, viewing  92
subscription workflow, enabling  91
types  91
workflow, default activities
error  91
For corporate account activation  91
For retail account activation  91
For trial account activation  91
Workflow Management  12
workflow operation
enabling  69
workflow, states
completed  91
error  91
new  91
running  91


Thank you for buying 
Getting Started with Citrix® CloudPortal™
About Packt Publishing
Packt, pronounced 'packed', published its first book "Mastering phpMyAdmin for Effective 
MySQL Management" in April 2004 and subsequently continued to specialize in publishing 
highly focused books on specific technologies and solutions.
Our books and publications share the experiences of your fellow IT professionals in adapting 
and customizing today's systems, applications, and frameworks. Our solution based books give 
you the knowledge and power to customize the software and technologies you're using to get 
the job done. Packt books are more specific and less general than the IT books you have seen in 
the past. Our unique business model allows us to bring you more focused information, giving 
you more of what you need to know, and less of what you don't.
Packt is a modern, yet unique publishing company, which focuses on producing quality, 
cutting-edge books for communities of developers, administrators, and newbies alike. For more 
information, please visit our website: www.packtpub.com.
About Packt Enterprise
In 2010, Packt launched two new brands, Packt Enterprise and Packt Open Source, in order to 
continue its focus on specialization. This book is part of the Packt Enterprise brand, home to 
books published on enterprise software – software created by major vendors, including (but 
not limited to) IBM, Microsoft and Oracle, often for use in other corporations. Its titles will offer 
information relevant to a range of users of this software, including administrators, developers, 
architects, and end users.
Writing for Packt
We welcome all inquiries from people who are interested in authoring. Book proposals should 
be sent to author@packtpub.com. If your book idea is still at an early stage and you would like 
to discuss it first before writing a formal book proposal, contact us; one of our commissioning 
editors will get in touch with you. 
We're not just looking for published authors; if you have strong technical skills but no writing 
experience, our experienced editors can help you develop a writing career, or simply get some 
additional reward for your expertise.

Implementing Citrix XenServer 
Quickstarter
ISBN: 978-1-84968-982-3             Paperback: 134 pages
A practical guide to getting started with the Citrix 
XenServer Virtualization technology with easy-to-
follow instructions
1.	
A simple and quick start guide for any system 
admin who wants to step into the latest and 
hottest virtualization technology
2.	
Learn how to convert physical machines to 
virtual ones using XenConvert
3.	
Get to grips with the advanced features of 
Citrix XenServer
Instant Citrix Security How-to
ISBN: 978-1-84968-672-3             Paperback: 74 pages
A guide to bulletproofing your enterprise 
environment with the excellent security features 
in Citrix
1.	
Learn something new in an Instant! A short, 
fast, focused guide delivering immediate 
results.
2.	
Simple and detailed security implementations 
for your existing or brand new Citrix 
deployments
3.	
Solutions to your network environment 
problems
Please check www.PacktPub.com for information on our titles

Citrix XenDesktop 5.6 Cookbook
ISBN: 978-1-84968-504-7             Paperback: 354 pages
Implement a fully featured XenDesktop 5.6 
architecture in a rich and powerful VDI experience 
configuration
1.	
Real-world methodologies and functioning 
explanations about the XenDesktop 5.6 
architecture and its satellite components used to 
perform a service-oriented architecture
2.	
Learn how to publish desktops and applications 
to end user devices, optimizing their 
performance and increasing the general security
3.	
Step-by-step guide on how to install and 
configure the XenDesktop 5.6 architecture to 
access and use the published virtual resources
Instant Citrix XenApp
ISBN: 978-1-78217-026-6            Paperback: 50  pages
A short guide for administrators to get the most out 
of the Citrix XenApp 6.5 server farm
1.	
Learn something new in an Instant! A short, 
fast, focused guide delivering immediate 
results
2.	
Plan, deploy, and manage a XenApp farm
3.	
Learn how to manage resources in the 
farm through the use of graphical tools and 
PowerShell


Please check www.PacktPub.com for information on our titles

