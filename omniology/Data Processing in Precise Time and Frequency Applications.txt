www.ebook3000.com

Data and Knowledge in a Changing World
Scientific Publication Committee
Chair:
Past Chair:
Members:
Jacques Octave Dubois (France)
Heinrich Behrens (Germany)
Jean Garnier (France)
Krishan Lal (India)
Paul Mezey (Canada)
Vladimir Yungman (Russia)
CODATA Secretariat
Executive Director: K. Cass
51, Boulevard de Montmorency
75016 Paris, France
E-mail: codata@dial.oleane.com
http://www.codata.org

M. Desaintfuscien
Data Processing in Precise Time
and Frequency Applications
With 66 Figures and 15 Tables
123
www.ebook3000.com

CODATA Secretariat
K. Cass, Exec. Director
51, Boulevard de Montmorency
75016 Paris, France
Author:
Michel Desaintfuscien
21, Domaine de Montvoisin
91400 Gometz la Ville, France
The image on the front cover comes from an animation which shows worldwide Internet trafﬁc. The
color and height of the arcs between the countries encode the data-packet counts and destinations, while
the “skyscraper” glyphs (or icons) encode total trafﬁc volume at any site. This image was generated by
Stephen G. Eick at the AT&T Bell Laboratories.
Library of Congress Control Number: 2006936074
ISBN 978-3-540-48877-4 Springer Berlin Heidelberg New York
This work is subject to copyright. All rights reserved, whether the whole or part of the material is
concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation, broad-
casting, reproduction on microﬁlm or in any other way, and storage in data banks. Duplication of
this publication or parts thereof is permitted only under the provisions of the German Copyright Law
of September 9, 1965, in its current version, and permission for use must always be obtained from
Springer. Violations are liable for prosecution under the German Copyright Law.
Springer is a part of Springer Science+Business Media
springer.com
© Springer-Verlag Berlin Heidelberg 2007
The use of general descriptive names, registered names, trademarks, etc. in this publication does not
imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
Product liability: The publishers cannot guarantee the accuracy of any information about dosage and
application contained in this book. In every individual case the user must check such information by
consulting the relevant literature.
Typesetting and production: LE-TEX Jelonek, Schmidt & Vöckler GbR, Leipzig
Cover design: eStudio Calamar, Spain
Printed on acid-free paper
52/3100/YL - 5 4 3 2 1 0

to my mother
www.ebook3000.com

Introduction to the Series
CODATA is an interdisciplinary Scientiﬁc Committee of the International
Council for Science (ICSU). The mission of CODATA is to strengthen inter-
national science for the beneﬁt of society by promoting improved scientiﬁc
and technical data management and use. It works to improve the quality,
reliability, management and accessibility of data of importance to all ﬁelds of
science and technology. CODATA is a resource that provides scientists and
engineers with access to international data activities for increased awareness,
direct cooperation and new knowledge. CODATA, established over 40 years
ago by ICSU, promotes and encourages on a world-wide basis the compila-
tion, evaluation and dissemination of reliable numerical data of importance
to science and technology. This includes data initiatives and modeling of
an interdisciplinary nature such as that encountered in far-reaching projects
e.g. Global Change, various Genome projects, environmental and biodiver-
sity issues, etc. Today 23 countries are members, 15 International Scientiﬁc
Unions have assigned liaison delegates, there are 4 co-opted delegates and 20
supporting organizations from industry, government and academia.
CODATA is concerned with all types of data resulting from experimen-
tal measurements, observations and calculations in every ﬁeld of science and
technology, including the physical sciences, biology, geology, astronomy, en-
gineering, environmental science, ecology and others. Particular emphasis is
given to data management problems common to diﬀerent disciplines and to
data used outside the ﬁeld in which they were generated.
CODATA’s primary purpose in launching the series “Data and Knowl-
edge in a changing World” is to collect data and the wealth of information
pertaining to the intelligent exploitation of data in the conduct of science
and technology and to make these data and information available to a multi-
disciplinary community. This series in support of that goal provides a forum
made up of many contributions which can be theoretical treatments, com-
pilations or applied outlines. This includes computer related handling and
visualization of data to the major scientiﬁc and technical ﬁelds.
To this end, the series on Data and Knowledge is open to contributions
of various kinds, in particular:
•
Fostering the improvement of the accessibility and quality of quantitative
and qualitative data;

VIII
Introduction to the Series
•
Treating classical and ground breaking methods by which numeric and
symbolic data are acquired, analyzed and managed;
•
Presenting new data and knowledge interfaces designed to optimize in-
teroperability and thereby increase the potential for sharing data among
databases and networks;
•
Promoting international cooperation in communication and data sharing.
This includes works dealing with standardization, data quality agreements
and conceptual data descriptions (metadata, syntactic and semantic ap-
proaches) along with papers dealing with the evolution of internet based
facilities, other forms of worldwide communications and electronic pub-
lishing;
•
Providing new insights into, or interpretations of, processes leading to
creative design in the ﬁeld of concurrent and/or cooperative engineering,
including cognitive aspects critical to data based decision making.
In the evolving information world we live in, where the traditional ways of
transferring information as an essential resource are rapidly changing, this
Series aims to identify emerging and innovative concepts for data compilation,
handling, management, and evaluation. Its ambition is to be a catalyst for
change while simultaneously nurturing a thought-provoking forum.
www.ebook3000.com

Foreword
The main originality of this book lies in its presentation of an in-depth de-
scription of the metrological characterization of very stable frequency sources,
such as atomic clocks, as well as the analysis of the principle of their most de-
manding applications, such as navigation, positioning and very long baseline
interferometry.
All these cited ﬁelds of interest rely on the measurement of time intervals
that necessarily give numerical data: one counts the number of time units
occuring between the beginning and the end of an event. Consequently, the
analysis of the metrological characterization of stable frequency sources and
of the operation of the related scientiﬁc and technical applications rely on the
treatment of numerical data that can be aﬀected by random and systematic
perturbations.
The author presents a rigourous, detailed and uniﬁed analysis of the spe-
ciﬁc signal processing of numerical data arising in that ﬁeld. Although the
subject might seem to be diﬃcult at ﬁrst sight, the pedagogical talents of Pro-
fessor Desaintfuscien helps one to easily follow the mathematical derivations
and the discussion of their results.
Therefore, this book appears as a reference document for all the scientists
and engineers involved in the design or daily use of the related equipment.
Claude Audoin
Paris, January 2007
Directeur de recherche émérite,
Silver Medal (French National Research Center),
Rabi Award (Scientiﬁc Committee Annual Frequency Control Symposium)

Contents
1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
1
Part I Very High Performances Oscillators
2
The Two Parts of an Oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2.1
Electrical Resonances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2.2
Mechanical Resonances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2.3
Atomic Frequency Standards . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.3.1
Active Atomic Frequency Standards . . . . . . . . . . . . . . . .
16
2.3.2
Passive Atomic Frequency Standard . . . . . . . . . . . . . . . .
16
2.3.3
Optically Pumped Cesium Beam . . . . . . . . . . . . . . . . . . .
18
2.3.4
Active Hydrogen Maser . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
2.3.5
The Atomic Fountain . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
30
3
Control of the Local Oscillator Frequency. . . . . . . . . . . . . . . . .
33
3.1
Active Frequency Standard . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
33
3.1.1
The Phase Control Loop . . . . . . . . . . . . . . . . . . . . . . . . . .
34
3.1.2
Gain for the Frequency Noise of the Local Oscillator . .
36
3.1.3
Gain for the Frequency Noise of the Atomic Signal . . .
37
3.1.4
Phase Noise of the Output. . . . . . . . . . . . . . . . . . . . . . . . .
38
3.1.5
Frequency Error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
3.1.6
The Best Choices. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
3.2
Passive Frequency Standard . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
41
3.2.1
Frequency Response for the Frequency Noise
of the Local Oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . .
43
3.2.2
Frequency Response for the Frequency Noise
of the Atomic Resonance . . . . . . . . . . . . . . . . . . . . . . . . . .
43
3.2.3
Frequency Response for the Amplitude Noise
of the Atomic Resonance . . . . . . . . . . . . . . . . . . . . . . . . . .
44
3.2.4
Limitation to the Stability
Due to the Amplitude Noise of the Atomic Response . .
44
3.2.5
Frequency Error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
3.2.6
The Best Choices. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
47
www.ebook3000.com

XII
Contents
3.3
The Sampled Servo-loop . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
48
3.3.1
Model of the Servo-loop
in the Case of an Atomic Fountain. . . . . . . . . . . . . . . . . .
48
3.3.2
Frequency Responses for the Frequency Noise
of the Local Oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.3.3
Frequency Response for the Amplitude Noise
of the Atomic Transition . . . . . . . . . . . . . . . . . . . . . . . . . .
51
Part II Characterization of Very High Performances Oscillators
4
Accuracy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
57
4.1
Deﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
57
4.2
Estimation of the Uncertainty of a Frequency Source . . . . . . . .
57
4.3
Typical Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
4.3.1
Primary Frequency Standards . . . . . . . . . . . . . . . . . . . . . .
60
4.3.2
Commercial Devices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
61
5
Reproducibility . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
6
Stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
6.1
Deﬁnition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
65
6.2
Measurements in the Time Domain . . . . . . . . . . . . . . . . . . . . . . .
67
6.2.1
The Measurement Process . . . . . . . . . . . . . . . . . . . . . . . . .
67
6.2.2
Power and Spectral Density. . . . . . . . . . . . . . . . . . . . . . . .
75
6.2.3
Variance of the Frequency Fluctuations . . . . . . . . . . . . .
85
6.2.4
Allan Variance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93
6.2.5
Hadamard Variance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
6.2.6
Getting Rid of a Constant Frequency Drift . . . . . . . . . . 107
6.2.7
The Best Variance for a Given Application . . . . . . . . . . 112
6.2.8
Practical Time Domain Measurements
of Frequency Stability . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121
6.2.9
Typical Values . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
Part III Applications
7
Time and Frequency Metrology . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
7.1
Time Scales. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 130
7.1.1
The Main Time Scales in Use . . . . . . . . . . . . . . . . . . . . . . 131
7.1.2
Algorithms for the Generation of Time Scales . . . . . . . . 137
7.2
Comparison of Clocks . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 142
7.2.1
Clock Synchronization in a Rotating Frame . . . . . . . . . . 142
7.2.2
One-way GPS Measurements . . . . . . . . . . . . . . . . . . . . . . 143

Contents
XIII
7.2.3
GPS Common-view . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145
7.2.4
GPS Carrier-phase Time Transfer . . . . . . . . . . . . . . . . . . 146
7.2.5
Two-way Satellite Time and Frequency Transfer
(TWSTFT). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147
8
Global Positioning System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
8.1
The GPS Infrastructure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152
8.1.1
The Space Segment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152
8.1.2
The Control Segment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153
8.1.3
The User Segment . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
8.2
GPS Data Processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 154
8.2.1
Data Transmitted by the Satellites . . . . . . . . . . . . . . . . . 154
8.2.2
Data Processing by the Receiver . . . . . . . . . . . . . . . . . . . 161
8.2.3
Other Algorithms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
8.2.4
GPS Augmentation: WAAS and LAAS . . . . . . . . . . . . . . 171
8.3
Other Global Systems . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172
8.3.1
GLONASS –
GLObal’naya NAvigatsionnaya Sputnikovaya Sistema . 172
8.3.2
Galileo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173
9
Very Long Base Interferometry . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
9.1
Principle of VLBI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176
9.1.1
Interferometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
9.1.2
Processing of the Signals . . . . . . . . . . . . . . . . . . . . . . . . . . 185
9.2
Applications of VLBI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
9.2.1
Astronomy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
9.2.2
Geodesy. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187
Part IV Appendix
A
Useful Integrals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
A.1 Calculation of Variances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191
A.2 Calculation of Allan Variances . . . . . . . . . . . . . . . . . . . . . . . . . . . 192
A.3 Calculation of Hadamard Variances . . . . . . . . . . . . . . . . . . . . . . . 192
A.4 Calculation of the Three-samples Variance . . . . . . . . . . . . . . . . . 194
B
Some Calculational Details . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
B.1 The Allan Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
B.2 The Hadamard Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
B.3 Three-samples Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 197
B.4 Phase Noise Versus Frequency Noise Spectral Density . . . . . . . 197
B.5 Phase Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 198
B.6 Sampling and Hold . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
B.7 Algorithm for a GPS Receiver . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
www.ebook3000.com

XIV
Contents
B.7.1 The Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 200
B.7.2 Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
Index . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215

List of Figures
2.1
Block-diagram of an oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
2.2
Robinson oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
2.3
Pierce oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2.4
Block diagram of an active hydrogen maser . . . . . . . . . . . . . . . . .
17
2.5
The two parts of a cesium beam frequency standard . . . . . . . . .
17
2.6
Block diagram of a cesium beam frequency standard . . . . . . . . .
19
2.7
Transition probability of an atom across a Ramsay cavity . . . .
22
2.8
Central part of the pattern of Fig. 2.7 . . . . . . . . . . . . . . . . . . . . . .
22
2.9
Mean transition probability of a beam with a velocity
distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
23
2.10 Central part of the curve of Fig. 2.9 . . . . . . . . . . . . . . . . . . . . . . .
24
2.11 Generation of the frequency f1 . . . . . . . . . . . . . . . . . . . . . . . . . . . .
25
2.12 Another electronic device generating the frequency f1 . . . . . . . .
25
2.13 The excitation of the Ramsay cavity as the output of a DRO [90] 26
2.14 Some frequencies generated by intermediate oscillators [112] . .
26
2.15 Production of the maser eﬀect . . . . . . . . . . . . . . . . . . . . . . . . . . . .
29
2.16 Phase locking of the local oscillator on the atomic emission.. . .
30
2.17 Schematic diagram of an atomic fountain . . . . . . . . . . . . . . . . . . .
30
2.18 Calculated Ramsay fringes in an atomic fountain . . . . . . . . . . . .
32
3.1
Phase lock loop for the diﬀerent components of the signals . . . .
35
3.2
The phase lock loop with the phase as the quantity of interest
35
3.3
Equivalent set-up for the local oscillator noise . . . . . . . . . . . . . . .
36
3.4
Equivalent set-up for the noise of the atomic signal . . . . . . . . . .
37
3.5
The loop for the nominal frequency of the local oscillator and
of the atomic oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
39
3.6
Control of the frequency of the local oscillator in a passive
atomic frequency standard . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
42
3.7
Model for the noise in the frequency control loop . . . . . . . . . . . .
42
3.8
The loop for the nominal frequency of the local oscillator and
of the atomic transition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
46
3.9
Sampling in the loop of Fig. 3.7 . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
3.10 The sampled loop for the local oscillator frequency noise . . . . .
50
3.11 The sampled loop for the amplitude noise . . . . . . . . . . . . . . . . . .
51
www.ebook3000.com

XVI
List of Figures
3.12 The sampled loop for the frequency noise of the atomic
transition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
52
6.1
Squared amplitude response of the ﬁlter versus the reduced
frequency. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
68
6.2
Squared amplitude response of the ﬁlter associated to the
frequency measurement with no dead time . . . . . . . . . . . . . . . . . .
70
6.3
Frequency measurement with dead time . . . . . . . . . . . . . . . . . . . .
70
6.4
Squared amplitude response of the ﬁlter associated to the
frequency measurement with a dead time . . . . . . . . . . . . . . . . . . .
71
6.5
Squared amplitude response of the ﬁlter associated to the
frequency measurement with no dead time and association of
three successive results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
72
6.6
Spectrum of the discrete-time process compared to that of
the continuous-time process . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
73
6.7
Aliasing when frequency is measured without a dead time . . . .
74
6.8
Squared amplitude response of the Allan ﬁlter . . . . . . . . . . . . . .
95
6.9
Squared amplitude response of the Hadamard ﬁlter for M = 4 102
6.10 Squared amplitude response of the modiﬁed Hadamard ﬁlter
for M = 8 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
6.11 Squared amplitude response of the balanced Hadamard ﬁlter
with (M = 4) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
6.12 Squared amplitude response of the three-samples ﬁlter . . . . . . . 110
6.13 Model of frequency noise showing the ﬁve power laws . . . . . . . . 114
6.14 Comparison of Allan (lower curve), Hadamard and
three-samples (upper curve) variances . . . . . . . . . . . . . . . . . . . . . . 115
6.15 Allan variance with h1 |ν| noise (lower curve) and with h2ν2
noise (upper curve) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116
6.16 Allan variance and the two asymptotes corresponding to h1
and h2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
6.17 Ratio of the coeﬃcients of the three branches for three variances118
6.18 Three-samples variance. The width of the frequency domain
where the component h−1 × |ν|−1 of the frequency noise is
dominant is three decades . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118
6.19 Allan variance. The width of the frequency domain where the
component h−1 × |ν|−1 of the frequency noise is dominant is
three decades . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
6.20 Allan variance with a constant frequency drift . . . . . . . . . . . . . . 120
6.21 Hadamard variance with a constant frequency drift . . . . . . . . . . 121
6.22 Frequency measurement in the case where a reference
oscillator can be used . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122
6.23 Stability measurement with two identical oscillators. . . . . . . . . . 122
6.24 Frequency noise spectral density of the oscillator of [72] . . . . . . 124

List of Figures
XVII
7.1
A GPS satellite and two receivers on the Earth. The distance
Earth–satellite is about four times the Earth’s radius . . . . . . . . 145
7.2
The principle of the two-way technique . . . . . . . . . . . . . . . . . . . . . 147
7.3
Paths of TWSTFT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
8.1
Orbits of the GPS satellites . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152
8.2
L1 and L2 signals emitted by the GPS satellites . . . . . . . . . . . . . 155
8.3
Modulo 2 (XOR) addition of the navigation message and the
C/A-code and the P-code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156
8.4
Easy retrieval of the navigation message . . . . . . . . . . . . . . . . . . . . 157
8.5
Measurement of the raw pseudo-range (modulo 299 792.458 m) 162
8.6
Good GDOP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165
8.7
Poor GDOP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
9.1
The principle of VLBI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175
9.2
The principle of interferometric measurements . . . . . . . . . . . . . . 177
9.3
Schematic block diagram of a cross-correlator . . . . . . . . . . . . . . . 187
www.ebook3000.com

List of Tables
3.1
Phase noise of a commercial quartz oscillator . . . . . . . . . . . . . . .
41
3.2
Guaranteed values of the Allan deviation of a commercially
available cesium frequency standard . . . . . . . . . . . . . . . . . . . . . . .
45
4.1
Some values of accuracy obtained by cesium fountains . . . . . . .
61
4.2
Uncertainty of a few other primary frequency standards . . . . . .
61
6.1
Noise processes involved in the frequency ﬂuctuations of
ultra-stable oscillators. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
83
6.2
Bandwidth of Allan, Hadamard and three-samples variances . . 112
6.3
Response to some noise spectral density laws. . . . . . . . . . . . . . . . 113
6.4
Sensitivity to a constant frequency drift . . . . . . . . . . . . . . . . . . . . 119
6.5
Cut-oﬀsampling time . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120
6.6
Typical values of the Allan standard deviation of the CHI-75
active hydrogen maser . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
6.7
Speciﬁcation values of the Allan deviation for the 5071A
primary frequency standard (high performance) . . . . . . . . . . . . . 125
7.1
The uncertainties of the best realizations of the seven SI base
units. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129
7.2
Primary frequency standards involved in the accuracy of TAI . 133
7.3
Dates of the leap seconds since 1972 . . . . . . . . . . . . . . . . . . . . . . . 136
7.4
Countries maintaining a local approximation of UTC and/or
an independent local time scale . . . . . . . . . . . . . . . . . . . . . . . . . . . 138

1 Introduction
Frequency is the physical quantity that allows the most precise measurements.
Time is a quantity dual of frequency: the unit of time is – and has always
been – deﬁned by a “periodical” phenomenon: its deﬁnition connects it to
the duration of the period of the chosen phenomenon. It is then possible to
measure the duration of any phenomenon, which then is expressed as the
number of units it contains.
Conversely, the frequency of a periodic phenomenon is obtained by merely
counting the number of periods occurring during the unit of time.
Giving such a deﬁnition to the unit of time poses a diﬃculty: a periodic
phenomenon is one that repeats identically to itself at identical time intervals.
Consequently, a time reference must be deﬁned beforehand to decide whether
a phenomenon is periodic, which means that a time reference should be known
before deﬁning a time reference!
In fact, an empirical and pragmatic approach has always been taken and
this relies on the assumption that an observed phenomenon is periodic.
A unit of time is not suﬃcient to control the time parameter of a given
activity. It must be complemented by a mean that allows a value of the
duration of the time interval between any event and a conventional origin to
be given. This time interval deﬁnes the date of the event, and the means of
dating events is a time scale.
Since very early times, due to its direct practical implications in everyday
life, the rotation of the Earth has been chosen to deﬁne the unit of time and
the time scale. This choice has led to the time scale UT, with its two versions
UT0 and UT1 now in use.
In this time scale, the basic period is the day, which is the period of
the rotation of the Earth on its axis. The deﬁnition of the day and of the
associated time scale has evolved with the improvement of the precision of
the measurements and the requirements of the applications have become
increasingly demanding:
1. In a ﬁrst step, the local solar day (for a given location on the Earth) was
merely the interval between two successive passages of the sun on the
local meridian line (this is the so-called true solar day). This basic unit
is divided into 24 hours, each hour having 60 minutes, etc.
Noon (the passage of the sun on the local meridian line) was the origin
of these time scales. As a consequence, there were as many diﬀerent time
www.ebook3000.com

2
1 Introduction
scales as municipalities located on diﬀerent meridian lines and able to set
a clock. Anyone traveling was consequently obliged to frequently reset his
watch, unless he was traveling on a given meridian line.
2. Eﬀorts have been made in two directions:
a) Standardization of the time scale. All clocks in a given region (larger
than a given municipality: a country, for instance) used the same time
scale. For instance, in France, a law decreed in 1891 deﬁned the legal
time everywhere in France as being the solar time measured in Paris.
Moreover, all clocks within a given region using a same time scale
would diﬀer by an integer number of hours from those in other zones
using other time scales. The local time at the Royal Greenwich Obser-
vatory in England was chosen as standard at the 1884 International
Meridian Conference [1], which stated:
–
Resolution IV: “That the Conference proposes the adoption of
a universal day for all purposes for which it may be found conve-
nient, and which shall not interfere with the use of local or stan-
dard time where desirable.”
This resolution was adopted by the following vote: ayes, 23; ab-
staining, 2.
–
Resolution V: “That this universal day is to be a mean solar day;
is to begin for all the world at the moment of mean midnight of
the initial meridian, coinciding with the beginning of the civil day
and date of that meridian; and is to be counted from zero up to
twenty-four hours.”
This resolution was adopted by the following vote: ayes, 15; nos, 2;
abstaining, 7.
The unit of time so deﬁned is called a true solar day.
In the United States and Canada, standard time zones were intro-
duced on November 18, 1883; the French did not adopt the Green-
wich meridian until 1911 (all the clocks in France had then to be
adjusted by 9 min 21 s). By 1929 all major countries had adopted the
time zones.
Time scales in use to day are discussed in Sect. 7.1.
b) Accuracy and stability of the time unit. It was quickly established
that the unit of time “true solar day” was not a good reference: its
length is not constant and this fact was easily shown using mechanical
clocks, which were becoming increasingly stable. The length of a solar
day varies throughout the year for diﬀerent reasons:
First, the Earth’s orbit is an ellipse and the Earth moves faster when
it is nearest the Sun and slower when it is farthest from the Sun.
Second, the Earth’s axis tilts, so that the Sun does not move ex-
actly along the Earth’s celestial equator but at a small varying angle
above or below the celestial equator. Consequently, it moves faster or
slower depending on whether it is moving toward or away from the
equator.

1 Introduction
3
The result of this complex apparent motion of the sun is that it crosses
a given meridian with a delay or an advance of time that changes ev-
ery day. The true solar day is shorter from February to March and
from August to September and longer from May to June and from
November to December. The diﬀerence between the longest and the
shortest true solar day is about half an hour and was detected very
early on.
The true solar day was replaced by the mean solar day as the ba-
sic unit of time. This new unit is deﬁned as the mean value of the
solar day calculated in a year. It equals the true solar day corrected
by a value called the equation of time. This mean solar day was the
basis of the second and of the UT1 time scales until 1956. Its imple-
mentation relies on astronomical observations.
In fact, the mean solar day is not constant either, for various reasons
such as the tidal dissipation of energy, which slows down the rotation
of the Earth, the atmospheric motions, the relative motion of the
Earth core and of the Earth crust, etc.
The mean solar day was consequently abandoned in 1956, when the
Comité International des Poids et Mesures decided that “The sec-
ond is the fraction 1/31 556 925.9747 of the tropical year for 1900
January 0 at 12 hours ephemeris time.”
This new time scale (ephemeris time ET) is based on the rotation
of the Earth around the Sun, which is much more stable than the
rotation of the Earth about its axis. The origin of this time scale was
chosen so that it coincided approximately with UT1 in the year 1900.
Due to the slowing down of the rotation of the Earth, the diﬀerence
between ET and UT1 was 56 seconds in 1988.
The most recent step in this eﬀort to obtain a more eﬃcient time scale is the
use of atoms to deﬁne the unit of time, instead of astronomical objects.
The underlying assumption is that the energy levels of every atom of
a given specie (for instance every atom of cesium, or every atom of hydrogen),
if it is protected from perturbation, is the same everywhere in the universe
and will never be modiﬁed, contrary to the motion of the Earth.
Since the energy levels of atoms deﬁne the frequency of the radiation
emitted or absorbed when the atom undergoes a transition between these
levels, this assumption implies that the frequency of the transitions of any
atom of a given specie is the same everywhere in the universe and will never
be modiﬁed.
Of course, many precautions must be taken when probing the true fre-
quency of the chosen transition: any atom can be perturbed by its environ-
ment and by the probing process, with the result that the energy levels are
modiﬁed. These modiﬁcations must be minimized and taken into account.
One of these transitions can consequently be chosen as the periodic phe-
nomenon that deﬁnes the elementary time interval: a transition between two
www.ebook3000.com

4
1 Introduction
energy levels of the 133Cs atom has deﬁned the second since 1967 (13th Con-
férence générale des Poids et Mesures [35]):
“The second is the duration of 9 192 631 770 periods of the radiation cor-
responding to the transition between the two hyperﬁne levels of the ground
state of the cesium 133 atom.”
This decision was prepared by the progress made in the atomic frequency
sources.
The fractional accuracy and the fractional stability attained by the best
realization of the time SI unit are now (2006) better than one part in 1015.
Excellent approximations of the realization of this new deﬁnition of the
SI time unit can be made by any institute of metrology in the world.
Moreover, reference oscillators with very high qualities can be widely
spread among the users and thus allow a large variety of applications that
beneﬁt from their extremely good properties. Telecommunications, global
positioning, very long base interferometry, and physical research are some of
these applications. Some of them will be described in this book.
Handling quantities with such accuracy and stability is speciﬁc to the
time-frequency domain and special care must be taken in order to not corrupt
these qualities. The aim of this book is to describe and study the procedures
that allow one to obtain the best result from this unique and extraordinary
tool that is time and frequency.
In Part I, the conception of the frequency standards (oscillators that
deliver a frequency that can be used as a reference) is described. The
best one is, of course, the atomic frequency standard, whose output fre-
quency is controlled by an atomic transition. Nevertheless, the principle of an
atomic frequency standard is basically the same that of any other frequency
source.
A high quality oscillator consists of two parts that interact with each
other as follows:
–
In one part, a physical phenomenon is produced, which involves the refer-
ence frequency. For instance, in the case of an atomic oscillator, the atoms
of interest are produced in the desired energy level and the transition of
interest is excited.
–
In the other part, the oscillation to be controlled by the physical phe-
nomenon is produced by an electronic (or optical) device and compared
to the frequency of the physical phenomenon. This comparison implies an
interaction between the oscillation and the phenomenon. This results in an
error signal, which allows one to maintain the frequency of the oscillation
at a value related to the value of the reference frequency.
These two parts are detailed in Chap. 2 and Chap. 3.
The frequency of the output of the overall device is a normalized one (for
instance 10 MHz, 1 Hz, etc.) in order to be easily handled by the end-users.
A clock is a device that generates periodic, accurately spaced signals used
for timing applications and counts the number of periods, for instance the

1 Introduction
5
number of seconds, minutes, etc., that have elapsed since a conventional ori-
gin. It is consequently able to give the date of an event.
A clock consists of at least three parts:
–
an oscillator;
–
a device that counts the oscillations and converts them to units of time
interval (such as seconds, minutes, hours, and days);
–
a means of deﬁning the origin; and
–
a means of displaying or recording the results.
Consequently, oscillators underlie all time-frequency activities.
The most representative atomic oscillators are described in Part I of the
book (see Sect. 2.3). They are:
–
the active hydrogen maser,
–
the frequency standard using an atomic beam of cesium, and
–
the frequency standard using an atomic fountain of cesium.
A precise characterization of the devices is necessary in order to determine the
types of noise that limit the accuracy of the measurements to be performed,
as well as the performances of applications relying on its use.
The metrological properties of interest that must be known in most ap-
plications are the stability, the accuracy and the reproducibility.
The accuracy of an oscillator is the degree of conformity of the frequency
of the signal it delivers to its nominal value.
The reproducibility is correlated to the accuracy: it indicates how the
output frequency of a device of a given kind (e.g. the cesium atomic frequency
standard 5071A) diﬀers from that of another device of the same type.
The evaluation of the accuracy, which is often called uncertainty, is based
on a careful and precise review of the physical eﬀects that can modify the
frequency of the reference phenomenon (i.e. the atomic reference transition,
often called the clock transition) and of their uncertainty (budget error).
This kind of review is described in a precise example in Chap. 4.
While accuracy indicates whether the value of the frequency is right or
wrong, and how far wrong it can be, stability indicates whether or not this
value stays the same over a given time interval.
The value of the frequency of an oscillator varies with time due to:
1. ergodic and second-order stationary random ﬂuctuations, and
2. non-stationary random or deterministic variations of the frequency.
Two diﬀerent approaches are used to characterize the stability:
1. Direct measurements of the spectrum of the signal delivered by the oscil-
lator in frequency domain. Of course, the local oscillator must be at least
as good as the oscillator under test. Such measurements are well suited
to characterize the eﬀect of the stationary random ﬂuctuations far from
the carrier.
www.ebook3000.com

6
1 Introduction
2. Calculation in the time domain of the variance of the results of the mea-
surement of the frequency of the oscillator. Various numeric ﬁlters are
applied to the sequence of results of these frequency measurements, which
lead to diﬀerent variances: Allan, Hadamard and three-samples variances
are the most used.
Such measurements are well suited to characterize the eﬀect of the sta-
tionary random ﬂuctuations close to the carrier, and one of them (the
three-samples variance) gives a result free from any stationary constant
drift.
These algorithms are described in Chap. 6.
Part III of the book describes three important applications of precise fre-
quency standard, where the best qualities are required:
–
Frequency and time metrology.
The ﬁrst objective of metrology is to distribute the SI unit to the user in
order to insure coherent measurements. In the case of time and frequency,
the high performance frequency and standards disseminated all over the
world are used to deﬁne the diﬀerent time scales in use.
A time scale is a kind of virtual clock deﬁned by a set of real clocks, whose
goal is to keep time and provide it for the end-users.
It uses a set of frequency sources and an algorithm to construct the time
scale from the data delivered by the clocks participating in it and an
agreement to deﬁne the length of the second (which is the standard unit of
time interval). Seconds are then counted to measure longer time intervals,
such as minutes, hours, days, etc.
These time scales are described herein. Moreover, a method allowing
a very accurate comparison of the clocks taking part in the time scale
construction, as well as the comparison of any user clock with the time
scale, are discussed.
–
Tracking and localization.
One of the most popular applications of precise time and frequency is
tracking and navigation, particularly by the wide use of global systems
such as the global positioning system (GPS) and the future GALILEO.
GPS uses a constellation of satellites that orbit the Earth. By process-
ing signals received from the satellites, a commercial GPS receiver can
determine its own position within an uncertainty of a few meters.
GPS is also a dominant system for the distribution of time and frequency.
There are several types of time and frequency measurements that involve
GPS, including one-way, common-view, and carrier-phase measurements.
The space segment, control segment and user segment of GPS are de-
scribed and the processing of the data transmitted by the satellites is
studied and discussed.
–
Very long base interferometry (VLBI).
This measurement technique relies on the observation of the time diﬀer-
ence between the arrival at two or more antennas of a radio wavefront

1 Introduction
7
emitted by a distant radio source. The distance between the antennas is
the base of the interferometer.
The more distant the antennas, the more precise the measurements. VLBI
is an interferometry technique where the base is of the order of a few thou-
sands kilometers. Consequently, the signals received by the antennas are
not correlated in real time, but recorded and sent to a common correlator
where they are played together.
This is only possible if a very stable time reference is used at each antenna.
First, the local oscillator that down converts the frequency of the received
signal to the IF frequency must have a very low phase noise, so that
the fringes are not blurred. Second, precise timing information must be
recorded with each signal in order to synchronize them in the correlator
and deduce the time delays of the wavefront at each antenna.
www.ebook3000.com

Part I
Very High Performances Oscillators

Since the second half of the 20th century frequency standards and clocks with
increasingly better qualities have been designed and operated:
–
In 1948, the National Bureau of Standards (NBS, now the National Insti-
tute of Standards and Technology NIST) built the ﬁrst atomic (molecular)
clock (see [86, 87]). It used an absorption line of molecules of ammonia and
the fractional accuracy of this very ﬁrst device was one part in 107. This
frequency source was never used for timekeeping because its properties
were not better than those of quartz clocks.
–
The ﬁrst accurate atomic clock was based on a transition of the cesium
atom and was built in 1955 at the National Physical Laboratory [46]. The
ﬁrst version of this device was accurate to one part in 1010.
–
The ﬁrst commercially available cesium clock, the Atomichron, went on
sale in October 1956 [77]. From 1956 to 1960 about ﬁfty of these devices
(NASF/NC-1001 Atomichron) were made and sold [48].
These devices launched the world into a new concept of timekeeping, leading
to a new deﬁnition of the SI time unit and to increasingly accurate and stable
devices, which allowed new applications.
The principle of these high performance oscillators – frequency stan-
dards – will be studied in the following chapter, and some of the best ones
will be described. This principle can be applied to optical oscillators, i.e. os-
cillators whose output frequency is in the optical domain. These oscillators
are not described in this book.
Processing of the atomic line used as the frequency reference (clock tran-
sition) can damage the quality of the device if it is not carefully designed.
A careful analysis of this part of any frequency standard is therefore given in
the following chapter.
www.ebook3000.com

2 The Two Parts of an Oscillator
Any electronic or optical oscillator is composed of two parts whose quality
must be optimized to obtain the best performances (see Fig. 2.1). The two
parts are as follows:
1. A package where a periodic physical phenomenon is produced. The fre-
quency of this phenomenon is used by the other part of the device to
control the frequency of the output signal of the oscillator. This is the
reference frequency of the device.
2. An electronic and/or optical package. This part controls the periodical
phenomenon and its environment and links the frequency of the output
signal of the oscillator to that of the physical phenomenon.
The quality of the oscillator consequently depends on the following two types
of factors:
1. The factors related to the physical phenomena involved in the ﬁrst part
of the device. The stability, accuracy, etc. of the device cannot be better
than that of the physical phenomenon.
2. The factors related to the electronic and/or optical part whose task is
to control and interrogate the physical phenomenon and then to process
the data resulting from this interrogation. Noise and errors that are in-
troduced by these processes lower the quality of the output signal and
must consequently be minimized.
A few examples of oscillators, using this scheme, are given below. They diﬀer
by the nature of the physical phenomenon involved.
Fig. 2.1. Block-diagram of an oscillator

14
2 The Two Parts of an Oscillator
2.1 Electrical Resonances
The physical phenomenon used in simple electronic oscillators is the electri-
cal resonance of a selective circuit, such as the L-C parallel circuit of the
classical Robinson oscillator shown in Fig. 2.2. This book is devoted to high
performance oscillators and does not discuss this family of oscillators.
Fig. 2.2. Robinson oscillator
2.2 Mechanical Resonances
A wide family of oscillators uses mechanical vibration of piezo-electric mate-
rial.
When a piezo-electric element is stressed electrically by a voltage, its di-
mensions change. When it is stressed mechanically by a force, it generates an
electric charge. If the electrodes are not short-circuited, a voltage associated
with the charge appears.
The vibration frequency of a plate of quartz gives the reference frequency
of the oscillator.
This piezo-electric eﬀect allows the interaction of the physical phenom-
ena (the vibration of the plate) and of the electronic circuit, which drives the
vibration of the plate and is in turn controlled by this vibration via a feed-
back circuit. Figure 2.3 shows a classical example of a quartz crystal Pierce
oscillator.
Quartz oscillators can provide very high stability performance. One should
bear in mind that the ﬁrst attempt to built an atomic frequency standard
did not give a better result than the existing quartz crystal oscillators (see
p. 11).
www.ebook3000.com

2.3 Atomic Frequency Standards
15
Fig. 2.3. Pierce oscillator
2.3 Atomic Frequency Standards
In this case, the physical phenomenon is an atomic resonance, e.g. a transition
between two levels of a given atomic specie.
Every atom possesses an inﬁnite number of discrete states depending on
the conﬁguration of its electrons. Each state is characterized by a precise en-
ergy, the state with the lowest energy being the ground state. Any transition
between two states modiﬁes the energy of the atom and must consequently
be accompanied by an energy exchange with its environment. This exchange
often occurs by emission or absorption of an electromagnetic radiation whose
frequency f is deﬁned by the energy diﬀerence δE between the two states
involved in the transition:
δE = h × f ,
(2.1)
where h is the Planck constant whose value is (see [94])
h = 6.626 0693 × 10−34 J · s .
(2.2)
Moreover, each state may possess ﬁne and hyperﬁne structures. A ﬁne struc-
ture arises because the electron has an intrinsic angular momentum (spin)
that interacts with the magnetic ﬁeld produced, for example, as the electron
“orbits” the nucleus. A hyperﬁne structure is produced by the interaction of
the electronic spin and that of the nucleus. It depends on the spin of the
electrons and of the nucleus of the atom.
Each state of an atom is characterized by a set of values, the quantum
numbers. The atomic transition that is chosen for a given atomic frequency
standard is its “clock transition”.

16
2 The Two Parts of an Oscillator
A distinction is often made between active and passive atomic frequency
standards as follows:
–
In active atomic frequency standards, the atoms undergo a transition
toward a lower energy state and emit an electromagnetic signal at the
frequency of the clock transition. This signal is used by the electronic
package to build the output signal of the oscillator.
–
In passive atomic frequency standards, the atomic cloud is too dilute
and does not produce any electromagnetic signal. The clock transition is
probed by a signal generated by the electronic package. The response to
this excitation is used to control the frequency of the output signal.
2.3.1 Active Atomic Frequency Standards
The active hydrogen maser is a good example of an active frequency standard.
Its clock transition connects the two hyperﬁne levels of its ground state.
These levels are designed by the quantum numbers F = 1, mF = 0 (the state
with the higher energy) and F = 0, mF = 0 (the state of the lower energy).
The energy diﬀerence between these two states corresponds to the frequency
fH = 1 420 405 752 Hz.
A very dilute cloud of hydrogen atoms is conﬁned for about one second
in a resonant cavity tuned to the frequency fH of the clock transition.
The atoms are sorted before their introduction into the cavity: only those
in the upper state F = 1, mF = 0 of the hyperﬁne structure enter the cavity.
They coherently amplify the noise component at the frequency fH of the
hyperﬁne transition. If the atomic density is high enough, an oscillation at
that frequency is produced in the cavity and can be detected (this is the
maser eﬀect1).
The electronic package controls the phase of the local 5 MHz or 10 MHz
oscillator in such a way that it is linked to the phase of the atomic signal.
Figure 2.4 shows a schematic block diagram of the hydrogen maser.
2.3.2 Passive Atomic Frequency Standard
The cesium beam frequency standard is a good example of passive atomic
frequency standard.
In this case, the atoms are not conﬁned. They form an atomic beam and
are consequently too dilute to produce the maser eﬀect. Consequently, there is
1 Maser: microwave ampliﬁcation by stimulated emission of radiation. The princi-
ple of stimulated emission was proposed by Albert Einstein in 1917. When atoms
have been put into an excited energy state, they can amplify incoming radiation
at the frequency of the transition between the present state and the fundamental
state by emitting a photon coherent with the incoming radiation (i.e. correspond-
ing to an electromagnetic wave with same phase and same polarization as the
incoming radiation).
www.ebook3000.com

2.3 Atomic Frequency Standards
17
Fig. 2.4. Block diagram of an active hydrogen maser
Fig. 2.5. The two parts of a cesium beam frequency standard
no emission of a radiation that can be used to lock the phase of the electronic
oscillator.
An excitation, produced by frequency synthesis from the electronic os-
cillator, probes the atomic transition that connects the two hyperﬁne levels
F = 4, mF = 0 and F = 3, mF = 0 of the ground state of the cesium atom
(isotope 133). This excitation is the interrogation of the atoms.

18
2 The Two Parts of an Oscillator
The response of the atoms to this excitation, whose frequency is related by
a known number to the frequency of the electronic oscillator, allows correction
of the frequency of this oscillator via a frequency control loop.
This eﬀect is shown in Fig. 2.5.
2.3.3 Optically Pumped Cesium Beam
The physical phenomenon that provides the frequency reference is the reso-
nant transition between the two hyperﬁne levels of the ground state of the
cesium atom. The electronic and optical part of the device probes the atomic
transition in a beam of cesium atoms that has been suitably prepared and
uses the answer of the atoms to correct the frequency of the output.
The Physical Phenomenon
The ground state of the cesium atom has no ﬁne structure because the orbital
magnetic moment cancels, but possesses a hyperﬁne structure due to the
interaction of its nucleus spin (characterized by the quantum number I = 7/2)
and its valence electron spin (characterized by the quantum number S = 1/2).
If the electron and nucleus spins are parallel, the hyperﬁne structure level
is characterized by the quantum number F = 7/2 + 1/2 = 4. If they are
anti-parallel, the hyperﬁne level is characterized by the quantum number
F = 7/2 −1/2 = 3.
The energy diﬀerence between the two hyperﬁne levels is
∆E = h × fCs ,
(2.3)
where h is the Planck constant, and fCs = 9 192 631 770 Hz is the frequency of
the radiation involved in any radiative transition of the cesium atom between
the two hyperﬁne levels. This frequency was adopted in 1967 to deﬁne the
SI time unit (second). The 13th CGPM (General Conference on Weights and
Measures) gave the following deﬁnition of the second [35, 66]2: “The second
is the duration of 9 192 631 770 periods of the radiation corresponding to the
transition between the two hyperﬁne levels of the ground state of the cesium
133 atom”.
Consequently, the value of the frequency fCs is known without any un-
certainty3.
2 The reference text is in French and reads: “La seconde est la durée de 9 192 631 770
périodes de la radiation correspondant à la transition entre les deux niveaux
hyperﬁns de l’état fondamental de l’atome de césium 133”.
3 Of course, this frequency is the frequency of unperturbed cesium atoms. For
instance, at its 1997 meeting, the CIPM (Comité International des Poids et
Mesures – International Committee for Weights and Measures) conﬁrmed that
“This deﬁnition refers to a cesium atom at rest at a temperature of 0 K” in order
to make it clear that the cesium atom must not be perturbed by black-body
radiation and that the hyperﬁne frequency must be free of any Doppler eﬀect.
www.ebook3000.com

2.3 Atomic Frequency Standards
19
The basic idea in order to lock the frequency fo of an electronic oscilla-
tor (5 or 10 MHz, for instance) to the frequency fCs of the transition is as
follows.
1. Produce a beam of cesium atoms.
2. Produce an unbalance of the populations of the atoms in the two hyperﬁne
levels F = 3 and F = 4, which otherwise are almost the same at thermal
equilibrium. These two steps are the preparation of the beam.
3. Generate a signal, whose frequency f1 is close to the frequency fCs, by
frequency synthesis from the output of the electronic oscillator.
The ratio f1/fo is exactly known and results from classical methods of
frequency addition, subtraction, multiplication and division.
4. Excite the beam of atoms by this signal of frequency f1. The result of this
excitation, if the frequency f1 is close to the frequency fCs, is to balance
the populations of the F = 3 and F = 4 atoms.
This is the interrogation of the beam.
5. Measure the residual population unbalance after the interrogation, which
indicates how far f1 is from fCs. This is the response of the beam.
6. The response of the beam is then used to correct the frequency fo, so that
it is as close as possible to its nominal value according to the deﬁnition
of the SI second.
This is the servo control of the output frequency.
These steps can be found in every passive atomic frequency standard.
They are summarized in Fig. 2.6 and details are given below.
The atomic beam is in a vacuum chamber as good as possible, and the
region where the atoms are excited by the microwave radiation is protected
from spurious magnetic ﬁeld by magnetic shields.
Fig. 2.6. Block diagram of a cesium beam frequency standard

20
2 The Two Parts of an Oscillator
Preparation of the Atoms
Two set-up families have been designed to prepare the atomic beam and
produce the population unbalance.
1. Magnetic deﬂection of the atoms.
Historically, this was the ﬁrst scheme. The interaction between an atom
and an inhomogeneous magnetic ﬁeld is diﬀerent according to the hyper-
ﬁne state of the atom [51].
A magnet producing an inhomogeneous magnetic ﬁeld (Stern–Gerlach
magnet) spatially separates atoms in the various mF states, and atoms
in one of the ground-state levels (F = 3, mF = 0 or F = 4, mF = 0) are
transmitted through the interrogation region. The other atoms are lost.
The response of the atoms to their interrogation is detected by an iden-
tical Stern–Gerlach magnet arranged so that atoms are directed to a de-
tector only if they have been stimulated by the microwave ﬁeld to the
other ground, mF = 0, level.
This scheme is still used in the commercially available cesium beam fre-
quency standards.
2. Optical pumping of the atoms.
The state of the atoms is manipulated by optical radiations. All the atoms
of the beam can in principle be “pumped” in one of the two hyperﬁne
states. The response of the atoms is also detected by their interaction
with an optical beam.
The present primary cesium beam frequency standards use this optical
pumping scheme.
Excitation of the Transition
The atoms interact with the microwave excitation in a resonant cavity (tuned
to the frequency fCs) in order that the interaction strength be suﬃcient to
produce the transition between the two hyperﬁne levels if the excitation is at
the exact frequency of the transition.
In the case of the cesium frequency standards, the cavity has a special
shape (Ramsay cavity [106]): every atom interacts with the excitation in two
successive regions, each having a length l. These two regions are separated
by a distance L.
What happens to the atoms in the cavity is well known (see, for in-
stance [123]). The probability that a given atom in a given hyperﬁne mF = 0
level undergoes a transition to the other hyperﬁne mF = 0 level in the cavity
(transition probability) depends on the following.
–
The amplitude of the microwave ﬁeld in the cavity.
–
The duration t of the interaction in each part of the cavity.
–
The delay T between the two interactions.
www.ebook3000.com

2.3 Atomic Frequency Standards
21
–
The diﬀerence δf = f1 −fCs between the microwave excitation frequency
f1 and the resonance frequency fCs.
This transition probability is given by
P(b, δω, t, T ) = 4b2
Ω2 sin2
Ωt
2

×

cos
Ωt
2

cos
δωT + Φ
2
2
−4b2
Ω2 sin2
Ωt
2

×
δω
Ωsin
Ωt
2

sin
δωT + Φ
2
2
.
(2.4)
In this expression
–
δω = 2πδf characterizes the mistuning of the excitation and the param-
eter,
–
b (the so-called Rabi frequency) characterizes the amplitude of the mi-
crowave excitation
b = µB
ℏB =
e
2me
B ,
(2.5)
where B is the microwave magnetic ﬁeld amplitude in the cavity, µB is
the Bohr magneton:
µB = eℏ/2me = 9.27400949(80) × 10−24 J · T−1 ,
e is the elementary charge, ℏis the reduced Planck constant:
ℏ≡h
2π = 1.05457168(18) × 10−34 J · s ,
me is the electron rest mass,
–
Ω=
√
δω2 + b2, and
–
Φ is the phase diﬀerence of the microwave between the two parts of the
cavity.
Figure 2.7 shows the calculated transition probability of an atom whose speed
is such that the interaction time is t = 50 µs (Ramsey fringes).
This calculation has been made for the following values: L/l = 10, b =
104 Hz, Φ = 0, −10 kHz ≤f1 −f0 ≤10 kHz.
This shows that the transition probability is maximal for δω = 0 (the cen-
tral lobe of the curve) and that many side lobes exist, with smallest values of
the transition probability. The maximal value of the central lobe (for Φ = 0) is
pmax = sin2(bt)
(2.6)
and its width is
δf = 1
2T .
(2.7)

22
2 The Two Parts of an Oscillator
Fig. 2.7. Transition probability of an atom across a Ramsay cavity
Fig. 2.8. Central part of the pattern of Fig. 2.7
This central lobe is used to lock the frequency of the local oscillator to the
frequency of the transition, since its maximal value occurs for the exact value
of the transition frequency. Figure 2.8 shows this central lobe: its full width
is 1.0 kHz, which corresponds to T = 500 µs.
www.ebook3000.com

2.3 Atomic Frequency Standards
23
Fig. 2.9. Mean transition probability of a beam with a velocity distribution
In the case where δω ≪b (the excitation frequency f1 is very close to the
resonance frequency fCs), (2.4) becomes
P(b, δω, t, T ) = 4 sin2
bt
2

cos2
bt
2

cos2
δωT + Φ
2

= sin2 (bt) cos2
δωT + Φ
2

.
(2.8)
In fact, in a thermal beam, there is a distribution of the atomic velocities
and only the central lobe remains visible, the other ones being blurred by the
velocity dispersion.
Figure 2.9 shows the calculated mean transition probability of the atoms
of a thermal beam with a Maxwell–Boltzmann velocity distribution. The most
probable velocity of the beam corresponds to an interaction time of t = 50 µs
and T = 10 × t. Figure 2.10 shows the central part of the pattern in Fig. 2.9.
Its full width is δf = 630 Hz, which corresponds to an equivalent interaction
time t of 79 µs.
Detection of the Atomic Transition
In order to lock the local oscillator frequency to the frequency of the atomic
transition (multiplied by a known factor), it is necessary to measure how
well the atoms have undergone the transition in the interaction region, i.e.
to measure the transition probability.

24
2 The Two Parts of an Oscillator
Fig. 2.10. Central part of the curve of Fig. 2.9
As for the preparation of the beam (see p. 20), two methods are used to
detect the atomic transition.
1. Magnetic deﬂection of the atoms. This set-up was used in the cases where
the beam preparation itself used magnetic deﬂection. Only the atoms in
a given hyperﬁne state are directed toward a detector. The response of
this detector consequently gives the number of atoms having undergone
the transition.
2. Optical detection of the atoms. Only the atoms in a given hyperﬁne state
interact with the laser beam; it is consequently possible to know the
number of atoms having undergone the transition via the ﬂuorescence
signal produced by the atomic beam excited by this laser beam.
The Electronic and Optical Package
Besides controlling the experiment (vacuum system, oven producing the ce-
sium beam, control of environmental parameters such as temperature and
magnetic ﬁeld), the main task of this part of the device is to control the
frequency of an electronic oscillator (local oscillator, LO) in such a way that
–
its frequency remains locked (but not equal4) as tightly as possible to the
reference frequency (i.e. the frequency of the transition) in order to ensure
accuracy and long-term stability;
4 The frequency of the transition is imposed by the clock transition chosen for
a given device, when the output frequency must be a standard frequency such as
10 MHz. Both are connected by a frequency synthesis as shown in the following.
www.ebook3000.com

2.3 Atomic Frequency Standards
25
–
its frequency noise remains as low as possible to ensure as good a short-
term and medium-term stability as possible.
Generation of the frequency f1 ≈fCs
The signal at frequency f1 is applied to the Ramsay cavity in order to probe
the atomic transition. The atomic response to this excitation provides the
error signal that allows locking of the local oscillator (frequency fo) to the
atomic frequency. The noise properties of the excitation signal must conse-
quently be optimized.
Figure 2.11 shows the simpliﬁed block diagram of an electronic device
that synthesizes this frequency f1, close to the reference frequency fCs [90].
It is generated by frequency multiplication (overall multiplication fac-
tor: 184) and synthesis from the 5 MHz local oscillator. This local oscillator
is a voltage controlled quartz crystal oscillator as shown in Fig. 2.11.
Another simpliﬁed example is shown in Fig. 2.12 (see [112]).
Both are simpliﬁed block diagrams that do not show the eﬀorts made to
reduce the phase noise of the excitation signal.
The main improvement to these general block diagrams in order to min-
imize the phase noise is the use of oscillators to produce some intermediate
frequencies of the chain: the phase (and frequency) noise of a good 20 MHz
Fig. 2.11. Generation of the frequency f1
Fig. 2.12. Another electronic device generating the frequency f1

26
2 The Two Parts of an Oscillator
oscillator (for instance) is better than the noise of the frequency-multiplied
5 MHz local oscillator.
These intermediate oscillators are phase locked to the local oscillator. In
the case of [90], the ﬁnal frequency itself (9192 MHz) is generated by a DRO5
This oscillator is phase locked to the signal of frequency f1 generated by
frequency multiplication and syntheses from the local oscillator. This is shown
in Fig. 2.13.
Fig. 2.13. The excitation of the Ramsay cavity as the output of a DRO [90]
Fig. 2.14. Some frequencies generated by intermediate oscillators [112]
5 DRO: dielectric resonator oscillator. This is an oscillator whose physical phe-
nomenon is the electromagnetic resonance of a dielectric cavity. It provides low
phase (and frequency) noise and high power output.
www.ebook3000.com

2.3 Atomic Frequency Standards
27
In the case of [112], the frequencies 100 MHz and 10.7 MHz are the inter-
mediate frequencies generated by oscillators as shown in Fig. 2.14.
–
The 100 MHz oscillator is phase locked to the 10 MHz output of the ×2
multiplier. To this end, the output of this 100 MHz oscillator is divided
by 10.
–
The 10.7 MHz oscillator is phase locked to the output of the frequency
synthesizer driven by the output of the ×4 multiplier.
Locking the Local Oscillator Frequency to the Transition Frequency
The result of the excitation of the atoms in the Ramsay cavity is used to
control the frequency of the local oscillator in such a way that its frequency
remains as close as possible to its nominal value (5 MHz, for instance). For
this purpose, an error signal is generated from the detection of the atomic
transition in various ways.
1. In all cases, the frequency of the excitation is modulated in order to
produce a periodic response that can be detected with a signal to noise
ratio much better than for a static excitation (synchronous detection).
2. The frequency of the modulation is low enough so that the calculated
static atomic response can be applied.
3. Some devices use a sinusoidal modulation of the frequency and syn-
chronous detection of the third harmonic, which provides an error signal
that cancels when the carrier frequency equals the frequency of the tran-
sition and whose sign is positive or negative according to what side of the
atomic resonance curve the carrier frequency is.
4. Some devices use a square wave modulation. In this case, static approxi-
mation cannot be applied to the atomic response. The transient part of
the response, which occurs at every half period of the modulation, is not
taken into account and only the constant (or slowly varying) part of the
response is used to generate the error signal. A digital processing is well
suited for this purpose.
The error signal may be used
–
either to permanently correct the frequency of the local oscillator. In this
case, the feedback loop is closed and the device delivers that frequency
controlled by the transition frequency;
–
or to record the ﬂuctuations of this local oscillator relative to its nominal
frequency. In this case, the feedback loop is open.
2.3.4 Active Hydrogen Maser
This device uses the maser eﬀect (see p. 16) in a very dilute gas of atomic
hydrogen [52, 71].
In this gas, the atoms are in the upper hyperﬁne state of their ground level:
they emit a coherent radiation at the frequency of the hyperﬁne transition

28
2 The Two Parts of an Oscillator
(1 420 405 752 Hz). The local oscillator of the device is phase-locked to this
radiation.
The Physical Phenomenon
The physical phenomenon is the maser eﬀect, which produces a weak elec-
tromagnetic radiation whose frequency is deﬁned by the energy diﬀerence
between the two hyperﬁne levels of the ground state of the hydrogen atom.
As in the case of the cesium atom, the ground state of the hydrogen
atom has no ﬁne structure because the orbital magnetic moment cancels,
but possesses a hyperﬁne structure due to the interaction of its nucleus spin
(characterized by the quantum number I = 1/2) and its valence electron spin
(characterized by the quantum number S = 1/2).
If the electron and nucleus spins are parallel, the hyperﬁne structure level
is characterized by the quantum number F = 1/2 + 1/2 = 1. If they are
anti-parallel, the hyperﬁne level is characterized by the quantum number
F = 1/2 −1/2 = 0.
In order to produce the maser eﬀect, a population diﬀerence must be
permanently produced in a collection of atomic hydrogen: the number of
atoms in the upper energy hyperﬁne level (F = 1) must be greater than the
number of atoms in the lower hyperﬁne level (F = 0).
Moreover, because the microwave power produced by the stimulated emis-
sion is very weak, the maser eﬀect must occur in a resonant cavity tuned to
the hyperﬁne frequency.
The overall scheme of the part of the device producing the maser eﬀect
is shown in Fig. 2.15. It shows the following.
1. The atomic hydrogen source. Atoms are produced by an RF discharge in
a cell containing molecular hydrogen at a low pressure (1 Pa).
2. The magnetic selection. An inhomogeneous magnetic ﬁeld produced by
a hexapolar magnet along the beam axis allows selection of the atoms
according to their hyperﬁne state. The atoms in the upper (F = 1) hy-
perﬁne state are recalled toward the axis of the device, while the atoms
in the lower (F = 0) hyperﬁne state are repelled out of the axis; only the
atoms in the upper level are focused on the entrance of a teﬂon6-coated
bulb.
3. The region where the dilute cloud of atoms with a permanent popula-
tion diﬀerence stands. The teﬂon-coated quartz bulb is located inside
the cavity tuned to the hyperﬁne transition frequency. The atoms in the
hyperﬁne state F = 1 that have entered this bulb stay in it for about
6 Teﬂon is the brand name of a polytetraﬂuoroethylene (PTFE), a polymer of
ﬂuorinated ethylene. It is very non-reactive, and only very weakly perturbs the
hydrogen atoms undergoing a collision on the wall of the coated bulb. DuPont
patented it in 1941 and registered the Teﬂon trademark in 1944.
www.ebook3000.com

2.3 Atomic Frequency Standards
29
Fig. 2.15. Production of the maser eﬀect
one second and emit a photon at the transition frequency by stimulated
emission.
The atomic radiation is coupled to the output by a loop or an antenna in
the cavity. The power of this output signal is of the order of 10−13 W. This
is enough to insure a good phase locking of the local oscillator (5 MHz,
for instance) to its phase.
The atomic beam is in a vacuum chamber that is as good as possible, and the
region where the atoms emit the maser radiation is protected from spurious
magnetic ﬁeld by magnetic shields.
The width of the emitted line is limited by the time of the interaction of
the atoms and of the radiation itself, which is of the order of one second.
The Electronic Package
The functions of this part of the device are
1. to control the physical phenomenon production: the atomic hydrogen
source, the vacuum chamber, the temperature control of the cavity, the
magnetic ﬁeld, etc.; and
2. to receive the signal emitted by the atoms and to use it in order to confer
its stability and accuracy to the local oscillator.

30
2 The Two Parts of an Oscillator
Fig. 2.16. Phase locking of the local oscillator on the atomic emission.
Contrary to the passive frequency standard (such as the cesium beam) where
no atomic oscillation exists, it is possible to lock the phase of the local os-
cillator to that of the atomic radiation. This phase locking ensures the best
values of the accuracy and stability of the local oscillator.
The electronic package is consequently made of
–
a super heterodyne receiver that down converts the signal emitter by the
atoms, transferring its frequency to a lower value by frequency mixing,
–
a servo control of the phase of the local oscillator by the phase of the
down-converted signal.
An example of this electronic package is shown in Fig. 2.16.
2.3.5 The Atomic Fountain
This kind of device [45, 69, 29], is quite similar to the cesium beam frequency
standard described in Sect. 2.3.3. The main, and most important, diﬀerence
Fig. 2.17. Schematic diagram of an atomic fountain
www.ebook3000.com

2.3 Atomic Frequency Standards
31
lies in the fact that, in order to reduce the line width of the atomic transition,
the mean velocity of the atoms in the cavity is greatly reduced by laser
manipulation [103]. A cloud of very cold atoms is sent upward periodically,
with a very low speed [70]. The trajectories of the atoms are parabolic and
a given atom passes twice throw a single cavity: the ﬁrst time upward and
the second one downward, as shown in Fig. 2.17. As for the thermal beam,
each atom consequently undergoes interaction with the probing transition
twice.
Due to the very low mean velocity, the time interval T between the two
interactions is much longer than in the case of a thermal beam and the line
width is consequently reduced in the same proportion. Moreover, the velocity
distribution of the atoms is greatly reduced, which simpliﬁes the evaluation
of the accuracy of the device.
The Physical Phenomenon
The schematic diagram of the detection of the hyperﬁne transition involving
an atomic fountain of cesium is shown in Fig. 2.17.
Preparation of the Atoms
Atoms are cooled [103] by laser beams in a low pressure cesium vapor cell,
producing optical molasses [82].
Clouds of atoms are periodically launched upwards with a velocity of a few
m × s−1. Inside the moving cloud, the temperature of the atoms is lowered
to a value of the order of 10−6 K. Atoms in the clock level F = 3 are selected
by microwave and light pulses.
Probing of the Transition
Due to the low mean velocity of the atoms and the low velocity dispersion
in each cloud, the mean value of the transition probability of the atoms that
have passed twice in the probing cavity is
–
much narrower: the full width of the central resonance is of the order of
1 Hz,
–
very close of the transition probability of a monokinetic beam.
The calculated resonance curve is shown in Fig. 2.18 with the following values
of the parameters:
–
the mean value of the transit time in the cavity is t = 1 s,
–
the time interval between the two passes in the cavity is T = 20 × t,
–
the most probable speed in the atomic cloud is 1.5×10−2, the mean speed
of the cloud when it passes throw the cavity,
–
the Rabi frequency is b = 10 s−1.

32
2 The Two Parts of an Oscillator
Fig. 2.18. Calculated Ramsay fringes in an atomic fountain
The velocity dispersion appears as a weak modulation of the fringes, instead
of blurring them as in the case of a thermal atomic beam; many fringes are
visible and one must pay attention to lock the local oscillator on the central
one.
The experimental Ramsey fringes reported, for instance, in [30, 29,
125, 45, 69, 57] and [101] are quite similar to the calculated result of
Fig. 2.18.
The Electronic Package
Like in the thermal cesium beam frequency standard, the functions of the
electronic part of the cesium fountain frequency standard are as follows:
1. The control of the all physical experiment: cooling of the atoms, prepa-
ration of the atoms in one hyperﬁne level, launching of the atomic cloud.
2. The synthesis of the microwave excitation from the local oscillator.
3. The detection of the atoms that have undergone the transition.
4. The correction of the frequency of the local oscillator.
They are qualitatively identical to the functions of the electronic part of the
thermal beam.
Nevertheless, an important diﬀerence results from the fact that the beam
is pulsed: the atomic response is a discrete-time process, which leads to alias-
ing of the noise spectral density that must be taken into account (the Dick
eﬀect [42, 9, 84]).
This is discussed in Sect. 3.3.
www.ebook3000.com

3 Control of the Local Oscillator Frequency
It was pointed out in Chap. 2 that the quality of the oscillator depends on
two kinds of factors:
1. those related to the physical phenomenon involved in the ﬁrst part of the
device, and
2. those related to the processing of the data given by the physical phe-
nomenon in the second part of the device.
The ﬁrst family is not within the scope of this book, but ﬁxes the ultimate
values of the metrological parameters of the device.
The second one must be optimized in order to obtain properties that are
as close as possible to the ultimate ones.
As shown by the examples of Chap. 2, there are many diﬀerent situations,
but in each case
–
a signal whose frequency f1 is close to the frequency of the reference
transition is generated from the local oscillator,
–
an error signal results from a comparison of the frequency f1 and the
frequency of the clock transition, and
–
this error signal allows the control of the frequency of the local oscillator.
Three representative situations will be studied and they represent the three
examples of Sect. 2.3.
In the three cases, in order to optimize the properties of the atomic fre-
quency standard, it is necessary to evaluate the frequency or/and phase noise
of the controlled local oscillator, related to the possible sources of frequency
or/and phase noise.
3.1 Active Frequency Standard
In this case (see Sects. 2.3.1 and 2.3.4), the atoms emit the reference signal
and the phase of the local oscillator is controlled by the phase of this atomic
signal.
Figure 2.16 shows an example of the phase control of the local oscillator
by the atomic frequency in the case of the hydrogen maser.

34
3 Control of the Local Oscillator Frequency
3.1.1 The Phase Control Loop
We will focus our attention on a typical phase servo control loop such as the
one shown in Fig. 2.16.
In such a loop:
1. a signal at a frequency close to the frequency of the atomic signal is
coherently generated from the local oscillator to be controlled,
2. the phase diﬀerence between that signal and the atomic signal is con-
verted to a voltage error signal) by a phase comparator, and
3. this voltage is processed by an electronic circuit (ﬁlter) and is applied to
the control input of the local oscillator in order to minimize the phase
diﬀerence.
The frequency delivered by the local oscillator is the superposition of
1. its nominal value fLO, independent of time;
2. the correction produced by the voltage applied on its control input,
a function of time; and
3. its frequency noise δfLO, a function of time characterized by its Fourier
transform δfLO(ν) and its spectral density (see Sect. 6.2.2).
The frequency delivered by the atoms is the superposition of
1. its theoretical frequency f0, independent of time;
2. its frequency noise δf0, a function of time characterized by its Fourier
transform δf0(ν) and its spectral density (see Sect. 6.2.2); and
3. the frequency shifts and frequency oﬀsets δfsh produced by the environ-
ment of the atoms.
The instantaneous frequency fout(t) delivered by the device is the instanta-
neous frequency of the local oscillator.
Making the assumption that the instantaneous frequency of the signal
produced by the frequency synthesis equals the instantaneous frequency of
the local oscillator multiplied by the constant n = f0/fLO, whose value is
exactly ﬁxed by the electronic device, the control loop can be represented as
in Fig. 3.1.
In fact, the phase comparator delivers a voltage proportional to the phase
diﬀerence between its two inputs + and −. The quantity of interest is conse-
quently the phase rather than the frequency and the loop can be drawn with
the phase as the input and output quantities (Fig. 3.2).
The block 1/ν appearing in this ﬁgure corresponds to the integration op-
erator that converts the frequency correction produced by the voltage applied
on the frequency control input of the local oscillator to the phase correction of
the signal delivered by this local oscillator. The phases φLO and φ0 correspond
to the nominal (and consequently constant) values of the frequencies deliv-
ered by the local oscillator and the atoms, respectively. The time-dependent
parts are described by the noise sources and the oﬀset and shifts source.
The gain of this multiple input loop can be calculated for each input.
The parameters of the components of the loop are as follows.
www.ebook3000.com

3.1 Active Frequency Standard
35
Fig. 3.1. Phase lock loop for the diﬀerent components of the signals
Fig. 3.2. The phase lock loop with the phase as the quantity of interest

36
3 Control of the Local Oscillator Frequency
1. The phase comparator. This receives the phases φ+ and φ−on its inputs
+ and −, respectively, and returns the voltage vpc = kpc × (φ+ −φ−).
The signal derived from the local oscillator is applied on its input φ−and
the atomic signal is applied on its input φ+.
2. The electronic circuit processing the voltage delivered by the phase com-
parator. This is a low-pass ﬁlter whose frequency response is H(ν).
3. The frequency control of the local oscillator. This produces a correction
δfcon to the local oscillator frequency. This correction is proportional to
the voltage ve applied on the frequency control input:
δfcon = K × ve .
3.1.2 Gain for the Frequency Noise of the Local Oscillator
The equivalent set-up for this input is shown in Fig. 3.3.
Its frequency response is
φout(ν)
δφLO(ν) =
ν
ν + nkpcKH(ν) .
(3.1)
In a general way, H(ν) is a low-pass ﬁlter, its amplitude response G(ν) is
maximal and equals H0 for the null Fourier frequency and is proportional to
1/νo, where o is the order of the ﬁlter, for values of the Fourier frequency
much larger than the cut-oﬀfrequency of the ﬁlter νc.
Consequently, the amplitude response of the control loop for the phase
noise of the local oscillator is

φout(ν)
δφLO(ν)
 =

ν/(ν + nkpcKH0)
(ν ≪νc)
1
(ν ≫νc)
.
(3.2)
Fig. 3.3. Equivalent set-up for the local oscillator noise
www.ebook3000.com

3.1 Active Frequency Standard
37
In conclusion, the phase noise of the local oscillator is totally transmitted
to the output of the device for values of the Fourier frequency much larger
than the cut-oﬀfrequency of the ﬁlter and is strongly reduced for the values
of the Fourier frequency much smaller than that cut-oﬀfrequency. It cancels
exactly for ν = 0.
3.1.3 Gain for the Frequency Noise of the Atomic Signal
The equivalent set-up for this input is shown in Fig. 3.4. Its frequency re-
sponse is
φout(ν)
δφ0(ν) =
kpcKH(ν)
ν + nkpcKH(ν) .
(3.3)
With the same ﬁlter as above, the asymptotic values of the amplitude re-
sponse are the following:

φout(ν)
δφ0(ν)
 =
⎧
⎨
⎩
kpcKH0
ν + nkpcKH0
≈1
n
(ν ≪νc)
0
(ν ≫νc)
.
(3.4)
In conclusion, the phase noise of the atomic signal is totally transmitted (di-
vided by n, the ratio of the atomic signal and the local oscillator frequencies)
to the output of the device for low values of the Fourier frequency. It is on
the contrary totally blocked for the high values of the Fourier frequency.
Fig. 3.4. Equivalent set-up for the noise of the atomic signal

38
3 Control of the Local Oscillator Frequency
3.1.4 Phase Noise of the Output
The phase noise (and consequently the frequency noise) of the signal delivered
by the active atomic frequency standard is imposed either by the atomic
emission or by the local oscillator, according to the Fourier frequency range
as follows:
–
the phase noise of the atomic signal is dominant in the output for the low
values of the Fourier frequency, and
–
the phase noise of the local oscillator is dominant in the output for large
values of the Fourier frequency.
The Fourier frequency ν0 for which the two contributions are equal is deﬁned
by the choice of the low-pass ﬁlter. The value of ν0 is given as
ν0
ν0 + nkpcK |H(ν0)| × |δφLO(ν0)| =
kpcK |H(ν0)|
ν0 + nkpcK |H(ν0)| × |δφ0(ν0)| , (3.5)
kpcK |H(ν0)| = ν0
|δφLO(ν0)|
|δφ0(ν0)| .
(3.6)
3.1.5 Frequency Error
Apart from the eﬀect of the noise sources, it is important to evaluate the
static frequency error of the device, i.e. the diﬀerence between the output
frequency (neglecting the eﬀect of the various noise sources) and the atomic
transition frequency.
This is done by calculating the frequency response of the loop at the null
Fourier frequency for the nominal frequency of the local oscillator and that
of the atomic signal.
This loop is shown in Fig. 3.5. The blocks with a transfer function ν
and 1/ν correspond to the conversions phase →frequency and frequency →
phase. The following frequency responses are deduced from this loop:
fout
f0
=
kpcKH(ν)
ν + nkpcKH(ν)

ν=0
= 1
n ,
(3.7)
fout
fLO
=
ν
ν + nkpcKH(ν)

ν=0
= 0 .
(3.8)
In conclusion
1. the frequency of the atomic oscillation is exactly transferred on the output
of the device, and
2. the static nominal frequency of the local oscillator is totally rejected.
www.ebook3000.com

3.1 Active Frequency Standard
39
Fig. 3.5. The loop for the nominal frequency of the local oscillator and of the
atomic oscillator
3.1.6 The Best Choices
The frequency responses for the diﬀerent noise sources allow choosing the best
components of the device to reduce as much as possible their contribution to
the frequency noise of the output signal.
The Local Oscillator
1. The previous analysis shows that the short term stability of the active
atomic frequency standard (which is limited by the frequency noise for
the high values of the Fourier frequency) is ﬁxed by the phase noise of the
local oscillator. It is consequently necessary to choose a local oscillator
with good short term stability.
2. It also shows that the stability of the atomic oscillation is transferred on
the output signal of the device for the Fourier frequencies smaller than
the value ν0 deﬁned by (3.6).

40
3 Control of the Local Oscillator Frequency
Consequently, for this reason also, it is necessary to choose a local oscil-
lator with a low level of phase noise δφLO(ν).
The Phase Control Loop
For the small values of the Fourier frequency, the eﬀect of the local oscillator
phase noise on the phase noise of the output is reduced by the factor
ν
ν + |nkpcKH0| .
(3.9)
It is consequently necessary to have the largest value possible for the zero-
frequency amplitude response |H0| of the low-pass ﬁlter of the loop.
For instance, the phase noise of the good commercial 5 MHz quartz oscil-
lator [98] is given in Table 3.11.
The phase noise spectral density of this quartz oscillator for Fourier fre-
quencies close to 1 Hz is consequently
pQ
δφ(ν) = 6.32 × 10−12 × ν−2 Hz−1 .
(3.10)
The frequency noise spectral density is consequently (see (6.101)):
pQ
δf(ν) = ν2 × pQ
δφ(ν)
(3.11)
= 6.32 × 10−12 Hz .
(3.12)
This is a white frequency noise.
The reduced frequency noise spectral density of the quartz oscillator is
pQ
y = pQ
δf(ν)/f Q
0
2
(3.13)
= 2.53 × 10−25 Hz−1 .
(3.14)
This corresponds to the reduced white frequency noise pQ
y (ν) = hQ
0 with
hQ
0 = 2.53 × 10−25 Hz−1 (see Table 6.1).
On the other hand, the typical value of the Allan variance of a hydrogen
maser for sampling times around 1 s is
σ2
y(τ) = 1 × 10−26 × τ −2 ,
(3.15)
which corresponds to a reduced frequency noise pH
y (ν) = hH
2 ν2 with hH
2 ≈
10−26 Hz−1.
In order to impose, for instance, that the Fourier frequency for which the
spectral density of the frequency noise of the local oscillator and that of the
1 The values are given in dBc, deﬁned by L(ν) = 10 log[0.5(Sφ(ν))] where Sφ(ν)
is the phase noise spectral density in units of Hz−1.
www.ebook3000.com

3.2 Passive Frequency Standard
41
Table 3.1. Phase noise of a commercial quartz oscillator
Fourier frequency (Hz)
Spectral density (dBc)
Spectral density (Hz−1)
1
−115
6.32 × 10−12
10
−135
6.32 × 10−14
100
−145
6.32 × 10−15
1 000
−150
2.00 × 10−12
spectral density of the frequency noise of the atomic oscillation give the same
contribution to the output of the device be 1 Hz, application of (3.6) gives
kpcK |H(ν)|ν=1 Hz = |δφLO(ν)|
|δφ0(ν)|

ν=1 Hz
= 25.3 .
(3.16)
If kpc (the response of the phase comparator) and K (the response of the volt-
age control of the local oscillator) are given, this relation imposes a minimal
value for the amplitude response of the low-pass ﬁlter at the 1 Hz frequency.
3.2 Passive Frequency Standard
In this case (see Sect. 2.3.1), the atomic collection is too dilute to emit the
reference signal. The clock transition is probed by a signal generated from
the local oscillator and an error signal results from the atomic response. This
error signal allows control of the frequency of the local oscillator.
Consequently, the frequencies but not the phases of the local oscillator and
of the atomic transition are compared; the integration due to the conversion
frequency →phase does not appear in the loop and its performances around
the null Fourier frequency are consequently less good than in the case of the
active frequency standard.
Moreover, the frequency comparison is sensitive to the amplitude ﬂuc-
tuations of the atomic response, and consequently to the amplitude noise
aﬀecting this signal. This noise must consequently be taken into account.
Figure 2.11 shows the simpliﬁed block diagram of an electronic device
that synthesizes the frequency f1, close to the frequency fCs of the clock
transition of the cesium atom [90].
The principle of the control loop is shown in Fig 3.6: the response of the
atoms to the frequency modulated excitation is lock-in detected. The lock-in
ampliﬁer produces a voltage proportional to the diﬀerence f1 −fCs of the
frequency f1 of the probing signal and the frequency fCs of the atomic tran-
sition. This error signal is used to control the frequency of the local oscillator.
S is the transfer function of this lock-in ampliﬁer (V/Hz).
The sources of frequency noise implied in the frequency-control loop are
shown in Fig. 3.7. They are:

42
3 Control of the Local Oscillator Frequency
Fig. 3.6. Control of the frequency of the local oscillator in a passive atomic fre-
quency standard
Fig. 3.7. Model for the noise in the frequency control loop
www.ebook3000.com

3.2 Passive Frequency Standard
43
–
the intrinsic frequency noise of the local oscillator reﬂected on the ex-
citation signal as described in the case of the active atomic frequency
standard (Sect. 3.1.1);
–
the frequency noise of the atomic resonance; and
–
the amplitude noise of the atomic response.
3.2.1 Frequency Response for the Frequency Noise
of the Local Oscillator
The frequency response of the loop for the frequency noise of the local oscil-
lator is
fout(ν)
δfLO(ν) =
1
1 −nSKH(ν) .
(3.17)
The sign of the product nSK must, of course, be selected suitably in order
to ensure the stability of the loop.
As for the active atomic frequency standard (Sect. 3.1), H(ν) is the fre-
quency response of a low-pass ﬁlter. The amplitude response |H(ν)| is maxi-
mal and equals H0 for the null Fourier frequency and is proportional to 1/νo,
where o is the order of the ﬁlter, for values of the Fourier frequency much
larger than the cut-oﬀfrequency of the ﬁlter νc.
The value |H0| may be very large.
The amplitude response of the control loop for the frequency noise of the
local oscillator is

fout(ν)
δfLO(ν)
 =

|1/(1 −nSKH0)|
(ν ≪νc)
1
(ν ≫νc)
.
(3.18)
The conclusion is qualitatively the same as for the active atomic frequency
standard: the frequency noise of the local oscillator is totally transmitted to
the output of the device for values of the Fourier frequency much larger than
the cut-oﬀfrequency of the ﬁlter and is strongly reduced for the values of the
Fourier frequency much smaller than that cut-oﬀfrequency.
Nevertheless, it is to be noticed that the contribution of the local oscillator
to the output frequency noise for the low values of the Fourier frequency is
not totally rejected.
3.2.2 Frequency Response for the Frequency Noise
of the Atomic Resonance
The frequency response of the loop for the frequency noise of the atomic
resonance is
fout(ν)
δf0(ν) =
−SKH(ν)
1 −nSKH(ν) .
(3.19)

44
3 Control of the Local Oscillator Frequency
With the same ﬁlter as above, the limits are the following for the amplitude
response:

fout(ν)
δf0(ν)
 =

|SKH0/(1 −nSKH0)| ≈1/n
(ν ≪νc)
0
(ν ≫νc)
.
(3.20)
The conclusion is qualitatively the same as for the active atomic frequency
standard: the frequency noise of the atomic signal is totally transmitted (di-
vided by n, the ratio of the atomic signal and the local oscillator frequencies)
to the output of the device for low values of the Fourier frequency. On the
other hand, it is totally blocked for high values of the Fourier frequency.
3.2.3 Frequency Response for the Amplitude Noise
of the Atomic Resonance
This contribution must be considered because amplitude ﬂuctuations of the
atomic signal are directly transmitted to the output of the lock-in ampliﬁer.
The frequency response of the loop for this input is
fout(ν)
δa(ν) =
KH(ν)
1 −nSKH(ν) .
(3.21)
The eﬀect of amplitude noise a(ν) of the atomic response is consequently the
same as a frequency noise δfa(t) aﬀecting the atomic frequency. The Fourier
transform of this frequency noise is deﬁned by
δfa(ν) = −1
S × δa(ν) .
(3.22)
This frequency noise is totally transmitted on the output of the device (di-
vided by n, the ratio of the atomic signal and the local oscillator frequencies)
and is often the main limitation on the frequency stability.
3.2.4 Limitation to the Stability Due to the Amplitude Noise
of the Atomic Response
Assuming a white amplitude noise aﬀecting the atomic response,
pa(ν) = a0 .
(3.23)
The spectral density pa
out(ν) of the resulting frequency noise for the low
Fourier frequencies is
pa
out(ν) = pa(ν) ×
1
n2S2
(3.24)
=
a0
n2S2 .
(3.25)
www.ebook3000.com

3.2 Passive Frequency Standard
45
If this contribution is the dominant one, the resulting Allan variance is
(see (6.182))
σ2
y(τ) =
a0
2n2S2 × n2
f 2
0
× τ −1
=
a0
2f 2
0 S2 × τ −1 .
(3.26)
On the other hand, the transfer function S (the slope of the discriminator
equivalent to the resonance probing) can be calculated, knowing the detail of
the probing process (see, for instance [90, 112]).
In all cases, the slope S of the frequency discriminator is
–
proportional to the height sin2(bt) of the central fringe of the Ramsey
pattern, as deﬁned in (2.6); and
–
inversely proportional to the width 1/2T of this fringe, as deﬁned in (2.7).
The Rabi frequency b is proportional to the amplitude of the magnetic ﬁeld
in the cavity
b = µB
ℏ,
(3.27)
where t is the interaction time of the atoms with the excitation in each
region of the cavity and T is the transit time of the atoms between the two
interaction regions of the cavity. The Allan variance corresponding to this
frequency noise of the output signal (whose frequency is f0/n) is
σ2
y(τ) =
a0
8T 2f 2
0 sin4(bt) × τ −1 .
(3.28)
This relation shows the importance of the optimization of the product bt and
of the value of the transit time T , which must be as large as possible.
The value of this contribution to the Allan variance of the device output
signal varies like τ−1: when τ becomes larger and larger, it is masked by
another contribution that decreases less quickly with τ.
The ﬁrst contribution to be considered is one that should give an Allan
variance independent of τ (τ 0).
Table 6.3 shows that it corresponds to a frequency noise whose spectral
density is h−1
ν−1 (ﬂicker noise). Flicker noise is the long-term limitation
of cesium frequency standards.
Table 3.2. Guaranteed values of the Allan deviation of a commercially available
cesium frequency standard
Averaging time τ (s)
Allan deviation
101 ≤τ ≤4.32 × 105
2.7 × 10−11/√τ
4.32 × 105 ≤τ ≤2.59 × 106
5.0 × 10−14

46
3 Control of the Local Oscillator Frequency
For instance, the commercial frequency standard [2, 113] shows some guar-
anteed values of Allan variance (see Table 3.2). These values show the contri-
bution of the white amplitude noise aﬀecting the atomic signal and the limit
due to ﬂicker noise (ﬂicker ﬂoor).
Another example is given by the primary frequency standards [90] whose
Allan deviation is σy(τ) = 3.5 × 10−13/√τ for 60 s ≤τ ≤1 × 105 s.
3.2.5 Frequency Error
Neglecting the noise sources, it is important to evaluate the static frequency
error of the device, i.e. the diﬀerence between the output frequency (sup-
posedly not aﬀected by the various noise sources) and the atomic transition
frequency. This is done by calculating the frequency response of the loop at
the null Fourier frequency for the nominal frequency of the local oscillator
and for that of the atomic signal.
This loop is shown in Fig. 3.8. The following frequency responses result:
fout
f0
=
SKH(ν)
1 + nSKH(ν)

ν=0
≈1
n ,
(3.29)
fout
fLO
=
1
1 + nSKH(ν)

ν=0
≈
1
nSKH0
.
(3.30)
Fig. 3.8. The loop for the nominal frequency of the local oscillator and of the
atomic transition
www.ebook3000.com

3.2 Passive Frequency Standard
47
In conclusion:
1. The frequency of the atomic oscillation is not exactly transferred on the
output of the device. The relative error is

fout −f0/n
f0/n
 =
1
|SKH0| .
(3.31)
This error is smaller if the static gain of the low-pass ﬁlter is higher.
2. The static nominal frequency of the local oscillator is not totally rejected.
The attenuation factor is nSKH0. It is larger if the static gain of the low-
pass ﬁlter is higher.
These conclusions show the need to obtain the static gain of the low-pass
ﬁlter as high as possible.
3.2.6 The Best Choices
The conclusions relative to the design of the loop are qualitatively the same
as in the case of the active atomic frequency standard.
The Local Oscillator
1. The short term stability of the active atomic frequency reference is limited
by the phase noise of the local oscillator. It is consequently necessary to
choose a local oscillator with good short-term stability.
2. Assuming that the amplitude noise aﬀecting the atomic response is the
limitation of the dominant process, the stability of the atomic oscillation
is transferred to the output signal of the device for Fourier frequencies
smaller than the value ν0 deﬁned by
|a(ν0)KH(ν0)| = |δfLO(ν0)| .
(3.32)
In order to obtain the largest value of this frequency, the frequency noise
level of the local oscillator must be as low as possible.
The Phase Control Loop
The eﬀect of the local oscillator frequency noise on small values of the Fourier
frequency is reduced by the factor
1
|1 + nSKH0| .
(3.33)
It is consequently necessary to have the largest value possible for the zero-
frequency amplitude response |H0| of the low-pass ﬁlter of the loop.

48
3 Control of the Local Oscillator Frequency
3.3 The Sampled Servo-loop
Some passive atomic frequency standards involve a sampled-and-hold error
signal.
1. If the modulation of the excitation frequency is a square wave, the tran-
sient atomic response occurring during a ﬁrst part of each half period
is ignored and the permanent state response is integrated during the re-
maining of each half-period of modulation. Two successive results are
used to construct the value of the error signal at times nTl, where Tl is
the period of the square wave modulation.
2. Some devices such as atomic fountains (see Sect. 2.3.5) or stored ions
bring into play a temporal sequence: preparation – excitation – interro-
gation. The response is consequently a discrete-time signal whose value
is known only at the end of each temporal sequence of duration Tl.
In this family of devices, aliasing of the noise spectra may be produced by
the sample-and-hold operator (the Dick eﬀect [42, 9, 84]) and must be taken
into account.
3.3.1 Model of the Servo-loop in the Case of an Atomic Fountain
This kind of atomic frequency standard is described in Sect. 2.3.5.
We call Tl the sampling interval, i.e. the time interval between two suc-
cessive launchings of cold atoms by the atomic source.
The local oscillator is free running between two successive sampling times
(the voltage frequency control of the local oscillator is hold) and corrections
are updated at the times nTl, i.e. the times when an atomic cloud is detected
at the end of a cycle preparation – excitation – interrogation.
Figure 3.9 shows the frequency lock loop of Fig. 3.7 where the error signal
delivered by the frequency discriminator is sampled and held at times nTl.
The sampler and hold is an operator that strongly aﬀects the Fourier
transform (and consequently the spectral density) of any process whose fre-
quency range extends beyond the Nyquist frequency (which is half of the
sampling frequency 1/2Tl).
Assuming a continuous-time process f(t) whose Fourier transform is F(ν),
the Fourier transform F ′(ν) of the continuous-time process resulting from
sampling-and-hold f(t) is (see (B.63))
F ′(ν) = exp(−jπνTl) × sinc(πνTl) ×
∞

k = −∞
F(ν + k/Tl) .
(3.34)
The Fourier component of frequency ν > 1/2Tl is consequently modiﬁed by
this process.
In order for this eﬀect to be handled easily, the loop can be described by
two simpliﬁed models, each one being applied in a diﬀerent Fourier frequency
range.
www.ebook3000.com

3.3 The Sampled Servo-loop
49
Fig. 3.9. Sampling in the loop of Fig. 3.7
1. Model for the high values of the Fourier frequency, which are strongly
attenuated by the low-pass ﬁlter. These frequencies consequently exist
only between every source that produces them in the set-up described
in Fig. 3.9 and the low-pass ﬁlter, and also between the sampling-and-
hold and the low-pass ﬁlter, since this device produces high frequency
components.
2. Model for the low values of the Fourier frequency. These frequencies ex-
ist in the whole set-up of Fig. 3.9. The low-pass ﬁlter is such that this
frequency range is supposed to be inside the range [−1/Tl, 1/Tl] and is
not modiﬁed by the sampling-and-hold operation.
3.3.2 Frequency Responses for the Frequency Noise
of the Local Oscillator
The loop for the local oscillator frequency noise is shown in Fig. 3.10.
In the simpliﬁed model described in Sect. 3.3.1, the noise emitted by
the local oscillator frequency noise source, not yet ﬁltered by the low-pass
ﬁlter, may contain frequency components larger than the Nyquist frequency.
Consequently, frequency aliasing of the frequency noise of the local oscillator
occurs and must be taken into account.
On the other hand, the node f1 (Fig. 3.10) contains no Fourier component
outside the Nyquist range. The Fourier components outside the Nyquist range

50
3 Control of the Local Oscillator Frequency
Fig. 3.10. The sampled loop for the local oscillator frequency noise
on node fout are consequently only due to the frequency noise source and the
following equation can be written for the nodes fout and f1.
1. For the low frequency range
fout(ν) = δfLO(ν) + f1(ν) ,
(3.35)
f1(ν) = −GOL(ν)
⎡
⎣fout(ν) +

k ̸= 0
δfLO(ν + k/Tl)
⎤
⎦.
(3.36)
2. For the high frequency range
fout(ν) = δfLO(ν) ,
(3.37)
f1(ν) = 0 .
(3.38)
GOL(ν) is the loop gain
GOL(ν) = −nSH(ν)Ksinc(πνTl) exp(−jπνTl) .
(3.39)
In conclusion, for very low values of the Fourier frequency ν (such that
|GOL(ν)| ≫1)), the direct contribution of the local oscillator frequency noise
vanishes, but the eﬀect of frequency aliasing due to the sampling brings the
contribution
fout(ν) ≈

k ̸= 0
δfLO(ν + k/Tl) .
(3.40)
Special care must be taken to reduce this contribution by choosing the local
oscillator. This local oscillator is often a hydrogen maser (see [57] for an
example). On the other hand, for large values of the Fourier frequency, (3.37)
shows that the frequency noise of the local oscillator is totally transmitted
on the output of the device.
www.ebook3000.com

3.3 The Sampled Servo-loop
51
3.3.3 Frequency Response for the Amplitude Noise
of the Atomic Transition
In the simpliﬁed model (see Sect. 3.3.1), the loop can be described according
to the Fourier frequency range by (see Fig. 3.11) one of the two following sets
of equations:
1. For the low frequency range
fout =
⎡
⎣δa(ν) + f1(ν) +

k ̸= 0
δa(ν + k/Tl)
⎤
⎦
× KH(ν)sinc(πνTl) exp(−jπνTl) ,
(3.41)
f1(ν) = fout(ν)nS ,
(3.42)
which gives
fout(ν) = KH(ν)sinc(πνTl) exp(−jπνTl)
1 + GOL(ν)

∞

k = −∞
δa(ν + k/Tl)

.
(3.43)
GOL(ν) is the loop gain
GOL(ν) = −nSH(ν)KTlsinc(πνTl) exp(−jπνTl) .
(3.44)
2. For the high frequency range
fout(ν) = 0 .
(3.45)
In conclusion, the eﬀect of the amplitude noise of the atomic response cancels
for high values of the Fourier frequency, as is the case for a continuous-time
loop.
Fig. 3.11. The sampled loop for the amplitude noise

52
3 Control of the Local Oscillator Frequency
On the other hand, the eﬀect of the amplitude noise, which is dominant
for low values of the Fourier frequency (long-term stability), is ampliﬁed by
aliasing as shown in (3.43).
With the same simpliﬁed model applied to the set-up of Fig. 3.12, the
following equations can be written:
1. For the low frequency range
fout =
⎡
⎣−Sδf0(ν) + f1(ν) −S

k ̸= 0
δf0(ν + k/Tl)
⎤
⎦
× KH(ν)sinc(πνTl) exp(−jπνTl) ,
(3.46)
f1(ν) = fout(ν)nS ,
(3.47)
which gives
fout(ν) = −SKH(ν)sinc(πνTl) exp(−jπνTl)
1 + GOL(ν)
×

∞

k = −∞
δf0(ν + k/Tl)

,
(3.48)
GOL(ν) is the loop gain
GOL(ν) = −nSH(ν)KTlsinc(πνTl) exp(−jπνTl) .
(3.49)
2. For the high frequency range
fout(ν) = 0 .
(3.50)
In conclusion, the eﬀect of the frequency noise is qualitatively the same as
the eﬀect of the amplitude noise, with the factor −S: it cancels for the high
frequency range and is worsened by aliasing for the low frequency range.
Fig. 3.12. The sampled loop for the frequency noise of the atomic transition
www.ebook3000.com

Part II
Characterization of Very High Performances
Oscillators

High performance frequency sources allow one to achieve measurements lead-
ing to a best knowledge of our world, from a very concrete and practical point
of view as well as a fundamental one.
If a given application involves a speciﬁed high performance frequency
source, it is important to decide the following:
–
whether the speciﬁcation can be achieved using an existing frequency
source, and
–
what kind of frequency source is the best choice to fulﬁll the objective.
This ﬁrst stage in the design of the application implies a perfect knowlege of
the performances and limitations of the frequency sources.
These performances are characterized by a few parameters whose signiﬁ-
cation must be well understood. They are as follows:
–
stability, with the indication of the time duration on which the given value
is measured,
–
accuracy,
–
reproducibility, and
–
sensitivity to the environment.
These parameters are often described as the “metrological properties” of the
frequency source.
The following parameters, which describe the practical use of the device,
must of course also be taken into account:
–
the price,
–
the weight and physical dimensions,
–
the power consumption,
–
the reliability, and
–
the ability to run without any human intervention during a given time
interval, etc.
Only the parameters of the ﬁrst group need to be precisely described and
discussed.
The following chapters describe the accuracy, the reproducibility and the
stability of high performance frequency sources. The concepts and the mean-
ing of these parameters are described, as well as their measurements.
www.ebook3000.com

4 Accuracy
4.1 Deﬁnition
According to the deﬁnition given by NIST [96], Accuracy is the degree of
conformity of a measured or calculated value to its deﬁnition.
The accuracy of a device that produces a frequency characterizes the oﬀset
of this frequency vs. the theoretical (nominal) one.
For instance, the accuracy of a 10 MHz frequency source is deﬁned by
the diﬀerence between the value of the actual frequency of the output sig-
nal delivered by this device (for instance 9.9995 MHZ) and the nominal one
(10 MHz).
It is often expressed by a positive dimensionless number, which is the
relative oﬀset (the absolute value of the possible frequency oﬀset divided by
the nominal value).
For the 10 MHz oscillator whose real frequency is, for instance, 9.9995 MHz,
the accuracy is
Ac = |10 −9.9995|
10
= 5 × 10−4 .
The accuracy of a device that produces a time-scale is the diﬀerence between
a measured on-time pulse and an ideal on-time pulse that coincides exactly
with UTC.
This accuracy is expressed in seconds: if the time diﬀerence between the
pulse produced by the time-scale device and UTC is one microsecond, the
accuracy equals 1 µs.
Notice that the smaller the number giving the accuracy, the better the
device. For this reason, the term uncertainty is most often used when a quan-
titative measure is stated. Accuracy is used in a qualitative sense.
In fact, uncertainty is a statistical data, which characterizes the statistical
result of the various errors aﬀecting the value of the frequency delivered by
the device. It is quite diﬀerent from an oﬀset, which may be easily corrected.
4.2 Estimation of the Uncertainty of a Frequency Source
In order to evaluate the uncertainty of the frequency emitted by a given
device, one must do the following [64, 63]:

58
4 Accuracy
1. Identify the components contributing to the uncertainty, i.e. the phenom-
ena that produce a departure of the frequency of the oscillator from its
nominal value.
2. Quantify these individual components. This quantiﬁcation can be per-
formed according to two types of methods.
–
The type A evaluation of uncertainty, which uses statistical methods
(statistical uncertainties).
–
The type B evaluation of uncertainty, using non-statistical methods
(systematic uncertainties). In the case of frequency standards, type B
uncertainties are evaluated by calculating or measuring the frequency
oﬀset produced by the phenomenon that perturbs the oscillator fre-
quency and the uncertainty which aﬀects this calculation or measure-
ment.
3. Combine these components in order to quantitatively characterize the
overall uncertainty of the frequency. This is the quadrature sum of the
uncertainties.
This estimation is called the uncertainty budget of the frequency standard.
As an example, consider the uncertainty budget of the primary frequency
standard NIST-F1, as described in [58] and [57].
The physical eﬀects that are taken into account are brieﬂy described be-
low. For each of them, the magnitude and uncertainty of the frequency bias
it produces are studied and the results are given.
1. Gravitational redshift (type B). This relativistic eﬀect is discussed in
Sect. 7.1.1. Its precise evaluation depends on the knowledge of the po-
sition of the frequency standard compared to the geoid. The value of
the fractional frequency bias reported in [57] is 180.54 × 10−15 and an
uncertainty on this value of 0.03 × 10−15.
2. The second-order Zeeman eﬀect (type B). This eﬀect is the frequency
bias produced by the weak and well-controlled magnetic ﬁeld applied on
the atoms [139, 34, 136]. In the case of [57], the fractional frequency bias
is 36.53 × 10−15 and its uncertainty is 0.02 × 10−15.
3. Blackbody radiation (type B). The perturbation created by the oscil-
latory electrical ﬁeld due to black body radiation at the cavity tem-
perature T shifts the atomic energy levels [91]. The fractional fre-
quency bias calculated in [57] is −21.21 × 10−15 and its uncertainty is
0.26 × 10−15.
4. Spin exchange (type A). This frequency shift is produced by the colli-
sions between the atoms. Due to the low atomic density, the eﬀect is
weak: −0.42 × 10−15 and its uncertainty is 0.10 × 10−15.
5. Microwave leakage (type A). This eﬀect arises if microwave radiation
gets in the atom trajectory outside the interaction region. This ef-
fect contributes to both frequency inaccuracy and long-term instabil-
ity since is not stable. Its mean value is null, the uncertainty is 0.20 ×
10−15.
www.ebook3000.com

4.2 Estimation of the Uncertainty of a Frequency Source
59
6. ac Zeeman eﬀect (type B). This Zeeman eﬀect is due to the (weak) mag-
netic ﬁeld produced by the heaters of the device. The fractional frequency
bias is 0.05 × 10−15, with an uncertainty of 0.05 × 10−15.
7. Cavity pulling (type B). The mistuning of the resonant cavity where
the atoms interact with the probing microwave radiation “pulls” the fre-
quency of the transition, producing a frequency bias of 0.02×10−15, with
an uncertainty of 0.02 × 10−15.
8. Rabi and Ramsey pullings (type B). These eﬀects are due to the cesium
atom ground state lines other than the clock lines [39, 38, 78]. Both ef-
fects are very weak in the case of [57]: frequency pulling and uncertainty
of 1 × 10−19.
9. Majorana transitions (type B). These transitions are caused by direc-
tional changes in the magnetic ﬁelds seen by the atoms along their tra-
jectories [89, 123]. In the device of [57], the eﬀect is weak, 0.02 × 10−15,
with an uncertainty of 0.02 × 10−15.
10. Fluorescence light shift (type B). Before and after being probed by the
microwave signal, the atoms are prepared and manipulated by various
optical excitation. Any optical signal coming from these optical manipu-
lations (for instance the ﬂuorescence signal produced by the atoms them-
selves) modiﬁes the atomic levels of the atoms being tested. In the case
of an atomic fountain such as that of [57], the optical excitations are
light-oﬀwhen the atoms are probed, which reduces the eﬀect to a very
low and negligible level (1 × 10−20).
11. Distributed cavity phase shift (type B). This eﬀect results from the elec-
trical losses in the cavity, which induce a traveling wave component.
A value of 0.02 × 10−15 is assigned to this bias, with an identical un-
certainty.
12. The second-order Doppler eﬀect (type B). This relativistic eﬀect is pro-
portional to the ratio v2
a/c2, where va is the velocity of the atoms and
c the speed of light. It is consequently very weak in the case of an atomic
fountain: 0.02 × 10−15 in the case of [57].
13. dc Stark eﬀect (type B). This eﬀect is the splitting and shift of a spec-
tral line into several components in the presence of an electric ﬁeld [133].
This eﬀect can be due to stray dc electric ﬁelds produced by thermoelec-
tric currents, charged particles, macroscopic variations in the crystalline
structure of the walls of the device. A careful design of the device elim-
inate this source of dc Stark eﬀect. A worst-case evaluation in [57] gives
a value of 0.02 × 10−15.
14. Background gas collisions (type B). These collisions perturb the atomic
levels and produce a shift of the hyperﬁne transition frequency. This shift
has been studied for various gases [13, 6] and is proportional to the pres-
sure. In the case of [57], the residual pressure is very low and the fractional
shift is evaluated to be smaller than 0.001 × 10−15.
15. The Bloch–Siegert eﬀect (type B). This eﬀect arises when the atoms in-
teract with a non-rotating ﬁeld, which is the case for the clock transition

60
4 Accuracy
of cesium [15]. The linear polarization of the microwave ﬁeld results in
the addition of two circular polarization counter-rotating ﬁelds, one of
them producing the frequency bias. This frequency shift has been calcu-
lated [123] and gives a negligible bias: 0.0001 × 10−19.
16. RF spectral purity (type B). The microwave power spectra introduces
some frequency noise in the cavity, which can bias the frequency of the
clock transition. For this reason, high quality frequency synthesis is re-
quired to obtain negligible uncertainty [56].The value reported in [57]
is 3−18.
In [57] the combination of these components gives a total uncertainty of
0.34 × 10−15.
4.3 Typical Values
In this book, we are dealing with precise time and frequency applications.
Therefore, we will only mention the typical parameters of the devices pro-
ducing the best performances. Among them, the following two families must
be considered:
–
devices built and operated in a research laboratory and intended to have
the best properties: the primary frequency standards; and
–
devices built on a factory site, according to an industrial process, which
can be operated by non-specialized staﬀ. The accuracy and stability of
these devices are not the ultimate ones, but their implementation and
maintenance are easier and their reliability is better.
Both families of time and frequency standards are involved in the construction
of the time scales (see Sect. 7.1) and some typical values of accuracy for both
families are given below.
4.3.1 Primary Frequency Standards
Cesium atom fountains are the device which obtain the best values of uncer-
tainty. These values are given in Table 4.1. More information can be found
on the BIPM site [17].
The recently published uncertainty results of some thermal beam cesium
primary frequency standards with optical pumping are given in Table 4.2.
Many other devices are under study, some of them being optical frequency
standards. Their aim is to produce ultra-stable frequencies in the optical
range by using a narrow optical transition as a clock transition.
One kind of device uses an optical transition of the calcium atom [97, 41].
The 10−15 relative uncertainty is under way [41].
Other devices use the optical transition of a single laser-cooled 199Hg+ or
171Yb+ ion conﬁned in a radio frequency Paul trap [115, 99, 114]. Neutral
ytterbium is also studied [61].
www.ebook3000.com

4.3 Typical Values
61
Table 4.1. Some values of accuracy obtained by cesium fountains
Institute
Device name
Accuracy
References
NIST
NIST-F1
0.35 × 10−15
[57]
BNM-SYRTE
FO1
0.72 × 10−15
[124]
PTB
CSF1
1 × 10−15
[11]
IEN
CSF1
1.1 × 10−15
[83, 10]
NPL
NPL-CsF1
1.2 × 10−15
[10]
NMIJ
NMIJ-F1
4.2 × 10−15
[74]
Table 4.2. Uncertainty of a few other primary frequency standards
Institute
Device
Device name
Accuracy
References
NIST
Cesium beam
NIST-7
5 × 10−15
[112]
BNM-SYRTE
Cesium beam
JPO
6.3 × 10−15
[90, 40]
NICT
Cesium beam
CRL-O1
7 × 10−15
[55]
PRB
Cesium beam
CS1
9.5 × 10−15
[23]
4.3.2 Commercial Devices
These devices are not designed in order to attain the best values of stability
or accuracy. While keeping values of accuracy and stability compatible with
most applications, they show a reliability that allows their use in a continu-
ous way for long periods of time. For instance, the 5071A (Symmetricom) has
demonstrated an average mean time between failures (MTBF) greater than
160 000 hours (which corresponds to more than 18 years) since its introduc-
tion in 1992 [113]. This property is essential to maintain any time scale, and
is used to build TAI (see Sect. 7.1.1).
The typical accuracy of the commercially available cesium beams fre-
quency standards is from a few parts in 1013 to 1 × 10−12 [113, 2].

5 Reproducibility
The reproducibility of a device or of a measurement is its ability to produce,
repeatedly and without adjustments, the same value or result, given the same
input conditions and operating in the same environment.
In the case of an oscillator, the reproducibility is characterized by the
dispersion of the values of the frequency delivered by the device each time it
is turned on.
This property is closely related to the long term stability, the sensitivity
to the environment and the accuracy.
It is an important parameter for commercial devices that may be used by
non-specialists.
For instance, the reproducibility of the commercial cesium atomic fre-
quency standard 5071A (Symmetricom) given in the data sheet [113] is
±1 × 10−13.
This means that, what the environment conditions in the limits of the
speciﬁcations may be, the frequency error is smaller than this value.
www.ebook3000.com

6 Stability
6.1 Deﬁnition
While accuracy (uncertainty) indicates whether the value is right or wrong,
stability indicates whether the value stays the same over a given time interval
and determines how well it can produce the same frequency over a given time
interval [96].
For instance, if the frequency of a 10 MHz quartz crystal oscillator varies
between 9.999995 and 9.999996 MHz over a given time interval, we could say
that its stability is 1 Hz on that time interval. It is most often expressed as
a fractional dimensionless value by dividing the frequency ﬂuctuations value
by the nominal frequency of the oscillator.
In this example, the fractional stability is δf/fn = 1 × 10−7.
Notice that a low value corresponds to a good stability. In fact, the value
of the frequency of an oscillator varies with time for the following reasons.
1. Random ﬂuctuations. The instantaneous frequency deviation due to these
ﬂuctuations is denoted by ∆f(t). It is a random function of time, which is
assumed to be second-order stationary, the mean value and the covariance
of the ﬂuctuations are time-invariant.
These random frequency ﬂuctuations can be written as
∆f(t) = δf0 + δf(t) ,
(6.1)
δf0 = E{∆f(t)} ,
(6.2)
E{δf(t)} = 0 ,
(6.3)
where ∆f(t) is the instantaneous value, at time t, of the frequency devi-
ation and δf0 is the mean value of the frequency deviation.
The constant part of ∆f(t) contributes to the frequency inaccuracy and
only the ﬂuctuating part is considered in frequency stability studies.
2. Deterministic variations of the frequency. These may be due to known
processes, such as the modiﬁcation of the environment of the device, or to
uncontrolled processes, such as aging, which can produce a low frequency
drift. This drift is assumed to be linear with time t,
δfd(t) = k(t −t0) .
(6.4)

66
6 Stability
In this expression, t0 is the time where the eﬀect of the drift cancels.
Due to frequency drift, the overall frequency deviation is not stationary,
which leads to some diﬃculties, since the Fourier transform of this overall
frequency deviation cannot be deﬁned.
The instantaneous frequency of the oscillator under test is, therefore,
f(t) = f0(t) + δf0 + δf(t) + k(t −t0) .
(6.5)
Characterization of the frequency stability should give pertinent information
about the random process δf(t) and the continuous frequency drift k(t −t0).
The following two diﬀerent families of tools are involved in such studies:
1. Measurement in the frequency domain (spectrum analyzer).
The frequency ﬂuctuations are converted to a voltage ﬂuctuation, which
is analyzed in order to determine its properties.
Such precise frequency measurements imply that
–
the frequency of the oscillator under test is transposed toward lower
frequencies without loss of its stability, which means that the lo-
cal oscillator must be at least as good as the oscillator under test,
and
–
the voltage ﬂuctuations must be studied very close to the null fre-
quency.
This technique will not be studied herein. It is best suited for very short
term stability (high values of the Fourier frequency of the frequency noise
spectrum), which are not in the scope of the book.
2. Measurement in the time domain. This technique allows one to obtain
information on the medium and long-term stability (very low Fourier
frequencies of the frequency noise spectrum).
The frequency of the oscillator is measured over time intervals of du-
ration τ by counting the number of periods during these time intervals
via a frequency meter or period counter. The sequence of discrete data
resulting from these measurements is analyzed.
Such precise frequency measurements imply that
–
the reference clock of the frequency or period meter must be at least as
good as the oscillator under test in order to perform precise frequency
measurements;
–
very low frequency ﬂuctuations are to be measured, which implies
long measurement times; and
–
the data analyzed result from processing the instantaneous frequency
of the oscillators as described in Sect. 6.2.1. This process ﬁlters the
instantaneous frequency ﬂuctuations and samples the result. There
may consequently be a loss of information.
A full characterization of the stability of an oscillator should give the precise
power spectra of the random frequency ﬂuctuations and the drifts that aﬀect
its accuracy.
www.ebook3000.com

6.2 Measurements in the Time Domain
67
6.2 Measurements in the Time Domain
The frequency of the oscillator is measured over time intervals of dura-
tion τ by counting the number of periods during these time intervals. The
result is a sequence of numerical values, each one being the mean value of
the frequency of the oscillator (including the random ﬂuctuations) during
the corresponding time interval. This discrete-time random process is then
studied.
6.2.1 The Measurement Process
The quantity to be characterized is the continuous random process δf(t).
The raw data given by the process of counting the periods of the down con-
verted signal are the results given by the frequency meter at the end of each
measurement of duration τ. These measurements give the mean value of the
frequency during this duration, since it is the ratio of the number of periods
of the signal during the time τ and of this duration τ. The consequences are
as follows:
1. The continuous-time random process δf(t) cannot be reached directly.
We call δfτ(tn) the result of a frequency measurement obtained at time
tn. It is the mean value of the instantaneous frequency over the time
interval [tn −τ, tn] (τ is the integration time)
fτ(tn) = 1
τ
 tn
tn−τ
f(t)dt .
(6.6)
2. The continuous-time process δfτ(t) cannot be reached directly either.
Instead, the successive results of the frequency measurement over the
time duration τ are samples of that continuous time function fτ(t) at the
sampling times tn = n×T , where T is the sampling period and 1/T = νs
is the sampling rate or sampling frequency
δfτ(n) = δfτ(nT ) .
(6.7)
The sampling period and the integration time are related by
T ≥τ .
(6.8)
The diﬀerent steps of the process are described below and their consequences
are studied.
The Frequency Measurement Filters the Frequency Fluctuations
The continuous-time process fτ(t) is deduced from the frequency ﬂuctuations
δf(t) by a ﬁlter deﬁned by (6.6).

68
6 Stability
The impulse response hm(t) of this ﬁlter is easily deduced from (6.6)1
hm(t) =

1/τ 0 < t < τ
0
t < 0, t > τ
.
(6.9)
The transfer function Hm(p) of this ﬁlter is the Laplace transform of this
impulse response
Hm(p) = 1
τp (1 −eτp) .
(6.10)
Its frequency response Gm(ν) is
Gm(ν) = e−j2πντ/2 × sin 2πντ/2
2πντ/2
,
(6.11)
where ν is the Fourier frequency.
Fig. 6.1. Squared amplitude response of the ﬁlter versus the reduced frequency
1 Remember that the output y(t) of a ﬁlter whose impulse response is h(t) is
y(t) =
Z ∞
−∞
x(t −τ) × h(τ)dτ ,
where x(t) is the input of the ﬁlter.
www.ebook3000.com

6.2 Measurements in the Time Domain
69
Its amplitude response is
|Gm(ν)| =

sin πντ
πντ
 .
(6.12)
This is a low-pass ﬁlter with a unit gain at the null frequency and a ﬁrst zero
transmission at the Fourier frequency,
ν0 = 1
τ .
(6.13)
As a function of the reduced Fourier frequency ντ = ν × τ, the amplitude
response Gτ
m(ντ) is
Gτ
m(ντ) =

sin πντ
πντ
 .
(6.14)
Figure 6.1 shows the squared amplitude response |Gτ
m(ντ)|2 of this ﬁlter ver-
sus the reduced frequency ντ = ν × τ.
Sampling Rate Versus Integration Time
Due to the aliasing eﬀect (see Sect. 6.2.1), it is important to compare the
sampling rate and the band of the low-pass ﬁlter. The sampling period T
cannot be smaller than the duration τ of an individual measurement, since
no data is given before the end of the time τ.
Three situations can consequently be considered.
1. No dead time in the frequency measurement.
In this case, a new frequency measurement is started at time nT when
a result is given, and the next value will be given at time (n+1)T = nT +τ.
We then have in this case
T = τ ,
(6.15)
νs = 1
τ .
(6.16)
The frequency response of the ﬁlter produced by the measurement can
be written as a function Gm of the reduced frequency νr = ν/νs
Gm(νr) = e−j2πνrτ/(2T ) × sin {2πνrτ/(2T )}
2πνrτ/(2T )
(6.17)
= e−jπνr × sin πνr
πνr
.
(6.18)
Figure 6.2 shows the square of the amplitude response as a function of
the reduced frequency νr.
The process of measuring successive values of the mean frequency during
time intervals τ with no dead time consequently leads to ﬁltering of the
spectrum of the frequency ﬂuctuations with a low-pass ﬁlter whose ﬁrst
zero transmission occurs at the sampling frequency νs = 1/T = 1/τ.

70
6 Stability
Fig. 6.2. Squared amplitude response of the ﬁlter associated to the frequency
measurement with no dead time
2. Dead time of duration τ′ in the frequency measurement.
In this case, the next frequency measurement begins after the dead time
τ′ and the value will be obtained after the time T = τ + τ′ (see Fig. 6.3).
We have
T > τ ,
(6.19)
νs < 1
τ .
(6.20)
The function Gm of the reduced frequency νr = ν/νs is
Gm(νr) = e−jπνr/(1+k) × sin {πνr/(1 + k)}
πνr/(1 + k)
.
(6.21)
k is the ratio of the dead time to the integration time.
Fig. 6.3. Frequency measurement with dead time
www.ebook3000.com

6.2 Measurements in the Time Domain
71
Fig. 6.4. Squared amplitude response of the ﬁlter associated to the frequency
measurement with a dead time
Figure 6.4 shows the squared amplitude response as a function of the
reduced frequency νr in the case τ′ = τ/2.
The process of measuring successive values of the mean frequency during
time intervals τ with a dead time τ′ then leads to ﬁltering of the spectrum
of the frequency ﬂuctuations with a low-pass ﬁlter whose ﬁrst zero trans-
mission occurs beyond the sampling frequency νs = 1/T = 1/(τ + τ′).
3. No dead time and association of successive results.
In this case, M successive samples of duration τ0 are used to calculate the
mean value fMτ0(t) of the instantaneous frequency f(t) over a duration
Mτ0 = τ
fτ(t0) = 1
τ
 t0
t0−τ
f(t)dt
(6.22)
=
1
Mτ0
M−1

m = 0
 t0−mτ/M
t0−(m+1)τ/M
f(t)dt

(6.23)
=
1
Mτ0
M−1

m = 0
fτ/M(t0 −mτ/M) .
(6.24)
One mean frequency measurement is the concatenation of M elemen-
tary measurements. Its duration is τ = Mτ0, but samples are taken
at the end of every elementary measurement, with a sampling rate of
νs = 1/T = 1/τ0.

72
6 Stability
Fig. 6.5. Squared amplitude response of the ﬁlter associated to the frequency
measurement with no dead time and association of three successive results
We then have
T = τ
M ,
(6.25)
νs = M × 1
τ .
(6.26)
The function Gm of νr = ν/νs is in this case
Gm(νr) = e−jπNνr × sin {πNνr}
πNνr
.
(6.27)
Figure 6.5 shows the squared amplitude response as a function of the
reduced frequency νr in the case N = 3.
The process of measuring successive values of the mean frequency dur-
ing time intervals τ0 with no dead time and associating N successive
results to construct one sample of the sequence consequently leads to ﬁl-
tering of the spectrum of the frequency ﬂuctuations with a low-pass ﬁlter
whose ﬁrst zero transmission occurs at the sampling frequency divided
by N.
Frequency Aliasing
It is well known (see for instance [131]) that sampling a continuous time func-
tion xc(t) whose Fourier transform is Xc(ν) with a sampling time T = 1/νs
www.ebook3000.com

6.2 Measurements in the Time Domain
73
leads to a sequence x(n) = xc(nT ) whose Fourier transform X(ν) is deduced
from Xc(ν) by (the Nyquist–Shannon sampling theorem):
X(ν) = 1
T
∞

k=−∞
Xc (ν + kνs) .
(6.28)
In such a situation, the Fourier transform of the continuous signal, and con-
sequently the continuous signal itself, cannot be computed from the Fourier
transform of the discrete signal: there has been a loss of information.
Consequently, the Fourier transform X(ν) of the sampled signal in the
Fourier frequency domain [0 −νs/2] is diﬀerent from the Fourier trans-
form Xc(ν) of the continuous signal in this domain if Xc(ν) spreads beyond
the half of the sampling frequency νs/2 (the Nyquist frequency), as shown in
Fig. 6.6. This is the aliasing phenomenon.
In most usual cases where the spectral density of the continuous signal is
a quantity of interest, either
–
the sampling frequency νs is chosen large enough so that the spectrum of
interest does not extend beyond the Nyquist frequency, or
–
the part of that spectrum that extends beyond the Nyquist frequency is
suppressed by a low-pass ﬁlter before sampling.
The ﬁlter eﬀect produced by the frequency measurement does not limit the
frequency domain of the Fourier transform of the frequency noise, unless we
Fig. 6.6. Spectrum of the discrete-time process compared to that of the continuous-
time process

74
6 Stability
neglect the side lobes of G(ν) (or Gm(νr)). It is consequently not possible
to deduce the Fourier transform (or the spectral density) from the sequence
made from the results of the successive frequency measurement.
Only in the case where N successive measurements are associated, the
main lobe of G(ν) is inside the Nyquist frequencies ±νs/2, since N ≥2.
In the general case, the part of the Fourier transform of fτ(t) beyond the
Nyquist frequency is folded back in the band 0 ≤ν ≤νs/2 of the Fourier
transform of fτ(n) (see Fig. 6.7).
In the simple case where the Fourier transform of the continuous-time
process fτ(t) does not extends beyond twice the Nyquist frequency, we have
for every value of ν such as 0 ≤ν ≤νs/2,
Fτ(ν) = Fτ,c(ν) + Fτ,c(νs −ν) .
(6.29)
The quantity of interest is the spectral density of the discrete signal
PF,τ(ν) = Fτ(ν) × F ∗
τ (ν)
(6.30)
= |Fτ,c(ν)|2 + |Fτ,c(νs −ν)|2
(6.31)
+ |Fτ,c(ν)| |Fτ,c(νs −ν)| exp [j (φ(ν) −φ(νs −ν))]
(6.32)
+ |Fτ,c(ν)| |Fτ,c(νs −ν)| exp [j (−φ(ν) + φ(νs −ν))]
(6.33)
= |Fτ,c(ν)|2 + |Fτ,c(νs −ν)|2
(6.34)
+ 2 |Fτ,c(ν)| |Fτ,c(νs −ν)| cos(δφ) ,
(6.35)
Fig. 6.7. Aliasing when frequency is measured without a dead time
www.ebook3000.com

6.2 Measurements in the Time Domain
75
where δφ is the phase diﬀerence between the Fourier transform values for the
Fourier frequencies ν and νs −ν. If we assume that the phase of the Fourier
transform of the time-continuous process at a frequency 0 ≤ν ≤< νs/2 and
the phase at the frequency ν′ = νs −ν are not correlated, the value of cos(δφ)
can be averaged to zero and we can approximate
PF,τ(ν) = |Fτ,c(ν)|2 + |Fτ,c(νs −ν)|2 .
(6.36)
The conclusion is that the power of the discrete-time process calculated for
the Fourier frequencies inside the Nyquist value equals the total power of the
continuous-time process.
This result can easily be generalized for any value of the maximal Fourier
frequency of the continuous-time process.
The main information given by frequency measurement is consequently
the value of the power of the frequency noise ﬁltered by the low-pass ﬁlter
equivalent to the measurement process.
6.2.2 Power and Spectral Density
The power of the random part δf(t) of the frequency of the oscillator under
test is a characteristic of the stability. This power is given by the variance
of this random process. Some other statistical parameters may be useful and
are described below.
Statistical Properties of Random Processes
Ergodic and Stationary Random Processes
Here we are concerned with an ergodic [127] and second-order stationary [134]
random process {Xt}. Its properties are the following:
1. The mean value µ(t) of the process is time-invariant. This deﬁnes ﬁrst-
order stationarity
µ(t) = E{Xt} = µ .
(6.37)
In the following, we remove the constant mean value of the process µ = 0.
2. The covariance γ(t2, t1) of the process is time-invariant and is only a func-
tion of the diﬀerence t2 −t1. This deﬁnes second-order stationarity
γ(t2, t1) = E{(Xt2)(Xt1)∗} = γ(t2 −t1) .
(6.38)
3. The variance σ2(t) of the process, which is its covariance for t2 −t1 = 0,
is time-invariant
σ2(t) = E{|Xt|2} = σ2 .
(6.39)
These deﬁnitions hold for both discrete-time and continuous-time pro-
cesses.

76
6 Stability
a) For a continuous-time process x(t)
E{x(t)} = µ = 0 ,
(6.40)
E{[x(t2)][x(t1)]∗} = γ(t2 −t1) ,
(6.41)
E{|x(t)|2} = σ2 .
(6.42)
b) For a discrete-time process x(n)
E{x(n)} = µ = 0 ,
(6.43)
E{[x(n2)][x(n1)]∗} = γ(n2 −n1) ,
(6.44)
E{|x(n)|2} = σ2 .
(6.45)
4. The time average and the average over the statistical ensemble give the
same result: this deﬁnes ergodicity.
This means that, for instance,
E{Xt} =
lim
∆T →∞

1
2∆T
 ∆T
−∆T
Xtdt

(6.46)
if Xt is a continuous-time process, and
E{Xt} = lim
N→∞

1
2N + 1
N

−N
Xt

(6.47)
if it is a discrete-time process.
Spectral Density and Variance
The spectral density p(ν) of a stationary random process Xt is deﬁned as the
Fourier transform of its covariance.
1. For a continuous-time process
p(ν) =
 ∞
−∞
γ(t) exp(−j2πνt)dt ,
(6.48)
γ(t) =
 ∞
−∞
p(ν) exp(j2πνt)dν .
(6.49)
2. For a discrete-time process
p(ν) = T
∞

n=−∞
γ(n) exp(−j2πνnT ) ,
(6.50)
γ(n) =
 1/2T
−1/2T
p(ν) exp(j2πνnT )dν ,
(6.51)
where T is the sampling time.
www.ebook3000.com

6.2 Measurements in the Time Domain
77
If the dimension of the quantity Xt is dim (for instance, in the case of fre-
quency ﬂuctuations, the dimension of the random process is Hz), the dimen-
sion of the covariance is dim2 (Hz2 in the case of frequency ﬂuctuations).
The dimension of the spectral density is therefore, dim2 × s, or dim2 ×
Hz−1. In the case of frequency ﬂuctuations, the dimension of the spectral
density is consequently Hz.
The process variance σ2, which is its mean power, can be computed from
the spectral density.
1. For a continuous-time process
σ2 = E{x(t)2}
(6.52)
= γ(0)
(6.53)
=
 ∞
−∞
p(ν)dν .
(6.54)
2. For a discrete-time process
σ2 = E{x(n)2}
(6.55)
= γ(0)
(6.56)
=
 1/2T
−1/2T
p(ν)dν .
(6.57)
The spectral density indicates how the power of the process is distributed
among its diﬀerent Fourier frequencies. It can also be estimated from the
Fourier transform X(ν) of the signal.
Assuming the ergodic hypothesis, p(ν) can be written as follows:
1. For a continuous-time process
p(ν) =
lim
∆T →∞
1
2∆T

 ∆T
−∆T
x(t) exp(−2jπνt)dt

2
.
(6.58)
2. For a discrete-time process
p(ν) = T lim
N→∞
1
2N + 1

N

n=−N
x(n) exp(−2jπνnT )

2
.
(6.59)
The quantity
 ∆T
−∆T
x(t) exp(−2jπνt)dt ,
which appears on the right-hand side of (6.58) is the Fourier transform of the
continuous-time process x(t) in the rectangular window [−∆T, +∆T ].

78
6 Stability
The quantity
N

n=−N
x(n) exp(−2jπνnT )dt ,
which appears on the right-hand side of (6.59) is the Fourier transform of the
discrete-time process x(n) in the rectangular window [−N, +N].
In fact, any measurement will be limited to a ﬁnite duration 2∆T (for
a continuous-time process) or to a ﬁnite number 2N + 1 of samples (for
a discrete-time process) and the power spectral density will be estimated by
the quantity pper, which is often called a periodogram.
1. For a continuous-time process
pper(ν) =
1
2∆T

 ∆T
−∆T
x(t) exp(−2jπνt)dt

2
.
(6.60)
2. For a discrete-time process
pper(ν) = T
1
2N + 1

N

n=−N
x(n) exp(−2jπνnT )

2
.
(6.61)
The Discrete-time Process Versus the Continuous-time Process
It is useful to relate the spectral density of a discrete-time process to the
spectral density of the continuous-time process from which it is deduced
by sampling. Let x(t) a continuous-time process, ergodic and second-order-
stationary, and x(n) the discrete-time process deﬁned by sampling x(t) with
a sampling rate νs = 1/T . Then
x(n) = x(nT ) .
(6.62)
The covariance and the spectral density of x(t) are, respectively, γ(t) and p(ν),
and the covariance and the spectral density of x(n) are, respectively, Γ(n)
and P(ν).
The covariances and spectral densities are related by
p(ν) =
 ∞
−∞
γ(τ) exp(−j2πντ)dτ ,
(6.63)
γ(τ) =
 ∞
−∞
p(ν) exp(j2πντ)dν
(6.64)
and
P(ν) = T
∞

−∞
Γ(n) exp(−j2πνnT ) ,
(6.65)
Γ(n) =
 1/2T
−1/2T
P(ν) exp(j2πνnT )dν .
(6.66)
www.ebook3000.com

6.2 Measurements in the Time Domain
79
The covariance is deﬁned by
γ(τ) = E{x(t)x∗(t −τ)} ,
(6.67)
Γ(n) = E{x(mT )x∗(mT −nT )}
(6.68)
= γ[nT ] .
(6.69)
Consequently,
Γ(n) =
 ∞
−∞
p(ν) exp(j2πνnT )dν
(6.70)
=
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
p(ν) exp(j2πνnT )dν .
(6.71)
Putting f = ν −k/T = ν −kνs, we have
Γ(n) =
∞

k=−∞
 νs/2
−νs/2
p(f + kνs) exp[j2π(f + k/T)nT ]dν
(6.72)
=
∞

k=−∞
 νs/2
−νs/2
p(f + kνs) exp(j2πfnT )dν
(6.73)
=
 νs/2
−νs/2
∞

k=−∞
p(f + kνs) exp(j2πfnT )dν .
(6.74)
Comparing (6.66) and (6.74) gives
P(ν) =
∞

k=−∞
p(ν + kνs) .
(6.75)
Consequently, we have
 νs/2
−νs/2
P(ν)dν =
 νs/2
−νs/2
∞

k=−∞
p(ν + kνs)dν
(6.76)
=
∞

k=−∞
 νs/2
−νs/2
p(ν + kνs)dnν .
(6.77)
Putting f = ν + kνs gives
 νs/2
−νs/2
P(ν)dν =
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
p(f)df
(6.78)
=
 ∞
−∞
p(f)df .
(6.79)

80
6 Stability
Consequently,
–
the variance of the discrete-time process equals that of the continuous-
time process, and
–
the range of Fourier frequencies [−νs/2, νs/2] of the discrete-time process
contains the power of the range [−∞, ∞] of the continuous-time process.
Filtering
Filtering a random process Xt whose spectral density is px(ν) with a ﬁl-
ter whose frequency response is H(ν) results in a random process Yt whose
spectral density is py(ν) |H(ν)|2.
Statistical Properties of Frequency and Phase Fluctuations
We assume that the frequency ﬂuctuation δf(t) = f(t)−E{f(t)} is a contin-
uous-time, stationary and ergodic random process, as well as the result of
frequency measurement δfτ(n) = fτ(n) −E{fτ(n)} is a discrete-time, sta-
tionary and ergodic random process.
The properties described above can consequently be applied to these two
processes.
The Power of Frequency and Phase Fluctuations
The power of the random frequency ﬂuctuations δf(t) = f(t) −E{f(t)},
deﬁned as
Pδf = E{(δf(t))2}
(6.80)
characterizes the strength of the frequency instability. We will consequently
try to use this parameter to characterize the stability of the oscillator under
test.
Assuming the ergodic hypothesis, we can write
Pδf = E{(δf(t))2}
(6.81)
= σ2
δf
(6.82)
=
lim
∆t→∞
1
2∆t
 ∆t
−∆t
δf(t)2dt .
(6.83)
Equivalent relations hold for the discrete-time process δfτ(n) = fτ(n) −
E{fτ(n)},
Pδf,τ = E{(δfτ(n))2}
(6.84)
= σ2
δf,τ
(6.85)
= lim
N→∞
1
2N + 1
N

−N
δfτ(n)2 .
(6.86)
www.ebook3000.com

6.2 Measurements in the Time Domain
81
In fact, the quantity of interest is the dimensionless reduced (or fractional)
frequency ﬂuctuation
y(n) = δfτ(n)/f0 ,
(6.87)
where f0 is the nominal frequency of the oscillator under test.
The reduced frequency ﬂuctuations are very small for an ultra-stable oscil-
lator and the variance, frequently denoted as σ2
y, or any other parameter that
characterizes the random process, is an extremely small number; the smaller
it is, the smaller the frequency ﬂuctuations and the better the stability of the
oscillator.
The random processes associated to this quantity are themselves dimen-
sionless, as well as their variance.
The dimension of the spectral density of the reduced frequency ﬂuctuation
is Hz−1.
Another quantity frequently involved in the characterization of the fre-
quency stability is the phase deviation from the nominal value φ0(t) =
φ(0) + 2πf0t (phase ﬂuctuations, phase noise).
The phase φ(t) of the signal delivered by the oscillator at time t is
φ(t) = φ(0) + 2π
 t
0
f(t)dt
(6.88)
= φ(0) + 2πf0t + 2π
 t
0
δf(t)dt
(6.89)
= φ0(t) + δφ(t) ,
(6.90)
where φ0(t) = φ(0)+2πf0t is the nominal phase corresponding to the nominal
frequency f0 of the oscillator. δφ(t) is the phase deviation at time t.
The phase deviation and the frequency deviation are related by
δf(t) = dδφ(t)
dt
,
(6.91)
δφ(t) = 2π
 t
0
δf(t)dt .
(6.92)
As for the frequency, the reduced phase deviation is the quantity of interest.
It is deﬁned by
x(t) = δφ(t)/f0 .
(6.93)
The dimension of this quantity is Hz−1, the dimension of its variance is Hz−2,
and the dimension of its spectral density is Hz−3.
Spectral Density of Frequency and Phase Fluctuations
A precise characterization of the stability is given by the spectral density of
δf(t) = f(t) −E{f(t)} or δfτ(n) = fτ(n) −E{fτ(n)}.

82
6 Stability
This indicates how the power of the random process δf(t) or δfτ(n) is
distributed among its Fourier frequencies.
According to (6.48) and (6.50), the spectral density of the reduced fre-
quency ﬂuctuations is
py(ν) = 1
f 2
0
 ∞
−∞
γδf(t) exp (−j2πνt)dt
(Hz−1)
(6.94)
for the continuous-time process δf(t) and
py,τ(ν) = T 1
f 2
0
∞

−∞
γδf,τ(n) exp (−j2πνnT )
(Hz−1)
(6.95)
for the discrete-time process δfτ(n). T is the sampling time.
The spectral density of the reduced phase noise is
px(ν) = 1
f 2
0
 ∞
−∞
γδφ(t) exp (−j2πνt)dt
(Hz−3)
(6.96)
for the continuous-time process δφ(t) and
px,τ(ν) = T 1
f 2
0
∞

−∞
γδφ,τ(n) exp (−j2πνnT )
(Hz−3)
(6.97)
for the discrete-time process δφτ(n). T is the sampling period.
In these expressions, γδf(τ) is the covariance of δf(t), γδf,τ(n) is the
covariance of δfτ(n), γδφ(τ) is the covariance of δφ(t) and γδφ,τ(n) is the
covariance of δφτ(n).
According to (6.58) and (6.59), the spectral densities can also be computed
from an estimator of the Fourier transform of the processes
pδf(ν) =
lim
∆T →∞
1
2∆T

 ∆T
−∆T
δf(t) exp (−j2πνt)dt

2
,
(6.98)
pδf,τ(ν) = T lim
N→∞
1
2N + 1

N

−N
δfτ(n) exp (−j2πνnT )

2
.
(6.99)
The quantity
 ∆T
−∆T
δf(t) exp (−j2πνt)dt
is an estimator of the Fourier transform ∆F(ν) of the continuous-time process
δf(t) and the quantity
N

−N
δfτ(n) exp (−j2πνnT )
www.ebook3000.com

6.2 Measurements in the Time Domain
83
is an estimator of the Fourier transform ∆Fτ(ν) of the discrete-time process
δfτ(n).
Since x(t) and y(t) are related by relations of (6.91) and (6.92), we have
the simple relation between their two Fourier transforms X(ν) and Y (ν),
Y (ν) = 2πjνX(ν)
(6.100)
and between their spectral densities px(ν) and py(ν),
py(ν) = 4π2ν2px(ν) .
(6.101)
Model of the Frequency Noise of Ultra-stable Oscillators
The spectral density of the frequency noise of ultra-stable oscillators is fre-
quently described by a superposition of components whose spectral densities
are integer powers of the Fourier frequency ν [81].
In this model, there are ﬁve types of independent noise processes. The fol-
lowing power laws describe the ﬁve components of the dimensionless reduced
frequency ﬂuctuation, i.e. y(t) = δf(t)/f0
py,i(ν) = hi × |ν|i ,
(6.102)
−2 ≤i ≤2 .
The dimension of spectral density py,i(ν) of the dimensionless quantity y(t)
is Hz−1.
These ﬁve components are described in Table 6.1.
Table 6.1. Noise processes involved in the frequency ﬂuctuations of ultra-stable
oscillators
Value of the power i
Dimension of hi
Process
−2
Hz
Random walk frequency noise
−1
Dimensionless
Flicker frequency noise
0
Hz−1
White frequency noise
+1
Hz−2
Flicker phase noise
+2
Hz−3
White phase noise
Random Walk Frequency Noise
A random walk is a simple stochastic process [128]. In the case of frequency
noise, which is a 1D random walk, it describes successive frequency jumps,
which may be positive or negative with the same probability.

84
6 Stability
It can be shown in this case [129] that the total variation of the frequency
during a given time interval ∆t asymptotes to ±

2n/π ≈±0.8√n.
This explains the strong growth of the spectral density for low frequencies,
i.e. long sampling times.
Flicker Frequency Noise
Flicker noise, also known as 1/f noise or pink noise [132], is a process with
a frequency spectrum such that the power spectral density is proportional to
the reciprocal of the frequency.
Although it physical origin is not well elucidated, ﬂicker noise is a process
that appears in many physical situations. It is often dominant in the low
Fourier frequency ranges.
Flicker Phase Noise
Equation (6.101) shows that the spectral density of the frequency ﬂuctuations
is proportional to that of the phase ﬂuctuations times the square of the
Fourier frequency,
pf(ν) ∝pφ(ν) × ν2
(6.103)
= h1 |ν| .
Consequently, ﬂicker phase noise produces a frequency noise component
whose spectral density is proportional to the Fourier frequency ν.
White Frequency Noise
White noise occurs when there is no correlation between the values of the
process for any two diﬀerent times [135]. Thermal noise (Johnson noise),
produced by the random thermal motion of the electrical charges in elec-
tronic circuits is the most known source of white frequency noise. Shot
noise, which appears when discrete quanta are implied, e.g. electrons in an
electronic circuit or photons in an optical experiment also produces white
noise.
White Phase Noise
Similarly to the ﬂicker phase noise, the white phase noise produces a fre-
quency noise whose spectral density is proportional to that of the phase
noise times the square of the Fourier frequency,
pf(ν) ∝pφ(ν) × ν2
(6.104)
= h2ν2 .
www.ebook3000.com

6.2 Measurements in the Time Domain
85
6.2.3 Variance of the Frequency Fluctuations
The simplest statistical parameter that characterizes the random frequency
ﬂuctuations in the time domain is the variance of the dimensionless ﬂuctuat-
ing part δf(t)/f0 of the frequency. This variance is a measure of how spread
out this random process is.
The input data is the discrete-time process δfτ(n), which results from the
frequency measurement and is related to the continuous-time process δf(t)
as described in Sect. 6.2.1.
Notice that the measurement is performed during a ﬁnite time interval
and consequently only a limited sample of the discrete-time process is known.
The variance of the discrete-time process must be ﬁrst estimated from this
ﬁnite sample, and then the nature of the frequency noise of the oscillator
deduced from this estimation.
Notice that the algorithm includes the frequency drift, if any.
Estimator of the Variance
The ﬁrst step is to characterize the quality of the estimator of the vari-
ance.
The Estimator s2
x
When estimating the population variance using N samples x(n) of the total
population where n = 1, 2, · · · , N, the following formula is used, which gives
an unbiased estimator s2
x of the variance σ2
x:
s2
x =
1
N −1
N

n=1

x(n) −x(n)
2
.
(6.105)
In this expression, the mean value x(n) is given by
x(n) = 1
N
N

p=1
x(p) .
(6.106)
An Unbiased Estimator
An unbiased estimator is one that, on average, does not overestimate or
underestimate the quantity that is being estimated.
We note that
E
 N

n=1

x(n) −x(n)
2

,
(6.107)

86
6 Stability
which is the average of the quantity used to calculate the estimator s2
x. We
can write
E
 N

n=1

x(n) −x(n)
2

= E
 N

n=1

x(n) −µ −

x(n) −µ
2

=
N

n=1
E

(x(n) −µ) −

x(n) −µ
2
=
N

n=1
E

(x(n) −µ)2
−2
N

n=1
E

(x(n) −µ)

x(n) −µ

+
N

n=1
E

x(n) −µ
2
.
In these expressions, µ is the (unknown) mean value of the sequence.
The ﬁrst member of the right-hand side is the variance σ2
x of the sequence
x(n), multiplied by N,
N

n=1
E

(x(n) −µ)2
=
N

n=1
σ2
x
= N × σ2
x .
To calculate the second and third members, we bear in mind that
x(n) = 1/N
N

m=1
x(m) .
Consequently,
N

n=1
E

(x(n) −µ)

x(n) −µ

=
N

n=1
E

1
N
N

m=1
(x(n) −µ) (x(m) −µ)

= σ2
x ,
N

n=1
E

x(n) −µ
2
=
N

n=1
E
⎧
⎨
⎩

1
N
N

m=1
x(m) −µ
2⎫
⎬
⎭
=
1
N 2
N

n=1
N

m=1
E

(x(m) −µ)2 
= σ2
x .
www.ebook3000.com

6.2 Measurements in the Time Domain
87
In conclusion, the average of the quantity used to calculate the estimator s2
x
equals
E
 N

n=1

x(n) −x(n)
2

= (N −1) × σ2
x .
Consequently, the quantity
s2
x =
!N
n=1

x(n) −x(n)
2
N −1
is an unbiased estimator of the population variance of x(n). This is called the
sample variance of x(n).
Information Given by the Variance
The notations are the following:
–
instantaneous reduced frequency ﬂuctuations y(t) and their spectral den-
sity py(ν)
y(t) = δf(t)
f0
,
(6.108)
–
the continuous-time process yτ(t) resulting from the frequency measure-
ments over a duration τ and its spectral density py,τ(ν)
yτ(t) = δfτ(t)
f0
,
(6.109)
–
the discrete-time process yT
τ (n) resulting from sampling yτ(t) with sam-
pling rate νs = 1/T and its spectral density P T
y,τ(ν)
yT
τ (n) = δf T
τ (n)
f0
.
(6.110)
What is called variance of the frequency ﬂuctuations of an ultra-stable oscil-
lator is in fact the variance of the discrete-time process yT
τ (n) = δf T
τ (n)/f0.
The sampling time T , equal to the integration time τ in the case where there
is no dead time, which is the most frequent case, is the parameter of this
quantity.
If p(ν) is the spectral density of the reduced frequency ﬂuctuations y(t)
of the oscillator,
pτ(ν) = p(ν) × |Gm(ν)|2
(6.111)
= p(ν) ×
sin πντ
πντ
2
(6.112)
is the power density of the continuous-time process yτ(t) resulting from fre-
quency measurements of duration τ.

88
6 Stability
The spectral density P T
y,τ(ν) of the discrete-time process yT
τ (n) resulting
from sampling yτ(t) with the sampling rate T = 1/νs is (see Sect. 6.2.2)
P T
y,τ(ν) =
∞

k=−∞
pτ(ν + kνs)
(6.113)
=
∞

k=−∞
py(ν + kνs) × [Gm(ν + kνs)]2
(6.114)
=
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
.
(6.115)
The variance σ2
y,T (τ) of the discrete-time process yT
τ is consequently
σ2
τ,T (τ) =
 νs/2
−νs/2
P T
y,τ(ν)dν
(6.116)
=
 νs/2
−νs/2
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
dν .
(6.117)
Putting f = ν + kνs
σ2
y,T (τ) =
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
py(f) ×
sin (πfτ)
πfτ
2
df
(6.118)
=
 ∞
−∞
p(f) ×
sin (πfτ)
πfτ
2
df .
(6.119)
Putting the dimensionless variable x = πτν
σ2
y,T (τ) = 1
πτ
 ∞
−∞
P(x)sin2 (x)
x2
dx ,
(6.120)
where
P(x) = py
 x
πτ

.
(6.121)
The result of the process of variance measurement is the sample variance
s2
y,T (τ) of the discrete-time process yT
τ (n). It is an unbiased estimator of the
variance of this process. It is related to the variance of the instantaneous fre-
quency ﬂuctuations y(t) but is diﬀerent from it because of the ﬁlter associated
to the frequency measurement process (see Sect. 6.2.1). It depends on the du-
ration τ of each individual measurement and the eﬀect of this experimental
parameter must be studied.
www.ebook3000.com

6.2 Measurements in the Time Domain
89
The case T = τ (no dead time) is the most frequently encountered. In the
following, this situation will be assumed. The notations in this case can be
simpliﬁed and are as follows:
yτ
τ (t) = yτ(t) ,
(6.122)
P τ
y,τ(ν) = Py,τ(ν) ,
(6.123)
σ2
y,τ(τ) = σ2
y(τ) .
(6.124)
Variance Values for the Components of the Frequency Noise
The law of the variation of σ2
y(τ) as a function of the duration τ of each
measurement is a characteristic of the noise that aﬀects the frequency.
1. py(ν) = h0, P(x) = h0 (white frequency noise).
In this case, we have (see (A.3))
σ2
y(τ) = h0
1
πτ
 ∞
−∞
sin (x)
x
2
dx
(6.125)
= h0
τ .
(6.126)
The variance of the ﬁltered frequency ﬂuctuations is inversely propor-
tional to the duration τ of each measurement, since the ﬁlter width is
inversely proportional to τ.
2. py(ν) = h1 |ν|, P(x) = (h1/πτ) |x| (ﬂicker phase noise).
In this case, the ﬁnite width of the noise spectrum (or of the measure-
ment apparatus) must be taken into account, otherwise the total power is
inﬁnite. νmax is the upper limit of the noise spectrum and xmax = πτνmax.
We have (see (A.2))
σ2
y(τ) = 2 h−1
π2τ 2
 xmax
0
sin2(x)
x
dx
(6.127)
= h−1
π2τ 2 × [ln(πτνmax) + γ] .
(6.128)
γ is the Euler–Mascheroni constant
γ = 0.577216 . . .
(6.129)
3. py(ν) = h2ν2, P(x) = (h2/π2τ 2)x2 (white phase noise).
In this case, the ﬁnite width of the noise spectrum (or of the measure-
ment apparatus) must be taken into account, otherwise the total power is
inﬁnite. νmax is the upper limit of the noise spectrum and xmax = πτνmax.
We have (see (A.1))
σ2
y(τ) = 2 h−1
π3τ 3
 xmax
0
sin2(x)dx
(6.130)
= h−1
π3τ 3 ×

πτνmax −sin(2πτνmax)
2

.
(6.131)

90
6 Stability
Assuming that πτνmax ≫1
σ2
y(τ) = h−1
π2τ 2 × νmax .
(6.132)
4. py(ν) = h−1
ν−1, P(x) = (h−1 × πτ)
x−1 (ﬂicker frequency noise).
In this case, the value of the low frequency cut-oﬀof the power law is
not deﬁned and consequently the lower limit of the integration must be
taken equal to zero.
We have
σ2
y(τ) = 2h−1
 ∞
0
sin2(x)
x3
dx
(6.133)
= lim
x→0 h−1 × [1 −2γ −2 ln(x)]
(6.134)
= ∞.
(6.135)
Consequently, no calculation of the variance can be made if the low-
frequency cut-oﬀis not known.
5. py(ν) = h−2ν−2, P(x) = (h−2×π2τ 2)x−2 (random walk frequency noise).
The conclusion is the same as in the previous case: the variance cannot
be predicted.
The Eﬀect of a Constant Frequency Drift
The concept of variance is not deﬁned in the case of a non-stationary pro-
cess since the mean value cannot be computed. The following question arises
consequently in the case where a frequency drift exists: what is the meaning
of the result given by this algorithm of the sample variance?
For instance, assuming a constant drift of the frequency during the sample
variance measurement and T = τ, we have
f(t) = f0 + δf0 + δf(t) + k × t ,
(6.136)
where f(t) is the instantaneous frequency, f0 is the nominal frequency, δf0 is
a constant oﬀset due to inaccuracy, δf(t) is the random frequency ﬂuctuation
with a null mean value, k is the frequency drift (in Hz × s−1) and t is time.
Application of the sample variance algorithm to this oscillator gives the
following results:
1. Mean frequency measurement over a duration τ.
The value fτ(n) obtained at time n is
fτ(nT ) = 1
τ
 nτ
(n−1)τ
f(t)dt
(6.137)
= f0 + δf0 + kτ

n −1
2

+ δfτ(nτ) .
(6.138)
www.ebook3000.com

6.2 Measurements in the Time Domain
91
2. Mean value of the N samples.
The mean value of the N samples fτ(n) is
fτ(n) = 1
N
N

n=1
fτ(n)
(6.139)
= 1
N
N

n=1

f0 + δf0 + kτ

n −1
2

+ δfτ(nτ)

(6.140)
= 1
N

Nf0 + Nδf0 + kτ
N

n=1

n −1
2

+
N

n=1
δfτ(nτ)

(6.141)
= f0 + δf0 + kτ
N
2

+ 1
N
N

n=1
δfτ(nτ)
(6.142)
= f0 + δf0 + kτ
N
2

.
(6.143)
The mean value of δfτ(nτ) is null.
3. Value of the diﬀerence fτ(n) −fτ(n).
The constant parts of the frequency cancel, but the constant drift leads
to a term that cannot be distinguished from the term due to the random
ﬂuctuation
fτ(n) −fτ(n) = δfτ(n) + kτ

n −N + 1
2

.
(6.144)
4. Value returned by the algorithm.
The above expression shows that the constant frequency shift appears as
an additional term kτ
"
n −N+1
2
#
superimposed to the random ﬂuctua-
tions δfτ(n).
Application of the algorithm consequently gives
S2
y(τ) = 1
f0
×
1
N −1
N

n=1

δfτ(n) + kτ

n −N + 1
2
2
(6.145)
= s2
y(τ)
(6.146)
+ 1
f0
×
1
N −1 × k2τ 2
N

n=1

n −N + 1
2
2
+ 1
f0
×
2
N −1 × kτ
N

n=1
δfτ(n)

n −N + 1
2

.
The ﬁrst term is the sample variance of the frequency ﬂuctuations, the
two other terms are due to the constant frequency drift. The algorithm
cannot separate the two contributions.

92
6 Stability
For instance, if N is an odd number N = 2M −1,
S2
y(τ) = s2
y(τ)
(6.147)
+ 1
f0
×
1
N −1 × k2τ 2
N

n=1
(n −M)2
+ 1
f0
×
2
N −1 × kτ
N

n=1
δfτ(n) (n −M)
= s2
y(τ)
(6.148)
+ 1
f0
×
1
N −1 × k2τ 2
M−1

n=1
p2
+ 1
f0
×
2
N −1 × kτ
N

n=1
δfτ(n)(n −M) .
(6.149)
Since (see, for instance [43])
M−1

1
p2 = M(M −1)(2M −1)
6
,
(6.150)
the second term equals
1
f0
× k2τ 2 M(2M −1)
6
.
(6.151)
The third term can be neglected since the mean value of δfτ(n) is null.
We then have
S2
y(τ) = s2
y(τ)
(6.152)
+ 1
f0
× k2τ 2 M(2M −1)
6
.
The frequency drift appears like a frequency ﬂuctuation that should lead
to a variance proportional to τ2 and depends strongly on the number N
of samples; it is proportional to N(N + 1)/2.
Variance is a very Imperfect Tool
These results show that the variance of the discrete-time process is a very
imperfect tool.
1. No theoretical result can be obtained for some of the components of the
noise that can aﬀect the stability of the oscillator under test.
2. A frequency drift appears like a random ﬂuctuation that should lead to
a variance proportional to τ 2 and depends strongly on the number N of
samples since it is proportional to N(N + 1)/2.
www.ebook3000.com

6.2 Measurements in the Time Domain
93
6.2.4 Allan Variance
Allan variance, named after David W. Allan [4] (and also known as the two-
sample variance) is the tool most frequently used to characterize the stability
of high performance oscillators. It is deﬁned as one half of the time average
of the squares of the diﬀerences between successive readings of the frequency,
each one being measured over a duration τ.
As for the variance, a dead time can be introduced between the measure-
ments, leading to a value of the sampling time larger than the integration
time.
The Allan variance σ2
y,A of a discrete-time process yn = δf(n)/f0 is con-
sequently deﬁned by
σ2
y,A(τ) = 1
2
$
(yn+1 −yn)2%
.
(6.153)
Allan Variance is a Filter
The algorithm of the calculation of the Allan variance of a discrete-time
process yn is the algorithm of
1. a digital ﬁlter applied to the process yn, followed by
2. the calculation of the variance of the ﬁltered process.
The notations are the same as previously: y(t) is the continuous-time process
y(t) = δf(t)/f0, yτ(t) the continuous-time process resulting from frequency
measurements of duration τ and yτ(n) the discrete-time process resulting
from sampling this continuous-time process at times tn = nT . νs = 1/T is
the sampling rate and T = τ (no dead time).
Let hA(n) be the pulse response of a discrete-time linear ﬁlter deﬁned
by
⎧
⎪
⎪
⎨
⎪
⎪
⎩
hA(0) = 1/
√
2 ,
hA(1) = −1/
√
2 ,
hA(n) = 0 ∀n < 0, n > 1 .
(6.154)
If the discrete-time process yτ(n) is applied to the input of this ﬁlter, the
output process yτ,A(n) is
yτ,A(n) =
∞

p=−∞
hA(p)y(n −p)
(6.155)
=
1
√
2 [(yτ(n) −yτ(n −1)] .
(6.156)

94
6 Stability
The mean value of this output process cancels
E{yτ,A(n)} = lim
N→∞
1
2N
N

−N+1
yτ(n) −yτ(n −1)
√
2
(6.157)
= lim
N→∞
1
2N
√
2(yτ(N) −yτ(−N))
(6.158)
= 0 .
(6.159)
Its variance is, therefore,
σ2
y,A(τ) = E [yτ,A(n) −E [yτ,A(n)]]2
(6.160)
= E [yτ,A(n)]2
(6.161)
= 1
2E [yτ(n) −yτ(n −1)]2 .
(6.162)
This is the deﬁnition of the Allan variance of the process yτ(n).
Consequently, the Allan variance of a discrete-time random process yτ(n)
is the variance of the process resulting from ﬁltering yτ(n) with the ﬁlter
whose impulse response is given by (6.154).
The frequency response of this ﬁlter is
HA(ν) =
n=+∞

n=−∞
hA(n) × exp−j2nπντ
(6.163)
= 1/
√
2 × (1 −cos 2πντ + j sin 2πντ) .
(6.164)
The square of its amplitude response is
|HA(ν)|2 = 1
2(1 −cos 2πντ)
(6.165)
= sin2 πντ .
(6.166)
This ﬁlter is a band-pass ﬁlter whose amplitude response equals 1 for the
frequency 1/2τ = νs/2 and 0 for the null and the sampling frequencies. Its
half power full width is δν1/2 = νs/2. Figure 6.8 shows the squared amplitude
response of the ﬁlter. It transmits without loss the Fourier components of the
input signal near 1/2τ and blocks the Fourier components of the input signal
near the null frequency.
The signal at the output of this ﬁlter is consequently free of the null
frequency component and contains mainly the Fourier components of the
input signal near 1/2τ.
In conclusion:
–
Allan variance σ2
y,A(τ) gives an indication of the spectral density of the
discrete-time process y(n) near the Fourier frequency 1/2τ = νs/2.
–
Allan variance is not sensitive to the Fourier frequencies near 0.
–
The process yτ(n) results from ﬁltering and sampling the continuous-time
process y(t), which is the process of interest.
www.ebook3000.com

6.2 Measurements in the Time Domain
95
Fig. 6.8. Squared amplitude response of the Allan ﬁlter
Information Given by Allan Variance
Random Frequency Fluctuations
Allan variance is the variance of the discrete-time process yτ(n) ﬁltered by
the ﬁlter HA(ν) described in Sect. 6.2.4.
If py(ν) is the spectral density of the reduced frequency ﬂuctuations y(t),
py,τ(ν) = py(ν) × |Gm(ν)|2
(6.167)
= py(ν) ×
sin πντ
πντ
2
(6.168)
is the power density of the continuous-time process yτ(t) resulting from fre-
quency measurements of duration τ.
The spectral density Py,τ(ν) of the discrete-time process yτ(n) resulting
from sampling yτ(t) with the sampling rate T = 1/νs is (see Sect. 6.2.2)
Py,τ(ν) =
∞

k=−∞
py,τ(ν + kνs)
(6.169)
=
∞

k=−∞
py(ν + kνs) × [Gm(ν + kνs)]2
(6.170)
=
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
.
(6.171)

96
6 Stability
The variance σ2
y(τ) of the discrete-time process yτ(n) is then
σ2
y(τ) =
 νs/2
−νs/2
Py,τ(ν)dν
(6.172)
=
 νs/2
−νs/2
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
dν
(6.173)
=
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
py(f) ×
sin (πfτ)
πfτ
2
df .
(6.174)
The discrete-time process yτ(n) is then ﬁltered by the Allan ﬁlter HA(ν).
The spectral density Py,τ,A(ν) of the resulting discrete-time process yτ,A(n)
is
Py,τ,A(ν) = Py,τ(ν) × |HA(ν)|2
(6.175)
=
∞

k=−∞
py(ν + kνs)
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
sin2 (πντ) .
(6.176)
We supposed that there is no dead time; 1/νs = T = τ.
Consequently,
sin2 (πντ) = sin2 [π(ν + kνs)τ] .
(6.177)
The variance of this ﬁltered discrete-time process, which is the Allan variance
of the reduced frequency ﬂuctuations, is then
σ2
y,A(τ) =
 νs/2
−νs/2
∞

k=−∞
py(ν + kνs)sin4 [π(ν + kνs)τ]
[π(ν + kνs)τ]2
dν
(6.178)
=
 ∞
−∞
py(f)sin4 (πfτ)
(πfτ)2
df .
(6.179)
Putting the dimensionless variable x = πτν,
σ2
y,A(τ) = 1
πτ
 ∞
−∞
P(x)sin4 (x)
x2
dx ,
(6.180)
where
P(x) = py
 x
πτ

.
(6.181)
This can be detailed for the ﬁve components of the frequency noise.
1. py(ν) = h0, P(x) = h0 (white frequency noise). In this case, (A.14) gives
σy,A(τ) = h0
2τ .
(6.182)
www.ebook3000.com

6.2 Measurements in the Time Domain
97
2. py(ν) = h1 |ν|, P(x) = (h1/πτ) |x| (ﬂicker phase noise).
In this case, the width of the noise spectrum (or of the measurement ap-
paratus) must be taken into account, otherwise the total power is inﬁnite.
νmax is the upper limit of the noise spectrum and xmax = πτνmax.
The Allan variance is
σy,A(τ) =
2
π2τ 2
 xmax
0
xsin4(x)
x2
dx .
(6.183)
Equation (A.15) gives
σy,A(τ) =
h1
4π2τ 2 [3.118 + 3 ln(πνmaxτ)] .
(6.184)
3. py(ν) = h2ν2, P(x) = (h2/π2τ 2)x2 (white phase noise).
In this case, the width of the noise spectrum (or of the measurement
apparatus) must be taken into account.
The Allan variance is then given by (see (A.16))
σy,A(τ) =
2
π3τ 3
 xmax
0
sin4(x)dx
(6.185)
= h2
3νmax
4π2
1
τ 2 .
(6.186)
4. py(ν) = h−1
ν−1, P(x) = (h−1 × πτ)
x−1 (ﬂicker frequency noise).
The Allan variance is given by (see (A.17))
σy,A(τ) = h−1
 ∞
−∞
sin4(x)
|x3|
dx
(6.187)
= 2 ln(2)h−1 .
(6.188)
5. py(ν) = h−2ν−2, P(x) = (h−2×π2τ 2)x−2 (random walk frequency noise).
The Allan variance is given by (see (A.18))
σy,A(τ) = h−2πτ
 ∞
−∞
sin4(x)
x4
dx
(6.189)
= 2π2
3 h−2 × τ .
(6.190)
Constant Frequency Drift
Assume a constant drift of the frequency during variance measurement
f(t) = f0 + δf0 + δf(t) + k × t .
(6.191)
In this relation, f(t) is the instantaneous frequency, f0 is the nominal fre-
quency, δf0 is a constant oﬀset due to inaccuracy, δf(t) is a random frequency
ﬂuctuation k is the frequency drift and t is time.

98
6 Stability
Application of the Allan variance algorithm gives the following results:
–
The value fτ(n −1) obtained at time (n −1)τ is
fτ(n −1) = 1
τ
 (n−1)τ
(n−2)τ
f(t)dt
(6.192)
= f0 + δf0 + δf(n −1) + kτ

n −1 −1
2

.
(6.193)
–
The value fτ(n) obtained at time nτ is
fτ(n) = 1
τ
 nτ
(n−1)τ
f(t)dt
(6.194)
= f0 + δf0 + δf(n) + kτ

n −1
2

.
(6.195)
–
The diﬀerence is
fτ(n) −fτ(n −1) = δf(n) −δf(n −1) + kτ .
(6.196)
–
The value returned by the algorithm
S2
A,y(τ) =
1
2f 2
0
1
N −1
N

1
(δf(n) −δf(n −1) + kτ)2
(6.197)
=
1
2f 2
0
1
N −1
N

1
(δf(n) −δf(n −1))2
+ 2kτ 1
2f 2
0
1
N −1
N

1
(δf(n) −δf(n −1))
+
1
2f 2
0
N
N −1 (kτ)2 .
(6.198)
Since
Eδf(n) −δf(n −1) = 0
(6.199)
we can write
S2
y(τ) = s2
y +
1
2f 2
0
N
N −1k2τ 2 .
(6.200)
The above expression shows that, as for the true variance, the constant
frequency shift appears as an additional term
s′2
y =
1
2f 2
0
N
N −1(kτ)2 .
(6.201)
www.ebook3000.com

6.2 Measurements in the Time Domain
99
This eﬀect is consequently much smaller than that obtained in the case of
the true variance, in the ration N(N + 1)/6: for N = 100, this ratio is larger
than 103.
Moreover, the response of the Allan variance to a constant frequency
drift is proportional to τ2, which is a response diﬀerent from the response
of this variance to the ﬁve possible components of the frequency noise; it is
consequently in principle possible to detect a constant frequency drift in the
experimental results given by the Allan variance.
Uncertainty in the Estimation of Allan Variance
Any real measurement is an estimation of the population variance using
N samples x(n) of the total (inﬁnite) population.
The estimator used is an unbiased one (see Sect. 6.2.3)
s2
x =
1
N −1
N

n=1

x(n) −x(n)
2
.
(6.202)
Allan variance, as well as any other variances described in this book, is the
variance of a discrete-time process z(n) which results from ﬁltering the pro-
cess yτ(n) by a speciﬁc ﬁlter. Consequently, since the same algorithm is used
to compute the estimator of the resulting variance, this estimator is unbiased.
It is possible to evaluate the uncertainty resulting from the use of a ﬁnite
number N of samples z(n) [116, 79, 80, 138].
The value s2
x,N of the estimator deﬁned by (6.202) is itself a random pro-
cess, the number N of measurements used to compute it being a parameter.
The variance of this quantity has been calculated in the case of Allan
variance [79, 80, 81]. It is then possible, knowing the number N, to draw
error bars on any frequency stability graph that uses the Allan deviation.
For large values of N, the fractional error ϵ varies inversely with the square
root of N,
ϵ =
K
√
N
.
(6.203)
0.7 < K < 1.1 is a coeﬃcient that depends mainly on the dominant contri-
bution to the frequency noise and on the dead time [81].
6.2.5 Hadamard Variance
Many other numeric ﬁlters can be (and have been) constructed on the scheme
of Allan variance, with the aim of obtaining a more accurate description of the
frequency noise. A best selectivity and a total rejection of constant frequency
drift are some of the required objectives.
Hadamard variance is based on the Hadamard transform [130], adapted
by R. A. Baugh [12].

100
6 Stability
As well as the Allan variance, the Hadamard variance ﬁlters the discrete-
time process resulting from the frequency measurements.
This ﬁlter is deﬁned by its impulse response, which may involve a large
number of samples. Each sample is the result of a frequency measurement over
a time τ. As usual, the sampling time may be diﬀerent from the measurement
duration τ if there is a dead time. We limit our discussion to the case T = τ.
As a spectral estimator, the Hadamard transform consequently has a higher
resolution than the Allan variance, whose impulse response involves only two
samples. In fact, Allan variance is a particular case of Hadamard variance.
For the purposes of time-domain frequency stability characterization, the
most important advantage of the Hadamard variance is its reduced sensitiv-
ity to a linear frequency drift, making it particularly useful for the analysis
of frequency standards that show a large frequency drift, such as rubidium
atomic frequency standards.
The Hadamard Filter
In its simplest form, the pulse response hH(n) of the Hadamard ﬁlter is deﬁned
by
hH(n) =

(−1)n 0 ≤n ≤2M −1
0
n < 0, n ≥2M
.
(6.204)
In the case of the modiﬁed Hadamard variance, each sample hH(n) of the
pulse response is multiplied by the binomial coeﬃcient
"2M−1
n
#
[81, 12]
hH(n) =

(−1)n ×
"2M−1
n
#
0 ≤n ≤2M −1
0
n < 0, n ≥2M
.
(6.205)
In both cases, if the discrete-time process yτ(n) is applied to the input of this
ﬁlter, the output sequence yτ,H(n) is
yτ,H(n) =
∞

p=−∞
hH(p)yτ(n −p)
(6.206)
=
2M−1

p=0
(−1)p × apyτ(n −p) .
(6.207)
ap equals 1 in the simple case,
"2M−1
n
#
in the case of the modiﬁed Hadamard
variance. The mean value of this output process is
E{yτ,H(n)} = lim
N→∞
1
2N
N

−N+1
2M−1

p=0
(−1)papyτ(n −p)
(6.208)
= 0
(6.209)
www.ebook3000.com

6.2 Measurements in the Time Domain
101
in both the simple case and the modiﬁed one, since
"2M−1
n
#
=
"2M−1
2M−1−n
#
.
(6.210)
Its variance is therefore
σ2
y,H(τ) = E

[yτ,H(n) −E [yτ,H(n)]]2 
(6.211)
= E [yτ,H(n)]2
(6.212)
= E
2M−1

p=0
(−1)p × apyτ(n −p)
2
.
(6.213)
This deﬁnes the Hadamard variance of the process yτ(n), which is conse-
quently the variance of the process ﬁltered by the ﬁlter whose impulse re-
sponse is given by (6.204) or (6.205).
The frequency response of this ﬁlter is in the simple case
HH(ν) =
n=+∞

n=−∞
hH(n) × exp−j2nπντ
(6.214)
=
2M−1

n=0
(−1)n × exp−j2nπντ
(6.215)
= j exp[−jπν(2M −1)T ]sin(2πνMT )
cos(πνT )
.
(6.216)
The square of its amplitude response is
|HH(ν)|2 =
sin(2MπνT )
cos(πνT )
2
.
(6.217)
This ﬁlter is a band-pass ﬁlter whose maximal amplitude response equals 2M
for the frequency 1/2τ = νs/2. The null and the sampling frequencies are
blocked. The half power width of the ﬁlter is approximately given by
δνH = νs
6
π(8M 2 −1) .
(6.218)
Figure 6.9 shows the squared amplitude response of the ﬁlter divided by
(2M)2 for M = 4.
This ﬁlter
–
is a band-pass ﬁlter, centered at ν = νs/2, as is the Allan ﬁlter;
–
removes the null frequency as well as the Allan ﬁlter; and
–
can be made much more selective than the Allan ﬁlter by choosing a large
value of M.
The result is qualitatively the same in the case of the modiﬁed Hadamard
variance. Figure 6.10 shows its squared amplitude response in the case M = 8.

102
6 Stability
Fig. 6.9. Squared amplitude response of the Hadamard ﬁlter for M = 4
Fig. 6.10. Squared amplitude response of the modiﬁed Hadamard ﬁlter for M = 8
www.ebook3000.com

6.2 Measurements in the Time Domain
103
Information Given by a Hadamard Variance
Random Frequency Fluctuations
Hadamard variance is the variance of the discrete-time process yτ,H(n), which
results from ﬁltering yτ(n) = δfτ(n)/f0 by the ﬁlter HH(ν) described in
Sect. 6.2.5.
The following discussion applies to the case of simple Hadamard variance,
deﬁned by (6.204). The results are qualitatively the same for the modiﬁed
Hadamard variance.
If py(ν) is the spectral density of the reduced frequency ﬂuctuations y(t),
pτ(ν) = py(ν) × |Gm(ν)|2
(6.219)
= py(ν) ×
sin πντ
πντ
2
(6.220)
is the power density of the continuous-time process yτ(t) resulting from fre-
quency measurements of duration τ.
The spectral density P T
τ (ν) of the discrete-time process yT
τ (n) resulting
from sampling yτ(t) with the sampling rate T = τ = 1/νs (no dead time) is
(see Sect. 6.2.2)
Py,τ(ν) =
∞

k=−∞
pτ(ν + kνs)
(6.221)
=
∞

k=−∞
pτ(ν + kνs) × [Gm(ν + kνs)]2
(6.222)
=
∞

k=−∞
pτ(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
.
(6.223)
The variance σ2
y(τ) of the discrete-time process yτ(n) is then
σ2
y(τ) =
 νs/2
−νs/2
Py,τ(ν)dν
(6.224)
=
 νs/2
−νs/2
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
dν
(6.225)
=
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
py(f) ×
sin (πfτ)
πfτ
2
df .
(6.226)
The discrete-time process yτ(n) is then ﬁltered by HH(ν). The spectral den-
sity PH,τ(ν) of the resulting discrete-time process yH,τ(n) is
PH,τ(ν) = Py,τ(ν) × |HH(ν)|2
=
∞

k=−∞
py(ν + kνs) ×
sin [π(ν + kνs)τ]
π(ν + kνs)τ
2
×
sin(2Mπντ)
cos(πντ)
2
.
(6.227)

104
6 Stability
Since νs = 1/T = 1/τ, we have
sin2 (2Mπντ) = sin2 [2Mπ(ν + kνs)τ] ,
(6.228)
cos2(πνT ) = cos2(π(ν + kνs)τ) .
(6.229)
The variance σ2
y,H(τ) of this discrete-time process, which is the Hadamard
variance of the reduced frequency ﬂuctuations is consequently
σ2
y,H(τ) =
∞

k=−∞
 (k+1/2)νs
(k−1/2)νs
p(ν + kνs) × sin2 [π(ν + kνs)τ]
[π(ν + kνs)τ]2
× sin2(2Mπ(ν + kνs)τ)
cos2(π(ν + kνs)τ)
dν .
(6.230)
With f = ν + kνs
σ2
y,H(τ) =
 ∞
−∞
p(f)sin2 (πfτ)
(πfτ)2
sin(2Mπfτ)
cos(πfτ)
2
df .
(6.231)
Putting the dimensionless variable x = πτν
σ2
y,H(τ) = 1
πτ
 ∞
−∞
P(x)sin2(x)
x2
sin2(2Mx)
cos2(x)
dx .
(6.232)
In this equation,
P(x) = p
 x
πτ

.
(6.233)
This can be detailed for the ﬁve power laws of the frequency noise model.
The results are given for 2M = 6.
1. py(ν) = h0, P(x) = h0 (white frequency noise).
In this case, (A.20) gives
σy,H(τ) = h0
πτ
 ∞
−∞
sin2 (x)
x2
sin2(6x)
cos2(x) dx
(6.234)
= 4h0
τ
.
(6.235)
2. py(ν) = h1 |ν|, P(x) = (h1/πτ) |x| (ﬂicker phase noise).
In this case, the width of the noise spectrum (or of the measurement ap-
paratus) must be taken into account, otherwise the total power is inﬁnite.
νmax is the upper limit of the noise spectrum and xmax = πτνmax.
The Hadamard variance is then given by (see (A.22))
σy,H(τ) =
2h1
(πτ)2
 xmax
0
sin2(x)
x
sin2(6x)
cos2(x) dx
(6.236)
= 11h1
π2
[ln(πνmaxτ) + γ] 1
τ 2 .
(6.237)
www.ebook3000.com

6.2 Measurements in the Time Domain
105
3. py(ν) = h2ν2, P(x) = (h2/π2τ 2)x2 (white phase noise).
In this case, the width of the noise spectrum (or of the measurement ap-
paratus) must be taken into account, otherwise the total power is inﬁnite.
νmax is the upper limit of the noise spectrum and xmax = πτνmax.
The Hadamard variance is then given by (see (A.24))
σy,H(τ) =
2h2
(πτ)3
 xmax
0
sin2(x)sin2(6x)
cos2(x) dx
(6.238)
= h2
7νmax
π2
1
τ 2 .
(6.239)
4. py(ν) = h−1
ν−1, P(x) = (h−1 × πτ)
x−1 (ﬂicker frequency noise).
The Hadamard variance is given by (see (A.26))
σy,H(τ) = h−1
 ∞
0
sin2(x)
x3
sin2(6x)
cos2(x) dx
(6.240)
= 13.42 × h−1 .
(6.241)
5. py(ν) = h−2ν−2, P(x) = (h−2×π2τ 2)x−2 (random walk frequency noise).
The Hadamard variance is given by (see (A.28))
σy,H(τ) = h−2πτ
 ∞
−∞
sin2(x)
x4
sin2(6x)
cos2(x) dx
(6.242)
= 8π2h−2 × τ .
(6.243)
Constant Frequency Drift
Assume a constant drift of the frequency during variance measurement
f(t) = f0 + δf0 + δf(t) + k × t .
(6.244)
In this relation, f(t) is the instantaneous frequency, f0 is the nominal fre-
quency, δf0 is a constant oﬀset due to inaccuracy, δf(t) is a random frequency
ﬂuctuation, k is the frequency drift coeﬃcient and t is time.
Application of the simple Hadamard algorithm to this oscillator gives the
following results (in the case T = τ, no dead time).
–
The value fτ(n) obtained at time (n)τ is
fτ(n) = 1
τ
 (n)τ
(n−1)τ
f(t)dt
(6.245)
= f0 + δf0 + δf(n) + kτ

n −1
2

.
(6.246)

106
6 Stability
–
The value fτ(n −p) obtained at time (n −p)τ is
fτ(n −p) = 1
τ
 (n−p)τ
(n−p−1)τ
f(t)dt
(6.247)
= f0 + δf0 + δf(n −p) + kτ

n −p −1
2

.
(6.248)
–
The output f τ
H,τ(n) of the ﬁlter is
f τ
H,τ(n) =
2M−1

p=0
(−1)pfτ(n −p)
=
2M−1

p=0
(−1)pδf(n −p) + kτ
2M−1

p=0
(−1)p

n −p −1
2

=
2M−1

p=0
(−1)pδf(n −p) + kτ
2M−1

p=0
(−1)p(−p) .
(6.249)
However, we have
2M−1

p=0
(−1)p(−p) = M
(6.250)
and consequently
fH,τ(n) =
2M−1

p=0
(−1)pδf(n −p) + Mkτ .
(6.251)
–
The value S2
H,y(τ) returned by the algorithm applied to N frequency
measurements is
S2
H,y(τ) = 1
f 2
0
1
N −1
N

1
(fH,τ(n))2
(6.252)
= 1
f 2
0
1
N −1
N

1
2M−1

p=0
(−1)pδf(n −p) + Mkτ
2
= 1
f 2
0
1
N −1
N

1
2M−1

p=0
(−1)pδf(n −p)
2
+ 1
f 2
0
N
N −1M 2k2τ 2
+ 2
f 2
0
Mkτ
1
N −1
N

1
2M−1

p=0
(−1)pδf(n −p)

.
(6.253)
www.ebook3000.com

6.2 Measurements in the Time Domain
107
Since
Eδf(n) = 0 ,
(6.254)
we can write
S2
H,y(τ) = 1
f 2
0
1
N −1
N

1
2M−1

p=0
(−1)pδf(n −p)
2
+ 1
f 2
0
N
N −1M 2k2τ 2
= σ2
H,y(τ)
+ 1
f 2
0
N
N −1M 2k2τ 2 .
(6.255)
In the above expression, σ2
H,y(τ) is the result that should have been ob-
tained if there had been no drift and
1
f 2
0
N
N −1M 2k2τ 2
(6.256)
is the additional term due to the drift.
This result shows that, as for the true variance and the Allan variance, the
constant frequency shift appears as an additional term.
This additional term is much smaller the the eﬀect obtained in the case
of the true variance, in the ration N(N + 1)/6. For N = 100, this ratio is
larger than 103.
Moreover, as in the case of Allan variance, the response of the Hadamard
variance to a constant frequency drift is proportional to τ2, which is a re-
sponse diﬀerent from the response of this variance to the ﬁve possible compo-
nents of the frequency noise; it is consequently in principle possible to detect
a constant frequency drift in the experimental results given by the Hadamard
variance.
6.2.6 Getting Rid of a Constant Frequency Drift
For both Allan and Hadamard variances, a constant frequency drift superim-
posed to a stationary random frequency ﬂuctuation produces an additional
term that cannot be directly separated from the one due to the random fre-
quency ﬂuctuations.
This is due to the fact that both algorithms are not balanced in order to
cancel the eﬀect of the drift for successive measurements of duration τ.
–
In the Allan variance algorithm, the two successive measurements of the
mean value of the drift do not give the same result; their diﬀerence does
not cancel. The drift contribution is consequently kτ, if k is the slope of
the drift.

108
6 Stability
–
In the Hadamard algorithm, this eﬀect is cumulated on the 2M successive
measurements, giving a contribution of Nkτ.
A simple way to design an algorithm that cancels the eﬀect of the frequency
drift is to superpose two similar unbalanced algorithms, one giving a positive
contribution of the drift and the other giving a negative one that exactly
cancels the ﬁrst.
Modifying the Hadamard Algorithm
Equation (6.249) shows that the eﬀect of the drift is given by the sum
2M−1

p=0
(−1)p(−p) = M .
(6.257)
If the Hadamard ﬁlter is modiﬁed according to the new impulse response
hHm(n),
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
hHm(0) = 1
hHm(1) = −1
· · ·
hHm(2M −2) = 1
hHm(2M −1) = −2
hHm(2M) = 1
· · ·
hHm(4M −2) = 1
hHm(n) = 0 ∀n < 0, n > 4M −2 .
(6.258)
The sum
4M−2

p=0
hHm(n)(−p) =
2M−1

p=0
(−1)p(−p) +
4M−2

p=2M−1
(−1)p(−p)
= M −M
= 0
(6.259)
and any linear frequency drift is canceled by the algorithm.
www.ebook3000.com

6.2 Measurements in the Time Domain
109
The frequency response of this balanced Hadamard ﬁlter is
HHm = (ν) =
2M−1

n=0
(−1)n × exp−j2nπντ +
4M−2

n=2M−1
(−1)n × exp−j2nπντ
= j exp[−j(2M −1)πνT ]sin(2MπνT )
cos(πνT )
×
'
1 + (−1)2M−1 exp[−j(2M −1)2πνT ]
(
= −2 exp[−j(2M −1)2πνT ]sin(2MπνT ) sin[(2M −1)πνT ]
cos(πνT )
= −exp[−j(2M −1)2πνT ]cos(πνT ) −cos[(4M −1)πνT ]
cos(πνT )
= −exp[−j(2M −1)2πνT ]

1 −cos[(4M −1)πνT ]
cos(πνT )

.
(6.260)
Its squared amplitude response is
|HHm|2 =

1 −cos[(4M −1)πνT ]
cos(πνT )
2
,
(6.261)
which is very close to the response of the classical Hadamard variance us-
ing nearly the same number of samples (in fact, there is a diﬀerence of one
sample), as shown in Fig. 6.11.
Fig. 6.11. Squared amplitude response of the balanced Hadamard ﬁlter with
(M = 4)

110
6 Stability
The Simplest Algorithm: Three-samples Variance
This is the algorithm described above with M = 1. In this case, the impulse
response of the ﬁlter is
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
h3(0) = 1
h3(1) = −2
h3(2) = 1
h3(n) = 0 ∀n < 0, n > 2 .
(6.262)
This is the so-called three-samples variance, introduced by Boileau and Picin-
bono [16]. The results of (6.261) with M = 1 give for its squared amplitude
response
|H3|2 =

1 −cos[(3)πνT ]
cos(πνT )
2
= 16 sin4(πνT ) .
(6.263)
Figure 6.12 shows the squared amplitude response of this ﬁlter.
The value of the three-samples variance σ2
y,3(τ) for a frequency noise
whose power spectra is p(ν) is given by (assuming T = τ, no dead time)
σ2
y,3(τ) = 16
 ∞
−∞
p(ν)sin2(πντ)
(πντ)2
sin4(πντ)dν .
(6.264)
Fig. 6.12. Squared amplitude response of the three-samples ﬁlter
www.ebook3000.com

6.2 Measurements in the Time Domain
111
Using the reduced variable x = πντ, the three-samples variance can be writ-
ten as
σ2
y,3(τ) = 16
πτ
 ∞
−∞
P(x)sin6(x)
(x)2
dx
(6.265)
with
P(x) = p
 x
πτ

.
(6.266)
This can be detailed for the various power laws of the frequency noise model.
1. py(ν) = h0, P(x) = h0 (white frequency noise). In this case, (A.31) gives
σy,3(τ) = 6h0
τ
.
(6.267)
2. py(ν) = h1 |ν|, P(x) = (h1/πτ) |x| (ﬂicker phase noise).
In this case, the width of the noise spectrum (or of the measurement ap-
paratus) must be taken into account, otherwise the total power is inﬁnite.
νmax is the upper limit of the noise spectrum and xmax = πτνmax.
The three-samples variance is then given by (see (A.30))
σy,3(τ) = 32h1
(πτ)2
 xmax
0
sin6(x)
x
dx
(6.268)
= 10h1
π2
[ln(πνmaxτ) + γ] 1
τ 2 .
(6.269)
3. py(ν) = h2ν2, P(x) = (h2/π2τ 2)x2 (white phase noise).
In this case, the width of the noise spectrum (or of the measurement ap-
paratus) must be taken into account, otherwise the total power is inﬁnite.
νmax is the upper limit of the noise spectrum and xmax = πτνmax.
The three-samples variance is then given by (see (A.29))
σy,3(τ) = 32h2
(πτ)3
 xmax
0
sin6(x)dx
(6.270)
= h2
10νmax
π2
1
τ 2 .
(6.271)
4. py(ν) = h−1
ν−1, P(x) = (h−1 × πτ)
x−1 (ﬂicker frequency noise).
The three-samples variance is given by (see (A.32))
σy,H(τ) = 32h−1
 ∞
0
sin6(x)
x3
dx
(6.272)
= 13.50 × h−1 .
(6.273)

112
6 Stability
5. py(ν) = h−2ν−2, P(x) = (h−2×π2τ 2)x−2 (random walk frequency noise).
The three-samples variance is given by (see (A.33))
σy,H(τ) = 32πτh−2
 ∞
0
sin6(x)
x4
dx
(6.274)
= 128π2h−2 × τ .
(6.275)
This simple algorithm gives results quite similar to those of Allan and
Hadamard variances and is free from any constant frequency drift.
6.2.7 The Best Variance for a Given Application
Many kinds of variances have been proposed and their properties are slightly
diﬀerent. Facing a given application, the question arises as to the choice of
the best algorithm for this application.
The following discussion is focused on three variances:
–
Allan variance,
–
Hadamard variance (with 2M = 6), and
–
three-samples variance.
Summary of the Results Given by Allan, Hadamard
and Three-samples Variances
Table 6.2 summarizes the values of the bandwidth of the variances.
The bandwidth of the Hadamard variance can be made very small by
choosing large values of the number 2M of samples used in its algorithm.
The bandwidth of Allan and three-samples variances are very similar.
Table 6.3 shows that the responses of the three variances are very similar;
this is not a criterion for choosing a variance.
In fact, the main criteria for choosing a variance can hardly be predicted
from these results. They are as follows:
–
The ability to give a result free from frequency drifts. Only the three-
samples variance possesses this property.
–
The ability to characterize the frequency or phase noise that perturbs the
frequency of the oscillator under test. This will be detailed in the next
section.
Table 6.2. Bandwidth of Allan, Hadamard and three-samples variances
Variance
Bandwidth
Allan
0.250 × νs
Hadamard (2M = 6)
0.070 × νs
Three-samples
0.182 × νs
www.ebook3000.com

6.2 Measurements in the Time Domain
113
Table 6.3. Response to some noise spectral density laws
Power law
Variance
Result
Allan
h−2 × 2π2/3 × τ +1
h−2ν−2
Hadamard (2M = 6)
h−2 × 8π2 × τ +1
Three-samples
h−2 × 128π2 × τ +1
Allan
h−1 × 1.39 × τ 0
h−1 |ν|−1
Hadamard (2M = 6)
h−1 × 13.42 × τ 0
Three-samples
h−1 × 13.50 × τ 0
Allan
h0/2 × τ −1
h0ν0
Hadamard (2M = 6)
h0 × 4 × τ −1
Three-samples
h0 × 6 × τ −1
Allan
h1 × 3 [ln(πνmaxτ) + 1.04] /4π2 × τ −2
h1 |ν|+1
Hadamard (2M = 6)
h1 × 11 [ln(πνmaxτ) + 0.56] /π2 × τ −2
Three-samples
h1 × 10 [ln(πνmaxτ) + 0.56] /π2 × τ −2
Allan
h2 × 3νmax/4π2 × τ −2
h2ν+2
Hadamard (2M = 6)
h2 × 7νmax/π2 × τ −2
Three-samples
h2 × 10νmax/π2 × τ −2
Analysis of the Frequency Noise
The frequency noise that perturbs the output frequency of an ultra-stable
oscillator is a combination of the various power laws described in Sect. 6.2.2.
For a given Fourier frequency, one of these components is predominant.
The ability of the diﬀerent variances to identify which component is domi-
nant in a given Fourier frequency range is its main quality; this will be studied
now.
Figure 6.13 shows the result of an ideal superposition of the ﬁve power
laws. Coeﬃcients h2, h1, h0, h−1 and h−2 of the power laws have been chosen
in such a way that every component is predominant in a range of frequencies
of ﬁve decades. The absolute values of frequencies and spectral densities are
of no importance for this abstract example.
The components are the following:
h−2 × 1/ν2 (h−2 = 1010)
predominant for ν < ν1 = 1 Hz.
h−1 × 1/ν
(h−1 = 105)
predominant for ν > ν1 = 1 Hz.
h0
(h0 = 1)
predominant for ν > ν2 = 105 Hz.
h1 × ν
(h1 = 10−5)
predominant for ν > ν3 = 1010 Hz.
h2 × ν2
(h2 = 10−10)
predominant for ν < ν4 = 1015 Hz.
The results that should be given by the Allan variance, the Hadamard
variance (with 2M = 6) and the three-samples variance applied to this
ideal model of frequency noise are shown in Fig. 6.14 for T = τ (no dead
time).

114
6 Stability
Fig. 6.13. Model of frequency noise showing the ﬁve power laws
–
The positive slope of the curves (slope +1 in logarithmic coordinates)
occurs when the ﬁlter associated with the variance (Allan, Hadamard
or three-samples) is centered in a Fourier frequency domain where the
component h−2 × 1/ν2 of the noise is predominant.
–
The horizontal part of the curves (slope 0 in logarithmic coordinates)
occurs when the ﬁlter is centered in a Fourier frequency domain where
the component h−1 × 1/ν of the noise is predominant.
–
The slope −1 in logarithmic coordinates occurs when the ﬁlter is centered
in a Fourier frequency domain where the component h0 is predominant.
–
The slope −2 in logarithmic coordinates occurs when the ﬁlter is cen-
tered in a Fourier frequency domain where the component h−1 or h−2 is
predominant.
The ﬁlter associated with every variance is centered at the Fourier frequency
νc = νs/2 = 1/2T .
Consequently:
–
The component h−2 × 1/ν2 of the noise should appear when T > 1/2ν1.
–
The component h−1 × 1/ |ν| of the noise should appear when 1/2ν2 <
T < 1/2ν1.
–
The component h0 × 1/ |ν| of the noise should appear when 1/2ν3 < T <
1/2ν2.
–
The component h1 × 1/ |ν| of the noise should appear when 1/2ν4 < T <
1/2ν3.
–
The component h2 × 1/ |ν| of the noise should appear when T < 1/2ν4.
www.ebook3000.com

6.2 Measurements in the Time Domain
115
Fig. 6.14. Comparison of Allan (lower curve), Hadamard and three-samples (upper
curve) variances
In fact, the values of the limits indicated above can be strongly modiﬁed due
to the diﬀerence between the sensibility of the variance to each component
of the noise. Further, some components can be completely masked by the
others.
Consequently, it is important to notice that a given variance can show an
erroneous component of the frequency noise for a given sampling time. This
is discussed below.
Sensitivity to the Diﬀerent Noise Components
As a general rule, it is clear that a large diﬀerence between the sensitivity of
a given variance to the diﬀerent components of the frequency noise may lead
to the masking of the component with the lowest sensitivity by a neighbor
component with a high sensitivity.
The Components h1 |ν| and h2ν2
For the three variances, these two components give very similar results (see
Table 6.3, Sect. 6.3). Consequently, it is generally not possible to decide
from experimental results which one of these two contributions exist in the
frequency noise. Figure 6.15 compares two calculated Allan variances when
only one of these two frequency noise components exists but not the other.
On the other hand, the contribution of the white frequency noise is the

116
6 Stability
same for the two curves. It is clear from this ﬁgure that the two curves
are very close to each other and cannot be distinguished in experimental
results.
If the two components exist, the second one (h2ν2) generally masks the
ﬁrst one because the sampling time for which the eﬀect of the component
h2ν2 becomes smaller than that of the component h1 |ν| occurs for values
where both are masked by some other component. If ν2 is the Fourier fre-
quency where the two branches corresponding to these two components of
the frequency noise intersect, the value of ν2 is given by
h2ν2
2 = h1ν2 ,
ν2 = h1
h2
.
(6.276)
The two corresponding branches of the variance intersect for the value T2 = τ2
of the sampling time deﬁned by
h1g1 ln(πνmaxT2 + k) = h2g2νmax ,
T2 ≈
1
πνmax
× exp
g2
g1
νmax
ν2

.
(6.277)
g1 and g2 are numerical coeﬃcients that depend on the variance. They are
summarized in Table 6.3.
Fig. 6.15. Allan variance with h1 |ν| noise (lower curve) and with h2ν2 noise (upper
curve)
www.ebook3000.com

6.2 Measurements in the Time Domain
117
Fig. 6.16. Allan variance and the two asymptotes corresponding to h1 and h2
Putting
νmax
ν2
= K ≫1 ,
we have
T2 ≈
1
Kπν2
× exp
g2
g1
K

≫1
ν2
.
(6.278)
In conclusion, for each variance, the intersection of the two branches is
strongly shifted toward the high values of T , where other components are
dominant. This is shown in Fig. 6.16 where the Allan variance is calcu-
lated in a case where both components h1 |ν| and h2ν2 of frequency noise
exist. The two straight lines are the asymptotes corresponding to the two
components. The ﬁgure shows that the second component totally masks the
ﬁrst one.
The Components h−2ν−2, h−1
ν−1 and h0
The eﬀect of these components can be written for all the variances as gi ×
T i with i = 1, 0, −1, respectively. It is now interesting to study the ratio
between the coeﬃcients gi of two successive branches of a given variance.
These branches appear as the sampling time T (assumed equal to τ) is varied.
If one of these coeﬃcients is much larger than the coeﬃcient of a following
branch, the branch with the larger coeﬃcient will mask the branch with
the smaller coeﬃcient. These ratios are shown in Fig. 6.17. They have been
calculated with 2M = 6 for the Hadamard variance.

118
6 Stability
These values show that
–
the Allan variance has the overall smallest diﬀerence from g−2 to g0;
–
the three-samples variance shows a large diﬀerence between g−2 and g−1:
g−2 is 20 dB above g−1; and
–
the Hadamard variance (2M = 6) is quite close to the Allan variance.
For instance, in the case of the three-samples variance, the limit between
the T 1 and T 0 parts of the curve is shifted toward the low values of T , as
shown in Fig. 6.14. In Fig. 6.18, the width of the frequency domain where the
component h−1 ×|ν|−1 of the frequency noise is dominant has been modiﬁed,
the other ones being unchanged. This noise component is not detected by the
three-samples variance, although it is dominant during three decades.
Fig. 6.17. Ratio of the coeﬃcients of the three branches for three variances
Fig. 6.18. Three-samples variance. The width of the frequency domain where the
component h−1 × |ν|−1 of the frequency noise is dominant is three decades
www.ebook3000.com

6.2 Measurements in the Time Domain
119
Fig. 6.19. Allan variance. The width of the frequency domain where the component
h−1 × |ν|−1 of the frequency noise is dominant is three decades
On the other hand, this component is clearly detected by the Allan vari-
ance, (as shown in Fig. 6.19), and by the Hadamard variance.
Linear Frequency Drift
Only the three-samples variance is completely insensitive to any linear fre-
quency drift. Allan variance and Hadamard variance are sensitive to a linear
frequency drift. Their responses to such a drift are given by (6.201), p. 100 for
Allan variance and by (6.256), p. 109 for Hadamard variance. Table 6.4 gives
the sensitivity of the three variances to a liner frequency drift characterized by
fd(t) = k × t ,
(6.279)
yd(t) = fd(t)
f0
= ky × t .
(6.280)
The dimension of the coeﬃcient k is Hz2 (or s−2), that of the coeﬃcient ky
is Hz (or s−1).
The response of the Allan variance and the Hadamard variance to this
constant frequency drift is proportional to the square of the sampling time,
Table 6.4. Sensitivity to a constant frequency drift
Variance
Response to a constant frequency drift
Allan
N/2(N −1) × (kyτ)2
Hadamard (2M = 6)
36N/(N −1) × (kyτ)2
Three-samples
0

120
6 Stability
supposed to be equal to the duration of the individual frequency measure-
ments τ.
In order to characterize the importance of the contribution of the fre-
quency drift on the experimental result, the cut-oﬀsampling time T (sup-
posed equal to τ) for which the eﬀect of the frequency drift equals that of
the random walk frequency noise (ν−2 power law) is compared for the three
variances in Table 6.5.
The larger this value, the smaller the eﬀect of the frequency drift on the
measurement. Table 6.5 shows that the Allan variance gives better results
than the Hadamard variance.
Figures 6.20 and 6.21 show the results given by the Allan variance and
the Hadamard variance, respectively, in the case where the output frequency
of the oscillator under test is perturbed by the frequency noise deﬁned in
Fig. 6.13 and by a constant frequency drift characterized by ky = 103 × h−2.
They show that while the component h−2ν−2 (random walk frequency noise)
of the frequency noise is quite visible in the case of the Allan variance,
it is much less clearly detected in the case of the Hadamard variance, be-
cause it is masked by the eﬀect of the constant drift. Of course, the three-
samples variance is free of any eﬀect related to a constant frequency drift
and should be used when it is important to get rid of a constant frequency
drift.
Table 6.5. Cut-oﬀsampling time
Variance
Cut-oﬀsampling time
Allan
(N −1)/N × 4π2/3 × h−2/k2
y ≈13.2 × h−2/k2
y
Hadamard (2M = 6) (N −1)/N × 2π2/9 × h−2/k2
y ≈2.19 × h−2/k2
y
Three-samples
No eﬀect
Fig. 6.20. Allan variance with a constant frequency drift
www.ebook3000.com

6.2 Measurements in the Time Domain
121
Fig. 6.21. Hadamard variance with a constant frequency drift
6.2.8 Practical Time Domain Measurements
of Frequency Stability
Variance and Standard Deviation
The stability of an ultra-stable oscillator, when measured in the time domain,
is usually characterized by the (Allan or Hadamard or any other . . . ) standard
deviation.
The standard deviation is the square root of the variance: the Allan stan-
dard deviation, for instance, is the square root of the Allan variance.
Frequency Measurements
The ﬁrst step of the time domain measurements of the frequency stability is
a series of frequency measurements. The duration of each of these measure-
ments is τ. The following two situations are possible.
1. There exists an oscillator whose stability is better than that of the oscil-
lator under test. This is the reference oscillator.
In this case, it is easy to measure the mean value of the frequency of
the oscillator under testing during successive time intervals of dura-
tion τ by frequency comparison with this reference oscillator. For in-
stance, the reference oscillator can be used as a local oscillator to down
convert the frequency of the oscillator under test. The down converted
frequency is such that it can be easily measured by a frequency counter
(see Fig. 6.22).
2. The oscillator under testing is supposed to have the best stability prop-
erties and there is consequently no other oscillator that can be used like
a reference oscillator.

122
6 Stability
Fig. 6.22. Frequency measurement in the case where a reference oscillator can be
used
Fig. 6.23. Stability measurement with two identical oscillators
In this case, the frequency of two specimens of the same oscillator are
compared and the ﬂuctuations of the frequency diﬀerence between the
two specimens are studied. It is possible to shift the frequency of one of
the two oscillators in order to obtain a diﬀerence frequency that can be
easily measured (see Fig. 6.23).
It is assumed that the two specimens have the same stability properties
and that the frequency ﬂuctuations are not correlated. Consequently, the
mean square value of the ﬂuctuations of the diﬀerence of the frequency of
the two oscillators equals twice the mean square value of the ﬂuctuations
of one of the oscillators.
The variance of each oscillators is the measured variance of the diﬀerence
of the frequencies of the two oscillators divided by two, and the deviation
of each oscillator is the measured deviation divided by
√
2.
6.2.9 Typical Values
A few stability values of some frequency standards are given below.
A Microfabricated Atomic Clock
This device is described in [72]. It is a passive atomic frequency standard
that uses the hyperﬁne transition of cesium as a reference (see also [50]).
The main parameters of its physical package are the following:
–
volume: 9.5 mm3, and
–
power dissipation: 75 mW.
www.ebook3000.com

6.2 Measurements in the Time Domain
123
It is clear that the main objective of this kind of device is not to obtain the
best values of stability and accuracy but to enable low-cost mass production.
Consequently, it is possible to characterize its frequency stability with
a reference oscillator that is much more stable.
It shows a linear fractional frequency drift that has been measured
by direct comparison with a stable oscillator. This drift is about −2 ×
10−8/day [72], which corresponds to
dy = 2.3 × 10−13 s−1 .
(6.281)
This drift should give a component σ′
y(τ) to the Allan deviation equal to
σ′
t(τ) =
)
1
2dyτ
= 1.6 × 10−13 × τ .
(6.282)
This is in good agreement with the experimental Allan deviation shown in
Fig. 3 of [72].
For small values of the sampling time, the experimental Allan deviation
is ﬁtted by 2.4 × 10−10/√τ, which corresponds to a white frequency noise
with a spectral density h0 equal to
h0 = 1.15 × 10−19 Hz−1 .
(6.283)
Because the frequency drift is measured directly, it is possible to remove it
from the calculation of the variance. This has been done in [72] and the
long-term Allan deviation with this drift removed is approximately
σy(τ) = 1.5 × 10−12 × τ 1/2 .
(6.284)
This corresponds to a component of the frequency noise h−2ν−2 (random
walk frequency noise) with
h−2 = 3.4 × 10−25 Hz .
(6.285)
The ﬂicker frequency noise component, if any, is masked by these two com-
ponents: no horizontal ﬂoor is visible on the Allan deviation graph of this
device to the level of 2.5 × 10−11 for a sampling time of 250 s. Consequently,
the dimensionless coeﬃcient h−1 of this component is smaller than
h−1,max =
"
2.5 × 10−11#2
1.39
= 4.5 × 10−22 .
(6.286)
Figure 6.24 shows the spectral density of the frequency noise of this oscillator
deduced from the Allan variance measurement.
The measurements reported in [72] were taken for sampling times be-
tween 1 and about 2000 s. The center frequency of the ﬁlter equivalent to
the Allan algorithm was varied between 0.5 and 2.5 × 10−4 Hz. The curve of
Fig. 6.24 is consequently limited to this range of frequencies.

124
6 Stability
Fig. 6.24. Frequency noise spectral density of the oscillator of [72]
Commercially Available Active Hydrogen Maser
The hydrogen maser is a device that provides excellent medium-term and
long-term stability.
The results of Table 6.6 are those published by Precise Time and Fre-
quency, Inc. (PTF) for the CHI-75 active hydrogen maser [104] (no dead
time: the sampling time equals the frequency measurement duration). They
give the Allan deviation for some values of the sampling time. They are “typ-
ical values” and do not describe a given device.
These results show two components of the frequency noise.
1. The ﬁrst component is dominant for the sampling times larger than about
100 s. The corresponding Allan deviation is proportional to 1/
√
T, i.e.
Table 6.6. Typical values of the Allan standard deviation of the CHI-75 active
hydrogen maser
Sampling time (s) Allan deviation
1
2 × 10−13
10
2.5 × 10−14
100
5 × 10−15
1000
1.6 × 10−15
3600
1 × 10−15
10000
7 × 10−16
100000
2 × 10−16
www.ebook3000.com

6.2 Measurements in the Time Domain
125
Allan variance is proportional to 1/T . It is consequently a white frequency
noise (see Table 6.3).
2. The second component is dominant for the sampling times 1 s ≤T ≤100 s
and leads to an Allan deviation proportional to 1/T , i.e. an Allan vari-
ance proportional to 1/T 2. It is one of the two frequency noise compo-
nents ﬂicker phase noise (h1 |ν|) or white phase noise (h2ν2), as shown in
Fig. 6.15.
Commercially Available Cesium Frequency Standard
The results of Table 6.7 are those published by Symmetricom for the 5071A
Primary Frequency Standard (High Performance) [113]. They give the Allan
deviation for some values of the sampling time. Moreover, the guaranteed
ﬂicker ﬂoor is 1 × 10−14.
These values show that the dominant component of the frequency noise
all over the range 0.01 →106 s is the white frequency noise.
Table 6.7. Speciﬁcation values of the Allan deviation for the 5071A primary fre-
quency standard (high performance)
Sampling time (s)
Allan deviation
0.01
7.5 × 10−11
1
5 × 10−12
100
8.5 × 10−13
10 000
8.5 × 10−14
2.592 × 106
1 × 10−14
Atomic Fountain Primary Frequency Standard
These frequency sources are designed in order to obtain the best values of
accuracy and long-term stability. They are laboratory devices that must be
handled by highly specialized staﬀ. They are described, for instance, in [125,
57, 101, 14, 124].
The stability values given in [124] have been obtained using the following
protocol.
1. Since the stability of these devices are among the best values, only a com-
parison of two identical apparatus can provide a reliable result.
2. Two identical atomic fountains have consequently been built. The mi-
crowave signal probing the atomic transition of each apparatus (see
Sect. 2.3.5) is synthesized from a cryogenic sapphire oscillator (CSO) [92]
phase-locked to a hydrogen maser with a long time constant (i.e. a low

126
6 Stability
cut-oﬀfrequency of the low-pass ﬁlter of the loop). The short-term sta-
bility (≈10−15) is that of the CSO up to 800 s, whereas the long-term
stability is given by the maser. Each frequency chain uses a 7.3 MHz signal
generated by a computer-controlled high-resolution synthesizer. The de-
tected atomic transition probability determines the frequency corrections
applied to the microwave probing signal via the synthesizer. These cor-
rections are the base for the accuracy and frequency stability evaluation
of each fountain.
The Allan deviation of the frequency diﬀerence between the two frequency
standards is 5 × 10−14/
√
T for sampling times T between 100 s and 3 × 104 s
(the value of the standard deviation for T = 3×104 s is 3×10−16). This result
corresponds to a white frequency noise whose fractional spectral density is
py(ν) = 5 × 10−27 Hz−1.
www.ebook3000.com

Part III
Applications

7 Time and Frequency Metrology
The second is one of the seven SI base units. Its practical realization provides
the best standard uncertainty. The uncertainties for the seven SI base units
are shown in Table 7.1 [105].
Furthermore, the deﬁnition of the unit of length (meter) relies on the
realization of the second: “The meter is the length of the path traveled by
light in vacuum during a time interval of 1/299 792 458 of a second.” [19, 20].
Special care must therefore be taken in the process of dissemination of
this SI unit to the users. The needs of the ﬁnal users may be the following:
1. Time or frequency.
–
In the ﬁrst case, the user needs to measure the value of time intervals
and/or to locate a given event on the time axis, i.e. to measure the
time interval between this event and a conventional origin; this is the
date of the event. The user needs the unit of time and the conventional
origin and a device that counts the number of units of times. This is
a clock.
–
In the second case, there is no need for any conventional origin on the
time axis. The user wants to measure the frequency of a periodic phe-
nomenon. For this he needs the unit of time and a device that counts
the number of periods of the phenomenon during that unit of time.
2. Accuracy and/or stability and/or another metrological property and/or
particular environment, etc.
According to the application, the requirements on any of these qualities
may be more or less important.
Table 7.1. The uncertainties of the best realizations of the seven SI base units
SI base unit
Symbol
Uncertainty
Second
s
1 × 10−15
Meter
m
1 × 10−12
Kilogram
kg
2 × 10−9
Candela
cd
1 × 10−4
Mole
mol
2 × 10−9
Ampere
A
9 × 10−8
Kelvin
K
3 × 10−7
www.ebook3000.com

130
7 Time and Frequency Metrology
To meet these needs, a great variety of devices has been built, each one being
adapted to a special use. These devices must be characterized and compared
in order to
1. deﬁne a time scale that allows one to date the events and realize the unit
of time, and
2. deﬁne some reference frequencies that realize the unit of frequency.
7.1 Time Scales
A time scale is a virtual clock from which any user should be able to measure
the value of the parameter time corresponding to any event. An ideal time
scale should meet the following requirements:
1. It should be accessible to any user.
2. It should rely on the SI time unit.
3. It should permit the measurement of the time interval between two events,
according to the SI time unit deﬁnition.
4. It should permit the measurement of the time interval between a given
event and a conventional origin. This measurement provides the date of
the given event in that time scale.
5. It should take relativity [44] into account. In the framework of general
relativity, the physical world is described in four-dimensional space–time
reference systems. The four dimensions of a speciﬁed reference system
are the three spatial coordinates and x0 = c × t, where c is the velocity
of light in vacuum and t is the coordinate time in this reference system.
Coordinate time provides an unambiguous way of dating events in a spec-
iﬁed reference system. This is the time coordinate to be used in the theory
of motion referred to this system.
In a general way, the observed time of an observer described in a speciﬁed
reference system diﬀers from the coordinate time of this reference system.
The relation of the observed time to the coordinate time of the reference
system depends on the velocity of the observer in the reference system,
mass repartition and energy.
The observed time of an observer is called the proper time of this observer.
6. It should satisfy some particular constraints imposed by some particu-
lar applications. For instance, the time scale regulating ordinary human
activities should take into account the rotation of the Earth.
One single time scale cannot meet all of these requirements in every con-
text.
1. A time scale deﬁned in a speciﬁed reference system is not suited for
applications in another reference system.
2. A time scale deﬁned as the coordinate time of a speciﬁed system may not
be suited for applications involving a proper time.

7.1 Time Scales
131
3. Many human activities are dependent on the length of the day and in-
volve a time scale linked to this length. Since the Earth’s rotation is not
uniform, and consequently the length of the day is not constant, a time
scale deﬁned on a constant second basis, such as the one produced by an
atomic clock, would not ﬁt the needs of many human activities.
The reference time scale is TAI (temps atomique international, international
atomic time), which is built on the SI unit produced by atomic clocks. The
other time scales are connected to TAI and meet the needs of diﬀerent kinds
of users.
The main time scales are brieﬂy described in the following.
7.1.1 The Main Time Scales in Use
TAI
The ﬁrst deﬁnition of TAI was that submitted by CCDS1 in 1970 to CIPM [33]
and [67]2: “International Atomic Time (TAI) is the time reference coordinate
established by the Bureau International de l’Heure on the basis of the readings
of atomic clocks operating in various establishments in accordance with the
deﬁnition of the second, the unit of time of the International System of Units.”
This deﬁnition did not specify the reference system to which it applies. It
was completed in 1980 [32] and [100]3: “TAI is a coordinate time scale deﬁned
in a geocentric reference frame with the SI second as realized on the rotating
geoid 4 as the scale unit.”
The clocks included in TAI must therefore be placed at sea level or a cor-
rection must be made to take the actual altitude (the eﬀect of terrestrial
mass) and the latitude (the eﬀect of the centripetal potential due to the
Earth’s rotation) into account [102].
The gravitational eﬀect within the theory of relativity aﬀects the fre-
quency of any clock: a clock in a smaller gravitational ﬁeld is faster than
a clock in a higher gravitation. In the vicinity of the Earth’s surface, the
relative eﬀect is about 1 × 10−16 for 1 meter of altitude diﬀerence; a clock
1 CCDS – Comité Consultatif de la Seconde – has been renamed as CCTF – Comité
Consultatif du Temps et des Fréquences, Consultative Committee for Time and
Frequency – by CIPM in 1997.
2 The oﬃcial text is in French and reads: “Le Temps atomique international est la
coordonnée de repérage temporel établie par le Bureau international de l’heure
sur la base des indications d’horloges atomiques fonctionnant dans divers étab-
lissements conformément à la déﬁnition de la seconde, unité de temps du Système
international d’unités.”
3 The oﬃcial French text reads: “Le TAI est une échelle de temps-coordonnée
déﬁnie dans un repère de référence géocentrique avec comme unité d’échelle la
seconde du SI telle qu’elle est réalisée sur le géoïde en rotation.”
4 The geoid is the gravity equipotential surface (surface of ﬁxed potential value)
that coincides on average with the mean sea level.
www.ebook3000.com

132
7 Time and Frequency Metrology
located at a height of 1 646 m (NIST, Boulder, CO, for instance) will be ap-
proximately 140 nanoseconds faster per day than a clock located at a height
of 60 m (LNE-SYRTE, Paris, for instance).
This deﬁnition was completed by the International Astronomical Union in
1991, Resolution A4: “TAI is a realized time scale whose ideal form, neglecting
a constant oﬀset of 32.184 s, is terrestrial time (TT), itself related to the
time coordinate of the geocentric reference frame, geocentric coordinate time
(TGC), by a constant rate.”
Responsibility for TAI was accepted by the CIPM from the Bureau In-
ternational de l’Heure on 1 January 1988.
TAI consists of two steps:
1. A weighted average based on a great number of clocks maintained un-
der metrological conditions in about ﬁfty laboratories5 is calculated. The
algorithm used is optimized for long-term stability, which requires the
observation of the behavior of clocks over long periods. In particular, the
relative weight is allotted to each clock after examination of its behav-
ior over the duration of the period considered. In consequence, TAI is
a deferred-time time scale, available with a delay of a few days6.
The time scale resulting from this computation is called EAL (échelle
atomique libre – free atomic scale). The medium-term stability of this
intermediate scale (Allan deviation for averaging times of 20 to 40 days)
is estimated to be 0.6 × 10−15 over the period January 1999 to June
2004 [21].
2. The frequency error of this intermediate scale is evaluated by comparing
it with some primary frequency standards (PFS). This, of course, requires
the application of a correction to connect the proper time of each of these
frequency standard to the coordinate time of the rotating geoid.
In January 2006, for instance, the relative diﬀerence between the fre-
quency of TAL and the frequency of the ensemble of primary frequency
standards was measured to be 6.815 × 10−13, with an uncertainty of
0.009 × 10−13 [24].
The primary frequency standards implied in this evaluation are shown in
Table 7.2.
A weight is allotted to these primary frequency standards, according to
the uncertainty aﬀecting their error budget. The result of these compar-
isons allow TAI to be corrected in such a way that
–
its stability is the stability of EAL, and
–
its accuracy is the accuracy of the ensemble of the primary frequency
standards.
5 For instance, in the note describing the relative weights of the clocks participating
in the computation of TAI published by the BIPM on 9 February 2006 [25], 321
clocks from 47 institutes are listed.
6 For instance, the circular T number 217 published by the BIPM on 9 February
2006 [22] gives the information for the period 30 December 2005 to 29 January
2006.

7.1 Time Scales
133
Table 7.2. Primary frequency standards involved in the accuracy of TAI
Acronym
Full name
Location
PFS
NIST
National Institute of Standards
and Technology
Boulder, CO., USA
F1
PTB
Physikalisch-Technische
Bundesanstalt
Braunschweig,
Germany
CS1
CS2
OP
Observatoire de Paris
Paris, France
FO2
JPO
IEN
Istituto Elettrotecnico Nazionale
Galileo Ferraris
Turin, Italy
CSF
NICT
National Institute of Information
and Communications Technology
Japan
NICT01
NMIJ
National Metrology Institute
of Japan
Tsukuba, Japan
F1
To obtain this result, the frequency correction is of the order of the fre-
quency instability and is applied at intervals of two months. Circular
T, edited by BIPM, gives the correction applied to EAL. For instance,
circular T number 217 [22] gives the following information:
–
The relative steering correction applied to EAL during the period
53 734–53 764 (dates are given in MJD, modiﬁed Julian day [137] and
correspond to the interval 30 December 2005 to 29 January 2006) was
(fEAL −fTAI) /fTAI = 6.850 × 10−13 .
–
The relative steering correction applied to EAL during the period
53 764–53 794 (29 January 2006 to 28 February 2006) was
(fEAL −fTAI) /fTAI = 6.844 × 10−13 .
Consequently, a correction of 0.6 × 10−15 was applied to TAI on 29 Jan-
uary 2006.
Time Scales for Astronomy
Two diﬀerent groups of time scales are used in astronomy.
1. Time scales based on the SI second. These time scales rely on atomic
phenomenon and are related to TAI.
2. Time scales based on the rotation of the Earth. It is known that the length
of the day is not constant and has unpredictable variable components. It
must consequently be continuously monitored through astronomical ob-
servations, which is done primarily with very long baseline interferometry
(VLBI, see Sect. 9).
www.ebook3000.com

134
7 Time and Frequency Metrology
Before the introduction of atomic clocks, all time scales were tied to the
rotation of the Earth.
Time Scales Based on the Rotation of the Earth
Time scales that are based on the rotation of the Earth are used in astronom-
ical applications, such as telescope pointing, which depend on the geographic
location of the observer. The history of these time scales is brieﬂy described
in the Introduction.
1. Sidereal time and local sidereal time are the hour angle of the equinox
with respect to the Greenwich meridian or the local meridian, respec-
tively.
2. Universal time (UT). There are two forms of universal time: UT0 and
UT1, the last one being the form that is almost always used. The ﬁrst
deﬁnitions of UT rely on sidereal time: The observed mean sidereal time
at Greenwich (measured from the position of some reference stars) is
called GMST; it is transformed to give a mean solar time, the ﬁrst uni-
versal time standard, UT0. This in turn gives rise to a time standard,
UT1, that corrects for nutation and pole movement (two further periodic
terms are removed from UT1 to form UT2). Some eﬀects due to tidal
forces remain, which slow the Earth’s rotation. In 2000, IAU7 redeﬁned
UT1 to be a linear function of the Earth’s rotation angle, θ, which is the
geocentric angle between two directions in the equatorial plane called,
respectively, the celestial intermediate origin (CIO) and the terrestrial
intermediate origin (TIO) [65]8. TIO rotates with the Earth, while CIO
has no instantaneous rotation around the Earth’s axis, so that θ is a direct
measure of the Earth’s rotational motion that is unaﬀected by precession
and nutation.
All these time scales are aﬀected by the variations in the Earth’s rate of ro-
tation, which are unpredictable and must be measured through astronomical
observations. The lengths of the sidereal and UT1 seconds are, therefore, not
precisely constant when expressed in a uniform time scale based on the SI
second. The accumulated diﬀerence in time measured by a clock keeping SI
seconds on the geoid from that measured by the rotation of the Earth is
∆T = TT −UT1. The long-term trend for ∆T is to increase because of the
tidal deceleration of the Earth’s rotation.
Times Scales Based on the SI Second
Since the SI second results from the observation of an atomic phenomenon,
SI-based time scales can be constructed or hypothesized anywhere in the
universe, which is not the case of the time scales based on the Earth’s rotation.
7 IAU: The International Astronomical Union.
8 These origins were called the celestial ephemeris origin and the terrestrial
ephemeris origin in [65].

7.1 Time Scales
135
Successive IAU recommendations have been emitted to deﬁne time scales
for two diﬀerent reference systems. Each time scale, corresponding to a given
reference system, is the coordinate to be used in the theory of motions referred
to this system.
These time scales are based on the SI second and are the time coordinates
of the two following reference systems:
–
GCRS is geocentric, which means that the origin of the spatial coordinates
is located at the barycenter of the Earth. This is used to describe the
motions relative to the Earth.
–
BCRS is centered at the barycenter of the solar system.
Both reference systems are non-rotating with respect to the ensemble of dis-
tant extragalactic objects. For each of these two reference systems, the time
coordinates is the time scale, which should be delivered by an ideal TAI clock,
which is
–
located on the origin of the spatial coordinates (i.e. on the barycenter of
the Earth) in the case of the geocentric reference system,
–
located far from any source of gravitational ﬁeld in the case of the barycen-
tric reference system.
The origin of the time coordinates of both reference systems is chosen in such
a way that at the instant 1977 January 01d00h00m00s, the value of the time
coordinate is 1977 January 01d00h00m32.184s.
These two time scales are called
–
the geocentric coordinate time (TCG: Temps-coordonnée géocentrique in
French) for GCRS, and
–
the barycentric coordinate time (TCB: temps-coordonnée barycentrique
in French) for the barycentric celestial reference system (BCRS).
No real physical clock can deliver these two time scales, but they are related to
TAI and to a third astronomical time scale that is widely used for geocentric
and topocentric ephemeris:
–
the terrestrial time (TT), which has the same origin as TCG and TCB,
but whose unit is the SI second. Its rate is consequently exactly equal to
that of TAI and the only diﬀerence between these two scales is the oﬀset
of 32.184 s.
TT is conventionally realized by TT = TAI + 32.184 s.
In fact, TCG coincides with TT except that it omits the gravitational
eﬀect of the Earth itself (and the time dilation caused by its rotation),
since the virtual clock that delivers it is situated at the barycenter of the
Earth.
Consequently, the TCG is faster than TAI and TT by a factor of
6.969290134 × 10−10. This factor is now considered as a deﬁning constant
and is not subject to further revision.
www.ebook3000.com

136
7 Time and Frequency Metrology
TCG diﬀers from TCB because the ﬁrst one is the SI time scale of an
observer submitted to the gravitation of the Sun and of the other planets
and in motion around the Sun.
Coordinated Universal Time (UTC)
The time scale TAI, based on the transition of atoms, is now the best approx-
imation of the ideal time scale with the best regularity possible. On the other
hand, due to the irregularities of the rotation of the Earth and to the fact
that everyday activities are based on the length of the day, a perfect regular
time scale, which diverges relative to UT, is not suited for these activities.
For this reason, UTC is a time scale based on the SI second, and possesses
the regularity of TAI, but nevertheless never deviates from the time scale
UT1 by more than 0.9 s; it is consequently the bridge between atomic and
ephemeris times. This result is obtained very simply by inserting leap seconds
(which can be positive or negative) in the scale UTC when the diﬀerence
between UTC and UT1 reaches 0.9 s. In this way
–
the diﬀerence UTC-UT1 is always smaller than 0.9 s,
–
the regularity of the ticks of UTC is the regularity of TAI, but
–
events occurring during a leap second must be considered with special
care.
The leap seconds that have been inserted in TAI since 1972 are summarized
in Table 7.3.
UTC is the time scale in common use (broadcast by radio, television,
the telephone, etc.). In addition, the legal time of most countries is oﬀset
from UTC by an integer number of hours (time zones and “summer time”).
National time-service laboratories maintain an approximation of UTC known
as UTC(k) for laboratory k (see Sect. 7.1.1). The diﬀerences between UTC(k)
and UTC are in general no more than a few hundreds of nanoseconds.
Table 7.3. Dates of the leap seconds since 1972
1972 Jul. 1
1973 Jan. 1
1974 Jan. 1
1975 Jan. 1
1976 Jan. 1
1977 Jan. 1
1978 Jan. 1
1979 Jan. 1
1980 Jan. 1
1981 Jul. 1
1982 Jul. 1
1983 Jul. 1
1985 Jul. 1
1988 Jan. 1
1990 Jan. 1
1991 Jan. 1
1992 Jul. 1
1993 Jul. 1
1994 Jul. 1
1996 Jan. 1
1997 Jul. 1
1999 Jan. 1
2006 Jan. 1
The diﬀerence between UTC and TAI was 33 s on 1 January 2006
The GPS Time Scale
GPS (Global Positioning System) is described elsewhere in this book (see
Sect. 8). It relies on precise time measurements and provides a precise time

7.1 Time Scales
137
scale called the GPS time scale or GPS time. This time scale is accessible to
any GPS receiver.
The ensemble of clocks used to compute the GPS time scale is made up
of the clocks of all the operational satellites and of the monitor stations.
Moreover, GPS time is steered to UTC(USNO) from which it does not
deviate by more than one microsecond. The exact diﬀerence between GPS
and UTC(USNO) is contained in the navigation message emitted by each
satellite, which gives the diﬀerence and rate of GPS relative to UTC(USNO).
UTC(USNO) itself is kept very close to the international UTC as main-
tained by BIPM, and the exact diﬀerence between UTC(USNO) and UTC
is published monthly in the circular of the Bureau International des Poids
et Mesures [22]. The GPS time scale was initialized on 6 January 1980, and
was then set equal to UTC (see Sect. 7.1.1). Since this epoch, leap seconds
have been added to UTC (see Table 7.3) but no leap second has been added
to GPS time; the two scales thus diﬀer by an integer number of seconds; the
diﬀerence was for instance 14 s on 1 January 2006.
This diﬀerence and the diﬀerence of the time broadcasted by each satellite
and the GPS time are broadcast in the message emitted by the satellites. Any
GPS receiver can consequently compute UTC from the received message.
Local Time Scales
Many national measurement institutions (NMI) all over the world have built
their own time scale from a set of local clocks. The listing of these 679 insti-
tutions can be found in [18]. The countries involved are given in alphabetic
order in Table 7.4.
7.1.2 Algorithms for the Generation of Time Scales
The algorithms used to construct a time scale from an ensemble of clocks rely
on a model of the participating clocks.
Model of the Clocks
The Clocks Involved in Time Scales
The clocks involved in the time scales are mainly commercial cesium fre-
quency standards and hydrogen masers. In the note [25], 321 clocks are men-
tioned, among them 4 primary frequency standards and 72 hydrogen masers.
The others (245) are commercial cesium frequency standards.
Commercial frequency standards are neither more stable nor more accu-
rate. Nevertheless, they are involved in the construction of time scales due to
their reliability.
9 in 2006
www.ebook3000.com

138
7 Time and Frequency Metrology
Table 7.4. Countries maintaining a local approximation of UTC and/or an inde-
pendent local time scale
Argentina
Australia
Austria
Belgium
Brazil
Bulgary
Canada
Chile
China
Czech Republic
Egypt
France
Germany
Hong Kong
Hungary
India
Israel
Italy
Japan
Lithuania
Malaysia
Mexico
The Netherlands
New Zealand
Norway
Panama
Poland
Portugal
The Republic of Korea
Romania
Russia
Singapore
Slovakia
South Africa
Spain
Sweden
Switzerland
Taiwan
Thailand
Turkey
United Kingdom
USA
The behavior of each clock contributing to a given time scale is de-
scribed by a limited number of deterministic parameters and by the noise
that perturbs its output frequency. One must keep in mind that the sta-
bility of commercial cesium frequency standards is much better than their
accuracy.
Deterministic Parameters
Each clock i of a given time scale can be characterized at a given time t (this
time is given by the time scale) by three parameters as follows:
–
The time diﬀerence δti(t) of the clock compared to the time given by the
time scale:
δti(t) = ti(t) −t .
–
The dimensionless reduced frequency diﬀerence δyi(t) of the clock com-
pared to the frequency of the time scale:
δyi(t) = fi(t) −f0
f0
= yi −1 ,
where f0 is the value of the time scale frequency.
–
The fractional frequency aging di of the clock, which produces a deter-
ministic linear variation of its reduced frequency:
∆yi(t) = di × (t −t0) ,
where t0 is an arbitrary time origin and di is expressed in s−1.

7.1 Time Scales
139
Knowing the value of these three parameters at a given time t0, it is easy to
calculate their value at any other time t0 + τ.
The time unit of the time scale is a given number n0 of the period T0 =
1/f0 of the virtual clock associated to it; the time unit produced by the
clock i is diﬀerent from the time unit produced by the time scale. Its value
ui(t) is
ui(t) = n0 ×
1
fi(t)
= n0 × 1
f0
×
f0
fi(t)
=
1
yi(t) .
(7.1)
If the fractional frequency error at time t0 is δyi(t0), its value for any time
t is
δyi(t) = δyi(t0) + di(t −t0) .
(7.2)
The unit time of this clock i varies
ui(t) =
1
yi(t) .
(7.3)
Consequently, when a time τ (as measured by the time scale) elapses, the
clock i measures (with its wrong time unit)
τ + δτi =
 t0+τ
t0
dt
ui(t)
=
 t0+τ
t0
yi(t)dt
(7.4)
=
 t0+τ
t0
(yi(t0) + di(t −t0)) dt
= τ × yi(t0) +
 t0+τ
t0
di(t −t0)dt
= τ × yi(t0) + diτ 2
2
(7.5)
= τ × [1 + δyi(t0)] + diτ 2
2
.
(7.6)
The time error of the clock i consequently increased by δτi,
δτi = δyi(t0)τ + diτ 2/2 .
(7.7)
www.ebook3000.com

140
7 Time and Frequency Metrology
The values of the three parameters at time t0 + τ are consequently
Parameter
At time t0
At time t0 + τ
Fractional frequency error
yi(t0)
yi(t0) + diτ
Time error
δti(t0)
δti(t0) + δyi(t0)τ + diτ 2/2
Frequency aging
di
di
Random Contributions
The various noise sources that can aﬀect the output frequency of the clock i
must also be taken into account. They are described in Sect. 6.2.2; how they
are detected by the variances is summarized in Sect. 6.2.7.
The possible noise processes are
–
white phase noise:
spectral density: h2ν2,
Allan variance: h2 × 3νmax/4π2 × τ −2,
–
ﬂicker phase noise:
spectral density: h1 |ν|,
Allan variance: h1 × 3 [ln(πνmaxτ) + 1.04]/4π2 × τ −2,
–
white frequency noise:
spectral density h0,
Allan variance: h0/2 × τ −1,
–
ﬂicker frequency noise:
spectral density h−1 |ν|−1,
Allan variance: h−1 × 1.39,
–
random walk frequency noise:
spectral density h−2ν−2,
Allan variance: h−2 × 2π2/3 × τ.
Algorithms
Diﬀerent algorithms are used to construct the various time scales such as
TAI, GPS and the local time scales. All of them rely on the prediction and
observation of the time given by the individual clocks involved in the time
scale.
Among the N clocks Cj (1 ≤j ≤N) participating in the time scale, one
of them, the clock Cm, is used as a relay to get access to the time scale.
–
The time scale is a virtual clock whose output time tk is the weighted
mean value of the time tj(tk) given by every clock Cj of the ensemble,
tk =
N

j=1
wj × tj(tk) .
(7.8)

7.1 Time Scales
141
wj is the weight of clock Cj,
N

j=1
wj = 1 .
(7.9)
–
The time error of any clock Cj at a given epoch tk is δtj(tk),
δtj(tk) = tj(tk) −tk .
(7.10)
–
The time diﬀerence between the relay clock Cm and any clock Cj at the
same epoch tk is δtjm(tk),
δtjm(tk) = δtj(tk) −δtm(tk) .
(7.11)
–
The time error of any clock Cj (1 ≤j ≤N) at the same epoch tk is
consequently
δtj(tk) = δtm(tk) + δtjm(tk) .
(7.12)
–
If all the time diﬀerences δtjm(tk) are known at the epoch tk, the time
error of the relay clock can be computed, and consequently the value of
the time scale
N

j=1
wj × δtjm(tk) =
N

j=1
wj × [δtj(tk) −δtm(tk)]
(7.13)
= −δtm(tk) +
N

j=1
wj × δtj(tk)
(7.14)
= −δtm(tk) .
(7.15)
–
The time error of every clock Cj can then be easily computed using (7.12).
The algorithm is then the following:
1. Epoch tk:
a) The time diﬀerences δtjm(tk) are measured.
b) The time error of the relay clock Cm is deduced from these measure-
ments (7.15).
c) The time error δtj(tk) of every clock is deduced from these measure-
ment by (7.12).
d) The estimate *
δtj(tk+1) of the time error at epoch tk+1 = tk + τ is
calculated for every clock Cj (j = m included) using (7.6) and the
values of the parameters characterizing every clock.
2. Epoch tk+1:
a) The time diﬀerences δtjm(tk) are measured.
b) The time error of the relay clock Cm is deduced from these measure-
ments (7.15).
www.ebook3000.com

142
7 Time and Frequency Metrology
c) The time error δtj(tk) of every clock is deduced from these measure-
ment (7.12) and is compared to the time error estimated in step 1.
d) The weight wj of every clock Cj of the ensemble is adjusted by an
algorithm that uses the diﬀerence between the time error δtj(tk+1)
measured at epoch tk+1 and the time error *
δtj(tk+1) predicted.
e) Steps b and c are repeated with the new values of the weights of the
clocks.
f) The estimate *
δtj(tk+2) of the time error at epoch tk+2 = tk+1 + τ is
calculated for every clock Cj (j = m included) using (7.6) and the
values of the parameters characterizing every clock.
3. Step 2 is repeated at epochs tk + nτ.
The weight of a given clock is larger if the clock is predictable, i.e. its predicted
error time is close to its measured one. The weight of a clock is often inversely
proportional to the mean square of the prediction error.
Moreover, the weight of a clock can be canceled if its predicted error is
larger than a given threshold, which may indicate a clock failure.
On the other hand, in order to avoid instability, the weight of any clock
cannot be larger than a given limit. For instance, in the case of TAI, the
maximal value of the weight of any clock is wmax = 2.5/N, N being the
number of clocks.
7.2 Comparison of Clocks
As shown in Sect. 7.1.2, the construction of a time scale relies on the mea-
surement of the time diﬀerence between a particular clock of the ensemble
and all the other ones. This measurement is equivalent to the synchronization
of the clocks of the ensemble; if the time diﬀerence between every clock and
the time scale is known, then all the clocks of the ensemble can be set to the
correct time and are consequently synchronized.
A theoretical diﬃculty arises in the synchronization of clocks on the sur-
face of the Earth, due to the fact that their reference system is not an inertial
one but a rotating one [8].
7.2.1 Clock Synchronization in a Rotating Frame
All techniques used to synchronize clocks are variants of the so-called “Ein-
stein clocks synchronization”, which is a convention in special relativity de-
scribing how to synchronize clocks in diﬀerent places in an inertial frame.
This operation is necessary in order to measure and deﬁne the time coordi-
nate of a given event.
The “Einstein clocks synchronization” process is the following: if clock
CB, located at point B is to be synchronized to clock CA located at point A,
a signal is sent at time t1 from clock CA to clock CB and immediately back,
(e.g. by the means of a mirror). Its arrival time back at clock CA is t2. The

7.2 Comparison of Clocks
143
Einstein synchronization convention then sets clock CB so that the time of
the signal reﬂection on clock CB is (t1 + t2)/2. Information giving this value
can be transmitted from A to B.
An equivalent process is the following: the time of arrival of the signal at
clock CB is t3 = t1 +d/v, where d is the distance between A and B and v the
speed of the signal propagation. In the ﬁrst process, the knowledge of t1 and
t2 gives l/v = (t2 −t1)/2 and t3 = (t1 + t2)/2, assuming that the velocity
of the signal is isotropic. This process is transitive: If two clocks CB and CC
(located at B and C, respectively) are synchronized to CA, then CB and CC
are synchronized. This results from the fact that in an inertial frame, the
light velocity is constant and isotropic.
This property of transitivity applies in inertial frames only. Indeed, the
process can be applied to rotating frames but is no longer transitive: If two
clocks CB and CC are synchronized to CA, then a time diﬀerence can exist
between CB and CC. This result applies whatever the signal used to operate
the synchronization may be. It applies even if the clock CA is moved suc-
cessively to the location of clock CB and to the location of clock CC. This
phenomenon is the so-called Sagnac eﬀect [109].
The following convention is consequently applied to deﬁne the synchro-
nization of clocks on the rotating Earth [8].
A set of virtual synchronized clocks Cv(i) keep the time coordinate in
a virtual geocentric inertial frame. At every moment, each clock CL of the
rotating frame is synchronized to one of the virtual clocks, which is located at
exactly the same point as the clock CL. The time given by these synchronized
clocks deﬁne the “coordinate time” and this process ensures that all the clocks
on the rotating Earth give a common value.
In a practical way, if Einstein synchronization is to be applied to the clocks
CA and CB located on the Earth, the duration of the signal travel from CA
to CB must be corrected from the Sagnac eﬀect. This is equivalent to saying
that the speed of the signal is not isotropic10.
7.2.2 One-way GPS Measurements
GPS maintains a time scale (the GPS time scale) linked to TAI and UTC
time scales (see Sect. 7.1.1).
The relevant time information is transmitted by each GPS satellite (see
Sect. 8.2.1) as
–
a timing signal on a phase modulated L-band carrier,
–
the diﬀerence between the time of that particular satellite and the GPS
time, and
–
the diﬀerence between the time scales GPS and UTC.
10 This eﬀect has produced a great deal of controversy, which is out of the scope of
this book.
www.ebook3000.com

144
7 Time and Frequency Metrology
The most simple way to control the time indicated by a given clock is to
compare it with the GPS time scale via the transmitted signal, in a one-
way measurement [85]. This is the direct transposition of the Einstein clocks
synchronization.
The source A (a GPS satellite) sends a time signal to the user, B through
a transmission medium. The user’s receiver compares the arrival time of the
GPS signal to the time given by the clock to be characterized with a time
interval counter. The arrival time of the GPS signal must be corrected for
the propagation delay and the major limitation to the accuracy results from
the estimation of this delay.
The delay dAB over a transmission path is about 3.3 µs/km and the small-
est distance between any GPS satellite and a point on the surface of the Earth
is about 20 000 km, corresponding to a delay of 66 ms. Therefore, a high ac-
curacy is required for the value of this delay; the physical locations of the two
clocks (the clock in the satellite and the clock to be synchronized) must be
known with an accuracy that is compatible with the accuracy of the synchro-
nization. An error of 10 ns on time corresponds to an error on the distance
between the two clocks of only 3 m.
Moreover, ionospheric and tropospheric delays must be taken into ac-
count.
1. The geometrical delay (the distance between the emitter and the receiver)
is obtained from the receiver’s location (which can be obtained from
the GPS system) and from the broadcast satellite positions, which are
only accurate to a few meters, and therefore limit the accuracy of the
geometrical delay to about 10 ns. It is therefore not useful to determine
the receiver position to better than one meter.
2. The ionosphere and the troposphere also have a signiﬁcant impact on
propagation delay. Ionospheric delays can range from a few nanoseconds
at night in the vertical direction to hundreds of nanoseconds during the
day at low elevation angles. The navigation message broadcast by the
satellites contains a model of the ionospheric delay, but its accuracy may
be rather poor.
There are ways to improve the ionospheric correction with direct mea-
surements using for, instance, the two-frequency method (see Sect. 8.2.2).
3. The excess delay introduced by the troposphere is in the range of tens
of nanoseconds. It can generally be corrected to an uncertainty of a few
nanoseconds.
4. Multipath error is produced if the signal, due to reﬂexions, reaches the
receiver via more than one path. This may produce errors of a few tens
of ns.
5. Hardware instabilities and inaccuracies generally produce errors of a few
nanoseconds only.
6. The Sagnac delay is calculated from the positions and relative velocities
of the emitter and of the receiver and can be of the order of 100 ns,

7.2 Comparison of Clocks
145
but uncertainty in this eﬀect is small compared to other sources of
error.
In conclusion, with a well designed receiver system, the user can usually
obtain the time to better than 100 ns in a few minutes.
7.2.3 GPS Common-view
In this case, the two clocks to be compared are on the surface of the
Earth and a given event E (a C/A code, for instance) is transmitted
from a GPS satellite (see, for instance [85, 3]) and is received by the two
clocks.
Since GPS satellites orbit the Earth within a 12 h period at an altitude
(above the Earth’s surface) of about 20 000 km on quasi-circular orbits in-
clined to the equator by about 55◦, two receivers with longitudes diﬀering by
as much as 180◦can receive the signal of the same satellite (Fig. 7.1).
Compared to the one-way measurement, this method has the following
advantages:
1. Each station measures the apparent time of the same event, which is
a given tick of the clock CE. The stability and accuracy of the in-board
clock that delivers the event E therefore has little eﬀect; there is no need
to know the date of event E, but only to compare the dates given by the
receivers A and B when they receive this event. Any error in the time E
is totally canceled.
2. Due to the geometry of the three points A, B and E, the perturbations
that aﬀect the propagation delay on the two paths EA and EB are cor-
related and their eﬀects on the measurement of the time diﬀerence of CA
and CB nearly cancel.
Fig. 7.1. A GPS satellite and two receivers on the Earth. The distance Earth–
satellite is about four times the Earth’s radius
www.ebook3000.com

146
7 Time and Frequency Metrology
In fact, the experimental results show that the accuracy of the method is at
least ten times better than that of the one-way method.
The data resulting from the time diﬀerence measurements in the two
stations A and B are interexchanged by the use of any convenient method
(email, FTP, etc.).
The value given by stations A and B on measuring a common event
produced at time tE are, respectively, tA and tB given by
tA = tE + δAEt + δtp
EA ,
(7.16)
tB = tE + δBEt + δtp
EB ,
(7.17)
where tE is the time of the clock CE, δAE and δBE are the time errors of,
respectively, CA and CB relative to the clock CE, δtp
EA and δtp
EB are the
propagation delays from the clock CE to the clocks CA and CB, respectively.
The diﬀerence tA −tB between the two results can easily be computed if
the two stations can exchange data
tA −tB = (δAE −δBE) + (δtp
EA −δtp
EB) .
(7.18)
In this expression, δAE −δBE is the time diﬀerence between the two clocks,
i.e. the quantity to be measured.
The diﬀerence of the propagation delays, δtp
EA −δtp
EB (including the
delays of the receiving equipment), can be computed from the GPS data
(the position of the receivers and of the satellite, etc.) and from a diﬀer-
ential calibration of the receiving equipment. This diﬀerential calibration
is made by carrying a portable GPS receiver between the two stations,
which provides the value of the diﬀerence between the delays of the equip-
ment. An absolute calibration of the equipment at each station is not re-
quired.
In conclusion, the accuracy of common-view time transfers is typically in
the 1 to 10 ns range.
7.2.4 GPS Carrier-phase Time Transfer
Instead of the C/A code, the phase of the carrier of the signals emitted by
the satellites may be used as the common event of the two receivers. Since
the frequency of the carrier is about 1 000 times higher than the frequency of
the C/A code, carrier-phase methods have a greater resolution. Nevertheless,
the error due to the uncertainty of the delays remain the same. Therefore, in
order to realize this potential advantage, it is necessary to analyze the received
data after-the-fact, using the post-processed ephemeris of the satellites and
detailed models of the ionosphere and troposphere.
Experimental results show that the method is capable of providing fre-
quency comparisons with a fractional uncertainty of about 2 × 10−15 using
one day of averaging [75, 76, 53].

7.2 Comparison of Clocks
147
7.2.5 Two-way Satellite Time and Frequency Transfer (TWSTFT)
Two-way satellite time and frequency transfer (TWSTFT) is a high precision
method of time and frequency transfer, used principally for intercomparisons
of local and international atomic time scales [37]. Intercontinental time trans-
fer sessions can now achieve a precision of better than 1 ns [28, 102].
The principle of two-way time transfer is very simple [54, 62] (Fig. 7.2).
In fact, it is a direct variant of the Einstein clock synchronization:
Clock CA, located at station A sends at time tA
1 a time information (1 Hz
pulses, for instance) to clock CB located at station B. This time information
is relayed by a satellite S. Station A receives at time tA
2 the time information
sent by clock CB and relayed by the same satellite S. In a symmetric way,
clock CB sends at time tB
1 time information to clock CA and receives at time
tB
2 the time information sent by clock CA.
The time diﬀerence tA
2 −tA
1 measured at station A by a time diﬀerence
counter is ∆tA, while the corresponding time diﬀerence tB
2 −tB
1 measured at
station B is ∆tB
∆tA = tB
1 −tA
1 + δtp
BA ,
(7.19)
∆tB = tA
1 −tB
1 + δtp
AB ,
(7.20)
where δtp
BA and δtp
AB are, respectively, the transmission delays from B to A
and from A to B.
The two stations exchange these results and compute the diﬀerence
∆tA −∆tB = 2(tB
1 −tA
1 ) + (δtp
BA −δtp
AB) .
(7.21)
If the two transmission paths are reciprocal, δtp
BA −δtp
AB = 0 and the time
diﬀerence between the two clocks is exactly
tA
1 −tB
1 = ∆tB
1 −∆tA
1
2
.
(7.22)
In fact, the two paths are never completely reciprocal and an error subsists,
which must be carefully evaluated [62, 102]. Moreover, due to the rotation of
the Earth, the Sagnac eﬀect (see Sect. 7.2.1) must be taken into account.
Fig. 7.2. The principle of the two-way technique
www.ebook3000.com

148
7 Time and Frequency Metrology
The paths of a TWSTFT go through a satellite S, which must be in com-
mon view of the two stations A and B. One path (from A to B) is the path
A →S →B and the other one (from B to A) is the path B →S →A
(Fig. 7.3).
The path from station A to station B, for instance, comprises
–
a transmitter and an antenna at station A,
–
an uplink from station A to the satellite S,
–
a path through the satellite S,
–
a downlink from the satellite S to station B, and
–
an antenna and a receiver at station B.
The delays contributing to δtp
AB and δtp
BA are, therefore, the following:
1. The propagation delays from every station to the satellite and from the
satellite to every station:
a) dAS – propagation from station A to the satellite S,
b) dSA – propagation from the satellite S to station A,
c) dBS – propagation from station B to the satellite S, and
d) dSB – propagation from the satellite S to station B.
If the uplink frequency is diﬀerent from the downlink frequency, dAS ̸=
dSA and dBS ̸= dSB, due to the dispersion in the ionosphere, and the
diﬀerence (dBS −dAS) + (dSA −dSB) does not cancel and produces the
ionospheric delay.
This delay can be computed from an evaluation of the index of refraction
of the signal in the ionosphere [102]. It depends on the frequencies of the
uplink and of the downlink, of the elevation of the satellite and of the
Fig. 7.3. Paths of TWSTFT

7.2 Comparison of Clocks
149
various factors that aﬀect the electron density in the ionosphere (day and
night, solar activity, etc. [68]). The non-reciprocity due to this eﬀect is
smaller than 100 ps [102].
2. The delays produced by the satellite electronic transmitter:
a) dS
AB – the delay produced on the signal sent by station A and trans-
mitted to station B, and
b) dS
BA – the delay produced on the signal sent by station B and trans-
mitted to station A.
If the two path directions go through the same transponder at the
same frequency, which is possible using the code division multiple access
(CDMA) mode with PN signals11, the two delays are equal: dS
AB = dS
BA.
3. The delays produced by the electronic equipment on the Earth stations:
a) dT
A – the delay produced by the transmitter of station A,
b) dR
A – the delay produced by the receiver of station A,
c) dT
B – the delay produced by the transmitter of station B, and
d) dR
B – the delay produced by the receiver of station B.
4. The Sagnac eﬀect. This eﬀect, which appears in a rotating frame, is de-
scribed in Sect. 7.2.1. Its consequence is that the time required for an
electromagnetic signal to travel from a station A to a station B is diﬀer-
ent from the time required to travel from B to A, depending on whether
the signal is moving against or with the rotation of the reference system.
The Sagnac eﬀect introduces the asymmetry dSa
AB between the two paths
A →M and B →M. Nevertheless, this asymmetry can easily be com-
puted to a good accuracy (better than 1 ns) with only a poor knowledge
of the positions of A, B and S [54].
The term δtp
BA −δtp
AB is then
δtp
BA −δtp
AB = (dBS −dAS) + (dSA −dSB) + (dS
BA −dS
AB)
+ (dT
B −dT
A) + (dR
A −dR
B) .
(7.23)
The delays introduced by the Earth equipment can be calibrated using a mo-
bile Earth station M as follows:
1. If the mobile Earth station M is collocated with the station A and uses
the same clock CA as station A:
–
the Sagnac eﬀect cancels,
–
the time diﬀerence between the two clocks under test cancels, since it
is the same clock, and
11 In such signals, information is represented by pseudo-random noise sequences. If
the sequences representing the two signals have low cross-correlation, they can
be handled at the same time and in the same range of frequencies by the satellite
transponder without interference. CDMA is the common platform on which 3G
technologies are built.
www.ebook3000.com

150
7 Time and Frequency Metrology
–
the diﬀerence in the measurements in A and M is consequently
∆tA
1 −∆tM
1 = 2(tM
1 −tA
1 ) + (δtp
MA −δtp
AM)
(7.24)
= δtp
MA −δtp
AM
(7.25)
with
δtp
MA = dMS + dSA + dS
MA + dT
M + dR
A ,
(7.26)
δtp
AM = dAS + dSM + dS
AM + dT
A + dR
M .
(7.27)
Therefore,
∆tA −∆tM = δtp
MA −δtp
AM
= dMS −dAS + dSA −dSM
+ dS
MA −dS
AM + dT
M −dT
A + dR
A −dR
M
= dS
MA −dS
AM + dT
M −dT
A + dR
A −dR
M .
(7.28)
2. If the mobile Earth station M is now collocated with the station B and
uses the same clock CB as station B, the diﬀerence in the measurements
in B and M is
∆tB
3 −∆tM
3 = δtp
MB −δtp
BM
= dMS −dBS + dSB −dSM
+ dS
MB −dS
BM + dT
M −dT
B + dR
B −dR
M
= dS
MB −dS
BM + dT
M −dT
B + dR
B −dR
M .
(7.29)
3. Comparing the two sessions gives
(∆tA
1 −∆tM
1 ) −(∆tB
3 −∆tM
3 ) = dS
MA −dS
MB + dS
BM −dS
AM
+ dT
B −dT
A + dR
A −dR
B
= dT
B −dT
A + dR
A −dR
B .
(7.30)
In (7.30), it has been supposed that the satellite transponder is reciprocal,
by using CDMA mode, for instance. This equation gives the value of the
global eﬀect of the equipment of the Earth stations.
A detailed analysis of the time transfer instabilities produced by these pa-
rameters instabilities is carried out in [102]. With the exception of the Sagnac
eﬀect, and assuming reciprocity of the physical paths, the precise knowledge
of the positions of the satellite and of the Earth stations is not necessary.

8 Navigation and Localization:
Global Positioning System
Accurate and stable timing signals emitted by well localized stations allow any
receiver to determine its precise localization by a triangulation computation.
The idea of the global positioning system is to obtain worldwide coverage
by putting the emitters in satellites orbiting around the Earth1. The draw-
back is the fact that the emitters are not ﬁxed in a given position, which is
a source of uncertainty and implicates the need to maintain a knowledge as
accurate as possible of their ephemeris.
The global positioning system, GLONASS and Galileo provide or will
provide high accuracy localization and time transfer to any user. Only GPS
is now fully operational and will be discussed here. GPS is based on a con-
stellation of at least2 24 satellites that broadcast precise radio timing signals.
Its oﬃcial name is NAVSTAR GPS (navigation signal timing and ranging
GPS).
Any observer that can receive and process the information broadcast by at
least four of these satellites can accurately determine its location (longitude,
latitude and altitude) in real time as well as the value of UTC.
This system was developed and is maintained by the United States De-
partment of Defense. The satellite constellation is managed by the 50th Space
Wing at Schriever Air Force Base. The cost of maintaining the system, in-
cluding the replacement of aging satellites, is approximately US$ 400 million
per year. GPS is now available for free use in civilian applications anywhere
on the Earth.
The wide area augmentation system (WAAS), available since August
2000, increases the accuracy of GPS signals to within 2 meters. Moreover,
the accuracy can be improved further, to about 1 cm over short distances,
using techniques such as diﬀerential GPS (DGPS, see Sect. 8.2.3).
GPS has numerous applications in navigation on land, sea, and air around
the world, and is an important tool for map-making and land surveying.
It also provides an extremely precise time reference, giving access to UTC,
required for telecommunications and some scientiﬁc research, including the
study of troposphere, ionosphere and earthquakes (see Sect. 9).
1 Satellites are often called “space vehicles” – SV – in the specialized literature.
2 The nominal GPS operational constellation consists of 24 satellites but they are
often more numerous as new ones are launched to replace older satellites.
www.ebook3000.com

152
8 Global Positioning System
At the end of 2005, the ﬁrst in a series of next-generation GPS satellites
was added to the constellation, oﬀering several new capabilities, including
a second civilian GPS signal called L2C for enhanced accuracy and reliability.
8.1 The GPS Infrastructure
The system relies on three main parts (called segments).
8.1.1 The Space Segment
The space segment consists of the GPS satellites and their equipment. The
nominal GPS Operational Constellation is made of 24 satellites that orbit
the Earth in 12 hours. The orbit altitude (20 000 to 25 000 km) is such that
the satellites repeat the same track and conﬁguration over any point of the
Earth approximately each 24 hours.
The satellites orbit the Earth in six orbital planes (with nominally four
satellites in each), equally spaced (each plane is deduced from another one
by a rotation of 60◦along the polar axis), and inclined at about 55◦degrees
with respect to the equatorial plane. The arrangement of the orbits is shown
in Fig. 8.1.
This disposition allows any user in the vicinity of the Earth’s surface to
receive between 5 and 12 satellites at any time.
Fig. 8.1. Orbits of the GPS satellites

8.1 The GPS Infrastructure
153
The operational satellites belong to diﬀerent generations (Block II,
Block IIA, Block IIR and Block IIR-M) and do not have the same equip-
ment, but all of them contain atomic clocks, emitters and receivers.
The Block II satellites were launched from February 1989 through October
1990. They were designed to provide 14 days of operation without contact
from the control segment (see below). One satellite from Block II is still
operational.
The Block IIA satellites were launched from November 1990 through
November 1997. They were designed to provide 180 days of operation without
contact from the control segment, but during this long period of autonomy,
the accuracy of the navigation message was degraded. Fifteen satellites from
block IIA are operational.
The design life of the Block II/IIA satellites is 7.3 years; each contain
two cesium atomic clocks and two rubidium atomic clocks and have selective
availability (SA) and anti-spoof (A-S) capabilities (see below).
The Block IIR satellites are designed to provide at least 14 days of opera-
tion without contact from the control segment and up to 180 days of operation
when operating in the autonomous navigation (AUTONAV) mode. Full ac-
curacy will be maintained using a technique of ranging and communication
between the Block IIR satellites themselves. Cross-link ranging will be used
to estimate and update the parameters in the navigation message of each
Block IIR satellite without contact from the control segment.
The design life of the Block IIR satellite is 7.8 years; each contains three
Rb atomic clocks and have SA and A-S capabilities (see below). Launching of
the Block IIR satellites began in January 1997, thirteen satellites from block
IIR are operational.
The ﬁrst GPS IIR-M satellite was launched on 26 September 2005. This
new series of satellites will broadcast two new military signals and a second
civil signal (L2C). Detailed information on the GPS satellites is given in [121,
122] and [111].
8.1.2 The Control Segment
Five stations around the world monitor the data given by the satellites. These
stations are located on the following islands: Hawaii (Paciﬁc Ocean), Kwa-
jalein (Paciﬁc Ocean), Ascension Island (Atlantic Ocean), Diego Garcia (In-
dian Ocean). The master station is located at Colorado Springs (Schriever
Air Force Base, 50th Space Wing, 1st Space Operations Squadron).
The monitor stations are equipped with atomic clocks and GPS receivers
located on geodesic points whose coordinates are known with great accuracy.
The data obtained by these receivers allow the calculation of the position of
the satellites and the time diﬀerence between the clock inboard the satellites
and GPS time.
The master control station processes the observations of the monitor sta-
tions and sends updates to the satellites through the stations at Ascension
www.ebook3000.com

154
8 Global Positioning System
Island, Diego Garcia and Kwajalein. As a result, the atomic clocks inboard
the satellite are synchronized to GPS time to within one microsecond and the
ephemeris of the internal orbital model of the satellite is adjusted in order
to match the observations of the satellites from the ground. These corrected
data are incorporated in the message emitted by the satellite.
8.1.3 The User Segment
The GPS user segment consists of GPS receivers, which are passive and con-
vert the data received from the satellites into the four coordinates: latitude,
longitude, altitude and time. Four satellites are required to compute these
four dimensions of X, Y , Z (position) and time.
The following applications are possible:
–
Navigation is the primary function of GPS. Navigation receivers are made
for aircraft, ships, ground vehicles, and for hand carrying as well.
–
More precise positioning is possible using a diﬀerential scheme where the
position of the operating receiver is compared to the precisely known
position of a reference receiver. Some of the errors limiting the accuracy
are eliminated in this diﬀerential scheme, which is applied in surveying,
geodetic control, and plate tectonic studies, for example.
–
Time and frequency dissemination, based on the precise clocks on board
the satellites and controlled by the monitor stations (GPS time scale, see
Sect. 7.1.1) is another use for GPS. Astronomical observatories, telecom-
munications facilities and laboratory standards can be set to precise time
signals or controlled to accurate frequencies by special purpose GPS re-
ceivers. Individuals can also access a precise time with a hand-held re-
ceiver.
8.2 GPS Data Processing
8.2.1 Data Transmitted by the Satellites
The GPS satellites continuously emit a numerous amount of accurate and
necessary information to the receiver in order to calculate its position and
the time. The coding, formats and protocols are described below.
Media and Coding
The data are transmitted by the satellites using the spread spectrum tech-
nique3: the binary useful message is scrambled by a pseudo-random noise
(PRN) sequence before modulating the carrier.
3 In the spread spectrum technique, a signal is transmitted on a bandwidth much
larger than the frequency content of the original information. It employs direct

8.2 GPS Data Processing
155
Two microwave carriers named L1 and L2 (Fig 8.2) and two PRN se-
quences are involved in the satellite emission:
1. Carrier L1 carries the navigation message whose spectrum has been
spread by:
–
the C/A-code (coarse acquisition code), which allows the so-called
standard positioning service (SPS),
–
the P-code (precise code), which allows the so-called precise position-
ing device (PPS).
Its frequency – 1575.42 MHz – results from the multiplication of the base
frequency f0 = 10.23 MHz by a multiplying factor of 154.
2. Carrier L2 carries the navigation message whose spectrum has been
spread by:
–
the same P-code as L1;
its frequency – 1227.60 MHz – results from the multiplication of the base
frequency f0 = 10.23 MHz by a multiplying factor of 120.
Fig. 8.2. L1 and L2 signals emitted by the GPS satellites
sequence, frequency hopping or a hybrid of these. It is extensively used for wire-
less Ethernet links, digital cellular telephony, etc. It decreases the interference to
other receivers and achieves privacy. The spread spectrum technique generally
makes use of a sequential noise-like signal structure (pseudo random noise) to
spread the band information signal over a wider band of frequencies. The receiver
correlates the received signals to retrieve the original information. The receiver
must be aware of the sequence used in order to retrieve the information.
www.ebook3000.com

156
8 Global Positioning System
The same P-code is transmitted on two diﬀerent frequencies, which allows
precise positioning service equipped receivers to measure the ionospheric de-
lay (from the delay diﬀerence between the two frequencies) and to obtain
a better precision than that obtained from the model emitted by the satellite.
Until 2000, the so-called selective availability intentionally degraded the
SPS accuracy. In 2000, selective availability was turned oﬀby US presidential
order, giving all GPS receivers the potential accuracy of 15 meters without
the use of signal correction.
In the anti-spooﬁng (AS) mode of operation, the P-code is encrypted into
the Y-code. The encrypted Y-code requires a classiﬁed AS module for each
receiver channel and can be used only by authorized users with cryptographic
keys.
Construction of the signals L1 and L2
1. The satellite navigation message is a continuous 50 bits/s data stream
that describes the GPS satellite orbits, clock corrections and other system
parameters. The detailed format of this message is described below. The
envelope of the Fourier transform of this signal is the Fourier transform of
an elementary bit, i.e. is proportional to 1/Tm×sinc(πνTm). The width of
the spectrum of this signal is consequently of the order of 1/Tm = 50 Hz
and its amplitude is proportional to Tm.
2. This data stream is added modulo 2 (exclusive OR) to the PRN C/A-
code and to the PRN P-code (Fig. 8.3). The bit rate of the C/A-code is
exactly 20 460 times the bit rate message, the bit rate of the P-code is
exactly 204 600 times the bit rate message.
The result of these additions are two sequences whose elementary bits
are, respectively, 20 460 times and 204 600 times narrower than that of
the message sequence. Consequently, the spectra of these sequences are,
respectively, 20 460 times and 204 600 times wider than the spectrum
of the message (i.e. 1.023 MHz and 10.23 MHz, respectively) while their
amplitude is reduced by the same factor.
Fig. 8.3. Modulo 2 (XOR) addition of the navigation message and the C/A-code
and the P-code

8.2 GPS Data Processing
157
It is impossible to read the original message in any of the two resulting
sequences, unless the codes (C/A-code and P-code) that have been used
to spread its spectrum are known. On the contrary, if the C/A-code or the
P-code is known and synchronized, it is easy to retrieve the navigation
message by simple logic operation. In fact, an XOR gate can deliver the
navigation message; see Fig. 8.4. The user receiver must independently
generate and synchronize with the satellite transmitted C/A-code and
perform modulo 2 addition in order to decode and interpret the naviga-
tion message.
3. These resulting sequences modulate the phase of each carrier; any tran-
sition 0 →1 or 1 →0 shifts the phase by π.
One elementary bit 0 →1 →0 occurring at time t0 produces, for instance,
the phase variation of the carrier
φ(t) = 2πν0t + πΠ(t −t0) ,
(8.1)
where Π(t) is the square function of width Tc, the period of the PRN-
code.
The Fourier transform X(ν) of the signal x(t) = x0 exp[jφ(t)] emitted by
the satellite is then
X(ν) =
 ∞
−∞
x(t) exp(−2jπνt)dt
=
 ∞
−∞
x0 exp[−2jπ(ν −ν0)t] exp(jπΠ(t −t0))dt
=
 t0−Tc/2
−∞
x0 exp[−2jπ(ν −ν0)t]dt
+
 ∞
t0+Tc/2
x0 exp[−2jπ(ν −ν0)t]dt
+
 t0+Tc/2
t0−Tc/2
x0 exp[−2jπ(ν −ν0)t] exp(jπ)dt .
Fig. 8.4. Easy retrieval of the navigation message
www.ebook3000.com

158
8 Global Positioning System
Since
x0 exp[−2jπ(ν −ν0)t] exp(jπ) = −x0 exp[−2jπ(ν −ν0)t] ,
the Fourier transform is
X(ν) =
 ∞
−∞
x0 exp[−2jπ(ν −ν0)t]dt
−2
 t0+Tc/2
t0−Tc/2
x0 exp[−2jπ(ν −ν0)t]dt
= x0δ(ν −ν0)
−2x0Tc exp[−2jπ(ν −ν0)t0]sinc[π(ν −ν0)Tc] .
(8.2)
This result shows that
–
the width is of the order of 1/Tc Hz and
–
the amplitude of the spectrum of the signal emitted by the satellite
is proportional to Tc (Tc is the period of the PRN-code, C/A-code or
P-code).
The L1 signal is consequently spread over a frequency range of about
1 MHz, while the L2 wave is spread over about 10 MHz.
Format and Protocol
The signal speciﬁcations (for the standard positioning service) are detailed
in [119] and [120].
The Structure of the Navigation Message
The navigation message is a continuous 50 bits/second data stream. Each
message is 1 500 bits long and takes 30 seconds to be transmitted. The start
of any message frame is precisely on the minute and half minute, according
to the clock of the satellite.
Each GPS satellite provides data required to support the position deter-
mination process. These data include:
–
satellite time of transmission,
–
satellite position,
–
satellite health,
–
satellite clock correction,
–
propagation delay eﬀects,
–
time transfer to UTC,
–
constellation status.
This information is given in the ﬁve subframes, each 300 bits long, of every
frame.

8.2 GPS Data Processing
159
1. Subframe 1: GPS week number, satellite accuracy and health, satellite
clock correction terms.
2. Subframes 2 and 3: Ephemeris parameters.
3. Subframe 4: Almanac and health data for satellites 25–32, special mes-
sages, satellite conﬁguration ﬂags, ionospheric and UTC data.
4. Subframe 5: Almanac and health data for satellites 1–24, almanac refer-
ence time, week number.
The complete information “almanac and health data for satellites 25–32, spe-
cial messages, satellite conﬁguration ﬂags, ionospheric and UTC data” (sub-
frame 4) is spread over 25 successive values (pages) of this subframe. In
a similar way, the complete information “almanac and health data for satel-
lites 1–24, almanac reference time, week number” (subframe 5) is given by
25 successive values (pages) of this subframe.
Each subframe contains 10 words of 30 bits each. The ﬁrst word of each
subframe is called a telemetry (TLM) word and the second one is called
a handover word (HOW). It is followed by eight data words giving the infor-
mation mentioned above. Each word in each frame contains parity. The ﬁrst
8 bits in the telemetry word contain a sync pattern, used by the receiver to
synchronize itself with the navigation message.
Time Information
Satellite Time The satellite time is connected to the GPS time scale (see
Sect. 7.1.1), which is established by the control segment and is used as the
primary time reference for all GPS operations. GPS time is referenced to
a UTC (as maintained by the US Naval Observatory), the origin being de-
ﬁned as midnight on the night of 5 January 1980/morning of 6 January
1980.
GPS time diﬀers from UTC because GPS time is a continuous time scale,
while UTC is corrected when necessary with a leap second (see Sect. 7.1.1).
There is also an inherent drift rate between the UTC and GPS time scales,
but the GPS time scale is maintained to be within one microsecond of UTC
(modulo one second). The navigation data contains the requisite data for
relating GPS time to UTC. The largest unit used in stating GPS time is one
week (604 800 seconds).
In each satellite, a 1.5 second epoch derived from the inboard clocks pro-
vides the unit for precisely counting and communicating time. Time stated
in this manner is referred to as a Z-count. This Z-count is provided to the
user as a 29-bit binary number consisting of two parts as follows:
1. The binary number represented by the 19 least signiﬁcant bits of the
Z-count is referred to as the time of week (TOW) count and is deﬁned as
being equal to the number of units (of 1.5 seconds) that have occurred
since the transition from the previous week. The range of the TOW-count
is from 0 to 403 199 units (i.e. 604 800 s, which corresponds to one week)
www.ebook3000.com

160
8 Global Positioning System
and is reset to zero at the end of each week. The TOW-count’s zero state
is deﬁned as the start of the present week. This epoch occurs at (approx-
imately) UTC midnight Saturday night/Sunday morning, the diﬀerence
depending on the number of leap seconds of UTC (see Sect. 7.1.1).
In order to aid rapid ground lock-on, a truncated version of the value
of the TOW-count at the start of the next subframe, consisting of its
17 most signiﬁcant bits, is contained in the hand-over word (HOW, the
second word of each subframe of the navigation message); the actual
TOW-count is converted from the HOW-message by a multiplication of
22 = 4. The time unit being 1.5 s, the time (in seconds) deduced from
this truncated Z-count must be multiplied by 6.
2. The sequential number of the present GPS week (modulo 1024) is given
by the ten most signiﬁcant bits of the Z-count. The range of this count
is consequently from 0 to 1 023. The GPS time scale was initialized on
(UTC) 0 h 0 m 0 s 6 January 1980 (MJD 44 244) and was then set equal
to UTC. This epoch is the origin of the week count. At the expiration of
GPS week number 1 023 (MJD 51 412, 22 August 1999), the GPS week
number has rollover to zero (0). Users must account for the previous 1 024
weeks in conversions from GPS time to a calendar date.
The third word of the ﬁrst subframe contains the ten bits giving the
sequential number of the present GPS week (week no).
GPS Time Subframe 1 (Bits 9 through 24 of word 8, bits 1 through 24 of
word 9, and bits 1 through 22 of word 10) contains the parameters allowing
the satellite clock to be corrected relative to the GPS time scale.
UTC Page 18 of subframe 4 includes the parameters needed to relate GPS
time to UTC, and a notice to the user regarding the scheduled future or
recent past value of the delta time due to leap seconds (DtLSF), together
with the week number (WNLSF) and the day number (DN) at the end of
which the leap second becomes eﬀective.
Ephemeris Information
The ephemeris data transmitted are the following:
M0
Mean anomaly at reference time
∆n
Mean motion diﬀerence from computed value
e
Eccentricity
(A)1/2
Square root of the semimajor axis
(OMEGA)0
Longitude of ascending node of orbit plane at weekly epoch
i0
Inclination angle at reference time
ω
Argument of perigee
OMEGADOT
Rate of right ascension
IDOT
Rate of inclination angle
Cuc
Amplitude of the cosine harmonic correction term to
the argument of latitude

8.2 GPS Data Processing
161
Cus
Amplitude of the sine harmonic correction term to
the argument of latitude
Crc
Amplitude of the cosine harmonic correction term to
the orbit radius
Crs
Amplitude of the sine harmonic correction term to
the orbit radius
Cic
Amplitude of the cosine harmonic correction term to the
angle of inclination
Cis
Amplitude of the sine harmonic correction term to the
angle of inclination
toe
Reference time ephemeris
IODE
Issue of data (ephemeris)
The almanac is a subset of the clock and ephemeris data, with reduced
precision.
Updating the Navigation Message
The control segment typically updates the navigation message of each satellite
every 24 hours by uploading new values. In an upload the master control
station (MCS) sends to the satellite all of the data that the satellite will
transmit during the next 24 hours. When a satellite begins transmitting a new
data set this is called a cutover. The ﬁrst cutover after an upload may occur
at any time of the hour, but subsequent cutovers only occur precisely on
hour boundaries. At any time, a receiver can ensure that it is using up-to-
date ephemeris and clock data for the satellites in view due to the issue of
data clock (IODC), provided in subframe 1 and the issue of data, ephemeris
(IODE), provided in both subframes 2 and 3 values. Whenever these three
terms do not match with those memorized by the receiver, a data set cut-
over has occurred and new data must be collected. Moreover, any typical
receiver is all-in-view, which means that it tries to track all satellites in view
continuously.
8.2.2 Data Processing by the Receiver
In a ﬁrst step, the receiver must collect the data transmitted by the satellites.
Then, it must process these data in order to obtain the required information,
such as its position.
Reading the Data
Any GPS receiver must retrieve some raw data from the received message in
order to compute its position.
www.ebook3000.com

162
8 Global Positioning System
The PRN Codes: Pseudo-Range
The value of the raw pseudo-range (pseudo-distance between the receiver and
a given satellite) is obtained by comparing the (C/A or P) PRN sequence
received by the receiver with the same signal generated (and synchronized)
by the receiver, which must consequently be aware of the code emitted by
each satellite (see Fig. 8.5):
1. The C/A-code is a repeating 1.023 MHz Code. Since its length is 1023 bits,
it repeats every 1 ms. The time diﬀerence between the local code and the
received code is consequently measured with an ambiguity of an integer
number of ms, corresponding to an integer multiple of 299 792.458 m in
the pseudo-range.
In fact, since the minimal vertical distance between any satellite and the
Earth’s surface is 20 000 km, the minimal time delay for a receiver located
on the Earth surface is 66.7 ms. This ambiguity can easily be raised due to
an estimated value (with an error smaller than 300 km) of the coordinates
of the receiver.
2. The P-code is also a repeating code, but its length is of the order of one
week. There is consequently no ambiguity in the time delay measurement.
Fig. 8.5. Measurement of the raw pseudo-range (modulo 299 792.458 m)
The Navigation Message
The data transmitted by the navigation message are described in Sect. 8.2.1.
Knowing the PRN-code spreading its spectrum, it is easy for the receiver
to detect this message (see Sect. 8.2.1).
It is to be noted that an elementary message is 30 s long and that 25 suc-
cessive messages (each one is called a page) are necessary to transmit the full
ephemeris and almanac data.
Pseudo-Range Calculation
The receiver can deduce its position from the messages it receives from at least
four satellites by a mere triangulation computation. The observed pseudo-
range PR (pseudo-distance between the receiver and the satellite) is deduced

8.2 GPS Data Processing
163
from the propagation time of the signal emitted by the satellite:
PRm = c(tr −tt) ,
(8.3)
where c is the speed of light, tr is the time in which the ranging measurement
was received, measured by the clock of the receiver, tt is time in which the
ranging signal was transmitted from the satellite. These times must ﬁrst be
corrected from the satellite clock bias and propagation delays.
1. Satellite clock correction. The polynomial whose coeﬃcients af0, af1 and
af2 and reference time toc are transmitted in subframe 1 (bits 9 through 24
of word 8, bits 1 through 24 of word 9, and bits 1 through 22 of word 10)
allows the user to determine the eﬀective satellite PRN code phase oﬀset
referenced to the phase center of the satellite antennas (∆tclock
sv
) with
respect to GPS system time (t) at the time of data transmission
∆tclock
sv
= af0 + af1(t −toc) + af2(t −toc)2 .
(8.4)
This correction accounts for the deterministic satellite clock error (bias,
drift and aging), as well as for the satellite group delay and mean diﬀer-
ential group delay (the group delay is deﬁned as the delay between the
L-band radiated output of a speciﬁc satellite – measured at the antenna
phase center – and the output of its on-board frequency source).
2. Satellite diﬀerential group delay TGD [31], the diﬀerence between the
group delays of the waves L1 and L2. The value of this delay is given by
the bits 17 through 24 of word seven of subframe 1 data.
3. Relativistic correction ∆tr. This correction is deduced from the ephemeris
parameters given in subframes 2 and 3
∆tr = FeA1/2 sin(Ek) ,
(8.5)
where e is the eccentricity, A1/2 is the square root of the semimajor axis
and Ek is deduced from Kepler’s equation for eccentric anomaly.
F = −2µ1/2
c2
(8.6)
= −4.442807633 × 10−10 s/m1/2 ,
(8.7)
where c is the speed of light and µ is the Earth’s universal gravitational
parameter.
4. Ionospheric correction. The SPS user can correct the time received from
the satellite for ionospheric eﬀect Tiono by utilizing parameters contained
in page 18 of subframe 4, according to the algorithm given in [119]. It
uses data transmitted by the satellite (the four coeﬃcients of a cubic
equation representing the amplitude of the vertical delay and the four
coeﬃcients of a cubic equation representing the period of the model)
and some terms generated by the receiver (the elevation angle between
the user and satellite, the azimuth angle between the user and satellite,
www.ebook3000.com

164
8 Global Positioning System
the receiver’s geodetic latitude and longitude WGS-84 and the receiver’s
computed system time.
Application of this algorithm leads to a reduction of 50% only of the error
due to the ionospheric delays.
5. Tropospheric correction Ttropo. The troposphere is the lower part of the
atmosphere extending from ground level to from 8 to 13 km, according
to the latitude. It experiences changes in temperature, pressure and hu-
midity associated with weather changes. Precise models of tropospheric
delay require estimates or measurements of these parameters and no in-
formation is transmitted by the satellite. The apparent delay introduced
by the troposphere can vary between 2 m, for a satellite elevation of 90◦
and 30 m for an elevation of 5◦.
If t′
r is the raw value of the time of reception of the signal and t′
t the raw
value of the time of its transmission, the corrected time of reception of the
signal is consequently,
tr = t′
r −Tiono −Ttropo ,
(8.8)
while the corrected time of emission of the same signal is
te = t′
e + af0 + af1(t −toc) + af2(t −toc)2 −TGD + ∆tr
(8.9)
and the pseudo-range PR, corrected from these eﬀects, is
PR = c(tr −te) .
(8.10)
Moreover, the clock of the receiver is not exactly set to the GPS time and
must be corrected from an error δt. This correction is one of the four unknown
quantities calculated by the receiver from the four (or more) pseudo-range
measurements.
Determination of Coordinates and Time
The calculations are performed in the ECEF4 reference system.
The value of at least four corrected ranges CRi, 1 ≤i ≤4 between the
receiver and at least four satellites Si allows the calculation of the three
spatial coordinates X, Y , Z of the receiver in this reference system and the
time correction δt to apply to the receiver clock. X, Y , Z and δt are the four
unknown quantities of this calculation. The distance ρi between the receiver
and the clock Ci is
4 ECEF: Earth centered, Earth ﬁxed. This is the reference system whose origin is at
the Earth’s center, whose X-axis crosses the equator at the prime meridian Z-axis
is the axis of rotation of the earth and whose Y -axis forms a right-handed system
with the X-axis and the Z-axis. The distances in this system are expressed in
meters. The conversion in latitude, longitude and altitude relies on the deﬁnition
of the geoid ellipsoid.

8.2 GPS Data Processing
165
ρi =

(Xi −X)2 + (Yi −Y )2 + (Zi −Z)2 .
(8.11)
The spatial coordinates Xi, Yi and Zi of the satellite Si are given by the
navigation message. It is to be noted that the navigation message gives the
ephemeris data in the WGS 845 reference system. The distance ρi can be
expressed as
ρi == CRi + cδt .
(8.12)
The quantity cδt is the correction related to the error of the receiver time.
The four unknown quantities X, Y , Z and δt can consequently be deduced
from the four equations
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩

(X1 −X)2 + (Y1 −Y )2 + (Z1 −Z)2 = CR1 + cδt ,

(X2 −X)2 + (Y2 −Y )2 + (Z2 −Z)2 = CR2 + cδt ,

(X3 −X)2 + (Y3 −Y )2 + (Z3 −Z)2 = CR3 + cδt ,

(X4 −X)2 + (Y4 −Y )2 + (Z4 −Z)2 = CR4 + cδt .
(8.13)
A simple algorithm for the calculation of X, Y , Z and δt from these four
equations is given in Sect. B.7. This algorithm can be applied in the case
where an estimate of the position of the receiver is known and gives the
correction to this estimate.
The accuracy of the result depends on the relative position of the satellites
and of the receiver. This is characterized by the geometric dilution of preci-
sion (GDOP). Figure 8.6 shows a two-dimensional model of a good relative
position while Fig. 8.7 shows a poor one.
Fig. 8.6. Good GDOP
5 WGS 84 stands for world geodetic system 1984. This reference system agrees
with the international terrestrial reference frame – ITRF.
www.ebook3000.com

166
8 Global Positioning System
Fig. 8.7. Poor GDOP
Poor GDOP results when angles from the receiver to the set of satellites
used are not very diﬀerent (Fig. 8.7) while good GDOP results when angles
from the receiver to satellites are quite diﬀerent (Fig. 8.6).
GDOP is computed from the geometric disposition of the receiver and
the satellites used by the receiver. For planning purposes GDOP is often
computed from almanacs and an estimated position of the receiver (which
does not need to be known with great accuracy). Of course, the estimated
GDOP does not take into account obstacles that may block the line-of-sight
from the receiver to the satellites. Consequently, an estimated GDOP may
not be realizable in the ﬁeld.
The Main Error Sources
GPS errors are a combination of noise and bias.
Noise Errors
They are the combined eﬀect of PRN code noise (around 1 meter) and noise
within the receiver (around 1 meter).
Bias Errors
1. Satellite clock errors that are not corrected by the control segment can
result in 1 meter errors.
2. Ephemeris data errors can result in 1 meter errors.
3. The error on the tropospheric delays can result in 1 meter errors.
4. The error on the ionosphere delays results in 10 meter errors.
5. Multipath error are caused by reﬂected signals from surfaces near the
receiver that can either interfere with or be mistaken for the direct signal.
The resulting error is less than 1 meter.
Some much larger errors can result of an incorrect use of the receiver.

8.2 GPS Data Processing
167
GDOP
In general, these errors must be multiplied by the appropriate GDOP term
to estimate the resulting position or time error. Various GDOP terms can be
computed.
–
ECEF XYZ DOP terms can be rotated into a North–East down (NED)
system to produce local horizontal and vertical DOP terms.
–
PDOP is the (3D) position dilution of precision.
–
HDOP is the horizontal dilution of precision (latitude, longitude).
–
VDOP is the vertical dilution of precision (altitude).
–
TDOP is the time dilution of precision (time).
8.2.3 Other Algorithms
The fundamental processing of the data transmitted by the satellites is de-
scribed above. Other algorithms are possible.
Using the P-code
The principle is the same as for the C/A code, with the following improve-
ments:
1. The bit rate is ten times the bit rate of the C/A code. The synchronization
of the receiver can consequently be more accurate.
2. The length of the sequence is one week; there is no ambiguity in the
pseudo-range.
3. The code modulates the two carriers L1 and L2 whose frequencies are
diﬀerent (1 575.42 and 1 227.60 MHz).
The time diﬀerence between the two received sequences (which are emit-
ted at the same time) is due to the ionospheric delay, which depends on
the frequency ν as 1/ν2.
It is consequently possible to deduce the ionospheric time delay from this
time diﬀerence and the correction for this eﬀect is thus much more precise
than the application of the model emitted by the satellites.
Diﬀerential GPS (DGPS)
GPS accuracy can be improved further to about 1 cm over short distances,
using diﬀerential GPS (DGPS).
DGPS uses a network of stationary, well localized, GPS receivers and
calculates the diﬀerence between their actual known position and the position
as calculated by their received GPS signal. This observed error is broadcast
as a local FM signal, and can be used by a user located in the vicinity of each
station to correct their own calculated position, assuming that their error is
the same as that of the station.
www.ebook3000.com

168
8 Global Positioning System
Carrier Phase Tracking
The carrier of the signal emitted by the satellites allows distances of up to
30 km to be measured with a precision of a few mm.
Starting from an epoch t0, the phase variation ∆φi(t −t0) of the carrier
of satellite Si is continuously measured by the receiver. Assuming that the
satellite clock is perfectly stable and that the ionospheric and tropospheric
delays are constant during the duration of the measurement, this phase vari-
ation is only due to the variation ∆di(t −t0) of the distance between the
receiver and the satellite Si. If the wavelength of the carrier is λc, a phase
variation ∆φi corresponds to a distance variation
∆di = λc∆φi
2π
(8.14)
= c∆φi
2πνc
.
(8.15)
The phase of the received signal is measured against the phase of a reference
oscillator; in this case, it is the clock of the receiver. Errors can consequently
be due to the clock of the satellite, the clock of the oscillator and various
delays such as ionospheric delay.
Phase Fluctuations and the Time Error of a Clock
The signal emitted by a clock C is
x(t) = X exp[jφ(t)]
(8.16)
= X exp[j2πν0t + jδφ(t)] ,
(8.17)
where ν0 is the nominal value of its frequency (for instance 1 575.42 MHz for
the L1 signal) and δφ(t) is the value of the phase ﬂuctuation at time t.
The value tC(t) of the time given by the clock C at time t is
tC(t) = φ(t)
2πν0
(8.18)
= t + δφ(t)
2πν0
.
(8.19)
The time error δtC(t) of the clock C is then
δtC(t) = δφ(t)
2πν0
.
(8.20)
This means, for instance, that a time error of 1 ns produces a phase error of
9.9 rad on the L1 signal.

8.2 GPS Data Processing
169
Time Error and Range Error
The error δd on the measured range due to a time error δtC is
δd = c × δtC .
(8.21)
This means that a time error of 1 ns produces a pseudo-range error of about
30 cm.
Notice that, since the phase of the received signal is measured against the
phase of the receiver clock, the time error can arise from the satellite clock,
from the receiver clock or from both.
The constraints on the time error are diﬃcult to fulﬁll and diﬀerential
measurement are usually performed. In fact, in order to eﬀectively get rid
of the delay ﬂuctuations, the motion of the satellites and the satellite clock
ﬂuctuations, all carrier-phase tracking is diﬀerential and at least two receivers
track carrier signals at the same time. Delay diﬀerences at the two receivers
must be small enough to insure that the ionospheric and tropospheric pertur-
bations are the same. This usually requires that the two receivers be within
about 30 km of each other.
Diﬀerential Phase Measurements
Let
–
δφs(t) be the phase ﬂuctuation of the satellite clock during the measure-
ment;
–
ρ1(t) be the distance between the satellite and receiver number 1. This
receiver is ﬁxed, its position is known with a great accuracy: it is the
reference position;
–
ρ2(t) be the distance between the satellite and receiver number 2;
–
δτ1(t) be the delay ﬂuctuation on the path satellite →receiver number 1,
–
δτ2(t) be the delay ﬂuctuation on the path satellite →receiver number 2.
The phase of the satellite clock at time t is
φs(t) = 2πνst + δφs(t) .
(8.22)
The phase φs,1(t) of the emitted wave arriving on the reference receiver 1 is
φs,1(t) = 2πνs

t −ρ1(t)
c
−δτ1(t)

+ δφs

t −ρ1
c −δτ1(t)

.
(8.23)
The phase φ2(t) of the emitted wave arriving on receiver 2 is
φ2(t) = 2πνs

t −ρ2(t)
c
−δτ2(t)

+ δφs

t −ρ2
c −δτ2(t)

.
(8.24)
www.ebook3000.com

170
8 Global Positioning System
Each of these phases is measured against the phase of the receiver clock.
Receiver 1 measures the phase φm,1
φm,1(t) = 2πνs

t −ρ1(t)
c
−δτ1(t)

+ δφs

t −ρ1
c −δτ1(t)

−2πν1t −δφ1(t) .
(8.25)
Receiver 2 measures the phase φm,2
φm,2(t) = 2πνs

t −ρ2(t)
c
−δτ2(t)

+ δφs

t −ρ2
c −δτ2(t)

−2πν2t −δφ2(t) .
(8.26)
The diﬀerence φm,2(t) −φm,1(t) is
φm,2(t) −φm,1(t) = 2π

νs

t −ρ2(t)
c
−δτ2(t)

−νs

t −ρ1(t)
c
−δτ1(t)

+ δφs

t −ρ2
c −δτ2(t)

−δφs

t −ρ1
c −δτ1(t)

+ 2πν1t + δφ1(t) −2πν2t −δφ2(t) .
(8.27)
The nominal frequencies νs, ν1, ν2 of the oscillators are all equal. The fre-
quency errors are included in the phase ﬂuctuations δφ(t),
φm,2(t) −φm,1(t) = 2πνs
ρ1(t) −ρ2(t)
c
+ δτ1(t) −δτ2(t)

+ δφs

t −ρ2
c −δτ2(t)

−δφs

t −ρ1
c −δτ1(t)

(8.28)
+ δφ1(t) −δφ2(t) .
(8.29)
The diﬀerence ρ1(t) −ρ2(t) of the distances between the reference position
and the satellite and between the measured position and the satellite is con-
sequently
ρ1(t) −ρ2(t) = λs(t) × φm,2(t) −φm,1(t)
2π
+ c × (δτ2(t) −δτ1(t))
+ λs × δφs
"
t −ρ1
c −δτ1(t)
#
−δφs
"
t −ρ2
c −δτ2(t)
#
2π
+ λs × δφ2(t) −δφ1(t)
2π
.
(8.30)
The application of the method relies on the assumption that
–
the uncertainty on the diﬀerence δτ1(t) −δτ2(t) can be neglected, and

8.2 GPS Data Processing
171
–
the phase ﬂuctuation of the emitter on the short time interval,
ρ1(t) −ρ2(t)
c
+ δτ1(t) −δτ2(t)
can be neglected.
Nevertheless, the phase error of the two receiver remains and must be much
smaller than 2π in order to achieve centimetric accuracy. It is to be noted
that no long-term stability is required for the clock of the satellite.
With these assumptions, the range diﬀerence ρ1(t) −ρ2(t) can be moni-
tored continuously, through the phase diﬀerence between the two receivers.
This allows the algorithm of Sect. B.7 to be applied and the distance between
the two receivers to be precisely measured.
The eﬀect of the phase error of the receivers can be strongly reduced by
performing the same measurement with a second satellite (second diﬀerence).
The use of both carriers L1 and L2 allows the ionospheric delay to be
measured, since it depends of the frequency according to a known law. In
this case, it is consequently possible to perform phase measurements over
longer baselines (hundreds of kilometers).
Doppler Measurement
The Doppler frequency shift of the received signal is due to the relative ve-
locity of the emitting satellite and of the receiver in the ECEF reference
system. The velocity of the satellite is known from the navigation message.
The residual Doppler frequency shift can consequently be used to compute
the velocity of the receiver.
This computation can be combined with the value obtained by dividing
the components of the diﬀerence of two successive positions by the time
interval between these two positions.
8.2.4 GPS Augmentation: WAAS and LAAS
Satellite Based Augmentation Systems
WAAS (wide area augmentation system) is a system of satellites and ground
stations that provides GPS signal corrections, giving better position accuracy.
These corrections are broadcast by geostationary satellites and are directly
integrated by most of the GPS receivers. A WAAS-capable receiver can give
a position accuracy better than three meters in both the horizontal and ver-
tical dimensions, 95 percent of the time.
WAAS has been developed for civil aviation applications. It uses a network
of 25 precisely-located ground reference stations that monitor GPS satellite
signals. These stations are located throughout the continental United States,
Hawaii, Puerto Rico and Alaska, with additional stations being installed in
www.ebook3000.com

172
8 Global Positioning System
Alaska, Canada and Mexico. These stations collect and process GPS informa-
tion and send this information to WAAS master stations, which then develop
a WAAS correction message that is sent to user receivers via navigation
transponders on geostationary satellites. These correction messages concern
the orbit parameters and the ionospheric and tropospheric delays. The Eu-
ropean geostationary navigation overlay system (EGNOS) and the Japanese
multifunctional satellite augmentation system (MSAS) are intended to bring
the same wide area augmentation to Europe and to Asia, respectively.
Ground Based Augmentation Systems
A ground based augmentation system provides correction to GPS receivers
at a local scale (an airport, for instance, in order to provide an all-weather
landing system). The local area augmentation system (LAAS) is based on
real-time diﬀerential correction of the GPS signal: local reference receivers
send data to a central location at the airport, which formulate a correction
message transmitted to users via a VHF data link. A receiver on an air-
craft uses this information to correct GPS signals. It is similar to the DGPS
technique.
8.3 Other Global Systems: GLONASS and Galileo
8.3.1 GLONASS –
GLObal’naya NAvigatsionnaya Sputnikovaya Sistema
Up-to-date information on GLONASS is given in [36]. The structure of
GLONASS is very similar to that of GPS.
Space Segment
GLONASS relies on 24 satellites, 11 being operational (03-31-2006). The fully
deployed GLONASS satellite constellation will be composed of 24 satellites
in 3 orbital planes, 8 satellites being equally spaced in each plane. The planes
are inclined by 64.8 degrees relative to the equator plane. Each GLONASS
satellite operates in circular 19 100 km orbit and completes an orbit in ap-
proximately 11 hours 15 minutes.
Control Segment: Ground Based Control Complex
The ground based control complex (GCS) consists the System Control Cen-
ter (Krasnoznamensk, Moscow region) and some command tracking stations
(CTS) located in Russia. The command tracking stations accumulate rang-
ing data and telemetry from the satellite signals. The information from the

8.3 Other Global Systems
173
CTS is processed at the System Control Center, which allows updating of the
navigation message of each satellite. This update is transmitted to the satel-
lites via the CTS, whose ranging data are periodically calibrated using laser
ranging devices at the quantum optical tracking stations within the GCS.
Each GLONASS satellite carries laser reﬂectors for this purpose.
The central synchronizer is the highly precise hydrogen atomic clock form-
ing the GLONASS system time scale. The inboard time scales (on the basis
of satellite cesium atomic clocks) of all the GLONASS satellites are synchro-
nized with the state standard UTC (CIS) in Mendeleevo, Moscow region,
through the GLONASS System time scale.
Emitted Data
Each GLONASS satellite transmits two types of signals: standard precision
(SP) and high precision (HP). The standard precision signal L1 has frequency
division multiple access in the L-band: L1 = 1602 MHz + n × 0.5625 MHz,
where n is the frequency channel number (n = 0, 1, 2, . . .). Each satellite
transmits signal on its own frequency, which diﬀers from that of other satel-
lites. However, some satellites have the same frequencies but they are placed
in antipodal slots of orbit planes and they do not appear at the same time
in a user’s view.
8.3.2 Galileo
The European global navigation satellite system (Galileo) is under civilian
control and interoperable with GPS and GLONASS.
Space Segment
The ﬁrst experimental satellite of the joint project of the European Commis-
sion and the European Space Agency Galileo was launched on 28 December
2005; its full operational capability should be reached in 2010. It will be inter-
operable with GPS and GLONASS, the two other global satellite navigation
systems. The fully deployed Galileo space segment will consist of 30 satellites
(27 operational and 3 active spares), positioned in three circular planes (at
an altitude above Earth of 23 616 km), the orbital planes being inclined at 56
degrees with reference to the equatorial plane.
The Control Segment
The control segment of Galileo will comprise the following:
1. A network of twenty Galileo sensor stations (GSS), which will monitor
the satellites and provide data to the Galileo Control Centers through
a redundant communications network.
www.ebook3000.com

174
8 Global Positioning System
2. Two Galileo control centers (GCC), which will be implemented on Eu-
ropean ground and will use the data of the sensor stations to compute
integrity information and to synchronize the time signals of all satellites
and ground station clocks.
3. Five S-band up-link stations and 10 C-band up-link stations will be in-
stalled around the globe to transmit data from the control centers to the
satellites.
Emitted Data
Galileo will oﬀer dual frequencies signals as standard, consequently allowing
the direct measurement of the ionospheric delay by comparing the delay for
each frequency. The real-time positioning accuracy will consequently be of the
order of one meter, which is unprecedented for a publicly available system.
Galileo will further guarantee the availability of the service under all but
the most extreme circumstances and will inform users in near real-time of
the failure of any satellite. This will make it suitable for applications where
safety is crucial.
Galileo will furthermore provide a global search and rescue (SAR) func-
tion, based on the operational Cospas–Sarsat system6.
6 The objective of the Cospas–Sarsat system is to reduce, as far as possible, delays
in the provision of distress alerts to SAR services, and the time required to locate
distress and provide assistance at sea or on land.

9 Geophysics and Radio-Astronomy:
VLBI – Very Long Base Interferometry
VLBI is an interferometry technique used in radio astronomy, in which two
or more signals, coming from the same astronomical object, are received by
antennas that are very distant from each other, recorded and then correlated
in deferred time (Fig. 9.1). Due to the very long distance between the receivers
and the fact that the resolution is proportional to that distance, a very high
resolution can be obtained (see, for instance [26]).
In conventional interferometry techniques, the signals received by the an-
tennas are directly transmitted via a physical link to the correlator, which
produces the interference fringe in real-time; the antennas are physically con-
nected to the correlator.
In VLBI, the received signals cannot be transmitted directly and in real-
time to the correlator; the propagation time ﬂuctuations in the physical links
would completely cancel the correlation between them.
On the contrary, the signals are combined in diﬀered time; they are con-
verted to a lower standard frequency (IF) and recorded at each telescope
on magnetic tape or hard disk, with a precise time base. The recorded
Fig. 9.1. The principle of VLBI
www.ebook3000.com

176
9 Very Long Base Interferometry
signals are then sent to a correlating centre, where they are synchronized,
and due to the timing information, played together and combined just
as if they were coming in real-time from the antennas. The correlated
data can then, for instance, be turned into images using any appropriate
software.
This is possible only if the phase noise of the local oscillators that down
convert the signal frequency does not blur the interference fringe, and if the
timestamps are accurate and stable during the duration of the experiment.
In fact, only very stable atomic frequency standards can meet these require-
ments.
VLBI is most often performed at radio wavelengths and the following de-
scription is limited to radio signals; however, the technique has been extended
to optics. The principle is very simple. Let
–
AB be the baseline of an array of two antennas. It is the vector position
of one antenna (B) with respect to the other (A).
–
s be a unit vector in the direction of the source.
The time interval τAB (between the arrival of a wave front) to the antennas
is
τAB = B • u
c
,
(9.1)
where c is the light velocity.
The measurement of τAB can provide one of the following types of infor-
mation:
–
the component of s along AB if this vector is known, or
–
the component of AB along s if this vector is known.
Consequently, the applications of VLBI apply to the geodesic domain as well
as the astronomic domain.
If the uncertainty on the measurement of τAB is 1 ps (1 × 10−12 s), (9.1)
shows that
–
if the position of the source is perfectly known, the uncertainty on the
value of the baseline length is of the order of 1 mm, and
–
if the baseline is perfectly known, the uncertainty on the position of the
source is of the order of 1 × 10−9 rd (≈10−3 arcsecond) for a baseline
length of 1 000 km.
9.1 Principle of VLBI
The following description of astronomical interferometry is limited to 1D
models but can easily be extended to the 2D model.

9.1 Principle of VLBI
177
9.1.1 Interferometry
The application of interference methods to provide better resolution in as-
tronomical measurements (in both optical and radio domains) is not a new
concept (see, for instance [93, 108]).
The principle is the following: Consider two (optical or radio) receivers A
and B, separated by a distance D and receiving the electromagnetic radiation
emitted by a point source whose direction is at an angle α (see Fig. 9.2).
Fig. 9.2. The principle of interferometric measurements
Monochromatic Plane Waves
Consider in a ﬁrst step that the incoming wave is plane and perfectly
monochromatic, the frequency is ν, the wavelength is λ, the wave number
is k = 2π
λ and the amplitude is X. The source is very far from Earth and its
direction is indicated by the unit vector s. The direction of the wave propaga-
tion is given by the unit vector e = −s. The equation of the wave is as follows:
x(t, r) = X exp
+
2πν

t −r · e
c
,
.
(9.2)
The vector r = OM corresponds to a point M in the vicinity of the Earth.
The origin O of r is the barycenter of the geoid, for instance. The two receivers
are located at points A and B, respectively.
www.ebook3000.com

178
9 Very Long Base Interferometry
Supposing that the wave front is not perturbed by the atmosphere, the
antennas receive the signals xA(t) and xB(t),
xA(t) = X exp
+
2jπν

t −rA · e
c
,
(9.3)
and
xB(t) = X exp
+
2jπν

t −rB · e
c
,
(9.4)
= xA exp

−2jπν
AB · e
c

(9.5)
= xA exp [j (AB · k)] .
(9.6)
The vector k is
k = 2π
λ e
(9.7)
= ke .
(9.8)
xA(t) and xB(t) can also be expressed as functions of the baseline length D
and the direction of the source α,
xB(t) = xA exp

−2jπ D sin(α)
λ

(9.9)
= xA exp (−jkD sin(α)) .
(9.10)
Using the small angle approximation, which is of course not necessary (the
source position angle α being supposed small),
xB(t) = xA exp (−jkDα) .
(9.11)
The two signals xA(t) and xB(t) are added to give x(t),
x(t) = xA(t) + xB(t)
(9.12)
= xA × [1 + exp (−jAB · k)]
(9.13)
= xA × [1 + exp (−jkDα)]
(9.14)
= 2xA exp

−j kDα
2

× cos
kDα
2

(9.15)
= 2xA exp

−j AB · k
2

× cos
AB · k
2

.
(9.16)
The output of the square law detector is, consequently,
y(α) = 4X2 cos2
kDα
2

(9.17)
= 4X2 cos2
AB · k
2

(9.18)
= 2X2[1 + cos(AB · k)] .
(9.19)

9.1 Principle of VLBI
179
This is the classical interference pattern for monochromatic radiation. The
central fringe is obtained for α = 0 (τAB = 0).
For α ̸= 0, the value of τAB can be measured by introducing in one of the
arms of the interferometer a delay τAB′ = ±τAB, which compensates τAB.
Due to the rotation of the Earth, the value of α (or AB) varies continu-
ously and a series of conﬁgurations can consequently be studied.
Quasi-Monochromatic Plane Wave
In fact, the radiation emitted by the source is never perfectly monochromatic.
Phase and amplitude ﬂuctuations occur,
x(t, r) = X(t) exp
+
2jπν

t −r · e
c
,
(9.20)
with
X(t) = X0[1 + a(t)] exp[jφ(t)] ,
(9.21)
where a(t) represents the relative amplitude ﬂuctuations and φ(t) the phase
ﬂuctuations. These ﬂuctuations are small,
|a(t)| ≪1 ,
(9.22)

dφ(t)
dt
 ≪2πν .
(9.23)
The signals received by the two antennas are
xA(t) = X

t −rA · e
c

exp
+
2jπν

t −rA · e
c
,
(9.24)
= X (t −τA) exp [2jπν (t −τA)]
(9.25)
= X (tA) exp (2jπνtA)
(9.26)
and
xB(t) = X

t −rB · e
c

exp
+
2jπν

t −rB · e
c
,
(9.27)
= X (tA −τAB) exp [2jπν (tA −τAB)] .
(9.28)
In these expressions,
τA = rA · e
c
, tA = t −τA , τB = rB · e
c
, τAB = τB −τA = AB · e
c
. (9.29)
www.ebook3000.com

180
9 Very Long Base Interferometry
The sum of the two signals xA(t) and xB(t) is
xA(t) + xB(t) = X (tA) exp [2jπν (tA)]
+ X (tA −τAB) exp [2jπν (tA −τAB)]
(9.30)
= [X (tA) + X (tA −τAB) exp (−2jπντAB)]
× exp (2jπνtA) .
(9.31)
The output of the square law detector is
|xA(t) + xB(t)|2 = |X (tA)|2 + |X (tA −τAB)|2
(9.32)
+ X (tA) X∗(tA −τAB) exp (2jπντAB)
(9.33)
+ X∗(tA) X (tA −τAB) exp (−2jπντAB) .
(9.34)
This result is integrated over a time ∆t, chosen much longer than the period
of the signals but much shorter than the characteristic time of variation of
the direction α of the source due to the Earth’s rotation. The output y(τAB)
of the interferometer is, consequently,
y(τAB) =
-
|X (tA)|2.
+
-
|X (tA −τAB)|2.
+ ⟨X (tA) X∗(tA −τAB)⟩exp (2jπντAB)
+ ⟨X∗(tA) X (tA −τAB)⟩exp (−2jπντAB) .
(9.35)
The mean value of the amplitude is constant,
-
|X (tA)|2.
=
-
|X (tA −τAB)|2.
= X2
0 .
(9.36)
The mean values of the products
X∗(tA) X (tA −τAB)
and
X (tA) X∗(tA −τAB)
are related to the autocorrelation function γX(t) of X(t),
γX(t) = ⟨X∗(τ)X(t + τ)⟩.
(9.37)
Consequently,
y(τAB) = 2X2
0
+ γX(τAB) exp (2jπντAB)
+ γX(−τAB) exp (−2jπντAB) .
(9.38)
The following property of the autocorrelation function results from its deﬁ-
nition (the autocorrelation is a Hermitian operator):
γX(−t) = γ∗
X(t) .
(9.39)

9.1 Principle of VLBI
181
Consequently,
y(τAB) = 2X2
0 + 2ℜ{γX(τAB) exp (2jπντAB)} ,
(9.40)
where ℜ(z) is the real part of the complex number z.
Notice that
γX(τAB) exp (2jπντAB) = γx(τAB) ,
(9.41)
where γx(t) is the autocorrelation function of x(t, r).
Finally,
y(τAB) = 2X2
0 + 2ℜ{γx(τAB)} .
(9.42)
The conclusions are the following:
1. The useful information is contained in the periodic part of y(τAB), which
is the autocorrelation function γx(τAB) of the plane wave emitted by the
point source.
2. The time delay τAB that connects the baseline and the source position
appears in the value of γx(τAB).
3. The ratio of the periodic part of y(τAB) to its constant one is called the
complex fringe visibility. It is proportional to the autocorrelation function
of the plane wave.
4. The autocorrelation function γx(t) is maximal for t = 0. This means that
the fringe visibility is reduced when the delay τAB increases, this is due
to the limited coherence time of the radiation, related to its linewidth.
The autocorrelation function is linked to the spectral density of the line
(the Wiener–Khinchin theorem). If C(t) is the autocorrelation function
of a time function f(t) whose Fourier transform is F(ν), then C(t) is the
Fourier transform of the absolute square of F(ν), which is the spectral
density of f(t).
Consequently, the order of magnitude of the coherence time of the in-
coming wave is given by the inverse of its linewidth. This will ultimately
limit the resolution of the observation. For instance, a linewidth of 1 kHz
gives an upper limit of only 1.6 × 10−4 s for τAB, corresponding to
|AB • s| ≈5 km
and, for a baseline length of 5 000 km, to α = 1 × 10−3 rd.
In fact, since the signals are correlated in deferred time, it is possible to
shift one record until the time diﬀerence is canceled and the correlation
function is maximal. The shift gives the value of the time diﬀerence τAB.
5. The main part of the processing of the signals received by any array of
radio antennas is consequently the calculation of their correlation.
Although the signals received by diﬀerent antennas come from the same
source, the quantity computed is called the cross-correlation, taking into
www.ebook3000.com

182
9 Very Long Base Interferometry
account the fact that each signal may have been modiﬁed in a diﬀerent
and non-correlated way (atmospheric perturbations, additive noise of the
receiver, etc.). This calculation is made by a specialized data processing
system called the correlator.
Extended Source
If the radiation source is extended around the incoming direction e0, but is
incoherent (diﬀerent points of the source radiate independently), there is no
interference between the contribution of the diﬀerent points and their power
contributions are simply added.
The following model is limited to a one-dimensional source. It is easy to
extend the model to the real case of two-dimensional sources.
The position of each point of the source is characterized by the unit vec-
tors e (from the source) or s = −e (toward the source) or by the angle α
between the perpendicular to the baseline and s.
The sky brightness B(α) of the point in the direction α is proportional
to the square of the mean amplitude X0(α) of the incoming radiation from
that direction and the total brightness is Bt =
/
α B(α)dα.
The output yc of the correlator is the sum of the elementary cross-
correlation functions corresponding to all the points of the source,
yc =

α
γx(α, τα)dα
=

α
γX(α, τα) exp (j2πντα) dα .
(9.43)
The integral is to be taken over the radio source. Every point of the source
corresponds to a value of α,
α = α0 + δα
(9.44)
with
δα ≪1 ,
(9.45)
where α0 corresponds to an arbitrary reference point of the source, τα is the
value of τAB for the value α of the angle between the perpendicular to the
baseline, and s
τα = −D sin α
c
= −D sin α0
c
−D cos α0
c
δα ,
(9.46)
2πντα = −2π D
λ sin α0 −2π D
λ cos α0δα ,
(9.47)

9.1 Principle of VLBI
183
where λ is the wavelength of the radiation. γX(δα, τδα) is the correlation
function of the sky brightness in the direction α = α0 + δα. Consequently,
yc =

δα
γX(δα, τδα) exp

−j2π D sin α0
λ

× exp

−j2π D cos α0
λ
δα

d(δα) .
(9.48)
This expression shows that the output of the correlator is the Fourier trans-
form of the function of δα,
γX,α0(δα, τδα) = γX(δα, τδα) exp

−j2π D sin α0
λ

.
(9.49)
This function is closely related to the correlation function of the sky bright-
ness [117],
yc
D cos α0
λ

= Fα[γX,α0(α, τα)]
D cos α0
λ

.
(9.50)
The conclusions are the following:
1. The correlator gives the Fourier transform of the cross-correlation func-
tion of the amplitude X(α, tAB) of the signal emitted by the source. This
correlation function is calculated for the delay tAB between the two re-
ceivers.
2. The sky brightness can be calculated from this result if this Fourier trans-
form is known for diﬀerent sampled values of its parameter D cos α0
λ
, i.e.
for diﬀerent values of D, the distance between the two receivers involved
in the calculation of the Fourier transform and/or diﬀerent values of α0.
In the ﬁrst case, an array of receivers is used, in the second case, the
motion of the vector AB due to the rotation of the Earth is used.
Examples
In the following simple examples
1. α0 ≪1: cos α0 = 1 and sin α0 = 0.
Consequently, (9.48) simpliﬁes to
yc =

δα
γX(δα, τδα) × exp

−j2π D
λ δα

d(δα)
(9.51)
and the output of the correlator is the Fourier transform of the cross-
correlation function γX(δα, τδα).
2. The linewidth of the radiation emitted by the source is supposed to
be narrow enough so that the cross-correlation function γX(δα, τδα) is
(a monochromatic wave)
γX(δα, τδα) = X2
0(δα) .
(9.52)
www.ebook3000.com

184
9 Very Long Base Interferometry
The Rectangular Sky Brightness Function
The object is centered at −α0/2 ≪1 and its width is 2∆α,
X2
0(δα) =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
0

δα < −α0/2 −∆α
δα > −α0/2 + ∆α
,
X2
0 −α0/2 −∆α ≤δα ≤−α0/2 + ∆α .
(9.53)
The Fourier transform Fα[γX(α, τα)]
" D
λ
#
is
Y
D
λ

= 2X2
0δα exp

−j2π D
λ × −α0
2

sinc

2π D
λ δα

.
(9.54)
The complex fringe visibility Γ (D/λ) is
Γ
D
λ

= exp

−j2π D
λ × −α0
2

sinc

2π D
λ δα

.
(9.55)
The modulus of the complex visibility is consequently maximal for small
values of the ratio
δα
λ/D ,
i.e. for objects whose angular diameter is of the order of or smaller than λ/D;
VLBI is used to observe very compact sources.
A Pair of Rectangular Sky Brightness Functions
As a second example, consider a pair of rectangular sky brightness functions
centered at ±α0/2 and having width 2∆α,
X2
0(δα) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
0
⎧
⎪
⎪
⎨
⎪
⎪
⎩
δα < −α0/2 −∆α
−α0/2 + ∆α < δα < +α0/2 −∆α
δα > +α0/2 + ∆α
,
X2
0

−α0/2 −∆α ≤δα ≤−α0/2 + ∆α
+α0/2 −∆α ≤δα ≤+α0/2 + ∆α .
(9.56)
In this case, the Fourier transform Y2
" D
λ
#
of the sky brightness function is
Y2
D
λ

= 2X2
0δα sinc

2π D
λ δα

×

exp

−j2π D
λ × −α0
2

+ exp

−j2π D
λ × +α0
2

(9.57)
= 4X2
0δα sinc

2π D
λ δα

cos

2π D
λ × α0
2

.
(9.58)

9.1 Principle of VLBI
185
The complex fringe visibility Γ
" D
λ
#
is
Γ
D
λ

= sinc

2π D
λ δα

cos

2π D
λ × α0
2

.
(9.59)
The conclusions are the following:
1. As in the previous example, the modulus of the complex visibility is
maximal for small values of the ratio
δα
λ/D .
2. The modulus of the complex visibility is maximal for small values of the
quantity (2πDα0)/(2λ), i.e. for
λ
D < πα0 .
(9.60)
The resolution of the interferometer is consequently given by the ratio of
the distance between the two receivers to the wavelength of the radiation.
9.1.2 Processing of the Signals
The previous discussions show that processing the signal received by the
antennas allows one to
–
produce an image of an astronomical object (aperture synthesis);
–
precisely determine the relative position of the antennas if the emitting
object is distant and stable (geodesy);
–
precisely determine the position of a ground or space radio source if the
positions of the antennas are known;
–
determine the spectra of the radio emission.
Processing at Each Antenna
The data received by the antennas are processed in the following way before
being correlated (many steps of the process, such as ampliﬁcation, ﬁltering,
etc. are omitted in this schematic description).
1. They are down converted to a baseband signal by mixing them with
a local oscillator. The accuracy and stability of this local oscillator must
be consistent with the phase shifts to be measured.
Suppose we have an input signal
x(t) = X exp [j(2πνt + φ)
www.ebook3000.com

186
9 Very Long Base Interferometry
and a local oscillator
xLO = XLO exp [j(2πνLOt + φLO)] .
Mixing these two signals uses a non-linear operator, which produces out-
put components at various frequencies, the sum and diﬀerence of the
multiples of the frequencies ν and νLO. From these components, it is easy
to select, with a ﬁlter, the one whose frequency is νIF = ν −νOL (this fre-
quency is called the intermediate frequency) and whose phase is φ −φLO
(these relations apply in the case where νLO < ν). The baseband is cen-
tered on this frequency ν −νLO. The phase ﬂuctuations of the IF signal
are consequently the sum of that of the signal and of the local oscillator,
xIF = KXXLO exp j([2π(ν −νLO)t + φ −φLO] .
(9.61)
This is not a problem if all the signals of the interferometer are down
converted using the same local oscillator, since it is the phase diﬀer-
ence between them that is the pertinent information. On the contrary,
in the case of a VLBI, the signals from diﬀerent antennas are down con-
verted using a diﬀerent local oscillator, located in the same station as
the antenna; the phase of each local oscillator must consequently be very
precisely deﬁned.
2. The resulting signal is sampled and recorded in a digital media, along
with a precise timestamp.
3. The recorded data are then sent to the correlator to be further processed.
Delay Compensation
Due to the delay between the two antennas whose signal are to be correlated
and to the ﬁnite linewidth of the line being studied, the fringe visibility is
decreased (see Sect. 9.1.1). This can be compensated, since it is possible to
shift the two recorded data to optimize the value of their cross-correlation.
Digital Correlator
The correlator is the masterpiece of VLBI signal processing. Extensive de-
scriptions can be found, for instance, in [27, 107].
In the case of a digital processing, the cross-correlation of the discrete-
time process function of f(n) and g(n) is easily computed,
γ(n) = f ⋆g(n) =
∞

p=−∞
f ∗(p)g(n + p) .
(9.62)
A schematic block diagram of a cross-correlator is shown in Fig. 9.3. It uses
memory to implement delays of a multiple of the sampling time Ts, multipliers
and accumulators.
In fact, the summation does not extend from −∞to +∞and the output
of the device is an estimator of the cross-correlation.

9.2 Applications of VLBI
187
Fig. 9.3. Schematic block diagram of a cross-correlator
9.2 Applications of VLBI
It was shown in Sect. 9.1 that VLBI may have various applications in astron-
omy (position, spectra and imaging of astronomical objects) and in geodesy
(the relative position of the antennas, absolute position relative to reference
astronomical objects, rotation of the Earth).
9.2.1 Astronomy
VLBI was developed ﬁrst as a radio-astronomical tool and remains a pow-
erful and high resolution tool for observing radio sources. It allows sub-
milliarcsecond imaging [73, 60] and detection [118] of extragalactic objects.
9.2.2 Geodesy
In this kind of application, the astronomical sources are known and used as
references to determine some parameters of the Earth.
www.ebook3000.com

188
9 Very Long Base Interferometry
Rotation of the Earth
Very distant quasars provide an inertial reference frame that is much more
accurate than the fundamental catalog of ﬁx stars FK5 [126].
The antennas of a VLBI array are then in a situation that may be com-
pared to that of a diﬀerential GPS experiment; they receive the signal emitted
by the same source. Nevertheless, in the case of VLBI, the astronomic sources
appear as a point-source with no motion. There is consequently no need to
construct a model for their motion.
Since the radio telescopes are ﬁxed on the rotating Earth, VLBI measures
the orientation of the Earth in the inertial reference frame deﬁned by these
quasars as a function of time, monitoring the Earth rotation and orientation.
It is consequently possible to measure all the components of the Earth’s
rotation:
–
the position of the Earth’s spin axis in space,
–
the position of the Earth’s spin axis relative to the Earth crust, and
–
the velocity of the rotation, which allows one to connect the two time
scales UT and UTC (see Sect. 7.1).
This information allow one to perform orbit controls of satellites, including
GPS satellites (see, for instance [110, 95]).
Monitoring of Plate Potions
This application of VLBI, joined to the GPS technique, is well known. These
space geodetic techniques allow the direct measurements of plate motions.
Motions of a few cm per year are clearly visible (see, for instance [49, 7, 47]).
The results of these measurements are used in Earthquake research.
Precise Localization on the Earth
The precise measurement of the position of the VLBI and GPS stations allow
one to maintain the realization of the International Terrestrial Reference
System (see, for instance [59, 88]).

Part IV
Appendix
www.ebook3000.com

A Useful Integrals
The following results are taken from the Wolfram integrator.
http://integrals.wolfram.com/
A.1 Calculation of Variances

sin2(x)dx = x
2 −sin(2x)
4
,
(A.1)
 sin2(x)
x
dx = ln(x)
2
−Ci(2x)
2
,
(A.2)
 sin2(x)
x2
dx = cos(2x)
2x
+ Si(2x) −1
2x ,
(A.3)
 sin2(x)
x3
dx = cos(2x) −1
4x2
+ Ci(2x) −sin(2x)
2x
,
(A.4)
 sin2(x)
x4
dx = cos(2x) −1
6x3
−cos(2x)
3x
−sin(2x)
6x2
−2Si(2x)
3
,
(A.5)
where we have the sine integral Si(x)
Si(x) =
 x
0
sin(t)
t
dt ,
(A.6)
Si(∞) = π/2
(A.7)
and the cosine integral Ci(x)
Ci(x) = −
 ∞
x
cos(t)
t
dt
(A.8)
= γ + ln(x) +
 x
0
cos t −1
t
dt ,
(A.9)
Ci(∞) = 0 .
(A.10)

192
A Useful Integrals
For x ≪1, we have
Ci(x) ≈γ + ln(x) −x2
4
(A.11)
≈γ + ln(x) ,
(A.12)
where γ is the Euler–Mascheroni constant
γ = 0.577216 . . .
(A.13)
A.2 Calculation of Allan Variances
 sin4(x)
x2
dx = 4 cos(2x) −cos(4x) −3
8x
+ 2Si(2x) −Si(4x)
2x
,
(A.14)
 sin4(x)
x
dx = Ci(4x) −4Ci(2x) + 3 ln(x)
8
,
(A.15)

sin4(x)dx = 12x −8 sin(2x) + sin(4x)
32
,
(A.16)
 sin4(x)
x3
dx = 4 cos(2x) −cos(4x) −3
16x2
+ Ci(2x) −Ci(4x) + sin(4x) −2 sin(2x)
4x
,
(A.17)
 sin4(x)
x4
dx = 4(1 −2x2) cos(2x) + (8x2 −1) cos(4x) −3
24x3
+ sin(4x) −2 sin(2x)
12x2
+ 4Si(4x) −2Si(2x)
3
.
(A.18)
A.3 Calculation of Hadamard Variances
 sin2 (x)
x2
sin2(4x)
cos2(x) dx = 1
2x [12 cos(2x) −8 cos(4x)
+4 cos(6x) −cos(8x) −7]
+ 12Si(2x) −16Si(4x)
+ 12Si(6x) −4Si(8x) ,
(A.19)
 sin2 (x)
x2
sin2(6x)
cos2(x) dx = 1
2x [20 cos(2x) −16 cos(4x) + 12 cos(6x)
−8 cos(8x) + 4 cos(10x) −cos(12x) −11]
+ 20Si(2x) −32Si(4x) + 36Si(6x) −32Si(8x)
+ 20Si(10x) −6Si(12x) ,
(A.20)
www.ebook3000.com

A.3 Calculation of Hadamard Variances
193
 sin2 (x)
x
sin2(4x)
cos2(x) dx = 1
2 [7 ln(x) −12Ci(2x) + 8Ci(4x)
−4Ci(6x) + Ci(8x)] ;
(A.21)
 sin2 (x)
x
sin2(6x)
cos2(x) dx = 1
2 [11 ln(x) −20Ci(2x) + 16Ci(4x) −12Ci(6x)
+8Ci(8x) −4Ci(10x) + Ci(12x)] ,
(A.22)

sin2 (x) sin2(4x)
cos2(x) dx = 7
2x −3 sin(2x) + sin(4x)
−1
3 sin(6x) + 1
16 sin(8x) ,
(A.23)
 ∞
−∞
sin2 (x) sin2(6x)
cos2(x) dx = 11
2 x −5 sin(2x) + 2 sin(4x) −sin(6x)
+ 1
2 sin(8x) −1
5 sin(10x) + 1
24 sin(12x) , (A.24)
 sin2 (x)
x3
sin2(4x)
cos2(x) dx =
1
4x2 [12 cos(2x) −8 cos(4x) + 4 cos(6x)
−cos(8x) −7] + 12Ci(2x) −32Ci(4x)
+ 36Ci(6x) −16Ci(8x) + 2
x [−3 sin(2x)
+4 sin(4x) −3 sin(6x) + sin(8x)] ,
(A.25)
 sin2 (x)
x3
sin2(6x)
cos2(x) dx =
1
4x2 [20 cos(2x) −16 cos(4x) + 12 cos(6x)
−8 cos(8x) + 4 cos(10x) −cos(12x) −11]
+ 20Ci(2x) −64Ci(4x) + 108Ci(6x)
−128Ci(8x) + 100Ci(10x) −36Ci(12x)
+ 1
x [−10 sin(2x) + 16 sin(4x) −18 sin(6x)
+16 sin(8x) −10 sin(10x) + 3 sin(12x)] , (A.26)
 sin2 (x)
x4
sin2(4x)
cos2(x) dx =
1
6x3 [12 cos(2x) −8 cos(4x)
+ 4 cos(6x) −cos(8x) −7]
+ 1
3x [−12 cos(2x) + 32 cos(4x)
−36 cos(6x) + 16 cos(8x)]
+ 1
6 [−48Si(2x) + 256Si(4x)
−432Si(6x) + 256Si(8x)]
+
1
3x2 [−6 sin(2x) + 8 sin(4x)
−6 sin(6x) + 2 sin(8x)] ,
(A.27)

194
A Useful Integrals
 sin2 (x)
x4
sin2(6x)
cos2(x) dx =
1
6x3 [20 cos(2x) −16 cos(4x) + 12 cos(6x)
−8 cos(8x) + 4 cos(10x) −cos(12x) −11]
1
3x [−20 cos(2x) + 64 cos(4x) −108 cos(6x)
+128 cos(8x) −100 cos(10x) + 36 cos(12x)]
+ 1
6 [−80Si(2x) + 512Si(4x) −1 296Si(6x)
+2 048Si(8x) −2 000Si(10x) + 864Si(12x)]
+
1
3x2 [−10 sin(2x) + 16 sin(4x) −18 sin(6x)
+16 sin(8x) −10 sin(10x) + 3 sin(12x)] .
(A.28)
A.4 Calculation of the Three-samples Variance

sin(x)6dx = 5x
16 −15
64 sin(2x) + 3
64 sin(4x) −
1
192 sin(6x) ,
(A.29)
 sin(x)6
x
dx = 5
16 ln(x) −15
32Ci(2x) + 6
32Ci(4x) −1
32Ci(6x) ,
(A.30)
 sin(x)6
x2
dx =
1
32x [15 cos(2x) −6 cos(4x) + cos(6x) −10]
+ 1
16 [15Si(2x) −12Si(4x) + 3Si(6x)] ,
(A.31)
 sin(x)6
x3
dx =
1
64x2 [15 cos(2x) −6 cos(4x) + cos(6x) −10]
+ 1
32 [30Ci(2x) −48Ci(4x) + 18Ci(6x)]
+
1
32x [−15 sin(2x) + 12 sin(4x) −3 sin(6x)] ,
(A.32)
 sin(x)6
x4
dx =
1
96x3 [15 cos(2x) −6 cos(4x) + cos(6x) −10]
+
1
96x [−30 cos(2x) + 48 cos(4x) −18 cos(6x)]
+ 1
48 [−30Si(2x) + 96Si(4x) −54Si(6x)]
+
1
32x2 [−5 sin(2x) + 4 sin(4x) −sin(6x)] .
(A.33)
www.ebook3000.com

B Some Calculational Details
B.1 The Allan Filter
The Allan ﬁlter squared amplitude response is
|HAllan(ν)|2 = sin2 πνT .
(B.1)
Putting x = πνT = π/2 + δx, we have
|HAllan(ν)|2 = sin2 x
(B.2)
= cos2(δx) .
(B.3)
Its half width δν1/2 = δx1/2/(πT ) is given by
cos(δx1/2) =
1
√
2 ,
(B.4)
which gives
δx1/2 = π
4 ,
(B.5)
δν1/2 = 0.25 × νs .
(B.6)
B.2 The Hadamard Filter
The squared amplitude response is (see (6.217))
|HH(ν)|2 =
sin(2MπνT )
cos(πνT )
2
.
(B.7)
1/ |cos(πνT )| becomes very large when πνT is close to π/2 + kπ.
Putting x = πνT = π/2 + δx, we have
cos(x) = −sin(δx) ,
(B.8)
sin(2Mx) = sin(2Mπ/2 + 2Mδx)
= sin(Mπ) × cos(2Mδx) + cos(Mπ) × sin(2Mδx)
= (−1)M sin(2Mδx) .
(B.9)

196
B Some Calculational Details
Consequently,
sin(2Mx)
cos(x)
= (−1)M+1 sin(2Mδx)
sin(δx)
(B.10)
and
|HH(ν)|2 =
sin(2Mδx)
sin(δx)
2
.
(B.11)
For δx = 0 (ν = νs/2)
|HH(νs/2)|2 = 4M 2 .
(B.12)
This is the maximal value of the squared amplitude response of the Hadamard
ﬁlter. The half power width is given by
HH(ν1/2)
2 = 2M 2 ,
(B.13)

sin(2Mδx1/2)
sin(δx1/2)

2
= 2M 2 .
(B.14)
Limiting the series expansion of sin(2Mδx1/2) and sin(δx1/2) to the two ﬁrst
terms, we have
sin(2Mδx1/2) ≈2Mδx1/2

1 −(2Mδx1/2)2
6

,
(B.15)
sin(δx1/2) ≈δx1/2

1 −
δx2
1/2
6

(B.16)
and
HH(ν1/2)
2 ≈4M 2

6 −(2Mδx1/2)2
6 −δx2
1/2
2
.
(B.17)
Consequently, δx1/2 is given by

6 −(2Mδx1/2)2
6 −δx2
1/2
2
= 1
2
(B.18)
and
δx1/2 = ±
1.576
√
5.657M 2 −1
(B.19)
≈±0.664
M
.
(B.20)
www.ebook3000.com

B.4 Phase Noise Versus Frequency Noise Spectral Density
197
Consequently,
δν1/2 = 0.664
πM × νs
(B.21)
= 0.211
M
× νs .
(B.22)
This is an approximate value of the half width of the Hadamard ﬁlter.
B.3 Three-samples Filter
Equation (6.261) with M = 1 gives for its squared amplitude response
|H3|2 =

1 −cos[3πνT ]
cos(πνT )
2
.
(B.23)
Putting x = πνT = π/2 + δx, we have
cos(x) = −sin(δx) ,
(B.24)
cos(3x) = sin(3δx) .
(B.25)
Consequently,
|H3|2 =

1 + sin[3δx]
sin(δx)
2
(B.26)
= 16 cos4(δx) .
(B.27)
The half-width δx1/2 of this ﬁlter is given by
cos4(δx1/2) = 1
2 ,
(B.28)
which gives
δx1/2 = ±0.572rad ,
(B.29)
δν1/2 = ±0.572
π
× νs
(B.30)
= 0.182 × νs .
(B.31)
B.4 Phase Noise Versus
Frequency Noise Spectral Density
Let the random processes x(t) and y(t) be deﬁned by
x(t) = δφ(t)
f0
,
(B.32)
y(t) = δf(t)
f0
(B.33)
= dx(t)
dt
.
(B.34)

198
B Some Calculational Details
The Fourier transforms are
X(ν) =
 +∞
−∞
x(t) exp(−2πjνt)dt ,
(B.35)
Y (ν) =
 +∞
−∞
y(t) exp(−2πjνt)dt
(B.36)
and inversely
x(t) =
 +∞
−∞
X(ν) exp(+2πjνt)dν ,
(B.37)
y(x) =
 +∞
−∞
Y (ν) exp(+2πjνt)dν .
(B.38)
Consequently,
Y (ν) =
 +∞
−∞
dx(t)
dt
exp(−2jπνt)dt
(B.39)
=
 +∞
−∞
d
dt
 +∞
−∞
X(f) exp(+2πjft)df

exp(−2πjνt)dt
(B.40)
=
 +∞
−∞
 +∞
−∞
X(f) d
dt [exp(+2πjft)] df exp(−2πjνt)dt
(B.41)
=
 +∞
−∞
 +∞
−∞
X(f)2πjf [exp(+2πjft)] df exp(−2πjνt)dt
(B.42)
=
 +∞
−∞
 +∞
−∞
X(f)2πjf × exp [+2πj(f −ν)t] df dt .
(B.43)
Since
 +∞
−∞
exp [−2πj(ν −f)t] dt = δ(ν −f) ,
(B.44)
we have
Y (ν) =
 +∞
−∞
X(f)2πjf × δ(ν −f) × df
(B.45)
= 2πjνX(ν) .
(B.46)
B.5 Phase Noise
The phase noise of an oscillator is frequently characterized by its value
expressed in dBc as deﬁned by the ATIS Telecom Glossary 2000 T1.523–
2001 [5]: Phase noise, L(f) in decibels relative to carrier power (dBc) on
a 1-Hz bandwidth, is given by L(f) = 10 log[0.5(Sφ(f))] where Sφ(f) is the
spectral density of phase ﬂuctuations.
www.ebook3000.com

B.6 Sampling and Hold
199
B.6 Sampling and Hold
The continuous-time function f(t) is sampled and held at times nTl. The out-
put of the sample and hold is another continuous-time function f ′(t) whose
Fourier transform F ′(ν) is related to the Fourier transform F(ν) of the func-
tion f(t).
We have
F ′(ν) =
 ∞
−∞
f ′(t) × exp(−j2πνt)dt .
(B.47)
The continuous-time function f ′(t) can be written as
f ′(t) =
∞

n=−∞
f(nTl) × Π(t −nTl) .
(B.48)
In this expression, Π(x) is a square x-function deﬁned by
Π(x) =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
0
x < 0, x > T ,
0.5 x = 0, x > T ,
1
0 < x < T .
(B.49)
The Fourier transform of f ′(t) is
F ′(ν) =
 ∞
n=−∞
∞

−∞
f(nTl) × Π(t −nTl) × exp(−j2πνt)dt
=
∞

n=−∞
f(nTl)
 ∞
−∞
Π(t −nTl) × exp(−j2πνt)dt .
(B.50)
However,
 ∞
−∞
Π(t −nTl) × exp(−j2πνt)dt
(B.51)
=
 (n+1)Tl
nTl
exp(−j2πνt)dt
(B.52)
= −
1
j2πν {exp [−j2πν(n + 1)Tl] −exp [−j2πνnTl]}
(B.53)
= exp [−j2πν(n + 1/2)Tl] × Tl × sinc(πνTl) .
(B.54)
Consequently,
F ′(ν) = Tl × exp(−jπνTl) × sinc(πνTl)
×
∞

n=−∞
f(nTl) exp(−j2πνnTl)
(B.55)
= Tl × exp(−j2πν(n + 1/2)Tl) × sinc(πνTl) × Fs(ν) ,
(B.56)

200
B Some Calculational Details
where Fs(ν) is the Fourier transform of the sequence {f(nTl)},
Fs(ν) =
∞

n=−∞
f(nTl) exp(−j2πνnTl)dt .
(B.57)
On the other hand, Fs(ν) is related to the Fourier transform of the continuous-
time function f(t) (Nyquist–Shannon sampling theorem). Since
f(t) =
 ∞
−∞
F(ν) exp(+j2πνt)dν ,
(B.58)
the samples f(nTl) can be expressed as
f(nTl) =
 ∞
−∞
F(ν) exp(+j2πνnTl)dν
(B.59)
=
∞

k=−∞
 (k+1/2)/Tl
(k−1/2)/Tl
F(ν) exp(+j2πνnTl)dν
(B.60)
=
 1/2Tl
−1/2Tl

∞

k=−∞
F(ν′ + k/Tl)

exp(+j2πν′Tl)dν′ ,
(B.61)
with ν′ = ν −k/Tl.
Consequently, the two Fourier transforms F(ν) and Fs(ν) are connected
by the relation
Fs(ν) = 1
Tl
∞

k=−∞
F(ν + k/Tl) .
(B.62)
Moreover, the Fourier transform F ′(ν) of the sampled and held continuous-
time signal is connected to the Fourier transform F(ν) of the original
continuous-time signal by the relation
F ′(ν) = exp(−jπνTl) × sinc(πνTl) ×
∞

k=−∞
F(ν + k/Tl) .
(B.63)
B.7 Algorithm for a GPS Receiver
B.7.1 The Data
Estimate of the Position
An estimate of the position of the receiver is known. It is, for instance, the
last position computed by the receiver, or an estimate entered by the user.
The coordinates of this estimated position are Xe, Ye and Ze, while the
unknown coordinates of the receiver position are X, Y and Z.
www.ebook3000.com

B.7 Algorithm for a GPS Receiver
201
Estimate of the Local Time
An estimate te of the time is given by the receiver clock. The time error δt
must be calculated and Xe, Ye and Ze must be corrected.
Position of the Four Satellites
The position of each of the four satellites used by the receiver is known due to
the navigation messages. Each satellite position is given by the coordinates
Xi, Yi and Zi of the satellite number i (1 ≤i ≤4).
Distances to the Four Satellites
The time delay between the C/A-code of the receiver and the received C/A-
codes – corrected for the ionospheric and tropospheric delays, the relativistic
eﬀects and the satellite clocks error – gives the pseudo-range CRi (1 ≤i ≤4)
between the receiver and each of the satellites. The ambiguity of an integer
multiple of 300 km has been raised.
The distances
ERi =

(Xi −Xe)2 + (Yi −Ye)2 + (Zi −Ze)2
between the estimated position and the four satellites are known.
B.7.2 Algorithm
The four pseudo-ranges are the distance between the receiver and the corre-
sponding satellite modiﬁed by the time error of the receiver clock.
Let δt be that time error such that
te = t + δt ,
(B.64)
where t is the GPS time.
The pseudo-ranges are, therefore,
CRi =

(Xi −X)2 + (Yi −Y )2 + (Zi −Z)2 −cδt ,
(B.65)
where c is the light velocity.
The coordinates of the receiver can be expressed from the estimated po-
sition coordinates
⎧
⎪
⎪
⎨
⎪
⎪
⎩
X = Xe + δX ,
Y = Ye + δY ,
Z = Ze + δZ .
(B.66)

202
B Some Calculational Details
Consequently, the pseudo-ranges are
CRi =
'
(Xi −X)2 + (Yi −Y )2 + (Zi −Z)2(1/2 −cδt
= ERi
+ ∂CRi
∂X

X=Xe
δX + ∂CRi
∂Y

Y =Ye
δY + ∂CRi
∂Z

Z=Ze
δZ
−cδt .
(B.67)
However,
∂CRi
∂X

X=Xe
= Xe −Xi
ERi
,
(B.68)
∂CRi
∂Y

Y =Ye
= Ye −Xi
ERi
,
(B.69)
∂CRi
∂Z

Z=Ze
= Ze −Xi
ERi
.
(B.70)
The following system of linear algebraic equations can then be written
⎛
⎜
⎜
⎜
⎜
⎝
Xe−X1
ER1
Ye−X1
ER1
Ze−X1
ER1
−1
Xe−X2
ER2
Ye−X2
ER2
Ze−X2
ER2
−1
Xe−X3
ER3
Ye−X3
ER3
Ze−X3
ER3
−1
Xe−X4
ER4
Ye−X4
ER4
Ze−X4
ER4
−1
⎞
⎟
⎟
⎟
⎟
⎠
×
⎛
⎜
⎜
⎜
⎜
⎝
δX
δY
δZ
cδt
⎞
⎟
⎟
⎟
⎟
⎠
=
⎛
⎜
⎜
⎜
⎜
⎝
CR1 −ER1
CR2 −ER2
CR3 −ER3
CR4 −ER4
⎞
⎟
⎟
⎟
⎟
⎠
,
(B.71)
or
A × δM = δR .
(B.72)
If the matrix A is non-singular (if the determinant |A| ̸= 0), the system has
a unique solution in the four variables.
Cramer’s rule gives
Mk = |Ak|
|A|
(B.73)
with
|A| =

Xe−X1
ER1
Ye−X1
ER1
Ze−X1
ER1
−1
Xe−X2
ER2
Ye−X2
ER2
Ze−X2
ER2
−1
Xe−X3
ER3
Ye−X3
ER3
Ze−X3
ER3
−1
Xe−X4
ER4
Ye−X4
ER4
Ze−X4
ER4
−1

,
(B.74)
www.ebook3000.com

B.7 Algorithm for a GPS Receiver
203
|A1| =

CR1 −ER1 Ye−X1
ER1
Ze−X1
ER1
−1
CR2 −ER2 Ye−X2
ER2
Ze−X2
ER2
−1
CR3 −ER3 Ye−X3
ER3
Ze−X3
ER3
−1
CR4 −ER4 Ye−X4
ER4
Ze−X4
ER4
−1

,
(B.75)
|A2| =

Xe−X1
ER1
CR1 −ER1
Ze−X1
ER1
−1
Xe−X2
ER2
CR2 −ER2 Ze−X2
ER2
−1
Xe−X3
ER3
CR3 −ER3 Ze−X3
ER3
−1
Xe−X4
ER4
CR4 −ER4 Ze−X4
ER4
−1

,
(B.76)
|A3| =

Xe−X1
ER1
Ye−X1
ER1
CR1 −ER1 −1
Xe−X2
ER2
Ye−X2
ER2
CR2 −ER2 −1
Xe−X3
ER3
Ye−X3
ER3
CR3 −ER3 −1
Xe−X4
ER4
Ye−X4
ER4
CR4 −ER4 −1

,
(B.77)
|A4| =

Xe−X1
ER1
Ye−X1
ER1
Ze−X1
ER1
CR1 −ER1
Xe−X2
ER2
Ye−X2
ER2
Ze−X2
ER2
CR2 −ER2
Xe−X3
ER3
Ye−X3
ER3
Ze−X3
ER3
CR3 −ER3
Xe−X4
ER4
Ye−X4
ER4
Ze−X4
ER4
CR4 −ER4

.
(B.78)

References
1. International Conference held at Washington for the purpose of ﬁxing a prime
meridian and a universal day. October 1884. Protocols of the Proceedings.
Gibson Bros., October 1884.
2. Agilent. Agilent 5071A Primary Frequency Standard Unsurpassed Stability in
the Lab or Field Product Overview. Agilent Technologies.
3. D.W. Allan, D.D. Davis, M. Weiss, A. Clements, B. Guinot, M. Granveaud,
K. Dorenwendt, B. Fischer, P. Hetzel, S. Aoki, M.-K. Fujimoto, L. Charron,
N. Ashby. Accuracy of international time and frequency comparison via global
positioning system satellites in common-view. IEEE Transactions on Instru-
mentation and Measurement, IM–34, June 1985.
4. D.W. Allan. Statistics of Atomic Frequency Standards. In: Proc. IEEE, vol-
ume 54, p. 221, 1966.
5. Alliance for Telecommunications Industry Solutions. ATIS Telecom Glossary
2000 t1.523-2001. http://www.atis.org/.
6. M. Arditi, T.R. Carver. Pressure, light, and temperature shifts in optical de-
tection of 0–0 hyperﬁne resonance of alkali metals. Physical Review, 124:800–
809, 1961.
7. D.F. Argus, W.R. Peltier. Postglacial rebound from space geodesy. AGU Fall
Meeting Abstracts, pp. A18+, December 2005.
8. N. Ashby, D.W. Allan. Practical implications of relativity for a global coordi-
nate time scale. Radio Science, 14:649–669, August 1979.
9. C. Audoin, G. Santarelli, A. Makdissi, A. Clairon. Properties of an oscillator
slaved to a periodically interrogated atomic resonator. IEEE Transactions on
Ultrasonics, Ferroelectrics and Frequency Control, 45(4), 1998.
10. A. Bauch, J. Achkar, S. Bize, D. Calonico, R. Dach, R. Hlavac, L. Lorini,
T.E. Parker, G. Petit, D. Piester, K. Szymaniec, P. Uhrich. Comparison be-
tween frequency standards in Europe and the USA at the 10−15 uncertainty
level. Metrologia, 43:109–120, February 2006.
11. A. Bauch, R. Schroder, S. Weyers. Discussion of the uncertainty budget and
of long term comparison of PTB’s primary frequency standards CS1, CS2 and
CSF1. In: Proceedings of the 2003 IEEE FCS and the 17th EFTF (Tampa,
USA), pp. 191–198, May 2003.
12. R.A. Baugh. Frequency modulation analysis with the Hadamard variance.
Proc. Annual. Symposium on Frequency Control, pp. 222–225, 1971.
13. C.W. Beer, R.A. Bernheim. Hyperﬁne pressure shift of 133Cs atoms in noble
and molecular buﬀer gases. Physical Review A, 13:1052–1057, 1976.
14. S. Bize, P. Laurent, M. Abgrall, H. Mariona, I. Maksimovica, L. Cacciapuoti,
J. Grünert, C. Viana, F. Pereira dos Santos, P. Rosenbuscha, P. Lemonde,
www.ebook3000.com

206
References
G. Santarelli, P. Wolf, A. Clairon, A. Luitenb, M. Tobar, C. Salomon. Ad-
vances in atomic fountains. C.R. Physique, 5, 2004.
15. F. Bloch, A. Siegert. Magnetic resonance for nonrotating ﬁelds. Physical Re-
view, 57:522–527, 1940.
16. E. Boileau, B. Picinbono. Statistical study of phase ﬂuctuations and oscilla-
tor stability. IEEE Transactions on Instrumentation and Measurement, IM-
25(1):66–75, March 1976.
17. Bureau International des Poids et Mesures.
ftp://ftp2.bipm.fr/pub/tai/data/PFS_reports/.
18. Bureau International des Poids et Mesures. Acronyms and locations of the
timing centres which maintain a local approximation of UTC, UTC(k), and/or
an independent local time scale, TA(k).
ftp://62.161.69.5/pub/tai/publication/acronyms.pdf.
19. Bureau International des Poids et Mesures. The International System of Units
(SI) 7th edition. Organisation Intergouvernementale de la Convention du
Mètre, 1998.
20. Bureau International des Poids et Mesures. The International System of Units
– Supplement 2000: Addenda and Corrigenda to the 7th Edition (1998). Or-
ganisation Intergouvernementale de la Convention du Mètre, 2000.
21. Bureau International des Poids et Mesures. Rapport du directeur sur l’activité
et la gestion du Bureau International des Poids et Mesures. Technical report,
Bureau International des Poids et Mesures, 2004.
22. Bureau International des Poids et Mesures. Circular T 217. Technical report,
Bureau International des Poids et Mesures, February 2006.
23. Bureau International des Poids et Mesures. Circular T 219. Technical report,
Bureau International des Poids et Mesures, April 2006.
24. Bureau International des Poids et Mesures. Fractional frequency of EAL from
primary frequency standards. Technical report, Bureau International des Poids
et Mesures, January 2006.
25. Bureau International des Poids et Mesures. Weights of clocks participating in
the computation of TAI. Technical report, Bureau International des Poids et
Mesures, February 2006.
26. B.F. Burke, F. Graham-Smith. An Introduction to Radio Astronomy. Cam-
bridge University Press, 2002.
27. B.R. Carlson, P.E. Dewdney, T.A. Burgess, R.V. Casorso, W.T. Petrachenko,
W.H. Cannon. The S2 VLBI correlator: A correlator for space VLBI and
geodetic signal processing. The Publications of the Astronomical Society of
the Paciﬁc, 111:1025–1047, August 1999.
28. T. Celano, J. Warriner, S. Francis, A. Giﬀord, P. Howe, R. Beckman. Two-
way time transfer to airborne platforms using commercial satellite modems.
In: Proceedings of the 34th Annual Precise Time and Time Interval (PTTI)
Meeting, December 2002.
29. A. Clairon, S. Ghezali, G. Santelli, Ph. Laurent, S.N. Lea, M. Bahoura, E. Si-
mon, S. Weyers, K. Szymaniec. Preliminary accuracy evaluation of a cesium
fountain frequency standard. In: Proc. of 5th Symposium on Frequency Stan-
dards and Metrology, Singapore. World Scientiﬁc.
30. A. Clairon, P. Laurent, G. Santarelli, S. Ghezali, S.N. Lea, M. Bahoura. A ce-
sium fountain frequency standard: Preliminary results. IEEE Transactions on
Instrumentation and Measurement, 44, 1995.

References
207
31. D.S. Coco, C. Coker, S.R. Dahlke, J.R. Clynch. Variability of GPS satellite
diﬀerential group delay biases. IEEE Transactions on Aerospace Electronic
Systems, 27:931–938, November 1991.
32. Comité Consultatif pour la Déﬁnition de la Seconde (CCDS). Recommenda-
tion S15. In: Procès-Verbaux des Séances du Comité International des Poids
et Mesures, 38 (1970), volume 9, 1980.
33. Comité International des Poids et Mesures (CGPM). Recommendation S2. In:
Procès-Verbaux des Séances du Comité International des Poids et Mesures, 38
(1970), volume 38, 1970.
34. E.U. Condon, G.H. Shortley. The Theory of Atomic Spectra. Cambridge Uni-
versity Press, 1935.
35. Conférence Générale des Poids et Mesures (CGPM). Resolution 1: Si unit of
time (second). In: Comptes rendus of the 13th CGPM, 1967–1968.
36. Coordinational Scientiﬁc Information Center. General glonass.
http://www.glonass-center.ru/.
37. C.C. Costain, J.S. Boulanger, H. Daams, D.W. Hanson, R.E. Beehler, A.J.
Clements, D.D. Davis, W.J. Klepczynski, L. Veenstra, J. Kaiser, B. Guinot,
P. Azoubib, J. Parcelier, G. Freon, M. Brunet. Two-way time transfer via
geostationary satellites NRC/NBS, NCR/USNO and NBS/USNO via Hermes
and NRC/LPTF (France) via Symphonie. In: Proceedings of the 1978 Annual
Precise Time and Time Interval (PTTI) Meeting, November 1978.
38. L.S. Cutler, C.A. Flory, R.P. Giﬀard, A. De Marchi. Erratum: Frequency
pulling by hyperﬁne sigma-transitions in cesium beam atomic frequency stan-
dards [J. Appl. Phys. 69, 2780 (1991)]. Journal of Applied Physics, 70, August
1991.
39. L.S. Cutler, C.A. Flory, R.P. Giﬀard, A. De Marchi. Frequency pulling by hy-
perﬁne sigma transitions in cesium beam atomic frequency standards. Journal
of Applied Physics, 69:2780–2792, March 1991.
40. E. de Clercq. L’étalon primaire de fréquence à jet de césium du BNM-SYRTE.
Bulletin du BNM, 2004-2(125):5–21, 2004.
41. C. Degenhardt, H. Stoehr, C. Lisdat, G. Wilpers, H. Schnatz, B. Lipphardt,
T. Nazarova, P.-E. Pottie, U. Sterr, J. Helmcke, F. Riehle. Calcium optical
frequency standard with ultracold atoms: Approaching 10−15 relative uncer-
tainty. Physical Review A, 72(6):062111, 2005.
42. G.J. Dick. Local oscillator induces instabilities in trapped ion frequency stan-
dards. In: Proccedings of the 19th Precise Time and Time Interval (PTTI)
Meeting, 1987.
43. efunda. efunda engineering fundamentals.
http://www.efunda.com/.
44. Albert Einstein. Die grundlage der allgemeinen relativitätstheorie. Annalen
der Physik, 49, 1916.
45. C.R. Ekstrom, W.M. Golding, R.E. Drullinger, F.L. Walls, A. DeMarchi, S.L.
Rolston, W. Phillips. The Design of an Atomic Fountain Frequency Standard
Prototype at NIST. In: Proc. 1995 Frequency Standard Metrology Symposium,
pp. 411–412, October 1995.
46. L. Essen, J.V.L. Parry. Atomic standard of frequency and time interval. Na-
ture, 176, 1955.
47. A.M. Finkelstein, A.V. Ipatov, Z.M. Malkin, E.A. Skurikhina, S.G. Smolent-
sev. Results of the ﬁrst two years of VLBI observations at the Svetloe Ob-
www.ebook3000.com

208
References
servatory within the framework of international geodynamical programs. As-
tronomy Letters, 32:138–144, February 2006.
48. P. Forman. Atomichron: The atomic clock from concept to commercial prod-
uct.
http://www.ieee-uﬀc.org/freqcontrol/atomichron/automichron.htm.
49. Y. Fukuzaki, K. Shibuya, K. Doi, T. Ozawa, A. Nothnagel, T. Jike, S. Iwano,
D.L. Jauncey, G.D. Nicolson, P.M. McCulloch. Results of the VLBI experi-
ments conducted with Syowa Station, Antarctica. Journal of Geodesy, 79:379–
388, August 2005.
50. V. Gerginov, S. Knappe, P. Schwindt, V. Shah, L. Hollberg, J. Kitching. Long-
term frequency instability of atomic frequency references based on coherent
population trapping and microfabricated vapor cells. Journal of the Optical
Society of America B, 23(4), April 2006.
51. W. Gerlach, O. Stern. Uber die richtungsquantelung im magnetfeld. Annalen
der Physik, IV, 1924.
52. H.M. Goldenberg, D. Kleppner, N.F. Ramsey. Atomic hydrogen maser.
Physics Review Letters, 5, 1960.
53. C. Hackman, J. Levine, T.E. Parker, D. Piester, J. Becker. A new technique
for estimating frequency from GPS carrier-phase time transfer data. In: 2004
IEEE International Ultrasonics, Ferroelectrics, and Frequency Control Joint
50th Anniversary Conference, August 2004.
54. D.W. Hanson. Fundamentals of two-way time transfer by satellite. In: Proc.
1989 IEEE Freq. Cont. Symp., May 1989.
55. A. Hasegawa, K. Fukuda, M. Kajita, H. Ito, M. Kumagai, M. Hosokawa,
N. Kotake, T. Morikawa. Accuracy evaluation of optically pumped primary
frequency standard CRL-O1. Metrologia, 41:257–263, May 2004.
56. T.P. Heavner, S.R. Jeﬀerts, E.A. Donley, T.E. Parker, F. Levi. A new mi-
crowave synthesis chain for the primary frequency standard NIST-F1. In: Proc.
2005 Joint Mtg. IEEE Intl. Freq. Cont. Symp. and PTTI, volume 57, pp. 308–
311, August 2005.
57. T.P. Heavner, S.R. Jeﬀerts, E.A. Donley, J.H. Shirley, T.E. Parker. NIST-F1:
Recent improvements and accuracy evaluations. Metrologia, 42:411–422, 2005.
58. T.P. Heavner, S.R. Jeﬀerts, E.A. Donley, J.H. Shirley, T.E. Parker. Recent
improvements in NIST-F1 and a resulting accuracy of δf/f = 0.61 × 10−15.
IEEE Transactions on Instrumentation and Measurement, 54(2):842–845,
April 2005.
59. J. Henton, M. Craymer, J. Liard, R. Duval, C. Klatt. Integration of the Cana-
dian gravity standardization network with the Canadian spatial reference sys-
tem: Challenges and opportunities. AGU Fall Meeting Abstracts, pp. B362+,
December 2005.
60. I.M. Hoﬀman, W.M. Goss, P. Palmer. VLBA+Y27 images of the formaldehyde
masers in NGC 7538 and G29.96-0.02. In: J. Romney, M. Reid (eds.), ASP
Conf. Ser. 340: Future Directions in High Resolution Astronomy, pp. 347–+,
November 2005.
61. T. Hong, C. Cramer, W. Nagourney, N. Fortson. Prospects for an Optical
Frequency Standard in Atomic Yb. APS Meeting Abstracts, pp. J1086+, May
2004.
62. D.A. Howe, D.W. Hanson, J.L. Jespersen, M.A. Lombardi. Satellite two-way
time transfer: Fundamentals and recent progress. In: Procedings of the 1989
Precise Time and Time Interval (PTTI) Meeting, December 1989.

References
209
63. Information Technology Laboratory. Engineering statistics handbook.
http://www.itl.nist.gov/div898/handbook/index.htm.
64. Information Technology Laboratory. Statistical methods of uncertainty anal-
ysis.
http://www.itl.nist.gov/div898/carroll/u.htm.
65. International Astronomical Union. Recommendation resolution B 1.8. In: Pro-
ceedings of the 24th General Assembly, Manchester 2000, volume XXIV B,
2001.
66. J. Terrien. News from the International Bureau of Weights and Measures.
Metrologia, 4(1):41–45, 1968.
67. J. Terrien. News from the Bureau International des Poids et Mesures. Metrolo-
gia, 7(1):43–44, 1971.
68. N. Jakowski, R. Leitinger, L. Ciraolo. Behaviour of large scale structures of
the electron content as a key parameter for range errors in GNSS applications.
Annals of Geophysics, supplement to vol 47(2/3):1031–1047, 2004.
69. S.R. Jeﬀerts, D.M. Meekhof, L. Hollberg, R.E. Drullinger, W.D. Lee, F.L.
Walls, C.W. Nelson, F. Levi, T.E. Parker. NIST Cesium fountain frequency
standard: Preliminary Results. In: Proc. 1998 IEEE Intl. Freq. Cont. Symp.,
pp. 2–5, May 1998.
70. M.A. Kasevich, E. Riis, S. Chu, R.G. Devoe. RF spectroscopy in an atomic
fountain. Physical Review Letters, 63:612–615, 1989.
71. D. Kleppner, H.M. Goldenberg, N.F. Ramsey. Theory of the hydrogen maser.
Physics Review, 126, 1962.
72. S. Knappe, V. Shah, P. Schwindt, L. Hollberg, J. Kitching. A microfabricated
atomic clock. Applied Physics Letters, 85(9), August 2004.
73. Y.Y. Kovalev, K.I. Kellermann, M.L. Lister, D.C. Homan, R.C. Vermeulen,
M.H. Cohen, E. Ros, M. Kadler, A.P. Lobanov, J.A. Zensus, N.S. Karda-
shev, L.I. Gurvits, M.F. Aller, and H.D. Aller. Sub-milliarcsecond imaging of
quasars and active galactic nuclei. IV. Fine-scale structure. The Astronomical
Journal, 130:2473–2505, December 2005.
74. T. Kurosu, Y. Fukuyama, Y. Koga, K. Abe. Preliminary evaluation of the Cs
atomic fountain frequency standard at NMIJ/AIST. IEEE Transactions on
Instrumentation and Measurement, 53(2):466–471, April 2004.
75. K. Larson, J. Levine. Time transfer using the phase of the GPS carrier. IEEE
Transactions on Ultrasonics, Ferroelectrics and Frequency Control, 45(3), May
1998.
76. K. Larson, J. Levine. Carrier-phase time transfer. IEEE Transactions on Ul-
trasonics, Ferroelectrics and Frequency Control, 46(4), July 1999.
77. W.L. Lawrence. Atom time piece displayed here. New York Times, October 4
1956.
78. H.S. Lee, T.Y. Kwon, H.S. Kang, Y.H. Park, C.H. Oh, S.E. Park, H. Cho,
V.G. Minogin. Comparison of the Rabi and Ramsey pulling in an optically
pumped caesium-beam standard. Metrologia, 40:224–231, October 2003.
79. P. Lesage, C. Audoin. Characterization of frequency stability: Uncertainty due
to the ﬁnite number of measurements. IEEE Transactions on Instrumentation
and Measurement, 22(2), 1973.
80. P. Lesage, C. Audoin. Estimation of the two-sample variance with a limited
number of data. In: 31st Annual Symposium on Frequency Control, 1977, 1977.
81. P. Lesage, C. Audoin. Characterization and measurement of time and fre-
quency stability. Radio Science, 14(4):521–539, July–August 1979.
www.ebook3000.com

210
References
82. P.D. Lett, W.D. Phillips, S.L. Rolston, C.E. Tanner, R.N. Watts, C.I.
Westbrook. Optical molasses. Optical Society of America Journal B Optical
Physics, 6:2084–2107, 1989.
83. F. Levi, L. Lorini, D. Calonico, A. Godone. Systematic shift uncertainty eval-
uation of IEN CSF1 primary frequency standard. IEEE Transactions on In-
strumentation and Measurement, 52(2):267–271, April 2003.
84. L. Lo Presti, D. Rovera, A. De Marchi. A simple analysis of the Dick eﬀect
in terms of phase noise spectral densities. IEEE Transactions on Ultrasonics,
Ferroelectrics and Frequency Control, 45(4), 1998.
85. M.A. Lombardi, L.M. Nelson, A.N. Novick, V.S. Zhang. Time and frequency
measurements using global positioning system. Cal. Lab. Int. J. Metrology,
IM-34, July–September 2001.
86. H. Lyons. The atomic clock. Instruments, 22, 1949.
87. H. Lyons. The atomic clock. American Scholar, 19, April 1950.
88. C. Ma, D.S. MacMillan. The role of VLBI in the TRF. AGU Fall Meeting
Abstracts, pp. A3+, December 2005.
89. E. Majorana. Atomi orientati in campo magnetico variabile. Nuovo Cimento,
9:43–50, 1932.
90. A. Makdissi, E. de Clercq. Evaluation of the accuracy of the optically
pumped caesium beam primary frequency standard of BNM-LPTF. Metrolo-
gia, 38:409–425, 2001.
91. A. Makdissi, E de Clercq. Evaluation of the accuracy of the optically
pumped caesium beam primary frequency standard of BNM-LPTF. Metrolo-
gia, 38:409–425, October 2001.
92. A.G. Mann, C. Sheng, A.N. Luiten. Cryogenic sapphire oscilator with excep-
tionally high frequency stability. IEEE Transactions on Instrumentation and
Measurement, 50(2), April 2001.
93. A.A. Michelson, F.G. Pease. Measurement of the diameter of alpha Orionis
with the interferometer. Astrophysical Journal, 53:249–259, May 1921.
94. P.J. Mohr, B.N. Taylor. CODATA recommended values of the fundamental
physical constants. Reviews of Modern Physics, 77:1–107, 2002.
95. J. Nastula, B. Kolaczek, R. Weber, J. Boehm, H. Schuh. High resolution Earth
rotation parameters determined during the CONT02 campaign. In: N.R. Van-
denberg, K.D. Baver (eds.) International VLBI Service for Geodesy and As-
trometry 2004 General Meeting Proceedings, 2004.
96. NIST. Time and Frequency from A to Z.
http://tf.nist.gov/general/glossary.htm.
97. C. Oates, E.A. Curtis, G. Wilpers, C. Hoyt, L. Hollberg, A. Ludlow. A Ca
optical frequency standard based on colder atoms. APS Meeting Abstracts,
pp. B4005+, May 2003.
98. Oscilloquartz S.A. OCXO 8600 10 times better than any other VCXO. Oscil-
loquartz S.A.
99. W.H. Oskay, T. Rosenband, U. Tanaka, C.E. Tanner, S.A. Diddams, L. Holl-
berg, W.M. Itano, J.C. Bergquist. The mercury ion optical clock. APS Meeting
Abstracts, pp. J1050+, May 2004.
100. P. Giacomo. News from the BIPM. Metrologia, 17(1):69, 1981.
101. T.E. Parker, S.R. Jeﬀerts, T.P. Heavner, E.A. Donley. Operation of the NIST-
F1 cesium fountain primary frequency standard with a maser ensemble, in-
cluding the impact of frequency transfer noise. Metrologia, 42:423–430, 2005.

References
211
102. T.E. Parker, V. Zhang. Sources of instabilities in two-way satellite time trans-
fer. In: Proceedings of the 2005 Joint Meeting. IEEE International Frequency
Control Symposium and PTTI, August 2005.
103. M.A. Pavlis, N.K. Weiss. The relativistic redshift with 3 × 10−17 uncertainty
at NIST, Boulder, Colorado, USA. Metrologia, 40(2):66–73, 2003.
104. W.D. Phillips. Laser cooling and trapping of neutral atoms. NASA STI/Recon
Technical Report N, 82:14512–+, 1981.
105. Precise Time and Frequency, Inc. CH1-75 Active Hydrogen Maser.
See for instance http://www.ptﬁnc.com/images/CH1-75%20Intro.pdf.
106. T.J. Quinn. Base units of the système international d’unités, their accuracy,
dissemination and international traceability. Metrologia, 31:515–527, January
1995.
107. N.F. Ramsey. Molecular beam resonance method with separated oscillating
ﬁelds. Physics Review, 78, 1950.
108. J.D. Romney. The VLBA correlator. Bulletin of the American Astronomical
Society, 27, May 1995.
109. M. Ryle, D. Vonberg. Solar radiation on 175Mc/s. Nature, 158, September
1946.
110. G. Sagnac. Practical implications of relativity for a global coordinate time
scale. C.R. Acad. Sci. Paris, 157:708–710, 1410–1413, 1913.
111. W. Schlueter, E. Himwich, A. Nothnagel, N. Vandenberg, A. Whitney. IVS
and its important role in the maintenance of the global reference systems.
Advances in Space Research, 30(2), July 2002.
112. Schriever AFB. Constellation status.
http://www.schriever.af.mil/gps/.
113. J.H. Shirley, W.D. Lee, R.E. Drullinger. Accuracy evaluation of the primary
frequency standard NIST-7. Metrologia, 38:427–458, 2001.
114. Symmetricom. 5071A Primary Frequency Standard. Symmetricom.
115. C. Tamm, T. Schneider, E. Peik. Optical frequency standard based on a
trapped 171Yb+ ion. In: G. Huber, I.A. Scherbakov, V.Y. Panchenko (eds.)
International Conference on Lasers, Applications, and Technologies 2002: Ad-
vanced Lasers and Systems. Edited by Huber, Guenter; Scherbakov, Ivan A.,
Panchenko, Vladislav Y. Proceedings of the SPIE, Volume 5137, pp. 403–407
(2003)., pp. 403–407, 2003.
116. U. Tanaka, S. Bize, C.E. Tanner, R.E. Drullinger, S.A. Diddams, L. Holl-
berg, W.M. Itano, D.J. Wineland, J.C. Bergquist. The 199Hg+ single ion op-
tical clock: recent progress. Journal of Physics B Atomic Molecular Physics,
36:545–551, 2003.
117. R. Tausworthe. Convergence of oscillator spectral estimators for counted-
frequency measurements. IEEE Transactions on Communications, 20(2),
April 1972.
118. M. Trott. The Mathematica GuideBook for Programming. Springer, Berlin
Heidelberg New York, 2004.
119. J.S. Ulvestad, K.E. Johnson, S.G. Neﬀ. A VLBI search for radio supernovae
in super star clusters. American Astronomical Society Meeting Abstracts, 207,
December 2005.
120. US Coast Guard Navigation Center. Global Positioning System Standard Po-
sitioning Service Signal Speciﬁcation.
http://www.navcen.uscg.gov/pubs/gps/sigspec/gpssps1.pdf.
www.ebook3000.com

212
References
121. US Coast Guard Navigation Center. Global Positioning System Standard Po-
sitioning Service Signal Speciﬁcation – Annex A thru C.
http://www.navcen.uscg.gov/pubs/gps/sigspec/gpsspsa.pdf.
122. USNO. Block II satellite information.
ftp://tycho.usno.navy.mil/pub/gps/gpsb2.txt.
123. USNO. GPS constellation status.
ftp://tycho.usno.navy.mil/pub/gps/gpstd.txt.
124. J. Vanier, C. Audoin. The Quantum Physics of Atomic Frequency Standards.
Hilger, Bristol.
125. C. Vian, P. Rosenbusch, H. Marion, S. Bize, L. Cacciapuoti, S. Zhang,
M. Abgrall, D. Chambon, I. Maksimovic, P. Laurent, G. Santarelli, A. Cla-
iron, A. Luiten, M. Tobar, C. Salomon. BNM-SYRTE fountains: Recent re-
sults. IEEE Transactions on Instrumentation and Measurement, 54(2):833–
836, April 2005.
126. C. Vian, P. Rosenbusch, H. Marion, F. Pereira Dos Santos, M. Abgrall,
S. Zhang, Y. Sortais, S. Bize, I. Maksimovic, D. Calonico, J. Grünert, C. Man-
dache, P. Lemonde, G. Santarelli, Ph. Laurent, A. Clairon. Recent results of
BNM-SYRTE fountain clocks. Joint Meeting IEEE International Frequency
Control Symposium and 17th European Frequency and Time Forum, May
2003.
127. W. Fricke, H. Schwan, T. Lederle, U. Bastian, R. Bien, G. Burkhardt,
B. du Mont, R. Hering, R. Jährling, H. Jahreiß, S. Röser, H.-M. Schwerdtfeger,
H.G. Walter. Fifth fundamental catalogue (FK5). part 1. the basic funda-
mental stars. Veröﬀentlichungen Astronomisches Rechnen-Institut Heidelberg,
(32), 1988.
128. E.W. Weisstein. Ergodic theory.
From MathWorld–A Wolfram Web Resource.
http://mathworld.wolfram.com/ErgodicTheory.html.
129. E.W. Weisstein. Random walk.
From MathWorld–A Wolfram Web Resource.
http://mathworld.wolfram.com/RandomWalk.html.
130. E.W. Weisstein. Random walk–1-dimensional.
From MathWorld–A Wolfram Web Resource.
http://mathworld.wolfram.com/RandomWalk1-Dimensional.html.
131. Wikipedia the Free Encyclopedia. Hadamard transform.
http://en.wikipedia.org/wiki/Hadamard_transform.
132. Wikipedia the Free Encyclopedia. Nyquist–shannon sampling theorem.
http://en.wikipedia.org/wiki/Nyquist–Shannon_sampling_theorem.
133. Wikipedia the Free Encyclopedia. Pink noise.
http://en.wikipedia.org/wiki/Flicker_noise.
134. Wikipedia the Free Encyclopedia. Stark eﬀect.
http://en.wikipedia.org/wiki/Stark_eﬀect.
135. Wikipedia the Free Encyclopedia. Stationary process.
http://en.wikipedia.org/wiki/Stationary_process.
136. Wikipedia the Free Encyclopedia. White noise.
http://en.wikipedia.org/wiki/White_noise.
137. Wikipedia the Free Encyclopedia. Zeeman eﬀect.
http://en.wikipedia.org/wiki/Zeeman_eﬀect.
138. G.M.R. Winkler. Modiﬁed julian date.
http://tycho.usno.navy.mil/mjd.html.

References
213
139. K. Yoshimura. Characterization of frequency stability: Uncertainty due to the
autocorrelation of the frequency ﬂuctuations. IEEE Transactions on Instru-
mentation and Measurement, 27(1), 1973.
140. P. Zeeman. The Eﬀect of magnetisation on the nature of light emitted by a
substance. Nature, 55, February 1897.
www.ebook3000.com

Index
Accuracy
Deﬁnition, 57
Typical values, 60
Commercial devices, 61
Primary frequency standards, 60
Aliasing, 72
Allan ﬁlter, 93
Allan variance
Deﬁnition, 93
Flicker frequency noise, 97
Flicker phase noise, 97
Frequency drift, 97
Frequency response, 94
Random walk frequency noise, 97
Uncertainty, 99
White frequency noise, 96
White phase noise, 97
Atom
Fine structure, 15
Hyperﬁne structure, 15
Atomic clock
Modelization, 137
Atomic fountain
Atomic signal amplitude noise
frequency noise, 51
OL frequency noise, 49
Preparation of the atoms, 31
principle, 30
Probing of the transition, 31
Servo-loop, 48
Barycentric celestial reference system
(BCRS), 135
Barycentric coordinate time (TCB),
135
CCDS, 131
CCTF, 131
Cesium atom
Frequency of the hyperﬁne transition,
18
Cesium frequency standard
Amplitude noise of the atomic signal,
44
Atomic beam preparation, 20
Detection of the transition, 23
Excitation of the transition, 20
Frequency error, 46
Frequency noise of the atomic signal,
43
Generation of the probing signal, 25
OL frequency noise, 43
Ramsey cavity, 20
Servo control of the local oscillator,
27
Transition probability, 20
Circular T, 133
Clock transition, 15
Coordinated universal time, 136
Covariance, 75
Deﬁnition of the second (1967), 18
Dick eﬀect, 32
EAL – échelle atomique libre, 132
Ergodicity, 76
Flicker frequency noise, 84
Flicker phase noise, 84
Frequency ﬂuctuations
components, 65
Frequency noise vs phase noise, 83
Frequency standard
Active and passive, 16
Passive
Optically pumped cesium beam, 16

216
Index
Galileo, 173
Control segment, 173
Data, 174
Space segment, 173
Geocentric celestial reference system
(GCRS), 135
Geocentric coordinate time (TCG), 135
GLONAS, 172
Control segment, 172
Data, 173
Space segment, 172
GPS
Algorithm for a receiver, 200
Anti-spooﬁng, 156
C/A-code, 155
C/A-code ambiguity, 162
Carrier L1, 155
Carrier L2, 155
Carrier phase tracking, 168
Coarse acquisition code, 155
Control segment, 153
Data emitted by the satellites, 154
Data processing by the receiver, 161
Diﬀerential GPS, 167
Doppler measurement, 171
EGNOS, 172
Error sources, 166
Geometric dilution of precision
(GDOP), 165
GPS time, 160
LAAS, 172
MSAS, 172
Navigation message, 158, 162
P-code, 155
P-code ambiguity, 162
P-code processing, 167
Precise code, 155
Propagation delays, 163
Quick description, 151
Satellite time, 159
Selective availability, 156
Space segment, 152
Spread spectrum technique, 154
User segment, 154
WAAS, 171
GPS time scale, 136
GPS time scale vs. UTC, 137
Hadamard ﬁlter, 100
Hadamard variance
Deﬁnition, 99, 100
Flicker frequency noise, 105
Flicker phase noise, 104
Frequency drift, 105
Random walk frequency noise, 105
White frequency noise, 104
White phase noise, 105
Hydrogen atom
Hyperﬁne transition frequency, 28
Hydrogen maser
Atomic beam preparation, 28
Atomic signal frequency noise, 37
Electronic package, 30
Frequency error, 38
Hyperﬁne frequency emission, 28
LO frequency noise, 36
Maser eﬀect, 28
Output phase noise, 38
Phase control loop, 34
Phase locking of the local oscillator,
29
IAU, 134
Ionospheric delay, 144
Leap seconds, 136
Since 1972, 136
Localization system, 151
Nyquist–Shannon sampling theorem, 73
Oscillator
Atomic resonance, 15
Electrical resonance, 14
Mechanical resonance, 14
The two parts, 13
Ramsey fringes, 21
Random walk frequency noise, 83
Sagnac eﬀect, 143, 144, 149, 150
SI second
Deﬁnition, 18
SI units, 129
Sidereal time, 134
Spectral density, 76
and Fourier transform, 77
and variance, 77
ﬁltering, 80
Stability
www.ebook3000.com

Index
217
Deﬁnition, 65
Frequency measurement, 67
Measurement in time domain:
principle, 67
Stationarity
First-order, 75
Second-order, 75
Synchronization
Carrier phase GPS, 146
Einstein clocks synchronization, 142
GPS common-view, 145
One-way GPS, 143
Rotating frame, 143
Two-way satellite, 147
Synchronization of Einstein clocks, 142
TAI
Accuracy, 132
Deﬁnition, 131
Processing, 132
Temps atomique international, 131
Processing, 132
Three-samples variance, 110
Flicker frequency noise, 111
Flicker phase noise, 111
Random walk frequency noise, 112
White frequency noise, 111
White phase noise, 111
Time scale
Deﬁnition, 130
Requirements, 130
Time scales
Algorithms, 140
Weight of the clocks, 142
Tropospheric delay, 144
TWSTFT, 147
Uncertainty
Deﬁnition, 57
Example of evaluation, 58
Principle of evaluation, 58
Type A, 58
Type B, 58
Typical values, 60
Commercial devices, 61
Primary frequency standards, 60
Uncertainty of the SI base units, 129
Universal time, 3, 134
UT, 3, 134
UT1, 134
UTC, 136
UTC vs. UTC(k), 137
Variance, 75
Discrete-time vs. continuous-time, 80
Unbiased estimator, 85
Variances
Analysis of the frequency noise, 113
Frequency drift, 119
Sensibility to the noise components,
115
Summary, 112
Summary of the bandwidths, 112
Very long base interferometry, 175
VLBI, 175
Coherence time, 181
Correlator, 186
Cross-correlation, 181
Earth rotation, 188
Fourier transform, 183
Fringe visibility, 181
Imaging, 183, 187
International Terrestrial Reference
System, 188
Local oscillator, 186
Plate motions, 188
Principle, 176
Resolution, 176
Timestamp, 186
White frequency noise, 84
White phase noise, 84

