Chapter 1
The Fundamental Theorem of
Arithmetic
1.1
Prime numbers
If a, b ∈Z we say that a divides b (or is a divisor of b) and we write a | b, if
b = ac
for some c ∈Z.
Thus −2 | 0 but 0 ∤2.
Deﬁnition 1.1 The number p ∈N is said to be prime if p has just 2 divisors in N,
namely 1 and itself.
Note that our deﬁnition excludes 0 (which has an inﬁnity of divisors in N) and
1 (which has just one).
Writing out the prime numbers in increasing order, we obtain the sequence of
primes
2, 3, 5, 7, 11, 13, 17, 19, . . .
which has fascinated mathematicians since the ancient Greeks, and which is the
main object of our study.
Deﬁnition 1.2 We denote the nth prime by pn.
Thus p5 = 11, p100 = 541.
It is convenient to introduce a kind of inverse function to pn.
Deﬁnition 1.3 If x ∈R we denote by π(x) the number of primes ≤x:
π(x) = ∥{p ≤x : p prime}∥.
Thus
π(1.3) = 0, π(3.7) = 2.
Evidently π(x) is monotone increasing, but discontinuous with jumps at each
prime x = p.
1–1

374
1–2
Theorem 1.1 (Euclid’s First Theorem) The number of primes is inﬁnite.
Proof ▶Suppose there were only a ﬁnite number of primes, say
p1, p2, . . . , pn.
Let
N = p1p2 · · · pn + 1.
Evidently none of the primes p1, . . . , pn divides N.
Lemma 1.1 Every natural number n > 1 has at least one prime divisor.
Proof of Lemma ▷The smallest divisor d > 1 of n must be prime. For otherwise
d would have a divisor e with 1 < e < d; and e would be a divisor of n smaller
than d.
◁
By the lemma, N has a prime factor p, which differs from p1, . . . , pn.
◀
Our argument not only shows that there are an inﬁnity of primes; it shows that
pn < 22n;
a very feeble bound, but our own. To see this, we argue by induction. Our proof
shows that
pn+1 ≤p1p2 · · · pn + 1.
But now, by our inductive hypothesis,
p1 < 221, p2 < 222, . . . , pn < 22n.
It follows that
pn+1 ≤221+22+···+2n
But
21 + 22 + · · · + 2n = 2n+1 −1 < 2n+1.
Hence
pn+1 < 22n+1.
It follows by induction that
pn < 22n,
for all n ≥1, the result being trivial for n = 1.
This is not a very strong result, as we said. It shows, for example, that the 5th
prime, in fact 11, is
< 225 = 232 = 4294967296.
In general, any bound for pn gives a bound for π(x) in the opposite direction,
and vice versa; for
pn ≤x ⇐⇒π(x) ≥n.

374
1–3
In the present case, for example, we deduce that
π(22y) ≥[y] > y −1
and so, setting x = 22y,
π(x) ≥log2 log2 x −1 > log log x −1.
for x > 1. (We follow the usual convention that if no base is given then log x
denotes the logarithm of x to base e.)
The Prime Number Theorem (which we shall make no attempt to prove) asserts
that
pn ∼n log n,
or, equivalently,
π(x) ∼
x
log x.
This states, roughly speaking, that the probability of n being prime is about
1/ log n. Note that this includes even numbers; the probability of an odd number
n being prime is about 2/ log n. Thus roughly 1 in 6 odd numbers around 106 are
prime; while roughly 1 in 12 around 1012 are prime.
(The Prime Number Theorem is the central result of analytic number theory
since its proof involves complex function theory. Our concerns, by contrast, lie
within algebraic number theory.)
There are several alternative proofs of Euclid’s Theorem. We shall give one
below. But ﬁrst we must establish the Fundamental Theorem of Arithmetic (the
Unique Factorisation Theorem) which gives prime numbers their central rˆole in
number theory; and for that we need Euclid’s Algorithm.
1.2
Euclid’s Algorithm
Proposition 1.1 Suppose m, n ∈N, m ̸= 0. Then there exist unique q.r ∈N
such that
n = qm + r,
0 ≤r < m.
Proof ▶For uniqueness, suppose
n = qm + r = q′m + r′,
where r < r′, say. Then
(q′ −q)m = r′ −r.
The number of the right is < m, while the number on the left has absolute value
≥m, unless q′ = q, and so also r′ = r.
We prove existence by induction on n. The result is trivial if n < m, with
q = 0, r = n. Suppose n ≥m. By our inductive hypothesis, since n −m < n,
n −m = q′m + r,

374
1–4
where 0 ≤r < m. But then
n = qm + r,
with q = q′ + 1.
◀
Remark: One might ask why we feel the need to justify division with remainder
(as above), while accepting, for example, proof by induction. This is not an easy
question to answer.
Kronecker said, “God gave the integers. The rest is Man’s.” Virtually all
number theorists agree with Kronecker in practice, even if they do not accept his
theology. In other words, they believe that the integers exist, and have certain
obvious properties.
Certainly, if pressed, one might go back to Peano’s Axioms, which are a stan-
dard formalisation of the natural numbers. (These axioms include, incidentally,
proof by induction.) Certainly any properties of the integers that we assume could
easily be derived from Peano’s Axioms.
However, as I heard an eminent mathematician (Louis Mordell) once say, “If
you deduced from Peano’s Axioms that 1+1 = 3, which would you consider most
likely, that Peano’s Axioms were wrong, or that you were mistaken in believing
that 1 + 1 = 2?”
Proposition 1.2 Suppose m, n ∈N. Then there exists a unique number d ∈N
such that
d | m, d | n,
and furthermore, if e ∈N then
e | m, e | n =⇒e | d.
Deﬁnition 1.4 We call this number d the greatest common divisor of m and n,
and we write
d = gcd(m, n).
Proof ▶Euclid’s Algorithm is a simple technique for determining the greatest
common divisor gcd(m, n) of two natural numbers m, n ∈N. It proves inci-
dentally — as the Proposition asserts — that any two numbers do indeed have a
greatest common divisor (or highest common factor).
First we divide the larger, say n, by the smaller. Let the quotient be q1 and let
the remainder (all we are really interested in) be r1:
n = mq1 + r1.
Now divide m by r1 (which must be less than m):
m = r1q2 + r2.

374
1–5
We continue in this way until the remainder becomes 0:
n = mq1 + r1,
m = r1q2 + r2,
r1 = r2q3 + r3,
. . .
rt−1 = rt−2qt−1 + rt,
rt = rt−1qt.
The remainder must vanish after at most m steps, for each remainder is strictly
smaller than the previous one:
m > r1 > r2 > · · ·
Now we claim that the last non-zero remainder, d = rt say, has the required
property:
d = gcd(m, n) = rt.
In the ﬁrst place, working up from the bottom,
d = rt | rt−1,
d | rt and d | rt−1 =⇒d | rt−2,
d | rt−1 and d | rt−2 =⇒d | rt−3,
. . .
d | r3 and d | r2 =⇒d | r1,
d | r2 and d | r1 =⇒d | m,
d | r1 and d | m =⇒d | n.
Thus
d | m, n;
so d is certainly a divisor of m and n.
On the other hand, suppose e is a divisor of m and n:
e | m, n.
Then, working downwards, we ﬁnd successively that
e | m and e | n =⇒e | r1,
e | r1 and e | m =⇒e | r2,
e | r2 and e | r1 =⇒e | r3,
. . .
e | rt−2 and e | rt−1 =⇒e | rt.
Thus
e | rt = d.

374
1–6
We conclude that our last non-zero remainder rt is number we are looking for:
gcd(m, n) = rt.
◀
It is easy to overlook the power and subtlety of the Euclidean Algorithm. The
algorithm also gives us the following result.
Theorem 1.2 Suppose m, n ∈N. Let
gcd(m, n) = d.
Then there exist integers x, y ∈Z such that
mx + ny = d.
Proof ▶The Proposition asserts that d can be expressed as a linear combination
(with integer coefﬁcients) of m and n. We shall prove the result by working
backwards from the end of the algorithm, showing successively that d is a linear
combination of rs and rs+1, and so, since rs+1 is a linear combination of rs−1 and
rs, d is also a linear combination of rs−1 and rs.
To start with,
d = rt.
From the previous line in the Algorithm,
rt−2 = qtrt−1 + rt.
Thus
d = rt = rt−2 −qtrt−1.
But now, from the previous line,
rt−3 = qt−1rt−2 + rt−1.
Thus
rt−1 = rt −3 −qt−1rt−2.
Hence
d = rt−2 −qtrt −1
= rt−2 −qt(rt−3 −qt−1rt−2)
= −qtrt−3 + (1 + qtqt−1)rt−2.
Continuing in this way, suppose we have shown that
d = asrs + bsrs+1.
Since
rs−1 = qs+1rs + rs+1,

374
1–7
it follows that
d = asrs + bs(rs−1 −qs+1rs)
= bsrs−1 + (as −bsqs+1)rs.
Thus
d = as−1rs−1 + bs−1rs,
with
as−1 = bs, bs−1 = as −bsqs+1.
Finally, at the top of the algorithm,
d = a0r0 + b0r1
= a0r0 + b0(m −q1r0)
= b0m + (a0 −b0q1)r0
= b0m + (a0 −b0q1)(n −q0m)
= (b0 −a0q0 + b0q0q1)m + (a0 −b0q0)n,
which is of the required form.
◀
Example: Suppose m = 39, n = 99. Following Euclid’s Algorithm,
99 = 2 · 39 + 21,
39 = 1 · 21 + 18,
21 = 1 · 18 + 3,
18 = 6 · 3.
Thus
gcd(39, 99) = 3.
Also
3 = 21 −18
= 21 −(39 −21)
= −39 + 2 · 21
= −39 + 2(99 −2 · 39)
= 2 · 99 −5 · 39.
Thus the Diophantine equation
99x + 39y = 3
has the solution
x = 2, y = −5.
(By a Diophantine equation we simply mean a polynomial equation to which we
are seeking integer solutions.)

374
1–8
This solution is not unique; we could, for example, add 39 to x and subtract
99 from y. We can ﬁnd the general solution by subtracting the particular solution
we have just found to give a homogeneous linear equation. Thus if x′, y′ ∈Z also
satisﬁes the equation then X = x′ −x, Y = y′ −y satisﬁes the homogeneous
equation
99X + 39Y = 0,
ie
33X + 13Y = 0,
the general solution to which is
X = 13t, Y = −33t
for t ∈Z. The general solution to this diophantine equation is therefore
x = 2 + 13t, y = −5 −33t
(t ∈Z).
It is clear that the Euclidean Algorithm gives a complete solution to the general
linear diophantine equation
ax + by = c.
This equation has no solution unless
gcd(a, b) | c,
in which case it has an inﬁnity of solutions. For if (x, y) is a solution to the
equation
ax + by = d,
and c = dc′ then (c′x, c′y) satisﬁes
ax + by = c,
and we can ﬁnd the general solution as before.
Corollary 1.1 Suppose m, n ∈Z. Then the equation
mx + ny = 1
has a solution x, y ∈Z if and only if gcd(m, n) = 1.
It is worth noting that we can improve the efﬁciency of Euclid’s Algorithm by
allowing negative remainders. For then we can divide with remainder ≤m/2 in
absolute value, ie
n = qm + r,

374
1–9
with −m/2 ≤r < m/2. The Algorithm proceeds as before; but now we have
m ≥|r0/2| ≥|r1/22| ≥. . . ,
so the Algorithm concludes after at most log2 m steps.
This shows that the algorithm is in class P, ie it can be completed in polyno-
mial (in fact linear) time in terms of the lengths of the input numbers m, n — the
length of n, ie the number of bits required to express n in binary form, being
[log2 n] + 1.
Algorithms in class P (or polynomial time algorithms) are considered easy or
tractable, while problems which cannot be solved in polynomial time are consid-
ered hard or intractable. RSA encryption — the standard techniqhe for encrypting
conﬁdential information — rests on the belief — and it should be emphasized that
this is a belief and not a proof — that factorisation of a large number is intractable.
Example: Taking m = 39, n = 99, as before, the Algorithm now goes
99 = 3 · 39 −18,
39 = 2 · 18 + 3,
18 = 6 · 3,
giving (of course)
gcd(39, 99) = 3,
as before.
1.3
Ideals
We used the Euclidean Algorithm above to show that if gcd(a, b) = 1 then there
we can ﬁnd u, v ∈Z such that
au + bv = 1.
There is a much quicker way of proving that such u, v exist, without explicitly
computing them.
Recall that an ideal in a commutative ring A is a non-empty subset a ⊂A
such that
1. a, b ∈a =⇒a + b ∈a;
2. a ∈a, c ∈A =⇒ac ∈a.
As an example, the multiples of an element a ∈A form an ideal
⟨a⟩= {ac : c ∈A}.
Such an ideal is said to be principal.

374
1–10
Proposition 1.3 Every ideal a ⊂Z is principal.
Proof ▶If a = 0 (by convention we denote the ideal {0} by 0) the result is trivial:
a = ⟨0⟩. We may suppose therefor that a ̸= 0.
Then a must contain integers n > 0 (since −n ∈a =⇒n ∈a). Let d be the
least such integer. Then
a = ⟨d⟩.
For suppose a ∈a. Dividing a by d,
a = qd + r,
where
0 ≤r < d.
But
r = a + (−q)d ∈a.
Hence r = 0; for otherwise r would contradict the minimality of d. Thus
a = qd,
ie every element a ∈a is a multiple of d.
◀
Now suppose a, b ∈Z. Consider the set of integers
I = {au + bv : u, v ∈Z}.
It is readily veriﬁed that I is an ideal.
According to the Proposition above, this ideal is principal, say
I = ⟨d⟩.
But now
a ∈I =⇒d | a,
b ∈I =⇒d | b.
On the other hand,
e | a, e | b =⇒e | au + bv
=⇒e | d.
It follows that
d = gcd(a, b);
and we have shown that the diophantine equation
au + bv = d
always has a solution.
In particular, if gcd(a, b) = 1 we can u, v ∈Z such that
au + bv = 1.

374
1–11
This proof is much shorter than the one using the Euclidean Algorithm; but it
suffers from the disadvantage that it provides no way of computing
d = gcd(a, b),
and no way of solving the equation
au + bv = d.
In effect, we have taken d as the least of an inﬁnite set of positive integers, using
the fact that the natural numbers N are well-ordered, ie every subset S ⊂N has a
least element.
1.4
The Fundamental Theorem of Arithmetic
Proposition 1.4 (Euclid’s Lemma) Suppose p ∈N is a prime number; and sup-
pose a, b ∈Z. Then
p | ab =⇒p | a or p | b.
Proof ▶Suppose p | ab, p ∤a. We must show that p | b. Evidently
gcd(p, a) = 1.
Hence, by Corollary 1.1, there exist x, y ∈Z such that
px + ay = 1.
Multiplying this equation by b,
pxb + aby = b.
But p | pxb and p | aby (since p | ab). Hence
p | b.
◀
Theorem 1.3 Suppose n ∈N, n > 0. Then n is expressible as a product of prime
numbers,
n = p1p2 · · · pr,
and this expression is unique up to order.
Remark: We follow the convention that an empty product has value 1, just as an
empty sum has value 0. Thus the theorem holds for n = 1 as the product of no
primes.

374
1–12
Proof ▶We prove existence by induction on n, the result begin trivial (by the
remark above) when n = 1. We know that n has at least one prime factor p, by
Lemma 1.1, say
n = pm.
Since m = n/p < n, we may apply our inductive hypothesis to m,
m = q1q2 · · · qs.
Hence
n = pq1q2 · · · qs.
Now suppose
n = p1p2 · · · pr = m = q1q2 · · · qs.
Since p1 | n, it follows by repeated application of Euclid’s Lemma that
p1 | qj
for some j. But then it follows from the deﬁnition of a prime number that
p1 = qj.
Again, we argue by induction on n. Since
n/p1 = p2 · · · pr = q1 · · · ˆqj · · · qs
(where the ‘hat’ indicates that the factor is omitted), and since n/p1 < n, we
deduce that the factors p2, . . . , pr are the same as q1, . . . , ˆqj, . . . , qs, in some order.
Hence r = s, and the primes p1, · · · , pr and q1, . . . , qs are the same in some order.
◀
We can base another proof of Euclid’s Theorem (that there exist an inﬁnity of
primes) on the fact that if there were only a ﬁnite number of primes there would
not be enough products to “go round”.
Thus suppose there were just m primes
p1, . . . , pm.
Let N ∈N. By the Fundamental Theorem, each n ≤N would be expressible in
the form
n = pe1
1 · · · pem
m .
(Actually, we are only using the existence part of the Fundamental Theorem; we
do not need the uniqueness part.)
For each i (1 ≤i ≤m),
pei
i | n =⇒pei
i ≤n
=⇒pei
i ≤N
=⇒2ei ≤N
=⇒ei ≤log2 N.

374
1–13
Thus there are at most log2 N +1 choices for each exponent ei, and so the number
of numbers n ≤N expressible in this form is
≤(log2 N + 1)m.
So our hypothesis implies that
(log2 N + 1)m ≥N
for all N.
But in fact, to the contrary,
X > (log2 X + 1)m =
 log X
log 2 + 1
!m
for all sufﬁciently large X. To see this, set X = ex. We have to show that
ex >
 x
log 2 + 1
!m
.
Since
x
log 2 + 1 < 2x
if x ≥3, it is sufﬁcient to show that
ex > (2x)m
for sufﬁciently large x. But
ex >
xm+1
(m + 1)!
if x > 0, since the expression on the right is one of the terms in the power-series
expansion of ex. Thus the inequality holds if
xm+1
(m + 1)! > (2x)m,
ie if
x > 2m(m + 1)!.
We have shown therefore that m primes are insufﬁcient to express all n ≤N
if
N ≥e2m(m+1)!.
Thus our hypothesis is untenable; and Euclid’s theorem is proved.
Our proof gives the bound
pn ≤e2m(m+1)!.

374
1–14
which is even worse than the bound we derived from Euclid’s proof. (For it is
easy to see by induction that
(m + 1)! > em
for m ≥2. Thus our bound is worse than een, compared with 22n by Euclid’s
method.)
We can improve the bound considerably by taking out the square factor in n.
Thus each number n ∈N (n > 0) is uniquely expressible in the form
n = d2p1 . . . pr,
where the primes p1, . . . , pr are distinct. In particular, if there are only m primes
then each n is expressible in the form
n = d2pe1
1 · · · pem
m ,
where now each exponent ei is either 0 or 1.
Consider the numbers n ≤N. Since
d ≤√n ≤
√
N,
the number of numbers of the above form is
≤
√
N2m.
Thus we shall reach a contradiction when
√
N2m ≥N,
ie
N ≤22m.
This gives us the bound
pn ≤22n,
better than 22n, but still a long way from the truth.
1.5
The Fundamental Theorem, recast
We suppose throughout this section that A is an integral domain. (Recall that an
integral domain is a commutative ring with 1 having no zero divisors, ie if a, b ∈A
then
ab = 0 =⇒a = 0 or b = 0.)
We want to examine whether or not the Fundamental Theorem holds in A —
we shall ﬁnd that it holds in some commutative rings and not in others. But to
make sense of the question we need to re-cast our deﬁnition of a prime.
Looking back at Z, we see that we could have deﬁned primality in two ways
(excluding p = 1 in both cases):

374
1–15
1. p is prime if it has no proper factors, ie
p = ab =⇒a = 1 or b = 1.
2. p is prime if
p | ab =⇒p | a or p | b.
The two deﬁnitions are of course equivalent in the ring Z. However, in a
general ring the second deﬁnition is stronger: that is, an element satisfying it must
satisfy the ﬁrst deﬁnition, but the converse is not necessarily true. We shall take
the second deﬁnition as our starting-point.
But ﬁrst we must deal with one other point. In deﬁning primality in Z we
actually restricted ourselves to the semi-ring N, deﬁned by the order in Z:
N = {n ∈Z : n ≥0}.
However, a general ring A has no natural order, and no such semi-ring, so we must
consider all elements a ∈A.
In the case of Z this would mean considering −p as a prime on the same
footing as p. But now, for the Fundamental Theorem to make sense, we would
have to regard the primes ±p as essentially the same.
The solution in the general ring is that to regard two primes as equivalent if
each is a multiple of the other, the two multiples necessarily being units.
Deﬁnition 1.5 An element ϵ ∈A is said to be a unit if it is invertible, ie if there is
an element η ∈A such that
ϵη = 1.
We denote the set of units in A by A×.
For example,
Z× = {±1}.
Proposition 1.5 The units in A form a multiplicative group A×.
Proof ▶This is immediate. Multiplication is associative, from the deﬁnition of a
ring; and η = ϵ−1 is a unit, since it has inverse ϵ.
◀
Now we can deﬁne primality.
Deﬁnition 1.6 Suppose a ∈A is not a unit, and a ̸= 0. Then
1. a is said to be irreducible if
a = bc =⇒b or c is a unit.
2. a is said to be prime if
a | bc =⇒a | b or p | b.

374
1–16
Proposition 1.6 If a ∈A is prime then it is irreducible.
Proof ▶Suppose
a = bc.
Then
a | b or a | c.
We may suppose without loss of generality that a | b. Then
a | b, b | a =⇒a = bϵ,
where ϵ is a unit; and
a = bc = bϵ =⇒c = ϵ.
◀
Deﬁnition 1.7 The elements a, b ∈A are said to be equivalent, written
a ∼b,
if
b = ϵa
for some unit ϵ.
In effect, the group of units A× acts on A and two elements are equivalent if
each is a transform of the other under this action.
Now we can re-state the Fundamental Theorem in terms which make sense in
any integral domain.
Deﬁnition 1.8 The integral domain A is said to be a unique factorisation domain
if each non-unit a ∈A, a ̸= 0 is expressible in the form
a = p1 · · · pr,
where p1, . . . , pr are prime, and if this expression is unique up to order and equiv-
alence of primes.
In other words, if
a = q1 · · · qs
is another expression of the same form, then r = s and we can ﬁnd a permutation
π of {1, 2, . . . , r} and units ϵ1, ϵ2, . . . , ϵr such that
qi = ϵipπ(i)
for i = 1, 2, . . . , r.
Thus a unique factorisation domain (UFD) is an integral domain in which the
Fundamental Theorem of Arithmetic is valid.

374
1–17
1.6
Principal ideals domains
Deﬁnition 1.9 The integral domain A is said to be a principal ideal domain if
every ideal a ∈A is principal, ie
a = ⟨a⟩= {ac : c ∈A}
for some a ∈A.
Example: By Proposition 1.3, Z is a principal ideal domain.
Our proof of the Fundamental Theorem can be divided into two steps — this
is clearer in the alternative version outlined in Section 1.3 — ﬁrst we showed that
that Z is a principal ideal domain, and then we deduced from this that Z is a unique
factorisation domain.
As our next result shows this argument is generally available; it is the tech-
nique we shall apply to show that the Fundamental Theorem holds in a variety of
integral domains.
Proposition 1.7 A principal ideal domain is a unique factorisation domain.
Proof ▶Suppose A is a principal ideal domain.
Lemma 1.2 A non-unit a ∈A, a ̸= 0 is prime if and only if it is irreducible, ie
a = bc =⇒a is a unit or b is a unit.
Proof of Lemma ▷By Proposition 1.6, a prime is always irreducible.
The converse is in effect Euclid’s Lemma. Thus suppose
p | ab
but
p ∤a.
Consider the ideal ⟨p, a⟩generated by p and a. By hypothesis this is principal, say
⟨p, a⟩= ⟨d⟩.
Since p is irreducible,
d | p =⇒d = ϵ or d = pϵ,
where ϵ is a unit. But
d = pϵ, d | a =⇒p | a,
contrary to hypothesis. Thus d is a unit, ie
⟨p, a⟩= A.
In particular we can ﬁnd u, v ∈A such that
pu + av = 1.

374
1–18
Multiplying by b,
pub + abv = b.
But now
p | ab =⇒p | b.
◁
Now suppose a is neither a unit nor 0; and suppose that a is not expressible as
a product of primes. Then a is reducible, by the Lemma above: say
a = a1b1,
where a1, b1 are non-units. One at least of a1, b1 is not expressible as a product of
primes; we may assume without loss of generality that this is true of a1.
It follows by the same argument that
a1 = a2b2,
where a2, b2 are non-units, and a2 is not expressible as a product of primes.
Continuing in this way,
a = a1b1, a1 = a2b2, a2 = a3b3, . . . .
Now consider the ideal
a = ⟨a1, a2, a3, . . . ⟩.
By hypothesis this ideal is principal, say
a = ⟨d⟩.
Since d ∈a,
d ∈⟨a1, . . . , ar⟩= ⟨ar⟩
for some r. But then
ar+1 ∈⟨d⟩= ⟨ar⟩.
Thus
ar | ar+1, ar+1 | ar =⇒ar = ar+1ϵ =⇒br+1 = ϵ,
where ϵ is a unit, contrary to construction.
Thus the assumption that a is not expressible as a product of primes is unten-
able;
a = p1 · · · pr.
To prove uniqueness, we argue by induction on r, where r the smallest number
such that a is expressible as a product of r primes.
Suppose
a = p1 · · · pr = q1 · · · qs.
Then
p1 | q1 · · · qs =⇒p1 | qj

374
1–19
for some j. Since qj is irreducible, by Proposition 1.6, it follows that
qj = p1ϵ,
where ϵ is a unit.
We may suppose, after re-ordering the q’s that j = 1. Thus
p1 ∼q1.
If r = 1 then
a = p1 = ϵp1q2 · · · qs =⇒1 = ϵq2 · · · qs.
If s > 1 this implies that q2, . . . , qs are all units, which is absurd. Hence s = 1,
and we are done.
If r > 1 then
q1 = ϵp1 =⇒p2p3 · · · pr = (ϵq2)q3 · · · qs
(absorbing the unit ϵ into q2). The result now follows by our inductive hypothesis.
◀
1.7
Polynomial rings
If A is a commutative ring (with 1) then we denote by A[x] the ring of polynomials
p(x) = anxn + · · · + a0
(a0, . . . , an ∈A).
Note that these polynomials should be regarded as formal expressions rather
than maps p : A →A; for if A is ﬁnite two different polynomials may well deﬁne
the same map.
We identify ainA with the constant polynomial f(x) = a. Thus
A ⊂A[x].
Proposition 1.8 If A is an integral domain then so is A[x].
Proof ▶Suppose
f(x) = amxm + · · · + a0,
g(x) = bnxn + · · · + b0,
where am ̸= 0, bn ̸= 0. Then
f(x)g(x) = (ambn)xm+n + · · · + a0b0;
and the leading coefﬁcient ambn ̸= 0.
◀

374
1–20
Proposition 1.9 The units in A[x] are just the units of A:
(A[x])× = A×.
Proof ▶It is clear that a ∈A is a unit (ie invertible) in A[x] if and only if it is a
unit in A.
On the other hand, no non-constant polynomial F(x) ∈A[x] can be invertible,
since
deg F(x)G(x) ≥deg F(x)
if G(x) ̸= 0.
◀
If A is a ﬁeld then we can divide one polynomial by another, obtaining a
remainder with lower degree than the divisor. Thus degree plays the rˆole in k[x]
played by size in Z.
Proposition 1.10 Suppose k is a ﬁeld; and suppose f(x), g(x) ∈k[x], with
g(x) ̸= 0. Then there exist unique polynomials q(x), r(x) ∈k[x] such that
f(x) = g(x)q(x) + r(x),
where
deg r(x) < deg g(x).
Proof ▶We prove the existence of q(x), r(x) by induction on deg f(x).
Suppose
f(x) = amxm + · · · + a0,
g(x) = bnxn + · · · + b0,
where am ̸= 0, bn ̸= 0.
If m < n then we can take q(x) = 0, r(x) = f(x). We may suppose therefore
that m ≥n. In that case, let
f1(x) = f(x) −(am/bn)xm−ng(x).
Then
deg f1(x) < deg f(x).
Hence, by the inductive hypothesis,
f1(x) = g(x)q1(x) + r(x),
where
deg r(x) < deg g(x);
and then
f(x) = g(x)q(x) + r(x),
with
q(x) = (am/bn)xm−n + q1(x).

374
1–21
For uniqueness, suppose
f(x) = g(x)q1(x) + r1(x) = g(x)q2(x) + r2(x).
On subtraction,
g(x)q(x) = r(x),
where
q(x) = q2(x) −q1(x),
r(x) = r1(x) −r2(x).
But now, if q(x) ̸= 0,
deg(g(x)q(x)) ≥deg g(x),
deg r(x) < deg g(x).
This is a contradiction. Hence
q(x) = 0,
ie
q1(x) = q2(),
r1(x) = r2().
◀
Proposition 1.11 If k is a ﬁeld then k[x] is a principal ideal domain.
Proof ▶As with Z we can prove this result in two ways: constructively, using the
Euclidean Algorithm; or non-constructively, using ideals. This time we take the
second approach.
Suppose
a ⊂k[x]
is an ideal. If a = 0 the result is trivial; so we may assume that a ̸= 0.
Let
d(x) ∈a
be a polynomial in a of minimal degree. Then
a = ⟨d(x)⟩.
For suppose f(x) ∈a. Divide f(x) by d(x):
f(x) = d(x)q(x) + r(x),
where deg r(x) < deg d(x). Then
r(x) = f(x) −d(x)q(x) ∈a
since f(x), d(x) ∈a. Hence, by the minimality of deg d(x),
r(x) = 0,
ie
f(x) = d(x)q(x).
◀
By Proposition 1.7 this gives the result we really want.

374
1–22
Corollary 1.2 If k is a ﬁeld then k[x] is a unique factorisation domain.
Every non-zero polynomial f(x) ∈k[x] is equivalent to a unique monic poly-
nomial, namely that obtained by dividing by its leading term. Thus each prime,
or irreducible, polynomial p(x) ∈k[x] has a unique monic representative; and we
can restate the above Corollary in a simpler form.
Corollary 1.3 Each monic polynomial
f(x) = xn + an−1xn−1 + · · · + a0
can be uniquely expressed (up to order) as a product of irreducible monic polyno-
mials:
f(x) = p1(x) · · · pr(x).
1.8
Postscript
We end this Chapter with a result that we don’t really need, but which we have
come so close to it would be a pity to omit.
Suppose A is an integral domain. Let K be the ﬁeld of fractions of A. (Recall
that K consists of the formal expressions
a
b,
with a, b ∈A, b ̸= 0; where we set
a
b = c
d
if
ad = bc.
The map
a 7→a
1 : A →K
is injective, allowing us to identify A with a subring of K.)
The canonical injection
A ⊂K
evidently extends to an injection
A[x] ⊂K[x].
Thus we can regard f(x) ∈A[x] as a polynomial over K.
Proposition 1.12 If A is a unique factorisation domain then so is A[x].
Proof ▶First we must determine the primes in A[x].
Lemma 1.3 The element p ∈A is prime in A[x] if and only if it is prime in A.

374
1–23
Proof of Lemma ▷It is evident that
p prime in A[x] =⇒p prime in A.
Conversely, suppose p is prime in A; We must show that if F(x), G(x) ∈A[x]
then
p | F(x)G(x) =⇒p | F(x) or p | G(x).
In other words,
p ∤F(x), p ∤G(x) =⇒p ∤F(x)G(x).
Suppose
F(x) = amxm + · · · + a0,
G(x) = bnxn + · · · + b0;
and suppose
p ∤F(x),
p ∤G(x).
Let ar, bs be the highest coefﬁcients of f(x), g(x) not divisible by p. Then the
coefﬁcient of xr+s in f(x)g(x) is
a0br+s + a1br+s−1 + · · · + arbs + · · · + ar+sb0 ≡arbs mod p,
since all the terms except arbs are divisible by p. Hence
p | arbs =⇒p mod ar or p mod bs,
contrary to hypothesis. In other words,
p ∤F(x)G(x).
◁
Lemma 1.4 Suppose f(x) ∈K[x]. Then f(x) is expressible in the form
f(x) = αF(x),
where α ∈K and
F(x) = anxn + · · · + a0 ∈A[x]
with
gcd(a0, . . . , an) = 1;
and the expression is unique up to multiplication by a unit, ie if
f(x) = αF(x) = βG(x),
where G(x) has the same property then
G(x) = ϵF(x),
α = ϵβ
for some unit ϵ ∈A.

374
1–24
Proof of Lemma ▷Suppose
f(x) = αnxn + · · · + α0.
Let
αi = ai
bi
,
where ai, bi ∈A; and let
b =
Y
bi.
Then
bf(x) = bnxn + · · · + b0 ∈A[x].
Now let
d = gcd(b0, . . . , bn).
Then
f(x) = (b/d)(cnxn + · · · + c0)
is of the required form, since
gcd(c0, . . . , cn) = 1.
To prove uniqueness, suppose
f(x) = αF(x) = βG(x).
Then
G(x) = γF(x),
where γ = α/β.
In a unique factorisation domain A we can express any γ ∈K in the form
γ = a
b,
with gcd(a, b) = 1, since we can divide a and b by any common factor.
Thus
aF(x) = bG(x).
Let p be a prime factor of b. Then
p | aF(x) =⇒p | F(x),
contrary to our hypothesis on the coefﬁcients of F(x). Thus b has no prime factors,
ie b is a unit; and similarly a is a unit, and so γ is a unit.
◁
Lemma 1.5 A non-constant polynomial
F(x) = anxn + · · · + a0 ∈A[x]
is prime in A[x] if and only if

374
1–25
1. F(x) is prime (ie irreducible) in K(x); and
2. gcd(a0, . . . , an) = 1.
Proof of Lemma ▷Suppose F(x) is prime in A[x]. Then certainly
gcd(a0, . . . , an) = 1,
otherwise F(x) would be reducible.
Suppose F(x) factors in K[x]; say
F(x) = g(x)h(x).
By Proposition 1.4,
g(x) = αG(x),
h(x) = βH(x),
where G(x), H(x) have no factors in A. Thus
F(x) = γG(x)H(x),
where γ ∈K. Let γ = a/b, where a, b ∈A and gcd(a, b) = 1. Then
bF(x) = aG(x)H(x).
Suppose p is a prime factor of b. Then
p | G(x)
or
p | H(x),
neither of which is tenable. Hence b has no prime factors, ie b is a unit. But now
F(x) = ab−1G(x)H(x);
and so F(x) factors in A[x].
Conversely, suppose F(x) has the two given properties. We have to show that
F(x) is prime in A[x].
Suppose
F(x) | G(x)H(x)
in A[x].
If F(x) is constant then
F(x) = a ∼1
by the second property, so
F(x) | G(x)
and
F(x) | H(x).
We may suppose therefore that deg F(x) ≥1. Since K[x] is a unique factori-
sation domain (Corollary to Proposition 1.11),
F(x) | G(x)
or
F(x) | H(x)

374
1–26
in K[x]. We may suppose without loss of generality that
F(x) | G(x)
in K[x], say
G(x) = F(x)h(x),
where h(x) ∈K[x].
By Lemma 1.4 we can express h(x) in the form
h(x) = αH(x),
where the coefﬁcients of H(x) are factor-free. Writing
α = a
b,
with gcd(a, b) = 1, we have
bG(x) = aF(x)H(x).
Suppose p is a prime factor of b. Then
p | a
or
p | F(x)
or
p | H(x),
none of which is tenable. Hence b has no prime factors, ie b is a unit. Thus
F(x) | G(x)
in A[x].
◁
Now suppose
F(x) = anxn + · · · a0 ∈A[x]
is not a unit in A[x].
If F(x) is constant, say F(x) = a, then the factorisation of a into primes in A
is a factorisation into primes in A[x], by Lemma 1.3. Thus we may assume that
deg F(x) ≥1.
Since K[x] is a unique factorisation domain (Corollary to Proposition 1.11),
F(x) can be factorised in K[x]:
F(x) = anp1(x) · · · ps(x),
where p1(x), . . . , ps(x) are irreducible monic polynomials in K[x].
By Lem-
mas 1.4 and 1.5 each pi(x) is expressible in the form
pi(x) = αiPi(x),
where Pi(x) is prime in A[x].
Thus
F(x) = αP1(x) · · · Pr(x),

374
1–27
where
α = anα1 · · · αr ∈K.
Let
α = a
b,
where gcd(a, b) = 1. Then
bF(x) = aP1(x) · · · Pr(x).
Let p be a prime factor of b. Then
p | Pi(x)
for some i, contrary to the deﬁnition of Pi(x). Hence b has no prime factors, ie b
is a unit.
If a is a unit then we can absorb ϵ = a/b into P1(x):
F(x) = Q(x)P2(x) · · · Pr(x),
where Q(x) = (a/b)P1(x).
If a is not a unit then
ab−1 = p1 · · · ps,
where p1, . . . , ps are prime in A (and so in A[x] by Lemma 1.3); and
F(x) = p1 · · · psP1(x) · · · Pr(x),
as required.
Finally, to prove uniqueness, we may suppose that deg F(x) ≥1, since the
result is immediate if F(x) = a is constant.
Suppose
F(x) = p1 · · · psP1(x) · · · Pr(x) = q1 · · · qs′Q1(x) · · · Qr′(x).
Each Pi(x), Qj(x) is prime in K[x] by Lemma 1.5. Since K[x] is a unique
factorisation domain (Corollary to Proposition 1.11) it follows that r = r′ and
that after re-ordering,
Qi(x) = αPi(x),
where α ∈K×. Let
α = a/b
with gcd(a, b) = 1. Then
aPi(x) = bQi(x).
If p is a prime factor of b then
p | bQi(x) =⇒p | Qi(x),

374
1–28
contrary to the deﬁnition of Qi(x). Thus b has no prime factors, and is therefore a
unit. Similarly a is a unit. Hence
Qi(x) = ϵiPi(x),
where ϵi ∈A is a unit.
Setting
ϵ =
Y
i
ϵi,
we have
p1 · · · ps = ϵq1 · · · qs′.
Since A is a unique factorisation domain, s = s′ and after re-ordering,
qj = ηjpj,
where ηj ∈A is a unit.
We conclude that the prime factors of F(x) are unique up to order and equiv-
alence (multiplication by units), ie A[x] is a unique factorisation domain.
◀
Example: There is unique factorisation in Z[x], since Z is a principal ideal domain
by Proposition 1.3 and so a unique factorisation domain by Proposition 1.7.
Note that Z[x] is not a principal ideal domain, since eg the ideal
a = ⟨2, x⟩,
consisting of all polynomials
F(x) = anxn + · · · + a0
with a0 even, is not principals:
a ̸= ⟨G(x)⟩.
For if it were, its generator G(x) would have to be constant, since a contains
non-zero constants, and
deg G(x)H(x) ≥deg G(x)
if H(x) ̸= 0. But if G(x) = d then
a ∩Z = ⟨2⟩=⇒d = ±2,
ie a consists of all polynomials with even coefﬁcients. Since x ∈a is not of this
form we conclude that a is not principal.

Chapter 2
Number ﬁelds
2.1
Algebraic numbers
Deﬁnition 2.1 A number α ∈C is said to be algebraic if it satisﬁes a polynomial
equation
f(x) = xn + a1xn−1 + · · · + an = 0
with rational coefﬁcients ai ∈Q.
For example,
√
2 and i/2 are algebraic.
A complex number is said to be transcendental if it is not algebraic. Both e
and π are transcendental. It is in general extremely difﬁcult to prove a number
transcendental, and there are many open problems in this area, eg it is not known
if πe is transcendental.
Proposition 2.1 The algebraic numbers form a ﬁeld ¯Q ⊂C.
Proof ▶If α satisﬁes the equation f(x) = 0 then −α satisﬁes f(−x) = 0, while
1/α satisﬁes xnf(1/x) = 0 (where n is the degree of f(x)). It follows that −α
and 1/α are both algebraic. Thus it is sufﬁcient to show that if α, β are algebraic
then so are α + β, αβ.
Suppose α satisﬁes the equation
f(x) ≡xm + a1xm−1 + · · · + am = 0,
and β the equation
g(x) ≡xn + b1xn−1 + · · · + bn = 0.
Consider the vector space
V = ⟨αiβj : 0 ≤i < m, 0 ≤j < n⟩
over Q spanned by the mn elements αiβj. Evidently
α + β, αβ ∈V.
2–1

374
2–2
But if θ ∈V then the mn + 1 elements
1, θ, θ2, . . . , θmn
are necessarily linearly dependent (over Q), since dim V ≤mn. In other words
θ satisﬁes a polynomial equation of degree ≤mn. Thus each element θ ∈V is
algebraic. In particular α + β and αβ are algebraic.
◀
2.2
Minimal polynomials and conjugates
Recall that a polynomial p(x) is said to be monic if its leading coefﬁcient — the
coefﬁcient of the highest power of x — is 1:
p(x) = xn + a1xn−1 + · · · + an.
Proposition 2.2 Each algebraic number α ∈¯Q satisﬁes a unique monic polyno-
mial m(x) of minimal degree.
Proof ▶Suppose α satisﬁes two monic polynomials m1(x), m2(x) of minimal
degree d. Then α also satisﬁes the polynomial
p(x) = m1(x) −m2(x)
of degree < d; and if p(x) ̸= 0 then we can make it monic by dividing by its
leading coefﬁcient. This would contradict the minimality of m1(x). Hence
m1(x) = m2(x).
◀
Deﬁnition 2.2 The monic polynomial m(x) satisﬁed by α ∈¯Q is called the min-
imal polynomial of α. The degree of the algebraic number α is the degree of its
minimal polynomial m(x).
Proposition 2.3 The minimal polynomial m(x) of α ∈¯Q is irreducible.
Proof ▶Suppose to the contrary
m(x) = f(x)g(x)
where f(x), g(x) are of lower degrees than m(x). But then α must be a root of
one of f(x), g(x).
◀
Deﬁnition 2.3 Two algebraic numbers α, β are said to be conjugate if they have
the same minimal polynomial.
Proposition 2.4 An algebraic number of degree d has just d conjugates.

374
2–3
Proof ▶If the minimal poynomial of α is
m(x) = xd + a1xd−1 + · · · + ad,
then by deﬁnition the conjugates of α are the d roots α1 = α, α2, . . . , αd of m(x):
m(x) = (x −α1)(x −α2) · · · (x −αd).
These conjugates are distinct, since an irreducible polynomial m(x) over Q is
necessarily separable, ie it cannot have a repeated root. For if α were a repeated
root of m(x), ie
(x −α)2 | m(x)
then
(x −α) | m′(x),
and so
(x −α) | d(x) = gcd(m(x), m′(x)).
But
d(x) | m(x)
and
1 ≤deg(d(x)) ≤d −1,
contradicting the irreducibility of m(x).
◀
2.3
Algebraic number ﬁelds
Proposition 2.5 Every subﬁeld K ⊂C contains the rationals Q:
Q ⊂K ⊂C.
Proof ▶By deﬁnition, 1 ∈K. Hence
n = 1 + · · · + 1 ∈K
for each integer n > 0.
By deﬁnition, K is an additive subgroup of C. Hence −1 ∈K; and so
−n = (−1)n ∈K
for each integer n > 0. Thus
Z ⊂K.
Finally, since K is a ﬁeld, each rational number
r = n
d ∈K
where n, d ∈Z with d ̸= 0.
◀
We can consider any subﬁeld K ⊂C as a vector space over Q.

374
2–4
Deﬁnition 2.4 An number ﬁeld (or more precisely, an algebraic number ﬁeld) is
a subﬁeld K ⊂C which is of ﬁnite dimension as a vector space over Q. If
dimQ = d
then K is said to be a number ﬁeld of degree d.
Proposition 2.6 There is a smallest number ﬁeld K containing the algebraic
numbers α1, . . . , αr.
Proof ▶Every intersection (ﬁnite or inﬁnite) of subﬁelds of C is a subﬁeld of C;
so there is a smallest subﬁeld K containing the given algebraic numbers, namely
the intersection of all subﬁelds containing these numbers. We have to show that
this ﬁeld is a number ﬁeld, ie of ﬁnite dimension over Q.
Lemma 2.1 Suppose K ⊂C is a ﬁnite-dimensional vector space over Q. Then
K is a number ﬁeld if and only if it is closed under multiplication.
Proof of Lemma ▷If K is a number ﬁeld then it is certainly closed under multi-
plication.
Conversely, if this is so then K is closed under addition and multiplication; so
we only have to show that it is closed under division by non-zero elements.
Suppose α ∈V, α ̸= 0. Consider the map
x 7→αx : V →V.
This is a linear map over Q; and it is injective since
αx = 0 =⇒x = 0.
Since V is ﬁnite-dimensional it follows that the map is surjective; in particular,
αx = α
for some x ∈V , ie
x = 1 ∈V.
Moreover
αx = 1
for some x ∈V , ie α is invertible. Hence V is a ﬁeld.
◁
Now suppose αi is of degree di (ie satisﬁes a polynomial equation of degree
di over Q). Consider the vector space (over Q)
V = ⟨αi1
1 · · · αir
r : 0 ≤i1 < d1, · · · , 0 ≤ir < dr⟩.
It is readily veriﬁed that
αiV ⊂V,

374
2–5
and so
V V ⊂V,
ie V is closed under multiplication.
It follows that V is a ﬁeld; and since any ﬁeld containing α1, . . . , αr must
contain these products, V is the smallest ﬁeld containing α1, . . . , αr. Moreover V
is a number ﬁeld since
dimQ V ≤d1 · · · dr.
◀
Deﬁnition 2.5 We denote the smallest ﬁeld containing α1, . . . , αr ∈C by Q(α1, . . . , αr).
Proposition 2.7 If α is an algebraic number of degree d then each element γ ∈
Q(α) is uniquely expressible in the form
a0 + a1α + · · · + ad−1αd−1
(a0, a1, . . . , ad−1 ∈Q).
Proof ▶It follows as in the proof of Proposition 2.6 that these elements do con-
stitute the ﬁeld Q(α). And if two of the elements were equal then α would satisfy
an equation of degree < d, which could be made monic by dividing by the leading
coefﬁcient.
◀
A number ﬁeld of the form K = Q(α), ie generated by a single algebraic
number α, is said to be simple. Our next result shows that, surprisingly, every
number ﬁeld is simple. The proof is more subtle than might appear at ﬁrst sight.
Proposition 2.8 Every number ﬁeld K can be generated by a single algebraic
number:
K = Q(α).
Proof ▶It is evident that
K = Q(α1, . . . , αr);
for if we successively adjoin algebraic numbers
αi+1 ∈K \ Q(α1, . . . , αr)
then
dim Q(α1) < dim Q(α1, α2) dim Q(α1, α2, α3) <
and so K must be attained after at most dimQ K adjunctions.
Thus it is sufﬁent to prove the result when r = 2, ie to show that, for any two
algebraic numbers α, β,
Q(α, β) = Q(γ).
Let p(x) be the minimal polynomial of α, and q(x) the minimal polynomial
of β. Suppose α1 = α, . . . , αm are the conjugates of α and β1 = β, . . . , βn the
conjugates of β. Let
γ = α + aβ,

374
2–6
where a ∈Q is chosen so that the mn numbers
αi + aβj
are all distinct. This is certainly possible, since
αi + aβj = αi′ + aβj′ ⇐⇒a = αi′ −αi
βj −βj′ .
Thus a has to avoid at most mn(mn −1)/2 values.
Since
α = γ −aβ,
and
p(α) = 0,
β satisﬁes the equation
p(γ −ax) = 0.
This is a polynomial equation over the ﬁeld k = Q(γ).
But β also satisﬁes the equation
q(x) = 0.
It follows that β satisﬁes the equation
d(x) = gcd(p(γ −ax), q(x)) = 0.
Now
(x −β) | d(x)
since β is a root of both polynomials. Also, since
d(x) | q(x) = (x −β1) · · · (x −βn),
d(x) must be the product of certain of the factors (x −βj). Suppose (x −βj) is
one such factor. Then βj is a root of p(γ −ax), ie
p(γ −aβj) = 0.
Thus
γ −aβj = αi
for some i. Hence
γ = αi + aβj.
But this implies that i = 1, j = 1, since we chose a so that the elements
αi + aβj
were all distinct.

374
2–7
Thus
d(x) = (x −β).
But if u(x), v(x) ∈k[x] then we can compute gcd(u(x), v(x)) by the eu-
clidean algorithm without leaving the ﬁeld k, ie
u(x), v(x) ∈k[x] =⇒gcd(u(x), v(x)) ∈k[x].
In particular, in our case
x −β ∈k = Q(γ).
But this means that
β ∈Q(γ);
and so also
α = γ −aβ ∈Q(γ).
Thus
α, β ∈Q(γ) =⇒Q(α, β) ⊂Q(γ) ⊂Q(α, β).
Hence
Q(α, β) = Q(γ).
◀
2.4
Algebraic integers
Deﬁnition 2.6 A number α ∈C is said to be an algebraic integer if it satisﬁes a
polynomial equation
f(x) = xn + a1xn−1 + · · · + an = 0
with integral coefﬁcients ai ∈Z. We denote the set of algebraic integers by ¯Z.
Proposition 2.9 The algebraic integers form a ring ¯Z with
Z ⊂¯Z ⊂¯Q.
Proof ▶Evidently
Z ⊂¯Z,
since n ∈Z satisﬁes the equation
x −n = 0.
We have to show that
α, β ∈¯Z =⇒α + β, αβ ∈¯Z.

374
2–8
Lemma 2.2 The number α ∈C is an algebraic integer if and only if there exists
a ﬁnitely-generated (but non-zero) additive subgroup S ⊂C such that
αS ⊂S.
Proof of Lemma ▷Suppose α ∈¯Z; and suppose the minimal polynomial of α is
m(x) = xd + a1xd−1 + · · · + ad,
where a1, . . . , ad ∈Z. Let S be the abelian group generated by 1, α, . . . , αd−1:
S = ⟨1, α, . . . , αd−1⟩.
Then it is readily veriﬁed that
αS ⊂S.
Conversely, suppose S is such a subgroup.
◁
If α is a root of the monic polynomial f(x) then −α is a root of the monic
polynomial f(−x). It follows that if α is an algebraic integer then so is −α. Thus
it is sufﬁcient to show that if α, β are algebraic integers then so are α + β, αβ.
Suppose α satisﬁes the equation
f(x) ≡xm + a1xm−1 + · · · + am = 0
(a1, . . . , am ∈Z),
and β the equation
g(x) ≡xn + b1xn−1 + · · · + bn = 0
(b1, . . . , bn ∈Z).
Consider the abelian group (or Z-module)
M = ⟨αiβj : 0 ≤i < m, 0 ≤j < n⟩
generated by the mn elements αiβj. Evidently
α + β, αβ ∈V.
As a ﬁnitely-generated torsion-free abelian group, M is isomorphic to Zd for
some d. Moreover M is noetherian, ie every increasing sequence of subgroups of
M is stationary: if
S1 ⊂S2 ⊂S3 · · · ⊂M
then for some N,
SN = SN+1 = SN+2 = · · · .
Suppose θ ∈M. Consider the increasing sequence of subgroups
⟨1⟩⊂⟨1, θ⟩⊂⟨1, θ, θ2⟩⊂· · · .
This sequence must become stationary; that is to say, for some N
θN ∈⟨1, θ, . . . , θN−1⟩.
In other words, θ satisﬁes an equation of the form
θN = a1θN−1 + a2θN−2 + · · · .
Thus every θ ∈M is an algebraic integer. In particular α+β and αβ are algebraic
integers.
◀

374
2–9
Proposition 2.10 A rational number c ∈Q is an algebraic integer if and only if
it is a rational integer:
¯Z ∩Q = Z.
Proof ▶Suppose c = m/n, where gcd(m, n) = 1; and suppose c satisﬁes the
equation
xd + a1xd−1 + · · · + ad = 0
(ai ∈Z).
Then
md + a1md−1n + · · · + adnd = 0.
Since n divides every term after the ﬁrst, it follows that n | md. But that is
incompatible with gcd(m, n) = 1, unless n = 1, ie c ∈Z.
◀
Proposition 2.11 Every algebraic number α is expressible in the form
α = β
n,
where β is an algebraic integer, and n ∈Z.
Proof ▶Let the minimal polynomial of α be
m(x) = xd + a1xd−1 + · · · + ad,
where a1, . . . , ad ∈Q. Let the lcm of the denominators of the ai be n. Then
bi = nai ∈Z
(1 ≤i ≤d).
Now α satisﬁes the equation
nxd + b1xd−1 + · · · + bd = 0.
It follows that
β = nα
satisﬁes the equation
xd + b1xd−1 + (nb2)xd−2 + · · · + (nd−1bd = 0.
Thus β is an integer, as required.
◀
The following result goes in the opposite direction.
Proposition 2.12 Suppose α is an algebraic integer. Then we can ﬁnd an alge-
braic integer β ̸= 0 such that
αβ ∈Z.

374
2–10
Proof ▶Let the minimal polynomial of α be
m(x) = xd + a1xd−1 + · · · + ad,
where a1, . . . , ad ∈Z. Recall that the conjugates of α,
α1 = α, . . . , αd
are the roots of the minimal equation.
Each of these conjugates is an algebraic integer, since its minimal equation
m(x) has integer coefﬁcients. Hence
β = α2 · · · αd
is an algebraic integer; and
αβ = α1α2 · · · αd = ±ad ∈Z.
◀
2.5
Units
Deﬁnition 2.7 A number α ∈C is said to be a unit if both α and 1/α are alge-
braic integers.
Any root of unity, ie any number satisfying xn = 1 for some n, is a unit.
But these are not the only units; for example,
√
2 −1 is a unit.
The units form a multiplicative subgroup of ¯Q×.
2.6
The Integral Basis Theorem
Proposition 2.13 Suppose A is a number ring. Then we can ﬁnd γ1, . . . , γd ∈A
such that each α ∈A is uniquely expressible in the form
α = c1γ1 + cdγd
with c1, . . . , cd ∈Z.
In other words, as an additive group
A ∼= Zd.
We may say that γ1, . . . , γd is a Z-basis for A.
Proof ▶Suppose A is the ring of integers in the number ﬁeld K. By Proposi-
tion 2.8,
K = Q(α).

374
2–11
By Proposition 2.12,
α = β
m,
where β ∈¯Z, m ∈Z. Since
Q(β) = Q(α),
we may suppose that α is an integer.
Let
m(x) = xd + a1xd−1 + · · · + ad
be the minimal polynomial of α; and let
α1 = α, . . . , αd
be the roots of this polynomial, ie the conjugates of α.
Note that these conjugates satisfy exactly the same set of polynomials over Q;
for
p(α) = 0 ⇐⇒m(x) | p(x) ⇐⇒p(αi) = 0.
Now suppose β ∈A. Then
β = b0 + b1α + · · · bd−1αd−1,
where b0, . . . , bd−1 ∈Q, say
β = f(α)
with f(x) ∈Q[x].
Let
βi = b0 + b1αi + · · · bd−1αd−1
i
for i = 1, . . . , d.
Each βi satisﬁes the same set of polynomials over Q as β. for
p(β) = 0 ⇐⇒p(f(α)) = 0 ⇐⇒p(f(αi)) = 0 ⇐⇒p(βi) = 0.
In particular, each βi has the same minimal polynomial as β, and so each βi is an
integer.
We may regard the formulae for the βi as linear equations for the coefﬁcients
b0, . . . , bd−1:
b0 + α1b1 + · · · αd−1bd−1 = β1,
. . .
b0 + αdb1 + · · · αd−1
d
bd−1 = βd.
We can write this as a matrix equation
D




b0
...
bd−1



=




β1
...
βd





374
2–12
where D is the matrix
D =




1
α1
. . .
αd−1
1
...
. . .
. . .
...
1
αd
. . .
αd−1
d
.




By a familiar argument,
det




1
x1
. . .
xd−1
1
...
. . .
. . .
...
1
xd
. . .
xd−1
d



=
Y
i<j
(xi −xj).
(The determinant vanishes whenever xi = xj since then two rows are equal.
Hence (xi −xj) is a factor for each pair i, j; from which the result follows on
comparing degrees and leading coefﬁcients.)
Thus
det D =
Y
i<j
(αi −αj).
In particular, det D is an integer.
On solving the equations for b0, . . . , bd−1 by Cramer’s rule, we deduce that
bi =
βi
det D,
where βi is a co-factor of the matrix D, and so a polynomial in α1, . . . , αd with
coefﬁcients in Z, and therefore an algebraic integer.
By Proposition 2.12, we can ﬁnd an integer δ such that
δ det D = n ∈Z,
where we may suppose that n > 0. Thus each bi is expressible in the form
bi = γi
n ,
where
γi ∈¯Z ∩Q = Z.
In other words, each β ∈A is expressible in the form
β = coδ0 + · · · + cd−1δd−1,
where
δi = αi
n
and
ci ∈Z
(0 ≤i < d).
The elements
coδ0 + · · · + cd−1δd−1
(ci ∈Z)
form a ﬁnitely-generated and torsion-free abelian group C, of rank d; and A is
a subgroup of C of ﬁnite index. We need the following standard result from the
theory of ﬁnitely-generated abelian groups.

374
2–13
Lemma 2.3 If
S ⊂Zd
is a subgroup of ﬁnite index then
S ∼= Zd
Proof of Lemma ▷We have to construct a Z-basis for S. We argue by induction
on d.
Choose an element
e = (e1, . . . , ed) ∈S
with least positive last coordinate ed. Suppose
s = (s1, . . . , sd) ∈S.
Then
sd = qe,
or we could ﬁnd an element of S with smaller last coordinate. Thus
s −qe = (t1, . . . , td−1, 0).
Hence
S = Ze ⊕T,
where
T = S ∩Zd−1
(identifying Zd−1 with the subgroup of Zd formed by the d-tuples with last coor-
dinate 0).
The result follows on applying the inductive hypothesis to T.
◁
The Proposition follows on applying the Lemma to
A ⊂C ∼= Zd.
◀
2.7
Unique factorisation in number rings
As we saw in Chapter 1, a principal ideal domain is a unique factorisation domain.
The converse is not true; there is unique factorisation in Z[x], but the ideal ⟨2, x⟩
is not principal. Our main aim in this Section is to show that the converse does
hold for number rings A:
A principal ideal domain ⇐⇒A unique factorisation domain.
We suppose throughout the Section that A is a number ring, ie the ring of
integers in a number ﬁeld K.

374
2–14
Proposition 2.14 Suppose a ⊂A is a non-zero ideal. Then the quotient-ring
A/a
is ﬁnite.
Proof ▶Take α ∈a, α ̸= 0. By Proposition 1.8, we can ﬁnd β ∈A, β ̸= 0 such
that
a = αβ ∈Z.
We may suppose that a > 0. Then
⟨a⟩⊂⟨α⟩⊂a.
Thus
α ≡β mod a =⇒α ≡β mod a.
By Proposition 2.13, A has an integral basis γ1, . . . , γd, ie each α ∈A is
(uniquely) expressible in the form
α = c1γ1 + · · · + cdγd
with c1, . . . , cd ∈Z. It follows that α is congruent moda to one of the numbers
r1γ1 + rdγd
(0 ≤ri < a).
Thus
∥A/⟨a⟩∥= ad.
Hence
∥A/a∥≤ad.
◀
Proposition 2.15 The number ring A is a unique factorisation domain if and only
if it is a principal ideal domain.
Proof ▶We know from Chapter 1 that
A principal ideal domain =⇒A unique factorisation domain.
We have to proce the converse.
Let us suppose therefore that the number ring A is a unique factorisation do-
main.
Lemma 2.4 Suppose
α = ϵπe1
1 · · · πer
r ,
β = ϵ′πf1
1 · · · πfr
r .
Let
δ = πmin(e1,f1)
1
· · · πmin(er,fr)
r
.
Then
δ = gcd(α, β)
in the sense that
δ | α, δ | β
and
δ′ | α, δ | β =⇒δ′ | δ.

374
2–15
Proof of Lemma ▷This follows at once from unique factorisation.
◁
Lemma 2.5 If
β1 ≡β2 mod α
then
gcd(α, β1) = gcd(α, β2).
Proof of Lemma ▷It is readily veriﬁed that if
β1 = β2 + αγ
then
δ | α, β1 ⇐⇒δ | α, β2.
◁
We say that α, β are coprime if
gcd(α, β) = 1.
It follows from the Lemma that we may speak of a congruence class ¯β mod α
being coprime to α.
Lemma 2.6 The congruence classes modα coprime to α form a multiplicative
group
(A/⟨α⟩)× .
Proof of Lemma ▷We have
gcd(α, β1β2) = 1 ⇐⇒gcd(α, β1) = 1, gcd(α, β2) = 1.
Thus (A/⟨α⟩)× is closed under multiplication; and if β is coprime to α then the
map
¯γ 7→¯β¯γ : (A/⟨α⟩)× →(A/⟨α⟩)×
is injective, and so surjective since A/⟨α⟩is ﬁnite. Hence (A/⟨α⟩)× is a group.
◁
Lemma 2.7 Suppose
gcd(α, β) = δ.
Then we can ﬁnd u, v ∈A such that
αu + βv = δ.

374
2–16
Proof of Lemma ▷We may suppose, on dividing by δ, that
gcd(α, β) = 1,
and so
¯β ∈(A/⟨α⟩)× .
Since this group is ﬁnite,
¯βn = 1
for some n > 0. In other words,
βn ≡1 mod α,
ie
βn = 1 + αγ,
ie
αu + βv = 1
with u = −γ, v = βn−1.
◁
We can extend the deﬁnition of gcd to any set (ﬁnite or inﬁnite) of numbers
αi ∈A
(i ∈I).
and by repeated application of the last Lemma we can ﬁnd βi (all but a ﬁnite
number equal to 0) such that
X
i∈I
αiβi = gcd
i∈I (αi).
Applying this to the ideal a, let
δ = gcd
α∈a(α).
Then
δ =
X
αiβi ∈a;
and so
a = ⟨δ⟩.
◀

Chapter 3
Quadratic Number Fields
3.1
The ﬁelds Q(√m)
Deﬁnition 3.1 A quadratic ﬁeld is a number ﬁeld of degree 2.
Recall that this means the ﬁeld k has dimension 2 as a vector space over Q:
dimQ k = 2.
Deﬁnition 3.2 The integer m ∈Z is said to be square-free if
m = r2s =⇒r = ±1.
Thus
±1, ±2, ±3, ±5, ±6, ±7, ±10, ±11, ±13, . . .
are square-free.
Proposition 3.1 Each quadratic ﬁeld is of the form Q(√m) for a unique square-
free integer m ̸= 1.
Recall that Q(√m) consists of the numbers
x + y√m
(x, y ∈Q).
Proof ▶Suppose k is a quadratic ﬁeld. Let α ∈k \ Q. Then α2, α, 1 are linearly
dependent over Q, since dimQ k = 2. In other words, α satisﬁes a quadratic
equation
a0α2 + a1α + a2 = 0
with a0, a1, a2 ∈Q. We may assume that a0, a1, a2 ∈Z. Then
α =
−a1 +
q
a2
1 −4a0a2
2a0
3–1

374
3–2
Thus
q
a2
1 −4a0a2 = 2a0α + a1 ∈k.
Let
a2
1 −4a0a2 = r2m
where m is square-free. Then
√m = 1
r
q
a2
1 −4a0a2 ∈k.
Thus
Q ⊂Q(√m) ⊂k.
Since dimQ k = 2,
k = Q(√m).
To see that different square-free integers m1, m2 give rise to different quadratic
ﬁelds, suppose
√m1 ∈Q(√m2),
say
m1 = x + y√m2
(x, y ∈Q)
Squaring,
m1 = x2 + m2y2 + 2xy√m2.
Thus either x = 0 or y = 0 or
√m2 ∈Q,
all of which are absurd.
◀
When we speak of the quadratic ﬁeld Q(√m) it is understood that m is a
square-free integer ̸= 1.
Deﬁnition 3.3 The quadratic ﬁeld Q(√m) is said to be real if m > 0, and imag-
inary if m < 0.
This is a natural deﬁnition since it means that Q(√m) is real if and only if
Q(√m) ⊂R.
3.2
Conjugates and norms
Proposition 3.2 The map
x + y√m 7→x −y√m
is an automorphism of Q(√m); and it is the only such automorphism apart from
the identity map.

374
3–3
Proof ▶The map clearly preserves addition. It also preserves multiplication, since
(x + y√m)(u + v√m = (xu + yvm) + (xv + yu)√m,
and so
(x −y√m)(u −v√m = (xu + yvm) −(xv + yu)√m.
Since the map is evidently bijective, it is an automorphism.
Conversely, if θ is an automorphism of Q(√m) then θ preserves the elements
of Q; in fact if α ∈Q(√m) then
θ(α) = α ⇐⇒α ∈Q.
Thus
θ(√m)2 = θ(m) = m =⇒θ(√m) = ±√m,
giving the identity automorphism and the automorphism above.
◀
Deﬁnition 3.4 If
α = x + y√m
(x, y ∈Q)
then we write
¯α = x −y√m
(x, y ∈Q)
and we call ¯α the conjugate of α.
Note that if Q(√m) is imaginary (ie m < 0) then the conjugate ¯α coincides
with the usual complex conjugate.
Deﬁnition 3.5 We deﬁne the norm ∥α∥of α ∈Q(√m) by
∥α∥= α¯α.
Thus if
α = x + y√m
(x, y ∈Q)
then
∥α∥= (x + y√m)(x −y√m) = x2 −my2.
Proposition 3.3
1. ∥α∥∈Q;
2. ∥(∥α = 0 ⇐⇒α = 0;
3. ∥αβ∥= ∥α∥∥β∥;
4. If a ∈Q then ∥a∥= a2;
5. If m < 0 then ∥α∥≥0.
Proof ▶All is clear except perhaps the third part, where
∥αβ∥= (αβ)(αβ)
= (αβ)(¯α¯β)
= (α¯α)(β ¯β)
= ∥α∥∥β∥.
◀

374
3–4
3.3
Integers
Proposition 3.4 Suppose k = Q(√m), where m ̸= 1 is square-free.
1. If m ̸≡1 mod 4 then the integers in k are the numbers
a + b√m,
where a, b ∈Z.
2. If m ≡1 mod 4 then the integers in k are the numbers
a
2 + b
2
√m,
where a, b ∈Z and
a ≡b mod 2,
ie a, b are either both even or both odd.
Proof ▶Suppose
α = a + b√m
( b ∈Q)
is an integer. Recall that an algebraic number α is an integer if and only if its
minimal polynomial has integer coefﬁcients. If y = 0 the minimal polynomial of
α is x −a. Thus α = a is in integer if and only if a ∈Z (as we know of course
since ¯Z ∩Q = Z).
If y ̸= 0 then the minimal polynomial of α is
(x −a)2 −mb2 = x2 −2ax + (a2 −mb2).
Thus α is an integer if and only if
2a ∈Z
and
a2 −mb2 ∈Z.
Suppose 2a = A, ie
a = A
2 .
Then
4a2 ∈Z, a2 −mb2 ∈Z =⇒4mb2 ∈Z
=⇒4b2 ∈Z
=⇒2b ∈Z
since m is square-free. Thus
b = B
2 ,
where B ∈Z.

374
3–5
Now
a2 −mb2 = A2 −mB2
4
∈Z,
ie
A2 −mB2 ≡0 mod 4.
If A is even then
2 | A =⇒4 | A2 =⇒4 | mB2 =⇒2 | B2 =⇒2 | B;
and similarly
2 | B =⇒4 | B2 =⇒4 | A2 =⇒2 | A.
Thus A, B are either both even, in which case a, b ∈Z, or both odd, in which case
A2, B2 ≡1 mod 4,
so that
1 −m ≡0 mod 4,
ie
m ≡1 mod 4.
Conversely if m ≡1 mod 4 then
A, B odd =⇒A2 −mB2 ≡0 mod 4
=⇒a2 −mb2 ∈Z.
◀
It is sometimes convenient to express the result in the following form.
Corollary 3.1 Let
ω =



√m
if m ̸≡1 mod 4,
1+√m
2
if m ≡1 mod 4.
Then the integers in Q(√m) form the ring Z[ω].
Examples:
1. The integers in the gaussian ﬁeld Q(i) are the gaussian integers
a + bi
(a, b ∈Z)

374
3–6
2. The integers in Q(
√
2) are the numbers
a + b
√
2
(a, b ∈Z).
3. The integers in Q(√−3) are the numbers
a + bω
(a, b ∈Z)
where
ω = 1 + √−3
2
.
Proposition 3.5 If α ∈Q(√m) is an integer then
∥α∥∈Z.
Proof ▶If α is an integer then so is its conjugate ¯α (since α, ¯α satisfy the same
polynomial equations over Q). Hence
∥α∥∈¯Z ∩Q = Z.
◀
3.4
Units
Proposition 3.6 An integer ϵ ∈Q(√m) is a unit if and only if
∥ϵ∥= ±1.
Proof ▶Suppose ϵ is a unit, say
ϵη = 1.
Then
∥ϵ∥∥η∥= ∥1∥= 1.
Hence
∥ϵ∥= ±1.
Conversely, suppose
∥ϵ∥= ±1,
ie
ϵ¯ϵ = ±1.
Then
ϵ−1 = ±¯ϵ
is an integer, ie ϵ is a unit.
◀

374
3–7
Proposition 3.7 An imaginary quadratic number ﬁeld contains only a ﬁnite num-
ber of units.
1. The units in Q(i) are ±1, ±i;
2. The units in Q(√−3) are ±1, ±ω, ±ω2, where ω = (1 + √−3)/2.
3. In all other cases the imaginary quadratic number ﬁeld Q(√m) (where
m < 0) has just two units, ±1.
Proof ▶We know of course that ±1 are always units.
Suppose
ϵ = a + b√m
is a unit. Then
N)ϵ) = a2 + (−m)b2 = 1
by Proposition 3.6. In particular
(−m)b2 ≤1.
If m ≡3 mod 4 then a, b ∈Z; and so b = 0 unless m = −1 in which case
b = ±1 is a solution, giving a = 0, ie ϵ = ±i.
If m ≡1 mod 4 then b may be a half-integer, ie b = B/2, and
(−m)b2 = (−m)B2/4 > 1
if B ̸= 0, unless m = −3 and B = ±1, in which case A = ±1. Thus we get four
additional units in Q(√−3), namely ±ω, ±ω2.
◀
Proposition 3.8 Every real quadratic number ﬁeld Q(√m) (where m > 0) con-
tains an inﬁnity of units. More precisely, there is a unique unit η > 1 such that the
units are the numbers
±ηn
(n ∈Z)
Proof ▶The following exercise in the pigeon-hole principle is due to Kronecker.
Lemma 3.1 Suppose α ∈R. There are an inﬁnity of integers m, n with m > 0
such that
|mα −n| < 1
n.
Proof of Lemma ▷Let {x} denote the fractional part of x ∈R. Thus
{x} = x −[x],
where [x] is the integer part of x.
Suppose N is a positive integer. Let us divide [0, 1) into N equal parts:
[0, 1/N), [1/N, 2/N), . . . , [(N −1)/N, 1).

374
3–8
Consider how the N + 1 fractional parts
{0}, {α}, {2α}, . . . , {Nα}
fall into these N divisions.
Two of the fractional parts — say {rα} and {sα}, where r < s — must fall
into the same division. But then
|{sα} −{rα}| < 1/N,
ie
|(sα −[sα]) −(rα −[rα])| < N.
Let
m = s −r, n = [sα] −[rα].
Then
|mα −n| < 1/N ≤1/m.
◁
Lemma 3.2 There are an inﬁnity of a, b ∈Z such that
|a2 −b2m| < 2√m + 1.
Proof of Lemma ▷We apply Kronecker’s Lemma above with α = √m. There are
an inﬁnity of integers a, b > 0 such that
|a −b√m| < 1/b.
But then
a < b√m + 1,
and so
a + b√m < 2b√m + 1
Hence
|a2 −b2m| = (a + b√m)|a −b√m|
< (2b√m + 1)/b
≤2√m + 1.
◁
It follows from this lemma that there are an inﬁnity of integer solutions of
a2 −b2m = d
for some
d < 2√m + 1.
But then there must be an inﬁnity of these solutions (a, b) with the same re-
mainders modd.

374
3–9
Lemma 3.3 Suppose
α1 = a1 + b1
√m, α2 = a2 + b2
√m,
where
a2
1 −b2
1 = d = a2
2 −b2
2
and
a1 ≡a2 mod d,
b1 ≡b2 mod d.
Then
α1
α2
is an algebraic integer.
Proof of Lemma ▷Suppose
a2 = a1 + mr, b2 = b1 + ms.
Then
α2 = α1 + dβ,
where
β = r + s√m.
Hence
α1
α2
= α1 ¯α2
α2 ¯α2
= α1 ¯α2
d
= α1( ¯α1 + d¯β)
d
= α1 ¯α1
d
+ ¯β
= d
d + β
= 1 + β,
which is an integer.
◁
Now suppose (a1, b1), (a2, b2) are two such solutions. Then
ϵ = α1
α2
is an integer, and
∥ϵ∥= ∥α1∥
∥α2∥= d
d = 1.
Hence ϵ is a unit, by Proposition 3.6.

374
3–10
Since there are an inﬁnity of integers α satisfying these conditions, we obtain
an inﬁnity of units if we ﬁx α1 and let α2 vary. In particular there must be a unit
ϵ ̸= ±1.
Just one of the four units
±ϵ, ±ϵ−1
must lie in the range (1, ∞). (The others are distributes one each in the ranges
(−∞, −1), (−1, 0) and (0, 1).)
Suppose then that
ϵ = a + b√m > 1.
Then
|ϵ−1| < 1,
and so
¯ϵ = ±ϵ−1 ∈(−1, 1),
ie
−1 < a −b√m < 1.
Adding these two inequalities,
0 < 2a,
ie
a > 0.
On the other hand,
ϵ > ¯ϵ =⇒b > 0.
It follows that there can only be a ﬁnite number of units in any range
1 < ϵ ≤c.
In particular, if ϵ > 1 is a unit, then there is a smallest unit η in the range
1 < η ≤ϵ.
Evidently η is the least unit in the range
1 < η.
Now suppose ϵ is a unit ̸= ±1. As we observed, one of the four units ±ϵ, ±ϵ−1
must lie in the range (1, ∞). We can take this in place of ϵ, ie we may assume that
ϵ > 1.

374
3–11
Since ηn →∞,
ηr ≤ϵ < ηr+1
for some r ≥1. Hence
1 ≤ϵη−r < η.
Since η is the smallest unit > 1, this implies that
ϵη−1 = 1,
ie
ϵ = ηr.
◀
3.5
Unique factorisation
Suppose A is an integral domain. Recall that if A is a principal ideal domain, ie
each ideal A ⊂A can be generated by a single element a,
a = ⟨a⟩,
then A is a unique factorisation domain, ie each a ∈A is uniquely expressible —
up to order, and equivalence of primes — in the form
a = ϵπe1
1 · · · πer
r ,
where ϵ is a unit, and π1, . . . , πr are inequivalent primes.
We also showed that if A is the ring of integers in an algebraic number ﬁeld k
then the converse is also true, ie
A principal ideal domain ⇐⇒A unique factorisation domain .
Proposition 3.9 The ring of integers Z[ω] in the quadratic ﬁeld Q(√m is a prin-
cipal ideal domain (and so a unique factorisation domain) if
m = −11, −7, −3, −2, −1, 2, 3, 5, 13.
Proof ▶We take
|∥α∥|
as a measure of the size of α ∈Z[ω].
Lemma 3.4 Suppose α, β ∈Z[ω[, with β ̸= 0. Then there exist γ, ρ ∈Z[ω] such
that
α = βγ + ρ
with
|∥ρ∥| < |∥β∥|.
In other words, we can divide α by β, and get a remainder ρ smaller than β.

374
3–12
Proof of Lemma ▷Let
α
β = x + y√m
where x, y ∈Q.
Suppose ﬁrst that m ̸≡1 mod 4. We can ﬁnd integers a, b such that
|x −a|, |y −b| ≤1
2.
Let
γ = a + b√m.
Then γ ∈Z[ω]; and
α
β −γ = (x −a) + (y −b)√m.
Thus
∥α
β −γ∥= (x −a)2 −m(y −b)2.
If now m < 0 then
0 ≤∥α
β −γ∥≤1 + m
4
,
yielding
|∥α
β −γ∥| < 1
if m = −2 or −1; while if m > 0 then
−m
4 ≤∥α
β −γ∥≤1
4,
yielding
|∥α
β −γ∥| < 1
if m = 2 or 3.
On the other hand, if m ≡1 mod 4 then we can choose a, b to be integers or
half-integers. Thus we can choose b so that
∥y −b∥≤1
4;
and then we can choose a so that
∥x −a∥≤1
2.
(Note that a must be an integer or half-integer according as b is an integer or
half-integer; so we can only choose a to within an integer.)
If m < 0 this gives
0 ≤∥α
β −γ∥≤4 + m
16
,

374
3–13
yielding
|∥α
β −γ∥| < 1
if m = −11, −7 or −3; while if m > 0 then
−m
16 ≤∥α
β −γ∥≤1
4,
yielding
|∥α
β −γ∥| < 1
if m = 5 or 13.
Thus in all the cases listed we can ﬁnd γ ∈Z[ω] such that
|∥α
β −γ∥| < 1
Multiplying by β,
|∥α −βγ∥| < |∥β∥|,
which gives the required result on setting
ρ = α −βγ,
ie
α = βγ + ρ.
◁
Now suppose a ̸= 0 is an ideal in Z[ω]. Let α ∈a (α ̸= 0) be an element
minimising |∥α∥|. (Such an element certainly exists, since |∥α∥| is a positive
integer.)
Now suppose β ∈a. By the lemma we can ﬁnd γ, ρ ∈Z[ω] such that
β = αγ + ρ
with
|∥ρ∥| < |∥α∥|.
But
ρ = β −αγ ∈a.
Thus by the minimality of |∥α∥|,
∥α∥= 0 =⇒ρ = 0
=⇒β = αγ
=⇒β ∈⟨α⟩.
Hence
a = ⟨α⟩.
◀
Remarks:

374
3–14
1. We do not claim that these are the only cases in which Q(√m) — or rather
the ring of integers in this ﬁeld — is a unique factorisation domain. There
are certainly other m for which it is known to hold; and in fact is not known
if the number of such m is ﬁnite or inﬁnite. But the result is easily estab-
lished for the m listed above.
2. On the other hand, unique factorisation fails in many quadratic ﬁelds. For
example, if m = −5 then
6 = 2 · 3 = (1 +
√
−5)(1 −
√
−5)
Now 2 is irreducible in Z[
√
5], since
a2 + 5b2 = 2
has no solution in integers. Thus if there were unique factorisation then
2 | 1 +
√
−5
or
2 | 1 −
√
−5,
both of which are absurd.
As an example of a real quadratic ﬁeld in which unique factorisation fails,
consider m = 10. We have
6 = 2 · 3 = (4 +
√
10)(4 −
√
10)
The prime 2 is again irreducible; for
a2 −10b2 = ±2
has no solution in integers, since neither ±2 is a quadratic residue mod
10. (The quadratic residues mod10 are 0, ±1, ±4, 5.) Thus if there were
unique factorisation we would have
2 | 4 +
√
10
or
2 | 4 −
√
10,
both of which are absurd.
3.6
The splitting of rational primes
Throughout n this section we shall assume that the integers Z[ω] in Q(√m) form
a principal ideal domain (and so a unique factorisation domain).
Proposition 3.10 Let p ∈N be a rational prime. Then p either remains a prime
in Z[ω], or else
p = ±π¯π,
where π is a prime in Z[ω]. In other words, p has either one or two prime factors;
and if it has two then these are conjugage.

374
3–15
Proof ▶Suppose
p = ϵπ1 · · · πr.
Then
∥π1∥· · · ∥πr∥= ∥p∥= p2.
Since ∥πi∥is an integer ̸= 1, it follows that either r = 1, ie p remains a prime, or
else r = 2 with
∥π1∥= ±p, ∥π2∥= ±p.
In this case, writing π for π1,
p = ±∥π∥= ±π¯π.
◀
We say that p splits in Q(√m) in the latter case, ie if p divides into two prime
factors in Z[ω]. We say that p ramiﬁes if these two prime factors are equal, ie if
p = ϵπ2,
Corollary 3.2 The rational prime p ∈N splits if and only if there is an integer
α ∈Z[ω] with
∥α∥= ±p.
Proposition 3.11 Suppose p ∈N is an odd prime with p ∤m. Then p splits in
Q(√m) if and only if m is a quadratic residue modp, ie if and only if
x2 ≡m mod p
for some x ∈Z.
Proof ▶Suppose
x2 ≡m mod p.
Then
(x −√m)(x + √m) = pq
for some q ∈Z.
If now p is prime in Z[ω] (where it is assumed, we recall, that there is unique
factorisation). Then
p | x −√m
or
p | x + √m,
both of which are absurd, since for example
p | x −√m =⇒x −√m = p(a + b√m)
=⇒pb = −1,
where b is (at worst) a half-integer.
◀
It remains to consider two cases, p | m and p = 2.

374
3–16
Proposition 3.12 If the rational prime p | m then p ramiﬁes in Q(√m).
Proof ▶We have
(√m)2 = m = pq,
for some q ∈Z. If p remains prime then
p | √m =⇒∥p∥| ∥√m∥
=⇒p2 | −m,
which is impossible, since m is square-free.
Hence
p = ±π¯π,
and
√m = πα
for some α ∈Z[ω]. Note that α cannot contain ¯π as a factor, since this would
imply that
p = ±π¯π | √m,
which as we have seen is impossible.
Taking conjugates
−√m = ¯π¯α.
Thus
¯π | √m.
Since the factorisation of √m is (by assumption) unique,
¯π ∼π,
ie p ramiﬁes.
◀
Proposition 3.13 The rational prime 2 remains prime in Z[ω] if and only if
m ≡5 mod 8.
Moreover, 2 ramiﬁes unless
m ≡1 mod 4.
Proof ▶We have dealt with the case where 2 | m, so we may assume that m is
odd.
Suppose ﬁrst that
m ≡3 mod 4.
In this case
(1 −√m)(1 + √m) = 1 −m = 2q.

374
3–17
If 2 does not split then
2 | 1 −√m
or
2 | 1 + √m,
both of which are absurd.
Thus
2 = ±π¯π,
where
π = a + b√m
(a, b ∈Z),
say. But then
¯π = a −b√m = π + 2b√m.
Since π | 2 is follows that
π | ¯π;
and similarly
¯π | π.
Thus
¯π = ϵπ,
where ϵ is a unit; and so 2 ramiﬁes.
Now suppose
m ≡1 mod 4.
Suppose 2 splits, say
a2 −mb2 = ±2,
where a, b are integers or half-integers. If a, b ∈Z then
a2 −mb2 ≡0, ±1 mod 4,
since a2, b2 ≡0 or 1 mod 4.
Thus a, b must be half-integers, say a = A/2, b = B/2, where A, B are odd
integers. In this case,
A2 −mB2 = ±8.
Hence
A2 −mB2 ≡0 mod 8
But
A2 ≡B2 ≡1 mod 8,
and so
A2 −mB2 ≡1 −m mod 8.
Thus the equation is insoluble if
m ≡5 mod 8,
ie 2 remains prime in this case.

374
3–18
Finally, if
m ≡1 mod 8
then
1 −√m
2
· 1 + √m
2
= 1 −m
4
= 2q.
If 2 does not split then
2 | 1 −√m
2
or
2 | 1 + √m
2
,
both of which are absurd.
Suppose
2 = ±π¯π,
where
π = A + B√m
2
,
with A, B odd; and
¯π = A −B√m
2
= π −B√m.
Thus
π | ¯π =⇒π | B√m
=⇒∥π∥| ∥B√m∥
=⇒±2 | B2m,
which is impossible since B, m are both odd. Hence 2 is unramiﬁed in this case.
◀
3.7
Quadratic residues
Deﬁnition 3.6 Suppose p is an odd rational prime; and suppose a ∈Z. Then the
Legendre symbol is deﬁned by
 a
p
!
=







0
if p | a
1
if p ∤a and a is a quadratic residue modp
−1
if a is a quadratic non-residue modp
Proposition 3.14 Suppose p is an odd rational prime; and suppose a, b ∈Z.
Then
 a
p
! b
p
!
=
 ab
p
!
.

374
3–19
Proof ▶The resul is trivial if p | a or p | b; so we may suppose that p ∤a, b.
Consider the group-homomorphism
θ : (Z/p)× →(Z/p)× : ¯x 7→¯x2.
Since
ker θ = {±1}
it follows from the First Isomorphism Theorem that
|im θ| = p −1
2
,
and so
(Z/p)×/ im θ ∼= C2 = {±1}.
The result follows, since
im θ = {¯a ∈(Z/p)× :
 a
p
!
= 1}.
◀
Proposition 3.15 Suppose p is an odd rational prime; and suppose a ∈Z. Then
a(p−1)/2 ≡
 a
p
!
mod p.
Proof ▶The resul is trivial if p | a; so we may suppose that p ∤a.
By Lagrange’s Theorem (or Fermat’s Little Theorem)
ap−1 ≡1 mod p.
Thus

a(p−1)/22 ≡1 mod p;
and so
a(p−1)/2 ≡±1 mod p.
Suppose a is a quadratic residue, say
a ≡b2 mod p.
Then
a
p−1
2
≡bp−1 ≡1 mod p.
Thus
 a
p
!
= 1 =⇒a
p−1
2
≡1 mod p.

374
3–20
As we saw in the proof of Proposition 3.14, exactly half, ie p−1
2 of the numbers
1, 2, . . . , p −1 are quadratic residues. On the other hand, the equation
x
p−1
2 −1 = 0
over the ﬁeld Fp = Z/(p) has at most p−1
2
roots. It follows that
 a
p
!
= 1 ⇐⇒a
p−1
2
≡1 mod p;
and so
 a
p
!
≡a
p−1
2
mod p;
◀
Corollary 3.3 If p ∈N is an odd rational prime then
 −1
p
!
=



1 if p ≡1 mod 4,
−1 if p ≡3 mod 4.
Proof ▶By the Proposition,
 −1
p
!
≡(−1)
p−1
2
mod p.
If
p ≡1 mod 4,
say
p = 4m + 1,
then
p −1
2
= 2m;
while if
p ≡3 mod 4,
say
p = 4m + 3,

374
3–21
then
p −1
2
= 2m + 1.
◀
It is sometimes convenient to take the remainder r ≡a mod p in the range
−p
2 < r < p
2.
We may say that a has negative remainder modp if
−p
2 < r < 0.
Thus 13 has negative remainder mod7, since
13 ≡−1 mod 7.
Proposition 3.16 Suppose p ∈N is an odd rational prime; and suppose p ∤a.
Then
 a
p
!
= (−1)µ,
where µ is the number of numbers among
1, 2a, . . . , p −1
2
a
with negative remainders.
Suppose, for example, p = 11, a = 7. Then
7 ≡−4, 14 ≡3, 21 ≡−1, 28 ≡−5, 35 ≡2 mod 11.
Thus
µ = 3.
Proof ▶Suppose
1 ≤r ≤p −1
2
.
Then just one of the numbers
a, 2a, . . . p −1
2
a
has remainder ±r.
For suppose
ia ≡r mod p,
ja ≡−r mod p.
Then
(i + j)a ≡0 mod p =⇒p | i + j

374
3–22
which is impossible since
1 ≤i + j ≤p −1.
It follows (by the Pigeon-Hole Principle) that just one of the congruences
ia ≡±r mod p
(1 ≤i ≤p −1
2
)
is soluble for each r.
Multiplying together these congruences,
a · 2a · · · p −1
2
a ≡(−1)µ1 · 2 · · · p −1
2
mod p,
ie
a
p−1
2 1 · 2 · · · p −1
2
≡(−1)µ1 · 2 · · · p −1
2
mod p,
and so
a
p−1
2
≡(−1)µ mod p.
Since
 a
p
!
≡a
p−1
2
mod p
by Proposition 3.15, we conclude that
 a
p
!
≡(−1)µ mod p.
◀
Proposition 3.17 If p ∈N is an odd rational prime then
 2
p
!
=



1 if p ≡±1 mod 8,
−1 if p ≡±3 mod 8.
Proof ▶Consider the numbers
2, 4, . . . , p −1.
The number 2i will have negative remainder if
p
2 < 2i < p,
ie
p
4 < i < p
2.

374
3–23
Thus the µ in Proposition 3.16 is given by
µ =
p
2

−
p
4

.
We consider p mod 8. If
p ≡1 mod 8,
say
p = 8m + 1,
then
p
2

= 4m,
p
4

= 2m,
and so
µ = 2m.
If
p ≡3 mod 8,
say
p = 8m + 3,
then
p
2

= 4m + 1,
p
4

= 2m,
and so
µ = 2m + 1.
If
p ≡5 mod 8,
say
p = 8m + 5,
then
p
2

= 4m + 2,
p
4

= 2m + 1,

374
3–24
and so
µ = 2m + 1.
If
p ≡7 mod 8,
say
p = 8m + 7,
then
p
2

= 4m + 3,
p
4

= 2m + 1,
and so
µ = 2m + 2.
◀
Corollary 3.4 If p ∈N is an odd rational prime then
 −2
p
!
=



1 if p ≡1 or 3 mod 8,
−1 if p ≡5 or 7 mod 8.
Proof ▶This follows from the Proposition and the Corollary to Proposition 3.15,
since
 −2
p
!
=
 −1
p
! 2
p
!
,
by Proposition 3.14.
◀
Proposition 3.18 If p ∈N is an odd rational prime then
 3
p
!
=



1 if p ≡±1 mod 12,
−1 if p ≡±5 mod 12.
Proof ▶If
0 < i < p
2
then
0 < 3i < 3p
2 .

374
3–25
Thus 3i has negative remainder if
p
2 < 3i < p,
ie
p
6 < i < p
3.
Thus
µ =
p
3

−
p
6

.
If
p ≡1 mod 6,
say
p = 6m + 1,
then
p
3

= 2m,
p
6

= m,
and so
µ = m.
If
p ≡5 mod 6,
say
p = 6m + 5,
then
p
3

= 2m + 1,
p
6

= m,
and so
µ = m + 1.
The result follows.
◀

374
3–26
Corollary 3.5 If p ∈N is an odd rational prime then
 −3
p
!
=



1 if p ≡1 mod 6,
−1 if p ≡5 mod 6.
Proof ▶This follows from the Proposition and the Corollary to Proposition 3.15,
since
 −3
p
!
=
 −1
p
! 3
p
!
,
by Proposition 3.14.
◀
Proposition 3.19 If p ∈N is an odd rational prime then
 5
p
!
=



1 if p ≡±1 mod 10,
−1 if p ≡±3 mod 10.
Proof ▶If
0 < i < p
2
then
0 < 5i < 5p
2 .
Thus 5i has negative remainder if
p
2 < 5i < p
or
3p
2 < i < 2p,
ie
p
10 < i < p
5
or
3p
10 < i < 2p
5 .
Thus
µ =
p
5

−
 p
10

+
2p
5

−
3p
10

.
If
p ≡1 mod 12,
say
p = 10m + 1,
then
p
5

= 2m,
 p
10

= m,
2p
5

= 4m,
3p
10

= 3m,
and so
µ = 2m.
The other cases are left to the reader.
◀

374
3–27
3.8
Gauss’ Law of Quadratic Reciprocity
Proposition 3.16 provides an algorithm for computing the Legendre symbol, as
illustrated in Propositions 3.17–3.19, perfectly adequate for our purposes. How-
ever, Euler discovered and Gauss proved a remarkable result which makes com-
putation of the symbol childishly simple. This result — The Law of Quadratic
Reciprocity — has been called the most beautiful result in Number Theory, so it
would be a pity not to mention it, even though — as we said — we do not really
need it.
Proposition 3.20 Suppose p, q ∈N are two distinct odd rational primes. Then
 q
p
! p
q
!
=



−1 if p ≡q ≡3 mod 4,
1 otherwise.
Another way of putting this is to say that
 q
p
! p
q
!
= (−1)
p−1
2
q−1
2 .
Proof ▶Let
S = {1, 2, . . . , p −1
2
}, T = {1, 2, . . . , q −1
2
}.
We shall choose remainders modp from the set
{−p
2 < i < p
2} = −S ∪{0} ∪S,
and remainders modq from the set
{−q
2 < i < q
2} = −T ∪{0} ∪T.
By Gauss’ Lemma (Proposition 3.16),
 q
p
!
= (−1)µ,
 p
q
!
= (−1)ν,
where
µ = ∥{i ∈S : qi mod p ∈−S}∥, ν = ∥{i ∈T : pi mod q ∈−T}∥.
By ‘qi mod p ∈−S’ we mean that there exists a j (necessarily unique) such
that
qi −pj ∈−S.
But now we observe that, in this last formula,
0 < i < p
2 =⇒0 < j < q
2.

374
3–28
Figure 3.1: p = 11, q = 7
The basic idea of the proof is to associate to each such contribution to µ the
‘point’ (i, j) ∈S × T. Thus
µ = ∥{(i, j) ∈S × T : −p
2 < qi −pj < 0}∥;
and similarly
ν = ∥{(i, j) ∈S × T : 0 < qi −pj < q
2}∥,
where we have reversed the order of the inequality on the right so that both for-
mulae are expressed in terms of (qi −pj).
Let us write [R] for the number of integer points in the region R ⊂R2. Then
µ = [R1], ν = [R2],
where
R1 = {(x, y) ∈R : −p
2 < qx−py < 0}, R2 = {(x, y) ∈R : 0 < qx−py < q
2},
and R denotes the rectangle
R = {(x, y) : 0 < x < p
2, 0 < y < p
2}.
The line
qx −py = 0
is a diagonal of the rectangle R, and R1, R2 are strips above and below the diago-
nal (Fig 3.8).
This leaves two triangular regions in R,
R3 = {(x, y) ∈R : qx −py < −p
2}, R4 = {(x, y) ∈R : qx −py > q
2}.
We shall show that, surprisingly perhaps, reﬂection in a central point sends the
integer points in these two regions into each other, so that
[R3] = [R4].
Since
R = R1 ∪R2 ∪R3 ∪R4,
it will follow that
[R1] + [R2] + [R3] + [R4] = [R] = p −1
2
q −1
2
,

374
3–29
ie
µ + ν + [R3] + [R4] = p −1
2
q −1
2
.
But if now [R3] = [R4] then it will follow that
µ + ν ≡p −1
2
q −1
2
mod 2,
which is exactly what we have to prove.
It remains to deﬁne our central reﬂection. Note that reﬂection in the centre
(p
4, q
4) of the rectangle R will not serve, since this does not send integer points into
integer points. For that, we must reﬂect in a point whose coordinates are integers
or half-integers.
We choose this point by “shrinking” the rectangle R to a rectangle bounded
by integer points, ie the rectangle
R′ = {1 ≤x ≤p −1
2
, 1 ≤y ≤q −1
2
}.
Now we take P to be the centre of this rectangle, ie
P = (p + 1
4
, q + 1
4
).
The reﬂection is then given by
(x, y) 7→(X, Y ) = (p + 1
−
x, q + 1
−y).
It is clear that reﬂection in P will send the integer points of R into themselves.
But it is not clear that it will send the integer points in R3 into those in R4, and
vice versa. To see that, let us shrink these triangles as we shrank the rectangle. If
x, y ∈Z then
qx −py < −p
2 =⇒qx −py ≤−p + 1
2
;
and similarly
qx −py > q
2 =⇒qx −py ≥q + 1
2
.
Now reﬂection in P does send the two lines
qx −py = −p + 1
2
, qx −py = q + 1
2
into each other; for
qX −pY = q(p + 1 −x) −p(q + 1 −y) = (q −p) −(qx −py),
and so
qx −py = −p + 1
2
⇐⇒qX −pY = (q −p) + p + 1
2
= q + 1
2
.

374
3–30
We conclude that
[R3] = [R4].
Hence
[R] = [R1] + [R2] + [R3] + [R4] ≡µ + ν mod 2,
and so
µ + ν ≡[R] = p −1
2
q −1
2
.
◀
Example: Take p = 37, q = 47. Then
 37
47
!
=
 47
37
!
since 37 ≡1 mod 4
=
 10
37
!
=
 2
37
! 5
37
!
= −
 5
37
!
since 37 ≡−3 mod 8
= −
 37
5
!
since 5 ≡1 mod 4
= −
 2
5
!
= −(−1) = 1.
Thus 37 is a quadratic residue mod47.
We could have avoided using the result for
 2
p
!
:
 10
37
!
=
 −27
37
!
=
 −1
37
! 3
37
!3
= (−1)18
 37
3
!
=
 1
3
!
= 1.
3.9
Some quadratic ﬁelds
We end by applying the results we have established to a small number of quadratic
ﬁelds.

374
3–31
3.9.1
The gaussian ﬁeld Q(i)
Proposition 3.21
1. The integers in Q(i) are the gaussian integers
a + bi
(a, b ∈Z)
2. The units in Z[i] are the numbers
±1, ±i.
3. The ring of integers Z[i] is a principal ideal domain (and so a unique fac-
torisation domain).
4. The prime 2 ramiﬁes in Z[i]:
2 = −i(1 + i)2.
The odd prime p splits in Z[i] if and only if
p ≡1 mod 4,
in which case it splits into two conjugate but inequivalent primes:
p = ±π¯π.
Proof ▶This follows from Propositions 3.4, 3.7, 3.9, 3.11–3.13, and the Corollary
to Proposition 3.15.
◀
Factorisation in the gaussian ﬁeld Q(i) gives interesting information on the
expression of a number as a sum of two squares.
Proposition 3.22 An integer n > 0 is expressible as a sum of two squares,
n = a2 + b2
(a, b ∈Z)
if and only if each prime p ≡3 mod 4 occurs to an even power in n.
Proof ▶Suppose
n = a2 + b2 = (a + bi)(a −bi).
Let
a + bi = ϵπe1
1 · · · πer
r .
Taking norms,
n = ∥a + bi∥= ∥π1∥e1 · · · ∥πr∥er.
Suppose
p ≡3 mod 4.
Then p remains prime in Z[i], by Proposition 3.21.

374
3–32
Suppose
pe ∥a + ib,
ie
pe | a + ib
but
pe+1 ∤a + ib.
Then
pe ∥a −ib,
since
a + ib = peα =⇒a −ib = pe¯α,
on taking conjugates. Hence
p2e ∥n = (a + ib)(a −ib),
ie p appears in n with even exponent.
We have shown, incidentally, that if p ≡3 mod 4 then
p2e ∥n = a2 + b2 =⇒pe | a, pe | b.
In other words, each expression of n as a sum of two squares
n = a2 + b2
is of the form
n = (pea′)2 + (peb′)2,
where
n
p2e = a′2 + b′2.
We have shown that each prime p ≡3 mod 4 must occur with even exponent
in n. Conversely, suppose that this is so.
Each prime p ≡1 mod 4 splits in Z[i], by Proposition 3.21, say
p = πpπp.
Also, 2 ramiﬁes in Z[i]:
2 = −i(1 + i)2.
Now suppose
n = 2e23e35e5 · · · ,
where e3, e7, e11, e19, . . . are all even, say
p ≡3 mod 4 =⇒ep = 2fp.

374
3–33
Let
α = α2α3α5 · · · ,
where
αp =







(1 + i)e2
if p = 2,
πep
p
if p ≡1 mod 4,
pfp
if p ≡3 mod 4.
Then
∥αp∥= pep
in all cases, and so
∥α∥=
Y
p
∥αp∥=
Y
p
pep = n.
Thus if
α = a + bi
then
n = a2 + b2.
◀
It’s worth noting that this argument actually gives the number of ways of ex-
pressing n as a sum of two squares, ie the number of solutions of
n = a2 + b2
(a, b ∈Z).
For the number of solutions is the number of integers α ∈Z[i] such that
n = ∥(∥α) = α¯α.
Observe that when p ≡1 mod 3 in the argument above we could equally well
have taken
αp = πr¯πs
for any r, s ≥0 with
r + s = ep.
There are just
ep + 1
ways of choosing αp in this way.
It follows from unique factorisation that the choice of the αp for p ≡1 mod 4
determines α up to a unit, ie the general solution is
α = ϵ(1 + i)e2
Y
p≡1 mod 4
αp
Y
p≡3 mod 4
pfp.
Since there are four units, ±1, ±i, we conclude that the number of ways of ex-
pressing n as a sum of two sqares is
4
Y
p≡1 mod 4
(ep + 1).

374
3–34
Note that in this calculation, each solution
n = a2 + b2
with
0 < a < b
gives rise to 8 solutions:
n = (±a)2 + (±b)2,
n = (±b)2 + (±a)2.
To these must be added solutions with a = 0 or with a = b. The former occurs
only if n = m2, giving 4 additional solutions:
n = 02 + (±m)2 = (±m)2 + 02;
while the latter occurs only if n = 2m2, again giving 4 additional solutions:
n = (±m)2 + (±m)2.
We conclude that the number of solutions with a, b ≥0 is



1
2
Q
p≡1 mod 4(ep + 1)
if n ̸= m2, 2m2
1
2
Q
p≡1 mod 4(ep + 1) + 1

if n = m2 or 2m2.
This is of course assuming that
p ≡3 mod 4 =⇒2 | ep,
without which there are no solutions.
In particular, each prime p ≡1 mod 4 is uniquely expressible as a sum of two
squares
n = a2 + b2
(0 < a < b),
eg
53 = 22 + 72.
As another example,
108 = 2233
cannot be expressed as a sum of two squares, since e3 = 3 is odd.
3.9.2
The ﬁeld Q(
√
3)
Proposition 3.23
1. The integers in Q(
√
3) are the numbers
a + b
√
3
(a, b ∈Z)

374
3–35
2. The units in Z[
√
3] are the numbers
±ηn
(n ∈Z),
where
η = 2 +
√
3.
3. The ring of integers Z[
√
3] is a principal ideal domain (and so a unique
factorisation domain).
4. The primes 2 and 3 ramify in Z[
√
3]:
2 = η−1(1 +
√
3)2,
3 = (
√
3)2.
The odd prime p ̸= 3 splits in Z[
√
3] if and only if
p ≡±1 mod 12,
in which case it splits into two conjugate but inequivalent primes:
p = ±π¯π.
Proof ▶This follows from Propositions 3.4, 3.8, 3.9, 3.11–3.13, and Proposi-
tion 3.18.
◀
3.9.3
The ﬁeld Q(
√
5)
Proposition 3.24
1. The integers in Q(
√
5) are the numbers
a + bω
(a, b ∈Z),
where
ω = 1 +
√
5
2
.
2. The units in Z[
√
5] are the numbers
±ωn
(n ∈Z).
3. The ring of integers Z[ω] is a principal ideal domain (and so a unique fac-
torisation domain).
4. The prime 5 ramiﬁes in Z[ω]:
5 = (
√
5)2.
The prime p ̸= 5 splits in Z[ω] if and only if
p ≡±1 mod 10,
in which case it splits into two conjugate but inequivalent primes:
p = ±π¯π.
Proof ▶This follows from Propositions 3.4, 3.8, 3.9, 3.11–3.13, and Proposi-
tion 3.19.
◀

Chapter 4
Mersenne and Fermat numbers
4.1
Mersenne numbers
Proposition 4.1 If
n = am −1
(a, m > 1)
is prime then
1. a = 2;
2. m is prime.
Proof ▶In the ﬁrst place,
(a −1) | (am −1);
so if a > 2 then n is certainly not prime.
Suppose m = rs, where r, s > 1. Evidently
(x −1) | (xs −1)
in Z[x]; explicitly
xs −1 = (x −1)(xs−1 + xs−2 + xs−3 + · · · + 1).
Subsitituting x = ar,
(ar −1) | (ars −1) = am −1.
Thus if am −1 is prime then m has no proper factors, ie m is prime.
◀
Deﬁnition 4.1 The numbers
Mp = 2p −1,
where p is prime, are called Mersenne numbers.
4–1

374
4–2
The numbers
M2 = 3, M3 = 7, M5 = 31, M7 = 127
are all prime. However,
M11 = 2047 = 23 · 89.
(It should be emphasized that Mersenne never claimed the Mersenne numbers
were all prime. He listed the numbers Mp for p ≤257, indicating which were
prime, in his view. His list contained several errors.)
The following heuristic argument suggests that there are probably an inﬁnity
of Mersenne primes. (Webster’s Dictionary deﬁnes ‘heuristic’ as: providing aid
or direction in the solution of a problem but otherwise unjustiﬁed or incapable of
justiﬁcation.)
By the Prime Number Theorem, the probability that a large number n is prime
is
≈
1
log n.
In this estimate we are including even numbers. Thus the probability that an odd
number n is prime is
≈
2
log n.
Thus the probability that Mp is prime is
≈
2
p log 2.
So the expected number of Mersenne primes is
≈
2
log 2
X 1
pn
where pn is the nth prime.
But — again by the Prime Number Theorem —
pn ≈n log n.
Thus the expected number of Mersenne primes is
≈
2
log 2
X
1
n log n = ∞,
since
X
1
n log n
diverges, eg by comparison with
Z X
1
x log x = log log X + C.

374
4–3
4.1.1
The Lucas-Lehmer test
Mersenne numbers are important because there is a simple test, announced by
Lucas and proved rigorously by Lehmer, for determining whether or not Mp is
prime. (There are many necessary tests for primality, eg if p is prime then
2p ≡2 mod p.
What is rare is to ﬁnd a necessary and sufﬁcient test for the primality of numbers
in a given class, and one which is moreover relatively easy to implement.) For this
reason, all recent “record” primes have been Mersenne primes.
We shall give two slightly different versions of the Lucas-Lehmer test. The
ﬁrst is only valid if p ≡3 mod 4, while the second applies to all Mersenne num-
bers. The two tests are very similar, and equally easy to implement. We are giving
the ﬁrst only because the proof of its validity is rather simpler. So it should be
viewed as an introduction to the second, and true, Lucas-Lehmer test.
Both proofs are based on arithmetic in quadratic ﬁelds: the ﬁrst in Q(
√
5), and
the second in Q(
√
3); and both are based on the following result.
Proposition 4.2 Suppose α is an integer in the ﬁeld Q(√m); and suppose P is
an odd prime with P ∤m. Then
αP ≡











α
if
 P
m
!
= 1,
¯α
if
 P
m
!
= −1.
Proof ▶Suppose
α = a + b√m,
where a, b are integers if m ̸≡1 mod 4, and half-integers if m ≡1 mod 4.
In fact these cases do not really differ; for 2 is invertible modP, so we may
consider a as an integer modP if 2a ∈Z. Thus
αP ≡aP +
 P
1
!
aP−1b√m +
 P
2
!
aP−2bm + · · · + bPm
P −1
2 √m mod P.
Now
P |
 P
r
!
if 1 ≤r ≤P −1. Hence
αP ≡aP + bPm
P −1
2 √m mod P
By Fermat’s Little Theorem,
aP ≡a mod P, bP ≡b mod P.

374
4–4
Also
m
P −1
2
≡
 m
P
!
mod P,
by Proposition 3.15. Thus
αP ≡a + b
 P
m
!√m mod P,
ie
 m
P
!
= 1 =⇒αP ≡α mod P,
 m
P
!
= −1 =⇒αP ≡¯α mod P.
◀
Corollary 4.1 For all integers α in Q(√m,
αP 2 ≡α mod P.
We may regard this as the analogue of Fermat’s Little Theorem
aP ≡a mod P
for quadratic ﬁelds.
There is another way of establishing this result, which we shall sketch brieﬂy.
It depends on considering the ring
A = Z[ω]/(P).
formed by the remainders
α mod P
of integers α in Q(√m).
There are P 2 elements in this ring, since each α ∈Z[ω] is congruent modP
to just one of the numbers
a + b√m
where a, b ∈Z and
0 ≤a, b < P.
There are no nilpotent elements in the ring A if P ∤m; for if α = a + b√m
then
P | α2 =⇒P | 2ab, P | a2 + b2m
=⇒P | a, b.
Thus
α2 ≡0 mod P =⇒α ≡0 mod P,

374
4–5
from which it follows that, if n > 0,
αn ≡0 mod P =⇒α ≡0 mod P,
A ring without non-zero nilpotent elements is said to be semi-simple. It is not
hard to show that a ﬁnite semi-simple commutative ring is a direct sum of ﬁelds.
Now there is just one ﬁeld (up to isomorphism) containing pe elements for
each prime power pe, namely the galois ﬁeld GF(pe). It follows that either
1. Z[ω]/(P) ∼= GF(P 2); or
2. Z[ω]/(P) ∼= GF(P) ⊕GF(P).
The non-zero elements in GF(pe) form a multiplicative group GF(pe)× with
pe −1 elements. It follows from Legendre’s Theorem that
a ̸= 0 =⇒ape−1 = 1
in GF(pe). Hence
ape = a
for all a ∈GF(pe).
Thus in the ﬁrst case,
αP 2 ≡α
for all α ∈Z[ω]/(P); while in the second case we even have
αP ≡α
for all α ∈Z[ω]/(P), since this holds in each of the constituent ﬁelds.
In the ﬁrst case we can go further. The galois ﬁeld GF(pe) is of characteristic
p, ie
pa = a + · · · a = 0,
for all ainGF(pe). Also, the map
a 7→ap
is an automorphism of GF(pe). (This follows by essentially the same argument
that we used above to show that αP ≡α or ¯α above.)
In particular, the map
α 7→αP mod P
is an automorphism of our ﬁeld
Z[ω]/(P).
On the other hand, the map
α 7→¯α

374
4–6
is also an automorphism of Z[ω]/(P), since
P | α =⇒P | ¯α.
Moreover, this is the only automorphism of Z[ω]/(P) apart from the identity map,
since any automorphism must send
√m mod P 7→±√m mod P.
The automorphism
α 7→αP
mod P
is not the identity map, since the equation
xP −x = 0
has at mos P solutions in the ﬁeld Z[ω]/(P). We conclude that
αP ≡¯α mod P.
If Z[ω] is a principal ideal domain the second case arises if and only if P splits,
which by Proposition 3.14 occurs when
 m
P
!
= 1.
Explicitly, if
P = π1π2,
then
Z[ω]/(P) ∼= Z[ω]/(π1) ⊕Z[ω]/(π2)
∼= GF(P) ⊕GF(P).
Proposition 4.3 Suppose p ≡3 mod 4. Let the sequence rn be deﬁned by
r1 = 3,
rn+1 = r2
n −2.
Then Mp is prime if and only if
Mp | rp−1.
Proof ▶We work in the ﬁeld Q(
√
5). By Proposition 3.4, the integers in this ﬁeld
are the numbers
a + bω
(a, b ∈Z)
where
ω = 1 +
√
5
2
.
By Proposition 3.9, there is unique factorisation in the ring of integers Z[ω].

374
4–7
Lemma 4.1 If rn is the sequence deﬁned in the Proposition then
rn = ω2n + ω−2n
for each n ≥1.
Proof of Lemma ▷Let us set
sn = ω2n + ω−2n
for n ≥0. Then
s2
n =

ω2n + ω−2n2
= ω2n+1 + 2 + ω−2n+1
= sn+1 + 2,
ie
sn+1 = s2
n −2.
Also
s0 = ω + ω−1
= ω −¯ω
=
√
5,
and so
s1 = s2
0 −2 = 3.
We conclude that
rn = sn = ω2n + ω−2n
for all n ≥1.
◁
Let us suppose ﬁrst that Mp is prime. Let us write P = Mp.
Lemma 4.2 We have
 5
P
!
= −1.
Proof of Lemma ▷Since
24 ≡1 mod 5
it follows that
2p ≡23 mod 5
≡3 mod 5.

374
4–8
Hence
P = 2p −1 ≡2 mod 5;
and so, by Proposition 3.19,
 5
P
!
= −1.
◁
It follows from this Lemma and Proposition 4.2 that
αP ≡¯α mod P
for all α ∈Z[ω]. In particular,
ωP ≡¯ω mod P.
Hence
ωP+1 ≡ω¯ω mod P
≡∥ω∥mod P
≡−1 mod P.
In other words,
ω2p ≡−1 mod P.
Thus
ω2p + 1 ≡0 mod P.
Dividing by ω2p−1,
ω2p−1 + ω−2p−1 ≡0 mod P,
ie
rp−1 ≡0 mod P.
Conversely, suppose P is a prime factor of Mp. Then
Mp | rp−1 =⇒rp−1 ≡0 mod P
=⇒ω2p−1 + ω−2p−1 ≡0 mod P
=⇒ω2p + 1 ≡0 mod P
=⇒ω2p ≡−1 mod P.
But this implies that the order of ω mod P is 2p+1. For
ω2p+1 = (ω2p)2 ≡1 mod P,
so if the order of ω mod P is d then
d | 2p+1 =⇒d = 2e

374
4–9
for some e ≤p + 1; and if e ≤p then
ω2p ≡1 mod P.
On the other hand, by the Corollary to Proposition 4.2,
ωP 2 ≡ω mod P =⇒ωP 2−1 ≡1 mod P.
Hence
2p+1 | P 2 −1 = (P + 1)(P −1).
Now
gcd(P + 1, P −1) = 2.
It follows that
2p | P + 1
or
2p | P −1.
The latter is impossible since
2p > Mp ≥P > P −1;
while
2p | P + 1 =⇒2p ≤P + 1 =⇒Mp = 2p −1 ≤P =⇒P = Mp.
◀
Now for the ‘true’ Lucas-Lehmer test. As we shall see, the proof is a little
harder, which is why we gave the earlier version.
Proposition 4.4 Let the sequence rn be deﬁned by
r1 = 4,
rn+1 = r2
n −2.
Then Mp is prime if and only if
Mp | rp−1.
Proof ▶We work in the ﬁeld Q(
√
3). By Proposition 3.4, the integers in this ﬁeld
are the numbers
a + b
√
3
(a, b ∈Z).
By Proposition 3.9, there is unique factorisation in the ring of integers Z[
√
3].
We set
η = 1 +
√
3,
ϵ = 2 +
√
3.
Lemma 4.3 The units in Z[
√
3] are the numbers
±ϵn
(n ∈N).

374
4–10
Proof of Lemma ▷It is sufﬁcient, by Proposition 3.8, to show that ϵ is the smallest
unit > 1. And from the proof of that Proposition, we need only consider units of
the form
a + b
√
3
with a, b ≥0.
Thus the only possible units in the range (1, ϵ) are
√
3 and 1+
√
3 = η, neither
of which is in fact a unit, since
∥
√
3∥= −3, ∥η∥= −2,
whereas a unit must have norm ±1, by Proposition 3.6.
◁
Lemma 4.4 If rn is the sequence deﬁned in the Proposition then
rn = ϵ2n−1 + ϵ−2n−1
for each n ≥1.
Proof of Lemma ▷Let us set
sn = ϵ2n−1 + ϵ−2n−1
for n ≥1. Then
s2
n =

ϵ2n−1 + ϵ−2n−12
= ϵ2n + 2 + ϵ−2n
= sn+1 + 2,
ie
sn+1 = s2
n −2.
Also
s1 = ϵ + ϵ−1
= ϵ + ¯ϵ
= 4.
We conclude that
rn = sn = ϵ2n−1 + ϵ−2n−1
for all n ≥1.
◁
Suppose ﬁrst that P = Mp is prime.
Lemma 4.5 We have
 3
P
!
= −1.

374
4–11
Proof of Lemma ▷We have
Mp = 2p −1
≡(−1)p −1 mod 3
≡−1 −1 mod 3
≡1 mod 3;
while
Mp ≡−1 mod 4.
By the Chinese Remainder Theorem there is just one remainder mod12 with
these remainders mod3 and mod4; and that is 7 ≡−5 mod 12. For any odd
prime p,
Mp ≡7 mod 12
Hence
 3
P
!
= −1.
by Proposition 3.18,
◁
It follows from this Lemma and Proposition 4.2 that
αP ≡¯α mod P
for all α ∈Z[
√
3]. In particular,
ϵP ≡¯ϵ mod P.
Hence
ϵP+1 ≡ϵ¯ϵ mod P
≡∥ϵ∥mod P
≡1 mod P.
In other words,
ϵ2p ≡1 mod P.
It follows that
ϵ2p−1 ≡± mod P.
We want to show that in fact
ϵ2p−1 ≡−1 mod P.
This is where things get a little trickier than in the ﬁrst version of the Lucas-
Lehmer test. In effect, we need a number with negative norm. To this end we
introduce
η = 1 +
√
3.
Lemma 4.6
1. ∥η∥= −2.

374
4–12
2. η2 = 2ϵ.
Proof of Lemma ▷This is a matter of simple veriﬁcation:
∥η∥= 1 −3 = −2,
while
η2 = (1 +
√
3)2
= 4 + 2
√
3
= 2ϵ.
◁
By Proposition /refMersenneLemma,
ηP ≡¯η mod P,
and so
ηP+1 ≡η¯η −2 mod P,
ie
η2p ≡−2 mod P.
By the Lemma, this can be written
(2ϵ)2p−1 ≡−2 mod P,
ie
22p−1ϵ2p−1 ≡−2 mod P,
But by Proposition 3.14,
2
P −1
2
= 22p−1−1 ≡
 2
P
!
mod P
≡1 mod P,
by Proposition 3.17, since
P = 2p −1 ≡−1 mod 8.
Thus
22p−1 ≡2 mod P

374
4–13
and so
2ϵ2p−1 ≡−2 mod P.
Hence
ϵ2p−1 ≡−1 mod P.
Thus
ϵ2p−1 + 1 ≡0 mod P.
Dividing by ϵ2p−2,
ϵ2p−2 + ϵ−2p−2 ≡0 mod P,
ie
rp−1 ≡0 mod P.
Conversely, suppose P is a prime factor of Mp. Then
Mp | rp−1 =⇒rp−1 ≡0 mod P
=⇒ϵ2p−2 + ϵ−2p−2 ≡0 mod P
=⇒ϵ2p−1 + 1 ≡0 mod P
=⇒ϵ2p−1 ≡−1 mod P.
But (by the argument we used in the proof of the ﬁrst Lucas-Lehmer test) this
implies that the order of ϵ mod P is 2p.
On the other hand, by the Corollary to Proposition 4.2,
ϵP 2 ≡ϵ mod P =⇒ϵP 2−1 ≡1 mod P.
Hence
2p | P 2 −1 = (P + 1)(P −1).
Now
gcd(P + 1, P −1) = 2.
It follows that
2p−1 | P + 1
or
2p−1 | P −1.
In either case,
2p−1 ≤P + 1 =⇒P ≥2p−1 −1 = Mp −1
2
=⇒P ≥Mp
3
=⇒Mp
P
< 3.
Since Mp is odd, this implies that
P = Mp,
ie Mp is prime.
◀

374
4–14
4.1.2
Perfect numbers
Mersenne numbers are also of interest because of their intimate connection with
perfect numbers.
Deﬁnition 4.2 For n ∈N, n > 0 we denote the number of divisors of n by d(n),
and the sum of these divisors by σ(n).
Example: Since 12 has divisors 1, 2, 3, 4, 6, 12,
d(12) = 6, σ(12) = 28.
Deﬁnition 4.3 The number n ∈N is said to be perfect if
σ(n) = 2n,
ie if n is the sum of its proper divisors.
Example: The number 6 is perfect, since
6 = 1 + 2 + 3.
Proposition 4.5 If
Mp = 2p −1
is a Mersenne prime then
2p−1(2p −1)
is perfect.
Conversely, every even perfect number is of this form.
Proof ▶In number theory, a function f(n) deﬁned on {n ∈N : n > 0} is said to
be multiplicative if
gcd(m, n) = 1 =⇒f(mn) = f(m)f(n).
If the function f(n) is multiplicative, and
n = pe1
1 · · · per
r
then
f(n) = f(pe1
1 ) · · · f(per
r ).
Thus the function f(n) is completely determined by its value f(pe) for prime
powers.

374
4–15
Lemma 4.7 The functions d(n) and σ(n) are both multiplicative.
Proof of Lemma ▷Suppose gcd(m, n) = 1; and suppose
d | mn.
Then d is uniquely expressible in the form
d = d1d2
(d1 | m, d2 | n).
In fact
d1 = gcd(d, m), d2 = gcd(d, n).
It follows that
d(mn) = d(m)d(n);
and
σ(mn) =
X
d|mn
d
=
X
d1|m
d1
X
d2|n
d2
= σ(m)σ(n).
◁
Now suppose
n = 2p−1Mp
where Mp is prime. Since Mp is odd,
gcd(2p−1, Mp) = 1.
Hence
σ(n) = σ(2p−1)σ(Mp).
If P is prime then evidently
σ(P) = 1 + P.
On the other hand,
σ(P e) = 1 + P + P 2 + · · · + P e = P e+1 −1
P −1 .
In particular,
σ(2e) = 2e+1 −1.
Thus
σ(2p−1) = 2p −1 = Mp,

374
4–16
while
σ(Mp) = Mp + 1 = 2p.
We conclude that
σ(n) = 2pMp = 2n.
Conversely, suppose n is an even perfect number. We can write n (uniquely)
in the form
n = 2em
where m is odd. Since 2e and m are coprime,
σ(n) = σ(2e)σ(m) = (2e+1 −1)σ(m).
On the other hand, if n is perfect then
σ(n) = 2n = 2e+1m.
Thus
2e+1 −1
2e+1
=
m
σ(m).
The numerator and denominator on the left are coprime. Hence
m = d(2e+1 −1), σ(m) = d2e+1,
for some d ∈N.
If d > 1 then m has at least the factors 1, d, m. Thus
σ(m) ≥1 + d + m = 1 + d2e+1,
contradicting the value for σ(m) we derived earlier.
It follows that d = 1. But then
σ(m) = 2e+1 = m + 1.
Thus the only factors of m are 1 and m, ie
m = 2e+1 −1 = Me+1
is prime. Setting e + 1 = p, we conclude that
n = 2p−1Mp,
where Mp is prime.
◀
It is an unsolved problem whether or not there are any odd perfect numbers.
The ﬁrst 4 even perfect numbers are
21M2 = 6, 22M3 = 28, 24M5 = 496, 26M7 = 8128.
(In fact these are the ﬁrst 4 perfect numbers, since it is known that any odd perfect
number must have at least 300 digits!)

374
4–17
4.2
Fermat numbers
Proposition 4.6 If
n = am + 1
(a, m > 1)
is prime then
1. a2 is even;
2. m = 2e.
Proof ▶If a is odd then n is even and > 2, and so not prime.
Suppose m has an odd factor, say
m = rs,
where r is odd. Since xr + 1 = 0 when x = −1, it follows by the Remainder
Theorem that
(x + 1) | (xr + 1).
Explicitly,
xr + 1 = (x + 1)(xr−1 −xr−2 + · · · −x + 1).
Substituting x = ys,
(ys + 1) | (ym + 1)
in Z[x]. Setting y = a,
(as + 1) | (ars + 1) = (am + 1).
In particular, am + 1 is not prime.
Thus if am + 1 is prime then m cannot have any odd factors. In other words,
m = 2e.
◀
Deﬁnition 4.4 The numbers
Fn = 22n + 1
(n = 0, 1, 2, . . . )
are called Fermat numbers.
Fermat hypothesized — he didn’t claim to have a proof — that all the numbers
F0, F1, F2, . . .
are prime. In fact this is true for
F0 = 3, F1 = 5, F2 = 17, F3 = 257, F4 = 65537.

374
4–18
However, Euler showed in 1747 that
F5 = 232 + 1 = 4294967297
is composite. In fact, no Fermat prime beyond F4 has been found.
The heuristic argument we used above to suggest that the number of Mersenne
primes is probably inﬁnite now suggests that the number of Fermat primes is
probably ﬁnite.
For by the Prime Number Theorem, the probability of Fn being prime is
≈2/ log Fn
≈2 · 2−n.
Thus the expected number of Fermat primes is
2 ≈
X
2−n = 4 < ∞.
This argument assumes that the Fermat numbers are “independent”, as far as
primality is concerned. It might be argued that our next result shows that this is
not so. However, the Fermat numbers are so sparse that this does not really affect
our heuristic argument.
Proposition 4.7 The Fermat numbers are coprime, ie
gcd(Fm, Fn) = 1
if m ̸= n.
Proof ▶Suppose
gcd(Fm, Fn) > 1.
Then we can ﬁnd a prime p (which must be odd) such that
p | Fm, p | Fn.
Now the numbers {1, 2, . . . , p −1} form a group (Z/p)× under multiplication
modp. Since p | Fm,
22m ≡−1 mod p.
It follows that the order of 2 mod p (ie the order of 2 in (Z/p)×) is exactly 2m+1.
For certainly
22m+1 = (22m)2 ≡1 mod p;
and so the order of 2 divides 2m+1, ie it is 2e for some e ≤m + 1. But if e ≤m
then
22m ≡1 mod p,
whereas we just saw that the left hand side was ≡−1 mod p. We conclude that
the order must be 2m+1.

374
4–19
But by the same token, the order is also 2n+1. This is a contradiction, unless
m = n.
◀
We can use this result to give a second proof of Euclid’s Theorem that there
are an inﬁnity of primes.
Proof ▶Each Fermat number Fn has at least one prime divisor, say qn. But by the
last Proposition, the primes
q0, q1, q2, . . .
are all distinct.
◀
We end with a kind of pale imitation of the Lucas-Lehmer test, but now applied
to Fermat numbers.
Proposition 4.8 The Fermat number
Fn = 22n + 1
is prime if and only if
3
Fn−1
2
≡−1 mod Fn.
Proof ▶Suppose P = Fn is prime.
Lemma 4.8 We have
Fn ≡5 mod 12.
Proof of Lemma ▷Evidently
Fn ≡1 mod 4;
while
Fn ≡(−1)2n + 1 mod 3
≡2 mod 3.
By the Chinese Remainder Theorem these two congruences determine Fn mod
12; and observation shows that
Fn ≡5 mod 12.
◁
It follows from this Lemma, and Proposition 3.18, that
 3
P
!
= −1.
Hence
3
P −1
2
≡−1 mod P

374
4–20
by Proposition 3.14.
Conversely, suppose
3
Fn−1
2
≡−1 mod Fn;
and suppose P is a prime factor of Fn. Then
3
Fn−1
2
≡−1 mod P,
ie
322n−1 ≡−1 mod P.
It follows (as in the proof of the Lucas-Lehmer theorems) that the order of 3 mod
P is
22n.
But by Fermat’s Little Theorem,
3P−1 ≡1 mod P.
Hence
22n | P −1,
ie
Fn −1 | P −1.
Since P | Fn this implies that
Fn = P,
ie Fn is prime.
◀
This test is more-or-less useless, even for quite small n, since it will take an
inordinate time to compute the power, even working modulo Fn. However, it does
give a short proof — which we leave to the reader — that F5 is composite.
It may be worth noting why this test is simpler than its Mersenne analogue.
In the case of Mersenne primes P = Mp we had to introduce quadratic ﬁelds
because the analogue of Fermat’s Little Theorem,
αP 2−1 ≡1 mod P,
then allowed us to ﬁnd elements of order P +1 = 2p. In the case of Fermat primes
P = Fn Fermat’s Little Theorem
aP−1 = a22n
≡1 mod P
sufﬁces.

Chapter 5
Primality
5.1
The Fermat test
Suppose p is an odd prime; and suppose gcd(a, p) = 1, ie p ∤a. Then
ap−1 ≡1 mod p
by Fermat’s Little Theorem.
Deﬁnition 5.1 Suppose n is an odd number > 1. Then we say that n is a pseudo-
prime to base a (or an a-pseudoprime) if
an−1 ≡1 mod n.
Fermat’s Little Theorem can be restated as
Proposition 5.1 If n is an odd prime then it is a pseudoprime to all bases a co-
prime to n.
This provides a necessary test for primality, which we may call the Fermat
test.
It is reasonable to suppose that if we perform the test repeatedly with coprime
bases then the results will be independent; so each success will increase the prob-
ability that n is prime — while a failure of course will prove that n is composite.
Unfortunately, there is a ﬂaw in this argument. The test may succeed for all
bases coprime to n even if n is composite.
5.2
Carmichael numbers
Deﬁnition 5.2 Suppose n is an odd number > 1. Then we say that n is a Carmichael
number if n is not a prime, but is a pseudoprime to all bases a coprime to n, ie
gcd(a, n) = 1 =⇒an−1 ≡1 mod n.
5–1

374
5–2
Recall the deﬁnition of Euler’s function φ(n): for n ≥1,
φ(n) = ∥{1 ≤i ≤n : gcd(i, n) = 1}∥,
ie φ(n) is the number of congruence classes modn coprime to n:
Thus
φ(1) = 1, φ(2) = 1, φ(3) = 2, φ(4) = 2, φ(5) = 4, φ(6) = 2, . . . .
Euler’s function is multiplicative in the number-theoretic sense:
gcd(m, n) = 1 =⇒φ(mn) = φ(m)φ(n).
For according to the Chinese Remainder Theorem, each pair of remainders a mod
m, b mod n determines a unique remainder c mod mn; and it is easy to see that
gcd(c, mn) = 1 ⇐⇒gcd(a, m) = 1 and gcd(b, n) = 1.
If p is a prime then
φ(pe) = pe−1(p −1).
For i is coprime to pe unless p | i. Thus all the numbers i ∈[1, pe] are coprime to
pe except for the pe−1 multiples of p. Hence
φ(pe) = pe −pe−1 = pe−1(p −1).
Putting together these results, we see that if
n = pe1
1 · · · per
r
then
φ(n) = pe1−1
1
(p1 −1) · · · per−1
r
(pr −1).
The congruence classes mod n form a ring Z/(n) with n elements ¯0, ¯1, . . . , n −1.
The invertible elements (or units) in this ring form a multiplicative group
(Z/n)×.
The importance of Euler’s function for us is that this group contains φ(n)
elements:
∥(Z/n)×∥= φ(n).
This follows from the fact that ¯a is invertible modn if and only if gcd(a, n) = 1.
For certainly ¯a cannot be invertible if gcd(a, n) = d > 1: if
ab ≡1 mod n
then
d | a, d | n =⇒d | 1.

374
5–3
Conversely, suppose gcd(a, n) = 1. Consider the map
¯x 7→ax : Z/(n) →Z/(n).
This map is injective, since
ax = 0 =⇒n | ax =⇒n | x =⇒¯x = 0.
It is therefore surjective; and in particular
¯a¯x = ax = 1
for some ¯x, ie ¯a is invertible.
But now it follows from Lagrange’s Theorem on the order of elements in ﬁnite
groups that
aφ(n) ≡1 mod n
for all a coprime to n. (We may regard this as an extension of Fermat’s Little
Theorem to composite moduli.)
Proposition 5.2 The integer n > 1 is a Carmichael number if and only if
1. n is square-free, ie
n = p1 · · · pr
where p1, . . . , pr are distinct primes; and
2. For each i (1 ≤i ≤r),
pi −1|n −1.
Proof ▶Suppose ﬁrst that n has these properties; and suppose that gcd(a, n) = 1.
Then gcd(a, pi) = 1 for each i, and so
api−1 ≡1 mod pi,
by Fermat’s Little Theorem. Hence
an−1 ≡1 mod pi
since pi −1|n −1.
Since this holds for all i,
an−1 ≡1 mod n.
Thus n is a Carmichael number.
Suppose conversely that n is a Carmichael number. First we show that n is
square-free.
Lemma 5.1 Suppose A is an abelian group; and suppose p | ∥A∥, where p is a
prime. Then A contains an element of order p.

374
5–4
Proof of Lemma ▷We argue by induction on ∥A∥. The result follows by La-
grange’s Theorem if ∥A∥= p.
If ∥A∥> p, take any element a ∈A, a ̸= 0. Suppose a is of order e. If p | e,
say
e = pr
then ar is of order p.
If p ∤e, let B be the quotient-group
B = A/⟨a⟩.
Since
p | ∥B∥= ∥A∥/e
it follows from the inductive hypothesis that B has an element, ¯a say, of order p.
Then the order of a is a multiple of p, say pr, and ar has order p, as before.
◁
Remark: In fact this result holds for any ﬁnite group G: if p | ∥G∥then G contains
an element of order p. This follows from Sylow’s Theorem.
In the abelian case the result also follows immediately from the Structure The-
orem for Finite Abelian Groups, which states that such a group A is a product of
cyclic groups of prime-power order:
A = Z/(pe1
1 ) ⊕· · · ⊕Z/(per
r ).
If p | ∥A∥then p = pi for some i; and pe−1 is an element of order p in Z/(pe).
Returning to the proof of the Proposition, if a prime, say p = p1, occurs as a
square or higher power in n, then
p|φ(n).
Hence, by the Lemma, there is an element a of order p in (Z/n)×. Since
an−1 ≡1 mod n,
it follows that
p | n −1,
which cannot be true since p | n.
Thus
n = p1 · · · pr,
where p1, . . . , pr are distinct primes.
Recall that the exponent e of a ﬁnite group G is the smallest number e > 0
such that
ge = 1
for all g ∈G. By Lagrange’s Theorem,
e | ∥G∥.

374
5–5
Lemma 5.2 If p is a prime then the exponent of the group (Z/p)× is p −1.
Proof of Lemma ▷Suppose G = (Z/p)× has exponent e. Then the p −1 elements
¯a ∈G are all roots of the polynomial equation
xe −1 = 0
over the ﬁeld
Fp = Z/(p).
But a polynomial equation of degree d has at most d roots. hence
p −1 ≤e.
Since e|p −1 it follows that
e = p −1.
◁
Remark: It is not hard to show that an abelian group of exponent e must contain
an element of order e. It follows that the group (Z/p)× is cyclic. (The generators
of this group are called primitive roots modp.) However, the Lemma above is
sufﬁcient for our purposes.
Returning to the proof of the Proposition, suppose a is coprime to pi. By the
Chinese Remainder Theorem we can ﬁnd b such that
b ≡a mod pi,
b ≡1 mod pj (j ̸= i).
Then b is coprime to n. Hence
bn−1 ≡1 mod n,
since n is a Carmichael number. Thus
an−1 ≡bn−1 ≡1 mod pi
so if e is the exponent of the group (Z/p)× then
e | n −1.
Hence, by the Lemma,
pi −1 | n −1.
◀
Example: Let
n = 3 · 11 · 17 = 561.
Then
n −1 = 560 = 24 · 5 · 7.
Since
3 −1, 11 −1, 17 −1 | n −1 = 560,
n = 561 is a Carmichael number.
It was generally believed that there were only a ﬁnite number of Carmichael
numbers, until Pomerance et al proved in 1993 that there are in fact an inﬁnite
number.

374
5–6
5.3
The Miller-Rabin test
Proposition 5.3 Suppose p is an odd prime. Let
p −1 = 2em,
where m is odd. Suppose gcd(a, n) = 1. Then either
am ≡1 mod n
or else
a2im ≡−1 mod n
for some i with 0 ≤i ≤e −1.
Proof ▶By Fermat’s Little Theorem,
ap−1 ≡1 mod p.
Thus

a
p−1
2
2 ≡1 mod p.
Hence
a
p−1
2
≡±1 mod p.
We know how to distinguish these two cases:
a
p−1
2
≡
 a
p
!
mod p,
by Proposition 3.15.
But now suppose
a
p−1
2
≡1 mod p,
which as we have seen is the case if a is a quadratic residue modp; and suppose
p ≡1 mod 4. Then

a
p−1
4
2 ≡1 mod p;
and so
a
p−1
4
≡±1 mod p.
Repeating this argument, we either reach a point where we cannot divide the
exponent by 2, ie the exponent has been reduced to m and
am ≡1 mod n;
or else
a2im ≡−1 mod n
for some i ∈[0, e −1].
◀

374
5–7
Deﬁnition 5.3 Suppose n is an odd integer > 1. Let
n −1 = 2em,
where m is odd. Suppose gcd(a, n) = 1. Then n is said to be a strong pseudoprime
to base a if either
am ≡1 mod n
or else
a2im ≡−1 mod n
for some i with 0 ≤i ≤e −1.
We can re-state the last Proposition as
Proposition 5.4 An odd prime p is a strong pseudoprime to each base a with
gcd(a, p) = 1.
Proposition 5.5 Suppose n is an odd integer > 1. If n is a strong pseudoprime to
each base a with gcd(a, n) = 1 then n is prime.
Proof ▶Suppose n is composite. Then either n is a prime-power,
n = pe
(e > 1),
or else n has two distinct prime factors, p and q.
Let us deal with the second case ﬁrst. Suppose gcd(a, n) = 1. Let the orders
of a modulo p, q, n be r, s, t, respectively. Then
r | t,
s | t,
since p | n, q | n.
We are actually interested only in the powers of 2 dividing these orders. Let
us set
v2(u) = e
if
2e ∥u,
ie 2e is the highest power of 2 dividing u. Then
v2(r) ≤v2(t),
v2(s) ≤v2(t),
since r | t, s | t.
Lemma 5.3 Suppose n is a pseudoprime to base a, ie
an−1 ≡1 mod n.
Then
v2(t) ≤v2(n −1).

374
5–8
Proof of Lemma ▷We have
an−1 ≡1 mod n =⇒t | n −1
=⇒v2(t) ≤v2(n −1).
◁
Lemma 5.4 Suppose p is an odd prime; and suppose gcd(a, p) = 1. Let the order
of a mod p be r. Then
v2(r)











< v2(p −1) if
 p
a
!
= 1,
= v2(p −1) if
 p
a
!
= −1.
Proof of Lemma ▷By Proposition 3.14,
a
p−1
2
≡
 p
a
!
mod p.
Thus if
 p
a
!
= 1
then
r | p −1
2
=⇒v2(r) ≤v2
p −1
2

= v2(p −1) −1.
On the other hand if
 p
a
!
= −1
then
ap−1 ≡1 mod p,
a
p−1
2
̸≡1 mod p.
Thus
r | p −1,
r ∤p −1
2
.
It follows that
v2(r) = v2(p −1).
◁
By the Chinese Remainder Theorem we can ﬁnd a coprime to n such that
 p
a
!
= −1,
 q
a
!
= 1,
ie a is a quadratic residue modq, and a quadratic non-residue modp.
By the last Lemma,
0 ≤v2(s) < v2(r) = v2(p −1) ≤v2(t).

374
5–9
Now suppose a is a strong pseudoprime to base n. Let
n −1 = 2em,
where m is odd. If
am ≡1 mod n
then a has odd order modn, ie
v2(t) = 0.
Hence a has odd order modp, ie
v2(r) = 0.
But that is impossible, since
v2(r) = v2(p −1) > 0.
Thus
a2im ≡−1 mod n
for some i ∈[0, e). Hence
a2im ≡−1 mod p,
a2im ≡−1 mod q.
Lemma 5.5 Suppose
a2im ≡−1 mod n,
where m is odd. Let the order of a mod n be t. Then
v2(t) = i + 1.
Proof of Lemma ▷We have
a2i+1m =

a2im2 ≡1 mod n.
Hence
t | 2i+1m,
t ∤2im.
It follows that
v2(t) = i + 1.
◁
Applying this Lemma with moduli p, q, n,
v2(r) = v2(s) = v2(t) = i + 1.
But that is a contradiction, since
v2(s) < v2(p −1) = v2(r).
We conclude that n is not a strong pseudoprime to base a.
◀

374
5–10
5.4
The Jacobi symbol
If p is an odd prime and gcd(a, p) = 1 then then
a
p−1
2
≡
 a
p
!
mod p,
by Proposition 3.15.
We cannot use this as a test of primality as it stands, since the Legendre symbol
has only been deﬁned when p is prime. Jacobi’s extension of the Legendre symbol
overcomes this problem.
Deﬁnition 5.4 Suppose n ∈N is odd. Let
n = p1 · · · pr,
where p1, . . . , pr are primes (not necessarily distinct). Then we set
 a
n
!
=
 a
p1
!
· · ·
 a
pr
!
.
Remarks:
1. Note that Jacobi’s symbol does extends the Legendre symbol; if n is prime
the two coincide.
2. Note too that
 a
n
!
= 0
if a, n are not coprime.
3. Suppose
n = pe1
1 · · · per
r .
Then a is a quadratic residue modn if and only if it is a quadratic residue
modpei
i for i = 1, . . . , r.
This implies that a is a quadratic residue modpi for each i; and so
 a
n
!
= 1.
But the converse does not hold;
 a
n
!
= 1
does not imply that a is a quadratic residue modn.

374
5–11
For example,
 8
15
!
=
 8
3
! 8
5
!
=
 2
3
! 3
5
!
= −1 · −1 = 1,
while 8 is not a quadratic residue mod15 since it is not a quadratic residue
mod3.
Many of the basic properties of the Legendre symbol carry over to the Jacobi
symbol, as the next few Propositions show.
Proposition 5.6
1. If m, n ∈N are both odd then
 a
mn
!
=
 a
m
! a
n
!
.
2. For all a, b,
 ab
n
!
=
 a
n
! b
n
!
.
Proof ▶The ﬁrst result follows at once from the deﬁnition. The second follows
from the corresponding result for the Legendre symbol.
◀
Proposition 5.7 If
a ≡b mod n
then
 a
n
!
=
 b
n
!
.
Proof ▶This follows from the corresponding result for the Legendre symbol,
since
a ≡b mod n =⇒a ≡b mod pi
for each pi | n.
◀
Proposition 5.8 Suppose m, n ∈N are odd. Then
 n
m
!
=











 m
n
!
if m ≡1 mod 4 or n ≡1 mod 4,
-
 m
n
!
if m ≡n ≡3 mod 4.

374
5–12
Proof ▶If m, n are not coprime then both sides are 0; so we may assume that
gcd(m, n) = 1. We have to show that
 m
n
! n
m
!
= (−1)
m−1
2
· n−1
2 .
Suppose
m = p1 · · · pr,
n = q1 · · · qs
(where the primes in each case are not necessarily distinct). By Proposition 5.6,
 m
n
! n
m
!
=
Y
i,j
 pi
qj
! pi
qj
!
=
Y
i,j
(−1)
pi−1
2
·
qj−1
2 ,
by the Quadratic Reciprocity Theorem (Proposition 3.20).
Thus we have to prove that
m −1
2
n −1
2
≡
X
i,j
pi −1
2
qj −1
2
mod 2,
ie
(m −1)(n −1) ≡
X
i,j
(pi −1)(qj −1) mod 8.
Lemma 5.6 If a, b ∈Z are odd then
ab −1 ≡(a −1) + (b −1) mod 4.
Proof of Lemma ▷Since a, b are odd,
(a −1)(b −1) ≡mod4,
ie
ab + 1 ≡a + b mod 4,
from which the result follows.
◁
It follows by repeated application of the Lemma that
a1 · · · at −1 ≡
X
i
(ai −1) mod 4.
In particular,
m −1 ≡(p1 −1) + · · · + (pr −1) mod 4.

374
5–13
Since n −1 is even, this implies that
(m −1)(n −1) ≡(p1 −1)(n −1) + · · · + (pr −1)(n −1) mod 8.
Again, by the Lemma,
n −1 ≡(q1 −1) + · · · + (qs −1) mod 4;
and therefore, since pi −1 is even,
(pi −1)(n −1) ≡(pi −1)(q1 −1) + · · · + (pi −1)(qs −1) mod 8.
Putting these results together,
(m −1)(n −1) ≡
X
i,j
(pi −1)(qj −1) mod 8,
as required.
◀
Proposition 5.9 Suppose n ∈N is odd. Then
 −1
n
!
=



1 if n ≡1 mod 4,
−1 if n ≡3 mod 4.
Proof ▶Suppose
n = p1 · · · prq1 · · · qs,
where
pi ≡1 mod 4,
qj ≡3 mod 4.
Then
 −1
pi
!
= 1,
 −1
qj
!
= −1,
and so
 −1
n
!
= (−1)s.
On the other hand,
n ≡1r3s mod 4
≡



1 mod 4 if s is even,
3 mod 4 if s is odd.
◀
Proposition 5.10 Suppose n ∈N is odd. Then
 2
n
!
=



1 if n ≡±1 mod 8,
−1 if n ≡±3 mod 8.

374
5–14
Proof ▶Suppose
n = p1 · · · prq1 · · · qs,
where
pi ≡±1 mod 8,
qj ≡±3 mod 8.
Then
 2
pi
!
= 1,
 2
qj
!
= −1,
and so
 2
n
!
= (−1)s.
On the other hand,
n ≡(±1)r(±3)s mod 8
≡



±1 mod 8 if s is even,
±3 mod 8 if s is odd.
◀
5.5
A weaker test
Recall that if p is prime then
a
1
2 (p−1) ≡
 p
a
!
.
We are now in a position to convert this into a test for primality.
Proposition 5.11 Suppose n ∈N is odd. Then n is prime if and only if
a
1
2 (n−1) ≡
 n
a
!
mod n
for all a coprime to n.
Proof ▶If n is prime then it certainly has the given property.
Suppose conversely that n has this property. We show ﬁrst that n must be
square-free. For suppose
p2 | n,
where p is an odd prime.
Let the exponent of (Z/n)× be e. Then
p | φ(n);
and so
p | e

374
5–15
by Lemma 5.1 to Proposition 5.2. On the other hand,
e | n −1
since
an−1 =

a
n−1
2
2 ≡1 mod n.
Thus p | n −1 and p | n, which is absurd.
Thus n is square-free, say
n = p1 · · · pr,
where p1, . . . , pr are distinct odd primes.
Our argument runs along the same lines as the proof of Proposition 5.4. Let
n −1 = 2em,
pi −1 = 2eimi;
and let us re-arrange the pi so that
e1 = max(e1, . . . , er),
ie
v2(p1 −1) ≥v2(pi −1)
for 1 ≤i ≤r.
By the Chinese Remainder Theorem, we can ﬁnd a coprime to n such that
 a
p1
!
= −1,
 a
p2
!
= 1, · · ·
 a
pr
!
= 1.
Thus
 a
n
!
=
 a
p1
!
· · ·
 a
pr
!
= −1;
and so
a
n−1
2
≡−1 mod n.
Hence
a
n−1
2
≡−1 mod pi
for 1 ≤i ≤r.
Let the order of a mod n be d; and let the orders of a mod pi be di. Then
v2(d) = v2(d1) = · · · = v2(dr) = v2(n −1),
by Lemma 5.5 to Proposition 5.4.
On the other hand,
 a
p1
!
= −1 =⇒v2(d1) = e1,

374
5–16
by Lemma 5.4 to Proposition 5.4; while by the same Lemma,
 a
pi
!
= 1 =⇒v2(di) < ei
for 2 ≤i ≤r.
But this is a contradiction, since eg
e1 ≥e2 =⇒v2(d1) > v2(d2).
◀
At ﬁrst sight this seems to offer an additional test for primality, which could
be incorporated into the Miller-Rabin test at the ﬁrst stage; having determined
whether
a
n−1
2
≡±1 mod n,
we could compute
 a
n
!
and see if this gives the same value.
However, the following result shows that this would be a waste of time; the
two values are certain to coincide.
Proposition 5.12 Suppose n is an odd integer > 1. If n is a strong pseudoprime
to base a then
a
1
2(n−1) =
 a
n
!
.
Proof ▶Let
n −1 = 2em,
where m is odd.
Suppose ﬁrst that
am ≡1 mod n.
Then
am ≡1 mod n =⇒a
1
2(n−1) = a2e−1m = (am)2e−1 ≡1 mod n.
On the other hand, a has odd order modn. Hence a has odd order modp for
each prime p | n. It follows from Lemma 5.4 to Proposition 5.4 that
 a
p
!
= 1.
Since that is true for all p | n,
 a
n
!
=
Y
p
 a
p
!
= 1.

374
5–17
Now suppose that
a2im ≡−1 mod n,
where 0 ≤i ≤e −1. Then
a
1
2 (n−1) = a2e−1m ≡



1 if i < e −1
−1 if i = e −1.
Now
a2im ≡−1 mod n =⇒a2im ≡−1 mod p
for each p | n. Let the order of a mod p be r. Then
v2(r) = i + 1
by Lemma 5.5 to Proposition 5.4.
Suppose ﬁrst that i < e −1. In that case
v2(r) = i + 1 < e = v2(p −1).
Hence
 a
p
!
= 1
by Lemma 5.4 to Proposition 5.4. Since this holds for all p | n,
 a
n
!
= 1.
Thus the result holds in this case.
Finally, suppose i = e −1. Then
a
1
2(n−1) = a2e−1m = a2im ≡−1 mod n.
If
 a
p
!
= −1
then by Lemma 5.4 to Proposition 5.4
v2(p −1) = i + 1 = e =⇒p ≡1 mod 2e, p ̸≡1 mod 2e+1
=⇒p ≡1 + 2e mod 2e+1.
On the other hand, if
 a
p
!
= 1
then by the same Lemma
v2(p −1) > i + 1 = e =⇒p ≡1 mod 2e+1.

374
5–18
Suppose n has r prime factors p with
 a
p
!
= −1.
Then
n ≡(1 + 2e)r mod 2e+1
≡



1 mod 2e+1 if r is even,
1 + 2e mod 2e+1 if r is odd.
But
2e ∥n −1,
and so
n ̸≡1 mod 2e+1.
Thus r is odd, and so
 a
n
!
= (−1)r = −1.
So the result holds also in this last case.
◀
However, although the weaker test is of no practical value, it does have some
theoretical signiﬁcance because of the following result.
Proposition 5.13 Suppose n is an odd integer > 1. Then the congruence classes
{¯a ∈(Z/n)× : ¯a
n−1
2
=
 ¯a
n
!
}
form a subgroup of (Z/n)×.
Proof ▶This follows at once from the multiplicative property of the Jacobi sym-
bol, as spelled out in Proposition 5.6(ii).
◀
By Proposition 5.11, this subgroup is proper if and only if n is composite. But
it has been shown (by E. Bach) that if the Extended Riemann Hypothesis (ERH)
holds, and
S ⊂(Z/n)×
is a proper subgroup then there is an a /∈S with
0 < a < 2(log n)2.
This implies that if the ERH holds then our weaker test, and so a fortiori the
Miller-Rabin test, must complete in polynomial time; for we need only determine
whether n is a strong a-pseudoprime for a in the above range.

