
This page intentionally left blank

AN INTRODUCTION TO ORDINARY
DIFFERENTIAL EQUATIONS
This refreshing, introductory textbook covers standard techniques for solving ordi-
nary differential equations, as well as introducing students to qualitative methods
such as phase-plane analysis. The presentation is concise, informal yet rigorous; it
can be used for either one-term or one-semester courses.
Topics such as Euler’s method, difference equations, the dynamics of the logistic
map and the Lorenz equations, demonstrate the vitality of the subject, and provide
pointers to further study. The author also encourages a graphical approach to the
equations and their solutions, and to that end the book is profusely illustrated. The
MATLAB ﬁles used to produce many of the ﬁgures are provided in an accompany-
ing website.
Numerous worked examples provide motivation for, and illustration of, key
ideas and show how to make the transition from theory to practice. Exercises are
also provided to test and extend understanding; full solutions for these are available
for teachers.


AN INTRODUCTION TO ORDINARY
DIFFERENTIAL EQUATIONS
JAMES C. ROBINSON

  
Cambridge, New York, Melbourne, Madrid, Cape Town, Singapore, São Paulo
Cambridge University Press
The Edinburgh Building, Cambridge  , UK
First published in print format 
-    ----
-    ----
-    ----
© Cambridge University Press 2004
2004
Information on this title: www.cambridge.org/9780521826501
This publication is in copyright. Subject to statutory exception and to the provision of
relevant collective licensing agreements, no reproduction of any part may take place
without the written permission of Cambridge University Press.
-    ---
-    ---
-    ---
Cambridge University Press has no responsibility for the persistence or accuracy of s
for external or third-party internet websites referred to in this publication, and does not
guarantee that any content on such websites is, or will remain, accurate or appropriate.
Published in the United States of America by Cambridge University Press, New York
www.cambridge.org
hardback
paperback
paperback
eBook (EBL)
eBook (EBL)
hardback

To
Mum and Dad,
for all their love, help and support.


Contents
Preface
page xiii
Introduction
1
Part I
First order differential equations
3
1
Radioactive decay and carbon dating
5
1.1
Radioactive decay
5
1.2
Radiocarbon dating
6
Exercises
8
2
Integration variables
9
3
Classiﬁcation of differential equations
11
3.1
Ordinary and partial differential equations
11
3.2
The order of a differential equation
13
3.3
Linear and nonlinear
13
3.4
Different types of solution
14
Exercises
16
4
*Graphical representation of solutions
using MATLAB
18
Exercises
21
5
‘Trivial’ differential equations
22
5.1
The Fundamental Theorem of Calculus
22
5.2
General solutions and initial conditions
25
5.3
Velocity, acceleration and Newton’s second law
of motion
29
5.4
An equation that we cannot solve explicitly
32
Exercises
33
Some of the chapters, and some sections within other chapters, are marked with an asterisk (*). These parts of the
book contain material that either is more advanced, or expands on points raised elsewhere in the text.
vii

viii
Contents
6
Existence and uniqueness of solutions
38
6.1
The case for an abstract result
38
6.2
The existence and uniqueness theorem
40
6.3
Maximal interval of existence
41
6.4
The Clay Mathematics Institute’s $1 000 000
question
42
Exercises
44
7
Scalar autonomous ODEs
46
7.1
The qualitative approach
46
7.2
Stability, instability and bifurcation
48
7.3
Analytic conditions for stability and instability
49
7.4
Structural stability and bifurcations
50
7.5
Some examples
50
7.6
The pitchfork bifurcation
54
7.7
Dynamical systems
56
Exercises
56
8
Separable equations
59
8.1
The solution ‘recipe’
59
8.2
The linear equation ˙x = λx
61
8.3
Malthus’ population model
62
8.4
Justifying the method
64
8.5
A more realistic population model
66
8.6
Further examples
68
Exercises
72
9
First order linear equations and the integrating factor
75
9.1
Constant coefﬁcients
75
9.2
Integrating factors
76
9.3
Examples
78
9.4
Newton’s law of cooling
79
Exercises
86
10
Two ‘tricks’ for nonlinear equations
89
10.1
Exact equations
89
10.2
Substitution methods
94
Exercises
97
Part II
Second order linear equations with constant coefﬁcients
99
11
Second order linear equations: general theory
101
11.1
Existence and uniqueness
101
11.2
Linearity
102
11.3
Linearly independent solutions
104
11.4
*The Wronskian
106

Contents
ix
11.5
*Linear algebra
107
Exercises
109
12
Homogeneous second order linear equations
111
12.1
Two distinct real roots
112
12.2
A repeated real root
113
12.3
No real roots
115
Exercises
118
13
Oscillations
120
13.1
The spring
120
13.2
The simple pendulum
122
13.3
Damped oscillations
123
Exercises
126
14
Inhomogeneous second order linear equations
131
14.1
Complementary function and particular integral
131
14.2
When f (t) is a polynomial
133
14.3
When f (t) is an exponential
135
14.4
When f (t) is a sine or cosine
137
14.5
Rule of thumb
139
14.6
More complicated functions f (t)
139
Exercises
140
15
Resonance
141
15.1
Periodic forcing
141
15.2
Pseudo resonance in physical systems
145
Exercises
148
16
Higher order linear equations
150
16.1
Complementary function and particular
integral
150
16.2
*The general theory for nth order equations
152
Exercises
153
Part III
Linear second order equations with
variable coefﬁcients
157
17
Reduction of order
159
Exercises
162
18
*The variation of constants formula
164
Exercises
168
19
*Cauchy–Euler equations
170
19.1
Two real roots
171
19.2
A repeated root
171
19.3
Complex roots
173
Exercises
174

x
Contents
20
*Series solutions of second order linear equations
176
20.1
Power series
176
20.2
Ordinary points
178
20.3
Regular singular points
183
20.4
Bessel’s equation
187
Exercises
195
Part IV
Numerical methods and difference equations
199
21
Euler’s method
201
21.1
Euler’s method
201
21.2
An example
203
21.3
*MATLAB implementation of Euler’s method
204
21.4
Convergence of Euler’s method
206
Exercises
209
22
Difference equations
213
22.1
First order difference equations
213
22.2
Second order difference equations
215
22.3
The homogeneous equation
215
22.4
Particular solutions
219
Exercises
222
23
Nonlinear ﬁrst order difference equations
224
23.1
Fixed points and stability
224
23.2
Cobweb diagrams
225
23.3
Periodic orbits
226
23.4
Euler’s method for autonomous equations
227
Exercises
230
24
The logistic map
233
24.1
Fixed points and their stability
234
24.2
Periodic orbits
234
24.3
The period-doubling cascade
237
24.4
The bifurcation diagram and more periodic orbits
238
24.5
Chaos
240
24.6
*Analysis of xn+1 = 4xn(1 −xn)
242
Exercises
245
Part V
Coupled linear equations
247
25
*Vector ﬁrst order equations and higher order equations
249
25.1
Existence and uniqueness for second order
equations
251
Exercises
252
26
Explicit solutions of coupled linear systems
253
Exercises
257

Contents
xi
27
Eigenvalues and eigenvectors
259
27.1
Rewriting the equation in matrix form
259
27.2
Eigenvalues and eigenvectors
260
27.3
*Eigenvalues and eigenvectors with MATLAB
266
Exercises
267
28
Distinct real eigenvalues
269
28.1
The explicit solution
270
28.2
Changing coordinates
271
28.3
Phase diagrams for uncoupled equations
276
28.4
Phase diagrams for coupled equations
279
28.5
Stable and unstable manifolds
281
Exercises
282
29
Complex eigenvalues
285
29.1
The explicit solution
285
29.2
Changing coordinates and the phase portrait
287
29.3
The phase portrait for the original equation
291
Exercises
292
30
A repeated real eigenvalue
295
30.1
A is a multiple of the identity: stars
295
30.2
A is not a multiple of the identity: improper
nodes
295
Exercises
299
31
Summary of phase portraits for linear equations
301
31.1
*Jordan canonical form
301
Exercises
305
Part VI
Coupled nonlinear equations
307
32
Coupled nonlinear equations
309
32.1
Some comments on phase portraits
309
32.2
Competition of species
310
32.3
Direction ﬁelds
311
32.4
Analytical method for phase portraits
314
Exercises
322
33
Ecological models
323
33.1
Competing species
323
33.2
Predator-prey models I
331
33.3
Predator-prey models II
334
Exercises
338
34
Newtonian dynamics
341
34.1
One-dimensional conservative systems
341
34.2
*A bead on a wire
344

xii
Contents
34.3
Dissipative systems
347
Exercises
350
35
The ‘real’ pendulum
352
35.1
The undamped pendulum
352
35.2
The damped pendulum
356
35.3
Alternative phase space
358
Exercises
358
36
*Periodic orbits
360
36.1
Dulac’s criterion
360
36.2
The Poinacr´e–Bendixson Theorem
361
Exercises
362
37
*The Lorenz equations
364
38
What next?
373
38.1
Partial differential equations and boundary
value problems
373
38.2
Dynamical systems and chaos
374
Exercises
375
Appendix A
Real and complex numbers
379
Appendix B
Matrices, eigenvalues, and eigenvectors
382
Appendix C
Derivatives and partial derivatives
387
Index
395

Preface
The aim of this book is to deal with all of the elementary methods for obtaining
explicit solutions of ordinary differential equations, and then to introduce the ideas
of qualitative analysis using phase plane techniques. Simple difference equations
are also included, since their methods of solution are similar to those for linear
differential equations. As well as being, I hope, an internally consistent choice of
material, this selection of topics also has the advantage of preparing a student for
a basic course on dynamical systems.
The book arose from my unsuccessful efforts to ﬁnd a suitable text to recom-
mend when I taught the ﬁrst year Warwick differential equations course. Although
there are a number of well-established and successful textbooks that treat this sub-
ject (these are discussed, along with other possibilities for further reading, in the
ﬁnal chapter), they seem either to include a large amount of additional material, or
to concentrate only on the more advanced topics. I therefore produced a detailed set
of lecture notes, which, with the encouragement of Alan Harvey and David Tranah,
and most signiﬁcantly Kenneth Blake at Cambridge University Press, eventually
became this book. My thanks here to all those students who made useful sugges-
tions while this book was still at the lecture note stage.
Part I contains an informal discussion of the issues of existence and uniqueness
of solutions, and treats the standard classes of ﬁrst order differential equations
that can be solved explicitly, as well as covering exact equations and substitution
methods.
The ﬁrst chapter of Part II shows that two linearly independent solutions are
needed in order to solve the general homogeneous problem, and also contains a
brief treatment of the Wronskian. The remainder of this section treats equations
with constant coefﬁcients, concentrating for the most part on the second order
case, with higher order equations discussed brieﬂy at the end.
Second order equations with non-constant coefﬁcients are treated in Part III,
xiii

xiv
Preface
which covers reduction of order, the method of variation of constants, and series
solutions.
Part IV turns aside from differential equations, motivating the study of dif-
ference equations by discussing Euler’s method of numerical solution. Constant
coefﬁcient linear difference equations are covered, and then there are two chapters
devoted to nonlinear difference equations. One of these goes beyond the conﬁnes
of an introductory course and discusses the dynamics of the logistic map in some
detail.
Part V treats coupled systems of two linear differential equations, starting with
the substitution method that reduces the problem to a second order differential
equation in one variable, the most reliable way to ﬁnd explicit solutions. The re-
mainder of this portion of the book deals with the matrix approach, showing how a
calculation of the eigenvalues and eigenvectors of an appropriate matrix is enough
to draw the phase portrait. This is done by changing to a coordinate system in
which the equation is put into a standard form, providing an illustration of the
Jordan canonical form of a matrix.
Part VI uses the methods from Part V in order to draw the phase plane diagrams
for a variety of nonlinear systems, with examples taken from mathematical ecology
and simple one-dimensional particle systems, including the pendulum. The book
ends with a brief discussion of Dulac’s criterion and the Poincar´e–Bendixson The-
orem, a chapter that investigates the complicated dynamics of the Lorenz Equa-
tions, and suggestions for further reading.
In addition to those already mentioned above I would like to thank various peo-
ple who have contributed to this book. I ﬁrst learned much of the material here
from Tristram Jones-Parry at Westminster School, to whom much belated thanks
for all his ﬁne teaching many years ago. I also owe a debt of gratitude to all those
who taught the course at Warwick before me, shaping its contents and therefore
those of this book; in particular, I had useful guidance from the course notes of
Alan Newell and Claude Baesens. I am most grateful to Andrew Stuart, who, in
encouraging me to emphasise the links with linear algebra, made me fond of a
subject that I still remembered with a shudder from my own undergraduate days.
Thanks too to James Macdonald, whose ‘Swarm of ﬂies’ program for his MMath
project on the Lorenz equations was the inspiration behind Figure 37.8.
Over the past two months I have been able to think of little except phase planes
and drawing ﬁgures in MATLAB: my wife, Tania Styles, has managed to endure my
many variations on ‘come and see this picture of a washing machine’ with a smile.
Heartfelt thanks to her for this, and, of course, for everything.
Finally, I would particularly like to thank my Ph.D. student, Oliver Tearne, and
my father, John, both of whom read this book extremely carefully and made a num-
ber of very helpful comments. For whatever imperfections remain, my apologies
to them and to my readers.

Introduction
Differential equations date back to the mid-seventeenth century, when calculus
was discovered independently by Newton (c. 1665) and Leibniz (c. 1684). Mod-
ern mathematical physics essentially started with Newton’s Principia (published in
1687) in which he not only developed the calculus but also presented his three fun-
damental laws of motion that have made the mathematical modelling of physical
phenomena possible.1
Historically, advances in the theory of differential equations have come from the
insights gained when trying to treat speciﬁc physical models. Despite this some-
what piecemeal development, the subject has become a well-deﬁned and coherent
area of mathematics. This book adopts a theoretical point of view, developing the
theory to the point at which it can no longer be described as ‘basic differential
equations’ and is about to become entangled with more advanced topics from the
theory of dynamical systems. Of course, applications are used throughout to serve
as motivation and illustration, but the emphasis is on a clean presentation of the
mathematics.
You may ﬁnd that some of the problems covered in the ﬁrst few chapters are
already familiar. The methods of solving these problems are well established, and
you may be well practised at applying them. However, we will take care here to
show why these methods work; giving proper justiﬁcation of the methods can take
some time, but as mathematicians we should not be satisﬁed merely with a set of
‘recipes’. Nevertheless, knowing something about the details should not stop you
from applying the methods you know already; rather you should be able to use
them with more conﬁdence.
Some of the chapters, and some sections within other chapters, are marked
with an asterisk (*). These parts of the book contain either material that is more
advanced, or material that expands on points raised elsewhere; while they could be
omitted in the interests of brevity, they are intended to give some indication of the
richness of the subject beyond the conﬁnes of an introductory course.
1 Various modern editions of this work are available, translated from its original Latin.
1

2
Introduction
There are three appendices, covering background material that is necessary at
various points in the book. While some of this is elementary and may already
be familiar (Appendix A recalls some notation and various facts about real and
complex numbers that will be used throughout the book) some is a little more ad-
vanced. Problems with timetabling often mean that certain undergraduate courses
have to rely on material that is yet to be taught in others, hence there are appen-
dices on matrices, eigenvalues and eigenvectors (Appendix B) and on derivatives,
partial derivatives and Taylor series (Appendix C). The calculation of eigenvalues
and eigenvectors is treated in detail in the main part of the book.
The use of mathematical computer packages is now a standard part of the under-
graduate curriculum, and an important tool in the armoury of practising mathemati-
cians, scientists and engineers. Although the emphasis in the text is on pencil and
paper analysis, and the book in no way relies on the availability of such software,
some topics, particularly the treatment of coupled nonlinear equations using phase
plane ideas in Chapters 28–37, can beneﬁt greatly from the graphical possibilities
modern computers provide. Almost all of the ﬁgures in this book have been gener-
ated using MATLAB, and very occasionally particular MATLAB commands are men-
tioned in the text. Nevertheless, it should be possible to carry out the numerical ex-
ercises suggested here using any of the major commercially available mathematical
packages; and with a little more ingenuity using any programming language with
graphical capabilities. The MATLAB ﬁles used to produce some of the ﬁgures, and
mentioned in certain of the exercises, are available for download from the web at
www.cambridge.org/0521533910.
There is no better way to learn this material than by working through a selection
of examples. One set of examples is included in what is, I hope, a natural way in
the text, with the end of each worked solution marked with a box (
). Another set
of examples is given in the exercises that end each chapter, and these should be
considered an integral part of the book. The majority consist of sample problems
that can be treated with the methods of the chapter – in order to give teachers a
reasonable choice of problems, there are intentionally more of these than you could
reasonably be expected to do. Others, labelled with a ‘T’, are more theoretical
and designed to give an indication of some of the mathematical issues raised, but
not treated in detail, in the text. Finally, those exercises labelled with a ‘C’ are
intended to encourage the use of the computer to perform routine calculations and
investigate equations and their solutions graphically. Those involved in teaching
courses based on this book may obtain copies of solutions to these exercises by
applying to the publisher by email (solutions@cambridge.org).
I would welcome any comments or suggestions, either by post to the Mathe-
matics Institute, University of Warwick, Coventry, CV4 7AL, U.K. or by email
to jcr@maths.warwick.ac.uk; any errata that arise will be posted on my own
website www.maths.warwick.ac.uk/∼jcr/IntroODEs.html.

Part I
First order differential equations


1
Radioactive decay and carbon dating
Before we start our formal treatment of the subject we will look at a very simple
example that nonetheless exhibits the power of differential equations as models of
reality. One point to bear in mind in this chapter is the distinction to be made be-
tween ﬁnding the solution of a differential equation, and interpreting this solution.
1.1 Radioactive decay
Let N(t) denote the number of radioactive atoms in some sample of material at
time t. Then with k > 0 the equation
dN
dt = −kN
(1.1)
is a very good model for the way that the number of radioactive atoms decays (see
Exercise 1.1).
Although we will see later how to solve this equation, for now we will assume
that when there are Ns isotopes at time s, the solution is
N(t) = Nse−k(t−s).
(1.2)
You can check that we really do have the solution: when t = s the formula in (1.2)
gives N(s) = Ns, while we have
d
dt N(t) = −kNse−k(t−s) = −kN(t),
and so the differential equation (1.1) is satisﬁed.
It follows from (1.2) that the number of radioactive isotopes decays exponen-
tially to zero. Graphs of the solution for various values of N(0), showing this
decay, are plotted in Figure 1.1.
The half-life of a particular radioactive isotope is the time it takes for half of the
radioactive isotopes to decay, and this is related to the constant k that appears in
5

6
1 Radioactive decay and carbon dating
0
0.5
1
1.5
2
2.5
3
3.5
4
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Half-life
 N (millions)
 t (10000 years)
Fig. 1.1. Graph showing the number N(t) of radioactive atoms falling off as a
function of time, for a number of different values of N0; the constant k is that for
radioactive carbon 14. The half-life, approximately 5700 years, is marked by a
dashed vertical line.
the equation. To ﬁnd this relationship, suppose that there are N0 radioactive atoms
at time t = 0. Then the solution of (1.1) is
N(t) = N0e−kt.
Half of the atoms will have decayed by time thalf when N(thalf) = 1
2 N0, i.e.
N0e−kthalf = 1
2 N0
⇒
e−kthalf = 1
2.
Taking the (natural) logarithm of both sides gives
−kthalf = −ln 2,
and so the half-life is given by thalf = (ln 2)/k. Note that this time does not depend
on the initial number of radioactive atoms.
1.2 Radiocarbon dating
The solution (1.2) forms the basis of the technology of radiocarbon dating. The
essence of the method is as follows. Living matter is constantly taking up carbon
from the air. The result is that within such material the ratio of the number of iso-
topes of radioactive carbon 14 (14C) to the number of isotopes of stable carbon 12
(12C) is essentially constant. Once the specimen is dead (for example, a tree is cut
down for its wood, or cotton is harvested for weaving), the radioactive 14C atoms
begin to decay according to the model (1.1). Since the half-life of carbon 14 is

1.2 Radiocarbon dating
7
approximately 5700 years, we need to take the constant k in (1.1) to be
k = ln 2
5700 ≈1.216 × 10−4.
By examining the ratio of the number of isotopes of carbon 12 to carbon 14
in a sample of the material that we want to date, it is possible to work out the
proportion remaining of the 14C atoms that were initially present. Suppose that the
sample stopped taking up carbon from the air when t = s, and that the number
of 14C atoms present then was Ns. If we know that the sample now (at time t0)
contains only a fraction p of the initial level of 14C, then N(t0) = pNs.
Using our explicit solution N(t) = Nse−k(t−s), we should have
pNs = N(t0) = Nse−k(t0−s).
Cancelling the factor of Ns in the two outside terms yields the equation
p = e−k(t0−s).
Taking logarithms of both sides we have
ln p = −k(t0 −s),
and so the year s from which the sample dates is given by
s = t0 + ln p
k .
(1.3)
In 1988, the Shroud of Turin (see Figure 1.2) was dated by three independent
groups of scientists from Arizona, Oxford and Zurich. Fibres from the shroud were
Fig. 1.2. The Shroud of Turin: carbon dated to the fourteenth century. Photograph
c⃝1978 Barrie M. Schwortz (his website at www.shroud.com is well worth a
visit).

8
1 Radioactive decay and carbon dating
found to contain about 92% of the level in living matter.1 Using the expression in
(1.3) shows that the Shroud therefore dates from
s = 1988 +
ln 0.92
0.000 121 6 ≈1302,
putting its origin squarely in the Middle Ages.
Exercises
1.1 Radioactive isotopes decay at random, with a ﬁxed probability of decay per unit time.
Over a time interval t, suppose that the probability of any one isotope decaying is
kt. If there are N isotopes, how many will decay on average over a time interval t?
Deduce that
N(t + t) −N(t) ≈−Nkt,
and hence that dN/dt = −kN is an appropriate model for radioactive decay.
1.2 Plutonium 239, virtually non-existent in nature, is one of the radioactive materials used
in the production of nuclear weapons, and is a by-product of the generation of power
in a nuclear reactor. Its half-life is approximately 24 000 years. What is the value of k
that should be used in (1.1) for this isotope?
1.3 In 1947 a large collection of papyrus scrolls, including the oldest known manuscript
version of portions of the Old Testament, was found in a cave near the Dead Sea; they
have come to be known as the ‘Dead Sea Scrolls’. The scroll containing the book of
Isaiah was dated in 1994 using the radiocarbon technique;2 it was found to contain
between 75% and 77% of the initial level of carbon 14. Between which dates was the
scroll written?
1.4 A large round table hangs on the wall of the castle in Winchester. Many would like
to believe that this is the Round Table of King Arthur, who (so legend would have it)
was at the height of his powers in about AD 500. If the table dates from this time,
what proportion of the original carbon 14 would remain? In 1976 the table was dated
using the radiocarbon technique, and 91.6% of the original quantity of carbon 14 was
found.3 From when does the table date?
1.5 Radiocarbon dating is an extremely delicate process. Suppose that the percentage of
carbon 14 remaining is known to lie in the range 0.99p to 1.01p. What is the range of
possible dates for the sample?
1 P. E. Damon et al., ‘Radiocarbon dating of the Shroud of Turin’, Nature 337 (1989), 611–615.
2 A. J. Jull et al., ‘Radiocarbon dating of the scrolls and linen fragments from the Judean Desert’, Radiocarbon
37 (1995), 11–19.
3 M. Biddle, King Arthur’s Round Table (Boydell Press, 2001).

2
Integration variables
Because of the intimate relationship between differentiation and integration
(discussed in more detail in the next chapter) there will be many integrals in this
book, and it is worth pausing now in order to make sure that we have an appropri-
ately unambiguous notation.
Although in theory mathematicians make careful distinctions between ‘the func-
tion f ’ and ‘ f (x)’, the value that f takes at a particular point x, this distinction is
rarely maintained in day-to-day informal discussions.
Usually this does not cause any trouble. However, consider the following prob-
lem, posed in ‘everyday’ language:
Find the area under the graph of f (x) between a and x.
Although the meaning of this is clear, ‘ﬁnd the shaded area in Figure 2.1’, there is
some potential for confusion when we try to write this down mathematically, since
there are too many xs around. Converting the English into symbols gives
 x
a
f (x) dx,
(2.1)
and it should be clear that this is not satisfactory, since the symbol x is used in two
different ways: once as the upper limit of the range of integration (
 x
a ), and once
as the variable that is being integrated over (dx).
When we integrate a function between two limits, for example1
 b
a
f (x) dx,
the variable that we are integrating over is a ‘dummy’ variable. It is just there to
tell us how to do the integration, and plays no rˆole in the ﬁnal answer, which will
1 Observe that there is no need to change our notation for this particular deﬁnite integral, since no confusion can
arise as to the rˆole of x.
9

10
2 Integration variables
0
a
 x
Fig. 2.1. ‘Find the shaded area’.
only depend on a and b. So
 b
a
f (x) dx =
 b
a
f (θ) dθ =
 b
a
f (ℵ) dℵ.
(We can change the name of the dummy variable with no effect on the integral.)
The obvious solution, then, is to change the integration variable in (2.1) to some-
thing other than x. However, changing the variable to something completely dif-
ferent from x is likely to be confusing. The approach we will adopt will be to add
a tilde ∼to the integration variable, so that instead of (2.1) we will write
 x
a
f (˜x) d˜x.
(2.2)
All being well this should keep things ‘clean’ but should not be too jarring.
We will also do something similar when evaluating integrals where x is an upper
limit, i.e.
 x
a
f (˜x) d˜x =

F(˜x)
x
˜x=a
,
when F′ = f .
Of course, very few people are this careful when they are doing calculations and
the backs of mathematicians’ envelopes are full of things like (2.1) rather than the
pedantic (2.2).

3
Classiﬁcation of differential equations
Before we begin we need to introduce a simple classiﬁcation of differential equa-
tions which will let us increase the complexity of the problems we consider in a
systematic way.
3.1 Ordinary and partial differential equations
The most signiﬁcant distinction is between ordinary and partial differential equa-
tions, and this depends on whether ordinary or partial derivatives occur.
Partial derivatives cannot occur when there is only one independent variable.
The independent variables are usually the arguments of the function that we are
trying to ﬁnd, e.g. x in f (x), t in x(t), both x and y in G(x, y). The most common
independent variables we will use are x and t, and we will adopt a special short-
hand for derivatives with respect to these variables: we will use a dot for d/dt, so
that
˙z = dz
dt
and
¨z = d2z
dt2 ;
and a prime symbol for d/dx, so that
y′ = dy
dx
and
y′′ = d2y
dx2 .
Usually we will prefer to use time as the independent variable.
In an ordinary differential equation (ODE) there is only one independent vari-
able, for example the variable x in the equation
dy
dx = f (x),
11

12
3 Classiﬁcation of differential equations
specifying the slope of the graph of the function y; the variable t in
m¨x = f(t)
which we could solve for the position x(t) = (x(t), y(t), z(t)) of a particle at
time t moving under the action of a force f(t) (the equation is Newton’s second
law of motion, F = ma); or x in
−¯h2
2m
d2ψ
dx2 + V (x)ψ = Eψ
where ψ(x) = α(x) + iβ(x) is complex (this is the Schr¨odinger equation from
quantum mechanics).
In a partial differential equation there is more than one independent variable
and the derivatives are therefore partial derivatives, for example the heat in a rod
at position x and time t, h(x, t), obeys the heat equation
∂h
∂t = k ∂2h
∂x2 .
A much more complicated example is given by the Navier–Stokes equations used
to determine the velocity of a ﬂuid
u(x1, x2, x3, t) = (u1(x1, x2, x3, t), u2(x1, x2, x3, t), u3(x1, x2, x3, t))
(think of x1 = x, x2 = y, and x3 = z), which are:1
ρ

∂u j
∂t +
 3

i=1
ui
∂u j
∂xi
	
−µ

∂2u j
∂x2
1
+ ∂2u j
∂x2
2
+ ∂2u j
∂x2
3
	
+ ∂p
∂x j
= f j.
(3.1)
(one for each component, j = 1, 2, 3) and
∂u1
∂x1
+ ∂u2
∂x2
+ ∂u3
∂x3
= 0.
(3.2)
In this book we will consider only ordinary differential equations.
1 It is possible to write these two equations much more concisely using vector calculus notation. Imagine that ∇
represents a vector of partial derivatives, ∇= (∂/∂x1, ∂/∂x2, ∂/∂x3), which can be manipulated like a normal
vector. Then, for example, Equation (3.2) is just ∇· u = 0. Deﬁning also  = ∇· ∇(the sum of all second
derivatives) we can rewrite (3.1) as
ρ
∂u
∂t + (u · ∇)u

−µ u + ∇p = f.
(3.3)

3.3 Linear and nonlinear
13
3.2 The order of a differential equation
The order of a differential equation is the highest order derivative that occurs: the
equation
dy
dx = f (x)
specifying the slope of a graph is ﬁrst order, as is the following equation expressing
energy conservation,
1
2m ˙x2 + V (x) = E
(1
2m ˙x2 is the kinetic energy while V (x) is the potential energy at a point x);
Newton’s second law of motion
m d2x
dt2 = F
is second order; the equation
ψ′′′ + 1
2ψψ′ = 0
(which occurs in the theory of ﬂuid boundary layers) is third order (recall that ψ′′′
is shorthand for d3ψ/dx3).
To be more formal, an nth order ordinary differential equation for a function
y(t) is an equation of the form
F

dny
dtn , dn−1y
dtn−1 , . . . , dy
dt , y, t

= 0.
(3.4)
(Of course we want dny/dtn to occur in F; if F( ¨y, ˙y, y, t) is y −t then the result-
ing equation (y −t = 0) is not a differential equation at all.) If t does not occur
explicitly in the equation, as in
dy
dt = f (y),
then the equation is said to be autonomous.
3.3 Linear and nonlinear
Another important concept in the classiﬁcation of differential equations is linearity.
Generally, linear problems are relatively ‘easy’ (which means that we can ﬁnd an
explicit solution) and nonlinear problems are ‘hard’ (which means that we cannot
solve them explicitly except in very particular cases).

14
3 Classiﬁcation of differential equations
An nth order ODE for y(t) is said to be linear if it can be written in the form
an(t)dny
dtn + an−1(t)dn−1y
dtn−1 + · · · + a1(t)dy
dt + a0(t)y = f (t),
(3.5)
i.e. only multiples of y and its derivatives occur. Such a linear equation is called
homogeneous if f (t) = 0, and inhomogeneous if f (t) ̸= 0.
3.4 Different types of solution
When we try to solve a differential equation we may obtain various possible types
of solution, depending on the equation. Ideally, perhaps, we would ﬁnd a fully ex-
plicit solution, in which the dependent variable is given explicitly as a combination
of elementary functions of the independent variable, as in
y(t) = 3 cos 5t + 8 sin t.
(3.6)
We can expect to be able to ﬁnd such a fully explicit solution only for a very limited
set of examples.
A little more likely is a solution in which y is still given directly as a function
of t, but as an expression involving an integral, for example
y(t) = 1 +
 t
0
e−s2 ds.
(3.7)
Here y is still an explicit function of t, but the integral cannot be evaluated in terms
of elementary functions.
Sometimes, however, we will only be able to obtain an implicit form of the
solution; this is when we obtain an equation that involves no derivatives and relates
the dependent and independent variables.2 For example, the equation
ln y + 4 ln x −y −2x + 4 = 0
(3.8)
relates x and y, but cannot be solved explicitly for y as a function of x.
All these types of solution will occur in what follows.
There are many situations, however, in which it is not possible to obtain any use-
ful expression for the solution. For some equations it is still possible to understand
2 We could also have an implicit solution containing integrals that cannot be evaluated in terms of elementary
functions. For example, we will see that the equation dx/dt = f (x)g(t) has solution

dx
f (x) =

g(t) dt,
which in general gives such an implicit solution.

3.4 Different types of solution
15
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 3.1. A qualitative, graphical solution of the coupled system of equations
(3.9). The axes are x (horizontally) and y (vertically), and it is safe to assume
that this is the case for any unlabelled axes in the rest of the book.
the qualitative behaviour of the solutions, i.e. to describe how the solutions be-
have, even though we cannot specify them exactly. This is the approach we will
take in Chapter 7, and throughout Chapters 32–37. Such a description is often best
expressed graphically. For example, Figure 3.1 shows the phase diagram (or phase
portrait) for the solutions of the equations
˙x = x(4 −2x −y)
˙y = y(9 −3x −3y).
(3.9)
The diagram is a plot of sample curves traced out by solutions (x(t), y(t)) labelled
with arrows indicating the direction in which t increases. The crosses show points
at which the solutions of this equation are constant. We can tell from this dia-
gram that every solution eventually approaches the point (1, 2) [i.e. x(t) →1 and
y(t) →2 as t →+∞], even though we do not have any form of explicit solution
for (3.9).
For some equations all our analytical tools may fail, and in this case we can
often use a computer to approximate the solution. A ‘numerical solution’ of a
differential equation is usually only an approximation, and the initial result of such
a calculation will not be an expression for x in terms of t, say, but a list of times,
t, and corresponding approximate values for x(t). Using MATLAB’s ODE solving
routine, ode45, to solve the equation
dx
dt = t −x2
x(0) = 0

16
3 Classiﬁcation of differential equations
between times t = 0 and t = 5, yields such a list:
>> xdot=inline(’t-xˆ2’,’t’,’x’);
>> [t x]=ode45(xdot,[0 5],0);
>> [t x]
ans = 0
0
0.1250
0.0078
2.6250
1.4921
0.2500
0.0312
2.7500
1.5407
0.3750
0.0700
2.8750
1.5864
0.5000
0.1235
3.0000
1.6299
0.6250
0.1907
3.1250
1.6721
0.7500
0.2700
3.2500
1.7127
0.8750
0.3591
3.3750
1.7515
1.0000
0.4555
3.5000
1.7891
1.1250
0.5563
3.6250
1.8261
1.2500
0.6585
3.7500
1.8621
1.3750
0.7596
3.8750
1.8969
1.5000
0.8574
4.0000
1.9310
1.6250
0.9505
4.1250
1.9646
1.7500
1.0377
4.2500
1.9976
1.8750
1.1187
4.3750
2.0297
2.0000
1.1935
4.5000
2.0612
2.1250
1.2628
4.6250
2.0925
2.2500
1.3268
4.7500
2.1231
2.3750
1.3856
4.8750
2.1531
2.5000
1.4403
5.0000
2.1826
We will discuss one simple method of numerical approximation in Chapter 21.
Exercises
3.1 Classify the following equations as ordinary or partial, give their order, and state
whether they are linear or nonlinear. In each case identify the dependent and inde-
pendent variables.
(i) Bessel’s equation (ν is a parameter)
x2y′′ + xy′ + (x2 −ν2)y = 0,
(ii) Burger’s equation (ν is a parameter)
∂u
∂t −ν ∂2u
∂x2 + u ∂u
∂x = 0,

Exercises
17
(iii) van der Pol’s equation (m, k, a and b are parameters)
m ¨x + kx = a ˙x −b ˙x3,
(iv) dy/dt = t −y2,
(v) the wave equation (c is a parameter)
∂2y
∂t2 = c2 ∂2y
∂x2 ,
(vi) Newton’s law of cooling (k is a parameter and A(t) is a speciﬁed function)
dT
dt = −k(T −A(t)),
(vii) the logistic population model (k is a parameter)
d p
dt = kp(1 −p),
(viii) Newton’s second law for a particle of mass m moving in a potential V (x),
m ¨x = −V ′(x),
(ix) the coupled equations in (3.9)
˙x = x(4 −2x −y)
˙y = y(9 −3x −3y),
and
(x)
dx
dt = Ax,
where x is an n-component vector and A is an n × n matrix.

4
*Graphical representation of solutions using MATLAB
The list of numbers that formed the example of a numerical solution at the end
of the previous chapter indicates how useful a graphical representation of solu-
tions can be. In fact MATLAB’s default presentation of a numerical solution of a
differential equation is as a graph: the commands
>> xdot=inline(’t-xˆ2’, ’t’, ’x’);
>> ode45(xdot, [0 5], 0)
produce the graph shown in Figure 4.1 (only the axis labels have been added).
Whichever kind of solution we manage to obtain for our equation, the graph-
ical capabilities provided by modern computer packages enable us to visualise
these solutions and so obtain a much better understanding of their behaviour. All
the solutions in Section 3.4 beneﬁt from a graphical presentation. In this section
we brieﬂy discuss the main MATLAB commands that can be used to visualise and
solve a variety of equations.
Almost all of the ﬁgures in Parts I, II, and III of this book are the graphs of
explicit solutions; these are very easy to produce with MATLAB. For example, to
plot y(t) = 3 cos 5t + 8 sin t against t for 0 ≤t ≤20, the three lines
t=linspace(0,20);
y=3*cos(5*t)+8*sin(t);
plot(t,y)
produce Figure 4.2.
If the solution is given as an integral that cannot be evaluated explicitly, like
(3.7),
y(t) = 1 +
 t
0
e−s2 ds,
18

*Graphical representation of solutions using MATLAB
19
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.5
1
1.5
2
2.5
t
x
Fig. 4.1. The solution of ˙x = t −x2 with x(0) = 0, as produced by the
MATLAB ode45 command. The individual pairs (x, t) are represented by the
circles, and are joined to produce an approximation to the solution x(t) of
the original equations.
0
2
4
6
8
10
12
14
16
18
20
−15
−10
−5
0
5
10
15
Fig. 4.2. The graph of y(t) = 3 cos 5t + 8 sin t (y against t).
then we can ﬁnd the value of y at any given value of t by approximating the in-
tegral; this is something that computers are very good at. The integral of e−t2
between 0 and 2 (for example) can be evaluated by deﬁning an ‘inline function’
f (t) = exp(−t2) and then using the quad command:
>> f=inline(’exp(-t.ˆ2)’,’t’)
f = Inline function:
f(t) = exp(-t.ˆ2)

20
4 *Graphical representation of solutions using MATLAB
0
0.5
1
1.5
2
2.5
3
1
1.1
1.2
1.3
1.4
1.5
1.6
1.7
1.8
1.9
y
t
Fig. 4.3. The graph of y(t) = 1 +
 t
0 e−s2 ds.
0.5
1
1.5
2
2.5
3
3.5
4
4.5
0.5
1
1.5
2
2.5
3
3.5
4
4.5
x
y
Fig. 4.4. The curve ln y + 4 ln x −y −2x + 4 = 0.
>> quad(f,0,2)
ans = 0.8821
The graph of y against t can be plotted using the short M-ﬁle
f=inline(’exp(-t.ˆ2)’,’t’);
for i=0:30
t(i+1)=i/10;
y(i+1)=1+quad(f,0,t(i+1));
end
plot(t,y)

Exercises
21
Given an implicit formula like (3.8),
ln y + 4 ln x −y −2x = −4,
we can notice that x and y lie on a curve that makes
F(x, y) = ln y + 4 ln x −y −2x
constant. The ‘contour plot’ of the level set F(x, y) = −4,
>> [x, y]=meshgrid(.01:.1:5, .01:.1:5);
>> z=log(y)+4*log(x)-y-2*x;
>> contour(x,y,z,[-4 -4])
is shown in Figure 4.4.
Exercises
4.1 (C) Plot the graphs of the following functions:
(i) y(t) = sin 5t sin 50t for 0 ≤t ≤3,
(ii) x(t) = e−t(cos 2t + sin 2t) for 0 ≤t ≤5,
(iii)
T (t) =
 t
0
e−(t−s) sin s ds
for
0 ≤t ≤7,
(iv) x(t) = t ln t for 0 ≤t ≤5,
(v) plot y against x, where
x(t) = Be−t + Ate−t
and
y(t) = Ae−t,
for A and B taking integer values between −3 and 3.
4.2 (C) Draw contour plots of the following functions:
(i)
F(x, y) = x2 + y2
for
−2 ≤x, y ≤2;
(ii)
F(x, y) = xy2
for
−1 ≤x, y ≤1,
with contour lines where F = ±0.1, ±0.2, ±0.4, and ±0.8;
(iii)
E(x, y) = y2 −2 cos x
for
−4 ≤x, y ≤4;
(iv)
E(x, y) = x −1
3x3 + 1
2 y2(x4 −2x2 + 2)
for −2 ≤x ≤4 and −2 ≤y ≤2, showing contour lines where E = 0, 0.5,
0.8, 1, 2, 3 and 4;
(v)
E(x, y) = y2 + x3 −x
for
−2 ≤x, y ≤2.

5
‘Trivial’ differential equations
In this chapter we consider the simplest possible kind of differential equation,
one that can be solved directly by integration. Although the problem is relatively
straightforward, it will serve to introduce several important ideas.
You have probably already met and solved one simple kind of differential equa-
tion:
dy
dx (x) = f (x).
(5.1)
Viewed as an equation to solve for y(x), this asks us to ﬁnd the function whose
graph has slope f (x) at the point x. So in order to solve this equation we ‘just’
have to ﬁnd a function whose derivative is f (x).
5.1 The Fundamental Theorem of Calculus
Any function F that satisﬁes F′ = f is called an anti-derivative1 of f . Clearly if
F is an anti-derivative of f then so is F(x) + c for any constant c.
This terminology allows us to distinguish between reversing the process of dif-
ferentiation (ﬁnding an anti-derivative) and integration (ﬁnding the area under a
curve). Put like this it becomes possible, perhaps, to appreciate how remarkable
it is that these two concepts are so intimately related. This is formalised in the
Fundamental Theorem of Calculus (FTC).
Essentially this theorem says that differentiation reverses the action of integra-
tion, and that if we know an anti-derivative of f we can calculate the area under
the graph of f between any two points; it is easy to forget that the FTC is a major
result because we use it so frequently in order to calculate integrals.
In the statement of the theorem we use R to denote the set of all real numbers,
and [a, b] denotes the closed interval a ≤x ≤b.
1 The more puzzling word ‘primitive’ is sometimes used instead of ‘anti-derivative’.
22

5.1 The Fundamental Theorem of Calculus
23
0
 G(x)
a
 x
Fig. 5.1. G(x) is the area under the graph of f between a and x.
Theorem 5.1 Suppose that f : [a, b] →R is continuous, and for a ≤x ≤b
deﬁne
G(x) =
 x
a
f (˜x) d˜x
(5.2)
(the integral G(x) is the area under the graph of f between a and x, see
Figure 5.1). Then
dG
dx (x) = f (x),
and furthermore
 b
a
f (x) dx = F(b) −F(a)
(5.3)
for any anti-derivative F of f (i.e. for any F with F′ = f ).
We often write (5.3) in the more convenient shorthand
 b
a
f (x) dx =

F(x)
b
x=a
.
(5.4)
Proof (Sketch) If we calculate dG/dx using the formal deﬁnition of the derivative
as a limit (see Appendix C),
dG
dx (x) = lim
x→0
G(x + x) −G(x)
x
,
(5.5)

24
5 ‘Trivial’ differential equations
0
 x
x+δx
 G(x+δx)−G(x)
f(x)
Fig. 5.2. f is essentially constant on the narrow strip [x, x + x].
then we get
dG
dx (x) = lim
x→0
1
x

 x+x
a
f (˜x) d˜x −
 x
a
f (˜x) d˜x

= lim
x→0
1
x
 x+x
x
f (˜x) d˜x.
The expression
 x+x
x
f (˜x) d˜x
(5.6)
represents the area in the little strip between x and x + x (see Figure 5.2). Since
f (˜x) ≈f (x) for this range of ˜x the value of (5.6) is roughly x f (x), and so we
get
G′(x) ≈lim
x→0
1
x x f (x) = f (x);
in other words G(x) is an anti-derivative of f (x). This argument can be made
precise if f is continuous (see Exercise 5.9).
We now show how we can use an anti-derivative in order to calculate a deﬁnite
integral (between two ﬁxed limits) as in (5.3). If F is any anti-derivative of f then
(d/dx)(F −G) = F′ −G′ = 0 and so F and G can only differ by a constant,
F(x) = G(x) + c.

5.2 General solutions and initial conditions
25
Since G(a) = 0 (from its deﬁnition in (5.2)) we have F(a) = c, and so
 b
a
f (x) dx = G(b)
= F(b) −c
= F(b) −F(a),
which is (5.3).
□
Because of the relationship between anti-derivatives and integrals, the notation

f (x) dx,
(5.7)
(note the lack of limits on the integral) is often used as a shorthand to mean ‘an
anti-derivative of f ’. We will use this notation at times, but when we need to be
more careful we will explicitly use a particular choice of anti-derivative F(x).
5.2 General solutions and initial conditions
Now let us return to our simple differential equation2
dy
dx = f (x).
(5.8)
Any anti-derivative F of f is a solution of this equation (y(x) = F(x)); hence we
could simply write
y(x) =

f (x) dx.
If we choose one particular anti-derivative F, then we know that not only is
y(x) = F(x) a solution, but also y(x) = F(x) + c for any c. So as it stands (5.8)
has many solutions. We say that
y(x) = F(x) + c
(5.9)
is the general solution of the equation (5.8), since any possible solution of (5.8)
can be obtained by choosing c appropriately. It should not be a surprise that there
are many possible solutions; we can move a graph ‘up and down’ and not change
its slope – all the curves in Figure 5.3, which differ by only a constant, have the
same slope at any given x value.
As illustrated in the ﬁgure, one way to pick out a particular solution is to give a
point that must lie on the graph of y, in other words to specify the value y(x0) of
2 Usually we will not make explicit the dependence of dy/dx on x (and similarly for other derivatives).

26
5 ‘Trivial’ differential equations
(x0,y0)
Fig. 5.3. Adjusting the constant c in (5.9) corresponds to moving the graph of F
‘up and down’ and does not affect the slope. An initial condition (x0, y0) will pick
out one of the curves.
y at some particular x value, x0. We refer to such a restriction
y(x0) = y0
as an initial condition, the idea being that we could construct the solution of (5.8)
starting at (x0, y0) and then drawing the graph by using the information about the
derivative of y contained in (5.8).
There are two ways to ﬁnd the solution of (5.8) that satisﬁes y(x0) = y0. You
should make sure that you understand what follows, since we will use similar
reasoning very often throughout the rest of the book.
For the ﬁrst method we do a little more than we have to: we ﬁnd the general
solution, and then solve a very simple algebraic equation to ﬁnd the correct con-
stant. We have seen that if we can ﬁnd one anti-derivative F of f then the general
solution of (5.8) is
y(x) = F(x) + c.
The particular solution that we want has y(x0) = y0, and so we need
y0 = y(x0) = F(x0) + c
⇒
c = y0 −F(x0).
Thus the solution with y(x0) = y0 is
y(x) = y0 + F(x) −F(x0).
(5.10)
The alternative is to proceed more directly, and integrate both sides of
dy
dx = f (x)
(5.11)

5.2 General solutions and initial conditions
27
between x0 and x. Then we get
 x
x0
dy
dx (˜x) d˜x =
 x
x0
f (˜x) d˜x,
which gives

y(˜x)
x
˜x=x0
=
 x
x0
f (˜x) d˜x.
Putting in the limits on the left-hand side this is
y(x) −y(x0) =
 x
x0
f (˜x) d˜x.
(5.12)
You should make sure that you are happy going straight from (5.11) to (5.12); we
will generally skip the two intermediate steps.
Since y(x0) = y0, (5.12) gives the solution in the form
y(x) = y0 +
 x
x0
f (˜x) d˜x.
(5.13)
(The FTC shows that we do indeed have y′(x) = f (x), and clearly y(x0) = y0 as
required.) If we know that F is an anti-derivative of f then we can use the FTC,
 b
a
f (x) dx = F(b) −F(a),
(this was (5.3), and is just the usual rule for evaluating integrals) to write the solu-
tion more explicitly as
y(x) = y0 + F(x) −F(x0).
Of course, this is the same expression that we obtained above in (5.10). Note,
however, that in some cases the integral form in (5.13) may be the best that we can
do, if it is not possible to ﬁnd an explicit anti-derivative of f .
We now look at some simple examples.
Example 5.2 Find the general solution of the equation
dy
dx = x + 10 sin x.
(5.14)
What is the equation of the graph with slope x + 10 sin x passing through the point
(, 0)?
In order to ﬁnd the general solution we have to ﬁnd an anti-derivative of
x + 10 sin x. Using standard integrals this is 1
2x2 −10 cos x, and so the general

28
5 ‘Trivial’ differential equations
0
1.5708
3.1416
4.7124
6.2832
25
20
15
10
5
0
5
x
y
(π,0)
Fig. 5.4. The graph of y(x) = 1
2(x2 −2) −10(1 + cos x). It passes through the
initial condition (, 0), which is marked by a cross.
solution of (5.14) is
y(x) = 1
2x2 −10 cos x + c
for any c. The one solution that passes through (, 0) must have
0 = y() = 1
22 −−10 + c
⇒
c = −1
22 −10,
and so
y(x) = 1
2(x2 −2) −10(1 + cos x).
The graph of y against x is shown in Figure 5.4, along with the initial condition.
□
Example 5.3 A curve passing through the point (1, 0) has slope ln x. What is the
equation of the curve?
We have to solve the equation
dy
dx = ln x.
Since we have already used the ‘long-winded’ method in the ﬁrst example, let us

5.3 Velocity, acceleration and Newton’s second law of motion
29
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
x
y
Fig. 5.5. The graph of y(x) = 1 + x ln x −x, with the initial condition (1, 0)
marked by a cross.
do this one directly. We integrate both sides of the equation between 1 and x to
give
y(x) −y(1) =
 x
1
ln ˜x d ˜x
=

˜x ln ˜x −˜x
x
˜x=1
= (x ln x −x) −(0 −1)
and so (since we want y(1) = 0)
y(x) = 1 + x ln x −x.
This solution is shown in Figure 5.5.
□
In the next section we will give some more examples, this time more practically
based, using Newton’s second law of motion (F = ma).
5.3 Velocity, acceleration and Newton’s second law of motion
Newton formulated the calculus, and his theory of differential equations, in order
to be able to write down and solve the mathematical models that resulted from
his laws of motion. Since derivatives are essentially the ‘rate of change’, questions
concerning velocities (the rate of change of position) and acceleration (the rate of
change of velocity) are most naturally framed as differential equations.

30
5 ‘Trivial’ differential equations
Newton’s second law of motion states that the change p in the momentum p
of an object is equal to F, the force applied, multiplied by the time t over which
the force acts,
p = F t.
Dividing by t and letting t tend to zero (this is, of course, a somewhat imprecise
derivation) we obtain
d p
dt = F(t).
Since the momentum is the mass m times the velocity v, i.e. p = mv, if the mass
is constant we obtain
d p
dt = d
dt (mv) = m dv
dt = F(t).
The rate of change of v, dv/dt, is precisely what we mean by the acceleration, and
so this equation is the familiar formula ‘F = ma’ written another way.
Example 5.4 A car of mass m is travelling at a speed v0 when it suddenly has to
brake; the brakes apply a constant force k until the car comes to rest. How long
does it take the car to stop, and how far does it travel before it comes to rest?
Using Newton’s second law we have
m dv
dt = −k,
since the force acts to oppose the motion of the car. Rewriting this as ˙v = −k/m
and integrating both sides between times 0 and t we get
v(t) −v0 = −
 t
0
k
m d˜t,
or
v(t) −v0 = −kt
m ,
and so
v(t) = v0 −kt
m ,
see Figure 5.6. The car stops when v(tc) = 0; this implies that tc = mv0/k.
Since the velocity v is the time derivative of the position x, v = ˙x and we have
dx
dt = v(t) = v0 −kt
m .

5.3 Velocity, acceleration and Newton’s second law of motion
31
0
0.5
1
1.5
2
2.5
0
5
10
15
20
25
30
35
time after braking (seconds)
speed (mph)
Fig. 5.6. The speed of a car that suddenly brakes: v(t) = v0 −(kt/m), with
m = 1000 kg and k = 6500 N and for initial speeds of 30 mph (solid line) and
35 mph (dashed line).
0
0.5
1
1.5
2
2.5
0
10
20
30
40
50
60
time after braking (seconds)
distance travelled (feet)
Fig. 5.7. The distanced moved by the car once the brakes have been applied. The
choice of k and m is as for Figure 5.6, and again the solid line is for an initial
speed of 30 mph and the dashed line is for an initial speed of 35 mph.
Integrating both sides between t = 0 and t = tc (when the car stops) we get
x(tc) −x(0) =
 tc
0

v0 −kt
m

dt =

v0t −kt2
2m
tc
t=0
= v0tc −kt2
c
2m .
Substituting for tc we have
x(tc) −x(0) = mv2
0
2k ,
as shown in Figure 5.7.

32
5 ‘Trivial’ differential equations
Since the stopping distance is proportional to the square of the speed, relatively
small increases in speed will have a marked effect on the stopping distance. The
stopping distance for a car travelling at 35 mph will be 49/36 of that for a car
travelling at 30 mph, almost half as much again for just 5 mph extra speed,3 see
Figure 5.11.
□
5.4 An equation that we cannot solve explicitly
We remarked above that there are many cases in which the best that we can do
is to ﬁnd the solution in the form of an integral, as in (5.13) where we wrote the
solution of the general equation
dy
dx = f (x)
with
y(x0) = y0
as
y(x) = y0 +
 x
x0
f (˜x) d˜x.
(5.15)
However, it can still be possible to describe qualitatively the behaviour of the
solution. Here we consider a simple example,
dx
dt = e−t2
x(0) = x0.
Integrating both sides between times 0 and t gives the solution
x(t) = x0 +
 t
0
e−˜t 2 d˜t.
(5.16)
This is as far as we can go without resorting to approximation, since there is no
explicit form for the anti-derivative of e−t2.
However, it is known4 that
 ∞
0
e−t2 dt = √/2.
3 Realistic values of m and k are m = 1000 kg and k = 6500 N (one newton is one kg m/s2) which means that
the stopping distances at 30 mph (≈13.4 m/s) and 35 mph (≈15.6 m/s) are 13.8 m and 18.7 m respectively (to
fall prey completely to the British imperial/metric confusion, that is roughly 40 feet and 60 feet respectively).
An extra 10 mph on the motorway means that the stopping distance at 80 mph is 64/49 of the stopping distance
at 70 mph, over a quarter as much again: 225 feet (≈75 m) at 70 mph (≈31 m/s) and 300 feet (≈100 m) at
80 mph (≈36 m/s).
4 This ‘Gaussian integral’ arises frequently, making it very frustrating that it cannot be evaluated explicitly. In
particular the normal distribution, which is fundamental in the theory of statistics, is described by a bell-shaped
curve whose equation is e−x2/2/
√
2; statistical tables for the normal distribution are essentially based on
evaluating the integral in (5.16) numerically.

Exercises
33
0
0.5
1
1.5
2
2.5
3
0
0.2
0.4
0.6
0.8
1
1.2
1.4
(√π)/2
t
x
Fig. 5.8. We cannot solve the equation explicitly, but we know that the solution
always increases and tends to a value √/2 greater than its initial value.
So we can say, since ˙x = e−t2 is always strictly greater than zero, that x(t) in-
creases as t increases, and that
x(t) →x0 + √/2
as t →∞, see Figure 5.8. Even though we cannot write down an explicit form for
the solution, we can still say exactly what happens ‘eventually’. In this way we
can still understand something about the behaviour of the solution. This ‘eventual’
behaviour is often referred to as the long-time, or time asymptotic, behaviour.
Exercises
5.1 Find the general solution of the following differential equations, and in each case ﬁnd
the particular solution that passes through the origin.
(i)
dθ
dt = sin t + cos t,
(ii)
dy
dx =
1
x2 −1
(use partial fractions)

34
5 ‘Trivial’ differential equations
(iii)
dU
dt = 4t ln t,
(iv)
dz
dx = xe−2x,
and
(v)
dT
dt = e−t sin 2t.
5.2 Find the function f (x) deﬁned for −/2 < x < /2 whose graph passes through the
point (0, 2) and has slope −tan x.
5.3 Find the function g(x) deﬁned for x > −1 that has slope ln(1 + x) and passes through
the origin.
5.4 Find the solutions of the following equations satisfying the given initial conditions:
(i)
˙x = sec2 t
with
x(/4) = 0,
(ii)
y′ = x −1
3x3
with
y(−1) = 1,
(iii)
dθ
dt = 2 sin2 t
with
θ(/4) = /4,
(iv)
x dV
dx = 1 + x2
with
V (1) = 1,
and
(v)
d
dt

x(t)e3t
= e−t
with
x(0) = 3,
5.5 The Navier–Stokes equations that govern ﬂuid ﬂow were given as an example in Chap-
ter 3 (see equations (3.1) and (3.2)). It is not possible to ﬁnd explicit solutions of these
equations in general. However, in certain cases the equations reduce to something
much simpler.
Suppose that a ﬂuid is ﬂowing down a pipe that has a circular cross-section of radius
a. Assuming that the velocity V of the ﬂuid depends only on its distance from the
centre of the pipe, the equation satisﬁed by V is
1
r
d
dr

r dV
dr

= −P,
where P is a positive constant.

Exercises
35
a
 V(r)=P(a2−r 2)/4
Fig. 5.9. The quadratic velocity proﬁle in a circular pipe.
Multiply by r and integrate once to show that
dV
dr = −Pr
2 + c
r
where c is an arbitrary constant. Integrate again to ﬁnd an expression for the velocity,
and then use the facts that (i) the velocity should be ﬁnite at all points in the pipe and
(ii) that ﬂuids ‘stick’ to boundaries (which means that V (a) = 0) to show that
V (r) = P
4 (a2 −r2),
see Figure 5.9. (This is known as Poiseuille ﬂow.)
5.6 An apple of mass m falls from a height h above the ground. Neglecting air resistance
its velocity satisﬁes
m dv
dt = −mg
v(0) = 0,
where v = ˙y and y is the height above ground level. Show that the apple hits the
ground when
t =

2h
g .
5.7 An artillery shell is ﬁred from a gun, leaving the muzzle with velocity V . If the gun is at
an angle θ to the horizontal then the initial horizontal velocity is V cos θ, and the initial
vertical velocity is V sin θ (see Figure 5.10). The horizontal velocity remains constant,
but the vertical velocity is affected by gravity, and obeys the equation ˙v = −g. How far
V
θ
Fig. 5.10. Firing a shell at muzzle velocity V at an angle θ to the horizontal. The
shell follows a parabolic path.

Fig. 5.11. A recent UK campaign to persuade drivers to cut their speed in town
from 35 mph to 30 mph. The ﬁlm at www.thinkroadsafety.gov.uk/
slowdown/download/slowdown.mpg makes the point more forcefully.

Exercises
37
does the shell travel before it hits the ground? (Give your answer in terms of V
and θ.)
5.8 In Dallas on 22 November 1963, President Kennedy was assassinated; by Lee
Harvey Oswald if you do not believe any of the conspiracy theories. Oswald ﬁred
a Mannlicher–Carcano riﬂe from approximately 90 m away. The sight on Oswald’s
riﬂe was less than ideal; if the bullet travelled in a straight line after leaving the riﬂe
(at a velocity of roughly 700 m/s) then the sight aimed about 10 cm too high at a target
90 m away. How much would the drop in the trajectory due to gravity compensate for
this? (The initial vertical velocity v is zero, and satisﬁes the equation ˙v = −g, while
the horizontal velocity is constant if we neglect air resistance.)
5.9 (T) This exercise ﬁlls in the gaps in the proof of the Fundamental Theorem of Calculus.
Suppose that f is continuous at x, i.e. given any ϵ > 0, there exists a δ = δ(ϵ) such
that
|˜x −x| ≤δ
⇒
| f (˜x) −f (x)| ≤ϵ.
By writing
f (x) = 1
δx
 x+δx
x
f (x) d˜x
show that for all δx with |δx| ≤δ(ϵ)
 f (x) −1
δx
 x+δx
x
f (˜x) d˜x
 ≤ϵ,
and hence that
lim
δx→0
1
δx
 x+δx
x
f (˜x) d˜x = f (x).
You will need to use the fact that

 b
a
g(x) dx
 ≤
 b
a
|g(x)| dx ≤(b −a) max
x∈[a,b] |g(x)|.

6
Existence and uniqueness of solutions
Because we are going to spend some time trying to solve equations like
dx
dt = f (x, t)
(6.1)
we need to be sure that such equations will actually have solutions. Clearly it is a
hopeless task to search for a solution of (6.1) if the solution does not exist (hunting
for a unicorn will take you a very long time).
6.1 The case for an abstract result
It is quite easy to write down equations that do not have any solutions, for example
x2 + t2 dx
dt = 0
x(0) = c
does not have any solutions if c ̸= 0: if t = 0 then the second term of the differen-
tial equation disappears and we must have x(0) = 0.
We have already seen that there are many possible solutions when we want to
ﬁnd a function whose graph has a particular slope; the question of the uniqueness
of solutions of a differential equation is somewhat subtle. However, we saw that by
specifying a particular initial condition we could tie down one particular solution.
So the problem that we will consider for our general theory will be the initial value
problem (IVP), consisting of the differential equation supplemented by an initial
condition,
dx
dt = f (x, t)
x(t0) = x0.
(6.2)
If we suppose for a moment that the independent variable is time, then the re-
quirement of uniqueness has a physical interpretation. Suppose that we specify an
initial condition ‘now’, i.e. at time t = 0; then the existence of a unique solution
38

6.1 The case for an abstract result
39
means that we can use the equation to predict the future, since the solution is
uniquely determined for t > 0. In this context, uniqueness of solutions is equiva-
lent to the requirement that our model be deterministic.
Uniqueness is also useful since occasionally we may be able to guess what the
solution of an equation is. If we substitute this guess in and it works, then it must in
fact be the solution since we know that there is no other. We have already used this
implicitly in Chapter 1 when we just checked that our solution N(t) = Nsek(t−s)
worked, and then assumed that it must be the only solution.
As with existence, uniqueness is not automatic. The innocuous looking IVP
dx/dt = √x
x(0) = 0
(6.3)
has an inﬁnite number of solutions. The ‘obvious’ solution is x(t) = 0 for all t ≥0.
But if you choose any value of c > 0, the function
xc(t) =

0
t ≤c
(t −c)2/4
t > c
also satisﬁes the equation. Here the solution ‘waits around’ at x = 0, before even-
tually ‘deciding’ (at time t = c) to wander off slowly to inﬁnity. Some of the solu-
tions of (6.3) are shown in Figure 6.1.
The issues of existence and uniqueness are real, and it is possible to come up
with very simple equations in which they fail. The good news is that there is a very
general theorem guaranteeing existence and uniqueness, with a hypothesis which
is very simple to check.
0
1
2
3
4
5
6
7
0
0.5
1
1.5
2
2.5
3
t
x
Fig. 6.1. A number of solutions of equation (6.3).

40
6 Existence and uniqueness of solutions
6.2 The existence and uniqueness theorem
The proof of the general existence and uniqueness theorem is beyond the scope
of this book, and we will just state the result. However, if you are interested
Exercise 6.4 leads you through an outline version of the proof.
In order to state the theorem properly we need to have a more precise idea of
what we mean by a ‘solution’ of the initial value problem (6.2). The main point
of the deﬁnition is that we allow for a solution to be deﬁned only for some interval
of t values, and do not require it to be deﬁned for every t ∈R.
Deﬁnition 6.1 Given an open interval I that contains t0, a solution of the initial
value problem
dx
dt (t) = f (x, t)
with
x(t0) = x0
(6.4)
on I is a differentiable function x(t) deﬁned on I, with x(t0) = x0 and ˙x(t) =
f (x, t) for all t ∈I.
The way that the deﬁnition speciﬁes the interval on which the solution exists
(rather than insisting that it be deﬁned for every value of t ∈R) may seem pedantic
at ﬁrst, but we will soon see that this is necessary even for some very simple
equations, since it is possible for the solution to ‘blow up’ in a ﬁnite time.
But for now, given our formal deﬁnition of a solution, we can state the existence
and uniqueness theorem.1
Theorem 6.2 If f (x, t) and ∂f/∂x(x, t) are continuous for a < x < b and for
c < t < d then for any x0 ∈(a, b) and t0 ∈(c, d) the initial value problem (6.4)
has a unique solution on some open interval I containing t0.
Essentially the result says that if the function f (x, t) is ‘sufﬁciently nice’ then
the equation will have a unique solution, at least close to t = t0 (see Figure 6.2).
However, the result tells us nothing about how large the interval is on which the
solution can be deﬁned.
In almost all of the examples we meet, f will be ‘sufﬁciently nice’; but we have
already seen one simple example in (6.3) for which there is no uniqueness. This
does not contradict Theorem 6.2, since the derivative of x1/2 is inﬁnite at x = 0:
when f (x) = x1/2, we have f ′(x) = 1
2x−1/2, and this becomes inﬁnite as x ↓0,
so f ′ is certainly not continuous at x = 0.
1 In fact the conditions on f in the theorem are a little stronger than they need to be. It is only necessary that the
function f is a Lipschitz continuous function of x, which means that
| f (x, t) −f (y, t)| ≤L|x −y|
(6.5)
for some constant L. Any function with continuous ﬁrst derivative is Lipschitz continuous (see Exercise 6.2),
but not every function that is Lipschitz continuous has continuous ﬁrst derivative (e.g. f (x) = |x|).

6.3 Maximal interval of existence
41
 x0
 t0
(
)
Fig. 6.2. Given an initial condition x(t0) = x0, the existence and uniqueness the-
orem only guarantees the existence of a solution deﬁned on some open interval
(marked by the bold line on the horizontal axis) containing the initial time t0.
0
0.01
0.02
0.03
0.04
0.05
0.06
0.07
0.08
0.09
0.1
0
5
10
15
20
25
30
35
40
45
50
x
Fig. 6.3. The derivative of x1/2, plotted here against x, is not continuous at zero,
where it is inﬁnite.
6.3 Maximal interval of existence
We now give an example showing that we need the freedom to specify the inter-
val on which the solution of an equation exists if we want a result as general as
Theorem 6.2:
dx
dt = x2
x(0) = x0.
(6.6)
Since x2 and its derivative 2x are continuous, the equation certainly has a unique
solution that exists in some open interval containing t = 0. We will see how to

42
6 Existence and uniqueness of solutions
derive the solution of this equation in Chapter 8. For now observe that
x(t) =
1
x−1
0
−t
(6.7)
satisﬁes the equation (provided that x0 ̸= 0): clearly when t = 0 we have x(0) =
x0, and differentiating gives
dx
dt = −1 × −

x−1
0
−t
−2 =

1
x−1
0
−t
2
= [x(t)]2,
so that the equation is satisﬁed. Since we know that the solution of the equation is
unique, we must have the solution.
Our solution has some interesting properties. If x0 > 0 then the denominator
is initially positive (at t = 0), but decreases as t increases until it reaches zero at
time t = x−1
0 . This means that the solution, x(t), has become inﬁnite by the time
t = x−1
0 ; we say that it ‘blows up’ in a ﬁnite time.
Things are much nicer, though, if we want to see where our solution came from
in the past. We can decrease t (from zero) as much as we like, since as t de-
creases the denominator becomes larger, and so the solution itself tends to zero
as t →−∞. So when x0 > 0 we can deﬁne the solution of (6.6) on the interval
(−∞, x−1
0 ), but there is no way to deﬁne the solution on an interval that extends
further into the future beyond the time t = x−1
0 . We refer to (−∞, x−1
0 ) as the
maximal interval of existence for (6.6).
Note that Figure 6.4 also shows that solutions with x0 < 0 tend to −∞as t
decreases towards a ﬁnite t∗< 0. When x0 < 0 the maximal interval of existence
is (x−1
0 , +∞), and only for x0 = 0 can we deﬁne a solution for all t ∈R (and then
the solution is x(t) ≡0).
The two ill-behaved equations in this chapter (˙x = x1/2 and ˙x = x2) should
serve as cautionary examples as to the limitations of the existence and uniqueness
theorem. That said, almost all the examples we meet in what follows will have
unique solutions that exist at least for all t ≥0.
6.4 The Clay Mathematics Institute’s $1 000 000 question
The questions of existence and uniqueness are somewhat dry, but there are still ex-
tremely important mathematical models for which these issues are not resolved.
Outstandingly, it is still not known whether the Navier–Stokes equations that

6.4 The Clay Mathematics Institute’s $1 000 000 question
43
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−50
−40
−30
−20
−10
0
10
20
30
40
50
t
x
Fig. 6.4. For positive initial conditions the solutions of ˙x = x2 blow up in a ﬁnite
time, but exist for all negative values of t; while for negative initial conditions the
solutions blow up for a ﬁnite value of t < 0 but exist for all t > 0.
model the ﬂow of ﬂuids,
ρ
∂u
∂t + (u · ∇)u

−µ u + ∇p = f
∇· u = 0
(cf. (3.3)), have unique solutions that exist for all positive times.
These equations are the basis of computational design of everything that in-
volves ﬂuid ﬂow; given that the term ‘ﬂuid’ includes both liquids (in particular
water) and gases (in particular air), numerical methods based on these equations
are extremely important commercially. Clearly given the ﬁnancial investment in-
volved, people are conﬁdent that these equations really can predict the behaviour
of physical systems, but currently we have no guarantee. Most tellingly, you can-
not prove that a numerical approximation is ‘close’ to the ‘true solution’ if you do
not even know that such a solution exists.
For the year 2000 the Clay Mathematics Institute, based in America, announced
seven Millennium Prize Problems; for the solution of any of these they will award
a prize of one million dollars.2 One of these problems is to determine whether
or not the three-dimensional Navier–Stokes equations are indeed a good physical
model, i.e. whether or not they have unique solutions valid for all positive times.
There are of course, two ways to win this prize: either to invent some insightful
new mathematics that will prove the existence of unique solutions; or to dream up
a single initial condition for which the solution breaks down.
2 See www.claymath.org/index.htm

44
6 Existence and uniqueness of solutions
Exercises
6.1 Which of the following differential equations have unique solutions (at least on some
small time interval) for any non-negative initial condition (x(0) ≥0)?
(i) ˙x = x(1 −x2)
(ii) ˙x = x3
(iii) ˙x = x1/3
(iv) ˙x = x1/2(1 + x)2
(v) ˙x = (1 + x)3/2.
6.2 (T) The Mean Value Theorem says that if f is differentiable on an interval [a, b] then
f (a) −f (b) = (b −a) f ′(c) for some c ∈(a, b). Suppose that f (x) is differentiable
with | f ′(x)| ≤L for a ≤x ≤b. Use the Mean Value Theorem to show that for a ≤
x, y ≤b we have
| f (x) −f (y)| ≤L|x −y|.
6.3 (T) This exercise gives a simple proof of the uniqueness of solutions of
˙x = f (x, t)
x(t0) = x0,
(E6.1)
under the assumption that
| f (x, t) −f (y, t)| ≤L|x −y|.
(E6.2)
Suppose that x(t) and y(t) are two solutions of (E6.1). Write down the differential
equation satisﬁed by z(t) = x(t) −y(t), and hence show that
d
dt |z|2 = 2z[ f (x(t), t) −f (y(t), t)].
Now use (E6.2) to show that
d
dt |z|2 ≤2L|z|2.
If dZ/dt ≤cZ it follows that Z(t) ≤Z(t0)ec(t−t0) (see Exercise 9.7): use this to de-
duce that the solution of (E6.1) is unique. Hint: any two solutions of (E6.1) agree when
t = t0.
6.4 (T) The proof of existence of solutions is much more involved than the proof of their
uniqueness. We will consider here the slightly simpler case
˙x = f (x)
with
x(0) = x0,
(E6.3)
assuming that
| f (x) −f (y)| ≤L|x −y|.
(E6.4)
The ﬁrst step is to convert the differential equation into an integral equation that is
easier to deal with: we integrate both sides of (E6.3) between times 0 and t to give
x(t) = x0 +
 t
0
f (x(˜t)) d˜t.
(E6.5)

Exercises
45
This integral equation is equivalent to the original differential equation; any solution
of (E6.5) will solve (E6.3), and vice versa.
The idea behind the method is to use the right-hand side of (E6.5) as a means of
reﬁning any ‘guess’ of the solution xn(t) by replacing it with
xn+1(t) = x0 +
 t
0
f (xn(˜t)) d˜t.
(E6.6)
We start with x0(t) = x0 for all t, set
x1(t) = x0 +
 t
0
f (x0) d˜t,
and continue in this way using (E6.6). The hope is that xn(t) will converge to the
solution of the differential equation as n →∞.
(i) Use (E6.4) to show that
|xn+1(t) −xn(t)| ≤L
 t
0
|xn(˜t) −xn−1(˜t)| d˜t,
and deduce that
max
t∈[0,1/2L] |xn+1(t) −xn(t)| ≤1
2
max
t∈[0,1/2L] |xn(t) −xn−1(t)|.
(E6.7)
(ii) Using (E6.7) show that
max
t∈[0,1/2L] |xn+1(t) −xn(t)| ≤
1
2n−1
max
t∈[0,1/2L] |x1(t) −x0(t)|.
(iii) By writing
xn(t) = [xn(t) −xn−1(t)] + [xn−1(t) −xn−2(t)]
+ · · · + [x1(t) −x0(t)] + x0(t)
deduce that
max
t∈[0,1/2L] |xn(t) −xm(t)| ≤
1
2N−2
max
t∈[0,1/2L] |x1(t) −x0(t)|
(E6.8)
for all n, m ≥N.
It follows that xn(t) converges to some function x∞(t) as n →∞, and therefore taking
limits in both sides of (E6.6) implies that
x∞(t) = x0 +
 t
0
f (x∞(˜t)) d˜t.
Thus x∞(t) satisﬁes (E6.5), and so is a solution of the differential equation. The pre-
vious exercise shows that this solution is unique.

7
Scalar autonomous ODEs
For the most part when considering ﬁrst order equations we will concentrate on
ﬁnding explicit solutions. However, in this chapter we will see how, for the partic-
ular class of equations of the form
dx
dt = f (x),
we can understand the solutions ‘qualitatively’, even if we cannot (or do not) write
down their solutions explicitly.
What this means is that instead of writing ‘x(t) = something’ we describe how
the solutions behave, e.g. ‘any solution starting with x(0) between zero and one
tends to x = 1 as t →∞’ or ‘the point x = −1 is stable’. There is a very simple
way to represent all this information about solutions pictorially, and the method
essentially reduces to sketching the graph of the function f (in fact we only need
to know where f is positive and negative). Nevertheless, the qualitative results we
will obtain are completely rigorous.
7.1 The qualitative approach
The key observation is that the existence and uniqueness result of Theorem 6.2
tells us that, provided f is ‘nice’, a solution of
dx
dt = f (x)
(7.1)
is completely determined by its value at any time t. The equation itself can then be
used to determine whether x(t) is increasing or decreasing, depending on the sign
of f .
The easiest way to think of this kind of equation is to imagine that x(t) repre-
sents the position of a particle moving on a line at time t. We can then talk about the
‘velocity of the particle’ rather than the more cumbersome ‘rate of change of x’.
46

7.1 The qualitative approach
47
Fig. 7.1. A sketch of the function f against x, and the phase diagram for the
equation ˙x = f (x). On the phase diagram the stationary points are represented as
crosses and the arrows indicate whether the solution is increasing or decreasing.
Whatever the equation really represents, we can use the particle idea while solv-
ing it, and then reinterpret our results for the original application when we have
ﬁnished.
In order to understand how solutions behave we ﬁrst ﬁnd all the values of x at
which the particle does not move; this happens at the points x∗where f (x∗) = 0.
As is often the case with fundamental ideas, such points have many names; we will
call them stationary points.1
In regions where f (x) > 0 the solution x(t) is increasing, and so the particle
is moving to the right; similarly wherever f (x) < 0 the solution x(t) is decreas-
ing, and the particle is moving to the left. Note that the particle cannot reverse
the direction in which it is moving; if it were to do this then at some time t∗
it would have to be instantaneously at rest, so that ˙x(t∗) = f (x(t∗)) = 0. But
then x(t∗) would be a stationary point, and so the particle would not be able to
move.
The simplest way to present all this information is to draw a line representing the
x coordinate. Stationary points are usually indicated by a cross (×); we then draw
arrows on the line indicating the direction in which x(t) is changing: if f (x) > 0
then the particle will move to the right and if f (x) < 0 then the particle will move
to the left. If we sketch the graph of f then it is easy to see the regions in which f
is positive and negative. An example is shown in Figure 7.1.
The picture of the line, with the stationary points and the direction of travel of
the solution indicated, is known as the ‘phase diagram’ or ‘phase portrait’, which
is shown on its own in Figure 7.2. (Figure 7.1 has two components; the phase
diagram, and the sketch of f that makes it easier to draw.) With this kind of picture
1 Other common terms are equilibrium points, ﬁxed points and critical points. ‘Equilibrium point’ has a more
physical ﬂavour than the general tone of this book, and we will reserve the term ‘ﬁxed point’ for use with
iterated maps in Chapter 23 (a ﬁxed point will be a point for which x∗= f (x∗)). We will use the term ‘critical
point’ for a point at which a function F(x) has all its partial derivatives zero, see Appendix C.

48
7 Scalar autonomous ODEs
Fig. 7.2. The phase diagram from Figure 7.1.
qualitative behaviour of the solutions at a glance, even when we cannot write down
the solutions explicitly.
7.2 Stability, instability and bifurcation
Looking at the phase diagram for the above example, we can see that some sta-
tionary points are ‘attracting’ (nearby solutions approach), while some appear to
be ‘repelling’ (nearby solutions move away). These ideas can be made mathemat-
ically precise and are extremely important in applications.
A stationary point is stable if when you start close enough to it you stay close
to it. More precisely, a stationary point x∗is stable if given any ϵ > 0 there exists
a δ > 0 such that
|x0 −x∗| < δ



start close enough
⇒
|x(t) −x∗| < ϵ
for all
t ≥0



stay close
.
(7.2)
The stationary points in the example above have the stronger property of being
attracting, which means that if you start close enough you actually tend to the
stationary point: there exists a δ > 0 such that
|x0 −x∗| < δ



start close enough
⇒
x(t) →x∗
as
t →+∞



tend to
.
(7.3)
In one-dimensional systems attracting points are stable (see Exercise 7.9) but
this is not true in general. Conversely, an example with many stable stationary
points that are not attracting is
dx
dt =
⎧
⎨
⎩
−x
x < 0
0
0 ≤x ≤1
1 −x
x > 1.
Here, all the points in the interval [0, 1] are stationary points, and they are all
stable. However, none of them are attracting, since there are nearby points that
move no closer. The phase diagram is shown in Figure 7.3.
A stationary point is unstable if it is not stable; this means that no matter how
close (δ) you start you will always move some stationary distance (ϵ) away: there
exists an ϵ > 0 such that whatever δ > 0 you take there is a point with |x0 −x∗|
< δ but |x(t) −x∗| > ϵ for some t > 0.
The stationary points from Figure 7.2 are labelled according to their stability or
instability in Figure 7.4.

7.3 Analytic conditions for stability and instability
49
−1
−0.5
0
0.5
1
1.5
2
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Fig. 7.3. The thick line consists entirely of stationary points, all of which are
stable but none of which are attracting.
S
U
U
S
Fig. 7.4. The phase diagram from Figure 7.2, but with the stationary points la-
belled according to their stability type, S for stable and U for unstable.
Fig. 7.5. The stability or instability of a stationary point x∗can be determined
from the value of f ′(x∗) provided that f ′(x∗) ̸= 0. If f ′(x∗) < 0 then the sta-
tionary point is stable, and if f ′(x∗) > 0 the stationary point is unstable.
7.3 Analytic conditions for stability and instability
There are very simple conditions on the derivative of f which will let us know
whether a stationary point x∗is stable or unstable without having to sketch the
graph of f .
If the graph of f near x∗looks as shown in the left-hand side of Figure 7.5,
i.e. if f ′(x∗) < 0, then the point will be stable, while if the graph of f looks
like the right-hand side, i.e. if f ′(x∗) > 0, then the point will be unstable. Only

50
7 Scalar autonomous ODEs
stable
unstable/semi-stable
unstable/semi-stable
unstable
Fig. 7.6. The various stability possibilities when f ′(x∗) = 0.
when f ′(x∗) = 0 is there any ambiguity; there are four possibilities, pictured in
Figure 7.6. The top right and bottom left cases are sometimes called ‘semi-stable’,
since the stationary point is stable ‘on one side’ and unstable on the other.
7.4 Structural stability and bifurcations
Observe that if f ′(x∗) ̸= 0 then making small changes to the function f will not
have a signiﬁcant effect on the graph of f near x∗. (The easiest ‘small change’ to
imagine is adding or subtracting a constant, which will pull the graph of f up or
down.) After the change there will still be a stationary point close to x∗with the
same stability properties (see Exercise 7.11).
However, if f ′(x∗) = 0 then we can make small changes to f (x) and drasti-
cally affect the ‘picture’ near x∗. For example, in the top right case of Figure 7.6,
increasing f (x) by any constant c > 0 will mean we no longer have a stationary
point.
When we make a small change to f but the phase diagram changes drastically
we say that the equation has undergone a bifurcation. In these simple examples, we
cannot have a bifurcation near x∗unless f ′(x∗) = 0. When small changes to f (x)
cannot effect the qualitative nature of the phase diagram we say that ˙x = f (x) is
structurally stable.
We will look at a particular example of a bifurcation in Section 7.6; watch for a
stationary point with f ′(x∗) = 0.
7.5 Some examples
We now consider various examples using this graphical method.

7.5 Some examples
51
0
M
Fig. 7.7. The phase diagram for the population model (7.4). Note that this picture
includes solutions with p < 0, which, while mathematically sensible, are irrele-
vant for this application.
7.5.1 A population model
The equation
d p
dt = kp

1 −p
M

with
k, M > 0
(7.4)
is a model for the change in the size of a population.2 We will study this model
in more detail in the next chapter, but for now we try to understand its qualitative
behaviour.
The ﬁrst step is to ﬁnd the stationary points. These occur where the right-hand
side is zero, i.e. when
kp

1 −p
M

= 0,
so they are p = 0 and p = M. If we sketch the graph of f (p) = kp(1 −(p/M))
then it is easy to draw the phase diagram, remembering that solutions move to the
right whenever f > 0 and to the left whenever f < 0. The phase diagram is shown
in Figure 7.7. It is easy to see from the diagram that provided that we start with a
positive population then it will eventually settle down to the value at the stationary
point p = M; smaller populations will tend to increase, while larger populations
will shrink towards this value.
We can check to stability of the stationary points analytically by looking at the
derivative of f ,
f ′(p) = k −(2kp/M).
At the origin f ′(0) = k > 0, and the origin is unstable (as we expected), and
f ′(M) = −k < 0, conﬁrming that the stationary point at p = M is stable.
Note that this kind of solution can tell us what happens eventually, and how
the population changes qualitatively. But it only allows us to make a very limited
2 There are some very reasonable objections to this model; in particular, unlike the number of people in a popu-
lation, the variable p does not have to be an integer. We can get round this to some extent by claiming that p is
‘the population in millions’, and then p can be a decimal. There are still values that do not correspond to whole
numbers of people, but the equation will now be a good approximation.

52
7 Scalar autonomous ODEs
0
M
0
0
t
p
M
Fig. 7.8. The phase diagram (on the right) reﬂects the behaviour of solutions (a
collection of which are shown on the left).
number of quantitative predictions. For example, if we know that equation (7.4) is
the right model for our population, but do not know the values of k and M, there
is no way that we can use our phase diagram to ﬁnd k and M given a collection
of data. However, this is possible using the explicit solution, as we will see in the
next chapter.
Figure 7.8, shows how the phase diagram (rotated to be vertical in the ﬁgure)
reﬂects the behaviour of the solutions, a collection of which are plotted against t.
7.5.2 Terminal velocity
Sometimes we do not need an explicit solution to ﬁnd the quantitative information
we require. Here we will use the phase diagram to ﬁnd the terminal velocity of a
falling object.
Suppose that a body of mass m is falling under gravity g and is subject to an
air resistance proportional to the square of its velocity, kv2. The equation for the
downward velocity v is
m dv
dt = mg −kv|v|,
(7.5)
since gravity serves to accelerate the particle, and the air resistance acts in the
opposite direction to v.
Provided that the particle is moving downwards, so that v > 0, equation (7.5)
becomes
m dv
dt = mg −kv2.

7.5 Some examples
53
√(mg/k)
Fig. 7.9. You can simply read off the terminal velocity v = √mg/k.
We can rewrite this as
dv
dt = f (v) = g −k
m v2.
For this equation there is only one stationary point, when
g −k
m v2 = 0,
i.e. when v = v∗= √mg/k. This point is stable, as can be seen by looking at
the derivative of f at v∗: since f ′(v) = −2kv/m we have f ′(v∗) = −2√gk/m
< 0.
The phase diagram is shown in Figure 7.9; it is clear that there is an attract-
ing stationary point at v = √mg/k. This is the terminal velocity, since v(t) ap-
proaches this value whatever the initial condition.
For a skydiver of mass 100 kg in freefall, we can take k ≈1/3 kg/m and g ≈
9.8 m/s2. It follows that the terminal velocity of the skydiver is
v =
√
100 × 9.8 × 3 ≈54.2 m/s.
7.5.3 What have we lost?
We will now see that we are missing some, at times vital, information if we only
rely on the phase diagram. The phase diagrams for the two equations ˙x = |x| and
˙x = x2 are shown in Figure 7.10: although the equations are different their phase
diagrams are the same.
In the next chapter we will see how to calculate the solutions of both of these
equations. For now we will assume that we know what these solutions are; for an
initial condition x(0) = x0 > 0, the solution of ˙x = |x| is
x(t) = x0et,

54
7 Scalar autonomous ODEs
Fig. 7.10. Different equations can have the same phase diagram; on the left is the
phase diagram for ˙x = |x|, and on the right the phase diagram for ˙x = x2.
while the solution of ˙x = x2 is
x(t) =
1
x−1
0
−t
,
(cf. (6.7)).
The ﬁrst solution increases to inﬁnity, but is deﬁned for all t ≥0 (in fact for
all t ∈R). However, we have already used the equation ˙x = x2 to show that it is
possible for solutions to blow up in ﬁnite time (x(t) →∞as t →x−1
0 ). This ﬁnite
time blowup behaviour is not captured in any way by our phase diagram.
So although the phase diagram gives the correct qualitative behaviour, we have
lost all information on the rates at which things happen. When the equation exhibits
blow up of solutions in a ﬁnite time, this is particularly unfortunate.
7.6 The pitchfork bifurcation
We now consider the equation
˙x = x(k −x2),
(7.6)
where k is a parameter. By varying k we can study a whole family of differen-
tial equations. We will see that the qualitative behaviour of the solutions of (7.6)
changes drastically as k passes through zero.
When k ≤0 there is only one stationary point, that at x = 0. If we write
f (x) = x(k −x2) then f ′(x) = k −3x2, and at the origin we have f ′(0) = k. It
follows that for k < 0 this stationary point is stable. The phase diagram is shown in
Figure 7.11, together with the graph of f .
When k = 0 there is still only the one stationary point at x = 0, although now
f ′(0) = 0. In order to determine the stability of the origin when k = 0 we have to
sketch the graph of f (x) = −x3. It is then clear that the origin is still stable, and
that the phase diagram is the same for k = 0 as it was for k < 0, see Figure 7.12.
Since f ′(0) = 0 when k = 0, there is the possibility of a bifurcation as k
changes from negative to positive (see Section 7.4). When k > 0 there are two

7.6 The pitchfork bifurcation
55
0
Fig. 7.11. The phase diagram when k ≤0, and the graph of f .
0
Fig. 7.12. The phase diagram when k = 0, and the graph of f (x) = −x3.
0
−√k
√k
Fig. 7.13. The phase diagram when k > 0, and the graph of f .
new stationary points at x = ±
√
k. While the origin is no longer stable, since
f ′(0) = k > 0, the new ﬁxed points are both stable, since f ′(±
√
k) = −2k < 0.
The phase diagram for this case is that shown in Figure 7.13.
You can see that the phase diagram has changed drastically as k has gone from
being negative to positive. We have gone from having one stable stationary point
for k < 0 to having three stationary points when k > 0; two of these are stable,
and the origin has become unstable.
We can draw a ‘bifurcation diagram’ to show these changes. The idea is to draw
a graph where the horizontal axis represents the parameter k, and for each value
of k we plot the location of the stationary points on the vertical axis, using a solid
line when they are stable and a dashed line when they are unstable. This gives

56
7 Scalar autonomous ODEs
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
parameter k
stationary points
Fig. 7.14. The pitchfork bifurcation; stationary points are plotted against k. Solid
lines indicate stable points, and the dashed line an unstable point.
the picture in Figure 7.14. For fairly obvious reasons this is known as a ‘pitchfork
bifurcation’.
7.7 Dynamical systems
The qualitative approach we have adopted here is the main viewpoint used in the
general theory of dynamical systems. A dynamical system has two components: the
phase space (or ‘state space’), which consists of all possible ‘states’ of the system
(for the scalar equations of this chapter this is the line R, covering all possible
values of x), and the ‘dynamics’ which describe how these states change in time
(for us the dynamics were determined by the solutions of the differential equation
˙x = f (x)).
With the advent of more powerful computers there have been major advances in
the theory of dynamical systems in recent years, and the subject received a lot of
attention in the 1980s under the media-friendly ‘chaos’ banner. We will see more
examples of dynamical systems later in the book.
Exercises
7.1 For each of the following differential equations draw the phase diagram, labelling the
stationary points as stable or unstable.
(i) ˙x = −x + 1
(ii) ˙x = x(2 −x)
(iii) ˙x = (1 + x)(2 −x) sin x
(iv) ˙x = −x(1 −x)(2 −x)
(v) ˙x = x2 −x4

Exercises
57
7.2 For the equations in Exercise 7.1 determine the stability of the stationary points ana-
lytically, by considering the sign of the derivative of the right-hand side.
7.3 For all positive values of c ﬁnd all the stationary points of
dx
dt = sin x + c,
and determine analytically which are stable and unstable. Draw the portion of the
phase diagram between − and . There are three different cases, 0 ≤c < 1, c = 1,
and c > 1. You will need to be more careful with the case c = 1.
7.4 A simple model of the spread of an infection in a population is
˙H = −kI H
˙I = kI H,
where H(t) is the number of healthy people, I (t) the number of infected people
and k the rate of infection. Since (d/dt)(H + I) = 0, it follows that the size of the
population is constant, H + I = N, say. Substitute I = N −H in order to obtain a
single equation for H(t),
dH
dt = −kH(N −H).
Determine the stability of the stationary points for this equation, and draw its phase
diagram. Deduce that eventually all the population becomes infected.
7.5 Consider the equation
dx
dt = f (x) ≡x2 −k.
Draw the phase diagram for the three cases k < 0, k = 0 and k > 0, labelling the
stationary points as stable or unstable in each case. Find the stability of the stationary
points using an analytic method when k > 0. Show that f ′(0) = 0 when k = 0. Why
is this signiﬁcant?
Draw the bifurcation diagram, with k on the horizontal axis and the ﬁxed points
plotted against k, indicating stable ﬁxed points by a solid line and unstable ﬁxed
points by a dashed line. (This is known as a saddle node bifurcation.)
7.6 Draw the phase diagram for the equation
˙x = g(x) = kx −x2
for k < 0, k = 0 and k > 0. Check the stability of the stationary points by considering
g′(x), and show that the two stationary points exchange stability as k passes through
zero. Draw the bifurcation diagram for this transcritical bifurcation.
7.7 One equation can exhibit a number of bifurcations. Find, depending on the values of
k, all the stationary points of the equation
˙x = h(x) = −(1 + x)(x2 −k)

58
7 Scalar autonomous ODEs
and by considering h′(x) determine their stability. At which points, and for which
values of k, are there possible bifurcations?
Draw representative phase diagrams for the ﬁve distinct parameter ranges k < 0,
k = 0, 0 < k < 1, k = 1 and k > 1, and then draw the bifurcation diagram. Identify
the type of the two bifurcations.
In the remaining exercises assume that f is a C1 function, i.e. that both f and d f/dx are
continuous functions. Note that such an f is smooth enough to guarantee that the equation
˙x = f (x) with x(t0) = x0 has a unique solution. You may also assume that the solutions
are deﬁned for all t ≥0.
7.8 (T) Let x(t) be one solution of the differential equation
˙x = f (x).
Show that
(i) if f (x(t∗)) = 0 for some t∗then x(t) = x(t∗) for all t ∈R (the solution is con-
stant, and x(t∗) is a stationary point); and hence
(ii) if f (x(t∗)) > 0 for some t∗then f (x(t)) > 0 for all t ∈R (the solution can-
not ‘reverse direction’). Hint: Use the Intermediate Value Theorem: if g is
a continuous function with g(a) < 0 and g(b) > 0 then there is a point c
between a and b with g(c) = 0.
Of course, a similar result to (ii) holds if f (x(t∗)) < 0 for some t∗.
7.9 (T) Show that for autonomous scalar equations, if x∗is attracting then it must also be
stable. Hint: use (ii) above.
7.10 (T) Suppose that x(t) is a solution of ˙x = f (x) that is moving to the right. Show that
either x(t) →+∞, or x(t) →x∗, where x∗is a stationary point. (Hint: If x(t) does
not tend to inﬁnity then it is increasing and bounded above, and so tends to a limit
x∗. Show that in this case we must have f (x∗) = 0.) A similar result holds if x(t) is
moving to the left, with +∞replaced by −∞.
7.11 (T) Suppose that ˙x = f (x) has a stable stationary point at x0, with f (x0) < 0. Let
g be another C1 function. Use the following scalar version of the Implicit Function
Theorem to show that for ϵ sufﬁciently small the equation
˙x = f (x) + ϵg(x)
has a unique stationary point near x0 which is still stable.
Theorem. Suppose that h(x, ϵ), ∂h/∂x, ∂h/∂ϵ are all continuous functions of both
x and ϵ. Suppose also that h(x0, 0) = 0 and ∂h/∂x(x0, 0) ̸= 0. Then there is an open
interval I that contains x0 such that for each ϵ sufﬁciently small there is a unique
solution y(ϵ) ∈I of
h(y(ϵ), ϵ) = 0,
and y(ϵ) depends continuously on ϵ.

8
Separable equations
We now begin our survey of the various different classes of equations that we can
solve explicitly. Both the ‘trivial’ equations
dx
dt (t) = f (t)
of Chapter 5 and the autonomous equations
dx
dt (t) = f (x)
of the previous chapter are particular cases of the separable equation
dx
dt = f (x)g(t)
(8.1)
which we study in this chapter.
8.1 The solution ‘recipe’
If you have already seen these equations, then you will probably be used to solving
them in the following way. If these equations are new to you, take careful note; this
is the practical way of ﬁnding a solution. However, there are steps here that should
make you uneasy.
We start with the equation
dx
dt = f (x)g(t).
Now divide by f (x) and ‘multiply up by dt’ to obtain
1
f (x) dx = g(t) dt.
59

60
8 Separable equations
This is ‘separating the variables’, since we now have all the xs on one side and all
the ts on the other. For the general solution we integrate both sides to get

1
f (x) dx =

g(t) dt.
(8.2)
Alternatively, if we want to take into account an initial condition x(t0) = x0 then
we integrate between the limits that correspond to times t0 and t: for the left-hand
side these are x(t0) and x(t), while on the right-hand side they are just t0 and t.
This gives
 x(t)
x0
1
f (x) dx =
 t
t0
g(˜t) d˜t.
(8.3)
We now use this recipe to ﬁnd the solution of the equation we used in Chapter 6
to show that the solutions of a differential equation can blow up in a ﬁnite amount
of time (i.e. x(t) →+∞as t →t∗< ∞). At the time we had no method for
solving this equation, and just wrote down the solution, but now we can use the
separation method to ﬁnd it for ourselves.
Example 8.1 Find the solution of the initial value problem
dx
dt = x2
x(0) = x0.
If x0 = 0 then x(t) = 0 for all t. Otherwise we can separate the variables to give
1
x2 dx = dt.
Integrating between limits corresponding to times 0 and t,
 x(t)
x0
1
x2 dx =
 t
0
d˜t,
we obtain

−1
x
x(t)
x=x0
= t.
Therefore
−1
x(t) + 1
x0
= t
which simpliﬁes to give
x(t) =
1
x−1
0
−t
,
as we claimed before (cf. (6.7)).
□

8.2 The linear equation ˙x = λx
61
8.2 The linear equation ˙x = λx
We now ﬁnd the solution of the simplest possible linear differential equation,
dx
dt = λx
(8.4)
with the initial condition x(t0) = x0.
This example is absolutely fundamental (the reasons for this will become appar-
ent later) and you should really only have to solve this equation ‘long-hand’ once
or twice before you are happy to write down the solution with no calculation.
First note that if x0 = 0 then x(t) = 0 for all t. Otherwise, if x ̸= 0 then we can
divide by x and ‘multiply up by dt’ to give
dx
x = λ dt.
We now integrate both sides between the limits corresponding to the times t0
and t; that is, x0 and x(t) on the left, and t0 and t on the right; and get
 x(t)
x0
dx
x =
 t
t0
λ d˜t,
which gives1

ln |x|
x(t)
x=x0
= λ(t −t0).
So we have
ln |x(t)| −ln |x0| = λ(t −t0),
and taking exponentials (e to the power) of both sides gives
|x(t)|
|x0| = eλ(t−t0).
To work out what to do about the modulus signs, the easiest thing is to draw the
phase diagram. For the case λ > 0 this is shown in Figure 8.1, from which we can
see that x(t) and x0 have the same sign. It follows that we can remove the modulus
signs and multiply up to give
x(t) = x0eλ(t−t0).
1 Many of the integrals in this chapter will involve logarithms, and the annoying modulus signs that come with
them. We will have to take some care to work out how to remove them for our ﬁnal answers; the most useful
method is to use the phase diagram, as the examples show.

62
8 Separable equations
0
Fig. 8.1. The phase diagram for ˙x = λx when λ > 0 (taking λ < 0 would reverse
the direction of the arrows).
Note that the general solution of (8.4) is
x(t) = Aeλt,
see also Exercise 8.5.
8.2.1 Exponential decay and exponential growth
We looked at the solution of equation (8.4) with λ < 0 in Chapter 1, and applied
it to the example of radioactive decay. We saw that the solutions decay to zero
exponentially fast, and that the rate of decay could be characterised by the half-
life; the solution halves in a ﬁxed time.
When λ > 0 the solutions tend to inﬁnity as t →∞, and increase exponentially
fast. In this case the size of the solution will double after a ﬁxed time, given by t2,
where
2 = eλt2,
i.e. t2 = ln 2/λ. In the following section we look at the use of this linear equation
as a simple population model.
8.3 Malthus’ population model
The simple linear equation
d p
dt = kp
with
k > 0
(8.5)
was proposed in 1798 by the English economist Thomas Malthus as a basic model
for population growth. Here the increase in the population is taken to be propor-
tional to the total number of people, and k is a constant representing the rate of
growth (the difference between the birthrate and the deathrate). This model pre-
dicts exponential growth of the population,
p(t) = p(t0)ek(t−t0),

8.3 Malthus’ population model
63
so that its size grows without bound and will double every d years, where d =
ln 2/k. This led Malthus to see war and famine as a possibly desirable check on
this otherwise disastrous population explosion.
We will now compare the predictions of this model with census data gathered
over the last two hundred years. The population of Great Britain and Ireland in
1801, 1851 and 1901 can be found in the results of the Census for each of those
years:
year
population
1801
16 345 646
1851
27 533 755
1901
41 609 091
(8.6)
We can use the data from 1801 and 1851 to estimate k. Our solution predicts
p(1851) = p(1801)e50k,
and so
k = ln p(1851) −ln p(1801)
50
≈0.010.
This implies that the population will double roughly every 69 years (ln 2/k ≈69).
Using this value of k, our solution, illustrated in Figure 8.2, gives a reasonable
prediction for the population in 1901:
p(1901) = p(1801)e100k ≈46 million.
1800
1820
1840
1860
1880
1900
1920
1940
1960
1980
2000
2020
0
20
40
60
80
100
120
140
160
180
Year
Population (millions)
Fig. 8.2. The UK population as predicted by Malthus’ linear model. The census
values for 1801, 1851, 1901 and 2001 are indicated by crosses.

64
8 Separable equations
However, it vastly overestimates the population in 2001 as
p(2001) = p(1801)e200k ≈131 million,
whereas the 2001 census found just below 59 million (in fact2 the ﬁgure is the
delightfully precise 58 789 194). To be consistent we should include the ﬁgures
for the Republic of Ireland, since the data in (8.6) dates from before the partition
of Ireland in 1921. The census held there in 2002 found a population of around
4 million.3 So the total ﬁgure for 2001 should be approximately 63 million.
Malthus’ model has predicted over twice this, so it turns out to be very unreli-
able when we try to extrapolate the population very far into the future. We will
soon see another model that gives much more realistic results.
8.4 Justifying the method
We now give a careful justiﬁcation of the ‘recipe’ we outlined in Section 8.1. In
particular, you should have worried about the idea of ‘multiplying up by dt’, since
this kind of manipulation of inﬁnitesimal quantities is extremely dubious.
We start again with
dx
dt = f (x)g(t),
(8.7)
and assume that f (x) is sufﬁciently smooth to ensure that Theorem 6.2 guarantees
the existence of a unique solution for any speciﬁed initial condition.
First note that if x(t) is a solution of (8.7) with f (x(s)) = 0 for some s then in
fact x(t) = x(s) for all t ∈R. This follows from the uniqueness of solutions; as-
suming that x(t) = x(s) for all t implies that f (x(t)) = f (x(s)) = 0 for all t ∈R,
and so ˙x(t) = 0 for all t, showing that this choice for x(t) solves the equation.
Since solutions of the IVP are unique, this x(t) must be the only solution with the
speciﬁed value of x(s).
So either f (x(t)) = 0 for every value of t, or f (x(t)) ̸= 0 for every value of t.
We now treat the case f (x(t)) ̸= 0 for all t, for which we can divide both sides of
(8.7) by f (x) to give
1
f (x)
dx
dt = g(t).
(8.8)
Now, suppose that H(x) is an anti-derivative of 1/f (x), i.e.
H′(x) =
1
f (x).
2 See www.statistics.gov.uk/census2001/default.asp
3 The exact ﬁgure was 3 917 336, see www.cso.ie/census/prelimimary details.html#pop.

8.4 Justifying the method
65
Then observe that by the chain rule (see Appendix C)
d
dt H(x(t)) = H′(x(t))dx
dt =
1
f (x)
dx
dt ,
and so (8.8) can be rewritten as
d
dt H(x(t)) = g(t).
To ﬁnd the solution we can integrate both sides with respect to t to give
H(x(t)) =

g(t) dt.
(8.9)
(To ﬁnd x(t) explicitly we have to be able to invert H, i.e. solve the equation
H(x) = z to obtain x in terms of z. In some cases the implicit form of (8.9) might
be the best that we can do.) Since H is an anti-derivative of 1/f , we could write
this symbolically as

1
f (x) dx =

g(t) dt,
(8.10)
which is precisely what we had before as equation (8.2).
We now see how to recover (8.3) (see equation (8.11) below). If G is an anti-
derivative of g then (8.10) reads
H(x(t)) = G(t) + c,
and so when we want to take into account an initial condition x(t0) = x0 we need
H(x0) = G(t0) + c
⇒
c = H(x0) −G(t0),
and the solution is
H(x(t)) −H(x0) = G(t) −G(t0).
Using the method of evaluating an integral by anti-derivatives (which is formalised
as (5.3) in the FTC) we can rewrite this as
 x(t)
x0
1
f (x) dx =
 t
t0
g(˜t) d˜t,
(8.11)
which agrees with the result of our more heuristic derivation above (equa-
tion (8.3)).

66
8 Separable equations
8.5 A more realistic population model
We now return to population modelling, but rather than allowing the unbounded
exponential growth that resulted from Malthus’ model
d p
dt = kp
we impose a maximum sustainable size for the population. The idea is that any
species (including ours) is limited by the availability of natural resources. We will
ﬁnd that this new model gives a much better estimate of the current population,
even extrapolated from the century-old data we used above.
The so-called ‘logistic equation’ is
d p
dt = kp

1 −p
M

.
(8.12)
Interpreted as a population model, k is the growth rate of small populations; when
p is small, p2 is very small, so the equation is approximately dp/dt = kp, the
model we had previously. The parameter M > 0 is the maximum sustainable pop-
ulation; when p < M the population increases, and when p > M the population
decreases. We drew the phase diagram for this equation in the previous chapter as
Figure 7.7, and it will be useful to recall it now (see Figure 8.3) for use below. The
phase diagram predicts that eventually the population will settle to its maximum
sustainable level, p = M.
We now solve the equation explicitly. Separating the variables gives
M
kp(M −p) dp = dt,
where we have multiplied top and bottom of the left-hand side by M. Using the
method of partial fractions on the left-hand side this becomes
1
k
 1
p +
1
M −p

dp = dt
or
 1
p +
1
M −p

dp = k dt.
(8.13)
0
M
Fig. 8.3. The phase diagram for the population model (8.12). In line with the
interpretation of p as the size of a population, only the values p ≥0 are shown.

8.5 A more realistic population model
67
Since

1
p +
1
M −p dp = ln |p| −ln |M −p|
We can integrate both sides of (8.13) between the limits corresponding to times t0
and t,
 p(t)
p(t0)
1
p +
1
M −p dp =
 t
t0
k d˜t,
to give

ln |p| −ln |M −p|
p(t)
p=p(t0)
=

k˜t
t
˜t=t0
.
Putting in the limits of integration,
ln p(t) −ln |M −p(t)| −ln p(t0) + ln |M −p(t0)| = k(t −t0)
(since p(t) > 0 we do not need the modulus sign on ln |p(t)|). Equivalently this is
ln
 p(t)|M −p(t0)|
|M −p(t)|p(t0)

= k(t −t0).
From the phase diagram in Figure 8.3 it is clear that if p(t0) < M then p(t) <
M for all t, and similarly if p(t0) > M then p(t) > M for all t. So the sign of
M −p(t) does not change for each solution. It follows that we can remove the
modulus signs, and then exponentiating both sides we obtain
p(t)(M −p(t0))
(M −p(t))p(t0) = ek(t−t0).
Finally, rearranging this gives
p(t) = M

p(t0)ek(t−t0)
M −p(t0) + p(t0)ek(t−t0)
	
.
With some thought we can read from this explicit solution the same qualitative
behaviour we see in the phase diagram. In particular, since ekt →∞as t →∞,
we can deduce once again that p(t) →M as t →∞.
Since we have an explicit solution we can now estimate the parameters M and
k that occur in the equation using the census data quoted above in (8.6). Once
we know M and k we can then see what the quantitative predictions of the model
are for 2001. The calculations to ﬁnd M and k are just simple algebra, but are
not particularly instructive, so feel free to go straight to the values of M and k in
equation (8.14).

68
8 Separable equations
Setting α = e50k, p0 = p(1801), p1 = p(1851), and p2 = p(1901), our solu-
tion requires
p1 =
Mp0α
M −p0 + p0α
p2 =
Mp0α2
M −p0 + p0α2 .
(Since there are now two parameters in our equation we need all the data from
(8.6) to estimate them.) Rearranging both equations to ﬁnd M in terms of α and
equating we have
p0 p1(α −1)
p0α −p1
= p0 p2(α2 −1)
p0α2 −p2
,
and so
α = p2(p1 −p0)
p0(p2 −p1)
and
M = p1(2p0 p2 −p1 p2 −p0 p1)
p0 p2 −p2
1
.
Using the correct values for p0, p1 and p2 gives
α = e50k = 2.0234
and
M = 83.1 million
(8.14)
which implies that k ≈0.014, similar to the value (k ≈0.010) we found for the
simple exponential model (8.5).
We can now use these values of k and M to predict the population in 2001.
The value we obtain is 66.8 million, surprisingly close to the true ﬁgure (which,
remember, is about 63 million); the solution is illustrated in Figure 8.4. Of course,
there are good reasons for the discrepancy – among them two world wars and the
invention of the contraceptive pill in the 1960s.
Note that the constant M that arises in the model represents the maximum sus-
tainable population; at 83 million this is still comfortably above its current level.
8.6 Further examples
We now treat some other examples. Note that often both the method of partial
fractions and a quick sketch of the phase diagram are useful tools.
8.6.1 Partial fractions again
We drew the phase diagram for the equation ˙x = x(k −x2) as part of our study of
the pitchfork bifurcation in Section 7.6. Here we will consider the case k > 0, and
so replace k by κ2, which will make the algebra that is to come a little simpler. We

8.6 Further examples
69
1800
1850
1900
1950
2000
2050
2100
10
20
30
40
50
60
70
80
90
Year
Population (millions)
Fig. 8.4. Graph of the population of the UK and the Republic of Ireland, as pre-
dicted by the logistic model using the census data for 1801, 1851 and 1901. The
curve is our theoretical prediction, and the crosses show the exact values (we have
chosen our parameters to ensure that the ﬁrst three crosses lie on this curve). The
dashed line is the maximum sustainable population predicted by our model.
will solve the equation
dx
dt = x(κ2 −x2)
with a general initial condition x(0) = x0. For the case k < 0 see Exercise 8.8.
Separating the variables we have
1
x(κ2 −x2) dx = dt.
We can use the method of partial fractions to rewrite the left-hand side as
1
x(κ2 −x2) =
1
x(κ −x)(κ + x) = 1
κ2
1
x +
1
2(κ −x) −
1
2(κ + x)

.
So we have
1
x +
1
2(κ −x) −
1
2(κ + x) dx = κ2 dt.
We can integrate this between the limits corresponding to times 0 and t to give
 x(t)
x0
1
x +
1
2(κ −x) −
1
2(κ + x) dx =
 t
0
κ2 d˜t

70
8 Separable equations
0
−κ
κ
Fig. 8.5. The phase diagram for ˙x = x(κ2 −x2).
which is

ln |x| −1
2 ln |κ −x| −1
2 ln |κ + x|
x(t)
x=x0
=

κ2˜t
t
˜t=0
or

ln
|x|

|κ2 −x2|
x(t)
x=x0
= κ2t.
Putting in the limits this becomes
ln
⎡
⎣|x(t)|

|κ2 −x2
0|
|x0|

|κ2 −x(t)2|
⎤
⎦= κ2t,
and exponentiating both sides we have
|x(t)|

|κ2 −x2
0|
|x0|

|κ2 −x(t)2|
= eκ2t.
Now if we square both sides and multiply up we have
x(t)2|κ2 −x2
0| = x2
0|κ2 −x(t)2|e2κ2t.
(8.15)
We drew the phase diagram for this example in the previous chapter (see
Figure 7.13), and it is reproduced here as Figure 8.5. It is easy to see from the phase
diagram that if x2
0 < κ2 then x(t)2 < κ2 for all t and similarly if x2
0 > κ2 then
x(t)2 > κ2 for all t. So we can remove the modulus signs and rearrange (8.15) to
give
x(t)2 =
x2
0κ2e2κ2t
κ2 + x2
0(e2κ2t −1)
or
x(t) = ±

κ2
1 + e−2κ2t(κ2x−2
0
−1)
.
(8.16)

8.6 Further examples
71
0
−κ
κ
0
0
t
x
κ
−κ
Fig. 8.6. Solutions of ˙x = x(κ2 −x2) on the left, and the corresponding phase
diagram (rotated through 90 degrees) on the right.
Whether we take the plus sign or the minus sign depends on the sign of the
initial condition; for t = 0 we obtain
x(0) = ±

x2
0 = ±|x0|
and we have to choose the sign so that x(0) = x0.
From the phase diagram we can see that for any x0 > 0 the solution tends to κ
as t →∞, and for any x0 < 0 the solution tends to −κ; we can also recover this
behaviour from our explicit solution, since if 0 < x0 < κ then e−2κ2t(κ2x−2
0
−1)
is always positive, and decreases from its initial value to zero as t →∞; it follows
that x(t) increases from x0 to κ. Similarly if x0 > κ then e−2κ2t(κ2x−2
0
−1) is
always negative, and increases up to zero as t →∞, so that x(t) decreases to κ as
t →∞.
You can also see from the explicit solution that if |x0| > κ then the solution
will blow up as t ↓t∗< 0, since then the expression (κ2x−2
0
−1) is negative (see
Exercise 8.9 for more details).
Figure 8.6 shows the solutions of the equation, along with the corresponding
phase diagram, rotated to illustrate how the behaviour of the solutions matches the
predictions of the phase diagram.
8.6.2 Two competing species
Later we will look at some simple models of competing species, and will come
across such equations as
dy
dx = y(5x −2)
x(1 −3y).

72
8 Separable equations
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
0
0.5
1
1.5
2
2.5
x
y
Fig. 8.7. Curves on which ln y + 2 ln x −3y −5x is constant.
This can be separated to give
1 −3y
y
dy = 5x −2
x
dx.
Integrating both sides we have
 
1
y −3

dy =
 
5 −2
x

dx;
taking x and y positive, because they represent the size of a population, we have
no need of modulus signs in the logarithms arising from the integration,
ln y −3y = 5x −2 ln x + c.
We can do no better than this implicit solution relating x and y. However, we can
represent the curves deﬁned by
F(x, y) = ln y + 2 ln x −3y −5x = constant
graphically, and these are shown in Figure 8.7.
Exercises
8.1 Solve the following equations:
(i) ˙x = t3(1 −x) with x(0) = 3;
(ii) y′ = (1 + y2) tan x with y(0) = 1;
(iii) ˙x = t2x (general solution);
(iv) ˙x = −x2 (general solution);

Exercises
73
(v) for dy/dt = e−t2 y2 give the solution in terms of an integral and describe the
behaviour of the solution as t →+∞depending on the initial condition y(0).
You may assume that
 ∞
0
e−s2 ds = √/2.
8.2 Solve the linear equation
˙x + px = q
by separation of variables.
8.3 Find the general solution of the equation
xy′ = ky
that is valid for x > 0.
8.4 Find the function I (t) that satisﬁes
dI
dt = p(t)I.
(Your answer will involve an integral.)
8.5 Use the method of separation of variables to show that the general solution of the
linear equation
˙x = λx
is x(t) = Aeλt for any A ∈R.
8.6 In Exercise 5.7 we showed, neglecting air resistance, that an apple falling from a
height h reaches the ground when t = √2h/g. If we include air resistance then pro-
vided that v ≤0 the equation becomes
m dv
dt = −mg + kv2
v(0) = 0
with k > 0. Show that
v(t) = −
"mg
k tanh
"
gk
m t

,
and hence that the apple now takes a time
t∗=
" m
kg ln

ekh/m −

e2kh/m −1

to reach the ground. Check that this coincides with the answer with no air resistance
(t∗= √2h/g) as k →0. Hint: for small x, ex ≈1 + x and ln(1 + x) ≈x.
8.7 Show that for k ̸= 0 the solution of the differential equation
dx
dt = kx −x2
with
x(0) = x0
is
x(t) =
k ektx0
x0(ekt −1) + k .

74
8 Separable equations
Using this explicit solution describe the behaviour of x(t) as t →∞for k < 0 and
k > 0. (Note that this is much easier to do using the phase diagram than using the
explicit form of the solution.) For k = 0 see part (iv) of Exercise 8.1.
8.8 Show that the solution of the equation
dx
dt = −x(κ2 + x2)
with initial condition x(0) = x0 is
x(t) = ±

κ2

1 + κ2x−2
0

e2κ2t −1
,
where the ± is chosen according to the sign of the initial condition. Deduce that
x(t) →0 as t →∞. As t decreases from zero the solution blows up as t approaches
a ﬁnite value t∗< 0. When is this ‘blow up time’?
8.9 We found the solution of the equation ˙x = x(κ2 −x2) in Section 8.6.1,
x(t) = ±

κ2
1 + e−2κ2t
κ2x−2
0
−1
.
Show that if |x0| > |κ| the solution blows up as t decreases towards a ﬁnite negative
value, and ﬁnd this critical time.
8.10 Consider the equation
˙x = xα with x(0) ≥0
for α > 0. Show that the only value of α for which the equation has solutions that
are both unique and exist for all time is α = 1. You should be able to ﬁnd an initial
condition for which the solutions are not unique when α < 1 (cf. (6.3)), and show
that solutions with x(0) > 0 blow up in a ﬁnite time if α > 1 (cf. (6.6)).
8.11 (T) Assuming that f (x) and f ′(x) are continuous, show that if the solution of
˙x = f (x) with x(0) = x0
blows up to x = +∞in ﬁnite time then
 ∞
x0
f (x) dx < ∞.

9
First order linear equations and the integrating factor
One type of ﬁrst order equation that we can always solve, at least in theory, is a
linear equation. The most general ﬁrst-order linear equation (cf. (3.5)) is
a1(t)dx
dt + a0(t)x = f (t).
However, we will concentrate on equations that are ‘always ﬁrst order’, so we
assume that a1(t) ̸= 0 and divide through by a1(t) to obtain
dx
dt + p(t)x = q(t).
(9.1)
9.1 Constant coefﬁcients
First we will consider the simplest case, when both p and q are constants,
dx
dt + px = q.
(9.2)
There are a number of ways to solve this equation. We have already met one,
the method of separation of variables; we could write the equation as
dx
q −px = dt,
integrate both sides, and solve it this way (see Exercise 8.2).
However, we are going to solve it by another method. Although this way in-
volves a trick, and may seem complicated in this simple case, it is also useful for
the more general equation (9.1) where the coefﬁcients do not have to be constants.
The key point is to notice that
d
dt

x(t)ept
= dx
dt ept + px ept = ept

dx
dt + px

(9.3)
75

76
9 First order linear equations and the integrating factor
(using the product rule). The right-hand side of (9.3) is the same as the left-hand
side of our differential equation (9.2), except that it is multiplied by a factor ept. If
we multiply both sides of (9.2) by ept we have
ept

dx
dt + px

= qept,
and using (9.3) this is simply
d
dt (xept) = qept.
(9.4)
For the general solution we integrate both sides to give
x(t)ept = q
pept + C,
so that
x(t) = q
p + Ce−pt.
(9.5)
(It follows that if p > 0 then x(t) →q/p as t →∞, independent of any initial
condition.)
If we want the solution that has x(a) = xa then we need
xa = q
p + Ce−pa
⇒
C =

xa −q
p

epa,
and so this solution is
x(t) = q
p +

xa −q
p

e−p(t−a).
(9.6)
9.2 Integrating factors
We now use the same sort of trick on the more general linear equation
dx
dt + p(t)x = q(t).
(9.7)
What we are doing is looking for an ‘integrating factor’ by which we can multiply
both sides and so turn the left-hand side into something we can integrate easily.
We will give a quick derivation of the form of the integrating factor that we need.
However, in practice you should just write down the integrating factor; as we will
now see it is
exp


p(t) dt

,
i.e. e

p(t) dt.

9.2 Integrating factors
77
If we multiply both sides of (9.7) by a factor I (t) then we get
I (t)dx
dt + I (t)p(t)x = I (t)q(t).
Concentrate on the left-hand side,
I (t)dx
dt + I (t)p(t)x;
we want this to be the derivative of something. The ﬁrst term is part of the deriva-
tive of I (t)x(t), so we will see whether we can ﬁnd a function I (t) such that
d
dt [I (t)x(t)] = I (t)dx
dt + I (t)p(t)x(t),
i.e. such that (differentiating the left-hand side using the product rule)
dI
dt x(t) + I (t)dx
dt = I (t)dx
dt + I (t)p(t)x(t).
For this we would need
x(t)dI
dt = I (t)p(t)x(t),
which is certainly true if
dI
dt = p(t)I.
This is a separable equation (see Exercise 8.4); we can divide by I and multiply
up by dt to give,
1
I dI = p(t) dt,
and then by integration we get
ln |I (t)| =

p(t) dt.
Finally we exponentiate both sides and choose I (t) to be positive to give
I (t) = exp


p(t) dt

.
Given this integrating factor we should now be able to solve our general linear
equation
dx
dt + p(t)x = q(t).
(9.8)
If P is an anti-derivative of p (so that ˙P(t) = p(t)) then the integrating factor we
need is eP(t). Multiplying both sides of (9.8) by this integrating factor the equation

78
9 First order linear equations and the integrating factor
becomes
dx
dt eP(t) + p(t)x(t)eP(t) = q(t)eP(t).
The point of the integrating factor is that the left-hand side is now the derivative of
x(t)eP(t), so we have
d
dt [x(t)eP(t)] = q(t)eP(t).
In order to solve the problem completely we have to be able to integrate the right-
hand side, and then the solution is
x(t)eP(t) =

q(t)eP(t) dt
We now apply this method to some examples.
9.3 Examples
Example 9.1 Solve the equation
dx
dt + 3x = t
with
x(0) = 8/9.
The integrating factor is
I (t) = exp


3 dt

= e3t.
Multiplying both sides of the equation by e3t we get
e3t dx
dt + 3xe3t = te3t.
The whole point of the method is that we can now rewrite the left-hand side as a
derivative:
d
dt (xe3t) = te3t.
Integrating this equation with respect to t between 0 and t – using integration by
parts on the right-hand side – we obtain
x(t)e3t −x(0) =
 t
0
˜te3˜t d˜t
=
 ˜te3˜t
3
−e3˜t
9
t
˜t=0
= te3t
3
−e3t
9 + 1
9,

9.4 Newton’s law of cooling
79
and so, since x(0) = 8/9,
x(t) = e−3t + t
3 −1
9.
Example 9.2 Find the general solution of
(x2 + 1)dy
dx + 4xy = 12x.
This is a linear equation; if we divide both sides by x2 + 1 then
dy
dx +
4x
x2 + 1 y =
12x
x2 + 1
which is in the form (9.1). The integrating factor is
I (x) = exp


4x
x2 + 1 dx

= exp(2 ln(x2 + 1)) = (x2 + 1)2.
So, multiplying both sides by (x2 + 1)2 we get
(x2 + 1)2 dy
dx + 4x(x2 + 1)y = 12x(x2 + 1),
which is
d
dx [y(x2 + 1)2] = 12x(x2 + 1).
To ﬁnd the general solution we integrate both sides to get
y(x)(x2 + 1)2 = 3(x2 + 1)2 + c
and so
y(x) = 3 +
c
(x2 + 1)2 .
9.4 Newton’s law of cooling
An interesting example of a linear equation arises from Newton’s law of cool-
ing, which provides a mathematical model of the temperature T (t) of an object in
surroundings of temperature A(t):
dT
dt = −k(T −A(t)),
(9.9)
where k > 0 measures the rate that heat is absorbed (or emitted) by the object.

80
9 First order linear equations and the integrating factor
9.4.1 Estimating the time of death
One forensic method for ascertaining the time of death of a body is based on
Newton’s law of cooling. The idea is to take the temperature of the body at
two different times, in order to give an estimate of the constant k to be used in
equation (9.9), and then to extrapolate back to ﬁnd the time when T is the temper-
ature of a living body, 37 ◦C.
To keep things simple we will suppose that a body is found in a room which is
kept at a constant temperature of 24 ◦C. At 8 a.m. in the morning its temperature
is 28 ◦C, while an hour later it is 26 ◦C.
With the time t measured in hours we need to ﬁnd the solution of
dT
dt + kT = k A
(in fact we have done this already in Section 9.1). Multiplying both sides by the
integrating factor ekt we obtain
d
dt [T (t)ekt] = k Aekt,
and then integrating both sides with respect to t between times t1 and t2 gives
T (t2)ekt2 −T (t1)ekt1 = A(ekt2 −ekt1);
rearranging this gives the temperature at time t2 in terms of the temperature at
time t1,
T (t2) = A + [T (t1) −A]e−k(t2−t1).
This implies that
T (9) = A + [T (8) −A]e−k.
To ﬁnd k we set T (8) = 28, T (9) = 26 and A = 24, so we then have
26 = 24 + [28 −24]e−k,
which implies that
e−k = 0.5
giving k = ln 2.
If the time of death was t0 then our solution gives
T (8) = A + [T (t0) −A]e−k(8−t0).

9.4 Newton’s law of cooling
81
Since T (t0) = 37, T (8) = 28 and A = 24, we want to ﬁnd the value of t0 such that
28 = 24 + [37 −24]e−k(8−t0),
i.e.
4 = 13e−k(8−t0).
Taking logarithms gives
ln 4 = ln 13 −k(8 −t0),
and using k = ln 2 we have
(8 −t0) = ln 4 −ln 13
−ln 2
.
Solving this for t0 we obtain t0 ≈1.7, putting the time of death at approximately
1:42 a.m.
9.4.2 The temperature in an unheated building
We now look at a case where the ambient temperature is not taken to be constant.
To make things more deﬁnite, and a little less gruesome, we suppose that T (t)
represents the temperature inside an unheated church.
Once again we want to use the integrating factor method, so we rewrite equa-
tion (9.9) as
dT
dt + kT = k A(t);
as before, the integrating factor is ekt. Multiplying both sides by ekt gives
d
dt [T ekt] = k A(t)ekt,
and then integrating between 0 and t we get
T (t)ekt −T (0) = k
 t
0
A(˜t)ek˜t d˜t.
(9.10)
Rearranging this gives
T (t) = T (0)e−kt + ke−kt
 t
0
A(˜t)ek˜t d˜t.
Now we model the outside temperature as a regular oscillation about an average
temperature µ, setting
A(t) = µ + a cos ωt.

82
9 First order linear equations and the integrating factor
Amplitude
 a
Mean value
µ
2π/ω
Period
µ−a
µ
µ+a
0
π/ω
2π/ω
3π/ω
4π/ω
5π/ω
6π/ω
Fig. 9.1. The graph of A(t) = µ + a cos ωt against t, showing the period and
amplitude.
We say that A(t) oscillates about a mean value µ; the size of the oscillations, a,
is called the amplitude, and the frequency of the oscillations is how many occur
for every unit of time, in this case ω/2. The reciprocal of the frequency, 2/ω,
is known as the period: this is the time between any two successive maxima of
A(t), i.e. the time for one ‘complete oscillation’. These concepts are illustrated in
Figure 9.1.
Over a British year we can take the mean temperature as 9 ◦C, with the ampli-
tude of oscillations 10 ◦C. With t measured in years we then want ω = 2 so that
the oscillations have a period of one year.
With this particular form for A(t) equation (9.10) becomes
T (t)ekt −T (0) = µk
 t
0
ek˜t d˜t + ak
 t
0
ek˜t cos ω˜t d˜t.
An anti-derivative of ekt cos ωt is1
k
k2 + ω2 ekt cos ωt +
ω
k2 + ω2 ekt sin ωt,
(9.11)
and so we have
ektT (t) −T (0) = µ

ek˜t
t
˜t=0
+ ak

k
k2 + ω2 ek˜t cos ω˜t +
ω
k2 + ω2 ek˜t sin ω˜t
t
˜t=0
= µ(ekt −1) + ak

k
k2 + ω2 ekt cos ωt +
ω
ekt sin ωt −k2 + ω2

.
1 You might expect the anti-derivative to be of the form Aekt cos ωt + Bekt sin ωt, since differentiating the ﬁrst
of these two terms gives one term involving ekt cos ωt (which we want) but also an ekt sin ωt term. Differentiat-
ing this guess gives an equation for A and B which is straightforward to solve. There is also a more systematic
way of obtaining this result using the complex form for cos ωt and sin ωt, see Exercise 9.8.
k
k2 + ω2

9.4 Newton’s law of cooling
83
This is looking complicated, but we can rearrange it, in particular multiplying
through by e−kt, to give
T (t) = µ +

T (0) −µ −
a
k2 + ω2

e−kt + ak

k
k2 + ω2 cos ωt +
ω
k2 + ω2 sin ωt

.
This still looks complicated,2 but if we consider each term individually then we
should be able to understand what this solution is actually saying about the temper-
ature. The ﬁrst term is the average outside temperature, which we would expect to
form the main contribution to the temperature inside the church; the second term
decays exponentially, so will have very little effect after some time has passed; and
the last two terms both oscillate with the same frequency as the ambient tempera-
ture. Before we write the equation in its ﬁnal form we will see in the next section
how to combine these two oscillating terms in order to make it clear that they result
in just one oscillation.
9.4.3 Combining two oscillating terms
We are now going to show that it is possible to combine two oscillating terms and
rewrite them as one:
A cos ωt + B sin ωt = M cos(ωt −φ).
(9.12)
(In our case the constants A and B are given by A = k/(k2 + ω2) and B =
ω/(k2 + ω2), but the argument is much easier to follow with the more general A
and B.)
The idea is to use the double angle formula3
cos α cos β + sin α sin β = cos(β −α)
(9.13)
in an appropriate way. Note that the left-hand side of (9.12) looks slightly like the
left-hand side of (9.13) if we choose β = ωt; it would look just like the left-hand
side of (9.13) if we could ﬁnd a φ such that
cos φ = A
and
sin φ = B.
(9.14)
In general we are unable to do this, because we know that, whatever the value of
θ, cos2 θ + sin2 θ = 1, and there is no reason why A2 + B2 should be equal to
2 If you solve an equation and end up with a long expression like this then there are various ways that you
can check your answer. You always have the option of differentiating and substituting back into the original
equation to check that it works; sometimes this itself might be daunting. One thing that you can do quite quickly
here is to check that at t = 0 the right-hand side reduces to T (0), as it should.
3 The right-hand side could also be written as cos(α −β), since cos θ = cos(−θ).
k2

84
9 First order linear equations and the integrating factor
one. The way to circumvent this is to take out an appropriate factor from (9.12)
and write
A cos ωt + B sin ωt =

A2 + B2

A
√
A2 + B2 cos ωt +
B
√
A2 + B2 sin ωt

.
The coefﬁcients of cos ωt and sin ωt within the square brackets now satisfy

A
√
A2 + B2
2
+

B
√
A2 + B2
2
= 1,
and so we can ﬁnd a φ with
cos φ =
A
√
A2 + B2
and
sin φ =
B
√
A2 + B2 ,
(9.15)
which is just given by
φ = tan−1(B/A).
(One way to think about this is in terms of the right-angled triangle pictured in
Figure 9.2.)
With this choice of φ we now have
A cos ωt + B sin ωt =

A2 + B2

A
√
A2 + B2 cos ωt +
B
√
A2 + B2 sin ωt

=

A2 + B2 (cos φ cos ωt + sin φ sin ωt)
=

A2 + B2 cos(ωt −φ).
The sum of the two oscillations has amplitude M =
√
A2 + B2 and oscillates at
frequency ω/2, with a time lag of φ/ω.
φ
A
B
√(A2 + B 2)
Fig. 9.2. A, B, φ, and a right-angled triangle.

9.4 Newton’s law of cooling
85
9.4.4 Back to our example
In our particular example, we want to combine
k
k2 + ω2 cos ωt +
ω
k2 + ω2 sin ωt;
(9.16)
so if we take out the factor

k2
(k2 + ω2)2 +
ω2
(k2 + ω2)2 =

k2 + ω2
(k2 + ω2)2 =
"
1
k2 + ω2 ,
and choose φ with
φ = tan−1(ω/k),
then the two terms in (9.16) become
"
1
k2 + ω2 cos(ωt −φ),
and the full solution is
T (t) = µ +

T (0) −µ −
ak
k2 + ω2

e−kt + ak
"
1
k2 + ω2 cos(ωt −φ).
(9.17)
For a particular choice of parameters this solution is shown in Figure 9.3, along
with the ambient temperature.
0
0.5
1
1.5
2
2.5
3
3.5
4
−5
0
5
10
15
20
t (days)
temperature T (°C)
Fig. 9.3. The solid line is the solution (9.17) when A(t) = 9 + 10 cos 2t, k = 3
and T (0) = 12. The ambient temperature A(t) is shown as a dashed line.

86
9 First order linear equations and the integrating factor
Now we can see clearly what the solution describes. The underlying temperature
is the average ambient temperature µ; this is adjusted by a term that decays to zero
as t →∞, and an oscillating term. When t is large the decaying term will be small,
and the solution will be approximately
Tapprox(t) = µ + a

k2
k2 + ω2 cos(ωt −α);
eventually the temperature oscillates at the same frequency as the ambient temper-
ature, but its amplitude is a multiplied by the factor

k2
k2 + ω2 .
(9.18)
Since cos(ωt −α) = cos ω[t −(α/ω)] there is a time lag between the oscillations
of the ambient temperature and the oscillations of T (t) which is
α
ω = 1
ω tan−1 ω
k .
(9.19)
Note that if the constant k is large, so that heat is easily conducted from the
surroundings to the building, the factor in (9.18) will be close to 1, while the time
lag will be close to zero; in such a case T (t) follows A(t) very closely.
Exercises
9.1 Use an integrating factor to solve the following differential equations:
(i)
dy
dx + y
x = x2
(ﬁnd the general solution and the only solution that is ﬁnite when x = 0),
(ii)
dx
dt + tx = 4t
(ﬁnd the solution with x(0) = 2),
(iii)
dz
dy = z tan y + sin y
(ﬁnd the general solution),
(iv)
y′ + e−x y = 1
(ﬁnd the solution when y(0) = e, leaving your answer as an integral),

Exercises
87
(v)
˙x + x tanh t = 3
(ﬁnd the general solution, and compare it to that for ˙x + x = 3),
(vi)
y′ + 2y cot x = 5
(ﬁnd the solution with y(/2) = 1),
(vii)
dx
dt + 5x = t
(ﬁnd the general solution),
(viii) with a > 0 ﬁnd the solution of the equation
dx
dt +

a + 1
t

x = b
for a general initial condition x(1) = x0, and show that x(t) →b/a as t →∞
(you would get the same result if you replaced a + t−1 by a).
9.2 A body is found in a cold room (temperature 5 ◦C) at 3 p.m. and its temperature then
is 19 ◦C. An hour later its temperature has dropped to 15 ◦C. Use Newton’s law of
cooling to estimate the time of death, assuming that body temperature is 37 ◦C.
9.3 At 7 a.m. in the morning I make my wife a cup of tea using boiling water; after adding
some milk it is about 90 ◦C. When we leave for the station at 7:30 a.m. the tea is still
drinkable at about 45 ◦C. When I get back home at 8 a.m. the neglected tea has cooled
to about 30 ◦C. What is the temperature of our house?
9.4 Use the integrating factor method to ﬁnd T (t2) in terms of T (t1) when
dT
dt = −k(T (t) −A(t))
and
A(t) = µ + a cos ω(t −φ).
9.5 A dead body is found outside on a winter’s morning at 7 a.m.; its temperature is mea-
sured as 20 ◦C. Measured an hour later it has dropped to 15 ◦C. The air temperature
A(t) ﬂuctuates on a daily cycle about a mean of 3 ◦C with A(t) = 3 −5 cos ω(t −2),
where t is measured in hours with t = 0 corresponding to midnight, and ω = /12.
(i) Use the solution from Exercise 9.4 and the temperature observations at
7 a.m. and 8 a.m. to show that
k = −ln
#
12(k2 + ω2) −5k(k cos 6ω + ω sin 6ω)
17(k2 + ω2) −5k(k cos 5ω + ω sin 5ω)
$
.
(E9.1)
(ii) (C) This is a MATLAB exercise. Choose an initial guess for k, and then substitute
this into the right-hand side of (E9.1) to obtain a new guess. Continue doing this

88
9 First order linear equations and the integrating factor
until your ‘guess’ stabilises. Once this happens you have actually obtained the
required solution of (E9.1). Can you see why? (You should ﬁnd that k ≈0.3640.)
(iii) If the time of death was t0, use the fact that body temperature is 37 ◦C (so T (t0) =
37) and T (7) = 20 to show that
t0 = 7 + 1
k ln

17(k2 + ω2) −5k(k cos 5ω + ω sin 5ω)
34(k2 + ω2) −5k(k cos ω(t0 −2) + ω sin ω(t0 −2))
	
.
(iv) (C) Use MATLAB again to reﬁne an initial guess for the time of death as in part
(ii). You should ﬁnd that t0 ≈4.8803, or 4:53 a.m.
9.6 Show that if y1 and y2 are any two solutions of
dy
dx + p(x)y = 0
then y1(x)/y2(x) is constant. (You do not need to solve the equation!)
9.7 (T) Suppose that
dx
dt ≤ax
(this is known as a differential inequality). Use an appropriate integrating factor to
show that
d
dt [e−atx] ≤0,
and then integrate both sides between appropriate limits to deduce that
x(t) ≤x(s)ea(t−s)
for any t and s. Hint: it is a fundamental property of integration that if f (x) ≤g(x)
then
 b
a
f (x) dx ≤
 b
a
g(x) dx.
9.8 (T) The function sin ωt can be written as a combination of complex exponentials,
sin ωt = eiωt −e−iωt
2i
.
Using this form for sin ωt, and assuming that the usual rules of integration apply to
such complex exponentials, ﬁnd

ekt sin ωt dt.
You may also need to use the identity
cos ωt = eiωt + e−iωt
2
.
See Appendix A for more on these complex exponentials.

10
Two ‘tricks’ for nonlinear equations
This chapter deals with two tricks that can be used to solve certain nonlinear equa-
tions. Since these techniques can only be used for equations of particular kinds, it
is important to be able to spot them.
10.1 Exact equations
Suppose that x and y are related implicitly by
F(x, y) = c,
(10.1)
so that x and y form a ‘curve of constant F’. Then if we take the derivative of
(10.1) with respect to x we get, using the chain rule (see Appendix C),
∂F
∂x (x, y) + ∂F
∂y (x, y)dy
dx = 0.
(10.2)
This is a differential equation for y(x), whose solution is the implicit equa-
tion (10.1) that we started with.
The nice thing is that there is an easy way to check whether or not a differential
equation
f (x, y) + g(x, y)dy
dx = 0
(10.3)
is one of these ‘exact equations’ (so called since the equation is exactly the deriva-
tive of the function F(x, y) with respect to x). Notice that if we compare (10.3)
with (10.2) then we would need
f (x, y) = ∂F
∂x
and
g(x, y) = ∂F
∂y .
(10.4)
89

90
10 Two ‘tricks’ for nonlinear equations
Since the order of taking two partial derivatives does not matter (see Appendix C
again), if we have (10.4) then we will have
∂f
∂y = ∂2F
∂x ∂y = ∂2F
∂y ∂x = ∂g
∂x ,
i.e.
∂f
∂y = ∂g
∂x .
(10.5)
This equation (10.5) is in fact a necessary and sufﬁcient condition for the orig-
inal equation to be ‘exact’, i.e. for there to be a function F(x, y) such that (10.4)
holds. We prove this by showing how to ﬁnd such a function F under condition
(10.5). First we want to make sure that the ﬁrst equation in (10.4) holds, i.e.
∂F
∂x = f (x, y).
We want to reverse the partial differentiation with respect to x. Remember that
when we perform a partial differentiation with respect to x we have to keep y
constant; so any function of y alone, C(y), behaves as a constant would if we were
carrying out an ordinary differentiation (i.e. it disappears). It follows that when we
integrate this equation with respect to x, the ‘+c’ term could depend on y:
F(x, y) =

f (x, y) dx + C(y).
(10.6)
In order to ﬁx C(y) we partially differentiate (10.6) with respect to y,
∂F
∂y = ∂
∂y

f (x, y) dx + dC
dy
(we have an ordinary derivative in the last term since C only depends on y) and
now we can use the second equation in (10.4) to get
dC
dy = g(x, y) −∂
∂y

f (x, y) dx.
(10.7)
The condition in (10.5) means that this expression for dC/dy only depends on y,
since
∂
∂x

g(x, y) −∂
∂y

f (x, y) dx

= ∂g
∂x −∂
∂x
∂
∂y

f (x, y) dx
= ∂g
∂x −∂
∂y
∂
∂x

f (x, y) dx
= ∂g
∂x −∂f
∂y = 0.

10.1 Exact equations
91
By integrating the right-hand side of (10.7) we will ﬁnd C(y) up to an arbitrary
additive constant and so obtain the solution.
Example 10.1 Check that the equation
x3 + y
x
  
f (x,y)
+ (y2 + ln x)



g(x,y)
dy
dx = 0
(valid for x > 0) is exact and hence ﬁnd its solution.
First we calculate
∂f
∂y = 1
x
and
∂g
∂x = 1
x ,
and so the equation is exact and F(x, y) = c for some F with
∂F
∂x = x3 + y
x
and
∂F
∂y = y2 + ln x.
Integrating ∂F/∂x = x3 + (y/x) with respect to x we get
F(x, y) = x4
4 + y ln x + C(y).
To ﬁnd C, we differentiate this partially with respect to y,
ln x + dC
dy = y2 + ln x,
and so C′(y) = y2 which implies that C(y) = y3/3; we can omit the constant
of integration since this can be absorbed into the ‘c’ that occurs in the resulting
solution:
F(x, y) = x4
4 + y ln x + y3
3 = c.
You cannot rearrange this to solve for y as a function of x; the best you can do
is to have the solution in this implicit form.
□
10.1.1 Integrating factors
It may be the case that an equation is not exact, but can be turned into an exact
equation if it is multiplied by the correct integrating factor.
We have already done this for the simple case of the linear equation
dy
dx + p(x)y = 0.

92
10 Two ‘tricks’ for nonlinear equations
Clearly this equation as it stands is not exact, since
∂
∂y [p(x)y] = p(x) ̸= 0 = ∂
∂x [1].
However, if we multiply by the integrating factor eP(x), where P is an anti-
derivative of p, then the resulting equation
p(x)eP(x)y + eP(x) dy
dx = 0
is exact, since
∂
∂y [p(x)eP(x)y] = p(x)eP(x) = ∂
∂x eP(x).
Of course, linear equations are a very special case, and in general there is no
simple way to ﬁnd an integrating factor. Suppose that we start with the more gen-
eral equation
f (x, y) + g(x, y)dy
dx = 0,
(10.8)
and try to turn this into an exact equation by multiplying both sides by I (x, y).
Then we obtain
f (x, y)I (x, y) + g(x, y)I (x, y)dy
dx = 0,
and for this equation to be exact we need
∂
∂y [ f (x, y)I (x, y)] = ∂
∂x [g(x, y)I (x, y)],
or

∂f
∂y −∂g
∂x

I = g ∂I
∂x −f ∂I
∂y .
(10.9)
This is a partial differential equation for I, and is certainly no easier to solve than
the original equation (10.8).
However, there are situations in which it is possible to simplify (10.9). For ex-
ample, suppose that we assume that there is an integrating factor I that depends
only on x. Then (10.9) becomes
dI
dx = 1
g

∂f
∂y −∂g
∂x

I.
(10.10)

10.1 Exact equations
93
This equation will have a solution that depends only on x provided that
1
g

∂f
∂y −∂g
∂x

(10.11)
depends only on x.
Example 10.2 Find an integrating factor depending only on x that will make
3 sin y + 5ye5x + 2ye5x
x



f (x)
+ (x cos y + e5x)



g(x)
dy
dx = 0
an exact equation, and hence ﬁnd its solution.
There will be an integrating factor that depends only on x if (10.11) holds. This
gives
1
g

∂f
∂y −∂g
∂x

=
1
x cos y + e5x

3 cos y + 5e5x + 2e5x
x
−(cos y + 5e5x)

=
1
x cos y + e5x

2 cos y + 2e5x
x

= 2
x .
So, from (10.10), we need
dI
dx = 2I
x .
Separating variables gives
1
I
dI
dx = 2
x ,
and so
ln I = 2 ln x,
which implies that I (x) = x2. Multiplying the equation by x2 yields
3x2 sin y + 5x2ye5x + 2xye5x



˜f (x)
+ (x3 cos y + x2e5x)



˜g(x)
dy
dx = 0,
which is now exact, since
∂˜f
∂y = 3x2 cos y + 5x2e5x + 2xe5x = ∂˜g
∂x .

94
10 Two ‘tricks’ for nonlinear equations
To ﬁnd F(x, y), we ﬁrst integrate
∂F
∂x = ˜f (x, y) = 3x2 sin y + 5x2ye5x + 2xye5x
partially with respect to x to give
F(x, y) = x3 sin y + x2ye5x + C(y).
To ﬁx C(y) we differentiate F partially with respect to y,
∂F
∂y = x3 cos y + x2e5x + C′(y).
We therefore have ∂F/∂y = ˜g(x) if C′(y) = 0. So we ﬁnally have our solution,
F(x, y) = x3 sin y + x2ye5x + C = 0.
10.2 Substitution methods
In some cases it is possible to simplify an equation considerably by making an
appropriate substitution. Just as with integration, knowing what this ‘appropriate
substitution’ might be is not always clear, and given a general differential equation
it is probably not the case that it can be solved by a clever substitution. However, in
this section we cover two types of ﬁrst order equation that can be easily identiﬁed
and then solved in this way.
10.2.1 Homogeneous equations
A ﬁrst order differential equation is said to be homogeneous1 if it can be written in
the form
dy
dx = F
 y
x

.
In this case we can make the substitution u = y/x. So then y = ux and using the
product rule gives
dy
dx = u + x du
dx ,
so that
x du
dx = F(u) −u,
which is a separable equation.
1 We also use this word in a different, but related, sense to describe a linear equation of the form andn y/dxn +
· · · + a0y = 0, see Section 3.3.

10.2 Substitution methods
95
Example 10.3 By means of an appropriate substitution solve the equation
xy dy
dx = 2x2 + 3y2.
(10.12)
Dividing both sides of (10.12) by xy gives
dy
dx = 2x
y + 3 y
x ,
and the right-hand side is a function of u = y/x,
F(u) = 2
u + 3u.
We substitute u = y/x; therefore y = xu, and so y′ = u + xu′. Thus
u + xu′ = 2
u + 3u,
which gives
x du
dx = 2
u + 2u.
Separating the variables we get
u
1 + u2 du = 2
x dx,
and so

u
1 + u2 du =
 2
x dx
which gives
1
2 ln(1 + u2) = 2 ln |x| + c,
or

1 + u2 = Ax2,
i.e. u(x) = ±
√
A2x4 −1. Since y(x) = xu(x) the ﬁnal answer is
y(x) = ±x

αx4 −1,
where we have replaced A2 by α > 0. You might like to check that this really is
the solution of (10.12).
□

96
10 Two ‘tricks’ for nonlinear equations
10.2.2 Bernoulli equations
Another type of equation that can be solved by substitution is the so-called
Bernoulli equation,
dy
dx + p(x)y = q(x)yn.
(10.13)
When n = 0 or 1 this is just a linear equation. For n taking other (perhaps negative)
values this falls into none of the classes we have considered so far.
However, the substitution u = y1−n turns (10.13) into a linear equation:
du
dx = (1 −n)y−n dy
dx
= (1 −n)y−n[−p(x)y + q(x)yn]
= (1 −n)[−p(x)y1−n + q(x)
= (1 −n)[−p(x)u + q(x)].
The resulting equation for u is
du
dx + (1 −n)p(x)u = (1 −n)q(x),
a linear equation that we can solve using the integrating factor method of Chap-
ter 9.
Example 10.4 Use an appropriate substitution to ﬁnd the general solution of
dy
dx −6xy = 2xy2.
(10.14)
This is clearly of the form in (10.13) with n = 2, so we set u = y−1. Then we
have
du
dx = −1
y2
dy
dx
= −6x
y −2x
= −6xu −2x,
or
du
dx + 6xu = −2x.
The integrating factor for this equation is
I (x) = exp


6x dx

= exp(3x2).

Exercises
97
Multiplying both sides by e3x2 we have
d
dx

ue3x2
= −2xe3x2.
Integrating both sides with respect to x gives
u(x)e3x2 = −1
3e3x2 + c,
and so
u(x) = −1
3 + ce−3x2.
Since y = 1/u we have
y(x) =
3
Ce−3x2 −1
.
Again, you might like to check that this really is a solution of the original differ-
ential equation.
□
Exercises
10.1 Check that the following equations are exact and hence solve them.
(i)
(2xy −sec2 x) + (x2 + 2y)dy
dx = 0,
(ii)
(1 + ex y + xex y) + (xex + 2)dy
dx = 0,
(iii)
(x cos y + cos x)dy
dx + sin y −y sin x = 0,
and
(iv)
ex sin y + y + (ex cos y + x + ey)dy
dx = 0.
10.2 Find an integrating factor depending only on x that makes the equation
e−y sec x + 2 cot x −e−y dy
dx = 0
exact, and hence ﬁnd its solution. Hint:

cosec x dx = ln |cosec x −cot x|.

98
10 Two ‘tricks’ for nonlinear equations
10.3 Show that any equation that can be written in the form
f (x) + g(y)dy
dx = 0
is exact, and ﬁnd its solution in terms of integrals of f and g. Hence ﬁnd the solutions
of
(i)
V ′(x) + 2y dy
dx = 0
and
(ii)

 1
y −a
 dy
dx + 2
x −b = 0,
for x, y > 0.
10.4 By substituting u = y/x solve the following homogeneous equations:
(i)
xy + y2 + x2 −x2 dy
dx = 0
(the solution is y = x tan(ln |x| + c)).
(ii)
dx
dt = x2 + t
√
t2 + x2
tx
(the solution is x(t) = ±t

(ln |t| + c)2 −1).
10.5 You could solve
dx
dt = kx −x2.
by separating variables (see Exercise 8.7). Instead, substitute u = x−1 and show that
u satisﬁes the linear equation
du
dt = 1 −ku.
Solve this equation for u(t), and hence ﬁnd the solution x(t).
10.6 Use an appropriate substitution to solve the equation
˙x = x(κ2 −x2).
You should recover the solution (8.16) found by separating variables.

Part II
Second order linear equations with constant coefﬁcients


11
Second order linear equations: general theory
We will now turn to second order differential equations,
d2x
dt2 = f (˙x, x, t).
(11.1)
In this chapter we address the kinds of theoretical question that we covered for ﬁrst
order equations in Chapter 6. As such there are few examples, but we will return
to more concrete problems and solution methods in the next chapter.
11.1 Existence and uniqueness
First we discuss the existence and uniqueness of solutions. Before we do this for-
mally, we give an indication of why we will need to specify both x and ˙x in our
‘initial condition’.
Consider the simplest type of second order equation,
d2x
dt2 = f (t),
(11.2)
the second order equivalent of the ‘trivial’ equations we considered in Chapter 5.
We can solve (11.2) by integrating twice: if F is any anti-derivative of f then
dx
dt (t) = F(t) + c1
(11.3)
and then if F is any anti-derivative of F
x(t) = F(t) + c1t + c2.
The two integrations result in two arbitrary constants (c1 and c2); specifying x(t0)
alone will not be enough to tie down the solution, but we need to specify ˙x(t0) (to
ﬁx c1) and then x(t0) (to determine c2).
101

102
11 Second order linear equations: general theory
To put this in a physical context, equation (11.2) is the equation of motion for
a particle moving under the inﬂuence of a force f (t) per unit mass. In order to
predict the motion of the particle in the future we need to know both its current po-
sition and its current velocity (e.g. the difference between dropping and throwing
a piece of chalk).
We now state the existence and uniqueness theorem. As with our previous ex-
istence and uniqueness theorem (Theorem 6.2) it can be paraphrased as ‘unique
solutions exist provided that f is sufﬁciently nice’.
Theorem 11.1 Given a function f (x2, x1, t), suppose that f , ∂f/∂x1 and ∂f/∂x2
are continuous functions for a1 < x1 < a2, b1 < x2 < b2 and t1 < t < t2. Then
for all initial conditions
x(t0) = x0
and
˙x(t0) = y0
(11.4)
with a1 < x0 < a2, b1 < y0 < b2 and t1 < t0 < t2 there exists a unique solution
of
¨x = f (˙x, x, t)
(11.5)
on some interval I containing t0, i.e. a continuous function with two continuous
derivatives that satisﬁes (11.4) and the equation (11.5) on I.
11.2 Linearity
In the following chapters (Chapters 12–20) we will concentrate on linear second
order equations, the most general form of which is
a2(t)d2x
dt2 + a1(t)dx
dt + a0(t)x = g(t).
Most of the time during any general treatment we will assume that a2(t) ̸= 0,
divide by a2, and rewrite the equation as
d2x
dt2 + p(t)dx
dt + q(t)x = f (t)
(11.6)
(cf. (3.5)), since this saves a little algebra.
When we have not speciﬁed the initial conditions for (11.6) the equation will
not have a unique solution, and we would expect its general solution to have two
arbitrary constants so that we can ﬁt any pair of initial conditions, x(t0) = x0 and
˙x(t0) = y0. We now investigate this a little further, starting with the homogeneous

11.2 Linearity
103
problem
d2x
dt2 + p(t)dx
dt + q(t)x = 0
(11.7)
(recall that (11.6) is called homogeneous when f (t) = 0).
Our ﬁrst observation is crucial: if x1(t) and x2(t) are two solutions of (11.7)
then so is
x(t) = αx1(t) + βx2(t)
for any choice of two real numbers α and β. This is known as the principle of
superposition of solutions. To see this, ﬁrst note that
dx
dt = αdx1
dt + β dx2
dt
and
d2x
dt2 = αd2x1
dt2 + β d2x2
dt2 ;
therefore
d2x
dt2 + p(t)dx
dt + q(t)x = α
d2x1
dt2 + p(t)dx1
dt + q(t)x1

+β
d2x2
dt2 + p(t)dx2
dt + q(t)x2

= 0. (11.8)
We can express this in a more elegant way if we are prepared to deﬁne some extra
notation. Although this might appear complicated, all that we are going to do is to
deﬁne a shorthand so that instead of always having to talk about
d2x
dt2 + p(t)dx
dt + q(t)x
(11.9)
we can refer simply to L[x].
Given a function x(t) that has two derivatives we simply deﬁne L[x] to be
(11.9), i.e. the left-hand side of our equation:
L[x](t) = d2x
dt2 (t) + p(t)dx
dt (t) + q(t)x(t).
(11.10)
The argument ‘(t)’ has been included here to emphasise that L[x] is a function of
t; starting with x(t), which is itself a function of t, L[x](t) gives another function
of t. This L is referred to as a differential operator, since it ‘operates’ on x(t) by
performing various differentiations. We will be somewhat more rigorous about the
deﬁnition of L in Section 11.5.
Now we can express our observation about adding multiples of solutions by
saying that the operator L is linear; this simply means that
L[αx1 + βx2] = αL[x1] + βL[x2]
(11.11)

104
11 Second order linear equations: general theory
for all choices of α, β ∈R and functions x1 and x2 that have two derivatives (so
that L[x1] and L[x2] make sense). If we write equation (11.11) in full using the
deﬁnition of L then it gives precisely the ﬁrst equality in (11.8). It is this property
of linearity which makes linear equations so much easier to solve than nonlinear
ones.
11.3 Linearly independent solutions
We will now see that in order to ﬁnd the general solution of (11.7) we have to ﬁnd
two ‘different’ solutions x1(t) and x2(t); from these we will be able to construct
any solution x(t) as a linear combination
x(t) = αx1(t) + βx2(t).
(11.12)
11.3.1 Linear independence of functions
At the moment we have no well-formed idea of what it means for two solutions
to be ‘different’. The appropriate notion is that the two solutions are linearly inde-
pendent, an idea borrowed from vector algebra. The n vectors v1, . . . , vn are said
to be linearly independent if the only solution of
α1v1 + · · · + αnvn = 0
is α1 = α2 = · · · = αn = 0, i.e. if none of them can be written as a linear com-
bination of the others. We now make the same deﬁnition replacing the vectors
v1, . . . , vn with functions x1(t), . . . , xn(t).
Deﬁnition 11.2 The functions x1(t), . . . , xn(t) are linearly independent on an in-
terval I if the only solution of
α1x1(t) + · · · + αnxn(t) = 0
for all
t ∈I
is α1 = · · · = αn = 0.
When we have only two functions their linear independence simply says that
they are not proportional on I. If x1(t) and x2(t) are proportional on I then for
some constant c
x2(t) = cx1(t);
it follows that cx1(t) −x2(t) = 0 on I, and so x1 and x2 are linearly dependent.
Conversely, if x1(t) and x2(t) are linearly dependent on I then for some non-zero
α1 and α2
α1x1(t) + α2x2(t) = 0
for all
t ∈I

11.3 Linearly independent solutions
105
which implies that
x1(t) = −α2
α1
x2(t),
i.e. x1 and x2 are proportional.
11.3.2 Two linearly independent solutions are necessary
and sufﬁcient
First of all, we will see that it is not possible to obtain all possible solutions of
d2x
dt2 + p(t)dx
dt + q(t)x = 0
(11.13)
(equation (11.7)) as multiples of a single special solution. Suppose that x1(t) is the
solution of (11.13) satisfying
x1(t0) = 1
and
˙x1(t0) = 0,
while x2(t) is the solution that satisﬁes
x2(t0) = 0
and
˙x2(t0) = 1.
Using Theorem 11.1 both these solutions exist and are unique; but it is clear that
one cannot be a multiple of the other. This shows that at least two linearly inde-
pendent solutions are necessary.
We now see that given two solutions x1(t) and x2(t) that are not proportional
(like the two just deﬁned above) we can ﬁnd α and β such that the linear combi-
nation
x(t) = αx1(t) + βx2(t)
(which must also solve (11.13)) satisﬁes any given initial condition
x(t0) = x0
and
˙x(t0) = v0.
(11.14)
The correct values of α and β can be obtained by solving the simultaneous equa-
tions
αx1(t0) + βx2(t0) = x0
α ˙x1(t0) + β ˙x2(t0) = v0.
Writing these as a matrix equation

 x1(t0)
x2(t0)
˙x1(t0)
˙x2(t0)
 
α
β

=

 x0
v0

(11.15)

106
11 Second order linear equations: general theory
it is easy to see that we can solve for α and β provided that the matrix on the left-
hand side is non-singular. This happens whenever its determinant is non-zero (see
Appendix B).
We will assume that the determinant is zero,
x1(t0)˙x2(t0) −x2(t0)˙x1(t0) = 0,
(11.16)
and deduce a contradiction. It follows from this assumption that1
x1(t0)
x2(t0) = ˙x1(t0)
˙x2(t0)
= c, say,
and so
x1(t0) = cx2(t0)
and
˙x1(t0) = c ˙x2(t0).
(11.17)
Because the equation is linear this implies that x2(t) and x1(t) are proportional;
since x2(t) is a solution so is y(t) = cx2(t), and clearly y(t) satisﬁes the initial
conditions
y(t0) = cx2(t0) = x1(t0)
and
˙y(t0) = c ˙x2(t0) = ˙x1(t0).
Since solutions are unique, it follows that x1(t) = y(t) = cx2(t) for all t. However,
we chose x1(t) and x2(t) to be two linearly independent solutions, so we know that
they are not proportional.
Since our assumption that the matrix in (11.15) is singular has led us to a contra-
diction, the matrix must be non-singular. Hence it is possible to solve this equation
and ﬁnd values of α and β such that x(t) = αx1(t) + βx2(t) satisﬁes the required
initial conditions.
Thus, as claimed, two linearly independent solutions are necessary (we need
at least two) and also sufﬁcient (two will do) to form any solution as a linear
combination
x(t) = αx1(t) + βx2(t).
11.4 *The Wronskian
We have just seen that the determinant of the matrix in (11.15) is closely related to
the linear independence of the functions x1(t) and x2(t). We now investigate this
a little further. If x1 and x2 are linearly independent on an interval I then the only
1 The following line assumes implicitly that x2(t0) ̸= 0 and that ˙x2(t0) ̸= 0. It is certainly not possible that
x2(t0) = ˙x2(t0) = 0, since then the uniqueness of solutions would imply that x2(t) = 0 for all t. If x2(t0) = 0
(and ˙x2(t0) ̸= 0) then (11.16) implies that x1(t0) = 0, and then equation (11.17) follows once more. A similar
argument yields (11.17) if ˙x2(t0) = 0 and x2(t0) ̸= 0.

11.5 *Linear algebra
107
solution of
αx1(t) + βx2(t) = 0
for all
t ∈I
(11.18)
should be α = β = 0. If (11.18) holds for all t ∈I then we can differentiate and
obtain a second equation
α ˙x1(t) + β ˙x2(t) = 0
for all
t ∈I.
Putting these two equations together we obtain the matrix equation

 x1(t)
x2(t)
˙x1(t)
˙x2(t)
 
α
β

=

0
0

.
If the matrix in this equation is non-singular for some t0 ∈I then we can ﬁnd
the solution (α, β) by multiplying by the inverse of the matrix. This will give
α = β = 0, implying that x1(t) and x2(t) are linearly independent on I.
There is a special name for the determinant of this matrix, the Wronskian of x1
and x2, written as W[x1, x2](t) (note that the Wronskian is a function of t):
W[x1, x2](t) =

x1(t)
x2(t)
˙x1(t)
˙x2(t)
 = x1(t)˙x2(t) −x2(t)˙x1(t).
We can re-express what we said above by saying that if W[x1, x2](t) ̸≡0 on I
(is not identically equal to zero on I) then the functions x1 and x2 are linearly
independent on I.
Conversely, in Section 11.3.2 we showed that (11.16) implies that x1(t) =
cx2(t) for all t ∈I. Since (11.16) is just W[x1, x2](t0) = 0, we have already shown
that if W[x1, x2](t) = 0 anywhere on the interval I then x1 and x2 are linearly de-
pendent.
Therefore two solutions of a linear second order equation are linearly indepen-
dent if and only if their Wronskian is non-zero. For some other properties of the
Wronskian see Exercises 11.2 and 11.3.
11.5 *Linear algebra
Linear algebra is the abstract study of the properties of linear spaces, and linear
maps between such spaces. Because the subject is abstract it can be daunting, but
it is its very abstraction that makes it widely applicable. Here we will see that the
above results about linear differential equations can be very naturally recast within
the linear algebra framework. Those unfamiliar with the ideas of linear algebra
should feel free to move on to the next chapter.
The fundamental concept in the theory is the notion of a vector space; a (real)
vector space is a collection V of elements along with notions of addition and

108
11 Second order linear equations: general theory
multiplication, such that if v1 and v2 are elements of V then
αv1 + βv2 ∈V
for all
α, β ∈R.
The prime example is the collection of all vectors in Rn.
In order to set our results in this context, the ﬁrst thing we need to do is to be a
little more careful about our deﬁnition of the linear operator L. In order to do this
we have to be more precise about the ‘functions x with two derivatives’ for which
L[x] is sensible.
We will denote by C0(I) the collection of all continuous functions that are de-
ﬁned on the interval I. This is a vector space, since if f, g ∈C0(I) then
αf + βg ∈C0(I)
for all
α, β ∈R.
Similarly, the space C2(I), consisting of all continuous functions on I with con-
tinuous ﬁrst and second derivatives, is also a vector space.
Given a function x ∈C2(I), the linear operator L deﬁned as in (11.10) by
L[x] = d2x
dt2 + p(t)dx
dt + q(t)x
is certainly sensible, since x has two derivatives. Assuming that p(t) and q(t) are
continuous functions, it follows that L[x] ∈C0(I), since x, ˙x, and ¨x are continu-
ous.
Thus L is a map from C2(I) into C0(I). Furthermore, as we have already seen,
it is a linear map, i.e.
L[αx1 + βx2] = αL[x1] + βL[x2]
for any α, β ∈R.
The kernel of a linear operator L : E →V (where E and V are vector spaces)
consists of all those elements of E that are mapped to zero by L,
ker(L) = {x ∈E : L[x] = 0}.
The kernel of our differential operator L consists of all the elements of C2(I) for
which L[x] = 0, i.e. precisely the set of all solutions of the homogeneous equation.
Now, it is a general result that the kernel of a linear operator is itself a vector
space, in other words if x1 ∈ker(L) and x2 ∈ker(L) then
x1 ∈ker(L)
and
x2 ∈ker(L)
⇒
αx1 + βx2 ∈ker(L).
We have seen this already for our operator L, since it is just another way of writing
L[x1] = 0
and
L[x2] = 0
⇒
L[αx1 + βx2] = 0

Exercises
109
(cf. (11.11)), i.e. we can add multiples of solutions of homogeneous linear equa-
tions and still have a solution (the superposition principle).
In order to construct the general solution of a homogeneous second order linear
ODE we have just seen that we need two linearly independent solutions x1(t) and
x2(t); using these we can construct any solution as
αx1(t) + βx2(t).
Put another way, any element of ker(L) can be written as a linear combination of
the two linearly independent elements x1 and x2. This says precisely that x1 and
x2 form a basis of ker(L), i.e. a linearly independent spanning set.
Since the number of basis elements for a vector space is exactly what we mean
by its dimension, it follows that the dimension of ker(L) is two. Given our deﬁni-
tion of L, the statement
dim ker(L) = 2
is an elegant (albeit abstract) way of saying ‘we can construct any solution of a
homogeneous second order linear ODE given two linearly independent solutions
(and two are needed)’.
Exercises
11.1 By ﬁnding the Wronskian of the following pairs of functions, show that they are
linearly independent:
(i) x1(t) = ek1t and x2(t) = ek2t with k1 ̸= k2,
(ii) x1(t) = ekt and x2(t) = tekt, and
(iii) x1(t) = eρt sin ωt and x2(t) = eρt cos ωt.
11.2 Show that the Wronskian for two solutions x1(t) and x2(t) of the second order dif-
ferential equation
d2x
dt2 + p1(t)dx
dt + p2(t)x = 0
(E11.1)
satisﬁes
˙W(t) = −p1(t)W(t).
(Write W(t) = x1(t)˙x2(t) −x2(t)˙x1(t), differentiate, and use the fact that x1(t) and
x2(t) satisfy the equation (E11.1).) Deduce either that W(t) = 0 for all t, or that
W(t) ̸= 0 for all t.
11.3 We have seen that if x1 and x2 are two solutions of a linear differential equation, then
they are linearly independent if and only if their Wronskian is non-zero. The simple

110
11 Second order linear equations: general theory
example of this question shows that this is not true for general functions that are not
the solutions of some differential equation.
(i) Check carefully that if f (t) = t2|t| then d f/dt = 3t|t| (this is easy when t ̸= 0;
you will have to use the formal deﬁnition of the derivative at t = 0).
(ii) Let
f1(t) = t2|t|
and
f2(t) = t3.
Show that although these two functions are linearly independent on R, their
Wronskian is identically zero.

12
Homogeneous second order linear equations
with constant coefﬁcients
In this chapter we will ﬁnd the general solution of the homogeneous linear equation
a d2x
dt2 + bdx
dt + cx = 0.
(12.1)
From our analysis in the previous chapter we would expect this general solution to
be of the form
x(t) = Ax1(t) + Bx2(t)
where x1(t) and x2(t) are two linearly independent solutions of (12.1).
In order to ﬁnd these two solutions, we ‘guess’ that they are of the form
x(t) = ekt
and substitute this into (12.1). To see that this is reasonable, ﬁrst, remember that
ekt is a solution of the constant coefﬁcient ﬁrst order linear equation
dx
dt = kx,
so that we have already seen exponential functions in the context of linear equa-
tions. More tellingly, we know that taking derivatives of x(t) = ekt only multiplies
x(t) by k. So ¨x, ˙x, and x will all be just some constant times ekt; we should be able
to cancel the ekts and all being well end up with an equation that we can solve.
This is exactly what happens. Since
d
dt (ekt) = kekt
and
d2
dt2 (ekt) = k2ekt,
substituting x(t) = ekt in (12.1) gives
ak2ekt + bkekt + cekt = 0.
111

112
12 Homogeneous second order linear equations
Since ekt is never zero we can divide by ekt and ﬁnd that we are left with a quadratic
equation for k, known as the auxiliary equation,
ak2 + bk + c = 0.
(12.2)
Our substitution has reduced the original differential equation for x(t) into a
simple algebraic equation for k. Since (12.2) is a quadratic equation we stand a
good chance of ﬁnding two roots, which would provide us with the two inde-
pendent solutions we need to form our general solution. However, although we
might have two distinct real roots, it is also possible to have only one repeated
real root, or even two complex conjugate roots (and therefore no real roots). These
three cases lead to different types of solutions for (12.1) and we consider each in
turn.
12.1 Two distinct real roots
Using the quadratic formula, the solutions of (12.2) are given by
k = −b ±
√
b2 −4ac
2a
.
Provided that b2 −4ac > 0 we can solve the equation to give two distinct real
roots, which we will call k1 and k2. We have found two different values of k that
will make our guess ekt a solution of equation (12.1), so we have already obtained
the two solutions we require; it is clear that if k1 ̸= k2 then ek1t and ek2t are linearly
independent on any interval (we could also check this using the Wronskian, see
Exercise 11.1).
The general solution of (12.1) is therefore given by a linear combination of these
two solutions,
x(t) = Aek1t + Bek2t.
Note that if one of k1 and k2 is positive (or both of them) then there are solu-
tions that tend exponentially fast to +∞, and solutions that tend exponentially fast
to −∞(depending on the initial condition), both as t →+∞. It is only if both
k1 and k2 are negative that all the solutions decay exponentially to zero. See
Exercise 12.2 for more on this.
Example 12.1 Find the general solution of the equation
¨x + ˙x −6x = 0,
and the solution that satisﬁes the initial conditions
x(0) = 1
and
˙x(0) = 2.

12.2 A repeated real root
113
The equation has x(t) = ekt as a solution when k satisﬁes
k2 + k −6 = 0.
The roots of this are k = 2 and k = −3, so the general solution is
x(t) = Ae2t + Be−3t.
(12.3)
To ﬁt the initial conditions we substitute in to (12.3) and in to ˙x(t) = 2Ae2t −
3Be−3t and then solve the resulting simultaneous equations
A + B = 1
2A −3B = 2;
so A = 1 and B = 0 which gives the solution
x(t) = e2t.
If one of the roots of the auxiliary equation is zero then one of the two linearly
independent solutions will be e0×t = e0 = 1, i.e. a constant.
Example 12.2 Find the general solution of
¨x −2˙x = 0.
If we try x(t) = ekt for this example then
k2 −2k = 0,
with roots k = 0 and k = 2, giving the two solutions e0×t = e0 = 1 and e2t. It
follows that the general solution is
x(t) = A + Be2t.
(12.4)
□
12.2 A repeated real root
When b2 = 4ac in the auxiliary equation (ak2 + bk + c = 0) we get a repeated
root k, and so we only obtain a single solution x(t) = ekt. However, we know that
in order to write down the general solution we need to have two linearly indepen-
dent solutions.
In this case the second solution1 includes an extra factor of t: it is tekt. We will
see in Chapter 17 that it is possible to derive this solution systematically, but for
now we will just check that it really is a solution.
When the auxiliary equation has a repeated root we must have b2 = 4ac and
we can use this to put the linear equation a ¨x + b ˙x + cx = 0 into a standard form.
1 For the use of the Wronskian to make sure that these two solutions are linearly independent see Exercise 11.1.

114
12 Homogeneous second order linear equations
Dividing through by a gives
¨x + b
a ˙x + c
a x = 0.
Since b2 = 4ac this is the same as
¨x + b
a ˙x + b2
4a2 x = 0,
and writing λ = −b/2a this becomes
¨x −2λ˙x + λ2x = 0.
(12.5)
If we try x(t) = ekt in this equation then k must solve
k2 −2λk + λ2 = (k −λ)2 = 0,
and there is indeed just one repeated root k = λ.
We now try the second solution given above, x(t) = teλt. For this we have
˙x = eλt + λteλt
¨x = 2λeλt + λ2teλt,
and so substituting into the left-hand side of (12.5) we get
(2λeλt + λ2teλt) −2λ(eλt + λteλt) + λ2(teλt)
which is zero.
So the two linearly independent solutions that we get in the case of a repeated
root k are ekt and tekt, and the general solution is
x(t) = (A + Bt)ekt.
(12.6)
Clearly if k > 0 then solutions tend to inﬁnity (+∞or −∞depending on the
initial condition), while if k < 0 the solutions decay to zero; tekt tends to zero if
k < 0 (see Figure 12.1).
Example 12.3 Find the solution of
¨x + 2˙x + x = 0
that satisﬁes
x(0) = 0
and
˙x(0) = 1.
The equation has a solution x(t) = ekt if k solves
k2 + 2k + 1 = 0.

12.3 No real roots
115
0
5
10
15
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
Fig. 12.1. The graph of te−t against t: despite an initial increase the function
decays to zero as t →∞.
This equation is (k + 1)2 = 0, so there is a repeated root k = −1. Two independent
solutions of the equation are e−t and te−t, so the general solution is therefore
x(t) = (A + Bt)e−t.
In order to satisfy the initial conditions we substitute in to ﬁnd A and B, so we
need, since ˙x(t) = (B −A)e−t −Bte−t,
A = 0
B −A = 1,
and the solution in this case is
x(t) = te−t,
whose graph is shown in Figure 12.1.
□
12.3 No real roots
When b2 < 4ac the expression within the square root in the quadratic formula is
negative, and so there are no real roots. Instead we obtain a pair of complex roots,
k = −b
2a ± i
√
4ac −b2
2a
.
For brevity we will write these as k = ρ ± iω (so ρ = −b/2a and ω =
√
4ac −b2/2a). The general solution corresponding to these roots is
x(t) = eρt(A cos ωt + B sin ωt).
(12.7)

116
12 Homogeneous second order linear equations
The real part of the root gives an exponential, and the complex part gives oscillat-
ing sine and cosine functions.
When you come across complex roots in a problem you should just write down
(12.7). However, we will now see how to derive the general solution (12.7) using
the complex roots of the auxiliary equation. If you are not happy with complex
numbers, or just not interested, then you can move to equation (12.9)
Even though the roots are complex there is nothing wrong with our argument.
With k = ρ ± iω the expression ekt does solve the equation, and so the general
solution can be written as
x(t) = Ce(ρ+iω)t + De(ρ−iω)t.
However, our solution x(t) should be real, so we need to restrict the possible values
of C and D; since e(ρ−iω)t is the complex conjugate of e(ρ+iω)t, in order to make
the whole expression real we want D to be the complex conjugate of C (we write
D = C∗). Real solutions of the equation are given by
x(t) = Ce(ρ+iω)t + C∗e(ρ−iω)t
(12.8)
for an arbitrary complex number C = α + iβ. Note that the solution still has the
two arbitrary constants (now α and β) that we would expect. With a little work
we can rewrite this expression in a form that involves no complex numbers and
thereby recover (12.7).
To do this we need to use the fact that
eiθ = cos θ + i sin θ
and that for any complex number z, z + z∗= 2 Re(z) (see Appendix A). Going
back to (12.8) and using these two facts we get
x(t) = 2 Re[Ceρ+iω)t]
= 2eρt Re[Ceiωt]
= 2eρt Re[(α + iβ)(cos ωt + i sin ωt)]
= 2eρt(α cos ωt −β sin ωt)
= eρt(A cos ωt + B sin ωt),
if we set A = 2α and B = −2β. Since α and β were entirely arbitrary, so are A
and B.
It is worth emphasising again that when you are trying to solve an equation
and come across a complex conjugate pair of roots ρ ± iω, you should immedi-
ately write down the general solution (12.9), rather than going through the above
analysis.

12.3 No real roots
117
The solution
x(t) = eρt(A cos ωt + B sin ωt)
(12.9)
naturally splits into two parts: a factor eρt outside the square brackets, and an
oscillating factor inside the square brackets (remember that we have already seen
in Section 9.4.3 how to combine A cos ωt + B sin ωt to give one oscillating term
M cos(ωt −φ)).
All such solutions oscillate, and whether solutions decay or grow depends on the
sign of ρ. If ρ < 0 then all the solutions decay exponentially to zero; if ρ = 0 then
the amplitude is constant as we have pure oscillations; and if ρ > 0 then the solu-
tion oscillates with an amplitude that grows exponentially fast. These possibilities
are illustrated in Figure 12.2.
The simplest example involving complex roots is when k = ±iω, known as sim-
ple harmonic motion; we consider this in more detail in the next chapter.
Example 12.4 Find the solution of
¨x + 2˙x + 5x = 0
x(0) = 1
˙x(0) = 0.
(12.10)
0
ρ > 0
0
ρ < 0
0
ρ = 0
Fig. 12.2. Sample solutions of the form x(t) = eρt(A cos ωt + B sin ωt) for
(from top to bottom) ρ < 0, ρ = 0 and ρ > 0. Each graph shows x(t)
against t.

118
12 Homogeneous second order linear equations
For this equation x(t) = ekt is a solution if k satisﬁes
k2 + 2k + 5 = 0
which has roots
k = −2 ±
√
4 −20
2
= −1 ±
√
−4 = −1 ± 2i.
So the general solution of (12.10) is
x(t) = e−t(A cos 2t + B sin 2t),
showing that the origin is stable. Since
˙x(t) = e−t((2B −A) cos 2t −(2A + B) sin 2t)
the initial conditions pick out the solution with
A = 1
2B −A = 0,
i.e. A = 1 and B = 1
2, so that
x(t) = e−t
cos 2t + 1
2 sin 2t

.
Exercises
12.1 Find the general solution of the following differential equations, and then the solution
satisfying the speciﬁed initial conditions.
(i) ¨x −3˙x + 2x = 0 with x(0) = 2 and ˙x(0) = 6;
(ii) y′′ −4y′ + 4y = 0 with y(0) = 0 and y′(0) = 3;
(iii) z′′ −4z′ + 13z = 0 with z(0) = 7 and z′(0) = 42;
(iv) ¨y + ˙y −6y = 0 with y(0) = −1 and ˙y(0) = 8;
(v) ¨y −4 ˙y = 0 with y(0) = 13 and ˙y(0) = 0;
(vi) ¨θ + 4θ = 0 with θ(0) = 0 and ˙θ(0) = 10;
(vii) ¨y + 2 ˙y + 10y = 0 with y(0) = 3 and ˙y(0) = 0;
(viii) 2¨z + 7˙z −4z = 0 with z(0) = 0 and ˙z(0) = 9;
(ix) ¨y + 2 ˙y + y = 0 with y(0) = 0 and ˙y(0) = −1;
(x) ¨x + 6˙x + 10x = 0 with x(0) = 3 and ˙x(0) = 1;
(xi) 4¨x −20˙x + 21x = 0 with x(0) = −4 and ˙x(0) = −12;
(xii) ¨y + ˙y −2y = 0 with y(0) = 4 and ˙y(0) = −4;
(xiii) ¨y −4y = 0 with y(0) = 10 and ˙y(0) = 0;
(xiv) y′′ + 4y′ + 4y = 0 with y(0) = 27 and y′(0) = −54; and
(xv) ¨y + ω2y = 0 with y(0) = 0 and ˙y(0) = 1.
12.2 If the roots of the auxiliary equation are k1 > 0 and −k2 < 0 then the solution is
x(t) = Aek1t + Be−k2t.

Exercises
119
For most choices of initial conditions
x(0) = x0
˙x(0) = y0
we will have x(t) →±∞as t →∞. However, there are some special initial con-
ditions for which x(t) →0 as t →∞. Find the relationship between x0 and y0 that
ensures this.
12.3 (T) Solutions of linear equations with constant coefﬁcients cannot blow up in ﬁnite
time; it follows that their solutions exist for all t ∈R. To see this, we will consider
¨x + p ˙x + qx = 0
with
x(0) = x0
and
˙x(0) = y0
for t ≥0 (a similar argument applies for t ≤0). By setting y = ˙x, we can rewrite this
as a coupled pair of ﬁrst order equations
˙x = y
˙y = −py −qx.
Show that
1
2
d
dt (x2 + y2) = (1 −q)xy −py2,
and hence that
d
dt (x2 + y2) ≤(1 + |q| + 2|p|)(x2 + y2).
Using the result of Exercise 9.7 deduce that for t ≥0
x(t)2 + y(t)2 ≤(x(0)2 + y(0)2)e(1+|q|+2|p|)t,
showing that ﬁnite-time blowup is impossible. Hint: xy ≤1
2(x2 + y2). (The same
argument works, essentially unchanged, for
¨x + p(t)˙x + q(t)x = 0
provided that |p(t)| ≤p and |q(t)| ≤q for all t ∈R).

13
Oscillations
In this chapter we look at oscillating mechanical systems, which form one very
natural class of examples of second order linear equations.
13.1 The spring
The simplest system that gives rise to oscillations is a mass on a spring. If the
spring has a natural length l, then Hooke’s law says the force exerted by the spring
when it is extended an additional length x is proportional to this extension x.
So the equation of motion for a mass (with mass m) on the end of spring (see
Figure 13.1) is
m ¨x = −kx,
where k is the ‘spring constant’.
If we divide by m and set ω2 = k/m then this reads
¨x = −ω2x.
(13.1)
Equation (13.1) is a linear equation. Trying x(t) = ekt we get
k2 = −ω2
as the auxiliary equation that determines k. This equation has complex roots k =
±iω, and it follows that the general solution is of the form
x(t) = A cos ωt + B sin ωt.
(13.2)
We can use the same trick we used in Section 9.4 to rewrite our solution to make
it clear that it is one oscillation. If we write
x(t) =

A2 + B2

A
√
A2 + B2 cos ωt +
B
√
A2 + B2 sin ωt

(13.3)
120

13.1 The spring
121
l
x
Fig. 13.1. A spring: the top picture shows the spring at its natural length l, unex-
tended, while the lower picture shows the spring extended by a length x.
M
φ/ω
Fig. 13.2. The solution x(t) = M cos(ωt −φ) plotted against t is shown here as
a solid line. For comparison the dotted line shows the graph of x(t) = M cos ωt;
the delay between the two solutions is φ/ω, as indicated.
then the squares of the coefﬁcients of cos and sin within the [· · ·] now sum to one,
so we can ﬁnd φ with
cos φ =
A
√
A2 + B2
and
sin φ =
B
√
A2 + B2
(i.e. with tan φ = B/A). Writing M =
√
A2 + B2 then (13.3) becomes
x(t) = M[cos φ cos ωt + sin φ sin ωt]
= M cos(ωt −φ),
using the double angle formula cos a cos b + sin a sin b = cos(a −b). This solu-
tion is illustrated in Figure 13.2.

122
13 Oscillations
θ
length L
mass m
L cos θ
L(1 − cos θ)
Fig. 13.3. The simple pendulum.
13.2 The simple pendulum
We now consider the oscillations of a pendulum. Suppose that the pendulum has
length L, that the mass of the shaft is negligible, and that the bob has mass m.
Figure 13.3 shows the general setup; θ is the angle that the pendulum makes with
the downward vertical.
The potential energy of the pendulum is mg × L(1 −cos θ). If the pivot is at
the origin then at an angle θ the coordinates of the centre of the mass m are x =
(x, y) = (L sin θ, L(cos θ −1)). Then ˙x = (˙x, ˙y) = (L cos θ ˙θ, −L sin θ ˙θ), and
so the kinetic energy is
1
2m|˙x|2 = 1
2m(˙x2 + ˙y2) = 1
2m(L2 sin2 θ ˙θ2 + L2 cos2 θ ˙θ2) = 1
2mL2 ˙θ2.
Since the total energy
E = 1
2mL2 ˙θ2 + mgL(1 −cos θ)
is constant, if we differentiate we obtain
0 = mL2 ˙θ ¨θ + mgL sin θ ˙θ,
which, on dividing by ˙θ, yields the equation of motion1
m d2θ
dt2 = −mg
L sin θ.
(13.4)
We will investigate equation (13.4) itself in Chapter 35, but for now we approx-
imate it by a linear equation so that we can use the theory of the preceding chapter.
1 With some care, assuming the continuity of θ(t) and its derivatives, it is possible to show that this equation is
also valid when ˙θ = 0.

13.3 Damped oscillations
123
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
θ = 0.3
θ = 0.5
Fig. 13.4. The left-hand picture is the graph of sin θ (solid) and θ (dashed) plot-
ted against θ for 0 ≤θ ≤1. Note that the curves are fairly close for θ ≤0.5 and
almost indistinguishable when θ ≤0.3. The right-hand picture shows the pendu-
lum at angles θ = 0.3 and θ = 0.5 to the downward vertical. Clearly requiring
−0.3 ≤θ ≤0.3 is little restriction for a calculation involving the pendulum in a
clock.
When the oscillations are small, i.e. when θ is small, we can approximate sin θ by
θ (see Figure 13.4) and so obtain the linear equation
m d2θ
dt2 = −mg
L θ.
Deﬁning ω2 = g/L we can rewrite this as
d2θ
dt2 = −ω2θ.
(13.5)
Apart from the change of dependent variable from x to θ, this is the same equa-
tion as we had before in (13.1). The solution we found in the previous section
remains valid here, and so we have
θ(t) = M cos(ωt −φ).
Thus the pendulum oscillates about θ = 0, the downward vertical, with period
2/ω = 2√L/g. Note that in this linear approximation the amplitude M of the
motion (how wide the swing is) has no effect on the period.
13.3 Damped oscillations
The simple equations above neglect any effects of friction or air resistance, or what
we might more generally call ‘damping’.

124
13 Oscillations
If we assume that damping exerts a force proportional to the velocity, but in the
opposite direction, then, with µ > 0,
m ¨x + µ˙x + kx = 0.
Dividing by m as before, and setting λ = µ/k, we arrive at the model
¨x + λ˙x + ω2x = 0
(13.6)
with λ > 0.
In order to solve (13.6) we try x(t) = Aekt and obtain the auxiliary equation
k2 + λk + ω2 = 0.
The roots of this equation are
k = −λ ±
√
λ2 −4ω2
2
,
which gives rise to three possibilities depending on the nature of the roots, all
illustrated in Figure 13.5.
0
0
Over–damping
t
x
0
0
Critical damping
t
x
0
0
Under–damping
t
x
Fig. 13.5. From top to bottom: over-damping x(t) = Ae−k1t + Be−k2t (for large
t, x(t) ≈Ae−k1t (the dotted curve), where 0 < k1 < k2); critical damping x(t) =
Ate−kt + Be−kt (for large t, x(t) ≈Ate−kt, shown in the dotted curve); under-
damping.

13.3 Damped oscillations
125
Over-damping
When λ2 > 4ω2 there are two distinct real roots −k1 and −k2, and both are nega-
tive (since 0 < λ2 −4ω2 < λ2). So the general solution is
x(t) = Ae−k1t + Be−k2t,
and all the solutions are exponentially decaying and approach zero as t →∞.
Furthermore there are no oscillations of the system on its way to equilibrium.
Critical damping
When λ2 = 4ω2 we have k = −λ/2 ‘twice’, so that the general solution is a com-
bination of e−λt/2 and te−λt/2,
x(t) = (A + Bt)e−λt/2.
Again, the system settles down to its equilibrium without any oscillations. How-
ever, this is the critical case, in that any further reduction in the damping allows for
oscillations, as we will soon see. It is also possible for x(t) to increase for a short
time interval (see Figure 13.5), see Exercise 13.9 for more details.
Under-damping
When λ2 < 4ω2 we have a complex conjugate pair for k,
k = −λ
2 ± iσ
(with σ = 1
2
√
4ω2 −λ2). This gives the general solution
x(t) = e−λt/2(A cos σt + B sin σt).
(13.7)
The system is always oscillating, but the amplitude of the oscillations decays to
zero exponentially fast.
If this solution represents the oscillations of a pendulum damped by frictional
forces (air resistance, friction at the pivot) then although the amplitude decays the
period of the oscillations remains constant. It is this effect that makes the pendulum
an effective mechanism to run a clock.
To see that this is the case, we rewrite x(t) from (13.7) in the compact form
x(t) = Me−λt/2 cos(σt −φ),
and differentiate with respect to t to give
dx
dt = −M λ
2e−λt/2 cos(σt −φ) −σ Me−λt/2 sin(σt −φ).

126
13 Oscillations
0
t
x
2π/σ
2π/σ
2π/σ
2π/σ
Fig. 13.6. Even though the oscillations are decaying, the period of the oscillations
remains constant.
Thus maxima and minima occur when
tan(σt −φ) = −λ
2σ ,
i.e. when
σt −φ = tan−1

−λ
2σ

+ n
for any integer n. The time between successive maxima is therefore 2π/σ, inde-
pendent of the amplitude, see Figure 13.6.
Exercises
13.1 A spring of natural length l and spring constant k is suspended vertically from a ﬁxed
point, and a weight of mass m attached. If the system is at rest (¨x = ˙x = 0) how far
has the spring extended? If the mass is pulled down slightly from this rest position and
then released, show that it then oscillates about its equilibrium position with period
2/ω, where ω2 = k/m.
13.2 The acceleration due to gravity in fact depends on the distance R from the centre of
the Earth: g = GM/R2, where M is the mass of the Earth and G Newton’s gravita-
tional constant. Show that the period of oscillation of a pendulum will increase as it
is taken higher.
13.3 The Earth bulges at the equator; at a latitude θ, the distance to the centre of the Earth
(measured in kilometres) is approximately
R(θ) =

R2e cos2 θ + R2p sin θ,
where Re = 6378 and Rp = 6357.

Exercises
127
Displaced volume
V
Fig. 13.7. The buoyancy force on an object is equal to the weight of water that it
displaces.
I decide to move from Leamington Spa, at a latitude of 52◦, to Seville, which is lies
at a latitude of 37◦. My grandfather clock, which keeps perfect time, has a pendulum
of length 75 cm. How long would the pendulum need to be to keep perfect time in
Seville?
13.4 The buoyancy force on an object is equal to the weight of water that it displaces. If
an object has mass M and displaces a volume V of water then the forces on it are
Mg −Vg, in units for which the density of water is 1; see Figure 13.7.
A bird of mass m is sitting on a cylindrical buoy of density ρ, radius R, and height
h, which is ﬂoating at rest. How much of the buoy lies below the surface?
The bird ﬂies away. Show that the buoy now bobs up and down, with the amount
below the surface oscillating about ρh with period 2√ρh/g and amplitude m/R2.
13.5 An open tin can, half full of water, is ﬂoating in a canal. The can is 11 cm tall, has a
diameter of 7.5 cm, and has a mass of 50 g. Show that at rest the can is submerged
a distance of approximately 6.63 cm below the surface of the canal. If the can is
pushed down further it will then perform oscillations about its equilibrium position.
Show that the can bobs up and down every 0.21 seconds (a little under ﬁve times per
second). The acceleration due to gravity is approximately 9.8 m/s2 = 980 cm/s2; the
density of water is 1 g/cm3. You can check your answers in a sink with a baked bean
can.
13.6 A right circular cone, of height h, density ρ, and with base radius R, is placed point
downward in a lake. Assuming that the apex remains point vertically downwards,
show that if the cone is submerged to a depth x then
¨x = g −

x
h
3 g
ρ .
(You need not solve this equation.) At equilibrium how far is the cone submerged?
13.7 A dashpot is a device designed to add damping to a system, consisting essentially of
a plunger in a cylinder of liquid or gas, see Figure 13.8.

128
13 Oscillations
Fig. 13.8. A dashpot. Illustration c⃝2001 Airpot Corporation. Airpot is a regis-
tered trademark of Airpot Corporation.
Fig. 13.9. A mass-spring-dashpot system.
It produces a resisting force proportional to the velocity, precisely the kind of
‘damping’ that we used in our model
m ¨x + µ˙x + kx = 0,
(E13.1)
with µ indicating the ‘strength’ of the dashpot. Dashpots are used in a variety of
applications, for example, cushioning the opening mechanism on a tape recorder, or
in car shock absorbers.
A mass-spring-dashpot system consists of a mass attached to a spring and a dash-
pot, and is shown in Figure 13.9. A weight of mass 10 kg is attached to a spring with
spring constant 5, and to a dashpot of strength µ. How strong should the dashpot be
to ensure that the system is over-damped? What would the period of oscillations be
if µ = 14?
13.8 When ﬁrst opened, the Millennium Bridge in London (see Figure 13.10) wobbled
from side to side as people crossed; you can see this on video at www.arup.
com/MillenniumBridge. Footfalls created small side-to-side movements of the
bridge, which were then enhanced by the tendency of people to adjust their steps
to compensate for the wobbling. With more than a critical number of pedestrians
(around 160) the bridge began to wobble violently.2
Without any pedestrians, the displacement x of a representative point on the bridge
away from its normal position would satisfy
M ¨x + k ˙x + λx = 0,
2 A detailed analysis is given in P. Dallard et al., The London Millennium Footbridge, The Structural Engineer
79 (2001), 17–33.

Exercises
129
Fig. 13.10. The Millennium Bridge in London (courtesy of Arup).
where
M ≈4 × 105 kg,
k ≈5 × 104 kg/s,
and
λ ≈107 kg/s2.
Show that the level of damping here is only around 1% of the critical level.
The effective forcing from each pedestrian was found by experiment (which in-
volved varying numbers of people walking across the bridge) to be proportional to ˙x,
with
F ≈300˙x.
If there are N pedestrians, the displacement of the bridge satisﬁes
M ¨x + k ˙x + λx = 300N ˙x.
Find the critical number N0 of pedestrians, such that if there are more than N0 pedes-
trians the bridge is no longer damped. Show that if there are 200 pedestrians then
there will be oscillations with a frequency of approximately 0.8 hertz (oscillations
per second) the amplitude of oscillation of which grows as et/80.
The problem was corrected by adding additional damping, a large part of which
was essentially a collection of dashpots, in order to bring the damping up to 20% of

130
13 Oscillations
the critical level. What would this do to the value of k, and how many people can now
walk across the bridge without counteracting all the damping?
13.9 In the case of critical damping (see Section 13.3), the general solution of (13.6) is of
the form
x(t) = (A + Bt)e−λt/2.
Show that if λA < 2B then x(t) increases initially, reaching its maximum value at
t = 2
λ −A
B .

14
Inhomogeneous second order linear equations
We now investigate how to obtain solutions of the inhomogeneous equation
a d2x
dt2 + bdx
dt + cx = f (t).
(14.1)
As a convenient shorthand we deﬁne an operator L, cf. (11.10), by
L[x] = a d2x
dt2 + bdx
dt + cx.
Recall that L[x](t) is a function of t, as is x(t). Using this notation we can rewrite
(14.1) more compactly as
L[x] = f (t).
Since (14.1) is a second order equation, we expect that the general solution will
have two arbitrary constants in order to ﬁt any choice of initial condition x(t0) =
x0 and ˙x(t0) = y0.
14.1 Complementary function and particular integral
Because of the linearity of the equation, we can split the problem of ﬁnding its so-
lution into two parts. First we try to ﬁnd the general solution of the corresponding
homogeneous problem
L[y] = 0.
We have already seen how to solve this problem in Chapter 12; its general solution
will be a linear combination of two independent solutions y1(t) and y2(t),
y(t) = Ay1(t) + By2(t).
131

132
14 Inhomogeneous second order linear equations
This is called the complementary function, and will provide us with the two arbi-
trary constants that we require in our ﬁnal result.
The second part of solving the problem is to ﬁnd one particular function xp(t)
that satisﬁes the equation, i.e. for which
L[xp] = f (t).
The standard method for ﬁnding such a particular integral requires a mixture of
experience and inspired guesswork, but we will see later (Chapter 18) that there is
also a systematic way of solving this problem.
Given our complementary function y(t) and a particular integral xp(t), the gen-
eral solution of the original problem will be given by x(t) = y(t) + xp(t), since
L[y(t) + xp(t)] = L[y(t)] + L[xp(t)] = 0 + f (t) = f (t),
using the linearity of L. Since y(t) = Ay1(t) + By2(t), our solution
x(t) = Ay1(t) + By2(t) + xp(t)
contains the two arbitrary constants that we need in order to ﬁt any choice of initial
conditions.
There is nothing special about applying this technique to second order equations.
The essential point is the linearity, and it is possible to solve ﬁrst order equations
this way, as we now see in the following simple example.
Example 14.1 Use the technique of the complementary function and particular
integral to solve the ﬁrst order equation
dx
dt + px = q.
The ‘complementary function’ is the general solution of the homogeneous prob-
lem
˙y + py = 0,
which is y(t) = Ae−pt. A particular integral is any solution xp(t) that solves
˙xp + pxp = q;
one such solution is xp(t) = q/p. So the general solution is given by the comple-
mentary function plus the particular integral,
x(t) = Ae−pt + q
p
as we found before in (9.5).
□

14.2 When f (t) is a polynomial
133
We now look at certain choices of right-hand side f (t) for which we can ﬁnd a
‘particular integral’ for
a d2x
dt2 + bdx
dt + cx = f (t),
(14.2)
i.e. one particular solution xp(t) that when plugged into the left-hand side of (14.2)
gives the correct function f (t) on the right-hand side.
We can do this when f (t) is a combination of powers of t, exponentials (like
ekt), and sines and cosines. Essentially we try a solution x(t) that looks very much
like the original f (t), with some adjustments when f (t) is a part of the comple-
mentary function. This is known as the ‘method of undetermined coefﬁcients’;
essentially we guess the form of the solution, and include some coefﬁcients in our
guess, which are then determined by substituting into the equation.
14.2 When f (t) is a polynomial
When f (t) is a polynomial in t then our ‘guess’ for the particular integral xp(t) is
a general polynomial of the same order as f , i.e. if the highest power in f (t) is tn
then our guess is
xp(t) = cntn + cn−1tn−1 + · · · + c0.
However, we will see that if x(t) = c satisﬁes the homogeneous equation then we
have to multiply our guess by t. These ideas are most clearly illustrated by ﬁnding
the particular integral for a number of examples.
Example 14.2 Find the general solution of the equation
¨x + ˙x −6x = 12.
We have already found the complementary function, i.e. the solution of
¨y + ˙y −6y = 0,
which was y(t) = Ae2t + Be−3t, see (12.3). Since the right-hand side is a con-
stant, we try xp(t) = C. All the derivative terms in the differential equation vanish
and we are left with
−6C = 12,
so we need C = −2: the particular integral is xp(t) = −2. The general solution is
made up of the complementary function plus the particular integral,
x(t) = Ae2t + Be−3t −2.

134
14 Inhomogeneous second order linear equations
Example 14.3 Find the general solution of the equation
¨x + ˙x −6x = 36t.
In line with our policy above we try xp(t) = Ct + D for a particular integral.
(Note that if we were to try xp(t) = Ct without the constant term then although
we can choose C to give 36t (C = −6) the ˙xp term would give an extra factor
of −6.) Then we have ˙xp = C, and so we require
C −6(Ct + D) = 36t,
which gives C = −6 and D = −1. So the particular integral is xp(t) = −6t −1
and the general solution is
Ae2t + Be−3t −6t −1.
Example 14.4 Find the general solution of
¨x + ˙x −6x = 216t3
For the particular integral we have to try xp(t) = Ct3 + Dt2 + Et + F. Then
˙xp = 3Ct2 + 2Dt + E
and
¨xp = 6Ct + 2D,
and so we need
6Ct + 2D



¨xp
+ 3Ct2 + 2Dt + E



˙xp
−6(Ct3 + Dt2 + Et + F



xp
) = 216t3,
i.e.
−6Ct3 + (3C −6D)t2 + (6C + 2D −6E)t + (2D + E −6F) = 216t3.
We want
−6C = 216,
3C −6D = 0,
6C + 2D −6E = 0, and 2D + E −6F = 0,
which yields C = −36, D = −18, E = −42, F = −13, and the particular integral
is
xp(t) = −36t3 −18t2 −42t −13.
Thus the general solution is
x(t) = Ae2t + Be−3t −36t3 −18t2 −42t −13.
We now see that there is a possible catch with this technique.
Example 14.5 Find the general solution of
¨x −2˙x = 4.

14.3 When f (t) is an exponential
135
We saw earlier, in (12.4), that the complementary function is A + Be2t. If we try
xp(t) = C for our particular integral then ¨xp −2˙xp will be zero, since we have a
constant as part of the complementary function. To deal with this we multiply our
‘guess’ by an extra factor of t, as we did to obtain the second independent solution
of the homogeneous equation when the auxiliary equation had a repeated root.
Thus instead of xp(t) = C we try xp(t) = Ct and then we have ˙xp = C and
¨xp = 0, therefore we want
−2C = 4
which gives a particular integral when xp(t) = −2t, and so the general solution is
x(t) = A + Be2t −2t.
Example 14.6 Find the general solution of the equation
¨x = 4.
This is an extreme example, and it would be easy to solve by integrating twice.
However, we can also apply our general method for linear equations with constant
coefﬁcients. The general solution of the homogeneous equation ¨y = 0 is y(t) =
At + B (there is a repeated root k = 0 of the auxiliary equation), so we cannot
try xp(t) = C, and nor can we try xp(t) = Ct; we have to try xp(t) = Ct2 in this
case. Since ¨xp = 2C we need C = 4/2 = 2 and the particular integral is 2t2. The
general solution is therefore x(t) = 2t2 + At + B.
□
14.3 When f (t) is an exponential
The second kind of right-hand side for which we can ﬁnd a particular integral is
an exponential, f (t) = cekt. Essentially we try a multiple of the same exponential
for our particular integral, xp(t) = Cekt. However, if the exponential ekt on the
right-hand side is a solution of the homogeneous equation then Cekt cannot be
a particular integral, since substituting this into the left-hand side will just give
zero (L[Cekt] = 0). So in this case we need to try t times the exponential, xp(t) =
Ctekt. In the extreme case when k is a repeated real root of the auxiliary equation
we have to try xp(t) = Ct2ekt.
We look at the simplest case ﬁrst.
Example 14.7 Find the general solution of
¨x + ˙x −6x = 4e−2t.

136
14 Inhomogeneous second order linear equations
We saw above (in Example 12.1) that the complementary function, i.e. the
general solution of the homogeneous equation ¨y + ˙y −6y = 0, is y(t) = Ae2t
+ Be−3t, and so e−2t is not a solution of the homogeneous problem. This means
that we can try xp(t) = Ce−2t as a particular integral. Because
˙xp = −2Ce−2t
and
¨xp = 4Ce−2t
we need
4C −2C −6C = 4,
i.e. C = −1, so the particular integral is
xp(t) = −e−2t
and the general solution is
x(t) = Ae2t + Be−3t −e−2t.
Example 14.8 Find the general solution of
¨x + ˙x −6x = 5e−3t.
(14.3)
The complementary function is the same as in the previous example, y(t) =
Ae2t + Be−3t. Because e−3t is a solution of the homogeneous equation we have
to try xp(t) = Cte−3t for a particular integral for this example. With this guess for
xp(t) we have
˙xp = Ce−3t + −3Cte−3t
and
¨xp = −6Ce3t + 9Cte3t,
and so we need
−6Ce−3t + 9Cte−3t + Ce−3t −3Cte−3t −6Cte−3t = 5e−3t.
The te−3t terms cancel, and so we want C = −1. The particular integral turns out
to be
xp(t) = −te−3t
giving the general solution
x(t) = Ae2t + Be−3t −te−3t.
Example 14.9 Find the general solution of
¨x + 2˙x + x = 6e−t.
The complementary function y(t) is the solution of
¨y + 2 ˙y + y = 0.

14.4 When f (t) is a sine or cosine
137
Trying y(t) = ekt yields the auxiliary equation k2 + 2k + 1 = 0, and so k = −1
‘twice’. It follows that y(t) = Ae−t + Bte−t, which means that both our ‘stan-
dard guess’ xp(t) = Ce−t and our adjusted guess xp(t) = Cte−t solve the homo-
geneous equation. Because of this we have to try xp(t) = Ct2e−t; once again we
deal with the problem by including an extra factor of t. We have
˙xp = 2Cte−t −Ct2e−t
and
¨xp = 2Ce−t −4Cte−t + Ct2e−t.
Substituting into the left-hand side we get
[2Ce−t −4Cte−t + Ct2e−t] + 2[2Cte−t −Ct2e−t] +
−t = 2Ce
.
So we need C = 3; the particular integral is xp(t) = 3t2e−t and the general solu-
tion is
x(t) = (3t2 + At + B)e−t.
14.4 When f (t) is a sine or cosine
If f (t) = α sin σt + β cos σt (including the cases α = 0 or β = 0) then we need
to try a combination of sin σt and cos σt for the particular integral,
xp(t) = C sin σt + D cos σt.
(14.4)
Note that we need a combination of sine and cosine even if f (t) only involves
one of these two functions, since trying xp(t) = C sin σt means that ˙xp(t) =
Cσ cos σt. If sin σt and cos σt satisfy the homogeneous equation then instead we
need to try
xp(t) = Ct sin σt + Dt cos σt
(14.5)
with an extra factor of t.
Example 14.10 Find the general solution of
¨x + 2˙x + x = 100 cos 2t.
We found the complementary function y(t) = (A + Bt)e−t in Example 14.9.
Since sin 2t is not a part of the complementary function, we can try
xp(t) = C sin 2t + D cos 2t
as a potential particular integral, cf. (14.4). Then
˙xp(t) = 2C cos 2t −2D sin 2t
and
¨xp(t) = −4C sin 2t −4D cos 2t,
Ct2e
−t

138
14 Inhomogeneous second order linear equations
and so
¨xp + 2˙xp + xp = (4C −3D) cos 2t −(3C + 4D) sin 2t.
Therefore we need
4C −3D = 100
and
3C + 4D = 0,
which gives C = 16 and D = −12. Thus the particular integral is
xp(t) = 16 sin 2t −12 cos 2t
and the general solution is
x(t) = (A + Bt)e−t + 16 sin 2t −12 cos 2t.
Example 14.11 Find the general solution of
¨x + x = 8 cos t.
(14.6)
This example is not quite so simple, since sin t and cos t are the solutions of the
homogeneous problem (the complementary function is A sin t + B cos t). Using
the same remedy as that for Example 14.5, namely multiplying our original guess
by t, we now try a combination of t sin t and t cos t,
xp(t) = Ct sin t + Dt cos t,
cf. (14.5). Then we have
˙xp(t) = C sin t + Ct cos t + D cos t −Dt sin t
¨xp(t) = 2C cos t −Ct sin t −2D sin t −Dt cos t,
so that
¨xp + xp = 2C cos t −2D sin t.
We need C = 8/2 = 4 and D = 0, giving the particular integral
xp(t) = 4t sin t.
The general solution is therefore
x(t) = A sin t + B cos t + 4t sin t.
Note that although the complementary function has a ﬁxed amplitude, the ampli-
tude of the oscillations produced by having the 4t sin t term on the right-hand side
grows linearly in t. This is the phenomenon of resonance, and is discussed in more
detail in the next chapter.
□

14.6 More complicated functions f (t)
139
14.5 Rule of thumb
As a rule of thumb for ﬁnding particular integrals for second order equations:
r The ‘standard guess’ is a general version of what you are aiming for, e.g. given an nth
order polynomial on the right-hand side, try a general nth order polynomial; but
r If the standard guess contains terms that satisfy the homogeneous equation, multiply by
t, repeating this step until the guess no longer contains any terms that solve the homoge-
neous equation.
14.6 More complicated functions f (t)
Similar methods will also work for more complicated choices of f (t) that are
products and sums of those that we have already considered. To ﬁnd a particular
integral xp(t) for the equation
L[x] = αf1(t) + β f2(t)
(14.7)
(from the deﬁnition of L this is simply a ¨x + b ˙x + cx = αf1(t) + β f2(t)) we can
use the linearity of L to reduce this to ﬁnding particular integrals x1 and x2 satis-
fying
L[x1] = f1(t)
and
L[x2] = f2(t).
A particular integral for (14.7) is then xp(t) = αx1(t) + βx2(t), since
L[xp] = L[αx1 + βx2] = αL[x1] + βL[x2] = αf1(t) + β f2(t).
We can also ﬁnd particular integrals for products; to do this we can try the
product of the guesses for each individual factor. For example, to ﬁnd a particular
integral for
¨x + ˙x −6x = te−t cos 2t
we would try
xp(t) = (At + B)Ce−t(D cos 2t + E sin 2t).
Multiplying this out and simplifying the arbitrary constants, we try a particular
integral in the form
xp(t) = (At + B)e−t cos 2t + (Ct + D)e−t sin 2t.
For this choice of xp(t),
˙xp(t) = ((−A + 2C)t + (A −B + 2D))e−t cos 2t
+((−2A −C)t + (−2B + C −D))e−t sin 2t

140
14 Inhomogeneous second order linear equations
and
¨xp(t) = ((−3A −4C)t + (−2A −3B + 4C −4D))e−t cos 2t
+((4A −3C)t + (−4A + 4B −2C −3D))e−t sin 2t
Substituting in gives
¨xp + ˙xp −6xp = ((−10A −2C)t + (−A −10B + 4C −2D))e−t cos 2t
+((2A −10C)t + (−4A + 2B −C −10D))e−t sin 2t
Solving for A, B, C and D to ensure that this equals te−t cos 2t gives
xp(t) = (−8 −130t)e−t cos 2t + (53 −26t)e−t sin 2t
1352
.
Exercises
14.1 Find the general solution to the following differential equations (the homogeneous
parts of the equations are all treated in Exercise 12.1) In part (n) also ﬁnd the one
solution that has x(0) = n and ˙x(0) = 0.
(i) ¨x −4x = t2,
(ii) ¨x −4˙x = t2,
(iii) ¨x + ˙x −2x = 3e−t,
(iv) ¨x + ˙x −2x = et,
(v) ¨x + 2˙x + x = e−t,
(vi) for α ̸= ω: ¨x + ω2x = sin αt,
(vii) for α = ω: ¨x + ω2x = sin αt,
(viii) ¨x + 2˙x + 10x = e−t,
(ix) ¨x + 2˙x + 10x = e−t cos 3t,
(x) ¨x + 6˙x + 10x = e−3t cos t, and
(xi) ¨x + 4˙x + 4x = e2t.
14.2 Find a particular integral for
¨x + ˙x −2x = 12e−t −6et.
(You might ﬁnd parts (iii) and (iv) of the previous exercise useful.)
14.3 If you are feeling strong, ﬁnd a particular integral for
¨x + 4x = 289tet sin 2t.

15
Resonance
We now consider in more detail the resonance phenomenon mentioned brieﬂy in
the previous chapter while we were dealing with Example 14.11.
15.1 Periodic forcing
Suppose that x(t) denotes the distance of some system from its equilibrium posi-
tion, and that without any external forcing the system would oscillate about this
position, with x(t) satisfying
¨x = −ω2x.
(15.1)
We know from Chapter 13 that this equation has the general solution
x(t) = A cos ωt + B cos ωt ≡M cos(ωt −φ),
(15.2)
where in the more compact form M =
√
A2 + B2 and φ = tan−1(B/A). We refer
to 2/ω as the ‘natural frequency’ of the system; it is how the system ‘likes’ to
oscillate if left to itself.
We now consider what happens if we apply an external forcing to the system
that is also oscillating,
¨x + ω2x = a cos αt.
(15.3)
Note that the forcing function on the right-hand side has amplitude a and oscillates
with frequency 2/α, cf. Figure 9.1.
Such equations arise in many physical situations, and we now provide a physi-
cal motivation by considering a simple model of the spinning drum of a washing
machine. We suppose that the cylindrical drum has mass M, and that it is loaded
unevenly with clothes of mass m, such that the centre of mass of the clothes lies
a distance r from the axle. In order to control the oscillations of the drum, it
141

142
15 Resonance
mass M
mass m
x
rest position
θ
 r
Fig. 15.1. A simple-minded model of a washing machine.
rotates within another cylinder that is attached to the sides of the housing with
large springs, each with spring constant k/2, see Figure 15.1.
For simplicity we will assume that the drum can only move from side-to-side,
and we denote by x the horizontal displacement of the axle from its rest position.
The horizontal coordinate of the centre of mass of the drum and clothes is given
by
X = mr cos θ + Mx
m + M
.
Assuming that the drum spins with constant angular velocity ˙θ = α, so that θ(t) =
αt, this gives
X(t) = mr cos αt + Mx
m + M
.
The springs provide a restoring force of magnitude kx for some constant k, and so
Newton’s second law,
(M + m)d2X
dt2 = −kx,
gives
(M + m)
−mrα2 cos αt + M ¨x
m + M

= −kx.
Simplifying this equation we obtain
M ¨x + kx = mrα2 cos αt.

15.1 Periodic forcing
143
With no load (m = 0) or with a perfectly balanced load (r = 0) the displacement
from the rest position satisﬁes
¨x + ω2x = 0,
where we have deﬁned ω2 = k/M. With the off-centred load the equation is
¨x + ω2x = a cos αt,
precisely (15.3), where the forcing term on the right-hand side has amplitude a =
mrα2/M.
15.1.1 No resonance: bounded response
First we consider what happens when the system is forced at a frequency that dif-
fers from its own natural frequency, i.e. when α ̸= ω. The complementary function
(given in (15.2)) is y(t) = A cos ωt + B sin ωt, and so we can try xp(t) = C cos αt
for the particular integral (there is no need for the sin αt term since there is no ˙x in
the equation). Substituting in we get
−Cα2 cos αt + ω2C cos αt = a cos αt,
and so we want
C =
a
ω2 −α2 .
The general solution is therefore
x(t) = M cos(ωt −φ) +
a
ω2 −α2 cos αt,
(15.4)
and we can see that the motion of x(t) combines oscillations at two frequencies: its
‘natural frequency’ ω, and the forcing frequency α. However, notice that as α gets
closer to ω, the amplitude of the second term increases (although it is bounded for
each ﬁxed choice of α).
15.1.2 ‘Ideal’ resonance: unbounded response
When α = ω our usual ‘guess’ (xp(t) = C sin ωt + D cos ωt) solves the homoge-
neous equation, and therefore we now have to try xp(t) = Ct sin ωt + Dt cos ωt
as the particular integral. For this we have
˙xp = C sin ωt + Cωt cos ωt + D cos ωt −Dω sin ωt

144
15 Resonance
0
2
4
6
8
10
12
14
16
18
20
−20
−15
−10
−5
0
5
10
15
20
t
x
Fig. 15.2. A graph of the function x(t) = t sin 2t. The amplitude of the response
to a forcing at an object’s natural frequency grows linearly in time.
and so
¨xp = 2Cω cos ωt −2Dω sin ωt −ω2[Ct sin ωt + Dt cos ωt].
Therefore
¨xp + ω2xp = 2Cω cos ωt −2Dω sin ωt;
since we require the right-hand side to equal a cos ωt, for our particular integral
we need
xp(t) = a
2ωt sin ωt.
You can see from a graph of xp(t) in Figure 15.2 that the amplitude of the result-
ing oscillations grows linearly. After a time this will, of course, become the main
component of the solution
x(t) = C sin ωt + D cos ωt + a
2ωt sin ωt,
since the ﬁrst two terms represent an oscillation of ﬁxed amplitude.
Forcing a structure at its natural frequency can have disastrous consequences;
on 14 April 1831, the Broughton suspension bridge over the River Irwell collapsed
when the 60th riﬂe corps marched over it in step, thereby forcing it at one of its
natural frequencies. Figure 15.3 shows the report from The Times published on
15 April 1831. Armies on the march now break step over bridges to prevent this
occurring (see Figure 15.4).

15.2 Pseudo resonance in physical systems
145
Fig. 15.3. The Times, 15 April 1831 ‘FALL OF BROUGHTON SUSPENSION-BRIDGE’.
15.2 Pseudo resonance in physical systems
There is almost invariably some damping in physical systems, and when there is
damping you will not see this ‘ideal’ resonance (meaning linear growth of the
amplitude). However, there will still be a frequency at which the amplitude of the
resulting oscillations is signiﬁcantly larger than the amplitude of the forcing.
We will consider the equation
¨x + λ˙x + ω2x = a cos αt
where the damping coefﬁcient λ is strictly positive but not too large (we will soon
be precise about what is ‘not too large’). In Chapter 13 we discussed the homo-
geneous equation ( ¨y + λ ˙y + ω2y = 0) in detail, and for λ2 < 4ω2 we found the
complementary function
y(t) = e−λt/2(A cos σt + B sin σt),
where σ = 1
2
√
4ω2 −λ2. Since λ > 0 this oscillates and decays to zero exponen-
tially (in the language of Chapter 13 the system is ‘under-damped’).

146
15 Resonance
Fig. 15.4. A sign on the Albert Bridge in London, instructing troops to break step
to prevent destructive resonance effects. (Courtesy of the National Information
Service for Earthquake Engineering, University of California, Berkeley.)
The particular integral will be some combination of sin αt and cos αt (these are
not part of the complementary function),
xp(t) = C sin αt + D cos αt.
Substituting this guess into the equation, we want
−Cα2 sin αt −Dα2 cos αt + λ[Cα cos αt −Dα sin αt] +
ω2[C sin αt + D cos αt] = a cos αt.
Collecting coefﬁcients of sin αt gives
C(ω2 −α2) = Dλα,
while by equating the coefﬁcients of cos αt we obtain
D(ω2 −α2) = a −Cλα.
Solving these simultaneous equations gives
C =
aλα
(ω2 −α2)2 + (λα)2
and
D =
a(ω2 −α2)
(ω2 −α2)2 + (λα)2 ,

15.2 Pseudo resonance in physical systems
147
and so the particular integral is
xp(t) =
aλα
(ω2 −α2)2 + (λα)2 sin αt +
a(ω2 −α2)
(ω2 −α2)2 + (λα)2 cos αt.
(15.5)
We have already seen (in Section 9.4.3) that we can combine the two terms in
an expression like A cos αt + B sin αt to give one oscillating term; in particular
the amplitude of the resulting oscillation is given by the square root of the sum of
the squares of the two coefﬁcients,
√
A2 + B2. So the amplitude of the oscillations
that arise in response to the forcing a cos αt is
R(α) = a

(λα)2 + (ω2 −α2)2
[(ω2 −α2)2 + (λα)2]2
=
a

(ω2 −α2)2 + (λα)2 .
The ratio of the amplitude of the response to that of the forcing is therefore
F(α) =
1

(ω2 −α2)2 + (λα)2 ,
(15.6)
which depends on the frequency 2/α of the forcing. Graphs of F(α) for various
values of λ when ω = 1 are shown in Figure 15.5. Note that the maximum value
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
2
4
6
8
10
12
14
16
18
20
α
F(α)
Fig. 15.5. Pseudo resonance when ω = 1: graphs of F(α) for λ = 1, 1/2, 1/4,
1/8, 1/16 and 0, increasing as λ decreases.

148
15 Resonance
of F(α) occurs near α = 1 (i.e. where α = ω), and increases as the damping level
λ decreases.
The maximum value of the response occurs when the denominator in F(α) is a
minimum, so when
d
dα[(ω2 −α2)2 + (λα)2] = 0,
i.e. when
−4α(ω2 −α2) + 2λ2α = 0,
which gives α2 = ω2 −(1/2)λ2. It is therefore clear that as the damping becomes
ever smaller the value of α for which the response is maximum becomes increas-
ingly close to α = ω.
The maximum value of the amplitude is
Rmax(λ) =
2a
λ
√
4ω2 −λ2 ,
and of course increases in magnitude as λ decreases. As λ →0, Rmax ∼a(λω)−1.
Exercises
15.1 For α ̸= ω show that the solution of the equation
¨x + ω2x = cos αt
(E15.1)
with x(0) = ˙x(0) = 0 is
x(t) =
1
ω2 −α2 (cos αt −cos ωt).
(E15.2)
15.2 Use the double angle formulae
cos(θ ± φ) = cos θ cos φ ∓sin θ sin φ
to ﬁnd an expression for cos x −cos y as a product of two sine functions, and hence
rewrite the solution in (E15.2) as
2
ω2 −α2 sin (ω + α)t
2
sin (ω −α)t
2
.
If α is close to ω then |α + ω| is much larger than ω −α; one of the two terms
oscillates much faster than the other. A graph of such an expression when ω = 1 and
α = 0.8 is shown in Figure 15.6. The periodic variation of the amplitude of the basic
oscillation is known as beating. You can hear this when, for example, two ﬂutes play
slightly out of tune with each other.
15.3 When α = ω show that the solution of (E15.1) with x(0) = ˙x(0) = 0 is x(t) =
t sin ωt/2ω. Recover this solution from that for α ̸= ω by letting α →ω in (E15.2)
and using L’Hˆopital’s rule.

Exercises
149
0
50
100
150
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Fig. 15.6. The phenomenon of beats: the graph of sin 0.9t sin 0.1t against t (the
dashed line shows how the amplitude of the faster oscillation varies like sin 0.1t).
L’Hˆopital’s rule: if f (x) →0 as x →a, and g(x) →0 as x →a then
lim
x→a
f (x)
g(x) = lim
x→a
f ′(x)
g′(x) = f ′(a)
g′(a)
(provided that f and g have continuous derivatives at x = a).
15.4 A model for the vibrations of a wine glass is
¨x + λ˙x + ω2x = 0,
where λ and ω are constants. Suppose that when struck the glass vibrates at 660 Hz
(about the second E above middle C on a piano). Show that

4ω2 −λ2 = 2640.
If it takes about 3 seconds for the sound to die away, and this happens when the
original vibrations have reduced to 1/100 of their initial level, show that
λ = 2 log 100
3
,
and hence that λ = 3.07 and ω = 4.15 × 103 (both to three signiﬁcant ﬁgures).
The glass can stand deforming only to x ≈1. A pure tone at 660 Hz is produced
at D decibels and aimed at the glass, forcing it at its natural frequency, so that the
vibrations are now modelled by
¨x + λ˙x + ω2x = 10(D/10)−8
3
cos(1320)t.
(E15.3)
How loud should the sound be, i.e. how large should D be, in order to shatter the
glass? (Decibels are on a logarithmic scale, hence the exponential on the right-hand
side of (E15.3). The strange factor in front of the forcing produces roughly the correct
volume level.)

16
Higher order linear equations with constant coefﬁcients
The methods that we have developed to treat second order linear equations extend
in a straightforward manner to treat higher order linear equations.
A general nth order linear ODE with constant coefﬁcients can be written in the
form
an
dnx
dtn + an−1
dn−1x
dtn−1 + · · · + a1
dx
dt + a0x = f (t),
(16.1)
where we assume that an ̸= 0, cf. (3.5).
The initial value problem in which x(t) and its ﬁrst n −1 derivatives are speci-
ﬁed has a unique solution.
Theorem 16.1 Given an initial condition
x(t0) = x0,
˙x(t0) = x1,
¨x(t0) = x2,
. . . ,
dn−1x
dtn−1 (t0) = xn−1
(16.2)
the linear equation (16.1) has a unique solution deﬁned for all t ∈R.
Note that in the statement of the theorem it is claimed that the solution exists for
all t ∈R. This is because for such a linear equation it is possible to guarantee that
the solution does not blow up in ﬁnite time (cf. Section 6.3 and Exercise 12.3).
16.1 Complementary function and particular integral
In order to ﬁnd an explicit solution of an nth order linear problem we proceed as
we did for second order problems. The only signiﬁcant difference is that now we
need n linearly independent solutions of the homogeneous equation in order to
be able to satisfy the n initial conditions in (16.2). See Deﬁnition 11.2 for linear
independence, and also Section 16.2.
150

16.1 Complementary function and particular integral
151
First we ﬁnd the complementary function by solving the homogeneous equation
an
dny
dtn + an−1
dn−1y
dtn−1 + · · · + a0y = 0;
we try y(t) = ekt. This will give an nth order algebraic equation for k,
ankn + an−1kn−1 + · · · + a0 = 0.
For n ≤4 there are methods for ﬁnding the roots of such equations,1 although for
higher order equations we would have to use numerical methods.
For each non-repeated real root k of the equation we have a solution ekt; for a
real root k that is repeated m times we have m linearly independent solutions,
ekt,
tekt,
. . . ,
and
tm−1ekt;
for each non-repeated complex conjugate pair ρ ± iω we have the two solutions
eρt sin ωt and eρt cos ωt, while for a complex conjugate pair ρ ± iω that is repeated
m times we would have the 2m solutions
eρt cos ωt, eρt sin ωt,
teρt cos ωt,
teρt sin ωt,
. . . ,
tm−1eρt cos ωt,
tm−1eρt sin ωt.
Finding a particular integral involves the same style ‘guesswork’ as in the sec-
ond order case.
Example 16.2 Find the general solution of
d4x
dt4 −16x = 64 sin 2t.
1 For a general cubic equation
x3 −bx2 + cx −d = 0
ﬁrst substitute x = y + b/3 which gives
x3 + mx = n
with
m = c −b2/3
and
n = d −bc/3 + 2b3/27.
Tartaglia developed a method of solution for this form of cubic (ﬁrst published by Cardan in 1545); notice that
(a −b)3 + 3ab(a −b) = a3 −b3
and so if a and b satisfy
3ab = m
and
a3 −b3 = n
then a −b solves x3 + mx = n. Since b = m/3a the second of these equations is
a3 −m3
27a3 = n
which gives a6 −na3 −m3/27 = 0, a quadratic equation for a3. We can ﬁnd the roots of this equation using
the quadratic formula, from which we get a by taking cube roots. The value of b is given by b = m/3a, and
then a −b is a solution of the original equation.

152
16 Higher order linear equations
To ﬁnd the complementary function, i.e. the general solution of
d4y
dt4 −16y = 0,
we try y(t) = ekt, and so we need k4 = 16. The solutions of this are k = ±2 and
k = ±2i, and so the complementary function is
y(t) = Ae2t + Be−2t + C cos 2t + D sin 2t.
To ﬁnd a particular integral we cannot try a combination of sin 2t and cos 2t since
they solve the homogeneous equation, so we have to try a combination of t sin 2t
and t cos 2t. If
xp(t) = Et sin 2t + Ft cos 2t
then after some algebra
d4xp
dt4 = E[16t sin 2t −32 cos 2t] + F[32 sin 2t + 16t cos 2t],
and so substituting in we want
−32E cos 2t + 32F sin 2t = 64 sin 2t,
i.e. E = 0 and F = 2, giving a particular integral xp(t) = 2t cos 2t and hence the
general solution
x(t) = Ae2t + Be−2t + (C + 2t) cos 2t + D sin 2t.
16.2 *The general theory for nth order equations
In Chapter 11 we developed a general theory for second order linear homogeneous
equations
d2x
dt2 + p1(t)dx
dt + p2(t)x = 0,
(16.3)
showing that given two linearly independent solutions x1(t) and x2(t) of this equa-
tion we can form the general solution as a linear combination
c1x1(t) + c2x2(t).
Realising that the collection of all solutions of (16.3) is the same as the kernel of
the linear operator L : C2(I) →C0(I) deﬁned by
L[x] = ¨x + p1(t)˙x + p2(t)x,
we could re-express our results as ‘dim ker(L) = 2’.

Exercises
153
It is possible to generalise the results of Chapter 11 to treat the linear nth order
equation
dnx
dtn + p1(t)dn−1x
dtn−1 + · · · + pn−1(t)dx
dt + pn(t)x = 0;
(16.4)
in particular, similar arguments show that the general solution of (16.4) can
be formed from linear combinations of any n linearly independent solutions
x1(t), . . . , xn(t) of (16.4),
x(t) = c1x1(t) + · · · + cnxn(t).
Denoting by Cn(I) the collection of all functions deﬁned on n which have n con-
tinuous derivatives, we can deﬁne a linear operator L : Cn(I) →C0(I) by
L[x] = dnx
dtn + p1(t)dn−1x
dtn−1 + · · · + pn−1(t)dx
dt + pn(t)x
(we now need x ∈Cn(I) to make sure that the term dnx/dtn is sensible). We can
then express these results by saying that ‘dim ker(L) = n’.
Checking whether two functions are linearly independent is straightforward,
since we saw that they are linearly independent if and only if they are not pro-
portional. When there are three or more functions involved we have to make
more systematic use of the Wronskian, which we discussed only in passing in
Chapter 11. Given n functions f1(t), . . . , fn(t), we deﬁne their Wronskian to be
the matrix determinant
W[ f1, . . . , fn](t) =

f1(t)
. . .
fn(t)
...
...
...
dn−1 f1/dtn−1(t)
. . .
dn−1 fn/dtn−1(t)

.
Note that for n = 2 this reduces to W[ f1, f2](t) = f1 ˙f2 −f2 ˙f1, as used in
Chapter 11. As for the case of two functions, it is possible to show that n solu-
tions of the linear equation (16.4) are linearly independent on an interval I if and
only if their Wronskian is never zero on I. Exercises 16.2–16.4 lead you through
some of this theory in the case of three functions f1, f2 and f3.
Exercises
16.1 Find the general solution of the following equations:
(i)
d3x
dt3 −6d2x
dt2 + 11dx
dt −6x = e−t,

154
16 Higher order linear equations
(ii)
y′′′ −3y′ + 2 = sin x,
(iii)
d4x
dt4 −4d3x
dt3 + 8d2x
dt2 −8dx
dt + 4x = sin t
(if x = ekt one solution of the corresponding quartic equation is k = 1 + i), and
(iv)
d4x
dt4 −5d2x
dt2 + 4x = et.
16.2 The linear independence of three functions f1, f2 and f3 on an interval I depends on
the number of solutions of the equation
α1 f1(t) + α2 f2(t) + α3 f3(t) = 0
for all
t ∈I.
By differentiating this equation once, and then once more, show that α1, α2 and α3
satisfy the matrix equation
⎛
⎝
f1
f2
f3
d f1/dt
d f2/dt
d f3/dt
d2 f1/dt2
d2 f2/dt2
d2 f3/dt2
⎞
⎠
⎛
⎝
α1
α2
α3
⎞
⎠=
⎛
⎝
0
0
0
⎞
⎠.
Deduce that if W[ f1, f2, f3](t), the Wronskian of f1, f2 and f3, deﬁned as
W[ f1, f2, f3](t) =

f1
f2
f3
d f1/dt
d f2/dt
d f3/dt
d2 f1/dt2
d2 f2/dt2
d2 f3/dt2

,
is non-zero for any t ∈I then f1, f2 and f3 are linearly independent.
16.3 Show that any three solutions of a third order linear differential equation are linearly
independent on an interval I if and only if their Wronskian is non-zero on I.
16.4 Suppose that x1, x2 and x3 are three solutions of the third order linear equation
d3x
dt3 + p(t)d2x
dt2 + q(t)dx
dt + r(t)x = 0,
(E16.1)
all deﬁned on some interval I.
We now show that, just as for two solutions of a second order linear equation,
dW
dt = −p(t)W
(E16.2)
(cf. Exercise 11.2). You will need various properties of determinants, which you can
prove by longhand (if you wish) in the next exercise.

Exercises
155
(i) By differentiating the determinant form of the Wronskian, show that
˙W =

x1
x2
x3
˙x1
˙x2
˙x3
d3x1/dt3 d3x2/dt3 d3x3/dt3

.
(You will need parts (i) and (ii) of the next exercise.)
(ii) Substitute in for d3x j/dt3 using the differential equation (E16.1), and hence
show that
˙W = −p(t)

x1
x2
x3
˙x1
˙x2
˙x3
¨x1
¨x2
¨x3

,
i.e. that (E16.2) holds. (You will need parts (ii) and (iii) of the next exercise.)
(iii) Solve equation (E16.2) to ﬁnd an expression for W(t) involving an integral, and
deduce that either W(t) = 0 for all t ∈I, or that W(t) ̸= 0 for all t ∈I.
16.5 For the previous question you will need the following properties of determinants: you
should be able to prove them in the 3 × 3 case treated here by simple (if laborious)
calculation, using the explicit expression for the determinant of a 3 × 3 matrix

a
b
c
r
s
t
x
y
z

= a(sz −ty) −b(rz −tx) + c(ry −sx).
(i)
d
dt

a
b
c
r
s
t
x
y
z

=

˙a
˙b
˙c
r
s
t
x
y
z

+

a
b
c
˙r
˙s
˙t
x
y
z

+

a
b
c
r
s
t
˙x
˙y
˙z

(i.e. differentiate one row at a time; this is essentially the product rule),
(ii) If any two rows are proportional then the determinant is zero. Check this for

a
b
c
λa
λb
λc
x
y
z

= 0,
(iii) Determinants depend linearly on their rows. Show this for the case

a
b
c
r
s
t
αx1 + βx2
αy1 + βy2
αz1 + βz2

= α

a
b
c
r
s
t
x1
y1
z1

+ β

a
b
c
r
s
t
x2
y2
z2

.


Part III
Linear second order equations with
variable coefﬁcients


17
Reduction of order
In Chapter 11 we discussed the general theory of second order linear equations. In
the intervening chapters we have concentrated on linear equations with constant
coefﬁcients, but we now return to the more general case in which the coefﬁcients
are allowed to be functions of t,
a(t)d2x
dt2 + b(t)dx
dt + c(t)x = 0.
(17.1)
We saw in Chapter 11 that in order fully to solve a second order homogeneous lin-
ear differential equation we need two linearly independent solutions. In this chap-
ter we show that if we happen to know, or can guess, one solution of an equation
like (17.1) then there is a systematic way to ﬁnd a second, linearly independent,
solution.
The method is called ‘reduction of order’, since it enables us to use our knowl-
edge of one solution to ﬁnd a ﬁrst order differential equation that we can use to
ﬁnd the second solution.
Suppose we know that u(t) solves the second order linear equation
a(t)d2x
dt2 + b(t)dx
dt + c(t)x = 0.
(17.2)
The idea is to make the substitution x(t) = u(t)y(t) and then solve the resulting
equation for y(t). From x(t) = u(t)y(t) it follows that
˙x = ˙uy + u ˙y
¨x = ¨uy + 2˙u ˙y + u ¨y,
and substituting these into the original equation gives
a(t)(¨uy + 2˙u ˙y + u ¨y) + b(t)(˙uy + u ˙y) + c(t)uy = 0.
159

160
17 Reduction of order
The terms in which the factor of y is not differentiated,
a(t)¨uy + b(t)˙uy + c(t)uy = y[a(t)¨u + b(t)˙u + c(t)],
add to give zero; the expression in square brackets vanishes since u is a solution.
So we are left with an equation for y(t),
a(t)(2˙u ˙y + u ¨y) + b(t)u ˙y = 0.
Note that although ¨y and ˙y occur in this equation, y itself does not. So we can
make a second substitution, putting z = ˙y to obtain a ﬁrst order equation for z(t),
[a(t)u(t)]˙z + [2a(t)˙u(t) + b(t)u(t)]z = 0.
(17.3)
Although this equation looks unpleasant, the coefﬁcients of ˙z and z are known
functions of t, since a(t) and b(t) are from the original problem and u(t) is the
solution that we already know. This ﬁrst order equation can now be solved using
the method of integrating factors.1
As with many of the techniques developed here, it is not helpful to try to remem-
ber the equation (17.3) and produce it from up your sleeve whenever you need to
use this idea. Instead you should understand the technique and be ready to apply it
to particular examples when it is needed.
Example 17.1 One solution of
¨x −2λ˙x + λ2x = 0
can be found by trying x(t) = ekt. The resulting quadratic equation has a repeated
root k = λ. Use the reduction of order method to show that there is a second lin-
early independent solution teλt.
To use the reduction of order method we substitute x(t) = y(t)eλt. We then have
˙x = λeλt y + eλt ˙y
and
¨x = λ2eλt y + 2λeλt ˙y + eλt ¨y,
so that
λ2eλt y + 2λeλt ˙y + eλt ¨y −2λ2eλt y + 2λeλt ˙y + λ2eλt y = 0.
After cancelling all the eλts this reads
λ2y + 2λ ˙y + ¨y −2λ2y −2λ ˙y + λ2y = 0,
and further cancellations leave just
¨y = 0.
1 It is possible to ﬁnd a general integral expression for the solution of this equation, see Exercise 17.7. However,
it is a much better idea to apply the method afresh in each particular case.

Reduction of order
161
Integrating this twice gives y(t) = A + Bt, and so
x(t) = Aeλt + Bteλt.
(17.4)
We obtain a constant multiple of our original solution (eλt) plus a constant multiple
of a new, second solution, teλt, as claimed.
□
Example 17.2 For t > 0 the function u(t) = 1/t is a solution of
t2 ¨x −2t ˙x −4x = 0.
(This is easy to check: ˙x = −t−2 and ¨x = 2t−3.) Find a second linearly indepen-
dent solution.
To apply the reduction of order method, we set x = y/t, and so
˙x = ˙y
t −y
t2
and
dx
dt = ¨y
t −2 ˙y
t2 + 2 y
t3 .
Substituting these into the equation gives
t2
 ¨y
t −2 ˙y
t2 + 2 y
t3

−2t
 ˙y
t −y
t2

−4 y
t = 0.
This simpliﬁes to give
t ¨y −4 ˙y = 0,
which setting z = ˙y gives the linear equation
˙z −4
t z = 0.
We can solve this using an integrating factor,
exp


−4
t dt

= exp(−4 ln t) = t−4.
So we have
d
dt (t−4z(t)) = 0.
Integrating this gives t−4z(t) = c, and so
z(t) = ct4.
Since z = ˙y, it follows that y(t) = at5 + b, giving (since x(t) = y(t)/t)
x(t) = at4 + b
t .

162
17 Reduction of order
The second term just repeats the solution we already knew, so the new linearly
independent solution is t4.
Exercises
For further examples of the reduction of order method see also Exercises 18.1 (vi), 18.1
(vii) and 20.3.
17.1 One solution of the equation
t2 ¨y −(t2 + 2t) ˙y + (t + 2)y = 0
is y(t) = t. Use the reduction of order method to ﬁnd a second solution, and hence
write down the general solution.
17.2 One solution of
(x −1)y′′ −xy′ + y = 0
that is valid for x > 1 is y(x) = ex. Find a second linearly independent solution z(x),
and check that the Wronskian of y(x) and z(x) is non-zero for x > 1.
17.3 One solution of
(t cos t −sin t)¨x + ˙xt sin t −x sin t = 0
is x(t) = t. Find a second linearly independent solution.
17.4 One solution of
(t −t2)¨x + (2 −t2)˙x + (2 −t)x = 0
is x(t) = e−t. Find a second linearly independent solution.
17.5 One solution of
y′′ −xy′ + y = 0
is y = x. Find a second linearly independent solution in the form of an integral.
Expanding the integrand in powers of x using the power series form for ex,
ex =
∞

n=0
xn
n! ,
and assuming that the resulting expression can be integrated term-by-term show that
this second solution can be written as
y(x) = A

−1 +
∞

n=1
x2n
2n(2n −1)n!
	
(cf. Exercise 20.2(i)).
17.6 One solution of
tan t d2x
dt2 −3dx
dt + (tan t + 3 cot t)x = 0
is x(t) = sin t. Find a second linearly independent solution.

Exercises
163
17.7 (T) If we know one solution u(t) of the equation
d2x
dt2 + p(t)dx
dt + q(t)x = 0
(E17.1)
then the reduction of order method with x(t) = u(t)y(t) leads to the ﬁrst order linear
equation
u(t)˙z + [2˙u(t) + p(t)u(t)]z = 0.
for z = ˙y (cf. (17.3)). Show that
z(t) = Ae−

p(t) dt
u(t)2
,
and hence ﬁnd the second linearly independent solution in the form of an integral.
17.8 (T) Suppose that the two solutions of a second order linear differential equation
(E17.1) are u(t) and v(t). Use the result of the previous exercise, to show that
d
dt
v(t)
u(t)

= Ae−

p(t) dt
u(t)2
,
and hence that
p(t) = −u ¨v −v ¨u
u ˙v −v ˙u .
Find the function q(t) such that u(t) is a solution of
d2x
dt2 −u ¨v −v ¨u
u ˙v −v ˙u
dx
dt + q(t)x = 0
(rearrange the equation for q(t), and substitute x(t) = u(t)) and hence show that the
second order linear differential equation with solutions u(t) and v(t) can be written
as
(u ˙v −v ˙u)d2x
dt2 −(u ¨v −v ¨u)dx
dt + (˙u ¨v −¨u ˙v)x = 0.
This produced Exercises 17.1–17.6 above.
17.9 Using the result of the previous exercise, ﬁnd a second order linear differential equa-
tion whose solutions are et and cos t. Check that both of these two functions satisfy
the resulting equation.

18
*The variation of constants formula
In the last chapter we saw that knowing one solution x1(t) of a homogeneous linear
second order equation
a(t)d2x
dt2 + b(t)dx
dt + c(t)x = 0
(18.1)
enables us to ﬁnd a second linearly independent solution x2(t). In this chapter we
see that if we know two linearly independent solutions of (18.1) then there is a
systematic way to ﬁnd a particular integral for the inhomogeneous problem
a(t)d2x
dt2 + b(t)dx
dt + c(t)x = f (t).
(18.2)
For simplicity we assume that a(t) ̸= 0, divide equation (18.2) by a(t), and
rewrite it as
d2x
dt2 + p(t)dx
dt + q(t)x = g(t).
Now suppose that we know two linearly independent solutions x1(t) and x2(t)
of the homogeneous linear problem
¨x + p(t)˙x + q(t)x = 0,
which means that its general solution is of the form
x(t) = Ax1(t) + Bx2(t).
(18.3)
We will look for a particular integral for the inhomogeneous problem
¨x + p(t)˙x + q(t)x = g(t)
(18.4)
in the form
x(t) = u1(t)x1(t) + u2(t)x2(t).
(18.5)
164

*The variation of constants formula
165
We have replaced the constants in (18.3) by functions of t; this is known as the
method of ‘variation of constants’. We will obtain a particular solution with u1
and u2 given in terms of integrals; in particular examples we may not be able to
compute these integrals explicitly.
Soon we will substitute this form for x(t) into equation (18.4), but ﬁrst notice
that this will only provide one equation that has to be satisﬁed by u1(t) and u2(t).
Since we have two unknown functions we need two equations to determine them
completely; we are therefore free to impose an additional condition of our choice,
and we make a choice below that simpliﬁes our calculations.
The ﬁrst thing to do is to compute the derivative of x(t),
˙x(t) = ˙u1(t)x1(t) + u1(t)˙x1(t) + ˙u2(t)x2(t) + u2(t)˙x2(t).
(18.6)
When we differentiate again we will get second derivatives of the us and the xs; to
get rid of the second derivatives of the functions u j (which are unknown) we use
our ‘extra equation’, imposing the condition that
˙u1(t)x1(t) + ˙u2(t)x2(t) = 0.
(18.7)
If this holds then
˙x(t) = u1(t)˙x1(t) + u2(t)˙x2(t),
and so
¨x = ˙u1 ˙x1 + u1 ¨x1 + ˙u2 ˙x2 + u2 ¨x2,
with no second derivatives of the unknown functions u1 and u2.
Substituting these derivatives into equation (18.4) gives
˙u1 ˙x1 + u1 ¨x1 + ˙u2 ˙x2 + u2 ¨x2 + p(t)[u1 ˙x1 + u2 ˙x2] + q(t)[u1x1 + u2x2] = g(t).
This looks unpleasant, but if we group the terms correctly,
u1[¨x1 + p(t)˙x1 + q(t)x1] + u2[¨x2 + p(t)˙x2 + q(t)x2] + ˙u1 ˙x1 + ˙u2 ˙x2 = g(t),
we can use the fact that x1 and x2 both solve the homogeneous equation to set both
terms in the square brackets to zero, and end up with
˙u1 ˙x1 + ˙u2 ˙x2 = g(t).
We now have two equations for ˙x1(t) and ˙x2(t),
 ˙u1x1 + ˙u2x2 = 0
˙u1 ˙x1 + ˙u2 ˙x2 = g(t).

166
18 *The variation of constants formula
We can solve these equations for ˙u1(t) and ˙u2(t) to give
˙u1(t) = −
x2(t)g(t)
x1(t)˙x2(t) −x2(t)˙x1(t)
and
˙u2(t) =
x1(t)g(t)
x1(t)˙x2(t) −x2(t)˙x1(t).
As a shorthand we will write
W(t) = x1(t)˙x2(t) −x2(t)˙x1(t)
for the denominator in these equations.1 Now to ﬁnd u1(t) and u2(t) we integrate,
and therefore obtain
x(t) = −x1(t)
 x2(t)g(t)
W(t)
dt + x2(t)
 x1(t)g(t)
W(t)
dt.
(18.8)
We will now do two examples, one for which we already know the particular
integral, and one for which we do not.
Example 18.1 Use the formula (18.8) to ﬁnd a particular integral for the equation
¨x + ˙x −6x = 5e−3t
(this was Example 14.8).
Note that generally it is not a good idea to try to remember the formula (18.8).
It is much better to apply the method itself, which will lead naturally to the same
expression, and we will do this in the next example.
Two linearly independent solutions of the homogeneous equation are x1(t) =
e−3t and x2(t) = e2t (we found these in Chapter 12), for which
W(t) = x1(t)˙x2(t) −x2(t)˙x1(t) = 2e−3te2t −−3e2te−3t = 5e−t.
(Note that W(t) is never zero.) The formula (18.8) gives
x(t) = −e−3t
 5e2te−3t
5e−t
dt + e2t
 5e−3te−3t
5e−t
dt,
= −e−3t

1 dt + 5e2t

e−5t dt
= −te−3t −e−3t.
1 In fact this is the Wronskian of x1(t) and x2(t), as deﬁned in Section 11.4; we saw there that if x1 and x2 are
linearly independent then their Wronskian is never zero, and so our expressions for ˙u1 and ˙u2 make sense.

*The variation of constants formula
167
We have once again found the particular integral −te−3t. The second term here is
just a multiple of one of the solutions of the homogeneous equation and so can be
absorbed into the complementary function; for the general solution
x(t) = Ae−3t + Be2t −te−3t −e−3t = (A −1)e−3t + Be2t −te−3t,
and A −1 is just another arbitrary constant.
□
Example 18.2 Find a particular integral for the equation
¨x + x = tan t.
(18.9)
For this example we will follow the method outlined in general above, rather
than just plugging functions into the resulting formula.
Two linearly independent solutions of the homogeneous equation
¨x + x = 0
are x1(t) = sin t and x2(t) = cos t, so for a particular integral we try
x(t) = u(t) sin t + v(t) cos t.
The ﬁrst derivative of x(t) is given by
˙x = ˙u sin t + u cos t + ˙v cos t −v sin t,
and here we impose an additional condition to make sure that there are no second
derivatives of u or v in ¨x,
˙u sin t + ˙v cos t = 0.
(18.10)
This means that ˙x is given by
˙x = u cos t −v sin t,
and we can differentiate to ﬁnd
¨x = ˙u cos t −u sin t −˙v sin t −v cos t.
Substituting for x and ¨x in (18.9) gives (after some cancellation)
˙u cos t −˙v sin t = tan t.
(18.11)
Equations (18.10) and (18.11) are a pair of simultaneous equations for ˙u and ˙v,
 ˙u sin t + ˙v cos t = 0
˙u cos t −˙v sin t = tan t,

168
18 *The variation of constants formula
with solution
˙u = sin t
and
˙v = sin2 t
cos t = cos t −
1
cos t .
Integrating these two gives2
u = −cos t
v = sin t −ln | sec t + tan t|,
and so a particular integral is
x(t) = −cos t sin t + sin t cos t −ln | sec t + tan t| cos t
= −ln | sec t + tan t| cos t.
You can check this by substitution (this is less work than it looks if you remember
that ln | sec t + tan t| is the integral of sec t).
Exercises
18.1 Use the method of variation of constants to ﬁnd a particular integral for the following
equations:
(i) y′′ −y′ −6y = ex (you could use the method of undetermined coefﬁcients for
this example, which would be much more sensible);
(ii) ¨x −x = t−1 (you can leave the answer as an integral);
(iii) y′′ + 4y = cot 2x. Hint:

cosec xdx = ln |cosec x −cot x|;
(iv) t2 ¨x −2x = t3 (to ﬁnd the solutions of the homogeneous equation try x = tk,
see next chapter);
(v) ¨x −4˙x = tan t (leave your answer as an integral);
(vi)
(tan2 x −1)d2y
dx2 −4 tan3 x dy
dx + 2y sec4 x = (tan2 x −1)(1 −2 sin2 x),
one solution of the homogeneous equation is y(x) = sec2 x, and the reduction
of order method, which is somewhat painful, can be used (if you wish) to show
2 The integral of sec t = 1/ cos t is the ungainly ln | sec t + tan t|. You can check this by differentiating,
d
dt ln(sec t + tan t) =
1
sec t + tan t ×

sin t
cos2 t + cos2 t + sin2 t
cos2 t

=
1
(1 + sin t)/ cos t × 1 + sin t
cos2 t
=
1
cos t .

Exercises
169
that a second linearly independent solution is tan x. You should be able to ﬁnd a
particular integral explicitly for this example;
(vii)
(1 + sin2 t)¨x −(2 tan t + sin t cos t)˙x + (1 −2 tan2 t)x = f (t),
one solution of the homogeneous equation is tan t, and again the reduction of
order method will provide a second solution, cos t, after some effort. You should
leave your ﬁnal answer as an integral.

19
*Cauchy–Euler equations
In this chapter we look at another general class of linear second order equations
that we can solve in a systematic way. These are the Cauchy–Euler equations,
ax2 d2y
dx2 + bx dy
dx + cy = 0.
(19.1)
We will see in the next chapter that an understanding of these equations provides
insight that is useful when we try to ﬁnd the solutions of more complicated equa-
tions in the form of power series.
There are two possible approaches that yield the solution of this problem. One
method uses the substitution x = ez to reduce the equation to the more familiar
a d2y
dz2 + (b −a)dy
dz + cy = 0,
which can then be solved by trying y(z) = ekz, see Exercise 19.2.
However, the method we will use here is similar to the one that we would use to
solve the constant coefﬁcient equation
a d2y
dx2 + b dy
dx + cy = 0.
For this equation we try y(x) = ekx, because for this guess every term in the equa-
tion is a multiple of ekx. Now, note that (19.1) has a very special form; whenever
there is a derivative the corresponding term is also multiplied by x, i.e. we have
x2y′′ and xy′. The kind of function that when differentiated and multiplied by x is
a multiple of itself1 is simply a power of x, y(x) = xk for some k.
If we try y(x) = xk in (19.1) then, since
y′ = kxk−1
and
y′′ = k(k −1)xk−2,
1 If this does not seem obvious then the correct form for y(x) can be found by solving the separable equation
xy′ = ky, see Exercise 8.3.
170

19.2 A repeated root
171
we have
ak(k −1)xk + bkxk + cxk = 0.
Cancelling the factor of xk that occurs in each term we obtain the indicial equation,
a quadratic equation for the index k,
ak(k −1) + bk + c = 0.
(19.2)
As with the second order constant coefﬁcient case, the types of solution that we
obtain using this approach depend on whether the roots of the indicial equation
(19.2) are real and distinct, repeated or complex.
19.1 Two real roots
If there are two distinct real roots k1 and k2 of (19.2) then this implies that y(x) =
xk1 and y(x) = xk2 are both solutions of (19.1), and so the general solution is a
linear combination of these,
y(x) = Axk1 + Bxk2.
Example 19.1 Find the general solution of the equation
2x2y′′ + 3xy′ −y = 0
We try y(x) = xk, and so
2k(k −1)xk + 3kxk −xk = 0,
which gives the indicial equation for k,
2k2 + k −1 = 0.
This can be factorised as (2k −1)(k + 1) = 0, and so k = 1
2 or k = −1, and the
general solution is
y(x) = Ax1/2 + Bx−1.
19.2 A repeated root
If the indicial equation (19.2) has a repeated real root k then this provides only one
solution y(x) = xk. However, we can use the reduction of order method to ﬁnd a
second, linearly independent solution. This will turn out to be y(x) = xk ln x, and
when actually solving an equation like this you should just write down the general
solution
y(x) = Axk + Bxk ln x.

172
19 *Cauchy–Euler equations
Any equation that results in a repeated root can be rewritten as
x2y′′ + (1 −2λ)xy′ + λ2y = 0.
(19.3)
First we check that this equation really does produce a repeated root for the indicial
equation; trying y(x) = xk yields (after cancelling the factors of xk)
k(k −1) + (1 −2λ)k + λ2 = 0,
which is k2 −2λk + λ2 = 0, or (k −λ)2 = 0. So we only obtain the one solution
y(x) = xλ.
Now we use the reduction of order method (see Chapter 17), trying y(x) =
xλu(x). This gives
y′ = xλu′ + λxλ−1u
and
y′′ = xλu′′ + 2λxλ−1u′ + λ(λ −1)xλ−2u,
and substituting into (19.3), remembering that all the terms in which u(x) has not
been differentiated will cancel, we obtain
x2[xλu′′ + 2λxλ−1u′] + (1 −2λ)x[xλu′] = 0.
After cancelling a factor of xλ+1 this gives
xu′′ + u′ = 0.
If v = u′ then v′ = −v/x; the solution of this equation can be found by separating
variables,
dv
v = −dx
x .
Integrating both sides gives
ln v = −ln x + C,
and so v(x) = A/x. Since v = u′, this implies that
du
dx = A
x ,
and so u(x) = A ln x + B, which ﬁnally yields
y(x) = Axλ ln x + Bxλ,
and we can identify the new solution as xλ ln x.
Example 19.2 Find the general solution of the equation
x2y′′ + 3xy′ + y = 0.

19.3 Complex roots
173
If we try y(x) = xk then the indicial equation for k is
k(k −1) + 3k + 1 = 0
which is k2 + 2k + 1 = 0, or (k + 1)2 = 0. So k = −1 is a repeated root. It fol-
lows that the general solution is given by
y(x) = Ax−1 + Bx−1 ln x.
Note that since (ln x)/x →0 as x →0, all solutions tend to zero as x →∞.
□
19.3 Complex roots
If the indicial equation has complex roots, k = ρ ± iω then the solution is
y(x) = xρ[A cos(ω ln x) + B sin(ω ln x)].
Although you should just write down the solution in this case, we now see how it
can be derived from
y(x) = Cxρ+iω + Dxρ−iω.
We can understand xk when k is complex if we use the identity
xk = ek ln x.
While this is clearly true if x is real (since x = eln x), it can also be used as a
deﬁnition of xk if k is complex. If k = ρ + iω then we have
xρ+iω = xρxiω = xρeiω ln x
= xρ[cos(ω ln x) + i sin(ω ln x)],
since eiθ = cos θ + i sin θ. From this formula it follows that xρ−iω is the complex
conjugate of xρ+iω, so in order to make our solution real we want
y(x) = Cxρ+iω + C∗xρ−iω,
where now C is complex, C = α + iβ. We therefore have
y(x) = 2 Re[Cxρ+iω]
= 2 Re[(α + iω)xρ[cos(ω ln x) + i sin(ω ln x)]]
= 2xρ[α cos(ω ln x) −β sin(ω ln x)],
which, choosing A = 2α and B = −2β (they are both arbitrary constants) shows
that
y(x) = xρ[A cos(ω ln x) + B sin(ω ln x)].

174
19 *Cauchy–Euler equations
Example 19.3 Find the general solution of the equation
x2y′′ −xy′ + 5y = 0.
We try y(x) = xk, which yields
k(k −1) −k + 5 = 0,
i.e. k2 −2k + 5 = 0. The roots of this equation are
k = 2 ±
√
4 −20
2
= 1 ± 2i.
So the solution of the equation is
y(x) = x[A cos(2 ln x) + B sin(2 ln x)].
Exercises
19.1 Find the general solution of the following equations, and also the particular solution
satisfying the two speciﬁed conditions.
(i) x2y′′ −4xy′ + 6y = 0, y(1) = 0 and y′(1) = 1;
(ii) 4x2y′′ + y = 0, y(1) = 1 and y′(1) = 0;
(iii) t2 ¨x −5t ˙x + 10x = 0; x(1) = 2 and ˙x(1) = 1;
(iv) t2 ¨x + t ˙x −x = 0, x(1) = ˙x(1) = 1;
(v) x2z′′ + 3xz′ + 4z = 0, z(1) = 0 and z′(1) = 5;
(vi) x2y′′ −xy′ −3y = 0, y(1) = 1 and y′(1) = −1;
(vii) 4t2 ¨x + 8t ˙x + 5x = 0, x(1) = 2 and ˙x(1) = 0;
(viii) x2y′′ −5xy′ + 5y = 0, y(1) = −2 and y′(1) = 1;
(ix) 3x2z′′ + 5xz′ −z = 0, z(1) = 3 and z′(1) = −1; and
(x) t2 ¨x + 3t ˙x + 13x = 0, x(1) = −1 and ˙x(1) = 2.
19.2 If x = ez then
d
dx = e−z d
dz .
Show that
d2y
dx2 = e−2z

d2y
dz2 −dy
dz

,
and hence that substituting x = ez in
ax2 d2y
dx2 + bx dy
dx + cy = 0
(E19.1)
yields the linear equation
a d2y
dz2 + (b −a)dy
dz + cy = 0.
(E19.2)

Exercises
175
By solving (E19.2) ﬁnd the solution of (E19.1) when the auxiliary equation
ak2 + (b −a)k + c = 0
has
(i) two distinct real roots k1 and k2;
(ii) a repeated real root k; and
(iii) a complex conjugate pair of roots ρ ± iω.

20
*Series solutions of second order linear equations
We now consider how we might go about ﬁnding a solution of the second order
linear equation
d2y
dx2 + p(x)dy
dx + q(x)y = 0
in the form of a power series1
y(x) =
∞

n=0
anxn.
(20.1)
20.1 Power series
Before we see how power series can be used to ﬁnd solutions of differential equa-
tions, we brieﬂy recall, without proof, some of their basic properties.
Whenever we consider inﬁnite series, the issue of convergence becomes impor-
tant. A power series is said to converge at a point x if the ﬁnite sums
N

n=0
anxn
1 Throughout this chapter we only consider power series solutions in this form. Although it is possible to consider
more general series solutions like
y(x) =
∞

n=0
an(x −x0)n
(an expansion ‘about x = x0’) it is always possible to convert such series to something in the form of (20.1) by
making the substitution ˜x = x −x0 in the differential equation.
176

20.1 Power series
177
(
)
Series converges absolutely
Series diverges
Series diverges
0
Radius of convergence ρ
Fig. 20.1. Within the radius of convergence the power series converges abso-
lutely; outside the series diverges, and on the boundary it may converge or diverge.
tend to a limit as N →∞, and it is said to converge absolutely if
N

n=0
|anxn|
tends to a limit as N →∞. If a series converges absolutely then it must also
converge, but the converse is not true.
For every power series there is a number ρ ≥0, known as the radius of conver-
gence, such that the series in (20.1) converges absolutely for any x with |x| < ρ,
and does not converge for |x| > ρ. When |x| = ρ the series may converge, or may
diverge, see Figure 20.1.
Most important for us is the fact that while x lies within the radius of conver-
gence it is possible to differentiate y(x) by differentiating the power series term-
by-term so that
y′(x) =
∞

n=0
nanxn−1.
The resulting power series for y′(x) has the same radius of convergence as the
original power series for y(x).
Although there is no sureﬁre way to ﬁnd this radius of convergence, one ex-
tremely useful method is based on the ratio test. The ratio test guarantees that a
series converges absolutely provided that (the modulus of ) the ratio of successive
terms is eventually less than one,
lim
n→∞

an+1xn+1
anxn
 = |x| lim
n→∞

an+1
an
 < 1.
It follows that the radius of convergence is given by
ρ = lim
n→∞

an
an+1
 ,
provided that the limit on the right-hand side exists.

178
20 *Series solutions of second order linear equations
We can add and multiply power series together within their radius of conver-
gence, and we will frequently use the fact that if
∞

n=0
anxn =
∞

n=0
bnxn
then an = bn for every n. In particular, if the right-hand side is zero then an = 0
for all n.
20.2 Ordinary points
We ﬁrst suppose that p(x) and q(x) are analytic. Essentially this means that they
can both be expanded as convergent power series,
p(x) =
∞

n=0
pnxn
and
q(x) =
∞

n=0
qnxn.
In such a situation, x = 0 is referred to as an ordinary point for the equation. In
this case we can try a power series solution for y(x) of the form
y(x) =
∞

n=0
anxn.
(20.2)
Assuming that we are within the radius of convergence of the power series we
can differentiate term-by-term to ﬁnd y′ and y′′, then substitute into the equation
and compare terms involving the same powers of x.
We will start by ﬁnding the solution of a familiar equation in this new way.
Example 20.1 Find the general solution of the equation
y′′ = −y
as a power series
y(x) =
∞

n=0
anxn,
and hence identify two linearly independent solutions.
Assuming that x lies within the radius of convergence of the power series, we
have, differentiating term-by-term,
y′(x) =
∞

n=0
nanxn−1 =
∞

n=1
nanxn−1

20.2 Ordinary points
179
(since the ﬁrst term in the ﬁrst sum is zero), and then
y′′(x) =
∞

n=1
n(n −1)anxn−2 =
∞

n=2
n(n −1)anxn−2.
Substituting into the equation y′′ = −y we get
∞

n=2
n(n −1)anxn−2 = −
∞

n=0
anxn.
It is useful to rewrite both sums so that the index of the power of x is the same,
∞

n=0
(n + 2)(n + 1)an+2xn = −
∞

n=0
anxn.
(The ‘summation variable’ n is a dummy variable, just like the variable in an inte-
gration, so we can change it without affecting the value of the sum.)
All terms contain every power of x from zero upwards, and equating the coefﬁ-
cients of xn gives
(n + 1)(n + 2)an+2 = −an,
or more usefully
an+2 = −
an
(n + 1)(n + 2).
This provides a recurrence relation that tells us an+2 if we know an.
The way that this recurrence relation works means that if we know a0 then we
know an for all even n, and if we know a1 then we know an for all odd n. So,
as we would expect for a second order linear equation, there will be two arbitrary
constants (a0 and a1) in the general solution.
First we consider the even coefﬁcients:
a2 = −a0
2
a4 = −
1
3 × 4 × −a0
2 = a0
4!
a6 = −
1
5 × 6
a0
4! = −6!;
so in general it looks like we have
a2n = (−1)n a0
(2n)!.
(20.3)
We should really check these general coefﬁcients using induction, although we will
only do so twice in this chapter, once here, and once in our ﬁnal (and signiﬁcantly
more unpleasant) example. If we assume that (20.3) is correct for n = k, then the
0

180
20 *Series solutions of second order linear equations
recurrence relation implies that
a2(k+1) = −
a2k
(2k + 1)(2k + 2) = −
1
(2k + 1)(2k + 2) × (−1)ka0
(2k)!
= (−1)k+1
a0
(2(k + 1))!,
as required. Since (20.3) is correct when n = 0 it is therefore correct for all n.
For odd values of n
a3 = −a1
2 × 3
a5 = −
1
4 × 5 × −a1
3! = a1
5!
a7 = −
1
6 × 7
a1
5! = −a1
7! ,
and in general we have
a2n+1 = (−1)n
a1
(2n + 1)!.
It follows that our full series solution is
y(x) = a0

1 −x2
2 + x4
24 + · · · + (−1)n x2n
(2n)! + · · ·

+ a1

x −x3
6 + x5
120 −· · · + (−1)n
x2n+1
(2n + 1)! + · · ·

.
We can recognise the power series in the square brackets as those for cos x and
sin x (see Appendix C), and so
y(x) = a0 cos x + a1 sin x,
as we might have expected. These power series are known to converge for every
x; we can easily check this using the ratio test. The ratio of two successive terms
in the series for cos x is
(−1)n+1
x2n+2
(2n + 2)!
)
(−1)n x2n
(2n)! =
−x2
(2n + 2)(2n + 1)
which, for each ﬁxed x, tends to zero as n →∞. Similarly, for the ratio of two
successive terms of the series for sin x we have
(−1)n+1
x2n+3
(2n + 3)!
)
(−1)n
x2n+1
(2n + 1)! =
−x2
(2n + 3)(2n + 1).
The graph of cos x, along with the result of taking a ﬁnite number of terms in
their power series expansions, is shown in Figure 20.2.
□

20.2 Ordinary points
181
0
1
2
3
4
5
6
7
8
9
10
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
n=2
n=4
n=6
n=8
n=10
n=16
n=18
Fig. 20.2. A graph of cos x against x (the bold line) along with the sum of a
ﬁnite number of terms of the series solution (n gives the highest power of x in the
expansion).
We now use the series solution method on a less familiar example.2
Example 20.2 Find the general solution of the Airy equation
y′′ −xy = 0
(20.4)
in the form
y(x) =
∞

n=0
anxn.
Assuming that x lies within the radius of convergence of the power series, we
have, differentiating term-by-term,
y′(x) =
∞

n=0
nanxn−1 =
∞

n=1
nanxn−1
(since the ﬁrst term in the ﬁrst sum is zero), and then
y′′(x) =
∞

n=1
n(n −1)anxn−2 =
∞

n=2
n(n −1)anxn−2.
2 Although both the Airy equation and Bessel’s equation (the subject of Section 20.4) may be unfamiliar, their
solutions are standard functions, just as are sine and cosine. Indeed, MATLAB has built in deﬁnitions of both the
Airy functions (airy) and of the Bessel functions (besselj and bessely).

182
20 *Series solutions of second order linear equations
Substituting into equation (20.4) we have
∞

n=2
n(n −1)anxn−2 −x
∞

n=0
anxn = 0
or, taking the factor of x inside the sum in the second term,
∞

n=2
n(n −1)anxn−2 −
∞

n=0
anxn+1 = 0.
Rewriting both sums so that the index of the power of x is the same we obtain
∞

n=0
(n + 2)(n + 1)an+2xn −
∞

n=1
an−1xn = 0.
A constant term only occurs in the ﬁrst sum on the left, and this must be zero to
match the right-hand side, from which we obtain 2a2 = 0, so a2 = 0. Otherwise,
setting the coefﬁcient of xn on the left-hand side to zero (in order to match the
right-hand side) we have
(n + 2)(n + 1)an+2 −an−1 = 0,
which we can rewrite as
an+3 =
an
(n + 3)(n + 2).
Now the recurrence relation tells us an+3 if we know an, so will give a3, a6, a9,
etc. in terms of a0, and a4, a7, a10, etc. in terms of a1. Since a2 = 0, it follows that
a5 = a8 = a11 = · · · = 0.
For the coefﬁcients based on a0 we have
a3 = a0
2 · 3
a6 = a3
5 · 6 =
a0
2 · 3 · 5 · 6
a9 = a6
8 · 9 =
a0
2 · 3 · 5 · 6 · 8 · 9,
and so in general
a3n =
a0
2 · 3 · 5 · 6 · · · · · (3n −1) · 3n .
Similarly for the coefﬁcients based on a1 we have
a4 = a1
3 · 4
a7 = a4
6 · 7 =
a1
3 · 4 · 6 · 7
a10 =
a7
9 · 10 =
a1
3 · 4 · 6 · 7 · 9 · 10,
and in general
a3n+1 =
a1
3 · 4 · 6 · 7 · · · · · 3n · (3n + 1).

20.3 Regular singular points
183
So the solution of the equation is
y(x) = a0

1 + x3
2 · 3 +
x6
2 · 3 · 5 · 6 + · · · +
x3n
2 · 3 · · · · · (3n −1) · 3n + · · ·

+ a1

x + x4
3 · 4 +
x7
3 · 4 · 6 · 7 + · · · +
x3n+1
3 · 4 · · · · · 3n · (3n + 1) + · · ·

.
Note that this gives the solution in the form
y(x) = a0A1(x) + a1A2(x),
i.e. as a superposition of two (we presume) linearly independent solutions A1(x)
and A2(x), each of which is given as a power series:
A1(x) = 1 +
∞

n=1
x3n
2 · 3 · · · · · (3n −1) · 3n
and
A2(x) = x +
∞

n=1
x3n+1
3 · 4 · · · · · 3n · (3n + 1).
The ratio of successive terms in A1(x) is

x3(n+1)
2 · 3 · (3n −1) · 3n · (3n + 2) · (3n + 3)
)
x3n
2 · 3 · · · · · (3n −1) · 3n

=
|x|3
(3n + 2)(3n + 3),
so that whatever the value of x this expression tends to zero as n →∞. It follows
that the series converges for every value of x. A similar analysis shows that A2(x)
also converges for every x.
The graph of A1(x) is shown in Figure 20.3, along with the approximations
given by taking a ﬁnite number of terms in the corresponding power series.
□
The standard forms of the Airy functions, known as Ai(x) and Bi(x), are linear
combinations of A1(x) and A2(x); Ai(x) is chosen such that Ai(x) →0 as x →
∞and Bi(x) such that the Wronskian W[Ai, Bi](x) = 1/.
20.3 Regular singular points
There are many important equations that can be written in the form
y′′ + p(x)y′ + q(x)y = 0
(20.5)

184
20 *Series solutions of second order linear equations
−6
−5
−4
−3
−2
−1
0
1
2
3
−2
−1
0
1
2
3
4
5
n=3
n=6
n=9
n=12
n=21
n=24
Fig. 20.3. The graph of A1(x) against x shown as a bold line, along with the
values of some of the ﬁnite sums.
in which p(x) and q(x) are not analytic, i.e. cannot be expressed as a power series.
The simplest example is the Cauchy–Euler equation
x2y′′ + p0xy′ + q0y = 0
(20.6)
from the previous chapter. Dividing through by x2 gives
y′′ + p0
x y′ + q0
x2 y = 0,
(20.7)
and so p(x) = p0/x and q(x) = q0/x2 cannot be expanded as power series.
However, we saw in the previous chapter that (20.6) has solutions of the form
y(x) = Axσ, for an arbitrary constant A, where σ has to satisfy the indicial equa-
tion
σ(σ −1) + p0σ + q0 = k.
(20.8)
We can extend the power series method to equations in which p(x) is ‘no worse
than p0/x’ and q(x) is ‘no worse than q0/x2’, which are the ‘bad’ factors occurring
in (20.7).
A point x is known as a regular singular point for equation (20.6) if xp(x) and
x2q(x) are analytic (i.e. have convergent power series expansions). In this case
p(x) and q(x) can be written as
p(x) = p0
x + p1 + p2x + p3x2 + · · ·
q(x) = q0
x2 + q1
x + q2 + q3x + q4x2 + · · · .
(20.9)

20.3 Regular singular points
185
To ﬁnd a power series solution in this case we replace the arbitrary constant in our
solution y(x) = Axσ of the Cauchy–Euler equation by a power series, and look
for a solution in the form
y(x) = xσ
∞

n=0
anxn =
∞

n=0
anxσ+n.
(20.10)
The appropriate values of σ will once again be determined by an indicial equation,
as we now see.
Provided that we are within the radius of convergence of the series we have
y′(x) =
∞

n=0
an(n + σ)xσ+n−1
and
y′′(x) =
∞

n=0
an(n + σ)(n + σ −1)xσ+n−2.
Substituting these into y′′ + p(x)y′ + q(x)y = 0 and using the expansion of p(x)
and q(x) in (20.9) gives
∞

n=0
an(n + σ)(n + σ −1)xσ+n−2
+
 p0
x + p1 + p2x + p3x2 + · · ·
 ∞

n=0
an(n + σ)xσ+n−1
(20.11)
+
q0
x2 + q1
x + q2 + q3x + q4x2 + · · ·
 ∞

n=0
anxσ+n = 0.
Looking at the coefﬁcient of the lowest power of x, xσ−2, and setting this to zero,
we can show that we need σ to satisfy the familiar indicial equation
σ(σ −1) + p0σ + q0 = 0,
(20.12)
cf. (20.8). We might expect that if we have two distinct roots σ1 > σ2 of (20.12)
then this would give us two linearly independent power series solutions of our
differential equation, and this will be the case provided that σ1 and σ2 do not differ
by an integer.
To see what the problem is if the roots differ by an integer, we look at the coef-
ﬁcient of xσ+n−2 from equation (20.11), which is
[(n + σ)(n + σ −1) + p0(n + σ) + q0]an + terms involving a0, ..., an−1 = 0.

186
20 *Series solutions of second order linear equations
If we rearrange this to ﬁnd a recurrence relation for an we get
an =
terms involving a0, ..., an−1
(n + σ)(n + σ −1) + p0(n + σ) + q0
.
The denominator of this equation will be zero if n + σ solves the indicial equa-
tion (20.12). For the larger root, σ1, the denominator will never be zero, so we will
obtain a solution. However, if the roots differ by an integer N then σ2 + N = σ1,
and so the recurrence relation for the series involving σ = σ2 will run into a prob-
lem when n = N (the denominator will be zero) unless there are happy cancella-
tions which also make the numerator zero for this value of n.
Thus if there is a repeated real root, or (in general) if the roots differ by an
integer, we will only be able to ﬁnd one solution in the form of the power series
(20.10),
y0(x) =
∞

n=0
anxn+σ.
However, by making our ‘guess’ a little more complicated it is possible to ﬁnd
the second solution. Our analysis of the Cauchy–Euler equation in the previ-
ous chapter provides a clue as to the form of this guess. There we found that
if we had a repeated root σ of the indicial equation then the general solution
was
y(x) = Axσ ln x + Bxσ.
(20.13)
Once again we replace the arbitrary constants by power series; we replace Axσ by
our expansion for y0(x), and B by a new power series whose coefﬁcients we have
to ﬁnd,
y1(x) = y0(x) ln x +
∞

n=0 or 1
bnxσ+n.
(20.14)
If there is a repeated root σ then the sum on the right-hand side is taken from 1,
while if the roots differ by an integer σ = σ2 is the smaller root, and the sum is
taken from zero.3 The algebra involved in substituting (20.14) into the equation is
usually fairly daunting, and we will only consider one relatively simple example
in what follows.
3 Taking the sum from zero in the case of a repeated root will add a multiple of y0(x) to the solution y1(x) and
complicate the algebra.

20.4 Bessel’s equation
187
20.4 Bessel’s equation
We consider how this method applies to ‘Bessel’s equation of order ν’,
x2 d2y
dx2 + x dy
dx + (x2 −ν2)y = 0.
(20.15)
By choosing various different values of ν we will be able to produce examples of
all the different possibilities outlined above.
If we divide by x2 then we obtain an equation in the standard form,
d2y
dx2 +
1
x

p(x)
dy
dx +

1 −ν
x2




q(x)
y = 0,
from which we can see that x = 0 is a regular singular point, since although neither
p(x) nor q(x) is analytic, xp(x) and x2q(x) are. However, it is more convenient
to work with the equation in the form (20.15).
We try a solution
y(x) =
∞

n=0
anxσ+n,
and so within the radius of convergence
y′(x) =
∞

n=0
an(σ + n)xσ+n−1
and
y′′(x) =
∞

n=0
an(σ + n)(σ + n −1)xσ+n−2.
Substituting this into (20.15) gives
∞

n=0
an(σ + n)(σ + n −1)xσ+n +
∞

n=0
an(σ + n)xσ+n
+
∞

n=2
an−2xσ+n −ν2
∞

n=0
anxσ+n = 0.
The coefﬁcient of xσ gives
a0σ(σ −1) + a0σ −ν2a0 = 0,
which yields the indicial equation σ 2 = ν2. The coefﬁcient of xσ+1 gives
a1(σ + 1)σ + a1(σ + 1) −ν2a1 = 0
(20.16)

188
20 *Series solutions of second order linear equations
and so a1 = 0 whatever the value of ν. For n ≥2 the coefﬁcient of xσ+n is
an(σ + n)(σ + n −1) + an(σ + n) + an−2 −ν2an = 0,
yielding the recurrence relation
an = −
an−2
(n + σ)2 −ν2 .
Since σ = ±ν this gives
an = −
an−2
n(n + 2σ).
(20.17)
Example 20.3 Find two series solutions of Bessel’s equation when ν = 1
3.
The indicial equation has roots σ = ±1
3, and these differ by 2/3, which is not
an integer. So we should be able to ﬁnd two power series solutions,
∞

n=0
anxn+1
3
and
∞

n=0
bnxn−1
3.
For the ﬁrst series σ = 1
3 and the recurrence relation in (20.17) becomes
an = −
an−2
n(n + 2/3) = −
9an−2
3n(3n + 2).
Since a1 = 0 the recurrence relation shows that an = 0 for all odd values of n, and
we have
a2 = −9a0
6 · 8
a4 = −9a2
9 · 11 =
92a0
6 · 8 · 9 · 11
a6 = −
93a0
6 · 8 · 9 · 11 · 12 · 14,
and in general
a2n = (−1)n
9na0
6 · 8 · · · · · 6n · (6n + 2) = (−1)n

3
2
2n
a0
3 · 4 · · · · · 3n · (3n + 1).
So we have one solution
j1/3(x) = x1/3
∞

n=0
(−1)n
(3x/2)2n
3 · 4 · · · · · 3n · (3n + 1).
For the second solution with σ = −1
3 the recurrence relation is
bn = −
bn−2
n(n −2/3) = −
9bn−2
3n(3n −2),
and so

20.4 Bessel’s equation
189
0
1
2
3
4
5
6
7
8
9
10
−0.5
0
0.5
1
0
1
2
3
4
5
6
7
8
9
10
−2
0
2
4
Fig. 20.4. Graphs of j1/3(x) (top) and j−1/3(x) (bottom) against x along with
their approximations from series with 4, 6, 8 and 10 terms.
b2 = −9b0
6 · 4
b4 = −9b2
12 · 10 =
92b0
4 · 6 · 10 · 12
b6 = −
93b0
4 · 6 · 10 · 12 · 16 · 18,
and in general
b2n = (−1)n
9nb0
4 · 6 · · · · · (6n −2) · 6n = (−1)n

3
2
n
b0
2 · 3 · · · · · (3n −1) · 3n ,
giving a second solution
j−1/3(x) = x−1/3
∞

n=0
(−1)n
(3x/2)2n
2 · 3 · · · · · (3n −1) · 3n .
Graphs of j1/3(x) and j−1/3(x) are shown in Figure 20.4.
□
It is interesting to note that these functions are related to the solutions of the
Airy equation. For example, we had
A1(x) = 1 + x3
2 · 3 +
x6
2 · 3 · 5 · 6 + · · · +
x3n
2 · 3 · · · · ·(3n −1) · 3n + · · ·
= 1 −(ix3/2)2
2 · 3
+
(ix3/2)4
2 · 3 · 5 · 6 + · · · + (−1)n
(ix3/2)2n
2 · 3 · · · · · (3n −1) · 3n +· · ·
= j−1/3

2
3ix3/2

.
Just as there are standard choices for the two linearly independent solu-
tions of the Airy equation, there are standard normalisations for the series

190
20 *Series solutions of second order linear equations
solutions of Bessel’s equation. The Bessel function Jν(x) (returned by MATLAB’s
besselj(nu,x)) is equal to 2ν(1 + ν) times the series solutions jν(x) that
we obtain in this chapter, where (x) is the gamma function (a generalisation
of the factorial function deﬁned by the integral (z) =
 ∞
0
tz−1e−t dt, see Exer-
cise 20.8).
Example 20.4 Find two series solutions of Bessel’s equation when ν = 1
2.
In this case the indicial equation has roots σ = ±1
2, and these differ by an inte-
ger. For σ = 1
2 the recurrence relation in (20.17) gives
an = −
an−2
n(n + 1).
As before all odd coefﬁcients are zero,
a2 = −a0
2 · 3
a4 =
a0
2 · 3 · 4 · 5
a6 = a0
7! ,
and the general coefﬁcient is
a2n = (−1)n
a0
(2n + 1)!.
It follows that
y(x) = a0
 ∞

n=0
(−1)n x2n + 1
2
(2n + 1)!
	
= a0
√x
 ∞

n=0
(−1)n
x2n+1
(2n + 1)!
	
= a0
sin x
√x ,
and one solution of the equation is j1/2(x) = sin x/√x.
We might suspect that the other solution is cos x/√x and this in fact turns out to
be the case. This is an example in which there are ‘happy cancellations’ that allow
us to ﬁnd a second solution using the series method even though σ1 and σ2 differ
by an integer. For σ = −1
2 the recurrence relation in (20.17) becomes
an = −
an−2
n(n −1),
(20.18)
and the ‘happy cancellation’ arises since a1 is always zero (this followed from
(20.16)) and so we never need to use (20.18) with n = 1 (which is where the

20.4 Bessel’s equation
191
Fig. 20.5. The two solutions
j1/2(x) = sin x/√x (solid), and
j−1/2(x) =
cos x/√x (dashed), plotted against x.
problem would arise). For this second solution we get
a2 = −a0
2
a4 = a0
4!
a6 = −a0
6! ,
and in general a2n = (−1)n/(2n)!; we have
y(x) = a0
⎡
⎣
∞

n=0
x2n−1
2
(2n)!
⎤
⎦
= a0
√x
 ∞

n=0
x2n
(2n)!
	
= a0
cos x
√x .
As we suspected, there is a second solution j−1/2(x) = cos x/√x.
These solutions are illustrated in Figure 20.5.
Example 20.5 Find a series solution of Bessel’s equation when ν = 0,
x2y′′ + xy′ + x2y = 0.
(20.19)
In this case the roots of the indicial equation are both σ = 0, so we can only
ﬁnd one solution in the form of a simple power series. The recurrence relation in
(20.17) becomes
an = −an−2
n2 .
0
1
2
3
4
5
6
7
8
9
10
−0.5
0
0.5
1
1.5
2
2.5
3
3.5
4

192
20 *Series solutions of second order linear equations
0
1
2
3
4
5
6
7
8
9
10
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Fig. 20.6. The graph of J0(x), plotted against x, along with the sum of the series
with 4, 6, 8, 10 and 12 terms. The series with 14 terms cannot be distinguished
from J0(x) over this range of x values.
Since a1 = 0 all odd coefﬁcients are zero, and
a2 = −a0
22
a4 =
a0
22 · 42
a6 = −
a0
22 · 42 · 62 .
It follows that
a2n =
(−1)na0
2242 · · · (2n)2 = (−1)na0
22n(n!)2 .
Thus we have
y0(x) = a0
 ∞

n=0
(−1)n
22n(n!)2 x2n
	
,
with the convention that 0! = 1. The quantity in the square brackets is J0(x), the
Bessel function of the ﬁrst kind of order zero. A graph of J0(x), along with its
approximations by taking a ﬁnite number of terms from the power series, is shown
in Figure 20.6.
□
We end this chapter with a somewhat more painful calculation of the second
solution for Bessel’s equation of order zero.
Example 20.6 Find a solution for Bessel’s equation of order zero in the form
y(x) = J0(x) ln x +
∞

n=1
bnxn.

20.4 Bessel’s equation
193
First we calculate
y′(x) = J ′
0(x) ln x + J0(x)
x
+
∞

n=1
nbnxn−1
and
y′′(x) = J ′′
0 (x) ln x + 2 J ′
0(x)
x
−J0(x)
x2
+
∞

n=2
n(n −1)bnxn−2.
When we substitute these expressions into Bessel’s equation of order zero,
x2y′′ + xy′ + x2y = 0, all the terms involving J0(x) cancel except one, and we
end up with
2x J ′
0(x) +
∞

n=2
n(n −1)bnxn +
∞

n=1
nbnxn +
∞

n=1
bnxn+2 = 0.
Since
J0(x) =
∞

n=0
(−1)n
22n(n!)2 x2n
it follows that
x J ′
0(x) =
∞

n=1
(−1)n2n
22n(n!)2 x2n.
Therefore we have
b1x + 4b2x2 +
∞

n=3
[n2bn + bn−2]xn = −2
∞

n=1
(−1)n2n
22n(n!)2 x2n.
Since only even powers occur on the right-hand side it follows that b1 = 0, and
that for n odd
n2bn + bn−2 = 0,
which implies that bn = 0 for all odd indices n. When n is even we have b2 = 1/4
and for n ≥2 the coefﬁcients of x2n give
(2n)2b2n + b2(n−1) = −
(−1)nn
22(n−1)(n!)2
which is
b2n =
1
22n2

−b2(n−1) −
(−1)nn
22(n−1)(n!)2

.

194
20 *Series solutions of second order linear equations
Thus
b4 =
1
22 · 22

−1
4 −
2
2222

= −1
2242

1 + 1
2

,
then
b6 =
1
22 · 32
 1
2242

1 + 1
2

+
3
24(3!)2

=
1
224262

1 + 1
2 + 1
3

.
It looks as though we have
b2n = (−1)n+1
22n(n!)2

1 + 1
2 + · · · + 1
n

,
although this is one solution that we should check by induction. Assuming that this
is correct for b2k, we have
b2(k+1) =
1
22(k + 1)2

−(−1)k+1
22k(k!)2

1 + 1
2 + · · · + 1
k

−(−1)k+1(k + 1)
22k((k + 1)!)2

=
(−1)k+2
22(k + 1)2

1
22k(k!)2

1 + 1
2 + · · · + 1
k

+
1
22k(k!)2(k + 1)

=
(−1)k+2
2222k(k + 1)2(k!)2

1 + 1
2 + · · · + 1
k

+
1
k + 1

=
(−1)k+2
22(k+1)((k + 1)!)2

1 + 1
2 + · · · +
1
k + 1

,
as required. Writing Hn for the sum of the ﬁrst n terms of the harmonic series
Hn = 1 + 1
2 + · · · + 1
n
we therefore have the second solution
y0(x) = J0(x) ln x +
∞

n=1
(−1)n+1
Hn
22n(n!)2 x2n.
(20.20)
This second solution, which blows up as x →0 like ln x, is shown in Figure 20.7.
The standard normalisation of this second solution means that the ‘Bessel func-
tion of the second kind of order zero’, Y0(x), returned by the MATLAB function
bessely(0,x), is somewhat surprisingly given by
Y0(x) = 2
[y0(x) + (γ −ln 2)J0(x)],

Exercises
195
0
1
2
3
4
5
6
7
8
9
10
−5
−4
−3
−2
−1
0
1
Fig. 20.7. A second linearly independent solution for Bessel’s equation of order
zero plotted against x, and its approximations by J0(x) ln x + Sn, where Sn is the
series part of (20.20) with 2, 4 and 6 terms.
where γ is the Euler–Mascheroni constant deﬁned by
γ = lim
n→∞(Hn −ln n) ≈0.5772.
Exercises
You may ﬁnd the following two identities useful for these exercises:
2 · 4 · 6 · · · · · 2n = 2nn!
and
1 · 3 · 5 · · · · · (2n −1) = (2n)!
2nn! .
20.1 Legendre’s equation is
(1 −x2)y′′ −2xy′ + l(l + 1)y = 0.
(E20.1)
If y(x) is given by a power series,
y(x) =
∞

n=0
anxn,
ﬁnd the recurrence relation satisﬁed by the coefﬁcients an. Show that if l is a positive
integer then there is a solution given by a power series that has only a ﬁnite number
of terms, i.e. a polynomial. For each value l = 1, 2, 3, and 4 ﬁnd the polynomial
solution that has y(1) = 1 (these are the ‘Legendre polynomials’ Pl(x)).

196
20 *Series solutions of second order linear equations
20.2 Find two independent power series solutions of the following equations, and use the
ratio test to ﬁnd their radius of convergence.
(i) y′′ −xy′ + y = 0 (cf. Exercise 17.5),
(ii) (1 + x2)y′′ + y = 0,
(iii) 2xy′′ + y′ −2y = 0 (you should be able to sum the two power series to obtain
explicit forms for the two solutions),
(iv) y′′ −2xy′ + 2ky = 0. By ﬁnding the recurrence relation for the coefﬁcients in
the power series identify those values of k for which one solution is a polyno-
mial. Find both solutions when k = −2 and k = 2; in each case you should be
able to ﬁnd a simple expression for one of the two solutions, while the other
can be written as a power series whose general term you should be able to ﬁnd
explicitly.
20.3 Find one power series solution of the equation
x(1 −x)y′′ −3xy′ −y = 0.
You should be able to sum this power series to write down the solution explicitly.
Now use the reduction of order method to ﬁnd a second solution.
20.4 Find one series solution of the ‘modiﬁed Bessel equation’
x2y′′ + xy′ −x2y = 0.
20.5 Find a series solution for Bessel’s equation of order one,
x2y′′ + xy′ + (x2 −1)y = 0.
(E20.2)
You should obtain
y(x) = cx
∞

n=0
(−1)nx2n
22n(n + 1)! n!;
with the choice c = 1/2 this gives the standard form of the Bessel function J1(x),
J1(x) =
∞

n=0
(−1)n
(n + 1)! n!
x
2
2n+1
.
20.6 In order to ﬁnd a second solution of (E20.2), substitute
y(x) = J1(x) ln x + 1
x
 ∞

n=0
bnxn
	
,
where J1(x) is the series solution from the previous question, to show that
b1 + b0x +
∞

n=2
[(n2 −1)bn+1 + bn−1]xn = −2
∞

k=0
(−1)k(2k + 1)
(k + 1)! k!
x
2
2k+1
.
Hence show that b0 = −1, b1 = 0, and that bn obeys the recurrence relation
(n2 −1)bn+1 + bn−1 = 0

Exercises
197
if n is even and, for k = 1, 2, 3, . . . ,
[(2k + 1)2 −1]b2(k+1) + b2k = −(−1)k(2k + 1)
22k(k + 1)! k! .
(E20.3)
Deduce that b j = 0 for all odd values of j.
Denoting by Hn the sum
Hn =
n

j=1
1
j ,
verify that
b2k = (−1)k(Hk + Hk−1)
22kk! (k −1)!
solves (E20.3) and hence write down a second solution of (E20.2).
20.7 Show that when n is a positive integer one solution of Bessel’s equation
x2 d2y
dx2 + x dy
dx + (x2 −n2)y = 0
can be written as the power series
Jn(x) =
∞

j=0
(−1) j
1
j!(n + j)!
x
2
n+2 j
.
(E20.4)
20.8 (T) The gamma function generalises the factorial function to values that are not
integers. For any real number z we deﬁne
(z) =
 ∞
0
tz−1e−t dt.
Integrate by parts in order to show that for a positive integer n
(n + 1) = n(n).
Since (1) = 1, deduce that (n + 1) = n!. (Using the gamma function in place of
one of the factorials in the power series (E20.4) gives
Jν(x) =
∞

j=0
(−1) j
1
j! (ν + j + 1)
x
2
ν+2 j
,
and this formula now applies for any real number ν. This is where the strange nor-
malisation of Jν for non-integer ν comes from, see comments after Example 20.3.)
20.9 (C) Write a short program to generate the coefﬁcients in the power series expansion
of Jν(x) for any value of ν using the recurrence relation (20.17). Investigate how
many terms of the expansion you need to take in order to approximate the solution
well on a ﬁxed interval (0 ≤x ≤10, say). (You might like to look at the M-ﬁle
besselseries.m, which produced the Bessel function ﬁgures in this chapter.)

198
20 *Series solutions of second order linear equations
20.10 (T) The Bessel functions might seem exotic, but they arise very naturally in prob-
lems that have radial symmetry. For example, the vibrations of a circular drum sat-
isfy
∂2u
∂t2 = 1
r
∂
∂r

r ∂u
∂r

+ 1
r2
∂2u
∂θ2 ,
(E20.5)
where u(r, θ, t) is the displacement of the circular skin of the drum at a point ex-
pressed in polar coordinates. In the method of separation of variables we look for a
solution of the form
u(r, θ, t) = R(r)Θ(θ)T (t),
and try this guess in the equation. Substitute this in to (E20.5) and show that
1
T
d2T
dt2 = 1
r R
d
dr

r dR
dr

+
1
r2Θ
d2Θ
dθ2 .
(E20.6)
The left-hand side of this equation is a function of t alone, and the right-hand side
a function of r and θ, so in order to be always equal they must both be constants.
Choosing
1
T
d2T
dt2 = −k2
(there are good physical reasons for choosing this constant to be negative) show that
we can rearrange (E20.6) to give
−1
Θ
d2Θ
dθ2 = r
R
d
dr

r dR
dr

+ r2k2.
(E20.7)
Now the left-hand side is a function of θ alone, while the right-hand side is a func-
tion of r alone; so both sides must be equal to a constant. Now we choose
−1
Θ
d2Θ
dθ2 = ν2
(again there are good physical reasons why this constant should be positive); show
that in this case (E20.7) can be rearranged to give
r2 d2R
dr2 + r dR
dr + (r2k2 −ν2)R = 0.
Finally substitute x = rk to show that R satisﬁes Bessel’s equation of order ν,
x2 d2R
dx2 + x dR
dx + (x2 −ν2)R = 0.

Part IV
Numerical methods and difference equations


21
Euler’s method
If we have a differential equation that we cannot solve analytically then we can
always try to treat the problem numerically. In this chapter we consider one nu-
merical way to approximate the equation
dx
dt = f (x, t)
x(0) = x0.
(21.1)
The ﬁrst step is to give up the idea of ﬁnding a solution for all values of the
independent variable (x(t) for any t ∈R) and instead try to ﬁnd an approximation
to the solution at a discrete set of values of t. This is illustrated in Figure 21.1.
In the simplest case we try to approximate the solution at equally spaced values
of the independent variable. This means, for example, that we want to approximate
x(h), x(2h), x(3h), x(4h), etc. The difference between two successive times, here
h, is called the timestep (or more generally, when the independent variable is not
necessarily time, the step size).
If we have a method for approximating x(t + h) given x(t), then we can apply
the method repeatedly to ﬁnd approximations for x(nh) for any n, if x(0) is speci-
ﬁed initially; ﬁrst we approximate x(h) = x(0 + h), then using our approximation
for x(h) we approximate x(2h) = x(h + h), then x(3h) = x(2h + h), etc.
In this chapter we will introduce the simplest numerical method for producing
approximations to the solutions of (21.1).
21.1 Euler’s method
The differential equation
dx
dt = f (x, t)
(21.2)
tells us that at time t = s, the rate of change of x(t) is f (x(s), s). If the timestep h
is small enough for us to assume that this derivative changes little between t = s
201

202
21 Euler’s method
0
1
2
3
4
5
6
0
0.2
0.4
0.6
0.8
1
1.2
1.4
x
t
Fig. 21.1. The curve shows a notional ‘true solution’, and the crosses show the
result of numerically approximating the solution at a discrete set of values of t.
s
s + h
x(s)
x(s + h)
x(s) + hf(x(s),s)
Fig. 21.2. Euler’s method. The curve represents the exact solution x(t), the bold
line has slope f (x(s), s), and the cross gives the Euler approximation to x(s + h)
given x(s).
and t = s + h, then we can pretend that ˙x(t) is actually constant over this interval,
and so we can make the approximation
x(s + h) ≈x(s) + h f (x(s), s).
(21.3)
The effect of doing this is shown in Figure 21.2.

21.2 An example
203
The expression in (21.3) is also what you would get from keeping only the ﬁrst
two terms in the Taylor expansion of x near time t = s,
x(s + h) ≈x(s) + h ˙x(s) = x(s) + h f (x(s), s),
since ˙x(s) = f (x(s), s) (see Appendix C).
In order to have a more compact notation, we can write tn = nh and xn = x(tn).
The approximation in (21.3) then gives rise to Euler’s method of numerical solu-
tion,
xn+1 = xn + h f (xn, tn)
with
x0 = x(0).
(21.4)
This is a simple example of a difference equation, where the continuous vari-
able (t) has been replaced by a discrete index (n). We will treat difference equa-
tions more systematically in the next chapter, but for now we will consider the
application of Euler’s method to some simple examples.
21.2 An example
Because Euler’s method is so simple, it is possible to apply it ‘by hand’. Suppose
that we want to approximate the solution of
dx
dt = t −x2
x(0) = 0,
(21.5)
at time t = 2. This is an equation whose solution cannot be found explicitly, hence
the need for a numerical method. An accurate numerical value of x(2) is x(2) =
1.1936 (correct to 4 decimal places), and we will try to reproduce this with Euler’s
method.
Using the method with a timestep h = 1 we have tn = n, xn = x(n), and
xn+1 = xn + h f (xn, tn)
= xn + h

tn −x2
n

= xn +

n −x2
n

.
So we have
x1 = x0 +

0 −x2
0

= 0
x2 = x1 +

1 −x2
1

= 1,
which gives the value x(2) ≃x2 = 1. That this approximation is not very accu-
rate is unsurprising, since we have assumed that the derivative of x(t) is constant
between t = 0 and t = 1, and between t = 1 and t = 2.

204
21 Euler’s method
However, we can do much better if we use the timestep h = 1/2. In this case we
have tn = n/2, xn = x(n/2), and
xn+1 = xn + h f (xn, tn)
= xn + h

tn −x2
n

= xn + 1
2
n
2 −x2
n

.
So we have
x1 = x0 + 1
2

0 −x2
0

= 0
x2 = x1 + 1
2
1
2 −x2
1

= 0 + 1
2
1
2 −02
= 1
4
x3 = x2 + 1
2

1 −x2
2

= 1
4 + 1
2

1 −1
16

= 23
32
x4 = x3 + 1
2
3
2 −x2
3

= 23
32 + 1
2
3
2 −
23
32
2
= 23
32 + 1
2
3
2 −529
1024

= 23
32 + 1007
2048
= 834
689.
The ﬁnal stage here, x4 = 834/689 ≃1.2104, is our approximation to x(2), and
signiﬁcantly more accurate than the result for h = 1.
Although this is already slightly beyond the limit of what is comfortable to
calculate by hand, a computer can happily apply the method with much smaller
timesteps. As the timestep is made smaller, the distance between successive times
decreases. As this happens the assumption that ˙x is constant between times tn and
tn+1 becomes more and more accurate, and so the approximation to x(t) becomes
better and better. Figure 21.3 shows the approximations of the true solution of
(21.5) for various values of h over the time interval 0 ≤t ≤2.
It appears that the Euler method has served us extremely well, even with the
relatively large timestep h = 1/2. However, if we try to use this method to ap-
proximate the solution on a longer time interval, say 0 ≤t ≤11, then Figure 21.4
shows that we can start to run into problems. The Euler method continues to ap-
proximate the solution extremely well until around t = 8, but then the errors begin
to accumulate and the numerical solutions starts to oscillate wildly, while the true
solution continues to increase relatively gently.
21.3 *MATLAB implementation of Euler’s method
Euler’s method is easy to implement computationally. The MATLAB code re-
quired to apply the method to equation (21.5) is given below (and is available as
euler.m on the web). Also included are two commands to plot the numerical
results graphically, as in Figures 21.3 and 21.4.

21.3 *MATLAB implementation of Euler’s method
205
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
t
x
Fig. 21.3. The solution of equation (21.5) as calculated by Euler’s method, for
h = 1, h = 1/2, h = 1/4, h = 1/8; the numerical values are marked by crosses.
Also shown is the ‘exact solution’ in bold. (This ‘exact solution’ is in fact the
result of Euler’s method with h = 2−10.)
0
2
4
6
8
10
12
0
0.5
1
1.5
2
2.5
3
3.5
4
t
x
Fig. 21.4. The solution of equation (21.5) as calculated by Euler’s method with
h = 1/2. As before the numerical values are marked by crosses, and the exact
solution is shown in bold.

206
21 Euler’s method
%% Euler’s method
T=2;
%% final time
h=0.5;
%% timestep
%% MATLAB does not allow an index 0
%% on a vector, so x_n is x(n+1) here
t(1)=0;
%% initial time
x(1)=0;
%% initial condition
for n=1:T/h;
t(n+1)=n*h;
x(n+1)=x(n) + h * (t(n)-x(n)ˆ2);
end
[t x]
%% display values
%% Plot crosses at numerical values, and join these
plot(t,x,’x’,’MarkerSize’,20)
hold on
plot(t,x)
This program outputs the following values:
t =
0
0.5000
1.0000
1.5000
2.0000
x =
0
0
0.2500
0.7188
1.2104
and produces the graph of Figure 21.5.
21.4 Convergence of Euler’s method
We can investigate how Euler’s method behaves when we make the timestep
smaller if we apply the method to an equation whose solution we already know.
In this case we can more easily compare our approximate numerical solution with
the exact solution.

21.4 Convergence of Euler’s method
207
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
1.8
2
0
0.2
0.4
0.6
0.8
1
1.2
1.4
Fig. 21.5. The graph produced by the MATLAB code of Section 21.3.
We will apply the method to the simple linear equation
dx
dt = x
with
x(0) = 1,
for which we know the exact solution x(t) = et.
If we use a timestep h then tn = nh, xn = x(nh), and Euler’s method gives
xn+1 = xn + hxn = (1 + h)xn
with
x0 = 1.
It is easy to ﬁnd the solution of this equation, since
x1 = (1 + h)x0 = (1 + h)
x2 = (1 + h)x1 = (1 + h)(1 + h) = (1 + h)2
x3 = (1 + h)x2 = (1 + h)(1 + h)2 = (1 + h)3,
and so in general1 xn = (1 + h)n.
Since xn is an approximation to x(nh), the approximation we obtain for x(t) is
xt/h (where we assume that t/h is an integer),
x(t) ≃(1 + h)t/h .
Since t = nh we can replace h by t/n, and so
x(t) ≃

1 + t
n
n
.
1 This can be checked using induction. The induction hypothesis is that xn = (1 + h)n. Assuming that this is
true for n = m, it follows that xm+1 = (1 + h)xm = (1 + h)(1 + h)m = (1 + h)m+1, and so the hypothesis
holds for n = m + 1. Since x0 = (1 + h)0 = 1, induction shows that this is the correct solution.

208
21 Euler’s method
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1
1.2
1.4
1.6
1.8
2
2.2
2.4
2.6
2.8
t
x
Fig. 21.6. The bold line is the exact solution x(t) = et, while the other lines show
the results of the Euler method with successively smaller values of h, from h = 1
to h = 1/32, with crosses marking the numerical values.
If we keep x ﬁxed and let h →0 then since n = t/h we need to let n →∞. A
standard result from analysis (see Exercise 21.4) guarantees that

1 + t
n
n
→et
(21.6)
as n →∞, and so as the timestep is reﬁned our numerical approximation does
tend to the exact solution. This is illustrated in Figure 21.6, which shows the exact
solution and the solution obtained using Euler’s method with various values of h.
Although we have shown that the Euler method works for this particular exam-
ple, if it is to be a truly reliable method then we should have a proof that whatever
the equation, if the timestep is small enough then the numerical solution will be a
good approximation. The mathematical discipline of numerical analysis deals with
such problems. For example, suppose that f (x) is a function that satisﬁes2
| f (x) −f (y)| ≤L|x −y|
for some constant L, and x(t) is the exact solution of
dx
dt = f (x)
x(0) = y0.
2 This condition, that f be a Lipschitz function, is in fact what is required to ensure that the equation ˙x = f (x)
has unique solutions, see equation (6.5).

Exercises
209
Now, if xn is the solution of the Euler method
xn+1 = xn + h f (xn)
with
x0 = y0
then xn should approximate x(tn) (where tn = nh). Writing ˜x(tn) for xn, given any
T > 0 it is possible to prove the error estimate
max
0≤tn≤T |˜x(tn) −x(tn)| ≤Kh,
(21.7)
for some constant K (depending on T ). This says that as h is made smaller, the er-
ror between the approximation and the true solution can be guaranteed to decrease
over the whole time interval.
Because the Euler method is relatively simple, as h is made smaller the error
decreases fairly slowly; halving h will only halve the error. Numerical methods
that are used in practice generally have much better error properties. One popular
method is the Runge–Kutta scheme, where
xn+1 = xn + h
6( f1 + 2 f2 + 2 f3 + f4)
with f1, . . . , f4 given by
f1 = f (xn, tn)
f2 = f

xn + 1
2h f1, tn + 1
2h

f3 = f

xn + 1
2h f2, tn + 1
2h

f4 = f (xn + h f3, tn + h).
Although this method appears much more complicated, implementing such a
scheme computationally is fairly straightforward, and now the error satisﬁes
max
0≤tn≤T |˜x(tn) −x(tn)| ≤Kh4.
This means that halving the timestep will increase the accuracy of the method by
a factor of 16. MATLAB’s ode45 routine uses a reﬁned version of this method.
Exercises
21.1 Apply Euler’s method to the general linear equation ˙x = λx. Find the approximation
xn, and using (21.6) show that as h →0 the numerical solution converges to the true
solution.
21.2 There are variants of the Euler method that have the advantage of better stability prop-
erties, but have the disadvantage of no longer being explicit schemes. For example,
the backwards Euler method is
xn+1 = xn + h f (xn+1, tn+1),

210
21 Euler’s method
which has to be solved at each stage to ﬁnd xn+1 in terms of xn. Apply this method
to the linear equation ˙x = x, and show that once again the method converges to the
true solution x(t) = et as t →∞.
21.3 Another variant of the standard Euler method is the trapezoidal Euler method. If x(t)
is the solution of ˙x = f (x, t) then we have
x(t + h) = x(t) +
 t+h
t
f (x(s), s) ds.
Use the trapezium rule to approximate the integral to derive this scheme,
xn+1 = xn + h
* 1
2 f (xn, tn) + 1
2 f (xn+1, tn+1)
+
.
21.4 (T) Since (d/dx)ex = ex, if we calculate the derivative of ex at x = 0 as a limit it
follows that
lim
h→0
eh −1
h
= 1.
By rearranging this (note that 1 = limh→0 1) show that
e = lim
h→0(1 + h)1/h,
and hence that
ex = lim
n→∞

1 + x
n
1/n
.
(Hint: if
lim
h→0 f (h) = lim
h→0 g(h) = y,
and κ(x) is continuous at x = y, then
lim
h→0 κ[ f (h)] = lim
h→0 κ[g(h)].
You will need to use this once for each step.)
21.5 (T) In this question we suppose that f satisﬁes the Lipschitz condition
| f (x) −f (y)| ≤L|x −y|
and consider the Euler θ-method for approximating solutions of ˙x = f (x),
xn+1 = xn + h[(1 −θ) f (xn) + θ f (xn+1)].
For θ = 0 this is the standard Euler method; for θ = 1
2 this is the trapezoidal method;
and for θ = 1 this is the ‘backwards Euler’ method. Since xn+1 is not given explicitly
as a function of xn+1, we need a reliable way of calculating it numerically.
(i) The ﬁrst thing we must check is that there is a unique solution for xn+1. Suppose
that
y = xn + h[(1 −θ) f (xn) + θ f (y)]
and
z = xn + h[(1 −θ) f (xn) + θ f (z)],

Exercises
211
i.e. that both y and z satisfy the equation. By subtracting these two equations
show that
y −z = θh[ f (y) −f (z)],
and hence deduce that
|y −z| ≤hLθ|y −z|,
and therefore that y = z provided that h < 1/Lθ.
(ii) Suppose therefore that h < 1/Lθ. Given an initial guess y0 for xn+1, we can
reﬁne this guess successively by setting
y j+1 = xn + h[(1 −θ) f (xn) + θ f (y j)];
(E21.1)
if y j+1 = y j = y then
y = xn + h[(1 −θ) f (xn) + θ f (y)],
and so y would be the required value for xn+1. Show that
|y j+1 −y j| ≤hLθ|y j −y j−1|,
(E21.2)
and hence that successive values of y j are closer together. Thus, for large j, we
would expect that y j+1 ≈y j and that y j is a good approximation to xn+1.
(iii) Still assuming that h < 1/Lθ, use (E21.2) to show that
|y j+1 −y j| ≤(hLθ) j|y1 −y0|,
and hence that
|y j −yk| ≤(hLθ)J
1 −hLθ |y1 −y0|
for any j, k ≥J.
It follows that {y j} is a Cauchy sequence, and so converges to a limit y. Taking limits
as j →∞on both sides of (E21.1) we get
y = x + 1
2h[ f (xn) + f (y)],
and thus xn+1 = y.
21.6 (C) For a number of values of t and h compare the exact solution of ˙x = x with the
solution from Euler’s method, and verify the error estimate in (21.7).
21.7 (C) Implement the backwards Euler scheme of Exercise 21.2 numerically, and apply
it to the equation ˙x = x(1 −x) to ﬁnd the solution when x(0) = 1
2 for 0 ≤t ≤8. In
order to ﬁnd xn+1 given xn you can use the approach of Exercise 21.5, and iterate
gk+1 = xn + hgk(1 −gk)
to give a succession of ‘guesses’ gk for xn+1 until gk appears to stabilise (e.g. un-
til |gk+1 −gk| < h3). You will need to choose h carefully to ensure that your se-
quence of guesses converges. (Can you work out, using the theoretical results of

212
21 Euler’s method
Exercise 21.5, what value of h should sufﬁce?) The MATLAB M-ﬁle backeuler.m,
implementing this scheme, can be downloaded from the web.
21.8 (C) Write a MATLAB program to implement the Runge–Kutta method introduced at
the end of the chapter. Apply this method to ˙x = t −x2 when h = 0.5, and compare
this to the solution obtained using Euler’s method with the same timestep. (You can
download the MATLAB M-ﬁle rungekutta.m from the web if you wish.)

22
Difference equations
It is not only for numerical approximations that it is more appropriate to have an
independent variable that only takes discrete values. For example, an experiment
may take measurements at equally spaced time intervals, we may be interested in
the size of a population in successive generations, or perhaps we want to compare
the value of the Financial Times index of the top one hundred UK shares (the
FTSE) at the end of trading on a sequence of successive days (see Figure 22.1). In
all these cases, it is much more natural to have a dependent variable indexed by n,
where n is an integer (xn), than a continuous function of t.
An equation that relates the values of xn for different values of n is called a
difference equation, and the order of a difference equation is the largest difference
between any two of the indices (attached to x) occurring in the equation, i.e. Euler’s
method
xn+1 = xn + h f (xn, nh)
is a ﬁrst order difference equation, as is
xn+1 = 2n+7 + cos xn
(the n + 7 is not an index of x), while
xn+2 = x2
n+1 −exp(xn−3)
is ﬁfth order. We have already seen some examples of difference equations in
the recurrence relations for the coefﬁcients in our power series expansions in
Chapter 20.
22.1 First order difference equations
A ﬁrst order difference equation relates the ‘next’ value of x and its current value,
F(xn, xn+1, n) = 0.
213

214
22 Difference equations
19
20
21
24
25
26
27
28
31
1
2
3
4
7
8
9
10
11
14
3600
3650
3700
3750
3800
3850
3900
3950
FTSE index
March
April
Fig. 22.1. The FTSE index during the period of the second Gulf War, from the
start of hostilities on the evening of 19 March 2003 until the fall of Tikrit on
14 April 2003. The data consists of the values marked by crosses; these are joined
by a dotted line to make the trends easier to follow.
We will only consider here1 equations in which xn+1 can be given explicitly in
terms of xn,
xn+1 = f (xn, n).
For such equations we do not need a theorem to show us that there is a unique
solution, since we have a ﬁxed rule by which we can construct the solution. In
this chapter we consider only linear difference equations, and turn to nonlinear
difference equations in the next chapter.
If we consider a simple linear difference equation
xn+1 = kxn
and suppose that we know x0 then it is simple to ﬁnd xn for any n. We have
x1 = kx0,
x2 = kx1 = k(kx0) = k2x0,
x3 = kx2 = k(k2x0) = k3x0,
and it is easy to see that in general xn = knx0 (we did something very similar in
Section 21.4 of the previous chapter).
The analysis of second order linear difference equations that we will now pursue
is entirely analogous to that of second order linear differential equations, except
1 There are very natural difference equations for which this in not the case. For example, the ‘backwards Euler
method’, which has nicer properties than the Euler method introduced in the previous chapter, is
xn+1 = xn + h f (xn+1).
This ‘implicit’ scheme has to be solved for xn+1 at every timestep as in Exercise 21.5.

22.2 Second order difference equations
215
that the exponential function x(t) = ekt (the solution of ˙x = kx) that we used for
differential equations is now replaced by xn = kn (the solution of xn+1 = kxn).
22.2 Second order difference equations: complementary function
and particular solution
We will concentrate now on linear second order difference equations,
xn+2 + axn+1 + bxn = fn,
(22.1)
although the techniques that we will introduce extend easily to higher orders.
Just as we could split the problem of solving a linear second order differential
equation into ﬁnding the complementary function and then a particular integral, we
can split the problem of solving (22.1) into ﬁnding a solution of the corresponding
homogeneous problem
yn+2 + ayn+1 + byn = 0,
(22.2)
and then of ﬁnding one particular solution xn of (22.1).
22.3 The homogeneous equation
First we deal with the homogeneous equation,
axn+2 + bxn+1 + cxn = 0.
(22.3)
We guess that the solution is of the form xn = kn, just as we guessed a solution of
the form x(t) = ekt for the second order differential equation a ¨x + b ˙x + cx = 0.
Trying xn = kn in (22.3) we get
akn+2 + bkn+1 + ckn = 0,
and cancelling kn then gives the auxiliary equation
ak2 + bk + c = 0.
We obtain a quadratic equation for k, and the form of solution for (22.2) will
depend on the nature of its roots.
22.3.1 Distinct real roots
If the auxiliary equation has two distinct real roots k1 and k2 then xn = kn
1 and
xn = kn
2 are both solutions of (22.3), and so the general solution is
xn = Akn
1 + Bkn
2.

216
22 Difference equations
Particular values of x0 and x1 will enable us to determine the constants A and B.
As an example, we ﬁnd an expression for the nth Fibonacci number. These are
the numbers that satisfy
xn = xn−1 + xn−2,
(22.4)
and start with x0 = 1 and x1 = 1. The ﬁrst few are
1
1
2
3
5
8
13
21
34
55
. . .
These numbers crop up frequently in nature, and have fascinated artists for hun-
dreds of years. A modern example is shown in Figure 22.2.
Fig. 22.2. Mario Merz’ ‘Fibonacci Sequence 1–55’ on the chimney of the power
station in Turku, Finland. Photograph by Dr Ching-Kuang Shene of Michigan
Technological University, and reproduced with his kind permission.

22.3 The homogeneous equation
217
To solve (22.4) we try xn = kn, and ﬁnd
k2 = k + 1.
This equation has roots
k = 1 ±
√
5
2
,
so that the general solution of (22.4) is
xn = α

1 +
√
5
2
n
+ β

1 −
√
5
2
n
.
The initial conditions require
α + β = 1
(1 +
√
5)α + (1 −
√
5)β = 2,
and thus, solving for α and β,
α = 1 +
√
5
2
√
5
β =
√
5 −1
2
√
5
.
The nth Fibonacci number is therefore given by
xn =
1
√
5

1 +
√
5
2
n+1
−1
√
5

1 −
√
5
2
n+1
.
(22.5)
It is somewhat surprising that this formula always gives an integer. Since the sec-
ond term is always smaller than 1/
√
5 ≈0.4472, we can also write
xn =

1
√
5

1 +
√
5
2
n+1		
,
where [[x]] denotes the nearest integer to x.
22.3.2 Repeated roots
If the auxiliary equation has a repeated real root k, then we have a similar problem
to the one we had when considering second order differential equations, since
we will only obtain a single solution xn = kn. Thankfully the resolution of this
difﬁculty is also similar: we introduce the extra factor of n where before we had
an extra factor of t. The general solution is therefore
xn = Akn + Bnkn.

218
22 Difference equations
To check that this second solution is correct we will substitute it into
xn+2 −2kxn+1 + k2xn = 0,
since any second order linear difference equation whose auxiliary equation has k as
a repeated root can be rewritten in this form (see Exercise 22.2). Trying xn = nkn
in the left-hand side gives
(n + 2)kn+2 −2k(n + 1)kn+1 + k2nkn = (n + 2 −2(n + 1) + n)kn+2 = 0
as required.
Example 22.1 Find the general solution of
xn −4xn−1 + 4xn−2 = 0.
Trying xn = kn yields the auxiliary equation
k2 −4k + 4 = 0,
so that k = 2 ‘twice’. The general solution is therefore
xn = α2n + βn2n.
22.3.3 Complex roots
We can also have complex roots, for which things are a little more involved. If we
have k = a ± ib, then we need to write k in modulus and argument form,
k = re±iθ,
where
r2 = a2 + b2
and
θ = tan−1(b/a)
(see Appendix A). Then the solution is
xn = rn[A cos nθ + B sin nθ].
To see that this solution is consistent with our guess xn = kn, ﬁrst write
xn = C[reiθ]n + C∗[re−iθ]n,
where we take the coefﬁcients to be C = α + iβ and C∗(its complex conjugate)
to ensure that xn is real. This gives
xn = rn[Ceinθ + C∗e−inθ].

22.4 Particular solutions
219
Since z∗+ z = 2 Re(z), and
Ceinθ = (α + iβ)(cos nθ + i sin nθ)
= (α cos nθ −β sin nθ) + i(β cos nθ + α sin nθ),
we get
xn = rn[A cos nθ + B sin nθ]
if we take A = 2α and B = −2β.
Example 22.2 Find the general solution of the difference equation
xn+2 −2xn+1 + 2xn = 0.
Trying xn = kn gives the quadratic equation
k2 −2k + 2 = 0,
and so
k = 2 ±
√
4 −8
2
= 1 ± i.
Since
1 ± i =
√
2e±i/4
the solution is
xn = 2n/2[A cos(n/4) + B sin(n/4)].
22.4 Particular solutions
When we have an equation with a non-zero right-hand side,
axn+2 + bxn+1 + cxn = fn,
we use the same method that we had for differential equations, i.e. we guess the
form of the particular solution and then substitute in to determine the constants in
our guess.
22.4.1 Right-hand side fn is a polynomial in n
When the right-hand side is a polynomial depending on n the appropriate ‘guess’
for a particular solution is a general polynomial of the same order as the right-hand
side. If our guess solves the homogeneous problem then we have to multiply by an
additional factor of n.

220
22 Difference equations
We start with a simple ﬁrst order example.
Example 22.3 Find the general solution of
xn+1 = kxn + a.
The solution of the homogeneous equation
yn+1 = kyn,
is yn = Akn. To ﬁnd a particular solution we can try xn = c and then we require
c = kc + a,
so we take c = a/(1 −k) and obtain the general solution
xn = Akn + a/(1 −k).
Example 22.4 Find the general solution of
xn −xn−1 −6xn−2 = −36n.
First we solve the homogeneous equation yn −yn−1 −6yn−2 = 0 by trying
yn = kn; we need k to solve the equation
k2 −k −6 = 0
⇒
(k −3)(k + 2) = 0,
and so the complementary function is yn = A3n + B(−2)n. For the particular so-
lution we try a general ﬁrst order polynomial in n, xn = αn + β. Substituting in
we get
αn + β −(α(n −1) + β) −6(α(n −2) + β) = −6αn + 13α −6β.
So we need α = 6 and β = 13 which gives the particular solution xn = 6n + 13;
the general solution is therefore
xn = A3n + B(−2)n + 6n + 13.
Example 22.5 Find the general solution of
xn+1 −2xn + xn−1 = 8.
To solve the homogeneous equation yn+1 −2yn + yn−1 = 0 we try yn = kn and
obtain the auxiliary equation
k2 −2k + 1 = 0.
This equation has the repeated root k = 1, and so the complementary function is
yn = A + Bn.

22.4 Particular solutions
221
We cannot try xn = c for our particular solution (A is part of the complementary
function), nor can we try xn = cn (since Bn is also part of the complementary
function), so we have to try xn = cn2. Then we need
c(n + 1)2 −2cn2 + c(n −1)2 = c[n2 + 2n + 1 −2n2 + n2 −2n + 1] = 2c = 8,
i.e. c = 4. So a particular solution is xn = 4n2, and the general solution is
xn = 4n2 + A + Bn.
22.4.2 Right-hand side fn = λn
This case is similar to having an exponential on the right-hand side of a differential
equation. If λ is not a solution of the auxiliary equation we try xn = αλn; if λ is
a non-repeated root of the auxiliary equation we try xn = αnλn, while if λ is a
repeated root we have to try xn = αn2λn.
Example 22.6 Find the general solution of the equation
xn+2 + xn+1 −6xn = 12(−2)n.
To ﬁnd the solution of the homogeneous equation yn+2 + yn+1 −6yn = 0 we
try yn = kn and obtain the auxiliary equation
k2 + k −6 = 0
⇒
(k + 3)(k −2) = 0,
so that k = 2 or k = −3 and the complementary function is
yn = A2n + B(−3)n.
Since (−2)n is not a solution of the homogeneous equation we can try xn =
α(−2)n for a particular solution; we need
α(−2)n+2 + α(−2)n+1 −6α(−2)n = 12(−2)n.
Cancelling a factor of (−2)n we require
(−2)2α + (−2)α −6α = 12,
or α = −3. So a particular solution is xn = −3(−2)n, and the general solution is
xn = A2n + B(−3)n −3(−2)n.
Example 22.7 Find the general solution of the equation
xn+2 + xn+1 −6xn = 30 × 2n.
We found the complementary function above, yn = A2n + B(−3)n. Since the
right-hand side occurs in the complementary function we have to try xn = αn2n

222
22 Difference equations
for a particular integral. Substituting in we need
α(n + 2)2n+2 + α(n + 1)2n −6αn2n = 30 × 2n,
or, cancelling a factor of 2n,
α[4(n + 2) + 2(n + 1) −6n] = 10α
=
30.
So α = 3; a particular solution is xn = 8n2n, and the general solution is
xn = A2n + B(−3)n + 3n2n.
Exercises
22.1 Find the solutions of the following difference equations satisfying the given initial
conditions.
(i) xn+2 −4xn+1 + 3xn = 0 with x0 = 0 and x1 = 1;
(ii) 2xn+1 −3xn −2xn−1 = 0 with x1 = x2 = 1;
(iii) xn+2 = 2xn+1 −2xn with x0 = 1 and x1 = 2;
(iv) xn+2 + 6xn+1 + 9xn = 0 with x0 = 1 and x1 = 6;
(v) 2xn = 3xn−1 −xn−2 with x0 = 3 and x1 = 2; and
(vi) xn+2 −2xn+1 + 5xn = 0 with x0 =
√
5 and x1 = 5 cos tan−1 2.
22.2 Show that if the auxiliary equation
ak2 + bk + c = 0
has a repeated root k = λ then the difference equation
axn+2 + bxn+1 + cxn = 0
can be rewritten in the form
xn+2 −2λxn+1 + λ2xn = 0.
22.3 The ‘golden ratio’ is the ratio (greater than one) of the sides of a rectangle with the
following property: remove a square whose sides are the length of the shorter side of
the rectangle, and the remaining rectangle is similar to the original one (its sides are in
the same ratio), see Figure 22.3. This ratio was used by the Greeks in constructing the
Parthenon (among many other monuments), and has been a favourite tool of artists
ever since.
Suppose that {xn} is a sequence of numbers satisfying the recurrence relation
xn+2 = xn+1 + xn.
Show that if all the elements of the sequence are integers then the ratio of consecutive
terms, xn+1/xn, converges to the golden ratio. Show that the same result is true if
all the terms in the sequence have the same sign. (In particular this is true for the
Fibonacci numbers, which have x0 = 0 and x1 = 1.)

Exercises
223
Remove
this
square
Fig. 22.3. The golden rectangle.
22.4 Find the general solution of the following difference equations, and then ﬁnd the
solution that satisﬁes the speciﬁed initial conditions.
(i) xn+2 −4xn = 27n2, with x0 = 1 and x1 = 3;
(ii) xn+1 −4xn + 3xn−1 = 36n2, with x0 = 12 and x1 = 0;
(iii) xn+1 −4xn + 3xn−1 = 2n, with x0 = −4 and x1 = −6;
(iv) xn+1 −4xn + 3xn−1 = 3n, with x0 = 2 and x1 = 13/2;
(v) xn+2 −2xn+1 + xn = 1, with x0 = 3 and x1 = 6;
(vi) xn+2 + xn = 2n, with x0 = x1 = 0;
(vii) xn+2 + xn+1 + xn = c (the general solution is enough here).
22.5 Find the solution of the difference equation
xn+1 = xn(1 + xn)
with x1 = 1. Now show that if x1 = c then
xn = c  (c + n)
 (c + 1)
where the  function, which was deﬁned in Exercise 20.8, satisﬁes (x + 1) =
x(x).

23
Nonlinear ﬁrst order difference equations
In general the solutions of a nonlinear difference equation
xn+1 = f (xn)
(23.1)
can have very complicated behaviour. To ﬁnd the solution of such a difference
equation we have to iterate (apply repeatedly) the map f (‘map’ is just another
word for function, and is frequently used in this context). The solution is given by
the sequence of iterates
x0,
x1 = f (x0),
x2 = f ( f (x0)),
x3 = f ( f ( f (x0))),
. . . ,
called the ‘orbit’ of x0. Since these nested f s rapidly become unmanageable we
adopt the notation f n(x) to mean f applied n times to x,
f n(x) = f ( f ( f (· · · f



n times
(x) · · ·))).
We can write the ‘solution’ of (23.1) that has x0 = y0 as xn = f n(y0), but this is
clearly no more descriptive of the solution than (23.1) itself.
23.1 Fixed points and stability
In order to describe the dynamics of solutions we make use of similar concepts as
we used in Chapter 7 for the one-dimensional dynamical systems that arise from
autonomous differential equations. In particular it is often useful to concentrate on
what happens to solutions ‘eventually’.
For an iterated map such as (23.1) a ﬁxed point is a point x∗such that
f (x∗) = x∗,
so that if xn = x∗then xn+1 = x∗. (The ﬁxed points of xn+1 = f (xn) are analo-
gous to the ‘stationary points’ of ˙x = f (x).)
224

23.2 Cobweb diagrams
225
We describe a ﬁxed point as stable if you stay close to it provided that you start
sufﬁciently near: x∗is stable if for any ϵ > 0 there exists a δ > 0 such that
|x0 −x∗| < δ



start near
⇒
| f n(x0) −x∗| < ϵ
for all
n = 0, 1, 2, . . .



stay near
.
Again, we can also introduce the related but distinct concept of being attracting
(‘start near tend to’): x∗is attracting if there is a δ > 0 such that
|x0 −x∗| < δ



start close enough
⇒
f n(x0) →x∗
as
n →∞



tend to
.
Negating ‘stable’ we get unstable: x∗is unstable if there exists an ϵ such that no
matter how small we make δ, we can ﬁnd an x0 with
|x0 −x∗| < δ
but
| f n(x0) −x∗| > ϵ
for some n > 0.
In order to discover analytically whether or not a ﬁxed point is stable, suppose
that xn = x∗+ δn where δn is small; then, using a Taylor series expansion about
x = x∗,
xn+1 = f (x∗+ δn)
≈f (x∗) + f ′(x∗)δn
= x∗+ f ′(x∗)δn.
So if we write xn+1 = x∗+ δn+1 we have
δn+1 ≈f ′(x∗)δn.
(23.2)
The solution of (23.2) is δn = [ f ′(x∗)]nδ0, so it is clear that successive values
of δ j will decrease if | f ′(x∗)| < 1, and increase if | f ′(x∗)| > 1. So x∗is stable
and attracting if | f ′(x∗)| < 1, and unstable if | f ′(x∗)| > 1. (This can be made
rigorous, see Exercise 23.4.)
23.2 Cobweb diagrams
In order to work out what happens when we iterate f we can use a graphical
method which produces a picture known as a ‘cobweb diagram’. First we draw
the graph of f (x) against x, and then the graph of y = x. Now, given xn we can
ﬁnd xn+1 by drawing a line up to f (xn), then over to y = x, and back down to the
x-axis to give xn+1. To ﬁnd xn+2 we do the same, but starting at xn+1 – we start
now from the point on the diagonal, rather than the point on the x-axis, since this
simpliﬁes the picture – and so on. This is illustrated in Figure 23.1, for the example
f (x) = 3x(1 −x).

226
23 Nonlinear ﬁrst order difference equations
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
x1
x2
x3
x4
Fig. 23.1. The ﬁrst few steps of the ‘cobweb’ method for xn+1 = 3xn(1 −xn).
23.3 Periodic orbits
For any choice of x0, the linear difference equation
xn+1 = −xn
generates an orbit that ﬂips between the two values x0 and −x0. This is a simple
example of a periodic orbit of period 2, or more concisely a period 2 orbit. In
general if xn+1 = f (xn) then a periodic orbit of period 2 is a pair of values x1 and
x2 such that
f (x1) = x2
and
f (x2) = x1,
so that f 2(x1) = x1, see Figure 23.2.
A periodic orbit of period k (or a period k orbit) is a sequence of k values
{x1, . . . , xk} such that
f (x j) = x j+1
for
j = 1, . . . , n −1
and
f (xn) = x1,
so that iterates of x1 cycle around these k values for ever. (Strictly we also need to
make sure that f (x j) ̸= x1 for j = 1, . . . , n −1, so that k is the ‘minimal period’
of the orbit.) We will see several examples of such periodic orbits in the next
chapter.

23.4 Euler’s method for autonomous equations
227
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 23.2. A period 2 orbit for the map xn+1 = (1 +
√
5)xn(1 −xn). On the left
is the cobweb diagram, while the right-hand picture shows successive values of
xn against n.
23.4 Euler’s method for autonomous equations
In the remainder of this chapter we apply some of the above ideas in order to
understand how well the qualitative behaviour of the differential equation
dx/dt = f (x)
(23.3)
(which we studied in detail in Chapter 7) can be captured using the numerical
Euler method introduced in Chapter 21. Recall that the stationary points x∗of
(23.3) occur when f (x∗) = 0, and that they are stable if f ′(x∗) < 0 and unstable
if f ′(x∗) > 0.
If we apply the Euler method to (23.3) with a timestep h then we have
xn+1 = xn + h f (xn),
(23.4)
where xn is an approximation to x(tn) with tn = nh. We will write g(x) = x +
h f (x), so that (23.4) can be written more concisely as
xn+1 = g(xn).
The ﬁxed points of the map g are those x values x∗for which x∗= g(x∗),
i.e. for which
x∗= x∗+ h f (x∗).
This means that the ﬁxed points of g occur when f (x∗) = 0, i.e. they are the same
as the stationary points of the differential equation (23.3).
To determine the stability of the ﬁxed points we have to consider the modulus
of
g′(x) = 1 + h f ′(x).

228
23 Nonlinear ﬁrst order difference equations
A ﬁxed point at x∗will be unstable whenever
|g′(x∗)| > 1.
This happens when (i) f ′(x∗) > 0, or (ii) f ′(x∗) < 0 and h > 1/| f ′(x∗)|. In case
(i) the point x∗is an unstable stationary point for the differential equation, but case
(ii) says that although x∗is a stable stationary point for the differential equation,
the timestep h is too large to reproduce this stability property in the numerical
method.
On the other hand, a ﬁxed point at x∗is stable provided that
|g′(x∗)| < 1
which happens when f ′(x∗) < 0 and h < 1/| f ′(x∗)|. So x∗has to be a stable
stationary point of the differential equation and the timestep h has to be sufﬁciently
small.
It follows that the stationary points of a differential equation such as (23.3),
along with their stability properties, will be reproduced correctly by the Euler
method provided that h is small enough so that h < 1/| f (x∗)| for every stationary
point x∗.
We now look at these phenomena as they occur in a particular example.
23.4.1 An example
We will apply Euler’s method to the equation
dx/dt = x(k −x2)
with
k > 0,
(23.5)
which gives
xn+1 = xn + hxn(k −x2
n).
(23.6)
We will write f (x) = x(k −x2) and g(x) = x + hx(k −x2).
For k > 0 equation (23.5) has an unstable stationary point at the origin and
stable stationary points at x = ±
√
k, as shown in the phase diagram in Figure 23.3
(cf. Figure 7.13).
0
−√k
√k
Fig. 23.3. Phase diagram for equation (23.5).

Exercises
229
0
1
2
3
4
5
0
1
2
3
4
5
6
0
1
2
3
4
5
0
1
2
3
4
5
6
Fig. 23.4. Euler’s method applied to ˙x = x(16 −x2) with h = 0.1 and initial
conditions x0 = 4 and x0 = 5. The timestep is too large to preserve the correct
stability properties of the point x = 4. [In this and the following three ﬁgures, the
left-hand side shows successive values of xn against n, while the right-hand side
shows the cobweb diagram of the same orbit.]
The Euler scheme has ﬁxed points at 0, −
√
k, and
√
k, and their stability is
determined by the size of
|g′(x)| = |1 + h(k −3x2)|.
Since we have
|g′(0)| = 1 + kh
and
|g′(±
√
k)| = |1 −2hk|,
the ﬁxed point at the origin is always unstable, while the ﬁxed points at x = ±
√
k
are stable if h < 1/k and unstable if h > 1/k.
We now ﬁx k = 16 and choose three values for h, concentrating on the be-
haviour of positive solutions. First, if h = 0.1 then h = 0.1 > 1/16 = 1/k, and
the ﬁxed point at x = 4 is unstable. The successive values of xn, along with the
cobweb diagram, are shown in Figure 23.4.
If we decrease h a little to h = 0.065, then it is still greater than 1/16. Fig-
ure 23.5 shows that the orbit has settled down to a period 2 orbit rather than to the
ﬁxed point.
If we now reduce h so that it is less than 1/16 then we would expect x = 4 to be-
come stable. Figure 23.6 shows the results of the method with h = 0.06. Although
the ﬁxed point at x = 4 is now stable, the sequence xn oscillates about x = 4 as it
converges. This is in contrast to the behaviour of the differential equation, where
x(t) would approach x = 4 monotonically.
Finally, Figure 23.7 shows the result of the method when h = 0.01. The timestep
is now small enough so that the Euler method yields a very good approximation to
the solution of the ordinary differential equation.

230
23 Nonlinear ﬁrst order difference equations
0
5
10
15
2
2.5
3
3.5
4
4.5
5
0
1
2
3
4
5
0
1
2
3
4
5
6
Fig. 23.5. Euler’s method applied to ˙x = x(16 −x2) with h = 0.065. The solu-
tion has ended up switching between two values of x on a period 2 orbit.
0
2
4
6
8
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
1
2
3
4
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Fig. 23.6. Euler’s method applied to ˙x = x(16 −x2) with h = 0.06 and initial
conditions x0 = 4 and x0 = 5. The timestep is small enough so that x = 4 is sta-
ble, but solutions oscillate as they approach this ﬁxed point.
Exercises
23.1 Show that there is an orbit of period 3 containing the point x = 1 for the difference
equation
xn+1 = 14
3 x2
n −13
2 xn + 7
3.
23.2 Suppose that the differential equation ˙x = f (x) has a stationary point x∗where
f ′(x∗) < 0. We saw that the point x∗is a stable ﬁxed point for
xn+1 = xn + h f (xn),

Exercises
231
0
5
10
15
20
25
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
1
2
3
4
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Fig. 23.7. Euler’s method applied to ˙x = x(16 −x2) with h = 0.01 and initial
conditions x0 = 1, x0 = 4 and x0 = 5. The timestep is small enough so that the
method approximates the solution of the differential equation very well. (Two
orbits in addition to the ﬁxed point are now shown in both diagrams.)
provided that h < 1/| f ′(x∗)|. Assuming that x0 is sufﬁciently close to x∗, show that
if h > 1/(2| f ′(x∗)|) then xn is alternately greater than and less than x∗, while if
h < 1/(2| f ′(x∗)|) the orbit xn approaches x∗monotonically.
23.3 In this question we consider the trapezoidal Euler method
xn+1 = xn + 1
2h[ f (xn) + f (xn+1)].
Show that xn+1 = xn = x∗if and only if f (x∗) = 0, i.e. that the ﬁxed points of the
numerical scheme coincide with the stationary points of the differential equation ˙x =
f (x).
Using the chain rule show that
dxn+1
dxn
=
1 + 1
2h f ′(xn)
1 −1
2h f ′(xn+1)
,
and hence that a ﬁxed point x∗is stable if f ′(x∗) < 0 and unstable if f ′(x∗) > 0,
i.e. that whatever the timestep the stability coincides with that of the corresponding
stationary point in the differential equation.
23.4 (T) It follows from the deﬁnition of the derivative that
f (x∗+ h) = f (x∗) + f ′(x∗)h + o(h),
where o(h) indicates that the remainder terms satisfy
o(h)
h
→0
as
h →0.
In particular, given ϵ > 0 there exists a δ > 0 such that
|o(h)| ≤ϵh

232
23 Nonlinear ﬁrst order difference equations
for all |h| ≤δ. Use this to show rigorously that a ﬁxed point x∗of xn+1 = f (xn) is
stable if | f ′(x∗)| < 1 and unstable if | f ′(x∗)| > 1. (Recall that a ﬁxed point x∗is
stable if given an ϵ > 0 there exists a δ > 0 such that whenever |x0 −x∗| < δ we
have | f n(x0) −x∗| < ϵ for all n = 0, 1, . . . . In fact you should be able to show that
when | f ′(x∗)| < 1 the ﬁxed point is attracting.)
23.5 (T) Suppose that f has a periodic orbit of period k consisting of the points
{x1, . . . , xk}. Show that each of the points on the orbit is a ﬁxed point for the map
g(x) = f k(x).
A periodic orbit is said to be stable if each point on the orbit is a stable ﬁxed
point of f k. Show that a periodic orbit {x1, x2} of period 2 is stable provided that
| f ′(x1) f ′(x2)| < 1,
and that a periodic orbit {x1, . . . , xk} of period k is stable provided that
| f ′(x1) f ′(x2) · · · f ′(xk−1) f ′(xk)| < 1.
Note in particular that if one point on the orbit is a stable ﬁxed point of f k then so
are all the others.
23.6 (T) Consider the iterated map
yn+1 = f (yn) = ryn + y2
n
for r ≤0. Find the two ﬁxed points, and show that the ﬁxed point at y = 0 is stable
for −1 < r ≤0 and unstable for r < −1.
Show that if y lies on an orbit of period 2 then
y2 + (r + 1)y + (r + 1) = 0,
and deduce that there is a period 2 orbit if r < −1. Hint: we must have f 2(y) = y,
and you can factorise the resulting equation since f (0) = 0 and f (1 −r) = 1 −r.
If y1 and y2 are the points on this orbit, show that
f ′(y1) f ′(y2) = 4 + 2r −r2,
and hence that this orbit is stable for 1 −
√
6 < r < −1.
23.7 (C) Apply Euler’s method with timestep h to the equation ˙x = x(k −x) (cf. Exer-
cise 7.6). Investigate how the stability of the ﬁxed points depends on k and h. Now
implement this Euler scheme numerically and verify your results (e.g. compare the
cases k = 1 and k = 3 with timestep h = 1). (You could adapt the MATLAB M-ﬁle
euler.m, which is available on the web.)

24
The logistic map
In this chapter we consider a particular example of a nonlinear difference equation,
the logistic map
xn+1 = rxn(1 −xn).
(24.1)
Despite its simplicity the orbits of this equation can be extremely complicated, and
this has made it one of the standard models in the theory of dynamical systems and
chaos.
We will vary the parameter r between 0 and 4, since then if xn lies between
zero and one, so does xn+1 (the maximum value of rx(1 −x) occurs when x = 1
2
and is r/4). The graphs of f (x) = rx(1 −x) are shown in Figure 24.1 for various
values of r.
The equation can be thought of as a discrete model of a population (we saw a
very similar differential equation earlier) with limited resources. If the population
is small (measured, presumably, in thousands or millions to give an approximately
continuous variable) then (24.1) predicts that its size will increase, since when
xn ≈0,
xn+1 ≈rxn.
But when xn approaches the maximum size sustainable by the resources available
(which here is 1), the population dies out rapidly; if xn = 1 −yn with yn ≈0 then
xn+1 ≈ryn,
so that most of the population dies out.
What one would na¨ıvely expect from such a model is that the population size
would settle down to some steady state (as in the solution of the differential equa-
tion ˙x = rx(1 −x)), or perhaps oscillate between two nearby states, and indeed
this does happen when r is small. However, as r increases towards 4 this intuition
can be very wrong.
233

234
24 The logistic map
0
0.5
1
0
0.5
1
0
0.5
1
0
0.5
1
0
0.5
1
0
0.5
1
0
0.5
1
0
0.5
1
Fig. 24.1. Graphs of rx(1 −x) for (left to right) r = 1, 2, 3 and 4.
We will base our discussion around the existence of ﬁxed points and periodic
orbits. However, we will also make use of the idea of the ‘attractor’; rather than
deﬁning it precisely here, the best way to think of it is as the points around which
the orbits of xn+1 = f (xn) will move ‘eventually’.
24.1 Fixed points and their stability
First note that there are at most two ﬁxed points lying between zero and one. Fixed
points are the solutions of
x = rx(1 −x);
these are x = 0 and x = 1 −(1/r). Since we want to consider positive popula-
tions, the non-zero ﬁxed point will only be interesting when r > 1.
If we calculate f ′(x) = r(1 −2x) then f ′(0) = r; the ﬁxed point at x = 0 will
be stable while r < 1, and unstable once r > 1.
If 0 < r < 1 then 1 −(1/r) < 0 and so there is no positive ﬁxed point, and
over time the population decreases to zero (the interpretation of this being that the
reproductive rate is not high enough to sustain the population). In this case the
dynamics are very simple; x = 0 is stable and attracting, see Figure 24.2.
When r > 1 the origin is no longer stable, and there is another positive ﬁxed
point. Since
f ′(1 −(1/r)) = r(1 −2 + (2/r)) = 2 −r,
this ﬁxed point is stable while r < 3. So for 1 < r < 3 all orbits are attracted to
1 −(1/r), as shown in Figure 24.3.
24.2 Periodic orbits
When r increases beyond 3, things become more complicated. The ﬁxed point at
1 −(1/r) is now unstable, since the derivative of f in that case has modulus larger

24.2 Periodic orbits
235
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 24.2. For 0 < r < 1 (here r = 0.8) the origin is a stable ﬁxed point, and
the population dies out. This, and all similar ﬁgures in this chapter, show the
cobweb diagram of a representative orbit on the left, and the successive values of
xn against n for the same orbit on the right.
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 24.3. For 1 < r < 3 the origin is unstable, and there is an attracting non-zero
ﬁxed point. The pictures here are for r = 2.5.
than 1. If r is just a little larger than 3, almost every choice of initial condition
(apart from either ﬁxed point) ends up cycling between two different values of x
on a period 2 orbit, as shown in Figure 24.4.
In the ﬁgure, r = 1 +
√
5, and one point on the period 2 orbit is x = 1
2. To see
that this really does give a period 2 orbit, we ﬁrst calculate
f
1
2

= (1 +
√
5)1
2

1 −1
2

= 1 +
√
5
4
,

236
24 The logistic map
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 24.4. For r > 3 there are periodic orbits of period 2. This picture has r =
1 +
√
5 ≈3.2361.
and then
f 21
2

= f

1 +
√
5
4

= (1 +
√
5)

1 +
√
5
4
 
1 −1 +
√
5
4

=

6 + 2
√
5
4
 
3 −
√
5
4

= 18 −6
√
5 + 6
√
5 −10
16
= 1
2.
If we try to ﬁnd a period 2 orbit analytically for general r then we want to ﬁnd
a value of y such that if xn = y then xn+2 = y. So we want
y = f 2(y)
which is y = f (ry(1 −y)) or
y = r[ry(1 −y)][1 −ry(1 −y)].
(24.2)
This is a quartic (fourth order) equation for y; but since we know that y = 0 and
y = 1 −(1/r) must be solutions (they are ﬁxed points with f (y) = y, so cer-
tainly f ( f (y)) = f (y) = y) we can remove a factor y(y −[1 −(1/r)]). If y is a
period 2 point it must therefore solve the equation
ry2 −(1 + r)y +

1 + 1
r

= 0.
(24.3)

24.3 The period-doubling cascade
237
2.6
2.7
2.8
2.9
3
3.1
3.2
3.3
3.4
3.5
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
x
r
Fig. 24.5. As r passes through 3 the interior ﬁxed point becomes unstable, and
a stable orbit of period 2 appears. The stable ﬁxed point is shown as a solid line,
the unstable ﬁxed point as a dotted line, and the two points on the stable period 2
orbit as a dashed curve.
This equation only has real roots if the discriminant is positive (b2 −4ac > 0),
i.e. if
(1 + r)2 −4r

1 + 1
r

= (1 + r)(r −3) > 0.
Since we have restricted to the parameter range 0 ≤r ≤4 the factor (1 + r) is
positive; for a period 2 orbit we must therefore have r > 3.
Note that the two points on the periodic orbit (the solutions of (24.3)) are given
by
(1 + r) ± √(1 + r)(r −3)
2r
.
When r = 3 this would give 2/3, which is the position of the positive ﬁxed point.
When r > 3 the ﬁxed point at 1 −(1/r) is unstable, and the two points on the orbit
‘split off’ on either side of the ﬁxed point, see Figure 24.5.
24.3 The period-doubling cascade
As r is increased a little further, this attracting periodic orbit of period 2 becomes
unstable – two points break off from each point on the orbit, and we end up with
an attracting orbit of period 4, as shown in Figure 24.6.

238
24 The logistic map
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Fig. 24.6. A period 4 orbit when r = 3.5.
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 24.7. A period 8 orbit when r = 3.55.
Increasing r to r = 3.55 we obtain an attracting period 8 orbit, as in Figure 24.7.
When r is a little larger the period of the orbit doubles again to 16, then again
to 32, then again to 64 . . . This is known as the ‘period doubling cascade’. The
parameter values at which these successive period doublings occur get closer and
closer together, and converge towards a critical parameter value r ≈3.5701.
24.4 The bifurcation diagram and more periodic orbits
When r is increased beyond this critical parameter value the behaviour of solutions
becomes extremely complicated. One way to try to keep track of it is to draw the
bifurcation diagram, as shown in Figure 24.8. The horizontal axis represents the
parameter r, and for each value of r the attracting set is plotted vertically; this is
done by choosing an initial condition, applying f a large number of times (here

24.4 The bifurcation diagram and more periodic orbits
239
0
0.5
1
1.5
2
2.5
3
3.5
4
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
r
Fig. 24.8. The bifurcation diagram for 0 ≤r ≤4. After one hundred iterations,
the next thirty are plotted vertically for a number of r values.
3.4
3.42
3.44
3.46
3.48
3.5
3.52
3.54
3.56
3.58
3.6
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
r
x
Fig. 24.9. The bifurcation diagram for 3.4 ≤r ≤3.6.
100) until the orbit has ‘settled’ down, and then plotting more points of the orbit
on the vertical axis.
The diagram shows the stable ﬁxed point at x = 0 while r ≤1. For 1 < r < 3
the ﬁxed point at the origin is no longer stable, and the ﬁxed point at x = 1 −(1/r)
is attracting. For r > 3 this ﬁxed point becomes unstable, and instead all orbits

240
24 The logistic map
2.8
3
3.2
3.4
3.6
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
r
3.53
3.54
3.55
3.56
3.57
3.58
0.33
0.34
0.35
0.36
0.37
0.38
0.39
r
Fig. 24.10. The portion of the bifurcation diagram in the small box of the left-
hand ﬁgure is magniﬁed in the right-hand ﬁgure, and proves strikingly similar to
the original picture.
are attracted to a periodic orbit of period 2. Figure 24.9, a magniﬁed version of part
of the previous ﬁgure, shows that at a value of r between 3.4 and 3.5 the period 2
orbit becomes unstable, and orbits settle down to an orbit of period 4. We can also
see the ﬁrst part of the period doubling cascade occurring as r increases, until the
parameters become too close to distinguish. After the critical value of r ≈3.5701
everything becomes extremely complicated.
However, there is still order. For example, you can see that this diagram is ‘self-
similar’ by magnifying a small portion and observing that it looks very similar to
the original diagram, as shown in Figure 24.10.
Notice also that there are ‘windows’ in which the solution is more regular again,
for example in Figure 24.11 you can see that for r values around 3.835 there is a
period 3 orbit; this is shown in Figure 24.12.
By the same mechanism that produces the orbits of period 4, 8, etc. from the
initial period 2 orbit, this period 3 orbit will period double to 6, 12, 24, 48, etc. and
lead to another chaotic region.
24.5 Chaos
The phenomenon of chaos consists, essentially, of deterministic motion in which
the motion appears to be random, see Figure 24.13.

24.5 Chaos
241
3.6
3.65
3.7
3.75
3.8
3.85
3.9
3.95
4
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
r
x
Fig. 24.11. The bifurcation diagram for 3.6 ≤r ≤4.
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
2
4
6
8
10
0
0.2
0.4
0.6
0.8
1
Fig. 24.12. A period 3 orbit for r = 3.835.
A more rigorous deﬁning feature of chaotic systems is that small changes in the
initial conditions will produce wildly different behaviour if we wait long enough.
This phenomenon is known as sensitive dependence on initial conditions, and is
illustrated in Figure 24.14, which shows successive values of xn when r = 4 for
initial conditions that agree to the fourth decimal place.
When a model exhibits such sensitive dependence on initial conditions it will be
of little use for predicting the future, since tiny errors in the initial conditions will
lead to very different outcomes. However, this pessimistic observation has a more
optimistic converse; even if the behaviour of a system appears very complicated,

242
24 The logistic map
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0
10
20
30
0
0.2
0.4
0.6
0.8
1
Fig. 24.13. A chaotic orbit of xn+1 = 4xn(1 −xn).
0
5
10
15
20
25
30
35
40
0
0.5
1
0
5
10
15
20
25
30
35
40
0
0.5
1
n
Fig. 24.14. Successive values of xn vs n when r = 4, for initial conditions x0 =
0.2189 (top) and x0 = 0.2188 (bottom). For n ≥9 the iterates are completely
different.
or even random, it may still be subject to a very simple underlying rule. Since
the advent of chaos theory, much experimental data that was once discarded as
spurious and useless has been re-analysed and found to contain a high degree of
order.
24.6 *Analysis of xn+1 = 4xn(1 −xn)
When r = 4 the map is
xn+1 = 4xn(1 −xn),

24.6 *Analysis of xn+1 = 4xn(1 −xn)
243
0
0.2
0.4
0.6
0.8
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Fig. 24.15. The ‘tent map’ obtained from our original map by a substitution.
and we can simplify this problem by means of a careful substitution. Since xn ∈
[0, 1], we can set xn = sin2 θn, with θn ∈[0, /2]. The equation for θn is then
sin2 θn+1 = 4 sin2 θn cos2 θn
= sin2(2θn).
Since we want θ ∈[0, /2], we can take
θn+1 =

2θn
0 ≤θn ≤/4
 −2θn
/4 < θn ≤/2.
If we rescale θ, setting yn = 2θn/, to give y ∈[0, 1], we obtain
yn+1 =

2yn
0 ≤1
2
2(1 −yn)
1
2 < yn ≤1.
This new map (the ‘tent map’) is shown in Figure 24.15.
The easiest way to consider the dynamics of this new map is by writing down
the ‘binary decimal’ expansion of yn,
yn = a0.a1a2a3a4 . . . ,
where
yn =
∞

j=0
a j2−j.
Although we appear to have made the problem signiﬁcantly more complicated this
way, it will enable us to understand the dynamics much more easily.

244
24 The logistic map
Doubling the binary decimal
y = 0.a1a2a3a4 . . .
corresponds to shifting the ‘decimal point’ one place to the right (analogous to
multiply by 10 for normal decimals),
2y = a1.a2a3a4a5 . . . .
Subtracting y from 2 swaps all the 0s and 1s: we will denote the operation of
swapping 0 and 1 by a bar,
¯a =
1
if a = 0
0
if a = 1,
and so
2 −a0.a1a2a3a4 . . . = ¯a0.¯a1 ¯a2 ¯a3 ¯a4 . . . .
In the range of y that we are considering (y ∈[0, 1]) we always have a0 = 0
provided that we represent 1 by 0.1∞(we use the notation (r1 . . .rn)∞to mean
r1 . . .rn repeated ad inﬁnitum). If yn < 1/2 then we also have a1 = 0, and so
yn+1 = 0.a2a3a4a5 . . . .
If yn ≥1/2 then a1 = 1, and we have
yn+1 = 2 −1.a2a3a4a5 . . . = 0.¯a2 ¯a3 ¯a4 ¯a5 . . . .
Therefore we can rewrite our map as
if yn = 0.a1a2a3a4 . . .
then
yn+1 =
0.a2a3a4a5 . . .
for a1 = 0
0.¯a2 ¯a3 ¯a4 ¯a5 . . .
for a1 = 1.
With the map written in this way it is possible to understand its dynamics fairly
easily.
Suppose that y0 is rational. Then just as in base 10, its decimal expansion will
either be ﬁnite, or eventually repeat. If its decimal expansion is ﬁnite,
y0 = 0.a1 . . . an,
then y j = 0 for all j ≥n, and the orbit ends up at zero after a ﬁnite number of
iterations. If the decimal expansion eventually repeats then
y0 = 0.b1b2b3 . . . bn(a1a2 . . . am)∞.
In this case we will have
y1 = 0.b2b3b4b5 . . . bn(a1a2 . . . am)∞
or
0.b2b3b4b5 . . . bn(a1a2 . . . am)∞,
y2 = 0.b3b4b5 . . . bn(a1a2 . . . am)∞
or
0.b3b4b5 . . . bn(a1a2 . . . am)∞,

Exercises
245
until after n iterations we have
yn = 0.(a1a2 . . . am)∞
or
0.(a1a2 . . . am)∞.
Without loss of generality we can consider what happens when
yn = 0.(a1a2 . . . am)∞.
There are now two possibilities. Either f m(yn) = yn, in which case the orbit re-
peats every m iterations; or all the zeros and ones of yn are interchanged and
f m(yn) = ¯yn. In the second case, since f ( ¯y) = f (y) for any y,
f m(yn+1) = f m( f (yn)) = f ( f m(yn)) = f ( ¯yn) = f (yn) = yn+1,
and so the orbit repeats every m iterations after just one more application of f.
Thus every rational number lies on an orbit that is eventually periodic.
However, none of these periodic orbits can be stable. Indeed, all initial condi-
tions that are not equal will eventually separate, falling on different sides of x = 1
2.
Suppose that
y0 = 0.a1a2 . . . anan+1 . . .
and
z0 = 0.a1a2 . . . anbn+1 . . .
with an+1 ̸= bn+1; then the ﬁrst decimal places of f n(y0) and f n(z0) will not be
equal.
If y0 is irrational then the decimal expansion will go on for ever and never repeat.
It follows that the orbit starting at y0 will also never repeat, and so cannot be
periodic.
We have a strange situation, then. There are no stable orbits, but all rational
numbers are eventually periodic or reach zero after a ﬁnite number of iterations.
Any number that starts irrational will have a binary expansion, and hence an orbit,
that never repeats itself; one can also show that the distribution of points along
such an orbit is effectively random, even though the evolution is deterministic.
The idea of following an orbit by seeing which side of x = 1
2 it falls (which is
what the binary expansion here does very simply) can be generalised into a useful
technique for analysing the original logistic map for other parameter values. This
model is now very well understood, and is one of the standard examples used in
the theory of dynamical systems.
Exercises
24.1 Consider the iterated map
xn+1 = rxn

1 −x2
n

.
Show that for 0 < r < 3
√
3/2 if 0 ≤xn ≤1 then 0 ≤xn+1 ≤1. Show that if r < 1
then the only ﬁxed point in [0, 1] is zero, and that this is stable.

246
24 The logistic map
0
0.2
0.4
0.6
0.8
1
0
0.2
0.4
0.6
0.8
1
0.75
0.8
0.85
0.9
0.72
0.74
0.76
0.78
0.8
0.82
0.84
0.86
0.88
0.9
Fig. 24.16. On the left is the graph of f and f 2 (in bold) for r = 3.5. On the right
is a magniﬁed version of the box in the left-hand ﬁgure, showing that f 2 has a
ﬁxed point.
When r > 1 there is another ﬁxed point in [0, 1]. Find the value of this ﬁxed point
(as a function of r). For which values of r is it stable, and for which values is it
unstable?
What would you expect to happen when r > 2?
24.2 (C) Use the M-ﬁles logistic.m (which draws cobweb diagrams), xnvsn.m (which
plots successive values of xn vs n) and bifurcation.m (which draws the bifur-
cation diagram for a given range of r) to investigate the dynamics of the logistic
map. Modify the programs to investigate the dynamics of the map in the previous
exercise.
24.3 (C and T) The M-ﬁle f2.m plots the graph of f (x) and of f 2(x) in the left-hand
ﬁgure, and the graph of f 2 restricted to the little box in a blown-up version on the
right (see Figure 24.16). By looking at a succession of pictures as r increases from
0 to 4, observe that the rescaled version of f 2 behaves in the same way that f does
as r increases. This can be made precise, and explains the period doubling cascade.
Since the ﬁxed point of f becomes unstable and gives rise to a period 2 orbit, the
same thing happens to f 2; its ﬁxed point (a period 2 orbit for f ) becomes unstable
and gives rise to a period 2 orbit (a period 4 orbit for f ). Since whatever happens to
f happens to f 2, whatever happens to f 2 happens to ( f 2)2 = f 4; its ﬁxed point
(a period 4 orbit for f ) will become unstable and give rise to a period 2 orbit
(a period 8 orbit for f ). Similar reasoning holds for each orbit of period 2k, showing
that it becomes unstable and produces an orbit of period 2k+1. The map formed by
restricting f 2 to the little box, and then rescaling to the interval [0, 1], is known as
the renormalisation of f . You can investigate the dynamics of the renormalised map
as r changes using the M-ﬁle renormalised.m.

Part V
Coupled linear equations


25
*Vector ﬁrst order equations and higher order equations
All the equations that we have considered so far have been ﬁrst order equations in
which there was only one dependent variable (e.g. x(t) or y(x), where x and y are
scalars). If we were restricted to equations in which there is only one dependent
variable then this would exclude the vast majority of applications: for example,
specifying the position of something in the three-dimensional space in which we
live requires three coordinates.
Although it is much harder to ﬁnd solution methods for equations involving a
number of dependent variables, the theoretical ideas are straightforward general-
isations of what we did for scalar equations in Chapter 6. Here we make precise
what we mean by a solution, and state the theorem that guarantees the existence
and uniqueness of solutions under easily checked conditions.
Suppose that we have n dependent variables x1, . . . , xn, and each of these obeys
a differential equation with the right-hand side (perhaps) depending on some of
the other variables,
˙x1 = f1(x1, x2, . . . , xn, t)
˙x2 = f2(x1, x2, . . . , xn, t)
... = ...
˙xn = fn(x1, x2, . . . , xn, t).
(25.1)
This is a set of n coupled ﬁrst-order equations which we can write in a much more
convenient way if we make use of vector notation.
We write the n dependent variables x1, . . . , xn as a vector x,
x =
⎛
⎜⎝
x1
...
xn
⎞
⎟⎠,
249

250
25 *Vector ﬁrst order equations and higher order equations
and deﬁne a vector function f(x, t) by
f(x, t) = f(x1, . . . , xn, t) =
⎛
⎜⎜⎜⎝
f1(x1, . . . , xn, t)
f2(x1, . . . , xn, t)
...
fn(x1, . . . , xn, t)
⎞
⎟⎟⎟⎠.
With this notation we can rewrite the coupled equations in (25.1) as
dx
dt = f(x, t),
which encourages us to ﬁnd a theory that uniﬁes the treatment of scalar equations
and coupled equations. On the theoretical level this is possible, and here we give a
general existence and uniqueness result which reduces to the scalar existence and
uniqueness theorem (Theorem 6.2) when n = 1.
First we deﬁne a solution of the appropriate initial value problem, cf. Deﬁni-
tion 6.1.
Deﬁnition 25.1 A solution of the initial value problem
dx
dt (t) = f(x, t)
with
x(t0) = x0
x ∈Rn,
(25.2)
on an open interval I that contains t0 is a differentiable function x : I →Rn, with
x(t0) = x0 and ˙x(t) = f(x, t) for all t ∈I.
We now have essentially the same existence and uniqueness theorem as before
(Theorem 6.2). We use the notation Df to denote the matrix of partial derivatives
of f,
Df =
⎛
⎜⎝
∂f1/∂x1 · · · ∂f1/∂xn
...
...
...
∂fn/∂x1 · · · ∂fn/∂xn
⎞
⎟⎠.
(25.3)
Theorem 25.2
If f(x, t) and Df(x, t) are continuous functions of x (i.e. of x1,
x2, . . . , xn) and t for
x ∈U = (a1, b1) × (a2, b2) × · · · × (an, bn),
and for c < t < d then for any x0 ∈U and t0 ∈(c, d) the equation (25.2) has a
unique solution on some open interval containing t0.
Note that the only real change is that we have to check that all the partial deriva-
tives ∂fi/∂x j are continuous, rather than just the one derivative we get in the scalar
case. You should also check that you are happy that the above deﬁnition and theo-
rem reduce to the scalar case when n = 1.

25.1 Existence and uniqueness for second order equations
251
We will spend some time with pairs of coupled ﬁrst order equations (n = 2)
in Chapters 26–36, and consider a particular example of three coupled equations
(n = 3) in Chapter 37.
25.1 Existence and uniqueness for second order equations
Theorem 25.2 can also be used to show that second (or higher) order scalar equa-
tions have unique solutions. If we consider, for example, the second order equation
¨x = f (˙x, x, t),
then we recast this as a vector equation by deﬁning another variable representing
˙x. We let x1 = x and x2 = ˙x, so that1 x = (x1, x2) ≡(x, ˙x), and then
˙x1 = ˙x = x2
˙x2 = d ˙x
dt = ¨x = f (˙x, x, t) = f (x2, x1, t),
which we can rewrite as
dx
dt = g(x, t),
(25.4)
with
g(x, t) =

x2
f (x2, x1, t)

.
Existence and uniqueness are guaranteed by Theorem 25.2 for equation (25.4) as
long as we provide an initial condition x(t0) = x0; because x(t0) = (x(t0); ˙x(t0))
this is equivalent to specifying both x(t0) and ˙x(t0).
Theorem 25.2 requires that g and Dg are continuous. Since x2 is continuous, we
need f (x2, x1, t) to be a continuous function of x1 and x2; and since
Dg =

0
1
∂f/∂x1
∂f/∂x2

we need the partial derivatives of f with respect to x1 and x2 to be continuous. So
we can rewrite Theorem 25.2 in the form of Theorem 11.1 from Chapter 11.
Theorem 25.3 Given a function f (x2, x1, t), suppose that f , ∂f/∂x1, and ∂f/∂x2
are continuous functions for a1 < x1 < a2, b1 < x2 < b2 and t1 < t < t2. Then
1 In the text we use the notation (x1, x2) to denote the column vector

x1
x2

.

252
25 *Vector ﬁrst order equations and higher order equations
for all initial conditions
x(t0) = x0
and
˙x(t0) = y0
(25.5)
with a1 < x0 < a2, b1 < y0 < b2, and t1 < t0 < t2 there exists a unique solution
of
¨x = f (˙x, x, t)
(25.6)
on some interval I containing t0, i.e. a continuous function with two continuous
derivatives that satisﬁes (25.5) and the equation (25.6) on I.
A similar trick to this can be applied to deal with higher order equations, see
Exercise 25.1.
Exercises
25.1 By choosing an appropriate collection of new variables x1, . . . , xn rewrite the nth
order differential equation
dnx
dtn = f

dn−1x
dtn−1 , . . . , dx
dt , x, t

as a set of n coupled linear ﬁrst order equations. Find the conditions on the function
f (xn, . . . , x1, t) for the original differential equation to have a unique solution.
25.2 Suppose that f is a Lipschitz function of x, i.e. that for some L > 0
|f(x) −f(y)| ≤L|x −y|.
Use an argument similar to that of Exercise 6.3 to show that if x(t) and y(t) are two
solutions of
dx/dt = f(x)
with
x(0) = x0
(E25.1)
and z(t) = x(t) −y(t) then
d
dt |z|2 ≤2L|z|2,
and hence that the solution of (E25.1) is unique. (You might ﬁnd the Cauchy–Schwarz
inequality |a · b| ≤|a||b| useful.)

26
Explicit solutions of coupled linear systems
In the following chapters we will consider what happens when we have two de-
pendent variables, x(t) and y(t). In a general pair of coupled ﬁrst order equations
the derivative of x can depend not only on x and t, but also on y, and vice versa,
 ˙x = f (x, y, t)
˙y = g(x, y, t).
The solutions x(t) and y(t) are, at least in principle, inextricably entangled with
each other. Such systems are often referred to as ‘two-dimensional’, since the state
of the system can be completely speciﬁed by the two variables x and y. The best
way to understand the solutions of such coupled equations is graphically, using a
two-dimensional version of the phase diagrams we drew in Chapter 7. The remain-
der of the book concentrates on this graphical approach.
However, in this chapter we ﬁrst discuss a method for ﬁnding explicit solutions
for a pair of coupled linear equations,
 ˙x = ax + by + f (t)
˙y = cx + dy + g(t).
(26.1)
We saw in the previous chapter that by introducing extra variables we can rewrite
a second order equation as two coupled ﬁrst order equations. Given two coupled
linear equations we can reverse this process. This method is the most reliable if
you want to ﬁnd an explicit solution of the equation, and in particular is good for
dealing with the inhomogeneous problem (when f (t) or g(t) is non-zero).
We will assume here that b ̸= 0. If b = c = 0 then the equations are not coupled
and we could solve for x and y separately using the integrating factor method,
while if b = 0 but c ̸= 0 we can follow the method below swapping the rˆoles of x
and y.
253

254
26 Explicit solutions of coupled linear systems
Since b ̸= 0 we can rearrange the ﬁrst equation of the pair in (26.1) to give y in
terms of x and ˙x,
y = ˙x −ax −f (t)
b
.
(26.2)
Differentiating this will give us ˙y in terms of ˙x and ¨x,
˙y = ¨x −a ˙x −˙f (t)
b
,
and we can now substitute these into the second equation from (26.1) to give
¨x −a ˙x −˙f (t)
b
= cx + d ˙x −ax −f (t)
b
+ g(t).
Rearranging this gives a second order equation for x,
¨x −(a + d)˙x + (ad −bc)x = ˙f (t) + bg(t) −d f (t).
(26.3)
We should be able to solve this to ﬁnd x(t), using the techniques for second order
linear equations we have already covered. Once we know x(t) we can then use the
formula in (26.2) to work out y(t).
Notice that it is not necessary to learn any new techniques to solve (26.1), apart
from the ‘trick’ of substitution that is used here to turn the pair of equations into
one second order equation.
Example 26.1 By deriving the second order differential equation solved by x, ﬁnd
the general solution of the coupled equations
˙x = x + y
˙y = 4x −2y + 4e−2t.
Find also the solution that satisﬁes the initial conditions x(0) = 0 and y(0) = −1.
Rearranging the ﬁrst equation we can ﬁnd y in terms of x,
y = ˙x −x,
(26.4)
and so, differentiating this,
˙y = ¨x −˙x.
Substituting these into the second equation gives
¨x −˙x
  
˙y
= 4x −2(˙x −x
  
y
) + 4e−2t
which simpliﬁes to
¨x + ˙x −6x = 4e−2t.
(26.5)

Explicit solutions of coupled linear systems
255
To solve this we ﬁrst ﬁnd the complementary function, i.e. the solution of
¨z + ˙z −6z = 0. If we try z(t) = ekt
the resulting auxiliary equation is
k2 + k −6 = 0 with roots k = 2 and k = −3, yielding the complementary func-
tion
z(t) = Ae2t + Be−3t.
Since e−2t is not a solution of the homogeneous equation we can try xp(t) =
ce−2t for a particular integral of (26.5). To obtain 4e−2t on the right-hand side we
need
4ce−2t −2ce−2t −6ce−2t = 4e−2t,
so c = −1, and xp(t) = −e−2t is a particular integral. The general solution for
x(t) is therefore
x(t) = Ae2t + Be−3t −e−2t.
Having found x(t) we can now ﬁnd y(t) using (26.4),
y(t) = [2Ae2t −3Be−3t + 2e−2t]



˙x
−[Ae2t + Be−3t −e−2t]



x
= Ae2t −4Be−3t + 3e−2t.
The general solution is therefore
 x(t) = Ae2t + Be−3t −e−2t
y(t) = Ae2t −4Be−3t + 3e−2t.
Note that the constants in the solutions for x(t) and y(t) are the same A and B,
and the solutions are tied together by the choice of these constants.
The solution that satisﬁes the initial conditions x(0) = 0 and y(0) = −1 must
have
A + B −1 = 0
and
A −4B + 3 = −1,
i.e. A = 0 and B = 1; it is
x(t) = e−3t −e−2t
y(t) = 3e−2t −4e−3t.
Example 26.2 By ﬁnding the second order differential equation solved by x, ﬁnd
the general solution of the coupled equations
˙x = 2x + 5y
˙y = −2x.
Find also the solution satisfying the initial conditions x(0) = 5 and y(0) = −4.

256
26 Explicit solutions of coupled linear systems
Rearranging the ﬁrst equation we obtain y = 1
5(˙x −2x). Therefore
˙y = 1
5(¨x −2˙x) = −2x,
and so
¨x −2˙x + 10x = 0.
To solve this we try x = ekt and obtain the auxiliary equation for k,
k2 −2k + 10 = 0.
The solutions of this equation are
k = 2 ±
√
4 −40
2
= 1 ± 3i,
and so
x(t) = et(A cos 3t + B sin 3t).
Since y = 1
5(˙x −2x) the solution for y(t) is given by
y(t) = 1
5
.
et[(3B + A) cos 3t + (B −3A) sin 3t] −2et[A cos 3t + B sin 3t]
/
= et
5 [(3B −A) cos 3t −(3A + B) sin 3t].
Since A and B are arbitrary constants, if we set A = 5C and B = 5D the general
solution is
x(t) = et(5C cos 3t + 5D sin 3t)
y(t) = et[(3D −C) cos 3t −(3C + D) sin 3t].
(26.6)
To ensure that x(0) = 5 and y(0) = −4 we need
5C = 5
and
3D −C = −4,
so that C = 1 and D = −1. Thus the solution satisfying these initial conditions is
x(t) = et(5 cos 3t −5 sin 3t)
y(t) = −et(4 cos 3t + 2 sin 3t).
The graphs of x(t) and y(t) against t are shown in Figure 26.1.
□

Exercises
257
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
−1200
−1000
−800
−600
−400
−200
0
200
400
600
800
Fig. 26.1. Graphs of x(t) [solid line] and y(t) [dotted line] against t. Both are
oscillations whose amplitude increases exponentially.
Exercises
26.1 Find the general solutions of the following differential equations by converting them
into a single second-order equation. Also ﬁnd the solution that satisﬁes the given
initial conditions.
(i)
˙x = 4x −y
x(0) = 0 and y(0) = 1;
˙y = 2x + y + t2,
(ii)
˙x = x −4y + cos 2t
x(0) = 1 and y(0) = 1;
˙y = x + y,
(iii)
˙x = 2x + 2y
x(0) = 0 and ˙x(0) = 1;
˙y = 6x + 3y + et,
(iv)
˙x = 5x −4y + e3t
x(0) = 1 and y(0) = −1;
˙y = x + y,
(v)
˙x = 2x + 5y
x(0) = 2 and y(0) = −1;
˙y = −2x + cos 3t,

258
26 Explicit solutions of coupled linear systems
(vi)
˙x = x + y + e−t
y(0) = −1 and x(0) = 1; and
˙y = 4x −2y + e2t,
(vii)
˙x = 8x + 14y
x(0) = y(0) = 1.
˙y = 7x + y,

27
The matrix approach to linear equations:
eigenvalues and eigenvectors
We now reconsider the coupled homogeneous linear system
 ˙x = ax + by
˙y = cx + dy.
(27.1)
Our new approach may initially seem a little complicated, and it is not the best
method if we want to ﬁnd an explicit solution. However, it will enable us to draw
the phase portrait (phase diagram) for this linear system after some fairly simple
calculations. We will then use these linear phase portraits to analyse coupled non-
linear systems. This graphical approach forms the main subject matter of all that
follows.
27.1 Rewriting the equation in matrix form
The starting point is the observation that there is a much more compact way to
write (27.1) using vector and matrix notation. If we write
x(t) =

 x(t)
y(t)

and deﬁne a matrix A by
A =

a
b
c
d

(see Appendix B for some background material on matrices) then we can rewrite
(27.1) as
˙x = Ax.
(27.2)
Notice that since this equation is linear, we have a superposition principle; linear
combinations of solutions will still satisfy the equation, i.e. if x1(t) and x2(t) solve
259

260
27 Eigenvalues and eigenvectors
(27.2) then so does
x(t) = αx1(t) + βx2(t),
(27.3)
since
dx
dt = d
dt [αx1(t) + βx2(t)] = α˙x1 + β ˙x2
= αAx1 + βAx2 = A[αx1 + βx2]
= Ax.
Now, observe that the way equation (27.2) is written makes it look like the
simple linear equation ˙x = ax, whose solution we know is x(t) = Ceat. We will
try to ﬁnd a solution of (27.2) by guessing that it has the same type of exponential
dependence on time (eλt for some λ); however, since x has two components the
‘coefﬁcient’ (C in the solution x(t) = Ceat) will have to be a constant vector v.
Our trial solution is therefore
x(t) = eλtv.
(27.4)
If we substitute this guess into (27.2) then we obtain
d
dt [eλtv] = A[eλtv].
Since v is a constant vector the d/dt on the left-hand side only affects the expo-
nential term:
λeλtv = eλtAv.
Dividing by the non-zero factor eλt this becomes
Av = λv.
(27.5)
This is known as an eigenvalue equation. Any values of λ for which this equa-
tion has a non-zero solution for v are called the eigenvalues of A, and the corre-
sponding v are called the eigenvectors of A. The remainder of this chapter dis-
cusses how to ﬁnd the eigenvalues and eigenvectors of A, and we return to their
relevance to the differential equation dx/dt = Ax in the next chapter.
27.2 Eigenvalues and eigenvectors
For what values of λ does the eigenvalue equation
Av = λv
(27.6)

27.2 Eigenvalues and eigenvectors
261
have a non-zero solution for v? If we rewrite the equation as
(A −λI)v = 0,
(27.7)
where I is the 2 × 2 identity matrix,
I =

1
0
0
1

,
and 0 = (0, 0), it is clear that if A −λI is invertible then the only solution is v = 0.
So to have a non-trivial solution (v ̸= 0) we have to ensure that A −λI is singular,
i.e. that
det(A −λI) = |A −λI| = 0.
Rewriting this in full it becomes


a
b
c
d

−

λ
0
0
λ
 =

a −λ
b
c
d −λ
 = (a −λ)(d −λ) −bc = 0
which gives a quadratic equation for λ (‘the characteristic equation’)
λ2 −(a + d)λ + (ad −bc) = 0.
(27.8)
The solutions of this equation are the eigenvalues of the matrix A, and for these
eigenvalues we can expect to be able to ﬁnd non-zero vectors v that have Av = λv;
these are the corresponding eigenvectors. Since the eigenvalues are the solutions
of a quadratic equation, they could be real and distinct, there could be only one,
or they could be a complex conjugate pair. These different possibilities will have
different implications for the solutions of the original differential equation, and we
examine these three possibilities in turn in the following three chapters.
Given an eigenvalue λ the simplest way to ﬁnd the associated eigenvector
v = (v1, v2) is usually to solve the rearranged version (27.7) of the eigenvalue
equation,
(A −λI)

v1
v2

= 0.
Note that if v is an eigenvector with
Av = λv
then any constant multiple of v is also an eigenvector, since
A(cv) = cAv = cλv = λ(cv).

262
27 Eigenvalues and eigenvectors
A canonical (standardised) choice of eigenvector is the vector with unit length
(there are in fact two of these in the direction of v), but often it is easier to work
with an eigenvector of integer values (if there is one).
This is all most easily illustrated by considering an example.
Example 27.1 Find the eigenvalues and eigenvectors of the matrix
A =

2
2
6
3

.
To ﬁnd the eigenvalues of A we solve the equation det(A −λI) = 0; this is


2
2
6
3

−

λ
0
0
λ
 =

2 −λ
2
6
3 −λ
 = 0,
which gives the quadratic equation
(2 −λ)(3 −λ) −12 = 0.
Multiplying this out and simplifying we obtain
λ2 −5λ −6 = 0
or
(λ −6)(λ + 1) = 0.
The solutions of this, λ = 6 and λ = −1, are the eigenvalues of A.
Now that we know the eigenvalues we can ﬁnd the corresponding eigenvectors.
If we write
v =

v1
v2

then when λ = 6 we need (A −6I)v = 0, i.e.

2
2
6
3

−

6
0
0
6

v =

−4
2
6
−3
 
v1
v2

= 0,
This matrix equation gives us two equations relating v1 and v2:
−4v1 + 2v2 = 0
and
6v1 −3v2 = 0.
At this stage we will always obtain two equations, one of which is a multiple of the
other. We need only consider one equation, then, and this tells us that v2 = 2v1;
the general eigenvector corresponding to λ1 = 6 is

 v1
2v1

= v1

1
2

.

27.2 Eigenvalues and eigenvectors
263
We usually drop the arbitrary constant, and talk about (for example) ‘the eigenvec-
tor’
v1 =

1
2

,
remembering that in fact any multiple of (1, 2) is an eigenvector.1
To check that v1 really is an eigenvector, simply multiply it by A:
Av1 =

2
2
6
3
 
1
2

=

2 + 4
6 + 6

=

 6
12

= 6v1.
So v1 is indeed an eigenvector corresponding to the eigenvalue 6.
For λ = −1 we want the eigenvector v2 = (v1, v2) to solve [A −(−I)]v = 0,

2
2
6
3

−

−1
0
0
−1

v =

3
2
6
4
 
v1
v2

= 0.
Again, there are two equations, with one a multiple of the other,
3v1 + 2v2 = 0
and
6v1 + 4v2 = 0;
so v1 and v2 are related by v2 = −3v1/2: the general eigenvector corresponding
to the eigenvalue λ = −1 is

v1
−3v1/2

= v1

1
−3/2

.
In this case we could choose
v2 =

 2
−3

as our representative eigenvector. Checking once more that this really is an eigen-
vector, we have
Av2 =

2
2
6
3
 
 2
−3

=

 4 −6
12 −9

=

−2
3

= −v2
as required.
We have now found the two eigenvalues and their corresponding eigenvectors,
λ1 = 6
with
v1 =

1
2

and
λ2 = −1
with
v2 =

 2
−3

.
□
1 In some respects it is therefore more sensible to speak of an ‘eigendirection’, in that any vector v in the same
direction as the vector (1, 2) satisﬁes Av = 6v.

264
27 Eigenvalues and eigenvectors
Since we will be calculating many eigenvalues and eigenvectors in what follows,
any work that we can save ourselves later on will be useful. To this end, we note
here that there are some special cases in which it is possible to ‘read off’ the
eigenvalues and eigenvectors from the matrix itself.
Example 27.2 The eigenvalues of a diagonal matrix

λ1
0
0
λ2

are λ1 and λ2, with corresponding eigenvectors v1 = (1, 0) and v2 = (0, 1), re-
spectively.
This is easy to check, either directly by matrix multiplication, or by applying
the general method.
□
Slightly less obvious, and therefore more useful, is the following.
Example 27.3 The eigenvalues of both the matrices

λ1
b
0
λ2

and

λ1
0
c
λ2

are λ1 and λ2. For the ﬁrst, the eigenvector corresponding to λ1 is (1, 0); while for
the second, the eigenvector corresponding to λ2 is (0, 1). In each case the other
eigenvector needs to be found using the standard method.
The fact that λ1 and λ2 are the eigenvalues becomes obvious when you write
down the characteristic equation; for example, if A is the matrix on the right then
the eigenvalues λ are the solutions of
|A −λI| =

λ1 −λ
0
c
λ2 −λ
 = (λ1 −λ)(λ2 −λ) = 0,
and hence λ = λ1 or λ = λ2. That the eigenvector corresponding to λ2 is (0, 1)
essentially follows ‘by inspection’,

λ1
0
c
λ2
 
0
1

=

 0
λ2

= λ2

0
1

.
The other eigenvector will need to be found via the standard calculation (ﬁnd v
with (A −λ1I)v = 0).
□
All the above examples have distinct real eigenvalues. We now look at an exam-
ple in which there is only one eigenvalue.

27.2 Eigenvalues and eigenvectors
265
Example 27.4 Find the eigenvalues and eigenvectors of the matrix
A =

5
−4
1
1

.
(27.9)
The eigenvalues λ are the solutions of

5 −λ
−4
1
1 −λ
 = λ2 −6λ + 9 = (λ −3)2 = 0,
thus λ = 3 is a repeated eigenvalue. Since we have only one eigenvalue we can
only expect to ﬁnd one eigenvector v; if (A −λI)v = 0 then

2
−4
1
−2
 
v1
v2

= 0,
and so v = (2, 1).
□
It is also possible for the eigenvalues to be complex. Since they are the solutions
of a quadratic equation, they will be a complex conjugate pair. The eigenvectors
will now be complex too, and also come as a complex conjugate pair (so it will
only be necessary to calculate one of them).
Example 27.5 Find the eigenvalues and eigenvectors of the matrix
A =

 2
5
−2
0

.
The eigenvalues of A are given by the solutions of the quadratic equation

2 −λ
5
−2
−λ
 = (2 −λ)(−λ) + 10 = λ2 −2λ + 10 = 0.
The roots of this equation are the complex conjugate pair
λ = 2 ±
√
4 −40
2
= 1 ± 3i.
To ﬁnd the eigenvector associated with 1 + 3i we have to solve (A −λI)v = 0,
i.e.

1 −3i
5
−2
−1 −3i
 
v1
v2

= 0,
or

 (1 −3i)v1 + 5v2
−2v1 −(1 + 3i)v2

= 0.

266
27 Eigenvalues and eigenvectors
(Although not entirely clear, the second equation is, as usual, a multiple of the
ﬁrst.) Using the ﬁrst equation we must have 5v2 = (3i −1)v1, and so we can take

5
3i −1

as a representative eigenvector with eigenvalue 1 + 3i. Since

 2
5
−2
0
 
5
3i −1

=

10 + 15i −5
−10

=

5 + 15i
−5

= (1 + 3i)

5
3i −1

,
(5, 3i −1) is indeed an eigenvector corresponding to the eigenvalue 1 + 3i.
The eigenvector corresponding to 1 −3i, the complex conjugate of 1 + 3i, will
be the complex conjugate of the eigenvector we have already found,

5
−3i −1

.
To check that taking the complex conjugate works, we have

 2
5
−2
0
 
5
−3i −1

=

10 −15i −5
−10

=

5 −15i
−5

= (1 −3i)

5
−3i −1

,
as we should.
□
27.3 *Eigenvalues and eigenvectors with MATLAB
It is easy to ﬁnd eigenvalues and eigenvectors using MATLAB. If A is a square matrix
then the command eig(A) will return the eigenvalues of A.
>> A=[2 2; 6 3]
A = 2
2
6
3
>> eig(A)
ans = -1
6
If you also want MATLAB to ﬁnd the eigenvectors for you then you can obtain
them by typing [V D]=eig(A). This will return two matrices, V and D, where the

Exercises
267
two columns of V are the eigenvectors, chosen so that they have length one, and D
is a diagonal matrix consisting of the eigenvalues.
>> [V D]=eig(A)
V = -0.5547
-0.4472
0.8321
-0.8944
D = -1
0
0
6
Note that, as you would expect, the ﬁrst column of V is the eigenvector corre-
sponding to the eigenvalue in the ﬁrst position in the diagonal matrix D. However,
since the eigenvectors have been chosen so that they have unit length they can ap-
pear to be quite complicated (in our analytical calculations we found eigenvectors
(2, −3) and (1, 2)). You can also use MATLAB to ﬁnd the ratio of the components
of the eigenvectors to each other if you want to write the eigenvectors as a pair
of integers. First type format rat, which tells MATLAB to display its answers as
fractions in their lowest terms, and then calculate the ratio of the components of
the eigenvectors,
>> format rat
>> V(2,1)/V(1,1)
ans = -3/2
>> V(2,2)/V(1,2)
ans = 2
The ﬁrst calculation shows that (1, −3/2) is a possible choice for the ﬁrst eigen-
vector (which gives our (2, −3) after multiplying by two), while the second gives
(1, 2) immediately.
Exercises
27.1 Find the eigenvectors and eigenvalues of the following matrices:
(i)

1
2
1
0

,

268
27 Eigenvalues and eigenvectors
(ii)

2
2
0
−4

,
(iii)

 7
−2
26
−1

,
(iv)

9
2
2
6

,
(v)

 7
1
−4
11

,
(vi)

 2
−3
3
2

,
(vii)

6
0
0
−13

,
(viii)

4
−2
1
2

,
(ix)

3
−1
1
1

,
(x)

 −7
6
12
−1

.

28
Distinct real eigenvalues
In this chapter, and the following two, our main aim is to show how to use a knowl-
edge of the eigenvalues and eigenvectors of A in order to draw the phase diagram
for the equation ˙x = Ax. As in Chapter 7, this phase diagram will illustrate the
qualitative behaviour of the solutions by showing a representative choice of the
curves traced out by the solutions (x(t), y(t)), labelled with an arrow to indicate
in which direction the solution moves as t increases.
In each chapter we will examine one of the three possibilities (two distinct real
eigenvalues, a complex conjugate pair of eigenvalues, or a repeated eigenvalue)
and for each case we will show
(i) how an appropriate change of coordinates, based on the eigenvectors of the
matrix A, can be used to transform the differential equation into a standard,
simpler (canonical) form;
(ii) how to ﬁnd the explicit solution of this simple form of the equation;
(iii) how to draw the phase portrait for the simple equation;
and hence
(iv) how to ﬁnd the explicit solution of the original equation; and
(v) how to draw its phase portrait.
Since we already have a reliable method for solving coupled linear equations,
(ii) and (iv) will be much less important than (iii) and (v). Besides giving the math-
ematical justiﬁcation of step (v), the coordinate transformations required to sim-
plify the equation also provide a very natural illustration of the notion of the Jordan
Canonical Form of a matrix, an important topic in the theory of linear algebra.
In the ﬁrst of these three chapters we assume that A has two distinct real eigen-
values λ1 and λ2, with corresponding eigenvectors v1 and v2.
269

270
28 Distinct real eigenvalues
28.1 The explicit solution
In this, the simplest case, we do not need to make a change of coordinates in order
to ﬁnd the form of the explicit solution given the eigenvalues and eigenvectors.
In the previous chapter we found that when we tried x(t) = eλtv as a solution of
the linear equation ˙x = Ax (see (27.4)), this gave rise to
Av = λv.
Given the eigenvalues and eigenvectors of A this means that we have obtained two
possible solutions of the differential equation,
eλ1tv1
and
eλ2tv2.
We saw in equation (27.3) in the previous chapter that a linear combination of two
solutions is still a solution; thus the general solution of dx/dt = Ax can be written
as
x(t) = Aeλ1tv1 + Beλ2tv2.
(28.1)
We now apply this method to a linear equation that is the homogeneous version
of the equations in Example 26.1.
Example 28.1 By ﬁnding the eigenvalues and eigenvectors of an appropriate ma-
trix, ﬁnd the general solution of the coupled system
˙x = x + y
˙y = 4x −2y.
(28.2)
Rewritten as a matrix equation the problem becomes
d
dt

 x
y

=

1
1
4
−2
 
 x
y

.
We will denote the matrix on the right-hand side by A.
If we try a solution for the equation ˙x = Ax of the form x(t) = eλtv, then as we
saw above this leads to this eigenvalue problem
λv = Av.
To ﬁnd the eigenvalues of A we solve the equation det(A −λI) = 0; this is

1 −λ
1
4
−2 −λ
 = 0,
which gives the quadratic equation
(1 −λ)(−2 −λ) −4 = 0.

28.2 Changing coordinates
271
Multiplying this out and simplifying we obtain
λ2 + λ −6 = 0.
The solutions of this, λ = 2 or λ = −3, are the eigenvalues of A.
Now that we know the eigenvalues we can ﬁnd the corresponding eigenvectors.
If we write
v =

v1
v2

then when λ = 2 we need (A −2I)v = 0, i.e.

1
1
4
−2

−

2
0
0
2

v =

−1
1
4
−4
 
v1
v2

= 0,
We obtain two equations relating v1 and v2,
v1 −v2 = 0
and
4v1 −4v2 = 0,
and so v1 = v2. A representative eigenvector is therefore
v1 =

1
1

.
For λ = −3 we want the eigenvector v2 = (v1, v2) to solve (A + 3I)v = 0,

1
1
4
−2

−

−3
0
0
−3

v =

4
1
4
1
 
v1
v2

= 0.
This provides just one equation relating v1 and v2,
4v1 + v2 = 0,
so v2 = −4v1, and
v2 =

 1
−4

is an eigenvector.
The general solution is therefore (cf. (28.1))
x(t) = Ae2t

1
1

+ Be−3t

 1
−4

.
28.2 Changing coordinates
When we have two distinct real eigenvalues we will change to a coordinate sys-
tem that uses the eigenvectors as axes. It is a general result that eigenvectors

272
28 Distinct real eigenvalues
x
v1
v2
Fig. 28.1. Writing x as a combination of v1 and v2; here x = 2v1 + v2.
corresponding to different eigenvalues are linearly independent (see Appendix B),
which means that any vector can be written as an appropriate linear combination
of v1 and v2,
x =

 x
y

= ˜xv1 + ˜yv2,
(28.3)
see Figure 28.1.
Writing (28.3) in full gives

 x
y

=

 ˜xv11 + ˜yv21
˜x
+ ˜yv22

(where vi j is the jth component of vi). We could also write this as

 x
y

=

v11
v21
v12
v22
 
 ˜x
˜y

,
or more conveniently
x = [v1 v2] ˜x,
(28.4)
where ˜x = (˜x, ˜y) and we are using the notation [v1 v2] to mean the 2 × 2 matrix
with columns v1 and v2. To further simplify notation, we will write P = [v1 v2],
so (28.4) is just x = P˜x. To ﬁnd ˜x given x, we have to multiply both sides by the
v12

28.2 Changing coordinates
273
inverse of P,
˜x = P−1x = [v1 v2]−1x.
(28.5)
In order to write the differential equation
dx
dt = Ax
(28.6)
in these new coordinates, we need to calculate d˜x/dt in terms of ˜x. Using (28.5),
the original equation (28.6), and (28.4), we have
d˜x
dt = d
dt (P−1x)
= P−1 dx
dt
= P−1Ax
= P−1AP ˜x,
where we have used x = P˜x in the last line. We have obtained a new linear equation
for ˜x,
d˜x
dt = P−1AP ˜x.
(28.7)
Although this looks more complicated, if we now substitute for P we have
P−1AP = [v1 v2]−1A[v1 v2]
= [v1 v2]−1[Av1 Av2]
= [v1 v2]−1[λ1v1 λ2v2].
That A[v1 v2] = [Av1 Av2] follows from the deﬁnition of matrix multiplication
(see Appendix B), and then since Av j = λ jv j we have [Av1 Av2] = [λ1v1 λ2v2].
We can rewrite
[λ1v1 λ2v2] =

λ1v11
λ2v21
λ1v12
λ2v22

=

v11
v21
v12
v22
 
λ1
0
0
λ2

= [v1 v2]

λ1
0
0
λ2

,
and so we have
P−1AP = [v1 v2]−1[v1 v2]

λ1
0
0
λ2

=

λ1
0
0
λ2

.

274
28 Distinct real eigenvalues
Therefore the equation for ˜x is
d˜x
dt =

λ1
0
0
λ2

˜x,
(28.8)
which in terms of the coordinates ˜x and ˜y is
d˜x/dt = λ1 ˜x
d ˜y/dt = λ2 ˜y.
(28.9)
We have obtained equations for ˜x and ˜y that are no longer coupled. We can solve
these equations easily to ﬁnd the solutions
˜x(t) = Aeλ1t
and
˜y(t) = Beλt.
Note that if we use the expression x = ˜xv1 + ˜yv2 for x in terms of ˜x and ˜y (this
was equation (28.3)) then we recover the general solution of the original problem
as given in (28.1),
x(t) = Aeλ1tv1 + Beλ2tv2.
We now apply these ideas to the differential equation we considered as Exam-
ple 28.1. Note that this is not a sensible way to ﬁnd the explicit solution of the
coupled equations in the example, since we can write down this solution as soon
as we know the eigenvalues and eigenvectors of A.
Example 28.2 By means of an appropriate coordinate transformation decouple
the equations
˙x = x + y
˙y = 4x −2y
and hence write down their general solution.
Rewriting the equation in matrix form we have
˙x =

1
1
4
−2




A
x.
We found the eigenvalues and eigenvectors of the matrix A for Example 28.1: they
are
λ1 = 2
with
v1 =

1
1

and
λ2 = −3
with
v2 =

 1
−4

.
Note that v1 and v2 are linearly independent; if
α

1
1

+ β

 1
−4

= 0

28.2 Changing coordinates
275
then α + β = 0 and α −4β = 0. The only solution of these two equations is α =
β = 0, and so the two vectors are linearly independent as claimed.
In order to write a vector x in terms of these two eigenvectors,

 x
y

= ˜xv1 + ˜yv2,
(28.10)
we need

 x
y

= ˜x

1
1

+ ˜y

 1
−4

=

 ˜x + ˜y
˜x −4 ˜y

=

1
1
1
−4




P

 ˜x
˜y

(‘x = P˜x’).
Multiplying the extreme left- and right-hand sides of this equation by P−1 will
give ˜x in terms of x,

 ˜x
˜y

=

1
1
1
−4
−1 
 x
y

.
Computing the inverse we arrive at

 ˜x
˜y

= 1
5

4
1
1
−1
 
 x
y

,
i.e.
˜x = 1
5(4x + y)
and
˜y = 1
5(x −y).
Referred to these new coordinate axes the equation becomes
d˜x
dt = P−1AP ˜x
= 1
5

4
1
1
−1
 
1
1
4
−2
 
1
1
1
−4

˜x
= 1
5

4
1
1
−1
 
2
−3
2
12

˜x
= 1
5

10
0
0
−15

˜x
=

2
0
0
−3

˜x.
So in our new variables we obtain the decoupled equations
d ˜x
dt = 2˜x
d ˜y
dt = −3 ˜y.

276
28 Distinct real eigenvalues
The solutions of these can easily be seen to be ˜x(t) = Ae2t and ˜y(t) = Be−3t, and
so the solution of the original equation can be recovered from (28.10),
x(t) = Ae2t

1
1

+ Be−3t

 1
−4

.
28.3 Phase diagrams for uncoupled equations
We have just seen that in a new coordinate system ˜x = (˜x, ˜y) that uses the eigen-
vectors as axes the original equation becomes
d˜x
dt =

λ1
0
0
λ2

˜x.
(28.11)
This gives the two decoupled equations d˜x/dt = λ1 ˜x and d ˜y/dt = λ2 ˜y, whose
solutions are
˜x(t) = ˜x0eλ1t
and
˜y(t) = ˜y0eλ2t.
(28.12)
We now draw the phase diagram for (28.11), assuming that λ1 and λ2 are both
non-zero (for the exceptional case when one of them is zero see Exercise 28.6).
We can use our explicit form for ˜x(t) and ˜y(t) in order to ﬁnd the equation of the
curves traced out by these solutions as t increases.1 Since

 ˜x(t)
˜x0
λ2/λ1
= eλ2t
we have

 ˜y(t)
˜y0

=

 ˜x(t)
˜x0
λ2/λ1
.
So the trajectories will trace out the curves
˜y = K ˜xλ2/λ1,
where the constant K depends on the initial conditions (in fact we have K =
˜y0 ˜x−λ2/λ1
0
). Note that it is also easy to see from (28.12) that given an initial con-
dition on one of the axes (˜x(0) = 0 or ˜y(0) = 0) then the solution remains on the
axis; we say that the axes are invariant.
If both eigenvalues are negative then ˜x and ˜y decrease to zero as t increases.
Suppose that λ1 < λ2 < 0; then λ1/λ2 > 1, and a typical phase portrait is shown
1 It is also possible to derive this equation from (28.9), without ﬁnding the solutions ﬁrst, by solving the equation
d ˜y/d˜x = λ2 ˜y/λ1 ˜x, see Exercise 28.4.

28.3 Phase diagrams for uncoupled equations
277
Fig. 28.2. A stable node.
0
0.5
1
1.5
2
2.5
3
3.5
4
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
t
x
0
0.5
1
1.5
2
2.5
3
3.5
4
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
t
y
~
~
Fig. 28.3. Plots of ˜x(t) [solid line] and ˜y(t) [dotted line] against t. Both ˜x and ˜y
decay to zero, but note that ˜x decays to zero much faster than ˜y. (In the pictures
d˜x/dt = −3˜x and d ˜y/dt = −˜y.)
in Figure 28.2 (like the graph of x = K yr with r > 1; a ‘rotated parabola’ when
r = 2). In this case the origin is called a stable node. Note that the axes are invari-
ant as remarked above.
The axis associated with the faster rate of decay has been marked with two
arrows on the ﬁgure; the solutions approach the origin, tangential to the direction
corresponding to the value of λ with smaller modulus. You can see the reason
for this by imagining the x component of the solution decaying very fast, so that
the trajectory gets close to the y-axis quickly, and then tends towards the origin
‘almost vertically’. You can see this in Figure 28.3, which shows the graphs of
˜x(t) and ˜y(t) against t for some sample initial conditions.
If both eigenvalues are positive then both ˜x and ˜y tend to ±∞depending on
the signs of the initial conditions. Suppose that λ2 > λ1 > 0; then λ2/λ1 > 1 and
solutions move on curves like those shown in Figure 28.4: the graph is similar to
y = K xr with r > 1 (e.g. a parabola when r = 2).

278
28 Distinct real eigenvalues
Fig. 28.4. An unstable node.
Fig. 28.5. A saddle point.
The direction in which growth is faster has been marked with a double arrow;
note that solutions move away from the origin tangent to the direction that cor-
responds to slower growth (the smaller value of λ). In this situation the origin is
known as an unstable node.
If λ1 and λ2 are of opposite signs then one of ˜x and ˜y increases, while the
other decreases; there is one ‘stable direction’ and one ‘unstable direction’. For
example, if λ2 < 0 < λ1 then ˜x(t) tends to ±∞while ˜y(t) tends to zero. The
phase diagram is shown in Figure 28.5; the curves have equations like xyr = K
(e.g. when r = 1 they are hyperbolae). The origin is called a saddle point, or
just a saddle. (The behaviour here is like a ball rolling on a horse’s saddle, see
Figure C.1, for example.)

28.4 Phase diagrams for coupled equations
279
Fig. 28.6. In the left-hand picture (˜x coordinates) the eigenvectors appear as
orthogonal axes; in the right-hand picture the axes have ‘twisted’ back to their
true positions, moving all the other trajectories too.
28.4 Phase diagrams for coupled equations
Once we have drawn the phase diagram for the (˜x, ˜y) variables it is fairly straight-
forward to draw the phase diagram for the original (x, y) variables.
The transformation we used to change coordinates had the effect of making the
eigenvectors of the matrix A the coordinates axes for the new variables ˜x. This
means that the ˜x and ˜y axes, at right-angles in the phase diagrams we drew in Fig-
ures 28.2, 28.4 and 28.5, actually correspond to the eigenvectors in the (x, y) plane.
When we transform a picture in the (˜x, ˜y) plane back to the (x, y) plane the
axes will ‘twist’ and line up with the eigenvectors. To draw the phase diagram in
the (x, y) plane we also have to ‘twist’ all the other trajectories accordingly; this
is illustrated in Figure 28.6 for the case of a saddle point.
In order to draw the phase diagram for a particular example it is not necessary
to make the transformation to the new coordinate system, draw the phase portrait
there, and then transform it back. Instead, once you have found the eigenvalues and
eigenvectors ﬁrst draw the eigenvectors (in the (x, y) plane), label the eigenvectors
with an arrow in the appropriate direction (away from the origin if the eigenvalue
is positive and so corresponds to an unstable direction, towards the origin if the
eigenvalue is negative and thus corresponds to a stable direction), and then ‘ﬁll in’
between the two eigenvectors in a consistent way. This idea is illustrated in the
following example.
Example 28.3 By ﬁnding the eigenvectors and eigenvalues of an appropriate ma-
trix draw the phase portrait for the equation
˙x = x + y
˙y = 4x −2y.

280
28 Distinct real eigenvalues
This is the same example we looked at above; we have already found the eigen-
values and eigenvectors of A =

1
1
4
−2

, which are
λ1 = 2
with
v1 =

1
1

and
λ2 = −3
with
v2 =

 1
−4

.
To draw the phase portrait, ﬁrst we draw lines in the direction of the eigenvectors,
and add arrows according to the sign of the eigenvalue, as in Figure 28.7. It is then
4
3
2
1
0
1
2
3
4
4
3
2
1
0
1
2
3
4
Fig. 28.7. First draw the eigenvectors and add arrows; away from the origin if
λ > 0, towards the origin if λ < 0.
Fig. 28.8. The phase portrait for the differential equation of Example 28.3.

28.5 Stable and unstable manifolds
281
Fig. 28.9. Stable manifolds for a stable node (the whole plane), a saddle point
(the eigenvector corresponding to the negative eigenvalue) and an unstable node
(just the origin).
simple to add more illustrative trajectories to give the complete phase diagram of
Figure 28.8.
28.5 Stable and unstable manifolds
We now introduce some terminology that will prove extremely useful when we
come to study nonlinear systems. At present it may seem overly complicated, but
it is easier to understand in these simple linear examples.
The stable manifold2 of the origin, written W s(0), is all those points lying on
trajectories that approach the origin as t →∞; for a stable node this stable man-
ifold is all of R2; for a saddle this stable manifold is just the eigenvector corre-
sponding to the negative eigenvalue; and for an unstable node the stable manifold
is just the origin. These alternatives are illustrated in Figure 28.9.
Note that when the origin is a saddle point its stable manifold separates the plane
into two parts; in our picture all the points to the right of the stable manifold move
away ‘to the right’ (so to x = +∞), while all the points to its left move away
‘to the left’ (to x = −∞). In this case the stable manifold plays a particularly
signiﬁcantly rˆole and is often called the ‘separatrix’.
The unstable manifold of the origin, written as W u(0), is not quite ‘all those
points that move away from the origin’; it consists of all those points lying on
trajectories that would approach the origin if we reversed the sense of time, i.e. re-
versed their arrows. When the origin is a stable node its unstable manifold is just
{0}; for a saddle point the eigenvector corresponding to the positive eigenvalue is
the unstable manifold; and for an unstable node the unstable manifold is the whole
of R2, see Figure 28.10.
2 A manifold is an abstract mathematical object; the easiest way of imagining it is as a generalisation of a
‘surface’. In the relatively simple systems we are looking at here this generality will not be needed, although
we will see some of the possible complexity in the ﬁnal chapter when we consider the Lorenz equations. It is
probably more helpful for now to think of W s(0) as the ‘stable set’ of the origin.

282
28 Distinct real eigenvalues
Fig. 28.10. Unstable manifolds for a stable node (just the origin), a saddle point
(the eigenvector corresponding to the positive eigenvalue) and an unstable node
(the whole plane).
Exercises
28.1 Write down the general solution and draw the phase portrait for the equation ˙x = Ax,
when the eigenvalues and eigenvectors of A are as follows. You should take particular
care with stable (or unstable) nodes to ensure that the trajectories approach (or move
away from) the origin tangent to the correct eigenvector.
(i) λ1 = 1, v1 = (1, 1) and λ2 = 2, v2 = (1, −1);
(ii) λ1 = 1, v1 = (1, 0) and λ2 = −2, v2 = (1, 1);
(iii) λ1 = −2, v1 = (1, 2) and λ2 = −3, v2 = (2, −3);
(iv) λ1 = 3, v1 = (2, 3) and λ2 = −5, v2 = (0, 1);
(v) λ1 = 3, v1 = (1, 2) and λ2 = 1, v2 = (1, −3);
(vi) λ1 = 2, v1 = (0, 1) and λ2 = −3, v2 = (1, 5);
(vii) λ1 = 1, v1 = (1, 1) and λ2 = 2, v2 = (2, 1); and
(viii) λ1 = −3, v1 = (1, 3) and λ2 = −1, v2 = (−3, 2).
28.2 For the following equations ﬁnd the eigenvalues and eigenvectors of the matrix on the
right-hand side, and hence ﬁnd the coordinate transformation that will decouple the
equations. Show that this transformation has the desired effect. (You can also write
down the general solution and draw the phase portrait for the equation if you wish.)
(i)
dx
dt =

8
14
7
1

x
(ii)
dx
dt =

 2
0
−5
−3

x
(iii)
dx
dt =

11
−2
3
4

x
and

Exercises
283
(iv)
dx
dt =

 1
20
40
−19

x.
28.3 (C) Given a matrix
A =

a
b
c
d

,
the M-ﬁle lportrait.m will draw the phase portrait for the linear equation ˙x = Ax.
The program draws the trajectory forwards and backwards from a given initial condi-
tion, placing an arrow there indicating the direction the solution moves as t increases.
Draw the phase portraits for the equations in the previous exercise using this program.
28.4 (T) Using the chain rule, if y = y(x(t)) then
dy
dt = dy
dx
dx
dt ,
from which it follows that
dy
dx = dy
dt
)dx
dt .
Therefore if
dx
dt = λ1x
and
dy
dt = λ2y
(E28.1)
we have
dy
dx = λ2y
λ1x .
Solve this to ﬁnd the equation of the curves traced out by trajectories of (E28.1).
28.5 (T) We have seen in this chapter that if A has distinct real eigenvalues λ1 and λ2, with
corresponding eigenvectors v1 and v2, then
P−1AP =

λ1
0
0
λ2

,
where P = [v1 v2]. It follows, conversely, that the matrix with these eigenvalues and
eigenvector is
A = P

λ1
0
0
λ2

P−1.
(This is how the M-ﬁle makematrix.m constructs matrices with speciﬁed eigenval-
ues and eigenvectors.) Find the matrices whose eigenvalues and eigenvectors are as
follows:
(i) λ1 = 3, v1 = (1, 2) and λ2 = 6, v2 = (1, −1);
(ii) λ1 = 3, v1 = (1, 0) and λ2 = −1, v2 = (2, 1); and
(iii) λ1 = 5, v1 = (1, 1) and λ2 = 1, v2 = (1 −1, ).

284
28 Distinct real eigenvalues
(You could now check your phase portraits for Exercise 28.1, using the M-ﬁle
makematrix.m to ﬁnd the matrix with the speciﬁed eigenvalues and eigenvectors,
and then lportrait.m to draw the phase portraits.)
28.6 Suppose that A has two eigenvalues, λ1 = 0 with eigenvector v1 and λ2 ̸= 0 with
eigenvector v2.
(i) Write down the general solution of the equation ˙x = Ax.
(ii) After changing to a coordinate system referred to the eigenvectors the equation
will become
d˜x
dt =

0
0
0
λ2

˜x,
i.e
d ˜x
dt = 0
and
d ˜y
dt = λ ˜y.
By solving these equations draw the phase portrait in the (˜x, ˜y) system, and
hence sketch the phase portrait for the original coordinates.
(iii) Draw the phase portrait for the equation
dx
dt =

−2
2
1
−1

x.

29
More phase portraits: complex eigenvalues
We have seen how to ﬁnd explicit solutions of the equation ˙x = Ax, and how to
draw the corresponding phase portrait, when the matrix A has a pair of distinct real
eigenvalues. In this chapter we treat the ﬁrst of the two remaining possibilities; a
complex conjugate pair of eigenvalues λ± = ρ ± iω, with a corresponding pair of
complex conjugate eigenvectors η± = v1 ± iv2.
29.1 The explicit solution
If all you want is an explicit solution then it is unlikely that you would want to
ﬁnd the eigenvalues and eigenvectors and use the method here, since the method of
Chapter 26 is much simpler. However, if you have the eigenvalues and eigenvectors
of the matrix then this method will provide you with the explicit solution after only
a little work.
If we try to construct the general solution of ˙x = Ax as we did in the previous
chapter, by setting x(t) = Ceλ+tη+ + Deλ−tη−, we obtain
x(t) = Ce(ρ+iω)t[v1 + iv2] + C∗e(ρ−iω)t[v1 −iv2].
Here we have taken the ﬁrst coefﬁcient to be a complex number C = α + iβ, and
the second to be C∗(its complex conjugate), which ensures that x(t) is real.
We therefore have (since z∗+ z = 2 Re[z])
x(t) = 2 Re [Ce(ρ+iω)t(v1 + iv2)].
(29.1)
Since C = α + iβ this is
x(t) = 2eρt Re [(α + iβ)(cos ωt + i sin ωt)(v1 + iv2)]
= 2eρt Re [((α cos ωt −β sin ωt) + i(β cos ωt + α sin ωt))(v1 + iv2)]
= 2eρt[(α cos ωt −β sin ωt)v1 −(β cos ωt + α sin ωt)v2].
285

286
29 Complex eigenvalues
Since α and β are arbitrary constants we can set A = 2α and B = −2β, so that
the general solution is ﬁnally
x(t) = eρt[(A cos ωt + B sin ωt)v1 + (B cos ωt −A sin ωt)v2].
(29.2)
We illustrate this method to ﬁnd, once again, the solution of Example 26.2. It is
probably better to go through the algebra each time than try to remember (29.2).
Example 29.1 Find the general solution of the equation
˙x = 2x + 5y
˙y = −2x.
We found the eigenvalues and eigenvectors of the matrix

 2
5
−2
0

in Exam-
ple 27.5,
ρ ± iω = 1 ± 3i
with eigenvectors
v1 ± iv2 =

 5
−1

± i

0
3

.
Therefore, using (29.1),
x(t) = 2Re

(α + iβ)e(1+3i)t

 5
−1

+ i

0
3
0
= 2etRe

(α + iβ)(cos 3t + i sin 3t)

 5
−1

+ i

0
3
0
= 2etRe

(α cos 3t −β sin 3t) + i(β cos 3t −α sin 3t)

×

 5
−1

+ i

0
3
0
= 2et

(α cos 3t −β sin 3t)

 5
−1

−(β cos 3t −α sin 3t)

0
3
0
With C = 2α and D = −2β we obtain

 x(t)
y(t)

= et

5C cos 3t + 5D sin 3t
(3D −C) cos 3t −(3C + D) sin 3t

,
which agrees with the solution (26.6) that we obtained earlier.
□

29.2 Changing coordinates and the phase portrait
287
Although the formula in (29.2) does provide us with an explicit solution, it is
still not obvious how the solution behaves. Drawing the phase portrait will make
things much clearer.
29.2 Changing coordinates and the phase portrait
We now make a coordinate transformation to put the equation into a standard form,
choosing the real and imaginary parts of the eigenvectors, v1 and v2, as our new
axes. If you want to avoid the details, you should go to equation (29.6) which gives
the form of the differential equation in these new coordinates.
Before we make our change of coordinates, it will be useful to note that since
η+ = v1 + iv2 is an eigenvector of A with eigenvalue λ+ = ρ + iω, we have
A[v1 + iv2] = (ρ + iω)[v1 + iv2] = (ρv1 −ωv2) + i(ωv1 + ρv2).
Taking real and imaginary parts of this equation gives
Av1 = ρv1 −ωv2
and
Av2 = ωv1 + ρv2.
(29.3)
It is relatively straightforward to check that v1 and v2 are linearly independent,
see Exercise 29.4, so we can write any vector as a linear combination
x = ˜xv1 + ˜yv2.
(29.4)
We saw above in (28.7) that if we make this coordinate transformation then we can
write
x = [v1 v2] ˜x
and the differential equation satisﬁed by ˜x is
d˜x
dt = [v1 v2]−1A[v1 v2] ˜x.
In the current case we have
[v1 v2]−1A[v1 v2] = [v1 v2]−1[Av1 Av2]
= [v1 v2]−1[ρv1 −ωv2
ωv1 + ρv2]
= [v1 v2]−1[v1 v2]

 ρ
ω
−ω
ρ

=

 ρ
ω
−ω
ρ

.

288
29 Complex eigenvalues
So we have obtained an equation for ˜x which is in the standard, simpler form
d˜x
dt =

 ρ
ω
−ω
ρ

˜x.
(29.5)
Example 29.2 By means of an appropriate choice of coordinates transform the
equations
˙x = 2x + 5y
˙y = −2x
into the standard form
d˜x
dt =

 1
3
−3
1

˜x.
The eigenvectors were found in Example 27.5. They are
v1 ± iv2 =

 5
−1

± i

0
3

,
corresponding to the eigenvalues 1 ± 3i. We therefore set
x = ˜x

 5
−1

+ ˜y

0
3

=

 5
0
−1
3




P
˜x,
and so
˜x = 1
15

3
0
1
5

x.
The equation satisﬁed by ˜x is
d˜x
dt = P−1AP˜x
= 1
15

3
0
1
5
 
 2
5
−2
0
 
 5
0
−1
3

˜x
= 1
15

 6
15
−8
5
 
 5
0
−1
3

˜x
= 1
15

 15
45
−45
15

˜x
=

 1
3
−3
1

˜x,
as required. Note that, since λ± = 1 ± 3i, this agrees with (29.5).
□

29.2 Changing coordinates and the phase portrait
289
θ
r
(x,y)
(0,0)
~ ~
Fig. 29.1. Plane polar coordinates; ˜x = r cos θ and ˜y = r sin θ.
Since the equation in the new coordinates is
d˜x
dt =

 ρ
ω
−ω
ρ

˜x,
(29.6)
the equations for the components ˜x and ˜y are
d ˜x
dt = ρ ˜x + ω ˜y
d ˜y
dt = −ω ˜x + ρ ˜y.
(29.7)
The easiest way to understand how the solutions of this equation behave is to
change coordinates yet again, this time into plane polar coordinates. For ˜x = (˜x, ˜y)
we set
˜x = r cos θ
and
˜y = r sin θ,
(29.8)
see Figure 29.1. Then
r2 = ˜x2 + ˜y2
and
θ = tan−1( ˜y/˜x).
In order to ﬁnd the equations satisﬁed by r and θ we differentiate using the chain
rule (see Appendix C),
2r ˙r = 2˜x ˙˜x + 2 ˜y ˙˜y
⇒
˙r = ˜x ˙˜x + ˜y ˙˜y
r
and
˙θ =
1
1 + ( ˜y/˜x)2
˜x ˙˜y −˜y ˙˜x
˜y2
= ˜x ˙˜y −˜y ˙˜x
r2
.
Substituting in for ˙˜x and ˙˜y from (29.7) we get the simple system
˙r = ρr
˙θ = −ω.

290
29 Complex eigenvalues
0
Fig. 29.2. The phase portrait of a stable spiral point, and the graphs of a sample
solution with ˜x(t) (solid line) and ˜y(t) (dotted line) plotted against t. Solutions
tend to zero, oscillating as they go.
These equations we can solve easily,1
r(t) = r(0)eρt
and
θ(t) = θ(0) −ωt.
The trajectories spiral round the origin with angular velocity −ω, and when ρ ̸= 0
the distance from the origin either increases exponentially to inﬁnity if ρ > 0, or
decreases to zero exponentially if ρ < 0.
Note that once again the stability of the origin is determined by the eigenvalues.
If the real part of the eigenvalues is negative the origin is stable, and called a stable
spiral. This case is illustrated in Figure 29.2, with the graphs of ˜x(t) and ˜y(t) for
some sample solutions shown alongside.
If the real part of the eigenvalues is positive then the origin is an unstable spiral,
as illustrated in Figure 29.3.
When the eigenvalues are purely imaginary then ρ = 0 and so ˙r = 0; the dis-
tance r from the origin is constant. In this case the orbits are circles centred at
the origin, as in Figure 29.4. Since the motion repeats itself periodically as it goes
round and round the same closed curve, the solutions ˜x(t) and ˜y(t) repeated them-
selves periodically, and such curves are called periodic orbits. In this case the
origin is referred to as a centre. Note that a centre is stable (if you start close to it
you stay close to it) but it is not attracting (trajectories do not tend to it).
1 Given the solutions in this form we can write down the general solution of our original equation in a more
memorable way than we did in Section 29.1. It follows from (29.8) that
˜x(t) = Reρt cos(T −ωt)
and
˜y(t) = Reρt sin(T −ωt),
where R = r(0) > 0 and T = θ(0) will be the arbitrary constants in our solution; using (29.4) we have
x(t) = Reρt *
cos(T −ωt)v1 + sin(T −ωt)v2
+
.

29.3 The phase portrait for the original equation
291
0
Fig. 29.3. An unstable spiral, along with the graph of a sample solution against t
(˜x(t) solid, ˜y(t) dotted). Solutions oscillate, but the amplitude of the oscillations
tends exponentially to inﬁnity.
0
Fig. 29.4. A centre; the phase portrait consists of closed curves around the origin.
The solutions repeat periodically with period 2π/ω, where ω is the imaginary part
of the eigenvalues, as shown on the right, where a sample solution (˜x(t) solid, ˜y(t)
dotted) is plotted against t.
29.3 The phase portrait for the original equation
Note that in all three of these cases the rˆole played by the eigenvectors (rather
than the eigenvalues) is not as clear as it was in the case when the eigenvalues
were distinct real numbers. Indeed, ‘twisting’ any of these pictures will still leave
them qualitatively the same (although generally circles will be deformed into el-
lipses). You can therefore base your phase portrait for the original equation entirely
on the eigenvalues and still obtain an accurate picture. We illustrate this for the
example (27.5) that started this section.

292
29 Complex eigenvalues
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
−1
−0.8
−0.6
−0.4
−0.2
0
0.2
0.4
0.6
0.8
1
Fig. 29.5. How to ﬁnd out which way orbits rotate around the origin.
Example 29.3 Draw the phase portrait for the equation
˙x =

 2
5
−2
0

x.
(29.9)
We have already found the eigenvalues of the matrix that occurs in this equation:
they are 1 ± 3i. So the origin is an unstable spiral. Since the imaginary part (which
is what makes the trajectories ‘spin’ around the origin) is ±i, you cannot just read
off the direction in which the trajectories ‘rotate’. The best way is to concentrate
on a line level with the origin, either x = 0 or y = 0, and by looking at ˙y or ˙x
work out the direction in which the trajectories are going. If you look on x = 0
with y > 0 then ˙x = y > 0 and trajectories are moving to the right, so the rotation
is clockwise; similarly on y = 0 with x > 0 we have ˙y = −2x < 0, so the motion
is downwards, which once again shows that trajectories are rotating clockwise. See
Figure 29.5.
It is now simple to draw the phase portrait, which is shown in Figure 29.6, along
with the graphs of x(t) and y(t) for a sample solution.
Exercises
29.1 Draw the phase portrait for the equation dx/dt = Ax, when the eigenvalues (λ±) and
eigenvectors (η±) of A are as follows. Also given is the sign of ˙x when x = 0 and
y > 0.
(i) λ± = 1 ± 3i with η± = (1, 2 ∓i), ˙x < 0;
(ii) λ± = ±3i with η± = (1 ± 2i, 1 ∓3i), ˙x < 0;

Exercises
293
0
1
2
3
−1000
−500
0
500
1000
1500
2000
Fig. 29.6. The phase portrait for equation (29.9), and the graph of a sample solu-
tion plotted against t, with x(t) solid and y(t) dotted.
(iii) λ± = −2 ± i with η± = (1 ∓i, 3 ± i), ˙x > 0;
(iv) λ± = −1 ± i with η± = (1, ±i), ˙x > 0;
(v) λ± = 2 ± 2i with η± = (±3i, 5 ∓4i), ˙x < 0;
(vi) λ± = 5 ± 3i with η± = (2 ± 5i, ∓i), ˙x < 0;
(vii) λ± = ±7i with η± = (1 ± i, −1 ± 2i), ˙x > 0; and
(viii) λ± = −13 ± 17i with η± = (±6i −8, 4 ∓5i), ˙x > 0.
29.2 Write down the general solution of the equation dx/dt = A when the eigenvalues
(λ±) and eigenvectors (η±) of A are those in the previous exercise.
29.3 For the following equations ﬁnd the eigenvalues and eigenvectors of the matrix on
the right-hand side, and hence ﬁnd the coordinate transformation that will put the
equations into their standard simple (canonical) form. Show that this transformation
has the desired effect.
(i)
dx
dt =

0
−1
1
−1

x;
(ii)
dx
dt =

−2
3
−6
4

x;
(iii)
dx
dt =

−11
−2
13
−9

x;
and
(iv)
dx
dt =

 7
−5
10
−3

x.

294
29 Complex eigenvalues
29.4 (T) In the previous chapter we used the result that the eigenvectors corresponding to
distinct eigenvalues are linearly independent. Use this result to show that the real and
imaginary parts of complex eigenvectors are linearly independent.
29.5 (T) Following the same line of reasoning as in Exercise 28.5, show how to construct a
matrix with a complex conjugate pair of eigenvalues λ± = ρ ± iω and corresponding
eigenvectors η± = v1 ± iv2. Hence ﬁnd the matrices with the following eigenvalues
and eigenvectors:
(i) λ± = 3 ± 3i with η± = (2 ± i, 1 ∓i);
(ii) λ± = ±3i with η± = (±i, 3 ± 2i); and
(iii) λ± = −2 ± i with η± = (1 ± i, 1 ∓i).
(The M-ﬁle makematrix.m will do this for you. You could use this to check that
the signs of ˙x given in Exercise 29.1 are correct by ﬁnding the appropriate matrix A
and then looking at ˙x when x = 0 and y > 0.)

30
Yet more phase portraits: a repeated real eigenvalue
We now treat the ﬁnal case, in which the matrix A has a non-zero repeated real
eigenvalue. There are two very different situations in which this can happen, and
we will treat them separately. The case of a repeated eigenvalue zero is the subject
of Exercise 30.5.
30.1 A is a multiple of the identity: stars
The ﬁrst possibility is that A is a multiple of the identity,
A =

λ
0
0
λ

.
In this case the equation ˙x = Ax decouples with no extra work required on our
part,
˙x = λx
˙y = λy.
(In fact the equation would decouple in any coordinate system.) For such a matrix,
for any vector v we have Av = λv, and so all vectors are eigenvectors.
The phase portrait is particularly simple. Since any vector is an eigenvector,
x(t) = Aeλtv is a solution for any v; in particular x(t) = eλtx(0) is a solution, and
so solutions move on lines emanating from the origin. Depending on the sign of λ
we have a stable or unstable star; the phase portrait for the stable case is shown in
Figure 30.1.
30.2 A is not a multiple of the identity: improper nodes
When there is just one eigenvalue and the matrix is not a multiple of the identity
then things are more difﬁcult. In this case we will only be able to ﬁnd one eigen-
vector. Even though we only have one eigenvector it is still possible to ﬁnd a new
295

296
30 A repeated real eigenvalue
Fig. 30.1. A stable star.
coordinate system in which the matrix takes a ‘canonical form’, although the ar-
gument is a little subtle.
We will suppose that the eigenvalue is λ and that the corresponding eigenvector
is v. To begin, choose any vector v2 that is not in the same direction as v. Since
these two vectors are linearly independent they form a basis for R2, and we can
write any vector x as a linear combination of v2 and v.
We now show that v1 = (A −λI)v2 is in the same direction as v, i.e. is an eigen-
vector. To see this,1 we write v1 as a combination of the vectors v2 and v,
(A −λI)v2 = αv2 + βv,
and apply A −λI to both sides. The term on the right-hand side involving v van-
ishes (since v is an eigenvector with eigenvalue λ) and we obtain
(A −λI)[(A −λI)v2] = α[(A −λI)v2],
or
(A −λI)v1 = αv1.
But this says that Av1 = (λ + α)v1, i.e. that v1 is an eigenvector with eigenvalue
λ + α. Since there is only one eigenvalue we must have α = 0 and v1 must be an
eigenvector lying in the direction of v. Note that since v1 = (A −λI)v2 we have
Av2 = v1 + λv2.
(30.1)
1 A much more elegant, but less elementary, approach is to use the Cayley–Hamilton Theorem, see Exercises 30.2
and 30.3.

30.2 A is not a multiple of the identity: improper nodes
297
We now refer our coordinates to the axes v1 and v2,
x = ˜xv1 + ˜yv2,
and then, using (30.1) in the second line,
d˜x
dt = [v1 v2]−1A[v1 v2]˜x
= [v1 v2]−1[λv1 v1 + λv2]˜x
= [v1 v2]−1[v1 v2]

λ
1
0
λ

˜x.
In the new coordinates our original equation becomes
d˜x
dt =

λ
1
0
λ

˜x.
(30.2)
Writing this as a coupled system gives
˙˜x = λ˜x + ˜y
˙˜y = λ ˜y.
(30.3)
Note that although the equations have not completely decoupled, we can solve
the ˜y equation on its own; its solution is ˜y(t) = Aeλt. Substituting this for ˜y(t) in
the equation for ˜x,
d ˜x
dt = λ˜x + Aeλt.
This is a linear equation, and using the integrating factor e−λt we have
d
dt [e−λt ˜x(t)] = A.
Integrating between 0 and t we obtain e−λt ˜x(t) = At + B, and ﬁnally
˜x(t) = Beλt + Ateλt.
This means that the solution in the original variables is
x(t) = [Ateλt + Beλt]v1 + Aeλtv2,
(30.4)
where to use this formula you need to remember that v1 = (A −λI)v2. You are
probably better off using the ‘second order equation’ method of Chapter 26 if you
want to ﬁnd an explicit solution.
Drawing the phase diagram in this case is a little more difﬁcult than before,
even with the exact expressions for the solutions. You can get some idea of how

298
30 A repeated real eigenvalue
Fig. 30.2. The phase portrait for an improper node for λ > 0. On the dotted line
d˜x/dt = 0.
the picture should look as follows; we assume here that λ is positive. Note ﬁrst that
d ˜y/dt is positive when ˜y is positive, and negative when ˜y is negative; also, d˜x/dt
is positive while ˜y > −λ˜x, and is negative when ˜y < −λ˜x. Trajectories cross the
line ˜y = −λ˜x vertically. You should be able to put these ingredients together to get
something like the collection of ‘S’ shaped trajectories shown in the phase portrait
of Figure 30.2. The stability of the origin, referred to in this case as an improper
node, depends on whether λ is positive or negative.
Example 30.1 Draw the phase portrait for the equation
dx
dt =

5
−4
1
1

x.
(30.5)
We found the (repeated) eigenvalue λ = 3 of the matrix

5
−4
1
1

above (see
Example 27.4), and its solitary eigenvector (2, 1). To draw the phase portrait we
ﬁrst draw the eigenvector and label it with arrows moving away from the origin
(since the eigenvalue is positive). To work out whether the trajectories move on
a collection of ‘forwards’ or ‘backwards’ S shapes we can use the same method
as we did for the rotating cases; above the stationary point (x = 0 and y > 0)
we have ˙x = 5x −4y = −4y < 0 and so the trajectories are moving left, see
Figure 30.3.
□

Exercises
299
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
Fig. 30.3. On the left are the steps for drawing the phase portrait for equation
(30.5). On the dotted line ˙x = 5x −4y = 0; when y > 0 and x = 0 we have ˙x <
0. The phase portrait is on the right.
Exercises
30.1 Find the eigenvalue and eigenvector of the matrices occurring in the following equa-
tions, and hence draw the phase portrait. Find also the coordinate transformation that
will put the equation into canonical form and show that this works. Write down the
general solution.
(i)
dx
dt =

5
−4
1
1

x;
(ii)
dx
dt =

−6
2
−2
−2

x;
(iii)
dx
dt =

−3
−1
1
−5

x;
(iv)
dx
dt =

 13
0
0
13

x;
and
(v)
dx
dt =

7
−4
1
3

x.

300
30 A repeated real eigenvalue
30.2 (T) The characteristic equation for a 2 × 2 matrix
A =

a
b
c
d

is |A −kI| = 0, i.e.
k2 −(a + d)k + (ad −bc) = 0.
By explicit calculation show that A satisﬁes its own characteristic equation, i.e. that
A2 −(a + d)A + (ad −bc)I = O,
where O is the 2 × 2 matrix of zeros.This is a particular case of the Cayley-Hamilton
Theorem.
30.3 (T) If A has a repeated eigenvalue λ with eigenvector v then its characteristic equation
can be written
(k −λ)2 = 0.
Use the Cayley-Hamilton Theorem from the previous exercise to deduce that
(A −λI)2 = O,
and hence that (A −λI)x is an eigenvector of A for any choice of non-zero vector
x ̸= v.
30.4 (T) By following the ideas of Exercise 28.5, show how to construct a matrix with
a single eigenvalue λ and corresponding eigenvector v. (There will be many such
matrices.) Find two matrices with eigenvalue −1 and eigenvector (1, 1).
30.5 (T) Suppose that the matrix A has zero as a repeated eigenvalue, with eigenvector
v. Then we can change to coordinates referred to v2 and v1 = Av2, where v2 is any
vector in a different direction to v, so that ˜x = ˜xv1 + ˜yv2. The equation becomes
d˜x
dt =

0
1
0
0

˜x,
and so
d ˜x
dt = ˜y
and
˜y = 0.
(i) Solve the equations for ˜x(t) and ˜y(t), and hence write down the general solution
for x(t).
(ii) Draw the phase diagram in the (˜x, ˜y) plane, and hence in the (x, y) plane.
(iii) Draw the phase diagram for the equation
dx
dt =

−1
1
−1
1

x.

31
Summary of phase portraits for linear equations
When confronted with an example dx/dt = Ax you should ﬁrst calculate the
eigenvalues of A, and then if they are real calculate the eigenvectors. With this
information you can draw the phase portrait. The various possibilities are sum-
marised below, and illustrated in Figure 31.1.
(i) Distinct real eigenvalues
r λ1 < λ2 < 0 gives a stable node: all trajectories approach the origin, tangent to the
eigenvector corresponding to λ2.
r λ1 > λ2 > 0 gives an unstable node: all trajectories move away from the origin,
tangent to the eigenvector corresponding to λ2.
r λ1 < 0 < λ2 gives a saddle: the only trajectories to approach the origin are those
starting on the ‘stable eigenvector’, while all other trajectories move away.
(ii) Complex conjugate eigenvalues ρ ± iω (to ﬁnd the direction of rotation you need to
check, for example, the sign of ˙x on the line x = 0)
r ρ < 0 gives a stable spiral: all trajectories spiral into the origin.
r ρ > 0 gives an unstable spiral: all trajectories spiral out from the origin.
r ρ = 0, i.e. λ = ±iω, gives a centre: trajectories close and we have a family of peri-
odic orbits.
(iii) A repeated real eigenvalue
r The matrix is a multiple of the identity: we have a stable or unstable star depending
on the sign of the eigenvalue (λ < 0 gives stability, which is the case shown in
Figure 31.1).
r The matrix is not a multiple of the identity: we get the S-shaped phase portrait of an
improper node, whose stability depends on the sign of λ (stable for λ < 0).
31.1 *Jordan canonical form
The coordinate transformations that we have used in the previous three chapters
are those that put the matrix A into its Jordan canonical form. In order to ex-
plain this, we ﬁrst need to discuss the relationship between matrices and linear
301

302
31 Summary of phase portraits for linear equations
Stable node
Unstable node
Saddle point
Stable spiral
Unstable spiral
Centre
Stable star
Stable improper node
Unstable improper node
Fig. 31.1. Sample phase portraits listed by the stability type of the stationary
point: (i) distinct real eigenvalues on the ﬁrst row, (ii) complex eigenvalues on the
second row, (iii) equal real eigenvalues of the third row.
transformations. We will only do this for the case of linear transformations of the
plane.
31.1.1 Representation of vectors in different coordinate systems
A vector x lying in the plane can be speciﬁed without reference to a coordinate
system. For each particular choice of coordinate axes, x will be represented by a
different pair of coordinates. For example, if x has coordinates (x, y) with respect
to the coordinate axes e1 and e2 this means that
x = xe1 + ye2,

31.1 *Jordan canonical form
303
while with a different choice of axes, v1 and v2, say, the same vector would have
coordinates (˜x, ˜y), i.e.
x = ˜xv1 + ˜yv2.
Writing both expressions for x in matrix form we have
[e1 e2]

 x
y

= [v1 v2]

 ˜x
˜y

,
which enables us to transform between the two different coordinate systems,

 x
y

= S

 ˜x
˜y

and

 ˜x
˜y

= S−1

 x
y

,
(31.1)
where S = [e1 e2]−1[v1 v2].
31.1.2 Linear transformations of the plane and 2 × 2 matrices
A transformation of the plane L : x →L[x] is linear if
L[αx + βy] = αL[x] + βL[y]
for all x, y ∈R2 and all α, β ∈R. In particular, this means that
L[x] = L[xe1 + ye2] = xL[e1] + yL[e2],
and so in order to work out L[x] we only need to know L[e1] and L[e2].
For each choice of coordinates axes we can ﬁnd a matrix A such that if x has
coordinates (x, y), then L[x] has coordinates
A

 x
y

.
For example, if we work in the e1–e2 coordinate system, in which (x, y) represents
the point x = xe1 + ye2, then if
L[e1] = a11e1 + a21e2,
L[e2] = a12e1 + a22e2,
and we set
A =

a11
a12
a21
a22

,

304
31 Summary of phase portraits for linear equations
we have
A

 x
y

=

a11x + a12y
a21x + a22y

= x

a11
a21

+ y

a12
a22

,
which is how we write xL[e1] + yL[e2] = L[x] in the e1–e2 coordinate system.
If we were to change the coordinate axes then the matrix representing the trans-
formation L would have to change too. To ﬁnd the new matrix, suppose that
the point x has coordinates (˜x, ˜y) with respect to the axes v1 and v2, so that
x = ˜xv1 + ˜yv2. Then its coordinates (x, y) with respect to the axes e1 and e2 are
given by

 x
y

= S

 ˜x
˜y

(see (31.1)). We know that in the e1–e2 coordinate system, the coordinates of L[x]
can be found by multiplying by A, and so are
AS

 ˜x
˜y

.
Using (31.1) again the coordinates of the vector L[x] in the v1–v2 coordinate sys-
tem are
S−1AS

 ˜x
˜y

.
The upshot of this is that the transformation L is represented in the new coordinate
system by the matrix
B = S−1AS.
31.1.3 Similar matrices and the Jordan canonical form
We have seen that if two matrices A and B represent the same linear transformation
with respect to different coordinate axes then for some non-singular matrix S we
have
B = S−1AS.
Such matrices are said to be similar.
It is a natural question whether there is a particular choice of matrix S that will
ﬁnd the ‘simplest’ (in some way) matrix that is similar to a given matrix A. In other

Exercises
305
words, whether there is a ‘natural’ coordinate system in which the linear transfor-
mation L can be easily expressed.
There is such a form, known as the Jordan canonical form. All similar matrices
have the same eigenvalues, and the simplest matrix depends on these eigenvalues.
It is always one of the following possibilities, which should by now be familiar. If
A has distinct real eigenvalues λ1 and λ2 then the Jordan canonical form is

λ1
0
0
λ2

;
if A has a complex conjugate pair of eigenvalues ρ ± iω then the canonical form
is

 ρ
−ω
ω
ρ

;
and if A has only one eigenvalue λ then the canonical form is either

λ
0
0
λ

or

λ
1
0
λ

.
These possibilities follow from an analysis that closely parallels that of the previ-
ous three chapters.
Exercises
31.1 Draw the phase portrait for the equation dx/dt = Ax when the eigenvalues and eigen-
vectors of A are the following:
(i) λ1 = 3 with v1 = (1, 1) and λ2 = −2 with v2 = (1, −2);
(ii) complex conjugate eigenvalues λ± = −1 ± 3i, with ˙x < 0 when x = 0 and
y > 0;
(iii) a single eigenvalue λ = 13 with eigenvector (3, 2), and ˙x > 0 when x = 0 and
y > 0;
(iv) λ1 = −2 with v1 = (2, 1) and λ2 = −3 with v2 = (1, −1);
(v) a single eigenvalue λ = −3 with eigenvector (1, −1), and ˙x > 0 when x = 0
and y > 0;
(vi) λ = ±2i, where ˙y < 0 when y = 0 and x > 0;
(vii) λ1 = 1 with v1 = (3, 2) and λ2 = 5 with v2 = (1, −4);
(viii) λ = 5 ± i, and ˙y > 0 when y = 0 and x > 0; and
(ix) a single eigenvalue λ = −7, with the matrix A a multiple of the identity.


Part VI
Coupled nonlinear equations


32
Coupled nonlinear equations
We now turn our attention to coupled nonlinear systems. We will concentrate on
autonomous systems in which the right-hand side does not depend explicitly on
time,
dx/dt = f (x, y)
dy/dt = g(x, y).
(32.1)
Using the vector notation x = (x, y) and f(x) = ( f (x, y), g(x, y)), this equation
can be rewritten
dx
dt = f(x).
Our approach will be to try to understand the dynamics of these equations (the
behaviour of their solutions) in a qualitative way by drawing the phase diagram
in the (x, y) plane (‘the phase plane’), just as we have done for linear equations
in the past three chapters. We will ﬁnd that we can piece together the phase por
trait for nonlinear systems from a collection of phase portraits for linear (or near
ly linear) systems near the stationary points.
32.1 Some comments on phase portraits
A stationary point is a point (x∗, y∗) at which ˙x = ˙y = 0, i.e. where
f (x∗, y∗) = 0
and
g(x∗, y∗) = 0.
Because solutions are unique, it follows that if (x∗, y∗) is a stationary point then
solutions starting at (x∗, y∗) remain there for all time. The phase portraits we drew
in the previous chapters were fairly simple, since we only ever had a single sta-
tionary point at the origin.
309
-
-

310
32 Coupled nonlinear equations
x0
Fig. 32.1. Trajectories cannot cross; x0 must be a stationary point.
Our phase portraits will show the stationary points marked by crosses, and in-
clude a representative collection of trajectories (the curves traced out by solutions
as they change in time) with the direction of increasing time indicated by an arrow.
As with the phase diagrams we drew in Chapter 7 we lose any information about
the rates at which the solutions change, but may be able to understand their be-
haviour much more easily from the diagram than we would from an explicit solu-
tion.
An important point to notice is that curves in the phase diagram cannot cross
one another; this is a consequence of the uniqueness of solutions. If we had a
situation like that illustrated in Figure 32.1, with two curves emanating from a
point x0, then there would be two solutions starting at x0; this cannot happen,
since solutions are unique. The only way that we can get the kind of situation
pictured is if x0 is a stationary point. If this is the case there is no contradiction,
since although the trajectories meet at x0, they do not actually pass through it. (If
x(s) = x0 for some s, where x0 is a stationary point, then we must have x(t) = x0
for all t.) In all our phase diagrams for linear equations (see Figure 31.1) there
are apparent ‘crossings’; but they all occur at the origin, which is a stationary
point.
32.2 Competition of species
We will illustrate the general method by considering a simple ecological model for
two species that are competing for the same resources, e.g. a herd of sheep and
cows grazing over the same ﬁelds. If we denote the numbers of the two species
(measured, let us suppose, in hundreds) as x(t) and y(t) then in isolation we might
expect the size of both populations to obey the logistic equations
˙x = x(A −ax)
and
˙y = y(B −dy)
(32.2)

32.3 Direction ﬁelds
311
Fig. 32.2. The phase portrait for either species in isolation; the left stationary
point represents a population of zero, the right-hand one the equilibrium value
(x = A/a or y = B/d).
(with A, B, a, and d positive), cf. Section 8.5. In particular these equations predict
that left to themselves each species would settle down to a constant population
(for the ﬁrst, x = A/a, and for the second, y = B/d as can be seen from the phase
diagram in Figure 32.2).
However, since there are limited resources both species will be disadvantaged
by the presence of the other. So we would expect the model
˙x = x(A
−ax
−by

y inhibits x
)
˙y = y(B
−cx

x inhibits y
−dy)
with b and c positive to reﬂect this.
In this chapter we will consider these equation with a particular choice of the
parameters A, B, a, b, c, and d,
˙x = x(8 −4x −y)
˙y = y(3 −3x −y).
(32.3)
For these models we are only interested in the behaviour of the solutions for
x, y ≥0, since we want our populations to be positive. (It should be clear, however,
that the equations are mathematically sensible for any values of x and y.)
32.3 Direction ﬁelds
Given a coupled pair of nonlinear equations (similar to (32.3)) we can get a very
good indication of what the phase portrait should look like by drawing the direction
ﬁeld. This is a set of arrows pointing in the direction of the vector ˙x and whose
length is proportional to the magnitude of ˙x. The direction ﬁeld shows the direction
in which solutions move, and how fast. The curves traced out by solutions will be
everywhere tangential to the direction ﬁeld, since the ﬁeld shows how they are
moving instantaneously, see Figure 32.3.
The direction ﬁeld for equation (32.3) is shown in Figure 32.4, which was pro-
duced using MATLAB’s quiver command.
>> [x, y] = meshgrid(0:1/3:2.5, 0:1/3:3.5);
>> xd = x.*(8-4*x-y); yd= y.*(3-3*x-y);
>> quiver(x,y,xd,yd)

312
32 Coupled nonlinear equations
Fig. 32.3. A fanciful trajectory shown as a dotted line, and some arrows from
the direction ﬁeld tangential to it. The solution moves faster along the trajectory
where the arrows are larger.
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 32.4. The direction ﬁeld for equation (32.3).
Having drawn the direction ﬁeld, it should be relatively easy to ‘join the dots’
and draw the phase portrait as in Figure 32.5.
Of course, in practice it is not really convenient to draw so many arrows of the
direction ﬁeld unless you have access to a computer package. However, a related
approach that can be useful more generally is to draw the ‘nullclines’. These are
the lines (or curves) on which ˙x or ˙y is equal to zero. For our example ˙x = 0 when
x = 0 or when 8 −4x −y = 0, and ˙y is zero when y = 0 or 3 −3x −y = 0.
These nullclines are shown in Figure 32.6, along with some sample trajectories.

32.3 Direction ﬁelds
313
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 32.5. The phase portrait for equation (32.3).
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 32.6. The ‘nullclines’ for equation (32.3). The dashed line is 8 −4x −y =
0, on which ˙x = 0, and the dotted line is 3 −3x −y = 0, on which ˙y = 0. So,
from left to right, we have regions where x and y are both increasing; where x
increases but y decreases; and where x and y are both decreasing.

314
32 Coupled nonlinear equations
With some thought (and a lot of imagination) it might be possible to draw the phase
portrait if you know where the nullclines are. (We used the nullclines to draw the
phase portrait for the linear system with a repeated real eigenvalue in Section 30.2.)
However, we will concentrate here on the analytical method that enables us to
draw qualitatively accurate ‘sketches’ of the phase diagram using our knowledge
of linear systems.
32.4 Analytical method for phase portraits
The method has four stages:
r ﬁnd all the stationary points,
r linearise near the stationary points,
r draw the phase portrait near the stationary points, and then
r join up these ‘local’ phase portraits to give the global picture.
32.4.1 Step 1: ﬁnd the stationary points
Recall that the stationary points are those points at which x and y do not
change, i.e. those points (x∗, y∗) such that
f (x∗, y∗) = g(x∗, y∗) = 0. For
equations (32.3) we therefore need (x∗, y∗) to satisfy
x∗(8 −4x∗−y∗) = 0
and
y∗(3 −3x∗−y∗) = 0.
We can satisfy the ﬁrst equation if we choose x∗= 0. The second equation is then
satisﬁed if either y∗= 0 or y∗= 3. The choice y∗= 0 for the second equation also
allows x∗= 2 as a solution of the ﬁrst equation. A ﬁnal possibility is provided by
the solution of the simultaneous equations
8 −4x∗−y∗= 0
and
3 −3x∗−y∗= 0
gives x∗= 5 and y∗= −12. Since we are only interested in stationary points with
x∗and y∗non-negative, we can concentrate on the three stationary points
(0, 0),
(2, 0)
and
(0, 3).
32.4.2 Step 2: linearise near the stationary points
The next step is to determine the stability of the stationary points by linearising.
The idea, essentially, is to look at what happens ‘near to’ the stationary points.
To do this we suppose that x(t) is close to a stationary point x∗= (x∗, y∗), and
write
x(t) = x∗+ ξ(t)
and
y(t) = y∗+ η(t),
(32.4)

32.4 Analytical method for phase portraits
315
(x*,y*)
(x*+ξ,y*+η)
ξ
η
Fig. 32.7. Choosing new coordinates ξ = x −x∗and η = y −y∗near a station-
ary point (x∗, y∗).
where ξ(t) and η(t) are small, see Figure 32.7. The new coordinates (ξ, η) treat
(x∗, y∗) as the origin.
We now write down the equations satisﬁed by ξ(t) and η(t). Since x∗and y∗
are constants, it follows from differentiating the two equations in (32.4) that
˙x = ˙ξ
and
˙y = ˙η.
Therefore
˙ξ = ˙x = f (x, y) = f (x∗+ ξ, y∗+ η)
˙η = ˙y = g(x, y) = g(x∗+ ξ, y∗+ η).
Now we use the Taylor expansion of f and g about (x∗, y∗). Recall (or see
Appendix C) that the Taylor expansion of a function f of two variables is given by
f (x + ξ, y + η) = f + fxξ + fyη + 1
2 fxxξ2 + fxyξη + 1
2 fyyη2 + · · ·
where fx = ∂f/∂x, etc., and all the partial derivatives on the right-hand side are
evaluated at the point (x, y). Then
˙ξ = f (x∗, y∗) + ∂f
∂x (x∗, y∗) ξ + ∂f
∂y (x∗, y∗) η + · · ·
˙η = g(x∗, y∗) + ∂g
∂x (x∗, y∗) ξ + ∂g
∂y (x∗, y∗) η + · · · ,
where the ‘· · ·’ are terms of higher order in ξ and η. If ξ and η are sufﬁciently
small we would expect that we can ignore the higher order terms and still have a
good approximation of the rate of change of ξ(t) and η(t).

316
32 Coupled nonlinear equations
Since x∗is a stationary point we have f (x∗, y∗) = g(x∗, y∗) = 0, and so
˙ξ = ∂f
∂x (x∗, y∗) ξ + ∂f
∂y (x∗, y∗) η
˙η = ∂g
∂x (x∗, y∗) ξ + ∂g
∂y (x∗, y∗) η.
Notice that this is a linear equation which we can rewrite in matrix form as

 ˙ξ
˙η

=

 ∂f/∂x
∂f/∂y
∂g/∂x
∂g/∂y

|(x∗,y∗)

ξ
η

.
(32.5)
Alternatively, with ξ = (ξ, η) and using the compact notation
Df(x∗) =

 ∂f/∂x
∂f/∂y
∂g/∂x
∂g/∂y

|(x∗,y∗)
,
this becomes
dξ
dt = Df(x∗) ξ.
This equation is known as the ‘linearisation’ of (32.1) about the stationary point
(x∗, y∗), since by considering only solutions ‘sufﬁciently close’ to (x∗, y∗) we
have approximated the original nonlinear equation by a linear equation. From the
work we did in earlier chapters on linear equations we can understand the be-
haviour of this equation using only the eigenvalues and eigenvectors of the matrix
Df(x∗) =

 ∂f/∂x
∂f/∂y
∂g/∂x
∂g/∂y

|(x∗,y∗)
.
For our example, where
f (x, y) = x(8 −4x −y)
and
g(x, y) = y(3 −3x −y),
we have
Df(x, y) =

8 −8x −y
−x
−3y
3 −3x −2y

.
(32.6)
32.4.3 The Hartman–Grobman Theorem
It can be proved (but is well beyond the scope of this book) that the phase portrait
of the original nonlinear problem ‘sufﬁciently close’ to a stationary point looks
‘essentially the same’ as that of the linear equation in (32.5) provided that the
eigenvalues have non-zero real part. This result, known as the Hartman–Grobman

32.4 Analytical method for phase portraits
317
0. 5
0
0.5
0. 5
0
0.5
0. 5
0
0.5
0. 5
0
0.5
Fig. 32.8. The left-hand picture shows the phase portrait for the linearised equa-
tion close to the origin; the right-hand picture shows the phase portrait of the
nonlinear equation close to the origin. The two pictures are indistinguishable.
(Despite appearances this is an honest ﬁgure, with one picture produced using the
linearisation and one using the full nonlinear equation!)
Theorem, gives the mathematical foundation for the whole technique that we will
be using.
Figure 32.8 shows some solutions of
˙x = x(8 −4x −y)
˙y = y(3 −3x −y)
near the origin, along with some solutions of the linearised equations
˙x = 8x
˙y = 3y.
The two pictures appear to be identical.
The condition that the eigenvalues have non-zero real part means that the sta-
tionary point cannot be a centre. Indeed, Exercise 32.1 shows that nonlinear terms
can turn a linearised centre into a stable or unstable focus. However, examiners
and problem setters have a habit of ﬁnding nonlinear systems in which stationary
points that are centres for the linearised equation do indeed sit in the centre of a
family of periodic orbits in the nonlinear problem. In all the examples below we
will check carefully that our linearised centres correspond to centres of the nonlin-
ear
The concepts of the stable and unstable manifolds, which perhaps seemed some-
what artiﬁcial when they were introduced in Section 28.5, are much more useful
when dealing with nonlinear equations. With essentially the same deﬁnitions as
before, the stable manifold of a stationary point x∗, W s(x∗), consists of all those
points lying on trajectories that tend to x∗as t →∞; while the unstable mani-
fold W u(x∗) consists of all those points lying on trajectories that would tend to x∗
were the direction of time reversed. The stable and unstable manifolds of a saddle
point in a nonlinear system are tangential to the eigenvectors corresponding to the
equation.

318
32 Coupled nonlinear equations
W u(x*)
W s(x*)
Fig. 32.9. The stable and unstable manifolds of a stationary point are tangential
to the eigenvectors: W u(x∗) is tangent to the unstable eigenvector (dotted line),
and W s(x∗) is tangent to the stable eigenvector (dashed line).
negative and positive eigenvalues of the linearisation; once again a proof is beyond
the scope of this book. This is illustrated in Figure 32.9.
32.4.4 Step 3: ﬁnd the stability type of each stationary point
The next step is to work out the ‘stability type’ (stable node, saddle, unstable focus,
etc.) of each stationary point. Since the phase portrait ‘close’ to each stationary
point looks like the phase portrait of the linearised system, we can use this to draw
the phase portrait near each stationary point.
For our example, the matrix of partial derivatives was given in (32.6),
Df(x, y) =

8 −8x −y
−x
−3y
3 −3x −2y

.
Near (0, 0) we set ξ = x and η = y, and so the linearisation is
dξ
dt =

8
0
0
3

ξ.
We can just read off the eigenvalues of this matrix (see Example 27.2); they are
λ = 8 and λ = 3, and so this is an unstable node. The eigenvector corresponding to
λ = 8 is (1, 0) (the x-axis), and that corresponding to λ = 3 is (0, 1) (the y-axis).
So the linearised phase portrait near the origin looks like Figure 32.10, where the
trajectories for negative values of x and y (which are not of interest given the
application of the model) are shown as dotted lines.

32.4 Analytical method for phase portraits
319
Fig. 32.10. The linearised phase portrait near (0, 0).
Fig. 32.11. The linearised phase portrait near (2, 0).
Near the stationary point at (2, 0) we set ξ = x −2 and η = y and the linearised
system is
dξ
dt =

−8
−2
0
−3

ξ.
The eigenvalues of the matrix we can read off as λ1 = −8 and λ2 = −3 (see
Example 27.3), and so this point is a stable node. The eigenvector corresponding
to λ1 = −8 is just v1 = (1, 0) (the x-axis), while that corresponding to λ2 = −3
has to be found from

−5
−2
0
0
 
v1
v2

= 0,
and so is v2 = (2, −5). The linearised phase portrait near (2, 0) is shown in
Figure 32.11, where once again the ‘uninteresting’ orbits with y < 0 are shown
as dotted lines.

320
32 Coupled nonlinear equations
Fig. 32.12. The linearised phase portrait near (0, 3).
Finally we investigate the linearised system near the stationary point on the y-
axis, (0, 3), where we set ξ = x and η = y −3. The linearisation is given by
dξ
dt =

 5
0
−9
−3

ξ.
Once again we can just read off the eigenvalues, which are λ1 = 5 and λ2 = −3;
this stationary point is a saddle. The eigenvector corresponding to λ1 = 5 (‘the
unstable direction’), v1 = (v1, v2), is determined by

 0
0
−9
−8
 
v1
v2

= 0;
one choice would be v1 = (8, −9). The ‘stable eigenvector’ corresponding to
λ2 = −3 is v2 = (0, 1) (the y-axis). This stationary point is a saddle, and the
linearised phase portrait nearby is shown in Figure 32.12.
Plotting these three ‘local’ phase portraits on the region x, y ≥0 gives the par-
tial phase portrait shown in Figure 32.13.
32.4.5 Step 4: ‘join the dots’
Now we want to join up the local portraits to give the global picture; the principle
is to join up the local phase portraits in a consistent way. The full phase portrait
is shown in Figure 32.14. (We saw this before at the beginning of the chapter, but
now we can draw it without recourse to a computer-generated plot of the direction
ﬁeld.)
It should be easy to read the fate of our two species from the phase portrait. The
point at (2, 0) is globally attracting; no matter where a trajectory begins (unless it
is on one of the axes) it tends towards this point. So whatever the initial balance

32.4 Analytical method for phase portraits
321
Fig. 32.13. The local phase portraits plotted together.
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 32.14. The global phase portrait for equation (32.3).

322
32 Coupled nonlinear equations
between the species, species ‘x’ always wins out over species ‘y’, which eventually
dies out.
In the next chapter we continue to look at ecological models using these phase
plane methods, and show that with different choices of parameters the outcome in
this competitive situation can be much happier, with both species able to coexist.
We will also look at what happens when one of the species forms the prey of the
other.
Exercises
32.1 The Hartman–Grobman Theorem guarantees that the phase portrait for a nonlinear
equation looks like the linearised phase portrait sufﬁciently close to a stationary point
provided that the eigenvalues have non-zero real part. In particular, the linearised
system may not give a qualitatively correct picture when the linearised equation pro-
duces a centre, as this example demonstrates. First show that the origin is a centre for
the linearised version of the equation
˙x = −y + λx(x2 + y2)
˙y = x + λy(x2 + y2).
Now write down the equation satisﬁed by r, where
r2 = x2 + y2,
and hence show that the stability of the origin depends on the sign of λ. Draw the
phase portrait for λ < 0.

33
Ecological models
In this chapter we ﬁrst investigate what other types of behaviour can arise in mod-
els of competitive species, and then we consider the more aggressive situation in
which one species preys on the other. The simple models that we treat here are
known as Lotka–Volterra systems.
33.1 Competing species
It is possible to treat the general model for competing species
˙x = x(A −ax −by)
˙y = y(B −cx −dy),
(33.1)
see Exercise 33.3. However, the general treatment is much less illuminating than
considering particular examples, and here we deal with two cases that have be-
haviour which is signiﬁcantly different from that of the previous chapter.
33.1.1 Weak competition
First we consider the example,
˙x = x(4 −2x −2y)
˙y = y(9 −6x −3y),
(33.2)
for which there are four non-negative stationary points (where the right-hand sides
are zero): if x = 0 then we could have y = 0 or y = 3; if y = 0 then we could
have the additional stationary point that arises when x = 2; and ﬁnally there is an
interior stationary point when x = y = 1, corresponding to a coexistent state in
which there are an equal number of both species. So the four possibilities are
(0, 0),
(2, 0),
(0, 3)
and
(1, 1).
323

324
33 Ecological models
Fig. 33.1. The linearised phase portrait near (0, 0).
With f(x, y) = (x(4 −2x −2y), y(9 −6x −3y)) we have
Df(x, y) =

4 −4x −2y
−2x
−6y
9 −6x −6y

.
We now look at the linearisation about the four stationary points above. Near
the origin we have
dξ
dt =

4
0
0
9

ξ,
so the eigenvalues are 4 and 9, corresponding to the x- and y-axes respectively. As
before, the origin is an unstable node, as shown in Figure 33.1.
Near the stationary point on the x-axis, (2, 0), we have
dξ
dt =

−4
−4
0
−3

ξ,
so the eigenvalues are λ1 = −4 and λ2 = −3. The point (2, 0) is a stable node.
While the eigenvector corresponding to λ = −4 is easily seen to be v1 = (1, 0)
(it lies along the x-axis), for the other we need to ﬁnd v2 = (v1, v2) that satisﬁes

−1
−4
0
0
 
v1
v2

= 0,
and so v2 = (−4, 1). The local phase portrait is shown in Figure 33.2.
The stationary point (0, 3) on the y-axis will also turn out to be a stable node.
Indeed, the linearised system about this point is
dξ
dt =

 −2
0
−18
−9

ξ,

33.1 Competing species
325
Fig. 33.2. The linearised phase portrait near (2, 0).
Fig. 33.3. The linearised phase portrait near (0, 3).
and so the eigenvalues are −2 and −9, both negative, and this is another stable
node. The eigenvector v1 = (v1, v2) corresponding to λ1 = −2 is determined by

 0
0
−18
−7
 
v1

v2,
and so one choice is (7, −18); the eigenvector corresponding to λ2 = −9 can
easily be seen to be v2 = (0, 1), i.e. along the y-axis. Figure 33.3 shows the local
phase portrait.
Finally, near the interior stationary point (1, 1) the linearisation is
dξ
dt =

−2
−2
−6
−3

ξ.
The eigenvalues of the matrix are the solutions λ of the characteristic equation

−2 −λ
−2
−6
−3 −λ
 = (−2 −λ)(−3 −λ) + 12 = λ2 + 5λ −6
= (λ + 6)(λ −1) = 0,

326
33 Ecological models
Fig. 33.4. The linearised phase portrait near (1, 1).
and so are λ1 = 1 and λ2 = −6; this stationary point is a saddle. The eigenvec-
tor v1 = (v1, v2) corresponding to the unstable direction (λ1 = 1) is determined
by

−3
−2
−6
−4
 
v1
v2

= 0,
and so is v1 = (2, −3); while that corresponding to the stable direction (λ2 = −6)
can be found from

 4
−2
−6
3
 
v1
v2

= 0,
and is v2 = (1, 2). The local saddle point behaviour is shown in Figure 33.4.
Figure 33.5 shows the local phase portraits near the stationary points plotted
together. The full phase portrait is shown in Figure 33.6, and is consistent with the
local patches we drew in Figure 33.5.
What you can see here is that the stable manifold of the interior stationary point
(the bold line in the ﬁgure) separates two regions of behaviour. Above this ‘sepa-
ratrix’ all trajectories are attracted to the stationary point (0, 3) which lies on the
y-axis: species x dies out, and species y settles down to a steady population. Below
the stable manifold all trajectories tend to (2, 0); species y dies out, and species x
stabilises at a constant value. Only for very special initial conditions, those that lie
precisely on the stable manifold, will we end up with the two species coexisting in
equal numbers at the interior stationary point (1, 1). Any small ﬂuctuations away
from this point will drive one of the species to extinction.

33.1 Competing species
327
Fig. 33.5. The local phase portraits near the stationary points.
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 33.6. The global phase portrait for equation (33.2). The ‘separatrix’ (the
stable manifold of (1, 2)) is the bold curve.
33.1.2 Coexistence
As a ﬁnal competitive model we will consider the system
˙x = x(4 −2x −y)
˙y = y(9 −3x −3y).
(33.3)

328
33 Ecological models
Again there are four stationary points; this time they are
(0, 0),
(2, 0),
(0, 3)
and
(1, 2).
The matrix Df of partial derivatives is given by
Df(x, y) =

4 −4x −y
−x
−3y
9 −3x −6y

.
Near the origin the linearisation is
dξ
dt =

4
0
0
9

ξ,
with eigenvalues 4 (corresponding to the x-axis) and 9 (corresponding to the
y-axis); an unstable node. The local phase portrait is the same as that in the last
example, shown in Figure 33.1.
Near (0, 3) we put ξ = x, η = y −3, and linearise to obtain
dξ
dt =

 1
0
−9
−9

ξ.
The eigenvalues of the matrix are λ1 = 1 and λ2 = −9; this stationary point is
a saddle. The eigenvector v1 = (v1, v2) corresponding to λ1 = 1 (the unstable
direction) is determined by

 0
0
−9
−10
 
v1
v2

= 0,
and so is (10, −9); while that corresponding to λ2 = −9 (the stable direction) is
just (0, 1). The local phase portrait is shown in Figure 33.7.
Fig. 33.7. The linearised phase portrait near (0, 3).

33.1 Competing species
329
Fig. 33.8. The linearised phase portrait near (2, 0).
The linearisation about (2, 0) is
dξ
dt =

−4
−2
0
3

ξ;
the eigenvalues of this matrix are λ1 = −4 with eigenvector v1 = (1, 0), and λ2 =
3 with corresponding eigenvector determined by

−7
−2
0
0
 
v1
v2

= 0,
i.e. v2 = (−2, 7). This is another saddle, with the local phase portrait shown in
Figure 33.8.
Finally, the linearised system near the interior stationary point (1, 2) is
dξ
dt =

−2
−1
−6
−6

ξ
[where ξ = x −(1, 2)]. The eigenvalues of this matrix are the solutions λ of

−2 −λ
−1
−6
−6 −λ
 = (−2 −λ)(−6 −λ) −6 = λ2 + 8λ + 6 = 0.
Hence
λ = −8 ±
√
64 −24
2
= −4 ±
√
10.
Note ﬁrst that both λ1 = −4 −
√
10 and λ2 = −4 +
√
10 are negative, so this sta-
tionary point is a stable node. The eigenvector corresponding to λ1 is given by

2 +
√
10
−1
−6
−2 +
√
10
 
v1
v2

= 0,
and so is v1 = (1, 2 +
√
10); while that corresponding to λ2 is given by

2 −
√
10
−1
−6
−2 −
√
10
 
v1
v2

= 0,

330
33 Ecological models
Fig. 33.9. The linearised phase portrait near (1, 2).
Fig. 33.10. The local phase portraits near the stationary points.
and so is v2 = (1, 2 −
√
10). Since λ2 has the smaller modulus, trajectories ap-
proach the interior ﬁxed point tangent to the v2 direction; the local phase portrait
near (1, 2) is shown in Figure 33.9.
The local phase portraits are all combined on Figure 33.10, and the global phase
portrait is shown in Figure 33.11. For this choice of parameters the interior station-
ary point attracts all trajectories, and so any initial condition that includes some of
both species will lead to a state of coexistence in which there are twice as many
of species y as there are of species x. If there is only species x then it will settle
to its own equilibrium x = 2 and if there is only species y then it will settle to
y = 3.

33.2 Predator-prey models I
331
0
0.5
1
1.5
2
2.5
0
0.5
1
1.5
2
2.5
3
3.5
Fig. 33.11. The global phase portrait. From any initial mix of species the solution
converges to (1, 2).
33.2 Predator-prey models I
Another class of models governs two species when one is the prey of the other,
e.g. hawks and rabbits. If x is the prey and y the predator, we would expect the prey
to thrive happily without the predator, so in isolation it should obey the logistic
equation
˙x = rx(k −x).
In contrast, if left to itself with no prey, and hence no food, species y would die
out,
˙y = −sy.
Any interaction between the species now favours y (since they need x to eat)
but clearly disadvantages x (who are eaten). So we end up with the model
˙x = rx(k −x −ay)
˙y = y(−s + bx),
where all the parameters are positive. When b < ks there are only two stationary
points with x, y ≥0, and the predator will eventually die out, leaving the prey to
settle down by itself to its natural equilibrium (x = k); this possibility is treated in
Exercise 33.1 (vii).

332
33 Ecological models
We consider here an example that has b > ks and so exhibits more interesting
behaviour,
˙x = x(1 −2x −y)
˙y = y(−2 + 6x).
(33.4)
The three stationary points here are
(0, 0),
1
2, 0

and
1
3, 1
3

.
With f(x, y) = (x(1 −2x −y), y(−2 + 6x)) the matrix Df of partial deriva-
tives is given by
Df(x, y) =

1 −4x −y
−x
6y
−2 + 6x

.
Near the origin the linearisation is simply
dξ
dt =

1
0
0
−2

ξ,
so the origin is a saddle; the eigenvalues are 1, corresponding to the x-axis,
i.e. the eigenvector (1, 0), and −2, corresponding to the y-axis, i.e. (0, 1). See
Figure 33.12.
Near (1
2, 0) the linearisation gives
dξ
dt =

−1
−1
2
0
1

ξ,
and so the eigenvalues are λ1 = −1 and λ2 = 1 and this stationary point is a sad-
dle. While the eigenvector corresponding to λ1 = −1 lies along the x-axis (it is
Fig. 33.12. The linearised phase portrait near (0, 0).

33.2 Predator-prey models I
333
Fig. 33.13. The linearised phase portrait near
 1
2, 0

.
v1 = (1, 0)), the eigenvector corresponding to λ2 = 1 is determined by

−2
−1
2
0
0
 
v1
v2

= 0,
so is v2 = (−1, 4). See Figure 33.13.
The linearisation about the interior stationary point is
dξ
dt =

−2
3
−1
3
2
0

ξ.
The eigenvalues of this matrix are given by the solutions λ of the characteristic
equation

−2
3 −λ
−1
3
2
−λ
 = λ2 + 2λ
3 + 2
3 = 0.
Using the quadratic formula these are
λ = −
2
3 ±

4
9 −8
3
2
= −1 ± i
√
5
3
,
and so the interior stationary point is a stable spiral. Trajectories therefore spiral
in towards (1
3, 1
3); to ﬁnd out whether they spiral in clockwise or anti-clockwise,
we look at the linearised equations near (1
3, 1
3). The equation for η is ˙η = 2ξ, so
that for ξ > 0 (to the right of the stationary point, since x = 1
3 + ξ) trajectories
are moving up, while for ξ < 0 (to the left of the stationary point) trajectories are
moving down. The spiralling motion is therefore anti-clockwise (see Figure 33.14).
The full phase portrait is shown in Figure 33.15. Since the interior stationary
point is globally attracting, the predator and the prey settle down to a state in
which there is enough prey to keep the predators alive and the predators never eat
themselves to extinction.

334
33 Ecological models
Fig. 33.14. Spiral motion near the interior stationary point ( 1
3, 1
3).
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
Fig. 33.15. The global phase portrait for equation (33.4).
33.3 Predator-prey models II
We now suppose that the prey, if left alone, would obey the exponential population
model
˙x = kx
rather than the logistic model we used previously; this would be the case for a
population (perhaps unrealistically) not limited by local resources. An example

33.3 Predator-prey models II
335
might be whales and plankton. In this case, the equations become
˙x = kx(1 −ay)
˙y = y(bx −s),
(with all coefﬁcients positive) and we will analyse these in general.
There are only two stationary points, at (0, 0) and at (s/b, 1/a). The matrix of
partial derivatives of the right-hand side is
Df(x, y) =

k(1 −ay)
−akx
by
bx −s

.
Near the origin this gives the linearisation
dξ
dt =

k
0
0
−s

ξ,
and so the origin is a saddle, with the stable direction running along the y-axis
and the unstable direction along the x-axis. About the interior stationary point the
linearisation is
dξ
dt =

 0
−aks/b
b/a
0

ξ.
The eigenvalues λ of the matrix satisfy

−λ
−aks/b
b/a
−λ
 = λ2 + ks = 0,
and so λ = ±i
√
ks.
The linearised ﬂow near the interior stationary point suggests that it might be a
centre, but recall that we can only guarantee that the phase portrait for the nonlinear
equation looks like the linearised phase portrait when the eigenvalues have non-
zero real part. So we need to do a little more work to check that there really are
closed orbits around (s/b, 1/a). We can do this because it is possible to ﬁnd the
equation of the curves traced out by trajectories.
Using the chain rule, if y(t) = y(x(t)) then we have
dy
dt = dy
dx
dx
dt ,
from which it follows that when ˙x ̸= 0 we have
dy
dx = dy
dt
)dx
dt

336
33 Ecological models
(you can think of this heuristically as ‘cancelling the dts’). So therefore along a
trajectory
dy
dx = ˙y
˙x = y(bx −s)
kx(1 −ay)
(cf. example in Section 8.6.2). This equation is separable,
1 −ay
y
dy = bx −s
kx
dx,
and so
1
y −a dy = b
k −s
kx dx.
Integrating both sides gives (since x and y are positive)
ln y −ay = (bx/k) −s
k ln x + C,
i.e.
C(x, y) = ln y −ay + s
k ln x −bx
k
is constant on trajectories.
In order to understand the forms of curves of constant C, we can ﬁnd the turning
points of the function C(x, y) (see Appendix C for a brief discussion). These occur
when ∂C/∂x = ∂C/∂y = 0. Because
∂C
∂x = s
kx −b
k
and
∂C
∂y = 1
y −a,
there is only one turning point at (s/b, 1/a), the interior stationary point. Calcu-
lating the matrix of second partial derivatives

 ∂2C/∂x2
∂2C/∂x∂y
∂2C/∂y∂x
∂2C/∂y2

=

−s/kx2
0
0
−1/y2

,
it is easy to see that both the eigenvalues of this matrix are negative (they are
−s/kx2 and −1/y2), and so C is a maximum at this stationary point. It follows
that the curves of constant C are closed curves near the stationary point, and hence
the trajectories form a collection of periodic orbits.
Example 33.1 Draw the phase portrait for the equations
˙x = x(1 −y)
˙y = y(2x −4)
(33.5)
and ﬁnd the equations of the trajectories.

33.3 Predator-prey models II
337
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Fig. 33.16. The phase portrait for equation (33.5).
Using the analysis above, there are two ﬁxed points, one at the origin (which
is a saddle) and one at (2, 1) which is a centre. The phase portrait is shown in
Figure 33.16.
On the curves traced out by solutions we have
dy
dx = ˙y
˙x = y(2x −4)
x(1 −y) .
Separating the variables,
1 −y
y
dy = 2x −4
x
dx,
and integrating both sides gives
ln y −y = 2x −4 ln x + C,
so that
C(x, y) = ln y + 4 ln x −y −2x
is constant on trajectories. The level sets of this function C, produced by the
MATLAB code

338
33 Ecological models
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
Fig. 33.17. Curves on which C(x, y) = ln y + 4 ln x −y −2x is constant.
>> [x, y]=meshgrid(.1:.1:4.5, .1:.1:4.5);
>> z=log(y)+4*log(x)-y-2*x;
>> contour(x,y,z,[-2.3 -2.5 -3.5 -4 -4.5]);
are shown in Figure 33.17 – note how they correspond to the trajectories in
Figure 33.16.
Exercises
33.1 For each of the following models of two species, describe ﬁrst the type of situation
being modelled, then ﬁnd the stationary points, determine their stability type and
draw the phase portrait for x, y ≥0. Finally, say what the phase portrait means for
the two species.
(i)
˙x = x(2 −x −y)
˙y = y(2 −2y −2x)
(ii)
˙x = x(2 −x −y)
˙y = y(2 −2y −x/4)
(iii)
˙x = x(2 −x −3y)
˙y = y(2 −2y −3x)

Exercises
339
(iv)
˙x = x(1 −2y)
˙y = y(−2 + 3x),
ﬁnd also the equations of the curves along which the solutions move,
(v)
˙x = x(4 −x/2 −3y)
˙y = y(−2 + x)
(vi)
˙x = x(10 −x −3y)
˙y = y(1 + x −10y)
(vii)
˙x = x(3 −x −y)
˙y = y(−2 + x).
(You could use the MATLAB program lotkaplane.m to help draw some of these
phase portraits. It asks for the parameters that occur in the general form of the equa-
tions
˙x = A(x + ax + by)
˙y = B(y + cx + dy)
and then draws the trajectory forwards and backwards through speciﬁed initial con-
ditions.)
33.2 The situation in which two species cooperate, so that the presence of one enhances
the environment for the other, can be modelled by a coupled pair of equations of the
form
˙x = x(A −ax + by)
˙y = y(B + cx −dy),
where all the parameters are positive. Draw the phase portraits for the following co-
operative equations:
(i)
˙x = x(1 −x + y)
˙y = y(1 + x −2y),
and
(ii)
˙x = x(2 −x + y)
˙y = y(4 + 2x −y).

340
33 Ecological models
33.3 (T) Consider the general model of two competing species,
˙x = x(A −ax −by)
˙y = y(B −cx −dy),
where all the parameters are positive. Assuming that the intercepts of the nullclines
(lines on which ˙x = 0 and ˙y = 0) with the x- and y-axes do not coincide, by consid-
ering the relative positions of these intercepts show that there are four distinct possi-
bilities for the behaviour of solutions, and ﬁnd the parameter ranges over which they
occur. Check that your results are consistent with what you found for the competitive
examples in Exercise 33.1.

34
Newtonian dynamics
In this chapter we apply phase plane ideas to various one-dimensional systems
that model a particle moving under Newton’s laws of motion. First we consider
systems in which the energy is constant, and then we consider systems in which
there is some dissipation.
34.1 One-dimensional conservative systems
We consider a particle of mass m moving on a line in a potential force ﬁeld, such
that its potential energy at position x is given by V (x). Then its kinetic energy is
1
2m ˙x2, and its total energy is
E = 1
2m ˙x2 + V (x).
(34.1)
If the energy is conserved then we can differentiate to give
m ˙x ¨x + V ′(x)˙x = 0;
provided that ˙x ̸= 0 we can cancel this term and obtain1
m ¨x = −V ′(x).
(34.2)
By setting y = ˙x, we can rewrite this as the coupled system
˙x = y
m ˙y = −V ′(x).
(34.3)
In all that follows we will take m = 1 for simplicity.
If you think of these equations as describing the motion of a bead sliding on
a wire whose height at coordinate x is given by V (x) you will get the correct
1 By assuming the continuity of the function x(t) and its derivatives it is possible to justify this equation for all t,
even at those times when ˙x(t) = 0.
341

342
34 Newtonian dynamics
qualitative idea of how the solutions should behave, although this interpretation is
not entirely accurate, as discussed in the next section.
Because of the relatively simple form of these equations the possible behaviour
of the solutions is restricted. First, note that at any stationary point (x∗, y∗) we
must have y∗= 0 (zero velocity), and x∗must be a turning point of V (x) (since
we need V ′(x∗) = 0). The linearisation near such a stationary point is simply
dξ
dt =

0
1
−V ′′(x∗)
0

ξ,
so that the eigenvalues of the matrix are the solutions of

−λ
1
−V ′′(x∗)
−λ
 = λ2 + V ′′(x∗) = 0,
i.e. λ = ±√−V ′′(x∗), giving either a pair of real eigenvalues of opposite sign if
V ′′(x∗) < 0 or a pair of purely imaginary eigenvalues if V ′′(x∗) > 0.
Thus any stationary points corresponding to maxima of V (where V ′′(x∗) < 0)
will be saddle points, while those corresponding to minima of V (where V ′′(x∗)
> 0) will be centres for the linearised equation.
Since trajectories move on the curves 1
2 y2 + V (x) = E, these ‘linearised cen-
tres’ will in fact be centres for the full nonlinear equations, as we can see by consid-
ering the curves of constant E (you may ﬁnd it useful to refer here to Appendix C).
Maxima and minima of E occur when ∂E/∂x = V ′(x) = 0 and ∂E/∂y = y = 0,
precisely at the stationary points. The Hessian matrix of second derivatives of E is
simply

 V ′′(x)
0
0
1

.
Since its eigenvalues are V ′′(x) and 1, minima of V are also minima of E, and
maxima of V are saddle points of E. Thus when V ′′(x∗) > 0 the point (x∗, 0) is a
local minimum of E, and so nearby curves of constant E are closed.
Example 34.1 A particle of mass 1 moves on a line under the inﬂuence of a po-
tential V (x) = x −1
3x3, as illustrated in Figure 34.1. Sketch the phase portrait,
and describe the motion.
The energy
E = 1
2 y2 + x −1
3x3
will be constant along any trajectory, and the curves of constant E are shown in
Figure 34.2.

34.1 One-dimensional conservative systems
343
−2.5
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
2.5
−3
−2
−1
0
1
2
3
Fig. 34.1. The potential V (x) = x −1
3x3 plotted against x.
−3
−2
−1
0
1
2
3
−3
−2
−1
0
1
2
3
Fig. 34.2. Curves of constant E(x, y) = 1
2 y2 + x −1
3x3.
The equation of motion is ¨x = −V ′(x),
¨x = −1 + x2,
and setting y = ˙x yields the coupled equations
˙x = y
˙y = −1 + x2.
(34.4)
For a stationary point we need y = 0 and −1 + x2 = 0, so there are two station-
ary points, (−1, 0) and (1, 0). Looking at the potential, you might expect oscilla-
tions about x = −1 (these would be closed orbits around the point (−1, 0)), and

344
34 Newtonian dynamics
−3
−2
−1
0
1
2
3
−3
−2
−1
0
1
2
3
Fig. 34.3. The phase portrait for equation (34.4). Within the bold curve the parti-
cle oscillates about x = 1, while outside it rolls away to x = +∞.
instability near x = 1 (close to the point (1, 0)). We check this by calculating
Df(x, y) =

 0
1
2x
0

.
The eigenvalues of this matrix are ±
√
2x; the complex conjugate pair ±
√
2i when
x = −1 and two distinct real values of opposite sign ±
√
2 when x = 1.
So (−1, 0) is a centre and (1, 0) is a saddle, where the eigenvectors are (1,
√
2)
in the unstable direction and (1, −
√
2) in the stable direction. ‘Joining the dots’
we get the phase portrait shown in Figure 34.3. Note that when E < Ecrit = 2/3
the particle can move to and fro in the ‘well’ of the potential. When E = Ecrit
there is one orbit that starts from the top of the rise, rolls to the left, and then rolls
back and comes to rest exactly where it started; this trajectory, shown as a bolder
line in the ﬁgure, forms both the stable and unstable manifold of the point (1, 0).
When E > Ecrit the particle always rolls off to x = +∞.
34.2 *A bead on a wire
Earlier in the chapter we said that it was possible to get an accurate qualitative idea
of the dynamics of the equation
¨x = −V ′(x)
(34.5)
by imagining a bead sliding on a wire whose height is given by h = V (x). How-
ever, (34.5) is not the right model for this situation, as we now see by considering
the ‘bead on a wire’ problem in more detail.

34.2 *A bead on a wire
345
0
(x,V(x))
x
V(x)
Fig. 34.4. A bead on a wire whose shape is given by h = V (x).
We assume that the bead slides (without friction) on a wire bent into the shape
given by h = V (x) (where h is the height above some reference level), see Fig-
ure 34.4. In particular we want to relate this to the behaviour of a particle moving
on a line in a potential forceﬁeld V (x). Again for convenience we take the mass of
the bead to be 1.
Although V (x) is the potential energy (taking units in which g = 1), the kinetic
energy of the bead also has to include the vertical component of its motion. Since
the position of the bead when its horizontal coordinate is x is
x = (x, V (x)),
its velocity is
˙x = (˙x, V ′(x)˙x).
So its kinetic energy, 1
2|˙x|2, is
1
2|˙x|2 = 1
2 ˙x2[1 + (V ′(x))2],
and the total energy is
E = 1
2 ˙x2[1 + (V ′(x))2] + V (x).
Differentiating this gives
0 = ˙x ¨x[1 + V ′(x)2] + ˙x2V ′(x)V ′′(x)˙x + V ′(x)˙x;
dividing by ˙x and rearranging we have
¨x[1 + V ′(x)2] = −V ′(x)V ′′(x)˙x2 −V ′(x),

346
34 Newtonian dynamics
or
¨x = −V ′(x)
1 + V ′′(x)˙x2
1 + V ′(x)2

.
Setting y = ˙x we end up with the coupled system
˙x = y
(34.6)
˙y = −V ′(x)
1 + V ′′(x)y2
1 + V ′(x)2

.
(34.7)
We will now see that these complicated looking equations have the same sta-
tionary points as the system
˙x = y
˙y = −V ′(x)
and that these stationary points have the same stability properties for both sets of
equations.
First, note that at any stationary point (x∗, y∗) we must still have y∗= 0, using
equation (34.6). For ˙y = 0 equation (34.7) then requires
−V ′(x)

1
1 + V ′(x)2

= 0
(the expression in the square brackets has simpliﬁed since y∗= 0). Since the de-
nominator 1 + V ′(x)2 is always strictly positive, we must have V ′(x∗) = 0 for a
stationary point. So, as before, the stationary points (x∗, 0) occur when x∗is one
of the turning points of V (x).
With a little more algebra we can also show that the stationary points have the
same stability type as their counterparts in the simpler problem, which depended
only on the sign V ′′(x∗). Here Df is given by the daunting expression
Df(x) =

0
1
−V ′′ 1+V ′′y2
1+V ′2

−V ′ (1+V ′2)V ′′′y2−2V ′V ′′(1+V ′′y2)
(1+V ′2)2

−2yV ′V ′′
1+V ′2

,
where V ′, V ′′, and V ′′′ are understood to depend on x. However, near any station-
ary point (x∗, y∗) the linearisation is simply
dξ
dt =

0
1
−V ′′(x∗)
0

ξ,
just as before, since y∗= 0 and V ′(x∗) = 0 at any stationary point. Just as for
the simpler model, if V ′′(x∗) > 0 then the stationary point is a centre, and if
V ′′(x∗) < 0 then it is a saddle.

34.3 Dissipative systems
347
−2
−1
0
1
2
3
4
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
Fig. 34.5. The phase portrait for a bead moving on a wire bent in the shape h = x −1
3x3.
For a bead sliding on a wire bent into the shape h(x) = x −1
3x3 as in Exam-
ple 34.1 the equations are ˙x = y and
˙y = −(1 −x2)

1 −2xy2
2 −2x2 + x4

.
The phase portrait is shown in Figure 34.5. Although the individual trajectories
have changed shape, the qualitative behaviour is the same as for the particle mov-
ing in the potential V (x) (see Figure 34.3); if the energy is below a certain level
the bead oscillates, while if the energy is too high the bead escapes to x = +∞.
34.3 Dissipative systems
In Chapter 13 we looked at models of oscillating systems, both with and without
damping. There we modelled the effect of damping by including in the equation
for ¨x an additional term −k ˙x (with k > 0), representing a force acting to oppose
the motion.
If we include a similar factor in equation (34.2) then it becomes
m ¨x = −k ˙x −V ′(x).
(34.8)
The new damping term has the effect of dissipating the energy in the system. If we
now calculate dE/dt we have
dE
dt = d
dt
*1
2m ˙x2 + V (x)
+
= m ˙x ¨x + V ′(x)˙x = −k ˙x2 −V ′(x)˙x + V ′(x)˙x
= −k ˙x2 < 0.

348
34 Newtonian dynamics
Since −k ˙x2 is negative unless the particle is at rest, the energy always decreases
while the particle is moving.
Writing (34.8) as a coupled system we have
˙x = y
m ˙y = −ky −V ′(x).
We will ﬁrst consider such systems in general, relating their behaviour to that of
the undamped system with k = 0. Again we will take m = 1 for simplicity.
The stationary points of the damped system are the same as the stationary points
of the system without damping, since at any stationary point we must have y∗= 0
to make ˙x zero, and then the equation for ˙y requires that V ′(x∗) = 0. Although the
stationary points do not move with the addition of damping, their stability prop-
erties change. The eigenvalues of the matrix that occurs in the linearised equation
near a stationary point (x∗, 0),
dξ
dt =

0
1
−V ′′(x∗)
−k

ξ,
(34.9)
are the solutions of the characteristic equation

−λ
1
−V ′′(x∗)
−k −λ
 = λ2 + kλ + V ′′(x∗) = 0.
Using the quadratic formula,
λ = −k ±

k2 −4V ′′(x∗)
2
.
Without damping (k = 0) any maximum of V (where V ′′(x∗) < 0) was a sad-
dle point. Even with damping this is still the case, since the expression within
the square root is always positive and greater than k, giving one positive and one
negative eigenvalue. However, the stability type of minima (where V ′′(x∗) > 0)
changes. Where before we had a purely complex pair of eigenvalues, and so a
centre, now the real part of both eigenvalues will be negative, and depending on
whether k2 > 4V ′′(x∗) or k2 < 4V ′′(x∗) the stationary point will be a stable node
or a stable spiral.
We now return to the system of Example 34.1 and investigate the effect of such
a damping term.
Example 34.2 Draw the phase portrait for the system
˙x = y
˙y = −y −1 + x2.

34.3 Dissipative systems
349
As we noticed in general above, the stationary points are the same as they were
for the undamped system, namely (±1, 0). However, their stability properties have
changed. If we now calculate Df we have
Df(x, y) =

 0
1
2x
−1

.
About (1, 0) the linearisation is
dξ
dt =

0
1
2
−1

ξ,
and the eigenvalues of the matrix of the right-hand side are given by the solutions
of

−λ
1
2
−1 −λ
 = λ2 + λ −2 = (λ −1)(λ + 2) = 0,
i.e. λ = 1 or λ = −2. The eigenvalues are real and of opposite sign, and this sta-
tionary point is still a saddle. The eigenvector corresponding to λ1 = 1 is given
by

−1
1
2
−2
 
v1
v2

= 0,
and therefore is v1 = (1, 1); while the eigenvector corresponding to λ2 = −2 can
be found from

2
1
2
1
 
v1
v2

= 0,
and therefore is v2 = (1, −2).
Near the stationary point (−1, 0) the linearisation is
dξ
dt =

 0
1
−2
−1

ξ,
and the eigenvalues of the matrix are the solutions of

−λ
1
−2
−1 −λ
 = λ2 + λ + 2,
which are
λ = −1 ±
√
1 −8
2
= −1
2(1 ±
√
7i);
this stationary point is a stable spiral.

350
34 Newtonian dynamics
−4
−3
−2
−1
0
1
2
3
−2.5
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
Fig. 34.6. The phase portrait for the dissipative system from Example 34.2.
−2
0
2
−2
−1
0
1
2
3
4
−2
0
2
−1
0
1
2
3
4
−1
0
1
0
ω2/2
Fig. 34.7. From left to right, the potentials from parts (i), (ii) and (iii) of Exer-
cise 34.1 plotted against x.
The phase portrait is shown in Figure 34.6. It is clear that now, with damping,
there are no periodic orbits, and the particle will either come to rest at x = −1 or
escape to x = +∞.
□
Exercises
34.1 For the following choices of potential functions V (x) write down the total energy
for a particle of unit mass, and assuming that this is conserved write down a coupled
system for x and y = ˙x. Draw the phase portrait and interpret the dynamics.
(i) V (x) = 1
2ω2x2;
(ii) V (x) = 1
2x4 −x2; and
(iii) V (x) = 1
6x6 −5
4x4 + 2x2.
(Pictures of these potentials are shown in Figure 34.7.)
34.2 For the functions V (x) in parts (i) and (ii) of Exercise 34.1 write down the kinetic
energy of a particle of unit mass moving on a wire whose height as a function of x is
V (x). Taking g = 1 write down the total energy, and hence derive the second order

Exercises
351
equation satisﬁed by x. Write down a coupled system for x and y = ˙x, and draw the
phase portrait.
34.3 Write down the equation of motion for a particle of unit mass moving in each of the
potentials in Exercise 34.1, when there is an additional damping force −˙x (in part (i)
take ω = 1). Draw the phase portrait for each case.
34.4 (T) A particle of unit mass moves on a wire whose height as a function of x is V (x),
and is subject to an additional damping force −k ˙x. Write down the equation of mo-
tion, and show that the behaviour of this system is qualitatively the same as that of
¨x = −V ′(x) −k ˙x.
34.5 (C) Investigate the dynamics of the equations in exercise 34.1 both with and without
damping, using the M-ﬁle newtonplane.m. The program asks for the level of
damping k, and then a succession of initial conditions. The equation is speciﬁed in
the ﬁle newtonde.m, currently set up for the example V (x) = x −1
3x3 in the main
text. By changing this ﬁle you should be able to consider all the examples in Exercise
34.1, and also the equivalent problems for a ball rolling on a wire.

35
The ‘real’ pendulum
We end our treatment of phase portraits by returning to the example of the simple
pendulum.
35.1 The undamped pendulum
In Chapter 13 we derived the exact equation for the motion of an ideal pendulum,
d2θ
dt2 = −ω2 sin θ,
(35.1)
(where ω2 = g/L) but we then approximated this by ¨θ = −ω2θ in order to apply
the methods we had just learned for linear equations.
Here we will use phase plane methods to understand the nonlinear equa-
tion (35.1). For simplicity we will choose ω = 1 and consider the equation
d2θ
dt2 = −sin θ.
In order to look at this as a set of coupled ﬁrst order equations we set x = θ and
y = ˙θ and then
˙x = y
˙y = −sin x.
(35.2)
Note that the direction ﬁeld (shown in Figure 35.1) repeats itself every 2 in
the horizontal direction. This should not be a surprise, since the x coordinate rep-
resents the angle of the pendulum to the vertical (θ in our original equation), and
the value θ = x + 2 corresponds to the same position of the pendulum as θ = x.
So we should consider (x, y) and (x + 2, y) as representing the same physical
352

35.1 The undamped pendulum
353
0
−5
0
5
−5π
−3π
−π
π
3π
5π
Fig. 35.1. The direction ﬁeld for the pendulum equation.
state of the system. The natural way to present our phase diagrams, then, is to
restrict to a range of x corresponding to one particular choice for the angle θ,
− < x ≤, say. We will show a slightly longer range of x, since this may be
helpful in understanding the phase portraits, but you should remember that the ﬁg-
ures ‘wrap around’ from one side to the other. We return to this at the end of the
chapter.
The ﬁrst step in the phase plane analysis is always to ﬁnd all the stationary
points. If (x∗, y∗) is a stationary point then we need
y∗= 0
and
−sin x∗= 0.
The ﬁrst equation tells us that y∗must be zero at any stationary point, while the
second implies that x∗= k for some (positive or negative) integer k.
Thus any point x∗= (k, 0) with k an integer is a stationary point. In fact there
are just two distinct stationary points here: (0, 0), which corresponds to the pendu-
lum hanging vertically downward; and (, 0) which corresponds to the pendulum
being precariously balanced vertically upward.
To check the stability of these stationary points we have to consider the eigen-
values of the matrix of partial derivatives
Df(x) =

0
1
−cos x
0

near the stationary points.
Near the origin (and all stationary points (2k, 0)) the linearised equation is
dξ
dt =

 0
1
−1
0

ξ;
(35.3)
the eigenvalues of this matrix are ±i, so the origin is a (linearised) centre, round
which the orbits travel clockwise (when ξ = 0 and η > 0, ˙ξ = η > 0).

354
35 The ‘real’ pendulum
−4
−3
−2
−1
0
1
2
3
4
−1
−0.5
0
0.5
1
Fig. 35.2. The local phase portraits drawn near three stationary points.
Near (, 0) (and all the stationary points ((2k + 1), 0)) the linearisation is
dξ
dt =

0
1
1
0

ξ;
(35.4)
the eigenvalues are ±1 with corresponding eigenvectors (1, ±1).
We can now put this information on a phase diagram, at present just drawing
some trajectories close to the stationary points. Figure 35.2 shows the local phase
portraits near the three stationary points closest to the origin, (±, 0) and (0, 0)
itself.
To complete the picture it is helpful to use the fact that the energy is constant,
1
2 y2 −cos x = E = constant.
On each solution curve
y2 = 2(E + cos x)
⇒
y = ±

2(E + cos x)
and the type of curves traced out by trajectories depend on the value of E. It is
clear that if E > 1 then we can solve for y for every value x; there will be one
curve that has y > 0 and one with y < 0. If E < 1 then we can only solve for a
range of x values, and this will lead to a closed curve passing through y = 0. The
critical value is E = 1. Curves of constant E are shown in Figure 35.3, and the
phase portrait is shown in Figure 35.4.
Note that
(i) for E < 1 there are a collection of closed curves circling the origin;
(ii) the curves corresponding to E = 1, shown as bold lines in Figure 35.4, form the stable
and unstable manifolds of the saddle points at (±, 0), and connect these two points;
(iii) for E > 1 the value of x is either always increasing (y > 0) or always decreasing
(y < 0).
These translate to the following behaviour of the original pendulum:

35.1 The undamped pendulum
355
−4
−3
−2
−1
0
1
2
3
4
−4
−3
−2
−1
0
1
2
3
4
Fig. 35.3. Curves on which E = 1
2 y2 −cos x is constant. In the shaded region E < 1.
−3
−2
−1
0
1
2
3
−4
−3
−2
−1
0
1
2
3
4
Fig. 35.4. The phase portrait for the simple pendulum. The bold lines indicate the
‘separatrix’, dividing a region in which the pendulum oscillates about the down-
ward vertical, and a region in which the pendulum whirls around through 360◦.
(i) If the pendulum has less than a critical amount of energy (E = 1) then it performs
oscillations back and forth about θ = 0, i.e. its rest position pointing downwards.
(ii) If the pendulum has the critical amount of energy then it can make exactly one rev-
olution from the upright position (θ = −) back to the upright position (θ = ) (or
vice versa) and no further.
(iii) If the pendulum has more energy (E > 1) then it can whirl around forever.

356
35 The ‘real’ pendulum
Note that the stable manifold of the saddle points (the bold lines in Figure 35.4)
form the ‘separatrix’ that divides the phase plane into a region of oscillation and a
region of ‘whirling’.
35.2 The damped pendulum
It is, of course, possible to analyse the damped pendulum in a similar way. With
the addition of damping the equations become
˙x = y
˙y = −sin x −ky,
(35.5)
where k > 0. (For the behaviour of the system with a quadratic damping term
−ky|y| in the equation for ˙y see Exercise 35.2.) While the stationary points are
unchanged, their stability changes.
The saddle points at (±, 0) remain saddles, since the linearisation near these
points is now
dξ
dt =

0
1
1
−k

ξ
and the eigenvalues of the matrix are the solutions of
λ2 + kλ −1 = 0,
which gives
λ = −k ±
√
k2 + 4
2
,
so that both eigenvalues are negative. The eigenvector in the stable direction (cor-
responding to the negative eigenvalue) is

2
√
k2 + 4 −k

,
and the eigenvector in the unstable direction (corresponding to the positive eigen-
value) is

2
−k −
√
k2 + 4

.

35.2 The damped pendulum
357
0
−4
−3
−2
−1
0
1
2
3
4
−π
π
Fig. 35.5. The phase portrait for the damped pendulum. All trajectories tend to
(0, 0). Remember that x =  and x = − correspond to the same angle, there-
fore as trajectories leave the diagram on the left they reappear on the right (and
vice versa).
The origin becomes a stable node or spiral; the linearisation is now
dξ
dt =

0
−1
1
−k

ξ,
and so the eigenvalues of the matrix are the solutions of
λ2 + kλ + 1 = 0,
which are
λ = −k ±
√
k2 −4
2
.
The phase portrait is shown in Figure 35.5 for the choice k = 1 when
λ = −1 ± i
√
3
2
and the origin is a stable spiral.
The behaviour predicted by this phase diagram accords with our physical in-
tuition; from any initial condition (apart from being precariously balanced ver-
tically upwards) the pendulum will eventually come to rest hanging vertically
downward.

358
35 The ‘real’ pendulum
×
∗
Fig. 35.6. The ‘phase cylinder’ for the pendulum. The ‘*’ represents the pendu-
lum pointing vertically downwards, and the ‘×’ is the cylinder vertically upwards.
The angular coordinate is θ (or x modulo 2π, the angle of the pendulum to the
vertical), and the vertical coordinate is ˙θ (or y in our coupled equation).
35.3 Alternative phase space
Since the point (x + 2, y) corresponds to the same state of the system as the
point (x, y), it would really be more sensible to draw a phase diagram that reﬂected
this. Figure 35.6 shows the phase diagram drawn on the ‘phase cylinder’, where
the coordinate on the circle represents the angle θ, and the vertical coordinate
the angular velocity ˙θ. The M-ﬁle cylinder.m draws animated trajectories of the
pendulum equation moving on this surface.
It is possible to cast the whole theory of dynamical systems in a general setting
that enables the use of such phase spaces (which are manifolds) in a very natural
way.
Exercises
35.1 Draw the phase portrait for the damped pendulum equations in (35.5) when k = 2
and when k = 3.
35.2 Consider the equation for a pendulum with a quadratic damping term
˙x = y
˙y = −sin x −ky|y|.

Exercises
359
Show that if E = 1
2 y2 −cos x then
dE
dt = −ky2|y|.
(E35.1)
Show that the point (0, 0) is a centre for the linearised equation, but using (E35.1)
deduce that for the nonlinear equation it behaves like a stable spiral, and hence draw
the phase diagram. (Remember that ‘linearised centres’ do not have to be centres for
the nonlinear equation.)

36
*Periodic orbits
We have already seen that showing the existence of periodic solutions is much
more difﬁcult than showing that there are stationary points, and that the ‘joining
up’ of trajectories that is required for a periodic orbit is a sensitive thing. In this
brief chapter we look at two results, one that excludes the possibility of there being
any periodic orbits, and one guaranteeing that there is at least one.
36.1 Dulac’s criterion
Dulac’s criterion is a way of showing that there cannot be any periodic orbits within
some region of the phase space. Suppose that we are considering trajectories of the
differential equation
˙x = f (x, y)
˙y = g(x, y).
Then given a region Ω⊂R2, if we can ﬁnd a smooth function h(x, y) such that
∂
∂x (h f ) + ∂
∂y (hg) ̸= 0
for all x, y ∈Ωthen there are no periodic orbits contained wholly within Ω. The
proof is straightforward, but relies on the divergence theorem.1
1 In R2 the divergence theorem says that if Ωis a region with smooth boundary Γ, h : R2 →R and f : R2 →R2
are continuously differentiable functions, then

Ω
∇· (f h) d2x =

Γ
h(n · f) ds,
(36.1)
where n is the unit outward normal to Γ, see Figure 36.1.
Now, if we can ﬁnd a function h such that ∇· (f h) ̸= 0 in Ω, then this means that the sign of ∇· (f h) is
constant throughout Ω. Then in particular we must have

Ω
∇· (f h) d2x ̸= 0.
360

36.2 The Poincar´e–Bendixson Theorem
361
Ω
Γ
n
Fig. 36.1. A region Ω, its boundary Γ, and one of the outward normals n.
For example, we can easily show that for many choices of parameters there are
no periodic orbits in the ecological models
˙x = x(A −ax + by)
˙y = y(B −cy + dx).
We will suppose that a, c > 0, but will say nothing about A, B, b and d. If we
choose h(x, y) = (xy)−1 then

h f (x, y)
hg(x, y)

=

 A/y −a(x/y) + b
B/x −c(y/x) + d

and
∂
∂x
 A
y −ax
y + b

+ ∂
∂y
 B
x −cy
x + d

= −a
y −c
x .
Since a, c > 0 there can be no periodic orbits in the region x, y > 0, since this
expression is always negative there.
36.2 The Poincar´e–Bendixson Theorem
More positively, the Poincar´e–Bendixson Theorem guarantees the existence of
a periodic orbit under certain conditions, and limits the complexity of two-
dimensional systems.
Theorem 36.1 Let D be a bounded region that orbits enter and never leave and
that contains no stationary points. Then any orbit entering D is attracted to a
However, if Γ is a periodic orbit then it is everywhere tangent to the velocity ﬁeld f, cf. Figure 32.3. This means
that n, which is normal to the periodic orbit, must be normal to the velocity ﬁeld, and so f · n = 0. Thus the
right-hand side of (36.1) must be zero, a contradiction.

362
36 *Periodic orbits
Γ
Fig. 36.2. If orbits enter and never leave the shaded region (D in the theorem),
and this region contains no stationary points, then there is at least one periodic
orbit  contained entirely within D.
periodic orbit; in particular there is at least one periodic orbit lying within D.
(This is illustrated in Figure 36.2.)
The following corollary (which follows with a little additional work) says that
the most complicated behaviour in two-dimensional systems is a periodic orbit.
Corollary 36.2 If all orbits are bounded then each trajectory converges either to
a stationary point or to a periodic orbit.
Exercises
36.1 Use Dulac’s criterion to show that periodic orbits in the equations
˙x = y
˙y = −ky −V ′(x)
are only possible if k = 0.
36.2 Consider the coupled system2
˙x = y + 1
4x(1 −2r2)
˙y = −x + 1
2 y(1 −r2),
where r2 = x2 + y2. First, show that the system has only one stationary point which
2 This example is taken from P. A. Glendinning Stability, instability, and chaos (Cambridge University Press,
1994).

Exercises
363
lies at the origin. Now, by ﬁnding the equation satisﬁed by r, show that trajectories
enter (and do not leave) the region D, where
D = {(x, y) :
1
2 ≤r2 ≤1}.
Use the Poincar´e–Bendixson Theorem to deduce that the system has a periodic orbit
lying within D.

37
*The Lorenz equations
We saw at the very end of the last chapter that the most complicated dynamics that
can occur in a system of two coupled equations (a two-dimensional system) is a
periodic orbit.
In this chapter we discuss, brieﬂy, a three-dimensional system of equations,
the Lorenz equations, which demonstrates that much more complexity is possi-
ble once we have three variables. Without the help of numerical solutions and
computer-aided visualisation our understanding of these equations would still be
poor. This chapter contains many computer-generated images, and some samples
of MATLAB output performing some tedious eigenvalue calculations. Most of this
was generated by the M-ﬁle lorenz37.m, and it might be helpful to have this
program running as you read.
Lorenz introduced his relatively simple system as a model in which to study
various theoretical problems involved in meteorology, and in particular in weather
prediction.1 It is based on a model of convection (when a layer of ﬂuid is heated
from below), greatly simpliﬁed. The model is
˙x = σ(−x + y)
˙y = rx −y −xz
˙z = −bz + xy.
(37.1)
There are three parameters in the problem: b, r, and σ. Standard values have es-
tablished themselves over the years: b = 8/3, r = 28, and σ = 10.
% parameters
>> sigma=10; r=28; b=8/3;
1 E. Lorenz, Deterministic nonperiodic ﬂow, J. Atmos. Sci. 20 (1963), 448–464.
364

*The Lorenz equations
365
The basic steps towards understanding the problem should be familiar from our
analysis of two-dimensional systems; we ﬁnd the stationary points and determine
their stability.
For these parameter values there are three stationary points; one at the origin (it
is easy to ﬁnd this one) and two more at
(±

b(r −1), ±

b(r −1),r −1).
% non-zero fixed points
>> x=sqrt(b*(r-1)); y=x; z=r-1; [x y z]
ans = 8.4853
8.4853
27.0000
In order to determine the stability type of the stationary points we have to look
at the linearised equation near each one. The matrix of partial derivatives is now
3 × 3,
Df(x, y, z) =
⎛
⎝
−σ
σ
0
r −z
−1
−x
y
x
−b
⎞
⎠.
To determine the stability we look (as we did for systems of two equations) at the
eigenvalues of this matrix. At the origin the matrix is
⎛
⎝
−σ
σ
0
r
−1
0
0
0
−b
⎞
⎠,
and its eigenvalues are given by the solutions of

−σ −λ
σ
0
r
−1 −λ
0
0
0
−b −λ

= (−b −λ)[(−σ −λ)(−1 −λ) −σr]
= −(λ + b)[λ2 + (1 + σ)λ −σ(r −1)] = 0.
So λ = −b or
λ = −(1 + σ) ±

(1 + σ)2 + 4σ(r −1)
2
.

366
37 *The Lorenz equations
For the particular parameter values above this gives the three eigenvalues
−22.8277,
11.8277
and
−8/3.
% eigenvalues and eigenvectors at the origin
% L gives values, V gives vectors
[V L] = eig([-sigma sigma 0; r -1 0; 0 0 -b])
V = -0.6148
-0.4165
0
0.7887
-0.9091
0
0
0
1.0000
L = -22.8277
0
0
0
11.8277
0
0
0
-2.6667
There are two stable directions at the origin, and one unstable one, so the origin
is some kind of three-dimensional analogue of a saddle point, as can be seen if
you look at the direction ﬁeld near the origin (shown in Figure 37.1) in the right
way.
−2
−1
0
1
2
−2
−1
0
1
2
−2.5
−2
−1.5
−1
−0.5
0
0.5
1
1.5
2
2.5
y
x
z
Fig. 37.1. The direction ﬁeld near the origin.

*The Lorenz equations
367
6
7
8
9
10
11
6
7
8
9
10
11
24
25
26
27
28
29
30
y
x
z
Fig. 37.2. The direction ﬁeld near one of the non-zero stationary points.
The linearisation near the
non-zero stationary points is the same, and the
eigenvalues are most easily found numerically:
% eigenvalues and eigenvectors at the non-zero points
>> [V L]=eig([-sigma sigma 0; r-z -1 -x; y x -b])
V =
0.8557
-0.2779 - 0.2839i
-0.2779 + 0.2839i
-0.3298
0.0089 - 0.5699i
0.0089 + 0.5699i
-0.3988
-0.7186 + 0.0293i
-0.7186 - 0.0293i
L = -13.8546
0
0
0
0.0940 +10.1945i
0
0
0
0.0940 -10.1945i
Near these points there is one stable direction, and a two-dimensional unstable
manifold of ‘spiral type’. It is quite hard to see all this structure in the direction
ﬁeld (shown in Figure 37.2), but you should be able to make out the ‘rotating’
behaviour.
The trajectories cannot just settle down to a stationary point, since all of them
have unstable directions. There is also no obvious way to ‘join the dots’ of the
local phase portraits, as should be clear from Figure 37.3, which puts the direction
ﬁelds near the three stationary points on one ﬁgure.
However, the trajectories do not escape to inﬁnity; if we consider
V (x, y, z) = x2 + y2 + (z −σ −r)2
s
two

368
37 *The Lorenz equations
−30
−20
−10
0
10
20
30
−30
−20
−10
0
10
20
30
0
5
10
15
20
25
30
35
y
x
z
Fig. 37.3. The direction ﬁelds near the three stationary points.
(which is the square of the distance of the point (x, y, z) from (0, 0, σ + r)) then
V (t) changes according to
dV
dt = 2x ˙x + 2y ˙y + 2(z −σ −r)˙z
= 2σ x(−x + y) + 2y(rx −y −xz) + 2(z −σ −r)[−bz + xy]
= −2σ x2 −2y2 −2z2 + 2b(r + σ)z
= −2σ x2 −2y2 −b(z −r −σ)2 −bz2 + b(r + σ)2
≤−αV + b(r + σ)2,
where α = min(2σ, 2, b) (which is 2 for our choice of parameters). This shows
that V decreases when V > b(r + σ)2/α. It follows that eventually all trajectories
will have V < 2b(r + σ)2/α, and lie at a bounded distance from (0, 0,r + σ).
So what happens to the trajectories? One thing we might try, looking at the
solutions as functions of time, is unhelpful (see Figure 37.4).
Even though a picture of the trajectory traced out by a typical solution
gives a very complicated looking picture, this approach is much more fruitful.
Figures 37.5 and 37.6 give two different views of the same trajectory after a small
period of time.
Essentially, these ﬁgures show the famous ‘Lorenz attractor’. Unless you start
on the stable manifold of one of the stationary points, if you trace out the trajectory
in the three-dimensional phase space you will end up with pictures that look some-
thing like these. You can do this for various choices of initial conditions using the
M-ﬁle lorenzdraw.m.

*The Lorenz equations
369
0
5
10
15
20
25
30
35
40
45
50
−20
0
20
x
0
5
10
15
20
25
30
35
40
45
50
−50
0
50
y
0
5
10
15
20
25
30
35
40
45
50
0
20
40
60
z
0
5
10
15
20
25
30
35
40
45
50
0
20
40
V(x,y,z)1/2
Fig. 37.4. Graphs of x, y, z, and V (x, y, z)1/2 against t on one solution.
−20
−15
−10
−5
0
5
10
15
20
−40
−20
0
20
40
0
5
10
15
20
25
30
35
40
45
50
y
x
Lorenz attractor
z
Fig. 37.5. A trajectory of the Lorenz equations.
However, suppose that you start two trajectories very close together. The re-
sult of doing this with two initial conditions that are extremely close (the initial
x coordinates differ by 0.0001) is shown in Figure 37.7 (the x coordinate only).
Although the solutions look the same for a time, after a while they are completely

370
37 *The Lorenz equations
−20
−10
0
10
20
−30
−20
−10
0
10
20
30
0
10
20
30
40
50
x
y
z
Fig. 37.6. Another view of the trajectory in Figure 37.5.
0
5
10
15
20
25
30
35
40
45
50
−20
−10
0
10
20
x
t
0
5
10
15
20
25
30
35
40
45
50
−20
−10
0
10
20
t
x
Fig. 37.7. The equations exhibit sensitive dependence on initial conditions.
different. This is another example of the ‘sensitive dependence on initial condi-
tions’ that we saw for the logistic map in Chapter 24.
This is illustrated more dramatically in the four pictures that make up Fig-
ure 37.8. In each picture there are in fact 125 values of x(t). They start so close
together that even at time t = 18, shown in the ﬁrst picture, they still appear to
be the same. However, in the following three pictures you can see them spreading
apart, until at time t = 34 they are scattered all over the attractor. (The MATLAB
program solvem.m performs all the integrations necessary to generate all the so-
lutions, which you can then watch as they move using flies.m.)
A very small initial change makes a huge difference to the way the solutions
eventually behave. This is the origin of the notion of the ‘butterﬂy effect’; if a

*The Lorenz equations
371
−20
0
20
−20
0
20
0
20
40
−20
0
20
−20
0
20
0
20
40
−20
0
20
−20
0
20
0
20
40
−20
0
20
−20
0
20
0
20
40
Fig. 37.8. 125 solutions of the Lorenz equations, at times t = 18 (top left); t = 21
(top right); t = 24 (bottom left); and t = 34 (bottom right). The axes are orien-
tated similarly to those in Figure 37.6.
0
1
2
3
4
5
6
7
8
9
10
5
10
15
20
25
30
35
40
45
z1
z2
z3
z4
z5
z6
z7
z8
z9
z10
z11
z12
z13
Fig. 37.9. Graph of a solution z(t) and its successive maxima.
butterﬂy ﬂaps its wings on one side of the world it could cause a storm on the other.
In other words, very small changes to the initial condition can produce widely
different effects after some time. In terms of weather prediction we know this
very well; forecasts are reasonably accurate for the next day, but not for one week
later. Of course, the ‘butterﬂy effect’ is a very colourful description of the idea.
Atmospheric models will take into account the fact that variations on very small

372
37 *The Lorenz equations
25
30
35
40
45
50
28
30
32
34
36
38
40
42
44
46
48
Fig. 37.10. The result of plotting successive maxima of z(t) against each other.
scales (like the ﬂapping of the butterﬂy) cannot be expected to have such huge
effects, because the viscosity of the air should damp out such disturbances.
As one way of trying to understand how these complicated solutions behave, in
his original paper Lorenz suggested concentrating on the successive local maxima
of z(t). If zn is the nth local maximum, see Figure 37.9, Lorenz suggested plotting
the next local maximum zn+1 against zn. A priori there is no reason why this should
not just produce points all over the plot.
However, Figure 37.10 shows the result. Remarkably, it appears that zn+1 is
given by a function of zn, say f , so that zn+1 = f (zn). Thus it should be possible
to investigate the solutions of the Lorenz equations by analysing the dynamics of
this iterated map, which is surprisingly similar to the tent map that we considered
at the end of Chapter 24.

38
What next?
In this book we have covered all of the basic methods for ﬁnding the explicit so-
lutions of simple ﬁrst and second order differential equations, along with some
qualitative methods for coupled nonlinear equations. We have also discussed dif-
ference equations, and seen how complicated the dynamics of even very simple
iterated nonlinear maps can become.
There are two ways in which to proceed further with the material developed
here. One arises from turning ﬁrst to the study of partial differential equations,
while the other essentially continues from where we have left off.
38.1 Partial differential equations and boundary value problems
Partial differential equations model systems that have spatial as well as temporal
structure, for example the temperature throughout an object, the vibrations of a
string or a drum, or the velocity of a ﬂuid.
In general linear partial differential equations are easier to solve. By using the
technique known as ‘separation of variables’ it is possible to convert such a prob-
lem into an ordinary differential equation. This was touched on brieﬂy in Exer-
cise 20.10, and the exercises in this chapter apply this method in more detail for
the example of the vibrating string.
Viewed in general this approach leads to the theory of Fourier series (the ex-
pansion of an arbitrary function as a sum of sines and cosines, see Exercises 38.7
and 38.8), and its extension via the Sturm–Liouville theory of boundary eigenvalue
problems
−d
dx

p(x)dy
dx

+ q(x)y = λw(x)y
with
y(a) = y(b) = 0.
These topics are treated at length in many differential equation textbooks, for ex-
ample,
373

374
38 What next?
W. E. Boyce and R. C. DiPrima, Elementary differential equations and boundary value
problems, 7th edition (John Wiley & Sons, 2001)
C. H. Edwards and D. E. Penney, Differential equations and boundary value problems,
2nd edition (Prentice Hall, 2000)
R. K. Nagle, E. B. Saff and A. D. Snider, Fundamentals of differential equations and
boundary value problems (Addison-Wesley, 2000),
all of which also cover much of the material presented in this book.
The theory of Fourier series is treated rigorously in
H. A. Priestley, Introduction to Integration (Oxford University Press, 1997)
Sturm–Liouville theory provides one of the ﬁrst concrete applications in intro-
ductory courses on functional analysis, see for example,
E. Kreyszig, Introductory Functional Analysis with Applications (Wiley, 1978)
M. Renardy and R. C. Rogers, An introduction to partial differential equations, in the
series Texts in Applied Mathematics Volume 13 (Springer Verlag, 1992)
N. Young, Hilbert Spaces (Cambridge University Press, 1988)
38.2 Dynamical systems and chaos
We have investigated, at least numerically, the complicated dynamics of the Lorenz
equations. Similarly we spent a chapter examining the behaviour of the iterated lo-
gistic map. Both of these examples pose problems whose solution is beyond the
techniques presented in this book, and fall into the realm of the theory of dynam-
ical systems. The subject received a large boost in the 1980s, when it was popu-
larised under the media-friendly ‘chaos’ banner. One particularly readable popular
account is
J. Gleick, Chaos: making a new science (Minerva, 1997)
while one of the early pioneers in the subject presents it in an accessible way in
E. N. Lorenz, The essence of chaos (University of Washington Press, 1994).
The theory is concerned with the qualitative behaviour of the solutions of dif-
ference and differential equations in very general situations in which we cannot
hope to be able to ﬁnd an explicit solution. Since we cannot base our understand-
ing on explicit solutions, the subject relies on a series of very powerful general
results (like the Hartman–Grobman Theorem we used to draw our phase portraits
for nonlinear coupled equations) and inspired simpliﬁcations (like the substitution
we used to turn the logistic map xn+1 = 4xn(1 −x)n) into the simpler ‘tent map’).
Books that treat the subject from a rigorous but accessible point of view, and
could be seen as continuing naturally from the material we have covered here are
V. I. Arnol’d, Ordinary Differential Equations, 3rd edition (Springer Verlag, 1992)

Exercises
375
R. L. Devaney, An introduction to chaotic dynamical systems, 2nd edition (Westview
Press, 2003)
P. A. Glendinning, Stability, instability, and chaos (Cambridge University Press, 1994)
J. Guckenheimer and P. Holmes, Nonlinear oscillations, dynamical systems and
bifurcations of vector ﬁelds, in the series Applied Mathematical Sciences 42
(Springer Verlag, 1983)
M. W. Hirsch and S. Smale, Differential equations, dynamical systems, and linear algebra
(Academic Press, 1974)
D. W. Jordan and P. Smith, Nonlinear ordinary differential equations, 2nd edition (Oxford
University Press, 1999)
Two classic advanced texts that concentrate more on the rigorous proof of fun-
damental results are
J. K. Hale, Ordinary Differential Equations, 2nd edition (Krieger, 1980)
P. Hartman, Ordinary Differential Equations, 2nd edition (SIAM, 1973)
Finally, I cannot end without recommending unreservedly the thoughtful and
entertaining book
D. Ruelle, Chance and Chaos (Penguin Books, 1993)
Written by one of the foremost mathematicians working in the ﬁeld, it combines
a discussion of various topics from dynamical systems and modern theoretical
physics with many insights into the life of the research mathematician, and life in
general.
Exercises
This sequence of exercises treats the problem of the vibrating string using the method of
separation of variables. This produces a simple boundary value problem, and serves to
introduce the idea of Fourier series.
The equation for the vibrations of a string stretched between x = 0 and x = 1 and at-
tached at both endpoints is
∂2u
∂t2 = c2 ∂2u
∂x2 ,
(E38.1)
with u(x, t) representing the height of the string at position x at time t. Since the string is
ﬁxed at the endpoints, we should have u(0, t) = u(1, t) = 0 for all t. See Figure 38.1.
38.1
Show that the principle of superposition is valid: if two functions u1(x, t)
and u2(x, t) satisfy the equation and the boundary conditions, then u(x, t) =
αu1(x, t) + βu2(x, t) also satisﬁes both the equation and the boundary condi-
tions.
38.2
Show that if we guess that a solution has the form u(x, t) = X(x)T (t) then X(x)
and T (t) must satisfy
1
c2T
d2T
dt2 = 1
X
d2X
dx2 .

376
38 What next?
x
u(x,t)
0
1
Fig. 38.1. A vibrating string, ﬁxed at the endpoints x = 0 and x = 1.
Since the left-hand side is a function of t alone, and the right-hand side is a function of x
alone, the only way that they can be equal is if they are both constant. If we choose this
constant to be −λ then we obtain two equations,
d2T
dt2 = −λc2T
(E38.2)
and the boundary value problem
d2X
dx2 = −λX
with
X(0) = X(1) = 0.
(E38.3)
38.3
Show that if λ ≤0 then the only solution of (E38.3) is X(x) = 0 for all x ∈[0, 1].
(You can ﬁnd the general solution using the methods you have learned in this
book, and then choose the constants in order to satisfy the boundary conditions.)
38.4
Show that if λ > 0 then we only have X(x) ̸= 0 if we choose λ = n22 for some
integer n, and then
X(x) = AXn(x),
where
Xn(x) = sin nx
and A is an arbitrary constant.
The values λn = n22, and the corresponding solutions Xn(x), are known as the eigen-
values and eigenfunctions for the problem
d2X
dx2 = −λX
with
X(0) = X(1) = 0.
(E38.4)
38.5
By requiring the solution of (E38.4) to be non-zero we have restricted the possible
values of λ to the eigenvalues λn = n22. Find the solution of (E38.2) when
λ = λn, and hence show that one solution of (E38.1) is
u(x, t) = (A sin nct + B cos nct) sin nx.
(E38.5)

Exercises
377
Use the principle of superposition to show that
u(x, t) =
∞

n=1
(An sin nct + Bn cos nct) sin nx
(E38.6)
solves (E38.1) for any choice of coefﬁcients An and Bn.
38.6
Assuming that any solution of (E38.1) can be written in the form (E38.6), the
problem becomes to determine the coefﬁcients An and Bn. Show that if the initial
position and velocity of the string, u(x, 0) and ∂u/∂t(x, 0), are given then An and
Bn must satisfy
u(x, 0) =
∞

n=1
Bn sin nx
(E38.7)
and
∂u
∂t (x, 0) =
∞

n=1
nc An sin nx.
An expansion of a function f (x) as a sum of sine functions,
f (x) =
∞

n=1
cn sin nx
(E38.8)
is known as a Fourier series expansion of f . It is one of the wonders of mathematics that
any reasonably smooth function f that has f (0) = f (1) = 0 can be expanded in such a
series. (If we also include cosine functions then we can remove the restrictions at the end-
points.) Finding the coefﬁcients cn is also relatively straightforward, at least in principle.
38.7
Check that
 1
0
sin nx sin mx dx =
 0
n ̸= m
1
2
n = m.
(The functions sin nx and sin mx are orthogonal on [0, 1].)
38.8
Multiply both sides of (E38.8) by sin mx and, assuming that it is possible to
integrate the series term-by-term, show that the coefﬁcient cm is given by
cm = 2
 1
0
f (x) sin mx dx.
Sturm–Liouville theory treats the more general eigenvalue problem
−d
dx

p(x)dy
dx

+ q(x)y = λw(x)y
with
y(a) = y(b) = 0
(in equation (E38.3) we had p(x) = w(x) = 1, q(x) = 0, a = 0, and b = 1). There are,
again, an inﬁnite set of eigenvalues λn for which there is a corresponding non-zero eigen-
function yn(x). The eigenfunctions are ‘orthonormal on [a, b] with respect to the weight

378
38 What next?
function w(x)’,
 b
a
yn(x)ym(x)w(x) dx =
0
n ̸= m
1
n = m.
(E38.9)
Furthermore, any function f (x) satisfying the boundary conditions can be expanded as a
generalised Fourier series using the eigenfunctions yn(x),
f (x) =
∞

n=1
cnyn(x).
(E38.10)
38.9
Using the orthonormality relation in (E38.9) show that the coefﬁcients cm in
(E38.10) are given by
cm =
 b
a
f (x)ym(x)w(x) dx.

Appendix A: Real and complex numbers
In this appendix we discuss some basic notation and properties of real and complex
numbers. We use ‘∈’ to denote ‘is an element of’.
Real numbers
We use R to denote the collection of all the real numbers, so that α ∈R simply
means that α is a real number. We use curved brackets to denote the open end
of an interval, and square brackets to denote the closed end of an interval, so for
example
x ∈[a, b]
represents
a ≤x ≤b,
and
x ∈(a, b]
represents
a < x ≤b.
One end of the interval is allowed to be ±∞, for example
t ∈(−∞, t∗)
represents
t < t∗.
Complex numbers
A complex number is a number z of the form z = x + iy, where i =
√
−1. Any
complex number can be split into its real and imaginary parts, Re[z] and Im[z],
where
Re[z] = x
and
Im[z] = y.
The rules for addition and multiplication of complex numbers follow from ap-
plying standard algebra and the fact that i2 = −1; we have
(a + ib) + (c + id) = (a + c) + i(b + d)
379

380
Appendix A Real and complex numbers
and
(a + ib)(c + id) = (ac −bd) + i(ac + bd).
(A.1)
The complex conjugate of a complex number z = x + iy is written z∗and is
given by z∗= x −iy. Adding z and its complex conjugate yields twice the real
part of z,
z + z∗= (x + iy) + (x −iy) = 2x = 2 Re[z],
while their difference gives i multiplied by twice the imaginary part of z,
z −z∗= (x + iy) −(x −iy) = 2iy = 2i Im[z].
Also useful is the fact that the complex conjugate of a product is the product of the
complex conjugates, (wz)∗= w∗z∗. In order to see this, note that
(a + ib)∗(c + id)∗= (a −ib)(c −id) = (ac −bd) −i(ac + bd)
= [(ac −bd) + i(ac + bd)]∗= [(a + ib)(c + id)]∗,
using (A.1).
One important identity involving complex numbers is Euler’s formula,
eiθ = cos θ + i sin θ.
(A.2)
The easiest way to see this is to use the power series expansion of ez,
ez =
∞

n=0
zn
n!
(see Appendix C.) If z = iθ then we have
eiθ =
∞

n=0
(iθ)n
n! .
Since i2 = −1, the even powers in the expansion are real, while the odd powers
are still imaginary, and we get
eiθ =
∞

n=0
(−1)n θ2n
(2n)! + i
∞

n=0
(−1)n
θ2n+1
(2n + 1)!.
The two sums on the right-hand side are just those for cos θ and sin θ respectively
(see Appendix C again), and so eiθ = cos θ + i sin θ, as claimed.
This gives another, often convenient form in which we can write any com-
plex number, known as modulus and argument form. This is when we express
z = x + iy as z = reiθ. This is illustrated in Figure A.1, which shows z plotted on

Appendix A Real and complex numbers
381
θ
r
y = r sin θ
x = r cos θ
z = x + iy
Fig. A.1. The complex number z = x + iy written in modulus and argument
form, z = reiθ.
the Argand diagram. (The Argand diagram shows the ‘complex plane’, where the
real part of z gives the x coordinate and the imaginary part of z gives the y coordi-
nate.)
It follows that
r =

x2 + y2
and
θ = tan−1(y/x).
This is entirely analogous to using plane polar coordinates instead of standard
cartesian coordinates, cf. (29.8).

Appendix B: Matrices, eigenvalues, and eigenvectors
This appendix covers the simple algebra of matrices, and some properties of eigen-
values and eigenvectors. The calculation of eigenvalues and eigenvectors is the
main topic of Chapter 27.
Basic matrix algebra
For the most part, we will only need to consider the algebra of 2 × 2 matrices,

a
b
c
d

.
Addition of two matrices is component by component, so that

a11
a12
a21
a22

+

b11
b12
b21
b22

=

a11 + b11
a12 + b12
a21 + b21
a22 + b22

,
while multiplication is given by

a11
a12
a21
a22
 
b11
b12
b21
b22

=

a11b11 + a12b21
a11b12 + a12b22
a21b11 + a22b21
a21b12 + a22b22

.
We can write this more compactly by saying that
[AB]i j = ai1b1 j + ai2b2 j =
2

k=1
aikbkj,
where [AB]i j is the entry in the ith row and jth column of the matrix AB.
One special matrix is the identity matrix,
I =

1
0
0
1

,
which has the property that IA = AI = A for any 2 × 2 matrix A.
382

Appendix B Matrices, eigenvalues and eigenvectors
383
A matrix A is said to be invertible, or non-singular, if there is another matrix
A−1 such that
A−1A = AA−1 = I.
The matrix
A =

a
b
c
d

(B.1)
is invertible if and only if its determinant, det(A), given by
det(A) =

a
b
c
d
 = ad −bc
is not equal to zero, and then
A−1 =
1
ad −bc

 d
−b
−c
a

.
Matrices and vectors
Multiplication of vectors by matrices
In general we can calculate the product AB when A is an n × m matrix and B is
an m × k matrix (the columns of A have to match the rows of B). In particular
this allows us to calculate Ax if A is a 2 × 2 matrix and x = (x1, x2) is a two
component vector,

a11
a12
a21
a22
 
 x1
x2

=

a11x1 + a12x2
a21x1 + a22x2

.
We can also write this more compactly as
[Ax]i = ai1x1 + ai2x2,
(B.2)
where vi indicates the ith component of the vector v. (Note that this means in
particular that if [v1 v2] is a matrix with columns made from the vectors v1 and
v2 then for a 2 × 2 matrix A we have
A[v1 v2] = [Av1 Av2],
which is used repeatedly in Chapters 28–30.)
Solution of simultaneous equations
The simultaneous linear equations
ax1 + bx2 = c1
cx1 + dx2 = c2

384
Appendix B Matrices, eigenvalues and eigenvectors
can be rewritten as the matrix equation
Ax = c,
where A is deﬁned as in (B.1), x = (x1, x2) and c = (c1, c2). This equation has
a unique solution if and only if A is invertible, and then the solution is given by
multiplying both sides by A−1,
x = A−1c.
It follows that Ax = 0 can have a non-zero solution for x only if A is not invertible.
Eigenvalues and eigenvectors
If v ̸= 0 and
Av = λv
then λ is an eigenvalue of A and v is the corresponding eigenvector. The calcu-
lation of eigenvalues and eigenvectors for 2 × 2 matrices is treated in detail in
Chapter 27.
Linear independence of eigenvectors
The eigenvectors corresponding to two distinct eigenvalues are linearly indepen-
dent; if
αv1 + βv2 = 0
(B.3)
then we can multiply both sides by A to obtain
A(αv1 + βv2) = 0.
Since Av j = λ jv j we have
αλ1v1 + βλ2v2 = 0.
(B.4)
While (B.3) requires that v1 = −βv2/α, the second equation (B.4) says that v1 =
(λ2/λ1) × (−βv2/α). Since λ2 ̸= λ1 these cannot both be true unless β = 0, in
which case α = 0 also, and v1 and v2 are therefore linearly independent.
The special case of symmetric matrices
The transpose of the matrix
A =

a11
a12
a21
a22

,

Appendix B Matrices, eigenvalues and eigenvectors
385
written AT , is given by
AT =

a11
a21
a12
a22

;
i.e. [AT ]i j = [A] ji. A matrix is called symmetric if A = AT , i.e. if [A]i j = [A] ji.
A general 2 × 2 symmetric matrix is of the form

a
b
b
d

.
For such matrices all the eigenvalues are real, and eigenvectors corresponding to
distinct eigenvalues are orthogonal.
To see that the eigenvalues are real, suppose that λ is an eigenvalue and v =
(v1, v2) is the corresponding eigenvector. Then
Av = λv,
and
Av∗= λ∗v∗,
where the second equation is the complex conjugate of the ﬁrst. We take the inner
(dot) product of the ﬁrst equation with v∗, and of the second with v,
v∗· Av = λ|v|2
and
v · Av∗= λ∗|v|2.
(B.5)
Now, the expression on the left-hand side of the ﬁrst equation in (B.5) is
v∗· Av =
2

i=1
v∗
i [Av]i =
2

i, j=1
v∗
i ai jv j
=
2

i, j=1
v∗
i a jiv j
=
2

i, j=1
v ja jiv∗
i
=
2

j=1
v j[Av∗] j = v · Av∗,
and so is the same as the expression on the left-hand side of the second equation
in (B.5). It follows that
λ|v|2 = λ∗|v|2,
i.e. λ = λ∗and so this eigenvalue is real.

386
Appendix B Matrices, eigenvalues and eigenvectors
To see that the eigenvectors corresponding to distinct eigenvalues are orthogo-
nal, suppose that Av(1) = λ1v(1) and Av(2) = λ2v(2) with λ1 ̸= λ2. Then
v(1) · Av(2) = v(1) · λ2v(2) = λ2(v(1) · v(2)).
Looking at the left-hand side of this we have
v(1) · Av(2) =

i
v(1)
i
[Av(2)]i =
2

i, j=1
v(1)
i
ai jv(2)
j
=
2

i, j=1
v(1)
i
a jiv(2)
j
=
2

i, j=1
v(2)
j a jiv(1)
i
=
2

j=1
v(2)
j [Av(1)] j = v(2) · Av(1).
Now,
v(2) · Av(1) = v(2) · λ1v(1) = λ1(v(1) · v(2)),
and since v(1) · Av(2) = v(2) · Av(1) we therefore have
λ2(v(1) · v(2)) = λ1(v(1) · v(2)),
i.e.
(λ2 −λ1)(v(1) · v(2)) = 0.
Since λ2 ̸= λ1 we must have v(1) · v(2) = 0, i.e. the eigenvectors are orthogonal.

Appendix C: Derivatives and partial derivatives
This appendix covers the deﬁnitions and properties of ordinary and partial deriva-
tives, Taylor expansions in one and two variables, and some properties of the crit-
ical points (turning points) of functions.
Functions of one variable: ordinary derivatives
We start by considering functions f (x) of one variable, and their derivatives.
Deﬁnition and properties of the derivative
Let I be an interval. A function f : I →R is differentiable at a point x ∈I if the
limit
lim
h→0
f (x + h) −f (x)
h
(C.1)
exists, in which case the limit in (C.1) is the derivative of f at x, which we write
as (d f/dx)(x) or f ′(x).
This basic deﬁnition implies the standard rules of differentiation. The product
rule is
[ f g]′ = f ′g + f g′
the quotient rule is
 f
g
′
= g f ′ −f g′
g2
;
387

388
Appendix C Derivatives and partial derivatives
and the chain rule, which allows us to differentiate functions of functions, is1
d
dx

f

g(x)

= f ′
g(x)

g′(x).
Taylor expansions
Taylor’s Theorem allows us to expand a function f as a power series about a point
x0 using its derivatives. Suppose that f has n + 1 derivatives, all of which are
continuous functions, and that we use the notation
f (n)(x) = dn f
dxn (x).
Then we can write
f (x) = f (x0) + (x −x0) f ′(x0) + (x −x0)2
2!
f ′′(x0) +
· · · + (x −x0)n
n!
f (n)(x0) + (x −x0)n+1
(n + 1)!
f (n+1)(yn),
(C.2)
for some point yn ∈(x0, x).
Provided that the remainder term
Rn = (x −x0)n+1
(n + 1)!
f (n+1)(yn)
(C.3)
tends to zero as n tends to inﬁnity, we can write f (x) as the power series
f (x) =
∞

n=0
dn f
dxn (x0)(x −x0)n
n!
,
known as the ‘Taylor expansion’ or ‘Taylor series’ for f .
Power series
We can use the Taylor expansion to ﬁnd representations of common functions in
terms of power series, i.e. an expression of the form
∞

n=0
anxn.
For example, if we take f (x) = ex and x0 = 0 then
dn f
dxn = ex
for all
n = 0, 1, 2, . . . .
1 As written here we have confused the various functions that appear with their values at the point x. More
correctly we should write [ f ◦g]′(x) = f ′(g(x))g′(x), where f ◦g is the composition of f and g, i.e.
( f ◦g)(x) = f (g(x)). But such pedantry is probably unhelpful.

Appendix C Derivatives and partial derivatives
389
It follows that dn f/dxn(0) = 1 for all n, and so the Taylor series for ex is
ex =
∞

n=0
xn
n! .
For f (x) = sin x, the derivatives are
d2n f
dx2n (x) = (−1)n sin x
and
d2n+1 f
dx2n+1 = (−1)n cos x.
It follows that d2n f/dx2n(0) = 0 and d2n+1 f/dx2n+1 = (−1)n, so that
sin x =
∞

n=0
(−1)n+1
x2n+1
(2n + 1)!.
A similar calculation shows that
cos x =
∞

n=0
(−1)n x2n
(2n)!.
For a brief discussion of the convergence of such power series, see Chapter 20.
Turning points
A point x0 is a turning point (or critical point) for f if f ′(x0) = 0. We can ﬁnd out
whether such a point is a local maximum, a local minimum or a point of inﬂection,
by using the Taylor series expansion near x0. If we assume that f ′′(x0) ̸= 0 and
we keep only the ﬁrst three terms from (C.2) then we have
f (x) ≈f (x0) + (x −x0)2
2!
f ′′(x0),
where there is no second term since f ′(x0) = 0. (Because we know that the re-
mainder term is K(x −x0)3 for some constant K (cf. (C.3)), we can be sure
that sufﬁciently close to x0 the last term that we have kept is larger than all the
terms that we have neglected.) It is easy to see from here that if f ′′(x0) < 0 then
f (x) < f (x0) close to x0, i.e. that f has a maximum at x0; while if f ′′(x0) > 0
then it follows that f (x) > f (x0) close to x0 and so x0 is a minimum of f .
If f ′′(x0) = 0 and f ′′′(x0) ̸= 0 then we can take one further term of the Taylor
expansion to ﬁnd
f (x) ≃f (x0) + (x −x0)3
3!
f ′′′(x0).
Since (x −x0)3 changes sign near x0, it follows that x0 is now a point of inﬂection.

390
Appendix C Derivatives and partial derivatives
Functions of two variables: partial derivatives
We now treat similar topics for functions of two variables.
Partial derivatives and their properties
If f (x, y) is a function of two variables then the partial derivative of f with respect
to x is found by treating y as a constant and differentiating with respect to x,
∂f
∂x (x, y) = lim
h→0
f (x + h, y) −f (x, y)
h
;
similarly, ∂f/∂y is found by keeping x constant and differentiating with respect
to y.
Since ∂f/∂x is in general another function of x and y it is possible to take partial
derivatives again, e.g.
∂2 f
∂x2 = ∂
∂x

∂f
∂x

,
∂2 f
∂y ∂x = ∂
∂y

∂f
∂x

.
One useful property of partial derivatives is that the order in which they are taken
does not matter, so in particular we have
∂2 f
∂y ∂x = ∂2 f
∂x ∂y ,
(C.4)
i.e. it makes no difference if we take the partial derivative with respect to x and
then with respect to y, or vice versa.
Obvious generalisations of the product and quotient rule apply to partial deriva-
tives. When f is a function of x and y, and x and y depend on the same variable
t, we have the following version of the chain rule. In this case, when f (x(t), y(t))
is in fact a function of the single variable t,
d
dt f

x(t), y(t)

= ∂f
∂x

x(t), y(t)
dx
dt (t) + ∂f
∂y

x(t), y(t)
dy
dt (t).
Taylor expansions
There is a two-dimensional version of Taylor’s Theorem, which allows us to ex-
pand f (x, y) near a point (x0, y0) as a series involving the partial derivatives of f
at (x0, y0). Writing ξ = x −x0 and η = y −y0, and only giving the terms up to

Appendix C Derivatives and partial derivatives
391
third order we have
f (x, y) = f (x0, y0) + ξ ∂f
∂x + η∂f
∂y + 1
2!

ξ2 ∂2 f
∂x2 + 2ξη ∂2 f
∂x∂y + η2 ∂2 f
∂y2

+ 1
3!

ξ3 ∂3 f
∂x3 + 3ξ2η ∂3 f
∂x2∂y + 3ξη2 ∂3 f
∂x∂y2 + η3 ∂3 f
∂y3

+ · · · ,
where all the partial derivatives are evaluated at the point (x0, y0). (It is possible to
check this by ﬁrst doing a Taylor expansion with respect to x keeping y ﬁxed, and
then Taylor expanding each of these terms with respect to y.)
In Chapter 32 we will use the simplest non-trivial consequence of this expan-
sion, where we keep only the terms that are linear in ξ and η,
f (x0 + , y0 + ) = f (x0, y0) + ξ ∂f
∂x (x0, y0) + η∂f
∂y (x0, y0) + · · ·
Critical points
In this section we will use the shorthand notation
fx = ∂f
∂x ,
fy = ∂f
∂y ,
fxy = ∂2 f
∂x ∂y ,
etc.
A point (x0, y0) is called a critical point of f if fx = fy = 0, i.e. if
∂f
∂x = 0
and
∂f
∂y = 0.
We can use the Taylor expansion of f near this point to see what kind of critical
point we have. Keeping only terms up to second order (as we did for functions of
one variable) we have
f (x, y) = f (x0, y0) + ξ fx + ηfy + 1
2

ξ2 fxx + 2ξηfxy + η2 fyy

+ · · · .
We can remove the terms linear in ξ and η (since fx = fy = 0 at the critical point),
and then rewrite the quadratic terms using matrix notation to give
f (x0 + ξ, y0 + η) ≈f (x0, y0) + 1
2(ξ η)

 fxx fxy
fyx fyy
 
ξ
η

.
(C.5)
The matrix of second partial derivatives,
H =

 fxx fxy
fyx fyy

,
ξ
η

392
Appendix C Derivatives and partial derivatives
−1
0
1
−1
0
1
0
1
2
3
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−1
0
1
−1
0
1
−4
−2
0
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
−1
0
1
−1
0
1
−2
−1
0
1
−1
−0.5
0
0.5
1
−1
−0.5
0
0.5
1
Fig. C.1. Plots of a surface whose height is f (x, y), and contour plots of f , near a
point (x0, y0) which is, from top to bottom, a maximum, a minimum and a saddle
point.
is known as the Hessian matrix. Just as the type of the critical point x0 for a func-
tion of one variable is determined by the sign of f ′′(x0), so the type of the critical
point of f (x, y) is determined by the properties of this matrix of second deriva-
tives, and in particular by the sign of its eigenvalues.
Because fxy = fyx (see (C.4)) the Hessian matrix is symmetric. It is a general
result that a real symmetric matrix has real eigenvalues λ1 and λ2 and that if these

Appendix C Derivatives and partial derivatives
393
eigenvalues are distinct then the corresponding eigenvectors v1 and v2 are orthog-
onal,
v1 · v2 = 0,
see Appendix B. Suppose that we use this notation for the eigenvalues and eigen-
vectors of the Hessian matrix H, and choose the eigenvectors so that they have
length 1, i.e. |v j| = 1. Now if we write the vector (ξ, η) in terms of the eigenvec-
tors of the Hessian matrix,

ξ
η

= αv1 + βv2,
the second term in (C.5) is
1
2[αv1 + βv2] · H[αv1 + βv2] = 1
2[αv1 + βv2] · [αλ1v1 + βλ2v2]
= 1
2[α2λ1 + β2λ2].
So we have
f (x0 + ξ, y0 + η) ≈f (x0, y0) + 1
2(α2λ1 + β2λ2);
the behaviour of f near (x0, y0) does indeed depend on the eigenvalues of H.
If both eigenvalues are positive then f (x, y) > f (x0, y0) close to (x0, y0), so we
have a minimum; if both eigenvalues are negative then f (x, y) < f (x0, y0) close
to (x0, y0) and this point is a maximum. If the two eigenvalues have opposite signs
then we have a saddle point: f increases in one direction (the direction of the
eigenvector corresponding to the positive eigenvalue), and decreases in another
(the eigenvector for the negative eigenvalue). Plots of f against x and y, and the
contour plots of curves of constant f in each of these three cases, are shown in
Figure C.1. Note that near a maximum or minimum of f the curves of constant f
are closed.


Index
Bold numbers indicate that the entry is the subject of a chapter beginning on that page, italic numbers indicate
that the entry is the subject of a section starting on that page.
air resistance, 52, 73
Airy equation, 181
and Bessel functions, 189
solutions as power series, 183
Albert Bridge, 144
amplitude, 82
analytic functions, 178
anti-derivative, 22
Argand diagram, 381
attracting
ﬁxed point, 225
set, 238
stationary point, 48
autonomous, 13
auxiliary equation
complex roots (difference case), 218
complex roots (ODE case), 115
distinct real roots (difference case), 215
distinct real roots (ODE case), 112
for difference equations, 215
for nth order ODE, 151
for 2nd order ODE, 112
repeated real root (ODE case), 113
second solution by reduction of order, 160
repeated root (difference case), 217, 222
backwards Euler method, 210, 214
bead on a wire, 344
beating phenomenon, 148
Bernoulli equations, 96
Bessel’s equation, 187
arising in circular drum problem, 198
general recurrence relation, 188
of order zero
ﬁrst solution, 191
log solution, 192
of order 1/3, 188
of order 1/2, 190
of order one
ﬁrst solution, 196
log solution, 196
of order n, 197
of order ν, 187
bifurcation
deﬁnition, 50
diagram
for logistic map, 238
for pitchfork bifurcation, 56
pitchfork, 54
saddle node, 57
transcritical, 57
binary decimal, 243
blow up in ﬁnite time, 42, 74
body temperature, 80
boundary value problems, 373
eigenvalues and eigenfunctions, 376
Broughton suspension bridge, 144
buoyancy, 127
butterﬂy effect, 370
Cauchy–Euler equation, 170, 184
Cayley–Hamilton Theorem, 296, 300
centre, 290, 301, 317, 322, 337
chain rule
functions of one variable, 388
functions of two variables, 390
chaos, 56, 374
in the logistic map, 240
characteristic equation, 261
Clay Mathematics Institute, 43
cobweb diagrams, 225
complementary function, 132
for difference equations, 215
for nth order equations, 151
for second order ODEs, 131
complex numbers, 379
complex conjugate, 380
imaginary part, 379
395

396
Index
complex numbers (cont.)
modulus and argument form, 380
real part, 379
conservative systems, 341
convergence of power series, 176
absolute, 177
coordinate transformation
complex eigenvalues, 287
distinct real eigenvalues, 271
repeated real eigenvalue, 295
representation of vectors, 302
coordinate transformations
representation of linear maps, 303
critical point
for functions of one variable, 389
for functions of two variables, 391
cubic equation, 151
damping, 347
critical, 125, 130
over-, 125
under-, 125
dashpot, 127
death
time of, 80, 87, 88
derivatives, 387
deﬁnition, 387
partial, 390
determinant, 155, 383
difference equations, 213
homogeneous, linear, 215
nonlinear, 224
order of, 213
differential
equation
autonomous, 13
order of, 13
ordinary, 11
partial, 11
separable, 59
trivial, 22, 59
inequality, 88
operator, 103
direction ﬁelds, 311
dissipative systems, 347
divergence theorem, 360
double angle formula, 83, 148
Dulac’s criterion, 360, 362
dummy variable, 9
dynamical systems, 56, 374
ecological models, 310, 323
eigenfunctions
for boundary value problems,
376
eigenvalues, 259
and eigenvectors, 384
complex, 265
eigenvalue equation, 260
for boundary value problems, 376
of diagonal matrix, 264
of matrix with zero in off-diagonal, 264
with MATLAB, 266
eigenvectors, 259
complex, 265
linear independence, 384
of diagonal matrix, 264
of matrix with zero in off-diagonal, 264
errata, 2
error estimate, 209
Euler θ-method, 210
Euler–Mascheroni constant, 195
Euler’s formula, 380
Euler’s method, 201
as a nonlinear difference equation, 227
backwards version, 210, 214
convergence, 206
implemented in MATLAB, 204
trapezoidal, 210, 231
exact equations, 89
integrating factors, 91
existence
and uniqueness
second order equations, 251
second order linear ODEs, 101
theorem for scalar ODEs, 40
theorem for vector IVP, 250
example of ODE with non-existence, 38
of solutions of second order linear equations,
119
sketch proof for scalar ODEs, 44
Fibonacci numbers, 215, 223
ﬁxed point, 224
analytic conditions for (in)stability, 225
rigorous argument, 231
stability properties (deﬁnitions), 225
Fourier series, 373, 377
frequency, 82
fundamental theorem of calculus, 22, 27, 37
gamma function, 190, 197
Gaussian integral, 32
golden ratio, 222
half-life, 5
carbon-14, 7
plutonium-239, 8
harmonic series, 194, 197
Hartman–Grobman Theorem, 316, 322, 374
Hessian, 392
homogeneous equations, 94
homogeneous linear equation, 14
Hooke’s law, 120
implicit function theorem, 58
improper node, 295, 301
independent variables, 11
indicial equation
complex roots (Cauchy–Euler equation), 173
for Cauchy–Euler equation, 171, 184
near a regular singular point, 185

Index
397
repeated real roots (Cauchy–Euler equation), 171
two real roots (Cauchy–Euler equation), 171
inhomogeneous linear equation, 14
initial condition, 26, 38
initial value problem (IVP), 38
integrating factor, 73, 76
for exact equations, 91
integration, 88
integration variables, 9
invariance, 276
invertible matrix, 383
Jordan canonical form, 269, 301
kernel (of linear operator), 108
Legendre’s equation, 195
Leibniz, 1
L’Hˆopital’s rule, 148
linear algebra, 107
linear equation, 14
ﬁrst order, 73, 75
homogeneous, 14
inhomogeneous, 14
second order
constant coefﬁcients, 111
construction with speciﬁed solutions,
163
series solutions, 176
solutions exist for all time, 119
third order and above, 150
linear independence, 104
of eigenvectors, 384
of n functions, 153
of 2 functions, 104
of 3 functions, 154
linear matrix equation
complex eigenvalues, 285
canonical form, 288
explicit solution, 285
phase diagram, 287, 291
possible phase diagrams, 301
distinct real eigenvalues, 269
canonical form, 274
explicit solution, 270
possible phase diagrams, 301
repeated eigenvalue, 295
canonical form, 297
explicit solution, 297
possible phase diagrams, 301
linear operator, 103, 108, 152
kernel, 108
linear transformations and matrices, 303
linearisation, 314
validity for nonlinear systems, 316, 322
linearity, 102, 131, 139
Lipschitz continuity, 40, 44, 208
logistic map, 233, 374
bifurcation diagram, 238
chaos, 240
ﬁxed points, 234
period-doubling cascade, 237, 246
periodic orbits, 234
sensitive dependence on initial conditions, 241
logistic population model (ODE), 51, 66, 311
Lorenz attractor, 368
Lorenz equations, 364, 374
sensitive dependence on initial conditions, 370
Lotka–Volterra systems, 323
manifold
stable, 281, 317, 326–327, 356
unstable, 281, 317
MATLAB
airy (Airy function), 181
and Euler’s method, 204
besselj (Bessel function of 1st kind), 181, 190
bessely (Bessel function of 2nd kind), 181,
194
contour (contour plot), 21
eig (ﬁnd eigenvalues and eigenvectors), 266
M-ﬁles on the web, 2
backeuler.m, 212
besselseries.m, 197
bifurcation.m, 246
cauchyeuler.m, 174
cylinder.m, 358
euler.m, 204, 232
flies.m, 370
f2.m, 246
logistic.m, 246
lorenz37.m, 364
lorenzdraw.m, 368
lotkaplane.m, 339
lportrait.m, 283
makematrix.m, 283
newtonde.m, 351
newtonplane.m, 351
renormalised.m, 246
rungekutta.m, 212
solvem.m, 370
xnvsn.m, 246
ode45 (ODE solver), 15, 18, 209
quad (integration), 19
quiver (direction ﬁeld), 311
matrices
and linear transformations, 303
determinant, see determinant
eigenvalues, see eigenvalues
eigenvectors, see eigenvectors
similar, 304
symmetric, 392
matrix algebra, 382
maximal interval of existence, 42
Millennium Bridge, 128
modulus and argument form, 380
Navier–Stokes equations, 12, 34, 42
Newton, 1
law of cooling, 79, 87
second law of motion, 12, 29
Newtonian systems, 341

398
Index
node
improper, 295, 301
stable, 277, 301
unstable, 278, 301
non-singular matrix, 383
non-uniqueness of solutions of ODEs, 39, 74
nonlinear pendulum, 352
with quadratic damping, 358
nullclines, 312, 340
ODE, see differential equation
orbit, 224
periodic, see periodic orbit(s)
order
of a difference equation, 213
of a differential equation, 13
ordinary point, 178
oscillation(s), 81, 117, 120
combining two oscillations of the same
frequency, 83, 120
damped, 123
partial derivatives, 390
partial differential equations, 12, 373
particular integral (for ODE), 132
exponential right-hand side, 135
polynomial right-hand side, 133
resonace, see resonance
rule of thumb, 139
sine or cosine on right-hand side, 137, 143
via variation of constants formula, 164
particular solution (for difference equation), 219
λn on the right-hand side, 221
polynomial on right-hand side, 219
pendulum
linear approximation, 122
nonlinear equation, 352
damped, 356
period, 82
of decaying oscillations, 126
period-doubling cascade, 237, 246
periodic orbit(s), 226, 230, 290, 301, 360
phase cylinder, 358
phase diagram, 47
analytic method for coupled equations, 314
general comments, 309
linear matrix equation
complex eigenvalues, 287, 291
distinct real eigenvalues (coupled), 279
distinct real eigenvalues (uncoupled), 276
summary of possibilities, 301
phase portrait, see phase diagram
phase space, 56
pitchfork bifurcation, 54
bifurcation diagram, 56
Poincar´e–Bendixson Theorem, 361
Poiseuille ﬂow, 35
polar coordinates, 289, 381
population model
logistic equation, 51, 66
Malthus’ linear model, 62
potential energy, 341
bead on a wire, 345
power series, 176, 388
convergence, 177
for cos x, 389
for ex, 389
for sin x, 389
predator-prey models, 331, 334
primitive, 22
product rule, 387
pseudo-resonance, 145
quadratic damping
air resistance, 52, 73
nonlinear pendulum, 358
quotient rule, 387
radioactive decay, 5
radiocarbon dating, 6
radius of convergence, 177
ratio test, 177
real numbers, 379
recurrence relation, 179
for Airy equation, 182
for Bessel’s equation, 188
near a regular singular point, 186
reduction of order, 159, 168
for xeλx solution of 2nd order ODE, 160
for log solution of Cauchy–Euler equation,
172
regular singular points, 183
log solution, 186
resonance, 141
response to periodic forcing, 147
Runge–Kutta scheme, 209, 212
saddle (point), 278, 301, 393
saddle node bifurcation, 57
second order equation
Cauchy–Euler equation, 170
constant coefﬁcient linear equation
homogeneous case, 111
inhomogeneous case, 131
existence and uniqueness, 251
general theory for linear equations, 101
reduction of order technique, 159
series solutions, 176
variation of constants formula, 164
semi-stable stationary point, 50
sensitive dependence on initial conditions
in the logistic map, 241
in the Lorenz equations, 370
separation of variables
for ODEs, 60
for radially symmetric wave equation,
198
for the vibrating string, 375
separatrix, 281, 326, 327, 356
series solutions, 176
similar matrices, 304
simple harmonic motion, 117, 121

Index
399
simultaneous equations, 383
solution
explicit, 14
general, 25
implicit, 14
of scalar IVP (deﬁnition), 40
of vector IVP (deﬁnition), 250
qualitative, 15
solutions of exercises, 2
species
competing, 71, 310, 323
coexistence, 327
no periodic orbits, 361
weak competition, 323
cooperative, 339
predator-prey, 331, 334
spiral
stable, 290, 301
unstable, 290, 301
spring, 120, 126
spring constant, 120
stable
ﬁxed point, 225
manifold, 281, 317, 326–327, 356
node, 277, 301
periodic orbit, 203
spiral, 290, 301
stationary point, 48
stars, 295, 301
stationary point, 47, 309
attracting, 48
semi-stable, 50
stable, 48
unstable, 48
step size, 201
string, 375
structural stability, 50
Sturm–Liouville theory, 373, 377
substitution method
for Bernoulli equations, 96
for homogeneous equations, 94
to solve Cauchy–Euler equation, 174
superposition principle, 103
for solutions of linear matrix equation, 259
for vibrating string, 375
symmetric matrix, 384, 392
Tartaglia, 151
Taylor expansion, see also power series
for functions of one variable, 203, 225, 388
for functions of two variables, 315, 390
tent map, 243, 372
terminal velocity, 52
timestep, 201
trajectories, 310
cannot cross in phase plane, 310
transcritical bifurcation, 57
trapezoidal Euler method, 210, 231
turning point, 389
uniqueness of solutions of ODEs, see also existence
and uniqueness 252
example of non-uniqueness, 39
proof for scalar ODE, 44
proof for vector ODE, 252
unstable
ﬁxed point, 225
manifold, 281, 317
node, 278, 301
spiral, 290, 301
stationary point, 48
variable(s)
independent, 11
of integration, 9
variation of constants formula, 164
vector ﬁrst order equations, 249
deﬁnition of solution, 250
existence and uniqueness, 250
uniqueness proof, 252
vector space, 108
washing machine, 141
Wronskian, 106, 109, 153–154, 166, 183

