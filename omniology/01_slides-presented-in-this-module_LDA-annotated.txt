Machine Learning Specializa0on 
 
Latent Dirichlet 
Allocation: Mixed 
Membership Modeling 
Emily Fox & Carlos Guestrin 
Machine Learning Specialization 
University of Washington 
1 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
Mixed membership models 
for documents 
2 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
3 
So far, clustered articles into groups 
©2016 Emily Fox & Carlos Guestrin 
Doc labeled 
with a topic 
assignment 
Clustering goal: discover groups of related docs 

Machine Learning Specializa0on 
4 
Are documents about just one thing? 
©2016 Emily Fox & Carlos Guestrin 
Is this article 
just about 
science? 

Machine Learning Specializa0on 
5 
Soft assignments capture uncertainty 
©2016 Emily Fox & Carlos Guestrin 
Soft assignment rik 
tells us this doc 
could be about world 
news or science 
But, clustering 
model still speciﬁes 
each doc belongs to 
1 topic 

Machine Learning Specializa0on 
6 
©2016 Emily Fox & Carlos Guestrin 
0 
1 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
Based on science 
related words, maybe 
doc in cluster 4 
Encoding of cluster 
membership zi = 4 

Machine Learning Specializa0on 
7 
0 
1 
©2016 Emily Fox & Carlos Guestrin 
Or maybe cluster 2 
(technology) is a better ﬁt 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
Encoding of cluster 
membership zi = 2 
Soft assignments 
capture uncertainty 
in zi = 2 or 4 

Machine Learning Specializa0on 
8 
©2016 Emily Fox & Carlos Guestrin 
0 
0.2 
0.4 
0.6 
Really, it’s about science 
and technology 
 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
“zi” is both 2 and 4 

Machine Learning Specializa0on 
9 
Mixed membership 
models 
Want to discover a 
set of memberships 
 
(In contrast, cluster models 
aim at discovering a single 
membership) 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible

Machine Learning Specializa0on 
Building up to document 
mixed membership models 
©2016 Emily Fox & Carlos Guestrin 
10 

Machine Learning Specializa0on 
11 
An alternative document clustering model 
©2016 Emily Fox & Carlos Guestrin 
(Back to 
clustering, 
not mixed 
membership 
modeling) 

Machine Learning Specializa0on 
12 
So far, we have considered… 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
tf-idf vector 
xi =  

Machine Learning Specializa0on 
13 
Bag-of-words representation 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
epilepsy 
modeling 
clinical 
complex 
Bayesian 

Machine Learning Specializa0on 
14 
Bag-of-words representation 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
multiset 
 
= unordered set of words with 
duplication of unique elements 
mattering 
xi = { modeling, complex, epilepsy, 
  modeling, Bayesian, clinical, 
  epilepsy, EEG, data, dynamic…}  

Machine Learning Specializa0on 
15 
A model for bag-of-words 
representation 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
As before, the “prior” 
probability that doc i is 
from topic k is:  
p(zi = k) = ⇡k
π = [π1  π2 … πK] 
represents corpus-wide 
topic prevalence 

Machine Learning Specializa0on 
16 
A model for bag-of-words 
representation 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
Assuming doc i is from 
topic k, words occur 
with probabilities: 
SCIENCE 
patients 0.05 
clinical 
0.01 
epilepsy 0.002 
seizures 0.0015 
EEG 
0.001 
… 
… 
words in vocab 

Machine Learning Specializa0on 
17 
Topic-speciﬁc word probabilities 
Distribution on words in vocab for each topic 
©2016 Emily Fox & Carlos Guestrin 
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 0.09 
processor 0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
(table now organized by decreasing probabilities 
showing top words in each category) 

Machine Learning Specializa0on 
18 
Comparing and contrasting 
Previously 
©2016 Emily Fox & Carlos Guestrin 
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 0.09 
processor 0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
Now 
Prior topic 
probabilities p(zi = k) = ⇡k
p(zi = k) = ⇡k
Likelihood 
under 
each topic 
… 
tf-idf vector 
compute likelihood of tf-idf 
vector under each Gaussian 
{modeling, complex, epilepsy, 
 modeling, Bayesian, clinical, 
 epilepsy, EEG, data, dynamic…}  
compute likelihood of the 
collection of words in doc 
under each topic distribution 

Machine Learning Specializa0on 
Latent Dirichlet allocation (LDA) 
©2016 Emily Fox & Carlos Guestrin 
19 

Machine Learning Specializa0on 
20 
LDA is a mixed 
membership model 
Want to discover a 
set of topics 
 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
0 
0.2 
0.4 
0.6 

Machine Learning Specializa0on 
21 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
Topic vocab 
distributions: 
… 
Clustering: 
One topic indicator 
zi per document i 
All words come from 
(get scored under) 
same topic zi 
 
Distribution on 
prevalence of  
topics in corpus 
π = [π1  π2 … πK] 

Machine Learning Specializa0on 
22 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
Same topic 
distributions: 
… 
In LDA: 
One topic indicator 
ziw per word in doc i 
Each word gets 
scored under its  
topic ziw 
 
Distribution on 
prevalence of  
topics in document 
πi = [πi1  πi2 … πiK] 

Machine Learning Specializa0on 
23 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
Topic vocab 
distributions: 
… 
Document topic 
proportions: 
πi = [πi1  πi2 … πiK] 
0 
0.2 
0.4 
0.6 

Machine Learning Specializa0on 
Inference in LDA models 
©2016 Emily Fox & Carlos Guestrin 
24 

Machine Learning Specializa0on 
25 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
Topic vocab 
distributions: 
… 
Document topic 
proportions: 
πi = [πi1  πi2 … πiK] 
0 
0.2 
0.4 
0.6 

Machine Learning Specializa0on 
26 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 2 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 3 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
Topic vocab 
distributions: 
… 
Document topic 
proportions: 
πi = [πi1  πi2 … πiK] 
0 
0.2 
0.4 
0.6 
? ? ? ? 

Machine Learning Specializa0on 
27 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 2 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 3 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
Topic vocab 
distributions: 
… 
Document topic 
proportions: 
πi = [πi1  πi2 … πiK] 
0 
0.2 
0.4 
0.6 
? ? ? ? 
LDA inputs: 
- Set of words per doc for each 
doc in corpus 
 
LDA outputs: 
- Corpus-wide topic vocab 
distributions 
- Topic assignments per word 
- Topic proportions per doc  

Machine Learning Specializa0on 
28 
Interpreting LDA outputs 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 

Machine Learning Specializa0on 
29 
Interpreting LDA outputs 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Examine coherence of 
learned topics 
-  What are top words per topic? 
-  Do they form meaningful 
groups? 
-  Use to post-facto label topics 
(e.g., science, tech, sports,…) 

Machine Learning Specializa0on 
30 
Interpreting LDA outputs 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Doc-speciﬁc topic 
proportions can be used to: 
-  Relate documents 
-  Study user topic preferences 
-  Assign docs to multiple 
categories 

Machine Learning Specializa0on 
31 
Interpreting LDA outputs 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Typically not interested 
in word assignments 

Machine Learning Specializa0on 
An inference algorithm for LDA: 
Gibbs sampling 
32 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
33 
Clustering algorithms so far 
©2016 Emily Fox & Carlos Guestrin 
Assign observations to  
closest cluster center 
 
 
Revise cluster centers 
zi  arg min
j
||µj −xi||2
2
µj  arg min
µ
X
i:zi=j
||µ −xi||2
2
k-means 
E-step: estimate cluster  
     responsibilities 
 
M-step: maximize likelihood  
 
 over parameters 
EM for MoG 
Iterative hard assignment 
to max objective 
Iterative soft assignment 
to max objective 

Machine Learning Specializa0on 
34 
What can we do for our bag-of-words models? 
Part 1: Clustering model 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
One topic indicator 
zi per document i 
All words come from 
(get scored under) 
same topic zi 
 
Distribution on 
prevalence of  
topics in corpus 
π = [π1  π2 … πK] 

Machine Learning Specializa0on 
35 
What can we do for our bag-of-words models? 
Part 1: Clustering model 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
SCIENCE 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TECH 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
SPORTS 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
Can derive  
EM algorithm: 
-  Gaussian likelihood of 
       tf-idf vector  
-   multinomial likelihood 
      of word counts  
  (mw successes of word w) 
-  Result: mixture of 
multinomial model 

Machine Learning Specializa0on 
36 
What can we do for our bag-of-words models? 
Part 2: LDA model 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Can derive  
EM algorithm,  
but not common 
(performs poorly) 

Machine Learning Specializa0on 
37 
Typical LDA implementations 
Normally LDA is speciﬁed as a Bayesian model 
(otherwise, “probabilistic latent semantic analysis/indexing”) 
- Account for uncertainty in parameters  
when making predictions 
- Naturally regularizes parameter estimates  
in contrast to MLE 
 
EM-like algorithms (e.g., “variational EM”), or… 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
Gibbs sampling for Bayesian inference 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
39 
Gibbs sampling 
Beneﬁts: 
•  Typically intuitive updates 
•  Very straightforward to implement 
©2016 Emily Fox & Carlos Guestrin 
Iterative random hard assignment! 

Machine Learning Specializa0on 
40 
Random sample #10000 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Current set of 
assignments 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible

Machine Learning Specializa0on 
41 
Random sample #10001 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.12 
test 
0.06 
hypothesize 0.042 
discover 
0.04 
climate 
0.011 
… 
… 
TOPIC 2 
develop 
0.16 
computer 
0.11 
user 
0.03 
processor 
0.029 
internet 
0.023 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
oﬀense 
0.02 
defense 
0.018 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Current set of 
assignments 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible

Machine Learning Specializa0on 
42 
Random sample #10002 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.10 
discover 
0.055 
hypothesize 0.043 
test 
0.042 
examine 
0.015 
… 
… 
TOPIC 2 
computer 
0.12 
develop 
0.115 
user 
0.031 
device 
0.022 
cloud 
0.018 
… 
… 
TOPIC 3 
player 
0.17 
score 
0.09 
game 
0.062 
team 
0.043 
win 
0.03 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Current set of 
assignments 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible

Machine Learning Specializa0on 
43 
What do we know about this process? 
©2016 Emily Fox & Carlos Guestrin 
iterations 
Joint model  
probability 
probability of observations given variables/parameters 
and probability of variables/parameters themselves 
Not an optimization algorithm  
Eventually 
provides 
“correct” 
Bayesian 
estimates… 

Machine Learning Specializa0on 
44 
What to do with sampling output? 
Predictions: 
1.  Make prediction for each snapshot of randomly 
assigned variables/parameters (full iteration) 
2.  Average predictions for ﬁnal result 
Parameter or assignment estimate: 
-  Look at snapshot of randomly assigned  
variables/parameters that maximizes  
“joint model probability” 
©2016 Emily Fox & Carlos Guestrin 
iterations 
Joint model  
probability 

Machine Learning Specializa0on 
Standard Gibbs sampling steps 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
46 
Gibbs sampling algorithm outline 
Assignment variables and model parameters  
treated similarly 
 
Iteratively draw variable/parameter from 
conditional distribution having ﬁxed: 
-  all other variables/parameters 
•  values randomly selected in previous rounds 
•  changes from iter to iter 
-  observations 
•  always the same values 
©2016 Emily Fox & Carlos Guestrin 
Iterative random hard assignment! 

Machine Learning Specializa0on 
47 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Current set of 
assignments 

Machine Learning Specializa0on 
48 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Step 1: Randomly 
reassign all ziw based on 
-  doc topic proportions 
-  topic vocab distributions 
Draw randomly from 
responsibility vector 
[riw1 riw2 … riwK] 

Machine Learning Specializa0on 
49 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
Step 2: Randomly 
reassign doc topic 
proportions based on 
assignments ziw in  
current doc 
0 
0.2 
0.4 
0.6 
? ? ? ? 

Machine Learning Specializa0on 
50 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
Step 3: Repeat for all docs 
0 
0.2 
0.4 
0.6 
? ? ? ? 

Machine Learning Specializa0on 
51 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
… 
Step 4: Randomly 
reassign topic vocab 
distributions based on 
assignments ziw in  
entire corpus 
0 
0.2 
0.4 
0.6 
TOPIC 1 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 2 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 
TOPIC 3 
Word 1 
? 
Word 2 
? 
Word 3 
? 
Word 4 
? 
Word 5 
? 
… 
… 

Machine Learning Specializa0on 
52 
Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Repeat Steps 1-4 until 
max iter reached 

Machine Learning Specializa0on 
Collapsed Gibbs sampling in LDA 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
54 
“Collapsed” Gibbs sampling for LDA 
Based on special structure of LDA model, can 
sample just indicator variables ziw  
- No need to sample other parameters 
•  corpus-wide topic vocab distributions 
•  per-doc topic proportions 
 
Often leads to much better performance 
because examining uncertainty in smaller space 
 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
55 
Collapsed Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Randomly reassign ziw 
based on current 
assignments zjv of all 
other words in document 
and corpus 
Never draw topic vocab 
distributions or doc topic 
proportions 

Machine Learning Specializa0on 
56 
Select a document 
©2016 Emily Fox & Carlos Guestrin 
epilepsy dynamic Bayesian 
EEG 
model 

Machine Learning Specializa0on 
Randomly assign topics 
©2016 Emily Fox & Carlos Guestrin 
3 
2 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
57 

Machine Learning Specializa0on 
Randomly assign topics 
58 
©2016 Emily Fox & Carlos Guestrin 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
2 
3 
2 
1 
1 
test 
temple 
ship 
trade 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
2 
3 
2 
1 
1 
model 
temple 
ship 
trade 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
3 
2 
1 
3 
1 
Etruscan 
trade 
price 
temple 
market 
2 
3 
2 
1 
1 
cross 
test 
validate 
likelihood 
data 
3 
2 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Repeat for 
each doc in 
the corpus 

Machine Learning Specializa0on 
Maintain local statistics 
59 
©2016 Emily Fox & Carlos Guestrin 
3 
2 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 Topic 2 Topic 3 
Doc i 

Machine Learning Specializa0on 
Maintain global statistics 
60 
©2016 Emily Fox & Carlos Guestrin 
Topic 1 
Topic 2 Topic 3 
epilepsy 
1 
0 
35 
Bayesian 
50 
0 
1 
model 
42 
1 
0 
EEG 
0 
0 
20 
dynamic 
10 
8 
1 
... 
Total  
counts  
from all 
docs 
3 
2 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 Topic 2 Topic 3 
Doc i 
2 
1 
2 

Machine Learning Specializa0on 
Randomly reassign topics 
61 
©2016 Emily Fox & Carlos Guestrin 
3 
2 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 Topic 3 
epilepsy 
1 
0 
35 
Bayesian 
50 
0 
1 
model 
42 
1 
0 
EEG 
0 
0 
20 
dynamic 
10 
8 
1 
... 
Topic 1 Topic 2 Topic 3 
Doc i 
2 
1 
2 

Machine Learning Specializa0on 
Probability of new assignment 
62 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 

Machine Learning Specializa0on 
Probability of new assignment 
63 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 
Topic 3 
Topic 1 Topic 2 Topic 3 
Doc i 
2 
0 
2 
How much doc “likes” 
each topic based on other 
assignments in doc 
# current assignments 
to topic k in doc i 
# words in doc i 
smoothing param 

Machine Learning Specializa0on 
Probability of new assignment 
64 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 Topic 2 Topic 3 
dynamic 
10 
7 
1 
How much each topic 
likes the word “dynamic” 
based on assignments in 
other docs in corpus 
smoothing param 
# assignments 
corpus-wide of 
word “dynamic” 
to topic k 
Topic 1 
Topic 2 
Topic 3 

Machine Learning Specializa0on 
Probability of new assignment 
65 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 Topic 2 Topic 3 
dynamic 
10 
7 
1 
Topic 2 also really likes “dynamic”, 
but in a diﬀerent context… 
e.g., a topic on ﬂuid dynamics 
Topic 1 
Topic 2 
Topic 3 

Machine Learning Specializa0on 
Probability of new assignment 
66 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic ﬁts word 
and document 
Topic ﬁts word, 
but not doc 
Topic ﬁts doc, 
but not word 
Topic 1 
Topic 2 
Topic 3 

Machine Learning Specializa0on 
Probability of new assignment 
67 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 
Topic 3 
How much 
topic likes word 
How much  
doc likes topic 

Machine Learning Specializa0on 
Randomly draw a new topic indicator 
68 
©2016 Emily Fox & Carlos Guestrin 
3 
? 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 
Topic 3 
How much 
topic likes word 
How much  
doc likes topic 
To draw new topic assignment (equivalently): 
-  roll K-sided die with these probabilities 
-  throw dart at these regions 
Normalize this product of 
terms over K possible topics! 

Machine Learning Specializa0on 
Update counts 
69 
©2016 Emily Fox & Carlos Guestrin 
3 
1 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 Topic 3 
epilepsy 
1 
0 
35 
Bayesian 
50 
0 
1 
model 
42 
1 
0 
EEG 
0 
0 
20 
dynamic 
10 
7 
1 
... 
Topic 1 Topic 2 Topic 3 
Doc i 
2 
0 
2 

Machine Learning Specializa0on 
Geometrically… 
70 
©2016 Emily Fox & Carlos Guestrin 
3 
1 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 
Topic 3 
Increase popularity of 
“dynamic” in topic 1 
(corpus-wide)  
Increase popularity of 
topic 1 in doc i 

Machine Learning Specializa0on 
Iterate through all words/docs 
71 
©2016 Emily Fox & Carlos Guestrin 
3 
1 
1 
3 
1 
epilepsy dynamic Bayesian 
EEG 
model 
Topic 1 
Topic 2 Topic 3 
epilepsy 
1 
0 
35 
Bayesian 
50 
0 
1 
model 
42 
1 
0 
EEG 
0 
0 
20 
dynamic 
10 
7 
1 
... 
Topic 1 Topic 2 Topic 3 
Doc i 
2 
0 
2 

Machine Learning Specializa0on 
Using samples from collapsed Gibbs 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
73 
What to do with the collapsed samples? 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
From “best” sample of {ziw}, 
can infer: 
1.  Topics from conditional 
distribution… 
need corpus-wide info 

Machine Learning Specializa0on 
74 
What to do with the collapsed samples? 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
From “best” sample of {ziw}, 
can infer: 
1.  Topics from conditional 
distribution… 
need corpus-wide info 

Machine Learning Specializa0on 
75 
What to do with the collapsed samples? 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
From “best” sample of {ziw}, 
can infer: 
1.  Topics from conditional 
distribution… 
need corpus-wide info 
2.  Document “embedding”… 
need doc info only 

Machine Learning Specializa0on 
76 
Embedding new documents 
©2016 Emily Fox & Carlos Guestrin 
TOPIC 1 
experiment 
0.1 
test 
0.08 
discover 
0.05 
hypothesize 0.03 
climate 
0.01 
… 
… 
TOPIC 2 
develop 
0.18 
computer 
0.09 
processor 
0.032 
user 
0.027 
internet 
0.02 
… 
… 
TOPIC 3 
player 
0.15 
score 
0.07 
team 
0.06 
goal 
0.03 
injury 
0.01 
… 
… 
… 
0 
0.2 
0.4 
0.6 
Modeling the Complex Dynamics and Changing
Correlations of Epileptic Events
Drausin F. Wulsina, Emily B. Foxc, Brian Litta,b
aDepartment of Bioengineering, University of Pennsylvania, Philadelphia, PA
bDepartment of Neurology, University of Pennsylvania, Philadelphia, PA
cDepartment of Statistics, University of Washington, Seattle, WA
Abstract
Patients with epilepsy can manifest short, sub-clinical epileptic “bursts” in
addition to full-blown clinical seizures. We believe the relationship between
these two classes of events—something not previously studied quantitatively—
could yield important insights into the nature and intrinsic dynamics of
seizures.
A goal of our work is to parse these complex epileptic events
into distinct dynamic regimes. A challenge posed by the intracranial EEG
(iEEG) data we study is the fact that the number and placement of electrodes
can vary between patients. We develop a Bayesian nonparametric Markov
switching process that allows for (i) shared dynamic regimes between a vari-
able number of channels, (ii) asynchronous regime-switching, and (iii) an
unknown dictionary of dynamic regimes. We encode a sparse and changing
set of dependencies between the channels using a Markov-switching Gaussian
graphical model for the innovations process driving the channel dynamics and
demonstrate the importance of this model in parsing and out-of-sample pre-
dictions of iEEG data. We show that our model produces intuitive state
assignments that can help automate clinical analysis of seizures and enable
the comparison of sub-clinical bursts and full clinical seizures.
Keywords:
Bayesian nonparametric, EEG, factorial hidden Markov model,
graphical model, time series
1. Introduction
Despite over three decades of research, we still have very little idea of
what deﬁnes a seizure. This ignorance stems both from the complexity of
epilepsy as a disease and a paucity of quantitative tools that are ﬂexible
Simple approach: 
1.  Fix topics based on 
training set collapsed 
sampling 
2.  Run uncollapsed 
sampler on  
new doc(s) only 

Machine Learning Specializa0on 
Summary for LDA 
and Gibbs sampling 
77 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
78 
What you can do now… 
•  Compare and contrast clustering and mixed 
membership models 
•  Describe a document clustering model for the bag-
of-words doc representation 
•  Interpret the components of the LDA mixed 
membership model 
•  Analyze a learned LDA model 
-  Topics in the corpus 
-  Topics per document 
•  Describe Gibbs sampling steps at a high level 
•  Utilize Gibbs sampling output to form predictions or 
estimate model parameters 
•  Implement collapsed Gibbs sampling for LDA 
©2016 Emily Fox & Carlos Guestrin 

Machine Learning Specializa0on 
79 
Acknowledgements 
Thanks to David Mimno 
(http://mimno.infosci.cornell.edu) 
for the collapsed LDA example outline 
©2016 Emily Fox & Carlos Guestrin 

