Mathematical Economics and Finance
Michael Harrison
Patrick Waldron
December 2, 1998

CONTENTS
i
Contents
List of Tables
iii
List of Figures
v
PREFACE
vii
What Is Economics?
. . . . . . . . . . . . . . . . . . . . . . . . . . .
vii
What Is Mathematics? . . . . . . . . . . . . . . . . . . . . . . . . . . . viii
NOTATION
ix
I
MATHEMATICS
1
1
LINEAR ALGEBRA
3
1.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
1.2
Systems of Linear Equations and Matrices . . . . . . . . . . . . .
3
1.3
Matrix Operations . . . . . . . . . . . . . . . . . . . . . . . . . .
7
1.4
Matrix Arithmetic . . . . . . . . . . . . . . . . . . . . . . . . . .
7
1.5
Vectors and Vector Spaces
. . . . . . . . . . . . . . . . . . . . .
11
1.6
Linear Independence . . . . . . . . . . . . . . . . . . . . . . . .
12
1.7
Bases and Dimension . . . . . . . . . . . . . . . . . . . . . . . .
12
1.8
Rank . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
13
1.9
Eigenvalues and Eigenvectors . . . . . . . . . . . . . . . . . . . .
14
1.10 Quadratic Forms
. . . . . . . . . . . . . . . . . . . . . . . . . .
15
1.11 Symmetric Matrices . . . . . . . . . . . . . . . . . . . . . . . . .
15
1.12 Deﬁnite Matrices . . . . . . . . . . . . . . . . . . . . . . . . . .
15
2
VECTOR CALCULUS
17
2.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.2
Basic Topology . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2.3
Vector-valued Functions and Functions of Several Variables
. . .
18
Revised: December 2, 1998

ii
CONTENTS
2.4
Partial and Total Derivatives
. . . . . . . . . . . . . . . . . . . .
20
2.5
The Chain Rule and Product Rule
. . . . . . . . . . . . . . . . .
21
2.6
The Implicit Function Theorem . . . . . . . . . . . . . . . . . . .
23
2.7
Directional Derivatives . . . . . . . . . . . . . . . . . . . . . . .
24
2.8
Taylor’s Theorem: Deterministic Version
. . . . . . . . . . . . .
25
2.9
The Fundamental Theorem of Calculus
. . . . . . . . . . . . . .
26
3
CONVEXITY AND OPTIMISATION
27
3.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
27
3.2
Convexity and Concavity . . . . . . . . . . . . . . . . . . . . . .
27
3.2.1
Deﬁnitions
. . . . . . . . . . . . . . . . . . . . . . . . .
27
3.2.2
Properties of concave functions
. . . . . . . . . . . . . .
29
3.2.3
Convexity and differentiability . . . . . . . . . . . . . . .
30
3.2.4
Variations on the convexity theme . . . . . . . . . . . . .
34
3.3
Unconstrained Optimisation
. . . . . . . . . . . . . . . . . . . .
39
3.4
Equality Constrained Optimisation:
The Lagrange Multiplier Theorems . . . . . . . . . . . . . . . . .
43
3.5
Inequality Constrained Optimisation:
The Kuhn-Tucker Theorems
. . . . . . . . . . . . . . . . . . . .
50
3.6
Duality
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
58
II
APPLICATIONS
61
4
CHOICE UNDER CERTAINTY
63
4.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
4.2
Deﬁnitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
63
4.3
Axioms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
66
4.4
Optimal Response Functions:
Marshallian and Hicksian Demand . . . . . . . . . . . . . . . . .
69
4.4.1
The consumer’s problem . . . . . . . . . . . . . . . . . .
69
4.4.2
The No Arbitrage Principle . . . . . . . . . . . . . . . . .
70
4.4.3
Other Properties of Marshallian demand . . . . . . . . . .
71
4.4.4
The dual problem . . . . . . . . . . . . . . . . . . . . . .
72
4.4.5
Properties of Hicksian demands . . . . . . . . . . . . . .
73
4.5
Envelope Functions:
Indirect Utility and Expenditure
. . . . . . . . . . . . . . . . . .
73
4.6
Further Results in Demand Theory . . . . . . . . . . . . . . . . .
75
4.7
General Equilibrium Theory
. . . . . . . . . . . . . . . . . . . .
78
4.7.1
Walras’ law . . . . . . . . . . . . . . . . . . . . . . . . .
78
4.7.2
Brouwer’s ﬁxed point theorem . . . . . . . . . . . . . . .
78
Revised: December 2, 1998

CONTENTS
iii
4.7.3
Existence of equilibrium . . . . . . . . . . . . . . . . . .
78
4.8
The Welfare Theorems . . . . . . . . . . . . . . . . . . . . . . .
78
4.8.1
The Edgeworth box . . . . . . . . . . . . . . . . . . . . .
78
4.8.2
Pareto efﬁciency
. . . . . . . . . . . . . . . . . . . . . .
78
4.8.3
The First Welfare Theorem . . . . . . . . . . . . . . . . .
79
4.8.4
The Separating Hyperplane Theorem
. . . . . . . . . . .
80
4.8.5
The Second Welfare Theorem . . . . . . . . . . . . . . .
80
4.8.6
Complete markets
. . . . . . . . . . . . . . . . . . . . .
82
4.8.7
Other characterizations of Pareto efﬁcient allocations . . .
82
4.9
Multi-period General Equilibrium
. . . . . . . . . . . . . . . . .
84
5
CHOICE UNDER UNCERTAINTY
85
5.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
5.2
Review of Basic Probability
. . . . . . . . . . . . . . . . . . . .
85
5.3
Taylor’s Theorem: Stochastic Version
. . . . . . . . . . . . . . .
88
5.4
Pricing State-Contingent Claims . . . . . . . . . . . . . . . . . .
88
5.4.1
Completion of markets using options
. . . . . . . . . . .
90
5.4.2
Restrictions on security values implied by allocational ef-
ﬁciency and covariance with aggregate consumption . . .
91
5.4.3
Completing markets with options on aggregate consumption 92
5.4.4
Replicating elementary claims with a butterﬂy spread . . .
93
5.5
The Expected Utility Paradigm . . . . . . . . . . . . . . . . . . .
93
5.5.1
Further axioms . . . . . . . . . . . . . . . . . . . . . . .
93
5.5.2
Existence of expected utility functions . . . . . . . . . . .
95
5.6
Jensen’s Inequality and Siegel’s Paradox . . . . . . . . . . . . . .
97
5.7
Risk Aversion . . . . . . . . . . . . . . . . . . . . . . . . . . . .
99
5.8
The Mean-Variance Paradigm
. . . . . . . . . . . . . . . . . . . 102
5.9
The Kelly Strategy
. . . . . . . . . . . . . . . . . . . . . . . . . 103
5.10 Alternative Non-Expected Utility Approaches . . . . . . . . . . . 104
6
PORTFOLIO THEORY
105
6.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105
6.2
Notation and preliminaries . . . . . . . . . . . . . . . . . . . . . 105
6.2.1
Measuring rates of return . . . . . . . . . . . . . . . . . . 105
6.2.2
Notation
. . . . . . . . . . . . . . . . . . . . . . . . . . 108
6.3
The Single-period Portfolio Choice Problem . . . . . . . . . . . . 110
6.3.1
The canonical portfolio problem . . . . . . . . . . . . . . 110
6.3.2
Risk aversion and portfolio composition . . . . . . . . . . 112
6.3.3
Mutual fund separation . . . . . . . . . . . . . . . . . . . 114
6.4
Mathematics of the Portfolio Frontier
. . . . . . . . . . . . . . . 116
Revised: December 2, 1998

iv
CONTENTS
6.4.1
The portfolio frontier in ℜN:
risky assets only
. . . . . . . . . . . . . . . . . . . . . . 116
6.4.2
The portfolio frontier in mean-variance space:
risky assets only
. . . . . . . . . . . . . . . . . . . . . . 124
6.4.3
The portfolio frontier in ℜN:
riskfree and risky assets
. . . . . . . . . . . . . . . . . . 129
6.4.4
The portfolio frontier in mean-variance space:
riskfree and risky assets
. . . . . . . . . . . . . . . . . . 129
6.5
Market Equilibrium and the CAPM
. . . . . . . . . . . . . . . . 130
6.5.1
Pricing assets and predicting security returns
. . . . . . . 130
6.5.2
Properties of the market portfolio
. . . . . . . . . . . . . 131
6.5.3
The zero-beta CAPM . . . . . . . . . . . . . . . . . . . . 131
6.5.4
The traditional CAPM . . . . . . . . . . . . . . . . . . . 132
7
INVESTMENT ANALYSIS
137
7.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137
7.2
Arbitrage and Pricing Derivative Securities
. . . . . . . . . . . . 137
7.2.1
The binomial option pricing model
. . . . . . . . . . . . 137
7.2.2
The Black-Scholes option pricing model . . . . . . . . . . 137
7.3
Multi-period Investment Problems . . . . . . . . . . . . . . . . . 140
7.4
Continuous Time Investment Problems . . . . . . . . . . . . . . . 140
Revised: December 2, 1998

LIST OF TABLES
v
List of Tables
3.1
Sign conditions for inequality constrained optimisation . . . . . .
51
5.1
Payoffs for Call Options on the Aggregate Consumption
. . . . .
92
6.1
The effect of an interest rate of 10% per annum at different fre-
quencies of compounding.
. . . . . . . . . . . . . . . . . . . . . 106
6.2
Notation for portfolio choice problem
. . . . . . . . . . . . . . . 108
Revised: December 2, 1998

vi
LIST OF TABLES
Revised: December 2, 1998

LIST OF FIGURES
vii
List of Figures
Revised: December 2, 1998

viii
LIST OF FIGURES
Revised: December 2, 1998

PREFACE
ix
PREFACE
This book is based on courses MA381 and EC3080, taught at Trinity College
Dublin since 1992.
Comments on content and presentation in the present draft are welcome for the
beneﬁt of future generations of students.
An electronic version of this book (in LATEX) is available on the World Wide
Web at http://pwaldron.bess.tcd.ie/teaching/ma381/notes/
although it may not always be the current version.
The book is not intended as a substitute for students’ own lecture notes. In particu-
lar, many examples and diagrams are omitted and some material may be presented
in a different sequence from year to year.
In recent years, mathematics graduates have been increasingly expected to have
additional skills in practical subjects such as economics and ﬁnance, while eco-
nomics graduates have been expected to have an increasingly strong grounding in
mathematics. The increasing need for those working in economics and ﬁnance to
have a strong grounding in mathematics has been highlighted by such layman’s
guides as ?, ?, ? (adapted from ?) and ?. In the light of these trends, the present
book is aimed at advanced undergraduate students of either mathematics or eco-
nomics who wish to branch out into the other subject.
The present version lacks supporting materials in Mathematica or Maple, such as
are provided with competing works like ?.
Before starting to work through this book, mathematics students should think
about the nature, subject matter and scientiﬁc methodology of economics while
economics students should think about the nature, subject matter and scientiﬁc
methodology of mathematics. The following sections brieﬂy address these ques-
tions from the perspective of the outsider.
What Is Economics?
This section will consist of a brief verbal introduction to economics for mathe-
maticians and an outline of the course.
Revised: December 2, 1998

x
PREFACE
What is economics?
1. Basic microeconomics is about the allocation of wealth or expenditure among
different physical goods. This gives us relative prices.
2. Basic ﬁnance is about the allocation of expenditure across two or more time
periods. This gives us the term structure of interest rates.
3. The next step is the allocation of expenditure across (a ﬁnite number or a
continuum of) states of nature. This gives us rates of return on risky assets,
which are random variables.
Then we can try to combine 2 and 3.
Finally we can try to combine 1 and 2 and 3.
Thus ﬁnance is just a subset of micoreconomics.
What do consumers do?
They maximise ‘utility’ given a budget constraint, based on prices and income.
What do ﬁrms do?
They maximise proﬁts, given technological constraints (and input and output prices).
Microeconomics is ultimately the theory of the determination of prices by the in-
teraction of all these decisions: all agents simultaneously maximise their objective
functions subject to market clearing conditions.
What is Mathematics?
This section will have all the stuff about logic and proof and so on moved into it.
Revised: December 2, 1998

NOTATION
xi
NOTATION
Throughout the book, x etc. will denote points of ℜn for n > 1 and x etc. will
denote points of ℜor of an arbitrary vector or metric space X. X will generally
denote a matrix.
Readers should be familiar with the symbols ∀and ∃and with the expressions
‘such that’ and ‘subject to’ and also with their meaning and use, in particular
with the importance of presenting the parts of a deﬁnition in the correct order
and with the process of proving a theorem by arguing from the assumptions to the
conclusions. Proof by contradiction and proof by contrapositive are also assumed.
There is a book on proofs by Solow which should be referred to here.1
ℜN
+ ≡
n
x ∈ℜN : xi ≥0, i = 1, . . . , N
o
is used to denote the non-negative or-
thant of ℜN, and ℜN
++ ≡
n
x ∈ℜN : xi > 0, i = 1, . . . , N
o
used to denote the
positive orthant.
⊤is the symbol which will be used to denote the transpose of a vector or a matrix.
1Insert appropriate discussion of all these topics here.
Revised: December 2, 1998

xii
NOTATION
Revised: December 2, 1998

1
Part I
MATHEMATICS
Revised: December 2, 1998


CHAPTER 1. LINEAR ALGEBRA
3
Chapter 1
LINEAR ALGEBRA
1.1
Introduction
[To be written.]
1.2
Systems of Linear Equations and Matrices
Why are we interested in solving simultaneous equations?
We often have to ﬁnd a point which satisﬁes more than one equation simultane-
ously, for example when ﬁnding equilibrium price and quantity given supply and
demand functions.
• To be an equilibrium, the point (Q, P) must lie on both the supply and
demand curves.
• Now both supply and demand curves can be plotted on the same diagram
and the point(s) of intersection will be the equilibrium (equilibria):
• solving for equilibrium price and quantity is just one of many examples of
the simultaneous equations problem
• The ISLM model is another example which we will soon consider at length.
• We will usually have many relationships between many economic variables
deﬁning equilibrium.
The ﬁrst approach to simultaneous equations is the equation counting approach:
Revised: December 2, 1998

4
1.2. SYSTEMS OF LINEAR EQUATIONS AND MATRICES
• a rough rule of thumb is that we need the same number of equations as
unknowns
• this is neither necessary nor sufﬁcient for existence of a unique solution,
e.g.
– fewer equations than unknowns, unique solution:
x2 + y2 = 0 ⇒x = 0, y = 0
– same number of equations and unknowns but no solution (dependent
equations):
x + y
=
1
x + y
=
2
– more equations than unknowns, unique solution:
x
=
y
x + y
=
2
x −2y + 1
=
0
⇒x = 1,
y = 1
Now consider the geometric representation of the simultaneous equation problem,
in both the generic and linear cases:
• two curves in the coordinate plane can intersect in 0, 1 or more points
• two surfaces in 3D coordinate space typically intersect in a curve
• three surfaces in 3D coordinate space can intersect in 0, 1 or more points
• a more precise theory is needed
There are three types of elementary row operations which can be performed on a
system of simultaneous equations without changing the solution(s):
1. Add or subtract a multiple of one equation to or from another equation
2. Multiply a particular equation by a non-zero constant
3. Interchange two equations
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
5
Note that each of these operations is reversible (invertible).
Our strategy, roughly equating to Gaussian elimination involves using elementary
row operations to perform the following steps:
1.
(a) Eliminate the ﬁrst variable from all except the ﬁrst equation
(b) Eliminate the second variable from all except the ﬁrst two equations
(c) Eliminate the third variable from all except the ﬁrst three equations
(d) &c.
2. We end up with only one variable in the last equation, which is easily solved.
3. Then we can substitute this solution in the second last equation and solve
for the second last variable, and so on.
4. Check your solution!!
Now, let us concentrate on simultaneous linear equations:
(2 × 2 EXAMPLE)
x + y
=
2
(1.2.1)
2y −x
=
7
(1.2.2)
• Draw a picture
• Use the Gaussian elimination method instead of the following
• Solve for x in terms of y
x
=
2 −y
x
=
2y −7
• Eliminate x
2 −y = 2y −7
• Find y
3y
=
9
y
=
3
• Find x from either equation:
x
=
2 −y = 2 −3 = −1
x
=
2y −7 = 6 −7 = −1
Revised: December 2, 1998

6
1.2. SYSTEMS OF LINEAR EQUATIONS AND MATRICES
SIMULTANEOUS LINEAR EQUATIONS (3 × 3 EXAMPLE)
• Consider the general 3D picture .. .
• Example:
x + 2y + 3z
=
6
(1.2.3)
4x + 5y + 6z
=
15
(1.2.4)
7x + 8y + 10z
=
25
(1.2.5)
• Solve one equation (1.2.3) for x in terms of y and z:
x = 6 −2y −3z
• Eliminate x from the other two equations:
4 (6 −2y −3z) + 5y + 6z
=
15
7 (6 −2y −3z) + 8y + 10z
=
25
• What remains is a 2 × 2 system:
−3y −6z
=
−9
−6y −11z
=
−17
• Solve each equation for y:
y
=
3 −2z
y
=
17
6 −11
6 z
• Eliminate y:
3 −2z = 17
6 −11
6 z
• Find z:
1
6
=
1
6z
z
=
1
• Hence y = 1 and x = 1.
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
7
1.3
Matrix Operations
We motivate the need for matrix algebra by using it as a shorthand for writing
systems of linear equations, such as those considered above.
• The steps taken to solve simultaneous linear equations involve only the co-
efﬁcients so we can use the following shorthand to represent the system of
equations used in our example:
This is called a matrix, i.e.— a rectangular array of numbers.
• We use the concept of the elementary matrix to summarise the elementary
row operations carried out in solving the original equations:
(Go through the whole solution step by step again.)
• Now the rules are
– Working column by column from left to right, change all the below
diagonal elements of the matrix to zeroes
– Working row by row from bottom to top, change the right of diagonal
elements to 0 and the diagonal elements to 1
– Read off the solution from the last column.
• Or we can reorder the steps to give the Gaussian elimination method:
column by column everywhere.
1.4
Matrix Arithmetic
• Two n × m matrices can be added and subtracted element by element.
• There are three notations for the general 3×3 system of simultaneous linear
equations:
1. ‘Scalar’ notation:
a11x1 + a12x2 + a13x3
=
b1
a21x1 + a22x2 + a23x3
=
b2
a31x1 + a32x2 + a33x3
=
b3
Revised: December 2, 1998

8
1.4. MATRIX ARITHMETIC
2. ‘Vector’ notation without factorisation:



a11x1 + a12x2 + a13x3
a21x1 + a22x2 + a23x3
a31x1 + a32x2 + a33x3


=



b1
b2
b3



3. ‘Vector’ notation with factorisation:



a11
a12
a13
a21
a22
a23
a31
a32
a33






x1
x2
x3


=



b1
b2
b3



It follows that:



a11
a12
a13
a21
a22
a23
a31
a32
a33






x1
x2
x3


=



a11x1 + a12x2 + a13x3
a21x1 + a22x2 + a23x3
a31x1 + a32x2 + a33x3



• From this we can deduce the general multiplication rules:
The ijth element of the matrix product AB is the product of the
ith row of A and the jth column of B.
A row and column can only be multiplied if they are the same
‘length.’
In that case, their product is the sum of the products of corre-
sponding elements.
Two matrices can only be multiplied if the number of columns
(i.e. the row lengths) in the ﬁrst equals the number of rows (i.e.
the column lengths) in the second.
• The scalar product of two vectors in ℜn is the matrix product of one written
as a row vector (1×n matrix) and the other written as a column vector (n×1
matrix).
• This is independent of which is written as a row and which is written as a
column.
So we have C = AB if and only if cij =
P k = 1naikbkj.
Note that multiplication is associative but not commutative.
Other binary matrix operations are addition and subtraction.
Addition is associative and commutative. Subtraction is neither.
Matrices can also be multiplied by scalars.
Both multiplications are distributive over addition.
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
9
We now move on to unary operations.
The additive and multiplicative identity matrices are respectively 0 and In ≡

δi
j

.
−A and A−1 are the corresponding inverse. Only non-singular matrices have
multiplicative inverses.
Finally, we can interpret matrices in terms of linear transformations.
• The product of an m × n matrix and an n × p matrix is an m × p matrix.
• The product of an m × n matrix and an n × 1 matrix (vector) is an m × 1
matrix (vector).
• So every m × n matrix, A, deﬁnes a function, known as a linear transfor-
mation,
TA : ℜn →ℜm : x 7→Ax,
which maps n−dimensional vectors to m−dimensional vectors.
• In particular, an n×n square matrix deﬁnes a linear transformation mapping
n−dimensional vectors to n−dimensional vectors.
• The system of n simultaneous linear equations in n unknowns
Ax = b
has a unique solution ∀b if and only if the corresponding linear transfor-
mation TA is an invertible or bijective function: A is then said to be an
invertible matrix.
A matrix has an inverse if and only the corresponding linear transformation is an
invertible function:
• Suppose Ax = b0 does not have a unique solution. Say it has two distinct
solutions, x1 and x2 (x1 ̸= x2):
Ax1
=
b0
Ax2
=
b0
This is the same thing as saying that the linear transformation TA is not
injective, as it maps both x1 and x2 to the same image.
• Then whenever x is a solution of Ax = b:
A (x + x1 −x2)
=
Ax + Ax1 −Ax2
=
b + b0 −b0
=
b,
so x + x1 −x2 is another, different, solution to Ax = b.
Revised: December 2, 1998

10
1.4. MATRIX ARITHMETIC
• So uniqueness of solution is determined by invertibility of the coefﬁcient
matrix A independent of the right hand side vector b.
• If A is not invertible, then there will be multiple solutions for some values
of b and no solutions for other values of b.
So far, we have seen two notations for solving a system of simultaneous linear
equations, both using elementary row operations.
1. We applied the method to scalar equations (in x, y and z).
2. We then applied it to the augmented matrix (A b) which was reduced to the
augmented matrix (I x).
Now we introduce a third notation.
3. Each step above (about six of them depending on how things simplify)
amounted to premultiplying the augmented matrix by an elementary ma-
trix, say
E6E5E4E3E2E1 (A b) = (I x) .
(1.4.1)
Picking out the ﬁrst 3 columns on each side:
E6E5E4E3E2E1A = I.
(1.4.2)
We deﬁne
A−1 ≡E6E5E4E3E2E1.
(1.4.3)
And we can use Gaussian elimination in turn to solve for each of the columns
of the inverse, or to solve for the whole thing at once.
Lots of properties of inverses are listed in MJH’s notes (p.A7?).
The transpose is A⊤, sometimes denoted A′ or At.
A matrix is symmetric if it is its own transpose; skewsymmetric if A⊤= −A.
Note that

A⊤−1 = (A−1)⊤.
Lots of strange things can happen in matrix arithmetic.
We can have AB = 0 even if A ̸= 0 and B ̸= 0.
Deﬁnition 1.4.1 orthogonal rows/columns
Deﬁnition 1.4.2 idempotent matrix A2 = A
Deﬁnition 1.4.3 orthogonal1 matrix A⊤= A−1.
Deﬁnition 1.4.4 partitioned matrices
Deﬁnition 1.4.5 determinants
Deﬁnition 1.4.6 diagonal, triangular and scalar matrices
1This is what ? calls something that it seems more natural to call an orthonormal matrix.
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
11
1.5
Vectors and Vector Spaces
Deﬁnition 1.5.1 A vector is just an n × 1 matrix.
The Cartesian product of n sets is just the set of ordered n-tuples where the ith
component of each n-tuple is an element of the ith set.
The ordered n-tuple (x1, x2, . . . , xn) is identiﬁed with the n × 1 column vector






x1
x2
...
xn





.
Look at pictures of points in ℜ2 and ℜ3 and think about extensions to ℜn.
Another geometric interpretation is to say that a vector is an entity which has both
magnitude and direction, while a scalar is a quantity that has magnitude only.
Deﬁnition 1.5.2 A real (or Euclidean) vector space is a set (of vectors) in which
addition and scalar multiplication (i.e. by real numbers) are deﬁned and satisfy
the following axioms:
1. copy axioms from simms 131 notes p.1
There are vector spaces over other ﬁelds, such as the complex numbers.
Other examples are function spaces, matrix spaces.
On some vector spaces, we also have the notion of a dot product or scalar product:
u.v ≡u⊤v
The Euclidean norm of u is
√u.u ≡∥u ∥.
A unit vector is deﬁned in the obvious way . . .unit norm.
The distance between two vectors is just ∥u −v ∥.
There are lots of interesting properties of the dot product (MJH’s theorem 2).
We can calculate the angle between two vectors using a geometric proof based on
the cosine rule.
∥v −u ∥2
=
(v −u) . (v −u)
(1.5.1)
=
∥v ∥2 + ∥u ∥2 −2v.u
(1.5.2)
=
∥v ∥2 + ∥u ∥2 −2 ∥v ∥∥u ∥cos θ
(1.5.3)
Two vectors are orthogonal if and only if the angle between them is zero.
Revised: December 2, 1998

12
1.6. LINEAR INDEPENDENCE
A subspace is a subset of a vector space which is closed under addition and scalar
multiplication.
For example, consider row space, column space, solution space, orthogonal com-
plement.
1.6
Linear Independence
Deﬁnition 1.6.1 The vectors x1, x2, x3, . . . , xr ∈ℜn are linearly independent if
and only if
r
X
i=1
αixi = 0 ⇒αi = 0∀i.
Otherwise, they are linearly dependent.
Give examples of each, plus the standard basis.
If r > n, then the vectors must be linearly dependent.
If the vectors are orthonormal, then they must be linearly independent.
1.7
Bases and Dimension
A basis for a vector space is a set of vectors which are linearly independent and
which span or generate the entire space.
Consider the standard bases in ℜ2 and ℜn.
Any two non-collinear vectors in ℜ2 form a basis.
A linearly independent spanning set is a basis for the subspace which it generates.
Proof of the next result requires stuff that has not yet been covered.
If a basis has n elements then any set of more than n elements is linearly dependent
and any set of less than n elements doesn’t span.
Or something like that.
Deﬁnition 1.7.1 The dimension of a vector space is the (unique) number of vec-
tors in a basis. The dimension of the vector space {0} is zero.
Deﬁnition 1.7.2 Orthogonal complement
Decomposition into subspace and its orthogonal complement.
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
13
1.8
Rank
Deﬁnition 1.8.1
The row space of an m × n matrix A is the vector subspace of ℜn generated by
the m rows of A.
The row rank of a matrix is the dimension of its row space.
The column space of an m × n matrix A is the vector subspace of ℜm generated
by the n columns of A.
The column rank of a matrix is the dimension of its column space.
Theorem 1.8.1 The row space and the column space of any matrix have the same
dimension.
Proof The idea of the proof is that performing elementary row operations on a
matrix does not change either the row rank or the column rank of the matrix.
Using a procedure similar to Gaussian elimination, every matrix can be reduced to
a matrix in reduced row echelon form (a partitioned matrix with an identity matrix
in the top left corner, anything in the top right corner, and zeroes in the bottom left
and bottom right corner).
By inspection, it is clear that the row rank and column rank of such a matrix are
equal to each other and to the dimension of the identity matrix in the top left
corner.
In fact, elementary row operations do not even change the row space of the matrix.
They clearly do change the column space of a matrix, but not the column rank as
we shall now see.
If A and B are row equivalent matrices, then the equations Ax = 0 and Bx = 0
have the same solution space.
If a subset of columns of A are linearly dependent, then the solution space does
contain a vector in which the corresponding entries are nonzero and all other en-
tries are zero.
Similarly, if a subset of columns of A are linearly independent, then the solution
space does not contain a vector in which the corresponding entries are nonzero
and all other entries are zero.
The ﬁrst result implies that the corresponding columns or B are also linearly de-
pendent.
The second result implies that the corresponding columns of B are also linearly
independent.
It follows that the dimension of the column space is the same for both matrices.
Q.E.D.
Revised: December 2, 1998

14
1.9. EIGENVALUES AND EIGENVECTORS
Deﬁnition 1.8.2 rank
Deﬁnition 1.8.3 solution space, null space or kernel
Theorem 1.8.2 dimension of row space + dimension of null space = number of
columns
The solution space of the system means the solution space of the homogenous
equation Ax = 0.
The non-homogenous equation Ax = b may or may not have solutions.
System is consistent iff rhs is in column space of A and there is a solution.
Such a solution is called a particular solution.
A general solution is obtained by adding to some particular solution a generic
element of the solution space.
Previously, solving a system of linear equations was something we only did with
non-singular square systems.
Now, we can solve any system by describing the solution space.
1.9
Eigenvalues and Eigenvectors
Deﬁnition 1.9.1 eigenvalues and eigenvectors and λ-eigenspaces
Compute eigenvalues using det (A −λI) = 0. So some matrices with real entries
can have complex eigenvalues.
Real symmetric matrix has real eigenvalues. Prove using complex conjugate ar-
gument.
Given an eigenvalue, the corresponding eigenvector is the solution to a singular
matrix equation, so one free parameter (at least).
Often it is useful to specify unit eigenvectors.
Eigenvectors of a real symmetric matrix corresponding to different eigenvalues
are orthogonal (orthonormal if we normalise them).
So we can diagonalize a symmetric matrix in the following sense:
If the columns of P are orthonormal eigenvectors of A, and λ is the matrix with
the corresponding eigenvalues along its leading diagonal, then AP = Pλ so
P−1AP = λ = P⊤AP as P is an orthogonal matrix.
In fact, all we need to be able to diagonalise in this way is for A to have n linearly
independent eigenvectors.
P−1AP and A are said to be similar matrices.
Two similar matrices share lots of properties: determinants and eigenvalues in
particular. Easy to show this.
But eigenvectors are different.
Revised: December 2, 1998

CHAPTER 1. LINEAR ALGEBRA
15
1.10
Quadratic Forms
A quadratic form is
1.11
Symmetric Matrices
Symmetric matrices have a number of special properties
1.12
Deﬁnite Matrices
Deﬁnition 1.12.1 An n × n square matrix A is said to be
positive deﬁnite
⇐⇒
x⊤Ax > 0 ∀x ∈ℜn, x ̸= 0
positive semi-deﬁnite
⇐⇒
x⊤Ax ≥0 ∀x ∈ℜn
negative deﬁnite
⇐⇒
x⊤Ax < 0 ∀x ∈ℜn, x ̸= 0
negative semi-deﬁnite
⇐⇒
x⊤Ax ≤0 ∀x ∈ℜn
Some texts may require that the matrix also be symmetric, but this is not essential
and sometimes looking at the deﬁniteness of non-symmetric matrices is relevant.
If P is an invertible n × n square matrix and A is any n × n square matrix, then
A is positive/negative (semi-)deﬁnite if and only if P−1AP is.
In particular, the deﬁniteness of a symmetric matrix can be determined by check-
ing the signs of its eigenvalues.
Other checks involve looking at the signs of the elements on the leading diagonal.
Deﬁnite matrices are non-singular and singular matrices can not be deﬁnite.
The commonest use of positive deﬁnite matrices is as the variance-covariance
matrices of random variables. Since
vij = Cov [˜ri, ˜rj] = Cov [˜rj, ˜ri]
(1.12.1)
and
w⊤Vw
=
N
X
i=1
N
X
j=1
wiwjCov [˜ri, ˜rj]
(1.12.2)
=
Cov


N
X
i=1
wi˜ri,
N
X
j=1
wj˜rj


(1.12.3)
=
Var[
N
X
i=1
wi˜ri] ≥0
(1.12.4)
a variance-covariance matrix must be real, symmetric and positive semi-deﬁnite.
Revised: December 2, 1998

16
1.12. DEFINITE MATRICES
In Theorem 3.2.4, it will be seen that the deﬁniteness of a matrix is also an essen-
tial idea in the theory of convex functions.
We will also need later the fact that the inverse of a positive (negative) deﬁnite
matrix (in particular, of a variance-covariance matrix) is positive (negative) deﬁ-
nite.
Semi-deﬁnite matrices which are not deﬁnite have a zero eigenvalue and therefore
are singular.
Revised: December 2, 1998

CHAPTER 2. VECTOR CALCULUS
17
Chapter 2
VECTOR CALCULUS
2.1
Introduction
[To be written.]
2.2
Basic Topology
The aim of this section is to provide sufﬁcient introduction to topology to motivate
the deﬁnitions of continuity of functions and correspondences in the next section,
but no more.
• A metric space is a non-empty set X equipped with a metric, i.e. a function
d : X × X →[0, ∞) such that
1. d(x, y) = 0 ⇐⇒x = y.
2. d(x, y) = d(y, x) ∀x, y ∈X.
3. The triangular inequality:
d(x, z) + d(z, y) ≥d(x, y) ∀x, y, z ∈X.
• An open ball is a subset of a metric space, X, of the form
Bϵ(x) = {y ∈X : d(y, x) < ϵ}.
• A subset A of a metric space is open
⇐⇒
∀x ∈A, ∃ϵ > 0 such that Bϵ(x) ⊆A.
Revised: December 2, 1998

18
2.3. VECTOR-VALUED FUNCTIONS AND FUNCTIONS OF SEVERAL
VARIABLES
• A is closed ⇐⇒X −A is open. (Note that many sets are neither open nor
closed.)
• A neighbourhood of x ∈X is an open set containing x.
Deﬁnition 2.2.1 Let X = ℜn. A ⊆X is compact ⇐⇒A is both closed and
bounded (i.e. ∃x, ϵ such that A ⊆Bϵ(x)).
We need to formally deﬁne the interior of a set before stating the separating theo-
rem:
Deﬁnition 2.2.2 If Z is a subset of a metric space X, then the interior of Z,
denoted int Z, is deﬁned by
z ∈int Z ⇐⇒Bϵ (z) ⊆Z for some ϵ > 0.
2.3
Vector-valued Functions and Functions of Sev-
eral Variables
Deﬁnition 2.3.1 A function (or map) f : X →Y from a domain X to a co-
domain Y is a rule which assigns to each element of X a unique element of Y .
Deﬁnition 2.3.2 A correspondence f : X →Y from a domain X to a co-domain
Y is a rule which assigns to each element of X a non-empty subset of Y .
Deﬁnition 2.3.3 The range of the function f : X →Y is the set f(X) = {f(x) ∈
Y : x ∈X}.
Deﬁnition 2.3.4 The function f : X →Y is injective (one-to-one)
⇐⇒
f(x) = f(x′) ⇒x = x′.
Deﬁnition 2.3.5 The function f : X →Y is surjective (onto)
⇐⇒
f(X) = Y
Deﬁnition 2.3.6 The function f : X →Y is bijective (or invertible)
⇐⇒
it is both injective and surjective.
Revised: December 2, 1998

CHAPTER 2. VECTOR CALCULUS
19
Note that if f: X →Y and A ⊆X and B ⊆Y , then
f (A) ≡{f (x) : x ∈A} ⊆Y
and
f −1 (B) ≡{x ∈X: f (x) ∈B} ⊆X.
Deﬁnition 2.3.7 A vector-valued function is a function whose co-domain is a sub-
set of a vector space, say ℜN. Such a function has N component functions.
Deﬁnition 2.3.8 A function of several variables is a function whose domain is a
subset of a vector space.
Deﬁnition 2.3.9 The function f: X →Y (X ⊆ℜn, Y ⊆ℜ) approaches the limit
y∗as x →x∗
⇐⇒
∀ϵ > 0, ∃δ > 0 s.t. ∥x −x∗∥< δ =⇒|f(x) −y∗)| < ϵ.
This is usually denoted
lim
x→x∗f(x) = y∗.
Deﬁnition 2.3.10 The function f: X →Y (X ⊆ℜn, Y ⊆ℜ) is continuous at x∗
⇐⇒
∀ϵ > 0, ∃δ > 0 s.t. ∥x −x∗∥< δ =⇒|f(x) −f(x∗)| < ϵ.
This deﬁnition just says that f is continuous provided that
lim
x→x∗f(x) = f(x∗).
? discusses various alternative but equivalent deﬁnitions of continuity.
Deﬁnition 2.3.11 The function f : X →Y is continuous
⇐⇒
it is continuous at every point of its domain.
We will say that a vector-valued function is continuous if and only if each of its
component functions is continuous.
The notion of continuity of a function described above is probably familiar from
earlier courses. Its extension to the notion of continuity of a correspondence,
however, while fundamental to consumer theory, general equilibrium theory and
much of microeconomics, is probably not. In particular, we will meet it again in
Theorem 3.5.4. The interested reader is referred to ? for further details.
Revised: December 2, 1998

20
2.4. PARTIAL AND TOTAL DERIVATIVES
Deﬁnition 2.3.12
1. The correspondence f: X →Y (X ⊆ℜn, Y ⊆ℜ) is
upper hemi-continuous (u.h.c.) at x∗
⇐⇒
for every open set N containing the set f(x∗), ∃δ > 0 s.t. ∥x −x∗∥<
δ =⇒f(x) ⊆N.
(Upper hemi-continuity basically means that the graph of the correspon-
dence is a closed and connected set.)
2. The correspondence f: X →Y (X ⊆ℜn, Y ⊆ℜ) is lower hemi-continuous
(l.h.c.) at x∗
⇐⇒
for every open set N intersecting the set f(x∗), ∃δ > 0 s.t. ∥x −x∗∥<
δ =⇒f(x) intersects N.
3. The correspondence f: X →Y (X ⊆ℜn, Y ⊆ℜ) is continuous (at x∗)
⇐⇒
it is both upper hemi-continuous and lower hemi-continuous (at x∗)
(There are a couple of pictures from ? to illustrate these deﬁnitions.)
2.4
Partial and Total Derivatives
Deﬁnition 2.4.1 The (total) derivative or Jacobean of a real-valued function of N
variables is the N-dimensional row vector of its partial derivatives. The Jacobean
of a vector-valued function with values in ℜM is an M × N matrix of partial
derivatives whose jth row is the Jacobean of the jth component function.
Deﬁnition 2.4.2 The gradient of a real-valued function is the transpose of its Ja-
cobean.
Deﬁnition 2.4.3 A function is said to be differentiable at x if all its partial deriva-
tives exist at x.
Deﬁnition 2.4.4 The function f : X →Y is differentiable
⇐⇒
it is differentiable at every point of its domain
Deﬁnition 2.4.5 The Hessian matrix of a real-valued function is the (usually sym-
metric) square matrix of its second order partial derivatives.
Revised: December 2, 1998

CHAPTER 2. VECTOR CALCULUS
21
Note that if f: ℜn →ℜ, then, strictly speaking, the second derivative (Hessian) of
f is the derivative of the vector-valued function
(f ′)⊤: ℜn →ℜn: x 7→(f ′ (x))⊤.
Students always need to be warned about the differences in notation between the
case of n = 1 and the case of n > 1. Statements and shorthands that make sense
in univariate calculus must be modiﬁed for multivariate calculus.
2.5
The Chain Rule and Product Rule
Theorem 2.5.1 (The Chain Rule) Let g: ℜn →ℜm and f: ℜm →ℜp be contin-
uously differentiable functions and let h: ℜn →ℜp be deﬁned by
h (x) ≡f (g (x)) .
Then
h′ (x)
| {z }
p×n
= f ′ (g (x))
|
{z
}
p×m
g′ (x)
| {z }
m×n
.
Proof This is easily shown using the Chain Rule for partial derivatives.
Q.E.D.
One of the most common applications of the Chain Rule is the following:
Let g: ℜn →ℜm and f: ℜm+n →ℜp be continuously differentiable functions, let
x ∈ℜn, and deﬁne h: ℜn →ℜp by:
h (x) ≡f (g (x) , x) .
The univariate Chain Rule can then be used to calculate ∂hi
∂xj (x) in terms of partial
derivatives of f and g for i = 1, . . . , p and j = 1, . . . , n:
∂hi
∂xj
(x) =
m
X
k=1
∂f i
∂xk
(g (x) , x) ∂gk
∂xj
(x) +
m+n
X
k=m+1
∂f i
∂xk
(g (x) , x) ∂xk
∂xj
(x) . (2.5.1)
Note that
∂xk
∂xj
(x) = δk
j ≡
 1
if k = j
0
otherwise ,
which is known as the Kronecker Delta. Thus all but one of the terms in the second
summation in (2.5.1) vanishes, giving:
∂hi
∂xj
(x) =
m
X
k=1
∂f i
∂xk
(g (x) , x) ∂gk
∂xj
(x) + ∂f i
∂xj
(g (x) , x) .
Revised: December 2, 1998

22
2.5. THE CHAIN RULE AND PRODUCT RULE
Stacking these scalar equations in matrix form and factoring yields:




∂h1
∂x1 (x)
. . .
∂h1
∂xn (x)
...
...
...
∂hp
∂x1 (x)
. . .
∂hp
∂xn (x)



=




∂f1
∂x1 (g (x) , x)
. . .
∂f1
∂xm (g (x) , x)
...
...
...
∂fp
∂x1 (g (x) , x)
. . .
∂fp
∂xm (g (x) , x)








∂g1
∂x1 (x)
. . .
∂g1
∂xn (x)
...
...
...
∂gm
∂x1 (x)
. . .
∂gm
∂xn (x)




+





∂f1
∂xm+1 (g (x) , x)
. . .
∂f1
∂xm+n (g (x) , x)
...
...
...
∂fp
∂xm+1 (g (x) , x)
. . .
∂fp
∂xm+n (g (x) , x)




.
(2.5.2)
Now, by partitioning the total derivative of f as
f ′ (·)
| {z }
p×(m+n)
=

Dgf (·)
|
{z
}
p×m
Dxf (·)
|
{z
}
p×n

,
(2.5.3)
we can use (2.5.2) to write out the total derivative h′ (x) as a product of partitioned
matrices:
h′ (x) = Dgf (g (x) , x) g′ (x) + Dxf (g (x) , x) .
(2.5.4)
Theorem 2.5.2 (Product Rule for Vector Calculus) The multivariate Product Rule
comes in two versions:
1. Let f, g: ℜm →ℜn and deﬁne h: ℜm →ℜby
h (x)
| {z }
1×1
≡(f (x))⊤
|
{z
}
1×n
g (x)
| {z }
n×1
.
Then
h′ (x)
| {z }
1×m
= (g (x))⊤
|
{z
}
1×n
f ′ (x)
| {z }
n×m
+ (f (x))⊤
|
{z
}
1×n
g′ (x)
| {z }
n×m
.
2. Let f: ℜm →ℜand g: ℜm →ℜn and deﬁne h: ℜm →ℜn by
h (x)
| {z }
n×1
≡f (x)
| {z }
1×1
g (x)
| {z }
n×1
.
Then
h′ (x)
| {z }
n×m
= g (x)
| {z }
n×1
f ′ (x)
| {z }
1×m
+ f (x)
| {z }
1×1
g′ (x)
| {z }
n×m
.
Proof This is easily shown using the Product Rule from univariate calculus to
calculate the relevant partial derivatives and then stacking the results in matrix
form.
Q.E.D.
Revised: December 2, 1998

CHAPTER 2. VECTOR CALCULUS
23
2.6
The Implicit Function Theorem
Theorem 2.6.1 (Implicit Function Theorem) Let g: ℜn →ℜm, where m < n.
Consider the system of m scalar equations in n variables, g (x∗) = 0m.
Partition the n-dimensional vector x as (y, z) where y = (x1, x2, . . . , xm) is m-
dimensional and z = (xm+1, xm+2, . . . , xn) is (n −m)-dimensional. Similarly,
partition the total derivative of g at x∗as
g′ (x∗)
=
[Dyg
Dzg]
(m × n)
(m × m)
(m × (n −m))
(2.6.1)
We aim to solve these equations for the ﬁrst m variables, y, which will then be
written as functions, h (z) of the last n −m variables, z.
Suppose g is continuously differentiable in a neighbourhood of x∗, and that the
m × m matrix:
Dyg ≡




∂g1
∂x1 (x∗)
. . .
∂g1
∂xm (x∗)
...
...
...
∂gm
∂x1 (x∗)
. . .
∂gm
∂xm (x∗)




formed by the ﬁrst m columns of the total derivative of g at x∗is non-singular.
Then ∃neighbourhoods Y of y∗and Z of z∗, and a continuously differentiable
function h: Z →Y such that
1. y∗= h (z∗),
2. g (h (z) , z) = 0
∀z ∈Z, and
3. h′ (z∗) = −(Dyg)−1 Dzg.
Proof The full proof of this theorem, like that of Brouwer’s Fixed Point Theorem
later, is beyond the scope of this course. However, part 3 follows easily from
material in Section 2.5. The aim is to derive an expression for the total derivative
h′ (z∗) in terms of the partial derivatives of g, using the Chain Rule.
We know from part 2 that
f (z) ≡g (h (z) , z) = 0m
∀z ∈Z.
Thus
f ′ (z) ≡0m×(n−m)
∀z ∈Z,
in particular at z∗. But we know from (2.5.4) that
f ′ (z) = Dygh′ (z) + Dzg.
Revised: December 2, 1998

24
2.7. DIRECTIONAL DERIVATIVES
Hence
Dygh′ (z) + Dzg = 0m×(n−m)
and, since the statement of the theorem requires that Dyg is invertible,
h′ (z∗) = −(Dyg)−1 Dzg,
as required.
Q.E.D.
To conclude this section, consider the following two examples:
1. the equation g (x, y) ≡x2 + y2 −1 = 0.
Note that g′ (x, y) = (2x 2y).
We have h(y) = √1 −y2 or h(y) = −√1 −y2, each of which describes a
single-valued, differentiable function on (−1, 1). At (x, y) = (0, 1), ∂g
∂x =
0 and h(y) is undeﬁned (for y > 1) or multi-valued (for y < 1) in any
neighbourhood of y = 1.
2. the system of linear equations g (x) ≡Bx = 0, where B is an m × n
matrix.
We have g′ (x) = B
∀x so the implicit function theorem applies provided
the equations are linearly independent.
2.7
Directional Derivatives
Deﬁnition 2.7.1 Let X be a vector space and x ̸= x′ ∈X. Then
1. for λ ∈ℜand particularly for λ ∈[0, 1], λx+(1 −λ) x′ is called a convex
combination of x and x′.
2. L = {λx + (1 −λ) x′ : λ ∈ℜ} is the line from x′, where λ = 0, to x,
where λ = 1, in X.
3. The restriction of the function f: X →ℜto the line L is the function
f|L: ℜ→ℜ: λ 7→f (λx + (1 −λ) x′) .
4. If f is a differentiable function, then the directional derivative of f at x′ in
the direction from x′ to x is f|′
L (0).
Revised: December 2, 1998

CHAPTER 2. VECTOR CALCULUS
25
• We will endeavour, wherever possible, to stick to the convention that x′
denotes the point at which the derivative is to be evaluated and x denotes
the point in the direction of which it is measured.1
• Note that, by the Chain Rule,
f|′
L (λ) = f ′ (λx + (1 −λ) x′) (x −x′)
(2.7.1)
and hence the directional derivative
f|′
L (0) = f ′ (x′) (x −x′) .
(2.7.2)
• The ith partial derivative of f at x is the directional derivative of f at x in
the direction from x to x + ei, where ei is the ith standard basis vector. In
other words, partial derivatives are a special case of directional derivatives
or directional derivatives a generalisation of partial derivatives.
• As an exercise, consider the interpretation of the directional derivatives at a
point in terms of the rescaling of the parameterisation of the line L.
• Note also that, returning to ﬁrst principles,
f|′
L (0) = lim
λ→0
f (x′ + λ (x −x′)) −f (x′)
λ
.
(2.7.3)
• Sometimes it is neater to write x −x′ ≡h. Using the Chain Rule, it is
easily shown that the second derivative of f|L is
f|′′
L(λ) = h⊤f ′′(x′ + λh)h
and
f|′′
L(0) = h⊤f ′′(x′)h.
2.8
Taylor’s Theorem: Deterministic Version
This should be ﬂeshed out following ?.
Readers are presumed to be familiar with single variable versions of Taylor’s The-
orem. In particular recall both the second order exact and inﬁnite versions.
An interesting example is to approximate the discount factor using powers of the
interest rate:
1
1 + i = 1 −i + i2 −i3 + i4 + . . .
(2.8.1)
1There may be some lapses in this version.
Revised: December 2, 1998

26
2.9. THE FUNDAMENTAL THEOREM OF CALCULUS
We will also use two multivariate versions of Taylor’s theorem which can be ob-
tained by applying the univariate versions to the restriction to a line of a function
of n variables.
Theorem 2.8.1 (Taylor’s Theorem) Let f : X →ℜbe twice differentiable,
X ⊆ℜn. Then for any x, x′ ∈X, ∃λ ∈(0, 1) such that
f(x) = f(x′) + f ′(x′)(x −x′) + 1
2(x −x′)⊤f ′′(x′ + λ(x −x′))(x −x′). (2.8.2)
Proof Let L be the line from x′ to x.
Then the univariate version tells us that there exists λ ∈(0, 1)2 such that
f|L(1) = f|L(0) + f|′
L(0) + 1
2f|′′
L(λ).
(2.8.3)
Making the appropriate substitutions gives the multivariate version in the theorem.
Q.E.D.
The (inﬁnite) Taylor series expansion does not necessarily converge at all, or to
f(x). Functions for which it does are called analytic. ? is an example of a function
which is not analytic.
2.9
The Fundamental Theorem of Calculus
This theorem sets out the precise rules for cancelling integration and differentia-
tion operations.
Theorem 2.9.1 (Fundamental Theorem of Calculus) The integration and dif-
ferentiation operators are inverses in the following senses:
1.
d
db
Z b
a f(x)dx = f(b)
2.
Z b
a f ′(x)dx = f(b) −f(a)
This can be illustrated graphically using a picture illustrating the use of integration
to compute the area under a curve.
2Should this not be the closed interval?
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
27
Chapter 3
CONVEXITY AND
OPTIMISATION
3.1
Introduction
[To be written.]
3.2
Convexity and Concavity
3.2.1
Deﬁnitions
Deﬁnition 3.2.1 A subset X of a vector space is a convex set
⇐⇒
∀x, x′ ∈X, λ ∈[0, 1], λx + (1 −λ)x′ ∈X.
Theorem 3.2.1 A sum of convex sets, such as
X + Y ≡{x + y : x ∈X, y ∈Y } ,
is also a convex set.
Proof The proof of this result is left as an exercise.
Q.E.D.
Deﬁnition 3.2.2 Let f : X →Y where X is a convex subset of a real vector
space and Y ⊆ℜ. Then
Revised: December 2, 1998

28
3.2. CONVEXITY AND CONCAVITY
1. f is a convex function
⇐⇒
∀x ̸= x′ ∈X, λ ∈(0, 1)
f (λx + (1 −λ)x′) ≤λf(x) + (1 −λ)f(x′).
(3.2.1)
(This just says that a function of several variables is convex if its restriction
to every line segment in its domain is a convex function of one variable in
the familiar sense.)
2. f is a concave function
⇐⇒
∀x ̸= x′ ∈X, λ ∈(0, 1)
f (λx + (1 −λ)x′) ≥λf(x) + (1 −λ)f(x′).
(3.2.2)
3. f is afﬁne
⇐⇒
f is both convex and concave.1
Note that the conditions (3.2.1) and (3.2.2) could also have been required to hold
(equivalently)
∀x, x′ ∈X, λ ∈[0, 1]
since they are satisﬁed as equalities ∀f when x = x′, when λ = 0 and when
λ = 1.
Note that f is convex ⇐⇒−f is concave.
Deﬁnition 3.2.3 Again let f : X →Y where X is a convex subset of a real vector
space and Y ⊆ℜ. Then
1. f is a strictly convex function
⇐⇒
∀x ̸= x′ ∈X, λ ∈(0, 1)
f (λx + (1 −λ)x′) < λf(x) + (1 −λ)f(x′).
1A linear function is an afﬁne function which also satisﬁes f(0) = 0.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
29
2. f is a strictly concave function
⇐⇒
∀x ̸= x′ ∈X, λ ∈(0, 1)
f (λx + (1 −λ)x′) > λf(x) + (1 −λ)f(x′).
Note that there is no longer any ﬂexibility as regards allowing x = x′ or λ = 0 or
λ = 1 in these deﬁnitions.
3.2.2
Properties of concave functions
Note the connection between convexity of a function of several variables and con-
vexity of the restrictions of that function to any line in its domain: the former is
convex if and only if all the latter are.
Note that a function on a multidimensional vector space, X, is convex if and only
if the restriction of the function to the line L is convex for every line L in X, and
similarly for concave, strictly convex, and strictly concave functions.
Since every convex function is the mirror image of a concave function, and vice
versa, every result derived for one has an obvious corollary for the other. In gen-
eral, we will consider only concave functions, and leave the derivation of the
corollaries for convex functions as exercises.
Let f : X →ℜand g : X →ℜbe concave functions. Then
1. If a, b > 0, then af + bg is concave.
2. If a < 0, then af is convex.
3. min{f, g} is concave
The proofs of the above properties are left as exercises.
Deﬁnition 3.2.4 Consider the real-valued function f: X →Y where Y ⊆ℜ.
1. The upper contour sets of f are the sets {x ∈X : f(x) ≥α} (α ∈ℜ).
2. The level sets or indifference curves of f are the sets {x ∈X : f(x) = α}
(α ∈ℜ).
3. The lower contour sets of f are the sets {x ∈X : f(x) ≤α} (α ∈ℜ).
In Deﬁnition 3.2.4, X does not have to be a (real) vector space.
Revised: December 2, 1998

30
3.2. CONVEXITY AND CONCAVITY
Theorem 3.2.2 The upper contour sets {x ∈X : f(x) ≥α} of a concave
function are convex.
Proof This proof is probably in a problem set somewhere.
Q.E.D.
Consider as an aside the two-good consumer problem. Note in particular the im-
plications of Theorem 3.2.2 for the shape of the indifference curves corresponding
to a concave utility function. Concave u is a sufﬁcient but not a necessary condi-
tion for convex upper contour sets.
3.2.3
Convexity and differentiability
In this section, we show that there are a total of three ways of characterising
concave functions, namely the deﬁnition above, a theorem in terms of the ﬁrst
derivative (Theorem 3.2.3) and a theorem in terms of the second derivative or
Hessian (Theorem 3.2.4).
Theorem 3.2.3 [Convexity criterion for differentiable functions.] Let f : X →ℜ
be differentiable, X ⊆ℜn an open, convex set. Then:
f is (strictly) concave
⇐⇒
∀x ̸= x′ ∈X,
f(x) ≤(<)f(x′) + f ′(x′)(x −x′).
(3.2.3)
Theorem 3.2.3 says that a function is concave if and only if the tangent hyperplane
at any point lies completely above the graph of the function, or that a function is
concave if and only if for any two distinct points in the domain, the directional
derivative at one point in the direction of the other exceeds the jump in the value
of the function between the two points. (See Section 2.7 for the deﬁnition of a
directional derivative.)
Proof (See ?.)
1. We ﬁrst prove that the weak version of inequality 3.2.3 is necessary for
concavity, and then that the strict version is necessary for strict concavity.
Choose x, x′ ∈X.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
31
(a) Suppose that f is concave.
Then, for λ ∈(0, 1),
f (x′ + λ(x −x′)) ≥f(x′) + λ (f(x) −f(x′)) .
(3.2.4)
Subtract f(x′) from both sides and divide by λ:
f (x′ + λ(x −x′)) −f(x′)
λ
≥f(x) −f(x′).
(3.2.5)
Now consider the limits of both sides of this inequality as λ →0.
The LHS tends to f ′ (x′) (x −x′) by deﬁnition of a directional deriva-
tive (see (2.7.2) and (2.7.3) above). The RHS is independent of λ and
does not change. The result now follows easily for concave functions.
However, 3.2.5 remains a weak inequality even if f is a strictly con-
cave function.
(b) Now suppose that f is strictly concave and x ̸= x′.
Since f is also concave, we can apply the result that we have just
proved to x′ and x′′ ≡1
2 (x + x′) to show that
f ′(x′)(x′′ −x′) ≥f(x′′) −f(x′).
(3.2.6)
Using the deﬁnition of strict concavity (or the strict version of inequal-
ity (3.2.4)) gives:
f(x′′) −f(x′) > 1
2 (f(x) −f(x′)) .
(3.2.7)
Combining these two inequalities and multiplying across by 2 gives
the desired result.
2. Conversely, suppose that the derivative satisﬁes inequality (3.2.3). We will
deal with concavity. To prove the theorem for strict concavity, just replace
all the weak inequalities (≥) with strict inequalities (>), as indicated.
Set x′ = λx+(1−λ)x′′. Then, applying the hypothesis of the proof in turn
to x and x′ and to x′′ and x′ yields:
f(x)
≤
f(x′) + f ′(x′)(x −x′)
(3.2.8)
and
f(x′′)
≤
f(x′) + f ′(x′)(x′′ −x′)
(3.2.9)
A convex combination of (3.2.8) and (3.2.9) gives:
λf(x) + (1 −λ)f(x′′)
Revised: December 2, 1998

32
3.2. CONVEXITY AND CONCAVITY
≤
f(x′) + f ′(x′) (λ ((x −x′)) + (1 −λ) ((x′′ −x′)))
=
f(x′),
(3.2.10)
since
λ ((x −x′)) + (1 −λ) ((x′′ −x′)) = λx + (1 −λ)x′′ −x′ = 0n. (3.2.11)
(3.2.10) is just the deﬁnition of concavity as required.
Q.E.D.
Theorem 3.2.4 [Concavity criterion for twice differentiable functions.] Let f :
X →ℜbe twice continuously differentiable (C2), X ⊆ℜn open and convex.
Then:
1. f is concave
⇐⇒
∀x ∈X, the Hessian matrix f ′′(x) is negative semideﬁnite.
2. f ′′(x) negative deﬁnite ∀x ∈X
⇒
f is strictly concave.
The fact that the condition in the second part of this theorem is sufﬁcient but not
necessary for concavity inspires the search for a counter-example, in other words
for a function which is strictly concave but has a second derivative which is only
negative semi-deﬁnite and not strictly negative deﬁnite. The standard counter-
example is given by f(x) = x2n for any integer n > 1.
Proof We ﬁrst use Taylor’s theorem to demonstrate the sufﬁciency of the condi-
tion on the Hessian matrices. Then we use the Fundamental Theorem of Calculus
(Theorem 2.9.1) and a proof by contrapositive to demonstrate the necessity of this
condition in the concave case for n = 1. Then we use this result and the Chain
Rule to demonstrate necessity for n > 1. Finally, we show how these arguments
can be modiﬁed to give an alternative proof of sufﬁciency for functions of one
variable.
1. Suppose ﬁrst that f ′′(x) is negative semi-deﬁnite ∀x ∈X. Recall Taylor’s
Theorem above (Theorem 2.8.1).
It follows that f(x) ≤f(x′) + f ′(x′)(x −x′). Theorem 3.2.3 shows that f
is then concave. A similar proof will work for negative deﬁnite Hessian and
strictly concave function.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
33
2. To demonstrate necessity, we must consider separately ﬁrst functions of a
single variable and then functions of several variables.
(a) First consider a function of a single variable. Instead of trying to show
that concavity of f implies a negative semi-deﬁnite (i.e. non-positive)
second derivative ∀x ∈X, we will prove the contrapositive. In other
words, we will show that if there is any point x∗∈X where the second
derivative is positive, then f is locally strictly convex around x∗and
so cannot be concave.
So suppose f ′′(x∗) > 0. Then, since f is twice continuously differ-
entiable, f ′′(x) > 0 for all x in some neighbourhood of x∗, say (a, b).
Then f ′ is an increasing function on (a, b). Consider two points in
(a, b), x < x′′ and let x′ = λx + (1 −λ)x′′ ∈X, where λ ∈(0, 1).
Using the fundamental theorem of calculus,
f(x′) −f(x)
=
Z x′
x
f ′(t)dt < f ′(x′)(x′ −x)
and
f(x′′) −f(x′)
=
Z x′′
x′
f ′(t)dt < f ′(x′)(x′′ −x′).
Rearranging each inequality gives:
f(x)
>
f(x′) + f ′(x′)(x −x′)
and
f(x′′)
>
f(x′) + f ′(x′)(x′′ −x′),
which are just the single variable versions of (3.2.8) and (3.2.9). As in
the proof of Theorem 3.2.3, a convex combination of these inequalities
reduces to
f(x′) < λf(x) + (1 −λ)f(x′′),
and hence f is locally strictly convex on (a, b).
(b) Now consider a function of several variables. Suppose that f is con-
cave and ﬁx x ∈X and h ∈ℜn. (We use an x, x+h argument instead
of an x, x′ argument to tie in with the deﬁnition of a negative deﬁnite
matrix.) Then, at least for sufﬁciently small λ, g(λ) ≡f(x + λh) also
deﬁnes a concave function (of one variable), namely the restriction of
f to the line segment from x in the direction from x to x + h. Thus,
using the result we have just proven for functions of one variable, g
has non-positive second derivative. But we know from p. 25 above
that g′′(0) = h⊤f ′′(x)h, so f ′′(x) is negative semi-deﬁnite.
Revised: December 2, 1998

34
3.2. CONVEXITY AND CONCAVITY
3. For functions of one variable, the above arguments can give an alternative
proof of sufﬁciency which does not require Taylor’s Theorem. In fact, we
have something like the following:
f ′′ (x) < 0 on (a, b)
⇒
f locally strictly concave on (a, b)
f ′′ (x) ≤0 on (a, b)
⇒
f locally concave on (a, b)
f ′′ (x) > 0 on (a, b)
⇒
f locally strictly convex on (a, b)
f ′′ (x) ≥0 on (a, b)
⇒
f locally convex on (a, b)
The same results which we have demonstrated for the interval (a, b) also
hold for the entire domain X (which of course is also just an open interval,
as it is an open convex subset of ℜ).
Q.E.D.
Theorem 3.2.5 A non-decreasing twice differentiable concave transformation of
a twice differentiable concave function (of several variables) is also concave.
Proof The details are left as an exercise.
Q.E.D.
Note ﬁnally the implied hierarchy among different classes of functions:
negative deﬁnite Hessian ⊂strictly concave ⊂concave = negative semideﬁnite
Hessian.
As an exercise, draw a Venn diagram to illustrate these relationships (and add
other classes of functions to it later on as they are introduced).
The second order condition above is reminiscent of that for optimisation and sug-
gests that concave or convex functions will prove useful in developing theories of
optimising behaviour. In fact, there is a wider class of useful functions, leading us
to now introduce further deﬁnitions.
3.2.4
Variations on the convexity theme
Let X ⊆ℜn be a convex set and f : X →ℜa real-valued function deﬁned on X.
In order (for reasons which shall become clear in due course) to maintain consis-
tency with earlier notation, we adopt the convention when labelling vectors x and
x′ that f(x′) ≤f(x).2
2There may again be some lapses in this version.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
35
Deﬁnition 3.2.5 Let
C(α) = {x ∈X : f(x) ≥α}.
Then f : X →ℜis quasiconcave
⇐⇒
∀α ∈ℜ, C(α) is a convex set.
Theorem 3.2.6 The following statements are equivalent to the deﬁnition of qua-
siconcavity:
1. ∀x ̸= x′ ∈X such that f(x′) ≤f(x) and ∀λ ∈(0, 1),
f (λx + (1 −λ)x′) ≥f(x′).
2. ∀x, x′ ∈X, λ ∈[0, 1], f (λx + (1 −λ)x′) ≥min{f(x), f(x′)}.
3. (If f is differentiable,) ∀x, x′ ∈X such that f(x) −f(x′) ≥0, f ′(x′)(x −
x′) ≥0.
Proof
1. We begin by showing the equivalence between the deﬁnition and
condition 1.3
(a) First suppose that the upper contour sets are convex. Let x and x′ ∈X
and let α = min{f(x), f(x′)}. Then x and x′ are in C(α). By the
hypothesis of convexity, for any λ ∈(0, 1), λx + (1 −λ)x′ ∈C(α).
The desired result now follows.
(b) Now suppose that condition 1 holds. To show that C(α) is a convex
set, we just take x and x′ ∈C(α) and investigate whether λx + (1 −
λ)x′ ∈C(α). But, by our previous result,
f (λx + (1 −λ)x′) ≥min{f(x), f(x′)} ≥α
where the ﬁnal inequality holds because x and x′ are in C(α).
2. It is almost trivial to show the equivalence of conditions 1 and 2.
(a) In the case where f(x) ≥f(x′) or f(x′) = min{f(x), f(x′)}, there
is nothing to prove. Otherwise, we can just reverse the labels x and x′.
The statement is true for x = x′ or λ = 0 or λ = 1 even if f is not
quasiconcave.
3This proof may need to be rearranged to reﬂect the choice of a different equivalent character-
isation to act as deﬁnition.
Revised: December 2, 1998

36
3.2. CONVEXITY AND CONCAVITY
(b) The proof of the converse is even more straightforward and is left as
an exercise.
3. Proving that condition 3 is equivalent to quasiconcavity for a differentiable
function (by proving that it is equivalent to conditions 1 and 2) is much the
trickiest part of the proof.
(a) Begin by supposing that f satisﬁes conditions 1 and 2. Proving that
condition 3 is necessary for quasiconcavity is the easier part of the
proof (and appears as an exercise on one of the problem sets). Pick
any λ ∈(0, 1) and, without loss of generality, x and x′ such that
f(x′) ≤f(x). By quasiconcavity,
f (λx + (1 −λ)x′) ≥f(x′).
(3.2.12)
Consider
f|L(λ) = f (λx + (1 −λ)x′) = f (x′ + λ(x −x′)) .
(3.2.13)
We want to show that the directional derivative
f|′
L(0) = f ′(x′)(x −x′) ≥0.
(3.2.14)
But
f|′
L(0) = lim
λ→0
f (x′ + λ(x −x′)) −f(x′)
λ
.
(3.2.15)
Since the right hand side is non-negative for small positive values of λ
(λ < 1), the derivative must be non-negative as required.
(b) Now the difﬁcult part — to prove that condition 3 is a sufﬁcient con-
dition for quasiconcavity.
Suppose the derivative satisﬁes the hypothesis of the theorem, but f is
not quasiconcave. In other words, ∃x, x′, λ∗such that
f (λ∗x + (1 −λ∗)x′) < min{f(x), f(x′)},
(3.2.16)
where without loss of generality f(x′) ≤f(x). The hypothesis of the
theorem applied ﬁrst to x and λ∗x + (1 −λ∗)x′ and then to x′ and
λ∗x + (1 −λ∗)x′ tells us that:
f ′ (λ∗x + (1 −λ∗)x′) (x −(λ∗x + (1 −λ∗)x′)) ≥0 (3.2.17)
f ′ (λ∗x + (1 −λ∗)x′) (x′ −(λ∗x′ + (1 −λ∗)x)) ≥0. (3.2.18)
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
37
Multiplying the ﬁrst inequality by (1 −λ∗) and the second by λ∗yields
a pair of inequalities which can only be satisﬁed simultaneously if:
f ′ (λ∗x + (1 −λ∗)x′) (x′ −x) = 0.
(3.2.19)
In other words, f|′
L(λ∗) = 0; we already know that f|L(λ∗) < f|L(0) ≤
f|L(1). We can apply the same argument to any point where the value
of f|L is less than f|L(0) to show that the corresponding part of the
graph of f|L has zero slope, or is ﬂat. But this is incompatible either
with continuity of f|L or with the existence of a point where f|L(λ∗)
is strictly less than f|L(0). So we have a contradiction as required.
Q.E.D.
In words, part 3 of Theorem 3.2.6 says that whenever a differentiable quasicon-
cave function has a higher value at x than at x′, or the same value at both points,
then the directional derivative of f at x′ in the direction of x is non-negative. It
might help to think about this by considering n = 1 and separating out the cases
x > x′ and x < x′.
Theorem 3.2.7 Let f : X →ℜbe quasiconcave and g : ℜ→ℜbe increasing.
Then g ◦f is a quasiconcave function.
Proof This follows easily from the previous result. The details are left as an
exercise.
Q.E.D.
Note the implications of Theorem 3.2.7 for utility theory. In particular, if pref-
erences can be represented by a quasiconcave utility function, then they can be
represented by a quasiconcave utility function only. This point will be considered
again in a later section of the course.
Deﬁnition 3.2.6 f : X →ℜis strictly quasiconcave
⇐⇒
∀x ̸= x′ ∈X such that f(x) ≥f(x′) and ∀λ ∈(0, 1), f (λx + (1 −λ)x′) >
f(x′).
Deﬁnition 3.2.7 f is (strictly) quasiconvex
⇐⇒
−f is (strictly) quasiconcave4
4EC3080 ended here for Hilary Term 1998.
Revised: December 2, 1998

38
3.2. CONVEXITY AND CONCAVITY
Deﬁnition 3.2.8 f is pseudoconcave
⇐⇒
f is differentiable and quasiconcave and
f(x) −f(x′) > 0
⇒
f ′(x′) (x −x′) > 0.
Note that the last deﬁnition modiﬁes slightly the condition in Theorem 3.2.6 which
is equivalent to quasiconcavity for a differentiable function.
Pseudoconcavity will crop up in the second order condition for equality con-
strained optimisation.
We conclude this section by looking at a couple of the functions of several vari-
ables which will crop repeatedly in applications in economics later on.
First, consider the interesting case of the afﬁne function
f: ℜn →ℜ: x 7→M −p⊤x,
where M ∈ℜand p ∈ℜn. This function is both concave and convex, but neither
strictly concave nor strictly convex. Furthermore,
f (λx + (1 −λ) x′)
=
λf(x) + (1 −λ)f(x′)
(3.2.20)
≥
min{f(x), f(x′)}
(3.2.21)
and
(−f) (λx + (1 −λ) x′)
=
λ(−f)(x) + (1 −λ)(−f)(x′)
(3.2.22)
≥
min{(−f)(x), (−f)(x′)},
(3.2.23)
so f is both quasiconcave and quasiconcave, but not strictly so in either case. f
is, however, pseudoconcave (and pseudoconvex) since
f(x) > f(x′)
⇐⇒
p⊤x < p⊤x′
(3.2.24)
⇐⇒
p⊤(x −x′) < 0
(3.2.25)
⇐⇒
−f ′(x′)(x −x′) < 0
(3.2.26)
⇐⇒
f ′(x′)(x −x′) > 0.
(3.2.27)
Finally, here are two graphs of Cobb-Douglas functions:5
5To see them you will have to have copied two .WMF ﬁles retaining their uppercase ﬁlenames
and put them in the appropriate directory,
C:/TCD/teaching/WWW/MA381/NOTES/!
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
39
Graph of z = x0.5y0.5
Graph of z = x−0.5y1.5
3.3
Unconstrained Optimisation
Deﬁnition 3.3.1 Let X ⊆ℜn, f : X →ℜ.
Then f has a (strict) global maximum at x∗⇐⇒∀x ∈X, x ̸= x∗, f(x) ≤(<
)f(x∗).
Also f has a (strict) local maximum at x∗
⇐⇒
∃ϵ > 0 such that ∀x ∈
Bϵ(x∗), x ̸= x∗, f(x) ≤(<)f(x∗).
Similarly for minima.
Theorem 3.3.1 A continuous real-valued function on a compact subset of ℜn at-
tains a global maximum and a global minimum.
Proof Not given here. See ?.
Q.E.D.
While this is a neat result for functions on compact domains, results in calculus
are generally for functions on open domains, since the limit of the ﬁrst difference
Revised: December 2, 1998

40
3.3. UNCONSTRAINED OPTIMISATION
of the function at x, say, makes no sense if the function and the ﬁrst difference are
not deﬁned in some open neighbourhood of x (some Bϵ(x)).
The remainder of this section and the next two sections are each centred around
three related theorems:
1. a theorem giving necessary or ﬁrst order conditions which must be satis-
ﬁed by the solution to an optimisation problem (Theorems 3.3.2, 3.4.1 and
3.5.1);
2. a theorem giving sufﬁcient or second order conditions under which a solu-
tion to the ﬁrst order conditions satisﬁes the original optimisation problem
(Theorems 3.3.3, 3.4.2 and 3.5.2); and
3. a theorem giving conditions under which a known solution to an optimisa-
tion problem is the unique solution (Theorems 3.3.4, 3.4.3 and 3.5.3).
The results are generally presented for maximisation problems. However, any
minimisation problem is easily turned into a maximisation problem by reversing
the sign of the function to be minimised and maximising the function thus ob-
tained.
Throughout the present section, we deal with the unconstrained optimisation prob-
lem
max
x∈X f (x)
(3.3.1)
where X ⊆ℜn and f : X →ℜis a real-valued function of several variables,
called the objective function of Problem (3.3.1.)
(It is conventional to use the letter λ both to parameterise convex combinations
and as a Lagrange multiplier. To avoid confusion, in this section we switch to the
letter α for the former usage.)
Theorem 3.3.2 Necessary (ﬁrst order) condition for unconstrained maxima and
minima.
Let X be open and f differentiable with a local maximum or minimum at x∗∈X.
Then f ′(x∗) = 0, or f has a stationary point at x∗.
Proof Without loss of generality, assume that the function has a local maximum
at x∗. Then ∃ϵ > 0 such that, whenever ∥h∥< ϵ,
f(x∗+ h) −f(x∗) ≤0.
It follows that, for 0 < h < ϵ,
f(x∗+ hei) −f(x∗)
h
≤0,
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
41
(where ei denotes the ith standard basis vector) and hence that
∂f
∂xi
(x∗) = lim
h→0
f(x∗+ hei) −f(x∗)
h
≤0.
(3.3.2)
Similarly, for 0 > h > −ϵ,
f(x∗+ hei) −f(x∗)
h
≥0,
and hence
∂f
∂xi
(x∗) = lim
h→0
f(x∗+ hei) −f(x∗)
h
≥0.
(3.3.3)
Combining (3.3.2) and (3.3.3) yields the desired result.
Q.E.D.
The ﬁrst order conditions are only useful for identifying optima in the interior
of the domain of the objective function: Theorem 3.3.2 applies only to functions
whose domain X is open. Other methods must be used to check for possible cor-
ner solutions or boundary solutions to optimisation problems where the objective
function is deﬁned on a domain that is not open.
Theorem 3.3.3 Sufﬁcient (second order) condition for unconstrained maxima and
minima.
Let X ⊆ℜn be open and let f : X →ℜbe a twice continuously differentiable
function with f ′(x∗) = 0 and f ′′(x∗) negative deﬁnite.
Then f has a strict local maximum at x∗.
Similarly for positive deﬁnite Hessians and local minima.
Proof Consider the second order Taylor expansion used previously in the proof
of Theorem 3.2.4: for any x ∈X, ∃s ∈(0, 1) such that
f(x) = f(x∗) + f ′(x∗)(x −x∗) + 1
2(x −x∗)⊤f ′′(x∗+ s(x −x∗))(x −x∗).
or, since the ﬁrst derivative vanishes at x∗,
f(x) = f(x∗) + 1
2(x −x∗)⊤f ′′(x∗+ s(x −x∗))(x −x∗).
Since f ′′ is continuous, f ′′(x∗+ s(x −x∗)) will also be negative deﬁnite for x
in some open neighbourhood of x∗. Hence, for x in this neighbourhood, f(x) <
f(x∗) and f has a strict local maximum at x∗.
Revised: December 2, 1998

42
3.3. UNCONSTRAINED OPTIMISATION
Q.E.D.
The weak form of this result does not hold. In other words, semi-deﬁniteness
of the Hessian matrix at x∗is not sufﬁcient to guarantee that f has any sort of
maximum at x∗. For example, if f(x) = x3, then the Hessian is negative semi-
deﬁnite at x = 0 but the function does not have a local maximum there (rather, it
has a point of inﬂexion).
Theorem 3.3.4 Uniqueness conditions for unconstrained maximisation.
If
1. x∗solves Problem (3.3.1) and
2. f is strictly quasiconcave (presupposing that X is a convex set),
then x∗is the unique (global) maximum.
Proof Suppose not, in other words that ∃x ̸= x∗such that f (x) = f (x∗).
Then, for any α ∈(0, 1),
f (αx + (1 −α) x∗) > min {f (x) , f (x∗)} = f (x∗) ,
so f does not have a maximum at either x or x∗.
This is a contradiction, so the maximum must be unique.
Q.E.D.
Theorem 3.3.5 Tempting, but not quite true, corollaries of Theorem 3.3.3 are:
• Every stationary point of a twice continuously differentiable strictly con-
cave function is a strict global maximum (and so there can be at most one
stationary point).
• Every stationary point of a twice continuously differentiable strictly convex
function is a strict global minimum.
Proof If the Hessian matrix is positive/negative deﬁnite everywhere, then the ar-
gument in the proof of Theorem 3.3.3 can be applied for x ∈X and not just for
x ∈Bϵ (x∗). If there are points at which the Hessian is merely semi-deﬁnite, then
the proof breaks down.
Q.E.D.
Note that many strictly concave and strictly convex functions will have no station-
ary points, for example
f: ℜ→ℜ: x 7→ex.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
43
3.4
Equality Constrained Optimisation:
The Lagrange Multiplier Theorems
Throughout this section, we deal with the equality constrained optimisation prob-
lem
maxx∈X f (x)
s.t.
g (x) = 0m
(3.4.1)
where X ⊆ℜn, f : X →ℜis a real-valued function of several variables, called
the objective function of Problem (3.4.1) and g : X →ℜm is a vector-valued
function of several variables, called the constraint function of Problem (3.4.1); or,
equivalently, gj: X →ℜare real-valued functions for j = 1, . . . , m. In other
words, there are m scalar constraints represented by a single vector constraint:




g1 (x)
...
gm (x)



=




0
...
0



.
We will introduce and motivate the Lagrange multiplier method which applies to
such constrained optimisation problems with equality constraints. We will assume
where appropriate that the objective function f and the m constraint functions
g1, . . . , gm are all once or twice continuously differentiable.
The entire discussion here is again presented in terms of maximisation, but can
equally be presented in terms of minimisation by reversing the sign of the objec-
tive function. Similarly, note that the signs of the constraint function(s) can be
reversed without altering the underlying problem. We will see, however, that this
also reverses the signs of the corresponding Lagrange multipliers. The signiﬁ-
cance of this effect will be seen from the formal results, which are presented here
in terms of the usual three theorems.
Before moving on to those formal results, we brieﬂy review the methodology for
solving constrained optimisation problems which should be familiar from intro-
ductory and intermediate economic analysis courses.
If x∗is a solution to Problem (3.4.1), then there exist Lagrange multipliers,6 λ ≡
(λ1, . . . , λm), such that
f ′ (x∗) + λ⊤g′ (x∗) = 0n.
Thus, to ﬁnd the constrained optimum, we proceed as if optimising the Lagrangean:
L (x, λ) ≡f (x∗) + λ⊤g (x∗) .
Note that
6As usual, a row of numbers separated by commas is used as shorthand for a column vector.
Revised: December 2, 1998

44
3.4. EQUALITY CONSTRAINED OPTIMISATION:
THE LAGRANGE MULTIPLIER THEOREMS
1. L = f whenever g = 0 and
2. g = 0 where L is optimised.
Roughly speaking, this is why the constrained optimum of f corresponds to the
optimum of L.
The Lagrange multiplier method involves the following four steps:
1. introduce the m Lagrange multipliers, λ ≡(λ1, . . . , λm).
2. Deﬁne the Lagrangean L: X × ℜm →ℜ, where
X × ℜm ≡{(x, λ) : x ∈X, λ ∈ℜm} ,
by
L (x, λ) ≡f (x) + λ ⊤g (x) .
3. Find the stationary points of the Lagrangean, i.e. set L′ (x, λ) = 0. Since
the Lagrangean is a function of n + m variables, this gives n + m ﬁrst order
conditions. The ﬁrst n are
f ′ (x) + λ⊤g′ (x) = 0
or
∂f
∂xi
(x) +
m
X
j=1
λj
∂gj
∂xi
(x) = 0
i = 1, . . . , n.
The last m are just the original constraints,
g (x) = 0
or
gj (x) = 0
j = 1, . . . , m.
4. Finally, the second order conditions must be checked.
As an example, consider maximisation of a utility function representing Cobb-
Douglas preferences subject to a budget constraint.
The ﬁrst n ﬁrst order or Lagrangean conditions say that the total derivative (or
gradient) of f at x is a linear combination of the total derivatives (or gradients) of
the constraint functions at x.
Consider a picture with n = 2 and m = 1.
Since the directional derivative along a tangent to a level set or indifference curve
is zero at the point of tangency, x, (the function is at a maximum or minimum
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
45
along the tangent) or f ′ (x) (x′ −x) = 0, the gradient vector, f ′ (x)⊤, must be
perpendicular to the direction of the tangent, x′ −x.
At the optimum, the level sets of f and g have a common tangent, so f ′ (x) and
g′ (x) are collinear, or f ′ (x) = −λg′ (x). It can also be seen with a little thought
that for the solution to be a local constrained maximum, λ must be positive if g is
quasiconcave and negative if g is quasiconvex (in either case, the constraint curve
is the boundary of a convex set).
We now consider the equality constrained optimisation problem in more depth.
Theorem 3.4.1 First order (necessary) conditions for optimisation with equality
constraints.
Consider problem (3.4.1) or the corresponding minimisation problem.
If
1. x∗solves this problem (which implies that g (x∗) = 0),
2. f and g are continuously differentiable, and
3. the m × n matrix
g′ (x∗) =




∂g1
∂x1 (x∗)
. . .
∂g1
∂xn (x∗)
...
...
...
∂gm
∂x1 (x∗)
. . .
∂gm
∂xn (x∗)




is of rank m (i.e. there are no redundant constraints, both in the sense that
there are fewer constraints than variables and in the sense that the con-
straints which are present are ‘independent’),
then ∃λ∗∈ℜm such that f ′ (x∗) + λ∗⊤g′ (x∗) = 0 (i.e. in ℜn, f ′ (x∗) is in the
m−dimensional subspace generated by the m vectors g1′ (x∗) , . . . , gm′ (x∗)).
Proof The idea is to solve g (x∗) = 0 for m variables as a function of the other
n −m and to substitute the solution into the objective function to give an uncon-
strained problem with n −m variables.
For this proof, we need Theorem 2.6.1 on p. 2.6.1 above, the Implicit Function
Theorem. Using this theorem, we must ﬁnd the m weights λ1, . . . , λm to prove
that f ′ (x∗) is a linear combination of g1′ (x∗) , . . . , gm′ (x∗).
Without loss of generality, we assume that the ﬁrst m columns of g′ (x∗) are lin-
early independent (if not, then we merely relabel the variables accordingly).
Now we can partition the vector x∗as (y∗, z∗) and, using the notation of the
Implicit Function Theorem, ﬁnd a neighbourhood Z of z∗and a function h deﬁned
on Z such that
g (h (z) , z) = 0
∀z ∈Z
Revised: December 2, 1998

46
3.4. EQUALITY CONSTRAINED OPTIMISATION:
THE LAGRANGE MULTIPLIER THEOREMS
and also
h′ (z∗) = −(Dyg)−1 Dzg.
Now deﬁne a new objective function F: Z →ℜby
F (z) ≡f (h (z) , z) .
Since x∗solves the constrained problem maxx∈X f (x) subject to g (x) = 0, it
follows that z∗solves the unconstrained problem maxz∈Z F (z). (This is easily
shown using a proof by contradiction argument.)
Hence, z∗satisﬁes the ﬁrst order conditions for unconstrained maximisation of F,
namely
F ′ (z∗) = 0.
Applying the Chain Rule in exactly the same way as in the proof of the Implicit
Function Theorem yields an equation which can be written in shorthand as:
Dyfh′ (z) + Dzf
=
0.
Substituting for h′ (z) gives:
Dyf (Dyg)−1 Dzg = Dzf.
We can also partition f ′ (x) as

Dyf (Dyg)−1 Dyg
Dzf

Substituting for the second sub-matrix yields:
f ′ (x)
=

Dyf (Dyg)−1 Dyg
Dyf (Dyg)−1 Dzg

=
Dyf (Dyg)−1 
Dyg
Dzg

=
−λ ⊤g′ (x)
where we deﬁne
λ ≡−Dyf (Dyg)−1 .
Q.E.D.
Theorem 3.4.2 Second order (sufﬁcient or concavity) conditions for maximisa-
tion with equality constraints.
If
1. f and g are differentiable,
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
47
2. f ′ (x∗) + λ∗⊤g′ (x∗) = 0 (i.e. the ﬁrst order conditions are satisﬁed at x∗),
3. λ∗
j ≥0 for j = 1, . . . , m,
4. f is pseudoconcave, and
5. gj is quasiconcave for j = 1, . . . , m,
then x∗solves the constrained maximisation problem.
It should be clear that non-positive Lagrange multipliers and quasiconvex con-
straint functions can take the place of non-negative Lagrange multipliers and qua-
siconcave Lagrange multipliers to give an alternative set of second order condi-
tions.
Proof Suppose that the second order conditions are satisﬁed, but that x∗is not a
constrained maximum. We will derive a contradiction.
Since x∗is not a maximum, ∃x ̸= x∗such that g (x) = 0 but f (x) > f (x∗).
By pseudoconcavity, f (x) −f (x∗) > 0 implies that f ′ (x∗) (x −x∗) > 0.
Since the constraints are satisﬁed at both x and x∗, we have g (x∗) = g (x) = 0.
By quasiconcavity of the constraint functions (see Theorem 3.2.6), gj (x)−gj (x∗) =
0 implies that gj′ (x∗) (x −x∗) ≥0.
By assumption, all the Lagrange multipliers are non-negative, so
f ′ (x∗) (x −x∗) + λ∗⊤g′ (x∗) (x −x∗) > 0.
Rearranging yields:
h
f ′ (x∗) + λ∗⊤g′ (x∗)
i
(x −x∗) > 0.
But the ﬁrst order condition guarantees that the LHS of this inequality is zero (not
positive), which is the required contradiction.
Q.E.D.
Theorem 3.4.3 Uniqueness condition for equality constrained maximisation.
If
1. x∗is a solution,
2. f is strictly quasiconcave, and
3. gj is an afﬁne function (i.e. both convex and concave) for j = 1, . . . , m,
then x∗is the unique (global) maximum.
Revised: December 2, 1998

48
3.4. EQUALITY CONSTRAINED OPTIMISATION:
THE LAGRANGE MULTIPLIER THEOREMS
Proof The uniqueness result is also proved by contradiction. Note that it does not
require any differentiability assumption.
• We ﬁrst show that the feasible set is convex.
Suppose x ̸= x∗are two distinct solutions.
Consider the convex combination of these two solutions xα ≡αx+(1 −α) x∗.
Since each gj is afﬁne and gj (x∗) = gj (x) = 0, we have
gj (xα) = αgj (x) + (1 −α) gj (x∗) = 0.
In other words, xα also satisﬁes the constraints.
• To complete the proof, we ﬁnd the required contradiction:
Since f is strictly quasiconcave and f (x∗) = f (x), it must be the case that
f (xα) > f (x∗).
Q.E.D.
The construction of the obvious corollaries for minimisation problems is left as
an exercise.
We conclude this section with
Theorem 3.4.4 (Envelope Theorem.) Consider the modiﬁed constrained optimi-
sation problem:
max
x
f (x, α)
subject to
g (x, α) = 0,
(3.4.2)
where x ∈ℜn, α∈ℜq, f: ℜn+q →ℜand g: ℜn+q →ℜm (i.e. as usual f is
the real-valued objective function and g is a vector of m real-valued constraint
functions, but either or both can depend on exogenous or control variables α as
well as on the endogenous or choice variables x).
Suppose that the standard conditions for application of the Lagrange multiplier
theorems are satisﬁed.
Let x∗(α) denote the optimal choice of x for given α (x∗: ℜq →ℜn is called the
optimal response function) and let M (α) denote the maximum value attainable
by f for given α (M: ℜq →ℜis called the envelope function).
Then the partial derivative of M with respect to αi is just the partial derivative
of the relevant Lagrangean, f + λ⊤g, with respect to αi, evaluated at the optimal
value of x. The dependence of the vector of Lagrange multipliers, λ, on the vector
α should be ignored in calculating the last-mentioned partial derivative.
Proof The Envelope Theorem can be proved in the following steps:
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
49
1. Write down the identity relating the functions M, f and x∗:
M (α) ≡f (x∗(α) , α)
2. Use (2.5.4) to derive an expression for the partial derivatives ∂M
∂αi of M in
terms of the partial derivatives of f and x∗:
M ′ (α) = Dxf (x∗(α) , α) x∗′ (α) + Dαf (x∗(α) , α) .
3. The ﬁrst order (necessary) conditions for constrained optimisation say that
Dxf (x∗(α) , α) = −λ⊤Dxg (x∗(α) , α)
and allow us to eliminate the ∂f
∂xi terms from this expression.
4. Apply (2.5.4) again to the identity g (x∗, α) = 0m to obtain
Dxg (x∗(α) , α) x∗′ (α) + Dαg (x∗(α) , α) = 0m×q.
Finally, use this result to eliminate the ∂g
∂xi terms from your new expression
for ∂M
∂αi .
Combining all these results gives:
M ′ (α) = Dαf (x∗(α) , α) + λ⊤Dαg (x∗(α) , α) ,
which is the required result.
Q.E.D.
In applications in economics, the most frequently encountered applications will
make sufﬁcient assumptions to guarantee that
1. x∗satisﬁes the ﬁrst order conditions with each λi ≥0;
2. the Hessian f ′′ (x∗) is a negative deﬁnite (n × n) matrix; and
3. g is a linear function,
so that x∗is the unique optimal solution to the equality constrained optimisation
problem.
Revised: December 2, 1998

50
3.5. INEQUALITY CONSTRAINED OPTIMISATION:
THE KUHN-TUCKER THEOREMS
3.5
Inequality Constrained Optimisation:
The Kuhn-Tucker Theorems
Throughout this section, we deal with the inequality constrained optimisation
problem
maxx∈X f (x)
s.t.
gi (x) ≥0,
i = 1, 2, . . . , m
(3.5.1)
where once again X ⊆ℜn, f : X →ℜis a real-valued function of several
variables, called the objective function of Problem (3.5.1) and g : X →ℜm
is a vector-valued function of several variables, called the constraint function of
Problem (3.5.1).
Before presenting the usual theorems formally, we need some graphical motiva-
tion concerning the interpretation of Lagrange multipliers.
Suppose that the constraint functions are given by
g (x, α) = α −h (x) .
(3.5.2)
The Lagrangean is
L (x, λ) = f (x) + λ⊤(α −h (x)) .
(3.5.3)
Thus, using the Envelope Theorem, it is easily seen that the rate of change of the
envelope function M (α) with respect to the ‘level’ of the ith underlying con-
straint function hi is:
∂M
∂αi
= ∂L
∂αi
= λi.
(3.5.4)
Thus
• when λi = 0, the envelope function is at its maximum, or the objective
function at its unconstrained maximum, and the constraint is not binding.
• when λi < 0, the envelope function is decreasing
• when λi > 0, the envelope function is increasing
Now consider how the nature of the inequality constraint change as αi increases
(as illustrated, assuming f quasiconcave as usual and hi quasiconvex or gi quasi-
concave, so that the relationship between αi and λi is negative)
hi (x) ≤αi
(3.5.5)
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
51
Derivative of
Lagrange
Constraint
Type of constraint
objective fn.
Multiplier
fn.
Binding/active
f ′ ≤0
λ ≥0
g = 0
Non-binding/inactive
f ′ = 0
λ = 0
g > 0
Table 3.1: Sign conditions for inequality constrained optimisation
(or gi (x, α) ≥0). For values of αi such that λi > 0, this constraint is strictly
binding. For values of αi such that λi = 0, this constraint is just binding. For
values of αi such that λi < 0, this constraint is non-binding.
Note that in this setup,
∂2M
∂α2
i
= ∂λi
∂αi
< 0,
(3.5.6)
so that the envelope function is strictly concave (up to the unconstrained optimum,
and constant beyond it).
Thus we will ﬁnd that part of the necessity conditions below is that the Lagrange
multipliers be non-negative.
(For equality constrained optimisation, the signs
were important only when dealing with second order conditions).
Consider also at this stage the ﬁrst order conditions for maximisation of a function
of one variable subject to a non-negativity constraint:
max
x
f(x) s.t. x ≥0.
They can be expressed as:
f ′(x∗)
≤
0
(3.5.7)
f ′(x∗)
=
0
if x > 0
(3.5.8)
The various sign conditions which we have looked at are summarised in Table 3.1.
Theorem 3.5.1 Necessary (ﬁrst order) conditions for optimisation with inequal-
ity constraints.
If
1. x∗solves Problem (3.5.1), with
gi (x∗) = 0, i = 1, 2, . . . , b
and
gi (x∗) > 0, i = b + 1, . . . , m
(in other words, the ﬁrst b constraints are binding (active) at x∗and the
last n −b are non-binding (inactive) at x∗, renumbering the constraints if
necessary to achieve this),
Revised: December 2, 1998

52
3.5. INEQUALITY CONSTRAINED OPTIMISATION:
THE KUHN-TUCKER THEOREMS
2. f and g are continuously differentiable, and
3. the b × n submatrix of g′ (x∗),





∂g1
∂x1 (x∗)
. . .
∂g1
∂xn (x∗)
...
...
...
∂gb
∂x1 (x∗)
. . .
∂gb
∂xn (x∗)




,
is of full rank b (i.e. there are no redundant binding constraints, both in
the sense that there are fewer binding constraints than variables and in the
sense that the constraints which are binding are ‘independent’),
then ∃λ ∈ℜm such that f ′ (x∗) + λ⊤g′ (x∗) = 0, with λi ≥0 for i = 1, 2, . . . , m
and gi(x∗) = 0 if λi > 0.
Proof The proof is similar to that of Theorem 3.4.1 for the equality constrained
case. It can be broken into seven steps.
1. Suppose x∗solves Problem (3.5.1).
We begin by restricting attention to a neighbourhood Bϵ (x∗) throughout
which the non-binding constraints remain non-binding, i.e.
gi (x) > 0 ∀x ∈Bϵ (x∗) , i = b + 1, . . ., m.
(3.5.9)
Such a neighbourhood exists since the constraint functions are continuous.
Since x∗solves Problem (3.5.1) by assumption, it also solves the following
problem:
maxx∈Bϵ(x∗) f (x)
s.t.
gi (x) ≥0,
i = 1, 2, . . . , b.
(3.5.10)
In other words, since the non-binding constraints are non-binding ∀x ∈
Bϵ (x∗) by construction, we can ignore them if we conﬁne our search for
a maximum to this neighbourhood. We will return to the non-binding con-
straints in the very last step of this proof, but until then g will be taken to
refer to the vector of b binding constraint functions only and λ to the vector
of b Kuhn-Tucker multipliers corresponding to these binding constraints.
2. We now introduce slack variables s ≡(s1, . . ., sb), one corresponding to
each binding constraint, and consider the following equality constrained
maximisation problem:
maxx∈Bϵ(x∗),s∈ℜb
+ f (x)
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
53
s.t.
G (x, s) = 0b
(3.5.11)
where Gi (x, s) ≡gi (x) −si, i = 1, 2, . . . , b.
Since x∗solves Problem (3.5.10) and all b constraints in that problem are
binding at x∗, it can be seen that (x∗, 0b) solves this new problem. For
consistency of notation, we deﬁne s∗≡0b.
3. We proceed with Problem (3.5.11) as in the Lagrange case. In other words,
we use the Implicit Function Theorem to solve the system of b equations in
n + b unknowns,
G (x, s) = 0b,
(3.5.12)
for the ﬁrst b variables in terms of the last n. To do this, we partition the
vector of choice and slack variables three ways:
(x, s) ≡(y, z, s)
(3.5.13)
where y ∈ℜb and z ∈ℜn−b, and correspondingly partition the matrix of
partial derivatives evaluated at the optimum:
G′ (y∗, z∗, s∗)
=
G′ (x∗, s∗)
(3.5.14)
=

DyG
Dz,sG

(3.5.15)
=

DyG
DzG
DsG

(3.5.16)
=

Dyg
Dzg
−Ib

.
(3.5.17)
The rank condition allows us to apply the Implicit Function Theorem and
to ﬁnd a function h : ℜn −→ℜb such that y = h (z, s) is a solution to
G (y, z, s) = 0 with
h′ (z∗, s∗) = −(Dyg)−1 Dz,sG.
(3.5.18)
(3.5.18) can in turn be partitioned to yield
Dzh = −(Dyg)−1 DzG = −(Dyg)−1 Dzg
(3.5.19)
and
Dsh = −(Dyg)−1 DsG = (Dyg)−1 Ib = (Dyg)−1 .
(3.5.20)
4. This solution can be substituted into the original objective function f to
create a new objective function F deﬁned by
F (z, s) ≡f (h (z, s) , z)
(3.5.21)
Revised: December 2, 1998

54
3.5. INEQUALITY CONSTRAINED OPTIMISATION:
THE KUHN-TUCKER THEOREMS
and another new maximisation problem where there are only (implicit) non-
negativity constraints:
maxz∈Bϵ(z∗),s∈ℜb
+ F (z, s)
(3.5.22)
It should be clear that z∗, 0b solves Problem (3.5.22). The ﬁrst order con-
ditions for Problem (3.5.22) are just that the partial derivatives of F with
respect to the remaining n −b choice variables equal zero (according to
the ﬁrst order conditions for unconstrained optimisation), while the partial
derivatives of F with respect to the b slack variables must be less than or
equal to zero.
5. The Kuhn-Tucker multipliers can now be found exactly as in the Lagrange
case. We know that
DzF = DyfDzh + DzfIn−b
=
0n−b.
Substituting for Dzh from (3.5.19) gives:
Dyf (Dyg)−1 Dzg = Dzf.
We can also partition f ′ (x) as

Dyf (Dyg)−1 Dyg
Dzf

Substituting for the second sub-matrix yields:
f ′ (x)
=

Dyf (Dyg)−1 Dyg
Dyf (Dyg)−1 Dzg

=
Dyf (Dyg)−1 
Dyg
Dzg

≡
−λ ⊤g′ (x)
where we deﬁne the Kuhn-Tucker multipliers corresponding to the binding
constraints, λ , by
λ ≡−Dyf (Dyg)−1 .
(3.5.23)
6. Next, we calculate the partial derivatives of F with respect to the slack
variables and show that they can be less than or equal to zero if and only
if the Kuhn-Tucker multipliers corresponding to the binding constraints are
greater than or equal to zero. This can be seen by differentiating both sides
of (3.5.21) with respect to s to obtain:
DsF
=
DyfDsh + Dzf0(n−b)×b
(3.5.24)
=
Dyf (Dyg)−1
(3.5.25)
=
−λ ,
(3.5.26)
where we have used (3.5.20) and (3.5.23).
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
55
7. Finally just set the Kuhn-Tucker multipliers corresponding to the non-binding
constraints equal to zero.
Q.E.D.
Theorem 3.5.2 Second order (sufﬁcient or concavity) conditions for optimisation
with inequality constraints.
If
1. f and g are differentiable,
2. ∃λ ∈ℜm such that f ′ (x∗)+λ⊤g′ (x∗) = 0, with λi ≥0 for i = 1, 2, . . . , m
and gi(x∗) = 0 if λi > 0 (i.e. the ﬁrst order conditions are satisﬁed at x∗),
3. f is pseudoconcave, and
4. gi (x∗) = 0, i = 1, 2, . . . , b; gi (x∗) > 0, i = b + 1, . . . , m and gj is qua-
siconcave for j = 1, . . . , b (i.e. the binding constraint functions are quasi-
concave),
then x∗solves the constrained maximisation problem.
Proof The proof just requires the ﬁrst order conditions to be reduced to
f ′ (x∗) +
b
X
i=1
λigi′ (x∗) = 0
(3.5.27)
from where it is virtually identical to that for the Lagrange case, and so it is left as
an exercise.
Q.E.D.
Theorem 3.5.3 Uniqueness condition for inequality constrained optimisation.
If
1. x∗is a solution,
2. f is strictly quasiconcave, and
3. gj is a quasiconcave function for j = 1, . . . , m,
then x∗is the unique (global) optimal solution.
Revised: December 2, 1998

56
3.5. INEQUALITY CONSTRAINED OPTIMISATION:
THE KUHN-TUCKER THEOREMS
Proof The proof is again similar to that for the Lagrange case and is left as an ex-
ercise. The point to note this time is that the feasible set with equality constraints
was convex if the constraint functions were afﬁne, whereas the feasible set with
inequality constraints is convex if the constraint functions are quasiconcave. This
is because the feasible set (where all the inequality constraints are satisﬁed simul-
taneously) is the intersection of m upper contour sets of quasiconcave functions,
or the intersection of m convex sets.
Q.E.D.
The last important result on optimisation, the Theorem of the Maximum, is closely
related to the Envelope Theorem. Before proceeding to the statement of the theo-
rem, the reader may want to review Deﬁnition 2.3.12.
Theorem 3.5.4 (Theorem of the maximum) Consider the modiﬁed inequality con-
strained optimisation problem:
max
x
f (x, α)
subject to
gi (x, α) ≥0, i = 1, . . . , m
(3.5.28)
where x ∈ℜn, α∈ℜq, f: ℜn+q →ℜand g: ℜn+q →ℜm.
Let x∗(α) denote the optimal choice of x for given α (x∗: ℜq →ℜn) and let
M (α) denote the maximum value attainable by f for given α (M: ℜq →ℜ).
If
1. f is continuous;
2. the range of f is closed and bounded; and
3. the constraint set is a non-empty, compact-valued, continuous correspon-
dence of α,
then
1. M is a continuous (single-valued) function; and
2. x∗is an upper hemi-continuous correspondence, and hence is continuous if
it is a continuous (single-valued) function.
Proof The proof of this theorem is omitted, along with some of the more technical
material on continuity of (multi-valued) correspondences.
Q.E.D.
Theorem 3.5.4 will be used in consumer theory to prove such critical results as
the continuity of demand functions derived from the maximisation of continuous
utility functions.
The following are two frequently encountered examples illustrating the use of the
Kuhn-Tucker theorems in economics.7
7The calculations should be left as exercises.
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
57
1. The canonical quadratic programming problem.
Find the vector x ∈ℜn which maximises the value of the quadratic form
x⊤Ax subject to the m linear inequality constraints gi⊤x ≥αi, where
A ∈ℜn×n is negative deﬁnite and gi ∈ℜn for i = 1, . . . , m.
The objective function can always be rewritten as a quadratic form in a
symmetric (negative deﬁnite) matrixl, since as x⊤Ax is a scalar,
x⊤Ax
=

x⊤Ax
⊤
(3.5.29)
=
x⊤A⊤x
(3.5.30)
=
1
2

x⊤Ax + x⊤A⊤x

(3.5.31)
=
x⊤
1
2

A + A⊤
x
(3.5.32)
and 1
2

A + A⊤
is always symmetric.
Let G be the m × n matrix whose ith row is gi. G must have full rank if
we are to apply the Kuhn-Tucker conditions.
The Lagrangean is:
x⊤Ax + λ⊤(Gx −α) .
(3.5.33)
The ﬁrst order conditions are:
2x⊤A + λ⊤G = 0n
(3.5.34)
or, transposing and multiplying across by 1
2A−1:
x = −1
2A−1G⊤λ.
(3.5.35)
If the constraints are binding, then we will have:
α = −1
2GA−1G⊤λ.
(3.5.36)
Now we need the fact that G (and hence GA−1G⊤) has full rank to solve
for the Lagrange multipliers λ:
λ = −2

GA−1G⊤−1 α.
(3.5.37)
Now the sign conditions tell us that each component of λ must be non-
negative. An easy ﬁx is to let the Kuhn-Tucker multipliers be deﬁned by:
λ∗≡max

0m, −2

GA−1G⊤−1 α

,
(3.5.38)
Revised: December 2, 1998

58
3.6. DUALITY
where the max operator denotes component-by-component maximisation.
The effect of this is to knock out the non-binding constraints (those with
negative Lagrange multipliers) from the original problem and the subse-
quent analysis.
We can now ﬁnd the optimal x by substituting for λ in (3.5.35) the value of
λ∗from (3.5.38).
In the case in which all the constraints are binding, the solution is:
x = A−1G⊤
GA−1G⊤−1 α
(3.5.39)
and the envelope function is given by:
x⊤Ax
=
α⊤
GA−1G⊤−1 GA−1AA−1G⊤
GA−1G⊤−1 α
=
α⊤
GA−1G⊤−1 α
=
−1
2α⊤λ.
(3.5.40)
The applications of this problem will include ordinary least squares and
generalised least squares regression and the mean-variance portfolio choice
problem in ﬁnance.
2. Maximising a Cobb-Douglas utility function subject to a budget constraint
and non-negativity constraints.
The applications of this problem will include choice under certainty, choice
under uncertainty with log utility where the parameters are reinterpreted as
probabilities, the extension to Stone-Geary preferences, and intertemporal
choice with log utility, where the parameters are reinterpreted as time dis-
count factors.
Further exercises consider the duals of each of the forgoing problems, and it is to
the question of duality that we will turn in the next section.
3.6
Duality
Let X ⊆ℜn and let f, g : X 7→ℜbe, respectively, pseudoconcave and pseudo-
convex functions. Consider the envelope functions deﬁned by the dual families of
problems:
M (α) ≡max
x
f (x) s.t. g (x) ≤α
(3.6.1)
Revised: December 2, 1998

CHAPTER 3. CONVEXITY AND OPTIMISATION
59
and
N (β) ≡min
x g (x) s.t. f (x) ≥β.
(3.6.2)
Suppose that these problems have solutions, say x∗(α) and x† (β) respectively,
and that the constraints bind at these points.
The ﬁrst order conditions for the two problems are respectively:
f ′ (x) −λg′ (x) = 0
(3.6.3)
and
g′ (x) + µf ′ (x) = 0,
(3.6.4)
where λ and µ are the relevant Lagrange multipliers.
Thus if x and λ∗̸= 0 solve (3.6.3), then x and µ∗≡−1/λ solve (3.6.4). However,
for the x which solves the original problem (3.6.1) to also solve (3.6.2), it must
also satisfy the constraint, or f (x) = β. But we know that f (x) = M (α) . This
allows us to conclude that:
x∗(α) = x† (M (α)) .
(3.6.5)
Similarly,
x† (β) = x∗(N (β)) .
(3.6.6)
Combining these equations leads to the conclusion that
α = N (M (α))
(3.6.7)
and
β = M (N (β)) .
(3.6.8)
In other words, the envelope functions for the two dual problems are inverse func-
tions (over any range where the Lagrange multipliers are non-zero, i.e. where the
constraints are binding). Thus, either α or β or indeed λ or µ can be used to
parameterise either family of problems.
We will see many examples of these principles in the applications in the next part
of the book. In particular, duality will be covered further in the context of its
applications to consumer theory in Section 4.6.
Revised: December 2, 1998

60
3.6. DUALITY
Revised: December 2, 1998

61
Part II
APPLICATIONS
Revised: December 2, 1998


CHAPTER 4. CHOICE UNDER CERTAINTY
63
Chapter 4
CHOICE UNDER CERTAINTY
4.1
Introduction
[To be written.]
4.2
Deﬁnitions
There are two possible types of economy which we could analyse:
• a pure exchange economy, in which households are endowed directly with
goods, but there are no ﬁrms, there is no production, and economic activity
consists solely of pure exchanges of an initial aggregate endowment; and
• a production economy, in which households are further indirectly endowed
with, and can trade, shares in the proﬁt or loss of ﬁrms, which can use part
of the initial aggregate endowment as inputs to production processes whose
outputs are also available for trade and consumption.
Economies of these types comprise:
• H households or consumers or agents or (later) investors or, merely, indi-
viduals, indexed by the subscript1 h;
• N goods or commodities, indexed by the superscript n; and
• (in the case of a production economy only) F ﬁrms, indexed by f.
1Notation in what follows is probably far from consistent in regard to superscripts and sub-
scripts and in regard to ith or nth good and needs ﬁxing.
Revised: December 2, 1998

64
4.2. DEFINITIONS
This chapter concentrates on the theory of optimal consumer choice and of equi-
librium in a pure exchange economy. The theory of optimal production decisions
and of equilibrium in an economy with production is mathematically similar.
Goods can be distinguished from each other in many ways:
• obviously, by intrinsic physical characteristics, e.g. apples or oranges.
• by the time at which they are consumed, e.g. an Easter egg delivered before
Easter Sunday or an Easter egg delivered after Easter Sunday. (While all
trading takes place simultaneously in the model, consumption can be spread
out over many periods.)
• by the state of the world in which they are consumed, e.g. the service pro-
vided by an umbrella on a wet day or the service which it provides on a dry
day. (Typically, the state of the world can be any point ω in a sample space
Ω.)
The important characteristics of household h are that it is faced with the choice of
a consumption vector or consumption plan or consumption bundle, xh =

x1
h, . . . , xN
h

,
from a (closed, convex) consumption set, Xh. Typically, Xh = ℜN
+. More gener-
ally, consumer h’s consumption set might require a certain subsistence consump-
tion of some commodities, such as water, and rule out points of ℜN
+ not meeting
this requirement. The household’s endowments are denoted eh ∈ℜN
+ and can be
traded.
In a production economy, the shareholdings of households in ﬁrms are denoted
ch ∈ℜF,
A consumer’s net demand is denoted zh ≡xh −eh ∈ℜN.
Each consumer is assumed to have a preference relation or (weak) preference
ordering which is a binary relation on the consumption set Xh (?, Chapter 7).
Since each household will have different preferences, we should really denote
household h’s preference relation ⪰h, but the subscript will be omitted for the
time being while we consider a single household. Similarly, we will assume for
the time being that each household chooses from the same consumption set, X,
although this is not essential.
Recall (see ?) that a binary relation R on X is just a subset R of X × X or a
collection of pairs (x, y) where x ∈X and y ∈X.
If (x, y) ∈R, we usually just write xRy.
Thus x ⪰y means that either x is preferred to y or the consumer is indifferent
between the two (i.e. that x is at least as good as y).
The following properties of a general relation R on a general set X are often of
interest:
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
65
1. A relation R is reﬂexive
⇐⇒
xRx ∀x ∈X
2. A relation R is symmetric
⇐⇒
xRy ⇒yRx
3. A relation R is transitive
⇐⇒
xRy, yRz =⇒xRz
4. A relation R is complete
⇐⇒
∀x, y ∈X either xRy or yRx (or both) (in other words a complete relation
orders the whole set)
An indifference relation, ∼, and a strict preference relation, ≻, can be derived
from every preference relation:
1. x ≻y means x ⪰y but not y ⪰x
2. x ∼y means x ⪰y and y ⪰x.
The utility function u : X →ℜrepresents the preference relation ⪰if
u(x) ≥u(y) ⇐⇒x ⪰y.
If f: ℜ→ℜis a monotonic increasing function and u represents the preference
relation ⪰, then f ◦u also represents ⪰, since
f (u(x)) ≥f (u(y)) ⇐⇒u(x) ≥u(y) ⇐⇒x ⪰y.
If X is a countable set, then there exists a utility function representing any pref-
erence relation on X. To prove this, just write out the consumption plans in X in
order of preference, and assign numbers to them, assigning the same number to
any two or more consumption plans between which the consumer is indifferent.
If X is an uncountable set, then there may not exist a utility function representing
every preference relation on X.
Revised: December 2, 1998

66
4.3. AXIOMS
4.3
Axioms
We now consider six axioms which it are frequently assumed to be satisﬁed by
preference relations when considering consumer choice under certainty. (Note
that symmetry would not be a very sensible axiom!) Section 5.5.1 will consider
further axioms that are often added to simplify the analysis of consumer choice
under uncertainty. After the deﬁnition of each axiom, we will give a brief ratio-
nale for its use.
Axiom 1 (Completeness) A (weak) preference relation is complete.
Completeness means that the consumer is never agnostic.
Axiom 2 (Reﬂexivity) A (weak) preference relation is reﬂexive.
Reﬂexivity means that each bundle is at least as good as itself.
Axiom 3 (Transitivity) A (weak) preference relation is transitive.
Transitivity means that preferences are rational and consistent.
Axiom 4 (Continuity) The preference relation ⪰is continuous i.e. for all con-
sumption plans y ∈X the sets By ≡{x ∈X : x ⪰y} and Wy = {x ∈X : y ⪰
x} are closed sets.
Consider the picture when N = 2:
We will see shortly that By, the set of consumption plans which are better than or
as good as y, and Wy, the set of consumption plans which are worse than or as
good as y, are just the upper contour sets and lower contour sets respectively of
utility functions, if such exist.
E.g. consider lexicographic preferences:
Lexicographic preferences violate the continuity axiom. A consumer with such
preference prefers more of commodity 1 regardless of the quantities of other com-
modities, more of commodity 2 if faced with a choice between two consumption
plans having the same amount of commodity 1, and so on.
In the picture, the consumption plan y lies in the lower contour set Wx∗but Bϵ (y)
never lies completely in Wx∗for any ϵ. Thus, lower contour sets are not open, and
upper contour sets are not closed.
Theorems on the existence of continuous utility functions have been proven by
Gerard Debreu, Nobel laureate, whose proof used Axioms 1–4 only (see ? or ?)
and by Hal Varian, whose proof was simpler by virtue of adding an additional
axiom (see ?).
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
67
Theorem 4.3.1 (Debreu) If X is a closed and convex set and ⪰is a complete,
reﬂexive, transitive and continuous preference relation on X, then ∃a continuous
utility function u: X →ℜrepresenting ⪰.
Proof For the proof of this theorem, see ?.
Q.E.D.
Axiom 5 (Greed) Greed is incorporated into consumer behaviour by assuming
either
1. Strong monotonicity:
If X = ℜN
+, then ⪰is said to be strongly monotonic iff whenever xn ≥yn∀n
but x ̸= y, x ≻y. [x = (x1, . . . , xN) &c.]; or
2. Local non-satiation:
∀x ∈X, ϵ > 0, ∃x′ ∈Bϵ (x) s.t. x′ ≻x
The strong monotonicity axiom is a much stronger restriction on preferences than
local non-satiation; however, it greatly simpliﬁes the proof of existence of utility
functions.
We will prove the existence, but not the continuity, part of the following weaker
theorem.
Theorem 4.3.2 (Varian) If X = ℜN
+ and ⪰is a complete, reﬂexive, transitive,
continuous and strongly monotonic preference relation on X, then ∃a continuous
utility function u: X →ℜrepresenting ⪰.
Proof (of existence only (?, p.97))
Pick a benchmark consumption plan, e.g. 1 ≡(1, 1, . . . , 1).
The idea is that the utility of x is the multiple of the benchmark consumption plan
to which x is indifferent.
By strong monotonicity, the sets {t ∈ℜ: t1 ⪰x} and {t ∈ℜ: x ⪰t1} are both
non-empty.
By continuity of preferences, both are closed (intersection of a ray through the
origin and a closed set); and by completeness, they cover ℜ.
By connectedness of ℜ, they intersect in at least one point, u(x) say, and x ∼
u(x)1.
Now
x ⪰y
⇐⇒
u(x)1 ⪰u(y)1
⇐⇒
u(x) ≥u(y)
where the ﬁrst equivalence follows from transitivity of preferences and the second
from strong monotonicity.
The assumption that preferences are reﬂexive is not used in establishing existence
of the utility function, so it can be inferred that it is required to establish continuity.
Revised: December 2, 1998

68
4.3. AXIOMS
Q.E.D.
The rule which the consumer will follow is to choose the most preferred bundle
from the set of affordable alternatives (budget set), in other words the bundle at
which the utility function is maximised subject to the budget constraint, if one
exists.
We know that an optimal choice will exist if the utility function is continuous and
the budget set is closed and bounded.
If the utility function is differentiable, we can go further and use calculus to ﬁnd
the maximum.
So we usually assume differentiability.
If u is a concave utility function, then f ◦u, which also represents the same prefer-
ences, is not necessarily a concave function (unless f itself is a convex function).
In other words, concavity of a utility function is a property of the particular repre-
sentation and not of the underlying preferences. Notwithstanding this, convexity
of preferences is important, as indicated by the use of one or other of the follow-
ing axioms, each of which relates to the preference relation itself and not to the
particular utility function chosen to represent it.
Axiom 6 (Convexity) There are two versions of this axiom:
1. Convexity:
The preference relation ⪰is convex ⇐⇒
x ⪰y =⇒λx + (1 −λ) y ⪰y.
2. Strict convexity:
The preference relation ⪰is strictly convex ⇐⇒
x ⪰y =⇒λx + (1 −λ) y ≻y.
The difference between the two versions of the convexity axiom basically amounts
to ruling out linear segments in indifference curves in the strict case.
Theorem 4.3.3 The preference relation ⪰is (strictly) convex if and only if every
utility function representing ⪰is a (strictly) quasiconcave function.
Proof In either case, both statements are equivalent to saying that
u(x) ≥u(y) =⇒u (λx + (1 −λ) y) ≥(>)u(y).
(4.3.1)
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
69
Q.E.D.
Theorem 4.3.4 All upper contour sets of a utility function representing convex
preferences are convex sets (i.e. indifference curves are convex to the origin for
convex preferences).
It can be seen that convexity of preferences is a generalisation of the two-good
assumption of a diminishing marginal rate of substitution.
Axiom 7 (Inada Condition) This axiom seems to be relegated to some other cat-
egory in many existing texts and its attribution to Inada is also difﬁcult to trace. It
is not easy to see how to express it in terms of the underlying preference relation
so perhaps it cannot be elevated to the status of an axiom. Should it be expressed
as:
lim
xi→0
∂u
∂xi
= ∞
or as
lim
xi→∞
∂u
∂xi
= 0?
The Inada condition will be required to rule out corner solutions in the consumer’s
problem. Intuitively, it just says that indifference curves may be asymptotic to the
axes but never reach them.
4.4
Optimal Response Functions:
Marshallian and Hicksian Demand
4.4.1
The consumer’s problem
A consumer with consumption set Xh, endowment vector eh ∈Xh, sharehold-
ings ch ∈ℜF and preference ordering ⪰h represented by utility function uh who
desires to trade his endowment at prices p ∈ℜN
+ faces an inequality constrained
optimisation problem:
max
x∈Xh uh (x) s.t. p⊤x ≤p⊤eh + c⊤
h Π (p) ≡Mh
(4.4.1)
where Π (p) is the vector of the F ﬁrms’ maximised proﬁts when prices are p.
Constraining x to lie in the consumption set normally just means imposing non-
negativity constraints on the problem. From a mathematical point of view, the
source of income is irrelevant, and in particular the distinction between pure ex-
change and production economy is irrelevant. Thus, income can be represented
by M in either case.
Revised: December 2, 1998

70
4.4. OPTIMAL RESPONSE FUNCTIONS:
MARSHALLIAN AND HICKSIAN DEMAND
Since the constraint functions are linear in the choice variables x, the Kuhn-Tucker
theorem on second order conditions (Theorem 3.5.2) can be applied, provided that
the utility function uh is pseudo-concave. In this case, the ﬁrst order conditions
identify a maximum.
The Lagrangian, using multipliers λ for the budget constraint and µ ∈ℜN for the
non-negativity constraints, is
uh (x) + λ

M −p⊤x

+ µ⊤x.
(4.4.2)
The ﬁrst order conditions are given by the (N-dimensional) vector equation:
u′
h (x) + λ (−p) + µ = 0N
(4.4.3)
and the sign condition λ ≥0 with λ > 0 if the budget constraint is binding.
We also have µ = 0N unless one of the non-negativity constraints is binding:
Axiom 7 would rule out this possibility.
Now for each p ∈ℜN
++ (ruling out bads, or goods with negative prices, and even
(see below) free goods), eh ∈Xh, and ch ∈ℜF, or for each p, Mh combination,
there is a corresponding solution to the consumer’s utility maximisation problem,
denoted xh (p, eh, ch) or xh (p, Mh). The function (correspondence) xh is often
called a Marshallian demand function (correspondence).
If the utility function uh is also strictly quasiconcave (i.e. preferences are strictly
convex), then the conditions of the Kuhn-Tucker theorem on uniqueness (Theo-
rem 3.5.3) are satisﬁed. In this case, the consumer’s problem has a unique solu-
tion for given prices and income, so that the optimal response correspondence is a
single-valued demand function. On the other hand, the weak form of the convexity
axiom would permit a multi-valued demand correspondence.
4.4.2
The No Arbitrage Principle
Deﬁnition 4.4.1 An arbitrage opportunity means the opportunity to acquire a
consumption vector or its constituents, directly or indirectly, at one price, and
to sell the same consumption vector or its constituents, directly or indirectly, at a
higher price.
Theorem 4.4.1 (The No Arbitrage Principle) Arbitrage opportunities do not ex-
ist in equilibrium in an economy in which at least one agent has preferences which
exhibit local non-satiation.2
2The No Arbitrage Principle is also known as the No Free Lunch Principle, or the Law of One
Price
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
71
Proof If preferences exhibit local non-satiation, then Marshallian demand is not
well-deﬁned if the price vector permits arbitrage opportunities.
If the no arbitrage principle doesn’t hold, then any individual can increase wealth
without bound by exploiting the available arbitrage opportunity on an inﬁnite
scale. Thus there is no longer a budget constraint and, since local non-satiation
rules out bliss points, utility too can be increased without bound.
When we come to consider equilibrium, we will see that if even one individual has
preferences exhibiting local non-satiation, then equilibrium prices can not permit
arbitrage opportunities.
Q.E.D.
Examples are usually in the ﬁnancial markets, in a multi-period context, e.g. cov-
ered interest parity, term structure of interest rates, &c. The most powerful appli-
cation is in the derivation of option-pricing formulae, since options can be shown
to be identical to various synthetic portfolios made up of the underlying security
and the riskfree security.
The simple rule for ﬁguring out how to exploit arbitrage opportunities is ‘buy
low, sell high’. With interest rates and currencies, for example, this may be a
non-trivial calculation.
Exercise: If the interest rate for one-year deposits or loans is r1 per annum com-
pounded annually, the interest rate for two-year deposits or loans is r2 per annum
compounded annually and the forward interest rate for one year deposits or loans
beginning in one year’s time is f12 per annum compounded annually, calculate the
relationship that must hold between these three rates if there are to be no arbitrage
opportunities.
Solution: (1 + r1) (1 + f12) = (1 + r2)2.
4.4.3
Other Properties of Marshallian demand
Other noteworthy properties of Marshallian demand include the following:
1. If preferences exhibit local non-satiation, then the budget constraint is bind-
ing.
This is because no consumption vector in the interior of the budget set can
maximise utility as some nearby consumption vector will always be both
preferred and affordable. At the optimum, on the budget hyperplane, the
nearby consumption vector which is preferred will not be affordable.
2. If p includes a zero price (pn = 0 for some n), then xh (p, Mh) may not be
well deﬁned.
Revised: December 2, 1998

72
4.4. OPTIMAL RESPONSE FUNCTIONS:
MARSHALLIAN AND HICKSIAN DEMAND
This is because, at least in the case of strongly monotonic preferences, the
consumer will seek to acquire and consume an inﬁnite amount of the free
good, thereby increasing utility without bound. For this reason, it is neater
to deﬁne Marshallian demand only on the open non-negative orthant in ℜN,
namely ℜN
++.
3. The demand xh (p, Mh) is independent of the representation uh of the un-
derlying preference relation ⪰h which is used in the statement of the con-
sumer’s problem.
4. xh (p, Mh) is homogenous of degree 0 in p, Mh.
In other words, if all prices and income are multiplied by α > 0, then
demand does not change:
xh (αp, αMh) = xh (p, Mh) .
(4.4.4)
5. Demand functions are continuous.
This follows from the theorem of the maximum (Theorem 3.5.4). It fol-
lows that small changes in prices or income will lead to small changes in
quantities demanded.
4.4.4
The dual problem
Consider also the (dual) expenditure minimisation problem:
min
x p⊤x s.t. uh (x) ≥¯u.
(4.4.5)
In other words, what happens if expenditure is minimised subject to a certain level
of utility, ¯u, being attained?
The solution (optimal response function) is called the Hicksian or compensated
demand function (or correspondence) and is usually denoted hh (p, ¯u).
There should really be a more general discussion of duality, based on the mean-
variance problem as well as the utility maximisation/expenditure minimisation
problems.
If the local non-satiation axiom holds, then the constraints are binding in both
the utility-maximisation and expenditure-minimisation problems, and we have a
number of duality relations. In particular, there will be a one-to-one correspon-
dence between income M and utility ¯u for a given price vector p. The expenditure
function and the indirect utility function will then act as a pair of inverse envelope
functions mapping utility levels to income levels and vice versa respectively.
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
73
A full page table setting out exactly the parallels between the two problems is
called for here.
The following duality relations (or fundamental identities as ? calls them) will
prove extremely useful later on:
e (p, v (p, M))
=
M
(4.4.6)
v (p, e (p, ¯u))
=
¯u
(4.4.7)
x (p, M)
=
h (p, v (p, M))
(4.4.8)
h (p, ¯u)
=
x (p, e (p, ¯u))
(4.4.9)
These are just equations (3.6.5)–(3.6.8) adapted to the notation of the consumer’s
problem.
4.4.5
Properties of Hicksian demands
As in the Marshallian approach, if preferences are strictly convex, then any solu-
tion to the expenditure minimisation problem is unique and the Hicksian demands
are well-deﬁned single valued functions.
It’s worth going back to the uniqueness proof with this added interpretation. If two
different consumption vectors minimise expenditure, then they both cost the same
amount, and any convex combination of the two also costs the same amount. But
by strict convexity, a convex combination yields higher utility, and nearby there
must, by continuity, be a cheaper consumption vector still yielding utility ¯u.
If preferences are not strictly convex, then Hicksian demands may be correspon-
dences rather than functions.
Hicksian demands are homogenous of degree 0 in prices:
hh (αp, ¯u) = hh (p, ¯u) .
(4.4.10)
4.5
Envelope Functions:
Indirect Utility and Expenditure
Now consider the envelope functions corresponding to the two approaches:
1. The indirect utility function:
vh (p, M) ≡uh (xh (p, M))
(4.5.1)
2. The expenditure function:
eh (p, ¯u) ≡p⊤hh (p, ¯u) .
(4.5.2)
Sometimes we meet two other related functions:
Revised: December 2, 1998

74
4.5. ENVELOPE FUNCTIONS:
INDIRECT UTILITY AND EXPENDITURE
3. The money metric utility function
mh (p, x) ≡eh (p, uh (x))
(4.5.3)
is the (least) cost at prices p of being as well off as with the consumption
vector x.
4. The money metric indirect utility function
µh (p; q, M) ≡eh (p, vh (q, M))
(4.5.4)
is the (least) cost at prices p of being as well off as if prices were q and
income was M.
The following are interesting properties of the indirect utility function:
1. By the Theorem of the Maximum, the indirect utility function is continuous
for positive prices and income.
2. The indirect utility function is non-increasing in p and non-decreasing in
M.
3. The indirect utility function is quasi-convex in prices.
To see this, let B (p) denote the budget set when prices are p and let pλ ≡
λp + (1 −λ) p′.
Then B (pλ) ⊆(B (p) ∪B (p′)).
Suppose this was not the case, i.e. for some x, pλ⊤x ≤M but p⊤x >
M and p′⊤x > M. Then taking a convex combination of the last two
inequalities yields
λp⊤x + (1 −λ) p′⊤x > M,
which contradicts the ﬁrst inequality.
It follows that the maximum value of uh (x) on the subset B (pλ) is less
than or equal to its maximum value on the superset B (p) ∪B (p′).
In terms of the indirect utility function, this says that
vh (pλ, M) ≤max {vh (p, M) , vh (p′, M)} ,
or that vh is quasiconvex.
4. vh (p, M) is homogenous of degree zero in p, M, or
vh (λp, λM) = vh (p, M) .
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
75
The following are interesting properties of the expenditure function:
1. The expenditure function is continuous.
2. The expenditure function itself is non-decreasing in prices, since raising the
price of one good while holding the prices of all other goods constant can
not reduce the minimum cost of attaining a ﬁxed utility level.
3. The expenditure function is concave in prices.
To see this, we just ﬁx two price vectors p and p′ and consider the value of
the expenditure function at the convex combination pλ ≡λp + (1 −λ) p′.
e (pλ, ¯u)
=
(pλ)⊤h (pλ, ¯u)
(4.5.5)
=
λp⊤h (pλ, ¯u) + (1 −λ) (p′)⊤h (pλ, ¯u)
(4.5.6)
≥
λp⊤h (p, ¯u) + (1 −λ) (p′)⊤h (p′, ¯u)
(4.5.7)
=
λe (p, ¯u) + (1 −λ) e (p′, ¯u) ,
(4.5.8)
where the inequality follows because the cost of a suboptimal bundle for
the given prices must be greater than the cost of the optimal (expenditure-
minimising) consumption vector for those prices.
4. The expenditure function is homogenous of degree 1 in prices:
eh (αp, ¯u) = αeh (p, ¯u) .
(4.5.9)
4.6
Further Results in Demand Theory
In this section, we present four important theorems on demand functions and the
corresponding envelope functions. Shephard’s Lemma will allow us to recover
Hicksian demands from the expenditure function. Similarly, Roy’s Identity will
allow us to recover Marshallian demands from the indirect utility function. The
Slutsky symmetry condition and the Slutsky equation provide further insights into
the properties of consumer demand.
Theorem 4.6.1 (Shephard’s Lemma.)
∂eh
∂pn (p, ¯u)
=
∂
∂pn

p⊤x + λ (uh (x) −¯u)

(4.6.1)
=
xn
(4.6.2)
which, when evaluated at the optimum, is just hn
h (p, ¯u).
In other words, the partial derivatives of the expenditure function with respect to
prices are the corresponding Hicksian demand functions.
Revised: December 2, 1998

76
4.6. FURTHER RESULTS IN DEMAND THEORY
Proof By differentiating the expenditure function with respect to the price of
good n and applying the envelope theorem (Theorem 3.4.4), we obtain Shephard’s
Lemma:
(To apply the envelope theorem, we should be dealing with an equality constrained
optimisation problem; however, if we assume local non-satiation, we know that
the budget constraint or utility constraint will always be binding, and so the in-
equality constrained expenditure minimisation problem is essentially and equality
constrained problem.)
Q.E.D.
Theorem 4.6.2 (Roy’s Identity.) Marshallian demands may be recovered from
the indirect utility function using:
xn (p, M) = −
∂v
∂pn (p, M)
∂v
∂M (p, M).
(4.6.3)
Proof For Roy’s Identity, see ?.
It is obtained by differentiating equation (4.4.7) with respect to pn, using the Chain
Rule:
v (p, e (p, ¯u)) = ¯u
implies that
∂v
∂pn (p, e (p, ¯u)) + ∂v
∂M (p, e (p, ¯u)) ∂e
∂pn (p, ¯u) = 0
(4.6.4)
and using Shephard’s Lemma gives:
∂v
∂pn (p, e (p, ¯u)) + ∂v
∂M (p, e (p, ¯u)) hn (p, ¯u) = 0
(4.6.5)
Hence
hn (p, ¯u) = −
∂v
∂pn (p, e (p, ¯u))
∂v
∂M (p, e (p, ¯u))
(4.6.6)
and expressing this last equation in terms of the relevant level of income M rather
than the corresponding value of utility ¯u:
xn (p, M) = −
∂v
∂pn (p, M)
∂v
∂M (p, M).
(4.6.7)
Q.E.D.
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
77
Theorem 4.6.3 (Slutsky symmetry condition.) All cross-price substitution effects
are symmetric:
∂hn
h
∂pm = ∂hm
h
∂pn .
(4.6.8)
Proof From Shephard’s Lemma, we can easily derive the Slutsky symmetry condi-
tions, assuming that the expenditure function is twice continuously differentiable,
and hence that
∂2eh
∂pm∂pn =
∂2eh
∂pn∂pm.
(4.6.9)
Since hm
h = ∂eh
∂pm and hn
h = ∂eh
∂pn, and the result follows.
Q.E.D.
The next result doesn’t really have a special name of its own.
Theorem 4.6.4 Since the expenditure function is concave in prices (see p. 75), the
corresponding Hessian matrix is negative semi-deﬁnite. In particular, its diagonal
entries are non-positive, or
∂2eh
∂(pn)2 ≤0,
n = 1, . . . , N.
(4.6.10)
Using Shephard’s Lemma, it follows that
∂hn
h
∂pn ≤0,
n = 1, . . . , N.
(4.6.11)
In other words, Hicksian demand functions, unlike Marshallian demand functions,
are uniformly decreasing in own price. Another way of saying this is that own
price substitution effects are always negative.
Theorem 4.6.5 (Slutsky equation.) The total effect of a price change on (Mar-
shallian) demand can be decomposed as follows into a substitution effect and an
income effect:
∂xm
∂pn (p, M) = ∂hm
∂pn (p, ¯u) −∂xm
∂M (p, M) hn (p, ¯u) ,
(4.6.12)
where ¯u ≡V (p, M).
Before proving this, let’s consider the signs of the various terms in the Slutsky
equation and look at what it means in a two-good example.
By Theorem 4.6.4, we know that own price substitution effects are always non-
positive.
[This is still on a handwritten sheet.]
Revised: December 2, 1998

78
4.7. GENERAL EQUILIBRIUM THEORY
Proof Differentiating both sides of the lth component of (4.4.9) with respect to
pn, using the Chain Rule, will yield the so-called Slutsky equation which decom-
poses the total effect on demand of a price change into an income effect and a
substitution effect.
Differentiating the RHS of (4.4.9) with respect to pn yields:
∂xm
∂pn (p, e (p, ¯u)) + ∂xm
∂M (p, e (p, ¯u)) ∂e
∂pn (p, ¯u) .
(4.6.13)
To complete the proof:
1. set this equal to ∂hm
∂pn (p, ¯u)
2. substitute from Shephard’s Lemma
3. deﬁne M ≡e (p, ¯u) (which implies that ¯u ≡V (p, M))
Q.E.D.
4.7
General Equilibrium Theory
4.7.1
Walras’ law
Walras ... 3
4.7.2
Brouwer’s ﬁxed point theorem
4.7.3
Existence of equilibrium
4.8
The Welfare Theorems
4.8.1
The Edgeworth box
4.8.2
Pareto efﬁciency
Deﬁnition 4.8.1 A feasible allocation X = (x1, . . . , xH) is Pareto efﬁcient if
there does not exist any feasible way of reallocating the same initial aggregate
endowment,
PH
h=1 xh, which makes one individual better off without making any
other worse off.
Deﬁnition 4.8.2 X is Pareto dominated by X′ = (x′
1, . . . , x′
H) if
PH
h=1 xh =
PH
h=1 x′
h, x′
h ⪰h xh ∀h and x′
h ≻h xh for at least one h.
3This material still exists only in handwritten form in Alan White’s EC3080 notes from 1991-
2. One thing missing from the handwritten notes is Kakutani’s Fixed Point Theorem which should
be quoted from ?.
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
79
4.8.3
The First Welfare Theorem
(See ?.)
Theorem 4.8.1 (First Welfare Theorem) If the pair (p, X) is an equilibrium (for
given preferences, ⪰h, which exibit local non-satiation and given endowments, eh,
h = 1, . . . , H), then X is a Pareto efﬁcient allocation.
Proof The proof is by contradiction. Suppose that X is an equilibrium allocation
which is Pareto dominated by a feasible allocation X′.
If individual h is strictly better off under X′ or x′
h ≻h xh, then it follows that
individual h cannot afford x′
h at the equilibrium prices p or
p⊤x′
h > p⊤xh = p⊤eh.
(4.8.1)
The latter equality is just the budget constraint, which is binding since we have
assumed local non-satiation.
Similarly, if individual h is indifferent between X and X′ or x′
h ∼h xh, then it
follows that
p⊤x′
h ≥p⊤xh = p⊤eh,
(4.8.2)
since if x′
h cost strictly less than xh, then by local non-satiation some consumption
vector near enough to x′
h to also cost less than xh would be strictly preferred to
xh and xh would not maximise utility given the budget constraint.
Summing (4.8.1) and (4.8.2) over households yields
p⊤
H
X
h=1
x′
h > p⊤
H
X
h=1
xh = p⊤
H
X
h=1
eh,
(4.8.3)
(where the equality is essentially Walras’ Law).
But since X′ is feasible we must have for each good n
H
X
h=1
x′n
h ≤
H
X
h=1
en
h
and, hence, multiplying by prices and summing over all goods,
p⊤
H
X
h=1
x′
h ≤p⊤
H
X
h=1
eh.
(4.8.4)
But (4.8.4) contradicts the inequality in (4.8.3), so no such Pareto dominant allo-
cation X′
h can exist.
Q.E.D.
Before proceeding to the second welfare theorem, we need to say a little bit about
separating hyperplanes.
Revised: December 2, 1998

80
4.8. THE WELFARE THEOREMS
4.8.4
The Separating Hyperplane Theorem
Deﬁnition 4.8.3 The set
n
z ∈ℜN : p⊤z = p⊤z∗o
is the hyperplane through z∗
with normal p.
Note that any hyperplane divides ℜN into two closed half-spaces,
n
z ∈ℜN : p⊤z ≤p⊤z∗o
and
n
z ∈ℜN : p⊤z ≥p⊤z∗o
.
The intersection of these two closed half-spaces is the hyperplane itself.
In two dimensions, a hyperplane is just a line; in three dimensions, it is just a
plane.
The idea behind the separating hyperplane theorem is quite intuitive: if we take
any point on the boundary of a convex set, we can ﬁnd a hyperplane through
that point so that the entire convex set lies on one side of that hyperplane. We
will essentially be applying this notion to the upper contour sets of quasiconcave
utility functions, which are of course convex sets. We will interpret the separating
hyperplane as a budget hyperplane, and the normal vector as a price vector, so that
at those prices nothing giving higher utility than the cutoff value is affordable.
Theorem 4.8.2 (Separating Hyperplane Theorem) If Z is a convex subset of
ℜN and z∗∈Z, z∗̸∈int Z, then ∃p∗̸= 0 in ℜN such that p∗⊤z∗≤p∗⊤z ∀z ∈Z,
or Z is contained in one of the closed half-spaces associated with the hyperplane
through z∗with normal p∗.
Proof Not given. See ?
Q.E.D.
4.8.5
The Second Welfare Theorem
(See ?.)
We make slightly stronger assumptions than are essential for the proof of this
theorem. This allows us to give an easier proof.
Theorem 4.8.3 (Second Welfare Theorem) If all individual preferences are strictly
convex, continuous and strictly monotonic, and if X∗is a Pareto efﬁcient al-
location such that all households are allocated positive amounts of all goods
(x∗g
h
> 0 ∀g = 1, . . . , N; h = 1, . . . , H), then a reallocation of the initial ag-
gregate endowment can yield an equilibrium where the allocation is X∗.
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
81
Proof There are four main steps in the proof.
1. First we construct a set of utility-enhancing endowment perturbations, and
use the separating hyperplane theorem to ﬁnd prices at which no such en-
dowment perturbation is affordable.
We need to use the fact (Theorem 3.2.1) that a sum of convex sets, such as
X + Y ≡{x + y : x ∈X, y ∈Y } ,
is also a convex set.
Given an aggregate initial endowment x∗=
PH
h=1 x∗
h, we interpret any vec-
tor of the form z =
PH
h=1 xh −x∗as an endowment perturbation. Now
consider the set of all ways of changing the aggregate endowment without
making anyone worse off:
Z ≡(
z ∈ℜN : ∃xn
h ≥0 ∀g, h s.t. uh (xh) ≥uh (x∗
h) & z =
H
X
h=1
xh −x∗
)
.
(4.8.5)
Z is a sum of convex sets provided that preferences are assumed to be
convex:
Z =
H
X
h=1
Xh −{x∗}
where
Xh ≡{xh : uh (xh) ≥uh (x∗
h)} .
2. Next, we need to show that the zero vector is in the set Z, but not in the
interior of Z.
To show that 0 ∈Z, we just set xh = x∗
h and observe that 0 =
PH
h=1 x∗
h −
x∗.4
The zero vector is not, however, in the interior of Z, since then Z would
contain some vector, say z∗, in which all components were strictly negative.
In other words, we could take away some of the aggregate endowment of
every good without making anyone worse off than under the allocation X∗.
But by then giving −z∗back to one individual, he or she could be made
better off without making anyone else worse off, contradicting Pareto opti-
mality, again using the assumption that preferences are strictly monotonic.
4Note also (although I’m no longer sure why this is important) that budget constraints are
binding and that there are no free goods (by the monotonicity assumption).
Revised: December 2, 1998

82
4.8. THE WELFARE THEOREMS
So, applying the Separating Hyperplane Theorem with z∗= 0, we have a
price vector p∗such that 0 = p∗⊤0 ≤p∗⊤z ∀z ∈Z.
Since preferences are monotonic, the set Z must contain all the standard
unit basis vectors ((1, 0, . . . , 0), &c.). This fact can be used to show that
all components of p∗are non-negative, which is essential if it is to be inter-
preted as an equilibrium price vector.
3. Next, we specify one way of redistributing the initial endowment in order
that the desired prices and allocation emerge as a competitive equilibrium.
All we need to do is value endowments at the equilibrium prices, and redis-
tribute the aggregate endowment of each good to consumers in proportion
to their share in aggregate wealth computed in this way.
4. Finally, we conﬁrm that utility is maximised by the given Pareto efﬁcient
allocation, X∗, at these prices. As usual, the proof is by contradiction: the
details are left as an exercise.
Q.E.D.
4.8.6
Complete markets
The First Welfare Theorem tells us that competitive equilibrium allocations are
Pareto optimal if markets are complete. If there are missing markets, then com-
petitive trading may not lead to a Pareto optimal allocation. We can use the Edge-
worth Box diagram to illustrate the simplest possible version of this principle.
4.8.7
Other characterizations of Pareto efﬁcient allocations
There are a total of ﬁve equivalent characterisations of Pareto efﬁcient allocations.
Theorem 4.8.4 Each of the following is an equivalent description of the set of
allocations which are Pareto efﬁcient:
1. by deﬁnition, feasible allocations such that no other allocation strictly in-
creases at least one individual’s utility without decreasing the utility of any
other individual;
2. by the Welfare Theorems, equilibrium allocations for all possible distribu-
tions of the ﬁxed initial aggregate endowment;
3. in two dimensions, allocations lying on the contract curve in the Edgeworth
box;
Revised: December 2, 1998

CHAPTER 4. CHOICE UNDER CERTAINTY
83
4. allocations which solve: 5
max
{xh:h=1,...,H}
H
X
h=1
λh [uh(xh)]
(4.8.6)
subject to the feasibility constraints
H
X
h=1
xh
=
H
X
h=1
eh
(4.8.7)
for some non-negative weights {λh}H
h=1.
5. allocations which maximise the utility of a representative agent given by
H
X
h=1
λh [uh(xh)]
(4.8.8)
where {λh}H
h=1 are again any non-negative weights.
Proof If an allocation is not Pareto efﬁcient, then the Pareto-dominating alloca-
tion gives a higher value of the objective function in the above problem for all
possible weights.
If an allocation is Pareto efﬁcient, then the relative weights for which the above
objective function is maximized are the ratios of the Lagrange multipliers from
the problem of maximizing any individual’s utility subject to the constraint that
all other individuals’ utilities are unchanged:
max u1(x1)
(4.8.9)
s.t.
uh(xh) = uh(x∗
h) h = 2, . . . , H
(4.8.10)
since these two problems will have the same necessary and sufﬁcient ﬁrst order
conditions.
The absolute weights corresponding to a particular allocation are not unique, as
they can be multiplied by any positive constant without affecting the maximum.
Different absolute weights (or Lagrange multipliers) arise from ﬁxing different
individuals’ utilities in the last problem, but the relative weights will be the same.
5The solution here would be unique if the underlying utility function were concave, since linear
combinations of concave functions with non-negative weights are concave, and the constraints
specify a convex set on which the objective function has a unique optimum. This argument can
not be used with merely quasiconcave utility functions.
Revised: December 2, 1998

84
4.9. MULTI-PERIOD GENERAL EQUILIBRIUM
Q.E.D.
Note that corresponding to each Pareto efﬁcient allocation there is at least one:
1. set of non-negative weights deﬁning
(a) the objective function in 4. and
(b) the representative agent in 5.
and
2. initial allocation leading to the competitive equilibrium in 2.
4.9
Multi-period General Equilibrium
In Section 4.2, it was pointed out that the objects of choice can be differentiated
not only by their physical characteristics, but also both by the time at which they
are consumed and by the state of nature in which they are consumed. These
distinctions were suppressed in the intervening sections but are considered again
in this section and in Section 5.4 respectively.
The multi-period model should probably be introduced at the end of Chapter 4
but could also be left until Chapter 7. For the moment this brief introduction is
duplicated in both chapters.
Discrete time multi-period investment problems serve as a stepping stone from
the single period case to the continuous time case.
The main point to be gotten across is the derivation of interest rates from equilib-
rium prices: spot rates, forward rates, term structure, etc.
This is covered in one of the problems, which illustrates the link between prices
and interest rates in a multiperiod model.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
85
Chapter 5
CHOICE UNDER UNCERTAINTY
5.1
Introduction
[To be written.]
5.2
Review of Basic Probability
Economic theory has, over the years, used many different, sometimes overlapping,
sometimes mutually exclusive, approaches to the analysis of choice under uncer-
tainty. This chapter deals with choice under uncertainty exclusively in a single
period context. Trade takes place at the beginning of the period and uncertainty
is resolved at the end of the period. This framework is sufﬁcient to illustrate the
similarities and differences between the most popular approaches.
When we consider consumer choice under uncertainty, consumption plans will
have to specify a ﬁxed consumption vector for each possible state of nature or
state of the world. This just means that each consumption plan is a random vector.
Let us review the associated concepts from basic probability theory: probability
space; random variables and vectors; and stochastic processes.
Let Ωdenote the set of all possible states of the world, called the sample space.
A collection of states of the world, A ⊆Ω, is called an event.
Let A be a collection of events in Ω. The function P : A →[0, 1] is a probability
function if
1.
(a) Ω∈A
(b) A ∈A ⇒Ω−A ∈A
(c) Ai ∈A for i = 1, . . . , ∞⇒
S∞
i=1 Ai ∈A
(i.e. A is a sigma-algebra of events)
Revised: December 2, 1998

86
5.2. REVIEW OF BASIC PROBABILITY
and
2.
(a) P (Ω) = 1
(b) P (Ω−A) = 1 −P (A) ∀A ∈A (redundant assumption)
(c) P (
S∞
i=1 Ai) =
P∞
i=1 P (Ai) when A1, A2, . . . are pairwise disjoint
events in A.
(Ω, A, P) is then called a probability space
Note that the certainty case we considered already is just the special case of un-
certainty in which the set Ωhas only one element.
We will consider these concepts in more detail when we come to intertemporal
models.
Suppose we are given such a probability space.
The function ˜x : Ω→ℜis a random variable (r.v.) if ∀x ∈ℜ{ω ∈Ω: ˜x (ω) ≤
x} ∈A, i.e. a function is a random variable if we know the probability that the
value of the function is less than or equals any given real number.
The function F˜x : ℜ→[0, 1] : x 7→Pr (˜x ≤x) ≡P ({ω ∈Ω: ˜x (ω) ≤x}) is
known as the cumulative distribution function (c.d.f.) of the random variable ˜x.
The convention of using a tilde over a letter to denote a random variable is com-
mon in ﬁnancial economics; in other ﬁelds capital letters may be reserved for ran-
dom variables. In either case, small letters usually denote particular real numbers
(i.e. particular values of the random variable).
A random vector is just a vector of random variables. It can also be thought of as
a vector-valued function on the sample space Ω.
A stochastic process is a collection of random variables or random vectors indexed
by time, e.g. {˜xt : t ∈T} or just {˜xt} if the time interval is clear from the context.
For the purposes of this part of the course, we will assume that the index set
consists of just a ﬁnite number of times i.e. that we are dealing with discrete time
stochastic processes.
Then a stochastic process whose elements are N-dimensional random vectors is
equivalent to an N|T|-dimensional random vector.
The (joint) c.d.f. of a random vector or stochastic process is the natural extension
of the one-dimensional concept.
Random variables can be discrete, continuous or mixed. The expectation (mean,
average) of a discrete r.v., ˜x, with possible values x1, x2, x3, . . . is given by
E [˜x] ≡
∞
X
i=1
xiPr (˜x = xi) .
For a continuous random variable, the summation is replaced by an integral.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
87
The covariance of two random variables ˜x and ˜y is given by
Cov [˜x, ˜y] ≡E [(˜x −e [˜x]) (˜y −E [˜y])] .
The covariance of a random variable with itself is called its variance.
The expectation of a random vector is just the vector of the expectations of the
component random variables.
The variance (variance-covariance matrix) of a random vector is the (symmetric,
positive semi-deﬁnite) matrix of the covariances between the component random
variables.
Given any two random variables ˜x and ˜y, we can deﬁne a third random variable˜ϵ
by
˜ϵ ≡˜y −α −β˜x.
(5.2.1)
To specify˜ϵ completely, we can either specify α and β explicitly or ﬁx them
implicitly by imposing (two) conditions on˜ϵ. We do the latter by insisting
1. ˜ϵ and ˜x are uncorrelated (this is not the same as assuming statistical inde-
pendence, except in special cases such as bivariate normality)
2. E [˜ϵ] = 0
It follows that:
β
=
Cov [˜x, ˜y]
Var [˜x]
(5.2.2)
and
α
=
E [˜y] −βE [˜x] .
(5.2.3)
But what about the conditional expectation, E [˜y|˜x = x]? This is not equal to
α + βx, as one might expect, unless E [˜ϵ|˜x = x] = 0. This requires statistical
independence rather than the assumed lack of correlation. Again, a sufﬁcient
condition is multivariate normality.
The notion of the β of ˜y with respect to ˜x as given in (5.2.2) will recur frequently.
The ﬁnal concept required from basic probability theory is the notion of a mixture
of random variables. For lotteries which are discrete random variables, with pay-
offs x1, x2, x3, . . . occuring with probabilities π1, π2, π3, . . . respectively, we will
use the notation:
π1x1 ⊕π2x2 ⊕π3x3 ⊕. . .
Similar notation will be used for compound lotteries (mixtures of random vari-
ables) where the payoffs themselves are further lotteries.
This might be a good place to talk about the MVN distribution and Stein’s lemma.
Revised: December 2, 1998

88
5.3. TAYLOR’S THEOREM: STOCHASTIC VERSION
5.3
Taylor’s Theorem: Stochastic Version
We will frequently use the univariate Taylor expansion as applied to a function
of a random variable expanded about the mean of the random variable.1 Taking
expectations on both sides of the Taylor expansion:
f(˜x)
=
f(E[˜x]) +
∞
X
n=1
1
n!f (n)(E[˜x])(˜x −E[˜x])n
(5.3.1)
yields:
E[f(˜x)]
=
f(E[˜x]) +
∞
X
n=2
1
n!f (n)(E[˜x])mn(˜x),
(5.3.2)
where
mn(˜x) ≡E [(˜x −E[˜x])n] .
(5.3.3)
In particular,
m1(˜x)
=
E
h
(˜x −E[˜x])1i
≡0
(5.3.4)
m2(˜x)
=
E
h
(˜x −E[˜x])2i
≡Var [˜x]
(5.3.5)
m3(˜x)
=
E
h
(˜x −E[˜x])3i
≡Skew [˜x]
(5.3.6)
and
m4(˜x)
=
E
h
(˜x −E[˜x])4i
≡Kurt [˜x] ,
(5.3.7)
which allows us to start the summation in (5.3.2) at n = 2 rather than n = 1.
Indeed, we can rewrite (5.3.2) as
E[f(˜x)]
=
f(E[˜x]) + 1
2f ′′(E[˜x])Var [˜x] + 1
6f ′′′(E[˜x])Skew [˜x]
+ 1
24f ′′′′(E[˜x])Kurt [˜x] +
∞
X
n=5
1
n!f (n)(E[˜x])mn(˜x).
(5.3.8)
5.4
Pricing State-Contingent Claims
This part of the course draws on ?, ? and ?.
The analysis of choice under uncertaintly will begin by reinterpreting the general
equilibrium model of Chapter 4 so that goods can be differentiated by the state
of nature in which they are consumed. Speciﬁcally, it will be assumed that the
1This section will eventually have to talk separately about kth order and inﬁnite order Taylor
expansions.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
89
underlying sample space comprises a ﬁnite number of states of nature. A more
thorough analysis of choice under uncertainty, allowing for inﬁnite and continuous
sample spaces and based on additional axioms of choice, follows in Section 5.5.
Consider a world with M possible states of nature (distinguished by a ﬁrst sub-
script), markets for N securities (distinguished by a second subscript) and H con-
sumers (distinguished by a superscript).2
Deﬁnition 5.4.1 A state contingent claim or Arrow-Debreu security is a random
variable or lottery which takes the value 1 in one particular state of nature and
the value 0 in all other states.
Deﬁnition 5.4.2 A complex security is a random variable or lottery which can
take on arbitrary values. The payoffs of a typical complex security will be repre-
sented by a column vector, yj ∈ℜM, where yij is the payoff in state i of security
j.
The set of all complex securities on a given ﬁnite sample space is an M-dimensional
vector space and the M possible Arrow-Debreu securities constitute the standard
basis for this vector space.
State contingent claims prices are determined by the market clearing equations in
a general equilibrium model:
Aggregate consumption in state i = Aggregate endowment in state i.
Each individual will have an optimal consumption choice depending on endow-
ments and preferences and conditional on the state of the world. Optimal future
consumption is denoted
x∗=





x∗
1
x∗
2
. . .
x∗
N




.
(5.4.1)
If there are N complex securities, then the investor must ﬁnd a portfolio w =
(w1, . . . , wN) whose payoffs satisfy
x∗
i =
N
X
j=1
yijwj.
Let Y be the M × N matrix3 whose jth column contains the payoffs of the jth
complex security in each of the M states of nature, i.e.
Y ≡(y1, y2, . . . yN) .
(5.4.2)
2Check for consistency in subscripting etc in what follows.
3Or maybe I mean its transpose.
Revised: December 2, 1998

90
5.4. PRICING STATE-CONTINGENT CLAIMS
Theorem 5.4.1 If there are M complex securities (M = N) and the payoff matrix
Y is non-singular, then markets are complete.
Proof Suppose the optimal trade for consumer i state j is xij −eij. Then can
invert Y to work out optimal trades in terms of complex securities.
Q.E.D.
An (N + 1)st security would be redundant.
Either a singular square matrix or < N complex securities would lead to incom-
plete markets.
So far, we have made no assumptions about the form of the utility function, written
purely as
u (x0, x1, x2, . . . , xN) ,
where x0 represents the quantity consumed at date 0 and xi (i > 0) represents the
quantity consumed at date 1 if state i materialises.
5.4.1
Completion of markets using options
Assume that there exists a state index portfolio, Y , yielding different non-zero
payoffs in each state (i.e. a portfolio with a different payout in each state of nature,
possibly one mimicking aggregate consumption). WLOG we can rank the states
so that Yi < Yj if i < j.
We now present some results, following ?, showing conditions under which trad-
ing in a state index portfolio and in options on the state index portfolio can lead to
the Pareto optimal complete markets equilibrium allocation. Now consider com-
pletion of markets using options on aggregate consumption.
In real-world markets, the number of linearly independent corporate securities is
probably less than M.
However, options on corporate securities may be sufﬁcient to form complete mar-
kets, and thereby ensure allocational (Pareto) efﬁciency for arbitrary preferences.
Further assume that ∃M −1 European call options on Y with exercise prices
Y1, Y2, . . . , YM−1.
A European call option with exercise price K is an option to buy a security for
K on a ﬁxed date.
An American call option is an option to buy on or before the ﬁxed date.
A put option is an option to sell.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
91
Here, the original state index portfolio and the M −1 European call options yield
the payoff matrix:







y1
y2
y3
. . .
yM
0
y2 −y1
y3 −y1
. . .
yM −y1
0
0
y3 −y2
. . .
yM −y2
...
...
...
...
...
0
0
0
. . .
yM −yM−1







=







security Y
call option 1
call option 2
...
call option M −1







(5.4.3)
and as this matrix is non-singular, we have constructed a complete market.
Instead of assuming a state index portfolio exists, we can assume identical proba-
bility beliefs and state-independent utility and complete markets in a similar man-
ner (see below).
5.4.2
Restrictions on security values implied by allocational ef-
ﬁciency and covariance with aggregate consumption
Let
 Cω =
aggregate consumption in state ω
Ωk =
{ω ∈Ω: Cω = k}
Let φ(k) be the value of the claim with payoffs
ykω =
 1
if Cω = k
0
otherwise
(5.4.4)
and let the agreed probability of the event Ωk (i.e. of aggregate consumption
taking the value k) be:
π(k) =
X
ω∈Ωk
πω
(5.4.5)
By time-additivity and state-independence of the utility function:
φω = πωu′
i(ciω)
u′
i0(ci0)
∀ω ∈Ω
(5.4.6)
The no arbitrage condition implies
φ(k)
=
X
ω∈Ωk
φω
(5.4.7)
=
u′
i(fi(k))
u′
i0(ci0)
X
ω∈Ωk
πω
(5.4.8)
=
u′
i(fi(k))
u′
i0(ci0) π(k)
(5.4.9)
where fi(k) denotes the i-th individual’s equilibrium consumption in those states
where aggregate consumption equals k.
Revised: December 2, 1998

92
5.4. PRICING STATE-CONTINGENT CLAIMS
x(0)
x(1)
x(2)
˜C = 1
1
0
0
˜C = 2
2
1
0
˜C = 3
3
2
1
·
·
·
·
·
·
·
·
·
·
·
·
˜C = L
L
L −1
L −2
Table 5.1: Payoffs for Call Options on the Aggregate Consumption
State-independence of the utility function is required for fi(k) to be well-deﬁned.
Therefore, an arbitrary security x has value:
Sx
=
X
ω∈Ω
φωxω
(5.4.10)
=
X
k
X
ω∈Ωk
φωxω
(5.4.11)
=
X
k
u′
i(fi(k))
u′
i0(ci0)
X
ω∈Ωk
πωxω
(5.4.12)
=
X
k
φ(k)
X
ω∈Ωk
πω
π(k)xω
(5.4.13)
=
X
k
φ(k)E[˜x| ˜C = k]
(5.4.14)
5.4.3
Completing markets with options on aggregate consump-
tion
Let x(k) be the vector of payoffs in the various possible states on a European call
option on aggregate consumption with one period to maturity and exercise price
k.
Let {1, 2, . . . , L} be the set of possible values of aggregate consumption C(ω).
Then payoffs are as given in Table 5.1.
This all assumes
1. identical probability beliefs
2. time-additivity of u
3. state-independent u
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
93
5.4.4
Replicating elementary claims with a butterﬂy spread
Elementary claims against aggregate consumption can be constructed as follows,
for example, for state 1, using a butterﬂy spread:
[x(0) −x(1)] −[x(1) −x(2)]
(5.4.15)
yields the payoff:










1
2
3...
L








−








0
1
2...
L −1










−










0
1
2...
L −1








−








0
0
1...
L −2










=








1
1
1...
1








−








0
1
1...
1








=








1
0
0...
0








(5.4.16)
i.e. this replicating portfolio pays 1 iff aggregate consumption is 1, and 0 other-
wise.
The prices of this, and the other elementary claims, must, by no arbitrage, equal
the prices of the corresponding replicating portfolios.
5.5
The Expected Utility Paradigm
5.5.1
Further axioms
The objects of choice with which we are concerned in a world with uncertainty
could still be called consumption plans, but we will acknowledge the additional
structure now described by terming them lotteries.
If there are k physical commodities, a consumption plan must specify a k-dimensional
vector, x ∈ℜk, for each time and state of the world.
We assume a ﬁnite number of times, denoted by the set T.
The possible states of the world are denoted by the set Ω.
So a consumption plan or lottery is just a collection of |T| k-dimensional random
vectors, i.e. a stochastic process.
Again to distinguish the certainty and uncertainty cases, we let L denote the col-
lection of lotteries under consideration; X will now denote the set of possible
values of the lotteries in L.
Revised: December 2, 1998

94
5.5. THE EXPECTED UTILITY PARADIGM
Preferences are now described by a relation on L. We will continue to assume that
preference relations are complete, reﬂexive, transitive, and continuous.
X can be identiﬁed with a subset of L, in that each sure thing in X can be identiﬁed
with the trivial lottery that pays off that sure thing with probability (w.p.) 1.
Although we have moved from a ﬁnite-dimensional to an inﬁnite-dimensional
problem by explicitly allowing a continuum of states of nature, it can be shown
that the earlier theory of choice under certainty carries through to choice under
uncertainty, in particular a preference relation can always be represented by a
continuous utility function on L.
However, we would like utility functions to have a stronger property than conti-
nuity, namely the expected utility property.
Axiom 8 (Substitution or Independence Axiom) If a ∈(0, 1] and ˜p ≻˜q, then
a˜p ⊕(1 −a) ˜r ≻a˜q ⊕(1 −a) ˜r ∀˜r ∈L.
Axiom 9 (Archimedian Axiom) If ˜p ≻˜q ≻˜r then
∃a, b ∈(0, 1) s.t. a˜p ⊕(1 −a) ˜r ≻˜q ≻b˜p ⊕(1 −b) ˜r.
(The Archimedian axiom is just a generalisation of the continuity axiom.)
Axiom 10 (Sure Thing Principle) If probability is concentrated on a set of sure
things which are preferred to q, then the associated consumption plan is also
preferred to q.
(The Sure Thing Principle is just a generalisation of the Substitution Axiom.)
Now let us consider the Allais paradox.
Suppose
1£1m. ≻0.1£5m. ⊕0.89£1m. ⊕0.01£0.
Then, unless the substitution axiom is contradicted:
1£1m. ≻10
11£5m. ⊕1
11£0.
Finally, by the substitution axiom again,
0.11£1m. ⊕0.89£0 ≻0.1£5m. ⊕0.9£0.
If these appears counterintuitive, then so does the independence axiom above.
One justiﬁcation for persisting with the independence axiom is provided by ?.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
95
5.5.2
Existence of expected utility functions
A function u: ℜk×|T| →ℜcan be thought of as a utility function on sure things.
Deﬁnition 5.5.1 Let V : L →ℜbe a utility function representing the preference
relation ⪰.
Then ⪰is said to have an expected utility representation if there exists a utility
function on sure things, u, such that
V ({˜xt})
=
E [u ({˜xt})]
=
Z
. . .
Z
u ({xt}) dF{˜xt} ({xt})
Such a representation will often be called a Von Neumann-Morgenstern (or VNM)
utility function, after its originators (?), or just an expected utility function.
Any strictly increasing transformation of a VNM utility function represents the
same preferences.
However, only increasing afﬁne transformations:
f (x) = a + bx (b > 0)
retain the expected utility property.
Proof of this is left as an exercise.
We will now consider necessary and sufﬁcient conditions on preference relations
for an expected utility representation to exist.
Theorem 5.5.1 If X contains only a ﬁnite number of possible values, then the
substitution and Archimidean axioms are necessary and sufﬁcient for a preference
relation to have an expected utility representation.
Proof We will just sketch the proof that the axioms imply the existence of an
expected utility representation; the proof of the converse is left as an exercise.
For full details, see ?.
Since X is ﬁnite, and unless the consumer is indifferent among all possible choices,
there must exist maximal and minimal sure things, say p+ and p−respectively.
By the substitution axiom, and a simple inductive argument, these are maximal
and minimal in L as well as in X. (If X is not ﬁnite, then an inductive argument
can no longer be used and the Sure Thing Principle is required.)
From the Archimedean axiom, it can be deduced that for every other lottery, ˜p,
there exists a unique V (˜p) such that
˜p ∼V (˜p) p+ ⊕(1 −V (˜p)) p−.
Revised: December 2, 1998

96
5.5. THE EXPECTED UTILITY PARADIGM
It is easily seen that V represents ⪰.
Linearity can be shown as follows:
We leave it as an exercise to deduce from the axioms that if ˜x ∼˜y and ˜z ∼˜t then
π˜x ⊕(1 −π) ˜z ∼π˜y ⊕(1 −π) ˜t.
Deﬁne ˜z ≡π˜x ⊕(1 −π) ˜y.
Then, using the deﬁnitions of V (˜x) and V (˜y),
˜z
∼
π˜x ⊕(1 −π) ˜y
∼
π

V (˜x) p+ ⊕(1 −V (˜x)) p−

⊕(1 −π)

V (˜y) p+ ⊕(1 −V (˜y)) p−

=
(πV (˜x) + (1 −π) V (˜y)) p+ ⊕(π (1 −V (˜x)) + (1 −π) (1 −V (˜y))) p−
It follows that
V (π˜x ⊕(1 −π) ˜y) = πV (˜x) + (1 −π) V (˜y) .
This shows linearity for compound lotteries with only two possible outcomes: by
an inductive argument, every lottery can be reduced recursively to a two-outcome
lottery when there are only a ﬁnite number of possible outcomes altogether.Q.E.D.
Theorem 5.5.2 For more general L, to these conditions must be added some tech-
nical conditions and the Sure Thing Principle.
Proof We will not consider the proof of this more general theorem. It can be
found in ?.
Q.E.D.
Note that expected utility depends only on the distribution function of the con-
sumption plan.
Two consumption plans having very different consumption patterns across states
of nature but the same probability distribution give the same utility. E.g. if wet
days and dry days are equally likely, then an expected utility maximiser is indiffer-
ent between any consumption plan and the plan formed by switching consumption
between wet and dry days.
The basic objects of choice under expected utility are not consumption plans but
classes of consumption plans with the same cumulative distribution function.
Chapter 6 will consider the problem of portfolio choice in considerable depth.
This chapter, however, must continue with some basic analysis of the choice be-
tween one riskfree and one risky asset, following ?.
Such an example is sufﬁcient to show several things:
1. There is no guarantee that the portfolio choice problem has any ﬁnite or
unique solution unless the expected utility function is concave.
2. probably local risk neutrality and stuff like that too.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
97
5.6
Jensen’s Inequality and Siegel’s Paradox
Theorem 5.6.1 (Jensen’s Inequality) The expected value of a (strictly) concave
function of a random variable is (strictly) less than the same concave function of
the expected value of the random variable.
E
h
u
 ˜W
i
≤u

E
h ˜W
i
when u is concave
Similarly, the expected value of a (strictly) convex function of a random variable
is (strictly) greater than the same convex function of the expected value of the
random variable.
Proof There are three ways of motivating this result, but only one provides a fully
general and rigorous proof. Without loss of generality, consider the concave case.
1. One can reinterpret the deﬁning inequality (3.2.1) in terms of a discrete
random vector ˜x taking on the value x with probability π and x′ with prob-
ability 1 −π:
∀x ̸= x′ ∈X, π ∈(0, 1)
f (πx + (1 −π)x′) ≥πf(x) + (1 −π)f(x′),
(5.6.1)
which just says that
f (E [˜x]) ≥E [f (˜x)] .
(5.6.2)
An inductive argument can be used to extend the result to all discrete r.v.s
with a ﬁnite number of possible values, but runs into problems if the number
of possible values is either countably or uncountably inﬁnite.
2. Using a similar approach to that used with the Taylor series expansion in
(5.3.2), take expectations on both sides of the ﬁrst order condition for con-
cavity (3.2.3) given by Theorem 3.2.3, where the two vectors considered are
the mean E [˜x] and a generic value ˜x:
f(˜x) ≤f (E [˜x]) + f ′ (E [˜x]) (˜x −E [˜x]) .
(5.6.3)
Taking expectations on both sides, the ﬁrst order term will again disappear,
once more yielding:
f (E [˜x]) ≥E [f (˜x)] .
(5.6.4)
3. One can also appeal to the second order condition for concavity, and the
second order Taylor series expansion of f around E [˜x]:
E[f(˜x)]
=
f(E[˜x]) + 1
2f ′′(x∗)Var [˜x] ,
(5.6.5)
Revised: December 2, 1998

98
5.6. JENSEN’S INEQUALITY AND SIEGEL’S PARADOX
for some x∗in the support of ˜x. However, this supposes that x∗is ﬁxed,
whereas in fact it varies with the value taken on by ˜x, and is itself a random
variable, correlated with ˜x.
Accepting this (wrong) approximation, if f is concave, then by Theorem 3.2.4
the second derivative is non-positive and the variance is non-negative, so
E[f(˜x)]
≤
f(E[˜x]).
(5.6.6)
The arguments for convex functions, strictly concave functions and strictly con-
cave functions are almost identical.
Q.E.D.
This result is often useful with functions such as x 7→ln x and x 7→1
x.
To get a feel for the extent to which E[f(˜x)] differs from f(E[˜x]), we can again
use the following (wrong) second order Taylor approximation based on (5.3.8):
E[f(˜x)] ≈f(E[˜x]) + 1
2f ′′(E[˜x])Var [˜x] .
(5.6.7)
This shows that the difference is larger the larger is the curvature of f (as measured
by the second derivative at the mean of ˜x) and the larger is the variance of ˜x.
One area in which this idea can be applied is the computation of present values
based on replacing uncertain future discount factors with point estimates derived
from expected future interest rates.
Another nice application of Jensen’s Inequality in ﬁnance is:
Theorem 5.6.2 (Siegel’s Paradox) Current forward (relative) prices can not all
equal expected future spot prices.
Proof Let Ft be the current forward price and ˜St+1 the unknown future spot price.
If
Et
h ˜St+1
i
= Ft,
then Jensen’s Inequality tells us that
1
˜Ft
=
1
Et
h ˜St+1
i < Et
" 1
˜St+1
#
,
except in the degenerate case where ˜St+1 is known with certainty at time t.
But since the reciprocals of relatives prices are also relative prices, we have shown
that our initial hypothesis is untenable in terms of a different numeraire.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
99
Q.E.D.
The original and most obvious application of Siegel’s paradox is in the case of
currency exchange rates. In that case,
n ˜Ft
o
and
n ˜St
o
are stochastic processes
representing forward and spot exhange rates respectively. It seems reasonable to
assume that forward exchange rates are good predictors of spot exchange rates in
the future, say:
˜Ft = Et
h ˜St+1
i
.
But this is an internally inconsistent hypothesis.
However, Siegel’s paradox applies equally well to any theory which uses current
prices as a predictor of future values. Another such theory which is enormously
popular is the Efﬁcient Markets Hypothesis of ?. In its general form, this says
that current prices should fully reﬂect all available information about (expected)
future values. Attempts to make the words fully reﬂect in any way mathematically
rigorous quickly run into problems.
5.7
Risk Aversion
An individual is risk averse if he or she is unwilling to accept, or indifferent to,
any actuarially fair gamble.
(An individual is strictly risk averse if he or she is unwilling to accept any actu-
arially fair gamble.)
Figure 1.17.1 goes here.
i.e. ∀W0 and ∀p, h1, h2 such that ph1 + (1 −p) h2 = 0
W0 ⪰(≻)W0 + ph1 + (1 −p) h2
i.e.
u (W0) ≥(>)pu (W0 + h1) + (1 −p) u (W0 + h2)
The following interpretation of the above deﬁnition of risk aversion is based on
Jensen’s Inequality (see Section 5.6).
In other words, a (strictly) risk averse individual is one whose VNM utility func-
tion is (strictly) concave.
Similarly, a (strictly) risk loving individual is one whose VNM utility function is
(strictly) convex.
Finally, a risk neutral individual is one whose VNM utility function is afﬁne.
Revised: December 2, 1998

100
5.7. RISK AVERSION
Most functions do not fall into any of these categories, and represent behaviour
which is locally risk averse at some wealth levels and locally risk loving at other
wealth levels.
However, in most of what follows we will ﬁnd it convenient to assume that indi-
viduals are globally risk averse.
Individuals who are globally risk averse will never gamble, in the sense that they
will never have a bet unless they believe that the expected return on the bet is
positive. Thus assuming global risk aversion (and rational expectations) rules out
the existence of lotteries (except with large rollovers) and most other forms of
betting and gaming.
We can distinguish between local and global risk aversion. An individual is locally
risk averse at w if u′′(w) < 0 and globally risk averse if u′′(w) < 0 ∀w.
Individuals who gamble are not globally risk averse but may still be locally risk
averse around their current wealth level.
Cut and paste relevant quotes from Purﬁeld-Waldron papers in here.
Some people are more risk averse than others; some functions are more concave
than others; how do we measure this?
The importance and usefulness of the Arrow-Pratt measures of risk aversion which
we now deﬁne will become clearer as we proceed, in particular from the analysis
of the portfolio choice problem:
Deﬁnition 5.7.1 (The Arrow-Pratt coefﬁcient of) absolute risk aversion is:
RA(w) = −u′′(w)/u′(w)
which is the same for u and au + b.
Note that this varies with the level of wealth.
u′ (w) alone is meaningless, as u and u′ can be multiplied by any positive constant
and still represent the same preferences. However, the above ratio is independent
of the expected utility function chosen to represent the preferences.
Deﬁnition 5.7.2 (The Arrow-Pratt coefﬁcient of) relative risk aversion is:
RR(w) = wRA(w)
The utility function u exhibits increasing (constant, decreasing) absolute risk
aversion (IARA, CARA, DARA) ⇐⇒
R′
A (w) > (=, <) 0 ∀w.
The utility function u exhibits increasing (constant, decreasing) relative risk aver-
sion (IRRA, CRRA, DRRA) ⇐⇒
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
101
R′
R (w) > (=, <) 0 ∀w.
Note:
• CARA or IARA ⇒IRRA
• CRRA or DRRA ⇒DARA
Here are some examples of utility functions and their risk measures:
• Quadratic utility (IARA, IRRA):
u(w)
=
w −b
2w2,
b > 0;
u′(w)
=
1 −bw;
u′′(w)
=
−b < 0
RA(w)
=
b
1 −bw
dRA(w)
dw
=
b2
(1 −bw)2 > 0
In this case, marginal utility is positive and utility increasing if and only if
w < 1/b. 1/b is called the bliss point of the quadratic utility function. For
realism, 1/b should be rather large and thus b rather small.
• Negative exponential utility (CARA, IRRA):
u(w)
=
−e−bw,
b > 0;
u′(w)
=
be−bw > 0;
u′′(w)
=
−b2e−bw < 0
RA(w)
=
b
dRA(w)
dw
=
0
• Narrow power utility (CRRA, DARA):
u(w)
=
B
B −1w1−1
B , w > 0, B > 0, B ̸= 1
Revised: December 2, 1998

102
5.8. THE MEAN-VARIANCE PARADIGM
The proofs in this case are left as an exercise. The solution is roughly as
follows:4
u(z)
=
B
B −1z1−1
B , z > 0, B > 0
u′(z)
=
z−1
B
u′′(z)
=
−1
Bz−1
B −1
RA(z)
=
1
Bz−1
RR(z)
=
1
B
dRA(z)
dz
=
−1
Bz−2 < 0
dRR(z)
dz
=
0
• Extended power utility ():5
u (w) =
1
(C + 1) B (A + Bw)C+1
Note that a risk neutral investor will seek to invest his or her entire wealth in the
asset with the highest expected return. If all investors are risk neutral, then prices
will adjust in equilibrium so that all securities have the same expected return. If
there are risk averse or risk loving investors, then there is no reason for this result
to hold, and in fact it almost certainly will not.
5.8
The Mean-Variance Paradigm
Three arguments are commonly used to motivate the mean-variance framework
for analysis of the portfolio choice problem:
1. Taylor-approximated utility functions (see Section 2.8):
u( ˜W)
=
u(E[ ˜W]) + u′(E[ ˜W])( ˜W −E[ ˜W])
+
1
2u′′(E[ ˜W])( ˜W −E[ ˜W])2 + R3
(5.8.1)
R3
=
∞
X
n=3
1
n!u(n)(E[ ˜W])( ˜W −E[ ˜W])n
(5.8.2)
4Add comments: u′(w) > 0, u′′(w) < 0 and u′(w) →1/w as B →1, so that u(w) →ln w.
5Check ? for details of this one.
Revised: December 2, 1998

CHAPTER 5. CHOICE UNDER UNCERTAINTY
103
which implies:
E[u( ˜W)]
=
u(E[ ˜W]) + 1
2u′′(E[ ˜W])σ2( ˜W) + E[R3]
(5.8.3)
where
E[R3]
=
∞
X
n=3
1
n!u(n)(E[ ˜W])mn( ˜W)
(5.8.4)
It follows that the sign of the nth derivative of the utility function determines
the direction of preference for the nth central moment of the probability
distribution of terminal wealth. For example, a positive third derivative im-
plies a preference for greater skewness. It can be shown fairly easily that
an increasing utility function which exhibits non-increasing absolute risk
aversion has a non-negative third derivative.
2. Quadratic utility:
E[u( ˜W)]
=
E[ ˜W] −b
2E[ ˜W 2]
(5.8.5)
=
E[ ˜W] −b
2

(E[ ˜W])2 + σ2( ˜W)

(5.8.6)
=
u(E[ ˜W]) −b
2Var[ ˜W]
(5.8.7)
3. Normally distributed asset returns.
Note that the expected utility axioms are neither necessary nor sufﬁcient to guar-
antee that the Taylor approximation to n moments is a valid representation of the
utility function. Some counterexamples of both types are probably called for here,
or maybe can be left as exercises.
Extracts from my PhD thesis can be used to talk about signing the ﬁrst three
coefﬁcients in the Taylor expansion, and to speculate about further extensions to
higher moments.
5.9
The Kelly Strategy
In a multi-period, discrete time, investment framework, investors will be con-
cerned with both growth (return) and security (risk). There will be a trade-off
between the two, and investors will be concerned with ﬁnding the optimal trade-
off. This, of course, depends on preferences, but some useful benchmarks exist.
There are three ways of measuring growth:
1. the expected wealth at time t
Revised: December 2, 1998

104
5.10. ALTERNATIVE NON-EXPECTED UTILITY APPROACHES
2. the expected rate of growth of wealth up to time t
3. the expected ﬁrst passage time to reach a critical level of wealth, say £1m
Likewise, there are three ways of measuring security:
1. the probability of reaching a critical level of wealth, say £1m, by a speciﬁc
time t
2. the probability that the wealth process lies above some critical path, say
above bt at time t, t = 1, 2, . . .
3. the probability of reaching some goal U before falling to some low level of
wealth L
It can be shown that the ? strategy both maximises the long run exponential
growth rate and minimises the expected time to reach large goals.
All this is also covered in ? which is reproduced in ?.
5.10
Alternative Non-Expected Utility Approaches
Those not happy with the explanations of choice under uncertainty provided within
the expected utility paradigm have proposed various alternatives in recent years.
These include both vague qualitative wafﬂe about fun and addiction and more for-
mal approaches looking at maximum or minimum possible payoffs, irrational ex-
pectations, etc. Before proceeding, the reader might want to review Section 3.2.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
105
Chapter 6
PORTFOLIO THEORY
6.1
Introduction
Portfolio theory is an important topic in the theory of choice under uncertainty. It
deals with the problem facing an investor who must decide how to distribute an
initial wealth of, say, W0 among a number of single-period investment opportuni-
ties, called securities or assets.
The choice of portfolio will depend on both the investor’s preferences and his
beliefs about the uncertain payoffs of the various securities. A mutual fund is just
a special type of (managed) portfolio.
The chapter begins by considering some issues of deﬁnition and measurement.
Section 6.3 then looks at the portfolio choice problem in a general expected utility
context. Section 6.4 considers the same problem from a mean-variance perspec-
tive. This leads on to a discussion of the properties of equilibrium security returns
in Section 6.5.
6.2
Notation and preliminaries
6.2.1
Measuring rates of return
Good background reading for this section is ?.
A rate of interest (growth, inﬂation, &c.) is not properly deﬁned unless we state
the time period to which it applies and the method of compounding to be used.
2% per annum is very different from 2% per month.
Table 6.1 illustrates what happens to £100 invested at 10% per annum as we
change the interval of compounding. The ﬁnal calculation in the table uses the
Revised: December 2, 1998

106
6.2. NOTATION AND PRELIMINARIES
Compounded
Annually
£100
→
£110
Semi-annually
£100
→
£100 × (1.05)2 = £110.25
Quarterly
£100
→
£100 × (1.025)4 = £110.381. . .
Monthly
£100
→
£100 ×

1 + .10
12
12 = £110.471. ..
Weekly
£100
→
£100 ×

1 + .10
52
52 = £110.506. ..
Daily
£100
→
£100 ×

1 + .10
365
365 = £110.515. . .
Continuously
£100
→
£100 × e0.10 = £110.517. ..
Table 6.1: The effect of an interest rate of 10% per annum at different frequencies
of compounding.
fact that
lim
n→∞

1 + r
n
n
= er
where e ≈2.7182...
This is sometimes used as the deﬁnition of e but others prefer to start with
er ≡1 + r + r2
2! + r3
3! + . . . =
∞
X
j=0
rj
j!
where n! ≡n (n −1) (n −2) . . . 3.2.1 and 0! ≡1 by convention.
There are ﬁve concepts which we need to be familiar with:
1. Discrete compounding:
Pt =

1 + r
n
nt
P0.
We can solve this equation for any of ﬁve quantities given the other four:
(a) present value
(b) ﬁnal value
(c) implicit rate of return
(d) time
(e) interval of compounding
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
107
2. Continuous compounding:
Pt = ertP0.
We can solve this equation for any of four quantities given the other three
((a)–(d) above).
Note also that the exponential function is its own derivative; that y = 1+r is
the tangent to y = er at r = 0 and hence that er > 1 + r ∀r. In other words,
given an initial value, continuous compounding yields a higher terminal
value than discrete compounding for all interest rates, positive and negative,
with equality for a zero interest rate only. Similarly, given a ﬁnal value,
continuous discounting yields a higher present value than does discrete.
3. Aggregating and averaging returns across portfolios (˜rw = w⊤˜r) and over
time:
Pt
=
ertP0
Pt+∆t
=
er∆tPt
r
=
ln Pt+∆t −ln Pt
∆t
r(s)
=
d ln Ps
ds
Z t
0 r(s)ds
=
Z t
0 d ln Ps = ln Pt −ln P0
Pt
=
P0e
R t
0 r(s)ds
Discretely compounded rates aggregate nicely across portfolios; continu-
ously compounded rates aggregate nicely across time.
4. The (net) present value (NPV) of a stream of cash ﬂows,
P0, P1, . . . , PT
is
NPV (r) ≡
P0
(1 + r)0 +
P1
(1 + r)1 +
P2
(1 + r)2 + . . . +
PT
(1 + r)T .
5. The internal rate of return (IRR) of the stream of cash ﬂows,
P0, P1, . . . , PT,
is the solution of the polynomial of degree T obtained by setting the NPV
equal to zero:
P0
(1 + r)0 +
P1
(1 + r)1 +
P2
(1 + r)2 + . . . +
PT
(1 + r)T = 0.
Revised: December 2, 1998

108
6.2. NOTATION AND PRELIMINARIES
W0
=
the investor’s initial wealth
W1
=
the investor’s desired expected ﬁnal wealth
N
=
number of risky assets
rf
=
return on the riskfree asset
˜rj ∈ℜ
=
return on jth risky asset
˜r ∈ℜN
=
(˜r1, . . . , ˜rN)
e = E[˜r] ∈ℜN
=
vector of expected returns
V ∈ℜN×N
=
variance-covariance matrix of returns
1
=
(1, 1, . . . , 1)
=
N-dimensional vector of 1s
wj ∈ℜ
=
amount invested in jth risky asset
w ∈ℜN
=
(w1, . . . , wn)
˜rw = w⊤˜r
=
return on the portfolio w
µ ≡E[˜rw] ≡W1
W0 ∈ℜ
=
the investor’s desired expected return
Table 6.2: Notation for portfolio choice problem
In general, the polynomial deﬁning the IRR has T (complex) roots. Condi-
tions have been derived under which there is only one meaningful real root
to this polynomial equation, in other words one corresponding to a positive
IRR.1
Consider a quadratic example.
Simple rates of return are additive across portfolios, so we use them in one period
cross sectional studies, in particular in this chapter.
Continuously compounded rates of return are additive across time, so we use them
in multi-period single variable studies, such as in Chapter 7.
Consider as an example the problem of calculating mortgage repayments.
6.2.2
Notation
The investment opportunity set for the portfolio choice problem will generally
consist of N risky assets. From time to time, we will add a riskfree asset. The
notation used throughout this chapter is set out in Table 6.2. The presentation
is in terms of a single period problem, and the unconditional distribution of re-
turns. The analysis of the multiperiod, inﬁnite horizon, discrete time problem,
concentrating on the conditional distribution of the next period’s returns given
this period’s, is quite similar.2
1These conditions are discussed in ?.
2Make this into an exercise.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
109
Deﬁnition 6.2.1 w is said to be a unit cost or normal portfolio if its weights sum
to 1 (w⊤1 = 1).
The portfolio held by an investor with initial wealth W0 can be thought of either
as a w with w⊤1 = W0 or as the corresponding normal portfolio,
1
W0w. It will
hopefully be clear from the context which meaning of ‘portfolio’ is intended.
Deﬁnition 6.2.2 w is said to be a zero cost or hedge portfolio if its weights sum
to 0 (w⊤1 = 0).
The vector of net trades carried out by an investor moving from the portfolio w0
to the portfolio w1 can be thought of as the hedge portfolio w1 −w0.
Deﬁnition 6.2.3 Short-selling a security means owning a negative quantity of it.
In practice short-selling means promising (credibly) to pay someone the same cash
ﬂows as would be paid by a security that one does not own, always being prepared,
if required, to pay the current market price of the security to end the arrangement.
Thus when short-selling is allowed w can have negative components; if short-
selling is not allowed, then the portfolio choice problem will have non-negativity
constraints, wi ≥0 for i = 1, . . . , N.
A number of further comments are in order at this stage.
1. In the literature, initial wealth is often normalised to unity (W0 = 1), but
the development of the theory will be more elegant if we avoid this.
2. Since we will be dealing on occasion with hedge portfolios, we will in future
avoid the concepts of rate of return and net return, which are usually thought
of as the ratio of proﬁt to initial investment. These terms are meaningless
for a hedge portfolio as the denominator is zero.
Instead, we will speak of the gross return on a portfolio or the portfolio pay-
off. This can be deﬁned unambiguously as follows. There is no ambiguity
about the payoff on one of the original securities, which is just the gross
return per pound invested. The payoff on a unit cost or normal portfolio
is equivalent to the gross return. It is just w⊤˜r. The payoff on a zero cost
portfolio can also be deﬁned as w⊤˜r.
Note that where we initially worked with net rates of return ( P1
P0 −1), we
will deal henceforth with gross rates of return (P1
P0).
Revised: December 2, 1998

110
6.3. THE SINGLE-PERIOD PORTFOLIO CHOICE PROBLEM
6.3
The Single-period Portfolio Choice Problem
6.3.1
The canonical portfolio problem
Unless otherwise stated, we assume that individuals:
1. have von Neumann-Morgenstern (VNM) utilities:
i.e. preferences have the expected utility representation:
v(˜z)
=
E[u(˜z)]
=
Z
u(z)dF˜z(z)
where v is the utility function for random variables (gambles, lotteries)
and u is the utility function for sure things.
2. prefer more to less
i.e. u is increasing:
u ′(z) > 0 ∀z
(6.3.1)
3. are (strictly) risk-averse
i.e. u is strictly concave:
u ′′(z) < 0 ∀z
(6.3.2)
Date 0 investment:
• wj (pounds) in jth risky asset, j = 1, . . . , N
• (W0 −
P
j wj) in risk free asset
Date 1 payoff:
• wj˜rj from jth risky asset
• (W0 −
P
j wj)rf from risk free asset
It is assumed here that there are no constraints on short-selling or borrowing
(which is the same as short-selling the riskfree security).
The solution is found as follows:
Choose wjs to maximize expected utility of date 1 wealth,
˜W
=
(W0 −
X
j
wj)rf +
X
j
wj˜rj
=
W0rf +
X
j
wj(˜rj −rf)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
111
i.e.
max
{wj} f (w1, . . . , wN) ≡E[u(W0rf +
X
j
wj(˜rj −rf))]
The ﬁrst order conditions are:
E[u′( ˜W)(˜rj −rf)] = 0
∀j.
(6.3.3)
The Hessian matrix of the objective function is:
A ≡E
h
u′′  ˜W

(˜r −rf1) (˜r −rf1)⊤i
.
(6.3.4)
h⊤Ah < 0 ∀h ̸= 0N if and only if u′′ < 0. Since we have assumed that investor
behaviour is risk averse, A is a negative deﬁnite matrix and, by Theorem 3.2.4,
f is a strictly concave (and hence strictly quasiconcave) function. Thus, under
the present assumptions, Theorems 3.3.3 and 3.3.4 guarantee that the ﬁrst order
conditions have a unique solution. The trivial case in which the random returns
are not really random at all can be ignored.
The rest of this section should be omitted until I ﬁgure out what is going on.
Another way of writing (6.3.3) is:
E[u′( ˜W)˜rj] = E[u′( ˜W)]rf
∀j,
(6.3.5)
or
Cov
h
u′( ˜W), ˜rj
i
+ E[u′( ˜W)]E[˜rj] = E[u′( ˜W)]rf
∀j,
(6.3.6)
or
E[˜rj −rf] =
Cov
h
u′( ˜W), ˜rj
i
E[u′( ˜W)]
∀j,
(6.3.7)
Suppose pj is the price of the random payoff ˜xj. Then ˜rj = ˜xj
pj and
pj = E
"
u′( ˜W)
E[u′( ˜W)]rf
˜xj
#
∀j.
(6.3.8)
In other words, payoffs are valued by taking their expected present value, using
the stochastic discount factor
u′( ˜
W)
E[u′( ˜
W)]rf , which ends up being the same for all
investors. Practical corporate ﬁnance and theoretical asset pricing models to a
large extent are (or should be) concerned with analysing this discount factor.
(We could consider here the explicit example with quadratic utility from the prob-
lem sets.)
Revised: December 2, 1998

112
6.3. THE SINGLE-PERIOD PORTFOLIO CHOICE PROBLEM
6.3.2
Risk aversion and portfolio composition
For the moment, assume only one risky asset (N = 1).
We ﬁrst consider the concept of local risk neutrality. The optimal investment in
the risky asset is positive
⇐⇒
The objective function is increasing at a = 0
⇐⇒
f ′ (a) > 0
(6.3.9)
⇐⇒
E[u′ (W0rf) (˜r −rf)] > 0
(6.3.10)
⇐⇒
u′ (W0rf) E[(˜r −rf)] > 0
(6.3.11)
⇐⇒
E[˜r] > E[rf] = rf
This is the property of local risk neutrality — a risk averse investor will always
prefer a little of a risky asset paying a higher expected return than rf to none of
the risky asset.
Deﬁnition 6.3.1 Let f: X →ℜ++ be a positive-valued function deﬁned on X ⊆
ℜk
++. Then the elasticity of f with respect to xi at x∗is
x∗
i
f (x)
∂f
∂xi
(x∗) .
Roughly speaking, the elasticity is just
∂ln f
∂ln xi, or the slope of the graph of the
function on log-log graph paper.
A function is said to be inelastic when the absolute value of the elasticity is less
than unity; and elastic when the absolute value of the elasticity is greater than
unity. The borderline case is called a unit elastic function.
One useful application of elasticity is in analysing the behaviour of the total rev-
enue function associated with a particular inverse demand function, P(Q). We
have:
dP (Q) Q
dQ
=
qdP
dQ + P
(6.3.12)
=
P
 
1 + 1
η
!
.
(6.3.13)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
113
Hence, total revenue is constant or maximised or minimised where elasticity equals
−1; increasing when elasticity is less than −1 (demand is elastic); and decreasing
when elasticity is between 0 and −1 (demand is inelastic).
Now consider other properties of asset demands (assuming that E [˜r] > rf):
• DARA ⇒risky asset normal

da
dW0 > 0

• CARA ⇒

da
dW0 = 0

• IARA ⇒risky asset inferior

da
dW0 < 0

Deﬁne the wealth elasticity of demand for the risky asset to be
η = W0
a
da
dW0
.
(6.3.14)
Then we have
d

a
W0

dW0
=
W0
da
dW0 −a
W 2
0
=
a
W 2
0
(η −1) .
Note that
sign
 d a
W0
dW0
!
= sign (η −1)
(6.3.15)
since by assuming a positive expected risk premium on the risky asset we guaran-
tee (by local risk-neutrality) that a is positive.
• DRRA ⇒increasing proportion of wealth invested in the risky asset (η > 1)
• CRRA ⇒constant proportion of wealth invested in the risky asset (η = 1)
• IRRA ⇒decreasing proportion of wealth invested in the risky asset (η < 1)
Theorem 6.3.1 DARA ⇒RISKY ASSET NORMAL
Proof By implicit differentiation of the now familiar ﬁrst order condition (6.3.3),
which can be written:
E[u′(W0rf + a(˜r −rf))(˜r −rf)] = 0,
(6.3.16)
we have
da
dW0
= E[u′′( ˜W)(˜r −rf)]rf
−E[u′′( ˜W)(˜r −rf)2].
(6.3.17)
Revised: December 2, 1998

114
6.3. THE SINGLE-PERIOD PORTFOLIO CHOICE PROBLEM
By concavity, the denominator is positive. Therefore:
sign (da/dW0) = sign {E[u′′( ˜W)(˜r −rf)]}
(6.3.18)
We will show that both are positive.
For decreasing absolute risk aversion:3
˜r > rf
⇒
RA( ˜W) < RA(W0rf)
˜r ≤rf
⇒
RA( ˜W) ≥RA(W0rf)
Multiplying both sides of each inequality by −u′( ˜W)(˜r −rf) gives respectively:
u′′( ˜W)(˜r −rf) > −RA(W0rf)u′( ˜W)(˜r −rf)
(6.3.19)
in the event that ˜r > rf, and
u′′( ˜W)(˜r −rf) ≥−RA(W0rf)u′( ˜W)(˜r −rf)
(6.3.20)
(the same result) in the event that ˜r ≤rf
Integrating over both events implies:
E[u′′( ˜W)(˜r −rf)] > −RA(W0rf)E[u′( ˜W)(˜r −rf)],
(6.3.21)
provided that ˜r > rf with positive probability.
The RHS of inequality (6.3.21) is 0 at the optimum, hence the LHS is positive as
claimed.
Q.E.D.
The other results are proved similarly (exercise!).
6.3.3
Mutual fund separation
Commonly, investors delegate portfolio choice to mutual fund operators or man-
agers. We are interested in conditions under which large groups of investors will
agree on portfolio composition. For example, all investors with similar utility
functions might choose the same portfolio, or all investors with similar probabil-
ity beliefs might choose the same portfolio. More realistically, we may be able to
deﬁne a group of investors whose portfolio choices all lie in a subspace of small
dimension (say 2) of the N-dimensional portfolio space. The ﬁrst such result is
due to ?.
3Think about whether separating out the case of ˜r = rf is necessary.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
115
Theorem 6.3.2 ∃Two fund monetary separation
i.e. Agents with different wealths (but the same increasing, strictly concave, VNM
utility) hold the same risky unit cost portfolio, p∗say, (but may differ in the mix of
the riskfree asset and risky portfolio)
i.e. ∀portfolios p, wealths W0, ∃λ s.t.
E
h
u

W0rf + λW0p∗⊤(˜r −rf1)
i
≥E
h
u

W0rf + p⊤(˜r −rf1)
i
(6.3.22)
⇐⇒
Risk-tolerance (1/RA(z)) is linear (including constant)
i.e. ∃Hyperbolic Absolute Risk Aversion (HARA, incl. CARA)
i.e. the utility function is of one of these types:
• Extended power: u(z) =
1
(C+1)B(A + Bz)C+1
• Logarithmic: u(z) = ln(A + Bz)
• Negative exponential: u(z) = −A
B exp{Bz}
where A, B and C are chosen to guarantee u′ > 0, u′′ < 0.
i.e. marginal utility satisﬁes
u′(z) = (A + Bz)C
or
u′(z) = A exp{Bz}
(6.3.23)
where A, B and C are again chosen to guarantee u′ > 0, u′′ < 0.
Proof The proof that these conditions are necessary for two fund separation is
difﬁcult and tedious. The interested reader is referred to ?.
We will show that u′(z) = (A + Bz)C is sufﬁcient for two-fund separation.
The optimal dollar investments wj are the unique solution to the ﬁrst order condi-
tions:
0
=
E[u′( ˜W)δ ˜W
δwi
]
(6.3.24)
=
E[(A + B ˜W)C(˜ri −rf)]
(6.3.25)
=
E[(A + BW0rf +
X
j
Bwj(˜rj −rf))C(˜ri −rf)],
(6.3.26)
or equivalently to the system of equations
E[(1 +
X
j
Bwj
A + BW0rf
(˜rj −rf))C(˜ri −rf)] = 0
(6.3.27)
Revised: December 2, 1998

116
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
or
E[(1 +
X
j
xj(˜rj −rf))C(˜ri −rf)] = 0
(6.3.28)
where
xj =
Bwj
A + BW0rf
.
The unique solutions for xj are clearly independent of W0 which does not appear
in (6.3.28).
Since A and B do not appear either, the unique solutions for xj are also indepen-
dent of those parameters.
However, they do depend on C.
But the risky portfolio weights are
wi
P
j wj
=
Bwi/(A + BW0rf)
P
j Bwj/(A + BW0rf)
(6.3.29)
=
xi
P
j xj
(6.3.30)
and so are also independent of initial wealth.
Since the dollar investment in the jth risky asset satisﬁes:
wj = xj(A
B + W0rf)
(6.3.31)
we also have in this case that the dollar investment in the common risky portfolio
is a linear function of the initial wealth. The other sufﬁciency proofs are similar
and are left as exercises.
Q.E.D.
Some humorous anecdotes about Cass may now follow.
6.4
Mathematics of the Portfolio Frontier
6.4.1
The portfolio frontier in ℜN:
risky assets only
The portfolio frontier
Deﬁnition 6.4.1 The (mean-variance) portfolio frontier is the set of solutions to
the mean-variance portfolio choice problem faced by a (risk-averse) investor with
an initial wealth of W0 who desires an expected ﬁnal wealth of at least W1 ≡µW0
(or, equivalently, an expected rate of return of µ), but with the smallest possible
variance of ﬁnal wealth.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
117
The mean-variance frontier can also be called the two-moment portfolio frontier,
in recognition of the fact that the same approach can be extended (with difﬁculty)
to higher moments.
The mean-variance portfolio frontier is a subset of the portfolio space, which is
just ℜN. However, introductory treatments generally present it (without proof) as
the envelope function, in mean-variance space or mean-standard deviation space
(ℜ+ × ℜ), of the variance minimisation problem.
Deﬁnition 6.4.2 w is a frontier portfolio
⇐⇒
its return has the minimum variance among all portfolios that have the same cost,
w⊤1, and the same expected payoff, w⊤e.
We will begin by supposing that all assets are risky. Formally, the frontier port-
folio corresponding to initial wealth W0 and expected return µ (expected terminal
wealth µW0) is the solution to the quadratic programming problem:
min
w w⊤Vw
(6.4.1)
subject to the linear constraints:
w⊤1
=
W0
(6.4.2)
and
w⊤e
≥
W1 = µW0.
(6.4.3)
The ﬁrst constraint is just the budget constraint, while the second constraint states
that the expected rate of return on the portfolio is at least the desired mean return
µ.
The frontier in this case is the set of solutions for all values of W0 and W1 (or µ) to
this variance minimisation problem, or to the equivalent maximisation problem:
max
w −w⊤Vw
(6.4.4)
subject to the same linear constraints (6.4.2) and (6.4.3).
The properties of this two-moment frontier are well known, and can be found,
for example, in ? or ?. The notation here follows ?. The derivation of the mean-
variance frontier is generally presented in the literature in terms of portfolio weight
vectors or, equivalently, assuming that initial wealth, W0, equals 1. This assump-
tion is not essential and will be avoided.
Revised: December 2, 1998

118
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
The solution
The inequality constrained maximisation problem (6.4.4) is just a special case
of the canonical quadratic programming problem considered at the end of Sec-
tion 3.5, except that it has explicitly one equality constraint and one inequality
constraint.
To avoid degeneracies, we require:
1. that not every portfolio has the same expected return, i.e.
e ̸= E[˜r1]1,
(6.4.5)
and in particular that N > 1.
2. that the variance-covariance matrix, V, is (strictly) positive deﬁnite. We
already know from (1.12.4) that V must be positive semi-deﬁnite, but we
require this slightly stronger condition. To see why, suppose
∃w ̸= 0N s.t. w⊤Vw = 0
(6.4.6)
Then ∃a portfolio whose return w⊤˜r = ˜rw has zero variance.
This implies that ˜rw = r0 (say) w.p.1 or, essentially, that this portfolio is
riskless.
Arbitrage will force the returns on all riskless assets to be equal in equilib-
rium, so this situation is equivalent economically to the introduction of a
riskless asset later.
In the portfolio problem, the place of the matrix A in the canonical quadratic
programming problem is taken by the (symmetric) negative deﬁnite matrix, −V,
which is just the negative of the variance-covariance matrix of asset returns; g1 =
1⊤and α1 = W0; and g2 = e⊤and α2 = W1. (6.4.5) guarantees that the 2 × N
matrix G is of full rank 2.
The parallels are a little fuzzy in the case of the budget constraint since it is really
an equality constraint.
(3.5.39) says that the optimal w is a linear combination of the two columns of the
N × 2 matrix
V−1G⊤
GV−1G⊤−1 ,
with columns weighted by initial wealth W0 and expected ﬁnal wealth, W1.
We will call these columns g and h and write the solution as
w = W0g + W1h = W0 (g + µh) .
(6.4.7)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
119
The components of g and h are functions of the means and variances of security
returns. Thus the vector of optimal portfolio proportions,
1
W0
w = g + µh,
(6.4.8)
is independent of the initial wealth W0.
It is easy to see the economic interpretation of g and h:
• g is the frontier portfolio corresponding to W0 = 1 and W1 = 0. In other
words, it is the normal portfolio which would be held by an investor whose
objective was to (just) go bankrupt with minimum variance.
• Similarly, h is the frontier portfolio corresponding to W0 = 0 and W1 = 1.
In other words, it is the hedge portfolio which would be purchased by a
variance-minimising investor in order to increase his expected ﬁnal wealth
by one unit.
Alternatively, (3.5.35) says that the optimal w is a linear combination of the two
columns of the N × 2 matrix
1
2V−1G⊤=

1
2V−11
1
2V−1e

,
with columns weighted by the Lagrange multipliers corresponding to the two con-
straints. We will call the Lagrange multipliers 2γ/C and 2λ/A respectively, where
we deﬁne:
A
≡
1⊤V−1e = e⊤V−11
(6.4.9)
B
≡
e⊤V−1e > 0
(6.4.10)
C
≡
1⊤V−11 > 0
(6.4.11)
and
D
≡
BC −A2
(6.4.12)
and the inequalities follow from the fact that V−1 (like V) is positive deﬁnite.
This allows the solution to be written as:
w = γ
C (V−11) + λ
A(V−1e).
(6.4.13)
1
C(V−11) and 1
A(V−1e) are both unit portfolios, so γ + λ = W0. We know that
for the portfolio which minimises variance for a given initial wealth, regardless
of expected ﬁnal wealth, the corresponding Lagrange multiplier, λ = 0. Thus
γ
C(V−11) is the global minimum variance portfolio with cost W0 (which in fact
Revised: December 2, 1998

120
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
equals γ in this case) and
1
C(V−11) is the global minimum variance unit cost
portfolio, which we will denote wMVP.
In fact, we can combine (6.4.7) and (6.4.13) and write the solution as:
w = W0

wMVP +

µ −A
C

h

.
(6.4.14)
The details are left as an exercise.4
The set of solutions to this quadratic programming problem for all possible (W0, W1)
combinations (including negative W0) is the vector subspace of the portfolio space,
which is generated either by the vectors g and h or by the vectors wMVP and h (or
by any pair of linearly independent frontier portfolios).
In ℜN, the set of unit cost frontier portfolios is the line passing thru g, parallel to
h.
It follows immediately that the frontier (like any straight line in ℜN) is a convex
set, and can be generated by linear combinations of any pair of frontier portfolios
with weights of the form α and (1 −α).
An important exercise at this stage is to work out the means, variances and co-
variances of the returns on wMVP, g and h. They will drop out of the portfolio
decomposition below.
The portfolio weight vectors g and h are
g
=
1
D[B(V−11) −A(V−1e)]
(6.4.15)
h
=
1
D[C(V−1e) −A(V−11)]
(6.4.16)
We have
Var[˜rg]
=
g⊤Vg = B
D
(6.4.17)
Var[˜rh]
=
h⊤Vh = C
D
(6.4.18)
from which it follows that D > 0.
Orthogonal decomposition of portfolios
At this stage, we must introduce a scalar product on the portfolio space, namely
that based on the variance-covariance matrix V. Since V is a non-singular, pos-
itive deﬁnite matrix, it deﬁnes a well behaved scalar product and all the standard
results on orthogonal projection (&c.) from linear algebra are valid.
4At least for now.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
121
Two portfolios w1 and w2 are orthogonal with respect to this scalar product
⇐⇒
w⊤
1 Vw2 = 0
⇐⇒
Cov
h
w⊤
1 ˜r, w⊤
2 ˜r
i
= 0
⇐⇒
the random variables representing the returns on the portfolios are uncorrelated.
Thus, the terms ‘orthogonal’ and ‘uncorrelated’ may legitimately, and shall, be
applied interchangeably to pairs of portfolios. Furthermore, the squared length of
a weight vector corresponds to the variance of its returns.
Note that wMVP and h are orthogonal vectors in this sense. In fact, we have the
following theorem:
Theorem 6.4.1 If w is a frontier portfolio and u is a zero mean hedge portfolio,
then w and u are uncorrelated.
Proof There is probably a full version of this proof lost somewhere but the fol-
lowing can be sorted out.
Since wMVP is collinear with V−11, it is orthogonal to all portfolios w for which
w⊤VV−11 = 0 or in other words to all portfolios for which w⊤1 = 0. But these
are precisely all hedge portfolios, including h.
Similarly, any portfolio collinear with V−1e is orthogonal to all portfolios with
zero expected return, since w⊤VV−1e = 0 or in other words w⊤e = 0.
Q.E.D.
Some pictures are in order at this stage.
For N = 3, in the set of portfolios costing W0 (the W0 simplex), the iso-variance
curves are concentric ellipses, the iso-mean curves are parallel lines, and the solu-
tions for different µs (or W1s) are the tangency points between these ellipses and
lines, which themselves lie on a line orthogonal (in the sense deﬁned above) to
the iso-mean lines. The centre of the concentric ellipses is at the global minimum
variance portfolio corresponding to W0, W0wMVP. A similar geometric interpre-
tation can be applied in higher dimensions.
? has some nice pictures of the frontier in portfolio space, as opposed to mean-
variance space.
At this stage, recall the deﬁnition of β in (5.2.2).
We will now derive an orthogonal decomposition of a portfolio q into two frontier
portfolios and a zero-mean zero-cost portfolio and prove that the coefﬁcients on
the two frontier portfolios are the βs of q with respect to those portfolios and sum
to unity.
We can always choose an orthogonal basis for the portfolio frontier.
Revised: December 2, 1998

122
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
For any frontier portfolio p ̸= wMVP, there is a unique unit cost frontier portfolio
zp which is orthogonal to p.
Another important exercise is to ﬁgure out the relationship between E [˜rp] and
E
h
˜rzp
i
.
Any two frontier portfolios span the frontier, in particular any unit cost p ̸= wMVP
and zp (or the original basis, wMVP and h).
Any (frontier or non-frontier) portfolio q with non-zero cost W0 can be written in
the form fq + uq where
fq
≡
W0 (g + E[˜rq]h)
(6.4.19)
=
W0 (βqpp + (1 −βqp)zp) (say)
(6.4.20)
is the frontier portfolio with expected return E[˜rq] and cost W0 and uq is a hedge
portfolio with zero expected return. Geometrically, this decomposition is equiva-
lent to the orthogonal projection of q onto the frontier.
Theorem 6.4.1 shown that any portfolio sharing these properties of uq is uncorre-
lated with all frontier portfolios.5
If p is a unit cost frontier portfolio (i.e. the vector of portfolio proportions) and
q is an arbitrary unit cost portfolio, then the following decomposition therefore
holds:
q = fq + uq = βqpp + (1 −βqp) zp + uq
(6.4.21)
where the three components (i.e. the vectors p, zp and uq) are mutually orthogo-
nal.
We can extend this decomposition to cover
1. portfolio proportions (orthogonal vectors)
2. portfolio proportions (scalars/components)
3. returns (uncorrelated random variables)
4. expected returns (numbers)
Note again the parallel between orthogonal portfolio vectors and uncorrelated
portfolio returns/payoffs.
We will now derive the relation:
E[˜rq] −E[˜rzp] = βqp(E[˜rp] −E[˜rzp])
(6.4.22)
5Aside: For the frontier portfolio fq to second degree stochastically dominate the arbitrary
portfolio q, we will need zero conditional expected return on uq, and will have to show that
Cov

˜ruq, ˜rfq

= 0 =⇒E[˜ruq|˜rfq] = 0
The normal distribution is the only case where this is true.
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
123
which may be familiar from earlier courses in ﬁnancial economics and which is
quite general and neither requires asset returns to be normally distributed nor any
assumptions about preferences.
Since Cov
h
˜ruq, ˜rp
i
= Cov
h
˜rzp, ˜rp
i
= 0, taking covariances with ˜rp in (6.4.21)
gives:
Cov [˜rq, ˜rp] = Cov
h
˜rfq, ˜rp
i
= βqpVar[˜rp]
(6.4.23)
or
βqp = Cov [˜rq, ˜rp]
Var[˜rp]
(6.4.24)
Thus β in (6.4.21) has its usual deﬁnition from probability theory, given by (5.2.2).6
Reversing the roles of p and zp, it can be seen that
βqzp = 1 −βqp
(6.4.25)
Taking expected returns in (6.4.21) yields again:
E[˜rq] = βqpE[˜rp] + (1 −βqp)E[˜rzp],
(6.4.26)
which can be rearranged to obtain (6.4.22).
The Global Minimum Variance Portfolio
Var[˜rg+µh] = g⊤Vg + 2µ(g⊤Vh) + µ2(h⊤Vh)
(6.4.27)
which has its minimum at
µ = −g⊤Vh
h⊤Vh
(6.4.28)
The latter expression reduces to A/C and the minimum value of the variance is
1/C. The global minimum variance portfolio is denoted MVP.
Cov [˜rh, ˜rMVP]
=
h⊤V
 
g −g⊤Vh
h⊤Vhh
!
(6.4.29)
=
h⊤Vg −g⊤Vh.h⊤Vh
h⊤Vh
= 0
(6.4.30)
i.e. the returns on the portfolio with weights h and the minimum variance portfolio
are uncorrelated.
6Assign some problems involving the construction of portfolio proportions for various desired
βs. Also problems working from prices for state contingent claims to returns on assets and port-
folios in both single period and multi-period worlds.
Revised: December 2, 1998

124
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
Further, if p is any portfolio, the MVP is the minimum variance combination of
itself and p, i.e. a = 0 solves:
min
a
1
2Var[˜rap+(1−a)MVP]
(6.4.31)
which has necessary and sufﬁcient ﬁrst order condition:
aVar[˜rp] + (1 −2a)Cov [˜rp, ˜rMVP] −(1 −a)Var[˜rMVP] = 0
(6.4.32)
Hence, setting a = 0:
Cov [˜rp, ˜rMVP] −Var[˜rMVP] = 0
(6.4.33)
and the covariance of any portfolio with MVP is 1/C.
6.4.2
The portfolio frontier in mean-variance space:
risky assets only
The portfolio frontier in mean-variance and in mean-standard deviation space
We now move on to consider the mean-variance relationship along the portfolio
frontier.
The mean, µ, and variance, σ2, of the rate of return associated with each point on
the frontier are related by the quadratic equation:
(σ2 −Var[w⊤
MVP˜r]) = φ(µ −E[w⊤
MVP˜r])2,
(6.4.34)
where the shape parameter φ = C/D represents the variance of the (gross) return
on the hedge portfolio, h. The two-moment frontier is generally presented as the
graph in mean-variance space of this parabola, showing the most desirable distri-
butions attainable, but the frontier can also be thought of as a plane in portfolio
space or as a line in portfolio weight space. The latter interpretations are far more
useful when it comes to extending the analysis to higher moments.
The equations of the frontier in mean-variance and mean-standard deviation space
can be derived heuristically using the following stylized diagram illustrating the
portfolio decomposition.
Figure 3A goes here.
Applying Pythagoras’ theorem to the triangle with vertices at 0, p and MVP yields:
σ2 = Var[˜rp] = Var[˜rMVP] +

µ −A
C
2
Var[˜rh]
(6.4.35)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
125
Recall from the coordinate geometry of conic sections that
Var[˜rp] = Var[˜rMVP] + (µ −E[˜rMVP])2 Var[˜rh]
(6.4.36)
or
V (µ) = 1
C + C
D

µ −A
C
2
(6.4.37)
is a quadratic equation in µ.
i.e. the equation of the parabola with vertex at
Var[˜rp]
=
Var[˜rMVP] = 1
C
(6.4.38)
µ
=
E[˜rMVP] = A
C
(6.4.39)
Thus in mean-variance space, the frontier is a parabola.
Figure 3.11.2 goes here: indicate position of g on ﬁgure.
Similarly, in mean-standard deviation space, the frontier is a hyperbola. To see
this, recall that:
σ2 = Var[˜rMVP] +

µ −A
C
2
Var[˜rh]
(6.4.40)
is the equation of the hyperbola with vertex at
σ
=
q
Var[˜rMVP] =
s
1
C
(6.4.41)
µ
=
A
C
(6.4.42)
centre at σ = 0, µ = A/C and asymptotes as indicated.
Figure 3.11.1 goes here: indicate position of g on ﬁgure.
The other half of the hyperbola (σ < 0) has no economic meaning.
Recall two other types of conic sections:
Var[˜rh] < 0 (impossible) gives a circle with center (1/C, A/C).
Var[˜rMVP] = 0 (the presence of a riskless asset) allows the square root to be taken
on both sides:
σ = ±

µ −A
C
 q
Var[˜rh]
(6.4.43)
i.e. the conic section becomes the pair of lines which are its asymptotes otherwise.
Revised: December 2, 1998

126
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
Portfolios on which the expected return, µ, exceeds w⊤
MVPe are termed efﬁcient,
since they maximise expected return given variance; other frontier portfolios min-
imise expected return given variance and are inefﬁcient.
A frontier portfolio is said to be an efﬁcient portfolio iff
its expected return exceeds the minimum variance expected return A/C = E[˜rMVP].
The set of efﬁcient portfolios in ℜN (or efﬁcient frontier) is the half-line emanat-
ing from MVP in the direction of h, and hence is also a convex set.
Convex combinations (but not all linear combinations with weights summing to
1) of efﬁcient portfolios are efﬁcient.
We now consider zero-covariance (zero-beta) portfolios. In portfolio weight space,
can easily construct a frontier portfolio having zero covariance with any given
frontier portfolio:
Figure 3B goes here.
Algebraically, the expected return µ0 on the zero-covariance frontier portfolio of
a frontier portfolio with expected return µ solves:
Cov [˜rMVP + (µ −E[˜rMVP])˜rh, ˜rMVP + (µ0 −E[˜rMVP])˜rh] = 0
(6.4.44)
or, since ˜rh and ˜rMVP are uncorrelated:
Var[˜rMVP] + (µ −E[˜rMVP])(µ0 −E[˜rMVP])Var[˜rh] = 0
(6.4.45)
To make this true, we must have
(µ −E[˜rMVP])(µ0 −E[˜rMVP]) < 0
(6.4.46)
or µ and µ0 on opposite sides of E[˜rMVP] as shown.
There is a neat trick which allows zero-covariance portfolios to be plotted in mean-
standard deviation space.
Implicit differentiation of the µ−σ relationship (6.4.35) along the frontier yields:
dµ
dσ =
σ
(µ −E[˜rMVP])Var[˜rh]
(6.4.47)
so the tangent at (σ, µ) intercepts the µ axis at
µ −σdµ
dσ
=
µ −
σ2
(µ −E[˜rMVP])Var[˜rh]
(6.4.48)
=
µ −
Var[˜rMVP]
(µ −E[˜rMVP])Var[˜rh] −(µ −E[˜rMVP])
(6.4.49)
=
E[˜rMVP] −
Var[˜rMVP]
(µ −E[˜rMVP])Var[˜rh]
(6.4.50)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
127
where we substituted for σ2 from the deﬁnition of the frontier.
A little rearrangement shows that expression (6.4.50) satisﬁes the equation (6.4.45)
deﬁning the return on the zero-covariance portfolio.
In mean-standard deviation space the picture is like this:
Figure 3.15.1 goes here.
To ﬁnd zp in mean-variance space, note that the line joining (σ2, µ) to the MVP
intercepts the µ axis at:
µ −σ2 µ −E[˜rMVP]
σ2 −Var[˜rMVP] = µ −σ2
µ −E[˜rMVP]
(µ −E[˜rMVP)2Var[˜rh]
(6.4.51)
After cancellation, this is exactly the ﬁrst expression (6.4.48) for the zero-covariance
return we had on the previous page.
Figure 3.15.2 goes here.
Alternative derivations
The treatment of the portfolio frontier with risky assets only concludes with some
alternative derivations following closely ?. They should probably be omitted alto-
gether at this stage.
1. The variance minimisation solution from ﬁrst principles.
It can be seen that w is the solution to:
min
{w,,} L = 1
2w⊤Vw + λ(µ −w⊤e) + γ(W0 −w⊤1)
(6.4.52)
which has necessary and sufﬁcient ﬁrst order conditions:
∂L
∂w
=
Vw −λe −γ1 = 0
(6.4.53)
∂L
∂λ
=
µ −w⊤e = 0
(6.4.54)
∂L
∂γ
=
W0 −w⊤1 = 0
(6.4.55)
The solution can be found by premultiplying the FOC (6.4.13) in turn by
e⊤and 1⊤and using the constraints yields:
µ
=
λ(e⊤V−1e) + γ(e⊤V−11)
(6.4.56)
1
=
λ(1⊤V−1e) + γ(1⊤V−11)
(6.4.57)
Revised: December 2, 1998

128
6.4. MATHEMATICS OF THE PORTFOLIO FRONTIER
The solutions for λ and γ are:
λ
=
Cµ −A
D
(6.4.58)
γ
=
B −Aµ
D
(6.4.59)
2. Derivation of (6.4.22).
If we only have frontier portfolio p and interior portfolio q, we get a frontier
(in µ-σ space) entirely within the previous frontier and tangent to it at p.
The frontiers must have the same slope at p:
Figure 3C goes here.
We already saw that the outer frontier has slope
E[˜rp−˜rzp]
√
Var[˜rp] .
At the point on the inner frontier with wq invested in q and (1 −wq) in p,
µ
=
E[˜rp] + wq(E[˜rq −˜rp])
(6.4.60)
σ2
=
w2
qVar[˜rq]
+2wq(1 −wq)Cov [˜rp, ˜rq] + (1 −wq)2Var[˜rp] (6.4.61)
Differentiating these w.r.t. wq:
dµ
dwq
=
E[˜rq −˜rp]
(6.4.62)
2σ dσ
dwq
=
2wqVar[˜rq]
+2(1 −2wq)Cov [˜rp, ˜rq] −2(1 −wq)Var[˜rp](6.4.63)
Taking the ratio and setting wq = 0 gives the slope of the inner frontier at
p:
dµ
dσ =
E[˜rq −˜rp]
2Cov[˜rp,˜rq]−2Var[˜rp]
2√
Var[˜rp]
(6.4.64)
Equating this to the slope of the outer frontier, setting
βqp = Cov [˜rp, ˜rq]
Var[˜rp]
(6.4.65)
and rearranging yields:
E[˜rq] −E[˜rzp] = βqp(E[˜rp] −E[˜rzp])
(6.4.66)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
129
6.4.3
The portfolio frontier in ℜN:
riskfree and risky assets
We now consider the mathematics of the portfolio frontier when there is a riskfree
asset.
In this case, the frontier portfolio solves:
min
w
1
2 w⊤Vw
(6.4.67)
s.t.
w⊤e + (1 −w⊤1)rf = µ
(6.4.68)
There is no longer a restriction on portfolio weights, and whatever is not invested
in the N risky assets is assumed to be invested in the riskless asset.
The solution (which can be left as an exercise) is by a similar method to the case
where all assets were risky:
wp = V−1(e −rf1)µ −rf
H
(6.4.69)
where
H = (e −1rf)⊤V−1(e −1rf) = B −2Arf + Crf
2 > 0 ∀rf
(6.4.70)
Along the frontier, we have:
σ =



µ−rf
√
H
if µ ≥rf,
−µ−rf
√
H
if µ < rf,
(6.4.71)
6.4.4
The portfolio frontier in mean-variance space:
riskfree and risky assets
We can now establish the shape of the mean-standard deviation frontier with a
riskless asset.
Graphically, in mean-standard deviation space, combining any portfolio p with
the riskless asset in proportions a and (1 −a) gives a portfolio with expected
return
aE[˜rp] + (1 −a)rf = rf + a(E[˜rp] −rf)
and standard deviation of returns a
q
Var[˜rp].
i.e. these portfolios trace out the ray in σ-µ space emanating from (0, rf) and
passing through p.
For each σ the highest return attainable is along the ray from rf which is tangent
to the frontier generated by the risky assets.
Revised: December 2, 1998

130
6.5. MARKET EQUILIBRIUM AND THE CAPM
On this ray, the riskless asset is held in combination with the tangency portfolio t.
This only makes sense for rf < A/C = E[˜rmvp].
Above t, there is a negative weight on the riskless asset — i.e. borrowing.
Figure 3D goes here.
Limited borrowing
Unlimited borrowing as allowed in the preceding analysis is unrealistic.
Consider what happens
1. with margin constraints on borrowing:
Figure 3E goes here.
The frontier is the envelope of all the ﬁnite rays through risky portfolios,
extending as far as the borrowing constraint allows.
2. with differential borrowing and lending rates:
Figure 3F goes here.
There is a range of expected returns over which a pure risky strategy pro-
vides minimum variance;
lower expected returns are achieved by riskless lending;
and higher expected returns are achieved by riskless borrowing.
6.5
Market Equilibrium and the Capital Asset Pric-
ing Model
6.5.1
Pricing assets and predicting security returns
Need more wafﬂe here about prediction and the difﬁculties thereof and the prop-
erties of equilibrium prices and returns.
We are looking for assumptions concerning probability distributions that lead to
useful and parsimonious asset pricing models. The CAPM restrictions are the
best known. At a very basic level, they can be expressed by saying that every
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
131
investor has mean-variance preferences. This can be achieved either by restricting
preferences to be quadratic or the probability distribution of asset returns to be
normal. CAPM is basically a single-period model, but can be extended by assum-
ing that return distributions are stable over time. ? and ? have generalised the
distributional conditions.
Recall also the limiting behaviour of the variance of the return on an equally
weighted portfolio as the number of securities included goes to inﬁnity. If se-
curities are added in such a way that the average of the variance terms and the
average of the covariance terms are stable, then the portfolio variance approaches
the average covariance as a lower bound.
6.5.2
Properties of the market portfolio
Let
mj
=
weight of security j in the market portfolio m
W i
0(> 0)
=
individual i’s initial wealth
wij
=
proportion of individual i’s initial wealth
invested in j-th security
Then total wealth is deﬁned by
Wm0 ≡
I
X
i=1
W i
0
(6.5.1)
and in equilibrium the relation
I
X
i=1
wijW i
0 = mjWm0
∀j
(6.5.2)
must hold. Dividing by Wm0 yields:
I
X
i=1
wij
W i
0
Wm0
= mj
∀j
(6.5.3)
and thus in equilibrium the market portfolio is a convex combination of individual
portfolios.
6.5.3
The zero-beta CAPM
Theorem 6.5.1 (Zero-beta CAPM theorem) If every investor holds a mean-variance
frontier portfolio, then the market portfolio, m, is a mean-variance frontier port-
folio, and hence, ∀q, the CAPM equation
E [˜rq] = (1 −βqm) E [˜rzm] + βqmE [˜rm]
(6.5.4)
holds.
Revised: December 2, 1998

132
6.5. MARKET EQUILIBRIUM AND THE CAPM
Theorem 6.5.2 All strictly risk-averse investors hold frontier portfolios if and
only if
E
h
˜ruq|˜rfq
i
= 0
∀q
(6.5.5)
Note the subtle distinction between uncorrelated returns (in the deﬁnition of the
decomposition) and independent returns (in this theorem). They are the same only
for the normal distribution and related distributions.
We can view the market portfolio as a frontier portfolio under two fund separation.
If p is a frontier portfolio, then we showed earlier that for purely mathematical
reasons in the deﬁnition of a frontier portfolio:
E[˜rq] = (1 −βqp)E[˜rzp] + βqpE[˜rp]
(6.5.6)
If two fund separation holds, then individuals hold frontier portfolios.
Since the market portfolio is then on the frontier, it follows that:
E[˜rq] = (1 −βqm)E[˜rzm] + βqmE[˜rm]
(6.5.7)
where
˜rm
=
N
X
j=1
mj˜rj
(6.5.8)
βqm
=
Cov [˜rq, ˜rm]
Var[˜rm]
(6.5.9)
This implies for any particular security, from the economic assumptions of equi-
librium and two fund separation:
E[˜rj] = (1 −βjm)E[˜rzm] + βjmE[˜rm]
(6.5.10)
This relation is the ?
Zero-Beta version of the Capital Asset Pricing Model
(CAPM).
6.5.4
The traditional CAPM
Now we add the risk free asset, which will allow us to determine the tangency
portfolio, t, and to talk about Capital Market Line (return v. standard deviation)
and the Security Market Line (return v. β).
Normally in equilibrium there is zero aggregate supply of the riskfree asset.
Recommended reading for this part of the course is ?, ?, ? and ?.
Now we can derive the traditional CAPM. Note that by construction
rf = E [˜rzt] .
(6.5.11)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
133
Theorem 6.5.3 (Separation Theorem) The risky asset holdings of all investors
who hold mean-variance frontier portfolios are in the proportions given by the
tangency portfolio, t.
Theorem 6.5.4 (Traditional CAPM Theorem) If every investor holds a mean-
variance frontier portfolio, then the market portfolio of risky assets, m, is the
tangency portfolio, t, and hence, ∀q, the traditional CAPM equation
E [˜rq] = (1 −βqm) rf + βqmE [˜rm]
(6.5.12)
holds.
Theorem 6.5.4 is sometimes known as the Sharpe-Lintner Theorem.
The riskless rate is unique by the No Arbitrage Principle, since otherwise a greedy
investor would borrow an inﬁnite amount at the lower rate and invest it at the
higher rate, which is impossible in equilibrium.
We can also think about what happens the CAPM if there are different riskless
borrowing and lending rates (see ?). If all individuals face this situation in equi-
librium, realism demands that both riskless assets are in zero aggregate supply and
hence that all investors hold risky assets only.
Note that the No Arbitrage Principle also allows us to rule out correlation matri-
ces for risky assets which permit the construction of portfolios with zero return
variance, i.e. synthetic riskless assets.
Assume that a riskless asset exists, with return rf < E[˜rmvp].
If the distributional conditions for two fund separation are satisﬁed, then the tan-
gency portfolio, t, must be the market portfolio of risky assets in equilibrium. We
know then that for any portfolio q (with or without a riskless component):
E[˜rq] −rf = βqm(E[˜rm] −rf)
(6.5.13)
This is the traditional Sharpe-Lintner version of the CAPM.
Figure 4A goes here.
The next theorem relates to the mean-variance efﬁciency of the market portfolio.
Theorem 6.5.5 If
1. the distributional conditions for two fund separation are satisﬁed;
2. risky assets are in strictly positive supply; and
3. investors have strictly increasing (concave) utility functions
then the market/tangency portfolio is efﬁcient.
Revised: December 2, 1998

134
6.5. MARKET EQUILIBRIUM AND THE CAPM
Proof By Jensen’s inequality and monotonicity, the riskless asset dominates any
portfolio with
E[˜r] < rf
(6.5.14)
for
E[u(W0(1 + ˜r))]
≤
u(E[W0(1 + ˜r)])
(6.5.15)
<
u(W0(1 + rf))
(6.5.16)
Hence the expected returns on all individuals’ portfolios exceed rf.
It follows that the expected return on the market portfolio must exceed rf.
Q.E.D.
Now we can calculate the risk premium of the market portfolio.
CAPM gives a relation between the risk premia on individual assets and the risk
premium on the market portfolio.
The risk premium on the market portfolio must adjust in equilibrium to give
market-clearing.
In some situations, the risk premium on the market portfolio can be written in
terms of investors’ utility functions.
Assume there is a riskless asset and returns are multivariate normal (MVN). Recall
the ﬁrst order conditions for the canonical portfolio choice problem:
0
=
E[u′
i( ˜Wi)(˜rj −rf)]
∀i, j
(6.5.17)
=
E[u′
i( ˜Wi)]E[˜rj −rf] + Cov
h
u′
i( ˜Wi), ˜rj
i
(6.5.18)
=
E[u′
i( ˜Wi)]E[˜rj −rf] + E[u′′
i ( ˜Wi)]Cov
h ˜Wi, ˜rj
i
(6.5.19)
using the deﬁnition of covariance and Stein’s lemma for MVN distributions. Re-
arranging:
E[˜rj −rf]
θi
= Cov
h ˜Wi, ˜rj
i
(6.5.20)
where
θi ≡−E[u′′
i ( ˜Wi)]
E[u′
i( ˜Wi)]
(6.5.21)
is the i-th investor’s global absolute risk aversion. Since
˜Wi = W i
0(1 + rf +
N
X
k=1
wik(˜rk −rf))
(6.5.22)
we have, dropping non-stochastic terms,
Cov
h ˜Wi, ˜rj
i
= Cov
"
W i
0
N
X
k=1
wik˜rk, ˜rj
#
(6.5.23)
Revised: December 2, 1998

CHAPTER 6. PORTFOLIO THEORY
135
Hence,
E[˜rj −rf]
θi
= Cov
"
W i
0
N
X
k=1
wik˜rk, ˜rj
#
(6.5.24)
Summing over i, this gives (since we have
P
i W i
0wik = W m
0 wmk by market-
clearing and
P
k wmk˜rk = ˜rm by deﬁnition):
E[˜rj −rf](
I
X
i=1
θ−1
i )
=
Wm0Cov [˜rm, ˜rj]
(6.5.25)
or
E[˜rj −rf]
=
(
I
X
i=1
θ−1
i )−1Wm0Cov [˜rm, ˜rj]
(6.5.26)
i.e., in equilibrium, the risk premium on the j-th asset is the product of the aggre-
gate relative risk aversion of the economy and the covariance between the return
on the j-th asset and the return on the market.
Now take the average over j weighted by market portfolio weights:
E[˜rm −rf] = (
I
X
i=1
θ−1
i )−1Wm0Var[˜(]˜rm)
(6.5.27)
i.e., in equilibrium, the risk premium on the market is the product of the aggre-
gate relative risk aversion of the economy and the variance of the return on the
market. Equivalently, the return to variability of the market equals the aggregate
relative risk aversion.
We conclude with some examples.
1. Negative exponential utility:
ui(z) = −1
ai
exp{−aiz}
ai > 0
(6.5.28)
implies:
(
I
X
i=1
θ−1
i )−1 = (
I
X
i=1
a−1
i )−1 > 0
(6.5.29)
and hence the market portfolio is efﬁcient.
2. Quadratic utility:
ui(z) = aiz −bi
2 z2
ai, bi > 0
(6.5.30)
implies:
(
I
X
i=1
θ−1
i )−1 =
 I
X
i=1
ai
bi
−E[ ˜Wi]
!−1
(6.5.31)
This result can also be derived without assuming MVN and using Stein’s
lemma.
Revised: December 2, 1998

136
6.5. MARKET EQUILIBRIUM AND THE CAPM
Revised: December 2, 1998

CHAPTER 7. INVESTMENT ANALYSIS
137
Chapter 7
INVESTMENT ANALYSIS
7.1
Introduction
[To be written.]
7.2
Arbitrage and the Pricing of Derivative Securi-
ties
7.2.1
The binomial option pricing model
This still has to be typed up. It follows very naturally from the stuff in Section 5.4.
7.2.2
The Black-Scholes option pricing model
Fischer Black died in 1995. In 1997, Myron Scholes and Robert Merton were
awarded the Nobel Prize in Economics ‘for a new method to determine the value
of derivatives.’ See
http://www.nobel.se/announcement-97/economy97.html
Black and Scholes considered a world in which there are three assets: a stock,
whose price, ˜St, follows the stochastic differential equation:
d ˜St = µ ˜Stdt + σ ˜Std˜zt,
where {˜zt}T
t=0 is a Brownian motion process; a bond, whose price, Bt, follows the
differential equation:
dBt = rBtdt;
and a call option on the stock with strike price X and maturity date T.
Revised: December 2, 1998

138
7.2. ARBITRAGE AND PRICING DERIVATIVE SECURITIES
They showed how to construct an instantaneously riskless portfolio of stocks and
options, and hence, assuming that the principle of no arbitrage holds, derived the
Black-Scholes partial differential equation which must be satisﬁed by the option
price.
The option pays (ST −X)+ ≡max {ST −X, 0} at maturity.
Let the price of the call at time t be ˜Ct. Guess that ˜Ct = C( ˜St, t). By Ito’s lemma:
d ˜Ct =
 ∂C
∂t + ∂C
∂S µ ˜St + 1
2
∂2C
∂S2 σ2 ˜S2
t
!
dt + ∂C
∂S σ ˜Std˜zt
The no arbitrage principle yields the partial differential equation:
∂C
∂t + 1
2
∂2C
∂S2 σ2S2 + ∂C
∂S rS −rC = 0
subject to the boundary condition
C(S, T) = (S −X)+.
Let τ = T −t be the time to maturity.
Then we claim that the solution to the Black-Scholes equation is:
C(S, t) = SN (d (S, τ)) −Xe−rτN

d (S, τ) −σ√τ

,
where N (·) is the cumulative distribution function of the standard normal distri-
bution and
d (S, τ)
=
ln S
X +

r −1
2σ2
τ
σ√τ
+ σ√τ
(7.2.1)
=
ln S
X +

r + 1
2σ2
τ
σ√τ
.
(7.2.2)
We can check that this is indeed the solution by calculating the various partial
derivatives and substituting them in the original equation.
Note ﬁrst that
N (z) ≡
Z z
−∞
1
√
2πe−1
2 t2dt
and hence by the fundamental theorem of calculus
N ′ (z) ≡
1
√
2πe−1
2 z2,
Revised: December 2, 1998

CHAPTER 7. INVESTMENT ANALYSIS
139
which of course is the corresponding probability density function. For the last step
in this proof, we will need the partials of d (S, τ) with respect to S and t, which
are:
∂d (S, τ)
∂t
= −∂d (S, τ)
∂τ
=
−

r + 1
2σ2
2σ√τ
(7.2.3)
and
∂d (S, τ)
∂S
=
1
Sσ√τ .
(7.2.4)
Note also that
N ′ 
d (S, τ) −σ√τ

=
e−1
2σ2τed(S,τ)σ√τN ′ (d (S, τ))
(7.2.5)
=
e−1
2σ2τ
 S
X e(r+ 1
2σ2)τ

N ′ (d (S, τ))
(7.2.6)
=
S
X erτN ′ (d (S, τ)) .
(7.2.7)
Using these facts and the chain rule, we have:
∂C
∂t
=
SN ′ (d (S, τ)) ∂d (S, τ)
∂t
−Xe−rτ×
 
N ′ 
d (S, τ) −σ√τ
  ∂d (S, τ)
∂t
−
σ
2√τ
!
+ rN

d (S, τ) −σ√τ
!
(7.2.8)
=
−SN ′ (d (S, τ))
σ
2√τ −Xe−rτrN

d (S, τ) −σ√τ

(7.2.9)
∂C
∂S
=
SN ′ (d (S, τ)) ∂d (S, τ)
∂S
+ N (d (S, τ))
−Xe−rτN ′ 
d (S, τ) −σ√τ
 ∂d (S, τ)
∂S
(7.2.10)
=
N (d (S, τ))
(7.2.11)
∂2C
∂S2
=
N ′ (d (S, τ)) ∂d (S, τ)
∂S
.
(7.2.12)
Substituting these expressions in the original partial differential equation yields:
∂C
∂t + 1
2
∂2C
∂S2 σ2S2 + ∂C
∂S rS −rC
Revised: December 2, 1998

140
7.3. MULTI-PERIOD INVESTMENT PROBLEMS
=
N (d (S, τ)) (rS −rS) + N ′ (d (S, τ))
 −Sσ
2√τ + 1
2σ2S2∂d (S, τ)
∂S
!
+N

d (S, τ) −σ√τ
 
−Xe−rτr + rXe−rτ
(7.2.13)
=
0.
(7.2.14)
The boundary condition should also be checked. As τ →0, d (S, τ) →±∞
according as S > X or S < X. In the former case, C (S, T) = S −X; and in the
latter case, C (S, T) = 0, so the boundary condition is indeed satisﬁed.
7.3
Multi-period Investment Problems
In Section 4.2, it was pointed out that the objects of choice can be differentiated
not only by their physical characteristics, but also both by the time at which they
are consumed and by the state of nature in which they are consumed. These
distinctions were suppressed in the intervening sections but are considered again
in this section and in Section 5.4 respectively.
The multi-period model should probably be introduced at the end of Chapter 4
but could also be left until Chapter 7. For the moment this brief introduction is
duplicated in both chapters.
Discrete time multi-period investment problems serve as a stepping stone from
the single period case to the continuous time case.
The main point to be gotten across is the derivation of interest rates from equilib-
rium prices: spot rates, forward rates, term structure, etc.
This is covered in one of the problems, which illustrates the link between prices
and interest rates in a multiperiod model.
7.4
Continuous Time Investment Problems
?
Revised: December 2, 1998

