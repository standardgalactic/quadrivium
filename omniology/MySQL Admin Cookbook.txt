
0\64/$GPLQ
&RRNERRN
JUHDWUHFLSHVIRUPDVWHULQJ0\64/FRQÀJXUDWLRQDQG
DGPLQLVWUDWLRQ
ĂŶŝĞů^ĐŚŶĞůůĞƌ
hĚŽ^ĐŚǁĞĚƚ
%,50,1*+$0080%$,

0\64/$GPLQ&RRNERRN
&RS\ULJKW3DFNW3XEOLVKLQJ
$OOULJKWVUHVHUYHG1RSDUWRIWKLVERRNPD\EHUHSURGXFHGVWRUHGLQDUHWULHYDOV\VWHPRU
WUDQVPLWWHGLQDQ\IRUPRUE\DQ\PHDQVZLWKRXWWKHSULRUZULWWHQSHUPLVVLRQRIWKHSXEOLVKHU
H[FHSWLQWKHFDVHRIEULHITXRWDWLRQVHPEHGGHGLQFULWLFDODUWLFOHVRUUHYLHZV
(YHU\HIIRUWKDVEHHQPDGHLQWKHSUHSDUDWLRQRIWKLVERRNWRHQVXUHWKHDFFXUDF\RIWKH
LQIRUPDWLRQSUHVHQWHG+RZHYHUWKHLQIRUPDWLRQFRQWDLQHGLQWKLVERRNLVVROGZLWKRXW
ZDUUDQW\HLWKHUH[SUHVVRULPSOLHG1HLWKHUWKHDXWKRUVQRU3DFNW3XEOLVKLQJDQGLWVGHDOHUV
DQGGLVWULEXWRUVZLOOEHKHOGOLDEOHIRUDQ\GDPDJHVFDXVHGRUDOOHJHGWREHFDXVHGGLUHFWO\RU
LQGLUHFWO\E\WKLVERRN
3DFNW3XEOLVKLQJKDVHQGHDYRUHGWRSURYLGHWUDGHPDUNLQIRUPDWLRQDERXWDOORIWKHFRPSDQLHV
DQGSURGXFWVPHQWLRQHGLQWKLVERRNE\WKHDSSURSULDWHXVHRIFDSLWDOV+RZHYHU3DFNW
3XEOLVKLQJFDQQRWJXDUDQWHHWKHDFFXUDF\RIWKLVLQIRUPDWLRQ
)LUVWSXEOLVKHG0DUFK
3URGXFWLRQ5HIHUHQFH
3XEOLVKHGE\3DFNW3XEOLVKLQJ/WG
/LQFROQ5RDG
2OWRQ
%LUPLQJKDP%3$8.
,6%1
ZZZSDFNWSXEFRP
&RYHU,PDJHE\9LQD\DN&KLWWDUvinayak.chittar@gmail.com

&UHGLWV
$XWKRUV
'DQLHO6FKQHOOHU
8GR6FKZHGW
5HYLHZHUV
.DL6HLGOHU
0DUF'HOLVOH
$FTXLVLWLRQ(GLWRU
6DUDK&XOOLQJWRQ
'HYHORSPHQW(GLWRU
5HVKPD6XQGDUHVDQ
7HFKQLFDO(GLWRUV
3DOODYL.DFKDUH
%KXSDOL.KXOH
$DURQ5RVDULR
&RS\(GLWRU
/DNVKPL0HQRQ
(GLWRULDO7HDP/HDGHU
$NVKDUD$ZDUH
,QGH[HU
5HNKD1DLU
3URMHFW7HDP/HDGHU
/DWD%DVDQWDQL
3URMHFW&RRUGLQDWRU
6KXEKDQMDQ&KDWWHUMHH
3URRIUHDGHU
&KULV6PLWK
*UDSKLFV
*HHWDQMDOL6DZDQW
3URGXFWLRQ&RRUGLQDWRU
0HOZ\Q$UXQ'
VD
&RYHU:RUN
0HOZ\Q$UXQ'
VD

$ERXWWKH$XWKRUV
'DQLHO6FKQHOOHUZRUNVDVDVRIWZDUHGHYHORSHUGDWDEDVHDGPLQLVWUDWRUDQGJHQHUDO
,7SURIHVVLRQDOIRUDQLQGHSHQGHQWVRIWZDUHYHQGRULQWKHUHWDLOVHFWRU$IWHUVXFFHVVIXOO\
JUDGXDWLQJIURPWKH8QLYHUVLW\RI&RRSHUDWLYH(GXFDWLRQLQ+HLGHQKHLP*HUPDQ\ZLWKD
GHJUHHLQ%XVLQHVV&RPSXWHU6FLHQFHKHVWDUWHGKLVFDUHHUDVDSURIHVVLRQDOVRIWZDUH
GHYHORSHUIRFXVHGRQWKH0LFURVRIWWHFKQRORJ\VWDFN,QKHVWDUWHGIRFXVLQJRQ
HQWHUSULVHOHYHO-DYDGHYHORSPHQWDQGKDVVLQFHJDLQHGH[WHQVLYHNQRZOHGJHDQGH[SHULHQFH
LPSOHPHQWLQJODUJHVFDOHV\VWHPVEDVHGRQ-DYD((DQGUHODWLRQDOGDWDEDVHVHVSHFLDOO\
0\64/VLQFHYHUVLRQ
&XUUHQWO\KHLVPRVWO\LQYROYHGZLWKWKHRQJRLQJGHYHORSPHQWRIIUDPHZRUNOHYHO
IXQFWLRQDOLW\LQFOXGLQJFXVWRPL]DWLRQDQGH[WHQVLRQRIDQ250EDVHGSHUVLVWHQFHOD\HU
+HLVLQYROYHGLQGLIIHUHQWRSHQVRXUFHSURMHFWVVXFKDV)LQG%XJV(FOLSVHDQG&KHFNVW\OH
DQGLQIUHTXHQWO\EORJVDERXW-DYD0\64/:LQGRZV/LQX[DQGRWKHULQVDQLWLHVDW
http://www.danielschneller.com
tŚĞŶ/ĮƌƐƚǁĂƐĂƐŬĞĚďǇWĂĐŬƚWƵďůŝƐŚŝŶŐǁŚĞƚŚĞƌ/ǁŽƵůĚďĞŝŶƚĞƌĞƐƚĞĚŝŶ
ǁƌŝƟŶŐĂďŽŽŬĂďŽƵƚDǇ^Y>ŽŶŚƌŝƐƚŵĂƐǀĞϮϬϬϴůŝƩůĞĚŝĚ/ŬŶŽǁŚŽǁŵƵĐŚ
ǁŽƌŬ͕ƐƚƌĞƐƐ͕ďƵƚĂůƐŽǁŚĂƚĂůŽƚŽĨĨƵŶ/ǁĂƐŚĞĂĚĞĚĨŽƌ͘
EŽǁ͕ƚŚĂƚƚŚĞďŽŽŬŝƐĮŶĂůůǇĚŽŶĞ/ǁŽƵůĚůŝŬĞƚŽƚŚĂŶŬƚŚŽƐĞƉĞŽƉůĞǁŝƚŚŽƵƚ
ǁŚŽŵŐĞƫŶŐŝƚĚŽŶĞǁŽƵůĚŚĂǀĞďĞĞŶŝŵƉŽƐƐŝďůĞ͘
&ŝƌƐƚŽĨĂůů͕/ΖĚůŝŬĞƚŽƚŚĂŶŬhĚŽĨŽƌĂŐƌĞĞŝŶŐƚŽďĞŵǇĐŽͲĂƵƚŚŽƌ͘tŝƚŚŽƵƚŚŝŵ͕
ƚŚŝƐǁŚŽůĞƚŚŝŶŐǁŽƵůĚŚĂǀĞƚĂŬĞŶĂůŽƚůŽŶŐĞƌĂŶĚǁŽƵůĚŚĂǀĞďĞĞŶŶŽƚŚĂůĨĂƐ
ƵƐĞĨƵůĂƐ/ďĞůŝĞǀĞŝƚŚĂƐƚƵƌŶĞĚŽƵƚŶŽǁ͘
/ǁŽƵůĚĂůƐŽůŝŬĞƚŽƚŚĂŶŬƚŚĞƚĞĂŵĂƚWĂĐŬƚWƵďůŝƐŚŝŶŐͶŵŽƐƚŝŵƉŽƌƚĂŶƚůǇ
ĨŽƌŶŽƟĐŝŶŐĂŶĚƌĞĂĚŝŶŐŵǇďůŽŐ͕ĐŽŶƐĞƋƵĞŶƚůǇĐŽŶƚĂĐƟŶŐŵĞƚŽŐĞƚƚŚĞ
ǁŚŽůĞƚŚŝŶŐƐƚĂƌƚĞĚͶďƵƚĂůƐŽĨŽƌƚĂŬŝŶŐĐĂƌĞŽĨƐĐŚĞĚƵůĞƐ͕ƉƌŽǀŝĚŝŶŐƐƵƉƉŽƌƚ͕
ŐƵŝĚĂŶĐĞĂŶĚĨĞĞĚďĂĐŬ͕ĂŶĚŬĞĞƉŝŶŐƵƐŽŶƚƌĂĐŬƚŚĞǁŚŽůĞǁĂǇ͘
>ĂƐƚ͕ďƵƚďǇŶŽŵĞĂŶƐůĞĂƐƚ͕/ǁĂŶƚƚŽƚŚĂŶŬ:ĞŶŶǇͶĨŽƌĞŶĐŽƵƌĂŐŝŶŐŵĞƚŽ
ǁƌŝƚĞĂďŽŽŬŝŶƚŚĞĮƌƐƚƉůĂĐĞ͕ĂŶĚƚŚĞŶŵĂŬŝŶŐƐƵƌĞ/ŶĞǀĞƌƌĂŶŽƵƚŽĨƚĞĂ͕
ĐŽŽŬŝĞƐ͕ŽƌŵŽƟǀĂƟŽŶŽŶƚŚĞĐŽƵŶƚůĞƐƐĞǀĞŶŝŶŐƐ/ƐƉĞŶƚƐŝƫŶŐŝŶĨƌŽŶƚŽĨƚŚĞ
ŬĞǇďŽĂƌĚŝŶƐƚĞĂĚŽĨǁŝƚŚŚĞƌ͘/ĚĞĚŝĐĂƚĞƚŚŝƐďŽŽŬƚŽŚĞƌ͘

8GR6FKZHGWKDVRYHUWHQ\HDUVRIH[SHULHQFHLQWKH,7LQGXVWU\DVDSURIHVVLRQDO-DYDGH
YHORSHUDQGVRIWZDUHDUFKLWHFW+HLVKHDGRIWKH-DYDDUFKLWHFWXUHWHDPDQGGHSXW\KHDGRI
WKH-DYDGHYHORSPHQWGHSDUWPHQWDWWKH,7VHUYLFHSURYLGHUIRU*HUPDQ\
VPDUNHWOHDGHULQ
WKH'R,W<RXUVHOIVHFWRU
+HKDVEHHQIDVFLQDWHGE\FRPSXWHUVVLQFHKLVFKLOGKRRGDQGWDXJKWKLPVHOIWKHEDVLFVRI
SURJUDPPLQJGXULQJKLVVFKRRO\HDUV$IWHUJUDGXDWLQJIURPVFKRROKHEHJDQKLVVWXGLHVDW
WKH5:7+$DFKHQ*HUPDQ\ZKLFKKHÀQLVKHGZLWKDVXPPDFXPODXGHGHJUHHLQFRPSXWHU
VFLHQFHPLQRULQJLQSV\FKRORJ\ZLWKDIRFXVRQVRIWZDUHHUJRQRPLFV
8GRVWDUWHGKLVFDUHHUDVDSURIHVVLRQDO&&DQG-DYDGHYHORSHULQDVRIWZDUHFRPSDQ\
WKDWGHOLYHUVOHDGLQJVROXWLRQVLQWKHÀQDQFLDORQOLQHWUDQVDFWLRQSURFHVVLQJVHFWRU,Q
KHMRLQHGKLVFXUUHQWHPSOR\HUDVD-DYDIUDPHZRUNGHYHORSHUIRUDODUJHVFDOHLQWHUQDWLRQDO
SURMHFWZKHUHKHPHW'DQLHO,QWKHFRXUVHRIWKHSURMHFWKHJDLQHGH[WHQVLYHH[SHULHQFHLQ
XVLQJ0\64/LQDSURIHVVLRQDOFRQWH[W
)RUERWKĂŶŝĞůDQGhĚŽWKHFRPPRQSURMHFWLQYROYHGWKHGHVLJQDQGLPSOHPHQWDWLRQRI
DGDWDEDVHLQIUDVWUXFWXUHVROXWLRQIRUD-DYDEDVHGPHUFKDQGLVHPDQDJHPHQWVRIWZDUHV\V
WHPZLWKWHQVRIWKRXVDQGVRIFOLHQWV7KHHYDOXDWLRQRIGLIIHUHQWGDWDEDVHV\VWHPVDQGWKH
UHDOL]DWLRQRIWKHLQIUDVWUXFWXUHPDGHLWQHFHVVDU\IRUWKHPWRGHOYHLQWR0\64/EH\RQGWKH
W\SLFDOXWLOL]DWLRQVFHQDULRV7KHUHVXOWLQJGHFHQWUDOL]HGPXOWLSODWIRUPHQYLURQPHQWEDVHGRQ
PRUHWKDQGHFHQWUDOL]HG0\64/VHUYHULQVWDQFHVZLWKPRUHWKDQUHSOLFDWLRQ
VODYHVEHDUVFKDOOHQJHVQRWFRYHUHGE\WKHVWDQGDUG0\64/GRFXPHQWDWLRQ
dŽƚŚĞWĂĐŬƚWƵďůŝƐŚŝŶŐƚĞĂŵ͗dŚĂŶŬǇŽƵĨŽƌĐƌŝƟƋƵĞƐ͕ĞŶĐŽƵƌĂŐĞŵĞŶƚ͕
ĂŶĚŽƌŐĂŶŝǌĂƟŽŶ͘
dŽĂŶŝĞů͗dŚĂŶŬǇŽƵƐŽŵƵĐŚĨŽƌǇŽƵƌĐŽŶĮĚĞŶĐĞŝŶŵĞ͘/ƐƟůůĨĞĞůŚŽŶŽƌĞĚ
ǇŽƵĂƐŬĞĚŵĞƚŽĐŽͲĂƵƚŚŽƌƚŚŝƐďŽŽŬͶǇŽƵƐŚŽƵůĚŬŶŽǁďĞƩĞƌďǇŶŽǁ͊
dŽŵǇƉĂƌĞŶƚƐ͗dŚĂŶŬǇŽƵĨŽƌƐƵƉƉŽƌƟŶŐŵĞĨƌŽŵƚŚĞǀĞƌǇƐƚĂƌƚĂŶĚĞǀĞƌƐŝŶĐĞ͘
dŽ<ĂƚŚĂƌŝŶĂ͕:ŽŚĂŶŶĂŚ͕ĂŶĚ&ƌŝĚĂ͗dŚĂŶŬǇŽƵĨŽƌǇŽƵƌƐƵƉƉŽƌƚĂŶĚĂůůǇŽƵƌ
ƉĂƟĞŶĐĞͶ/ůŽǀĞǇŽƵ͊

$ERXWWKH5HYLHZHUV
.DL6HLGOHUZDVERUQLQ+DPEXUJLQ+HJUDGXDWHGIURPWKH7HFKQLFDO8QLYHUVLW\
RI%HUOLQZLWKD'LSORP,QIRUPDWLNHUGHJUHH0DVWHURI6FLHQFHHTXLYDOHQWLQ&RPSXWHU
6FLHQFH,QWKHVKHFUHDWHGDQGPDQDJHG*HUPDQ\
VELJJHVW,5&QHWVHUYHULUFIXEHUOLQ
GHDQGFRPDQDJHGRQHRIWKHZRUOG
VODUJHVWDQRQ\PRXV)73VHUYHUIWSFVWXEHUOLQGH
+HSURIHVVLRQDOO\VHWXSKLVÀUVWSXEOLFZHEVHUYHUVLQ)URPXQWLOKHZDV
PHPEHURI3URMHNWJUXSSH.XOWXUUDXP,QWHUQHWDUHVHDUFKSURMHFWRQQHWFXOWXUHDQGQHWZRUN
RUJDQL]DWLRQ,QKHFRIRXQGHG$SDFKH)ULHQGVDQGFUHDWHGWKHPXOWLSODWIRUP$SDFKH
ZHEVHUYHUEXQGOH;$033$URXQG;$033EHFDPHWKHPRVWSRSXODU$SDFKHVWDFN
ZRUOGZLGH,QKLVWKLUGERRN'DV;$033+DQGEXFKZDVSXEOLVKHGE\$GGLVRQ:HVOH\
&XUUHQWO\KH
VZRUNLQJDVD7HFKQRORJ\(YDQJHOLVWIRUZHEWLHUSURGXFWVDW6XQ0LFURV\VWHPV
0DUF'HOLVOHLVDPHPEHURIWKH0\64/'HYHORSHUV*XLOG³ZKLFKEULQJVWRJHWKHU
FRPPXQLW\GHYHORSHUV³EHFDXVHRIKLVLQYROYHPHQWZLWKSKS0\$GPLQ+HVWDUWHGWR
FRQWULEXWHWRWKLVSRSXODU0\64/ZHELQWHUIDFHLQ'HFHPEHUZKHQKHPDGHWKHÀUVW
PXOWLODQJXDJHYHUVLRQ+HKDVEHHQDFWLYHO\LQYROYHGZLWKWKLVVRIWZDUHSURMHFWVLQFH0D\
DVDGHYHORSHUDQGSURMHFWDGPLQLVWUDWRU
0DUFKDVZRUNHGVLQFHDW&HJHSGH6KHUEURRNH4XpEHF&DQDGDDVDQDSSOLFDWLRQ
SURJUDPPHUDQGQHWZRUNPDQDJHU+HKDVDOVREHHQWHDFKLQJQHWZRUNLQJVHFXULW\DQG
3+30\64/DSSOLFDWLRQGHYHORSPHQW0DUFOLYHVLQ6KHUEURRNHZLWKKLVZLIHDQGWKH\HQMR\
VSHQGLQJWLPHZLWKWKHLUIRXUFKLOGUHQ
0DUFDXWKRUHGWKHÀUVWHYHU3DFNW3XEOLVKLQJERRN0DVWHULQJSKS0\$GPLQIRU(IIHFWLYH
0\64/0DQDJHPHQWDQGLWVUHYLVHGHGLWLRQV+HDOVRZURWH&UHDWLQJ\RXU0\64/
'DWDEDVH3UDFWLFDO'HVLJQ7LSVDQG7HFKQLTXHVDJDLQZLWK3DFNW3XEOLVKLQJ
/ǁŽƵůĚůŝŬĞƚŽƚŚĂŶŬƚŚĞĮŶĞƚĞĂŵĂƚWĂĐŬƚĨŽƌƚŚĞŝƌƐƵƉƉŽƌƚŝŶƌĞǀŝĞǁŝŶŐ
ƚŚŝƐďŽŽŬ͘

7DEOHRI&RQWHQWV
3UHIDFH

&KDSWHU5HSOLFDWLRQ

,QWURGXFWLRQ

6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRIDVHUYHUEDVHGRQD64/GXPS

6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRIDVHOHFWLRQRIWDEOHVEDVHG
RQD64/GXPS

6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVXVLQJGDWDÀOHFRS\

6KDULQJUHDGORDGDFURVVPXOWLSOHPDFKLQHV

8VLQJUHSOLFDWLRQWRSURYLGHIXOOWH[WLQGH[LQJIRU,QQR'%WDEOHV

(VWLPDWLQJQHWZRUNDQGVODYH,2ORDG

/LPLWLQJQHWZRUNDQGVODYH,2ORDGLQKHDY\ZULWHVFHQDULRVXVLQJ
WKHEODFNKROHVWRUDJHHQJLQH

6HWWLQJXSVODYHVYLDQHWZRUNVWUHDPLQJ

6NLSSLQJSUREOHPDWLFTXHULHV

&KHFNLQJLIVHUYHUVDUHLQV\QF

$YRLGLQJGXSOLFDWHVHUYHU,'V

6HWWLQJXSVODYHVWRUHSRUWFXVWRPLQIRUPDWLRQDERXWWKHPVHOYHV
WRWKHPDVWHU

&KDSWHU,QGH[LQJ

,QWURGXFWLRQ

$GGLQJLQGH[HVWRWDEOHV

$GGLQJDIXOOWH[WLQGH[

&UHDWLQJDQRUPDOL]HGWH[WVHDUFKFROXPQ

5HPRYLQJLQGH[HVIURPWDEOHV

(VWLPDWLQJ,QQR'%LQGH[VSDFHUHTXLUHPHQWV

8VLQJSUHÀ[SULPDU\NH\V

&KRRVLQJ,QQR'%SULPDU\NH\FROXPQV

6SHHGLQJXSVHDUFKHVIRUVXEGRPDLQV


LL
7DEOHRI&RQWHQWV
)LQGLQJGXSOLFDWHLQGH[HV

&KDSWHU7RROV

,QWURGXFWLRQ

7UDQVIHUULQJFRQQHFWLRQVHWWLQJVEHWZHHQGLIIHUHQWPDFKLQHVXVLQJ
DQHWZRUNVKDUH

6RUWLQJ0\64/*8,7RROV
VWRUHGFRQQHFWLRQV

$XWRPDWLFDOO\FUHDWLQJVWRUHGFRQQHFWLRQV

$GGLQJFXVWRPJUDSKVWR0\64/$GPLQLVWUDWRU

'LVSOD\LQJTXHU\UHVXOWVSDJHE\SDJHDQGZLWKVFUROOLQJXVLQJ
WKH0\64/FRPPDQGOLQHFOLHQW

([WUDFWLQJLQIRUPDWLRQIURPYHUERVHRXWSXWXVLQJWKH0\64/
FRPPDQGOLQHFOLHQW

6SHFLI\LQJDGHIDXOWSDJHU

8VLQJDFXVWRPSURPSWWRGLVWLQJXLVKFRQQHFWLRQV

(QFU\SWLQJD0\64/VHUYHUFRQQHFWLRQZLWK66+

&UHDWLQJDQHQFU\SWHG0\64/FRQVROHYLD66+

8VLQJD3X77<WHPSODWHFRQQHFWLRQIRU66+VHFXUHGFRQQHFWLRQV

&KDSWHU%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

,QWURGXFWLRQ

8VLQJ0\64/$GPLQLVWUDWRU*8,7RRODVDIURQWHQGIRUEDFNXSV

&RS\LQJDOOGDWDÀOHVWRDEDFNXSORFDWLRQ

&UHDWLQJD64/GXPSRIDOOGDWDEDVHV

&UHDWLQJD64/GXPSRIVSHFLÀFGDWDEDVHV

&UHDWLQJD64/GXPSRIVSHFLÀFWDEOHV

&RPSUHVVLQJ64/GXPSVRQWKHÁ\

5RWDWLQJDQGSXUJLQJELQDU\ORJV

8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSVZLWKRXWKXUWLQJDSURGXFWLRQ
V\VWHP
VSHUIRUPDQFH

5HVWRULQJGDWDIURPDGXPSWRDSUHYLRXVO\EDFNHGXSVWDWH

3HUIRUPLQJDSRLQWLQWLPHUHFRYHU\XVLQJWKHELQDU\ORJV

&KDSWHU0DQDJLQJ'DWD

,QWURGXFWLRQ

([SRUWLQJGDWDWRDVLPSOH&69ÀOH

([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW

8VLQJVWRUHGSURFHGXUHVWRH[SRUWUHSHDWHGO\

,PSRUWLQJGDWDIURPDVLPSOH&69ÀOH

,PSRUWLQJGDWDIURPFXVWRPÀOHIRUPDWV

,QVHUWLQJQHZGDWDDQGXSGDWLQJGDWDLILWDOUHDG\H[LVWV

,QVHUWLQJGDWDEDVHGRQH[LVWLQJGDWDEDVHFRQWHQW

'HOHWLQJDOOGDWDIURPODUJHWDEOHV


LLL
7DEOHRI&RQWHQWV
'HOHWLQJDOOEXWDIUDJPHQWRIDODUJHWDEOH
VGDWD

'HOHWLQJDOOGDWDLQFUHPHQWDOO\IURPODUJHWDEOHV

&KDSWHU0RQLWRULQJDQG$QDO\]LQJD0\64/,QVWDOODWLRQ

,QWURGXFWLRQ

&KHFNLQJIUHH,QQR'%WDEOHVSDFH

(VWDEOLVKLQJDOHUWLQJPHFKDQLVPVIRUORZUHPDLQLQJWDEOHVSDFH
E\XVLQJWULJJHUV

(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQWV

,GHQWLI\LQJDQGFKDQJLQJ0\64/YDULDEOHV

$VVHVVLQJWKHRYHUDOOWDEOHFRXQW

)LQGLQJWKHELJJHVWWDEOHV

)LQGLQJDOOFROXPQVZLWKDFHUWDLQQDPHDQGRUW\SH

)LQGLQJDOOWDEOHVUHIHUHQFLQJHDFKRWKHU

&KDSWHU&RQÀJXULQJ0\64/

,QWURGXFWLRQ

6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFH

6HWWLQJXSDQDXWRH[WHQGLQJ,QQR'%WDEOHVSDFH

6WRULQJ,QQR'%GDWDLQRQHÀOHSHUWDEOH

'HFUHDVLQJ,QQR'%WDEOHVSDFH

(QDEOLQJDQGFRQÀJXULQJELQDU\ORJJLQJ

&RQÀJXULQJWKH,QQR'%UHGRORJ

8QGHUVWDQGLQJDQGFRQÀJXULQJLPSRUWDQW0\64/DQG,QQR'%
WLPHRXWRSWLRQV

$GMXVWLQJWDEOHDQGGDWDEDVHQDPHOHWWHUFDVHKDQGOLQJIRUEHWWHU
SODWIRUPLQGHSHQGHQFH

,QVWDOOLQJ0\64/DVD:LQGRZVVHUYLFHZLWKFXVWRPRSWLRQV

5XQQLQJPXOWLSOH0\64/VHUYHULQVWDQFHVLQSDUDOOHORQD/LQX[VHUYHU

3UHYHQWLQJLQYDOLGGDWHYDOXHVIURPEHLQJVWRUHGLQ'$7(RU
'$7(7,0(FROXPQV

&KDSWHU0\64/8VHU0DQDJHPHQW

,QWURGXFWLRQ

&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV

'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV

'LVDEOLQJWKHGHIDXOWDFFRXQWV

&UHDWLQJDEDVLFXVHU

&UHDWLQJDQLQVWDOODWLRQXVHU

&UHDWLQJDUHDGRQO\DFFRXQW

'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS

'HÀQLQJDVSHFLÀFXVHUIRUUHSOLFDWLRQ

$OORZLQJDFFHVVIURPVSHFLÀFKRVWVRQO\


LY
7DEOHRI&RQWHQWV
5HJDLQLQJDFFHVVWR\RXUGDWDEDVHLQFDVHRIORVWDFFRXQWLQIRUPDWLRQ

$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV

&KDSWHU0DQDJLQJ6FKHPDV

,QWURGXFWLRQ

$GGLQJQHZFROXPQVDWVSHFLÀFSRVLWLRQV

'HÀQLQJDSULPDU\NH\IRUDWDEOHFRQWDLQLQJQRQXQLTXHGDWD

$OORZLQJLQGLYLGXDO,16(57VWDWHPHQWVZLWKYDOXHVLQ
DXWRLQFUHPHQWLQJFROXPQV

*OREDOO\DOORZLQJ,16(57VWDWHPHQWVZLWKYDOXHVLQ
DXWRLQFUHPHQWLQJFROXPQV

&KRRVLQJDVXLWDEOHVWRUDJHHQJLQH

,PSURYLQJWKHSHUIRUPDQFHRI$/7(57$%/(IRU,QQR'%

8VLQJDVWRUHGSURFHGXUHWRFRQGLWLRQDOO\DGGFROXPQVRULQGH[HV

,PSURYLQJTXHU\SHUIRUPDQFHIRU,QQR'%WDEOHVZLWK%/2%FROXPQV

,GHQWLI\LQJGLIIHUHQFHVEHWZHHQWZRVFKHPDV

&RPSDULQJVFKHPDUHYLVLRQVXVLQJKDVKYDOXHV

$SSHQGL[*RRGWR.QRZ

,QWURGXFWLRQ

$YRLGLQJVLOHQWUHSOLFDWLRQGLVUXSWLRQRQIXOOPDVWHUGLVN

0D[LPL]LQJXVDEOHPHPRU\RQELW:LQGRZV

8VLQJVHSDUDWHWHPSRUDU\GLUHFWRULHVIRUPXOWLSOH0\64/VHUYHUVRQ
DVLQJOHPDFKLQHSUHYHQWLQJFRQÁLFWV

3UHYHQWLQJP\VTOGXPSIURPIDLOLQJZLWK(UURU

1RQDYDLODELOLW\RI,QQR'%PD\HVFDSHPRQLWRULQJ

7URXEOHVKRRWLQJ&DQ
WVWDUWVHUYHU%LQGRQ7&3,3SRUW1RVXFK
ÀOHRUGLUHFWRU\HUURU

&KRRVLQJFKDUDFWHUVHWV

8QGHUVWDQGLQJDXWRLQFUHPHQWYDOXHV


3UHIDFH
0\64/LVWKHPRVWSRSXODURSHQVRXUFHGDWDEDVHDQGLVDOVRNQRZQIRULWVHDV\VHWXS
IHDWXUH+RZHYHUSURSHUFRQÀJXUDWLRQEH\RQGWKHGHIDXOWVHWWLQJVLVVWLOODFKDOOHQJHDORQJ
ZLWKVRPHRWKHUGD\WRGD\PDLQWHQDQFHWDVNVVXFKDVEDFNXSDQGUHVWRULQJSHUIRUPDQFH
WXQLQJDQGVHUYHUPRQLWRULQJ
7KLVERRNSURYLGHVERWKVWHSE\VWHSUHFLSHVDQGUHOHYDQWEDFNJURXQGLQIRUPDWLRQRQWKHVH
WRSLFVDQGPRUH,WFRYHUVHYHU\WKLQJIURPEDVLFWRDGYDQFHGDVSHFWVRI0\64/DGPLQLVWUDWLRQ
DQGFRQÀJXUDWLRQ$OOUHFLSHVDUHEDVHGRQUHDOZRUOGH[SHULHQFHDQGZHUHGHULYHGIURP
SURYHQVROXWLRQVXVHGLQDQHQWHUSULVHHQYLURQPHQW
:KDWWKLVERRNFRYHUV
&KDSWHU5HSOLFDWLRQ,QWKLVFKDSWHU\RXZLOOVHHKRZWRVHWXS0\64/UHSOLFDWLRQXVHIXOIRU
ORDGEDODQFLQJRQOLQHEDFNXSVDQGIDLORYHUVFHQDULRV$GYDQFHGUHSOLFDWLRQVFHQDULRVXVLQJ
WKHEODFNKROHHQJLQHDQGVWUHDPLQJVODYHGHSOR\PHQWDUHGLVFXVVHGEH\RQGWKHEDVLFWRSLFV
&KDSWHU,QGH[LQJ<RXZLOOEHVKRZQKRZWRFUHDWHGURSDQGPRGLI\LQGH[HVSHUKDSV
WKHPRVWLPSRUWDQWPHDQVRIRSWLPL]LQJ\RXU0\64/VHUYHUV
SHUIRUPDQFH)XOOWH[WLQGH[LQJ
FOXVWHUHGDQGQRQFOXVWHUHGLQGH[HVDUHFRPSDUHGDQGSUHVHQWHGZLWKWKHLUUHVSHFWLYH
VWUHQJWKVDQGW\SLFDOXVHFDVHV0RUHRYHU\RXZLOOOHDUQKRZWRLGHQWLI\GXSOLFDWHLQGH[HV
ZKLFKFDQKLQGHU\RXUVHUYHUV
SHUIRUPDQFH
&KDSWHU7RROV7KLVFKDSWHUZLOOJHW\RXDFTXDLQWHGZLWKWKH0\64/$GPLQLVWUDWRUDQG4XHU\
%URZVHU*8,7RROVDVZHOODVWKH0\64/FRPPDQGOLQHFOLHQWDQGKRZWRXVHLWLQFRQFHUW
ZLWKH[WHUQDOVFULSWVDQGWRROV<RXZLOODOVRVHHKRZWRFUHDWHFXVWRPGLDJUDPVIRU0\64/
$GPLQLVWUDWRUDQGVKDUHFRQQHFWLRQSURÀOHVEHWZHHQPXOWLSOHFRPSXWHUV
&KDSWHU%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD,QWKLVFKDSWHUZHLQWURGXFHWKHEDVLF
DSSURDFKHVWREDFNLQJXS\RXUGDWDEDVHDQGUHVWRULQJGDWDDJDLQ$GYDQFHGWHFKQLTXHVOLNH
RQWKHÁ\FRPSUHVVLRQSRLQWLQWLPHUHFRYHU\DYRLGLQJH[WHQGHGORFNVLWXDWLRQVEDFNXSLQ
UHSOLFDWLRQVFHQDULRVDQGSDUWLDOEDFNXSDQGUHVWRUHDUHDOVRFRYHUHG

3UHIDFH

&KDSWHU0DQDJLQJ'DWD<RXZLOOOHDUQVRPHWULFNVEH\RQGWKHEDVLF64/FRPPDQGV
ZKLFKHQDEOH\RXWRGHOHWHGDWDLQDKLJKO\HIÀFLHQWPDQQHUDQGLQVHUWGDWDEDVHGRQH[LVWLQJ
GDWDEDVHFRQWHQWDQGKRZWRLPSRUWDQGH[SRUWGDWDWRDQGIURP\RXUGDWDEDVH
&KDSWHU0RQLWRULQJDQG$QDO\]LQJD0\64/,QVWDOODWLRQ:HSUHVHQWDSSURDFKHVWR
PRQLWRULQJWDEOHVSDFHXVDJHDQGKRZWRXVHGDWDEDVHPHWDGDWDWR\RXUDGYDQWDJH7\SLFDO
SHUIRUPDQFHERWWOHQHFNVDQGORFNFRQWHQWLRQSUREOHPVDUHGLVFXVVHGDVZHOO
&KDSWHU&RQÀJXULQJ0\64/7KLVFKDSWHUGHDOVZLWK0\64/FRQÀJXUDWLRQDQGKRZWREHVW
OHYHUDJHDYDLODEOHVHWWLQJVWRWKHLUIXOOSRWHQWLDO7DEOHVSDFHPDQDJHPHQWSRROVL]LQJDQG
ORJJLQJRSWLRQVDUHGLVFXVVHGDORQJZLWKSODWIRUPVSHFLÀFFDYHDWVDQGDGYDQFHGLQVWDOODWLRQ
VFHQDULRVVXFKDVPXOWLSOHLQVWDQFHVRQRQHVHUYHU
&KDSWHU0\64/8VHU0DQDJHPHQW0DQDJHPHQWRI0\64/XVHUDFFRXQWVLVGLVFXVVHGLQ
GHWDLOWKURXJKRXWWKLVFKDSWHU7\SLFDOXVHUUROHVZLWKDSSURSULDWHSULYLOHJHVDQGDSSURDFKHV
WRUHVWULFWLQJDFFHVVVHQVLEO\DUHSURSRVHG<RXZLOODOVROHDUQKRZWRUHJDLQDFFHVVWR\RXU
GDWDEDVHLQFDVHWKHDGPLQLVWUDWLYHXVHUFUHGHQWLDOVDUHORVW
&KDSWHU0DQDJLQJ6FKHPDV7KLVFKDSWHULQFOXGHVWRSLFVVXFKDVDGGLQJDQGUHPRYLQJ
FROXPQVWRDQGIURPWDEOHVDQGFKRRVLQJDVXLWDEOHVWRUDJHHQJLQHDQGFKDUDFWHUVHWIRU
LQGLYLGXDOQHHGV$QRWKHUUHFLSHFRYHUVDWHFKQLTXHWRDGGDQHZSULPDU\NH\FROXPQWRD
WDEOHDOUHDG\ÀOOHGZLWKGDWD:D\VWRPDQDJHDQGDXWRPDWHGDWDEDVHVFKHPDHYROXWLRQDV
SDUWRIDVRIWZDUHOLIHF\FOHDUHSUHVHQWHGDVZHOO$QGLI\RXKDYHDOZD\VPLVVHG$'',1'(;
,)127(;,676\RXZLOOÀQGDVROXWLRQWRWKLVWRR
$SSHQGL[*RRGWR.QRZ,QWKLVÀQDOSDUWRIWKHERRN\RXFDQÀQGVHYHUDOWKLQJVWKDWFDQWXUQ
RXWXVHIXOLQHYHU\GD\VLWXDWLRQVEXWGLGQRWÀWWKHVWHSE\VWHSUHFLSHIRUPDWQDWXUDOO\7RSLFV
UDQJHIURPFKRRVLQJFKDUDFWHUVHWVWRJHWWLQJWKHPRVWRXWRIELWDGGUHVVVSDFHOLPLWDWLRQV
:KDW\RXQHHGIRUWKLVERRN
7KLVERRNZDVZULWWHQXVLQJ0\64/YHUVLRQVDQG0RVWUHFLSHVZLOOZRUNHTXDOO\
ZHOORQHLWKHURQRIWKHVHYHUVLRQV2OGHUYHUVLRQVPLJKWZRUNDVZHOOEXWKDYHQRWEHHQ
WHVWHG<RXFDQGRZQORDGERWKYHUVLRQVRIWKH0\64/VHUYHUIURPhttp://dev.mysql.com
<RXZLOOÀQGUHIHUHQFHVWRSURJUDPVDQGWRROVQRWLQFOXGHGLQWKH0\64/VHUYHUGLVWULEXWLRQ
7KHVHFDQEHGRZQORDGHGIURPWKHLUUHVSHFWLYHZHEVLWHVQDPHGLQWKHUHFLSHV7KH0\64/
*8,7RROV³0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHU³ZKLFKDUHUHIHUHQFHGPXOWLSOH
WLPHVWKURXJKRXWWKHERRN³XQIRUWXQDWHO\KDYHEHHQGHFODUHG(QG2I/LIHVKRUWO\EHIRUHWKLV
ERRNZDVÀQLVKHG&XUUHQWO\WKHUHLVQRIXQFWLRQDOO\HTXLYDOHQWVXFFHVVRUWRWKHVHWRROV
0\64/:RUNEHQFKLVWKHQHZFRPELQHGWRROUHFRPPHQGHGRQWKH0\64/ZHEVLWHEXWLW
GRHVQRWRIIHUDOOIHDWXUHVUHTXLUHGWRDSSO\PDQ\RIWKHUHFLSHVLQWKLVERRN:HUHFRPPHQG
\RXWRGRZQORDG0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHUIURPWKH0\64/ZHEVLWH
V
DUFKLYHDUHDZKHUHWKH\DUHVWLOODYDLODEOH<RXZLOOÀQGWKHPE\MXVWXVLQJWKHOLQNVSULQWHGLQ
WKLVERRN

3UHIDFH

:KRWKLVERRNLVIRU
7KLVERRNLVIRUDPELWLRXV0\64/XVHUVDVZHOODVSURIHVVLRQDOGDWDFHQWHUGDWDEDVH
DGPLQLVWUDWRUV%HJLQQHUVDVZHOODVH[SHULHQFHGDGPLQLVWUDWRUVZLOOSURÀWIURPWKLVFRRNERRN
DQGJHWIUHVKLGHDVWRLPSURYHWKHLU0\64/HQYLURQPHQWV'HWDLOHGEDFNJURXQGLQIRUPDWLRQ
ZLOOHQDEOHWKHPWRZLGHQWKHLU0\64/KRUL]RQ
,WGRHVQRWFRYHU64/EDVLFVKRZWRLQVWDOO0\64/VHUYHUVRUKRZWRGHVLJQDUHODWLRQDO
GDWDEDVHVFKHPD5HDGHUVDUHH[SHFWHGWRKDYHDEDVLFXQGHUVWDQGLQJRIWKH64/ODQJXDJH
DQGGDWDEDVHFRQFHSWVLQJHQHUDO
&RQYHQWLRQV
,QWKLVERRN\RXZLOOÀQGDQXPEHURIVW\OHVRIWH[WWKDWGLVWLQJXLVKEHWZHHQGLIIHUHQWNLQGVRI
LQIRUPDWLRQ+HUHDUHVRPHH[DPSOHVRIWKHVHVW\OHVDQGDQH[SODQDWLRQRIWKHLUPHDQLQJ
&RGHZRUGVLQWH[WDUHVKRZQDVIROORZV2QO\XVHTXDOLÀHGVWDWHPHQWVDQGreplicate-*-
tableFRQÀJXUDWLRQRSWLRQVIRULQWXLWLYHO\SUHGLFWDEOHUHSOLFDWLRQ
$EORFNRIFRGHLVVHWDVIROORZV
slave> create database sakila; 
slave> use sakila; 
slave> source /tmp/sakila_master.sql; 
slave> CHANGE MASTER TO master_host='master.example.com', master_
port=3306, master_ user='repl', master_password='slavepass';
slave> START SLAVE;
:KHQZHZLVKWRGUDZ\RXUDWWHQWLRQWRDSDUWLFXODUSDUWRIDFRGHEORFNWKHUHOHYDQWOLQHVRU
LWHPVDUHVHWLQEROG
slave> SHOW SLAVE STATUS\G
************************** 1. row ***************************
                        ...
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                        ...
1HZWHUPVDQGLPSRUWDQWZRUGVDUHVKRZQLQEROG:RUGVWKDW\RXVHHRQWKHVFUHHQLQ
PHQXVRUGLDORJER[HVIRUH[DPSOHDSSHDULQWKHWH[WOLNHWKLV<RXZLOOVHHWKHĨĂŵŝůŝĂƌ
ŵĞƐƐĂŐĞƐĂďŽƵƚ/ŶŶŽĮůůŝŶŐƵƉƚŚĞĚĂƚĂĮůĞƐĂŶĚĮŶĂůůǇ͕ƚŚĞ5HDG\IRUFRQQHFWLRQVůŝŶĞ

3UHIDFH

:DUQLQJVRULPSRUWDQWQRWHVDSSHDULQDER[OLNHWKLV
7LSVDQGWULFNVDSSHDUOLNHWKLV
5HDGHUIHHGEDFN
)HHGEDFNIURPRXUUHDGHUVLVDOZD\VZHOFRPH/HWXVNQRZZKDW\RXWKLQNDERXWWKLV
ERRN³ZKDW\RXOLNHGRUPD\KDYHGLVOLNHG5HDGHUIHHGEDFNLVLPSRUWDQWIRUXVWRGHYHORS
WLWOHVWKDW\RXUHDOO\JHWWKHPRVWRXWRI
7RVHQGXVJHQHUDOIHHGEDFNVLPSO\VHQGDQHPDLOWRfeedback@packtpub.comDQG
PHQWLRQWKHERRNWLWOHYLDWKHVXEMHFWRI\RXUPHVVDJH
,IWKHUHLVDERRNWKDW\RXQHHGDQGZRXOGOLNHWRVHHXVSXEOLVKSOHDVHVHQGXVDQRWHLQWKH
68**(67$7,7/(IRUPRQwww.packtpub.comRUHPDLOsuggest@packtpub.com
,IWKHUHLVDWRSLFWKDW\RXKDYHH[SHUWLVHLQDQG\RXDUHLQWHUHVWHGLQHLWKHUZULWLQJRU
FRQWULEXWLQJWRDERRNRQVHHRXUDXWKRUJXLGHRQwww.packtpub.com/authors
&XVWRPHUVXSSRUW
1RZWKDW\RXDUHWKHSURXGRZQHURID3DFNWERRNZHKDYHDQXPEHURIWKLQJVWRKHOS\RXWR
JHWWKHPRVWIURP\RXUSXUFKDVH
'RZQORDGLQJWKHH[DPSOHFRGHIRUWKHERRN
9LVLWhttp://www.packtpub.com/files/code/7962_Code.zipWR
GLUHFWO\GRZQORDGWKHH[DPSOHFRGH

3UHIDFH

(UUDWD
$OWKRXJKZHKDYHWDNHQHYHU\FDUHWRHQVXUHWKHDFFXUDF\RIRXUFRQWHQWPLVWDNHV
GRKDSSHQ,I\RXÀQGDPLVWDNHLQRQHRIRXUERRNV³PD\EHDPLVWDNHLQWKHWH[WRUWKH
FRGH³ZHZRXOGEHJUDWHIXOLI\RXZRXOGUHSRUWWKLVWRXV%\GRLQJVR\RXFDQVDYHRWKHU
UHDGHUVIURPIUXVWUDWLRQDQGKHOSXVLPSURYHVXEVHTXHQWYHUVLRQVRIWKLVERRN,I\RXÀQG
DQ\HUUDWDSOHDVHUHSRUWWKHPE\YLVLWLQJhttp://www.packtpub.com/support
VHOHFWLQJ\RXUERRNFOLFNLQJRQWKHOHWXVNQRZOLQNDQGHQWHULQJWKHGHWDLOVRI\RXU
HUUDWD2QFH\RXUHUUDWDDUHYHULÀHG\RXUVXEPLVVLRQZLOOEHDFFHSWHGDQGWKHHUUDWD
ZLOOEHXSORDGHGRQRXUZHEVLWHRUDGGHGWRDQ\OLVWRIH[LVWLQJHUUDWDXQGHUWKH(UUDWD
VHFWLRQRIWKDWWLWOH$Q\H[LVWLQJHUUDWDFDQEHYLHZHGE\VHOHFWLQJ\RXUWLWOHIURP
http://www.packtpub.com/support
3LUDF\
3LUDF\RIFRS\ULJKWPDWHULDORQWKH,QWHUQHWLVDQRQJRLQJSUREOHPDFURVVDOOPHGLD$W3DFNW
ZHWDNHWKHSURWHFWLRQRIRXUFRS\ULJKWDQGOLFHQVHVYHU\VHULRXVO\,I\RXFRPHDFURVVDQ\
LOOHJDOFRSLHVRIRXUZRUNVLQDQ\IRUPRQWKH,QWHUQHWSOHDVHSURYLGHXVZLWKWKHORFDWLRQ
DGGUHVVRUZHEVLWHQDPHLPPHGLDWHO\VRWKDWZHFDQSXUVXHDUHPHG\
3OHDVHFRQWDFWXVDWcopyright@packtpub.comZLWKDOLQNWRWKHVXVSHFWHGSLUDWHGPDWHULDO
:HDSSUHFLDWH\RXUKHOSLQSURWHFWLQJRXUDXWKRUVDQGRXUDELOLW\WREULQJ\RXYDOXDEOHFRQWHQW
4XHVWLRQV
<RXFDQFRQWDFWXVDWquestions@packtpub.comLI\RXDUHKDYLQJDSUREOHPZLWKDQ\
DVSHFWRIWKHERRNDQGZHZLOOGRRXUEHVWWRDGGUHVVLW



5HSOLFDWLRQ
,QWKLVFKDSWHUZHZLOOGLVFXVV
f
6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRIDVHUYHUEDVHGRQD64/GXPS
f
6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRIDVHOHFWLRQRIWDEOHVEDVHGRQD64/GXPS
f
6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVXVLQJGDWDÀOHFRS\
f
6KDULQJUHDGORDGDFURVVPXOWLSOHPDFKLQHV
f
8VLQJUHSOLFDWLRQWRSURYLGHIXOOWH[WLQGH[LQJIRU,QQR'%WDEOHV
f
(VWLPDWLQJQHWZRUNDQGVODYH,2ORDG
f
/LPLWLQJQHWZRUNDQGVODYH,2ORDGLQKHDY\ZULWHVFHQDULRVXVLQJWKHEODFNKROH
VWRUDJHHQJLQH
f
6HWWLQJXSVODYHVYLDQHWZRUNVWUHDPLQJ
f
6NLSSLQJSUREOHPDWLFTXHULHV
f
&KHFNLQJLIVHUYHUVDUHLQV\QF
f
$YRLGLQJGXSOLFDWHVHUYHU,'V
f
6HWWLQJXSVODYHVWRUHSRUWFXVWRPLQIRUPDWLRQDERXWWKHPVHOYHVWRWKHPDVWHU
,QWURGXFWLRQ
5HSOLFDWLRQLVDQLQWHUHVWLQJIHDWXUHRI0\64/WKDWFDQEHXVHGIRUDYDULHW\RISXUSRVHV
,WFDQKHOSWREDODQFHVHUYHUORDGDFURVVPXOWLSOHPDFKLQHVHDVHEDFNXSVSURYLGHD
ZRUNDURXQGIRUWKHODFNRIIXOOWH[WVHDUFKFDSDELOLWLHVLQ,QQR'%DQGPXFKPRUH

5HSOLFDWLRQ

7KHEDVLFLGHDEHKLQGUHSOLFDWLRQLVWRUHÁHFWWKHFRQWHQWVRIRQHGDWDEDVHVHUYHUWKLV
FDQLQFOXGHDOOGDWDEDVHVRQO\VRPHRIWKHPRUHYHQMXVWDIHZWDEOHVWRPRUHWKDQRQH
LQVWDQFH8VXDOO\WKRVHLQVWDQFHVZLOOEHUXQQLQJRQVHSDUDWHPDFKLQHVHYHQWKRXJKWKLVLV
QRWWHFKQLFDOO\QHFHVVDU\
7UDGLWLRQDOO\0\64/UHSOLFDWLRQLVEDVHGRQWKHVXUSULVLQJO\VLPSOHLGHDRIUHSHDWLQJWKH
H[HFXWLRQRIDOOVWDWHPHQWVLVVXHGWKDWFDQPRGLI\GDWD³QRWSELECT³DJDLQVWDVLQJOHPDVWHU
PDFKLQHRQRWKHUPDFKLQHVDVZHOO3URYLGHGDOOVHFRQGDU\VODYHPDFKLQHVKDGLGHQWLFDOGDWD
FRQWHQWVZKHQWKHUHSOLFDWLRQSURFHVVEHJDQWKH\VKRXOGDXWRPDWLFDOO\UHPDLQLQV\QF7KLV
LVFDOOHG6WDWHPHQW%DVHG5HSOLFDWLRQ6%5
:LWK0\64/5RZ%DVHG5HSOLFDWLRQ5%5ZDVDGGHGDVDQDOWHUQDWLYHPHWKRGIRU
UHSOLFDWLRQWDUJHWLQJVRPHRIWKHGHÀFLHQFLHV6%5EULQJVZLWKLW:KLOHDWÀUVWJODQFHLWPD\
VHHPVXSHULRUDQGPRUHUHOLDEOHLWLVQRWDVLOYHUEXOOHW³WKHSDLQSRLQWVRI5%5DUHVLPSO\
GLIIHUHQWIURPWKRVHRI6%5
(YHQWKRXJKWKHUHDUHFHUWDLQXVHFDVHVIRU5%5DOOUHFLSHVLQWKLVFKDSWHUZLOOEHXVLQJ
6WDWHPHQW%DVHG5HSOLFDWLRQ
:KLOH0\64/PDNHVUHSOLFDWLRQJHQHUDOO\HDV\WRXVHLWLVVWLOOLPSRUWDQWWRXQGHUVWDQG
ZKDWKDSSHQVLQWHUQDOO\WREHDEOHWRNQRZWKHOLPLWDWLRQVDQGFRQVHTXHQFHVRIWKHDFWLRQV
DQGGHFLVLRQV\RXZLOOKDYHWRPDNH:HDVVXPH\RXDOUHDG\KDYHDEDVLFXQGHUVWDQGLQJRI
UHSOLFDWLRQLQJHQHUDOEXWZHZLOOVWLOOJRLQWRDIHZLPSRUWDQWGHWDLOV
6WDWHPHQW%DVHG5HSOLFDWLRQ
6%5LVEDVHGRQDVLPSOHEXWHIIHFWLYHSULQFLSOHLIWZRRUPRUHPDFKLQHVKDYHWKHVDPHVHW
RIGDWDWREHJLQZLWKWKH\ZLOOUHPDLQLGHQWLFDOLIDOORIWKHPH[HFXWHWKHH[DFWVDPH64/
VWDWHPHQWVLQWKHVDPHRUGHU
([HFXWLQJDOOVWDWHPHQWVPDQXDOO\RQPXOWLSOHPDFKLQHVZRXOGEHH[WUHPHO\WHGLRXVDQG
LPSUDFWLFDO6%5DXWRPDWHVWKLVSURFHVV,QVLPSOHWHUPVLWWDNHVFDUHRIVHQGLQJDOOWKH
64/VWDWHPHQWVWKDWFKDQJHGDWDRQRQHVHUYHUWKHPDVWHUWRDQ\QXPEHURIDGGLWLRQDO
LQVWDQFHVWKHVODYHVRYHUWKHQHWZRUN
7KHVODYHVUHFHLYLQJWKLVVWUHDPRIPRGLÀFDWLRQVWDWHPHQWVH[HFXWHWKHPDXWRPDWLFDOO\
WKHUHE\HIIHFWLYHO\UHSURGXFLQJWKHFKDQJHVWKHPDVWHUPDFKLQHPDGHWRLWVGDWDRULJLQDOO\
7KDWZD\WKH\ZLOONHHSWKHLUORFDOGDWDÀOHVLQV\QFZLWKWKHPDVWHU
V
2QHWKLQJZRUWKQRWLQJKHUHLVWKDWWKHQHWZRUNFRQQHFWLRQEHWZHHQWKHPDVWHUDQGLWV
VODYHVQHHGQRWEHSHUPDQHQW,QFDVHWKHOLQNEHWZHHQDVODYHDQGLWVPDVWHUIDLOVWKH
VODYHZLOOUHPHPEHUXSWRZKLFKSRLQWLWKDGUHDGWKHGDWDODVWWLPHDQGZLOOFRQWLQXHIURP
WKHUHRQFHWKHQHWZRUNEHFRPHVDYDLODEOHDJDLQ

&KDSWHU

,QRUGHUWRPLQLPL]HWKHGHSHQGHQF\RQWKHQHWZRUNOLQNWKHVODYHVZLOOUHWULHYHWKHELQDU\
ORJVELQORJVIURPWKHPDVWHUDVTXLFNO\DVWKH\FDQVWRULQJWKHPRQWKHLUORFDOGLVNLQ
ÀOHVFDOOHGUHOD\ORJV7KLVZD\WKHFRQQHFWLRQZKLFKPLJKWEHVRPHVRUWRIGLDOXSOLQN
FDQEHWHUPLQDWHGPXFKVRRQHUZKLOHH[HFXWLQJWKHVWDWHPHQWVIURPWKHORFDOUHOD\ORJ
DV\QFKURQRXVO\7KHUHOD\ORJLVMXVWDFRS\RIWKHPDVWHU
VELQORJ
7KHIROORZLQJLPDJHVKRZVWKHRYHUDOODUFKLWHFWXUH
...
binlog
INSERT (1)
UPDATE (2)
DELETE (3)
UPDATE(4)
...
[mysqld]
"onlydo(1)+
(4)"
INSERT (1)
UPDATE (2)
DELETE (3)
UPDATE(4)
...
[mysqld]
"onlydo(2)+
(3)
Therelaylogis
writtentodiskas
statements
arrive.Itisasbig
asthemaster's
binlog.
Theslavescan
besetupto
onlyapplya
subsetofthe
relaylog.
INSERT (1)
UPDATE (2)
DELETE (3)
UPDATE(4)
...
[mysqld]
.....
......
Thebinlog
containsall
statementsthat
modifydataon
themaster.
Thebinlogissentto
allslavesoverthe
network
individually.
NetworkLinkstothemaster
maygodowntemporarily.
Affectedslaveswillfallbehind,
butcatchupautomatically
whentheconnectionisre-
established.
Theoverallamount
ofdatasentisthe
binlogsizetimesthe
numberofslaves.
StatementBasedReplication
MasterServer
MasterDB
Files
INSERT(1)
UPDATE(2)
DELETE(3)
UPDATE(4)
NetWork
SlaveServer1
SlaveServer2
SlaveServern
relay-Log
relay-Log
relay-Log
my.cnf
my.cnf
my.cnf
SlaveDB1
Files
SlaveDB2
Files
SlaveDBn
Files
)LOWHULQJ
,QWKHLPDJH\RXFDQVHHWKDWHDFKVODYHPD\KDYHLWVLQGLYLGXDOFRQÀJXUDWLRQRQZKHWKHULW
H[HFXWHVDOOWKHVWDWHPHQWVFRPLQJLQIURPWKHPDVWHURUMXVWDVHOHFWLRQRIWKRVH7KLVFDQ
EHKHOSIXOZKHQ\RXKDYHVRPHVODYHVGHGLFDWHGWRVSHFLDOWDVNVZKHUHWKH\PLJKWQRWQHHG
DOOWKHLQIRUPDWLRQIURPWKHPDVWHU
$OORIWKHELQDU\ORJVKDYHWREHVHQWWRHDFKVODYHHYHQWKRXJKLWPLJKWWKHQGHFLGHWR
WKURZDZD\PRVWRIWKHP'HSHQGLQJRQWKHVL]HRIWKHELQORJVWKHQXPEHURIVODYHVDQG
WKHEDQGZLGWKRIWKHFRQQHFWLRQVLQEHWZHHQWKLVFDQEHDKHDY\EXUGHQRQWKHQHWZRUN
HVSHFLDOO\LI\RXDUHUHSOLFDWLQJYLDZLGHDUHDQHWZRUNV

5HSOLFDWLRQ

(YHQWKRXJKWKHJHQHUDOLGHDRIWUDQVIHUULQJ64/VWDWHPHQWVRYHUWKHZLUHLVUDWKHU
VLPSOHWKHUHDUHORWVRIWKLQJVWKDWFDQJRZURQJHVSHFLDOO\EHFDXVH0\64/RIIHUVVRPH
FRQÀJXUDWLRQRSWLRQVWKDWDUHTXLWHFRXQWHULQWXLWLYHDQGOHDGWRKDUGWRÀQGSUREOHPV
)RUXVWKLVKDVEHFRPHDEHVWSUDFWLFH
2QO\XVHTXDOLÀHGVWDWHPHQWVDQGreplicate-*-tableFRQÀJXUDWLRQRSWLRQVIRULQWXLWLYHO\
SUHGLFWDEOHUHSOLFDWLRQ
:KDWWKLVPHDQVLVWKDWWKHRQO\ÀOWHULQJUXOHVWKDWSURGXFHLQWXLWLYHUHVXOWVDUHWKRVHEDVHG
RQWKHreplicate-do-tableDQGreplicate-ignore-tableFRQÀJXUDWLRQRSWLRQV7KLV
LQFOXGHVWKRVHYDULDQWVZLWKZLOGFDUGVEXWVSHFLÀFDOO\H[FOXGHVWKHDOOGDWDEDVHRSWLRQVOLNH
replicate-do-dbDQGreplicate-ignore-db7KHVHGLUHFWLYHVDUHDSSOLHGRQWKHVODYH
VLGHRQDOOLQFRPLQJUHOD\ORJV
7KHPDVWHUVLGHbinlog-do-*DQGbinlog-ignore-*FRQÀJXUDWLRQGLUHFWLYHVLQÁXHQFH
ZKLFKVWDWHPHQWVDUHVHQWWRWKHELQORJDQGZKLFKDUHQRW:HVWURQJO\UHFRPPHQGDJDLQVW
XVLQJWKHPEHFDXVHDSDUWIURPKDUGWRSUHGLFWUHVXOWVWKH\ZLOOPDNHWKHELQORJVXQGHVLUDEOH
IRUVHUYHUEDFNXSDQGUHVWRUH7KH\DUHRIWHQRIOLPLWHGXVHDQ\ZD\DVWKH\GRQRWDOORZ
LQGLYLGXDOFRQÀJXUDWLRQVSHUVODYHEXWDSSO\WRDOORIWKHP
)RUWKHVHUHDVRQV\RXZLOOQRWÀQGDQ\XVHRIWKHVHRSWLRQVLQWKLVERRN
6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRI
DVHUYHUEDVHGRQD64/GXPS
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRSUHSDUHDGXPSÀOHRID0\64/PDVWHUVHUYHUDQGXVH
LWWRVHWXSRQHRUPRUHUHSOLFDWLRQVODYHV7KHVHZLOODXWRPDWLFDOO\EHXSGDWHGZLWKFKDQJHV
PDGHRQWKHPDVWHUVHUYHURYHUWKHQHWZRUN
*HWWLQJUHDG\
<RXZLOOQHHGDUXQQLQJ0\64/PDVWHUGDWDEDVHVHUYHUWKDWZLOODFWDVWKHUHSOLFDWLRQPDVWHU
DQGDWOHDVWRQHPRUHVHUYHUWRDFWDVDUHSOLFDWLRQVODYH7KLVQHHGVWREHDVHSDUDWH0\64/
LQVWDQFHZLWKLWVRZQGDWDGLUHFWRU\DQGFRQÀJXUDWLRQ,WFDQUHVLGHRQWKHVDPHPDFKLQH
LI\RXMXVWZDQWWRWU\WKLVRXW,QSUDFWLFHDVHFRQGPDFKLQHLVUHFRPPHQGHGEHFDXVHWKLV
WHFKQLTXH
VYHU\JRDOLVWRGLVWULEXWHGDWDDFURVVPXOWLSOHSLHFHVRIKDUGZDUHQRWSODFHDQ
HYHQKLJKHUEXUGHQRQDVLQJOHRQH
)RUSURGXFWLRQV\VWHPV\RXVKRXOGSLFNDWLPHWRGRWKLVZKHQWKHUHLVDOLJKWHUORDGRQWKH
PDVWHUPDFKLQHRIWHQGXULQJWKHQLJKWZKHQWKHUHDUHOHVVXVHUVDFFHVVLQJWKHV\VWHP
7DNLQJWKH64/GXPSXVHVVRPHH[WUDUHVRXUFHVEXWXQOHVV\RXUVHUYHULVPD[HGRXWDOUHDG\
WKHSHUIRUPDQFHLPSDFWXVXDOO\LVQRWDVHULRXVSUREOHP([DFWO\KRZORQJWKHGXPSZLOOWDNH
GHSHQGVPRVWO\RQWKHDPRXQWRIGDWDDQGVSHHGRIWKH,2VXEV\VWHP

&KDSWHU

<RXZLOOQHHGDQDGPLQLVWUDWLYHRSHUDWLQJV\VWHPDFFRXQWRQWKHPDVWHUDQGWKHVODYHVHUYHUV
WRHGLWWKH0\64/VHUYHUFRQÀJXUDWLRQÀOHVRQERWKRIWKHP0RUHRYHUDQDGPLQLVWUDWLYH
0\64/GDWDEDVHXVHULVUHTXLUHGWRVHWXSUHSOLFDWLRQ
:HZLOOMXVWUHSOLFDWHDVLQJOHGDWDEDVHFDOOHGsakilaLQWKLVH[DPSOH
5HSOLFDWLQJPRUHWKDQRQHGDWDEDVH
,QFDVH\RXZDQWWRUHSOLFDWHPRUHWKDQRQHVFKHPDMXVWDGGWKHLU
QDPHVWRWKHFRPPDQGVVKRZQEHORZ7RUHSOLFDWHDOORIWKHPMXVW
OHDYHRXWDQ\GDWDEDVHQDPHIURPWKHFRPPDQGOLQH
+RZWRGRLW

$WWKHRSHUDWLQJV\VWHPOHYHOFRQQHFWWRWKHPDVWHUPDFKLQHDQGRSHQ
WKH0\64/FRQÀJXUDWLRQÀOHZLWKDWH[WHGLWRU8VXDOO\LWLVFDOOHGmy.iniRQ:LQGRZV
DQGmy.cnfRQRWKHURSHUDWLQJV\VWHPV

2QWKHPDVWHUPDFKLQHPDNHVXUHWKHIROORZLQJHQWULHVDUHSUHVHQWDQGDGGWKHPWR
WKH[mysqld]VHFWLRQLIQRWDOUHDG\WKHUH
server-id=1000 
log-bin=master-bin
,IRQHRUERWKHQWULHVDOUHDG\H[LVWGRQRWFKDQJHWKHPEXWVLPSO\QRWHWKHLUYDOXHV
7KHlog-binVHWWLQJQHHGQRWKDYHDYDOXHEXWFDQVWDQGDORQHDVZHOO

5HVWDUWWKHPDVWHUVHUYHULI\RXQHHGWRPRGLI\WKHFRQÀJXUDWLRQ

&UHDWHDXVHUDFFRXQWRQWKHPDVWHUWKDWFDQEHXVHGE\WKHVODYHVWRFRQQHFW
master> grant replication slave on *.* to 'repl'@'%' identified by 
'slavepass'; 
 8VLQJWKHmysqldumpWRROLQFOXGHGLQWKHGHIDXOW0\64/LQVWDOOFUHDWHWKHLQLWLDOFRS\
WRVHWXSWKHVODYHV
    $ mysqldump -u86(5 -p3$66 --master-data --single-transaction 
    sakila > sakila_master.sql

7UDQVIHUWKHsakila_master.sqlGXPSÀOHWRHDFKVODYH\RXZDQWWRVHWXSIRU
H[DPSOHE\XVLQJDQH[WHUQDOGULYHRUQHWZRUNFRS\

5HSOLFDWLRQ


2QWKHVODYHPDNHVXUHWKHIROORZLQJHQWULHVDUHSUHVHQWDQGDGGWKHPWRWKH
[mysqld]VHFWLRQLIQRWSUHVHQW
server-id=1001 
replicate-wild-do-table=sakila.%
:KHQDGGLQJPRUHWKDQRQHVODYHPDNHVXUHWKHserver-idVHWWLQJLVXQLTXH
DPRQJPDVWHUDQGDOOFOLHQWV

5HVWDUWWKHVODYHVHUYHU

&RQQHFWWRWKHVODYHVHUYHUDQGLVVXHWKHIROORZLQJFRPPDQGVDVVXPLQJWKHGDWD
GXPSZDVVWRUHGLQWKH/tmpGLUHFWRU\
slave> create database sakila; 
slave> use sakila; 
slave> source /tmp/sakila_master.sql; 
slave> CHANGE MASTER TO master_host='master.example.com',  
master_port=3306, master_ user='repl',  
master_password='slavepass';
slave> START SLAVE;

9HULI\WKHVODYHLVUXQQLQJZLWK
slave> SHOW SLAVE STATUS\G
************************** 1. row ***************************
                        ...
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                        ...
+RZLWZRUNV
6RPHRIWKHLQVWUXFWLRQVGLVFXVVHGLQWKHSUHYLRXVVHFWLRQDUHWRPDNHVXUHWKDWERWKPDVWHU
DQGVODYHDUHFRQÀJXUHGZLWKGLIIHUHQWserver-idVHWWLQJV7KLVLVRISDUDPRXQWLPSRUWDQFH
IRUDVXFFHVVIXOUHSOLFDWLRQVHWXS,I\RXIDLOWRSURYLGHXQLTXHserver-idYDOXHVWRDOO\RXU
VHUYHULQVWDQFHV\RXPLJKWVHHVWUDQJHUHSOLFDWLRQHUURUVWKDWDUHKDUGWRGHEXJ
0RUHRYHUWKHPDVWHUPXVWEHFRQÀJXUHGWRZULWHELQORJV³DUHFRUGRIDOOVWDWHPHQWV
PDQLSXODWLQJGDWDWKLVLVZKDWWKHVODYHVZLOOUHFHLYH
%HIRUHWDNLQJDIXOOFRQWHQWGXPSRIWKHsakilaGHPRGDWDEDVH
ZHFUHDWHDXVHUDFFRXQWIRUWKHVODYHVWRXVH7KLVQHHGVWKH
5(3/,&$7,216/$9(SULYLOHJH

&KDSWHU

7KHQDGDWDGXPSLVFUHDWHGZLWKWKHmysqldumpFRPPDQGOLQHWRRO1RWLFHWKHSURYLGHG
SDUDPHWHUV--master-dataDQG--single-transaction7KHIRUPHULVQHHGHGWRKDYH
mysqldumpLQFOXGHLQIRUPDWLRQDERXWWKHSUHFLVHPRPHQWWKHGXPSZDVFUHDWHGLQWKH
UHVXOWLQJRXWSXW7KHODWWHUSDUDPHWHULVLPSRUWDQWZKHQXVLQJ,QQR'%WDEOHVEHFDXVHRQO\
WKHQZLOOWKHGXPSEHFUHDWHGEDVHGRQDWUDQVDFWLRQDOVQDSVKRWRIWKHGDWD:LWKRXWLW
VWDWHPHQWVFKDQJLQJGDWDZKLOHWKHWRROZDVUXQQLQJFRXOGOHDGWRDQLQFRQVLVWHQWGXPS
7KHRXWSXWRIWKHFRPPDQGLVUHGLUHFWHGWRWKH/tmp/sakila_master.sqlÀOH$VWKH
sakilaGDWDEDVHLVQRWYHU\ELJ\RXVKRXOGQRWVHHDQ\SUREOHPV+RZHYHULI\RXDSSO\WKLV
UHFLSHWRODUJHUGDWDEDVHVPDNHVXUH\RXVHQGWKHGDWDWRDYROXPHZLWKVXIÀFLHQWIUHHGLVN
VSDFH³WKH64/GXPSFDQEHFRPHTXLWHODUJH7RVDYHVSDFHKHUH\RXPD\RSWLRQDOO\SLSH
WKHRXWSXWWKURXJKgzipRUbzip2DWWKHFRVWRIDKLJKHU&38ORDGRQERWKWKHPDVWHUDQG
WKHVODYHVEHFDXVHWKH\ZLOOQHHGWRXQSDFNWKHGXPSEHIRUHWKH\FDQORDGLWRIFRXUVH
,I\RXRSHQWKHXQFRPSUHVVHGGXPSÀOHZLWKDQHGLWRU\RXZLOOVHHDOLQHZLWKDCHANGE 
MASTERTOVWDWHPHQW7KLVLVZKDW--master-dataLVIRU2QFHWKHÀOHLVLPSRUWHGRQD
VODYHLWZLOONQRZDWZKLFKSRLQWLQWLPHZHOOUDWKHUDWZKLFKELQORJSRVLWLRQWKLVGXPSZDV
WDNHQ(YHU\WKLQJWKDWKDSSHQHGRQWKHPDVWHUDIWHUWKDWQHHGVWREHUHSOLFDWHG
)LQDOO\ZHFRQÀJXUHWKDWVODYHWRXVHWKHFUHGHQWLDOVVHWXSRQWKHPDVWHUEHIRUHWRFRQQHFW
DQGWKHQVWDUWWKHUHSOLFDWLRQ1RWLFHWKDWWKHCHANGEMASTERTOVWDWHPHQWXVHGIRUWKDW
GRHVQRWLQFOXGHWKHLQIRUPDWLRQDERXWWKHORJSRVLWLRQVRUÀOHQDPHVEHFDXVHWKDWZDV
DOUHDG\WDNHQIURPWKHGXPSÀOHMXVWUHDGLQ
)URPKHUHRQWKHVODYHZLOOJRDKHDGDQGUHFRUGDOO64/VWDWHPHQWVVHQWIURPWKHPDVWHU
VWRUHWKHPLQLWVUHOD\ORJVDQGWKHQH[HFXWHWKHPDJDLQVWWKHORFDOGDWDVHW
7KLVUHFLSHLVYHU\LPSRUWDQWEHFDXVHWKHIROORZLQJUHFLSHVDUH
EDVHGRQWKLV6RLQFDVH\RXKDYHQRWIXOO\XQGHUVWRRGWKHDERYH
VWHSV\HWZHUHFRPPHQG\RXJRWKURXJKWKHPDJDLQEHIRUHWU\LQJ
RXWPRUHFRPSOLFDWHGVHWXSV
6HHDOVR
f
$YRLGLQJGXSOLFDWHVHUYHU,'V

5HSOLFDWLRQ

6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHVRI
DVHOHFWLRQRIWDEOHVEDVHGRQD64/GXPS
2IWHQ\RXPLJKWQRWQHHGWRUHSOLFDWHHYHU\WKLQJEXWRQO\DVXEVHWRIWDEOHVLQDGDWDEDVH
0\64/DOORZVH[HUFLVLQJÀQHJUDLQHGFRQWURORYHUZKDWWRUHSOLFDWHDQGZKDWWRLJQRUH
8QIRUWXQDWHO\WKHFRQÀJXUDWLRQVHWWLQJVDUHQRWDVREYLRXVDVWKH\PLJKWVHHPDWÀUVWJODQFH
,QWKLVUHFLSH\RXZLOOVHHKRZWRUHSOLFDWHRQO\DIHZVHOHFWWDEOHVIURPDGDWDEDVH
*HWWLQJUHDG\
7KHVHWXSIRUWKLVUHFLSHLVWKHVDPHDVIRUWKHSUHYLRXVRQH6HWWLQJXSDXWRPDWLFDOO\
XSGDWHGVODYHVRIDVHUYHUEDVHGRQD64/GXPS2QO\WKHFRQÀJXUDWLRQRSWLRQVRQWKH
VODYHQHHGWREHFKDQJHG6RLQVWHDGRIUHSHDWLQJHYHU\WKLQJKHUHZHMXVWSUHVHQWWKH
LPSRUWDQWGLIIHUHQFHV
+RZWRGRLW

)ROORZWKHVWHSVRIWKHSUHYLRXVUHFLSHXSWRWKHSRLQWZKHUHWKHmysqldumpWRROLV
XVHGWRH[WUDFWWKHLQLWLDOGDWDVHWIURPWKHPDVWHU8VHWKLVFRPPDQGLQVWHDG
$ mysqldump -uUSER -pPASS --master-data --single-transaction 
   sakila address country city > sakila_master.sql

*RRQZLWKWKHVWHSVRIWKHSUHYLRXVUHFLSH
XSWRWKHSRLQWZKHUHLWWHOOV\RXWRHGLWWKHVODYHPDFKLQH
VFRQÀJXUDWLRQ&KDQJHWKH
FRQÀJXUDWLRQDVIROORZVLQVWHDGLQWKH[mysqld]VHFWLRQ
server-id=1001 
replicate-wild-ignore-table=sakila.%
replicate-do-table=sakila.address
replicate-do-table=sakila.country
replicate-do-table=sakila.city

&RQWLQXHZLWKWKHUHVWRIWKHLQVWUXFWLRQVDVLQWKH6HWWLQJXSDXWRPDWLFDOO\XSGDWHG
VODYHVRIDVHUYHUEDVHGRQD64/GXPSUHFLSH

&KDSWHU

+RZLWZRUNV
7KH64/GXPSÀOHWDNHQRQWKHPDVWHULVOLPLWHGWRWKUHHWDEOHVaddresscountryDQG
city7KHVODYH
VFRQÀJXUDWLRQDOVRWHOOVLWWRRQO\H[HFXWHVWDWHPHQWVFRPLQJIURPWKH
PDVWHUWKDWWDUJHWVRQHRIWKHVHWKUHHWDEOHVreplicate-do-tableGLUHFWLYHVZKLOH
RYHUWO\LJQRULQJDQ\RWKHUFKDQJHVLQWKHsakilaGDWDEDVHreplicate-wild-ignore-
table(YHQWKRXJKDOORWKHUVWDWHPHQWVDUHVWLOOUHWULHYHGIURPWKHPDVWHUDQGVWRUHG
WHPSRUDULO\LQWKHUHOD\ORJÀOHVRQWKHVODYHRQO\WKRVHZLWKPRGLÀFDWLRQVWRRQHRIWKHWKUHH
WDEOHVH[SOLFLWO\FRQÀJXUHGDUHDFWXDOO\UXQ7KHUHVWDUHGLVFDUGHG
<RXFDQFKRRVHDQ\VXEVHWRIWDEOHVEXW\RXQHHGWRPDNHVXUHWRWDNH)RUHLJQNH\
UHODWLRQVKLSVEHWZHHQWDEOHVLQWRDFFRXQW,QWKLVH[DPSOHWKHaddressWDEOHKDVD
UHIHUHQFHWRWKHcityWDEOHYLDWKHcity_idFROXPQZKLOHcityLQWXUQKDVDUHODWLRQVKLS
ZLWKcountry,I\RXZHUHWRH[FOXGHHLWKHURQHRIWKHODWWHUDQG\RXUVWRUDJHHQJLQHRQWKH
VODYHZDV,QQR'%UHSOLFDWLRQZRXOGEUHDNEHFDXVHRI)RUHLJQNH\YLRODWLRQVZKHQWU\LQJWR
LQVHUWDQDGGUHVVVLQFHLWVGHSHQGHQFLHVZHUHQRWIXOÀOOHG
0\64/GRHVQRWKHOS\RXLQWKLVUHVSHFW\RXPXVWPDNHVXUHWRLGHQWLI\DOOWDEOHVDQGWKHLU
UHODWLRQVKLSVPDQXDOO\EHIRUHVHWWLQJXSWKHUHSOLFDWLRQ
7KHUH
VPRUH
,QWKLVH[DPSOHZHFOHDUO\VSHFLÀHGWKUHHWDEOHVE\WKHLUIXOOQDPHV7KHUHDUHPRUHRSWLRQV
DYDLODEOHQRWRQO\WRLQFOXGHEXWDOVRWRH[FOXGHWDEOHV6HHWKH0\64/RQOLQHPDQXDO
V
FKDSWHURQ5HSOLFDWLRQ6ODYH2SWLRQVDQG9DULDEOHVIRUPRUHLQIRUPDWLRQRQWKHVHDW
http://dev.mysql.com/doc/refman/5.1/en/replication-options-slave.html
6HWWLQJXSDXWRPDWLFDOO\XSGDWHGVODYHV
XVLQJGDWDÀOHFRS\
(YHQWKRXJKUHSOLFDWLRQLVGHVLJQHGWRNHHS\RXUGDWDLQV\QFFLUFXPVWDQFHVPLJKWUHTXLUH
\RXWRVHWXSVODYHVDIUHVK2QHVXFKVFHQDULRPLJKWEHVHYHUHO\FKDQJLQJWKHPDVWHUGDWD
PDNLQJUHSOLFDWLRQWRRH[SHQVLYH8VLQJD64/GXPSWRUHLQLWLDOL]HWKHVODYHVPLJKWEHWRR
WLPHFRQVXPLQJGHSHQGLQJRQWKHVL]HRIWKHGDWDVHWDQGWKHSRZHURIWKHVODYHPDFKLQHV
,QFDVHVZKHUHPDVWHUDQGVODYHGDWDEDVHVDUHWKHVDPHVL]HDQ\ZD\PHDQLQJ\RXGRQRW
KDYHÀOWHUVLQSODFHWRV\QFGDWDRQO\SDUWLDOO\DQGLI\RXFDQDIIRUGDGRZQWLPHRQWKHPDVWHU
GDWDEDVHWKHUHLVDQRWKHUZD\RISURYLGLQJVODYHVZLWKDIUHVKVWDUWLQJSRLQWFRS\LQJWKH
PDVWHU
VGDWDÀOHVWRWKHVODYH
%HZDUHWKDWWKLVDSSURDFKZLOOORVHDOOGDWDWKDWZDVFKDQJHG
RQWKHVODYHDORQH6RPDNHVXUHWKDWWKLVLVZKDW\RXZDQW

5HSOLFDWLRQ

*HWWLQJUHDG\
7RIROORZDORQJZLWKWKLVUHFLSH\RXZLOOQHHGSULYLOHJHVWRVKXWGRZQERWKPDVWHUDQGVODYH
0\64/LQVWDQFHVDQGDFFHVVWKHGDWDDQGORJGLUHFWRULHVRQERWKPDFKLQHV'HSHQGLQJRQ
WKHVL]HRI\RXUGDWDEDVH\RXZLOOKDYHWRMXGJHZKLFKPHWKRGRIFRS\LQJZLOOEHWKHEHVW
EHWZHHQWKHPDFKLQHV,IERWKDUHSDUWRIDORFDODUHDQHWZRUNFRS\LQJYLDDVKDUHGGULYH
RUVRPHWKLQJOLNH)73ZLOOSUREDEO\EHWKHIDVWHVWZD\<RXPLJKWKRZHYHUQHHGWRUHVRUWWR
RWKHUPHDQVRIGDWDWUDQVIHUOLNHH[WHUQDOKDUGGLVNVRUWKHOLNHZKHQRQO\OLPLWHGEDQGZLGWK
LVDYDLODEOH
0RUHRYHU\RXZLOOQHHGDGPLQLVWUDWLYH0\64/XVHUDFFRXQWVRQERWKVLGHVWRH[HFXWHWKH
QHFHVVDU\VWDWHPHQWVWRFRQWUROUHSOLFDWLRQ
+RZWRGRLW

2SHQWKHPDVWHU
VFRQÀJXUDWLRQÀOHZLWKDWH[WHGLWRU/RFDWHWKHOLQHFRQWUROOLQJWKH
QDPHRIWKHELQORJÀOHV,WLVORFDWHGLQWKH[mysqld]VHFWLRQDQGZLOOORRNVLPLODU
WRWKLV
[mysql] 
... 
log-bin=master-bin 
...

&KDQJHWKHYDOXHRIWKDWVHWWLQJWR
DGLIIHUHQWQDPH,QWKLVH[DPSOHZHZLOOXVHlog-bin=new-master-bin7KLVZLOO
FDXVHWKHPDVWHU0\64/VHUYHUWRVWDUWZLWKDQHZVHTXHQFHRIELQORJVXSRQLWVQH[W
ODXQFKPDNLQJDFRQYHQLHQWVWDUWLQJSRLQWIRUWKHUHSOLFDWLRQ

6KXWGRZQWKHPDVWHUGDWDEDVH

1DYLJDWHWRWKH0\64/GDWDGLUHFWRU\7KHH[DFWORFDWLRQFDQEHIRXQGLQWKH0\64/
FRQÀJXUDWLRQÀOH0DNHVXUHWRÀQGERWK,QQR'%GDWDDQGORJORFDWLRQV

2SWLRQDOO\FRS\GDWDDQGORJÀOHVWRDQRWKHUORFDWLRQORFDOO\RQWKHPDVWHU7KLVPLJKW
EHIDVWHUWKDQFRS\LQJYLDQHWZRUNRU86%GULYHVDQGDOORZVIRUDTXLFNUHVWDUWRIWKH
PDVWHU,I\RXGRWKLVXVHWKLVWHPSRUDU\ORFDWLRQWRFRS\WKHGDWDLQWKHQH[WVWHS

&RS\WKHGDWDWRWKHVODYHPDFKLQH:HUHFRPPHQGDWHPSRUDU\WDUJHWORFDWLRQRQWKH
VODYHEHFDXVHWKLVDOORZVWKHVODYHWRFRQWLQXHUXQQLQJIRUWKHWLPHWKHFRS\LQJWDNHV
8QOHVV\RXZDQWWREULQJDORQJDOOWKHXVHUDFFRXQWVDQGSULYLOHJHLQIRUPDWLRQIURPWKH
PDVWHUWRWKHVODYHV\RXVKRXOGH[FOXGHWKHmysqlIROGHUIURPWKHGDWDGLUHFWRU\<RX
DOVRQHHGQRWFRS\WKHELQDU\ORJVLQWKLVH[DPSOHFDOOHGmaster-bin.*

6WRSWKHVODYHVHUYHU

<RXFDQUHVWDUWWKHPDVWHURQFHWKHRULJLQDOGDWDDQGWUDQVDFWLRQORJÀOHVKDYHEHHQ
FRSLHG0DNHVXUHLWVWDUWVZLWKDQHZVHTXHQFHRIELQORJVFDOOHG
new-master-bin.000001

&KDSWHU


:ULWHGRZQ
WKHQDPHVDQGVL]HVRI,QQR'%GDWDDQGORJÀOHV\RXFRSLHGWRWKHVODYH7KHVHZLOO
KDYHWREHHQWHUHGLQWRWKHVODYH
VFRQÀJXUDWLRQEHFDXVHRWKHUZLVH,QQR'%ZLOOQRW
VWDUWXS$OVRSD\DWWHQWLRQWRDQautoextendRSWLRQZKLFKWKHODVWRIWKHGDWDÀOHV
PLJKWKDYHDWWDFKHG0DNHVXUH\RXFDUU\RYHUWKLVRSWLRQVKRXOGLWEHWKHUHRQWKH
PDVWHU<RXFDQDOVRWDNHWKHVHYDOXHVIURPWKHPDVWHU
VFRQÀJXUDWLRQÀOHRIFRXUVH

5HSODFHWKHRULJLQDOVODYHGDWDDQGORJÀOHVZLWKWKRVHRIWKHPDVWHU0DNHVXUH\RX
NHHSWKHmysqlGDWDEDVHGLUHFWRU\LI\RXGHFLGHGQRWWRFRS\LWIURPWKHPDVWHU

0DNHVXUH\RXGHOHWHWKHmaster.infoÀOH
DQGDQ\UHOD\ORJVIURPWKHVODYH³WKRVHGRQRWPDWFKWKHFXUUHQWVWDWHDQ\PRUHDQG
ZRXOGFDXVHWURXEOHZKHQWKHVODYHLVUHVWDUWHG

(GLWWKHVODYH
VFRQÀJXUDWLRQÀOHWRPDWFKWKHQDPHVDQGVL]HVRIWKHGDWDÀOHV\RX
ZURWHGRZQDPLQXWHDJR

6WDUWWKHVODYHVHUYHUDJDLQ,WVKRXOGFRPHXSZLWKRXWDQ\SUREOHPVXVLQJWKHQHZ
GDWDÀOHV,IQRWPDNHVXUH\RXJRWHYHU\WKLQJULJKWLQWKHFRQÀJÀOHUHJDUGLQJQDPHV
DQGVL]HVRIWKHGDWDÀOHV

5HLQLWLDOL]HWKHUHSOLFDWLRQRQWKHVODYH
7KLVLVUDWKHUHDV\EHFDXVHZHDOWHUHGWKHPDVWHU
VFRQÀJXUDWLRQWRORJDQ\FKDQJHV
WKDWRFFXUUHGDIWHUWKHVQDSVKRWFRS\ZDVWDNHQWRDQHZVHULHVRIELQORJÀOHV)LOOLQ
WKHDSSURSULDWHKRVWQDPHXVHUDQGSDVVZRUGYDOXHVIRU\RXUPDVWHU
slave> CHANGE MASTER TO MASTER_HOST='master', MASTER_USER='repl', 
MASTER_PASSWORD='slavepass', MASTER_LOG_FILE='new-master-
bin.000001';
slave> START SLAVE;
$VZHZDQWWKHVODYHWRVWDUWUHDGLQJWKHnew-master-bin.000001ÀOHIURPWKH
EHJLQQLQJQRMASTER_LOG_POSKDVWREHVSHFLÀHG

9HULI\ZKHWKHUWKHVODYHLVUXQQLQJZLWK
slave> SHOW SLAVE STATUS\G
************************** 1. row ***************************
                        ...
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                        ... 

5HSOLFDWLRQ

+RZLWZRUNV
7KHSULQFLSOHRIWKLVUHFLSHLVYHU\VLPSOHUHSOLFDWLRQQHHGVDFRPPRQVWDUWLQJSRLQWRQ
PDVWHUDQGVODYH:KDWFRXOGEHEHWWHUWKDQDFRS\RIWKHRULJLQDOPDVWHU
VGDWD"$VWKH
PDVWHULVVKXWGRZQGXULQJWKHSURFHVVQRPRUHZULWHVFDQKDSSHQ&RQÀJXULQJLWWRVWDUW
ZLWKDQHZELQORJÀOHRQLWVQH[WVWDUWPDNHVLWWULYLDOWRSRLQWWKHVODYHWRWKHULJKWSRVLWLRQ
EHFDXVHLWLVULJKWDWWKHQHZÀOH
VEHJLQQLQJ
,I\RXFDQQRWFKDQJHWKHPDVWHUELQORJV
ÀOHQDPHVWKHSURFHVVLVVOLJKWO\PRUHFRPSOLFDWHG
)LUVW\RXQHHGWRPDNHVXUHQRERG\FDQPRGLI\DQ\GDWDIRUDVKRUWSHULRGRIWLPH<RXGRVR
ZLWKDFLUSHTABLESWITHREADLOCK;VWDWHPHQW7KHQLVVXHDSHOWMASTERSTATUS;
DQGQRWHWKHYDOXHV1RZZLWKRXWFORVLQJWKHFOLHQWFRQQHFWLRQRUUHOHDVLQJWKHORFNVKXW
GRZQWKHPDVWHUVHUYHU2QO\LIWKHORFNLVNHSWZKLOHVKXWWLQJGRZQWKHPDVWHUFDQ\RXEH
VXUHQRZULWHRSHUDWLRQVWDNHSODFHDQGLQYDOLGDWHWKHELQORJSRVLWLRQ\RXMXVWJDWKHUHG
&RS\WKHGDWDDQGWUDQVDFWLRQORJÀOHVDVGHVFULEHGDERYH7KHUHPDLQLQJVWHSVDUHWKH
VDPHH[FHSWRIFRXUVHZKHQ\RXLVVXHWKHCHANGEMASTERTORQWKHVODYH+HUH\RX
QHHGWRLQVHUWWKHMASTER_LOG_FILEDQGMASTER_LOG_POS\RXJRWIURPSHOW 
MASTERSTATUS
7KHUH
VPRUH
7KHVWHSVGHVFULEHGDERYHUHTXLUH\RXWRWDNHGRZQERWKPDVWHUDQGVODYHGDWDEDVHVDOEHLW
QRWQHFHVVDULO\DWWKHVDPHWLPH1HYHUWKHOHVVWKLVPLJKWQRWEHDQRSWLRQLI\RXDUHGHDOLQJ
ZLWKDSURGXFWLRQV\VWHPWKDWFDQQRWEHVKXWGRZQHDVLO\
,QWKHVHFDVHV\RXKDYHVRPHRWKHURSWLRQVWKDWDUHKRZHYHUQRWH[SODLQHGLQGHWDLOKHUH
&RQVHUYLQJGDWDÀOHE\XVLQJ/90VQDSVKRWV
,I\RXUGDWDDQGORJÀOHVDUHVWRUHGRQDORJLFDOYROXPHPDQDJHGE\/90\RXFDQXVHLWV
VQDSVKRWIHDWXUHWRFRQVHUYHWKHGDWDÀOHV
VWDWHRQFH\RXKDYHJRWWKHSHOWMASTER
STATUSLQIRUPDWLRQ$VVRRQDVWKHVQDSVKRWKDVEHHQWDNHQ\RXFDQUHOHDVHWKHORFNDJDLQ
DQGSURFHHGDVGHVFULEHGDERYHFRS\LQJQRWWKHPRVWFXUUHQWYHUVLRQEXWWKHVQDSVKRWÀOHV
%HDGYLVHGKRZHYHUWKDWWKLVDSSURDFKPLJKWWDNHDVLJQLÀFDQWKLWRQWKH,2SHUIRUPDQFHRI
\RXPDVWHU
%DFNLQJXSGDWDXVLQJ3HUFRQD[WUDEDFNXS
$WWKHWLPHRIZULWLQJDQRSHQVRXUFHDOWHUQDWLYHWRWKHFRPPHUFLDOO\DYDLODEOHLQQREDFNXS
WRRODYDLODEOHIURPhttp://www.innodb.com/products/hot-backup/LVXQGHUDFWLYH
GHYHORSPHQW:KLOHEHLQJSULPDULO\DEDFNXSWRROWKDWDOORZVEDFNLQJXS,QQR'%GDWDEDVHV
ZKLOHWKHVHUYHULVXSDQGUXQQLQJWKHGRFXPHQWDWLRQFRQWDLQVDFXUUHQWO\HPSW\VHFWLRQRQ
VHWWLQJXSDVODYHIURPDEDFNXSLQUHSOLFDWLRQ([SHULHQFHWHOOVWKDW3HUFRQD³WKHFRPSDQ\

&KDSWHU

EHKLQG[WUDEDFNXS³LVYHU\HQJDJHGLQWKH0\64/HFRV\VWHPDQGPLJKWYHU\ZHOOKDYH
FRPSOHWHGLWVVHWRILQVWUXFWLRQVE\WKHWLPH\RXUHDGWKLV7RFKHFNRQWKHFXUUHQWVWDWXVRI
WKHSURMHFWJRWRhttps://launchpad.net/percona-xtrabackup
6KDULQJUHDGORDGDFURVVPXOWLSOHPDFKLQHV
2IWHQ\RXKDYHDYHU\XQHTXDOGLVWULEXWLRQRIUHDGDQGZULWHRSHUDWLRQVRQDGDWDEDVH
:HEVLWHVXVXDOO\JHWPDQ\PRUHYLVLWRUVMXVWEURZVLQJDQGUHDGLQJFRQWHQWVWKDQDFWXDOO\
FRQWULEXWLQJFRQWHQWV7KLVUHVXOWVLQWKHGDWDEDVHVHUYHUEHLQJPDLQO\EXV\UHDGLQJ
LQIRUPDWLRQLQVWHDGRIDGGLQJRUPRGLI\LQJH[LVWLQJPDWHULDO
5HSOLFDWLRQFDQEHXVHGWRDOOHYLDWHVFDODELOLW\LVVXHVZKHQ\RXUVLWHUHDFKHVDFHUWDLQVL]H
DQGDVLQJOHPDFKLQHPLJKWUHDFKWKHOLPLWVRILWVSHUIRUPDQFHUHVHUYHV
8QIRUWXQDWHO\0\64/GRHVQRWRIIHUWKLVORDGEDODQFLQJIXQFWLRQDOLW\LWVHOIVR\RXZLOOQHHGWR
WDNHDSSURSULDWHDFWLRQVRQWKHDSSOLFDWLRQOHYHO
,QWKLVUHFLSHZHZLOOVKRZ\RXWKHJHQHUDOSURFHGXUHWRIROORZZKHQVKDULQJUHDGDFFHVVHV
EHWZHHQWZRVODYHPDFKLQHVZKLOHVWLOODLPLQJZULWHVDWWKHPDVWHU%HZDUHWKDWGXHWRWKH
DV\QFKURQRXVQDWXUHRI0\64/UHSOLFDWLRQ\RXUDSSOLFDWLRQPXVWEHDEOHWRKDQGOHVOLJKWO\
RXWRIGDWHUHVXOWVEHFDXVHLVVXLQJDQINSERTUPDATERUDELETEDJDLQVWWKHPDVWHUZLOO
QRWPHDQWKDW\RXFDQUHDGWKHPRGLÀHGGDWDEDFNLPPHGLDWHO\DVWKHVODYHPLJKWWDNHVRPH
WLPHWRFDWFKXS8VXDOO\RQDORFDOQHWZRUNWKLVVKRXOGEHDFRXSOHRIVHFRQGVDWPRVWEXW
QHYHUWKHOHVVWKHDSSOLFDWLRQFRGHPXVWEHUHDG\IRUWKDW
7RVLPSOLI\WKHVFKHPH\RXVKRXOGGHVLJQ\RXUDSSOLFDWLRQWRH[FOXVLYHO\UHDGIURPWKHVODYHV
DQGRQO\XVHWKHPDVWHUIRUPRGLÀFDWLRQV7KLVEULQJVWKHDGGLWLRQDOEHQHÀWRIEHLQJDEOH
WRNHHSWKHRYHUDOOV\VWHPXSDQGUXQQLQJZKLOHVZLWFKLQJWRDUHDGRQO\PRGHWHPSRUDULO\
EDFNLQJXSWKHPDVWHUVHUYHU7KLVLVQRWSDUWRIWKLVUHFLSHKRZHYHU
7KHH[DPSOHXVHGLQWKLVUHFLSHXVHVWKUHHGDWDEDVHVHUYHUV7KHVDPSOHDSSOLFDWLRQLV
ZULWWHQLQ-DYDXVLQJWKH0\64/&RQQHFWRU--'%&GDWDEDVHGULYHU'HSHQGLQJRQZKDW
DSSOLFDWLRQSODWIRUP\RXDUHXVLQJV\QWD[DQGIXQFWLRQQDPHVZLOOGLIIHUEXWWKHJHQHUDO
SULQFLSOHLVODQJXDJHLQGHSHQGHQW
7KHVRXUFHFRGHVKRZQODWHUKDVEHHQDEEUHYLDWHGWRVKRZRQO\
WKHPRVWUHOHYDQWSRUWLRQV<RXFDQÀQGWKHFRPSOHWHÀOHRQWKH
ERRN
VZHEVLWH

5HSOLFDWLRQ

*HWWLQJUHDG\
'HSHQGLQJRQ\RXUDSSOLFDWLRQLQIUDVWUXFWXUH\RXZLOOQHHGSULYLOHJHVWRFKDQJHLWV
GDWDEDVHFRQQHFWLYLW\FRQÀJXUDWLRQDQGWKHVRXUFHFRGH7KLVLVXVXDOO\DWDVNWKDWUHTXLUHV
FRRSHUDWLRQZLWKDSSOLFDWLRQGHYHORSHUV
7RIROORZDORQJZLWKWKLVH[DPSOH\RXVKRXOGEHIDPLOLDUZLWKWKH-DYDODQJXDJHDQGLWV
EDVLFFRQVWUXFWV
0RUHRYHU\RXZLOOQHHGWKUHH0\64/VHUYHUV³RQHFRQÀJXUHGDVWKHPDVWHUDQGWZRRWKHUVDV
VODYHV7KH\ZLOOEHUHIHUUHGWRDVPDVWHUVODYHDQGVODYHLQWKLVH[DPSOH6XEVWLWXWH\RXU
FRQFUHWHKRVWQDPHVDSSURSULDWHO\
<RXZLOODOVRQHHGWKH-DYD6WDQGDUG(GLWLRQGHYHORSPHQWWRROVDYDLODEOHIURP
http://java.sun.comDQGWKH0\64/&RQQHFWRU-'%&GULYHUDYDLODEOHIURP
http://dev.mysql.com'RZQORDGDQGLQVWDOOERWKLI\RXGRQRWDOUHDG\KDYHWKHP
+RZWRGRLW

'RZQORDGWKHÀOHFDOOHGMySQLBalancingDemo.javaIURPWKHERRN
VZHEVLWH,W
FRQWDLQVWKHIROORZLQJFRGH
«
Connection conn = driver.connect("jdbc:mysql://master:3306,slave1:
3307,slave2:3308/sakila?user=testuser&password=testpass&roundRobin
LoadBalance=true", null);
conn.setReadOnly(false); // target the MASTER
rs = conn.createStatement().executeQuery(
  "SELECT @@server_id;"); 
rs.next();
System.out.println("Master: " + rs.getString(1));
conn.setReadOnly(true); // switch to one of the slaves
rs = conn.createStatement().executeQuery(
  "SELECT @@server_id;"); 
rs.next();
System.out.println("Slave: " + rs.getString(1));
conn.close();
«

&KDSWHU


&RPSLOHWKHÀOHXVLQJWKHjavacFRPSLOHU$OWHUQDWLYHO\DQLQWHJUDWHGGHYHORSPHQW
HQYLURQPHQWOLNH(FOLSVHRU1HWEHDQVFDQWDNHFDUHRIWKLVIRU\RX
$ javac -cp mysql-connector-java-5.1.7-bin.jar MySQLBalancingDemo.
java
 5XQWKHVDPSOHDSSOLFDWLRQDQGVHHKRZLWDXWRPDWLFDOO\GLVWULEXWHVWKHUHDGUHTXHVWV
EHWZHHQWKHWZRVODYHV
$ java -cp .:mysql-connector-java-5.1.7-bin.jar MySQLBalancingDemo
Master: 1000 
Slave: 13308
+RZLWZRUNV«
<RXMXVWFRPSLOHGDQGUDQDVPDOOSURJUDPWKDWGHPRQVWUDWHVURXQGURELQORDGEDODQFLQJ
7KHÀUVWOLQHRIRXWSXWLVWKHPDVWHU
Vserver-ID VHWWLQJEHFDXVHWKHÀUVWFRQQHFWLRQ
ZDVQRWVHWWRUHDGRQO\7KHFRQQHFWLRQLVWKHQGHFODUHGWREHWDUJHWHGDWWKHVODYHVYLD
setReadOnly(true)7KHQH[WTXHU\ZLOOWKHQUHWXUQWKHserverIDRIWKHSDUWLFXODUVODYH
LWZDVEDODQFHGWR<RXPLJKWQHHGWRUXQWKHGHPRDIHZWLPHVWRVHHDGLIIHUHQWVODYHEHLQJ
XVHGEHFDXVHWKHDOJRULWKPWKDWEDODQFHVWKHORDGGRHVQRWVWULFWO\WRJJOHHDFKWLPHEXW
PLJKWGLUHFWDIHZFRQQHFWLRQVDJDLQVWWKHVDPHVODYH
7KHUH
VPRUH
:KLOHWKH-'%&GULYHUPDNHVLWUHODWLYHO\HDV\WRXVHUHDGORDGEDODQFLQJDFURVVVHYHUDO
VODYHVLWRQO\KHOSV\RXWDNHWKHÀUVWVWHSRQWKHZD\<RXPXVWWDNHFDUHWKDWWKHDSSOLFDWLRQ
NQRZVZKLFKFRQQHFWLRQWRXVHIRUZULWHRSHUDWLRQVDQGZKLFKIRUUHDG,WPXVWDOVRFRSH
ZLWKVODYHVDQGPDVWHUSRVVLEO\EHLQJVOLJKWO\RXWRIV\QFDOOWKHWLPH&RQFHQWUDWLQJWKDW
WKLVVSHFLDOORJLFLQDFODVVRILWVRZQLVDGYLVDEOHWROLPLWWKHHIIHFWRQWKHUHVWRI
WKHDSSOLFDWLRQ
:RUNLQJZLWKFRQQHFWLRQSRROV
:KHQZRUNLQJZLWKFRQQHFWLRQSRROLQJEHVXUHWRLQLWLDOL]HDQ\FRQQHFWLRQ\RXJHWWRWKH
FRUUHFWPRGHXVLQJWKHsetReadOnly()PHWKRGWREHVXUH\RXNQRZZKDWVWDWHLWLVLQ
<RXPLJKWEHKDQGHGDFRQQHFWLRQWKDWZDVVHWWRWKHZURQJPRGHZKHQLWZDVSXWEDFN
LQWRWKHSRRO
:RUNLQJRQRWKHUSURJUDPPLQJHQYLURQPHQWV
,QGHYHORSPHQWHQYLURQPHQWVQRWXVLQJ-DYD\RXPLJKWKDYHWRWDNHFDUHRIPDQDJLQJWKH
F\FOLQJEHWZHHQVODYHV\RXUVHOI,QGHSHQGHQWRIWKHDFWXDOODQJXDJHRUHQYLURQPHQW\RXDUH
XVLQJDJRRGSUDFWLFHLVWRFKDQQHODOOGDWDEDVHRSHUDWLRQVWKURXJKDVHWRIIXQFWLRQVRU
PHWKRGVWKDWFHQWUDOO\PDQDJHWKHEDODQFLQJ<RXFRXOGSURYLGHIXQFWLRQVWKDWKDQGOH

5HSOLFDWLRQ

INSERTUPDATEDQGDELETERSHUDWLRQVDOZD\VFRQQHFWLQJWRWKHPDVWHUDQGDSELECT
IXQFWLRQJRLQJWRWKHVODYHVIRUGDWDUHDGV
,QFDVH\RXQHHGWRVHOHFWVRPHWKLQJEDFNWKDW\RXMXVWZURWHDQGFDQQRWDOORZIRUWKH
UHSOLFDWLRQODJ\RXPLJKWDOVRSURYLGHDUHDGIXQFWLRQTXHU\LQJWKHPDVWHUPDFKLQH<RX
VKRXOGXVHWKLVVSDULQJO\KRZHYHUEHFDXVHLWGHÀQLWHO\FRXQWHUDFWVWKHLQWHQWLRQRIUHOLHYLQJ
WKHPDVWHUIURPWKHUHDGORDG
&RQVLGHULQJHIÀFLHQF\ZKLOHDGGLQJVODYHV
2IFRXUVHWKHVODYHVKDYHWRSHUIRUPZULWHRSHUDWLRQVDVZHOOWRNHHSXSZLWKWKHPDVWHU7KLV
PHDQVWKHLUSHUIRUPDQFHLVQRWIXOO\DYDLODEOHIRUUHDGVOLPLWLQJVFDODELOLW\
6RDGGLQJPRUHVODYHVGRHVQRWSURSRUWLRQDOO\LPSURYHSHUIRUPDQFHRIWKHRYHUDOOV\VWHP
8VLQJUHSOLFDWLRQWRSURYLGHIXOOWH[W
LQGH[LQJIRU,QQR'%WDEOHV
7KH,QQR'%VWRUDJHHQJLQHLVWKHRQHPRVWFRPPRQO\XVHGQRZDGD\VEHFDXVHLWSURYLGHV
PRUHHQWHUSULVHOHYHOIHDWXUHVWKDQ0\,6$0DQGPRVWRWKHUHQJLQHV+RZHYHU,QQR'%WDEOHV
GRKDYHDPDMRUGUDZEDFNWKH\GRQRWVXSSRUWIXOOWH[WLQGH[LQJ7KLVFDQEHDVLJQLÀFDQW
REVWDFOHZKHQ\RXKDYHWRGHVLJQDQ\VRUWRIDSSOLFDWLRQWKDWUHOLHVRQDWRPLFRSHUDWLRQVDQG
PXVWVWRUHWH[WGDWDLQDVHDUFKDEOHPDQQHU
:KLOHWKHUHDUHWKLUGSDUW\SURGXFWVDYDLODEOHWRUHGUHVVWKLVVKRUWFRPLQJWKHUHDUHWLPHV\RX
PD\QHHGWRUHIUDLQIURPXVLQJWKHVHDQGVWLFNWRWKHRXWRIWKHER[IXQFWLRQDOLW\,I\RXDUH
ZLOOLQJWRSURYLGHDQDGGLWLRQDOVHUYHUDQGPDNHVOLJKWDGMXVWPHQWVWR\RXUDSSOLFDWLRQFRGH
UHSOLFDWLRQFDQKHOS\RXSURYLGHDIXOOWH[WLQGH[IRU,QQR'%WDEOHVLQGLUHFWO\
7KLVUHFLSHLVVLPLODUWRWKHRQHDERXW6KDULQJUHDGORDGDFURVVPXOWLSOHPDFKLQHVLQWKLV
FKDSWHU,QFRQWUDVWRQO\TXHULHVWKDWDUHWDUJHWHGDWWKHIXOOWH[WLQGH[QHHGWREHVHQWWR
DVODYHPDFKLQH7KLVZLOOUHTXLUHVOLJKWFKDQJHVWRWKHDSSOLFDWLRQFRGH
*HWWLQJUHDG\
7RIROORZDORQJZLWKWKLVUHFLSH\RXZLOOQHHGWZR0\64/VHUYHUVDYDLODEOH³DPDVWHUDQG
DVODYH)RUWHVWLQJWKHVHPLJKWUHVLGHRQWKHVDPHSK\VLFDOPDFKLQH,QDSURGXFWLRQ
HQYLURQPHQWZHGRKRZHYHUUHFRPPHQGWZRVHSDUDWHSLHFHVRIHTXLSPHQW
7KH\ZLOOEHUHIHUUHGWRDVPDVWHUDQGVODYHLQWKLVH[DPSOH6XEVWLWXWH\RXUFRQFUHWHKRVW
QDPHVDSSURSULDWHO\
<RXZLOOQHHGSULYLOHJHVWRFKDQJHWKHDSSOLFDWLRQVRXUFHFRGH7KLVLVXVXDOO\DWDVNWKDW
UHTXLUHVFRRSHUDWLRQZLWKWKHDSSOLFDWLRQGHYHORSHUV

&KDSWHU

+RZWRGRLW

2QWKHPDVWHULGHQWLI\WKHWDEOHWKDWFRQWDLQV
WKHFROXPQVWKDW\RXZDQWWRHTXLSZLWKDIXOOWH[WLQGH[,QWKLVH[DPSOHZHXVHWKH
IROORZLQJWDEOHGHÀQLWLRQIURPDÀFWLRQDOIRUXPDSSOLFDWLRQRIVRPHVRUW
CREATE TABLE `posts` (
  `id` int(11) NOT NULL auto_increment,
  `title` varchar(100) NOT NULL,
  `posttext` text NOT NULL,
  PRIMARY KEY  (`id`)
) ENGINE=InnoDB; 
7KHposttextFROXPQFRQWDLQVWKHWH[WRIIRUXPSRVWV$VWKHWDEOHLVFUHDWHGZLWK
ENGINE=InnoDBZHFDQQRWDGGDIXOOWH[WLQGH[WRLW

2QWKHVODYHFUHDWHWKHVDPHWDEOHEXWZLWKDVOLJKWO\PRGLÀHGGHÀQLWLRQ
CREATE TABLE `posts` (
  `id` int(11) NOT NULL auto_increment,
  `title` varchar(100) NOT NULL,
  `posttext` text NOT NULL,
  PRIMARY KEY  (`id`),
  FULLTEXT KEY `FT_text` (`posttext`)
) ENGINE=MyISAM; 
7KHVWRUDJHHQJLQHLVVHWWRMyISAMDOORZLQJWKHFULLTEXT KEY `FT_text`
`posttext`GHÀQLWLRQ7U\LQJWRDGGWKLVRQWKHPDVWHUZRXOGUHVXOWLQDQHUURU
PHVVDJH

0DNHVXUHWKHUHSOLFDWLRQUXOHVEHWZHHQPDVWHUDQGVODYHLQFOXGHWKHpostsWDEOH

0RGLI\\RXU
DSSOLFDWLRQWRDFFHVVWKHVODYHZKHQGRLQJIXOOWH[WTXHULHV,WLVJHQHUDOO\FRQVLGHUHG
DJRRGSUDFWLFHWRFRQFHQWUDWHDOOGDWDEDVHDFFHVVWRDGHGLFDWHGPRGXOHRUFODVV
VRWKDW\RXFDQHDVLO\PRGLI\\RXUDSSOLFDWLRQ
VLQWHUDFWLRQZLWKWKHXQGHUO\LQJGDWD
VWRUH
+RZLWZRUNV
,QWKLVUHSOLFDWLRQVHWXSZKHQHYHU\RXPDNHFKDQJHVWRWKHPDVWHU
VSRVWVWDEOHWKRVH
ZLOOEHUHSOLFDWHGWRWKHVODYHEXWWKHWDUJHWWDEOHXVHVDGLIIHUHQWVWRUDJHHQJLQHWKDQ
WKHPDVWHU$V6%5VLPSO\VHQGVRYHU64/VWDWHPHQWVZLWKRXWDQ\LQIRUPDWLRQDERXW
WKHRULJLQWKHVODYHZLOOH[HFXWHWKHLQVWUXFWLRQVEOLQGO\:KLOHWKLVFDQEHDSUREOHPLQ
RWKHUFLUFXPVWDQFHVEHFDXVHLWPDNHVWKHZKROHSURFHVVVRPHZKDWIUDJLOHLWSOD\VWRRXU
DGYDQWDJHLQWKLVFDVH

5HSOLFDWLRQ

8SRQUPDATERUINSERTWRWKHposttextFROXPQWKH0\,6$0HQJLQHZLOOXSGDWHWKH
IXOOWH[WLQGH[DSSURSULDWHO\7KLVHQDEOHVWKHDSSOLFDWLRQWRLVVXHTXHULHVXVLQJWKHIXOOWH[W
TXHU\V\QWD[DJDLQVWWKHVODYH
$QLPSRUWDQWGUDZEDFN\RXPXVWWDNHLQWRDFFRXQWLVWKDW\RX
FDQQRWJOINWDEOHVEHWZHHQGLIIHUHQW0\64/VHUYHUV
$ZRUNDURXQGLVUHTXLUHGZKHQ\RXKDYHWRIRUH[DPSOHMRLQWKHSRVWVZLWKDXVHUDFFRXQWV
WDEOHYLDWKHposts.idFROXPQ7RLPSOHPHQWWKLV\RXZLOOQHHGWRLVVXHWZRVHSDUDWH
TXHULHV7KHÀUVWRQHXVLQJWKHIXOOWH[WVHDUFKRQWKHVODYHZLOOEULQJXSDOOSRVWVFRQWDLQLQJ
WKHVHDUFKWHUPV)URPWKHUHVXOWLQJURZV\RXFDQWKHQWDNHWKHidFROXPQYDOXHVDQGUXQD
VHFRQGTXHU\DJDLQVWWKHPDVWHUGDWDEDVHVXEVWLWXWLQJWKHWH[WVHDUFKZLWKDQidORRNXS
7KHUH
VPRUH
0\,6$0
VIXOOWH[WLQGH[KDVH[LVWHGIRUVHYHUDO\HDUVEXWKDVQRWEHHQLPSURYHGDJUHDWGHDO
RYHUWLPH,I\RXKDYHPDQ\FRQFXUUHQWUHTXHVWV\RXZLOOQRWLFHVLJQLÀFDQWUHVRXUFHXVDJH
OLPLWLQJVFDODELOLW\
2YHUWKHSDVWIHZ\HDUVVHYHUDOWKLUGSDUW\YHQGRUVKDYHVWHSSHGXSZLWKDOWHUQDWLYHVROXWLRQV
WRWKHSUREOHPRIIXOOWH[WVHDUFKRIIHULQJPRUHIHDWXUHVDQGEHWWHUSHUIRUPDQFH
2QHRIWKRVHSURGXFWVRIIHULQJWLJKWLQWHJUDWLRQZLWK0\64/DQG3+3LV6SKLQ[³DQRSHQVRXUFH
SURGXFWDYDLODEOHIRUIUHHIURPhttp://www.sphinxsearch.com,I\RXÀQGWKDW0\64/
V
EXLOWLQFDSDELOLWLHVDUHHLWKHUWRRVORZRUWRROLPLWHGLQRWKHUUHVSHFWVWRPHHW\RXUDSSOLFDWLRQ
V
UHTXLUHPHQWV\RXVKRXOGGHÀQLWHO\KDYHDORRNDWLW
6HWWLQJXSQHZVODYHVLQWKLVVFHQDULR
<RXVKRXOGQRWVLPSO\XVHDUHJXODU64/GXPSWRLQLWLDOL]HWKHVODYHDVLWZLOOFRQWDLQDFUHDWH
WDEOHVWDWHPHQWWKDWVSHFLÀHV,QQR'%DQGGRHVQRWLQFOXGHWKHIXOOWH[WLQGH[2IFRXUVH
\RXFRXOGFKDQJHWKHWDEOHW\SHDIWHUWKHLPSRUWLVFRPSOHWH+RZHYHUWKLVFDQEHWLPH
FRQVXPLQJ,QVWHDGZHUHFRPPHQG\RXÀUVWFUHDWHWKHWDUJHWVFKHPDRQWKHVODYHPDNLQJ
VXUHWKHWDEOHVLQTXHVWLRQDUHFUHDWHGZLWKENGINE=MyISAM
7KHQJRDKHDGDQGLPSRUWWKHGDWDLQWRWKHWDEOH2QO\DIWHUWKDWDGGWKHIXOOWH[WLQGH[
7KLVLVW\SLFDOO\PXFKIDVWHUWKDQKDYLQJWKHLQGH[LQSODFHEHIRUHKDQGEHFDXVH0\64/PXVW
WKHQXSGDWHLWDOOWKHZD\WKURXJKWKHEXONLQVHUWRIURZV7KLVLVDYHU\H[SHQVLYHRSHUDWLRQ
FRPSDUHGWRWKHGHOD\HGLQGH[FUHDWLRQ

&KDSWHU

6HHDOVR
f
$GGLQJDIXOOWH[WLQGH[LQ&KDSWHU
(VWLPDWLQJQHWZRUNDQGVODYH,2ORDG
(VSHFLDOO\ZKHQXVLQJUHSOLFDWLRQRYHUDZLGHDUHDQHWZRUNFRQQHFWLRQZLWKOLPLWHGEDQGZLGWK
LWLVLQWHUHVWLQJWREHDEOHWRSUHGLFWWKHDPRXQWRIGDWDWKDWQHHGVWREHWUDQVSRUWHGEHWZHHQ
PDVWHUDQGVODYHV
:KLOH0\64/GRHVQRWXVHWKHPRVWHIÀFLHQWVWUDWHJ\WRGHOLYHUGDWDLWLVDWOHDVWUHODWLYHO\
HDV\WRFDOFXODWHWKHUHTXLUHPHQWVLQDGYDQFH
7KLVLVOHVVRIDVWHSE\VWHSUHFLSHWKDQDQDQQRWDWHGZDONWKURXJKRIWKHEDVLFIRUPXODWKDW
FDQEHXVHGWRHVWLPDWHWKHWUDIÀF\RXZLOOKDYHWREHSUHSDUHGIRU
*HWWLQJUHDG\
,QRUGHUWRIROORZDORQJ\RXPXVWKDYHVRPHNH\GDWDSRLQWVDYDLODEOHEHFDXVHRWKHUZLVH
WKHUHLVQRWPXFKWRFDOFXODWH<RXZLOOQHHG
f
7KHQXPEHURIVODYHVWREHFRQQHFWHGWRWKHPDVWHU
f
$QLGHDDERXWWKHDYHUDJHDPRXQWRIELQORJVZULWWHQZKHQXVLQJWKHPDVWHUXQGHU
UHJXODUORDG.QRZLQJDERXWSHDNWLPHVFDQEHLQWHUHVWLQJDVZHOO
f
7KHEDQGZLGWKRIWKHFRQQHFWLRQEHWZHHQPDVWHUDQGVODYHV7KLVLQFOXGHVWKHVSHHG
RIWKHQHWZRUNLQWHUIDFHVRQWKHPDVWHUDQGLQJHQHUDOWKHZKROHURXWHEHWZHHQ
WKHPSRVVLEO\LQFOXGLQJ,QWHUQHWFRQQHFWLRQV
:HDVVXPHWKDWWKHUHDUHQRRWKHUQHWZRUNLQWHQVLYHDSSOLFDWLRQVUXQQLQJRQWKHPDVWHURU
VODYHVVRWKDWSUDFWLFDOO\DOOWKHVSHHG\RXUQHWZRUNFDUGFDQSURYLGHLVXVDEOHIRU0\64/
,QWKLVH[DPSOHZHZLOONHHSPDWWHUVVLPSOHDVVXPLQJWKHIROORZLQJ
'DWDSRLQW
9DOXH
0DVWHU
V&RQQHFWLYLW\
*LJDELW/$1LQWHUIDFHDSSUR[0%V
6ODYHV
&RQQHFWLYLW\
0%LWV'6/OLQHRIZKLFK0%LWVFDQEH
DVVXPHGDYDLODEOHIRU0\64/0%LWVFRPHV
GRZQWRDSSUR[LPDWHO\NEV
$YHUDJHDPRXQWRIELQORJVFUHDWHGRQPDVWHU
0%SHUKRXUDSSUR[NEV
1XPEHURI6ODYHV

6SHHGRIWKHVORZHVWOLQNLQWKHFRQQHFWLRQ
EHWZHHQ0DVWHUDQG6ODYHV
0DVWHULVFRQQHFWHGWRWKH,QWHUQHWYLDD
0%LWVFRQQHFWLRQDSSUR[0%V

5HSOLFDWLRQ

+RZWRGRLW

&KHFNWKHPDVWHU
VQHWZRUNVSHHG0XOWLSO\WKH
QXPEHURIVODYHVZLWKWKHDYHUDJHDPRXQWRIELQORJV[0%KRXU 0%KRXU
RUDERXWNEVHFRQG7KHJLJDELWFRQQHFWLRQFDQKDQGOHWKLVHDVLO\

&KHFNLQGLYLGXDOVODYHV
QHWZRUNVSHHG7KH0%LWSRUWLRQRI
WKH'6/OLQHLVVXIÀFLHQWIRUDQDYHUDJHDPRXQWRIGDWDRINEVHFRQG2IWHQELQORJ
SURGXFWLRQLVQRWOLQHDURYHUWLPH³WKHUHPLJKWEHSHDNVEXWWKHUHLVVWLOODUHVHUYH

&KHFNLIWKHVORZHVWSDUWRIWKHURXWHEHWZHHQPDVWHUDQGVODYHVFDQKDQGOH
WKHORDGNEVHFRQGVKRXOGEHQRSUREOHPIRUWKH0%LWVHFRQG
,QWHUQHWFRQQHFWLRQ

'LVN,2ORDGRQHDFKVODYHFDXVHGE\WKHUHSOLFDWLRQLV
WKHDPRXQWRIUHOD\ORJVEHLQJZULWWHQ7KLVLVHTXLYDOHQWWRWKHDPRXQWRIELQORJVWKH
PDVWHUSURGXFHV3URYLGHGWKHVODYH
V,2LVQRWDOUHDG\VDWXUDWHGE\RWKHUWKLQJVDQ
DGGLWLRQDO0%SHUKRXUVKRXOGQRWSRVHDSUREOHPHLWKHU
+RZLWZRUNV
%DVLFDOO\UHSOLFDWLRQVLPSO\QHHGVVXIÀFLHQWUHVRXUFHVWRFRS\WKHPDVWHU
VELQORJVWRWKH
VODYHV7KLVUHDOO\DOOWKHUHLVWRLW'HSHQGLQJRQWKHQHWZRUNURXWHEHWZHHQWKHPWKLVFDQ
EHHDVLO\GRQHVD\PRVW/$1VRUFDQEHWULFN\DVLQFDVHVZLWKVORZ,QWHUQHWFRQQHFWLRQV
,QWKLVH[DPSOHZHVHHWKHUHVKRXOGEHQRSUREOHPRQDQ\SDUWRIWKHV\VWHPDVWKHUHLV
VWLOOURRPIRUDKLJKHUORDGRQHDFKUHVRXUFH7KHPRVWOLPLWLQJIDFWRULQWKLVVFHQDULRVHHPV
WREHWKHPDVWHU
VRXWJRLQJ,QWHUQHWFRQQHFWLRQ,I\RXDGGPRUHVODYHVWRWKHVFHQDULRHDFK
QHZRQHZLOODGGDQRWKHU.%SHUVHFRQGRIRXWJRLQJEDQGZLGWK$VVXPLQJUHSOLFDWLRQFDQ
XVHWKHIXOO0%VRXWJRLQJVSHHGZKLFKLVQRWYHU\UHDOLVWLFWKDWSDUWRIWKHURXWHFRXOG
WKHRUHWLFDOO\VHUYLFHVODYHVDWPRVW,QUHDOLW\LWZLOOEHPRUHOLNHWR
7KHUH
VPRUH
7KHUHDUHWZRPRUHJHQHUDOFRQVLGHUDWLRQV\RXPLJKWZDQWWRWKLQNDERXWZKHQSODQQLQJ
DUHSOLFDWLRQVHWXS
+DQGOLQJLQWHUPLWWHQWFRQQHFWLYLW\EHWZHHQPDVWHUDQGVODYH
,IWKHFRQQHFWLRQEHWZHHQPDVWHUDQGVODYHVLVRQO\DYDLODEOHIRUDOLPLWHGSHULRGRIWLPH
WKHVODYHVZLOOVWDUWWRODJEHKLQGZKLOHGLVFRQQHFWHG7KHVODYHVZLOOGRZQORDGQHZGDWD
DVTXLFNO\DVSRVVLEOHZKHQWKHFRQQHFWLRQLVUHVXPHGDQGVWRUHLWORFDOO\LQWKHUHOD\ORJV
DV\QFKURQRXVO\H[HFXWLQJWKHVWDWHPHQWV6RH[SHFWKLJKHUQHWZRUNORDGGXULQJWKHVHWLPHV
<RXZLOODOVRZDQWWRWDNHWKDWLQWRDFFRXQWZKHQWKHUHDUHPXOWLSOHVODYHVWU\LQJWRFDWFKXS
DWWKHVDPHWLPH8QGHUVXFKFLUFXPVWDQFHVWKHURXWHEHWZHHQPDVWHUDQGVODYHVPLJKW
EHFRPHVDWXUDWHGPRUHTXLFNO\

&KDSWHU

(QDEOLQJFRPSUHVVLRQZLWKWKHVODYHBFRPSUHVVHGBSURWRFRO
RSWLRQ
3DUWLFXODUO\XVHIXOIRUORZEDQGZLGWKFRQQHFWLRQVEHWZHHQPDVWHUDQGVODYHVLVWKH
FRPSUHVVLRQIHDWXUHIRUUHSOLFDWLRQWUDIÀF3URYLGHGLWLVVZLWFKHGRQRQERWKPDVWHUDQG
VODYHPDFKLQHVLWFDQVLJQLÀFDQWO\UHGXFHWKHDPRXQWRIGDWDWKDWLVDFWXDOO\WUDQVIHUUHG
RYHUWKHQHWZRUNDWWKHFRVWRILQFUHDVHG&38ORDGV7KHPDVWHUZLOOWKHQVHQGRXWWKHELQORJ
LQIRUPDWLRQLQDFRPSUHVVHGIRUPDW
,QDVLPSOHFRPSDULVRQPHDVXULQJWKHQHWZRUNWUDIÀFZKLOHFUHDWLQJDQGORDGLQJWKHsakila
VDPSOHGDWDEDVHNERIELQORJVZHUHFUHDWHG+RZHYHUZLWKWKHFRPSUHVVHGSURWRFRO
VZLWFKHGRQRQO\DERXW.%RIGDWDSHUVODYHZHUHVHQWRYHUWKHQHWZRUN
7RHQDEOHFRPSUHVVLRQDGGWKHIROORZLQJOLQHWRWKH[mysqld]VHFWLRQLQWKHFRQÀJXUDWLRQ
ÀOHVRQERWKPDVWHUDQGVODYH
slave_compressed_protocol=1
7KHQUHVWDUWWKHVHUYHUVWRHQDEOHWKHIHDWXUH9HULI\ZKHWKHULWZDVVZLWFKHGRQVXFFHVVIXOO\
E\LVVXLQJDSHOWVARIABLESLIKE'slave_compressed%';FRPPDQGRQERWKPDVWHU
DQGVODYHV
<RXFDQDFKLHYHDVLPLODUHIIHFWZLWK66+FRPSUHVVLRQ$VZHJHQHUDOO\GRQRWUHFRPPHQG
UHSOLFDWLQJRYHUWKH,QWHUQHWZLWKRXWHQFU\SWLRQWKDWRSWLRQPLJKWHYHQEHPRUHDSSHDOLQJLQ
VXFKVFHQDULRVDVLWGRHVQRWUHTXLUHDQ\FRQÀJXUDWLRQFKDQJHVWR0\64/
1DWXUDOO\WKHOHYHORIFRPSUHVVLRQKHDYLO\GHSHQGVRQWKHGDWD\RX
DUHKDQGOLQJ,I\RXVWRUH-3(*LPDJHVLQ%/2%ÀHOGVIRUH[DPSOH
WKRVHFDQQRWEHFRPSUHVVHGPXFKPRUHWKDQWKH\DOUHDG\DUH
6HHDOVR
f
(QFU\SWLQJD0\64/VHUYHUFRQQHFWLRQZLWK66+LQ&KDSWHU
f
&UHDWLQJDQHQFU\SWHG0\64/FRQVROHYLD66+LQ&KDSWHU
f
8VLQJD3X77<WHPSODWHFRQQHFWLRQIRU66+VHFXUHGFRQQHFWLRQVLQ
&KDSWHU

5HSOLFDWLRQ

/LPLWLQJQHWZRUNDQGVODYH,2ORDGLQKHDY\
ZULWHVFHQDULRVXVLQJWKHEODFNKROH
VWRUDJHHQJLQH
,I\RXKDYHDODUJHQXPEHURIVODYHVDQGDUDWKHUEXV\PDVWHUPDFKLQHWKHQHWZRUNORDG
FDQEHFRPHVLJQLÀFDQWHYHQZKHQXVLQJFRPSUHVVLRQ7KLVLVEHFDXVHDOOVWDWHPHQWVWKDW
DUHZULWWHQWRWKHELQORJDUHWUDQVIHUUHGWRDOOWKHVODYHV7KH\SXWWKHPLQWKHLUUHOD\ORJVDQG
DV\QFKURQRXVO\SURFHVVWKHP
7KHPDLQUHDVRQIRUWKHKHDY\QHWZRUNORDGLVWKHÀOWHURQWKHVODYHSDUDGLJPWKDW0\64/
HPSOR\V(YHU\WKLQJLVVHQWWRHYHU\RQHRIWKHVODYHVDQGHDFKRQHGHFLGHVZKLFKVWDWHPHQWV
WRWKURZDZD\DQGZKLFKWRDSSO\EDVHGRQLWVSDUWLFXODUFRQÀJXUDWLRQ,QWKHZRUVWFDVH\RX
KDYHWRWUDQVPLWHYHU\VLQJOHFKDQJHWRDGDWDEDVHWRUHSOLFDWHRQO\DVLQJOHWDEOH
*HWWLQJUHDG\
7KHIROORZLQJSURFHGXUHLVEDVHGRQ/LQX[6RLQRUGHUWRUHSHDWLWRQ:LQGRZV\RXQHHGWR
DGDSWWKHSDWKQDPHVDQGDOLWWOHVKHOOV\QWD[DFFRUGLQJO\
7RIROORZDORQJ\RXZLOOQHHGD0\64/GDHPRQZLWKWKHEODFNKROHVWRUDJHHQJLQHHQDEOHG
9HULI\WKLVZLWKWKHIROORZLQJFRPPDQG
mysql> show variables like '%blackhole%';
(YHQWKRXJK\RXRQO\VWULFWO\QHHGDEODFNKROHHQDEOHG0\64/VHUYHURQWKHDFWXDOÀOWHU
LQVWDQFHIRUWKLVH[DPSOHZHZLOOEHXVLQJRQO\DVLQJOHPDFKLQHDQGMXVWDVLQJOHVHUYHU
YHUVLRQEXWZLWKGLIIHUHQWFRQÀJXUDWLRQÀOHVDQGGDWDGLUHFWRULHV
,QWKHIROORZLQJVWHSVZHDVVXPH\RXKDYHLQVWDOOHGDFRS\RI0\64/LQDIROGHUFDOOHG
blacktestLQ\RXUKRPHGLUHFWRU\0RGLI\DFFRUGLQJO\LI\RXUVHWXSGLIIHUV

&KDSWHU

+RZWRGRLW

&UHDWHWKUHHGLVWLQFWGDWDGLUHFWRULHV³RQHIRUWKHPDVWHURQHIRUWKHEODFNKROHÀOWHU
HQJLQHDQGRQHIRUDVODYH
~/blacktest$ mkdir data.master
~/blacktest$ mkdir data.slave
~/blacktest$ mkdir data.black

,QWRHDFKRIWKRVHFRS\WKH0\64/DFFRXQWVGDWDEDVH
,GHDOO\\RXVKRXOGWDNHDQHPSW\RQHIURPDIUHVKO\GRZQORDGHGGLVWULEXWLRQWRPDNH
VXUH\RXGRQRWDFFLGHQWDOO\FRS\XVHUV\RXGRQRWZDQW
~/blacktest$ cp -R data/mysql data.master
~/blacktest$ cp -R data/mysql data.slave
~/blacktest$ cp -R data/mysql data.black

&RQÀJXUHWKHPDVWHULQVWDQFH7RGRVRFUHDWHDFRQÀJXUDWLRQÀOHFDOOHGmy.master
DQGPDNHVXUHWKDWLWFRQWDLQVWKHIROORZLQJVHWWLQJV
[client]
    port            = 3307 
socket          = /home/ds/blacktest/master.sock
[mysqld_safe] 
socket          = /home/ds/blacktest/master.sock
[mysqld] 
user            = mysql 
pid-file        = /home/ds/blacktest/master.pid
socket          = /home/ds/blacktest/master.sock
   port            = 3307 
basedir         = /home/ds/blacktest 
datadir         = /home/ds/blacktest/data.master 
tmpdir          = /tmp 
language        = /home/ds/blacktest/share/mysql/english
bind-address    = 127.0.0.1
server-id       = 1 
log-bin         = /home/ds/blacktest/master-bin.log
(YHU\WKLQJWKDWLVVSHFLÀFWRWKHPDVWHULQVWDQFHKDVEHHQKLJKOLJKWHG³WKRVHYDOXHV
DUHJRLQJWREHGLIIHUHQWIRUÀOWHUDQGVODYHLQVWDQFHV

5HSOLFDWLRQ


6WDUWWKHPDVWHUGDHPRQIRUWKHÀUVWWLPHWRPDNHVXUHHYHU\WKLQJZRUNVVRIDU:H
UHFRPPHQGDGHGLFDWHGZLQGRZIRUWKLVGDHPRQ)RUH[DPSOH
~/blacktest$ xterm -T MASTER -e bin/mysqld \ 
>        --defaults-file=my.master \ 
>        --console &
7KLVZLOOVWDUWWKHGDHPRQLQWKHEDFNJURXQGDQGVKRZLWVRXWSXWLQDQHZZLQGRZ
7KHZDUQLQJDERXWWKH--userVZLWFKFDQEHLJQRUHGIRUQRZ6KRXOG\RXQRW
JHWDPHVVDJHYHU\VLPLODUWRWKHRQHDERYHHVSHFLDOO\FRQFHUQLQJWKHUHDG\IRU
FRQQHFWLRQVSDUWJREDFNDQGÀQGWKHHUURULQ\RXUVHWXSEHIRUHJRLQJRQ8VXDOO\
WKHHUURUPHVVDJHVLVVXHGE\0\64/DUHUDWKHUYHUERVHDQGEULQJ\RXEDFNRQWUDFN
SUHWW\VRRQ
,QVHUWVRPHWHVWGDWDWREHDEOHWRYHULI\WKHFRUUHFWIXQFWLRQRIWKHÀOWHUODWHU7RGRVR
FRQQHFWWRWKHPDVWHULQVWDQFHMXVWVWDUWHGDQGFUHDWHVRPHWDEOHVDQGGDWD
~/blacktest$ bin/mysql -uroot -S master.sock --prompt='master>'
master> CREATE DATABASE repdb;
master> USE repdb; 
master> CREATE TABLE tblA (
    ->       id INT(10) PRIMARY KEY NOT NULL,
    ->       label VARCHAR(30)
    ->  ) ENGINE=InnoDB;
master> CREATE TABLE tblB (
    ->       name VARCHAR(20) PRIMARY KEY NOT NULL,
    ->       age INT(3)
    ->  ) ENGINE=InnoDB;

&KDSWHU

master> INSERT INTO tblA VALUES
    ->      (1, 'label 1'),
    ->      (2, 'label 2'),
    ->      (3, 'label 3');
master> INSERT INTO tblB VALUES 
    ->      ('Peter', 55),
    ->      ('Paul', 43), 
    ->      ('Mary', 25);
,QVHUWLQJWKLVGDWDDOUHDG\FUHDWHVELQORJLQIRUPDWLRQ<RXFDQHDVLO\YHULI\WKLVE\
ORRNLQJDWWKHÀOHV\VWHP7KHmaster-bin.000001ÀOHVKRXOGKDYHJURZQWR
DURXQGE\WHVQRZ7KLVPLJKWYDU\VOLJKWO\LI\RXGLGQRWHQWHUWKHFRPPDQGV
DERYHZLWKWKHH[DFWVDPHQXPEHURIVSDFHV³WKHELQORJZLOOVWRUHFRPPDQGVLQWKH
H[DFWZD\\RXW\SHGWKHP)RUH[DPSOHZHZLOORQO\UHSOLFDWHFKDQJHVWRWDEOHtblB
EXWLJQRUHDQ\WKLQJWKDWKDSSHQVWRWDEOHtblA:HZLOODVVXPHWKDWtblBQHHGVWR
EHZULWWHQE\DQDSSOLFDWLRQRQWKHVODYH6RWKHWDEOHVKRXOGEHSUHVHQWEXWHPSW\
RQWKHVODYHVWRDYRLGNH\FROOLVLRQV

&UHDWHDXVHUDFFRXQWRQWKHPDVWHUIRUWKHÀOWHUWRFRQQHFWZLWK
master> GRANT REPLICATION SLAVE
    -> ON *.*
    -> TO 'repblack'@'localhost'
    -> IDENTIFIED BY 'blackpass';
&RQÀJXUHWKHÀOWHUEODFNKROHLQVWDQFHZLWKDFRQÀJXUDWLRQÀOHQDPHGmy.black WKDW
FRQWDLQVDWOHDVWWKHIROORZLQJ
[client] 
port            = 3308 
socket          = /home/ds/blacktest/black.sock
[mysqld_safe] 
socket          = /home/ds/blacktest/black.sock
[mysqld] 
log-slave-updates 
skip-innodb
default-storage-engine=blackhole
user            = mysql 
pid-file        = /home/ds/blacktest/black.pid
socket          = /home/ds/blacktest/black.sock
port            = 3308 
basedir         = /home/ds/blacktest

5HSOLFDWLRQ

datadir         = /home/ds/blacktest/data.black 
tmpdir          = /tmp 
language        = /home/ds/blacktest/share/mysql/english
bind-address    = 127.0.0.1
server-id       = 2 
log-bin         = /home/ds/blacktest/black-bin.log
relay-log       = /home/ds/blacktest/black-relay.log
1RWLFHWKDWDOORFFXUUHQFHVRIPDVWHUKDYHEHHQUHSODFHGZLWKEODFN
0RUHRYHUWKHserver-idVHWWLQJKDVEHHQFKDQJHGDQGWKH
log-slave-updatesskip-innodbDQGdefault-storage-engine
RSWLRQVKDYHEHHQDGGHG7KHVHFRQGRQHSUHYHQWVWKLVLQVWDQFHIURP
FUHDWLQJibdataWDEOHVSDFHÀOHVZKLFKZRXOGQRWEHXVHGODWHUDQ\ZD\
7KHODVWRQHVSHFLÀHVZKLFKVWRUDJHHQJLQHWRXVHZKHQDCREATETABLE
VWDWHPHQWGRHVQRWH[SOLFLWO\VSHFLI\RQHRULIWKHVSHFLÀHGHQJLQHLVQRW
DYDLODEOH:HZLOOFRPHEDFNWRWKLVVRRQ

0DNHVXUHWKLVLQVWDQFHEDVLFDOO\ZRUNVE\VWDUWLQJLWWKHVDPHZD\DVWKHPDVWHU
EHIRUH\RXZLOOQRWVHHWKH,QQR'%PHVVDJHVKHUHRIFRXUVH
~/blacktest$ xterm -T BLACK -e bin/mysqld \
>        --defaults-file=my.black \ 
>        --console &

&UHDWHDVHWRIGXPSÀOHVIURPWKHPDVWHU
WRVHWXSERWKWKHEODFNKROHÀOWHUDQGDQH[DPSOHVODYH7KHGHWDLOVRQZK\ZHQHHG
WZRDQGLQZKLFKZD\VWKH\DUHGLIIHUHQWZLOOEHH[SODLQHGODWHU8VHWKHVHFRPPDQGV
WRFUHDWHWKHÀOHVQHHGHG
~/blacktest$ bin/mysqldump -S master.sock -uroot \ 
>                      --master-data \ 
>                      --single-transaction \ 
>                      --no-create-info \ 
>                      --ignore-table=repdb.tblA \ 
>                      repdb > master_data.sql
~/blacktest$ bin/mysqldump -S master.sock -uroot \
>                      --no-data \ 
>                      repdb > master_struct.sql

&KDSWHU


&RQQHFWWRWKHÀOWHUVHUYHUFUHDWHWKHGDWDEDVHPDNHLWWKHGHIDXOWGDWDEDVHDQG
ÀQDOO\LPSRUWWKHVWUXFWXUHLQIRUPDWLRQFUHDWHGEHIRUH
~/blacktest$ bin/mysql -uroot -S black.sock --prompt='black> '
black> CREATE DATABASE repdb;
black> USE repdb; 
black> source master_black.sql;
$WWKLVSRLQWZHQRZKDYHWKHVWUXFWXUHRIWKHPDVWHUWUDQVIHUUHGWRWKHÀOWHUHQJLQH
DGDSWHGWRXVHWKHEODFNKROHHQJLQHIRUDOOWKHWDEOHV

6HWXSWKHUHSOLFDWLRQEHWZHHQPDVWHUDQGÀOWHUHQJLQH7RGRVRZH
QHHGWRNQRZWKHH[DFWSRVLWLRQIURPZKHUHWKHÀOWHUZLOOVWDUWUHSOLFDWLQJ([WUDFWWKLV
LQIRUPDWLRQIURPWKHSUHYLRXVO\WDNHQGDWDGXPSOLNHWKLV
   ~/blacktest$ head -n 30 master_data.sql | grep 'CHANGE MASTER TO'
:ULWHGRZQWKDWLQIRUPDWLRQZHZLOOQHHGLWLQDPRPHQW

0RGLI\WKHmy.blackFRQÀJXUDWLRQÀOHWRFRQWDLQWKHIROORZLQJLQWKH[mysqld] 
VHFWLRQ
replicate-ignore-table=repdb.tblA
replicate-do-table=repdb.tblB
7KLVLVDYHU\VLPSOHÀOWHUVHWXSLQDUHDODSSOLFDWLRQVFHQDULRWKHVHUXOHVZLOO
SUREDEO\EHPRUHFRPSOH[

5HVWDUWWKHÀOWHUHQJLQHWRDFWLYDWHWKHQHZFRQÀJXUDWLRQ
~/blacktest$ bin/mysqladmin -uroot -S black.sock shutdown
~/blacktest$ xterm -T BLACK -e bin/mysqld \
>        --defaults-file=my.black \ 
>        --console &

5HFRQQHFWWKHFOLHQWFRQQHFWHGWRWKHEODFNKROHHQJLQH7RGRWKLVMXVWLVVXHD
SELECT1;FRPPDQG
([HFXWHWKHIROORZLQJFRPPDQGWRKRRNXSWKHÀOWHUWRWKHPDVWHU%HVXUHWRÀOOLQWKH
YDOXHV\RXZURWHGRZQDPRPHQWDJRLQWKHVWDWHPHQW
black> CHANGE MASTER TO
    -> master_host='localhost',
    -> master_port=3307,
    -> master_user='repblack',
    -> master_password='blackpass',
    -> master_log_file='master-bin.000001',
    -> master_log_pos=1074;

5HSOLFDWLRQ

 5HWULHYHLQIRUPDWLRQUHTXLUHGWRVHWXSWKHÀOWHUVODYHSRUWLRQ:ULWHGRZQWKHUHVXOWV
RIWKHSHOWMASTERSTATUSFRPPDQGWKH\ZLOOEHQHHGHGODWHU
black> FLUSH LOGS; 
black> SHOW MASTER STATUS;
+------------------+----------+---+---+ 
| File             | Position | … | … |
+------------------+----------+---+---+ 
| black-bin.000003 |       98 |   |   |
+------------------+----------+---+---+

6WDUWWKHVODYHWKUHDGRQWKHÀOWHUHQJLQHDQGYHULI\WKDWHYHU\WKLQJLVJRLQJZHOO
black> START SLAVE; 
black> SHOW SLAVE STATUS \G
************************** 1. row ***************************
             Slave_IO_State: Waiting for master to send event
                Master_Host: localhost
                Master_User: repblack
                Master_Port: 3307
              Connect_Retry: 60
            Master_Log_File: master-bin.000001
        Read_Master_Log_Pos: 1074
             Relay_Log_File: black-relay.000003
              Relay_Log_Pos: 236
      Relay_Master_Log_File: master-bin.000001
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                        ...
         Replicate_Do_Table: repdb.tblB
     Replicate_Ignore_Table: repdb.tblA
                        ...
                 Last_Errno: 0
                 Last_Error:
               Skip_Counter: 0
        Exec_Master_Log_Pos: 1074
            Relay_Log_Space: 236
                        ...
      Seconds_Behind_Master: 0
$WWKLVSRLQWZHKDYHVXFFHVVIXOO\HVWDEOLVKHGDUHSOLFDWLRQFRQQHFWLRQEHWZHHQWKH
PDVWHUGDWDEDVHDQGWKHEODFNKROHEDVHGÀOWHULQVWDQFH

&KDSWHU


&KHFNWKDWQRWKLQJKDV\HWEHHQZULWWHQWR
WKHÀOWHU
VELQORJV%HFDXVHZHLVVXHGDFLUSHLOGSFRPPDQGRQWKHÀOWHULQVWDQFH
WKHUHVKRXOGEHQRWKLQJLQWKHPRVWUHFHQWELQORJÀOH9HULI\WKLVDVIROORZV
~/blacktest$ bin/mysqlbinlog black-bin.000003

7HVWWKHÀOWHUVHWXSZLWKVRPHVWDWHPHQWVLVVXHGRQWKHPDVWHU
master> UPDATE repdb.tblA
    -> SET label='modified label 3'
    -> WHERE id=3; 
master> INSERT INTO repdb.tblB
    -> VALUES ('John', 39);
:HZRXOGH[SHFWWRVHHWKHINSERTLQWKHELQORJÀOHRIWKHÀOWHULQVWDQFHEXWQRWWKH
UPDATEVWDWHPHQWEHFDXVHLWPRGLÀHVtblAZKLFKLVWREHLJQRUHG

9HULI\WKDWWKHUXOHVZRUNDVH[SHFWHGE\KDYLQJDQRWKHUORRNDWWKHÀOWHU
VELQORJV
~/blacktest$ bin/mysqlbinlog black-bin.000003

5HSOLFDWLRQ

7KLVORRNVSUHFLVHO\DVH[SHFWHG³WKHINSERTLVSUHVHQWWKHUPDATELVQRZKHUHWR
EHVHHQ

6HWXSWKHFRQÀJXUDWLRQRIDVODYHXVLQJWKHVHVHWWLQJV
[client] 
port            = 3309 
socket          = /home/ds/blacktest/slave.sock
[mysqld_safe] 
socket          = /home/ds/blacktest/slave.sock
[mysqld] 
user            = mysql 
pid-file        = /home/ds/blacktest/slave.pid 
socket          = /home/ds/blacktest/slave.sock 
port            = 3309 
basedir         = /home/ds/blacktest 
datadir         = /home/ds/blacktest/data.slave 
tmpdir          = /tmp 
language        = /home/ds/blacktest/share/mysql/english
bind-address    = 127.0.0.1
server-id       = 3 
relay-log       = /home/ds/blacktest/slave-relay.log
1RWLFHWKDWDOORFFXUUHQFHVRIPDVWHUKDYHEHHQUHSODFHG
ZLWKVODYH
$JDLQWKHserver-idVHWWLQJKDVEHHQFKDQJHGDQGWKHlog-slave-updates
skip-innodbDQGdefault-storage-engineRSWLRQVWKDWZHUHSDUWRIWKHÀOWHU
LQVWDQFH
VFRQÀJXUDWLRQDUHQRWLQFOXGHG$OVRWKHlog-binSDUDPHWHUKDVEHHQ
UHPRYHGEHFDXVHFKDQJHVRQWKHVODYHQHHGQRWEHUHFRUGHGVHSDUDWHO\

6WDUWXSWKHVODYHHQJLQH<RXZLOOVHHWKHIDPLOLDUPHVVDJHVDERXW,QQR'%ÀOOLQJXS
WKHGDWDÀOHVDQGÀQDOO\WKH5HDG\IRUFRQQHFWLRQVOLQH
~/blacktest$ xterm -T SLAVE -e bin/mysqld \ 
>        --defaults-file=my.slave \ 
>        --console &

&KDSWHU


7KHQFRQQHFWDFOLHQWWRWKHVODYHDQGFUHDWHWKHGDWDEDVH
~/blacktest$ bin/mysql -uroot -S slave.sock --prompt='slave> '
slave> CREATE DATABASE repdb;
slave> USE repdb;
$WWKLVSRLQWWKHVODYHLVVHWXSDQGKDVDQHPSW\repdbGDWDEDVH
 )LOOXSWKHVODYHGDWDEDVHZLWKWKHLQLWLDOVQDSVKRWRIWKHPDVWHU:HQHHGWRORDGWZR
ÀOHVKHUH7KHGHWDLOVRIZK\DUHH[SODLQHGIXUWKHUGRZQLQWKH+RZLWZRUNVVHFWLRQ
slave> source master_struct.sql;
...
slave> source master_data.sql;
...
 9HULI\WKDW\RXFDQÀQGWKHGDWDIURPWKHPDVWHURQWKHVODYHQRZE\GRLQJDSELECT 
* FROMÀUVWWDEOHrepdb.tblADQGWKHQrepdb.tblB
7KHÀUVWSELECTVKRZVQRUHFRUGVEHFDXVHtblAZDVH[FOXGHGIURPWKHGXPS
7DEOHtblBFRQWDLQVWKHWKUHHUHFRUGVZHLQVHUWHGRQWKHPDVWHU

&UHDWHDUHSOLFDWLRQXVHUDFFRXQWRQWKHÀOWHULQVWDQFHIRUWKHVODYHVWRXVH
black> GRANT REPLICATION SLAVE
   -> ON *.*
   -> TO 'repslave'@'localhost'
   -> IDENTIFIED BY 'slavepass';

&RQQHFWWKHVODYHWRWKHÀOWHUHQJLQH%HVXUHWRLQVHUWWKHFRUUHFW
YDOXHVIRUMASTER_LOG_FILEDQGMASTER_LOG_POSLQWKHVWDWHPHQW7KRVHDUH
WKHYDOXHV\RXZURWHGRZQZKHQ\RXLVVXHGWKHSHOWMASTERSTATUSFRPPDQGRQ
WKHÀOWHUVHUYHUEHIRUHVWDUWLQJWKHUHSOLFDWLRQWKHUH

5HSOLFDWLRQ

slave> CHANGE MASTER TO
    -> master_host='localhost',
    -> master_port=3308,
    -> master_user='repslave',
    -> master_password='slavepass',
    -> master_log_file='black-bin.000003',
    -> master_log_pos=98;
Query OK, 0 rows affected (0.01 sec)

6WDUWWKHVODYHDQGYHULI\WKDWLWVWDUWVXSFRUUHFWO\
slave> START SLAVE 
slave> SHOW SLAVE STATUS \G
************************** 1. row ***************************
             Slave_IO_State: Waiting for master to send event
                        ...
      Relay_Master_Log_File: black-bin.000003
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                         ...
      Seconds_Behind_Master: 0

$VVRRQDVWKHSUHYLRXVVWHSLVFRPSOHWHWKHUHSOLFDWLRQVKRXOGDOUHDG\KDYHXSGDWHG
tblBRQWKHVODYHDQGLQVHUWHGWKHQHZ-RKQUHFRUG9HULI\LWOLNHWKLV
slave> SELECT * FROM repdb.tblB;
$SSDUHQWO\WKHUHSOLFDWLRQZRUNV<RXFDQQRZWU\WRPRGLI\VRPHGDWDRQWKHPDVWHU
DQGFKHFNLIWKHUHVXOWVPDWFKRQWKHVODYH$Q\WKLQJ\RXGRWRPRGLI\tblBVKRXOG
EHUHÁHFWHGRQWKHVODYH5HPHPEHUWRXVHIXOO\TXDOLÀHGVWDWHPHQWVRWKHUZLVH
FKDQJHVZLOOQRWPDWFKWKHUHSOLFDWLRQUXOHV

&KDSWHU

+RZLWZRUNV
7KRXJK0\64/GLGQRWLPSOHPHQWDÀOWHURQWKHPDVWHUIHDWXUHOLWHUDOO\DQRWKHUZD\RIGRLQJ
VLPLODUWKLQJVZDVSURYLGHG:KLOH0\,6$0DQG,QQR'%LPSOHPHQWZD\VRIVWRULQJGDWDRQ
GLVNDQRWKHUHQJLQHZDVFUHDWHGWKDWLVEDVLFDOO\DQHPSW\VKHOO,WMXVWDQVZHUV2.WRDOO
INSERTUPDATERUDELETEUHTXHVWVFRPLQJIURPWKH64/OD\HUDERYHSELECTVWDWHPHQWV
DOZD\VUHWXUQDQHPSW\UHVXOWVHW7KLVHQJLQHLVVXLWDEO\FDOOHGWKHEODFNKROHVWRUDJHHQJLQH
DVHYHU\WKLQJ\RXSXWLQWRLWMXVWYDQLVKHV
Slave
Slave
Slave
Slave
Slave
Slave
Slave
Slave
Slave
Powerful Master,
Lots of writes
MySQL Server with
replication filter
configuration using
Blackhole engine.
Unfiltered regular
binlog
The arrow widths
are proportional to
the amount of
bandwidth needed
for the connection
Blackhole Engine Replication Filtering
Low bandwidth network
Blackhole Filter
High bandwidth network
Master

5HSOLFDWLRQ

,QWKHXSSHUSDUW\RXVHHWKHPDLQPDVWHUVHUYHU$OOPRGLI\LQJVWDWHPHQWVDUHZULWWHQRQWKH
PDVWHU
VELQORJÀOHVDQGVHQWRYHUWKHQHWZRUNWRVXEVFULEHGVODYHV,QWKLVFDVHWKHUHLVRQO\
DVLQJOHVODYHWKHÀOWHUVHUYHULQWKHPLGGOH7KHWKLFNDUURZLQEHWZHHQWKHPUHSUHVHQWVWKH
ODUJHDPRXQWRIGDWDWKDWLVVHQWWRLW
,QWKHORZHUSDUWRIWKHSLFWXUHWKHUHDUHDQXPEHURIVODYHV,QDUHJXODUVHWXSDWKLFN
DUURZZRXOGEHGUDZQIURPWKHPDVWHUWRHDFKRIWKRVH³PHDQLQJWKDWWKHVDPHPDVVLYH
DPRXQWRIUHSOLFDWLRQGDWDZRXOGEHVHQWRYHUWKHQHWZRUNPXOWLSOHWLPHV,QWKLVSLFWXUH
WKHÀOWHUVHUYHULVFRQÀJXUHGWRLJQRUHVWDWHPHQWVIRUFHUWDLQWDEOHV,WLVDOVRFRQÀJXUHGWR
ZULWHWKHVWDWHPHQWVUHFHLYHGIURPDUHSOLFDWLRQPDVWHUWRLWVRZQELQORJV7KLVLVGLIIHUHQW
IURPUHJXODUVODYHVEHFDXVHXVXDOO\WKRVHGRQRWZULWHUHSOLFDWHGVWDWHPHQWVWRWKHLUELQORJV
DJDLQ7KHÀOWHUVHUYHU
VELQORJVDUHPXFKVPDOOHUWKDQWKRVHRIWKHPDLQPDVWHUEHFDXVHORWV
RIVWDWHPHQWVKDYHEHHQOHIWRXW7KLVZRXOGQRUPDOO\KDYHWDNHQSODFHRQHDFKDQGHYHU\
UHJXODUVODYH
7KHUHJXODUVODYHVDUHFRQÀJXUHGDJDLQVWWKHÀOWHUVHUYHU7KDWPHDQVWKH\RQO\UHFHLYH
WKHSUHÀOWHUHGVWUHDPRIVWDWHPHQWVWKDWKDYHPDGHLWLQWRWKHÀOWHU
VELQORJVWKURXJKWKH
replicate-ignore-*DQGreplicate-do-*GLUHFWLYHV7KLVLVUHSUHVHQWHGE\WKLQDUURZV
LQWKHSLFWXUH
%HFDXVHVODYHVFDQJRRIÁLQHIRUH[WHQGHGDPRXQWVRIWLPHELQORJVFRXOGHDVLO\PRXQWXSWR
GR]HQVRIJLJDE\WHVLQDIHZGD\V:LWKWKHPXFKVPDOOHUÀOWHUHGELQORJV\RXFDQPRUHRIWHQ
SXUJHWKHODUJHPDLQPDVWHU
VELQORJVDVVRRQDV\RXKDYHPDGHDIXOOEDFNXSLQWKHHQG
IUHHLQJPRUHVSDFHWKDQLVQHHGHGE\WKHDGGLWLRQDOÀOWHULQVWDQFH
2WKHUVWRUDJHHQJLQHVWKDQ,QQR'%
%HDGYLVHGWKDWLI\RXDUHXVLQJDGLIIHUHQWVWRUDJHHQJLQHWKDQ,QQR'%IRU\RXUWDEOHV
HVSHFLDOO\0\,6$0\RXZLOOQHHGWRGRDOLWWOHPRUHWZHDNLQJ7KLVLVEHFDXVHWKH,QQR'%
H[DPSOHUHOLHVRQ0\64/
VEHLQJYHU\OHQLHQWFRQFHUQLQJHUURUVLQPDQ\FDVHV:HSXW
WKHskip-innodbRSWLRQLQWRWKHmy.blackFRQÀJÀOH7KLVPHDQVWKDW,QQR'%ZLOOQRW
EHDYDLODEOHDWUXQWLPH%HFDXVHWKHmaster_struct.sqlGXPSÀOHFRQWDLQVCREATE 
TABLE … ENGINE=InnoDBVWDWHPHQWV0\64/IDOOVEDFNWRWKHGHIDXOWVWRUDJHHQJLQHWKDW
ZHFRQÀJXUHGWREHWKHEODFNKROHHQJLQH
,I\RXDUHXVLQJ0\,6$0WDEOHVWKHUHLVQRQHHGIRUWKHVHUYHUWRDXWRPDWLFDOO\FKDQJHWKH
WDEOHW\SHEHFDXVH0\,6$0LVDOZD\VDYDLODEOH0\64/VWRUHVLWVXVHULQIRUPDWLRQDSDUWIURP
RWKHUWKLQJVLQ0\,6$0WDEOHV6R\RXZRXOGQHHGWRDGDSWWKHmaster_struct.sqlGXPS
ÀOHEHIRUHVRXUFLQJLWLQWRWKHÀOWHUVHUYHU,UHFRPPHQGXVLQJsedOLNHWKLV
~/blacktest$ sed -e 's/ENGINE=InnoDB/ENGINE=BLACKHOLE/g' \
>      master_struct.sql > master_black.sql
7KLVZLOOUHSODFHDOORFFXUUHQFHVRIWKH,QQR'%HQJLQHZLWKWKHEODFNKROHHQJLQHDQGSXW
WKHUHVXOWLQWRDQHZÀOH3OHDVHNHHSWKHRULJLQDOÀOHWRRDVLWZLOOEHQHHGHGIRUWKH
VODYHPDFKLQHV

&KDSWHU

6HWWLQJXSVODYHVYLDQHWZRUNVWUHDPLQJ
,I\RXQHHGWRUHVHWRQHRUPRUHVODYHVUHJXODUO\VD\HYHU\PRUQLQJEHIRUHEXVLQHVVKRXUV
EHJLQLPSRUWLQJD64/GXPSPLJKWWDNHWRRPXFKWLPHHVSHFLDOO\LIWKHVODYHVDUHUHODWLYHO\
ORZHQGPDFKLQHVZLWKRXWDVRSKLVWLFDWHG,2VXEV\VWHP
,QWKLVUHFLSHZHZLOOSUHVHQWDZD\WRVHWXSD0\64/VODYHZLWKPLQLPDO,2ORDGRQWKH
KDUGGULYHDQGWKHQHWZRUNDGDSWHURIWKHVODYH7KHH[DPSOHDVVXPHVD/LQX[EDVHGVODYH
PDFKLQHKRZHYHU\RXVKRXOGEHDEOHWRDSSO\WKLVWR:LQGRZVDVZHOOEXW\RXZLOOQHHGWR
GRZQORDGVRPHIUHHWRROVPRVW/LQX[GLVWULEXWLRQVFRPHZLWKRXWRIWKHER[
7KHJHQHUDOLGHDLVWRKDYHDPRUHSRZHUIXOPDFKLQHZKLFKFDQEHWKHPDVWHULIUHVRXUFHV
DOORZWRSUHSDUHDFRPSOHWHVHWRIGDWDÀOHVIRUWKHVODYHVDQGODWHUVWUHDPWKHPGLUHFWO\WR
WKHVODYH
VGLVNIURPDZHEVHUYHU
*HWWLQJUHDG\
7RWU\WKLVRXW\RXZLOOQHHGDPDVWHUVHUYHUZLWKDWOHDVWRQHVODYH$GGLWLRQDOO\DPDFKLQH
ZLWKDZHEVHUYHULQVWDOOHGLVUHTXLUHG'HSHQGLQJRQ\RXUVHWXSWKHPDVWHUVHUYHUPLJKWEH
VXLWDEOHIRUWKLVWDVN,QWKHH[DPSOHWKDWIROORZVZHZLOODVVXPHWKDWWKHPDVWHUVHUYHUKDV
DZHEVHUYHUUXQQLQJ
+RZWRGRLW

6HWXSDIUHVKWHPSRUDU\0\64/GDHPRQZLWKDFRQÀJXUDWLRQVLPLODUWRWKHFOLHQWV

'XPSWKHGDWDIURPWKHPDVWHUZLWKWKH--master-dataRSWLRQDQGIHHGLWLQWRWKH
WHPSRUDU\VHUYHU

6KXWGRZQWKHWHPSRUDU\VHUYHUDQGFRPSUHVVLWVGDWD

7UDQVIHUWKHDUFKLYHWRWKHVODYHVDQGXQSDFN

$GDSWWKHVODYHV
FRQÀJÀOHV

5XQWKHVODYHVDQGOHWWKHPFRQQHFWDQGFDWFKXSZLWKWKHPDVWHU
+RZLWZRUNV
7KLVUHFLSHLVEDVHGRQWKHIDFWWKDW\RXFDQTXLWHHDVLO\FRS\0\64/
VGDWDÀOHVLQFOXGLQJ
,QQR'%WDEOHVSDFHÀOHVIURPRQHPDFKLQHWRDQRWKHUDVORQJDV\RXFRS\WKHPDOO6RZH
ÀUVWFUHDWHDUHDG\WRJRVHWRIVODYHGDWDÀOHVRQDUHODWLYHO\SRZHUIXOPDFKLQHDQGWUDQVIHU
WKHPWRPXOWLSOHVODYHVZLWKZHDNHUKDUGZDUH8VXDOO\WKRVHÀOHVZLOOEHELJJHUWKDQDVLPSOH
64/GXPSÀOHWKDWLVXVXDOO\XVHGIRUVODYHVHWXSV%XWQRSDUVLQJDQGSURFHVVLQJLVUHTXLUHG
RQWKHWDUJHWV\VWHP7KLVPDNHVWKHZKROHWKLQJPRVWO\QHWZRUNDQGOLQHDUGLVN,2ERXQG

5HSOLFDWLRQ

7KHLGHDEHKLQGWKLVFRQFHSWLVWRUHOLHYHWKHLQGLYLGXDOVODYHVIURPLPSRUWLQJ64/ÀOHV
WKHPVHOYHV$VWKHLUKDUGZDUHLVUDWKHUVORZDQG0\64/RQO\VXSSRUWVVLQJOHWKUHDGHG
VODYH64/H[HFXWLRQWKLVFDQEHYHU\WLPHFRQVXPLQJ,QVWHDGZHXVHWKHPDVWHU
VEHWWHU
UHVRXUFHVWHPSRUDULO\DVDVLQJOHSRZHUVODYHDQGOHWLWKDQGOHWKHSURFHVVRILPSRUWLQJ:H
WKHQSURYLGHDQ\QXPEHURILGHQWLFDOVODYHVZLWKLWVGDWDÀOHV7KLVZLOOUHGXFHWKHEXUGHQRI
WKHRWKHUVODYHVWRVLPSO\XQSDFNLQJVRPHÀOHV
:KLOHWKLVGRHVQRWUHDOO\VDYHDQ\WKLQJLQWHUPVRIE\WHVWKDWQHHGWREHZULWWHQWRHDFK
VODYH
VGLVNWKHDFFHVVSDWWHUQLVPXFKPRUHVHQVLEOH7KHIROORZLQJWDEOHFRPSDUHVWKHGLVN
WUDQVIHUVIRUDUHJXODU64/LPSRUWIURPORFDOGLVNDQGWKHSURSRVHGDOWHUQDWLYHIRUD0%
J]LSSHG64/ÀOHZKLFKZLOOOHDGWRDSSUR[LPDWHO\*%RI,QQR'%WDEOHVSDFHÀOHV
5HJXODU64/,PSRUW
3UHSDUHG'DWD)LOH'HSOR\PHQW
/LQHDUZULWH0%GRZQORDGWRORFDOGLVN
'RZQORDG0%GLUHFWO\VWUHDPHGWR*%GDWD
ÀOHVZULWWHQOLQHDUO\
/LQHDUZULWH*%LQLWLDOFUHDWLRQRI,QQR'%
GDWDÀOHV
QD
/LQHDUUHDG0%64/J]LQWHUOHDYHGZLWK
UDQGRPZULWH*%WRGDWDÀOHV
QD
*%WRWDOUHDGZULWWHQUDQGRPO\
*%OLQHDUZULWH
,PSRUWLQJD64/ÀOHIURPWKHORFDOKDUGGLVNPHDQVWKHUHDUHFRQWLQXDOVHHNVEHWZHHQWKH
FXUUHQWSRVLWLRQLQWKH64/WH[WÀOHDQGWKHVHUYHU
VGDWDÀOHV0RUHRYHUDVWKHGDWDEDVH
VFKHPDPD\GHÀQHORWVRILQGH[HVWKHUHLVHYHQPRUHUDQGRPGLVNZULWHDFWLYLW\ZKHQ
H[HFXWLQJVLPSOHINSERTVWDWHPHQWV
,QFRQWUDVWXQSDFNLQJUHDG\PDGH,QQR'%WDEOHVSDFHVRU0\,6$0WDEOHÀOHVIRUWKDWPDWWHU
LVEDVLFDOO\MXVWOLQHDUZULWLQJ
7HPSRUDU\GDHPRQ
7KH64/GXPSQHHGVWREHH[HFXWHGDWOHDVWRQFH6RZHVHWXSDWHPSRUDU\0\64/
GDHPRQZLWKDVWULSSHGGRZQFRQÀJXUDWLRQWKDWLVFORVHWRWKHDFWXDOVODYHV³PHDQLQJDOOWKH
SDUDPHWHUVWKDWDIIHFWWKHVWRUDJHÀOHVPXVWPDWFKWKHVODYHVWRFUHDWHFRPSDWLEOHGDWDÀOHV
(YHU\WLPH\RXZDQWWRSUHSDUHVXFKDQHZVODYHLQVWDOODWLRQLPDJHWKHWHPSRUDU\GDHPRQ
VKRXOGEHVWDUWHGZLWKDQHPSW\GDWDGLUHFWRU\:KLOHQRWVWULFWO\QHFHVVDU\ZHSUHIHU
WRGHOHWHWKHWDEOHVSDFHDQGWUDQVDFWLRQORJÀOHVHYHU\WLPHEHFDXVHLWDOORZVIRUEHWWHU
FRPSUHVVLRQUDWHVODWHU
7KHGDWDÀOHVVKRXOGEHFUHDWHGFORVHWRWKHVL]HWKDWZLOOEHQHHGHGPD\EHDOLWWOHPRUH
WRSUHYHQWWKHQHHGIRUWKHPWRJURZ1HYHUWKHOHVVVSHFLI\WKHODVWGDWDÀOHWREHDXWR
H[WHQGLQJ2WKHUZLVHWKHSURFHVVRILPSRUWLQJWKH64/GDWDPD\OHDGWRÀOOLQJWKHWDEOHVSDFH
SUHPDWXUHO\HVSHFLDOO\ZKHQXVHGLQDQDXWRPDWHGSURFHVVWKDWFDQEHGLIÀFXOWWRKDQGOH

&KDSWHU

$OVR\RXVKRXOGDOORZ,QQR'%WRDGGODUJHUFKXQNVWRWKHODVWGDWDÀOHLIQHHGHGGHIDXOW
0%([WHQGLQJWKHÀOHVLVDVVRFLDWHGZLWKVRPHRYHUKHDGEXWXVLQJELJJHUFKXQNVUHGXFHV
WKHLPSDFWRQWKH,2VXEV\VWHP<RXVKRXOGEHÀQHZLWK0%RU0%7KHELJJHUWKLV
LVWKHOHVVRIWHQ,QQR'%ZLOOKDYHWRH[WHQGWKHÀOH6HHWKHPDQXDOVHFWLRQRQ,QQR'%
FRQÀJXUDWLRQIRUPRUHLQIR
'XPSLQJPDVWHUGDWD
2QFH\RXKDYHWKHWHPSRUDU\GDHPRQUXQQLQJXVHWKHmysqldumpWRROZLWKWKH--master-
dataDQG--single-transactionRSWLRQVWRFUHDWHDGXPSRIWKHGDWDEDVHV\RXQHHG
WRUHSOLFDWH,QRUGHUWRVDYHWLPHDQGGLVNVSDFH\RXPD\ÀQGLWXVHIXOWRSLSHWKHRXWSXW
GLUHFWO\WKURXJKWKHmysqlFRPPDQGOLQHFOLHQWDQGIHHGLWLQWRWKHWDUJHWWHPSRUDU\VHUYHU
6KXWWLQJGRZQDQGFRPSUHVVLQJ
<RXFDQQRZVKXWGRZQWKHWHPSRUDU\VHUYHU&RPSUHVVWKHGDWDGLUHFWRU\'HSHQGLQJRQKRZ
\RXZDQWWRFRQÀJXUHSHUPLVVLRQV\RXPD\LQFOXGHRUH[FOXGHWKHP\VTOVFKHPD:HXVXDOO\
KDYHWKHWHPSRUDU\VHUYHUVHWXSZLWKDVORZSHUPLVVLRQVDVSRVVLEOHDQGGRQRWPRYHWKH
P\VTOVFKHPDDORQJ
)RUFRPSUHVVLRQ\RXVKRXOGQRWXVHWKH=,3IRUPDW,WFRQWDLQVDFDWDORJRIDOOÀOHVLQFOXGHG
DWLWVYHU\HQGVRSLSLQJLWWKURXJKDGHFRPSUHVVLRQSURJUDPRQWKHÁ\ZLOOQRWZRUN,QVWHDG
ZHXVHDJ]LSSHGWDUEDOO7KLVDOORZVXVWRGRZQORDGDQGWRSLSHWKHGDWDVWUHDPWKURXJK
gunzipEHIRUHGLUHFWLQJLWWRGLVN
7UDQVIHUULQJWRWKHVODYHDQGXQFRPSUHVVLQJ
2QWKHVODYHZHVXJJHVWcurlDVDGRZQORDGWRRO,WLVLPSRUWDQWWKDWWKHWRRO\RXFKRRVHEH
DEOHWRRXWSXWWKHGRZQORDGHGÀOHGLUHFWO\WRVWDQGDUGRXW:LWKcurlWKDWLVTXLWHVLPSOH³LW
LVLWVGHIDXOWEHKDYLRU,WDOVRKDQGOHVÀOHVODUJHUWKDQ*%ZKLFKVRPHYHUVLRQVRIwget
KDYHSUREOHPVZLWK7KHFRPPDQGOLQHVKRXOGORRNVLPLODUWRWKLV
curl http://the.server/mysql_data.tgz | tar -C /the/target/datadir -xzf -
curlZLOOGRZQORDGWKHÀOHDQGSLSHLWWRtarWRGHFRPSUHVVLQWRWKHWDUJHWGDWDGLUHFWRU\
'RQRWPLVVWKHÀQDO-DWWKHHQGRIWKHFRPPDQG
<RXZLOOÀQGWKDWRQDORFDODUHDQHWZRUNGRZQORDGLQJDQGXQSDFNLQJZLOOEHFRQVLGHUDEO\
IDVWHUWKDQKDYLQJ0\64/WRÀUVWFUHDWHWKHHPSW\GDWDÀOHDQGWKHQLPSRUWWKH64/IRUWKH
UHDVRQVVWDWHGDERYH

5HSOLFDWLRQ

$GMXVWLQJVODYHFRQÀJXUDWLRQ
:KHQWKHGDWDÀOHVKDYHUHDFKHGWKHLUGHVWLQDWLRQRQWKHVODYH\RXPD\QHHGWRDGMXVWWKH
VODYHVHWWLQJV7KLVHVSHFLDOO\GHSHQGVRQZKHWKHU\RXFRSLHGÀ[HGVL]HGDWDÀOHVLQZKLFK
FDVH\RXFDQSUHSDUHWKHFRQÀJÀOHLQDGYDQFHRUXVHGWKHautoextendRSWLRQRQWKHODVW
WDEOHVSDFHÀOH,QWKDWFDVH\RXFRXOGZULWHDOLWWOHVFULSWWKDWWDNHVDWHPSODWHmy.cnfÀOH
ZLWK\RXUEDVLFVHWWLQJVDQGUHSODFHVVRPHSODFHKROGHUVIRUWKHGDWDÀOHUHODWHGVHWWLQJVYLD
sed2QHRIWKRVHLVWKHVL]HRIWKHODVW,QQR'%GDWDÀOHIURPWKHDUFKLYH,WZLOOEHFRPHD
À[HGVL]HÀOHRQWKHVODYH$QRWKHUÀOHZLOOWKHQEHDGGHGDWWKHÀUVWVODYHVWDUW
&RQQHFWLQJWRWKHPDVWHU
2QHODVWWKLQJWKDWQHHGVWREHGRQHLVWRUHDGWKHPDVWHU
VFXUUHQWELQORJÀOHQDPHDQG
SRVLWLRQIURPWKHmaster.infoÀOH7KLVLVUHTXLUHGEHFDXVHRQFHWKHVODYHVHUYHUKDVEHHQ
VWDUWHG\RXZLOOQHHGWRSURYLGHFRUUHFWFUHGHQWLDOVIRUWKHUHSOLFDWLRQXVHU<RXPXVWDOVR
H[SOLFLWO\WHOOWKHVODYHZKLFKPDVWHUKRVWWRFRQQHFWWR8QIRUWXQDWHO\ZKHQLVVXLQJDCHANGE 
MASTERTOFRPPDQGRQWKHVODYHZKLFKLQFOXGHVDPDVWHUKRVWQDPHDOOLQIRUPDWLRQ
DERXWSUHYLRXVPDVWHUELQORJV³WKHFRUUHVSRQGLQJRIIVHW³LVGLVFDUGHGVHH0\64/RQOLQH
PDQXDOFKDSWHU&+$1*(0$67(5726\QWD[DWhttp://dev.mysql.com/doc/
refman/5.1/en/change-master-to.html
7KHUHIRUH\RXZLOOQHHGWRWHOOWKHVODYHDJDLQZKHUHWREHJLQUHSOLFDWLRQ
2QHSRVVLEOHVROXWLRQLVWRUHDGWKHFRQWHQWVRIWKHmaster.infoÀOHWKDWZDVEURXJKWDORQJ
ZLWKWKHGDWDÀOHVLQWRDEDVKVFULSWDUUD\DQGLQMHFWWKHYDOXHVLQWRWKHVWDWHPHQW
arr = ( $(cat master.info) ) 
mysql -e "CHANGE MASTER TO master_host='the.master.server', master_
user='replication_user', master_password='the_password',
master_log_file='${arr[2]}', master_log_pos=${arr[3]}"
7KHIRUPDWRIWKHmaster.infoÀOHLVGHVFULEHGLQWKH0\64/PDQXDO
6WDUWLQJWKHVODYH
$VVRRQDV\RXLVVXHDSTARTSLAVEVWDWHPHQWWKHVODYHZLOOFRQQHFWWRWKHPDVWHUDQG
EHJLQWRFDWFKXSZLWKZKDWHYHUKDVKDSSHQHGVLQFHWKHWLPHZKHQWKHGXPSZDVWDNHQ
6NLSSLQJSUREOHPDWLFTXHULHV
7KHUHDUHRFFDVLRQVZKHUHVRPHWKLQJJRHVZURQJDQGDSUREOHPSUHYHQWVRQHRUPRUHVODYH
VHUYHUVIURPXSGDWLQJ7KHUHDVRQVIRUWKLVFDQEHVHYHUDOEXWPRVWRIWHQVRPHVRUWRI
GLVFUHSDQF\EHWZHHQWKHPDVWHU
VDQGWKHVODYH
VGDWDVHWZLOOFDXVHDVWDWHPHQWWRIDLORQ
WKHVODYHWKDWZDVH[HFXWHGSURSHUO\RQWKHPDVWHURWKHUZLVHLWZRXOGQRWKDYHPDGHLWWR
WKHELQORJ

&KDSWHU

7KLVLVZKHUHWKHEDVLFSULQFLSOHRIDVVXPLQJPDVWHUDQGVODYHEHLQJHTXDOEHFRPHVDOLWWOH
WRRVLPSOH,WFDQOHDGWRDSRWHQWLDOO\ORQJVHULHVRIVWDWHPHQWVH[HFXWLQJRQWKHVODYHEXW
RQDGLIIHUHQWVHWRIGDWDWKDQWKHPDVWHUKDV'HSHQGLQJRQKRZORQJWKLVJRHVXQQRWLFHG
WKHPDVWHUDQGVODYHFDQGULIWRXWRIV\QFXQQRWLFHGXQWLODVWDWHPHQWFDQQRWEHH[HFXWHG
VXFFHVVIXOO\RQWKHVODYH³IRUH[DPSOHEHFDXVHDIRUHLJQNH\FRQVWUDLQWIDLOVRQWKHVODYH
)RUWXQDWHO\QRWHYHU\SUREOHPVWHPVIURPVXFKDVHULRXVHUURUZKLFKFDQRIWHQRQO\EH
UHSDLUHGE\UHVHWWLQJWKHDIIHFWHGVODYHVWRDNQRZQJRRGVWDWH
2IWHQDVODYHVWRSVWKHUHSOLFDWLRQEHFDXVHDUHFRUGWREHLQVHUWHGLVDOUHDG\SUHVHQW
UHVXOWLQJLQNH\XQLTXHQHVVYLRODWLRQHUURU7KLVLVHVSHFLDOO\OLNHO\ZKHQDFFLGHQWDOO\RURQ
SXUSRVH\RXDUHZRUNLQJRQWKHPDVWHUDQGWKHVODYHVPRGLI\LQJGDWDRQERWKVLGHVPD\EH
HYHQWRÀ[DUHSOLFDWLRQSUREOHP
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRVNLSRQHRUPRUHSUREOHPDWLFTXHULHV³PHDQLQJ
LQVWUXFWLRQVUHSOLFDWHGIURPWKHPDVWHUWKDWZLOOQRWH[HFXWHFRUUHFWO\RQWKHVODYHPDFKLQH
*HWWLQJUHDG\
:HZLOOGHPRQVWUDWHWKHVNLSSLQJRISUREOHPDWLFTXHULHVLQDFRQWULYHGHUURUVFHQDULR7RWU\
WKLVIRU\RXUVHOI\RXZLOOQHHGWZR0\64/VHUYHUVVHWXSDVPDVWHUDQGVODYHEHLQJFXUUHQWO\
LQV\QF$VDQH[DPSOHZHZLOOXVHWKHsakilaVDPSOHGDWDEDVHWRGHPRQVWUDWHDUHFRUG
INSERTWKDWIDLOVRQWKHVODYHEHFDXVHLWZDVSUHYLRXVO\LQVHUWHGPDQXDOO\E\DFFLGHQW
+RZWRGRLW

&RQQHFWWRWKHPDVWHUXVLQJD0\64/FOLHQW0DNHsakilaWKHGHIDXOWGDWDEDVH

:LWKDVHFRQGFOLHQWFRQQHFWWRWKHVODYH0DNHsakilaWKHGHIDXOWVFKHPDKHUH
DVZHOO

2QWKHVODYHHQWHUWKHIROORZLQJFRPPDQGWRLQVHUWDQHZFDWHJRU\
slave> INSERT INTO category (name) VALUES ('Inserted On Slave');

5HSOLFDWLRQ

,QWKLVFDVHWKHFDWHJRU\BLG FROXPQZDVDXWRPDWLFDOO\VHWEHFDXVHLWLVGHÀQHG
DVDXWRLQFUHPHQWLQJ$WWKLVSRLQWWKHPDVWHUDQGWKHVODYHDUHDOUHDG\RXWRIV\QF
EHFDXVHWKLVUHFRUGGRHVQRWH[LVWRQWKHPDVWHU

2QWKHPDVWHULQVHUWDQHZUHFRUGDVZHOO
master> INSERT INTO category (name) VALUES ('Inserted On Master');
<RXFDQVHHWKDWWKHPDVWHUDOVRSLFNHGDVWKHFDWHJRU\BLG,WKDVEHHQZULWWHQWR
WKHELQORJDQGKDVE\QRZSUREDEO\EHHQUHSOLFDWHGWRWKHVODYH

+DYHDORRNDWWKHUHSOLFDWLRQVWDWXVRQWKHVODYH
slave> SHOW SLAVE STATUS \G
************************** 1. row ***************************
                        ...
          Slave_IO_Running: Yes
         Slave_SQL_Running: No
                        ...
     Seconds_Behind_Master: NULL
<RXFDQVHHWKDWWKHUHSOLFDWHGLQVHUWKDVIDLOHG1RPRUHVWDWHPHQWVUHSOLFDWHGIURP
WKHPDVWHUZLOOEHH[HFXWHGSlave_SQL_Running: No

5HSDLUWKHGDPDJHE\PDNLQJVXUHWKHVODYHUHFRUGVDUHLGHQWLFDO
slave> UPDATE category SET name='Inserted On Master' WHERE 
category_id=17;
1RZWKHGDWDRQPDVWHUDQGVODYHDUHLGHQWLFDODJDLQ

7HOOWKHVODYHWKDW\RXZDQWWRVNLSWKHRQHINSERTVWDWHPHQWWKDWFDPHIURPWKH
PDVWHUDQGWKDWFDQQRWEHH[HFXWHG
slave> SET GLOBAL SQL_SLAVE_SKIP_COUNTER=1;

6WDUWWKHVODYH64/WKUHDGDJDLQDQGFKHFNWKHUHSOLFDWLRQVWDWXV
slave> START SLAVE;

&KDSWHU

slave> SHOW SLAVE STATUS \G
************************** 1. row ***************************
                        ...
           Slave_IO_Running: Yes
          Slave_SQL_Running: Yes
                        ...
      Seconds_Behind_Master: 0
<RXFDQVHHWKDWWKHUHSOLFDWLRQLVXSDQGUXQQLQJDJDLQ
+RZLWZRUNV
:KHQWKHVODYHGDWDZDVRXWRIV\QFLQVXFKDZD\WKDWDVWDWHPHQWIURPWKHPDVWHUZRXOG
IDLOLQWKLVFDVHEHFDXVHRIDGXSOLFDWHLGHQWLW\FROXPQYDOXHWKHVODYHVHUYHUVWRSSHG
H[HFXWLQJDQ\PRUH64/VWDWHPHQWVHYHQWKRXJKLQWKHEDFNJURXQGWKH\ZHUHVWLOOUHDGIURP
WKHPDVWHUDQGVWRUHGLQWKHUHOD\ORJV7KLVLVZKDWWKHSlave_IO_StateDQGSlave_IO_
RunningFROXPQVIURPWKHRXWSXWRISHOWSLAVESTATUSVD\
0\64/GRHVWKLVWRJLYH\RXDFKDQFHWRORRNDWWKHSUREOHPDQGGHWHUPLQHLI\RXFDQUHSDLU
WKHVLWXDWLRQVRPHKRZ,QWKLVYHU\VLPSOHH[DPSOHWKHVROXWLRQLVVLPSOHEHFDXVHZHFDQ
HDVLO\EULQJWKHVODYH
VGDWDEDFNLQV\QFZLWKWKHPDVWHUE\PRGLI\LQJWKHUHFRUGLQTXHVWLRQ
WRPDWFKWKHFRQWHQWVWKDWZHUHVHQWIURPWKHPDVWHUDQGWKHQVNLSWKHINSERTUHSOLFDWHG
IURPWKHPDVWHUXVLQJWKHSQL_SLAVE_SKIP_COUNTERJOREDOYDULDEOH7KLVZLOOVNLSH[DFWO\
RQHVWDWHPHQWIURPWKHUHOD\ORJVZKHQWKHVODYHLVQH[WWROGWRVWDUW,QRXUFDVHWKLVLVWKH
SUREOHPDWLFINSERT
$IWHUWKDWWKHUHSOLFDWLRQLVEDFNLQV\QFDVPDVWHUDQGVODYHDUHQRZEDVHGRQLGHQWLFDOGDWD
VHWVDJDLQDOORZLQJWKHIROORZLQJVWDWHPHQWVWREHUHSOLFDWHGQRUPDOO\
7KHUH
VPRUH
$QRWKHUVROXWLRQLQWKLVSDUWLFXODUFDVHFRXOGKDYHEHHQWRGHOHWHWKHUHFRUGRQWKHVODYHDQG
WKHQUHVWDUWWKHUHSOLFDWLRQZLWKSTART SLAVE$VWKHINSERTIURPWKHPDVWHUKDVQRWEHHQ
H[HFXWHG\HWUHSOLFDWLRQZRXOGFRQWLQXHDVLIQRWKLQJKDGKDSSHQHG
+RZHYHUXQGHUPRUHUHDOLVWLFFLUFXPVWDQFHVZKHQFRQIURQWHGZLWKDVLWXDWLRQOLNHWKLV\RX
PLJKWQRWKDYHDFKDQFHWRGHOHWHWKHURZRQWKHVODYHGXHWRIRUHLJQNH\FRQVWUDLQWV2QO\
EHFDXVHZHLPPHGLDWHO\WRRNFDUHRIWKHSUREOHPDQGZHZHUHVXUHWKDWLQWKHPHDQWLPH
QRSURJUDPVFRXOGKDYHZULWWHQWRWKHVODYHSRVVLEO\FUHDWLQJQHZUHIHUHQFHVWRWKDWUHFRUG
ZHUHZHDEOHWRUHPRYHLW
'HSHQGLQJRQ\RXUDSSOLFDWLRQDUFKLWHFWXUHDQGKRZIDVW\RXQRWLFHGWKHSUREOHPVRPH
SURFHVVPLJKWKDYHEHHQZULWLQJGDWDWRWKHVODYHVWRWDEOHVWKDWDUHGHVLJQHGIRUWKLV
SXUSRVHOLQNLQJWRWKHQRZSUHVHQWcategory_idDQGHIIHFWLYHO\SUHYHQWLQJ\RXIURP
GHOHWLQJLW

5HSOLFDWLRQ

:KLOHLQWKLVVLPSOHFDVHZHZRXOGEHVXUHWKDWWKHUHSOLFDWLRQVHWXSLVQRZEDFNWRQRUPDO
DJDLQ\RXRIWHQZLOOQRWEHDEOHWRWHOOIRUFHUWDLQDWZKLFKSRLQWLQWLPHDUHSOLFDWLRQSUREOHP
RULJLQDWHGINSERTVWDWHPHQWVRIGXSOLFDWHNH\VZLOOLPPHGLDWHO\FDXVHDQHUURUWREHFRPH
DSSDUHQWUPDATERUDELETE VWDWHPHQWVZLOORIWHQVXFFHHGLQH[HFXWLQJEXWZRXOGKDYH
GLIIHUHQWHIIHFWVRQWKHVODYHWKDQRQWKHPDVWHUZKHQWKH\ZHUHSUHYLRXVO\RXWRIV\QF
3UREOHPVOLNHWKLVFDQFRUUXSWWKHGDWDRQ\RXUVODYHVVLOHQWO\IRUH[WHQGHG
SHULRGVRIWLPH:KHQ\RXÀQGRXWLQWKHHQGLWLVRIWHQWRRODWHWRUHFRYHU
ZLWKRXWUHVRUWLQJWRVHWWLQJXSWKHVODYHDIUHVK
:KHQLQGRXEWZHUHFRPPHQGWRÀUVWXVHmk-table-checksumDV
GHVFULEHGLQWKH&KHFNLQJLIVHUYHUVDUHLQV\QFUHFLSHLQWKLVFKDSWHU
RUPRUHJHQHUDOO\WRVHWXSWKHVODYHIURPDZHOONQRZQJRRGVWDWHWREH
FRPSOHWHO\VXUH
&KHFNLQJLIVHUYHUVDUHLQV\QF
$V0\64/FDQQRWGHWHFWLIWZRVHUYHUVDUHLQV\QFWKDWLVWKH\FRQWDLQWKHVDPHUHFRUGVDQG
WDEOHVRQHZRXOGRIWHQOLNHWRYHULI\WKDWPDVWHUDQGVODYHDUHVWLOOZRUNLQJRQLGHQWLFDOGDWD
VHWVWREHVXUHQRFRUUXSWLRQKDVRFFXUUHG\HW
)RUWKLVSXUSRVHWKHH[FHOOHQW0DDWNLWVXLWHRISURJUDPVVHHhttp://www.maatkit.org
FRQWDLQVDKDQG\WRROFDOOHGmk-table-checksum,WDXWRPDWLFDOO\FDOFXODWHVFKHFNVXPV
RIWDEOHVRQRQHRUPRUHVHUYHUVZKLFKFDQWKHQEHFRPSDUHG6KRXOGWKHFKHFNVXPVGLIIHU
WKHQWKHWDEOHLQTXHVWLRQLVQRWLGHQWLFDORQWKHPDFKLQHVLQYROYHGLQWKHFKHFN
7KHVHUYHUVLQYROYHGQHHGQRWQHFHVVDULO\EHDUHSOLFDWLRQPDVWHUDQGVODYHVEXWFDQEH
DQ\VHWRIVHUYHUV\RXZLVKWRFRPSDUHmk-table-checksumKDVDQDGGLWLRQDODOWHUQDWLYH
PHDQVRIFKHFNLQJWKHVSHFLDOFDVHLQUHSOLFDWLRQHQYLURQPHQWVWRVHHLIDPDVWHUDQGLWV
VODYHVDUHLQV\QF6HHWKH7KHUH
VPRUHVHFWLRQDWWKHHQGRIWKLVUHFLSHIRUPRUHGHWDLOVRQ
WKLVIHDWXUH
*HWWLQJUHDG\
0DDWNLWLVZULWWHQLQ3HUO:KLOHRQPRVW8QL[OLNHV\VWHPVWKLVVFULSWLQJODQJXDJHLVDOUHDG\
LQVWDOOHGE\GHIDXOWRUFDQEHHDVLO\GRZQORDGHGDQGVHWXS:LQGRZVXVHUVZLOOQRWEHVR
OXFN\LQJHQHUDO,I\RXDUHVWXFNZLWK:LQGRZV\RXPLJKWZDQWWRWDNHDORRNDW$FWLYH3HUO
DPDWXUH3HUOLPSOHPHQWDWLRQIRU:LQGRZV
0RUHRYHU\RXDUHGHÀQLWHO\JRLQJWRQHHGWKH0DDWNLWmk-table-checksumWRRO<RXFDQ
JHWLWGLUHFWO\IURPhttp://www.maatkit.org$OVRGRZQORDGWKHmk-checksum-filter
FRPSDQLRQWRRODQGSXWLWLQWKHVDPHGLUHFWRU\DVmk-table-checksum

&KDSWHU

,QWKLVH[DPSOHZHZLOOFRPSDUHWZR0\64/VHUYHUVWKDWGLIIHULQWKHsakilaGDWDEDVH
V
countryWDEOHORFDWHGRQPDFKLQHVFDOOHGVHUYHU$DQGVHUYHU%
<RXZLOOQHHGWRKDYHXVHUDFFRXQWVIRUERWKPDFKLQHVWKDWKDYHSHUPLVVLRQWRFRQQHFWDQG
H[HFXWHVWDWHPHQWVUHPRWHO\
7KHFRPPDQGOLQHVLQWKLVUHFLSHPLJKWFKDQJHZLWKQHZHUYHUVLRQVRI0DDWNLWDVLWLVXQGHU
DFWLYHGHYHORSPHQW'RXEOHFKHFNZLWKWKHRQOLQHPDQXDOWKDWWKHLQVWUXFWLRQVSULQWHGKHUH
DUHVWLOOFXUUHQWEHIRUHWU\LQJWKHPRXW
+RZWRGRLW
 2QDFRPPDQGVKHOOSURPSWHQWHUWKHIROORZLQJOLQHDVVXPLQJmk-table-checksum
LVLQWKHFXUUHQWGLUHFWRU\DQGH[HFXWDEOH
       $ ./mk-table-checksum h=serverA,u=userA,p=passwordA
       h=serverB,u=userB,p=passwordB | ./mk-checksum-filter

&KHFNWKHRXWSXWRIWKLVFRPPDQGIRUPDWWHGDQGDEEUHYLDWHGIRUSULQWLQJ
'DWDEDVH 
7DEOH
&KXQN 
+RVW
(QJLQH
&RXQW
&KHFNVXP
VDNLOD
FRXQWU\

VHUYHU$
,QQR'%
18//

VDNLOD
FRXQWU\

VHUYHU%
,QQR'%
18//

1RWLFHWKHODVWFROXPQ7KHFKHFNVXPVGRQRWPDWFK³WKHWDEOHVDUHQRWLGHQWLFDO
+RZLWZRUNV
mk-table-checksumFRQQHFWVWRDOOVHUYHUVOLVWHGRQWKHFRPPDQGOLQHDQGFDOFXODWHV
FKHFNVXPVIRUDOOWDEOHV,GHQWLFDOWDEOHFRQWHQWVUHVXOWLQLGHQWLFDOFKHFNVXPV6RLIWKH
FKHFNVXPVIURPWZRVHUYHUVGRQRWPDWFKIRUDQ\JLYHQWDEOHWKHUHPXVWEHDGLIIHUHQFHLQ
WKHLUFRQWHQWV7KHmk-checksum-filterWRROUHPRYHVDOOOLQHVIURPWKHRXWSXWWKDWGRQRW
LQGLFDWHDFKHFNVXPPLVPDWFK
,WLVLPSRUWDQWWRNQRZWKDWWKHFKHFNVXPVDUHGLIIHUHQWLI\RXHPSOR\
GLIIHUHQWYHUVLRQVRI0\64/DFURVVVHUYHUV,QWKLVFDVHDGLIIHUHQW
FKHFNVXPPLJKWMXVWEHWKHUHVXOWRIWKHGLIIHUHQWYHUVLRQV
mk-table-checksumRIIHUVVHYHUDODOJRULWKPVIRUFKHFNVXPPLQJHDFKZLWKGLIIHUHQW
VSHHGVDQGGLIIHUHQWOHYHOVRIUHVLOLHQFHDJDLQVWFHUWDLQNLQGVRIGDWDGLIIHUHQFHVWKDWPLJKW
FDQFHOHDFKRWKHURXWOHDGLQJWRLGHQWLFDOFKHFNVXPVEXWIRUGLIIHUHQWGDWD7KH0DDWNLW
RQOLQHPDQXDOFRQWDLQVGHWDLOHGDQGFXUUHQWLQIRUPDWLRQRQWKLVWRSLF

5HSOLFDWLRQ

7KHUH
VPRUH
'XHWRWKHDV\QFKURQRXVQDWXUHRI0\64/UHSOLFDWLRQH[HFXWLQJWKHFKHFNVXPVWDWHPHQWV
UHPRWHO\IURPDVLQJOHPDFKLQHPD\QRW\LHOGUHOLDEOHUHVXOWV7KLVLVEHFDXVHWKHPDVWHU
GDWDEDVHPLJKWDOUHDG\FRQWDLQPRGLÀFDWLRQVWKDWKDYHQRWEHHQH[HFXWHGE\HDFKVODYH\HW
7RFRPSHQVDWHmk-table-checksumRIIHUVDVSHFLDOPRGHWRFKHFNVODYHVDQGPDVWHUV
,QVWHDGRIH[HFXWLQJWKHFDOFXODWLRQVUHPRWHO\WKHVWDWHPHQWVWRGRVRDUHZULWWHQWRWKH
PDVWHU
VELQORJDQGWKHQVHQWRIIWRWKHVODYHVYLDWKHUHJXODUUHSOLFDWLRQPHFKDQLVP7KLV
HQVXUHVWKDWHDFKVODYHZLOOFDOFXODWHWKHFKHFNVXPDWWKHFRUUHFWWLPHZLWKUHVSHFWWRWKH
WUDQVDFWLRQRUGHU7KHUHVXOWVDUHWKHQVWRUHGLQDWDEOHRQWKHVODYHWKDWFDQEHUHWULHYHG
ZLWKDVHFRQGFRPPDQGUHPRWHO\ODWHURQ7RXVHWKLVIHDWXUH\RXQHHGDXVHUZLWKVXIÀFLHQW
SULYLOHJHVWRFUHDWHDWDEOHIRUWKLVSXUSRVHRQWKHVODYHV
)RUPRUHGHWDLOVVHHWKH--replicateDQG--create-replicate-tableRSWLRQVLQWKH
0DDWNLWRQOLQHPDQXDO
$YRLGLQJGXSOLFDWHVHUYHU,'V
$NH\FRQÀJXUDWLRQLWHPLQDQ\UHSOLFDWLRQVHWXSLVVHUYHU,'V7KH\PXVWEHXQLTXHDFURVVDOO
SDUWLFLSDWLQJPDVWHUDQGVODYHPDFKLQHV8QIRUWXQDWHO\WKHUHLVQRRIÀFLDOZD\WRYHULI\WKLV
UHOLDEO\,QVWHDGZKHQ\RXLQWURGXFHGXSOLFDWHVE\PLVWDNHVWUDQJHEHKDYLRUPD\VXUIDFH
*HQHUDOO\WKLVKDSSHQVZKHQFORQLQJWKHPDFKLQHVIURPDQLPDJH
0RVWLPSRUWDQWO\RQWKHPDVWHUVHUYHU\RXZLOOQRWVHHDQ\LQGLFDWLRQRIWKHSUREOHP7KH
SUREOHPDULVHVRQO\RQWKHVODYHVZLWKRXWFOHDUO\VWDWLQJWKHURRWFDXVHRIWKHSUREOHP6HH
WKH7KHUH
VPRUHVHFWLRQRIWKLVUHFLSHIRUPRUHGHWDLOV
*HWWLQJUHDG\
7KHserver-idVHWWLQJGRHVQRWFDUU\DQ\PHDQLQJLQDQGRILWVHOIEXWLVRQO\XVHGWR
LQWHUQDOO\GLVWLQJXLVKVHUYHUVIURPHDFKRWKHU*HQHUDOO\DGPLQLVWUDWRUVVHWWLQJXSQHZ0\64/
VHUYHUVHQWHUVHTXHQWLDORUUDQGRPYDOXHVIRUWKLVÀHOG7KLVUHTXLUHVDOLVWRIVHUYHU,'V
DOUHDG\LVVXHGSUHIHUDEO\LQFOXGLQJWKHKRVWQDPH$VZLWKPRVWWKLQJVLQOLIHWKDWQHHGWREH
GRQHPDQXDOO\PDLQWDLQLQJWKLVOLVWLVOLNHO\WREHFRPHDEXUGHQDQGZLOOEHIRUJRWWHQ
,QVWHDG\RXFDQDVVLJQVHUYHU,'VEDVHGRQIHDWXUHVRIWKHLQGLYLGXDOPDFKLQHVWKDWDUH
XVXDOO\XQLTXHDOUHDG\IRUH[DPSOHWKHQHWZRUNLQWHUIDFH
V0$&DGGUHVVRUWKH,3DGGUHVV
ZKLFKVKRXOGUHPDLQUHDVRQDEO\À[HGIRUDQ\VHUYHUPDFKLQHDVZHOO
,3DGGUHVVHVDUHXVXDOO\VKRZQLQDGRWWHGQRWDWLRQRIIRXUQXPEHUVEHWZHHQDQG
%HFDXVH0\64/UHTXLUHVserver-idWREHVSHFLÀHGDVVLQJOHGHFLPDOYDOXH\RXQHHGWR
FRQYHUWLWÀUVW

&KDSWHU

+RZWRGRLW«

'HWHUPLQH\RXUVHUYHU
V,3DGGUHVV0DNHVXUHQRWWRXVHWKHORRSEDFNDGDSWHURUD
VLPLODUSVHXGRLQWHUIDFH,QWKLVH[DPSOHZHDVVXPHDQ,3DGGUHVVRI10.0.159.22

&RQYHUWWKHE\WHV
RIWKHDGGUHVVWRKH[DGHFLPDO0RVWO\DQ\FDOFXODWRUDSSOLFDWLRQFDQGRWKLVIRU\RX
<RXHQWHUHDFKRIWKHIRXUQXPEHUVLQGHFLPDOPRGHDQGWKHQVZLWFKWRKH[DGHFLPDO
PRGH-XVWUHSODFHHDFKLQGLYLGXDOGHFLPDOYDOXHZLWKLWVKH[DGHFLPDOFRXQWHUSDUW
)RUWKHDGGUHVVDERYH\RXZLOOFRPHXSZLWK0a.00.9f.16
$SSHQGWKHE\WHVWKDWLVMXVWUHPRYHWKHGRWVEHWZHHQWKHPDQGFRQYHUWWKHPEDFNWR
GHFLPDOE\VZLWFKLQJPRGHV0a009f16HEX=167812886DEC

,QVHUWWKDWÀQDOYDOXHDVWKHVHUYHU,'LQWKH>P\VTOG@VHFWLRQRIWKDWVHUYHU
V
FRQÀJXUDWLRQÀOH
   [mysqld]
   server-id=167812886
+RZLWZRUNV
7KH,3DGGUHVVVHUYHVWRXQLTXHO\LGHQWLI\DQHWZRUNLQWHUIDFHDQGWKHUHIRUHDPDFKLQH
RQDQHWZRUN:HOHYHUDJHWKLVXQLTXHQHVVE\UHF\FOLQJWKH,3DGGUHVVDVWKHVHUYHU,'
0RVWRSHUDWLQJV\VWHPVZLOOLVVXHDZDUQLQJZKHQDQ,3DGGUHVVFRQÁLFWLVGHWHFWHGVRWKLV
LQGLUHFWO\SRLQWVWRDUHSOLFDWLRQSUREOHPDVZHOO
2IFRXUVHWUDGLWLRQDO,3YDGGUHVVHVWKRVHXVXDOO\QRWHGLQWKH
DERYHQRWDWLRQDUHRQO\XQLTXHLQWKHLUUHVSHFWLYHVXEQHW7KDW
PHDQV\RXVKRXOGQRWUHO\RQWKLVUHFLSHDORQHIRU\RXUVHUYHU,'V
LIPDVWHUDQGVODYHPDFKLQHVDUHORFDWHGLQGLIIHUHQWORFDWLRQV
IURPDQHWZRUNWRSRORJ\SRLQWRIYLHZ
7KHUH
VPRUH
7KH,3DGGUHVVLVRQO\RQHSRVVLEOHXQLTXHYDOXH\RXFDQXVH$Q\WKLQJWKDW\RXFDQÀWLQ
WKHYDOLGQXPHULFUDQJHRIWKHserver-idVHWWLQJFDQEHXVHG,GHDOO\WKDWYDOXHVKRXOG
QHYHUFKDQJHRYHUWKHOLIHWLPHRIDVHUYHUPXFKOLNHDJRRG3ULPDU\NH\MXVWQRWIRUDVLQJOH
GDWDEDVHUHFRUGEXWWKHVHUYHUDVDZKROH
<RXFRXOGXVHDQ\VRUWRIVHULDOQXPEHU\RXUKDUGZDUHYHQGRUDOUHDG\DVVLJQVWRWKHPDFKLQH
LILWLVSXUHO\QXPHULFDQGÀWVWKHYDOLGUDQJHRIE\WHV+RZHYHUWKLVWLHV\RXWRWKHYHQGRU
V
LGHDRIXQLTXHQHVVZKLFK\RXFDQQRWYHULI\UHOLDEO\$OWHUQDWLYHO\WKHODVWE\WHVRIWKH
VHUYHU
V0$&DGGUHVVWKRVHDUHE\WHVORQJVWDUWLQJZLWKDYHQGRUVSHFLÀFSUHÀ[FRXOGEH
XVHGDVZHOO+RZHYHUEHZDUHWKDWXQOHVV\RXH[FOXVLYHO\XVHQHWZRUNDGDSWHUFKLSVHWVIURP
DVLQJOHYHQGRUWKHUHUHPDLQVDFHUWDLQGDQJHURIGXSOLFDWHV

5HSOLFDWLRQ

5HFRJQL]LQJV\PSWRPVRIGXSOLFDWHVHUYHU,'V
'HVSLWHDOOFDUHHUURUVFDQKDSSHQDQGGXSOLFDWHserver-idVFDQEHLVVXHG8QIRUWXQDWHO\
0\64/ZLOOQRWWHOO\RXH[SOLFLWO\ZKHQ\RXKDYHQRQXQLTXHserver-idVLQ\RXUUHSOLFDWLRQ
VHWXS:KLOHRQWKHPDVWHU\RXZLOOQRWVHHDQ\HYLGHQFHLQWKHORJÀOHVWKDWVRPHWKLQJLV
ZURQJVODYHVZLOOVKRZVWUDQJHEHKDYLRUDQGLVVXHVHHPLQJO\XQUHODWHGHUURUPHVVDJHVWR
WKHLUORJÀOHVLQVKRUWVXFFHVVLRQ
2IFRXUVHWKHQDPHVRIPDFKLQHVORJÀOHVDQGSRVLWLRQVZLOOYDU\EXWWKHPHVVDJHRIDQ
DVVXPHGVKXWGRZQRIWKHPDVWHUIROORZHGE\LPPHGLDWHUHWULHVDQGIDLOLQJDJDLQLVDFOHDU
LQGLFDWLRQRIDSUREOHPZLWKUHSOLFDWLRQserver-idV
6HWWLQJXSVODYHVWRUHSRUWFXVWRP
LQIRUPDWLRQDERXWWKHPVHOYHVWRWKHPDVWHU
:KHQ\RXLVVXHDSHOWSLAVEHOSTSFRPPDQGRQDUHSOLFDWLRQPDVWHUVHUYHU\RXZLOOJHWD
OLVWRIVODYHVFRQQHFWHGSURYLGHGWKDWWKH\DUHVHWXSFRUUHFWO\
8QIRUWXQDWHO\E\GHIDXOWWKH\DUHQRWVRXQOHVV\RXVSHFLÀFDOO\FRQÀJXUHWKHPWRGRVR
VODYHVZLOOQRWUHJLVWHUWKHPVHOYHVZLWKWKHPDVWHU,QDGHIDXOWVHWXS\RXPLJKWQRWVHH
DQ\VODYHLQWKHRXWSXWRIWKHDERYHFRPPDQGRULQWKH5HSOLFDWLRQ6WDWXVSDQHLQ0\64/
$GPLQLVWUDWRUDWDOOHYHQWKRXJKWKHUHPLJKWEHVHYHUDOFRQÀJXUHGDJDLQVWWKLVPDVWHU
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRFRQÀJXUHDVODYHWRWHOOLWVPDVWHUVRPHGHWDLOVWKDW
PLJKWFRPHLQKDQG\ZKHQWURXEOHVKRRWLQJ
3OHDVHQRWHWKDWGXHWRDEXJLQ0\64/WKHRXWSXWRIWKH6+2:6/$9(+2676
FRPPDQGLVQRWDOZD\VUHOLDEOH6RPHWLPHVLWZLOOUHSRUWKRVWVEHLQJDYDLODEOH
ZKHQLQIDFWWKH\DUHFXUUHQWO\QRW7KHRQO\ZD\WKDWVHHPVWRÀ[DQHUURQHRXV
GLVSOD\LVWRVWRSDQGVWDUWWKHPDVWHUVHUYHU
7KLVHIIHFWLYHO\PDNHVWKLVIHDWXUHXQVXLWDEOHIRUWKHSXUSRVHRIWKHDFWXDO
FXUUHQWKHDOWKRIWKHVODYHV,WQHYHUWKHOHVVSURYLGHVDZD\WRJDWKHUVRPH
LQYHQWRU\LQIRUPDWLRQRQWKHLUORFDWLRQDQGVRPHRWKHUGHWDLOVGHVFULEHGEHORZ
7KHEXJUHSRUWLVWUDFNHGDW
http://bugs.mysql.com/bug.php?id=13963.

&KDSWHU

*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGVXIÀFLHQWRSHUDWLQJV\VWHPSULYLOHJHVWRPRGLI\WKHVODYH
V
FRQÀJXUDWLRQÀOHmy.cnfRUmy.iniGHSHQGLQJRQ\RXURSHUDWLRQV\VWHP7RDFWXDOO\VHH
WKDWVWDWXVRQWKHPDVWHU\RXZLOOQHHGD0\64/XVHUWKHUHDVZHOO
+RZWRGRLW

6KXWGRZQWKHVODYH

2SHQLWVFRQÀJXUDWLRQÀOHLQDWH[WHGLWRU

0DNHVXUHWKHIROORZLQJOLQHLVSUHVHQWLQWKH[mysqld]VHFWLRQ
report-host=slave_1701.example.com

6DYHWKHFRQÀJXUDWLRQ

5HVWDUWWKHVODYH

2QWKHPDVWHULVVXHWKLVFRPPDQGWRYHULI\\RXUFKDQJHZDVVXFFHVVIXO
mysql> show slave hosts \G
<RXPLJKWRIFRXUVHVHHPDQ\PRUHVODYHVKHUHGHSHQGLQJRQKRZWKH\DUHFRQÀJXUHG
6KRXOG\RXDVN\RXUVHOIZKDWWKHRpl_recovery_rank
OLQHLQWKHRXWSXWPHDQV\RXPD\VLPSO\LJQRUHLW,W
VHHPVLWZDVLQWURGXFHGVRPH\HDUVDJREXWQHYHUSXWWR
DFWLYHXVH
+RZLWZRUNV
8VXDOO\VODYHVGRQRWUHSRUWDQ\GHWDLOVDERXWWKHPVHOYHVZKHQWKH\FRQQHFWWRWKHPDVWHU
%\DGGLQJVRPHRSWLRQVLQWKHLUFRQÀJXUDWLRQ\RXFDQKRZHYHUPDNHWKHPDQQRXQFHGHWDLOV
DERXWWKHPVHOYHV

5HSOLFDWLRQ

:HVWURQJO\UHFRPPHQGVHWWLQJXSDOO\RXUVODYHVWRUHJLVWHUZLWKWKHPDVWHUHVSHFLDOO\
ZKHQ\RXDUHGHDOLQJZLWKPDQ\PDVWHUVDQGVODYHV7KLVFDQEHYHU\KHOSIXOWRNHHSRQ
WRSRIWKLQJV
0\64/$GPLQLVWUDWRUDOORZV\RXWRUHPHPEHUDOOVODYHVLWKDVVHHQRQFHDQGGLVSOD\D
ZDUQLQJRQLWV5HSOLFDWLRQ6WDWXVSDQHZKHQDPDFKLQHSUHYLRXVO\NQRZQGRHVQRWUHJLVWHU
ODWHU7KLVSDUWLFXODUSLHFHRILQIRUPDWLRQLVQRWUHOLDEOHKRZHYHUVHHWKHZDUQLQJLQWKLV
UHFLSH
VLQWURGXFWLRQIRUPRUHLQIRUPDWLRQ
7KHUH
VPRUH
7KHJHQHUDOLGHDEHKLQGWKHreport-hostVHWWLQJLVWRJLYHDQLGHDDERXWKRZWRUHDFKWKH
VODYHPDFKLQHYLDWKHQHWZRUN$VWKHVODYHPLJKWEHORFDWHGEHKLQGVRPHVRUWRIÀUHZDOORU
1$7URXWHULWV,3DGGUHVVPLJKWQRWEHYHU\KHOSIXO6RLQJHQHUDOLWFDQEHKHOSIXOWRKDYH
WKHVODYHUHSRUWDIXOO\TXDOLÀHGGRPDLQQDPHWKDWFDQEHXVHGWRUHDFKLWLIDSSOLFDEOH
+RZHYHULWLVE\QRPHDQVPDQGDWRU\WRGRVR,I\RXGRQRWLQWHQGWRDFFHVVWKHVODYH
UHPRWHO\\RXPLJKWMXVWHQWHUDQ\RWKHUSLHFHRILQIRUPDWLRQ\RXOLNHWRVHHLQWKHRXWSXWRI
WKHFRPPDQGPHQWLRQHGLQWKLVUHFLSHRUWKH0\64/$GPLQLVWUDWRUSDQH$V\RXFDQVHHLQ
WKHSUHYLRXVVFUHHQVKRW,VHWXSWKHVODYHVWRUHSRUWEDFNDQDPHVXIÀ[HGZLWKWKHVHUYHU,'
YDOXH'RLQJVRZRUNVDURXQGDEXJLQ0\64/$GPLQLVWUDWRUWKDWNQRZVKRZWRUHPHPEHU
VODYHVLWKDVVHHQEHIRUHEXWVRPHWLPHVIRUJHWVWKHLUserver-id
6KRZLQJVODYHVFXUUHQWO\XQDYDLODEOHLVDIHDWXUHRI0\64/$GPLQLVWUDWRUWKHSHOWSLAVE 
HOSTSFRPPDQGZLOOQRWPHQWLRQWKHPDWDOO7ROHYHUDJHWKLV\RXPXVWFOLFNWKH$GG+RVWWR
0RQLWRULQJ/LVWEXWWRQIRUHDFKVODYHRQFHLWLVFRQQHFWHG2WKHUZLVHWKH\ZLOOQRWDSSHDUDW
DOOZKHQWKH\DUHQRWFRQQHFWHG

&KDSWHU

$SDUWIURPWKHreport-hostFRQÀJXUDWLRQVHWWLQJWKHUHDUHWKUHHPRUHRSWLRQV\RXVKRXOG
NQRZDERXW
6HWWLQJ
'HVFULSWLRQ
UHSRUWSRUW
,QIRUPVDERXWWKHSRUWWKDWPXVWEHXVHGWRUHDFKWKHVODYHRQWKH
GRPDLQQDPHUHSRUWHGE\UHSRUWKRVW7KLVFDQEHVHQVLEOHLISRUW
IRUZDUGLQJKDVEHHQVHWXS
UHSRUWXVHU
5HSRUWDXVHUQDPHWKDWFDQEHXVHGWRFRQQHFWWRWKHVODYH1RW
UHFRPPHQGHGWRXVH
UHSRUWSDVVZRUG
5HSRUWDSDVVZRUGWKDWFDQEHXVHGWRFRQQHFWWRWKHVODYH1RW
UHFRPPHQGHGWRXVH
)RUFRPSOHWHQHVVWKLVLVZKDWWKHRXWSXWRISHOWSLAVEHOSTSZLOOORRNOLNHLI\RXJRDJDLQVW
RXUDGYLFHDQGFRQÀJXUHWKHVODYHWRUHSRUWDVHWRIORJLQFUHGHQWLDOVDQGWKHPDVWHUKDV
EHHQVWDUWHGZLWKWKHshow-slave-auth-infoRSWLRQ
:KLOHWKHreport-portVHWWLQJPLJKWEHXVHIXOZHVWURQJO\VXJJHVWWR
UHIUDLQIURPXVLQJWKHreport-userDQGreport-passwordRSWLRQVIRU
VHFXULW\UHDVRQV
(YHQWKRXJKWKHPDVWHUVHUYHUZLOORQO\GLVSOD\WKHVHYDOXHVZKHQLWLV
VWDUWHGZLWKWKHshow-slave-auth-infoRSWLRQLWLVVWLOOYHU\ULVN\WR
VHQGORJLQFUHGHQWLDOVRYHUWKHQHWZRUNLQWKLVPDQQHU<RXVKRXOGDOZD\V
XVHPRUHVHFXUHZD\VWRH[FKDQJHORJLQLQIRUPDWLRQ



,QGH[LQJ
,QWKLVFKDSWHUZHZLOOFRYHU
f
$GGLQJLQGH[HVWRWDEOHV
f
$GGLQJDIXOOWH[WLQGH[
f
&UHDWLQJDQRUPDOL]HGWH[WVHDUFKFROXPQ
f
5HPRYLQJLQGH[HVIURPWDEOHV
f
(VWLPDWLQJ,QQR'%LQGH[VSDFHUHTXLUHPHQWV
f
8VLQJSUHÀ[SULPDU\NH\V
f
&KRRVLQJ,QQR'%SULPDU\NH\FROXPQV
f
6SHHGLQJXSVHDUFKHVIRUVXEGRPDLQV
f
)LQGLQJGXSOLFDWHLQGH[HV
,QWURGXFWLRQ
2QHRIWKHPRVWLPSRUWDQWIHDWXUHVRIUHODWLRQDOGDWDEDVHPDQDJHPHQWV\VWHPV³0\64/
EHLQJQRH[FHSWLRQ³LVWKHXVHRILQGH[HVWRDOORZUDSLGDQGHIÀFLHQWDFFHVVWRWKHHQRUPRXV
DPRXQWVRIGDWDWKH\NHHSVDIHIRUXV,QWKLVFKDSWHUZHZLOOSURYLGHVRPHXVHIXOUHFLSHVIRU
\RXWRJHWWKHPRVWRXWRI\RXUGDWDEDVHV

,QGH[LQJ

,QÀQLWHVWRUDJHLQÀQLWHH[SHFWDWLRQV
:HKDYHJRWDFFXVWRPHGWRQHDUO\LQÀQLWHVWRUDJHVSDFHDWRXUGLVSRVDO³VWRULQJHYHU\WKLQJ
IURPPXVLFWRPRYLHVWRKLJKUHVROXWLRQPHGLFDOLPDJHU\GHWDLOHGJHRJUDSKLFDOLQIRUPDWLRQ
RUMXVWSODLQROGEXVLQHVVGDWD:KLOHZHWDNHLWIRUJUDQWHGWKDWZHKDUGO\HYHUUXQRXWRI
VSDFHZHDOVRH[SHFWWREHDEOHWRORFDWHDQGUHWULHYHHYHU\ELWRILQIRUPDWLRQZHVDYHLQDQ
LQVWDQW7KHUHDUHH[DPSOHVHYHU\ZKHUHLQRXUOLYHV³EXVLQHVVDQGSHUVRQDO
f
<RXUSRFNHWPXVLFSOD\HU
VOLEUDU\FDQHDVLO\FRQWDLQWHQVRIWKRXVDQGVRIVRQJVDQG
\HWFDQEHEURZVHGHIIRUWOHVVO\E\DUWLVWQDPHRUDOEXPWLWOHRUVKRZ\RXODVWZHHN
V
WRSURFNVRQJV
f
6HDUFKHQJLQHVSURYLGHWKRXVDQGVRIUHVXOWVLQPLOOLVHFRQGVIRUDQ\DUELWUDU\VHDUFK
WHUPRUFRPELQDWLRQ
f
$OLQHRIEXVLQHVVDSSOLFDWLRQFDQUHQGHU\RXUVDOHVQXPEHUVFKDUWHGDQGGLVSOD\HG
RQDPDSJURXSHGE\VDOHVGLVWULFWLQUHDOWLPH
7KHVHDUHDIHZVLPSOHH[DPSOHV\HWIRUHDFKRIWKHPKXJHDPRXQWVRIGDWDPXVWEH
FRPEHGWRTXLFNO\SURYLGHMXVWWKHULJKWVXEVHWWRVDWLVI\HDFKUHTXHVW(YHQZLWKWKH
LPPHQVHVSHHGRIPRGHUQKDUGZDUHWKLVLVQRWDWULYLDOWDVNWRGRDQGUHTXLUHVVRPH
FOHYHUWHFKQLTXHV
6SHHGE\UHGXQGDQF\
,QGH[HVDUHEDVHGRQWKHSULQFLSOHWKDWVHDUFKLQJLQVRUWHGGDWDVHWVLVZD\IDVWHUWKDQ
VHDUFKLQJLQXQVRUWHGFROOHFWLRQVRIUHFRUGV6RZKHQ0\64/LVWROGWRFUHDWHDQLQGH[RQRQH
RUPRUHFROXPQVLWFRSLHVWKHVHFROXPQV
FRQWHQWVDQGVWRUHVWKHPLQDVRUWHGPDQQHU7KH
UHPDLQLQJFROXPQVDUHUHSODFHGE\DUHIHUHQFHWRWKHRULJLQDOWDEOHZLWKWKHXQVRUWHGGDWD
7KLVFRPELQHVWZREHQHÀWV³SURYLGLQJIDVWUHWULHYDOZKLOHPDLQWDLQLQJUHDVRQDEO\HIÀFLHQW
VWRUDJHUHTXLUHPHQWV6RZLWKRXWZDVWLQJWRRPXFKVSDFHWKLVDSSURDFKHQDEOHV\RXWR
FUHDWHVHYHUDORIWKRVHLQGH[HVRULQGLFHVERWKDUHFRUUHFWDWDUHODWLYHO\ORZFRVW
+RZHYHUWKHUHLVDGUDZEDFNWRWKLVDVZHOOZKLOHUHDGLQJGDWDLQGH[HVDOORZIRULPPHQVH
VSHHGVHVSHFLDOO\LQODUJHGDWDEDVHVKRZHYHUWKH\GRVORZGRZQZULWLQJRSHUDWLRQV,QWKH
FRXUVHRI,16(57V83'$7(VDQG'(/(7(VDOOLQGH[HVQHHGWREHXSGDWHGLQDGGLWLRQWR
WKHGDWDWDEOHLWVHOI7KLVFDQSODFHVLJQLÀFDQWDGGLWLRQDOORDGRQWKHVHUYHUVORZLQJGRZQ
DOORSHUDWLRQV
)RUWKLVUHDVRQNHHSLQJWKHQXPEHURILQGH[HVDVORZDVSRVVLEOHLVSDUDPRXQWHVSHFLDOO\IRU
WKHODUJHVWWDEOHVZKHUHWKH\DUHPRVWLPSRUWDQW,QWKLVFKDSWHU\RX
OOÀQGVRPHUHFLSHVWKDW
ZLOOKHOS\RXWRGHFLGHKRZWRGHÀQHLQGH[HVDQGVKRZ\RXVRPHSLWIDOOVWRDYRLG
6WRUDJHHQJLQHGLIIHUHQFHV
:HZLOOQRWJRLQWRPXFKGHWDLOKHUHDERXWWKHGLIIHUHQFHVEHWZHHQWKH0\,6$0DQGWKH
,QQR'%VWRUDJHHQJLQHVRIIHUHGE\0\64/+RZHYHUUHJDUGLQJLQGH[HVWKHUHDUHVRPHLP
SRUWDQWGLIIHUHQFHVWRNQRZEHWZHHQ0\64/
VWZRPRVWLPSRUWDQWVWRUDJHHQJLQHV7KH\
LQÁXHQFHVRPHGHFLVLRQV\RXZLOOKDYHWRPDNH

&KDSWHU

0\,6$0
,QWKHÀJXUHEHORZ\RXFDQVHHDVLPSOLÀHGVFKHPDRIKRZLQGH[HVZRUNZLWKWKH0\,6$0
VWRUDJHHQJLQH7KHLUPRVWLPSRUWDQWSURSHUW\FDQEHVXPPHGXSDVDOOLQGH[HVDUHFUHDWHG
HTXDO7KLVPHDQVWKDWWKHUHLVQRWHFKQLFDOGLIIHUHQFHEHWZHHQWKHSULPDU\DQG
VHFRQGDU\NH\V
Index1
(PrimaryKey)
orderedby
ISBNcolumn
Index2
(IDX_TITLE)
orderedby
titlecolumn
numberofrowinthe
dataarea
numberofrowinthe
dataarea
...
...
8-456-7
(3)
7-234-5
(1)
(2)
2-345-6
rowpointer
isbn
...
...
MobyDick
(1)
EffectiveJava
(2)
(3)
Concurrency...
rowpointer
title
Index3
(IDX_AUTHOR)
orderedby
authorcolumn
numberofrowinthe
dataarea
...
...
Melville
(1)
Goetz
(3)
(2)
Bloch
rowpointer
author
BOOKS
(DataTable)
Random order
(order of insertion)
author
Bloch
...
Melville
Goetz
title
EffectiveJava
8-456-7
7-234-5
...
...
isbn
MobyDick
Concurrency...
2-345-6
Rowpointersfromeachindex'sentriespointto
theactualdatarecord.Themoreindexesare
defined,themoreexpensiveINSERT,UPDATE
andDELETEbecome,becauseinadditionto
theactualdatatable,alltheindexesneedto
beamendedwiththenewentriesandtheir
rowpointers.
Findinganauthorthrough
IDX_AUTHORisquick,becauseit
issortedbytheperson'sname.
Thebookdetailsarethenfound
withasecondstep,followingthe
rowpointertothecorrectdata
record.
MyISAMIndexingSchematics
7KHGLDJUDPVKRZVDVLQJOHWKHRUHWLFDOGDWDWDEOHFDOOHGERRNV,WKDVWKUHHFROXPQV
QDPHGLVEQWLWOHDQGDXWKRU7KLVLVDYHU\VLPSOHVFKHPDEXWLWLVVXIÀFLHQWIRUH[SODQDWLRQ
SXUSRVHV7KHH[DFWGHÀQLWLRQFDQEHIRXQGLQWKH$GGLQJLQGH[HVWRWDEOHVUHFLSHLQWKLV
FKDSWHU)RUQRZLWLVQRWLPSRUWDQW
0\,6$0WDEOHVVWRUHLQIRUPDWLRQLQWKHRUGHULWLVLQVHUWHG,QWKHH[DPSOHWKHUHDUHWKUHH
UHFRUGVUHSUHVHQWLQJDVLQJOHERRNHDFK7KH,6%1QXPEHULVGHFODUHGDVWKHSULPDU\NH\IRU
WKLVWDEOH$V\RXFDQVHHWKHUHFRUGVDUHQRWRUGHUHGLQWKHWDEOHLWVHOI³WKH,6%1QXPEHUV
DUHRXWRIZKDWZRXOGEHWKHLUOH[LFDORUGHU/HW
VDVVXPHWKH\KDYHEHHQLQVHUWHGE\VRPHRQH
LQWKLVRUGHU

,QGH[LQJ

1RZKDYHDORRNDWWKHÀUVWLQGH[³WKH35,0$5<.(<7KHLQGH[LVVRUWHGE\WKHLVEQFROXPQ
$VVRFLDWHGZLWKHDFKLQGH[HQWU\LVDURZSRLQWHUWKDWOHDGVWRWKHDFWXDOGDWDUHFRUGLQWKH
ERRNVWDEOH:KHQORRNLQJXSDVSHFLÀF,6%1QXPEHULQWKHSULPDU\NH\LQGH[WKHGDWDEDVH
VHUYHUIROORZVWKHURZSRLQWHUWRUHWULHYHWKHUHPDLQLQJGDWDÀHOGV7KHVDPHKROGVWUXHIRU
WKHRWKHUWZRLQGH[HV,';B7,7/(DQG,';B$87+25ZKLFKDUHVRUWHGE\WKHUHVSHFWLYHÀHOGV
DQGDOVRFRQWDLQDURZSRLQWHUHDFK
/RRNLQJXSDERRN
VGHWDLOVE\DQ\RQHRIWKHWKUHHSRVVLEOHVHDUFKFULWHULDLVDWZRSDUW
RSHUDWLRQÀUVWÀQGWKHLQGH[UHFRUGDQGWKHQIROORZWKHURZSRLQWHUWRJHWWKHUHVWRIWKHGDWD
:LWKWKLVWHFKQLTXH\RXFDQLQVHUWGDWDYHU\TXLFNO\EHFDXVHWKHDFWXDOGDWDUHFRUGVDUH
VLPSO\DSSHQGHGWRWKHWDEOH2QO\WKHUHODWLYHO\VPDOOLQGH[UHFRUGVQHHGWREHNHSWLQRUGHU
PHDQLQJPXFKOHVVGDWDKDVWREHVKXIÁHGDURXQGRQWKHGLVN
7KHUHDUHGUDZEDFNVWRWKLVDSSURDFKDVZHOO(YHQLQFDVHVZKHUH\RXRQO\HYHUZDQWWRORRN
XSGDWDE\DVLQJOHVHDUFKFROXPQWKHUHZLOOEHWZRDFFHVVHVWRWKHVWRUDJHVXEV\VWHP³RQH
IRUWKHLQGH[DQRWKHUIRUWKHGDWD
,QQR'%
+RZHYHU,QQR'%LVGLIIHUHQW,WVLQGH[V\VWHPLVDOLWWOHPRUHFRPSOLFDWHGEXWLWKDV
VRPHDGYDQWDJHV
SecondaryIndex
(IDX_TITLE)
orderedby
titlecolumn
copyofprimary
keyvalueserves
asrowpointer
...
...
MobyDick
(7-234-5)
EffectiveJava
(2-345-6)
(8-456-7)
Concurrency...
isbn
title
SecondaryIndex
(IDX_AUTHOR)
orderedby
authorcolumn
copyofprimary
keyvalueserves
asrowpointer
...
...
Melville
(7-234-5)
Goetz
(8-456-7)
(2-345-6)
Bloch
isbn
author
BOOKS
(DataTable&PrimaryKey)
Ordered by Primary
Key
author
Bloch
Melville
...
Goetz
...
...
8-456-7
Concurrency...
7-234-5
MobyDick
EffectiveJava
2-345-6
title
isbn
Whenqueryingfortitleandisbn
only,thequerycanbefulfilledby
lookingattheIDX_TITLEindex
alone,becausetheother
requestedvalue-theisbn-is
containedinit.Nosecond
accesstothedataareais
required.Thisisgreatforspeed!
Thesecondaryindexesuseacopy
oftheprimarykeyvalue(isbn)from
thedataareaasarowpointer.
InnoDBdoesthisautomatically.
Thelongertheprimarykey,the
morespaceandresourcesthe
secondaryoneswillrequire,asthey
containacopyofalltheprimarykey
values.
uniqueisbn
valuesareused
asprimarykeys
InnoDBtablesarealwaysstoredinprimarykeyorder.
Theprimarykeyiscalleda"clustered"index,itis
clusteredtogetherwiththerestofthedata-no
pointersinbetween.
Ifthereisnoexplicitprimarykeydefined,InnoDBwill
createahiddennumericcolumnforthatpurpose.
Insertsoutofkeyorderaremoreexpensivein
InnoDB,becausewholerecordsneedtobe
rearrangedondiskwhenvaluesneedtobe
putbetweentwoexistingrows.
InnoDBIndexingSchematics

&KDSWHU

3ULPDU\FOXVWHUHGLQGH[HV
:KHUHDVLQ0\,6$0DOOLQGH[HVDUHVWUXFWXUHGLGHQWLFDOO\,QQR'%PDNHVDGLVWLQFWLRQEHWZHHQ
WKHSULPDU\NH\DQGDGGLWLRQDOVHFRQGDU\RQHV
7KHSULPDU\LQGH[LQ,QQR'%LVDFOXVWHUHGLQGH[7KLVPHDQVWKDWRQHRUPRUHFROXPQV
RIHDFKUHFRUGPDNHXSDXQLTXHNH\WKDWLGHQWLÀHVWKLVH[DFWUHFRUG,QFRQWUDVWWRRWKHU
LQGH[HVDFOXVWHUHGLQGH[
VPDLQSURSHUW\LVWKDWLWLWVHOILVSDUWRIWKHGDWDLQVWHDGRIEHLQJ
VWRUHGLQDGLIIHUHQWORFDWLRQ%RWKGDWDDQGLQGH[DUHFOXVWHUHGWRJHWKHU
$QLQGH[LVRQO\VHUYLQJLWVSXUSRVHLILWLVVWRUHGLQDVRUWHGIDVKLRQ$VDUHVXOWZKHQHYHU\RX
LQVHUWGDWDRUPRGLI\WKHNH\FROXPQVLWQHHGVWREHSXWLQWKHFRUUHFWORFDWLRQDFFRUGLQJWR
WKHVRUWRUGHU)RUDFOXVWHUHGLQGH[WKHZKROHUHFRUGZLWKDOOLWVGDWDKDVWREHUHORFDWHG
7KDWLVZK\EXONGDWDLQVHUWLRQLQWR,QQR'%WDEOHVLVEHVWSHUIRUPHGLQFRUUHFWSULPDU\NH\
RUGHUWRPLQLPL]HWKHDPRXQWRIGLVN,2QHHGHGWRNHHSWKHUHFRUGVLQLQGH[RUGHU0RUHRYHU
WKHFOXVWHUHGLQGH[VKRXOGEHGHÀQHGVRWKDWLWLVKDUGO\HYHUFKDQJHGIRUH[LVWLQJURZVDV
WKDWWRRZRXOGPHDQUHORFDWLQJIXOOUHFRUGVWRGLIIHUHQWVHFWRUVRQWKHGLVN
2IFRXUVHWKHUHDUHVLJQLÀFDQWDGYDQWDJHVWRWKLVDSSURDFK2QHRIWKHPRVWLPSRUWDQW
DVSHFWVRIDFOXVWHUHGNH\LVWKDWLWDFWXDOO\LVDSDUWRIWKHGDWD7KLVPHDQVWKDWZKHQ
DFFHVVLQJGDWDWKURXJKDSULPDU\NH\ORRNXSWKHUHLVQRQHHGIRUDWZRSDUWRSHUDWLRQDV
ZLWK0\,6$0LQGH[HV7KHORFDWLRQRIWKHLQGH[LVDWWKHVDPHWLPHWKHORFDWLRQRIWKHGDWD
LWVHOI³WKHUHLVQRQHHGIRUIROORZLQJDURZSRLQWHUWRJHWWKHUHVWRIWKHFROXPQGDWDVDYLQJ
DQH[SHQVLYHGLVNDFFHVV
/RRNLQJXSDERRNE\,6%1LQRXUH[DPSOHWDEOHVLPSO\PHDQVORFDWLQJLWTXLFNO\DVLWLV
VWRUHGLQRUGHUDQGWKHQUHDGLQJWKHFRPSOHWHUHFRUGLQRQHJR
6HFRQGDU\LQGH[HV
&RQVLGHULI\RXZHUHWRVHDUFKIRUDERRNE\WLWOHWRÀQGRXWWKH,6%1QXPEHU$QLQGH[RQ
WKHQDPHFROXPQLVUHTXLUHGWRSUHYHQWWKHGDWDEDVHIURPVFDQQLQJWKURXJKWKHZKROH
,6%1VRUWHGWDEOH,QFRQWUDVWWR0\,6$0WKH,QQR'%VWRUDJHHQJLQHFUHDWHVVHFRQGDU\
LQGH[HVGLIIHUHQWO\
,QVWHDGRIUHFRUGSRLQWHUVLWXVHVDFRS\RIWKHZKROHSULPDU\NH\IRUHDFKUHFRUGWRHVWDEOLVK
WKHFRQQHFWLRQWRWKHDFWXDOGDWDFRQWHQWV
,QWKHSUHYLRXVÀJXUHKDYHDORRNDWWKH,';B7,7/(LQGH[,QVWHDGRIDVLPSOHSRLQWHUWRWKH
FRUUHVSRQGLQJUHFRUGLQWKHGDWDWDEOH\RXFDQVHHWKH,6%1QXPEHUGXSOLFDWHGDVZHOO7KLV
LVEHFDXVHWKHLVEQFROXPQLVWKHSULPDU\NH\RIWKHERRNVWDEOH7KHVDPHJRHVIRUWKHRWKHU
LQGH[HVLQWKHÀJXUH³WKH\DOOFRQWDLQWKHERRN,6%1QXPEHUDVZHOO<RXGRQRWQHHGWRDQG
VKRXOGQRWVSHFLI\WKLV\RXUVHOIZKHQFUHDWLQJDQGLQGH[LQJRQ,QQR'%WDEOHVLWDOOKDSSHQV
DXWRPDWLFDOO\XQGHUWKHFRYHUV

,QGH[LQJ

/RRNXSVE\VHFRQGDU\LQGH[DUHVLPLODUWR0\,6$0LQGH[ORRNXSV,QWKHÀUVWVWHSWKHLQGH[
UHFRUGWKDWPDWFKHV\RXUVHDUFKWHUPLVORFDWHG7KHQVHFRQGO\WKHUHPDLQLQJGDWDLV
UHWULHYHGIURPWKHGDWDWDEOHE\PHDQVRIDQRWKHUDFFHVV³WKLVWLPHE\SULPDU\NH\
$V\RXPLJKWKDYHÀJXUHGWKHVHFRQGDFFHVVLVRSWLRQDOGHSHQGLQJRQZKDWLQIRUPDWLRQ\RX
UHTXHVWLQ\RXUTXHU\&RQVLGHUDTXHU\ORRNLQJIRUWKH,6%1QXPEHUVRIDOONQRZQLVVXHVRI
0RE\'LFN
SELECT isbn FROM books WHERE title LIKE 'Moby Dick%';
,VVXHGDJDLQVWDSUHVXPDEO\ODUJHOLEUDU\GDWDEDVHLWZLOOPRVWFHUWDLQO\UHVXOWLQDQLQGH[
ORRNXSRQWKH,';B7,7/(NH\2QFHWKHLQGH[UHFRUGVDUHIRXQGWKHUHLVQRQHHGIRUDQRWKHU
ORRNXSWRWKHDFWXDOGDWDSDJHVRQGLVNEHFDXVHWKH,6%1QXPEHULVDOUHDG\SUHVHQWLQWKH
LQGH[(YHQWKRXJK\RXFDQQRWVHHWKHFROXPQLQWKHLQGH[GHÀQLWLRQ0\64/ZLOOVNLSWKH
VHFRQGVHHNVDYLQJYDOXDEOH,2RSHUDWLRQV
%XWWKHUHLVDGUDZEDFNWRWKLVDVZHOO0\,6$0
VURZSRLQWHUVDUHFRPSDUDWLYHO\VPDOO7KH
SULPDU\NH\RIDQ,QQR'%WDEOHFDQEHPXFKELJJHU³WKHORQJHUWKHNH\WKHPRUHWKHGDWD
WKDWLVVWRUHGUHGXQGDQWO\
,QWKHHQGLWFDQRIWHQEHTXLWHGLIÀFXOWWRGHFLGHRQWKHRSWLPDOEDODQFHEHWZHHQLQFUHDVHG
VSDFHUHTXLUHPHQWVDQGPDLQWHQDQFHFRVWVRQLQGH[XSGDWHV%XWGRQRWZRUU\ZHDUHJRLQJ
WRSURYLGHKHOSRQWKDWLQWKLVFKDSWHUDVZHOO
*HQHUDOUHTXLUHPHQWVIRUWKHUHFLSHVLQWKLVFKDSWHU
$OOWKHUHFLSHVLQWKLVFKDSWHUUHYROYHDURXQGFKDQJLQJWKHGDWDEDVHVFKHPD,QRUGHUWRDGG
LQGH[HVRUUHPRYHWKHP\RXZLOOQHHGDFFHVVWRDXVHUDFFRXQWWKDWKDVDQHIIHFWLYH,1'(;
SULYLOHJHRUWKH$/7(5SULYLOHJHRQWKHWDEOHV\RXDUHJRLQJWRPRGLI\
:KLOHWKH,1'(;SULYLOHJHDOORZVIRUXVHRIWKH&5($7(,1'(;FRPPDQG$/7(5LVUHTXLUHG
IRUWKH$/7(57$%/($'',1'(;V\QWD[7KH0\64/PDQXDOVWDWHVWKDWWKHIRUPHULVPDSSHG
WRWKHODWWHUDXWRPDWLFDOO\+RZHYHUDQLPSRUWDQWGLIIHUHQFHH[LVWV&5($7(,1'(;FDQRQO\
EHXVHGWRDGGDVLQJOHLQGH[DWDWLPHZKLOH$/7(57$%/($'',1'(;FDQEHXVHGWRDGG
PRUHWKDQRQHLQGH[WRDWDEOHLQDVLQJOHJR
7KLVLVHVSHFLDOO\UHOHYDQWIRU,QQR'%WDEOHVEHFDXVHXSWR0\64/YHUVLRQHYHU\FKDQJH
WRWKHGHÀQLWLRQRIDWDEOHLQWHUQDOO\SHUIRUPVDFRS\RIWKHZKROHWDEOH:KLOHIRUVPDOO
GDWDEDVHVWKLVPLJKWQRWEHRIDQ\FRQFHUQLWTXLFNO\EHFRPHVLQIHDVLEOHIRUODUJHWDEOHVGXH
WRWKHKLJKORDGFRS\LQJPD\SXWRQWKHVHUYHU:LWKPRUHUHFHQWYHUVLRQVWKLVPLJKWKDYH
FKDQJHGEXWPDNHVXUHWRFRQVXOW\RXUYHUVLRQ
VPDQXDO
,QWKHUHFLSHVWKURXJKRXWWKLVFKDSWHUZHZLOOFRQVLVWHQWO\XVHWKH$/7(57$%/($'',1'(;
V\QWD[WRPRGLI\WDEOHVDVVXPLQJ\RXKDYHWKHDSSURSULDWHSULYLOHJHV,I\RXGRQRW\RXZLOO
KDYHWRUHZULWHWKHVWDWHPHQWVWRXVHWKH&5($7(,1'(;V\QWD[

&KDSWHU

$GGLQJLQGH[HVWRWDEOHV
2YHUWLPHUHTXLUHPHQWVIRUDVRIWZDUHSURGXFWXVXDOO\FKDQJHDQGDIIHFWWKHXQGHUO\LQJ
GDWDEDVHDVZHOO2IWHQWKHQHHGIRUQHZW\SHVRITXHULHVDULVHVZKLFKPDNHVLWQHFHVVDU\WR
DGGRQHRUPRUHQHZLQGH[HVWRSHUIRUPWKHVHQHZTXHULHVIDVWHQRXJK
,QWKLVUHFLSHZHZLOODGGWZRQHZLQGH[HVWRDQH[LVWLQJWDEOHFDOOHGbooksLQWKHlibrary
VFKHPD2QHZLOOFRYHUWKHauthorFROXPQWKHRWKHUWKHtitleFROXPQ7KHVFKHPDDQG
WDEOHFDQEHFUHDWHGOLNHWKLV
  mysql> CREATE DATABASE library;
  mysql> USE library;
  mysql> CREATE TABLE books (
  isbn char(13) NOT NULL,
  author varchar(64) default NULL,
  title varchar(64) NOT NULL,
  PRIMARY KEY  (isbn)
) ENGINE=InnoDB;
*HWWLQJUHDG\
&RQQHFWWRWKHGDWDEDVHVHUYHUZLWK\RXUDGPLQLVWUDWLYHDFFRXQW
+RZWRGRLW

&KDQJHWKHGHIDXOWGDWDEDVHWROLEUDU\
USE library;

&UHDWHERWKLQGH[HVLQRQHJRXVLQJWKHIROORZLQJFRPPDQG
ALTER TABLE books ADD INDEX IDX_author(author), ADD INDEX IDX_
title(title); 
+RZLWZRUNV
7KHALTERWDEOHVWDWHPHQWVKRZQDERYHLVDOPRVWVHOIH[SODQDWRU\7KHbooksWDEOHLV
DOWHUHGWREHLQGH[HGZLWKLQGLYLGXDOLQGH[HVRQWKHauthorDQGWKHtitleFROXPQV(DFK
LQGH[LVJLYHQDQHDVLO\UHFRJQL]DEOHQDPHIDX_authorDQGIDX_titleIRUWKHauthor
DQGtitleFROXPQVUHVSHFWLYHO\
,QGH[QDPHVDUHKHOSIXOZKHQ\RXODWHUGHFLGHWRUHPRYHDQLQGH[IURPDWDEOH,QVWHDGRI
OLVWLQJDOOWKHFROXPQVDJDLQ\RXFDQMXVWUHIHUWRWKHLQGH[QDPH

,QGH[LQJ

,QGH[QDPHV
,WLVYHU\FRPPRQWRQDPHLQGH[HVZLWKVRPHVRUWRISUHÀ[OLNHIDX_DQG
WKHQDSSHQGWKHFROXPQQDPHVWKHLQGH[VSDQV
7KLVLVQRWVWULFWO\QHFHVVDU\DQG\RXPLJKWZDQWWRHVWDEOLVKDGLIIHUHQW
QDPLQJVFKHPH:KDWHYHU\RXFKRRVHPDNHVXUH\RXIROORZ\RXUVFKHPH
DQGDVVLJQQDPHVFRQVLVWHQWZLWKLWIRUDOO\RXULQGH[HV
7KHUH
VPRUH
7KHUHDUHVRPHPRUHGHWDLOVZRUWKNQRZLQJDERXWZKHQFUHDWLQJLQGH[HVRQDQ\JLYHQWDEOH
8VLQJ0\64/4XHU\%URZVHUWRJHQHUDWHWKH64/VWDWHPHQWV
6HWWLQJXSLQGH[HVFDQEHGRQHHLWKHUWKURXJKDFRPPDQGOLQHDVVKRZQHDUOLHURUXVLQJDQ
DUJXDEO\PRUHFRPIRUWDEOHJUDSKLFDOWRROOLNH0\64/4XHU\%URZVHU(VSHFLDOO\ZKHQGHDOLQJ
ZLWKPRUHFRPSOH[WDEOHVHWXSVWKHJUDSKLFDOSUHVHQWDWLRQFDQSURYLGHDGGLWLRQDOFODULW\%HIRUH
DSSO\LQJDQ\FKDQJHVWR\RXUGDWDEDVHWKHSURGXFWZLOOGLVSOD\DQGDOORZ\RXWRFRS\RUVDYHWKH
IXOO64/VWDWHPHQWVWKDWDUHHTXLYDOHQWWRWKHFKDQJHV\RXPDGHLQWKHJUDSKLFDOHGLWRU
7KLVLVYHU\FRQYHQLHQWEHFDXVHWKLVZD\\RXFDQEHVXUHQRWWRPDNHDQ\PLVWDNHV
FRQFHUQLQJVWDWHPHQWV\QWD[WDEOHRUFROXPQQDPHV:HXVXDOO\PDNHFKDQJHVXVLQJ
0\64/4XHU\%URZVHURQDGHYHORSPHQWRUWHVWLQJPDFKLQHMXVWWRJUDEWKH64/VWDWHPHQWV
DQGSXWWKHPLQWR64/XSGDWHVFULSWÀOHVIRUODWHUH[HFXWLRQIRUH[DPSOHDVDSDUWRIRXU
VRIWZDUHXSGDWHURXWLQH7KHIROORZLQJÀJXUHVKRZVZKDWWKHFKDQJHVPDGHLQWKLVH[DPSOH
ORRNOLNH1RWHWKDWWKHJHQHUDWHGVWDWHPHQWVFRQWDLQDOOWDEOHDQGFROXPQQDPHVLQEDFNWLFN
TXRWHV7KLVLVJHQHUDOO\QRWUHTXLUHGDVORQJDVWKRVHLGHQWLÀHUVGRQRWFROOLGHZLWK0\64/
NH\ZRUGV³VRPHWKLQJ\RXVKRXOGDYRLGDQ\ZD\$OVRWKHVWDWHPHQWVZLOOEHIXOO\TXDOLÀHG
ZKLFKPHDQVWKHGDWDEDVHQDPHLVSXWEHIRUHWKHWDEOHQDPH7KLVLVDOVRQRWVWULFWO\
UHTXLUHGLI\RXVHWWKHGHIDXOWGDWDEDVHWRWKHULJKWVFKHPDEHIRUHKDQG

&KDSWHU

3UHÀ[LQGH[HV
,QWKHH[DPSOHDERYHZHFUHDWHGDQLQGH[ZLWKGHIDXOWVHWWLQJV7KLVZLOOFUHDWHDQLQGH[WKDW
LVXVXDOO\MXVWULJKW<RXPD\KRZHYHUKDYHVSHFLDOUHTXLUHPHQWVRUSRVVHVVNQRZOHGJH
DERXWWKHWDEOHGDWDWKDWFDQQRWEHGHULYHGIURPWKHVFKHPDGHÀQLWLRQDORQHPDNLQJD
FXVWRPLQGH[DEHWWHUFKRLFHWKDQWKHGHIDXOWRQH
7KHGHWDLOPRVWRIWHQFKDQJHGLQDQLQGH[GHÀQLWLRQLVWKHOHQJWKRIWKHLQGH[ÀHOGV0\64/
SURYLGHVVXSSRUWIRUVRFDOOHGSUHÀ[LQGH[HV$VWKHGDWDEDVHGRHVQRWNQRZDERXWWKHQDWXUH
RIWKHFRQWHQWVWKDWDUHJRLQJWREHVWRUHGLQDQ\SDUWLFXODUFROXPQDSDUWIURPWKHGDWDW\SH
LWKDVQRFKRLFHEXWWRWDNHWKHVDIHURXWHDQGFRQVLGHUWKHIXOOOHQJWKRIWKHFROXPQLQLWV
VRUWHGLQGH[FRS\
)RUORQJFROXPQVLQODUJHWDEOHVLWFDQEHDZDVWHRIVSDFHWRFRS\WKHFRPSOHWHFROXPQ
YDOXHVWRWKHLQGH[ZKLFKLQWXUQFDQKDYHQHJDWLYHLPSDFWRQSHUIRUPDQFHMXVWEHFDXVH
WKHUH
VPRUHGDWDLQYROYHG
<RXFDQDLGWKHGDWDEDVHWRZRUNPRUHHIÀFLHQWO\ZLWK\RXUGRPDLQNQRZOHGJH,QWKHERRNV
H[DPSOHWDEOHWKHWLWOHFDQEHXSWRFKDUDFWHUVORQJ+RZHYHULWLVYHU\XQOLNHO\WKDWWKHUH
ZLOOEHDORWRIERRNVZKRVHWLWOHVVWDUWDOLNHDQGRQO\GLIIHULQWKHODVWIHZFKDUDFWHUV6R
KDYLQJWKHLQGH[FRYHUWKHPD[LPXPOHQJWKLVSUREDEO\QRWQHFHVVDU\IRUTXLFNORRNXSV%\
FKDQJLQJWKHLQGH[FUHDWLRQVWDWHPHQWWRLQFOXGHDSUHÀ[OHQJWKVD\FKDUDFWHUVIRUWKH
FROXPQWREHLQGH[HG\RXFDQWHOO0\64/WRRQO\FRS\WKHÀUVWFKDUDFWHUVRIWKHWLWOHWR
WKHLQGH[
ALTER TABLE books ADD INDEX IDX_title(title(20));

,QGH[LQJ

$VDUHVXOWWKHLQGH[ZLOOXVHOHVVVSDFH³LQWHUPVRIERWKGLVNXVDJHDQGPHPRU\ZKHQXVHG
IRUTXHULHV$VORQJDVWKHERRNWLWOHGLIIHUVZLWKLQWKHÀUVWFKDUDFWHUVWKLVLQGH[ZLOOEH
PRUHHIÀFLHQWWKDQRQHFRYHULQJWKHIXOOFROXPQ
(YHQZKHQWKHUHLVDFHUWDLQQXPEHURIWLWOHVWKDWDUHLGHQWLFDOZLWKLQWKLVFKDUDFWHUSUHÀ[
WKHLQGH[ZLOOVWLOOEHXVHIXO7KLVLVEHFDXVHDVORQJDV0\64/FDQUXOHRXWDOOEXWDIHZ
UHFRUGVKDYLQJWRORRNDWWKHDFWXDOWDEOHGDWDIRUWKHÀQDOGHFLVLRQDVWRZKLFKURZVIXOÀOOWKH
TXHU\FRQGLWLRQVLVVWLOOVLJQLÀFDQWO\IDVWHUWKDQKDYLQJWRVFDQWKHZKROHWDEOHZLWKDOOERRNV
8QIRUWXQDWHO\WKHUHLVQRHDV\WRXVHIRUPXODWRGHWHUPLQHWKHLGHDOSUHÀ[OHQJWKEHFDXVHLW
KHDYLO\GHSHQGVRQWKHDFWXDOGDWDFRQWHQW7KLVLVZK\E\GHIDXOWWKHZKROHFROXPQLVLQGH[HG
3UHÀ[SULPDU\NH\V
0RVWGRFXPHQWDWLRQRQLQGH[LQJLQVRPHZD\RUDQRWKHUFRYHUVWKHWRSLFRISUHÀ[LQGH[HV
IRUWH[WW\SHFROXPQVXVLQJRQO\DSRUWLRQDWWKHEHJLQQLQJRIFROXPQFRQWHQWVLQVWHDGRIWKH
ZKROHYDOXHVIRUWKHDFWXDOLQGH[
+RZHYHURIWHQWKLVWRSLFLVSUHVHQWHGLQDZD\WKDWPLJKWVXJJHVWWKLVRQO\ZRUNVIRU
VHFRQGDU\NH\VEXWWKDWLVQRWWUXH<RXFDQDOVRXVHDSUHÀ[SULPDU\NH\DVORQJDVWKHPRVW
LPSRUWDQWUHTXLUHPHQWRIDSULPDU\NH\LVQRWYLRODWHGWKHXQLTXHQHVVRIHDFKNH\YDOXHPXVW
EHJXDUDQWHHG
6HHDOVR
f
(VWLPDWLQJ,QQR'%LQGH[VSDFHUHTXLUHPHQWV
f
5HPRYLQJLQGH[HVIURPWDEOHV
$GGLQJDIXOOWH[WLQGH[
,QGH[HVDUHDQLPSRUWDQWPHDQVRIPDNLQJVXUHDGDWDEDVHSHUIRUPVZHOODQGUHVSRQGV
TXLFNO\ZKHQTXHULHG+RZHYHUWKH\FDQRQO\OLYHXSWRWKHLUIXOOSRWHQWLDOZKHQDSSOLHGWR
ZHOOVWUXFWXUHGGDWD8QIRUWXQDWHO\QRWDOOLQIRUPDWLRQZHZRXOGOLNHWRTXHU\FDQEHPDGH
WRÀWLQWRUHJXODUUHODWLRQDOGDWDEDVHWDEOHVDQGFROXPQV
$SULPHH[DPSOHRIWKLVLVIUHHWH[W,WGRHVQRWIROORZDQ\ZHOOGHÀQHGVWUXFWXUHDQGGRHVQRW
OHQGLWVHOIWRWKHSULQFLSOHE\ZKLFKUHJXODULQGH[HVZRUN)RUH[DPSOHDIXOOWH[WLQGH[DOORZV
TXHU\LQJIRUVHDUFKWHUPVQRPDWWHUZKHUHLQWKHLQGH[HGFROXPQWKH\RFFXUDQGQRWRQO\DW
WKHEHJLQQLQJRIWKHFROXPQDVZRXOGEHWKHFDVHZLWKQRUPDOLQGH[HV
)XOOWH[WLQGH[HVUHTXLUH\RXWRXVHDVSHFLDOV\QWD[WRH[SUHVV\RXUTXHULHV4XHU\LQJZLWK
WKH/,.(NH\ZRUGZLOOQRWEHDFFHOHUDWHGE\DIXOOWH[WLQGH[,QWKLVUHFLSH\RXZLOOOHDUQKRZ
WRFUHDWHDIXOOWH[WLQGH[RQDQH[LVWLQJGDWDEDVHFROXPQ)RUWKHSXUSRVHRIWKLVH[DPSOH
ZHDVVXPHDÀFWLRQDOIRUXPGDWDEDVHZLWKDSRVWVWDEOHWKDWLQWXUQKDVDFRQWHQWFROXPQ
VWRULQJWKHDFWXDOWH[WRIDIRUXPHQWU\

&KDSWHU

,QQR'%WDEOHVGRQRWVXSSRUWIXOOWH[WLQGH[LQJ7KLVIHDWXUHLVRQO\
DYDLODEOHIRUWDEOHVXVLQJWKH0\,6$0VWRUDJHHQJLQH
*HWWLQJUHDG\
&RQQHFWWRWKHGDWDEDVHXVLQJ\RXUDGPLQLVWUDWLYHDFFRXQW
+RZWRGRLW

&KDQJHWKHGHIDXOWGDWDEDVHWRIRUXP
USE forum;

&UHDWHWKHIXOOWH[WLQGH[XVLQJWKHIROORZLQJFRPPDQG
ALTER TABLE posts ADD FULLTEXT INDEX IDX_content(content); 
+RZLWZRUNV
:KLOHUHJXODULQGH[HVFUHDWHRUGHUHGFRSLHVRIWKHUHOHYDQWFROXPQVWRHQDEOHTXLFNORRNXSV
IXOOWH[WLQGH[HVDUHDPRUHFRPSOLFDWHGPDWWHU
'URSSLQJDQGUHFUHDWLQJIXOOWH[WLQGH[HVIRUEXONGDWDLPSRUWV
:KHQÀUVWLQVHUWLQJEXONGDWDLQWRDWDEOHLWLVIDVWHUWRÀUVWGURSDQH[LVWLQJ
IXOOWH[WLQGH[DQGWKHQODWHUUHFUHDWHLW7KLVZLOOVSHHGXSWKHGDWDLQVHUWLRQ
VLJQLÀFDQWO\EHFDXVHNHHSLQJWKHIXOOWH[WLQGH[XSWRGDWHGXULQJGDWDLQVHUWLV
DQH[SHQVLYHRSHUDWLRQ
7KHUH
VPRUH
+HUHDUHVRPHGHWDLOVWKDWDUHLPSRUWDQWWRNQRZZKHQLQFOXGLQJIXOOWH[WLQGH[LQJLQ
\RXUDSSOLFDWLRQV
3OHDVHEHDZDUHWKDWFKDQJHVWRDQ\RIWKHSDUDPHWHUVWKDWIROORZUHTXLUHD
UHEXLOGRIDQ\IXOOWH[WLQGH[WKDWZDVFUHDWHGEHIRUHWKHFKDQJH
6HHWKH0\64/RQOLQHPDQXDODWhttp://dev.mysql.com/doc/
refman/5.1/en/fulltext-fine-tuning.htmlIRUPRUHGHWDLOV

,QGH[LQJ

&DVHVHQVLWLYLW\
)XOOWH[WLQGH[TXHULHVDUHXVXDOO\UXQLQDFDVHLQVHQVLWLYHZD\,I\RXQHHGFDVHVHQVLWLYH
IXOOWH[WVHDUFK\RXZLOOKDYHWRFKDQJHWKHFROODWLRQRIWKHDIIHFWHGXQGHUO\LQJFROXPQVWR
DELQDU\YDULDQW
:RUGOHQJWK
:KHQDIXOOWH[WLQGH[LVFUHDWHGRQO\ZRUGVZLWKLQDFRQÀJXUDEOHUDQJHRIOHQJWKVDUH
FRQVLGHUHG7KLVKHOSVWRSUHYHQWDFURQ\PVDQGDEEUHYLDWLRQVEHLQJLQFOXGHGLQWKHLQGH[<RX
FDQFRQÀJXUHWKHDFFHSWDEOHOHQJWKUDQJHXVLQJWKHft_min_word_lenDQGft_max_word_
lenYDULDEOHV7KHGHIDXOWYDOXHIRUWKHPLQLPXPOHQJWKLVFKDUDFWHUV
6WRSZRUGV
,QHYHU\ODQJXDJHWKHUHDUHPDQ\ZRUGVWKDWDUHXVXDOO\QRWZDQWHGLQIXOOWH[WVHDUFK
PDWFKLQJ7KHVHVRFDOOHGVWRSZRUGVPLJKWEHLVDEHWKHUHEHFDXVHGRQHDPRQJRWKHUV
7KH\DSSHDUVRIUHTXHQWO\LQPRVWWH[WVWKDWVHDUFKLQJIRUWKHPLVKDUGO\XVHIXO7RFRQVHUYH
UHVRXUFHVWKHVHVWRSZRUGVDUHLJQRUHGZKHQEXLOGLQJDIXOOWH[WLQGH[0\64/XVHVDGHIDXOW
VWRSZRUGOLVWWKDWGHÀQHVZKDWLVWREHLJQRUHGZKLFKFRQWDLQVDOLVWRIDERXW(QJOLVK
VWRSZRUGV<RXFDQFKDQJHWKLVOLVWRIVWRSZRUGVZLWKWKHft_stopword_fileYDULDEOH,W
WDNHVDÀOHQDPHZLWKDSODLQWH[WÀOHFRQWDLQLQJWKHVWRSZRUGV\RXZRXOGOLNHWRXVH'LVDEOLQJ
VWRSZRUGVFDQEHDFKLHYHGE\VHWWLQJWKLVYDULDEOHWRDQHPSW\VWULQJ
,JQRULQJIUHTXHQWZRUGV
)UHTXHQWZRUGVZLOOEHLJQRUHGLIDVHDUFKWHUPLVSUHVHQWLQPRUHWKDQKDOIRIWKHURZV
VHDUFKHGLWZLOOEHFRQVLGHUHGDVWRSZRUGDQGHIIHFWLYHO\LJQRUHG7KLVLVXVHIXOHVSHFLDOO\
LQODUJHWDEOHVRWKHUZLVH\RXZRXOGJHWKDOIRIWKHWDEOHDVTXHU\KLWVZKLFKFDQKDUGO\EH
FRQVLGHUHGXVHIXO
:KHQH[SHULPHQWLQJZLWKIXOOWH[WVHDUFKPDNHVXUH\RXKDYHDUHDVRQDEO\
ODUJHGDWDVHWWRSOD\ZLWK2WKHUZLVH\RXZLOOHDVLO\KLWWKHSHUFHQWPDUN
GHVFULEHGDERYHDQGQRWJHWDQ\TXHU\UHVXOWV7KLVFDQEHFRQIXVLQJDQGZLOO
PDNH\RXWKLQN\RXGLGVRPHWKLQJZURQJZKLOHLQIDFWHYHU\WKLQJLVSHUIHFWO\
LQRUGHU
4XHU\PRGHV
$SDUWIURPWKHGHIDXOWKXPDQTXHU\PRGH\RXFDQXVHDERROHDQTXHU\PRGHZKLFKHQDEOHV
VSHFLDOVHDUFKHQJLQHOLNHRSHUDWRUVWREHXVHG³IRUH[DPSOHWKHSOXVDQGPLQXVVLJQVWR
LQFOXGHRUH[FOXGHZRUGVLQWKHVHDUFK
7KLVZRXOGDOORZ\RXWRXVHTXHU\WHUPVVXFKDV'+apple -macintosh'WRÀQGDOOUHFRUGV
FRQWDLQLQJWKHZRUGappleEXWQRWWKHZRUGmacintosh

&KDSWHU

)RUDOOWKHSRVVLEOHRSHUDWRUVKDYHDORRNDWWKH0\64/RQOLQHPDQXDODW
http://dev.mysql.com/doc/refman/5.1/en/fulltext-boolean.html
6SKLQ[
0\64/
VEXLOWLQIXOOWH[WVHDUFKLVRQO\DYDLODEOHIRU0\,6$0WDEOHV,QSDUWLFXODU,QQR'%LV
QRWVXSSRUWHG,I\RXFDQQRWRUGRQRWZDQWWRXVH0\,6$0KDYHDORRNDW6SKLQ[³DQRSHQ
VRXUFHIUHHIXOOWH[WVHDUFKHQJLQHWKDWZDVGHVLJQHGWRLQWHJUDWHQLFHO\ZLWK0\64/6HH
http://sphinxsearch.com/IRUPRUHLQIRUPDWLRQ
6HHDOVR
f
5HPRYLQJLQGH[HVIURPWDEOHV
&UHDWLQJDQRUPDOL]HGWH[WVHDUFKFROXPQ
8VXDOO\UHJXODUDQGIXOOWH[WLQGH[LQJDVVXSSRUWHGE\0\64/DUHVXIÀFLHQWIRUPRVWXVHFDVHV
7KHUHDUHKRZHYHUVLWXDWLRQVZKHUHWKH\DUHQRWSHUIHFWO\XVDEOH
f
,QQR'%WDEOHVFDQQRWXVHIXOOWH[WLQGH[HV$WWKHWLPHRIZULWLQJWKHUHZHUHQRVLJQV
RIWKLVFKDQJLQJLQWKHIRUHVHHDEOHIXWXUH
f
7KHUHDUHGLIIHUHQWZD\VWRVSHOOWKHVHDUFKWHUPV
(VSHFLDOO\LQQRQ(QJOLVKVSHDNLQJFRXQWULHVDSUREOHPRIWHQDULVHVWKDWGRHVQRWVXUIDFHDV
RIWHQLQ$PHULFDQRU%ULWLVKHQYLURQPHQWV:RUGVLQWKH(QJOLVKODQJXDJHFRQVLVWRIWKHOHWWHUV
IURP$WR=ZLWKRXWGLDFULWLFV)URPDVRIWZDUHGHYHORSPHQWSHUVSHFWLYHWKLVLVDZHOFRPH
VLPSOLÀFDWLRQEHFDXVHLWDOORZVIRUVLPSOHULPSOHPHQWDWLRQV
2QHSUREOHP\RXDUHRIWHQIDFHGZLWK*HUPDQIRUH[DPSOHLVGLIIHUHQWZD\VWRVSHOOWKH
VDPHZRUGPDNLQJLWFRPSOLFDWHGWRIRUPXODWHVXLWDEOHVHDUFKWHUPV
&RQVLGHUWKH*HUPDQZRUGV'EHOGRZHODQG0|UWHOPRUWDU,QDPHUFKDQGLVHPDQ
DJHPHQWGDWDEDVH\RXPLJKWÀQGVHYHUDOYDULDQWVRIVLPLODUSURGXFWVEXWHDFKFRXOGEH
VSHOOHGLQGLIIHUHQWZD\V
SURGXFW,'
QDPH
VWRFN

'h%(/*52


)ODFKHU(LQVHU0|UWHO


'h%(/*5266


'XHEHO*UR


,QGH[LQJ

$VDQHQGXVHURIWKHFRUUHVSRQGLQJDSSOLFDWLRQVHDUFKLQJIRUWKRVHEHFRPHVFXPEHUVRPH
EHFDXVHWRÀQGH[DFWO\ZKDW\RXDUHORRNLQJIRU\RXPLJKWKDYHWRDWWHPSWVHYHUDOVHDUFKHV
,QWKLVUHFLSHZHZLOOSUHVHQWDQLGHDWKDWQHHGVVRPHVXSSRUWRQWKHDSSOLFDWLRQOHYHOEXW
ZLOODOORZ\RXWRXVHVLPSOHUHJXODULQGH[HVWRTXLFNO\VHDUFKDQGÀQGUHOHYDQWUHFRUGVLQ
VLWXDWLRQVOLNHWKHDERYH
7RLPSOHPHQWWKHLGHDVSUHVHQWHGLQWKLVUHFLSHPRGLÀFDWLRQVWRWKH
VRIWZDUHDFFHVVLQJWKHGDWDEDVHDVZHOODVWKHWDEOHGHÀQLWLRQZLOOEH
QHFHVVDU\:HDGYLVHWKDWWKLVLVDSURFHVVWKDWXVXDOO\HQWDLOVDKLJKHU
FRPSOH[LW\DQGLQFUHDVHGWHVWLQJHIIRUWVWKDQVLPSO\DGGLQJDQLQGH[
*HWWLQJUHDG\
7RLPSOHPHQWWKHLGHDVSUHVHQWHGKHUH\RXZLOOQHHGWRFRQQHFWWRWKHGDWDEDVHVHUYHUZLWK
\RXUDGPLQLVWUDWLYHDFFRXQWIRUWKHVFKHPDPRGLÀFDWLRQV%HFDXVHDSDUWIURPWKHGDWDEDVH
PRGLÀFDWLRQVDSSOLFDWLRQSURJUDPFRGHFKDQJHVZLOOEHQHFHVVDU\DVZHOO\RXVKRXOGFRQWDFW
DQDSSOLFDWLRQGHYHORSHU
,QWKHH[DPSOHZHDUHJRLQJWRDVVXPHDWDEOHGHÀQLWLRQDVIROORZV
  CREATE TABLE products (
  productID int(11) NOT NULL,
  name char(30) default NULL,
  stock int(11) default NULL,
  PRIMARY KEY  (productID)
  ) ENGINE=InnoDB
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHVHUYHUXVLQJ\RXUDGPLQLVWUDWLYHDFFRXQWDQGPDNHtest
WKHGHIDXOWVFKHPD
use test;

$GGDQHZFROXPQnorm_nameWRWKHproductsWDEOH
mysql> ALTER TABLE products ADD COLUMN norm_name CHAR(90) AFTER 
name;
7KHFROXPQQHHGVWREHDWOHDVWDVORQJDV\RXURULJLQDOFROXPQ'HSHQGLQJRQWKH
FKDUDFWHUPDSSLQJUXOHV\RXDUHJRLQJWRLPSOHPHQWWKHSURMHFWHGYDOXHVPLJKWWDNH
XSPRUHVSDFH
 'HÀQHDQLQGH[RQWKHQHZFROXPQ0DNHVXUHLWLVQRWVHWWRUNIQUE

&KDSWHU


2SWLRQDOO\FRQVLGHUGURSSLQJDQH[LVWLQJLQGH[RQWKHRULJLQDOFROXPQ$OVRFRQVLGHU
PRGLI\LQJRWKHULQGH[HVFXUUHQWO\FRQWDLQLQJWKHRULJLQDOFROXPQWRLQFOXGHWKHQHZ
RQHLQVWHDG
,PSOHPHQWWKHUHSODFHPHQWDOJRULWKPGHSHQGLQJRQ\RXUODQJXDJH)RU*HUPDQ
ODQJXDJHVXEVWLWXWLRQVWKHIROORZLQJVXEVWLWXWLRQVFRXOGEHXVHG7KLVLVMXVWDQ
H[FHUSWIURPWKHTransformers.javaFODVV\RXFDQÀQGRQWKHERRN
VZHEVLWH
    private static String[] replacements = {
    "ä", "ae",    "null", "0",    ":", "",
    "ö", "oe",    "eins", "1",    ":", "",
    "ü", "ue",    "zwei", "2",    ".", "",
    "ß", "ss",    /* ... */       "-", "",
    " ", "",       "neun", "9",    ",", "",
    // ... further replacements...
    };

0RGLI\\RXUDSSOLFDWLRQFRGHWRXVHWKHQHZPDSSLQJIXQFWLRQDQGLVVXHTXHULHV
DJDLQVWWKHQHZnorm_nameFROXPQZKHUHSUHYLRXVO\WKHRULJLQDOnameFROXPQZDV
XVHG'HSHQGLQJRQKRZ\RXGHFLGHWRH[SRVHWKHVHDUFKIHDWXUHVWR\RXUHQGXVHUV
\RXPLJKWZDQWWRPDNHVHDUFKLQJWKHQHZRUWKHROGFROXPQDQRSWLRQ

0RGLI\\RXUDSSOLFDWLRQFRGHWRXSGDWHWKHQHZFROXPQSDUDOOHOWRWKHRULJLQDO
RQH'HSHQGLQJRQWKHDSSOLFDWLRQVFHQDULR\RXPLJKWGHFLGHWRRQO\XSGDWHWKH
QRUPDOL]HGVHDUFKFROXPQSHULRGLFDOO\LQVWHDG

%HIRUHKDQGLQJRXWDQHZYHUVLRQRI\RXUVRIWZDUHFRQWDLQLQJWKHQHZFRGHPDNH
VXUHWKHQRUPDOL]HGVHDUFKFROXPQJHWVSRSXODWHGZLWKWKHFRUUHFWYDOXHV

2SWLRQDOO\GHFODUHWKHQHZFROXPQ12718//DIWHULWKDVEHHQLQLWLDOO\ÀOOHG
+RZLWZRUNV
%\LPSOHPHQWLQJWKHPDSSLQJDOJRULWKPZHPDNHWKHDSSOLFDWLRQWKLQNDERXWWKHGLIIHUHQW
ZD\VWRVSHOOWKLQJVQRWWKHHQGXVHU,QVWHDGRIFUHDWLQJDOOSRVVLEOHYDULDQWVZKLFKFRXOG
EHFRPHDODUJHVHWRISHUPXWDWLRQVGHSHQGLQJRQWKHOHQJWKDQGFRQWHQWRIWKHRULJLQDO
LQSXWZHSURMHFWWKHVHDUFKWHUPVWRDQRUPDOL]HGIRUPIRUERWKWKHRULJLQDOGDWDDQGODWHU
IRUTXHULHVLVVXHGDJDLQVWLW$VERWKXVHWKHVDPHPDSSLQJIXQFWLRQVRQO\DVLQJOH³LQGH[
VXSSRUWHG³TXHU\DJDLQVW0\64/LVQHHGHG7KHDSSOLFDWLRQRIFRXUVHXVXDOO\QHYHUUHYHDOV
WKHVHLQWHUQDOV7KHSHUVRQLQIURQWRIWKHFRPSXWHUZLOOMXVWEHSOHDVHGWRÀQGWKHGHVLUHG
UHFRUGVHDVLO\
7KHPDSSLQJUXOHVIURPLQSXWWRVHDUFKWHUPVGHSHQGRQWKHODQJXDJHDQGDSSOLFDWLRQ
VSHFLÀFQHHGV)RU*HUPDQZRUGVWKH\DUHUDWKHUVKRUW³RQO\WKHXPODXWFKDUDFWHUVQHHGWR
EHWUDQVIRUPHGWRDQRUPDOL]HGIRUP2WKHUODQJXDJHVPLJKWUHTXLUHPRUHFRPSOH[UXOHV

,QGH[LQJ

,QWKHH[DPSOHFRGHHDUOLHUZHDOVRWUDQVIRUPWKHLQSXWWRORZHUFDVHDQGUHPRYHVHYHUDO
VSHFLDOFKDUDFWHUVOLNHGDVKHVDQGFRORQVDQGDOVRWKHZKLWHVSDFH)RUWKHVDPSOHGDWDVHW
RISURGXFWVZHXVHGWKLVLVWKHUHVXOWRIWKHWUDQVIRUPDWLRQ
SURGXFW,'
1DPH
QDPHBQUP
VWRFN

'h%(/*52
GXHEHOJURVV


)ODFKHU(LQVHU0|UWHO
ÁDFKHUHUPRHUWHO


'h%(/*5266
GXHEHOJURVV


'XHEHO*UR
GXHEHOJURVV

1RZLQVWHDGRITXHU\LQJWKHRULJLQDOGDWDFROXPQZHDVNWKHGDWDEDVHWRVHDUFKIRUWKH
WUDQVIRUPHGUHSUHVHQWDWLRQRIWKHVHDUFKWHUPVLQWKHDGGLWLRQDOnorm_nameQRUPDOL]HG
FROXPQ)RUWKLVLWFDQXVHUHJXODULQGH[HVDQGSURYLGHUHVXOWVTXLFNO\DQGHIÀFLHQWO\
1RWHWKDWWKHTransformer.javaFRGHDYDLODEOHIURPWKHERRN
VZHEVLWHLVQRZKHUHQHDU
SURGXFWLRQTXDOLW\EXWRQO\VHUYHVIRUGHPRQVWUDWLRQSXUSRVHV,WGRHVQRWIRUH[DPSOHFRQWDLQ
DQ\HUURUFKHFNLQJRUH[FHSWLRQKDQGOLQJDQGWKHPDSSLQJDOJRULWKPLVYHU\VLPSOHWRR
7KHUHLVPRUH
,I\RXGRQRWFDUHDERXWLQWHUQDWLRQDOVSHFLDOWLHVEXWVWLOOZDQWWRLPSURYHXVHUH[SHULHQFHE\
DOORZLQJIRUOHVVVWULFWVHDUFKHV\RXPLJKWZDQWWRKDYHDORRNDWWKHSOUNDEX()IXQFWLRQ
,WLVGHVLJQHGWRZRUNIRU(QJOLVKODQJXDJHZRUGVRQO\DQGDOORZV\RXWRTXHU\IRUUHVXOWVWKDW
VRXQGOLNHWKHVHDUFKWHUPV
+RZHYHUQRWHWKDWWKHUHVXOWVRIXVLQJLWPD\QRWEHZKDW\RXH[SHFW³RSLQLRQVRQWKH
,QWHUQHWUDQJHIURPH[WUHPHHQWKXVLDVPWRFRPSOHWHGLVDSSRLQWPHQW<RXFDQÀQGLWV
GRFXPHQWDWLRQDWhttp://dev.mysql.com/doc/refman/5.1/en/string-functions.
html#function_soundex
5HPRYLQJLQGH[HVIURPWDEOHV
2QFHXVHIXOLQGH[HVPD\EHFRPHREVROHWHDVUHTXLUHPHQWVFKDQJHZLWKWKHHYROYLQJ
GDWDEDVH,QWKLVFKDSWHUZHZLOOVKRZ\RXKRZWRJHWULGRIWKH,';BDXWKRULQGH[FUHDWHGLQ
WKH$GGLQJLQGH[HVWRWDEOHVUHFLSH
*HWWLQJUHDG\
&RQQHFWWRWKHGDWDEDVHVHUYHUZLWK\RXUDGPLQLVWUDWLYHDFFRXQW

&KDSWHU

+RZWRGRLW

&KDQJHWKHGHIDXOWGDWDEDVHWRlibrary
USE library;

'URSWKHIDX_authorLQGH[XVLQJWKHIROORZLQJFRPPDQG
ALTER TABLE books DROP INDEX IDX_author; 
+RZLWZRUNV
8VLQJWKHALTERTABLEVWDWHPHQWZHWHOOWKHGDWDEDVHWKDWZHZDQWWRUHPRYHDROPWKH
LQGH[QDPHGIDX_authorIURPWKHbooksWDEOH
7KHUH
VPRUH
$VZLWKWKHFUHDWLRQRIQHZLQGH[HV\RXFDQGURSPXOWLSOHLQGH[HVDWRQFHXVLQJWKHALTER 
TABLEVWDWHPHQWE\VLPSO\DGGLQJPRUHDROP INDEXFODXVHVVHSDUDWHGE\FRPPD,I\RX
ZHUHWRGHOHWHERWKLQGH[HVGHÀQHGLQ$GGLQJLQGH[HVWRWDEOHV\RXFRXOGXVHWKLVVWDWHPHQW
ALTER TABLE books DROP INDEX IDX_author, DROP INDEX IDX_title;
6HHDOVR
f
$GGLQJLQGH[HVWRWDEOHV
(VWLPDWLQJ,QQR'%LQGH[VSDFH
UHTXLUHPHQWV
:KLOHLQGH[HVPLJKWYHU\ZHOOEHWKHVLQJOHPRVWLPSRUWDQWNH\LQGDWDEDVHSHUIRUPDQFH
WXQLQJWKH\FRPHDWWKHSULFHRIUHGXQGDQF\
7KHUHDUHWZRPDLQGLVDGYDQWDJHVWLJKWO\FRQQHFWHGWRUHGXQGDQWGDWDVWRUDJH
f
7KHGDQJHURILQFRQVLVWHQFLHVEHWZHHQWKHUHGXQGDQWFRSLHVRIGDWDWKDWVKRXOGEH
DWDOOWLPHVLGHQWLFDO
f
,QFUHDVHGVWRUDJHDQGPHPRU\FRQVXPSWLRQEHFDXVHWKHVDPHGDWDLV
SK\VLFDOO\GXSOLFDWHG
)RUWXQDWHO\WKHIRUPHULVDQRQLVVXHZLWKLQGH[HV$VWKHGDWDEDVHVHUYHUWDNHVFDUHRI
NHHSLQJGDWDDQGLQGH[HVFRQVLVWHQWZLWKRXWKXPDQLQWHUYHQWLRQ\RXFDQQRWJHWLQWRDVLWX
DWLRQZKHUHWZRFROXPQVWKDWVKRXOGFRQWDLQHTXDOGDWDDWDOOWLPHVDUHRXWRIV\QFGXHWR
SURJUDPPLQJHUURUVRUWKHOLNH7KLVLVXVXDOO\DSUREOHPZKHQYLRODWLQJQRUPDOL]DWLRQUXOHV

,QGH[LQJ

,QFRQWUDVWWRWKDWWKHUHLVQRZD\WRSUHYHQWWKHODWWHUGLVDGYDQWDJH:HQHHGWRVWRUH
PXOWLSOHFRSLHVLIZHZDQWGLIIHUHQWVRUWRUGHUVIRUTXLFNORRNXSV:KDWZHFDQGRKRZHYHU
LVWRDWWHPSWWRPLQLPL]HWKHQHJDWLYHHIIHFWE\WU\LQJWROLPLWWKHDPRXQWRIGXSOLFDWHG
LQIRUPDWLRQDVIDUDVSRVVLEOH
7KHemployeesGDWDEDVHLVDQRSHQVRXUFHWHVWGDWDEDVHDYDLODEOHIRU
IUHH,WFRQWDLQVH[DPSOHVIRUPDQ\0\64/IHDWXUHVLQFOXGLQJODUJHWDEOHV
IRUHLJQNH\FRQVWUDLQWVYLHZVDQGPRUH,WFDQEHIRXQGDORQJZLWKVRPH
GRFXPHQWDWLRQDWhttp://dev.mysql.com/doc/employee/en/
employee.html
,QWKHH[DPSOHEHORZZHDVVXPHWKHH[LVWHQFHRIWKHHPSOR\HHVWHVWGDWDEDVHZLWKDQ
employeesWDEOHGHÀQHGDVIROORZV
  CREATE TABLE employees (
  emp_no int(11) NOT NULL,
  birth_date date NOT NULL,
  first_name varchar(14) NOT NULL,
  last_name varchar(16) NOT NULL,
  gender enum('M','F') NOT NULL,
  hire_date date NOT NULL,
  PRIMARY KEY (emp_no)
  ) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
:HZLOODGGDQLQGH[HDFKWRWKHlast_nameDQGWKHfirst_nameFROXPQVDQGWU\WR
SUHGLFWWKHQHFHVVDU\VSDFH
3OHDVHQRWHWKDWWKHUHVXOWVZLOOQHYHUEHH[DFW7KHVWRUDJHUHTXLUHPHQWV³
HVSHFLDOO\RIWH[WYDOXHWDEOHFROXPQV9$5&+$57(;7&+$5DQGVR
RQ³FDQEHGLIÀFXOWWRGHWHUPLQHEHFDXVHWKHUHDUHPXOWLSOHIDFWRUVWKDW
LQÁXHQFHWKHFDOFXODWLRQ$SDUWIURPGLIIHUHQFHVEHWZHHQVWRUDJHHQJLQHV
DQLPSRUWDQWDVSHFWLVWKHFKDUDFWHUVHWXVHG)RUGHWDLOVUHIHUWRWKH
RQOLQHPDQXDOIRU\RXUVHUYHUYHUVLRQhttp://dev.mysql.com/doc/
refman/5.1/en/storage-requirements.html.
0RUHRYHULWLVQRWSRVVLEOHWRÀQGRXWWKHH[DFWVL]HHYHQIRUH[LVWLQJLQGH[HV
EHFDXVH0\64/
VSHOW TABLE STATUSFRPPDQGRQO\JLYHVDSSUR[LPDWH
UHVXOWVIRU,QQR'%WDEOHV

&KDSWHU

*HWWLQJUHDG\
&RQQHFWWRWKHGDWDEDVHVHUYHUZLWK\RXUDGPLQLVWUDWLYHDFFRXQW
+RZWRGRLW
 )LQGRXWWKHVL]HRIRQHSULPDU\NH\HQWU\
7RGRVRORRNDWWKHSULPDU\NH\GHÀQLWLRQLQWKHWDEOHVWUXFWXUH$GGWKHVL]HVRIDOO
SULPDU\NH\FROXPQVDVGRFXPHQWHGLQWKH0\64/2QOLQH0DQXDO,QWKHH[DPSOH
WKH,17FROXPQWDNHVE\WHV:ULWHWKLVQXPEHUGRZQ

'HWHUPLQHWKHVL]HRIHDFKFROXPQWREHLQFOXGHGLQWKHQHZLQGH[HVDQGDGGWKHP
XSSHULQGH[,QWKHH[DPSOHERWKfirst_nameDQGlast_nameDUHVARCHAR
FROXPQV³WKLVPHDQVWKHLUOHQJWKVDUHQRWÀ[HGDVZLWKWKH,17W\SH)RUVLPSOLFLW\ZH
ZLOODVVXPHFRPSOHWHO\ÀOOHGFROXPQVPHDQLQJE\WHVIRUfirst_nameDQG
E\WHVIRUWKHlast_nameFROXPQ

)RUHDFKLQGH[DGGWKHOHQJWKVRIDOOUHOHYDQWFROXPQVDQGWKHVL]HRIWKHSULPDU\
NH\,QRXUH[DPSOHWKLVJLYHVWKHIROORZLQJUHVXOWV
,QGH[
&ROXPQVL]H
3ULPDU\.H\
6L]H
,QGH[5HFRUG
6L]H
,';B),567B1$0(



,';B/$67B1$0(



7KHULJKWPRVWFROXPQFRQWDLQVWKHSXUHGDWDVL]HRIDVLQJOHLQGH[UHFRUGLQFOXGLQJ
WKHLPSOLFLWSULPDU\NH\
 0XOWLSO\WKHVL]HSHULQGH[UHFRUGZLWKWKHQXPEHURIURZVLQWKHWDEOH
,QGH[
5RZV
,QGH[UHFRUG
VL]H
(VWLQGH[VL]H
,';B),567B1$0(



,';B/$67B1$0(



7KHULJKWPRVWFROXPQFRQWDLQVWKHHVWLPDWHGVL]HRIWKHLQGH[EDVHGRQWKHFXUUHQW
QXPEHURIUHFRUGVDQGWKHRYHUKHDGWDNHQE\,QQR'%WRLQWHUQDOO\RUJDQL]HDQGVWRUH
WKHGDWD

,QGH[LQJ

+RZLWZRUNV
,QWKHSUHYLRXVVWHSVZHVLPSO\DGGHGXSWKHVL]HVRIDOOFROXPQVWKDWZLOOIRUPDVHFRQGDU\
LQGH[HQWU\7KLVLQFOXGHVDOOFROXPQVRIWKHVHFRQGDU\LQGH[LWVHOIDQGDOVRWKRVHRIWKH
SULPDU\NH\EHFDXVHDVH[SODLQHGLQWKHFKDSWHULQWURGXFWLRQ,QQR'%LPSOLFLWO\DGGVWKRVHWR
HYHU\LQGH[
,QWHUQDOO\WKHVHUYHURIFRXUVHQHHGVDOLWWOHPRUHWKDQMXVWWKHUDZFROXPQFRQWHQWV³DOOVRUWV
RIPDQDJHPHQWRYHUKHDGVXFKDVFROXPQZLGWKVLQIRUPDWLRQRQZKLFKFROXPQVFDQEHQXOO
DVZHOODVVRPHFRQVWDQWRYHUKHDGDGGWRWKHUHTXLUHGVSDFH&DOFXODWLQJWKHVHLQGHWDLO
LVFRPSOLFDWHGDQGHUURUSURQHEHFDXVHWKH\UHO\RQPDQ\SDUDPHWHUVDQGLPSOHPHQWDWLRQ
GHWDLOVFDQFKDQJHEHWZHHQ0\64/YHUVLRQV7KLVLVQRWUHTXLUHGKRZHYHUEHFDXVHRXUDLP
LVDEDOOSDUNQXPEHU$VWDEOHFRQWHQWVRIWHQFKDQJHTXLFNO\H[DFWQXPEHUVZRXOGQRWEH
YDOLGIRUORQJ
<RXFDQVHHWKLVLQRXUH[DPSOH³WKHYDOXHVDUHWRRORZ,QUHDOLW\\RXZLOOQHHGWRH[SHULPHQW
ZLWKWKHVHYDOXHV<RXDUHXVXDOO\JRLQJWREHRQWKHVDIHVLGHZKHQ\RXPXOWLSO\\RXUUHVXOWV
ZLWKDIDFWRURIWR
<RXZLOOÀQGWKDWGHSHQGLQJRQWKHOHQJWKVRIWKHFROXPQVLQGH[HGDQGWKRVHWKDWPDNHXS
WKHSULPDU\NH\WKHDFFXUDF\RIWKHHVWLPDWHVFDQYDU\
7KHUH
VPRUH
3UHGLFWLQJVSDFHUHTXLUHPHQWVLVQRWDQH[DFWVFLHQFH7KHIROORZLQJLWHPVDUHLQWHQGHGWR
JLYHVRPHPRUHKLQWVRQZKDW\RXPLJKWZDQWWRWKLQNDERXW
&RQVLGHULQJDFWXDOGDWDOHQJWKVLQ\RXUHVWLPDWH
:KHQDGGLQJDQLQGH[WRDQH[LVWLQJFROXPQ\RXFDQWU\WRXVHWKHDYHUDJHOHQJWKRIWKH
FROXPQYDOXHV
SELECT AVG(LENGTH(first_name)) AS avg_first, AVG(LENGTH(last_name)) AS 
avg_last FROM employees;
)RUWKHVDPSOHGDWDWKHUHVXOWVDUH
DYJBÀUVW 
DYJBODVW


5RXQGWKLVXSWRWKHQH[WLQWHJHU1RWHWKDWHVSHFLDOO\IRUVKRUWFROXPQVOLNHWKLVWKH
HVWLPDWHVFDQEHPXFKOHVVUHOLDEOHEHFDXVHUHODWLYHWRLQWHUQDOGDWDEDVHRYHUKHDGGDWDVL]H
LVOHVVVLJQLÀFDQW7KLVLVZK\LQWKHUHFLSHHDUOLHUZHZHQWZLWKGHFODUHGPD[LPXPOHQJWKRI
WKHVARCHARFROXPQVLQVWHDG

&KDSWHU

0LQGLQJFKDUDFWHUVHWV
)RUFROXPQVVWRULQJWH[WLQIRUPDWLRQ³VXFKDVCHARDQGVARCHARVARBINARYDQG
TEXT³WKHVWRUDJHUHTXLUHPHQWVGHSHQGRQWKHFKDUDFWHUVHWXVHGIRUWKHWH[WLQVLGH
)RUPRVW(QJOLVKVSHDNLQJFRXQWULHVWKLVLVVRPHWKLQJOLNHWKH/DWLQFKDUDFWHUVHWZKLFK
XVHVDVLQJOHE\WHSHUFKDUDFWHURIWH[W+RZHYHULQLQWHUQDWLRQDOHQYLURQPHQWVWKLVHQFRGLQJ
LVKDUGO\VXIÀFLHQW7RDFFRPPRGDWH*HUPDQWH[WIRUH[DPSOH\RXQHHGVRPHVSHFLDO
FKDUDFWHUV³QRWWRPHQWLRQ&KLQHVH-DSDQHVHRURWKHUQRQ/DWLQODQJXDJHV
0\64/VXSSRUWVGLIIHUHQWFKDUDFWHUVHWVRQDSHUFROXPQEDVLV+RZHYHURIWHQ\RXZLOOGHÀQH
DGHIDXOWFKDUDFWHUVHWIRUDGDWDEDVHLQFOXGLQJDOOLWVWDEOHVDQGWKHLUFROXPQV
:KHQHVWLPDWLQJLQGH[DQGGDWDVL]HVIRU8QLFRGHDZDUHFROXPQV0\64/VXSSRUWV
87)DQG8&6FKDUDFWHUVHWVIRUWKLVSXUSRVH\RXQHHGWRWDNHLQWRDFFRXQWWKDWWKRVH
PD\UHTXLUHPRUHWKDQDVLQJOHE\WHSHUFKDUDFWHU7KHYHU\SRSXODU87)HQFRGLQJXVHV
EHWZHHQDQGHYHQWKRXJKDUHRQO\XVHGLQYHU\VSHFLDOFDVHVE\WHVSHUFKDUDFWHU
8&6KDVDFRQVWDQWVL]HRIE\WHVSHUFKDUDFWHU)RUGHWDLOVRQKRZ87)ZRUNV
VHHhttp://en.wikipedia.org/wiki/UTF-8
8VLQJSUHÀ[SULPDU\NH\V
,QWKLVH[DPSOHZHZLOODGGLQGH[HVWRWZRWDEOHVWKDWDUHDOPRVWLGHQWLFDO7KHRQO\GLIIHUHQFH
ZLOOEHWKHGHÀQLWLRQRIWKHLUSULPDU\NH\V<RXZLOOVHHWKHGLIIHUHQFHLQVSDFHFRQVXPSWLRQ
IRUVHFRQGDU\LQGH[HVEHWZHHQDUHJXODUIXOOFROXPQSULPDU\NH\DQGDSUHÀ[SULPDU\NH\
7KHVDPSOHWDEOHVWUXFWXUHDQGGDWDDUHGHVLJQHGWRGHPRQVWUDWHWKHHIIHFWYHU\HYLGHQWO\
,QUHDOZRUOGVFHQDULRVWKHHIIHFWZLOOPRVWFHUWDLQO\EHOHVVVHYHUH
*HWWLQJUHDG\
&RQQHFWWRWKHGDWDEDVHVHUYHUZLWK\RXUDGPLQLVWUDWLYHDFFRXQW
+RZWRGRLW

'RZQORDGWKHVDPSOHVFULSWIRUWKLVFKDSWHUIURPWKHERRN
VZHEVLWHDQGVDYH
LWWR\RXUORFDOGLVN,QWKHH[DPSOHEHORZZHZLOODVVXPHLWLVVWRUHGLQ/tmp/
idxsizeestimate_sample.sql

&UHDWHDQHZGDWDEDVHDQGPDNHLWWKHGHIDXOWGDWDEDVH
CREATE DATABASE pktests;
USE pktests;

,PSRUWWKHVDPSOHGDWDIURPWKHGRZQORDGHGÀOH:KHQGRQH\RXZLOOEHSUHVHQWHG
ZLWKVRPHVWDWLVWLFVDERXWWKHWZRWDEOHVORDGHG1RWHWKDWERWKWDEOHVKDYHDQ,QGH[
/HQJWKRI
SOURCE /tmp/idxsizeestimate_sample.sql;

,QGH[LQJ


1RZZLWKWKHVDPSOHWDEOHVSUHVHQWDGGDQLQGH[WRHDFKRIWKHP
ALTER TABLE LongCharKey ADD INDEX IDX_PAY_10(Payload(10)); 
ALTER TABLE LongCharKey10 ADD INDEX IDX_PAY_10(Payload(10));

'LVSOD\WKHGDWDDQGLQGH[VL]HVRIWKHWDEOHVQRZ
SHOW TABLE STATUS LIKE 'LongCharKey%';

$GGDQRWKHULQGH[WRHDFKWDEOHWRPDNHWKHGLIIHUHQFHHYHQPRUHHYLGHQW
ALTER TABLE LongCharKey ADD INDEX IDX2_PAY_10(Payload(10)); 
ALTER TABLE LongCharKey10 ADD INDEX IDX2_PAY_10(Payload(10));

'LVSOD\WKHGDWDDQGLQGH[VL]HVRIWKHWDEOHVDJDLQDQGFRPSDUHZLWKWKHSUHYLRXV
YDOXHV
SHOW TABLE STATUS LIKE 'LongCharKey%';
1DPH
5RZV 
'DWD/HQJWK 
,QGH[/HQJWK 
,QGH['DWD5DWLR
/RQJ&KDU.H\




/RQJ&KDU.H\




:LWKWKHVHFRQGLQGH[DGGHGWKHGLIIHUHQFHLQLQGH[OHQJWKEHFRPHVHYHQFOHDUHU
+RZLWZRUNV
([HFXWLQJWKHGRZQORDGHGVFULSWZLOOVHWXSWZRWDEOHVZLWKWKHIROORZLQJVWUXFWXUHV
   CREATE TABLE `LongCharKey` (
  `LongChar` char(255) NOT NULL,
  `Payload` char(255) DEFAULT NULL,
   PRIMARY KEY (`LongChar`)
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1;
   CREATE TABLE `LongCharKey10` (
  `LongChar` char(255) NOT NULL,
  `Payload` char(255) DEFAULT NULL,
   PRIMARY KEY (`LongChar`(10))
   ) ENGINE=InnoDB DEFAULT CHARSET=latin1;
7KHWZRWDEOHVDUHDOPRVWLGHQWLFDOH[FHSWIRUWKHSULPDU\NH\GHÀQLWLRQ7KH\DUHSUHÀOOHG
ZLWKUHFRUGVRIVDPSOHGDWD
7KHWDEOHVDUHSRSXODWHGZLWKH[DFWO\WKHVDPHUHFRUGVRISVHXGRUDQGRPGDWD7KH
PayloadFROXPQLVÀOOHGZLWKVHTXHQFHVRIUDQGRPOHWWHUVHDFK7KHLongCharFROXPQ
LVÀOOHGZLWKDVHTXHQWLDOQXPEHULQWKHÀUVWFKDUDFWHUVDQGWKHQÀOOHGXSWRXVHDOO
UHPDLQLQJFKDUDFWHUZLWKWKHVDPHVRUWRIUDQGRPGDWD

&KDSWHU

SELECT LEFT(LongChar,20), LEFT(Payload, 20) from LongCharKey LIMIT 5;
/()7/RQJ&KDU
/()73D\ORDG
.($)$<9(-'
5+6.0(-,729%329$*2*0
:66*.*0,-5
9$5/*2<(216/(-979<53
501&)%-67/
29:*776+(4+-+7+0)(;9
6$49246,14
$+'<8;7$(:56+&/-<60:
$/+<8'65%+
'3/3;-9(5<+82<**8)26
:KLOHWKH/RQJ.H\&KDUWDEOHVLPSO\PDUNVWKHZKROH/RQJ&KDUFROXPQDVDSULPDU\NH\ZLWK
LWVHQWLUHFKDUDFWHUVOHQJWKWKH/RQJ&KDU.H\WDEOHOLPLWVWKHSULPDU\NH\WRWKHÀUVW
FKDUDFWHUVRIWKDWFROXPQ7KLVLVSHUIHFWO\ÀQHIRUWKLVWDEOHEHFDXVHWKHWHVWGDWDZDV
FUDIWHGWREHXQLTXHLQWKLVUDQJH
1HLWKHURQHRIWKHWZRWDEOHVKDVDQ\VHFRQGDU\LQGH[HVGHÀQHG/RRNLQJDWVRPHUHOHYDQW
WDEOHGDWDVKRZVWKH\DUHHTXDOO\ELJVRPHFROXPQVOHIWRXWIRUEUHYLW\
SHOW TABLE STATUS LIKE 'LongCharKey%';
1DPH
5RZV
'DWD/HQJWK 
,QGH[/HQJWK
/RQJ&KDU.H\



/RQJ&KDU.H\



:LWKHDFKLQGH[DGGHGWKH,QGH[/HQJWKIRUWKHÀUVWWDEOHZLOOLQFUHDVHVLJQLÀFDQWO\ZKLOHIRU
WKHVHFRQGRQHLWVJURZWKLVPXFKVORZHU
,QFDVHRIWKH/RQJ&KDU.H\WDEOHHDFKVHFRQGDU\LQGH[UHFRUGZLOOFDUU\DURXQGZLWKLWD
FRPSOHWHFRS\RIWKH/RQJ&KDUFROXPQEHFDXVHLWLVWKHSULPDU\NH\ZLWKRXWOLPLWDWLRQ
$VVXPLQJDVLQJOHE\WHFKDUDFWHUHQFRGLQJWKLVPHDQVHYHU\VHFRQGDU\LQGH[UHFRUGLVEORZQ
XSLQVL]HE\E\WHVRQWRSRIWKHE\WHVQHHGHGIRUWKHDFWXDOLQGH[HQWU\7KLVPHDQVD
ZKROHNLORE\WHLVVSHQWMXVWIRUWKHSULPDU\NH\UHIHUHQFHIRUHYHU\UHFRUGV
,QFRQWUDVWWRWKDWWKHSULPDU\NH\GHÀQLWLRQRIWKH/RQJ&KDU.H\WDEOHRQO\LQFOXGHVWKH
OHDGLQJFKDUDFWHUVRIWKH/RQJ&KDUFROXPQPDNLQJWKHVHFRQGDU\LQGH[HQWU\E\WHV
VKRUWHUDQGWKHUHE\H[SODLQLQJWKHPXFKVORZHUJURZWKXSRQDGGLQJIXUWKHULQGH[HV

,QGH[LQJ

&KRRVLQJ,QQR'%SULPDU\NH\FROXPQV
,QWKHFKDSWHULQWURGXFWLRQZHSURPLVHGWRVKHGVRPHOLJKWRQKRZWRFKRRVH\RXU,QQR'%
SULPDU\NH\FROXPQVVHQVLEO\%HDGYLVHGWKDWFKRRVLQJJRRGSULPDU\NH\FROXPQVLVQRW
DQH[DFWVFLHQFH³WKHUHDUHPXOWLSOHDVSHFWVWKDWLQÁXHQFHWKLVGHFLVLRQ'HSHQGLQJRQ
\RXUQHHGVDQGSUHFRQGLWLRQV\RXZLOOZDQWWRSULRULWL]HWKHPGLIIHUHQWO\IURPRQHWDEOHWR
WKHQH[W&RQVLGHUWKHIROORZLQJDVJHQHUDODGYLFHUDWKHUWKDQKDUGUXOHVWKDWPXVWEH
REH\HGXQFRQGLWLRQDOO\
*HWWLQJUHDG\
,QRUGHUWRPDNHUHDVRQDEOHGHFLVLRQVRQSULPDU\NH\FROXPQVLWLVLPSRUWDQWWRKDYHD
YHU\FOHDUXQGHUVWDQGLQJRIZKDWWKHGDWDORRNVOLNHLQWKHWDEOHDWKDQG,I\RXDOUHDG\KDYH
H[LVWLQJGDWDWKDWLVWREHVWRUHGLQDQ,QQR'%WDEOH³IRUH[DPSOHLQ0\,6$0IRUPDW³LWFDQEH
KHOSIXOWRFRPSDUHLWZLWKWKHFULWHULDEHORZ
,I\RXDUHSODQQLQJDQHZVFKHPD\RXPLJKWKDYHWRJXHVVDERXWVRPHFKDUDFWHULVWLFVRIWKH
IXWXUHGDWD$VLVRIWHQWKHFDVHWKHTXDOLW\RI\RXUFKRLFHVLVGLUHFWO\SURSRUWLRQDOWRKRZ
JRRGWKRVHJXHVVHVDUH
7KLVUHFLSHLVOHVVVWULFWVWHSE\VWHSLQVWUXFWLRQVWKDWPXVWEHIROORZHGIURPWRSWRERWWRP
DQGVKRXOGEHFRQVLGHUHGDOLVWRISURSHUWLHVDJRRGSULPDU\NH\VKRXOGKDYHHYHQWKRXJK
\RXPLJKWGHFLGHVRPHRIWKHPGRQRWDSSO\WR\RXUDFWXDOHQYLURQPHQW$VDUXOHRIWKXPE
KRZHYHUDFROXPQWKDWIXOÀOOVDOORUPRVWRIWKHDWWULEXWHVGHVFULEHGEHORZLVPRVWSUREDEO\
DVHQVLEOHFKRLFHIRUDSULPDU\NH\6HHWKH+RZLWZRUNVVHFWLRQIRUGHWDLOVRQWKH
LQGLYLGXDOLWHPV
+RZWRGRLW
 ,GHQWLI\XQLTXHDWWULEXWHV7KLVLVDQDEVROXWHWHFKQLFDOUHTXLUHPHQWIRUSULPDU\
NH\VLQJHQHUDO$Q\GDWDDWWULEXWHWKDWLVQRWVWULFWO\JXDUDQWHHGWREHIUHHRI
GXSOLFDWHVFDQQRWEHXVHGDORQHDVDSULPDU\NH\
 ,GHQWLI\LPPXWDEOHDWWULEXWHV:KLOHQRWDEVROXWHO\QHFHVVDU\DJRRGSULPDU\NH\LV
QHYHUFKDQJHGRQFHLWKDVEHHQDVVLJQHG)RUDOOLQWHQWVDQGSXUSRVHV\RXVKRXOG
DYRLGFROXPQVWKDWKDYHHYHQDVPDOOFKDQFHRIEHLQJFKDQJHGIRUH[LVWLQJUHFRUGV
 8VHUHDVRQDEO\VKRUWNH\V7KLVLVWKHVRIWHVWFULWHULRQRIDOO,QJHQHUDOORQJHUNH\V
KDYHQHJDWLYHLPSDFWVRQRYHUDOOGDWDEDVHSHUIRUPDQFH³WKHORQJHUWKHZRUVH$OVR
FRQVLGHUDSUHÀ[SULPDU\NH\6HH8VLQJSUHÀ[SULPDU\NH\VHDUOLHULQWKLVFKDSWHUIRU
PRUHLQIRUPDWLRQ
 3UHIHUVLQJOHFROXPQNH\V(YHQWKRXJKQRWKLQJSUHYHQWV\RXIURPFKRRVLQJ
DFRPSRVLWHSULPDU\NH\DFRPELQDWLRQRIFROXPQVWKDWWRJHWKHUIRUPWKHXQLTXH
QHVVWKLVFDQHDVLO\EHFRPHDKDVVOHWRZRUNZLWKHVSHFLDOO\ZKHQKDQGOLQJ
IRUHLJQNH\V

&KDSWHU

 &RQVLGHUWKHFOXVWHUHGLQGH[QDWXUHRIWKHSULPDU\NH\$V,QQR'%
VSULPDU\NH\LV
DOVRFOXVWHUHG\RXVKRXOGWDNHWKLVVSHFLDOQDWXUHLQWRDFFRXQWDVZHOO,WFDQVSHHG
XSUHDGDFFHVVDORWLI\RXRIWHQKDYHWRTXHU\IRUNH\UDQJHVEHFDXVHGLVNVHHN
WLPHVZLOOEHPLQLPL]HG
+RZLWZRUNV
,QWKHIROORZLQJVHFWLRQVZHZLOOWU\WRVKHGVRPHOLJKWRQZKDWHDFKVWHSRIWKHUHFLSHLV
FRQFHUQHGZLWKLQDOLWWOHPRUHGHWDLO
8QLTXHQHVV
$QDEVROXWHUHTXLUHPHQWIRUSULPDU\NH\VLVWKHLUXQLTXHQHVV(YHU\UHFRUGLQ\RXUWDEOH
ZLOOKDYHWRKDYHDGLVWLQFWYDOXHIRUSULPDU\NH\V2WKHUZLVHQHLWKHU0\64/QRUDQ\RWKHU
GDWDEDVHSURGXFWIRUWKDWPDWWHUFRXOGEHVXUHDERXWZKHWKHULWZDVRSHUDWLQJRQH[DFWO\
WKHULJKWURZVZKHQH[HFXWLQJ\RXUTXHULHV
8VXDOO\PRVWHQWLWLHV\RXPLJKWZDQWWRVWRUHLQDUHODWLRQDOGDWDEDVHKDYHVRPHVRUWRI
XQLTXHFKDUDFWHULVWLFVWKDWPLJKWEHDVXLWDEOH3ULPDU\NH\,IWKH\GRQRW\RXFDQDOZD\V
DVVLJQDVRFDOOHGVXUURJDWHNH\IRUHDFKUHFRUG2IWHQWKLVLVVRPHVRUWRIXQLTXHQXPHULF
YDOXHHLWKHUJHQHUDWHGE\DQDSSOLFDWLRQZRUNLQJRQWRSRIWKHGDWDEDVHRU0\64/LWVHOIXVLQJ
DQ$872B,1&5(0(17FROXPQ
,PPXWDELOLW\
3ULPDU\NH\FROXPQVVKRXOGJHQHUDOO\EHYLUWXDOO\LPPXWDEOHWKDWLVXQGHUQRFLUFXPVWDQFHV
VKRXOG\RXKDYHWRPRGLI\WKHLUYDOXHVRQFHWKH\DUHLQVHUWHGLQWRWKHGDWDEDVH
,QRXUERRNVH[DPSOHWKH,6%1QXPEHUFDQQRWEHFKDQJHGRQFHDERRNKDVEHHQSXEOLVKHG
7KHVDPHZRXOGDSSO\IRUDFDU
VFKDVVLVQXPEHU
7HFKQLFDOO\RIFRXUVHWKH\FDQEHFKDQJHGDIWHUWKHLUFUHDWLRQ+RZHYHUWKLVZLOOEHYHU\
GLIÀFXOWWRSHUIRUPLQSUDFWLFHRQFHWKHRULJLQDOYDOXHKDVEHHQXVHGWRHVWDEOLVKIRUHLJQNH\
UHODWLRQVKLSVEHWZHHQWDEOHV,QWKHVHFDVHV\RXZLOORIWHQKDYHWRUHYHUWWRFRPSOLFDWHGDQG
HYHQXQVDIHPHWKRGVULVNLQJGDWDLQFRQVLVWHQFLHVWRSHUIRUPWKHFKDQJHV
0RUHRYHUDVWKHSULPDU\NH\LVVWRUHGDVDFOXVWHUHGNH\LQ,QQR'%FKDQJLQJLWVYDOXHZLOO
UHTXLUHWKHZKROHUHFRUG³LQFOXGLQJDOOFROXPQV³WREHPRYHGWRLWVQHZORFDWLRQRQGLVN
FDXVLQJDGGLWLRQDOGLVN,2
1RWHWKDWVRPHWLPHVFROXPQVWKDWPD\DWÀUVWVHHPFRQVWDQWRYHUWLPHUHDOO\DUHQRW)RU
H[DPSOHFRQVLGHUDSHUVRQ
VVRFLDOVHFXULW\QXPEHU,WLVGHVLJQHGWREHXQLTXHDQGFDQ
QHYHUFKDQJHRUEHUHDVVLJQHGWRDGLIIHUHQWKXPDQEHLQJ&RQVHTXHQWLDOO\LWZRXOGVHHP
OLNHDJRRGFKRLFHIRUSULPDU\NH\LQDWDEOHRISHRSOH

,QGH[LQJ

%XWFRQVLGHUWKDWLQPRVWFDVHVGDWDZLOOEHHQWHUHGLQWRWKHGDWDEDVHPDQXDOO\³EHLW
WKURXJKIRUPVWH[WÀOHLPSRUWVDPRQJRWKHUV,QVRPHIRUPRUDQRWKHUVRPHRQHZLOOKDYH
W\SHGLWLQWKURXJKDNH\ERDUG
0DQXDOLQSXWLVE\GHÀQLWLRQDQHUURUSURQHSURFHVV6R\RXPLJKWHQGXSZLWKDSHUVRQ
V
UHFRUGWKDWKDVWZRGLJLWVWUDQVSRVHGLQWKHLUSULPDU\NH\VRFLDOVHFXULW\QXPEHUZLWKRXW
LPPHGLDWHO\NQRZLQJLW*UDGXDOO\WKLVZURQJYDOXHZLOOVSUHDGWKURXJK\RXUGDWDEDVH³LWZLOO
EHXVHGLQIRUHLJQNH\UHODWLRQVKLSVIRUPLQJFRPSOH[GDWDVWUXFWXUHV:KHQ\RXODWHUÀQGRXW
DERXWWKHHUURU³IRUH[DPSOHEHFDXVHDQRWKHUSHUVRQZKRUHDOO\RZQVWKDWQXPEHUQHHGVWR
EHLQVHUWHG³WKHQ\RXDUHIDFLQJDUHDOSUREOHP
8QOHVV\RXDUHDEVROXWHO\DQGSRVLWLYHO\VXUHDYDOXHFDQQHYHUFKDQJHRQFHLWKDVEHHQ
DVVLJQHGWRDUHFRUG\RXVKRXOGFRQVLGHUDGGLQJDQHZFROXPQWR\RXUWDEOHDQGXVHD
VXUURJDWHNH\IRUH[DPSOHDQDXWRLQFUHPHQWLQJQXPEHU
.H\OHQJWK
7KHUHDUHVHYHUDOUHDVRQVIRUNH\VEHLQJDVVKRUWDVSRVVLEOH,QQR'%EDVLFDOO\RQO\XVHVRQH
VLQJOHODUJHKHDSRIPHPRU\³WKHEXIIHUSRRO³IRULWVFDFKLQJSXUSRVHV,WLVXVHGIRUERWKURZ
DQGLQGH[GDWDZKLFKDUHVWRUHGDVPHPRU\FDFKHGFRSLHVRILQGLYLGXDOSDJHVVWUDLJKWIURP
WKHWDEOHVSDFHGDWDÀOHV7KHVKRUWHUHDFKNH\YDOXHLVWKHPRUHRIWKHPÀWLQWRDVLQJOH
GDWDSDJHWKHGHIDXOWVL]HLV.%)RUDQLQGH[ZLWKE\WHVSHULQGH[YDOXHDVLQJOH
SDJHZLOOFRQWDLQDERXWDWKRXVDQGLQGH[HQWULHV)RUDQLQGH[ZLWKRQO\E\WHVSHUHQWU\
WZLFHDVPDQ\YDOXHVFDQEHFDFKHGLQWKHVDPHDPRXQWRIVSDFH6RWRXWLOL]HWKHHIIHFWV
RIPHPRU\EDVHGFDFKLQJVPDOOHULQGH[HVDUHEHWWHU
)RUWKHGDWDUHFRUGDVDZKROHWKHUHPLJKWQRWEHPXFKRIDGLIIHUHQFHEHWZHHQRUE\WHV
FRPSDUHGZLWKWKHRYHUDOOUHFRUGOHQJWK%XWUHPHPEHURUUHIHUWRWKHFKDSWHULQWURGXFWLRQ
LI\RXGRQ
WWKDWWKHSULPDU\NH\OHQJWKLVDGGHGWRHDFKVHFRQGDU\LQGH[
VOHQJWKDJDLQ)RU
H[DPSOHDVHFRQGDU\LQGH[RQDQE\WHÀHOGZLOODFWXDOO\EHE\WHVORQJLIWKHSULPDU\NH\
DOVRKDVE\WHVSHUHQWU\$.%GDWDSDJHZRXOGSURYLGHVSDFHIRUURXJKO\LQGH[
HQWULHVLQWKLVVFHQDULR,IWKHSULPDU\NH\LVE\WHVORQJLWZRXOGRQO\EHVXIÀFLHQWIRUDERXW
HQWULHVUHGXFLQJWKHHIIHFWLYHQHVVRIFDFKHPHPRU\
6LQJOHFROXPQNH\V
'HSHQGLQJRQWKHGDWD\RXLQWHQGWRVWRUHLQDQ,QQR'%WDEOH\RXPLJKWFRQVLGHUXVLQJD
FRPSRVLWHSULPDU\NH\7KLVPHDQVWKDWQRVLQJOHFROXPQ
VYDOXHDORQHXQLTXHO\LGHQWLÀHVD
VLQJOHUHFRUGEXWRQO\WKHFRPELQDWLRQRIVHYHUDOLQGHSHQGHQWFROXPQVDOORZVXQLTXHQHVV
)URPDWHFKQLFDOSRLQWRIYLHZWKLVLVSHUIHFWO\IHDVLEOHDQGPLJKWHYHQEHDJRRGFKRLFHIURP
DVHPDQWLFSRLQWRIYLHZ

&KDSWHU

+RZHYHU\RXVKRXOGYHU\FDUHIXOO\ZHLJKWKHDOWHUQDWLYHVEHFDXVHFRPSRVLWHNH\VFDQTXLFNO\
EHFRPHDEXUGHQ7KHPRUHVHFRQGDU\WDEOHVGHÀQHIRUHLJQNH\UHODWLRQVKLSVZLWKDWDEOH
XVLQJDFRPSRVLWHSULPDU\NH\WKHPRUHFRPSOLFDWHG\RXUTXHULHVZLOOEHFRPHEHFDXVH
ZKHQHYHU\RXMRLQWKHWZR\RXKDYHWRGHÀQHDMRLQFRQGLWLRQRQDWOHDVWIRXUFROXPQV)RU
PRUHFRPSOH[TXHULHVZLWKPXOWLSOHMRLQVWKLVTXLFNO\EHFRPHVYHU\KDUGWRPDLQWDLQDQG
WKHUHIRUHFDUULHVDJUHDWULVNRIHUURUVWKDWPLJKWEHKDUGWRÀQG
,QDGGLWLRQ\RXDOVRKDYHWRFRQVLGHUWKHLQFUHDVHGVL]HRIHDFKNH\HQWU\DQGWKDWWKHVL]HV
RIDOOWKHSDUWLFLSDWLQJFROXPQVPXVWEHDGGHG
$VJHQHUDODGYLFH\RXVKRXOGGHÀQLWHO\FRQVLGHUXVLQJDVXUURJDWHNH\ZKHQ\RXFDQQRWÀQG
DQ\FDQGLGDWHWKDWIXOÀOOVWKHRWKHUFULWHULDMXVWGLVFXVVHG
&OXVWHUHG,QGH[
$VGDWDLVSK\VLFDOO\VWRUHGRQGLVNLQWKHRUGHURIWKHFOXVWHUHGNH\VLPLODUNH\YDOXHVHQGXS
LQQHLJKERULQJORFDWLRQV7KLVPDNHVFOXVWHUHGLQGH[HVYHU\HIÀFLHQWIRUTXHULHVWKDWUHWULHYH
UDQJHVRIUHFRUGVE\WKLVNH\,IIRUH[DPSOHWKHFOXVWHUHGNH\LVDWLPHVWDPSRIVRPHVRUW
UHWULHYLQJDOOUHFRUGVZLWKLQDFRQWLJXRXVWLPHVSDQLVOLNHO\WRUHTXLUHUHODWLYHO\OLWWOHSK\VLFDO
GLVN,2EHFDXVHLGHDOO\DOOUHTXHVWHGUHVXOWURZVDUHVWRUHGLQWKHVDPHGDWDSDJHWKHUHIRUH
RQO\QHHGLQJDVLQJOHUHDGRSHUDWLRQZKLFKPLJKWHYHQEHFDFKHG(YHQLIPXOWLSOHSDJHV
KDGWREHUHDGWKLVZLOORQO\UHTXLUHDVHTXHQWLDOUHDGRSHUDWLRQZKLFKOHYHUDJHVOLQHDUGLVN
UHDGSHUIRUPDQFHEHVW
8QIRUWXQDWHO\,QQR'%GRHVQRWDOORZDQRQSULPDU\NH\WREHFOXVWHUHG³RWKHU'%06GR³VR
\RXKDYHWRZHLJKWKHDOWHUQDWLYHVDQGPD\EHOLYHZLWKDFRPSURPLVHZKHQGHFLGLQJRQWKH
SULPDU\NH\IRU\RXU,QQR'%WDEOHV
6SHHGLQJXSVHDUFKHVIRUVXEGRPDLQV
,QDFROXPQZLWKGRPDLQHPDLODGGUHVVHVVHDUFKLQJIRUDOODGGUHVVHVRIDJLYHQGRPDLQLVD
QRQWULYLDOWDVNSHUIRUPDQFHZLVH*LYHQWKHIROORZLQJWDEOHVWUXFWXUHWKHRQO\ZD\WRÀQGDOO
DGGUHVVHV@gmail.comLVWRXVHDLIKETXHU\ZLWKDZLOGFDUG
SELECT * FROM clients WHERE email LIKE '%@gmail.com';
2IFRXUVHVWRULQJWKHDGGUHVVDQGGRPDLQSDUWVLQVHSDUDWHFROXPQVZRXOGVROYHWKLV
SDUWLFXODUSUREOHP%XWDVVRRQDV\RXZHUHDVNHGIRUDTXLFNZD\WRÀQGDOOFOLHQWVZLWKDQ
HPDLODGGUHVVIURPD%ULWLVKSURYLGHU\RXZRXOGEHRXWRIOXFNDJDLQUHVRUWLQJWR
SELECT * FROM clients WHERE maildomain LIKE '%.co.uk';
%RWKTXHULHVZRXOGFDXVHDIXOOWDEOHVFDQEHFDXVHQRLQGH[FDQVXSSRUWWKHZLOGFDUGDWWKH
EHJLQQLQJRIWKHVHDUFKWHUP

,QGH[LQJ

,QWKLVUHFLSH\RXZLOOEHJLYHQDVLPSOHEXWHIIHFWLYHDSSURDFKWRHQDEOHWKHXVHRILQGH[HV
IRUERWKRIWKHSUREOHPVMXVWSUHVHQWHG1RWLFHWKDW\RXZLOOQHHGWRPDNHPLQRUDGMXVWPHQWV
WRWKHTXHULHVVHQWDJDLQVWWKHGDWDEDVH7KLVPLJKWLQYROYHVRPHFRGHDGMXVWPHQWVLQ
\RXUDSSOLFDWLRQ
*HWWLQJUHDG\
7RLPSOHPHQWWKHLGHDVSUHVHQWHGKHUH\RXZLOOQHHGWRFRQQHFWWRWKHGDWDEDVHVHUYHU
ZLWK\RXUDGPLQLVWUDWLYHDFFRXQWIRUWKHVFKHPDPRGLÀFDWLRQV$SDUWIURPWKHGDWDEDVH
PRGLÀFDWLRQVDSSOLFDWLRQSURJUDPFRGHFKDQJHVZLOOEHQHFHVVDU\DVZHOODQG\RXVKRXOG
FRQWDFWDQDSSOLFDWLRQGHYHORSHU
+RZWRGRLW

,GHQWLI\ZKLFKFROXPQLVFXUUHQWO\XVHGWRVWRUHGRPDLQUHODWHGGDWD,QWKHH[DPSOH
ZHZLOOEHXVLQJWKHmaildomainFROXPQRIWKHclientsWDEOH

8SGDWHWKLVFROXPQDQGUHYHUVHWKHFRQWHQWVRIWKHÀHOGOLNHWKLV
UPDATE clients SET maildomain=REVERSE(maildomain);

,IQRWDOUHDG\VHWXSDGGDQLQGH[WRWKHFROXPQ
ALTER TABLE clients ADD INDEX IDXR_MAILDOMAIN(maildomain);

&KDQJHDOOTXHULHVLQ\RXUDSSOLFDWLRQDVIROORZV
%HIRUH
SELECT name, maildomain FROM clients WHERE maildomain LIKE 
 '%.co.uk';
$IWHU
SELECT name, REVERSE(maildomain) AS maildomain FROM clients WHERE 
 maildomain LIKE REVERSE('%.co.uk');
7KHSRLQWKHUHLVWRUHYHUVHWKHVHDUFKFRQGLWLRQDVZHOODVWKHFROXPQLQWKHFROXPQ
OLVWSELECTVWDWHPHQWVXVLQJWKHVWDUSODFHKROGHULQVWHDGRIFROXPQQDPHVQHHGWR
EHUHZULWWHQWRUHYHUVHWKHmaildomainFROXPQ
+RZLWZRUNV
,QGH[HVDUHGHVLJQHGWRVSHHGXSTXHULHVE\VRUWLQJWKHUHOHYDQWFROXPQFRQWHQWVZKLFK
PDNHVÀQGLQJUHFRUGVZLWKDJLYHQVHDUFKSUHÀ[HDV\
6HDUFKLQJIRUDOOSHRSOHZKRVHQDPHVWDUWVZLWKDQ6IRUH[DPSOHLVVXSSRUWHGE\WKLV
WHFKQLTXH7KHPRUHFKDUDFWHUV\RXSURYLGHWKHPRUHVSHFLÀFWKHVHDUFKJHWVDJDLQ
VXSSRUWHGLGHDOO\E\DQLQGH[

&KDSWHU

'RPDLQQDPHVDUHDGLIIHUHQWVWRU\KRZHYHUEHFDXVHWKRVHEHORQJLQJWRJHWKHUGRQRWVKDUH
DFRPPRQSUHÀ[EXWVXIÀ[7KHUHLVQRLPPHGLDWHZD\RIWHOOLQJ0\64/WRFUHDWHDQLQGH[
VXSSRUWLQJWKLVNLQGRIGDWD
7KHÀUVWLGHDWKDWFRPHVWRPLQGWRZRUNDURXQGWKLVZRXOGEHWRXVHDTXHU\DORQJWKH
OLQHVRI
        SELECT * FROM clients
        WHERE REVERSE(maildomain) LIKE 'ku.oc.%';
8QIRUWXQDWHO\0\64/³LQFRQWUDVWWRRWKHU'%06³FDQQHLWKHUXVHLQGH[HVLQFRQMXQFWLRQZLWK
IXQFWLRQVOLNHREVERSE()QRUFUHDWHDQLQGH[EDVHGRQDIXQFWLRQLQWKHÀUVWSODFH,QVWHDG
LWUHVRUWVWRIXOOWDEOHVFDQVWRÀQGWKHUHVXOWVDVVRRQDVLWHQFRXQWHUVDIXQFWLRQFDOODSSOLHG
WRDFROXPQLQDTXHU\
VWHEREFODXVH,QWKLVFDVHWKHREVERSE()IXQFWLRQLVDSSOLHGWRWKH
maildomainFROXPQ
:LWKDPLQRUDGMXVWPHQWWRWKHZD\GDWDLVVWRUHGWKLVOLPLWDWLRQFDQEHDOOHYLDWHGKRZHYHU
VWRUHWKHGDWDEDFNZDUGVLQWKHÀUVWSODFH
:KHQLQVHUWLQJQHZGDWDLQWRWKHWDEOHZHUHYHUVHLWÀUVW
        INSERT INTO clients (maildomain, …)
        VALUES (REVERSE('example.co.uk'), …);
:KHQUHWULHYLQJGDWDODWHUZHMXVWQHHGWRUHDSSO\WKHVDPHIXQFWLRQWRJHWEDFNDWWKH
RULJLQDOGDWD
        SELECT REVERSE(maildomain) FROM clients
        WHERE maildomain LIKE REVERSE('%.co.uk');
$VQRZWKHTXHU\FRQGLWLRQGRHVQRWFRQWDLQDIXQFWLRQFDOORQDFROXPQDQ\PRUH0\64/LV
KDSS\WRXVHDQLQGH[RQWKHmaildomainFROXPQWRVSHHGXSWKHVHDUFK
,WPLJKWVHHPRGGDWÀUVWWKDWQRZHYHQZLWKWZRFDOOVWRWKHREVERSE()IXQFWLRQWKLVTXHU\
FDQLQIDFWXVHDQLQGH[
7KHNH\SRLQWLVWKDW0\64/GRHVQRWKDYHWRDSSO\WKHIXQFWLRQRQDQ\
FROXPQGDWDEXWRQO\RQWKHFRQVWDQWFRQGLWLRQWKH'%.co.uk'VWULQJ
DQGODWHU³ZKHQWKHURZVKDYHDOUHDG\EHHQIHWFKHG³RQWKHDOUHDG\UHWULHYHG
UHYHUVHFROXPQFRQWHQWRImaildomain%RWKRIWKHVHDUHQRWDSUREOHPIRU
LQGH[XVH
7KHTXHU\LVUHDOO\H[HFXWHGLQWZRSKDVHV,QWKHÀUVWSKDVH0\64/ZLOOKDYHDORRNDWWKH
FRQGLWLRQDQGFKHFNLILWFDQUHSODFHDQ\IXQFWLRQFDOOZLWKFRQVWDQWV6RZKHQZHZULWH
        SELECT REVERSE(maildomain) FROM clients 
        WHERE maildomain LIKE REVERSE('%.co.uk');

,QGH[LQJ

DIWHUWKHÀUVWSKDVHLQWHUQDOO\WKHTXHU\ORRNVOLNHWKLV
         SELECT REVERSE(maildomain) FROM clients
         WHERE maildomain LIKE 'ku.oc.%';
,QWKLVTXHU\WKHUHLVQRIXQFWLRQFDOOOHIWLQWKHFRQGLWLRQ6RWKHLQGH[RQWKHmaildomain
FROXPQFDQEHXVHGVSHHGLQJXSWKHH[HFXWLRQDVGHVLUHG
7KHUH
VPRUH
,I\RXUDSSOLFDWLRQW\SLFDOO\LVVXHVTXHULHVWKDWQHHGWRUHWULHYHFRQWLJXRXVUDQJHVRI
GRPDLQV³DVLQWKHSUHFHGLQJH[DPSOH³\RXPLJKWFRQVLGHUXVLQJWKHUHYHUVHGGRPDLQQDPH
DVSULPDU\DQGWKHUHIRUHFOXVWHUHGNH\
7KHDGYDQWDJHZRXOGEHWKDWWKHUHODWHGUHFRUGVZRXOGEHVWRUHGFORVHO\WRJHWKHURQGLVNLQ
WKHVDPHRUDGMDFHQWGDWDSDJHV
+RZHYHUXSGDWLQJDQH[LVWLQJWDEOHRQLWVSULPDU\NH\FROXPQFDQEHERWK
YHU\WLPHFRQVXPLQJDVDOOGDWDURZVQHHGWREHSK\VLFDOO\UHDUUDQJHGDQG
VRPHWLPHVFRPSOLFDWHGWRGRZKHQIRUHLJQNH\FRQVWUDLQWVDUHLQSODFH
6HHDOVR
f
&KRRVLQJ,QQR'%SULPDU\NH\FROXPQV
)LQGLQJGXSOLFDWHLQGH[HV
2YHUWLPHGDWDEDVHVFKHPDWDDUHVXEMHFWWRFKDQJHVVXFKDVLQGH[DGGLWLRQVDQGGHOHWLRQV
,WLVQRWXQFRPPRQWRHQGXSZLWKPXOWLSOHLQGH[HVWKDWDUHHTXLYDOHQWLQWHUPVRITXHU\
H[HFXWLRQEXWPLJKWEHGHÀQHGZLWKGLIIHUHQWQDPHVRUHYHQGLIIHUHQWFROXPQV
7KLVGXSOLFDWLRQRILQGH[HVKDVQHJDWLYHFRQVHTXHQFHVIRU\RXUGDWDEDVH
f
,QFUHDVHGVL]H7KHPRUHWKHLQGH[HVWKHELJJHUWKHGDWDEDVH
f
/RZHUSHUIRUPDQFH(DFKLQGH[KDVWREHXSGDWHGRQPRGLÀFDWLRQVRIWKHUHVSHFWLYH
WDEOHZDVWLQJSUHFLRXV,2DQG&38UHVRXUFHV
f
,QFUHDVHGVFKHPDFRPSOH[LW\6FKHPDPDLQWHQDQFHDQGXQGHUVWDQGLQJRIWKH
WDEOHVDQGUHODWLRQVKLSVJHWVPRUHFRPSOLFDWHG
)RUWKRVHUHDVRQV\RXVKRXOGEHFRQFHUQHGDERXWVXSHUÁXRXVLQGH[HV
,QWKLVUHFLSHZHZLOOSUHVHQWDZD\WRTXLFNO\ÀQGRXWZKLFKLQGH[HVFDQEHGURSSHGIURPD
WDEOHDVWKH\DUHIXQFWLRQDOO\HTXLYDOHQWLIQRWQHFHVVDULO\IRUPDOO\LGHQWLFDOWRDQRWKHURQH

&KDSWHU

*HWWLQJUHDG\
,QRUGHUWRUXQWKHSURJUDPSUHVHQWHGKHUH\RXZLOOQHHGD-DYD5XQWLPH(QYLURQPHQW-5(RU
MXVW-DYDLQVWDOOHG<RXFDQGRZQORDGLWIRUIUHHIURPhttp://www.java.com.
'RZQORDGWKH,QGH[$QDO\]HUIRU0\64/IURPWKHERRN
VZHEVLWH
<RXZLOODOVRQHHGORJLQFUHGHQWLDOVZLWKDGPLQLVWUDWLYHSULYLOHJHVIRUWKHVHUYHUDQGWKH
GDWDEDVH\RXZDQWWRDQDO\]H
+RZWRGRLW
 /DXQFKWKHGRZQORDGHGDSSOLFDWLRQE\GRXEOHFOLFNLQJLWVLFRQ7KHFRQQHFWLRQ
ZLQGRZZLOODSSHDU

(QWHUWKHFRQQHFWLRQGDWDIRU\RXU0\64/VHUYHUDQGVSHFLI\WKHGDWDEDVHWRFKHFN
,I\RXOLNH\RXFDQVWRUHWKHVHVHWWLQJVIRUODWHUXVH

+LWWKH&RQQHFWEXWWRQ7KHDQDO\VLVZLOOEHJLQ6WDQGE\³WKLVPLJKWWDNHDPLQXWHRU
WZRGHSHQGLQJRQWKHQXPEHURIWDEOHVFROXPQVDQGLQGH[HVLQWKDWGDWDEDVH

,QGH[LQJ


:KHQWKHDQDO\VLVLVFRPSOHWHUHYLHZWKHSURSRVHGFKDQJHVWKHWRROPDNHV$SDUW
IURPWKHWUHHOLNHGLVSOD\\RXFDQXVHWKH*HQHUDWH64/EXWWRQWRFRS\ALTER 
TABLEVWDWHPHQWVWRHLWKHUWKHFOLSERDUGRUDÀOHWKDWZLOODSSO\WKHFKDQJHV
VXJJHVWHGWRWKHGDWDEDVH
0DNHVXUH\RXGRQRWMXVWEOLQGO\H[HFXWHWKHSURSRVHGVWDWHPHQWV
DJDLQVW\RXUGDWDEDVH
<RXPXVWDOZD\VFDUHIXOO\UHYLHZDQ\WKLQJWKDWDQDXWRPDWHGWRRO
VXJJHVWV\RXGRWR\RXUGDWD1RSURJUDPFDQUHSODFH\RXUSURIHVVLRQDO
MXGJPHQWDERXWZKHWKHURUQRWDQLQGH[LVREVROHWHRUUHTXLUHGIRU
VRPHVSHFLÀFUHDVRQEH\RQGWKHFRPSXWHU
VXQGHUVWDQGLQJ
+RZLWZRUNV
7KH,QGH[$QDO\]HUIRU0\64/WRROFRQQHFWVWR\RXUGDWDEDVHDQGUHWULHYHVLQIRUPDWLRQ
DERXWWKHLQGH[HVGHÀQHGLQWKHGDWDEDVH\RXVSHFLÀHG,WWKHQFKHFNVIRULQGH[HVWKDWDUH
UHGXQGDQWFRPSDUHGZLWKRQHRUPRUHRIWKHRWKHUV,WZLOOGHWHFWWKHIROORZLQJVLWXDWLRQV
f
7ZRLQGH[HVDUHFRPSOHWHO\LGHQWLFDO
f
2QHLQGH[LVDSUHÀ[RIDVHFRQGORQJHURQH$V0\64/FDQXVHWKHVHFRQGRQHIRU
WKHVDPHTXHULHVLJQRULQJWKHVXSHUÁXRXVFROXPQVWKHVKRUWHULQGH[LVUHGXQGDQW

&KDSWHU

$QLQGH[RQDQ,QQR'%WDEOHLVGHÀQHGVRWKDWLWHQGVZLWKWKHSULPDU\NH\FROXPQV$V
0\64/LQWHUQDOO\DSSHQGVWKHSULPDU\NH\FROXPQVWKH\VKRXOGEHUHPRYHGIURPWKHH[SOLFLW
GHÀQLWLRQ7KHWUHHGLVSOD\
VURRWQRGHLVWKHGDWDEDVH\RXVHOHFWHGIROORZHGE\WKHWDEOHV
ZLWKUHGXQGDQWLQGH[HV)RUHDFKWDEOHRQHRUPRUHGHWDLOQRGHVGHVFULEHWKHDQDO\VLV
UHVXOWVLQWHUPVRIZKLFKLQGH[LVPDGHREVROHWHE\ZKLFKRWKHU
(DFKQRGHDOVRFRQWDLQVDURXJKHVWLPDWHRQKRZPXFKVSDFHFRXOGEHVDYHGE\GURSSLQJWKH
UHGXQGDQWLQGH[1RWHWKDWWKLVLVMXVWDEDOOSDUNÀJXUHWRJHWDQLGHD,QWKHH[DPSOHHDUOLHU
WKHDFWXDOVDYLQJVDUHORZHUDFFRUGLQJWRWKHVWDWLVWLFV0\64/RIIHUVYLDWKHSHOW TABLE 
STATUSFRPPDQG
7DEOH,QGH[
,QGH[6L]HEHIRUH
(VWLPDWHG6DYLQJV 
$FWXDO6DYLQJV
GHSWBHPSHPSBQR
0%
0%
0%
GHSWBPDQDJHU
HPSBQR
N
E\WHV
N
6DODULHVHPSBQR
0%
0%
0%
7LWOHVHPSBQR
0%
0%
0%
$OOWDEOHVZHUHGHÀQHGZLWKDQH[WUDLQGH[RQWKHHPSBQRFROXPQZKLFKZDVPDGHREVROHWH
E\WKHSULPDU\NH\1RWHWKDWWKHGLIIHUHQFHEHWZHHQHVWLPDWHGDQGDFWXDOVDYLQJVLVPRVW
VLJQLÀFDQW7KLVLVEHFDXVH0\64/HVWLPDWHVDUHEDVHGRQPXOWLSOHVRIWKHGDWDSDJHVL]H³
.%³ZKLOHWKH,QGH[$QDO\]HUDSSOLFDWLRQXVHVDYHUDJHFROXPQOHQJWKV
7KHUH
VPRUH
$SDUWIURPWKH,QGH[$QDO\]HUIRU0\64/DYDLODEOHIURPWKLVERRN
VZHEVLWHWKHUHDUHRWKHU
WRROVDYDLODEOHIRUWKHVDPHSXUSRVHDVZHOO,I\RXGRQRWZDQWWRRUFDQQRWLQVWDOOD-DYD
5XQWLPH(QYLURQPHQW\RXPLJKWEHPRUHFRQWHQWZLWK0DDWNLW
VPNGXSOLFDWHNH\FKHFNHU,W
LVDIUHHFRPPDQGOLQHWRROEDVHGRQ3HUODQGFDQEHXVHGRQDYDULHW\RISODWIRUPVDVZHOO
<RXFDQJHWLWIURPhttp://www.maatkit.org LQFOXGLQJWKHIXOOGRFXPHQWDWLRQ



7RROV
,QWKLVFKDSWHUZHZLOOGLVFXVVDERXW
f
7UDQVIHUULQJFRQQHFWLRQVHWWLQJVEHWZHHQGLIIHUHQWPDFKLQHVXVLQJDQHWZRUNVKDUH
f
6RUWLQJ0\64/*8,7RROV
VWRUHGFRQQHFWLRQV
f
$XWRPDWLFDOO\FUHDWLQJVWRUHGFRQQHFWLRQV
f
$GGLQJFXVWRPJUDSKVWR0\64/$GPLQLVWUDWRU
f
'LVSOD\LQJTXHU\UHVXOWVSDJHE\SDJHDQGZLWKVFUROOLQJXVLQJWKHmysql
FRPPDQGOLQHFOLHQW
f
([WUDFWLQJLQIRUPDWLRQIURPYHUERVHRXWSXWXVLQJWKHmysqlFRPPDQGOLQHFOLHQW
f
6SHFLI\LQJDGHIDXOWSDJHU
f
8VLQJDFXVWRPSURPSWWRGLVWLQJXLVKFRQQHFWLRQV
f
(QFU\SWLQJD0\64/VHUYHUFRQQHFWLRQZLWK66+
f
&UHDWLQJDQHQFU\SWHG0\64/FRQVROHYLD66+
f
8VLQJD3X77<WHPSODWHFRQQHFWLRQIRU66+VHFXUHGFRQQHFWLRQV
,QWURGXFWLRQ
(YHU\RQHH[SHFWVD'%$WRNHHSGDWDEDVHVHUYHUVUXQQLQJVPRRWKO\GD\LQDQGGD\RXW
KDQGLQJRXWGDWDWRPD\EHWKRXVDQGVRIFOLHQWVRUHYHQPRUHVLPXOWDQHRXVO\TXLFNO\
DQGUHOLDEO\
$SDUWIURPDVROLGNQRZOHGJHDERXWWKHLQQHUZRUNLQJVRIWKHVHUYHUV\RXPDQDJHZKDW
V
DVLPSRUWDQWDUHWKHWRROVDW\RXUGLVSRVDO7KH\HQDEOH\RXWRLQVSHFWDQGWXQHWKHVHUYHU
V
UXQQLQJSDUDPHWHUVFRQÀJXUDWLRQRSWLRQVDQGVRRQ

7RROV

:KLOHWKHUHLVDSOHWKRUDRIXWLOLWLHVDQGWRROVERWKIUHHDQGFRPPHUFLDO³HDFKRIWKHPZLWKLWV
UHVSHFWLYHVWUHQJWKVDQGZHDNQHVVHV³WKHRIÀFLDOWRROVDYDLODEOHGLUHFWO\DQGPRVWO\IRUIUHH
IURPWKH0\64/ZHEVLWHDUHRIWHQXQGHUHVWLPDWHGRUHYHQRYHUORRNHG
:KLOHWKH\PD\QRWEHWKHPRVWSROLVKHGDQGPD\FHUWDLQO\KDYHWKHLUTXLUNVWKH\VKRXOG
QHYHUWKHOHVVQRWHVFDSH\RXUDWWHQWLRQEHFDXVHHLWKHURQWKHLURZQRUVRPHWLPHVDPHQGHG
E\VRPHRWKHUIUHHVRIWZDUHWKH\DUHFDSDEOHRIKHOSLQJ\RXDJUHDWGHDOZLWK\RXUHYHU\GD\
0\64/DGPLQLVWUDWLRQWDVNV
7RROVXVHGLQWKLVUHFLSH
,QWKLVFKDSWHUZHZLOOORRNDWWKH0\64/FRPPDQGOLQHFOLHQWmysqlZKLFKLVDYDLODEOH
IRUIUHHZLWKWKHVHUYHUDQGWKH0\64/*8,7RRONLWSDUWV0\64/4XHU\%URZVHUDQG
0\64/$GPLQLVWUDWRU
7KHFRPPDQGOLQHFOLHQWOLHVDWWKHKHDUWRIPDQ\VFULSWVDQGRWKHUFRPPDQGOLQHWRROV
7KLVLVEHFDXVHLWLVTXLWHÁH[LEOHDQGOHQGVLWVHOIWRDXWRPDWLRQE\LWVYHU\QDWXUHDVDSXUHO\
WH[WEDVHGWRRO,WFDQJHQHUDOO\EHXVHGRQDOOSODWIRUPVVXSSRUWHGE\0\64/+RZHYHUWKH
UHVSHFWLYHXQGHUO\LQJRSHUDWLQJV\VWHPDQGWKHVKHOOXVHGSOD\DQLPSRUWDQWUROHLQZKDW\RX
FDQGRZLWKmysql
0RVW/LQX[GLVWULEXWLRQVDQGRWKHU8QL[OLNHV\VWHPV³WKLVLQFOXGHV$SSOH
V0DF26;³E\
GHIDXOWFRPHZLWKULFKVXSSRUWIRUVFULSWLQJDQGDXWRPDWLRQ2Q0LFURVRIW:LQGRZVWKHVWRU\
KDVEHFRPHEHWWHURYHUWKH\HDUV+RZHYHUVRPHIXQQ\WKLQJVWKDW\RXJHWIRUIUHHZLWK/LQX[
DQGWKHOLNHZLOOMXVWQRWZRUN,QVRPHFDVHVVXFKODFNRIIXQFWLRQDOLW\FDQEHDOOHYLDWHGZLWK
WKHLQVWDOODWLRQRIVRPHDGGLWLRQDOSDFNDJHV,QRWKHUFDVHV:LQGRZVXVHUVXQIRUWXQDWHO\
DUHVLPSO\RXWRIOXFNGXHWRUHVWULFWLRQVSRVHGE\WKHRSHUDWLQJV\VWHP
VYHU\FRUH
1HYHUWKHOHVVZKHUHYHUSRVVLEOHZHZLOOJLYHDGYLFHRQKRZWRZRUNDURXQGVXFKSUREOHPV
VKRXOGWKHQHHGDULVHLQDQ\RIWKHIROORZLQJUHFLSHV
0\64/*8,7RROVKDYHEHFRPHDUHVSHFWDEOHVHWRIWRROVRYHUWKHSDVWFRXSOHRI\HDUV
$OWKRXJKVRPHWLPHVWKH\VWLOOKDYHLVVXHVZLWKVWDELOLW\WKH\KDYHUHDFKHGDOHYHORIPDWXULW\
ZKHUHWKH\FDQEHUHFRPPHQGHGIRUHYHU\GD\XVHZLWKRXWKHVLWDWLRQ,QWKLVFKDSWHU\RX
ZLOOÀQGVRPHUHFLSHVWKDWUHYROYHDURXQG0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHUWR
PDNHXVLQJWKHPDQHYHQPRUHSOHDVDQWH[SHULHQFH<RXFDQJHWWKHPIURPWKH0\64/KRPH
SDJHDWhttp://dev.mysql.com/downloads/gui-tools
7KLVFKDSWHULVQRWDPDQXDOWRWKHVHWRROVLQJHQHUDO,QIDFWVRPHH[SHULHQFHZLWKWKHPLV
UHFRPPHQGHGWRWDNHIXOODGYDQWDJHRIWKHUHFLSHVSUHVHQWHGKHUH7RIROORZDORQJ\RXQHHG
WRKDYHWKH*8,7RROVLQVWDOOHGRQ\RXUPDFKLQH

&KDSWHU

3ODWIRUPGLIIHUHQFHV
0\64/*8,7RROVDUHDYDLODEOHIRUPDMRURSHUDWLQJV\VWHPSODWIRUPV7KHUHFLSHVUHJDUGLQJ
WKHPSUHVHQWHGLQWKLVERRNVKRXOGZRUNHTXDOO\ZHOORQ:LQGRZV/LQX[DQG0DF26;
+RZHYHUWKHUHDUHVRPHGLIIHUHQFHVEHWZHHQWKHVHSODWIRUPVIRULQVWDQFHZKHUHWKH
SUHIHUHQFHVÀOHVDUHVWRUHGRUZKDWWKHXVHULQWHUIDFHORRNVOLNH:KHQHYHUQHFHVVDU\
DVSHFWVWKDWQHHGGLIIHUHQWKDQGOLQJGHSHQGLQJRQWKHXQGHUO\LQJSODWIRUPZLOOEH
GLVFXVVHGVHSDUDWZHO\
0\64/*8,7RROVFRQÀJÀOHORFDWLRQV
2QHPDMRUGLIIHUHQFHEHWZHHQRSHUDWLQJV\VWHPVLVWKHORFDWLRQRIWKH0\64/*8,7RROV

FRQÀJXUDWLRQÀOHV6RPHUHFLSHVPDQLSXODWHWKRVHGLUHFWO\VRLQVWHDGRIGHVFULELQJWLPHDQG
DJDLQZKHUHWRÀQGWKHPRQHDFKRSHUDWLQJV\VWHPSOHDVHKDYHDORRNDWWKHIROORZLQJOLVW
ZKHQHYHU\RXQHHGWRORFDWHRQHRIWKHP
,Q0DF26;WKHSUHIHUHQFHVÀOHVDUHVWRUHGLQWKHLibrary/ApplicationSupportIROGHU
RIWKHXVHU
VKRPHGLUHFWRU\VKRZQDVIROORZV
,Q/LQX[WKHVHWWLQJVDUHVWRUHGLQDKLGGHQGLUHFWRU\.mysqlguiLQVLGHWKHXVHU
V
KRPHGLUHFWRU\

7RROV

,Q:LQGRZVWKHVHWWLQJVDUHVWRUHGLQWKH%APPDATA%/MySQLIROGHUORFDWHGLQWKHXVHU
V
SURÀOH7KHQH[WVFUHHQVKRWVKRZV:LQGRZVEXWZLWK;3LWLVMXVWWKHVDPH
7UDQVIHUULQJFRQQHFWLRQVHWWLQJVEHWZHHQ
GLIIHUHQWPDFKLQHVXVLQJDQHWZRUNVKDUH
0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHUDOORZVWRULQJFRQQHFWLRQSURÀOHVIRUKRVWV
WKDW\RXUHJXODUO\XVH7KHVHDUHVWRUHGORFDOO\DVSDUWRIWKHXVHUSURÀOH\RXDUHORJJHGLQ
ZLWK8QOHVV\RXRQO\HYHUZRUNIURPDVLQJOHPDFKLQHZLWKDVLQJOHXVHUDFFRXQW\RXZRXOG
XVXDOO\KDYHWRUHFUHDWHDQGPDLQWDLQHDFKDQGHYHU\PDFKLQH
VOLVWRIVWRUHGFRQQHFWLRQV
PDQXDOO\ZKLFKLVQHLWKHUDIXQQRUDSURGXFWLYHWDVN
7KLVUHFLSHZLOOVKRZ\RXKRZWRVWRUHFRQQHFWLRQSURÀOHVHWWLQJVLQDZD\WKDWDOORZVWKHPWR
EHXVHGIURPPXOWLSOHXVHUDFFRXQWVDQGHYHQPXOWLSOHPDFKLQHV
7KHQH[WVWHSVZLOOGHPRQVWUDWHKRZWRVKDUHFRQQHFWLRQVHWWLQJVEHWZHHQ8EXQWX/LQX[DQG
D:LQGRZVPDFKLQHXVLQJDQHWZRUNVKDUH
<RXFDQDSSO\WKLVWRDQ\FRPELQDWLRQRIPDFKLQHVZLWKDQ\VXSSRUWHGRSHUDWLQJV\VWHP

&KDSWHU

*HWWLQJUHDG\
0DNHVXUH\RXKDYHVRPHVRUWRIDVKDUHGPHGLXPUHDG\ZLWKZULWHSHUPLVVLRQV7KLVFRXOG
EHDGLUHFWRU\RQWKHORFDOPDFKLQHDFFHVVLEOHE\VHYHUDOXVHUDFFRXQWVD86%SHQGULYHWR
FDUU\DURXQGZLWK\RXDZHEVHUYHURUDQHWZRUNVKDUHDFFHVVLEOHE\DQ\RQH\RXZDQWWR
VKDUHWKHFRQQHFWLRQVZLWK
6HHWKHFKDSWHULQWURGXFWLRQIRUDJXLGHRQZKHUHWRÀQGWKHVWRUHGFRQQHFWLRQÀOHRQ
HDFKSODWIRUP
+RZWRGRLW

6HWXSRQHRUPRUHFRQQHFWLRQVLQ0\64/$GPLQLVWUDWRURQWKH/LQX[PDFKLQH7KH
VFUHHQVKRWVLQWKLVH[DPSOHZHUHWDNHQRQDPDFKLQHZLWKWZRFRQQHFWLRQSURÀOHV
FDOOHG'HYHORSPHQW6HUYHU$DQG4$6HUYHU

&ORVH0\64/$GPLQLVWUDWRUDQGDOVR0\64/4XHU\%URZVHULIUXQQLQJ

1DYLJDWHWR~/.mysqlguiDQGFRS\WKHÀOHFDOOHGmysqlx_user_connections.
xmlWRWKHQHWZRUNVKDUH

2Q:LQGRZVRSHQDQH[SORUHUZLQGRZDQGHQWHU%appdata%\MySQLLQWKH
DGGUHVVEDU&OLFN(QWHUWRRSHQWKHIROGHU

2SHQDQRWKHU([SORUHUZLQGRZDQGSRLQWLWWRWKHQHWZRUNVKDUH

'UDJmysqlx_user_connections.xmlIURPWKHQHWZRUNWRWKHORFDOGLUHFWRU\
PDNLQJDFRS\

7RROV


6WDUW0\64/$GPLQLVWUDWRURU4XHU\%URZVHUDQGÀQGWKHFRQQHFWLRQVGHÀQHGRQWKH
/LQX[PDFKLQHDOVRSUHVHQWLQ:LQGRZV
+RZLWZRUNV
0\64/*8,7RROVVWRUHLQIRUPDWLRQDERXWWKHFRQQHFWLRQV\RXHQWHUDQGVWRUHXVLQJWKHLU
JUDSKLFDOXVHULQWHUIDFHLQDQ;0/ÀOH$VWKHUHDUHQRRWKHUSODFHVWRFRQVLGHUVXFKDVWKH
UHJLVWU\RUELQDU\ÀOHVLWLVUDWKHUHDV\WRFRS\WKHPDURXQGDQGXVHWKHPLQGLIIHUHQWSODFHV
$OOWKHVHWWLQJV³LQFOXGLQJKRVWQDPHVXVHUDFFRXQWQDPHVDQGHYHQWKHQRWHV\RXFDQELQG
WRDVWRUHGFRQQHFWLRQ³DUHVDYHGWRWKLV;0/ÀOH,WLVXVHGE\ERWK0\64/$GPLQLVWUDWRUDQG
0\64/4XHU\%URZVHUVR\RXQHHGQRWGRDQ\WKLQJWRVKDUHDFRPPRQVHWRIFRQQHFWLRQV
EHWZHHQWKHWZRRQWKHVDPHPDFKLQH3DVVZRUGVFDQRSWLRQDOO\EHVWRUHGDQGDUHSXWLQWR
WKLVÀOHWRRLI\RXFKRRVHVR+RZHYHUVWRULQJSDVVZRUGVLVJHQHUDOO\QRWUHFRPPHQGHG
EHFDXVHWKH\DUHQRWVHFXUHO\HQFU\SWHG
,GHDOO\WKHWRROVZRXOGRSWLRQDOO\DOORZ\RXWRVSHFLI\ZKLFKÀOHWRXVHVR\RXFRXOGMXVWSRLQW
WKHPDOODWWKHFRPPRQORFDWLRQOLNHWKHQHWZRUNGULYHHPSOR\HGLQWKHSUHYLRXVVHFWLRQ
:KLOHWKLVZRXOGZRUNJUHDWLQWKHRU\WKHUHZRXOGEHDOONLQGVRIXQZDQWHGFRQVHTXHQFHV
)RUH[DPSOHZKDWZRXOG\RXGRLIWZRSHRSOHRQGLIIHUHQWPDFKLQHVWULHGWRPRGLI\DQGVDYH
WKHVDPHVWRUHGFRQQHFWLRQ"

&KDSWHU

%HFDXVHRIWKLVLWLVQHFHVVDU\WRSURYLGHHDFKPDFKLQHRUXVHUDFFRXQWWREHSUHFLVH
EHFDXVHWKH%appdata%SRUWLRQRIWKHSDWKQDPHGLQWKHSUHYLRXVVWHSVWDNHV\RXLQWRD
VXEGLUHFWRU\RIWKHXVHU
VSURÀOHZLWKLWVRZQFRS\RIWKHÀOHWRZRUNZLWK7KLVLVZKDW\RXMXVW
GLGE\FRS\LQJWKHÀOHIURPRQHPDFKLQHWRWKHQHWZRUNGULYHDQGIURPWKHUHRQWRWKHVHFRQG
PDFKLQH7R0\64/*8,7RROVLWPDNHVQRGLIIHUHQFHZKHWKHUWKH\FUHDWHGWKHÀOHWKHPVHOYHV
RUJRWVSRRQIHGE\DGLIIHUHQWLQVWDQFHHYHQRQDGLIIHUHQWSLHFHRIKDUGZDUH
7KHUH
VPRUH
)RUVLPSOHVHWXSVDQGZLWKDOLPLWHGQXPEHURISHRSOHVKDULQJFRQQHFWLRQVHWWLQJVWKLVYHU\
EDVLFDSSURDFKZRUNVTXLWHZHOO+RZHYHUPD\EH\RX
GOLNHVRPHPRUHSRLQWHUVRQZKHUHWR
JRIURPKHUH
'HDOLQJZLWKFKDQJHV
$VZHDOUHDG\GLVFXVVHGHDFKZRUNVWDWLRQPDFKLQHJHWVLWVRZQFRS\RIWKHFRQQHFWLRQV;0/
ÀOH:KLOHWKLVLVDWHFKQLFDOQHFHVVLW\LWEULQJVDORQJWKHSUREOHPRIFRQFXUUHQWFKDQJHVWR
FRQQHFWLRQSURÀOHVRQGLIIHUHQWPDFKLQHV
$VVRRQDVDWOHDVWWZRSHRSOHPRGLI\GLIIHUHQWORFDOFRSLHVRIWKHÀOHWKH\ZLOOKDYHWRDJUHH
RQZKRLVWRFRS\KLVRUKHUQHZYHUVLRQWRWKHQHWZRUNGULYH2QO\RQHRIWKHPFDQGRVR
EHFDXVHWKHVHFRQGRQHZRXOGRYHUZULWHWKHLUFROOHDJXH
VHGLWV
)RUVPDOOWHDPVWKHVLPSOHVWDSSURDFKFRXOGEHWRDJUHHRQDGHGLFDWHG3&RQZKLFK
WKHFKDQJHVDUHPDGH$OORWKHUPDFKLQHVRQO\XSGDWHWKHLUORFDOFRS\RIWKHÀOHIURPWKH
QHWZRUNEXWQHYHUSXVKWKHPEDFN
$OWHUQDWLYHO\\RXFDQQDPHDVLQJOHXVHUZKRPDNHVDOORIWKHFKDQJHVDQGSXWVWKHPRQWKH
VKDUHGPHGLXP
)RUODUJHUWHDPV\RXPD\FRQVLGHUXVLQJDYHUVLRQFRQWUROV\VWHPOLNH6XEYHUVLRQRU&967KLV
FDQEHHVSHFLDOO\SUDFWLFDOIRUODUJHURUJDQL]DWLRQVDOUHDG\KDYLQJDUHSRVLWRU\LQSODFHWKDW
FRXOGEHSXWWRJRRGXVHKHUH7KHORFDO;0/ÀOHFRXOGEHDZRUNLQJFRS\FKHFNHGRXWIURP
WKHUHSRVLWRU\:KHQHYHUVRPHRQHFKDQJHVLWKHRUVKHZRXOGFKHFNLWLQWRWKHUHSRVLWRU\
IRURWKHUVWRIHWFK,QFDVHRIFRQÁLFWLQJFKDQJHV\RXZRXOGEHQRWLÀHGE\WKHYHUVLRQFRQWURO
VRIWZDUHDQGZRXOGKDYHWRPHUJHERWKFKDQJHVLQWRDQHZFRPELQHGYHUVLRQ
,I\RXGRWKLV\RXPLJKWFRQVLGHUXVLQJVRPHNLQGRI;0/IRUPDWWLQJWRROEHFDXVH0\64/
*8,7RROVWHQGWRZULWHRXWWKHÀOHZLWKSODWIRUPVSHFLÀFOLQHHQGLQJVPDNLQJLWDOLWWOHPRUH
FXPEHUVRPHFRPSDUHGWRWKHÀOHVRULJLQDWLQJIURP:LQGRZVDQG8QL[OLNHSODWIRUPV
)RU:LQGRZV\RXPLJKWZDQWWRFKHFNRXWDSURJUDPFDOOHGÀUVWREMHFW;0/(GLWRUIUHHO\
DYDLODEOHDWhttp://www.firstobject.comZKLFKKDVDIRUPDWWLQJIHDWXUH

7RROV

6RUWLQJ0\64/*8,7RROV
VWRUHGFRQQHFWLRQV
0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHUERWKLQFOXGHDFRQQHFWLRQHGLWRUWKDWDOORZV
\RXWRPDQDJH\RXUVWRUHGFRQQHFWLRQSURÀOHV:KLOHWKLVRIIHUVDFRPIRUWDEOHZD\WRFUHDWH
QHZRUHGLWH[LVWLQJSURÀOHVLQFOXGLQJDORWRIVHWWLQJVDQGHYHQFRPPHQWVWKLVHGLWRUSURYLGHV
QRZD\WRVRUW\RXUSURÀOHV(VSHFLDOO\LI\RXZRUNZLWKDORWRIVWRUHGVHWWLQJV\RXZLOOZDQW
WRPDLQWDLQDFHUWDLQWLGLQHVVWRTXLFNO\ÀQGVSHFLÀFSURÀOHVIURPWKHGURSGRZQOLVWLQWKH
&RQQHFWLRQVGLDORJ
7KLVUHFLSHZLOOVKRZ\RXKRZWRVRUWFRQQHFWLRQSURÀOHVHWWLQJVE\&RQQHFWLRQ1DPH
DVVXPLQJ0DF26;DVWKHSODWIRUP
)RU/LQX[DQG:LQGRZVWKHLQVWUXFWLRQVDUHPRVWO\LGHQWLFDO+RZHYHU
\RXZLOOKDYHWRUHSODFHWKHSDWKQDPHVZLWKWKHDSSURSULDWHYDOXHVIRU
\RXUV\VWHP,QVWHDGRIWKHWHUPLQDODSSOLFDWLRQ:LQGRZVXVHUVXVH
6WDUW_5XQ_FPGH[HWRODXQFKDFRPPDQGLQWHUSUHWHU$OVRQRWH
WKDWWKHcpFRPPDQGLVFDOOHGcopyRQ:LQGRZVVRPDNHVXUH\RX
FKDQJHWKDWWRR
*HWWLQJUHDG\
7RWU\WKLV\RXZLOOQHHGVHYHUDOVWRUHGFRQQHFWLRQSURÀOHV<RXFDQFUHDWHWKRVHLQ
HLWKHU0\64/$GPLQLVWUDWRURU0\64/4XHU\%URZVHUDVWKH\ERWKVKDUHWKHVDPHVHW
RIFRQQHFWLRQV,QWKLVH[DPSOHWKHUHDUHÀYHFRQQHFWLRQVWKDWDSSHDUXQVRUWHGLQWKH
FRQQHFWLRQHGLWRU

&KDSWHU

<RXZLOOQHHGDQ;6/7SURFHVVRULQVWDOOHG0RVW/LQX[GLVWULEXWLRQVDQG0DF26;FRPH
SUHLQVWDOOHGZLWKDFRPPDQGFDOOHGxsltproc:LQGRZVXVHUVFDQGRZQORDGDELQDU\
YHUVLRQRIWKLVWRROIRUWKHLUSODWIRUPIURPhttp://www.xmlsoft.org/XSLT
+RZWRGRLW

6DYHWKHIROORZLQJFRGHWRDÀOHFDOOHGsortconnections.xslDQGSODFH
LWLQ\RXUKRPHGLUHFWRU\<RXFDQGRZQORDGWKLVÀOHIURPWKHERRN
VZHEVLWH
www.packtpub.comWRR
<xsl:stylesheet version="1.0" 
 xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>
  <xsl:template match="node()|@*">
    <xsl:copy>
      <xsl:apply-templates select="node()|@*"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="user_connections">
    <xsl:copy>
      <xsl:apply-templates select="@*"/>
      <xsl:apply-templates select="*[name()!='user_connection']"/>
      <xsl:apply-templates select="user_connection">
        <xsl:sort select="connection_name"/>
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>
</xsl:stylesheet>

&ORVH0\64/$GPLQLVWUDWRUDQGDOVR0\64/4XHU\%URZVHULIUXQQLQJ

2SHQTerminal.app

(QWHUWKHIROORZLQJFRPPDQGV7KHÀUVWcdFRPPDQGZLOOWDNH\RXWR\RXUKRPH
GLUHFWRU\LQFDVH\RXKDYHFRQÀJXUHGDGLIIHUHQWGHIDXOW
$ cd ~/Library/Application\ Support/MySQL/ 
$ cp mysqlx_user_connections.xml mysqlx_user_connections.xml.
unsorted 
$ xsltproc ~/sortconnections.xsl mysqlx_user_connections.xml.
unsorted > mysqlx_user_connections.xml

&ORVHWKHWHUPLQDO

7RROV

 6WDUW0\64/$GPLQLVWUDWRURU0\64/4XHU\%URZVHUDQGÀQGWKHFRQQHFWLRQVVRUWHG
LQWKHFRQQHFWLRQHGLWRU
+RZLWZRUNV
0\64/*8,7RROVVWRUHLQIRUPDWLRQDERXWWKHFRQQHFWLRQVWKDW\RXHQWHUXVLQJWKHLUJUDSKLFDO
XVHULQWHUIDFHLQDQ;0/ÀOH(DFKFRQQHFWLRQLVUHSUHVHQWHGE\DQ;0/HOHPHQWFDOOHG
<user_connection>7KHRUGHURIWKHVHHOHPHQWVLQWKHÀOHGHWHUPLQHVLQZKLFKRUGHUWKH
*8,ZLOOGLVSOD\WKHP
$VWKHUHLVQRZD\WRUHDUUDQJHWKHFRQQHFWLRQSURÀOHVXVLQJWKHXVHULQWHUIDFHZHVRUWWKH
XQGHUO\LQJGDWDÀOH
%HFDXVHWKHGDWDÀOHLVORFNHGE\WKH*8,7RROVZKLOHWKH\DUHUXQQLQJLW
LVLPSRUWDQWWRTXLWWKHPEHIRUHEHJLQQLQJWKHSURFHGXUH2WKHUZLVH\RXU
FKDQJHVPLJKWJHWORVWEHFDXVHQH[WWLPH\RXFORVHWKH*8,7RROVWKHÀOH
JHWVUHZULWWHQLQWKHRUGHUWKDWWKHUXQQLQJLQVWDQFHNQHZ

&KDSWHU

8VLQJDVLPSOH;6/VW\OHVKHHWDQGDVXLWDEOHSURFHVVLQJWRROxsltprocWKHXQVRUWHG;0/
LVUHDGDQGWUDQVIRUPHGLQWRDQHZYHUVLRQZLWKWKH<user_connection>HOHPHQWVVRUWHG
E\WKHLU<connection_name>VXEHOHPHQW7RPDNHVXUHQRWKLQJJRHVZURQJZHÀUVW
PDNHDEDFNXSFRS\RIWKHRULJLQDOÀOHDQGVDYHLWDVmysqlx_user_connections.xml.
unsorted
)LQDOO\WKHxsltprocFRPPDQGDSSOLHVWKHsortconnections.xsl VW\OHVKHHWDQGWKH
UHVXOWLQJRXWSXWLVVWRUHGEDFNLQWRmysqlx_user_connections.xmlZKHUHLWZLOOEHIRXQG
WKHQH[WWLPHD0\64/*8,7RROVWDUWV
7KHUH
VPRUH
6RUWLQJE\QDPHLVMXVWRQHZD\RIRUJDQL]LQJ\RXUFRQQHFWLRQWHPSODWHVDQGSUREDEO\WKH
RQHPRVWRIWHQXVHG+RZHYHU;6/VW\OHVKHHWVDUHDYHU\YHUVDWLOHDQGSRZHUIXOPHDQVWRPD
QLSXODWH;0/ÀOHVVXFKDVWKHFRQQHFWLRQSURÀOHVVWRUH7KHUHDUHORWVRIUHVRXUFHVRQWKH:HE
DQGLQSULQWHGIRUPWKDWFDQWHDFK\RXKRZWRÀOWHUJURXSDQGUHDUUDQJH;0/GDWD)RUDJRRG
WXWRULDORQ;6/WUDQVIRUPDWLRQVIRUH[DPSOHJRWRhttp://www.w3schools.com/xsl/
+HUHDUHVRPHPRUHSRLQWHUVDVWRZKDW\RXPLJKWGRWRPDNHVWRUHGFRQQHFWLRQV
PRUHXVHIXO
f
,QVWHDGRIVRUWLQJE\FRQQHFWLRQQDPH\RXPLJKWVRUWE\KRVWQDPH7KLVFDQEHXVH
IXOLI\RXPDQDJHDODUJHQXPEHURIPDFKLQHVIROORZLQJDQDPLQJFRQYHQWLRQWKDW
DOORZVIRUVHQVLEOHVRUWLQJ
f
$FRPELQDWLRQRIVRUWFULWHULDPLJKWSURYHXVHIXOLI\RXVWRUHVHYHUDOSURÀOHVIRUD
VLQJOHVHUYHU<RXPLJKWVRUWE\KRVWÀUVWDQGWKHQE\GDWDEDVHRUXVHUQDPH
(YHQLQFDVHVZKHUHWKHSUHGHÀQHGÀHOGVDUHLQVXIÀFLHQWWKHUHLVDZD\WRGHÀQHDOPRVWDU
ELWUDU\VRUWFULWHULDE\OHYHUDJLQJWKHRWKHUZLVHVHOGRPXVHG1RWHVÀHOGLQWKHTXHU\HGLWRU
)RUH[DPSOHLQDVFHQDULRZKHUH\RXKDYHWRPDQDJHKRVWVLQGLIIHUHQWORFDWLRQVFLWLHV
FRXQWULHVVXEVLGLDULHVDQGVRRQ\RXFRXOGVWRUHWKHFLW\QDPHLQWKH1RWHVÀHOGDQGXVH
WKLVDVDVRUWLQJFULWHULRQ
$XWRPDWLFDOO\FUHDWLQJVWRUHGFRQQHFWLRQV
$OWKRXJKPDQDJLQJDKDQGIXORIFRQQHFWLRQVLVQRSUREOHPZLWKWKHEXLOWLQFRQQHFWLRQ
PDQDJHUVLQ0\64/*8,7RROVFUHDWLQJDODUJHUVHULHVRIWKHPWHQGVWREHFRPHWHGLRXV
)RUH[DPSOHZKHQPDQDJLQJDVKDUHGGDWDEDVHVHUYHUWKHUHPLJKWEHVHYHUDOKXQGUHG
GDWDEDVHV³RQHRUHYHQPRUHIRUHDFKFXVWRPHU,QDGLIIHUHQWVFHQDULR\RXPD\KDYH
QXPHURXVVHUYHUVIRUHDFKRIZKLFK\RXPLJKWZDQWDVHSDUDWHVWRUHGFRQQHFWLRQHQWU\
WRDOORZHDV\DFFHVV

7RROV

7KLVUHFLSHSUHVHQWVDZD\WRDXWRPDWLFDOO\JHQHUDWHQHZFRQQHFWLRQHQWULHVEDVHGRQD
VLPSOH&69FRPPDVHSDUDWHGYDOXHÀOHXVLQJDVKRUWVKHOOVFULSW7KLVYHU\VLPSOHIRUPDW
DOORZVIRUDZLGHUDQJHRIGDWDVRXUFHV)RUH[DPSOH\RXPLJKWDOUHDG\KDYHDVSUHDGVKHHW
ZLWKDOORIWKHLPSRUWDQWLQIRUPDWLRQRUH[WUDFWLWIURPVRPHVRUWRIGDWDEDVH
5HIHUWRWKH0\64/*8,7RROVFRQÀJÀOHORFDWLRQVVHFWLRQLQWKHFKDSWHULQWURGXFWLRQWRFKHFN
ZKHUH\RXFDQÀQGWKHFRQQHFWLRQVWRUDJH;0/ÀOHIRUHDFKRSHUDWLQJV\VWHP
*HWWLQJUHDG\
7RWU\WKLV\RXVKRXOGNQRZ\RXUZD\DURXQGZLWKDFRPPDQGOLQH7KHUHLVQRQHHGIRU\RX
WREHH[SHULHQFHGZLWKDGYDQFHGVKHOOVFULSWLQJEXW\RXVKRXOGEHIDPLOLDUZLWKQDYLJDWLRQ
DURXQGWKHÀOHV\VWHPDQGVRPHEDVLFFRPPDQGV0RUHRYHU\RXZLOOQHHGDÀOHFRQWDLQLQJ
WKHEDVLFLQIRUPDWLRQDERXWHDFKFRQQHFWLRQSURÀOH\RXZRXOGOLNHWRLQFOXGHLQ\RXU0\64/
*8,7RROVVWRUHGFRQQHFWLRQV7KHVWHSVRXWOLQHGLQWKLVUHFLSHUHTXLUHDbashVKHOO7KLVLV
GHIDXOWLQPDQ\/LQX[GLVWULEXWLRQVDQG0DF26;DQGODWHU
,Q:LQGRZV\RXFDQHLWKHULQVWDOOWKH&\JZLQWRRONLWIURPhttp://www.cygwin.comWKDW
SURYLGHVDbashVKHOODQGsedWRRORUPRGLI\WKHVFULSWWRPDWFKWKHEDWFKÀOHV\QWD[7KH
sedFRPPDQGFDQEHGRZQORDGHGDVDQDWLYH:LQGRZVH[HFXWDEOHDVSDUWRIWKH8QL[XWLOLWLHV
IURPKttp://unxutils.sourceforge.net/:HGHÀQLWHO\UHFRPPHQG\RXKDYHDORRNDW
&\JZLQXQOHVV\RXDUHUHDOO\H[SHULHQFHGZLWK:LQGRZVEDWFKVFULSWLQJ
&RQQHFWLRQVZLOOEHJHQHUDWHGIURPD&69ÀOHZKLFKVKRXOGFRQWDLQRQHOLQHSHUQHZ
FRQQHFWLRQ(DFKOLQHZLOOFRQWDLQWKHFRQQHFWLRQLQIRUPDWLRQLQDÀ[HGRUGHUVHSDUDWHGE\
FRPPDVOLNHWKLV
Title,Username,Hostname,Port,Schema,Notes,Password
$OOÀHOGVDUHRSWLRQDO+RZHYHUWKHQXPEHURIFRPPDV
SHUOLQHPXVWEHREH\HGHYHQZKHQQRWKLQJPRUH
IROORZVLQWKHVDPHOLQH
(YHU\WKLQJWKDW\RXGRQ
WLQFOXGHLQWKLVÀOHPXVWHLWKHUEHHQWHUHGPDQXDOO\HDFKWLPH\RX
FKRRVHWKLVFRQQHFWLRQSURÀOHRUEHDÀ[HGYDOXHWKDWDOOFRQQHFWLRQVKDYHLQFRPPRQ7KH
IROORZLQJÀOHFRQWDLQVVHYHUDOYDOLGVDPSOHOLQHVWRGHPRQVWUDWHWKHLGHD7KHH[DPSOHEHORZ
DVVXPHVWKDW\RXVWDUWZLWKDQHPSW\OLVWRIFRQQHFWLRQSURÀOHVDQGDGGWKHVHVDPSOHHQWULHV
GLUHFWO\IURPWKLVÀOHFDOOHGconnections.csv
LocalDev,root,localhost,3310,dev_db,Version 1.5,rootpw
Web01,smith,web01.example.com,3306,cmsweb,,,
Austria,guest,10.22.109.12,3306,mz011,Staging DB,

&KDSWHU

,QRUGHUWRFUHDWHFRQQHFWLRQVZLWKDSDVVZRUGWDNHQIURPWKH&69ÀOH\RXPXVWPDNHVXUH
WKDWWKHWHPSODWHFRQQHFWLRQ\RXDUHJRLQJWRFUHDWHLQWKHIROORZLQJVHFWLRQLVFRQÀJXUHG
WRXVH3ODLQ7H[WSDVVZRUGVWRUDJHVHWWLQJ,I\RXGRQRWZDQWWRVWRUHSDVVZRUGVLQWKH
FRQQHFWLRQSURÀOHVIRUVHFXULW\UHDVRQV\RXFDQVHWWKLVRSWLRQWRDQ\RIWKHRWKHUDYDLODEOH
VHWWLQJVEXWPDNHVXUHWKDW\RXGRQRWSURYLGHDQ\SDVVZRUGVLQWKH&69ÀOHEHFDXVHWKH\
ZRXOGQRWZRUN
7KHH[DPSOHLQWKHQH[WVHFWLRQDVVXPHVSODLQWH[WSDVVZRUGVWRUDJHIRUGHPRQVWUDWLRQSXUSRVHV
+RZWRGRLW

2SHQ0\64/$GPLQLVWUDWRURU0\64/4XHU\%URZVHUDQGJRWRWKH&RQQHFWLRQ
(GLWRU

&UHDWHDQHZFRQQHFWLRQZLWKWKLVGDWD
)LHOG
&RQWHQW
&RQQHFWLRQ1DPH
p_0
8VHUQDPH
p_1
3DVVZRUG
p_6
+RVWQDPH
p_2
6FKHPD
p_4
1RWHV
p_5

&ORVH0\64/$GPLQLVWUDWRUDQG0\64/4XHU\%URZVHULIUXQQLQJ

2SHQWKHFRQQHFWLRQSURÀOHV;0/ÀOHZLWKDWH[WHGLWRUDQGVHDUFKIRUSB<RXZLOO
PRVWOLNHO\ÀQGLWFORVHWRWKHHQGRIWKHÀOH

5HSODFHWKHSRUWQXPEHUZLWKSB7KLVLVQHFHVVDU\EHFDXVH\RXFDQQRWHQWHU
QRQQXPHULFFKDUDFWHUVLQWKH*8,

6DYHWKH<user_connection>HOHPHQWVXUURXQGLQJ\RXUWHPSODWHSURÀOHLQFOXGLQJ
WKH</user_connection>OLQHDWWKHHQGWRDQHZÀOHFDOOHGoneconnection.
template7KLVÀOHVKRXOGORRNOLNHWKLV
<user_connection>
  <connection_name>p_0</connection_name>
  <username>p_1</username>
  <hostname>p_2/hostname>
  <port>p_3</port>
  <schema>p_4</schema>
  <advanced_options>
  </advanced_options>

7RROV

  <notes>p_5</notes>
  <connection_type>0</connection_type>
  <storage_type>1</storage_type>
  <password_storage_type>6</password_storage_type>
  <password>p_6</password>
</user_connection>

&UHDWHDVFULSWÀOHQDPHGmkuserconn.shZLWKWKHIROORZLQJFRQWHQWV
#!/bin/bash 
IFS=, 
TMPFILE=$(mktemp ~/mkuserconn.XXXXXXXXXX) || exit 1
while read p[0] p[1] p[2] p[3] p[4] p[5] p[6] ; do
    s=""
    for ((i=0; i<${#p[*]}; i++)); do
        s=$s"s/p_${i}/${p[${i}]}/g;"
    done
    newentry=$(sed -e "${s}" oneconnection.template)
    echo "${newentry}" >> ${TMPFILE}
done < ${2} 
echo "</user_connections>" >> ${TMPFILE}
sed -e "/<\/user_connections>/ {
  r ${TMPFILE}
  d 
}" ${1}
 0DNHWKHÀOHH[HFXWDEOHZLWK
$ chmod u+x mkuserconn.sh
 ,QYRNHWKHVFULSWOLNHWKLV
$ ./mkuserconn.sh mysqlx_user_connections.xml connections.csv
 7KHRXWSXWZLOOEHVHQWWRstdoutWRJLYH\RXDFKDQFHWRYHULI\WKDWHYHU\WKLQJJRHV
DVSODQQHG2QFH\RXDUHFRQWHQWUHGLUHFWLWWRDQHZÀOHZLWKWKHUHGLUHFWRSHUDWRU>
OLNHWKLV
$ ./mkuserconn.sh mysqlx_user_connections.xml connections.csv > 
mysqlx_user_connections_new.xml
 5HSODFHWKHRULJLQDOmysqlx_user_connections.xmlÀOHZLWKWKHQHZO\FUHDWHG
mysqlx_user_connections_new.xmlRQFH\RXDUHFRQWHQWVDYLQJDEDFNXSRI
WKHSUHYLRXVYHUVLRQ
$ cp mysqlx_user_connections.xml mysqlx_user_connections.xml.bak 
$ cp mysqlx_user_connections_new.xml mysqlx_user_connections.xml

&KDSWHU

2SHQ0\64/$GPLQLVWUDWRURU0\64/4XHU\%URZVHUDQGÀQGWKHQHZO\FUHDWHG
FRQQHFWLRQVUHDG\WRJR
+RZLWZRUNV
0\64/*8,7RROVVWRUHLQIRUPDWLRQDERXWWKHFRQQHFWLRQV\RXHQWHUDQGVWRUHXVLQJWKHLU
JUDSKLFDOXVHULQWHUIDFHLQDQ;0/ÀOH(DFKFRQQHFWLRQLVUHSUHVHQWHGE\DQ;0/HOHPHQW
FDOOHG<user_connection>
7KHVFULSWSUHVHQWHGWDNHVRQHVXFKHQWU\DVDWHPSODWHWRFUHDWHQHZRQHVUHSODFLQJWKH
p_0p_1p_2DQGRWKHUVLPLODUSODFHKROGHUVZLWKYDOXHVIURPWKHconnections.csvÀOH
)LUVWWKHVFULSWFUHDWHVDÀOHLQ\RXUKRPHGLUHFWRU\~ZKHUHWKHQHZFRQQHFWLRQGDWDLV
VWRUHGWHPSRUDULO\,WWKHQUHDGVWKHÀHOGVIURPDÀOHSDVVHGLQDVWKHVHFRQGSDUDPHWHUDQG
VWRUHVWKHPLQDQDUUD\FDOOHGp7KHRUGHURIWKHÀHOGVLQWKHÀOHFRUUHVSRQGVWRWKHLQGH[LQ
WKHDUUD\,QWKHORRSERG\WKHORRSUHDGVWKH&69ÀOHRQHOLQHDWDWLPHWKHsedFRPPDQG
OLQHLVDVVHPEOHGFRQVLVWLQJRIUHSODFHFRPPDQGVWKDWÀOOLQWKHLQIRUPDWLRQIURPWKH&69ÀOH
DWWKHDSSURSULDWHSODFHVLQoneconnection.template
:KHQWKHFRPPDQGKDVEHHQEXLOWLWLVH[HFXWHGDQGWKHRXWSXWLVVWRUHGLQWKHWHPSRUDU\
ÀOHFUHDWHGHDUOLHU
7KLVLVUHSHDWHGXQWLODOOOLQHVRIWKH&69ÀOHKDYHEHHQUHDGHIIHFWLYHO\FUHDWLQJDQHZ
<user_connection>...</user_connection>HOHPHQWIRUHDFKOLQHLQ\RXULQSXWÀOH
)LQDOO\ZKHQWKHWHPSRUDU\ÀOHFRQWDLQVDOOQHZFRQQHFWLRQSURÀOHVLWLVPHUJHGLQWRWKHÀUVWÀOH
VSHFLÀHGDVDFRPPDQGOLQHSDUDPHWHUZKLFKLV\RXUmysqlx_user_connections.xmlÀOH
RUDFRS\WKHUHRIULJKWEHIRUHWKHHQGRIWKHÀOH

7RROV

:KHQ\RXRSHQRQHRIWKH*8,WRROVDJDLQ\RXZLOOÀQGWKHQHZO\FUHDWHGFRQQHFWLRQVEDVHG
RQWKHWHPSODWH\RXVHWXSEHIRUH<RXFDQRIFRXUVHUHPRYHWKHp_0FRQQHFWLRQDWDQ\
WLPHRQFH\RXFRSLHGLWWRWKHoneconnection.templateÀOH
%HVXUHWRWU\WKLVRQDFRS\RI\RXUFRQQHFWLRQV;0/ÀOHÀUVWWRPDNHVXUH
HYHU\WKLQJLVFRUUHFW$VLQJOHW\SRLQWKHVFULSWÀOHPLJKWFRUUXSWWKHÀOH
EH\RQGUHSDLU7KLVLVZK\ZHGHVLJQHGWKHVFULSWWRRXWSXWWRWKHFRQVROHE\
GHIDXOWWRSUHYHQWDFFLGHQWDORYHUZULWHV
7KHUH
VPRUH
7KHVFULSWSUHVHQWHGLQWKLVUHFLSHLVYHU\EDVLFWRPDNHLWHDVLHUWRXQGHUVWDQGDQG\RXFDQ
XVHEDVLFWRROVWKDWDUHHDV\WRJHWDQGLQVWDOODOPRVWDQ\ZKHUH
2IFRXUVH\RXFRXOGUHZULWHLWLQ3HUORUDQ\RWKHUSURJUDPPLQJODQJXDJHDGGLQJPRUH
IHDWXUHVVRPHKHOSWH[WVDQGVRRQ
6RPHLGHDV\RXPD\ZDQWWRSXUVXHFRXOGEHLQVHUWLQJQHZFRQQHFWLRQVLQVRPHVSHFLÀF
RUGHUPRGLI\LQJH[LVWLQJFRQQHFWLRQVZLWKWKHVDPHQDPHLQVWHDGRIFUHDWLQJGXSOLFDWH
HQWULHVRUHGLWLQJWKHFRQQHFWLRQVWRUDJH;0/ÀOHLQSODFH
$GGLQJFXVWRPJUDSKVWR0\64/
$GPLQLVWUDWRU
0\64/$GPLQLVWUDWRULVRQHRIWKHJUDSKLFDOWRROVWKDW0\64/SURYLGHVWRPDQDJHLWV
GDWDEDVHVHUYHUV$SDUWIURPRWKHUWKLQJVOLNHVHUYHUGDHPRQFRQWURODQGDORJÀOHYLHZHU
WKLVWRROLQFOXGHVYLVXDOFRQWUROVWRGLVSOD\WKHFXUUHQWORDGDQGRWKHUYLWDOVLJQVRIWKH
GDWDEDVHVHUYHU
(YHQWKRXJKWKHRXWRIWKHER[FRQÀJXUDWLRQDOUHDG\FRQWDLQVVRPHXVHIXOGLDJUDPVLW
EHFRPHVHYHQPRUHXVHIXOZLWKVRPHFXVWRPGHVLJQHGJUDSKV,WPLJKWQRWEHVXLWDEOH
WRUHSODFHDIXOO\IHDWXUHGPRQLWRULQJVROXWLRQEXWLWLVGHÀQLWHO\KHOSIXOWRJDLQDTXLFN
LPSUHVVLRQDERXWZKDWVWUHVVDVHUYHULVFXUUHQWO\XQGHUKRZPDQ\XVHUVDUHFRQQHFWHGDQG
VRRQ
0\64/$GPLQLVWUDWRUSURYLGHVDJUDSKLFDOHGLWRUWRLQWURGXFHQHZSDJHVJURXSVDQGJUDSKV
(YHQWKRXJK,ZRXOGUDWKHUXVHWKHWHUPWDEZKLFKLVZKDWLWFRPHVGRZQWRLQWKH*8,ZH
ZLOOVWLFNWRSDJHKHUHEHFDXVHWKDW
VZKDW0\64/FDOOVLW
:KHQ\RXRSHQXS0\64/$GPLQLVWUDWRUDQGKHDGWRWKH+HDOWKVHFWLRQ\RXZLOOVHHVRPH
GHIDXOWSDJHV6WDWXV9DULDEOHV&RQQHFWLRQ+HDOWK0HPRU\+HDOWKDQG6HUYHU9DULDEOHV
'HSHQGLQJRQWKHYHUVLRQRI\RXUWRROVWKHUHPD\EHRQHPRUH0RQLWRULQJ	$GYLVRU\
6HUYLFHKRZHYHULWMXVWFRQWDLQVDQDGYHUWLVHPHQWIRUDFRPPHUFLDOPRQLWRULQJVROXWLRQ

&KDSWHU

,QWKLVUHFLSHZHDUHJRLQJWRDGGDQHZSDJHFDOOHG6WDWVDQGVHWLWXSWRGLVSOD\LQIRUPDWLRQ
DERXWWKHQXPEHURIUHTXHVWVWKHVHUYHUKDVWRKDQGOHFXUUHQWO\VSOLWXSE\SELECTINSERT
UPDATEDQGDELETEVWDWHPHQWVDVZHOODVDEDUGLDJUDPWKDWVKRZVWKHUDWLRRI,QQR'%
UHDGZULWHRSHUDWLRQV
0\64/*8,7RROVDUHQRWDOZD\VDYDLODEOHIRUDOOSODWIRUPVLQWKHODWHVWYHUVLRQ8VXDOO\
:LQGRZVLVXSGDWHGPRUHIUHTXHQWO\7KLVVRPHWLPHVUHVXOWVLQPLQRUGLIIHUHQFHVOLNHVOLJKW
FKDQJHVLQPHQXLWHPQDPHVDQGWKHOLNHGHSHQGLQJRQZKLFKRSHUDWLQJV\VWHP\RXXVH
)RUH[DPSOHDWWKHWLPHRIZULWLQJWKHPRVWFXUUHQW:LQGRZVYHUVLRQZDVUZKLOHIRU
0DFDQG/LQX[LWZDVU:KLOHRQ:LQGRZVWKHFRQWH[WPHQXPHQWLRQHGLQWKLVUHFLSH
LVODEHOHG$GG3DJHWKH0DFYHUVLRQFDOOVWKHVDPHFRPPDQG1HZ3DJH+RZHYHU\RX
VKRXOGQRWKDYHDQ\SUREOHPVPRYLQJDORQJ
*HWWLQJUHDG\
7RWU\WKLV\RXQHHG0\64/$GPLQLVWUDWRULQVWDOOHG)XUWKHUPRUH\RXZLOOQHHGORJLQ
FUHGHQWLDOVWRD0\64/VHUYHULQVWDQFHSUHIHUDEO\DEXV\RQHWRZDWFKVRPHUHDOGDWD2I
FRXUVHDORFDOO\LQVWDOOHGLQVWDQFHZLOOGRMXVWDVZHOO3OHDVHQRWHWKDW\RXQHHGVXIÀFLHQW
SULYLOHJHVWRLVVXHSHOWSTATUSFRPPDQGV
2QHZRUGRIDGYLFHEHIRUHZHEHJLQHYHQWKRXJKLWKDVJRWWHQPXFKEHWWHUDWWKLVZKHQ
PRGLI\LQJWKHJUDSKV0\64/$GPLQLVWUDWRUZLOOVRPHWLPHVMXVWFUDVKDQGWDNHHYHU\WKLQJ\RX
GLGVRIDUZLWKLW,WRQO\VDYHV\RXUPRGLÀFDWLRQVWRGLVNZKHQ\RXOHDYHWKHSURJUDP
,WLVKLJKO\UHFRPPHQGHGWRTXLWWKHDSSOLFDWLRQDQGUHVWDUWHYHU\RQFH
LQDZKLOHZKHQ\RXKDYHJRWVRPHWKLQJZRUNLQJ³WKHZD\\RXZRXOGOLNH
WRNHHSLWWRSUHYHQWORVLQJ\RXUIUHVKO\PDGHFXVWRPL]DWLRQV
,QFDVH\RXH[SHULHQFHUHSHDWHGFUDVKHV\RXPLJKWZDQWWRFRQVLGHUHGLWLQJWKHJUDSK
GHÀQLWLRQPDQXDOO\5HIHUWRWKH+RZLWZRUNV«VHFWLRQIRUIXUWKHULQIRUPDWLRQ
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRUDQGFRQQHFWWRWKHVHUYHU

$FWLYDWHWKH+HDOWKVHFWLRQDQGJRWRWKH&RQQHFWLRQ+HDOWKSDJH

5LJKWFOLFNRQWKHSDJHDQGFKRRVH1HZ3DJHIURPWKHFRQWH[WPHQX

(QWHU6WDWVLQWKHQHZO\RSHQHGGLDORJ,IDVNHGIRULWVSHFLI\DGHVFULSWLYHWH[W
OLNH6WDWLVWLFDOEUHDNGRZQRIGLIIHUHQWTXHU\W\SHV

0DNHVXUHWKHQHZ6WDWVSDJHLVGLVSOD\HGDQGWKHQULJKWFOLFNRQLW&KRRVH
1HZ*URXS

7RROV


(QWHU'0/6WDWHPHQWVLQWKHQDPLQJER[WKDWZLOODSSHDU

5LJKWFOLFNWKHHPSW\'0/6WDWHPHQWVJURXS&KRRVH1HZ*UDSKIURPWKHPHQX

)LOOXSWKHVHWWLQJVDVVKRZQLQWKHIROORZLQJWDEOH)LHOGVQRWOLVWHGVKRXOGEH
OHIWHPSW\
)LHOG
&RQWHQW
'LVSOD\7LWOH
1RW&KHFNHG
*UDSK7\SH
/LQH*UDSK
9DOXH)RUPXOD
^[com_select]
9DOXH8QLW
&RXQW
9DOXH&DSWLRQ
SELECT
0LQ9DOXH
0
0D[9DOXH
100
$XWR([WHQG
&KHFNHG

&OLFN2.0DF$SSO\:LQGRZV
 5HSHDWWKLVVWHSIRUWKHYDOXHIRUPXODV^[com_insert]^[com_update]
^[com_delete]DQGWKHLUDSSURSULDWHYDOXHFDSWLRQV
 5LJKWFOLFNRQWKHSDJHDQGFUHDWHDQRWKHUJURXSFDOOHG,QQR'%
 ,QVLGHWKLVJURXSDGGDQHZJUDSKZLWKWKHVHVHWWLQJV
)LHOG
&RQWHQW
7LWOH
InnoDB R/W Ratio
'LVSOD\7LWOH
&KHFNHG
*UDSK7\SH
%DU*UDSK
9DOXH)RUPXOD
([innodb_pages_read]/
([innodb_pages_
read]+[innodb_pages_
written]))*100
9DOXH8QLW
3HUFHQWDJH
9DOXH&DSWLRQ
Reads
0LQ9DOXH
0
0D[9DOXH
100
0D[&DSWLRQ
Total

&KDSWHU

'RQRWIRUJHWWRUHVWDUW0\64/$GPLQLVWUDWRUWRPDNH
\RXUFKDQJHVSHUPDQHQW
$IWHUÀOOLQJXSHDFKÀHOGDSSURSULDWHO\DVGLVFXVVHGWKHÀQDORXWSXWVKRXOGORRNOLNHWKH
IROORZLQJVFUHHQVKRW
+RZLWZRUNV
$OOJUDSKVDUHEDVHGRQVWDWXVYDULDEOHVSURYLGHGE\WKH0\64/VHUYHU7KH0\64/RQOLQH
PDQXDOFRQWDLQVDQH[WHQVLYHOLVWRIWKHVHDWhttp://dev.mysql.com/doc/refman/5.1/
en/server-status-variables.htmlGRFXPHQWLQJWKHPHDQLQJRIHDFKYDULDEOH7KH
YDOXHIRUPXODVDOORZPDWKHPDWLFDORSHUDWLRQVXVLQJWKHVHYDOXHVWKDWZLOOWKHQEHGLVSOD\HG
LQEDUJUDSKVRUOLQHJUDSKV:KLFKW\SHRIGLDJUDP\RXFKRRVHGHSHQGVRQWKHW\SHRI
LQIRUPDWLRQ\RXZRXOGOLNHWRYLVXDOL]H
%HDULQPLQGWKDWGHSHQGLQJRQZKLFKYHUVLRQRI0\64/\RXXVHWKHH[DFWVHWRIYDULDEOHV
\RXFDQXVHGRHVYDU\5HIHUWRWKHRQOLQHPDQXDOWRPDNHVXUH\RXUJUDSKGHÀQLWLRQVPDWFK
\RXUVHUYHUYHUVLRQ

7RROV

7KHH[DPSOHVLQWKLVUHFLSHSURYLGHDTXLFNRYHUYLHZRIZKDWWKHVHUYHULVFXUUHQWO\ZRUNLQJ
RQEDVHGRQWKHFRPPDQGFRXQWHUVIRUWKHLQGLYLGXDOGDWDPDQLSXODWLRQVWDWHPHQWV0RUH
VRSKLVWLFDWHGVWDWVFDQEHEXLOWXVLQJVRPHRIWKHORZHUOHYHOVWDWXVYDULDEOHVOLNHWKRVH
VWDUWLQJZLWKHandler_7KH\SURYLGHLQIRUPDWLRQWKDWPD\DOORZ\RXWRLGHQWLI\SHUIRUPDQFH
SUREOHPVRUEDGLQGH[LQJ
0\64/$GPLQLVWUDWRUVWRUHV\RXUFXVWRPGLDJUDPVLQDQ;0/ÀOH7KHQDPHDQGORFDWLRQRIWKDW
ÀOHDUHRSHUDWLQJV\VWHPGHSHQGHQW,Q:LQGRZVDQG/LQX[LWLVFDOOHGmysqladmin_health.
xml.,Q:LQGRZVLWLVORFDWHGLQWKHVDPHIROGHUDVmysqlx_user_connections.xml,Q
/LQX[DQG0DF26;WKHUHLVDVXEIROGHUQDPHGadministrator0RUHRYHUWKH0DFYHUVLRQ
XVHVDGLIIHUHQWÀOHQDPHmysqladmin_custom_health.xml
)RUWXQDWHO\WKHFRQWHQWVDUHLGHQWLFDOVRFRS\LQJDÀOHIURPRQHV\VWHPWRWKHRWKHUMXVW
UHTXLUHV\RXWRDGDSWLWVQDPHDQGSODFHDSSURSULDWHO\
,QFHUWDLQFDVHV\RXPLJKWZDQWWRHGLWWKHJUDSKGHÀQLWLRQVPDQXDOO\)RUH[DPSOHWKHUHLV
QRZD\WRFKDQJHWKHJUDSKW\SHIURP/LQHWR%DURUYLFHYHUVDRQFH\RXKDYHFUHDWHGLWLQWKH
*8,%\GLUHFWO\HGLWLQJWKH;0/GHÀQLWLRQ\RXJDLQDORWPRUHÁH[LELOLW\
&DXWLRQ
0DNHVXUHWRNHHSDEDFNXSFRS\RI\RXUHGLWVEHIRUH\RXVWDUW0\64/
$GPLQLVWUDWRUDQGWU\\RXUFKDQJHV,I\RXPDNHDPLVWDNHWKDWSUHYHQWV
0\64/$GPLQLVWUDWRUIURPUHDGLQJDQGDSSO\LQJWKHÀOHLWZLOORYHUZULWHLW
ZLWKGHIDXOWVRQH[LW
7KHUH
VPRUH
:KLOHJHQHUDOO\PRVWUHFLSHVDUHDJQRVWLFWRWKHH[DFWYHUVLRQRI0\64/\RXDUHUXQQLQJ
WKLVRQHKDVDFDYHDW0\64/KDVDNQRZQLVVXHWKDWOHDGVWRGLIIHUHQWEHKDYLRULQ
GLIIHUHQWYHUVLRQV
)URPYHUVLRQRQWKHHIIHFWLVWKDW\RXFDQQRWTXHU\WKHFRXQWHUVIRUH[DPSOHWKH
QXPEHURIWHPSRUDU\WDEOHVZLWKRXWPRGLI\LQJLWDV\RXJR,QYHUVLRQVSULRUWRWKHSHOW 
STATUSFRPPDQGVWKHIRXQGDWLRQIRUPDQ\RIWKHYDOXHV0\64/$GPLQLVWUDWRUFDQGLVSOD\
FRXOGEHH[HFXWHGZLWKRXWPRGLI\LQJWKHP7KHLUUHVXOWVZHUHVHQWWRWKHFOLHQWLPPHGLDWHO\
6WDUWLQJZLWKDWHPSRUDU\WDEOHZLWKWKHUHVXOWVLVFUHDWHGDXWRPDWLFDOO\DQGLWVFRQWHQWV
DUHVHQWWRWKHFOLHQW8QIRUWXQDWHO\WKLVWHPSRUDU\WDEOHLWVHOILVFRXQWHGLQWKHVWDWLVWLFV
(YHQWKRXJKWKLVQHZWHFKQLTXHDOORZVDFFHVVLQJWKLVVWDWLVWLFDOGDWDLQVWRUHGSURFHGXUHV
LWLQFUHDVHVQRLVHLQPHDVXULQJ$VDVLPSOHZRUNDURXQGVRPHIRUPXODVFDQEHPRGLÀHGWR
FRPSHQVDWHIRUH[DPSOHE\VXEWUDFWLQJWKHYDOXHWKDWDQLGOHVHUYHUZRXOGGLVSOD\7KLVRI
FRXUVHLVQRWYLDEOHIRUDOOW\SHVRIFDOFXODWLRQV$OVRFRQVLGHUWKDWWKHUHPLJKWEHPXOWLSOH
VLPXOWDQHRXVFRQQHFWLRQVWKDWH[HFXWHWKHVDPHTXHULHV<RXFDQQRWUHOLDEO\FRPSHQVDWH
IRUWKLV

&KDSWHU

,QWKHHQG\RXZLOOKDYHWRNHHSWKLVLQPLQGZKHQLQWHUSUHWLQJWKHVWDWV\RXVHH
)RUPRUHGHWDLOVZHVXJJHVW\RXUHDGWKHGLVFXVVLRQWKDWLVSDUWRIWKHEXJUHSRUWDYDLODEOHDW
http://bugs.mysql.com/bug.php?id=10210
'LVSOD\LQJTXHU\UHVXOWVSDJHE\SDJHDQG
ZLWKVFUROOLQJXVLQJWKH0\64/FRPPDQGOLQH
FOLHQW
7KHmysqlSURJUDPLVSDUWRIHYHU\0\64/LQVWDOODWLRQ,WLVDSRZHUIXOWRROHYHQWKRXJK
VRPHRILWVIXQFWLRQDOLW\LVRQO\DYDLODEOHRQQRQ:LQGRZVSODWIRUPV,WPD\QRWEHJUDSKLFDOO\
SOHDVLQJEXWFDQEHXVHGDVDYHUVDWLOHFOLHQWWRWKHGDWDEDVHVHUYHUERWKLQWHUDFWLYHO\DQGLQ
VFULSWHGVFHQDULRV
:KHQXVLQJWKH0\64/FRPPDQGOLQHFOLHQWmysql\RXDUHFHUWDLQO\IDPLOLDUZLWKRXWSXWV
OLNHWKHIROORZLQJVFUHHQVKRW

7RROV

,WRQO\VKRZVWZRURZVRIGDWDEXW\RXKDYHDOPRVWQRFKDQFHRIJHWWLQJWKHLQIRUPDWLRQ\RX
ZDQWHG:KHQ\RXKDYHODUJHUUHVXOWVHWVLWJHWVHYHQZRUVHEHFDXVHWKHQYHUWLFDOVFUROOLQJ
PLJKWHYHQSUHYHQW\RXIURPUHDGLQJWKHFROXPQWLWOHVGHSHQGLQJRQKRZODUJH\RXUFRQVROH
V
EXIIHULV)RUWXQDWHO\WKHUHLVDZD\WRSURFHVVWKHRXWSXWRIDQ\0\64/FRPPDQGEHIRUH
VHQGLQJLWWRWKHVFUHHQ
7KLVUHFLSHZLOOVKRZ\RXKRZWRYLHZDUHVXOWWKDWLVWRRODUJHWRÀWRQRQHVFUHHQLQDZD\WKDW
DOORZVERWKYHUWLFDODQGKRUL]RQWDOQDYLJDWLRQDVZHOODVVRPHRWKHURSHUDWLRQV
7KHQH[WH[DPSOHDVVXPHVWKDW\RXKDYHDQLQVWDQFHRIWKH0\64/VHUYHUUXQQLQJRQ\RXU
ORFDOPDFKLQH2IFRXUVH\RXFDQFRQQHFWWRDQ\RWKHUKRVWDVZHOO
*HWWLQJUHDG\
7RWU\WKLV\RXZLOOQHHGWKHmysqlFRPPDQGOLQHFOLHQWRQ0DF26;/LQX[RUDQ\RWKHU
8QL[OLNHSODWIRUP
8QIRUWXQDWHO\IRU:LQGRZVXVHUVWKHUHLVQRZD\WRDSSO\WKLVUHFLSH
EHFDXVHWKHFOLHQWFDQQRWSURYLGHWKHQHFHVVDU\IXQFWLRQDOLW\LQ
:LQGRZVDVLWLVEDVHGRQVRPHXQGHUO\LQJIXQFWLRQVWKDWDUHQRW
DYDLODEOHLQ0LFURVRIW
VRSHUDWLQJV\VWHP
<RXZLOODOVRQHHGWKHlessSDJHUXWLOLW\7KLVLVDYDLODEOHRQ0DF26;DQGYLUWXDOO\HYHU\
/LQX[GLVWULEXWLRQVR\RXVKRXOGQRWKDYHDQ\SUREOHPVKHUH)RUVLPSOLFLW\WKHH[DPSOH
DVVXPHVWKDW\RXKDYHSULYLOHJHVWRSELECTIURPWKHP\VTOV\VWHPGDWDEDVH7KLVLVQRW
UHTXLUHGKRZHYHUDVDQ\SELECTZLOOGR
+RZWRGRLW
 5XQWKHmysqlFRPPDQGOLQHFOLHQW
       $ mysql
 (QWHUWKHIROORZLQJFRPPDQGVDWWKHmysqlSURPSW
       mysql> pager less -SFX
       mysql> SELECT * FROM mysql.user;

&KDSWHU

 <RXZLOOJHWDQRXWSXWVLPLODUWRWKLV
,QWKLVYLHZ\RXFDQVFUROOKRUL]RQWDOO\DQGYHUWLFDOO\XVLQJ\RXUFXUVRUNH\V+LWWLQJWKH
TNH\ZLOOEULQJ\RXEDFNWRWKHFRPPDQGSURPSW
 2SWLRQDOO\WRXQVHWWKHSDJHUW\SHWKLV
       mysql> nopager 
+RZLWZRUNV
7KHpagerFRPPDQGDOORZV\RXWRVSHFLI\DQDUELWUDU\SURJUDPZKLFKLVH[HFXWHGZKHQHYHU
\RXZRXOGQRUPDOO\VHHWKHUHVXOWRIDVXEVHTXHQWFRPPDQG7KLVLQFOXGHVUHVXOWV
IURPSELECTVWDWHPHQWVDVZHOODVDQ\RWKHURXWSXWIRUH[DPSOHIURPSHOWENGINE 
INNODBSTATUS
7KHSURJUDPUHFHLYHVH[DFWO\WKHVDPHRXWSXWWKDWZRXOGRWKHUZLVHEHSULQWHGWRWKHFRQVROH
,QWKLVH[DPSOHWKHTXHU\UHVXOWLVKDQGHGRYHUWRWKHlessXWLOLW\DFRPPRQWRROWRGLVSOD\
LQIRUPDWLRQWKDWZRXOGXVXDOO\EHWRRODUJHWRÀWRQDVLQJOHVFUHHQlessDOORZVIUHH
QDYLJDWLRQXVLQJWKHFXUVRUNH\VZKLFKLVZKDW\RXMXVWWULHG,WDOVRNQRZVDFRPPDQGFDOOHG
qWKDWZHXVHGHDUOLHUDQGWKDWH[LWVWKHSURJUDPHIIHFWLYHO\WDNLQJ\RXEDFNWRWKH0\64/
FRPPDQGSURPSW

7RROV

7KH-SFXSDUDPHWHUVSDVVHGWRlessLQWKLVH[DPSOHVSHFLI\VRPHRSWLRQVWKDWDUH
UHFRPPHQGHGIRUXVHZLWKmysql
3DUDPHWHU 
'HVFULSWLRQ
-S 
&DXVHVOLQHVORQJHUWKDQWKHVFUHHQZLGWKWREHFKRSSHG
UDWKHUWKDQZUDSSHGDURXQG7KLVNHHSVWKHWDEOHIRUPDWRIWKH
SELECTRXWSXWLQWDFWDQGDOORZVWRQDYLJDWHKRUL]RQWDOO\XVLQJ
WKHFXUVRUNH\V
-F 
,QFDVHWKHUHVXOWRIDFRPPDQGÀWVRQVFUHHQZLWKRXWWKHQHHG
IRUDQ\VFUROOLQJlessDXWRPDWLFDOO\WHUPLQDWHVHIIHFWLYHO\
VDYLQJ\RXIURPW\SLQJTWRJHWUHDG\IRUWKHQH[WFRPPDQG
-X 
,QVWUXFWVlessWRVNLSVRPHLQLWLDOL]DWLRQWKDWZRXOGRWKHUZLVH
SRWHQWLDOO\OHDGWRXQGHVLUDEOHVFUHHQOD\RXWSUREOHPV
lessRIIHUVDODUJHQXPEHURIRWKHUSDUDPHWHUV\RXPD\SDVVWRIXUWKHUFXVWRPL]HLWV
EHKDYLRU)RUDFRPSOHWHOLVWUHIHUWRWKHPDQXDOSDJHDYDLODEOHIURPDFRPPDQGVKHOO
$ man less
([WUDFWLQJLQIRUPDWLRQIURPYHUERVHRXWSXW
XVLQJWKH0\64/FRPPDQGOLQHFOLHQW
2XWSXWIURP0\64/FRPPDQGVFDQEHUDWKHUYHUERVH)RUH[DPSOHWKHSHOWENGINE 
INNODBSTATUSFRPPDQGXVXDOO\SURGXFHVHQRXJKWH[WWRFDXVH\RXUW\SLFDOWHUPLQDO
ZLQGRZWRVFUROO
2IWHQ\RXDUHQRWLQWHUHVWHGLQHYHU\WKLQJWKHRXWSXWFRQWDLQVEXWRQO\ZDQWWRNQRZDERXW
DSDUWLFXODUGHWDLOWKDWHDVLO\JHWVORVWLQWKHRYHUDOODPRXQWRIWH[W
7KLVUHFLSHZLOOVKRZ\RXKRZWRHDVLO\H[WUDFWLQIRUPDWLRQIURPVXFKRXWSXWXVLQJDVHDUFK
WHUP,QSDUWLFXODUZHZLOOH[WUDFWWKH%8))(5322/$1'0(025<VHFWLRQIURPWKH,QQR'%
VWDWXVRXWSXW
*HWWLQJUHDG\
7RWU\WKLV\RXZLOOQHHGWKHmysqlFRPPDQGOLQHFOLHQWRQ0DF26;/LQX[RUDQ\RWKHU
8QL[OLNHSODWIRUP

&KDSWHU

8QIRUWXQDWHO\IRU:LQGRZVXVHUVWKHUHLVQRZD\WRDSSO\WKLVUHFLSH
EHFDXVHWKHFOLHQWFDQQRWSURYLGHWKHQHFHVVDU\IXQFWLRQDOLW\LQ:LQGRZV
DVLWLVEDVHGRQVRPHXQGHUO\LQJIXQFWLRQVWKDWDUHQRWDYDLODEOHLQ
0LFURVRIW
VRSHUDWLQJV\VWHP
)XUWKHUPRUH\RXZLOOQHHGWKHgrepWH[WVHDUFKXWLOLW\7KLVLVDYDLODEOHRQ0DF26;DQG
YLUWXDOO\HYHU\/LQX[GLVWULEXWLRQE\GHIDXOWVR\RXVKRXOGQRWKDYHDQ\SUREOHPVKHUH
+RZWRGRLW
 2SHQDFRQQHFWLRQWRWKH0\64/VHUYHUXVLQJWKHmysqlFRPPDQGOLQHFOLHQW
 6HWWKHSDJHUWRWKHIROORZLQJFRPPDQG
       mysql> pager grep -A 12 -e "BUFFER POOL AND MEMORY"
 5HTXHVWWKH,QQR'%VWDWXVXVLQJWKHIROORZLQJFRPPDQG
       mysql> SHOW ENGINE INNODB STATUS\G
 ,QVWHDGRIWKHFRPSOHWH,QQR'%VWDWXVRXWSXW\RXZLOORQO\VHHWKHOLQHVIROORZLQJ
WKH%8))(5322/$1'0(025<KHDGLQJ

7RROV

+RZLWZRUNV
7KHpagerFRPPDQGDOORZV\RXWRVSHFLI\DQDUELWUDU\SURJUDPZKLFKLVH[HFXWHGZKHQHYHU
\RXZRXOGQRUPDOO\VHHWKHUHVXOWRIDVXEVHTXHQWFRPPDQG7KLVLQFOXGHVUHVXOWVIURP
SELECTVWDWHPHQWVDVZHOODVDQ\RWKHURXWSXWIRUH[DPSOHIURPWKHSHOWENGINEINNODB 
STATUSFRPPDQG
7KHSURJUDPLVKDQGHGWKHH[DFWVDPHRXWSXWWKDWZRXOGRWKHUZLVHEHSULQWHGWRWKHFRQVROH
,QWKLVH[DPSOHWKHTXHU\UHVXOWLVKDQGHGWRWKHgrepXWLOLW\³DFRPPRQWRROWRVHDUFKIRU
NH\ZRUGVRUSKUDVHVLQWH[WFRQWHQW,WRIIHUVDZLGHUDQJHRISDUDPHWHUVDQGFRQÀJXUDWLRQ
RSWLRQV,QWKLVH[DPSOHWKH-AQXPEHURIOLQHVWREHGLVSOD\HGDIWHUWKHRQHWKDWFRQWDLQHG
WKHVHDUFKWHUPDQG-eVSHFLÀHVWKHVHDUFKWHUPRSWLRQVDUHXVHGWRÀUVWORRNIRUDOLQH
WKDWFRQWDLQVWKHWH[W%8))(5322/$1'0(025<DQGRXWSXWVWKLVDQGWKHOLQHV
IROORZLQJLW
7KHH[DFWQXPEHURIOLQHVWREHXVHGGHSHQGVRQWKHRXWSXW\RXDUHÀOWHULQJ,QWKLVH[DPSOH
WKHOHQJWKRIWKHUHOHYDQWVHFWLRQLV\RXZLOOKDYHWRDGDSWWKLVWRDYDOXHVXLWDEOHIRU\RXU
SDUWLFXODUXVHFDVH.HHSLQJDQRWHDWKDQGZLWKWKHFRUUHFWQXPEHURIOLQHVIRU\RXUPRVW
FRPPRQO\XVHGFRPPDQGVLVUHFRPPHQGHG
7KHUH
VPRUH
grepLVQRWOLPLWHGWRVHDUFKLQJIRUÀ[HGWH[WIUDJPHQWV,WVXSSRUWVFDVHVHQVLWLYHDQG
FDVHLQVHQVLWLYHPRGHVPDWFKLQJOLQHVWKDWGRRUVSHFLÀFDOO\GRQ
WFRQWDLQWKHVHDUFKWHUP
DQGPXFKPRUH$SDUWIURPVLPSOHVHDUFKWHUPV\RXFDQDOVRVSHFLI\WRVHDUFKXVLQJUHJXODU
H[SUHVVLRQVZKLFKPDNHVLWH[WUHPHO\ÁH[LEOHDQGSRZHUIXO<RXVKRXOGKDYHDORRNDWWKH
grepPDQXDOSDJHVIRUPRUHGHWDLOHGLQIRUPDWLRQ
2YHUWLPH\RXZLOOÀQG\RXUVHOIXVLQJWKHVDPHÀOWHUVUHSHDWHGO\&RQVLGHUSXWWLQJWKHVHLQWR
VPDOOLQGLYLGXDOVKHOOVFULSWVWKDWFDQDOVREHXVHGDVDpagerVDYLQJ\RXWKHWURXEOHRI
W\SLQJSRWHQWLDOO\ORQJDQGFRPSOH[FRPPDQGVRYHUDQGRYHUDJDLQ
6SHFLI\LQJDGHIDXOWSDJHU
,QWKH'LVSOD\LQJTXHU\UHVXOWVSDJHE\SDJHDQGZLWKVFUROOLQJXVLQJWKHP\VTOFRPPDQGOLQH
FOLHQWDQG([WUDFWLQJLQIRUPDWLRQIURPYHUERVHRXWSXWXVLQJWKHP\VTOFRPPDQGOLQHFOLHQW
UHFLSHVZHSUHVHQWHGDZD\WRKDYHWKHmysqlFRPPDQGOLQHFOLHQWVHQGLWVRXWSXWWKURXJK
DQH[WHUQDOSURJUDPWRKDYHLWIRUPDWWHGEHIRUHGLVSOD\LQJ
'HSHQGLQJRQZKDWNLQGRISURFHVVLQJ\RXQHHGWKHFOLHQW
VpagerFRPPDQGSURYLGHVD
XVHIXOZD\RIVSHFLI\LQJWKHH[WHUQDOFRPPDQGWRXVH+RZHYHUWKLVFKRLFHLVORVWRQFH\RX
H[LWWKHFOLHQW1H[WWLPH\RXZDQWWRXVHLW\RXDUHEDFNZLWKWKHVWDQGDUGRXWSXWKDQGOLQJ
ZKLFKLVWRVLPSO\ZULWHWKHGDWDWR\RXUFRQVROH

&KDSWHU

7KLVUHFLSHZLOOVKRZ\RXKRZWRFRQÀJXUHmysqlWRXVHDQH[WHUQDOFRPPDQGRI\RXUFKRLFH
DVWKHGHIDXOWRQVWDUWXSDQGZKHQHYHU\RXLVVXHWKHpagerFRPPDQGZLWKRXWSDUDPHWHUVWR
UHYHUWWRWKHGHIDXOWVHWWLQJ
7KHQH[WH[DPSOHDVVXPHV\RXKDYHDQLQVWDQFHRIWKH0\64/VHUYHUUXQQLQJRQ\RXUORFDO
PDFKLQH<RXFDQDOVRFRQQHFWWRDQ\RWKHUKRVW
*HWWLQJUHDG\
7RWU\WKLV\RXZLOOQHHGWKHmysqlFRPPDQGOLQHFOLHQWRQ0DF26;/LQX[RUDQ\RWKHU
8QL[OLNHSODWIRUP
8QIRUWXQDWHO\IRU:LQGRZVXVHUVWKHUHLVQRZD\WRDSSO\WKLVUHFLSH
EHFDXVHWKHFOLHQWFDQQRWSURYLGHWKHQHFHVVDU\IXQFWLRQDOLW\LQ:LQGRZV
DVLWLVEDVHGRQVRPHXQGHUO\LQJIXQFWLRQVWKDWDUHQRWDYDLODEOHLQ
0LFURVRIW
VRSHUDWLQJV\VWHP
,QWKLVH[DPSOHZHDUHJRLQJWRXVHWKHZHOONQRZQlessSDJHUXWLOLW\WKDWFRPHV
SUHLQVWDOOHGLQ0DF26;DQGYLUWXDOO\HYHU\/LQX[GLVWULEXWLRQDQGVHWLWXSDVWKHGHIDXOW
SDJHUHIIHFWLYHO\PDNLQJDOOmysqlRXWSXWQDYLJDEOHLILWLVODUJHUWKDQ\RXUWHUPLQDO
+RZWRGRLW

)URP\RXUKRPHGLUHFWRU\RSHQWKH.my.cnfÀOHLQDWH[WHGLWRU1RWHWKDWWKLVLVD
KLGGHQÀOHEHFDXVHRIWKHOHDGLQJGRW.LQWKHÀOHQDPH,ILWGRHVQRW\HWH[LVW
FUHDWHDQHPSW\ÀOHZLWKWKDWQDPH0DNHVXUH\RXLQFOXGHWKHOHDGLQJGRWLQWKH
ÀOHQDPH

/RRNIRUDVHFWLRQFDOOHG[mysql],ILWLVQRWWKHUHDGGLWE\LQVHUWLQJWKHIROORZLQJ
OLQHDWWKHHQGRIWKHÀOH
[mysql]

%HORZWKDWOLQHDQGEHIRUHDQ\RWKHUVHFWLRQLQVHUWWKLV
pager=less -SFX

6DYHWKHÀOH
(DFKQHZLQVWDQFHRIWKHFRPPDQGOLQHFOLHQW\RXVWDUWIURPQRZRQZLOOGHIDXOWWRWKH
less-SFXSDJHU<RXFDQVWLOOXVHWKHpagerFRPPDQGWRVSHFLI\DGLIIHUHQWFRPPDQG
WRSURFHVVRXWSXWLQVLGHmysql

7RROV

+RZLWZRUNV
:KHQWKHP\VTOFOLHQWVWDUWVLWORRNVIRURSWLRQVLQDÀOHFDOOHG.my.cnfLQ\RXUKRPH
GLUHFWRU\,QVLGHWKLVÀOHLWUHDGVWKH[client]DQG[mysql]VHFWLRQV%\SODFLQJDpager
VHWWLQJLQWKHUHZHFRQÀJXUHGDSDJHUGLIIHUHQWIURPWKHGHIDXOW
0DNHVXUH\RXSXWWKHpagerVHWWLQJLQWKH[mysql]VHFWLRQDQGQRWLQ
WKH[client]VHFWLRQ
:KLOHWKHmysqlFRPPDQGOLQHFOLHQWZRXOGZRUNZLWKWKHQHZVHWWLQJ
RWKHUFOLHQWWRROVVXFKDVmysqladminZRXOGDOVRWU\WRUHDGLWDQGPLJKW
DERUWEHFDXVHWKH\GRQRWNQRZZKDWWRGRZLWKLW[mysql]KRZHYHULV
VROHO\UHDGE\WKHFRPPDQGOLQHFOLHQW
7KHUH
VPRUH
7KHH[DPSOHXVHVWKH.my.cnfRSWLRQÀOHLQ\RXUKRPHGLUHFWRU\WRVSHFLI\WKHGHIDXOWSDJHU
,QDPXOWLXVHUHQYLURQPHQWWKLVPDNHVSHUIHFWVHQVHVLQFHHYHU\RQHFDQFRQÀJXUHWKHLU
FOLHQWZLWKLQGLYLGXDOVHWWLQJV
%XWWKHUHDUHVHYHUDOORFDWLRQVmysqlORRNVLQIRULWVFRQÀJXUDWLRQWKDWPLJKWFRPHLQ
KDQG\LI\RXZDQWWRVKDUHSDUWVRI\RXUFRQÀJXUDWLRQDPRQJVHYHUDOXVHUDFFRXQWV7KH\
DUHH[SODLQHGLQGHWDLOLQVHFWLRQ8VLQJ2SWLRQ)LOHVLQWKH0\64/RQOLQHPDQXDODW
http://dev.mysql.com/doc/refman/5.1/en/option-files.html
8VLQJDFXVWRPSURPSWWRGLVWLQJXLVK
FRQQHFWLRQV
,QPDQ\VLWXDWLRQVWKHmysqlFRPPDQGOLQHFOLHQWSURJUDPLVWKHÀUVWFKRLFHZKHQ
FRQQHFWLQJWR0\64/VHUYHUV:LWKLWVGHIDXOWmysql>SURPSWLWVHWVLWVHOIDSDUWIURPWKH
ORFDOFRPPDQGVKHOO
VSURPSWVR\RXNQRZZKHUH\RXDUHDWDJODQFH
%XWZKHQ\RXQHHGWRFRQQHFWWRPRUHWKDQRQHVHUYHUDWDWLPHRUPD\EHMXVWNHHSPXOWLSOH
FRQQHFWLRQVWRWKHVDPHRQHRSHQWKLVVLPSOHSURPSWLVQRWHQRXJKWRTXLFNO\WHOOWKH
VHVVLRQVDSDUW
,QWKLVUHFLSHZHZLOOFKDQJHWKHGHIDXOWSURPSWWRLQFOXGHXVHIXOVHVVLRQUHODWHGLQIRUPDWLRQ
,WZLOOEHFRQÀJXUHGWRVKRZWKHKRVW\RXDUHFRQQHFWHGWRWKHXVHUQDPHXVHGWRORJLQDQG
WKHFXUUHQWGHIDXOWGDWDEDVH

&KDSWHU

*HWWLQJUHDG\
7RWU\WKLV\RXZLOOQHHGWKHmysqlFRPPDQGOLQHFOLHQWDQGORJLQFUHGHQWLDOVWRDWOHDVW
RQH0\64/VHUYHU,GHDOO\\RXFDQDFFHVVPRUHWKDQRQHPDFKLQHWRVHHWKHHIIHFWRIDOO
VHWWLQJVSUHVHQWHG
,Q:LQGRZVWKHUHLVQR.my.cnfEXWDmy.iniÀOH0RUHRYHULWLV
QRWXVXDOO\ORFDWHGLQ\RXUXVHUSURÀOH³RUKRPH³GLUHFWRU\EXWLQWKH
:LQGRZVIROGHURUWKHIROGHU\RXU0\64/LQVWDOODWLRQUHVLGHVLQ,I\RX
DUHXQVXUHXVHWKHmy.iniLQWKH:LQGRZVGLUHFWRU\RUFUHDWHRQH
WKHUHLILWGRHVQRWH[LVW\HW
+RZWRGRLW

2SHQWKH.my.cnfÀOHLQDWH[WHGLWRU,WLVORFDWHGLQ\RXUKRPHGLUHFWRU\,ILWGRHV
QRW\HWH[LVWFUHDWHDQHPSW\ÀOHZLWKWKDWQDPH0DNHVXUH\RXLQFOXGHWKHOHDGLQJ
GRWLQWKHÀOHQDPH

/RRNIRUDVHFWLRQFDOOHG[mysql],ILWLVQRW\HWWKHUHDGGLWE\LQVHUWLQJWKH
IROORZLQJOLQH
[mysql]

%HORZWKDWOLQHDQGEHIRUHDQ\RWKHUVHFWLRQLQVHUWWKLV
prompt=\\h/\\u:[\\d]>\\_

6DYHWKHÀOH

2SHQDWOHDVWWZRFRQQHFWLRQVZLWKGLIIHUHQWFUHGHQWLDOVDQGRUWRGLIIHUHQWKRVWV,Q
HDFKFRQQHFWLRQ\RXFDQQRZVHHWKHKRVW\RXDUHFRQQHFWHGWRIROORZHGE\\RXU
XVHUQDPHDQGWKHQDPHRIWKHFXUUHQWGHIDXOWGDWDEDVH

7RROV

+RZLWZRUNV
%DVLFDOO\WKHZD\WKLVUHFLSHZRUNVLVWKHVDPHDVGHVFULEHGLQWKH6SHFLI\LQJDGHIDXOWSDJHU
UHFLSH7KHGLIIHUHQFHLVMXVWWKHSDUDPHWHU\RXVHWprompt3OHDVHUHDGWKHGHVFULSWLRQ
WKHUHWRJHWDGHHSHULQVLJKWLQWRWKHSUHIHUHQFHÀOHPHFKDQLVP
7KHYDOXHZHVHWIRUpromptFRQVLVWVRIVHYHUDOWRNHQVHDFKRIZKLFKJHWVUHSODFHGZLWKD
YDOXHVSHFLÀFWRWKHFXUUHQWFRQQHFWLRQ
7RNHQ
5HSODFHPHQW
\\h 
7KHQDPHRIWKHKRVW\RXDUHFRQQHFWHGWR
\\u 
<RXUXVHUQDPH
\\d 
7KHQDPHRIWKHFXUUHQWGHIDXOWGDWDEDVH
\\_ 
$VSDFHFKDUDFWHU
)RUWKHPDFKLQHXVHGWRZULWHWKLVERRNWKHSURPSWLQWKLVH[DPSOHLVH[SDQGHGDVIROORZV
Database
\\h/\\u:[\\d]>\\_
Host
User
Space
Database
yavin-mac/ds:[mysql]
Host
User
Space
7KHUH
VPRUH
6HHWKH7KHUH
VPRUHVHFWLRQRIWKH6SHFLI\LQJDGHIDXOWSDJHUUHFLSHIRUPRUHLQIRUPDWLRQ
RQWKHSDUDPHWHUVÀOH
$SDUWIURPWKHWRNHQVXVHGLQWKLVH[DPSOHWKHUHDUHVHYHUDOPRUHWKDWDOORZ\RXWRIXUWKHU
WDLORUWKHpromptWR\RXUQHHGV<RXFDQÀQGDFRPSUHKHQVLYHOLVWIRU\RXU0\64/YHUVLRQLQ
WKHVHUYHU
VRQOLQHPDQXDOVHFWLRQP\VTO&RPPDQGVDWhttp://dev.mysql.com/
doc/refman/5.1/en/mysql-commands.html
&RQÀJXULQJDpromptWKDWUHDOO\VXLWVDOO\RXUQHHGVLVRIWHQDPDWWHURIWULDODQGHUURUDQG
FDQWDNHVRPHWLPHEHIRUH\RXDUHUHDOO\VDWLVÀHG7RVSHHGXSWKLVSURFHVVXVHWKHprompt
FRPPDQGLQVLGHmysqlWRFKDQJHWKHSURPSWIRURQO\WKHFXUUHQWVHVVLRQLQWHUDFWLYHO\
2QFH\RXDUHGRQH\RXFDQSXWLWLQWRWKHRSWLRQÀOHWRDXWRPDWLFDOO\XVHLWWKHQH[WWLPHWKH
FOLHQWVWDUWV

&KDSWHU

6HHDOVR
f
6SHFLI\LQJDGHIDXOWSDJHU
(QFU\SWLQJD0\64/VHUYHUFRQQHFWLRQ
ZLWK66+
:KHQFRQQHFWLQJWR0\64/VHUYHURYHUWKH,QWHUQHW\RXVKRXOGEHDZDUHWKDWDQ\
FRPPXQLFDWLRQVEHWZHHQ\RXUFOLHQWDQGWKHKRVWPDFKLQHDUHWUDQVIHUUHGZLWKRXWDQ\
HQFU\SWLRQ7KLVDSSOLHVWRERWKWKHORJLQFUHGHQWLDOVDQGWKHDFWXDOGDWDEDVHFRQWHQWV
\RXVHQGWRRUUHFHLYHIURPWKHVHUYHU:KLOHWKH0\64/DXWKHQWLFDWLRQVFKHPDSURYLGHV
VRPHPHDVXUHRISURWHFWLRQIRU\RXUSDVVZRUGLWLVQRWVHQWLQWKHFOHDUEXWXVLQJD
FKDOOHQJHUHVSRQVHW\SHPHFKDQLVPLWLVQRWDVVHFXUHDVLI\RXZHUHXVLQJDUHDO
FU\SWRJUDSKLFHQFU\SWLRQ
7KRXJKLQDFRQWUROOHGHQYLURQPHQWOLNHDFRUSRUDWHORFDODUHDQHWZRUNWKLVPD\QRWEHPXFK
RIDQLVVXHVHQGLQJGDWDEDVHFRQWHQWVWKURXJKDSXEOLFQHWZRUNLVDGLIIHUHQWWKLQJ
7KHRUHWLFDOO\0\64/DOORZV66/VHFXUHGFRQQHFWLRQVEHWZHHQWKHVHUYHUDQGLWVFOLHQWVLI
ERWKDUHEXLOWWRVXSSRUWLW8QIRUWXQDWHO\WKHGHIDXOW0\64/SDFNDJHVDYDLODEOHIRUGRZQORDG
IURPWKHmysql.comZHEVLWHDUHQRWHQFU\SWLRQHQDEOHG7RJHWWKDW\RXZRXOGKDYHWR
FRPSLOHWKHVHUYHUIURPWKHVRXUFHFRGHDQGLQFOXGHWKHQHFHVVDU\HQFU\SWLRQRSWLRQV
7KLVLVWHGLRXVDQGUHTXLUHVDUDWKHUVXEVWDQWLDODPRXQWRINQRZOHGJHDQGWKHDSSURSULDWH
WRROFKDLQ
7KLVUHFLSHZLOOVKRZ\RXKRZWRHVWDEOLVKDQHQFU\SWHGFRQQHFWLRQWRDVWDQGDUG0\64/
VHUYHUZLWKDQ\FOLHQWSURJUDPVXFKDVWKHFRPPDQGOLQHFOLHQWRU0\64/*8,7RROVDQGVR
RQ,QWKHQH[WH[DPSOHZHZLOOHQFU\SWDFRQQHFWLRQIURP0\64/$GPLQLVWUDWRUWRDGHIDXOW
0\64/VHUYHU
*HWWLQJUHDG\
)RUWKLVUHFLSHWRZRUNWKH0\64/VHUYHU
VRSHUDWLQJV\VWHPKDVWRVXSSRUWDVHFXUHVKHOO
66+FRQQHFWLRQ0RVW/LQX[GLVWULEXWLRQVLQFOXGHRXWRIWKHER[VXSSRUWIRUWKLV0DF26;
/HRSDUGDOVRVXSSRUWVHQFU\SWHG66+FRQQHFWLRQVZLWKRXWWKLUGSDUW\SURGXFWV(DUOLHU
YHUVLRQVPXVWEHDPHQGHGZLWKDSSURSULDWHVRIWZDUHSDFNDJHV
:LQGRZVXVHUVDOVRQHHGWRLQVWDOOWKH66+VHUYHUWKHPVHOYHV7KHUHDUHVHYHUDOFRPPHUFLDO
RIIHULQJVEXWIRUWKHSXUSRVHRIWKLVUHFLSHWKH66+VHUYHUDYDLODEOHZLWKWKH&\JZLQSDFNDJH
LVFRPSOHWHO\VXIÀFLHQW

7RROV

0DNHVXUH\RXKDYHVHWXS66+FRUUHFWO\EHIRUH\RXSURFHHG,Q0DF26;JRWRWKH6\VWHP
3UHIHUHQFHVDQGRSHQWKH6KDULQJSDQHDVVHHQLQWKHIROORZLQJVFUHHQVKRW(QDEOH
5HPRWH/RJLQDQGPDNHVXUH\RXVHOHFWWKHDSSURSULDWHXVHUDFFRXQWV
,Q/LQX[\RXXVXDOO\GRQRWKDYHWRGRDQ\WKLQJ
,Q:LQGRZVIROORZWKHVHWXSLQVWUXFWLRQVIRUWKH66+VHUYHURI\RXUFKRLFHIRUH[DPSOHIURP
http://www.cygwin.com or http://www.freesshd.com/)
3OHDVHQRWHWKDW\RXZLOOQHHGDVHWRIXVHUQDPHDQGSDVVZRUGIRUWKH
0\64/VHUYHUDVZHOODVIRUWKHRSHUDWLQJV\VWHPLWUXQVRQ7KLVLV
EHFDXVHWKH66+ZLOOFKHFNEHIRUHDOORZLQJ\RXWRWU\WRFRQQHFWWRWKH
GDWDEDVHVHUYHU
:KLOHLQ/LQX[DQG0DF26;DOOQHFHVVDU\FOLHQWWRROVDUHDJDLQEXQGOHGZLWKWKHRSHUDWLQJ
V\VWHP:LQGRZVXVHUVQHHGWRDFTXLUHDQ66+FOLHQWSURJUDPDQGLQVWDOOLWRQWKHPDFKLQH
ZKHUHWKH\ZDQWWRUXQWKHLU0\64/FOLHQW7KH&\JZLQSDFNDJHLQFOXGHVDQSSHFOLHQWEXW
WKHUHLVDEHWWHUDOWHUQDWLYH7KHH[FHOOHQWIUHH3X77<66+FOLHQW,WLVDYDLODEOHRQWKH:HE
DWhttp://www.chiark.greenend.org.uk/~sgtatham/puttyDOWHUQDWLYHO\MXVWHQWHU
puttyLQWRDVHDUFKHQJLQHRI\RXUFKRLFH:HZLOOXVHLWLQWKLVDQGWKHIROORZLQJUHFLSHV
,QWKHQH[WH[DPSOHZHDUHJRLQJWRORJLQWRD0\64/VHUYHURQ0DF26;WKURXJKDVHFXUH
FKDQQHOHVWDEOLVKHGYLD66+IURPD:LQGRZVPDFKLQH

&KDSWHU

+RZWRGRLW

,Q/LQX[DQG0DF26;RSHQDFRPPDQGOLQHVKHOO,Q:LQGRZVODXQFK3X77<

,Q/LQX[DQG0DF26;HQWHUWKHIROORZLQJFRPPDQG5HSODFHOSUSERZLWKWKH
RSHUDWLQJV\VWHPDFFRXQWQDPH5HSODFHHOSTZLWKWKH66+VHUYHUKRVWQDPH
   $ ssh -L3316:127.0.0.1:3306 2686(5@+267
1RWLFHWKDWWKHUHLVQRPHQWLRQRID0\64/XVHUQDPHRU
SDVVZRUG\HW7KLVLVSXUHO\WRORJRQWRWKH66+VHUYHU
,Q:LQGRZVVHWXSDFRQQHFWLRQZLWK3X77<PDNLQJVXUH\RXKDYHWKHIROORZLQJ
VHWWLQJVRQWKH&RQQHFWLRQ66+7XQQHOVSDJH
0DNHVXUH\RXKLWWKH$GGEXWWRQRQFH\RXKDYHHQWHUHGWKH
6RXUFHSRUWDQG'HVWLQDWLRQRWKHUZLVHWKHWXQQHOVHWWLQJV
ZLOOQRWEHDFWLYDWHG

)RU/LQX[DQG0DF26;KLWWKH(QWHUNH\IRU:LQGRZVFOLFNWKH2SHQEXWWRQ

/RJLQWRWKHVHUYHUXVLQJ\RXURSHUDWLQJV\VWHPSDVVZRUG

:KHQDVNHGWRFRQÀUPWKHUHPRWHKRVW
VLGHQWLW\DFFHSWWKHNH\SUHVHQWHGWR\RX
7KLVZLOORQO\KDSSHQXSRQWKHÀUVWFRQQHFWLRQ

7RROV

 2QFHWKHFRQQHFWLRQKDVEHHQHVWDEOLVKHGODXQFK0\64/$GPLQLVWUDWRU

6HWXSDFRQQHFWLRQOLNHWKLV
3OHDVHQRWHWKDWWKHVHUYHUKRVWLVlocalhostHYHQWKRXJK
\RXDUHDERXWWRFRQQHFWUHPRWHO\$OVRPDNHVXUHWKDWWKHSRUW
QXPEHULVVHWWR33167KHXVHUQDPHDQGSDVVZRUGDUHWKRVH
IRUWKH0\64/VHUYHUWKLVWLPH
 &OLFNRQ2.WRFRQQHFW
 7RGLVFRQQHFWODWHUÀUVWFORVH0\64/$GPLQLVWUDWRUWKHQWKH66+FOLHQWSURJUDP
+RZLWZRUNV
7KH66+VHUYHURUGDHPRQDVLWLVRIWHQFDOOHGDQGFOLHQWWRROVHWSURYLGHDYHUVDWLOHDQG
SRZHUIXOZD\RIWXQQHOLQJQHWZRUNFRQQHFWLRQVWKURXJKWKHVHFXUHOLQNWKH\HVWDEOLVKZLWK
RQHDQRWKHU7KLVIHDWXUHHQDEOHVHQFU\SWHGGDWDWUDQVIHUVIRUDSSOLFDWLRQVWKDWDUHQRW
DEOHWRGRVRWKHPVHOYHVOLNHLQRXUFDVHWKHGHIDXOW0\64/VHUYHUDQGFOLHQWEXLOGV
7RPDNHWKHHQFU\SWLRQSURFHVVWUDQVSDUHQWWRWKHWXQQHOHGDSSOLFDWLRQ0\64/WKH66+
FOLHQWDFFHSWVLQFRPLQJFRQQHFWLRQVRQDFRQÀJXUDEOH7&3SRUWRQLWVEHKDOI$Q\FRQQHFWLRQ
WKDWLVHVWDEOLVKHGZLWKWKLVSRUWJHWVLWVGDWDHQFU\SWHGDQGVHQWWRWKH66+GDHPRQ7KH
GDHPRQWKHQGHFU\SWVWKHGDWDDQGUHOD\VWKHRULJLQDOLQIRUPDWLRQWRWKHRULJLQDOWDUJHWWKH
0\64/VHUYHU

&KDSWHU

ServerMachine
publicIPaddress
10.10.0.1/24
MySQL
Server
Listenson
127.0.0.1:3306
Listenson
127.0.0.1:3306
ClientMachine
publicIPaddress
10.10.20.2/24
MySQL
Client
Connectsto
127.0.0.1:3316
Forwardsto10.10.0.1:22
Listenson
127.0.0.1:3316
SSH Client
UntrustedNetwork
regular,
unencrypted
MySQL
traffic
Totheserver
trafficappears
tobecoming
fromthelocal
host.
SSHtunnelencapsulatesMySQLdata
securelyandtransparently.Bothclient
andserverconnecttotheirrespective
localhosts,SSHhandlestherest.
Listenson10.10.0.1:22
Forwardsto
127.0.0.1:3306
SSH Server
SSHTunnellingSchematics
/HW
VKDYHDORRNDWWKHFRPPDQGOLQHZHXVHGRQWKHFOLHQWPDFKLQHWKLVLVRQWKHULJKWVLGH
LQWKHSUHFHGLQJLPDJH7KHSDUDPHWHUVLQ3X77<DUHLGHQWLFDO
$ ssh -L3316:127.0.0.1:3306 2686(5@+267
sshLVWKHQDPHRIWKHFOLHQWSURJUDP7KH-L3316SDUDPHWHUWHOOVLWWRRSHQSRUWRQ
WKHORFDOPDFKLQHKHQFHWKH-L
)ROORZLQJWKDWWKHDGGUHVVDQGSRUWRIWKHWDUJHW0\64/VHUYHUDUHVHW7KLVLVDOLWWOHGLIÀFXOW
WRXQGHUVWDQGDWÀUVWEHFDXVH127.0.0.1LVWKHVWDQGDUGDGGUHVVRIWKHORFDOKRVW7KH
NH\WRXQGHUVWDQGWKLVLVWKDWWKHSDUWDIWHUWKHFRORQLVDQDGGUHVVIURPWKHSHUVSHFWLYHRI
WKH66+UHPRWHVHUYHUPDFKLQH,QWKHH[DPSOHWKH0\64/VHUYHULVUXQQLQJRQWKH0DF
7KH66+VHUYHULVDOVRUXQQLQJWKHUHVRIURPLWVSRLQWRIYLHZWKHGDWDEDVHLVUHDFKDEOHYLD
127.0.0.1RQWKHGHIDXOWSRUW3306RQWKHOHIWVLGHLQWKHHDUOLHULPDJH
)LQDOO\OSUSER@HOSTWHOOVWKHFOLHQWZKLFKKRVWWRFRQQHFWWRDQGZKLFKXVHUDFFRXQWWR
ORJLQZLWK
2QFHWKHVHFXUHFKDQQHOLVHVWDEOLVKHG0\64/$GPLQLVWUDWRUFDQFRQQHFWWRSRUW3316 RQ
LWVORFDO:LQGRZVPDFKLQHsshWUDQVSDUHQWO\IRUZDUGVWKHFRQQHFWLRQWRWKHHOSTPDFKLQH
ZKLFKLQWXUQFRQQHFWVWRWKHGDWDEDVHRQSRUW3306,QWKHLOOXVWUDWLRQUHIHUWRWKHSUHYLRXV
ÀJXUHWKLVLVWKHGDVKHGOLQHLQVLGHWKHWXQQHOGHSLFWHGLQJUD\
<RXFDQDOVRWHOOsshWROLVWHQWRFRQQHFWLRQVRQWKHUHJXODUSRUWDVORQJDVWKHUHLVQR
RWKHUSURFHVVVXFKDVDORFDO0\64/VHUYHUXVLQJLWDOUHDG\

7RROV

,QWKHQH[WVFUHHQVKRWQRWLFHWKHLQIRUPDWLRQLQWKHXSSHUPRVWER[&RQQHFWHGWR0\64/
6HUYHU,QVWDQFH$VIDUDV0\64/$GPLQLVWUDWRULVFRQFHUQHGLWGRHVQRWNQRZDERXWWKH
HOSTPDFKLQHIURPLWVSRLQWRIYLHZLWLVFRQQHFWHGWRlocalhostSRUW33167KLVLVQRUPDO
EHKDYLRULQWKLVVFHQDULR
7KHUH
VPRUH
%\QRZ\RXPXVWKDYHDOUHDG\XQGHUVWRRGIURPWKHGHVFULSWLRQHDUOLHUWKDW\RXQHHGQRW
QHFHVVDULO\KDYHWKH66+GDHPRQLQVWDOOHGRQWKHVDPHPDFKLQHDVWKHWDUJHW0\64/
VHUYHU,QIDFWLQPDQ\SURGXFWLRQVFHQDULRV\RXZLOOKDYHDVLQJOH66+JDWHZD\VHUYHU
IURPZKLFK\RXFDQUHDFK\RXU0\64/VHUYHUV<RXFDQWKHQFRQQHFWWRWKLVJDWHZD\VHUYHU
ZLWKRQHRUPRUH66+FOLHQWVDQGKDYHLWUHOD\0\64/FRPPXQLFDWLRQVWRWKHUHVSHFWLYH
GDWDEDVHVHUYHUV
2IWHQKRVWLQJSURYLGHUVZLOOQRWDOORZ\RXWRORJLQWR\RXU0\64/VHUYHUGLUHFWO\IRUVHFXULW\
UHDVRQV7KH\GRKRZHYHUXVXDOO\HTXLS\RXZLWKDVHWRI66+XVHUFUHGHQWLDOVIRUPDQDJLQJ
WKHVHUYHU8VXDOO\\RXJHWWRDFRPPDQGVKHOOZKHQ\RXORJLQXVLQJ3X77<RUDVLPLODUFOLHQW
SURJUDP:LWKWKLVUHFLSH\RXZLOOQRORQJHUEHFRQÀQHGWRXVLQJWKHmysqlFRPPDQGOLQH
FOLHQWIRU\RXUGDWDEDVHPDQDJHPHQWQHHGVEXWVLPSO\UXQ\RXUWRRORIFKRLFHIRUH[DPSOH
0\64/4XHU\%URZVHUORFDOO\DQGMXVWWXQQHOLWWKURXJK66+
,I\RXZDQWWRDWWDFKWRGLIIHUHQW0\64/KRVWVIURPWKHVDPHFOLHQWEHVXUHWRVSHFLI\DQ
LQGLYLGXDOORFDOSRUWQXPEHUIRUH[DPSOHIRUHDFKFRQQHFWLRQDVWKHKRVW
QDPHZLOOEHlocalhostIRUDOORIWKHP

&KDSWHU

&UHDWLQJDQHQFU\SWHG0\64/FRQVROHYLD66+
2IWHQ\RXFRQQHFWWRDUHPRWHPDFKLQHXVLQJ66+MXVWWRODXQFKWKHmysqlFRPPDQGOLQH
FOLHQWDVVRRQDV\RXDUHORJJHGLQ(VSHFLDOO\RQGHGLFDWHGGDWDEDVHPDFKLQHVLWZRXOGEH
HDVLHUWRJHWWKHmysqlSURPSWULJKWDIWHU\RXHVWDEOLVKHGWKH66+FRQQHFWLRQ
,QWKLVUHFLSHZHZLOOVHWXSDGHGLFDWHGXVHUDFFRXQWRQWKHVHUYHUPDFKLQHWKDW
DXWRPDWLFDOO\ODXQFKHVWKHmysqlFRPPDQGOLQHFOLHQWDQGFRQQHFWV\RXWRWKH0\64/
VHUYHURQFH\RXORJLQXVLQJ66+:KHQ\RXOHDYHWKHmysqlFOLHQW\RXZLOODXWRPDWLFDOO\EH
GLVFRQQHFWHGIURP66+DVZHOO
,PSRUWDQW7KHSURFHGXUHSUHVHQWHGLQWKLVUHFLSHPD\SRVHDVHFXULW\ULVN
(IIHFWLYHO\XVHUVKDYHJRWVKHOODFFHVVZLWKWKLV
7KHUHIRUHDSSO\WKLVUHFLSHRQO\LQWLJKWO\FRQWUROOHGHQYLURQPHQWVZLWK
WUXVWZRUWK\DQGZHOONQRZQXVHUV
1HYHUXVHLWWRDOORZDUELWUDU\DFFHVVWR\RXUVHUYHUV
mysqlSURYLGHVWKHsystemFRPPDQGRQ8QL[OLNHRSHUDWLQJV\VWHPV7KLVFRPPDQG
DOORZV\RXWRUXQRSHUDWLQJV\VWHPOHYHOFRPPDQGVLQWKHFRQWH[WRIWKHFXUUHQWO\ORJJHGLQ
XVHU(YHQWKRXJKLQWKHH[DPSOHZHXWLOL]HGDUHVWULFWHGXVHUDFFRXQWWKDWGRHVQRWKDYH
DQ\VSHFLDOULJKWVLWFDQVWLOODFFHVVZRUOGUHDGDEOHÀOHVOLNH/etc/passwdDQGH[HFXWH
SURJUDPVDVLILWZHUHORJJHGRQWRWKHVHUYHUPDFKLQHORFDOO\
*HWWLQJUHDG\
)RUWKLVUHFLSHWRZRUNWKH0\64/VHUYHU
VRSHUDWLQJV\VWHPKDVWRVXSSRUWDQ66+
FRQQHFWLRQ0RVW/LQX[GLVWULEXWLRQVLQFOXGHRXWRIWKHER[VXSSRUWIRUWKLV0DF26;
/HRSDUGDOVRVXSSRUWVHQFU\SWHG66+FRQQHFWLRQVZLWKRXWWKLUGSDUW\SURGXFWV
:KLOHLQ0DF26;DQG/LQX[WKHsshFOLHQWLVSURYLGHGRXWRIWKHER[:LQGRZVXVHUVZLOO
QHHGWKHIUHH3X77<66+FOLHQWIURPWKH:HERUWKH&\JZLQEXQGOHGsshFOLHQW
<RXZLOOQHHGWKHQHFHVVDU\SULYLOHJHVWRFUHDWHDQHZRSHUDWLQJV\VWHPXVHURQWKH66+
VHUYHUPDFKLQH7KLVQHHGQRWQHFHVVDULO\EHWKHVDPHPDFKLQHDVWKHGDWDEDVHVHUYHU
0RUHRYHU\RXZLOOQHHGDYDOLGXVHUDFFRXQWRQWKH0\64/VHUYHU
,QWKHQH[WH[DPSOHZHZLOOXVHDQ8EXQWX/LQX[PDFKLQHZKLFKLVERWKWKH66+DQGWKH
GDWDEDVHVHUYHU:HDVVXPHURRWDFFHVVRQWKDWPDFKLQH7RFRQQHFWWRWKHVHUYHUZHZLOO
XVH3X77<RQ:LQGRZV

7RROV

6HWWLQJXSWKLVVFHQDULRXVLQJD:LQGRZV66+VHUYHUGHSHQGVRQWKH66+VHUYHU\RXFKRRVH
WRLQVWDOO:KLOHLWZRXOGEHWHFKQLFDOO\SRVVLEOHWRDFKLHYHWKLVZLWKWKH&\JZLQ66+VHUYHU
LWZRXOGEHUDWKHUFXPEHUVRPHWRGRVRGXHWRWKHZD\&\JZLQLQWHJUDWHVZLWKWKH:LQGRZV
XVHUDFFRXQWV\VWHP%HFDXVHRIWKLVZHZLOOFRQFHQWUDWHRQ8QL[OLNHVHUYHUVLQWKLVUHFLSH
DQGRQO\XVH:LQGRZVDVDFOLHQW
+RZWRGRLW

2SHQDFRPPDQGVKHOO&UHDWHDQHZXVHUJURXSRQWKH/LQX[PDFKLQHXVLQJWKH
IROORZLQJFRPPDQG
sudo addgroup mysqlshellusers

&UHDWHDQHZGLUHFWRU\DQGVHWWKHSHUPLVVLRQVXVLQJWKHVHFRPPDQGV
sudo mkdir /usr/local/bin/mysqlshells 
sudo chmod u=rwx,g=rx,o= /usr/local/bin/mysqlshells 
sudo 
chgrp mysqlshellusers /usr/local/bin/mysqlshells

&UHDWHDQHZÀOHRQWKH66+VHUYHUZLWKWKHIROORZLQJFRQWHQW6DYHLWDV/usr/
local/bin/mysqlshells/mysqladmin.sh:
#!/bin/bash 
echo -----------------------------
echo Connecting to MySQL... 
echo -----------------------------
       /usr/bin/mysql -uroot -p
 6HWWKHSHUPLVVLRQVRQWKHQHZÀOHDVIROORZV
sudo chmod u=rx,g=rx,o= /usr/local/bin/mysqlshells/mysqladmin.sh
sudo chgrp mysqlshellusers /usr/local/bin/mysqlshells/mysqladmin.
sh
 &UHDWHDQHZXVHUDFFRXQWXVLQJWKLVFRPPDQG
sudo useradd -d /tmp -g mysqlshellusers -s /usr/local/bin/
mysqlshells/mysqladmin.sh mysqladmin
 6HWDSDVVZRUGIRUWKHQHZXVHUXVLQJWKLVFRPPDQG
sudo passwd myadmin

2QWKHFOLHQWPDFKLQHODXQFK3X77<&RQQHFWWRWKH66+VHUYHU8VHmysqladminDV
WKHXVHUQDPHDQGVXSSO\WKHSDVVZRUGWKDW\RXVHWLQVWHS

2QFH\RXKDYHORJJHGLQWRWKHKRVWPDFKLQHHQWHUWKH0\64/SDVVZRUGIRUWKH
GDWDEDVHURRWDFFRXQW

&KDSWHU

+RZLWZRUNV
:KHQ\RXORJLQWRDQ66+VHUYHUWKHSURJUDPWKDWLWZLOOORRNXSLVVHWDVWKHXVHU
VORJLQ
VKHOO8VXDOO\WKLVLVDFRPPDQGOLQHVKHOOOLNHbashRUzshWKDWOHWV\RXWRLQWHUDFWZLWKWKH
VHUYHU
VRSHUDWLQJV\VWHPODXQFKSURJUDPVDQGVRRQ,WQHHGQRWEHDJHQHUDOSXUSRVH
FRPPDQGOLQHLQWHUSUHWHUKRZHYHULWLVSHUIHFWO\ÀQHWRVSHFLI\DQ\H[HFXWDEOHFRPPDQGRU
VFULSW2QVRPH/LQX[V\VWHPVIRUH[DPSOH0DQGULYD\RXQHHGWRDGGWKHSDWKRIWKLVVSHFLDO
VKHOOLQ/etc/shells
:KHQZHFUHDWHGWKHQHZmysqladminXVHUDFFRXQWZHXVHGWKHuseraddFRPPDQG
V-s 
SDUDPHWHUWRWHOOLWWKDWZHZDQWHG/usr/local/bin/mysqlshells/mysqladmin.shDV
RXUORJLQVKHOOZKLFKZHKDGMXVWFUHDWHGDQGSODFHGWKHUH
8SRQORJLQWKH66+VHUYHURSHQHGDQGUDQWKLVVFULSWHIIHFWLYHO\VWDUWLQJRXUmysql
FRPPDQGOLQHFOLHQWZLWKWKH-u rootDQG-pSDUDPHWHUV7KLVLVZK\\RXZHUHDVNHGIRU
WKHVHFRQGSDVVZRUG)RUVHFXULW\UHDVRQVZHGLGQRWSXWWKHSDVVZRUGLQWRWKHVFULSWÀOH
HYHQWKRXJKWKDWZRXOGKDYHEHHQSRVVLEOHDQGRQO\UHTXLUHGXVWRHQWHURQHLQVWHDGRIWZR
SDVVZRUGVWRORJLQ,QDWLJKWO\FRQWUROOHGHQYLURQPHQWWKLVPLJKWEHDYLDEOHVROXWLRQEXWLWLV
GHÀQLWHO\QRWUHFRPPHQGHG
7KHUHVWRIWKHFRPPDQGVGLVFXVVHGHDUOLHUFUHDWHDQHZXVHUJURXSFDOOHG
mysqlshellusersDQGUHVWULFWDFFHVVWRWKH/usr/local/bin/mysqlshellsGLUHFWRU\WR
WKHPHPEHUVRIWKLVJURXSWRSUHYHQWXQDXWKRUL]HGXVHUVIURPHYHQYLHZLQJWKHVFULSWV

7RROV

7KHUH
VPRUH
2IFRXUVH\RXDUHQRWOLPLWHGWRDVLQJOHXVHUDFFRXQWRUMXVWRQHVFULSW<RXFDQFUHDWH
DVPDQ\VSHFLDOL]HGVFULSWVDV\RXOLNHDQGDVVLJQWKHPWRGLIIHUHQWXVHUDFFRXQWV,QWKH
SUHYLRXVH[DPSOHWKHVFULSWORJJHGRQWRWKH0\64/VHUYHUDVURRWZKLFKLVQHFHVVDU\
IRUVRPHDGPLQLVWUDWLYHWDVNV<RXVKRXOGKRZHYHUJHQHUDOO\XVHDQDFFRXQWZLWKPRUH
UHVWULFWHGSULYLOHJHV
7RSUHYHQW\RXIURPKDYLQJWRHQWHUWZRSDVVZRUGVHDFKWLPH\RXORJLQ\RXPLJKWZDQWWR
ORRNLQWR66+SXEOLFSULYDWHNH\SDLUVWKDWFDQEHXVHGWRORJLQWR66+LQVWHDGRIDSDVVZRUG
ZLWKRXWFRPSURPLVLQJVHFXULW\
8VLQJD3X77<WHPSODWHFRQQHFWLRQIRU66+
VHFXUHGFRQQHFWLRQV
,QWKHSUHYLRXVUHFLSHZHXVHG66+WRWXQQHO0\64/FRQQHFWLRQVWKURXJKLQVHFXUHQHWZRUNV
OLNHWKH,QWHUQHWDQGSUHYHQWHGWKHGDWDDQGORJLQLQIRUPDWLRQIURPWUDYHOLQJLQFOHDUWH[W
:KLOHIRUDVLQJOHVHUYHUVXFKFRQQHFWLRQVFDQTXLWHHDVLO\EHVHWXSPDQXDOO\LWTXLFNO\JHWV
WHGLRXVDQGLQÁH[LEOHRQFH\RXKDYHPRUHWKDQMXVWDIHZVHUYHUVWRUHJXODUO\FRQQHFWWR,Q
0DF26;DQG/LQX[LWLVYHU\HDV\WRFUHDWHDOLWWOHVKHOOVFULSWWKDWXVHVYDULDEOHVIRUDOORI
WKHUHOHYDQWRSWLRQV\RXQHHGWRSDVVWRWKHsshFOLHQWWRRO
3X77<XVHUVLQ:LQGRZVPLJKWÀQGWKHPVHOYHVLQDVLWXDWLRQZKHUHWKH\ZRXOGOLNHWRGRWKH
VDPHEXWXQIRUWXQDWHO\3X77<GRHVQRWSURYLGHFRPPDQGOLQHRSWLRQVIRUHYHU\WKLQJWKDW
FDQEHFRQÀJXUHGWKURXJKWKH*8,)RUH[DPSOH\RXPLJKWZDQWWRVSHFLI\\RXUIDYRULWH
WHUPLQDOIRQWRUKDYHSURGXFWLRQV\VWHPVXVHDGLIIHUHQWWHUPLQDOEDFNJURXQGFRORUWKDQ
LQWHUQDOWHVWPDFKLQHV
<RXPLJKWEHWHPSWHGWRFUHDWHLQGLYLGXDOFRQQHFWLRQSURÀOHVLQ3X77<LI\RXSUHIHU:LQGRZV
IRUHYHU\0\64/VHUYHU\RXKDYHWRPDQDJHRUPXOWLSO\WKHFRUUHVSRQGLQJUHJLVWU\HQWULHV
ZKHUH3X77<VWRUHVLWVFRQQHFWLRQSURÀOHV
%RWKWKHVHDSSURDFKHVZRUNÀQHXSWRWKHSRLQWZKHUH\RXQHHGWRFKDQJHDVHWWLQJWKDWLV
FRPPRQWRDOORI\RXUSURÀOHV,QWKDWFDVH\RXZRXOGQHHGWRORDGPRGLI\DQGVDYHHDFK
DQGHYHU\FRQQHFWLRQWKHFKDQJHLVDSSOLHGWR
7KLVUHFLSHZLOOVKRZ\RXKRZWRHVWDEOLVKHQFU\SWHGFRQQHFWLRQVWR0\64/VHUYHUVWKURXJK
66+WXQQHOVWKDWDUHVHWXSXVLQJDFRQQHFWLRQWHPSODWH$VDQH[DPSOHWKLVWHPSODWHZLOO
LQFOXGHDUHGVLJQDOFRORUEDFNJURXQGIRUWKHWHUPLQDOZLQGRZWRHDVLO\YLVXDOO\GLVWLQJXLVK
SURGXFWLRQV\VWHPVIURPWHVWPDFKLQHV

&KDSWHU

,PSRUWDQW7KHSURFHGXUHSUHVHQWHGLQWKLVUHFLSHPD\SRVHDVHFXULW\ULVN
3OHDVHPDNHVXUH\RXXQGHUVWDQGWKHLPSOLFDWLRQVE\UHDGLQJWKHLQIRUPDWLRQ
ER[LQWKH&UHDWLQJDQHQFU\SWHG0\64/FRQVROHYLD66+UHFLSH
*HWWLQJUHDG\
)RUWKLVUHFLSHWRZRUNWKH0\64/VHUYHU
VRSHUDWLQJV\VWHPKDVWRVXSSRUWDQ66+
FRQQHFWLRQ0RVW/LQX[GLVWULEXWLRQVLQFOXGHRXWRIWKHER[VXSSRUWIRUWKLV0DF26;/HRSDUG
DOVRVXSSRUWVHQFU\SWHG66+FRQQHFWLRQVZLWKRXWWKLUGSDUW\SURGXFWV
:LQGRZVXVHUVQHHGWRLQVWDOOWKH66+VHUYHUWKHPVHOYHV7KHUHDUHVHYHUDOFRPPHUFLDO
RIIHULQJVEXWIRUWKHSXUSRVHRIWKLVUHFLSHWKH66+VHUYHUDYDLODEOHZLWKWKH&\JZLQSDFNDJH
LVFRPSOHWHO\VXIÀFLHQW
:KLOHLQ0DF26;DQG/LQX[WKHsshFOLHQWLVSURYLGHGRXWRIWKHER[:LQGRZVXVHUVZLOO
QHHGWKHIUHH3X77<66+FOLHQWIURPWKH:HE
+RZWRGRLW

2SHQ1RWHSDGDQGVDYHWKHIROORZLQJFRGHDVMySQLTunnel_PROD.cmd
@echo off 
echo Production System Hostname: 
set /p hst= 
echo Connecting to %hst% 
putty.exe -L 3316:127.0.0.1:3306 -ssh -load "TMPL_PROD" %hst%

/DXQFK3X77<

&KRRVHWKH:LQGRZ$SSHDUDQFHSDQHOIURPWKHOHIWKDQGWUHH

6HOHFW'HIDXOW%DFNJURXQGIURPWKHOLVWDQGVHWWKH5*%YDOXHWR120,0,0

&KRRVHWKH&RQQHFWLRQ'DWDSDQHOIURPWKHOHIWKDQGWUHH

(QWHUWKHUHPRWHRSHUDWLQJV\VWHPXVHUQDPHLQWKH$XWRORJLQXVHUQDPHÀHOG,QWKH
H[DPSOHWKLVLVds

6DYHWKHFRQQHFWLRQIURPWKH6HVVLRQSDQHOXQGHUWKHQDPHTMPL_PROD.

&ORVH3X77<

7RROV


'RXEOHFOLFNRQWKHMySQLTunnel_PROD.cmdÀOH<RXZLOOEHSURPSWHGZLWKD
ZLQGRZZKHUH\RXFDQHQWHUWKH66+VHUYHU
VKRVWQDPH,QWKLVH[DPSOHZH
YH
HQWHUHGyavin-mac
 3X77<ZLOOEHDXWRPDWLFDOO\ODXQFKHGDQGZLOOFRQQHFWWRWKHKRVW\RXHQWHUHG
DSSO\LQJERWKVHWWLQJVIURPWKHEDWFKÀOHWKHWXQQHOVHWXSDVZHOODVIURPWKH
TMPL_PRODVHVVLRQEDFNJURXQGFRORUXVHUQDPH
 /DXQFK\RXU0\64/FOLHQWSURJUDPIRUH[DPSOH0\64/$GPLQLVWUDWRUDQGSRLQWLWWR
localhostSRUW3316WRFRQQHFWWKURXJKWKHWXQQHO
+RZLWZRUNV
,QVWHDGRIFUHDWLQJDVLQJOHFRQQHFWLRQIRUHYHU\VHUYHU\RXQHHGWRFRQQHFWWRZHFUHDWHG
DWHPSODWHWKDWFRQWDLQVDOOVHWWLQJVFRPPRQWRDJURXSRIFRQQHFWLRQVIRUH[DPSOHRQH
IRUSURGXFWLRQV\VWHPVDQGDGLIIHUHQWRQHIRULQWHUQDOWHVWPDFKLQHV
8VLQJRQO\RQHVHWRISODFHKROGHUVHWWLQJVDOORZVIRUHDV\FKDQJHVODWHURQ,I\RXFRSLHGWKH
LQLWLDOVHWWLQJVIRUHYHU\QHZKRVW\RXZRXOGKDYHWRHGLWHDFKFRS\VHSDUDWHO\
$EDWFKÀOHSURPSWVWRHQWHUWKHKRVWQDPHWRFRQQHFWWRDQGVWRUHVLWLQDYDULDEOHFDOOHG
hst7KHEDWFKWKHQODXQFKHVWKH3X77<H[HFXWDEOHSDVVLQJERWKWKHQDPHRIWKHSUHSDUHG
WHPSODWHVHVVLRQDQGVRPHDGGLWLRQDOFRPPDQGOLQHSDUDPHWHUVWKHWXQQHOVHWXSDQG
WKHFRQWHQWRIWKHhstYDULDEOHHIIHFWLYHO\PHUJLQJERWKWHPSODWHDQGPDQXDOO\
VSHFLÀHGVHWWLQJV
,I\RXQRZQHHGWRFKDQJHDFRQÀJXUDWLRQVHWWLQJIRUH[DPSOH\RX
GOLNHWRHQDEOHVHVVLRQ
ORJJLQJWRDWH[WÀOH\RXMXVWQHHGWRHGLWWKHFRUUHVSRQGLQJWHPSODWHVHVVLRQLQ3X77<RQFH
DQGKDYHWKHQHZVHWWLQJVDSSOLHGWRHYHU\VXEVHTXHQWFRQQHFWLRQWKDWLVHVWDEOLVKHGYLDWKH
EDWFKÀOH

&KDSWHU

7KHUH
VPRUH
,QWKHH[DPSOHRQO\DOLPLWHGQXPEHURIVHWWLQJVDUHVWRUHGLQWKHWHPSODWHVHVVLRQ<RXFDQ
FXVWRPL]HWKLVIXUWKHUIRUH[DPSOHE\XVLQJDNH\SDLUIRUDXWKHQWLFDWLRQZLWKRXWWKHQHHGWR
HQWHUDSDVVZRUGXSRQHDFKFRQQHFWLRQ
<RXFDQDOVRLQWURGXFHPRUHYDULDEOHVLQWKHEDWFKÀOHDQGKDQGWKHPWRRQHRUPRUHRI
3X77<
VRWKHUFRPPDQGOLQHRSWLRQV5HIHUWRWKHRQOLQHGRFXPHQWDWLRQWRÀQGRXWZKLFK
RSWLRQVFDQEHVHWGLUHFWO\IURPWKHFRPPDQGOLQH
,I\RXUVHUYHUVDUHVHWXSXVLQJDQDPLQJVFKHPH\RXPLJKWUHGXFHWKHDPRXQWRIW\SLQJ
HYHQIXUWKHU-XVWKDYHWKHXVHUHQWHURQO\WKHYDULDEOHSRUWLRQRIWKHKRVWQDPHDQGEXLOGWKH
FRPSOHWHKRVWQDPHLQWKHEDWFKÀOHOLNHVR
@echo off 
echo Subsidiary no: 
set /p subsno= 
set hst=SUBS_%subsno%.example.com
echo Connecting to %hst%
putty.exe -ssh -load "TMPL_PROD" %hst%
+HUHWKHKRVWQDPHLVEXLOWIURPDSUHÀ[SUBS_ZKLFKLVWKHQDSSHQGHGE\DÀFWLRQDO
VXEVLGLDU\QXPEHUDQGFRPSOHWHZLWKDGRPDLQVXIÀ[.example.com$GDSWWKLVWR\RXU
HQYLURQPHQWDSSURSULDWHO\
%\HLWKHUGXSOLFDWLQJWKHEDWFKÀOHRUDGGLQJVRPHVRUWRIPHQXWRLW\RXFDQDOVRXVH
GLIIHUHQWWHPSODWHVHVVLRQVGHSHQGLQJRQZKLFKVHWRISUHIHUHQFHV\RXZRXOGOLNHIRUDQ\
JLYHQFRQQHFWLRQ



%DFNLQJ8SDQG
5HVWRULQJ0\64/'DWD
7KLVFKDSWHUZLOOFRYHUWKHEDVLFWDVNVQHFHVVDU\WREDFNXS\RXU0\64/GDWDHIÀFLHQWO\DQG
WKHVWHSVWRUHVWRUHWKLVGDWDLIQHFHVVDU\:HZLOOGLVFXVVWKHIROORZLQJUHFLSHV
f
8VLQJ0\64/$GPLQLVWUDWRU*8,7RRODVDIURQWHQGIRUEDFNXSV
f
&RS\LQJDOOGDWDÀOHVWRDEDFNXSORFDWLRQ
f
&UHDWLQJD64/GXPSRIDOOGDWDEDVHV
f
&UHDWLQJD64/GXPSRIVSHFLÀFGDWDEDVHV
f
&UHDWLQJD64/GXPSRIVSHFLÀFWDEOHV
f
&RPSUHVVLQJ64/GXPSVRQWKHÁ\
f
5RWDWLQJDQGSXUJLQJELQDU\ORJV
f
8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSVZLWKRXWKXUWLQJDSURGXFWLRQ
V\VWHP
VSHUIRUPDQFH
f
5HVWRULQJGDWDIURPDGXPSWRDSUHYLRXVO\EDFNHGXSVWDWH
f
3HUIRUPLQJDSRLQWLQWLPHUHFRYHU\XVLQJWKHELQDU\ORJV

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

,QWURGXFWLRQ
$OWKRXJK0\64/KDVDUHSXWDWLRQIRUUREXVWQHVVDQGGDWDORVVLVDSUREOHP\RXZLOOQRWOLNHO\
HQFRXQWHULWLVEHVWWREHSUHSDUHGIRUZKHQ\RXUGDWDJHWVFRUUXSWHGRUORVW([SHULHQFH
VKRZVWKDWLWZLOOHYHQWXDOO\KDSSHQDQGSUREDEO\ZKHQ\RXOHDVWH[SHFWLW
7KHÀUVWWKLQJ\RXVKRXOGPDNHVXUHRILVWKDW\RXKDYHDEDFNXSDWKDQG,QWKLVFKDSWHUZH
ZLOOVKRZ\RXGLIIHUHQWZD\VRIVDYLQJ\RXUGDWDHOVHZKHUH%XWKDYLQJDEDFNXSDORQHLVQRW
HQRXJKDVHYHQWKHPRVWFRPSOHWHEDFNXSLVEDVLFDOO\XVHOHVVLI\RXDUHQRWDEOHWRUHVWRUH
\RXUGDWDIURPLW7KLVFKDSWHUDOVRFRYHUVGLIIHUHQWZD\VRIUHVWRULQJWKHGDWDLQWKHGDWDEDVH
XVLQJDQH[LVWLQJEDFNXS
<RXVKRXOGKRZHYHUEHDZDUHWKDWDEDFNXSVWUDWHJ\GRHVQRWRQO\FRQVLVWRIWKHWHFKQLFDO
GHWDLOVRQKRZWREDFNXSDQGKRZWRUHVWRUH\RXUGDWD<RXVKRXOGDOVRFRQVLGHUEDFNXS
DVSHFWVOLNHEDFNXSIUHTXHQF\KRZPDQ\JHQHUDWLRQVKDYHWREHNHSWDYDLODEOHVXLWDEOH
EDFNXSPHGLDDQGFRQVWUXFWLRQDOFRQGLWLRQV,VRQHEDFNXSSHUZHHNVXIÀFLHQW"2ULVRQFH
DGD\DEHWWHUFKRLFH":LOO\RXQHHGDWDSHGULYHRUZLOOD86%KDUGGLVNGR",VLWUHTXLUHGWR
VWRUHEDFNXSPHGLDLQDVHSDUDWHÀUHFRPSDUWPHQW"$OOWKHVHTXHVWLRQVZLOOEHDQVZHUHG
GLIIHUHQWO\GHSHQGLQJRQ\RXUDSSOLFDWLRQ
VFULWLFDOLW\VRWKHUHDUHQREHVWSUDFWLFHSURSRVDOV
7KHRQO\WKLQJWKDWZHVWURQJO\HQFRXUDJH\RXWRGRLQDOOFDVHVLVWRUHSHDWHGO\DQG
FRQWLQXRXVO\WHVW\RXUUHVWRUHSURFHVV$UHVWRUHSURFHVVWKDWZDVWHVWHGVRPH\HDUVDJR
PLJKWQRWZRUNWRGD\IRUGLIIHUHQWUHDVRQV2QHFRPPRQSUREOHPZLWKUHVWRUHSURFHVVHVLV
WKDWWKHGRFXPHQWDWLRQLVRXWGDWHGRUQRWDYDLODEOHWRWKHSHRSOHWKDWDUHUHVSRQVLEOHIRU
UHVWRULQJWKHGDWDEDVHQRWDYDLODEOHDOVRLQFOXGHVWKH\GRQRWNQRZZKHUHWRÀQGLW
$QRWKHUVWDQGDUGLVVXHLVWKDWWKHUHDUHQRSUHFLVHUHVSRQVLELOLW\GHÀQLWLRQV³WKHSHRSOH
\RXWKLQNDUHUHVSRQVLEOHIRUUHVWRULQJWKHGDWDEDVHPD\QHLWKHUNQRZRIWKHUHVSRQVLELOLW\
QRUKRZWRGRLW$QGWKHIDFWWKDWWKHUHVWRUHSURFHVVZRUNHGSHUIHFWO\ZLWKLQWKHJLYHQ
SDUDPHWHUVODVW\HDULVQRJXDUDQWHHWKDWWKLVLVWKHFDVHWRGD\DVZHOOGDWDJURZWKRIWHQ
EHLQJWKHUHDVRQIRUVXFKDGLIIHUHQFH5HVWRULQJDQDOPRVWHPSW\GDWDEDVHWRRNDPDWWHU
RIPLQXWHVEDFNWKHQEXWUHVWRULQJWKHFXUUHQWPXOWLWHUDE\WHGDWDEDVHWDNHVPRUHWKDQ
KRXUVZKLFKLVQRWDFFHSWDEOHLIWKHEDFNXSUHVWRUHFRQFHSWVWDWHVDPD[LPXPUHFRYHU\WLPH
RIVL[KRXUV
6RDVZLWKDÀUHDODUP\RXVKRXOGWU\DQGWHVWLWRQDUHJXODUEDVLVWRPDNHVXUHWKHZKROH
SURFHVVVWLOOZRUNVDVH[SHFWHGDQGKRSHWKDW\RXZLOOQHYHUQHHGLW
:KLOHGHÀQLWLRQRIDIXOOEDFNXSUHFRYHU\VWUDWHJ\LVEH\RQGWKHVFRSHRIWKLVFKDSWHUZHZLOO
SURYLGH\RXZLWKWKHEDVLFWHFKQLFDOPHDQVRIVDYLQJDQGUHVWRULQJ\RXUGDWDEDVH

&KDSWHU

8VLQJ0\64/$GPLQLVWUDWRU*8,7RRO
DVDIURQWHQGIRUEDFNXSV
*HWWLQJUHDG\
7RIROORZWKHVWHSVLQWKLVUHFLSH\RXZLOOQHHGDQDFFRXQWWKDWKDVVXIÀFLHQWSHUPLVVLRQVWR
SHUIRUPDEDFNXS\RXZLOOQHHGSELECTDQGLOCKTABLESSULYLOHJHV:HZLOODVVXPHDXVHU
QDPHGbackup_usrUHIHUWR&KDSWHU'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
<RXVKRXOGDOVRPDNHVXUHWKDWWKHUHLVQRZULWHDFFHVVWR\RXUGDWDEDVH7KLVLVWRSUHYHQW
ORFNLQJLVVXHV)RUIXUWKHUH[SODQDWLRQSOHDVHUHIHUWRWKH7KHUH
VPRUHVHFWLRQ
$QGÀQDOO\\RXZLOOQHHGVXIÀFLHQWVSDFHRQRQHRI\RXUGULYHVWRVWRUHWKHEDFNXSÀOH
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKH
backup_usrDFFRXQW

6HOHFWWKHHQWU\%DFNXSHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH9LHZPHQX

&OLFNRQWKH1HZ3URMHFWEXWWRQ

(QWHUWKHSURMHFWQDPH0\64/%DFNXSLQWKH3URMHFW1DPHÀHOG

6XFFHVVLYHO\VHOHFWHDFKVFKHPDIURPWKH6FKHPDWDOLVWDQGFOLFNRQWKH!EXWWRQ
([FOXGHWKHLQIRUPDWLRQBVFKHPD\RXZLOOEHZDUQHGLI\RXDFFLGHQWDOO\WU\WRDGG
WKLVWRWKHOLVW
 6HOHFWWKH$GYDQFHG2SWLRQVWDE

&KRRVH2QOLQHZLWKELQORJSRVDVWKHEDFNXSH[HFXWLRQPHWKRG

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

 (QDEOHWKH&RPSOHWHEDFNXSRSWLRQDQGFOLFNRQWKH6DYH3URMHFWEXWWRQ

&OLFNRQWKH([HFXWH%DFNXS1RZEXWWRQDQGVHOHFWDORFDWLRQIRUWKHEDFNXSÀOH
LQWKHQH[WGLDORJXH
 7KHEDFNXSZLOOEHJLQDQGDSURJUHVVLQGLFDWRUZLOOEHGLVSOD\HGDVVHHQLQWKH
QH[WVFUHHQVKRW
+RZLWZRUNV
7KLVUHFLSHLVDSUHWW\VWUDLJKWIRUZDUGZD\RIFUHDWLQJDEDFNXS:LWKVWHSVDQGZHRSHQ
WKHEDFNXSLQWHUIDFHRI0\64/$GPLQLVWUDWRU6WHSVDQGDUHXVHGWRFUHDWHDQHZEDFNXS
SURMHFWQDPHG0\64/%DFNXSWKLVQDPHFDQEHFKDQJHGIUHHO\WR\RXUOLNLQJ

&KDSWHU

,QVWHS\RXVHOHFWDOOGDWDEDVHVWKDWZLOOEHLQFOXGHGLQ\RXUEDFNXS,I\RXZLVKQRWWREDFN
XSDOOGDWDEDVHVEXWRQO\DVHOHFWHGVFKHPD\RXFDQDOVRUHVWULFW\RXUVHOHFWLRQWRFHUWDLQ
GDWDEDVHV%XWSOHDVHEHDZDUHWKDWLQFDVHRIFURVVGDWDEDVHGHSHQGHQFLHV\RXKDYHWR
VHOHFWDOOUHOHYDQWGDWDEDVHVDVZHOORWKHUZLVHWKLVPLJKWOHDGWRSUREOHPVODWHUZKHQWU\LQJ
WRUHVWRUHWKHGDWD$OVRQRWHWKDWDOO0\64/DFFRXQWVDQGWKHLUUHVSHFWLYHSULYLOHJHVDUH
VWRUHGLQWKHP\VTOVFKHPD,I\RXFKRRVHQRWWRLQFOXGHWKLVLQ\RXUEDFNXS\RXZLOOKDYHWR
UHVWRUHWKHDFFRXQWVDQGSULYLOHJHVE\RWKHUPHDQV
6WHSVWKURXJKGHÀQHWKHH[DFWPHWKRGIRUEDFNLQJXS\RXUGDWD:LWKVWHS\RXFKDQJH
WKHGHIDXOWPHWKRGIURP,QQR'%2QOLQH%DFNXSWR2QOLQHZLWKELQORJSRV:HDGYLVHWR
XVHWKLVPHWKRGEHFDXVHLWVSHUIRUPDQFHLVLGHQWLFDOWRWKHGHIDXOWPHWKRGEXWLQFOXGHVDQ
DGGLWLRQDOLQIRUPDWLRQDERXWWKHFXUUHQWELQORJSRVLWLRQWKDWLVH[WUHPHO\XVHIXOLQFDVHRID
UHVWRUH7KH&RPSOHWHEDFNXSRSWLRQVHOHFWHGLQVWHSPDNHVVXUH\RXFDQXVHWKHVDPH
EDFNXSSURMHFWODWHUZLWKRXWDQ\FKDQJHVHYHQLIQHZWDEOHVZHUHDGGHGVLQFHWKHSURMHFW
V
FUHDWLRQ,I\RXGRQRWSODQRQXVLQJWKHEDFNXSSURMHFWDJDLQ\RXFDQVLPSO\VNLSVWHS
6WHSLVDJDLQSUHWW\VWUDLJKWIRUZDUGDIWHUVHOHFWLQJWKHWDUJHWIRUWKHEDFNXSÀOHWKHEDFNXS
LVVWDUWHG
7KHUH
VPRUH«
,QDGGLWLRQWRWKHVWHSVGHVFULEHGLQWKLVUHFLSH0\64/$GPLQLVWUDWRUIHDWXUHVVHYHUDORSWLRQV
UHJDUGLQJWKHEDFNXS7KHIROORZLQJVHFWLRQVZLOOGLVFXVVVRPHRIWKHVHRSWLRQVDVZHOODVWKH
OLPLWDWLRQVRIWKLVEDFNXSDSSURDFK
6FKHGXOLQJEDFNXSV
$VEDFNXSVDUHVRPHWKLQJ\RXW\SLFDOO\QHHGRQDUHJXODUEDVLV0\64/$GPLQLVWUDWRUDOVR
SURYLGHV\RXZLWKDVFKHGXOLQJRSWLRQ8QGHUWKH6FKHGXOHWDE\RXFDQHQDEOHVFKHGXOHG
EDFNXSV$IWHUHQWHULQJWKHWDUJHWGLUHFWRU\DQGWKHEDVHQDPHRIWKHEDFNXSÀOHV\RXFDQ
FKRRVHEHWZHHQGDLO\ZHHNO\DQGPRQWKO\EDFNXS6DYLQJ\RXUSURMHFWXVLQJWKH
6DYH3URMHFWEXWWRQZLOOLQVWDOODVFKHGXOLQJHQWU\WDVNLQ\RXURSHUDWLQJV\VWHPHLWKHUD
cronMRERQ8QL[EDVHGV\VWHPVRUD6FKHGXOHG7DVNRQ:LQGRZV³\RXZLOOQHHGWRSURYLGH
WKHUHVSHFWLYHRSHUDWLQJV\VWHPFUHGHQWLDOVIRUWKLV
8QGHUVWDQGLQJDQGKDQGOLQJOLPLWDWLRQVRIXVLQJ0\64/
$GPLQLVWUDWRUIRUEDFNXSV
7KHDSSURDFKRIXVLQJ0\64/$GPLQLVWUDWRUDVDJUDSKLFDOWRROPDNHVLWYHU\HDV\WRSHUIRUP
EDFNXSVHLWKHUPDQXDOO\RUVFKHGXOHG)RUPDQ\SXUSRVHVWKLVLVFRPSOHWHO\VXIÀFLHQW%XW
IRUODUJHULQVWDOODWLRQV\RXZLOOSUREDEO\QHHGVRPHPRUHÁH[LELOLW\IRUH[DPSOHZLWKUHVSHFW
WRWKHVFKHGXOLQJRSWLRQVRUWKHWDUJHWHG0\64/LQVWDQFHV,I\RXKDYHPXOWLSOH0\64/VHUYHU
SURFHVVHVUXQQLQJRQRQHVHUYHU0\64/$GPLQLVWUDWRUSURYLGHVQRRXWRIWKHER[VROXWLRQV
WRFUHDWHEDFNXSVIRUDOORIWKHPDVLWPDLQO\WDUJHWVVLQJOHLQVWDQFHLQVWDOODWLRQV$OVRDQ
RSWLRQWRSHUIRUPEDFNXSVDWVXEGDLO\LQWHUYDOVIRUH[DPSOHHYHU\KRXUVLVQRWFRYHUHGE\
0\64/$GPLQLVWUDWRU

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

'XHWRWKHVHOLPLWDWLRQVZHUHFRPPHQGWRZULWHDQGVFKHGXOH\RXURZQVFULSWVIRU
LQVWDOODWLRQVWKDWGHDOZLWKPLVVLRQFULWLFDOGDWDDQGWRVLPXOWDQHRXVO\HVWDEOLVKDPRQLWRU
IRUWKHVHVFULSWVVRWKHUHVSRQVLEOHDGPLQLVWUDWRUVDUHLQIRUPHGLIWKHEDFNXSLVQRW
FUHDWHGSURSHUO\
5HJDUGOHVVRIZKHWKHU0\64/$GPLQLVWUDWRULVXVHGRUQRWXVHRIDGHVNWRSFRPSXWHUWR
EDFNXS\RXUGDWDLVJHQHUDOO\QRWUHFRPPHQGHG'HVNWRSPDFKLQHVDUHW\SLFDOO\QRWVHW
XSWRUXQFRQWLQXRXVO\VR\RXFDQ
WUHO\RQXQLQWHUUXSWHGEDFNXSV6HSDUDWHPDFKLQHVDUH
DOVRPRUHSURQHWRVHFXULW\LVVXHVDVWKH\DUHRIWHQHDVLO\SK\VLFDOO\DFFHVVLEOHE\GLIIHUHQW
SHRSOHZKLFKPDNHVGDWDWKHIWHDVLHU,QPDQ\LQVWDOODWLRQVGHVNWRSFRPSXWHUVDQG
GDWDEDVHVHUYHUVDUHDOVRORFDWHGRQGLIIHUHQWQHWZRUNV7KLVSRVVLEO\IDFLOLWDWHVDWWDFNVRQ
WKHQHWZRUNLQJOD\HUDQGPLJKWHYHQEHDOHJDOSUREOHPZKHQGHDOLQJZLWKSHUVRQDOGDWD
([SORULQJDGGLWLRQDOEDFNXSRSWLRQV
:HZLOOGLVFXVVDIHZDGGLWLRQDORSWLRQVLQWKH$GYDQFHG2SWLRQVWDERI0\64/$GPLQLVWUDWRU
WKDWPLJKWEHXVHIXOIRUVRPHVLWXDWLRQV
)LUVWRIDOOWKH$GG'5236WDWHPHQWVRSWLRQLVHQDEOHGE\GHIDXOW7KLVFDXVHV0\64/
$GPLQLVWUDWRUWRLQFOXGHDROP TABLE IF EXISTSVWDWHPHQWVLQWKHGXPS7KLVW\SLFDOO\
PDNHVVHQVHEHFDXVHLWKHOSVUHPRYLQJDOOH[LVWLQJGDWDIURPDWDEOHEHIRUHUHVWRULQJLW6R
DIWHUUHVWRULQJWKHGDWDWKHWDEOHFRQWDLQVH[DFWO\WKHVDPHGDWDDVLWGLGDWWKHWLPHWKH
GXPSZDVFUHDWHG,WDOVRPDNHVVXUHWKDWWKHUHVWRUHSURFHVVZLOOQRWUXQLQWRSUREOHPVLIWKH
WDEOH
VVWUXFWXUHKDVFKDQJHGEHWZHHQGXPSFUHDWLRQDQGUHVWRUDWLRQ6R\RXZLOOPRVWO\ZDQW
WROHDYHWKLVRSWLRQHQDEOHG%XWLI\RXSODQWRXVHWKHGXPSWRLPSRUWDGGLWLRQDOGDWDLQWRDQ
H[LVWLQJGDWDEDVH\RXVKRXOGGLVDEOHWKLVRSWLRQ
7KH1R&5($7(VRSWLRQSUHYHQWV0\64/$GPLQLVWUDWRUIURPSURGXFLQJCREATE DATABASE
VWDWHPHQWVLQWKHGXPS$FFRUGLQJWRWKHGRFXPHQWDWLRQWKLVLVLQWHQGHGIRUVLWXDWLRQVLQ
ZKLFK\RXZDQWWRLPSRUWDGXPSLQWRDGLIIHUHQWGDWDEDVH8QIRUWXQDWHO\WKLVZLOOQRWZRUN
DVWKHGXPSVWLOOFRQWDLQVDUSEVWDWHPHQWWKDWZLOOWDUJHWWKHUHVWRUHWRWKHRULJLQDOGDWDEDVH
QDPHDQGFDXVHDQHUURULIWKLVGDWDEDVHGRHVQRWH[LVW+HQFHWKLVRSWLRQLVEDVLFDOO\
XVHOHVVDQGFDQEHOHIWGLVDEOHG
7KHRWKHURSWLRQVSURYLGHGLQWKH$GYDQFHG2SWLRQVWDERIWKH%DFNXSVHFWLRQRI0\64/
$GPLQLVWUDWRUDUHQRWUHOHYDQWIRUW\SLFDOXVH)RUPRUHGHWDLOVUHIHUWRWKHmysqldump
PDQXDODYDLODEOHDWhttp://dev.mysql.com/doc/refman/5.1/en/mysqldump.html͘
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS

&KDSWHU

&RS\LQJDOOGDWDÀOHVWRDEDFNXSORFDWLRQ
7KHPRVWVWUDLJKWIRUZDUGZD\WREDFNXSWKHGDWDRI\RXUGDWDEDVHLVWRVLPSO\FRS\WKHÀOHV
LQZKLFKWKHGDWDLVVWRUHGWRDQRWKHUORFDWLRQ,QPDQ\FDVHVWKLVLVRQHRIWKHPRVWHIIHFWLYH
ZD\VWRSHUIRUPDEDFNXS7KLVUHFLSHZLOOGHVFULEHWKHVWHSVUHTXLUHGWRVXFFHVVIXOO\XVH
WKLVDSSURDFK
*HWWLQJUHDG\
)RUWKHFRS\DOOEDFNXS\RXKDYHWRVKXWGRZQ\RXUGDWDEDVH)RUWKLV\RXKDYHWRPDNH
VXUHWKDWDOOFRQQHFWLRQVWR\RXUGDWDEDVHDUHFORVHG)XUWKHUPRUH\RXKDYHWRLGHQWLI\WKH
GLUHFWRULHVLQZKLFK0\64/VWRUHVLWVGDWDÀOHVWKH,QQR'%WDEOHVSDFHDQGWKHFRQÀJXUDWLRQ
ÀOH,QWKHIROORZLQJVWHSVZHZLOODVVXPHWKHIROORZLQJGLUHFWRULHVDQGÀOHVC:\Program 
Files\MySQL\MySQL Server 5.1\my.iniIRU0\64/FRQÀJXUDWLRQC:\MySQL\Data\
DVWKH0\64/GDWDGLUHFWRU\ZKHUH0\,6$0GDWDDQGWKHWUDQVDFWLRQORJVDUHVWRUHGDQG
C:\MySQL\InnoDB\IRUWKH,QQR'%WDEOHVSDFH
$QGÀQDOO\\RXQHHGVXIÀFLHQWVSDFHRQDGULYHWRFRS\WKHGDWDÀOHVWR,QWKLVH[DPSOHZH
ZLOODVVXPHDGLUHFWRU\D:\MySQLBackupDVWKHWDUJHWGLUHFWRU\IRUWKHEDFNXS
+RZWRGRLW

6KXWGRZQ\RXUGDWDEDVHLQVWDQFHIRUH[DPSOHXVLQJ0\64/$GPLQLVWUDWRU

&UHDWHWKHWDUJHWGLUHFWRULHV

&RS\WKHIXOOFRQWHQWRIWKHGDWDGLUHFWRU\C:\MySQL\Data\WRWKHGHVWLQDWLRQ
GLUHFWRU\D:\MySQLBackup\Data

&RS\WKHIXOOFRQWHQWRIWKH,QQR'%GDWDGLUHFWRU\C:\MySQL\InnoDB\WRWKH
GHVWLQDWLRQGLUHFWRU\D:\MySQLBackup\InnoDB\

&RS\WKH0\64/FRQÀJXUDWLRQÀOHC:\Program Files\MySQL\MySQL Server 
5.1\my.iniWRWKHGHVWLQDWLRQGLUHFWRU\D:\MySQLBackup\

6WDUWWKH0\64/6HUYHULQVWDQFHDJDLQ͘
+RZLWZRUNV
7KLVUHFLSHEDVLFDOO\FRQVLVWVRIFRS\LQJWKHLPSRUWDQW0\64/ÀOHVIURPRQHORFDWLRQWRWKH
RWKHU,WLVLPSRUWDQWWRXQGHUVWDQGZK\VWHSVKXWWLQJGRZQWKHGDWDEDVHLVQHFHVVDU\
ZLWKRXWWKLVVWHS\RXULVNDQLQFRQVLVWHQWRUHYHQZRUVHXQXVDEOHEDFNXS,IDQ\FKDQJHV
DUHPDGHWRWKHWDEOHVZKLOH\RXFRS\WKHP\RXZLOOKDYHDQXQGHÀQHGVWDWHLQVRPHRIWKH
ÀOHVDWWKHPRPHQWWKH\DUHUHDG\WREHFRSLHGWRWKHEDFNXSORFDWLRQ:KLOH0\64/LVDEOHWR
UHFRYHUHYHQIURPVXFKLQFRQVLVWHQWEDFNXSVPRUHRIWHQWKDQQRWLWLVEHVWQRWWRUHO\RQWKLV
EHFDXVH\RXUSULPDU\JRDOLVWRKDYHDUHOLDEOHEDFNXS

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

:KHQ0\64/LVVWRSSHGLWOHDYHVDGHÀQHGVWDWHLQDOORIWKHÀOHVZKLFKZLOOQRWFKDQJH
GXULQJWKHEDFNXSSURFHVV7KLVLVZK\DÀOHEDVHGEDFNXSZLOOEHFRQVLVWHQWDQGVXIÀFLHQW
WRUHVWRUHWKHVDYHGVWDWHLIQHFHVVDU\
<RXPD\KDYHQRWLFHGWKDWWKHELQDU\ORJVDUHQRWVDYHGLQWKLVSDUWLFXODUUHFLSH7KLVLV
EHFDXVHRIWKHIDFWWKDWWKHELQDU\ORJVDUHQRWQHFHVVDU\WRUHVWRUHD0\64/LQVWDQFHIURP
VFUDWFK,IWKH\DUHPLVVLQJZKHQWKHGDWDEDVHLVUHVWDUWHGDIWHUDUHVWRUHDQHZELQDU\ORJ
WRJHWKHUZLWKDQLQGH[ÀOHLVFUHDWHGDXWRPDWLFDOO\
,WVKRXOGEHQRWHGWKDWLI\RXFKRVHWRZULWH\RXUWUDQVDFWLRQORJVWRDGLIIHUHQWORFDWLRQ
RXWVLGHRIWKHGDWDGLUHFWRU\XVLQJWKHinnodb_log_group_home_dirRSWLRQ\RXZLOO
KDYHWRVDYHWKLVGLUHFWRU\WRWKHEDFNXSORFDWLRQDVZHOODVWKHORJSRVLWLRQPDUNHGWKHUHLQ
LVOLQNHGWRWKH,QQR'%GDWDÀOHV:KLOH,QQR'%XVXDOO\KDVQRSUREOHPVWRUHFRYHUIURPWKLV
VLWXDWLRQDIWHUDUHVWRUHLWLVDGYLVHGWRVDYHWKHWUDQVDFWLRQORJVDVZHOO
7KHFRQÀJXUDWLRQÀOHVDYHGLQVWHSLVQRWYLWDOEXWLWLVYHU\KHOSIXOZKHQWU\LQJWRUHVWRUH
GDWDIURPDEDFNXSWRKDYHWKHRULJLQDOFRQÀJXUDWLRQDWKDQG(VSHFLDOO\IRU,QQR'%
GDWDEDVHVWKHFRQÀJXUDWLRQRIWKH,QQR'%WDEOHVSDFHKDVWREHUHSURGXFHGLGHQWLFDOO\WR
SUHYHQWQRQUHFRYHUDEOHHUURUVDIWHUUHVWRUH
7KHUH
VPRUH«
,QWKHIROORZLQJVHFWLRQVZHZLOOGLVFXVVUHVWULFWLRQVRIWKHUHFLSHDQDGYDQFHGYDULDWLRQ
RIWKHEDFNXSPHWKRGXVLQJ/90VQDSVKRWVDQGDIHZKLQWVRQKRZWRUHVWRUHGDWD
IURPDEDFNXS
8QGHUVWDQGLQJWKHUHVWULFWLRQVRIWKHÀOHEDVHGEDFNXSPHWKRG
7KHEDFNXSPHWKRGGHVFULEHGLQWKHDERYHUHFLSHW\SLFDOO\GHOLYHUVYHU\JRRGSHUIRUPDQFH
DQGH[FHOOHQWGXUDWLRQSUHGLFWDELOLW\HVSHFLDOO\RQDUHVWRUH2QWKHGRZQVLGHWKHDSSURDFK
RIEDFNLQJXSELQDU\ÀOHVPDNHVLWPRUHYXOQHUDEOHWRGDWDFRUUXSWLRQSUREOHPVEHVLGH
WKHIDFWWKDWWKHGDWDEDVHVHUYHUQHHGVWREHUHVWDUWHG,IDELQDU\ÀOHJHWVFRUUXSWHGIRU
H[DPSOHDWDEOHWKDWLVQRWDFFHVVHGRQDUHJXODUEDVLV\RXZLOOQRWQHFHVVDULO\QRWLFHZLWK
WKLVNLQGRIEDFNXS%\WKHWLPHWKHÀOHJHWVXVHGDQGWKHHUURUVKRZVXSDOO\RXUEDFNXS
JHQHUDWLRQVPLJKWDOUHDG\FRQWDLQDFRUUXSWHGYHUVLRQRIWKHÀOHEDVLFDOO\OHDYLQJ\RXZLWKRXW
DXVDEOHEDFNXSIRUWKHGDWDVWRUHGZLWKLQWKHUHVSHFWLYHÀOH
7KLVLVZK\ZHUHFRPPHQGFRPSOHPHQWLQJWKHÀOHEDVHGEDFNXSZLWKDGXPSEDVHGEDFNXS
DVGHVFULEHGLQWKHIROORZLQJUHFLSH7KLVIRUFHV0\64/WRIXOO\UHDGHYHU\WDEOHVRGDWD
FRUUXSWLRQLVPRUHOLNHO\WREHGLVFRYHUHG7RPDNHXVHRIWKLVIDFWWKHEDFNXSVKRXOGEH
PRQLWRUHGDVHUURUVGXULQJEDFNXSPLJKWLQGLFDWHGDWDFRUUXSWLRQDQGVKRXOGEHUHSRUWHGIRU
IXUWKHUHYDOXDWLRQ

&KDSWHU

7KLVGXPSPLJKWEHSURGXFHGOHVVRIWHQEXWZLWKDIUHTXHQF\WKDWSHUIRUPVDGXPSEHIRUH
WKHUHWDLQHGEDFNXSJHQHUDWLRQVRIWKHÀOHEDVHGEDFNXSVJHWRYHUZULWWHQDJDLQLQWKHQH[W
F\FOH)RUH[DPSOHLI\RXSHUIRUPDGDLO\ÀOHEDVHGEDFNXSDQGNHHSVHYHQJHQHUDWLRQVRI
WKHVHZHUHFRPPHQGSHUIRUPLQJDQDGGLWLRQDOGXPSEDVHGEDFNXSRQFHDZHHN
%DFNLQJXSXVLQJ/90VQDSVKRWV
7KHPDMRUGLVDGYDQWDJHRIWKHFRS\DOODSSURDFKLVWKDWDGDWDEDVHVKXWGRZQLVUHTXLUHG,Q
PDQ\VLWXDWLRQVWKLVLVQRWDIHDVLEOHRSWLRQ7RDYRLGWKLVUHVWULFWLRQLWLVVRPHWLPHVDGYLVDEOH
WRFUHDWHDVQDSVKRWRIWKHÀOHV\VWHPW\SLFDOO\DQ/90VQDSVKRWXVLQJWKH/LQX[/RJLFDO
9ROXPH0DQDJHU:HDGYLVH\RXWRXVHWKLVDSSURDFKZLWKFDXWLRQEHFDXVHDVQDSVKRWGRHV
QRWJXDUDQWHHWKDWWKHVWDWHWKHÀOHVZHUHLQZKHQWKHVQDSVKRWZDVFUHDWHGLVDFRQVLVWHQW
VWDWHIURPZKLFK0\64/FDQUHFRYHU(YHQLIZHDVVXPHWKDWLQPRVWFDVHV0\64/FDQ
UHFRYHUIURPVXFKDEDFNXSVWDWHDEDFNXSWKDWLVRQO\OLNHO\WREHVXLWDEOHIRUDUHVWRUH
LVQRWVXIÀFLHQW³\RXKDYHWREHDEVROXWHO\SRVLWLYHDERXWWKDW
7REHVXUHDERXWWKHVWDWHRIWKHWDEOHVDWWKHWLPHWKHVQDSVKRWLVGRQH\RXKDYHWRÁXVK
DOORSHQFKDQJHVWRWKHGLVN7KLVFDQEHGRQHXVLQJDFLUSH TABLES WITH READ LOCK
FRPPDQGULJKWEHIRUHWKHVQDSVKRW1RWHKRZHYHUWKDWLQFDVHRIORQJUXQQLQJWUDQVDFWLRQV
WKLVPLJKWOHDGWRVLJQLÀFDQWGHOD\VIRU64/VWDWHPHQWVWKDWWU\WRZULWHWRWKHGDWDEDVHLQ
SDUDOOHOEDVLFDOO\FDXVLQJVLPLODUSUREOHPVDVZLWKDGDWDEDVHWKDWZDVVKXWGRZQ
$IWHUWKHEDFNXSLVFRPSOHWHG\RXKDYHWRXQORFNWKHWDEOHVDJDLQE\H[HFXWLQJDQ
UNLOCK TABLESFRPPDQG1RWHWKDWLI\RXFORVHWKHFRQQHFWLRQWKDWZDVXVHGIRUWKH
FLUSH TABLES WITH READ LOCKFRPPDQGWKHWDEOHVDUHXQORFNHGDVZHOO%\FORVLQJ
WKHFRQQHFWLRQ\RXGRQRWQHHGWKHUNLOCK TABLESVWDWHPHQWEXWWKLVDOVRPHDQVWKH
FRQQHFWLRQKDVWRVWD\RSHQGXULQJWKHZKROHEDFNXSSURFHVV
)XUWKHUPRUHVHYHUDOWHVWVSURYHGWKDWWKHZULWHSHUIRUPDQFHRI/90VQDSVKRWVLVDE\VPDO
VHHIRUH[DPSOHhttp://www.nikhef.nl/~dennisvd/lvmcrap.htmlRU
http://www.mysqlperformanceblog.com/2009/02/05/disaster-lvm-
performance-in-snapshot-mode/,IWKHUHLVUHOHYDQWWUDIÀFRQWKHGDWDEDVHZKLOH
WKH/90VQDSVKRWJHWVFRSLHGWRWKHEDFNXSGHVWLQDWLRQ\RXUGDWDEDVHZLOOSUREDEO\VXIIHU
IURPVLJQLÀFDQWSHUIRUPDQFHGHJUDGDWLRQ$SRVVLEOHUHPHG\WRWKLVPLJKWEHWRSHUIRUPWKH
EDFNXSRQDVSHFLÀFEDFNXSVODYHDVGHVFULEHGLQRQHRIWKHIROORZLQJUHFLSHV
5HVWRULQJGDWDIURPDÀOHEDVHGEDFNXS
7KHUHVWRUHSURFHVVIRUDÀOHEDVHGEDFNXSLVSUHWW\VWUDLJKWIRUZDUGVWRSWKHGDWDEDVHDQG
FRS\WKHGLUHFWRULHVEDFNWRWKHLURULJLQDOORFDWLRQ$IWHUVWDUWLQJWKHGDWDEDVHDJDLQ\RXUGDWD
LVUHVHWWRWKHVWDWHLWZDVLQZKHQWKHEDFNXSZDVSHUIRUPHG(DV\DVWKDW

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

6HHDOVR
f
8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSVZLWKRXWKXUWLQJDSURGXFWLRQV\VWHP
V
SHUIRUPDQFH
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
&UHDWLQJD64/GXPSRIDOOGDWDEDVHV
,QWKHSUHYLRXVUHFLSHWKHÀOHEDVHGEDFNXSPHWKRGZDVSUHVHQWHG$VZDVDOUHDG\
PHQWLRQHGWKHUHWKLVDSSURDFKUHTXLUHVVRPHFDYHDWV7KXVZHUHFRPPHQGWRSHUIRUP
DGGLWLRQDOGXPSEDVHGEDFNXSVZKLFKVWRUHWKHFRQWHQWRI\RXUGDWDEDVHDV64/ÀOHVWKDW
FDQHDVLO\EHUHDGDQGDUHOHVVVXEMHFWWRXQUHFRYHUDEOHGDWDFRUUXSWLRQ7KLVUHFLSHVKRZV
\RXKRZWRFUHDWHVXFKDGXPSEDVHGEDFNXS
*HWWLQJUHDG\
7RIROORZWKHVWHSVLQWKLVUHFLSH\RXZLOOQHHGDXVHUWKDWKDVVXIÀFLHQWSHUPLVVLRQVWR
SHUIRUPDEDFNXSPRVWLPSRUWDQWO\WKHSELECTDQGLOCK TABLESSULYLOHJHV:HZLOO
DVVXPHDXVHUQDPHGEDFNXSBXVUVHH'HÀQLQJDVSHFLÀFXVHUIRUEDFNXSLQ&KDSWHU͘
$VEHIRUH\RXQHHGDQDGGLWLRQDOGHVWLQDWLRQGLUHFWRU\ZLWKVXIÀFLHQWIUHHVSDFHWRKROGWKH
EDFNXS:HZLOOXVHWKHGLUHFWRU\D:\MySQLBackup\DVWKHWDUJHWGLUHFWRU\
+RZWRGRLW
([HFXWHWKHIROORZLQJFRPPDQGIURPWKHFRPPDQGOLQH
C:\>mysqldump -u backup_usr -p"B4ckM3Up!" --all-databases > "D:\
MySQLBackup\MySQLDumpAllDatabases.sql"
+RZLWZRUNV
:KLOHLWPLJKWVHHPVRPHZKDWDZNZDUGWRFDOODVLQJOHFRPPDQGDUHFLSHWKHGHWDLOV
LQYROYHGLQWKLVFRPPDQGMXVWLI\WKLVGHFLVLRQ7KHFRPPDQGOLQHVWDWHPHQWFRQVLVWV
RIWZREDVLFSDUWVWKHmysqldumpFRPPDQGLWVHOIDQGWKHRXWSXWUHGLUHFWLRQFODXVH
> D:\...\MySQLDumpAllDatabases.sqlZKLFKZULWHVWKHUHVXOWLQJGXPSÀOHWRWKH
JLYHQÀOH,I\RXWDNHDFORVHUORRNDWWKHmysqldumpFRPPDQG\RXZLOOQRWLFHWKHRSWLRQV
-uDQG-pWKDWDUHXVHGWRSDVVWKHXVHUFUHGHQWLDOVWRXVHIRUSHUIRUPLQJWKHEDFNXS7KH
QH[WRSWLRQLV--all-databasesZKLFKWHOOVmysqldumpWRZULWHWKHGDWDRIDOOGDWDEDVHV
LQFOXGLQJWKHP\VTOVFKHPDWRWKHGXPS͘

&KDSWHU

1RZZKDWKDSSHQVRQH[HFXWLRQRIWKLVFRPPDQG")LUVWRIDOOWKHGHIDXOWRSWLRQ--optLV
DSSOLHGLQDGGLWLRQWRWKHJLYHQSDUDPHWHUV,WLVDFWLYHLIQRRWKHURSWLRQLVOLVWHGH[SOLFLWO\DQGLW
HQDEOHVVHYHUDOVHQVLEOHVHWWLQJVPRVWQRWDEO\WKH--lock-tablesRSWLRQWKDWORFNVDOOWDEOHV
XVLQJWKHLOCK TABLE … READ LOCALVHPDQWLFVEHIRUHWKH\DUHGXPSHG7KLVSUHYHQWV
FRQFXUUHQWPRGLÀFDWLRQWRWKHWDEOHVZKLOHGDWDLVEHLQJGXPSHGZKLFKFRXOGUHVXOWLQDGXPS
ÀOHZLWKLQFRQVLVWHQWGDWDDFURVVWDEOHV$IWHUZDUGVRQHGDWDEDVHDIWHUWKHRWKHULVSURFHVVHG
)RUHDFKGDWDEDVHWKHVWUXFWXUHDQGGDWDRIHDFKRIWKHWDEOHVLQDOSKDEHWLFDORUGHUDUHUHDG
DQGZULWWHQWRWKHRXWSXWÀOHLQDV64/CREATE TABLEDQGINSERTVWDWHPHQWV7KHUHVXOWLQJ
ÀOHLVDYDOLG64/ÀOHWKDWFDQEHH[HFXWHGRQDQHPSW\0\64/LQVWDOODWLRQWRUHVWRUHLWVGDWD
,WVKRXOGEHQRWHGWKDWWKHSHUIRUPDQFHRIFUHDWLQJDEDFNXSXVLQJmysqldumpLVW\SLFDOO\
QRWDVJRRGDVFUHDWLQJDÀOHEDVHGEDFNXSDVGLVFXVVHGLQWKHSUHYLRXVUHFLSH+HUHLVD
FRPSDULVRQRIWKHWLPHQHHGHGIRUEDFNLQJXSWKHHPSOR\HHVH[DPSOHGDWDEDVH
FileBased
mysqldump
35
0
5
10
15
20
25
30
Seconds
7KHUH
VPRUH
7KHGHIDXOWEHKDYLRURImysqldumpLVWRORFNDOOWDEOHVRIHDFKGDWDEDVHEHIRUHWKH\DUH
GXPSHG7KLVKDVWKHJRDORISUHYHQWLQJLQFRQVLVWHQFLHVLQVLGHWKHGXPSZKHQFRQFXUUHQW
PRGLÀFDWLRQVWDNHSODFHGXULQJWKHGXPS8QIRUWXQDWHO\WKLVZRUNVRQO\ZLWKLQFHUWDLQOLPLWV
DQGPLJKWDOVRKDYHDQHJDWLYHLPSDFWRQWKHGDWDEDVHRSHUDWLRQV7KHIROORZLQJVHFWLRQV
GLVFXVVWKHVHFDYHDWV
3OHDVHQRWHWKDWDOODGGLWLRQDORSWLRQVWRmysqldumpPHQWLRQHG
QH[WKDYHWREHSODFHGEHIRUHWKH–-all-databasesFODXVH
\RXZLOOHQFRXQWHUHUURUVRWKHUZLVH

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

3UHYHQWLQJORFNLQJLVVXHVE\XVLQJ,QQR'%VWRUDJHHQJLQH
7KHORFNLQJPHFKDQLVPXVHGE\mysqldumpWULHVWRSUHYHQWFRQFXUUHQWGDWDPRGLÀFDWLRQV
GXULQJWKHGXPS7KLVREYLRXVO\FDQFDXVHVLJQLÀFDQWGHOD\VGXHWRWDEOHORFNVZKHQDQ
DSSOLFDWLRQWULHVWRFRQFXUUHQWO\ZULWHWRWKHORFNHGWDEOHV'HSHQGLQJRQWKHVL]HRIWKH
GDWDEDVHDQGWKHFRUUHODWHGGXUDWLRQRIWKHGXPSWKLVFRXOGSRVHDSUREOHP,IWKLVLVWKH
FDVH\RXVKRXOGFRQVLGHUXVLQJWKH,QQR'%VWRUDJHHQJLQHLQVWHDGRI0\,6$0WDEOHVZKLFK
ZHUHFRPPHQGDQ\ZD\IRUPRVWDSSOLFDWLRQVDV,QQR'%DOORZVGXPSLQJDFRQVLVWHQW
VQDSVKRWRIWKHGDWDEDVHEDVLFDOO\ZLWKRXWDQ\SRWHQWLDOO\ORQJODVWLQJORFNV$QRWKHU
DOWHUQDWLYHLVWRXVHDVHSDUDWHUHSOLFDWLRQVODYHDVWKHEDFNXSVRXUFHDVGHVFULEHGLQWKH
8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSVZLWKRXWKXUWLQJDSURGXFWLRQV\VWHP
VSHUIRUPDQFH
UHFLSHZKLFKDOORZVIRUEDFNXSVZLWKRXWQHJDWLYHFRQVHTXHQFHVIRUWKHPDVWHU
GDWDEDVHVHUYHU
&UHDWLQJFRQVLVWHQWGXPSVRI,QQR'%WDEOHV
,I\RXGHDOPDLQO\ZLWK,QQR'%WDEOHVRURWKHUWDEOHVXVLQJDGLIIHUHQWWUDQVDFWLRQDOVWRUDJH
HQJLQH\RXVKRXOGDGGWKH--single-transactionRSWLRQWRWKHSUHYLRXVmysqldump
FRPPDQG7KLVRSWLRQFUHDWHVDFRQVLVWHQWVQDSVKRWRIDOO,QQR'%WDEOHVZKLFKLVWKHQ
ZULWWHQWRWKHGXPS%XWSOHDVHQRWHWKDWWKLVRSWLRQHQVXUHVLQWHJULW\RQO\IRUWUDQVDFWLRQDO
WDEOHV)RU0\,6$0WDEOHVWKLVRSWLRQLQFUHDVHVWKHULVNRIGXPSLQJLQFRQVLVWHQWGDWDDFURVV
WDEOHVDV--single-transactionGLVDEOHVWKH--lock-tablesDQG--lock-all-
tablesRSWLRQ͘
2QHVKRXOGDOVREHDZDUHWKDWWKH,QQR'%VQDSVKRWVDUHQRWDEOHWRFRSHZLWKFRQFXUUHQW
VWDWHPHQWVWKDWDOWHUWKHWDEOHVWUXFWXUHVXFKDVALTER TABLE͕DROP TABLE͕TRUNCATE 
TABLERURENAME TABLE<RXVKRXOGPDNHVXUHWKDWWKHVHVWDWHPHQWVDUHQRWH[HFXWHG
GXULQJDGXPS͘
3UHYHQWLQJGXPSLQFRQVLVWHQF\DFURVVGDWDEDVHV
7KHGHIDXOW--lock-tablesRSWLRQFDXVHVmysqldumpWRORFNDOOWDEOHVIRUHDFKVFKHPD
GDWDEDVHVHSDUDWHO\,QFDVHRIGHSHQGHQFLHVDFURVVVFKHPDWDWKLVPLJKWOHDGWR
LQFRQVLVWHQWGDWDDJDLQ7KLQNRIDQHQWU\WKDWJHWVFKDQJHGLQVFKHPD$7KHFRUUHVSRQGLQJ
HQWU\LQVFKHPD%³ZKLFKKROGVDUHIHUHQFHWRWKHÀUVWHQWU\³LVXSGDWHGRQO\DIWHUWKHGXPS
RIWKHVHFRQGVFKHPDLVÀQLVKHG,ImysqldumpGXPSVVFKHPD%ÀUVWWKHQVFKHPD$
\RXZLOOKDYHDQRUSKDQHQWU\LQVFKHPD$
7RSUHYHQWWKLVSUREOHP\RXFRXOGSDVVWKH--lock-all-tablesRSWLRQWRmysqldump͕
ZKLFKUHVXOWVLQORFNVDFURVVDOOGDWDEDVHV$VDGRZQVLGHWKLVDSSURDFKSURGXFHVORQJHU
ODVWLQJORFNVWKDQWKHGHIDXOWPHWKRGVR\RXVKRXOGXVHLWRQO\LIQHHGHG

&KDSWHU

,QFOXGLQJELQDU\ORJSRVLWLRQLQWKHGXPS
,I\RXUGDWDEDVHKDVELQORJJLQJHQDEOHGWKHQ\RXVKRXOGXVHDQDGGLWLRQDORSWLRQIRUWKH
mysqldumpFRPPDQG--master-data=2,WLQFOXGHVWKHORJSRVLWLRQRI\RXUGDWDEDVH
VHUYHULQ\RXUGXPSÀOH7KLVLVH[WUHPHO\XVHIXOZKHQWU\LQJWRSHUIRUPD
SRLQWLQWLPHUHFRYHU\XVLQJWKHGXPSDQGDGGLWLRQDOELQDU\ORJÀOHVDVGHVFULEHGLQD
IROORZLQJUHFLSH7KLVRSWLRQZRUNVRQO\LIELQORJJLQJLVHQDEOHG
3OHDVHQRWHWKDWWKLVRSWLRQLPSOLFLWO\HQDEOHV--lock-all-tablesXQOHVVXVHGLQ
FRQMXQFWLRQZLWK–-single-transactionZKLFKGLVDEOHVERWKWDEOHORFNRSWLRQV
3HUIRUPLQJFRQVLVWHQWGXPSVIRUELQDU\GDWD
:KHQXVLQJELQDU\GDWDLQFROXPQVRIW\SHBINARYVARBINARYBLOBLQDOOVL]HVRUBIT
\RXVKRXOGDGGLWLRQDOO\LQFOXGHWKH--hex-blobRSWLRQIRUmysqldumpWRHQVXUHDOOGDWDLV
GXPSHGFRUUHFWO\2WKHUZLVH\RXPLJKWHQFRXQWHUSUREOHPVZLWKPHVVHGXSGDWD7KHUHDVRQ
IRUWKLVSUREOHPLVWKHFRQYHUVLRQRIVSHFLDOE\WHVVHTXHQFHVOLNHOLQHEUHDNVWKDWWDNHVSODFH
ZKHQH[SRUWLQJDQGLPSRUWLQJGDWD7KH--hex-blobRSWLRQFLUFXPYHQWVWKLVFRQYHUVLRQIRU
ELQDU\FROXPQV
5HGXFLQJSHUIRUPDQFHLPSDFWVE\XVLQJPXOWLSOHGLVNV
:KHQFUHDWLQJDGXPS\RXUFRPSXWHUKDVWRSHUIRUPERWKUHDGDQGZULWHRSHUDWLRQVLQ
SDUDOOHO³WKHGDWDEDVHLVUHDGDQGWKHGXPSLVZULWWHQ,IERWKRSHUDWLRQVDFFHVVWKHVDPH
GLVNLWUHVXOWVLQDKLJKORDGRQWKHGLVNDQGPDQ\KHDGPRYHPHQWVZKLFKLQWXUQUHGXFHV
WKHSHUIRUPDQFH,I\RXKDYHPXOWLSOHSK\VLFDOGLVNVDYDLODEOHDORJLFDOGULYHRUSDUWLWLRQRQ
WKHVDPHSK\VLFDOGLVNZLOOQRWKHOS\RXFDQLQFUHDVHGXPSSHUIRUPDQFHFRQVLGHUDEO\E\
WDUJHWLQJWKHGXPSWRDGLIIHUHQWGLVNWKDQWKHGLVNWKDWKROGV\RXUGDWDEDVHGDWD
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
f
8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSVZLWKRXWKXUWLQJDSURGXFWLRQ
V\VWHP
VSHUIRUPDQFH

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

&UHDWLQJD64/GXPSRIVSHFLÀFGDWDEDVHV
7KLVUHFLSHVKRZV\RXKRZWRVHOHFWVSHFLÀFGDWDEDVHVIRUEDFNXS7KLVPLJKWEHXVHIXOIRU
H[DPSOHWRVHSDUDWHWKHEDFNXSSURFHVVHVIRUGLIIHUHQWGDWDEDVHVLIWKHVHKDYHGLIIHUHQW
RUHYHQZRUVHFRQWUDGLFWRU\EDFNXSSROLFLHV
*HWWLQJUHDG\
$VWKLVLVRQO\DVOLJKWDGDSWLRQRIWKHSUHYLRXVUHFLSHWKHSUHFRQGLWLRQVDUHDOPRVWLGHQWLFDO
DJDLQ\RXKDYHWRKDYHD0\64/XVHUDFFRXQWKHUHbackup_usrZLWKVXIÀFLHQWSULYLOHJHV
WRSHUIRUPDGDWDEDVHGXPSDQGDWDUJHWGLUHFWRU\KHUHD:\MySQLBackup\
$GGLWLRQDOO\\RXKDYHWREHVXUHWKDWWKHGDWDEDVHV\RXZDQWWRGXPSKDYHQRGDWD
GHSHQGHQFLHVRQGDWDEDVHVWKDWZLOOQRWEHSDUWRIWKHGXPS7KLVFRXOGUHVXOWLQDGXPSWKDW
LVQRWVHOIFRQWDLQHGDQGPLJKWFDXVHGDWDLQFRQVLVWHQFLHVLQFDVHRIDUHVWRUH
7KURXJKRXWWKLVUHFLSHZHZLOODVVXPHWKDW\RXZDQWWRGXPSWKHFRQWHQWRIWKHWZR
GDWDEDVHVemployeesDQGsuppliers
+RZWRGRLW
([HFXWHWKHIROORZLQJFRPPDQGIURPWKHFRPPDQGOLQH
C:\>mysqldump -u backup_usr -p"B4ckM3Up!" --databases employees suppliers 
> "D:\MySQLBackup\MySQLDump_Employees_Suppliers.sql"
+RZLWZRUNV
7KHFRPPDQGLVEDVLFDOO\LGHQWLFDOWRWKHmysqldumpFRPPDQGSUHVHQWHGLQWKHSUHYLRXV
UHFLSH7KHRQO\GLIIHUHQFHLVWKDWWKH--all-databasesFODXVHLVUHSODFHGE\WKH
--databasesRSWLRQ7KLVRSWLRQLVIROORZHGE\DGDWDEDVHRUDOLVWRIGDWDEDVHVVHSDUDWHG
E\EODQNVWKDWVKRXOGEHLQFOXGHGLQWKHUHVXOWLQJGXPS
7KHDGGLWLRQDORSWLRQVPHQWLRQHGLQWKHSUHYLRXVUHFLSHDUHDSSOLFDEOHIRUWKH
--databasesYDULDQWDVZHOO<RXKDYHWRPDNHVXUHKRZHYHUWKDWWKH--databases
RSWLRQLVWKHODVWRSWLRQWRmysqldump

&KDSWHU

7KHUH
VPRUH
$QDGYDQWDJHRIGXPSLQJGDWDEDVHVVHSDUDWHO\LVWKDWDGDWDEDVHFDQEHUHVWRUHGZLWKRXW
DIIHFWLQJRWKHUGDWDEDVHV$OWKRXJKDIXOOUHVWRUHRIDOOGDWDEDVHVWDNHVDOLWWOHPRUHZRUN
LQPRVWVLWXDWLRQVWKLVLVRXWZHLJKHGE\WKHDGGLWLRQDOÁH[LELOLW\RIKDYLQJVHSDUDWHGXPSV
$QRWKHUDGYDQWDJHLVWKDWWKHGXPSÀOHVDUHW\SLFDOO\OHVVFOXPV\DQGDUHHDVLHUWRKDQGOH
EHFDXVHRIWKHLUUHGXFHGVL]H
&RQVLGHULQJWKHVLGHHIIHFWVRIDXWRPDWHGEDFNXS
)RUDXWRPDWHGEDFNXSVWKHLGHDRIEDFNLQJXSHDFKGDWDEDVHWRLWVRZQGXPSÀOHKDVD
VLGHHIIHFWWKDWVKRXOGEHFRQVLGHUHGDW\SLFDOVLPSOHVFULSWWKDWEDVLFDOO\FRQWDLQVRQH
mysqldumpFRPPDQGIRUHDFKGDWDEDVHKDVWREHDGDSWHGHYHU\WLPHDGDWDEDVHLVDGGHG
RUGHOHWHG,QDG\QDPLFHQYLURQPHQWZKHUHWKHVFKHPDFDWDORJXHLVVXEMHFWWRFRQVWDQW
FKDQJHV\RXVKRXOGFRQVLGHUZULWLQJDVFULSWWKDWUHDGVWKHDYDLODEOHGDWDEDVHVIRUH[DPSOH
XVLQJSHOW DATABASESDQGLWHUDWHVRYHUWKHUHVXOWLQJOLVWWRGXPSHDFKGDWDEDVH
,QFUHDVLQJSHUIRUPDQFHE\GXPSLQJLQSDUDOOHO
7ROHYHUDJHFXUUHQWFRPSXWHUVZLWKPXOWLFRUHSURFHVVRUVRQHDSSURDFKWRUHGXFHWKHWLPH
QHHGHGIRUEDFNLQJXSDGDWDEDVHLVWRSDUDOOHOL]HWKHZRUN,I\RXVWDUWVHYHUDOSURFHVVHV
FRQFXUUHQWO\\RXPLJKWEHDEOHWRDFKLHYHIDVWHUEDFNXSV+RZHYHUWKHGHJUHHRIVXFFHVV
ODUJHO\GHSHQGVRQWKHDYDLODEOHUHVRXUFHV,IWKHGDWDWKURXJKSXWVRI\RXUGULYHVDUHWKH
OLPLWLQJIDFWRU\RXZLOOQRWEHDEOHWRVLJQLÀFDQWO\VSHHGXS\RXUEDFNXSEXWLQWKHFDVHRI
IDVWGLVNVRUPXOWLSOHGLVNVDVQRWHGLQWKHSUHYLRXVUHFLSHFRQFXUUHQF\PLJKWKHOS\RXVDYH
VRPHWLPH7U\FRQFXUUHQWO\EDFNLQJXSHDFKGDWDEDVHWRVHSDUDWHGLVNVLIDSSOLFDEOHIRU
PD[LPXPSHUIRUPDQFH
,I\RXKDSSHQWRXVHD/LQX[VHUYHUIRU\RXU0\64/\RXPLJKWDOVRZDQWWRKDYHDORRN
DWmk-parallel-dumpIURP0DDWNLWWKDWKHOSV\RXWRGXPSWDEOHVHWVLQSDUDOOHO
VHHhttp://www.maatkit.org/doc/mk-parallel-dump.html8QIRUWXQDWHO\
WKLVLVQRW\HWDYDLODEOHIRU:LQGRZVXVHUV$OVRQRWHWKDWWKHZHEVLWHH[SOLFLWO\VWDWHVWKDW
mk-parallel-dumpLVQRWDEDFNXSSURJUDPVR\RXPLJKWZDQWWRXVHDGLIIHUHQWEDFNXS
VWUDWHJ\EHVLGHVmk-parallel-dumpMXVWWREHVXUH
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

&UHDWLQJD64/GXPSRIVSHFLÀFWDEOHV
7KLVUHFLSHZLOOVKRZ\RXKRZWRGXPSRQO\DSRUWLRQRIDGDWDEDVHE\VHOHFWLQJVSHFLÀFWDEOHV
WRLQFOXGHLQWKHGXPSZKLFKFRPHVLQKDQG\LI\RXKDYHVSHFLÀFEDFNXSUHTXLUHPHQWVIRU
VSHFLDOWDEOHVIRUH[DPSOHKLJKHUEDFNXSIUHTXHQF\WKDWGLIIHUIURPWKHEDFNXSUXOHVIRUWKH
UHVWRIWKHGDWDEDVH
*HWWLQJUHDG\
$JDLQWKLVUHFLSHLVYHU\VLPLODUWRWKHSUHYLRXVRQH:HZLOOQHHGDVXLWDEOH0\64/XVHU
DFFRXQWbackup_usrDQGDWDUJHWGLUHFWRU\ZLWKVXIÀFLHQWVSDFHD:\MySQLBackup\
$VZHUHVWULFWWKHGXPSWRVSHFLÀFWDEOHV\RXVKRXOGDGGLWLRQDOO\FKHFNWKDWWKHWDEOHVWR
LQFOXGHLQWKLVGXPSKDYHQRGHSHQGHQFLHVRQRWKHUWDEOHVRUGDWDEDVHVWKDWZLOOQRWEH
LQFOXGHGLQWKHUHVXOWLQJGXPS
)RUWKHIROORZLQJLQVWUXFWLRQZHDVVXPHWKDWWKHWDEOHdepartmentsIURPWKHVFKHPD
HPSOR\HHVVKRXOGEHZULWWHQWRWKHGXPS
+RZWRGRLW
([HFXWHWKHIROORZLQJFRPPDQGIURPWKHFRPPDQGOLQH
C:\>mysqldump -u backup_usr -p"B4ckM3Up!" employees departments > "D:\
MySQLBackup\MySQLDump_Departments.sql"
+RZLWZRUNV
7KHDERYHFRPPDQGZRUNVMXVWDVH[SODLQHGLQWKHSUHYLRXVUHFLSHZLWKWKHRQO\GLIIHUHQFH
EHLQJWKDWQRVSHFLÀFRSWLRQOLNH--all-databasesRU--databasesLVJLYHQWRSDVV
WKHGHVLUHGVRXUFHGDWDEDVHVWRmysqldump,QWKLVFDVHmysqldumpUHDGVWKHÀUVWUHDO
SDUDPHWHUWKDWLVVWDUWLQJZLWKRXWDGDVKDVWKHVRXUFHGDWDEDVHIROORZHGE\DOLVWRIWDEOHV
WRGXPSVHSDUDWHGE\VSDFHV,QWKHDERYHH[DPSOHWKLVOLVWFRQVLVWVRIRQO\RQHWDEOHEXW
RWKHUVFRXOGEHSDVVHGDVZHOO
7KHUH
VPRUH
:KLOHWKLVDSSURDFKLVVRPHWLPHVYHU\QLFHWRSURGXFHEDFNXSVWKDWDUHUHVWULFWHGWRWKH
UHOHYDQWWDEOHVRQO\ZHUHFRPPHQG\RXQRWWRXVHWKLVIRUDXWRPDWHGEDFNXSV7KHUHDVRQ
IRUWKLVUHFRPPHQGDWLRQLVWKDWGDWDPRGHOVDUHW\SLFDOO\VXEMHFWWRDFHUWDLQH[WHQWRI
HYROXWLRQ,IIRUH[DPSOHDQHZWDEOHLVLQWURGXFHGDQGWKLVWDEOHLVUHIHUHQFHGE\DWDEOH
FRQWDLQHGLQWKHEDFNXS\RXVKRXOGLQFOXGHWKHQHZWDEOHLQWKHEDFNXSDVZHOO)RUWKLV
WKHmysqldumpFRPPDQGKDVWREHFKDQJHGULJKWDIWHUWKHWDEOHVWUXFWXUHVZHUHDSSOLHG
([SHULHQFHVKRZVWKDWVXFKGHSHQGHQFLHVEHWZHHQGDWDVWUXFWXUHVDQGVFULSWVUHO\LQJRQD

&KDSWHU

VSHFLÀFVWUXFWXUHDUHW\SLFDOO\LJQRUHGRURYHUORRNHGOHDYLQJ\RXZLWKDEDFNXSWKDWFRQWDLQV
RQO\DSDUWRIWKHUHTXLUHGGDWD7KLVLVZK\ZHUHFRPPHQGGXPSLQJWKHVFKHPDRUDOO
VFKHPDWDDVDZKROHWRSUHYHQWSUREOHPVDULVLQJIURPVXEVHTXHQWGDWDPRGHOHYROXWLRQ
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
&RPSUHVVLQJ64/GXPSVRQWKHÁ\
:KHQWKHGDWDVWRUHGLQ\RXUGDWDEDVHJURZVRYHUWLPHWKHEDFNXSVJHWELJJHUDVZHOO<RX
RIWHQZLOOZDQWWRUHGXFHWKHVSDFHUHTXLUHGIRU\RXUEDFNXSVWRUHGXFHWKHGLVNRUWDSH
VWRUDJHUHTXLUHPHQWV,I\RXFUHDWHDEDFNXSXVLQJmysqldump\RXFDQUHGXFHWKHVL]HRI
\RXUEDFNXSVFRQVLGHUDEO\7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRDFKLHYHWKLV
*HWWLQJUHDG\
,QDGGLWLRQWRWKHSUHUHTXLVLWHVOLVWHGLQWKHSUHYLRXVWKUHHUHFLSHVDVXLWDEOH0\64/
DFFRXQWDQGDWDUJHWGLUHFWRU\ZHDOVRQHHGDQLQVWDOOHGYHUVLRQRIJ]LS
VHHhttp://www.gzip.org/#exeZKLFKLVDZLGHO\XVHGRSHQVRXUFHFRPSUHVVLRQXWLOLW\
,QWKLVUHFLSHZHZLOOSURGXFHDGXPSRIDOOGDWDEDVHVDQGFRPSUHVVLWEHIRUHLWLVZULWWHQWR
WKHGLVN
+RZWRGRLW
([HFXWHWKHIROORZLQJFRPPDQGIURPWKHFRPPDQGOLQH
C:\>mysqldump -u backup_usr -p"B4ckM3Up!" --all-databases | gzip --fast > 
"D:\MySQLBackup\MySQLDumpAllDatabases.sql.gz"
+RZLWZRUNV
7KHRQO\GLIIHUHQFHLQWKHDERYHFRPPDQGOLQHLQFRPSDULVRQWRWKHSUHYLRXVUHFLSHVEHVLGH
WKHVOLJKWO\FKDQJHGWDUJHWÀOHQDPHWRUHÁHFWWKHFRPSUHVVHGFRQWHQWOLHVZLWKLQ
WKH| gzip --fastSRUWLRQ7KLVUHGLUHFWVWKHRXWSXWRIWKHmysqldumpFRPPDQGWRWKH
J]LSSURJUDPZKLFKFRPSUHVVHVGDWDRQWKHÁ\7KHFRPSUHVVHGGDWDVWUHDPLVWKHQZULWWHQ
WRWKHJLYHQÀOHUHVXOWLQJLQDVLJQLÀFDQWO\UHGXFHGVL]H
7KHUH
VPRUH«
:KLOHWKHUHFLSHLWVHOILVQRWWRRFRPSOLFDWHGWKHUHDUHVRPHDVSHFWVWRFRQVLGHUZKLFKDUH
GLVFXVVHGLQWKHIROORZLQJVHFWLRQV

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

$FKLHYLQJEHWWHUFRPSUHVVLRQUDWLR
$VDEDOOSDUNÀJXUHIRUWKHFRPSUHVVLRQUDWLRIRUW\SLFDOGDWDEDVHVWKHFRPSUHVVHGGXPS
ZLOOSUREDEO\EHUHGXFHGWRRQHWKLUGRILWVXQFRPSUHVVHGVL]H7RDFKLHYHEHWWHUFRPSUHVVLRQ
DWWKHH[SHQVHRIUHGXFHGSHUIRUPDQFHDQGKLJKHU&38ORDG\RXFRXOGDOVROHDYHRXWWKH
--fastRSWLRQRIJ]LSUHVXOWLQJLQDFRPSUHVVHGÀOHWKDWZLOOWDNHOHVVWKDQRIWKH
RULJLQDOVL]H,IWKHVL]HRIWKHEDFNXSLVDQH[WUHPHO\FULWLFDOLVVXHIRU\RX\RXPLJKWHYHQ
WU\WKH--bestRSWLRQDVDUHSODFHPHQWIRU--fast͕EXWEHZDUQHGWKDWWKLVPLJKWOHDGWRD
GUDPDWLFLQFUHDVHLQH[HFXWLRQWLPHVZLWKPRVWO\PLQLPDOLPSURYHPHQWVLQVL]HWKLVLVZK\ZH
UHFRPPHQGQRWXVLQJWKLVRSWLRQ
&RQVLGHULQJSHUIRUPDQFHIDFWRUV
:LWKWKHDGGLWLRQDOFRPSUHVVLRQSDUWDGGHGWRWKHDERYHFRPPDQG\RXZRXOGLQWXLWLYHO\
H[SHFWWKDWWKLVQHFHVVDULO\KDVDQHJDWLYHLPSDFWRQWKHGXPSSHUIRUPDQFH6XUSULVLQJO\
WKLVLVQRWDOZD\VWKHFDVHDVWKHUHGXFHGVL]HRIWKHUHVXOWLQJÀOHDOVRGHFUHDVHVWKHDPRXQW
RIGDWDZULWWHQWR\RXUGLVN7KLVUHGXFWLRQLQGLVN,2PLJKWPDNHXSIRUWKHDGGLWLRQDO
FRPSUHVVLRQZRUNRUHYHQFDXVHDSHUIRUPDQFHLPSURYHPHQW<RXVKRXOGFKHFNZKHWKHUWKH
FRPSUHVVLRQKDVDQ\SHUIRUPDQFHLPSDFWZLWK\RXUFRQÀJXUDWLRQ
$UXOHRIWKXPEWKHVORZHUWKHWDUJHWGLVNDQGWKHIDVWHU\RXUSURFHVVRUVWKHEHWWHULWLVIRU
FRPSUHVVLRQ$QGLI\RXZDQWWRWDNHV\VWHPORDGLQWRDFFRXQWDVZHOO,I\RXH[SHULHQFHKLJK
,2ORDGRQ\RXUWDUJHWGLVNDQGORZ&38ORDGLWLVZHOOSRVVLEOHWKDWWKHSHUIRUPDQFHLPSDFW
RIRQWKHÁ\FRPSUHVVLRQLVQRWWRRVLJQLÀFDQW
&RQVLGHULQJGDWDUREXVWQHVVDQGWRRODYDLODELOLW\
:LWKWKHRQWKHÁ\FRPSUHVVLRQDSSURDFKWKHUHVXOWLQJGXPSÀOHVFDQQRWEHUHDGZLWKRXW
XQFRPSUHVVLQJWKHPZKLFKLVZK\\RXQHHGWRKDYHWKHJ]LSWRRODWKDQGIRUWKHUHVWRUH
SURFHVVDVZHOO
0RUHRYHUGXHWRWKHIDFWWKDWWKHFRPSUHVVHGÀOHVKDYHDFRPSUHVVHGELQDU\IRUPDWWKH\
DUHPXFKPRUHVXVFHSWLEOHWRIDXOWVFDXVHGE\GDWDFRUUXSWLRQ,IGDWDFRUUXSWLRQRFFXUVLWLV
W\SLFDOO\PRUHGLIÀFXOWWRH[WUDFWYDOLGGDWDDQGWKHDPRXQWRIGDWDWKDWLVLUUHYRFDEO\ORVWLV
W\SLFDOO\DJRRGGHDOELJJHU
,IDSDUWLDOGDWDORVVRFFXUVIRUDVWDQGDUGGXPS64/ÀOH\RXZLOOVWLOOEHDEOHWRUHVWRUHODUJH
SRUWLRQVRIWKHGDWDEHFDXVH\RXDUHDEOHWRUHDGWKHÀOHH[WUDFWWKHLQWDFWGDWDDQGPD\EH
HYHQFRUUHFWWKHHUURUV
+RZHYHULQFDVHRIDSDUWLDOGDWDORVVRQWKHFRPSUHVVHGÀOHWKHXQFRPSUHVVFRPPDQGZLOO
VLPSO\IDLOEDVLFDOO\OHDYLQJ\RXZLWKRXWDXVDEOHEDFNXSVLQFHPDQXDOFRUUHFWLRQVWRWKH
FRPSUHVVHGÀOHDUHDOPRVWLPSRVVLEOH<RXVKRXOGNHHSWKLVLQPLQGZKHQGHFLGLQJRQWKH
EHVWVROXWLRQWRSHUIRUPDEDFNXS

&KDSWHU

$FKLHYLQJEHWWHUFRPSUHVVLRQZLWKDOWHUQDWLYHWRROV
$VDQDOWHUQDWLYHWRJ]LS\RXFRXOGDOVRWU\VLPLODUFRPSUHVVLRQXWLOLWLHVOLNHE]LS
http://www.bzip.org/downloads.htmlS]LSIRU/LQX[http://p7zip.
sourceforge.net/RU=LSIRU:LQGRZVhttp://www.7-zip.org/ZKLFKFODLPWR
SURYLGHDEHWWHUFRPSUHVVLRQWKDQJ]LS
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
5RWDWLQJDQGSXUJLQJELQDU\ORJV
,I\RXKDYHELQDU\ORJJLQJHQDEOHGWKHbinlogÀOHVFRQWDLQDOOFKDQJHVPDGHWR\RXU
GDWDEDVHRYHUWLPH7KHVHDUHUHTXLUHGIRUUHSOLFDWLRQEXWWKH\FDQDOVREHXVHGIRUUHVWRULQJ
GDWDDIWHUDFUDVK7KLVLVZK\ZHVWURQJO\HQFRXUDJH\RXWRHQDEOHELQDU\ORJJLQJHYHQLI\RX
GRQRWXVHUHSOLFDWLRQ,I\RXVWLOOKDYHDFFHVVWRWKHbinlogsSURGXFHGEHWZHHQ\RXUODVW
EDFNXSDQGWKHPRPHQWWKHGLVDVWHURFFXUUHG\RXFDQEDVLFDOO\UHFRYHUHYHU\WKLQJZLWKRXW
ORVLQJDQ\GDWDDWDOO
7REHDEOHWRGRVRWKHELQDU\ORJVVKRXOGUHJXODUO\EHVDYHGWRDGLIIHUHQWORFDWLRQEHVWRQ
DGLIIHUHQWGULYHRUWDSHPHGLD0RUHRYHU\RXZLOOQHHGWRUHPRYHbinlogÀOHVWKDWDUHQR
ORQJHUQHHGHGWRSUHYHQWWKHGLVNIURPJHWWLQJIXOO7REHDEOHWRFRS\WKHUHOHYDQWÀOHVWKLV
UHFLSHZLOOVKRZ\RXKRZWRPDNHVXUHQRFRQFXUUHQWDFFHVVLVDFWLYHZKHQEDFNLQJXS
WKHGDWD
*HWWLQJUHDG\
:HDVVXPHWKDW\RXKDYHDUHJXODUEDFNXSSURFHVVLQSODFHZKLFKSURGXFHVDGDLO\EDFNXS
EDVHGRQD0\64/GXPS<RXUDSSOLFDWLRQUHTXLUHVWKDWLQFDVHRIDGLVDVWHU\RXPXVWEH
DEOHWRUHFRYHUDOOGDWDROGHUWKDQKDOIDQKRXUEHIRUHWKHFUDVK7RDFKLHYHWKLV\RXZLOOKDYH
WRVDYHWKHELQDU\ORJVDWOHDVWHYHU\PLQXWHVWRDORFDWLRQWKDWZLOOQRWEHDIIHFWHGE\D
SRVVLEOHFUDVKRQ\RXUGDWDEDVHVHUYHU
,QDGGLWLRQOHW
VDVVXPHWKDW\RXZLOOQRWQHHGDQ\binlogsROGHUWKDQGD\VIRUUHSOLFDWLRQ
7KLVLQWXUQPHDQVWKDWDQ\UHSOLFDWLRQVODYHZLWKDGDWDVHWROGHUWKDQGD\VZLOOQRWEHDEOH
WRUHHQWHUUHSOLFDWLRQDJDLQWRFDWFKXSZLWKWKHPDVWHUEXWWKLVW\SLFDOO\PDNHVQRVHQVH
DQ\ZD\7KXVDOObinlogsROGHUWKDQGD\VFDQEHGHOHWHG

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

<RXZLOODJDLQQHHGDQDSSURSULDWH0\64/XVHUDFFRXQWbackup_usrDQGDSODFHWR
FRS\WKHbinlogsWR7KHUHFLSHDVVXPHVD:LQGRZVV\VWHPDQGDWDUJHWGLUHFWRU\DW
D:\MySQLBackup\binlogs\7KHlog-binSDUDPHWHURIWKH0\64/FRQÀJXUDWLRQLV
DVVXPHGWRKDYHWKHYDOXHC:/MySQL/Binlogs/bluebox
7KHUHFLSHLVDSSOLFDEOHWR:LQGRZVV\VWHPV3OHDVHUHIHUWR
WKH7KHUH
VPRUHVHFWLRQIRUD/LQX[8QL[YDULDQW
+RZWRGRLW
(VWDEOLVKDVFKHGXOHGWDVNWRSHUIRUPWKHIROORZLQJFRPPDQGVDWOHDVWHYHU\PLQXWHVLQ
WKHFRQWH[WRIWKHGLUHFWRU\C:\MySQL\Binlogs\
copy bluebox.index idx.tmp 
mysql -u backup_usr -p"B4ckM3Up!" -e "FLUSH LOGS;
    PURGE BINARY LOGS BEFORE TIMESTAMPADD(DAY, -7, NOW());"
FOR /F %i in (idx.tmp) DO xcopy /D %i D:\MySQLBackup\binlogs\
DEL idx.tmp
+RZLWZRUNV
/HW
VWDNHDORRNDWHDFKVWHSRIWKLVUHFLSH
7KHOLQHcopy bluebox.index idx.tmpPDNHVDWHPSRUDU\FRS\RIWKHLQGH[ÀOHWKDW
FRQWDLQVWKHLQGH[OLVWRIDOObinlogÀOHVZKLFKLVQHHGHGIRUIXWXUHUHIHUHQFH
7KHQH[WOLQHH[HFXWHVWKH0\64/FRPPDQGVFLUSH LOGSDQGPURGE BINARY LOGS 
BEFORE TIMESTAMPADD(DAY, -7, NOW())RQWKHGDWDEDVHFLUSH LOGSFDXVHV
0\64/WRFORVHDQGUHRSHQDOOORJÀOHVDQGWRFUHDWHDQHZbinlogÀOHZLWKDQLQFUHPHQWHG
FRXQWHU7KLVKDVWKHHIIHFWWKDWZULWHDFFHVVWRWKHSUHYLRXVbinlogLVÀQLVKHGVRZHFDQ
VDIHO\EDFNLWXSWRDQRWKHUORFDWLRQZLWKRXWULVNLQJDFFHVVFRQÁLFWV
7KHPURGE BINARY LOGS BEFORE TIMESTAMPADD(DAY, -7, NOW())FRPPDQG
FDXVHV0\64/WRGHOHWHDOObinlogÀOHVROGHUWKDQGD\VZKLFKPDNHVVXUHWKDWWKH
binlogGLUHFWRU\GRHVQRWÀOOXSRYHUWLPH

&KDSWHU

7KHORRSFRPPDQGFOR /F %i in (idx.tmp) DO XVHVWKHROGLQGH[ÀOHWKDWZHFRSLHG
LQWKHÀUVWFRPPDQGWRLWHUDWHRYHUDOObinlogÀOHV7KHxcopy /D %i D:\MySQLBackup\
binlogs\FRPPDQGFRSLHVHDFKbinlogÀOHWRWKHEDFNXSWDUJHWORFDWLRQ$VWKHLQGH[ÀOH
ZDVFRSLHGEHIRUHZHH[HFXWHGWKHPURGE BINARY LOGSFRPPDQGWKHOLVWRIÀOHVFRSLHG
GRHVQRWLQFOXGHWKHFXUUHQWbinlogÀOHZKLFKLVVWLOODFWLYHO\DFFHVVHGDQGSRVVLEO\FKDQJHG
E\0\64/6RZHFDQEHSUHWW\VXUHQRZULWHDFFHVVWRWKHÀOHVLQWKLVOLVWRFFXUV7KH/D
RSWLRQRIWKHxcopyFRPPDQGLVYHU\XVHIXOWRSUHYHQWWKHVDPHÀOHVIURPEHLQJFRSLHGRYHU
DQGRYHUDJDLQ7KLVRSWLRQWHOOVxcopyWRFRS\ÀOHVRQO\LIWKHVRXUFHÀOHLVQHZHUWKDQDQ
H[LVWLQJWDUJHWÀOHVRXQFKDQJHGÀOHVWKDWDUHDOUHDG\SUHVHQWDWWKHWDUJHWGLUHFWRU\ZLOOQRW
EHFRSLHGDJDLQ
7KHÀQDOFRPPDQGWKHQVLPSO\FOHDQVXSWKHWHPSRUDU\ÀOHZKLFKZHFUHDWHGLQWKHÀUVW
VWHSVRZHOHDYHWKHSODFHQLFHDQGFOHDQ
7KHUH
VPRUH
,QWKLVVHFWLRQZHZLOOGLVFXVVVRPHSRWHQWLDOULVNVDQGDYDULDQWRIWKHUHFLSHIRU
/LQX[V\VWHPV
5RWDWLQJDQGSXUJLQJELQDU\ORJVRQ/LQX[V\VWHPV
'XHWRV\QWD[GLIIHUHQFHVLQWKHFRPPDQGOLQHLQWHUIDFHWKHDERYHUHFLSHLVDSSOLFDEOH
WR:LQGRZVV\VWHPVRQO\7RSHUIRUPWKHVDPHWDVNIRU/LQX[V\VWHPVXVHWKHIROORZLQJ
DSSURDFKZHDVVXPH/var/mysql_backup/binlogsDVWKHWDUJHWGLUHFWRU\DQG/var/
log/mysqlDVWKHlog-binSDUDPHWHU
(VWDEOLVKDcronMREWRSHUIRUPWKHIROORZLQJFRPPDQGVDWOHDVWHYHU\PLQXWHV
#!/bin/bash 
cd /var/log/mysql 
cp bluebox.index idx.tmp 
mysql -u backup_usr -p"B4ckM3Up!" -e "FLUSH LOGS; PURGE BINARY LOGS 
BEFORE TIMESTAMPADD(DAY, -7, NOW());"
cat idx.tmp | while read line; do 
    cp -u $line backup/ 
done 
rm idx.tmp

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

:KHQFRPSDULQJWKHVFULSWWRWKHHTXLYDOHQW:LQGRZVYHUVLRQ\RXZLOOQRWLFHVRPH
GLIIHUHQFHVZHZLOOQRWGLVFXVVWKHÀUVWWZROLQHVKHUHEXWFRQFHQWUDWHRQWKHDFWXDO
RSHUDWLRQV)LUVWRIDOOWKH:LQGRZVcopyFRPPDQGLVUHSODFHGE\WKH/LQX[VWDWHPHQWcp
7KHORRSFRPPDQGLVGLIIHUHQWDVZHOOcat idx.tmp | while read line; doUHSODFHV
WKH:LQGRZVFRPPDQGFOR /F %i in (idx.tmp) DO,WDOVRLWHUDWHVRYHUDOObinlog
ÀOHVDVOLVWHGLQWKHROGLQGH[ÀOHWKDWZHFRSLHGZLWKWKHÀUVWcpFRPPDQG7KH/DRSWLRQRI
:LQGRZV
xcopyLVUHÁHFWHGE\WKH-uRSWLRQRIcpZKLFKRQO\FRSLHVÀOHVLIWKH\DUHQHZRU
LIWKHFRUUHVSRQGLQJÀOHDWWKHWDUJHWGLUHFWRU\LVROGHUWKDQWKHÀOHWREHFRSLHG
&RQVLGHULQJULVNVRIGDWDORVV
7KHZKROHPHFKDQLVPRIFRS\LQJWKHbinlogÀOHVIURPRQHSODFHWRWKHRWKHUPDNHVOLWWOH
VHQVHLIWKHWZRGLUHFWRULHVDUHORFDWHGRQWKHVDPHSK\VLFDOGLVNEHFDXVHLQWKHFDVHRID
GLVNIDLOXUHGDWDLQERWKSODFHVZRXOGEHORVW<RXVKRXOGDWOHDVWKDYHWZRVHSDUDWHSK\VLFDO
GLVNVWRVWRUHWKHVHGLUHFWRULHVRQ'HSHQGLQJRQ\RXUUHTXLUHPHQWV\RXFRXOGDOVRFRQVLGHU
FRS\LQJWRDQRWKHUKRVWWRFRYHUWKHULVNRIÀUHRURWKHUGLVDVWHUVZKLFKFRXOGGDPDJHDOO
LQWHUQDOSK\VLFDOGLVNVRI\RXUPDFKLQH
(QVXULQJVXIÀFLHQWGLVNVSDFH
<RXZLOOKDYHWRPDNHVXUHRIFRXUVHWKDWVRPHNLQGRIEDFNXSDQGGHOHWLRQPHFKDQLVPLV
HVWDEOLVKHGDWWKHWDUJHWGLUHFWRU\DVZHOOWRSUHYHQWWKLVGLVNUXQQLQJRXWRIVSDFH,QDW\SLFDO
VFHQDULRDQDUFKLYLQJWRROPLJKWVFDQWKLVGLUHFWRU\RQFHDGD\VDYHWKHÀOHVWRDWDSHDUFKLYH
DQGGHOHWHWKHDUFKLYHGÀOHV
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
8VLQJUHSOLFDWLRQWRSHUIRUPEDFNXSV
ZLWKRXWKXUWLQJDSURGXFWLRQV\VWHP
V
SHUIRUPDQFH
$EDFNXSDOZD\VSURGXFHVDVLJQLÀFDQWORDGRQWKHVHUYHUWKHGDWDLVUHDGIURP,QDGGLWLRQ
GHSHQGLQJRQWKHZD\WKHEDFNXSLVSHUIRUPHGDQGWKHVWRUDJHHQJLQHXVHGIRU\RXUGDWD
ORFNLQJVLWXDWLRQVFDQRFFXUZKLFKPLJKWFDXVHPDMRUSUREOHPVIRU\RXUDSSOLFDWLRQV$
PHWKRGWRFLUFXPYHQWERWKRIWKHVHSUREOHPVLVWREDFNXSWKHGDWDIURPDUHSOLFDWLRQ
FOLHQWLQVWHDGRIWKHVHUYHU7KLVUHFLSHZLOOVKRZ\RXKRZWRDFKLHYHWKDW
3OHDVHQRWHWKDWZHGRQRWFRQVLGHUUHSOLFDWLRQLWVHOIDVDEDFNXSWHFKQLTXH$OWKRXJKWKLVLV
DVHQVLEOHDSSURDFKWRGHDOZLWKSRVVLEOHIDLOXUHVDQGWRUHGXFHGRZQWLPHVLWLVQRSURSHU
UHSODFHPHQWIRUFUHDWLQJUHJXODUEDFNXSV

&KDSWHU

*HWWLQJUHDG\
7REHDEOHWRIROORZWKLVUHFLSH\RXZLOORIFRXUVHQHHGD0\64/LQVWDQFHWKDWDFWVDVD
UHSOLFDWLRQFOLHQW:LWKRXWDZRUNLQJUHSOLFDWLRQVHWXSWKLVUHFLSHLVQRWKHOSIXO
,QDGGLWLRQ\RXQHHGD0\64/DFFRXQWZLWKDSSURSULDWHSULYLOHJHVZHDVVXPHWKHSUHYLRXVO\
XVHGbackup_usrKHUH$QGRIFRXUVH\RXZLOOQHHGVXIÀFLHQWVSDFHLQWKHWDUJHWGLUHFWRU\
WRVDYHWKHEDFNXSWR:HZLOODVVXPHWKHGDWDGLUHFWRU\RIWKHVODYHLQVWDQFHLV
C:\MySQLSlave\Data\DQGWKHEDFNXSWDUJHWGLUHFWRU\LVD:\MySQLBackup\.
,QWKLVUHFLSHZHZLOOUHIHUWRWKHSUHYLRXVUHFLSHVWREDFNXSGDWDHLWKHUXVLQJWKH
mysqldumpWRRORUE\FRS\LQJWKHGDWDÀOHV³ERWKDSSURDFKHVZRUNZLWKWKLVWHFKQLTXH
+RZWRGRLW
 2QWKHUHSOLFDWLRQFOLHQWH[HFXWHWKHIROORZLQJVWDWHPHQWRQWKHFRPPDQGOLQHWR
VWRSUHSOLFDWLRQSURFHVVLQJ
C:\>mysql -u backup_usr -p"B4ckM3Up!" -e"STOP SLAVE SQL_THREAD"

3HUIRUP\RXUEDFNXSHLWKHUXVLQJmysqldumpRUE\FRS\LQJWKHGDWDÀOHVDV
SUHVHQWHGLQWKHSUHYLRXVUHFLSHV

,IWKHEDFNXSLQVWHSZDVSHUIRUPHGXVLQJmysqldumpFRS\WKHUHSOLFDWLRQÀOHVWR
WKHEDFNXSWDUJHWGLUHFWRU\DVZHOOE\SHUIRUPLQJWKHIROORZLQJFRPPDQGV\RXFDQ
VNLSWKLVLI\RXFRSLHGWKHGDWDÀOHVLQVWHS
C:\>copy /Y C:\MySQLSlave\Data\*.info D:\MySQLBackup\ 
C:
\>copy /Y C:\MySQLSlave\Data\*relay-bin.* D:\MySQLBackup\
 ([HFXWHWKHIROORZLQJFRPPDQGWRVWDUWUHSOLFDWLRQSURFHVVLQJDJDLQ C:\>mysql 
-u backup_usr -p"B4ckM3Up!" -e"START SLAVE SQL_THREAD"
+RZLWZRUNV
7KHUHFLSHEDVLFDOO\FRQVLVWVRIWKUHHSDUWVE\SHUIRUPLQJWKHRSHUDWLRQVGHVFULEHGLQVWHS
UHSOLFDWLRQLVGLVDEOHGLQVWHSVDQGWKHEDFNXSLWVHOILVSHUIRUPHGLQVWHSUHSOLFDWLRQ
LVHQDEOHGDJDLQ
/HWXVKDYHDORRNDWWKHEDFNXSSDUWÀUVW,QVWHSWKHEDFNXSRIWKHGDWDVWRUHGLQWKH
VODYHGDWDEDVHLVGRQHDVVKRZQLQWKHSUHYLRXVUHFLSHV7KHDGGLWLRQRIVWHSLVQHFHVVDU\
WRDOVREDFNXSWKHUHSOLFDWLRQVWDWHRIWKHVODYH,QGHWDLOWKLVFRSLHVWKHUHOD\ORJÀOHV
[host]-relay-bin.indexDQG[hostname]-relay-bin.00xWKHrelay-log.info
DQGWKHmaster.infoÀOHV7KHVHÀOHVDUHQHFHVVDU\WRUHFRYHUWKHVODYHIURPDFUDVK
EHFDXVHZLWKRXWWKHVHÀOHVLWLVYHU\KDUGWRHVWDEOLVKDZRUNLQJUHSOLFDWLRQPHFKDQLVP
ZLWKWKHPDVWHU,I\RXULQWHQWLRQLVWRSHUIRUPDEDFNXSRQO\IRUUHVWRULQJWKHPDVWHUWKHVH
ÀOHVDUHQRWDEVROXWHO\QHFHVVDU\EXWZHVWURQJO\VXJJHVWLQFOXGLQJWKHVHÀOHVLQWKHEDFNXS
DVZHOO

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

7KDW
VDERXWLWFRQFHUQLQJWKHEDFNXSLWVHOI1RZZKDWLVWKHPRWLYDWLRQIRUVWHSVDQG"
7KHGHDFWLYDWLRQRIWKHVODYHUHSOLFDWLRQLQVWHSLVQHFHVVDU\WRSUHYHQWLQFRQVLVWHQFLHV
GXULQJWKHEDFNXS$VGLVFXVVHGEHIRUHERWKWKHFRS\DSSURDFKDQGWKHmysqldumpEDFNXS
KDYHUHVWULFWLRQVFRQFHUQLQJGDWDFRQVLVWHQFLHVIRUQRQWUDQVDFWLRQDOWDEOHVOLNH0\,6$0
ZKHQFRQFXUUHQWXSGDWHVRFFXUZKLOHWKHGDWDLVUHDG<RXFDQWDFNOHWKLVSUREOHPIRU
H[DPSOHXVLQJORFNLQJRSWLRQV%XWIRUDPDVWHUVODYHFRQVWHOODWLRQWKLVFRXOGLQDZRUVWFDVH
VFHQDULRFDXVHWKHUHSOLFDWLRQWREUHDN%\VWRSSLQJWKH64/VODYHWKUHDGWKHbinlogGDWD
LVVWLOOUHDGIURPWKHPDVWHUEXWLWLVQRORQJHUSURFHVVHG7KLVSUHYHQWVDQ\FRQFXUUHQWGDWD
PRGLÀFDWLRQVDQGWKHGDWDUHPDLQVLQDFRQVLVWHQWVWDWHWKURXJKRXWWKHEDFNXSSURFHVV
$IWHUWKHEDFNXSLVGRQHVWHSDFWLYDWHVUHSOLFDWLRQDJDLQDQGWKHVODYHZLOOVWDUWWRSURFHVV
WKHUHPDLQLQJFKDQJHVIURPWKHPDVWHUXSWRWKHSRLQWZKHUHPDVWHUDQGVODYHUHDFKD
V\QFKURQRXVVWDWH
,QWKLVVFHQDULRDOOEDFNXSRSHUDWLRQVWRJHWKHUZLWKWKHSRVVLEOHSHUIRUPDQFHGHJUDGDWLRQ
WKH\PLJKWSURYRNHDUHSHUIRUPHGRQWKHFOLHQW%\WKLVDEDFNXSLVSURGXFHGEXWWKH
UHSOLFDWLRQPDVWHULVQRWDIIHFWHGZLWKUHVSHFWWRSHUIRUPDQFHLVVXHV1RWHKRZHYHUWKDWWKH
FOLHQWLVRXWRIV\QFZLWKWKHPDVWHUWKURXJKRXWWKHEDFNXSDQGGHSHQGLQJRQWKHZD\WKH
EDFNXSLVSURGXFHGORFNLQJLVVXHVPLJKWRFFXUDVZHOO7KLVLVWKHUHDVRQZK\WKLVVFHQDULR
LVQRWLQWHQGHGIRUXVHZLWKFOLHQWVWKDWDUHDFWLYHO\DFFHVVHGE\DSSOLFDWLRQVIRUH[DPSOH
IRUORDGEDODQFLQJUHDVRQV<RXDUHDOVRQRWVDIHZKHQFUHDWLQJWKHEDFNXSRQDVODYHWKDW
LVXVHGDVDKRWVWDQGE\IRUDIDLORYHUVFHQDULRDQGZKLFKLVQRWDFWLYHO\DFFHVVHGE\DQ\
DSSOLFDWLRQLIWKHPDVWHUFUDVKHVZKLOHWKHEDFNXSLVUXQQLQJRQWKHVODYHWKHV\VWHPLVQRW
UHDG\IRUIDLORYHU7KHEDFNXSKDGWRGLVDEOHUHSOLFDWLRQÀUVWVR\RXUKRWVWDQGE\VODYHKDVD
GDWDVHWGLIIHUHQWIURPWKHPDVWHU2QO\LIWKHUHSOLFDWLRQLVDFWLYDWHGDJDLQDQGWKHEDFNORJ
LVSURFHVVHGFDQDIDLORYHUVDIHO\WDNHSODFH:KHWKHUWKLVLVDFFHSWDEOHKDVWREHGHFLGHG
LQGLYLGXDOO\EXWWRFRPSOHWHO\VHSDUDWH\RXUDSSOLFDWLRQIURPWKHEDFNXS\RXVKRXOGFRQVLGHU
HVWDEOLVKLQJDVODYHGHGLFDWHGWREDFNXSRQO\
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
f
&RS\LQJDOOGDWDÀOHVWRDEDFNXSORFDWLRQ
f
&UHDWLQJD64/GXPSRIDOOGDWDEDVHV
f
&UHDWLQJD64/GXPSRIVSHFLÀFGDWDEDVHV
f
&UHDWLQJD64/GXPSRIVSHFLÀFWDEOHV

&KDSWHU

5HVWRULQJGDWDIURPDGXPSWRDSUHYLRXVO\
EDFNHGXSVWDWH
,QWKHSUHYLRXVUHFLSHVZHGHDOWZLWKFUHDWLQJDEDFNXSRIWKHH[LVWLQJGDWDDQGFRQÀJXUDWLRQ
7KHVROHUHDVRQIRUWKLVLVWREHDEOHWRUHVWRUHWKHGDWDDJDLQLIUHTXLUHG7KLVUHFLSHZLOOVKRZ
\RXKRZWRUHVWRUHWKHGDWDFUHDWHGXVLQJDGXPS7KHUHFLSHLVVXLWDEOHERWKIRUIXOOGXPSV
DQGIRUGXPSVWKDWFRQWDLQRQO\WKHGDWDRIVSHFLÀFGDWDEDVHV
*HWWLQJUHDG\
7RIROORZWKHVWHSVLQWKLVUHFLSH\RXZLOOQHHGDUXQQLQJ0\64/LQVWDQFHDQGD0\64/XVHU
DFFRXQWWKDWKDVWKHSULYLOHJHVQHFHVVDU\WRUHVWRUHDOOGDWD,QDGHIDXOW0\64/FRQÀJXUDWLRQ
WKHURRWXVHUFDQEHXVHGEXWWKURXJKRXWWKLVUHFLSHZHXVHWKHadmin4mysqlDFFRXQWZLWK
SDVVZRUGAs,ysp4MVHH'HÀQLQJDVSHFLÀFXVHUIRUDGPLQLVWUDWLYHWDVNVLQ&KDSWHU7KH
0\64/LQVWDOODWLRQVKRXOGKDYHVXIÀFLHQWVSDFHDYDLODEOHWRVWRUHWKHGDWDIURPWKHGXPS
DQGQRDSSOLFDWLRQFRQQHFWLRQVVKRXOGEHDFWLYHWKURXJKRXWWKHUHVWRUH$QGRIFRXUVH\RX
QHHGWKHGXPSWRUHVWRUHWKHGDWDIURP,QWKLVUHFLSHZHDVVXPHWKHGXPSLVVWRUHGLQ
D:\MySQLBackup\MySQLDumpAllDatabases.sql
+RZWRGRLW

&RQQHFWWKHmysqlFRPPDQGOLQHFOLHQWWR\RXU0\64/LQVWDQFHXVLQJWKH
admin4mysqlDFFRXQW
C:\>mysql -u admin4mysql -p"As,ysp4M"

5HVWRUHWKHGDWDIURPWKHGXPSE\H[HFXWLQJWKHIROORZLQJ64/FRPPDQG
mysql>source  D:\MySQLBackup\MySQLDumpAllDatabases.sql
+RZLWZRUNV
$JDLQWKLVLVDSUHWW\VWUDLJKWIRUZDUGUHFLSHFRQQHFWWRWKHGDWDEDVHVWHSDQGUHVWRUHWKH
GDWDIURPWKHGXPSVWHS
7KHXVHRIWKHmysqlFRPPDQGOLQHFOLHQWLVQRWDEVROXWHO\QHFHVVDU\EXWSOHDVHQRWHWKDW
\RXZLOOQRWEHDEOHWRLVVXHWKHsourceFRPPDQGIURPDQ\RWKHU64/FOLHQW7KLVLVEHFDXVH
LWLVQRWDUHJXODU64/VWDWHPHQWEXWDNH\ZRUGUHFRJQL]HGE\WKHmysqlFRPPDQGOLQH
FOLHQWLWVHOI<RXFRXOGRIFRXUVHXVHDQRWKHU64/FOLHQWWRUHDGLQWKHZKROHGXPSÀOHDQG
H[HFXWHLWVFRPPDQGVVHTXHQWLDOO\IRUH[DPSOHXVLQJWKH2SHQ6FULSWPHQXHQWU\RI
0\64/4XHU\%URZVHUEXWWKHsourceFRPPDQGLVVSHFLÀFWRmysql

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

,IWKHGXPS\RXZDQWWRUHVWRUHFRQWDLQVRQO\VSHFLÀFWDEOHVDVGHVFULEHGLQ&UHDWLQJD64/
GXPSRIVSHFLÀFWDEOHVXVHWKHIROORZLQJVWDWHPHQWWRVHOHFWWKHWDUJHWGDWDEDVHWRUHVWRUH
WKHWDEOHVLQWR
mysql>use employees;
<RXQHHGWRGRVREHFDXVHRWKHUZLVHWKHWDEOHVJHWLQVHUWHGWRWKHFXUUHQWGHIDXOWGDWDEDVH
WKHGXPSLWVHOIFRQWDLQVQRLQIRUPDWLRQDERXWWKHGDWDEDVHWKHGXPSVWHPVIURP
3OHDVHQRWHWKDWDIWHUSHUIRUPLQJWKHDERYHVWHSVWKHFRQWHQWRI\RXUGDWDEDVHLVQRW
QHFHVVDULO\DEVROXWHO\LGHQWLFDOWRWKHVWDWHRIWKHGDWDEDVHWKHEDFNXSZDVFUHDWHGIURP
$OOGDWDEDVHVWKDWZHUHDOUHDG\SUHVHQWEHIRUHWKHGXPSDUHUHVWRUHGEXWDQ\WKDWDUHQRW
FRYHUHGE\WKHFRQWHQWRIWKHGXPSDUHOHIWXQFKDQJHG,I\RXUGXPSIRUH[DPSOHFRQWDLQV
GDWDIRUWKHfooGDWDEDVHRQO\DQGWKHGDWDEDVH\RXUHDGWKHGXPSLQWRKDVDGDWDEDVHbar
ZKLFKZDVIRUH[DPSOHFUHDWHGDIWHUWKHGXPSZDVSURGXFHGWKHGDWDEDVHbarZLOOEHOHIW
XQFKDQJHG7REHVXUH\RXUHFRYHUWRDQLGHQWLFDOVWDWH\RXKDYHWR
 3HUIRUPDIXOOEDFNXSXVLQJWKH--all-databasesRSWLRQRImysqldump
 0DNHVXUHWKDWWKHWDUJHWGDWDEDVHLVFRPSOHWHO\HPSW\ZKHQUHVWRULQJ
7KHUH
VPRUH«
,QWKHIROORZLQJVHFWLRQVZHZLOOGLVFXVVVRPHDGYDQFHGDVSHFWVRIUHVWRULQJGDWDVXFKDV
ZRUNLQJZLWKFRPSUHVVHGGXPSVDQGDYRLGLQJW\SLFDOSHUIRUPDQFHSUREOHPV
5HVWRULQJFRPSUHVVHGGXPSV
:KHQUHVWRULQJDGDWDEDVHIURPDFRPSUHVVHGGXPSIRUH[DPSOHDVFUHDWHGDFFRUGLQJ
WRWKH&RPSUHVVLQJ64/GXPSVRQWKHÁ\UHFLSHWKHGXPSQHHGVWREHGHFRPSUHVVHG
EHIRUHUHVWRULQJLWWRWKHGDWDEDVH<RXFRXOGHLWKHUGHFRPSUHVVWKHÀOHRQWKHGLVNDQG
VXEVHTXHQWO\XVHWKHSUHFHGLQJUHFLSHZLWKRXWDQ\FKDQJHVRUGHFRPSUHVVRQWKHÁ\DQG
UHVWRUHWKHGDWDLQRQHVWHS
C:\> gzip --decompress --stdout D:\MysqlBackup\DumpAllDBs.sql.gz | mysql 
-u admin4mysql -p"As,ysp4M"
dŚĞ--decompressRSWLRQWHOOVJ]LSWRUHYHUWWKHFRPSUHVVLRQREYLRXVO\ZKLOH--stdout
PDNHVVXUHWKDWWKHFRPSUHVVHGÀOHLWVHOILVOHIWXQFKDQJHGEXWWKHGHFRPSUHVVHGGDWD
LVZULWWHQWRWKHstdoutGHYLFH7KHSLSHV\PERO_UHGLUHFWVWKHRXWSXWIURPstdoutWR
WKHmysqlFRPPDQGZKLFKWKHQUHFHLYHVWKHGHFRPSUHVVHGFRQWHQWRIWKHGXPSÀOHDQG
H[HFXWHVWKHVWDWHPHQWVFRQWDLQHGWKHUHLQ͘
,I\RXXVHGDGLIIHUHQWFRPSUHVVLRQWRROOLNHE]LSŽƌ]LSZKHQ
FUHDWLQJWKHGXPS\RXKDYHWRDGDSWWKHDERYHFRPPDQG
DFFRUGLQJO\WRXVHWKHUHVSHFWLYHWRROKHUHDVZHOO

&KDSWHU

7HPSRUDULO\GLVDEOLQJELQORJVWRVDYHWLPHDQGVSDFH
,IELQORJJLQJLVHQDEOHGRQWKH0\64/LQVWDQFH\RXUHVWRUHDOOVWDWHPHQWVIURPWKHGXPS
DUHQRWRQO\H[HFXWHGDJDLQVW\RXUGDWDEDVHEXWDOVRZULWWHQWRWKHbinlogs7KLVKDVWKH
DGYDQWDJHWKDWUHSOLFDWLRQVODYHVSHUIRUPWKHUHVWRUHDVZHOOEXWVRPHWLPHVWKLVLVQRW
QHFHVVDU\RUZDQWHG)RUH[DPSOHLI\RXZDQWWRNHHSWKHFOLHQWVXQFKDQJHGIRUUHIHUHQFH
LQFDVHWKHUHVWRUHIDLOVRULI\RXGRQRWXVHELQORJJLQJIRUUHSOLFDWLRQEXWRQO\IRUEHWWHU
UHVWRUHRSWLRQV\RXPLJKWZDQWWRWHPSRUDULO\GLVDEOHELQORJJLQJZKHQSURFHVVLQJWKHGXPS
7KLVPLJKWVDYH\RXDVLJQLÀFDQWDPRXQWRIGLVNVSDFHGHSHQGLQJRQWKHVL]HRIWKHGXPS
DQGLVDOVREHWWHUIRUSHUIRUPDQFHEHFDXVHWKHZULWHDFFHVVWRWKHbinlogsLVRPLWWHG7R
WHPSRUDULO\GLVDEOHELQORJJLQJ\RXKDYHWRSUHSHQGWKHIROORZLQJFRPPDQGLQVWHS
mysql> SET sql_log_bin=0;
mysql> source D:\...
7KLVFRPPDQGGLVDEOHVELQORJJLQJIRUWKHFXUUHQWFRQQHFWLRQRQO\6RDVVRRQDVWKH
FRQQHFWLRQLVWHUPLQDWHGWKHbinlogsZLOODJDLQFRQWDLQDOOFKDQJHVPDGHWR\RXUGDWDEDVH
3OHDVHQRWHWKDWIRUWKLVVWDWHPHQW\RXUXVHUZLOOUHTXLUHSUPERSULYLOHJHV7KLVSULYLOHJHLVQRW
XVXDOO\UHTXLUHGWRSHUIRUPDUHVWRUHEXWDVUHVWRULQJGDWDLVW\SLFDOO\DWDVNIRUWKHGDWDEDVH
DGPLQLVWUDWRULWLVVDIHWRDVVXPHWKDWDQDFFRXQWZLWKWKLVSULYLOHJHLVDYDLODEOHWRWKHSHUVRQ
LQFKDUJH
,QFUHDVLQJUHFRYHU\SHUIRUPDQFHE\XVLQJSDUDOOHOUHVWRUH
$VSDUDOOHOL]DWLRQLVDQDSSURDFKWRLQFUHDVHEDFNXSVSHHGLWFDQEHXVHGIRUEHWWHU
SHUIRUPDQFHIRUUHVWRUDWLRQDVZHOO:LWKPXOWLSOHFRQFXUUHQWUHVWRUHSURFHVVHV\RXUGDWD
PLJKWEHUHLQVWDOOHGIDVWHU+RZHYHUZKHWKHUWKLVLVVXFFHVVIXORUQRWDJDLQGHSHQGVRQWKH
UHVRXUFHVDYDLODEOH,IWKHVSHHGRI\RXUUHVWRUHLVOLPLWHGPDLQO\E\WKHGULYHWKURXJKSXWWKH
EHQHÀWZLOOEHEDVLFDOO\QRQH[LVWHQW,I\RXKDYHIDVWRUPXOWLSOHGLVNVKRZHYHU\RXPLJKW
VHHPDMRUDGYDQWDJHV&RQFXUUHQWO\UHVWRULQJHDFKGDWDEDVHVHSDUDWHO\FRXOGWKHQEHWKH
ZD\WRPD[LPL]HSHUIRUPDQFH
)RU/LQX[VHUYHUVmk-parallel-restoreIURP0DDWNLWLVDYDLODEOHZKLFKVXSSRUWV
UHVWRULQJGDWDLQSDUDOOHOVHHhttp://www.maatkit.org/doc/mk-parallel-restore.
html+RZHYHUD:LQGRZVYHUVLRQLVQRWDYDLODEOH
5HVWRULQJWDEOHVH[FOXGLQJSRWHQWLDOO\YHU\ODUJHWDEOHV
:KHQGHDOLQJZLWKODUJHGDWDVHWV\RXVRPHWLPHVHQFRXQWHUSHUIRUPDQFHSUREOHPVWKDW
UHTXLUHPDQXDOLQWHUYHQWLRQ2QHUHDOZRUOGH[DPSOHRISHUIRUPDQFHSUREOHPVLVDUHVWRUH
RIPDVVLYHWDEOHVZKLFKPLJKWFDXVHVHYHUHSHUIRUPDQFHGHJUDGDWLRQV

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

,PDJLQHDWDEOHZLWKKDOIDELOOLRQUHFRUGVIRUH[DPSOHFRQWDLQLQJORJGDWD:KLOHUHVWRULQJ
VXFKDWDEOH\RXZLOOQRWLFHDGUDPDWLFGHFUHDVHRILQVHUWSHUIRUPDQFHWKURXJKRXWWKH
SURFHVV7KHÀUVWIHZSHUFHQWRIWKHGDWDZLOOEHZULWWHQWRWKHWDEOHUDWKHUTXLFNO\%XWDV
WKHUHVWRUHFRQWLQXHVWKHZULWHUDWHZLOOJUDGXDOO\GHFUHDVHPRVWO\GXHWRLQWHUQDOLQGH[
PDLQWHQDQFH
,QWKHFDVHRIDGLVDVWHUUHFRYHU\\RXKDYHWKHFKRLFHEHWZHHQUHVWRULQJDOOGDWDEXWDW
WKHSULFHRIH[WHQGHGGRZQWLPHXQWLOWKHODUJHWDEOHVDUHUHVWRUHGFRPSOHWHO\DVZHOODQGD
SDUWLDOUHVWRUHGHOLEHUDWHO\VNLSSLQJWKHUHVWRUHRIWKHGDWDIURPWKHODUJHWDEOHEXWZLWKWKH
DGYDQWDJHRIDIDVWHUUHVWRUH7KHGHFLVLRQKDVWREHPDGHRQDQDSSOLFDWLRQOHYHOEXWZLWK
WKHH[DPSOHRIORJGDWDLWLVRIWHQIHDVLEOHWRVLPSO\H[FOXGHWKHORJGDWDIURPWKHUHVWRUHIRU
WKHVDNHRIDIDVWHUUHFRYHU\
/HWXVDVVXPHZHKDYHDYHU\ODUJHGXPSÀOHWKDWFRQWDLQVWKHGDWD\RXDFWXDOO\ZDQW
WRUHFRYHUD:\MySQLBackup\MySQLDump.sqlDORQJZLWKDYHU\ODUJHWDEOHKHUH
op_detail7REHDEOHWRFRSHZLWKWKHGDWDFRQWDLQHGLQWKLVSRWHQWLDOO\PDPPRWKÀOH
\RXZLOOQHHGDFFHVVWRWKHgrepFRPPDQGIRU:LQGRZVXVHUVVHHhttp://unxutils.
sourceforge.netIRUDQLPSOHPHQWDWLRQRIWKHFRPPRQ*18WRROV
7KHIROORZLQJFRPPDQGZLOOUHVWRUHWKHGDWDIURPWKHGXPSH[FOXGLQJWKHGDWDIURPWKH
op_detailWDEOH
C:\>grep --invert-match "^INSERT INTO .op_detail. VALUES .*"
D:\MySQLBackup\MySQLDump.sql | mysql -u admin4mysql -p"As,ysp4M"
7KLVFRPPDQGXVHVgrepWRÀOWHUDOOOLQHVLQFOXGLQJDQINSERT INTO 'op_detail'DW
WKHVWDUWRIWKHOLQHOHDYLQJDOORWKHUOLQHVXQWRXFKHG$OORWKHUOLQHVDUHSLSHGWRWKHmysql
FRPPDQGOLQHFOLHQWWKDWLPSRUWVWKHUHPDLQLQJGXPS͘
3OHDVHQRWHWKDWLIGDWDKDVUHIHUHQFHVWRHQWULHVLQWKHH[FOXGHGWDEOHWKHLPSRUWRIWKH
GXPSZLOOQRWIDLO,QWKLVFDVH\RXZRXOGHQGXSZLWKGDWDLQFRQVLVWHQFLHVWKDWPLJKWFDXVH
HUURUVPXFKODWHUVRPDNHVXUHWRH[FOXGHRQO\WDEOHVWKDWDUHQRWUHIHUHQFHGE\IRUHLJQNH\V
2WKHUZLVH\RXKDYHWRVHDUFKIRUSRVVLEOHIRUHLJQNH\FRQVWUDLQWYLRODWLRQVPDQXDOO\6RPH
LGHDVRQKRZWRDFKLHYHWKLVDUHSUHVHQWHGIRUH[DPSOHDWhttp://dev.mysql.com/doc/
refman/5.1/en/innodb-foreign-key-constraints.html
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUDGPLQLVWUDWLYHWDVNV
f
&UHDWLQJD64/GXPSRIDOOGDWDEDVHV
f
&UHDWLQJD64/GXPSRIVSHFLÀFGDWDEDVHV

&KDSWHU

3HUIRUPLQJDSRLQWLQWLPHUHFRYHU\XVLQJ
WKHELQDU\ORJV
7KHSUHYLRXVUHFLSHVGHDOWZLWKKRZWRUHFRYHUGDWDIURPDEDFNXS$IWHUUHFRYHU\WKHGDWD
VKRXOGEHLQWKHVDPHFRQGLWLRQDVLWZDVZKHQWKHEDFNXSZDVFUHDWHG8QIRUWXQDWHO\WKH
GDWDWKDWZDVFKDQJHGDIWHUEDFNXSFUHDWLRQLVQRWUHVWRUHG
7RUHVWRUHWKHGDWDWRWKHSRLQWLQWLPHEHIRUHWKHUHFRYHU\\RXFDQXVHWKHbinlogÀOHVWKDW
ZHUHFUHDWHGEHWZHHQEDFNXSDQGUHFRYHU\$VPHQWLRQHGLQWKH5RWDWLQJDQGSXUJHELQDU\
ORJVUHFLSHZHVXJJHVWHQDEOLQJELQDU\ORJJLQJHYHQLI\RXGRQRWKDYHDUHSOLFDWLRQVFHQDULR
DVWKLVJLYHV\RXH[WHQGHGRSWLRQVLQEDFNXS
,QWKLVUHFLSHZHZLOOGLVFXVVKRZWRXVHWKHELQDU\ORJVWRUHVWRUHGDWDXSWRWKHODWHVW
SRVVLEOHSRLQWLQWLPHEHIRUHWKHGDWDZDVORVW
*HWWLQJUHDG\
7REHDEOHWRUHVWRUHWKHUHPDLQLQJGDWDXVLQJWKHELQDU\ORJJLQJLQIRUPDWLRQZHGHÀQLWHO\
QHHGWKHELQDU\ORJÀOHV,IDOOGDWDIURP\RXUVHUYHULVORVWIRUH[DPSOHLQFDVHRIDÀUHWKH
binlogsDUHKRSHIXOO\DYDLODEOHIURPDWDSHRUDQ\RWKHUPHGLDWKDWLVQRWDIIHFWHGE\WKH
GDWDORVV,IRQO\\RXUGDWDEDVHGDWDLVFRUUXSW\RXRIWHQKDYHWKHELQDU\ORJVVWLOOSUHVHQWRQ
\RXUVHUYHU
VGLVN
,IWKHELQDU\ORJVDUHVWLOOSUHVHQW\RXVKRXOGFRS\WKHELQDU\ORJÀOHVWRDGLIIHUHQWSRVLWLRQ
EHIRUH\RXVWDUWUHFRYHULQJIURPDGXPS7KLVZD\\RXKDYHDOOELQDU\ORJÀOHVDYDLODEOHLQ
H[DFWO\WKHVWDWHIURPWKHSRLQWLQWLPHEHIRUHWKHUHFRYHU\
:HDVVXPHWKHELQDU\ORJVHLWKHUDVDFRS\RIWKHbinlogÀOHVIURP\RXUVHUYHUGLVNRUDV
UHFRYHUHGIURPEDFNXSPHGLDWREHVWRUHGXQGHUC:\tmp\binlogs\
7RUHDGWKHFKDQJHVVWRUHGLQWKHELQDU\ORJVLQWRWKHGDWDEDVH\RXQHHGDQDSSURSULDWH
0\64/XVHUDJDLQKHUHadmin4mysqlZLWKSDVVZRUGAs,ysp4M
$QGPRVWLPSRUWDQWO\\RXQHHGWKHSRVLWLRQDWZKLFKUHFRYHU\IURPWKHELQDU\ORJÀOHV
VKRXOGVWDUW7KHGXPS\RXUGDWDEDVHZDVUHVWRUHGIURPVKRXOGKDYHEHHQFUHDWHGXVLQJ
WKH--master-dataRSWLRQVHHWKH7KHUH
VPRUH«VHFWLRQRIWKH&UHDWLQJDQ64/GXPSRI
DOOGDWDEDVHVUHFLSHRWKHUZLVHWKLVLQIRUPDWLRQLVQRWHDVLO\DYDLODEOH<RXFRXOGWKHQWU\WR
PDQXDOO\LGHQWLI\WKHFRUUHFWVWDUWLQJSRVLWLRQIRUH[DPSOHE\FKHFNLQJWKHWLPHVWDPSVIRUÀOH
FUHDWLRQRUODVWFKDQJHRULQVSHFWLQJWKHÀOHVXVLQJWKHmysqlbinlogWRRO%XWLI\RXSODQ
RQXVLQJWKHELQDU\ORJVIRUUHFRYHU\\RXVKRXOGGHÀQLWHO\XVHWKH--master-dataRSWLRQWR
FUHDWHDGXPS

%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD

)LQGRXWDERXWWKHORJSRVLWLRQE\XVLQJWKHmoreFRPPDQGWRGLVSOD\WKHÀUVWIHZOLQHVRIWKH
GXPS/RRNIRUDOLQHOLNHWKHIROORZLQJ
CHANGE MASTER TO MASTER_LOG_FILE='myhost.000005', MASTER_LOG_POS=201;
,QWKLVOLQHQRWHWKHYDOXHVQRWHGDIWHUMASTER_LOG_FILEDQGMASTER_LOG_POSIRUIXWXUH
UHIHUHQFH:HIXUWKHUPRUHDVVXPHWKDW\RXKDYHELQDU\ORJÀOHVWKURXJKmyhost.000008
DYDLODEOHIRUUHFRYHU\7KURXJKRXWWKHIROORZLQJUHFLSHZHZLOOXVHWKHDERYHQRWHGYDOXHV
<RXKDYHWRUHSODFHWKHPZLWK\RXUUHVSHFWLYHYDOXHVDFFRUGLQJO\
+RZWRGRLW

5HFRYHUWKHGDWDIURPWKHGXPSDFFRUGLQJWRWKHSUHYLRXVUHFLSHV

([HFXWHWKHIROORZLQJFRPPDQGIURPWKHFRPPDQGOLQHLQWKHFRQWH[WRIGLUHFWRU\
C:\tmp\binlogs\FKDQJHGLUHFWRU\DFFRUGLQJO\
C:\>mysqlbinlog --start-position=201 myhost.000005 myhost.000006 
myhost.000007 myhost.000008 | mysql -u admin4mysql -p"As,ysp4M"
+RZLWZRUNV
7KHFRPPDQGH[HFXWHGLQVWHSUHDGVWKHJLYHQELQDU\ORJVWUDQVODWHVWKHFKDQJHV
VWRUHGWKHUHLQLQWR64/FRPPDQGVDQGSDVVHVWKHVHWRWKH0\64/GDWDEDVH7KH
--start-positionRSWLRQWHOOVmysqlbinlogWREHJLQUHDGLQJWKHÀUVWJLYHQÀOHKHUH
myhost.000005DWSRVLWLRQ201ZKLFKVWDUWVWKHUHFRYHU\SURFHVVDWH[DFWO\WKHSRLQW
ZKHUHWKHGXPSZDVFUHDWHG$IWHUWKLVWKHQH[WÀOHV000006WKURXJK000008DUHUHDG
FRPSOHWHO\LQWRWKHGDWDEDVH
7KHUH
VPRUH«
7KHIROORZLQJVHFWLRQVDGGUHVVSDUWLDOUHVWRUHVE\LQWURGXFLQJPHDQVWRH[WHQGWKHUHFLSH
HLWKHUWRUHVWRUHVSHFLÀFGDWDEDVHVRUWRUHVWRUHGDWDRQO\XSWRDFHUWDLQSRLQWLQWLPH
5HVWRULQJRQO\DVSHFLÀFGDWDEDVH
,I\RXKDYHWRUHFRYHURQO\WKHGDWDRIDVSHFLÀFGDWDEDVHEXWZDQWWROHDYHDOORWKHU
GDWDEDVHVXQFKDQJHG\RXPXVWQRWLPSRUWWKHIXOOFRQWHQWRIWKHELQDU\ORJÀOHVEHFDXVH
WKHVHPLJKWFRQWDLQFKDQJHVRIRWKHUGDWDEDVHVDVZHOO,QWKLVFDVHDGGWKHRSWLRQ
--database=dbnameWRmysqlbinlog͘7KLVUHVWULFWVWKH64/VWDWHPHQWVSDVVHGWRWKH
0\64/LQVWDQFHWRWKHJLYHQGDWDEDVH

&KDSWHU

'HWHUPLQLQJWKHH[DFWORFDWLRQRIDIDLOXUHDQGUHVWRULQJXSWR
WKDWSRLQW
<RXVRPHWLPHVKDYHWKHSUREOHPZKHUHGDWDORVVLVQRWQHFHVVDULO\FDXVHGE\DVHUYHUHUURU
EXWE\PDOLFLRXV64/VWDWHPHQWV,IIRUH[DPSOHDQDFFLGHQWDODROPVWDWHPHQWGHOHWHGDOO
RI\RXUGDWDWKHQ\RXZLOOKDYHWRUHFRYHU\RXUGDWDEDVHDVZHOO,QWKLVVLWXDWLRQFRPSOHWHO\
UHSURFHVVLQJWKHELQDU\ORJVLVDEDGLGHDEHFDXVHWKLVZRXOGDOVRH[HFXWHWKHDROP
VWDWHPHQWDJDLQOHDYLQJ\RXZLWKDEURNHQGDWDEDVHDJDLQ,QWKHVHFDVHV\RXZLOOKDYH
WRPDQXDOO\LQVSHFWWKHELQDU\ORJVWRÀQGRXWDERXWWKHVSHFLÀFVWDWHPHQWVWKDWFDXVHG
WKHSUREOHP
7RLQVSHFWWKHELQDU\ORJÀOHV\RXFDQFUHDWHD64/ÀOHIURPWKHPZLWKDVLPSOH
mysqlbinlog myhost.00000x > binlog.sqlFRPPDQG<RXFDQWKHQRSHQWKH
UHVXOWLQJbinlog.sqlÀOHLQDQHGLWRUDQGVFDQWKURXJKWKHFRPPDQGV,I\RXUELQDU\ORJ
ÀOHVDUHWRRODUJHWREHRSHQHGZLWKDQHGLWRU\RXFRXOGPDNHXVHRIWKHsplitWRRO
FRQVLGHUXVLQJWKH--line-bytesRSWLRQVHHhttp://unxutils.sourceforge.net 
IRUD:LQGRZVLPSOHPHQWDWLRQWREUHDNWKHVHÀOHVLQWRVPDOOHUFKXQNV
$VVRRQDV\RXKDYHIRXQGWKHÀUVWFRPPDQGWKDW\RXGRQRWZDQWWRLQFOXGHLQWKH
UHFRYHU\SURFHVVDQ\PRUHQRWHWKHQXPEHURIWKHOLQHEHIRUHLWIRUH[DPSOH# at 1174
7KLVGHQRWHVWKHHQGSRVLWLRQDWZKLFKSURFHVVLQJVKRXOGVWRS7RH[FOXGHDQ\FRPPDQG
KHQFHIRUWKIURPWKHELQDU\ORJUHFRYHU\DGGD--stop-position=1174RSWLRQWRWKH
mysqlbinlogFRPPDQG7KLVZLOODSSO\WRWKHODVWJLYHQÀOHLQWKHDERYHH[DPSOH
myhost.000008DQGVXSSUHVVHVSURFHVVLQJRIDOOFRPPDQGVIROORZLQJWKHJLYHQELQDU\ORJ
SRVLWLRQ7KLVVKRXOGSUHYHQWUHSHDWLQJWKHVDPHHUURUVDJDLQZKLFKOHDGWRWKHSUREOHPVLQ
WKHÀUVWSODFH
6HHDOVR
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS



0DQDJLQJ'DWD
7KLVFKDSWHUSUHVHQWVVRPHSURYHQDSSURDFKHVWRPDQDJLQJ\RXUGDWDEH\RQGWKHEDVLF64/
RSHUDWLRQVOLNHINSERTRUDELETEZKLFKZHDVVXPHWKHUHDGHUWREHIDPLOLDUZLWK7KHÀUVW
IHZUHFLSHVZLOOGLVFXVVZD\VRIH[SRUWLQJGDWDIURPDQGLPSRUWLQJGDWDLQWRWKHGDWDEDVH
XVLQJGLIIHUHQWÀOHIRUPDWV7KLVFRYHUVWKHIROORZLQJWRSLFV
f
([SRUWLQJGDWDWRDVLPSOH&69ÀOH
f
([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW
f
8VLQJVWRUHGSURFHGXUHVWRH[SRUWUHSHDWHGO\
f
,PSRUWLQJGDWDIURPDVLPSOH&69ÀOH
f
,PSRUWLQJGDWDIURPFXVWRPÀOHIRUPDWV
f
,QVHUWLQJQHZGDWDDQGXSGDWLQJGDWDLILWDOUHDG\H[LVWV
f
,QVHUWLQJGDWDEDVHGRQH[LVWLQJGDWDEDVHFRQWHQW
f
'HOHWLQJDOOGDWDIURPODUJHWDEOHV
f
'HOHWLQJDOOEXWDIUDJPHQWRIDODUJHWDEOH
VGDWD
f
'HOHWLQJGDWDLQFUHPHQWDOO\IURPODUJHWDEOHV
,QWURGXFWLRQ
7KHEDVLFVHWRI64/GDWDPDQLSXODWLRQFRPPDQGVSELECTINSERTUPDATEDQGDELETE
LVDZHOOXQGHUVWRRGPHDQVWRKDQGOHWKHGDWDVWRUHGLQ\RXUGDWDEDVHDQGLWVFRQFHSWVDQG
EDVLFXVDJHDUHQRWGLIÀFXOWWROHDUQ7KHUHDUHVLWXDWLRQVKRZHYHUWKDWUHTXLUHPRUHGHWDLOHG
NQRZOHGJHDERXWWKHVHFRPPDQGV
VXEWOHWLHV7KLVKROGVHVSHFLDOO\WUXHZKHQODUJHDPRXQW
RIGDWDQHHGWREHWDNHQFDUHRI³\RXKDYHWRNQRZZKDW\RXDUHGRLQJRWKHUZLVH\RXPLJKW
UXQLQWRVHULRXVSHUIRUPDQFHSUREOHPV

0DQDJLQJ'DWD

$OVRWKHWDVNRIH[SRUWLQJVSHFLÀFDOO\IRUPDWWHGGDWDIURPRULPSRUWLQJH[WHUQDOGDWDLQWR\RXU
GDWDEDVHLVDFRPPRQFKDOOHQJHWKDWFDQEHTXLWHWULFN\WRDGGUHVV
:HDUHJRLQJWRDGGUHVVWKHVHLVVXHVLQWKHIROORZLQJUHFLSHVDQGZHZLOODOVRLQWURGXFH
ZD\VRIPDQLSXODWLQJGDWDLQWKHGDWDEDVHZKLOHWDNLQJWKHSUHVHQWFRQWHQWVRIWKHGDWDEDVH
LQWRDFFRXQW
:HZLOOVKRZVROXWLRQVWRUHDOZRUOGFKDOOHQJHVZKHQFRQIURQWHGZLWKGDWDPDQLSXODWLRQ
WDVNV,WDFWXDOO\WRRNXVDZKLOHWRÀJXUHRXWKRZWRWDFNOHWKHVHUHDOZRUOGSUREOHPVWKH
PRVWHIÀFLHQWZD\ZKHQÀUVWIDFHGZLWKWKHP%HFDXVHWKHVHVWUDWHJLHVDUHQRWWRRREYLRXV
DFROOHFWLRQRIWHVWHGPHWKRGVIRUWKHVHWRSLFVPLJKWEHXVHIXO
([SRUWLQJGDWDWRDVLPSOH&69ÀOH
:KLOHGDWDEDVHVDUHDJUHDWWRROWRVWRUHDQGPDQDJH\RXUGDWD\RXVRPHWLPHVQHHG
WRH[WUDFWVRPHRIWKHGDWDIURP\RXUGDWDEDVHWRXVHLWLQDQRWKHUWRRODVSUHDGVKHHW
DSSOLFDWLRQEHLQJWKHPRVWSURPLQHQWH[DPSOHIRUWKLV,QWKLVUHFLSHZHZLOOVKRZ\RXKRZ
WRXWLOL]HWKHUHVSHFWLYH0\64/FRPPDQGVIRUH[SRUWLQJGDWDIURPDJLYHQWDEOHLQWRDÀOHWKDW
FDQHDVLO\EHLPSRUWHGE\RWKHUSURJUDPV
*HWWLQJUHDG\
7RVWHSWKURXJKWKLVUHFLSH\RXZLOOQHHGDUXQQLQJ0\64/GDWDEDVHVHUYHUDQGDZRUNLQJ
LQVWDOODWLRQRID64/FOLHQWOLNH0\64/4XHU\%URZVHURUWKHmysqlFRPPDQGOLQHWRRO<RX
ZLOODOVRQHHGWRLGHQWLI\DVXLWDEOHH[SRUWWDUJHWZKLFKKDVWRPHHWWKHIROORZLQJUHTXLUHPHQWV
f
7KH0\64/VHUYHUSURFHVVPXVWKDYHZULWHDFFHVVWRWKHWDUJHWÀOH
f
7KHWDUJHWÀOHPXVWQRWH[LVW
7KHH[SRUWWDUJHWÀOHLVORFDWHGRQWKHPDFKLQHWKDWUXQV\RXU0\64/
VHUYHUQRWRQWKHFOLHQWVLGH
,I\RXGRQRWKDYHÀOHDFFHVVWRWKH0\64/VHUYHU\RXFRXOGLQVWHDGXVH
H[SRUWIXQFWLRQVRI0\64/FOLHQWVOLNH0\64/4XHU\%URZVHU
,QDGGLWLRQDXVHUZLWKFILESULYLOHJHLVQHHGHGZHZLOOXVHDQDFFRXQWQDPHG
sample_installIRUWKHIROORZLQJVWHSVVHHDOVR&KDSWHU&UHDWLQJDQLQVWDOODWLRQXVHU

&KDSWHU

)LQDOO\ZHQHHGVRPHGDWDWRH[SRUW7KURXJKRXWWKLVUHFLSHZHZLOODVVXPHWKDWWKHGDWDWR
H[SRUWLVVWRUHGLQDWDEOHQDPHGtable1LQVLGHWKHGDWDEDVHsample$VH[SRUWWDUJHWZH
ZLOOXVHWKHÀOHC:/target.csv 0\64/DFFHSWVVODVKHVLQVWHDGRIEDFNVODVKHVLQ:LQGRZV
SDWKH[SUHVVLRQV7KLVLVDÀOHRQWKHPDFKLQHWKDWUXQVWKH0\64/VHUYHULQVWDQFHVRLQWKLV
H[DPSOH0\64/LVDVVXPHGWREHUXQQLQJRQD:LQGRZVPDFKLQH7RDFFHVVWKHUHVXOWVIURP
WKHFOLHQW\RXKDYHWRKDYHDFFHVVWRWKHÀOHIRUH[DPSOHXVLQJDÀOHVKDUHRUH[HFXWLQJWKH
0\64/FOLHQWRQWKHVDPHPDFKLQHDVWKHVHUYHU
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHXVLQJWKHsample_installDFFRXQW

,VVXHWKHIROORZLQJ64/FRPPDQG
mysql> SELECT * FROM sample.table1 INTO OUTFILE 'C:/target.csv' 
FIELDS ENCLOSED BY '"' TERMINATED BY ';' ESCAPED BY '"' LINES 
TERMINATED BY '\r\n';
3OHDVHQRWHWKDWZKHQXVLQJDEDFNVODVKLQVWHDGRIDVODVKLQWKHWDUJHWÀOH
VSDWK\RXKDYH
WRXVHC:\\target.csvGRXEOHEDFNVODVKIRUHVFDSLQJLQVWHDG
,I\RXGRQRWJLYHDSDWKEXWRQO\DÀOHQDPHWKHWDUJHWÀOHZLOO
EHSODFHGLQWKHGDWDGLUHFWRU\RIWKHFXUUHQWO\VHOHFWHGVFKHPD
RI\RXU0\64/VHUYHU
+RZLWZRUNV
,QWKHSUHYLRXV64/VWDWHPHQWDÀOHC:/target.csvZDVFUHDWHGZKLFKFRQWDLQVWKH
FRQWHQWRIWKHWDEOHsample.table17KHÀOHFRQWDLQVDVHSDUDWHOLQHIRUHDFKURZRI
WKHWDEOHDQGHDFKOLQHLVWHUPLQDWHGE\DVHTXHQFHRIDFDUULDJHUHWXUQDQGDOLQHIHHG
FKDUDFWHU7KLVOLQHHQGLQJZDVGHÀQHGE\WKHLINES TERMINATED BY '\r\n'SRUWLRQ
RIWKHFRPPDQG
(DFKOLQHFRQWDLQVWKHYDOXHVRIHDFKFROXPQRIWKHURZ7KHYDOXHVDUHVHSDUDWHGE\
VHPLFRORQVDVVWDWHGLQWKHTERMINATED BY ';'FODXVH(YHU\YDOXHLVHQFORVHGE\D
GRXEOHTXRWDWLRQPDUN"ZKLFKUHVXOWVIURPWKHFIELDS ENCLOSED BY '"'RSWLRQ
:KHQZULWLQJWKHGDWDWRWKHWDUJHWÀOHQRFKDUDFWHUFRQYHUVLRQWDNHVSODFHWKHGDWD
LVH[SRUWHGXVLQJWKHELQDU\FKDUDFWHUVHW7KLVVKRXOGEHNHSWLQPLQGHVSHFLDOO\ZKHQ
LPSRUWLQJWDEOHVZLWKGLIIHUHQWFKDUDFWHUVHWVIRUVRPHRILWVYDOXHV

0DQDJLQJ'DWD

<RXPLJKWZRQGHUZK\ZHFKRVHWKHVHPLFRORQLQVWHDGRIDFRPPDDVWKH
ÀHOGVHSDUDWRU7KLVLVVLPSO\EHFDXVHRIDJUHDWO\LPSURYHG0LFURVRIW([FHO
FRPSDWLELOLW\\RXFDQVLPSO\RSHQWKHUHVXOWLQJÀOHVZLWKRXWWKHQHHGWR
LPSRUWH[WHUQDOGDWDIURPWKHÀOHV%XW\RXFDQKRZHYHURSHQWKHVHÀOHVLQD
GLIIHUHQWVSUHDGVKHHWSURJUDPOLNH2SHQ2IÀFHRUJ&DOFDVZHOO,I\RXWKLQN
WKHXVDJHRIVHPLFRORQVLVLQFRQWUDGLFWLRQWRWKHQRWLRQRID&69ÀOHWKLQNRI
LWDVD&KDUDFWHU6HSDUDWHG)LOH
7KHXVHRIGRXEOHTXRWHVWRHQFORVHVLQJOHYDOXHVSUHYHQWVSUREOHPVZKHQÀHOGYDOXHV
FRQWDLQVHPLFRORQVRUJHQHUDOO\WKHÀHOGVHSDUDWRUFKDUDFWHU7KHVHDUHQRWUHFRJQL]HGDV
ÀHOGVHSDUDWRUVLIWKH\DUHHQFORVHGLQGRXEOHTXRWHV
7KHUH
VPRUH
:KLOHWKHSUHYLRXVSELECT … INTO OUTFILEVWDWHPHQWZLOOZRUNZHOOLQPRVWFDVHVWKHUH
DUHVRPHFLUFXPVWDQFHVLQZKLFK\RXVWLOOPLJKWHQFRXQWHUSUREOHPV7KHIROORZLQJWRSLFVZLOO
VKRZ\RXKRZWRKDQGOHVRPHRIWKRVH
+DQGOLQJHUURUVLIWKHWDUJHWÀOHDOUHDG\H[LVWV
,I\RXWU\WRH[HFXWHWKHSELECT … INTO OUTFILEVWDWHPHQWWZLFHDQHUURUFile 'C:/
target.csv' already existsRFFXUV7KLVLVGXHWRDVHFXULW\IHDWXUHLQ0\64/WKDW
PDNHVVXUHWKDW\RXFDQQRWRYHUZULWHH[LVWLQJÀOHVXVLQJWKHSELECT … INTO OUTFILE
VWDWHPHQW7KLVPDNHVSHUIHFWVHQVHLI\RXWKLQNDERXWWKHFRQVHTXHQFHV,IWKLVZHUHQRWWKH
FDVH\RXFRXOGRYHUZULWHWKH0\64/GDWDÀOHVXVLQJDVLPSOHSELECTEHFDXVH0\64/VHUYHU
QHHGVZULWHDFFHVVWRLWVGDWDGLUHFWRULHV$VDUHVXOW\RXKDYHWRFKRRVHGLIIHUHQWWDUJHWÀOHV
IRUHDFKH[SRUWRUUHPRYHROGÀOHVLQDGYDQFH
8QIRUWXQDWHO\LWLVQRWSRVVLEOHWRXVHDQRQFRQVWDQWÀOHQDPHOLNHDYDULDEOHLQWKHSELECT 
… INTO OUTFILEH[SRUWVWDWHPHQW,I\RXZLVKWRXVHGLIIHUHQWÀOHQDPHVIRUH[DPSOHZLWK
DWLPHVWDPSDVSDUWRIWKHÀOHQDPH\RXKDYHWRFRQVWUXFWWKHVWDWHPHQWLQVLGHDYDULDEOH
YDOXHEHIRUHH[HFXWLQJLW
mysql> SET @selInOutfileCmd := concat("SELECT * FROM sample.table1 INTO 
OUTFILE 'C:/target-", DATE_FORMAT(now(),'%Y-%m-%d_%H%i%s'), ".csv' FIELDS 
ENCLOSED BY '\"' TERMINATED BY ';' ESCAPED BY '\"' LINES TERMINATED BY 
'\r\n';"); 
mysql> PREPARE statement FROM @selInOutfileCmd;
mysql> EXECUTE statement;
7KHÀUVWSETVWDWHPHQWFRQVWUXFWVDVWULQJZKLFKFRQWDLQVDSELECTVWDWHPHQW:KLOHLWLV
QRWDOORZHGWRXVHYDULDEOHVIRUVWDWHPHQWVGLUHFWO\\RXFDQFRQVWUXFWDVWULQJWKDWFRQWDLQV
DVWDWHPHQWDQGXVHYDULDEOHVIRUWKLV:LWKWKHQH[WWZROLQHV\RXSUHSDUHDVWDWHPHQWIURP
WKHVWULQJDQGH[HFXWHLW

&KDSWHU

+DQGOLQJ18//YDOXHV
:LWKRXWIXUWKHUKDQGOLQJNULLYDOXHVLQWKHGDWD\RXH[SRUWXVLQJWKHSUHYLRXVVWDWHPHQW
ZRXOGVKRZXSDV"NLQWKHUHVXOWLQJÀOH7KLVFRPELQDWLRQLVQRWUHFRJQL]HGIRUH[DPSOHE\
0LFURVRIW([FHOZKLFKEUHDNVWKHÀOHIRUW\SLFDOXVDJH7RSUHYHQWWKLV\RXQHHGWRUHSODFH
NULLHQWULHVE\DSSURSULDWHYDOXHV$VVXPLQJWKDWWKHWDEOHsample.table1FRQVLVWVRID
QXPHULFFROXPQaDQGDFKDUDFWHUFROXPQb\RXVKRXOGXVHWKHIROORZLQJVWDWHPHQW
mysql> SELECT IFNULL(a, 0), IFNULL(b, "NULL") FROM sample.table1 INTO 
OUTFILE 'C:/target.csv' FIELDS ENCLOSED BY '"' TERMINATED BY ';' ESCAPED 
BY '"' LINES TERMINATED BY '\r\n';
7KHGRZQVLGHWRWKLVDSSURDFKLVWKDW\RXKDYHWROLVWDOOÀHOGVLQZKLFKDNULLYDOXH
PLJKWRFFXU
+DQGOLQJOLQHEUHDNV
,I\RXWU\WRH[SRUWYDOXHVWKDWFRQWDLQWKHVDPHFKDUDFWHUFRPELQDWLRQXVHGIRUOLQH
WHUPLQDWLRQLQWKHSELECT … INTO OUTFILEVWDWHPHQW0\64/ZLOOWU\WRHVFDSHWKH
FKDUDFWHUFRPELQDWLRQZLWKWKHFKDUDFWHUVGHÀQHGE\WKHESCAPED BYFODXVH+RZHYHU
WKLVZLOOQRWDOZD\VZRUNWKHZD\LWLVLQWHQGHG<RXZLOOW\SLFDOO\GHÀQH\r\nDVWKHOLQH
VHSDUDWRUV:LWKWKLVFRQVWHOODWLRQYDOXHVWKDWFRQWDLQDVLPSOHOLQHEUHDN\nZLOOQRWFDXVH
SUREOHPVDVWKH\DUHH[SRUWHGZLWKRXWDQ\FRQYHUVLRQDQGFDQEHLPSRUWHGWR0LFURVRIW([FHO
ÁDZOHVVO\,I\RXUYDOXHVKDSSHQWRFRQWDLQDFRPELQDWLRQRIFDUULDJHUHWXUQDQGOLQHIHHGWKH
\r\nFKDUDFWHUVZLOOEHSUHSHQGHGZLWKDQHVFDSHFKDUDFWHU"\r\nEXWVWLOOWKHWDUJHWÀOH
FDQQRWEHLPSRUWHGFRUUHFWO\7KHUHIRUH\RXQHHGWRFRQYHUWWKHIXOOOLQHEUHDNVWRVLPSOH
OLQHEUHDNV
mysql> SELECT a, REPLACE(b, '\r\n', '\n') FROM sample.table1 INTO OUTFILE 
'C:/target.csv' FIELDS ENCLOSED BY '"' TERMINATED BY ';' ESCAPED BY '"' 
LINES TERMINATED BY '\r\n';
:LWKWKLVVWDWHPHQW\RXZLOOH[SRUWRQO\OLQHEUHDNV\nZKLFKDUHW\SLFDOO\DFFHSWHGIRULPSRUW
E\RWKHUSURJUDPV
,QFOXGLQJKHDGHUV
)RUEHWWHUXQGHUVWDQGLQJ\RXPLJKWZDQWWRLQFOXGHKHDGHUVLQ\RXUWDUJHWÀOH<RXFDQGRVR
E\XVLQJDUNIONFRQVWUXFW
mysql> (SELECT 'Column a', 'Column b') UNION ALL (SELECT * FROM sample.
table1 INTO OUTFILE 'C:/target.csv' FIELDS ENCLOSED BY '"' TERMINATED BY 
';' ESCAPED BY '"' LINES TERMINATED BY '\r\n');
7KHUHVXOWLQJÀOHZLOOFRQWDLQDQDGGLWLRQDOÀUVWOLQHZLWKWKHJLYHQKHDGHUVIURPWKHÀUVW
SELECTFODXVH

0DQDJLQJ'DWD

([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW
<RXVRPHWLPHVKDYHWKHWDVNWRH[SRUWGDWDLQDVSHFLDOIRUPDWLQRUGHUWRIXOÀOOWKH
UHTXLUHPHQWVRIWKHUHFLSLHQWRIWKHGDWD,QWKLVUHFLSHZHZLOOVKRZ\RXRQHZD\WR
H[SRUWGDWDLQDIRUPDWWKDWLVEH\RQGWKHSRVVLELOLWLHVRIWKHSELECT … INTO OUTFILE
IRUPDWRSWLRQV
,QWKHIROORZLQJUHFLSHZHZLOOVKRZ\RXKRZWRFUHDWHDQH[SRUWÀOHLQDK\SRWKHWLFDOIRUPDW
7KLVLQFOXGHVWKHQDPHRIWKHÀOHDWLPHVWDPSDVKRUWGHVFULSWLRQRIWKHÀOH
VFRQWHQWDQG
WKHQXPEHURIGDWDURZVFRQWDLQHGLQWKHÀOHLQWKHÀUVWIRXUOLQHV7KHGDWDSRUWLRQVWDUWV
ZLWKDKHDGHUOLQHZLWKQDPHVIRUDOOFROXPQVIROORZHGE\WKHDFWXDOGDWDURZV(YHU\GDWDURZ
VKRXOGVWDUWZLWKDSUHÀ[FRQVLVWLQJRIWKHKDVKFKDUDFWHU#WKHOLQHQXPEHUDFRORQDQG
DVSDFH7KLVSUHÀ[LVIROORZHGE\WKHGDWDLWHPVVHSDUDWHGE\SLSH|FKDUDFWHUV(DFKOLQH
VKRXOGHQGZLWKDGROODUVLJQ$DQGWKHOLQHEUHDNRIFRXUVH
7KLVIRUPDWLVXVHGDVDQH[DPSOHEXWWKHVWHSVLQYROYHGFDQEHDGDSWHGWRPRUHFRPSOH[ÀOH
IRUPDWVLIQHFHVVDU\
*HWWLQJUHDG\
$VLQWKHSUHYLRXVUHFLSHZHZLOOQHHGDQDFFRXQWZLWKDSSURSULDWHSHUPLVVLRQVFILE
D64/FOLHQWDQGDÀOHQDPHIRUWKHWDUJHWÀOH$JDLQZHZLOODVVXPHDQDFFRXQWQDPHG
sample_installDQGZHZLOOH[SRUWGDWDIURPWDEOHsample.table2ZKLFKFRQVLVWVRI
WKUHHFROXPQVc1c2DQGc3WRDÀOHC:/target.txtLQWKHIRUPDWPHQWLRQHGSUHYLRXVO\
:HDOVRSURSRVHWRFUHDWHDÀOHcustomExport.sqlIRUWKH64/FRPPDQGVXVLQJDQHGLWRUWR
VWRUHWKH64/FRPPDQGV
+RZWRGRLW

&UHDWHDQHZVFULSWQDPHGcustomExport.sqlDQGDGGWKHIROORZLQJVWDWHPHQWV
WRLW
SET @filename := 'Filename: C:/target.txt';
SET @description := 'Description: This is a test export from 
sample.table2 with columns c1, c2, and c3';
SELECT NOW() INTO @timestamp;
SELECT COUNT(*) FROM sample.table2 INTO @rowcount;
SET @rows := CONCAT('Row count: ', @rowcount);
SET @header := '#Row Nr: Column c1 | Column c2 | Column c3 $';
SET @counter := 0;
SELECT @filename 
   UNION SELECT @description
   UNION SELECT @timestamp
   UNION SELECT @rows
   UNION SELECT @header

&KDSWHU

   UNION SELECT CONCAT('#',
      @counter := @counter + 1,
      ': ',
      CONCAT_WS(' | ', c1, c2, c3),
      ' $')
      FROM sample.table2 
      INTO OUTFILE 'C:/target.txt';

&RQQHFWWRWKHGDWDEDVHXVLQJWKHsample_installDFFRXQW

([HFXWHWKH64/VWDWHPHQWVIURPcustomExport.sqlDVDQDOWHUQDWLYHWRFRS\LQJ
WKHVWDWHPHQWVWR\RXU64/FOLHQW\RXFRXOGDOVRH[HFXWHWKHVWDWHPHQWVLQWKHÀOH
XVLQJmysql
ssourceFRPPDQG

7KHWDUJHWÀOHZLOOORRNDVIROORZV
Filename: C:/target.txt 
Description: This is a test export from sample.table2 with columns 
c1, c2, and c3 
2009-06-14 13:25:05 
Row count: 3 
#Row Nr: Column c1 | Column c2 | Column c3 $ 
#1: 209 | Some text in my test data | Some more text $ 
#2: 308 | Next test text for testing | Text to test $ 
#3: 406 | The quick brown fox jumps | Really? $
+RZLWZRUNV
$OWKRXJKWKLVVROXWLRQWDNHVVRPHFRPPDQGVWKH\DUHGLYLGHGLQWRDSUHSDUDWLRQSDUW
WKHÀUVWVHYHQFRPPDQGVWKDWGHÀQHWKHXVHUYDULDEOHVDQGWKHDFWXDOH[SRUWFRPPDQG
2IFRXUVH\RXFRXOGPLQLPL]HWKHQXPEHURIVWDWHPHQWVE\RPLWWLQJWKHXVHUYDULDEOHV
EXWWKHUHVXOWLQJVWDWHPHQWZRXOGEHVRPHZKDWEXON\
7KHSUHSDUDWLRQSDUWVLPSO\GHÀQHVVRPHXVHUYDULDEOHVIRUODWHUUHIHUHQFH7KHÀQDOSELECT
FRPPDQGFRQVLVWVRIDUNIONFRQVWUXFWZKLFKEDVLFDOO\FRQFDWHQDWHVWKHURZVWKDWDUH
UHTXLUHGIRUWKHÀOHKHDGHU7KHDFWXDOGDWDIURPWKHWDEOHLVSUHSDUHGE\WKHIROORZLQJ
SELECTFODXVH
SELECT CONCAT('#', @counter := @counter + 1, ': ', CONCAT_WS(' | ', 
c1, c2, c3), ' $') FROM sample.table2 
7KHCONCATVWDWHPHQWFRQFDWHQDWHVLWVSDUDPHWHUVVROHWXVKDYHDORRNDWWKHVWDWHPHQW
V
SDUWV7KHFODXVH'#', @counter := @counter + 1, ': 'IRUPVWKHUHTXLUHGOLQH
QXPEHUSRUWLRQRIWKHURZV7KHYDULDEOH@counterJHWVLQFUHPHQWHGIRUHYHU\URZZKLFK
SURGXFHVWKHLQWHQGHGOLQHQXPEHU7KHIROORZLQJCONCAT_WSZLOODOVRFRQFDWHQDWHWKHJLYHQ
YDOXHVEXWWKHÀUVWSDUDPHWHULVXVHGDVDVHSDUDWRUFKDUDFWHU_WSVWDQGVIRUZLWKVHSDUDWRU
)RUHYHU\URZWKLVZLOOUHVXOWLQDVWULQJZLWKWKHYDOXHVRIFROXPQVc1c2DQGc3VHSDUDWHGE\
WKHSLSHFKDUDFWHU:LWKDFORVLQJGROODUVLJQDVWKHÀQDOSDUDPHWHUWKHÀUVWCONCATLVFORVHG

0DQDJLQJ'DWD

:KLOHWKLVDSSURDFKDOORZVIRUWKHFUHDWLRQRIUDWKHUFRPSOH[ÀOHIRUPDWVLWLVQRWVXLWDEOH
IRUHYHU\VLWXDWLRQ)RUDGYDQFHGUHTXLUHPHQWVZHHQFRXUDJHWKHXVHRIRWKHUSURJUDPPLQJ
WHFKQLTXHVEH\RQGWKH64/FRPPDQGVIRUH[DPSOHUHDGLQJDQGSURFHVVLQJWKHGDWDXVLQJD
VFULSWLQJODQJXDJH7KLVKROGVHVSHFLDOO\WUXHZKHQWKHWDUJHWÀOHKDVWREHLQ;0/IRUPDW
)RUDGYDQFHGIRUPDWWLQJFDSDELOLWLHVFRQVLGHUH[SRUWLQJ\RXUGDWDLQ;0/
IRUPDWXVLQJmysqldump--xmlDQGSURFHVVLQJWKHUHVXOWLQJÀOHXVLQJ
DQ;6/7SURFHVVRU
7KHUH
VPRUH
3OHDVHQRWHWKDWXVLQJSDUHQWKHVHVRQWKHUNIONWRFODULI\WKHVHSDUDWLRQRIWKHGLIIHUHQW
SELECTVWDWHPHQWVPLJKWOHDGWRXQH[SHFWHGSUREOHPVWKHINTO OUTFILEFODXVHKDVWR
EHDWWDFKHGWRWKHODVWSELECTVWDWHPHQWRIDUNIONFRQVWUXFW$VWDWHPHQWOLNHSELECT 
(…) UNION (SELECT …) INTO OUTFILE … ZLOOQRWZRUNZKLOHSELECT (…) UNION 
(SELECT … INTO OUTFILE)GRHV:KLOHWKLVPLJKWQRWVHHPWRRLQWXLWLYHLWLVDZHOO
GRFXPHQWHGEHKDYLRUDQGQRWDEXJ
8VLQJVWRUHGSURFHGXUHVWRH[SRUW
UHSHDWHGO\
,QVRPHVLWXDWLRQV\RXZLOOQHHGGDWDH[SRUWVRQDUHJXODUEDVLVIRUH[DPSOHWRSURYLGHDQ
H[WHUQDOV\VWHPZLWKGDWDIRUGDLO\UHSRUWV2QHSRVVLELOLW\LVWRGHÀQHDVFKHGXOHGWDVNIRU
:LQGRZVRUDFURQMREIRU8QL[/LQX[V\VWHPVWRH[HFXWHDQDSSURSULDWHH[SRUW64/VFULSW
HYHU\GD\7KHGUDZEDFNRIWKLVLVWKDWLI\RXQHHGWRFKDQJHWKHLQWHUQDOGDWDVWUXFWXUHVRI
\RXUGDWDEDVHLWLVQRWVXIÀFLHQWWRFKDQJHRQO\WKHGDWDEDVHFRQWHQWEXW\RXDOVRKDYHWR
DGDSWWKHH[SRUW64/VFULSWGHÀQLWLRQRI\RXUH[SRUWMREVLPXOWDQHRXVO\
7RUHVROYHWKLVSUREOHP\RXFRXOGGHÀQHDVWRUHGSURFHGXUH7KLVSURFHGXUHGHÀQHVDVWDEOH
LQWHUIDFHE\ZKLFKWKHH[WHUQDOMREFDQWULJJHUWKHH[SRUW7KHGHÀQLWLRQRIWKHDFWXDOVWHSV
QHFHVVDU\WRSHUIRUPWKHH[SRUWLVHQFDSVXODWHGE\WKHVWRUHGSURFHGXUHWKDWLVLQVLGHWKH
GDWDEDVH7KXVDOOWKHQHFHVVDU\FKDQJHVLQFDVHRIVWUXFWXUDOFKDQJHVDUHUHVWULFWHGWRWKH
GDWDEDVHLWVHOI
,QWKLVUHFLSHZHZLOOVKRZ\RXDQH[DPSOHRIKRZWKLVZRUNVE\GHÀQLQJDVWRUHGSURFHGXUH
WKDWSHUIRUPVWKHVDPHH[SRUWWDVNDVLQWKHSUHYLRXVUHFLSH

&KDSWHU

6WRUHGSURFHGXUHVDUHRQO\DYDLODEOHVLQFH0\64/YHUVLRQ(DUOLHU
YHUVLRQVGRQRWVXSSRUWWKLVIHDWXUH
*HWWLQJUHDG\
7RVWHSWKURXJKWKLVUHFLSH\RXEDVLFDOO\QHHGWKHVDPHSUHUHTXLVLWHVDVLQWKHSUHYLRXV
UHFLSH([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW,QDGGLWLRQ\RXQHHGDXVHUDFFRXQWWKDWKDV
WKHCREATE ROUTINESULYLOHJHWRGHÀQHDVWRUHGSURFHGXUH)LQDOO\\RXKDYHWRPDNH
VXUHWKDWWKHDFFRXQWXVHGIRUWKHH[WHUQDOMREKDVWKHEXECUTESULYLOHJH:HZLOOXVH
WKHsample_installDQGsample_guestDFFRXQWVKHUHDVVXPLQJWKDWWKH\KDYHWKH
DSSURSULDWHSULYLOHJHV
+RZWRGRLW

&UHDWHDVWRUHGSURFHGXUHE\FRQQHFWLQJWR0\64/XVLQJmysqlDQGWKH
sample_installDFFRXQWDQGHQWHULQJWKHIROORZLQJVWDWHPHQWV
mysql> delimiter //
mysql> CREATE PROCEDURE sample.export_table2() READS SQL DATA
    -> BEGIN
    ->   SET @filename := 'Filename: C:/target.txt';
    ->   SET @description := 'Description: This is a test export  
          from sample.table2 with columns c1, c2, and c3';
    ->   SELECT NOW() INTO @timestamp;
    ->   SELECT COUNT(*) FROM sample.table2 INTO @rowcount;
    ->   SET @rows := CONCAT('Row count: ', @rowcount);
    ->   SET @header := '#Row Nr: Column c1 | Column c2 | Column  
          c3 $';
    ->   SET @counter := 0;
    ->   SELECT @filename
    ->          UNION SELECT @description
    ->          UNION SELECT @timestamp
    ->          UNION SELECT @rows
    ->          UNION SELECT @header
    ->    UNION SELECT CONCAT('#',
    ->                  @counter := @counter + 1,
    ->          ': ',
    ->            CONCAT_WS(' | ', c1, c2, c3),

0DQDJLQJ'DWD

    ->                  ' $')
    ->          FROM sample.table2
    ->            INTO OUTFILE 'C:/target.txt';
    -> END //
Query OK, 0 rows affected (0.00 sec)
mysql> delimiter ;
mysql>

&DOOWKHVWRUHGSURFHGXUHE\H[HFXWLQJWKHIROORZLQJFRPPDQGXVLQJWKHsample_
guestDFFRXQW
mysql> CALL sample.export_table2();
Query OK, 0 rows affected (0.01 sec)
+RZLWZRUNV
7KHVWHSVGLVFXVVHGLQWKHDIRUHPHQWLRQHGVHFWLRQDUHSUHWW\VWUDLJKWIRUZDUG,QVWHSZH
FUHDWHDVWRUHGSURFHGXUHWKDWFRQVLVWVRIWKHYHU\VDPHFRPPDQGVDVSUHVHQWHGLQWKH
SUHYLRXVUHFLSH([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW,QVWHSWKLVQHZO\FUHDWHGSURFHGXUH
LVFDOOHGIURPDGLIIHUHQWDFFRXQW
7KHÀUVWDQGODVWFRPPDQGRIVWHSLVWKHdelimiter //VWDWHPHQWZKLFKLVQHFHVVDU\
WRGHÀQHDVWRUHGSURFHGXUHZLWKPRUHWKDQRQHVWDWHPHQW,WRUGHUVWKHmysqlFOLHQW
QRWWRLQWHUSUHWWKHVHPLFRORQDVWKHHQGRIDFRPPDQGEXWWRFRQVLGHU//DVWKHHQG
RIDVWDWHPHQW:LWKWKLVZHFDQXVHVHPLFRORQVLQVLGHWKHSURFHGXUHERG\ZKLFKZRXOG
RWKHUZLVHKDYHFDXVHGmysqlWRVHQGWKH\HWXQÀQLVKHGFRPPDQGWRWKHVHUYHUWKXV
FDXVLQJDV\QWD[HUURU%HFDXVHRIWKHFKDQJHGGHOLPLWHUZHKDYHWRFORVHWKHSURFHGXUH
GHÀQLWLRQE\END //LQVWHDGRIEND;$OVRDVZHGRQRWZDQWWRNHHSWKHFKDQJHGGHOLPLWHU
ORQJHUWKDQQHFHVVDU\ZHUHYHUWWKLVWRWKHRULJLQDOIRUPVHPLFRORQLQWKHQH[WOLQHZLWK
WKHFORVLQJdelimiter ;VWDWHPHQW7KHREADS SQLDATASRUWLRQRIWKHCREATE TABLE
FRPPDQGLVRQO\LQVWUXFWLYHDQGKDVQRLPSOLFDWLRQVIRUWKHZD\WKHSURFHGXUHLVH[HFXWHG
2QHDGYDQWDJHRIWKLVDSSURDFKLVWKDW6WHSFDQEHUHSHDWHGRIWHQZLWKRXWKDYLQJWRHQWHU
UDWKHUFRPSOH[H[SRUWVWDWHPHQWVDJDLQDQGDJDLQ
$QRWKHUEHQHÀWLVWKDWWKHFKDQJHVPDGHWRWKHGDWDEDVHVWUXFWXUHFDQEHKLGGHQIURPWKH
XVHURIWKHSURFHGXUH,IIRUH[DPSOHFROXPQc1QHHGVWREHUHQDPHGWRfoo\RXVLPSO\
QHHGWRDGDSWWKHVWRUHGSURFHGXUHDFFRUGLQJO\E\UHSODFLQJWKHCONCAT_WSSRUWLRQE\
CONCAT_WS(' | ', foo, c2, c3)
)LQDOO\WKLVVROXWLRQPDNHVLWSRVVLEOHWRSURYLGHWKHDELOLW\WRH[SRUWGDWDWRDÀOHZLWKRXW
KDYLQJWRJUDQWWKHFILESULYLOHJHWRWKHUHVSHFWLYHDFFRXQW*UDQWLQJWKHFILESULYLOHJHWR
QRUPDOXVHUVLVZLGHO\FRQVLGHUHGDVHFXULW\LVVXHDVWKLVSULYLOHJHDOORZVDFFHVVWRWKHKRVW
ÀOHV\VWHPIURPWKHFRQWH[WRIWKH0\64/GDWDEDVHVHUYHUSURFHVV8VLQJWKHDIRUHPHQWLRQHG

&KDSWHU

VWRUHGSURFHGXUHWKHDFFRXQWWKDWFDOOVWKHURXWLQHGRHVQRWQHHGWRKDYHWKHFILESULYLOHJH
DWWDFKHGDVWKHVWDWHPHQWVDUHH[HFXWHGLQWKHVHFXULW\FRQWH[WRIWKHFUHDWRURIWKHURXWLQH
LQRXUH[DPSOHsample_install
:KHQGHÀQLQJDVWRUHGSURFHGXUHLQ0\64/WKHSURFHGXUHLVE\GHIDXOW
H[HFXWHGZLWKWKHSULYLOHJHVRIWKHGHÀQHURIWKHSURFHGXUH,I\RXZDQW
WRDSSO\WKHSULYLOHJHVRIWKHLQYRNHULQVWHDG\RXKDYHWRDGGDSQL 
SECURITY INVOKERFODXVHWRWKHCREATE PROCEDUREVWDWHPHQW
7KHGHIDXOWYDOXHLVSQL SECURITY DEFINER
:LWKWKLVDUUDQJHPHQWsample_guestLVDEOHWRH[SRUWGDWDWRÀOHVXVLQJSUHGHÀQHGVWRUHG
SURFHGXUHVEXWLVQRWDOORZHGWRH[HFXWHSELECT … INTO OUTFILEVWDWHPHQWVRQLWVRZQ
7KHUH
VPRUH
7KHFRGHH[DPSOHIURPWKHUHFLSHH[SRUWVGDWDWRDSUHGHÀQHGÀOH$Q\RQHZKRFDOOVWKH
URXWLQHKDVWRPDNHVXUHWKDWWKHWDUJHWÀOHC:/target.txtGRHVQRWH[LVW,QVRPH
VLWXDWLRQVWKLVUHVWULFWLRQLVQRWDFFHSWDEOH8VLQJSDUDPHWHUVLWLVSRVVLEOHWRSDVVWKHQDPH
RIWKHWDUJHWÀOHDVDSDUDPHWHU%HFDXVHWKHÀOHQDPHLQWKHINTO OUTFILEFODXVHKDV
WREHDOLWHUDOYDOXHZHKDYHWRXVHWKHDSSURDFKPHQWLRQHGSUHYLRXVO\RIFRQVWUXFWLQJWKH
FRPPDQGLQDVWULQJYDOXHSUHSDULQJDVWDWHPHQWIURPWKLVDQGH[HFXWLQJLW
mysql> delimiter // 
mysql> CREATE PROCEDURE sample.export_table2_FileAsParam(IN file 
CHAR(255)) READS SQL DATA
    -> BEGIN
    ->   SET @filename := CONCAT('Filename: ', @file);
    ->   SET @description := 'Description: This is a test export from  
          sample.table2 with columns c1, c2, and c3';
    ->   SELECT NOW() INTO @timestamp;
    ->   SELECT COUNT(*) FROM sample.table2 INTO @rowcount;
    ->   SET @rows := CONCAT('Row count: ', @rowcount);
    ->   SET @header := '#Row Nr: Column c1 | Column c2 | Column c3 $';
    ->   SET @command = CONCAT("SELECT @filename
    ">          UNION SELECT @description
    ">          UNION SELECT @timestamp
    ">          UNION SELECT @rows
    ">          UNION SELECT @header
    ">    UNION SELECT CONCAT('#',
    ">                  @counter := @counter + 1,

0DQDJLQJ'DWD

    ">          ': ',
    ">            CONCAT_WS(' | ', c1, c2, c3),
    ">                  ' $')
    ">          FROM sample.table2
    ">            INTO OUTFILE '", file, "';");
    ->   SET @counter := 0;
    ->   PREPARE statement FROM @command;
    ->   EXECUTE statement;
    ->   END //
Query OK, 0 rows affected (0.00 sec)
mysql> delimiter ;
7KLVURXWLQHDOORZVSDVVLQJWKHÀOHQDPHZKHQFDOOLQJLW
mysql> call sample.export_table2_FileAsParam("C:/data.out");
Query OK, 0 rows affected (0.00 sec)
,PSRUWLQJGDWDIURPDVLPSOH&69ÀOH
$FRPPRQWDVNZKHQZRUNLQJZLWKGDWDEDVHVLVWRLPSRUWGDWDIURPGLIIHUHQWVRXUFHV
8QIRUWXQDWHO\WKLVGDWDZLOOW\SLFDOO\QRWEHSURYLGHGDVDFRQYHQLHQWVHWRIZHOOIRUPHG64/
VWDWHPHQWVWKDW\RXFDQVLPSO\UXQDJDLQVW\RXUGDWDEDVH7KHUHIRUHKHUH\RXZLOOKDYHWR
GHDOZLWKGDWDLQDGLIIHUHQWIRUPDW
$VDFRPPRQGHQRPLQDWRUFKDUDFWHUVHSDUDWHGYDOXHV&69DUHVWLOODSUHYDOHQWZD\RI
H[FKDQJLQJGDWD,QWKLVFKDSWHUZHZLOOVKRZ\RXKRZWRLPSRUWGDWDVWRUHGLQ&69ÀOHV$VD
W\SLFDOH[DPSOHZHZLOOXVHWKHÀOHIRUPDW0LFURVRIW([FHOSURGXFHVZKHQVWRULQJÀOHVXVLQJ
WKH*.CSVÀOHW\SH
7KLVUHFLSHLVWKHFRXQWHUSDUWRIWKH([SRUWLQJGDWDWRDVLPSOH&69ÀOHUHFLSHLQWKLVFKDSWHU
*HWWLQJUHDG\
7RVWHSWKURXJKWKLVUHFLSHZHZLOOGHÀQLWHO\QHHGDÀOHWRLPSRUWKHUHC:/source.csv
DQGDWDEOHWRLPSRUWWKHGDWDLQWRKHUHsample.table17KHVRXUFHÀOHDQGWDUJHWWDEOH
KDYHWRKDYHDPDWFKLQJIRUPDWFRQFHUQLQJWKHQXPEHURIFROXPQVDQGWKHW\SHRIGDWD
VWRUHGLQWKHP)XUWKHUPRUHDQDFFRXQWZLWKINSERTDQGFILESULYLOHJHVLVUHTXLUHGZHZLOO
DVVXPHDQDFFRXQWsample_installLQWKLVUHFLSH

&KDSWHU

7KHVRXUFHÀOHKDVWREHORFDWHGRQWKHPDFKLQHWKDWUXQV\RXU0\64/
VHUYHUQRWRQWKHFOLHQWVLGH
+RZWRGRLW
 &RQQHFWWRWKHGDWDEDVHXVLQJWKHsample_installDFFRXQW
 ,VVXHWKHIROORZLQJ64/FRPPDQG
mysql> LOAD DATA INFILE 'C:/source.csv' INTO TABLE sample.table1 
FIELDS ENCLOSED BY '"' TERMINATED BY ';' ESCAPED BY '"' LINES 
TERMINATED BY '\r\n';
Query OK, 20 rows affected (0.06 sec)
Records: 20  Deleted: 0  Skipped: 0  Warnings: 0
+RZLWZRUNV
7KHLOAD DATA INFILEFRPPDQGZRUNVDQDORJRXVWRWKHSELECT … INTO OUTFILE
FRPPDQGGLVFXVVHGLQWKHSUHYLRXVUHFLSHVEXWDVDPHDQVIRULPSRUWLQJGDWDUDWKHUWKDQ
H[SRUWLQJ7KHIRUPDWRSWLRQVDYDLODEOHIRUERWKFRPPDQGVDUHLGHQWLFDOVR\RXFDQW\SLFDOO\
LPSRUWGDWDH[SRUWHGE\DSELECT … INTO OUTFILEVWDWHPHQWXVLQJDLOAD DATA 
INFILEFRPPDQGZLWKWKHVDPHIRUPDWRSWLRQV
$VPRVWÀOHVFRQVLVWRIOLQHVWHUPLQDWHGE\DVHTXHQFHRIDFDUULDJHUHWXUQDQGDOLQHIHHG
FKDUDFWHUZHXVHWKHLINES TERMINATED BY '\r\n'RSWLRQ7KHFKRLFHRIWKHVHPLFRORQ
FKDUDFWHU³DVDVHSDUDWRUIRUGLIIHUHQWÀHOGVRIHYHU\OLQHTERMINATED BY ';'³LVPDLQO\
GXHWRWKHIDFWWKDW([FHOXVHVWKLVIRUPDW,I\RXKDSSHQWRUHFHLYH&69ÀOHVWKDWIRUH[DPSOH
XVHDFRPPDLQVWHDG\RXKDYHWRDGMXVWWKLVDFFRUGLQJO\
7KHWHUPFIELDS ENCLOSED BY '"'WHOOVWKHLPSRUWWRORRNIRUGRXEOHTXRWHVDWWKH
VWDUWRIHYHU\ÀHOGLPSRUWHG,IWKHUHLVRQHWKHÀHOGLVFRQVLGHUHGWRHQGDWWKHQH[WGRXEOH
TXRWH7REHDEOHWRKDYHGRXEOHTXRWHVLQVLGHDÀHOGYDOXHZHGHÀQHDQHVFDSHFKDUDFWHU
ESCAPED BY '"':LWKWKLVFRQVWHOODWLRQDVHTXHQFHRIWZRGRXEOHTXRWHVLVQRWWUHDWHG
DVWKHHQGRIWKHÀHOGEXWDVDGRXEOHTXRWHFKDUDFWHUDVSDUWRIWKHYDOXH
7KHUH
VPRUH
7KHGDWDLVUHDGIURPWKHÀOHXVLQJWKHGHIDXOWFKDUDFWHUVHWRIWKHGDWDEDVH,IWKHÀOHXVHVD
GLIIHUHQWFKDUDFWHUHQFRGLQJ\RXFDQVSHFLI\WKLVE\DGGLQJDCHARACTER SETFODXVHDIWHU
WKHWDEOHGHÀQLWLRQLOAD DATA INFILE … INTO TABLE sample.table1 CHARACTER 
SET utf8;3OHDVHQRWHWKDWWKHFKDUDFWHUVHWVucs2utf16DQGutf32DUHQRWVXSSRUWHG
DVRI0\64/YHUVLRQ

0DQDJLQJ'DWD

6HHDOVR
f
([SRUWLQJGDWDWRDVLPSOH&69ÀOH
,PSRUWLQJGDWDIURPFXVWRPÀOHIRUPDWV
,QWKHSUHYLRXVUHFLSH,PSRUWLQJGDWDIURPDVLPSOH&69ÀOHZHGLVFXVVHGDZD\RILPSRUWLQJ
GDWDIURPDQLFHO\IRUPDWWHGÀOH8QIRUWXQDWHO\\RXVRPHWLPHVKDYHWRGHDOZLWKIDUOHVV
FRQYHQLHQWGDWDVRXUFHV,QWKLVUHFLSHZHZLOOSUHVHQWVRPHPRUHDGYDQFHGWRSLFVRI
LPSRUWLQJGDWDIURPÀOHVZLWKDOHVVVWULFWVWUXFWXUH
2EYLRXVO\LWLVQRWSRVVLEOHWRSUHVHQWDXQLYHUVDOUHFLSHIRUHYHU\ÀOHIRUPDWLPDJLQDEOHVR
ZHZLOOXVHDQH[DPSOHWKDWFRYHUVVRPHRIWKHFRPPRQSUREOHPVRQHKDVWRWDFNOHZKHQ
LPSRUWLQJGDWDIURPFXVWRPÀOHV)RUWKLVZHZLOOUHIHUWRWKHVDPHK\SRWKHWLFDOIRUPDWDVLQ
([SRUWGDWDWRDFXVWRPÀOHIRUPDWZKLFKGHÀQHVIRXULQLWLDOOLQHVFRQWDLQLQJQDPHRIWKH
ÀOHDWLPHVWDPSDGHVFULSWLRQDQGWKHQXPEHURIURZVDKHDGHUOLQHZLWKWKHQDPHRIWKH
FROXPQVDQGVXEVHTXHQWO\WKHURZVZLWKWKHDFWXDOGDWDWRLPSRUW(DFKGDWDURZVWDUWVZLWK
DKDVKFKDUDFWHU#WKHOLQHQXPEHUDFRORQDQGDVSDFH7KHGDWDYDOXHVWKDWIROORZWKH
URZQXPEHUDUHVHSDUDWHGE\DSLSH|FKDUDFWHUDQGWKHURZFORVHVZLWKDGROODUVLJQ$
*HWWLQJUHDG\
$JDLQWKHDFFRXQWXVHGLQWKHUHFLSHQHHGVWKHFILESULYLOHJHEHVLGHVWKHINSERT
SHUPLVVLRQIRUWKHWDEOHWKHGDWDVKRXOGEHLPSRUWHGLQWR:LWKD64/FOLHQWDÀOHZLWK
WKHDSSURSULDWHIRUPDWDQGDWDEOHDVWKHLPSRUWWDUJHWZHDUHUHDG\WRJR$VLQSUHYLRXV
UHFLSHVZHXVHsample_installDVWKHDFFRXQWQDPHC:/source.txtDVWKHVRXUFHÀOH
DQGsample.table2FRQVLVWLQJRIWKUHHFROXPQVc1c2DQGc3DVWKHWDUJHWWDEOH:H
DVVXPHWKHVRXUFHÀOHWRKDYHWKHIROORZLQJFRQWHQW
Filename: C:/source.txt
Description: This is a file for test import to sample.table2, columns 
c1, c2, and c3 
2009-06-14 13:25:05 
Row count: 3 
#Row Nr: Column c1 | Column c2 | Column c3 $ 
#1: 209 | Some text in my test data | Some more text $
#2: 308 | Next test text for testing | Text to test $
#3: 406 | "A water | pipe" | Really? $
+RZWRGRLW
 &RQQHFW\RXUIDYRULWHFOLHQWIRUH[DPSOHWKHmysqlFRPPDQGOLQHFOLHQWWR\RXU
0\64/VHUYHUXVLQJWKHsample_installDFFRXQW

&KDSWHU


([HFXWHWKHIROORZLQJ64/FRPPDQG
mysql> LOAD DATA INFILE "C:/source.txt"
    ->  INTO TABLE sample.table2
    ->  FIELDS TERMINATED BY ' | '
    ->  OPTIONALLY ENCLOSED BY '"'
    ->  LINES STARTING BY ':'
    ->  TERMINATED BY '\r\n'
    ->  IGNORE 5 LINES
    ->  SET c3=TRIM(TRAILING ' $' FROM c3);
Query OK, 3 rows affected (0.05 sec)
Records: 3  Deleted: 0  Skipped: 0  Warnings: 0
+RZLWZRUNV
/HWXVGLVVHFWWKHDERYHVWDWHPHQWE\KDYLQJDORRNDWWKHVRXUFHÀOHÀUVWRIDOOZHZDQW
WRLPSRUWGDWDIURPWKHÀOHC:\source.txtLQWRWKHWDEOHsample.table2ZKLFKLV
UHSUHVHQWHGE\WKHÀUVWWZROLQHVLOAD DATA INFILE … INTO TABLE …
$WWKHWRSRIWKHÀOHZHKDYHÀYHOLQHVWKHLQLWLDOIRXUOLQHVZLWKLQIRUPDWLRQDERXWWKHÀOHSOXV
WKHKHDGHUWKDWVKRXOGQRWEHLPSRUWHGLQWRWKHWDUJHWWDEOH7RDFKLHYHWKLVWKHIGNORE 5 
linesRSWLRQLVDGGHG
7KHUHPDLQLQJOLQHVDUHSUHÀ[HGZLWKDKDVKFKDUDFWHUWKHURZQXPEHUDQGDFRORQ7KLVSDUW
RIHYHU\OLQHKDVWREHLJQRUHGZKLFKLVZKDWWKHLINES STARTING BY ':'RSWLRQGRHVLW
WHOOV0\64/WRLJQRUHWKHÀUVWFRORQRIWKHOLQHDQGDQ\FKDUDFWHUEHIRUHLW%\GRLQJWKLVWKH
URZQXPEHUSUHÀ[LVVNLSSHG
$IWHUWKHSUHÀ[WKHOLQHVFRQWDLQWKHDFWXDOYDOXHVVHSDUDWHGE\SLSHFKDUDFWHUV7KHFIELDS 
TERMINATED BY ' | 'RSWLRQWHOOV0\64/KRZWRLGHQWLI\DÀHOGVHSDUDWRU:LWKWKH
DGGLWLRQDOVHWWLQJOPTIONALLY ENCLOSED BY '"'WKHYDOXHLWVHOIPLJKWFRQWDLQWKLVÀHOG
VHSDUDWRUVHTXHQFH³LIWKHZKROHYDOXHLVHQFORVHGE\GRXEOHTXRWHVWKLVLVWKHFDVHLQWKH
ODVWURZRIWKHVDPSOHÀOH
$WWKLVSRLQWWKHUHLVRQO\RQHSUREOHPOHIWWKHOLQHVHQGZLWKDGROODUVLJQZKLFKLVQRW
SDUWRIWKHODVWYDOXH$QLQWXLWLYHDSSURDFKZRXOGEHWRLQFOXGHWKLVFKDUDFWHULQWKHOLQH
WHUPLQDWLRQVHTXHQFHZKLFKPHDQVWRXVH$\r\nDVDOLQHHQGLQJLQVWHDGRI\r\n
8QIRUWXQDWHO\WKLVGHÀQLWLRQRIDOLQHHQGGRHVQRWZRUNDVH[SHFWHGIRURXUH[DPSOHDVLW
ZRXOGEUHDNWKHLQWHUSUHWDWLRQRIWKHÀUVWÀYHOLQHVZKLFKDUHQRWWHUPLQDWHGWKHVDPHZD\
$VDUHVXOWWKHÀUVWVL[OLQHVZRXOGEHFRQVLGHUHGDVRQHVLQJOHOLQHE\WKHLPSRUWEHFDXVH
RQO\WKHVL[WKOLQHDFWXDOO\HQGVZLWKDFKDUDFWHUVHTXHQFHRI$\r\n7REHDEOHWRH[SOLFLWO\
H[FOXGHWKHKHDGHUOLQHVIURPWKHLPSRUWZHKDYHWRUHO\RQWKHWUDGLWLRQDOOLQHHQGLQJ
GHÀQHGE\WKH[LINES] TERMINATED BY '\r\n'RSWLRQ

0DQDJLQJ'DWD

+HQFHWKHRSWLRQVIRUGHÀQLQJWKHÀHOGVHSDUDWRUVDQGWKHEHJLQQLQJDQGWHUPLQDWLRQRI
DOLQHGRQRWDOORZXVWRJHWULGRIWKHFORVLQJGROODUVLJQ7KXVLWLVFRQVLGHUHGSDUWRIWKH
ODVWYDOXHZKLFKLVDVVLJQHGWRFROXPQc37RÀQDOO\JHWULGRIWKLVSRVWÀ[WKHSETFODXVH
RIWKHLOAD DATA INFILE FRPPDQGFRPHVLQKDQG\ZKLFKDOORZVWRFOHDUO\GHÀQH
WKHYDOXHVWKDWDUHDVVLJQHGWRWKHFROXPQVLQWKHWDUJHWWDEOH7KHFORVLQJRSWLRQSET 
c3=TRIM(TRAILING ' $' FROM c3);GHÀQHVDZD\WRVWULSWKHXQZDQWHGSRVWÀ[IURP
WKHODVWÀHOG
,IZHSXWLWDOOWRJHWKHUWKHLPSRUWZRUNVDVLQWHQGHG
7KHUH
VPRUH
$VZLWKH[SRUWLQJGDWDLWLVUHFRPPHQGHGWRFRQVLGHUXVLQJDQH[WHUQDOSURJUDPPLQJ
ODQJXDJHWRLPSRUWPRUHFRPSOH[GDWDVWUXFWXUHVLQWR0\64/:KLOHLWLVSRVVLEOHWRLPSRUW
UDWKHUVRSKLVWLFDWHGÀOHIRUPDWVXVLQJ0\64/FRPPDQGVDVZHOOLWLVRIWHQIDUPRUHHIÀFLHQW
WRKDYHDIXOOEORZQSURJUDPPLQJODQJXDJHDWKDQGWRVROYHWKHWDVNRISDUVLQJLQSXWÀOHV
7KLVLVPRVWQRWDEO\WKHFDVHZKHQLWFRPHVWR;0/ÀOHV
)RULPSRUWLQJGDWDIURP;0/ÀOHVFRQVLGHUXVLQJDQ;6/7SURFHVVRU
WRSURGXFHFRUUHVSRQGLQJ64/FRPPDQGV
6HHDOVR
f
,PSRUWLQJGDWDIURPDVLPSOH&69ÀOH
f
([SRUWLQJGDWDWRDFXVWRPÀOHIRUPDW

&KDSWHU

,QVHUWLQJQHZGDWDDQGXSGDWLQJGDWDLILW
DOUHDG\H[LVWV
0DQLSXODWLQJGDWDLQDGDWDEDVHLVSDUWRIHYHU\GD\ZRUNDQGWKHEDVLF64/PHDQVRI
INSERTUPDATEDQGDELETEPDNHWKLVDSUHWW\VWUDLJKWIRUZDUGDOPRVWWULYLDOWDVN³EXW
LVWKLVDOZD\VWUXH"
:KHQFRQVLGHULQJGDWDPDQLSXODWLRQPRVWRIWKHWLPHZHWKLQNRIDVLWXDWLRQZKHUHZH
NQRZWKHFRQWHQWRIWKHGDWDEDVH:LWKWKLVLQIRUPDWLRQLWLVXVXDOO\SUHWW\HDV\WRÀQG
DZD\RIFKDQJLQJWKHGDWDWKHZD\\RXLQWHQGWR%XWZKDWLI\RXKDYHWRFKDQJHGDWDLQ
FLUFXPVWDQFHVZKHUH\RXGRQRWNQRZWKHDFWXDOGDWDEDVHFRQWHQWEHIRUHKDQG"
<RXPLJKWDQVZHU:HOOWKHQORRNDW\RXUGDWDEHIRUHFKDQJLQJLW8QIRUWXQDWHO\\RXGR
QRWDOZD\VKDYHWKLVRSWLRQ7KLQNRIGLVWULEXWHGLQVWDOODWLRQVRIDQ\VRIWZDUHWKDWLQFOXGHV
DGDWDEDVH,I\RXKDYHWRGHVLJQDQXSGDWHRSWLRQIRUWKLVVRIWZDUHDQGWKHUHVSHFWLYH
GDWDEDVHV\RXPLJKWHDVLO\FRPHWRDVLWXDWLRQZKHUH\RXVLPSO\GRQRWNQRZDERXWWKH
DFWXDOGDWDEDVHFRQWHQW
2QHH[DPSOHRIDSUREOHPDULVLQJLQWKHVHFDVHVLVWKHTXHVWLRQRIZKHWKHUWRLQVHUWRUWR
XSGDWHGDWD'RHVWKHGDWDLQTXHVWLRQDOUHDG\SDUWLDOO\H[LVW"/HWXVDVVXPHDGDWDEDVH
WDEOHconfigWKDWVWRUHVFRQÀJXUDWLRQVHWWLQJV,WKROGVNH\YDOXHSDLUVZLWKnameEHLQJ
WKHQDPHDQGWKXVWKHNH\RIWKHVHWWLQJDQGvalueLWVYDOXH7KLVWDEOHH[LVWVLQGLIIHUHQW
GDWDEDVHLQVWDOODWLRQVRQHIRUHYHU\EUDQFKRIÀFHRI\RXUFRPSDQ\<RXUWDVNLVWRFUHDWHDQ
XSGDWHSDFNDJHWRVHWDXQLIRUPXSSHUOLPLWRIIRUWKHSULFHGLVFRXQWWKDWLVDOORZHGLQ
\RXUVDOHVVRIWZDUH,IQRVXFKOLPLWKDVEHHQGHÀQHG\HWWKHUHLVQRUHVSHFWLYHHQWU\LQWKH
configWDEOHDQG\RXKDYHWRLQVHUWDQHZUHFRUG,IWKHOLPLWKRZHYHUKDVEHHQVHWEHIRUH
IRUH[DPSOHE\WKHORFDOPDQDJHUWKHHQWU\GRHVDOUHDG\H[LVWLQZKLFKFDVH\RXKDYHWR
XSGDWHLWWRKROGWKHQHZYDOXH
:KLOHWKHXSGDWHRIDSRWHQWLDOO\H[LVWLQJHQWU\GRHVQRWSRVHDSUREOHPDQINSERT
VWDWHPHQWWKDWYLRODWHVXQLTXHQHVVFRQVWUDLQWVZLOOVLPSO\FDXVHDQHUURU7KLVLVKRZHYHU
W\SLFDOO\QRWDFFHSWDEOHLQDQDXWRPDWHGXSGDWHSURFHGXUH7KHIROORZLQJUHFLSHZLOOVKRZ\RX
KRZWRVROYHWKLVSUREOHPZLWKRQO\RQH64/FRPPDQG
*HWWLQJUHDG\
%HVLGHVDUXQQLQJ0\64/VHUYHUD64/FOLHQWDQGDQDFFRXQWZLWKDSSURSULDWHXVHUULJKWV
INSERTUPDATEZHQHHGDWDEOHWRXSGDWH,QWKHHDUOLHUH[DPSOHZHDVVXPHGDWDEOH
QDPHGsample.configZLWKWZRFKDUDFWHUFROXPQVnameDQGvalue7KHnameFROXPQ
LVGHÀQHGDVWKHSULPDU\NH\
CREATE TABLE sample.config (
   name VARCHAR(64) PRIMARY KEY, 
   value VARCHAR(64));

0DQDJLQJ'DWD

+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVHXVLQJ\RXU64/FOLHQW

([HFXWHWKHIROORZLQJFRPPDQG
mysql> INSERT INTO sample.config VALUES ("maxPriceDiscount", 
"25%") ON DUPLICATE KEY UPDATE value='25%';
Query OK, 1 row affected (0.05 sec)
+RZLWZRUNV
7KLVFRPPDQGLVHDVLO\H[SODLQHGEHFDXVHLWVLPSO\GRHVZKDWLWVD\VLWLQVHUWVDQHZURZLQ
WKHWDEOHXVLQJWKHJLYHQYDOXHVDVORQJDVWKLVGRHVQRWFDXVHDGXSOLFDWHHQWU\LQHLWKHUWKH
SULPDU\NH\RUDQRWKHUXQLTXHLQGH[,IDGXSOLFDWHUHFRUGH[LVWVWKHH[LVWLQJURZLVXSGDWHG
DFFRUGLQJWRWKHFODXVHVGHÀQHGDIWHUON DUPLICATE KEY UPDATE
:KLOHLWLVVRPHWLPHVWHGLRXVWRHQWHUVRPHRIWKHGDWDDQGFROXPQVWZRWLPHVRQFHIRUWKH
INSERTDQGDVHFRQGWLPHIRUWKHUPDATEWKLVVWDWHPHQWDOORZVIRUDORWRIÁH[LELOLW\ZKHQLW
FRPHVWRWKHPDQLSXODWLRQRISRWHQWLDOO\H[LVWLQJGDWD
3OHDVHQRWHWKDWZKHQH[HFXWLQJWKHDERYHVWDWHPHQWWKHUHVXOWGLIIHUVVOLJKWO\ZLWKUHVSHFW
WRWKHQXPEHURIDIIHFWHGURZVGHSHQGLQJRQWKHDFWXDOGDWDSUHVHQWLQWKHGDWDEDVH:KHQ
WKHUHFRUGGRHVQRWH[LVW\HWLWLVLQVHUWHGZKLFKUHVXOWVLQRQHDIIHFWHGURZ%XWLIWKHUHFRUG
LVXSGDWHGUDWKHUWKDQLQVHUWHGLWUHSRUWVWZRDIIHFWHGURZVLQVWHDGHYHQLIRQO\RQHURZ
JHWVXSGDWHG
7KHUH
VPRUH
7KHINSERT INTO … ON DUPLICATE UPDATEFRQVWUXFWGRHVQRWZRUNZKHQWKHUHLV
QRUNIQUERUPRIMARY KEYGHÀQHGRQWKHWDUJHWWDEOH,I\RXKDYHWRSURYLGHWKHVDPH
VHPDQWLFVZLWKRXWKDYLQJDSSURSULDWHNH\GHÀQLWLRQVLQSODFHLWLVUHFRPPHQGHGWRXVHWKH
WHFKQLTXHVGLVFXVVHGLQWKHQH[WUHFLSH
6HHDOVR
f
,QVHUWLQJGDWDEDVHGRQH[LVWLQJGDWDEDVHFRQWHQW

&KDSWHU

,QVHUWLQJGDWDEDVHGRQH[LVWLQJGDWDEDVH
FRQWHQW
,QWKHSUHYLRXVUHFLSH,QVHUWLQJQHZGDWDDQGXSGDWLQJGDWDLILWDOUHDG\H[LVWVZHGLVFXVVHG
DPHWKRGWRHLWKHULQVHUWRUXSGDWHUHFRUGVGHSHQGLQJRQZKHWKHUWKHUHFRUGVDOUHDG\H[LVWLQ
WKHGDWDEDVH$VLPLODUSUREOHPDULVHVZKHQ\RXQHHGWRLQVHUWGDWDWR\RXUGDWDEDVHEXWWKH
GDWDWRLQVHUWGHSHQGVRQWKHGDWDLQ\RXUGDWDEDVH
$VDQH[DPSOHFRQVLGHUDVLWXDWLRQLQZKLFK\RXQHHGWRLQVHUWDUHFRUGZLWKDFHUWDLQ
PHVVDJHLQWRDWDEOHlogMsgsEXWWKHPHVVDJHLWVHOIVKRXOGEHGLIIHUHQWGHSHQGLQJRQWKH
FXUUHQWV\VWHPODQJXDJHWKDWLVVWRUHGLQDFRQÀJXUDWLRQWDEOHconfig
,WLVIDLUO\HDV\WRDFKLHYHDVLPLODUEHKDYLRUIRUDQUPDATEVWDWHPHQWEHFDXVHWKLVVXSSRUWVD
WHEREFODXVHWKDWFDQEHXVHGWRRQO\SHUIRUPDQXSGDWHLIDFHUWDLQSUHFRQGLWLRQLVPHW
UPDATE logMsgs SET message=
   CONCAT('Last update: ', NOW()) WHERE EXISTS
   (SELECT value FROM config WHERE
    name='lang' AND value = 'en');
UPDATE logMsgs SET message=
   CONCAT('Letztes Update: ', NOW()) WHERE EXISTS  
   (SELECT value FROM config WHERE
    name='lang' AND value = 'de');
UPDATE logMsgs SET message=
   CONCAT('Actualisation derniere: ', NOW()) WHERE EXISTS  
   (SELECT value FROM config WHERE
    name='lang' AND value = 'fr');
8QIRUWXQDWHO\WKLVDSSURDFKLVQRWDSSOLFDEOHWRINSERTFRPPDQGVDVWKHVHGRQRWVXSSRUW
DWHEREFODXVH'HVSLWHWKLVPLVVLQJRSWLRQWKHIROORZLQJUHFLSHGHVFULEHVDPHWKRGWRPDNH
INSERTVWDWHPHQWVH[HFXWHRQO\LIDQDSSURSULDWHSUHFRQGLWLRQLQWKHGDWDEDVHLVPHW
*HWWLQJUHDG\
$VEHIRUHZHDVVXPHDGDWDEDVHD64/FOLHQWmysqlDQGD0\64/XVHUZLWKVXIÀFLHQW
SULYLOHJHVINSERTDQGSELECTLQWKLVFDVH$GGLWLRQDOO\ZHQHHGDWDEOHWRLQVHUWGDWD
LQWRKHUHlogMsgsDQGDFRQÀJXUDWLRQWDEOHconfigSOHDVHUHIHUWRWKHSUHYLRXVUHFLSH
IRUGHWDLOV

0DQDJLQJ'DWD

+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVHXVLQJ\RXU64/FOLHQW

([HFXWHWKHIROORZLQJ64/FRPPDQGV
mysql> INSERT INTO sample.logMsgs(message)
    ->  SELECT CONCAT('Last update: ', NOW())
    ->  FROM sample.config WHERE name='lang' AND value='en';
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql> INSERT INTO sample.logMsgs(message)
    ->  SELECT CONCAT('Letztes Update: ', NOW())
    ->  FROM sample.config WHERE name='lang' AND value='de';
Query OK, 1 row affected (0.05 sec)
Records: 1  Duplicates: 0  Warnings: 0
mysql> INSERT INTO sample.logMsgs(message)
    ->  SELECT CONCAT('Dernière actualisation: ', NOW())
    ->  FROM sample.config WHERE name='lang' AND value='fr';
Query OK, 0 rows affected (0.00 sec)
Records: 0  Duplicates: 0  Warnings: 0
+RZLWZRUNV
2XUJRDOLVWRKDYHDQINSERTVWDWHPHQWWDNHLQWRDFFRXQWWKHSUHVHQWODQJXDJHVWRUHGLQ
WKHGDWDEDVH7KHWULFNWRGRVRLVWRXVHDSELECTVWDWHPHQWDVLQSXWIRUWKHINSERT7KH
SELECTFRPPDQGSURYLGHVDWHEREFODXVHVR\RXFDQXVHDFRQGLWLRQWKDWRQO\PDWFKHV
IRUWKHUHVSHFWLYHODQJXDJH2QHUHVWULFWLRQRIWKLVVROXWLRQLVWKDW\RXFDQRQO\LQVHUWRQH
UHFRUGDWDWLPHVRWKHVL]HRIVFULSWVPLJKWJURZFRQVLGHUDEO\LI\RXKDYHWRLQVHUWORWVRI
GDWDDQGRUKDYHWRFRYHUPDQ\DOWHUQDWLYHV
7KHUH
VPRUH
,I\RXKDYHPRUHWKDQMXVWDIHZYDOXHVWRLQVHUWLWLVPRUHFRQYHQLHQWWRKDYHWKHGDWDLQRQH
SODFHUDWKHUWKDQGLVWULEXWHGRYHUVHYHUDOLQGLYLGXDOINSERTVWDWHPHQWV,QWKLVFDVHLWPLJKW
PDNHVHQVHWRFRQVROLGDWHWKHGDWDE\SXWWLQJLWLQVLGHDWHPSRUDU\WDEOHWKHÀQDOINSERT
VWDWHPHQWXVHVWKLVWHPSRUDU\WDEOHWRVHOHFWWKHDSSURSULDWHGDWDURZVIRULQVHUWLRQLQWRWKH
WDUJHWWDEOH7KHGRZQVLGHRIWKLVDSSURDFKLVWKDWWKHXVHUQHHGVWKHCREATE TEMPORARY 
TABLESSULYLOHJHEXWLWW\SLFDOO\FRPSHQVDWHVZLWKPXFKFOHDQHUVFULSWV

&KDSWHU

$IWHUFUHDWLQJWKHWHPSRUDU\WDEOHZLWKWKHÀUVWVWDWHPHQWZHLQVHUWGDWDLQWRWKHWDEOHZLWK
WKHIROORZLQJINSERTVWDWHPHQW7KHQH[WVWDWHPHQWLQVHUWVWKHDSSURSULDWHGDWDLQWRWKH
WDUJHWWDEOHsample.logMsgsE\VHOHFWLQJWKHDSSURSULDWHGDWDIURPWKHWHPSRUDU\GDWD
WKDWPDWFKHVWKHODQJXDJHHQWU\IURPWKHconfigWDEOH7KHWHPSRUDU\WDEOHLVWKHQUHPRYHG
DJDLQ7KHÀQDOSELECTVWDWHPHQWLVVROHO\IRUFKHFNLQJWKHUHVXOWVRIWKHRSHUDWLRQ
6HHDOVR
f
,QVHUWLQJQHZGDWDDQGXSGDWLQJGDWDLILWDOUHDG\H[LVWV

0DQDJLQJ'DWD

'HOHWLQJDOOGDWDIURPODUJHWDEOHV
$OPRVWHYHU\RQHZKRZRUNVZLWKGDWDEDVHVH[SHULHQFHVWKHFRQVWDQWJURZWKRIWKHGDWD
VWRUHGLQWKHLUGDWDEDVHDQGLWLVW\SLFDOO\ZHOOEH\RQGWKHLQLWLDOHVWLPDWHV%HFDXVHRIWKDW
\RXRIWHQHQGXSZLWKUDWKHUODUJHGDWDVHWV$QRWKHUFRPPRQREVHUYDWLRQLVWKDWLQPRVW
GDWDEDVHVWKHUHDUHVRPHWDEOHVWKDWKDYHDVSHFLDOWHQGHQF\WRJURZHVSHFLDOO\ELJ
,IDWDEOH
VVL]HUHDFKHVDYLUWXDOWKUHVKROGZKLFKLVKDUGWRGHÀQHDVLWGHSHQGVKHDYLO\
RQWKHDFFHVVSDWWHUQVDQGWKHGDWDVWUXFWXUHVLWJHWVKDUGHUDQGKDUGHUWRPDLQWDLQDQG
SHUIRUPDQFHGHJUDGDWLRQPLJKWRFFXU)URPDFHUWDLQSRLQWRQLWLVHYHQGLIÀFXOWWRJHWULG
RIGDWDLQWKHWDEOHDJDLQDVWKHVKHHUQXPEHURIUHFRUGVPDNHVGHOHWLRQDSUHWW\H[SHQVLYH
WDVN7KLVSDUWLFXODUO\KROGVWUXHIRUVWRUDJHHQJLQHVZLWK0XOWL9HUVLRQ&RQFXUUHQF\&RQWURO
09&&LI\RXRUGHUWKHGDWDEDVHWRGHOHWHGDWDIURPWKHWDEOHLWPXVWQRWEHGHOHWHGULJKW
DZD\EHFDXVH\RXPLJKWVWLOOUROOEDFNWKHGHOHWLRQ6RHYHQZKLOHWKHGHOHWLRQZDVLQLWLDWHG
DFRQFXUUHQWTXHU\RQWKHWDEOHVWLOOKDVWREHDEOHWRVHHDOOWKHUHFRUGVGHSHQGLQJRQWKH
WUDQVDFWLRQLVRODWLRQOHYHO7RDFKLHYHWKLVWKHVWRUDJHHQJLQHZLOORQO\PDUNWKHUHFRUGVDV
GHOHWHGEXWWKHDFWXDOGHOHWLRQWDNHVSODFHDIWHUWKHRSHUDWLRQLVFRPPLWWHGDQGDOORWKHU
WUDQVDFWLRQVWKDWDFFHVVWKLVWDEOHDUHFORVHGDVZHOO
,I\RXKDYHWRGHDOZLWKODUJHGDWDVHWVWKHPRVWGLIÀFXOWWDVNLVWRRSHUDWHRQWKHSURGXFWLRQ
V\VWHPZKLOHRWKHUSURFHVVHVFRQFXUUHQWO\ZRUNRQWKHGDWD,QWKHVHFLUFXPVWDQFHV\RXKDYH
WRNHHSWKHGXUDWLRQRI\RXUPDLQWHQDQFHRSHUDWLRQVDVORZDVSRVVLEOHLQRUGHUWRPLQLPL]H
WKHLPSDFWRQWKHUXQQLQJV\VWHP$VWKHGHOHWLRQRIGDWDIURPDODUJHWDEOHW\SLFDOO\VWDUWLQJ
DWVHYHUDOPLOOLRQVRIURZVPLJKWWDNHTXLWHVRPHWLPHWKHIROORZLQJUHFLSHVKRZVDZD\RI
PLQLPL]LQJWKHGXUDWLRQRIWKLVRSHUDWLRQLQRUGHUWRUHGXFHVLGHHIIHFWVOLNHORFNLQJHIIHFWV
RUSHUIRUPDQFHGHJUDGDWLRQ
*HWWLQJUHDG\
%HVLGHVDXVHUDFFRXQWZLWKDSSURSULDWHSULYLOHJHVDELETE\RXQHHGDVXIÀFLHQWO\ODUJH
WDEOHWRGHOHWHGDWDIURP
)RUWKLVUHFLSHZHZLOOXVHWKHemployeesGDWDEDVHZKLFKLVDQH[DPSOH
GDWDEDVHDYDLODEOHIURP0\64/http://dev.mysql.com/doc/
employee/en/employee.html.
7KLVGDWDEDVHSURYLGHVVRPHWDEOHVZLWKVHQVLEOHGDWDDQGVRPHSUHWW\
ODUJHWDEOHVWKHODUJHVWKDYLQJPRUHWKDQPLOOLRQUHFRUGV
:HDVVXPHWKDWWKHEmployeesGDWDEDVHZDVLQVWDOOHGZLWKDQ,QQR'%VWRUDJHHQJLQH
HQDEOHG7RGHOHWHDOOURZVRIWKHODUJHVWWDEOHemployees.salariesLQDTXLFNZD\SOHDVH
UHDGRQ

&KDSWHU

+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVH

(QWHUWKHIROORZLQJ64/FRPPDQG
mysql> TRUNCATE TABLE employees.salaries;
Query OK, 0 rows affected (0.16 sec)
+RZLWZRUNV
7KHTRUNCATE TABLEFRPPDQGLVDUDWKHUIDVWZD\RIGHOHWLQJDOOGDWDIURPDWDEOH)RU
WDEOHVWKDWDUHQRWUHIHUHQFHGE\)RUHLJQNH\FRQVWUDLQWVPRUHRQWKDWODWHUWKHFRPPDQG
EDVLFDOO\GURSVWKHWDEOHWHPSRUDULO\DQGUHFUHDWHVWKHWDEOHZLWKWKHVDPHVWUXFWXUHDV
EHIRUH7KLVRSHUDWLRQKDVEDVLFDOO\DFRQVWDQWWLPHFKDUDFWHULVWLF³WKHDPRXQWRIGDWDVWRUHG
LQVLGHWKHWDEOHGRHVQRWKDYHDQ\HIIHFWLQWKHWLPHQHHGHGIRUWKHTRUNCATEFRPPDQG
%HIRUH0\64/WKHTRUNCATE TABLEVWDWHPHQWIRU,QQR'%WDEOHV
ZDVDOZD\VHTXLYDOHQWWRDDELETEVWDWHPHQWUHJDUGOHVVRIZKHWKHU)RUHLJQ
NH\FRQVWUDLQWVH[LVWRUQRW7RWDNHDGYDQWDJHRIWKHVSHHGLPSURYHPHQWV
\RXKDYHWRXVH0\64/RUODWHU
,QFRPSDULVRQWRDFODVVLFDODELETE FROM employees.salaries;RSHUDWLRQWKH
UHGXFWLRQLQWLPHQHHGHGLVVWULNLQJ
2SHUDWLRQ
7LPHQHHGHG
7581&$7(7$%/(
VHF
'(/(7(
PLQVHF
TRUNCATETABLE
DELETE
100
0
20
40
60
80
Time in seconds

0DQDJLQJ'DWD

7KHTRUNCATE TABLEFRPPDQGWDNHVRQO\DIUDFWLRQRIWKHWLPHQHHGHGIRUWKHDELETE
+RZHYHUWKHUHDUHVRPHFDYHDWV
)LUVWRIDOOWKHTRUNCATEFRPPDQGZLOORQO\KDYHWKHVSHHGDGYDQWDJHRQ,QQR'%WDEOHV
LIWKHWDEOHLVQRWUHIHUHQFHGE\DQ\)RUHLJQNH\FRQVWUDLQWV%XWLIWKHWDEOHLVUHIHUHQFHG
E\)RUHLJQNH\VWKHTRUNCATE TABLEFRPPDQGLVHTXLYDOHQWWRH[HFXWLQJDDELETE
VWDWHPHQWZLWKQRWHEREFODXVHDOVRHOLPLQDWLQJDOOVSHHGGLIIHUHQFHV
mysql> CREATE TABLE employees.salaries_referencer (
    -> emp_no      INT,
    -> from_date   DATE,
    -> CONSTRAINT  salaries_fk
    -> FOREIGN KEY (emp_no, from_date)
    -> REFERENCES  salaries (emp_no, from_date)
    -> ON DELETE RESTRICT);
Query OK, 0 rows affected (0.08 sec)
mysql> TRUNCATE TABLE employees.salaries;
Query OK, 0 rows affected (1 min 33.44 sec)
2SHUDWLRQ
7LPHQHHGHG
7581&$7(7$%/(ZLWKIRUHLJQNH\UHI
PLQVHF
'(/(7(
PLQVHF
TRUNCATETABLE
(w/FKreferences)
DELETE
100
0
20
40
60
80
Time in seconds
)XUWKHUPRUHWKHTRUNCATEVWDWHPHQWUHTXLUHVWKHDROPSULYLOHJHEHIRUH0\64/
LWRQO\UHTXLUHVWKHDELETESHUPLVVLRQZKLFKIRUELGVXVHRIWKLVFRPPDQGIRUVRPHXVHUV

&KDSWHU

$QGÀQDOO\TRUNCATELVQRWDWUDQVDFWLRQVDIHFRPPDQG,I\RXH[HFXWHDTRUNCATE
VWDWHPHQW\RXZLOOQRWEHDEOHWRSHUIRUPDUROOEDFNRQWKLVRSHUDWLRQDQ\PRUHDQGDQ\
RSHQRSHUDWLRQIURPWKHFXUUHQWWUDQVDFWLRQJHWVDXWRPDWLFDOO\FRPPLWWHGDVZHOO7KLV
LVDFKDUDFWHULVWLFWKDWGLVTXDOLÀHVWKLVVWDWHPHQWIRUVLWXDWLRQVLQZKLFKWKHSRVVLELOLW\RI
SHUIRUPLQJDUROOEDFNLVPDQGDWRU\\RXZLOOKDYHWRVWLFNZLWKWKHPXFKVORZHUDELETELQ
WKHVHFDVHV
7KHUH
VPRUH
$VZHKDYHVHHQTRUNCATE TABLERQO\KDVSHUIRUPDQFHDGYDQWDJHVLIWKHUHLVQR)RUHLJQ
NH\UHIHUHQFHWRWKHWDEOHWKDWLVWREHGHOHWHG+HUHZHZLOOGLVFXVVKRZWRXVHWKHVSHHG
LPSURYHPHQWVHYHQLQFDVHRIH[LVWLQJUHIHUHQFHV
7HPSRUDULO\GLVDEOLQJ)RUHLJQNH\FRQVWUDLQWV
7RPDNHXVHRIWKHLQFUHDVHGVSHHGRITRUNCATE TABLEDOWKRXJKWKHWDUJHWWDEOHLVUHI
HUHQFHGYLD)RUHLJQNH\V\RXFRXOGWHPSRUDULO\UHPRYHWKH)RUHLJQNH\FRQVWUDLQWVXVHWKH
TRUNCATE TABLEFRPPDQGDQGUHHVWDEOLVKWKHUHIHUHQFHVDIWHUZDUGV8VLQJWKHDERYH
H[DPSOHRIDWDEOHsalaries_referencerWKDWUHIHUHQFHVVDODULHV\RXFRXOGXVHWKH
IROORZLQJVHTXHQFH
mysql> ALTER TABLE employees.salaries_referencer
    -> DROP FOREIGN KEY salaries_fk;
Query OK, 0 rows affected (0.19 sec)
Records: 0  Duplicates: 0  Warnings: 0
mysql> TRUNCATE TABLE employees.salaries;
Query OK, 0 rows affected (0.44 sec)
mysql> ALTER TABLE employees.salaries_referencer
    -> ADD CONSTRAINT salaries_fk
    -> FOREIGN KEY (emp_no, from_date)
    -> REFERENCES salaries (emp_no, from_date)
    -> ON DELETE RESTRICT;
Query OK, 0 rows affected (0.14 sec)
Records: 0  Duplicates: 0  Warnings: 0

0DQDJLQJ'DWD

:LWKWKLVVHTXHQFH\RXWHPSRUDULO\GLVDEOHWKH)RUHLJQNH\FRQVWUDLQWVWRKDYHTRUNCATE 
TABLEXVHWKHIDVWHUGHOHWLRQPHWKRG%HZDUHKRZHYHUWKDWWKLVPHWKRGPLJKWDOVR
OHDGWRSUREOHPVZKHQWKHGHOHWLRQRIWKHWDEOHSURGXFHVORRVHHQGV,IWKHUHIHUHQFLQJ
WDEOHsalaries.referencerKROGVUHFRUGVWKDWUHIHUHQFHGWKHQRZHPSW\WDUJHWWDEOH
salariesWKHFUHDWLRQRIWKH)RUHLJQNH\FRQVWUDLQWVZLOOIDLO
$OVRNHHSLQPLQGWKDWWKLVVLWXDWLRQPLJKWDOVRRFFXUEHFDXVHRIFRQFXUUHQWSURFHVVHV
ZKLFKDUHDEOHIRUWKHGXUDWLRQRIWKHGLVDEOHGFRQVWUDLQWVWRLQVHUWGDWDLQWRWKHWDEOHVWKDW
YLRODWHWKHLQWHQGHGUHIHUHQWLDOLQWHJULW\
$VDQDOWHUQDWLYH\RXPLJKWEHWHPSWHGWRWHPSRUDULO\GLVDEOHWKH)RUHLJQNH\FKHFNVE\
VHWWLQJforeign_key_checksWR]HUR:KLOHWKLVZRUNVUHJDUGLQJWKHTRUNCATE TABLE
SHUIRUPDQFHLWLVVWURQJO\GLVFRXUDJHGWRXVHWKLVRSWLRQEHFDXVHWKH)RUHLJQNH\LQWHJULW\LV
QRWUHYDOLGDWHGZKHQWKH)RUHLJQNH\FKHFNVDUHHQDEOHGDJDLQ6R\RXULVNLQFRQVLVWHQWGDWD
ZLWKUHVSHFWWRWKHUHIHUHQWLDOLQWHJULW\
'HOHWLQJDOOEXWDIUDJPHQWRIDODUJH
WDEOH
VGDWD
,QWKHSUHYLRXVUHFLSH'HOHWLQJDOOGDWDIURPODUJHWDEOHVZHGLVFXVVHGDPHWKRGRITXLFNO\
UHPRYLQJDOOGDWDIURPODUJHWDEOHVZKLOHDYRLGLQJSHUIRUPDQFHKLWV%XWH[SHULHQFHVKRZV
WKDW\RXRIWHQPXVWQRWGHOHWHDOOGDWDEXWKDYHWRUHWDLQVRPHUHFRUGVDQGGHOHWHWKHUHVW
7KHTRUNCATE TABLEFRPPDQGGRHVQRWDOORZDQ\DGGLWLRQDOFODXVHVWRGHÀQHZKLFK
UHFRUGVWRGHOHWHDQGZKLFKQRWLWDOZD\VGHOHWHVDOOHQWULHV
7KHLQWXLWLYHVROXWLRQWRWKLVZRXOGEHWRXVHDQRUPDODELETEFRPPDQGZLWKDWHEREFODXVH
WKDWRQO\PDWFKHVWKHUHFRUGVWRGHOHWH)RUODUJHWDEOHVWKLVPLJKWSURYHTXLWHDQH[SHQVLYH
RSHUDWLRQLQWHUPVRIGXUDWLRQ,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRTXLFNO\UHPRYHPRVWRI
WKHGDWDIURPODUJHWDEOHVZKLOHSUHVHUYLQJVRPHRIWKHUHFRUGV

&KDSWHU

*HWWLQJUHDG\
:HDJDLQQHHGD0\64/VHUYHUXSDQGUXQQLQJDQGD64/FOLHQWOLNHmysql)RUWKLVUHFLSH
ZHDOVRQHHGDXVHUDFFRXQWZLWKSELECTINSERTDELETEDROPDQGCREATESULYLOHJHV
IRUWKHWDUJHWGDWDEDVHZHZLOOXVHWKHsample_installXVHUWKURXJKRXWWKLVVHFWLRQ:H
ZLOOIXUWKHUPRUHXVHWKH(PSOR\HHVVDPSOHGDWDEDVHLQDQ,QQR'%FRQWH[W7KLVGDWDEDVH
ZDVLQWURGXFHGLQWKHSUHYLRXVUHFLSHDQGLVDYDLODEOHIRUIUHHRQWKH0\64/ZHEVLWH:HZLOO
XVHWKHODUJHVWWDEOHsalariesZLWKPRUHWKDQPLOOLRQUHFRUGVDVWKHWDEOHWRGHOHWH
IURP,QRXUH[DPSOHZHZLOOGHOHWHDOOUHFRUGVKDYLQJDfrom_dateEHIRUHWKHWKUHVKROGRI
'2002-01-01 00:00:00.0'
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHXVLQJD64/FOLHQWDQGWKHsample_installDFFRXQW

([HFXWHWKHIROORZLQJFRPPDQGV
mysql> use employees;
Database changed 
mysql> CREATE TABLE salaries_part
    -> SELECT * FROM salaries
    -> WHERE from_date >= "2002-01-01 00:00:00.0";
Query OK, 140930 rows affected (11.47 sec) 
Re-
cords: 140930  Duplicates: 0  Warnings: 0
mysql> TRUNCATE TABLE salaries;
Query OK, 0 rows affected (0.05 sec)
mysql> INSERT INTO salaries SELECT * from salaries_part;
Query OK, 140930 rows affected (4.63 sec)
Records: 140930  Duplicates: 0  Warnings: 0
mysql> DROP TABLE salaries_part;
Query OK, 0 rows affected (0.06 sec)

0DQDJLQJ'DWD

+RZLWZRUNV
)RUVSHHGLQJXSWKHGHOHWLRQRIPRVWRIWKHGDWDIURPDODUJHWDEOHZHXWLOL]HWKHVSHHG
DGYDQWDJHRIWKHTRUNCATE TABLEVWDWHPHQWRYHUDDELETEFRPPDQG,QGHWDLOWKHVWHSV
DUHDVIROORZV
7KHLQLWLDOUSEVWDWHPHQWLVIRUFRQYHQLHQFHRQO\VRZHGRQRWKDYHWRJLYHWKHemployees
SUHÀ[IRUHYHU\WDEOH
:LWKWKHQH[WVWDWHPHQWCREATE TABLE … SELECT * FROM …ZHVLPSO\FRS\WKHGDWD
WKDWVKRXOGQRWEHUHPRYHGWRDQHZO\FUHDWHGWDEOHsalaries_part
%HFDUHIXOWRDYRLGHUURUVZKHQLQYHUWLQJFRQGLWLRQVWRGHOHWHDOOHQWULHV
EHIRUHWLPH;\RXKDYHWRFRS\DOOUHFRUGVYDOXHVODWHURUHTXDOWR;,I
\RXFRS\RQO\UHFRUGVODWHUWKDQ;DOOUHFRUGVH[DFWO\DWWLPH;ZRXOGJHW
GHOHWHGDVZHOO
7KLVWDEOHWHPSRUDULO\KROGVWKHGDWDZKLOHZHGHOHWHDOOGDWDIURPWKHODUJHsalaries
WDEOHXVLQJTRUNCATELQWKHQH[WVWHS$IWHUZDUGVZHVLPSO\FRS\WKHSDUWLDOGDWDIURPWKH
salaries_partWDEOHEDFNLQWRWKHRULJLQDOQRZHPSWLHGsalariesWDEOH:LWKWKHÀQDO
VWHSZHVFUDSWKHsalaries_partWDEOHDJDLQDVLWLVQRWQHHGHGDQ\PRUH
<RXFRXOGDOVRFUHDWHsalaries_partDVDTEMPORARYWDEOH,Q
WKLVFDVH\RXFRXOGDOVRVNLSWKHÀQDODROPVWDWHPHQW7KLVPHWKRGLV
GLVFRXUDJHGEHFDXVHLWPLJKWOHDGWRGDWDORVVLQFDVHRIDQHUURU7KLQN
RIDQHUURUWKDWRFFXUVULJKWDIWHUDOOGDWDZDVGHOHWHGIURPWKHRULJLQDO
salariesWDEOHEXWEHIRUHWKHGDWDIURPWKHWHPSRUDU\WDEOHLV
UHVWRUHG,IWKHFRQQHFWLRQLVFORVHGWKHGDWDIURPWKHWHPSRUDU\WDEOH
LVORVW$QRQWHPSRUDU\WDEOHGRHVQRWHQWDLOWKLVULVN

&KDSWHU

7KHUH
VPRUH
:HZLOOQRWWU\WRFRQFHDOWKDWWKLVDSSURDFKKDVVRPHFDYHDWVDVZHOO)LUVWRIDOOWKHXVHU
ZKRSHUIRUPVWKLVRSHUDWLRQQHHGVVRPHDGGLWLRQDOSULYLOHJHVOLNHCREATEDQGDROPZKLFK
UHQGHUVLWXQXVDEOHIRUPDQ\XVHUVZLWKRQO\EDVLFSHUPLVVLRQV
<RXVKRXOGDOVRNHHSLQPLQGWKDWWKHXVHRIHLWKHUCREATE TABLERUTRUNCATEFDXVHV
DQDXWRPDWLFFRPPLWRIDQ\WUDQVDFWLRQFXUUHQWO\DFWLYHZKLFKEDVLFDOO\PHDQVWKDWWKLV
DSSURDFKGRHVQRWSURYLGHDQ\WUDQVDFWLRQVDIHW\
,IFRQFXUUHQWGDWDEDVHDFFHVVLVSRVVLEOHGXULQJWKHSURFHVVRIGHOHWLRQDQDGGLWLRQDO
SUREOHPFRPHVXS,QWKHSHULRGRIWLPHEHWZHHQWKHTRUNCATEDQGFRPSOHWLRQRIWKH
INSERT INTO … SELECT FROM …VWDWHPHQWVWKHsalariesWDEOHLVHPSW\IRUDQ\
RWKHUWUDQVDFWLRQ<RXKDYHWRPDNHVXUHWKDWWKLVZLOOQRWFDXVHDQ\SUREOHP<RXVKRXOG
XVHWKHDELETEDSSURDFKRWKHUZLVHDVWKLVZLOOQRWSURGXFHLQWHUPHGLDWHVWDWHVLQZKLFK
WKHGDWDEDVHWDEOHLVFRPSOHWHO\HPSW\
$QGÀQDOO\WKHSHUIRUPDQFHEHQHÀWRIWKLVDSSURDFKIRU,QQR'%JUHDWO\GHSHQGVRQWKH
VSHHGRIWKHTRUNCATE TABLEVWDWHPHQW+RZHYHULIWKHUHDUHWDEOHVWKDWUHIHUHQFHWKH
WDUJHWWDEOHZLWKD)RUHLJQNH\WKHTRUNCATEZLOOEHHTXLYDOHQWWRDDELETEVWDWHPHQWWKXV
GHVWUR\LQJDOOSHUIRUPDQFHLPSURYHPHQWV$VROXWLRQWRWKLVSUREOHPLVWRWHPSRUDULO\UHPRYH
WKH)RUHLJQNH\UHIHUHQFHV3OHDVHUHIHUWRWKH7HPSRUDULO\GLVDEOLQJ)RUHLJQNH\FRQVWUDLQWV
VHFWLRQRIWKHSUHYLRXVUHFLSHIRUDGHVFULSWLRQRIKRZWRDFKLHYHWKLV
3HUIRUPDQFHFRQVLGHUDWLRQV
$FRPSDULVRQEHWZHHQWKHPHWKRGSUHVHQWHGLQWKLVUHFLSHDQGWKHXVHRIDQRUGLQDU\
DELETEVWDWHPHQWVKRZVWKDWWKHDGYDQWDJHVGHSHQGRQWKHDPRXQWRIGDWDWKDWLVQRW
GHOHWHG7KHPRUHGDWDLVFRSLHGWRWKHSURYLVLRQDOWDEOHWKHORQJHUWKHRSHUDWLRQWDNHV7KH
DELETEVWDWHPHQWKRZHYHUEHKDYHVFRQYHUVHO\LWJHWVIDVWHULIPRUHGDWDLVGHOHWHG)URP
DFHUWDLQWKUHVKROGRQWKHQRUPDOGHOHWLRQZLOOHYHQEHIDVWHUWKDQWKH&RS\DQG7UXQFDWH
DSSURDFK$VDUXOHRIWKXPEIRU,QQR'%WDEOHVLI\RXGHOHWHWZRWKLUGVRIWKHGDWDRUPRUH
\RXFDQXVHWKH&RS\DQG7UXQFDWHPHWKRGRWKHUZLVHDVLPSOHDELETEPLJKWSURYHIDVWHU
7KLVGLIIHUVVOLJKWO\IRURWKHUVWRUDJHHQJLQHVIRU0\,6$0WKH&RS\DQG7UXQFDWHPHWKRG
W\SLFDOO\ZRUNVIDVWHULIPRUHWKDQKDOIRIWKHGDWDLVGHOHWHG6RZKHQFRQVLGHULQJDSDUWLDO
GHOHWLRQRIGDWDIURPODUJHWDEOHV\RXVKRXOGWDNHDVHFRQGWRWKLQNDERXWZKLFKDSSURDFK
ÀWVEHWWHUIRU\RXUSDUWLFXODUFLUFXPVWDQFHV

0DQDJLQJ'DWD

7KHIROORZLQJWZRGLDJUDPVFRPSDUHWKHWLPHVQHHGHGWRSDUWLDOO\GHOHWHGDWDHLWKHUXVLQJ
DVLPSOHDELETEVWDWHPHQWRUWKH&RS\DQG7UXQFDWHVROXWLRQIRUGLIIHUHQWQXPEHUVRIURZV
WKDWDUHOHIWDIWHUWKHRSHUDWLRQ7KHWDEOHRULJLQDOO\FRQWDLQVDERXWPLOOLRQURZV7KHÀUVW
ÀJXUHVKRZVWKHFRPSDULVRQIRUWKH,QQR'%VWRUDJHHQJLQH
21
141
265
644
905
1386
80
0
10
20
30
40
50
60
70
RecordsKeptx1000
Seconds
CopyandTRUNCATE
DELETE(InnoDB)
)RU0\,6$0WKH&RS\DQG7UXQFDWHPHFKDQLVPLVIDVWHUHYHQIRUODUJHUQXPEHUVRI
UHPDLQLQJURZV

&KDSWHU

'HOHWLQJDOOGDWDLQFUHPHQWDOO\IURP
ODUJHWDEOHV
,QWKHSUHYLRXVUHFLSH'HOHWLQJDOOEXWDIUDJPHQWRIDODUJHWDEOH
VGDWDZHGLVFXVVHG
DPHWKRGWRTXLFNO\UHPRYHDOOEXWDVPDOOUHPDLQGHURIUHFRUGVIURPDODUJHWDEOH7KH
GRZQVLGHRIWKHDSSURDFKSUHVHQWHGWKHUHLVWKHIDFWWKDWGXULQJWKHSURFHVVRIGHOHWLRQ
WKHWDEOHWHPSRUDULO\DSSHDUVFRPSOHWHO\HPSW\WRDQREVHUYHU8QIRUWXQDWHO\WKLVLVRIWHQ
QRWDFFHSWDEOHHVSHFLDOO\LI\RXUGDWDEDVHLVXVHGLQDQHQYLURQPHQWZLWKPDQ\SDUDOOHO
SURFHVVHVFRQFXUUHQWO\DFFHVVLQJWKHGDWDEDVHSDUWLFXODUO\WKHODUJHWDEOHGLVFXVVHGKHUH
2QWKHRWKHUKDQGWKHDOWHUQDWLYHRIVLPSO\XVLQJDDELETEVWDWHPHQWLVVRPHWLPHVQRW
DFFHSWDEOHHLWKHU$DELETEVWDWHPHQWWHPSRUDULO\FUHDWHVORFNVRQWKHHQWULHVWKDWDUH
GHOHWHG$VDUHVXOWIRUWKHGXUDWLRQRIWKHGHOHWLRQDPDMRUSDUWRIWKHWDEOHJHWVORFNHG
WKXVSUHYHQWLQJFRQFXUUHQWDFFHVVWRWKHWDEOHE\RWKHUSURFHVVHV7KLVW\SLFDOO\OHDGVWR
WLPHRXWVLWXDWLRQVDQGRWKHUHUURUVDVLQWKHIROORZLQJH[DPSOH
64/FOLHQW
64/FOLHQW
DELETE FROM employees.salaries 
WHERE emp_no < 485000;
INSERT INTO salaries VALUES(10001, 
0, "2010-01-01", "2099-12-31"); 
=> ERROR 1205 (HY000): Lock wait 
timeout exceeded; try restarting 
transaction 
=> Query OK, 2702167 rows affected 
(1 min 11.85 sec) 
7KHIROORZLQJUHFLSHVKRZVDQDSSURDFKWRGHOHWLQJGDWDIURPODUJHWDEOHVZLWKRXWEORFNLQJ
DFFHVVWRWKHWDEOH
VGDWDIRUWRRORQJVRWKHGHOHWLRQFDQKDSSLO\EHSHUIRUPHGGHVSLWH
FRQFXUUHQWWDVNVVLPXOWDQHRXVO\DFFHVVLQJWKHYHU\VDPHWDEOH
*HWWLQJUHDG\
$VWKHUHFLSHXVHVDVWRUHGSURFHGXUHZHDJDLQQHHGDXVHUDFFRXQWZLWKWKHCREATE 
ROUTINESULYLOHJHDVZHOODVWKHDELETESHUPLVVLRQIRUWKHWDUJHWGDWDEDVH7KURXJKRXW
WKHIROORZLQJVWHSVZHZLOODJDLQDVVXPHsample_installDVWKHXVHU7KHH[DPSOHWDEOH
IRUGHOHWLRQLVsalariesIURPWKHemployeesVDPSOHGDWDEDVHVHHSUHYLRXVUHFLSHV
RQFHPRUH,QRXUH[DPSOHZHZLOOGHOHWHDOOHQWULHVIURPWKHWDEOHZLWKDQHPSOR\HHQXPEHU
emp_noEHORZ485000

0DQDJLQJ'DWD

+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHXVLQJWKHsample_installDFFRXQW

(QWHUWKHIROORZLQJ64/VWDWHPHQWV
mysql> delimiter //
mysql> CREATE PROCEDURE employees.delete_incrementally()
    -> MODIFIES SQL DATA
    -> BEGIN
    ->   REPEAT
    ->  DELETE FROM employees.salaries
    ->  WHERE emp_no < 485000
    ->  LIMIT 20000;
    ->   UNTIL ROW_COUNT() = 0 END REPEAT;
    -> END //
Query OK, 0 rows affected (0.00 sec)
mysql> delimiter ;
mysql> CALL employees.delete_incrementally();
Query OK, 0 rows affected, 137 warnings (3 min 58.09 sec)
+RZLWZRUNV
7KHDERYHVWHSVVLPSO\FUHDWHDVWRUHGSURFHGXUHQDPHGdelete_incrementally()
ZKLFKFDQEHXVHGWRGHOHWHFHUWDLQUHFRUGVIURPWKHWDEOHsalaries
7KHDELIMITERVWDWHPHQWVDWVWDUWDQGHQGRIWKHVFULSWDUHQHFHVVDU\WRGHÀQHDVWRUHG
SURFHGXUHDVWKHVWDWHPHQWVZRXOGRWKHUZLVHEHH[HFXWHGULJKWDZD\7KHSURFHGXUH
GHÀQLWLRQLWVHOILVSUHWW\VWUDLJKWIRUZDUGDQGEDVLFDOO\FRQVLVWVRIDREPEAT …  UNTILORRS
WKDWGHOHWHVGDWDIURPWKHVDODULHVWDEOHDFFRUGLQJWRWKHJLYHQFRQGLWLRQWHERE emp_no 
< 4850007KHVSHFLDOSDUWRIWKLVDELETEVWDWHPHQWLVWKHLIMITFODXVHZKLFKGHÀQHV
WKDWQRPRUHWKDQURZVVKRXOGEHGHOHWHG7KLVVWDWHPHQWLVH[HFXWHGE\WKHORRSDV
ORQJDVWKHUHDUHDQ\UHFRUGVOHIWWRGHOHWH$VVRRQDVWKHQXPEHURIUHFRUGVDIIHFWHGE\WKH
DELETEVWDWHPHQWZKLFKFDQEHUHWULHYHGXVLQJWKHROW_COUNT()IXQFWLRQLV]HURWKH
ORRSHQGV
7KHWULFNXVHGE\WKLVDSSURDFKLVWRGLVWULEXWHWKHSHULRGRIWLPHQHHGHGWRGHOHWHWKHGDWD
IURPRQHEORFNWRPXOWLSOHLQWHUYDOV

&KDSWHU

,QVXPWKHLQFUHPHQWDOGHOHWLRQLQVWHSVRIDFWXDOO\LV
FRQVLGHUDEO\VORZHUWKDQDVLQJOHDELETEVWDWHPHQWEXWLWLVPXFK
PRUHFRRSHUDWLYHZKHQLWFRPHVWRFRQFXUUHQWZULWHDFFHVVWRWKH
VDPHGDWD
7KHEHQHÀWOLHVZLWKLQWKHIDFWWKDWHYHU\VLQJOHSDUWLDODELETEVWDWHPHQWGRHVQRWUXQYHU\
ORQJZKLFKGUDVWLFDOO\UHGXFHVWKHSHULRGRIWLPHLQZKLFKORFNVDUHKHOGIRUSDUWVRIWKHWDEOH
7KLVEDVLFDOO\HOLPLQDWHVWKHORFNLQJSUREOHPVEHWZHHQGHOHWLRQDQGRWKHUSURFHVVHV
64/FOLHQW
64/FOLHQW
CALL delete_incrementally();
INSERT INTO salaries VALUES(10001, 
0, "2010-01-01", "2099-12-31"); 
=> Query OK, 1 row affected (0.67 
sec)
UPDATE salaries
SET salary=salary+300
WHERE emp_no < "490000";
Query OK, 2669890 rows affected 
(59.63 sec)
Rows matched: 2669890  Changed: 
2669890  Warnings: 0
=> Query OK, 2702167 rows affected 
(1 min 11.85 sec) 
$V\RXFDQVHHHYHQZKLOHWKHGHOHWLRQVWLOOUXQVWKHSDUDOOHOPRGLÀFDWLRQVWRWKHGDWDEDVH
ZRUNFRQFXUUHQWO\ZLWKRXWORFNZDLWWLPHRXWHUURUVRUVLPLODUSUREOHPV
7KHUH
VPRUH
:KLOHW\SLFDOO\WKHLQFUHPHQWDOGHOHWLRQLVVORZHUWKDQRQHVLQJOHGHOHWHRSHUDWLRQWKLVFDQ
FKDQJHXQGHUKHDY\ORDGIRU,QQR'%WDEOHVSDUDOOHOWUDQVDFWLRQVZRUNRQDVQDSVKRWRI
WKHFXUUHQWGDWDDWWKHSRLQWLQWLPHZKHQWKHWUDQVDFWLRQVWDUWV7KLVIHDWXUHLVSURYLGHGE\
,QQR'%
V0XOWL9HUVLRQ&RQFXUUHQF\&RQWURO09&&

0DQDJLQJ'DWD

:LWKPDQ\WUDQVDFWLRQVDQGODUJHDPRXQWVRIGDWDWKHGLIIHUHQFHEHWZHHQWKHVQDSVKRWVDQG
WKHGHOHWHGGDWDKDVWREHPDLQWDLQHGE\0\64/7KLVKRXVHNHHSLQJGDWDLVNHSWXQWLOWKHODVW
WUDQVDFWLRQWKDWZDVRSHQHGEHIRUHWKHGHOHWLRQZDVFRPSOHWHGLVFORVHG7KHDGPLQLVWUDWLRQ
RIWKLVGHOWDPLJKWKDYHQHJDWLYHLPSDFWRQWKHRYHUDOO0\64/SHUIRUPDQFH:LWKLQFUHPHQWDO
GHOHWLRQWKLVGHOWDGDWDW\SLFDOO\GRHVQRWJURZDVELJDVZLWKDORQJUXQQLQJGHOHWHVWDWHPHQW
ZKLFKRIWHQUHGXFHVWKHSHUIRUPDQFHKLW
8QGHUKHDY\ORDGWKHLQFUHPHQWDOGHOHWLRQDSSURDFKPLJKWDFWXDOO\
FDXVHDJDLQLQRYHUDOOSHUIRUPDQFH
6HHDOVR
f
'HOHWLQJDOOEXWDIUDJPHQWRIDODUJHWDEOH
VGDWD
f
'HOHWLQJDOOGDWDIURPODUJHWDEOHV


0RQLWRULQJDQG
$QDO\]LQJD0\64/
,QVWDOODWLRQ
,QWKLVFKDSWHUZHZLOOGLVFXVVVRPHUHFRPPHQGDWLRQVRQKRZWRPRQLWRU\RXU0\64/LQVWDOO
DWLRQDQGKRZWRDQDO\]HSRVVLEOHSUREOHPV,QGHWDLOWKHIROORZLQJWRSLFVZLOOEHFRYHUHG
f
&KHFNLQJIUHH,QQR'%WDEOHVSDFH
f
(VWDEOLVKLQJDOHUWLQJPHFKDQLVPVIRUORZUHPDLQLQJWDEOHVSDFHE\XVLQJWULJJHUV
f
(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQWV
f
,GHQWLI\LQJDQGFKDQJLQJ0\64/YDULDEOHV
f
$VVHVVLQJWKHRYHUDOOWDEOHFRXQW
f
)LQGLQJWKHELJJHVWWDEOHV
f
)LQGLQJDOOFROXPQVZLWKDFHUWDLQQDPHDQGRUW\SH
f
)LQGLQJDOOWDEOHVUHIHUHQFLQJHDFKRWKHU
,QWURGXFWLRQ
(YHQLI0\64/LVHDV\WRVHWXSDQGUHTXLUHVUHODWLYHO\OLWWOHPDLQWHQDQFHRQFHLWLVXS
DQGUXQQLQJWKHUHDUHVLWXDWLRQVLQZKLFKLWLVQHFHVVDU\WRFKHFNFHUWDLQDVSHFWVRI
0\64/³HLWKHUWRLGHQWLI\DQGVROYHFHUWDLQSUREOHPVIRUH[DPSOHSHUIRUPDQFHSUREOHPV
RUSUHIHUDEO\WRSUHYHQWWURXEOHLQWKHÀUVWSODFH7KLVFKDSWHUZLOOLQWURGXFHVRPHWHFKQLTXHV
WKDWPLJKWSURYHXVHIXOIRUPDLQWDLQLQJ\RXUGDWDEDVHVR\RXKDYHVRPHWRROVDWKDQGWR
HQVXUHFRQWLQXRXVSUREOHPIUHHRSHUDWLRQRI\RXU0\64/LQVWDOODWLRQ

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

&KHFNLQJIUHH,QQR'%WDEOHVSDFH
2QHRIWKHPRVWFRPPRQSUREOHPVIRUGDWDEDVHDGPLQLVWUDWRUVLVWRGHDOZLWKWKHFRQVWDQW
GDWDJURZWKPRVWGDWDEDVHVZLOOGLVSOD\<RXKDYHWRNHHSDQH\HRQWKHUHPDLQLQJVSDFH
DYDLODEOHWRDYRLGWKHVLWXDWLRQZKHUHQRVSDFHLVOHIWWRDGGQHZGDWD$QRXWRIVSDFH
VFHQDULRW\SLFDOO\OHDGVWRDGHIDFWREUHDNGRZQRI\RXUGDWDEDVH
7KHGHIDXOWVWRUDJHHQJLQHRI0\64/LV0\,6$0ZKLFKVWRUHVLWVGDWDLQSODLQÀOHV)RUHDFK
WDEOHDVHSDUDWHÀOHLVFUHDWHG7KHÀOH
VVL]HLVDGDSWHGDFFRUGLQJWRWKHGDWDVWRUHGLQLW
,IPRUHGDWDLVZULWWHQWRWKHWDEOHWKHÀOHJHWVELJJHU,QFDVHRIGDWDUHGXFWLRQWKHIUHHG
VSDFHFDQEHUHFODLPHGE\XVLQJWKHOPTIMIZETABLEFRPPDQGZKLFKUHVXOWVLQDVPDOOHU
ÀOHVL]H7KLVZD\LWLVDVWUDLJKWIRUZDUGWDVNWRFKHFNKRZPXFKVSDFHLVOHIWIRUIXUWKHUGDWD
JURZWK\RXMXVWKDYHWRWDNHDORRNDWWKHVSDFHOHIWRQWKHGULYH\RXUGDWD\RXU0\,6$0
GDWDVSHFLÀFDOO\LVVWRUHGLQ
)RUWKHDOWHUQDWLYHVWRUDJHHQJLQH,QQR'%WKLVTXHVWLRQLVQRWVRHDV\WRDQVZHU7KH
IROORZLQJUHFLSHZLOOVKRZ\RXKRZWRUHWULHYHWKLVLQIRUPDWLRQ
*HWWLQJUHDG\
)RUWKLVUHFLSHZHZLOOQHHGD0\64/XVHUZKRKDVSELECTDFFHVVWRDOOVFKHPDWDLQ
WKH0\64/LQVWDOODWLRQ:HDVVXPHWKHadmin4mysqlDFFRXQWLVXVHGWKURXJKRXWWKH
IROORZLQJVWHSV
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHXVLQJWKHadmin4mysqlDFFRXQW

(QWHUWKHIROORZLQJ64/VWDWHPHQW
SELECT DATA_FREE/(1024*1024) AS FREE_MB, TABLE_SCHEMA, TABLE_NAME 
FROM  INFORMATION_SCHEMA.TABLES WHERE ENGINE="InnoDB";

5HDGWKHUHPDLQLQJIUHHWDEOHVSDFHLQ0%\WHVIURPWKHUHVXOWV

&KDSWHU

+RZLWZRUNV
7KHVWDWHPHQWHQWHUHGLQVWHSVLPSO\UHDGVWKHDATA_FREEFROXPQIURPWKHWDEOH
INFORMATION_SCHEMA.TABLESDQGGLVSOD\VLWLQDFRQYHQLHQWZD\LQFOXGLQJDGRZQVFDOLQJ
WRVKRZ0%\WHVLQVWHDGRIE\WHV)RUHDFKWDEOHLQHDFKVFKHPDWKHUHPDLQLQJIUHH
WDEOHVSDFHLVVKRZQLQ0%\WH
$V\RXKDYHQRWLFHGPRVWWDEOHVLQWKHDERYHH[DPSOHVKRZWKHLGHQWLFDOYDOXHRI
0%\WHV7KLVLVGXHWRWKHIDFWWKDWDOOWKHVHWDEOHVDUHVWRUHGLQDVKDUHG0\64/WDEOHVSDFH
DVGHÀQHGE\WKHinnodb_data_home_dirYDULDEOH)RUPRVW,QQR'%LQVWDOODWLRQVWKLVZLOO
EHWKHW\SLFDOVHWXSDOOGDWDLVVWRUHGLQDFRPPRQWDEOHVSDFHWKXVDOOWDEOHVZLOOVKRZWKH
LGHQWLFDOYDOXHIRUUHPDLQLQJWDEOHVSDFH
,QRXUH[DPSOHKRZHYHUWKHÀUVWWDEOHVKRZVDGLIIHUHQWYDOXH7KLVLVEHFDXVHWKLVWDEOHZDV
FUHDWHGLQDWDEOHVSHFLÀFWDEOHVSDFHZKLFKFDQEHDFKLHYHGE\XVLQJWKHinnodb_file_
per_tableSDUDPHWHULQWKH0\64/FRQÀJXUDWLRQ$OOWDEOHVWKDWDUHFUHDWHGZLWKWKLVVHWWLQJ
DUHFUHDWHGLQVHSDUDWHÀOHV7KHÀOHVDUHH[WHQGHGLQVL]HDVQHHGHGEXWDUHQRWVKUXQN
DXWRPDWLFDOO\LIGDWDLVGHOHWHGIURPWKHWDEOH
7KHYDOXHUHWULHYHGE\WKHDERYHUHFLSHVKRZVWKHVL]HDYDLODEOHZLWKWKHFXUUHQWÀOHVL]HV
ERWKIRUVKDUHGDQGÀOHSHUWDEOHWDEOHVSDFH,IDXWRH[WHQGLQJWDEOHVSDFHVDUHXVHG
WKHUHPDLQLQJVSDFHRQWKHÀOHV\VWHPKDVWREHDGGHGWRWKLVYDOXHWRFDOFXODWHWKHWUXH
DYDLODEOHVSDFH

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

5HPDLQLQJDXWRH[WHQGVSDFH )UHHWDEOHVSDFH5HPDLQLQJÀOH
V\VWHPVSDFH
$XWRH[WHQGLQJWDEOHVSDFHLVLQSODFHZKHQWKHinnodb_file_per_tableVHWWLQJLVXVHGRU
LIWKHinnodb_data_home_dirGHÀQLWLRQLQFOXGHVDQDXWRH[WHQGVXIÀ[
1RWHWKDWIRUinnodb_data_home_dirWKHGHIDXOWYDOXH
ibdata1:10M:autoextendLVXVHGZKLFKPHDQVDXWRPDWLF
H[WHQVLRQLVLQSODFH
,QWKHVHFDVHVWKHIUHHWDEOHVSDFHYDOXHGLVFXVVHGDERYHLVQRWWKHRQO\UHOHYDQWYDOXH
\RXVKRXOGDGGLWLRQDOO\HVWDEOLVKDPRQLWRULQJIRUWKHDYDLODEOHVSDFHRQWKHGLVNGHYLFHWKH
WDEOHVSDFHÀOHVDUHVWRUHGRQ
3OHDVHQRWHWKDWIRUERWKautoextendDQGinnodb_file_per_table
WKHWDEOHVSDFHZLOOEHH[WHQGHGDVQHHGHGEXWRQFHWKHVSDFHLVDOORFDWHG
IRU,QQR'%XVHLWZLOOQRWEHUHOHDVHGDXWRPDWLFDOO\LIOHVVVWRUDJHLVQHHGHG
:LWKinnodb_file_per_tableXQXVHGWDEOHVSDFHFDQEHUHOHDVHGE\
H[HFXWLQJDQOPTIMIZETABLEFRPPDQGUHVXOWLQJLQVPDOOHU
WDEOHVSDFHÀOHV
7KHUH
VPRUH
7KHDERYHDSSURDFKZLOORQO\ZRUNIRU0\64/YHUVLRQRUKLJKHUDVWKHVH YHUVLRQVH[SRVH
WKHUHPDLQLQJ,QQR'%WDEOHVSDFHLQWKH DATA_FREEFROXPQRIINFORMATION_SCHEMA.
TABLES7RUHWULHYHWKHGDWDIURPYHUVLRQVEHIRUHWKDW\RXZLOOKDYHWRWDNHDORRNDWWKH
TABLE_COMMENTFROXPQ
1RWHWKDWWKHYDOXHVDUHJLYHQLQ.%QRWLQE\WHVDVLQWKHDATA_FREEFROXPQ

&KDSWHU

$QDOWHUQDWLYHZD\WRUHWULHYHWKLVLQIRUPDWLRQZLWKRXWH[SOLFLWO\DFFHVVLQJINFORMATION_
SCHEMALVWRXVHWKHSHOW TABLE STATUSFRPPDQGZKLFKVKRZVWKHVWDWXVLQFOXGLQJWKH
FRPPHQWIRUHDFKWDEOHLQWKHFXUUHQWO\VHOHFWHGVFKHPD
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
(VWDEOLVKLQJDOHUWLQJPHFKDQLVPVIRUORZ
UHPDLQLQJWDEOHVSDFHE\XVLQJWULJJHUV
,QWKHSUHYLRXVUHFLSHZHLQWURGXFHGDZD\WRUHDGWKHUHPDLQLQJ,QQR'%WDEOHVSDFH:KLOHLW
LVLPSRUWDQWWRKDYHWKLVLQIRUPDWLRQDWKDQGLQDSURIHVVLRQDOVHWWLQJ\RXZLOOKDYHWRPDNH
VXUHWKDW\RXUGDWDEDVHZLOOQRWUXQRXWRIWDEOHVSDFH7RDYRLGKDYLQJWRPDQXDOO\FKHFNWKH
UHPDLQLQJWDEOHVSDFHRQDUHJXODUEDVLV\RXKDYHEHWWHUWKLQJVWRGRHVSHFLDOO\RQZHHNHQGV
DQGRQYDFDWLRQULJKW"DQDXWRPDWLFPRQLWRULQJPHFKDQLVPLVQHHGHG
,WLVQRWLQWKHVFRSHRIWKLVERRNWRGHVFULEHKRZWRHVWDEOLVKDZRUNLQJPRQLWRULQJDQG
DOHUWLQJLQIUDVWUXFWXUH2QPRVWSODWIRUPV\RXZLOOKDYHPHDQVWRPRQLWRUIRUFHUWDLQ
FRQGLWLRQVDQGRUDOHUWSHRSOHRUJURXSVUHVSRQVLEOHIRUDSDUWLFXODULVVXH7\SLFDOH[DPSOHV
IRUDOHUWLQJVROXWLRQVDUHWKLUGSDUW\SURGXFWVOLNH1DJLRV,QVLJKW0DQDJHURU2SHQ9LHZRU
HYHQWKHJRRGROGHPDLO$OHUWVFDQEHWULJJHUHGIRUH[DPSOHE\WULJJHUÀOHVFHUWDLQV\VWHP
ORJHQWULHV6103RUVSHFLÀFFOLHQWV
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRHVWDEOLVKDPRQLWRULQJPHFKDQLVPIRUUHPDLQLQJ
,QQR'%WDEOHVSDFHWKDWFDQHDVLO\EHDGDSWHGWRXVHWKHDOHUWLQJPHFKDQLVPRI\RXUFKRLFH
1RWHWKDWWKLVUHFLSHLVWDUJHWHGDWLQVWDOODWLRQVZLWKDÀ[HG,QQR'%
WDEOHVSDFHVL]H6FHQDULRVWKDWUHO\RQWKHDXWRH[WHQGIHDWXUHRI
,QQR'%KDYHWRWDNHWKHDYDLODEOHÀOHV\VWHPVSDFHLQWRDFFRXQWDVZHOO
*HWWLQJUHDG\
)LUVWRIDOO\RXZLOOKDYHWRFRPHXSZLWKDWKUHVKROGYDOXHIRU\RXUIUHHWDEOHVSDFHLIWKH
DYDLODEOHIUHHWDEOHVSDFHGURSVEHORZWKLVWKUHVKROGDQDOHUWZLOOEHUDLVHG
SHUFHQWLVDVHQVLEOHVWDUWLQJSRLQWIRUDWDEOHVSDFHDOHUWEXWWKLVYDOXH
VKRXOGEHDGDSWHGDFFRUGLQJWR\RXUQHHGV'DWDÁXFWXDWLRQDQGUHVSRQVH
WLPHIRUDOHUWVKDYHWREHWDNHQLQWRDFFRXQW

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

7KURXJKRXWWKLVUHFLSHZHZLOODVVXPHDÀ[HGVL]H,QQR'%WDEOHVSDFHRI*%DQGD
WKUHVKROGYDOXHRI*%
:HZLOODGGLWLRQDOO\QHHGD0\64/XVHUZLWKDGPLQLVWUDWLYHSULYLOHJHVIRUWKHIROORZLQJ
H[DPSOHZHZLOOXVHWKHadmin4mysqlDFFRXQWDJDLQ
$QGÀQDOO\\RXZLOOKDYHWRJLYHDGLUHFWRU\RQ\RXUVHUYHU
VÀOHV\VWHPLQWR
ZKLFKWRZULWHWKHWULJJHUÀOHWKDWLVQRWXVHGE\RWKHUDSSOLFDWLRQVZHZLOO
DVVXPHC:/temp/MySQLMonitoring/LQWKHIROORZLQJVWHSV
7KHUHFLSHPDNHVXVHRI0\64/
VVFKHGXOHUIHDWXUHVRLWUHTXLUHV0\64/
YHUVLRQRUJUHDWHU
+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVH

(QWHUWKHIROORZLQJFRPPDQGVWRFUHDWHDVWRUHGSURFHGXUHWRFKHFNIRU
ORZWDEOHVSDFH
mysql> delimiter // 
mysql> CREATE PROCEDURE mysql.check_innodb_ts()
    -> BEGIN
    ->  SELECT MIN(DATA_FREE) FROM INFORMATION_SCHEMA.TABLES
    ->          WHERE ENGINE="InnoDB" INTO @free;
    ->  SET @threshold := 2*1024*1024*1024;
    ->  SET @fileprefix := "C:/log/innodb_free_ts_alert_";
    ->  SELECT DATE_FORMAT(NOW(), "%Y_%m_%d_%H%i%s")
    ->          INTO @timestamp_suffix;
    ->  SELECT CONCAT(@fileprefix, @timestamp_suffix)
    ->          INTO @filename;
    ->  SELECT CONCAT(
    ->          "Free InnoDB table space (",
    ->          @free,
    ->          ") is below warning threshold (",
    ->          @threshold,
    ->          ").") INTO @warning;
    ->  SELECT CONCAT(
    ->          "SELECT @warning INTO OUTFILE '",
    ->          @filename,
    ->          "';") INTO @command;
    ->  IF @free < @threshold THEN

&KDSWHU

    ->          PREPARE statement FROM @command;
    ->          EXECUTE statement;
    ->  END IF;
    -> END //
Query OK, 0 rows affected (0.00 sec)
mysql> delimiter ;

8VHWKHIROORZLQJFRPPDQGVWRVFKHGXOHWKHWDEOHVSDFHFKHFN
mysql> CREATE EVENT mysql.check_innodb_ts_event
    ->  ON SCHEDULE EVERY 15 MINUTE
    ->  DO CALL mysql.check_innodb_ts();
Query OK, 0 rows affected (0.00 sec)

&RQÀJXUH\RXUSODWIRUPVSHFLÀFPRQLWRULQJDOHUWLQJPHFKDQLVPWRVFDQIRUÀOHV
QDPHGinnodb_free_ts_alert_*LQWKHC:/log/GLUHFWRU\³LIDÀOHH[LVWVDQ
DOHUWVKRXOGEHUDLVHG
+RZLWZRUNV
,QVWHSDVWRUHGSURFHGXUHQDPHGmysql.check_innodb_ts()LVFUHDWHGZKLFK
FKHFNVWKHUHPDLQLQJ,QQR'%WDEOHVSDFHDJDLQVWDWKUHVKROGYDOXHKHUH*%JLYHQDVDQ
DULWKPHWLFH[SUHVVLRQ2 * 1024 * 1024 * 1024,IWKHVSDFHLVEHORZWKHWKUHVKROG
YDOXHDÀOHZLWKDJLYHQQDPHSUHÀ[DQGWKHWLPHVWDPSDVDQDPHVXIÀ[LVZULWWHQWRWKH
C:/log/GLUHFWRU\7KHÀOHFRQWDLQVDQDOHUWPHVVDJHWKDWVWDWHVWKHDFWXDODVZHOODVWKH
WKUHVKROGYDOXH
6WHSFUHDWHVDVFKHGXOHGHYHQWQDPHGmysql.check_innodb_ts_eventZKLFK
FDXVHVWKHVWRUHGSURFHGXUHGHÀQHGLQVWHSWREHH[HFXWHGDXWRPDWLFDOO\HYHU\PLQXWHV
WKH0\64/VFKHGXOHUKDVWREHHQDEOHGVHH7KHUH
VPRUHEHORZ<RXVKRXOGDGDSWWKLV
LQWHUYDODFFRUGLQJWR\RXUQHHGVEXWNHHSLQPLQGWKDWORQJHULQWHUYDOVZLOOLQFUHDVHWKH
SUREDELOLW\WKDWDVXGGHQSHDNLQGDWDJURZWKPLJKWÀOOXS\RXUGDWDEDVHEHIRUH\RXUDOHUW
ÀUHV2QWKHRWKHUKDQGDVKRUWHULQWHUYDOZLOOEHDWWKHFRVWRIDQLQFUHDVHGVHUYHUORDG
LQGXFHGE\WKHPRQLWRULQJPHFKDQLVP<RXZLOOKDYHWREDODQFHWKHVHDVSHFWVWRÀQGWKHEHVW
VROXWLRQIRU\RXUHQYLURQPHQW
6WHSVKRXOGEHFRQVLGHUHGDSODFHKROGHUIRUWKHUHVSHFWLYHVWHSVUHTXLUHGWRSURGXFHDQ
DOHUWLQ\RXUVSHFLÀFHQYLURQPHQW,I\RXUPRQLWRULQJWRROLVQRWDEOHWRFKHFNIRUWKHH[LVWHQFH
RIÀOHVZLWKDVSHFLÀFÀOHSDWWHUQC:\log\innodb_free_ts_alert_*LQRXUH[DPSOH\RX
PLJKWKDYHWRLQWURGXFHDQLQWHUPHGLDWHOD\HUWKDWFKHFNVIRUWKHWULJJHUÀOHVFUHDWHGE\WKH
0\64/HYHQWVFKHGXOHURQDUHJXODUEDVLV$QH[DPSOHIRUD:LQGRZVHQYLURQPHQWFRXOGEH
WRGHÀQHDVFKHGXOHGWDVNWKDWH[HFXWHVDFRPPDQGOLQHVFULSWDORQJWKHOLQHVRI
IF EXIST "C:\log\innodb_free_ts_alert_*" (alert.exe "Table space 
low!")

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

)RU8QL[OLNHV\VWHPVDEDVKVFULSWOLNHWKHIROORZLQJUXQE\DFURQMREZRXOGKDYHD
VLPLODUHIIHFW
files=$(ls /log/innodb_free_ts_alert_* 2> /dev/null) 
if [ $files ]; then /etc/bin/alert "Table space low!"; fi
)RUWKHVHH[DPSOHValert.exeDQG/etc/bin/alertKDYHWREHUHSODFHGE\WKHWRROVRI
\RXUFKRLFHWRUDLVHDQDOHUW
7KHUH
VPRUH
)RUWKHVDNHRIEUHYLW\VRPHSUHUHTXLVLWHVDQGIXUWKHURSWLRQVIRULPSURYHPHQWZHUHQRWIXOO\
GLVFXVVHGLQWKHDERYHUHFLSH7KHIROORZLQJVHFWLRQVZLOOVKRZ\RXKRZWRPDNHVXUHWKH
SUHUHTXLVLWHVDUHJLYHQDQGKRZWRHDVHIXWXUHFKDQJHVLQFRQÀJXUDWLRQ
(QDEOLQJWKH0\64/VFKHGXOHU
7KHVFKHGXOHGHYHQWIURPVWHSUHOLHVRQDUXQQLQJ0\64/VFKHGXOHU
7KHVFKHGXOHUIHDWXUHKDVEHHQDYDLODEOHVLQFHYHUVLRQ
VRWKHUHFLSHGRHVQRWIXOO\ZRUNZLWK0\64/RU
ORZHU
$VWKHVFKHGXOHULVQRWHQDEOHGE\GHIDXOWHYHQLQ0\64/\RXVKRXOGPDNHVXUHWKDW\RXU
FRQÀJXUDWLRQFRQWDLQVWKHVHWWLQJevent_scheduler=ONLQWKH[mysqld]VHFWLRQRI\RXU
0\64/FRQÀJXUDWLRQÀOH$OWHUQDWLYHO\\RXFDQHQDEOHWKHVFKHGXOHUXVLQJWKHSET GLOBAL 
event_scheduler = ON;FRPPDQG
,I\RXKDSSHQWRZRUNZLWKDYHUVLRQRI0\64/WKDWGRHVQRWVXSSRUWWKHVFKHGXOHURULIIRU
DQ\UHDVRQ\RXFDQQRWHQDEOHWKH0\64/VFKHGXOHULQ\RXULQVWDOODWLRQ\RXVKRXOGFRQVLGHU
HVWDEOLVKLQJDVFKHGXOHGWDVNIRU:LQGRZVRUDFURQMREIRU8QL[/LQX[ZKLFKH[HFXWHV
WKHCALL mysql.check_innodb_ts();FRPPDQGXVLQJWKH-eRSWLRQRIWKHP\VTO
FRPPDQGOLQHFOLHQW
,PSURYLQJFRQÀJXUDWLRQ
$VWKHVWRUHGSURFHGXUHGHÀQHGLQVWHSFRQWDLQVVRPHKDUGFRGHGYDOXHVPRVWLPSRUWDQWO\
WKUHVKROGDQGÀOHSUHÀ[LWLVKDUGWRDGDSWWKRVHYDOXHVWRFKDQJHGQHHGVIRUH[DPSOH
LIWKHWKUHVKROGVKRXOGEHFKDQJHG7KXV\RXFRXOGFRQVLGHUUHDGLQJWKHVSHFLÀFYDOXHV
IURPDFRQÀJXUDWLRQWDEOHXVLQJWKHSELECT … INTO @variableQRWDWLRQ7RFKDQJHD
FRQÀJXUDWLRQYDOXHWKHVWRUHGSURFHGXUHFDQEHOHIWXQFKDQJHG\RXRQO\QHHGWRXSGDWHWKH
YDOXHVLQ\RXUFRQÀJXUDWLRQWDEOH

&KDSWHU

6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV&KDSWHU0\64/
8VHU0DQDJHPHQW
(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQWV
:KHQSODQQLQJDGDWDEDVHLQVWDOODWLRQRQHSUREOHPWKDWFRPHVXSSUHWW\VRRQLVKRZPXFK
GULYHVSDFHVKRXOGEHUHVHUYHGIRUWKHGDWD7KLVLVDQLPSRUWDQWDVSHFWWRFRQVLGHULQWHUPV
RIUHOLDELOLW\EHFDXVHLIWKHUHVHUYHGVSDFHLVWRRVPDOO\RXUGDWDEDVHPLJKWJULQGWRDKDOW
LIQRVSDFHLVOHIWWRVWRUHDGGLWLRQDOGDWD2QWKHRWKHUKDQGWRGD\
VFRVWSUHVVXUHZLOORIWHQ
QRWDOORZIRUGHPDQGVWKDWDUHQRWEDVHGRQDWUDFHDEOHPHWKRGRIGHPDQGHVWLPDWLRQ7KH
IROORZLQJUHFLSHZLOOSUHVHQWDQDSSURDFKWKDWDOORZVIRUDUHDOLVWLFHVWLPDWHRIWKHVWRUDJH
UHTXLUHPHQWVRI\RXUGDWDEDVH
*HWWLQJUHDG\
)RUWKHIROORZLQJUHFLSH\RXZLOOQHHGWRKDYHVRPHLQIRUPDWLRQDWKDQG
f
7KHWDEOHVWUXFWXUHRI\RXUGDWDEDVH
f
$QHVWLPDWHRIWKHPD[LPXPQXPEHURIUHFRUGVIRUHDFKWDEOHWDNHGDWDJURZWK
LQWRDFFRXQW
f
5HSUHVHQWDWLYHVDPSOHUHFRUGVIRUHDFKWDEOHWKHPRUHWKHEHWWHU
&KRRVLQJVDPSOHYDOXHVIRUYDULDEOHOHQJWKFROXPQVFDUHIXOO\
:KHQWKLQNLQJDERXWVDPSOHUHFRUGVIRU\RXUWDEOHVWKLQNDERXW
UHDVRQDEOHYDOXHVIRUFROXPQVZLWKGDWDW\SHVRIYDULDEOH
OHQJWKOLNHVARCHARRUBLOB7KHOHQJWKRIWKHYDOXHVVKRXOG
PDWFKWKHDYHUDJHVL]HRIWKHH[SHFWHGYDOXHVRIWKHSURGXFWLYH
GDWDEDVH,I\RXFDQQRWJLYHDYDOLGHVWLPDWHZHSURSRVHWRXVH
VDPSOHYDOXHVKDOIDVORQJDVWKHPD[LPXP
)RULQWHUQDWLRQDORSHUDWLRQVWDNH8QLFRGHHQFRGLQJRIVARCHAR
YDOXHVLQWRDFFRXQW,I\RXKDYHWRGHDOZLWKFKDUDFWHUVHWVOLNH
IRUH[DPSOH&\ULOOLF&KLQHVH-DSDQHVH$UDELFRU+HEUHZXVH
VDPSOHYDOXHVIRUWKHVHDVZHOODVWKHVHFKDUDFWHUVZLOOUHTXLUH
PRUHVSDFHWKDQDQ$6&,,FKDUDFWHU
7KHWDEOHVWUXFWXUHRI\RXUGDWDEDVHVKRXOGDOUHDG\EHSUHVHQWZKLFKPHDQVDOOWDEOHV
VKRXOGEHFUHDWHGEXWQRWQHFHVVDULO\ÀOOHGZLWKGDWD
)XUWKHUPRUH\RXZLOOQHHGDQDFFRXQWZLWKUHDGDQGZULWHSULYLOHJHVWRWKHVFKHPDIRUZKLFK
\RXZDQWWRFDOFXODWHWKHVSDFHUHTXLUHPHQWVHVWLPDWH

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

)RUWKHIROORZLQJUHFLSHZHZLOODVVXPHWKHsample_stduserDFFRXQWLVXVHG)XUWKHUPRUH
ZHZLOOXVHDGDWDEDVHsampleZLWKWZRWDEOHV³table1DQGtable2³FUHDWHGXVLQJWKH
IROORZLQJVWDWHPHQWV
CREATE TABLE `table1` (
  `id` LONG,
  `name` varchar(255) DEFAULT NULL,
   INDEX `idx_name` (`name`) 
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE `table2` (
  `name` char(16) NOT NULL,
  `description` varchar(128) NOT NULL,
  PRIMARY KEY (`name`) 
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
:HZLOODVVXPHWKDWtable1ZLOOKDYHDPD[LPXPURZFRXQWRIRQHPLOOLRQDQGtable2ZLOO
KROGDWPRVWUHFRUGV
+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVHXVLQJWKHsample_stduserDFFRXQW

,QVHUWDVPXFKVDPSOHGDWDLQWR\RXUWDEOHVDVSRVVLEOH
INSERT INTO table1 values 
(1,"John Doe"), 
(2,"Mickey Mouse"), 
(3,"ǏǷǳǽǻǳǴǋǸǫǽǹǶȇǰǭǳȂǗǰǯǭǰǯǰǭ"),
(4,"Jane Doe"), 
(5,"Jeffrey \"The Dude\" Lebowksi"),
(6,"Walter Sobchak"), 
(7,"Donny Kerabatsos"), 
(8,"Neo"), 
(9,"Trinity"), 
(10,"Morpheus");
INSERT INTO table2 values 
("Bit", "Smallest piece of binary logic: either 0 or 1"),
("Byte", "Consists of eight bits"), 
("Nibble", "Half a byte, consists of four bits"), 
("kB", "Kilobyte; either 1,000 or 1,024 bytes"), 
("KiB", "Kibibyte; correct IEC term for 1,024 bytes"),
("MB", "Megabyte; either 1,000,000 or 1,048,576 bytes"),
("MiB", "Mebibyte; correct IEC term for 1,024 KiB");

&KDSWHU


&DOFXODWHWKHWDEOHVSDFHUHTXLUHPHQWVIRUHDFKWDEOHE\XVLQJWKHIROORZLQJVWDWHPHQWV
mysql> SELECT 1000000 * (DATA_LENGTH + INDEX_LENGTH) /
    ->   (SELECT COUNT(*) FROM sample.table1) / (1024*1024)
    ->   AS REQUIRED_SPACE_MB
    ->   FROM INFORMATION_SCHEMA.TABLES
    ->   WHERE TABLE_SCHEMA="sample" AND
    ->   TABLE_NAME="table1";
mysql> SELECT 20000 * (DATA_LENGTH + INDEX_LENGTH) /
    ->   (SELECT COUNT(*) FROM sample.table2) / (1024*1024)
    ->   AS REQUIRED_SPACE_MB
    ->   FROM INFORMATION_SCHEMA.TABLES
    ->   WHERE TABLE_SCHEMA="sample" AND
    ->   TABLE_NAME="table2";

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

+RZLWZRUNV
7KHVWDWHPHQWVLQVWHSXVHWKHPHWDGDWDDYDLODEOHLQINFORMATION_SCHEMA.TABLESWR
FDOFXODWHWKHVSDFHUHTXLUHPHQWVIRUWKHWDEOH:HUHWULHYHWKHFXUUHQWVSDFHUHTXLUHGIRUWKH
FXUUHQWGDWDDQGLQGH[LQIRUPDWLRQDQGGLYLGHLWE\WKHQXPEHURIUHFRUGVFXUUHQWO\VWRUHGLQ
WKHWDEOHZKLFKJLYHVWKHDYHUDJHVL]HRIDVLQJOHUHFRUG:HVLPSO\PXOWLSO\WKLVYDOXHZLWK
WKHWDUJHWQXPEHURIUHFRUGVLQWKHWDEOH)RUEHWWHUUHDGDELOLW\WKHYDOXHLVVFDOHGGRZQ
WR0%\WHV
1RWHWKDWIRUDORZQXPEHURIVDPSOHUHFRUGVWKHVHHVWLPDWHVDUHW\SLFDOO\
ZD\WRRKLJK7KHPRUHUHFRUGVDUHSUHVHQWLQWKHWDEOHVWKHPRUHDFFXUDWH
WKHUHVXOWVDUH
7KHIROORZLQJGLDJUDPVKRZVKRZWKHVDPSOHGDWDURZFRXQWDIIHFWVWKHUHVXOWVRI
WKHFDOFXODWLRQV
1000
0
100
200
300
400
500
600
700
800
900
6500
0
500
1000
1500
2000
2500
3000
3500
4000
4500
5000
5500
6000
No.ofsamplerecords
Size
Estimatedsizeoftable1
$V\RXFDQVHHWKHLQLWLDOHVWLPDWHZDVZD\WRRFRQVHUYDWLYH)RUORZQXPEHUVRIVDPSOH
UHFRUGVWKHHVWLPDWHGWDEOHVL]HZDVH[WUHPHO\KLJK7KHPRUHVDPSOHGDWDLVSUHVHQW
WKHORZHUDQGPRUHSUHFLVHWKHHVWLPDWHVJHW

&KDSWHU

7KHUH
VPRUH
7KHUHDVRQIRUWKHLQH[DFWÀJXUHVSURGXFHGZKHQWRROLWWOHVDPSOHGDWDLVXVHGLVGXHWRWKH
IDFWWKDWVWRUDJHVSDFHIRUGDWDDQGLQGH[LQIRUPDWLRQLVUHVHUYHGLQSDJHVDSDJHFRQVLVWVRI
.%6RIRUWKHÀUVWURZ.%RIVWRUDJHLVUHVHUYHGRQHSDJHIRUGDWDRQHSDJHIRUWKH
LQGH[%DVHGRQWKLVRQHPLOOLRQURZVRIWKLVVL]HZRXOGUHTXLUHURXJKO\*%RIVWRUDJH%XW
WKHQH[WURZZLOOÀWLQWRWKHYHU\VDPHSDJHWKDWZDVDOUHDG\UHVHUYHGDVZHOOWKXVUHGXFLQJ
WKHFDOFXODWHGHVWLPDWHIRUWKHVSDFHUHTXLUHPHQWVE\SHUFHQW7KLVLVZK\ZLWKYHU\VPDOO
VHWVRIVDPSOHGDWDDUHDOLVWLFHVWLPDWHRIKRZPXFKVSDFHLVJRLQJWREHUHTXLUHGIRUDODUJH
URZFRXQWLVKDUGO\SRVVLEOH7KHDGYDQWDJHLVWKDWWKLVHIIHFWSURWHFWV\RXDJDLQVWHVWLPDWHV
WKDWDUHWRRORZ
1RWHWKDWVLPSO\PXOWLSO\LQJWKHAVG_ROW_LENGTHYDOXHE\WKHQXPEHURI
URZVLVQRWVXIÀFLHQWEHFDXVHWKLVGRHVQRWWDNHWKHVWRUDJHUHTXLUHPHQWV
IRUWKHLQGH[LQIRUPDWLRQLQWRDFFRXQW,QVRPHFDVHVWKHLQGH[HVDUHELJJHU
WKDQWKHDFWXDOGDWD
6HHDOVR
f
&UHDWLQJDEDVLFXVHU
,GHQWLI\LQJDQGFKDQJLQJ0\64/YDULDEOHV
7KHEHKDYLRURI0\64/LQVWDOODWLRQVFDQEHZLGHO\FRQÀJXUHGXVLQJYDULDEOHV<RXZLOO
SUREDEO\KDYHFRPHDFURVVVRPHRIWKHVHYDULDEOHVDVWKH\DUHGHÀQHGLQ\RXU0\64/
FRQÀJXUDWLRQÀOHmy.ini%XWWKHUHDUHPDQ\YDULDEOHVWKDW\RXZLOOSUREDEO\QRWNQRZRI
EHFDXVHWKH\KDYHVHQVLEOHGHIDXOWYDOXHVDQGDUHUDUHO\PRGLÀHG
7KHW\SLFDOZD\WRDGDSW0\64/YDULDEOHVLVWRHGLWWKH0\64/FRQÀJXUDWLRQDQGUHVWDUW\RXU
GDWDEDVHVHUYHU%XWLI\RXZDQWWRNQRZZKHWKHUDVHWWLQJLQ\RXU0\64/FRQÀJXUDWLRQZDVLQ
IDFWDFFHSWHGRULI\RXZDQWWRNQRZZKLFKVHWWLQJLVLQSODFHLQWKHFXUUHQWO\UXQQLQJ0\64/
LQVWDQFHZLWKRXWKDYLQJWRUHVRUWWRWKH0\64/VWDUWXSFRQÀJXUDWLRQWKLVUHFLSHZLOOVKRZ\RX
KRZWRGRWKLV
:HZLOODOVRVKRZ\RXKRZWRFKDQJHFHUWDLQVHWWLQJVGXULQJVHUYHUUXQWLPHZKLFKDOORZV
SHUIRUPLQJFHUWDLQFKDQJHVZLWKRXWWKHQHHGIRUD0\64/UHVWDUW
*HWWLQJUHDG\
$OOZHQHHGLVDQ\0\64/FOLHQWOLNHWKHmysqlFRPPDQGOLQHFOLHQWDQGD0\64/XVHU
DFFRXQW7RUHDGDYDULDEOHVHWWLQJDQ\XVHUWKDWDOORZV\RXWRFRQQHFWWRWKHVHUYHULVVXIÀFLHQW
,I\RXZDQWWRFKDQJHWKHYDOXHRID0\64/V\VWHPYDULDEOH\RXZLOOQHHGWKHSUPERSULYLOHJH
)RUWKHIROORZLQJH[DPSOHZHZLOODVVXPHDQDGPLQLVWUDWLRQDFFRXQWQDPHGadmin4mysql

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVHZLWKWKH64/FOLHQWRI\RXUFKRLFHXVLQJWKH
admin4mysqlDFFRXQW

6KRZDOOYDULDEOHVE\HQWHULQJWKHIROORZLQJFRPPDQG\RXZLOOKDYHWRVFUROOWKURXJK
WKHUHVXOWVWRVHHDOOYDOXHV
mysql> SHOW VARIABLES;
 7RGLVSOD\WKHYDOXHRIDFHUWDLQYDULDEOHH[HFXWHWKHIROORZLQJVWDWHPHQW
mysql> SHOW VARIABLES LIKE "version";

7RGLVSOD\DJURXSRIYDULDEOHVZLWKDFRPPRQQDPH\RXFDQDOVRXVH64/ZLOGFDUG
FKDUDFWHUV
mysql> SHOW VARIABLES LIKE "version%";

&KDSWHU

 7RPRGLI\DYDULDEOHIRU\RXUFRQQHFWLRQRQO\XVHWKHSETFRPPDQG
mysql> SET auto_increment_increment=2;
Query OK, 0 rows affected (0.00 sec)
 7RJOREDOO\PRGLI\DYDULDEOHXVHVHWSET GLOBALVWDWHPHQW
mysql> SET GLOBAL auto_increment_increment=3;
Query OK, 0 rows affected (0.00 sec)
+RZLWZRUNV
6WHSVWKURXJKVKRZGLIIHUHQWZD\VWRUHWULHYHYDULDEOHVHWWLQJVZKLFKLVSUHWW\VWUDLJKW
IRUZDUG6WHSFKDQJHVDVHUYHUYDULDEOHWRDQHZYDOXHLQWKHDERYHH[DPSOHZHPRGLI\
auto_increment_incrementWRDYDOXHRI7KLVVHWWLQJWDNHVHIIHFWLPPHGLDWHO\EXWLW
RQO\DIIHFWV\RXURZQFRQQHFWLRQ$Q\RWKHUFRQQHFWLRQZLOOXVHWKHSUHYLRXVYDOXH$QGDV
VRRQDV\RXGURS\RXUFRQQHFWLRQDQGUHFRQQHFWWRWKHVHUYHUWKHYDULDEOHLVUHVHWWRWKHROG
YDOXHDJDLQ
6WHSVKRZV\RXKRZWRDSSO\DFKDQJHQRWRQO\WR\RXUFXUUHQWFRQQHFWLRQ:LWKWKHSET 
GLOBALV\QWD[WKHVHWWLQJLVDSSOLHGWRRWKHUFRQQHFWLRQVDVZHOO+RZHYHUQRWHWKDWQRWDOO
FKDQJHVDUHDSSOLHGWRRWKHUFRQQHFWLRQVLPPHGLDWHO\VRPHFKDQJHVZLOORQO\DIIHFWQHZ
FRQQHFWLRQV7KHUHDVRQIRUWKLVLVWKDWWKHUHDUHEDVLFDOO\WKUHHNLQGVRI0\64/YDULDEOHV

9DULDEOHVWKDWDSSO\WR\RXUFRQQHFWLRQFDOOHGVHVVLRQYDULDEOHV

9DULDEOHVWKDWDUHGHÀQHGJOREDOO\DQGDIIHFWDOOFRQQHFWLRQVDOLNHJOREDOYDULDEOHV

9DULDEOHVWKDWH[LVWERWKJOREDOO\DQGIRU\RXUFXUUHQWVHVVLRQDQGZKLFKFDQEH
FKDQJHGLQGHSHQGHQWO\IRUHDFKFRQWH[W
,IDYDULDEOHWKDWLVVROHO\GHÀQHGJOREDOO\LVFKDQJHGWKHQWKHFKDQJHZLOODIIHFWDOO
FRQQHFWLRQVERWKH[LVWLQJDQGQHZRQHV)RUYDULDEOHVWKDWDUHERWKVHVVLRQDQGJOREDO
YDULDEOHVauto_increment_incrementLVDQH[DPSOHIRUWKLVDQ\FKDQJHZLOORQO\
DIIHFWQHZFRQQHFWLRQV7KHYDULDEOHYDOXHVIRUFRQQHFWLRQVWKDWDOUHDG\H[LVWZLOOEHOHIW
XQFKDQJHG7KLVEHKDYLRULVGXHWRWKHIDFWWKDWRQFRQQHFWLRQFUHDWLRQWKHYDOXHIURPWKH
JOREDOYDULDEOHLVFRSLHGWRWKHVHVVLRQYDULDEOH$Q\FKDQJHWRWKHJOREDOYDULDEOHZLOOQRW
DIIHFWWKHVHVVLRQYDULDEOHDIWHUZDUGV

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

1RWHWKDWDOOFKDQJHVPDGHXVLQJWKHSET GLOBALFRPPDQGZLOOEH
ORVWRQWKHQH[W0\64/VWDUWXS7RPDNHSHUPDQHQWFKDQJHVWRWKH
0\64/FRQÀJXUDWLRQ\RXZLOOKDYHWRHGLWWKHVWDUWXSFRQÀJXUDWLRQ
W\SLFDOO\WKHmy.iniÀOHDVZHOO
7KHUH
VPRUH
7KHIROORZLQJVHFWLRQVZLOOLQWURGXFHVRPHDGGLWLRQDORSWLRQVZKLFKFDQEHXVHGWR
VSHFLÀFDOO\UHDGLQIRUPDWLRQIURPWKH0\64/YDULDEOHV
'LVSOD\LQJPRUHWKDQRQHQDPHGYDULDEOHDWDWLPH
<RXFDQDOVRGLVSOD\WKHYDOXHVIRUPRUHWKDQRQHQDPHGYDULDEOHLQRQHVWDWHPHQWXVLQJWKH
IROORZLQJV\QWD[
mysql> SHOW VARIABLES
    ->  WHERE variable_name IN ("wait_timeout", "autocommit")
    ->  OR variable_name LIKE "version%";
'LVSOD\LQJJOREDOVHWWLQJV
,I\RXKDYHFKDQJHGDQ\RIWKHVHWWLQJVRI\RXUFRQQHFWLRQDQG\RXZDQWWRÀQGRXWDERXWWKH
JOREDOVHWWLQJRIWKLVYDULDEOHXVHWKHSHOW GLOBALVWDWHPHQW
mysql> SHOW GLOBAL VARIABLES like "auto_increment_increment";

&KDSWHU

6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV&KDSWHU0\64/
8VHU0DQDJHPHQW
$VVHVVLQJWKHRYHUDOOWDEOHFRXQW
,QVRPH0\64/LQVWDOODWLRQV\RXZLOOKDYHDORWRIGDWDEDVHVRIVFKHPDWDLQSODFH7RNHHS
WUDFNRIWKHGDWDEDVHVLWVRPHWLPHVFRPHVLQKDQG\WRJHWDQRYHUYLHZRIWKHWDEOHVWKDW
UHVLGHLQHDFKVFKHPD7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRDFKLHYHWKLV
*HWWLQJUHDG\
<RXZLOOQHHGD0\64/DFFRXQWWRUHSURGXFHWKHIROORZLQJUHFLSH7RJHWDQRYHUYLHZRIDOO
GDWDEDVHVRI\RXULQVWDOODWLRQV\RXQHHGDWOHDVWSELECTSULYLOHJHVRQDOOGDWDEDVHVZKLFK
LVZK\ZHDVVXPHWKHDGPLQLVWUDWLYHXVHUDFFRXQWQDPHGadmin4mysqlLVXVHG7KHDERYH
PHQWLRQHGPHWKRGVZLOOZRUNIRUPRUHUHVWULFWHGDFFRXQWVDVZHOOEXWZLOOSURGXFHUHVXOWV
RQO\IRUWKHGDWDEDVHVDFFHVVLEOHWRWKHXVHU

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVHXVLQJWKHadmin4mysqlDFFRXQW

([HFXWHWKHIROORZLQJFRPPDQG
mysql> SELECT TABLE_SCHEMA, COUNT(*) AS TABLE_COUNT
    ->   from INFORMATION_SCHEMA.TABLES
    ->   GROUP BY TABLE_SCHEMA WITH ROLLUP;
+RZLWZRUNV
7KHUHVXOWIURPVWHSGLVSOD\VDQRYHUYLHZRIWKHGDWDEDVHVWKDWDUHSUHVHQWLQRXU
LQVWDOODWLRQDQGWKHQXPEHURIWDEOHVGHÀQHGIRUHDFKGDWDEDVH7KHODVWOLQHVKRZVWKH
RYHUDOOWDEOHFRXQWRIDOOGDWDEDVHV
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
)LQGLQJWKHELJJHVWWDEOHV
2QWKHTXHVWIRUSHUIRUPDQFHGXULQJWKHGDLO\VWUXJJOHDJDLQVWXQFRQWUROOHGGDWDJURZWKWKH
ELJJHVWWDEOHVDUHRIWHQWKHPRVWSURPLVLQJFDQGLGDWHVIRURSWLPL]DWLRQ7KLVUHFLSHVKRZV
\RXKRZWRJHWDQRYHUYLHZRIWKHODUJHVWWDEOHVLQ\RXULQVWDOODWLRQ

&KDSWHU

*HWWLQJUHDG\
<RXZLOORQO\QHHGDQDSSURSULDWH0\64/XVHUDFFRXQWWRSHUIRUPWKHVWHSVRIWKLVUHFLSH
7RUHWULHYHWKHLQIRUPDWLRQIRUDOOGDWDEDVHVDQDGPLQLVWUDWLYHXVHUOLNHadmin4mysql
ZKLFKZHZLOOXVHKHUHLVEHVW7RJHWDQRYHUYLHZRIWKHWDEOHVLQ\RXUGDWDEDVHDXVHU
ZLWKDFFHVVRQO\WRWKHUHVSHFWLYHGDWDEDVHFDQEHXVHGDVZHOO
+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVHXVLQJWKHadmin4mysqlDFFRXQW

3HUIRUPWKHIROORZLQJ64/VWDWHPHQW
mysql> SELECT TABLE_SCHEMA,
    ->  TABLE_NAME,
    ->  (INDEX_LENGTH+DATA_LENGTH)/(1024*1024) AS SIZE_MB,
    ->  TABLE_ROWS
    ->  FROM INFORMATION_SCHEMA.TABLES
    ->  WHERE TABLE_SCHEMA NOT IN("mysql", "information_schema")
    ->  ORDER BY SIZE_MB DESC;
+RZLWZRUNV
7KHDERYHVWDWHPHQWVLPSO\PDNHVXVHRIWKHWDEOHPHWDGDWDDYDLODEOHIURPWKHWDEOH
INFORMATION_SCHEMA.TABLESDQGGLVSOD\VLWLQDUHDGDEOHZD\,WLVVRUWHGE\WKHVL]HRI
WKHWDEOHDFFRUGLQJWRWKHVWRUDJHUHVHUYHGE\WKLVWDEOH,IWKHQXPEHURIUHFRUGVLVPRUHRI
LQWHUHVWWR\RX\RXFRXOGRIFRXUVHDGDSWWKHDERYHVWDWHPHQWDFFRUGLQJO\

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

SELECT TABLE_SCHEMA, 
    TABLE_NAME, 
    TABLE_ROWS,
    (INDEX_LENGTH+DATA_LENGTH)/(1024*1024) AS SIZE_MB
    FROM INFORMATION_SCHEMA.TABLES 
    WHERE TABLE_SCHEMA NOT IN("mysql", "information_schema")
    ORDER BY TABLE_ROWS DESC;
,QERWKFDVHVWKHWHERE TABLE_SCHEMA NOT IN("mysql", "information_
schema")FODXVHKHOSVWRÀOWHURXWDQ\UHVXOWVIURPWKHmysqlDQGinformation_schema
VFKHPDWDZKLFKDUHW\SLFDOO\QRWLQWKHIRFXVRILQWHUHVW
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
)LQGLQJDOOFROXPQVZLWKDFHUWDLQQDPH
DQGRUW\SH
,QODUJHGDWDEDVHVLWRIWHQPDNHVVHQVHWRDJUHHRQVRPHNLQGRIGDWDPRGHOLQJVWDQGDUGV
WRDYRLGXQQHFHVVDU\HIIRUW)RUH[DPSOH\RXGHFLGHWRVWDQGDUGL]HWKDWDOOFROXPQV
FRQWDLQLQJDQDPHVKRXOGEHRIW\SHVARCHAR(64),IKRZHYHUWKHVLWXDWLRQFRPHVXSWKDW
WKHVWDQGDUGW\SHIRUQDPHFROXPQVVKRXOGEHFKDQJHGWRVD\VARCHAR(128)WRDOORZIRU
YHU\ORQJQDPHVWKHTXHVWLRQDULVHVKRZPDQ\FROXPQVRUWDEOHVKDYHWREHDGDSWHG³IRU
ODUJHLQVWDOODWLRQVWKLVLVQRWDWULYLDOTXHVWLRQWRDQVZHU7KLVUHFLSHZLOOVKRZ\RXKRZWR
UHWULHYHWKLVLQIRUPDWLRQ
*HWWLQJUHDG\
<RXZLOOQHHGD0\64/XVHUZLWKSELECTULJKWVIRUWKHGDWDEDVHVWKDWDUHWREHFKHFNHGIRU
PDWFKLQJFROXPQV:HZLOOXVHWKHsample_guestXVHUKHUH
$QGRIFRXUVH\RXZLOOKDYHWRNQRZZKDWGDWDW\SHDQGFROXPQQDPH\RXDUHORRNLQJIRU,QWKH
IROORZLQJVWHSVZHZLOOEHORRNLQJIRUnameFROXPQVDQGFROXPQVRIGDWDW\SHVARCHAR(64)
+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVHXVLQJWKHsample_guestXVHU

([HFXWHWKHIROORZLQJTXHU\WRÀQGDOOQDPHFROXPQV
mysql> SELECT TABLE_SCHEMA,
    ->   TABLE_NAME,
    ->   COLUMN_NAME,

&KDSWHU

    ->   DATA_TYPE,
    ->   CHARACTER_MAXIMUM_LENGTH AS SIZE
    ->   FROM INFORMATION_SCHEMA.COLUMNS
    ->   WHERE COLUMN_NAME="name" AND
    ->   TABLE_SCHEMA NOT IN ("mysql", "information_schema");

7RÀQGDOOFROXPQVZLWKGDWDW\SHVARCHAR(64)H[HFXWHWKLVFRPPDQG
mysql> SELECT TABLE_SCHEMA,
    ->   TABLE_NAME,
    ->   COLUMN_NAME,
    ->   DATA_TYPE,
    ->   CHARACTER_MAXIMUM_LENGTH AS SIZE
    ->   FROM INFORMATION_SCHEMA.COLUMNS
    ->   WHERE DATA_TYPE="VARCHAR" AND
    ->   CHARACTER_MAXIMUM_LENGTH=64 AND
    ->   TABLE_SCHEMA NOT IN ("mysql", "information_schema");

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ

+RZLWZRUNV
7KHSUHFHGLQJVWDWHPHQWVVLPSO\PDNHXVHRIWKHLQIRUPDWLRQDYDLODEOHLQWKH
INFORMATION_SCHEMA.COLUMNSPHWDGDWDWDEOH,WKHOSV\RXLGHQWLI\FROXPQV
ZLWKFHUWDLQDWWULEXWHV7KHmysqlDQGinformation_schemaVFKHPDWDDUHÀOWHUHG
RXWXVLQJWKHWHERE TABLE_SCHEMA NOT IN("mysql", "information_schema")
FODXVHWRGLVSOD\RQO\UHVXOWVRILQWHUHVW
7KHUH
VPRUH
,IWKHGDWDW\SH\RXDUHORRNLQJIRULVDQXPHULFGDWDW\SH\RXZLOOKDYHWRDGDSWWKHTXHULHVWR
WDNHWKHNUMERIC_PRECISIONDQGNUMERIC_SCALEDWWULEXWHVLQWRDFFRXQW
<RXFDQDOVRQDUURZGRZQWKHUHVXOWVWRFROXPQVZLWKDVSHFLÀFSUHFLVLRQRUVFDOH

&KDSWHU

6HHDOVR
f
&UHDWLQJDUHDGRQO\DFFRXQW
)LQGLQJDOOWDEOHVUHIHUHQFLQJHDFKRWKHU
)RUERWKPDQXDOGDWDPRGLÀFDWLRQVDQGFKDQJHVWRWKHWDEOHVWUXFWXUHLWLVLPSRUWDQWWR
NQRZZKHWKHUWKHUHIHUHQWLDOLQWHJULW\RIWKHGDWDEDVHLVDIIHFWHG)RUFRPSOH[GDWDPRGHOV
LWLVRIWHQWKHFDVHWKDWWKHGHWDLOVDERXWZKLFKWDEOHUHIHUHQFHVDUHLQSODFHDUHQRWNQRZQ
7KLVUHFLSHKHOSV\RXWRPDNHWKHGHSHQGHQFLHVEHWZHHQWDEOHVYLVLEOH
*HWWLQJUHDG\
$JDLQZHRQO\QHHGDXVHUZKRKDVWKHSULYLOHJHVWRDFFHVVWKHGDWDEDVHLQTXHVWLRQ
SELECTSULYLOHJHVDUHVXIÀFLHQW:HZLOOXVHDQDFFRXQWQDPHGemployees_guest
DFFRXQWKHUHZKLFKKDVSELECTSULYLOHJHVIRUWKHHPSOR\HHVGDWDEDVH
+RZWRGRLW

&RQQHFWWR\RXU0\64/GDWDEDVHXVLQJWKHsample_guestXVHU

7RGLVSOD\DOOWDEOHVUHIHUHQFLQJWKHemployeesWDEOHH[HFXWHWKHIROORZLQJVWDWHPHQW
mysql> SELECT TABLE_NAME,
    ->   CONSTRAINT_NAME,
    ->   UPDATE_RULE AS "UPDATE",
    ->   DELETE_RULE AS "DELETE"
    ->   FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
    ->   WHERE REFERENCED_TABLE_NAME="employees";

0RQLWRULQJDQG$QDO\]LQJ0\64/,QVWDOODWLRQ


8VHWKHIROORZLQJTXHU\WRUHWULHYHLQIRUPDWLRQDERXWWKHWDEOHVUHIHUHQFHGE\WKH
salariesWDEOH
mysql> SELECT REFERENCED_TABLE_NAME,
    ->   CONSTRAINT_NAME,
    ->   UPDATE_RULE AS "UPDATE",
    ->   DELETE_RULE AS "DELETE"
    ->   FROM INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS
    ->   WHERE TABLE_NAME="salaries";
+RZLWZRUNV
7KLVUHFLSHXVHVWKHLQIRUPDWLRQDYDLODEOHLQWKHREFERENTIAL_CONSTRAINTSPHWDGDWD
WDEOHLQWKHINFORMATION_SCHEMAVFKHPD7KHLQIRUPDWLRQUHWULHYHGLQVWHSPHDQVWKDW
XSGDWLQJLQIRUPDWLRQLQWKHHPSOR\HHVWDEOHPLJKWEHFRPHGLIÀFXOWDVLWLVUHIHUHQFHGE\IRXU
RWKHUWDEOHVDQGDQON UPDATE RESTRICTSROLF\LVLQSODFH'HOHWLRQRIGDWDKRZHYHUZLOO
EHHDV\DVWKHGHOHWLRQUXOHVIRUDOOIRXUGHSHQGHQFLHVDUHPDUNHGDVON DELETE CASCADE
%HFDXVHRIWKLV\RXVKRXOGEHHYHQPRUHFDUHIXOKRZHYHUQRWWRGHOHWHWKHZURQJGDWD
(VSHFLDOO\WKHLQIRUPDWLRQGHOLYHUHGE\VWHSLVRIWHQYHU\LPSRUWDQWWRJHWDQRYHUYLHZRI
WKHGHSHQGHQFLHVRIODUJHGDWDPRGHOVWKDWHYROYHGRYHUDORQJHUSHULRGRIWLPHDQGZLWK
PDQ\SHRSOHLQYROYHG
6HHDOVR
f
&UHDWLQJDUHDGRQO\DFFRXQW


&RQÀJXULQJ0\64/
,QWKLVFKDSWHUZHZLOOVKHGVRPHOLJKWRQ0\64/FRQÀJXUDWLRQVHWWLQJV7KHUHLVDQDEXQG
DQFHRIGLDOVDQGNQREVDYDLODEOHIRUERWKWKH0\64/VHUYHUDQGWKHGLIIHUHQWVWRUDJH
HQJLQHVXQGHUQHDWKLW&RYHULQJWKHPDOOZRXOGE\IDUH[FHHGWKHOLPLWDWLRQVRIDQ\ERRNVR
ZHZLOOMXVWJRIRUDVHOHFWLRQRIVRPHRIWKHPRVWLPSRUWDQWRQHV
f
6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFH
f
6HWWLQJXSDQDXWRH[WHQGLQJ,QQR'%WDEOHVSDFH
f
6WRULQJ,QQR'%GDWDLQRQHÀOHSHUWDEOH
f
'HFUHDVLQJ,QQR'%WDEOHVSDFH
f
(QDEOLQJDQGFRQÀJXULQJELQDU\ORJJLQJ
f
&RQÀJXULQJWKH,QQR'%UHGRORJ
f
8QGHUVWDQGLQJDQGFRQÀJXULQJLPSRUWDQW0\64/DQG,QQR'%WLPHRXWRSWLRQV
f
$GMXVWLQJWDEOHDQGGDWDEDVHQDPHOHWWHUFDVHKDQGOLQJIRUEHWWHU
SODWIRUPLQGHSHQGHQFH
f
,QVWDOOLQJ0\64/DVD:LQGRZVVHUYLFHZLWKFXVWRPRSWLRQV
f
5XQQLQJPXOWLSOH0\64/VHUYHULQVWDQFHVLQSDUDOOHORQD/LQX[VHUYHU
f
3UHYHQWLQJLQYDOLGGDWHYDOXHVIURPEHLQJVWRUHGLQDATERUDATETIMEFROXPQV

&RQÀJXULQJ0\64/

,QWURGXFWLRQ
,QVWDOOLQJD0\64/VHUYHULVRQHWKLQJWKDWLVIDLUO\HDV\WRGR6HWWLQJXSWKHYDVWDPRXQW
RIFRQÀJXUDWLRQRSWLRQVDYDLODEOHFDQEHIDUPRUHFKDOOHQJLQJDVWKHUHLVQRRQHÀWVDOO
FRPELQDWLRQRIVHWWLQJV0\64/FRPHVZLWKVRPHSUHVHWVWKDWFDQVHUYHDVDVWDUWLQJSRLQW
IRUGLIIHUHQWVHUYHUVL]HV7KH\DUHFDOOHGmy-large.cnfmy-huge.cnfmy-medium.cnf
DQGmy-innodb-heavy-4G.cnf2Q8EXQWX/LQX[WKH\FDQEHIRXQGLQFRPSUHVVHGIRUP
LQWKH/usr/share/doc/mysql-server-5.0/examplesGLUHFWRU\2Q:LQGRZVWKH
VDPHH[DPSOHVH[LVWEXWKDYHÀOHQDPHVHQGLQJLQ.iniDQGDUHORFDWHGLQWKH0\64/
SURJUDPGLUHFWRU\
,QWKLVFKDSWHUZHZLOOGHOYHLQWRDVHOHFWLRQRIWKHPRVWUHOHYDQWFRQÀJXUDWLRQRSWLRQV
IRFXVLQJRQLPSRUWDQW,QQR'%VHWWLQJVDVWKLVLVWKHVWRUDJHHQJLQHPRVWUHOHYDQWWR
HQWHUSULVHDSSOLFDWLRQV
3OHDVHUHIHUWRWKHDSSHQGL[IRUDGHVFULSWLRQRIKRZWRVHWXSWKH
innodb_buffer_pool_sizeVHWWLQJDQGPDNHWKHEHVWXVHRI
WKHDYDLODEOHPHPRU\
6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFH
:KHQXVLQJWKH,QQR'%VWRUDJHHQJLQHRI0\64/WKHGDWDLVW\SLFDOO\QRWVWRUHGLQD
SHUGDWDEDVHRUSHUWDEOHGLUHFWRU\VWUXFWXUHEXWLQVHYHUDOGHGLFDWHGÀOHVZKLFKFROOHFWLYHO\
FRQWDLQWKHVRFDOOHGWDEOHVSDFH%\GHIDXOWZKHQLQVWDOOLQJ0\64/XVLQJWKHFRQÀJXUDWLRQ
ZL]DUG,QQR'%LVFRQÀJXUHGWRKDYHRQHVPDOOÀOHWRVWRUHGDWDLQDQGWKLVÀOHJURZVDV
QHHGHG:KLOHWKLVLVDYHU\ÁH[LEOHDQGHFRQRPLFDOFRQÀJXUDWLRQWRVWDUWZLWKWKLVDSSURDFK
DOVRKDVVRPHGUDZEDFNVWKHUHLVQRUHVHUYHGVSDFHIRU\RXUGDWDVR\RXKDYHWRUHO\RQIUHH
GLVNVSDFHHYHU\WLPH\RXUGDWDJURZV$OVRLI\RXUGDWDEDVHJURZVELJJHUWKHÀOHZLOOJURZ
WRDVL]HZKLFKPDNHVLWKDUGWRKDQGOH³DGR]HQÀOHVRI*%HDFKDUHW\SLFDOO\HDVLHU
WRPDQDJHWKDQRQHFOXPV\*%ÀOH
/DUJHGDWDÀOHVPLJKWIRUH[DPSOHFDXVHSUREOHPVLI\RXWU\WRSXWWKRVHÀOHV
LQWRDQDUFKLYHIRUEDFNXSRUGDWDWUDQVPLVVLRQSXUSRVHV(YHQLIWKH*%
OLPLWLVQRWSUHVHQWDQ\PRUHIRUWKHFXUUHQWÀOHV\VWHPVPDQ\FRPSUHVVLRQ
SURJUDPVVWLOOKDYHSUREOHPVGHDOLQJZLWKODUJHÀOHV
$QGÀQDOO\WKHFRQVWDQWDGDSWDWLRQRIWKHÀOHLQ,QQR'%
VGHIDXOWFRQÀJXUDWLRQVL]HZLOOFDXVH
DVPDOOEXWH[LVWHQWSHUIRUPDQFHKLWLI\RXUGDWDEDVHJURZV
7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRGHÀQHDÀ[HGWDEOHVSDFHIRU\RXU,QQR'%
LQVWDOODWLRQE\ZKLFK\RXFDQDYRLGWKHVHGUDZEDFNVRIWKH,QQR'%GHIDXOWFRQÀJXUDWLRQ

&KDSWHU

*HWWLQJUHDG\
7RLQVWDOODÀ[HGWDEOHVSDFH\RXZLOOKDYHWRUHÁHFWDERXWVRPHDVSHFWVKRZPXFK
WDEOHVSDFHVKRXOGEHUHVHUYHGIRU\RXUGDWDEDVHDQGKRZWRVL]HWKHVLQJOHGDWDÀOHVZKLFK
LQVXPFRQVWLWXWHWKHWDEOHVSDFH
1RWHWKDWRQFH\RXUGDWDEDVHFRPSOHWHO\DOORFDWHV\RXUWDEOHVSDFH\RXZLOO
UXQLQWRWDEOHIXOOHUURUVHUURUFRGHZKHQWU\LQJWRDGGQHZGDWDWR
\RXUGDWDEDVH
$GGLWLRQDOO\\RXKDYHWRPDNHVXUHWKDW\RXUFXUUHQW,QQR'%WDEOHVSDFHLVFRPSOHWHO\HPSW\
,GHDOO\\RXVKRXOGVHWXSWKHWDEOHVSDFHRIDIUHVKO\LQVWDOOHG0\64/LQVWDQFHLQZKLFKFDVH
WKLVSUHUHTXLVLWHLVJLYHQ
7RFKHFNZKHWKHUDQ\,QQR'%WDEOHVH[LVWLQ\RXUGDWDEDVHH[HFXWHWKH
IROORZLQJVWDWHPHQWDQGGHOHWHWKHJLYHQWDEOHVXQWLOWKHUHVXOWLVHPSW\
SELECT TABLE_SCHEMA, TABLE_NAME FROM information_
schema.tables WHERE engine="InnoDB";
,I\RXUGDWDEDVHDOUHDG\FRQWDLQVGDWDVWRUHGLQ,QQR'%WDEOHVWKDW\RX
GRQRWZDQWWRORVH\RXZLOOKDYHWRFUHDWHDEDFNXSRI\RXUGDWDEDVH
DQGUHFRYHUWKHGDWDIURPLWZKHQ\RXDUHGRQHZLWKWKHUHFLSH3OHDVH
UHIHUWRWKHFKDSWHU%DFNLQJ8SDQG5HVWRULQJ0\64/'DWDIRUIXUWKHU
LQIRUPDWLRQRQWKLV
$QGÀQDOO\\RXKDYHWRPDNHVXUHWKDWWKH,QQR'%GDWDGLUHFWRU\DVGHÀQHGE\WKHinnodb_
data_home_dirYDULDEOHIHDWXUHVVXIÀFLHQWIUHHGLVNVSDFHWRVWRUHWKH,QQR'%GDWDÀOHV
)RUWKHIROORZLQJH[DPSOHZHZLOOXVHDÀ[HGWDEOHVSDFHZLWKDVL]HRI0%DQGDPD[LPDO
ÀOHVL]HRI0%
+RZWRGRLW

2SHQWKH0\64/FRQÀJXUDWLRQÀOHmy.iniRUmy.cnfLQDWH[WHGLWRU

,GHQWLI\WKHOLQHVWDUWLQJZLWKinnodb_data_file_pathLQWKH[mysqld]VHFWLRQ
,IQRVXFKOLQHH[LVWVDGGWKHOLQHWRWKHÀOH

&KDQJHWKHOLQHinnodb_data_file_pathWRUHDGDVIROORZV
innodb_data_file_path=ibdata1:200M;ibdata2:200M;ibdata3:100M

6DYHWKHFKDQJHGFRQÀJXUDWLRQÀOH

&RQÀJXULQJ0\64/


6KXWGRZQ\RXUGDWDEDVHLQVWDQFHLIUXQQLQJ

'HOHWHSUHYLRXV,QQR'%GDWDÀOHVW\SLFDOO\FDOOHGibdata1ibdata2DQGVRRQ
IURPWKHGLUHFWRU\GHÀQHGE\WKHinnodb_data_home_dir YDULDEOH

'HOHWHSUHYLRXV,QQR'%ORJÀOHVQDPHGib_logfile0ib_logfile1VRRQIURP
WKHGLUHFWRU\GHÀQHGE\WKHinnodb_log_group_home_dirYDULDEOH
,Iinnodb_log_group_home_dirLVQRWFRQÀJXUHG
H[SOLFLWO\LWGHIDXOWVWRWKHdatadirGLUHFWRU\
 6WDUW\RXUGDWDEDVH
 :DLWIRUDOOGDWDDQGORJÀOHVWREHFUHDWHG
'HSHQGLQJRQWKHVL]HRI\RXUWDEOHVSDFHDQGWKHVSHHGRI\RXUGLVN
V\VWHPFUHDWLRQRI,QQR'%GDWDÀOHVFDQWDNHDVLJQLÀFDQWDPRXQW
RIWLPHVHYHUDOPLQXWHVLVQRWDQXQFRPPRQWLPHIRUODUJHULQVWDOO
DWLRQV'XULQJWKLVLQLWLDOL]DWLRQVHTXHQFH0\64/LVVWDUWHGEXWLW
ZLOOQRWDFFHSWDQ\UHTXHVWV
+RZLWZRUNV
6WHSVWKURXJK³DQGSDUWLFXODUO\³FRYHUWKHDFWXDOFKDQJHWREHPDGHWRWKH0\64/
FRQÀJXUDWLRQZKLFKLVQHFHVVDU\WRDGDSWWKH,QQR'%WDEOHVSDFHVHWWLQJV7KHYDOXHRI
WKHinnodb_data_file_pathYDULDEOHFRQVLVWVRIDOLVWRIGDWDÀOHGHÀQLWLRQVWKDWDUH
VHSDUDWHGE\VHPLFRORQV(DFKGDWDÀOHGHÀQLWLRQLVFRQVWUXFWHGRIDÀOHQDPHDQGDÀOH
VL]HZLWKDFRORQDVDVHSDUDWRU7KHVL]HFDQEHH[SUHVVHGDVDSODLQQXPHULFYDOXHZKLFK
GHÀQHVWKHVL]HRIWKHGDWDÀOHLQE\WHV,IWKHQXPHULFYDOXHKDVDKMRUGSRVWÀ[WKH
QXPEHULVLQWHUSUHWHGDV.LORE\WHV0HJDE\WHVRU*LJDE\WHVUHVSHFWLYHO\7KHOLVWOHQJWKLVQRW
OLPLWHGWRWKHWKUHHHQWULHVRIRXUH[DPSOHLI\RXZDQWWRVSOLWDODUJHWDEOHVSDFHLQWRUHODWLYHO\
VPDOOÀOHVWKHOLVWFDQHDVLO\FRQWDLQGR]HQVRIGDWDÀOHGHÀQLWLRQV
,I\RXUWDEOHVSDFHFRQVLVWVRIPRUHWKDQÀOHVZHSURSRVHQDPLQJWKH
ÀUVWQLQHÀOHVibdata01WKURXJKibdata09LQVWHDGRIibdata1DQGVR
IRUWKQRWHWKH]HURVRWKDWWKHÀOHVDUHOLVWHGLQDPRUHFRQVLVWHQWRUGHU
ZKHQWKH\DUHGLVSOD\HGLQ\RXUÀOHEURZVHURUFRPPDQGOLQHLQWHUIDFH
6WHSLVSUHUHTXLVLWHWRWKHVWHSVIROORZLQJDIWHULWDVGHOHWLRQRIYLWDO,QQR'%ÀOHVZKLOHWKH
V\VWHPLVVWLOOUXQQLQJLVREYLRXVO\QRWDJRRGLGHD,QVWHSROGGDWDÀOHVDUHGHOHWHGWRSUHYHQW
FROOLVLRQZLWKWKHQHZÀOHV,I,QQR'%GHWHFWVDQH[LVWLQJÀOHZKRVHVL]HGLIIHUVIURPWKHVL]H
GHÀQHGLQWKHinnodb_data_file_pathYDULDEOHLWZLOOQRWLQLWLDOL]HVXFFHVVIXOO\+HQFHWKLV
VWHSHQVXUHVWKDWQHZSURSHUO\VDYHGÀOHVFDQEHFUHDWHGGXULQJWKHQH[W0\64/VWDUW

&KDSWHU

1RWHWKDWGHOHWLRQRIWKH,QQR'%GDWDÀOHVLVRQO\VXIÀFLHQWLIDOO,QQR'%
WDEOHVZHUHGHOHWHGSUHYLRXVO\DVGLVFXVVHGLQWKH*HWWLQJUHDG\VHFWLRQ
$OWHUQDWLYHO\\RXFRXOGGHOHWHDOO*.frmÀOHVIRU,QQR'%WDEOHVIURPWKH0\64/GDWDGLUHFWRU\
EXWZHGRQRWHQFRXUDJHWKLVDSSURDFKFOHDQGHOHWLRQXVLQJDROPTABLEVWDWHPHQWVVKRXOG
EHSUHIHUUHGRYHUPDQXDOLQWHUYHQWLRQLQ0\64/GDWDGLUHFWRULHVZKHQHYHUSRVVLEOH
6WHSLVQHFHVVDU\WRSUHYHQW,QQR'%HUURUVDIWHUWKHGDWDÀOHVDUHFUHDWHGDVWKH,QQR'%
HQJLQHUHIXVHVWRVWDUWLIWKHORJÀOHVDUHROGHUWKDQWKHWDEOHVSDFHÀOHV:LWKVWHSVDQG
WKHQHZVHWWLQJVWDNHHIIHFW
:KHQVWDUWLQJWKHGDWDEDVHIRUWKHÀUVWWLPHDIWHUFKDQJHVEHLQJ
PDGHWRWKH,QQR'%WDEOHVSDFHFRQÀJXUDWLRQWDNHDORRNDWWKH
0\64/HUURUORJWRPDNHVXUHWKHVHWWLQJVZHUHDFFHSWHGDQGQR
HUURUVKDYHRFFXUUHG
7KH0\64/HUURUORJDIWHUWKHÀUVWVWDUWZLWKWKHQHZVHWWLQJVZLOOORRNVLPLODUWRWKLV
InnoDB: The first specified data file E:\MySQL\InnoDBTest\ibdata1 did 
not exist:
InnoDB: a new database to be created! 
091115 21:35:56  InnoDB: Setting file E:\MySQL\InnoDBTest\ibdata1 size 
to 200 MB
InnoDB: Database physically writes the file full: wait...
InnoDB: Progress in MB: 100 200 
...
InnoDB: Progress in MB: 100 
091115 21:36:19  InnoDB: Log file .\ib_logfile0 did not exist: new to 
be created
InnoDB: Setting log file .\ib_logfile0 size to 24 MB
InnoDB: Database physically writes the file full: wait... 
...
InnoDB: Doublewrite buffer not found: creating new 
InnoDB: Doublewrite buffer created 
InnoDB: Creating foreign key constraint system tables 
InnoDB: Foreign key constraint system tables created 
091115 21:36:22  InnoDB: Started; log sequence number 0 0 
091115 21:36:22 [Note] C:\Program Files\MySQL\MySQL Server 5.1\bin\
mysqld: ready for connections.
Version: '5.1.31-community-log'  socket: ''  port: 3306  MySQL 
Community Server (GPL) 

&RQÀJXULQJ0\64/

7KHUH
VPRUH
,I\RXDOUHDG\XVHDÀ[HGWDEOHVSDFHDQG\RXZDQWWRLQFUHDVHWKHDYDLODEOHVSDFH\RX
FDQVLPSO\DSSHQGDGGLWLRQDOÀOHVWR\RXUÀ[HGWDEOHVSDFHE\DGGLQJDGGLWLRQDOGDWDÀOH
GHÀQLWLRQVWRWKHFXUUHQWinnodb_data_file_pathYDULDEOHVHWWLQJ,I\RXVLPSO\DSSHQG
DGGLWLRQDOÀOHV\RXGRQRWKDYHWRHPSW\\RXUWDEOHVSDFHÀUVWEXW\RXFDQFKDQJHWKH
FRQÀJXUDWLRQDQGVLPSO\UHVWDUW\RXUGDWDEDVH1HYHUWKHOHVVDVZLWKDOOFKDQJHVWRWKH
FRQÀJXUDWLRQZHVWURQJO\HQFRXUDJHFUHDWLQJDEDFNXSRI\RXUGDWDEDVHÀUVW
6HHDOVR
f
%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD
f
(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQWV
6HWWLQJXSDQDXWRH[WHQGLQJ,QQR'%
WDEOHVSDFH
7KHSUHYLRXVUHFLSHGHPRQVWUDWHVKRZWRGHÀQHDWDEOHVSDFHZLWKDFHUWDLQÀ[HGVL]H:KLOH
WKLVSURYLGHVPD[LPXPFRQWURODQGSUHGLFWDELOLW\\RXKDYHWREORFNGLVNVSDFHEDVHGRQWKH
HVWLPDWHRIWKHPD[LPXPVL]HUHTXLUHGLQWKHIRUHVHHDEOHIXWXUH$VORQJDV\RXVWRUHOHVV
GDWDLQ\RXUGDWDEDVHWKDQWKHUHVHUYHGWDEOHVSDFHDOORZVIRUWKLVEDVLFDOO\PHDQVVRPHGLVN
VSDFHLVZDVWHG7KLVHVSHFLDOO\KROGVWUXHLI\RXUVHWWLQJGRHVQRWDOORZIRUDVHSDUDWHÀOH
V\VWHPH[FOXVLYHO\IRU\RXU0\64/LQVWDQFHEHFDXVHWKHQRWKHUDSSOLFDWLRQVFRPSHWHIRUGLVN
VSDFHDVZHOO,QWKHVHFDVHVDG\QDPLFWDEOHVSDFHWKDWVWDUWVZLWKOLWWOHVSDFHDQGJURZVDV
QHHGHGFRXOGEHDQDOWHUQDWLYH7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRDFKLHYHWKLV
*HWWLQJUHDG\
:KHQGHÀQLQJDQDXWRH[WHQGLQJWDEOHVSDFH\RXVKRXOGÀUVWKDYHDQLGHDDERXWWKH
PLQLPXPWDEOHVSDFHUHTXLUHPHQWVRI\RXUGDWDEDVHZKLFKZLOOVHWWKHLQLWLDOVL]HRIWKH
WDEOHVSDFH)XUWKHUPRUH\RXKDYHWRGHFLGHZKHWKHU\RXZDQWWRVSOLW\RXULQLWLDOWDEOHVSDFH
LQWRÀOHVRIDFHUWDLQPD[LPXPVL]HIRUEHWWHUÀOHKDQGOLQJ
,IWKHDERYHVHWWLQJVDUHLGHQWLFDOWRWKHFXUUHQWVHWWLQJVDQG\RXRQO\ZDQWWRPDNH\RXU
WDEOHVSDFHJURZDXWRPDWLFDOO\LIQHFHVVDU\\RXZLOOEHDEOHWRNHHS\RXUGDWD2WKHUZLVH\RX
KDYHWRHPSW\\RXUFXUUHQW,QQR'%WDEOHVSDFHFRPSOHWHO\SOHDVHUHIHUWRWKHSUHYLRXVUHFLSH
6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFHIRUGHWDLOV
$VZLWKDOOPDMRUFRQÀJXUDWLRQFKDQJHVWR\RXUGDWDEDVHZHVWURQJO\DGYLVH\RXWRFUHDWHD
EDFNXSRI\RXUGDWDÀUVW,I\RXKDYHWRHPSW\\RXUWDEOHVSDFH\RXFDQXVHWKLVEDFNXSWR
UHFRYHU\RXUGDWDDIWHUWKHFKDQJHVDUHFRPSOHWHG$JDLQSOHDVHUHIHUWRWKHFKDSWHU%DFNLQJ
8SDQG5HVWRULQJ0\64/'DWDIRUIXUWKHULQIRUPDWLRQRQWKLV

&KDSWHU

$QGDVEHIRUH\RXKDYHWRPDNHVXUHWKDWWKHUHLVHQRXJKGLVNVSDFHDYDLODEOHLQWKH
innodb_data_home_dirGLUHFWRU\³QRWRQO\IRUWKHLQLWLDOGDWDEDVHVL]HEXWDOVRIRUWKH
DQWLFLSDWHGJURZWKRI\RXUGDWDEDVH
7KHUHFLSHDOVRUHTXLUHV\RXWRVKXWGRZQ\RXUGDWDEDVHWHPSRUDULO\VR\RXKDYHWRPDNHVXUH
DOOFOLHQWVDUHGLVFRQQHFWHGZKLOHSHUIRUPLQJWKHUHTXLUHGVWHSVWRSUHYHQWFRQÁLFWLQJDFFHVV
$VWKHUHFLSHGHPDQGVFKDQJHVWR\RXU0\64/FRQÀJXUDWLRQÀOHmy.cnfRUmy.ini\RX
QHHGZULWHDFFHVVWRWKLVÀOH
)RUWKHIROORZLQJH[DPSOHZHZLOOXVHDQDXWRH[WHQGLQJWDEOHVSDFHZLWKDQLQLWLDOVL]HRI
0%DQGDÀOHVL]HRI0%
+RZWRGRLW

2SHQWKH0\64/FRQÀJXUDWLRQÀOHmy.iniRUmy.cnfLQDWH[WHGLWRU

,GHQWLI\WKHOLQHVWDUWLQJZLWKinnodb_data_file_pathLQWKH[mysqld]VHFWLRQ
,IQRVXFKOLQHH[LVWVDGGWKHOLQHWRWKHÀOH

&KDQJHWKHOLQHinnodb_data_file_pathWRUHDGDVIROORZV
innodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend
1RWHWKDWQRÀOHGHÀQLWLRQH[FHSWWKHODVWRQHPXVW
KDYHWKH:autoextendRSWLRQ\RXZLOOUXQLQWRHUURUV
RWKHUZLVH

6DYHWKHFKDQJHGFRQÀJXUDWLRQÀOH

6KXWGRZQ\RXUGDWDEDVHLQVWDQFHLIUXQQLQJ

'HOHWHSUHYLRXV,QQR'%GDWDÀOHVW\SLFDOO\FDOOHGibdata1ibdata2DQGVRRQ
IURPWKHGLUHFWRU\GHÀQHGE\WKHinnodb_data_home_dirYDULDEOH

'HOHWHSUHYLRXV,QQR'%ORJÀOHVQDPHGib_logfile0ib_logfile1DQGVRRQ
IURPWKHGLUHFWRU\GHÀQHGE\WKHinnodb_log_group_home_dirYDULDEOH
,Iinnodb_log_group_home_dirLVQRWFRQÀJXUHG
H[SOLFLWO\LWGHIDXOWVWRWKHdatadirGLUHFWRU\
 6WDUW\RXUGDWDEDVH
 :DLWIRUDOOGDWDDQGORJÀOHVWREHFUHDWHG

&RQÀJXULQJ0\64/

'HSHQGLQJRQWKHVL]HRI\RXUWDEOHVSDFHDQGWKHVSHHGRI\RXUGLVNV\VWHP
FUHDWLRQRI,QQR'%GDWDÀOHVFDQWDNHDVLJQLÀFDQWDPRXQWRIWLPHVHYHUDO
PLQXWHVLVQRWDQXQFRPPRQWLPHIRUODUJHULQVWDOODWLRQV'XULQJWKLV
LQLWLDOL]DWLRQVHTXHQFH0\64/LVVWDUWHGEXWZLOOQRWDFFHSWDQ\UHTXHVWV
:KHQVWDUWLQJWKHGDWDEDVHIRUWKHÀUVWWLPHDIWHUFKDQJHVEHLQJPDGHWRWKH
,QQR'%WDEOHVSDFHFRQÀJXUDWLRQWDNHDORRNDWWKH0\64/HUURUORJWRPDNH
VXUHWKHVHWWLQJVZHUHDFFHSWHGDQGQRHUURUVKDYHRFFXUUHG
+RZLWZRUNV
7KHDERYHVWHSVDUHEDVLFDOO\LGHQWLFDOWRWKHVWHSVRIWKHSUHYLRXVUHFLSH6HWWLQJXSDÀ[HG
,QQR'%WDEOHVSDFHWKHRQO\GLIIHUHQFHEHLQJWKHGHÀQLWLRQRIWKHinnodb_data_file_path
YDULDEOH,QWKLVUHFLSHZHFUHDWHWZRÀOHVRI0%VL]HWKHODVWRQHKDYLQJDQDGGLWLRQDO
:autoextendSURSHUW\
,IWKHinnodb_data_file_pathYDULDEOHLVQRWVHWH[SOLFLWO\LWGHIDXOWVWR
WKHYDOXHibdata1:10M:autoextend.
$VGDWDJHWVLQVHUWHGLQWRWKHGDWDEDVHSDUWVRIWKHWDEOHVSDFHZLOOEHDOORFDWHG$VVRRQ
DVWKH0%RILQLWLDOWDEOHVSDFHLVQRWVXIÀFLHQWDQ\PRUHWKHÀOHibdata2ZLOOEHFRPH
ODUJHUWRPDWFKWKHDGGLWLRQDOWDEOHVSDFHUHTXLUHPHQWV
1RWHWKDWWKH:autoextendRSWLRQFDXVHVWKHWDEOHVSDFHÀOHVWREH
H[WHQGHGDXWRPDWLFDOO\EXWWKH\DUHQRWDXWRPDWLFDOO\UHGXFHGLQVL]HDJDLQ
LIWKHVSDFHUHTXLUHPHQWVGHFUHDVH3OHDVHUHIHUWRWKH'HFUHDVLQJ,QQR'%
WDEOHVSDFHUHFLSHIRULQVWUXFWLRQVRQKRZWRIUHHXQXVHGWDEOHVSDFH
7KHUH
VPRUH
7KHUHFLSHRQO\FRYHUVWKHEDVLFDVSHFWVRIDXWRH[WHQGLQJWDEOHVSDFHVWKHIROORZLQJVHFWLRQV
SURYLGHLQVLJKWLQWRVRPHPRUHDGYDQFHGWRSLFV
0DNLQJDQH[LVWLQJWDEOHVSDFHDXWRH[WHQVLEOH
,I\RXDOUHDG\KDYHDGDWDEDVHZLWKOLYHGDWDLQSODFHDQG\RXZDQWWRFKDQJH\RXUFXUUHQW
À[HGFRQÀJXUDWLRQWRXVHWKHDXWRH[WHQVLRQIHDWXUH\RXFDQVLPSO\DGGWKH:autoextend
RSWLRQWRWKHODVWÀOHGHÀQLWLRQ

&KDSWHU

/HWXVDVVXPHDFXUUHQWFRQÀJXUDWLRQOLNHWKHIROORZLQJ
innodb_data_file_path=ibdata1:50M;ibdata2:50M
7KHUHVSHFWLYHFRQÀJXUDWLRQZLWKDXWRH[WHQVLRQZLOOORRNOLNHWKLV
innodb_data_file_path=ibdata1:50M;ibdata2:50M:autoextend
,QWKLVFDVHGRQRWHPSW\WKH,QQR'%WDEOHVSDFHÀUVW\RXFDQVLPSO\FKDQJHWKHFRQ
ÀJXUDWLRQÀOHDQGUHVWDUW\RXUGDWDEDVHDQG\RXVKRXOGEHÀQH$VZLWKDOOFRQÀJXUDWLRQ
FKDQJHVKRZHYHUZHVWURQJO\UHFRPPHQGWREDFNXS\RXUGDWDEDVHEHIRUHHGLWLQJWKHVH
VHWWLQJVHYHQLQWKLVFDVH
&RQWUROOLQJWKHVWHSVRIWDEOHVSDFHH[WHQVLRQ
7KHDPRXQWE\ZKLFKWKHVL]HRIWKHDXWRH[WHQGLQJWDEOHVSDFHÀOHLVLQFUHDVHGLVFRQWUROOHG
E\WKHinnodb_autoextend_incrementYDULDEOH7KHYDOXHRIWKLVYDULDEOHGHÀQHVWKH
QXPEHURI0HJDE\WHVE\ZKLFKWKHWDEOHVSDFHLVHQODUJHG%\GHIDXOW0%DUHDGGHGWR
WKHÀOHLIWKHFXUUHQWWDEOHVSDFHLVQRORQJHUVXIÀFLHQW
/LPLWLQJWKHVL]HRIDQDXWRH[WHQGLQJWDEOHVSDFH
,I\RXZDQWWRXVHDQDXWRH[WHQGLQJWDEOHVSDFHEXWDOVRZDQWWROLPLWWKHPD[LPXPVL]H\RXU
WDEOHVSDFHZLOOJURZWR\RXFDQDGGDPD[LPXPVL]HIRUWKHDXWRH[WHQGHGWDEOHVSDFHÀOH
E\XVLQJWKH:autoextend:max:[size]RSWLRQ7KH[size]SRUWLRQLVDSODFHKROGHUIRU
DVL]HGHÀQLWLRQXVLQJWKHVDPHQRWDWLRQDVWKHVL]HGHVFULSWLRQIRUWKHWDEOHVSDFHÀOHLWVHOI
ZKLFKPHDQVDQXPHULFYDOXHDQGDQRSWLRQDOKMRUGPRGLÀHUIRUVL]HVLQ.LOR0HJDDQG
*LJDE\WHV$VDQH[DPSOHLI\RXZDQWWRKDYHDWLQ\LQLWLDOWDEOHVSDFHRI0%ZKLFKLVH[
WHQGHGDVQHHGHGEXWZLWKDQXSSHUOLPLWRI*%\RXZRXOGHQWHUWKHIROORZLQJOLQHWR\RXU
0\64/FRQÀJXUDWLRQÀOH
innodb_data_file_path=ibdata1:10M:autoextend:max:2G
1RWHWKDWLIWKHPD[LPXPVL]HLVUHDFKHG\RXZLOOUXQLQWRHUURUVZKHQWU\LQJ
WRDGGQHZGDWDWR\RXUGDWDEDVH
$GGLQJDQHZDXWRH[WHQGLQJGDWDÀOH
,PDJLQHDQDXWRH[WHQGLQJWDEOHVSDFHZLWKDQDXWRH[WHQGHGÀOHZKLFKJUHZVRODUJHRYHUWLPH
WKDW\RXZDQWWRSUHYHQWWKHÀOHIURPJURZLQJIXUWKHUDQGZDQWWRDSSHQGDQHZDXWRH[WHQGLQJ
GDWDÀOHWRWKHWDEOHVSDFH<RXFDQGRVRXVLQJWKHIROORZLQJVWHSV

6KXWGRZQ\RXUGDWDEDVHLQVWDQFH

/RRNXSWKHH[DFWVL]HRIWKHDXWRH[WHQGHG,QQR'%GDWDÀOHWKHODVWÀOHLQ\RXU
FXUUHQWFRQÀJXUDWLRQ

&RQÀJXULQJ0\64/


3XWWKHH[DFWVL]HDVWKHWDEOHVSDFHÀOHVL]HGHÀQLWLRQLQWRWKHin-
nodb_data_file_pathFRQÀJXUDWLRQQXPEHURIE\WHVZLWKRXWDQ\K
MRUGPRGLÀHUDQGDGGDQHZDXWRH[WHQGLQJGDWDÀOH

5HVWDUW\RXUGDWDEDVH
$VDQH[DPSOHLI\RXUFXUUHQWFRQÀJXUDWLRQUHDGVibdata1:10M:autoextendDQG
WKHibdata1ÀOHKDVDQDFWXDOVL]HRIE\WHVFKDQJHFRQÀJXUDWLRQWR
innodb_data_file_path=ibdata1:44040192;ibdata2:10M:autoextend:max:2G
6HHDOVR
f
%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD
f
(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQWV
f
6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFH
f
'HFUHDVLQJ,QQR'%WDEOHVSDFH
6WRULQJ,QQR'%GDWDLQRQHÀOHSHUWDEOH
,QWKHSUHYLRXVUHFLSHVZHSUHVHQWHGDZD\WRGHÀQHDFRPPRQWDEOHVSDFHLQZKLFKWKH
,QQR'%VWRUDJHHQJLQHVWRUHVDOOGDWDIRU,QQR'%WDEOHV:KLOHWKLVKDVVRPHDGYDQWDJHV
IRUH[DPSOHG\QDPLFUHXVHRIIUHHVSDFHDFURVVWDEOHVWKLVDSSURDFKLVFRPSOHWHO\
GLIIHUHQWIURPWKH0\,6$0WHFKQLTXHWKDWVWRUHVWKHGDWDIRUHDFKWDEOHLQDVHSDUDWHÀOH
7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRFRQÀJXUH,QQR'%WRVWRUHGDWDLQVHSDUDWHVÀOHV
RQHIRUHDFKWDEOH
*HWWLQJUHDG\
7KHIROORZLQJVWHSVLQFOXGHDGDWDEDVHGRZQWLPHVR\RXKDYHWRSUHSDUHDPDLQWHQDQFH
ZLQGRZIRU\RXUGDWDEDVHWKDWDOORZV\RXWRFRPSOHWHWKHVWHSVZLWKRXWLQWHUIHULQJZLWKFOLHQWV
VWLOODFFHVVLQJWKHGDWDEDVH
+RZWRGRLW

&UHDWHD64/GXPSRI\RXUHQWLUHGDWDEDVH

6KXWGRZQ\RXUGDWDEDVH

2SHQWKH0\64/FRQÀJXUDWLRQÀOHmy.iniRUmy.cnfLQDWH[WHGLWRU

&KDSWHU


$GGWKHIROORZLQJOLQHWRWKH[mysqld]VHFWLRQ
innodb_file_per_table

6DYHWKHFKDQJHGFRQÀJXUDWLRQÀOH

6WDUW\RXUGDWDEDVHLQVWDQFH

5HFRYHUDOOGDWDIURPWKH64/GXPSFUHDWHGLQVWHS
+RZLWZRUNV
7KLVUHFLSHLVSUHWW\VWUDLJKWIRUZDUGFUHDWHDEDFNXSDGGWKHinnodb_file_per_table
RSWLRQWRWKH[mysqld]FRQÀJXUDWLRQDQGUHFRYHUGDWDIURPWKHEDFNXSSOHDVHUHIHUWRWKH
FKDSWHU%DFNLQJ8SDQG5HVWRULQJ0\64/'DWDIRUGHWDLOV%XWZK\WKHUHFRYHU\"
$IWHUWKHUHVWDUWRIWKHGDWDEDVHLQVWHS\RXZLOOQRWQRWLFHDQ\FKDQJHVWRWKHGDWDEDVH
$WWKLVSRLQWDOOGDWDLVVWLOOVWRUHGLQWKH,QQR'%WDEOHVSDFH7KLVLVEHFDXVHWKHÀOHSHUWDEOH
VHWWLQJRQO\DSSOLHVWRQHZO\FUHDWHGWDEOHV6WHSWDNHVFDUHRIWKLVGXULQJUHFRYHU\HYHU\
WDEOHLVGURSSHGDQGFUHDWHGDJDLQWKLVWLPHLQDVHSDUDWHÀOHEHIRUHWKHRULJLQDOGDWD
LVLQVHUWHG
7KHinnodb_file_per_tableVHWWLQJDOORZV\RXWRXVHWKHRSHUDWLQJV\VWHP
VPHDQVWR
PDSWDEOHVWRGLIIHUHQWSK\VLFDOGLVNVRUWREDFNXSDQGUHFRYHUFHUWDLQWDEOHVRQWKHÀOHOHYHO
+RZHYHUQRWHWKDWZLWKWKLVDSSURDFKHDFKWDEOHKDVLWVRZQDXWRH[WHQGLQJ
WDEOHVSDFH³H[WHQVLRQ\HVEXWQRUHGXFWLRQ
,I\RXGHOHWHGDWDIURPDWDEOHWKHÀOHVL]HZLOOQRWUHGXFHDXWRPDWLFDOO\$VHDFKWDEOH
XVHVLWVRZQWDEOHVSDFHWKLVPHDQVWKDWWKHVSDFHWKDWJHWVIUHHGE\GHOHWLQJIURPRQH
WDEOHFDQQRWEHUHXVHGE\DQRWKHUWDEOHDVLVWKHFDVHIRUWKHFODVVLFDOVKDUHG,QQR'%
WDEOHVSDFH7KHUHLVDZD\WRIUHHXQXVHGVSDFHDJDLQSOHDVHUHIHUWRWKHIROORZLQJUHFLSH
'HFUHDVLQJ,QQR'%WDEOHVSDFHIRULQVWUXFWLRQVRQKRZWRGRWKLV
6HHDOVR
f
%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD
f
'HFUHDVLQJ,QQR'%WDEOHVSDFH

&RQÀJXULQJ0\64/

'HFUHDVLQJ,QQR'%WDEOHVSDFH
7KHSUHYLRXVUHFLSHVHQDEOH\RXWRGHÀQHDWDEOHVSDFHDQGIRUWKHautoextendDQG
innodb_file_per_tableDSSURDFKHVWKHWDEOHVSDFHZLOOJURZXQWLO\RXUXQRXWRIGLVN
VSDFHRU\RXKLWDÀOHVL]HERXQGDU\VHWE\\RXURSHUDWLQJV\VWHP7KHRSSRVLWHGLUHFWLRQ
KRZHYHUGRHVQRWZRUNDVHDVLO\,QQR'%ODFNVDQDXWRPDWLFVKULQNRSWLRQLI\RXKDSSHQWR
GHOHWHGDWDIURP\RXUGDWDEDVH7KHIROORZLQJUHFLSHZLOOLQWURGXFHZD\VWRUHGXFHWKHVL]H
RI\RXU,QQR'%WDEOHVSDFHLI\RXUVWRUDJHUHTXLUHPHQWVGHFUHDVH
*HWWLQJUHDG\
$VWKHIROORZLQJUHFLSHLQYROYHVFUHDWLRQRIDEDFNXSGXPSRI\RXUGDWDEDVH\RXKDYHWR
UHVHUYHHQRXJKGLVNVSDFHWRWHPSRUDULO\VWRUHWKHGXPSÀOH)XUWKHUPRUHLI\RXZDQWWR
HVWDEOLVKDVKDUHGWDEOHVSDFHZLWKDUHGXFHGVL]H\RXKDYHWRGHFLGHDERXWWKHVL]HRIWKH
WDEOHVSDFHDQGKRZWRVSOLWLWLQWRVHSDUDWHÀOHV)RUDÀ[HGVL]HWDEOHVSDFH\RXDGGLWLRQDOO\
KDYHWRFDOFXODWHWKHVSDFHUHTXLUHPHQWVRI\RXUFXUUHQWGDWDSOHDVHUHIHUWRWKH(VWLPDWLQJ
WDEOHVSDFHUHTXLUHPHQWVUHFLSHLQ&KDSWHUIRUGHWDLOVWRGHFLGHDERXWWKHQHZVL]HRIWKH
À[HGWDEOHVSDFH
7KHUHFLSHDOVRUHTXLUHV\RXWRVKXWGRZQ\RXUGDWDEDVHWHPSRUDULO\VR\RXKDYHWRPDNH
VXUH\RXKDYHDPDLQWHQDQFHLQWHUYDOLQZKLFKWKHGDWDEDVHLVQRWDFFHVVHGE\DQ\FOLHQWV
+RZWRGRLW

&UHDWHDIXOOEDFNXSRI\RXUGDWDEDVHIRUIXUWKHULQVWUXFWLRQVSOHDVHVHHWKH%DFNLQJ
8SDQG5HVWRULQJ0\64/'DWDFKDSWHU

'URSDOOGDWDEDVHVH[FHSWIRUWKHmysqlDQGinformation_schemaGDWDEDVHV

6KXWGRZQ\RXUGDWDEDVH

2SHQWKH0\64/FRQÀJXUDWLRQÀOHmy.iniRUmy.cnfXVLQJDWH[WHGLWRU

&RQÀJXUHWKH,QQR'%WDEOHVSDFHDFFRUGLQJWR\RXUQHZUHGXFHGVSDFHUHTXLUHPHQWV
SOHDVHUHIHUWRWKHSUHYLRXVUHFLSHVIRUIXUWKHUGHWDLOV

6DYHWKHFKDQJHGFRQÀJXUDWLRQÀOH

'HOHWHWKHROG,QQR'%GDWDÀOHVW\SLFDOO\FDOOHGibdata1ibdata2DQGVRRQ
IURPWKHGLUHFWRU\GHÀQHGE\WKHinnodb_data_home_dirYDULDEOH

'HOHWHSUHYLRXV,QQR'%ORJÀOHVQDPHGib_logfile0ib_logfile1DQGVRRQ
IURPWKHGLUHFWRU\GHÀQHGE\WKHinnodb_log_group_home_dirYDULDEOH

&KDSWHU

,Iinnodb_log_group_home_dirLVQRWFRQÀJXUHG
H[SOLFLWO\LWGHIDXOWVWRWKHdatadirGLUHFWRU\

6WDUW\RXUGDWDEDVHLQVWDQFH
 :DLWIRUDOOGDWDDQGORJÀOHVWREHFUHDWHG
 5HFRYHUDOOGDWDIURPWKH64/GXPSFUHDWHGLQVWHS
+RZLWZRUNV
7KLVUHFLSHLVEDVLFDOO\DVOLJKWPRGLÀFDWLRQRIWKHSUHYLRXVUHFLSHVWRVHWXSDVKDUHG
WDEOHVSDFH7KHDGGLWLRQDOVWHSVDUHEDFNLQJXS\RXUGDWDEDVHDQGVXEVHTXHQWO\GURSSLQJDOO
GDWDEDVHVLQLWLDOO\DQGWKHUHFRYHU\IURPWKHEDFNXSDVWKHÀQDOVWHS7KLVHQVXUHVWKDWGDWD
GLUHFWRU\HQWULHVIRUDOO,QQR'%WDEOHVDUHUHPRYHGÁDZOHVVO\DQGLQWKHFDVHRIWKHÀOHSHU
WDEOHRSWLRQDOOVWRUDJHÀOHVDUHUHPRYHG7KHVKDUHGWDEOHVSDFHLVFUHDWHGZKHQVWDUWLQJWKH
0\64/LQVWDQFHDIWHUWKHFRQÀJXUDWLRQFKDQJHV,IWKHinnodb_file_per_tableRSWLRQLV
XVHGWKHWDEOHÀOHVDUHFUHDWHGGXULQJWKHGDWDUHFRYHU\,QFDVHRIDQDXWRH[WHQGLQJVKDUHG
WDEOHVSDFHWKHUHVWRUDWLRQRIWKHGDWDPLJKWFDXVHWKHWDEOHVSDFHWRLQFUHDVHLQVL]HEXW
RQO\WRWKHVL]HDFWXDOO\QHHGHGE\WKHFXUUHQWGDWD
$VWKLVDSSURDFKPLJKWUHTXLUHDVLJQLÀFDQWGRZQWLPHIRUDQ\FOLHQWZHSURSRVHSHUIRUPLQJ
DWDEOHVSDFHUHGXFWLRQRQO\LIDEVROXWHO\QHFHVVDU\³ZLWKWKRURXJKSODQQLQJRI\RXUVWRUDJH
UHTXLUHPHQWV\RXUGLVNVWUXFWXUHDQG\RXUWDEOHVSDFHVL]LQJ\RXKRSHIXOO\ZLOOQRWQHHGWR
UHVL]H\RXUWDEOHVSDFHRQDUHJXODUEDVLV
7KHUH
VPRUH
,I\RXXVHWKHinnodb_file_per_tableIHDWXUHDQG\RXZDQWWRUHGXFHWKHVL]HRIWKH
VHSDUDWHÀOHVWRWKHFXUUHQWO\QHHGHGVL]H\RXKDYHDQDOWHUQDWLYHWKDWGRHVQRWLQFOXGHWKH
IXOOGXPSGHOHWLRQDQGUHFRYHU\SURFHGXUH
7RIUHHXQXVHGWDEOHVSDFHZLWKinnodb_file_per_tableLQSODFH\RX
FDQH[HFXWHDQHPSW\ALTER TABLEVWDWHPHQW
ALTER TABLE example_table ENGINE=InnoDB;
<RXKDYHWRH[HFXWHWKLVFRPPDQGIRUHDFK,QQR'%WDEOHZKRVHVWRUDJHÀOH\RXZDQWWR
UHVL]H+RZHYHUQRWHWKDWWKLVWHPSRUDULO\FUHDWHVDFRS\RIWKHZKROHWDEOHDQGORFNVWKH
WDEOHGXULQJWKHSURFHVV

&RQÀJXULQJ0\64/

'XHWRSRWHQWLDOORFNLQJFRQÁLFWVWU\WRDYRLGIUHHLQJXQXVHGWDEOHVSDFH
XVLQJWKHALTER TABLEFRPPDQGZLWKODUJHDQGRUKHDYLO\XVHGWDEOHV
LQDUXQQLQJV\VWHP
6HHDOVR
f
%DFNLQJ8SDQG5HVWRULQJ0\64/'DWD
f
(VWLPDWLQJWDEOHVSDFHUHTXLUHPHQW
f
6HWWLQJXSDÀ[HG,QQR'%WDEOHVSDFH
f
6HWWLQJXSDQDXWRH[WHQGLQJ,QQR'%WDEOHVSDFH
f
6WRULQJ,QQR'%GDWDLQRQHÀOHSHUWDEOH
(QDEOLQJDQGFRQÀJXULQJELQDU\ORJJLQJ
%LQDU\ORJJLQJRUELQORJJLQJIRUVKRUWGHVFULEHVDIHDWXUHRI0\64/WKDWZLOOZULWHD
WUDQVFULSWRIDOOVWDWHPHQWVLVVXHGWKDWDFWXDOO\PRGLÀHGRUFRXOGKDYHPRGLÀHGGDWD7KLV
LQFOXGHVUPDATEINSERTDQGDELETEVWDWHPHQWVUHJDUGOHVVRIZKHWKHUWKH\DFWXDOO\
PDWFKHGDQ\URZVRQWKHVHUYHUDVZHOODVGDWDGHÀQLWLRQODQJXDJHVWDWHPHQWVCREATE 
TABLEDROP TABLEDQGWKHOLNH
7KLVSURWRFROLVZULWWHQLQDVSHFLDOIRUPDWWKDWFRQWDLQVPHWDGDWDDERXWWUDQVDFWLRQVVHUYHU
VHWWLQJVDQGPRUHZKLFKPDNHVLWVXLWDEOHDVDEDVLVIRUERWKUHSOLFDWLRQEDFNXSVDQGHYHQ
FKDQJHDXGLWLQJZLWKWKHIRUPHUWZREHLQJWKHPRVWLPSRUWDQWRQHV
*HQHUDOO\ZHGRQRWUHFRPPHQGUXQQLQJ0\64/ZLWKRXWELQORJJLQJDVWKH
SHUIRUPDQFHSHQDOW\LVYHU\ORZ³WKH0\64/PDQXDOVSHDNVRIDVSHHG
GHJUDGDWLRQRIDERXW³DQGWKHEHQHÀWVFOHDUO\RXWZHLJKWKLV
<RXFDQÀQGGHWDLOHGLQIRUPDWLRQDERXWWKHELQDU\ORJLQVHFWLRQ7KH%LQDU\/RJRIWKH
RQOLQHPDQXDODWhttp://dev.mysql.com/doc/refman/5.1/en/binary-log.html
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRPDNHVXUH\RXU0\64/VHUYHUVDUHFRQÀJXUHGWRZULWH
ELQDU\ORJVLQWKHÀUVWSODFHDQGDOVRNHHSWKHPPDLQWDLQDEOHLQWHUPVRIÀOHVL]HV
*HWWLQJUHDG\
$VWKHELQDU\ORJVHWXSLVDSDUWRIWKHVHUYHUFRQÀJXUDWLRQ\RXZLOOQHHGDQRSHUDWLQJ
V\VWHPXVHUDFFRXQWDQGVXIÀFLHQWULJKWVWRPRGLI\WKHVHUYHU
VFRQÀJXUDWLRQÀOH0RUHRYHU
LWLVUHFRPPHQGHGWRKDYHVXIÀFLHQWULJKWVWRUHVWDUWWKH0\64/VHUYLFHEHFDXVHELQORJJLQJ
FDQQRWEHUHFRQÀJXUHGRQWKHÁ\

&KDSWHU

+RZWRGRLW

2SHQWKH0\64/FRQÀJXUDWLRQÀOHW\SLFDOO\my.cnfRUmy.iniRQ:LQGRZV

/RFDWHWKH[mysqld]VHFWLRQLQWKHÀOH

$GGWKHIROORZLQJVHWWLQJVRUHGLWWKHPLIWKH\DUHDOUHDG\SUHVHQW$GDSWWKHSDWK
DIWHUlog_binDQGÀOOLQDSDWKYDOLGRQ\RXUVHUYHU6XEVWLWXWH\RXUVHUYHU
VPDFKLQH
QDPHIRUHOSTNAME
log_bin=/var/log/mysql/+2671$0(-bin
expire_logs_days=10
max_binlog_size=200M

6DYHWKHÀOH

5HVWDUWWKH0\64/VHUYLFH

&KHFNWKHGLUHFWRU\\RXVSHFLÀHGIRUlog-bin<RXVKRXOGVHHDÀOHFDOOHGHOST-
NAME-bin.000001WKHUHDQGDFRUUHVSRQGLQJHOSTNAME-bin.indexÀOH
+RZLWZRUNV
7KHÀUVWSDUDPHWHUlog_binWHOOVWKHVHUYHUZKLFKGLUHFWRU\LVLQWHQGHGWRVWRUHWKHELQDU\
ORJV7KLVVKRXOGEHDVWRUDJHYROXPHZLWKVXIÀFLHQWVSDFHDQGLGHDOO\RQDGLIIHUHQWSK\VLFDO
GLVNWKDQWKHGDWDGLUHFWRU\IRUEHWWHUSHUIRUPDQFH7KHDPRXQWRIGLVNVSDFHUHTXLUHG
GHSHQGVRQWKHDPRXQWRIZULWHDFFHVVWR\RXUGDWDEDVHV
$OOGDWDEDVHVRIRQHVHUYHUVKDUHWKHVDPHELQORJÀOHVPHDQLQJ\RXKDYHWR
FRQVLGHUWKLVLQ\RXUVSDFHHVWLPDWLRQ
7KHexpire_logs_daysVHWWLQJLVPHDQWWRSUHYHQWH[FHVVLYHGLVNVSDFHXVDJHE\ROGHU
ELQORJV$VHWWLQJRIPHDQVWKDWDQ\ELQDU\ORJÀOHROGHUWKDQGD\VZLOOEHGHOHWHGWKH
QH[WWLPHDQHZELQDU\ORJLVVWDUWHG<RXFDQXVHWKHPURGE BINARY LOGSFRPPDQGWR
IRUFHDQHZELQDU\ORJWREHVWDUWHGPDQXDOO\
max_binlog_sizeLVPHDQWWRNHHSWKHELQORJÀOHVPDQDJHDEOHE\DXWRPDWLFDOO\VSOLWWLQJ
DQGURWDWLQJWKHPRQFHWKH\H[FHHGWKHFRQÀJXUHGVL]HWKUHVKROG3OHDVHQRWHWKDWHDFKÀOH
PLJKWLQIDFWEHFRPHVOLJKWO\ODUJHUWKDQWKHFRQÀJXUHGOLPLWEHFDXVHWUDQVDFWLRQVDUHDOZD\V
ZULWWHQDVDZKROH7KLVPHDQVWKDWZKHQDELQORJÀOHKDVDOPRVWUHDFKHGLWVVL]HOLPLWDQG
DODUJHWUDQVDFWLRQLVWKHQFRPPLWWHGLWZLOOVWLOOEHZULWWHQWRWKDWÀOHSXVKLQJLWSDVWWKH
FRQÀJXUHGWKUHVKROG

&RQÀJXULQJ0\64/

7KHUH
VPRUH
%LQDU\ORJVDUHYHU\LPSRUWDQWIRUSRLQWLQWLPHEDFNXSDQGUHFRYHU\0DNHVXUH\RXFRQÀJXUH
WKHexpire_logs_daysWRDYDOXHWKDWLVODUJHHQRXJKWRVSDQWKHWLPHEHWZHHQWZRIXOO
EDFNXSV2WKHUZLVHWKHUHZRXOGEHDFKDQFHWKDW\RXFDQQRWGRDFRPSOHWHGLVDVWHUUHFRYHU\
ZKHQWKHELQORJVKDYHDOUHDG\EHHQGHOHWHGEHIRUH\RXKDYHWDNHQWKHQH[WIXOOEDFNXS7R
FRPSOHWHO\VZLWFKRIIWKHDXWRPDWLFGHOHWLRQRIROGELQORJÀOHVVHWWKHexpire_logs_days
SDUDPHWHUWR0RUUHPRYHLWIURPWKHFRQÀJXUDWLRQÀOH
(YHQWKRXJKLWLVSRVVLEOHLWLVQRWUHFRPPHQGHGWRGHOHWHROGHUELQORJVPDQXDOO\IURPWKH
ÀOHV\VWHP'HSHQGLQJRQWKHVHUYHUYHUVLRQ\RXDUHXVLQJ0\64/PLJKWIDLOWRVWDUWZKHQLWV
LQGH[ÀOHDQGWKHELQORJVDFWXDOO\SUHVHQWGRQRWPDWFK
7RSUHYHQWSUREOHPVRIWKLVNLQGZHUHFRPPHQGDOZD\VXVLQJWKHPURGE 
BINARY LOGSFRPPDQG)RUGHWDLOVRQLWVRSWLRQVVHHWKH0\64/RQOLQH
PDQXDODWhttp://dev.mysql.com/doc/refman/5.1/en/
purge-binary-logs.html
&RQÀJXULQJWKH,QQR'%UHGRORJ
,QRUGHUWRSUHYHQWWKHWUDQVDFWLRQDOQDWXUHRI,QQR'%IURPFRPSOHWHO\WKZDUWLQJLWV
SHUIRUPDQFHLWLPSOHPHQWVZKDWLVFDOOHGWKHUHGRORJ
,QWKLVUHFLSHZHZLOOSUHVHQWWKHUHOHYDQWVHWWLQJVWRUHFRQÀJXUHDGDWDEDVHVHUYHU
V
UHGRORJ
*HWWLQJUHDG\
$VWKHUHGRORJVHWXSLVDSDUWRIWKHVHUYHUFRQÀJXUDWLRQ\RXZLOOQHHGDQRSHUDWLQJV\VWHP
XVHUDFFRXQWDQGVXIÀFLHQWULJKWVWRPRGLI\WKHVHUYHU
VFRQÀJXUDWLRQÀOH<RXZLOODOVRQHHG
ULJKWVWRUHVWDUWWKH0\64/VHUYLFHEHFDXVHWKHUHGRORJFDQQRWEHUHFRQÀJXUHGRQWKHÁ\
0RUHRYHUDQDGPLQLVWUDWLYH0\64/XVHUDFFRXQWLVUHTXLUHGWRSUHSDUHWKHVHUYHUIRUWKH
VKXWGRZQQHFHVVDU\DVSDUWRIWKHSURFHGXUH
&DXWLRQ
$VWKLVUHFLSHZLOOPRGLI\WKHFRQÀJXUDWLRQRISDUDPHWHUVFULWLFDOWRGDWD
LQWHJULW\\RXVKRXOGPDNHDEDFNXSFRS\RIWKHFRQÀJXUDWLRQÀOHEHIRUH
HGLWLQJLW

&KDSWHU

+RZWRGRLW

&RQQHFWWRWKHVHUYHUXVLQJ\RXUDGPLQLVWUDWLYHDFFRXQW

,VVXHWKHIROORZLQJFRPPDQG
mysql> SET GLOBAL innodb_fast_shutdown=0;
Query OK, 0 rows affected (0.00 sec)

9HULI\WKHVHWWLQJOLNHWKLV
mysql> SHOW VARIABLES LIKE 'innodb_fast_shutdown';

/RJRIIIURP0\64/DQGVWRSWKH0\64/VHUYHU

/RFDWHWKH0\64/FRQÀJXUDWLRQÀOHXVXDOO\FDOOHGmy.cnfRUmy.iniRQ:LQGRZV
DQGRSHQLWLQDWH[WHGLWRU

/RFDWHWKHIROORZLQJSDUDPHWHUVLQWKH[mysqld]VHFWLRQ\RXYDOXHVZLOOYDU\
RIFRXUVH
[mysqld] 
... 
innodb_log_group_home_dir=/var/lib/mysql/redolog
innodb_log_file_size=32M 
innodb_log_buffer_size=64M 
innodb_log_files_in_group=2 
...

(GLWWKHDERYHFRQÀJXUDWLRQVHWWLQJVWRWKHLUQHZYDOXHV,I\RXUHTXLUHKHOSRQKRZWR
ÀQGVXLWDEOHYDOXHVVHHWKH7KHUH
VPRUHVHFWLRQRIWKLVUHFLSH

6DYHWKHFRQÀJXUDWLRQÀOH

1DYLJDWHWRWKHGLUHFWRU\FRQÀJXUHGIRUinnodb_log_group_home_dir,IWKHUHLV
QRVXFKVHWWLQJLQ\RXUFRQÀJXUDWLRQÀOHQDYLJDWHWR0\64/
VGDWDGLUHFWRU\WKDWLV
WKHQWDNHQDVWKHGHIDXOW

&RQÀJXULQJ0\64/

 0RYHWKHÀOHVZKRVHQDPHVVWDUWZLWKib_logfileWRDEDFNXSORFDWLRQ'RQRW
FRS\WKHPWKH\PXVWEHUHPRYHGIURPWKHLURULJLQDOORFDWLRQ
 5HVWDUWWKH0\64/VHUYHU
9HULI\WKDWQHZÀOHVDUHFUHDWHGDV\RXFRQÀJXUHGWKHP
$ ls -l /var/lib/mysqld/redolog
,I\RXGRQRWVHHWKHQHZÀOHVDSSHDUDQGWKHVHUYHUGRHVQRWVWDUWXSFRUUHFWO\FKHFNWKH
0\64/HUURUORJIRUPHVVDJHV8VXDOO\WKHRQO\WKLQJWKDWFDQJRZURQJKHUHLVWKDW\RX
HLWKHUPLVW\SHGWKHGLUHFWRU\QDPHRUGLGQRWDFWXDOO\UHPRYHWKHSUHYLRXVib_logfileÀOHV
7RUHVWRUHHYHU\WKLQJEDFNWRWKHRULJLQDOFRQÀJXUDWLRQUHVWRUH\RXUFRQÀJXUDWLRQÀOHIURPWKH
EDFNXSDQGUHVWRUHWKHib_logfileÀOHV\RXPRYHGRXWWRWKHEDFNXSWRWKHLURULJLQDOORFDWLRQ
:KDWMXVWKDSSHQHG
%\VHWWLQJinnodb_fast_shutdownWR0\RXWROGWKHVHUYHUWRÀQLVKZULWLQJDQ\SHQGLQJ
FKDQJHVWRWKHGLVNEHIRUHDFWXDOO\H[LWLQJ7KLVPDNHVVXUHWKHUHDUHQRUHPDLQLQJ
WUDQVDFWLRQVLQWKHFXUUHQWUHGRORJVWKDWFRXOGJHWORVWZKHQWKHVHÀOHVDUHUHSODFHG
$IWHUWKDW\RXFRXOGFKDQJHWKHFRQÀJXUDWLRQWRQHZYDOXHVSRVVLEO\XVLQJDGLIIHUHQWQXPEHU
RIÀOHVDQGGLIIHUHQWVL]HV
7KHQEHIRUHUHVWDUWLQJ\RXFRXOGPRYHWKHROGUHGRORJÀOHVRXWRIWKHZD\7KLVLVLPSRUWDQW
EHFDXVHRWKHUZLVH0\64/ZRXOGFRPSODLQDERXWDPLVPDWFKEHWZHHQWKHVHWWLQJVÀOHDQG
WKHDFWXDOVLWXDWLRQRQGLVN:KHQLWFRPHVXSÀQGLQJQRUHGRORJÀOHVLWZLOOFUHDWHQHZRQHV
ZLWKWKHVHWWLQJVMXVWFRQÀJXUHG
7KHUH
VPRUH
2IWHQZKHQWDONLQJDERXWWUDQVDFWLRQVWKHZRUGUROOEDFNFRPHVXS,WPHDQVWKDWLIVRPHWKLQJ
JRHVZURQJLQWKHPLGGOHRIDSRVVLEO\FRPSOH[GDWDPDQLSXODWLRQRSHUDWLRQDQGLWKDVWREH
DERUWHGWKHGDWDEDVHVHUYHUZLOOVDIHO\UHVWRUHHYHU\WKLQJEDFNWRWKHVWDWHLWZDVLQZKHQWKDW
RSHUDWLRQEHJDQQRWOHDYLQJDQ\GDWDRQO\SDUWLDOO\GHOHWHGRUPRGLÀHG

&KDSWHU

7KHRSSRVLWHWHUP³UROOIRUZDUGRUUHGRLQJ³LVOHVVFRPPRQO\XVHG,WPHDQVWKDWZKHQHYHU
WKHFRPSOH[RSHUDWLRQPHQWLRQHGHDUOLHUFRPSOHWHVVXFFHVVIXOO\\RXDUHJXDUDQWHHGWKDW
QRWKLQJVKRUWRIDFWXDOKDUGZDUHIDLOXUHFRXOGOHDGWRWKHVHFKDQJHVEHLQJORVWDJDLQ
7KLVPLJKWDSSHDUREYLRXVEHFDXVHRQHZRXOGH[SHFWWKHGDWDEDVHVHUYHUQRWWRUHSRUW
DQ\WKLQJDVVXFFHVVIXOXQOHVVLWZDVDFWXDOO\FRPSOHWHO\GRQH+RZHYHULIWKDWZHUHVRZULWH
RSHUDWLRQVZRXOGEHFRPHSDLQIXOO\VORZDVWKHXQGHUO\LQJ,2VXEV\VWHPJHQHUDOO\PHDQLQJ
KDUGGLVNVLVYHU\RIWHQWKHERWWOHQHFNFRPSRQHQW
7RHYDGHWKLVSRWHQWLDOSHUIRUPDQFHSUREOHPPRVWWUDQVDFWLRQDOGDWDEDVHV,QQR'%EHLQJ
QRGLIIHUHQWXVHVWKHFRQFHSWRIDWUDQVDFWLRQ³RUUHGR³ORJWKDWDOORZVLWWRPRUHHIÀFLHQWO\
KDQGOHZULWHRSHUDWLRQVZLWKRXWULVNLQJGDWDLQWHJULW\7KHUHGRORJZRUNVDVDVRUWRIVFUDWFK
SDGFRQWDLQLQJLQIRUPDWLRQRQZKDWUHPDLQVWREHGRQHWRWKHGDWDÀOHV:LWKLWVKHOSWKH
VHUYHUFDQRSWLPL]HGLVNDFFHVVWRLPSURYHSHUIRUPDQFH
7KHLGHDOVL]HIRUWKHUHGRORJGHSHQGVRQWKHVL]HDQGQXPEHURIWUDQVDFWLRQVWKHVHUYHUKDV
WRSURFHVV*HQHUDOO\VSHDNLQJWKHORJVKRXOGEHODUJHHQRXJKWRVWRUHDQ\VLQJOHWUDQVDFWLRQ
SOXVDERXWSHUFHQW$VDUXOHRIWKXPEWKHWRWDOORJVL]HWKHQXPEHURIORJÀOHVWLPHVWKHLU
LQGLYLGXDOVL]HQHHGQRWH[FHHGDERXWRIWKH,QQR'%EXIIHUSRROVL]H
)RUPRUHLQIRUPDWLRQRQUHGRORJVDQGKRZWRGHWHUPLQHDVHQVLEOHVL]HVHWWLQJYLVLW
http://mysqldump.azundris.com/archives/78-Configuring-InnoDB-An-
InnoDB-tutorial.htmlIRUDGHWDLOHGGHVFULSWLRQRI,QQR'%ORJFRQÀJXUDWLRQ
8QGHUVWDQGLQJDQGFRQÀJXULQJLPSRUWDQW
0\64/DQG,QQR'%WLPHRXWRSWLRQV
0\64/
VFRQÀJXUDWLRQÀOHFDQFRQWDLQDYDULHW\RIGLIIHUHQWWLPHRXWVHWWLQJVHDFKUHVSRQVLEOH
IRUDVSHFLÀFNLQGRIRSHUDWLRQRUFRQQHFWLRQ,QWKLVUHFLSHZHSUHVHQWDVHOHFWLRQRIWKHVH
WLPHRXWVHWWLQJVDQGDVXJJHVWHGYDOXHWRJRDORQJZLWKHDFK7KH+RZLWZRUNVVHFWLRQKDV
GHWDLOVRQHDFKYDOXHSUHVHQWHG
,QJHQHUDOWKHYDOXHVVXJJHVWHGKHUHVKRXOGEHDSSURSULDWHIRUERWK0\64/
YHUVLRQVDQG+RZHYHUSOHDVHQRWHWKDWDQ\RIWKHVHRSWLRQVPD\
ZHOOYDU\IRU\RXUHQYLURQPHQWGHSHQGLQJRQZKDWWKHUHTXLUHPHQWVDUHVR
SOHDVHGRQRWVLPSO\XVHWKHVHYDOXHVYHUEDWLP
*HWWLQJUHDG\
7RDSSO\WLPHRXWFRQÀJXUDWLRQVHWWLQJV\RXZLOOQHHGDFFHVVWRWKH0\64/FRQÀJXUDWLRQ
ÀOH³W\SLFDOO\my.cnfRUmy.iniRQ:LQGRZV³DQGWKHULJKWVWRUHVWDUWWKHVHUYHUWRKDYH
DQ\FKDQJHVPDGHWRWKHFRQÀJXUDWLRQWDNHHIIHFW

&RQÀJXULQJ0\64/

+RZWRGRLW

/RFDWHWKH0\64/FRQÀJXUDWLRQÀOHDQGRSHQLWLQDWH[WHGLWRU

,QWKH[mysqld]VHFWLRQVHWXSWKHIROORZLQJYDOXHV6RPHRIWKHRSWLRQVPD\
DOUHDG\EHSUHVHQWRWKHUVZLOOOLNHO\KDYHWREHDGGHG0DNHVXUHHDFKRSWLRQRQO\
DSSHDUVRQFH
[mysqld] 
... 
in-
nodb_rollback_on_timeout
innodb_lock_wait_timeout=50
interactive_timeout=1200
wait_timeout=28800
net_read_timeout=30
net_write_timeout=120
...

6DYHWKHÀOH

5HVWDUWWKH0\64/VHUYHU
+RZLWZRUNV
%\VHWWLQJWKHYDOXHVDVGHVFULEHGLQWKHDERYHVHFWLRQ\RXWHOO0\64/WRXVHGLIIHUHQWYDOXHV
WKDQWKHGHIDXOWVIRUWKHRSWLRQVPHQWLRQHG7KHQHZVHWWLQJVWDNHHIIHFWZLWKWKHVHUYHUUHVWDUW
6HWWLQJYDOXHVIRULQQRGEBUROOEDFNBRQBWLPHRXWLQQRGEBORFNBZDLWB
WLPHRXW
7KHVHWZRVHWWLQJVDUHSUREDEO\WKHPRVWLPSRUWDQWDVUHJDUGVWKHORFNLQJEHKDYLRULQDQ\
0\64/VHWXS6WDUWLQJZLWKYHUVLRQ0\64/FKDQJHGWKHUROOEDFNEHKDYLRULQFDVH
DWLPHRXWRFFXUUHGEHFDXVHDWUDQVDFWLRQFRXOGQRWDFTXLUHDORFNIRUDURZ7KLVXVXDOO\
KDSSHQVZKHQDQRWKHUWUDQVDFWLRQLVVWLOOZRUNLQJRQWKDWURZDQGWKLVLVWREHH[SHFWHG
LQQRUPDOGDWDEDVHRSHUDWLRQV7KHGDWDEDVHVHUYHUUROOVEDFNWKHHQWLUHWUDQVDFWLRQLQ
WKLVFDVH$SSOLFDWLRQVVKRXOGEHGHVLJQHGWRUHVSRQGWRVXFKFRQGLWLRQVE\UHWU\LQJWKH
HQWLUHWUDQVDFWLRQ
3ULRUWRWKLVZDVWKHGHIDXOWEHKDYLRUPDLQWDLQLQJWKHUXOHWKDWDWUDQVDFWLRQHLWKHU
VXFFHHGVRUIDLOVDQGLVUROOHGEDFNFRPSOHWHO\DVDQDWRPLFHQWLW\,QDQGQHZHU
YHUVLRQVWKHGHIDXOWZDVPRGLÀHGWRUROOEDFNRQO\WKHYHU\ODVWVWDWHPHQWRIWKHIDLOLQJ
WUDQVDFWLRQLQVWHDGNHHSLQJWKHWUDQVDFWLRQRSHQ:KLOHWKHUHLVDUHDVRQEHKLQGWKDWFKDQJH
IRUORQJWUDQVDFWLRQVLWFDQEHIDVWHUWRMXVWUHWU\WKHYHU\ODVWVWDWHPHQWWKDQZDLWIRUWKH
UROOEDFNDQGWU\DJDLQIURPWKHVWDUWLWUHTXLUHVVSHFLDOSUHFDXWLRQVWDNHQRQWKHDSSOLFDWLRQ

&KDSWHU

OHYHOWREHDEOHWRKDQGOHWKLVYHU\0\64/VSHFLÀFVFHQDULR
6HWWLQJWKHinnodb_rollback_on_timeoutRSWLRQLQWKHFRQÀJXUDWLRQ
ÀOHUHVWRUHVWKHPRUHVWDQGDUGZD\RIUROOLQJEDFNWKHZKROHWUDQVDFWLRQLQ
FDVHRIDORFNZDLWWLPHRXW:HVWURQJO\UHFRPPHQGHQDEOLQJWKLVRSWLRQ
XQOHVV\RXDUHSHUIHFWO\VXUH\RXUDSSOLFDWLRQLVDZDUHRIWKH0\64/VSHFLÀF
EHKDYLRUFRQÀJXUHGDVWKHGHIDXOW
innodb_lock_wait_timeoutGHÀQHVWKHQXPEHURIVHFRQGVDWUDQVDFWLRQZLOOZDLWWR
DFTXLUHDQHFHVVDU\ORFNZKHQDVHFRQGWUDQVDFWLRQLVZRUNLQJFRQFXUUHQWO\RQWKHVDPH
UHFRUGV7KHGHIDXOWYDOXHLVVHFRQGVDQGLIWKHORFNFRXOGQRWEHDFTXLUHGE\WKHQD
WLPHRXWHUURUZLOORFFXUDQGWKHWUDQVDFWLRQZLOOEHUROOHGEDFN'HSHQGLQJRQKRZORQJWKH
WUDQVDFWLRQVLQ\RXUVHWXSW\SLFDOO\WDNHWKLVYDOXHRIWHQQHHGVWREHDGMXVWHG,I\RXUHJXODUO\
KDYHEXONGDWDRSHUDWLRQVWKDWDIIHFWDORWRIURZV\RXZLOOZDQWWRLQFUHDVHWKLVYDOXH,IRQ
WKHRWKHUKDQG\RXUV\VWHPQRUPDOO\XVHVYHU\VKRUWWUDQVDFWLRQVUHGXFLQJWKLVYDOXHPD\
KHOS\RXÀQGRXWDERXWSUREOHPVZLWKORFNFRQWHQWLRQHDUOLHU
6HWWLQJYDOXHVIRULQWHUDFWLYHBWLPHRXWZDLWBWLPHRXW
interactive_timeoutGHÀQHVKRZORQJDQLQWHUDFWLYHFOLHQWFRQQHFWLRQFDQEHLGOH
EHIRUHWKHVHUYHUFORVHVLWDXWRPDWLFDOO\
,GOH
LQWKLVFRQWH[WUHIHUVWRWKHWLPHEHWZHHQWZR
VWDWHPHQWVEHLQJH[HFXWHGZLWKQRDFWLYLW\LQEHWZHHQ
:HUHFRPPHQGUHGXFLQJWKLVIURPWKHGHIDXOWYDOXHRIVHFRQGVKRXUVWRDPXFK
ORZHUYDOXHOLNHVHFRQGVPLQXWHV7KLVDOORZVWKHVHUYHUWRFORVHLGOHFRQQHFWLRQV
DQGFRQVHUYHVRPHUHVRXUFHV
7KHFRXQWHUSDUWYDULDEOHIRUQRQLQWHUDFWLYHVHVVLRQVVXFKDVWKRVHIURPDQDSSOLFDWLRQ
VHUYHU
VFRQQHFWLRQSRROLVFDOOHGwait_timeoutDQGKDVWKHVDPHVHPDQWLFV'HSHQGLQJ
RQ\RXUDSSOLFDWLRQ\RXPLJKWZDQWWROHDYHWKLVVHWWLQJRQDKLJKHUYDOXHDVPRVWFRQQHFWLRQ
SRROVFDQEHFRQÀJXUHGWRUHOHDVHFRQQHFWLRQVDXWRPDWLFDOO\GHSHQGLQJRQFXUUHQW
ORDGFRQGLWLRQV
6HWWLQJYDOXHVIRUQHWBUHDGBWLPHRXWQHWBZULWHBWLPHRXW
7KHSURWRFRO0\64/XVHVWRKDQGOHFRPPXQLFDWLRQEHWZHHQVHUYHUDQGFOLHQWVLVUDWKHU
OLPLWHGLQGHVLJQDOORZLQJRQO\RQHRSHUDWLRQWREHFDUULHGRXWDWDWLPH$VLGHHIIHFWRIWKLVLV
WKDWRQFHDGDWDWUDQVIHULQHLWKHUGLUHFWLRQKDVVWDUWHGWKHUHLVQRZD\IRULWWREHLQWHUUXSWHG
LQDFRQWUROOHGPDQQHU
7KHnet_read_timeoutFRQWUROVKRZORQJDSLHFHRILQIRUPDWLRQFDQEHVHQWIURPWKHFOLHQW
WRWKHVHUYHUEHIRUHWKHFRQQHFWLRQLVDERUWHG7KLVLVXVXDOO\QRWDSUREOHP³WKHGHIDXOW
VHWWLQJLVVHFRQGV8QGHUQRUHJXODUFLUFXPVWDQFHVZLOODFRPPXQLFDWLRQLQWKDWGLUHFWLRQ
WDNHVRORQJ

&RQÀJXULQJ0\64/

7KHnet_write_timeoutLVPRUHSUREOHPDWLFEHFDXVHIRUODUJHUHVXOWVHWVWKHGHIDXOW
YDOXHRIVHFRQGVPLJKWEHWRRVKRUW7KLVLVHVSHFLDOO\WUXHIRUFOLHQWVWKDWIHWFKWKHUHVXOW
LQVWUHDPLQJPRGHSRWHQWLDOO\SHUIRUPLQJWLPHFRQVXPLQJRSHUDWLRQVRQHDFKURZUHWULHYHG
WKHUHE\PDNLQJWKHRYHUDOORSHUDWLRQWDNHORQJHUWKDQWKHWLPHRXW
7KHH[DFWYDOXHUHTXLUHGIRU\RXUVHWXSGHSHQGVRQKRZFOLHQWVIHWFKGDWDDQGZRUNZLWKLWVR
\RXZLOOQHHGWRH[SHULPHQWDQGÀQGDVXLWDEOHYDOXH
2QHFDYHDWWRFRQVLGHUZLWKnet_write_timeoutLVWKDWLWPD\OHDGWRVHHPLQJO\UDQGRP
IDLOXUHVRImysqldumpOLNHWKLV
mysqldump: Error 2013: Lost connection to MySQL server during query 
when dumping table `tablename` at row: 935578
7KLVFDQKDSSHQLIWKHIROORZLQJFRQGLWLRQVDSSO\
f
net_write_timeoutLVVHWWRDORZYDOXH
f
max_allowed_packetLVVHWWRDODUJHYDOXH
'HSHQGLQJRQWKHVSHHGRIWKHQHWZRUNRYHUZKLFKmysqldumpKDVFRQQHFWHGDQGWKHVL]HRI
WKHURZVEHLQJGXPSHGLWPD\EHQHFHVVDU\WRLQFUHDVHnet_write_timeoutPXFKKLJKHU
DWOHDVWWRDVORQJDVLWWDNHVWRWUDQVPLWmax_allowed_packetE\WHVRYHUWKHQHWZRUNDQG
ZULWHLWWRWKHRXWSXW
mysqldumpLVDUHJXODUFOLHQWSURJUDPDQGVXEMHFWWRWKHnet_write_timeout
VHWWLQJ:KHQWKHVHUYHUVHQGVURZVWREHGXPSHGWRmysqldumpLQFKXQNVRIXS
WRmax_allowed_packetE\WHVGHSHQGLQJRQWKHQHWZRUNFRQQHFWLRQLQEHWZHHQ
WKLVPLJKWWDNHORQJHUWKDQnet_write_timeoutDOORZVPDNLQJWKHVHUYHUFXWWKH
FRQQHFWLRQHYHQWKRXJKQRWKLQJLVUHDOO\ZURQJ,QFUHDVLQJnet_write_timeout
IRUWKHmysqldumpWRRO
VVHVVLRQZRXOGUHPHG\WKLVEXWXQIRUWXQDWHO\DVRIWKH
WLPHRIZULWLQJWKHUHLVQRVXFKVHWWLQJIRUmysqldump$ZRUNDURXQGLI\RXHQFRXQWHU
WKLVSUREOHPLVWRWHPSRUDULO\LQFUHDVHWKHJOREDOVHUYHUnet_write_timeoutYDOXH
$ mysql -uroot -e "SELECT @@GLOBAL.net_write_timeout AS oldvalue;  
  SET GLOBAL net_write_timeout=600;"
$P\VTOGXPS
$ mysql -e "SET GLOBAL net_write_timeout=oldvalue;"
7KHÀUVWFRPPDQGZLOOGLVSOD\WKHFXUUHQWYDOXHIRUnet_write_timeoutDQGWKHQVHWLW
WRPLQXWHV$IWHUWKDWWKHmysqldumpFDQWDNHSODFH)LQDOO\WKHROGYDOXHLVUHVHWMXVW
PDNHVXUH\RXÀOOLQWKHFRUUHFWROGYDOXH
6HH0\64/%XJDWhttp://bugs.mysql.com/bug.php?id=46103IRU
PRUHGHWDLOV

&KDSWHU

$GMXVWLQJWDEOHDQGGDWDEDVHQDPHOHWWHU
FDVHKDQGOLQJIRUEHWWHUSODWIRUP
LQGHSHQGHQFH
0\64/LVDYDLODEOHIRUDYDULHW\RISODWIRUPV³WKHPDMRURQHVEHLQJ:LQGRZVDQG/LQX[(YHQ
WKRXJKGDWDÀOHVDUHFRPSDWLEOHDQGFDQEHWUDQVIHUUHGEHWZHHQSODWIRUPVDQGFRQÀJXUDWLRQ
PRVWO\IROORZVWKHVDPHJHQHUDOSULQFLSOHVWKHUHLVDQLPSRUWDQWFDYHDWWRNQRZDERXWKRZ
GLIIHUHQWRSHUDWLQJV\VWHPVKDQGOHÀOHQDPHV
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRVHWXS0\64/LQDZD\VXFKWKDWLWLVPXFKOHVVOLNHO\WR
UXQLQWRSUREOHPVZKHQPRYLQJGDWDÀOHVEHWZHHQSODWIRUPV%HFDXVH0\64/GDWDEDVHVDQG
WDEOHVFRUUHODWHWRÀOHV\VWHPREMHFWVGLUHFWRULHVDQGÀOHVGLIIHUHQFHVLQKRZWKHRSHUDWLQJ
V\VWHPRUUDWKHUWKHÀOHV\VWHPKDQGOHVÀOHDQGGLUHFWRU\QDPHVFDQOHDGWRXQGHVLUHG
HIIHFWVHVSHFLDOO\ZKHQZRUNLQJLQKHWHURJHQRXVHQYLURQPHQWV
:HJHQHUDOO\UHFRPPHQGVHWWLQJXSDOO\RXU0\64/VHUYHUVDVGHVFULEHGLQ
WKLVUHFLSHWRSUHYHQWDQ\SUREOHPV
*HWWLQJUHDG\
<RXZLOOQHHGDQRSHUDWLQJV\VWHPXVHUDFFRXQWDQGVXIÀFLHQWULJKWVWRPRGLI\WKHVHUYHU
V
FRQÀJXUDWLRQÀOH<RXZLOODOVRQHHGULJKWVWRUHVWDUWWKH0\64/VHUYLFHEHFDXVHWKHQDPH
KDQGOLQJFDQQRWEHUHFRQÀJXUHGRQWKHÁ\
3OHDVHQRWHWKDWIRUEHVWUHVXOWVWKLVVHWWLQJVKRXOGEHDSSOLHGEHIRUH\RX
VWDUWFUHDWLQJGDWDEDVHVDQGWDEOHVRQWKDWVHUYHU
+RZWRGRLW

0DNHVXUH0\64/LVQRWUXQQLQJ

/RFDWHWKH0\64/FRQÀJXUDWLRQÀOHXVXDOO\FDOOHGmy.cnfRUmy.iniRQ:LQGRZV
DQGRSHQLWLQDWH[WHGLWRU

/RFDWHWKHIROORZLQJSDUDPHWHULQWKH[mysqld]VHFWLRQ,ILWLVQRWWKHUHDGGLW
RWKHUZLVHHGLWLWWRPDWFKWKHYDOXHVKRZQKHUH
[mysqld] 
... 
lower_case_table_names = 1 
...

&RQÀJXULQJ0\64/

 6DYHWKHFRQÀJXUDWLRQÀOH
 5HVWDUWWKH0\64/VHUYHU
+RZLWZRUNV
0\64/WDEOHDQGGDWDEDVHQDPHVDUHPDSSHGWRÀOHV\VWHPQDPHV0RVW8QL[OLNHSODWIRUP
ÀOHV\VWHPVDUHFDVHVHQVLWLYHPHDQLQJWKDWWKHWZRÀOHVTableADQGtableaDUHGLIIHUHQW
IURPHDFKRWKHU2Q:LQGRZVWKHVHWZRQDPHVZLOOUHIHUWRWKHYHU\VDPHÀOH
6HWWLQJWKHlower_case_table_namesFRQÀJXUDWLRQWR1WHOOV0\64/WRDOZD\VFRQYHUW
DQ\GDWDEDVHRUWDEOHQDPHVWRORZHUFDVHOHWWHUVERWKZKHQFUHDWLQJDQGXVLQJWKHPLQ64/
VWDWHPHQWV7KLVZLOOHQVXUHWKDWQRPDWWHUZKDWFDVLQJDQ\64/VWDWHPHQWVXVHLWZLOODOZD\V
DIIHFWWKHVDPHWDEOHV
7KLVLVHVSHFLDOO\XVHIXOLQUHSOLFDWLRQVFHQDULRVZKHUH\RXUHSOLFDWHEHWZHHQPDVWHUDQG
VODYHPDFKLQHVXVLQJGLIIHUHQWRSHUDWLQJV\VWHPV
0DQXDOO\FRQÀJXULQJWKLVVHWWLQJLVKLJKO\UHFRPPHQGHGEHFDXVHGHSHQGLQJ
RQZKLFKSODWIRUP0\64/LVUXQRQWKHGHIDXOWVHWWLQJZLOOYDU\
7KHRQO\GRZQVLGHRIVHWWLQJXS0\64/LQWKLVZD\LVWKDWWKHRXWSXWRISHOW TABLESRU
SHOW DATABASESFRPPDQGVGRQRWSUHVHUYHWKHFDVLQJLQZKLFKGDWDEDVHVRUWDEOHVZHUH
FUHDWHGEXWWKLVLVPHUHO\DFRVPHWLFLVVXH
6HHDOVR
f
0\64/RQOLQHPDQXDORQLGHQWLÀHUFDVHVHQVLWLYLW\WKHUHOHYDQWRSWLRQVDQGFRQ
VHTXHQFHVVHFWLRQDWhttp://dev.mysql.com/doc/refman/5.1/en/
identifier-case-sensitivity.html
,QVWDOOLQJ0\64/DVD:LQGRZVVHUYLFHZLWK
FXVWRPRSWLRQV
:KLOHIRUGHYHORSPHQWSXUSRVHVLWFDQEHYHU\KDQG\WRKDYH0\64/UXQDVDFRQVROH
DSSOLFDWLRQRQ:LQGRZVIRUUHJXODURSHUDWLRQVDEDFNJURXQGVHUYLFHLVWKHRSWLRQWRJRIRU
,WKDVWKHDGYDQWDJHRIVWDUWLQJXSDQGVKXWWLQJGRZQDXWRPDWLFDOO\ZLWK:LQGRZVZLWKRXW
WKHQHHGIRUDXVHUWRORJLQWRWKHPDFKLQH
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRLQVWDOO0\64/DVD:LQGRZVVHUYLFHPDQXDOO\IURPWKH
=,3GLVWULEXWLRQDYDLODEOHIURPWKH0\64/KRPHSDJHDQGVSHFLI\DFXVWRPFRQÀJXUDWLRQÀOH

&KDSWHU

*HWWLQJVWDUWHG
1DWXUDOO\WKLVLVD:LQGRZVRQO\UHFLSH<RXZLOOQHHGD:LQGRZVXVHUDFFRXQWZLWK
DGPLQLVWUDWLYHSULYLOHJHVWRUHJLVWHUDQHZ:LQGRZVVHUYLFH0RUHRYHUZHDVVXPH\RX
KDYHDOUHDG\GRZQORDGHGWKH0\64/GLVWULEXWLRQFDOOHG:LWKRXWLQVWDOOHUXQ]LSLQC:\
0DNHVXUH\RXFKRRVHWKHUHOHDVHPDWFKLQJ\RXURSHUDWLQJV\VWHP
RUELW,QWKLVUHFLSHZHZLOOEHXVLQJ0\64/IURP
http://dev.mysql.com/downloads/mysql/5.1.html
%HDGYLVHGWKDWVHFXULW\VRIWZDUHRQ\RXUFRPSXWHUPLJKWLQWHUIHUHZLWKWKH
LQVWDOODWLRQRID:LQGRZVVHUYLFHDVVRPHPDOLFLRXVVRIWZDUHPD\WU\WR
KRRNLQWRWKHV\VWHPWKDWZD\,I\RXHQFRXQWHUSUREOHPV\RXPD\KDYHWR
GLVDEOHDQWLYLUXVSURJUDPVDQGRWKHUVHFXULW\SURGXFWVIRUWKHGXUDWLRQRI
WKHSURFHVV'RQRWIRUJHWWRUHHQDEOHWKHPZKHQ\RXDUHÀQLVKHGZLWKWKH
0\64/VHUYLFHVHWXS
+RZWRGRLW

8QSDFNWKHGRZQORDGHG=,3ÀOH3XWWKHFRQWHQWVLQc:\mysql\5.1.xx\service
UHSODFLQJxxZLWKWKHDFWXDOUHOHDVHQXPEHU\RXDUHXVLQJ

2QDFRPPDQGSURPSWcmd.exeHQWHUWKHIROORZLQJFRPPDQGVWRLQVWDOOWKH
VHUYLFH0DNHVXUHWRHQWHUWKHIXOOSDWKLQVWHDGRIFKDQJLQJWKHZRUNLQJGLUHFWRU\
ZLWKWKHcdFRPPDQG
c:\> c:\mysql\5.1.xx\service\bin\mysqld.exe --install MySQL51 
 (GLWWKHmy.iniFRQÀJXUDWLRQÀOHVSHFLÀHGLQWKHFRPPDQGDERYHWRPHHW\RXU
UHTXLUHPHQWV

&RQÀJXULQJ0\64/


6WDUWWKHVHUYLFHDQGYHULI\LWVVWDWXVXVLQJWKHVHFRPPDQGV
c:\> sc start MySQL51 
c:\> sc query MySQL51
<RXVKRXOGVHH67$7(5811,1*LQWKHVWDWXVRXWSXWRIWKHVHFRQGFRPPDQG
+RZLWZRUNV
7KH0\64/VHUYHUELQDU\H[HFXWDEOHÀOHmysqld.exeFRQWDLQVWKHQHFHVVDU\IXQFWLRQDOLW\
WRUHJLVWHULWVHOIZLWK:LQGRZVDVDEDFNJURXQGVHUYLFH7KHUHDUHWZRRSWLRQV\RXVKRXOG
SURYLGH--installDQG--defaults-file7KHÀUVWRQHZLOOVSHFLI\WKHQDPHRIWKHQHZ
VHUYLFHWREHFUHDWHG0\64/LQWKLVFDVH7KHODWWHULVXVHGWRGHÀQHZKLFKFRQÀJXUDWLRQ
ÀOHWKHVHUYLFHZLOOUHDGLWVVHWWLQJVIURP
1RWHWKDWDIWHUWKH--installSDUDPHWHURQO\DVLQJOHSDUDPHWHUPD\
IROORZ:KLOHWKLVFRXOGEHDQ\SDUDPHWHUWKH0\64/VHUYHUDFFHSWVXVLQJWKH
--default-fileJLYHV\RXWKHJUHDWHVWÁH[LELOLW\DV\RXFDQSXWDOORWKHU
UHTXLUHGVHWWLQJVWKHUH
7KHUH
VPRUH
$SDUWIURPEHLQJDEOHWRUXQZLWKRXWDXVHUKDYLQJWRORJLQWRWKHVHUYHUPDFKLQHVHUYLFHV
FDQGHÀQHGHSHQGHQFLHVVRIRUH[DPSOH\RXFRXOGPDNHVXUH\RXUDSSOLFDWLRQVHUYHURQO\
JHWVVWDUWHGZKHQWKHGDWDEDVHLVUHDG\)RUGHWDLOVRQKRZWRGRWKLVUHIHUWR0LFURVRIW
.QRZOHGJH%DVHDUWLFOHDWhttp://support.microsoft.com/kb/193888

&KDSWHU

$VVHUYLFHVGRQRWKDYHDFFHVVWRDFRQVROHRUWKHJUDSKLFDOXVHULQWHUIDFHLQJHQHUDODQ\
SUREOHPVHQFRXQWHUHGZKLOHVWDUWLQJWKHVHUYLFHZLOOQRWWHOO\RXDQ\WKLQJDERXWWKHFDXVH
2Q:LQGRZV0\64/ZLOOUHSRUWSUREOHPVWRWKHV\VWHPHYHQWORJYLHZDEOHIURPWKHFRQWURO
SDQHODQGWRWKH0\64/HUURUORJÀOHXVXDOO\ORFDWHGLQWKHGDWDGLUHFWRU\ZLWKDQDPH
FRPSRVHGIURPWKHPDFKLQHQDPHDQGD.errH[WHQVLRQ
6KRXOG\RXUVHUYLFHIDLOWRVWDUWLQVSHFWWKDWORJÀOHWRJHWDQLGHDRIZKDWLVZURQJ7RPDNH
VXUH\RXUFRQÀJXUDWLRQÀOHLV2.ZHUHFRPPHQG\RXWRVWDUWWKH0\64/GDHPRQRQFHIURP
WKHFRPPDQGOLQHOLNHWKLV
c:\> c:\mysql\5.1.xx\service\bin\mysqld.exe --defaults-file=c:\
mysql\5.1.xx\service\my.ini --console
7KLVZLOODOORZ\RXWRVHHDQ\SRWHQWLDOSUREOHPVULJKWDZD\EHIRUHLQVWDOOLQJWKHVHUYLFH
5XQQLQJPXOWLSOH0\64/VHUYHULQVWDQFHVLQ
SDUDOOHORQD/LQX[VHUYHU
2QPRVW/LQX[VHWXSV0\64/FRPHVDVDUHDG\PDGHLQVWDOODWLRQSDFNDJHPDNLQJLWHDV\WR
JHWVWDUWHG,WLVKRZHYHUDOLWWOHPRUHFRPSOLFDWHGWRUXQPXOWLSOHLQVWDQFHVLQSDUDOOHORIWHQ
DVHWXSKDQG\IRUGHYHORSPHQW7KLVLVEHFDXVHLQFRQWUDVWWR:LQGRZV0\64/LVXVXDOO\QRW
LQVWDOOHGLQDVHOIFRQWDLQHGGLUHFWRU\EXWPRVW/LQX[GLVWULEXWLRQSDFNDJHVVSUHDGLWDFURVV
WKHDSSURSULDWHV\VWHPIROGHUVIRUSURJUDPVFRQÀJXUDWLRQÀOHVDQGVRRQ<RXFDQKRZHYHU
DOVRLQVWDOO0\64/LQLWVRZQGLUHFWRU\IRUH[DPSOHLI\RXQHHGWRXVHDYHUVLRQQRWDYDLODEOH
DVDSUHSDUHGSDFNDJHIRU\RXU/LQX[GLVWULEXWLRQ:KLOHWKLVJLYHV\RXWKHJUHDWHVWÁH[LELOLW\
DVDGRZQVLGH\RXZLOOKDYHWRWDNHFDUHRIZLULQJXS\RXU0\64/VHUYHUZLWKWKHRSHUDWLQJ
V\VWHPPDQXDOO\)RUH[DPSOH\RXZLOOQHHGWRKRRNXSWKHVWDUWXSDQGVKXWGRZQVFULSWVZLWK
WKHDSSURSULDWHIDFLOLWLHVRI\RXUGLVWULEXWLRQ
,QPRUHUHFHQWGLVWULEXWLRQV\RXFDQPDNHXVHRIDWRROFDOOHGmysqld_multiDVROXWLRQ
WKDWOHWV\RXVHWXSPXOWLSOHLQVWDQFHVRI0\64/GDHPRQVZLWKYDU\LQJFRQÀJXUDWLRQV,QWKLV
UHFLSHZHZLOOVKRZ\RXKRZWRVHWXSWZRSDUDOOHO0\64/VHUYHUVOLVWHQLQJRQGLIIHUHQW7&3
SRUWVDQGXVLQJVHSDUDWHGDWDGLUHFWRULHVIRUWKHLUUHVSHFWLYHGDWDEDVHV
*HWWLQJUHDG\
7KLVUHFLSHLVEDVHGRQDQ8EXQWX/LQX[PDFKLQHZLWKWKH/76YHUVLRQmysqld_multi
FRPHVZLWKWKH0\64/SDFNDJHVIRUWKDWRSHUDWLQJV\VWHP,I\RXDUHXVLQJRWKHUGLVWULEXWLRQV
\RXQHHGWRPDNHVXUH\RXKDYHmysqld_multiLQVWDOOHGWREHDEOHWRIROORZDORQJ5HIHU
WR\RXUGLVWULEXWLRQ
VSDFNDJHUHSRVLWRULHVIRULQIRUPDWLRQRQZKLFKSDFNDJHV\RXQHHGWRLQVWDOO

&RQÀJXULQJ0\64/

<RXZLOODOVRQHHGDQRSHUDWLQJV\VWHPXVHUZLWKVXIÀFLHQWSULYLOHJHVWRHGLWWKH0\64/
FRQÀJXUDWLRQÀOH³W\SLFDOO\/etc/mysql/my.cnfRQ8EXQWX³DQGUHVWDUWVHUYLFHV$V
IRU$SS$UPRURU6(/LQX[ZHDVVXPHWKHVHKDYHEHHQGLVDEOHGEHIRUH\RXVWDUWWRVLPSOLI\
WKHSURFHVV
+RZWRGRLW

/RFDWHDQGRSHQWKHmy.cnfFRQÀJXUDWLRQÀOHLQDWH[WHGLWRU

&UHDWHWKHIROORZLQJWZRVHFWLRQVLQWKHÀOH
# mysqld_multi test, instance 1
[mysqld1] 
server-id=10001 
socket=/var/run/
mysqld/mysqld1.sock 
port=23306 
pid-
file=/var/run/mysqld/mysqld1.pid
datadir=/var/lib/mysql1 
log_bin=/var/
log/mysql1/mysql1-bin.log
# mysqld_multi test, instance 2
[mysqld2] 
server-id=10002 
socket=/var/run/
mysqld/mysqld2.sock 
port=33306 
pid-
file=/var/run/mysqld/mysqld2.pid
datadir=/var/lib/mysql2 
log_bin=/var/
log/mysql2/mysql2-bin.log

6DYHWKHFRQÀJXUDWLRQÀOH

,VVXHWKHIROORZLQJFRPPDQGWRYHULI\WKHWZRVHFWLRQVDUHIRXQGE\mysqld_multi
$ sudo mysqld_multi report

&KDSWHU


,QLWLDOL]HWKHGDWDGLUHFWRULHV
$ sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql1
$ sudo mysql_install_db --user=mysql --datadir=/var/lib/mysql2

6WDUWERWKLQVWDQFHVDQGYHULI\WKH\KDYHEHHQVWDUWHG
$ sudo mysqld_multi start 1 
$ sudo mysqld_multi report

&RQÀJXULQJ0\64/


&RQQHFWWRERWKLQVWDQFHVDQGYHULI\WKHLUVHWWLQJV
$ mysql -S /var/run/mysqld/mysql1.sock
mysql> SHOW VARIABLES LIKE 'server_id';
$ mysql -S /var/run/mysqld/mysql2.sock
mysql> SHOW VARIABLES LIKE 'server_id';
+RZLWZRUNV
mysqld_multiXVHVDVLQJOHFRQÀJXUDWLRQÀOHIRUDOO0\64/VHUYHULQVWDQFHVEXWLQVLGHWKDW
ÀOHHDFKLQVWDQFHKDVLWVLQGLYLGXDO[mysqld]VHFWLRQZLWKLWVVSHFLÀFRSWLRQVmysqld_multi
WKHQWDNHVFDUHRIODXQFKLQJWKH0\64/H[HFXWDEOHZLWKWKHFRUUHFWRSWLRQVWRXVHWKHRSWLRQV
IURPLWVFRUUHVSRQGLQJVHFWLRQ
7KHVHFWLRQVDUHGLVWLQJXLVKHGE\DSRVLWLYHQXPEHUGLUHFWO\DSSHQGHGWRWKHZRUGmysqld
LQWKHVHFWLRQKHDGHU<RXFDQVSHFLI\DOOWKHXVXDO0\64/FRQÀJXUDWLRQÀOHRSWLRQVLQWKHVH
VHFWLRQVMXVWDV\RXZRXOGIRUDVLQJOHLQVWDQFH0DNHVXUHKRZHYHUWRVSHFLI\WKHPLQLPXP
VHWRIRSWLRQVDVLQWKHUHFLSHVWHSVSUHYLRXVO\VWDWHGDVWKHVHDUHUHTXLUHGWREHXQLTXHIRU
HYHU\VLQJOHLQVWDQFH

&KDSWHU

7KHUH
VPRUH
6RPHVSHFLDOSUHSDUDWLRQPLJKWEHQHHGHGGHSHQGLQJRQWKHSDUWLFXODURSHUDWLQJV\VWHP\RX
DUHXVLQJ
7XUQLQJRII$SS$UPRU6(/LQX[IRU/LQX[GLVWULEXWLRQV
,I\RXUV\VWHPXVHVWKH$SS$UPRURU6(/LQX[VHFXULW\IHDWXUHV\RXZLOOQHHGWRPDNHVXUH
WKHVHDUHHLWKHUWXUQHGRIIZKLOH\RXWU\WKLVRXWRUFRQÀJXUHGIRUSHUPDQHQWXVHRQFH\RXU
FRQÀJXUDWLRQKDVEHHQÀQLVKHGWRDOORZDFFHVVWRWKHQHZO\GHÀQHGGLUHFWRULHVDQGÀOHV
6HHWKHGRFXPHQWDWLRQIRU\RXUUHVSHFWLYH/LQX[GLVWULEXWLRQIRUPRUHGHWDLOVRQKRZ
WRGRWKLV
:LQGRZV
2Q:LQGRZVUXQQLQJPXOWLSOHVHUYHULQVWDQFHVLVXVXDOO\PRUHVWUDLJKWIRUZDUG0\64/LV
QRUPDOO\LQVWDOOHGLQDVHSDUDWHVHOIFRQWDLQHGIROGHU7RUXQWZRRUPRUHLQGHSHQGHQWVHUYHU
LQVWDQFHV\RXRQO\QHHGWRLQVWDOOD:LQGRZVVHUYLFHIRUHDFKRIWKHPDQGSRLQWWKHPWRDQ
LQGLYLGXDOFRQÀJXUDWLRQÀOH)RULQIRUPDWLRQRQKRZWRVHWXS0\64/DVD:LQGRZVVHUYLFH
DQGKRZWRVSHFLI\ZKLFKVHWWLQJVÀOHWRXVHVHHWKHUHOHYDQWUHFLSHLQWKLVFKDSWHU
&RQVLGHULQJWKHDOWHUQDWLYH0\64/6DQGER[SURMHFW
$VDQDOWHUQDWLYHWRmysqld_multi\RXPLJKWZDQWWRKDYHDORRNDW0\64/6DQGER[ZKLFK
RIIHUVDGLIIHUHQWDSSURDFKWRKRVWLQJPXOWLSOHLQGHSHQGHQW0\64/LQVWDOODWLRQVRQDVLQJOH
RSHUDWLQJV\VWHP:KLOHmysqld_multiPDQDJHVPXOWLSOHFRQÀJXUDWLRQVLQDVLQJOHÀOH
0\64/6DQGER[DLPVDWFRPSOHWHO\VHSDUDWLQJ0\64/LQVWDOODWLRQVIURPHDFKRWKHUHDVLO\
DOORZLQJHYHQVHYHUDO0\64/UHOHDVHVWRUXQVLGHE\VLGH)RUPRUHGHWDLOVYLVLWWKHSURMHFW
V
ZHEVLWHDWhttp://mysqlsandbox.net
6HHDOVR
f
,QVWDOOLQJ0\64/DVD:LQGRZVVHUYLFHZLWKFXVWRPRSWLRQV
f
8EXQWX/LQX[:LNLRQ$SS$UPRUDWhttps://wiki.ubuntu.com/AppArmor
f
)HGRUD:LNLRQ6(/LQX[http://fedoraproject.org/wiki/SELinux

&RQÀJXULQJ0\64/

3UHYHQWLQJLQYDOLGGDWHYDOXHVIURPEHLQJ
VWRUHGLQ'$7(RU'$7(7,0(FROXPQV
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRFRQÀJXUH0\64/LQDZD\VXFKWKDWLQYDOLGGDWHV
DUHUHMHFWHGZKHQDFOLHQWDWWHPSWVWRVWRUHWKHPLQDDATERUDATETIMEFROXPQXVLQJ
DFRPELQDWLRQRIÁDJVIRUWKH64/PRGHVHWWLQJ
6HHWKH7KHUH
VPRUHVHFWLRQRIWKLVUHFLSHIRUVRPHPRUHGHWDLOHGLQIRUPDWLRQRQWKH
VHUYHUPRGHVHWWLQJLQJHQHUDODQGRQKRZWRXVHLWRQDSHUVHVVLRQEDVLV
*HWWLQJUHDG\
7KHFRQÀJXUDWLRQRSWLRQVVKRZQLQWKLVUHFLSHFDQEHDSSOLHGWRLQGLYLGXDOVHVVLRQVRUDV
VHUYHUZLGHGHIDXOWV)RUSURGXFWLRQV\VWHPVZHUHFRPPHQGVSHFLI\LQJWKHPLQWKH0\64/
FRQÀJXUDWLRQÀOH<RXZLOOQHHGWKHQHFHVVDU\RSHUDWLQJV\VWHPOHYHOSULYLOHJHVWRHGLWLWDQG
WKHQUHVWDUWWKHVHUYLFHWRDFWLYDWHWKHVHWWLQJV
7KHÀQDOVWHSLQWKHUHFLSHLVWKHDWWHPSWWRLQVHUWVRPHLQYDOLGGDWHV<RXFDQVDIHO\VNLSWKLV
VWHS,I\RXZDQWWRWU\LW\RXZLOOQHHGDWDEOHVHWXSOLNHWKLVLQWKHWHVWGDWDEDVH
CREATE TABLE table_a (
  test_date DATE NOT NULL
);
+RZWRGRLW

/RFDWHWKH0\64/FRQÀJXUDWLRQÀOHW\SLFDOO\my.cnfRUmy.iniRQ:LQGRZVDQG
RSHQLWLQDWH[WHGLWRU

,QWKH[mysqld]VHFWLRQPDNHVXUHWKHIROORZLQJOLQHLVSUHVHQWDGGLQJLW
LIQHHGHG
[mysqld] 
... 
sql-
mode=STRICT_ALL_TABLES,NO_ZERO_DATE,NO_ZERO_IN_DATE 
...

6DYHWKHÀOH

5HVWDUWWKH0\64/VHUYHU

&KDSWHU

 9HULI\ZKHWKHUWKHVHWWLQJZDVDSSOLHGXVLQJWKLVVWDWHPHQWIURPD0\64/FOLHQW
mysql> SELECT @@GLOBAL.sql_mode;

2SWLRQDOO\WU\WRLQVHUWVRPHIDOVHYDOXHV
mysql> INSERT INTO table_a VALUES ('2009-02-31');
mysql> INSERT INTO table_a VALUES ('2009-00-31');
mysql> INSERT INTO table_a VALUES ('0000-00-00');
*HWWLQJUHDG\
6HWWLQJWKH64/PRGHWRSTRICT_ALL_TABLESZLOOHQDEOHYDOLGDWLRQRQDOOWDEOHV
DVRSSRVHGWRRQO\WKRVHLQWUDQVDFWLRQDOVWRUDJHHQJLQHVLI\RXZHUHWRXVH
STRICT_TRANS_TABLES:KLOHVHWWLQJXSWKH64/PRGHOLNHWKLVZRXOGDOUHDG\
SURKLELWWKHLQVHUWLRQRIYDOXHVOLNH)HEVWRQHFRXOGVWLOOLQVHUWDOO]HURGDWHVRU
GDWHVZLWK]HURÀHOGVLQWKHP7KLVLVZKDWWKHRWKHUWZRRSWLRQVNO_ZERO_DATE
DQGNO_ZERO_IN_DATE WDNHFDUHRI

&RQÀJXULQJ0\64/

7KHUH
VPRUH
6WDUWLQJZLWK0\64/WKHFRQFHSWRI64/PRGHVZDVLQWURGXFHGWRSURYLGHJUDQXODU
FRQWURORYHUWKHGHJUHHRIOHQLHQF\WKHVHUYHUZLOODSSO\IRULQYDOLGYDOXHV0\64/KDV
WUDGLWLRQDOO\EHHQYHU\IRUJLYLQJZKHQUHFHLYLQJLQYDOLGYDOXHVWREHLQVHUWHGLQWRLWVWDEOHV
7KHUHDUHWUXQFDWLRQDQGDSSUR[LPDWLRQUXOHVRQZKDWZLOOKDSSHQZKHQIRUH[DPSOH\RX
WU\WRLQVHUWDYDOXHWKDWH[FHHGVWKHPD[LPXPOHQJWKRIDFROXPQ
VGHÀQLWLRQ
)RUHQWHUSULVHV\VWHPVWKLVFOHDUO\LVXQZDQWHGEHKDYLRU:KHQHYHUDQDSSOLFDWLRQWULHVWR
VWRUHYDOXHVLQWKHGDWDEDVHWKDWGRQRWPHHWWKHSUHYLRXVO\GHÀQHGFULWHULDRIOHQJWKDQG
YDOXHUDQJHVDQHUURUPXVWEHWKURZQWRSUHYHQWVLOHQWGDWDFRUUXSWLRQ2QHPLJKWDUJXHWKDW
GDWDYDOLGDWLRQPXVWEHGRQHDWWKHDSSOLFDWLRQOHYHODQGLQYDOLGGDWDQHYHUEHVWRUHGWRWKH
GDWDEDVHDQ\ZD\%XWZHDUHVWURQJEHOLHYHUVLQWKHGDWDEDVHEHLQJWKHODVWOLQHRIGHIHQVH
2IFRXUVHDQ\GHFHQWDSSOLFDWLRQZLOOUHMHFWLQYDOLGLQSXWVEXWLQUHDOLW\WKHUHFDQEHEXJVRU
DQDGPLQLVWUDWRUDFFHVVLQJWKHGDWDEDVHLQGHSHQGHQWO\PLJKWMXVWPDNHDPLVWDNH6HWWLQJXS
0\64/WRYHULI\LQFRPLQJGDWDDJDLQFDQEHLQYDOXDEOHLQWKHVHVLWXDWLRQV(YHQWKRXJK\RX
WDNHDVOLJKWSHUIRUPDQFHKLWGDWDLQWHJULW\VKRXOGEHFRQVLGHUHGDVDQHYHQKLJKHUSULRULW\
7KHVRFDOOHGVWULFWPRGHHQDEOHVWKHJHQHUDOXVHRI0\64/VHUYHUVLGHGDWDYDOLGDWLRQ
7KHUHPDLQLQJRSWLRQVGHVFULEHGLQWKH0\64/RQOLQHPDQXDOVHFWLRQDW
http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html
DOORZDVRPHZKDWJUDQXODUFRQWURORYHUZKDWH[DFWO\JHWYDOLGDWHGDQGKRZ
:HUHFRPPHQGJRLQJWKURXJKDOOWKH64/PRGHRSWLRQVWRVHHLIWKHUHDUHDQ\WKDW\RXZRXOG
OLNHWRHQDEOHRQ\RXUVHUYHUV
&RQÀJXULQJ64/PRGHIRUWKHFXUUHQWVHVVLRQRQO\
)RUH[SHULPHQWLQJZLWKWKHGLIIHUHQW64/PRGHVLWLVRIWHQHDVLHUWRFRQÀJXUHWKHPIRU\RXU
FXUUHQWVHVVLRQRQO\7KHIROORZLQJVWDWHPHQWGLVDEOHVWKHJOREDOVHWWLQJVFRQÀJXUHGDERYH
IRUWKHFXUUHQWVHVVLRQRQO\
mysql> SET @@session.sql_mode='';
7KLVFDQDOVRFRPHLQKDQG\IRUPDLQWHQDQFHVFULSWVWKDWQHHGWRWHPSRUDULO\GLVDEOHFHUWDLQ
UHVWULFWLRQVWKDWDUHVHWXSIRUQRUPDORSHUDWLRQV


0\64/8VHU
0DQDJHPHQW
,QWKLVFKDSWHUZHZLOOFRYHUWKHEDVLFWDVNVUHODWHGWR0\64/XVHUPDQDJHPHQW<RXZLOO
OHDUQDERXWWKHIROORZLQJWRSLFV
f
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
'LVDEOLQJWKHGHIDXOWDFFRXQWV
f
&UHDWLQJDEDVLFXVHU
f
&UHDWLQJDQLQVWDOODWLRQXVHU
f
&UHDWLQJDUHDGRQO\DFFRXQW
f
'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
f
'HÀQLQJDVSHFLÀFXVHUIRUUHSOLFDWLRQ
f
$OORZLQJDFFHVVIURPVSHFLÀFKRVWVRQO\
f
6\QFKURQL]LQJXVHUSHUPLVVLRQVDFURVVVHUYHUV
f
5HJDLQLQJDFFHVVWR\RXUGDWDEDVHLQFDVHRIORVWDFFRXQWLQIRUPDWLRQ
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
,QWURGXFWLRQ
:KLOH0\64/KDVDUHSXWDWLRQIRUEHLQJHDV\WRVHWXSLQWKHÀUVWSODFHDQGULJKWO\VRRQH
KDVWRNHHSLQPLQGWKDWWKHLQLWLDOFRQÀJXUDWLRQIRUH[DPSOHDVSURYLGHGE\WKH:LQGRZV
LQVWDOODWLRQZL]DUGQHHGVVRPHPRUHWZHDNLQJIRUSURGXFWLRQXVH7KLVSDUWLFXODUO\KROGVWUXH
IRUWKHGHIDXOWXVHUFRQÀJXUDWLRQ

0\64/8VHU0DQDJHPHQW

:KHQHYHU\RXFRQQHFWWRD0\64/VHUYHUWKHFRQQHFWLRQLVDVVRFLDWHGZLWKDVSHFLÀFXVHU
HYHQLI\RXGRQRWVSHFLI\WKHXVHUH[SOLFLWO\LQZKLFKFDVHDGHIDXOWDFFRXQWLVVHOHFWHG
,I\RXWHOO0\64/:LQGRZVLQVWDOOHUWRFUHDWHDQDQRQ\PRXVXVHUWKHUHVXOWLQJFRQÀJXUDWLRQ
DOORZVIRUIXOOORFDODFFHVVWRWKHGDWDEDVHZLWKRXWKDYLQJWRSURYLGHDQ\NLQGRIFUHGHQWLDOV
:KRHYHULVDEOHWRDFFHVVWKHPDFKLQHWKDWUXQV\RXUGDWDEDVHZLOOEHDEOHWRSOD\KDYRFZLWK
\RXUGDWD³ZKLFKLVQRWVRPHWKLQJ\RXW\SLFDOO\ZDQWIRU\RXUSURGXFWLRQV\VWHPV
'R127XVHDQDQRQ\PRXVXVHURQSURGXFWLRQV\VWHPV
7KHGHÀQLWLRQRIXVHUVDQGWKHLUUHVSHFWLYHDFFHVVSULYLOHJHVLVRIWHQFRQVLGHUHGD
GRZQVWUHDPFRQÀJXUDWLRQWDVNWKDWFDQEHWDFNOHGVKRUWO\EHIRUHSURGXFWLRQXVH
:HVWURQJO\UHFRPPHQGGHÀQLQJWKHEDVLFUROHVIRUGDWDEDVHXVHUVLQDGYDQFH7KLV
RIWHQKHOSVWRVWUXFWXUHWKHZD\WKHGDWDEDVHLVDFFHVVHGZKLFKLQWXUQPLJKWLPSURYH
WKHV\VWHPVDUFKLWHFWXUHDQGSUHYHQWFHUWDLQGHYHORSPHQWÁDZV
,QWKLVFKDSWHUZHZLOOKDYHDORRNDWVRPHW\SLFDOXVHUUROHVIRXQGLQ0\64/SURGXFWLRQ
HQYLURQPHQWV)LUVWRIDOOZHZLOOGLVFXVVKRZWRFUHDWHDKDUGHQHGDGPLQLVWUDWLRQDFFRXQW
WKDWLVQRWDFFHVVLEOHDQRQ\PRXVO\DQGWKHQKRZWRJHWULGRIWKHGHIDXOWXVHUVSURYLGHGE\
WKH0\64/LQVWDOODWLRQ$GGLWLRQDOO\ZHZLOOLQWURGXFHDFFRXQWVIRUEDVLFRSHUDWLRQVDQGJXHVW
DFFHVVDQGUHIHUWRWHFKQLFDOXVHUVIRUUHSOLFDWLRQEDFNXSDQGUHFRYHU\
%HVLGHVWKLVZHZLOODOVRFRYHUKRZWRUHVWULFWGDWDEDVHDFFHVVIRUFHUWDLQXVHUVWRVSHFLÀF
FOLHQWV7KLVPDNHVIRUDQDGGLWLRQDOOLQHRIGHIHQVHEHFDXVHNQRZOHGJHRIDXVHUQDPHDQG
SDVVZRUGDUHQRWVXIÀFLHQWWRFRQQHFWWRWKHGDWDEDVH$SRWHQWLDODWWDFNHUZRXOGDOVRKDYH
WRWDNHFRQWURORIWKHGHÀQHGFOLHQWDGGUHVV

&KDSWHU

$V0\64/LQVWDOODWLRQVZLWKPRUHWKDQRQHGDWDEDVHVHUYHUDUHQRWDQH[RWLFFRQÀJXUDWLRQ
DQ\PRUHWKHVRPHWLPHVWHGLRXVWDVNRINHHSLQJWKHXVHUGHÀQLWLRQVLQV\QFKWKURXJKRXWDOO
LQVWDQFHVZLOOEHDGGUHVVHGDVZHOO$QGÀQDOO\ZHZLOOQRWFRQFHDOWKHGRZQVLGHRILPSURYHG
VHFXULW\LIDSRWHQWLDODWWDFNHUZLOOQRWEHDEOHWRDFFHVVWKHGDWDEDVHZLWKRXWNQRZLQJWKH
XVHUQDPHDQGSDVVZRUG\RXZLOOQRWHLWKHU:HZLOOVKRZ\RXKRZWRDFFHVV\RXUGDWDEDVH
HYHQLIWKHVWLFN\QRWHVZLWK\RXUFUHGHQWLDOVDUHORVW
7KHUHFLSHVLQWKLVFKDSWHUZLOOSULPDULO\IRFXVRQ0\64/$GPLQLVWUDWRUDVWKHWRRORIFKRLFH
ZKHQPDQLSXODWLQJWKHXVHUDFFRXQWVDQGWKHLUSULYLOHJHV
0\64/$GPLQLVWUDWRULVDQDGPLQLVWUDWLRQFOLHQWSURYLGHGE\0\64/DVSDUW
RIWKH0\64/*8,7RROV%XQGOHZKLFKLVDYDLODEOHIRUIUHHDWhttp://dev.
mysql.com/downloads/gui-tools/5.0.html
+RZHYHULQVRPHVLWXDWLRQVDJUDSKLFDOXVHULQWHUIDFHMXVWGRHVQRWÀWWKHUHTXLUHPHQWV
7KLVLVSDUWLFXODUO\WKHFDVHLIVFULSWLQJLVUHTXLUHGIRUH[DPSOHIRUDXWRPDWHGDQG
XQDWWHQGHGFKDQJHV)RUWKHVHVLWXDWLRQVZHZLOODOVRVKRZDOWHUQDWLYHZD\VWRFKDQJH
WKHXVHUULJKWVZLWKRXWWKHKHOSRI0\64/$GPLQLVWUDWRU
:KLOHWKHUHFLSHVLQWKLVFKDSWHUZLOOJLYH\RXDQRYHUYLHZRIDW\SLFDOUROHFRQÀJXUDWLRQZH
HQFRXUDJH\RXWRDGDSWWKLVSURSRVDODFFRUGLQJWR\RXUQHHGV$QGIURPRXUH[SHULHQFH
LWLVW\SLFDOO\DJRRGLGHDWRGLVFXVVWKHSRVVLEOHXVHUFRQÀJXUDWLRQZLWK\RXU,7VHFXULW\
GHSDUWPHQW³LI\RXUFRPSDQ\KDSSHQVWRKDYHRQH³ZHOOLQDGYDQFHVRDVWRSUHYHQWOHQJWK\
GLVFXVVLRQVODWHURQ
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\
JOREDOSULYLOHJHVDQGKRVWV
7KURXJKRXWWKHIROORZLQJUHFLSHVZHZLOOXVH0\64/$GPLQLVWUDWRUDVWKHPDLQWRROWRPDQDJH
XVHUULJKWV6RPHRIWKHSULYLOHJHVKRZHYHUDUHQRWYLVLEOHLQ0\64/$GPLQLVWUDWRULQLWV
GHIDXOWFRQÀJXUDWLRQ7KLVUHFLSHZLOOVKRZ\RXKRZWRFKDQJHWKHUHOHYDQWRSWLRQVVRZH
ZLOOEHDEOHWRPDQDJHHYHQWKHJOREDOSULYLOHJHV
*HWWLQJUHDG\
7RVWHSWKURXJKWKLVUHFLSH\RXZLOOQHHGDUXQQLQJ0\64/GDWDEDVHVHUYHUDQGDZRUNLQJ
LQVWDOODWLRQRI0\64/$GPLQLVWUDWRU1RRWKHUSUHUHTXLVLWHVDUHUHTXLUHG

0\64/8VHU0DQDJHPHQW

+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJDQ\DFFRXQW

6HOHFWWKHHQWU\2SWLRQV«IURPWKH7RROVPHQX

0DNHVXUHWKHRSWLRQV6KRZ*OREDO3ULYLOHJHVDQG6KRZKRVWVLQXVHUOLVW
DUHVHOHFWHG
 6HOHFW&ORVH,ID6DYHFKDQJHV"GLDORJFRPHVXSSUHVVWKH<HV$SSO\WKHVH
FKDQJHVSHUPDQHQWO\EXWWRQ
+RZLWZRUNV
:LWKWKHRSWLRQVVHOHFWHGWKURXJKRXWWKLVUHFLSH0\64/$GPLQLVWUDWRUZLOODOORZ\RXWRYLHZ
DQGFKDQJHQRWRQO\WKHVFKHPDSULYLOHJHVWKDWGHÀQHWKHRSHUDWLRQVDOORZHGRQFHUWDLQ
VFKHPDWDEXWDOVRWKHJOREDOSULYLOHJHV
7KHDYDLODEOHJOREDOSULYLOHJHVDUHSDUWLDOO\LGHQWLFDOWRWKHVFKHPDSULYLOHJHVIRUH[DPSOH
6(/(&7RU83'$7(EXWWKHUHDUHDOVRVRPHDGGLWLRQDOSULYLOHJHVVXFKDV6+87'2:1WKDW
DIIHFWWKHZKROHGDWDEDVHUHJDUGOHVVRIVSHFLÀFVFKHPDWD

&KDSWHU

7KHRSWLRQVDIIHFWWKH8VHU$GPLQLVWUDWLRQYLHZRI0\64/$GPLQLVWUDWRU<RXZLOOQRWLFHDQ
DGGLWLRQDOWDE*OREDO3ULYLOHJHVDQGZKHQ\RXVHOHFWDXVHUDFFRXQWLQWKHOLVWWRWKHORZHU
OHIWWKHKRVWVIRUZKLFKWKHVSHFLÀFULJKWVZHUHGHÀQHGDUHOLVWHG
'HÀQLQJDQDOWHUQDWLYHXVHUIRU
DGPLQLVWUDWLYHWDVNV
'XULQJ0\64/LQVWDOODWLRQDQDFFRXQWIRUXVHUURRWLVFUHDWHG7KLVDFFRXQWUHFHLYHVDOO
SULYLOHJHVZLWKRXWDQ\H[FHSWLRQV,QPRVWLQVWDOODWLRQVWKLVFRQÀJXUDWLRQLVEDVLFDOO\OHIW
XQFKDQJHGZKLFKPDNHVWKHURRWDFFRXQWDYHU\UHZDUGLQJWDUJHWIRUDWWDFNV$QDWWDFNHU
ZLOOQRWKDYHWRJXHVVDXVHUQDPHDQGDFRUUHVSRQGLQJSDVVZRUG³WKHSDVVZRUGDORQH
ZLOOGREHFDXVHLWLVDVDIHEHWWRDVVXPHWKHH[LVWHQFHRIDXVHUQDPHURRW7KLVLVZK\ZH
UHFRPPHQGWKDW\RXFUHDWHDQDGPLQLVWUDWLRQDFFRXQWZLWKDGLIIHUHQWQDPH
7KLVUHFLSHZLOOVKRZ\RXKRZWRFUHDWHDXVHUDFFRXQWWKDWFDQDFWDVDUHSODFHPHQWIRUWKH
URRWXVHU
*HWWLQJUHDG\
<RXDUHJRLQJWRQHHGDFDWFK\XVHUQDPHIRU\RXUDGPLQLVWUDWLRQDFFRXQWDQGD
FRUUHVSRQGLQJSDVVZRUG:KHQPDNLQJXSWKHSDVVZRUGNHHSLQPLQGWKHW\SLFDOSDVVZRUG
UHFRPPHQGDWLRQVIRUJRRGSDVVZRUGVKDUGWRJXHVVEXWHDV\WRUHPHPEHUVKRXOGFRQWDLQ
XSSHUDQGORZHUFDVHOHWWHUVQXPEHUVDQGVSHFLDOFKDUDFWHUV7KURXJKRXWWKLVUHFLSH
ZHZLOODVVXPHDXVHUQDPHDGPLQP\VTODQGDSDVVZRUG$V\VS0$VLPSOH\HWVWURQJ
SDVVZRUGIRU0\64/WKURXJKRXWWKLVUHFLSH
7KHDGPLQP\VTOXVHULVRQO\XVHGDVDQH[DPSOH)RUVHFXULW\UHDVRQV
SOHDVHGR127XVHWKLVDFFRXQWQDPHRUDQ\RIWKHRWKHUXVHUVLQWURGXFHGLQ
WKLVFKDSWHUIRUUHDOZRUOGLQVWDOODWLRQV:HVWURQJO\VXJJHVWXVLQJ\RXURZQ
LQGLYLGXDOXVHUQDPHVLQVWHDG
$GGLWLRQDOO\\RXZLOOKDYHWRPDNHVXUHWKDWPDQLSXODWLRQRIJOREDOSULYLOHJHVLVHQDEOHGLQ
0\64/$GPLQLVWUDWRURSWLRQV3OHDVHUHIHUWRWKH&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\
JOREDOSULYLOHJHVDQGKRVWVUHFLSHLILQGRXEW
)LQDOO\\RXKDYHWRWKLQNDERXWIURPZKLFKKRVW\RXDUHJRLQJWRFRQQHFWWR\RXU0\64/
LQVWDQFHWRSHUIRUPDGPLQLVWUDWLYHWDVNV,QPRVWFDVHVWKLVZLOOEHlocalhostZKLFKZH
DVVXPHDVKRVWLQWKHIROORZLQJUHFLSH,QVRPHVLWXDWLRQVKRZHYHUWKLVPLJKWGLIIHUIRU
H[DPSOHLI\RXKDYHQRORJLQULJKWVRQWKHGDWDEDVHKRVWLWVHOI,QWKHVHVLWXDWLRQV\RXVKRXOG
GHÀQHDFHUWDLQKRVWDV\RXUEDVHIRUDGPLQLVWUDWLYHWDVNV+DYHLWVKRVWQDPHRU,3DGGUHVV
UHDG\IRUWKHIROORZLQJWDVNV

0\64/8VHU0DQDJHPHQW

7KHVWHSVEHORZZLOOJXLGH\RXWKURXJKWKHSURFHVVRIFUHDWLQJDQDOWHUQDWLYH
DGPLQLVWUDWLRQDFFRXQW
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKHURRWDFFRXQW

6HOHFWWKH8VHU$GPLQLVWUDWLRQHQWU\HLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

(QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHSDVVZRUGFRQWDFWLQIRUPDWLRQIROORZHG
E\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

5LJKWFOLFNRQWKHQHZXVHUDGPLQP\VTOLQWKHXVHUOLVWRQWKHORZHUOHIWDQG
FKRRVHWKHRSWLRQ$GGKRVWIURPZKLFKWKHXVHUFDQFRQQHFW

&KDSWHU


,QWKHIROORZLQJIRUPHQWHUWKHKRVWIURPZKLFK\RXDUHJRLQJWRSHUIRUP\RXU
DGPLQLVWUDWLRQWDVNVW\SLFDOO\localhost

6HOHFWWKHWDE*OREDO3ULYLOHJHV&KRRVHWKHEXWWRQWRJUDQWDOOJOREDOULJKWVWR
WKHXVHUIROORZHGE\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

5LJKWFOLFNRQWKHDGPLQP\VTOHQWU\RQWKHXVHUOLVWDQGVHOHFW5HPRYHKRVWIURP
ZKLFKWKHXVHUFDQFRQQHFWIURPWKHFRQWH[WPHQX

&RQÀUPWKHPHVVDJHER[LQGLFDWLQJ7KHDQ\KRVWHQWU\KDVEHHQGHOHWHG
IROORZHGE\WKH$SSO\FKDQJHVEXWWRQ
+RZLWZRUNV
/HW
VWDNHDORRNDWZKDWZHGLGWKURXJKRXWWKHDERYHUHFLSH,QVWHSVWKURXJKZHFUHDWHG
DQHZXVHUQDPHGDGPLQP\VTO$WWKLVSRLQWWKLVXVHUFRXOGFRQQHFWWRWKHGDWDEDVHVHUYHU
IURPDQ\KRVWEXWDVQHZXVHUVKDYHQRLQLWLDOULJKWVZKDWVRHYHUKHRUVKHZRXOGQRWEHDEOH
WRDFWXDOO\GRDQ\WKLQJ:LWKVWHSVDQGZHGHÀQHGDVSHFLÀFKRVWIURPZKLFKWKHXVHUZLOO
EHDOORZHGWRORJRQ6WHSÀQDOO\DVVLJQVDOOULJKWVWRWKHQHZO\FUHDWHGXVHU

0\64/8VHU0DQDJHPHQW

:LWKVWHSVDQGWKHXVHUDGPLQP\VTOLVQRORQJHUDEOHWRFRQQHFWIURPDQ\KRVWRWKHUWKDQ
localhost7KLVPDNHVLWQHFHVVDU\IRUDSRVVLEOHDWWDFNHUWRORJLQRQWKHKRVWLWVHOIEHIRUH
KHRUVKHFDQWU\WRJDLQDFFHVVWRWKHGDWDEDVH7KLVLQWXUQHQVXUHVEUXWHIRUFHDWWDFNVRQWKH
0\64/VHUYHUYLDWKHQHWZRUNIURPDUDQGRPKRVWIRUWKLVXVHUZLOOQRWEHVXFFHVVIXO
7KHUH
VPRUH
0\64/$GPLQLVWUDWRUIHDWXUHVDJUDSKLFDOXVHULQWHUIDFH³LWLVQRWWKHWRRORIFKRLFHLQVRPH
VLWXDWLRQVVXFKDVLIVFULSWLQJFDSDELOLWLHVDUHQHHGHG,QWKHVHFLUFXPVWDQFHVDVLQJOH64/
VFULSWZLOOSHUIRUPWKHVDPHFKDQJHVDVWKHDERYHUHFLSH7KLVVFULSWFRXOGEHH[HFXWHGIRU
H[DPSOHE\XVLQJWKHP\VTOFRPPDQGOLQHFOLHQWDQGFRQQHFWLQJZLWKDSULYLOHJHG0\64/
XVHUOLNH\RXUFXUUHQWURRWDFFRXQW
GRANT ALL PRIVILEGES ON *.* TO 'admin4mysql'@'localhost' 
IDENTIFIED BY 'As,ysp4M' WITH GRANT OPTION;
7KHYDOXHVIRUSDVVZRUGDQGPD\EHKRVWQDPHKDYHWREHDGDSWHGDFFRUGLQJWR\RXUFKRLFHV
6HHDOVR
f
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
'LVDEOLQJWKHGHIDXOWDFFRXQWV
,QWKHSUHYLRXVUHFLSHZHFUHDWHGDQHZXVHUIRUDGPLQLVWUDWLRQWDVNVDVDUHSODFHPHQWIRUWKH
GHIDXOWURRWXVHU,IDQGRQO\LIDQRWKHUXVHUZLWKIXOOULJKWVLVDYDLODEOHZHFDQGLVFDUG
WKHGHIDXOWXVHUVWKDWZHUHFUHDWHGGXULQJ0\64/LQVWDOODWLRQ7KLVKHOSVKDUGHQ\RXU0\64/
LQVWDOODWLRQDJDLQVWSRVVLEOHLQWUXGHUVZKRZLOOQRWEHDEOHWRDWWDFNZHOONQRZQDFFRXQWQDPHV
*HWWLQJUHDG\
<RXKDYHWRDVVXUH\RXUVHOIWKDW\RXKDYHDVHFRQGXVHUZLWKIXOOULJKWVLQDGGLWLRQWRWKHURRW
XVHUDW\RXUGLVSRVDO%\GHOHWLQJWKHURRWDFFRXQW\RXULVNDGDWDEDVHZLWKQRPHDQVRIEDVLF
DGPLQLVWUDWLRQ³XQOHVVWKHUHLVDQHTXLYDOHQWXVHUDYDLODEOH7KLVLVZK\0\64/$GPLQLVWUDWRU
ZRQ
WOHW\RXGHOHWHWKLVXVHUDQGKHQFHZHZLOOKDYHWRUHVRUWWRWKHFRPPDQGOLQHFOLHQWWR
GHOHWHWKHURRWDFFRXQW
7KHIROORZLQJVWHSVZLOOVKRZ\RXKRZWRUHPRYHWKHGHIDXOWDFFRXQWV

&KDSWHU

+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVHVHUYHUZLWKWKHmysqlFRPPDQGOLQHFOLHQWXVLQJWKH
DGGLWLRQDODGPLQLVWUDWLRQDFFRXQWDGPLQP\VTO

7RGHOHWHWKHURRWXVHULVVXHWKHIROORZLQJFRPPDQGV
DROP USER 'root'@'localhost';
DROP USER 'root'@'%';

7RGHOHWHWKHDQRQ\PRXVXVHUH[HFXWHWKHVHFRPPDQGV
DROP USER ''@'localhost';
DROP USER ''@'%';
+RZLWZRUNV
0\64/FUHDWHVXSWRIRXUGHIDXOWDFFRXQWVGHSHQGLQJRQWKHFKRLFHVPDGHGXULQJWKH
LQVWDOODWLRQ7KHVHIRXUDFFRXQWVXVHWZRXVHUQDPHVQDPHO\URRWDQGWKHDQRQ\PRXVXVHU
ZLWKDQHPSW\XVHUQDPH)RUHDFKXVHUQDPHWKHWZRKRVWV³localhostDQG%³DUHGHÀQHG
ZLWKWKHODWWHUEHLQJWKHSODFHKROGHUIRUDQ\KRVW7KXVWKHGHIDXOWDFFRXQWVDUHDVIROORZV
f
'root'@'localhost'
f
'root'@'%'
f
''@'localhost'
f
''@'%' 
7KHÀUVWDFFRXQW'root'@'localhost'LVDOZD\VDYDLODEOHZKLOHWKHRWKHU
WKUHHDUHRQO\FUHDWHGLQFHUWDLQLQVWDOODWLRQVFHQDULRV
:LWKWKHFRPPDQGVLQWKHDERYHVWHSVDOOSRVVLEOHGHIDXOWDFFRXQWVZLOOEHGHOHWHG,IWKHVH
XVHUVGRQRWH[LVW\RXZLOOUHFHLYHDQHUURUPHVVDJHHUURUFRGHRSHUDWLRQIDLOHGLQ
GLFDWLQJWKDWWKHDFFRXQWGRHVQRWH[LVW$IWHUKDYLQJH[HFXWHGDOORIWKHVHFRPPDQGV\RX
FDQEHVXUHWKDWQRXQZDQWHGGHIDXOWDFFRXQWVDUHOHIW
<RXFDQWHVWWKHHIIHFWRIWKHVWHSVSHUIRUPHGE\XVLQJ0\64/$GPLQLVWUDWRU7KHHQWULHV
RIWKHURRWXVHUDQGWKHDQRQ\PRXVXVHUZLWKWKHHPSW\QDPHZLOOEHJRQHLQWKH8VHU
$GPLQLVWUDWLRQYLHZLI\RXUHFRQQHFWWR\RXUGDWDEDVHVHUYHU
6HHDOVR
f
5HJDLQLQJDFFHVVWR\RXUGDWDEDVHLQFDVHRIORVWDFFRXQWLQIRUPDWLRQ

0\64/8VHU0DQDJHPHQW

&UHDWLQJDEDVLFXVHU
,ILQVWDOOHGIURPVFUDWFK0\64/GRHVQRWSURYLGHDGHIDXOWXVHUVXLWDEOHIRUHYHU\GD\XVH
<RXFRXOGRIFRXUVHXVHWKHURRWXVHURUDQDOWHUQDWLYHDGPLQLVWUDWLYHXVHUIRUH[DPSOH
DGPLQP\VTOZLWKIXOOULJKWV+RZHYHUWKLVLVVWURQJO\GLVFRXUDJHGIRUVHFXULW\UHDVRQV
HVSHFLDOO\LI\RXKDYHGLIIHUHQWXVHUVDQGRUDSSOLFDWLRQVWKDWQHHGDFFHVVWR\RXU0\64/
GDWDEDVH,QWKHIROORZLQJUHFLSHZHZLOOVKRZ\RXKRZWRFUHDWHDW\SLFDOXVHUWKDWKDVIXOO
DFFHVVWRDFHUWDLQGDWDEDVHVFKHPD
*HWWLQJUHDG\
<RXZLOOQHHGVRPHLQIRUPDWLRQEHIRUHVWHSSLQJWKURXJKWKLVUHFLSH
,QWKHÀUVWSODFH\RXZLOOQHHGDXVHUQDPHDQGDSDVVZRUG,IWKHXVHULVDSHUVRQZKRLV
JRLQJWRXVHWKHGDWDEDVHLQWHUDFWLYHO\\RXZLOOPRVWO\XVHKLVRUKHUUHDOQDPHDVWKHORJLQ
QDPH)RUDFFRXQWVWKDWZLOOEHXVHGE\DSSOLFDWLRQVLWLVW\SLFDOO\DJRRGLGHDWRLQFOXGHWKH
DSSOLFDWLRQDQG³LIDSSOLFDEOH³WKHUROHIRUZKLFKWKHDFFRXQWZLOOEHXVHGLQWKHDFFRXQW
QDPH([DPSOHVZRXOGEHMRKQBGRHKRWHOERRNLQJRUFDUUHQWDOBVWGXVU.HHSLQPLQG
KRZHYHUWKDWWKHOHQJWKRIWKHXVHUQDPHDVRI0\64/LVOLPLWHG
7KHOHQJWKRID0\64/XVHUQDPHPXVWQRWH[FHHGFKDUDFWHUV
6HFRQG\RXVKRXOGÀQGRXWDERXWZKLFKGDWDEDVHRI\RXU0\64/LQVWDOODWLRQKDVWREH
DFFHVVHGE\\RXUXVHU7KLVGDWDEDVHKDVWRH[LVWDOUHDG\RWKHUZLVH\RXZLOOQRWEHDEOHWR
DVVLJQWKHUHVSHFWLYHULJKWVXVLQJ0\64/$GPLQLVWUDWRUKRZHYHUWKHVFULSWVROXWLRQLQWKH
7KHUH
VPRUHVHFWLRQZRXOGHYHQZRUNZLWKRXWDQH[LVWLQJWDUJHWVFKHPD
7KURXJKRXWWKLVUHFLSHZHZLOOVKRZ\RXKRZWRFUHDWHDEDVLFXVHUVDPSOHBVWGXVHU
ZLWKUHDGZULWHDFFHVVWRDGDWDEDVHQDPHGVDPSOHDQGDSDVVZRUG6PSO3Z
$VDSUHUHTXLVLWHZHDVVXPHWKDWWKHGDWDEDVHVDPSOHDOUHDG\H[LVWV
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKH
DGPLQP\VTODFFRXQW

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

&KDSWHU

 (QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHSDVVZRUGFRQWDFWLQIRUPDWLRQIROORZHG
E\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

6HOHFWWKHWDE6FKHPD3ULYLOHJHVDQGVHOHFWWKHVFKHPDVDPSOHIURPWKH6FKHPDWD
OLVWRQWKHOHIW6HOHFWWKHSULYLOHJHV6(/(&7,16(5783'$7('(/(7(&5($7(
7(0325$5<7$%/(6/2&.7$%/(6DQG(;(&87(IURPWKH$YDLODEOH3ULYLOHJHV
OLVWRQWKHULJKWDQGIRUHDFKVHOHFWHGSULYLOHJHSUHVVWKHEXWWRQ&KRRVHWKH$SSO\
FKDQJHVEXWWRQDIWHUZDUGV

0\64/8VHU0DQDJHPHQW

7RVHOHFWDQGDVVLJQPRUHWKDQRQHSULYLOHJHDWRQFHKROGGRZQWKH&WUONH\
ZKLOHVHOHFWLQJWKHSULYLOHJHV
+RZLWZRUNV
6WHSFUHDWHVDQHZXVHUZKRLVDOORZHGWRFRQQHFWIURPDQ\KRVWEXWKDVQRSULYLOHJHV
ZKDWVRHYHU%\DVVLJQLQJWKHSULYLOHJHVLQVWHSWKHXVHULVJUDQWHGWKHULJKWVWRUHDG
SELECTDQGFKDQJHINSERTUPDATEDELETEGDWDIURPDQ\WDEOHLQWKHVDPSOH
VFKHPD7KHVHDUHWKHPRVWEDVLFULJKWVWKDWDUHW\SLFDOO\QHFHVVDU\IRUDEDVLFXVHU
$GGLWLRQDOO\ZHJUDQWWKHCREATETEMPORARYTABLESULYLOHJH7KLVVRPHWLPHVFRPHV
LQKDQG\IRUFRPSOH[VWDWHPHQWVDQGWKHFRUUHVSRQGLQJULVNVDUHW\SLFDOO\DFFHSWDEOH
7HPSRUDU\WDEOHVDUHQRWYLVLEOHWRRWKHUXVHUVDQGDUHOLPLWHGWRWKHGDWDEDVHFRQQHFWLRQ
E\ZKLFKWKH\DUHFUHDWHG0RUHRYHUWKH\DUHSXUJHGDVVRRQDVWKHFRQQHFWLRQLVFORVHG6R
W\SLFDOO\LWLVQRWDSUREOHPWRJUDQWWKLVULJKW+RZHYHUDVZLWKDOOSULYLOHJHVWKHEDVLFVHFXULW\
UXOHKROGVWUXHIRUWKLVULJKWVDVZHOO
'RQ
WDVVLJQXQQHFHVVDU\SULYLOHJHV

&KDSWHU

,I\RXDUHVXUHWKDWWKLVSULYLOHJHZLOOQRWEHXVHGLWLVUHFRPPHQGHGQRWWRDVVLJQLWWRWKH
XVHU\RXFUHDWHG
7KHLOCKTABLESSULYLOHJHDOORZVWKHXVHUWRFRPSOHWHO\ORFNWDEOHV7KLVLVVRPHWLPHV
KHOSIXOWRFRRUGLQDWHFRQFXUUHQWDFFHVVWRGDWDE\GLIIHUHQWVHVVLRQVDQGLVQHHGHGE\
VRPHDSSOLFDWLRQVWKDWPDNHXVHRILOCKTABLESVWDWHPHQWVWRSUHYHQWFRQFXUUHQWGDWD
PRGLÀFDWLRQV2QWKHRWKHUKDQGWKLVSULYLOHJHHQDEOHVDXVHUWREORFNUHDGDQGZULWHDFFHVV
WRDOOWDEOHVDWGLVFUHWLRQZKLFKPLJKWEDVLFDOO\UHQGHUWKHGDWDEDVHXVHOHVVWRRWKHUXVHUVLQ
FDVHRIH[WHQVLYHRULQFDXWLRXVXVHRIRILOCKTABLESVWDWHPHQWV,I\RXDUHVXUHWKDW\RXU
XVHUZRQ
WQHHGVXFKVWDWHPHQWVLWLVUHFRPPHQGHGQRWWRDVVLJQWKLVSULYLOHJH
)LQDOO\WKHEXECUTESULYLOHJHJLYHVWKHXVHUWKHULJKWWRFDOOVWRUHGURXWLQHV$VWKHXVHULV
QRWJUDQWHGWKHULJKWVWRFUHDWHRUFKDQJHVXFKURXWLQHVJUDQWLQJWKLVSULYLOHJHGRHVQRWSRVH
DQRWHZRUWK\DGGLWLRQDOULVNHYHQLIWKHUHDUHQRVWRUHGURXWLQHVWRH[HFXWH,IWKHUHDUHDQ\
WKHEXECUTESULYLOHJHKDVWREHDVVLJQHGIRUWKHXVHUWREHDEOHWRFDOOWKHVHVWRUHGURXWLQHV
6RPHDSSOLFDWLRQVPDNHXVHRIVWRUHGURXWLQHVVRWKLVULJKWZDVLQFOXGHGIRUW\SLFDOXVHUV
%XWDVVWRUHGSURFHGXUHVDQGIXQFWLRQVDUHVWLOODIDLUO\QHZIHDWXUHRI0\64/WKH\DUHQRW
YHU\ZLGHO\XVHG\HW6RLQPDQ\FDVHV\RXFDQGRZLWKRXWWKLVSULYLOHJH
:LWKWKLVVHWRISULYLOHJHVZHFUHDWHGDXVHUWKDWKDVIXOODFFHVVWRDOOWDEOHVLQRXUVFKHPD
7KLVDFFRXQWLVDUHDVRQDEOHFRPSURPLVHEHWZHHQULJKWVJUDQWHGDQGUHVWULFWLRQVVWLOOLQ
SODFH+RZHYHU\RXZLOOQHHGDFRUUHVSRQGLQJLQVWDOODWLRQXVHUWKDWFDQEHXVHGWRVHWXSWKH
VFKHPDLQWKHÀUVWSODFH7KHFUHDWLRQRIWKLVXVHULVGHVFULEHGLQWKHIROORZLQJUHFLSH
7KHUH
VPRUH
,I\RXZDQWRUQHHGWRDYRLGXVLQJ0\64/$GPLQLVWUDWRUIRUFUHDWLQJWKHEDVLFXVHUDFFRXQW
\RXFDQDOWHUQDWLYHO\LVVXHDVLQJOH64/VWDWHPHQWLQVWHDGWKHYDOXHVIRUSDVVZRUGDQG
GDWDEDVHQDPHKDYHWREHDGDSWHGDFFRUGLQJWR\RXUFKRLFHV
GRANT SELECT, INSERT, UPDATE, DELETE, CREATE TEMPORARY TABLES, LOCK 
TABLES, EXECUTE ON sample.* TO 'sample_stduser'@'%' IDENTIFIED BY 
'S4mpl3-Pw';
7KLVLVKHOSIXOLI\RXQHHGDVFULSWLQJVROXWLRQIRUXVHUGHÀQLWLRQVEXWLWDOVRJLYHV\RX
WKHSRVVLELOLW\WRFUHDWHWKHXVHUEHIRUHWKHWDUJHWGDWDEDVHVFKHPDH[LVWV:LWK0\64/
DGPLQLVWUDWRU\RXKDYHWRGHÀQHWKHVFKHPDÀUVWEHFDXVHLWZLOORQO\OHW\RXDVVLJQULJKWV
IRUH[LVWLQJGDWDEDVHV7KLVVFULSWFRXOGEHH[HFXWHGIRUH[DPSOHE\XVLQJWKH0\64/
FRPPDQGOLQHFOLHQW
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
f
&UHDWLQJDQLQVWDOODWLRQXVHU

0\64/8VHU0DQDJHPHQW

&UHDWLQJDQLQVWDOODWLRQXVHU
,QWKHSUHYLRXVUHFLSH&UHDWLQJDEDVLFXVHUZHGLVFXVVHGKRZWRGHÀQHDW\SLFDOXVHUIRU
DFFHVVLQJDFHUWDLQGDWDEDVHVFKHPD$GGLWLRQDOO\WKHUHLVDQDGPLQLVWUDWLRQXVHUDFFRXQW
ZLWKIXOOULJKWV)RULQVWDOODWLRQVWKDWDUHPDQDJHGE\RQHVLQJOHDGPLQLVWUDWRUWKLVPLJKW
EHVXIÀFLHQW%XWRIWHQ\RXGRQRWZDQWWRSHUIRUPDOODGPLQLVWUDWLYHWDVNVE\\RXUVHOI)RU
H[DPSOH\RXPLJKWZDQWWRGHOHJDWHWKHWDVNRIGHÀQLQJWKHGDWDEDVHVWUXFWXUHWRDGLIIHUHQW
SHUVRQ6RPHDSSOLFDWLRQVDOVRKDYHWKHLURZQLQVWDOODWLRQURXWLQHVWKDWUHTXLUHULJKWVWRVHW
XSDGDWDEDVHVFKHPD)RUWKHVHWDVNV\RXVKRXOGFRQVLGHUFUHDWLQJDVSHFLÀFLQVWDOODWLRQ
XVHUIRUFHUWDLQGDWDEDVHV7KLVXVHUVKRXOGQRWKDYHJOREDOULJKWVEXWVKRXOGEHUHVWULFWHG
WRPDNHFKDQJHVWRRQHVSHFLÀFGDWDEDVH7KLVZD\\RXFDQGHOHJDWHFHUWDLQDGPLQLVWUDWLRQ
WDVNVZLWKRXWWKHULVNRIXVHUVWDPSHULQJZLWKRWKHUGDWDEDVHVWKDWDUHQRWWKHLUEXVLQHVV
(YHQLI\RXPDQDJH\RXUGDWDEDVHLQVWDOODWLRQDOOE\\RXUVHOILWPLJKWEHDJRRGLGHDWR
XVHDVSHFLÀFDFFRXQWWRSHUIRUPWKHVHWDVNVDVWKLVKHOSVSUHYHQWDFFLGHQWDOFKDQJHV
WRRWKHUGDWDEDVHV
7KLVUHFLSHZLOOJXLGH\RXWKURXJKWKHVWHSVRIFUHDWLQJVXFKDQLQVWDOODWLRQXVHUIRUDFHUWDLQ
GDWDEDVHVFKHPD
*HWWLQJUHDG\
)RUWKLVUHFLSH\RXZLOODJDLQQHHGWRFRPHXSZLWKDXVHUQDPHUHPHPEHUWKHFKDUDFWHU
OHQJWKOLPLWDSDVVZRUGDQGWKHQDPHRIWKHGDWDEDVHWKDWZLOOEHDFFHVVLEOHWRWKHXVHU
$VEHIRUHWKLVGDWDEDVHVKRXOGDOUHDG\H[LVWRWKHUZLVH\RXZLOOKDYHWRUHVRUWWRWKHVFULSWLQJ
VROXWLRQIURPWKH7KHUH
VPRUHVHFWLRQRIWKLVUHFLSH
:HZLOODVVXPHVDPSOHBLQVWDOODVWKHXVHUQDPHVDPSOHDVWKHGDWDEDVHDQGQWOO3ZDV
WKHSDVVZRUG
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKHDGPLQLVWUDWLRQ
DFFRXQWDGPLQP\VTO

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

&KDSWHU

 (QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHSDVVZRUGFRQWDFWLQIRUPDWLRQIROORZHG
E\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

0\64/8VHU0DQDJHPHQW


6HOHFWWKHWDE6FKHPD3ULYLOHJHVDQGVHOHFWWKHVFKHPDVDPSOHIURPWKH6FKHPDWD
OLVWRQWKHOHIW3UHVVWKHEXWWRQWRDVVLJQDOOSULYLOHJHVIRUWKHVDPSOHGDWDEDVH
1H[WVHOHFWWKH*5$17SULYLOHJHIURPWKH$VVLJQHG3ULYLOHJHVOLVWDQGSUHVVWKH!
EXWWRQWRH[FOXGHWKH*5$17ULJKW&KRRVHWKH$SSO\FKDQJHVEXWWRQDIWHUZDUGV
+RZLWZRUNV
7KHQHZXVHULVFUHDWHGLQVWHSVWKURXJKZKLOHVWHSDVVLJQVDOOULJKWVRQWKHVDPSOH
GDWDEDVHWRWKHXVHUZLWKWKH*5$17SULYLOHJHEHLQJWKHRQO\H[FHSWLRQDOVRVHHWKH7KHUH
V
PRUH«VHFWLRQRIWKLVUHFLSH
7KLVXVHUKDVEDVLFDOO\IXOOULJKWVIRUWKHZKROHGDWDEDVHVFKHPD7KLVDFFRXQWFDQEHXVHG
WRVHWXSWKHGDWDEDVHZKLFKPLJKWIRUH[DPSOHLQYROYHFUHDWLRQGHOHWLRQRUPDNLQJ
FKDQJHVWRWDEOHVPDQDJHPHQWRIVWRUHGURXWLQHVRUGHÀQLWLRQRIYLHZV+RZHYHULWLVQRW
UHFRPPHQGHGWRXVHVXFKDSRZHUIXODFFRXQWIRUQRUPDORSHUDWLRQV<RXVKRXOGSUHIHUDEO\
VWLFNWRDEDVLFXVHUIRUWKLVLQVWHDGDVZHKDYHGHÀQHGLQWKHSUHYLRXVUHFLSH

&KDSWHU

7KHUH
VPRUH
,QWKLVVHFWLRQZHZLOOGLVFXVVVRPHDGYDQFHGDVSHFWVRIWKHXVHUFUHDWLRQVXFKDVVFULSWHG
VROXWLRQVWRWKHSUREOHPDQGJUDQWLQJULJKWVWRFUHDWHXVHUVWRFHUWDLQDFFRXQWV
&UHDWLQJWKHDFFRXQWZLWKRXWXVLQJ0\64/$GPLQLVWUDWRU
<RXFDQDOVRFUHDWHWKHDFFRXQWZLWKRXWKDYLQJWRXVH0\64/$GPLQLVWUDWRUE\LVVXLQJ
WKHIROORZLQJ64/FRPPDQGDGDSWWKHYDOXHVIRUSDVVZRUGDQGGDWDEDVHVFKHPDQDPH
DFFRUGLQJO\
grant ALL PRIVILEGES on sample.* to 'sample_install'@'%' identified by 
'1n5t4ll-Pw';
$VPHQWLRQHGEHIRUHWKLVDOORZVIRUVFULSWLQJDVZHOODVGHÀQLQJWKHDFFRXQWZLWKRXWKDYLQJWR
FUHDWHWKHGDWDEDVHEHIRUHKDQG)RUH[DPSOH\RXFRXOGXVHWKH0\64/FRPPDQGOLQHFOLHQW
WRH[HFXWHWKLVVFULSW
3HUPLWWLQJPDQDJHPHQWRIXVHUULJKWV
6RPHDSSOLFDWLRQVIHDWXUHKLJKO\VRSKLVWLFDWHGLQVWDOODWLRQURXWLQHVZKLFKWU\WRSHUIRUP
PDQ\WDVNVDXWRPDWLFDOO\,QVRPHFDVHVWKH\DOVRWU\WRGHÀQH0\64/XVHUULJKWVWKHPVHOYHV
WRPDNHVXUHWKH\KDYHWKHFRUUHFWVHWRISULYLOHJHV,IWKLVLVWKHFDVH\RXPLJKWQHHGWR
SHUPLWSULYLOHJHPDQDJHPHQWIRUWKHLQVWDOODWLRQXVHU
$VDQRWKHUH[DPSOH\RXPLJKWZDQWWRGHOHJDWHQRWRQO\WKHUHVSRQVLELOLW\RIPDQDJLQJ
DGDWDEDVHEXWDOVRWKHVRPHWLPHVWHGLRXVWDVNRIPDLQWDLQLQJWKHSULYLOHJHVRIWKH
FRUUHVSRQGLQJXVHUDFFRXQWV
,QERWKVLWXDWLRQV\RXVKRXOGFRQVLGHUDVVLJQLQJWKHGRANTSULYLOHJHWRWKHLQVWDOODWLRQXVHU
7KLVULJKWDOORZVJUDQWLQJWKRVHULJKWVWRRWKHUXVHUVRUUHYRNLQJWKHPIURPWKHPWKDW\RXDUH
JUDQWHG\RXUVHOI$VDUHVXOWWKHGRANTSULYLOHJHZLOOQRWDOORZWKHLQVWDOODWLRQXVHUWRH[WHQG
KLVRUKHUULJKWV

0\64/8VHU0DQDJHPHQW

7RDVVLJQWKHGRANTSULYLOHJHXVLQJ0\64/$GPLQLVWUDWRUVHOHFWWKHVDPSOHBLQVWDOOXVHU
LQWKH8VHU$GPLQLVWUDWLRQYLHZVZLWFKWRWKH6FKHPD3ULYLOHJHVWDEVHOHFWWKHVDPSOH
VFKHPDDQGDVVLJQWKHSULYLOHJHE\VHOHFWLQJLWDQGSUHVVLQJWKHEXWWRQIROORZHGE\WKH
$SSO\&KDQJHVEXWWRQ
$OWHUQDWLYHO\\RXFRXOGLVVXHWKHIROORZLQJ64/FRPPDQG
GRANT ALL PRIVILEGES ON sample.* TO 'sample_install'@'%' IDENTIFIED BY 
'1n5t4ll-Pw' WITH GRANT OPTION;
3OHDVHQRWHWKDWWKHGRANTSULYLOHJHLWVHOIGRHVQRWDOORZ\RXWRFUHDWHXVHUV
)RUEHLQJDEOHWRFUHDWHXVHUVDQDGPLQLVWUDWLRQXVHUKDVWRKDYHZULWHDFFHVVWRWKHP\VTO
GDWDEDVH8QIRUWXQDWHO\WKLVDOORZVIRUPDQLSXODWLRQRIDOOXVHUDFFRXQWVUHJDUGOHVVRIWKHLU
VFRSHVRDXVHUZLWKP\VTOZULWHDFFHVVLVQRWUHVWULFWHGWRPDQDJLQJRQHVHSDUDWHGDWDEDVH
DQ\PRUH%HFDXVHRIWKLVZHUHFRPPHQGOHDYLQJWKHFUHDWLRQRUGHOHWLRQRIWKHDFFRXQWVWR
WKHPDLQDGPLQLVWUDWLYHXVHU7KHLQVWDOODWLRQXVHULVWKHQDEOHWRDVVLJQWKHVSHFLÀFULJKWVIRU
WKHGDWDEDVHKHRUVKHLVUHVSRQVLEOHIRUWRWKHXVHU

&KDSWHU

([DPSOH/HWWKHDGPLQP\VTODFFRXQWFUHDWHDXVHUZLWK
GRANT USAGE ON *.* to 'john_doe'@'%' IDENTIFIED BY 'Confidential';
7KHLQVWDOODWLRQXVHUVDPSOHBLQVWDOOLIKHRUVKHKDVWKHGRANTSULYLOHJHFDQWKHQDVVLJQ
VSHFLÀFULJKWVWRWKHXVHUDWKLVRUKHURZQGLVFUHWLRQ
GRANT SELECT ON sample.* to 'john_doe'@'%';
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
f
&UHDWLQJDEDVLFXVHU
&UHDWLQJDUHDGRQO\DFFRXQW
,QWKHSUHYLRXVUHFLSHVZHSUHVHQWHGKRZWRGHÀQHXVHUVIRUGLIIHUHQWUROHVJOREDO
DGPLQLVWUDWLRQVHWWLQJXSDVSHFLÀFGDWDEDVHDQGEDVLFDFFHVV$QRWKHUW\SLFDOUROHIRUXVHUV
LVWKHJXHVWXVHUZKLFKW\SLFDOO\LVOLPLWHGWRUHDGRQO\RSHUDWLRQV&UHGHQWLDOVIRUVXFKDQ
DFFRXQWFDQEHSDVVHGRQWRGLIIHUHQWSHRSOHZLWKRXWULVNLQJDFFLGHQWDORUGHOLEHUDWHGDWD
PDQLSXODWLRQ,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRGHÀQHVXFKDUHDGRQO\XVHUDFFRXQW
*HWWLQJUHDG\
7KLQNRIDFDWFK\XVHUQDPHSDVVZRUGDQGWKHQDPHRIWKHGDWDEDVHVFKHPDIRUZKLFKWKH
XVHUZLOOKDYHUHDGDFFHVV,QDGGLWLRQWKLVVFKHPDVKRXOGDOUHDG\H[LVW<RXZLOOKDYHWRXVH
WKH64/VWDWHPHQWDOWHUQDWLYHIURPWKH7KHUH
VPRUHVHFWLRQRIWKLVUHFLSHRWKHUZLVH
:HZLOODVVXPHVDPSOHBJXHVWDVWKHXVHUQDPHVDPSOHDVWKHGDWDEDVHDQG5GQO\DV
WKHSDVVZRUG
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKHDGPLQLVWUDWLRQ
DFFRXQWDGPLQP\VTO

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

0\64/8VHU0DQDJHPHQW

 (QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHSDVVZRUGFRQWDFWLQIRUPDWLRQIROORZHG
E\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

&KDSWHU


6HOHFWWKHWDE6FKHPD3ULYLOHJHVDQGVHOHFWWKHVFKHPDVDPSOHIURPWKH6FKHPDWD
OLVWRQWKHOHIW&OLFNRQWKH6(/(&7SULYLOHJHIURPWKH$YDLODEOH3ULYLOHJHVOLVWRQ
WKHULJKWDQGSUHVVWKHEXWWRQWRDVVLJQWKLVSULYLOHJH&KRRVHWKH$SSO\FKDQJHV
EXWWRQDIWHUZDUGV
+RZLWZRUNV
6WHSVWKURXJKFUHDWHWKHXVHUZLWKRXWDQ\SULYLOHJHVVWHSDVVLJQVWKH6(/(&7ULJKWRQ
WKHVDPSOHGDWDEDVHWRWKHXVHU
:LWKWKHVHVHWWLQJVWKLVXVHULVQRWDEOHWRPDNHDQ\FKDQJHVWRWKHGDWDEDVH1HYHUWKHOHVV
ZHVWURQJO\UHFRPPHQGQRWFRPPXQLFDWLQJWKHXVHUQDPHDQGWKHSDVVZRUGIRUWKLVJXHVW
DFFRXQWWRROD[O\,QPDQ\FDVHVDGDWDEDVHFRQWDLQVYDOXDEOHRUVHQVLWLYHLQIRUPDWLRQ,IWKH
FUHGHQWLDOVRIDJXHVWXVHUDFFRXQWDUHFRPPRQNQRZOHGJHRUWRRHDV\WRJXHVVOLNHWKH
LQIDPRXVXVHUQDPH
JXHVW
ZLWKH[DFWO\WKHVDPHSDVVZRUG\RXUGDWDZLOOEHDQHDV\SUH\IRU
DQ\SRVVLEOHLQWUXGHU

0\64/8VHU0DQDJHPHQW

7KHUH
VPRUH
,QWKLVVHFWLRQZHZLOOGLVFXVVVRPHDGYDQFHGDVSHFWVRIWKHXVHUFUHDWLRQVXFKDVVFULSWHG
VROXWLRQVWRWKHSUREOHPDQGJUDQWLQJULJKWVWRFUHDWHXVHUVWRFHUWDLQDFFRXQWV
&UHDWLQJWKHDFFRXQWZLWKRXWXVLQJ0\64/$GPLQLVWUDWRU
7RFUHDWHWKHJXHVWDFFRXQWZLWKRXWXVLQJ0\64/$GPLQLVWUDWRUH[HFXWHWKHIROORZLQJ
64/FRPPDQG
GRANT SELECT ON sample.* TO 'sample_guest'@'%' IDENTIFIED BY   
'R34d-0nly';
7KLVFRPPDQGZLOODOVRZRUNLIWKHVDPSOHGDWDEDVHZDVQRWFUHDWHGLQDGYDQFH
$OORZLQJVWRUHGSURFHGXUHFDOOV
6RPHGDWDEDVHGHVLJQHUVWU\WRHQFDSVXODWHFRPSOH[VWDWHPHQWVLQVWRUHGURXWLQHVIXQFWLRQV
RUSURFHGXUHV6RPHRIWKHVHURXWLQHVFRXOGDOVREHYHU\KHOSIXOIRUDJXHVWXVHUVRKHRU
VKHFDQUHVRUWWRSUHGHÀQHGORJLFDQGGRHVQRWKDYHWRWU\WRFRQVWUXFWFRPSOH[TXHULHV
E\KLPRUKHUVHOI)RUWKLVUHDVRQLWPLJKWPDNHVHQVHWRDOVRDVVLJQWKHEXECUTESULYLOHJH
WRWKHJXHVWXVHU%XWSOHDVHQRWHWKDWDVVLJQLQJWKLVSULYLOHJHPLJKWKDYHDQXQH[SHFWHG
VLGHHIIHFW
$JXHVWXVHUZLWKEXECUTEULJKWVFDQSHUIRUPFKDQJHVWRWKHGDWDEDVH
,IDVWRUHGURXWLQHSHUIRUPVFKDQJHVWRWKHGDWDEDVHOLNHDQUPDATERUDDELETERSHUDWLRQ
LWZLOOH[HFXWHÁDZOHVVO\HYHQLIWKHXVHUZKRFDOOVWKLVURXWLQHGRHVQRWKDYHDQ\RWKHUULJKWV
EXWEXECUTE7KLVGRHVQRWW\SLFDOO\SRVHDVHULRXVULVNEHFDXVHWKHJXHVWXVHULVQRWDEOH
WRGHÀQHQHZURXWLQHVRQKLVRUKHURZQ%XWDVVRRQDVWKHUHDUHVWRUHGSURFHGXUHVLQSODFH
WKDWSHUIRUPFKDQJHVWRWKHGDWDEDVHWKHEXECUTESULYLOHJHVKRXOGEHJUDQWHGZLWKFDUH
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV

&KDSWHU

'HÀQLQJDVSHFLÀFXVHUIRUEDFNXS
(YHQWKRXJKPDQ\SHRSOHKDYHDWHQGHQF\WRLJQRUHWKHSRVVLELOLW\RIXQSOHDVDQWIXWXUH
HYHQWVRQHRI\RXUGXWLHVDVDGDWDEDVHDGPLQLVWUDWRULVWRWDNHUHDVRQDEOHSUHFDXWLRQVWR
PLQLPL]HWKHQHJDWLYHHIIHFWVRIDGLVDVWHU,QVKRUWLWLV\RXUMREWRSHUIRUPEDFNXSV
7KHUHDUHVRPHVWUDWHJLHVRQKRZWREHVWEDFNXS\RXUGDWDEDVHDQGWKHUHDUHDOVRGLIIHUHQW
WRROVRQWKHPDUNHWWKDWSURPLVHWRKHOS\RXGRVR%DVLFDOO\WKHGLIIHUHQWEDFNXSVWUDWHJLHV
FDQEHGLYLGHGLQWRWZRJURXSVKRWDQGFROGEDFNXS:KLOHFROGEDFNXSVFDQVLPSO\EHGRQH
E\FRS\LQJDQGVDYLQJÀOHVKRWEDFNXSVDUHQRWDVHDV\WRSHUIRUP
7KHUHDUHVRPHWRROVDYDLODEOHWKDWSURPLVHÀOHEDVHGKRWEDFNXSV+RZHYHULI\RXZDQWRU
QHHGWRUHVRUWWRWKH0\64/WRROV\RXZLOOW\SLFDOO\KDYHWRGRDGDWDEDVHGXPSIRUH[DPSOH
XVLQJP\TVOGXPSWREDFNXS\RXUGDWDGXULQJQRUPDORSHUDWLRQVLIDOO\RXUWDEOHVDUH
0\,6$0WDEOHV\RXFRXOGXVHWKHP\VTOKRWFRS\WRROLQVWHDG
7RSHUIRUPDGDWDEDVHGXPS\RXZLOOQHHGDXVHUWRFRQQHFWWR\RXUGDWDEDVH:H
UHFRPPHQGGHÀQLQJDXVHUWKDWLVVSHFLÀFDOO\VXLWHGIRUWKLVWDVN7KLVDOORZV\RXWRTXLFNO\
LGHQWLI\FRQQHFWLRQVXVHGIRUEDFNXSVDQG\RXFDQEHVXUHWKDWWKHVHFRQQHFWLRQVZLOOQRWEH
DEOHWRFKDQJHDQ\GDWD7KHIROORZLQJUHFLSHZLOOVKRZ\RXKRZWRFUHDWHVXFKDQDFFRXQW
3OHDVHQRWHWKDWWKLVXVHULVVXLWHGIRUEDFNXSSXUSRVHVRQO\7KHUHFRYHU\
WDVNVKRXOGEHSHUIRUPHGE\DQDGPLQLVWUDWRUXVHUEHFDXVH\RXW\SLFDOO\
QHHGIXOODFFHVVWRWKHGDWDEDVHIRUWKLV
*HWWLQJUHDG\
$JDLQ\RXDUHJRLQJWRQHHGDXVHUQDPHDQGDSDVVZRUG:HZLOOXVHEDFNXSBXVUDVWKH
XVHUQDPHDQG%FN08SDVWKHSDVVZRUG
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKH
DGPLQP\VTODFFRXQW

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

(QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHSDVVZRUGFRQWDFWLQIRUPDWLRQIROORZHG
E\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

0\64/8VHU0DQDJHPHQW

 5LJKWFOLFNRQWKHQHZXVHUEDFNXSBXVULQWKHXVHUOLVWRQWKHORZHUOHIWDQGFKRRVH
WKHRSWLRQ$GGKRVWIURPZKLFKWKHXVHUFDQFRQQHFW
 ,QWKHIROORZLQJIRUPHQWHUWKHKRVWIURPZKLFK\RXDUHJRLQJWRSHUIRUP\RXU
EDFNXSVW\SLFDOO\localhost

&KDSWHU


6HOHFWWKHWDE*OREDO3ULYLOHJHV&KRRVHWKH6(/(&75(/2$'/2&.B7$%/(6DQG
5(3/B&/,(17SULYLOHJHVIURPWKH$YDLODEOH3ULYLOHJHVOLVWRQWKHULJKWSUHVVWKH
EXWWRQIRUHDFKRIWKHPDQGFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

0\64/8VHU0DQDJHPHQW

 5LJKWFOLFNRQWKHEDFNXSBXVUHQWU\RQWKHXVHUOLVWDQGVHOHFW5HPRYHKRVWIURP
ZKLFKWKHXVHUFDQFRQQHFWIURPWKHFRQWH[WPHQX
 &RQÀUPWKHPHVVDJHER[LQGLFDWLQJ7KHDQ\KRVWHQWU\KDVEHHQGHOHWHGWKHQ
FOLFNWKH$SSO\FKDQJHVEXWWRQ
+RZLWZRUNV
/HW
VWDNHDORRNDWWKHVWHSVRIWKLVUHFLSH%\IROORZLQJVWHSVWKURXJKDQHZXVHUQDPHG
EDFNXSBXVULVFUHDWHG$WWKLVSRLQWWKLVXVHUGRHVQRWKDYHDQ\ULJKWVEXWFRXOGVXFFHVVIXOO\
FRQQHFWIURPDQ\KRVW6WHSVDQGGHÀQHDVSHFLÀFKRVWlocalhostIURPZKLFKWKH
XVHUZLOOEHDOORZHGWRORJRQ6WHSÀQDOO\DVVLJQVWKHULJKWVWKDWDUHQHFHVVDU\WRSHUIRUP
EDFNXSVXVLQJWKHP\VTOGXPSFRPPDQG

&KDSWHU

:LWKVWHSVDQGWKHXVHULVQRORQJHUDEOHWRFRQQHFWIURPDQ\KRVWRWKHUWKDQ
localhost7KLVPDNHVDQDWWDFNKDUGHUEHFDXVHDSRVVLEOHLQWUXGHUZRXOGÀUVWKDYH
WRORJLQWRWKHKRVWLWVHOIEHIRUHKHRUVKHFDQDFFHVVWKHGDWDEDVH
7KHÀUVWDQGPRVWLPSRUWDQWSULYLOHJHWKDWZDVDVVLJQHGLVWKH6(/(&7SULYLOHJHZKLFKLV
XVHGWRUHDGWKHGDWDRWKHUZLVHZHZRXOGQRWEHDEOHWRZULWHLWWRWKHGXPSÀOH$VWKLVXVHU
LVDOORZHGWRUHDGDOOGDWDIURPDOOGDWDEDVHV\RXVKRXOGQRWIRUZDUGWKHXVHUFUHGHQWLDOVRI
WKLVXVHU
7KHVHFRQGSULYLOHJHLVLOCK_TABLES,WLVQHHGHGEHFDXVHP\VTOGXPSORFNVWKHWDEOHV
EHIRUHGXPSLQJWKHLUGDWD7KLVSULYLOHJHLVQRWUHTXLUHGZKHQWKHP\VTOGXPSRSWLRQV
--single-transactionRU--master-dataDUHXVHGEXWLWLVUHFRPPHQGHGWRDVVLJQ
WKLVULJKWMXVWLQFDVHDGXPSZLWKRXWRQHRIWKHVHRSWLRQVKDVWREHGRQH
)LQDOO\WKHSULYLOHJHVRELOADDQGREPLICATION_CLIENTDUHUHTXLUHGIRUWKHP\VTOGXPS
RSWLRQ--master-data7KLVRSWLRQLVXVHGIUHTXHQWO\LI\RXKDYHWRUHFRYHUGDWDEDVHVWKDW
DUHFRQÀJXUHGDVUHSOLFDWLRQFOLHQWVDVVLJQLQJWKHVHSULYLOHJHVDOORZV\RXWRXVHWKLVRSWLRQ
DVZHOO
7KHUH
VPRUH
0\64/$GPLQLVWUDWRULVQRWDOZD\VWKHSURSHUWRROIRUXVHUGHÀQLWLRQIRUH[DPSOHLQDVFULSWHG
HQYLURQPHQW$QDOWHUQDWLYHURXWHWRFRQVWLWXWHDQDFFRXQWIRUEDFNXSWDVNVLVWKHH[HFXWLRQ
RIWKHIROORZLQJ64/FRPPDQG
GRANT SELECT, LOCK TABLES, RELOAD, REPLICATION CLIENT ON *.* TO 
'backup_user'@'localhost' IDENTIFIED BY 'B4ckM3Up!';
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
'HÀQLQJDVSHFLÀFXVHUIRUUHSOLFDWLRQ
,QVRPHFDVHVWKH0\64/UHSOLFDWLRQPHFKDQLVPLVDYHU\KHOSIXOIHDWXUHIRUH[DPSOHWR
KRUL]RQWDOO\VFDOH\RXUUHDGORDGVRUWRSURYLGHUHGXQGDQF\IRULPSURYHGUREXVWQHVV,I\RX
SODQWRXVHWKLVIHDWXUH\RXKDYHWRGHÀQHDXVHURQWKHUHSOLFDWLRQPDVWHUIRUWKLV7KLV
UHFLSHZLOOVKRZKRZWRFUHDWHWKLVXVHU

0\64/8VHU0DQDJHPHQW

*HWWLQJUHDG\
7RVWHSWKURXJKWKHUHFLSH\RXZLOOQHHGDXVHUQDPHDSDVVZRUGDQGWKHKRVWRQZKLFKWKH
UHSOLFDWLRQVODYHZLOOEHORFDWHG:HZLOOXVHUHSOBXVHUDVWKHXVHUQDPHZLWK3ZBB5SODV
WKHFRUUHVSRQGLQJSDVVZRUGDQGZHZLOODVVXPHWKDWWKHUHSOLFDWLRQVODYHZLOOEHORFDWHGRQ
KRVWbluebox
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKH
DGPLQP\VTODFFRXQW

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&OLFNRQWKH$GGQHZXVHUEXWWRQ

(QWHUWKHEDVLFXVHULQIRUPDWLRQXVHUQDPHUHSOBXVHUSDVVZRUG3ZBB5SOFRQWDFW
LQIRUPDWLRQIROORZHGE\DFOLFNRQWKH$SSO\FKDQJHVEXWWRQ

&KDSWHU

 5LJKWFOLFNRQWKHQHZXVHUUHSOBXVHULQWKHXVHUOLVWRQWKHORZHUOHIWDQGFKRRVH
WKHRSWLRQ$GGKRVWIURPZKLFKWKHXVHUFDQFRQQHFW

0\64/8VHU0DQDJHPHQW


,QWKHIROORZLQJIRUPHQWHUWKHKRVWIURPZKLFK\RXDUHJRLQJWRSHUIRUP\RXU
EDFNXSVKHUHbluebox

6HOHFWWKHWDE*OREDO3ULYLOHJHV&KRRVHWKH5(3/B6/$9(SULYLOHJHIURPWKH
$YDLODEOH3ULYLOHJHVOLVWRQWKHULJKWSUHVVWKHEXWWRQDQGVXEVHTXHQWO\FOLFN
RQWKH$SSO\FKDQJHVEXWWRQ

&KDSWHU

 5LJKWFOLFNRQWKHEDFNXSBXVUHQWU\RQWKHXVHUOLVWDQGVHOHFW5HPRYHKRVWIURP
ZKLFKWKHXVHUFDQFRQQHFWIURPWKHFRQWH[WPHQX
 &RQÀUPWKHPHVVDJHER[LQGLFDWLQJ7KHDQ\KRVWHQWU\KDVEHHQGHOHWHGWKHQ
FOLFNWKH$SSO\FKDQJHVEXWWRQ
+RZLWZRUNV
/HW
VLQVSHFWWKHVWHSVRIWKHDERYHUHFLSH,QVWHSVWKURXJKZHGHÀQHGDQHZDFFRXQW
QDPHGUHSOBXVHUZKLFKDWWKLVSRLQWKDVQRSULYLOHJHVDWDOOEXWFRXOGFRQQHFWWRWKH0\64/
VHUYHUIURPDQ\KRVW:LWKVWHSVDQGZHGHÀQHWKHVSHFLÀFKRVWIURPZKLFKWKHXVHU
ZLOOEHDOORZHGWRORJRQLQWKLVFDVHWKLVLVWKHKRVWWKDWUXQVWKHUHSOLFDWLRQVODYH6WHS
DVVLJQVWKHSULYLOHJHQHFHVVDU\IRUWKHUHSOLFDWLRQVODYHWRWKHQHZDFFRXQW
:LWKVWHSVDQGWKHDFFRXQWUHSOBXVHULVFKDQJHGLQVXFKDZD\WKDWLWFDQQRORQJHUEH
XVHGIURPDQ\KRVWDFWXDOO\WKHDFFRXQWUHSOBXVHU#LVUHPRYHGZKLOHDVHFRQGDFFRXQW
UHSOBXVHU#EOXHER[VWD\VLQWDFW$SRVVLEOHDWWDFNHUZRXOGKDYHWRORJLQWRWKHUHSOLFDWLRQ
VODYHKRVWWRPDNHXVHRIWKLVDFFRXQW

0\64/8VHU0DQDJHPHQW

7KHUH
VPRUH
7RFUHDWHWKHUHSOLFDWLRQDFFRXQWZLWKRXWUHVRUWLQJWRD*8,WRRO\RXFDQDOWHUQDWLYHO\XVHWKH
IROORZLQJ64/FRPPDQG
GRANT REPLICATION SLAVE ON *.* TO 'repl_user'@'bluebox' IDENTIFIED BY 
'Pw_4_R3pl';
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
$OORZLQJDFFHVVIURPVSHFLÀFKRVWVRQO\
:KHQFUHDWLQJDXVHUDFFRXQWXVLQJ0\64/$GPLQLVWUDWRUWKHXVHULVE\GHIDXOWHQWLWOHGWRORJ
LQIURPDQ\KRVW,IWKHDFFRXQWZLOOEHXVHGRQVSHFLÀFFOLHQWVRQO\LWLVDGYLVDEOHWRPRGLI\
WKHDFFRXQWLQVXFKDZD\WKDWORJLQLVUHVWULFWHGWRWKHVHFOLHQWV7KLVKHOSVWRUHGXFHWKH
FKDQFHRIVXFFHVVIXODWWDFNVDJDLQVW\RXUGDWDEDVHVHUYHUEHFDXVHDSRVVLEOHLQWUXGHUZLOO
QRWRQO\KDYHWRJHWKROGRIRUJXHVVWKHSURSHUFUHGHQWLDOVEXWDOVRKDVWRVHL]HFRQWURORI
RQHRIWKHUHJLVWHUHGFOLHQWV
7KHIROORZLQJUHFLSHZLOOJXLGH\RXWKURXJKWKHVWHSVRIUHVWULFWLQJDXVHUDFFRXQWWRD
VSHFLÀFKRVW
*HWWLQJUHDG\
)RUWKHIROORZLQJVWHSVZHDVVXPHWKDWDQDFFRXQWZLWKXVHUQDPHH[DPSOHKDVDOUHDG\EHHQ
GHÀQHGDQGWKDWWKLVDFFRXQWLVHQDEOHGIRUORJLQIURPDQ\KRVW:HIXUWKHUPRUHDVVXPH
WKDWWKLVDFFRXQWVKRXOGEHFKDQJHGLQVXFKDZD\WKDWLWFDQRQO\EHXVHGWRORJLQIURPKRVW
client1.mycompany.com
+RZWRGRLW

6WDUW0\64/$GPLQLVWUDWRU&RQQHFWWR\RXUGDWDEDVHVHUYHUXVLQJWKH
DGPLQP\VTODFFRXQW

6HOHFWWKHHQWU\8VHU$GPLQLVWUDWLRQHLWKHUIURPWKHOLVWRQWKHOHIWRUIURPWKH
9LHZPHQX

&KDSWHU

 5LJKWFOLFNRQWKHXVHUDFFRXQW\RXZDQWWRFKDQJHLQWKH8VHUV$FFRXQWVOLVWRQWKH
OHIWDQGFKRRVHWKHRSWLRQ$GGKRVWIURPZKLFKWKHXVHUFDQFRQQHFW

,QWKHIROORZLQJIRUPHQWHUWKHKRVWIURPZKLFKWKHXVHUZLOOEHDEOHWRFRQQHFW
KHUHclient1.mycompany.com

6DYHWKHFKDQJHVE\FOLFNLQJRQWKH$SSO\FKDQJHVEXWWRQ

0\64/8VHU0DQDJHPHQW


6HOHFWWKHWDE*OREDO3ULYLOHJHV/HIWFOLFNRQWKHXVHUHQWU\H[DPSOHRQWKHOLVWRQ
WKHORZHUOHIW1RWHWKHSULYLOHJHVWKDWDUHOLVWHGLQWKH$VVLJQHG3ULYLOHJHVOLVWLQWKH
H[DPSOHVFUHHQZHDVVXPHWKDWJOREDOSULYLOHJHV6(/(&7DQG&5($7(7(0325$5<
7$%/(DUHDVVLJQHGWRWKHXVHU

6ZLWFKEDFNWRWKHQHZKRVWE\FOLFNLQJRQWKHKRVWQDPHclient1.mycompany.
comRQWKHOHIW$VVLJQWKHVDPHSULYLOHJHVQRWHGLQWKHSUHYLRXVVWHSLQWKLVH[
DPSOH6(/(&7DQG&5($7(7(0325$5<7$%/(E\VHOHFWLQJWKHPIURPWKHOLVWRI
DYDLODEOHSULYLOHJHVRQWKHULJKWDQGVHOHFWLQJWKHEXWWRQIROORZHGE\WKH$SSO\
FKDQJHVEXWWRQ

&KDSWHU


&KRRVHWKHWDE6FKHPD3ULYLOHJHVDQGVHOHFWWKHÀUVWVFKHPDIURPWKH
6FKHPDWDOLVW

6HOHFWWKHHQWU\H[DPSOHIURPWKH8VHUV$FFRXQWVOLVWRQWKHORZHUOHIW1RWHWKH
SULYLOHJHVWKDWDUHDVVLJQHGIRUWKHVHOHFWHGVFKHPD
 6ZLWFKWRWKHQHZXVHUE\VHOHFWLQJWKHKRVWQDPHclient1.mycompany.comRQ
WKHOHIW$VVLJQWKHSULYLOHJHVQRWHGLQWKHSUHYLRXVVWHSE\VHOHFWLQJWKHPIURPWKH
OLVWRQWKHULJKWDQGFOLFNLQJWKHEXWWRQWKHQFKRRVH$SSO\FKDQJHV
 6HOHFWWKHQH[WVFKHPDDQGUHSHDWVWHSVDQGIRUHYHU\HQWU\LQWKH
6FKHPDWDOLVW

0\64/8VHU0DQDJHPHQW

5LJKWFOLFNRQWKHH[DPSOHHQWU\RQWKHXVHUOLVWDQGVHOHFW5HPRYHKRVWIURPZKLFK
WKHXVHUFDQFRQQHFWIURPWKHFRQWH[WPHQX
&RQÀUPWKHPHVVDJHER[LQGLFDWLQJ7KHDQ\KRVWHQWU\KDVEHHQGHOHWHGWKHQ
FOLFNWKH$SSO\FKDQJHVEXWWRQ
+RZLWZRUNV
/HW
VKDYHDORRNDWZKDWZHGLGWKURXJKRXWWKLVUHFLSH
,QVWHSVWKURXJKZHDGGHGWKHQHZKRVWWRZKLFKWKHDFFRXQWVKRXOGEHUHVWULFWHGWREH
SUHFLVHZHFUHDWHGDQHZDFFRXQWH[DPSOH#FOLHQWP\FRPSDQ\FRP
6WHSVDQGDUHSHUIRUPHGWRFRS\WKHH[LVWLQJJOREDOSULYLOHJHVZKLOHVWHSVWKURXJK
GRWKHVDPHIRUWKHVFKHPDOHYHOSULYLOHJHV:LWKWKHVHRSHUDWLRQVWKHXVHUZLOOEHJUDQWHG
WKHVDPHSHUPLVVLRQVZKHQORJJLQJLQIURPWKHQHZO\GHÀQHGVSHFLÀFKRVWWKLVUHFLSHGRHV
QRWWDNHLQWRDFFRXQWDQ\VFKHPDREMHFWSULYLOHJHV

&KDSWHU

:LWKLQVWHSVDQGWKHSHUPLVVLRQWRORJLQIURPDQ\KRVWLVZLWKGUDZQE\GHOHWLQJWKH
KRVWIURPWKHDFFRXQWWHFKQLFDOO\VSHDNLQJWKHXVHUH[DPSOH#LVGHOHWHG
:LWKWKHVHVWHSVZHFUHDWHGDFRS\RIWKHH[LVWLQJH[DPSOHDFFRXQWZKLFKLVUHVWULFWHGWRD
VSHFLÀFKRVWDQGGLVDEOHGWKHSRVVLELOLW\WRORJLQIURPDQ\RWKHUPDFKLQH
7KHUH
VPRUH
7KHSUHFHGLQJUHFLSHFDQEHXVHGLQWHUDFWLYHO\RQO\DQGLWGHVFULEHVGHÀQLWLRQRIVLQJOHKRVWV
RQO\1H[WZHZLOOVKRZ\RXKRZWRFUHDWHDXVHUE\XVLQJDVFULSWDQGKRZWRLQWURGXFH
PXOWLSOHKRVWV
&UHDWLQJWKHDFFRXQWZLWKRXWXVLQJ0\64/$GPLQLVWUDWRU
,I\RXZDQWWRUHVWULFWDFFHVVRIDQDFFRXQWWRDFOLHQWPDFKLQHEXW\RXGRQRWZDQWWRXVH
0\64/DGPLQLVWUDWRUIRUWKLVWKHIROORZLQJVWHSVOHDGWRLGHQWLFDOUHVXOWV

&RQQHFWWR\RXUGDWDEDVHVHUYHUDVDQDGPLQLVWUDWLYHXVHUDGPLQP\VTOXVLQJ\RXU
IDYRULWH64/FOLHQWIRUH[DPSOH0\64/4XHU\%URZVHU

)LQGRXWDERXWWKHFXUUHQWSULYLOHJHVE\LVVXLQJWKHIROORZLQJFRPPDQG
mysql> show grants for 'example'@'%';

7KHUHVXOWRIWKHDERYHTXHU\ZLOOEHDOLVWRIRQHRUPRUH64/VWDWHPHQWV0RGLI\
WKHVHVWDWHPHQWVE\UHSODFLQJWKHXVHUQDPH'example'@'%'E\WKHQHZQDPH
'example'@'client1.mycompany.com'

([HFXWHHDFKRIWKHPRGLÀHGVWDWHPHQWVIURPWKHSUHYLRXVVWHS\RXZLOOKDYHWRSXW
DVHPLFRORQDWWKHHQGRIHDFKVWDWHPHQW

7RGHQ\ORJLQIURPDQ\KRVWH[HFXWHWKHIROORZLQJFRPPDQG
mysql> drop user 'example'@'%';
$OORZLQJDFFHVVIURPDJURXSRIKRVWV
7KHDERYHUHFLSHLVVXLWHGIRUDFFRXQWVWKDWDUHUHVWULFWHGWRORJLQIURPDVSHFLÀFFOLHQWPD
FKLQH,QVRPHFDVHVKRZHYHU\RXGRQRWZDQWWRDOORZDFFHVVIURPDQ\KRVWEXWLWLVQRW
SRVVLEOHWRUHVWULFWFRQQHFWLRQVWRDVLQJOHFOLHQWPDFKLQHHLWKHU
$VORQJDVWKHQXPEHURIFOLHQWVLVUHDVRQDEO\ORZLWLVSRVVLEOHWRLQGLYLGXDOO\UHJLVWHUWKH
UHVSHFWLYHPDFKLQHV)RUWKLVWKHPHFKDQLVPRXWOLQHGLQWKHDERYHUHFLSHFDQEHXVHG<RX
ZLOOKDYHWRDGDSWVWHSVDQGE\VHOHFWLQJWKHDSSURSULDWHWHPSODWHXVHUDQG\RXW\SLFDOO\
ZLOOVNLSVWHSVDQG
$VVRRQDVWKHQXPEHURIFOLHQWVH[FHHGVDFHUWDLQOLPLWLWLVQRORQJHUIHDVLEOHWRUHJLVWHU
WKHPVHSDUDWHO\)RUWKHVHFDVHVWKHZLOGFDUGIHDWXUHRI0\64/PLJKWEHDYDOLGDOWHUQDWLYH
IRU\RX

0\64/8VHU0DQDJHPHQW

0\64/DOORZVWKHXVHRIZLOGFDUGRSHUDWRUVZKHQGHÀQLQJKRVWQDPHVRIXVHUDFFRXQWV/HW
V
DVVXPH\RXKDYHDVHWRIFOLHQWPDFKLQHVclient01.mycompany.comWKURXJKclient99.
mycompany.com7KHVHFOLHQWVVKRXOGEHDEOHWRDFFHVVWKHGDWDEDVHEXW\RXGRQRWZDQW
WRDOORZDFFHVVIURPDQ\RWKHUPDFKLQH,QWKLVFDVH\RXZRXOGUHVWULFWWKHDFFHVVRI\RXU
DFFRXQWWRKRVWclient%.mycompany.comQRWHWKH%FKDUDFWHU7KHSHUFHQWVLJQDFWVDV
DZLOGFDUGWKDWFDQEHUHSODFHGE\DQ\FKDUDFWHUVWULQJ:LWKWKLVGHÀQLWLRQORJLQIURPKRVW
client57.mycompany.comZLOOEHVXFFHVVIXOEXWDFRQQHFWLRQDWWHPSWIURPalien1.
mycompany.comZLOOEHUHIXVHG
3OHDVHQRWHWKDWWKHXVHRIZLOGFDUGVGRHVQRWQHFHVVDULO\DOORZIRUWKHH[DFWUHVWULFWLRQV\RX
PLJKWZDQWWRGHÀQH,QWKHDERYHH[DPSOHWKHUHDUHVRPHXQZDQWHGPDFKLQHVWKDWDUHVWLOO
DEOHWRDFFHVVWKHGDWDEDVHDPDFKLQHQDPHGclientfake.mycompany.comZRXOGPDWFK
WKHKRVWGHÀQLWLRQDVZHOO7RPLQLPL]HWKHZURQJPDWFKHV\RXFRXOGXVHWKHKRVWGHÀQLWLRQ
client__.mycompany.comLQVWHDGZLWK_EHLQJDSODFHKROGHUIRUH[DFWO\RQHDUELWUDU\
FKDUDFWHUEXWDPDFKLQHclientXY.mycompany.comZRXOGVWLOOEHDEOHWRHVWDEOLVK
DFRQQHFWLRQ
7KHKRVWGHÀQLWLRQIRU0\64/XVHUDFFRXQWVFDQDOVREHXVHGWRSURYLGH,3DGGUHVVHVLQVWHDG
RIPDFKLQHQDPHV,I\RXDUHDEOHWRDVVLJQVLPLODU,3DGGUHVVHVWRDOOPDFKLQHVWKDWVKRXOG
EHDEOHWRDFFHVV\RXUKRVW\RXFDQSURYLGHDKRVWQDPHOLNH192.168.1.%7KLVH[DPSOH
YDOXHZRXOGHQDEOHDFFHVVIRUDOOFOLHQWVZLWKDQ,3DGGUHVVIURPWKURXJK

7KHXVHRIWKHVLQJOHFKDUDFWHUZLOGFDUGLVSRVVLEOHZLWK,3DGGUHVVHVDVZHOO$KRVWYDOXH
RI192.168.1.1__ZLOODOORZORJLQIURPFOLHQWVZLWK,3DGGUHVVHVWKURXJK

$QDOWHUQDWLYHWRZLOGFDUGVLVWRJURXSSRVVLEOHFOLHQWVLQDFRPPRQVXEQHW<RXFDQWKHQ
PDNHXVHRIDQRWDWLRQWKDWDOORZVGHÀQLQJ,3UDQJHVXVLQJWKHEDVHDGGUHVVRIWKHUDQJH
FRPELQHGZLWKWKHFRUUHVSRQGLQJQHWPDVN,I\RXVHWWKHKRVWRID0\64/DFFRXQWWR
<subnet prefix>/<subnet mask>FRQQHFWLRQVIURPDQ\,3DGGUHVVZLWKLQWKLVVXEQHW
ZLOOEHDFFHSWHGE\0\64/
,IIRUH[DPSOH\RXZDQWWRDOORZORJLQIURPIRXUFOLHQWPDFKLQHVZKRVH,3DGGUHVVHVUDQJH
IURPWR\RXFRXOGVHWXSDQDFFRXQWZLWKWKHKRVWVHWWR192.
168.1.100/255.255.255.252ZKLFKZLOOHQDEOHORJLQIRUMXVWWKHUDQJH\RXLQWHQGHGWR
7KLVEHKDYLRULVVRPHZKDWFRQWUDGLFWRU\WRWKH0\64/PDQXDOZKLFKVWDWHV
7KHQHWPDVNFDQRQO\EHXVHGWRWHOOWKHVHUYHUWRXVHRUELWVRIWKH
DGGUHVV6HHhttp://dev.mysql.com/doc/refman/5.1/en/account-
names.html

&KDSWHU

,IWKLVVWDWHPHQWZHUHWUXHWKHRQO\SRVVLEOHVXEQHWPDVNVZRXOGEH
DQGLQWKHODWWHUFDVHWKHVXEQHWPDVNZRXOGEHVNLSSHG
IRUWKHVDNHRIEUHYLW\+RZHYHUH[SHULHQFHVKRZVWKDWRWKHUVXEQHWPDVNVZRUNMXVWDV
ZHOOEXW\RXKDYHWRPDNHVXUHWKDWWKH,3DGGUHVVJLYHQEHIRUHWKHVXEQHWPDVNLVWKHSXUH
VXEQHWSUHÀ[$Q\DGGUHVVIURPZLWKLQWKHVXEQHWZRXOGQRWZRUNDVDOOFRQQHFWLRQVZRXOG
EHUHIXVHG
7RFODULI\WKDWZHZLOOLQVSHFWWKHH[DPSOHIURPWKH0\64/PDQXDOZKLFKWULHVWR
SURYHWKDWGLIIHUHQWQHWPDVNVGRQRWZRUN7KHPDQXDOVWDWHVWKDWDKRVWYDOXH
192.168.0.1/255.255.255.240ELWVZLOOQRWZRUNZKLFKLVEDVLFDOO\FRUUHFW%XW
WKHUHDVRQIRUWKDWLVQRWWKDWKDQGOLQJRIDELWQHWPDVNLVJHQHUDOO\
XQVXSSRUWHGEXWWKDWWKH,3DGGUHVVLVDQDGGUHVVIURPWKHVXEQHWDQGQRW
WKHVXEQHWSUHÀ[LWVHOI7KHFRUUHFWVXEQHWSUHÀ[ZRXOGEHDQGZLWKDKRVWRI
192.168.0.0/255.255.255.240HYHU\FOLHQWIURPWKHVXEQHW³ZLWKDQ,3DGGUHVVIURP
WR³ZRXOGEHDFFHSWHGIRUFRQQHFWLRQV
*HQHUDOO\LI\RXGHÀQHWKHKRVWZLWKWKH<subnet prefix>/<subnet mask>QRWDWLRQ
DQ\FOLHQWDGGUHVVLVWHVWHGDJDLQVWWKLVYDOXHDFFRUGLQJWRWKHIROORZLQJUXOHWKHRSHUDWRU	
VWDQGVIRUWKHELWZLVH$1'RSHUDWLRQ
,IWKHIROORZLQJHTXDWLRQLVWUXHWKHFOLHQWDGGUHVVLVDFFHSWHG<client address> & 
<subnet mask> = <subnet prefix>
6HHDOVR
f
'HÀQLQJDQDOWHUQDWLYHXVHUIRUDGPLQLVWUDWLYHWDVNV
f
&RQÀJXULQJ0\64/$GPLQLVWUDWRUWRGLVSOD\JOREDOSULYLOHJHVDQGKRVWV
f
$YRLGLQJSODLQWH[WSDVVZRUGVLQDGPLQLVWUDWLYHVFULSWV
5HJDLQLQJDFFHVVWR\RXUGDWDEDVHLQFDVH
RIORVWDFFRXQWLQIRUPDWLRQ
2IFRXUVH\RXZDQWWRSURWHFW\RXUGDWDEDVHDJDLQVWDWWDFNVLQHYHU\SRVVLEOHZD\+RZHYHU
IURPWLPHWRWLPH\RXPLJKWÀQG\RXUVHOILQDVLWXDWLRQLQZKLFK\RXKDYHWRDFWDVDQDWWDFNHU
\RXUVHOI³IRUH[DPSOHLI\RXIRUJRWWKHXVHUFUHGHQWLDOVIRUWKHDGPLQLVWUDWLRQXVHURULI
\RXDFFLGHQWDOO\GHOHWHGWKHURRWXVHUDFFRXQWZLWKRXWKDYLQJFUHDWHGDQHTXLYDOHQWXVHU
EHIRUHKDQG%XWGRQRWZRUU\:HZLOOVKRZ\RXDZD\WRUHJDLQFRQWURORI\RXUGDWDEDVH
ZLWKRXWORVLQJDQ\GDWDQRWHYHQ\RXUH[LVWLQJXVHUDFFRXQWV

0\64/8VHU0DQDJHPHQW

*HWWLQJUHDG\
7KLVUHFLSHLQYROYHVVWHSVWRHGLWWKH0\64/FRQÀJXUDWLRQÀOHVDQGWRUHVWDUW\RXU0\64/
VHUYHU7KHUHIRUH\RXZLOOQHHGDFFHVVWRWKHKRVW\RXUGDWDEDVHUXQVRQ<RXDOVRQHHGWKH
ULJKWVWRVWDUWDQGVWRSWKH0\64/LQVWDQFHDW\RXURZQGLVFUHWLRQ)XUWKHUPRUH\RXVKRXOG
NQRZWKHORFDWLRQRIWKH0\64/FRQÀJXUDWLRQÀOHW\SLFDOO\my.iniDQG\RXVKRXOGKDYHWKH
ULJKWVWRFKDQJHWKLVÀOH
7KLVUHFLSHDOORZV\RXWRERWKFUHDWHDQHZXVHUDQGWRFKDQJHWKHSDVVZRUGRIDXVHUWKDW
DOUHDG\H[LVWV,QRXUH[DPSOHZHZLOOFKDQJHWKHSDVVZRUGRIWKHXVHUDGPLQP\VTOWR
$V\VS0DQGZHZLOOFUHDWHDQHZXVHUURRWZLWKUWBSZDVWKHSDVVZRUG
%HIRUHH[HFXWLQJWKHIROORZLQJLQVWUXFWLRQV\RXVKRXOGPDNHVXUHWKDWQR
XVHUVRUSURFHVVHVFDQDFFHVV\RXUGDWDEDVHVHUYHU
+RZWRGRLW

2SHQDWH[WHGLWRUDQGFUHDWHDÀOHZLWKWKHIROORZLQJFRQWHQW
SET PASSWORD FOR 'admin4mysql'@'localhost' = 
    PASSWORD('As,ysp4M');
GRANT ALL PRIVILEGES ON *.* TO 'root'@'localhost' IDENTIFIED  
    BY 'r00t_pw' WITH GRANT OPTION;
0DNHVXUHWKDWWKHSETFRPPDQGDQGWKHGRANTFRPPDQG
DUHHDFKZULWWHQRQDVLQJOHOLQH

6DYHWKHÀOHLQDORFDWLRQRI\RXUFKRLFHIRUH[DPSOHC:\temp\mysql-init.sql

2SHQWKH0\64/FRQÀJXUDWLRQÀOHIRUH[DPSOHC:\Program Files\MySQL\
MySQL Server 5.1\my.iniLQDWH[WHGLWRU)LQGWKHOLQHWKDWUHDGV[mysqld]
DQGDGGWKHIROORZLQJOLQHEHORZLIDOLQHVWDUWLQJZLWKinit-file=DOUHDG\H[LVWV
FKDQJHLWDFFRUGLQJO\
init-file="C:/temp/mysql-init.sql"

8VHWKHORFDWLRQRIWKHÀOH\RXVDYHGLQVWHS3OHDVHQRWHWKHXVHRIVLPSOHIRUZDUG
VODVKHVLQVWHDGRIEDFNVODVKHV

6DYHWKH0\64/FRQÀJXUDWLRQÀOH

5HVWDUW\RXUUXQQLQJ0\64/LQVWDQFHIRUH[DPSOHE\UHVWDUWLQJWKH:LQGRZVVHUYLFH
net stop MySQL & net start MySQL)

2SHQWKH0\64/FRQÀJXUDWLRQÀOHLQDWH[WHGLWRUDJDLQWRUHYHUWWKHFKDQJHVPDGH
LQVWHS5HPRYHWKHinit-fileOLQHIURP\RXUFRQÀJXUDWLRQÀOHRUGLVDEOHLWE\
SXWWLQJDKDVK#FKDUDFWHULQIURQWDQGVDYHLW

&KDSWHU

+RZLWZRUNV
7KHÀOHFUHDWHGLQVWHSVDQGFRQWDLQVWKH64/FRPPDQGVE\ZKLFKWKHSDVVZRUGRIWKH
XVHUDGPLQP\VTOLVUHVHWDQGDXVHUURRWLVFUHDWHG,QWKHFDVHRIORVWDFFRXQWLQIRUPDWLRQ
IRUWKHDGPLQLVWUDWLYHXVHUWKHVHFRPPDQGVFDQ
WEHH[HFXWHGDVXVXDOIRUH[DPSOHYLDD
0\64/FOLHQW:HFKDQJHWKH0\64/FRQÀJXUDWLRQLQVWHSVDQGLQRUGHUWRKDYHWKHVH
FRPPDQGVH[HFXWHGRQWKHQH[W0\64/VWDUWGHVSLWHWKHORVWFUHGHQWLDOV6WHSLQLWLDWHVD
UHVWDUWRIWKH0\64/VHUYHUZKLFKFDXVHVWKHFRPPDQGVWREHH[HFXWHG6WHSUHYHUWVWKH
FRQÀJXUDWLRQFKDQJHVRIVWHSVDQGVRWKHFRPPDQGÀOHZRQ
WEHUHSHDWHGO\H[HFXWHGRQ
HYHU\VXEVHTXHQW0\64/VWDUW
7KHFRQWHQWRIWKHLQLWLDOL]DWLRQÀOHDVOLVWHGLQVWHSKDVWREHDGDSWHGDFFRUGLQJWR\RXU
VSHFLÀFQHHGV$V\RXPLJKWKDYHJXHVVHGDOUHDG\WKLVPHFKDQLVPLVDOVRVXLWDEOHWRFKDQJH
\RXUDFWXDOGDWDEDVHFRQWHQWQRWRQO\XVHULQIRUPDWLRQ,WDOORZVIRUEDVLFDOO\HYHU\FKDQJH
LPDJLQDEOHWR\RXUGDWDEDVHVR\RXVKRXOGPDNHVXUHWKDWDFFHVVWRWKH0\64/FRQÀJXUDWLRQ
ÀOHLVUHVWULFWHGWRDXWKRUL]HGSHUVRQV7KHinit-fileRSWLRQPLJKWEHXVHGRWKHUZLVHWR
WDPSHUZLWK\RXUGDWDFUHDWHXVHUDFFRXQWVIRUIXWXUHXQDXWKRUL]HGDFFHVVRUUHQGHU\RXU
V\VWHPLQRSHUDEOH
7KHUH
VPRUH
$GLIIHUHQWDOWHUQDWLYHWRUHVHWSDVVZRUGVLVWRVWDUW\RXU0\64/GDWDEDVHVHUYHUXVLQJWKH
RSWLRQ--skip-grant-tables:LWKWKLVVHWWLQJDQ\ORJLQZLOOEHVXFFHVVIXODQGIXOOULJKWV
ZLOOEHJUDQWHG³UHJDUGOHVVRIWKHXVHUFUHGHQWLDOVVSHFLÀHG,QIDFWWKLVRSWLRQLVRIWHQ
UHIHUHQFHGDVWKHSUHIHUUHGZD\WRFKDQJH\RXUXVHUDFFRXQWVZLWKRXWWKHQHHGIRUSURSHU
FUHGHQWLDOV1HYHUWKHOHVVZHVWURQJO\UHFRPPHQGQRWXVLQJWKLVDSSURDFKDVWKHUHDUHVRPH
OLPLWDWLRQVDQGGUDZEDFNV
:KLOHWKH--skip-grant-tablesDSSURDFKHQDEOHV\RXWRUHVHWDIRUJRWWHQSDVVZRUGLW
GRHVQRWDOORZFUHDWLQJDQHZXVHUDFFRXQWULJKWDZD\DVDQ\DWWHPSWWRJUDQWULJKWVXVLQJ
WKHGRANTVWDWHPHQWZLOODWÀUVWEHUHIXVHGZLWKUHIHUHQFHWRWKHGLVDEOHGJUDQWWDEOHV

0\64/8VHU0DQDJHPHQW

<RXKDYHWRLVVXHDFLUSH PRIVILEGESVWDWHPHQWÀUVWLQRUGHUWRKDYH0\64/DFFHSW
DGRANTFRPPDQG:KLOHWKLVLVDZD\WRFUHDWHDQHZXVHUDFFRXQWZLWKIXOOULJKWVLWLV
DELWFXPEHUVRPH
0RUHLPSRUWDQWO\XVHRIWKH--skip-grant-tablesLVDPDMRUVHFXULW\LVVXHEHFDXVHDV
ORQJDVWKHGDWDEDVHUXQVZLWKWKLVRSWLRQHQDEOHGDQ\ERG\FDQFRQQHFWWRWKHGDWDEDVH
ZLWKRXWKDYLQJWRSURYLGHDQ\FUHGHQWLDOVDWDOOZKLFKHQDEOHVIUHHDFFHVVIRUDOOSRVVLEOH
LQWUXGHUV:KLOHWKLVPLJKWQRWEHFULWLFDOIRU\RXUSHUVRQDOGHYHORSPHQWGDWDEDVHLWLV
DEVROXWHO\LQWROHUDEOHIRUSURGXFWLRQXVHRURWKHUGDWDEDVHVZLWKVHQVLWLYHGDWD7RSUHYHQW
XQDXWKRUL]HGDFFHVVZKLOHWKHJUDQWWDEOHVDUHGLVDEOHGLWLVVWURQJO\UHFRPPHQGHGWR
DFFRPSDQ\WKLVFRQÀJXUDWLRQZLWKWKHRSWLRQ–-skip-networkingRQ:LQGRZV
PDFKLQHV\RXKDYHWRDGGLWLRQDOO\SURYLGHRQHRI--shared-memoryRU--named-pipe
RSWLRQV8QIRUWXQDWHO\WKLVDFWXDOO\GHDFWLYDWHVDFFHVVIRUPRVWUHJXODUFOLHQWVDVZHOO
ZKLFKLVHTXLYDOHQWWRDVHUYLFHLQWHUUXSWLRQXQWLOWKHGDWDEDVHLVUHODXQFKHGLQWKH
UHJXODUFRQÀJXUDWLRQ
,QFRQFOXVLRQWKH--skip-grant-tablesRSWLRQPDNHVLWQHFHVVDU\WRUHVWDUWWKH
GDWDEDVHWZLFHDVRSSRVHGWRRQFHZLWKWKH--init-fileYDULDQWDQGWKHUHZLOOEHD
VHUYLFHLQWHUUXSWLRQEHWZHHQWKHWZRUHVWDUWVGXHWRWKHQHWZRUNFXWRIIWKDWLVQHFHVVDU\
IRUVHFXULW\UHDVRQVZKLOHWKH--init-fileDSSURDFKDOORZVIRUFRQWLQXHGDFFHVVH[FHSW
IRUWKHPRPHQWRIWKHÀUVWUHVWDUW7KLVLVZK\ZHVWURQJO\UHFRPPHQGXVLQJWKHPHWKRG
GHVFULEHGLQWKLVUHFLSH
$YRLGLQJSODLQWH[WSDVVZRUGVLQ
DGPLQLVWUDWLYHVFULSWV
,QPDQ\RIWKHSUHYLRXVUHFLSHVZHDOVRVKRZHGKRZWRGHÀQHXVHUSHUPLVVLRQVXVLQJ64/
FRPPDQGV$VVXFKVWDWHPHQWVFDQHDVLO\EHH[HFXWHGLQVFULSWVWKHVHDUHZHOOVXLWHGWR
SURGXFHVFULSWVIRUDXWRPDWHGGHÀQLWLRQRI0\64/DFFRXQWV:KLOHLWLVJHQHUDOO\DJRRGLGHD
WRUHGXFHWKHPDQXDOWDVNVLQGDWDEDVHDGPLQLVWUDWLRQRQHVKRXOGNHHSLQPLQGWKDWVXFK
VFULSWVFRQWDLQLQIRUPDWLRQWKDWLVH[WUHPHO\XVHIXOIRUSRVVLEOHDWWDFNHUV2QHFDQH[WUDFWWKH
GHÀQHGXVHUVWKHLUVSHFLÀFULJKWVWKHKRVWVIURPZKLFKDFFHVVLVJUDQWHGDQGW\SLFDOO\HYHQ
WKHFRUUHVSRQGLQJSDVVZRUGV,QWKLVZD\VXFKXVHUGHÀQLWLRQVFULSWVRIWHQFRQWDLQDOOWKH
LQIRUPDWLRQQHFHVVDU\WRDFFHVV\RXUGDWDEDVHZKLFKPDNHVWKHPH[WUHPHO\VHQVLWLYH7KH
ULVNWKDWVRPHERG\FRLQFLGHQWDOO\WULSVRYHUVXFKDVFULSWVKRXOGQRWEHXQGHUHVWLPDWHG³DQG
DQRSHQGRRUPD\WHPSWDVDLQW
7KHPRVWFULWLFDOSRUWLRQRIVXFKVFULSWVLVRIFRXUVHWKHSDVVZRUGV,QWKLVUHFLSHZHZLOO
VKRZKRZWRFUHDWHXVHUGHÀQLWLRQVWDWHPHQWVZLWKRXWWKHQHHGWRJLYHDSODLQWH[WSDVVZRUG

&KDSWHU

*HWWLQJUHDG\
7RVWHSWKURXJKWKLVUHFLSH\RXZLOOQHHGDUXQQLQJ0\64/GDWDEDVHVHUYHUDQGD64/FOLHQW
ZHDUHJRLQJWRXVHWKH0\64/FRPPDQGOLQHFOLHQW<RXVKRXOGDOVRKDYHDZRUNLQJ64/
VFULSWWKDWGHÀQHVWKHDFFRXQWVXVLQJSODLQWH[WSDVVZRUGV1RRWKHUSUHUHTXLVLWHV
DUHUHTXLUHG
+RZWRGRLW

&RQQHFWWR\RXUGDWDEDVHVHUYHUZLWKWKH0\64/FRPPDQGOLQHFOLHQW

)RUDSODLQWH[WSDVVZRUGLQ\RXUVFULSWJLYHWKHIROORZLQJFRPPDQGDQGPDNHDQRWH
RIWKHHQFRGHGUHVXOW
SELECT PASSWORD('<Your plain text password>');

5HSODFHWKHIDENTIFIED BY '<Your plain text password>'SRUWLRQRIWKH
VFULSWE\IDENTIFIED BY PASSWORD '<Encoded result>'

5HSHDWVWHSVDQGIRUDOOSDVVZRUGVLQ\RXUVFULSW
+RZLWZRUNV
0\64/QHHGVWRVWRUHLWVSDVVZRUGVWREHDEOHWRYHULI\XVHUFUHGHQWLDOV7KLVLQIRUPDWLRQLV
QRWVWRUHGLQSODLQWH[WEXWDVDVRFDOOHGKDVKYDOXH$KDVKYDOXHLVDYDOXHWKDWUHSUHVHQWV
DSDVVZRUGEXWZKLFKLVQRWUHYHUVLEOHVRLWLVEDVLFDOO\LPSRVVLEOHWRÀQGWKHDFWXDO
SDVVZRUGIRUDJLYHQKDVKYDOXH
7RFKHFNZKHWKHUDJLYHQSDVVZRUGLVFRUUHFW0\64/FDOFXODWHVWKHKDVKYDOXHIRULWDQG
FRPSDUHVLWZLWKWKHVWRUHGYDOXH,IWKHVHYDOXHVDUHLGHQWLFDOWKHSDVVZRUGLVYHULÀHG
:KHQFUHDWLQJDXVHUDFFRXQWXVLQJWKHIDENTIFIED BY '<Your plain text 
password>'V\QWD[0\64/FDOFXODWHVWKHKDVKFRGHDQGVWRUHVWKHUHVXOWLQJYDOXHLQLWV
XVHUGDWD7KHIDENTIFIED BY PASSWORD '<hash value>'V\QWD[VWRUHVWKHKDVKYDOXH
LPPHGLDWHO\,QERWKFDVHVWKHHIIHFWVRIWKHVFULSWDUHLGHQWLFDOEXWZLWKWKHVHFRQGYDULDQW
QRSODLQWH[WSDVVZRUGLVDFFLGHQWDOO\H[SRVHG
([DPSOHRIFUHDWLQJDXVHULQDVFULSWZLWKRXWDSODLQWH[W
SDVVZRUG
/HWXVDVVXPHWKHIROORZLQJVFULSW
GRANT ALL PRIVILEGES ON *.* TO 'admin4mysql'@'localhost' IDENTIFIED BY 
'As,ysp4M' WITH GRANT OPTION;

0\64/8VHU0DQDJHPHQW

([HFXWHWKHIROORZLQJFRPPDQGRQWKH0\64/FRPPDQGOLQH
mysql> SELECT PASSWORD('As,ysp4M');
5HSODFHWKHSDVVZRUGLQWKHVFULSW
GRANT ALL PRIVILEGES ON *.* TO 'admin4mysql'@'localhost' IDENTIFIED  
BY password '))''')&&'%$&$)'()' WITH 
GRANT OPTION;
7KHUH
VPRUH
7KHSET PASSWORDFRPPDQGLVDQRWKHUFRPPRQSODFHIRUXVHRISODLQWH[WSDVVZRUG
7RSUHYHQWXVHRISODLQWH[WSDVVZRUGVDOWRJHWKHU\RXVKRXOGUHSODFHDOOSET PASSWORD 
[…] = PASSWORD('<plain text password>')H[SUHVVLRQVLQ\RXUVFULSWVE\WKH
FRUUHVSRQGLQJYDULDQWXVLQJKDVKYDOXHVGLUHFWO\ZLWKRXWXVLQJWKHPASSWORD()IXQFWLRQ
SET PASSWORD […] = 'Encoded password'


0DQDJLQJ6FKHPDV
,QWKLVFKDSWHUZHZLOOFRYHU
f
$GGLQJQHZFROXPQVDWVSHFLÀFSRVLWLRQV
f
'HÀQLQJD3ULPDU\NH\IRUDWDEOHFRQWDLQLQJQRQXQLTXHGDWD
f
$OORZLQJLQGLYLGXDOINSERTVWDWHPHQWVZLWKYDOXHVLQDXWRLQFUHPHQWLQJFROXPQV
f
*OREDOO\DOORZLQJINSERTVWDWHPHQWVZLWKYDOXHVLQDXWRLQFUHPHQWLQJFROXPQV
f
&KRRVLQJDVXLWDEOHVWRUDJHHQJLQH
f
,PSURYLQJWKHSHUIRUPDQFHRIALTER TABLEIRU,QQR'%
f
8VLQJDVWRUHGSURFHGXUHWRFRQGLWLRQDOO\DGGFROXPQVRULQGH[HV
f
,PSURYLQJTXHU\SHUIRUPDQFHIRU,QQR'%WDEOHVZLWKBLOBFROXPQV
f
,GHQWLI\LQJGLIIHUHQFHVEHWZHHQWZRVFKHPDV
f
&RPSDULQJVFKHPDUHYLVLRQVXVLQJKDVKYDOXHV
,QWURGXFWLRQ
:KHQ\RXÀUVWLQVWDOODGDWDEDVHVHUYHU\RXREYLRXVO\GRVREHFDXVH\RXZDQWWRVWRUHDQG
ODWHUDFFHVVLQIRUPDWLRQUHOLDEO\DQGTXLFNO\$PDMRUFRQFHUQLQWKLVUHJDUG³DSDUWIURPWKH
VHUYHU
VKDUGZDUHDQGRSHUDWLQJV\VWHP³LVWKHORJLFDOOD\RXWRIWKHGDWDEDVH7KLVUHIHUVWR
KRZ\RXGHFLGHRQWKHVWUXFWXUHRIWKHWDEOHVZKLFKZLOOLQWKHHQGEHZKDWDQ\GDWDEDVHGULYHQ
DSSOLFDWLRQZLOOXVHDVLWVSULPDU\OHYHORIDEVWUDFWLRQ
7KLVFKDSWHULVQRWDERXWGDWDW\SHVWDEOHQDPLQJRURWKHUWRSLFVUHYROYLQJDURXQGWKRVHNLQGV
RIGHFLVLRQVWKDWDUHRIWHQEHVWPDGHLQFRRSHUDWLRQZLWKDSSOLFDWLRQGHYHORSHUV2IWHQWKH\
ZLOOKDYHWKHLURZQLGHDVDERXWKRZWRVHWXSWKHGDWDEDVHVFKHPDWKDW\RXVKRXOGWDNHLQWR
DFFRXQWDVDGDWDEDVHDGPLQLVWUDWRUERWKWKHLUDQG\RXUOLYHVZLOOEHHDVLHULQWKHGD\VWRFRPH
ZKHQ\RXERWKDJUHHRQQDPLQJFRQYHQWLRQVIRUWDEOHVFROXPQVDQGLQGH[HVDQGVRRQ

0DQDJLQJ6FKHPDV

,QVWHDGLQWKLVFKDSWHU\RXZLOOÀQGDGYLFHRQWKHVSHFLDOWLHVDQGGLIIHUHQFHVWKDWPDNH
0\64/GLIIHUHQWIURPRWKHU5HODWLRQDO'DWDEDVH0DQDJHPHQW6\VWHPV5'%06OLNH
2UDFOH0LFURVRIW64/6HUYHURU,%0
V'%0RUHRYHUZHZLOOKDYHDORRNDWVRPHFRPPRQ
WDVNVWKDWZLOOFRPHXSWLPHDQGDJDLQHLWKHUEHIRUH\RXVHWXSWKHWDEOHVRUDIWHUZDUGV
ZKHQ\RXUGDWDEDVHLVDOUHDG\XSDQGVHUYLQJUHTXHVWVIURPDSSOLFDWLRQV
0\64/LVGLIIHUHQWIURPPRVWRWKHU5'%06LQWKDWLWGRHVDOORZ\RXWRFKRRVHIURPD
YDULHW\RIVWRUDJHHQJLQHV$VWRUDJHHQJLQHLVDSDUWRIWKHGDWDEDVHV\VWHPWKDWKDQGOHV
SK\VLFDOO\VWRULQJ\RXUGDWDRQDGLVNLQFRQWUDVWWRIRUH[DPSOHFKHFNLQJWKHV\QWD[RID64/
VWDWHPHQWRUH[HFXWLQJDIXQFWLRQOLNHDATE():LWK0\64/\RXJHWDFKRLFHDVWRZKLFKRI
WKRVHLPSOHPHQWDWLRQVHDFKZLWKLWVLQGLYLGXDOVWUHQJWKVDQGZHDNQHVVHVLVWREHXVHGRQD
SHUWDEOHEDVLV7KHIROORZLQJSLFWXUHVKRZVWKHJHQHUDODUFKLWHFWXUHRIWKH0\64/VHUYHUOD\HU
DERYHWKHLQGLYLGXDOVWRUDJHHQJLQHLPSOHPHQWDWLRQV

&KDSWHU

8VLQJWKLVDSSURDFKRQHFDQFKRRVHWKHRSWLPXPVWRUDJHVWUDWHJ\IRUHDFKWDEOHLQGLYLGXDOO\
7KHUHDUHWKLUGSDUWLHVWRRWKDWSURGXFHRSHQDQGFORVHGVRXUFHVWRUDJHHQJLQHVWKDWPD\
VSHFLDOL]HLQQLFKHVOLNH3%;7IRUPHGLDVWRUDJH2WKHUGDWDEDVHVRIIHUDOOWKHIHDWXUHVLQWKHLU
GHIDXOWDQGXVXDOO\RQO\VWRUDJHIRUPDWIURPWUDQVDFWLRQVXSSRUWWRKLJKSHUIRUPDQFHRYHU
IXOOWH[WLQGH[LQJDQGÀQHJUDLQHGORFNLQJWRVSHFLDOGDWDW\SHV
0\64/PDNHVWKHDGPLQLVWUDWRUFKRRVHIURPDUDQJHRIRSWLRQVQRQHRIZKLFKVXSSRUWVDOORI
WKHIHDWXUHVMXVWQDPHGWRJHWKHU6RLQWKHHQGKDYLQJWKHRSWLRQWRSLFNIURPWKHDYDLODEOH
VWRUDJHHQJLQHVLVVRPHWLPHVPRUHRIDEXUGHQWKDQDQRSSRUWXQLW\
7KH0\64/RQOLQHPDQXDOFRQWDLQVDWDEOHFRQWUDVWLQJWKHDYDLODEOHVWRUDJHHQJLQHVDQGWKHLU
UHVSHFWLYHIHDWXUHVHWVLQLWV&KDSWHUDWhttp://dev.mysql.com/doc/refman/5.1/
en/storage-engines.html
:HZLOOQRWJRLQWRWKHGHWDLOVRIHDFKDQGHYHU\HQJLQHDYDLODEOHEHFDXVHIURPDEXVLQHVV
SHUVSHFWLYH³DQGWKLVLVZKDWFRXQWVLQRXURSLQLRQ³UHDOLVWLFDOO\RQO\WZRRIWKHPDUHZRUWK\
RIDGHWDLOHGGLVFXVVLRQ0\,6$0DQG,QQR'%
$SDUWIURPWKDW\RXPLJKWÀQGWKH%ODFNKROHHQJLQHXVHIXOIRUVSHFLDOUHSOLFDWLRQVFHQDULRV
DQG\RXVKRXOGDOVRWDNHDORRNDWWKH)HGHUDWHGDQG0HUJHHQJLQHVERWKRIZKLFKHYHQ
WKRXJKZLWKOLPLWVDOORZPXOWLSOHWDEOHVWREHWUHDWHGDVRQHORFDOO\DQGRYHUWKHQHWZRUN
$GGLQJQHZFROXPQVDWVSHFLÀFSRVLWLRQV
2QHRIWKHUHJXODUWDVNVDGDWDEDVHDGPLQLVWUDWRUKDVWRSHUIRUPLVWRPRGLI\WKHVWUXFWXUH
RIH[LVWLQJWDEOHVHVSHFLDOO\DGGLQJQHZFROXPQVWRDFFRPPRGDWHWKHQHHGWRVWRUHPRUH
DWWULEXWHVIRUWKHUHFRUGVVWRUHGLQDWDEOH
:KLOHLQJHQHUDOWKHRUGHURIFROXPQVLVQRWUHOHYDQWIRU0\64/LWVHOI³RUDQ\ZHOOEHKDYHG
DSSOLFDWLRQDFFHVVLQJFROXPQVE\QDPHUDWKHUWKDQWKHLUSRVLWLRQLQWKHWDEOH³LWLVRIWHQ
GHVLUDEOHWRKDYHFRQWURORYHUWKHRUGHUWKHFROXPQVDSSHDULQDWDEOH
7KHUHDUHVHYHUDOUHDVRQVWRSUHFLVHO\FRQWUROWKHFROXPQRUGHUIURPDJHQHUDOGULYHWRNHHS
\RXUVFKHPDWLG\RYHUWKHJHQHUDOEHQHÀWRIDWDEOHGLVSOD\LQJLWVFROXPQVLQDVHQVLEOHRUGHU
ZKHQGRLQJDSELECT *WRRWKHUH[WHUQDOFRQVWUDLQWVWKDW\RXFDQQRWLQÁXHQFH
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRPRGLI\DQH[LVWLQJWDEOHDQGDGGRQHRUPRUHQHZ
FROXPQVDWVSHFLÀFSRVLWLRQV

0DQDJLQJ6FKHPDV

*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGDFFHVVWR0\64/VHUYHUZLWKDXVHUDFFRXQWWKDWKDVVXIÀFLHQW
SULYLOHJHVWRDOWHUWDEOHGHÀQLWLRQV)RUH[DPSOHZHZLOOÀUVWFUHDWHDWDEOHZLWKDIHZDWWULEXWHV
DQGWKHQDGGDIHZPRUHFROXPQVDWSUHGHÀQHGSRVLWLRQV:HDVVXPHWKHtestGDWDEDVHWR
EHDYDLODEOHDQG\RXUXVHUDFFRXQWWRKDYHWKHULJKWWRFUHDWHDQGPRGLI\WDEOHVLQLW
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHXVLQJWKHFRPPDQGOLQHmysqlFOLHQW

0DNHWKHtestGDWDEDVHWKHGHIDXOW
mysql> USE test;

&UHDWHWKHLQLWLDOVDPSOHWDEOH
mysql> CREATE TABLE person (
          firstname VARCHAR(30),
          lastname VARCHAR(30),
          birthday DATE,
          person_id INT UNSIGNED NOT NULL AUTO_INCREMENT,
          PRIMARY KEY (person_id)
       );

,QVHUWVRPHUHFRUGV
mysql> INSERT INTO person (firstname, lastname, birthday)
          VALUES ('Martin','van Buren','1782-12-05'),
                 ('Thomas','Wilson','1856-12-28'),
                 ('William','Clinton','1946-08-19');

6HOHFWWKHIXOOFRQWHQWVRIWKHWDEOH
mysql> SELECT * FROM person;

&KDSWHU


$GGDsalutationFROXPQDQGDmiddle_initialFROXPQ7KHIRUPHULVWREH
FUHDWHGEHIRUHfirstnameWKHODWWHUEHWZHHQfirstnameDQGlastname
mysql> ALTER TABLE person
        ADD COLUMN salutation VARCHAR(10) FIRST,
        ADD COLUMN middle_initial CHAR(1) AFTER firstname;
Update some data: 
mysql> UPDATE person SET salutation='Mr.'; 
mysql> UPDATE middle_initial='W' WHERE person_id=2; 
mysql> UPDATE middle_initial='J' WHERE person_id=3;

6HOHFWWKHIXOOWDEOHFRQWHQWVDJDLQ
mysql> SELECT * FROM person;
+RZLWZRUNV
7KHALTER TABLE ADD COLUMNFRPPDQGDOORZVIRUSDUDPHWHUVVSHFLI\LQJWKHSRVLWLRQ
RIDQHZO\DGGHGFROXPQ7RPDNHDQHZFROXPQWKHÀUVWDIWHUWKHPRGLÀFDWLRQLVFRPSOHWH
XVHWKHFIRSTRSWLRQ)RUDOORWKHUSRVLWLRQV\RXVSHFLI\AFTERZKLFKH[LVWLQJFROXPQDQHZ
FROXPQLVWREHSODFHG,QRXUH[DPSOHZHDGGHGWKHsalutationFROXPQDWWKHEHJLQQLQJ
RIWKHWDEOHZKLOHWKHmiddle_initialFROXPQZDVSXWULJKWDIWHUfirstname
'RLQJDVLPSOHSELECT *GLVSOD\VWKHSUHVLGHQWV
QDPHVDQGVDOXWDWLRQVQLFHO\UHDGDEOH
EHFDXVHRIWKHFROXPQRUGHU+DGZHMXVWDGGHGWKHFROXPQVZLWKRXWVSHFLI\LQJAFTERRU
FIRSTWKH\ZRXOGKDYHEHHQDSSHQGHGWRWKHHQGEHKLQGWKHperson_idFROXPQ:KLOH
VHPDQWLFDOO\LGHQWLFDOWKHRXWSXWZRXOGQRWKDYHEHHQDVUHDGDEOH
7KHUH
VPRUH
)RUDIXOOV\QWD[GHVFULSWLRQRIWKHALTER TABLE ADD COLUMNFRPPDQGSOHDVH
UHIHUWRVHFWLRQRIWKHRQOLQH0\64/PDQXDODWhttp://dev.mysql.com/doc/
refman/5.1/en/alter-table.html

0DQDJLQJ6FKHPDV

6HHDOVR
f
&RPSDULQJVFKHPDUHYLVLRQVXVLQJKDVKYDOXHV
'HÀQLQJDSULPDU\NH\IRUDWDEOHFRQWDLQLQJ
QRQXQLTXHGDWD
:KHQ\RXQHHGWRDGGD3ULPDU\NH\WRDWDEOHWKDWGLGQRWKDYHRQHSUHYLRXVO\\RXPLJKWÀQG
\RXUVHOIFRQIURQWHGZLWKDSUREOHPWKDWLVQRWLPPHGLDWHO\REYLRXVEXWFDQEHUDWKHUDQQR\LQJ
$W\SLFDOH[DPSOHIRUWKLVSUREOHPRFFXUULQJLVZLWKSHUVLVWHQFHIUDPHZRUNVWKDWUHTXLUH
\RXWRKDYHD3ULPDU\NH\RQDOOWDEOHV\RXZDQWLWWRPDQDJH,IWKHWDEOHVZHUHGHVLJQHG
LQGHSHQGHQWO\DQGEHIRUH\RXNQHZRIWKLVUHTXLUHPHQW\RXPLJKWQRWKDYHGHÀQHGDQ
H[SOLFLW3ULPDU\NH\IRUH[DPSOHRQWKHGHSHQGHQWRQHLQDUHODWLRQVKLSEHWZHHQWZRWDEOHV
,QWKLVUHFLSHZHZLOOVKRZ\RXDZD\WRVLPSO\DGGD3ULPDU\NH\WRDWDEOHWKDWDOUHDG\
FRQWDLQVGDWDDQGLVHYHQWDNLQJSDUWLQD)RUHLJQNH\UHODWLRQVKLS
*HWWLQJUHDG\
7RIROORZWKLVH[DPSOH\RXZLOOQHHG0\64/VHUYHUDQGDQDFFRXQWZLWKSULYLOHJHVVXIÀFLHQW
WRFUHDWHDQGPRGLI\WDEOHVDQGWKHLUFRQWHQWV)RUWKHQH[WVHFWLRQZHDVVXPHWKDW\RXKDYH
WKHVHULJKWVLQWKHtestVFKHPD
+RZWRGRLW

&RQQHFWWRWKH0\64/VHUYHUDQGPDNHtestWKHGHIDXOWVFKHPD

&UHDWHWKHIROORZLQJWDEOHV
CREATE TABLE parent (
  parent_id bigint(20) NOT NULL,
  somevalue varchar(20) default NULL,
  PRIMARY KEY  (parent_id)
) ENGINE=InnoDB;
CREATE TABLE child (
  x_parent_id bigint(20) default NULL,
  value bigint(10) default NULL,
  KEY fk_parent_id (x_parent_id),
  CONSTRAINT child_fk_1 FOREIGN KEY (x_parent_id) REFERENCES 
parent (parent_id)
) ENGINE=InnoDB;

&KDSWHU

7KHUHLVDUHODWLRQVKLSEHWZHHQSDUHQWDQGFKLOG&OHDUO\LWLVSRVVLEOH
DQGLQWHQGHGWKDWWKHUHFDQEHVHYHUDOFKLOGUHQZLWKUHIHUHQFHVWRWKHVDPH
SDUHQWHYHQLIWKH\KDYHHTXDOYDOXHV

,QVHUWVRPHVDPSOHGDWDWRGHPRQVWUDWHWKLV
mysql> INSERT INTO parent
          VALUES (1,'Parent No. 1'),
                 (2,'Parent No. 2'),
                 (3,'Parent No. 3');
mysql> INSERT INTO child 
          VALUES (1,10),(1,12),(1,15),
                 (2,25),(2,26),(2,26),
                 (3,31),(3,31),(3,31);
7U\LQJWRDGGD3ULPDU\NH\WRWKHFKLOGWDEOHOLNHWKLVZLOOIDLO7KLVVWHSVLPSO\VHUYHVDV
DGHPRQVWUDWLRQ<RXFDQWU\LWRXWLI\RXZDQWEXW\RXFDQVNLSLWMXVWDVZHOO
mysql> ALTER TABLE child
          ADD COLUMN child_id BIGINT(20) NOT NULL FIRST,
          ADD PRIMARY KEY(child_id);
ERROR 1062 (23000): Duplicate entry '0' for key 1
7KHUHDVRQIRUWKLVIDLOXUHLVGHVFULEHGLQWKHIROORZLQJ+RZLWZRUNVVHFWLRQ

,QVWHDGXVHWKHVHVWDWHPHQWVWRDGGWKH3ULPDU\NH\
mysql> ALTER TABLE child
          ADD COLUMN child_id BIGINT(20) 
             AUTO_INCREMENT NOT NULL FIRST,
          ADD PRIMARY KEY(child_id);
Query OK, 9 rows affected (0.06 sec)
Records: 9  Duplicates: 0  Warnings: 0
mysql> ALTER TABLE child
          MODIFY COLUMN child_id BIGINT(20) NOT NULL;
Query OK, 9 rows affected (0.08 sec)
Records: 9  Duplicates: 0  Warnings: 0
1RWLFHWKDW\RXFDQQRWFRPELQHWKHVHWZRVWDWHPHQWVLQWRDVLQJOH
ALTER TABLE FRPPDQG

:KHQLQVHUWLQJQHZGDWDPDNHVXUH\RXSURYLGH3ULPDU\NH\YDOXHV

0DQDJLQJ6FKHPDV

+RZLWZRUNV
$WÀUVWWKHVWDWHPHQWSUHVHQWHGÀUVWLQWKHVWHSVDERYHZRXOGVHHPVHQVLEOHWRDGGD3ULPDU\
NH\FROXPQWRWKHWDEOH
mysql> ALTER TABLE child
    ->   ADD COLUMN child_id BIGINT(20) NOT NULL FIRST,
    ->   ADD PRIMARY KEY(child_id);
ERROR 1062 (23000): Duplicate entry '0' for key 1
7KHHUURUPHVVDJHLVDOLWWOHKDUGWRJUDVSDWÀUVWEXWEHFRPHVSHUIHFWO\FOHDUZKHQWKLQNLQJ
PRUHWKRURXJKO\DERXWZKDW0\64/WULHVWRGRKHUH)LUVWOHW
VKDYHDORRNDWWKHVDPSOHGDWD
mysql> select * from child;
7U\LQJWRDGGDFROXPQLQ0\64/ZLOOÀOOLWZLWKHLWKHUNULLRUZLWKWKHGDWDW\SH
VGHIDXOW
YDOXH³LQWKLVFDVH0IRUDBIGINTFROXPQ'HFODULQJLWDVD3ULPDU\NH\DWWKHVDPH
WLPHWKHQRXJKWWRIDLOEHFDXVHDOOURZVZRXOGJHWWKHVDPHGHIDXOWYDOXHYLRODWLQJWKH
UHTXLUHPHQWRIXQLTXHQHVVIRUDNH\FROXPQ
6RWRJHWDURXQGWKLVZHQHHGVRPHLQLWLDOGLVWLQFWYDOXHVIRUWKHFROXPQ/DWHURQLQWKH
DSSOLFDWLRQ\RXZLOOKDYHWRSURYLGHXQLTXHNH\YDOXHVIRUQHZUHFRUGV2IWHQWKHSHUVLVWHQFH
OD\HUFDQSURYLGHJHQHUDWHGNH\VRQFHLWKDVEHHQWROGDERXWWKH3ULPDU\NH\FROXPQ)RUWKH
LQLWLDOURXQGWKHDXWRLQFUHPHQWIHDWXUHFRPHVLQKDQG\
mysql> ALTER TABLE child
    ->   ADD COLUMN child_id BIGINT(20) AUTO_INCREMENT NOT NULL FIRST,
    ->   ADD PRIMARY KEY(child_id);
Query OK, 9 rows affected (0.06 sec)
Records: 9  Duplicates: 0  Warnings: 0
mysql> select * from child;

&KDSWHU

7KLVWDNHVFDUHRISURYLGLQJDXQLTXHYDOXHIRUHDFKUHFRUG
VQHZO\FUHDWHG3ULPDU\NH\
FROXPQ%HFDXVHZHGRQRWQHHGWKHDXWRLQFUHPHQWLQJDQ\PRUHZHFDQUHPRYHLWDJDLQ
mysql> ALTER TABLE child MODIFY COLUMN child_id BIGINT(20)  NOT NULL;
Query OK, 9 rows affected (0.08 sec)
Records: 9  Duplicates: 0  Warnings: 0
7KHYDOXHVRIWKHchild_idFROXPQDUHUHWDLQHGWKHÀQDOFROXPQGHÀQLWLRQMXVWJHWVULGRI
WKHWHPSRUDU\AUTO_INCREMENTRSWLRQ
8QIRUWXQDWHO\WKLVFDQQRWEHFRPELQHGLQWRDVLQJOHALTER TABLEVWDWHPHQWEHFDXVHWKH
SDUVHUÀUVWFKHFNVLIWKHVWDWHPHQW
VSDUWVDUHDOOÀQHEHIRUHEHJLQQLQJH[HFXWLRQ+RZHYHUDW
WKHWLPHWKHVWDWHPHQWLVFKHFNHGWKHODWWHUMODIFY COLUMNVHJPHQWLVQRWYDOLGEHFDXVH
DWWKDWWLPHWKHchild_idFROXPQGRHVQRWH[LVW\HW
7KHUH
VPRUH
7KHDERYHH[DPSOHRQO\ZRUNVIRUQXPHULFNH\FROXPQVEHFDXVHWKHAUTO_INCREMENT
IHDWXUHFDQRQO\EHXVHGIRUWKRVH,I\RXQHHGDGLIIHUHQWGDWDW\SHIRUNH\\RXFDQRI
FRXUVHPRGLI\WKHVHFRQGALTER TABLEVWDWHPHQWWRFKDQJHWKHFROXPQ
VW\SHLQVWHDG
RIMXVWGURSSLQJWKHAUTO_INCREMENTRSWLRQ0\64/ZLOOWKHQWU\WRFRQYHUWWKHQXPEHUV
WKDWLWLQVHUWHGDXWRPDWLFDOO\WRWKHQHZO\GHÀQHGGDWDW\SH³IRUH[DPSOHVARCHARRUCHAR
mysql> ALTER TABLE child 
          MODIFY COLUMN child_id VARCHAR(20) NOT NULL;
mysql> INSERT INTO child VALUES ('foo',3,31);
$IWHUWKDW\RXDUHIUHHWRXVHUPDATEVWDWHPHQWVWRPRGLI\WKHNH\YDOXHVWR\RXUOLNLQJ

0DQDJLQJ6FKHPDV

$OORZLQJLQGLYLGXDO,16(57VWDWHPHQWVZLWK
YDOXHVLQDXWRLQFUHPHQWLQJFROXPQV
$XWRLQFUHPHQWLQJFROXPQVKDYHPDQ\XVHVSULPDULO\WKH\DUHXVHGWRDXWRPDWLFDOO\SURYLGH
3ULPDU\NH\YDOXHVIRUQHZUHFRUGVLQVHUWHGLQWRWDEOHV
7KHXVXDOEHKDYLRUIRU0\64/LVWRDVVLJQWKHQH[WIUHHQXPEHUIURPWKHDXWRLQFUHPHQW
VHTXHQFHWRDUHFRUG\RXLQVHUWWKDWKDVHLWKHUNULLRU0DVWKHYDOXHIRUDQ\VXFKFROXPQ
+RZHYHUVRPHWLPHVLWPD\EHQHFHVVDU\WRLQVHUWDQDFWXDO0YDOXHZLWKRXWDVVLJQLQJDQ
DXWRPDWLFUHSODFHPHQW
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRGRVRIRULQGLYLGXDOINSERTVWDWHPHQWV
*HWWLQJUHDG\
<RXZLOOQHHGD0\64/XVHUDFFRXQWWKDWFDQLQVHUWGDWD
,QWKHH[DPSOHWKDWZLOOIROORZZHZLOOGHPRQVWUDWHKRZWRH[HFXWHDVLQJOHINSERT
VWDWHPHQWZLWKD]HURFROXPQYDOXHHYHQWKRXJKWKHWDEOHGHÀQLWLRQFDOOVIRUWKLVFROXPQ
WREHDXWRLQFUHPHQWHG:HZLOODVVXPHDWDEOHFDOOHGenumeratorWREHSUHVHQWLQWKH
testGDWDEDVHZLWKWKHIROORZLQJVWUXFWXUH
CREATE TABLE enumerator (
  id INT NOT NULL AUTO_INCREMENT,
  textvalue VARCHAR(30),
  PRIMARY KEY (id)
) ENGINE=InnoDB;
+RZWRGRLW

&RQQHFWWRWKH0\64/VHUYHUDQGPDNHtestWKHGHIDXOWGDWDEDVH

6DYHWKHFXUUHQWYDOXHRIWKHSQL_MODEYDULDEOHIRUODWHUDQGDSSHQGWKH
NO_AUTO_VALUE_ON_ZERORSWLRQ
mysql> SET SESSION @OLDMODE=@@SQL_MODE;
mysql> SET SESSION SQL_MODE=CONCAT(@OLDMODE, 
           ',NO_AUTO_VALUE_ON_ZERO');
0DNHVXUH\RXGRQRWPLVVWKHFRPPDEHIRUHNO_AUTO_VALUE_ON_ZERO

,QVHUWDUHFRUGZLWKD0YDOXHIRUWKHidFROXPQOLNHWKLV
mysql> INSERT INTO enumerator VALUES (0,'Zero');

&KDSWHU


5HDGEDFNWKHGDWDWRYHULI\
mysql> SELECT * FROM enumerator;

5HVHWWKHSQL_MODEYDULDEOHWRLWVSUHYLRXVYDOXH
mysql> SET SESSION SQL_MODE=@OLDMODE;
+RZLWZRUNV
%\GHIDXOW0\64/ZLOOLQWHUSUHW0RUNULLYDOXHVIRUFROXPQVPDUNHGDVAUTO_INCREMENT
DVDVLJQWRLVVXHWKHQH[WIUHHQXPEHUIURPLWVLQWHUQDODXWRLQFUHPHQWFRXQWHUDQG
VXEVWLWXWHLWIRUWKH0RUNULLYDOXHLQWKHINSERTUHFHLYHG7KLVPDNHVLWJHQHUDOO\HDV\
IRUDSSOLFDWLRQVWRHQVXUHFRQÁLFWIUHHNH\YDOXHV+RZHYHUIRUVSHFLDOUHTXLUHPHQWVWKLV
EHKDYLRUFDQEHPRGLÀHGWRDOORZ0DVDUHJXODUYDOXHIRULQGLYLGXDOVHVVLRQV7KLVLVZKDW
ZHGLGE\DGGLQJWKHNO_AUTO_VALUE_ON_ZERORSWLRQWRWKHSQL_MODEV\VWHPYDULDEOH
IRUWKHFXUUHQWVHVVLRQ2QFHWKHUHFRUGKDVEHHQLQVHUWHGZHUHVWRUHWKHYDULDEOHWRLWV
ROGYDOXH
*OREDOO\DOORZLQJ,16(57VWDWHPHQWVZLWK
YDOXHVLQDXWRLQFUHPHQWLQJFROXPQV
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRVHW0\64/
VGHIDXOWEHKDYLRUWRJOREDOO\DOORZLQVHUWLQJ
0YDOXHVLQFROXPQVGHÀQHGDVDXWRLQFUHPHQWLQJIRUDZKROHVHUYHUDQGDOOFRQQHFWLRQV
+LVWRULFDOO\0\64/FUHDWHGDQHZDXWRPDWLFYDOXHIRUDQ\LQVHUWLRQZLWKD0RUNULLYDOXH
LQDFROXPQVHWXSDVDXWRLQFUHPHQWLQJ7KLVFDQOHDGWRXQH[SHFWHGEHKDYLRULIWKHGDWD
\RXDUHJRLQJWRVWRUHFRQWDLQVDFWXDO]HURHV³WKHVHZLOOVLOHQWO\EHFRQYHUWHGWRQHZYDOXHV
IURPWKHDXWRLQFUHPHQWVHTXHQFH6HHWKH$SSHQGL[IRUDPRUHWKRURXJKGHVFULSWLRQDQG
GHPRQVWUDWLRQRIWKLVHIIHFW

0DQDJLQJ6FKHPDV

7KH0\64/RQOLQHPDQXDO
VGHVFULSWLRQRIWKHNO_AUTO_VALUE_ON_ZERORSWLRQFRQWDLQV
DSDUDJUDSKRQKRZWKLVEHKDYLRUFRXOGHYHQOHDGWRFKDQJHGGDWDZKHQUHVWRULQJWDEOHV
IURPEDFNXSGXPSVMXVWWKHRSSRVLWHRIZKDWDEDFNXSLVVXSSRVHGWRDFFRPSOLVK)RUWKDW
UHDVRQFXUUHQWmysqldumpYHUVLRQVVWDUWLQJIURP0\64/PDNHVXUHWKDWWKHRSWLRQLV
WXUQHGRQDXWRPDWLFDOO\ZKHQUHVWRULQJE\LQFOXGLQJLWLQWKHGXPSÀOH
7RDYRLGDFFLGHQWDOO\IDOOLQJLQWRWKHVDPHWUDSLQWKLVUHFLSHZHZLOOJOREDOO\HQDEOH
NO_AUTO_VALUE_ON_ZEROIRUDOOGDWDEDVHVRIWKH0\64/VHUYHULQVWDQFH
*HWWLQJUHDG\
<RXZLOOQHHGDQRSHUDWLQJV\VWHPDFFRXQWZLWKSULYLOHJHVWRFKDQJHWKH0\64/VHUYHU
FRQÀJXUDWLRQÀOH7RDFWLYDWHWKHQHZVHWWLQJ\RXZLOOKDYHWRUHVWDUWWKHVHUYHUDIWHUWKHÀOH
KDVEHHQHGLWHG
+RZWRGRLW

2SHQWKH0\64/FRQÀJXUDWLRQÀOHZLWKDWH[WHGLWRU
 ,QWKH[mysqld]VHFWLRQÀQGDQ\H[LVWLQJSQL_MODEVHWWLQJ,ILW
VQRWSUHVHQW\HWDGG
LWRWKHUZLVHDSSHQGWRDQ\H[LVWLQJVHWWLQJVVHSDUDWHGE\DFRPPDOLNHKHUH
[mysqld]
...
sql-mode=STRICT_ALL_TABLES,NO_AUTO_VALUE_ON_ZERO

6DYHWKHÀOH

5HVWDUWWKHVHUYHU
+RZLWZRUNV
7KHSHUVHVVLRQYDULDEOH\RXVHWLQWKHUHFLSHPHQWLRQHGHDUOLHUFDQEHFRQÀJXUHGDVDVHUYHU
GHIDXOWE\VHWWLQJWKHYDOXHLQWKHconfigÀOH7KLVLVZKDWWKLVUHFLSHKDVVKRZQKRZWRGR
$VDQH[DPSOHRIKRZWKHVHWWLQJZRUNVVHHWKHUHFLSHVOLVWHGLQWKH6HHDOVRVHFWLRQ2I
FRXUVH\RXZLOOQRWQHHGWKHSET SQL_MODEVWDWHPHQWVFRQWDLQHGWKHUHLQDV\RXVHWWKH
VDPHEHKDYLRUXSDVWKHGHIDXOW
6HHDOVR
f
$OORZLQJLQGLYLGXDO,16(57VWDWHPHQWVZLWKYDOXHVLQDXWRLQFUHPHQWLQJFROXPQV
f
8QGHUVWDQGLQJDXWRLQFUHPHQWYDOXHV$SSHQGL[

&KDSWHU

&KRRVLQJDVXLWDEOHVWRUDJHHQJLQH
:KHQFUHDWLQJWDEOHVHLWKHUE\PLVWDNHRURQSXUSRVH\RXPD\XVHDVWRUDJHHQJLQHWKDW
GRHVQRWSURYHWREHWKHULJKWFKRLFHODWHU)RUWXQDWHO\0\64/DOORZV\RXWRFKDQJHWKH
VWRUDJHHQJLQHW\SHRIH[LVWLQJWDEOHVZLWKDVLQJOHVWDWHPHQW)LWWLQJO\0\64/H[WHQGHGWKH
V\QWD[RIWKHALTER TABLEFRPPDQGWRDOORZ\RXWRVSHFLI\WKHVWRUDJHHQJLQHDVMXVW
DQRWKHUSURSHUW\7KHRSHUDWLRQLVQRQGHVWUXFWLYHZKLFKPHDQVH[LVWLQJGDWDLVSUHVHUYHG
LQWKHWDEOH
,QWKLVUHFLSHZHZLOOVKRZ\RXKRZWRPRYHDWDEOHIURP0\,6$0WR,QQR'%2IFRXUVHWKHUH
DUHPDQ\PRUHVWRUDJHHQJLQHW\SHVDYDLODEOHEXWWKHVHWZRDUHWKHPRVWZLGHO\XVHGDQG
WKHUHIRUHPRVWUHOHYDQW
*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGD0\64/XVHUDFFRXQWZLWKDFFHVVWRWKHtestGDWDEDVHDQGWKH
ULJKWVWRPRGLI\WDEOHVWUXFWXUHVWKHALTERSULYLOHJH:HZLOOEHXVLQJDWDEOHGHÀQHGOLNHWKLV
CREATE TABLE person (
  salutation char(10) DEFAULT NULL,
  firstname varchar(30) DEFAULT NULL,
  middle_initial char(1) DEFAULT NULL,
  lastname varchar(30) DEFAULT NULL,
  birthday date DEFAULT NULL,
  person_id int(10) unsigned NOT NULL AUTO_INCREMENT,
  PRIMARY KEY (person_id)
) ENGINE=MyISAM;
,ILWGRHVQRWH[LVW\HWLQ\RXUtestGDWDEDVHH[HFXWHWKHDERYHCREATE TABLEVWDWHPHQW
EHIRUHPRYLQJRQ
+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHDQGPDNHtestWKHGHIDXOWGDWDEDVHVFKHPD

&KDQJHWKHWDEOHVWRUDJHHQJLQHOLNHWKLV
mysql> ALTER TABLE person ENGINE=InnoDB;
Query OK, 3 rows affected (0.24 sec)
Records: 3  Duplicates: 0  Warnings: 0

0DQDJLQJ6FKHPDV

+RZLWZRUNV
7KHALTER TABLEVWDWHPHQWWHOOV0\64/WRFUHDWHDQHZ,QQR'%WDEOHZLWKWKHH[DFWVDPH
GHÀQLWLRQDVWKHVRXUFHWDEOHDQGFRS\DOOWKHFRQWHQWVRYHUWKHUH2QFHGRQHWKHRULJLQDO
WDEOHZLOOEHUHPRYHGDQGWKHQHZRQHSXWLQLWVSODFH7KLVRSHUDWLRQGRHVSUHVHUYHDOOGDWD
LQWKHRULJLQDOWDEOH
+RZHYHUDVFKDQJLQJWKHVWRUDJHHQJLQHHIIHFWLYHO\PHDQVVWRULQJWKHGDWDLQDGLIIHUHQW
IRUPDWRQGLVN\RXUVHUYHUZLOOKDYHWRGHDOZLWKSRWHQWLDOO\ORWVRI,2GLUHFWO\SURSRUWLRQDOWR
WKHFXUUHQWVL]HRIWKHWDEOH,QWKLVH[DPSOHWKHWDEOHZDVYHU\VPDOORQO\WKUHHUHFRUGVVR
HYHU\WKLQJZHQWTXLFNO\
/DUJHWDEOHVKRZHYHUZLOOWDNHPXFKORQJHUEHFDXVHQRWRQO\ZLOODOOGDWD
KDYHWREHUHDGEXWDOVRZULWWHQVLPXOWDQHRXVO\
'XULQJWKDWRSHUDWLRQ0\64/ZLOODOORZUHDGRSHUDWLRQVEXWDQ\ZULWHV
UPDATEDELETEDQGINSERTZLOOEHGHOD\HGXQWLOWKHFRQYHUVLRQLV
FRPSOHWH2QO\WKHQZLOOWKH\H[HFXWHDJDLQVWWKHQHZWDEOH7KLVZLOOFDXVH
WURXEOHIRUPRVWDSSOLFDWLRQVQRWH[SHFWLQJWKHLURSHUDWLRQVWRWDNHWKDWORQJ
7KLVLVZK\\RXZLOOZDQWWRGHOD\FKDQJLQJWKHVWRUDJHHQJLQHWRDORZWUDIÀF
WLPHSHULRGRUEHWWHU\HWDQRIÁLQHPDLQWHQDQFHZLQGRZ
0RUHRYHU\RXUGLVNVPXVWSURYLGHHQRXJKVSDFHIRUWKHWDEOHVLQERWKWKHROGDQGWKHQHZ
IRUPDWVDWOHDVWWHPSRUDULO\EHFDXVH0\64/ZLOORQO\UHPRYHWKHROGWDEOHRQFHWKHQHZRQH
KDVEHHQVXFFHVVIXOO\FUHDWHGDQGDOOWKHGDWDKDVEHHQWUDQVIHUUHG
%HFDUHIXOKHUHWKDWGLIIHUHQWVWRUDJHHQJLQHVKDYHGLIIHUHQWGLVNVSDFHUHTXLUHPHQWVIRUWKH
VDPHGDWD,QQR'%WDEOHVWHQGWREHODUJHUWKDQWKHLU0\,6$0FRXQWHUSDUWV
7KHUH
VPRUH
7KHH[DPSOHRXWOLQHGLQWKLVUHFLSHZDVDYHU\VLPSOHRQH³FRQYHUWLQJIURP0\,6$0WR
,QQR'%LVXVXDOO\QRSUREOHPEHFDXVH,QQR'%EDVLFDOO\RIIHUVWKHVDPHIHDWXUHVDV0\,6$0
DQGPRUH+RZHYHU\RXZLOOQRWEHDEOHWRFRQYHUW0\,6$0WDEOHVWKDWKDYHIXOOWH[WLQGH[HV
EHFDXVHWKRVHDUHQRWVXSSRUWHGE\,QQR'%,I\RXWU\WRDOWHUWKHHQJLQHW\SHRQVXFKDWDEOH
\RXZLOOJHWDQHUURUPHVVDJH
mysql> ALTER TABLE forum_posts ENGINE=InnoDB;
ERROR 1214 (HY000): The used table type doesn't support FULLTEXT 
indexes

&KDSWHU

&RQYHUWLQJWDEOHVIURP,QQR'%WR0\,6$0LVXVXDOO\OHVVFRPPRQEXWVWLOOSRVVLEOHDVORQJ
DVWKHUHDUHQR)RUHLJQNH\UHODWLRQVKLSVLQSODFH7KLVDSSOLHVWRERWKVLGHVRIDQ\VXFK
UHODWLRQVKLS,IIRUH[DPSOH\RXKDGWZR,QQR'%WDEOHVFDOOHGparentDQGchildZKHUH
childUHFRUGVZHUHVHWXSWRUHIHUWRWKHLUparentURZLQWKDWWDEOHWU\LQJWRFKDQJHWKH
HQJLQHRQDQ\RIWKHVHZRXOGIDLO
mysql> ALTER TABLE parent ENGINE=MyISAM;
ERROR 1217 (23000): Cannot delete or update a parent row: a foreign 
key constraint fails
mysql> ALTER TABLE child ENGINE=MyISAM;
ERROR 1217 (23000): Cannot delete or update a parent row: a foreign 
key constraint fails
%HIRUH\RXFRXOGFKDQJHWKHVWRUDJHHQJLQHIRUWKRVH\RXZRXOGKDYHWRÀUVWGURSDQ\)RUHLJQ
NH\FRQVWUDLQWVRQWKHP
$SDUWIURP0\,6$0DQG,QQR'%WKHUHDUHPDQ\PRUHVWRUDJHHQJLQHVDYDLODEOH)RU
LQIRUPDWLRQRQWKHLUUHVSHFWLYHFDSDELOLWLHVDQGRWKHUSURSHUWLHVSOHDVHUHIHUWR&KDSWHURI
WKH0\64/RQOLQHPDQXDODWhttp://dev.mysql.com/doc/refman/5.1/en/storage-
engines.htmlDQGWRWKHALTER TABLEGRFXPHQWDWLRQLQVHFWLRQDW
http://dev.mysql.com/doc/refman/5.1/en/alter-table.html
.HHSLQJDZDWFKRQVLOHQWHQJLQHVXEVWLWXWLRQ
6SHFLDODWWHQWLRQVKRXOGEHSDLGWRWKHIDFWWKDW0\64/PLJKWVLOHQWO\LJQRUH\RXUUHTXHVWRU
HYHQPRGLI\WKHVWRUDJHHQJLQHW\SHWRDGHIDXOWRQHLIWKHRQH\RXVSHFLÀHGLVQRWDYDLODEOH
RQ\RXUVHUYHU7KHH[DFWEHKDYLRUGHSHQGVRQ\RXU0\64/VHUYHUYHUVLRQDQGWKHVHWWLQJRI
WKHSQL_MODEFRQÀJXUDWLRQYDULDEOH
0\64/DQG
ROGHU
0\64/DQGQHZHU
NO_ENGINE_SUBSTITUTIONVSHFLÀHG
*LYHVHUURU
*LYHVHUURU
NO_ENGINE_SUBSTITUTIONGLVDEOHG
PLVVLQJ
8VHVGHIDXOWVWRUDJH
HQJLQHDQGLVVXHV
ZDUQLQJQRWHUURU
,JQRUHVUHTXHVWHGHQJLQH
DQGLVVXHVZDUQLQJ
QRWHUURU
3OHDVHQRWHWKDWWKLVWDEOHGRHVQRWDSSO\WRCREATE TABLEEXWRQO\WRALTER TABLE
)RUPRUHLQIRUPDWLRQRQWKLVWRSLFVHHWKH0\64/RQOLQHPDQXDOVHFWLRQRQ6HUYHU
64/0RGHVDWhttp://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.
html#sqlmode_no_engine_substitution
:HUHFRPPHQGDOZD\VHQDEOLQJWKHNO_ENGINE_SUBSTITUTIONRSWLRQ
WRDYRLGULVNLQJPLVVLQJDZDUQLQJDQGUXQQLQJLQWRSUREOHPVODWHURQ

0DQDJLQJ6FKHPDV

,PSURYLQJWKHSHUIRUPDQFHRI$/7(57$%/(
IRU,QQR'%
7KLVUHFLSHZLOOVKRZ\RXDZD\RIOLPLWLQJWKHXQDYRLGDEOHLPSDFWRI,QQR'%WDEOHDOWHUDWLRQV
WRWKHQHFHVVDU\PLQLPXP
8QIRUWXQDWHO\WKHUHLVQRZD\RIFLUFXPYHQWLQJWKDWDVALTER TABLERQ,QQR'%LV
DWLPHFRQVXPLQJDQG,2LQWHQVLYHRSHUDWLRQEXWSODQQLQJDKHDGFDQPDNHDKXJH
GLIIHUHQFHDVWRKRZVHYHUHWKHLPSDFWRQ\RXUV\VWHPVZLOOEH
*HWWLQJUHDG\
:KLOHWKLVUHFLSHDSSOLHVWRDQ\,QQR'%WDEOHWKHDFWXDOEHQHÀWVRIWKHIROORZLQJ
UHFRPPHQGDWLRQVDUHEHVWVHHQZLWKDODUJHWDEOH)RUWKHH[DPSOHEHORZZHZLOOEHXVLQJ
WKHemployeesVDPSOHGDWDEDVH
VsalariesWDEOHZKLFKFRQWDLQVVOLJKWO\OHVVWKDQ
PLOOLRQUHFRUGVDQGLVDERXW0%LQVL]H7KLVVDPSOHGDWDEDVHFDQEHGRZQORDGHGIURP
WKH0\64/ZHEVLWHDWhttp://dev.mysql.com/doc/employee/en/employee.html
7KHWDEOHLVGHÀQHGOLNHWKLV
CREATE TABLE salaries (
  emp_no int(11) NOT NULL,
  salary int(11) NOT NULL,
  from_date date NOT NULL,
  to_date date NOT NULL,
  PRIMARY KEY (emp_no,from_date),
  CONSTRAINT salaries_ibfk_1 FOREIGN KEY (emp_no) REFERENCES  
employees (emp_no) ON DELETE CASCADE 
) ENGINE=InnoDB
:HZLOODGGDQLQGH[WRWKHfrom_dateFROXPQDQGDOVRDGGDFROXPQFDOOHGremark
<RXZLOOQHHGDXVHUDFFRXQWZLWKVXIÀFLHQWULJKWVWRFKDQJHWKHWDEOHGHÀQLWLRQ

&KDSWHU

+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHVHUYHUXVLQJWKHDGPLQLVWUDWLYHXVHUDQGPDNHemployees
WKHGHIDXOWGDWDEDVH
 &KHFNRQWKHFXUUHQWVL]HRIWKHWDEOHXVLQJWKHIROORZLQJVWDWHPHQWRXWSXWDEULGJHG
mysql> SHOW TABLE STATUS LIKE 'salaries'\G
*************************** 1. row ***************************
           Name: salaries
         Engine: InnoDB
           Rows: 2844513
    Data_length: 100270080
      Data_free: 1352663040
1 row in set (0.07 sec)
$V\RXFDQVHHWKHWDEOHLVDSSUR[LPDWHO\0%ELJZLWKDERXW0%IUHHLQWKH
WDEOHVSDFH$VVXPLQJWKDWQRRWKHURSHUDWLRQVZLOOÀOOXSWKLVVSDFHGXULQJWKHALTER 
TABLEZHVWLOOQHHGWRFRQVLGHUWKHODUJHUWDEOHVL]HFDXVHGE\WKHDGGLWLRQDOLQGH[
,QWKLVH[DPSOHZHVKRXOGEHÀQH,IWKHWDEOHVSDFHLVDXWRH[WHQGLQJDQGWKHUHLV
HQRXJKIUHHVSDFHRQWKHYROXPHLWLVVWRUHGRQ\RXDUHJRRGWRJRDVZHOORWKHUZLVH
\RXVKRXOGJRDQGPDNHVXUHWKHWDEOHVSDFHJHWVH[WHQGHGEHIRUH\RXSURFHHG
 ,VVXHWKHIROORZLQJALTER TABLEVWDWHPHQWWKDWDGGVWKHQHZFROXPQDQGWKHLQGH[
LQRQHVWHS
mysql> ALTER TABLE salaries 
          ADD COLUMN remark VARCHAR(32) DEFAULT NULL 
              AFTER to_date,
          ADD INDEX IDX_FROMDATE(from_date);

7KLVZLOOWDNHVRPHWLPH
+RZLWZRUNV
:KHQPRGLI\LQJDQ,QQR'%WDEOHXVLQJWKHALTER TABLEFRPPDQGLQPRVW0\64/
LQVWDOODWLRQVVHHWKH7KHUH
VPRUHVHFWLRQIRULQIRUPDWLRQDERXWH[FHSWLRQVLWZLOOSHUIRUP
PRGLÀFDWLRQVE\ÀUVWFUHDWLQJDQHZWDEOHZLWKWKHPRGLÀHGGHÀQLWLRQWKHQFRS\LQJDOOGDWD
IURPWKHRULJLQDOWDEOHDQGÀQDOO\VZDSSLQJWKHQHZO\FUHDWHGPRGLÀHGRQHIRUWKHRULJLQDO
$VWDEOHVJURZWKLVFDQWDNHDORQJWLPHFUHDWLQJORWVRI,2DFWLYLW\IRUWKHFRS\SURFHGXUH
0DNLQJPDWWHUVZRUVHWKLVSURFHVVUHTXLUHVPXFKGLVNVSDFHEHFDXVHWHPSRUDULO\\RXZLOO
KDYHERWKWKHRULJLQDOWDEOHDQGWKHFRS\SUHVHQWRQGLVNÀOOLQJXSWKHUHPDLQLQJVSDFHDQG
WKHUHE\SRWHQWLDOO\LQÁXHQFLQJRWKHUDSSOLFDWLRQV%XWHYHQMXVWLQVLGH0\64/LWVHOI\RXPD\
UXQLQWRSUREOHPVEHFDXVH\RXUWDEOHVSDFHPLJKWQRWKDYHHQRXJKIUHHVSDFHOHIWWRKROG
ERWKFRSLHVRIDODUJHWDEOH

0DQDJLQJ6FKHPDV

8VLQJDVHFRQGFRQQHFWLRQ\RXFDQDFWXDOO\VHHWKHWHPSRUDU\WDEOHEHLQJXVHGWKURXJKWKH
IROORZLQJFRPPDQGZKLOHWKHALTER TABLE LVVWLOOUXQQLQJ
mysql> SHOW FULL PROCESSLIST \G
7KRXJK\RXFDQQRWSUHYHQW,QQR'%IURPFRS\LQJWKHWDEOHVIRUPRGLÀFDWLRQ\RXFDQDWOHDVW
PLQLPL]HWKHLQÁXHQFHRIWKLVSURFHGXUHE\WU\LQJWRPDNHDOOQHFHVVDU\PRGLÀFDWLRQVDWRQFH
7KDWPHDQVLQVWHDGRIVD\ÀUVWDGGLQJDQHZFROXPQZLWKRQHALTER TABLEFRPPDQGDQG
WKHQDGGLQJWKHQHZLQGH[ZLWKDVHFRQGRQH\RXFRPELQHERWKLQDVLQJOHVWDWHPHQW
7KHORQJHUFRPSRVLWHVWDWHPHQWLWVHOIPD\QRWEHDVUHDGDEOHDVLQGLYLGXDORQHVHYHQWKRXJK
\RXFDQZRUNDURXQGWKDWZLWKSURSHULQGHQWDWLRQDQGIRUPDWWLQJEXWLWZLOORQO\UHTXLUHD
VLQJOHFRS\SDVVLQVWHDGRIRQHIRUHDFKPRGLÀFDWLRQ
7KHUHDUHOLPLWVWRWKLVIRUH[DPSOH\RXFDQQRWGURSDFRQVWUDLQWDWWKHEHJLQQLQJRIWKH
VWDWHPHQWDQGWKHQDGGDQRWKHURQHZLWKWKHVDPHQDPHODWHUEXWLQJHQHUDOWKLVLVWKH
ZD\WRJRDVVRRQDVWKHWDEOHLQTXHVWLRQFRQWDLQVPRUHWKDQMXVWDFRXSOHRIURZV
7KHH[DPSOHVWDWHPHQWDERYHWRRNPLQXWHDQGVHFRQGVRQP\L0DF7KHVDPHFRPSXWHU
ZLWKDQXQPRGLÀHG0\64/VHUYHUFRQÀJXUDWLRQWRRNPLQXWHVDQGVHFRQGVZKHQLVVXLQJWZR
VHSDUDWHALTER TABLEVWDWHPHQWVIRUWKHLQGH[DQGWKHQHZFROXPQLQGLYLGXDOO\
7KHUH
VPRUH
6WDUWLQJZLWK0\64/VWRUDJHHQJLQHVFDQEHORDGHGLQWRWKH0\64/VHUYHUDVSOXJLQV
$OWKRXJK,QQR'%FRPHVEXQGOHGZLWK0\64/WKHUHLVDVHSDUDWHSOXJLQYHUVLRQWKDWLV
GHYHORSHGLQGHSHQGHQWO\RIWKHPDLQVHUYHU$WWKHWLPHRIZULWLQJWKLVERRN0\64/YHUVLRQ
ZDVLQEHWDDQGFRQWDLQHGVRPHRIWKHQHZHUIHDWXUHVWKDWZHUHRQO\DYDLODEOHLQWKH
SOXJLQUHOHDVHDYDLODEOHIURPhttp://www.innodb.com$VWKH0\64/VHUYHUUHOHDVH
PRGHOLVFXUUHQWO\LQDVWDWHRIFKDQJHLWLVKDUGWRSUHGLFWZKDWWKHPRVWUHFHQWYHUVLRQ
ZLOOEHDWWKHWLPH\RXDUHUHDGLQJWKLVDQGZKDWLWZLOOEHFDOOHG

&KDSWHU

+RZHYHUDSDUWIURPRWKHULPSURYHPHQWVWKHPDLQIHDWXUHZRUWKPHQWLRQLQJLVFDOOHGIDVW
LQGH[FUHDWLRQ,WDOORZVFUHDWLQJDQGGURSSLQJLQGH[HVZLWKRXWQHHGLQJWRFRS\DWDEOHDQGDOO
LWVGDWD7KLVFDQDOOHYLDWHWKHSDLQRIVFKHPDPRGLÀFDWLRQVVLJQLÀFDQWO\+RZHYHUGXHWRWKH
0\64/EXJhttp://bugs.mysql.com/bug.php?id=33650WKLVIHDWXUHFDQQRW
EHXVHGLIDQ\RIWKHLQGH[HGFROXPQVDUHFRQÀJXUHGWRXVHutf8DVWKHLUWH[WHQFRGLQJ:H
VXJJHVW\RXPRQLWRUWKLVEXJLI\RXZDQWWRWU\RXWWKHSOXJLQ
8VLQJDVWRUHGSURFHGXUHWRFRQGLWLRQDOO\
DGGFROXPQVRULQGH[HV
6HYHUDORI0\64/
VVFKHPDUHODWHGFRPPDQGVDOORZIRUDQIF EXISTSFODXVHZKLFKLV
DYHU\XVHIXODGGLWLRQWRVWDQGDUG64/V\QWD[EHFDXVHLWDOORZVIRUPRUHUREXVWDXWRPDWLF
VFKHPDKDQGOLQJ:KHQ\RXQHHGWRGRXQDWWHQGHGVFKHPDPDQLSXODWLRQVIRUH[DPSOH
UHFUHDWHDWDEOHZKHQ\RXGRQRWNQRZIRUVXUHZKHWKHULWH[LVWVRQWKHWDUJHWV\VWHP\RX
VLPSO\GRD
DROP TABLE ,)(;,676 tablename;
CREATE TABLE tablename (...)
:LWKRXWWKHIF EXISTSFODXVHWKHDROP TABLEVWDWHPHQWZRXOGIDLOLIWKHWDEOHZDVQRW
SUHVHQWZKHQH[HFXWLQJWKHVFULSWDQGDERUWWKHH[HFXWLRQLPPHGLDWHO\LQHIIHFWHQGLQJXS
ZLWKRXWWKHQHZWDEOH
8QIRUWXQDWHO\WKHUHDUHVRPHFDVHVZKHUHWKHIF EXISTSFODXVHZRXOGFRPHLQKDQG\EXW
LVQRWVXSSRUWHGE\0\64/2QHVXFKFDVHLVWKHDGGLWLRQRIQHZLQGH[HVWRDQH[LVWLQJWDEOH
,QWKLVUHFLSHZHZLOOSUHVHQWDZD\WRZRUNDURXQGWKLVOLPLWDWLRQDQGZULWHSRUWDEOHDQG
UREXVWVFULSWVWRPRGLI\DWDEOHXQDWWHQGHG
1RWHWKDWWKLVLVSULPDULO\XVHIXOIRUWKHDXWRPDWLFH[HFXWLRQRIXSGDWHVWRGDWDEDVHVWKDW
DUHQRWXQGHU\RXULPPHGLDWHFRQWUROIRUH[DPSOHDVSDUWRIDVRIWZDUHXSGDWHLQVWDOOHU
)RUPDQXDOPRGLÀFDWLRQVRIDVFKHPDLWLVXVXDOO\ZD\OHVVZRUNWRKDYHDORRNDWWKHFXUUHQW
WDEOHVWUXFWXUHÀUVWWRGHWHUPLQHLIWKHUHLVDQ\WKLQJWRGRLQWKHÀUVWSODFH
*HWWLQJUHDG\
,QWKHIROORZLQJH[DPSOHZHZLOOEHPRGLI\LQJWZRWDEOHVLQWKHtestGDWDEDVHVFKHPD7KH\
ZLOOEHLGHQWLFDOH[FHSWIRURQHKDYLQJDQLQGH[IDX_BDOUHDG\ZKLOHWKHRWKHUGRHVQRW7R
IROORZDORQJ\RXZLOOQHHGDXVHUDFFRXQWZLWKVXIÀFLHQWSULYLOHJHVWRÀUVWFUHDWHWKHVHWDEOHV
DQGWKHQPRGLI\WKHP7KLVLVGRQHYLDDVWRUHGSURFHGXUHWKDW\RXPXVWKDYHWKHULJKWVWR
FUHDWHDVZHOO

0DQDJLQJ6FKHPDV

7KHVHDUHWKHWDEOHGHÀQLWLRQV
CREATE TABLE TableA (
  col_A int(11) DEFAULT 1,
  col_B varchar(40) DEFAULT NULL
) ENGINE=InnoDB;
CREATE TABLE TableB (
  col_A int(11) DEFAULT 1,
  col_B varchar(40) DEFAULT NULL,
  KEY IDX_B (col_B)
) ENGINE=InnoDB;
+RZWRGRLW

&RQQHFWWRWKH0\64/VHUYHUXVLQJDQDGPLQLVWUDWLYHXVHUDFFRXQW
 &UHDWHDVWRUHGSURFHGXUHZLWKWKHIROORZLQJVHTXHQFHRILQVWUXFWLRQV7KHPHDQLQJRI
DOOWKHVWHSVZLOOEHH[SODLQHGLQWKH+RZLWZRUNVVHFWLRQ
mysql> DELIMITER $$ 
mysql> DROP PROCEDURE IF EXISTS sp_AddIndex $$ 
mysql> CREATE PROCEDURE sp_AddIndex
          (tblName VARCHAR(64),ndxName VARCHAR(64), 
           colName VARCHAR(64))
BEGIN
   DECLARE IndexColumnCount INT;
   DECLARE SQLStatement VARCHAR(256);
   SELECT COUNT(index_name) INTO IndexColumnCount
   FROM information_schema.statistics
   WHERE table_schema = database()
   AND table_name = tblName
   AND index_name = ndxName;
   IF IndexColumnCount = 0 THEN
       SET SQLStatement = CONCAT('ALTER TABLE ',tblName,' ADD 
INDEX ',ndxName,' (',colName,')');
       SET @SQLStmt = SQLStatement;
       PREPARE s FROM @SQLStmt;
       EXECUTE s;
       DEALLOCATE PREPARE s; 
   END IF;
END $$ 
mysql> DELIMITER ;

&KDSWHU


&DOOWKHSURFHGXUHSURYLGLQJWKHWDEOHQDPHLQGH[QDPHDQGWKHFROXPQWR
EHLQGH[HG
mysql> CALL sp_AddIndex('TableA','IDX_B','col_B');

&OHDQXSUHPRYLQJWKHSURFHGXUHDQGUHVHWWLQJWKHVWDWHPHQWGHOLPLWHU
mysql> DROP PROCEDURE IF EXISTS sp_AddIndex;
mysql> DELIMITER ;
+RZLWZRUNV
:KLOH0\64/GRHVQRWRIIHUDGLUHFWZD\RIH[HFXWLQJWKHVWDWHPHQWRQO\LIWKHWDUJHWLQGH[
DOUHDG\H[LVWVDVWRUHGSURFHGXUHFDQEHXVHGWRSHUIRUPWKLVFKHFN7KHÀUVWVWDWHPHQWLV
XVHGWRFKDQJHWKHGHIDXOWVWDWHPHQWGHOLPLWHUIURP;WRVRPHWKLQJGLIIHUHQW³WZRGROODUVLJQV
$$LQWKLVFDVH7KLVDOORZVWKHGHÀQLWLRQRIWKHDFWXDOSURFHGXUHFRQWHQWVLQDPRUHQDWXUDO
IRUPXVLQJWKHGHIDXOWVHPLFRORQVWRVHSDUDWHWKHURXWLQH
VFRPPDQGV
7KHÀUVWDSSOLFDWLRQRIWKLVQHZGHOLPLWHULVDVWDWHPHQWWRGURSDQ\SURFHGXUHZLWKWKH
VDPHQDPHDVWKDWZHDUHDERXWWRXVH,WHQGVZLWK$$WKHWHPSRUDU\UHSODFHPHQWIRUWKH
XVXDOVHPLFRORQ
$IWHUWKDWWKHDFWXDOSURFHGXUHLVGHFODUHG,WLVFDOOHGsp_AddIndexsp_EHLQJD
FRPPRQSUHÀ[IRUVWRUHGSURFHGXUHVEXWWKLVLVQRWVWULFWO\QHFHVVDU\DQGWDNHVWKUHHLQSXW
SDUDPHWHUVWRZRUNZLWK7KHÀUVWRQHLVWKHWDEOHQDPHWRRSHUDWHRQWKHVHFRQGRQHLVXVHG
WRSDVVWKHQDPHRIWKHWDUJHWLQGH[DQGWKHODVWRQHWKHQDPHRIWKHFROXPQVWKHLQGH[LV
VXSSRVHGWRVSDQ
,WWKHQTXHULHVWKHINFORMATION_SCHEMAWRÀQGRXWLIWKHUHDOUHDG\LVDQLQGH[ZLWKWKH
JLYHQQDPHRQWKHJLYHQWDEOHLQWKHFXUUHQWVFKHPD7KHUHVXOWRIWKHCOUNT()TXHU\ZLOOEH
]HURLIWKHUHLVQRLQGH[PDWFKLQJWKHJLYHQFULWHULD7KLVLVWKHQFKHFNHGLQWKHIFVWDWHPHQW
JXDUGLQJWKHEXLOGLQJRIDVXLWDEOHALTER TABLE … ADD INDEXVWDWHPHQWZKLFKLVÀQDOO\
H[HFXWHG,IDQLQGH[DOUHDG\H[LVWHGWKHIndexColumnCountUHVXOWZLOOEHJUHDWHUWKDQ
]HURKHQFHVNLSSLQJWKHALTER TABLE VWDWHPHQW
)LQDOO\WKHSURFHGXUHLVFDOOHGIRUTableADQGcol_BZLWKDQLQGH[QDPHRIIDX_B2QFH
WKHSURFHGXUHLVFRPSOHWHGLWLVGURSSHGDJDLQDQGWKHGHIDXOWGHOLPLWHULVUHVWRUHGWR
WKHVHPLFRORQ

0DQDJLQJ6FKHPDV

7KHUH
VPRUH
2IFRXUVH\RXQHHGQRWGURSWKHSURFHGXUHLI\RXSODQWRXVHLWPRUHUHJXODUO\+RZHYHUWKLV
H[DPSOHZDVWDNHQIURPDQDXWRPDWHGVFULSWZHXVHWRXSGDWHODUJHQXPEHUVRIVHUYHUVIURP
WLPHWRWLPH7KHUHIRUHZHXVXDOO\FUHDWHDQGGURSVXFKPDLQWHQDQFHSURFHGXUHVDVQHHGHG
$WWKHWLPHRIZULWLQJWKLVERRNWKHUHZDVDEXJLQ0\64/YHUVLRQWKDWOHDGWRDZURQJ
UHVXOWRIWKHCOUNT()TXHU\LQVLGHWKHSURFHGXUHRQ0DF26;DQG:LQGRZV$IWHUFRQWDFWLQJ
0\64/VXSSRUWDQGVRPHHPDLOLQJEDFNDQGIRUWK0\64/%XJ
http://bugs.mysql.com/bug.php?id=46771ZDVSXWLQWRWKHLUEXJGDWDEDVH
:KLOH,UHFRPPHQG\RXWRJRDQGFKHFNRQWKHVWDWHRIWKLQJVZKHQ\RXUHDGWKLVWKHERWWRP
OLQHLVWKDWWKHINFORMATION_SCHEMASVHXGRGDWDEDVHGRHVQRWDQVZHUTXHULHVFRUUHFWO\
XQOHVV\RXHQWHUWDEOHQDPHVDOOLQORZHUFDVH8VXDOO\\RXZRXOGQRWQRWLFHRQ:LQGRZV
RU0DF26;EHFDXVHWKHLUGHIDXOWÀOHV\VWHPVGRQRWPDNHDGLIIHUHQFHEHWZHHQWZRÀOHV
LIWKHLUQDPHVRQO\GLIIHULQXSSHUORZHUFDVLQJZKLOHPRVW8QL[ÀOHV\VWHPVGR
7RZRUNDURXQGWKLVEXJPDNHVXUH\RXRQO\XVHORZHUFDVHWDEOHQDPHVLI\RXPDQDJHWKH
VHUYHURQRQHRIWKRVHRSHUDWLQJV\VWHPVXQOHVV\RXÀQGWKDW\RXUVHUYHUYHUVLRQKDVDOUHDG\
EHHQÀ[HG
,PSURYLQJTXHU\SHUIRUPDQFHIRU,QQR'%
WDEOHVZLWK%/2%FROXPQV
0\64/DQG,QQR'%EHKDYHLQDKDUGO\SUHGLFWDEOHZD\ZKHQTXHU\LQJWDEOHVWKDWFRQWDLQ
%/2%FROXPQV7KLVPLJKWFDWFK\RXRIIJXDUGDQGFDXVHVORZSHUIRUPDQFHZKHUHLWZRXOG
QRWKDYHWREH7KLVLVFDXVHGE\DEXJRUDPLVVLQJIHDWXUHGHSHQGLQJRQ\RXUSHUVSHFWLYH
LQ0\64/
,QWKLVUHFLSHZHZLOOGHPRQVWUDWHKRZWRUHSURGXFHWKLVEXJDQGLQWKH+RZLWZRUNV
VHFWLRQH[SODLQKRZWRZRUNDURXQGLW2IFRXUVH\RXVKRXOGÀUVWFKHFNWKHDERYHEXJUHSRUW
DQGVHHZKHWKHULWKDVEHHQÀ[HGDWWKHWLPH\RXDUHUHDGLQJWKLVLQWKH0\64/VHUYHUYHUVLRQ
\RXDUHXVLQJ+RZHYHUDVWKLVEXJKDVEHHQRSHQVLQFHDQGKDVEHHQSULRULWL]HGDVD
IHDWXUHUHTXHVW,GRQRWWKLQNFKDQFHVDUHHVSHFLDOO\JRRGWKDWWKLVKDVKDSSHQHG
*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGD0\64/XVHUDFFRXQWZLWKVXIÀFLHQWSULYLOHJHVWRFUHDWHWDEOHV
LQWKHtestVFKHPDDQGLQVHUWGDWDLQWRWKHP)RUWKH%/2%FRQWHQWVDÀOHZLOOEHQHHGHG
WRUHDGIURP,QWKHH[DPSOHZHZLOOXVH/tmp/blobdemoEXWWKHFRQWHQWLVQRWDWDOO
LPSRUWDQW<RXFRXOGDOVRXVHDQ\RWKHUÀOHDW\RXUGLVSRVDO

&KDSWHU

+RZWRGRLW

&RQQHFWWRWKHGDWDEDVHDQGPDNHWKHtestGDWDEDVHWKHGHIDXOWVFKHPD

&UHDWHDWDEOHZLWKWKLVVWUXFWXUH
mysql> CREATE TABLE blobtest (
  intA INT(10) NOT NULL AUTO_INCREMENT,
  intB INT(10) DEFAULT NULL,
  contents BLOB,
  PRIMARY KEY (intA)
) ENGINE=InnoDB; 

/RDGWKHÀOHFRQWHQWVLQWRLW0DNHVXUHWRDGDSWWKHSDWKQDPHLI\RXZDQWWRXVHD
GLIIHUHQWÀOH
mysql> INSERT INTO blobtest (intB, contents)
           VALUES(100, LOAD_FILE("/tmp/blobfile"));

([HFXWHWKHIROORZLQJFRPPDQGWLPHVWRSURGXFHVRPHWHVWGDWD
mysql> INSERT INTO blobtest (intB, contents) 
           SELECT intB, contents FROM blobtest;
(DFKWLPH\RXUHSHDWWKLVFRPPDQGWKHQXPEHURIUHFRUGVLQWKHblobtestWDEOH
ZLOOGRXEOH7RPDNHWKHHIIHFWPRUHREYLRXV\RXFRXOGGRPRUHWKDQLWHUDWLRQV
EXWEHZDUHWKDWHDFKRQHRIWKHPZLOOWDNHTXLWHDORWORQJHUWRH[HFXWH
([HFXWHDTXHU\WKDWDVNVIRUDOOWKHFROXPQVLQFOXGLQJWKHcontentsFROXPQEXWWKDW
GRHVQRWUHWXUQDQ\URZV
mysql> SELECT * FROM blobtest WHERE intB=0;
Empty set (2.64 sec) 
7KHWHEREFODXVHGRHVQRWPHQWLRQWKH%/2%W\SHcontentsFROXPQ

([HFXWHDTXHU\WKDWH[SOLFLWO\H[FOXGHVWKH%/2%FROXPQ
mysql> SELECT intA, intB FROM blobtest WHERE intB=0;
Empty set (0.01 sec)
1RWLFHWKDWWKLVTXHU\ZDVFRPSOHWHGVLJQLÀFDQWO\IDVWHUWKDQWKHRQH
EHIRUHHYHQWKRXJKWKH\ERWKTXHULHGWKHVDPHFRQGLWLRQRQWKH
VDPHWDEOHDQGGLGQRWKDYHWRUHWXUQDQ\URZV

0DQDJLQJ6FKHPDV

+RZLWZRUNV
%DFNLQZHÀOHG0\64/%XJhttp://bugs.mysql.com/bug.php?id=7074
ZKLFKUHSRUWVWKLVXQH[SHFWHGEHKDYLRU+HLNNL7XXULWKHLQYHQWRURI,QQR'%FRQÀUPHGRXU
JXHVVWKDW0\64/ÀUVWUHDGVDOOWKHFROXPQV\RXVSHFLI\LQDSELECTVWDWHPHQWIURPWKH
GDWDVWRUHEHIRUHDSSO\LQJWKHWHEREFRQGLWLRQWRWKHP7KLVLVXVXDOO\DJRRGLGHDEHFDXVH
LQFDVHWKHFULWHULDPDWFK\RXDOUHDG\KDYHDOOWKHGDWDDWKDQG+RZHYHUIRU%/2%FROXPQV
WKLVFDQTXLFNO\EHFRPHRYHUO\H[SHQVLYHLQWHUPVRIH[HFXWLRQWLPHEHFDXVHORWVPRUHGDWD
KDVWREHUHDGIURPGLVN
,QWKHSUHYLRXVH[DPSOHZKLFKLVWKHVDPHDVLQWKHEXJUHSRUWZHLQWHQWLRQDOO\LVVXHGWZR
TXHULHVWKDWGRQRWPDWFKDQ\URZV³DOOWKHYDOXHVRIintBKDYHEHHQVHWWRWKHFRQVWDQW
YDOXH³WRVKRZWKHHIIHFWYHU\FOHDUO\
2IFRXUVHWKLVLVRQO\DQLVVXHLI,QQR'%FDQQRWXVHDQLQGH[WRFKHFNIRUWKHWHEREFRQ
GLWLRQV,ILWÀQGVDVXLWDEOHRQHQR%/2%VZLOOEHUHDGLQWKHHDUOLHUH[DPSOHIRUDQ\RIWKH
TXHULHVQRPDWWHUZKLFKFROXPQVDUHUHTXHVWHGLQWKHSELECT+RZHYHUGHSHQGLQJRQWKH
H[HFXWLRQSODQWKHRSWLPL]HUJHQHUDWHV\RXPLJKWVWLOOHQGXSZLWKDVLWXDWLRQOLNHWKLVLIWKH
FLUFXPVWDQFHVDUHULJKW7KLVLVZKDWDFWXDOO\KDSSHQHGWRXV³ZKLFKLVKRZZHIRXQGRXW
DERXWWKHSUREOHPLQWKHÀUVWSODFH³DQGZDVWULFN\WRGLDJQRVH
6RLQWKHHQGWKHUHDUHWZRVWUDWHJLHVWRSUHYHQWWKLVIURPKLWWLQJ\RX
f
0DNHVXUHDOOTXHULHVDJDLQVWWKHWDEOHLQTXHVWLRQDUHFRYHUHGE\DQLQGH[
f
'RQRWXVHSELECT * RUDFRPSOHWHOLVWRIFROXPQVLQ\RXUTXHULHVDQGRQO\ORRN
XSWKHNH\YDOXHVRIWKHURZV\RXZDQWWRSURFHVV7KHQJRDQGUHWULHYHWKH%/2%
FROXPQVZLWKDQRWKHUTXHU\OHYHUDJLQJ3ULPDU\NH\ORRNXSV
:KLOHKDYLQJJRRGLQGH[HVLQSODFHLVDOZD\VDWKLQJWRVWULYHIRUZHDOVRVWURQJO\UHFRPPHQG
RQO\UHDGLQJWKHFROXPQV\RXDUHDFWXDOO\JRLQJWRXVHLQDQ\TXHU\(VSHFLDOO\XVLQJWKH
*ZLOGFDUGLQ\RXUSURJUDPVFDQPDNHWKHPVXVFHSWLEOHWRHUURUVZKHQ\RXKDYHWRPDNH
PRGLÀFDWLRQVWRWKHWDEOHVWUXFWXUH³FROXPQRUGHULQJEHLQJDJRRGFDQGLGDWH³LQWKHIXWXUH
$SDUWIURPPDNLQJ\RXUVRIWZDUHPRUHUREXVWLWFDQDOVRKHOSUHGXFHQHWZRUNORDGEHWZHHQ
WKHFOLHQWDQGWKHVHUYHU
7KHUH
VPRUH
,I\RXGRQRWZDQWWRXVHDUHDOÀOHIRUWKH%/2%FROXPQVFRQWHQWV\RXFDQHDVLO\FUHDWHDÀOH
ÀOOHGZLWKFRPSOHWHO\UDQGRPFRQWHQWVIURPWKH/LQX[RU0DF26;FRPPDQGOLQHOLNHWKLV
$ cd /tmp 
$ dd if=/dev/urandom of=blobfile bs=4096 count=16 
16+0 records in 
16+0 records out 
65536 bytes transferred in 0.008941 secs (7329882 bytes/sec)

&KDSWHU

:KDWWKLVGRHVLVUHDGIURPWKHSVHXGRGHYLFHFDOOHG/dev/urandomWKDWVLPSO\SURYLGHV
DFRQWLQXRXVVWUHDPRIDOPRVWUDQGRPE\WHVWKHifSDUDPHWHULVVKRUWIRULQSXWÀOH
DQGZULWHVEORFNVRIE\WHVbsPHDQVEORFNVL]HWRWKHRXWSXWÀOHofIRUVKRUW
FDOOHGblobfile
%\YDU\LQJWKHbsDQGcountSDUDPHWHUV\RXFDQFRQWUROWKHVL]HRI\RXURXWSXWÀOH
,GHQWLI\LQJGLIIHUHQFHVEHWZHHQWZR
VFKHPDV
(VSHFLDOO\ZKHQSUHSDULQJVRIWZDUHXSJUDGHVLWLVLPSRUWDQWWRNQRZWKHGLIIHUHQFHVEHWZHHQ
DSUHYLRXVUHOHDVH
VGDWDEDVHVFKHPDDQGWKHFXUUHQWSUREDEO\PRGLÀHGGHYHORSPHQW
YHUVLRQ7KHUHDUHVHYHUDOWRROVDYDLODEOHWRFUHDWHDUHSRUWRQWKHGLIIHUHQFHVEHWZHHQWZR
VFKHPDGHÀQLWLRQVWU\LQJWRPDNHVPDUWJXHVVHVDVWRZKDWZHQWRQ1HYHUWKHOHVVZH
IRXQGPRVWRIWKHPWREHRIRQO\OLPLWHGXVH7KLVLVPRVWO\GXHWRWKHIDFWWKDWZKHQHYHUDQ\
DXWRPDWHGWRROFRPSDUHVWZRVFKHPDGHÀQLWLRQVLWFDQQRWNQRZDERXWPDQ\DVSHFWVWKDW
DUHREYLRXVWRWKHKXPDQH\H
&RQVLGHUDVLPSOHFROXPQUHQDPHIRUH[DPSOH,QDSUHYLRXVVFKHPDYHUVLRQDFROXPQPLJKW
KDYHEHHQVLPSO\FDOOHGnameZKLOHLQWKHFXUUHQWUHOHDVHLWLVWREHFDOOHGlastname+DYLQJ
DORRNDWWKHROGDQGQHZLQGLYLGXDOWDEOHGHÀQLWLRQVZLOOQRWUHYHDOKRZHYHUWKDWWKRVHWZR
FROXPQVKDYHDQ\UHODWLRQVKLS0RVWDXWRPDWHGWRROVZLOOWHOO\RXWRDROP COLUMN nameDQG
ADD COLUMN lastname7KLVLVRIFRXUVHQRWZKDW\RXZDQWWRGREHFDXVHGRLQJWKDW\RX
ZRXOGORVHDOOWKHSHUVRQDOGDWDDOUHDG\VWRUHGLQWKHWDEOH
,QWKHHQGIURPRXUH[SHULHQFHLWLVWKHPRVWSULPLWLYHEXWDOVRWKHPRVWHIÀFLHQWZD\
WRFRPSDUHWZRVFKHPDVE\VLPSO\WH[WGLIÀQJWKHLUGHÀQLWLRQV7KLVLVZKDWZHZLOOGRLQ
WKLVUHFLSH
*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGSULYLOHJHVWRFUHDWHDVWUXFWXUHGXPSRIERWKWKHROGDQGWKH
QHZVFKHPDGHÀQLWLRQV,QWKHQH[WH[DPSOHZHDVVXPH\RXKDYHDOUHDG\GXPSHGWKH
VFKHPDGHÀQLWLRQVWRWZRÀOHVFDOOHGold.sqlDQGnew.sql<RXFDQÀQGWKHVHÀOHVRQWKH
ERRN
VZHEVLWHIRUGRZQORDG7KH\FRQWDLQLQIRUPDWLRQDERXWWKUHHWDEOHVFDOOHGTableA
TableBDQGTableCLQWKHtestVFKHPD
7DEOHGHÀQLWLRQVIRUTableADQGTableBDUHGLIIHUHQWLQVHYHUDOGHWDLOVZKLOHTableCLV
PLVVLQJFRPSOHWHO\LQnew.sql

0DQDJLQJ6FKHPDV

2Q0DF26;DQGDQ\/LQX[GLVWULEXWLRQWKHdiffFRPPDQGLVSDUWRIWKHXVXDO
RSHUDWLQJV\VWHPLQVWDOODWLRQ:LQGRZVXVHUVZLOOKDYHWRJHWKROGRIDFRS\RIDWH[W
FRPSDULVRQWRROVHSDUDWHO\7KHdiffFRPPDQGIRU:LQGRZVLVSDUWRIWKH8QL[8WLOLWLHV
http://unxutils.sourceforge.netZKLOH:LQ0HUJHLVDQRSHQVRXUFHJUDSKLFDO
XWLOLW\DQGFDQEHGRZQORDGHGIURPhttp://winmerge.org0DQ\PRGHUQWH[WHGLWRUVDQG
GHYHORSPHQWHQYLURQPHQWVOLNH(FOLSVHGRLQFOXGHDWH[WFRPSDULVRQIHDWXUHDVZHOO6RPH
RIWKHPDUHDYDLODEOHFURVVSODWIRUP
7KHVWHSVEHORZVKRZDVFUHHQVKRWXVLQJ:LQ0HUJH7KHVDPHLQIRUPDWLRQFDQEHREWDLQHG
XVLQJWKHdiffSURJUDP6HHWKH7KHUH
VPRUHVHFWLRQIRUGHWDLOV
+RZWRGRLW

3XWERWKold.sqlDQGnew.sqlLQDFRPPRQIROGHU

2SHQWKHPERWKLQ:LQ0HUJH<RXZLOOVHHDVFUHHQOLNHWKLV

<RXFDQVHHWKHGLIIHUHQFHVKLJKOLJKWHGE\FRORU7KHWRROWULHVWRDOLJQWKHWZRÀOHVVR
WKDWWKHOLQHVPDWFKXSWRPDNHWKHFRPSDULVRQHDVLHUWRXQGHUVWDQG

&KDSWHU


,GHQWLI\WKHGLIIHUHQFHVEHWZHHQWKHROGDQGQHZVFKHPDWD
EDVHGRQWKLVRXWSXWDQGIRUPXODWHWKHDSSURSULDWHALTER TABLEVWDWHPHQWV1HZ
WDEOHFUHDWLRQVDQGGURSSHGWDEOHVQHHGQRFKDQJHVRIFRXUVH)RUWKLVH[DPSOHWKH
IROORZLQJPRGLÀFDWLRQVDUHUHTXLUHG
mysql> ALTER TABLE test.TableA 
    CHANGE COLUMN col_A col_A_new INTEGER DEFAULT 1,
    MODIFY COLUMN col_C DATETIME NOT NULL
        DEFAULT '2009-01-01 00:00:00',
    DROP INDEX VAR_INDEX,
    ADD INDEX VAR_INDEX 
       USING BTREE(col_B(10)),
    ENGINE = InnoDB;
mysql> ALTER TABLE test.TableB 
    MODIFY COLUMN street VARCHAR(100) BINARY
        CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
    MODIFY COLUMN city VARCHAR(40) 
        CHARACTER SET utf8 COLLATE utf8_general_ci
        DEFAULT NULL,
    DROP PRIMARY KEY,
    ADD PRIMARY KEY  USING BTREE(ID),
    DROP INDEX IDX_ZIP,
    ADD INDEX IDX_ZIP(zipcode, city),
    ENGINE = InnoDB
    COMMENT = 'New B';
DROP TABLE test.TableC;

5HSHDWWKHVFKHPDGXPSIRUWKHDOWHUHGVFKHPDWDEOHVDQG
FRPSDUHDJDLQDJDLQVWWKHH[SHFWHGVFKHPD<RXVKRXOGQRWVHHDQ\PRUHVWUXFWXUDO
GLIIHUHQFHVLI\RXUPRGLÀFDWLRQVZHUHFRUUHFW
+RZLWZRUNV
7KHSULQFLSOHRIWKLVUHFLSHLVTXLWHVLPSOHDQGYHU\VWUDLJKWIRUZDUGFUHDWHDWH[WXDO
UHSUHVHQWDWLRQRIWKHFXUUHQWROGVFKHPDDQGWKHGHVLUHGQHZVFKHPDGHÀQLWLRQVDQG
FRPSDUHWKHP
%DVHGRQWKHUHVXOWDQG\RXUNQRZOHGJHDERXWWKHFRQWH[WRIWKHFKDQJHV\RXWKHQZULWHWKH
DSSURSULDWHALTER TABLEVWDWHPHQWVWRPLJUDWH\RXUVFKHPDIURPWKHROGWRWKHQHZYHUVLRQ
)LQDOO\\RXUHUXQWKHFRPSDULVRQWRPDNHVXUH\RXUPRGLÀFDWLRQVWDWHPHQWVZHUHGRLQJWKH
ULJKWWKLQJ

0DQDJLQJ6FKHPDV

7KHUH
VPRUH
)RUDXWRPDWLRQRUSXUHFRPPDQGOLQHDFFHVVWRVHUYHUVWKHWH[WXDORXWSXWRIWKHdiffWRRO
FDQEHPRUHVXLWDEOH0RVWYHUVLRQVRIdiffKDYHDZHDOWKRIRSWLRQVEXWWKHPRVWLPSRUWDQW
RQHLV-uSURGXFLQJDXQLÀHGdiffIRUPDWWHGRXWSXW
$ diff -u old.sql new.sql > difference.sql
7KHQHZO\FUHDWHGdifference.sqlÀOHZLOOFRQWDLQWKHVDPHLQIRUPDWLRQ:LQ0HUJHVKRZHG
YLVXDOO\EXWLQDVWDQGDUGL]HGWH[WXDOIRUPDW<RXFDQÀQGWKHdifference.sqlÀOHRQWKH
ERRN
VZHEVLWHWRR
,I\RXDUHIDPLOLDUZLWKWKHdiffWRROWKHRXWSXWVKRXOGEHSUHWW\REYLRXVWR\RX,IQRWKDYHD
ORRNDWWKHIROORZLQJVLPSOHH[DPSOHWDNHQIURPWKHUHFLSHVWHSVHDUOLHU
--- old.sql    2009-12-15 00:39:40.000000000 +0100
+++ new.sql    2009-12-15 00:39:35.000000000 +0100
7KHVHÀUVWWZROLQHVWHOO\RXZKLFKÀOHVZHUHFRPSDUHGZLWKRQHDQRWKHU7KHÀUVWOLQHLV
SUHÀ[HGZLWKWKUHHPLQXVVLJQV---WHOOLQJ\RXWKDWZKHQHYHURQHRIWKHIROORZLQJOLQHV
VWDUWVZLWKDPLQXVWKDWOLQHZDVWDNHQIURPWKHold.sqlÀOH
6LPLODUO\WKHVHFRQGOLQHLQIRUPV\RXWKDWDQ\VXEVHTXHQWOLQHVWDUWLQJZLWKDSOXVVLJQZDV
WDNHQIURPWKHnew.sqlÀOH
$IWHUWKDWWKHdiffWRROUHQGHUVOLQHVZLWKGLIIHUHQWFRQWHQWVIURPold.sqlDQGnew.sql
OLNHWKLV
 CREATE TABLE  `test`. `TableA` (
   `A_ID` int(11) NOT NULL AUTO_INCREMENT,
-  `col_A` int(11) NOT NULL DEFAULT '1', 
+  `col_A_new` int(11) DEFAULT '1',
7KHÀUVWWZROLQHVVHUYHWRJLYHVRPHFRQWH[WWKDWZDVLGHQWLFDOLQERWKÀOHV7KLVDOORZV\RX
DQGDXWRPDWLFWRROVUHDGLQJWKHGLIIRXWSXWWREHWWHUXQGHUVWDQGZKHUHWKHGLIIHULQJOLQHV
ZHUHIRXQGLQWKHLQSXWÀOHV
,QWKLVFDVHZHFDQFOHDUO\VHHWKDWWKHGHÀQLWLRQRITableAZDVFKDQJHG7KHOLQHVWDUWLQJ
ZLWK-VKRZVZKDWLWORRNVOLNHLQWKHold.sqlÀOHWKHOLQHGLUHFWO\EHORZSUHÀ[HGZLWK+LV
WKHQHZYHUVLRQ6R\RXVHHWKDWWKHFROXPQZDVUHQDPHGIURPcol_AWRcol_A_newZKLOH
DWWKHVDPHWLPHGURSSLQJWKHNOT NULLFRQVWUDLQW7KLVFKDQJHZLOOQHHGWREHWDNHQFDUH
RIZLWKDQALTER TABLEVWDWHPHQWWRPLJUDWHTableAIURPWKHROGWRWKHQHZVFKHPD
:LWKVRPHSUDFWLFHUHDGLQJWKLVRXWSXWZLOOEHFRPHVHFRQGQDWXUHWR\RX+RZHYHULI\RXGR
QRWZDQWWRPHQWDOO\SDUVHWKLVIRUPDWZHUHFRPPHQGRQHRIWKHPDQ\JUDSKLFDOGLIÀQJWRROV
DYDLODEOH,I\RXFDQQRWXVHWKHVHWKHdiffFRPPDQGKDVD-y RSWLRQWKDWGLVSOD\VWKHWZR
ÀOHVVLGHE\VLGH

&KDSWHU

7KHGLIIHUHQFHVDUHPDUNHGE\WKHFKDUDFWHUVLQWKHPLGGOHEHWZHHQWKHÀOHFRQWHQWV)RU
PRUHLQIRUPDWLRQFRQVXOW\RXUdiffFRPPDQG
VPDQSDJH
6HHDOVR
f
&RPSDULQJVFKHPDUHYLVLRQVXVLQJKDVKYDOXHV
&RPSDULQJVFKHPDUHYLVLRQVXVLQJ
KDVKYDOXHV
:KHQGHDOLQJZLWKVRIWZDUHSURGXFWYHUVLRQLQJ\RXDOPRVWLQYDULDEO\ZLOOEHIDFLQJDVLWXDWLRQ
ZKHUH\RXKDYHWRXSJUDGHDGDWDEDVHVFKHPDIURPRQHYHUVLRQWRDQHZHURQH7KHSUREOHP
QRZLVWKDWHYHQZLWKUREXVWVFULSWV\RXFDQQRWEHVXUHWKDW\RXUXSGDWHVZLOOZRUN
FRUUHFWO\XQOHVV\RXDUHSHUIHFWO\VXUHWKH\DUHDSSOLFDEOHWRDFXUUHQWVFKHPDUHOHDVHRQ
DFOLHQW
VFRPSXWHU7KLVLVHYHQPRUHWUXHZKHQWKHXSGDWHVDUHUXQXQDWWHQGHGZKLFKLV
DVFHQDULRZHRIWHQIDFHZKHQVLOHQWO\XSJUDGLQJVHYHUDOKXQGUHG0\64/LQVWDQFHVDFURVV
VHYHUDOFRXQWULHV
$SSO\LQJDQXQVXLWDEOHVHWRIALTER TABLERUHYHQDROP TABLEFRPPDQGVWRDGDWDEDVH
PLJKWOHDGWRXQUHFRYHUDEOHGDWDORVVDQGDEURNHQV\VWHP7KLVLVVRPHWKLQJ\RXZLOOZDQWWR
DYRLGDWDQ\FRVW
$VLPSOHZD\WRWU\WRPDNHVXUH\RXNQRZZKDW\RXDUHGHDOLQJZLWKZRXOGEHWRMXVW
FRPSDUHWKHYHUVLRQRIWKHDFFRPSDQ\LQJDSSOLFDWLRQRUWKHFRQWHQWVRIVRPHÀFWLRQDO
VSHFLDOschema_versionWDEOHWKDWJHWVXSGDWHGZLWKHYHU\QHZVRIWZDUHUHOHDVH+RZHYHU
WKLVLVQRWYHU\UHOLDEOHDQGSUREDEO\MXVWQRWJRRGHQRXJKLI\RXQHHGWRDSSO\FULWLFDOFKDQJHV

0DQDJLQJ6FKHPDV

,QWKLVUHFLSHZHSUHVHQWDZD\WRFDOFXODWHFKHFNVXPVIRUWDEOHVFKHPDVWKDWHQDEOH\RXWR
YHULI\EH\RQGGRXEWLI\RXDUHGHDOLQJZLWKDZHOONQRZQYHUVLRQWKDWKDVQRWEHHQPRGLÀHG
7KLVLVEDVHGRQFU\SWRJUDSKLFFKHFNVXPVWKDWZHUHVSHFLÀFDOO\GHVLJQHGIRUWKLVSXUSRVH
8VLQJDQDSSURDFKOLNHWKLVLVVXSHULRUWRVD\Dschema_versionWDEOHEHFDXVHWKDWFRXOG
HDVLO\JHWRXWRIV\QFZLWKUHDOLW\EHLWGXHWRVRPHRQHSDWFKLQJWKHGDWDEDVHRUVLPSO\
EHFDXVHVRPHGHYHORSHUIRUJHWVWRFKDQJHWKHYHUVLRQQXPEHUZKHQWKH\PDNHWKHLUQH[W
VFKHPDPRGLÀFDWLRQ
7KLVPHWKRGZLOOWHOO\RXZKHWKHUDVFKHPDFRQIRUPVWRDJLYHQZHOONQRZQ
YHUVLRQ\RXWHVWHG\RXUPRGLÀFDWLRQVZLWK,WZLOOQRWWHOO\RXZKDWWKHH[DFW
GLIIHUHQFHVDUHEXWUDWKHUZKLFKRIWKHPDQ\SRVVLEOHVFKHPDYHUVLRQV\RX
DUHFXUUHQWO\GHDOLQJZLWK
7KHPDMRUEHQHÀWRIXVLQJWKLVKDVKEDVHGDSSURDFKLVWKDW\RXFDQXVHLWWRXQLTXHO\LGHQWLI\
DQ\JLYHQVFKHPDYHUVLRQ7KLVLVYHU\KDQG\ZKHQ\RXDUHWUDFNLQJDZKROHORWRIGLIIHUHQW
YHUVLRQVEHFDXVHWKHKDVKYDOXHVDUHYHU\VKRUWDQGUHOLHYH\RXIURPFDUU\LQJDURXQGDOOWKH
KLVWRULFYHUVLRQVRIVFKHPDV\RXPLJKWKDYH,QVWHDG\RXUXSJUDGHSURFHVVFRXOGFKRRVH
IURPDVHYHUDODYDLODEOHXSGDWHVFULSWVWKHRQHWKDWLVVXLWDEOHIRUXSJUDGLQJWRWKHPRVW
UHFHQWYHUVLRQWKHSDUWLFXODUVFKHPDLWLGHQWLÀHGRQWKHWDUJHWPDFKLQH
*HWWLQJUHDG\
7RIROORZDORQJ\RXZLOOQHHGRSHUDWLQJV\VWHPDQG0\64/XVHUDFFRXQWVZLWKSULYLOHJHV
VXIÀFLHQWWRUXQDmysqldumpFRPPDQGWDUJHWHGDWWKHVFKHPD\RXZRXOGOLNHWRFDOFXODWHD
KDVKYDOXHIRU,QWKLVH[DPSOHZHZLOOEHXVLQJWKHtestGDWDEDVHVFKHPDWKDWFRQWDLQVWZR
WDEOHVTableADQGTableB7KHH[DFWGHÀQLWLRQRIWKRVHWDEOHVLVQRWUHDOO\LPSRUWDQW<RX
FDQXVHDQ\RWKHUVFKHPDDVZHOO+RZHYHUWRWU\RXWSURYRNLQJDKDVKFKHFNVXPPLVPDWFK
\RXZLOOKDYHWRPDNHDWOHDVWVRPHPLQRUPRGLÀFDWLRQWRWKHVFKHPD\RXSLFN
7KHSURJUDPXVHGKHUHWRFDOFXODWHWKHKDVKYDOXHVLVZULWWHQLQ-DYD7KLVLVQRWPDQGDWRU\
RIFRXUVHWKHJHQHUDOSULQFLSOHFDQEHLPSOHPHQWHGLQDQ\ODQJXDJH\RXOLNH:HFKRVH-DYD
EHFDXVHLWLVDYDLODEOHIRUSUDFWLFDOO\DQ\SODWIRUPDQGLVRIWHQLQVWDOOHGDQ\ZD\HVSHFLDOO\RQ
:LQGRZVZKHUHLWLVSUREDEO\PRUHFRPPRQWKDQ3HUOIRUH[DPSOH
,I\RXGRQRWKDYHD-DYD5XQWLPH(QYLURQPHQW-5(LQVWDOOHG\HWSOHDVHGRZQORDGDQG
LQVWDOOLWEHIRUH\RXSURFHHG7KHPDFKLQH\RXLQVWDOOLWRQQHHGQRWEHWKH0\64/VHUYHU
PDFKLQHEXWFDQEH\RXUZRUNVWDWLRQLQVWHDG+RZHYHU\RXZLOOKDYHWREHDEOHWRFRQQHFWWR
WKH0\64/VHUYHUYLDWKHQHWZRUNLQWKDWFDVHZKLFKPLJKWEHUHVWULFWHGE\WKH0\64/XVHU
DFFRXQWVHWXSRU\RXUFRPSDQ\
VQHWZRUNÀUHZDOOV
$GHVFULSWLRQRIWKHDOJRULWKPXVHGE\WKHSURJUDPFDQEHIRXQGLQWKH+RZLWZRUNVVHFWLRQ

&KDSWHU

+RZWRGRLW

'RZQORDGWKHdbhash.jarÀOHIURPWKHERRN
VZHEVLWH,WFRQWDLQVDSUHFRPSLOHG
UXQQDEOHYHUVLRQRIWKHdbhashWRRO

2QDFRPPDQGOLQHHQWHUWKHIROORZLQJFRPPDQGVXEVWLWXWLQJ\RXURZQVHUYHU
GDWDEDVHDQGXVHUQDPHVDSSURSULDWHO\
$ java -jar dbhash.jar /usr/bin/mysqldump localhost 3306 test root 
rootpw

7KHÀUVWSDUDPHWHULVWKHSDWKWRWKHmysqldumpWRRO7KHQ
IROORZVWKH0\64/KRVWlocalhostDQGSRUW3306WKHGDWDEDVHVFKHPDtest
DQGWKHQWKHXVHUQDPHrootWRXVHDQGLWVDVVRFLDWHGSDVVZRUGrootpw

:ULWHGRZQWKHUHVXOWLQJRXWSXWWKLVLVDXQLTXHÀQJHUSULQWYDOXHRIWKH
GDWDEDVHVFKHPD
2SWLRQDOO\FRQQHFWWRWKHGDWDEDVHDQGPDNHDQ\FKDQJHWRWKHGDWDEDVHVFKHPD)RU
H[DPSOHDGGDQRWKHUWDEOH
mysql> CREATE TABLE  test.TableC (
 ID_C int(11) NOT NULL AUTO_INCREMENT,
 PRIMARY KEY (ID_C) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8;

5HUXQWKHVDPHFRPPDQGDJDLQ
$ java -jar dbhash.jar /usr/bin/mysqldump localhost 3306 test root 
rootpw

&RPSDUHWKHQHZKDVKYDOXHZLWKWKHSUHYLRXV
RQH7KH\ZLOOEHFRPSOHWHO\GLIIHUHQW7KLVSURYHVEH\RQGGRXEWWKDWWKHVFKHPDZDV
PRGLÀHGEHWZHHQWKHWZRUXQVRIWKHKDVKLQJWRRO,I\RXGURSSHGWKHWDEOHDJDLQDQG
UDQWKHSURJUDPDWKLUGWLPH\RXZRXOGJHWWKHVDPHKDVKYDOXHDVWKHÀUVWWLPH

%HIRUHUHOHDVLQJDQ\
QHZVFKHPDYHUVLRQRI\RXUGDWDEDVHUXQWKHKDVKLQJWRRODQGUHFRUGWKHFDOFXODWHG
YDOXHWRJHWKHUZLWKWKHYHUVLRQQXPEHU%\GRLQJVR\RXFDQEXLOGXSDFRPSOHWHOLVW
RIVXSSRUWHGGDWDEDVHVFKHPDYHUVLRQVEHLQJVXUHWRUHFRJQL]HWKHPEH\RQGGRXEW

0DQDJLQJ6FKHPDV

+RZLWZRUNV
&RQWDLQHGLQWKHdbhash.jarÀOHLVDSURJUDPWKDWGRHVWKHIROORZLQJ
f
&RQQHFWWRWKH0\64/VHUYHUE\UXQQLQJWKHmysqldumpFRPPDQGIURPWKHSURYLGHG
ORFDWLRQ,WZLOODXWRPDWLFDOO\XVHWKHFRUUHFWSDUDPHWHUVWRUHWULHYHDVWUXFWXUHRQO\
GXPS1RGDWDEDVHFRQWHQWVZLOOEHUHDG
f
$SSO\VRPHSURFHVVLQJWRWKHUHWULHYHGGXPS:KDWWKLVSULPDULO\GRHVLVVRUWFRQ
VWUDLQWDQGLQGH[GHÀQLWLRQVWRKDYHWKHPFRQIRUPWRDSUHGLFWDEOHRUGHULQJ7KLV
IRUPDWQRUPDOL]DWLRQLVLPSRUWDQWEHFDXVHWKHFU\SWRJUDSKLFKDVKLQJIXQFWLRQWKDW
LVJRLQJWREHXVHGZLOOSURGXFHGLIIHUHQWUHVXOWVHYHQZKHQWKHRQO\GLIIHUHQFH
EHWZHHQWZRUXQVLVLQWKHRUGHULQJRIWKRVHmysqldumpGRHVQRWSURYLGHD
FRPSOHWHO\SUHGLFWDEOHRUGHUUHJDUGLQJWKHRXWSXWRIVXFKLQIRUPDWLRQ0RUHRYHU
ZKLWHVSDFHZLOOEHUHPRYHGWRPDNHVXUHQRSODWIRUPVSHFLÀFOLQHHQGLQJVZLOO
LQÁXHQFHWKHUHVXOW
f
$6+$KDVKRIWKHQRUPDOL]HGVFKHPDGHÀQLWLRQLVFDOFXODWHGDQGSULQWHG)RUPRUH
LQIRUPDWLRQRQWKLVDOJRULWKPSOHDVHUHIHUWRhttp://en.wikipedia.org/ 
wiki/
Sha-17KHPDLQFKDUDFWHULVWLFRIDQ\KDVKIXQFWLRQLVWKDWHYHQDVOLJKWFKDQJHLQ
WKHLQSXWZLOOSURGXFHFRPSOHWHO\GLIIHUHQWDQGQRQUHYHUVLEOHUHVXOWV7KLVHQVXUHV
WKDWQRWZRGLIIHUHQWLQSXWVZLOOHYHUKDYHWKHVDPHKDVKYDOXH7KHUHIRUHE\
FRPSDULQJWKHUHVXOWVRIWZRUXQVDJDLQVWWZRGDWDEDVHVFKHPDV\RXNQRZIRUVXUH
LIWKH\DUHSHUIHFWO\LGHQWLFDORUKDYHHYHQWKHVOLJKWHVWGLIIHUHQFH
7KHUH
VPRUH
<RXFDQDFFHVVWKHSURJUDP
VVRXUFHFRGHE\GRZQORDGLQJWKHdbhash-src.zipÀOHIURP
WKHERRN
VZHEVLWH<RXZLOOÀQGDsrcIROGHULQVLGHLWZLWKWKHIXOOVRXUFHFRGHRIWKHSURJUDP
6HHDOVR
f
,GHQWLI\LQJGLIIHUHQFHVEHWZHHQWZRVFKHPDV

*RRGWR.QRZ
,QWKLVFKDSWHUZHZLOOFRYHU
f
$YRLGLQJVLOHQWUHSOLFDWLRQGLVUXSWLRQRQIXOOPDVWHUGLVN
f
0D[LPL]LQJXVDEOHPHPRU\RQELW:LQGRZV
f
8VLQJVHSDUDWHWHPSRUDU\GLUHFWRULHVIRUPXOWLSOH0\64/VHUYHUVRQDVLQJOH
PDFKLQHSUHYHQWLQJFRQÁLFWV
f
1RQDYDLODELOLW\RI,QQR'%PD\HVFDSHPRQLWRULQJ
f
7URXEOHVKRRWLQJ&DQ
WVWDUWVHUYHU%LQGRQ7&3,3SRUW1RVXFKÀOHRUGLUHFWRU\
f
&KRRVLQJFKDUDFWHUVHWV
f
8QGHUVWDQGLQJDXWRLQFUHPHQWYDOXHV
,QWURGXFWLRQ
7KLVDSSHQGL[LVDFROOHFWLRQRIVHYHUDOSLHFHVRILQIRUPDWLRQZHGHHPHGLPSRUWDQWIRU
D0\64/DGPLQLVWUDWRUWRNQRZEXWZKLFKGLGQRWUHDOO\ÀWWKHVW\OHRIDUHFLSHDVVXFK
+RZHYHUPDQ\RIWKHLVVXHV\RXZLOOÀQGKHUHWRRNXVKRXUVRUVRPHWLPHVGD\VWRÀJXUH
RXW:HZRXOGOLNHWRVSDUH\RXWKLVWLPHE\PDNLQJRXUH[SHULHQFHVDYDLODEOHKHUH
1DWXUDOO\\RXQHHGQRWUHDGWKLVFKDSWHUIURPEHJLQQLQJWRHQG³MXVWDVLQWKHUHVWRIWKH
ERRNDOOLWHPVVKRXOGEHLQGLYLGXDOO\XVHIXODQGXQGHUVWDQGDEOH

*RRGWR.QRZ

$YRLGLQJVLOHQWUHSOLFDWLRQGLVUXSWLRQRQIXOO
PDVWHUGLVN
:KLOHXVLQJUHSOLFDWLRQ\RXPLJKWH[SHULHQFHFRUUXSWHGRULQFRPSOHWHELQORJÀOHVRQWKH
PDVWHUZKHQWKHGLVNWKH\JHWVWRUHGRQEHFRPHVIXOO,QROGHUYHUVLRQVWKHÀOHZRXOGEH
VWDUWHGDQGZKHQWKHGLVNEHFDPHIXOOLQWKHPLGGOHRIDQHYHQWEHLQJZULWWHQWKLVSDUWLDO
GDWDZRXOGEHUHSOLFDWHGDQGFDXVHHUURUVRQWKHVODYHV
9HUVLRQVDQGXSKDQGOHDQRXWRIVSDFHVLWXDWLRQPRUHJUDFHIXOO\DVWKH\GRQRWZULWH
SDUWLDOVWDWHPHQWVWRWKHELQORJDQGWU\KDUGHUWRNHHSWKHWDEOHGDWDDQGWKHELQORJLQV\QF
+RZHYHU\RXVWLOOQHHGWREHDZDUHWKDWWKHUHLVQRSHUFHQWVXUHZD\RISUHYHQWLQJ
SUREOHPVRQWKHVODYHVEHFDXVHXQGHUFHUWDLQFLUFXPVWDQFHV\RXFDQHQGXSZLWKWKHODVW
VWDWHPHQWKDYLQJH[HFXWHGLQWKHGDWDEDVHEXWQRWUHFRUGHGLQWKHELQORJ
7KHPDVWHUVHUYHUZLOOORJWKLVIDFWLQWRLWVORJÀOHVR\RXUPRQLWRULQJV\VWHPPLJKWSLFNWKLVXS
ZLWKOLQHVOLNH
The binary log <name> is shorter than its expected size. 
EXWVWLOOWKHSUREOHPUHPDLQV
7KH0\64/PDQXDOKDVPRUHGHWDLOVDERXWWKLVLQFKDSWHUVDWhttp://dev.mysql.
com/doc/refman/5.1/en/binary-log.htmlDQG%RQGLVNIXOOSUREOHPVDW
http://dev.mysql.com/doc/refman/5.1/en/full-disk.html
7KHERWWRPOLQHDERXWWKLVKRZHYHULVWKDWHYHQZLWKWKHPRVWFRQVHUYDWLYH
VHWWLQJV³--sync_binlog=1DQG--innodb_support_xa=1OHDGLQJ
WRUHGXFHGSHUIRUPDQFHGXHWRPRUHGLVNV\QFV³\RXFDQVWLOOHQGXSZLWK
LQFRPSOHWHELQORJVEHLWRQ0\64/
VSDUWRUWKHRSHUDWLQJV\VWHP
VUHTXLULQJ
\RXWRUHVHWWKHUHSOLFDWLRQDQGPDQXDOO\UHV\QFWKHVODYHVIURPDIUHVKGXPS
&RQVLGHULQJWKHSHUIRUPDQFHSHQDOWLHVWKHRSWLRQV0\64/RIIHUVWROLPLWWKHULVNVRIGDPDJLQJ
WKHELQORJVDQGWKHIDFWWKDWWKH\GRQRWJXDUDQWHHSUREOHPIUHHRSHUDWLRQVDQ\ZD\ZH
UHFRPPHQGLQYHVWLQJ\RXUUHVRXUFHVLQDUHOLDEOHV\VWHPPRQLWRULQJVROXWLRQWKDWZLOONHHS
\RXLQIRUPHGDERXWFULWLFDOFRQGLWLRQVUHJDUGLQJGLVNVSDFHDQGDOORZ\RXWRSUHYHQWWKHVH
SUREOHPVLQWKHÀUVWSODFH

$SSHQGL[

0D[LPL]LQJXVDEOHPHPRU\RQELW
:LQGRZV
0\64/LVDFURVVSODWIRUPSLHFHRIVRIWZDUHZLWKYHUVLRQVDYDLODEOHIRUDOOPDMRURSHUDWLQJ
V\VWHPVDQGHYHQHPEHGGHGGHYLFHV0DQ\HQWHUSULVHOHYHOVHUYHUVQRZDGD\VDUHELW
KDUGZDUHDQGRSHUDWLQJV\VWHPFRPELQDWLRQV+RZHYHUDWWKHWLPHRIZULWLQJWKLVERRN
WKHUH
VVWLOODODUJHQXPEHURIELWV\VWHPVLQDFWLYHXVH
/LPLWDWLRQVRIELWV\VWHPV
2QHRIWKHPDMRUOLPLWDWLRQVRIELWV\VWHPVLVWKHLULQKHUHQWOLPLWRIDPD[LPXPRI*%
DGGUHVVVSDFHSHUSURFHVVPHDQLQJWKDWQRSURFHVVRQVXFKDV\VWHPFDQHYHUDGGUHVV
PRUHWKDQ*%RIPHPRU\+RZHYHURQW\SLFDOELWRSHUDWLQJV\VWHPVWKHUHLVDQHYHU
ORZHUOLPLWLQSODFH2Q:LQGRZVWKLVDGGUHVVVSDFHLVVSOLWLQKDOI*%IRUWKHDSSOLFDWLRQ
DQG*%RIUHVHUYHGDGGUHVVHVIRUNHUQHOXVH,QWKLVKDOIRIWKHDGGUHVVVSDFHWKHUHDUH
DUHDVUHVHUYHGIRUDOOVRUWVRIKDUGZDUHLQWHUIDFHVLQFOXGLQJJUDSKLFVFDUGVDQGH[WHQVLRQ
FDUGV³SUHFLRXVDGGUHVVHVWKDWFDQQRWEHXVHGWRDGGUHVVE\WHVLQ5$0FKLSV
,QHIIHFWWKLVPHDQVWKDWDQ\SURFHVV³LQFOXGLQJD0\64/VHUYHU³FDQXVHDWPRVW*%
RIFRPELQHG5$0RQDELW:LQGRZVV\VWHP7KLVLVHYHQWUXHIRUV\VWHPVUXQQLQJIRU
H[DPSOH:LQGRZV6HUYHU(QWHUSULVH(GLWLRQZKLFKVXSSRUWVPXFKPRUHSK\VLFDOPHPRU\
LQDPDFKLQHXVLQJVRPHFOHYHUWULFNHU\(YHQWKRXJKLQWRWDOWKH\FDQVXSSRUWPDQ\
*LJDE\WHVRIPHPRU\WKHSHUSURFHVVOLPLWVVWLOODSSO\
,PSDFWRQ0\64/,QQR'%
)RUDW\SLFDO,QQR'%FHQWULF0\64/FRQÀJXUDWLRQ\RXZRXOGXVXDOO\DVVLJQPRVWRIWKH
DYDLODEOH*%SHUSURFHVVWRWKH,QQR'%EXIIHUSRROFRQÀJXUDWLRQVHWWLQJinnodb_buffer_
pool_size+RZHYHU\RXZLOORIWHQQRWLFHWKDWHYHQWKRXJKWKHWRWDORIDOOEXIIHUVL]HVLV
OHVVWKDQWKLVOLPLW\RXPLJKWVWLOOHQGXSZLWKHUURUPHVVDJHVZKHQWU\LQJWRVWDUWWKHVHUYHU
WKDWORRNOLNHWKLV

*RRGWR.QRZ

,QWKLVH[DPSOHZHWULHGD0%EXIIHUSRROVL]H7KLVNLQGRISUREOHPLVUHJXODUO\FDXVHG
E\PHPRU\IUDJPHQWDWLRQ,QQR'%WULHVWRDOORFDWHDODUJHFRQWLJXRXVDUHDRIWKHDGGUHVV
VSDFHIRUWKHEXIIHUSRROKHUH+RZHYHUHYHQEHIRUHWKLVWDNHVSODFHWKHRSHUDWLQJV\VWHPPD\
KDYHORDGHGVKDUHGOLEUDULHV'//VLQWRWKH*%XVHUDGGUHVVVSDFHDYDLODEOHWRWKHSURFHVV
0x000000000x7FFFFFFHIIHFWLYHO\VSOLWWLQJWKHDYDLODEOHDGGUHVVUDQJHVRWKDW,QQR'%
FDQQRWJHWDODUJHHQRXJKFRQWLJXRXVFKXQNIRULWVEXIIHUSRRO6XFKOLEUDULHVFDQEHSDUWRI
DQWLYLUXVVROXWLRQVRUPDQDJHPHQWVXLWHVWKDWQHHGWRKRRNRQWRDOOSURFHVVHVLQDV\VWHP
7KHIUHHO\DYDLODEOH6\VLQWHUQDOV3URFHVV([SORUHUWRROGRZQORDGDEOHIURP0LFURVRIW
VZHEVLWH
DWhttp://technet.microsoft.com/en-us/sysinternals/bb896653.aspxFDQ
KHOS\RXÀQGRXWGHWDLOVLQVLWXDWLRQVOLNHWKLV
,QWKHSUHYLRXVVFUHHQVKRW\RXFDQVHHD0\64/SURFHVVWKDWKDVLWVDGGUHVVVSDFH
IUDJPHQWHGE\WZR'//VVHHWKHORZHUSDQH³RQHSDUWRI6RSKRV$QWLYLUXVDQGWKHRWKHU
SDUWRIWKH1HW,QVWDOOVRIWZDUHPDQDJHPHQWVXLWH%RWK'//VWDNHXSRQO\DVPDOODPRXQWRI
PHPRU\IRUWKHPVHOYHVKRZHYHUWKHLUSRVLWLRQLQWKHDGGUHVVVSDFHPDNHVWKHPDSUREOHP
IRU,QQR'%7KH6RSKRV%XIIHU2YHUUXQ3URWHFWLRQ/LEUDU\LVORDGHGDWDGGUHVV0x552F0000
7KLVLVRQO\0%IURPWKHVWDUWDGGUHVVRImysqld-nt.exe0x40000DQGSUHYHQWVD
0%EORFNIURPEHLQJDVVLJQHG,IWKH\ZHUHORFDWHGDWWKHIDUHQGRIWKHDGGUHVVUDQJH
,QQR'%FRXOGDOORFDWHDEORFNRIPHPRU\ODUJHHQRXJKWRIXQFWLRQ&RPSDUHWKLVZLWKWKHQH[W
SLFWXUHZKHUHWKHDQWLYLUXVVRIWZDUHKDVEHHQUHPRYHGIURPWKHV\VWHP

$SSHQGL[

,QWKLVVHWXS,QQR'%FDQVWDUWMXVWÀQHEHFDXVHWKHUHLVDFRQWLJXRXVUDQJHIUHHIURP
0x400000WR0x641F0000VL]HG0%6HHWKHIROORZLQJVFUHHQVKRWVKRZLQJWKH
,QQR'%VWDWXVRXWSXWVHFWLRQSURGXFHGE\HQWHULQJSHOW ENGINE INNODB STATUS\GRQ
D0\64/FRPPDQGOLQHWHOOLQJ\RXDERXWWKHQXPEHURIDYDLODEOH.%SDJHVLQWKH
EXIIHUSRRO7KLVLVH[DFWO\WKH0%WKHFRQÀJXUDWLRQYDULDEOH
innodb_buffer_pool_sizeLVVHWWRLQWKLVVHUYHU
Vmy.iniÀOH
8VXDOO\ZHZRXOGUHFRPPHQGDVZLWFKWRPRUHFDSDEOHELWKDUGZDUHDQG
RSHUDWLQJV\VWHPVHWXSVLIWKHVHPHPRU\OLPLWVEHFRPHDQLVVXH+RZHYHU
WKHUHPLJKWVRPHWLPHVEHH[WHUQDOIDFWRUVSUHYHQWLQJWKDW

*RRGWR.QRZ

,I\RXKLWDSUREOHPOLNHWKLV\RXKDYHWRWU\WRGHFLGHZKHWKHUHLWKHU\RXFDQJHWULGRIWKH
SUREOHPDWLFOLEUDULHVFRPSOHWHO\E\QRWXVLQJWKHSURJUDPWKH\DUHDVVRFLDWHGZLWKRU\RX
VKRXOGFRQWDFWWKHLUUHVSHFWLYHYHQGRUVWRÀQGRXWLIWKH\FDQSURYLGHDGLIIHUHQWYHUVLRQRIWKH
VDPH'//WKDWJHWVORDGHGLQWRDPRUHFRQYHQLHQWDGGUHVVUDQJH
:DUQLQJ
(GLWLQJWKHUHJLVWU\FDQVHYHUHO\GDPDJH\RXUV\VWHPVHWXSXSWRWKHSRLQWRI
QRWEHLQJDEOHWRERRWRUDFFHVVLWDWDOOVRPDNHVXUH\RXNQRZZKDW\RXDUH
GRLQJ*HWLQFRQWDFWZLWKDQ\VRIWZDUHYHQGRUZKRVHOLEUDULHV\RXGLVDEOHGWR
JHWFOHDUDQFHWRWU\WKLVVRPHOLEUDULHVPLJKWEHYLWDOIRU\RXUV\VWHP
WRIXQFWLRQ
:HVWURQJO\UHFRPPHQGPDNLQJDV\VWHPEDFNXSEHIRUH\RXSURFHHGZLWKWKLV
)RUWHVWLQJ\RXFDQPRGLI\WKHHKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows 
NT\CurrentVersion\Windows\AppInit_DLLsUHJLVWU\NH\WRFRQWUROZKLFK'//VJHW
ORDGHGZKHQDSURFHVVVWDUWV$IWHUPDNLQJVXUHWKLVZLOOQRWDIIHFWWKHVWDELOLW\RI\RXU
V\VWHPUHPRYHWKH'//VLQTXHVWLRQIURPWKLVNH\DQGUHVWDUWWKH0\64/VHUYHU9HULI\LI\RX
FDQQRZXVHDODUJHUDPRXQWRIPHPRU\
*HWWLQJHYHQPRUHZLWKWKH*%VZLWFK
7RJHWHYHQPRUHPHPRU\DYDLODEOHWR0\64/RQELWV\VWHPV\RXPLJKWFRQVLGHUXVLQJ
WKH*%ERRWSDUDPHWHU7KLVSDUDPHWHUZKLFKFDQEHDGGHGWRWKHboot.iniÀOHZLOOWHOO
:LQGRZVWKDW\RXLQWHQGWRUXQSURJUDPVWKDWQHHGPRUHWKDQ*%RIDGGUHVVVSDFH
:KDWLWZLOOGRLVSUHVHQWSURJUDPVWKDWDUHSUHSDUHGIRULWWKH\QHHGWREHFRPSLOHGZLWK
VXSSRUWIRUWKLVZLWKD*%DGGUHVVUDQJHIRUDSSOLFDWLRQXVHDQGUHVHUYHRQO\*%IRU
NHUQHOSXUSRVHV0\64/YHUVLRQVDQGXSDQGDQGXSDUHFRPSLOHGWREHQHÀW
IURPWKLVFRQÀJXUDWLRQ+RZHYHUXVLQJLWFDQDGYHUVHO\DIIHFW\RXUV\VWHPLQRWKHUZD\V
5HIHUWRWKH0LFURVRIWZHEVLWHRUWKHLUVXSSRUWIRUPRUHLQIRUPDWLRQ
$OVRQRWHWKDWWKLVZLOOQRWHQDEOH\RXWRDOORFDWHPRUHWKDQ*%WRWKHEXIIHUSRRODORQH
KRZHYHUWKH0\64/VHUYHUFRXOGXVHWKHH[WUDVSDFHIRURWKHUEXIIHUV
7KHIROORZLQJVFUHHQVKRWZDVWDNHQRQD:LQGRZVPDFKLQHWKDWZDVERRWHGZLWKWKH*%
RSWLRQLQSODFHDQGVKRZVD0\64/VHUYHUSURFHVVXVLQJPRUHWKDQ*%

$SSHQGL[

7KLVLVWKH,QQR'%VWDWXVRXWSXWVKRZLQJD0%EXIIHUSRRORQDELWV\VWHP
8VLQJVHSDUDWHWHPSRUDU\GLUHFWRULHVIRU
PXOWLSOH0\64/VHUYHUVRQDVLQJOH
PDFKLQHSUHYHQWLQJFRQÁLFWV
:KHQHYHU\RXUXQPXOWLSOH0\64/VHUYHULQVWDQFHVZKLFKDUHSRVVLEOHE\FRQÀJXULQJ
GLIIHUHQWVRFNHWVRU7&3SRUWV\RXQHHGWRPDNHVXUHWRDOVRFRQÀJXUHDGLIIHUHQWWHPSRUDU\
GLUHFWRU\IRUHDFKLQVWDQFH
7KLVLVQRWFOHDUO\GRFXPHQWHGDQGRIWHQLWZLOOZRUNÁDZOHVVO\HYHQLIWKH\VKDUHDFRPPRQ
WHPSRUDU\GLUHFWRU\,I\RXGRQRWVSHFLI\DFXVWRPGLUHFWRU\WKHV\VWHP
VWHPSRUDU\GLUHFWRU\
ZLOOEHXVHG
+RZHYHUDUHJXODUEHKDYLRURIWKH0\64/VHUYHULVWRFOHDQXSDQ\UHPDLQLQJWHPSRUDU\ÀOHV
LWPD\KDYHFUHDWHGDQGOHIWEHKLQGLQDSUHYLRXVUXQ:KLOHWKLVLVJHQHUDOO\DVHQVLEOHLGHD
WKHLPSOHPHQWDWLRQLVVRPHZKDWODFNLQJ8SRQVWDUWHDFKVHUYHUSURFHVVGHOHWHVDOOÀOHVIURP
LWVWHPSRUDU\GLUHFWRU\ZKRVHÀOHQDPHVVWDUWZLWK#sql³UHJDUGOHVVRIZKRFUHDWHGWKHP
ÀOHVLQWKHÀUVWSODFHDQGDVVXPLQJLWKDVVXIÀFLHQWDFFHVVULJKWV

*RRGWR.QRZ

$SUREOHPQRZDULVHVLIRQH0\64/VHUYHULVUXQQLQJDQGFXUUHQWO\XVLQJDWHPSRUDU\
ÀOHZKLFKZLOOKDYHDQDPHVWDUWLQJZLWK#sqlZKLOHDQRWKHULQVWDQFHFRPHVXS,Q
WKLVVLWXDWLRQWKHVHFRQGGDHPRQZLOOGHOHWHWKHÀOHWKHÀUVWLQVWDQFHLVFXUUHQWO\XVLQJ
'HSHQGLQJRQWKHÀOHV\VWHPDQGRSHUDWLQJV\VWHPWKLVZLOOFDXVHLVVXHV)RUH[DPSOH
64/VWDWHPHQWVLQWKHÀUVWDOUHDG\UXQQLQJVHUYHUZLOOIDLOZLWKDQ
ERROR 6 (HY000): Error on delete of 'C:\WINDOWS\TEMP\#sql_4a2c_1.MYI' 
(Errcode: 2)
HUURUEHFDXVHWKHWHPSRUDU\ÀOHKDVDOUHDG\EHHQGHOHWHGE\WKHRWKHUSURFHVV
7KHLVVXHLVGLVFXVVHGDV0\64/%XJDWhttp://bugs.mysql.com/bug.
php?id=47679$WWKHWLPHRIZULWLQJWKLVERRNWKHRQO\ZRUNDURXQGZDVWRFRQÀJXUH
GLVWLQFWWHPSRUDU\GLUHFWRULHVIRUHYHU\0\64/VHUYHULQVWDQFH\RXVWDUWXVLQJWKH
tmpdirFRQÀJXUDWLRQYDULDEOHLQHLWKHUWKHFRQÀJXUDWLRQÀOHRUDVDQDGGLWLRQDO
FRPPDQGOLQHSDUDPHWHU
3UHYHQWLQJP\VTOGXPSIURPIDLOLQJZLWK
(UURU
7KLVLVDGHVFULSWLRQRIKRZWRSUHYHQWmysqldumpIDLOXUHVWKDWDUHKDUGWRH[SODLQDQGRQO\
KDSSHQVSRUDGLFDOO\
'LDJQRVLQJWKHV\PSWRPV
:KHQWDNLQJEDFNXSVRIDGDWDEDVHFRQWDLQLQJODUJHURZV³XVXDOO\ZLWK%/2%FROXPQV³\RX
PLJKWVSRUDGLFDOO\H[SHULHQFHHUURUPHVVDJHVOLNH
mysqldump: Error 2013: Lost connection to MySQL server during query 
when dumping table `tablename` at row: 1342
2QHRIWKHVWUDQJHV\PSWRPVRIWKLVSUREOHPLVWKDWWKHURZQXPEHUPD\YDU\EHWZHHQUXQV
RIWKHLGHQWLFDOVWDWHPHQWRQDQXQFKDQJHGVHWRIGDWDDQGWKDWWKHUHVHHPVWREHQRWKLQJ
ZURQJZLWKWKHUHFRUGVVSHFLÀHGLQWKHHUURUPHVVDJH
:HUDQLQWRWKLVSUREOHPWLPHDQGDJDLQEXWYHU\LQIUHTXHQWO\RYHUWKHFRXUVHRIVHYHUDO
PRQWKV2IWHQUHVWDUWLQJWKHGXPSZRXOGPDNHWKHSUREOHPGLVDSSHDURQO\WRKDYHLWFRPH
XSDJDLQDIWHUDVHHPLQJO\XQSUHGLFWDEOHQXPEHURIVXFFHVVIXOUXQV
7KHSUREOHPZDVÀQDOO\GLDJQRVHGDQGLGHQWLÀHGDVGRFXPHQWHGLQ0\64/%XJDW
http://bugs.mysql.combug.php?id=46103

$SSHQGL[

)LQGLQJWKHFDXVH
:KHQmysqldumpUXQVLWZLOOFRQQHFWWRWKH0\64/VHUYHUXVLQJDQHWZRUNFRQQHFWLRQ³MXVW
OLNHDQ\RWKHU0\64/FOLHQW$VVXFKLWLVVXEMHFWWRWKHXVXDOVHWWLQJVHVSHFLDOO\WKHGLIIHUHQW
QHWZRUNWLPHRXWVDQGWKHmax_packet_sizeVHWWLQJ
:KDWPD\QRZKDSSHQZLWKODUJHWDEOHURZVLVWKDWWKHnet_write_timeoutPD\EHVHWWR
DWLPHOLPLWWKDWLVWRRVKRUWWRWUDQVIHUDZKROHGDWDSDFNHWRImax_packet_sizeE\WHV
OHQJWKIURPWKHVHUYHUWRWKHFOLHQWDQGZULWHLWWRWKHGLVNWKHUH)URPRXUH[SHULHQFHWKLV
PLJKWHYHQKDSSHQRQDORDGHGPDFKLQHZKHQmysqldumpLVFRQQHFWLQJYLDORFDOKRVW
7RWKH0\64/VHUYHUWKLVZLOOORRNDVLIWKHFOLHQWLVQRWUHVSRQGLQJDQ\PRUHDQGLWZLOO
WHUPLQDWHWKHFRQQHFWLRQDIWHUnet_write_timeoutVHFRQGVFDXVLQJWKHHUURUPHVVDJH
VKRZQHDUOLHU$VWKLVSUREOHPLVFRQQHFWHGWRVHUYHUDQGQHWZRUNORDGIDFWRUVWKHHUURU
PHVVDJHFDQFRQWDLQYDU\LQJURZQXPEHUVPDNLQJWKHSUREOHPHYHQPRUHGLIÀFXOWWR
XQGHUVWDQGDWÀUVWJODQFH
3UHYHQWLQJWKHSUREOHP
7KHÀ[LVTXLWHHDV\³FRQÀJXUHWKHnet_write_timeoutYDOXHWRDODUJHHQRXJKYDOXH
EHIRUHUXQQLQJmysqldumpPDNLQJVXUHWKDWDIXOOGDWDSDFNHWFDQEHWUDQVIHUUHGYLDWKH
QHWZRUNDQGLWVFRQWHQWVEHZULWWHQWRWKH64/GXPSÀOH
$ mysql -e "SET GLOBAL net_write_timeout=120;"
7KLVZLOOJLYHmysqldumpWZRPLQXWHVWRUHWULHYHDQGVWRUHDVLQJOHGDWDSDFNHWZKLFKVKRXOG
EHSOHQW\HYHQIRUODUJH%/2%FROXPQV
7KHEXJUHSRUWLVEHLQJNHSWRSHQDVDIHDWXUHUHTXHVWDWWKHWLPHRIZULWLQJ
WKLVVRWKDWmysqldumpZLOOUHTXHVWDORQJHQRXJKWLPHRXWDXWRPDWLFDOO\8QWLOWKDWJHWV
LPSOHPHQWHG\RXFDQXVHWKHZRUNDURXQGSUHVHQWHGKHUH
1RQDYDLODELOLW\RI,QQR'%PD\HVFDSH
PRQLWRULQJ
,IWKH0\64/FRQÀJXUDWLRQÀOHVSHFLÀHVSDUDPHWHUVWKDWPDNH,QQR'%IDLOWRVWDUW³IRU
H[DPSOHWRRODUJHPHPRU\YDOXHVIRUWKHEXIIHUSRRO³WKHVHUYHUZLOOVWDUWXSZLWKRXWWKLV
SDUWLFXODUVWRUDJHHQJLQHXQOHVV\RXKDYHVSHFLÀHGdefault-table-type=InnoDBLQWKH
FRQÀJXUDWLRQWRR,I,QQR'%LV\RXUGHIDXOWVWRUDJHHQJLQHDVSHUWKDWSDUDPHWHUWKHQVHUYHU
VWDUWXSZLOOIDLOZKHQ,QQR'%LVQRWDYDLODEOH

*RRGWR.QRZ

2QHUHDVRQWREHZDU\RIWKLVLVWKDWLI\RXDUHMXVWPRQLWRULQJLIWKHVHUYHUKDVEHHQVWDUWHG
DQGPD\EHGRDVLPSOHTXHU\RQWKHmysqlGDWDEDVHRUDQ\RWKHUQRQ,QQR'%WDEOHIRUWKDW
PDWWHUWKHQ\RXPLJKWIDLOWRQRWLFHWKDW\RXUVHUYHULVQRWUXQQLQJFRUUHFWO\LQWLPH
,I\RXDUHXVLQJ,QQR'%SULPDULO\DQ\ZD\\RXVKRXOGXVHWKHdefault-table-type
SDUDPHWHUWRPDNHVXUH\RXUVHUYHUGRHVQRWVWDUWXSDWDOOLIWKHUHLVDSUREOHPZLWK,QQR'%
7URXEOHVKRRWLQJ&DQ
WVWDUWVHUYHU%LQGRQ
7&3,3SRUW1RVXFKÀOHRUGLUHFWRU\HUURU
:KHQUXQQLQJRQ:LQGRZV0\64/XQGHUFHUWDLQFLUFXPVWDQFHVLVVXHVPLVOHDGLQJHUURU
PHVVDJHVZKLFKVWHPIURPLWVPXOWLSODWIRUPSURJUDPPLQJ:LQGRZVKDVGLIIHUHQWZD\V
RIFRPPXQLFDWLQJXQGHUO\LQJHUURUV³IRUH[DPSOHIURPWKHQHWZRUNVXEV\VWHP³WKDQPRVW
8QL[OLNHRSHUDWLQJV\VWHPV
2QHVXFKPLVOHDGLQJHUURUPHVVDJHLVUHODWHGWRWKHVWDUWXSSURFHVVZKHQWKHVHUYHUWULHVWR
ELQGWKH7&3SRUWLWLVFRQÀJXUHGWROLVWHQRQDQGZDLWIRUFOLHQWFRQQHFWLRQV
0\64/%XJDWhttp://bugs.mysql.com/bug.php?id=33137H[SODLQVHUURU
PHVVDJHVOLNH
:HVDZWKLVHUURULQRXUV\VWHPVVHYHUDOWLPHVDQGZHUHPLVOHGE\WKH1RVXFKÀOHRUGLUHFWRU\
SDUW,QIDFWWKH7&3,3SRUWFRQÀJXUHGXVXDOO\ZDVLQGHHGDOUHDG\ERXQGE\DGLIIHUHQW
SURJUDPDWWKHWLPHWKHPHVVDJHZDVFUHDWHGEXWQRWDQ\PRUHZKHQZHJRWWRORRNDW
WKHVLWXDWLRQ
)XUWKHUDQDO\VLVUHYHDOHGWKDWWKHUHZDVQRXVHUDSSOLFDWLRQXVLQJWKDWSRUWEXWWKDW
WKHRSHUDWLQJV\VWHPLWVHOIZDVDVVLJQLQJWKLVSRUWDVDORFDOHQGSRLQWWRSURFHVVHVWKDW
FRQQHFWHGWRRWKHUQHWZRUNSRUWVWKHPVHOYHV7KLVLVDUHJXODUPHFKDQLVPDQGUHTXLUHGIRU
WKH7&3,3SURWRFROWRZRUNQRUPDOO\7KHPDLQSUREOHPDULVHVIURPWKHIDFWWKDWWKHGHIDXOW
0\64/QHWZRUNSRUWLVLQDUDQJHFDOOHGHSKHPHUDOSRUWVVSHFLÀFDOO\DOORFDWHGIRUWKH
SXUSRVHWKHRSHUDWLQJV\VWHPXVHGLWIRU
7KHUDQJHRIWKHVHSRUWVGLIIHUVEHWZHHQRSHUDWLQJV\VWHPVHYHQWKRXJKWKHUHLVDQ,$1$
,QWHUQHW$VVLJQHG1XPEHUV$XWKRULW\UHFRPPHQGDWLRQ

$SSHQGL[

7KH,$1$VXJJHVWVWRDVG\QDPLFDQGRUSULYDWHSRUWVDFFRUGLQJWR
:LNLSHGLD7KHIROORZLQJLQIRUPDWLRQLVDOVRWDNHQIURP:LNLSHGLD
0DQ\/LQX[NHUQHOVXVHWR7KHÀOHV\VWHPSDWK/proc/sys/net/
ipv4/ip_local_port_rangeFRQWDLQVWKHUDQJHLQXVH
0LFURVRIW:LQGRZVRSHUDWLQJV\VWHPVWKURXJK6HUYHUXVHWKHUDQJHWR
DVHSKHPHUDOSRUWV:LQGRZV9LVWDDQG6HUYHUXVHWKH,$1$UDQJH
)UHH%6'XVHVWKH,$1$SRUWUDQJHVLQFHUHOHDVH
7KLVLVDVFUHHQVKRWRIDQ8EXQWX/LQX[GHIDXOWV\VWHPVHWXS
7KLVUDQJHGRHVQRWFRQÁLFWZLWKWKH0\64/SRUWVRXVXDOO\QRDFWLRQLVUHTXLUHGKHUH
2Q:LQGRZVYHUVLRQVXSWR:LQGRZV6HUYHUKRZHYHU\RXQHHGWRWDNHDFWLRQWR
SUHYHQWFRQÁLFWVIURPKDSSHQLQJ
2QDOOPRGHUQ:LQGRZVYHUVLRQV³VWDUWLQJZLWK:LQGRZV³\RXFDQEORFNRXWVSHFLÀFSRUW
UDQJHVHYHQLIWKH\RQO\FRYHUDVLQJOHSRUWIURPWKHHSKHPHUDOSRUWVIRUDSSOLFDWLRQXVH
(IIHFWLYHO\WKH\DUHQRWUHVHUYHGIRUDQ\WKLQJVSHFLÀFEXWMXVWH[FOXGHGIURPWKHG\QDPLF
DOORFDWLRQ7RGRVRFUHDWHRUHGLWWKHIROORZLQJUHJLVWU\YDOXHRIW\SHREG_MULTI_SZ/
Multi-String Value
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\
ReservedPorts
,QWKLVYDOXHVSHFLI\SRUWUDQJHVLQWKHIRUPDWxxxx-yyyyZLWKxxxxDQGyyyyEHLQJWKH
ORZHVWDQGKLJKHVWSRUWRIWKHUDQJHWREHUHVHUYHG7RUHVHUYHDVLQJOHSRUWMXVWXVHWKH
VDPHYDOXHVIRUERWKDVVHHQEHORZ
7KHUHFDQEHPXOWLSOHUDQJHVHDFKRQLWVRZQOLQH6RIRU0\64/PDNHVXUHWKHUHLVDOLQH
3306-3306SUHVHQW
7ROHDUQPRUHDERXWWKLVVHH0LFURVRIW
V'HYHORSHU1HWZRUN6LWHDW
http://msdn.microsoft.com/en-us/library/ms737828(VS.85).aspx

*RRGWR.QRZ

&KRRVLQJFKDUDFWHUVHWV
7KLVUHFLSHLVQRWDVWHSE\VWHSVHWRILQVWUXFWLRQVWRIROORZ&RQVLGHUWKHLQIRUPDWLRQ
SUHVHQWHGKHUHDVDOLVWRIWRSLFVWKDWJXLGH\RXWRZDUGVDVXLWDEOHFRQÀJXUDWLRQ
7H[WDURXQGWKHZRUOG
:KHQHYHU\RXVWRUHWH[WXDOGDWDLQDGDWDEDVHLQCHARVARCHARRUTEXTFROXPQV
VRYLUWXDOO\DOZD\V³\RXKDYHWRWKLQNDERXWFKDUDFWHUVHWVDQGFROODWLRQV
(QJOLVKGRHVQRWKDYHDQ\VSHFLDOFKDUDFWHUVDSDUWIURPWKHXVXDO5RPDQOHWWHUVZKLFK
PDNHVLWGLIIHUHQWIURPPDQ\RWKHUODQJXDJHV)RUH[DPSOHWKH)UHQFKODQJXDJHUHTXLUHV
FKDUDFWHUVOLNHkpz*HUPDQWH[WVZLOOOLNHO\FRQWDLQWKLQJVOLNHbgRUWKDWDUHRIWHQ
IRUJRWWHQZKHQGHVLJQLQJFRPSXWHUV\VWHPVXQOHVV\RXOLYHLQRQHRIWKHVHFRXQWULHV2I
FRXUVH&KLQHVH-DSDQHVH.RUHDQ5XVVLDQDPRQJRWKHUVKDYHWREHFRQVLGHUHGDVZHOO
EHLQJEDVHGRQFRPSOHWHO\GLIIHUHQWDOSKDEHWVLIWKH\DUHDOSKDEHWLFDWDOO
1HYHUWKHOHVVLQWRGD\
VJOREDODQGQHWZRUNHGV\VWHPVLWKDVEHFRPHFRPPRQIRUD
GDWDEDVHWREHXVHGE\SHRSOHIURPDURXQGWKHZRUOGDOORIWKHPH[SHFWLQJWREHDEOHWR
XVHWKHLUQDWLYHODQJXDJHZLWKDOOLWVVXEWOHWLHV
&KDUDFWHUVHWV
%DVLFDOO\DVRFDOOHGFKDUDFWHUVHWLVOLNHDWDEOHWKDWFRQWDLQVDPDSSLQJEHWZHHQDQ\
FKDUDFWHUDJLYHQKXPDQODQJXDJHPDNHVXVHRIDQGDQXPHULFDOUHSUHVHQWDWLRQWKH
FRPSXWHUXVHVWRVWRUHWKDWFKDUDFWHULQWHUQDOO\7KLVFRQFHSWLVDQDORJRXVWRVD\WKH0RUVH
FRGHLQZKLFKLQVWHDGRIPDSSLQJDFKDUDFWHUWRDQXPEHULWLVPDWFKHGWRDVHTXHQFHRI
VKRUWDQGORQJVLJQDOV
:HZLOOQRWGLYHWRRGHHSO\LQWRWKHWKHRU\RIWKHVHFKDUDFWHUVHWVDQGWKHLUDFFRPSDQ\LQJ
FROODWLRQVKRZWRVRUWDQGFRPSDUHFKDUDFWHUVLQDQ\JLYHQODQJXDJHDVWKHUHLVORWV
RILQIRUPDWLRQDERXWWKLVDYDLODEOHHOVHZKHUHLQFOXGLQJWKH0\64/RQOLQHPDQXDO)RU
QRZVXIÀFHLWWRVD\WKDW0\64/KDVJRRGVXSSRUWIRUDZLGHYDULHW\RIFKDUDFWHUVHWV
DQGFROODWLRQVDQGDOORZV\RXWRVSHFLI\ZKLFKRQHVWRXVHRQDSHUVHUYHUSHUGDWDEDVH
SHUWDEOHDQGHYHQSHUFROXPQEDVLV
<RXFDQÀQGDOOWKHGHWDLOVLQWKHRQOLQHPDQXDO
V&KDSWHURQ,QWHUQDWLRQDOL]DWLRQ
DQG/RFDOL]DWLRQDWhttp://dev.mysql.com/doc/refman/5.1/en/
internationalization-localization.html
'HIDXOWV
(YHQWKRXJK\RXPLJKWQRWEHLPPHGLDWHO\DZDUHRILWDQ\0\64/GDWDEDVHVFKHPD\RX
VHWXSFRQWDLQVLQIRUPDWLRQDERXWWKHFKDUDFWHUVHWWRXVHIRUWKHWDEOHVDQGFROXPQVFRQWDLQHG
LQLW:KHQ\RXGRQRWWHOOLWWRGRRWKHUZLVHLWZLOOMXVWVLOHQWO\XVHWKHGHIDXOWVHWWLQJVLWZDV
VKLSSHGZLWK

$SSHQGL[

,QVWHDGRIDFRQFUHWHVWHSE\VWHSZDONWKURXJKVW\OHUHFLSHZHZLOOPHUHO\SURYLGHVRPH
FKHFNSRLQWVWRWKLQNDERXWZKHQ\RXGHVLJQDGDWDEDVH$VLVRIWHQWKHFDVHZLWKFRPSOH[
WRSLFVWKHUHLVQRRQHDQVZHUWKDWSHUIHFWO\ÀWVHYHU\VFHQDULR+RZHYHU\RXZLOOÀQGDGYLFH
RQZKDWEDVLFDVSHFWVWRFRQVLGHUZKHQGHFLGLQJRQWKHFKDUDFWHUFRQÀJXUDWLRQ\RXDUHJRLQJ
WRXVH
0XOWLSOHOHYHOVRIFRQÀJXUDWLRQ
%HDZDUHWKDWGXHWR0\64/
VÁH[LELOLW\\RXGRQRWKDYHWRGHFLGHRQDVLQJOHFKDUDFWHUVHWIRU
DOO\RXUGDWDEXWFDQJRIRUPXOWLSOHVHWVLIQHHGHG:HGRKRZHYHUUHFRPPHQGVWLFNLQJZLWK
DVLQJOHFKDUDFWHUVHWLIDWDOOSRVVLEOHEHFDXVHPDWWHUVTXLFNO\EHFRPHYHU\FRPSOLFDWHGDQG
KDUGWRPDLQWDLQZKHQGHDOLQJZLWK-2,1VDQGGLIIHUHQWFOLHQWSURJUDPVDQGVRRQ
)RUGHWDLOVRQWKLVUHIHUWRWKH0\64/RQOLQHPDQXDOVHFWLRQDWhttp://dev.mysql.
com/doc/refman/5.1/en/charset-syntax.html
*HWWLQJUHDG\
7RÀQGRXWZKDWFKDUDFWHUVHWVDUHDYDLODEOHWRFKRRVHIURP\RXFDQHLWKHUUHIHUWRWKH0\64/
RQOLQHPDQXDODWhttp://dev.mysql.com/doc/refman/5.1/en/charset-charsets.
htmlRUUHWULHYHDOLVWIURP\RXU0\64/VHUYHU7RJHWLWFRQQHFWWRWKHVHUYHUDQGLVVXH
WKLVFRPPDQG
mysql> SHOW CHARACTER SET;
7KLVZLOORXWSXWDWDEOHRIFKDUDFWHUVHWVVXSSRUWHGE\\RXUVHUYHUZLWKWKHLUQDPHVVKRUW
GHVFULSWLRQVWKHFRUUHVSRQGLQJGHIDXOWFROODWLRQDQGWKHQXPEHURIE\WHVDQ\VLQJOH
FKDUDFWHUZLOOXVHXSDWPRVWLIVWRUHGLQWKHGDWDEDVH:HZLOOJHWWRWKLVLQDPLQXWH
+RZWRGRLW
(YHQWKRXJKZHVDLGEHIRUHWKDWWKHUHLVQRTXLFNDQVZHU\RXPD\VNLSUHDGLQJWKHUHPDLQGHU
RIWKLVUHFLSHLI\RXDUHQRWLQWHUHVWHGLQJHWWLQJWRRPDQ\GHWDLOVEXWMXVWZDQWTXLFNJHQHUDO
DGYLFHWKDWPLJKWQRWEHDQLGHDOVROXWLRQIRU\RXEXWZLOOZRUNZHOODQGNHHS\RXURSWLRQV
RSHQIRUWKHIXWXUH
)RUWKHLPSDWLHQW
8VHutf8DV\RXGHIDXOWHQFRGLQJIRUDOO\RXUWDEOHV
)ROORZLQJWKLVDGYLFHZLOOHQDEOH\RXWRVWRUHDQ\LQWHUQDWLRQDOWH[WLQ\RXU
GDWDEDVHFRUUHFWO\
,IKRZHYHU\RXZRXOGOLNHWRNQRZPRUHEHIRUHPDNLQJDGHFLVLRQSOHDVHUHDGRQ

*RRGWR.QRZ

'HWHUPLQLQJUHTXLUHGODQJXDJHV
7KHPRVWLPSRUWDQWGHFLVLRQ\RXKDYHWRPDNHLVZKHWKHU\RXZDQWRUKDYHWRVXSSRUW
FRQWHQWVLQPRUHWKDQDVLQJOHODQJXDJH,I\RXNQRZIRUVXUHWKDWDGDWDEDVHLVJRLQJWR
H[FOXVLYHO\FRQWDLQ(QJOLVKZRUGVPDWWHUVDUHJRLQJWREHUDWKHUHDV\,QWKLVFDVH\RXFDQ
MXVWXVHWKHGHIDXOWODWLQFKDUDFWHUVHW%HDZDUHKRZHYHUWKDW\RXPLJKWZDQWWRVSHFLI\
DGLIIHUHQWFROODWLRQIURPWKHGHIDXOW6ZHGLVKRQH
)RUDQ\RWKHUVLQJOHODQJXDJHFRQWHQWJRWKURXJKWKHOLVWRIVXSSRUWHGFKDUDFWHUVHWVDQGVHH
LIWKHUHLVRQHIRU\RXUODQJXDJHRUIDPLO\RIODQJXDJHV,ILQGRXEWWKHQUHDGRQ
&KRRVLQJIURP8QLFRGHFKDUDFWHUVHWV
,QFDVH\RXFDQQRWRUGRQRWZDQWWRFRPPLW\RXUVHOIWRDVLQJOHODQJXDJHRUIDPLO\RI
ODQJXDJHV\RXVKRXOGSUREDEO\FKRRVHRQHRIWKH8QLFRGHEDVHGFKDUDFWHUVHWV7KRVHDUH
GHVLJQHGWRKDQGOHPDQ\ODQJXDJHVDQGPL[HGODQJXDJHFRQWHQWZHOO6HHEHORZIRUPRUH
GHWDLOVRQZKLFK8QLFRGHFKDUDFWHUVHWLVPRVWVXLWDEOHIRU\RXUQHHGV
'HFLGLQJRQD8QLFRGHFKDUDFWHUVHW
0\64/VXSSRUWVWZR8QLFRGHFKDUDFWHUVHWVucs2ZKLFKLVWKHSUHGHFHVVRUWR87)
EXWVWLOOUHIHUUHGWRZLWKWKHROGHUQDPHLQPXFKRI0\64/
VGRFXPHQWDWLRQDQGutf8%RWK
DUHVXLWDEOHWRVWRUHDQ\FKDUDFWHUWKDWKDVEHHQGHÀQHGLQ8QLFRGH7KHPDLQGLIIHUHQFH
EHWZHHQWKHPLVWKHDPRXQWRIVSDFHWKH\UHTXLUHIRUDVLQJOHFKDUDFWHU:LWKucs2
FKDUDFWHUVDUHXQLIRUPO\VWRUHGDVDWZRE\WHVHTXHQFHZKHUHDVZLWKWKHutf8FKDUDFWHU
VHWWKHDPRXQWRIVWRUDJHUHTXLUHGIRUDFKDUDFWHUGHSHQGVRQWKHLQGLYLGXDOFKDUDFWHU
7KH87)HQFRGLQJZDVGHVLJQHGWRDOORZIRUDVPRRWKPLJUDWLRQIURPWKHFRPPRQSODFH
VLQJOHE\WHV\VWHPVWRPRUHVRSKLVWLFDWHGDQGLQWHUQDWLRQDOO\XVDEOHVRIWZDUH7KHEDVLF
LGHDZDVWRFRQWLQXHUHSUHVHQWLQJWKHPRVWRIWHQXVHGFKDUDFWHUVRIWKH:HVWHUQODQJXDJHV
DVDVLQJOHE\WHMXVWDVEHIRUHDQGG\QDPLFDOO\XVHPRUHWKDQRQHE\WHSHUFKDUDFWHU
IRUPRUHXQXVXDOPHDQLQJQRQ$6&,,V\PEROV$ZHOOGHÀQHGPDSSLQJDOJRULWKPZDV
GHVLJQHGWREHDEOHWRDXWRPDWLFDOO\PDSDQ\QRWVRXVXDOFKDUDFWHUWRDWZRWKUHHRUDW
PRVWIRXUE\WHORQJUHSUHVHQWDWLRQ
$SRVLWLYHDQGLQWHQWLRQDOHIIHFWRIWKLVWHFKQLTXHLVWKDWDQ(QJOLVKRU*HUPDQWH[WZLOOQRW
UHTXLUHPRUHVSDFHLQutf8DWOHDVWQRWVLJQLÀFDQWO\PRUHWKDQLILWZHUHHQFRGHGLQD
VLQJOHE\WHFKDUDFWHUVHWOLNHlatin17KLVLVEHFDXVHWKHUHDUHRQO\VRPDQ\8PODXWVLQD
*HUPDQWH[W³QRQHLQ(QJOLVKZKDWVRHYHU³PHDQLQJWKDWWKHEXONRIWKHLQIRUPDWLRQFRQWLQXHV
WREHVWRUHGZLWKMXVWRQHE\WHSHUFKDUDFWHU
0RUHRYHUDQ\H[LVWLQJVRIWZDUHSURJUDPWKDWFDQKDQGOHUHJXODUVLQJOHE\WHWH[WLQIRUPDWLRQ
ZLOOFRQWLQXHWRZRUNZLWK87)HQFRGHGLQIRUPDWLRQPD\EHMXVWGLVSOD\LQJQRQ$6&,,
FKDUDFWHUVLQFRUUHFWO\DVWZRRUPRUHVHSDUDWHV\PEROV
7KHPDMRUGRZQVLGHLVWKDW\RXFDQQRWWHOOWKHH[DFWDPRXQWRIVSDFH\RXQHHGWRUHVHUYH
WRVWRUHDQ\87)HQFRGHGWH[WLQDGYDQFHEHFDXVHGHSHQGLQJRQWKHFKDUDFWHUVLQWKH
WH[WWKRVHUHTXLUHPHQWVYDU\7REHRQWKHVDIHVLGH\RXQHHGWRSUHSDUHIRUWKHZRUVWFDVH
KDYLQJHDFKDQGHYHU\FKDUDFWHURIDWH[WUHTXLULQJWKHIXOOIRXUE\WHV)RUDCHAR(10)

$SSHQGL[

FROXPQE\WHVRIVWRUDJHVSDFHKDYHWREHUHVHUYHGWREHFHUWDLQWKDWWKHUHLVHQRXJK
URRPWRVWRUHDQ\VHTXHQFHRIFKDUDFWHUV7KLVLVQRWSHUFHQWH[DFWEXWJRRGHQRXJK
IRURXUSXUSRVHVKHUH6HHWKH0\64/RQOLQHPDQXDOVHFWLRQDWhttp://dev.mysql.
com/doc/refman/5.1/en/storage-requirements.htmlIRUDOOGHWDLOVRQVWRUDJH
UHTXLUHPHQWVIRUHDFKGDWDW\SH
:LWKucs2\RXKDYHWKHEHQHÀWRIEHLQJDEOHWRWHOOH[DFWO\KRZPXFKVSDFH\RXZLOOQHHGWR
VWRUHDQ\JLYHQWH[WSURYLGHG\RXNQRZKRZPDQ\FKDUDFWHUVLWKDV7KLVPHDQVWKDWDFROXPQ
GHÀQHGDVVD\CHAR(10)ZLOOXVHE\WHVRIGLVNVSDFHLQWHUQDOO\)RUWKHUHJXODU:HVWHUQ
ODQJXDJHEDVHGWH[WWKLVZLOOXVXDOO\EHPRUHWKDQWKHHTXLYDOHQWutf8HQFRGHGYHUVLRQ
ZRXOGWDNHEXWDWOHDVW\RXFDQSODQLQDGYDQFH
$PDMRUGUDZEDFNRIucs2DQGDQ\GRXEOHE\WHFKDUDFWHUVHWLQJHQHUDOLVWKDWPRVW
VRIWZDUHSURGXFWVDUHQRWUHDG\WRSURFHVVLWEHFDXVHWKH\ZHUHGHVLJQHGZLWKDVLQJOHE\WH
SHUFKDUDFWHULQPLQG
)URPDOOWKHLQIRUPDWLRQDERYHZHUHFRPPHQG\RXXVHutf8LQDQ\FDVHZKHUH(QJOLVKRU
DQ\:HVWHUQODQJXDJHWH[WZLOOPDNHXSWKHEXONRIWKHFRQWHQWV\RXDUHJRLQJWRVWRUHLQWKH
GDWDEDVH7KLVZLOOUHVXOWLQWKHPRVWVSDFHHIÀFLHQWDQG\HWFRPSDWLEOHZD\RIVWRULQJWH[WXDO
LQIRUPDWLRQZKLOHSUHVHUYLQJDQ\LQWHUQDWLRQDOFKDUDFWHUV
2QO\ZKHQ\RXNQRZLQDGYDQFHWKDWWKHEXONRI\RXUFRQWHQWVZLOOEHLQODQJXDJHVGLIIHUHQW
IURPWKRVHPRVWQRWDEO\ODQJXDJHVIURPWKH0LGGOH(DVWDQGWKH)DU(DVWVKRXOG\RXJR
ZLWKucs2IURPDVSDFHHIÀFLHQF\VWDQGSRLQW+RZHYHUEHVXUH\RXDUHDZDUHRIWKHRWKHU
LPSOLFDWLRQVWKLVKDVLQWHUPVRIGDWDEDVHFOLHQWVXSSRUW,ILQGRXEWutf8LVWKHVDIHVWRSWLRQ
KHUHDVZHOO
&RQVLGHULQJFRQYHUVLRQQHHGVEHWZHHQVHUYHUDQGFOLHQWV
7KHPRVWLPSRUWDQWEHQHÀWRIXVLQJucs2LQVWHDGRIutf8RQWKH0\64/VHUYHULVSUHGLFWDEOH
VSDFHUHTXLUHPHQWV+RZHYHU0\64/IRUVRPHUHDVRQGRHVQRWVXSSRUWucs2DVDFKDUDFWHU
VHWIRUUHWXUQLQJGDWDWRDQ\FOLHQWVRIWZDUH:KDWWKLVPHDQVLVWKDWHYHQWKRXJKDFKDUDFWHU
PLJKWEHVWRUHGZLWKWZRE\WHVLQWKH,QQR'%WDEOHVSDFHRU0\,6$0GDWDÀOHVWKHVHUYHUZLOO
QRWMXVWVHQG\RXWKRVHWZRE\WHVZKHQ\RXDVNIRUWKDWGDWD,QVWHDGLWZLOOFRQYHUWLWWRD
GLIIHUHQWHQFRGLQJEHIRUHVHQGLQJWKHGDWDDFURVVWKHQHWZRUN:KDWHYHUWKHUHDVRQIRUWKLV
LWHQWDLOVDQDGGLWLRQDOEXUGHQRQWKHVHUYHUIRUDQ\GDWDHQWHULQJRUOHDYLQJD0\64/WDEOH
7RPDNHPDWWHUVZRUVHIURPDSURFHVVLQJHIÀFLHQF\SRLQWRIYLHZPDQ\PRGHUQV\VWHPV
LQWHUQDOO\XVHucs2RULWVVXFFHVVRU87)DQ\ZD\-DYDRU:LQGRZVWRQDPHMXVWWZR6RLQ
WKHRU\WKRVHFRXOGWDNHWKHGDWDYHUEDWLPIURPWKHGDWDEDVHVHUYHUDQGJRRQSURFHVVLQJLW
,QVWHDG0\64/ZLOOFRQYHUWWKHGDWDIURPLWVLQWHUQDOucs2IRUPDWWRIRUH[DPSOHutf8SULRU
WRVHQGLQJLWWRWKHFOLHQWZKLFKLQWXUQZLOOWKHQRIWHQFRQYHUWLWULJKWEDFNWR87)
$VDFRQVHTXHQFHZHDJDLQUHFRPPHQG\RXXVHutf8IRUGDWDEDVHLQWHUQDOVWRUDJHLIQRQH
RIWKHQDWLRQDOFKDUDFWHUVHWVÀW\RXUQHHGWRVDYHRQWKHFRQYHUVLRQHIIRUWZKHQVHQGLQJ
GDWDEDFNDQGIRUWKEHWZHHQFOLHQWVDQGWKHVHUYHU2QO\ZKHQ\RXUHDOO\QHHGWRIRFXVRQWKH
UHGXFHGVWRUDJHVSDFHIRU(DVWHUQODQJXDJHVVKRXOG\RXFRQVLGHUVHWWLQJXS\RXUGDWDVWRUH
ZLWKucs2

*RRGWR.QRZ

8QGHUVWDQGLQJDXWRLQFUHPHQWYDOXHV
,Q&KDSWHU
V$OORZLQJLQGLYLGXDO,16(57VWDWHPHQWVZLWKYDOXHVLQDXWRLQFUHPHQWLQJ
FROXPQVUHFLSHWKHNO_AUTO_VALUE_ON_ZERORSWLRQWRWKHSQL_MODEV\VWHPYDULDEOH
ZDVXVHG7RIXOO\XQGHUVWDQGZKDWZDVKDSSHQLQJKHUHZHVXJJHVW\RXWRIROORZDORQJRQD
OLWWOHH[SHULPHQW
*HWWLQJUHDG\
)ROORZWKHSUHSDUDWLRQVGHVFULEHGLQ$OORZLQJLQGLYLGXDO,16(57VWDWHPHQWVZLWKYDOXHVLQ
DXWRLQFUHPHQWLQJFROXPQV&KDSWHU2QFH\RXDUHGRQHFRQQHFWWRDWHVWGDWDEDVHDQG
GURSDSRVVLEO\H[LVWLQJHQXPHUDWRUWDEOHDVXVHGLQWKHUHFLSHPHQWLRQHGDERYH
%HFDUHIXOQRWWRKDUPDSURGXFWLRQGDWDEDVHGRWKLVRQDWHVWV\VWHP
+RZWRGRLW

&UHDWHWKHGDWDEDVHVFKHPDDIUHVK
mysql> DROP TABLE IF EXISTS enumerator;
mysql> CREATE TABLE enumerator (
          id INT NOT NULL AUTO_INCREMENT,
          textvalue VARCHAR(30),
          PRIMARY KEY (id)
       ) ENGINE=InnoDB;

7U\WRLQVHUWDQGUHDGEDFNVRPHGDWDOLNHWKLV
mysql> INSERT INTO enumerator 
           VALUES (0,'Zero'),(1,'One'),
                  (2,'Two'),(3,'Three');
ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY'

6HHLIDQ\WKLQJZDVDFWXDOO\LQVHUWHG
mysql> SELECT * FROM enumerator; 
Empty set (0.00 sec)

2EYLRXVO\QRWKLQJKDSSHQHGDVZDVWREHH[SHFWHGEHFDXVHRIWKHHUURUPHVVDJH
ZHJRW

$SSHQGL[


7U\WKHH[DFWVDPHINSERTVWDWHPHQWDJDLQWRLQFUHDVHFRQIXVLRQ
mysql> INSERT INTO enumerator 
           VALUES (0,'Zero'),(1,'One'),
                  (2,'Two'),(3,'Three');
Query OK, 4 rows affected (0.00 sec)
Records: 4  Duplicates: 0  Warnings: 0
:KDWMXVWKDSSHQHG
:KHQWKHWDEOHZDVMXVWFUHDWHGLWVDXWRLQFUHPHQWYDOXHZDVUHVHWWREHIRUWKHÀUVW
UHFRUGWREHLQVHUWHG:KHQZHWULHGWRLQVHUWWKHÀUVWEDWFKRIUHFRUGVVKRZQSUHYLRXVO\WKH
(0,'Zero') UHFRUGZDVDFWXDOO\LQWHUSUHWHGDVDUHTXHVWWRDVVLJQDQHZDXWRLQFUHPHQW
YDOXHIRUWKHLGFROXPQ$VWKLVZDVJRLQJWREHWKHÀUVWUHFRUG0\64/DFWXDOO\WULHGWRLQVHUW
D(1,'Zero')UHFRUG
+RZHYHUWKHVHFRQGUHFRUGZHWULHGWRLQVHUWDVSDUWRIRXUVWDWHPHQWZDV(1,'One')7KLV
FRQÁLFWHGZLWKWKHidYDOXHWKDWKDGMXVWEHHQJHQHUDWHGIRUWKHÀUVWURZPDNLQJWKHRYHUDOO
INSERTVWDWHPHQWIDLO
(YHQWKRXJKQRUHFRUGVZHUHLQVHUWHG0\64/LQFUHDVHGWKHLQWHUQDOFRXQWHUIRUWKLVWDEOH
V
DXWRLQFUHPHQWYDOXHRQFHIRUHDFKUHFRUGZHWULHGWRLQVHUW,VVXLQJWKHVDPHINSERTDJDLQ
ZLOOZRUNDIWHUWKDWEHFDXVHWKHÀUVWUHFRUG(0,'Zero')LVQRZWUDQVODWHGWRDQDFWXDO
(5,'Zero')QRWFUHDWLQJDFRQÁLFWIRUWKHRWKHUYDOXHV
7KLVEHKDYLRUFDQFDXVHVXEWOHHUURUVLI\RXGRQRWQRWLFHZKDWLVJRLQJ
RQULJKWDZD\EHFDXVH\RXPLJKWEHZRUNLQJRQGDWDGLIIHUHQWIURPZKDW
\RXH[SHFW7KLVLVRQHRIWKHUHDVRQVZK\LQJHQHUDOLWLVFRQVLGHUHGEDG
SUDFWLFHWRLQVHUW\RXURZQYDOXHVIRUDXWRLQFUHPHQWLQJFROXPQVVRVWULYH
WRDYRLGLWLISRVVLEOH

*RRGWR.QRZ

7KHUH
VPRUH
<RXFDQGHÀQHWKHEHKDYLRUVKRZQKHUHIRUDVLQJOHVHVVLRQDVWKHGHIDXOWEHKDYLRUIRUD0\64/
VHUYHU6HHWKH*OREDOO\DOORZLQJ,16(57VWDWHPHQWVZLWKYDOXHVLQDXWRLQFUHPHQWLQJ
FROXPQVUHFLSHLQ&KDSWHUIRUPRUHGHWDLOVRQKRZWRGRWKDW
)RUPRUHLQIRUPDWLRQRQWKHSQL_MODEYDULDEOHDQGLWVYDULRXVVHWWLQJVUHIHUWRWKHRQOLQH
PDQXDOVHFWLRQ6HUYHU64/0RGHVDW
http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html

,QGH[
6\PEROV
=LS
ELW:LQGRZVXVDEOHPHPRU\
,QQR'%LPSDFW
OLPLWDWLRQV
PD[LPL]LQJ
0\64/LPSDFW
??BWRNHQ
??KWRNHQ
??GWRNHQ
??XWRNHQ
GDWDEDVHVRSWLRQ
GHFRPSUHVVRSWLRQ
KH[EORERSWLRQ
OLQHE\WHVRSWLRQ
ORFNWDEOHVRSWLRQ
PDVWHUGDWDRSWLRQ
VLQJOHWUDQVDFWLRQRSWLRQ
$
DFFHVV
DOORZLQJIURPJURXSRIKRVWV
DOORZLQJIURPVSHFLÀFKRVW
UHJDLQLQJ
DOHUWLQJPHFKDQLVP
FRQÀJXUDWLRQLPSURYLQJ
HVWDEOLVKLQJIRUUHPDLQLQJ,QQR'%WDEOHVSDFH

0\64/VFKHGXOHUHQDEOLQJ
DOWHUQDWLYHXVHU
GHÀQLQJIRUDGPLQLVWUDWLYHWDVNV
$/7(5SULYLOHJH
$/7(57$%/($''&2/801FRPPDQG
$/7(57$%/($'',1'(;V\QWD[
$/7(57$%/(FRPPDQG
DERXW
SHUIRUPDQFHLPSURYLQJ
$/7(57$%/(VWDWHPHQW
XVLQJ
$SS$UPRU
WXUQLQJRII
DXWRH[WHQGLQJ,QQR'%WDEOHVSDFH
DERXW
FUHDWLQJIURPH[LVWLQJWDEOHVSDFH
GHÀQLQJ
H[WHQVLRQVWHSVFRQWUROOLQJ
QHZGDWDÀOHDGGLQJ
VHWWLQJXS
VL]HOLPLWLQJ
ZRUNLQJ
DXWRLQFUHPHQWLQJFROXPQV
LQGLYLGXDO,16(57VWDWHPHQWVDOORZLQJZLWK
YDOXHV
,16(57VWDWHPHQWVJOREDOO\DOORZLQJZLWK
YDOXHV
$872B,1&5(0(17RSWLRQ
DXWRLQFUHPHQWYDOXHV
DERXW
ZRUNLQJ
DXWRPDWLFDOO\XSGDWHG64/EDVHGVHOHFWLRQ
VODYHVVHWWLQJXS
JHWWLQJUHDG\
VWHSV
ZRUNLQJ
DXWRPDWLFDOO\XSGDWHG64/GXPSEDVHG
VHUYHUVODYHVVHWWLQJXS
VWDUWLQJZLWK
VWHSV
ZRUNLQJ


DXWRPDWLFDOO\XSGDWHGVODYHVVHWWLQJXS
GDWDEDFNXSSHUFRQD[WUDEDFNXSXVHG
GDWDÀOHFRQVHUYDWLRQ/90XVHG
GDWDÀOHFRS\XVLQJ
JHWWLQJUHDG\
ZRUNLQJ
%
EDFNXSVL]H64/GXPS
FRPPDQGZRUNLQJ
FRPSUHVVLRQUDWLRDFKLHYLQJ
FRPSUHVVLRQXWLOLWLHVXVLQJ
GDWDUREXVWQHVVFRQVLGHULQJ
JHWWLQJUHDG\
SHUIRUPDQFHIDFWRUVFRQVLGHULQJ
UHGXFLQJ
WRRODYDLODELOLW\FRQVLGHULQJ
EDVLFXVHU
FUHDWLQJ
ELQDU\ORJJLQJ
DERXW
FRQÀJXULQJ
H[SLUHBORJVBGD\VVHWWLQJ
ORJBELQSDUDPHWHU
PD[BELQORJBVL]HSDUDPHWHU
385*(%,1$5</2*6FRPPDQG
UHTXLUHPHQWV
XVH
ZRUNLQJ
ELQDU\ORJV
DERXW
GDWDORVVULVNV
GDWDUHVWRULQJ
GLVNVSDFHHQVXULQJ
H[DFWORFDWLRQRIIDLOXUHUHVWRULQJ
SRLQWLQWLPHUHFRYHU\SHUIRUPLQJ
SXUJLQJ
SXUJLQJLQ/LQX[V\VWHPV
URWDWLQJ
URWDWLQJLQ/LQX[V\VWHPV
VSHFLÀFGDWDEDVHUHVWRULQJ
ELQORJJLQJ6HHELQDU\ORJJLQJ
EODFNKROHVWRUDJHHQJLQH
GLDJUDPPDWLFYLHZ
XVLQJ
XVLQJIRUQHWZRUNOLPLWDWLRQ
%/2%FROXPQV
XVLQJIRULPSURYLQJ,QQR'%WDEOHVTXHU\SHU
IRUPDQFH
E]LS
&
&+$5
FKDUDFWHUVHWV
DERXW
DXWRLQFUHPHQWYDOXHV
FKRRVLQJ
FRQYHUVLRQQHHGVEHWZHHQVHUYHUDQGFOLHQWV

GHIDXOWV
JOREDOWH[W
PXOWLSOHOHYHOVRIFRQÀJXUDWLRQ
UHTXLUHGODQJXDJHVGHWHUPLQLQJ
8QLFRGHFKDUDFWHUVHWVFKRRVLQJIURP
8QLFRGHFKDUDFWHUVHWVGHFRGLQJRQ
FROXPQVÀQGLQJ
DERXW
QDPHFROXPQV
QXPHULFGDWDW\SHV
UHTXLUHPHQWV
ZLWKGDWDW\SH
ZRUNLQJ
FRQQHFWLRQVHWWLQJVVKDULQJ
FKDQJHVGHDOLQJZLWK
0\64/*8,7RROVZRUNLQJ
UHTXLUHPHQWV
VWHSV
&5($7(,1'(;FRPPDQG
FXUOWRRO
XVLQJ
FXVWRPSURPSWXVLQJWRGLVWLQJXLVK
FRQQHFWLRQV
DERXW
FRQÀJXULQJ
JHWWLQJVWDUWHG
VWHSV
WRNHQV
ZRUNLQJ


'
GDWD
'(/(7(FRPPDQGXVLQJ
GHOHWLQJIURPODUJHWDEOHV
GHOHWLQJLQFUHPHQWDOO\IURP
ODUJHWDEOHV
H[SRUWLQJWR&69ÀOH
H[SRUWLQJWRFXVWRPÀOH
LPSRUWLQJIURP&69ÀOH
LPSRUWLQJIURPFXVWRPÀOH
LQVHUWLQJEDVHGRQH[LVWLQJGDWDEDVHFRQWHQW

PDQDJLQJ
QHZGDWDLQVHUWLQJ
SHUIRUPDQFHFRQVLGHUDWLRQV
VRPHUHFRUGVUHWDLQLQJ
VWRUHGSURFHGXUHVXVLQJ
XSGDWLQJ
GDWDEDVHQDPHOHWWHUFDVH
DERXW
DGMXVWLQJ
UHTXLUHPHQWV
GDWDGHOHWLQJIURPODUJHWDEOHV
)RUHLJQNH\FRQVWUDLQWVUHPRYLQJ
VWDUWLQJZLWK
VWHSV
7581&$7(7$%/(FRPPDQGXVLQJ
ZRUNLQJ
GDWDH[SRUWLQJWR&69ÀOH
HUURUKDQGOLQJZLWKWDUJHWÀOHH[LVWLQJ
JHWWLQJUHDG\
KHDGHUVLQFOXGLQJ
OLQHEUHDNVKDQGOLQJ
18//YDOXHVKDQGOLQJ
VWHSV
ZRUNLQJ
GDWDH[SRUWLQJWRFXVWRPÀOHIRUPDW
DERXW
VWDUWLQJZLWK
VWHSV
ZRUNLQJ
GDWDLPSRUWLQJIURP&69ÀOH
DERXW
JHWWLQJUHDG\
/2$''$7$,1),/(FRPPDQG
VWHSV
ZRUNLQJ
GDWDLPSRUWLQJIURPFXVWRPÀOHIRUPDWV
DERXW
JHWWLQJUHDG\
VWHSV
ZRUNLQJ
GDWDÀOHVFRS\LQJ
EDFNLQJXS/90VQDSVKRWVXVHG
ÀOHEDVHGEDFNXSGDWDUHVWRULQJ
ÀOHEDVHGEDFNXSPHWKRGUHVWULFWLRQV
JHWWLQJUHDG\
VWHSV
ZRUNLQJ
GDWDLQVHUWLRQEDVHGRQH[LVWLQJGDWDEDVH
FRQWHQW
H[DPSOH
VWDUWLQJZLWK
VWHSV
ZRUNLQJ
GDWDPDQDJHPHQW
DERXW
GDWDH[SRUWLQJLQWR&69ÀOH
GDWDH[SRUWLQJWRFXVWRPÀOHIRUPDW
GDWDIURPODUJHWDEOHVGHOHWLQJ
GDWDLPSRUWLQJWR&69ÀOH
GDWDLPSRUWLQJWRFXVWRPÀOHIRUPDW
GDWDXSGDWLQJ
H[LVWLQJGDWDEDVHFRQWHQWGDWDLQVHUWLQJ
QHZGDWDLQVHUWLQJ
VWRUHGSURFHGXUHVXVLQJ
GDWDUHVWRUDWLRQGXPSXVHG
ELQORJVGLVDEOLQJWHPSRUDULO\
FRPSUHVVHGGXPSVUHVWRULQJ
JHWWLQJUHDG\
SDUDOOHOUHVWRUHXVLQJ
VWHSV
WDEOHVUHVWRULQJ
ZRUNLQJ
'$7(IXQFWLRQ
GEKDVKWRRO
GHIDXOWDFFRXQWV
GLVDEOLQJ
GHIDXOWSDJHU
OHVVSDJHUXWLOLW\XVLQJ
P\VTOFRQÀJXULQJ
VSHFLI\LQJ
ZRUNLQJ


GLIIFRPPDQG
GRPDLQVHDUFKHV
DERXW
JHWWLQJVWDUWHG
VSHHGLQJXSVWHSV
ZRUNLQJ
GXSOLFDWHLQGH[HV
GLVDGYDQWDJHV
,QGH[$QDO\]HUXVLQJ
VHDUFKLQJ
VWDUWLQJZLWK
ZRUNLQJ
GXSOLFDWHVHUYHU,'V
DERXW
DYRLGLQJVWHSV
JHWWLQJUHDG\
V\PSWRPVUHFRJQL]LQJ
ZRUNLQJ
(
HQFU\SWHG0\64/FRQVROH
FUHDWLQJ
FUHDWLQJVWHSV
66+XVLQJ
ZRUNLQJ
HSKHPHUDOSRUWV
H[DPSOHXVHUFUHDWLQJLQVFULSWZLWKRXWSODLQ
WH[WSDVVZRUG
)
À[HG,QQR'%WDEOHVSDFH
DERXW
FKHFNLQJ
LQVWDOOLQJ
VHWWLQJXS
ZRUNLQJ
IUHH,QQR'%WDEOHVSDFHFKHFNLQJ
UHTXLUHPHQWV
VWHSV
7$%/(B&200(17FROXPQ
ZRUNLQJ
IWBVWRSZRUGBÀOHYDULDEOH
IXOOWH[WLQGH[DGGLQJ
DERXW
ERROHDQTXHU\PRGHXVLQJ
FDVHVHQVLWLYLW\
GURSSLQJ
IUHTXHQWZRUGVLJQRULQJ
SUHFDXWLRQV
UHFUHDWLQJ
6SKLQ[
VWDUWLQJZLWK
VWHSV
VWRSZRUGV
ZRUGOHQJWK
ZRUNLQJ
*
JUHSXWLOLW\
J]LS
+
KDVKYDOXHVVFKHPDYHUVLRQ
XVLQJ
KHDGHUVLQFOXGLQJ
,
,$1$
LQGH[HV
DGGLQJWRWDEOHV
GLIIHUHQFHV
GUDZEDFN
IHDWXUHV
IXOOWH[WLQGH[DGGLQJ
,QQR'%
0\64/4XHU\%URZVHUXVHGIRU64/
VWDWHPHQWJHQHUDWLRQ
QDPLQJ
SUHÀ[LQGH[HV
SUHÀ[SULPDU\NH\XVLQJ
UHPRYLQJIURPWDEOH
UHTXLUHPHQWV
VWRUDJH
ZRUNLQJZLWK0\,6$0VWRUDJHHQJLQH


,1'(;SULYLOHJH
,QQR'%
$/7(57$%/(SHUIRUPDQFHLPSURYLQJ
DGYDQWDJHV
LQGH[VSDFHUHTXLUHPHQWVHVWLPDWLQJ
SULPDU\LQGH[FOXVWHUHGLQGH[
UHGRORJFRQÀJXULQJ
VHFRQGDU\LQGH[HV
WLPHRXWFRQÀJXUDWLRQVHWWLQJV
,QQR'%GDWDFRQÀJXUDWLRQIRUVWRULQJLQ
VHSDUDWHÀOHV
VWDUWLQJZLWK
VWHSV
ZRUNLQJ
LQQRGEBÀOHBSHUBWDEOHIHDWXUH
XVLQJ
LQQRGEBORFNBZDLWBWLPHRXWRSWLRQYDOXHV
VHWWLQJV
,QQR'%SULPDU\NH\FROXPQV
FKRRVLQJ
FOXVWHUHGLQGH[HV
FOXVWHUHGLQGH[QDWXUHFRQVLGHULQJ
JHWWLQJUHDG\
LPPXWDELOLW\
LPPXWDEOHDWWULEXWHVLGHQWLI\LQJ
NH\OHQJWK
VKRUWNH\VXVLQJ
VLQJOHFROXPQNH\V
XQLTXHDWWULEXWHVLGHQWLI\LQJ
XQLTXHQHVV
ZRUNLQJ
LQQRGEBUROOEDFNBRQBWLPHRXWRSWLRQYDOXH
VHWWLQJV
,QQR'%WDEOHV
DOHUWLQJPHFKDQLVPXVHG
DXWRH[WHQGIHDWXUH
GUDZEDFNV
IXOOWH[WLQGH[SURYLGLQJUHSOLFDWLRQXVHG

,QQR'%WDEOHVSDFH6HHWDEOHVSDFH
,16(57VWDWHPHQWV
DOORZLQJLQGLYLGXDOZLWKYDOXHV
JOREDOO\DOORZLQJZLWKYDOXHV
12B$872B9$/8(B21B=(52RSWLRQHQDEOLQJ

LQVWDOODWLRQXVHU
DFFRXQWFUHDWLQJZLWKRXWXVLQJ
0\64/$GPLQLVWUDWRU
FUHDWLQJ
,QWHUQHW$VVLJQHG1XPEHUV$XWKRULW\6HH
,$1$
LQYDOLGGDWHYDOXH
VWRULQJLQ'$7(SUHYHQWLQJ
VWRULQJLQ'$7(7,0(SUHYHQWLQJ
-
-DYD5XQWLPH(QYLURQPHQW6HH-5(
-5(
.
NH\OHQJWK,QQR'%SULPDU\NH\FROXPQV
/
ODUJHVWWDEOH
ÀQGLQJUHTXLUHPHQWV
ÀQGLQJVWHSV
ZRUNLQJ
OHVVXWLOLW\
/,.(NH\ZRUG
0
PNGXSOLFDWHNH\FKHFNHU
PNWDEOHFKHFNVXPWRRO
DERXW
GRZQORDGLQJ
PRUHFRPPDQG
XVLQJ
PXOWLSOH0\64/VHUYHU
DOWHUQDWLYH0\64/6DQGER[SURMHFW
$SS$UPRUWXUQLQJRII
UXQQLQJSDUDOOHORQ/LQX[VHUYHU
UXQQLQJSDUDOOHORQ:LQGRZV
6(/LQX[WXUQLQJRII
0XOWL9HUVLRQ&RQFXUUHQF\&RQWURO6HH09&&
09&&


0\,6$0VWRUDJHHQJLQH
DERXW
GUDZEDFNV
35,0$5<.(<LQGH[
0\64/
ELQDU\ORJJLQJ
LQGH[HV
UHSOLFDWLRQ
WLPHRXWFRQÀJXUDWLRQVHWWLQJV
0\64/$GPLQLVWUDWRU
FRQÀJXULQJIRUGLVSOD\LQJJOREDOSULYLOHJHV

0\64/$GPLQLVWUDWRU*8,WRRO
DERXW
DGGLWLRQDOEDFNXSRSWLRQVH[SORULQJ
EDFNXSVVFKHGXOLQJ
FXVWRPJUDSKVDGGLQJ
JHWWLQJUHDG\
OLPLWDWLRQVKDQGOLQJ
XVLQJDVEDFNXSIURQWHQG
ZRUNLQJ
0\64/FRPPDQGOLQHFOLHQW
LQIRUPDWLRQH[WUDFWLQJIURPYHUERVHRXWSXW

SDJHUFRPPDQG
SDJHUFRPPDQGSDUDPHWHUV
XVLQJ
XVLQJUHTXLUHPHQWV
XVLQJWRGLVSOD\TXHU\UHVXOWVSDJHE\SDJH

0\64/FRQÀJXUDWLRQ
RYHUYLHZ
0\64/GDWDEDFNXS
DERXW
GDWDÀOHVEDFNLQJXS
P\VTOGBPXOWLWRRO
DERXW
ZRUNLQJ
P\VTOGXPSFRPPDQG
KH[EORERSWLRQ
DERXW
P\VTOGXPSIDLOXUHSUHYHQWLQJ
FDXVHÀQGLQJ
SUREOHPSUHYHQWLQJ
V\PSWRPVGLDJQRVLQJ
0\64/*8,7RROV
FRQÀJÀOHORFDWLRQV
SODWIRUPGLIIHUHQFHV
VWRUHGFRQQHFWLRQVRUWLQJ
0\64/LQVWDOODWLRQDV:LQGRZVVHUYLFH
FXVWRPRSWLRQVXVHG
DERXW
UHTXLUHPHQWV
VWHSV
ZRUNLQJ
0\64/LQVWDOODWLRQPRQLWRULQJ
IUHH,QQR'%WDEOHVSDFHFKHFNLQJ
0\64/PDVWHUVHUYHUGXPSÀOHV
DXWRPDWLFDOO\XSGDWHGVODYHVVHWWLQJXS

PXOWLSOHGDWDEDVHVUHSOLFDWLQJ
SUHSDULQJ
ZRUNLQJ
0\64/VHUYHU
HQFU\SWHGFRQQHFWLRQHVWDEOLVKLQJ
HQFU\SWHGFRQQHFWLRQ66+XVHG
0\64/XVHUPDQDJHPHQW
DERXW
DFFHVVDOORZLQJIURPVSHFLÀFKRVW
DFFHVVUHJDLQLQJ
DOWHUQDWLYHXVHUGHÀQLQJ
EDVLFXVHUFUHDWLQJ
GHIDXOWDFFRXQWVGLVDEOLQJ
LQVWDOODWLRQXVHUFUHDWLQJ
0\64/$GPLQLVWUDWRUFRQÀJXULQJ
SODLQWH[WSDVVZRUGVDYRLGLQJ
UHDGRQO\DFFRXQWFUHDWLQJ
VSHFLÀFXVHUIRUEDFNXSGHÀQLQJ
VSHFLÀFXVHUIRUUHSOLFDWLRQGHÀQLQJ
0\64/YDULDEOHV
DGDSWLQJ
FKDQJLQJ
JOREDOVHWWLQJGLVSOD\LQJ
JOREDOYDULDEOH
PXOWLSOHYDULDEOHVGLVSOD\LQJ
UHTXLUHPHQWV
VHVVLRQYDULDEOHV
ZRUNLQJ


1
QHWBUHDGBWLPHRXWYDOXHVVHWWLQJ
QHWZRUNHVWLPDWLRQ
DERXW
FRPSUHVVLRQHQDEOLQJ
PDVWHU·VQHWZRUNVSHHGFKHFNLQJ
UHTXLUHPHQWV
6/$9(B&2035(66('B35272&2/RSWLRQ
XVLQJ
QHWZRUNOLPLWDWLRQ
DOWHUQDWLYHVRWKHUWKDQ,QQR'%
LQKHDY\VFHQDULRVEODFNKROHVWRUDJHHQJLQH
XVHG
QHWBZULWHBWLPHRXWYDOXHVVHWWLQJ
QHZFROXPQV
DGGLQJDWVSHFLÀFSRVLWLRQV
12B$872B9$/8(B21B=(52RSWLRQ
QRUPDOL]HGWH[WVHDUFKFROXPQ
DERXW
FUHDWLQJ
JHWWLQJUHDG\
ZRUNLQJ
2
237,0,=(7$%/(FRPPDQG
XVLQJ
RYHUDOOWDEOHFRXQWDVVHVVLQJ
UHTXLUHPHQWV
VWHSV
ZRUNLQJ
3
S]LS
SODLQWH[WSDVVZRUGV
DYRLGLQJLQVFULSWV
SUHÀ[SULPDU\NH\V
XVLQJ
ZRUNLQJ
SULPDU\NH\
GHÀQLQJIRUQRQXQLTXHGDWDWDEOH
SUREOHPDWLFTXHULHV
DERXW
DOWHUQDWLYHVROXWLRQ
VNLSSLQJ
VNLSSLQJWHVWLQJ
ZRUNLQJ
3X77<WHPSODWHFRQQHFWLRQ
DERXW
66+FRQQHFWLRQXVLQJ
XVLQJVWHSV
ZRUNLQJ
4
TXHU\SHUIRUPDQFHLPSURYHPHQW,QQR'%
WDEOHV
%/2%XVLQJ
5
5%5
5'%06
UHDGDFFHVVVKDULQJDFURVVPXOWLSOH
PDFKLQHV
DERXW
FRQQHFWLRQSRROLQJZRUNLQJZLWK
JHWWLQJUHDG\
SURJUDPPLQJHQYLURQPHQWVZRUNLQJRQ
VODYHDGGLWLRQHIÀFLHQF\FRQVLGHULQJ
VWHSV
ZRUNLQJ
UHDGRQO\DFFRXQW
FUHDWLQJ
FUHDWLQJZLWKRXWXVLQJ0\64/$GPLQLVWUDWRU

VWRUHGSURFHGXUHFDOOVDOORZLQJ
UHGRLQJ
UHGRORJFRQÀJXULQJ
UHTXLUHPHQWV
VWHSV
5HODWLRQDO'DWDEDVH0DQDJHPHQW6\VWHP
6HH5'%06
UHSOLFDWLRQ
DERXW
JHWWLQJUHDG\
5%5
6%5
VWDWHPHQWH[HFXWLQJ
XVLQJWRSHUIRUPEDFNXSV
XVLQJWRSURYLGHIXOOWH[WLQGH[IRU,QQR'%
WDEOHV


5(3/,&$7,216/$9(SULYLOHJH
UROOIRUZDUG
5RZ%DVHG5HSOLFDWLRQ6HH5%5
6
6%5
DERXW
DUFKLWHFWXUH
IHDWXUHV
ÀOWHULQJ
VFKHPDGLIIHUHQFHV
LGHQWLI\LQJ
LGHQWLI\LQJVWHSV
VFKHPDPDQDJHPHQW
DERXW
$/7(57$%/(SHUIRUPDQFHLPSURYLQJ
,QQR'%WDEOHVTXHU\SHUIRUPDQFHLPSURYLQJ

,16(57VWDWHPHQWVJOREDOO\DOORZLQJZLWK
YDOXHV
0\64/VWRUDJHHQJLQHDUFKLWHFWXUH
QHZFROXPQVDGGLQJDWVSHFLÀFSRVLWLRQV

SULPDU\NH\GHÀQLQJIRUQRQXQLTXHGDWD
WDEOH
VFKHPDGLIIHUHQFHVLGHQWLI\LQJ
VFKHPDUHYLVLRQVFRPSDULQJ
VWRUDJHHQJLQHFKRRVLQJ
VWRUHGSHUIRUPDQFHXVLQJ
VFKHPDUHYLVLRQVFRPSDULQJ
GEKDVKMDUÀOHSURJUDPVDFWLYLWLHV
KDVKYDOXHVXVLQJ
6(/LQX[
WXUQLQJRII
VHUYHUV\QF
FKHFNLQJVWHSV
PNWDEOHFKHFNVXPWRROXVLQJ
PNWDEOHFKHFNVXPWRROZRUNLQJ
6(7*/2%$/FRPPDQG
6+2:6/$9(+2676FRPPDQG
6+2:7$%/(67$786FRPPDQG
VLOHQWUHSOLFDWLRQGLVUXSWLRQ
DYRLGLQJRQIXOOPDVWHUGLVN
6/$9(B&2035(66('B35272&2/RSWLRQ
XVLQJ
VODYHFRQÀJXUDWLRQ
JHWWLQJUHDG\
UHSRUWKRVWVHWWLQJ
UHSRUWSDVVZRUGVHWWLQJ
UHSRUWSRUWVHWWLQJ
UHSRUWXVHUVHWWLQJ
VHWWLQJXSWRXSGDWHPDVWHU
VODYH,2ORDGHVWLPDWLRQ
DERXW
LQGLYLGXDOVODYHV·QHWZRUNVSHHGFKHFNLQJ
UHTXLUHPHQWV
6/$9(B&2035(66('B35272&2/RSWLRQ
XVLQJ
ZRUNLQJ
VODYHVVHWWLQJXSYLDQHWZRUNVWUHDPLQJ
FRQÀJXUDWLRQVHWWLQJXS
FXUOWRROXVLQJ
GDWDGLUHFWRU\FRPSUHVVLQJ
JHWWLQJUHDG\
PDVWHULQIRÀOHXQGHUVWDQGLQJ
P\VTOGXPSWRROXVLQJ
67$576/$9(VWDWHPHQWLVVXLQJ
VWHSV
WHPSRUDU\GDHPRQ
WHPSRUDU\VHUYHUVKXWWLQJGRZQ
ZRUNLQJ
VRXUFHFRPPDQG
VSHFLÀFXVHU
GHÀQLQJIRUEDFNXS
GHÀQLQJIRUUHSOLFDWLRQ
6SKLQ[
VSOLWWRRO
64/FRQÀJXUDWLRQ
IRUFXUUHQWVHVVLRQRQO\
64/GXPS
EDFNXSVL]HUHGXFLQJ
FUHDWLQJRIDOOGDWDEDVHV
FUHDWLQJRIVSHFLÀFWDEOHV
FUHDWLQJRIVSHFLÀFGDWDEDVHV
64/GXPSFUHDWLRQRIDOOGDWDEDVHV
ELQDU\ORJSRVLWLRQLQFOXGLQJ
FRQVLVWHQF\SUHYHQWLQJ
FRQVLVWHQWGXPSVSHUIRUPLQJ
JHWWLQJUHDG\
,QQR'%WDEOHGXPSVFUHDWLQJ
ORFNLQJLVVXH,QQR'%VWRUDJHHQJLQHXVHG



SHUIRUPLQJLPSDFWVUHGXFLQJ
VWHSV
ZRUNLQJ
64/GXPSFUHDWLRQRIVSHFLÀFGDWDEDVHV
DGYDQWDJHV
DXWRPDWHGEDFNXSVVLGHHIIHFWV
JHWWLQJUHDG\
VWHSV
ZRUNLQJ
ZRUNSDUDOOHOL]LQJ
64/GXPSFUHDWLRQRIVSHFLÀFWDEOHV
JHWWLQJUHDG\
VWHSV
ZRUNLQJ
6WDWHPHQW%DVHG5HSOLFDWLRQ6HH6%5
VWRUDJHHQJLQH
FKRRVLQJ
VLOHQWHQJLQHVXEVWLWXWLRQ
VWRUHGFRQQHFWLRQ0\64/*8,7RROV
DXWRPDWLFDOO\FUHDWHGZRUNLQJ
FUHDWLQJDXWRPDWLFDOO\
VRUWLQJ
VRUWLQJUHTXLUHPHQWV
VRUWLQJVWHSV
ZRUNLQJ
VWRUHGSURFHGXUHV
GHÀQLQJ
VWDUWLQJZLWK
XVLQJIRUFROXPQDGGLWLRQ
XVLQJIRULQGH[DGGLWLRQ
XVLQJWRH[SRUW
ZRUNLQJ
7
WDEOHOHWWHUFDVH
DERXW
DGMXVWLQJ
UHTXLUHPHQWV
WDEOHUHIHUHQFH
DERXW
ÀQGLQJ
UHTXLUHPHQWV
ZRUNLQJ
WDEOHVSDFH
DERXW
LQQRGEBÀOHBSHUBWDEOHIHDWXUHXVLQJ
VKDUHGWDEOHVSDFHZRUNLQJ
VL]HGHFUHDVLQJ
WDEOHVSDFHUHTXLUHPHQWHVWLPDWLQJ
DERXW
UHTXLUHPHQWV
VDPSOHYDOXHVFKRRVLQJ
VWHSV
ZRUNLQJ
WHPSRUDU\GLUHFWRULHV
XVLQJIRUPXOWLSOH0\64/VHUYHUV
7(;7
WLPHRXWFRQÀJXUDWLRQVHWWLQJV
DSSO\LQJUHTXLUHPHQWV
FRQÀJXULQJ
LQQRGEBORFNBZDLWBWLPHRXWRSWLRQYDOXHVHW
WLQJV
LQQRGEBUROOEDFNBRQBWLPHRXWRSWLRQYDOXHV
VHWWLQJV
LQWHUDFWLYHBWLPHRXWYDOXHVVHWWLQJ
QHWBUHDGBWLPHRXWYDOXHVVHWWLQJ
QHWBZULWHBWLPHRXWYDOXHVVHWWLQJ
ZDLWBWLPHRXWYDOXHVVHWWLQJ
ZRUNLQJ
WRROV
0\64/FRPPDQGOLQHFOLHQW
0\64/*8,7RROV
RIÀFLDOWRROV
WURXEOHVKRRWLQJHUURUV
7581&$7(7$%/(FRPPDQG
XVLQJ
8
81/2&.7$%/(6FRPPDQG
XVHUULJKWVPDQDJHPHQW
SHUPLWWLQJ
9
9$5&+$5
:
ZDLWBWLPHRXWYDOXHVVHWWLQJ
;
[FRS\FRPPDQG
[VOWSURFFRPPDQG

