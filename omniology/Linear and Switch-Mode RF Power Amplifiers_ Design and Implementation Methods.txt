www.ebook3000.com

Linear and Switch-Mode 
RF Power Amplifiers

www.ebook3000.com

Linear and Switch-Mode 
RF Power Amplifiers
Design and Implementation Methods
Abdullah Eroglu

MATLAB® is a trademark of The MathWorks, Inc. and is used with permission. The MathWorks 
does not warrant the accuracy of the text or exercises in this book. This book’s use or discussion 
of MATLAB® software or related products does not constitute endorsement or sponsorship by The 
MathWorks of a particular pedagogical approach or particular use of the MATLAB® software
CRC Press
Taylor & Francis Group
6000 Broken Sound Parkway NW, Suite 300
Boca Raton, FL 33487-2742
© 2018 by Taylor & Francis Group, LLC
CRC Press is an imprint of Taylor & Francis Group, an Informa business
No claim to original U.S. Government works
Printed on acid-free paper
International Standard Book Number-13: 978-1-4987-4576-5 (Hardback)
	
978-1-1387-4577-3 (Paperback)
This book contains information obtained from authentic and highly regarded sources. Reasonable 
efforts have been made to publish reliable data and information, but the author and publisher cannot 
assume responsibility for the validity of all materials or the consequences of their use. The authors 
and publishers have attempted to trace the copyright holders of all material reproduced in this 
publication and apologize to copyright holders if permission to publish in this form has not been 
obtained. If any copyright material has not been acknowledged, please write and let us know so we 
may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, 
transmitted, or utilized in any form by any electronic, mechanical, or other means, now known or 
hereafter invented, including photocopying, microfilming, and recording, or in any information 
storage or retrieval system, without written permission from the publishers.
For permission to photocopy or use material electronically from this work, please access www.
copyright.com (http://www.copyright.com/) or contact the Copyright Clearance Center, Inc. (CCC), 
222 Rosewood Drive, Danvers, MA 01923, 978-750-8400. CCC is a not-for-profit organization that 
provides licenses and registration for a variety of users. For organizations that have been granted a 
photocopy license by the CCC, a separate system of payment has been arranged.
Trademark Notice: Product or corporate names may be trademarks or registered trademarks and 
are used only for identification and explanation without intent to infringe.
Visit the Taylor & Francis Web site at
http://www.taylorandfrancis.com
and the CRC Press Web site at
http://www.crcpress.com
www.ebook3000.com

Dedicated to my family who has always shown 
great patience and support for my research.

www.ebook3000.com

vii
Contents
Preface.......................................................................................................................xi
Acknowledgments................................................................................................... xiii
Author.......................................................................................................................xv
Chapter 1	
Radio Frequency Amplifier Basics.......................................................1
1.1	
Introduction................................................................................1
1.2	
Types of Amplifiers: Small Signal and Large Signal 
Amplifiers����������������������������������������������������������������������������������1
1.3	
Linear Amplifiers.......................................................................3
1.4	
Switch-Mode Amplifiers............................................................5
1.5	
Power Transistors.......................................................................7
1.5.1	
BJT and HBTs...............................................................8
1.5.2	
FETs..............................................................................8
1.5.2.1	
MOSFETs....................................................10
1.6	
Passive Devices........................................................................12
1.6.1	
Inductor.......................................................................12
1.6.1.1	
Air-Core Inductor Design............................ 14
1.6.1.2	
Magnetic-Core Inductor Design.................. 14
1.6.1.3	
Planar Inductor Design................................ 16
1.6.2	
Capacitor..................................................................... 18
1.6.3	
Resistor........................................................................19
References........................................................................................... 21
Chapter 2	
Two-Port Parameters...........................................................................23
2.1	
Introduction..............................................................................23
2.2	
Network Parameters.................................................................23
2.2.1	
Z-Impedance Parameters............................................23
2.2.2	
Y-Admittance Parameters............................................24
2.2.3	
ABCD Parameters.......................................................25
2.2.4	
h-Hybrid Parameters...................................................26
2.3	
Network Connections...............................................................30
2.4	
S-Scattering Parameters...........................................................36
2.4.1	
One-Port Network.......................................................37
2.4.2	
N-Port Network...........................................................39
2.4.3	
Normalized Scattering Parameters.............................43
References........................................................................................... 51
Chapter 3	
Impedance Matching and Resonant Networks...................................53
3.1	
Introduction..............................................................................53
3.2	
Transmission Lines...................................................................53

viii
Contents
3.2.1	
Limiting Cases for Transmission Lines......................57
3.2.2	
Terminated Lossless Transmission Lines...................59
3.2.3	
Special Cases of Terminated Transmission Lines......64
3.3	
Smith Chart..............................................................................66
3.3.1	
Input Impedance Determination with Smith Chart....... 72
3.3.2	
Smith Chart as an Admittance Chart..........................76
3.3.3	
ZY Smith Chart and Its Application............................76
3.4	
Impedance Matching between Transmission Lines and 
Load Impedances��������������������������������������������������������������������80
3.5	
Single Stub Tuning...................................................................83
3.5.1	
Shunt Single Stub Tuning............................................84
3.5.2	
Series Single Stub Tuning...........................................85
3.6	
Impedance Transformation and Matching between 
Source and Load Impedances�������������������������������������������������86
3.7	
Resonator Networks.................................................................89
3.7.1	
Parallel and Series Resonant Networks.......................90
3.7.1.1	
Parallel Resonance.......................................90
3.7.1.2	
Series Resonance.........................................97
3.7.2	
Parallel LC Networks................................................102
3.7.2.1	
Parallel LC Networks with Ideal 
Components����������������������������������������������102
3.7.2.2	
Parallel LC Networks with Nonideal 
Components����������������������������������������������103
3.7.2.3	
Loading Effects on Parallel LC 
Networks������������������������������������������������106
3.8	
LC Resonators as Impedance Transformers...........................108
3.8.1	
Inductive Load...........................................................108
3.8.2	
Capacitive Load.........................................................109
3.9	
Tapped Resonators as Impedance Transformers.................... 112
3.9.1	
Tapped-C Impedance Transformer........................... 112
3.9.2	
Tapped-L Impedance Transformer............................ 117
3.10	 Signal Flow Graphs................................................................ 117
References.........................................................................................123
Chapter 4	
Small-Signal Amplifiers....................................................................125
4.1	
Amplifier Basic Terminology.................................................125
4.1.1	
Gain...........................................................................125
4.1.2	
Efficiency...................................................................127
4.1.3	
Power Output Capability...........................................128
4.1.4	
Linearity....................................................................129
4.1.5	
1 dB Compression Point............................................130
4.1.6	
Harmonic Distortion................................................. 131
4.1.7	
Intermodulation.........................................................134
4.2	
Small-Signal Amplifier Design.............................................. 139
4.2.1	
DC Biasing Circuits.................................................. 143
www.ebook3000.com

ix
Contents
4.2.2	
BJT Biasing Circuits................................................. 145
4.2.2.1	
Fixed Bias.................................................. 145
4.2.2.2	
Stable Bias................................................. 146
4.2.2.3	
Self-Bias..................................................... 149
4.2.2.4	
Emitter Bias...............................................150
4.2.2.5	
Active Bias Circuit..................................... 151
4.2.2.6	
Bias Circuit Using Linear Regulator......... 151
4.2.3	
FET Biasing Circuits................................................. 153
4.2.4	
Small-Signal Amplifier Design Method................... 153
4.2.4.1	
Definitions of Power Gains for 
Small-Signal Amplifiers���������������������������154
4.2.4.2	 Design Steps for Small-Signal 
Amplifier�����������������������������������������������158
4.2.4.3	
Small-Signal Amplifier Stability............... 159
4.2.4.4	
Constant Gain Circles................................ 165
4.2.4.5	
Unilateral Figure of Merit......................... 170
References......................................................................................... 186
Chapter 5	
Linear Amplifier Design and Implementation.................................. 187
5.1	
Large-Signal RF Amplifier Design Techniques..................... 187
5.2	
Push–Pull Amplifier Configuration....................................... 191
5.3	
Parallel Transistor Configuration...........................................194
5.4	
PA Module Combiners...........................................................194
5.5	
Linear Amplifiers...................................................................194
5.5.1	
Conventional Amplifiers: Classes A, B, and C.........199
5.6	
Class A Amplifiers.................................................................202
5.7	
Class B....................................................................................204
5.8	
Class AB.................................................................................208
5.9	
Class C....................................................................................208
5.9.1	
Design Example........................................................ 211
References......................................................................................... 217
Chapter 6	
Switch-Mode Amplifier Design and Implementation....................... 219
6.1	
Introduction............................................................................ 219
6.2	
Class D Amplifiers................................................................. 219
6.2.1	
Voltage-Mode Class D Amplifiers............................ 219
6.2.2	
Current Mode Class D Amplifiers............................225
6.3	
Class E Amplifiers..................................................................228
6.3.1	
Conventional Analysis of Class E Amplifiers...........228
6.3.1.1	
Suboptimum Conditions for Class E 
Amplifier Design��������������������������������������228
6.3.1.2	
Optimum Conditions Class E 
Amplifier Design��������������������������������������236
6.3.2	
Harmonic Modeling of Class E Amplifiers..............242

x
Contents
6.4	
Class DE Amplifiers...............................................................247
6.4.1	
Analysis of Series Resonant Network.......................250
6.5	
Class F Amplifiers..................................................................255
6.5.1	
Class S.......................................................................263
References.........................................................................................286
Chapter 7	
Phase-Controlled Switch-Mode Amplifiers......................................289
7.1	
Introduction............................................................................289
7.2	
Phase Control of a Class E Power Amplifier Pair..................289
7.2.1	
Implementation of Harmonic Modeling....................292
7.2.1.1	
Single-Ended Class E Power Amplifier.....292
7.2.1.2	
Phase-Controlled Class E Power 
Amplifier���������������������������������������������������299
7.3	
Pulsing of Switch-Mode Amplifiers.......................................302
7.3.1	
Pulsing of Class E Amplifiers...................................302
7.3.1.1	
Simulation Results.....................................304
7.3.1.2	
Experimental Results................................. 310
References.........................................................................................320
Chapter 8	
Distortion and Modulation Effects in RF Power Amplifiers............323
8.1	
Introduction............................................................................323
8.2	
Ideal Quadrature Modulator...................................................324
8.3	
Nonideal Quadrature Modulator............................................326
8.3.1	
I Path.........................................................................327
8.3.2	
Q Path........................................................................329
8.3.3	
Output of Nonideal Quadrature Modulator.............. 332
8.4	
Improved Method for Image Band Rejection......................... 333
8.4.1	
LO Cancellation........................................................338
8.4.2	
Simulation Results.....................................................342
8.4.2.1	
Simulation Model......................................342
8.4.2.2	
Simulation Results.....................................345
References......................................................................................... 351
Index����������������������������������������������������������������������������������������������������������������������353
www.ebook3000.com

xi
Preface
Radio frequency power amplifiers are critical part of communication, semiconduc-
tor wafer processing, magnetic resonance imaging (MRI), and radar systems. The 
amplifier system not only requires expertise in the design of amplifier topologies, but 
it also requires knowledge in the design of its surrounding components. The authors’ 
previous two books, Introduction to RF Circuit Design Techniques for MF-UHF 
Applications and Introduction to RF Power Amplifier Design and Simulation, have 
presented the design and simulation of the amplifier components and devices. This 
book is written to provide the implementation methods for RF amplifiers, which 
can operate in linear or switch mode via several real-world engineering problems. 
Step-by-step design methods to design amplifiers are exemplified with several design 
problems. MATLAB, Matchcad Pspice, and ADS simulation tools are used to aid the 
design process. All the design examples given include analytical design, simulation 
verification, and measurement results of the built prototype.
The scope of each chapter in this book can be summarized as follows. Chapter 1 
gives introduction to RF Power amplifiers and topologies and discussion on passive 
and active components and surrounding devices for RF power amplifiers. Chapter 2 
discusses two-port parameters including Z, Y, h, ABCD, and scattering parame-
ters, which can be used to design small-signal amplifiers. In Chapter 3, impedance 
matching and resonant networks for amplifiers are detailed. In Chapter 4, small-
signal amplifier design methods are introduced with simulation and implementation 
examples. Chapter 5 discusses design, analysis, and implementation of large-signal 
amplifier design methods. In this chapter, RF linear amplifiers and different biasing 
schemes have been presented. The design and implementation of Classes A, B, and 
AB are given with examples. Furthermore, Class C amplifier design in different 
modes is also detailed.
In Chapter 6, the design and implementation of RF switch-mode amplifiers 
including Classes D, E, DE, F, and S topologies have been discussed with applica-
tion and implementation examples. Generic MATLAB and Mathcad design algo-
rithms to design Classes D, DE, E, and F amplifiers are given. Chapter 7 presents 
phase-controlled switch-mode amplifiers using harmonic modeling. RF pulsing 
amplifier design techniques and implementation methods are also discussed in this 
chapter. Characterization methods for amplifiers have been illustrated using load-
pull technique. In Chapter 8, distortion and modulation effects for amplifiers and 
the method for elimination of the impairments causing these defects have been 
detailed.
It is important to note that engineering application examples are given in every 
chapter for each subject to solidify the theory and help designers have hands-on 
experience of the design problems. Implementation of RF amplifiers is given step 
by step to make it possible for professionals and students use this book as the main 
resource.

xii
Preface
MATLAB® is a registered trademark of The MathWorks, Inc. For product informa-
tion, please contact:
The MathWorks, Inc.
3 Apple Hill Drive
Natick, MA 01760-2098 USA
Tel: 508-647-7000
Fax: 508-647-7001
E-mail: info@mathworks.com
Web: www.mathworks.com
www.ebook3000.com

xiii
Acknowledgments
I would like to thank my wife, G. Dilek, for her greatest support, including editorial 
corrections in the book.
The completion of this book was possible during my sabbatical leave from my 
home institution, Purdue University Fort Wayne, and I thank it for the support. 
I would also like to thank University of Gavle, Sweden for hosting me during some 
portion of that period, which helped me complete this project.
I would also like to thank my editor, Nora Konopka, for her patience and support 
during the course of the preparation and publication of this book.

www.ebook3000.com

xv
Author
Abdullah Eroglu is a professor of electrical engineering at the Electrical and 
Computer Engineering Department of Purdue University, Fort Wayne. He previ-
ously worked as a radio frequency (RF) senior design engineer at MKS Instruments, 
ENI Products, Rochester, New York, and as a faculty fellow in the Fusion Energy 
Division of Oak Ridge National Laboratory, Oak Ridge, Tennessee. 
His research focuses on design and development of RF devices for applications 
including communication, energy, semiconductor manufacturing, and health care. 
He also investigates the propagation and radiation characteristics of materials for 
microwave and RF applications.
He earned a PhD in electrical engineering at Syracuse University, Syracuse, New 
York. He is a recipient of several research awards, including 2013 IPFW Outstanding 
Researcher Award, 2012 IPFW Featured Faculty Award, 2011 Sigma Xi Researcher 
of the Year Award; and 2010 IPFW College of Engineering, Technology, and 
Computer Science Excellence in Research Award. 
Dr. Eroglu is the author of five books and has published more than 100 peer-
reviewed journals and conference papers. He has several patents in RF component, 
device design, and methodology.  He also serves as a reviewer and editorial board 
member for several journals.

www.ebook3000.com

1
1 Radio Frequency 
Amplifier Basics
1.1  INTRODUCTION
Radio frequency (RF) power amplifiers are one of the critical elements for commu-
nication systems when signal in use needs to be amplified for several applications. 
The simplified RF power amplifier block diagram is shown in Figure 1.1.
Radio frequency power amplifiers consist of several surrounding components. 
The main component of the amplifier is the active device that is critical in the ampli-
fication process. The surrounding components in the amplifier are matching net-
works that are implemented at the input and output of the amplifier, biasing network, 
stability networks, filters that are used to eliminate spurious or harmonic contents, 
and control system of the amplifier to ensure the functionality of the amplifier against 
various conditions.
The type and class of the amplifier are important parameters in the design pro-
cess, apart from the design of its surrounding components. The amplifier type can be 
small signal or large signal based on the design, whereas class of the amplifier might 
belong to a group of linear or switch-mode class of amplifiers. The type and class of 
the amplifier are based on the application and requirements identified beforehand for 
the designer. In this book, different components, types, and classes of the amplifiers; 
mathematical and computer tools that are used to design, simulate, and implement 
RF; and microwave amplifier and components will be discussed.
1.2  TYPES OF AMPLIFIERS: SMALL SIGNAL 
AND LARGE SIGNAL AMPLIFIERS
Amplifiers have inherently nonlinear characteristics owing to active devices that are 
used during amplification process. However, when signal levels are small enough, it 
does not cause distortion to vary parameters of the active devices, which results in 
the linear relationship between input and output of the amplifier.
When the conditions satisfy the requirements of the linear approximation, ampli-
fiers can be analyzed using two-port parameters and network methods. The type of 
the amplifiers in this group are called as small signal amplifiers. The efficiency of 
small signal amplifiers is not critical. The design for this type of amplifiers use com-
plex conjugate matching method.
For high-power applications, large signal levels are applied for amplification, and 
this causes distortion in the amplifier due to variation of the active device param-
eters. Hence, small signal analysis and techniques cannot be applied anymore for 
these types of amplifiers. The type of the amplifiers in this group are called as large 
signal amplifiers. The conventional conjugate matching method also does not deliver 

2
Linear and Switch-Mode RF Power Amplifiers
the maximum power to the load connected at the output of the amplifier. Hence, the 
technique called load line matching [1] needs to be implemented to overcome the 
limitations due to physical rating of active device and have the maximum voltage and 
current swing. The optimum load impedance that will give the practical maximum 
power can be obtained from the maximum swing points for voltage and current from
	
=
R
V
I
opt
max_swing
max_swing
	
(1.1)
The difference between conjugate matching used in small signal amplifier design 
and load matching used in large signal amplifier design can be better understood 
using the simplified circuit given in Figure 1.2.
The maximum power transfer in the circuit shown in Figure 1.2 occurs when
	
=
= −
R
R
B
B
and
g
L
g
L.	
(1.2)
If we assume that there are no device or component limitations in the circuit, then 
this will hold true, and the maximum power will be transferred as indicated for small 
Ig
Rg
Bg RL
BL
IL
VL
+
FIGURE 1.2  Simplified circuit for large signal and small signal analysis.
Input 
matching
network
Vg
ZL
Output 
matching
network
Zg
Vdc
Rchoke
FIGURE 1.1   Basic block diagram of RF power amplifiers.
www.ebook3000.com

3
Radio Frequency Amplifier Basics
signal analysis. However, if there is limitation for voltage or current, this cannot be 
applied. For instance, for the circuit in Figure 1.2, let us assume 
=
Ω
R
50 [ ]
g
 and the 
maximum operating voltage and current are 
=
V
V
20 [ ]
max
, 
=
I
A
2 [ ]
max
Then, the maximum power transfer using conjugate method dictates that
	
=
=
Ω
R
R
50 [ ]
L
L
Since, RL and Rg are in parallel, the equivalent impedance is 
=
Ω
R
25 [ ]
eq
. The output 
voltage is then calculated to be
	
( )(
)
=
=
=
>
V
I
R
V
V
2
25
50 [ ] 
 
,
L
max
eq
max
which is more than the amount of maximum voltage that can be handled in the cir-
cuit. Hence, the maximum current that can be obtained with this configuration by 
staying within the given operating limit of the voltage is 
=
I
0.8 [A]
L,max
. Then, the 
maximum power without exceeding the operating limit is
	
P
I
V
0.8
20
16 [W].
L,max
L,max
L,max
(
)(
)
=
=
=
Now, let us assume, we would like to use the load line matching method, which is the 
viable design method for large signal amplifiers. Then, the optimum load resistance 
is calculated to be
	
[ ]
=
=
=
Ω
R
V
I
20
2
10 
L
max
max
Then, the power that can be obtained with this configuration is
	
=
=
=
P
I
V
(2)(20)
40 [W] .
L,max
L,max
L,max
This is the method that can now utilize the ratings of devices and gives maximum 
power attainable in practice.
Large signal amplifiers can be classified as Class A, Class B, and Class AB for 
linear mode of operation and Class C, Class D, Class E, and Class F for nonlinear 
mode of operation. Classes D, E, and F are also known as switch-mode amplifiers.
1.3  LINEAR AMPLIFIERS
Consider the amplifier voltage transfer characteristics illustrated in Figure 1.3. The 
output of the amplifier is linearly proportional to the input of the amplifier via volt-
age gain β. The output voltage will be identical to the input voltage. The relationship 
between input and output of the amplifier can be expressed mathematically as
	
= β
v t
v t
( )
( ).
o
i
	
(1.3)

4
Linear and Switch-Mode RF Power Amplifiers
When the transistor is operated as a voltage-dependent current source, linear opera-
tional mode for the amplifiers can be obtained. The conduction angle, θ, is then 
used to determine the class of the amplifier [2]. The conduction angle varies up to 
2π based on the amplifier class. The use of transistor as a dependent current source 
represents linear mode of operation, which is shown in Figure 1.4.
The conduction angles, bias, and quiescent points for linear amplifier are illus-
trated in Table 1.1. Conduction angle, θ, is defined as the duration of the period in 
which the given transistor is conducting. The full cycle of conduction is considered 
to be 360°. The points of intersection with the load line are known as the “quiescent” 
Vin
PA
Vin
Vout
t
Slope = β
Vin
t
FIGURE 1.3  Linear amplifier voltage transfer characteristics.
RFchoke
Cd
Vds
+
+
Io
ID
IDC
VCd
Vo
RL
IL
C
L
ZtLn
ZtLn
Vdc
FIGURE 1.4  Equivalent circuit representation of linear amplifier mode of operation.
www.ebook3000.com

5
Radio Frequency Amplifier Basics
conditions or “Q points” or the dc bias conditions for the transistor, which represent 
the operational device voltages and drain current as shown in Figure 1.5.
Classes A, AB, and B amplifiers have been used for linear applications where ampli-
tude modulation (AM), single-sideband modulation (SSB), and quadrate amplitude 
modulation (QAM) might be required. The summary of the operational characteristics 
of linear amplifiers and Class C nonlinear amplifiers is given in Tables 1.2 and 1.3.
1.4  SWITCH-MODE AMPLIFIERS
When the transistor is used as switch, then the amplifier operates in nonlinear mode 
of operation, and it can be illustrated with the equivalent circuit in Figure 1.6. Classes 
C, D, E, and F are usually implemented for narrowband-tuned amplifiers when high 
efficiency is desired with high power. Classes A, B, AB, and C are operated as trans-
conductance amplifiers, and the mode of operation depends on the conduction angle.
VDS
ID
Vsat
Imax
Vmax
Class C
Class B
Class AB
Class A
FIGURE 1.5  Load lines and bias points for linear amplifiers.
TABLE 1.1
Conduction Angles, Bias, and Quiescent Points for 
Linear Amplifiers
Class
Bias Point
Quiescent Point
Conduction Angle
A
0.5
0.5
2π
AB
0–0.5
0–0.5
π–2π
B
0
0
π
C
<0
0
0–π

6
Linear and Switch-Mode RF Power Amplifiers
TABLE 1.2
Summary of Linear Amplifier Operational Characteristics
Amplifier 
Class
Mode
Transistor (Q) 
Operation
Pros
Cons
A
Linear
Always conducting
Most linear, lowest 
distortion
Poor efficiency
B
Linear
Each device is on 
half cycle
ηB > ηA
Worse linearity than 
Class A
AB
Linear
Mid conduction
Improved linearity with 
respect to Class B
Power dissipation for 
low signal levels 
higher than Class B
C
Nonlinear
Each device is on 
half cycle
High Po
Inherent harmonics
TABLE 1.3
Summary of Linear Amplifier Performance Parameters
Amplifier 
Class
Max 
Efficiency 
[ ]
ηη
%
max
Normalized RF 
Output Power 
V
R
/2
Po,max
dc
2
L
Normalized
Vds,max
 
V
V
m
dc
Normalized
Id,max
 
I
I
m
dc
Power
Capability
P
V I
o,max
m m
A
50
1
2
2
0.125
B
78.5
1
2
π = 3.14
0.125
C
86 (θ = 71°)
1
2
3.9
0.11
RF, radio frequency.
RFchoke
Cd
Vds
+
+
Io
ID
IDC
VCd
Vo
RL
IL
C
L
ZtLn
Vdc
FIGURE 1.6  Equivalent circuit representation of nonlinear amplifier mode of operation.
www.ebook3000.com

7
Radio Frequency Amplifier Basics
In switch-mode amplifiers such as Classes D, E, and F, the active device is inten-
tionally driven into saturation region, and it is operated as a switch rather than a cur-
rent source unlike Class A, AB, B, or C amplifiers as shown in Figure 1.4. In theory, 
power dissipation in the transistor can be totally eliminated, and hence, 100% effi-
ciency can be achieved for switch-mode amplifiers.
The summary of some of the switch-mode amplifier performance parameters 
including efficiency, normalized RF power, normalized maximum drain voltage 
swing, and power capability are given in Table 1.4. Table 1.5 compares each ampli-
fier class based on transistor operation and application and gives the advantages and 
disadvantages of each class.
1.5  POWER TRANSISTORS
The selection of a transistor that will be used for amplification in RF amplifier is very 
critical, because it can affect the performance of the amplifier parameters including 
efficiency, dissipation, power delivery, stability, linearity, etc. Once the transistor is 
TABLE 1.4
Summary of Switch-Mode Amplifier Operational Characteristics
Amplifier 
Class
Max 
Efficiency 
[ ]
ηη
%
max
Normalized RF 
Output Power 
V
R
/2
Po,max
dc
2
L
Normalized
Vds,max
 
V
V
m
dc
Normalized
Id,max
 
I
I
m
dc
Power 
Capability 
P
V I
o,max
m m
D
100
16/π2 = 1.624
2
π/2 = 1.57
1/π = 0.318
E
100
4/(1 + π2/4) = 1.154
3.6
2.86
0.098
F
100
16/π2 = 1.624
2
π = 3.14
1/2π = 0.318
TABLE 1.5
Summary of Switch-Mode Amplifier Performance Parameters
Amplifier 
Class
Mode
Transistor (Q) 
Operation
Pros
Cons
D
Switch mode
Q1 and Q2 switched 
on/off alternately
Max efficiency and 
best power
Device parasitics 
are issue at high 
frequencies 
E
Switch-mode
Transistor is switched 
on/off 
Max efficiency, no 
loss due to parasitics
High-voltage stress 
on transistor
F
Switch mode
Transistor is switched 
on/off
Max efficiency and 
no harmonic power 
delivered
Power loss due to 
discharge of output 
capacitance
S
Switch mode
Q1 and Q2 are switched 
on/off with modulated 
signal
Wider dynamic range 
and high efficiency
Upper frequency 
range is limited

8
Linear and Switch-Mode RF Power Amplifiers
selected for the corresponding amplifier topology, size of the transistor, die place-
ment, bond pads, bonding of the wires, and lead connections will determine the lay-
out of the amplifier and the thermal management of the system. The most commonly 
used RF and microwave power devices for commercial purposes are based on silicon 
(Si), gallium arsenide (GaAs), and its compounds. There is an intense research in the 
development of high-power density devices using materials that have a wide bandgap 
such as silicon carbide (SiC) and gallium nitride (GaN). Fundamentally, the device 
performance is determined by several parameters including material energy band-
gap, breakdown field, electrons and holes transport properties, thermal conductivity, 
saturated electron velocity, and conductivity. The typical values of these parameters 
for various types of semiconductor materials are given in Table 1.6.
The power device family tree can be simplified and is shown in Figure 1.7.
1.5.1  BJT and HBTs
A typical npn bipolar junction transistor (BJT) is formed out of silicon and the emit-
ter and collector regions that are implanted with donors. There are differences in the 
characteristics of field effect transistor (FET) and heterojunction bipolar transistor 
(HBT) devices. The main difference between BJT and HBT is the introduction of 
heterojunction at the emitter–base interface in the HBT device [3]. This can be illus-
trated in Figure 1.8.
FET is a planar device, whereas HBT is a vertical device. The HBT device is 
an enhanced version of conventional BJTs, as a result of the exploitation of hetero-
structure junctions [4]. Unlike conventional BJTs, in HBTs the bandgap difference 
between the emitter and the base materials results in higher common emitter gain. 
Base sheet resistance is lower than that in ordinary BJTs, and the resulting operating 
frequency is accordingly higher [5].
1.5.2  FETs
The FET family includes a variety of structures, among which are metal-semiconductor 
field-effect transistors (MESFETs), MOSFETs, HEMTS, etc. They typically consist 
TABLE 1.6
Typical Parameter Values for Semiconductor Materials
RF High-Power 
Material
μ [cm2/Vs]
εr
Eg [eV]
Thermal 
Conductivity 
[W/cmK]
Ebr 
[MV/cm]
JM = 
Ebrvsat/2π
Tmax [°C]
Si
1350
11.8
1.1
1.3
0.3
1.0
300
GaAs
8500
13.1
1.42
0.46
0.4
2.7
300
SiC
700
9.7
3.26
4.9
3.0
20
600
GaN
1200 (Bulk)
2000 (2DEG)
9.0
3.39
1.7
3.3
27.5
700
RF, radio frequency.
www.ebook3000.com

9
Radio Frequency Amplifier Basics
of a conductive channel accessed by two ohmic contacts, acting as source (S) and 
drain (D) terminals, respectively. The third terminal, the gate (G), forms a rectify-
ing junction with the channel or a metal oxide semiconductor (MOS) structure. A 
simplified structure of a metal–semiconductor n-type FET is depicted in Figure 1.9 
[5]. FET devices ideally do not draw current through the gate terminal, unlike the 
BJTs, which conversely require a significant base current, thus simplifying the bias-
ing arrangement. FET devices exhibit a negative temperature coefficient, resulting 
FET
MOSFET
GaAs MOSFET
Si MOSFET
NMOS,  PMOS
CMOS
HMOS
DMOS,  DIMOS
VMOS
SOS, SOI
MESFET
Heterostructure  MESFET
InP  MESFET
GaAs  MESFET
Si MESFET
Single  gate
Dual  gate
Interdigital structure
JFET
Si JFET
GaAs JFET
Diused
Grown
Hetrojunction
Single channel
V-groove
Multi channel
Power devices
BJT
HBT
FIGURE 1.7  Family tree for power devices.
E
r-type silicon
r-type silicon
p-type silicon
B
C
(a)
r-type InGaAs
N-type InF
p-type InGaAs
r-type InGaAs
r-type InGaAs
Semi-insulating InP substrate
B
C
Emitter
Base
Collector
Sub-collector
(b)
Emitter cap
FIGURE 1.8  Typical layer structure of (a) silicon BJT and (b) InP/InGaAs HBT transistor.

10
Linear and Switch-Mode RF Power Amplifiers
in a decreasing drain current as the temperature increases. This prevents thermal 
runaway and allows multiple FETs to be connected in parallel without ballasting, a 
useful property if a corporate or combined device concept has to be adopted for high-
power amplifier design.
RF MOSFET power transistors and their major applications and frequency of 
operation are given in Table 1.7.
1.5.2.1  MOSFETs
MOSFETs are widely used in RF power amplifier applications, and their param-
eters are identified by manufacturers at different static and dynamic conditions. 
Therefore, each MOSFET device has been manufactured with different char-
acteristics. The designer selects the appropriate device for the specific circuit 
under consideration. One of the standard ways commonly used by designers for 
selection of right MOSFET device is called figure of merit (FOM) [1]. There are 
different types of FOMs that are used. FOM in its simplest form compares the 
TABLE 1.7
RF Power Transistors and Their Applications and Frequency of Operations
RF Transistor
Drain BV [V]
Frequency [GHz]
Major Applications
RF power FET
65
0.001–0.4
VHF power amplifier
GaAs MesFET
16–22, 60
1–30
Radar, satellite, defense
SiC MesFET
100
0.5–2.3
Base station
GaN MesFET
160
1–30
Replacement for GaAs
Si LDMOS (FET)
65
0.5–2
Base station
Si VDMOS (FET)
65–1200
0.001–0.5
High power amplifiers, FM broadcasting, 
and magnetic resonance imaging
BV, breakdown voltage; RF, radio frequency; HF, high frequency; LDMOS, laterally diffused MOSFET; 
MESFET, metal-semiconductor field-effect transistor; VHF, very high frequency.
Gate
Semi-insulating substrate
n-channel
Drain
Source
n+
n+
Depletion
region
FIGURE 1.9  Simplified structure of FET.
www.ebook3000.com

11
Radio Frequency Amplifier Basics
gate charge, Qg, against RdsON. The multiplication of gate charge and drain to 
source on resistance relates to a certain device technology as it can be related to 
the required Qg and RdsON to achieve the right scale for MOSFET. The challenge 
is the relation between Qg and RdsON because MOSFET has inherent trade-offs 
between ON resistance and gate charge i.e., the lower the 12 dsON, the higher 
the gate charge will be. In device design, this is trade-off between conduction 
loss versus switching loss. The new generation MOSFETs are manufactured to 
have an improved FOM [2,6–8]. The comparison of FOM on MOSFETs manufac-
tured with different processes can be illustrated on planar MOSFET structure and 
trench MOSFET structure. MOSFET with trench structure has seven times better 
FOM versus planar structure as shown in Figure 1.10.
Two variations of the trench power MOSFET are shown Figure 1.11. The trench 
technology has the advantage of higher cell density but is more difficult to manufac-
ture than the planar device.
Source
Drain
Gate oxide
Polysilicon
gate 
Source
metalization 
p+ Body
region
n+
n+
p
p
Channels
p+
Drift region
n– Epi layer
n+ Substrate
Drain
metalization 
Channel
Gate
oxide
Source
Oxide
Source
Gate
Drain
n– Epi layer
n+ Substrate
Higher density cell
FIGURE 1.10  FOM comparison of planar and trench MOSFET structures.
Channel
Gate 
oxide
Source
Oxide
Source
Gate
Drain
n– Epi layer
n+ Substrate
Source
Source
Gate
Drain
Electron ﬂow
(a)
(b)
FIGURE 1.11  Trench MOSFET. (a) Current crowding in V-Groove trench MOSFET and 
(b) truncated V-Groove.

12
Linear and Switch-Mode RF Power Amplifiers
1.6  PASSIVE DEVICES
Passive components used in the design of amplifiers are inductors, capacitors, and 
resistors. Their size, ratings, and packages vary depending on the operational param-
eters of the amplifier. Most of the time, capacitors and resistors need to be purchased 
as off-the-shelf part, whereas inductors can be designed by the amplifier designer.
1.6.1  Inductor
Inductors can be implemented as discrete component or distributed element depend-
ing on the frequency of application. If a current flows through a wire wound, a 
flux is produced through each turn as a result of magnetic flux density as shown in 
Figure 1.12. The relation between the flux density and flux through each turn can be 
represented as
	
∫
Ψ =
⋅
B ds.	
(1.4)
If there are N turns, then we define the flux linkage as
	
∫
λ =
Ψ =
⋅
N
N
B ds.	
(1.5)
Inductance is defined as the ratio of flux linkage to current flowing through the 
windings as defined by
	
= λ =
Ψ
L
I
N
I
.	
(1.6)
The inductance defined by Equation 1.6 is also known as self-inductance of the core 
that is formed by the windings. The core can be an air core or a magnetic core.
Inductors can be formed as air-core inductors or magnetic-core inductors 
depending on the application. When air-core inductors are formed through wind-
ings and operated at high frequency (HF), the inductor presents high-frequency 
+
Ι
Ι
–
FIGURE 1.12  Flux through each turn.
www.ebook3000.com

13
Radio Frequency Amplifier Basics
characteristics. This includes winding resistance and distributed capacitance effects 
between each turn as shown in Figure 1.13.
The high-frequency model of the inductor can be illustrated with its equivalent 
circuit, as shown in Figure 1.14.
As a result, the inductor will act as an inductor up to a certain frequency and 
then gets into resonance and exhibits capacitive effects after resonance frequency. It 
can be shown that the series equivalent circuit for the high-frequency circuit can be 
obtained, such as the one shown in Figure 1.15 [9].
where
	
=
+
Z
R
jX ,
s
s
	
(1.7)
where
	
(
)
(
)
=
−ω
+ ω
R
R
LC
RC
1
s
2
s
2
s
2 	
(1.8)
and
	
(
)
(
)
(
)
=
ω
−
−ω
−ω
+ ω
X
L
R C
L C
LC
RC
1
.
s
2
s
3
2
s
2
s
2
s
2
	
(1.9)
The resonance frequency is found when 
=
X
0
s
 as
	
=
π
−
f
L
R C
L C
1
2
.
r
2
s
2
s
	
(1.10)
FIGURE 1.13  High-frequency effects of RF inductor.
L
R
Cs
FIGURE 1.14  High-frequency model of RF air-core inductor.
Rs
Ls
FIGURE 1.15  Equivalent series circuit.

14
Linear and Switch-Mode RF Power Amplifiers
The quality factor is obtained from
	
=
Q
X
R
|
|.
s
s
	
(1.11)
Cs in Figure 1.14 is the capacitance including the effects of distributed capacitance 
of the inductor and is given as
	
=
πε
C
daN
l
2
.
s
0
2
W
	
(1.12)
1.6.1.1  Air-Core Inductor Design
In practice, inductors can be implemented as air-core or toroidal inductors using 
magnetic cores as illustrated in Figure 1.16.
For an air-core solenoidal inductor given in Figure 1.16, the inductance can be 
calculated using the relation:
	
=
+
µ
L
d N
d
l
18
40   [ H].
2
2
	
(1.13)
In this equation, L is given as inductance in [μH], d is the coil inner diameter in 
inches [in.], l is the coil length in inches [in.], and N is the number of turns of the coil. 
The formula given in Equation 1.13 can be extended to include the spacing between 
each turn of the air coil inductor. Then, Equation 1.13 can be modified as
	
(
)
(
)
=
+
+
−
µ
L
d N
d
Na
N
s
18
40
1
  [ H].
2
2
	
(1.14)
In Equation 1.14, a represents the wire diameter in inches, and s represents the spac-
ing in inches between each turn.
1.6.1.2  Magnetic-Core Inductor Design
In several RF applications, it may be required to have larger inductance values in 
space-restricted areas. One solution to increase the inductance value for an air-core 
(a)
(b) 
l
l > 0.4d
d
OD
Ht
ID
FIGURE 1.16  (a) Air-core inductor and (b) toroidal inductor.
www.ebook3000.com

15
Radio Frequency Amplifier Basics
inductor is to increase the number of turns. However, this increases the size of the 
air-core inductor. This challenge can be overcome by using magnetic cores. Another 
advantage of using toroidal cores is also keeping the flux within the core as shown 
in Figure 1.17. This provides self-shielding. In air-core inductor design, air is used 
as a nonmagnetic material to wind the wire around it. When air is replaced with a 
magnetic material such as toroidal core, the inductance of the formed inductor can 
be calculated using
	
=
π
µ
L
N
A
l
4
  [nH].
i
2
Tc
e
	
(1.15)
In Equation 1.15, L is the inductance in nanohenries [nH], N is the number of turns, 
μi is the initial permeability, ATc is the total cross-sectional area of the core in cm2, 
and le is the effective length of the core in cm. The effective length of the core, le, is 
defined as
	
= π
−
l
(od
id)
ln(od/id)   [cm],
e
	
(1.16)
where od is the outside and id is the inside diameters of the core in cm. The total 
cross-sectional area of the core, ATc, is defined as
	
[
]
=
−
×
×
A
h
n
1
2 (od
id)
   cm
,
Tc
2
	
(1.17)
where h refers to the thickness of the core in cm, and n is used to define the number 
of stacked cores.
It is not uncommon to have the information about the inductance index of the 
core on its data sheet. If the inductance index is given, then Equation 1.15 can be 
modified as
	
=
L
N A   [nH],
2
L
	
(1.18)
D
d
Ae
ℓe
h
(b)
I
Flux
(a)
FIGURE 1.17  (a) Magnetic flux in toroidal magnetic core and (b) geometry of toroid.

16
Linear and Switch-Mode RF Power Amplifiers
where AL is the inductance index in nanohenries/turn2. The maximum operational 
flux density for toroidal core is calculated from
	
=
×
B
V
fNA
10
4.44
   [Gauss].
op
rms
8
Tc
	
(1.19)
In Equation 1.19, Bop is the magnetic-flux density in Gauss, Vrms is the maximum rms 
voltage across the inductor in volts, f is the frequency in Hertz, N is the number of 
turns, and ATc is the total cross-sectional area of the core in cm2. The proper design 
of toroidal core inductor requires operational voltage of the inductor and the required 
inductance value. This helps to identify the right material for the inductor design to 
prevent saturation.
1.6.1.3  Planar Inductor Design
In high-frequency applications, planar-type inductors such as spiral inductors can be 
a good choice to reduce the impact of parasitic effect. Spiral-type planar inductors 
are widely used in the design of power amplifiers, oscillators, microwave switches, 
combiners, splitters, etc.
The inductance value of the spiral inductors at the HF range can be determined 
using the quasi-static method proposed by Greenhouse with a good level of accuracy.
The method proposed by Greenhouse takes into account self-coupling and mutual 
coupling between each trace. The layout of the two conductors that is used in the 
inductance calculation is illustrated in Figure 1.18a. GMD is the geometric mean 
distance between two conductors, and AMD represents the arithmetic mean dis-
tance between two conductors. The total inductance of the configuration of the spiral 
inductor is
	
=
+ Σ
L
L
M,
T
0
	
(1.20)
where LT is the total inductance, L0 is the sum of the self-inductances, and ΣM is 
the sum of the total mutual inductances. The application of the formulation given by 
Equation 1.20 can be demonstrated for the spiral inductor illustrated in Figure 1.18b 
and c as
	
(
)
=
+
+
+
+
−
+
+
+
L
L
L
L
L
L
M
M
M
M
2
2
.
T
1
2
3
4
5
13
24
35
15 	
(1.21)
The general relations that can be used in the algorithm for the spiral inductance 
calculation then become
	
=



−
+
+ µ




L
l
l
l
T
0.0002
ln 2 GMD
1.25
AMD
4
i
i
i
i
 	
 (1.22)
	
=
M
l Q
0.0002
.
ij
i
i 	
(1.23)
www.ebook3000.com

17
Radio Frequency Amplifier Basics
	

d
d
w
d
w
d
w
d
w
ln GMD
ln( )
1
12
1
60
1
168
1
360
i
2
4
6
8
(
) =
−




−




−




−




−
	
(1.24)
	
=
+
+ 
















−
+ 









+
Q
l
l
l
l
ln GMD
1
GMD
1
GMD
GMD
i
i
i
i
i
i
i
i
i
2
0.5
2
0.5
	
(1.25)
	
=
+
w
t
AMD
,	
 (1.26)
where Li is the self-inductance of the segment i, Mij is the mutual inductance between 
segments i and j, li is the length of segment li, μ is the permeability of the conductor, 
T is the frequency correction factor, d is the distance between conductor filaments, 
w is the width of the conductor, t is the thickness of the conductor, Qi is the mutual 
inductance parameter of segment i, GMDi is the geometric distance of segment i, and 
AMD is the arithmetic mean distance.
(a)
(b)
d
l
p
m
q
j
GMD
(c)
3
4
5
1
2
FIGURE 1.18  (a) Rectangular spiral inductor, (b) layout of current filaments, and (c) two-
parallel filament geometry.

18
Linear and Switch-Mode RF Power Amplifiers
1.6.2  Capacitor
The high-frequency mode of the capacitor is given in Figure 1.19.
From Figure 1.19, it is also clear that nonideal capacitor has resonances due to 
its high-frequency characteristics. The high-frequency model of the capacitor has 
parasitic components such as lead inductance, L; conductor loss, Rs; and dielectric 
loss, Rd, which only become relevant at high frequencies. The characteristics of the 
capacitor can be obtained by finding the equivalent impedance as
	
(
)
(
)
(
)
(
)
(
)
=
ω
+
+
+ ω



=
+ ω
+
+ ω
+
ω
+
ω ω
−ω
+ ω
Z
j L
R
G
j C
R G
C
G
G
C
j
LG
L
C
C
G
C
1
.
s
s
d
s
d
2
2
d
d
2
2
d
2
2
d
2
2
	
(1.27)
The Equation 1.27 can be expressed as
	
=
+
Z
R
jX ,
s
s 	
(1.28)
where
	
R
R G
C
G
G
C
X
LG
L
C
C
G
C
and
.
s
s
d
2
2
d
d
2
2
s
d
2
2
d
2
2
(
)
(
)
(
)
(
)
=
+ ω
+
+ ω
= ω
+ ω ω
−ω
+ ω
	
(1.29)
Impedance given in Equation 1.28 can be converted to admittance as
	
=
=
+
+
−
+
=
+
−
Y
Z
R
R
X
j
X
R
X
G
jB
1
s
s
2
s
2
s
s
2
s
2
	
(1.30)
or
	
(
)(
)
(
)
(
)
(
)(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
+ ω
+
+ ω
+ ω
+
+ ω
+ ω ω
−ω
+
ω
−ω
−ω ω
+ ω
+ ω
+
+ ω
+ ω ω
−ω
Y
R G
C
G
G
C
R G
C
G
LG
L
C
C
j
C
LG
L
C
G
C
R G
C
G
LG
L
C
C
.
s
d
2
2
d
d
2
2
s
d
2
2
d
2
d
2
2
2
d
2
2
d
2
2
s
d
2
2
d
2
d
2
2
2 	
(1.31)
L
Rd
C
Rs
FIGURE 1.19  High-frequency model of capacitor.
www.ebook3000.com

19
Radio Frequency Amplifier Basics
Then, the capacitor can be represented by a parallel equivalent circuit as shown in 
Figure 1.20 where
	
(
)(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
+ ω
+
+ ω
+ ω
+
+ ω
+
ω ω
−ω
G
R G
C
G
G
C
R G
C
G
LG
L
C
C
s
d
2
2
d
d
2
2
s
d
2
2
d
2
d
2
2
2 	
(1.32)
	
(
)(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
ω
−ω
−
ω ω
+ ω
+ ω
+
+ ω
+
ω ω
−ω
B
C
LG
L
C
G
C
R G
C
G
LG
L
C
C
.
d
2
2
d
2
2
s
d
2
2
d
2
d
2
2
2 	
(1.33)
The resonance frequency for the circuit shown in Figure 1.14 is found when B = 0 as
	
=
π
−
f
R C
L
R C L
1
2
.
r
2
2
2
	
(1.34)
The quality factor for the parallel network is then obtained from
	
=
=
Q
B
G
R
X
|
|
|
|.
p
p
	
(1.35)
1.6.3  Resistor
Resistor parasitic inductance is significant for the high-frequency applications. With 
the increase in the system frequency, the voltage drop across the resistor increases 
due to the increase in impedance. The type of the resistor whose behavior is fre-
quency dependent is called nonideal resistor. Figure 1.21 is the representation of the 
impedance model of a resistor. The equivalent circuit of the resistor includes parasitic 
G
Cp
FIGURE 1.20  Equivalent parallel circuit.

20
Linear and Switch-Mode RF Power Amplifiers
capacitance, lead inductance, and the resistor value. There are several ways of resis-
tor construction. The most common types of resistors are composed of carbon and 
thin film. Figure 1.22 [10] represents the impedance behavior of the nonideal resistor 
versus frequency. The breakpoint of the frequency where the resistor acts as a para-
sitic capacitance and lead inductance can be expressed by Equations 1.36 and 1.37.
When a nonideal resistor acts as a capacitor,
	
=
π
f
RC
1
2
.
parasitic
	
(1.36)
When a nonideal resistor acts as an inductor,
	
=
π
f
L
C
1
2
.
lead
parasitic
	
(1.37)
R
R
f
f
–20 dB/decade
Capacitive
Inductive
Resistive
+20 dB/decade
Z
Z
FIGURE 1.22  Characteristics of the resistor with frequency. (a) Impedance of the ideal 
resistor and (b) nonideal behavior of resistor.
(a)
R
(b)
L
C
R
FIGURE 1.21  Representation of the resistor equivalent model. (a) Ideal resistor and 
(b) equivalent nonideal resistor.
www.ebook3000.com

21
Radio Frequency Amplifier Basics
REFERENCES
	
1.	 S. Cripps, RF Power Amplifiers for Wireless Communication, 2nd ed., Artech House, 
Norwood, MA, 2006.
	
2.	 A. Eroglu, Introduction to RF Power Amplifier Design and Simulation, 1st ed., CRC 
Press, Boca Raton, FL, 2015.
	
3.	 U. K. Mishra, Fellow IEEE, L. Shen, T. E. Kazior, and Y.-F. Wu, GaN-based RF power 
devices and amplifiers, Proceedings of the IEEE, Vol. 96, No. 2, pp. 287–305, 2008.
	
4.	 M. Golio, RF and Microwave Semiconductor Device Handbook, CRC Press, Boca 
Raton, FL, 2003.
	
5.	 S. M. Sze, Semiconductor Devices Physics and Technology, John Wiley & Sons, Ltd, 
New York, 2001.
	
6.	 G. Deboy, M. Marz, J.-P. Stengl, H. Strack, J. Tihanyi, and H. Weber, A new generation 
of high voltage MOSFETs breaks the limit line of silicon, IEDM’98 Electron Devices 
Meeting, IEDM’98, Technical Digest, pp. 683–685, 1998.
	
7.	 G. Sabui and Z. J. Shen, On the feasibility of further improving Figure of Merits (FOM) 
of low voltage power MOSFETs, in Proceedings of the 26th International Symposium 
on Power Semiconductor Devices and IC’s, Waikoloa, HI, June 15–19, 2014.
	
8.	 S. Xu et al., NexFET: A new power device, in Proceedings of International Electron 
Devices Meeting, pp. 1–4, 2009.
	
9.	 A. Eroglu, RF Circuit Design Techniques for MF-UHF Applications, 1st ed., CRC 
Press, Boca Raton, FL, 2013.
	 10.	 C. R. Paul, Introduction to Electromagnetic Compatibility, 2nd ed., Wiley-Interscience, 
Hoboken, NJ, 2006.

www.ebook3000.com

23
2 Two-Port Parameters
2.1  INTRODUCTION
Network parameters allow engineers to determine overall circuit performance with-
out knowing the internal structure. They carry great importance in analysis and 
design of devices and components. Network parameters provide mathematical tools 
for designers to model and characterize devices by establishing relationships between 
voltages and currents. It is possible to theoretically calculate loss, power delivered, 
reflection coefficient, voltage and current gains, and several other critical parameters 
with the use of network analysis. Hence, it is necessary to understand and utilize net-
work parameters in radio frequency (RF)/microwave device and component design 
to have a better performance.
2.2  NETWORK PARAMETERS
The analysis of network parameters can be explained using two-port networks. The 
two-port network shown in Figure 2.1 is described by a set of four independent 
parameters, which can be related to voltage and current at any ports of the network. 
As a result, two-port networks can be treated as a black box modeled by the rela-
tionships between the four variables. There exist six different ways to describe the 
relationships between these variables depending on which two of the four variables 
are given, whereas the other two can always be derived. All voltages and currents 
are complex variables and represented by phasors containing both magnitude and 
phase. Two-port networks are characterized using two-port network parameters such 
as Z-impedance, Y-admittance, h-hybrid, and ABCD. They are usually expressed in 
matrix notation, and they establish relationships between the following parameters: 
input voltage V1, output voltage V2, input current I1, and output current I2. High-
frequency networks are characterized by S-parameters.
2.2.1  Z-Impedance Parameters
The voltages are represented in terms of currents through Z-parameters as follows:
	
=
+
V
Z I
Z I
1
11 1
12 2 	
(2.1)
	
=
+
V
Z I
Z I
2
21 1
22 2 	
(2.2)
In matrix form, Equations 2.1 and 2.2 can be combined and written as
	








=
















V
V
Z
Z
Z
Z
I
I
1
2
11
12
21
22
1
2
	
(2.3)

24
Linear and Switch-Mode RF Power Amplifiers
The Z-parameters for a two-port network are defined as
	
=
=
=
=
=
=
=
=
Z
V
I
Z
V
I
Z
V
I
Z
V
I
I
I
I
I
11
1
1
0
12
1
2
0
21
2
1
0
22
2
2
0
2
1
2
1
	
(2.4)
The formulation in Equation 2.4 can be generalized for N-port network as
	
=
=
≠
Z
V
I
nm
n
m I
k m
0(
)
k
	
(2.5)
Znm is the input impedance seen looking into port n, when all other ports are open 
circuited. In other words, Znm is the transfer impedance between ports n and m when 
all other ports are open. It can be shown that for reciprocal networks
	
=
Z
Z
nm
mn 	
(2.6)
2.2.2  Y-Admittance Parameters
The currents are related to voltages through Y-parameters as follows:
	
=
+
I
Y V
Y V
1
11 1
12
2 	
(2.7)
	
=
+
I
Y V
Y V
2
21 1
22
2 	
(2.8)
In matrix form, Equations 2.7 and 2.8 can be written as
	
I
I
Y
Y
Y
Y
V
V
1
2
11
12
21
22
1
2








=
















	
 (2.9)
Two port network
I1
+
−
V1
I1
I1
+
−
V1
I1
FIGURE 2.1  Two-port network representation.
www.ebook3000.com

25
Two-Port Parameters
The Y-parameters in Equation 2.9 can be defined as
	
=
=
=
=
=
=
=
=
Y
I
V
Y
I
V
Y
I
V
Y
I
V
V
V
V
V
11
1
1
0
12
1
2
0
21
2
1
0
22
2
2
0
2
1
2
1
	
(2.10)
The formulation in Equation 2.10 can be generalized for N-port network as
	
=
=
≠
Y
I
V
nm
n
m V
k m
0(
)
k
	
(2.11)
Ynm is the input admittance seen looking into port n when all other ports are short-
circuited. In other words, Ynm is the transfer admittance between ports n and m when 
all other ports are short. It can be shown that
	
=
Y
Y
nm
mn 	
(2.12)
In addition, it can be further proven that the impedance and admittance matrices are 
related through
	
[ ]
[ ]
=
−
Z
Y
1 	
(2.13)
or
	
[ ]
[ ]
=
−
Y
Z
1 	
(2.14)
2.2.3  ABCD Parameters
ABCD parameters relate voltages to currents in the following form for two-port 
networks.
	
=
−
V
AV
BI
1
1
2 	
(2.15)
	
=
−
I
CV
DI
1
1
2 	
(2.16)
which can be put in matrix form as
	
V
I
A
B
C
D
V
I
1
1
1
2








= 





−








	
(2.17)
ABCD parameters in Equation 2.17 are defined as
	
=
= −
=
= −
=
=
=
=
A
V
V
B
V
I
C
I
V
D
I
I
I
V
I
V
1
2
0
1
2
0
1
2
0
1
2
0
2
2
2
2
	
(2.18)

26
Linear and Switch-Mode RF Power Amplifiers
When network is reciprocal, it can be shown that
	
−
=
AD
BC
1	
(2.19)
A = D for symmetrical network. ABCD parameters are useful in finding voltage or 
current gain of component or overall gain of a network. One of the great advantages 
of ABCD parameters is their use when networks or components are cascaded. When 
this condition exists, overall ABCD parameter of the network simply becomes the 
matrix product of individual network or components as given by Equation 2.20. This 
can be generalized for N-port network shown in Figure 2.2 as
	







=





















−






v
i
A
B
C
D
A
B
C
D
v
i
n
n
n
n
1
1
1
1
1
1
2
2
	
(2.20)
2.2.4  h-Hybrid Parameters
Hybrid parameters relate voltages and currents in a two-port network as
	
=
+
V
h I
h V
1
11 1
12
2 	
(2.21)
	
=
+
I
h I
h V
2
21 1
22
2 	
(2.22)
Equations 2.21 and 2.22 can be put in a matrix form as
	
V
I
h
h
h
h
I
V
1
2
11
12
21
22
1
2








=
















	
(2.23)
The hybrid parameters in Equation 2.23 can be found from
	
=
=
=
=
=
=
=
=
h
V
I
h
V
V
h
I
I
h
I
V
,
V
I
V
I
11
1
1
0
12
1
2
0
21
2
1
0
22
2
2
0
2
1
2
1
	
(2.24)
Hybrid parameters are preferred for components such as transistors and transformers 
since they can be measured with ease in practice.
I2
V2
An
Cn
Bn
Dn
A1
C1
B1
D1
I1
V1
FIGURE 2.2  ABCD parameter of cascaded networks.
www.ebook3000.com

27
Two-Port Parameters
Example 2.1
Find (a) impedance, (b) admittance, (c) ABCD, and (d) hybrid parameters of the 
T-network given in Figure 2.3.
Solution:
	
a.	Z-parameters are found with application of Equation 2.4 by opening all 
the other ports except the measurement port. This leads to
(
)
=
=
+
=
=
=
=
+
=
+
+
=
=
=
+
=
=
=
=
Z
V
I
Z
Z
Z
V
I
Z
Z
V
I
V
I
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
V
I
Z
Z
,
I
A
C
I
C
I
C
B
C
B
C
C
B
C
C
I
B
C
11
1
1
0
21
2
1
0
12
1
2
0
2
2
22
2
2
0
2
2
1
1
	
	 The Z-matrix is then constructed as
	
(
)
(
)
=
+
+
+
=
+
+
=
+














Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
A
C
B
C
C
B
C
C
B
C
C
B
C
C
B
C
	
b.	Y-parameters are found from Equation 2.10 by shorting all the other ports 
except the measurement port. Y11 and Y21  are found when port 2 is 
shorted as
	
(
)
=
→
=
+
=
+
+
+




→
=
+
+
+




=
Y
I
V
I
V
Z
Z
Z
V
Z
Z
Z Z
Z Z
Z Z
Y
Z
Z
Z Z
Z Z
Z Z
/ /
V
A
B
C
B
C
A
B
A
C
B
C
B
C
A
B
A
C
B
C
11
1
1
0
1
1
1
11
2
	
(
)
(
) (
)
=
→
=
−
+
+
→
=
−
+
+




=
Y
I
V
I
V
Z
Z
Z
Z
Z
Z
Y
Z
Z Z
Z Z
Z Z
/ /
V
A
B
C
C
C
B
C
A
B
A
C
B
C
21
2
1
0
2
1
21
2
ZB
ZC
ZA
I1
V1
+
+
V2
I2
FIGURE 2.3  T-network configuration.

28
Linear and Switch-Mode RF Power Amplifiers
	
Similarly, Y12  and Y22  are found when port 1 is shorted as
(
)
(
) (
)
=
→
=
−
+
+
→
=
−
+
+




=
Y
I
V
I
V
Z
Z
Z
Z
Z
Z
Y
Z
Z Z
Z Z
Z Z
/ /
V
B
A
C
C
A
C
C
A
B
A
C
B
C
12
1
2
0
1
2
12
1
	
(
)
=
→
=
+
=
+
+
+




→
=
+
+
+




=
Y
I
V
I
V
Z
Z
Z
V
Z
Z
Z Z
Z Z
Z Z
Y
Z
Z
Z Z
Z Z
Z Z
/ /
V
B
A
C
A
C
A
B
A
C
B
C
A
C
A
B
A
C
B
C
22
2
2
0
2
2
1
22
1
	
Y-parameters can also be found by just inverting the Z-matrix given by 
Equation 2.14 as
	
(
)
[ ]
[ ]
=
=
+
+
+
−
−
+








−
Y
Z
Z Z
Z Z
Z Z
Z
Z
Z
Z
Z
Z
1
A
B
A
C
B
C
B
C
C
C
A
C
1
	
So, the Y-matrix for T-network is then
	
=
+
+
+




−
+
+




−
+
+




+
+
+


















Y
Z
Z
Z Z
Z Z
Z Z
Z
Z Z
Z Z
Z Z
Z
Z Z
Z Z
Z Z
Z
Z
Z Z
Z Z
Z Z
B
C
A
B
A
C
B
C
C
A
B
A
C
B
C
C
A
B
A
C
B
C
A
C
A
B
A
C
B
C
	
As seen from the results of part (a) and (b), the network is reciprocal 
because
	
=
=
Z
Z
Y
Y
and
12
21
12
21
	
c.	Hybrid parameters are found using Equation 2.24. Parameters h11 and 
h21  are obtained when port 2 is shorted as
	
(
)
(
)
=
→
=
+
=
+
+
+




→
=
+
+
+




=
h
V
I
V
I
Z
Z
Z
I
Z Z
Z Z
Z Z
Z
Z
h
Z Z
Z Z
Z Z
Z
Z
/ /
V
A
B
C
A
B
A
C
B
C
B
C
A
B
A
C
B
C
B
C
11
1
1
0
1
1
1
11
2
	
and
	
=
→
= −
+



→
= −
+




=
h
I
I
I
I
Z
Z
Z
h
Z
Z
Z
V
C
B
C
C
B
C
21
2
1
0
2
1
21
2
	
Parameters h12 and h22 are obtained when port 1 is open-circuited as
www.ebook3000.com

29
Two-Port Parameters
	
=
→
=
+



→
=
+




=
h
V
V
V
V
Z
Z
Z
h
Z
Z
Z
I
C
B
C
C
B
C
12
1
1
0
1
2
12
1
	
and
	
=
→
=
+



→
=
+




=
h
I
V
I
V
Z
Z
h
Z
Z
1
1
I
B
C
B
C
22
2
2
0
2
2
22
1
	
The hybrid matrix for T-network now can be constructed as
	
=
+
+
+




+




−
+




+


















h
Z Z
Z Z
Z Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
1
A
B
A
C
B
C
B
C
C
B
C
C
B
C
B
C
	
d.	ABCD parameters are found using Equations 2.1 through 2.18. Parameters 
A and C are determined when port 2 is open-circuited as
	
=
→
=
+
→
=
+




=
A
V
V
V
Z
Z
Z V
A
Z
Z
Z
I
C
C
A
C
A
C
1
2
0
2
1
2
	
and
	
=
→
=



→
= 



=
C
I
V
I
V
Z
C
Z
1
1
I
C
C
1
2
0
1
2
2
	
Parameters B and D are determined when port 2 is short-circuited as
	
(
) (
)
= −
→
=
−
+
+
→
=
+
+




=
B
V
I
I
V
Z
Z
Z
Z
Z
Z
B
Z Z
Z Z
Z Z
Z
/ /
V
A
B
C
C
B
C
A
B
A
C
B
C
C
1
2
0
2
1
2
	
and
	
= −
→
= −
+



→
=
+




=
D
I
I
I
I
Z
Z
Z
D
Z
Z
Z
V
C
B
C
B
C
C
1
2
0
2
1
2
	
So, the ABCD matrix is found as
	
=
+




+
+








+


















ABCD
Z
Z
Z
Z Z
Z Z
Z Z
Z
Z
Z
Z
Z
1
C
A
C
A
B
A
C
B
C
C
C
B
C
C
	
It can proved from the results obtained that Z, Y, h, and ABCD param-
eters are related using the relations given in Table 2.1.

30
Linear and Switch-Mode RF Power Amplifiers
2.3  NETWORK CONNECTIONS
Networks and components in engineering applications can be connected in differ-
ent ways to perform certain tasks. Commonly used network connection methods 
are series, parallel, and cascade connections. Series connection of two networks is 
shown in Figure 2.4a. Because the networks are connected in series, currents are 
same and voltages are added across ports of the network to find the overall volt-
age at the ports of the combined network. This can be represented by impedance 
matrices as
	
=
+
=







+







=
+
+
+
+








Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
[ ]
[
] [
]
x
y
x
x
x
x
y
y
y
y
x
y
x
y
x
y
x
y
11
12
21
22
11
12
21
22
11
11
12
12
21
21
22
22
	
	
(2.25)
So,
	








=
+
+
+
+
















V
V
Z
Z
Z
Z
Z
Z
Z
Z
I
I
x
y
x
y
x
y
x
y
1
2
11
11
12
12
21
21
22
22
1
2
	
(2.26)
TABLE 2.1
Network Parameter Conversion Table
[Z]
[Y]
[ABCD]
[h]
[Z]








z
z
z
z
11
12
21
22
∆
−
∆
−
∆
∆














y
y
y
y
Y
Y
Y
Y
22
12
21
11
∆












A
C
C
C
D
C
1
T
∆
−














h
h
h
h
h
h
1
H
22
12
22
21
22
22
[Y]
∆
−
∆
−
∆
∆














z
z
z
z
Z
Z
Z
Z
22
12
21
11








y
y
y
y
11
12
21
22
−∆












D
B
B
B
A
B
1
T
−
∆














h
h
h
h
h
h
1
H
11
12
11
21
11
11
[ABCD]
∆














z
z
z
z
z
z
1
Z
11
21
21
21
22
21
−
−
−∆
−














y
y
y
y
y
y
1
y
22
21
21
21
11
21






A
B
C
D
−∆
−
−
−














h
h
h
h
h
h
1
H
21
11
21
22
21
21
[h]
∆
−














z
z
z
z
z
z
1
Z
22
12
22
21
22
22
−
∆














y
y
y
y
y
y
1
Y
11
12
11
21
11
11
∆
−
−












1
T
B
D
D
D
C
D








h
h
h
h
11
12
21
22
www.ebook3000.com

31
Two-Port Parameters
Parallel connection of two-port networks is illustrated in Figure 2.4b. In parallel-
connected networks, voltages are same across ports, and currents are added to find 
the overall current flowing at the ports of the combined network. This can be repre-
sented by Y matrices as
	
=
+
=







+







=
+
+
+
+








Y
Y
Y
Y
Y
Y
Y
Y
Y
Z
Y
Y
Y
Y
Y
Y
Y
Y
Y
[ ]
[
] [
]
x
y
x
x
x
x
y
y
y
y
x
y
x
y
x
y
x
y
11
12
21
22
11
12
21
22
11
11
12
12
21
21
22
22
	 	
(2.27)
As a result,
	
I
I
Y
Y
Y
Y
Y
Y
Y
Y
V
V
x
y
x
y
x
y
x
y
1
2
11
11
12
12
21
21
22
22
1
2








=
+
+
+
+
















	
(2.28)
The cascade connection of two-port networks is shown in Figure 2.5. In cascade 
connection, the magnitude of the current flowing at the output of the first network is 
1
2
Z y
V1
I1
V2
I2
1
2
Z x
+
(a)
+
1
2
Y y
V1
I1
V2
I2
1
2
Y x
+
+
(b)
FIGURE 2.4  (a) Series connection of two-port networks and (b) parallel connection of two-
port networks.

32
Linear and Switch-Mode RF Power Amplifiers
equal to current at the input port of the second network. The voltages at the output of 
the first network is also equal to the voltage across the input of the second network. 
This can be represented by using ABCD matrices as
	
=
=
















=
+
+
+
+








ABCD
ABCD
ABCD
A
B
C
D
A
B
C
D
A A
B C
A B
B D
C A
D C
C B
D D
[
]
[
][
]
x
y
x
x
x
x
y
y
y
y
x
y
x
y
x
y
x
y
x
y
x
y
x
y
x
y
	
(2.29)
Example 2.2
Consider RF amplifier given in Figure 2.6. It has feedback network for stability, 
input, and output matching networks. The transistor used is NPN BJT and its 
characteristic parameters are given by rBE = 400 Ω, rCE = 70 kΩ, CBE = 15 pF, and 
CBC = 2 pF, and gm = 0.2 S. Find the voltage and current gain of this amplifier when 
L = 2 nH, C = 12 pF, l = 5 cm, and vp = 0.65 c.
Solution: The high-frequency characteristics of the transistor is modeled using the 
hybrid parameters given by
	
(
)
=
=
+ ω
+
h
h
r
j
C
C
r
1
ie
11
BE
BE
BC
BE
	
(2.30)
	
(
)
=
=
ω
+ ω
+
h
h
j C
r
j
C
C
r
1
re
12
BC BE
BE
BC
BE
	
(2.31)
	
(
)
(
)
=
=
−ω
+ ω
+
h
h
r
g
j C
j
C
C
r
1
fe
m
21
BE
BC
BE
BC
BE
	
(2.32)
ABCD x
1
2
ABCD y
I2
V2
I1
V1
+
+
1
2
FIGURE 2.5  Cascade connection of two-port networks.
R
Q
L
L
C
V2
V1
Z0, β
I1
l
I2
+
+
FIGURE 2.6  RF amplifier analysis by network parameters.
www.ebook3000.com

33
Two-Port Parameters
	
(
)
(
)
(
)
=
=
+ ω
+

+
+
+ ω


+ ω
+
h
h
j
C
C
r
r g
j C r
r
j
C
C
r
1
1
1
oe
m
22
BE
BC
BE
BE
BE BE
CE
BE
BC
BE
	
(2.33)
The amplifier network shown in Figure 2.6 is a combination of four networks that 
are connected in parallel and cascade. Overall network has to be first partitioned 
for analysis. This can be demonstrated as shown in Figure 2.7.
In the partitioned amplifier circuit, networks N2 and N3 are connected in paral-
lel as shown in Figure 2.8. Then, the parallel-connected network, Y, can be repre-
sented by admittance matrix. The admittance matrix of network 3 is
Network 3 = N3
Network 1 = N1
Network 2 = N2
Network 4 = N4
L
R
Z0, β
Q
C
V2
I2
V1
I1
l
L
+
+
FIGURE 2.7  Partition of amplifier circuit for network analysis.
Q
Network 3 = N3 = Y  y
Network 2 = N2 = Y x
R
=
+
Y
Y  x
Y y
FIGURE 2.8  Illustration of parallel connection between networks 2 and 3.

34
Linear and Switch-Mode RF Power Amplifiers
	
=
−
−












Y
R
R
R
R
1
1
1
1
y
	
(2.34)
The admittance matrix for the transistor can be now obtained by using the network 
conversion Table 2.1 since hybrid parameters for it are available. From Table 2.1,
	
=
−
∆














Y
h
h
h
h
h
h
h
1
x
11
12
11
21
11
11
	
(2.35)
Then, overall admittance matrix is found as
	
= 
+
=
+
−
−
−
+
+ ∆














Y
Y
Y
R
h
R
h
h
R
h
h
R
h
h
[ ]
1
1
1
1
1
x
y
11
12
11
21
11
11
	
(2.36)
where Δ is used for determinant of the corresponding matrix. At this point, it is 
now clearer that networks 1, Y and 4 are cascaded. We need to determine that 
ABCD matrix of each network in this connection as shown in Figure 2.9. The first 
step is then to convert the admittance matrix in Equation 1.36 to ABCD parameter 
using the conversion table. The conversion table gives the relation as
	
=
−
∆














ABCD
Y
Y
Y
Y
Y
Y
Y
1
Y
22
21
21
21
11
21
	
(2.37)
L
Network 4 = N4
Network Y
Network 1 = N1
L
C
I2
V2
+
I1
l
V1
Z0 , β
+
=
+
Y
Y x
Y y
FIGURE 2.9  Cascade connection of final circuit.
www.ebook3000.com

35
Two-Port Parameters
ABCD matrices for transmission line network 1 and matching network 4 are 
obtained as
	
( )
( )
( )
( )
=
β
β
β
β












ABCD
l
jZ
l
j
l
Z
l
cos
sin
sin
cos
N
0
0
1
	
(2.38)
	
(
)
=
−ω
ω
−ω
ω
−ω










ABCD
LC
j L
LC
j C
LC
a
1
2
1
N
2
2
2
4
	
(2.39)
The overall ABCD parameter of the combined network shown in Figure 2.9 is
	
(
)
=
ABCD
ABCD
ABCD
ABCD
N
Y
N
1
4 	
(2.40)
or
MATLAB® Script for network analysis of RF amplifier
Zo=50;
l=0.05;
L=2e-9;
C=12e-12;
rbe=400;
rce=70e3;
Cbe=15e-12;
Cbc=2e-12;
gm=0.2;
VGain=zeros(5,150);
IGain=zeros(5,150);
freq=zeros(1,150);
R=[200 300 500 1000 10000];
for i=1:5
for t=1:150; 
f=10^((t+20)/20);
freq(t)=f;
lambda=0.65*3e8/(f);
bet=(2*pi)/lambda;
w=2*pi*f;
N1=[cos(bet*l) 1j*Zo*sin(bet*l);1j*(1/Zo)*sin(bet*l) 
cos(bet*l)];
Y1=[1/R(i) -1/R(i);-1/R(i) 1/R(i)];
k=(1+1j*w*rbe*(Cbc+Cbe));
h=[(rbe/k) (1j*w*rbe*Cbc)/k;(rbe.*(gm-1j*w*Cbc))/k 
((1/rce)+(1j*w*Cbc*(1+gm*rbe+1j*w*Cbe*rbe)/k))];
Y2=[1/h(1,1) -h(1,2)/h(1,1);h(2,1)/h(1,1) det(h)/h(1,1)];
Y=Y1+Y2;
N23=[-Y(2,2)/Y(2,1) -1/Y(2,1);(det(Y)/Y(2,1)) -Y(1,1)/Y(2,1)];
N4=[(1-(w^2)*L*C) (2j*w*L-1j*(w^3)*L^2*C);1j*(w*C) 
(1-(w^2)*L*C)];

36
Linear and Switch-Mode RF Power Amplifiers
NT=N1*N23*N4;
VGain(i,t)=20*log10(abs(1/NT(1,1)));
IGain(i,t)=20*log10(abs(-1/NT(2,2)));
end
end
figure
semilogx(freq,(IGain))
axis([10^4 10^9 20 50]);
ylabel(‘I_{Gain} (I_2/I_1) (dB)’);
xlabel(‘Freq (Hz)’);
legend(‘R=200Ohm’,‘R=300Ohm’,‘R=500Ohm’,‘R=1000Ohm’,‘R=10000
Ohm’)
figure
semilogx(freq,(VGain))
axis([10^4 10^9 20 80]);
ylabel(‘V_{Gain} (V_2/V_1) (dB)’);
xlabel(‘Freq (Hz)’);
legend(‘R=200Ohm’,‘R=300Ohm’,‘R=500Ohm’,‘R=1000Ohm’, 
‘R=10000Ohm’)
(
)
(
)
(
)
(
)
(
)
=
β
β
β
β












−
∆














−ω
ω
−ω
ω
−ω










ABCD
l
jZ
l
j
l
Z
l
Y
Y
Y
Y
Y
Y
Y
LC
j L
LC
j C
LC
cos
sin
sin
cos
1
1
2
1
0
0
22
21
21
21
11
21
2
2
2
(2.41)
Voltage and current gains from ABCD parameters are found using
	
=




V
A
20log
1 [dB]
Gain
	
(2.42)
	
=




I
D
20log
1
[dB]
Gain
	
(2.43)
MATLAB script has been written to obtain the voltage and current gains. The script 
that can be used for analysis of any other similarly constructed amplifier network 
is given for reference. Voltage and current gains are obtained by MATLAB versus 
various feedback resistor values, and the frequencies are shown in Figures 2.10 
and 2.11. This type of analysis gives the designer the ability to study the effect of 
several parameters on output response in an amplifier circuit including feedback, 
matching networks, and parameters of the transistor.
2.4  S-SCATTERING PARAMETERS
Scattering parameters are used to characterize RF/microwave devices and compo-
nents at high frequencies [1–3]. Specifically, they are used to define the return loss 
and insertion loss of a component or device.
www.ebook3000.com

37
Two-Port Parameters
2.4.1  One-Port Network
Consider the circuit given in Figure 2.12. The relationship between current and volt-
age can be written as
	
=
+
I
V
Z
Z
g
g
L
	
(2.44)
50
45
40
35
30
IGain (I2/I1) [dB]
Frequency [Hz]
R = 200Ω
R = 300Ω
R = 500Ω
R = 1000Ω
R = 10,000Ω
25
20
104
105
106
107
108
109
FIGURE 2.10  Current gain of RF amplifier versus feedback resistor values and frequency.
80
70
60
50
40
30
20
104
105
106
VGain (V2/V1) [dB]
107
108
109
R = 200Ω
R = 300Ω
R = 500Ω
R = 1000Ω
R = 10,000Ω
Frequency [HZ]
FIGURE 2.11  Voltage gain of RF amplifier versus feedback resistor values and frequency.

38
Linear and Switch-Mode RF Power Amplifiers
and
	
=
+
V
V Z
Z
Z
g
L
g
L
	
(2.45)
where Zg is the generator impedance. The incident waves for voltage and current can 
be obtained when the generator is matched as
	
{
}
=
+
=
∗
I
V
Z
Z
V
Z
2Re
i
g
g
g
g
g
	
(2.46)
and
	
{
}
=
+
=
∗
∗
∗
V
V Z
Z
Z
V Z
Z
2Re
i
g
g
g
g
g
g
g
	
(2.47)
Then, the reflected waves are found from
	
=
−
I
I
I
i
r 	
(2.48)
and
	
=
−
V
V
V
i
r 	
(2.49)
Substituting Equations 2.44 and 2.46 into Equation 2.48 gives the reflected wave as
	
=
−
=
−
+






∗
∗
I
I
I
Z
Z
Z
Z
I
r
i
L
g
L
g
i 	
(2.50)
or
	
=
I
S I
I
r
i 	
(2.51)
where
	
=
−
+






∗
∗
S
Z
Z
Z
Z
I
L
g
L
g
	
(2.52)
Vg
Zg
ZL
V
+
FIGURE 2.12  One-port network for scattering parameter analysis.
www.ebook3000.com

39
Two-Port Parameters
is the scattering matrix for current. Similar analysis can be done to find reflected 
voltage wave by substituting Equations 2.45 and 2.47 into Equation 2.49 as
	
=
−
=
−
+






∗
∗
∗
V
V
V
Z
Z
Z
Z
Z
Z
V
r
i
g
g
L
g
L
g
i 	
(2.53)
or
	
=
=
∗
V
Z
Z S V
S V
I
V
r
g
g
i
i 	
(2.54)
where
	
=
∗
S
Z
Z S
V
I
g
g
	
(2.55)
is the scattering matrix for voltage. It can also be shown that
	
=
∗
V
Z I
i
g
i 	
(2.56)
	
=
V
Z I
r
g
r 	
(2.57)
When generator impedance is pure real, Zg = Rg, then
	
=
=
−
+






S
S
Z
R
Z
R
I
V
i
L
g
L
g
	
(2.58)
2.4.2  N-Port Network
The analysis described in the previous section can be extended to N-port network 
shown in Figure 2.13. The analysis is based on the assumption that generators are 
independent of each other. Hence, Z generator matrix has no cross coupling terms, 
and it can be expressed as a diagonal matrix.
	
[
] =














Z
Z
Z
Z
0
0
0
0
0
0
n
g
g1
g2
g
…





	
(2.59)
From Equations 2.48 and 2.49, the incident and reflected waves are related to the 
actual voltage and current values as
	
[ ]
[ ] [ ]
=
−
I
I
I
i
r 	
(2.60)
	
[ ]
[ ] [ ]
=
+
V
V
V
i
r 	
(2.61)

40
Linear and Switch-Mode RF Power Amplifiers
From Equations 2.56 and 2.57, the incident and reflected components can be related 
through
	
[ ]
[ ]
=

∗
V
Z
I
i
g
i 	
(2.62)
	
[ ]
[ ]
=

V
Z
I
r
g
r 	
(2.63)
similar to one-port case as derived before. For N-port network, Z-parameters can be 
obtained as
	
[ ]
[ ][ ]
=
V
Z
I 	
(2.64)
Using Equations 2.59 through 2.64, we can obtain
	
[ ]
[ ] [ ]
[ ][ ]
[ ]
=
−
=
−

∗
V
V
V
Z
I
Z
I
r
i
g
i 	
(2.65)
Equation 2.65 can be also expressed as
	
(
)
[
][ ]
[ ][ ]
[ ]
[ ] [ ] [ ]
[ ]
=
−

=
−
−

∗
∗
Z
I
Z
I
Z
I
Z
I
I
Z
I
g
r
g
i
i
r
g
i 	
(2.66)
and simplified to
	
(
)
(
)
[ ]
[ ]
[ ]
[ ]
+ 

=
−

Z
Z
I
Z
Z
I
g
g
r
*
i 	
(2.67)
Vg1
Zg1
V1
+
N-port network
Vg4
Zg1
+
Vgn
Zgn
+
+
V4
V5
V8
+
+
Vn
V9
Vg9
Z9
Vg8
Vg5
Zg5
Zg8
I1
I4
I5
I8
I9
In
FIGURE 2.13  N-port network for scattering analysis.
www.ebook3000.com

41
Two-Port Parameters
Equation 2.67 can be put in the following form
	
(
)
(
)
[ ]
[ ]
[ ]
[ ]
=
+ 

−

−
I
Z
Z
Z
Z
I
g
r
g
1
*
i 	
(2.68)
From Equation 2.52, the scattering matrix for current for N-port network is equal to
	
(
)
(
)
[ ]
[ ]
=
+ 

−

−
S
Z
Z
Z
Z
I
g
g
1
*
	
(2.69)
Then, Equation 2.68 can be expressed as
	
[ ]
[ ]
=

I
S
I
I
r
i 	
(2.70)
For N-port network, Y-parameters for short circuit case can be obtained similarly as
	
[ ]
[ ][ ]
=
I
Y
V 	
(2.71)
It can also be shown that
	
(
)
(
)
[ ]
[ ]
[ ]
[ ]
= −
+ 

−

−
V
Y
Y
Y
Y
V
r
g
1
g
*
i 	
(2.72)
or
	
[ ]
[ ]
=

V
S
V
V
r
i 	
(2.73)
where
	
(
)
(
)
[ ]
[ ]
= −
+ 

−

−
S
Y
Y
Y
Y
V
g
1
g
*
	
(2.74)
Example 2.3
Consider a transistor network that is represented as a two-port network and con-
nected between source and load. It is assumed that the generator or source and 
load impedances are equal and given to be Rg. Transistor is represented by the 
following Z-parameters as shown in Figure 2.14. Find current scattering matrix, SI.
	
[ ] =








Z
Z
Z
Z
Z
i
r
f
o
Solution: From Equation 2.69, the scattering matrix for current is
	
S
Z
Z
Z
Z
I
g
1
g
*
(
)
(
)
[ ]
[ ]
=
+ 

−

−
	
(2.75)
The generator Zg-matrix is
	

= 
=








Z
Z
R
R
0
0
g
g
*
g
g
	
(2.76)

42
Linear and Switch-Mode RF Power Amplifiers
Then,
	
[ ] +
=








+







=
+
+








∗
Z
Z
Z
Z
Z
Z
R
R
Z
R
Z
R
0
0
0
0
g
i
r
f
o
g
g
i
g
o
g
	 (2.77)
The inverse of the matrix in Equation 2.77 is
	
Z
Z
Z
Z
Z
Z
1
C
T
g
1
g
g
(
)
[ ]
[ ]
[ ]
+ 





=
+ 

+ 







∗
−
∗
∗
	
(2.78)
Z
Z g
[ ]+ 

∗ is the determinant of [ ] +

∗
Z
Z g  and is calculated as
	
(
)(
)
[ ] +

=
+
+
−
∗
Z
Z
Z
R
Z
R
Z Z
g
i
g
o
g
r
f 	
(2.79)
Z
Z
C
g
[ ]+ 



∗
 is the cofactor matrix for [ ] +

∗
Z
Z g  and calculated as
	
Z
Z
Z
R
Z
Z
Z
R
C
g
o
g
f
r
i
g
(
)
[ ]+ 

=
+
−
−
+








∗
	
(2.80)
Then,
	
Z
Z
Z
R
Z
Z
Z
R
C
T
g
o
g
r
f
i
g
(
)
[ ]+ 




=
+
−
−
+








∗
	
(2.81)
Hence, the inverse of the matrix from Equations 2.77 to 2.81 is equal to
	
Z
Z
Z
R
Z
R
Z Z
Z
R
Z
Z
Z
R
1
g
g
1
i
g
o
r
f
o
g
r
f
i
g
(
)
(
)
(
)(
)
[ ]+ 





=
+
+
−
+
−
−
+








∗
−
	
(2.82)
Vg
Zg
ZL
V
+
Zi
Zr
Zf
Zo
I
FIGURE 2.14  Two-port transistor network.
www.ebook3000.com

43
Two-Port Parameters
Then, from Equation 2.75
S
Z
Z
Z
Z
Z
R
Z
R
Z Z
Z
R
Z
Z
Z
R
Z
R
Z
Z
Z
R
1
I
g
1
g
i
g
o
g
r
f
o
g
r
f
i
g
i
g
r
f
o
g
(
) (
)
(
)
(
)(
)
[ ]
[ ]
=
+ 

−

=
+
+
−
+
−
−
+















−
−
−
















−
	
	
(2.83)
which can be simplified to
	
S
Z
Z
Z
Z
Z
R
Z
R
Z Z
Z R
Z R
Z
R
Z
R
Z Z
2
2
I
r
g
g
1
g
o
g
i
g
r
f
f
g
i
g
o
g
r
f
(
) (
)
(
)(
)
(
)(
)
[ ]
[ ]
=
+ 

−

=
+
−
−
+
−
−








−
	
(2.84)
2.4.3  Normalized Scattering Parameters
Normalized scattering parameters can be introduced by a and b for the incident and 
reflected waves as follows.
	
(
)[ ]
=

+ 

a
Z
Z
I
[ ]
1
2
g
g
*
i 	
(2.85)
	
(
)[ ]
=

+ 

b
Z
Z
I
[ ]
1
2
g
g
*
r 	
(2.86)
where
(
)
{
}
{
}
{
}
{
}

+ 
=
=


















Z
Z
Z
Z
Z
Z
1
2
Re
Re
0
K
0
0
Re
L
0
M
M
M
0
0
L
Re
n
g
g
*
g
g1
g2
g
		
(2.87)
Substituting Equation 2.68 into Equations 2.85 and 2.86 gives
	
[ ]
[ ]
[ ]
{
}
=
=

b
Z
I
S
I
Re
I
g
r
i 	
(2.88)

44
Linear and Switch-Mode RF Power Amplifiers
or
	
[ ]
[ ]
{
}
{
}
=

b
Z
S
a
Z
Re
Re
I
g
g
	
(2.89)
Then, from Equations 2.88 and 2.89,
	
[ ]
[ ]
{
}
{
}
=



−
b
Z
S
Z
a
Re
Re
I
g
g
1/2
	
(2.90)
Equation 2.90 can be simplified to
	
[ ]
[ ][ ]
=
b
S
a 	
(2.91)
where
	
[ ]
{
}
{
}
=



−
S
Z
S
Z
Re
Re
I
g
g
1/2	
(2.92)
and
	
{
}
{
}
{
}
{
}


=
























−
Z
Z
Z
Z
Re
1
Re
0
K
0
0
1
Re
L
0
M
M
M
0
0
L
1
Re
n
g
1/2
g1
g2
g
	 (2.93)
S matrix in Equation 2.91 is called a normalized scattering matrix. It can be proven 
that
	
S
Z
S
Z
I
V
g
1
g
*

= 




−
	
(2.94)
When the generator or source impedance is real, Zg = Rg, then from Equation 2.94, 
we obtain
	

=

S
S
I
V 	
(2.95)
In addition, Equations 2.69 and 2.92 take the following form
	
(
) (
)
[ ]
[ ]
=
+ 

−

−
S
Z
R
Z
R
I
g
1
g
	
(2.96)
	
[
]
[ ] =


−
S
R
S
Z
I
g
g
1/2 	
(2.97)
www.ebook3000.com

45
Two-Port Parameters
From Equations 2.95 and 2.97, we obtain
	
[ ] =
=

S
S
S
I
V 	
(2.98)
S-parameters can be calculated using the two-port network shown in Figure 2.15. 
In Figure 2.15, the source or generator impedances are given as Rg1 and Rg2. When 
Equation 2.91 is expanded,
	








=
















b
b
S
S
S
S
a
a
1
2
11
12
21
22
1
2
	
(2.99)
From Equation 2.99,
	
=
+
b
S a
S a
1
11 1
12
2 	
(2.100)
	
=
+
b
S a
S a
2
21 1
22
2 	
(2.101)
Hence, S-parameters can be defined from Equations 2.100 and 2.101 as
	
=
=
=
=
=
=
=
=
S
b
a
S
b
a
S
b
a
S
b
a
a
a
a
a
11
1
1
0
12
1
2
0
21
2
1
0
22
2
2
0
2
1
2
1
	
(2.102)
From Equation 2.102, the scattering parameters are calculated when a1 = 0 or a2 =0. 
a represents the incident waves. If Equation 2.85 is reviewed again,
	
(
)[ ]
=

+ 

a
Z
Z
I
[ ]
1
2
g
g
*
i 	
(2.103)
1
2
a1
a2
b1
b2
2-port
network
V1g
Rg1
V2g
Rg2
+
V1
I1
I1i
I1r
V1i
V1r
I2i
I2r
I2
V2r
V2i
+
V2
FIGURE 2.15  S-parameters for two-port networks.

46
Linear and Switch-Mode RF Power Amplifiers
a2 becomes zero when I2i =0. This can be obtained when there is no source con-
nected to port 2, i.e., V2g = 0 with existence of source impedance, Rg2. From KLV for 
the second port, we obtain
	
= −
+
=
V
I R
V
I R
or
0
2
2
g2
2
2
g2
	
(2.104)
Substituting Equations 2.60 and 2.61 into Equation 2.104 gives
	
(
)
+
=
+
+
−
V
I R
V
V
R
I
I
 
2
2
g2
i2
2r
g2
2i
2r 	
(2.105)
which leads to
	
+
=
+
+
−
V
I R
I R
R I
R I
I R
 
i
2
2
g2
2
g2
g2 2r
g2 2i
2r
g2 	
(2.106)
or
	
+
=
V
I R
R I
 
2
2
2
g2
g2 2i 	
(2.107)
From Equation 2.103, when Zg = Rg,
	
[ ]
=
a
R
I
[ ]
g
i 	
(2.108)
Substituting Equation 2.106 into Equation 2.107 gives
	
+
=
V
I R
R a
 
2
2
2
g2
g2
2 	
(2.109)
Then,
	
=
+
a
V
I R
R
2
2
2
2
g2
g2
	
(2.110)
It is then proven that when Equation 2.104 is substituted into Equation 2.110, a2 = 0 as 
expected. This also requires Ii = 0 from Equation 2.109. Then, this shows that there is 
no reflected current, which is the incident current, I2i, at port 2 owing to the source 
generator incident wave from port 1.
Similar analysis can be done at port 1 when a1 = 0. Following the same steps, it 
can be shown that
	
=
+
a
V
I R
R
2
1
1
1
g1
g1
	
(2.111)
Reflected waves, b1 and b2, can be analyzed the same way using the analysis just 
presented for the incident waves a1 and a2. When no source voltage is connected at 
port 1, a1 = 0 in the existence of source voltage Rg1, we can write
www.ebook3000.com

47
Two-Port Parameters
	
= −
+
=
V
I R
V
I R
or
0
1
1
g1
1
1
g1
	
(2.112)
In terms of the reflected and incident voltage and current, we get
	
(
)
−
=
+
−
−
V
I R
V
V
R
I
I
 
1
1
g1
1i
1r
g1
1i
1r 	
(2.113)
which leads to
	
−
=
+
−
+
V
I R
I R
I R
I R
I R
 
1
1
g1
1i
g1
1r
g1
1i
g1
1r
g1 	
(2.114)
or
	
−
=
V
I R
R I
 
2
1
1
g1
g1 1r 	
(2.115)
From Equation 2.86, when Zg = Rg,
	
[ ]
=
b
R
I
[ ]
g
r 	
(2.116)
Hence, Equation 2.115 can be written as
	
−
=
V
I R
R b
 
2
1
1
g1
g1 1 	
(2.117)
Then,
	
=
−
b
V
I R
R
2
1
1
1
g1
g1
	
(2.118)
We can also show that when a2 = 0,
	
=
−
b
V
I R
R
2
2
2
2
g2
g2
	
(2.119)
Incident and reflected parameters a and b for N-port network can be written using 
the results given in Equations 2.110 , 2.111, 2.118, and 2.119 for real generator imped-
ance, Rg, as
	
(
)
[
]
[
]
[ ]
[ ]
[ ]
=
+
−
a
R
V
R
I
1
2
g
1/2
g
	
(2.120)
	
(
)
[
]
[
]
[ ]
[ ]
[ ]
=
−
−
b
R
V
R
I
1
2
g
1/2
g
	
(2.121)
For an arbitrary impedance, Equations 2.120 and 2.121 can be written as
	
(
)
[
]
[ ]
[ ]
[ ]
{
}
=


+
−
a
Z
V
Z
I
1
2 Re
g
1/2
g
	
(2.122)
	
(
)
[ ]
[ ]
[ ]
{
}
=


−

−
b
Z
V
Z
I
1
2 Re
g
g
1/2
*
	
(2.123)

48
Linear and Switch-Mode RF Power Amplifiers
Now, since we derived the conditions when a1 and a2 are zero, we can expand equa-
tions given by Equation 2.102. When a2 = 0, we can calculate S11 and S21. From 
Equations 2.111, 2.118, 2.108, and 2.106, S11 can be expressed as
	
=
=
−






+






=
−
+
=
=
=
=
=
S
b
a
V
I R
R
V
I R
R
V
I R
V
I R
V
V
R I
R I
I
I
2
2
a
I
11
1
1
0
1
1
g1
g1
1
1
g1
g1
0
1
1
g1
1
1
g1
1r
1i
1g
1r
1g
1i
1r
1i
2
2i
	
(2.124)
or
	
=
−
+
S
Z
R
Z
R
11
11
g1
11
g1
	
(2.125)
In Equation 2.125, S11 is the reflection coefficient at port 1 when port 2 is terminated 
with generator impedance Rg2. We express S21 using Equations 2.111, 2.119, 2.108, 
and 2.116 as
	
(
)
(
)
=
=
−






+






=
−
+
=
=
=
S
b
a
V
I R
R
V
I R
R
V
I R
R
V
I R
R
R I
R I
2
2
a
I
21
2
1
0
2
2
g2
g2
1
1
g1
g1
0
2
2
g2
g1
1
1
g1
g2
2g
2r
1g
1i
2
2i
	
(2.126)
When a2 = 0, V2g = 0, and that results in V2 = −I2Rg2 and V1g = 2I1iRg1; then Equation 
2.126 can be written as
	
(
)
(
)
=
= −
= −
=
=




=
S
b
a
R I
R
V
R
R
R
I
V
R
R
V
V
V
R
V
R
2
2
2
1
2
a
g
g
21
2
1
0
2g
2
1g
1g
1g
1g
2
2
1
1g
2g
2
1g
2
2g
1g
1g
2
	 	
(2.127)
As shown from Equation 2.127, S21 is the forward transmission gain of the network 
from port 1 to port 2. Similar procedure can be repeated to derive S22 and S12 when 
a1 = 0. Hence, it can be shown that
	
S
b
a
V
I R
R
V
I R
R
V
I R
V
I R
V
V
R I
R I
I
I
2
2
a
I
22
2
2
0
2
2
g2
g2
2
2
g2
g2
0
2
2
g2
2
2
g2
2r
2i
2g
2r
2g
2i
2r
2i
1
1i
=
=
−




+




=
−
+
=
=
=
=
=
	(2.128)
www.ebook3000.com

49
Two-Port Parameters
or
	
=
−
+
S
Z
R
Z
R
22
22
g2
22
g2
	
(2.129)
S22 is the reflection coefficient of the output. S12 can be obtained as
	
(
)
(
)
=
=
−






+






=
−
+
=
=
=
S
b
a
V
I R
R
V
I R
R
V
I R
R
V
I R
R
R I
R I
2
2
a
I
12
1
2
0
1
1
g1
g1
2
2
g2
g2
0
1
1
g1
g2
2
2
g2
g1
1g
1r
2g
2i
1
1i
	
(2.130)
which can be put in the following form
	
(
)
=
= −
=
= 



=
S
b
a
R
R
I
V
R
R
V
V
V
R
V
R
2
2
1
2
a
12
1
2
0
1g
2g
1
2g
2g
1g
1
2g
1
1g
2g
2g
1
	
(2.131)
S12 is the reverse transmission gain of the network from port 2 to port 1. Overall, 
S-parameters are found when an = 0, which means that there is no reflection at that 
port. This is only possible by matching all the ports except the measurement port. 
Insertion loss and return loss in terms of S-parameters are defined as
	
(
)
=
=
≠
S
i
j
Insertion Loss [dB]
IL [dB]
20log
,
ij
	
(2.132)
	
(
)
=
=
S
Return Loss [dB]
RL [dB]
20log
ii 	
(2.133)
Another important parameter that can be defined using S-parameters is the voltage 
standing wave ratio (VSWR). For instance, VSWR at port 1 is found from
	
=
−
+
S
S
VSWR
1
1
11
11
	
(2.134)
The two-port network is reciprocal if
	
=
S
S

 
21
12 	
(2.135)
It can be shown that a network is reciprocal if it is equal to its transpose. This is 
represented for a two-port network as
	
[ ]
[ ]
=
S
S
t 	
(2.136)

50
Linear and Switch-Mode RF Power Amplifiers
or
	
















=
S
S
S
S
S
S
S
S
t
11
12
21
22
11
21
12
22
	
(2.137)
When network is lossless, S-parameters can be used to characterize this feature as
	
[ ] [ ]
[ ]
=
S
S
U
t
*
	
(2.138)
where ∗ defines complex conjugate of a matrix, and U is the unitary matrix and 
defined by
	






=
1
0
0
1
U
[ ]
	
(2.139)
Equation 2.138 can be applied for two-port network as
	
(
)
(
)
(
)
(
)
[ ] [ ]










=






=
+
+
+
+
S
S
S
S
S S
S S
S S
S S
S
S
1
0
0
1
t
*
11
2
21
2
11 12
*
21
22
*
12
11
*
22
21
*
12
2
22
2
	
(2.140)
We can further show that if a network is lossless and reciprocal, it satisfies
	
=
+
1
S
S
11
2
21
2
	
(2.141)
	
=
+
0
S S
S S
11 12
*
21
22
*
	
(2.142)
Example 2.4
Find the characteristic impedance of the T-network given in Figure 2.16 to have no 
return loss at the input port.
ZB
ZC
ZA
I1
V1
+
+
V2
I2
FIGURE 2.16  T-network configuration.
www.ebook3000.com

51
Two-Port Parameters
Solution: Scattering parameter for T-network are found from Equation 2.102. From 
Equation 2.102, S11 is equal to
	
=
=
−
+
=
S
b
a
Z
Z
Z
Z
a
11
1
1
0
in
o
in
o
2
	
(2.143)
where
	
=
+
+
+
+




Z
Z
Z
Z
Z
Z
Z
Z
(
)
(
)
A
C
B
C
B
in
o
o
	
(2.144)
No return loss is possible when 
=
S
0
11
. This can be satisfied from Equations 2.143 
and 2.144 when
	
=
=
+
+
+
+




Z
Z
Z
Z
Z
Z
Z
Z
Z
(
)
(
)
A
C
B
C
B
o
in
o
o
	
(2.145)
REFERENCES
	
1.	 A. Eroglu, RF Circuit Design Techniques for MF-UHF Applications, CRC Press, Boca 
Raton, FL, 2013.
	
2.	 G. Matthaei, E. M .T. Jones, and L. Young, Microwave Filters, Impedance-Matching 
Networks, and Coupling Structures, Artech House, Norwood, MA, 1980.
	
3.	 A. Eroglu, Introduction to RF Power Amplifier Design and Simulation, CRC press, 
Boca Raton, FL, 2016.

www.ebook3000.com

53
3 Impedance Matching 
and Resonant Networks
3.1  INTRODUCTION
Radio frequency (RF) power amplifiers consist of several stages as illustrated in 
Figure 3.1 [1–2]. Impedance matching networks are used to provide the optimum 
power transfer from one stage to another, so that the energy transfer is maxi-
mized. This can be accomplished by having matching networks between the stages. 
Matching networks can be implemented using distributed or lumped elements based 
on the frequency of operation and application. Distributed elements are implemented 
using transmission lines for high-frequency operation where lumped elements are 
used for lower frequencies. Matching networks, when designed with lumped ele-
ments, are implemented using ladder network structure. In the design of matching 
network, there are several important parameters such as bandwidth and quality fac-
tor of the network. These can be investigated with design tools such as Smith chart. 
Smith chart helps the designer to visualize the performance of the matching net-
work for the operational conditions under consideration. In this chapter, analysis of 
transmission lines, Smith chart, and design of impedance matching network will be 
detailed, and several application examples will be given.
3.2  TRANSMISSION LINES
A transmission line is a distributed-parameter network, where voltages and currents 
can vary in magnitude and phase over the length of the line. Transmission lines usu-
ally consist of two parallel conductors that can be represented with a short segment 
of Δz. This short segment of transmission line can be modeled as a lumped-element 
circuit as shown in Figure 3.2.
In Figure 3.2, R is the series resistance per unit length for both conductors, 
Ω
R
m
[
/ ]; L is the series inductance per unit length for both conductors, L H m
[
/ ]; G 
is the shunt conductance per unit length, G S m
[ / ]; and C represents the shunt capaci-
tance per unit length, C F m
[ / ] in the transmission line. Application of Kirchhoff’s 
Voltage Law (KVL) and Kirchhoff’s Current Law (KCL) give
	
−
∆
−∆∂
∂
−
+ ∆
=
v z t
R zi z t
L z i z t
t
v z
z t
( , )
( , )
( , )
(
, )
0 	
(3.1)
	
−
∆
+ ∆
−
∆∂
+ ∆
∂
−
+ ∆
=
i z t
G zv z
z t
C z v z
z t
t
i z
z t
( , )
(
, )
(
, )
(
, )
0. 	
(3.2)
Dividing Equations 3.1 and 3.2 by Δz and assuming Δz → 0, we obtain

54
Linear and Switch-Mode RF Power Amplifiers
	
∂
∂
= −
−
∂
∂
v z t
z
Ri z t
L i z t
t
( , )
( , )
( , ) 	
(3.3)
	
∂
∂
= −
−
∂
∂
i z t
z
Gv z t
C v z t
t
( , )
( , )
( , ). 	
(3.4)
Equations 3.3 and 3.4 are known as the time-domain form of the transmission line or 
telegrapher equations. Assuming the sinusoidal steady-state condition with applica-
tion cosine-based phasors, Equations 3.3 and 3.4 take the following forms:
	
= −
+ ω
V z
z
R
j L I z
d ( )
d
(
) ( ).	
(3.5)
	
= −
+ ω
I z
z
G
j C V z
d ( )
d
(
) ( ).	
(3.6)
By eliminating either I(z) or V(z) from Equations 3.5 to 3.6, we obtain the wave equa-
tions as
	
= −γ
V z
z
V z
d
( )
d
( )
2
2
2
	
(3.7)
	
= −γ
I z
z
I z
d
( )
d
( ) ,
2
2
2
	
(3.8)
Input
matching
network
Vg
ZL
Γin
Γs
ΓL
Γout
Output
matching
network
Zg
FIGURE 3.1  Matching network implementation for RF power amplifiers.
+
−
+
−
R∆z
L∆z
i(z ,t)
v(z ,t)
∆z
v(z + ∆z, t)
i(z + ∆z, t)
G∆z
C∆z
FIGURE 3.2  Short segment of transmission line.
www.ebook3000.com

55
Impedance Matching and Resonant Networks
where
	
γ = α+ β =
+ ω
+ ω
j
R
j L G
j C
(
)(
) 	
(3.9)
In Equation 3.9, γ is the complex propagation constant, α is attenuation constant, and 
β is known as the phase constant. In transmission lines, phase velocity is defined as
	
= ω
β
v
.
p
	
(3.10)
Wavelength can be defined using
	
λ =
π
β
2 . 	
(3.11)
Traveling wave solutions to the equations obtained in Equations 3.7 and 3.8 are
	
=
+
+ −γ
−+γ
V z
V
V
( )
e
e
z
z
o
o
	
(3.12)
	
=
+
+
−γ
−
+γ
I z
I
I
( )
e
e
.
z
z
0
0
	
(3.13)
Substitution of Equations 3.12 into 3.5 gives
	
=
γ
+ ω
+


+ −γ
−+γ
I z
R
j L V
V
( )
e
e
.
z
z
o
o
	
(3.14)
From Equation 3.14, the characteristic impedance, Z0, is defined as
	
=
+ ω
γ
=
+ ω
+ ω
Z
R
j L
R
j L
G
j C .
0
	
(3.15)
Hence,
	
=
= −
+
+
−
−
V
I
Z
V
I
0
0
0
o
o 	
(3.16)
and
	
=
−
+
−γ
−
+γ
I z
V
Z
V
Z
( )
e
e
 
z
z
0
0
o
o
	
(3.17)
Using the formulation derived, we can find the voltage and current at any point on the 
transmission line (Figure 3.3). At the load z = 0,
	
( )
=
V
Z I
(0)
0
L
	
(3.18)
	
(
)
+
=
−
+
−
+
−
V
V
Z
Z
V
V
o
o
L
0
o
o
	
(3.19)

56
Linear and Switch-Mode RF Power Amplifiers
or
	
+



=
−




−
+
V
Z
Z
V
Z
Z
1
1 ,
o
L
0
o
L
0
	
(3.20)
which leads to
	
=
−
+




−
+
V
V
Z
Z
Z
Z
.
o
o
L
0
L
0
	
(3.21)
We then define Equation 3.21 as the reflection coefficient at the load and express it as
	
Γ =
−
+




Z
Z
Z
Z
.
L
L
0
L
0
	
(3.22)
We can express voltage and current in terms of reflection coefficient as
	
(
)
=
+ Γ
−γ
+γ
+
V z
V
( )
e
e
z
z
o
L
	
(3.23)
	
(
)
=
−Γ
+
−γ
+γ
I z
Z V
( )
1
e
e
.
z
z
0
o
L
	
(3.24)
We can find the input impedance at any point on the transmission line shown in 
Figure 3.4 from
	
( )
( )
( )
=
Z
z
V z
I z .
in
	
(3.25)
We then have
	
(
)
(
)
( ) =
+ Γ
−Γ
−γ
+γ
−γ
+γ
Z
z
Z
e
e
e
e
,
z
z
z
z
in
0
L
L
	
(3.26)
Zg
Vg
I(z)
V(z)
Z0 , γ
ZL
z = −l
z = 0
+
−
FIGURE 3.3  Finite terminated transmission line.
www.ebook3000.com

57
Impedance Matching and Resonant Networks
which can be expressed as
	
( )
(
) (
)
(
) (
)
(
)
(
)
(
)
(
)
=
+
−
+




−
−
+
















=
+
+
−
+
−
−




=
+
+
−
+
−
−




+ γ
+ γ
+ γ
+ γ
−γ
+γ
−γ
+γ
Z
z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
1
e
1
e
e
e
e
e
e
e
.
z
z
z
z
z
z
z
z
in
0
L
0
L
0
2
L
0
L
0
2
0
L
0
L
0
2
L
0
L
0
2
0
L
0
L
0
L
0
L
0
	
(3.27)
We can rewrite Equation 3.27 as
	
(
)
(
)
(
)
(
)
( )
(
)
(
)
(
)
(
)
=
+
+
−
+
−
−



=
+
−
−
−
−
+
+






−γ
+γ
−γ
+γ
+γ
−γ
+γ
−γ
+γ
−γ
+γ
−γ
Z
z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
Z
e
e
e
e
e
e
e
e
e
e
e
e
,
z
z
z
z
z
z
z
z
z
z
z
z
in
0
L
0
L
0
L
0
L
0
0
L
0
L
0
	
(3.28)
which can also be expressed as
	
( )
( )
=
−
γ
−
γ




Z
z
Z
Z
Z
z
Z
Z
z
( )
tanh
tanh
in
0
L
0
0
L
	
(3.29)
At the input when z = −l, the impedance can be found from Equation 3.29 as
	
( )
( )
=
+
γ
+
γ






Z
z
Z
Z
Z
l
Z
Z
l
( )
tanh
tanh
.
in
0
L
0
0
L
	
(3.30)
3.2.1  Limiting Cases for Transmission Lines
There are three cases that can be considered as the limiting case for transmission 
lines. These are lossless lines, low loss lines, and distortionless lines.
Zg
Vg
ZL
Z0, γ 
z = 0
+
–
Zin
z = –l
V(z)
I(z)
FIGURE 3.4  Input impedance calculation on the transmission line.

58
Linear and Switch-Mode RF Power Amplifiers
	
1.	Lossless line (R = G = 0)
Transmission lines can be considered as lossless when R = G = 0. When R = G = 0, 
the defining equations for the transmission lines can be simplified as
	
γ = α+ β = ω
⇒α =
j
j
LC
0 	
(3.31a)
	
β = ω LC 	
(3.31b)
	
= ω
β =
v
LC
1
p
	
(3.31c)
	
=
=
+
⇒
=
=
Z
L
C
R
jX
R
L
C
X
,
0.
0
0
0
0
0
	
(3.31d)
	
2.	Low loss line (R << ωL, G << ωC)
For low-loss transmission lines, R << ωL, G << ωC, and defining equations simplify 
to
	
γ = α+ β = ω
+ ω




+ ω




j
j
LC
R
j L
G
j C
1
1
1/2
1/2
	
(3.32a)
	
α ≅
+






R C
L
G
L
C
1
2
	
(3.32b)
	
β ≅ω LC 	
(3.32c)
	
= ω
β ≅
v
LC
1
p
	
(3.32d)
	
=
+
=
+ ω




+ ω




−
Z
R
jX
L
C
R
j L
G
j C
1
1
.
0
0
1/2
1/2
	
(3.32e)
	
3.	Distortionless line (R/L = G/C)
In distortionless transmission lines, R/L = G/C, and the defining equations can be 
simplified as
	
γ = α+ β =
+ ω
j
C
L R
j L
(
)  	
(3.33a)
	
α = R C
L  	
(3.33b)
www.ebook3000.com

59
Impedance Matching and Resonant Networks
	
β = ω LC  	
(3.33c)
	
=
v
LC
1
 
p
	
(3.33d)
	
=
Z
L
C .
0
	
(3.33e)
3.2.2  Terminated Lossless Transmission Lines
Consider the lossless transmission line shown in Figure 3.5. The voltage and current 
at any point on the line can be written as
	
=
+
+ −β
−
β
V z
V
V
( )
e
e
j z
j z
o
o
	
(3.34)
	
=
−
+
−β
−
+ β
I z
V
Z
V
Z
( )
e
e
.
j z
j z
0
0
o
o
	
(3.35)
The voltage and current at the load z = 0 in terms of load reflection coefficient is
	
=
+Γ


+
−β
β
V z
V
( )
e
e
j z
j z
o
	
(3.36)
	
=
−Γ


+
−β
β
I z
V
Z
( )
e
e
.
j z
j z
0
o
	
(3.37)
It is seen that the voltage and current on the line consist of a superposition of an inci-
dent and reflected wave, which represents standing waves. When Γ = 0, it is a matched 
condition. The time-average power flow along the line at the point z can be written as
	
{
}
{
}
=
=
−Γ
+Γ
−Γ
∗
+
∗−
β
β
P
V z I
z
V
Z
1
2 Re
( )
( )
1
2
Re 1
e
e
j z
j z
avg
2
0
2
2
2
o
	
(3.38)
+
ZL
–
VL
–
IL
z
z = –l
Z0 , β
z = 0
V(z), I(z)
FIGURE 3.5  Lossless transmission line.

60
Linear and Switch-Mode RF Power Amplifiers
or
	
(
)
=
−Γ
+
P
V
Z
1
2
1
.
avg
2
0
2
o
	
(3.39)
When the load is mismatched, not all of the available power from the generator is 
delivered to the load. The power that is lost is known as return loss (RL), and this 
can be found from
	
= −
Γ
RL
20 log |
|  dB. 	
(3.40)
Under mismatched condition, voltage on the line can be written as
	
=
+Γ
=
+Γ
=
+ Γ
+
β
+
−
β
+
θ−β
V z
V
V
V
( )
1
e
1
e
1
e
.
j z
j l
j
l
2
2
(
2
)
o
o
o
	
(3.41)
The minimum and maximum values of the voltage from Equation 3.41 is found as
	
(
)
(
)
=
+ Γ
=
−Γ
+
+
V
V
V
V
1
    and   
1
.
max
min
o
o
	
(3.42)
A measure of the mismatch of a line is called the voltage standing wave ratio (VSWR), 
which can be expressed as the ratio of maximum voltage to minimum voltage as
	
=
= + Γ
−Γ
V
V
VSWR
1
1
.
max
min
	
(3.43)
From Equation 3.41, the distance between two successive voltage maxima (or min-
ima) is l = 2π/2β = λ/2 (2βl = 2π), while the distance between a maximum and a 
minimum is l = π/2β = λ/4. From (3.37) with z = −l,
	
Γ
=
= Γ
−−β
+
β
−
β
l
V
V
( )
e
e
(0)e
.
j l
j l
j l
2
o
o
	
(3.44)
For the current,
	
=




−Γ




−β
+
φ−β
(
)
+
z
V
Z
I( )
e
1
1
e
j z
j
l
2
o
0
	
(3.45a)
or
	
=




−Γ
+
φ−β
(
)
+
z
V
Z
I( )
1
1
e
.
j
l
2
o
0
	
(3.45b)
Hence, the maximum and minimum values of the current on the line can be written as
www.ebook3000.com

61
Impedance Matching and Resonant Networks
	
(
)
=
=




+ Γ
+
I
I z
V
Z
( )
1
1
max
max
o
0
	
(3.46a)
	
(
)
=
=




−Γ
+
I
I z
V
Z
( )
1
1
.
min
min
o
0
	
(3.46b)
The current standing wave ratio (ISWR) is
	
=
= + Γ
−Γ
I
I
ISWR
1
1
.
max
min
	
(3.47)
Hence, VSWR = ISWR from Equations 3.43 and 3.47. We will be using VSWR 
through the book for analysis. The voltage waveform versus length of the transmis-
sion line along the axis is plotted in Figure 3.6.
At a distance l = −z, the input impedance is the equal to
	
=
−
−
=
+
β
+
β
Z
V
l
I
l
Z Z
jZ
l
Z
jZ
l
(
)
(
)
tan
tan
.
in
L
L
0
0
0
	
(3.48)
Example 3.1
A 2-m lossless air-spaced transmission line having a characteristic impedance of 
30 Ω is terminated with an impedance of 40 + j30[Ω] at an operating frequency of 
200 MHz. Find the input impedance.
Solution: The phase constant is found from
	
v
4
3 .
p
β = ω =
π
Since it is given that R
50
0 =
Ω, Z
j
40
30
L =
+
, and 
m
2
=
, we obtain the input 
impedance from Equation 3.48 as
	
Z
j
j
j
j
j
50
(40
30)
50 tan 4
3
2
50
(40
30) tan 4
3
2
26.3
9.87.
i =
+
+
⋅
π ⋅




+
+
⋅
π ⋅




=
−
z = 0
∆z = λ / 2
z
ΓL
1
1 +
1–
ΓL
FIGURE 3.6  Voltage versus transmission line length.

62
Linear and Switch-Mode RF Power Amplifiers
Example 3.2
For a transmission, it is given that Z
j
Z
17.4
30
and
50
L
0
[ ]
[ ]
=
−
Ω
=
Ω. Calculate 
, SWR
L
Γ
, z
V
V
,
,
min
max
min on the transmission line.
Solution: From given information, we find the load reflection coefficient as
	
Z
Z
j
Z
Z
0.24
0.55
0.6 e
.
j
L
L
0
L
0
1.99
Γ =
−
+
= −
−
=
(
)
−
Voltage standing wave ratio is found from
	
V
V
SWR
1
1
1 0.6
1 0.6
4.0.
max
min
L
L
=
=
+ Γ
−Γ
=
+
−
=
This leads to
	
V
/
1
1.6
max
L
= + Γ =
+
V
	
V
/
1
0.4.
min
L
= −Γ =
+
V
Hence, the maximum and minimum value of the voltage are obtained when
	
V
z
,
,...
V
z
,
..
when
2
0
2
when
2
3 , .
max
min
φ + β
=
−π
φ + β
= −π −π
So, the distance that will give the minimum value of the voltage is found from
	
z
2
(
1.99)
2(2 / )
0.092 .
min = −π −φ
β
= −π +
π λ
= −
λ
When the voltage waveform is plotted versus transmission line length, the results 
agree with the calculated results as shown in Figure 3.7a.
Example 3.3
SWR on a lossless 30 Ω terminated line terminated in an unknown load imped-
ance is 4. The distance between successive minimum is 30 cm, and the first mini-
mum is located at 6 cm from the load. Determine Γ, ZL, and lm.
Solution: From the given information, the wavelength can be found as
	
2
0.3
0.6m,
2
3.33 .
λ =
⇒λ =
β =
π
λ =
π
www.ebook3000.com

63
Impedance Matching and Resonant Networks
The reflection coefficient is equal to
	
z
z
4
1
4
1
0.6,
0.06 m
2
0.24 m
m
m
m

Γ =
−
+
=
′ =
⇒
= λ −
′ = =
	
z
j
2
0.6 ,
e
0.6e
0.185
0.95.
m
j
j0.6
θ = β ′ −π = −
π Γ = Γ
=
= −
−
Γ
θ
−
π
Γ
The load impedance is then equal to
	
Z
j
j
j
Z
1+
1
50 1
0.185
0.95
1
0.185
0.95
1.43
41.17.
L
0
L
L
(
)
(
)
=
Γ
−Γ =
⋅+ −
−
−−
−
=
−
Example 3.4
Calculate the following parameters for the transmission line shown in Figure 3.7b 
when a normalized load of 1.2 + j [Ω] is connected:
	
1.	The voltage standing wave ratio on the line
	
2.	Load reflection coefficient
	
3.	Admittance of the load
	
4.	Impedance at the input of the line
	
5.	The distance from the load to the first voltage minimum
	
6.	The distance from the load to the first voltage maximum
–0.592λ
λ / 4
–0.342λ
–0.092λ
Z
(a)
0.4
1
1.6
V+
V(z)
(b)
Zin
l = 0.4λ
Z0 = 50 [Ω]
ZL = 1.2 + j [Ω]
FIGURE 3.7  (a) Voltage versus transmission length, for example and (b) transmission line 
circuit.

64
Linear and Switch-Mode RF Power Amplifiers
Solution: Because the load impedance is already normalized, we can skip normal-
ization process and start the calculations as follows:
	
1.	SWR= 2.5
	
2.	
0.42 54.5
L

Γ =
∠
	
3.	Y
y
z
j
j
0.5
0.42
50
(10
8.4) mS
L
L
o
=
=
−
Ω
=
−
	
4.	Z
z
Z
j
Z
j
(0.5
0.4)
(25
0.4)
in
in
0
0
=
⋅
=
+
⋅
=
+
Ω 
	
5.	l
0.5
0.174
0.326
min =
λ −
λ =
λ
	
6.	l
0.25
0.174
0.076
max =
λ −
λ =
λ  
3.2.3  Special Cases of Terminated Transmission Lines
	
1.	Short-circuited line: Consider the short-circuited transmission line shown 
in Figure 3.8. When the transmission line is open-circuited, ZL = 0 → 
Γ = −1, then voltage and current can be written as
	
=
−

= −
β
+
−β
β
+
V z
V
jV
z
( )
e
e
2
sin
j z
j z
o
o
	
(3.49)
	
=
+

=
β
+
−β
β
+
I z
V
Z
V
Z
z
( )
e
e
2
cos
.
j z
j z
0
0
o
o
	
(3.50)
The input impedance when z = −l is the equal to
	
=
β
Z
jZ
l
tan
.
in
0
	
(3.51)
The impedance variation of the line along the z is given in Figure 3.9.
At lower frequencies, Equation 3.51 can be written as
	
(
)
( )
(
)
≈
β
=
ω
= ω
X
Z
l
L
C
LC l
Ll .
in
0
 	
(3.52)
+
ZL = 0
V(z) , I(z)
Z0 , β
z = 0
z = –l
–
VL = 0
–
IL
z
FIGURE 3.8  Short-circuited transmission line.
www.ebook3000.com

65
Impedance Matching and Resonant Networks
Then, the lumped element equivalent model of the transmission line can be repre-
sented as shown in Figure 3.10.
	
2.	Open-circuited line: Consider the open-circuited transmission line shown 
in Figure 3.11. When the transmission line is open-circuited, ZL = ∞ → 
Γ = 1, then voltage and current can be written as
	
=
+

=
β
+
−β
β
+
V z
V
V
z
( )
e
e
2
cos
j z
j z
o
o
	
(3.53)
	
=
−

= −
β
+
−β
β
+
I z
V
Z
jV
Z
z
( )
e
e
2
sin
.
j z
j z
0
0
o
o
	
(3.54)
The input impedance when z = −l is the equal to
	
= −
β
Z
jZ
l
cot
.
in
0
	
(3.55)
The impedance variation of the line along the z is given in Figure 3.12. 
At lower frequencies, Equation 3.51 can be written as
	
( )
(
)
≈−
β
= −
ω



=
−
ω
X
Z
l
L
C
LC l
Cl
/
1
1
.
in
0
	
(3.56)
Capacitive
Inductive
Xin
5π/2
3π/2
π/2
βl
FIGURE 3.9  Impedance variation for a short-circuited transmission line.
Ll
Cl
l
Zin
FIGURE 3.10  Low-frequency equivalent circuit of a short-circuited transmission line.

66
Linear and Switch-Mode RF Power Amplifiers
Then, the lumped element equivalent model of the transmission line can be repre-
sented as shown in Figure 3.13.
3.3  SMITH CHART
Smith chart is a conformal mapping between the normalized complex imped-
ance plane and the complex reflection coefficient plane. It is a graphical method 
+
Z0, β
–
VL
–
IL =  0
z
z = –l
V(z), I(z)
z = 0
ZL = ∞
FIGURE 3.11  Open-circuited transmission line.
Ll
Cl
l
Zin
FIGURE 3.13  Low-frequency equivalent circuit of an open-circuited transmission line.
Capacitive
Inductive
Xin
3π
2π
π
βl
FIGURE 3.12  Impedance variation for an open-circuited transmission line.
www.ebook3000.com

67
Impedance Matching and Resonant Networks
of displaying impedances and all related parameters using reflection coefficient. It 
was invented by Phillip Hagar Smith while he was working at Radio Corporation 
of America. The process of establishing Smith chart begins with normalizing the 
impedance as shown by Equation 3.57.
	
=
=
+
z
Z
Z
R
jX
Z
.
L
L
0
L
L
0
	
(3.57)
Consider now the right-hand portion of the normalized complex impedance plane as 
illustrated in Figure 3.14. All values of impedance such that R ≥ 0 are represented 
by points in the plane. The impedance of all passive devices will be represented by 
points in the right-half plane.
The complex reflection coefficient may be written as a magnitude and a phase or 
as real and imaginary parts.
	
Γ = Γ
= Γ
+ Γ
∠Γ
j
e
.
L
L
Lr
Li
L
	
(3.58)
The reflection coefficient in terms of the load ZL terminating line Z0 is defined as
	
Γ =
−
+
Z
Z
Z
Z .
L
L
0
L
0
	
(3.59)
We can rearrange Equation 3.59 to get
	
=
+ Γ
−Γ
Z
Z 1
1
.
L
0
L
L
	
(3.60)
In terms of normalized quantities, Equation 3.60 can be written as
	
=
+
=
=
+ Γ
−Γ
z
r
jx
Z
Z
1
1
.
L
L
L
L
0
L
L
	
(3.61)
xL
rL
A
B
C
1
1
FIGURE 3.14  Right-hand portion of the normalized complex impedance plane.

68
Linear and Switch-Mode RF Power Amplifiers
Substituting in the complex expression for ΓL and equating real and imaginary parts, 
we find the two equations, which represent circles in the complex reflection coef-
ficient plane as
	
(
)
Γ
−
+



+ Γ
−
=
+




r
r
r
1
0
1
1
Lr
L
L
2
Li
2
L
2
	
(3.62)
	
(
)
Γ
−
+ Γ
−



= 



x
x
1
1
1
.
Lr
2
Li
L
2
L
2
	
(3.63)
The first circle is centered at
	
+




r
r
1
,0
L
L
	
(3.64)
and the second circle is centered at
	




x
1, 1
.
L
	
(3.65)
The location of the first circle is always inside the unit circle in the complex reflec-
tion coefficient plane with corresponding radius as
	
+ r
1
1
.
L
	
(3.66)
Therefore, this circle will always be fully contained within the unit circle because 
the radius can never be greater than unity. This conformal mapping represents the 
mapping of the real resistance circle (shown in Figure 3.15) using the following map-
ping equation:
	
(
)
Γ −
+



+ Γ
=
+




r
r
r
1
1
1
.
r
2
L
2
2
	
(3.67)
The location of the second circle is always outside the unit circle in the complex 
reflection coefficient plane with the corresponding radius as
	




x
1
.
L
	
(3.68)
The value radius can vary between 0 and ∞. This conformal mapping represents the 
mapping of the imaginary reactance circle and is shown in Figure 3.16, using the 
following mapping equation:
www.ebook3000.com

69
Impedance Matching and Resonant Networks
	
(
)
Γ −
+ Γ −



= 



x
x
1
1
1
.
r
2
i
2
2
	
(3.69)
The circles centered on the real axis represent lines of constant real part of the load 
impedance (rL is constant, xL varies), and the circles whose centers reside outside 
the unit circle represent lines of constant imaginary part of the load impedance (xL 
is constant, rL varies). Combining the results of two mapping into a single mapping 
gives the display of complete Smith chart as shown in Figure 3.17.
Γr
r = 3
r = 1
r = 1/ 3
r = 0
1/ 2
0
–1/ 2
–1
+1
+1
–1
Γ-Plane
Z-Plane
x
0
1/ 3 1
3
Γi
FIGURE 3.15  Conformal mapping of constant resistances.
Γi
Γr
x = 3
x = 1
x =1/3
r
0
–1
+1
+1
x
0
1/3
1
3
x = –3
x = –1
x = –1/3
x = 0
–1/3
–1
–3
Γ-Plane
Z-Plane
–1
FIGURE 3.16  Conformal mapping of constant reactances.

70
Linear and Switch-Mode RF Power Amplifiers
In summary, the properties of the r-circles are as follows:
•	 The centers of all r-circles lie on the Γr-axis.
•	 The r = 0 circle, having a unity radius and centered at the origin, is the 
largest.
•	 The r-circles become progressively smaller as r increases from 0 toward ∞, 
ending at the (Γr = 1, Γi = 0) point for open circuit.
•	 All r-circles pass through the (Γr = 1, Γi = 0) point.
Similarly, the properties of the x-circles are as follows:
•	 The centers of all x-circles lie on the Γr = 1 line, those for x > 0 (inductive 
reactance) lie above the Γr-axis, and those for x < 0 (capacitive reactance) 
lie below the Γr-axis.
•	 The x = 0 circle becomes the Γr-axis.
•	 The x-circle becomes progressively smaller as |x| increases from 0 toward 
∞, ending at the (Γr = 1, Γi = 0) point for open circuit.
•	 All x-circles pass through the (Γr = 1, Γi = 0) point.
Hence, in the combined display of the Smith chart
•	 All |Γ| circles are centered at the origin, and their radii vary uniformly from 
0 to 1.
•	 The angle, measured from the positive real axis, of the line drawn from the 
origin through the point representing zL equals θΓ.
•	 The value of the r-circle passing through the intersection of the |Γ| circle 
and the positive real axis equals the SWR.
r
0
x
0
1/3
1
1
3
3
Γi
Γr
x = 3
r = 3
r = 1
x = 1
x = 1/3
r = 1/3
r = 0
–1
+1
+1
x = –3
x = –1
x = –1/3
x = 0
–1/3
1/3
–1
–3
Γ-Plane
Z-Plane
–1
FIGURE 3.17  Combined conformal mapping lead to the display of Smith chart.
www.ebook3000.com

71
Impedance Matching and Resonant Networks
Example 3.5
Locate the following normalized impedances on the Smith chart, and calculate 
standing wave ratios and reflection coefficients (1) z = 0.2 + j0.3, (2) z = 0.4 + j0.7, 
and (3) z = 0.6 + j0.1
Solution: The following generic MATLAB® code is developed to calculate mark 
impedance points, draw VSWR circles, and calculate reflection coefficients on the 
Smith chart at single frequency.
%This program marks impedance points, draws VSWR circle, 
calculates
%reflection coefficients, and marks them on the Smith Chart at 
single
%frequency
 
clear all;
close all;
global Z0;
Set_Z0(1); %Set Z0 to 1
 
%Gui Prompt
 prompt = {'ZL1', 'ZL2: ','ZL3'};
dlg_title = 'Enter Impedance ';
num_lines = 1;
def = {'0.2+j*0.3','0.4+j*0.7','0.6+j*0.1'};
answer = inputdlg(prompt,dlg_title,num_lines,def, 'on');
%convert the strings received from the GUI to numbers
valuearray=str2double(answer);
 
%Give variable names to the received numbers
ZL1=valuearray(1);
ZL2=valuearray(2);
ZL3=valuearray(3);
 
%part a
gamma1=(ZL1-Z0)/(ZL1+Z0);
VSWR1=(1+abs(gamma1))/(1-abs(gamma1));
[th1,rl1]=cart2pol(real(gamma1),imag(gamma1));
smith; %Call Smith Chart Program
s_point(ZL1);
const_SWR_circle(ZL1,'r--');
hold on;
text(real(gamma1)+0.04,imag(gamma1)-0.03,'\bf\Gamma_1');
%part b
gamma2=(ZL2-Z0)/(ZL2+Z0);
VSWR2=(1+abs(gamma2))/(1-abs(gamma2));
[th2,rl2]=cart2pol(real(gamma2),imag(gamma2));
s_point(ZL2);
 
%part c
gamma3=(ZL3-Z0)/(ZL3+Z0);
VSWR3=(1+abs(gamma3))/(1-abs(gamma3));
[th3,rl3]=cart2pol(real(gamma3),imag(gamma3));
s_point(ZL3);

72
Linear and Switch-Mode RF Power Amplifiers
const_SWR_circle(ZL3,'r--');
hold on;
text(real(gamma3)+0.04,imag(gamma3)-0.03,'\bf\Gamma_3');
 
msgbox( sprintf([...
        'Calculated Parameters for Z1 \n'...
        '   Reflection coefficient for Z1:  gamma1 =%f 
+j(%f)\n'...
        '   Reflection Coefficent for Z1 In Polar form 
:|gamma1|=%f,angle1=%f\n'...
        '   Standing Wave Ratio for Z1 : VSWR1=%f \n'...
        '\n'...
        'Calculated Parameters for Z2 \n'...
        '   Reflection coefficient for Z2:  gamma2 =%f 
+j(%f)\n'...
        '   Reflection Coefficient for Z2 In Polar form 
:|gamma2|=%f,angle1=%f\n'...
        '   Standing Wave Ratio for Z2 : VSWR2=%f \n'...
        '\n'...
        'Calculated Parameters for Z3 \n'...
        '   Reflection coefficient for Z3:  gamma3 =%f 
+j(%f)\n'...
        '   Reflection Coefficient for Z3 In Polar form 
:|gamma3|=%f,angle3=%f\n'...
        '   Standing Wave Ratio for Z3 : VSWR3=%f \n'...
             '\n']...   
,real(gamma1),imag(gamma1),rl1,th1*180/pi,VSWR1,real(gamma2),imag
(gamma2),rl2,th2*180/pi,VSWR2,real(gamma3),imag(gamma3),rl3
,th3*180/pi,VSWR3));
When the program is executed, the GUI is displayed as shown in Figure 3.18a for 
entering impedances and result.
The results are displayed on Smith chart in Figure 3.18b.
3.3.1  Input Impedance Determination with Smith Chart
It was shown earlier that the voltage and current at any point on the transmission line 
can be expressed as
	
(
)
′ =
+
+Γ


γ ′
−γ ′
V z
I
Z
Z
( )
2
e
1
e
z
z
L
L
0
2
	
(3.70)
	
(
)
′ =
+
−Γ


γ ′
−γ ′
I z
I
Z
Z
Z
( )
2
e
1
e
,
z
z
L
0
L
0
2
	
(3.71)
where z′ = l − z. Then, input impedance at a distance d away from the load on the line 
in terms of reflection coefficient can be obtained as
	
=
=
+Γ
−Γ
Z d
V d
I d
Z
d
d
( )
( )
( )
1
( )
1
( ),
0
	
(3.72)
where
	
Γ
= Γ
−
β
d
( )
e
.
j
d
L
2
	
(3.73)
www.ebook3000.com

73
Impedance Matching and Resonant Networks
Example 3.6
A transmission line of characteristic impedance Z0 = 30 Ω and length d = 0.2λ is 
terminated into a load impedance of ZL = (23 − j30)Ω. Find ΓL, Zin (d), and SWR 
using Smith chart.
Solution: The following generic MATLAB code is developed to find input imped-
ance by moving toward generator at any length:
%This program find input impedance by moving towards generator
%on the transmission line at single frequency at any length
(a)
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
(b)
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
Γ2
Γ3
Γ1
∞
FIGURE 3.18  (a) GUI display for user input and results and (b) Smith chart displaying the 
calculated values and impedances.

74
Linear and Switch-Mode RF Power Amplifiers
clear all;
close all;
global Z0;
%Gui Prompt
 
prompt = {'Ente Load Impedance ZL :', 'Enter the Length (in 
lambda) d : ','Enter Characteristic Impedance Z0:'};
dlg_title = 'Enter Impedance ';
num_lines = 1;
def = {'23-j*30','.2','30'};
answer = inputdlg(prompt,dlg_title,num_lines,def, 'on');
%convert the strings received from the GUI to numbers
valuearray=str2double(answer);
 
%Give variable names to the received numbers
ZL=valuearray(1);
d=valuearray(2);
Z0=valuearray(3);
 
Set_Z0(Z0);
gamma_0=(ZL-Z0)/(ZL+Z0);
[th0,mag_gamma_0]=cart2pol(real(gamma_0),imag(gamma_0));
if th0<0
    th0=th0+2*pi;
end
th_in=th0-2*2*pi*d;
if th_in<0
    th_in=th_in+2*pi;
end
  
[x_gamma_in,y_gamma_in]=pol2cart(th_in,mag_gamma_0);
Zin=Z0*(1+x_gamma_in+j*y_gamma_in)/(1-x_gamma_in-j*y_gamma_in);
SWR=(1+abs(gamma_0))/(1-abs(gamma_0));
smith_chart(0);
hold on;
th=th0:(th_in-th0)/29:th_in;
gamma=mag_gamma_0*ones(1,30);
polar(th,gamma,'k');
hold on
s_point(Zin);
text(x_gamma_in+0.04,y_gamma_in-0.03,'\bfZ_{in}');
s_point(ZL);
text(real(gamma_0)+0.04,imag(gamma_0)-0.03,'\bfZ_{L}');
 
msgbox( sprintf([...
        'Calculated Parameters for Transmission Line \n'...
        '   Load Reflection coefficient :  gamma_0 =%f 
+j(%f)\n'...
        '   Magnitude of Load Reflection Coefficient 
:|gamma_0|=%f,angle=%f\n'...
        '   Input Impedance Zin : Zin=%f +j(%f)\n'...
        '   Standing Wave Ratio : SWR=%f \n'...
        '\n']...
www.ebook3000.com

75
Impedance Matching and Resonant Networks
,real(gamma_0),imag(gamma_0),mag_gamma_0,th0*180/
pi,real(Zin),imag(Zin),SWR));
When the program is executed, the following GUI and calculated results are dis-
played. The program also displays input impedance on the Smith chart as shown in 
Figure 3.19b with the move toward the generator.
–1.0
(a)
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
+2.0
–2.0
+5.0
–5.0
0.0
Zin
(b)
ZL
∞
FIGURE 3.19  (a) MATLAB GUI display for user input and results and (b) input impedance 
display using Smith chart.

76
Linear and Switch-Mode RF Power Amplifiers
3.3.2  Smith Chart as an Admittance Chart
Smith chart can be also used as an admittance chart by transforming impedances to 
admittances. Consider the expression for a normalized impedance at any point on 
the transmission line in terms of reflection coefficient as
	
( )
( )
( )
=
+ Γ
−Γ




Z
z
z
z
1
1
.
in
	
(3.74)
The normalized admittance is the reciprocal of impedance and can be written as
	
( )
( )
( )
( )
( )
=
=
=
=
Y
z
Y
z
Y
Z
z
Z
Z
z
Z
Z
z
1/
1/
1
/
1
.
in
in
0
in
0
in
0
in
	
(3.75)
Then, the normalized admittance in terms of reflection coefficient can be expressed as
	
( )
( )
( )
=
−Γ
+ Γ




Y
z
z
z
1
1
,
in
	
(3.76)
which can be written as
	
( )
( )
( )
=
+
′
Γ
−
′
Γ




Y
z
z
z
1
1
,
in
	
(3.77)
where
	
( )
( )
( )
′
Γ
= −Γ
= Γ
−π
z
z
z e
.
j
	
(3.78)
That means a 180° phase shift for the reflection coefficient gives the value of admit-
tance for the corresponding impedance value. When the impedance point is marked 
on the Smith chart, moving 180° clockwise gives the value admittance. Instead of 
repeating this for each impedance point on the Smith chart, we can keep the location 
of the impedance fixed and rotate the Smith chart by 180°. This gives the admittance 
chart as shown in Figure 3.20. When both Z and Y chart are plotted together, we 
obtain ZY chart as shown in Figure 3.21. 
3.3.3  ZY Smith Chart and Its Application
ZY Smith chart gives the ability to implement both impedances and admittances on 
a single chart. It is a powerful chart, and it helps the designer to make impedance 
transformation and matching using a unique graphical display when components 
are connected in series or in shunt. The effect of adding single reactive component 
in series with a complex impedance results in motion along a constant resistance 
circle in ZY chart. If a single reactive component is added with a complex impedance 
www.ebook3000.com

77
Impedance Matching and Resonant Networks
FIGURE 3.21  ZY Smith chart.
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
∞
FIGURE 3.20  Admittance, Y, Smith chart.

78
Linear and Switch-Mode RF Power Amplifiers
in shunt, then motion along a constant conductance circle in ZY chart is needed. 
Whenever an inductor is connected to the network, the direction of movement on ZY 
chart is towards the upper half, whereas a capacitive involvement results in a move-
ment towards the lower part of the chart. All these component motions on ZY chart 
are illustrated in Figure 3.22.
Example 3.7
Using the Smith chart, find the input impedance for the circuit shown in Figure 3.23 
at 4 GHz when the load connected is ZL = 62.3 Ω.
Solution: The process begins with normalizing the load impedance, ZL = R = 62.3 Ω:
	
z
Z
Z
62.5
50
1.25.
L
L
0
=
=
=
Because the next component is a shunt-connected component, we need to con-
vert this value to a conductance value. That is
Shunt L
Shunt C
Series C
Series L
FIGURE 3.22  Adding component using ZY Smith chart.
www.ebook3000.com

79
Impedance Matching and Resonant Networks
	
g
z
1
1
1.25
0.8.
L
L
=
=
=
On ZY Smith chart, we mark this point on the conductance circle. The next com-
ponent is shunt C with a value of 1.39 [pF]. The normalized susceptance value of 
the capacitor at 4 GHz is found from
	
b
B Z
CZ
2 4
10
1.59
10
50
2.
C
C
0
0
9
12
(
)(
)
=
= ω
=
π ×
×
=
−
This corresponds to point B on Smith chart. This is the amount of rotation that 
needs to be done on the conductance circle as shown by point B. The admittance 
at point B is equal to
	
y
j
0.8
2.
B =
+
The next component connected is a series L with a value of 8 [nH]. So, we move 
from conductance circle to resistance circle and read the corresponding imped-
ance value as
	
z
j
0.17
0.43.
B =
−
The normalized reactance value of inductor is equal to
	
x
X
Z
2 4
10
8
10
50
4.
L
L
0
9
9
(
)(
)
=
=
π ×
×
=
−
This value needs to be added to the impedance at Point B to find the impedance 
value shown as Point C on Smith chart.
	
z
z
x
j
0.17
0.43 + 4 = 0.17 + 3.57.
C
B
L
=
+
=
−
Denormalizing impedance zC gives the input impedance as
	
Z
z Z
j
j
0.17+ 3.57 50
8.5
178.5
.
in
C
0
(
)
(
)[ ]
=
=
=
+
Ω
The results are shown on Smith chart in Figure 3.24.
Zin
C = 1.59 [pF]
R = 62.5 [Ω]
L = 8 [nH]
FIGURE 3.23  Impedance transformation.

80
Linear and Switch-Mode RF Power Amplifiers
3.4  IMPEDANCE MATCHING BETWEEN TRANSMISSION 
LINES AND LOAD IMPEDANCES
Consider the matching network between load and transmission line shown in 
Figure 3.25. We can implement the matching network using the lumped element 
L-type sections consisting of two reactive elements. There are eight possible L 
matching networks that are shown in Figure 3.26. These can be illustrated by generic 
two circuits as shown in Figure 3.27. 
In both the configurations of Figure 3.27, the reactive elements may be either 
inductors or capacitors. As a result, there are eight distinct possibilities as shown 
in Figure 3.26 for the matching circuit for various load impedances. If the normal-
ized load impedance, zL = ZL/Z0, is inside the 1 + jx circle on the Smith chart, then 
the circuit of Figure 3.27a should be used. If the normalized load impedance is 
outside the 1 + jx circle on the Smith chart, the circuit of Figure 3.27b should be 
used. The 1 + jx circle is the resistance circle on the impedance Smith chart for 
which r = 1.
Consider first the circuit given in Figure 3.27a with ZL = RL + jXL. It is assumed 
that RL > Z0 and zL = ZL/Z0 maps inside the 1 + jx circle on the Smith chart. For a 
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
A
B
C
Zin C = 1.59 [pF]
R = 62.5 [Ω]
L = 8 [nH]
∞
FIGURE 3.24  Impedance transformation using Smith chart.
ZL
Z0
Matching
network
FIGURE 3.25  Matching network between load and transmission line.
www.ebook3000.com

81
Impedance Matching and Resonant Networks
Cs
Cs
Cs
Cs
Cp
ZL
ZL
ZL
ZL
ZL
ZL
ZL
ZL
Lp
Lp
Lp
Lp
Cp
Cp
Cp
(a)
(c)
(e)
(g)
(h)
(f)
(d)
Ls
Ls
Ls
Ls
(b)
FIGURE 3.26  Eight possible L matching network sections.
jX
(a)
(b)
Z0
Z0
jB
ZL
jB
jX
ZL
FIGURE 3.27  Generic L matching network sections to represent eight L sections.

82
Linear and Switch-Mode RF Power Amplifiers
matched condition, the impedance seen looking into the matching network followed 
by the load impedance is then equal to Z0 and can be written as
	
=
+
+
+




Z
jX
jB
R
jX
1
1
.
0
L
L
	
(3.79)
Separating Equation 3.79 into real and imaginary parts gives two equations with two 
unknowns, X and B, as
	
(
)
−
=
−
B XR
X Z
R
Z
L
L
0
L
0	
(3.80)
	
(
)
−
=
−
X
BX
BZ R
X
1
.
L
0
L
L 	
(3.81)
Solution of Equations 3.80 and 3.81 lead to
	
=
±
+
−
+
B
X
R
Z
R
X
Z R
R
X
L
L
0
L
2
L
2
0
L
L
2
L
2
	
(3.82)
and
	
=
+
−
X
B
X Z
R
Z
BR
1
.
L
0
L
0
L
	
(3.83)
From Equation 3.82, there exist two possibilities for B and consequently for X. Both 
of these solutions are physically realizable, and constitute all the values of B and X. 
Positive value of X gives an inductor, negative value of X gives a capacitor. Similarly, 
positive value of B gives a capacitor and negative value of B gives an inductor.
We can repeat the same procedure for the generic L matching network shown 
in Figure 3.27b. This circuit is used when zL = ZL/Z0 and it maps outside the 1 + jx 
circle on the Smith chart since it is assumed that RL < Z0. For a matched condition, 
the admittance seen looking into the matching network followed by the load imped-
ance ZL = RL + jXL is then equal to 1/Z0 and can be written as
	
=
+
+
+
Z
jB
R
j X
X
1
1
(
).
0
L
L
	
(3.84)
Separating Equation 3.84 into real and imaginary parts gives the following two 
equations with two unknowns, X and B, as
	
(
)
+
=
−
BZ
X
X
Z
R
0
L
0
L	
(3.85)
	
(
)
+
=
X
X
BZ R .
L
0
L 	
(3.86)
www.ebook3000.com

83
Impedance Matching and Resonant Networks
Solution of Equations 3.85 and 3.86 lead to
	
=
−
−
X
R
Z
R
X
(
)
L
0
L
L 	
(3.87)
	
(
)
= ±
−
B
Z
R
R
Z
/
.
0
L
L
0
	
(3.88)
Equation 3.88 has two possible solutions for B.
In order to match an arbitrary complex load to a line of characteristic imped-
ance Z0, the real part of the input impedance to the matching network must be Z0, 
whereas the imaginary part must be zero. This implies that a general matching 
network must have at least two degrees of freedom; in the L section matching cir-
cuit, these two degrees of freedom are provided by the values of the two reactive 
components.
3.5  SINGLE STUB TUNING
At high frequencies, it may be desirable to match the given load to the transmission 
line using transmission lines instead of lumped-element components discussed in 
the previous section. Impedance matching can then be done using a single open-
circuited or short-circuited length of transmission line called “stub.” It is connected 
either in parallel or in series with the transmission feed line at a certain distance 
from the load as shown in Figure 3.28.
In single-stub tuning, there are two design parameters: the distance, d, from the 
load to the stub position, and the value of susceptance or reactance provided by the 
shunt or series stub.
Y0
Y0
YL
Y = 1
Z
1
Y
d
(a)
l
Open or
shorted
stub
Z0
ZL
Z0
Z =
(b)
d
l
Open or
shorted
stub
FIGURE 3.28  Single stub matching (a) parallel (b) series.

84
Linear and Switch-Mode RF Power Amplifiers
3.5.1  Shunt Single Stub Tuning
When it is a shunt-stub case as shown in Figure 3.28a, we select d so that the admit-
tance, Y, seen looking into the line at distance, d, from the load is equal to Y0 +  jB. 
Then, the matching is done by choosing the stub susceptance as −jB.
To obtain the relations for d and l, we write the input impedance, ZL = 1/YL = RL + 
jXL at a distance d from the load as
	
=
+
+
β
+
+
β
Z
Z
R
jX
jZ
d
Z
j R
jX
d
(
)
tan
(
)tan
.
0
L
L
0
0
L
L
	
(3.89)
We then write the admittance from Equation 3.89 as
	
=
+
=
Y
G
jB
Z
1 , 	
(3.90)
where
	
=
+
β
+
+
β
G
R
d
R
X
Z
d
 
(1 tan
)
(
tan
)
L
2
L
2
L
0
2 	
(3.91)
	
=
β −
−
β
+
β
+
+
β
B
R
d
Z
X
d X
Z
d
Z
R
X
Z
d
tan
(
tan
)(
tan
)
[
(
tan
) ]
.
L
2
0
L
L
0
0
L
2
L
0
2
	
(3.92)
To have the matching condition, we need to set G in Equation 3.91 to G = Y0 = 1/Z0. 
Hence,
	
−
β −
β +
−
−
=
Z
R
Z
d
X Z
d
R Z
R
X
(
)tan
2
tan
(
)
0,
0
L
0
2
L
0
L
0
L
2
L
2
	
(3.93)
which lead to two solutions for tan βd as
	
β =
±
−
+
−
≠
d
X
R
Z
R
X
Z
R
Z
R
Z
tan
[(
)
]/
,  for  
.
L
L
0
L
2
L
2
0
L
0
L
0 	
(3.94)
If RL = Z0, then tanβd = −XL/2Z0. As a result, we have solutions for d as
	
λ =
π
−




−
≥
π π +
−








−
<







−
−
d
X
Z
X
Z
X
Z
X
Z
1
2
tan
2
  
for 
2
0
1
2
tan
2
for 
2
0
 .
1
L
0
L
0
1
L
0
L
0
	
(3.95)
To find the required stub lengths, we first set Bs = −B. This leads to the final solutions 
for open and shorted stubs shown in Figure 3.28a as
www.ebook3000.com

85
Impedance Matching and Resonant Networks
	
λ =
π



= −π




−
−
l
B
Y
B
Y
1
2
tan
1
2
tan
for open stub
1
s
0
1
0
	
(3.96)
	
λ = −π



=
π




−
−
l
Y
B
Y
B
1
2
tan
1
2
tan
for shorted stub.
1
0
s
1
0
	
(3.97)
Smith chart solution for the matching with open stub is practical and can be described 
as follows:
•	 Normalize the load impedance, and locate corresponding admittance on 
the Z smith chart.
•	 Rotate clockwise around the Smith chart from yL until it intersects the g = 1 
circle. It intersects g = 1 circle at two points. The “length” of this rotation 
determines the value d. There are two possible solutions.
•	 Rotate clockwise from the short/open circuit point around the g = 0 circle, 
until stub b equals −b. The “length” of this rotation determines the stub 
length l.
3.5.2  Series Single Stub Tuning
For the series stub case shown in Figure 3.28b, d is chosen so that the impedance 
looking into the line at a distance d from the load is equal to Z0 + jX. Then, we select 
the stub reactance is to be −j X to match the line.
To obtain the relations for d and l, we write the input impedance and the input 
admittance, YL = 1/ZL = GL + jBL, at a distance d from the load as
	
=
+
+
β
+
+
β
Y
Y
G
jB
jY
d
Y
j G
jB
d
(
)
tan
(
)tan
.
0
L
L
0
0
L
L
	
 (3.98)
We then write the impedance from Equation 3.98 as
	
=
+
=
Z
R
jX
Y
1 , 	
(3.99)
where
	
=
+
β
+
+
β
R
G
d
G
B
Y
d
(1 tan
)
(
tan
)
L
2
L
2
L
0
2 	
(3.100)
	
=
β −
−
β
+
β
+
+
β
X
G
d
Y
B
d B
Y
d
Y G
B
Y
d
tan
(
tan
)(
tan
)
[
(
tan
) ]
.
L
2
0
L
L
0
0
L
2
L
0
2
	
(3.101)
To have the matching condition, we need to set G in Equation 3.100 to R = Z0 =1/Y0. 
Therefore,
	
−
β −
β +
−
−
=
Y G
Y
d
B Y
d
G Y
G
B
(
)tan
2
tan
(
)
0,
0
L
0
2
L
0
L
0
L
2
L
2
	
(3.102)

86
Linear and Switch-Mode RF Power Amplifiers
which leads to two solutions for tanβd as
	
β =
±
−
+
−
≠
d
B
G
Y
G
B
Y
G
Y
G
Y
tan
[(
)
]/
,  for  
.
L
L
0
L
2
L
2
0
L
0
L
0 	
(3.103)
If GL = Y0, then tanβd = −BL /2Y0. As a result, we have solutions for d as
	
λ =
π
−




−
≥
π π +
−








−
<







−
−
d
B
Y
B
Y
B
Y
B
Y
1
2
tan
2
  
for 
2
0
1
2
tan
2
for 
2
0
 .
1
L
0
L
0
1
L
0
L
0
	
(3.104)
To find the required stub lengths, we first set Xs = −X. This leads to the final solutions 
for open and shorted stubs shown in Figure 3.28b as
	
λ =
π



= −π




−
−
l
X
Z
X
Z
1
2
tan
1
2
tan
1
S
0
1
0
	
(3.105)
	
λ = −π



=
π




−
−
l
Z
X
Z
X
1
2
tan
1
2
tan
.
1
0
S
1
0
	
(3.106)
Smith chart solution for the matching with series stub is practical and can be 
described as follows:
•	 Normalize load impedance, and locate it on the Z Smith chart.
•	 Rotate clockwise around the Smith chart from zL until it intersects the r = 1 
circle. It intersects r = 1 circle at two points. The “length” of this rotation 
determines the value d. There are two possible solutions.
•	 Rotate clockwise from the short/open circuit point around the r = 0 circle, until 
stub x equals −x. The “length” of this rotation determines the stub length l.
3.6  IMPEDANCE TRANSFORMATION AND MATCHING 
BETWEEN SOURCE AND LOAD IMPEDANCES
Consider the matching network between source and load as shown in Figure 3.29. 
As discussed in Section 3.4, there are eight possible matching networks as shown 
in Figure 3.26, which can be represented by generic two L-type matching networks 
as shown in Figure 3.30. We will first derive the analytical equations as we did in 
the previous section. This time, consider first the generic L-type matching network 
shown in Figure 3.30b. 
Because source is matched to load impedance, complex conjugate impedance of 
the load should be equal to the overall impedance connected to the load impedance. 
This can be expressed by
www.ebook3000.com

87
Impedance Matching and Resonant Networks
	
=
+
+
∗
−
Z
Z
jB
jX
1
L
s
1
	
(3.107)
Express
	
=
+
=
+
Z
R
jX
Z
R
jX
   and     
  
s
s
s
L
L
L
	
(3.108)
Then,
	
(
)
=
+
+
=
+
+
+
+
=
−
∗
−
Z
Z
jB
jX
R
jX
jB R
jX
jX
R
jX
1
1
.
Load
s
1
s
s
s
s
L
L 	
(3.109)
Separate real and imaginary parts
	
(
) (
)
=
−
+
+
R
R
BX
X
X BR
1
s
L
s
L
s 	
(3.110)
	
(
)(
)
=
−
−
+
X
R R B
B X
X
X
1
.
s
s
L
C
L
L
	
(3.111)
Zs
Matching
network
ZL
FIGURE 3.29  Matching network between load and transmission line.
jX
jB
ZL
ZL
jX
jB
ZS
ZS
Matching
network
Matching
network
(a)
(b)
FIGURE 3.30  Generic two L matching networks between source and load impedances.

88
Linear and Switch-Mode RF Power Amplifiers
Solving for B and X gives
	
(
)
= −
±
−
+
X
X
R
R
R
R
R X
L
L
s
L
L
s
s
2 	
 (3.112a)
	
=
−
+
−
B
R
R
R X
R X
R X .
s
L
s
s
L
L
s
	
 (3.112b)
Solution given by Equation 3.112 is valid only when Rs > RL. Similar procedure can 
be applied for the circuit shown in Figure 3.30a. We obtain the following equations 
for reactance and susceptance by assuming Rs < RL:
	
(
)
(
)
=
±
+
−
+
B
R X
R R
R
X
R R
R R
X
L
s
L
s
L
L
2
2
s
L
s
L
2
L
2
	
(3.113a)
	
(
)
(
)
=
+
−
+
+
−
+
X
R
X
B
X
X
R R
R
X
B
X B
2
1
.
L
2
L
2
L
s
s
L
L
2
L
2
2
L
	
(3.113b)
As it is seen, the analytical calculation of the impedance transformation and match-
ing is tedious. Instead, we can use Smith chart for the same task. For this, there is 
a standard procedure that needs to be followed. The design procedure for match-
ing source impedance to a load impedance using Smith chart instead of analytical 
method can be outlined as follows:
•	 Normalize the given source and complex conjugate load impedances and 
locate them on the Smith chart.
•	 Plot constant resistance and conductance circles for the impedances located.
•	 Identify the intersection points between the constant resistance and conduc-
tance circle for impedances located.
•	 The number of the intersection point corresponds to the number of possible 
L matching networks.
•	 By following the paths that go through intersection points, calculate nor-
malized reactances and susceptances.
•	 Calculate the actual values of the inductors and capacitors by denormal-
izing at the given frequency.
Example 3.8
Using Smith chart, design all possible configurations of two-element match-
ing networks that match source impedance Zs = (13 + j30)Ω to the load ZL = 
(20 − j30) Ω. Assume characteristic impedance of Z0 = 30 Ω and an operating fre-
quency of f = 4 GHz.
www.ebook3000.com

89
Impedance Matching and Resonant Networks
Solution: MATLAB program developed previously is modified to plot resistance 
and conductance circles for then source and complex conjugate of the load 
impedances. As shown in Figure 3.31, there are four possible L matching net-
works. These networks are illustrated in Figure 3.32. 
3.7  RESONATOR NETWORKS
Resonators have frequency characteristics that give them the ability to present spe-
cific impedance, quality factor, and bandwidth. They can eliminate the reactive 
component effects and introduce only resistive portion of the impedance at a fre-
quency called resonance frequency. A circuit that is capable of producing these 
effects is called a resonant circuit. An ideal resonant circuit acts like a filter and 
eliminates the unwanted signal content out of the frequency of interest as shown in 
Figure 3.33. Resonant circuits can also be used as part of the impedance matching 
networks to transform one impedance at one point to another impedance. In RF 
amplifier circuits, it is a commonly used technique to present a matched impedance 
at one frequency and introduce high impedance levels at others. When the amplifier 
is matched at the input and output for maximum gain, it is possible to deliver the 
A
B
C
D
Zloonj
Zn
FIGURE 3.31  Number of possible L matching networks to match source and load 
impedance.

90
Linear and Switch-Mode RF Power Amplifiers
highest amount of power by keeping the circuit stable. The stability of the circuit is 
mostly accomplished by using filters and resonators to eliminate the spurious con-
tents and oscillations.
In this chapter, resonant networks, transmission lines, Smith chart, and imped-
ance matching networks are discussed.
3.7.1  Parallel and Series Resonant Networks
3.7.1.1  Parallel Resonance
Consider the parallel resonant circuit given in Figure 3.34. The response of the cir-
cuit can be obtained by finding the voltage with an application of KCL. Application 
of KCL gives the first-order differential equation for voltage v as
ZL
C1
ZS
Network A
C2
ZL
C1
ZS
Network B
C2
ZL
ZS
L1
Network C
L2
ZL
C1
ZS
Network D
L2
FIGURE 3.32  Possible L matching networks to match source and load impedance.
Attenuation [dB]
Frequency of
Interest
f1
f2
Frequency
0
–∞
–∞
FIGURE 3.33  Ideal resonant network response.
www.ebook3000.com

91
Impedance Matching and Resonant Networks
	
∫
+
τ +
+
=
v
R
L
vd
I
C v
t
1
d
d
0,
t
0
o
	
(3.114)
where Io is the initial charged current on inductor. Equation 3.114 can be written as
	
+
+
=
v
t
RC
v
t
v
LC
d
d
1 d
d
0.
2
2
	
(3.115)
The solution for the voltage in Equation 3.115 will be in the following form:
	
=
v
Ae ,
st 	
(3.116)
where A is constant and s = jω. Substituting Equation 3.116 into 3.115 gives
	
+
+



=
Ae
s
s
RC
LC
1
0,
st
2
	
(3.117)
which can be simplified to
	
+
+
=
s
s
RC
LC
1
0.
2
	
(3.118)
Equation 3.118 is called as the characteristic equation. The roots of the equation are
	
= −
+ 


−



s
RC
RC
LC
1
2
1
2
1
1
2
	
(3.119)
	
= −
−



−



s
RC
RC
LC
1
2
1
2
1
.
2
2
	
(3.120)
L
C
R
+
v
Zeq
iR
iC
iL, I0
FIGURE 3.34  Parallel resonant circuit.

92
Linear and Switch-Mode RF Power Amplifiers
The complete solution for the voltage v is then obtained as
	
=
+
=
+
v
v
v
A
A
e
e
.
s t
s t
1
2
1
2
1
2 	
(3.121)
We can express the roots given by Equations 3.119 and 3.120 as
	
= −α +
α −ω
s1
2
0
2 	
(3.122)
	
= −α −
α −ω
s
.
2
2
0
2 	
(3.123)
In Equations 3.122 and 3.123, α is the damping coefficient, and ω0 is the resonant 
frequency. At resonant frequency, the reactive components cancel each other. The 
damping coefficient and resonant frequency are given by the following equations:
	
α =
RC
1
2
	
(3.124)
and
	
ω =
LC
1
.
0
	
(3.125)
When
	
ω < α
ω > α
ω = α
s
s
s
s
s
s
,  
and  
   are real and distinct, voltage is overdamped
,  
and  
   are compelx, voltage is underdamped
,  
and  
   real and equal, voltage is critically damped
0
2
2
1
2
0
2
2
1
2
0
2
2
1
2
	
(3.126)
The time domain representation of a parallel resonant network voltage response to 
illustrate underdamped and overdamped cases are illustrated in Figure 3.35a and b, 
respectively. L and C values are taken to be 0.1 H and 0.001 F, respectively, for an 
underdamped case, whereas for an overdamped case, L and C values are taken to 
be 50 mH and 0.2 μF, respectively. R values are varied to see its effect on voltage 
response for damping. 
The quality factor and the bandwidth of the parallel resonant network are
	
= ω
= ω
Q
R
L
RC
0
0
	
(3.127)
	
= ω =
Q
RC
BW
1 .
0
	
(3.128)
www.ebook3000.com

93
Impedance Matching and Resonant Networks
0
20
40
60
80
100
120
–10
–5
0
5
10
15
t [ms]
vn(t) [V]
vn(t) [V]
Natural response of an underdamped parallel RLC circuit
R = 10
R = 20
R = 50
R = 100
(a)
0
0.5
1
1.5
0
20
40
60
80
100
120
(b)
t [ms]
Natural response of an overdamped parallel RLC circuit
R = 240
R = 200
R = 10
R = 50
FIGURE 3.35  (a) Parallel resonant network response for underdamped case and (b) Parallel 
resonant network response for overdamped case.

94
Linear and Switch-Mode RF Power Amplifiers
In terms of quality factor, the roots given by Equations 3.122 and 3.123 can be 
expressed as
	
= ω
−
+



−








s
Q
Q
1
2
1
2
1
1
0
2
	
(3.129)
	
= ω
−
−



−








s
Q
Q
1
2
1
2
1 .
2
0
2
	
(3.130)
Assume now there is a source current connected to parallel resonant network in 
Figure 3.34 as illustrated in Figure 3.36.
The equivalent impedance of the parallel resonant network is found from 
Figure 3.36 as
	
(
) (
)
(
)(
)
=
=
+
+
=
−
+
Z
s
V s
I s
s C
s
s
RC
LC
s C
s
s
s
s
( )
( )
( )
/
1/
1/
/
,
eq
0
s
2
1
2
	
(3.131a)
which can be written as
	
(
)
ω =
+
ω
−ω
Z
j
R
j
L
LC
(
)
1
1
.
eq
2
	
(3.131b)
In Equation 3.131, s1 and s2 are now the poles of the impedance. When
	



≥



≤
ω



=
ω




RC
LC
R
L
C
1
2
1
or
2
1
2
2
0
0
	
(3.132)
poles of the impedance lie on the negative real axis. Hence, the value of R is small 
when compared to the values of the reactances, and as a result, the resonant network 
has a broadband response. When
	



< 



>
ω




RC
LC
R
L
1
2
1
or
2
,
2
0
	
(3.133)
L
C
R
+
vo
Zeq
iR
iC
iL
is
FIGURE 3.36  Parallel resonant circuit with source current.
www.ebook3000.com

95
Impedance Matching and Resonant Networks
poles become complex, and they take the following form:
	
= −α+
ω −α = −α+ β
s
j
j
1
o
2
2
	
(3.134)
	
= −α −
ω −α = −α −β
s
j
j .
2
o
2
2
	
(3.135)
This can be illustrated on the pole-zero diagram as shown in Figure 3.37.
The transfer function for the parallel resonant network is found using Figure 3.34 as
	
(
)
(
)
ω =
=
ω
−ω
+ ω
H
I
I
L R
LC
L R
( )
(
/
)
1
/
.
R
S
2
2
2 	
(3.136)
At the resonant frequency, the transfer function will be real and be equal to its maxi-
mum value as
	
(
)
(
)
ω = ω
=
ω
−ω
+ ω
= =
ω
H
L R
LC
L R
H
(
)
(
/
)
1
/
1
( )
.
0
0
0
2
2
0
2
max 	
(3.137)
The network response is obtained using transfer function given by Equation 3.137 
for different values of R as shown in Figure 3.38. The values of the inductance and 
capacitance are taken to be 1.25 μH and 400 nF, respectively.
This gives the resonant frequency as 0.22508 MHz. The condition for a broad-
band network is accomplished when R = 5 as shown in Figure 3.38. As R increases, 
the quality factor of the network increases, which agrees with the Equation 3.127.
Quality factor, Q, is an important parameter in resonant network response 
because it can be used as a measure for the loss and bandwidth of the circuit. 
ω0
s1
s2 = s1
*
jω
α
β
σ
FIGURE 3.37  Pole-zero diagram for complex conjugate roots.

96
Linear and Switch-Mode RF Power Amplifiers
The quality factor of the circuit defines the ratio of the peak energy stored to the 
energy dissipated per cycle is given by
	
(
)
(
)
=
π
=
π



π ω
= ω
Q
CV
V
R
CR
2
(Peak energy stored)
(Energy dissipated per cycle stored)
2
1
2
2 /
/2
.
2
0
2
0
	
(3.138)
Example 3.9
A parallel resonant circuit with a source resistance of 50 Ω and a load resistance 
of 25 Ω. The loaded Q must be equal to 12 at the resonant frequency of 60 MHz.
	
1.	Design the resonant circuit.
	
2.	Calculate the 3dB bandwidth of the resonant circuit.
	
3.	Use MATLAB to obtain the frequency response of this circuit versus fre-
quency, i.e., plot 20log(Vo/Vin) versus frequency.
Solution:
	
1.	The effective parallel resistance across parallel resonance circuit is
	
(
)
=
+
=
Ω
R
50 25
50
25
16.67[ ].
p
Then,
	
=
=
=
X
R
Q
16.67
12
1.4.
p
p
0
1
2
3
4
5
6
7
× 105
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
f [Hz]
|
|
 Parallel resonant RLC circuit characteristics
H(w)
R= 5
R= 20
R= 50
R= 300
FIGURE 3.38  Parallel resonant circuit transfer function characteristics.
www.ebook3000.com

97
Impedance Matching and Resonant Networks
Since,
	
= ω = ω
X
L
C
1
p
then, the resonance element values are
	
(
)
= ω =
π
×
=
L
X
1.4
2
60
10
3.71[nH]
p
6
and
	
(
)(
)
= ω
=
π
×
=
C
X
1
1
2
60
10
1.4
1894.7 [pF].
p
6
	
2.	The BW is found from
	
=
→
=
=
×
=
×
Q
f
BW
BW
f
Q
60
10
12
5
10 [Hz].
c
c
3dB
3dB
6
6
	
3.	The MATLAB script to obtain the attenuation profile is given below.
	
clear
	
f = linspace(1,100*10^6);
	
RL = 25;
	
RS = 50;
	
RP = 50*25/(50+25);
	
Q = 12;
	
XP = RP/Q;
 
	
fc = 60*10^6;
	
wc = 2*pi()*fc;
	
L = XP/(wc);
	
C = 1/(wc*XP);
 
	
w = 2*pi.*f;
	
XL=1j.*w.*L;
	
XC=-1j./(w.*C);
	
Xeq=(XL.*XC)./(XL+XC);
	
Zeq=(RL.*Xeq)./(RL+Xeq);
	
S21=20.*log10(abs(Zeq./(Zeq+RS)));
  
	
plot(f,S21);
 
	
grid on
	
title('Attenuation Profile')
	
xlabel('Frequency (Hz)')
	
ylabel('Attenuation (dB)')
The plot of the attenuation profile is given in Figure 3.39.
3.7.1.2  Series Resonance
Consider the series resonant circuit given in Figure 3.40. The response of the circuit 
can be obtained by application of KVL, which gives the first-order differential equa-
tion for current i as

98
Linear and Switch-Mode RF Power Amplifiers
	
∫
+
+
τ +
=
Ri
L i
t
C
i
V
d
d
1
d
0,
t
0
o
	
(3.139)
where Vo is the initial charged voltage on capacitor. Equation 3.139 can be written as
	
+
+
=
i
t
R
L
i
t
i
LC
d
d
d
d
0.
2
2
	
(3.140)
Following the same solution technique for parallel resonant network leads to the 
following equation in frequency domain:
0
1
2
3
4
5
6
7
8
9
10
× 107
–200
–180
–160
–140
–120
–100
–80
–60
–40
–20
0
Attenuation proﬁle
Frequency [Hz]
Attenuation [dB]
FIGURE 3.39  Attenuation profile versus frequency.
L
C
R
+
Vo
i
FIGURE 3.40  Series resonant network.
www.ebook3000.com

99
Impedance Matching and Resonant Networks
	
+
+
=
s
R
L s
LC
1
0.
2
	
(3.141)
The roots of the equation are
	
= −
+ 


−



s
R
L
R
L
LC
2
2
1
1
2
	
(3.142)
	
= −
−



−



s
R
L
R
L
LC
2
2
1
.
1
2
	
(3.143)
Equations 3.142 and 3.143 can be written as
	
= −α+
α −ω
s1
2
o
2 	
(3.144)
	
= −α −
α −ω
s
,
2
2
o
2 	
(3.145)
where α and ω are defined for series resonant network as
	
α = R
L
2
	
(3.146)
and
	
ω =
LC
1
.
0
	
(3.147)
The quality factor and the bandwidth of the series resonant network are
	
= ω
= ω
Q
L
R
RC
1
0
0
	
(3.148)
	
= ω =
BW
Q
R
L .
0
	
(3.149)
In terms of quality factor, the roots given by Equations 3.142 and 3.143 can be 
obtained as
	
= ω
−
+



−








s
Q
Q
1
2
1
2
1
1
0
2
	
(3.150)
	
= ω
−
−



−








s
Q
Q
1
2
1
2
1 .
2
0
2
	
(3.151)

100
Linear and Switch-Mode RF Power Amplifiers
Equations 3.150 and 3.151 are identical to the ones obtained for parallel resonant 
circuit. The damping characteristics of the series resonant network follow the condi-
tions listed by Equation 3.126. The time domain representation of a series resonant 
network current response illustrating underdamped and overdamped cases are illus-
trated in Figures 3.41 and 3.42, respectively. L and C values are taken to be 100 mH 
and 10 μF for an underdamped case, whereas for overdamped case, L and C values 
are taken to be 200 mH and 10 μF. R values are varied to see its effect on current 
response for damping.
The transfer function of this network can be found by connecting a source voltage 
as shown in Figure 3.43 and is obtained as
	
(
)
(
)
ω =
=
ω
−ω
+ ω
H j
V s
V s
(
)
( )
( )
.
R
L
LC
R
L
o
s
1
2 2
2 	
(3.152)
The phase of the transfer function is found from 
	
θ ω =
−
ω
−ω






−
j(
)
90
tan
R
L
LC
1
1
2

	
(3.153)
At resonant frequency, the transfer function is maximum and will be equal to
0
1
2
3
4
5
6
7
8
9
10
–0.01
–0.008
–0.006
–0.004
–0.002
0
0.002
0.004
0.006
0.008
0.01
t [ms]
Natural response of an overdamped series RLC circuit
R = 25
R = 50
R = 75
R = 100
in(t) [A]
FIGURE 3.41  Series resonant network response for underdamped case.
www.ebook3000.com

101
Impedance Matching and Resonant Networks
	
(
)
(
)
ω =
−
+
= =
ω
H j
H j
(
)
1
(
)
.
LC
R
L
LC
LC
LC
R
L
1
1
1
2
1
2
max 	
(3.154)
The resonant characteristics of the network can be obtained by plotting the transfer 
function given by Equation 3.152 versus different values of R as shown in Figure 3.44. 
The values of the inductance and capacitance are taken to be 150 μH and 10 nF.
0
1
2
3
4
5
6
7
8
9
10
0
0.5
1
1.5
2
2.5
3
3.5 ×10–3
t [ms]
Natural response of an overdamped series RLC circuit
R = 250
R = 500
R = 750
R = 1000
in(t) [A]
FIGURE 3.42  Series resonant network response for overdamped case.
L
C
R
+
vo
vs
Zeq
FIGURE 3.43  Series resonant network with source voltage.

102
Linear and Switch-Mode RF Power Amplifiers
3.7.2  Parallel LC Networks
3.7.2.1  Parallel LC Networks with Ideal Components
When ideal components are used, the typical circuit would be represented as the one 
shown in Figure 3.45. At resonance, the magnitudes of the reactances of the L and C 
elements are equal. The reactances of two components have opposite signs; thus, the 
net reactance is zero for a series circuit or infinity for a parallel circuit. Hence, we 
can obtain the resonance frequency from
	
ω
= ω
→ω =
→
=
π
L
C
LC
f
LC
1
1
1
2
.
0
0
0
0
	
(3.155)
The transfer function for LC resonant network in Figure 3.45 is found from
	
ω
=
=
+




H
V
V
X
R
X
( )
20log
,
dB
out
in
dB
total
s
total
	
(3.156)
where
	
=
+
X
X X
X
X .
total
C
L
C
L
	
(3.157)
Substituting Equation 3.157 into 3.156 gives
	
(
)
ω
=
=
ω
−ω
+ ω
H
V
V
j L R
LC
j L R
( )
20log
/
1
/
.
dB
out
in
dB
s
2
s
	
(3.158)
0
0.5
1
1.5
2
2.5
3
× 105
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
f [Hz]
|
|
 Series resonant RLC circuit characteristics
R = 10
R = 20
R = 50
R =100
H(w)
FIGURE 3.44  Series resonant circuit transfer function characteristics.
www.ebook3000.com

103
Impedance Matching and Resonant Networks
The frequency characteristics of the circuit are plotted in Figure 3.46 when 
L = 0.5 μH, C = 2500 pF, and R = 50 Ω.
The quality factor of the circuit is found from its equivalent impedance as
	
(
)
(
)
=
+
+
=
−ω
+
ω
−ω
Z
R
X X
X
X
R
LC
j
L
LC
1
1
.
s
eq
s
C
L
C
L
2
2
	
(3.159)
Then, the quality factor of the circuit is
	
=
= ω
Q
X
R
L
R .
s
	
(3.160)
3.7.2.2  Parallel LC Networks with Nonideal Components
Now, assume that we have some additional loss for inductor for the LC network as 
shown in Figure 3.47.
Rs
Vo
C
Vs
L
FIGURE 3.45  LC resonant network with ideal components and source.
106
107
108
109
–60
–50
–40
–30
–20
–10
0
 dB
| 
|
f [Hz]
 LC parallel resonant circuit characteristics
H(w)
FIGURE 3.46  The frequency characteristics of LC network with source.

104
Linear and Switch-Mode RF Power Amplifiers
The equivalent impedance of the network in Figure 3.47 takes the following form 
with the addition of loss component, r:
	
(
)
(
)
(
)
(
)
(
)
=
+
+ ω
ω
−ω
+
=
+
+ ω
−ω
−ω
−ω
+ ω
Z
R
r
j L
j rC
LC
R
r
j L
LC
j rC
LC
rC
1
1
1
,
eq
s
2
s
2
2
2
2
	
(3.161)
which can be simplified to
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
−ω
+ ω



+
−ω
+ ω
+
ω
−
−ω


−ω
+ ω
Z
R
LC
rC
r
LC
rC
j
L
Cr
L C
LC
rC
1
1
1
.
eq
s
2
2
2
2
2
2
2
2
2
2
2
2 	
(3.162)
The resonant frequency of the network is now equal to
	
ω =
−
→
=
π
−
L
Cr
L C
f
L
Cr
L C
1
2
.
0
2
2
0
2
2
	
(3.163)
The loaded quality factor of the circuit is obtained as
	
(
)
(
)
(
)
=
ω
−
−ω


−ω
+ ω




Q
L
Cr
L C
R
LC
rC
1
.
L
2
2
2
s
2
2
2
	
(3.164)
When r = 0 for the lossless case, Equations 3.163 and 3.164 reduce to the ones given in 
Equations 3.155 and 3.160. The transfer function with the loss resistance changes to
	
(
)
(
)
(
)
(
)
ω
=
=
+ ω
−
−ω


−ω
+ ω



+ ω
−
−ω


H
V
V
r
j
L
Cr
L C
R
LC
rC
j
L
Cr
L C
( )
20log
1
.
dB
out
in
dB
2
2
2
s
2
2
2
2
2
2
(3.165)
The transfer function showing the attenuation profile with different loss resistance 
values when L = 0.5 μH, C = 2500 pF, and R = 50 Ω are illustrated in Figure 3.48. The 
network bandwidth broadens as the value of r increases as expected.
Rs
C
L
Vs
Vo
r
FIGURE 3.47  Addition of loss to parallel LC network.
www.ebook3000.com

105
Impedance Matching and Resonant Networks
The quality factor of the network with the addition of loss resistance significantly 
differs from the original LC parallel resonant network. Original network has ideally 
infinite value of quality factor. In agreement with this, a very large value of the qual-
ity factor for the original network is obtained at resonance frequency when r = 0 is 
also seen in Figure 3.49.
106
107
–35
–30
–25
–20
–15
–10
–5
0
f [Hz]
 dB
|
|
LC parallel resonant circuit characteristics with component loss (L-inductor)
r = 10
r = 5
r = 0
H(w)
FIGURE 3.48  Attenuation profile of LC network with loss resistor.
1
2
3
4
5
6
7
8
9
10
× 106
0
1
2
3
4
5
6
f (Hz]
Q
 LC parallel resonant circuit Q with component loss (L-inductor)
r = 10
r = 5
r = 0
FIGURE 3.49  Quality factor of LC network with loss resistor.

106
Linear and Switch-Mode RF Power Amplifiers
3.7.2.3  Loading Effects on Parallel LC Networks
Resonant circuit becomes loaded when it is connected to a load or when fed by a 
source Q of the circuit under these conditions called loaded Q or simply QL. The 
loaded of the circuit then depends on source resistance, load resistance, and indi-
vidual Q of the reactive components.
When the reactive components are lossy, they affect the Q factor of the overall cir-
cuit. For instance, consider the resonant circuit with source resistance in Figure 3.45. 
The quality factor of the circuit for various source resistance values when L = 0.5 μH, 
C = 2500 pF has been illustrated in Figure 3.50. For the same frequency, the qual-
ity factor increases as the value of source resistance, Rs, increases. As a result, the 
selectivity of the network can be adjusted by setting the value of source resistance. 
The attenuation profile showing the response when source resistance is changed is 
given in Figure 3.51. 
The circuit shown in Figure 3.52 has both source and load resistances. The imped-
ance of the loaded resonant network can be obtained as
	
(
)
(
)
(
)
(
)
=
+
ω
ω + ω
ω
−
=
+
ω
ω −ω
ω
−


ω
+ ω
ω
−


Z
R
j R L
L
j R
LC
R
R L
L
j R
LC
L
R
LC
1
1
1
,
eq
s
L
L
2
s
L
L
2
2
L
2
2
	 (3.166)
which can be simplified to
1
2
3
4
5
6
7
8
9
10
× 106
0
1
2
3
4
5
6
f [Hz]
Q
LC parallel resonant circuit Q versus Rs
R = 50
R = 250
R = 500
FIGURE 3.50  Quality factor of LC network for different source resistance values.
www.ebook3000.com

107
Impedance Matching and Resonant Networks
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
ω
+ ω
ω
−





+ ω
ω
+ ω
ω
−


+
ω
−ω
ω
+ ω
ω
−


Z
R
L
R
LC
L
R
L
R
LC
j
R L
LC
L
R
LC
1
1
1
1
.
eq
s
2
L
2
2
2
L
2
L
2
2
L
2
2
2
L
2
2
(3.167)
The loaded quality factor of the circuit is obtained as
	
(
)
(
)
(
)
(
)
=
ω
−ω
ω
+ ω
ω
−





+ ω
Q
R L
LC
R
L
R
LC
L
R
1
1
.
L
L
2
2
s
2
L
2
2
2
L
	
(3.168)
106
107
–35
–30
–25
–20
–15
–10
–5
0
f [Hz]
| dB
|
 LC parallel resonant circuit |H(w)| dB  versus Rs
R = 50
R = 250
R = 500
H(w)
FIGURE 3.51  Attenuation profile of LC network for different source resistance values.
Rs
C
L
Vs
Vo
RL
FIGURE 3.52  Loaded LC resonant circuit.

108
Linear and Switch-Mode RF Power Amplifiers
At resonant frequency, this circuit is simplified to the one in Figure 3.53.
The equivalent impedance from Equation 3.167 is equal to
	
=
+
Z
R
R .
eq
s
L 	
(3.169)
It is important to note that at resonant frequency,
	
ω
= ω
L
C
1
.
0
0
	
(3.170)
3.8  LC RESONATORS AS IMPEDANCE TRANSFORMERS
3.8.1  Inductive Load
Consider the LC parallel network with a loss resistor. The new circuit can be illus-
trated in Figure 3.54.
The equivalent impedance at the input for the circuit in Figure 3.54 can be writ-
ten as
	
(
)
(
)
(
)
(
)
(
)
=
−ω
+ ω
+
ω
−
−ω


−ω
+ ω
Z
R
LC
RC
j
L
CR
L C
LC
RC
1
1
.
eq
2
2
2
2
2
2
2
2
2 	
(3.171)
Rs
Vs
Vo
RL
FIGURE 3.53  Equivalent loaded LC resonant circuit at resonance.
C
L
R
Zeq
FIGURE 3.54  LC impedance transformer for inductive load.
www.ebook3000.com

109
Impedance Matching and Resonant Networks
The resonant frequency of the network is now equal to
	
ω =
−
→
=
π
−
L
CR
L C
f
L
CR
L C
1
2
.
0
2
2
0
2
2
	
(3.172)
At resonance frequency, the equivalent impedance will be purely resistive, Zeq = Req, 
and equal to
	
(
)
(
)
=
−ω
+ ω
=
R
R
LC
RC
L
RC
1
.
eq
2
2
2
	
(3.173)
Hence, when the network is at resonance, the capacitive load impedance is converted 
into a resistive input impedance. The quality factor, Qload, of the load at resonance is
	
= ω
Q
L
R .
load
0
	
(3.174)
The following relation between the load quality factor and the equivalent impedance 
at resonance can be written as
	
(
)
=
=
+
R
L
RC
Q
R
1
.
eq
load
2
	
(3.175)
3.8.2  Capacitive Load
The same principle for inductive load can be applied to convert the capacitive load 
to a resistive load at the resonant frequency using the LC resonant circuit shown in 
Figure 3.55.
The equivalent impedance at the input for the circuit in Figure 3.55 can be written as
	
(
)
(
)
(
)
(
)
(
)
=
ω
−ω
+ ω
+
ω
ω
−
+


−ω
+ ω
Z
RL C
LC
RC
j
L
R C
LC
LC
RC
1
1
1
.
eq
4
2
2
2
2
2
2
2
2
2
2
2
	
(3.176)
C
L
R
Zeq
FIGURE 3.55  LC impedance transformer for capacitive load.

110
Linear and Switch-Mode RF Power Amplifiers
The resonant frequency of the network is now equal to
	
ω =
−
→
=
π
−
LC
R C
f
LC
R C
1
1
2
1
.
0
2
2
0
2
2 	
(3.177)
At resonance frequency, Zeq = Req, and it can be expressed as
	
=
R
L
RC .
eq
	
(3.178)
Hence, when the network is at resonance, the capacitive load impedance is converted 
into a resistive input impedance. Since the quality factor, Qload, of the load at reso-
nance is
	
= ω
Q
RC
1
,
load
0
	
(3.179)
then the following relation can be established:
	
=
= ω
R
L
RC
LQ
.
eq
0
load 	
(3.180)
Example 3.10
An amplifier output needs to be terminated with a load line resistance of 2000 Ω 
at 1.6 MHz. It is given in the data sheet that the transistor has 20 pF at 1.6 MHz. 
There is an inductive load connected to the output of the load line circuit of the 
amplifier with RL = 5 Ω. The configuration of this circuit is given in Figure 3.56.
Ctran
R
RL
L
C
r
FIGURE 3.56  Amplifier output load line circuit.
www.ebook3000.com

111
Impedance Matching and Resonant Networks
	
1.	Calculate the values of L and C by assuming that the load inductor has a 
negligible loss, i.e., r = 0.
	
2.	The inductor is changed to a magnetic core inductor, which has the qual-
ity factor of 50. Calculate loss resistance, r, for the reactive component 
values obtained in (1). What is the value of new load line resistance?
	
3.	If the quality factor of the inductor is 50 and load line resistor is required 
to be 2000 Ω as set in the problem, what are the values of L and C with 
RL= 5 Ω?
Solution: It is given that Req = 2000 Ω, RL = R = 5 Ω, Ctran = 20 pF, f = 1.6 MHz, 
ωo = 107 rad/s, and CT = Ctran + C.
	
1.	When r = 0 Ω,
	
(
)
=
+
→
−=
→
=
R
Q
R
R
R
Q
Q
1
1
19.98.
eq
load
2
eq
load
2
load
	
(3.181)
So,
	
[
]
= ω
→
=
ω
→
=
µ
Q
L
R
L
Q
R
L
10
H .
load
0
load
0
	
(3.182)
Hence,
	
=
→
=
→
=
R
L
RC
C
L
R R
C
1[nF],
eq
T
T
eq
T
	
(3.183)
where
	
=
+
→
=
−
→
=
C
C
C
C
C
C
C
980 [pF].
T
tran
T
tran
	
(3.184)
	
2.	The Q of the inductor is given to be equal to 50. Then,
	
[ ]
= ω
→
=
ω
→
=
Ω
Q
L
r
r
L
Q
r
2
.
inductor
0
0
inductor
	
(3.185)
So, the new load resistance, Req, is
	
(
)
(
)
( )
=
+
=
×
×
=
Ω
−
−
R
L
R
r C
10
10
7 1 10
1428.6 [ ].
eq
T
6
9
	
(3.186)
	
3.	The Q of the inductor is given to be equal to 50. Then,
	
= ω
→
=
×
=
Q
L
r
r
L
aL
2 10
.
inductor
0
5
	
(3.187)
Since,
	
(
)
(
)
(
)
(
)
=
+
→
=
+
+
= ω
+
+
+
R
R Q
R
R
r
Q
L
R
aL
R
aL
1
1
,
eq
load
2
eq
load
2
0
2 2
2
	
(3.188)

112
Linear and Switch-Mode RF Power Amplifiers
which leads to solution for L as
	
(
)
(
)
−
−
ω +
−
−
ω +
=
L
L a R
R
a
R R
R
a
2
0.
2
eq
0
2
2
eq
0
2
2
	
(3.189)
As a result, the value of r is found as
	
=
×
=
Ω
r
L
2 10
2.44 [ ],
5
	
(3.190)
where
	
=
µ
L
12.2[ H]
Using Equation 3.183,
	
=
→
=
→
=
R
L
RC
C
L
R R
C
820 [pF],
eq
T
T
eq
T
	
(3.191)
where
	
=
+
→
=
−
→
=
C
C
C
C
C
820
20
800 [pF].
T
tran
	
(3.192)
3.9  TAPPED RESONATORS AS IMPEDANCE TRANSFORMERS
3.9.1  Tapped-C Impedance Transformer
To understand the operation of tapped-C impedance transformer, consider the capac-
itive voltage divider circuit shown in Figure 3.57. The output voltage can be found 
from
	
=
ω
ω
+
ω
=
+
v
v
j C
j C
j C
v
C
C
C
1/(
)
1/(
)
1/(
)
,
o
i
2
2
1
i
1
1
2
	
(3.193)
+
–
vi
C1
C2
vo
FIGURE 3.57  Capacitive voltage divider.
www.ebook3000.com

113
Impedance Matching and Resonant Networks
which can be expressed as
	
=
v
v n,
o
i
where
	
=
+
n
C
C
C .
1
1
2
	
(3.194)
Now, assume there is a load resistor connected to the output of the capacitor and res-
onator inductor connected to the input of the divider circuit as shown in Figure 3.58.
We then convert the output shunt-connected circuit to a series connection by 
using parallel-to-series conversion introduced earlier as shown in Figure 3.59.
The relation of the components in Figures 3.58 and 3.59 are
	
=
+






C
C
Q
Q
1
s
2
p
2
p
2
	
(3.195)
	
=
+
R
R
Q
1
s
p
2
	
(3.196)
C1
C2
R
L
Req
FIGURE 3.58  Capacitive voltage divider with load resistor.
C1
Cs
Rs
L
Req
FIGURE 3.59  Capacitive voltage divider with parallel-to-series transformation.

114
Linear and Switch-Mode RF Power Amplifiers
	
=
+
R
R
Q
1,
s
eq
r
2
	
(3.197)
where
	
=
= ω
Q
R
X
RC
C
p
0
2
2
	
(3.198)
	
= ω
= ω
Q
R
L
R C
1
.
o
r
eq
0
s
	
(3.199)
The equivalent capacitance can then be written as
	
=
+
C
C C
C
C .
1
s
1
s
	
(3.200)
Equating 3.195 and 3.198 gives
	
(
)
=
+
−






Q
Q
R
R
1
1 .
p
r
2
eq
	
(3.201)
Overall, using the transformations given, the tapped-C circuit in Figure 3.60a can 
be simplified and transformed to the one in Figure 3.60b with the following rela-
tions as
	
′ =
+




R
R
C
C
1
s
s
1
2
2
	
(3.202)
and
	
=
+
C
C C
C
C .
T
1
2
1
2
	
(3.203)
C2
C1
L
Rs
R´s
CT
L
(a)
(b)
FIGURE 3.60  Tapped equivalent circuit.
www.ebook3000.com

115
Impedance Matching and Resonant Networks
At resonance, the circuit can be simplified to the impedance transformer circuit 
shown in Figure 3.61 with
	
=
N
R
R
2
eq
	
(3.204)
Substitution of Equations 3.202 and 3.203 into 3.201 gives
	
(
)
=
+
−








Q
Q
N
1
1 .
p
r
2
2
	
(3.205)
Example 3.11
Design a parallel resonant circuit with the tapped-C approach where 3 dB band-
width is 3 MHz and center frequency is 27.12 MHz. Resonant circuit will operate 
between a source resistance of 50 Ω and a load resistance of 100 Ω. Assume that 
Q of the inductor is 150 at 27.12 MHz.
	
1.	Obtain element values of the circuit shown in Figure 3.62a.
	
2.	Obtain element values of the equivalent circuit shown in Figure 3.62b.
	
3.	Use MATLAB to obtain the frequency response of the circuits shown in 
Figure 3.62a and b.
N : 1
Req
R
FIGURE 3.61  Equivalent tapped-C circuit representation using transformer.
C2
C1
L
Rs
R´s
CT
L
(b)  
(a)  
FIGURE 3.62  Parallel resonant circuit with tapped-C approach.

116
Linear and Switch-Mode RF Power Amplifiers
Solution: The equivalent circuit shown in Figure 3.54b has
	
′ =
Ω
R
100
s
since
	
′ =
+



→
+



=
→
=
R
R
C
C
C
C
C
C
1
1
2
0.414
.
s
s
1
2
2
1
2
2
1
2
Since the inductor is lossy,
	
=
→
=
=
X
R
Q
R
Q X
X
150
.
p
p
p
p
p
p
p
The loaded Q of the resonant circuit is found from
	
=
−
=
=
Q
f
f
f
27.12
3
9.04.
c
2
1
Since
	
(
)
(
)
(
)
=
→
=
=
+
→
=
+
Q
R
X
R
X
R
R
X
X
X
X
9.04
50
50
9.04
150
50
50
150
,
total
p
total
p
p
p
p
p
p
p
then,
	
=
=
Ω
X
7048
1356
5.2[ ].
p
So,
	
[ ]
=
=
Ω
R
X
150
780
.
p
p
The values of the L and C are found from
	
(
)
= ω =
π
×
=
L
X
5.2
2
27.12
10
30.5[nH]
p
6
	
(
)(
)
= ω
=
π
×
=
C
X
1
1
2
27.12
10
5.2
1128 [pF].
T
p
6
The capacitor values for the circuit in Figure 3.54a are found from
	
=
+
→
=
→
=
=
C
C C
C
C
C
C
C
1128
0.414
1.414
3852.6 [pF] and
1595[pF].
T
1
2
1
2
2
2
1
	
3. The attenuation profile is shown in Figure 3.63.
www.ebook3000.com

117
Impedance Matching and Resonant Networks
3.9.2  Tapped-L Impedance Transformer
Typical tapped-L impedance transformer circuit is shown in Figure 3.64a. We can 
follow the same procedure outlined in Section 3.8.1 and convert the circuit to its 
equivalent circuit shown in Figure 3.64b by using parallel-to-series transformation 
relations as previously done.
Overall, the tapped-L circuit in Figure 3.64a can be simplified to the one shown in 
Figure 3.65 using the transformations with the following relation as
	
′ =




R
R
n
n
.
s
s
1
2
	
(3.206)
3.10  SIGNAL FLOW GRAPHS
A signal flow graph technique is used to facilitate analysis of transmission lines in 
the amplifier design by providing a simplification for the complicated circuits. They 
are used to determine the critical amplifier design parameters such as reflection coef-
ficients, power, and voltage gains. When signal flow graph of the circuit is obtained, 
mathematical relations are developed using Mason’s rule. The key elements for the 
signal flow graph are as follows:
•	 Each variable is treated as a node.
•	 Branches represent paths for signal flow.
•	 The network must be linear.
A node represents the sum of the branches coming into it. Branches are represented 
by scattering parameters. It is safe to assume that branches enter dependent variable 
0
1
2
3
4
5
6
7
8
9
10
× 107
–180
–160
–140
–120
–100
–80
–60
–40
–20
0
Attenuation proﬁle
Frequency [Hz]
Attenuation [dB]
FIGURE 3.63  Attenuation profile for parallel resonant circuit with tapped-C.

118
Linear and Switch-Mode RF Power Amplifiers
C
(a)
R
L1
Req
L2
(b)
C
L1
Req
Ls
Rs
FIGURE 3.64  (a) Tapped-L impedance transformer and (b) tapped-L impedance transformer 
with parallel-to-series transformation.
n
n1
Rs
C
R´s
CT
L
(a)
(b)
FIGURE 3.65  Tapped-L equivalent circuit.
www.ebook3000.com

119
Impedance Matching and Resonant Networks
nodes and leave independent variable nodes. Consider the two-port linear network 
given in Figure 3.66. This network can be represented using the signal flow graph as 
shown in Figure 3.67. Scattering parameter on each branch is represented by the ratio 
of the reflected wave to the incident wave:
	
=
S
b
a .
jk
j
k
	
(3.207)
This can be illustrated with the signal flow graph shown in Figure 3.68 where the 
wave that is emanated at the node ak is assumed to be the incident wave and the wave 
that goes into node bj is assumed to be the reflected wave.
Example 3.12
If signal is given as
	
=
+
b
S a
S a ,
11 1
12 2
find its signal flow graph representation?
a1
b1
a2
b2
Zo
Zo
[S]
FIGURE 3.66  Two-port linear network illustration.
a1
b1
a2
b2
S21
S22
S12
S11
FIGURE 3.67  Signal flow graph implementation of two-port network.
bj = Sjk ak
ak
bj
FIGURE 3.68  Representation of branch using scattering parameter.

120
Linear and Switch-Mode RF Power Amplifiers
Solution: Signal b is a dependent node and can be represented as the two incom-
ing branches as shown in Figure 3.69.
Example 3.13
Represent the signal source and source impedance given in Figure 3.70 by a signal 
flow graph.
Solution: Using the circuit in Figure 3.70, we can write the expression for the volt-
age at the input as
	
=
+
V
V
I Z ,
i
s
g
s 	
(3.208)
which can be written in terms of incident and reflected wave as
	
+
=
+
−




+
−
+
−
V
V
V
V
Z
V
Z
Z .
i
i
s
i
0
i
0
s 	
(3.209)
Solving Equation 3.209 for 
−
Vi  gives
	
=
+ Γ
b
b
a ,
g
s
s
g 	
(3.210)
S11
a1
a2
S12
b
FIGURE 3.69  Representation of dependent node.
Vi
Zs
Ig
+
+
Vs
–
ag
bg
FIGURE 3.70  Source generator and impedance circuit.
www.ebook3000.com

121
Impedance Matching and Resonant Networks
where
	
=
−
b
V
Z
i
g
0
	
(3.211)
	
=
+
a
V
Z
i
g
0
	
(3.212)
	
=
+
b
V
Z
Z
Z .
s
s
0
s
0 	
(3.213)
Hence, we obtain
	
Z
Z
Z
Z .
s
s
0
s
0
Γ =
−
+
	
(3.214)
The results can be represented with the signal flow graph shown in Figure 3.71.
Example 3.14
Represent the load impedance given in Figure 3.72 by a signal flow graph.
Solution: In Figure 3.72, the load voltage is represented as
	
=
V
Z I .
L
L L
	
(3.215)
We can represent load voltage in terms of incident and reflected waves as
	
+
=
+
−




+
−
+
−
V
V
Z
V
Z
V
Z
.
L
L
L
L
0
L
0
	
(3.216)
Equation 3.216 can be rewritten as
	
= Γ
b
a ,
L
L
L
	
(3.217)
bg
ag
bs
1
Γs
FIGURE 3.71  Signal flow graph representation of source generator and impedance 
circuit.

122
Linear and Switch-Mode RF Power Amplifiers
where
	
=
−
b
V
Z
L
L
0
	
(3.218)
	
=
+
a
V
Z
L
L
0
	
(3.219)
	
Γ =
−
+
Z
Z
Z
Z .
L
L
0
L
0
	
(3.220)
Using Equation 3.217, we can represent the load impedance in Figure 3.72 with 
the signal flow graph shown in Figure 3.73.
Example 3.15
Represent the two-port transmission circuit shown in Figure 3.74 with the signal 
flow graph.
Solution: We can now combine the solutions given in Figures 3.71 and 3.73 and 
obtain the signal flow graph representation for the transmission line circuit shown 
in Figure 3.74 as illustrated in Figure 3.75.  
VL
ZL
IL
+
–
aL
bL
FIGURE 3.72  Load impedance circuit.
bL
aL
ΓL
FIGURE 3.73  Signal flow graph representation of load impedance.
www.ebook3000.com

123
Impedance Matching and Resonant Networks
REFERENCES
	
1.	 A. Eroglu, RF Circuit Design Techniques for MF-UHF Applications, CRC Press, Boca 
Raton, FL, 2013.
	
2.	 A. Eroglu, Introduction to RF Power Amplifier Design and Simulation, CRC press, 
Boca Raton, FL, 2016.
bg
ag
bs
1
bL
aL
Γs
ΓL
FIGURE 3.75  Signal flow graph representation of transmission line circuit.
VL
ZL
+
–
aL
bL
Vi
Zs
+
+
Vs
–
ag
bg
Zo
FIGURE 3.74  Transmission line circuit.

www.ebook3000.com

125
4 Small-Signal Amplifiers
4.1  AMPLIFIER BASIC TERMINOLOGY
In this section, some of the common terminologies used in radio frequency (RF) 
power amplifier (PA) design will be discussed. For this discussion, consider the sim-
plified RF PA block diagram given in Figure 4.1. The RF PA shown in this figure has 
a simple three-port network comprising an RF input signal port, a DC input port, and 
an RF signal output port. Power that is not converted into RF output power, Pout, is 
dissipated as heat and designated as Pdiss (Figure 4.1). The dissipated power, Pdiss, is 
calculated as
	
(
)
=
+
−
P
P
P
P
diss
in
dc
out 	
(4.1)
4.1.1  Gain
RF PA gain is defined as the ratio of the output power to the input power and is 
given as
	
=
G
P
P
out
in
	
(4.2)
It can be defined in terms of dB as
	
=




G
P
P
[dB]
10log
[dB]
out
in
	
(4.3)
RF PA gain is higher at lower frequencies. This can be illustrated based on the data 
measured for a switch-mode RF amplifier operating in the high-frequency (HF) 
range for various DC supply voltages (Figure 4.2).
It is possible to obtain higher gain level when multiple amplifiers are cascaded to 
obtain multistage amplifier configuration as shown in Figure 4.3.
The overall gain of the multistage amplifier system shown in Figure 4.3 can be 
given as
	
=
+
+
G
G
G
G
[dB]
[dB]
[dB]
[dB]
tot
PA
PA
PA
1
2
3
	
(4.4)
The unit of gain is given in terms of [dB], because it is the ratio of the output power 
to the input power. It is important to note that dB is not a unit to define the power. In 
amplifier terminology, dBm is used to define the power. dBm can be calculated as
	
=




P
dBm
10log 1mW 	
(4.5)

126
Linear and Switch-Mode RF Power Amplifiers
Example 4.1
In the RF system shown in Figure 4.4, the RF signal source can provide power 
output from 0 to 30 dBm. RF signal is fed through a 1 dB T-pad attenuator and a 
20 dB directional coupler, where the sample of the RF signal is further attenuated 
by a 3 dB π-pad attenuator before power meter reading in dB. The “through” port 
of the directional coupler has 0.1 dB of loss before it is sent to PA. RF PA output is 
then connected to a 6 dB π-pad attenuator. If power meter is reading 10 dBm, what 
is the power delivered to the load shown in Figure 4.4 in mW?
Solution: We need to find the source power first. The loss from power meter to 
RF signal source is
	
Loss from Power Meter to Source
3dB
20dB
1dB
23dB
=
+
+
=
 
0
2
4
6
8
10
12
14
12.5
13
13.5
14
14.5
Frequency [MHz]
Gain [dB]
Gain at Vdc = 60 V
Gain at Vdc = 80 V
Gain at Vdc = 100 V
Gain at Vdc = 120 V
FIGURE 4.2  Measured gain variation versus frequency for a switched-mode RF amplifier.
L
o
a
d
PA
Pout( fo)
Pin( fo )
Pdc
Pdiss ( fo)
FIGURE 4.1  RF PA as three-port network.
Pin
PA1
PA2
GPA1 [dB]
GPA2 [dB]
PA3
GPA3 [dB]
Pout
FIGURE 4.3  Multistage RF amplifiers.
www.ebook3000.com

127
Small-Signal Amplifiers
Then, the power at the source is
	
RF Source Signal
23 dBm
10 dBm
33 dBm
=
+
=
 
The total loss toward PA is due to the T-Pad attenuator (1 dB) and the directional 
coupler (0.1 dB) and is equal to 1.1 dB. Therefore, the transmitted RF signal at PA is
	
RF Signal at PA
33dBm
1.1dBm
31.9dBm
=
−
=
Hence, the power delivered to the load is
	
Power Delivered to the Load
31.9dBm
6dBm
25.9dBm
=
−
=
Power delivered in mW is
	
P[mW]
10
10
389.04 [mW]
dBm
10
25.9
10
=
=
=
4.1.2  Efficiency
In practical applications, RF PA is implemented as a subsystem, and it consumes 
most of the DC power from the supply. As a result, minimal DC power consumption 
for amplifier becomes important, and it can be accomplished by having high RF PA 
efficiency. RF PA efficiency is one of the critical and most important amplifier per-
formance parameters. Amplifier efficiency can be used to define the drain efficiency 
for MOSFET or collector efficiency for bipolar junction transistor (BJT). Amplifier 
efficiency is defined as the ratio of the RF output power to the power supplied by DC 
source and can be expressed as
	
η
=
×
P
P
[%]
100
out
DC
	
(4.6)
Directional
coupler
(20 dB)
PA
Power
meter
L
o
a
d
Reading =10 dB m
T-Pad (1 dB)
PRFin(0–35 dBm)
IL=0.1dB
pi-Pad (6 dB)
pi-Pad (3 dB)
FIGURE 4.4  RF system with coupler and attenuation pads.

128
Linear and Switch-Mode RF Power Amplifiers
Efficiency in terms of gain can be expressed in the following form:
	
η
=
+ 


−



×
P
P
G
[%]
1
1
1
100
diss
out
	
(4.7)
The maximum efficiency is possible when there is no dissipation, i.e., Pdiss = 0. The 
maximum efficiency calculated from Equation 4.7 is then equal to
	
η
=
−



×
G
[%]
1
1
1
100 	
(4.8)
When RF input power is included in the efficiency calculation, the efficiency is then 
called as power-added efficiency, ηPAE, and is calculated as
	
η
=
−
×
P
P
P
[%]
100
PAE
out
in
DC
	
(4.9a)
or
	
η
= η
−



×
G
[%]
1
1
100
PAE
	
(4.9b)
Example 4.2
RF PA delivers 200 [W] to a given load. If the input supply power for this amplifier 
is 240 [W], and the power gain of the amplifier is 15 dB, find (1) drain efficiency 
and (2) power-added efficiency.
Solution:
	
1.	The drain efficiency can be calculated from Equation 4.6 as
	
P
P
[%]
100
200
240
100
83.33%
out
DC
η
=
×
=
×
=
	
2. Power-added efficiency can be calculated from Equation 4.9 as
	
G
[%]
1
1
100
83 1
1
15
77.47%
PAE
η
= η
−



×
=
−



=
4.1.3  Power Output Capability
Power output capability of an amplifier is defined as the ratio of the output power 
of the amplifier to the maximum values of the voltage and current that device 
www.ebook3000.com

129
Small-Signal Amplifiers
experiences during the operation of the amplifier. When more than one transistor is 
used, or the number of transistors increases due to the amplifier configuration used, 
such as push–pull configuration or any other combining techniques, this is reflected 
in the denominator of the following equation:
	
=
c
P
NI
V
p
o
max
max
	
(4.10)
4.1.4  Linearity
Linearity is a measure for RF amplifier output to follow the amplitude and phase of 
its input signal. In practice, the linearity of an amplifier is measured in a very dif-
ferent way. Linearity of an amplifier is measured by comparing the set power of an 
amplifier with the output power. The gain of the amplifier is then adjusted to com-
pensate one of the closed-loop parameters. The typical closed-loop control system 
that is used to adjust the linearity of the amplifier through closed-loop parameters is 
shown in Figure 4.5. When the linearity of the amplifier is accomplished, the linear 
curve shown in Figure 4.6 is obtained. The experimental setup that is used to cali-
brate RF PAs to have linear characteristics is given in Figure 4.7.
In Figure 4.7, RF amplifier output is measured by thermocouple-based power 
meter via directional coupler. Directional coupler output is terminated with 50 Ω 
load. The set power is adjusted by the user, and the output forward power, Pfwr, and 
reverse power are measured with the power meter. If set power and output power are 
different, the control closed-loop parameters are then modified.
Pout
Pset
FIGURE 4.6  Linear curve for RF amplifier.
+
PID
Forward
gain
PA
Coupler
Detector
Feedback
gain
Pset
Pout
+
–
FIGURE 4.5  Typical closed-loop control for RF power amplifier for linearity control.

130
Linear and Switch-Mode RF Power Amplifiers
4.1.5  1 dB Compression Point
Compression point for an amplifier is the point where amplifier gain becomes 1 dB 
below its ideal linear gain (Figure 4.8). Once the 1 dB compression point is identified 
for the corresponding input power range, the amplifier can be operated in linear or 
nonlinear mode. Hence, the 1 dB compression point can also be conveniently used to 
identify the linear characteristics of the amplifier.
Gain at 1 dB compression point can be calculated as
	
−
=
=
−
P
P
G
G
1
1dB,out
1dB,in
1dB
0
	
(4.11)
where G0 is the small signal or linear gain of the amplifier at fundamental fre-
quency. The 1 dB compression point can also be expressed using the input and output 
Pset
Pout
PA
RF coax cable
Directional
coupler
F
R
50
Ω
l
o
a
d
Power
sensor
Power
sensor
Pfwr
Power meter
Prev
FIGURE 4.7  Experimental setup for linearity adjustment of RF power amplifiers.
Compression
region
Linear
region
(small-signal)
P1dB (input power)
Pin [dBm]
Pout [dBm]
P1dB (output power)
1dB compression
point
FIGURE 4.8  1 dB compression point for amplifiers.
www.ebook3000.com

131
Small-Signal Amplifiers
voltages and their coefficients. The gain of the amplifier at fundamental frequency 
when 
= β
ω
v t
t
( )
cos
i
 is calculated as
	
=
α + α β
G
20log
3
4
1dB
1
3
2
	
(4.12)
	
(
) =
α
G
Linear/small signal gain
20log
0
1 	
(4.13)
As a result, the 1 dB compression point in Figure 4.8 can be calculated as
	
α + α β
=
α −
20log
3
4
20log
1dB
1
3
in,1dB
2
1
	
(4.14)
where β1dB is the amplitude of the input voltage at 1 dB compression point. Solution 
of Equation 4.14 for β1dB leads to
	
β
=
α
α
0.145
1dB
1
3
	
(4.15)
4.1.6  Harmonic Distortion
Harmonic distortion for an amplifier can be defined as the ratio of the amplitude 
of the nω component to the amplitude of the fundamental component. The second-
order and third-order harmonic distortions can then be expressed as
	
=
α
α β
HD
1
2
2
2
1
	
(4.16)
	
=
α
α β
HD
1
4
3
3
1
2 	
(4.17)
From Equations 4.16 and 4.17, it is apparent that the second harmonic distortion is 
proportional to signal amplitude, whereas third-order amplitude is proportional to 
the square of the amplitude. Hence, when input signal is increased by 1 dB, HD2 
increases by 1 dB and HD3 increases by 2 dB. The total harmonic distortion (THD) 
in the amplifier can be calculated as
	

THD
HD
HD
2
2
3
2
(
)
(
)
=
+
+
	
(4.18)
Example 4.3
RF signal, v t
t
( )
cos
i
= β
ω , is applied to a linear amplifier and then to a nonlinear 
amplifier given in Figure 4.9 with output response vo(t) = α0 + α1β cos ωt + α2β2 cos2 
ωt + α3β3 cos3 ωt. Assume input and output impedances are equal to R. (1) Calculate 

132
Linear and Switch-Mode RF Power Amplifiers
and plot gain for linear amplifier. (2) Obtain second and third harmonic distortions 
for nonlinear amplifier when 
0,
1,
3,
1
0
1
2
3
α =
α =
α =
α =  and 
1
β = , 
2
β =
. Calculate 
also THD for both cases.
Solution:
	
1.	For linear amplifier characteristics, the output voltage is expressed as
	
v t
v t
( )
( )
o
i
= β
	
(4.19)
which can also be written as
	
R v t
R v t
1
2
( )
1
2
( )
o
2
2
i
2
= β
	
(4.20)
or
	
P
P
o
2
i
= β
	
(4.21)
When power gain calculated from Equation 4.13 is given in dBm, then this can be 
expressed as
	
P
P
10log 1 mW
10log
1 mW
o
2
i





=
β





	
(4.22)
or
	
P
P
[dBm]
10log
[dBm]
o
2
in
( )
=
β
+
	
(4.23)
Then, the power gain is obtained from Equation 4.14 as
	
G
P
P
Gain[dBm]
[dBm]
10log
[dBm]
[dBm]
2
o
in
( )
=
=
β
=
−
	
(4.24)
The relation between input and output power is plotted and illustrated in 
Figure 4.10.
	
2.	The nonlinearity response of the amplifier using third-order polynomial 
can be expressed using Equation 1.2 as
	
v t
v t
v t
v t
( )
( )
( )
( )
o
0
1 i
2 i
2
3 i
3
= α + α
+ α
+ α
	
(4.25a)
or
Zin=R
ZL= R
Vin
PA
Pin
Pout Vout
FIGURE 4.9  PA output response.
www.ebook3000.com

133
Small-Signal Amplifiers
	
v t
t
t
t
( )
cos
cos
cos
o
0
1
2
2
2
3
3
3
= α + α β
ω + α β
ω + α β
ω 	
(4.25b)
As seen from Equation 4.25, we have fundamental, second-order harmonic, third-
order harmonic, and a DC component in the output response of the amplifier. In 
Equation 4.25, it is also seen that the DC component exists due to second harmonic 
content. Equation 4.25 can be rearranged to give the following closed form relation:
	
v t
t
t
t
t
( )
cos
2
2
cos 2
3
4
cos
4
cos3
o
0
1
2
2
2
2
3
3
3
3
= α + α β
ω + α β + α β
ω +
α β
ω + α β
ω
(4.26a)
which can be simplified to
v t
t
t
t
( )
2
3
4
cos
2
cos 2
4
cos3
o
0
2
2
1
3
2
2
2
3
3
= α + α β



+ α +
α β



β
ω +
α



β
ω + α β
ω
(4.26b)
When 
1,
3,
1
1
2
3
α =
α =
α = , and 
1
β = , HD2 and HD3 are calculated from Equations 
4.16 and 4.17 as
	
HD
1
2
1
2
3
1 1
1.5
2
2
1
( )
=
α
α β =
=
	
(4.27)
	
HD
1
4
1
4
1
1 1
0.25
3
3
1
2
2
( )
=
α
α β =
=
	
(4.28)
When 
1,
3,
1
1
2
3
α =
α =
α = , and 
2
β =
,
	
HD
1
2
1
2
3
1 2
3
2
2
1
( )
=
α
α β =
=
	
(4.29)
	
HD
1
4
1
4
1
1 2
1
3
3
1
2
2
( )
=
α
α β =
=
	
(4.30)
The THD for this system calculated from Equation 4.18 is
	
THD
1.5
0.25
1.5625
2
2
(
)
(
)
=
+
=
	
(4.31a)
and
Pin [dBm]
G =10log(α1
2)
Pout [dBm]
FIGURE 4.10  Power gain for linear operation.

134
Linear and Switch-Mode RF Power Amplifiers
	
THD
3
1
3.16
2
2
( )
( )
=
+
=
	
(4.31b)
Example 4.4
Input voltage given for an RF circuit is v
t
t
( )
cos(
)
in
= β
ω . RF circuit generates signal 
at third harmonic as V
t
cos(3
)
3
ω . What is the 1 dB compression point?
Solution: Using Equation 4.26b, the amplitude of the third harmonic component 
can be found from
	
V
V
4
or
4
3
3
3
3
3
3
α β =
α = β
	
(4.32a)
Then, 1 dB compression point, β1dB, is found from Equation 4.15 as
	
V
V
0.145
0.145
4
0.19
1dB
1
3
3
1
3
3
1
3
β
=
α
α
=
β α
=
β α
	
(4.32b)
4.1.7  Intermodulation
When a signal comprising two cosine waveforms with different frequencies
	
= β
ω
+ β
ω
v t
t
t
( )
cos
cos
i
1
1
2
2 	
(4.33)
is applied to an input of an amplifier, the output signal consists of components of the 
self-frequencies and their products created by frequencies by ω1 and ω2 given by the 
equation below.
	
v t
t
t
t
t
t
t
( )
cos
cos
cos
cos
cos
cos
o
1
1
1
2
2
2
1
1
2
2
2
3
1
1
2
2
3
(
)
(
)
(
)
= α β
ω
+ β
ω
+ α
β
ω
+ β
ω
+α
β
ω
+ β
ω
	
(4.34a)
or
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
= α
β
ω
+ β
ω
+ α
β
+
ω
+
β
+
ω
+
β β
ω + ω
+
ω −ω












+ α
β
ω
+
β β
ω
+
β
ω
+
β β
ω −ω
+
β β
ω −ω
+
β β
ω
+
β
ω
+
β
ω
+
β β
ω + ω
+
β β
ω + ω


















v t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
t
( )
cos
cos
1
2
1
cos2
1
2
1
cos2
1
2
cos(
)
cos(
)
3
4
cos
3
2
cos
1
4
cos(3
)
3
4
cos(
2
)
3
4
cos(2
)
3
2
cos
3
4
cos
1
4
cos 3
3
4
cos(2
)
3
4
cos(
2
)
o
1
1
1
2
2
2
1
2
1
2
2
2
1
2
1
2
1
2
3
1
3
1
1
2
2
1
1
3
1
1
2
2
1
2
1
2
2
1
2
1
2
2
2
2
3
2
2
3
2
1
2
2
1
2
1
2
2
1
2

(4.34b)
www.ebook3000.com

135
Small-Signal Amplifiers
In Equation 4.34, DC component, α0, is ignored. The components that will rise due 
to combinations of the frequencies, ω1 and ω2, as given by Equation 4.34a are shown 
in Table. 4.1. The corresponding frequency components in Table 4.1 are also illus-
trated in Figure 4.11.
In amplifier applications, intermodulation distortion products are undesirable 
components in the output signal. As a result, the amplifier needs to be tested using an 
input signal, which is the sum of two cosines, to eliminate these side products. This 
test is also known as a two-tone test. This specific test is important for an amplifier 
specifically when two frequencies, ω1 and ω2, are close to each other. 
Amplitude of IMD  products
Frequency of IMD products
ω1–ω2
ω1+ω2
2ω1–ω2
2ω1+ω2
2ω2–ω1
2ω2+ω1
ω1
ω2
FIGURE 4.11  Illustration of IMD frequencies and products.
TABLE 4.1
Intermodulation Frequencies and Corresponding Amplitudes
ω = ω1
α β +
α β +
α β β




ω t
3
4
3
2
cos(
)
1
1
3
1
3
3
1
2
2
1
ω = ω2
α β +
α β +
α β β




ω t
3
4
3
2
cos(
)
1
2
3
2
3
3
2
1
2
2
ω = ω1 + ω2
(
)
α β β
ω + ω
t
1
2
cos(
)
2
1
2
1
2
ω = ω1 − ω2
(
)
α β β
ω −ω
t
1
2
cos(
)
2
1
2
1
2
ω = 2ω1 + ω2
α β β




ω + ω
t
3
4
cos(2
)
3
1
2
2
1
2
ω = 2ω1 − ω2
α β β




ω −ω
t
3
4
cos(2
)
3
1
2
2
1
2
ω = 2ω2 + ω1
α β β




ω + ω t
3
4
cos(2
)
3
1
2
2
2
1
ω = 2ω2 − ω1
α β β




ω −ω t
3
4
cos(2
)
3
1
2
2
2
1

136
Linear and Switch-Mode RF Power Amplifiers
The second-order intermodulation distortion, IM2, can be found from Equation 4.18 
and Table 4.1, when β1 = β2 = β. It is the ratio of the components at ω1 ± ω2 to the 
fundamental components at ω1 or ω2.
	
= α
α β
IM2
2
1
	
(4.35)
The third-order distortion, IM3, can be found from the ratio of the component at 
2ω2 ± ω1
(or 2ω1 ± ω2) to the fundamental components at ω1 or ω2.
	
=
α
α β
IM
3
4
3
3
1
2 	
(4.36)
IM product frequencies are summarized in Table 4.2.
If Equations 4.16 through 4.17 and 4.35 through 4.36 are compared, intermodula-
tion (IM) products can be related to harmonic distortion (HD) products as
	
=
IM
2HD
2
2 	
(4.37)
	
=
IM
3HD
3
3 	
(4.38)
IM3 distortion components at frequencies 2ω1 − ω2 and 2ω2 − ω1 are very close to 
the fundamental components. That is the reason why IM3 signal is measured most of 
the time for intermodulation distortion (IMD) characterization of the amplifier. The 
simplified measurement setup for IMD testing is shown in Figure 4.12.
The point at which the output components at the fundamental frequency and IM3 
intersect is called an intercept point or IP3. At this point, IM3 = 1, and IP3 is found 
from Equation 4.36 as
TABLE 4.2
Summary of IM Product Frequencies
IM2 frequencies
ω1 ± ω2
IM3 frequencies
2ω1 ± ω2
2ω2 ± ω1
IM5 frequencies
3ω1 ± 2ω1
3ω2 ± 2ω1
RF signal
Gen1
RF signal
Gen2
f2
f1
Σ
PA
Spectrum
analyzer
FIGURE 4.12  Simplified IMD measurement setup.
www.ebook3000.com

137
Small-Signal Amplifiers
	
(
)
=
=
α
α
IM
1
3
4
IP
3
3
1
3
2 	
(4.39)
or
	
=
α
α
IP
4
3
3
1
3
	
(4.40)
which can also be written as
	
=
V
IP
IM
3
in
3
	
(4.41)
where Vin is the input voltage. Equation 4.41 can be expressed in terms of dB by tak-
ing log of both sides in Equation 4.41 as
	
=
−
V
IP [dB]
[dB]
1
2 IM [dB]
3
in
3
	
(4.42)
The dynamic range (DR) is measured to understand the level of the output noise and 
is defined as
	
= α
=
V
V
V
V
DR
N
N
1
in
out
in
in
	
(4.43)
where input noise is related to output noise by
	
= α
V
V
N
N
in
out
1
	
(4.44)
So,
	
=
−
V
V
DR[dB]
[dB]
[dB]
N
in
in
	
(4.45)
Intermodulation-free dynamic range (IMFDR3) is defined as the largest DR pos-
sible with no IM3 product. For the third-order intermodulation distortion, VNout is 
defined as
	
=
α
V
V
3
4
Nout
3
in
3 	
(4.46)
We can then obtain
	
=
α
V
V
4
3
N
in
3
out
3
	
(4.47)
Substituting Equation 4.46 into Equation 4.43 gives IMFDR3 as
	
=
= α
=
=
α
α
V
V
V
V
DR
IMFDR
4
3
1
N
N
3
1
in
out
in
1
3
3
out
2
3
	
(4.48)

138
Linear and Switch-Mode RF Power Amplifiers
Since VNout = α1 VNin from Equation 4.41, Equation 4.43 can be written in terms of 
input noise as
	
= α
=
=
α
α
V
V
V
V
IMFDR
4
3
1
N
N
3
1
in
out
in
1
3
in
2
3
	
(4.49)
When Equations 4.40 and 4.49 are compared, IMFDR3 can also be expressed using 
intercept point, IP3, as
	
= 



V
IMFDR
IP
N
3
3
in
2/3
	
(4.50)
or in terms of dB, Equation 4.50 can also be given as
	
(
)
=
−V
IMFDR [dB]
2
3 IP [dB]
[dB]
N
3
3
in
	
(4.51)
The relationship between the fundamental component and the third-order dis-
tortion component via input and output voltages is illustrated in Figure 4.13. In 
Figure  4.13, −1 dB compression point is used to characterize IM3 product. The 
−1 dB compression point can be defined as the value of the input voltage, Vin, which 
is designated as Vin,1dBc, where fundamental component is reduced by 1 dB. Vin,1dBc 
can be defined as
	
(
)
=




α
α
V
0.122
4
3
in,1dBc
1
3
	
(4.52)
which is also equal to
	
(
)
=
V
0.122 IP
in,1dBc
3 	
(4.53)
Vout[V]
Vin[V]
IP3
1dB
IM3
IMFDR3
α1Vin
DRN
¾α3Vin
3
–1dB compression point
VNout
FIGURE 4.13  Illustration of the relation between fundamental components and IM3.
www.ebook3000.com

139
Small-Signal Amplifiers
Equation 4.53 can be expressed in [dB] as
	
=
−
V
(dB)
IP [dB]
9.64 dB
in,1dBc
3
	
(4.54)
As a result, once IP3 is determined, Equation 4.53 can be used to calculate −1 dB 
compression point for the amplifier.
Example 4.5
Assume a sinusoid signal, v t
t
( )
sin
i
(
)
=
ω , with 5 Hz frequency is applied to a 
nonlinear amplifier that has output signal (1) v t
t
t
( )
10sin
2sin
o
2
(
)
(
)
=
ω
+
ω , (2) 
v t
t
t
( )
10sin
3sin
o
3
(
)
(
)
=
ω
−
ω , and (3) v t
t
t
t
( )
10sin
2sin
3sin
o
2
3
(
)
(
)
(
)
=
ω
+
ω
−
ω . 
Obtain the time domain representation of the input signal and frequency domain 
representation of power spectra of the output signal of the amplifier.
Solution:
	
1.	The frequency spectrum for the input signal and power spectrum for the 
output signal of the amplifier are obtained using MATLAB® script given 
later. Based on the results shown in Figure 4.14, the amplifier output has 
components at DC, f, and 2f.
	
2.	The third-order response is shown in Figure 4.15. As seen from 
Figure 4.15, output signal does not have DC component anymore. The 
third-order effect shows itself as clipping in the time domain signal and 
fundamental and third-order components at the output power spectra of 
the signal.
	
3.	Using the modified MATLAB script in parts (a) and (b), the time domain 
and frequency domain signals are obtained and illustrated in Figure 4.16.
As illustrated, the output response has components at DC, f, 2f, and 3f. Overall, the 
level of the nonlinearity response of the amplifier strongly depends on the coeffi-
cients of the output signal.
4.2  SMALL-SIGNAL AMPLIFIER DESIGN
There are three critical design stages that need to be implemented in small-signal 
amplifier design.
•	 Design of DC biasing circuit
•	 Obtaining parameters of the transistor
•	 Implementation of the small-signal amplifier design
The small-signal amplifier design begins with designing biasing circuit to choose the 
operating point, Q point, Vceq and Icq for BJT, and Vdsq and Idq for field effect transistor 
(FET). In general, Vceq and Vdsq are usually taken at half the system supply voltage 
for small-signal amplifier design [1–3]. Hence, once Q point is selected, designer is 
required to determine Icq and Idq.
After operating point is determined via DC biasing circuit, S parameters must 
be obtained at the operating Q point and the desired operating frequency, because 

140
Linear and Switch-Mode RF Power Amplifiers
PA
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–1
–0.5
0
0.5
1
vi(t) = sin(2π 5t)
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
20
40
60
80
Power spectrum of vi(t)
Frequency [Hz]
Power
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–10
0
10
20
vo(t) = 10sin(2π 5t)+2sin2(2π 5t)
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
200
400
600
800
Power spectrum of vo(t)
Frequency [Hz]
Power
fo
2fo
fo
DC
FIGURE 4.14  Second-order nonlinear amplifier output response that has components at DC, f, and 2f.
www.ebook3000.com

141
Small-Signal Amplifiers
PA
fo
3 fo
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–1
–0.5
0
0.5
1
vi(t) = sin(2π 5t)
vo(t) = 10sin(2π 5t)–3sin3(2π 5t)
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
20
40
60
80
Power spectrum of vi(t)
Frequency [Hz]
Power
fo
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–10
–5
0
5
10
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
200
400
600
Power spectrum of vo(t)
Frequency [Hz]
Power
FIGURE 4.15  Third-order nonlinear amplifier output response that has components at f and 3f.

142
Linear and Switch-Mode RF Power Amplifiers
PA
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–1
–0.5
0
0.5
1
vi(t) = sin (2π 5t)
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
20
40
60
80
Power spectrum of vi(t)
Frequency [Hz]
Power
fo
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
–10
–5
0
5
10
vo(t) = 10 sin(2π 5t) + 2 sin2(2π 5t)–3sin3(2π 5t)
Time [s]
Amplitude
0
10
20
30
40
50
60
70
80
0
200
400
600
Power spectrum of vo(t)
Frequency [Hz]
Power
DC
fo 2 fo 3 fo
FIGURE 4.16  Nonlinear amplifier response that has second and third-order nonlinearities.
www.ebook3000.com

143
Small-Signal Amplifiers
S parameters vary significantly based on the operating conditions. S parameters are 
provided by the manufacturer of the transistor most of the time. When DC bias-
ing circuit is designed and S parameters are obtained, small-signal amplifier is then 
designed following the design stages that will be outlined in Section 4.2.4.
4.2.1  DC Biasing Circuits
Let us consider the BJT circuit given in Figure 4.17. When there is only DC source in 
the circuit, the ic and vCE curve can be obtained as shown in Figure 4.18. 
If the circuit shown in Figure 4.17 is revised and AC sinusoidal source with ampli-
tude ΔVBB is introduced as shown in Figure 4.19, the base current and collector cur-
rent will change to iB + ΔiB cos (ωt) and iC + ΔiC cos (ωt), respectively. Similarly, the 
collector-to-emitter voltage will change as vCE + ΔvCE cos (ωt).
VBB
RB
iB
VBE
+
iE
VCC
RC
iC
+
+
–
VCE
FIGURE 4.17  BJT circuit with only DC source.
0
50
IC [mA]
VCE [V]
5
10
15
IB = 230 [µA]
IB = 190 [µA]
IB = 150 [µA]
IB = 110 [µA]
IB = 75 [µA]
IB = 35 [µA]
VCE =VCC – ICRC
Q (ICq,VCEq)
FIGURE 4.18  ic and vCE curve for DC bias.

144
Linear and Switch-Mode RF Power Amplifiers
Consider the operational conditions for the BJT circuit under DC excitation as 
shown in Figure 4.18. Based on the given information, IB = 150 [μA], IC = 23 [mA], 
and VCE = 7.5 [V] at Q point. When AC source is applied with DC excitation, base 
current, collector, and collector-to-emitter voltage change to
	
+ ∆
=
+
ω
i
i
t
150
40cos(
)[mA]
B
B
 
	
+ ∆
=
+
ω
i
i
t
22
7cos(
)[mA]
c
c
 
	
+ ∆
=
−
ω
v
v
t
7.5
2.5cos(
)[V]
CE
CE
 
This indicates that the base current will swing between 110 and 190 [μA]. One 
important criterion is to keep the operating points on the load line during swing 
of the current or voltage. When base current reaches its peak value to 190 [μA], 
collector-to-emitter voltage, VCE, becomes around 4.5 [V], and collector current is 
equal to 29 [mA]. These changes can be illustrated in Figure 4.20.
∆VBBCos(ωt)
RB iB + ∆iBCos(ωt)
iC + ∆iCCos(ωt)
vCE + ∆vCECos(ωt)
VBE + ∆VBECos(ωt)
+
iE
VCC
RC
+
VBB
+
–
+
–
FIGURE 4.19  BJT circuit with DC and AC sources.
Q(ICq ,VCEq)
0
50
IC[mA]
VCE[V]
5
10
15
IB = 230 [µA]
IB = 190 [µA]
IB = 150 [µA]
IB = 110 [µA]
IB = 75 [µA]
IB = 35 [µA]
VCE=VCC–ICRC
22
29
15
4.5
9.5
FIGURE 4.20  ic and vCE curve with DC and AC sources.
www.ebook3000.com

145
Small-Signal Amplifiers
As seen from Figure 4.20, signal is amplified with the implementation of AC 
source. This is valid when the transistor, BJT, operates in the active region. If base 
current is increased further, the swing for the current will reach the value that will 
take transistor into the cutoff region.
4.2.2  BJT Biasing Circuits
There are typical biasing circuits that are used for amplifiers with BJTs. These bias-
ing circuits can be referred to as (1) fixed bias, (2) stable bias, (3) emitter bias, and 
(4) self-bias.
4.2.2.1  Fixed Bias
Consider the common emitter configuration for the amplifier circuit given in 
Figure 4.21. Coupling capacitors are used to isolate the circuit from other circuits 
that are connected at the output and input of the amplifier. The common practice for 
this type of biasing circuit is to have VBB and VC equal to each other, so that it can 
be supplied from the single source. The idea of using the simple biasing circuit is to 
set a constant base current. However, this makes it very sensitive to gain variations, 
which then can be improved to some degree with R1 and R2. If BJT is assumed to 
be operating in the active linear region and VBB = VC, the circuit can be analyzed as 
follows: In our analysis, let us assume R1 → 0. So,
	
=
+
V
I R
V
B
C
2
BE 	
(4.55)
which leads to
	
=
−
I
V
V
R
B
C
BE
2
	
(4.56)
So,
	
= β
= β
−
I
I
V
V
R
C
B
C
BE
2
	
(4.57)
R2
iB
iE
VC
RC
+
vCE
VBB
+
iC
vBE
R1
FIGURE 4.21  Fixed bias BJT circuit.

146
Linear and Switch-Mode RF Power Amplifiers
Collector-to-emitter voltage can be from
	
=
+
V
I R
V
C
C
C
CE 	
(4.58)
which leads to
	
=
−
V
V
I R
CE
C
C
C 	
(4.59)
When Equation 4.57 is substituted into Equation 4.59, we obtain
	
=
−
β
−




V
V
R
V
V
R
CE
C
C
C
BE
2
	
(4.60)
Example 4.6
Calculate R1 and RC for the fixed biasing circuit given in Figure 4.21, when β = 100 
and VC = 15 [V] to have the Q point at VCE = 7.5 [V] and IC = 25 [mA].
Solution: From Equation 4.55,
	
R
V
V
I
15
0.7
0.25
10
57.2[k ]
2
C
BE
B
3
=
−
=
−
×
=
Ω
−
RC can be calculated from Equation 4.59 as
	
R
V
V
I
15
7.5
25
10
300 [ ]
C
C
CE
C
3
=
−
=
−
×
=
Ω
−
4.2.2.2  Stable Bias
The stable bias circuit is different from the fixed bias circuit with the addition of the 
resistor between base and ground. R3 can be adjusted with R2 so that large improve-
ment over stability can be achieved. Thevenin’s theorem can be used to simplify 
the circuit shown in Figure 4.22 as illustrated in Figure 4.23. Typically, R2 is 2 to 10 
times greater than R3.
In Figure 4.23,
	
=
+
V
R
R
R V
TH
3
2
3
CC 	
(4.61a)
and
	
=
+
R
R R
R
R
B
2
3
2
3
	
(4.61b)
The stability in the circuit shown in Figure 4.23 can be described as follows. If the 
temperature increases, this will cause β to increase and results in an increase in 
collector current, IC, and emitter current, IE, beyond the desired operational val-
ues. However, because VTH and RB are fixed and do not vary, base current, IB, will 
reduce and lower collector current, IC, back to its original desired value. Therefore, 
www.ebook3000.com

147
Small-Signal Amplifiers
the stability of the biasing network is satisfied with this method. We can assume in 
the circuit that
	
≈
= β
I
I
I
E
C
B 	
(4.62)
In addition,
	
=
+
+
V
I R
V
I R
TH
B
B
BE
E
1 	
(4.63)
So,
	
=
−
+ β
I
V
V
R
R
B
TH
BE
B
1
	
(4.64)
R2
iB
iE
VC
RC
+
vCE
VBB
+
iC
vBE
R1
R3
FIGURE 4.22  Stable bias circuit.
RB
iB
iE
VC
RC
+
vCE
VTH
+
+
–
iC
vBE
R1
FIGURE 4.23  Simplified stable bias circuit.

148
Linear and Switch-Mode RF Power Amplifiers
and
	
=
+
+
V
I R
V
I R
C
C
C
CE
E
1	
(4.65)
which leads to
	
(
)
=
−
+
V
V
I
R
R
CE
C
C
C
1 	
(4.66)
For feedback to be effective to have the stability,
	
β
R
R
B
1 	
(4.67)
Hence,
	
≈
−
β
I
V
V
R
B
TH
BE
1
	
(4.68)
So,
	
≈
−
I
V
V
R
C
TH
BE
1
	
(4.69)
and
	
(
)
(
)
=
−
+
≈
−
+
−
V
V
I
R
R
V
R
R
R
V
V
CE
C
C
C
1
C
C
1
1
TH
BE 	
(4.70)
It is clear from Equation 4.70 that IC and VCE do not depend on β anymore, which 
makes this circuit immune to the changes in β.
Example 4.7
Design a stable bias circuit shown in Figure 4.23 with a Q point of IC = 1.5 [mA] 
and VCE = 7.5 V when the DC gain of the transistor, β, ranges from 50 to 200.
Solution: We first find the collector supply voltage, VC. Because we desire Q point 
located in the middle of the load line, then
	
V
V
2
2 7.5
15[V]
C
CE
(
)
=
=
=
RC and R1 can be calculated from Equation 4.66 as
	
R
R
V
V
I
7.5
1.5
10
5[k ]
C
1
C
CE
C
3
+
=
−
=
×
=
Ω
−
The designer can choose RC and R1 for the circuit. Let
	
R
R
4 [k ] and
1 [k ]
C
1
=
Ω
=
Ω 
www.ebook3000.com

149
Small-Signal Amplifiers
We now need to find the base resistor, RB, in Figure 4.23. It needs to satisfy the 
condition given in Equation 4.67. Then, we can get the lowest value of β = 50, and
	
R
R
R
0.1 50 1000
5[k ]
B
1
B

(
)(
)
β
→
=
=
Ω
From Equation 4.69,
	
V
I R
V
1.5
10 (1 10
)
0.7
2.2[V]
TH
C
1
BE
3
3
≈
+
=
×
×
+
=
−
−
At this point, we can calculate R3 and R2 from Equation 4.61 as
	
V
V
R
R
R
R
R R
R
R
0.147 and
5000
TH
C
3
2
3
B
2
3
2
3
=
+
=
=
+
=
 
Solution of the foregoing equation for R3 and R2 gives
	
R
R
R
R
5.8
24.734 [k ]and
4.264 [k ]
2
3
2
3
=
→
=
Ω
=
Ω
4.2.2.3  Self-Bias
In self-bias, RC is connected through another resistor to the base of the circuit as 
feedback resistor. Because the voltage at the collector is lower than the fixed bias 
where it is directly supplied from VC, the value of R2 needs to be smaller. Let us 
analyze this circuit by assuming that BJT is operating in the linear active region, and 
RC → 0. Since 

I
I
B
C, then
	
=
+
≈
I
I
I
I
1
C
B
C 	
(4.71)
Since
	
=
+
+
V
I R
V
I R
C
C
C
BE
B
2 	
(4.72a)
or
	
(
)
=
+
β +
V
I
R
R
V
/
C
C
C
2
BE 	
(4.72b)
and hence,
	
=
−
+
β
I
V
V
R
R /
C
C
BE
C
2
	
(4.73)
If we assume 

β
R
R
/
C
B
 and VBE = Vγ, then
	
=
−
γ
I
V
V
R
C
C
C
	
(4.74)
Because the collector current does not depend on β, the bias point remains stable. 
The operational point in the active region can be checked to see whether VCE > Vγ 
using

150
Linear and Switch-Mode RF Power Amplifiers
	
=
+
=
+
>
γ
γ
V
R I
V
R I
V
V
CE
2 B
BE
2 B
	
(4.75)
Equation 4.75 confirms that BJT is operating in the active region. The impact of the 
self-bias circuit can be understood better if we rewrite Equation 4.72a as
	
=
−
−
=
−
−
γ
I
V
V
I R
R
V
V
I R
R
B
C
BE
C
C
2
C
C
C
2
	
(4.76)
If β increases due to temperature change, the collector current will increase, and 
eventually, base current, IB, will reduce. When IB reduces, this will cause collec-
tor current, IC, to drop. Hence, this will self-stable the change due to variation in β 
(Figure 4.24).
4.2.2.4  Emitter Bias
The most stable operating point can be achieved if the base of BJT circuit with com-
mon emitter configuration is grounded via R2, and emitter is connected to another 
supply voltage as long as 
β
R
R
2
1. This can be verified by analyzing the circuit as
	
+
+
−
=
R I
V
R I
V
0
2 B
BE
1 E
E
	
(4.77)
Since
	
≈
= β
I
I
I
E
C
B 	
(4.78)
then
	
β +
=
−
=
−
+
β
R I
R I
V
V
I
V
V
R
R
or
/
2
E
1 E
E
BE
E
E
BE
1
2
	
(4.79)
With the condition, such as 
β
R
R
2
1, we also obtain
	
≈
≈
−
=
=
I
I
V
V
R
k
constant
C
E
E
BE
1
1
	
(4.80)
R2
iB
iE
RC
+
vCE
+
iC
vBE
R1
i1
FIGURE 4.24  Self-bias circuit.
www.ebook3000.com

151
Small-Signal Amplifiers
So,
	
=
+
+
−
V
I R
V
I R
V
C
C
C
CE
E
1
E 	
(4.81)
which leads to
	
(
)
=
+
−
+
=
=
V
V
V
I
R
R
k
constant
CE
C
E
C
1
C
2
	
(4.82)
Hence, it is obvious from Equations 4.79, 4.80, and 4.82 that IE, IC, and VCE do not 
depend on β, which shows having stable operation (Figure 4.25).
4.2.2.5  Active Bias Circuit
There are several other different biasing circuits that can be applied for BJTs and 
FETs. One of the methods to compensate for temperature variation in the biasing 
circuit is to use diodes.
For better temperature compensation, one of the methods used is implementation 
of diodes for compensation. The compensation of the temperature is achieved by 
the reduction of the internal resistance of diode against temperature increase. When 
temperature increases, diode’s forward voltage reduces and causes base-to-emitter 
voltage to get lowered and compensate the effect of the increase in current due to 
temperature elevation. The biasing circuit using two diodes to accomplish this task 
is illustrated in Figure 4.26. The circuit shown in Figure 4.26a can be enhanced, and 
the number of components can be minimized by using active biasing controller IC 
such as BCR 400 by Siemens as shown in Figure 4.26b. This kind of biasing IC is 
able to supply stable bias current even at low supply voltage.
4.2.2.6  Bias Circuit Using Linear Regulator
If the bias voltage is desired to be independent of variations in the power supply, 
then bias circuit with linear regulator is a good option. In the sample bias circuit 
using linear regulator shown in Figure 4.27, temperature compensation is done using 
diode D1.
R2
iB
iE
VC
RC
+
vCE
–VE
+
iC
vBE
R1
FIGURE 4.25  Emitter bias circuit.

152
Linear and Switch-Mode RF Power Amplifiers
R2
iB
iE
VC
RC
+
vCE
–VE
+
iC
vBE
R1
VB
R3
(a)
D1
D2
iB
iE
VC
RC
+
vCE
+
iC
vBE
3
4
1
2
(b)
C1
Rext
BCR 400
FIGURE 4.26  (a) Bias circuit with temperature-compensating diodes and (b) active bias 
circuit with BCR 400.
Vin
Q
D1
D2
LM 723
10
12
11
13
7
2
3
4
5
6
Vbias
C
R1
R2
R3
R4
R5
R6
R7
FIGURE 4.27  Bias circuit using linear regulator.
www.ebook3000.com

153
Small-Signal Amplifiers
4.2.3  FET Biasing Circuits
The biasing circuits for FETs can be constructed similar to circuits for BJTs. The bias 
circuit utilizing linear regulator shown in Figure 4.27 can also be applied for FETs. 
The important difference between FET and BJT circuits is that insignificantly small 
gate current flows with an application of input signal to gate; so the drain current can 
be assumed to be always equal to the source current. This enables FET circuits to be 
biased at their operating currents, which can be varied by the resistor connected to 
source, because it is always negative with respect to source voltage. The collection of 
similar biasing circuits for common source FETs are shown in Figure 4.28.
4.2.4  Small-Signal Amplifier Design Method
The design process begins with the selection of the operating points for the transistor 
as it was detailed in Section 4.2.3. Because the operating points for voltage and current 
R2
(a)
(c)
(d)
(b)
VD
RD
+
VG
R1
R3
Vds
iD
R2
VD
RD
+
vDS
+
iD
vGS
R1
i1
R2
VD
RD
+
vDS
–VS
+
iD
vGS
R1
1
2
3
4
BCR 400
1 [nF]
100 [kΩ]
100 [kΩ]
–VG
RFout
RFin
100 [pF]
VS
Rext
FIGURE 4.28  (a) Stable bias circuit, (b) self-bias circuit, (c) source bias circuit, and (d) 
active bias circuit.

154
Linear and Switch-Mode RF Power Amplifiers
are identified for the transistor, S parameters that are supplied by the manufacturer need 
to be obtained or measured. After S parameters are obtained or measured, it is now 
time to follow step-by-step design procedure to implement the small-signal amplifier. 
There are specific quantities and terms that will be used in the design of small-signal 
amplifiers. These terms and quantities will be explained in Section 4.2.4.1.
4.2.4.1  Definitions of Power Gains for Small-Signal Amplifiers
Consider the generalized two-port network shown in Figure 4.29. The illustration 
shown in Figure 4.30 in conjunction with Figure 4.29 can help to integrate the appli-
cation of scattering parameters in amplifier design. In the design of small-signal 
amplifiers, three power quantities are used. 
Let us obtain power relations for the circuit in Figure 4.29.
•	 At the input port,
	
(
)
=
+
=
+
=
+ Γ
+
−
+
V
V
Z
Z
Z
V
V
V
1
1
s
in
in
s
1
1
1
in 	
(4.83)
In addition,
	
Γ
=
−
+
Z
Z
Z
Z
in
in
o
in
o
	
(4.84)
	
Γ =
−
+
Z
Z
Z
Z
s
s
o
s
o
	
(4.85)
	
=
+ Γ
−Γ
Z
Z
1
1
in
o
in
in
	
(4.86)
So, from Equations 4.83 through 4.86, we can obtain the following relation:
	
(
)
(
)
=
+ Γ
+
=
−Γ
−Γ Γ
+
+
V
V
Z
Z
Z
V
V
1
1
or
1
2 1
1
in
s
in
in
s
1
s
s
s
in
	
(4.87)
V2
[S] Parameters
transistor
+
ZL
PL
Vs
Zs
V1
+
Γin
Γs
ΓL
Γout
Pin
Source network
Load network
FIGURE 4.29  Generalized two-port network.
www.ebook3000.com

155
Small-Signal Amplifiers
As a result, input power can be written as
	
(
)
(
)
=
−Γ
=
−Γ
−Γ
−Γ Γ
+
P
V
Z
P
V
Z
1
2
1
or
1
8
1
1
1
in
1
2
o
in
2
in
s
2
o
in
2
in
2
s
in
2
	
(4.88)
Available power from source, Pavs, can be found when Γ
= Γ
in
s
* from
	
Γ
=
Γ
=Γ
P
P
(
)
avs
s
in
in
s* 	
(4.89a)
or
	
(
)
Γ
=
=
−Γ
−Γ
Γ
=Γ
P
P
V
Z
(
)
1
8
1
1
avs
s
in
s
2
o
s
2
s
2
in
s*
	
(4.89b)
•	 At the output port,
	
=
+
−
+
+
V
S V
S V
2
21 1
22
2 	
(4.90a)
	
= Γ
+
−
V
V
L
2
2 	
(4.90b)
V2
[S] Parameters
transistor
+
ZL
PL
Vs
Zs
V1
+
ΓL
Γout
Γin
Γs
Pin
Source network
Load network
Vs
Zs
Amplifier
ZL
FIGURE 4.30  Integration of amplifier circuit.

156
Linear and Switch-Mode RF Power Amplifiers
Substituting Equation 4.90b into Equation 4.90a gives
	
V
S V
S
V
V
S V
S
S V
S
V
S V
S
S V
S
or
1
1
1
1
or
1
1
1
1
2
21 1
22
L
2
2
21 1
22
L
21 s
s
22
L
s
in
2
21 1
22
L
21 s
s
22
L
s
in
(
)
(
)(
)
(
)
(
)(
)
=
+
Γ
=
−
Γ
=
−Γ
−
Γ
−Γ Γ
=
−
Γ
=
−Γ
−
Γ
−Γ Γ
−
+
−
−
+
−
+
	
(4.91)
Then,
	
(
)
(
)
(
)
=
−Γ
=
−Γ
−
Γ
−Γ Γ
−Γ
−
P
V
Z
P
V
Z
S
S
1
2
1
or
1
8
1
1
1
1
L
2
2
o
L
2
L
s
2
o
21
2
s
2
22
L
2
s
in
L
2  	
(4.92)
Available power from network, Pavn, can be found when Γ = Γ
L
out
*  from
	
Γ
=
Γ =Γ
P
P
(
)
avn
out
L
L
out
* 	
(4.93a)
or
	
(
)
(
)
Γ
=
=
−Γ
−
Γ
−Γ Γ
−Γ
Γ =Γ
P
P
V
Z
S
S
(
)
1
8
1
1
1
1
avn
out
L
s
2
o
21
2
s
2
22
out
*
2
s
in
out
2
L
out
*
	
(4.93b)
Since,
	
Γ
=
+
Γ
−
Γ
=
−
Γ +
Γ
−
Γ
S
S S
S
S
S S
S S
S
1
1
in
11
12
21
L
22
L
11
11 22
L
12
21
L
22
L
	
(4.94)
Substituting Equation 4.94 into Equation 4.93b when Γ = Γ
L
out
*  gives
	
(
)
Γ
=
=
−Γ
−
Γ
−Γ
Γ =Γ
P
P
V
Z
S
S
(
)
1
8
1
1
1
avn
out
L
s
2
o
21
2
s
2
11
s
2
out
2 2
L
out
*
	
(4.95)
There are three important power quantities that need to be known. They are operat-
ing power gain, Gp, available power gain, GA, and transducer power gain, GT.
•	 Transducer Gain
Transducer gain, GT, is the ratio of the time-averaged power dissipated at the load 
and the maximally available time-averaged power from the source
	
=
G
P
P
T
L
avs
	
(4.96)
www.ebook3000.com

157
Small-Signal Amplifiers
Substituting Equations 4.92 and 4.89b into Equation 4.96 gives
	
 



 



(
)
(
)
=
=
−Γ
−Γ Γ
−Γ
−
Γ
G
P
P
S
S
1
1
1
1
T
L
avs
s
2
s
in
2
source
21
2
L
2
22
L
2
load
	
(4.97)
The transducer power gain, GT, is the gain component that is used to understand the 
amplifying level of the amplifier. If there is a specific power gain requirement for the 
design of an amplifier, GT is the quantity that is always referred to.
•	 Operating Gain
Operating gain, Gp, is the ratio of the time-averaged power dissipated a the load to 
the time-averaged power delivered to network and obtained from
	
=
G
P
P
p
L
in
	
(4.98)
Substituting Equations 4.88 and 4.92 into Equation 4.98 gives
	
 



 



(
)
(
)
=
=
−Γ
−Γ
−
Γ
G
P
P
S
S
1
1
1
1
p
L
in
in
2
Source
21
2
L
2
22
L
2
Load
	
(4.99)
•	 Available Gain
Available gain, GA, is the ratio of the maximally available time-averaged power from 
the network to the maximally available time-averaged power from the source and is 
defined by
	
=
G
P
P
A
avn
avs
	
(4.100)
Substituting Equations 4.95 and 4.89b into Equation 4.100 gives
	
 



 



(
)
(
)
=
=
−Γ
−
Γ
−Γ
G
P
P
S
S
1
1
1
1
A
avn
avs
s
2
11
s
2
source
21
2
out
2
load
	
(4.101)
Operating and available power gains, GP and GA, are used as knobs to meet the cer-
tain amplifier transducer gain, GT.
Consider the more general and practical amplifier circuit shown in Figure 4.31. 
If S parameters of the transistor, Γs, and ΓL of the circuit are known, then the gain 
components of the amplifier GP, GA, and GT can be calculated using Equations 4.97, 
4.99, and 4.101.

158
Linear and Switch-Mode RF Power Amplifiers
The reflection coefficients that are used to calculate the gain parameters are
	
Γ =
−
+
Z
Z
Z
Z
s
s
o
s
o
	
 (4.102)
	
Γ =
−
+
Z
Z
Z
Z
L
L
o
L
o
	
(4.103)
	
Γ
=
+
Γ
−
Γ
S
S S
S
1
in
11
12
21
L
22
L
	
(4.104)
	
Γ
=
+
Γ
−
Γ
S
S S
S
1
out
22
12
21
s
11
s
	
(4.105)
4.2.4.2  Design Steps for Small-Signal Amplifier
The following design steps, when followed, will simplify the design of small-signal 
amplifiers:
	
1.	Design the biasing circuit based on transistor manufacturer datasheet
	
2.	Obtain S parameters at bias conditions
	
3.	Investigate the stability of the transistor. Check the stability using Rollet 
stability factor k. If |k| > 1 and |Δ| < 1, then this implies that the transistor is 
unconditionally stable.
	
4.	If the transistor is unconditionally stable, then design amplifier for gain.
	
5.	If the condition mentioned in step 3 for unconditional stability is not met, 
then the transistor is potentially stable. If the transistor is potentially stable, 
draw source and load stability circles by calculating the center points and 
radii for input and output stability circles in Smith chart: rin, Cin, and rout, Cout.
	
6.	Calculate whether ΓL and Γs lie in an unstable region. If they lie in a stable 
region, then nothing more needs to be done for stability.
[S] Parameters
transistor
ZL
Vs
Zs
ΓL
Γout
Γin
Γs
Source network
Load network
Input
matching
network
Input
matching
network
FIGURE 4.31  General two-port amplifier network.
www.ebook3000.com

159
Small-Signal Amplifiers
	
7.	If ΓL and Γs lie in an unstable region, then shunt or series resistances need to 
be added at the input and/or output to move S22
*  and/or S11
*  into stable region.
	
8.	Adjust the gain of the amplifier if needed by ΓL or Γs.
	
9.	Plot the input and output gain circles for unilateral case if S12 → 0. Use 
transducer power gain Equation 4.97. The specified gain must be less than 
the maximum unilateral gain, GTUmax.
	 10.	If S12 ≠ 0, then the design of the amplifier using the unilateral method (to 
have control of selective mismatch at the input and output) can be done by 
investigating the maximum error based on the Unilateral Figure of Merit to 
determine whether the method could be applied.
	 11.	If unilateral method cannot be applied, then the designer should proceed 
with the bilateral design method.
The aforementioned steps are simplified and illustrated in Figure 4.32.
4.2.4.3  Small-Signal Amplifier Stability
The stability analysis for amplifiers is necessary to measure the amplifier’s resis-
tance against oscillations. The oscillations may occur if reflected signals at the input 
or output port increase their magnitudes while they are reflected between an active 
port and its termination continuously. Oscillations in an amplifier are not desired 
because when they occur, the characteristic of the amplifier changes drastically. 
Scattering parameters become no longer valid, and hence circuit does not perform 
as expected. This may result in a catastrophic failure and may damage active device 
and surrounding components.
Start
Define
-Center frequency
-Power gain
-Noise figure
-Sourece/load impedance 
-Bandwidth
-VSWR
Select 
transistor
Design DC
biasing circuit
Get S parameters
within frequency range
Perform
stability analysis
K > 1 and |∆| < 1 ?
No
End
Amplifier
unconditionaly stable
Draw stability circles
Circles intersect
Smith chart ?
No
Amplifier
is not stable
Find |S11| and |S22|
Yes
-Perform stabilization
-Redesign DC bias circuit
-Choose new transistor
Amplifier potentially stable
Find stable regions
Design matching networks
Check gain, noise figure,
bandwdth, VSWR
Tunning and
optimization
FIGURE 4.32  Small-signal amplifier design method illustration.

160
Linear and Switch-Mode RF Power Amplifiers
4.2.4.3.1  Unconditional Stability
When amplifier remains stable throughout the entire cycle under the operating condi-
tions and frequency, the amplifier is said to be unconditionally stable. Unconditional 
stability can be satisfied for any passive source and load when
	
Γ <1
s
	
(4.106a)
and
	
Γ
<1
L
	
(4.106b)
Having negative resistance can be avoided if
	
Γ Γ
<1
s
in
	
(4.107a)
	
Γ Γ
<1
L
out
	
(4.107b)
So,
	
Γ
=
+
Γ
−
Γ
<
S
S S
S
1
1
in
11
12
21
L
22
L
	
(4.108)
	
Γ
=
+
Γ
−
Γ
<
S
S S
S
1
1
out
22
12
21
s
11
s
	
(4.109)
A two-port network is said to be unconditionally stable at a given frequency if
	
{
}
{
}
>
>
Z
Z
Re
0 and Re
0
in
out
	
(4.110)
In practice, Roulette’s Stability Factor, k, and determinant of the scattering matrix of 
the active device, |Δ|, can also be used to test the unconditional stability of two-port 
networks using the following equations:
	
=
+ ∆−
−
>
k
S
S
S
S
1
2
1
2
11
2
22
2
21
12
	
(4.111)
	
∆=
−
<
S S
S S
1
22 11
12
21
	
(4.112)
4.2.4.3.2  Stability Circles
We can investigate the stability of the amplifier graphically by studying the stability 
circles on the Smith chart.
4.2.4.3.2.1    Output Stability Circle  ΓL or load plane on the Smith chart is defined 
by output stability circles where the boundaries are defined between |ΓL| < 1 (stable) 
and |ΓL| < 1 (unstable). This can be found by solving between Γs in the following 
equation:
	
Γ
=
+
Γ
−
Γ
=
S
S S
S
1
1
in
11
12
21
L
22
L
	
(4.113)
www.ebook3000.com

161
Small-Signal Amplifiers
Solution of Equation 4.113 lies on a circle with radius
	
=
−∆
r
S S
S
L
12
21
22
2
2 	
(4.114)
center
	
(
)
=
−∆
−∆
c
S
S
S
L
22
11
*
*
22
2
2
	
(4.115)
where
	
∆=
−
S S
S S
22 11
12
21 	
(4.116)
The circles formed by Equations 4.113 through 4.115 establish stability regions for 
the output. This can be done by plotting ΓL circle and investigating the intersection 
of this circle with the Smith chart. If the circle intersects the Smith chart, then there 
is an instability region defined by the boundary. If there is no intersection, it means 
the device is unconditionally stable. The graphical illustration of the stability regions 
is given in Figure 4.33. The region inside the Smith chart, where |S11| < 1, represents 
the stable region (represented by shaded regions in Figure 4.33).
4.2.4.3.2.2    Input Stability Circle  Γs or source plane on the Smith chart is defined 
by input stability circles, where the boundaries are defined between |Γs| < 1 (stable) 
and |Γs| < 1 (unstable). This can be found by solving between ΓL in the following 
equation:
	
Γ
=
+
Γ
−
Γ
=
S
S S
S
1
1
out
22
12
21
s
11
s
	
(4.117)
<1
Γin
Γin >1
CL
rL
Γin =1
=1
S11
Γin >1
CL
rL
Γin
S11 >1
<1
Γin
Stable
(a)
(b)
Stable
<1
FIGURE 4.33  Smith chart illustrating output stability regions.

162
Linear and Switch-Mode RF Power Amplifiers
Solution of Equation 4.117 lies on a circle with radius and center as
	
=
−∆
r
S S
S
s
12
21
11
2
2 	
(4.118)
	
(
)
=
−∆
−∆
c
S
S
S
s
11
22
*
*
11
2
2
	
(4.119)
The circles formed by Equations 4.117 through 4.119 establish stability regions for 
the input. This can be done by plotting Γs circle and investigating the intersection of 
this circle with the Smith chart. The graphical illustration of the stability regions for 
input is given in Figure 4.34.
If the device is unconditionally stable, then there is no intersection of the circle 
with the Smith chart. This can be shown by Figure 4.35.
Example 4.8
S parameters of a transistor at 800 MHz are given to be S11 = 0.68 < −72°, S12 = 0.18 
< −14°, S21 = 4.5 < 82°, and S22 = 0.65 < −42°. Determine the stability of the device, 
and draw the stability circles if the device is potentially stable.
Solution: Rollet’s stability factor k and Δ are calculated from Equations 4.111 to 
4.112 and found to be k = 1.0381 > 1. However, because Δ > 1.2509, the device is 
still potentially unstable. The stability circles will then be inside the Smith chart. 
In addition, the scattering parameters |S11| < 1 and |S22| < 1 show that inside these 
>1
Cs
rs
=1
Γout
=1
Γout
Γout
<1
Γout
Γout
Γout
S22 <1
S11 >1
Cs
rs
>1
Stable
(a)
(b)
Stable
<1
FIGURE 4.34  Smith chart illustrating input stability regions.
www.ebook3000.com

163
Small-Signal Amplifiers
circles are stable, and the point ΓL = 0 remains in the stable region. The parameters 
of stability circles from Equations 4.113 to 4.119 have to be calculated to plot them. 
The calculation of the radius and center point for input stability circle are
	
r
C
j
0.7340 and
0.5575
1.0801
s
s
=
=
−
 
The radius and center point for output stability circle are
	
r
C
j
0.7083 and
0.1927
1.0889
L
L
=
= −
−
The results showing the stability circles and stable regions are shown in Figure 4.36.
4.2.4.3.3  Stabilization of Amplifier
In Figure 4.37, the stability in the circuit exits if
	
Γ
=
+
Γ
−
Γ
<
S
S S
S
1
1
in
11
12
21
L
22
L
	
(4.120a)
	
Γ
=
+
Γ
−
Γ
<
S
S S
S
1
1
out
22
12
21
s
11
s
	
(4.120b)
If Γ
>1
in
 and Γ
>1
out
, then this indicates the condition for instability. Γin and Γout 
can also be represented in terms of impedances as
	
Γ
=
−
+
>
Z
Z
Z
Z
1
in
in
o
in
o
	
(4.121a)
	
Γ
=
−
+
>
Z
Z
Z
Z
1
out
out
o
out
o
	
(4.121b)
CL
rL
S11 <1
S22 <1
CL
Cs
rs
Cs
(a)
(b)
FIGURE 4.35  Unconditional stability (a) ΓL plane and (b) Γs plane.

164
Linear and Switch-Mode RF Power Amplifiers
The Equation 4.121 imply that
	
{
}
{
}
<
<
Z
Z
Re
0 or Re
0
in
out
	
(4.122)
Reexpress Equation 4.121 as
	
(
)
(
)
(
)
(
)
Γ
=
−
+
+
+
→Γ
=
−
+
+
+
R
Z
jX
R
Z
jX
R
Z
X
R
Z
X
in
in
o
in
in
o
in
in
in
o
2
in
2
in
o
2
in
2 	
(4.123)
Equation 4.123 shows that then the amplifier can be stabilized by adding series resis-
tance or shunt conductance to source side to make the real part of the impedance 
positive. This can be similarly done for the load network, which gives
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
Input stability
Output stability
Stable
∞
FIGURE 4.36  Stability circles for Example 4.8.
2-Port network
ΓL
Γout
Γin
Γs
Source network
Load network
FIGURE 4.37  Two-port network for stabilization.
www.ebook3000.com

165
Small-Signal Amplifiers
	
(
)
(
)
(
)
(
)
Γ
=
−
+
+
+
→Γ
=
−
+
+
+
R
Z
jX
R
Z
jX
R
Z
X
R
Z
X
in
out
o
out
out
o
out
in
out
o
2
out
2
out
o
2
out
2
	
(4.124)
The addition of the stability components at the source and load is illustrated in 
Figures 4.38 and 4.39. This can be better understood by a simple illustrative exam-
ple. Assume we have an amplifier with certain load impedance and load stability 
circle as shown in Figure 4.40. If we insert a series resistance of 15 Ω, we can then 
limit the stability region to Z′, where R = 15 circle is tangential to the output stability 
circle in Figure 4.40. The stabilization can also be done by using shunt conductance 
(as shown in Figure 4.41).
Assume we have an amplifier with certain load impedance and load stability 
circle as shown in Figure 4.41. If we insert a shunt resistance of 400 Ω, we can then 
limit the stability region to Y′, where G = 0.0025 circle is tangential to the output 
stability circle in Figure 4.41.
4.2.4.4  Constant Gain Circles
4.2.4.4.1  Unilateral Case
When |S12| → 0, the condition of the two-port network is called as unilateral. It is 
practical to obtain and plot the gain stability circles for unilateral devices. Under 
unilateral condition, Γin from Equation 4.104 becomes
2-Port network
Zin
Source network
Load network
Zin + R΄in
Zout
Zout + R΄out
R΄in
R΄out
FIGURE 4.38  Stabilization network by adding series resistance.
2-Port network
Source network
Load network
G΄in
G΄out
Yin+ G΄in Yin
Yout +G΄out
Yout
FIGURE 4.39  Stabilization network by adding shunt conductance.

166
Linear and Switch-Mode RF Power Amplifiers
	
Γ
=
+
Γ
−
Γ
→Γ
=
S
S S
S
S
1
in
11
12
21
L
22
L
in
11 	
(4.125)
Substituting Equation 4.125 in Equation 4.104 gives transducer gain of the unilateral 
device as
	
 



 




(
)
(
)
=
−Γ
−Γ
−Γ
−
Γ
G
S
S
S
1
1
1
1
G
G
G
T
s
2
s 11
2
21
2
L
2
22
L
2
s
o
L
	
(4.126)
Equation 4.126 can be expressed as
	
=
G
G G G
T
s
o
L 	
(4.127a)
Z΄ = ZL + 15[Ω]
15[Ω]
Stable region
Unstable 
region
Output stability circle
R = 15[Ω] Circle
FIGURE 4.40  Stabilization with series resistor at the load.
Y΄= YL + 0.0025[S]
Stable region
Unstable
region
Output stability circle
400[Ω]
G = 0.0025 Circle
FIGURE 4.41  Stabilization with shunt conductance at the load.
www.ebook3000.com

167
Small-Signal Amplifiers
Or 
	
=
+
+
G
G
G
G
[dB]
[dB]
[dB]
[dB]
T
s
o
L
	
(4.127b)
where
	
(
)
=
−Γ
−Γ
G
S
1
1
s
s
2
s 11
2 	
(4.128)
	
=
G
S
o
21
2 	
(4.129)
	
(
)
=
−Γ
−
Γ
G
S
1
1
1
L
L
2
22
L
2
	
(4.130)
Gs and GL are the gain contributions for input and output matching networks, 
respectively. GL is the gain of the transistor as shown in Figure 4.42. In terms of dB, 
Equation 4.127 can be written as
	
=
+
+
G
G
G
G
[dB]
[dB]
[dB]
[dB]
T
s
o
L
	
(4.131)
The power transfer for the unilateral case can be maximized when both input and 
output ports of the amplifier are conjugately matched as:
	
Γ = S
s
11
* 	
(4.132)
	
Γ = S
L
22
* 	
(4.133)
When simultaneous conjugate match is accomplished, the maximum value of the 
gain is obtained, and the following relation holds:
	
=
=
G
G
G
Tmax
pmax
Amax 	
(4.134)
[S] Parameters
transistor
ZL
Vs
Zs
ΓL
S22
S11
Γs
Source network
Load network
Input
matching
network
Input
matching
network
Gs
Go
GL
FIGURE 4.42  Unilateral amplifier design.

168
Linear and Switch-Mode RF Power Amplifiers
So,
	
=
=
−
−
G
G
G G
S
S
S
1
1
1
1
T,max
s,max
o
L,max
11
2
21
2
22
2 	
(4.135)
where
	
=
−
G
S
1
1
s,max
11
2 	
(4.136)
	
=
−
G
S
1
1
L,max
22
2 	
(4.137)
Expressions for Gs and GL in Equations 4.136 and 4.137 can be generalized as
	
=
−Γ
−
Γ
G
S
1
1
i
i
ii
i
2
2 	
(4.138a)
	
=
−
G
S
1
1
i
ii
,max
2 	
(4.138b)
where i = s or L and i = 11 or 22. Hence, the design for a specified amplifier gain can 
be done using Equation 4.138. There are two cases to consider under the unilateral 
condition for constant gain amplifier design: |Sii| < 0 → Unconditionally Stable Case 
and |Sii| > 0 → Potentially Stable Case.
4.2.4.4.2  |Sii| < 1 → Unilateral Unconditionally Stable Case
The maximum gain for source and load shown in Equations 4.136 and 4.137 is 
obtained when simultaneous conjugate matching is done using
	
=
−
G
S
1
1
i
ii
,max
2 	
(4.139)
	
Γ = S
i
ii
* 	
(4.140)
When Γ = 1
i
, gain gets its lowest value from Equation 4.138a. The range of the gain 
value for values different from Γ ≠1
i
 is
	
≤
≤
G
G
0
i
i,max 	
(4.141)
The constant gain circles lie inside the Smith chart and are obtained by solving the 
following equation:
	
Γ −
=
C
r
i
i
i
g
g 	
(4.142)
www.ebook3000.com

169
Small-Signal Amplifiers
In Equation 4.142, Cgi represents the center and rgi is the radius of the constant gain 
circle, which are defined by
	
(
)
=
−
−
C
g S
S
g
1
1
i
i
ii
ii
i
g
*
2
	
(4.143)
	
(
)
(
)
=
−
−
−
−
r
g
S
S
g
1
1
1
1
i
i
ii
ii
i
g
2
2
	
(4.144)
where gi is the normalized gain factor and expressed as
	
(
)
=
=
−Γ
−
Γ
−
g
G
G
S
S
1
1
1
i
i
i
i
ii
i
ii
,max
2
2
2 	
(4.145)
where
	
≤
≤
g
0
1
i
	
(4.146)
The gain circles are obtained by the following method:
–	 Plot Sii
* on the Smith chart. Draw a line from the center of the Smith chart to 
Sii
*. This is the point where gain is maximum.
–	 Calculate Gi and normalized gi from Equations 4.138a and 4.145, respectively.
–	 Calculate center and radius points for corresponding Gi using Equations 
4.143 and 4.144, and draw the constant gain circles.
The process of drawing gain circles can be illustrated in Figure 4.43.
S*ii
rgi
Γr
Γi
Γ plane
Cgi
αi=S*ii
FIGURE 4.43  Drawing constant gain circles.

170
Linear and Switch-Mode RF Power Amplifiers
4.2.4.4.3  |Sii| > 1 → Unilateral Potentially Stable Case
When |Sii| > 1, it is possible that constant gain value Gi can take infinite value for the 
critical value of Γi, which is defined as
	
Γ
= S
1
i c
ii
,
	
(4.147)
gi in Equation 4.145 can now take negative values due to the condition created by 
|Sii| > 1. Hence, Γi should be chosen so that real part of the termination impedance 
is greater than the negative resistance at the point defined by 
S
1/
ii
*. The process 
of drawing the gain circles is similar to the process described in the previous 
section.
4.2.4.5  Unilateral Figure of Merit
In practical cases, S12 ≠ 0; so the criteria of unilateral design might not apply. 
However, it is possible to still use the unilateral design procedure by assuming that 
S12 = 0 with error. The error introduced by the approximation can be determined 
using the unilateral Figure of Merit. Consider the ratio of the transducer gain, GT, to 
unilateral transducer gain, GTU. This ratio can be expressed by
	
=
−
G
G
X
1
1
T
TU
2 	
(4.148)
where
	
(
)(
)
=
Γ Γ
−
Γ
−
Γ
X
S S
S
S
1
1
12
21
s
L
11
s
22
L
	
(4.149)
The transducer ratio given in Equation 4.148 is bounded by
	
(
)
(
)
+
<
<
−
X
G
G
X
1
1
1
1
2
T
TU
2 	
(4.150)
The maximum transducer gain occurs by simultaneous conjugate matching Γ = S
s
11
*  
and Γ = S
L
22
* . So, the maximum error is introduced by
	
(
)
(
)
+
<
<
−
U
G
G
U
1
1
1
1
2
T
Tmax
2 	
(4.151)
where
	
(
)(
)
=
−
−
U
S
S
S
S
S
S
1
1
12
21
11
22
11
*
22
*
	
(4.152)
In Equation 4.152, U is known as figure of merit.
www.ebook3000.com

171
Small-Signal Amplifiers
Design Example
Design, simulate, and build a low-noise amplifier operating at 915 MHz using 
the small-signal amplifier design method. The amplifier uses ATF-54143 HEMT as 
transistor, and the S parameters of the device are given in Table 4.3. The amplifier 
is targeted to have a gain larger than 10 dB and a noise figure that is smaller than 
2.5 dB with an operational bandwidth of 15%. ATF-5413 scattering parameters 
provided by the manufacturer are given in Table 4.3. The complete S parameter 
data is available on the manufacturer website [4].
Solution: We follow the small-signal amplifier design process flowchart illustrated 
in Figure 4.32. S parameters are provided by the manufacturer, Avago, for several 
frequencies. Hence, DC biasing circuit needs to be designed. This design problem 
will be simulated by advanced design system (ADS).
Step 1—Select Transistor
The transistor selected to design the low-noise amplifier is ATF-54143. This 
transistor was chosen as it has a wide frequency range, low noise figure, 
high gain, and low cost. ATF-54143 is a high-dynamic-range, low-noise, 
E-PHEMT-type transistor that comes with various packages such as SC-70 
(SOT-343) surface mount plastic package. It is ideal for cellular/personal 
communication service (PCS) base stations, Multichannel Multipoint 
Distribution Service (MMDS), and other systems in the 450 MHz to 6 GHz 
frequency range. Before DC biasing is done, we need to obtain character-
istics curve of the ATF-54143 transistor. The parameter values provided in 
ADS are compared with the transistor parameter values in the datasheet 
provided by the manufacturer and are in close agreement (Figure 4.44).
Step 2—Design DC Bias Circuit
The next stage was to design the DC biasing circuit for the transistor. S param-
eters were provided at specific DC biasing voltages and currents—four 
biasing pairs with independent S parameter values. From the datasheet, 
the S parameters, used to define the power flow, were defined over a 
wide range of frequencies. There is no specific S parameter set defined 
at 915 MHz, but S parameters at 900 MHz are provided earlier. Since 
TABLE 4.3
Scattering Parameters for ATF-54143, VDS = 4 V, IDS = 60 mA
Freq.
S11
S21
S12
S22
MSG/
MAG
GHz
Mag.
Ang.
dB
Mag.
Ang.
Mag.
Ang.
Mag.
Ang.
vdB
0.1
0.99
−18.6
28.88
27.80
167.8
0.01
80.1
0.58
−12.6
34.44
0.5
0.81
−80.2
26.11
20.22
128.3
0.03
52.4
0.42
−52.3
28.29
0.9
0.71
−117.3
23.01
14.15
106.4
0.04
41.7
0.31
−73.3
25.49
1.0
0.69
−123.8
22.33
13.07
102.4
0.04
40.2
0.29
−76.9
25.14
1.5
0.64
−149.2
19.49
9.43
86.2
0.05
36.1
0.22
−89.4
22.76

172
Linear and Switch-Mode RF Power Amplifiers
the S parameter set provided is within 1.66% of the center frequency 
of 915 MHz, it is used in the design. The error observed was minimal 
with a maximum magnitude difference of 0.02 between the parameters 
provided at 1 GHz. A phase difference of less than 10° was noted, which 
also presented a minimal difference in real and imaginary values. With 
the minimal error in magnitude and phase difference presented earlier, 
the usage of the 900 MHz S parameters was satisfactory.
	
The biasing circuit that is recommended to be used for this transistor is 
shown in Figure 4.44b. The equations given to derive component values 
in Figure 4.44b are given in Table 4.4.
Before biasing is done, we need to obtain the characteristics curve of the ATF-54143 
transistor. The transistor model parameters are given in Figure 4.45. The transistor 
(a)
ATF-54143 Die Model
Advanced_curtice2_model
Mesfetmi
Rf=
Crf=0.1 F
Gsfwd=
Gsrev=
Gdfwd=
Gdrev=
R1=
R2=
Vbi=0.8
Vbr=
Vjr=
Is=
Ir=
N=
Fnc=1 MHz
R=0.08
P=0.2
C=0.1
Taumdl=no
wVgfwd=
wBvgs=
wBvgd=
wBvds=
wldsmax=
wPmax=
Allparams=
Imax=
Xti=
Eg=
Gscap=2
Cgs=1.73 pF
Cgd=0.255 pF
Gdcap=2
Fc=0.65
Rgd=0.25 Ohm
Rd=1.0125 Ohm
Rg=1.0 Ohm
Rs=0.3375 Ohm
Ld=
Ls=
Cds=0.27 pF
Rc=250 Ohm
Ld=0.18 nH
Neft=yes
Pfet=no
Vto=0.3
Beta=0.9
Lambda=82e.3
Alpha=13
Tau=
Tnom=16.85
Idstc=
Ucrit=–0.72
Vgexp=1.91
Gamds=1e–4
Vtotc=
Betatce=
Rgs=0.25 Ohm
(b)
C1
Q1
C4
R5
L4
C5
R3
R2
R1
R4
C2
L1
L2
L3
C3
C6
Vdd
FIGURE 4.44  (a) ATF-54143 Die Model provided by Avago [4] and (b) DC biasing 
circuit for ATF-54143 [4].
www.ebook3000.com

173
Small-Signal Amplifiers
I–V characteristics obtained in ADS are compared with the transistor I–V character-
istic provided in the datasheet by the manufacturer (Figure 4.46). The I–V curves, 
which are obtained using ADS, are in close agreement as shown in Figure 4.47.
The biasing circuit simulation results matched with the I–V curves provided 
for the S parameter set in the datasheet when VDS = 4 V and IDS = 60 mA. The 
TABLE 4.4
DC Bias Circuit Design Equations
Component 
Equation
VGS—Voltage gate to source
VDD—Power supply voltage
VDS—Voltage drain to source; target parameter
IDS—Current drain to source; target parameter
IBB = 10 * Igate_leakage; Igate_leakage;
Igate_leakage—Expected gate leakage current
C1, L1
Input matching network
C4, L4
Output matching network
C2, C5
RF bypass
C3, C6
10 [nF]
R1
=
R
V
I
1
GS
BB
R2
(
)
=
−
R
V
V
R
V
2
* 1
DS
GS
GS
R3
=
−
+
R
V
V
I
I
3 
DD
DS
DS
BB
R4
Undefined by datasheet
ATF-54143 Die Model
Advanced_curtice2_model
Mesfetmi
Rf=
Crf=0.1 F
Gsfwd=
Gsrev=
Gdfwd=
Gdrev=
R1=
R2=
Vbi=0.8
Vbr=
Vjr=
Is=
Ir=
N=
Fnc=1 MHz
R=0.08
P=0.2
C=0.1
Taumdl=no
wVgfwd=
wBvgs=
wBvgd=
wBvds=
wldsmax=
wPmax=
Allparams=
Imax=
Xti=
Eg=
Gscap=2
Cgs=1.73 pF
Cgd=0.255 pF
Gdcap=2
Fc=0.65
Rgd=0.25 Ohm
Rd=1.0125 Ohm
Rg=1.0 Ohm
Rs=0.3375 Ohm
Ld=
Ls=
Cds=0.27 pF
Rc=250 Ohm
Ld=0.18 nH
Neft=yes
Pfet=no
Vto=0.3
Beta=0.9
Lambda=82e.3
Alpha=13
Tau=
Tnom=16.85
Idstc=
Ucrit=–0.72
Vgexp=1.91
Gamds=1e–4
Vtotc=
Betatce=
Rgs=0.25 Ohm
FIGURE 4.45  ATF-54143 Die Model provided by Avago.

174
Linear and Switch-Mode RF Power Amplifiers
component values of the final bias circuit and corresponding amplifier component 
values are illustrated in Table 4.5.
Get or Measure S Parameters within Frequency of Range
S parameters are given by the manufacturer as explained in Step 2 and are 
again given below as reference to be used for calculation.
	 S
S
S
S
0.71
117.3 ,
0.04
41.7 ,
14.15
106.4 , and
0.31
73.8 .
11
12
21
22
=
< −
°
=
<
°
=
<
°
=
< −
°
120
100
0.7 V
0.6 V
0.5 V
0.4 V
0.3 V
80
60
40
20
0 0
1
2
3
VDS [V]
Id [mA]
4
5
6
7
FIGURE 4.46  Id vs Vds provided by the manufacturer, Avago [4].
FIGURE 4.47  ATF-54143 Id vs VGS and Id vs VDS obtained from ADS.
www.ebook3000.com

175
Small-Signal Amplifiers
Step 3—Stability Analysis—K
1and|
| 1?
>
∆<
Based on the calculation using Equations 4.111 and 4.112,
	
k
S
S
S
S
S S
S S
1
2
0.4739
1 and
0.3697
1
2
11
2
22
2
21
12
22 11
12
21
=
+ ∆−
−
=
<
∆=
−
=
<
Since, k < 1, the amplifier is potentially unstable. Since the transistor is potentially 
unstable, go to step 5.
Step 5—Draw Stability Circles
Because the amplifier is potentially unstable, we need to draw the stability 
circles. We need to identify whether the amplifier design can be done 
using unilateral design method. It is given that S12 ≠ 0; so we need to 
determine the unilateral figure of merit and the maximum and minimum 
error associated with the assumption of unilateral design. From Equations 
4.151 and 4.152,
	
U
G
G
U
G
G
1
1
1
1
2.13[dB]
2.82[dB]
2
T
Tmax
2
T
Tmax
(
)
(
)
+
<
<
−
→−
<
<
where
	
U
S
S
S
S
S
S
1
1
12
21
11
22
11
*
22
*
(
)(
)
=
−
−
So, the error will be bounded between −2.13 and 2.82 dB if we assume and 
proceed with unilateral design. For this design example, let us proceed 
with this error. However, it is important to note that this type of error is 
significant for applications where gain is critical.
TABLE 4.5
Final Component Values for the 
Amplifier
Part
Value
Qty
C1, C4
5.6 pF (0805)
2
C2, C5
18 pF(0805)
2
C3, C6
10 nF (0805)
2
L1
6.8 nF (LL2012)
1
L2, L3
Shorting strip
2
L4
8.2 nH (LL2012)
1
R1
4.7 kΩ (0805)
1
R2
33 kΩ (0805)
1
R3
27 Ω (0805)
1
R4
56 Ω (0805)
1
R5
330 Ω (0805)
1
Q1
ATF-54143
1

176
Linear and Switch-Mode RF Power Amplifiers
The input and output stability circles are plotted using Equations 4.114 to 4.119. 
The radius and center point calculations are done with MATLAB and plotted as 
shown in Figure 4.48. 
Step 5—Design Matching Network
We need to match the source impedance Zs = 50 Ω, ZL = 50 Ω with S11 = 0.71 
< −117.3°, and S22 = 0.31 < −73.8°. The unilateral design requires match-
ing networks to be designed to follow 
S
i
ii
*
Γ =
. This is used to determine 
matching network components. Hence,
	
S
Z
Z
i
0.71 117.3
1
1
11.5038 +29.2718
s
11
*
sm
o
s
s
Γ =
=
∠
° →
=
+ Γ
−Γ =
Similarly at the output,
	
S
Z
Z
i
0.311 73.8
1
1
48.9587 +32.2482
L
22
*
Lm
o
L
L
Γ =
=
∠
° →
=
+ Γ
−Γ =
At the input, this requires to have series C and shunt L as an input matching 
network as shown in the Smith chart in Figure 4.49. After some tuning, 
when interfaced in the final circuit simulated by ADS, the component 
values are obtained as C = 5.6 [pF] and L =6.8 [nH].
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
∞
Input stability circle
Output stability circle
Stable region
FIGURE 4.48  Input and output stability circles at 915 MHz.
www.ebook3000.com

177
Small-Signal Amplifiers
25.0
10.0
200.0 m
80.0 m
40.0 m
20.0 m
10.0 m
4.0 m
500.0
200.0
100.0
50.0
4.0 m
10.0 m
20.0 m
40.0 m
80.0 m
200.0 m
DP 4
500.0
200.0
100.0
50.0
25.0
DP 3
DP 1
Series C
Shunt L
10.0
C
L
Zsm
50 [Ω]
(a)
(b)
FIGURE 4.49  Input matching circuit.

178
Linear and Switch-Mode RF Power Amplifiers
100.0
200.0
500.0
4.0 m
10.0 m
20.0 m
10.0
25.0
50.0
100.0
200.0
500
40.0 m
80.0 m
200.0 m
10.0
25.0
50.0
4.0 m
10.0 m
20.0 m
Series C
Shunt L
DP 4
DP 1
DP 3
40.0 m
80.0 m
200.0
C
L
ZLm
50 [Ω]
(a)
(b)
FIGURE 4.50  Output matching circuit.
www.ebook3000.com

179
Small-Signal Amplifiers
Similarly, output matching network has series C and shunt as shown in the 
Smith chart in Figure 4.50. After some tuning, when interfaced in the 
final circuit simulated by ADS in Figure 4.48, the component values are 
obtained as C = 5.6 [pF] and L =8.2 [nH].
Gain, Bandwidth, and Voltage Standing Wave Ratio
Gain, bandwidth, and voltage standing wave ratio of the amplifier are ana-
lyzed. The total theoretical transducer gain of the amplifier is found from 
Equation 4.127 as
	
G
G
G
G
[dB]
[dB]
[dB]
[dB]
26.5 [dB]
T
s
o
L
=
+
+
=
The constant gain circles for source and load are given in Figures 4.51 and 
4.52, respectively.
Tuning and Optimization
The final circuit in Figure 4.53 is simulated with ADS and optimized.
The gain obtained versus frequency illustrating also the bandwidth is given 
in Figure 4.54.
Prototyping
The simulated circuit shown in Figure 4.54 is built and tested. The prototype 
of the amplifier is shown in Figure 4.55.
The measured results are obtained using Agilent 4418B power meter with 
10 dB coupler, which are illustrated in Table 4.6. Gain above 10 dB is 
obtained when the applied signal is greater than about 6 dBm.
The following is the MATLAB program used to do calculations and for plot-
ting the gain and stability circles:
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
∞
–1 dB
0 dB
1 dB
2 dB
3 dB
Γopt = S*11
FIGURE 4.51  Constant gain circles at the input.

180
Linear and Switch-Mode RF Power Amplifiers
0.2
0.5
1.0
2.0
5.0
+0.2
–0.2
+0.5
–0.5
+1.0
–1.0
+2.0
–2.0
+5.0
–5.0
0.0
∞
0.2 dB
0.5 dB
Γopt = S*22
0 dB
–0.1 dB
–0.2 dB
FIGURE 4.52  Constant gain circles at the output.
FIGURE 4.53  Simulation of the final circuit with ADS.
www.ebook3000.com

181
Small-Signal Amplifiers
18.5
18.0
17.5
17.0
16.5
16.0
15.5
15.0
0.75
0.80
0.85
0.90
0.95
1.00
1.05
1.10
Frequency [GHz]
Forward gain
(b)
(a)
ADS
ACI meas 1
750.0 MHz
760.0 MHz
770.0 MHz
780.0 MHz
790.0 MHz
800.0 MHz
810.0 MHz
820.0 MHz
830.0 MHz
840.0 MHz
850.0 MHz
860.0 MHz
870.0 MHz
880.0 MHz
890.0 MHz
900.0 MHz
910.0 MHz
920.0 MHz
930.0 MHz
940.0 MHz
950.0 MHz
960.0 MHz
970.0 MHz
980.0 MHz
990.0 MHz
1.000 GHz
1.010 GHz
1.020 GHz
1.030 GHz
1.040 GHz
16. 937
17. 317
17. 617
17. 842
17. 998
18. 091
18. 131
18. 126
18. 085
18. 015
17. 923
17. 815
17. 694
17. 565
17. 430
17. 292
17. 152
17. 011
16. 871
16. 732
16. 595
16. 460
16. 328
16. 198
16. 070
15. 945
15. 823
15. 704
15. 586
15. 472
Frequency
AC1. meas 1
FIGURE 4.54  ADS simulation results of the final circuit with ADS.
(a)
(b)
FIGURE 4.55  The prototype of the low-noise amplifier built and tested.
TABLE 4.6
Power Meter Gains
Frequency [MHz]
Power In [dBm]
Power Out [dBm]
915
4
12.1
915
5
13.98
915
6
15.6
915
8
17.5
915
10
17.8

182
Linear and Switch-Mode RF Power Amplifiers
MATLAB Script to Design Small-Signal Amplifier
close all;   % close all opened graphs
clear all;
 
smith_chart;
 
prompt = {'Zo','S11Mag','S11Ang','S12Mag','S12Ang','S21Mag','S
21Ang','S22Mag','S22Ang' };
dlg_title = 'Scattering Parameters ';
num_lines = 1;
def = 
{'50','0.71','-117.3','0.04','41.7','14.15','106.4','0.31','-
73.8'};
answer = inputdlg(prompt,dlg_title,num_lines,def, 'on');
 
%convert the strings received from the GUI to numbers
valuearray=str2double(answer);
 
%Give variable names to the received numbers
Zo=valuearray(1);
S11Mag=valuearray(2);
S11Ang=valuearray(3);
S12Mag=valuearray(4);
S12Ang=valuearray(5);
S21Mag=valuearray(6);
S21Ang=valuearray(7);
S22Mag=valuearray(8);
S22Ang=valuearray(9);
 
 
 
 
%   Enter angle in degrees, this converts to complex.
 
S11rad = S11Ang*pi/180;%radian conversion for complex notation
S12rad = S12Ang*pi/180;
S21rad = S21Ang*pi/180;
S22rad = S22Ang*pi/180;
S = [S11Mag*exp(1i*S11rad),S12Mag*exp(1i*S12rad); S21Mag*exp(1
i*S21rad),S22Mag*exp(1i*S22rad)];
 
 
input_stability(S, '+k');
output_stability(S, '-r');
 
 
delta=S(1,1)*S(2,2)-S(1,2)*S(2,1);
fprintf('Delta');
disp(abs(delta));
www.ebook3000.com

183
Small-Signal Amplifiers
K=(1+(abs(delta))^2-(abs(S(1,1)))^2-(abs(S(2,2))^2))/
(2*abs(S(1,2)*S(2,1)));
fprintf('\n Roulette K factor:');
disp(K);
if K > 1 && delta < 1
    fprintf('Unconditionally Stable');
else
    fprintf('Ptentially Unstable');
end
 
 
%Input Stabilty Circle Parameters
 
Cs=conj(S(1,1)-delta*conj(S(2,2)))/
(abs(S(1,1))^2-abs(delta)^2);
Rs=abs(S(1,2)*S(2,1)/(abs(S(1,1))^2-abs(delta)^2));
 
%%Output Stabilty Circle Parameters
 
Cl=conj(S(2,2)-delta*conj(S(1,1)))/
(abs(S(2,2))^2-abs(delta)^2);
Rl=abs(S(1,2)*S(2,1)/(abs(S(2,2))^2-abs(delta)^2));
 
%Optimum Termination Impedances
 
GammaS=conj(S(1,1));
GammaL=conj(S(2,2));
 
Zsm=Zo*((1+GammaS)/(1-GammaS)); %Source Impedance
Zlm=Zo*((1+GammaL)/(1-GammaL)); %Load Impedance
 
%Unilateral Figure of Merit, max and min errors
 
U=(S11Mag*S12Mag*S21Mag*S22Mag)/((1-S11Mag^2)*(1-S22Mag^2));
X=(S(1,2)*S(2,1)*GammaS*GammaL)/
((1-S(1,1)*GammaS*(1-S(1,1)*GammaL)));
Max_Error=1/((1-U)^2);
Max_Error_dB=10*log10(Max_Error);
Min_Error=1/((1+U)^2);
Min_Error_dB=10*log10(Min_Error);
FoM=1/(abs(1-X))^2; % Ratio Gt/Gtu
 
% Calculation of GammaIn and GammaOut
 
GammaOut=S(2,2)+((S(1,2)*S(2,1)*GammaS)/(1-S(1,1)*GammaS));
GammaIn=S(1,1)+((S(1,2)*S(2,1)*GammaL)/(1-S(2,2)*GammaL));
 
 
 
% Source Side Gain Calculation
 

184
Linear and Switch-Mode RF Power Amplifiers
Gs_max=1/(1-abs(S(1,1))^2);
Gs_max_dB=10*log10(Gs_max);
Gs=(1-abs(GammaS)^2)/((abs(1-S(1,1)*GammaS))^2);
gs=Gs/Gs_max;
 
 
 
% Load Side Gain Calculation
 
Gl_max=1/(1-(abs(S(2,2)))^2);
Gl_max_dB=10*log10(Gl_max);
Gl=(1-(abs(GammaL))^2)/((abs(1-S(2,2)*GammaL))^2);
gl=Gl/Gl_max;
 
% Transistor Gain
 
G0=abs(S(2,1))^2;
G0_dB=10*log10(G0);
 
%Total Gain in dB
 
Gtu_dB=Gs_max_dB+Gl_max_dB+G0_dB;
 
 
%Source gain circles
 
smith_chart;
 
%Straight line connecting GammaS and the origin
hold on;
plot([0 real(GammaS)],[0 imag(GammaS)],'b');
plot(real(GammaS),imag(GammaS),'bo');
 
% specify the angle for the constant gain circles
a=(0:360)/180*pi;
 
gs_db=[-1 0 1 2 3]; % range of desired gains
gs=exp(gs_db/10*log(10))/Gs_max; % convert from dB to normal 
units
 
for n=1:length(gs)
   dg=gs(n)*conj(S(1,1))/(1-abs(S(1,1))^2*(1-gs(n)));
   rg=sqrt(1-gs(n))*(1-abs(S(1,1))^2)/
(1-abs(S(1,1))^2*(1-gs(n)));
   plot(real(dg)+rg*cos(a),imag(dg)+rg*sin(a),'r','linewi
dth',2);
   text(real(dg)-0.05,imag(dg)+rg+0.05,strcat('\
bf',sprintf('%gdB',gs_db(n))));
   
end;
 
www.ebook3000.com

185
Small-Signal Amplifiers
text(real(GammaS)-0.05,imag(GammaS)-0.06,'\bf\
Gamma_{opt}=S_{11}^*');
 
 
 
% Load Gain Circles
 
smith_chart;
 
 
%draw a straight line connecting Gs_opt and the origin
hold on;
plot([0 real(GammaL)],[0 imag(GammaL)],'b');
plot(real(GammaL),imag(GammaL),'bo');
 
% specify the angle for the constant gain circles
a=(0:360)/180*pi;
 
%plot source gain circles
gl_db=[-0.2 -0.1 0 0.2 0.5]; % range of desired gains
gl=exp(gl_db/10*log(10))/Gl_max; % convert from dB to normal 
units
 
for n=1:length(gl)
   dl=gl(n)*conj(S(2,2))/(1-abs(S(2,2))^2*(1-gl(n)));
   rl=sqrt(1-gl(n))*(1-abs(S(2,2))^2)/
(1-abs(S(2,2))^2*(1-gl(n)));
   plot(real(dl)+rl*cos(a),imag(dl)+rl*sin(a),'r','linewi
dth',2);
   text(real(dl)-0.05,imag(dl)+rl+0.05,strcat('\
bf',sprintf('%gdB',gl_db(n))));
end;
 
text(real(GammaL)-0.05,imag(GammaL)-0.06,'\bf\
Gamma_{opt}=S_{22}^*');
 
  
fprintf('\n Load Stability circle radius:');
disp(Rl);
fprintf('\n Load Stability circle center:');
disp(Cl); 
fprintf('\n Source Stability circle radius:');
disp(Rs);
fprintf('\n Source Stability circle center:');
disp(Cs); 
fprintf('\n GammaS:');
disp(GammaS);
fprintf('\n GammaL:');
disp(GammaL);
fprintf('Unilateral Figure of Merit:');
disp(U);

186
Linear and Switch-Mode RF Power Amplifiers
fprintf('\n Max Error: ');
disp(Max_Error_dB);
fprintf('\n Min Error: ');
disp(Min_Error_dB);
fprintf('\n GT/GTU:');
disp(FoM);
fprintf('\n Zs:');
disp(Zsm);
fprintf('\n ZL:');
disp(Zlm);
fprintf('\n Gtu in dB:');
disp(Gtu_dB);
fprintf('\n GammaIn:');
disp(GammaIn);
fprintf('\n GammaOut:');
disp(GammaOut);
REFERENCES
	
1.	 G. Gozales, Microwave Transistor Amplifiers: Analysis and Design, 2nd ed., Pearson, 
1996.
	
2.	 G. D. Vendelin, A. M. Pavio, and U. L. Rohde, Microwave Circuit Design Using Linear 
and Nonlinear Techniques, 2nd ed., Wiley, 2005.
	
3.	 HP test and application note 95-1, S-Parameter techniques, February 1967.
	
4.	 Transistor datasheet. https://www.modelithics.com/models/Vendor/Avago/ATF-54143.
pdf.
www.ebook3000.com

187
5 Linear Amplifier Design 
and Implementation
5.1  LARGE-SIGNAL RF AMPLIFIER DESIGN TECHNIQUES
Small-signal analysis methods are applicable when the amount of signal applied 
is low enough not to change the linearity of the device. This is part of the reason 
why manufacturers of active devices, e.g., transistors, provide designers with small-
signal parameters, such as S parameters, for specific cases of low-signal applica-
tions. However, many practical applications require signal levels that are high, which 
changes the characteristics of the device. Hence, small-signal parameters become 
no longer applicable. There are large-signal parameters that can be used to design 
large-signal amplifiers. However, large-signal S parameters are not easy to measure 
and hence not being used in practice.
In practice, the accepted method to design high-power radio frequency (RF) 
amplifier is using the large-signal input and output impedances provided by the man-
ufacturer for RF transistors. Load-pull measurement method is then used to charac-
terize the gain, power, and efficiency characteristics of the devices at the operating 
frequency within bandwidth [1–7].
Load-pull measurement method can be understood better by studying the basic 
Class A amplifier circuit given in Figure 5.1. The calculation of the optimum load 
resistance, Ropt, can be illustrated from the DC load line for Class A amplifier shown 
in Figure 5.2.
The calculation of the optimum load resistance, Ropt, can be found from the DC 
load line theory as
	
=
=
−
=
−
R
Z
V
V
I
V
V
I
/ 2
opt
L
dc
knee
max
dc
knee
dc
	
(5.1) 
The optimum output power and drain efficiency can then be calculated as
	
(
)
=
−
P
V
V
I
2
opt
dc
knee
dc 	
(5.2)
and
	
(
)
η
=
=
−
P
P
V
V
V
2
max
opt
dc
dc
knee
dc
	
(5.3)
For an ideal case, Vknee = 0, and hence the maximum efficiency is 50% as expected for 
Class A amplifiers. When Vknee = 0, Equation 5.2 can be written as

188
Linear and Switch-Mode RF Power Amplifiers
	
=
=
=
P
V I
V
R
I R
2
2
1
2
opt
dc dc
dc
2
opt
dc
2
opt 	
(5.4)
Ropt on the Smith chart can be illustrated as shown in Figure 5.3.
When there is a mismatch, it will have an effect on the output power and effi-
ciency of the power amplifier (PA). This effect can be found by using contours on the 
Smith chart. Let us define a quantity p, which is a power reduction factor. The power 
Vdc
RFchoke
vds
+
iD
IDC
ZL
vGS
iG
FIGURE 5.1  Load-pull measurement circuit.
VDS
ID
Vsat
Vdc
Vmax
Class A
Imax
Idc
VGS5
VGS4
VGS3
VGS2
VGS1
FIGURE 5.2  DC load line for Class A amplifier for Ropt for calculation.
www.ebook3000.com

189
Linear Amplifier Design and Implementation
output can then be represented by P
p
/
opt
. The possible resistive solutions that can be 
written for this mismatch are as follows:
Resistive Solution 1
	
=
=
=





→
=
=
pR
I
V
pR
V
V
P
V
pR
P
p
   
  
1
2
opt
m
dc
opt
m
dc
o
dc
2
opt
opt 	
(5.5)
Resistive Solution 2
	
=
=
=
=






→
=
=
R
p
I
I
I
V
I R
p
P
I R
p
P
p
2
   
  
1
2
opt
m
max
dc
m
dc
opt
o
dc
2
opt
opt 	
(5.6)
Based on the results, the possible impedance values are
	
=
R
R
p
L
opt 	
(5.7a)
	
=
R
pR
H
opt 	
(5.7b)
These two possible solutions can be illustrated using the Smith chart given in 
Figure 5.4.
We can now begin analysis of two different cases for the upper and lower limits: 
R = RL and R = RH.
	
=
R
R
p
Case 1:
L
opt
When R = RL, we need to add series reactance jX to increase the voltage swing with-
out affecting current, because power is limited by the current for this case. This can 
be illustrated in Figure 5.5.
Ropt
FIGURE 5.3  Illustration of Ropt on the Smith chart.

190
Linear and Switch-Mode RF Power Amplifiers
The boundary for the added reactance is identified as ±Xm, and it can be found 
from the following equation:
	
+
=
R
jX
R
L
m
opt 	
(5.8)
=
R
pR
Case 1:
H
opt
When R = RL, we need to add shunt component with susceptance, jB, to increase the 
current swing without affecting the voltage, because power is limited by the voltage 
for this case. This can be illustrated in Figure 5.6.
The boundary that current can be increased will be defined by the following 
equation:
	
+
=
G
jB
R
1
L
m
opt
	
(5.9)
Vdc
RFchoke
vds
+
iD
iG
vGS
IDC
=
RL
Ropt
p
jX
FIGURE 5.5  Adding series reactance when there is low impedance, RL.
Ropt
RH
RL
FIGURE 5.4  Illustration of low and high impedance limits on the Smith chart.
www.ebook3000.com

191
Linear Amplifier Design and Implementation
Therefore, load-pull contours are identified by following constant r or g circles on 
the Smith chart as shown in Figure 5.7. The intersection of constant resistance and 
conductance are the limits that are identified by Equations 5.8 and 5.9, Xm and Bm, 
respectively. As a result, the contour obtained shows the constant power for the spec-
ified case.
5.2  PUSH–PULL AMPLIFIER CONFIGURATION
The output power capacity of an RF amplifier can be increased in several ways. 
One of the ways is to use higher voltage and current-rated active devices for the 
frequency of operation. However, this has many implications such as availability 
Vdc
RFchoke
vds
+
IDC
ID
1
=
GH
Ropt p
iG
vGS
jB
FIGURE 5.6  Adding shunt susceptance when there is high impedance, GH.
Boundary =
RL – jXm
RL
RH
Ropt
Popt
RL + jXm
p
(a)     
RL
RH
Ropt
GL + jBm
GL – jBm
Boundary =
Popt
p
(b)
FIGURE 5.7  Constant power contour using load pull technique; (a) Case 1 and (b) Case 2.

192
Linear and Switch-Mode RF Power Amplifiers
of devices, increased size, and other implementation issues. When use of higher 
voltage and current-rated devices is not feasible, the output power capacity can 
also be increased by using push–pull configuration and/or parallel transistor 
configuration.
Practical RF PA design uses push–pull configuration widely to meet the demand 
of high output power. The input drive signal for push–pull amplifiers is out phased 
by 180° using transformers such as input balun. Output balun is used at the output to 
combine the out-phased amplifier output signal and double the RF power. RF input 
voltage signal at operational frequency ignoring the phases and assuming ideal con-
ditions for simplicity can be expressed as
	
=
ω
v t
V
t
( )
4
sin(
)
s
m
	
(5.10)
Assuming the matched impedance case, the signal at the input of the balun is then
	
=
=
ω
v
t
v t
V
t
( )
( )
2
2
sin(
)
in
s
m
	
(5.11)
The signal at the output of the balun will be equally split and phased by 180°. These 
signals at the input of the amplifiers can be represented as
	
=
ω
v t
V
t
( )
sin(
)
1
m
	
(5.12)
	
=
ω +θ = −
ω
v t
V
t
V
t
( )
sin(
)
sin(
)
2
m
m
	
(5.13)
where θ = 180°.
The signals v1(t) and v2(t) will be amplified by the amplifiers by their correspond-
ing gains, A1 and A2, respectively. The signals at the output of the amplifiers are then 
equal to
	
=
ω
v t
A V
t
( )
sin(
)
1
1 m
	
(5.14)
	
= −
ω
v t
A V
t
( )
sin(
)
2
2
m
	
(5.15)
The amplifier output signals are then combined via output balun. The final load 
signal is
	
(
)
=
−
=
+
ω
v
t
v t
v t
A
A V
t
( )
( )
( )
sin(
)
L
1
2
1
2
m
	
(5.16)
The illustration of the push–pull amplifier with waveforms is given in Figure 5.8.
www.ebook3000.com

193
Linear Amplifier Design and Implementation
Input balun
Output balun
ZL
Rs
4Vm
2Vm
A2Vm
A1Vm
(A1 + A2)Vm
–(A1 + A2)Vm
–A1Vm
–A2Vm
Vm
vout1
–Vm
Rs / 2
Rs / 2
–2Vm
–4Vm
vin
PA1
PA2
Vdc1
Vdc2
vL
vL
vout2
v2
v1
vm
–vm
vs
vs
θ
θ
θ
θ
θ
θ
θ
FIGURE 5.8  Implementation of push–pull amplifiers.

194
Linear and Switch-Mode RF Power Amplifiers
5.3  PARALLEL TRANSISTOR CONFIGURATION
RF power output in the amplifier system can be increased by also paralleling the 
transistors. When transistors are paralleled, the current is increased proportionally 
to the number of the transistors used under ideal conditions. This can be illustrated 
in Figure 5.9.
5.4  PA MODULE COMBINERS
RF output power can be increased further up to several kWs by combining individual 
identical PA modules. These PA modules are usually combined via Wilkinson-type 
power combiner. The typical PA module combining technique is shown via a two-
way power combiner in Figure 5.10.
5.5  LINEAR AMPLIFIERS
In this section, amplifier classes such as Class A, Class B, and Class AB for linear 
mode of operation will be discussed.
When the transistor is operated as a dependent current source, the conduction 
angle, 2θ, is used to determine the class of the amplifier shown in Figure 5.11. The 
conduction angle varies up to 2π based on the amplifier class. The use of transistor 
as a dependent current source representing a linear mode of operation was briefly 
discussed in Chapter 1 and is shown in Figure 5.11 as reference again.  
The conduction angles, bias, and quiescent points for linear amplifier are shown 
in Figure 5.12 and are illustrated in Table 5.1 as reference. As it was discussed in 
Chapter 1, conduction angle, θ, is defined as the duration of the period in which the 
given transistor is conducting, and the full cycle of conduction was considered to 
be 360°.
Q1
vL
ZL
Q2
QN
IQN = I
IQ2 = I
IQT = NI
IQ1 = I
Vin
D
r
i
v
e
r
FIGURE 5.9  Parallel connection of transistors for RF amplifiers.
www.ebook3000.com

195
Linear Amplifier Design and Implementation
Combiner
A
B
Output
PA module 2
PA module 1
T1
T2
PA11
PA12
PA21
PA22
FIGURE 5.10  Power combiner for PA modules.
Vdc
RFchoke
Cd
VCd
Vds
+
+
IL
I0
RL
V0
IDC
ID
C
L
ZtLn
FIGURE 5.11  Equivalent circuit representation of linear amplifier mode of operation.

196
Linear and Switch-Mode RF Power Amplifiers
In our analysis, metal-oxide field-effect transistor (MOSFET) is used as an active 
device in the amplifier circuit. The ideal MOSFET transistor transfer characteristics 
are illustrated in Figure 5.13. There is maximum drain current level for a correspond-
ing gate-source voltage (Vgs) that an MOSFET conducts. In the cutoff region, the 
gate-source voltage, Vgs, is less than threshold voltage or saturation voltage, Vsat, and 
the device is an open circuit or off. In the Ohmic region, the device acts as a resistor 
with an almost constant on-resistance RdsON and is equal to the ratio of drain voltage, 
VDS, and the drain current, ID. In the linear mode of operation, the device operates in 
the active region, where ID is a function of the gate-source voltage Vgs and defined by
	
(
)
(
)
=
−
=
−
I
K
V
V
g
V
V
n
m
D
gs
th
2
gs
th 	
(5.17)
where Kn is a parameter depending on the temperature and device geometry, and gm 
is the current gain or transconductance. When VDS is increased, the positive drain 
potential opposes the gate voltage bias and reduces the surface potential in the chan-
nel. The channel inversion-layer charge decreases with increasing VDS and, ulti-
mately, becomes zero when the drain voltage equals to Vgs − Vth. This point is called 
the “channel pinch-off point,” where the drain current becomes saturated.
When operational drain current (ID) at a given Vgs goes above the Ohmic or linear 
region “knee or saturation point”, any further increase in drain current results in a 
significant rise in drain-source voltage (VDS) as shown in Figure 5.13. This results 
ID
Imax
Vmax
VDS
Vsat
Class A
Class AB
Class B
Class C
FIGURE 5.12  Load lines and bias points for linear amplifiers.
TABLE 5.1
Conduction Angles, Bias, and Quiescent Points for Linear Amplifiers
Class
Bias Point
Quiescent Point
Conduction Angle
A
0.5
0.5
2π
AB
0–0.5
0–0.5
π–2π
B
0
0
π
C
<0
0
0–π
www.ebook3000.com

197
Linear Amplifier Design and Implementation
in a rise in conduction loss. If power dissipation is high and over the limit that the 
transistor can handle, then the device may catastrophically fail. When Vgs is less 
than the threshold or pinch-off voltage, VP, then the device does not conduct, and ID 
becomes 0. As Vgs increases, the transistor enters the saturation or active region, and 
ID increases in a nonlinear fashion. It will remain almost a constant until the tran-
sistor gets into breakdown region. The characteristics of ID versus Vgs in saturation 
region are illustrated in Figure 5.14. The simplified device model for MOSFET in 
each region is illustrated in Figure 5.15.  
Example 5.1
State whether the following transistor in Figure 5.16 is operating in saturation 
region. What should be the value of gate voltage, VG, for the transistor to operate 
in saturation region? Assume Vt = 1 V.
Solution: The condition to operate in saturation region is
	
V
V
gs
t
>
Increasing
Ohmic or
triode
region
Saturation or
active
region
Breakdown
G
D
S
+
–
+
–
ID
ID
ID
gm
Imax
IG = 0
VDS = VGS – Vth
VGS5 = Vth + 5
VGS4 = Vth + 4
VGS3 = Vth + 3
VGS2 = Vth + 2
VGS1 = Vth + 1
VDS > VGS – Vth
VDS < VGS – Vth
VGS < Vth Cut-off
VGS > Vth
VGS > Vth
VDS
VGS
VGS
VDS
BVds max
Vp
FIGURE 5.13  Transfer characteristics of ideal FET device, N channel Metal Oxide 
Semiconductor (NMOS).

198
Linear and Switch-Mode RF Power Amplifiers
VGS  < Vt
VGS  > Vt
VDS  > VGS –Vt
VGS  > Vt
VDS  < VGS –Vt
G
S
D
CGD
CGS
CGS
G
D
S
RDSon
Ohmic or triode region
Cut-off region
Saturation or active
region
D
G
CGD
S
iD
FIGURE 5.15  Simplified large-signal model for NMOS FET device.
Device is OFF
ID
Vth
VGS
ID = Kn (VGS – Vth)2
FIGURE 5.14  ID versus Vgs in saturation region for ideal NMOS device.
D
D
VD = 3.5V
VD = 5V
VG = 4V
VG
Vs = 2V
Vs = 3V
G
G
S
S
(a)
(b)
FIGURE 5.16  MOSFET illustration for Example 5.1.
www.ebook3000.com

199
Linear Amplifier Design and Implementation
V
V
V
DS
gs
t
>
−
	
1.	 V
V
V
V
V
4
2
2 V
1 V
and
3.5
2
1.5 V
2 1
1 V
gs
t
DS
gs
t
[ ]
[ ]
[ ]
[ ]
=
−
=
>
=
=
−
=
>
−
=
−=
Therefore, the first transistor is operating in saturation region.
	
2.	From the first condition, for transistor to operate in saturation region, 
V
1[V]
gs >
. That requires gate voltage V
4 [V]
G >
. In addition, it is required 
that V
V
V
2 1
3[V]
gs
DS
t
<
+
=
+ =
. The overall solution is
	
V
1
3
gs
<
<
Since source voltage is VS = 2 V,
	
V
V
1
2
3 or 3
5
G
G
<
−
<
<
<
5.5.1  Conventional Amplifiers: Classes A, B, and C
For amplifier Classes A, B, and C, the transistor can be modeled as the voltage-
dependent current source (Figure 5.17). Most of the time, the class of these amplifiers 
are also known as conventional amplifiers.
The current iD flowing through the device, drain-to-source voltage, and the volt-
age applied at the gate to source of the transistor in Figure 5.17 are
	
=
+
θ
i
I
I cos( )
D
dc
m
	
(5.18)
	
=
−
θ
v
V
V cos( )
DS
dc
m
	
(5.19)
	
=
+
θ
v
V
V
cos( )
gs
t
gsm
	
(5.20)
RFchoke
+
+
iD
iG
io
IDC
Cd
RL
ZtLn
vo
vds
vGS
Vdc
vCd
C
L
FIGURE 5.17  Conventional RF power amplifier classes: Class A, B, and C.

200
Linear and Switch-Mode RF Power Amplifiers
where θ = ωt. The DC components of the drain current and drain-to-source voltage 
are equal to Idc and Vdc, and AC component is Im cos(θ), −Vm cos(θ) and given as
	
=
=
I
I
V
V
,
D
dc
DS
dc 	
(5.21)
	
=
θ
= −
θ
i
I
V
cos( ), v
cos( )
D
m
DS
m
	
(5.22)
Fourier integrals can be used to determine the DC power and output of the ampli-
fier. Drain current, iD, can be represented using Fourier series expansion with sine or 
cosine functions, which are harmonically related as
	
∑
=
+
ω
+
ω
=
∞
i
t
I
I
n
t
I
n
t
( )
cos
sin
an
bn
n
D
o
o
o
1
	
(5.23)
	
∑
=
+
ω
+
ω
=
∞
v
t
V
V
n
t
V
n
t
( )
cos
sin
an
bn
n
DS
o
o
o
1
	
(5.24)
We can combine the odd and even harmonic coefficients into single cosine (or sine) 
to give
	
∑
(
)
=
+
ω
+α
=
∞
i
t
I
I
n
t
( )
cos
n
n
n
D
o
o
1
	
(5.25)
	
∑
(
)
=
+
ω
+β
=
∞
v
t
V
V
n
t
( )
cos
n
n
n
DS
o
o
1
	
(5.26)
where
	
=
+
I
I
I
n
an
bn
2
2 	
(5.27a)
and
	
=
+
V
V
V
n
an
bn
2
2 	
(5.27b)
and
	
α =




−
I
I
tan
n
bn
an
1
	
(5.28a)
and
	
β =




−
V
V
tan
n
bn
an
1
	
(5.28b)
www.ebook3000.com

201
Linear Amplifier Design and Implementation
The impedance at the transistor load line of the transistor is found from
	
=
=
α
β
φ
Z
V
I
Z
e
e
e
tLn
n
j
n
j
tLn
j n 	
(5.29)
where 
(
)
φ = α −β
n
n
n . The Fourier coefficients Io, Ian, and Ibn for drain current are 
calculated from
	
∫
=
−
I
T
i
t
t
1
( )d
T
T
o
D
/2
/2
	
(5.30a)
	
∫
(
)
=
ω
−
I
T
i
t
k
t
t
2
( )cos
d
an
T
T
D
o
/2
/2
	
(5.30b)
	
∫
(
)
=
ω
−
I
T
i
t
k
t
t
2
( )sin
d
bn
T
T
D
o
/2
/2
	
(5.30c)
where ω = π T
2 /
o
. The fundamental component in Equation 5.30 is obtained when 
n = 1, and DC components are found from Equation 5.30a as follows:
	
∫(
)
=
π
+
θ
θ =
−π
π
I
I
I
I
1
2
cos( ) d
o
dc
m
dc 	
(5.31a)
∫(
)
= π
+
θ
θ
θ =
=
=
−π
π
I
I
I
n
d
I
n
I
1
cos( ) cos(
)
   when  
1 otherwise 
0
an
an
dc
m
m
	
(5.31b)
	
∫(
)
= π
+
θ
θ
θ =
−π
π
I
I
I
n
n
1
cos( ) sin(
) d
0 for all 
bn
dc
m
	
(5.31c)
The same analysis and derivation can also be repeated for drain-to-source voltage. 
Hence, the DC and the fundamental components of the drain current and drain-to-
source voltage at the resonant frequency, fo, are
	
=
=
I
I
V
V
,
o
dc
o
dc 	
(5.32)
	
=
=
I
I
V
V
,
1
m
1
m 	
(5.33)
	
=
P
P
V I
DC power, 
from supply is then calculated from 
dc
dc
dc dc 	
(5.34)
The power delivered from device to output is represented by Po and is calculated 
at the fundamental frequency, which is the resonant frequency of the LC network 
obtained from Equation 5.33 as

202
Linear and Switch-Mode RF Power Amplifiers
	
=
P
V I
1
2
o
m m 	
(5.35)
The more general expression when operational frequency is not equal to resonant 
frequency for the output power can be found at the fundamental and harmonic fre-
quencies as
	
=
φ
=
P
V I
n
1
2
cos(
),
1,2,
on
n n
n
	
(5.36)
The transistor dissipation is calculated using
	
∫
=
P
T
v
t i
t
t
1
( ) ( )d
T
diss
DS
0
D
	
(5.37)
which is also equal to
	
∑
=
−
=
∞
P
P
Po n
n
diss
dc
,
1
	
(5.38)
The drain efficiency is the ratio of the output power to DC supply power and is cal-
culated using Equations 5.34 and 5.36 as
	
η =
=
+
P
P
P
P
P
o n
o n
o n
,
dc
,
diss
,
	
(5.39)
The maximum efficiency is obtained when
	
∑
+
=
=
∞
P
P
0
o n
n
diss
,
2
	
(5.40)
Then, the maximum efficiency from Equation 5.39 is found to be η
=100%
max
.
The drive input power is calculated using Equation 5.20 for gate-to-source volt-
age, vgs, and gate current, iG, from
	
∫
=
P
T
v
t i
t
t
1
( ) ( )d
T
G
gs
0
G
	
(5.41)
5.6  CLASS A AMPLIFIERS
For amplifier Classes A, B, and C, the transistor can be modeled as the voltage-
dependent current source (Figure 5.18). Most of the time, the class of these amplifiers 
are also known as conventional amplifiers.
www.ebook3000.com

203
Linear Amplifier Design and Implementation
The bias point in Class A mode of operation is selected at the center of I–V curve 
between the saturation voltage, Vsat, and maximum operational transistor voltage, 
Vmax, whereas DC current for Class A amplifier is biased between 0 and the maxi-
mum allowable current, Imax. The conduction angle for the transistor for Class A 
operation is 2π, which means that the transistor conducts the entire RF cycle. Current 
and voltage waveforms for Class A amplifier are illustrated in Figure 5.19.
High operational current exists with high voltage because DC bias point is located 
in the middle of I–V characteristics. This results in high dissipation. The Class A 
amplifier does not need an LC resonator network shown in Figure 5.18, because 
the output of the amplifier is sinusoidal. Nonetheless, the tuning network is usually 
RFchoke
IDC
Vdc
+
+
iD
iG
io
Cd
RL
ZtLn
vo
vds
vGS
vCd
C
L
FIGURE 5.18  Equivalent circuit for RF power amplifier classes: Class A, B, and C.
Class A
2π
2π
VGS
VDS
vDS
VGS
VP
Vsat
Vdc
Vmax
VP / 2
ID
ID
ID
Idc
Imax
θ
θ
θ
π
π
FIGURE 5.19  Class A amplifier waveforms.

204
Linear and Switch-Mode RF Power Amplifiers
implemented in practice due to nonideal device characteristics. Voltage and current 
for Class A mode of operation can be expressed as
	
=
+
θ
i
I
I cos( )
D
dc
m
	
(5.42)
	
=
−
θ
v
V
V cos( )
DS
dc
m
	
(5.43)
	
=
+
θ
v
V
V
cos( )
gs
t
gsm
	
(5.44)
The output current, io, and output voltage, vo, are
	
=
θ
i
I cos( )
o
m
	
(5.45)
	
= −
θ = −
θ
v
V
I R
cos( )
cos( )
o
m
m
L
	
(5.46)
Therefore, Equations 5.42 and 5.43 can be set in the following form:
	
=
+
θ
i
I
i ( )
D
dc
o
	
(5.47)
	
=
+
θ
v
V
v ( )
DS
dc
o
	
(5.48)
When Equations 5.42 and 5.43 with Equations 5.45 through 5.46 are solved, we 
obtain the load line equation as
	
= −
+
+




i
v
R
I
R V
1
D
ds
L
dc
L
dc 	
(5.49)
Power and efficiency are given in Figure 5.20.
5.7  CLASS B
Transistor power dissipation due to its 360° conduction angle for Class A amplifiers 
significantly limits the amplifier RF output power capacity. The power dissipation in 
the active device can be reduced if the device is biased to conduct less than the full 
RF period. The transistor is turned on only one-half of the cycle, and as a result the 
conduction angle for Class B amplifiers is θ = 180°. Class B amplifiers can be imple-
mented as a single-ended amplifier when narrowband is required, or as transformed 
coupled push–pull configuration when high linear output power is desired. The typi-
cal load line waveforms are illustrated in Figure 5.21.
In practice, Class B amplifiers are implemented in push–pull configuration as 
shown in Figure 5.22. 
In Figure 5.22, input and output transformers, T1 and T2, are ideal, and the output 
current, io, and output voltage, vo, are sinusoidal and can be expressed as
www.ebook3000.com

205
Linear Amplifier Design and Implementation
	
θ =
θ =
θ
i
I
m
n I
( )
sin( )
sin( )
o
o
	
(5.50)
	
θ =
θ =
θ
v
V
m
n IR
( )
sin( )
sin( )
o
o
L
	
(5.51)
V is the peak value of the transistor voltage, and I is the peak value of the transistor 
current. The drain-to-source voltages can be written as
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Power and efficiency vs Vo
Vo/Vdc
Pdiss/Pdc
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
η [%]
Pdis
Efficiency
FIGURE 5.20  Class A amplifier power and efficiency diagram.
ID
Imax
Idcq = 0
Class B
VGS5
VGS4
VGS3
VGS1
VDS
Vsat
Vdcq
Vmax
VGS2
0
FIGURE 5.21  Typical load line for Class B amplifiers.

206
Linear and Switch-Mode RF Power Amplifiers
	
θ =
+
θ =
+
θ
v
V
V
V
m
n V
( )
sin( )
sin( )
1
dc
dc
o
	
(5.52)
In one-half of the cycle, only one-half of the primary winding at the output carries 
current. Therefore, the transformation of the current in m turns of the primary to n 
turns of the secondary of the output transformer gives the relation for output current 
to the peak of the transistor voltage as
	
=
V
n
m V
o
	
(5.53)
	
=
I
m
n I
o
	
(5.54)
Equation 5.52 can then be written as
	
θ =
+
θ =
+ 



θ
v
V
V
V
m
n
IR
( )
sin( )
sin( )
1
dc
dc
2
L
	
(5.55a)
or
	
θ =
+
θ
v
V
RI
( )
sin( )
1
dc
	
(5.55b)
Similarly,
	
θ =
−
θ =
−
θ
v
V
V
V
IR
( )
sin( )
sin( )
2
dc
dc
	
(5.56a)
or
L
RL
v1
v2
v0
v0
vin
+
m
m
n
C
VB
Vdc
Q1
Q2
T1
T2
i1
i0
i2
FIGURE 5.22  Practical Class B amplifier in push–pull configuration.
www.ebook3000.com

207
Linear Amplifier Design and Implementation
	
θ =
+
θ
v
V
RI
( )
sin( )
1
dc
	
(5.56b)
where
	
= 



R
m
n
R
2
L
	
(5.57)
R is the value of the resistance that is seen by one-half of the primary side of the 
winding. Class B voltage and current waveforms are illustrated in Figure 5.23.
RF output power is
	
=
=
P
V
R
V
R
2
2
o
o
2
L
2 	
(5.58)
The maximum output power occurs when V = Vdc,
	
=
P
V
R
2
o,max
dc
2 	
(5.59)
I
I
V
V
Vdc
i1
i2
i0
v1
θ
θ
θ
θ
FIGURE 5.23  Class B voltage and current waveforms.

208
Linear and Switch-Mode RF Power Amplifiers
The center tap current can be written as the sum of two drain currents as
	
θ =
θ +
θ =
θ
i
i
i
I
( )
( )
( )
sin( )
center,tap
1
2
	
(5.60)
The DC input current is found from
	
∫
=
π
θ
θ = π = π
I
i
I
V
R
1
2
( ) d
2
2
dc
center,tap
	
(5.61)
Therefore, DC input is equal to
	
=
= π
P
V I
V
R V
2
dc
dc dc
dc
	
(5.62)
As a result, the efficiency is equal to
	
η
=
= π
P
P
V
V
4
max
out
dc
dc
	
(5.63)
η
= π
≈
V
V
V
V
The maximum efficiency occurs when 
=
, 
4
0.7853
dc
max
dc
	
(5.64)
The maximum value of the dissipated power is found when V = 2Vdc/π,
	
= π
= π
P
V
R
P
2
4
d,max
2
dc
2
2
o,max 	
(5.65)
5.8  CLASS AB
In Class B mode of operation, amplifier efficiency is sacrificed for linearity. When 
it is desirable to have an amplifier with better efficiency than Class A amplifier, and 
yet better linearity than Class B amplifier, then Class AB is chosen as a compromise. 
The conduction angle for Class AB amplifier is between 180° and 360°. As a result, 
the bias point for Class AB amplifiers is chosen between the bias points for Class A 
and Class B amplifiers. Class AB amplifiers are widely used in RF applications when 
both linearity and efficiency are required. The ideal efficiency of Class AB ampli-
fiers are between 50% and 78.53%. The typical drain-to-source voltage and drain 
current waveforms are illustrated in Figure 5.24.
5.9  CLASS C
Classes A, B, and AB amplifiers are considered to be linear amplifiers, where the 
phase and amplitude of output signal are linearly related to amplitude and phase 
of the input signal. If efficiency is a more important parameter than linearity, then 
nonlinear amplifier classes such as Class C, D, E, or F can be used. The conduction 
www.ebook3000.com

209
Linear Amplifier Design and Implementation
angle for Class C amplifier is less than 180°, which makes this amplifier class more 
efficient than Class B amplifiers.
Class C amplifiers can be analyzed using different models. The models that are 
known for Class C amplifiers are Current Source Class C Amplifiers, Saturated 
Class C Amplifiers, and Class C Mixed Mode Amplifiers.
The typical drain-to-source voltage and drain current waveforms for Class C 
amplifiers are illustrated in Figure 5.25.
The drain efficiency for PA Classes A, B, and C can also be calculated using 
conduction angle, θ, as
	
sin
4 sin
/ 2
/ 2 cos
/ 2
(
) (
)
(
)
η =
θ−
θ
θ
−θ
θ


	
(5.66)
The maximum drain efficiency for Class C amplifier is obtained when θ = 0°. 
However, the output power decreases very fast when conduction angle approaches 
and is shown as
Vdc
iD
vDS
0
2
π
–
2
π
2
3π
ωt
FIGURE 5.24  Typical drain-to-source voltage and drain current for Class AB amplifiers.
Vdc
iD
vDS
0
2
π
–
2
π
2
3π
ωt
θ
–θ
FIGURE 5.25  Typical drain-to-source voltage and drain current for Class C amplifiers.

210
Linear and Switch-Mode RF Power Amplifiers
	
( )
(
)
∝
θ−
θ
−
θ
P
sin
1 cos
/ 2
o
	
(5.67)
As a result, it is not feasible to obtain 100% efficiency with Class C amplifiers. The 
typical Class C amplifier efficiency in practice is between 75% and 80%.
The efficiency distribution and power capacity of conventional amplifier Classes 
A, B, AB, and C are illustrated in Figures 5.26 and 5.27, respectively. 
100
78.5
50
Class
C
Class
B
Class
AB
Class
A
θ
η [%]
2π
π
FIGURE 5.26  Efficiency distribution of conventional amplifiers.
Power capability
2π
0.125
0.134
Class C
Class
B
Class
AB
Class
A
1.362π
π
θ
FIGURE 5.27  Power capability of conventional amplifiers.
www.ebook3000.com

211
Linear Amplifier Design and Implementation
5.9.1  Design Example
Design, simulate, and measure push–pull Class AB amplifier operating at Vdc = 46 
[V] to provide minimum 300 [W] output power using SD1728 50 V epitaxial silicon 
NPN planar transistor at 27.12 MHz. Then, configure a system to use the same push–
pull pair in parallel configuration to obtain minimum power output of 2400 [W]. The 
transistor data for impedance versus frequency is given in Figure 5.28.
Solution: Class AB amplifier using the method described in this chapter is designed 
and simulated. The simulated circuit is shown in Figure 5.29.
The prototype has been built using the circuit in Figure 5.29. The simulated and 
measured results showing gain versus output power are given in Figure 5.30.
As seen from Figure 5.30, power output above 400 was possible with a gain of 
approximately 12, where measured and simulated results agree.
The measured and simulated collector efficiency versus output power is given in 
Figure 5.31. The maximum collector efficiency was approximately 60% for 50 Ω. 
Pout = 250 w PEP
VCC = 50 V
FIGURE 5.28  Illustration of impedance data for SD 1728 versus frequency.

212
Linear and Switch-Mode RF Power Amplifiers
L1
620n
C1
Q40
C2
0
0
0
0
0
0
C4
47u
C3
0.01u
0
0
0
0
0
0
RFin
L10
8.9nH
R2
D62
Dl_9130
Qsd1728_×3
0.6
R7
10
R6
10
R8
2
D61
Dl_B130
D6
1smb5935bt3/0N
0
0
0
C15
630p
C8
680p
46
Vdc
0
C19
39p 
L7
T×2
T×1
C7
150p
R Load
50
L8
12n
12n
0.01u
Q46
C6
0.01u
C5
47u
0.01u
L2
620n
R10
50
R5
2
R4
10
R3
10
R1
L9
8.9nH
R22
0.0000001
D64
Dl_9130
0.6
D5
1smb5935bt3/ON
D63
Dl_B130
Qsd1728_×3
R9
50
FIGURE 5.29  Simulated Class AB amplifier.
www.ebook3000.com

213
Linear Amplifier Design and Implementation
Then, die dissipation is simulated and measured and illustrated in Figure 5.32. It has 
been seen that the worst-case die dissipation was approximately 160 [W]. This is 
well above the dissipation limit of 330 [W] specified for this transistor.
The eight of the push–pull pair is then combined via a combiner to provide a 
minimum power of 2400 [W] (Figure 5.33). The simulated values for gain versus 
output power are illustrated in Figure 5.34. It is shown that the system provides above 
3200 [W] with 12 dB gain when terminated with 50 Ω.  
Gain versus pout
pout [W]
0
0
2
4
6
8
10
12
14
16
100
200
300
400
500
Gain [dB]
Measured
Simulated
FIGURE 5.30  Class AB amplifier gain versus output power for 50 Ω.
Collector effciency versus pout
Collector effciency [%]
pout [W]
0
0.00%
10.00%
20.00%
30.00%
40.00%
50.00%
60.00%
70.00%
100
200
300
400
500
Measured
Simulated
FIGURE 5.31  The simulated and measured results for collector efficiency for 50 Ω.

214
Linear and Switch-Mode RF Power Amplifiers
Die dissipation versus pout
Die dissipation [W]
pout [W]
0
0
20
40
60
80
100
120
140
160
180
100
200
300
400
500
Measured
Simulated
FIGURE 5.32  The simulated and measured results for die dissipation for 50 Ω.
FIGURE 5.33  Illustration of eight push–pull pairs via combiner.
www.ebook3000.com

215
Linear Amplifier Design and Implementation
The efficiency at 27.12 MHz was approximately 60% for 50 Ω (Figure 5.35). The 
power contours for 5:1 have been provided via load-pull measurement (Figure 5.36). 
The die dissipation has been also measured using load-pull ­measurement 
(Figure 5.37). 
Pout [W]
0
0
2
4
6
8
10
12
14
16
500
1000
2500
1500
2000
3000
3500
Gain [dB]
FIGURE 5.34  The gain of combined eight power amplifiers for 50 Ω.
Pout [W]
0
0.00%
10.00%
20.00%
30.00%
40.00%
50.00%
60.00%
70.00%
500
1000
2500
1500
2000
3000
3500
Collector efficiency [%]
FIGURE 5.35  The efficiency of combined eight power amplifiers for 50 Ω.

216
Linear and Switch-Mode RF Power Amplifiers
Delivered power contours at 27.12 MHz
Real
Imag
–1
–0.8
–0.6
–0.4
–0.2
0.2
0.4
0.6
0.8
3500
3000
2500
2000
1500
0
–0.5
0.5
0
1
FIGURE 5.36  Power contours for VSWR of 5:1 load using load-pull measurement.
Die dissipation contours at 27.12 MHz
Real
Imag
–1
–0.8
–0.6
–0.4
–0.2
0.2
0.4
0.6
0.8
100
150
200
250
300
350
400
450
500
0
–0.5
0.5
0
1
FIGURE 5.37  Die dissipation for VSWR of 5:1 load using load-pull measurement.
www.ebook3000.com

217
Linear Amplifier Design and Implementation
REFERENCES
	
1.	 J.M. Cusack, S.M. Perlow, B.S. Perlman, Automatic load contour mapping for micro-
wave power transistors. IEEE Transactions on Microwave Theory Techniques, Vol. 22, 
pp. 1146–1152, 1974.
	
2.	 G.P. Bava, U. Pisani, V. Pozzolo, Active load technique for load-pull characterisation at 
microwave frequencies. Electronic Letters, Vol. 18, pp. 178–180, 1982.
	
3.	 Y. Takayama, A new load-pull characterisation method for microwave power transis-
tors. IEEE MTT-S International Microwave Symposium Digest, pp. 218–220, 1976.
	
4.	 Williams, T., J. Benedikt, P.J. Tasker, Novel base-band envelope load pull architecture. 
In High Frequency Postgraduate Student Colloquium, pp. 157–161, 2004.
	
5.	 M.S. Hashmi, A.L. Clarke, J. Lees, M. Helaoui, P.J. Tasker, F.M. Ghannaouchi, Agile 
harmonic envelope load-pull system enabling reliable and rapid device characteriza-
tion, Measurement Science and Technology, Vol. 21, p. 055109, 2010.
	
6.	 M.A. Pulido, J.A. Reynoso, M.C. Maya, Calibration of a realtime load-pull system using 
the generalized theory of the TRM technique, Microwave Measurement Conference, 
87th, ARFTG, pp. 1–4, 2016.
	
7.	 M.A. Pulido-Gaytan, J.A. Reynoso-Hernandez, M.C. MayaSanchez, J.R. Loo-Yau, 
The impact of knowing the impedance of the lines used in the TRL on the load-
pull ­characterization of power transistors, 86th ARFTG Microwave Measurement 
Conference, pp. 1–4, 2015.

www.ebook3000.com

219
6 Switch-Mode 
Amplifier Design 
and Implementation
6.1  INTRODUCTION
Classes A, AB, and B amplifiers have been used for linear applications where ampli-
tude modulation (AM), single-sideband (SSB) modulation, and quadrature ampli-
tude modulation (QAM) might be required [1–3]. Classes C, D, E, and F are usually 
implemented for narrowband-tuned amplifiers when high efficiency is desired with 
high power [4–12]. Classes A, B, AB, and C are operated as transconductance ampli-
fiers, and the mode of operation depends on the conduction angle. In switch-mode 
amplifiers such as Classes D, DE, E, and F, the active device is intentionally driven 
into saturation region, and it is operated as a switch rather than a current source. 
In theory, power dissipation in the transistor can be totally eliminated, and hence, 
100% efficiency can be achieved for switch-mode amplifiers.
6.2  CLASS D AMPLIFIERS
Class D amplifiers have two-pole switching operation of transistors either in voltage-
mode (VM) configuration that uses series resonator or current-mode (CM) configu-
ration that uses parallel resonator circuit.
6.2.1  Voltage-Mode Class D Amplifiers
The two-pole switching operation of transistors in voltage-mode Class D (VMCD) 
amplifier is illustrated in Figure 6.1. The transfer function of the LCR load network 
can be found from
	
=
V
IR
o
	
(6.1a)
	
=
+
+




V
I
jwL
jwC
R
1
in
	
(6.1b)
Therefore, the transfer function is
	
=
ω
ω =
+ ω + ω
=
+
ω −ω




H jw
V
V
R
R
j L
j C
R
R
j
L
C
(
)
( )
( )
1
1
o
m
	
(6.2)

220
Linear and Switch-Mode RF Power Amplifiers
The natural resonant frequency is then equal to
	
ω =
LC
1
r
	
(6.3)
when ω = ωr, 
ω =
=
ω
H j
H j
(
)
(
)
1
max. The quality factor Q and bandwidth are found 
from
	
= ω
= ω
=
Q
rL
R
RC
R
L
C
1
1
r
	
(6.4a)
	
= ω
Q
BW
r 	
(6.4b)
In Class D operation, it is assumed that the switches are ideal and have zero switch-
ing times with no on-resistance or parasitic capacitance. If we assume that the high- 
and low-side switches are alternately turned on and off with a 50% duty cycle, Vm (t) 
can be illustrated as shown in Figure 6.2.
The Fourier Series representation of V
t( )
m
 shown in Figure 6.2 can be written as
	
∑
=
+
ω
+
ω
=
∞
V
t
a
a
n
t
bn
n
t
( )
cos
sin
n
n
m
0
o
o
1
	
(6.5)
L
C
R
+
Vs/2
–Vs /2
iL (t)
Vm (t)
Vo (t)
FIGURE 6.1  Class D amplifier in voltage mode.
t
Vm(t)
Vs/ 2
T / 2
T
–Vs/ 2
FIGURE 6.2  Waveform for Vm (t).
www.ebook3000.com

221
Switch-Mode Amplifier Design and Implementation
Fourier coefficients in Equation 6.5 can be obtained from
	
∫
∫
∫
=
=
−










=
a
T
V
t
t
T
V
t
V
( )
1
d
1
2 d
2
0
T
T
T
T
o
m
0
s
s
2
2
0
2
	
(6.6a)
	
∫
∫
∫
=
ω
=
ω
−
ω
















a
T
V
t
n
t t
T
V
n
t t
n
t t
( )
2
cos
d
2
2
cos
d
cos
d
n
T
T
T
T
m
0
o
s
o
o
2
0
2
or
	
=
ω
ω




−
ω
ω










=
ω
π



−
ω
π










=
a
T
V
n
n
t
n
n
t
T
V
n
n
n
n
2
2
1 sin
1 sin
2
2
1 sin
1 sin2
0
n
T
T
T
s
o
o
0
2
o
o
2
s
o
o
	
(6.6b)
Similarly,
	
∫
=
ω
b
T
V
t
n
t t
( )
2
sin
d
n
T
m
0
o
	
(6.6c)
or
	
∫
∫
=
ω
−
ω
















= −
ω
ω




+
−
ω
ω










b
T
V
n
t t
n
t t
T
V
n
n
t
n
n
t
2
2
sin
d
sin
d
2
2
1 cos
1 cos
n
T
T
T
o
T
o
T
T
s
o
o
2
0
2
s
o
0
2
o
2
which can be expressed as
	
= −
ω
π −



+
ω
−
π +
π










b
V
T
n
n
n
n
n
(
)
(
)
1
cos
1
1
cos2
cos
n
s
o
o
	
(6.6d)
Equation 6.6d can be simplified as
	
[
]
= −π
π −
π −
b
V
n
n
n
2
2cos
cos2
1
n
s
	
(6.7a)
Hence,
	
=
π



b
V
n
n
n
2
if
=1,3,5,7,... odd
0
if
= 2,4,6,8,... even
n
s
	
(6.7b)

222
Linear and Switch-Mode RF Power Amplifiers
As a result, Vm (t) can be expressed as
	
∑
(
)
=
ω
=
∞
V
t
b
n
t
( )
sin
n
n
m
1,3,5,...
odd
o
	
(6.8a)
or
	

= π
ω
+
π
ω
+
π
ω
+
V
t
V
t
V
t
V
t
( )
2
sin
2
3
sin3
2
5
sin5
m
s
s
s
s
s
s
	
(6.8b)
where ωs is the switching frequency, which is set equal to the resonant frequency, ωr, 
of the LCR network to obtain tuned series resonant operation.
We need to find the output voltage across the load resistor. From Equations 6.2 
and 6.4,
	
ω =
ω
ω
V
V
H j
( )
( )
(
)
o
m
	
(6.9)
From Equation 6.9, it can be seen that the frequency spectrum of the output voltage 
is the product of 
ω
V ( )
m
 and 
ω
H j(
).
At the resonant frequency, ω = ωr, 
ω =
H j(
)
1. Thus, the fundamental component 
of midpoint voltage will not have any amplitude or phase change. The normalized 
moduli of the midpoint voltages frequency spectrum, 
ω
V ( )
m
, and the transfer func-
tion, 
ω
H j(
), are shown in Figure 6.3.
The next significant harmonic, the third harmonic, can be found when ω = ω
3
r 
from Equation 6.2 as
	
ω
=
+
ω
−
ω




H j
R
R
j
L
R
j
RC
( 3
)
1
3
1
3
r
r
r
	
(6.10a)
1
1
5
3
Normalized frequency
1/3
1/5
1
0.5
0.25
0.75
Q = 3
|H( jω)|,|Vm(ω)|
|H(jω)|
ωs
ωr
    
    
|Vm(ω)|
FIGURE 6.3  Frequency spectrum of 
ω
ω
H j
V
(
) ,
( )
m
 for series LCR network.
www.ebook3000.com

223
Switch-Mode Amplifier Design and Implementation
which reduces to
	
ω
=
+
ω
=
+
H j
j Q
H j
Q
( 3
)
1
1
8
3
or
( 3
)
3
9
64
r
r
2 	
(6.10b)
From the Fourier Series of the midpoint voltage, 
ω
V ( )
m
, we know that the amplitude 
of the third harmonic will be 1/3 of the fundamental. Hence, the ratio of the third 
harmonic to the fundamental in the output voltage from Equation 6.10 is
	
=
+
V
V
Q
1
9
64
m
m
2
3
1
	
(6.11)
For instance, the ratio of the third harmonic to the fundamental is 4% when 
=
Q
3. 
All other harmonics will be reduced considerably less than this.
For the rest of the analysis, we will assume Q to be high enough, so that all har-
monics are negligible. Under this assumption, the output voltage can be expressed as
	
=
= π
ω
V t
V
t
V
t
( )
( )
2
sin(
)
m
o
s
s
1
	
(6.12)
The current flowing out of the midpoint to the series LCR network is equal to the 
load current and expressed as
	
=
= π
ω
=
ω
i t
V t
R
V
R
t
I
t
( )
( )
(
)
(
)
2
sin
sin
L
o
s
s
p
s
	
(6.13)
where
	
= π
I
V
R
2
p
s 	
(6.14)
Because duty cycle is 50%, each switch is on half a period and conducts the load 
current. During the cycle when the switch is on, the current reaches the peak value 
of Ip. Once the switch is turned off, the voltage across the switch will be equal to Vs . 
The waveforms showing the switching operation of Class D amplifier is illustrated in 
Figure 6.4. The average current Is.avg and the RMS current Is.rms through each switch 
can then be written as
	
∫
=
ω
= π
I
T
I
t
t
I
(
)
1
sin
d
T
s.avg
s
p
s
p
0
s2
	
(6.15)
	
∫
=
ω
=
I
T
I
t
t
I
(
)
1
sin
d
2
T
s.rms
s
p
2
2
s
0
p
s2
	
(6.16)

224
Linear and Switch-Mode RF Power Amplifiers
Therefore, power at the output is equal to
	
=
= π
P
I R
V
R
2
2
out
p
2
s
2
2
	
(6.17)
which can also be expressed as
	
=
π
P
V I
out
s p 	
(6.18)
t
t
t
Gate driver signal for switch 1
Vm (t)
Vs /2
–Vs /2
Ts /2
S1 –ON
S1 –ON
Ts
vds (t), ids (t)
Ip
Vs
FIGURE 6.4  Switching waveforms for Class D Amplifier—S1.
www.ebook3000.com

225
Switch-Mode Amplifier Design and Implementation
The power utilization factor, U, which shows the output power capability, can be 
found for Class D amplifiers from
	
=
=
π =
U
P
nV I
1
2
0.159
out
p p
	
(6.19)
In Equation 6.19, Pout represents output, n is the number of switches in the amplifier, 
and Vp and Ip are the peak voltage and current for each switch, respectively.
In theory, for ideal cases, each switch does not have voltage across it while current 
is flowing at the same time. This results in an efficiency of 100%. It is important to 
note that each switch turns on at zero load current and voltage swings from one rail 
to another.
Having 100% efficiency is impossible in practice because switches are active 
transistors in real life, and they have nonlinear characteristics and internal para-
sitics such as output capacitance. When the switch or transistor turns on, it has to 
discharge its output capacitance, whereas output capacitance of the other switch is 
charged. This results in a capacitive energy loss during transition from on to off. The 
total power loss in the switch due to device parasitic capacitance can be expressed as
	
=
P
C V f
2
D
o
s
2
s 	
(6.20)
In Equation 6.20, fs is the switching frequency and Co is the output capacitance of 
each switch.
6.2.2  Current Mode Class D Amplifiers
Current mode Class D (CMCD) amplifier is shown in Figure 6.5. Odd harmonics are 
terminated by the resonator network in the amplifier. The drain current, id (t), can be 
represented as
	
∑
(
)
=
π
ω








=
∞
i t
I
n
n t
( )
4
1  sin
n
d
dc
1,3,5,...
	
(6.21)
The peak drain current is equal to
	
=
I
I
2
d
dc 	
(6.22)
The output voltage when harmonics are terminated is given as
	
=
ω
V t
V
t
( )
sin(
)
o
d
	
(6.23)
where Vd is the peak drain voltage and is expressed as
	
= π
V
I R
4
d
dc
L 	
(6.24)

226
Linear and Switch-Mode RF Power Amplifiers
The average drain voltage can be found from
	
∫
=
π
ω
ω
= π
π
V
V
t
t
V
1
2
sin(
) d(
)
1
dd
d
0
2
d 	
(6.25)
Hence, the peak drain voltage can be written as
	
= π
V
V
d
dd 	
(6.26)
From Equations 6.24 and 6.25,
	
= π
I
V
R
4
dc
2
dd
L
	
(6.27)
The drain current for each switch can be written by considering 180° phase shift 
between them as
	
∑
(
)
=
−π
ω
=
∞
i
t
I
I
n
n t
( )
4
1  sin
d
n
dc
dc
1,3,5,...
1
	
(6.28)
	
∑
(
)
=
+ π
ω
=
∞
i
t
I
I
n
n t
( )
4
1  sin
d
n
dc
dc
1,3,5,...
1
	
(6.29)
The difference between the switch drain currents leads to
	
∑
(
)
(
)
−
= −π
ω
−π
ω
=
∞
i
t
i
t
I
t
I
n
n t
( )
( )
8
sin
8
1  sin
d
d
n
dc
dc
3,5,7,...
1
2
	
(6.30)
Vd
is1
is2
vs1
vs2
vo
Load
Vd
+
+
FIGURE 6.5  Current mode Class D amplifier.
www.ebook3000.com

227
Switch-Mode Amplifier Design and Implementation
When all the odd harmonics are eliminated with the resonator, then Equation 6.30 
can be written as
	
(
)
−
= −π
ω
i
t
i
t
I
t
( )
( )
8
sin
d
d
dc
1
2
	
(6.31)
The expressions for drain voltages with even harmonics can be obtained similarly as
	
∑
(
)
(
)
(
)
=
+ π
ω
−
−
ω
=
∞
v
t
V
V
t
V
n
n t
( )
2
 sin
 
2
2
1
 cos 2
n
ds
dd
dd
dd
2
1
1
	
(6.32)
	
∑
(
)
(
)
(
)
=
−π
ω
−
−
ω
=
∞
v
t
V
V
t
V
n
n t
( )
2
 sin
 
2
2
1
 cos 2
n
ds
dd
dd
dd
2
1,2,3,...
2
	
(6.33)
The difference between drain-to-source voltage is then equal to
	
(
)
−
= π
ω
v
t
v
t
V
t
( )
( )
 sin
ds
ds
dd
1
2
	
(6.34)
In Equation 6.34, there are no harmonics, and hence they are being eliminated with 
this approach, which represents the ideal case. So for ideal case, the impedance at 
the fundamental frequency is found from
	
(
)
=
=
π
ω
−π
ω
= π
Z
V
I
V
t
I
t
V
I
f f
 sin(
)
8
sin
8
at 
 =
f
f
f
dd
dc
2
dd
dc
o
o
o
o
	
(6.35)
In addition, the impedance is open, Zn = ∞, for even harmonics, and Zn = 0 for odd 
harmonics. The summary of the impedance versus harmonics including fundamen-
tal is given Table. 6.1.
The waveforms describing the operation of CMCD amplifiers are shown in 
Figure 6.6.
TABLE 6.1
Summary of Impedance for CMCD Amplifiers for 
Harmonic Terminations
Frequency—(n fo)
Impedance—Zn
fo
π V
I
8
2
dd
dc
n—Odd
0
n—Even
∞

228
Linear and Switch-Mode RF Power Amplifiers
6.3  CLASS E AMPLIFIERS
The basic analysis of the Class D amplifiers shows that it is possible to obtain 100% 
efficiency in theory by modeling the active devices as ideal switches. However, 
this is not accurate specifically at higher frequencies as device parasitics such as 
device capacitances play an important role in determining the amplifier perfor-
mance, which makes the Class D amplifier mode of operation challenging. This 
challenge can be overcome by making parasitic capacitance of the transistor as 
part of the tuning network as it is done in Class E amplifiers (Figure 6.7). Class E 
amplifier shown in Figure 6.7 consists of a single transistor that acts as a switch 
S, an RF choke, a parallel connected capacitance Cp, a resonator circuit L-C, and 
a load RL (Figure 6.8). 
6.3.1  Conventional Analysis of Class E Amplifiers
In this section, conventional method to design Class E amplifiers for suboptimum 
and optimum cases will be discussed [4,11].
6.3.1.1  Suboptimum Conditions for Class E Amplifier Design
In the conventional analysis of the circuit shown in Figures 6.7 and 6.8, it is assumed 
that RF choke is ideal. In the circuit,
– A high Q resonator circuit, LC network, produces sinusoidal output signal at 
the output of the amplifier.
– The series resonant network Lo and Co are not tuned at the resonant 
­frequency, f. This creates a reactance that is represented by jX. This can be 
shown by
	
= ω
−ω
X
L
C
1
o
o
	
(6.36)
t
t
Vd
Vs
νds(t)
ids(t)
Ip
2π
π
FIGURE 6.6  Current mode Class D amplifier operational waveforms.
www.ebook3000.com

229
Switch-Mode Amplifier Design and Implementation
This effect can be illustrated in the equivalent circuit shown in Figure 6.8. In prac-
tice, L and C in Figure 6.8 can be considered to be tuned at the operational fre-
quency, creating a phase shift between the current and the voltage at the input 
of the tuned circuit. The phase can be used as a knob to adjust for the maximum 
efficiency.
Vdc
RF choke
RL
Lo
Co
C2
vo
vGS
Ctr
FIGURE 6.7  Simplified circuit of Class E amplifier.
Vdc
Idc
Cp
va
io
RL
vo
jX
vC
isw
RFchoke
L
C
ic
+
S
Equivalent of Lo and Co
Series tuned circuit
a
FIGURE 6.8  Equivalent Class E amplifier with switch S.

230
Linear and Switch-Mode RF Power Amplifiers
Cp in the equivalent circuit represents the equivalent capacitance formed by out-
put capacitance of transistor and shunt capacitance in the network. Capacitances are 
not dependent on voltage.
The circuit analysis can be done with the following conditions [11,13]:
•	 With the application of the input signal, Switch S is turned on, vc (θ) = 0, ic 
(θ) in capacitor is also zero. The switch current is equal to isw (θ) = Idc − io (θ).
•	 When Switch S is off, the switch current isw (θ) = 0, and the capacitor cur-
rent is equal to ic (θ) = Idc − io (θ). The drain-to-source voltage is created by 
charging the parallel capacitor.
•	 When Switch S changes from off to on, the capacitor discharges.
The waveforms of the voltage and current illustrating the operation of Class E ampli-
fier are given in Figure 6.9. Detailed analysis has been conducted, and waveforms are 
also given in Reference [4].
In Figure 6.8,
	
(
)
θ =
θ + φ
v
V
( )
sin
o
m
	
(6.37)
	
(
)
θ =
θ + φ
i
V
R
( )
sin
o
m
	
(6.38)
where θ = ωt, Vm is magnitude of output voltage, and ϕ is the phase of the output 
signal. The node voltage, va, can be calculated from
	
(
)
θ =
θ +
θ =
θ + ω +
θ + ω =
θ + φ
v
v
v
V
X
R
V
( )
( )
( )
sin(
)
cos(
)
sin
x
a
a
o
m
1 	
(6.39)
In Equation 6.39, vx is defined as the voltage drop across reactance X. The magnitude 
of the voltage at node a, va, is defined as
	
=
+ 



=
ρ
V
V
X
R
V
1
a
m
2
o 	
(6.40)
Its phase
	
φ = φ + ψ = φ +




x
X
R
arctan
1
	
(6.41)
The analysis can be performed better by considering the illustration given in 
Figure 6.10 for on and off times of the switch.
In Figure 6.10,
–Center of the off interval is chosen to be π/2.
–Off length angle is equal to 2y.
www.ebook3000.com

231
Switch-Mode Amplifier Design and Implementation
Switching instant when switch S is turned off is equal to θ1 = π/2 − y and when 
–S is turned on, it is equal to θ2 = π/2 + y.
When switch is off, capacitor will be charging via the current flowing through it. The 
capacitor voltage is found from
0
S–OFF
S–Switch
y
ON
OFF
OFF interval
π
π
2π
2π
2
π
θ1
θ2
θ1
vo(θ),io(θ)
vc(θ)
isw(θ)
θ2
θ1
θ2
θ
θ
θ
θ
y
φ > 0
φ < 0
φ
FIGURE 6.9  Voltage and current waveforms for basic Class E amplifier.

232
Linear and Switch-Mode RF Power Amplifiers
	
∫
θ = ω
ρ
ρ
θ
θ
v
C
i
( )
1
( )d
c
c
1
	
(6.42)
Because the capacitor current, ic (θ), ic (θ) = Idc − io (θ), θ1 = π/2 − y, Equation 6.42 can 
be expressed as
	
∫(
)
θ = ω
−
ρ
ρ
θ
π −
v
C
I
i
( )
1
( ) d
c
dc
o
y
2
	
(6.43)
Substituting Equation 6.38 into Equation 6.43 gives
	
∫
(
)
θ = ω
−
ρ+ φ



ρ
θ
π −
v
C
I
V
R
( )
1
sin
d
c
p
dc
m
y
2
	
(6.44)
Integrating Equation 6.44 gives the capacitor or drain-to-source voltage as
	
θ = ω
−π +



+
φ −
+
θ +
θ +




θ ≤θ ≤θ
v
C
I
y
V
R
y
I
V
R
y
( )
1
2
sin(
)
cos(
)
when
 
c
p
dc
m
dc
m
1
2
(6.45a)
	
θ =
v ( )
0   for all other conditions
c
	
(6.45b)
The series resonant circuit formed by Co and Lo gets into resonance at the switching 
frequency, f, and hence has no voltage across them at that frequency. This forces 
the capacitor voltage, vc (θ), to be equal to the node voltage at node a, va (θ). So, the 
magnitude of va (θ), Va, can be found from
	
∫
(
)
= π
θ
θ + φ
θ
π
V
v
1
( )sin
d
a
a
1
2
0
	
(6.46)
The solution of Equation 6.46 is [11]
S–Switch
2
y
y
ON
OFF
OFF
Interval 
θ
π
π
FIGURE 6.10  Illustration of on and off times of the switch.
www.ebook3000.com

233
Switch-Mode Amplifier Design and Implementation
which leads to
	
[
]
[
]
= −
πω
π −



+ πω
−φ






φ
+ πω
−
φ
+ π
φ
+
φ
−πω
φ + ψ
−
π
ψ
V
I
C
y
V
C R
y
y
I
C
y
y
y
y
V
C R
y
y
2
2
sin(
) cos
)sin( )
2sin(
)sin( )
cos(
)sin( )
2 sin(
)cos( )
sin(2
)sin(2 )
2
sin( )
p
a
dc
m
p
1
dc
p
1
1
1
m
p
	
(6.47)
Using Equations 6.40 and 6.41, we obtain the magnitude of the output voltage as
(
)
=
φ
+
φ
−
πω
ρ+
φ + ψ
−
ψ +
−φ
φ










V
I
y
y
y
y
y
C
y
y
y
y
2 sin( )cos(
)
sin(
) 2 cos( )
2sin( )
1
2 sin(2
)sin(2 )
sin( )
2sin(
)cos(
)sin( )
m
dc
1
1
p
1
  (6.48)
Because the fundamental component of the capacitor voltage does not have a cosine 
term for ϕ1 [4], this can be written as
	
∫
(
)
= π
θ
θ + φ
θ
π
v
0
1
( )cos
d
c
1
2
0
	
(6.49)
Equation 6.49 leads to
	
=
φ
−
φ
+
φ
−
φ −
φ
φ
−
φ + ψ +
ψ










V
I R
y
y
y
y
y
y
y
y
y
2 sin( )sin(
)
2 cos(
)cos( )
2cos(
)sin( )
2sin(
)cos(
)sin( )sin(
)
1
2 sin(2 )cos(2
)
cos( )
m
dc
1
1
1
1
1
	
(6.50)
Because Equations 6.48 and 6.50 are equal to each other, equating them gives ϕ as
	
φ =
−α
α



=
−α
α




arctan
arctan
2
3
0
1
	
(6.51)
where
	
α =
−
q s
q r
0
0 0
1 0 	
(6.52a)
	
α =
+
+
−
q s
q s
q r
q r
1
1 0
0 1
0 0
1 1 	
(6.52b)
	
α =
+
+
−
q s
q s
q r
q r
2
1 1
0 2
0 1
1 2 	
(6.52c)
	
α =
+
q s
q r
3
1 2
0 2 	
(6.52d)

234
Linear and Switch-Mode RF Power Amplifiers
and
	
(
)
=
−
ψ +
ψ
q
y
y
y
y
y
2 sin( )
2 cos( ) cos( )
2 sin( )sin( )
0
	
(6.53a)
	
(
)
=
ψ +
−
ψ
q
y
y
y
y
y
2 sin( )cos( )
2
cos( )
sin( ) sin( )
1
	
(6.53b)
	
(
)
=
−
ψ +
ψ
r
y
y
y
sin
y
sin( )cos( ) cos( )
2
( )sin( )
0
2
	
(6.54a)
	
=
ψ
r
y
2sin ( )sin( )
1
2
	
(6.54b)
	
(
)
=
−
ψ
r
y
y
y
sin( )cos( ) cos( )
2
	
(6.54c)
	
(
)
= π ω
ρ−
−
ψ +
ψ
s
R C
y
y
y
y
sin( )cos( ) sin( )
2sin ( )cos( )
0
p
2
	
(6.55a)
	
= −
ψ
s
y
2sin ( )cos( )
1
2
	
(6.55b)
	
(
)
= π ω
ρ−
−
ψ
s
R C
y
y
y
sin( )cos( ) sin( )
2
p
	
(6.55c)
It is important to note that the initial phase angle for ϕ ranges from −π/2 to π/2, 
whereas the solution of Equation 6.51 varies from −π to π. Therefore, addition or 
subtraction of π to the calculated value of ϕ may be needed. The value of the ϕ that 
should be used is the one when g in the following equation is positive:
	
=
φ
−
φ
+
φ
−
φ −
φ
φ
−
φ + ψ +
ψ
g
y
y
y
y
y
y
y
y
y
2 sin( )sin(
)
2 cos(
)cos( )
2cos(
)sin( )
2sin(
)cos(
)sin( )sin(
)
1
2 sin(2 )cos(2
)
cos( )
1
1
1
1
1
	
(6.56)
The average value of the drain-to-source voltage is equal to DC supply voltage and 
is found from
	
∫
=
π
θ
θ = πω
+
φ −
−
φ


π
V
v
I
C
y
yg
y
g
y
1
2
( )d
sin(
)
sin( )sin( )
dc
c
2
dc
p
2
0
	
(6.57)
Also,
	
=
V
I R
dc
dc
dc 	
(6.58)
Equating Equations 6.57 and 6.58 gives the value of the DC resistance that is pre-
sented to DC supply. Hence, Rdc is
	
=
+
φ −
−
φ
πω
R
y
yg
y
g
y
C
sin(
)
sin( )sin( )
dc
2
p
	
(6.59)
The output power of the amplifier in Class E mode is then found using Equations 6.50 
and 6.57 as
	
=
=
P
V
R
V g R
R
1
2
2
o
o
2
dc
2
2
dc
2
	
(6.60)
www.ebook3000.com

235
Switch-Mode Amplifier Design and Implementation
The DC input power of the amplifier is found similarly from
	
=
=
P
V R
V
R
dc
dc
dc
dc
2
dc
	
(6.61)
Therefore, the drain efficiency of the amplifier is
	
η
=
=
P
P
g
R
R
2
drain
o
in
2
dc
2 	
(6.62)
Substituting Equations 6.50 and 6.57 into Equation 6.45 gives the final expression for 
the drain-to-source voltage as
(
)
θ =
ω
θ +
−π +
φ −
+
θ + φ




θ ≤θ ≤θ
v
V
R C
y
g
y
( )
2
sin(
)
cos(
)
when
 
c
dc
p
1
2 	 (6.63a)
	
θ =
v ( )
0   for all other conditions
c
	
(6.63b)
The maximum value of the drain-to-source voltage is found by taking the derivate of 
Equation 6.63 with respect to θ as
	
(
)
(
)
θ
θ
= ω
−
θ
+ φ
=
θ=θ
v
V
C R
g
d
( )
d
1
sin
0
c
dc
p
dc
max
max
	
(6.64)
Solution of Equation 6.64 for θmax leads to
	
θ
=



−φ
g
arcsin 1
max
	
(6.65)
Substitution of Equation 6.65 into Equation 6.63 gives the maximum value of drain-
to-source voltage, vc (θ). Similarly, the minimum value of the drain-to-source volt-
age, vc (θ), occurs when
	
θ
= π −



−φ
g
arcsin 1
min
	
(6.66)
Earlier, it was given that when the switch was on, the switch current was equal to
	
θ =
−
θ
i
I
i
( )
( )
sw
dc
o
	
(6.67)
Then, the maximum value of the switch current is found as
	
=
+
=
+
=
+
I
I
V
R
I
I Rg
R
I
g
(1
)
sw,max
dc
m
dc
dc
dc
	
(6.68)

236
Linear and Switch-Mode RF Power Amplifiers
The power utilization factor for Class E amplifiers using Equations 6.60, 6.63, and 
6.68 is
	
=
U
P
V
I
out
c,max sw,max
	
(6.69)
6.3.1.2  Optimum Conditions Class E Amplifier Design
In the suboptimum analysis that is closer to practical case without considering any 
other component loss mechanism, the efficiency degrades due to discharge of capaci-
tor when the switch turns on. If the circuit component values are adjusted such that 
the capacitor voltage drops to zero at the instant when the switch turns on, the 100% 
efficiency is possible for Class E amplifiers. This condition can be met if
	
π +



=
v
y
2
0
c
	
(6.70)
From Equations 6.70 and 6.63
	
φ =
y
g
y
cos( )
sin( ) 	
(6.71)
The normalized slope of the capacitor voltage, which is equal to the drain-to-source 
voltage, is found from
	
(
)
(
)
ξ =
θ
θ
= ω
−
+ φ
θ=π+
V
v
C R
g
y
1 d
( )
d
1
1
cos
c
y
dc
2
p
dc
	
(6.72)
Substituting Equation 6.59 into Equation 6.72 gives
	
φ
=
−
ξ
π
−
+ ξ
π




y
y
y
y
y
y
sin( )
cos( )
cos( )
1
sin( )
opt
	
(6.73)
	
=
φ
g
y
y
cos(
)sin( )
opt
opt
	
(6.74)
Because efficiency is 100% for optimum operation, then, η = 1, and this leads, from 
Equation 6.59, to
	
=
R
g
R
2
dc
opt
2
	
(6.75)
In addition, the optimum value of the capacitance, Cp,opt, is
	
=
+
φ −
−
φ


π ω
C
y
yg
y
g
y
R g
2
sin(
)
sin(
)sin( )
p,opt
2
opt
opt
opt
2
	
(6.76)
www.ebook3000.com

237
Switch-Mode Amplifier Design and Implementation
We can also define the optimum value of ψ, ψopt, as
	
ψ
=
φ
+
φ
+
φ
+
φ
+
φ
−
φ




w
w
w
gy
w
w
w
arctan
sin(
)
cos(
)
cos(2
)
sin(
)
sin(2
)
cos(
)
opt
1
opt
2
opt
3
opt
2
opt
3
opt
1
opt
	
(6.77)
where
	
= −
φ
−
−
w
g
y
y
y
y
2 sin(
)sin( )
2 sin( )
1
opt
	
(6.78a)
	
=
−
w
y
y
y
2 cos( )
2sin( )
2
	
(6.78b)
	
= −
w
g
y
y
sin( )cos( )
3
	
(6.78c)
Equations 6.73 through 6.78 give the optimum values of the operational parameters 
for Class E amplifiers. Any other amplifier parameter for optimum operation can 
now be obtained using Equations 6.73 through 6.78.
Example 6.1
Design Class E amplifier operating at f = 1 MHz, with DC supply voltage of 10 V for 
suboptimum and optimum cases. Assume Cp = 700 [pF], R = 50 [Ω], and Q = 9.92. 
Compare results by obtaining the switching waveforms.
Solution: The solution for both suboptimum and optimum cases for Class E ampli-
fier is obtained using Mathcad. The Mathcad algorithm and waveforms are given 
below (Figures 6.11 through 6.14).
Suboptimum Case
Given Parameters
	
=
V
:
10
dc
	
=
⋅
=
⋅
=
⋅
−
f
f
Q
C
:
0.987 10
:
1 10
:
9.92315
: = 700 10
0
6
6
1
12
	
f
f
R
y
: = 2
(
):
2
:
50
: 2
0
0
ω
⋅π ⋅
ω
=
⋅π ⋅
=
π
0
2
4
6
0
10
20
30
40
50
Vc(θ)
θ
(a)
0
0
2
4
6
0
0.2
0.4
0.6
0
is(θ)
2.π
θ
(b)
FIGURE 6.11  Suboptimum waveform for Class E amplifier (a) Drain-to-source voltage and 
(b) switch current.

238
Linear and Switch-Mode RF Power Amplifiers
0
2
4
6
8
–20
–10
0
10
20
13.464
–13.464
Vo(θ)
6.283
0
0
2
4
6
8
–0.4
–0.2
0
0.2
0.4
0.269
–0.269
io(θ)
6.283
0
θ
θ
(a)
(b)
FIGURE 6.12  Suboptimum waveform for Class E amplifier (a) Output voltage and (b) out-
put current.
0
2
4
6
0
10
20
30
40
40
–1.395×10–14
Vc opt(θ)
0
θ
2.π
0
2
4
6
0
0.2
0.4
0.6
0.8
0.9
0
is opt(θ)
0
θ
2.π
(a)
(b)
FIGURE 6.13  Optimum waveform for Class E amplifier (a) Drain-to-source voltage and (b) 
switch current.
www.ebook3000.com

239
Switch-Mode Amplifier Design and Implementation
Calculation Begins
	
C
R
L
C
B
C
L
f
C
:
1
(
)
Q
:
1
(
)
:
:
30
1
4
0
0
1
0
0
2
0
choke
2 2
= ω
⋅
⋅
= ω
⋅
= ω⋅
=
⋅
⋅π
⋅
	
⋅π ⋅⋅
−
⋅π
⋅
X
f L
f C
: = (2
)
1
2
0
0
	
ψ




X
R
: = atan
	
X
R
: = 1
2
ρ
+



0
2
4
6
8
–20
–10
0
10
20
10.741
–10.741
Vo opt(θ)
6.283
0
6.283
0
0
2
4
6
8
–0.3
–0.2
–0.1
0
0.1
0.2
0.3
0.215
–0.215
io opt(θ)
θ
θ
(a)
(b)
FIGURE 6.14  Optimum waveform for Class E amplifier (a) Output voltage and (b) output 
current.

240
Linear and Switch-Mode RF Power Amplifiers
	
(
)
( )
( )
( )
( )
( )
=
⋅
⋅
⋅
ψ
⋅
⋅
⋅
ψ
q
y
y
y
y
y
:
2 sin
–
cos
cos
+ 2
sin
sin
0
	
q
y
y
y
y
y
: = 2
sin
cos
+ 2
cos
– sin
sin
1
( )
( )
( )
( )
( )
( )
⋅
⋅
⋅
ψ
⋅
⋅

⋅
ψ
	
r
y
y
y
y
: =
– sin
cos
cos
+ 2 sin
sin
0
2
(
)
(
)
( )
( )
( )
( )
( )
⋅
⋅
ψ
⋅
⋅
ψ
	
r
y
: = 2 sin
cos
1
2
(
)
( )
( )
⋅
⋅
ψ
	
r
y
y
y
: =
– sin
cos
cos
2
(
)
( )
( )
( )
⋅
ψ
	
s
B R
y
y
y
y
:
–
– sin
cos
sin
+ 2 (sin( ))
cos( )
0
2
(
)
( )
( )
( )
= π ⋅
⋅
⋅ρ
⋅
⋅
ψ
⋅
⋅
ψ
	
s
y
:
2 (sin( ))
sin( )
1
2
= −⋅
⋅
ψ
	
s
B R
y
y
y
:
(
sin( ) cos( )) sin( )
2 = π ⋅
⋅
⋅ρ−
−
⋅
⋅
ψ
	
q
s
q
r
: =
0
0
0
1
0
α
⋅
−
⋅
	
q
s
q
s
q
r
q
r
:
1
1
0
0
1
0
0
1
1
α
=
⋅
+
⋅
+
⋅
−
⋅
	
q
s
q
s
q
r
q
r
:
2
1
1
0
2
0
1
1
2
α
=
⋅
+
⋅
+
⋅
−
⋅
	
q
s
q
r
:
3
1
2
0
2
α
=
⋅
+
⋅
	
:
atan
0
1
φ =
−α
α




	
:
1φ = φ + ψ
	
g
y
y
y
y
y
y
y
y
y
:
2
sin( ) sin( )
2
cos( ) cos( )
2 cos( ) sin( )
2 sin(
) sin( ) sin( )
0.5 sin(2
) cos(2
)
cos( )
1
1
1
=
⋅
⋅
φ ⋅
−
⋅
⋅
φ ⋅
+
⋅
φ ⋅
−⋅
φ −
⋅
⋅
φ −
⋅
⋅
⋅
⋅φ + ψ +
⋅
ψ
1
	
+
⋅
⋅
φ −
−
φ ⋅
π ⋅
R
y
g
y
y
y
: =
((
sin(
)
sin( ) sin( )))
B
dc
2
	
P
V
g
R
R
: = (
)
2 (
)
o
dc
2
2
dc
2
⋅
⋅
⋅
	
P
V
R
:
(
)
dc
dc
2
dc
=
	
I
V
B
y
y g
y
g
y
:
sin(
)
sin( ) sin( )
dc
dc
2
(
)
(
)
=
⋅π ⋅
+
⋅
⋅
φ −
−
⋅
φ ⋅




	
V
I
y
y
y
y
:
[cos( ) sin( )
(2
cos( )
2 sin( )) sin( )]
1
dc
1
1
=
⋅
φ ⋅
+
⋅
−
⋅
⋅
φ
	
V
I
R g
:
out
dc
=
⋅
⋅
	
a
:
sin 1
g
max
θ
=



−φ
www.ebook3000.com

241
Switch-Mode Amplifier Design and Implementation
	
a
g
:
sin
1
min
θ
= −



−π
	
I
I
V
R
:
+
s.max
dc
out
=
	
:
0
1
θ =
	
:
2
θ
= π
	
A
V
B R
y
g
y
( ):
2
(sin(
)
cos(
))
dc
dc
θ =
⋅
⋅
θ +
−π



+
⋅
φ −
+
θ + φ




	
V
A
( ):
if[(
),
( ), 0]
c
1
2
θ =
θ ≤θ ≤θ
θ
	
V
V
( ): =
sin(
)
o
out
θ
⋅
θ + φ
	
i
V
R
( ) :
sin(
)
o
out
θ
=
⋅
θ+ φ
	
B
I
i
( ) :
( )
s
dc
o
θ
=
−
θ
	
i
B
( ) : = if [(
),0,
( )]
s
1
2
s
θ
θ ≤θ ≤θ
θ
	
V
V
B R
y
g
y
: =
+
2
(sin(
)+cos(
+
))
max
dc
dc
max
max
⋅
⋅
θ
−π



+
⋅
φ −
θ
φ




	
I
I
V
R
: =
+
s.max
dc
out
	
P
V
I
Capacity : =
o
max
s.max
⋅
	
P
P
: =
o
dc
η
Power dissipated by discharging the capacitor when switch is turned off at
	
P
C
V
f
: = 0.5
(
( ))
dis
c
2
⋅
⋅
π
⋅
Given Parameters
	
V
C
L
C
R
= 10
= 7
10
= 8.001
10
= 3.25
10
= 50
dc
10
0
5
0
10
×
×
×
−
−
−
Calculated Parameters
	
V
= 10
dc
	
φ = −0.201
ψ
φ  = 0.053
θ
θ
−
1
X = 12.985
= 0.254
= 1.05
=
0.849
max
min
	
R
V
I
I
V
= 49.467
= 13.464
= 0.202
= 0.471
= 28.737
dc
out
dc
s.max
max
	
P
P
P
Capacity = 0.134
= 0.209
= 2.022
= 0.897
= 1.813
dis
dc
o
η
	
L
C
C
L
= 1.086
10
= 7
10
3.25
10
8.001 10
choke
3
10
0
10
0
5
×
×
=
×
=
×
−
−
−
−

242
Linear and Switch-Mode RF Power Amplifiers
The waveforms obtained are shown in Figures 6.11 and 6.12.
Optimum Case
The waveforms obtained are shown in Figures 6.13 and 6.14.  
6.3.2  Harmonic Modeling of Class E Amplifiers
An analysis of the Class E power amplifier is given using harmonic modeling that 
facilitates the characterization of the power amplifier for a wide load-space regime 
expected in variety of applications. In this section, using a matrix-framework of the 
direct and quadrature components of dominant harmonics, a quasi-linear algorithm 
is developed to determine the voltage and current levels expected on all compo-
nents of the power amplifier for arbitrary loading and operating conditions, with high 
accuracy [14]. Results of the algorithm are validated by comparison with simulation 
and experimental results. Applications of the algorithm to circuit design extensions 
such as phase-controlled Class E power amplifier pairs are described.
Several applications require power amplifier circuit topologies that are conducive 
to yield higher power conversion density, increased efficiency, and more importantly, 
enhanced power delivery facilities such as flexible RF envelope waveform generation, 
while not increasing the size, volume, and heat dissipation profiles. Class E–based 
power amplifiers are highly suited for high-power density with low-power losses due to 
single switching stage configuration and the switch-mode operation, and are increas-
ingly used as building blocks in applications such as radio transmitters, plasma genera-
tors, etc. However, due to the inherent basis of resonance for power conversion and the 
switch-mode operation, their control characteristics are nonlinear, which are highly 
affected by the load impedance and other operating parameters such as the rail volt-
age, duty cycle of the gate voltage, and the control technique used, such as out-phasing. 
Moreover, due to the reactive currents and voltages involved in the circuit operation, 
and the high harmonic content due to switching operation, the voltage and current 
stresses on critical components are significantly higher than that of conventional “lin-
ear” power amplifiers such as Class AB. In addition, the transient and short-term loads 
expected in practice for some RF applications are far from the standards (such as 50 
Ω) the power amplifiers are typically designed or optimized for, and the voltage and 
current stresses imposed on the power amplifier circuit and components are higher for 
such nonstandard loads. In view of this, analytical and simulation tools that accurately 
and quickly characterize the voltage and current profiles of the nonlinear power ampli-
fiers, such as Class E, for arbitrary load and operating conditions are highly desired.
The analysis of single-ended Class E power amplifier using an ideal switch and a 
high Q-factor for the resonator such that the resultant RF load current is a pure sine 
wave with no harmonic content is discussed in detail in the literature [4,10,13,15]. 
The focus of the work reported in these references was to develop the power ampli-
fier design that optimizes it for standard load configurations. For example, in [16], 
a comprehensive design procedure for the Class E amplifier is given by deriving 
explicit and accurate design equations and optimizing component selection that 
shapes the power switch voltage and current waveforms for maximizing power con-
version efficiency, assuming a fixed load configuration. An exact analysis of the 
www.ebook3000.com

243
Switch-Mode Amplifier Design and Implementation
Class E amplifier using detailed circuit analysis based on Laplace transforms is pre-
sented in [17], which increases the accuracy of design equations taking into account 
the precise dependency of these equations on the Q-factor. The work reported in 
Reference [18] extends this analysis to power switch configuration variations, such as 
that with antiparallel or series diodes, with the objective of improving the efficiency 
for bounded variations of the load resistor. Reported in [19] is a design procedure 
for Class E amplifiers, which does not use explicit waveform equations, but instead 
uses nonlinear algebraic equations based on Poincare mapping of periodical func-
tions describing the amplifier circuit operation and solving them using Newton’s 
iterative algorithm. A noniterative design procedure based on a time-domain ana-
lytical solution for the Class E amplifier is presented in Reference [20], which pro-
vides increased degrees of freedom in choosing the circuit parameters. A frequency 
domain-based analysis of the idealized microwave Class E amplifiers is presented in 
Reference [21], where a generalized harmonic-based model is used to derive a set of 
linear equations to describe the amplifier functionality.
A major focus of this section is the performance analysis of the Class E–based 
amplifiers for varied loads, operating conditions, and control strategies, assuming that 
the design of the amplifier has been optimized for a standard load configuration. The 
modeling approach taken in this chapter is motivated by the a priori qualitative knowl-
edge on the harmonic distortion characteristics of the various voltage and current sig-
nals of the Class E amplifier, and each voltage and current waveform can be considered 
to be composed of multiple, but finite order, harmonics of the RF wave, with the level 
of harmonic content dependent on the topological location of the voltage or current 
signal. For example, the voltage across the switching device is rich in second harmonic 
content, and the input current is rich in DC content, whereas the output voltage and 
currents typically have low harmonic content due to output filtering. This approach 
provides an analytical framework made up of algebraic equations that can be solved 
for the full characterization of the Class E amplifier under varying loads and operat-
ing conditions. Although the resulting algebraic equations in general are nonlinear, 
they are decomposed into a major set of linear equations (corresponding to the passive 
networks) and a minor set of nonlinear equations (corresponding to the switching net-
works), which allow the use of simple iterative techniques for solving. The approach 
presented in this chapter differs from that in Reference [21], where the assumption that 
the power switch can withstand negative voltage (which ignores the antiparallel diode 
functionality) simplifies the frequency-domain circuit equations to a linear form.
Figure 6.15 shows the circuit topology of the basic Class E power amplifier stage. 
It consists of a DC input voltage source with voltage Vdc, an input harmonic filter, a 
single-ended switch S1 with antiparallel diode D1, capacitor Cs shunting the switch, a 
series resonant circuit Lr − Cr, and an output harmonic filter feeding into an arbitrary 
load (shown as an R-C network in the figure, as an example). The power losses for 
nominal operating load are kept low by minimizing the time-overlap of voltage and 
current across the switch, which typically is accomplished using zero voltage switch-
ing and zero derivative switching. With this, most of the incurred power losses are 
the result of conduction losses of the switching device.
Analysis of the single-ended Class E power amplifier is performed using the fol-
lowing simplifying assumptions: ideal DC power source, ideal power switch with 

244
Linear and Switch-Mode RF Power Amplifiers
no conduction losses, fixed capacitance across the power switch, resonant inductor–
capacitor pair, and the capacitor across power switch optimally chosen for maximum 
power efficiency for a standard reference load. The analysis is aimed at the full 
characterization of key circuit voltages and currents of the Class E power amplifier 
for arbitrary loads and for a variety of control methods such as the duty cycle con-
trol, rail voltage control, and the phase control of a power amplifier pair. The circuit 
variables and parameters of interest include the current and the voltage profile of the 
power switch, the range and linearity of control achievable with different control 
methods, and power losses due to any hard-switching of the shunt capacitor voltage.
Referring to Figure 6.15, under steady-state operation, the instantaneous total 
current isc (within an RF cycle) through the power switch and the shunt capacitor is 
written in terms of the current i1 at the output of the input filter LCi and the current i2 
through the resonant inductor–capacitor circuit Lr, Cr, using their fundamental and 
harmonic phasor components (i.e., direct and quadrature axes coordinate values):
	
∑
θ =
+
−
θ +
−
θ
=
i
i
i
i
h
i
i
h
[(
)
(
)
(
)
(
)]
( )
sin
cos
h
n
sc
dc
1dh
2dh
1qh
2qh
1
	
(6.79)
where θ is an arbitrary angle in radians within an RF cycle, between δ and π + δ
2
, 
where δ is the phase angle of the RF gate-drive signal with reference to an arbitrary 
reference; idc is the DC component of current i1; h is the harmonic number ranging 
from 1 to an arbitrary number n; i1dh and i2dh are the direct axis components of the hth 
harmonic of currents, respectively; i1 and i2, and i1qh and i2qh are the quadrature axis 
components of the hth harmonic of currents, i1 and i2, respectively.
During an RF cycle, the average of the current through the power switch S1, which 
is turned on at δ and conducts between angles δ and ψ + δ, is given by
	
∫
=
π
θ
θ
δ
ψ+δ
i
i ( )
1
2
d
so
sc
	
(6.80)
In Equation 6.80, ψ = πτ
2
, where τ is the duty cycle of RF gate control signal. Note 
that iso should equal idc, the DC current drawn from the DC input source, and this fact 
can be used to verify the correctness of any solution that would be obtained through 
the analysis.
LCo
i2
isc
io
vo
vs
Zo
i1
vi
LCi
Lr
Cr
Cs
S1
Ldc
Vdc
FIGURE 6.15  Circuit configuration of the single-stage Class E power amplifier.
www.ebook3000.com

245
Switch-Mode Amplifier Design and Implementation
With an antiparallel diode connected across the switch (such as the body diode 
of a Metal Oxide Field Effect Transistor [MOSFET]), the instantaneous voltage vs 
across S1 at angle q during an RF cycle is either zero or positive, as any potential 
negative voltage will be clamped to zero by the diode. Typical cases of the switch 
voltage waveforms are depicted in Figure 6.16. Let us represent the angles at which 
the positive to zero transitions occur by α
= π + δ −ε
2
k
k
2
2 , and at which the zero to 
positive transitions occur by α
= π + δ −ε
=
+
+ k
2
,
0,1,....
k
k
2
1
2
1
, 
≤ε ≤ε ≤ε
0
...
0
1
2
 and 
ε0 is such that at θ = π + δ −ε
2
0, 
θ
v ( )
s
 reaches zero, or at which the next RF half cycle 
commences, if vs (θ) does not reach zero prior to 2π + δ. Note that in the latter case, 
ε = 0
0
.
The positive value of the switch voltage is given by
	
∫
∫
θ =
ω
φ
φ







ψ + δ ≤θ ≤π + δ −ε
ω
φ
φ








π + δ −ε ≤θ ≤π + δ −ε
π + δ −ε ≤θ ≤π + δ −ε











ψ+δ
θ
π+δ−ε
θ
v
C
i
d
C
i
d
( )
1
( )
,
2
1
( )
, 2
2
0,
2
2
s
s
sc
2
s
sc
2
1
0
2
1
1
	
(6.81)
In Equation 6.81, w is the RF frequency in radians per second, Cs is the capacitance 
in parallel with the power switch S1, and angle φ is the variable for integration. The 
average voltage vs0 across the power switch during an RF cycle is given by
	
∫
=
π
θ
θ
ψ+δ
π+δ−ε
v
v ( )
1
2
d
s
s
2
o
0
	
(6.82)
Instant at which power switch
is turned on for the next cycle
Case 3
Conduction
Case 2
Case 1
0
δ
2π + δ – ε0
2π + δ
2π + δ – ε2
2π + δ – ε1
ψ + δ
FIGURE 6.16  Description of ε ε,
0
1 and ε2 for three typical waveforms of voltage.

246
Linear and Switch-Mode RF Power Amplifiers
Note that vso should equal the DC source voltage Vdc.
The direct and quadrature axes components vsdh and vsqh, respectively, of the hth 
harmonic of the voltage across S1 are given by
	
∫
=
θ
θ
θ
ψ+δ
π+δ−ε
v
v
h
( )
(
)
sin
d
sdh
s
2
o
	
(6.83)
	
∫
=
θ
θ
θ
ψ+δ
π+δ−ε
v
v
h
( )
(
)
cos
d
sqh
s
2
o
	
(6.84)
The equation relating the direct and quadrature harmonic components of current i1, 
the voltage vs across S1, and the voltage vi at the input nodes is given by





=
−











+
−












v
v
k
k
k
k
v
v
z
z
z
z
i
i
idh
iqh
adh
aqh
aqh
adh
sdh
sqh
adh
aqh
aqh
adh
dh
qh
1
1
	
(6.85)
where scaling factors kadh and kaqh and impedance factors zadh and zadh are constants 
determined by the input filter network and the DC inductor L1. Note that with ideal 
DC voltage source connected at the input node, the direct and quadrature harmonic 
components vidh and viqh should be zero.
The equations relating the direct and quadrature harmonic components of cur-
rent i2, the voltage vs across S1, the output voltage vo, and the output current io are 
given by,





=
−











+
−












v
v
k
k
k
k
v
v
z
z
z
z
i
i
sdh
sqh
bdh
bqh
bqh
bdh
odh
oqh
bdh
bqh
bqh
bdh
odh
oqh
	
(6.86)





=
−











+
−












i
i
y
y
y
y
v
v
k
k
k
k
i
i
dh
qh
cdh
cqh
cqh
cdh
odh
oqh
cdh
cqh
cqh
cdh
odh
oqh
2
2
	
(6.87)
where scaling factors kbdh, kbqh, kcdh, and kcqh, impedance factors zbdh and zbqh, and 
admittance factors ycdh and ycqh are constants determined by the series resonant filter 
network Lr, Cr and the output filter network LCo. The equation relating the output 
current io and the output voltages vo is given by
	





=
−












v
v
z
z
z
z
i
i
odh
oqh
cdh
cqh
cqh
cdh
odh
oqh
	
(6.88)
where zcdh and zcqh are the load impedance components.
www.ebook3000.com

247
Switch-Mode Amplifier Design and Implementation
An exact solution for the single Class E PA configuration can be obtained by solv-
ing the system of simultaneous nonlinear equations encompassing expressions 6.82 
through 6.88, with vidh, and viqh set to zero, and vs0 set to Vdc.
6.4  CLASS DE AMPLIFIERS
The deficiency seen in Class D amplifiers due to capacitive switching losses can be 
improved by operating the amplifier above the resonant frequency of tuned circuit. 
This will help reducing the conduction angle of the switches and the duty cycle 
below 50%.
We begin analysis by assuming the load current to be equal to
	
=
ω
i t
I
t
( )
(
)
sin
s
L
p
	
(6.89)
The total change for both output capacitances of the switches is
	
=
Q
C V
2
2
o
o
s 	
(6.90)
It can also be written that
	
=
i
Q
t
(
)
d 2
d
L
o
	
(6.91)
	
=
Q
i t
t
(
)
( )
d 2
d
L
	
(6.92)
	
∫
=
Q
Q
i t
t
( )
2
d
o
T
L
	
(6.93)
Hence,
	
∫
ω
=
ϕ
ω
πω
I
t
t
C V
sin(
) d
2
p
s
o
s
s
s
	
(6.94a)
or
	
ω −
ω
=
ϕ
ω
πω
I
t
C V
cos
2
p
s
s
o
s
s
s
	
(6.94b)
which leads to
	
ω
−
ω
π
ω −
ω
φ
ω







=
I
C V
cos
cos
2
p
s
s
s
s
s
o
s 	
(6.95a)
or
	
(
)
ω
+
φ =
I
C V
1
cos
2
p
s
o
s 	
(6.95b)

248
Linear and Switch-Mode RF Power Amplifiers
Equation 6.95b leads to
	
φ =
ω
−
< φ < π
C V
I
cos
2
1
for 0
s
o
s
p
	
(6.96a)
So,
	
φ =
ω
−




< φ < π
−
C V
I
cos
2
1
for 0
1
s
o
s
p
	
(6.96b)
where φ is the conduction angle. The conduction angle φ is between 0° and 180°.
Using Equation 6.96, the maximum frequency of operation is obtained when 
φ = 0 as
	
=
ω
−
C V
I
1
2
1
s
o
s
p
	
(6.97a)
or
	
=
π
f
I
C V
2
s
p
o
s
	
(6.97b)
The average switch current can be found from
	
∫
=
ω
I
T
I
t
t
(
)
1
sin
d
t
s.avg
s
p
s
0
ON
	
(6.98a)
or
	
I
I
2
1
cos
s.avg
p (
)
=
π
−
φ 	
(6.98b)
In addition, we can calculate the rms value of the switch current as
	
∫
=
ω
I
T
I
t
t
(
)
1
sin
d
t
s.rms
s
p
2
2
s
0
ON
	
(6.99a)
or
	
I
I
2
2
sin2
2
s.rms
p
(
)
=
ϕ −
φ
π
	
(6.99b)
Apart from the usual ratings of a switch, another specification is of importance at 
high frequencies and pertains to the allowed rate of change of voltage across the 
switch. The maximum value of the rate of change for voltage (
)
d d/
v
t  imposed on a 
switch occurs when the switch turns off. When the switch turns off,
	
=
d
d
I C
v
t
	
(6.100)
www.ebook3000.com

249
Switch-Mode Amplifier Design and Implementation
where 
=
φ
i t
I
( )
sin
L
p
. So, Equation 6.100 can be written as
	
=
ϕ
V
t
I
c
d
d
2
sin
max
p
o
	
(6.101)
The output power is found from,
	
=
π
−
φ
P
V I
2
(1
cos )
out
s p
	
(6.102)
Power output depends on conduction angle and reaches its maximum value when ϕ  
is 180°.
The power utilization factor for Class DE operation is found from
	
=
=
π
−
ϕ
U
P
nV I
V I
n V I
(
)
(
)
2
1
cos
out
p p
s p
p p
	
(6.103)
Since the number of switches is 2, =
n
2, then U is equal to
	
=
−
ϕ
π
U
(
)
1
cos
4
	
(6.104)
U is again maximum and is equal to U = 0.159 when 

φ = 180 . This shows that the 
operation of Class DE amplifier remains in Class D operation when conduction angle 
is 

φ = 180 .
V
t( )
m
 in Figure 6.17 during ton < t < Ts/2 can be found from
	
∫
= −
ω
+
V
t
c
I
t
t
K
( )
(
)
1
2
sin
d
m
o
p
s
 	
(6.105)
Since 
=
V
t
V
(
)
2
m
ON
s , the solution of Equation 6.105 can be written as
	
=
+
ϕ
ω
+
−
ϕ
+
ϕ




V
t
V
t
V
t
t
T
( )
(1
cos ) cos(
)
2
1
cos
1
cos
for 
<  < 
/2
m
s
s
s
on
s
	
(6.106)
–Vs / 2
Vs / 2
L
C
Co
R
ic1(t)
ic2(t)
Vm(t)
+
Vo(t)
Co iL (t)
FIGURE 6.17  Class DE amplifier with each switch having on output capacitance co.

250
Linear and Switch-Mode RF Power Amplifiers
The fundamental component of Vm (t) can be found using Fourier analysis as
	
(
)
=
π
+
φ
π −φ
φ
φ
+
φ
ω
+ β
v
t
V
t
( )
2 2 (1
cos )
sin cos
sin
cos(
)
m
s
2
4
s
1
	
(6.107)
where
	
β =
−
φ
π −φ +
φ
φ




−
tan
sin
sin cos
1
2
	
(6.108)
Substitution of maximum and minimum values of ϕ into Equation 6.107 gives the 
magnitude of the fundamental component as
	
= π
φ 
V
V
2
for = 180°
m
s
1
	
(6.109a)
	
=
φ
V
V
2
for  = 180°
m
s
1
	
(6.109b)
We introduce the phase angle, α, between the fundamental and the load current as
	
α = β + π
2 	
(6.110)
Substituting Equation 6.108 into Equation 6.110 gives
	
α =
π −φ +
φ
φ
φ




−
tan
sin cos
sin
1
2
	
(6.111)
It is seen from Equation 6.111 that Class D operation is obtained when ϕ =
α =
180 ,
0 .

 
At this phase angle, load current will be in phase with the fundamental. On the other 
hand, when 


ϕ =
α =
0 ,
90 , load will be an inductive load.
6.4.1  Analysis of Series Resonant Network
Consider the series resonant LCR network in Figure 6.17, which is given as a refer-
ence in Figure 6.18.
The resonant frequency of the network shown in Figure 6.18 is
	
ω =
LC
1
r
	
(6.112)
We can define the loaded quality factor for the network as
	
= ω
= ω
Q
L
R
CR
1
r
r
	
(6.113)
www.ebook3000.com

251
Switch-Mode Amplifier Design and Implementation
The equivalent impedance of the network is obtained as
	
=
+
ω −ω



=
+
ω
ω −ω
ω








Z
R
j
L
C
R
jQ
1
1
r
r
	
(6.114)
Z in Equation 6.114 is a complex impedance and can also be written as
	
=
+
=
∠θ°
Z
R
jX
Z
	
(6.115)
where
	
=
+
ω
ω −ω
ω












Z
R
jQ
1
r
r
2
2
	
(6.116a)
	
θ =
ω
ω −ω
ω








−
Q
tan 1
r
r
	
(6.116b)
and
	
=
θ
R
Z cos
	
(6.117a)
	
=
θ
X
Z sin
	
(6.117b)
If the frequency of operation for the series resonant LCR network is above the reso-
nant frequency, then load current will lag the fundamental component of vm (t). This 
is a requirement for the amplifier to operate in Class DE mode. This can be better 
understood by considering the modified circuit illustrating the operation above reso-
nant frequency in Figure 6.19.
When the network shown in Figure 6.19 gets into resonance, the fundamental 
component of vm (t) will see impedance, Z′, which is equal to
	
′ =
+
′
Z
R
jX 	
(6.118)
The new impedance, Z′, can be found using circuit analysis as
	
(
)
′ = π
−
φ +
π
π −φ+
φ
φ
+
φ




Z
V
I
j V
I
1 cos
sin cos
1 cos
s
p
s
p
	
(6.119)
L
C
R
iL(t)
Vm(t)
Vo(t)
+
FIGURE 6.18  Series resonant LCR network.

252
Linear and Switch-Mode RF Power Amplifiers
From Equations 6.118 and 6.119,
	
(
)
= π
−
φ
R
V
I 
1 cos
s
p
	
(6.120)
	
′ = π
π −φ+
φ
φ
+
φ




X
V
I
sin cos
1 cos
s
p
	
(6.121)
when 
=
V
I
1
s
p
, ′
R , and ′
X  can be plotted versus ϕ.
The component values for Class DE operation are found from Equation 6.120 and
	
θ =
α =
= π −φ+
φ
φ
φ
=
ω
ω −ω
ω




X
R
Q
tan
tan
sin cos
sin2
r
r 	
(6.122)
where ω = ωs in Equation 6.122. From Equation 6.122, we obtain the resonant fre-
quency as
	
ω = ω
α



+
−
α








Q
Q
2
tan
4
tan
r
2
	
(6.123a)
or
	
=
α



+
−
α








f
f
Q
Q
2
tan
4
tan
r
2
	
(6.123b)
Q is the designer’s choice and will be selected between 3 and 5 for Class DE opera-
tion. Once ωr is known, L and C in the original series resonant network given in 
Figure 6.18 are calculated from
	
= ω
L
QR
r
	
(6.124a)
	
= ω
C
L
1
r
2
	
(6.124b)
L1
C
R
Vm(t)
Vo(t)
iL(t)
+
Resonant section
Z'
X '
FIGURE 6.19  Modified circuit for operation above resonant frequency.
www.ebook3000.com

253
Switch-Mode Amplifier Design and Implementation
The summary of the design procedure for Class DE amplifier can be outlined as 
follows:
– Design parameters including operating voltage, frequency, peak current, 
Coss, and Vds are given.
–  Calculate conduction angle, ϕ, from Equation 6.96b.
	
φ =
ω
−






−
C V
I
cos
2
1
1
s
o
s
p
	
(6.125)
If there is large variation in the output capacitance of the transistor, Coss, then use 
data sheet information for QT vs Vds. For instance, the typical data sheet showing Coss 
versus Vds for MOSFET transistor is given in Figure 6.20.
There is a large variation in Coss as shown in Figure 6.20. Hence, using Coss given 
might not lead to an accurate conduction angle, ϕ. Instead, it might be better to use 
charge information for the transistor. When charge information is available for the 
transistor, we can use the following equation for the conduction angle:
	
φ =
ω
−






−
Q
I
cos
2
1
1
s
Ts
p
	
(6.126)
where Q is the total charge needed to raise Vds of transistor to the given supply volt-
age, Vs.
	
=
Q
C V
T
o
	
(6.127)
Calculate Po from Equation 6.102.
	
=
π
−
φ
P
V I
2
(1 cos )
out
s p
	
(6.128)
10000
8000
6000
4000
2000
0 0
2
VDS, Drain to source voltage [V]
C, Capacitance [pF]
10
5
2
5
102
CRSS = CGD
COSS ≈ CDS + CGD
CISS = CGS + CGD
VGS = 0V, f = 1MHz
CRSS
COSS
CISS
FIGURE 6.20  Typical MOSFET Coss versus Vds given in manufacturer data sheet. 
(From IRF450 Transistor Datasheet. http://www.irf.com/product-info/datasheets/data/
jantx2n6770.pdf.)

254
Linear and Switch-Mode RF Power Amplifiers
Find phase angle, α, between load current and fundamental of vm (t) from 
Equation 6.111.
	
α =
π −φ+
φ
φ
φ




−
tan
sin cos
sin
1
2
	
(6.129)
Choose Q between 3 and 5.
Calculate the resonant frequency of the series resonant network from Equation 
6.123b.
	
=
α



+
−
α








f
f
Q
Q
2
tan
4
tan
r
2
	
(6.130)
Calculate the component values R, L, and C of the resonant network from Equations 
6.124 and 6.120 as
	
= ω
L
QR
r
	
(6.131a)
	
= ω
C
L
1
r
2
	
(6.131b)
	
(
)
= π
−
φ
R
V
I 
1 cos
s
p
	
(6.131c)
Find the average and rms values of the switch current from Equation 6.99 as
	
∫
=
ω
I
T
I
t
t
(
)
1
sin
d
t
s.rms
s
2
2
s
0
p
ON
	
(6.132a)
	
(
)
=
ϕ −
φ
π
I
I
2
2
sin2
2
s.rms
p
	
(6.132b)
Example 6.2
Assume that the following operational parameters for the amplifier are given:
Operating voltage: V
300 V
s =
Peak current: I
16 A
p =
Operating frequency: f
5 mHz
=
Transistor Parameters: Rated Voltage: 500 V, Rated Current : 14 A. Co = 370 pF. 
Design this amplifier to operate in Class DE mode for loaded Q of 3.75.
Solution: From the given data, the conduction angle, ϕ,
	
c V
I
cos
2
1
124.54
1
s
o
s
p

ϕ =
ω
−



=
−
www.ebook3000.com

255
Switch-Mode Amplifier Design and Implementation
The output power is found as
	
P
V I
2
1 cos
1195 [W]
o
s p (
)
=
π
−
ϕ =
The phase angle, α, between the fundamental component of the midpoint voltage 
and the load current is equal to
	
tan
sin cos
sin
36.6
1
2

α =
π −φ +
φ
φ
φ



=
−
The resonant frequency is found as
	
f
f
Q
Q
2
tan
4
tan
4.53 MHz
r
s
2
[
]
=
α



+
−
α








=
The design component values R, L, and C are found as
	
R
V
I
1 cos
9.34
s
p (
)
= π
−
φ =
	
L
QR
1.23
H
r
= ω
=
µ
and
	
C
L
QR
1
1
1.006 nF
r
2
r
= ω
= ω
=
The average and rms values of the switch current are calculated as
	
I
I
2
1 cos
3.98 A
s.avg
p
[ ]
(
)
=
π
−
φ =
	
I
I
2
2
sin2
2
7.33 A
s.rms
p
[ ]
(
)
=
φ −
φ
π
=
6.5  CLASS F AMPLIFIERS
Class F amplifiers carry similar characteristics to Class B or Class C amplifiers that 
use a single-resonant load network to produce simple sinusoid at the resonant fre-
quency. The power capacity and efficiency obtained for Class B and Class C amplifi-
ers can be improved by introducing the harmonic terminations of the load network as 
it is done in Class F. Therefore, the load network in Class F amplifier resonates at the 
operational frequency as well as one or more harmonic frequencies. Multiresonant 
load network in Class F amplifier helps controlling the harmonic contents of the 
drain voltage and current, and wave shapes to minimize the overlap region between 

256
Linear and Switch-Mode RF Power Amplifiers
them to reduce the transistor power dissipation. This results in improvement of both 
efficiency and power capacity. In theory, an ideal Class F amplifier can control an 
infinite number of harmonics, has a square voltage waveform, and can give 100% 
efficiency. However, in practical applications, it is very difficult to control above the 
fifth harmonic with Class F amplifiers. The schematics of the basic Class F ampli-
fier with the third harmonic, called Class F3, peaking and its voltage and current 
waveforms are given in Figure 6.21a and b, respectively. Class F amplifier shown in 
Figure 6.21 has two parallel LC resonators, which are tuned to center frequency, fo, 
and third harmonic frequency, 3fo.
Consider the general Class F amplifier circuit given in Figure 6.22 for the analysis 
as given in Reference [23].
The drain voltage and current waveforms are expressed as
	
θ =
+
θ +
θ +
θ +
v
V
V
V
V
( )
sin( )
sin(3 )
sin(5 )
...
m
m
m
d
dd
0
3
5
	
(6.133)
	
θ =
−
θ +
θ −
θ +
i
I
I
I
I
( )
sin( )
cos(2 )
cos(4 )
...
m
m
m
d
dd
0
2
4
	
(6.134)
where θ = ωt. The coefficients of the fundamental component can be related to DC 
component and peak of the waveform as:
	
= γ
V
V
m
0
V
dd 	
(6.135a)
	
= δ
v
V
d max
V
dd 	
(6.135b)
Vdc
(a)
(b)
RFchoke
Idc
Cd
RL
vo
vds
io
id
ic
+
vGS
L3
C3
Lo
Co
vds
Vdc
−Im
io
Im
0
2Vdc
−Vm
io
Vm
θ
2π
θ
θ
π
FIGURE 6.21  (a) Class F amplifier with third harmonic peaking and (b) Voltage and cur-
rent waveforms for Class F amplifier with third harmonic peaking.
www.ebook3000.com

257
Switch-Mode Amplifier Design and Implementation
	
= γ
I
I
m
0
I dc 	
(6.136a)
	
= δ
i
V
d max
I
dd 	
(6.136b)
It is shown in Reference [23] that the load presents drain at the operation frequency
	
=
Z f
R
( )
	
(6.137)
The output voltage and current are defined by
	
=
V
I
R
m
m
0
0
	
(6.138)
Power output is then found as
	
=
= γ
P
V
R
V
R
2
2
m
o
0
2
V
2
dd
2
	
(6.139)
Similarly, DC input current and DC input power can be written as
	
= γ
=
γ = γ
γ
I
I
V
R
V
R
m
m
dc
0
I
0
I
V
dd
I
	
(6.140)
	
=
= γ
γ
P
V I
V
R
i
dd dc
V
dd
2
I
	
(6.141)
Vdd
RFchoke
Idc
RL
vo
vd
io
id
ic
+
vGS
+
vo
FL1
Z1 = R
Ze = 0 or ∞
Zo = ∞ or 0
FIGURE 6.22  Generic circuit for Class F amplifier.

258
Linear and Switch-Mode RF Power Amplifiers
The efficiency of the amplifier is calculated from
	
η =
=
= γ γ
P
P
V I
2
o
i
dd dc
V
I 	
(6.142)
Because the voltage and current relations are defined by Equations 6.15 through 
6.136, harmonic coefficients of a maximally flat waveform can then be varied to 
have the maximum and/or minimum values of the voltage or current waveforms. The 
maximum and minimum values of the voltage waveform occur at θ = π/2 and 3π/2. 
These values can be substituted into the derivatives and solve for the basic waveform 
parameters for the odd harmonic voltage wave. This can be illustrated on the volt-
age waveform by taking the derivative of Equation 6.133. The odd order derivatives 
are zero since cos (π/2) = cos (3π/2) = 0. The maximum flatness at the minimum 
value of the voltage requires the even derivatives to be zero when θ = 3π/2. So, from 
Equation 6.133,
	
θ
= −
θ −
θ −
θ
v
V
V
V
d
d
sin( )
9
sin(3 )
25
sin(5 )
m
m
m
2
d
2
0
3
5
	
(6.143)
So,
	
θ
=
−
+
θ= π
v
V
V
V
d
d
9
25
d
m
m
m
2
2
3
2
0
3
5 	
(6.144)
Similarly,
	
θ
=
θ +
θ +
θ
v
V
V
V
d
d
sin( )
81
sin(3 )
625
sin(5 )
d
m
m
m
4
4
0
3
5
	
(6.145)
So,
	
θ
= −
+
−
θ= π
v
V
V
V
d
d
81
625
d
m
m
m
4
4
3
2
0
3
5 	
(6.146)
Third Harmonic Peaking
The third harmonic peaking occurs when V5m = 0. Substitution of this value into 
Equation 6.144 gives
	
=
=
V
V
V
1
9
when
0
m
m
m
3
0
5
	
(6.147)
When θ = 3π/2, Equation 6.133 is equal to
	
=
−
+
V
V
V
0
m
m
dd
0
3 	
(6.148)
www.ebook3000.com

259
Switch-Mode Amplifier Design and Implementation
From Equations 6.147 and 6.148,
	
=
V
V
9
8
m
0
dd 	
(6.149)
	
=
V
V
1
8
m
3
dd 	
(6.150)
The peak value of the drain voltage is found as
	
=
+
−
=
v
V
V
V
V
2
d
m
m
max
dd
0
3
dd 	
(6.151)
Hence, the voltage coefficients in Equations 6.135 and 6.136 found for third har-
monic peak are
	
γ
= 9
8
V
	
(6.152a)
and
	
δ = 2
V
	
(6.152b)
Fifth Harmonic Peaking
Solution of Equations 6.144 and 6.146 for V3m and V3m gives
	
=
=
V
V
V
V
1
6
and
1
50
m
m
m
m
3
0
5
0 	
(6.153)
When θ = 3π/2, Equation 6.133 is equal to
	
=
−
+
−
V
V
V
V
0
m
m
m
dd
0
3
5 	
(6.154)
From Equations 6.153 and 6.154,
	
=
V
V
75
64
m
0
dd 	
(6.155)
	
=
V
V
25
128
m
3
dd 	
(6.156)
	
=
V
V
3
128
m
5
dd 	
(6.157)
The peak value of the drain voltage is found from
	
=
+
−
+
=
v
V
V
V
V
V
2
d
m
m
m
max
dd
0
3
5
dd 	
(6.158)

260
Linear and Switch-Mode RF Power Amplifiers
Hence, the voltage coefficients in Equations 6.135 and 6.136 found for the fifth 
­harmonic peak are
	
γ
= 75
64
V
	
(6.159a)
and
	
δ = 2
V
	
(6.159b)
The results of similar analysis applied for odd and even harmonics are tabulated in 
Tables 6.2 and 6.3 for voltage and current coefficients, respectively.
The maximum efficiency and power output of Class F power amplifiers with dif-
ferent numbers of harmonics are tabulated in Table 6.4.
The component values for Class F amplifier are obtained as
	
= γ
R
V
P
2
V
2
dd
2
o
	
(6.160)
The resonant circuit capacitor values are obtained from
	
(
)
=
π
C
f
L
1
2
i
i
2
	
(6.161)
TABLE 6.2
Voltage Waveform Coefficients
Desired Harmonics
δV
γV = V0m/Vdd
V3m/V0m
V5m/V0m
1
2
1
—
—
3
2
1.1547
0.1667
—
5
2
1.0515
—
−0.0618
3 + 5
2
1.2071
0.2323
0.0607
∞
2
1.273
0.424
0.255
TABLE 6.3
Current Waveform Coefficients
Desired Harmonics
δI
γI = I0m/Idc
I2m/I0m
I4m/Vdd
1
2
1
—
—
2
2.9142
1.4142
0.3540
—
4
2.1863
1.0824
—
−0.0957
2 + 4
3
1.5
0.3890
0.0556
∞
3.142
1.571
0.667
0.133
www.ebook3000.com

261
Switch-Mode Amplifier Design and Implementation
The following Matlab program has been developed to design any third- or fifth-order 
peaking Class F amplifier and is used for design of these types of amplifiers:
% Class F Amplifier Design Program for 3rd and 5th Harmonic 
Peaking
clear;
clc;
%PA design parameters
harmonics = 0;
%Selection of Harmoni Design
while (harmonics *= 1 && harmonics *= 2)
harmonics= input( 'Please Type 1 for 3th-harmonic design or 2 
for 5th-harmonic design : '  );
end
 
 
fo = input( 'Please Enter the frequency of operation, fo 
(MHz): ');
if (fo <= 0)
    fo=1e9; %Frequency of operation
else
fo=fo*1e6;
end
 
w = 2*pi*fo;
Po= input( 'Please enter the desired output power in mW, Po 
(mW): ');
 
Vdc= input( 'Please enter the value of the regulated power 
supply Vdc: ');
 
L0 = input( 'Please enter the inductance for the base filter 
(nH): ');
TABLE 6.4
Maximum Efficiency and Power Output of Class F Power Amplifiers
Max Harmonic 
Current
Efficiency, η
m
Max Harmonic-
Voltage, n = 1 
Max Harmonic- 
Voltage, n = 3
Max Harmonic- 
Voltage, n = 5
Max Harmonic- 
Voltage, n = ∞
1
0.5
0.5774
0.6033
0.6370
2
0.7071
0.8165
0.8532
0.9003
4
0.7497
0.8656
0.9045
0.9545
∞
0.785
0.9069
0.9477
1
Po,max
0.125
0.1443
0.1508
0.159

262
Linear and Switch-Mode RF Power Amplifiers
if (L0 <= 0)
    L0=1e-9; %Base filter inductance
else
L0=L0 * 1e-9;
end
 
L3 = input( 'Please enter the inductance for the third 
harmonic filter (nH): ');
 
if (L3 <= 0)
L3=1e-9; %Third harmonic filter inductance
else
L3=L3 * 1e-9;
end
 
if harmonics == 2;
L5 = input( 'Please enter the inductance for the fifth 
harmonic filter (nH): ');
if (L5 <= 0)
    L5=1e-9; %Fifth harminic filter inductance
else
L5=L5 * 1e-9;
end
else
L5 = 0 ;
end
 
if harmonics == 1
%third harmonic peaking circuit coefficients
dV=2;
gV=1.1547;
di=2.91;
gi=1.4142;
else
%5 resonators circuit coefficients
dV=2;
gV=1.2071;
di=3;
gi=1.5;
end
 
%Calculate optimum resistance and waveforms
RL=gV^2*Vdc^2/(2*Po);
Vom=gV*Vdc;
vdm=dV*Vdc;
Idc=gV*Vdc/(gi*RL);
idm=di*Idc;
A=2*acos(Idc/(Idc -idm));
 
%Calculate Filters
%base
www.ebook3000.com

263
Switch-Mode Amplifier Design and Implementation
C0=1/((2*pi*fo)^2*L0);
%3rd harmonic
C3=1/((2*pi*3*fo)^2*L3 );
if harmonics==2;
    C5=1/((2*pi*5*fO)^2*L3 );
 
end
%Display calculated values
fprintf ('\nRESULTS :\n');
fprintf ('RL % .2f Ohm \n', floor(100* RL + 0.5)/100);
fprintf ('L0 % .2f nH \n', floor(1e11 * L0 + 0.5)/100); 
fprintf ('C0 % .3f pF \n', floor(1e14 * C0 + 0.5)/100); 
fprintf ('L3 % .2f nH \n', floor(1e11 * L3 + 0.5)/100); 
fprintf ('C3 % .3f pF \n', floor(1e14 * C3 + 0.5)/100);
if harmonics==2;
    fprintf ('L5; % .2f nH \n', floor(1e11 * L5 + 0.5)/100); 
    fprintf ('C5; % .3f pF \n', floor(1e14 * C5 + 0.5)/100);
 
end
 
fprintf ('Idc % .2f mA \n', floor(1e5 *Idc+ 0.5)/100);
fprintf ('vdm % .2f v \n', floor(1e2 * vdm + 0.5)/100);
fprintf ('Vom % .2f V \n', floor(1e2 * Vom + 0.5)/100);
fprintf ('idm % .2f mA \n', floor(1e5 * idm + 0.5)/100);
6.5.1  Class S
Class S amplifier is based on switching of two transistors similar to Class D ampli-
fier concept. The main difference between Class D and S amplifiers is in the way the 
amplifier is driven. According to the Class S amplifier operation, the analog input 
signal is converted into a digital pulse train via modulator instead of signal being 
alternately switched at the carrier frequency with a constant duty cycle. The fully 
digital pulse train then feeds the power-switching final-stage amplifiers, which in 
turn amplify it to the proper power level. In the ideal case, no overlapping occurs 
between current and voltage waveforms, and hence no power loss exists, which 
leads to a 100% efficiency independently of the power back-off. A demodulator is 
required at the output network to pick the required signal frequency and to restore 
the analog input signal. The amplifier can be implemented in VM or CM configu-
rations. The VM configuration of Class S amplifiers with waveforms is given in 
Figure 6.23.
Example 6.3
Design Class E amplifier operating at optimum conditions for f = 2.4 GHz, QL = 7, 
Po = 50 [mW], and Vdc = 1 [V].
Solution: The following Matlab program is developed to design any type of switch-
mode amplifier with GUI. The program script is given for Class E amplifier.
Main Program: CLASS_E.m 

264
Linear and Switch-Mode RF Power Amplifiers
clc;
clear all ; %Clear all variables from workspace
 
prompt = {'Type "E" Class E,  "F" for Class F, "D" for Class D 
and "DE" for Class DE"'};
dlg_title = 'Switch-mode Amplifier Design Program';
num_lines = 1;
def = {'1'};
answer = inputdlg(prompt,dlg_title,num_lines,def, 'on');
 
%convert the strings received from the GUI to numbers
valuearray=str2double(answer);
 
%Give variable names to the received numbers
choice=valuearray(1);
 
if (choice== 1)
CLASS_E; %Class-E PA design program
end
 
if (choice == 2)
classF ; %Class-F PA design program
end
 
if (choice == 3)
classd ; %Class-DE PA design program
end
 
if (choice == 4)
classde ; %Class-DE PA design program
end
 
function varargout = CLASS_E(varargin)
 
gui_Singleton = 1;
gui_State = struct('gui_Name',       mfilename, ...
ZL
vo
Vdc
io
QP
QN
Modulator
RFin
ωt
ωt
ωt
Digital pulse
train
Demodulator
RFout
Ampliﬁed
digital pulse
train
ωt
FIGURE 6.23  Voltage mode Class S amplifier configuration.
www.ebook3000.com

265
Switch-Mode Amplifier Design and Implementation
                   'gui_Singleton',  gui_Singleton, ...
                   'gui_OpeningFcn', @CLASS_E_OpeningFcn, ...
                   'gui_OutputFcn',  @CLASS_E_OutputFcn, ...
                   'gui_LayoutFcn',  [] , ...
                   'gui_Callback',   []);
if nargin && ischar(varargin{1})
    gui_State.gui_Callback = str2func(varargin{1});
end
 
if nargout
    [varargout{1:nargout}] = gui_mainfcn(gui_State, 
varargin{:});
else
    gui_mainfcn(gui_State, varargin{:});
end
 
% --- Executes just before CLASS_E is made visible.
function CLASS_E_OpeningFcn(hObject, eventdata, handles, 
varargin)
% Choose default command line output for CLASS_E
handles.output = hObject;
 
% Update handles structure
guidata(hObject, handles);
 
% UIWAIT makes CLASS_E wait for user response (see UIRESUME)
% uiwait(handles.figure1);
 
% --- Outputs from this function are returned to the command 
line.
function varargout = CLASS_E_OutputFcn(hObject, eventdata, 
handles) 
 
% Get default command line output from handles structure
varargout{1} = handles.output;
  
function input1_editText_Callback(hObject, eventdata, handles)
input = str2num(get(hObject,'String'));
if (isempty(input))
set(hObject,'String','0')
end
.
.  
.
.
a1 = get(handles.input1_editText,'String');
a2 = get(handles.input2_editText,'String');
a3 = get(handles.input3_editText,'String');
a4 = get(handles.input4_editText,'String');
a5 = get(handles.input5_editText,'String');
a6 = get(handles.input6_editText,'String');

266
Linear and Switch-Mode RF Power Amplifiers
% length units in centimeters
% Length of core in centimeters
fo=str2num(a1);
QL=str2num(a2);
Po=str2num(a3);
Vdc=str2num(a4);
Vdssat=str2num(a5);
BVds=str2num(a6);
 
 
%Program begins
 
%Enter PA design parameters
%fo=input ('Please enter the frequency of operation, fo (MHz): 
');
%if (fo<=0)
%fo=le9; %Frequency
%else
%fo=fo*le6;
%end
 
fo=fo*1e6;
w=2*pi*fo; %Radian frequency
 
if (QL < 1)
QL = 10; %Loaded quality factor
end
 
 
if (Po <= 0 )
Po=0.01; %Output power
else
Po=Po/1000;
end
 
if (BVds <= 0)
BVds = 0; %Breakdown voltage
end
%Calculate
Vsp =3.56 * Vdc ;
 
if (Vsp > BVds && BVds > 0) 
    NVdc = BVds/3.56;
fprintf('Warning: Vdc should not exceed %.2f or the transistor 
will go into breakdown!\n' , NVdc );
end
 
www.ebook3000.com

267
Switch-Mode Amplifier Design and Implementation
RL=0.577*(Vdc - Vdssat)^2/Po ; %Load resistance
L2=1e9*(QL*RL/w); %Series inductance
C1=1e12*(1/(w*RL*5.447)); %Parallel capacitance
C2=(C1* (5.447/QL)*(1+1.421/(QL - 2.08))); %Series Capacitance
 
Idc=1e3*(Vdc/(1.734*RL)); %DC current consumpt ion
isp=(2.86*Idc); %Maximum collector current dissipation
 
 
%DISPLAY THE RESULTS ON THE WINDOW
c1=num2str(RL);
c2=num2str(L2);
c3=num2str(C2);
c4=num2str(C1);
c5=num2str(Idc);
c6=num2str(Vsp);
c7=num2str(isp);
 
% need to convert the answer back into String type to display 
it
set(handles.answer1_staticText,'String',c1);
set(handles.answer2_staticText,'String',c2);
set(handles.answer3_staticText,'String',c3);
set(handles.answer4_staticText,'String',c4);
set(handles.answer5_staticText,'String',c5);
set(handles.answer6_staticText,'String',c6);
set(handles.answer7_staticText,'String',c7);
 
guidata(hObject, handles);
 
% --- Executes during object creation, after setting all 
properties.
function axes5_CreateFcn(hObject, eventdata, handles)
% hObject handle to axes5 (see GCBO)
% eventdata  reserved - to be defined in a future version of 
MATLAB
% handles empty - handles not created until after all 
CreateFcns called
 
% Hint: place code in OpeningFcn to populate axes5
axes(hObject)
imshow('classE.jpg')
When program runs, the output is

268
Linear and Switch-Mode RF Power Amplifiers
Design Example: Class E Amplifier
Design single-ended Class E amplifier at 13.56 MHz with 5% bandwidth for 
semiconductor wafer processing applications. The amplifier should be able to 
provide 150 W at the center frequency. The spurious level of the output signal 
should be kept at −30 dB for all load conditions. The transistor that will be used 
is IXFH12N100F or any other transistor with similar characteristics. The complete 
design specifications are given Table 6.5.
Solution: To meet with the desired RF amplifier driver requirements, the topology 
shown in Figure 6.24 is proposed. This topology differs from the existing topology 
by incorporating the in-line and off-line filters to eliminate spurious oscillations 
and harmonic levels.
TABLE 6.5
Design Specifications for Class E Amplifier
Load Condition
Minpower
[W]
Harmonics
[dBC]
Spurious
[dBC]
Rail Voltage
[B+]
Frequency 
[MHz]
1:1
150
−30
−30
0–120 V
13.56 ± 5%
3:1
60
−30
−30
0–120 V
13.56 ± 5%
5:1
30
−30
−30
0–120 V
13.56 ± 5%
Inf:1
30
−30
−30
0–120 V
13.56 ± 5%
Very low
frequency filter
Vdc
Harmonic filter I
5th order
Diode
clamp
Harmonic filter II
3rd order and
impedance match
Load
Gate drive
circuit 
FIGURE 6.24  Class E amplifier with inductive clamp circuit topology is extended to 
include effective filtering.
www.ebook3000.com

269
Switch-Mode Amplifier Design and Implementation
The circuit in Figure 6.24 has an inductive clamp circuit [24] and effective filter-
ing for oscillations and harmonics. The details of design for the subsections shown 
in Figure 6.24 are given in the following section.
Off-line Very Low-Frequency Filter: Network I
This filter is connected at the drain of the MOSFET with a 25-Ω load termination. It 
presents the MOSFET high impedance with a minimum resistance at the operational 
frequency and presents approximately 25 Ω of resistance with minimum reactance 
from 100 kHz to 5.4 MHz. The filter is a fifth-order Chebyshev filter with 0.01 dB 
passband ripple. Its 3dB point is chosen to be 7.1 MHz. The first element of the filter is 
a series inductor, which is an appropriate component for the topology we use in this 
amplifier. If the dual of this filter is used, the shunt capacitor would be the first element. 
As a result, the transistor would see a capacitive loading at the operational frequency, 
adding to the output capacitance Coss of the transistor. The additional capacitance 
contributing to output capacitance of the transistor would be approximately 900 pF. 
The impedance and corresponding reactive component values that this filter presents 
to the MOSFET at the operational frequencies are given in Table 6.6.
In-line Harmonic Rejection Filter with Clamping Diode: Network II
The design details for the in-line harmonic filter constitute the main body of the 
resonant network with the shunt inductance presented by Network I. The in-line 
harmonic filter has to be adjusted to include the inductive clamping diode net-
work. One way to do that is to make the inductive clamping diode part of the 
harmonic filter. The harmonic filter is a fifth-order Chebychev filter with 0.01 dB 
passband ripple. The harmonic attenuation is enhanced, and proper impedance 
matching is accomplished by addition of a three-pole PI network between the 
overall network and the load. This network is shown in Figure 6.25.
The impedance that Network II presents the MOSFET is found to be induc-
tive for all operational frequencies as expected. This guarantees that whatever the 
load condition is, the transistor always sees an inductive loading. This indicates 
Port 1
Port 2
727 nH
575 nH
504 nH
82 pF
100 pF
287 pF
CR1
2700 pF
390 pF
390 pF
FIGURE 6.25  In-line harmonic rejection filter with inductive clamping diode—Network II.
TABLE 6.6
Impedances and Inductance Values at fop
Frequency [MHz]
Impedance [Ω]
Inductance [nH]
5.4
25+1.65i
48.63
12.882
2.5E−002+36.2i
447.24
13.56
2.5E−002+39.65i
465.38
14.238
2.5E−002+42.025i
469.76

270
Linear and Switch-Mode RF Power Amplifiers
that the diode network is functioning properly. The impedance and corresponding 
reactive component values at the operational frequencies are given in Table 6.7.
Final Design
The final design interfaces Network I, Network II, and the active device MOSFET. 
The finalized network is simulated by a nonlinear circuit simulator (Pspice). 
Although we need to tune some of the component values to obtain better 
­performance, the calculated component values are found to be close to the final 
design component values. The close approximation between calculated and final 
component values requires the knowledge of the accurate C–V characteristics 
of the transistor used. If C–V characteristics of the transistors are not known, the 
final component values in the design may deviate from the calculated component 
values significantly. The final circuit is shown in Figure 6.26.
The zero voltage switching (ZVS) is accomplished as it is seen from the wave-
forms for Vds and Vload shown in Figure 6.27. The simulated drain efficiency is found 
to be between 90% and 92% at the operational frequencies within the bandwidth. 
One of the most important features of the inductive clamp topology is the protec-
tion that it provides to the transistor. In this way, the amplifier protects itself to any 
transient conditions that can cause high dissipation in the die and result in destruc-
tion. The functionality of the topology is verified with the simulation for different 
load conditions at the rated DC supply voltage, V
120 V
dc =
. The die dissipation 
with inductive clamping diode is simulated and shown in Figures 6.28.  
Vdc
Gate drive
circuit
Load
694 nH
550 nH
504 nH
82 pF
82 pF
270 pF
CR1
2700 pF
390 pF
390 pF
550 nH
1.17 uH
550 nH
1500 pF
1500 pF
6 uH
0.22 uF
25 Ohm
FIGURE 6.26  The final circuit that is simulated and built.
TABLE 6.7
Impedances and Inductances at fop
Frequency [MHz]
Impedance [Ω]
Inductance [nH]
16.75
75.75 + 0.6i
5.70
12.882
23.97 + 2.025i
25.02
13.56
21.1 + 6.325i
74.24
14.238
20.97 + 12.05i
134.70
www.ebook3000.com

271
Switch-Mode Amplifier Design and Implementation
When the amplifier is integrated with inductive clamp circuit, the die dissipation 
is extremely low, and as a result, the destruction of die to any load condition is 
prevented. The simulated waveforms including drain-to-source and output signals 
for 50 Ω are given in Figure 6.29.
Experimental Results
The amplifier shown in Figure 6.26 was built, and the results were compared 
with the simulated results and verified that they comply with design specifica-
tions given in Table 6.5. The first step was to see whether the RF amplifier driver 
Ampliﬁer waveforms, B + = 120 V, Load = 50 Ohm
–200
–100
0
100
200
300
400
500
600
10.05
10.1
10.15
10.2
10.25
 Time [uS]
Voltage [V]
–50
0
50
100
150
200
250
Power [W]
Vload
Vds
Pload
Pdc
Pdie
Vds
Vload
Pdie
Pdc
Pload
10.3
10
FIGURE 6.27  Simulated amplifier waveforms when load is 50 Ω.
Die dissipation with inductive clamping diode
0
50
100
150
200
250
0
0.05
0.1
0.15
0.2
0.25
0.3
0.35
0.4
0.45
0.5
Load phase
Power dissipation of die [W]
1:01
2:01
3:01
Inf:1
FIGURE 6.28  Simulated die dissipation with inductive clamp.

272
Linear and Switch-Mode RF Power Amplifiers
complies with design specifications. Table 6.8 gives the measured results for spuri-
ous and harmonic levels for operational frequencies within the bandwidth when 
the load is 50 Ω.
The worst spurious case was measured at 13.56 MHz, for loads with VSWR
3:1
=
. 
The measured spurious levels for three frequencies within the operation bandwidth 
are plotted in Figure 6.30. The spur levels even for the worst condition are found to 
be within the specification. The measured drain efficiency is given in Figure 6.31. 
The drain efficiency ranges from 87% to 88%. The die dissipation is found to be 
very low for all frequencies, and it is consistent with simulation results.
Another important power amplifier performance parameter is the delivered power 
distribution over frequency. This performance parameter is shown in Figure 6.32.
When the amplifier is designed, it should be made sure that the die dissipa-
tion and as a result the heat generated by the transistors are controllable with the 
system cooling that is in place. The thermal cooling for high-power amplifiers 
mostly consists of both convection- and conduction-type cooling system. The die 
dissipation contours for this amplifier for various load conditions are tested and 
given in Figure 6.33. The color map shows the amount of dissipation on the Smith 
chart. The measured waveforms are given in Figure 6.34. The blue color shows the 
waveform taken at diode, and yellow shows the drain-to-source voltage measure-
ments on the load-line for an open load condition.
Design Example 2: Push–Pull Class E Amplifier
Design Class E amplifier in push–pull configuration to provide minimum Pout = 
2500 W at 180 V using three transistors on each of the push and pull sides at 
13.56 MHz. Connect input and output via balun with 25 Ω impedance. The tran-
sistor presents about 12.5 Ω at the operational frequency with rated voltage. Use 
IXFH12N100F transistors that are rated for 1200 V. Input power should not exceed 
150 [W].
FIGURE 6.29  Simulated results for Vds and Vout.
www.ebook3000.com

273
Switch-Mode Amplifier Design and Implementation
–70
–60
–30
–20
–10
0
–200
–100
0
100
200
300
13.56 MHz
14.238 MHz
12.882 MHz
Spur level  [dB] 
Reflection coefficient phase angle
Spur level [dB] vs reflection coefficient phase angle
 Vdc = 25 V,  VSWR = 3:1
–50
–40
FIGURE 6.30  Measured spurious levels for the worst condition.
TABLE 6.8
Measured Results for Spurious and Harmonic Levels
Spurs
Harmonic Levels
F = 13.56 MHz
Vdc [V]
dBC
Spur Frequency
2nd Harmonic
3rd Harmonic
25
−53.57
Noise floor
−34.71
−44.47
50
−52.84
Noise floor
−36.54
−47.56
75
−60.78
Noise floor
−37.08
−48.08
100
−61.14
Noise floor
−36.93
−47.72
120
−60.07
Noise floor
−37.45
−46.17
F = 12.882 MHz
Vdc [V]
dBC
Frequency
2nd Harmonic
3rd Harmonic
25
−66.9
Noise floor
−48.03
−57.58
50
−64.94
Noise floor
−35.76
−45.77
75
−58.25
Noise floor
−36.72
−47.1
100
−59.24
Noise floor
−37.020
−46.96
120
−59.24
Noise floor
−36.78
−46.1
F = 14.238 MHz
Vdc [V]
dBC
Frequency
2nd Harmonic
3rd Harmonic
25
−66.01
Noise floor
−37.02
−46.38
50
−59.34
Noise floor
−38.56
−51.23
75
−62.94
Noise floor
−39.13
−51.79
100
−65.22
Noise floor
−39.08
−52.43
120
−67.27
Noise floor
−39.12
−51.82

274
Linear and Switch-Mode RF Power Amplifiers
Solution: The Class E amplifier circuit is designed and simulated as shown in 
Figure 6.35.
The simulated results for the waveforms are given in Figures 6.36 through 6.38. 
Figure 6.36 shows Vds, and Figure 6.37 gives the output current. Figure 6.38 illus-
trates the output voltage.
The simulated values show that the output power for 50 Ω is equal to 2745 [W]. 
The impedance has been simulated at the points shown on the amplifier circuit 
shown in Figure 6.35. As seen from Table 6.9, the impedances at the drain of the 
transistor are very close to the desired impedance value at 13.56 MHz.
The design can now be implemented. The design of input balun is given for 
reference design. In practice, each transistor needs to be fed with an isolation 
gate transformer. There is a reference design for isolation gate transformer for the 
push–pull amplifier shown in Figure 6.35.
0
10
20
30
40
50
60
70
80
90
100
0
50
100
150
200
13.56 MHz, 50 Ohm
14.238 MHz, 50 Ohm
12.882 MHz, 50 OHm
Drain efficiency vs pout [W]
Drain efficiency [%]
Pout [W]
FIGURE 6.31  Measured drain efficiency for three frequencies.
Vdc = 40V
Vdc = 80V
Vdc = 120V
Vdc = 20V
Vdc = 60V
Vdc = 100V
Frequency [MHz]
Pout [W]
200
250
150
100
50
0
12.5
13
13.5
14
14.5
FIGURE 6.32  Delivered power distribution over frequency.
www.ebook3000.com

275
Switch-Mode Amplifier Design and Implementation
Die dissipation contours at 13.56 MHz
80
70
60
50
40
30
20
Real
Imag
0.8
0.6
0.4
–0.8
–1
–0.5
0
0.5
1
–0.6
–0.4
0.2
–0.2
0
FIGURE 6.33  Die dissipation contours for Class E amplifiers.

276
Linear and Switch-Mode RF Power Amplifiers
FIGURE 6.34  Measured waveforms for Vds (yellow) and diode (blue) for Class E amplifiers 
for open load.
z1
z2
z3
z4
FIGURE 6.35  Push–pull Class E amplifier designed at 13.56 MHz.
www.ebook3000.com

277
Switch-Mode Amplifier Design and Implementation
FIGURE 6.37  Output current waveform for push–pull Class E amplifier.
FIGURE 6.36  Vds waveform for push–pull Class E amplifier.

278
Linear and Switch-Mode RF Power Amplifiers
Design of Input Balun
Based on the given information, the equivalent circuit of the input balun can be 
illustrated as shown in Figure 6.39.
For maximum power transfer, R
R
L
s
=
. It is given that 
R
0.5
25
L =
. Then,
	
R
R
50 [ ]
L
s
=
=
Ω
It is also given that Pin = 150 W. This requires the operational rms voltage and cur-
rent values at the input to be
	
P
W
Z
V
I
150
,
50
,
86.6 V and
1.73
in
in
in,rms
in,rms
=
=
Ω
=
=
 
At the output of the balun, we will have
	
P
W
Z
V
I
75
,
25
,
43.3 V,
1.73 A
out,1
out,1
out,rms,1
out,rms,1
=
=
Ω
=
=
 
FIGURE 6.38  Output voltage waveform for push–pull Class E amplifier.
TABLE 6.9
Simulated Node Impedances
Impedance Node
V < Θ
I < Θ
Z < Θ 
Z1
298.9 < −55.37°
23.71 < −117.2°
12.60 < 61.83°
Z2
265.1 < −156.6°
18.81 < −108.9°
14.09 < −47.7°
Z3
264.7 < −156.6°
11.14 < −131.3°
23.76 < −25.3°
Z4
257.9 < −109.1
10.33 < −109.1
24.97 < 0°
www.ebook3000.com

279
Switch-Mode Amplifier Design and Implementation
The magnetic core that will be used in the design of balun will be selected based 
on the impedance and flux density requirement. The rule of thumb in the design of 
balun is to have impedance value at 5–10 times higher than the highest impedance 
termination at any of its ports. The highest impedance is at the input port of the 
balun and is equal to 50 W. The target impedance value for the balun is
	
Z
fL
L
2
2 (13.56
10 )
500
req
6
= π
= π
×
×
=
Ω
Then,
	
L
L
500
2 (13.56
10 )
or
5.868
H
6
≥
π
×
≥
µ
.
The inductance is found as
	
L
N
A
l
4
[nH]
2
i
Tc
e
=
π
µ
We can now find the number of turns, N, if we have the characteristics of the 
core that we will be using. We determine to use core material manufactured by 
Ferronics with part number 11-260. This is K-type material with permeability of 
125, μi = 124, OD = 1.27 cm, ID = 0.714 cm, and h = 0.478 cm. The saturation flux 
density at 10 MHz is given as 3200 [G]. This value is expected to significantly drop 
as frequency goes up. We will be using 10 cores by stacking 5 on each side as 
shown in Figure 6.40.
FIGURE 6.40  Construction of the balun using multiple cores.
1
2
3
4
+
+
–
–
Vs
Rs
0.5RL= 25 Ω
0.5RL= 25 Ω
V1
V2
–
+
I1
1I
I2
I1
VL/2
L2
L1
Vin
FIGURE 6.39  The equivalent circuit of input balun.

280
Linear and Switch-Mode RF Power Amplifiers
The number of turns is found as
	
N
L
l
A
= 4
5868
3.03
4
125
10
0.132
2.92
3 turns
i
e
Tc
×
πµ
=
×
π ×
×
×
=
≈
The operational flux density Bop can be found as
	
B
V
fNA
10
4.44
=
86.6
10
4.44
13.56
10
2.92
10
0.132 = 37.07 [Gauss]
op
rms
8
Tc
8
6
=
×
×
×
×
×
×
×
The operational flux density is well below the saturation flux density. It is also 
worth to note that increasing the number of the cores reduces the operational flux 
density. RG-188 coaxial cable is selected for winding since it is capable of carrying 
the current required and has 50 Ω characteristic impedance.
The final configuration of the balun that is constructed is shown in Figure 6.41. 
Matlab GUI program illustrating the calculated values for the design of a balun is 
given in Figure 6.42.
The final configuration illustrated in Figure 6.41 is constructed with three turns. 
When N = 3, using the inductance formulation, inductance is found to be 6.16 [ H]
µ
. 
The inductance of balun is measured using HP 4191A, RF impedance analyzer. The 
setup to measure the inductance of the balun is shown in Figure 6.43.
The self-inductance value is measured to be 6.4 [ H]
µ
 and close to the ­calculated 
value.
The frequency response of the input balun is measured with HP 8753B net-
work analyzer. The measurement setup and measured response are illustrated 
in Figures 6.44 and 6.45, respectively. The characteristics of some of the coaxial 
cables that can be used in the construction of balun are given in Table 6.10.
Shield
Insulation
Center
FIGURE 6.41  Balun that is constructed.
www.ebook3000.com

281
Switch-Mode Amplifier Design and Implementation
2
3
4
+
–
–
+
I1
I1
I1
L2
L1
I2
V2
V1
Vin
50 Ω
Network analyzer
Port 1 Port 2
Connector to
network analyzer
Center
conductor
Shield
50 Ω
Center
conductor
Shield
Center
conductor 1 
Shield
(b)
(a)
FIGURE 6.44  (a) Block diagram for measurement of the frequency response of input balun 
and (b) Measurement setup for frequency response for input balun.
FIGURE 6.42  Matlab GUI program to design Balun.
RF impendance analyzer
Display A
Display B
Frequency
Adapter
Center
conductor
Center
conductor
FIGURE 6.43  Measurement setup for inductance measurement of input balun input.

282
Linear and Switch-Mode RF Power Amplifiers
TABLE 6.10
Coax Cable Information
Coax Cable
OD (in.)
Impedance
Jacket Material
Center Conductor 
Material
Center Conductor 
Type
Center Conductor 
Diameter (in.)
Dielectric
RG142
0.195
50
Foamed polyethylene
Silver plated copper 
steel wire
Solid
0.037
PTFE
RG178
0.071
50
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.012
PTFE
RG179
0.1
75
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.012
PTFE
RG188
0.1
50
PTFE
Silver plated copper 
steel wire
Stranded
0.0201
PTFE
RG316
0.098
50
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.0201
PTFE
RD316
0.114
50
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.0201
PTFE
RG400
0.2
50
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.038
PTFE
RG393
0.39
50
Foamed polyethylene
Silver plated copper 
steel wire
Stranded
0.094
PTFE
RG58
0.195
50
PVC-NC
Tinned copper
Stranded
0.036
PE
RG59
0.242
75
PVC-NC
Bare copper
Solid
0.023
PE
RG214
0.425
50
PVC-NC
Silver plated copper
Stranded
0.089
PE
RG393
0.212
50
PVC-NC
Silver plated copper
Solid
0.036
PE
PTFE, polytetrafluoroethylene
www.ebook3000.com

283
Switch-Mode Amplifier Design and Implementation
The measured values showing the frequency response of the input balun between 
1 MHz and 30 MHz are given in the following table.
Isolation Gate Transformer Design
It is required to design and characterize an isolation gate transformer to operate 
at 13.56 MHz. Current at the primary is given to be 1.73 Arms. The power input 
is 150 [W], and the voltage at the secondary is desired to be 30 [Vrms]. The input 
impedance that will be presented is 50 Ω
Based on the given information, the voltage at the secondary is 30 V, and at 
the primary is
	
V
150 50
86.6 [Vrms]
p
(
)
=
=
The turn ratio is then calculated to be,
	
N
N
V
V
86.6
30
2.89
1
2
p
s
=
=
=
Frequency [MHz]
Real
Imaginary
Inductance [nH]
1
51.252
0.238
37.923
5
51.393
0.8789
27.976
13.56
51.734
2.1484
25.216
27.12
52.777
4.168
24.44
FIGURE 6.45  Frequency response of input balun.

284
Linear and Switch-Mode RF Power Amplifiers
This can be rounded to 3. Hence, the transformer with ratio 3:1 should satisfy the 
design specifications. Consider single-bead geometry given in Figure 6.46. The 
cross-sectional area and magnetic path length are given as
	
Ae = 0.0996 cm2, le = 1.5 cm
The permeability of the material is 125. In our design, we did not initially know the 
number of turns. So, as a rule of thumb, we targeted impedance on the primary 10 
times higher than the impedance that is interfaced.
	
Z
fL
L
2
2 (13.56
10 )
500
6
= π
= π
×
×
=
Ω
From this relation, the target inductance is 5.86 μH. We use the following formula-
tion to obtain the inductance. When six beads are used, the total cross-sectional 
area becomes A
A
6
Te
e
=
×
, and the inductance value becomes 5.63 μH.
	
L
A
N
l
0.4
(cm )
100 (cm)
[ H]
i
Te
2
2
e
=
πµ
µ
When this is placed back into impedance formulation, we obtain 3:1 trans-
former with six beads is realized using the following bead configuration shown 
in Figure 6.47.
OD
ID
FIGURE 6.46  Single-bead geometry.
FIGURE 6.47  Six-bead geometry.
www.ebook3000.com

285
Switch-Mode Amplifier Design and Implementation
	
Z
fL
L
2
2 (13.56
10 )
479.8
6
= π
= π
×
×
=
Ω
The size of the wires can be determined as follows. Because the current at the 
primary is 1.73A, the min wire size should be 26AWG. 26AWG wire will be able 
to handle 2.2A if it is solid wire. Because the current at the secondary is 5.19A, the 
min wire size should be 22AWG. 22AWG will be able to handle 5.5A when solid 
wire is used. One of the design practice is to choose the wire insulation properly 
to prevent arcing between primary and secondary windings.
The equivalent circuit for the isolation transformer is given in Figure 6.48. 
The voltage difference between the windings is ∆V = 86.6 − 30 = 56.6 V. Hence 
the breakdown voltage of the wires is greater than 56.6 V. The Teflon insulation 
used on the primary winding and enameled wire on the secondary winding has 
much more higher voltage rating than 56.6 V. The transformer is implemented in 
Figure 6.49. 14AWG wire is used on the secondary side, which has much more 
higher rating than desired value. This transformer is used to drive the MOSFETs 
and is connected between gate and source of the transistor.
Characterization of the transformer is done using open and short circuit tests 
as explained earlier. The open and short circuit test results for this transformer is 
shown in Table 6.11.
The measured values are
	
L
L
L
n
5.15
H ,
579.6 nH ,
22 nH ,
3
p
s
s
[
]
[
]
[
]
=
µ
=
′ =
=
Using the equation,
	
L
n L
L
n
L
L
L
n
2
0
l
l
1
2
2
p
1
2
s
s
p
2



−
+
′ −
+



=
or
	
L
L
9 5.15
10
2
9
22 10
579.6
10
5.15
10
9
0
l
l
1
2
6
1
9
9
6
(
)
×





−
+
×
−
×
+
×



=
−
−
−
−
V1 = 86.6 V
V2 = 30V
FIGURE 6.48  Equivalent circuit six-bead geometry.
FIGURE 6.49  Constructed isolation gate transformer.

286
Linear and Switch-Mode RF Power Amplifiers
The solution of the foregoing equation gives the leakage inductance on the pri-
mary side as L
66.22 nH
l1
[
]
=
. The leakage inductance on the secondary side can 
be found from
	
L
L
L
L
n
l
l
s
2
p
1
2
=
+
−
The leakage inductance on the secondary is then equal to
	
L
L
L
L
n
579.6 nH
5150 nH
66.22[nH]
9
14.74 [nH]
l
l
2
s
p
1
2
[
]
[
]
=
−
−
=
−
−
=
Hence, the measured leakage inductances for the isolation gate transformer are
	
L
L
66.22 nH and
14.74 nH
l
l
1
2
[
]
[
]
=
=
The self-inductances on the primary and secondary sides are found from
	
L
L
L
5150 [nH]
66.22[nH]
5083.78 [nH]
l
1p
p
1
=
−
=
−
=
	
L
L
L
579.6 [nH] 14.74 [nH]
564.86 [nH]
l
2s
s
2
=
−
=
−
=
The coupling coefficient is obtained from
	
k
L L
L L
5083.78 564.86
5150
579.6
0.98
1p 2s
p s
(
)(
)
(
)(
)
=
=
=
which is very close to 1 as desired. The mutual inductance is then equal to
	
M
k L L
0.98
5150
579.6
1693.14 [nH]
p s
(
)(
)
=
=
=
REFERENCES
	
1.	 G. Giustolisi, A. D. Grasso, S. Pennisi, High-drive and linear CMOS Class-AB pseudo-
differential amplifier, IEEE Transactions on Circuits and Systems II: Express Briefs, 
Vol. 54, No. 2, pp.112–116, 2007.
TABLE 6.11
Open and Short Circuit Test Results for 
Isolation Gate Transformer
Measured
Primary
Secondary
L
Primary
Open
Open
5.15 μH
Secondary
Open
Open
579.6 nH
Secondary
Short
Open
22 nH
www.ebook3000.com

287
Switch-Mode Amplifier Design and Implementation
	
2.	 H. Kosugi, T. Matsumoto, T. Uwano, A high-efficiency linear power amplifier using an 
envelope feedback method, Electronics and Communications in Japan, Part 2, Vol. 77, 
No. 3, pp. 50–57, 1994.
	
3.	 G. Vendelin, A. Pavio, U. Rohde, Microwave Circuit Design using Linear and Nonlinear 
Techniques, 2nd ed. John Wiley & Sons, Hoboken, NJ, 2005.
	
4.	 M. Albulet, RF Power Amplifiers. Noble, Atlanta, GA, 2001.
	
5.	 S. Goto, T. Kunii, T. Oue, K. Izawa, A. Inoue, M. Kohno, T. Oku, T. Ishikawa, A low 
distortion 25 W Class-F power amplifier using internally harmonic tuned FET archi-
tecture for 3.5 GHz OFDM applications, Proceedings of IEEE MTT−S International 
Microwave Symposium Digest, 2006, pp. 1538–1541, June 2006.
	
6.	 F.-Y. Chen, J.-F. Chen, R.-L. Lin, Low-harmonic push- pull Class-E power amplifier 
with a pair of LC resonant networks, IEEE Transactions on Circuits and Systems I: 
Regular Papers, Vol. 54, No. 3, pp. 579–589, 2007.
	
7.	 F. J. Ortega-Gonzlez, Load-pull wideband Class-E amplifier, IEEE Microwave and 
Wireless Components Letters, Vol. 17, No. 3, pp. 235–237, 2007.
	
8.	 W. Saito, T. Domon, I. Omura, M. Kuraguchi, Y. Takada, K. Tsuda, M, Yamaguchi, 
Demonstration of 13.56-MHz Class-E amplifier using a high- voltage GaN power-
HEMT, IEEE Electron Device Letters, Vol. 27, No. 5, pp. 326–328, 2006.
	
9.	 H.-S. Oh, T. Song, E. Yoon, C.-K. Kim, A powerefficient injection-locked class-E power 
amplifier for wireless sensor network, IEEE Microwave and Wireless Components 
Letters, Vol. 16, No. 4, pp. 173–175, 2006.
	 10.	 S. C. Cripps, RF Power Amplifiers for Wireless Communication, Artech House, Inc., 
Norwood, MA, 1999.
	 11.	 H. L. Krauss, C. W. Bostian, F. H. Raab, Solid State Radio Engineering, John Wiley & 
Sons, New York, 1980.
	 12.	 F. H. Raab, P. Asbeck, S. Cripps, P. B. Kenington, Z. B. Popovic, N. Pothecary, J. F. 
Sevic, N.O. Sokal, Power amplifiers and transmitters for RF and microwave, IEEE 
Transactions on Microwave Theory Techniques, Vol. 50, No. 3, pp. 814–826, 2002.
	 13.	 N. O. Sokal, A. D. Sokal, Class EA new class of high­-efficiency tuned single-­ended 
switching power amplifiers, IEEE Journal of Solid-State Circuits, Vol. 10, No. 3, 
pp. 168–176, 1975.
	 14.	 S. Sivakumar, A. Eroglu, Analysis of Class-E based RF power amplifiers using har-
monic modeling, IEEE Transactions on Circuits and Systems I : Regular Papers, Vol. 
57, No. 1, pp. 299–311, 2010.
	 15.	 F. Raab, Idealized operation of the Class-E tuned amplifier, IEEE Transactions on 
Circuits and Systems, Vol. CAS-24, No. 2, pp. 239–247, 1978.
	 16.	 N. O. Sokal, Class-E RF power amplifiers, QEX, pp. 9–20, January/February 2001.
	 17.	 M. Kazimierczuk, K. Puczko, Exact analysis of Class-E amplifier at any Q and switch 
duty cycle, IEEE Transactions of Circuits and Systems, Vol. 34, pp. 149–159, 1987.
	 18.	 M. K. Kazimierczuk, K. Puczko, Class-E tuned power amplifier with antiparallel diode 
or series diode at switch, with any loaded Q and switch duty cycle, IEEE Transactions 
on Circuits and Systems, Vol. 36, No. 9, pp. 1201–1209, 1989.
	 19.	 H. Sekiya, I. Sasase, S. Mori, Computation of design values of Class E amplifiers 
without using waveform equations, IEEE Transactions on Circuits and Systems I: 
Fundamental Theory and Applications, Vol. 49, No. 1, pp. 966–978, 2002.
	 20.	 M. Acar, A. J. Annema, B. Nauta, Analytical design equations for Class-E power 
amplifiers, IEEE Transactions on Circuits and Systems-I: Regular Papers, Vol. 54, No. 
12, pp. 2706–2717, 2007.
	 21.	 Y. B Choi, K. K. M. Cheng, Generalised frequency-domain analysis of microwave 
Class-E power amplifiers, IEE Proceedings Micorwave Antennaas Propagation, Vol. 
148, No. 6, pp. 403–409, 2001.

288
Linear and Switch-Mode RF Power Amplifiers
	 22.	 IRF450 
Transistor 
Datasheet. 
http://www.irf.com/product-info/datasheets/data/
jantx2n6770.pdf.
	 23.	 F. Raab, Maximum efficiency and output of Class-F power amplifiers, IEEE 
Transactions on Microwave Theory Technology, Vol. 49, No. 6, pp. 1162–1666, 2001.
	 24.	 A. Eroglu, A. Radomski, D. Lincoln, Y. Chawla, Improvement of Class E amplifier with 
inductive clamp circuit topology and its applications, 2006 IEEE MTT-S, ­pp. 906–909, 
June 2006.
www.ebook3000.com

289
7 Phase-Controlled 
Switch-Mode Amplifiers
7.1  INTRODUCTION
In this chapter, the harmonic modeling of Class E amplifiers discussed in Chapter 6 
is extended to phase-controlled Class E power amplifier (PA) pairs to study the 
impact of phase control on the voltage, current, and power control profiles. Phase 
control of amplifier pairs enhances their controllability and adds flexibility to their 
power control characteristics [1–7]. However, the phase control operation results in 
asymmetric operation of the individual amplifiers of the pair [4]. Hence, the impact 
of the asymmetric operation, in light of the nonlinear characteristics of the Class E 
amplifier, on the component stress profile needs to be carefully studied while con-
sidering the use of phase-controlled Class E amplifier pairs as potential solution to 
specific applications. A detailed analysis of the phase-controlled Class E amplifier 
using circuit waveform equations for standard load conditions, assuming sinusoidal 
resonant tank current, is dealt with in Reference [2]. Reference [4] extends the prior 
work of Reference [8] to compute the design values for the phase-controlled Class E 
amplifier pair, without using explicit waveform equations as discussed and detailed 
in Reference [9]. A load-pull analysis of the phase-controlled Class E amplifier pair 
is discussed in Reference [7], which is based on the analysis of the independent 
amplifiers, with the equilibrium for the amplifier pair achieved at load points at 
which the load-pull seen by one amplifier is equal to that seen by the other.
7.2  PHASE CONTROL OF A CLASS E POWER AMPLIFIER PAIR
Figure 7.1 shows the circuit topology of the phase-controlled Class E PA pair, where 
two single-ended Class E PAs are combined through a transformer-combiner circuit 
to provide the total radio frequency (RF) output power. Each PA is rated to provide 
half the total rated power. The power switches of the two PAs are controlled in syn-
chronism with two independent RF gate drive pulse signals of fixed and identical 
duty cycles (nominally 50%), however, with a facility to vary the phase of the pulse 
signals with reference to each other. The variation of the phase between the two gate 
drive signals facilitates the RF output of one of the PAs to be phase-shifted from 
the other. As a result, RF output through the transformer-combiner circuit is the 
combined total of two phase-shifted RF powers, one from each PA. By controllably 
varying the phase difference between the two drive pulse signals from 0° through 
180° using a phase control signal, the total RF output power can be varied from zero 
through maximum, with the maximum power determined by the DC input rail volt-
age, Vdc, and the load impedance.

290
Linear and Switch-Mode RF Power Amplifiers
The equations for the phase-controlled Class E power amplifier pair (Figure 7.1) 
can be written by combining two sets of equations—one for the first PA, the master 
(denoting the corresponding parameters and variables by a superscript m), and the 
other for the second, the slave (denoting the corresponding parameters and variables 
by a superscript s). The phase angle of the master PA, δm, can be chosen as zero, and 
that of the slave, δs, can be chosen a desired value toward meeting RF output power-
control objective.
Assuming that the combiner transformers shown in Figure 7.1 are ideal and have 
a 1:1 transformation ratio, the equation relating the common output current io and 
the output voltages vm
o  and vs
o  of the master and slave PAs, respectively, is given by
	





=
+
+







=
−














v
v
v
v
v
v
z
z
z
z
i
i
odh
oqh
odh
m
odh
s
odh
m
odh
s
cdh
cqh
cqh
cdh
odh
oqh
	
(7.1)
An exact solution for the phase-controlled Class E PA pair configuration is obtained 
by solving a system of resulting simultaneous nonlinear equations with vidh
m , viqh
m , vidh
s , 
and viah
s  all set to zero, and both vs
m
0 and vs
s
0 set to Vdc.
Because the simultaneous equations derived earlier for the Class E PA configura-
tions are nonlinear, the iterative process for their solution is considered. It can be 
expressed that
	
∑
ε
ε ε
=
g
u
(
)
,
,
k
k
k
m
0
1
2
1
	
(7.2)
Cs
m
Cs
s
Ld
m
c
Ld
s
c
Lr
m
Lr
s
Cr
m
Cr
s
LCi
m
LCi
s
LCo
m
LCo
s
i1
m
S1
m
S1
s
is
m
c
isc
m
i1
s
i2
m
i2
s
io
m
io
s
io
vo
m
vi
m
vs
m
vo
s
vi
s
vs
s
Vdc
vo
zo
δm = 0
δs = φ
Ψ  s = π/2
Ψ  m = π/2
FIGURE 7.1  Circuit configuration of the phase-controlled Class E power amplifier pair.
www.ebook3000.com

291
Phase-Controlled Switch-Mode Amplifiers
where g ()
k
 is a nonlinear function of the angles ε
=
i,
0, 1, 2
i
, and 

=
u
k
m
,
1,2,
,
k
 
are the circuit variables made up of the input DC current, the direct and quadrature 
axes components of the circuit voltages and currents, and their harmonics. Note that 
for fixed values of the angles ε
=
i,
0, 1, 2
i
, these equations have a linear form. Hence, 
the following iterative process is considered: Set the initial estimates ε
=
i,
0, 1, 2
i
 to 
zero; solve the set of resulting linear equations using matrix inversion to compute the 
direct and quadrature axes harmonic components of the various nodal voltages and 
branch currents; reconstruct the switch voltage waveform from the solution obtained 
in the previous step, and compute the actual ε
=
i,
0, 1, 2
i
, and compare with their 
corresponding presolution estimates; update the estimates using an appropriate cri-
terion; and repeat the process until convergence, using equality, within an acceptable 
tolerance of the pre- and postsolution values of ε
=
i,
0, 1, 2
i
 within an iteration, as 
the convergence criterion.
For the case of single-ended Class E amplifier, for a given ε
=
i,
0, 1, 2
i
, equations 
can be combined into the following matrix forms:
	
=
Ax
b 	
(7.3)
where 
[
]
=
x
i
i
v
v
i
( )
(
)
(
)
( )
nh
s nh
nh
nh
T
dc
1
o
o
 is the vector of independent variables of 
interest, where the form p
( )nh represents the row vector p
p
p
p
p
p
[
,...,
]
d
q
d
q
dn
qn
1
1
2
2
, 
where pdh and pqh, respectively, represent the hth harmonic direct and quadrature axes 
components of the arbitrary circuit variable p; System matrix A is of the form
	
=
ε














A
A
A
A
A
( )
s
is
so
o
	
(7.4)
where 
ε
A ( )
s
 is a 
+
×
+
nh
nh
(
1) (4
1) submatrix of coefficients that describes the switch 
voltage a given ε
=
i,
0,1, 2
i
; Ais is a 
×
+
nh
nh
(
) (4
1) submatrix of coefficients that 
describes the input-switch circuit interface; Aso is a 
×
+
nh
nh
(
) (4
1) submatrix of coef-
ficients that describes the switch-output circuit interface; and Ao is a 
×
+
nh
nh
(
) (4
1) 
submatrix of coefficients that describes the output circuit. Note that the submatrices 
other than 
ε
A ( )
s
 have fixed elements. Vector b  is of the form 
[
]
=
b
V (0) nh
T
dc
4
, where 
(0) nh
4  is a row vector of 4nh zero elements.
A similar matrix equation can be constructed for the phase-controlled Class E 
pair, with the following setting: ψ =ψ =π / 2
m
s
; δ =
δ = φ
0;
,
m
s
 the desired or con-
trolled phase angle. The resulting equation is of the form
	
=
A
x
b
ms
ms
ms 	
(7.5)
where

292
Linear and Switch-Mode RF Power Amplifiers
	
=












=










=










A
A
A
A
A
A
A
A
x
x
x
x
b
b
b
b
0
0
;
;
ms
m
m
s
s
m
s
o
ms
m
s
o
ms
m
s
o
11
12
11
12
21
21
22
and 
(
)
(
)
(
)
= 

x
i
i
v
v
m
m
m
nh
m
nh
m
nh
T
dc
1
s
o
; 
( )
( ) ( )
= 

x
i
i
v
v
s
s
s
nh
s
nh
s
nh
T
dc
1
s
o
; 
[
]
=
x
i( )
o
nh
T
o
; 
A
A
A
A
,
,
,
m
m
m
o
11
12
21
22  and A
A
A
A
,
,
,
s
s
s
o
11
12
21
22  are the partitioned submatrices of matrix 
equivalent to A  of equation (xy), corresponding to the master and slave PAs, 
respectively; 
[
]
=
=
b
b
V
(0)
m
s
nh
T
dc
3
; and 
[
]
=
b
(0)
o
nh
T. Note that elements of sub-
matrices A
A
,
m
m
11
12 are constants only for fixed ε
=
i,
0, 1,2
i
m
, and that of A
A
,
s
s
11
12 
are constants for fixed δs and ε
=
i,
0, 1, 2
i
s
, and all other submatrices have fixed 
elements.
The flowchart of the iterative algorithm for the phase-controlled PA pair is given 
in Figure 7.2. The flowchart for the single-ended PA is an obvious subset of the flow-
chart and is not discussed here. Although the strategy for updating ε
ε
=
i
,
,
0, 1, 2
i
mo
i
so
 
at each iteration can be chosen from known nonlinear solution methods (such as gra-
dient descent techniques), a simple linear update law
	
∆ε
=
ε −ε
∆ε
=
ε −ε
=
<
ε
ε
ε
k
k
i
k
(
)
(
)
,
0, 1, 2;
1
i
mo
i
m
i
mo
i
so
i
s
i
so
	
(7.6)
has been found adequate for the solution of most practical Class E–based amplifiers.
The higher the number of harmonics (=n) considered, the higher the accuracy of 
the solution; however, the number of resulting simultaneous equations and the vari-
ables to be solved increases with n, thereby increasing the computation complexity. 
For most practical PA designs, constraining n to 2 is a good tradeoff that facilitates 
high solution accuracy with low computation complexity.
The harmonic components of the circuit voltages and currents obtained at the 
end of the iteration process can be used to compute critical circuit variables such as 
the rms current and voltage stresses on the switching devices and other critical filter 
components. In addition, specific circuit waveforms can be reconstructed using the 
corresponding direct and quadrature axes components (which provide the amplitude 
and phase information), which may be useful in assessing other stress factors. For 
example, by reconstructing the switch voltage waveform, the presence of any hard 
switching of nonzero shunt capacitor voltages can be detected; moreover, the power 
losses due to such hard switching and the peak voltage impressed on the switching 
device can be computed.
7.2.1  Implementation of Harmonic Modeling
7.2.1.1  Single-Ended Class E Power Amplifier
The schematic of the example of the single-ended Class E PA, which is considered 
here to verify the performance of the harmonic model-based algorithm, is shown in 
www.ebook3000.com

293
Phase-Controlled Switch-Mode Amplifiers
Figure 7.2 [9]. The PA is rated for 500 W at 13.56 MHz and is optimized for a nomi-
nal (arbitrary) load of 145 Ω.
The harmonic model used in the algorithm uses only up to the second harmonic 
contents. The circuit parameters in Figure 7.3 are:
VDC1 = 150 or 175 V; Ldc = 3.9 mH; Li1 = 330 nH; Li2 = 390 nH; Lr = 330 nH; 
Lo2 = 330 nH;
Ci1 = 430 pF; Ci2 = 82 pF; Cs = 328 pf; Cr = 1200 pF; Co1 = 100 pF; Co2 = 330 pF; 
Co3 = 330 pF;
Rci1 = 12 Ω and 0.15 mF; Variable Load
Figure 7.4 shows the comparison of the waveforms reconstructed from the 
results of the harmonic modeling of the example Class E PA with the corresponding 
Initialize εi
mo, εi
so, i=0, 1, 2 to zero
+
Compute εerr =
2
2
i=0
εi
so– εi
s
εi
mo– εi
m
Compute the elements of Ams that are
funtions of εi
m, εi
s, i=0, 1, 2
Compute xms = (Ams) –1bms
Using x ms, construct vs
m(θ = 2π + δm) and
vs
s(θ=2π +δs) using Equation 3 and compute
εerr ≤ Threshold?
No
Yes
End
Update εi
so = εi
so + ∆εi
so; εi
so = εi
so + ∆εi
so, i = 0, 1, 2
Compute the fixed elements of all Ams  and 
 bms using circuit parameters for both the
master and slave power amplifiers and the
selected load and the selected phase angle  
δs = φ
FIGURE 7.2  Flowchart of the harmonic modeling algorithm for phase-controlled Class E 
power.

294
Linear and Switch-Mode RF Power Amplifiers
waveforms obtained through PSIM simulation. The waveforms correspond to an RF 
control signal duty cycle of 0.5 and a resistive load with voltage standing wave ratio 
(VSWR) = 7.0. The close match of the two sets of waveforms and their amplitudes is 
obvious, with vs  and isc waveforms obtained from the algorithm clearly showing the 
characteristic second harmonic content.
A comparison of the results of the harmonic modeling with that of an experimen-
tal laboratory Class E PA is presented in Figure 7.5. The switch voltage waveforms 
are shown for multiple cases of rail voltage with the PA feeding a constant 50 Ω load 
and the RF control signal duty cycle held constant at 0.5.
Figure 7.5a shows the switch voltage waveforms of the experimental PA for six 
cases of rail voltage, and Figure 7.5b shows the corresponding waveforms obtained 
from harmonic modeling. The input and output power profiles obtained from the 
experimental setup and the modeling are compared in Figures 7.5c and d. The close 
–
+ VDC1
RCi1
Ldc
Ci2
Ci3
Ci1
Co1
Co2
Lo2
Load
Co3
Li1
Li2
Cs
Lr
Cr
FIGURE 7.3  Schematic diagram of single-stage Class E power amplifier used for charac-
terization examples.
180
0
0
0
–10
10
20
–20
30
–30
0
0
360
200
200
400
400
vs (θ)
vs (θ)
isc (θ)
isc (θ)
vo (θ)
vo (θ)
600
600
200
–200
400
–400
600
–600
800
0
0
200
400
600
800
800
540
720
900
FIGURE 7.4  Comparison of power amplifier waveforms reconstructed from harmonic 
modeling with that from (a) harmonic model and (b) simulation.
www.ebook3000.com

295
Phase-Controlled Switch-Mode Amplifiers
qualitative match of the switch voltage waveforms between the harmonic model and 
the experimental amplifier is apparent from Figures 7.5a and b. The quantitative dif-
ference in the switch voltage values is obviously because of the fact that the power 
efficiency of the experimental amplifier is in the 78%–89% range for the rail voltage 
20 n
600 V
400 V
(a)
Vdc= 60 
Vdc= 100 
Vdc= 80 
Vdc= 120
Vdc= 140 
Vdc= 160
73.75 ns 
0 V
0 V
400 V
400 V
(b)
Vdc= 60 
Vdc= 80 
Vdc= 100 
Vdc= 120 
Vdc= 140 
Vdc= 160 
(c)
80 V
120 V
(d)
800 W
200 W
80 V
120 V
FIGURE 7.5  Comparison of switch voltage waveforms reconstructed from the harmonic 
modeling with experimental results, for various rail voltages with 50 Ω load. (a) Switch volt-
age waveforms of the experimental power amplifier, (b) Switch voltage waveforms recon-
structed from harmonic modeling, (c) Input and output powers of the experimental power 
amplifier, and (d) Input and output powers of the power amplifier obtained through harmonic 
modeling.

296
Linear and Switch-Mode RF Power Amplifiers
range considered, whereas the harmonic modeling does not account for conduction 
losses in the power switch and other components of the amplifier circuit.
Shown in Figure 7.6 is the comparison of the results of the harmonic-based algo-
rithm with that of the simulation for the case of load variation through a constant 
VSWR circle in the Smith chart, with both the rail voltage Vdc and the duty cycle 
τ  held constant at 150 V and 0.5, respectively, for all the runs. The close match 
of the performance of the harmonic model-based algorithm to that of the simula-
tion is evident from all the variables depicted in the figure. The small errors seen 
in the rms values of the switch voltage and the nonconduction end angle ε0 (=ε1=
ε2, for this case) can be attributed to neglecting the higher-order harmonic com-
ponents above the second in the harmonic model-based algorithm. Also evident 
from Figure 7.5 is the classic characteristic of Class E (or any switch-mode) PA 
reported in the literature (e.g., [10]), where the output power steeply rises in the 
0
10
20
30
230
240
250
260
270
280
290
0
10
20
30
0
500
1000
1500
2000
0
10
20
30
100
200
300
400
500
600
0
10
20
30
–2
–1
0
1
2
3
0
10
20
30
0
10
20
Switch voltage
[Vrms] 
Load point 
Switch and shunt capacitor 
Load point 
0
10
20
30
0
20
40
60
Angle εo [°]
Load point 
Load point 
Output power [W] 
Load point 
Load
resistance 
Load
reactance 
Output voltage
[Vrms] 
Load point
Harmonic modeling
Simulation
FIGURE 7.6  Variation of power amplifier circuit variables with load (VSWR = 3.0, 
Vdc = 150 V, τ  = 0.5).
www.ebook3000.com

297
Phase-Controlled Switch-Mode Amplifiers
neighborhood of the low-resistance load point at which the load reactive component 
is in near resonance with the equivalent output reactance of the PA. It is well known 
that this characteristic warrants the need for additional protection schemes such as 
inductive clamping [11].
Figure 7.7 shows the comparison between the harmonic model-based algorithm 
and the circuit simulation in terms of PA circuit variables as functions of the duty 
cycle τ, for two cases of load points, a resistor–capacitor and a resistor–inductor. The 
results match up closely for all variables including the angles ε1 and ε2. The errors 
noted in the case of ε1 are obviously due to the difficulty in accurately modeling the 
discontinuities of the switch voltage waveform using only limited harmonic order 
components (n = 2).
Figure 7.8 shows the characteristics of the Class E PA with the adjustment of 
the DC rail voltage, Vdc, derived using the harmonic modeling. Results are shown 
in Smith charts for the load variation through a constant VSWR circle, for three 
constant VSWR cases—1.5, 3.0, and 5.0. From Figure 7.6b, the basic nonlinear-
ity of the required rail voltage profile to maintain constant output power with 
reference to the load point within a constant VSWR circle is apparent from the 
offset of the three loop curves from the center. More importantly, the voltage rail 
curves for the higher VSWR loads show that when the load has low resistance with 
the reactive component in close resonance with the output impedance of the PA, 
the voltage rail should be substantially lowered to regulate the output power at the 
desired value. Figure 7.8 also indicates that the rms voltage across the switch is 
in approximate proportion with the rail voltage for the various load conditions (as 
0.3
0.4
0.5
0.6
0.7
0
50
100
Angle ε1 [°]
Duty cycle
0.3
0.4
0.5
0.6
0.7
0
50
100
150
Angle ε2 [°]
Duty cycle
0.3
0.4
0.5
0.6
0.7
0
10
20
30
0.3
0.4
0.5
0.6
0.7
0
1000
2000
Output power [W] 
Switch and shunt capacitor current [Arms] 
Duty cycle
Duty cycle
Load: 0.6 + j0.8 per unit
Load: 0.6 – j0.8 per unit
Simulation
Simulation
Harmonic modeling 
Harmonic modeling 
FIGURE 7.7  Variation of power amplifier circuit variables with duty cycle of the radio fre-
quency gate signal (Vdc = 150 V).

298
Linear and Switch-Mode RF Power Amplifiers
seen from the similar shape and angular orientation of the corresponding curves 
in the Smith chart). However, the rms value of the combined current through the 
switch and the capacitor has a proportional, but phase-shifted, relationship with 
the rail voltage (although the voltage and current curves have similar shape, the 
current curves have a leading angular orientation with reference to the voltage 
curves in the Smith chart). The noted phase shift between the voltage and current 
0
30
60
90
120
150
180
210
240
270
300
330
0
100
200
300
Switch voltage [Vrms] 
0
30
60
90
120
150
180
210
240
270
300
330
0
5
10
15
20
Combined switch and shunt 
0
30
60
90
120
150
180
210
240
270
300
330
0
200
400
Power output [W] 
0
30
60
90
120
150
180
210
240
270
300
330
0
50
100
150
200
Controlled PA rail voltage [VDC] 
VSWR = 1.5 (Pref = 500 W);
VSWR = 3 (Pref = 300 W); τ = 5.0  
VSWR = 5 (Pref = 100 W)
FIGURE 7.8  Characteristics of the Class E power amplifier under output power regulation 
through rail voltage control, for constant VSWR loads, τ = 0.5.
www.ebook3000.com

299
Phase-Controlled Switch-Mode Amplifiers
profiles is due to the impact of the filtering circuits of the Class E amplifier and 
their reactive values relative to the load.
7.2.1.2  Phase-Controlled Class E Power Amplifier
In this section, we consider a phase-controlled PA pair made up of two identical stages 
of the single-ended Class E PA shown in Figure 7.3, connected through an ideal 1:1 
combiner-transformer. For the purpose of normalization, and to allow comparative 
analysis with the single-ended amplifier, the load values considered for the PA pair 
are selected twice that of the corresponding load values of the single-ended amplifier.
A comparison of the results of the harmonic modeling of the phase-controlled 
PA pair with that of the corresponding experimental implementation is presented 
in Figure 7.9. The switch voltage waveforms of the master and the slave PAs of the 
experimental PA pair, and the corresponding waveforms reconstructed from the har-
monic model shown for a sample case of load, phase control angle, and rail voltage, 
indicate that the results of the harmonic modeling closely match that of the experi-
mental implementation.
Figure 7.10 depicts the output power profile (z-axis) as a function of the phase 
control angle (x-axis) with reference to variation in the load impedance through a 
constant VSWR circle (y-axis). It indicates that the output power is controllable in 
a near-linear fashion through phase control, for a given load condition. Figure 7.11 
shows the DC input power (z-axis) drawn by each PA as a function of the phase con-
trol angle (x-axis) with reference to variation in the load impedance through a con-
stant VSWR circle (y-axis). It indicates that the DC input power imbalance between 
the master and slave PAs is minimum at the extremes of the phase angle range (i.e., 
near 180° and 0°), and in some range, part of the input power drawn by the master PA 
is returned to the DC source through the slave PA, as seen from the negative values 
of the DC input current of the slave amplifier.
0 V
400 V
400 V
0 V
Master PA
Slave PA
20 ns
Master PA
Slave PA
FIGURE 7.9  Comparison of switch voltage waveforms of the phase-controlled Class E 
power amplifier pair reconstructed from harmonic modeling with the experimental results – 
Load: 40 − j30 Ω; Vdc = 140 V; Output power = 350 W.

300
Linear and Switch-Mode RF Power Amplifiers
Figure 7.12 shows the characteristics of the Class E PA pair with output power 
regulated through the adjustment of the phase angle of the RF signal of the slave PA, 
derived using the harmonic modeling, with the results shown in Smith charts for the 
load variation through three constant VSWR circles. The following are apparent 
from the figure: The combined rms current through the switch and the shunt capaci-
tor is higher in the master PA than in the slave amplifier for all loading conditions, 
whereas the rms voltage across the switch in both the master and the slave amplifiers 
is about the same. Also from Figures 7.8 and 7.12, when compared with the single-
ended PA where the power regulation is achieved through rail voltage control, the 
combined switch-capacitor current and the switch voltage are significantly higher 
for the phase-controlled amplifier pair, for the same per-amplifier output power. This 
indicates that the rail voltage control as well as the phase control may have significant 
Slave PA
Master PA
60°
0°
120°
180°
0A
6A
Capacitive
Inductive
–90°
Load angle
90°
Phase angle
FIGURE 7.11  DC input current (z-axis) of the master and slave PAs vs. phase angle (y-axis) 
for load points around VSWR = 1.25 circle (x-axis).
60°
0°
120°
180°
Phase angle
0W
2000 W
1000 W
Load angle
Capacitive
Inductive
90°
–90°
FIGURE 7.10  Output power (z-axis) vs phase angle (y-axis) for load points around 
VSWR = 1.25 circle (x-axis).
www.ebook3000.com

301
Phase-Controlled Switch-Mode Amplifiers
0
30
60
90
120
150
180
210
240
270
300
330
0
400
800
0
30
60
90
120
150
180
210
240
270
300
330
0
50
100
150
0
30
60
90
120
150
180
210
240
270
300
330
0
10
20
0
30
60
90
120
150
180
210
240
270
300
330
0
5
10
15
20
25
0
30
60
90
120
150
180
210
240
270
300
330
0
100
200
300
0
30
60
90
120
150
180
210
240
270
300
330
0
100
200
300
Combined switch and capacitor
current of the master PA [Arms]
Combined switch and capacitor
current of the slave PA [Arms]
Switch voltage of the slave
PA [Vrms]
Switch voltage of the master
PA [Vrms]
Phase angle of the slave PA’s
RF control signal 
Combined power output of
the master and slave PA’s [W]
VSWR = 1.5 (Pref = 1000 W);
VSWR = 3 (Pref = 600 W); τ = 0.5  
VSWR = 5 (Pref = 200 W)
FIGURE 7.12  Characteristics of the phase-controlled Class E PA pair under output power 
regulation, for constant VSWR loads, τ = 0.5.

302
Linear and Switch-Mode RF Power Amplifiers
roles to play in practical PA control designs: For example, where high-speed output 
transient response is important, a fast-control loop can be designed with the phase 
angle as the primary control mechanism; on the other hand, high-speed response can 
be traded off for high efficiency and/or low voltage and current stresses using the rail 
voltage control as the main control method.
Overall, the systematic development of a harmonic model-based analysis tool facili-
tates the characterization of Class E–based amplifiers for arbitrary loading conditions. 
The analysis exploits the fact that the nonlinearity of the basic Class E amplifier is con-
fined to the single-ended switching action, and that the resulting voltage and current 
signals have dominant harmonics of specific known order (e.g., n = 2). The use of both 
the direct and the quadrature components of the fundamental and harmonics up to a 
selected order allows the voltage and current equations of the PA to be established in a 
quasi-linear form, which are then solved using conventional iterative solution methods. 
The analysis algorithm is extended to characterize the phase-controlled Class E PA 
pair, using direct augmentation of circuit equations. Comparison with simulation and 
representative experimental results shows that the characterization through harmonic 
modeling has very good and acceptable accuracy levels. Higher accuracy levels can be 
achieved by including higher-order harmonic contents in the modeling, however, at the 
cost of increased computation complexity. Characterization through harmonic model-
ing is highly useful in the circuit design process of Class E-based PAs, for example, 
in rapidly assessing the voltage and current stresses on switching devices and critical 
filtering components, and for the comparative impact analysis of competing control 
methodologies, all without the need for extensive circuit simulation tools.
7.3  PULSING OF SWITCH-MODE AMPLIFIERS
The RF envelope pulsing technique using phasing with harmonic modeling to pulse 
switch-mode amplifiers have been introduced by this author and his colleague in 
Reference [12] and implemented for Class E amplifiers. In this section, pulsing of 
Class E amplifiers will be discussed, and formulation, simulation, and measurement 
results will be illustrated.
7.3.1  Pulsing of Class E Amplifiers
The harmonic modeling of phase-controlled Class E amplifier is detailed in 
References [9,12] and can be illustrated in Figure 7.13. The phase-controlled ampli-
fier shown in Figure 7.13 consists of two single-ended amplifiers called Master PA 
and Slave PA. Ideal switches and components are used to demonstrate the opera-
tional principle of the amplifier and derive the equations. In Figure 7.13, the average 
of the current through the transistor Q1  can be written as
	
∫
=
π
θ
θ
δ
ψ+δ
i
i
1
2
( ) d
so
sc
	
(7.7)
www.ebook3000.com

303
Phase-Controlled Switch-Mode Amplifiers
Q1, which is also considered to be an ideal switch, is turned on at an angle δ, 
and it conducts between the angles δ and ψ + δ. isc  is the steady-state current and 
defined by
	
∑
θ =
+
−
θ +
−
θ
=
i
i
i
i
h
i
i
h )
( )
[(
) sin (
) (
)cos (
]
dh
dh
qh
qh
h
n
sc
dc
1
2
1
2
1
	
(7.8)
Current in Equation 7.8, isc, is the current on the master side of the Class E amplifier 
as shown in Figure 7.13 and has fundamental and harmonic components. idh and iqh 
are the direct and quadrature harmonic components of the current, respectively, and 
h is used to define the number of the harmonics. The gate drive signals, g1 and g2, on 
master and slave of the amplifier, are basically phased to produce the pulsed output.
If the master and slave PAs are phased by 180°, the ON/OFF pulsing is obtained, 
and if they are phased with any other angle, the two-level pulsing is obtained. When 
the phase difference is 180°, the maximum pulsed output power is delivered. The gate 
drive signals, g1 and g2, which are used to excite gates of the transistors of master 
and slave PAs are shown in Figure 7.14. The theoretical profiles for power, current, 
and voltage for the phase-controlled Class E amplifiers are obtained using Mathcad 
with the formulation presented in References [9,12]. The power profile of the phase-
controlled Class E amplifier for inductive and capacitive loads versus phase angle is 
shown in Figure 7.15. The power profile shows that there is an imbalance in DC input 
power between the master and slave PAs, and this imbalance is minimum 180° and 0°.
The rms voltage and current profile of the transistors for phase-controlled Class 
E amplifiers are illustrated in Figure 7.16a and b, respectively. Based on the analyti-
cal results illustrated in Figure 7.16a, the voltage across the transistors significantly 
increases when the phase approaches 0°. It is concluded from Figure 7.16b that the 
current imbalance between the master and the slave is worse when the phase differ-
ence is between 0° and 180°.
Master PA
Output filter
Input filter
io
io
io
Vo
Vo
Vos
Zo
T1
Slave PA
Cs
Cs
Vs
isc
g1
g2
Q2
Q1
Vdc
+
Vi
i2
i1
FIGURE 7.13  Illustration of phase-controlled Class E amplifiers.

304
Linear and Switch-Mode RF Power Amplifiers
7.3.1.1  Simulation Results
The phase-controlled Class E amplifier for pulsing applications is simulated, and the 
amplifier is tested for several load conditions during pulsing. The design specifica-
tions for the phase-controlled Class E amplifiers are given in Table 7.1.
Phase-controlled amplifier consists of two single-ended Class E amplifiers that 
are connected with output balun. Each of the single-ended amplifier is fed via RF 
Phase control
signal
0°
R
0°
0°
0°
0
(b)
(a)
0°
0°
180°
180°
180°
180°
180°
180°
Phase control
signal
(Slave PA)
Phase control
signal
(Master PA)
Phase control
signal
RF output
voltage
RF output
voltage
(Master)
(Slave)
FIGURE 7.14  Illustration of ON/OFF and two-level pulsing of Class E amplifiers (a) ON/OF 
pulsing of Class E amplifiers and (b) two-level pulsing of Class E amplifiers.
Input  DC power
Master power
ampliﬁer
Phase 180°– 0°
Inductive
Capacitive
Load impedance
with ﬁxed VSWR
Slave
power
amplifer
FIGURE 7.15  Analytical power profile of phase-controlled Class E amplifiers.
www.ebook3000.com

305
Phase-Controlled Switch-Mode Amplifiers
pulse signal that is phased based on the desired power level as shown in Figure 7.14. 
The schematic of the simulated and experimented phase-controlled Class E ampli-
fier for pulsing is shown in Figure 7.17. Nonlinear time domain circuit simulator, 
Pspice, is used to characterize the pulsing amplifier.
In the phase-controlled pulsing amplifier circuit, IXFH12N100 Metal Oxide 
Field Effect Transistors (MOSFETs) are connected in parallel for the master and 
slave sides. Each side of the amplifier provides approximately 900 W RF power to 
a matched load when rail voltage is set to 180 V in continuous wave (CW) mode. 
Power is doubled when they are combined via output balun as shown in Figure 7.17. 
MOSFETs are rated for 1000 V and 12 A, and as a result, it is important not to exceed 
Inductive
Load impedance
with fixed VSWR
Power switch
RMS voltage
Master power
amplifier
Slave power
amplifier
Phase 180°– 0°
Capacitive
(a)
Power switch
RMS voltage
Master power
amplifier
Slave power
amplifier
Phase 180°– 0°
Load impedance
with fixed VSWR
Inductive
Capacitive
(b)
FIGURE 7.16  Analytical (a) voltage and (b) current profile of the transistors for phase-
controlled Class E amplifiers.
TABLE 7.1
Specifications for Phase-Controlled Class E Amplifier
CW RF Frequency 
(MHz)
Pulse Frequency 
Range (kHz)
Rated CW 
Power (W)
Agile Vdc (V)
Rated Pulsed 
Power (W)
13.56
0–100
1800
0–180
500
CW, continuous wave; RF, radio frequency.

306
Linear and Switch-Mode RF Power Amplifiers
these rated values during pulsing. The simulation results when pulsing to a matched 
load with 50% duty cycle, D = 0.5, and 67.8 kHz pulse period, PP = 67.8 kHz at 
Vdc = 180 V are illustrated in Figure 7.18. As seen, the ideal pulse is used to drive the 
MOSFETs, and the maximum output is obtained when master and slave PAs are out 
of phase by 180°, and minimum power is obtained when they are in phase.
The average power during pulsing ranges from 892 to 1033 W as shown in 
Figure 7.18. The power and drain-to-source impedance distribution versus phase dif-
ference between the master and slave PAs are also simulated and plotted on the Smith 
Q2
IXFH12N10DF
+
Rail –Vdc = 0–180 V
R1
12
L1
3.9 uH
L2
330 nH
L3
390 nH
C2
1200 pF
Q1
IXFH12N10DF
R11
4.7
C4
82 pF
C5
OMIT
D1
C2D10120A
C7
330 pF
C9
330 pF
L:5
330 nH
C8
100 pF
C6
1200 pF
L4
330 nH
T2
T1
C3
82 pF
C1
430 pF
C15
0.15 uF
R7
300
R8
300
R9
300
R10
300
Q3
IRF510
C14
680 pF
T3
z
L
o
a
d
R2
5.1
Q4
2N3906
Q5
2N3904
R3
200
R12
200
R4
200
Q6
2N7000
Q7
2N7000
g1
Gate – Vdc = 12 V
+
C10
220 uF
C11
220 uF
C12
1 uF
C13
1 uF
–
J1
R6
5.1
R5
5.1
C9
330 pF
C7
330 pF
L:5
330 nH
c8
100 pF
C6
1200 pF
L4
330 nH
T2
T1
D1
C2D10120A
05
CMIT
C4
82 pF
Q2
IXFH12N10DF
R11
4.7
Q1
IXFH12N10DF 
C2
1200 pF
L3
390 nH
L2
330 nH
L1
3.9 uH
R1
12
+
Rail– Vdc = 0–180 V
+
–
C15
0.15 uF
C1
430 pF
C3
82 pF
C10
220 uF
C11
220 uF
C12
1 uF
C13
1 uF
Gate – Vdc =12V
g2
Q7
2 N700D
R6
5.1
R5
51
06
2 N700D
R4
20 D
R12
200
R3
200
05
2N3904
Q4
2 N3906
R2
5.1
Q3
IRF510
C14
88D pF
R10
300
R9
300
R8
300
R7
300
–
J1
–
FIGURE 7.17  Phase-controlled Class E amplifier for pulsing applications.
www.ebook3000.com

307
Phase-Controlled Switch-Mode Amplifiers
chart (Figure 7.19). Based on the simulation results, power distribution is maximized 
when the phase difference between the master and slave PAs is 180°. The drain-to-
source impedance distribution for the master and slave PAs versus phase is different 
as shown in Figure 7.19a and b, respectively. Hence, this results in a variation of the 
power distribution provided by master and slave PAs. The results confirm the ones 
obtained in Figure 7.15. In addition, the drain-to-source voltage for master and slave 
PAs are different due to the impedance variation.
This is illustrated in Figure 7.20a and b, respectively. Master and slave PAs expe-
rience higher voltage levels as the phase approaches zero, as confirmed with the ana-
lytical results in Figure 7.16a. The simulated voltage values are below the breakdown 
voltages of the transistors. Each transistor’s (die) dissipation for proper operation is 
defined by the MOSFET manufacturer to be 300 W. This determines the thermal 
profile of the transistors used in the amplifier. The die dissipation or thermal profile 
of the phase-controlled Class E amplifier versus phase is simulated and shown in 
Figure 7.21. The dissipation simulated was always less than 110 W. This value is 
much lower than the maximum dissipation level. It is important to note also that the 
die dissipation was worse for the transistors of the slave PA in comparison to the 
die dissipation of the transistors for master PA. Class E phase-controlled RF ampli-
fier is also simulated and pulsed for high VSWR loads. The simulated impedance 
points when load has VSWR of 2 is shown in Figure 7.22. The pulse waveforms 
when amplifier is pulsed with the same condition described in Figure 7.18 are illus-
trated in Figure 7.23. The average power during pulsing for the impedance point 2 
in Figure 7.21 ranges from 335 to 418 W. RF pulsed waveforms are also observed to 
sustain their characteristics during pulsing.
After simulating and pulsing the phase-controlled Class E amplifier for several 
cases, it has been confirmed that the simulated values were always within the safe 
In phase
In phase
500 V
–500 V
0 V
0 V
1.0 KW
2.0 KW
0 W
10 µs
20 µs
30 µs
40 µs
50 µs
Time
60 µs
70 µs
75 µs
V(VS:+)
V(Rload: 2)
(44.99 u, 892.03)
(51.796 u,1.0332 K)
SEL>>
5.0 V
2.5 V
Out phase
PW = 7.374 u
Out phase
AVG (W(Rload))
FIGURE 7.18  Simulated pulse waveforms for a matched load with D = .0.5 and PP = 67.8 kHz 
at Vdc = 180 V.

308
Linear and Switch-Mode RF Power Amplifiers
700
800
900
600
300
200
–1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
∆Phase = 180
∆Phase = 0
–0.5
0.5
1
0
Real
Imag
400
500
(a)
660
640
580
560
–1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
(b)
∆Phase = 180
∆Phase = 0
–0.5
0.5
1
0
Real
Imag
600
620
680
FIGURE 7.19  Simulated power distribution and drain-to-source impedance vs distribution 
and driving gate signals phase difference. (a) Master PA and (b) Slave PA.
www.ebook3000.com

309
Phase-Controlled Switch-Mode Amplifiers
620
640
660
600
540
520
500
–1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
∆Phase = 180°
∆Phase = 0°
–0.5
0.5
1
0
Real
Imag
560
580
(a)
660
640
580
560
–1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
(b)
∆Phase = 180°
∆Phase = 0°
–0.5
0.5
1
0
Real
Imag
600
620
680
FIGURE 7.20  Simulated Vds and drain-to-source impedance distribution vs driving gate 
signals phase difference. (a) Master PA and (b) Slave PA.

310
Linear and Switch-Mode RF Power Amplifiers
operating area (SOA) of the components, and the amplifier was able to produce the 
required RF pulse waveforms. Hence, the phase-controlled PA is built and tested. 
The measurement results are detailed in Section 7.3.1.2.
7.3.1.2  Experimental Results
The phase-controlled pulsing Class E amplifier in Figure 7.13 is built and tested. The 
constructed and tested amplifier is shown in Figure 7.24. The amplifier is tested for 
various pulsing frequencies for matched and mismatched loads and characterized.
100
90
60
50
–1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Master
Slave
∆Phase = 180°
∆Phase = 0°
Die dissipation and drain to source impedance versus phase
–0.5
0.5
1
0
Real
Imag
70
80
110
FIGURE 7.21  Simulated die dissipation for phase-controlled pulsing PA.
VSWR = 2
Z1 = 25    0°
Z3 = 100    0°
Z4 = 50    –37°
Z2 = 50    37°
FIGURE 7.22  The impedance points that amplifier is pulsed when VSWR = 2.
www.ebook3000.com

311
Phase-Controlled Switch-Mode Amplifiers
7.3.1.2.1  Matched Load Characteristics of Pulsing Class E Amplifier
The drain efficiency for a matched load when pulsing frequencies range from 20 to 
100 kHz is given in Figure 7.25. The duty cycle is set to be D = 0.5, and rail voltage 
is adjusted to 140 Vdc during the testing.
Input master
Output
Slave PA
Master PA
Input slave
Balun
RF choke
FIGURE 7.24  Constructed and tested phase-controlled pulsing Class E amplifier.
50 V
0 V
–50 V
5 V
2.5 V
0 V
2 W
1 W
0 W
13
20
30
40
Time [µs]
(44.99 u, 892.03) (51.796 u, 1.0332 K)
PW = 
7.374 µ
In phase
In phase
Out phase
Out phase
50
60
75
70
V(V8: +)
V(Rload: 2)
FIGURE 7.23  Simulated pulse waveforms Z = 50∠37° with VSWR = 2 and D = 0.5 and 
PP = 67.8 kHz at Vdc = 140 V.

312
Linear and Switch-Mode RF Power Amplifiers
The drain efficiency is lowest at the highest pulsed frequency. Die dissipation 
for pulsing frequencies from 20 to 100 kHz are also measured and illustrated in 
Figure 7.26. The die dissipation is worst when the amplifier is pulsed with 100 kHz 
pulsed frequency. However, the die dissipation is well within the SOA for all cases 
when the amplifier is terminated to a matched load. The measured rise time, fall 
700
600
500
400
300
200
100
Pout [W]
0
Drain efficiency [%]
10
0
20
30
40
50
60
70
80
90
f = 20 kHz
f = 30 kHz
f = 40 kHz
f = 50 kHz
f = 60 kHz
f = 70 kHz
f = 80 kHz
f = 90 kHz
f = 100 kHz
FIGURE 7.25  Drain efficiency vs output power for various pulsing frequencies for a 
matched load.
f = 20 kHz
f = 30 kHz
f = 40 kHz
f = 50 kHz
f = 60 kHz
f = 70 kHz
f = 80 kHz
f = 90 kHz
f = 100 kHz
70
600
500
400
300
200
100
Pout [W]
Drain efficiency [%]
0
10
0
20
30
40
50
60
70
FIGURE 7.26  Die dissipation vs output power for various pulsing frequencies for a matched 
load.
www.ebook3000.com

313
Phase-Controlled Switch-Mode Amplifiers
time, settling time, and delay time for phase-controlled pulsing Class E amplifier 
versus various pulse frequencies when amplifier was pulsing to a matched load are 
illustrated in Figures 7.27 through 7.30, respectively.
The rise time varies from 1.47 to 0.93 μs, whereas fall time changes from 0.36 to 
0.43 μs as pulse frequency is varied from 20 to 100 kHz. Settling time stays between 
2.2 and 2.6 μs, and delay time varies from 1.6 to 2.1 μs as pulse frequency changes. 
The variation in the drain-to-source voltage of the transistors during pulsing is also 
measured and shown in Figure 7.31. It is seen that the drain-to-source voltage is 
Fall time [µs]
1.5
1.4
1.2
1
0.8
0.5
0.2
0.4
0
0
20
40
60
80
100
120
Pulsed frequency [kHz]
FIGURE 7.27  Rise time vs pulsing frequency phase-controlled Class E pulsing amplifier.
Fall time [µs]
600
500
400
300
200
100
0
0
20
40
60
80
100
120
Pulsed frequency [kHz]
FIGURE 7.28  Fall time vs various pulse frequencies for phase-controlled Class E pulsing 
amplifier.

314
Linear and Switch-Mode RF Power Amplifiers
between 887 and 914 V when the amplifier is pulsed at the preset conditions for the 
pulse frequencies from 20 to 100 kHz.
Class E phase-controlled amplifier pulse waveforms are obtained when ampli-
fier is pulsed from 20 kHz to 100 kHz for ON/OFF pulsing, where master and slave 
PAs are out-phased by 180° (Figure 7.32). It is observed that the amplifier was 
able to maintain its stability during pulsing even for the high-pulse frequencies. In 
Figures 7.32 through 7.34, the zoomed-in RF pulse envelope waveforms are given for 
reference for each pulse frequency.
Settling time [µs]
3
2.5
2
1.5
1
0.5
0
0
20
40
60
80
100
120
Pulsed frequency [kHz]
FIGURE 7.29  Settling time vs various pulse frequencies for phase-controlled Class E puls-
ing amplifier.
2.5
2
1.5
Delay time [µs]
1
0.5
0
0
20
40
60
80
100
120
Pulsed frequency [kHz]
FIGURE 7.30  Delay time vs various pulse frequencies for phase-controlled Class E pulsing 
amplifier.
www.ebook3000.com

315
Phase-Controlled Switch-Mode Amplifiers
Vds_worst [V]
910
905
900
895
890
885
0
20
40
60
80
100
120
Pulsed frequency [kHz]
915
920
FIGURE 7.31  Transistor drain-to-source voltage, Vds, vs pulse frequencies from 20 to 
100 kHz when phase-controlled Class E amplifier is terminated with a matched load.
(a)
(b)
FIGURE 7.32  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
when (a) pulse frequency (PF) = 20 kHz and (b) Zoomed in.
(a)
(b)
FIGURE 7.33  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
when (a) pulse frequency (PF) = 50 kHz and (b) Zoomed in.

316
Linear and Switch-Mode RF Power Amplifiers
In practice, plasma chambers might be required to be energized with different 
pulse frequencies and power levels for some processes. This requires amplifiers to 
have the capacity of two-level pulsing without any stability problems. Hence, the 
phase-controlled Class E RF amplifier is also tested for two-level pulsing, when it is 
terminated with matched load for different pulse frequencies. The same operating 
conditions have been used by setting duty cycle to D = 0.5 and rail voltage to 140 Vdc, 
and out phasing of master and slave PAs. The pulse waveforms when the amplifier is 
pulsed with pulse frequencies between 20 and 100 kHz are illustrated in Figures 7.35 
through 7.37. It is important to note that Class E amplifier that is designed based on 
harmonic modeling was able to provide the required two-level pulsing power levels 
with no oscillation as desired.
7.3.1.2.2  Mismatched Load Characteristics of Pulsing Class E Amplifier
Class E phase-controlled amplifier shown in Figure 7.24 is terminated with various 
high VSWR loads to have complete characterization. RF amplifier was terminated 
with the load impedance points shown in Figure 7.22 and pulsed at different frequen-
cies. The response of the amplifier for drain efficiency and die dissipation versus out-
put power are given in Figures 7.38 and 7.39, respectively. As seen from the figures, 
(a)
(b)
FIGURE 7.35  Phase-controlled Class E amplifier pulse waveforms for two-level pulsing 
when (a) pulse frequency (PF) = 20 kHz and (b) Zoomed in.
(a)
(b)
FIGURE 7.34  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
when (a) pulse frequency (PF) =100 kHz and (b) Zoomed in.
www.ebook3000.com

317
Phase-Controlled Switch-Mode Amplifiers
(a)
(b)
FIGURE 7.36  Phase-controlled Class E amplifier pulse waveforms for two-level pulsing 
when (a) pulse frequency (PF) = 50 kHz and (b) Zoomed in.
(a)
(b)
FIGURE 7.37  Phase-controlled Class E amplifier pulse waveforms for two-level pulsing 
when (a) pulse frequency (PF) = 100 kHz and (b) Zoomed in.
Pout [W]
0
50
100
150
350
400
500
200
250
300
450
50
40
30
20
10
0
60
70
Drain efficiency [%]
80
90
f = 20 kHz
f = 50 kHz
f = 100 kHz
FIGURE 7.38  Drain efficiency vs output power for various pulsing frequencies for 
Z = 50∠37° with VSWR = 2 and D = 0.5 and PP = 67.8 kHz at Vdc = 140 V.

318
Linear and Switch-Mode RF Power Amplifiers
the change in drain efficiency is minimal, and die dissipation remains to be less than 
45 W for pulse frequencies from 20 to 100 kHz.
Class E phase-controlled amplifier is also pulsed at four different impedance 
points with VSWR of 2 as shown in Figure 7.22 when PF = 20 kHz, D = 0.5, and rail 
voltage = 140 Vdc. The pulse waveforms are illustrated in Figures 7.40 through 7.43.
As shown, RF amplifier designed and pulsed using phasing based on harmonic 
modeling was always able to keep its stability. The overshoot is also measured to be 
less than 5%. The stability of the amplifier is measured with spectrum analyzer for 
the mismatched loads (Figure 7.44). The spurious and harmonic levels are less than 
–64 dB as shown in the figure.
Pout (W)
0
50
100
150
350
400
500
200
250
300
450
25
20
Die dissipation (W)
15
10
5
0
30
35
40
45
f = 20 kHz
f = 50 kHz
f = 100 kHz
FIGURE 7.39  Die dissipation vs output power for various pulsing frequencies for Z = 50∠37° 
with VSWR = 2 and D = 0.5 and PP = 67.8 kHz at Vdc = 140 V.
(a)
(b)
FIGURE 7.40  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
for a mismatched load with PF = 20 kHz and D = 0.5 when (a) Z = 25∠0° and (b) Z = 25∠0° 
zoomed in.
www.ebook3000.com

319
Phase-Controlled Switch-Mode Amplifiers
(a)
(b)
FIGURE 7.41  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
for a mismatched load with PF = 20 kHz and D = 0.5 when (a) Z = 50∠37° and (b) Z = 50∠37° 
zoomed in.
(a)
(b)
FIGURE 7.43  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing for 
a mismatched load with PF = 20 kHz and D = 0.5 when (a) Z = 50∠−37° and (b) Z = 50∠−37° 
zoomed in.
(a)
(b)
FIGURE 7.42  Phase-controlled Class E amplifier pulse waveforms for ON/OFF pulsing 
for a mismatched load with PF = 20 kHz and D = 0.5 when (a) Z = 100∠0° and (b) Z = 100∠0° 
zoomed in.

320
Linear and Switch-Mode RF Power Amplifiers
REFERENCES
	
1.	 C.Q. Hu, X.Z. Zhang, S.P. Huang, Class-E combined converter by phase shift control, 
1989 IEEE Power Electronics Specialists Conference, pp. 229–243, 1989.
	
2.	 K. Shinoda, T. Suetsugu, M. Matsuo, S. Mori, Analysis of phase-controlled resonant 
DC-AC inverters with Class-E amplifier and frequency multipliers, IEEE Transactions 
on Industrial Electronics, Vol. 45, No. 3, pp. 412–420, 1998.
	
3.	 I. Boonyaroonate, S. Mori, Class E phase-controlled inverter with single RF choke, 20th 
International Telecommunications Energy Conference (INTELEC), San Francisco, 
pp. 549–553, October 1998.
	
4.	 K. Kawamoto, H. Sekiya, K. Koizumi, I. Sasase, Design of a generalized phase-
controlled Class-E inverter, The 2001 IEEE International Symposium on Circuits and 
Systems, Sydney, Australia, pp. 393–396, May 2001.
	
5.	 H. Sekiya, J. Lu, T. Yahagi, Phase control for resonant DC-DC converter with 
Class-DE inverter and Class-E rectifier, IEEE Transactions on Circuits and Systems, 
Fundamental Theory and Applications, Vol. 53, No. 2, pp. 254–263, 2006.
	
6.	 K. Tom, M. Faulkner, T. Lejon, Performance analysis of pulse width modulated RF 
Class-E amplifier, 63rd IEEE Vehicular Technology Conference, Melbourne, Australia, 
pp. 1807–1811, May 2006.
	
7.	 K. Tom, V. Bassoo, M. Faulkner, T. Lejon, Load-pull analysis of outphasing Class-E 
power amplifier, 2nd International Conference on Ultra Wideband Communication, 
Sydney, Australia, pp. 52–56, August 2007.
	
8.	 H. Sekiya, I. Sasase, S. Mori, Computation of design values of Class E amplifiers 
without using waveform equations, IEEE Transactions on Circuits and Systems I: 
Fundamental Theory and Applications, Vol. 49, No. 1, pp. 966–978, 2002.
	
9.	 S. Sivakumar, A. Eroglu, Analysis of Class-E based RF power amplifiers using har-
monic modeling, IEEE Transactions on Circuits and Systems I: Regular Papers, 
Vol. 57, No. 1, pp. 299–311, 2010.
PEAK
REF     11.0 dBm
MA
SC
CORR
AT 30 dB
MKR  ∆  8.60 MHz
–64.24 dB
LOG
10
dB/
FC
SB
CENTER 13.56 MHz
#RES BW 30 kHz
SWP 66.7 msec
RL
VBW 30 kHz
SPAN 20.00 MHz
FIGURE 7.44  Spectral content of phase-controlled Class E amplifier when pulsed with a 
mismatched load with VSWR = 2.
www.ebook3000.com

321
Phase-Controlled Switch-Mode Amplifiers
	 10.	 R. Frey, 500 W, Class-E 27.12 MHz amplifier using a single plastic MOSFET, 1999 
IEEE MTT-S International Microwave Symposium Digest, Vol. 1, pp. 359–362, 
Anaheim, CA, June 1999.
	 11.	 D. Lincoln, P. Bennett, Class E amplifier with inductive clamp, U.S. Patent # 7180758, 
February 20, 2007.
	 12.	 S. Sivakumar, A. Eroglu, Radio frequency (RF) envelope pulsing using phase switch-
ing of switch-mode power amplifiers, US Patent: US 7872523 B2, 2011.

www.ebook3000.com

323
8 Distortion and 
Modulation Effects in 
RF Power Amplifiers
8.1  INTRODUCTION
In transceiver systems, misalignments in the quadrature modulator feeding a nonlin-
ear high-power amplifier can produce distortion products that lead to spectrum leak-
age into adjacent channels. In this chapter, elimination of these distortion products 
will be discussed and detailed.
Quadrature modulation is a convenient and flexible way to produce nearly any 
type of waveform and has been in use for decades. As such, quadrature modulators 
are ubiquitous in communication systems as shown in Figure 8.1, and the perfor-
mance of this device is important to the overall system [1]. Ideal quadrature modula-
tors generate single continuous wave (CW) tone that can be used in radio frequency 
(RF) systems. The ideal system assumes no gain or phase changes in either the phase 
(I) or quadrature (Q) paths as shown in Figure 8.1. However, with real components, 
there will be losses, phase changes, and DC offsets that need to be taken into account 
to have a balanced system. IQ imbalance reduces the dynamic range and as a result 
degrades the performance of the system [2].
The effect of IQ imbalance on RF systems has been investigated by several 
researchers [3–8]. The linear imperfection feature effects of IQ gain and phase 
imbalance on image rejection ratio and error vector magnitude have been presented 
in References [3–4].
The effect of IQ imbalances on orthogonal frequency division multiplexing 
(OFDM) has been studied in References [5–7]. The effect of I/Q imbalance in the 
front-end section of low intermediate frequency receiver has been investigated 
in Reference. [8]. Several methods to improve IQ imbalance have been presented and 
discussed in the literature [9–16]. In References [9–13], lengthy and time-consuming 
compensation algorithms for OFDM receivers have been proposed to balance IQ 
paths. Adaptive equalization techniques using known preambles to balance IQ mod-
ulators are given in References [14–15].
The K-matrix modeling of IQ imbalance is presented in Reference. [16]. This 
requires extraction of K-matrix parameters using large signal network analyzer mea-
surements [17,18]. There are several other similar methods presented to improve I/Q 
imbalance in the literature [19–28]. As a result, the proposed methods to improve 
IQ imbalance in the literature are most of the time impractical, invasive, require 
calibration of the system before its operation, costly, and rely on several measure-
ments that are used for precalibration and stored in the memory.

324
Linear and Switch-Mode RF Power Amplifiers
In this chapter, a noninvasive IQ balancing system based on the image band rejec-
tion method is introduced to eliminate the distortion effects seen in RF amplifiers 
due to imperfections in IQ modulators when they are used as an RF input source [19]. 
The balancing system is furthermore simulated with nonlinear circuit simulator 
Advance Design System (ADS) for verification. The implementation of the proposed 
IQ balancing system is detailed step by step and shown in ADS. The analytical model 
is compared with the simulation results. It has been shown that drastic improvement 
has been obtained in the performance of the quadrature modulator when the method 
proposed is implemented. The method introduced in this chapter is noninvasive, 
which requires mixing RF output of the quadrature modulator with a signal at the 
image frequency that is phase-locked with the test signal. In the system discussed, 
unlike all other existing methods, only two sets of measurements during the opera-
tion are needed to obtain the correction factors. The correction factors are then used 
for self-calibration and optimization of image band signal, which makes the system 
noninvasive. A practical and simple IQ balancing method for nonideal quadrature 
modulators such as the one introduced here is applicable in RF systems where cost, 
time, and accuracy are important factors.
8.2  IDEAL QUADRATURE MODULATOR
Figure 8.2 shows the block diagram of an ideal quadrature modulator. In practice, 
the I and Q signals could be generated digitally from a Field-Programmable Gate 
Array (FPGA) device and Digital-to-Analog Converter (DAC) combination. Low-
pass filters would also be necessary to eliminate the aliasing effect of the digitally 
generated I and Q signals. The local oscillator (LO) could be created from a phase-
locked loop (PLL) or some other tunable CW source. The signal at the output of the 
mixer on I and Q paths can be expressed as
	
(
)
(
)
=
ω
+ω
+
ω
−ω


I
t
t
t
t
1
2 cos
cos
up
BB
LO
BB
LO
	
(8.1)
	
(
)
(
)
= ±
ω
−ω
−
ω
+ω


Q
t
t
t
t
1
2 cos
cos
up
BB
LO
BB
LO
	
(8.2)
The output signal from the modulator is then obtained from
Data in
FPGA
or
DSP
D/A
D/A
Quadrature
modulator
LO or carrier
Baseband
frequency
Radio
frequency
FIGURE 8.1  Typical transmitter system.
www.ebook3000.com

325
Distortion and Modulation Effects in RF Power Amplifiers
	
I
Q
t
t
t
t
t
t
t
t
1
2 cos
cos
1
2 cos
cos
up
up
BB
LO
BB
LO
BB
LO
BB
LO
(
)
(
)
(
)
(
)
+
=
ω
+ ω
+
ω
−ω


±
ω
−ω
−
ω
+ ω

	
(8.3)
From Equation 8.3, it is seen that by changing the sign of the Q input signal, either 
the upper sideband (
)
ω
+ω
t
t
BB
LO  or the lower sideband (
)
ω
+ω
t
t
BB
LO  can be can-
celled. This can be illustrated in Figure 8.3. For instance, when 
(
)
=
ω
Q
t
sin
BB  as 
shown in Figure 8.3a, then we have perfect cancellation, or quadrature nulling of the 
upper sideband, and as a result, we obtain the ideal modulator output signal as
	
(
)
=
ω
−ω
S
t
t
cos
out
BB
LO
	
(8.4)
Σ
Q = ±sin(ωBBt)
cos(ωLOt)
Sout
fc = ωBB
fc = ωBB
I = cos(ωBBt)
Iup
Quadrature
modulator
Qup
–90
FIGURE 8.2  Ideal quadrature modulator.
ω
Iup
Qup
Iup
Qup
Q = sin(ωBBt)
Q = –sin(ωBBt)
ω
ω
ω
ωLO
ωLO
ωLO
ωLO
(a)
(b)
FIGURE 8.3  Ideal quadrature modulator summation when (a) 
=
ω
Q
t
sin(
)
BB  (b) 
= −
ω
Q
t
sin(
)
BB .

326
Linear and Switch-Mode RF Power Amplifiers
In physically realizable systems, the antialiasing filters do not necessarily have iden-
tical frequency response. In addition, the mixers themselves have different conver-
sion loss as well as phase properties. Although the quadrature phase shifter in the 
LO path of the Q mixer is supposed to be exactly 90°, this is not possible in practice. 
Furthermore, the power combiner does not perfectly combine the two input signals 
without providing some imbalance in magnitude and phase. All these imperfections 
will cause an imbalance between I and Q paths.
8.3  NONIDEAL QUADRATURE MODULATOR
Figure 8.4 illustrates nonideal quadrature modulator, which shows the sources of 
imperfections inherent in the RF circuitry as well as the DC offsets that can exist 
at the output of DACs. Nonideal quadrature modulator also includes the low-pass 
filters to reject aliasing effect of digitally generating the signals. These filters have 
some frequency-dependent loss and phase shift, which are not necessarily the same 
for both I and Q channels. In the model, this is shown as 
( )
ω
GFLI
 and 
( )
φ
ω
FLI
 for the 
I channel and 
( )
ω
GFLQ
 and 
( )
φ
ω
FLQ
 for the Q channel.
The LO input to the Q mixer is required to be phase shifted by −90°. In most 
cases, this is accomplished by using a polyphase filter. Another technique that uses 
a divide-by-two flip-flop achieves better results but requires the LO to be twice the 
desired frequency [20]. However, in both cases, the phase shift is not exactly −90° 
and is also frequency dependent. This imperfection is accounted for the model by 
( )
φ
ω
FLQ
.
Another source of imbalance occurs in the mixing and summing process. I and Q 
mixers do not have exactly the same conversion loss and phase properties. The RF 
summing process, which is essentially an RF power combiner, is also not perfectly 
Σ
Q = ±sin(ωBBt) + DCq
cos(ωLOt)
Sout
I = cos(ωBBt) + DCi
I2
I1
Q1
ΦFLI(ω)
GFLI(ω)
ΦFLQ(ω)
GFLQ(ω)
ΦLO(ω)
ΦΣI(ω)
GΣI(ω)
ΦΣI(ω)
GΣI(ω)
Gain/loss
Phase shift
Q2
Imperfect summer
Quadrature modulator
I3
Q3
–90
FIGURE 8.4  Nonideal quadrature modulator.
www.ebook3000.com

327
Distortion and Modulation Effects in RF Power Amplifiers
balanced in amplitude and phase. Therefore, there is a certain amount of gain/loss 
and phase shift, which occurs during the mixing and summing processes, which 
is different between the I and Q paths. This is represented in our model by assum-
ing the two mixers and the summer to be ideal, and then including the amplitude 
responses, 
( )
ω
Σ
G I
 and 
( )
ω
Σ
G Q
, and phase responses, 
( )
φ
ω
ΣI
 and 
( )
φ
ω
ΣQ
, to account 
for the errors in both processes.
Finally, there is the effect of the DC offsets, which give rise to carrier leakage at 
the output. These DC offsets are the result of a mismatch of the internal transistors 
of the quadrature modulator. These DC offsets are included by adding the DC terms 
DCi and DCq to the I and Q channel inputs, respectively.
Using vectors to represent signals is a useful way to visualize the effect of the RF 
impairments on quadrature modulator performance. Signals can be represented as 
vectors with a magnitude and phase. Because these vectors will have different fre-
quencies, a third dimension is added to represent frequency. Signals pertaining to the 
I path and Q paths are illustrated in figures with designations. For instance, the I and 
Q input signals that are used in the modulator are shown in Figure 8.5.
8.3.1  I Path
In the nonideal quadrature modulator shown in Figure 8.4, I signal undergoes a 
phase and amplitude shift through the low-pass filter. This phase shift is, of course, 
dependent on the baseband frequency of the sinusoid, because the response of the 
filter is frequency dependent. The DC offset has no phase; so it remains unchanged. 
The signal can then be expressed as
	
(
)
=
ω
⋅
ω
−ϕ
ω
+
I
G
t
DC
(
) cos
(
)
1
FLI
BB
BB
FLI
BB
i 	
(8.5)
Signal given in Equation 8.5 can be represented by a vector as shown in Figure 8.6. 
Mixing I1 with the LO to obtain the up-converted signal I2  gives
	
(
)
=
ω
⋅
ω
+ φ
ω
+

⋅
ω
I
G
t
DC
t
(
) cos
(
)
cos(
)
2
FLI
BB
BB
FLI
BB
i
LO
	
(8.6)
ω
Re
Im
ωbb
I
Q
DCi
DCq
–90
FIGURE 8.5  Vector representation of I and Q signals.

328
Linear and Switch-Mode RF Power Amplifiers
which can be rewritten as
	
I
G
t
t
DC
t
(
)
2
cos
(
)
cos
(
)
cos(
)
2
FLI
BB
U
FLI
BB
L
FLI
BB
i
LO
(
)
(
)
=
ω
ω
+ φ
ω
+
ω
−φ
ω


+
⋅
ω
	
(8.7)
where
	
ω = ω
+ω
U
BB
LO 	
(8.8)
	
ω = ω
−ω
L
BB
LO 	
(8.9)
Vector representation of I2 is given in Figure 8.7. As described earlier, the summing 
operation is also imperfect; so it has been represented with some gain and phase 
shift added. There are three frequency components—each with its own phase shift. 
Therefore, I3 can be expressed as
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
ω
⋅
ω
⋅
ω
+ φ
ω
+ φ
ω
+
ω
⋅
ω
−φ
ω
+ φ
ω
+
⋅
ω
ω
+ φ
ω














Σ
Σ
Σ
Σ
Σ
Σ
I
G
G
t
G
t
DC G
t
2
cos
(
)
(
)
cos
(
)
(
)
cos
(
)
I
I
I
I
I
I
3
FLI
BB
U
U
FLI
BB
U
L
L
FLI
BB
L
i
LO
LO
LO
	
(8.10)
I3 can be set in the following form:
	
(
)
(
)
(
)
=
⋅
ω
+ φ
+
⋅
ω
+ φ
+
⋅
ω
+ φ
I
G
t
G
t
G
t
cos
cos
cos
3
IU
U
IU
IL
L
IL
LOI
LO
LOI 	 (8.11)
DCi
GFLI (ωBB)
φFLI (ωBB)
Re
Im
ωBB
ω
FIGURE 8.6  Vector representation of I1.
www.ebook3000.com

329
Distortion and Modulation Effects in RF Power Amplifiers
where
	
(
)
(
)
φ
= φ
ω
+ φ
ω
ΣI
IU
FLI
BB
U 	
(8.12)
	
(
)
(
)
φ
= φ
ω
−φ
ω
ΣI
IL
L
FLI
BB 	
(8.13)
	
(
)
(
)
=
ω
⋅
ω
Σ
G
G
G
2
I
IU
FLI
BB
U
	
(8.14)
	
(
)
(
)
=
ω
⋅
ω
Σ
G
G
G
2
I
IL
FLI
BB
L 	
(8.15)
	
(
)
=
ω
Σ
G
G
DC
I
LOI
LO
i 	
(8.16)
and
	
(
)
φ
= φ
ω
ΣI
LOI
LO 	
(8.17)
The vector representation of I3 is given in Figure 8.8.
8.3.2  Q Path
The derivation of the Q signal is identical to the I path signal except that the input 
signal is now a sine rather than a cosine function. For the sake of derivation, we 
will consider the case where 
= +
ω
Q
t
sin(
)
BB
, which would tend to cancel the upper 
sideband. There is no loss in generality, since we know that by changing the sign of 
Q, we can cancel the lower sideband instead. As with the I path, the input Q signal 
undergoes phase and amplitude shifts through the low-pass DAC filter and can be 
expressed as
	
(
)
=
ω
⋅
ω
−φ
ω
+
Q
G
t
DC
(
) sin
(
)
1
FLQ
BB
BB
FLQ
BB
q 	
(8.18)
ω
Im
ωL
Re
φFLI(ωBB)
ωU
φFLI(ωBB)
2
1GFLI(ωBB)
ωLO
DCi
FIGURE 8.7  Vector representation of I2.

330
Linear and Switch-Mode RF Power Amplifiers
Q1 can be illustrated in vector form as shown in Figure 8.9. In the LO path, there is a 
90° phase shifter as shown in Figure 8.4. However, this phase shift is imperfect, and 
as a result, an unknown phase error is added, thereby making it a sine wave at the Q 
mixer with an added phase term φLO. We mix this signal with Q1 and obtain
	
(
)
(
)
=
ω
⋅
ω
−φ
ω
+

⋅
ω
+ φ
ω
Q
G
t
DC
t
(
) sin
(
)
sin
(
)
2
FLQ
BB
BB
FLQ
BB
q
LO
LO
LO
	 (8.19)
Equation 8.19 can be expressed as
	
Q
G
t
t
DC
t
(
)
2
cos
(
)
(
)
cos
(
)
(
)
sin(
(
))
2
FLQ
BB
L
FLQ
BB
LO
LO
u
FLQ
BB
LO
LO
q
LO
LO
LO
(
)
(
)
=
ω
ω
−φ
ω
−φ
ω
−
ω
−φ
ω
+ φ
ω








+
⋅
ω
+ φ
ω
	
(8.20)
GIL
Re
Im
φIL
φLOI
ωL
ωLO 
ωU
ω
φIU
GLOI
GIU
FIGURE 8.8  Vector representation of I3.
ω
Im
ωBB
Re
φFLQ(ωBB)
GFLQ(ωBB)
DCQ
FIGURE 8.9  Vector representation of Q1.
www.ebook3000.com

331
Distortion and Modulation Effects in RF Power Amplifiers
where ωU and ωL are given by Equations 8.8 and 8.9. Q2 is shown in Figure 8.10 in 
vector form. When the imperfections in the summation are taken into account as it 
was done for in phase path, Q3 can be expressed as
(
)
(
)
(
)
(
)
(
)
(
)
(
)
=
ω
⋅
ω
⋅
ω
−φ
ω
−φ
ω
+ φ
ω
−
ω
⋅
ω
−φ
ω
+ φ
ω
+ φ
ω
+
⋅
ω
ω
+ φ
ω














Σ
Σ
Σ
Σ
Σ
Q
G
G
t
G
t
DC
G
t
2
cos
(
)
(
)
(
)
cos
(
)
(
)
(
)
sin
(
)
Q
Q
Q
Q
Q
3
FLQ
BB
L
L
FLQ
BB
LO
LO
L
U
U
FLQ
BB
LO
LO
U
q
LO
LO
LO
LO
	
(8.21)
Equation 8.21 can be simplified to
	
Q
G
t
G
t
G
t
cos
cos
sin
3
QL
L
QL
QU
U
QU
LOQ
LO
LOQ
(
)
(
)
(
)
=
⋅
ω
+ φ
−
⋅
ω
+ φ
+
⋅
ω
+ φ
	
(8.22)
with the following relations:
	
(
)
(
)
(
)
φ
= φ
ω
−φ
ω
−φ
ω
ΣQ
QL
L
FLQ
BB
LO
LO 	
(8.23)
	
(
)
(
)
(
)
φ
= φ
ω
−φ
ω
+ φ
ω
ΣQ
QU
U
FLQ
BB
LO
LO 	
(8.24)
	
(
)
(
)
=
ω
⋅
ω
Σ
G
G
G
2
Q
QU
FLQ
BB
U 	
(8.25)
	
(
)
(
)
=
ω
⋅
ω
Σ
G
G
G
2
Q
QL
FLQ
BB
L 	
(8.26)
	
(
)
=
ω
Σ
G
G
DC
Q
LOQ
LO
q 	
(8.27)
and
DCq
ωL
ω
ωLO
Re
Im
ωU
1
2 GFLI(ωBB)
1
2 GFLI(ωBB)
–φFLQ+ φLO
–φFLQ + φLO
FIGURE 8.10  Vector representation of Q2.

332
Linear and Switch-Mode RF Power Amplifiers
	
(
)
φ
= φ
ω
LOQ
LO
LO 	
(8.28)
Q3  can be depicted as shown in Figure 8.11 in vector form.
8.3.3  Output of Nonideal Quadrature Modulator
We now have an expression for the effective I and Q channel signals, including all 
the imperfections before summation. There are three frequency components on each 
path that have undergone unknown amplitude and phase shifts and, therefore, sig-
nificantly degrade the image rejection performance of the system. The summation 
operation gives Sout as
	
(
)
(
)
(
)
(
)
(
)
(
)
+
=
⋅
ω
+ φ
+
⋅
ω
+ φ
+
⋅
ω
+ φ
+
⋅
ω
+ φ
−
⋅
ω
+ φ
+
⋅
ω
+ φ
I
Q
G
t
G
t
G
t
G
t
G
t
G
t
cos
cos
cos
       
cos
cos
sin
3
3
IU
U
IU
IL
L
IL
LOI
LO
LOI
QL
L
QL
QU
U
QU
LOQ
LO
LOQ

(8.29)
There are six sinusoidal terms, but only three frequency components—the upper 
sideband, the lower sideband, and the LO component. We define output signal as
	
=
−
=
+
S
S
RF
IM
LO
RF
out
out
	
(8.30)
where
	
(
)
(
)
=
⋅
ω
+ φ
+
⋅
ω
+ φ
RF
G
t
G
t
cos
cos
IL
L
IL
QL
L
QL 	
(8.31)
	
(
)
(
)
=
⋅
ω
+ φ
+
⋅
ω
+ φ
IM
G
t
G
t
cos
cos
IU
U
IU
QU
U
QU 	
(8.32)
The composite signal Sout is the output signal, and it contains both the desired RF 
component and the undesired image as illustrated in Figure 8.12. In order to get 
ideal image rejection from a nonideal quad modulator, the phase and amplitude of 
Re
Im
GQL
GLOQ
φQL
ωL
ωLO
φQU
ωU
ω
φLOQ
GQU
FIGURE 8.11  Vector representation of Q3.
www.ebook3000.com

333
Distortion and Modulation Effects in RF Power Amplifiers
the input signals (I and Q) need to be adjusted such that the image vectors at the 
summed output completely cancel. This requires knowledge of the gain and phase 
responses of the I and Q channels separately. Furthermore, the degree of accuracy is 
specifically crucial for the phase.
One of the challenges of improving the image rejection performance is the fact 
that the I and Q components are inseparable at the output. There have been some 
innovative calibration methods developed, which measure the power level of the 
undesired signal as the baseband signals are adjusted to minimize these unwanted 
components.
Methods such as the ones in Reference. [21] make use of only the magnitude 
information of the output signal and require an iterative algorithm to arrive at the 
nominal correction factors, which are impractical.
8.4  IMPROVED METHOD FOR IMAGE BAND REJECTION
In the proposed system [19], a sample of the RF output of the quadrature modulator 
is mixed with a signal at the image frequency, which is phase-locked with the test 
signal, thus converting the image component directly to DC. The I and Q paths are 
then excited separately with a CW tone whose phase is swept from 0 to 2π radians. 
The resulting DC output is a sinusoidal function with respect to the swept phase 
of the exciting tone. This sinusoid has amplitude and phase related to the errors 
imposed in each path. The I and Q test signals are then compared to each other to 
obtain the correction factors. The simplified block diagram of the proposed system 
accomplishing the image band rejection is illustrated in Figure 8.13.
Let us consider the case where we wish to null the upper sideband in a quadrature 
mixer. In this case, we call the upper sideband the image signal and the lower side-
band the desired signal. For the first measurement, only I path is excited as shown 
in Figure 8.14. Because there is no Q signal, there is also no quadrature nulling; 
Re
Im
GQL
φIL
φQL
φIU
φQU
ωL
ωU
ω
GQU
GIL
GIU
FIGURE 8.12  Vector representation of Sout.

334
Linear and Switch-Mode RF Power Amplifiers
therefore, both the desired and image signals are present at the output of the quadra-
ture modulator. The output of the system is sampled through a coupler and fed into 
the RF port of a mixer. The signal at the LO port of the mixer is of the same fre-
quency as the image, thus mixing the image down to DC. A very low-frequency low-
pass filter is used at the IF port of the mixer to reject all frequencies except the DC 
component, which is now a representation of the image signal that we are attempting 
to null. This can be illustrated using vector signals in Figure 8.15.
When two signals of identical frequencies are applied to a mixer, it produces a 
DC component at the output, which has a sinusoidal relationship to the phase dif-
ference of the two signals as shown in Figure 8.16. This, in essence, corresponds to 
Σ
Q
Sout
V(θ)
fc < 10 Hz
I
LO
Smix
–90
FIGURE 8.13  Block diagram of image band rejection system.
Σ
90
I = cos(ωBBt + θ)
Q = 0
cos(ωLOt)
Vi(θ)
Smix = cos(ωLOt + ωBBt + θLO)
SRF = α1·cos(ωLOt + ωBBt + φ1)
+ α2·cos(ωLOt–ωBBt + φ2)
fc < 10 Hz
fc = ωBB
fc = ωBB
R
I
L
FIGURE 8.14  Image band rejection method with I path test signal measurement.
www.ebook3000.com

335
Distortion and Modulation Effects in RF Power Amplifiers
using mixer as a phase detector. DC component produced at the output of the mixer 
depends on magnitudes and relative phase of two sinusoids. In the proposed system, 
the sum product will be filtered off; so the DC component is the wanted product. 
Therefore, the resulting DC component seen at IF port is a function of both the phase 
and magnitude of the driving signals. As the phase of one of signal is swept, the 
resulting DC values at the IF port will trace out a sinusoid as shown in Figure 8.17.
ω
SRF
ωupper
ωlower
ω
Vi(θ)
Down converted ωupper
Down converted ωlower
(filtered off)
FIGURE 8.15  SRF and Vi(q) signals with I path measurement.
LR I
VL = α1cos(ω + φ1)
VR = α2cos(ω + φ2)
VI = A(α1,α2)cos(Δφ + π)
FIGURE 8.16  Using mixer as phase detector.
A
0
0
180
270
380
90
-A
VI
VI of ideal mixer
∆φ [  ]
FIGURE 8.17  Vi at the output of a theoretical mixer.

336
Linear and Switch-Mode RF Power Amplifiers
It can be seen from Figure 8.14 that by incrementally adjusting the phase q of the 
I signal from 0 to 2p and recording DC output, Vi(q), of the mixer, the resulting sig-
nal is a cosine function with a phase fI that is related to the overall change of phase 
through the I path of the quadrature modulator, and an amplitude aI is related to the 
magnitude of the I component at the output.
There is an unavoidable DC offset, which arises from the real mixer itself [35]. 
This is accounted for by the DCI term. An extra phase term fOffset is added as well to 
account for the phase imperfections in the mixer [36]. Because the phase of the LO 
is unknown, it must also be included. As a result, the resultant signal Vi(q) can be 
expressed as
	
( )
(
)
θ = α
θ+ φ + φ
−θ
+ π +
V
DC
cos
i
I
I
Offset
LOi
I 	
(8.33)
For the Q path, this process is repeated by keeping I path inactive and exciting 
only the Q path with a sinusoid in quadrature with the first test signal as shown in 
Figure 8.18.
The recorded set of DC values Vq(q) is a sinusoid similar to that of the I path; 
however, it has a different phase fQ and amplitude aQ that is related to Q component 
at the output of the quadrature modulator with DC offset DCI and phase offset fOffset 
resulting from imperfections in the mixer. Vq(q) can then be expressed as
	
(
)
( )
θ = α
θ+ φ + φ
−θ
+ π +
V
DC
cos
q
Q
Q
Offset
LOq
Q 	
(8.34)
Because we are using the same LO for both the I and Q signals, the variation in the 
DC offset will only be affected by the signal present at the RF port. Therefore, DC 
offsets can easily be removed by subtracting the average from each signal given in 
Equations 8.33 and 8.34 as
	
( )
(
)
θ = α
θ+ φ + φ
−θ
+ π
V
cos
i
I
I
Offset
LOi
	
(8.35)
Σ
90
Q = –sin(ωBBt + θ)
I = 0
cos(ωLOt)
Vq(θ)
Smix = cos(ωLOt + ωBBt + θLO)
SRF = α3·cos(ωLOt + ωBBt + φ3)
+ α4·cos(ωLOt–ωBBt + φ4)
fc < 10 Hz
fc = ωBB
fc = ωBB
R
I
L
FIGURE 8.18  Image band rejection method with Q path test signal measurement.
www.ebook3000.com

337
Distortion and Modulation Effects in RF Power Amplifiers
	
(
)
( )
θ = α
θ+ φ + φ
−θ
+ π
V
cos
q
Q
Q
Offset
LOq
	
(8.36)
As explained earlier, there is also a phase offset induced by the mixer. The effect of 
this phase offset is that the null at the output of the mixer occurs at some relative 
phase other than exactly p/2. This phase shift results from the fact that the elec-
trical lengths from L-port to I-port and from R-port to I-port could be different. 
Sometimes, this is done on purpose to match the ports to 50 Ω. Because the I and 
Q test signals are identical in frequency, the phase offsets introduced by the mixer 
will also be identical for both the I and Q measurements. This is because the rela-
tive phase and amplitude differences between I and Q paths are of interest, and this 
allows us to simplify Equations 8.35 and 8.36 to
	
( )
(
)
θ = α
θ+ φ −θ
+ π
V
cos
i
I
I
LOi
	
(8.37)
	
(
)
( )
θ = α
θ+ φ −θ
+ π
V
cos
q
Q
Q
LOq
	
(8.38)
Further simplification of the Equations 8.37 and 8.38 is possible by defining the fol-
lowing equations:
	
∆φ = φ −θ
+ π
I
I
LOi
	
(8.39)
	
∆φ = φ −θ
+ π
Q
Q
LOq
	
(8.40)
So, Equations 8.37 and 8.38 can be expressed as
	
( )
(
)
θ = α
θ+ ∆φ
V
cos
i
I
I 	
(8.41)
	
( )
(
)
θ = α
θ+ ∆φ
V
cos
q
Q
Q 	
(8.42)
In order to properly balance the quadrature modulator, the amplitudes and phases of 
Vi and Vq must be equal. This can be accomplished by only predistorting one of the 
channels. When Q channel is predistorted, we can define the amplitude and phase 
correction factors for the Q path as
	
α
= α
α
corr
I
Q
	
(8.43)
	
φ
= ∆φ −∆φ
corr
I
Q 	
(8.44)
The correction factors are then applied to the transmission signal as follows:
	
(
)
=
ω
I
t
cos
BB
	
(8.45)
	
(
)
= α
ω
−φ
Q
t
sin
corr
BB
corr 	
(8.46)

338
Linear and Switch-Mode RF Power Amplifiers
8.4.1  LO Cancellation
In this section, the method for canceling the LO leakage in a quadrature modulator 
is proposed. For the clarity of the analytical derivation, we consider only the LO 
components in the system. As described previously, DC offsets are added to the I 
and Q paths to cancel the offsets that exist to create the LO leakage. The goal of the 
system is to find the correct DC offset for each channel. The LO cancellation system 
shown in Figure 8.19 is similar to the one proposed for the image cancellation sys-
tem by down-converting the undesired signal to DC. By incrementally changing the 
phase on Smix from 0 to 2π radians and monitoring the resulting DC output at VLO, a 
relative measure of the phase and magnitude of the LO signal can be obtained. The 
process of using a mixer as a phase detector has already been discussed in the previ-
ous section in detail. The offsets that are desired to be cancelled are represented by 
DCi and DCq, and the factors ∆Iand ∆Q are added to accomplish this. The goal is to 
determine the values of these correction factors.
The system in Figure 8.19 can be mathematically modeled in a slightly different 
manner. Because all of the signals in the system are phase-locked, it is assumed 
that the time-varying aspect of the sinusoids in the system can be ignored. From the 
analysis conducted in Section 8.3 for an unbalanced quadrature modulator, the LO 
components at the output were found to be
	
(
)
(
)
=
⋅
ω
+ φ
+
⋅
ω
+ φ
G
t
G
t
LO
sin
cos
E
out
LOQ
LO
LOI
LO
LOI 	
(8.47)
The expression can be simplified by defining
	
(
)
=
ω
∑
G
G
DC ,
I
LOI
LO
i 	
(8.48a)
90
DCq
cos(ωLOt)
V(θ)
Smix = cos(ωLOt + θLO)
fc < 10 Hz
fc = ωBB
fc = ωBB
R
I
L
DCi
∑
∑
∑
ΔQ
ΔI
FIGURE 8.19  Quadrature modulator LO cancellation system.
www.ebook3000.com

339
Distortion and Modulation Effects in RF Power Amplifiers
and
	
(
)
=
ω
∑
G
G
DC .
Q
LOQ
LO
q 	
(8.48b)
Then, Equation 8.47 can be expressed as
(
)
(
)
(
)
(
)
=
ω
⋅
ω
+ φ
+
ω
⋅
ω
+ φ
∑
∑
G
DC
t
G
DC
t
LO
sin
cos
Q
I
LO
out
LO
q
LO
LOQ
i
LO
LOI 	 (8.49)
In Figure 8.19, the terms denoted by ∆Iand ∆Q are the correction factors added to 
cancel DCi and DCq. Then, Equation 8.49 can be modified to include these correc-
tion factors as
	
LO
DC
I G
t
DC
Q G
t
cos
            
sin
I
Q
out
i
LO
LO
LOI
q
LO
LO
LOQ
(
)
(
)
(
)
(
)
(
)
(
)
=
+ ∆
ω
⋅
ω
+ φ
+
+ ∆
ω
⋅
ω
+ φ
∑
∑
	
(8.50)
Equation 8.50 can be put into vector representation as
[
]
[
]
[
]
[
]








=






+





∆+
−






+
−





∆
LO
LO
R
DC
R
I
R
DC
R
Q
1
0
1
0
0
1
0
1
x
y
I
i
I
Q
q
Q

(8.51)
where
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
[
] =
ω
⋅
φ
−
ω
⋅
φ
ω
⋅
φ
ω
⋅
φ








∑
∑
∑
∑
R
G
G
G
G
cos
sin
sin
cos
I
I
I
I
I
LO
LOI
LO
LOI
LO
LOI
LO
LOI
	
(8.52)
	
(
)
(
)
(
)
(
)
(
)
(
)
(
)
(
)
[
] =
ω
⋅
φ
−
ω
⋅
φ
ω
⋅
φ
ω
⋅
φ








∑
∑
∑
∑
R
G
G
G
G
cos
sin
sin
cos
Q
Q
Q
Q
LO
Q
LO
LOQ
LO
LOQ
LO
LOQ
LOQ
	
(8.53)
The expression for LO component at the output of the quadrature modulator given 
in Equation 8.51 includes all of the RF impairments and offset corrections applied 
to the circuit.
As described in the image cancellation process, the output signal is down-
converted directly to DC. This process allows us to low-pass filter all other compo-
nents of the output signal and observe only the LO leakage. By sweeping the phase 
of Smix from 0 to 2π and measuring the resulting DC output of the mixer with respect 
to the phase of Smix, we are using the mixer as a phase and magnitude detector as 
illustrated in Figure 8.19.
There is some relative phase and amplitude error in down-conversion process 
when physical devices are used. However, this error can also be modeled as a simple 
rotation matrix [M] as shown in Figure 8.20. We can now define our signal V as

340
Linear and Switch-Mode RF Power Amplifiers
	
[
] [
]
[
]
[
]
[
]








=






+





∆+
−






+
−





∆






V
V
M
R
DC
R
I
R
DC
R
Q
1
0
1
0
0
1
0
1
x
y
I
i
I
Q
q
Q

(8.54)
We define the following terms to simplify Equation 8.54 as
	
[
][
]
[ ]
=
M
R
A
I
	
(8.55a)
and
	
[
][
]
[ ]
=
M
R
B
Q
	
(8.55b)
Then, Equation 8.54 can be expressed as
	
(
)
(
)
[ ]
[ ]








=






+ ∆
+
−






+ ∆
V
V
A
DC
I
B
DC
Q
1
0
0
1
x
y
i
q
	
(8.56)
The simplified Equation 8.56 can be modeled as shown in Figure 8.21.
In the system shown in Figure 8.21, we have control only over ΔI and ΔQ, because 
these are the values we are using to null the LO leakage. In addition, because we are 
measuring the output of our system, Vx and Vy are known as well. However, the 
matrices [ ]
A  and [ ]
B , or the scalars DCi and DCq are unknowns. The unknown 
∑
DCq
DCi 
∑
ΔQ
ΔI
1
0
0
–1
–1
RI
RQ
RI
1
0
∑
0
M
Vx
Vy
Down conversion
I path
Q path
RQ
FIGURE 8.20  Linear algebraic model for LO cancellation system.
www.ebook3000.com

341
Distortion and Modulation Effects in RF Power Amplifiers
terms can be determined using the rotational matrices [ ]
A  and [ ]
B  and solving the 
relation given in Equation 8.56, which is set in the following form:
(
)
(
)








=
−














+ ∆
+
−








−






+ ∆
V
V
a
a
a
a
DC
I
b
b
b
b
DC
Q
1
0
0
1
x
y
11
12
12
11
i
11
12
12
11
q

(8.57)
The Equation 8.57 is a system of two equations with six unknowns, where a mini-
mum of three measurements is needed to solve for all of the unknowns. This is 
shown by
	
=
+
∆+
+
∆
V
a DC
a
I
b DC
b
Q
x
11
i
11
12
q
12
	
(8.58)
	
=
+
∆−
−
∆
V
a DC
a
I
b DC
b
Q
y
12
i
12
11
11
	
(8.59)
The unknown terms are derived by solving Equations 8.58 and 8.59 and are 
obtained as
	
=
+
+
DC
b K
b K
a b
a b
y
x
i
12
11
11 11
12 12
	
(8.60)
	
=
−
+
DC
a K
a K
a b
a b
x
y
q
12
11
11 11
12 12
	
(8.61)
where
	
=
−
∆
−∆
a
V
V
I
I
x
x
11
1
2
1
2
	
(8.62a)
	
=
−
∆
−∆
a
V
V
I
I
y
y
12
1
2
1
2
	
(8.62b)
∑
1
0
A
B
Vx
Vy
0
–1
DCq + ΔQ
DCi + ΔI
FIGURE 8.21  Simplified mathematical model of LO cancellation system.

342
Linear and Switch-Mode RF Power Amplifiers
	
=
−
∆
−∆
b
V
V
Q
Q
y
y
11
1
3
2
1
	
(8.62c)
	
=
−
∆
−∆
b
V
V
Q
Q
x
x
12
1
3
1
2
	
(8.62d)
and
	
=
−
∆−
∆
K
V
a
I
b
Q
x
x
11
12
	
(8.63a)
	
=
−
∆+
∆
K
V
a
I
b
Q
y
y
12
11
	
(8.63b)
LO leakage can now be cancelled by setting ∆= −
I
DCi  and ∆
= −
Q
DCq  in LO 
cancellation system shown in Figure 8.19.
8.4.2  Simulation Results
Simulation is performed using Agilent’s ADS software with harmonic balance simu-
lation to validate the proposed method. A model for the quadrature modulator, includ-
ing the RF imperfections discussed, is created in ADS as shown in Figure 8.22.
8.4.2.1  Simulation Model
Phase and gain imbalances were added to the I and Q channels in order to show 
degraded image rejection. DC offsets were also added into I and Q paths, which 
create the LO leakage. The values of these imbalances are typical for quadrature 
modulators in the market today.
FIGURE 8.22  Simulation model of an unbalanced quadrature modulator in ADS.
www.ebook3000.com

343
Distortion and Modulation Effects in RF Power Amplifiers
The input signal for the I channel is a CW tone at 10 MHz with a phase of 0° 
(cosine), and the Q input signal is a CW tone at the same frequency, which is shifted 
by −90° (sine). The LO source has a frequency of 500 MHz with 0° phase. Because the 
Q signal is a positive sine function, the quadrature modulator is configured to cancel 
the upper sideband (510 MHz). The desired RF signal is the lower sideband (490 MHz). 
For simplicity, all imbalances were added to the Q side. Adding imbalances to only 
one side is valid since the image rejection depends only on the relative imbalance 
between the two channels. The nominal 90° LO phase shifter for the Q channel has 
0.5° of phase error. There is also another 0.2° of phase error added to the Q side before 
RF combiner to simulate the phase error in the summing circuit. An amplitude imbal-
ance of 1.1 is also added to the Q side as variable A. For the LO leakage, 10 mV of DC 
offset is added to the I channel and 30 mV of DC offset is added to the Q channel. The 
imbalances and DC offsets added into this simulation are typical of most commercial 
quadrature modulators available for designers in the market as mentioned earlier. For 
this reason, measurements are normally taken to improve this performance by pre-
distorting the input signals to account for these imbalances and offsets. This can be 
accomplished by a calibration process where the spectrum is monitored as the phases, 
amplitudes, and DC offsets are manipulated to obtain the best result.
This lengthy process is performed at many frequencies and temperatures depend-
ing on the application. The ability to null the image and LO is dependent on the pro-
cess of using a mixer as a phase detector. This process was modeled and simulated 
in ADS as illustrated in Figure 8.23.
FIGURE 8.23  Simulation model of mixer as phase detector using ADS.

344
Linear and Switch-Mode RF Power Amplifiers
Two identical frequencies are applied to the LO and RF ports of a mixer in 
Figure 8.23. The signal at the RF port has a phase shift of 30°. The phase of the LO 
signal is swept from 0° to 360° in 1° increments. The amplitude of the RF signal is 
also swept from 0.8 to 1.2 V in 0.1 V increments. Because the mixer model in ADS 
does not include the DC offset that a physical mixer would have, an external DC 
offset of 2.5 V was applied to the output of the mixer through a voltage-controlled 
voltage source. When the phase of one of the input signals is swept and the DC out-
put of the mixer versus phase is charted, the relative phase of the other input signal 
can be determined.
In addition, the magnitude of the resulting sinusoid is a function of the magnitude 
of the RF input signal. Furthermore, the inherent DC offset can be determined by 
simply taking the average value across all phases.
The simulation of the image cancellation system is a version of the unbalanced 
quadrature modulator simulation shown in Figure 8.22. There are two identical 
circuits—one of them simulates I test signal and the other simulates the Q test signal. 
The imbalances added into both circuits are identical to the unbalanced quadrature 
modulator simulation. The simulator sweeps the phases of both input signals from 
0° to 360° in 0.1° increments. In both cases, the DC output of the mixer is captured 
in the same manner as described in the Section 8.4.2.1 where the mixer as a phase 
FIGURE 8.24  Simulation model for image cancellation system—I test signal.
www.ebook3000.com

345
Distortion and Modulation Effects in RF Power Amplifiers
detector was simulated. In addition, different DC offsets were applied to each of 
the output mixers in order to simulate the DC offset of a real mixer. The simulation 
models for image cancellation using I test signal and Q test signal are illustrated in 
Figures 8.24 and 8.25, respectively.
8.4.2.2  Simulation Results
The simulation results of an unbalanced quadrature modulator shown in Figure 8.22 
have the significant LO leakage and image signal present at the output without the 
implementation of the proposed method as illustrated Figure 8.26. The simulation 
setup used by ADS is illustrated in Table 8.1.
The harmonic balance simulator produces data for all product frequencies speci-
fied by the user in the simulation setup. In our case, there are two identical frequen-
cies mixing together to produce DC, twice the frequency, three times the frequency, 
and so on. Since it is assumed that a low-pass filter will be used to strip off all com-
ponents except for DC, the simulation results show only the DC component.
As can be seen from Figure 8.27, the DC output of the mixer, which is function-
ing as a phase detector using the model shown in Figure 8.23, is a cosine function 
FIGURE 8.25  Simulation model for image cancellation system—Q test signal.

346
Linear and Switch-Mode RF Power Amplifiers
with respect to the swept phase variable of the test signal. Each trace corresponds to 
a separate input power of the test signal. The simulation results show that the output 
magnitude of the resulting sinusoid is a function of the test signal input power.
By taking the maximum point on each trace shown in Figure 8.27, the phase of 
the output signal is determined. This cosine has a phase of 210°, and since we know 
from Figure 8.16 that the relative phase of the two signals can be determined by 
subtracting π radians from this cosine function, it has been successfully determined 
that the input signal’s phase is 30°. To prove that the DC offset can be removed, an 
average of each trace was taken and compared with the DC offset of 2.5 V applied in 
the simulation. In each case, the DC offset was determined to be 2.5 V.
30
20
10
0
–10
–20
–30
–40
–50
–60
–70
–80
–90
–100
450 460
470
480
490
500 510 520
530
540
550
m1
freq = 490.0MHz
dBm(HB. Vout 1) = 10.380
m2
ind delta = 1.000e7
dep delta = –29.599
delta mode ON
m3
ind delta = 2.000e7
dep delta = –26.373
delta mode ON
Unbalanced quadrature modulator
m1
m2
m3
Freq [MHz]
dBm [Vout1]
FIGURE 8.26  Unbalanced quadrature modulator simulation results.
TABLE 8.1
Simulation Setup for Image Cancellation System
Harmonic balance simulation: Tis simulation sweeps the phase of each test signal from 0 to 360 degrees
in 0.1 degree increments
HARMONIC BALANCE
HarmonicBalance
HB1
Freq[1]=fbb MHz
Freq[2]=ﬂo MHz
Order[1]=3
Order[2]=3
VAR1
fbb=10
phi=0
a=1
phi_ref=0
ﬂo=500
VAR
VAR
VAR
VAR
VAR
VAR5
phi_step=0.1
phi_start=1
phi_stop=360
ParamSweep
Sweep1
SweepVar=“phi”
SimInstanceName[1]=“HB1”
SimInstanceName[2]=
SimInstanceName[3]=
SimInstanceName[4]=
SimInstanceName[5]=
SimInstanceName[6]=
Start=phi_start
Stop=phi_stop
Step=phi_step
SweepPlan
SwpPlan1
Start=phi_start Stop=phi_stop Step=phi_step Lin= 
UseSweepPlan= 
SweepPlan= 
Reverse=no
DC oﬀsets added into the output mixer.
Simulates a real mirror with unknown DC oﬀset.
Imbalances added into both Quad Mod Circuits
VAR2
phi_err=0.5
phi_err1=0.2
phi_err2=10
A=1.1
VAR6
G1=(R2+25)/25
R2=10000
VAR7
DCoﬀesetlmix=2.5
DCoﬀesetQmix=2.7
SWEEP PLAN
PARAMETER SWEEP
www.ebook3000.com

347
Distortion and Modulation Effects in RF Power Amplifiers
The DC output of the mixers are captured as Vi and Vq for the I and Q test simula-
tions, respectively, as shown in Figure 8.28. The phase of each test signal was found 
by simply finding the value of the phase variable at the maximum of each trace. The 
magnitudes of the test signals were found by the following formula:
	
(
)
{
}
{
}
=
−
V
V
mag
max
min
2
i,q
i,q
i,q
	
(8.64)
For the first set of data, the DC offset was left in the calculations. Gain and phase 
correction factors were found by Equations 8.43 and 8.44.
For the second set of data, the DC offset was removed by taking the average 
value of both traces. All other values were calculated in the exact same manner as 
described earlier. The simulation results for this case are shown in Figure 8.29.
In both cases, DC offset included and DC offset removed, identical correction 
factors were obtained. The obtained values agree with the amount of error added 
to the simulation; for instance, the correction was 0.7°. This agrees with the 0.5° 
added to the LO phase shifter plus the 0.2° added to the summing block. The gain 
5.0
4.5
4.0
3.5
3.0
2.5
2.0
1.5
1.0
0.5
0.0
Mag(vout1[ : : ,]0)
0
50
100
150
200
250
300
350
400
Vout vs phase of LO
Swept phase variable in degrees
Markers placed at max points
of every trace
notice that all of the
markers is at 210 degrees.
210–180 = 30 degrees
Notice average vout
is equal to DC oﬀset
a
Vout_avg
0.800
0.900
1.000
1.100
1.200
2.496
2.496
2.495
2.495
2.494
m1
m2
m3
m4
m5
m1
indep (m 1) = 210.000
plot_vs(mag(vout 1[: :,0]), phi) = 4.888
a = 1.200000
max
m2
indep (m 2) = 210.000
plot_vs(mag(vout 1[: :,0]), phi) = 4.889
a = 1.100000
max
m3
indep (m 3) = 210.000
plot_vs(mag(vout 1[: :,0]), phi) = 4.490
a = 1.000000
max
m4
indep (m 4) = 210.000
plot_vs(mag(vout 1[: :,0]), phi) = 4.291
a = 0.900000
max 
m5
indep (m 5) = 210.000
plot_vs(mag(vout 1[: :,0]), phi) = 4.092
a = 0.800000
max 
Eqn vout_avg=sum(mag(vout1[::,0])),361
FIGURE 8.27  Simulation results of mixer as phase detector.

348
Linear and Switch-Mode RF Power Amplifiers
correction was calculated to be 0.90909, which is exactly the inverse of the ampli-
tude error of 1.1 that was added.
After correction factors are obtained, the validity of the proposed system is 
checked again by resimulating the unbalanced quadrature modulator with the cor-
rection factors applied. The simulation was performed, and the correction factors 
5
4
3
2
1
0
0
50 100 150 200
phi
250 300 350 400
Eqn imag = (max(mag(Vi  ::,0  ))–min(mag(Vi  ::,0  )))/2
Eqn Iphase = phi_start  1  + max_index(mag(Vi ::,0 ))xphi_step  1 
Eqn Qphase = phi_start  1  + max_indexmag(Vq  ::,0 ))xphi_step  1 
Eqn qmag = (max(mag(Vq  ::,0  ))–min(mag(Vq  ::,0  )))/2
Eqn gain_corr = (imag/qmag)
Eqn phase_corr = iphase–(qphase)
Gain_corr
Phase_corr
0.70000000
0.90909091
Iphase
350.000
349.300
Qphase
Eqn num_points = 360/.1 + 1
m1
phi = 10.000
Vi[::,0] = 4.370 / 0.000
m2
phi = 108.000
Vq[::,0] = 1.649 / 0.000
Vq[::,0]
Vi[::,0]
m1
m2
Imag
Qmag
1.990
2.189
FIGURE 8.28  Simulation results for quadrature modulator image cancellation simulation 
results—DC offset included.
5
4
3
2
1
0
0
50 100 150 200
phi
250 300 350 400
Eqn imag = (max(mag(Vi  ::,0  ))–min(mag(Vi  ::,0  )))/2
Eqn Iphase = phi_start  1   + max_index(mag(Vi  ::,0  ))xphi_step[1]
Eqn Qphase = phi_start  1   + max_indexmag(Vq  ::,0  ))xphi_step[1]
Eqn Qmag = (max(mag(Vq  ::,0  ))–min(mag(Vq  ::,0  )))/2
Eqn Gain_corr = (imag/Qmag)
Eqn Phase_corr = iphase–(Qphase)
Gain_corr
Phase_corr
0.70000000
0.90909091
Iphase
350.000
349.300
Qphase
Eqn num_points = 360/.1 + 1
m1
phi = 10.000
Vi[::,0] = 4.370 / 0.000
m1
phi = 108.000
Vq[::,0] = 1.649 / 0.000
Vq_noDC
Vi_noDC
m2
Imag
Qmag
1.990
2.189
m1
FIGURE 8.29  Simulation results for quadrature modulator image cancellation simulation 
results—DC offset included.
www.ebook3000.com

349
Distortion and Modulation Effects in RF Power Amplifiers
were applied in accordance with Equations 8.45 and 8.46. The simulation model 
with the correction factors applied for image cancellation is shown in Figure 8.30. 
Please note that the lower left corner in Figure 8.30 shows the application of the 
correction factors. Simulation results show that by predistorting the Q channel 
with the appropriate correction factors based on the proposed image cancel-
lation method, the system shows an improvement from 26 to 226 dB of image 
rejection as illustrated in Figure 8.31 and confirms the analytical results derived. 
FIGURE 8.30  Simulation model for image cancellation system with correction.
30
20
10
0
–10
–20
–30
–40
–50
–60
–70
–80
–90
–100
450 460
470
480
490
500 510 520
530
540
550
m1
freq = 490.0MHz
dBm(HB. Vout 1) = 9.956
m2
ind delta = 1.000e7
dep delta = –29.175
delta mode ON
m3
ind delta = 2.000e7
dep delta = –226.020
delta mode ON
Unbalanced quadrature modulator with image correction
m1
m2
m3
Freq [MHz]
dBm [Vout1]
FIGURE 8.31  Simulation results for an unbalanced quadrature modulator with correction 
factors.

350
Linear and Switch-Mode RF Power Amplifiers
The application of correction factors, which are obtained from two sets of mea-
surements, drastically reduces the unwanted image signal level designated by m3 
as shown in Figure 8.31.
The possible hardware implementation of the proposed system is illustrated in 
Figure 8.32. In the proposed implementation, I and Q signals are created digitally 
in an FPGA and converted to analog signals through the D/A converters. Low-pass 
filters are necessary to mitigate aliasing. All analog signal sources need to be phase-
locked. This can be done using PLLs with a common reference. LO source, which 
drives the quad modulator, will define the output phase noise and tune time of the 
overall system. The other signal sources are only needed for down-conversion. There 
are broadband PLL ICs available on the market today, which have integrated VCOs 
in a single small package with very low power consumption. A/D converters are 
responsible for converting the DC output from the sample mixers to a digital signal. 
Because these devices are only processing a DC signal (or low frequency), there is 
no need to use a broadband communications A/D. These data converters would most 
likely be small and consume little power. FPGA is responsible for creating the digital 
I and Q signals and collecting the samples LO and image signals. All calculations for 
the appropriate correction factors and DC offsets are performed inside the FPGA. 
This process is simply an algebraic operation, and it does not involve any lengthy 
algorithm.
Quadrature
modulator
D/A
A/D
A/D
D/A
I
Q
LO
RF
fimage
fLO
fLO
FPGA
Qdig
Idig
Iana
Qana
Vimage
VLO
Simage
SLO
FIGURE 8.32  Proposed hardware implementation of quad modulator balancing system.
www.ebook3000.com

351
Distortion and Modulation Effects in RF Power Amplifiers
REFERENCES
	
1.	 B. Razavi, RF Microelectronics, Prentice Hall, Upper Saddle River, NJ, 1998.
	
2.	 IEEE Std 802.11 a-1999, Part 11: Wireless LAN medium access control (MAC) and 
physical layer (PHY) specifications: High-speed physical layer in the 5-GHz band, 
December 1999.
	
3.	 Y.-J. Ko and S. Stapleton, Gain and phase mismatch effects on double image rejection 
transmitter, IET Circuits, Devices and Systems, Vol. 5, No. 3, pp. 212–221, 2011.
	
4.	 A. Georgiadis, Gain, phase imbalance, and phase noise effects on error vector magni-
tude, IEEE Transactions on Vehicular Technology, Vol. 53, No. 2, pp. 443–449, 2004.
	
5.	 A. Baier, Quadrature mixer imbalances in digital TDMA mobile radio receivers, in 
Proceedings of International Zurich Seminar on Digital Communications, Electronic 
Circuits and Systems for Communications, pp. 147–162, March 1990.
	
6.	 C. L. Liu, Impacts of I/Q imbalance on QPSK-OFDM-QAM detection, IEEE Transactions 
on Consumer Electronics, Vol. 44, pp. 984–989, 1998.
	
7.	 B. Come, R. Ness, S. Donnay, L. Van der Perre, W. Eberle, P. Wambacq, M. Engels, 
and I. Bolsens, Impact of front-end non-idealities on bit error rate performance of 
WLAN-OFDM transceivers, in Proceedings of IEEE Radio and Wireless Conference 
(RAWCON), pp. 91–94, 2000.
	
8.	 J. Mahattanakul, The effect of I/Q imbalance and complex filter component mismatch 
in low-IF receivers, IEEE Transactions on Circuits and Systems I, Regular Papers, 
Vol. 53, No. 2, pp. 247–253, 2006.
	
9.	 A. Tarighat, R. Bagheri, and A. H. Sayed, Compensation schemes and performance 
analysis of IQ imbalances in OFDM receivers, IEEE Transactions on Signal Processing, 
Vol. 53, No. 8, pp. 3257–3268, 2005.
	 10.	 J. Tubbax, B. Come, L. V. der Perre, S. Donnay, M. Engels, M. Moonen, and H. D. 
Man, Joint compensation of IQ imbalance and frequency offset in OFDM systems, in 
Proceedings of Radio and Wireless Conference, pp. 39–42, August 2003.
	 11.	 A. Schuchert, R. Hasholzner, and P. Antoine, A novel IQ imbalance compensa-
tion scheme for the reception of OFDM signals, IEEE Transactions on Consumer 
Electronics, Vol. 47, pp. 313–318, 2001.
	 12.	 S. Fouladifard and H. Shafiee, Frequency offset estimation in OFDM systems in pres-
ence of IQ imbalance, in Proceedings of International Conference on Communications, 
pp. 2071–2075, May 2003.
	 13.	 A. Tarighat and A. H. Sayed, MIMO OFDM receivers for systems with IQ imbalances, 
IEEE Transactions on Signal Processing, Vol. 53, No. 9, pp. 3583–3596, 2005.
	 14.	 J. Lin and E. Tsui, Joint adaptive transmitter/receiver IQ imbalance correction for 
OFDM systems, IEEE International Symposium on PIMRC, Vol. 2, pp. 1511–1516, 
September 5–8, 2004.
	 15.	 K.-H. Lin, H.-L. Lin, S.-M. Wang, and R. C. Chang, Implementation of digital IQ imbal-
ance compensation in OFDM WLAN receivers, 2006 IEEE International Symposium 
on Circuits and Systems, November 2006.
	 16.	 L. Moult and J. E. Chen, The K-model: RFIC modeling for communication sys-
tems simulation, IEE Colloquium on Analog Signal Processing (Ref. No. 1998/472), 
pp. 11/1–11/8, October 28, 1998.
	 17.	 W. V. Moer and Y. Rolain, Determining the reciprocity of mixers through 3-port large 
signal network analyzer measurement, 62nd ARFTG Conference Digest, pp. 165–170, 
December 4–5, 2003.
	 18.	 S. K. Myoung, X. Cui, P. Roblin, D. Chaillot, F. Verbeyst, M. Vanden Bossche, S. J. 
Doo, and W. Dai, Large signal network analyzer with trigger for baseband modulation 
linearization, 64th ARFTG Conference Digest, Orlando, FL, December 2004.

352
Linear and Switch-Mode RF Power Amplifiers
	 19.	 A. Eroglu, Non-invasive quadrature modulator balancing method to optimize image 
band rejection, IEEE Transactions on Circuits and Systems I, Regular Papers, Vol. 61, 
No.2, pp. 600–612, 2014.
	 20.	 Y.-H. Hsieh, W.-Y. Hu , S.-M. Lin, C.-L. Chen, W.-K. Li, S.-J. Chen, and D. J. Chen, 
An auto-I/Q calibrated CMOS transceiver for 802.11g, IEEE Journal of Solid-State 
Circuits, Vol. 40, No. 11, pp. 2187–2192, 2005.
	 21.	 Analog Devices, Inc., ADL-5385, Datasheet, 2006. Norwood, MA.
	 22.	 J. Craninckx, B. Debaillie, B. Come and S. Donnay “A WLAN direct up-conversion 
mixer with automatic image rejection calibration,” Int. Solid-State Circuits Conf. Tech. 
Dig., pp. 546–616, 2005.
	 23.	 I. Vassiliou “A single-chip digitally calibrated 5.15-5.825-GHz 0.18-mm CMOS 
transceiver for 802.11a wireless LAN,” IEEE J. Solid-State Circuits, vol. 38, no. 12, 
pp. 2221–2231, 2003.
	 24.	 C.P., Lee, A., Behzad, D., Ojo, M., Kappes, S., Au, P., Meng-An K., Carter,S., Tian, 
“A Highly Linear Difrect-Conversion Transmit Mixer Transconductance Stage with 
Local Oscillation Feedthrough and I/Q Imbalance Cancellation Scheme,” Int. Solid-
State Circuits Conf. Tech. Dig. , pp. 1450–1459, 2006.
	 25.	 L. Ding, Z. Ma, D. R. Morgan, M. Zierdt, and G. T. Zhou, “Compensation of Frequency-
Dependent Gain/Phase Imbalance in Predistortion Linearization Systems,” IEEE 
Trans. Circuits and Syst. I, Reg. Papers, vol. 55, no.1, pp. 390–397, Feb. 2008.
	 26.	 L. Yu, and W.M. Snelgrove “A novel adaptive mismatch cancellation system for 
quadrature IF radio receivers,” IEEE Trans. Circuits and Syst. II, Analog Digit. Signal 
Process, vol. 46, no.6, pp. 789–801, June 1999.
	 27.	 Olli Myllari, Lauri Anttila, Mikko Valkama, “Digital transmitter I/Q imbalance cali-
bration: real-time prototype implementation and performance measurement,” 18th 
Proc of EUSIPCO, pp. 537–541, August 23–27, 2010.
	 28.	 R. Montemayor and B. Razavi, “A self-calibrating 900-MHz CMOS image-reject 
receiver,” Proceedings of the 26rd ESSCIRC, pp. 320–323, 19–21 Sept. 2000.
www.ebook3000.com

353
Index
Page numbers followed by f indicate figures; those followed by t indicate tables.
A
ABCD parameters, 25–26, 26f
Active BJT bias circuit, 151, 153f
with BCR 400, 152f
Admittance chart, 76, 77f
Advance Design System (ADS) 
software, 324
simulation model of unbalanced quadrature 
modulator in, 342, 342f
Air-core inductor, 14
high-frequency model of RF, 13f
Amplifier
integration of, 155f
stabilization of, 163–165, 164f
Arithmetic mean distance (AMD), 16
ATF-54143 transistor
Die Model, 172f, 173f
scattering parameters, 171t
Attenuation profile
versus frequency, 98f
of LC network for different source resistance 
values, 107f
of LC network with loss resistor, 105f
for parallel resonant circuit with tapped-C, 
117f
Available gain parameter, 157
B
Balun analysis, 278–283, 280–281f
BCR 400, 151, 152f
active BJT bias circuit, 153f
Bias, 4–5, 194, 196t
for linear amplifiers, 5t
Bipolar junction transistor (BJT), 8
biasing circuits
active bias circuit, 151, 152f, 153f
with DC and AC sources, 143f, 144f
emitter bias, 150–151, 151f, 153f
fixed bias, 145–146, 145f
self-bias, 149–150, 150f, 153f
stable bias, 146–149, 147f, 153f
with temperature-compensating diodes, 
152f
using linear regulator, 151–152, 152f
typical layer structure of, 9f
BJT, see Bipolar junction transistor
C
Capacitances, 230
Capacitive switching losses, 247
Capacitive voltage divider, 112f
with load resistor, 113f
with parallel-to-series transformation, 113f
Capacitor, 18–19
high-frequency model of, 18f
Cascade network connection
of two-port networks, 31–32, 32f
“Channel pinch-off point,” 196
Characteristic impedance, 55
Class AB power amplifiers, 208
design example of, 211–216
typical drain-to-source voltage and drain 
current for, 209f
Class A power amplifiers, 202–204, 203f
power and efficiency diagram, 205f
Class B power amplifiers, 204–208, 205f
in push–pull configuration, 206f
voltage and current waveforms, 207f
Class C mixed mode power amplifiers, 209
Class C power amplifiers, 208–210
typical drain-to-source voltage and drain 
current for, 209f
Class DE power amplifiers, 247–255, 249f
analysis of series resonant network, 250–255
Class D power amplifiers
current mode, 225–228
switching waveforms for, 224f
voltage-mode, 219–225, 220f
Class E power amplifiers, 228–247, 229f
characteristics of, 298f
circuit topology of, 244f
conventional analysis of
optimum conditions for design, 236–242
suboptimum conditions for design, 
228–236
design example of, 268–272
design specifications for, 268t
harmonic modeling of, 242–247
two-level pulsing of, 304f
voltage and current waveforms for, 231f
Class F power amplifiers, 255–286
Class S, 263–267
fifth harmonic peaking, 259–260
generic circuit for, 257f

354
Index
Class F power amplifiers, (cont.)
Matlab program for, 261–263
maximum efficiency and power output of, 
261t
with third harmonic peaking, 256f
third harmonic peaking, 258–259
voltage and current waveforms for, 256f
Class S power amplifier
voltage mode configuration of, 264f
CMCD amplifier, see Current mode Class D 
amplifier
Collector efficiency, 127
Communication systems
radio frequency (RF) power amplifiers, 1–20
Conduction angle, 194, 196t, 203, 204, 208–209, 
248–249
defined, 4
for linear amplifiers, 5t
Conformal mapping
of constant reactances, 69f
of constant resistances, 69f
Conjugate matching method, 1, 3
Constant gain circles, 179f, 180f
drawing, 169f
potentially stable case, 170
unconditionally stable case, 168–169
unilateral case, 165–168, 167f
Conventional amplifiers, 199–202, 199f, 203f
efficiency distribution of, 210f
power capability of, 210f
Conventional analysis, of Class E amplifiers, 
228–242
Current mode Class D (CMCD) amplifier, 226f
impedance for harmonic terminations 
of, 227t
operational waveforms, 228f
Current Source Class C Amplifiers, 209
Current standing wave ratio (ISWR), 61
D
DC biasing circuits, 143–145
design equations, 173t
Design example, 211–216
of Class E amplifier, 268–272
experimental results, 271–272
in-line harmonic rejection filter with 
clamping diode, 269–270
off-line very low-frequency filter, 269
of low-noise amplifier, 171–186
of push–pull Class E amplifier, 272–286
design of input balun, 278–283, 280–281f
isolation gate transformer design, 
283–286
Die dissipation, 307, 312, 318f
Digital-to-Analog Converter (DAC), 324
Distortionless lines, 58
Distributed elements, 53
Drain current, 208, 209, 225
for Class AB and Class C amplifiers, typical 
drain-to-source voltage and, 209f
Drain efficiency, 127, 311, 312f, 317f
Drain-to-source voltage, 205–206, 208, 209, 227, 
235, 236, 313, 315f
for Class AB and Class C amplifiers, typical 
drain current and, 209f
Dynamic range (DR), 137
E
Efficiency, 127–128
Emitter BJT bias, 150–151, 151f, 153f
Equalization techniques, 323
Equivalent impedance, 18
F
FET, see Field effect transistor
Field effect transistor (FET), 8–11
biasing circuits, 153
simplified structure of, 10f
transfer characteristics of ideal, 197f
transistors’ applications and frequency of 
operations, 10t
Field-Programmable Gate Array (FPGA) device, 
324, 350
Fifth harmonic peaking, 259–260
Figure of merit (FOM), 10–11, 170–186
comparison of planar and trench MOSFET 
structures, 11f
Fixed BJT bias, 145–146, 145f
Flux linkage, 12
Fourier series, 200, 220–221, 223, 250
G
Gain, 125–127
Gallium arsenide (GaAs), 8
Gallium nitride (GaN), 8
Geometric mean distance (GMD), 16
H
Harmonic distortion, 131–134
Harmonic modeling, implementation of, 
242–247
phase-controlled Class E power amplifier, 
299–302
single-ended Class E power amplifier, 
292–299
HBT, see Heterojunction bipolar transistor
Heterojunction bipolar transistor (HBT), 8
typical layer structure of, 9f
h-hybrid parameters, 26–29
www.ebook3000.com

355
Index
I
Ideal quadrature modulator, 324–326, 
325f
Ideal resistor, impedance of, 20f
Image band rejection method, 332–333
improved, 333–350
LO cancellation, 338–342
simulation results, 342–350
with I path test signal measurement, 334f
with Q path test signal measurement, 336f
Image cancellation system, 338, 344
I/Q test signal, 344–345f
simulation results for quadrature modulator, 
348f
simulation setup for, 346t
Impedance matching networks
and resonant networks, 53–123
impedance matching between 
transmission lines and load 
impedances, 80–83
impedance transformation and matching 
between source and load impedances, 
86–89
LC resonators as impedance transformers, 
108–112
resonator networks, 89–108
signal flow graphs, 117–123
single stub tuning, 83–86
Smith chart, 66–80
tapped resonators as impedance 
transformers, 112–117
transmission lines, 53–66
Impedance transformation, 79f
and matching between source and load 
impedances, 86–89
using Smith chart, 80f
Impedance variation
of open-circuited transmission line, 66f
of short-circuited transmission line, 65f
Inductance, 12
Inductor, 12–17, 12f
air-core inductor design, 14, 14f
high-frequency effects of RF, 13f
magnetic-core inductor design, 14–16
planar inductor design, 16–17
Input matching circuit, 177f
Input stability circle, 161–163
Insertion loss, 36, 49
Intercept point, 136
Intermodulation, 134–139
frequencies and corresponding amplitudes, 
135t, 136t
Intermodulation distortion (IMD), 135f, 135t
measurement setup, 136f
Intermodulation-free dynamic range (IMFDR3), 
137
I path, of nonideal quadrature modulator, 
327–329
IQ imbalances, 323
Isolation gate transformer, 283–286, 285f
open and short circuit test results for, 286t
Iterative algorithm, 292, 293f
K
Kirchhoff’s Current Law (KCL), 53
Kirchhoff’s Voltage Law (KVL), 53
K-matrix modeling, of IQ imbalance, 323
“Knee/saturation point,” 196
L
Laplace transforms, 243
Large-signal amplifiers, 1–3, 2f
design techniques, 187–191
LC impedance transformer
capacitive load, 109–112, 109f
inductive load, 108–109, 108f
LC networks
equivalent loaded circuit at resonance, 108f
frequency characteristics with source, 103f
with ideal components and source, 103f
loaded circuit, 107f
parallel, 102–108
addition of loss to, 104f
with ideal components, 102–103
loading effects on, 106–108
with nonideal components, 103–105
quality factor for different source resistance 
values, 106f
quality factor with loss resistor, 105f
Limiting case, for transmission lines
distortionless lines, 58
lossless lines, 58, 59f
low loss lines, 58
Linear amplifiers, 3–5, 194–202, 195f
conduction angles, bias, and quiescent points 
for, 5t
conventional, 199–202
design and implementation, 187–216
equivalent circuit representation of mode of 
operation, 4f
load lines and bias points for, 5f, 196f
summary of operational characteristics, 6t
summary of performance parameters, 6t
voltage transfer characteristics, 4f
Linearity, 129–130
Linear regulator, BJT bias circuit using, 151–152, 
152f
L matching network, 81f
possible match source and load impedance, 
89f, 90f
between source and load impedances, 87f

356
Index
Load impedance, 2
Load line matching, 2, 3
Load-pull measurement circuit, 187, 188f
Load pull technique, 191f
Local oscillator (LO), 324
cancellation, 338–342, 338f
linear algebraic model for, 340f
simplified mathematical model of, 341f
Lossless lines, 58, 59f
terminated, 59–64
Low-frequency equivalent circuit
of open-circuited transmission line, 66f
of short-circuited transmission line, 65f
Low loss lines, 58
Lumped elements, 53, 83
M
Magnetic-core inductor, 14–16
Mason’s rule, 117
Master power amplifier, 299, 302, 308f
Matching networks, 53
implementation for RF power amplifiers, 54f
between load and transmission line, 80f, 87f
Mathcad, 303
MATLAB
GUI display of Smith chart, 75f
program for Class F amplifier, 261–263
Metal oxide semiconductor field-effect transistors 
(MOSFETs), 10–11, 11f, 196, 198f, 
245, 253, 253f, 305
Metal-semiconductor field-effect transistors 
(MESFETs), 8
MOSFETs, see Metal oxide semiconductor field-
effect transistors
Mutual coupling, 16
N
N channel Metal Oxide Semiconductor (NMOS), 
197f, 198f
Network connections, 30–36
Network parameters, 23–29
ABCD, 25–26, 26f
conversion table, 30t
h-hybrid, 26–29
Y-admittance, 24–25
Z-impedance, 23–24
Nonideal quadrature modulator, 326–333, 326f
I path, 327–329
output of, 332–333
Q path, 329–332
Nonideal resistor, 19, 20f
Nonlinear amplifier
equivalent circuit representation of mode of 
operation, 6f
response that has second and third-order 
nonlinearities, 142f
second-order output response, 140f
third-order output response, 141f
Normalized scattering parameters, 43–51
N-port network, 26
for scattering analysis, 39–43, 40f
O
1 dB compression point, 130–131, 130f, 138
One-port network, for scattering parameter 
analysis, 37–39, 38f
ON/OFF pulsing, 303–304, 315–316f, 318–319f
Open-circuited transmission line, 65–66, 66f
impedance variation for, 66f
low-frequency equivalent circuit of, 66f
Operating gain parameter, 157
Operational characteristics
of linear amplifiers, 6t
of switch-mode amplifiers, 7t
Optimum load resistance Ropt, 187–188
DC load line for Class A amplifier, 188f
illustration on Smith chart, 189f
Orthogonal frequency division multiplexing 
(OFDM)
IQ imbalances, 323
Oscillations, 159
Out-phasing, 242
Output matching circuit, 178f
Output stability circle, 160–161
Overdamped parallel resonant circuit, 93f
Overdamped series resonant circuit, 101f
P
Parallel equivalent circuit, 19f
Parallel LC networks, 102–108
Parallel network connection
of two-port networks, 31, 31f
Parallel resonant network, 90–97, 91f
response for overdamped case, 93f
response for underdamped case, 93f
with source current, 94f
transfer function characteristics, 96f
Parallel transistor configuration, 194, 194f
Passive devices
capacitor, 18–19
inductor, 12–17, 12f
air-core inductor design, 14
magnetic-core inductor design, 14–16
planar inductor design, 16–17
resistor, 19–20
Performance parameters
of linear amplifiers, 6t
of switch-mode amplifiers, 7t
www.ebook3000.com

357
Index
Phase-controlled Class E power amplifier, 
289–302, 290f, 315–316f
analytical power profile of, 304f
analytical voltage and current profile of 
transistors for, 305f
comparison of switch voltage waveforms, 
295f, 299f
illustration of, 303f
implementation of harmonic modeling, 
292–302
single-ended class e power amplifier, 
292–299
iterative algorithm for, 293f
under output power regulation, for constant 
VSWR loads, 301f
for pulsing applications, 306f
simulated die dissipation for, 310f
specifications for, 305t
spectral content pulsed with mismatched load 
with VSWR, 320f
Phase detector, mixer as, 334–335, 335f, 343f, 
347f
Phase-locked loop (PLL), 324
Phase velocity, 55
Planar devices, 8, 11
Planar inductor, 16–17
spiral-type, 16, 17f
Pole-zero diagram, 95f
Power amplifiers (PAs)
module combiners, 194, 195f
radio frequency (RF), see Radio frequency 
(RF) power amplifiers (PA)
Power devices, family tree for, 9f
Power gains, for small-signal amplifiers, 
154–158
Power Meter Gains, 181t
Power output capability, 128–129
Power transistors, 7–11
BJT and HBTs, 8
FETs, 8–11
MOSFETs, 10–11
Pspice, 305
Pulsing, of switch-mode amplifiers, 302–320
Class E amplifiers, 302–320
experimental results, 310–320
matched load characteristics of, 
311–316
mismatched load characteristics of, 
316–320
simulation results, 304–310
simulated die dissipation for, 310f
Push–pull amplifier
Class B, 206f
Class E, design example for, 272–286, 276f
configuration, 191–193, 193f
design example of, 211–216
Q
Q path, of nonideal quadrature modulator, 329–332
Quadrature modulator, 323, 324f
proposed hardware implementation of, 350f
simulation results for, 348f
Quality factor, 95–96
of LC network for different source resistance 
values, 106f
of LC network with loss resistor, 105f
Quasi-static method, 16
“Quiescent” conditions (Q points), 4–5, 194, 196t
for linear amplifiers, 5t
R
Radio frequency (RF) power amplifiers (PA)
1 dB compression point, 130–131, 130f, 138
basic terminology, 125–139
block diagram of, 2f
communication systems, 1–20
distortion and modulation effects in, 323–350
efficiency, 127–128
experimental setup for linearity adjustment 
of, 130f
gain, 125–127
harmonic distortion, 131–134
ideal quadrature modulator, 324–326
improved method for image band rejection, 
333–350
LO cancellation, 338–342
simulation results, 342–350
intermodulation, 134–139, 135t, 136t
linear amplifiers, 3–5
linear curve for, 129f
linearity, 129–130
multistage, 126f
nonideal quadrature modulator, 326–333
I path, 327–329
output of, 332–333
Q path, 329–332
passive devices
capacitor, 18–19
inductor, 12–17, 12f
resistor, 19–20
power output capability, 128–129
power transistors, 7–11
BJT and HBTs, 8
FETs, 8–11
switch-mode amplifiers, 5–7
as three-port network, 126f
transistors’ applications and frequency of 
operations, 10t
types of, 1–3
typical closed-loop control for linearity 
control, 129f

358
Index
Rail voltage, 294–295
Reflection coefficient, 56, 59
and normalized admittance, 76
Resistor, 19–20
characteristics with frequency, 20f
representation of equivalent model, 20f
Resonant circuit, 89
Resonant frequency, 89, 222, 250–251, 251f
modified circuit for operation above, 252f
Resonant networks, 89–108, 90f
and impedance matching networks, 53–123
parallel LC networks, 102–108
with ideal components, 102–103
loading effects on, 106–108
with nonideal components, 103–105
parallel resonance, 90–97, 91f
series resonance, 97–102
Return loss (RL), 36, 49, 60
RF PA, see Radio frequency (RF) power 
amplifiers (PA)
S
Safe operating area (SOA), 307–310
Saturated Class C Amplifiers, 209
Scattering parameters, 36–51, 119f
in amplifier design, 154
of ATF-54143, 171t
normalized scattering parameters, 43–51
N-port network, 39–43
one-port network, 37–39
representation of branch using, 119f
for two-port networks, 45f
Self-bias BJT, 149–150, 150f, 153f
Self-coupling, 16
Self-inductance, 12
Self-shielding, 15
Semiconductor, typical parameter values for 
materials, 8t
Series equivalent circuit, 13f
Series network connection, of two-port networks, 
30, 31f
Series reactance, 190f
Series resonant network, 97–102, 98f, 250–255, 
251f
response for overdamped case, 101f
response for underdamped case, 100f
with source voltage, 101f
transfer function characteristics, 102f
Series single stub tuning, 85–86, 83f
Short-circuited transmission line, 64–65, 64f
impedance variation for, 65f
low-frequency equivalent circuit of, 65f
Shunt single stub tuning, 84–85, 83f
Shunt susceptance, 191f
Signal flow graphs, 117–123
implementation of two-port network, 119f
representation of transmission line circuit, 
123f
Silicon (Si), 8
Silicon carbide (SiC), 8
Simulation, 342
of an unbalanced quadrature modulator in 
ADS, 342f
model for image cancellation system, 
344–345f
model of mixer as phase detector using ADS, 
343f
Single-bead geometry, 284f
Single-ended Class E amplifier, 291, 292–299, 
294f
Single-stub tuning, 83, 93f
series, 85–86
shunt, 84–85
Six-bead geometry, 284f, 285f
Slave power amplifier, 299, 302, 308f
Small-signal amplifiers, 1–3, 2f
design, 139–186, 159f
BJT biasing circuits, 145–152
constant gain circles, 165–170
DC biasing circuits, 143–145
definitions of power gains for, 154–158
FET biasing circuits, 153
stability, 159–165
steps for, 158–159
unilateral figure of merit, 170–186
stability, 159–165
circles, 160–165
unconditional, 160
Smith chart, 53, 66–80, 160–161, 306–307, 308f
as admittance chart, 76
GUI display for, 73f, 75f
illustrating input/output stability regions, 
161f, 162f
illustration of low and high impedance limits 
on, 190f
illustration of Ropt on, 189f
input impedance determination with, 72–75
ZY Smith chart and its application, 76–80
Smith, Phillip Hagar, 67
Spectrum analyzer, 318
Spiral-type planar inductors, 16, 17f
Stability
analysis for small-signal amplifier, 159–165
network by adding series resistance, 165f
network by adding shunt conductance, 165f
with series resistor at load, 166f
with shunt conductance at load, 166f
Stability circles, 176f
input, 161–163
output, 160–161
Stable BJT bias, 146–149, 147f, 153f
Switch-mode amplifiers, 5–7
Class D amplifiers
www.ebook3000.com

359
Index
current mode, 225–228
voltage-mode, 219–225
Class DE amplifiers, 247–255
analysis of series resonant network, 
250–255
Class E amplifiers
conventional analysis of, 228–242
harmonic modeling of, 242–247
pulsing of, 302–320
Class F amplifiers, 255–286
Class S, 263–267
design and implementation, 219–286
implementation of harmonic modeling
phase-controlled Class E power amplifier, 
290f, 299–302
single-ended Class E power amplifier, 
292–299
measured gain variation versus frequency 
for, 126f
phase-controlled, 289–320
summary of operational characteristics, 7t
summary of performance parameters, 7t
Switch-mode operation, 242
T
Tapped-C impedance transformer, 112–117
Tapped equivalent circuit, 114f
representation using transformer, 115f
Tapped-L equivalent circuit, 118f
Tapped-L impedance transformer, 117
with parallel-to-series transformation, 118f
Tapped resonators, as impedance transformers, 
112–117
Telegrapher equations, 54
Theoretical mixer, 335f
Third harmonic peaking, 258–259
Time-domain form, of transmission line, 54
T-network configuration, 27f
Toroidal inductors, 14f
geometry of, 15f
magnetic flux in, 15f
Transducer gain parameter, 156–157
Transistor
applications and frequency of operations, 10t
dissipation, 202, 203, 204
power, 7–11
Transmission lines, 53–66, 80f
finite terminated, 56f
impedance matching between load 
impedances and, 80–83
input impedance calculation on, 57f
limiting cases for, 57–59
short segment of, 54f
special cases of terminated, 64–66
stub, 83
terminated lossless, 59–64
time-domain form, 54
Transmitter system, 324f
Trench MOSFET, 11f
Truncated V-Groove MOSFET, 11f
Two-level pulsing, 303–304, 316–317f
Two-port networks, 23–51, 24f, 119f, 154f, 158f
cascade connection, 31–32, 32f
parallel connection, 31, 31f
scattering parameters, 45f
series network connection, 30, 31f
for stabilization, 164f
Two-tone test, 135
U
Unbalanced quadrature modulator, 344
simulation results, 345–350, 346f
with correction factors, 349f
Unconditional stability, 160, 163f
Underdamped parallel resonant circuit, 93f
Underdamped series resonant circuit, 100f
Unilateral figure of merit, 170–186
V
Vertical devices, 8
V-Groove trench MOSFET, 11f
VMCD amplifier, see Voltage-mode Class D 
amplifier
Voltage-mode Class D (VMCD) amplifier, 
219–225, 220f
Voltage standing wave ratio (VSWR), 49, 60, 
297–298
W
Wilkinson-type power combiner, 194
Y
Y-admittance parameters, 24–25
Z
Z generator matrix, 39
Z-impedance parameters, 23–24
ZY Smith chart, 77f
adding component using, 78f
and application, 76–80

