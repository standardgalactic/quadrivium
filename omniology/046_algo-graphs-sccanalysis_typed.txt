Graph	 Â Primi*ves	 Â 
Correctness	 Â of	 Â 
Kosarajuâ€™s	 Â Algorithm	 Â 
Design	 Â and	 Â Analysis	 Â 
of	 Â Algorithms	 Â I	 Â 

Tim	 Â Roughgarden	 Â 
Example	 Â Recap	 Â 

Tim	 Â Roughgarden	 Â 
Observa*on	 Â 
Claim	 Â :	 Â the	 Â SCCs	 Â of	 Â a	 Â directed	 Â graph	 Â G	 Â 
induce	 Â an	 Â acyclic	 Â â€œmeta-Â­â€graphâ€:	 Â 
	 Â 
-Â­â€-Â­â€	 Â meta-Â­â€nodes	 Â =	 Â the	 Â SCCs	 Â C1,..,Ck	 Â of	 Â G	 Â 
-Â­â€-Â­â€	 Â 
	 Â 
	 Â 
Why	 Â acyclic	 Â ?	 Â :	 Â a	 Â cycle	 Â of	 Â 
SCCs	 Â would	 Â collapse	 Â into	 Â 
one.	 Â 

In	 Â general,	 Â they	 Â are	 Â unrelated.	 Â 
Every	 Â SCC	 Â of	 Â ðº	 Â is	 Â contained	 Â in	 Â an	 Â SCC	 Â of	 Â â€‹ðºâ†‘ð‘Ÿð‘’ð‘£âŸ,	 Â but	 Â the	 Â converse	 Â need	 Â not	 Â hold.	 Â 	 Â 
Every	 Â SCC	 Â of	 Â â€‹ðºâ†‘ð‘Ÿð‘’ð‘£âŸis Â contained Â in Â an Â SCC Â of Â ðº, Â but Â the Â converse Â need Â not Â 
hold. Â 	 Â 
They	 Â are	 Â exactly	 Â the	 Â same.	 Â 
What	 Â how	 Â are	 Â the	 Â SCC	 Â of	 Â the	 Â original	 Â graph	 Â ðº	 Â and	 Â its	 Â reversal	 Â â€‹
ðºâ†‘ð‘Ÿð‘’ð‘£âŸ	 Â related?	 Â 

Tim	 Â Roughgarden	 Â 
Lemma	 Â :	 Â consider	 Â two	 Â â€œadjacentâ€	 Â SCCs	 Â in	 Â G:	 Â 
	 Â 
	 Â 
	 Â 
Let	 Â f(v)	 Â =	 Â ï¬nishing	 Â *mes	 Â of	 Â DFS-Â­â€Loop	 Â in	 Â Grev	 Â 
Then	 Â :	 Â 
Corollary	 Â :	 Â maximum	 Â f-Â­â€value	 Â of	 Â G	 Â must	 Â lie	 Â in	 Â a	 Â â€œsink	 Â SCCâ€	 Â 
Key	 Â Lemma	 Â 
Max	 Â 
ï¬nishing	 Â 
*me	 Â 

Tim	 Â Roughgarden	 Â 
Correctness	 Â Intui*on	 Â 
	 Â 
	 Â 
	 Â (see	 Â notes	 Â for	 Â formal	 Â proof)	 Â 
By	 Â Corollary	 Â :	 Â 2nd	 Â pass	 Â of	 Â DFS-Â­â€Loop	 Â begins	 Â 
somewhere	 Â in	 Â a	 Â sink	 Â SCC	 Â C*.	 Â 	 Â 
â‡’â€¯First	 Â call	 Â to	 Â DFS	 Â discovers	 Â C*	 Â and	 Â nothing	 Â else!	 Â 
â‡’â€¯Rest	 Â of	 Â DFS-Â­â€Loop	 Â like	 Â recursing	 Â on	 Â G	 Â with	 Â C*	 Â deleted	 Â 
	 Â [	 Â starts	 Â in	 Â a	 Â sink	 Â node	 Â of	 Â G-Â­â€C*]	 Â 
â‡’â€¯	 Â successive	 Â calls	 Â to	 Â DFS(G,i)	 Â â€œpeel	 Â oï¬€â€	 Â the	 Â SCCs	 Â one	 Â by	 Â one	 Â 	 Â 
[	 Â in	 Â reverse	 Â topological	 Â order	 Â of	 Â the	 Â â€œmeta-Â­â€graphâ€	 Â of	 Â SCCs	 Â ]	 Â 

Tim	 Â Roughgarden	 Â 
In	 Â Grev	 Â :	 Â 
	 Â 
	 Â 
Let	 Â v	 Â =	 Â 1st	 Â node	 Â of	 Â 	 Â 
	 Â reached	 Â by	 Â 1st	 Â pass	 Â of	 Â DFS-Â­â€Loop	 Â (on	 Â Grev)	 Â 
Case	 Â 1	 Â [
	 Â ]	 Â :	 Â all	 Â of	 Â C1	 Â explored	 Â before	 Â C2	 Â ever	 Â reached.	 Â 
Reason	 Â :	 Â no	 Â paths	 Â from	 Â C1	 Â to	 Â C2	 Â (since	 Â meta-Â­â€graph	 Â is	 Â acyclic)	 Â 
â‡’â€¯All	 Â f-Â­â€values	 Â in	 Â C1	 Â less	 Â than	 Â all	 Â f-Â­â€values	 Â in	 Â C2	 Â 
Case	 Â 2	 Â [
	 Â ]	 Â :	 Â DFS(Grev,	 Â v)	 Â wonâ€™t	 Â ï¬nish	 Â un*l	 Â all	 Â of	 Â 
	 Â 	 Â 
completely	 Â explored	 Â =>	 Â f(v)	 Â >	 Â f(w)	 Â for	 Â all	 Â w	 Â in	 Â C1	 Â 
Proof	 Â of	 Â Key	 Â Lemma	 Â 
S*ll	 Â SCCs	 Â (of	 Â Grev)	 Â 	 Â 
[by	 Â Quiz	 Â ]	 Â 
Case	 Â 1	 Â 
Case	 Â 1	 Â 

