CONVEX ANALYSIS AND NONLINEAR
OPTIMIZATION
Theory and Examples
JONATHAN M. BORWEIN
Centre for Experimental and Constructive Mathematics
Department of Mathematics and Statistics
Simon Fraser University, Burnaby, B.C., Canada V5A 1S6
jborwein@cecm.sfu.ca
http://www.cecm.sfu.ca/∼jborwein
and
ADRIAN S. LEWIS
Department of Combinatorics and Optimization
University of Waterloo, Waterloo, Ont., Canada N2L 3G1
aslewis@orion.uwaterloo.ca
http://orion.uwaterloo.ca/∼aslewis

To our families
2

Contents
0.1
Preface . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
1
Background
7
1.1
Euclidean spaces
. . . . . . . . . . . . . . . . . . . . . . . . .
7
1.2
Symmetric matrices . . . . . . . . . . . . . . . . . . . . . . . .
16
2
Inequality constraints
22
2.1
Optimality conditions . . . . . . . . . . . . . . . . . . . . . . .
22
2.2
Theorems of the alternative
. . . . . . . . . . . . . . . . . . .
30
2.3
Max-functions and ﬁrst order conditions
. . . . . . . . . . . .
36
3
Fenchel duality
42
3.1
Subgradients and convex functions
. . . . . . . . . . . . . . .
42
3.2
The value function
. . . . . . . . . . . . . . . . . . . . . . . .
54
3.3
The Fenchel conjugate . . . . . . . . . . . . . . . . . . . . . .
61
4
Convex analysis
78
4.1
Continuity of convex functions . . . . . . . . . . . . . . . . . .
78
4.2
Fenchel biconjugation . . . . . . . . . . . . . . . . . . . . . . .
90
4.3
Lagrangian duality . . . . . . . . . . . . . . . . . . . . . . . . 103
5
Special cases
113
5.1
Polyhedral convex sets and functions . . . . . . . . . . . . . . 113
5.2
Functions of eigenvalues
. . . . . . . . . . . . . . . . . . . . . 120
5.3
Duality for linear and semideﬁnite programming . . . . . . . . 126
5.4
Convex process duality . . . . . . . . . . . . . . . . . . . . . . 132
6
Nonsmooth optimization
143
6.1
Generalized derivatives . . . . . . . . . . . . . . . . . . . . . . 143
3

6.2
Nonsmooth regularity and strict diﬀerentiability . . . . . . . . 151
6.3
Tangent cones . . . . . . . . . . . . . . . . . . . . . . . . . . . 158
6.4
The limiting subdiﬀerential
. . . . . . . . . . . . . . . . . . . 167
7
The Karush-Kuhn-Tucker theorem
176
7.1
An introduction to metric regularity
. . . . . . . . . . . . . . 176
7.2
The Karush-Kuhn-Tucker theorem
. . . . . . . . . . . . . . . 184
7.3
Metric regularity and the limiting subdiﬀerential . . . . . . . . 191
7.4
Second order conditions
. . . . . . . . . . . . . . . . . . . . . 197
8
Fixed points
204
8.1
Brouwer’s ﬁxed point theorem . . . . . . . . . . . . . . . . . . 204
8.2
Selection results and the Kakutani-Fan ﬁxed point theorem . . 216
8.3
Variational inequalities . . . . . . . . . . . . . . . . . . . . . . 227
9
Postscript: inﬁnite versus ﬁnite dimensions
238
9.1
Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . 238
9.2
Finite dimensionality . . . . . . . . . . . . . . . . . . . . . . . 240
9.3
Counterexamples and exercises . . . . . . . . . . . . . . . . . . 243
9.4
Notes on previous chapters . . . . . . . . . . . . . . . . . . . . 249
9.4.1
Chapter 1: Background . . . . . . . . . . . . . . . . . . 249
9.4.2
Chapter 2: Inequality constraints . . . . . . . . . . . . 249
9.4.3
Chapter 3: Fenchel duality . . . . . . . . . . . . . . . . 249
9.4.4
Chapter 4: Convex analysis
. . . . . . . . . . . . . . . 250
9.4.5
Chapter 5: Special cases . . . . . . . . . . . . . . . . . 250
9.4.6
Chapter 6: Nonsmooth optimization
. . . . . . . . . . 250
9.4.7
Chapter 7: The Karush-Kuhn-Tucker theorem . . . . . 251
9.4.8
Chapter 8: Fixed points
. . . . . . . . . . . . . . . . . 251
10 List of results and notation
252
10.1 Named results and exercises . . . . . . . . . . . . . . . . . . . 252
10.2 Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267
Bibliography
276
Index
290
4

0.1
Preface
Optimization is a rich and thriving mathematical discipline. Properties of
minimizers and maximizers of functions rely intimately on a wealth of tech-
niques from mathematical analysis, including tools from calculus and its
generalizations, topological notions, and more geometric ideas.
The the-
ory underlying current computational optimization techniques grows ever
more sophisticated – duality-based algorithms, interior point methods, and
control-theoretic applications are typical examples. The powerful and elegant
language of convex analysis uniﬁes much of this theory. Hence our aim of
writing a concise, accessible account of convex analysis and its applications
and extensions, for a broad audience.
For students of optimization and analysis, there is great beneﬁt to blur-
ring the distinction between the two disciplines. Many important analytic
problems have illuminating optimization formulations and hence can be ap-
proached through our main variational tools: subgradients and optimality
conditions, the many guises of duality, metric regularity and so forth. More
generally, the idea of convexity is central to the transition from classical
analysis to various branches of modern analysis: from linear to nonlinear
analysis, from smooth to nonsmooth, and from the study of functions to
multifunctions. Thus although we use certain optimization models repeat-
edly to illustrate the main results (models such as linear and semideﬁnite
programming duality and cone polarity), we constantly emphasize the power
of abstract models and notation.
Good reference works on ﬁnite-dimensional convex analysis already exist.
Rockafellar’s classic Convex Analysis [149] has been indispensable and ubiq-
uitous since the 1970’s, and a more general sequel with Wets, Variational
Analysis [150], appeared recently. Hiriart-Urruty and Lemar´echal’s Convex
Analysis and Minimization Algorithms [86] is a comprehensive but gentler
introduction. Our goal is not to supplant these works, but on the contrary
to promote them, and thereby to motivate future researchers. This book
aims to make converts.
We try to be succinct rather than systematic, avoiding becoming bogged
down in technical details. Our style is relatively informal: for example, the
text of each section sets the context for many of the result statements. We
value the variety of independent, self-contained approaches over a single,
uniﬁed, sequential development.
We hope to showcase a few memorable
principles rather than to develop the theory to its limits.
We discuss no
5

algorithms. We point out a few important references as we go, but we make
no attempt at comprehensive historical surveys.
Inﬁnite-dimensional optimization lies beyond our immediate scope. This
is for reasons of space and accessibility rather than history or application:
convex analysis developed historically from the calculus of variations, and
has important applications in optimal control, mathematical economics, and
other areas of inﬁnite-dimensional optimization. However, rather like Hal-
mos’s Finite Dimensional Vector Spaces [81], ease of extension beyond ﬁ-
nite dimensions substantially motivates our choice of results and techniques.
Wherever possible, we have chosen a proof technique that permits those read-
ers familiar with functional analysis to discover for themselves how a result
extends. We would, in part, like this book to be an entr´ee for mathemati-
cians to a valuable and intrinsic part of modern analysis. The ﬁnal chapter
illustrates some of the challenges arising in inﬁnite dimensions.
This book can (and does) serve as a teaching text, at roughly the level
of ﬁrst year graduate students. In principle we assume no knowledge of real
analysis, although in practice we expect a certain mathematical maturity.
While the main body of the text is self-contained, each section concludes with
an often extensive set of optional exercises. These exercises fall into three cat-
egories, marked with zero, one or two asterisks respectively: examples which
illustrate the ideas in the text or easy expansions of sketched proofs; im-
portant pieces of additional theory or more testing examples; longer, harder
examples or peripheral theory.
We are grateful to the Natural Sciences and Engineering Research Council
of Canada for their support during this project. Many people have helped
improve the presentation of this material.
We would like to thank all of
them, but in particular Guillaume Haberer, Claude Lemar´echal, Olivier Ley,
Yves Lucet, Hristo Sendov, Mike Todd, Xianfu Wang, and especially Heinz
Bauschke.
Jonathan M. Borwein
Adrian S. Lewis
Gargnano, Italy
September, 1999
6

Chapter 1
Background
1.1
Euclidean spaces
We begin by reviewing some of the fundamental algebraic, geometric and
analytic ideas we use throughout the book. Our setting, for most of the
book, is an arbitrary Euclidean space E, by which we mean a ﬁnite-
dimensional vector space over the reals R, equipped with an inner product
⟨·, ·⟩. We would lose no generality if we considered only the space Rn of real
(column) n-vectors (with its standard inner product), but a more abstract,
coordinate-free notation is often more ﬂexible and elegant.
We deﬁne the norm of any point x in E by ∥x∥=

⟨x, x⟩, and the unit
ball is the set
B = {x ∈E | ∥x∥≤1}.
Any two points x and y in E satisfy the Cauchy-Schwarz inequality
|⟨x, y⟩| ≤∥x∥∥y∥.
We deﬁne the sum of two sets C and D in E by
C + D = {x + y | x ∈C, y ∈D}.
The deﬁnition of C −D is analogous, and for a subset Λ of R we deﬁne
ΛC = {λx | λ ∈Λ, x ∈C}.
Given another Euclidean space Y, we can consider the Cartesian product
Euclidean space E×Y, with inner product deﬁned by ⟨(e, x), (f, y)⟩= ⟨e, f⟩+
⟨x, y⟩.
7

8
Background
We denote the nonnegative reals by R+. If C is nonempty and satisﬁes
R+C = C we call it a cone.
(Notice we require that cones contain 0.)
Examples are the positive orthant
Rn
+ = {x ∈Rn | each xi ≥0},
and the cone of vectors with nonincreasing components
Rn
≥= {x ∈Rn | x1 ≥x2 ≥. . . ≥xn}.
The smallest cone containing a given set D ⊂E is clearly R+D.
The fundamental geometric idea of this book is convexity. A set C in E
is convex if the line segment joining any two points x and y in C is contained
in C: algebraically, λx+ (1 −λ)y ∈C whenever 0 ≤λ ≤1. An easy exercise
shows that intersections of convex sets are convex.
Given any set D ⊂E, the linear span of D, denoted span (D), is the
smallest linear subspace containing D. It consists exactly of all linear com-
binations of elements of D.
Analogously, the convex hull of D, denoted
conv (D), is the smallest convex set containing D.
It consists exactly of
all convex combinations of elements of D, that is to say points of the form
m
i=1 λixi, where λi ∈R+ and xi ∈D for each i, and  λi = 1 (see Exercise
2).
The language of elementary point-set topology is fundamental in opti-
mization. A point x lies in the interior of the set D ⊂E (denoted int D)
if there is a real δ > 0 satisfying x + δB ⊂D. In this case we say D is a
neighbourhood of x. For example, the interior of Rn
+ is
Rn
++ = {x ∈Rn | each xi > 0}.
We say the point x in E is the limit of the sequence of points x1, x2, . . . in E,
written xi →x as i →∞(or limi→∞xi = x), if ∥xi −x∥→0. The closure
of D is the set of limits of sequences of points in D, written cl D, and the
boundary of D is cl D \ int D, written bd D. The set D is open if D = int D,
and is closed if D = cl D. Linear subspaces of E are important examples of
closed sets. Easy exercises show that D is open exactly when its complement
Dc is closed, and that arbitrary unions and ﬁnite intersections of open sets
are open. The interior of D is just the largest open set contained in D, while
cl D is the smallest closed set containing D. Finally, a subset G of D is open
in D if there is an open set U ⊂E with G = D ∩U.

§1.1
Euclidean spaces
9
Much of the beauty of convexity comes from duality ideas, interweaving
geometry and topology. The following result, which we prove a little later,
is both typical and fundamental.
Theorem 1.1.1 (Basic separation) Suppose that the set C ⊂E is closed
and convex, and that the point y does not lie in C. Then there exist real b
and a nonzero element a of E satisfying ⟨a, y⟩> b ≥⟨a, x⟩for all points x
in C.
Sets in E of the form {x | ⟨a, x⟩= b} and {x | ⟨a, x⟩≤b} (for a nonzero
element a of E and real b) are called hyperplanes and closed halfspaces respec-
tively. In this language the above result states that the point y is separated
from the set C by a hyperplane: in other words, C is contained in a certain
closed halfspace whereas y is not. Thus there is a ‘dual’ representation of C
as the intersection of all closed halfspaces containing it.
The set D is bounded if there is a real k satisfying kB ⊃D, and is
compact if it is closed and bounded. The following result is a central tool in
real analysis.
Theorem 1.1.2 (Bolzano-Weierstrass) Any bounded sequence in E has
a convergent subsequence.
Just as for sets, geometric and topological ideas also intermingle for the
functions we study. Given a set D in E, we call a function f : D →R
continuous (on D) if f(xi) →f(x) for any sequence xi →x in D.
In
this case it easy to check, for example, that for any real α the level set
{x ∈D | f(x) ≤α} is closed providing D is closed.
Given another Euclidean space Y, we call a map A : E →Y linear
if any points x and z in E and any reals λ and µ satisfy A(λx + µz) =
λAx + µAz. In fact any linear function from E to R has the form ⟨a, ·⟩
for some element a of E. Linear maps and aﬃne functions (linear functions
plus constants) are continuous.
Thus, for example, closed halfspaces are
indeed closed. A polyhedron is a ﬁnite intersection of closed halfspaces, and
is therefore both closed and convex. The adjoint of the map A above is the
linear map A∗: Y →E deﬁned by the property
⟨A∗y, x⟩= ⟨y, Ax⟩,
for all points x in E and y in Y
(whence A∗∗= A). The null space of A is N(A) = {x ∈E | Ax = 0}. The
inverse image of a set H ⊂Y is the set A−1H = {x ∈E | Ax ∈H} (so

10
Background
for example N(A) = A−1{0}). Given a subspace G of E, the orthogonal
complement of G is the subspace
G⊥= {y ∈E | ⟨x, y⟩= 0 for all x ∈G},
so called because we can write E as a direct sum G ⊕G⊥. (In other words,
any element of E can be written uniquely as the sum of an element of G and
an element of G⊥.) Any subspace satisﬁes G⊥⊥= G. The range of any linear
map A coincides with N(A∗)⊥.
Optimization studies properties of minimizers and maximizers of func-
tions. Given a set Λ ⊂R, the inﬁmum of Λ (written inf Λ) is the greatest
lower bound on Λ, and the supremum (written sup Λ) is the least upper
bound. To ensure these are always deﬁned, it is natural to append −∞and
+∞to the real numbers, and allow their use in the usual notation for open
and closed intervals. Hence inf ∅= +∞and sup ∅= −∞, and for example
(−∞, +∞] denotes the interval R ∪{+∞}. We try to avoid the appearance
of +∞−∞, but when necessary we use the convention +∞−∞= +∞, so
that any two sets C and D in R satisfy inf C + inf D = inf(C + D). We also
adopt the conventions 0 · (±∞) = (±∞) · 0 = 0. A (global) minimizer of a
function f : D →R is a point ¯x in D at which f attains its inﬁmum
inf
D f = inf f(D) = inf{f(x) | x ∈D}.
In this case we refer to ¯x as an optimal solution of the optimization problem
infD f.
For a positive real δ and a function g : (0, δ) →R, we deﬁne
lim inf
t↓0
g(t)
=
lim
t↓0 inf
(0,t) g,
and
lim sup
t↓0
g(t)
=
lim
t↓0 sup
(0,t)
g.
The limit limt↓0 g(t) exists if and only if the above expressions are equal.
The question of the existence of an optimal solution for an optimization
problem is typically topological. The following result is a prototype. The
proof is a standard application of the Bolzano-Weierstrass theorem above.
Proposition 1.1.3 (Weierstrass) Suppose that the set D ⊂E is nonempty
and closed, and that all the level sets of the continuous function f : D →R
are bounded. Then f has a global minimizer.

§1.1
Euclidean spaces
11
Just as for sets, convexity of functions will be crucial for us. Given a
convex set C ⊂E, we say that the function f : C →R is convex if
f(λx + (1 −λ)y) ≤λf(x) + (1 −λ)f(y)
for all points x and y in C and 0 ≤λ ≤1.
The function f is strictly
convex if the inequality holds strictly whenever x and y are distinct in C and
0 < λ < 1. It is easy to see that a strictly convex function can have at most
one minimizer.
Requiring the function f to have bounded level sets is a ‘growth condi-
tion’. Another example is the stronger condition
lim inf
∥x∥→∞
f(x)
∥x∥

= lim
r→+∞inf
 f(x)
∥x∥
 0 ̸= x ∈C ∩rB

> 0.
(1.1.4)
Surprisingly, for convex functions these two growth conditions are equivalent.
Proposition 1.1.5 For a convex set C ⊂E, a convex function f : C →R
has bounded level sets if and only if it satisﬁes the growth condition (1.1.4).
The proof is outlined in Exercise 10.
Exercises and commentary
Good general references are [156] for elementary real analysis and [1] for linear
algebra. Separation theorems for convex sets originate with Minkowski [129].
The theory of the relative interior (Exercises 11, 12, and 13) is developed
extensively in [149] (which is also a good reference for the recession cone,
Exercise 6).
1. Prove the intersection of an arbitrary collection of convex sets is convex.
Deduce that the convex hull of a set D ⊂E is well-deﬁned as the
intersection of all convex sets containing D.
2.
(a) Prove that if the set C ⊂E is convex and if x1, x2, . . . , xm ∈C,
0 ≤λ1, λ2, . . ., λm ∈R and  λi = 1 then  λixi ∈C. Prove fur-
thermore that if f : C →R is a convex function then f(
 λixi) ≤
 λif(xi).

12
Background
(b) We see later (Theorem 3.1.11) that the function −log is convex on
the strictly positive reals. Deduce, for any strictly positive reals
x1, x2, . . ., xm, and any nonnegative reals λ1, λ2, . . . , λm with sum
1, the arithmetic-geometric mean inequality

i
λixi ≥
	
i
(xi)λi.
(c) Prove that for any set D ⊂E, conv D is the set of all convex
combinations of elements of D.
3. Prove that a convex set D ⊂E has convex closure, and deduce that
cl (conv D) is the smallest closed convex set containing D.
4. (Radstrom cancellation) Suppose sets A, B, C ⊂E satisfy
A + C ⊂B + C.
(a) If A and B are convex, B is closed, and C is bounded, prove
A ⊂B.
(Hint: observe 2A + C = A + (A + C) ⊂2B + C.)
(b) Show this result can fail if B is not convex.
5. ∗(Strong separation) Suppose that the set C ⊂E is closed and
convex, and that the set D ⊂E is compact and convex.
(a) Prove the set D −C is closed and convex.
(b) Deduce that if in addition D and C are disjoint then there exists a
nonzero element a in E with infx∈D⟨a, x⟩> supy∈C⟨a, y⟩. Interpret
geometrically.
(c) Show part (b) fails for the closed convex sets in R2,
D
=
{x | x1 > 0, x1x2 ≥1},
C
=
{x | x2 = 0}.
6. ∗∗(Recession cones) Consider a nonempty closed convex set C ⊂E.
We deﬁne the recession cone of C by
0+(C) = {d ∈E | C + R+d ⊂C}.

§1.1
Euclidean spaces
13
(a) Prove 0+(C) is a closed convex cone.
(b) Prove d ∈0+(C) if and only if x + R+d ⊂C for some point x in
C. Show this equivalence can fail if C is not closed.
(c) Consider a family of closed convex sets Cγ (γ ∈Γ) with nonempty
intersection. Prove 0+(∩Cγ) = ∩0+(Cγ).
(d) For a unit vector u in E, prove u ∈0+(C) if and only if there
is a sequence (xr) in C satisfying ∥xr∥→∞and ∥xr∥−1xr →u.
Deduce C is unbounded if and only if 0+(C) is nontrivial.
(e) If Y is a Euclidean space, the map A : E →Y is linear, and
N(A) ∩0+(C) is a linear subspace, prove AC is closed. Show this
result can fail without the last assumption.
(f) Consider another nonempty closed convex set D ⊂E such that
0+(C) ∩0+(D) is a linear subspace. Prove C −D is closed.
7. For any set of vectors a1, a2, . . ., am in E, prove the function f(x) =
maxi⟨ai, x⟩is convex on E.
8. Prove Proposition 1.1.3 (Weierstrass).
9. (Composing convex functions) Suppose that the set C ⊂E is
convex and that the functions f1, f2, . . . , fn : C →R are convex, and
deﬁne a function f : C →Rn with components fi. Suppose further
that f(C) is convex and that the function g : f(C) →R is convex
and isotone: any points y ≤z in f(C) satisfy g(y) ≤g(z). Prove the
composition g ◦f is convex.
10. ∗(Convex growth conditions)
(a) Find a function with bounded level sets which does not satisfy the
growth condition (1.1.4).
(b) Prove that any function satisfying (1.1.4) has bounded level sets.
(c) Suppose the convex function f : C →R has bounded level sets
but that (1.1.4) fails. Deduce the existence of a sequence (xm) in
C with f(xm) ≤∥xm∥/m →+∞. For a ﬁxed point ¯x in C, derive
a contradiction by considering the sequence
¯x + (∥xm∥/m)−1(xm −¯x).
Hence complete the proof of Proposition 1.1.5.

14
Background
The relative interior
Some arguments about ﬁnite-dimensional convex sets C simplify and
lose no generality if we assume C contains 0 and spans E. The following
exercises outline this idea.
11. ∗∗(Accessibility lemma) Suppose C is a convex set in E.
(a) Prove cl C ⊂C + ϵB for any real ϵ > 0.
(b) For sets D and F in E with D open, prove D + F is open.
(c) For x in int C and 0 < λ ≤1, prove λx+(1−λ)cl C ⊂C. Deduce
λint C + (1 −λ)cl C ⊂int C.
(d) Deduce int C is convex.
(e) Deduce further that if int C is nonempty then cl (int C) = cl C. Is
convexity necessary?
12. ∗∗(Aﬃne sets) A set L in E is aﬃne if the entire line through any
distinct points x and y in L lies in L: algebraically, λx+(1−λ)y ∈L for
any real λ. The aﬃne hull of a set D in E, denoted aﬀD, is the smallest
aﬃne set containing D. An aﬃne combination of points x1, x2, . . . , xm
is a point of the form m
1 λixi, for reals λi summing to 1.
(a) Prove the intersection of an arbitrary collection of aﬃne sets is
aﬃne.
(b) Prove that a set is aﬃne if and only if it is a translate of a linear
subspace.
(c) Prove aﬀD is the set of all aﬃne combinations of elements of D.
(d) Prove cl D ⊂aﬀD and deduce aﬀD = aﬀ(cl D).
(e) For any point x in D, prove aﬀD = x + span (D −x), and deduce
the linear subspace span (D −x) is independent of x.
13. ∗∗(The relative interior) (We use Exercises 12 and 11.) The relative
interior of a convex set C in E is its interior relative to its aﬃne hull,
aﬀC, denoted ri C. In other words, a point x lies in ri C if there is a
real δ > 0 with (x + δB) ∩aﬀC ⊂C.
(a) Find convex sets C1 ⊂C2 with ri C1 ̸⊂ri C2.

§1.1
Euclidean spaces
15
(b) Suppose dim E > 0, 0 ∈C and aﬀC = E. Prove C contains
a basis {x1, x2, . . . , xn} of E. Deduce (1/(n + 1)) n
1 xi ∈int C.
Hence deduce that any nonempty convex set in E has nonempty
relative interior.
(c) Prove that for 0 < λ ≤1 we have λri C + (1 −λ)cl C ⊂ri C, and
hence ri C is convex with cl (ri C) = cl C.
(d) Prove that for a point x in C, the following are equivalent:
(i) x ∈ri C.
(ii) For any point y in C there exists a real ϵ > 0 with x+ϵ(x−y)
in C.
(iii) R+(C −x) is a linear subspace.
(e) If F is another Euclidean space and the map A : E →F is linear,
prove ri AC ⊃Ari C.

16
Background
1.2
Symmetric matrices
Throughout most of this book our setting is an abstract Euclidean space
E. This has a number of advantages over always working in Rn: the basis-
independent notation is more elegant and often clearer, and it encourages
techniques which extend beyond ﬁnite dimensions.
But more concretely,
identifying E with Rn may obscure properties of a space beyond its simple
Euclidean structure.
As an example, in this short section we describe a
Euclidean space which ‘feels’ very diﬀerent from Rn: the space Sn of n × n
real symmetric matrices.
The nonnegative orthant Rn
+ is a cone in Rn which plays a central role in
our development. In a variety of contexts the analogous role in Sn is played
by the cone of positive semideﬁnite matrices, Sn
+. These two cones have some
important diﬀerences: in particular, Rn
+ is a polyhedron whereas the cone of
positive semideﬁnite matrices Sn
+ is not, even for n = 2. The cones Rn
+ and
Sn
+ are important largely because of the orderings they induce. (The latter is
sometimes called the Loewner ordering.) For points x and y in Rn we write
x ≤y if y −x ∈Rn
+, and x < y if y −x ∈Rn
++ (with analogous deﬁnitions
for ≥and >). The cone Rn
+ is a lattice cone: for any points x and y in Rn
there is a point z satisfying
w ≥x and w ≥y ⇔w ≥z.
(The point z is just the componentwise maximum of x and y.) Analogously,
for matrices X and Y in Sn we write X ⪯Y if Y −X ∈Sn
+, and X ≺Y
if Y −X lies in Sn
++, the set of positive deﬁnite matrices (with analogous
deﬁnitions for ⪰and ≻). By contrast, Sn
+ is not a lattice cone (see Exercise
4).
We denote the identity matrix by I. The trace of a square matrix Z is
the sum of the diagonal entries, written tr Z. It has the important property
tr (V W) = tr (WV ) for any matrices V and W for which V W is well-deﬁned
and square. We make the vector space Sn into a Euclidean space by deﬁning
the inner product
⟨X, Y ⟩= tr (XY ),
for X, Y ∈Sn.
Any matrix X in Sn has n real eigenvalues (counted by multiplicity),
which we write in nonincreasing order λ1(X) ≥λ2(X) ≥. . . ≥λn(X). In
this way we deﬁne a function λ : Sn →Rn. We also deﬁne a linear map

§1.2
Symmetric matrices
17
Diag : Rn →Sn, where for a vector x in Rn, Diag x is an n × n diagonal
matrix with diagonal entries xi. This map embeds Rn as a subspace of Sn
and the cone Rn
+ as a subcone of Sn
+. The determinant of a square matrix Z
is written det Z.
We write On for the group of n × n orthogonal matrices (those matrices
U satisfying UTU = I). Then any matrix X in Sn has an ordered spectral
decomposition X = UT(Diag λ(X))U, for some matrix U in On. This shows,
for example, that the function λ is norm-preserving: ∥X∥= ∥λ(X)∥for all
X in Sn. For any X in Sn
+, the spectral decomposition also shows there is a
unique matrix X1/2 in Sn
+ whose square is X.
The Cauchy-Schwarz inequality has an interesting reﬁnement in Sn which
is crucial for variational properties of eigenvalues, as we shall see.
Theorem 1.2.1 (Fan) Any matrices X and Y in Sn satisfy the inequality
tr (XY ) ≤λ(X)Tλ(Y ).
(1.2.2)
Equality holds if and only if X and Y have a simultaneous ordered spec-
tral decomposition: there is a matrix U in On with
X = UT(Diag λ(X))U
and Y = UT(Diag λ(Y ))U.
(1.2.3)
A standard result in linear algebra states that matrices X and Y have a
simultaneous (unordered) spectral decomposition if and only if they commute.
Notice condition (1.2.3) is a stronger property.
The special case of Fan’s inequality where both matrices are diagonal
gives the following classical inequality. For a vector x in Rn, we denote by
[x] the vector with the same components permuted into nonincreasing order.
We leave the proof of this result as an exercise.
Proposition 1.2.4 (Hardy-Littlewood-Polya) Any vectors x and y in
Rn satisfy the inequality
xTy ≤[x]T[y].
We describe a proof of Fan’s Theorem in the exercises, using the above propo-
sition and the following classical relationship between the set Γn of doubly
stochastic matrices (square matrices with all nonnegative entries, and each
row and column summing to 1) and the set Pn of permutation matrices
(square matrices with all entries 0 or 1, and with exactly one entry 1 in each
row and in each column).

18
Background
Theorem 1.2.5 (Birkhoﬀ) Any doubly stochastic matrix is a convex com-
bination of permutation matrices.
We defer the proof to a later section (§4.1, Exercise 22).
Exercises and commentary
Fan’s inequality (1.2.2) appeared in [65], but is closely related to earlier work
of von Neumann [163]. The condition for equality is due to [159]. The Hardy-
Littlewood-Polya inequality may be found in [82]. Birkhoﬀ’s theorem [14]
was in fact proved earlier by K¨onig [104].
1. Prove Sn
+ is a closed convex cone, with interior Sn
++.
2. Explain why S2
+ is not a polyhedron.
3. (S3
+ is not strictly convex) Find nonzero matrices X and Y in S3
+
such that R+X ̸= R+Y and (X + Y )/2 ̸∈S3
++.
4. (A non-lattice ordering) Suppose the matrix Z in S2 satisﬁes
W ⪰

1
0
0
0

and W ⪰

0
0
0
1

⇔
W ⪰Z.
(a) By considering diagonal W, prove
Z =

1
a
a
1

for some real a.
(b) By considering W = I, prove Z = I.
(c) Derive a contradiction by considering
W = (2/3)

2
1
1
2

.
5. (Order preservation)
(a) Prove any matrix X in Sn satisﬁes (X2)1/2 ⪰X.

§1.2
Symmetric matrices
19
(b) Find matrices X ⪰Y in S2
+ such that X2 ̸⪰Y 2.
(c) For matrices X ⪰Y in Sn
+, prove X1/2 ⪰Y 1/2. Hint: consider
the relationship
⟨(X1/2 + Y 1/2)x, (X1/2 −Y 1/2)x⟩= ⟨(X −Y )x, x⟩≥0,
for eigenvectors x of X1/2 −Y 1/2.
6. ∗(Square-root iteration) Suppose a matrix A in Sn
+ satisﬁes I ⪰A.
Prove that the iteration
Y0 = 0,
Yn+1 = (A + Y 2
n )/2
(n = 0, 1, 2, . . .)
is nondecreasing (that is, Yn+1 ⪰Yn for all n), and converges to the
matrix I −(I −A)1/2. (Hint: consider diagonal matrices A.)
7. (The Fan and Cauchy-Schwarz inequalities)
(a) For any matrices X in Sn and U in On, prove ∥UTXU∥= ∥X∥.
(b) Prove the function λ is norm-preserving.
(c) Hence explain why Fan’s inequality is a reﬁnement of the Cauchy-
Schwarz inequality.
8. Prove the inequality tr Z + tr Z−1 ≥2n for all matrices Z in Sn
++, with
equality if and only if Z = I.
9. Prove the Hardy-Littlewood-Polya inequality (Proposition 1.2.4) di-
rectly.
10. Given a vector x in Rn
+ satisfying x1x2 . . . xn = 1, deﬁne numbers
yk = 1/x1x2 . . . xk for each index k = 1, 2, . . ., n. Prove
x1 + x2 + . . . + xn = yn
y1
+ y1
y2
+ . . . yn−1
yn
.
By applying the Hardy-Littlewood-Polya inequality (1.2.4) to suitable
vectors, prove x1 + x2 + . . . + xn ≥n. Deduce the inequality
1
n
n

1
zi ≥
 n
	
1
zi
1/n
for any vector z in Rn
+.

20
Background
11. For a ﬁxed column vector s in Rn, deﬁne a linear map A : Sn →Rn by
setting AX = Xs for any matrix X in Sn. Calculate the adjoint map
A∗.
12. ∗(Fan’s inequality) For vectors x and y in Rn and a matrix U in
On, deﬁne
α = ⟨Diag x, UT(Diag y)U⟩.
(a) Prove α = xTZy for some doubly stochastic matrix Z.
(b) Use Birkhoﬀ’s theorem and Proposition 1.2.4 to deduce the in-
equality α ≤[x]T[y].
(c) Deduce Fan’s inequality (1.2.2).
13. (A lower bound) Use Fan’s inequality (1.2.2) for two matrices X and
Y in Sn to prove a lower bound for tr (XY ) in terms of λ(X) and λ(Y ).
14. ∗(Level sets of perturbed log barriers)
(a) For δ in R++, prove the function
t ∈R++ →δt −log t
has compact level sets.
(b) For c in Rn
++, prove the function
x ∈Rn
++ →cTx −
n

i=1
log xi
has compact level sets.
(c) For C in Sn
++, prove the function
X ∈Sn
++ →⟨C, X⟩−log det X
has compact level sets. (Hint: use Exercise 13.)
15. ∗(Theobald’s condition) Assuming Fan’s inequality (1.2.2), com-
plete the proof of Fan’s Theorem (1.2.1) as follows. Suppose equality
holds in Fan’s inequality (1.2.2), and choose a spectral decomposition
X + Y = UT(Diag λ(X + Y ))U
for some matrix U in On.

§1.2
Symmetric matrices
21
(a) Prove λ(X)Tλ(X + Y ) = ⟨UT(Diag λ(X))U, X + Y ⟩.
(b) Apply Fan’s inequality (1.2.2) to the two inner products
⟨X, X + Y ⟩and ⟨UT(Diag λ(X))U, Y ⟩
to deduce X = UT(Diag λ(X))U.
(c) Deduce Fan’s theorem.
16. ∗∗(Generalizing Theobald’s condition [111]) Let X1, X2, . . . , Xm
be matrices in Sn satisfying the conditions
tr (XiXj) = λ(Xi)Tλ(Xj) for all i and j.
Generalize the argument of Exercise 15 to prove the entire set of matri-
ces {X1, X2, . . . , Xm} has a simultaneous ordered spectral decomposi-
tion.
17. ∗∗(Singular values and von Neumann’s lemma) Let Mn denote
the vector space of n×n real matrices. For a matrix A in Mn we deﬁne
the singular values of A by σi(A) =

λi(ATA) for i = 1, 2, . . . , n, and
hence deﬁne a map σ : Mn →Rn. (Notice 0 may be a singular value.)
(a) Prove
λ

0
AT
A
0

=

σ(A)
[−σ(A)]

(b) For any other matrix B in Mn, use part (a) and Fan’s inequality
(1.2.2) to prove
tr (ATB) ≤σ(A)Tσ(B).
(c) If A lies in Sn
+, prove λ(A) = σ(A).
(d) By considering matrices of the form A + αI and B + βI, deduce
Fan’s inequality from von Neumann’s lemma (part (b)).

Chapter 2
Inequality constraints
2.1
Optimality conditions
Early in multivariate calculus we learn the signiﬁcance of diﬀerentiability
in ﬁnding minimizers. In this section we begin our study of the interplay
between convexity and diﬀerentiability in optimality conditions.
For an initial example, consider the problem of minimizing a function
f : C →R on a set C in E. We say a point ¯x in C is a local minimizer
of f on C if f(x) ≥f(¯x) for all points x in C close to ¯x. The directional
derivative of a function f at ¯x in a direction d ∈E is
f ′(¯x; d) = lim
t↓0
f(¯x + td) −f(¯x)
t
,
when this limit exists. When the directional derivative f ′(¯x; d) is actually
linear in d (that is, f ′(¯x; d) = ⟨a, d⟩for some element a of E) then we say f
is (Gˆateaux) diﬀerentiable at ¯x, with (Gˆateaux) derivative ∇f(¯x) = a. If f is
diﬀerentiable at every point in C then we simply say f is diﬀerentiable (on C).
An example we use quite extensively is the function X ∈Sn
++ →log det X:
an exercise shows this function is diﬀerentiable on Sn
++ with derivative X−1.
A convex cone which arises frequently in optimization is the normal cone
to a convex set C at a point ¯x ∈C, written NC(¯x). This is the convex cone
of normal vectors: vectors d in E such that ⟨d, x −¯x⟩≤0 for all points x in
C.
Proposition 2.1.1 (First order necessary condition) Suppose that C is
a convex set in E, and that the point ¯x is a local minimizer of the function
22

§2.1
Optimality conditions
23
f : C →R. Then for any point x in C, the directional derivative, if it exists,
satisﬁes f ′(¯x; x −¯x) ≥0. In particular, if f is diﬀerentiable at ¯x then the
condition −∇f(¯x) ∈NC(¯x) holds.
Proof.
If some point x in C satisﬁes f ′(¯x; x −¯x) < 0 then all small real
t > 0 satisfy f(¯x+t(x−¯x)) < f(¯x), but this contradicts the local minimality
of ¯x.
♠
The case of this result where C is an open set is the canonical introduction
to the use of calculus in optimization: local minimizers ¯x must be critical
points (that is, ∇f(¯x) = 0). This book is largely devoted to the study of
ﬁrst order necessary conditions for a local minimizer of a function subject to
constraints. In that case local minimizers ¯x may not lie in the interior of the
set C of interest, so the normal cone NC(¯x) is not simply {0}.
The next result shows that when f is convex the ﬁrst order condition
above is suﬃcient for ¯x to be a global minimizer of f on C.
Proposition 2.1.2 (First order suﬃcient condition) Suppose that the
set C ⊂E is convex and that the function f : C →R is convex. Then
for any points ¯x and x in C, the directional derivative f ′(¯x; x −¯x) exists
in [−∞, +∞). If the condition f ′(¯x; x −¯x) ≥0 holds for all x in C, or
in particular if the condition −∇f(¯x) ∈NC(¯x) holds, then ¯x is a global
minimizer of f on C.
Proof. A straightforward exercise using the convexity of f shows the func-
tion
t ∈(0, 1] →f(¯x + t(x −¯x)) −f(¯x)
t
is nondecreasing. The result then follows easily (Exercise 7).
♠
In particular, any critical point of a convex function is a global minimizer.
The following useful result illustrates what the ﬁrst order conditions be-
come for a more concrete optimization problem. The proof is outlined in
Exercise 4.
Corollary 2.1.3 (First order conditions for linear constraints) Given
a convex set C ⊂E, a function f : C →R, a linear map A : E →Y

24
Inequality constraints
(where Y is a Euclidean space) and a point b in Y, consider the optimization
problem
inf{f(x) | x ∈C, Ax = b}.
(2.1.4)
Suppose the point ¯x ∈int C satisﬁes A¯x = b.
(a) If ¯x is a local minimizer for the problem (2.1.4) and f is diﬀerentiable
at ¯x then ∇f(¯x) ∈A∗Y.
(b) Conversely, if ∇f(¯x) ∈A∗Y and f is convex then ¯x is a global mini-
mizer for (2.1.4).
The element y ∈Y satisfying ∇f(¯x) = A∗y in the above result is called a
Lagrange multiplier. This kind of construction recurs in many diﬀerent forms
in our development.
In the absence of convexity, we need second order information to tell us
more about minimizers. The following elementary result from multivariate
calculus is typical.
Theorem 2.1.5 (Second order conditions) Suppose the twice continu-
ously diﬀerentiable function f : Rn →R has a critical point ¯x. If ¯x is a local
minimizer then the Hessian ∇2f(¯x) is positive semideﬁnite. Conversely, if
the Hessian is positive deﬁnite then ¯x is a local minimizer.
(In fact for ¯x to be a local minimizer it is suﬃcient for the Hessian to be
positive semideﬁnite locally: the function x ∈R →x4 highlights the distinc-
tion.)
To illustrate the eﬀect of constraints on second order conditions, consider
the framework of Corollary 2.1.3 (First order conditions for linear constraints)
in the case E = Rn, and suppose ∇f(¯x) ∈A∗Y and f is twice continuously
diﬀerentiable near ¯x. If ¯x is a local minimizer then yT∇2f(¯x)y ≥0 for all
vectors y in N(A). Conversely, if yT∇2f(¯x)y > 0 for all nonzero y in N(A)
then ¯x is a local minimizer.
We are already beginning to see the broad interplay between analytic,
geometric and topological ideas in optimization theory. A good illustration
is the separation result of §1.1, which we now prove.
Theorem 2.1.6 (Basic separation) Suppose that the set C ⊂E is closed
and convex, and that the point y does not lie in C. Then there exist a real b
and a nonzero element a of E such that ⟨a, y⟩> b ≥⟨a, x⟩for all points x in
C.

§2.1
Optimality conditions
25
Proof. We may assume C is nonempty, and deﬁne a function f : E →R by
f(x) = ∥x−y∥2/2. Now by the Weierstrass proposition (1.1.3) there exists a
minimizer ¯x for f on C, which by the First order necessary condition (2.1.1)
satisﬁes −∇f(¯x) = y −¯x ∈NC(¯x). Thus ⟨y −¯x, x −¯x⟩≤0 holds for all
points x in C. Now setting a = y −¯x and b = ⟨y −¯x, ¯x⟩gives the result. ♠
We end this section with a rather less standard result, illustrating an-
other idea which is important later: the use of ‘variational principles’ to
treat problems where minimizers may not exist, but which nonetheless have
‘approximate’ critical points. This result is a precursor of a principle due to
Ekeland, which we develop in §7.1.
Proposition 2.1.7 If the function f : E →R is diﬀerentiable and bounded
below then there are points where f has small derivative.
Proof. Fix any real ϵ > 0. The function f + ϵ∥· ∥has bounded level sets,
so has a global minimizer xϵ by the Weierstrass Proposition (1.1.3). If the
vector d = ∇f(xϵ) satisﬁes ∥d∥> ϵ then from the inequality
lim
t↓0
f(xϵ −td) −f(xϵ)
t
= −⟨∇f(xϵ), d⟩= −∥d∥2 < −ϵ∥d∥,
we would have, for small t > 0, the contradiction
−tϵ∥d∥
>
f(xϵ −td) −f(xϵ)
=
(f(xϵ −td) + ϵ∥xϵ −td∥)
−(f(xϵ) + ϵ∥xϵ∥) + ϵ(∥xϵ∥−∥xϵ −td∥)
≥
−ϵt∥d∥,
by deﬁnition of xϵ, and the triangle inequality. Hence ∥∇f(xϵ)∥≤ϵ.
♠
Notice that the proof relies on consideration of a nondiﬀerentiable func-
tion, even though the result concerns derivatives.
Exercises and commentary
The optimality conditions in this section are very standard (see for example
[119]). The simple variational principle (Proposition 2.1.7) was suggested by
[85].

26
Inequality constraints
1. Prove the normal cone is a closed convex cone.
2. (Examples of normal cones) For the following sets C ⊂E, check C
is convex and compute the normal cone NC(¯x) for points ¯x in C:
(a) C a closed interval in R.
(b) C = B, the unit ball.
(c) C a subspace.
(d) C a closed halfspace: {x | ⟨a, x⟩≤b} where 0 ̸= a ∈E and b ∈R.
(e) C = {x ∈Rn | xj ≥0 for all j ∈J} (for J ⊂{1, 2, . . ., n}).
3. (Self-dual cones) Prove each of the following cones K satisfy the
relationship NK(0) = −K:
(a) Rn
+;
(b) Sn
+;
(c) {x ∈Rn | x1 ≥0, x2
1 ≥x2
2 + x2
3 + . . . + x2
n}.
4. (Normals to aﬃne sets) Given a linear map A : E →Y (where Y
is a Euclidean space) and a point b in Y, prove the normal cone to the
set {x ∈E|Ax = b} at any point in it is A∗Y . Hence deduce Corollary
2.1.3 (First order conditions for linear constraints).
5. Prove that the diﬀerentiable function x2
1 + x2
2(1 −x1)3 has a unique
critical point in R2, which is a local minimizer, but has no global
minimizer. Can this happen on R?
6. (The Rayleigh quotient)
(a) Let the function f : Rn \ {0} →R be continuous, satisfying
f(λx) = f(x) for all λ > 0 in R and nonzero x in Rn. Prove f
has a minimizer.
(b) Given a matrix A in Sn, deﬁne a function g(x) = xTAx/∥x∥2 for
nonzero x in Rn. Prove g has a minimizer.
(c) Calculate ∇g(x) for nonzero x.
(d) Deduce that minimizers of g must be eigenvectors, and calculate
the minimum value.

§2.1
Optimality conditions
27
(e) Find an alternative proof of part (d) by using a spectral decom-
position of A.
(Note: another approach to this problem is given in §7.2, Exercise 6.)
7. Suppose a convex function g : [0, 1] →R satisﬁes g(0) = 0. Prove the
function t ∈(0, 1] →g(t)/t is nondecreasing. Hence prove that for a
convex function f : C →R and points ¯x, x ∈C ⊂E, the quotient
(f(¯x + t(x −¯x)) −f(¯x))/t is nondecreasing as a function of t in (0, 1],
and complete the proof of Proposition 2.1.2.
8. ∗(Nearest points)
(a) Prove that if a function f : C →R is strictly convex then it has
at most one global minimizer on C.
(b) Prove the function f(x) = ∥x −y∥2/2 is strictly convex on E for
any point y in E.
(c) Suppose C is a nonempty, closed convex subset of E.
(i) If y is any point in E, prove there is a unique nearest point
PC(y) to y in C, characterized by
⟨y −PC(y), x −PC(y)⟩≤0,
for all x ∈C.
(ii) For any point ¯x in C, deduce that d ∈NC(¯x) holds if and
only if ¯x is the nearest point in C to ¯x + d.
(iii) Deduce furthermore that any points y and z in E satisfy
∥PC(y) −PC(z)∥≤∥y −z∥,
so in particular the projection PC : E →C is continuous.
(d) Given a nonzero element a of E, calculate the nearest point in the
subspace {x ∈E | ⟨a, x⟩= 0} to the point y ∈E.
(e) (Projection on Rn
+ and Sn
+) Prove the nearest point in Rn
+ to
a vector y in Rn is y+, where y+
i
= max{yi, 0} for each i. For
a matrix U in On and a vector y in Rn, prove that the nearest
positive semideﬁnite matrix to UTDiag yU is UTDiag y+U.

28
Inequality constraints
9. ∗(Coercivity) Suppose that the function f : E →R is diﬀerentiable
and satisﬁes the growth condition lim∥x∥→∞f(x)/∥x∥= +∞. Prove
that the gradient map ∇f has range E. (Hint: minimize the function
f(·) −⟨a, ·⟩for elements a of E.)
10.
(a) Prove the function f : Sn
++ →R deﬁned by f(X) = tr X−1 is
diﬀerentiable on Sn
++. (Hint: expand the expression (X + tY )−1
as a power series.)
(b) Consider the function f : Sn
++ →R deﬁned by f(X) = log det X.
Prove ∇f(I) = I. Deduce ∇f(X) = X−1 for any X in Sn
++.
11. ∗∗(Kirchhoﬀ’s law [8, Chapter 1]) Consider a ﬁnite, undirected,
connected graph with vertex set V and edge set E. Suppose that α and
β in V are distinct vertices and that each edge ij in E has an associated
‘resistance’ rij > 0 in R. We consider the eﬀect of applying a unit
‘potential diﬀerence’ between the vertices α and β. Let V0 = V \{α, β},
and for ‘potentials’ x in RV0 we deﬁne the ‘power’ p : RV0 →R by
p(x) =

ij∈E
(xi −xj)2/2rij,
where we set xα = 0 and xβ = 1.
(a) Prove the power function p has compact level sets.
(b) Deduce the existence of a solution to the following equations (de-
scribing ‘conservation of current’):

j : ij∈E
(xi −xj)/rij
=
0,
for i in V0,
xα
=
0,
xβ
=
1.
(c) Prove the power function p is strictly convex.
(d) Use part (a) of Exercise 8 to show that the conservation of current
equations in part (b) have a unique solution.
12. ∗∗(Matrix completion [77]) For a set ∆⊂{(i, j) | 1 ≤i ≤j ≤n},
suppose the subspace L ⊂Sn of matrices with (i, j)-entry 0 for all (i, j)
in ∆satisﬁes L ∩Sn
++ ̸= ∅. By considering the problem (for C ∈Sn
++)
inf{⟨C, X⟩−log det X | X ∈L ∩Sn
++},

§2.1
Optimality conditions
29
use §1.2, Exercise 14 and Corollary 2.1.3 (First order conditions for
linear constraints) to prove there exists a matrix X in L ∩Sn
++ with
C −X−1 having (i, j)-entry 0 for all (i, j) not in ∆.
13. ∗∗(BFGS update, c.f. [71]) Given a matrix C in Sn
++ and vectors s
and y in Rn satisfying sTy > 0, consider the problem
⎧
⎪
⎨
⎪
⎩
inf
⟨C, X⟩−log det X
subject to
Xs = y
X ∈Sn
++.
(a) Prove that for the problem above, the point
X = (y −δs)(y −δs)T
sT(y −δs)
+ δI
is feasible for small δ > 0.
(b) Prove the problem has an optimal solution using §1.2, Exercise
14.
(c) Use Corollary 2.1.3 (First order conditions for linear constraints)
to ﬁnd the solution. (Aside: the solution is called the BFGS update
of C−1 under the secant condition Xs = y.)
(See also [56, p. 205].)
14. ∗∗Suppose intervals I1, I2, . . . , In ⊂R are nonempty and closed and
the function f : I1 × I2 × . . . × In →R is diﬀerentiable and bounded
below. Use the idea of the proof of Proposition 2.1.7 to prove that for
any ϵ > 0 there exists a point xϵ ∈I1 × I2 × . . . × In satisfying
(−∇f(xϵ))j ∈NIj(xϵ
j) + [−ϵ, ϵ] (j = 1, 2, . . ., n).
15. ∗(Nearest polynomial with a given root) Consider the Euclidean
space of complex polynomials of degree no more than n, with inner
product
 n

j=0
xjzj ,
n

j=0
yjzj

=
n

j=0
xjyj.
Given a polynomial p in this space, calculate the nearest polynomial
with a given complex root α, and prove the distance to this polynomial
is (n
j=0 |α|2j)(−1/2)|p(α)|.

30
Inequality constraints
2.2
Theorems of the alternative
One well-trodden route to the study of ﬁrst order conditions uses a class
of results called ‘theorems of the alternative’, and in particular the Farkas
lemma (which we derive at the end of this section).
Our ﬁrst approach,
however, relies on a diﬀerent theorem of the alternative.
Theorem 2.2.1 (Gordan) For any elements a0, a1, . . ., am of E, exactly
one of the following systems has a solution:
m

i=0
λiai
=
0,
m

i=0
λi = 1,
0 ≤λ0, λ1, . . ., λm ∈R;
(2.2.2)
⟨ai, x⟩
<
0 for i = 0, 1, . . ., m,
x ∈E.
(2.2.3)
Geometrically, Gordan’s theorem says that 0 does not lie in the convex hull of
the set {a0, a1, . . . , am} if and only if there is an open halfspace {y | ⟨y, x⟩< 0}
containing {a0, a1, . . . , am} (and hence its convex hull). This is another illus-
tration of the idea of separation (in this case we separate 0 and the convex
hull).
Theorems of the alternative like Gordan’s theorem may be proved in a
variety of ways, including separation and algorithmic approaches. We em-
ploy a less standard technique, using our earlier analytic ideas, and leading
to a rather uniﬁed treatment. It relies on the relationship between the opti-
mization problem
inf{f(x) | x ∈E},
(2.2.4)
where the function f is deﬁned by
f(x) = log
 m

i=0
exp⟨ai, x⟩

,
(2.2.5)
and the two systems (2.2.2) and (2.2.3). We return to the surprising function
(2.2.5) when we discuss conjugacy in §3.3.
Theorem 2.2.6 The following statements are equivalent:
(i) The function deﬁned by (2.2.5) is bounded below.
(ii) System (2.2.2) is solvable.
(iii) System (2.2.3) is unsolvable.

§2.2
Theorems of the alternative
31
Proof. The implications (ii) ⇒(iii) ⇒(i) are easy exercises, so it remains
to show (i) ⇒(ii). To see this we apply Proposition 2.1.7. We deduce that
for each k = 1, 2, . . ., there is a point xk in E satisfying
∥∇f(xk)∥=

m

i=0
λk
i ai
 < 1/k,
where the scalars
λk
i =
exp⟨ai, xk⟩
m
r=0 exp⟨ar, xk⟩> 0
satisfy
m
i=0 λk
i = 1. Now the limit λ of any convergent subsequence of the
the bounded sequence (λk) solves system (2.2.2).
♠
The equivalence of (ii) and (iii) now gives Gordan’s theorem.
We now proceed by using Gordan’s theorem to derive the Farkas lemma,
one of the cornerstones of many approaches to optimality conditions. The
proof uses the idea of the projection onto a linear subspace Y of E. Notice
ﬁrst that Y becomes a Euclidean space by equipping it with the same inner
product. The projection of a point x in E onto Y, written PYx, is simply
the nearest point to x in Y. This is well-deﬁned (see Exercise 8 in §2.1), and
is characterized by the fact that x −PYx is orthogonal to Y. A standard
exercise shows PY is a linear map.
Lemma 2.2.7 (Farkas) For any points a1, a2, . . ., am and c in E, exactly
one of the following systems has a solution:
m

i=1
µiai
=
c,
0 ≤µ1, µ2, . . . , µm ∈R;
(2.2.8)
⟨ai, x⟩
≤
0 for i = 1, 2, . . ., m,
⟨c, x⟩> 0,
x ∈E.
(2.2.9)
Proof.
Again, it is immediate that if system (2.2.8) has a solution then
system (2.2.9) has no solution. Conversely, we assume (2.2.9) has no solution,
and deduce that (2.2.8) has a solution by using induction on the number of
elements m. The result is clear for m = 0.
Suppose then that the result holds in any Euclidean space and for any
set of m −1 elements and any element c. Deﬁne a0 = −c. Applying Gor-
dan’s theorem (2.2.1) to the unsolvability of (2.2.9) shows there are scalars
λ0, λ1, . . ., λm ≥0 in R, not all zero, satisfying λ0c =
m
1 λiai. If λ0 > 0 the
proof is complete, so suppose λ0 = 0 and without loss of generality λm > 0.

32
Inequality constraints
Deﬁne a subspace of E by Y = {y | ⟨am, y⟩= 0}, so by assumption the
system
⟨ai, y⟩≤0 for i = 1, 2, . . ., m −1,
⟨c, y⟩> 0,
y ∈Y,
or equivalently
⟨PYai, y⟩≤0 for i = 1, 2, . . ., m −1,
⟨PYc, y⟩> 0,
y ∈Y,
has no solution.
By the induction hypothesis applied to the subspace Y, there are non-
negative reals µ1, µ2, . . . , µm−1 satisfying m−1
i=1 µiPYai = PYc, so the vector
c −m−1
1
µiai is orthogonal to the subspace Y = (span (am))⊥. Thus some
real µm satisﬁes
µmam = c −
m−1

1
µiai.
(2.2.10)
If µm is nonnegative we immediately obtain a solution of (2.2.8), and if not
then we can substitute am = −λ−1
m
m−1
1
λiai in equation (2.2.10) to obtain
a solution.
♠
Just like Gordan’s theorem, the Farkas lemma has an important geometric
interpretation which gives an alternative approach to its proof (Exercise 6):
any point c not lying in the ﬁnitely generated cone
C =
 m

1
µiai | 0 ≤µ1, µ2, . . ., µm ∈R

(2.2.11)
can be separated from C by a hyperplane. If x solves system (2.2.9) then C
is contained in the closed halfspace {a| ⟨a, x⟩≤0}, whereas c is contained in
the complementary open halfspace. In particular, it follows that any ﬁnitely
generated cone is closed.
Exercises and commentary
Gordan’s theorem appeared in [75], and the Farkas lemma appeared in [67].
The standard modern approach to theorems of the alternative (Exercises 7
and 8, for example) is via linear programming duality (see for example [49]).
The approach we take to Gordan’s theorem was suggested by Hiriart-Urruty
[85]. Schur-convexity (Exercise 9) is discussed extensively in [121].

§2.2
Theorems of the alternative
33
1. Prove the implications (ii) ⇒(iii) ⇒(i) in Theorem 2.2.6.
2.
(a) Prove the orthogonal projection PY : E →Y is a linear map.
(b) Give a direct proof of the Farkas lemma for the case m = 1.
3. Use the Basic separation theorem (2.1.6) to give another proof of Gor-
dan’s theorem.
4. ∗Deduce Gordan’s theorem from the Farkas lemma. (Hint: consider
the elements (ai, 1) of the space E × R.)
5. ∗(Carath´eodory’s theorem [48]) Suppose {ai | i ∈I} is a ﬁnite set
of points in E. For any subset J of I, deﬁne the cone
CJ =

i∈J
µiai | 0 ≤µi ∈R, (i ∈J)

.
(a) Prove the cone CI is the union of those cones CJ for which the set
{ai | i ∈J} is linearly independent. Furthermore, prove directly
that any such cone CJ is closed.
(b) Deduce that any ﬁnitely generated cone is closed.
(c) If the point x lies in conv {ai | i ∈I}, prove that in fact there
is a subset J ⊂I of size at most 1 + dim E such that x lies in
conv {ai | i ∈J}. (Hint: apply part (a) to the vectors (ai, 1) in
E × R.)
(d) Use part (c) to prove that if a subset of E is compact then so is
its convex hull.
6. ∗Give another proof of the Farkas lemma by applying the Basic sepa-
ration theorem (2.1.6) to the set deﬁned by (2.2.11) and using the fact
that any ﬁnitely generated cone is closed.
7. ∗∗(Ville’s theorem) With the function f deﬁned by (2.2.5) (with
E = Rn), consider the optimization problem
inf{f(x) | x ≥0},
(2.2.12)

34
Inequality constraints
and its relationship with the two systems
m

i=0
λiai
≥
0,
m

i=0
λi = 1,
0 ≤λ0, λ1, . . ., λm ∈R,
(2.2.13)
⟨ai, x⟩
<
0 for i = 0, 1, . . . , m,
x ∈Rn
+.
(2.2.14)
Imitate the proof of Gordan’s theorem (using §2.1, Exercise 14) to
prove the following are equivalent:
(i) problem (2.2.12) is bounded below;
(ii) system (2.2.13) is solvable;
(iii) system (2.2.14) is unsolvable.
Generalize by considering the problem inf{f(x) | xj ≥0 (j ∈J)}.
8. ∗∗(Stiemke’s theorem) Consider the optimization problem (2.2.4)
and its relationship with the two systems
m

i=0
λiai
=
0,
0 < λ0, λ1, . . . , λm ∈R,
(2.2.15)
⟨ai, x⟩
≤
0 for i = 0, 1, . . . , m,
not all 0,
x ∈E.
(2.2.16)
Prove the following are equivalent:
(i) problem (2.2.4) has an optimal solution;
(ii) system (2.2.15) is solvable;
(iii) system (2.2.16) is unsolvable.
Hint: complete the following steps.
(a) Prove (i) implies (ii) by Proposition 2.1.1.
(b) Prove (ii) implies (iii).
(c) If problem (2.2.4) has no optimal solution, prove that neither does
the problem
inf
 m

i=0
exp yi | y ∈K

,
(2.2.17)
where K is the subspace {(⟨ai, x⟩)m
i=0 | x ∈E} ⊂Rm+1. Hence by
considering a minimizing sequence for (2.2.17), deduce (2.2.16) is
solvable.

§2.2
Theorems of the alternative
35
Generalize by considering the problem inf{f(x) | xj ≥0 (j ∈J)}.
9. ∗∗(Schur-convexity) The dual cone of the cone Rn
≥is deﬁned by
(Rn
≥)+ = {y ∈Rn | ⟨x, y⟩≥0, for all x in Rn
≥}.
(a) Prove (Rn
≥)+ = {y | j
1 yi ≥0 (j = 1, 2, . . ., n −1), n
1 yi = 0}.
(b) By writing j
1[x]i = maxk⟨ak, x⟩for some suitable set of vectors
ak, prove that the function x →j
1[x]i is convex. (Hint: use §1.1,
Exercise 7.)
(c) Deduce that the function x →[x] is (Rn
≥)+-convex:
λ[x] + (1 −λ)[y] −[λx + (1 −λ)y] ∈(Rn
≥)+ for 0 ≤λ ≤1.
(d) Use Gordan’s theorem and Proposition 1.2.4 to deduce that for
any x and y in Rn
≥, if y−x lies in (Rn
≥)+ then x lies in conv (Pny).
(e) A function f : Rn
≥→R is Schur-convex if
x, y ∈Rn
≥, y −x ∈(Rn
≥)+
⇒
f(x) ≤f(y).
Prove that if f is convex, then it is Schur-convex if and only if it is
the restriction to Rn
≥of a symmetric convex function g : Rn →R
(where by symmetric we mean g(x) = g(Πx) for any x in Rn and
any permutation matrix Π).

36
Inequality constraints
2.3
Max-functions and ﬁrst order conditions
This section is an elementary exposition of the ﬁrst order necessary conditions
for a local minimizer of a diﬀerentiable function subject to diﬀerentiable in-
equality constraints. Throughout this section we use the term ‘diﬀerentiable’
in the Gˆateaux sense, deﬁned in §2.1. Our approach, which relies on consid-
ering the local minimizers of a ‘max-function’
g(x) =
max
i=0,1,...,m{gi(x)},
(2.3.1)
illustrates a pervasive analytic idea in optimization: nonsmoothness. Even if
the functions g0, g1, . . . , gm are smooth, g may not be, and hence the gradient
may no longer be a useful notion.
Proposition 2.3.2 (Directional derivatives of max-functions) Let ¯x
be a point in the interior of a set C ⊂E. Suppose that continuous functions
g0, g1, . . . , gm : C →R are diﬀerentiable at ¯x, that g is the max-function
(2.3.1), and deﬁne the index set K = {i | gi(¯x) = g(¯x)}. Then for all direc-
tions d in E, the directional derivative of g is given by
g′(¯x; d) = max
i∈K {⟨∇gi(¯x), d⟩}.
(2.3.3)
Proof.
By continuity we can assume, without loss of generality, K =
{0, 1, . . ., m}: those gi not attaining the maximum in (2.3.1) will not aﬀect
g′(¯x; d). Now for each i, we have the inequality
lim inf
t↓0
g(¯x + td) −g(¯x)
t
≥lim
t↓0
gi(¯x + td) −gi(¯x)
t
= ⟨∇gi(¯x), d⟩.
Suppose
lim sup
t↓0
g(¯x + td) −g(¯x)
t
> max
i {⟨∇gi(¯x), d⟩}.
Then some real sequence tk ↓0 and real ϵ > 0 satisfy
g(¯x + tkd) −g(¯x)
tk
≥max
i {⟨∇gi(¯x), d⟩} + ϵ,
for all k ∈N
(where N denotes the sequence of natural numbers). We can now choose a
subsequence R of N and a ﬁxed index j so that all integers k in R satisfy
g(¯x + tkd) = gj(¯x + tkd). In the limit we obtain the contradiction
⟨∇gj(¯x), d⟩≥max
i {⟨∇gi(¯x), d⟩} + ϵ.

§2.3
Max-functions and ﬁrst order conditions
37
Hence
lim sup
t↓0
g(¯x + td) −g(¯x)
t
≤max
i {⟨∇gi(¯x), d⟩},
and the result follows.
♠
For most of this book we consider optimization problems of the form
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf
f(x)
subject to
gi(x)
≤
0,
for i ∈I,
hj(x)
=
0,
for j ∈J,
x
∈
C,
(2.3.4)
where C is a subset of E, I and J are ﬁnite index sets, and the objective
function f and inequality and equality constraint functions gi (i ∈I) and
hj (j ∈J) respectively are continuous from C to R.
A point x in C is
feasible if it satisﬁes the constraints, and the set of all feasible x is called the
feasible region. If the problem has no feasible points, we call it inconsistent.
We say a feasible point ¯x is a local minimizer if f(x) ≥f(¯x) for all feasible
x close to ¯x.
We aim to derive ﬁrst order necessary conditions for local
minimizers.
We begin in this section with the diﬀerentiable, inequality constrained
problem
⎧
⎪
⎨
⎪
⎩
inf
f(x)
subject to
gi(x)
≤
0 for i = 1, 2, . . ., m,
x
∈
C.
(2.3.5)
For a feasible point ¯x we deﬁne the active set I(¯x) = {i | gi(¯x) = 0}. For this
problem, assuming ¯x ∈int C, we call a vector λ ∈Rm
+ a Lagrange multiplier
vector for ¯x if ¯x is a critical point of the Lagrangian
L(x; λ) = f(x) +
m

i=1
λigi(x)
(in other words, ∇f(¯x) +  λi∇gi(¯x) = 0) and complementary slackness
holds: λi = 0 for indices i not in I(¯x).
Theorem 2.3.6 (Fritz John conditions) Suppose problem (2.3.5) has a
local minimizer ¯x ∈int C. If the functions f, gi (i ∈I(¯x)) are diﬀerentiable
at ¯x then there exist λ0, λi ∈R+, (i ∈I(¯x)), not all zero, satisfying
λ0∇f(¯x) +

i∈I(¯x)
λi∇gi(¯x) = 0.

38
Inequality constraints
Proof. Consider the function
g(x) = max{f(x) −f(¯x), gi(x) (i ∈I(¯x))}.
Since ¯x is a local minimizer for the problem (2.3.5), it is a local minimizer of
the function g, so all directions d ∈E satisfy the inequality
g′(¯x; d) = max{⟨∇f(¯x), d⟩, ⟨∇gi(¯x), d⟩(i ∈I(¯x))} ≥0,
by the First order necessary condition (2.1.1) and Proposition 2.3.2 (Direc-
tional derivatives of max-functions). Thus the system
⟨∇f(¯x), d⟩< 0,
⟨∇gi(¯x), d⟩< 0 (i ∈I(¯x))
has no solution, and the result follows by Gordan’s theorem (2.2.1).
♠
One obvious disadvantage remains with the Fritz John ﬁrst order condi-
tions above: if λ0 = 0 then the conditions are independent of the objective
function f. To rule out this possibility we need to impose a regularity con-
dition or ‘constraint qualiﬁcation’, an approach which is another recurring
theme. The easiest such condition in this context is simply the linear inde-
pendence of the gradients of the active constraints {∇gi(¯x) | i ∈I(¯x)}. The
culminating result of this section uses the following weaker condition.
Assumption 2.3.7 (The Mangasarian-Fromovitz constraint qualiﬁ-
cation) There is a direction d in E satisfying ⟨∇gi(¯x), d⟩< 0 for all indices
i in the active set I(¯x).
Theorem 2.3.8 (Karush-Kuhn-Tucker conditions) Suppose the prob-
lem (2.3.5) has a local minimizer ¯x in int C.
If the functions f, gi (for
i ∈I(¯x)) are diﬀerentiable at ¯x, and if the Mangasarian-Fromovitz con-
straint qualiﬁcation (2.3.7) holds, then there is a Lagrange multiplier vector
for ¯x.
Proof.
By the trivial implication in Gordan’s Theorem (2.2.1), the con-
straint qualiﬁcation ensures λ0 ̸= 0 in the Fritz John conditions (2.3.6).
♠

§2.3
Max-functions and ﬁrst order conditions
39
Exercises and commentary
The approach to ﬁrst order conditions of this section is due to [85]. The
Fritz John conditions appeared in [96]. The Karush-Kuhn-Tucker conditions
were ﬁrst published (under a diﬀerent regularity condition) in [106], although
the conditions appear earlier in an unpublished masters thesis [100].The
Mangasarian-Fromovitz constraint qualiﬁcation appeared in [120]. A nice
collection of optimization problems involving the determinant, similar to Ex-
ercise 8 (Minimum volume ellipsoid), appears in [43] (see also [162]). The
classic reference for inequalities is [82].
1. Prove by induction that if the functions g0, g1, . . . , gm : E →R are
all continuous at the point ¯x then so is the max-function g(x) =
maxi{gi(x)}.
2. (Failure of Karush-Kuhn-Tucker) Consider the following problem:
⎧
⎪
⎨
⎪
⎩
inf
(x1 + 1)2 + x2
2
subject to
−x3
1 + x2
2
≤
0,
x
∈
R2.
(a) Sketch the feasible region and hence solve the problem.
(b) Find multipliers λ0 and λ satisfying the Fritz John conditions
(2.3.6).
(c) Prove there exists no Lagrange multiplier vector for the optimal
solution. Explain why not.
3. (Linear independence implies Mangasarian-Fromovitz) Prove
directly that if the set of vectors {a1, a2, . . . , am} in E is linearly inde-
pendent then there exists a direction d in E satisfying ⟨ai, d⟩< 0 for
i = 1, 2, . . ., m.
4. For each of the following problems, explain why there must exist an
optimal solution, and ﬁnd it by using the Karush-Kuhn-Tucker condi-
tions.
(a)
⎧
⎪
⎨
⎪
⎩
inf
x2
1 + x2
2
subject to
−2x1 −x2 + 10
≤
0,
−x1
≤
0.

40
Inequality constraints
(b)
⎧
⎪
⎨
⎪
⎩
inf
5x2
1 + 6x2
2
subject to
x1 −4
≤
0,
25 −x2
1 −x2
2
≤
0.
5. (Cauchy-Schwarz and steepest descent) For a nonzero vector y in
E, use the Karush-Kuhn-Tucker conditions to solve the problem
inf{⟨y, x⟩| ∥x∥2 ≤1}.
Deduce the Cauchy-Schwarz inequality.
6. ∗(H¨older’s inequality) For real p > 1, deﬁne q by p−1 + q−1 = 1,
and for x in Rn deﬁne
∥x∥p =
 n

1
|xi|p
1/p
.
For a nonzero vector y in Rn, consider the optimization problem
inf{⟨y, x⟩| ∥x∥p
p ≤1}.
(2.3.9)
(a) Prove
d
du|u|p/p = u|u|p−2 for all real u.
(b) Prove reals u and v satisfy v = u|u|p−2 if and only if u = v|v|q−2.
(c) Prove problem (2.3.9) has a nonzero optimal solution.
(d) Use the Karush-Kuhn-Tucker conditions to ﬁnd the unique opti-
mal solution.
(e) Deduce that any vectors x and y in Rn satisfy ⟨y, x⟩≤∥y∥q∥x∥p.
(We develop another approach to this theory in §4.1, Exercise 11.)
7. ∗Consider a matrix A in Sn
++ and a real b > 0.
(a) Assuming the problem
⎧
⎪
⎨
⎪
⎩
inf
−log det X
subject to
tr AX
≤
b
X
∈
Sn
++
has a solution, ﬁnd it.
(b) Repeat, using the objective function tr X−1.

§2.3
Max-functions and ﬁrst order conditions
41
(c) Prove the problems in parts (a) and (b) have optimal solutions.
(Hint: §1.2, Exercise 14.)
8. ∗∗(Minimum volume ellipsoid)
(a) For a point y in Rn and the function g : Sn →R deﬁned by
g(X) = ∥Xy∥2, prove ∇g(X) = XyyT + yyTX for all matrices X
in Sn.
(b) Consider a set {y1, y2, . . . , ym} ⊂Rn. Prove this set spans Rn if
and only if the matrix 
i yi(yi)T is positive deﬁnite.
Now suppose the vectors y1, y2, . . . , ym span Rn.
(c) Prove the problem
⎧
⎪
⎨
⎪
⎩
inf
−log det X
subject to
∥Xyi∥2 −1
≤
0 for i = 1, 2, . . ., m,
X
∈
Sn
++
has an optimal solution. (Hint: use part (b) and §1.2, Exercise
14.)
Now suppose ¯X is an optimal solution for the problem in part (c). (In
this case the set {y ∈Rn | ∥¯Xy∥≤1} is a minimum volume ellipsoid
(centered at the origin) containing the vectors y1, y2, . . . , ym.)
(d) Show the Mangasarian-Fromovitz constraint qualiﬁcation holds at
¯X by considering the direction d = −¯X.
(e) Write down the Karush-Kuhn-Tucker conditions which ¯X must
satisfy.
(f) When {y1, y2, . . . , ym} is the standard basis of Rn, the optimal so-
lution of the problem in part (c) is ¯X = I. Find the corresponding
Lagrange multiplier vector.

Chapter 3
Fenchel duality
3.1
Subgradients and convex functions
We have already seen, in the First order suﬃcient condition (2.1.2), one ben-
eﬁt of convexity in optimization: critical points of convex functions are global
minimizers. In this section we extend the types of functions we consider in
two important ways:
(i) we do not require f to be diﬀerentiable;
(ii) we allow f to take the value +∞.
Our derivation of ﬁrst order conditions in §2.3 illustrates the utility of
considering nonsmooth functions even in the context of smooth problems.
Allowing the value +∞lets us rephrase a problem like inf{g(x) | x ∈C}
as inf(g + δC), where the indicator function δC(x) is 0 for x in C and +∞
otherwise.
The domain of a function f : E →(−∞, +∞] is the set
dom f = {x ∈E | f(x) < +∞}.
We say f is convex if it is convex on its domain, and proper if its domain is
nonempty. We call a function g : E →[−∞, +∞) concave if −g is convex,
although for reasons of simplicity we will consider primarily convex functions.
If a convex function f satisﬁes the stronger condition
f(λx + µy) ≤λf(x) + µf(y) for all x, y ∈E, λ, µ ∈R+
42

§3.1
Subgradients and convex functions
43
we say f is sublinear. If f(λx) = λf(x) for all x in E and λ in R+ then f
is positively homogeneous: in particular this implies f(0) = 0. (Recall the
convention 0·(+∞)) = 0.) If f(x+y) ≤f(x)+f(y) for all x and y in E then
we say f is subadditive. It is immediate that if the function f is sublinear
then −f(x) ≤f(−x) for all x in E. The lineality space of a sublinear function
f is the set
lin f = {x ∈E | −f(x) = f(−x)}.
The following result (left as an exercise) shows this set is a subspace.
Proposition 3.1.1 (Sublinearity) A function f : E →(−∞, +∞] is sub-
linear if and only if it is positively homogeneous and subadditive.
For a
sublinear function f, the lineality space lin f is the largest subspace of E on
which f is linear.
As in the First order suﬃcient condition (2.1.2), it is easy to check that if
the point ¯x lies in the domain of the convex function f then the directional
derivative f ′(¯x; ·) is well-deﬁned and positively homogeneous, taking values
in [−∞, +∞]. The core of a set C (written core (C)) is the set of points x in
C such that for any direction d in E, x+td lies in C for all small real t. This
set clearly contains the interior of C, although it may be larger (Exercise 2).
Proposition 3.1.2 (Sublinearity of the directional derivative) If the
function f : E →(−∞, +∞] is convex then for any point ¯x in core (dom f)
the directional derivative f ′(¯x; ·) is everywhere ﬁnite and sublinear.
Proof. For d in E and nonzero t in R, deﬁne
g(d; t) = f(¯x + td) −f(¯x)
t
.
By convexity we deduce, for 0 < t ≤s ∈R, the inequality
g(d; −s) ≤g(d; −t) ≤g(d; t) ≤g(d; s).
Since ¯x lies in core (dom f), for small s > 0 both g(d; −s) and g(d; s) are
ﬁnite, so as t ↓0 we have
+∞> g(d; s) ≥g(d; t) ↓f ′(¯x; d) ≥g(d; −s) > −∞.
(3.1.3)

44
Fenchel duality
Again by convexity we have, for any directions d and e in E and real t > 0,
g(d + e; t) ≤g(d; 2t) + g(e; 2t).
Now letting t ↓0 gives subadditivity of f ′(¯x; ·). The positive homogeneity is
easy to check.
♠
The idea of the derivative is fundamental in analysis because it allows us
to approximate a wide class of functions using linear functions. In optimiza-
tion we are concerned speciﬁcally with the minimization of functions, and
hence often a one-sided approximation is suﬃcient. In place of the gradient
we therefore consider subgradients: those elements φ of E satisfying
⟨φ, x −¯x⟩≤f(x) −f(¯x),
for all points x in E.
(3.1.4)
We denote the set of subgradients (called the subdiﬀerential) by ∂f(¯x), deﬁn-
ing ∂f(¯x) = ∅for ¯x not in dom f. The subdiﬀerential is always a closed
convex set. We can think of ∂f(¯x) as the value at ¯x of the ‘multifunction’
or ‘set-valued map’ ∂f : E →E. The importance of such maps is another of
our themes: we deﬁne its domain
dom ∂f = {x ∈E | ∂f(x) ̸= ∅}
(see Exercise 19). We say f is essentially strictly convex if it is strictly convex
on any convex subset of dom ∂f.
The following very easy observation suggests the fundamental signiﬁcance
of subgradients in optimization.
Proposition 3.1.5 (Subgradients at optimality) For any proper func-
tion f : E →(−∞, +∞], the point ¯x is a (global) minimizer of f if and only
if the condition 0 ∈∂f(¯x) holds.
Alternatively put, minimizers of f correspond exactly to ‘zeroes’ of ∂f.
The derivative is a local property whereas the subgradient deﬁnition
(3.1.4) describes a global property. The main result of this section shows
that the set of subgradients of a convex function is usually nonempty, and
that we can describe it locally in terms of the directional derivative. We
begin with another simple exercise.

§3.1
Subgradients and convex functions
45
Proposition 3.1.6 (Subgradients and directional derivatives) If the
function f : E →(−∞, +∞] is convex and the point ¯x lies in dom f, then
an element φ of E is a subgradient of f at ¯x if and only if it satisﬁes ⟨φ, ·⟩≤
f ′(¯x; ·).
The idea behind the construction of a subgradient for a function f that we
present here is rather simple. We recursively construct a decreasing sequence
of sublinear functions which, after translation, minorize f. At each step we
guarantee one extra direction of linearity. The basic step is summarized in
the following exercise.
Lemma 3.1.7 Suppose that the function p : E →(−∞, +∞] is sublinear,
and that the point ¯x lies in core (dom p). Then the function q(·) = p′(¯x; ·)
satisﬁes the conditions
(i) q(λ¯x) = λp(¯x) for all real λ,
(ii) q ≤p, and
(iii) lin q ⊃lin p + span {¯x}.
With this tool we are now ready for the main result, giving conditions
guaranteeing the existence of a subgradient. Proposition 3.1.6 showed how
to identify subgradients from directional derivatives: this next result shows
how to move in the reverse direction.
Theorem 3.1.8 (Max formula) If the function f : E →(−∞, +∞] is
convex then any point ¯x in core (dom f) and any direction d in E satisfy
f ′(¯x; d) = max{⟨φ, d⟩| φ ∈∂f(¯x)}.
(3.1.9)
In particular, the subdiﬀerential ∂f(¯x) is nonempty.
Proof.
In view of Proposition 3.1.6, we simply have to show that for any
ﬁxed d in E there is a subgradient φ satisfying ⟨φ, d⟩= f ′(¯x; d). Choose
a basis {e1, e2, . . . , en} for E with e1 = d if d is nonzero.
Now deﬁne a
sequence of functions p0, p1, . . . , pn recursively by p0(·) = f ′(¯x; ·), and pk(·) =
p′
k−1(ek; ·), for k = 1, 2, . . ., n. We essentially show that pn(·) is the required
subgradient.

46
Fenchel duality
First note that, by Proposition 3.1.2, each pk is everywhere ﬁnite and
sublinear. By part (iii) of Lemma 3.1.7 we know
lin pk ⊃lin pk−1 + span {ek},
for k = 1, 2, . . ., n,
so pn is linear. Thus there is an element φ of E satisfying ⟨φ, ·⟩= pn(·).
Part (ii) of Lemma 3.1.7 implies pn ≤pn−1 ≤. . . ≤p0, so certainly, by
Proposition 3.1.6, any point x in E satisﬁes
pn(x −¯x) ≤p0(x −¯x) = f ′(¯x; x −¯x) ≤f(x) −f(¯x).
Thus φ is a subgradient. If d is 0 then we have pn(0) = 0 = f ′(¯x; 0). Finally,
if d is nonzero then by part (i) of Lemma 3.1.7 we see
pn(d) ≤p0(d) = p0(e1) =
−p′
0(e1; −e1) = −p1(−e1) = −p1(−d) ≤−pn(−d) = pn(d),
whence pn(d) = p0(d) = f ′(¯x; d).
♠
Corollary 3.1.10 (Diﬀerentiability of convex functions) Suppose that
the function f : E →(−∞, +∞] is convex, and that the point ¯x lies in
core (dom f). Then f is Gˆateaux diﬀerentiable at ¯x exactly when f has a
unique subgradient at ¯x (in which case this subgradient is the derivative).
We say the convex function f is essentially smooth if it is Gˆateaux diﬀeren-
tiable on dom ∂f. (In this deﬁnition, we also require f to be ‘lower semi-
continuous’: we defer discussion of lower semicontinuity until we need it, in
§4.2.) We see later (§4.1, Exercise 21) that a function is essentially smooth
if and only if its subdiﬀerential is always singleton or empty.
The Max formula (Theorem 3.1.8) shows that convex functions typically
have subgradients. In fact this property characterizes convexity (see Exer-
cise 12). This leads to a number of important ways of recognizing convex
functions, of which the following is an example. Notice how a locally de-
ﬁned analytic condition results in a global geometric conclusion. The proof
is outlined in the exercises.
Theorem 3.1.11 (Hessian characterization of convexity) Given an
open convex set S ⊂Rn, suppose the continuous function f : cl S →R
is twice continuously diﬀerentiable on S. Then f is convex if and only if its
Hessian matrix is positive semideﬁnite everywhere on S.

§3.1
Subgradients and convex functions
47
Exercises and commentary
The algebraic proof of the Max formula we follow here is due to [21]. The
exercises below develop several standard characterizations of convexity —
see for example [149]. The convexity of −log det (see Exercise 21) may be
found in [88], for example.
1. Prove Proposition 3.1.1 (Sublinearity).
2. (Core versus interior) Consider the set in R2
D = {(x, y) | y = 0 or |y| ≥x2}.
Prove 0 ∈core (D) \ int (D).
3. Prove the subdiﬀerential is a closed convex set.
4. (Subgradients and normal cones) If a point ¯x lies in a set C ⊂E,
prove ∂δC(¯x) = NC(¯x).
5. Prove the following functions x ∈R →f(x) are convex and calculate
∂f:
(a) |x|;
(b) δR+;
(c) −√x if x ≥0, and +∞otherwise;
(d) 0 if x < 0, 1 if x = 0, and +∞otherwise.
6. Prove Proposition 3.1.6 (Subgradients and directional derivatives).
7. Prove Lemma 3.1.7.
8. (Subgradients of norm) Calculate ∂∥· ∥.
9. (Subgradients of maximum eigenvalue) Prove
∂λ1(0) = {Y ∈Sn
+ | tr Y = 1}.
10. ∗∗For any vector µ in the cone Rn
≥, prove
∂⟨µ, [·]⟩(0) = conv (Pnµ)
(see §2.2, Exercise 9 (Schur-convexity)).

48
Fenchel duality
11. ∗Deﬁne a function f : Rn →R by f(x1, x2, . . . , xn) = maxj{xj},
let ¯x = 0 and d = (1, 1, . . ., 1)T, and let ek = (1, 1, . . ., 1, 0, . . ., 0)T
(ending in (k −1) 0’s). Calculate the functions pk deﬁned in the proof
of Theorem 3.1.8 (Max formula), using Proposition 2.3.2 (Directional
derivatives of max functions).
12. ∗(Recognizing convex functions) Suppose the set S ⊂Rn is open
and convex, and consider a function f : S →R. For points x ̸∈S,
deﬁne f(x) = +∞.
(a) Prove ∂f(x) is nonempty for all x in S if and only if f is convex.
(Hint: for points u and v in S and real λ in [0, 1], use the sub-
gradient inequality (3.1.4) at the points ¯x = λu + (1 −λ)v and
x = u, v to check the deﬁnition of convexity.)
(b) Prove that if I ⊂R is an open interval and g : I →R is diﬀer-
entiable then g is convex if and only if g′ is nondecreasing on I,
and g is strictly convex if and only if g′ is strictly increasing on I.
Deduce that if g is twice diﬀerentiable then g is convex if and only
if g′′ is nonnegative on I, and g is strictly convex if g′′ is strictly
positive on I.
(c) Deduce that if f is twice continuously diﬀerentiable on S then f
is convex if and only if its Hessian matrix is positive semideﬁnite
everywhere on S, and f is strictly convex if its Hessian matrix is
positive deﬁnite everywhere on S. (Hint: apply part (b) to the
function g deﬁned by g(t) = f(x + td) for small real t, points x in
S, and directions d in E.)
(d) Find a strictly convex function f : (−1, 1) →R with f ′′(0) = 0.
(e) Prove that a continuous function h : cl S →R is convex if and
only if its restriction to S is convex. What about strictly convex
functions?
13. (Local convexity) Suppose the function f : Rn →R is twice contin-
uously diﬀerentiable near 0 and ∇2f(0) is positive deﬁnite. Prove f|δB
is convex for some real δ > 0.
14. (Examples of convex functions) As we shall see in §4.2, most nat-
ural convex functions occur in pairs.
The table in §3.3 lists many

§3.1
Subgradients and convex functions
49
examples on R. Use Exercise 12 to prove each function f and f ∗in the
table is convex.
15. (Examples of convex functions) Prove the following functions of
x ∈R are convex:
(a) log

sinh ax
sinh x

(for a ≥1);
(b) log

eax−1
ex−1

(for a ≥1).
16. ∗(Bregman distances [44]) For a function φ : E →(−∞, +∞] that
is strictly convex and diﬀerentiable on int (dom φ), deﬁne the Bregman
distance dφ : dom φ × int (dom φ) →R by
dφ(x, y) = φ(x) −φ(y) −φ′(y)(x −y).
(a) Prove dφ(x, y) ≥0, with equality if and only if x = y.
(b) Compute dφ when φ(t) = t2/2 and when φ is the function p deﬁned
in Exercise 27.
(c) Suppose φ is three times diﬀerentiable. Prove dφ is convex if and
only if −1/φ′′ is convex on int (dom φ).
(d) Extend the results above to the function
Dφ : (dom φ)n × (int (dom φ))n →R
deﬁned by Dφ(x, y) = 
i dφ(xi, yi).
17. ∗(Convex functions on R2) Prove the following functions of x ∈R2
are convex:
(a)
⎧
⎪
⎨
⎪
⎩
(x1 −x2)(log x1 −log x2)
(x ∈R2
++)
0
(x = 0)
+∞
(otherwise);
(Hint: see Exercise 16.)
(b)
⎧
⎪
⎨
⎪
⎩
x2
1/x2
(x2 > 0)
0
(x = 0)
+∞
(otherwise).

50
Fenchel duality
18. ∗Prove the function
f(x) =

−(x1x2 . . . xn)1/n
(x ∈Rn
+)
+∞
(otherwise)
is convex.
19. (Domain of subdiﬀerential) If the function f : R2 →(−∞, +∞] is
deﬁned by
f(x1, x2) =

max{1 −√x1, |x2|}
(x1 ≥0)
+∞
(otherwise),
prove that f is convex but that dom ∂f is not convex.
20. ∗(Monotonicity of gradients) Suppose that the set S ⊂Rn is open
and convex, and that the function f : S →R is diﬀerentiable. Prove
f is convex if and only if
⟨∇f(x) −∇f(y), x −y⟩≥0,
for all x, y ∈S,
and f is strictly convex if and only if the above inequality holds strictly
whenever x ̸= y. (You may use Exercise 12.)
21. ∗∗(The log barrier) Use Exercise 20 (Monotonicity of gradients),
Exercise 10 in §2.1 and Exercise 8 in §1.2 to prove that the function
f : Sn
++ →R deﬁned by f(X) = −log det X is strictly convex. Deduce
the uniqueness of the minimum volume ellipsoid in §2.3, Exercise 8,
and the matrix completion in §2.1, Exercise 12.
22. Prove the function (2.2.5) is convex on Rn by calculating its Hessian.
23. ∗If the function f : E →(−∞, +∞] is essentially strictly convex, prove
all distinct points x and y in E satisfy ∂f(x) ∩∂f(y) = ∅. Deduce that
f has at most one minimizer.
24. (Minimizers of essentially smooth functions) Prove that any min-
imizer of an essentially smooth function f must lie in core (dom f).
25. ∗∗Convex matrix functions Consider a matrix C in Sn
+.

§3.1
Subgradients and convex functions
51
(a) For matrices X in Sn
++ and D in Sn, use a power series expansion
to prove
d2
dt2tr (C(X + tD)−1)

t=0
≥0.
(b) Deduce X ∈Sn
++ →tr (CX−1) is convex.
(c) Prove similarly the functions X ∈Sn →tr (CX2) and X ∈Sn
+ →
−tr (CX1/2) are convex.
26. ∗∗(Log-convexity) Given a convex set C ⊂E, we say that a function
f : C →R++ is log-convex if log f(·) is convex.
(a) Prove any log-convex function is convex, using §1.1, Exercise 9
(Composing convex functions).
(b) If a polynomial p : R →R has all real roots, prove 1/p is log-
convex on any interval on which p is strictly positive.
(c) One version of H¨older’s inequality states, for real p, q > 1 satisfying
p−1 + q−1 = 1 and functions u, v : R+ →R,

uv ≤

|u|p
1/p 
|v|q
1/q
when the right-hand-side is well-deﬁned. Use this to prove the
Gamma function Γ : R →R given by
Γ(x) =
 ∞
0
tx−1e−t dt
is log-convex.
27. ∗∗(Maximum entropy [34]) Deﬁne a convex function p : R →
(−∞, +∞] by
p(u) =
⎧
⎪
⎨
⎪
⎩
u log u −u
if u > 0,
0
if u = 0,
+∞
if u < 0,
and a convex function f : Rn →(−∞, +∞] by
f(x) =
n

i=1
p(xi).
Suppose ˆx lies in the interior of Rn
+.

52
Fenchel duality
(a) Prove f is strictly convex on Rn
+, with compact level sets.
(b) Prove f ′(x; ˆx −x) = −∞for any point x on the boundary of Rn
+.
(c) Suppose the map G : Rn →Rm is linear, with Gˆx = b. Prove, for
any vector c in Rn, that the problem
⎧
⎪
⎨
⎪
⎩
inf
f(x) + ⟨c, x⟩
subject to
Gx
=
b,
x
∈
Rn.
has a unique optimal solution ¯x, lying in Rn
++.
(d) Use Corollary 2.1.3 (First order conditions for linear constraints)
to prove that some vector λ in Rm satisﬁes ∇f(¯x) = G∗λ−c, and
deduce ¯xi = exp(G∗λ −c)i.
28. ∗∗(DAD problems [34]) Consider the following example of Exercise
27 (Maximum entropy). Suppose the k × k matrix A has each entry
aij nonnegative.
We say A has doubly stochastic pattern if there is
a doubly stochastic matrix with exactly the same zero entries as A.
Deﬁne a set Z = {(i, j)|aij > 0}, and let RZ denote the set of vectors
with components indexed by Z and RZ
+ denote those vectors in RZ
with all nonnegative components. Consider the problem
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf

(i,j)∈Z(p(xij) −xij log aij)
subject to

i:(i,j)∈Z xij
=
1,
for j = 1, 2, . . ., k,

j:(i,j)∈Z xij
=
1,
for i = 1, 2, . . . , k,
x
∈
RZ.
(a) Suppose A has doubly stochastic pattern. Prove there is a point ˆx
in the interior of RZ
+ which is feasible for the problem above. De-
duce that the problem has a unique optimal solution ¯x satisfying,
for some vectors λ and µ in Rk,
¯xij = aij exp(λi + µj),
for (i, j) ∈Z.
(b) Deduce that A has doubly stochastic pattern if and only if there
are diagonal matrices D1 and D2 with strictly positive diagonal
entries and D1AD2 doubly stochastic.

§3.1
Subgradients and convex functions
53
29. ∗∗(Relativizing the Max formula) If f : E →(−∞, +∞] is a
convex function then for points ¯x in ri (dom f) and directions d in E,
prove the subdiﬀerential ∂f(¯x) is nonempty, and
f ′(¯x; d) = sup{⟨φ, d⟩| φ ∈∂f(¯x)},
with attainment when ﬁnite.

54
Fenchel duality
3.2
The value function
In this section we describe another approach to the Karush-Kuhn-Tucker
conditions (2.3.8) in the convex case, using the existence of subgradients we
established in the previous section. We consider the (inequality-constrained)
convex program
⎧
⎪
⎨
⎪
⎩
inf
f(x)
subject to
gi(x)
≤
0,
for i = 1, 2, . . ., m,
x
∈
E,
(3.2.1)
where the functions f, g1, g2, . . . , gm : E →(−∞, +∞] are convex and satisfy
∅̸= dom f ⊂∩idom gi. Denoting the vector with components gi(x) by g(x),
the function L : E × Rm
+ →(−∞, +∞] deﬁned by
L(x; λ) = f(x) + λTg(x),
(3.2.2)
is called the Lagrangian. A feasible solution is a point x in dom f satisfying
the constraints.
We should emphasize that the term ‘Lagrange multiplier’ has diﬀerent
meanings in diﬀerent contexts. In the present context we say a vector ¯λ ∈Rm
+
is a Lagrange multiplier vector for a feasible solution ¯x if ¯x minimizes the func-
tion L(·; ¯λ) over E and ¯λ satisﬁes the complementary slackness conditions:
¯λi = 0 whenever gi(¯x) < 0.
We can often use the following principle to solve simple optimization
problems.
Proposition 3.2.3 (Lagrangian suﬃcient conditions) If the point ¯x is
feasible for the convex program (3.2.1) and there is a Lagrange multiplier
vector, then ¯x is optimal.
The proof is immediate, and in fact does not rely on convexity.
The Karush-Kuhn-Tucker conditions (2.3.8) are a converse to the above
result when the functions f, g1, g2, . . . , gm are convex and diﬀerentiable. We
next follow a very diﬀerent, and surprising route to this result, circumventing
diﬀerentiability. We perturb the problem (3.2.1), and analyze the resulting
value function v : Rm →[−∞, +∞], deﬁned by the equation
v(b) = inf{f(x) | g(x) ≤b}.
(3.2.4)

§3.2
The value function
55
We show that Lagrange multiplier vectors ¯λ correspond to subgradients of v
(see Exercise 9).
Our old deﬁnition of convexity for functions does not naturally extend to
functions h : E →[−∞, +∞] (due to the possible occurrence of ∞−∞). To
generalize it we introduce the idea of the epigraph of h
epi (h) = {(y, r) ∈E × R | h(y) ≤r},
(3.2.5)
and we say h is a convex function if epi (h) is a convex set. An exercise shows
in this case that the domain
dom (h) = {y | h(y) < +∞}
is convex, and further that the value function v deﬁned by equation (3.2.4) is
convex. We say h is proper if dom h is nonempty and h never takes the value
−∞: if we wish to demonstrate the existence of subgradients for v using the
results in the previous section then we need to exclude values −∞.
Lemma 3.2.6 If the function h : E →[−∞, +∞] is convex and some point
ˆy in core (dom h) satisﬁes h(ˆy) > −∞, then h never takes the value −∞.
Proof.
Suppose some point y in E satisﬁes h(y) = −∞. Since ˆy lies in
core (dom h) there is a real t > 0 with ˆy + t(ˆy −y) in dom (h), and hence a
real r with (ˆy +t(ˆy −y), r) in epi (h). Now for any real s, (y, s) lies in epi (h),
so we know

ˆy, r + ts
1 + t

=
1
1 + t(ˆy + t(ˆy −y), r) +
t
1 + t(y, s) ∈epi (h),
Letting s →−∞gives a contradiction.
♠
In §2.3 we saw that the Karush-Kuhn-Tucker conditions needed a regu-
larity condition. In this approach we will apply a diﬀerent condition, known
as the Slater constraint qualiﬁcation for the problem (3.2.1):
There exists ˆx in dom (f) with gi(ˆx) < 0 for i = 1, 2, . . ., m.
(3.2.7)
Theorem 3.2.8 (Lagrangian necessary conditions) Suppose that the
point ¯x in dom (f) is optimal for the convex program (3.2.1), and that the
Slater condition (3.2.7) holds. Then there is a Lagrange multiplier vector for
¯x.

56
Fenchel duality
Proof. Deﬁning the value function v by equation (3.2.4), certainly v(0) >
−∞, and the Slater condition shows 0 ∈core (dom v), so in particular Lemma
3.2.6 shows that v never takes the value −∞. (An incidental consequence,
from §4.1, is the continuity of v at 0.) We now deduce the existence of a
subgradient −¯λ of v at 0, by the Max formula (3.1.8).
Any vector b in Rm
+ obviously satisﬁes g(¯x) ≤b, whence the inequality
f(¯x) = v(0) ≤v(b) + ¯λTb ≤f(¯x) + ¯λTb.
Hence ¯λ lies in Rm
+. Furthermore, any point x in dom f clearly satisﬁes
f(x) ≥v(g(x)) ≥v(0) −¯λTg(x) = f(¯x) −¯λTg(x).
The case x = ¯x, using the inequalities ¯λ ≥0 and g(¯x) ≤0, shows ¯λTg(¯x) = 0,
which yields the complementary slackness conditions. Finally, all points x in
dom f must satisfy f(x) + ¯λTg(x) ≥f(¯x) = f(¯x) + ¯λTg(¯x).
♠
In particular, if in the above result ¯x lies in core (dom f) and the functions
f, g1, g2, . . . , gm are diﬀerentiable at ¯x then
∇f(¯x) +
m

i=1
¯λi∇gi(¯x) = 0,
so we recapture the Karush-Kuhn-Tucker conditions (2.3.8). In fact in this
case it is easy to see that the Slater condition is equivalent to the Mangasar-
ian-Fromovitz constraint qualiﬁcation (Assumption 2.3.7).
Exercises and commentary
Versions of the Lagrangian necessary conditions above appeared in [161] and
[99]: for a survey, see [140]. The approach here is analogous to [72]. The
Slater condition ﬁrst appeared in [152].
1. Prove the Lagrangian suﬃcient conditions (3.2.3).
2. Use the Lagrangian suﬃcient conditions (3.2.3) to solve the following
problems.

§3.2
The value function
57
(a)
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf
x2
1 + x2
2 −6x1 −2x2 + 10
subject to
2x1 + x2 −2
≤
0,
x2 −1
≤
0,
x
∈
R2.
(b)
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf
−2x1 + x2
subject to
x2
1 −x2
≤
0,
x2 −4
≤
0,
x
∈
R2.
(c)
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf
x1 + (2/x2)
subject to
−x2 + 1/2
≤
0,
−x1 + x2
2
≤
0,
x
∈
{(x1, x2) | x2 > 0}.
3. Given strictly positive reals a1, a2, . . . , an, c1, c2, . . . , cn and b, use the
Lagrangian suﬃcient conditions to solve the problem
⎧
⎪
⎨
⎪
⎩
inf
n
i=1 ci/xi
subject to
n
i=1 aixi
≤
b,
x
∈
Rn
++.
4. For a matrix A in Sn
++ and a real b > 0, use the Lagrangian suﬃcient
conditions to solve the problem
⎧
⎪
⎨
⎪
⎩
inf
−log det X
subject to
tr AX
≤
b,
X
∈
Sn
++.
You may use the fact that the objective function is convex, with deriva-
tive −X−1 (see §3.1, Exercise 21 (The log barrier)).
5. ∗(Mixed constraints) Consider the convex program (3.2.1) with
some additional linear constraints ⟨aj, x⟩= dj for vectors aj in E and
reals dj. By rewriting each equality as two inequalities (or otherwise),
prove a version of the Lagrangian suﬃcient conditions for this problem.

58
Fenchel duality
6. (Extended convex functions)
(a) Give an example of a convex function which takes the values 0
and −∞.
(b) Prove the value function v deﬁned by equation (3.2.4) is convex.
(c) Prove that a function h : E →[−∞, +∞] is convex if and only if
it satisﬁes the inequality
h(λx + (1 −λ)y) ≤λh(x) + (1 −λ)h(y)
for any points x and y in dom h (or E if h is proper) and any real
λ in (0, 1).
(d) Prove that if the function h : E →[−∞, +∞] is convex then
dom (h) is convex.
7. (Nonexistence of multiplier) Deﬁne a function f : R →(−∞, +∞]
by f(x) = −√x for x in R+ and +∞otherwise. Show there is no
Lagrange multiplier at the optimal solution of inf{f(x) | x ≤0}.
8. (Duﬃn’s duality gap) Consider the following problem (for real b):
⎧
⎪
⎨
⎪
⎩
inf
ex2
subject to
∥x∥−x1
≤
b,
x
∈
R2.
(3.2.9)
(a) Sketch the feasible region for b > 0 and for b = 0.
(b) Plot the value function v.
(c) Show that when b = 0 there is no Lagrange multiplier for any fea-
sible solution. Explain why the Lagrangian necessary conditions
(3.2.8) do not apply.
(d) Repeat the above exercises with the objective function ex2 replaced
by x2.
9. ∗∗(Karush-Kuhn-Tucker vectors [149]) Consider the convex pro-
gram (3.2.1). Suppose the value function v given by equation (3.2.4) is
ﬁnite at 0. We say the vector ¯λ in Rm
+ is a Karush-Kuhn-Tucker vector
if it satisﬁes v(0) = inf{L(x; ¯λ) | x ∈E}.
(a) Prove that the set of Karush-Kuhn-Tucker vectors is −∂v(0).

§3.2
The value function
59
(b) Suppose the point ¯x is an optimal solution of problem (3.2.1).
Prove that the set of Karush-Kuhn-Tucker vectors coincides with
the set of Lagrange multiplier vectors for ¯x.
(c) Prove the Slater condition ensures the existence of a Karush-
Kuhn-Tucker vector.
(d) Suppose ¯λ is a Karush-Kuhn-Tucker vector. Prove a feasible point
¯x is optimal for problem (3.2.1) if and only if ¯λ is a Lagrange
multiplier vector for ¯x.
10. Prove the equivalence of the Slater and Mangasarian-Fromovitz condi-
tions asserted at the end of the section.
11. (Normals to epigraphs) For a function f : E →(−∞, +∞] and a
point ¯x in core (dom f), calculate the normal cone Nepi f(¯x, f(¯x)).
12. ∗(Normals to level sets) Suppose the function f : E →(−∞, +∞]
is convex. If the point ¯x lies in core (dom f) and is not a minimizer for
f, prove that the normal cone at ¯x to the level set
C = {x ∈E | f(x) ≤f(¯x)}
is given by NC(¯x) = R+∂f(¯x). Is the assumption ¯x ∈core (dom f) and
f(¯x) > inf f necessary?
13. ∗(Subdiﬀerential of max-function) Consider convex functions
g1, g2, . . . , gm : E →(−∞, +∞],
and deﬁne a function g(x) = maxi gi(x) for all points x in E. For a
ﬁxed point ¯x in E, deﬁne the index set I = {i | gi(¯x) = g(¯x)}, and let
C =
 
∂

i∈I
λigi

(¯x)
 λ ∈RI
+,

i∈I
λi = 1

.
(a) Prove C ⊂∂g(¯x).
(b) Suppose 0 ∈∂g(¯x). By considering the convex program
inf
t∈R, x∈E{t | gi(x) −t ≤0 (i = 1, 2, . . . , m)},
prove 0 ∈C.

60
Fenchel duality
(c) Deduce ∂g(¯x) = C.
14. ∗∗(Minimum volume ellipsoid) Denote the standard basis of Rn
by {e1, e2, . . ., en} and consider the minimum volume ellipsoid problem
(c.f. §2.3, Exercise 8)
⎧
⎪
⎨
⎪
⎩
inf
−log det X
subject to
∥Xei∥2 −1
≤
0 for i = 1, 2, . . ., n,
X
∈
Sn
++
Use the Lagrangian suﬃcient conditions (3.2.3) to prove X = I is the
unique optimal solution. (Hint: use §3.1, Exercise 21 (The log barrier).)
Deduce the following special case of Hadamard’s inequality: any matrix
(x1 x2 . . . xn) in Sn
++ satisﬁes
det(x1 x2 . . . xn) ≤∥x1∥∥x2∥. . .∥xn∥.

§3.3
The Fenchel conjugate
61
3.3
The Fenchel conjugate
In the next few sections we sketch a little of the elegant and concise theory of
Fenchel conjugation, and we use it to gain a deeper understanding of the La-
grangian necessary conditions for convex programs (3.2.8). The Fenchel con-
jugate of a function h : E →[−∞, +∞] is the function h∗: E →[−∞, +∞]
deﬁned by
h∗(φ) = sup
x∈E{⟨φ, x⟩−h(x)}.
The function h∗is convex and if the domain of h is nonempty then h∗never
takes the value −∞. Clearly the conjugacy operation is order-reversing : for
functions f, g : E →[−∞, +∞], the inequality f ≥g implies f ∗≤g∗.
Conjugate functions are ubiquitous in optimization.
For example, we
have already seen the conjugate of the exponential, deﬁned by
exp∗(t) =
⎧
⎪
⎨
⎪
⎩
t log t −t
(t > 0)
0
(t = 0)
+∞
(t < 0)
(see §3.1, Exercise 27). A rather more subtle example is the function g : E →
(−∞, +∞] deﬁned, for points a0, a1, . . . , am in E, by
g(z) =
inf
x∈Rm+1

i
exp∗(xi)


i
xi = 1,

i
xiai = z

.
(3.3.1)
The conjugate is the function we used in §2.2 to prove various theorems of
the alternative:
g∗(y) = log

i
exp ⟨ai, y⟩

(3.3.2)
(see Exercise 7).
As we shall see later (§4.2), many important convex functions h equal
their biconjugates h∗∗. Such functions thus occur as natural pairs, h and h∗.
The table in this section shows some elegant examples on R.
The following result summarizes the properties of two particularly impor-
tant convex functions.
Proposition 3.3.3 (Log barriers) The functions lb : Rn →(−∞, +∞]
and ld : Sn →(−∞, +∞] deﬁned by
lb (x)
=

−n
i=1 log xi,
if x ∈Rn
++,
+∞,
otherwise, and

62
Fenchel duality
ld (X)
=

−log det X,
if X ∈Sn
++,
+∞,
otherwise
are essentially smooth, and strictly convex on their domains. They satisfy
the conjugacy relations
lb ∗(x)
=
lb (−x) −n,
for all x ∈Rn, and
ld ∗(X)
=
ld (−X) −n,
for all X ∈Sn.
The perturbed functions lb + ⟨c, ·⟩and ld + ⟨C, ·⟩have compact level sets for
any vector c ∈Rn
++ and matrix C ∈Sn
++ respectively.
(See §3.1, Exercise 21 (The log barrier), and §1.2, Exercise 14 (Level sets
of perturbed log barriers): the conjugacy formulas are simple calculations.)
Notice the simple relationships lb = ld ◦Diag and ld = lb ◦λ between these
two functions.
The next elementary but important result relates conjugation with the
subgradient. The proof is an exercise.
Proposition 3.3.4 (Fenchel-Young inequality) Any points φ in E and
x in the domain of a function h : E →(−∞, +∞] satisfy the inequality
h(x) + h∗(φ) ≥⟨φ, x⟩.
Equality holds if and only if φ ∈∂h(x).
In §3.2 we analyzed the standard inequality-constrained convex program
by studying its optimal value under perturbations. A similar approach works
for another model for convex programming, particularly suited to problems
with linear constraints. An interesting byproduct is a convex analogue of the
chain rule for diﬀerentiable functions, ∇(f + g ◦A)(x) = ∇f(x) + A∗∇g(Ax)
(for a linear map A).
In this section we ﬁx a Euclidean space Y. We denote the set of points
where a function g : Y →[−∞, +∞] is ﬁnite and continuous by cont g.
Theorem 3.3.5 (Fenchel duality and convex calculus) For given func-
tions f : E →(−∞, +∞] and g : Y →(−∞, +∞] and a linear map

§3.3
The Fenchel conjugate
63
A : E →Y, let p, d ∈[−∞, +∞] be primal and dual values deﬁned re-
spectively by the optimization problems
p
=
inf
x∈E{f(x) + g(Ax)}
(3.3.6)
d
=
sup
φ∈Y
{−f ∗(A∗φ) −g∗(−φ)}.
(3.3.7)
These values satisfy the weak duality inequality p ≥d. If furthermore f
and g are convex and satisfy the condition
0 ∈core (dom g −Adom f),
(3.3.8)
or the stronger condition
Adom f ∩cont g ̸= ∅,
(3.3.9)
then the values are equal (p = d), and the supremum in the dual problem
(3.3.7) is attained if ﬁnite.
At any point x in E, the calculus rule
∂(f + g ◦A)(x) ⊃∂f(x) + A∗∂g(Ax)
(3.3.10)
holds, with equality if f and g are convex and condition (3.3.8) or (3.3.9)
holds.
Proof. The weak duality inequality follows immediately from the Fenchel-
Young inequality (3.3.4). To prove equality we deﬁne an optimal value func-
tion h : Y →[−∞, +∞] by
h(u) = inf
x∈E{f(x) + g(Ax + u)}.
It is easy to check h is convex, and dom h = dom g−Adom f. If p is −∞there
is nothing to prove, while if condition (3.3.8) holds and p is ﬁnite then Lemma
3.2.6 and the Max formula (3.1.8) show there is a subgradient −φ ∈∂h(0).
Hence we deduce
h(0)
≤
h(u) + ⟨φ, u⟩,
for all u ∈Y,
≤
f(x) + g(Ax + u) + ⟨φ, u⟩,
for all u ∈Y, x ∈E,
=
{f(x) −⟨A∗φ, x⟩} + {g(Ax + u) −⟨−φ, Ax + u⟩}.

64
Fenchel duality
Taking the inﬁmum over all points u, and then over all points x gives the
inequalities
h(0) ≤−f ∗(A∗φ) −g∗(−φ) ≤d ≤p = h(0).
Thus φ attains the supremum in problem (3.3.7), and p = d.
An easy
exercise shows that condition (3.3.9) implies condition (3.3.8). The proof of
the calculus rule in the second part of the theorem is a simple consequence
of the ﬁrst part: see Exercise 9.
♠
The case of the Fenchel theorem above when the function g is simply
the indicator function of a point gives the following particularly elegant and
useful corollary.
Corollary 3.3.11 (Fenchel duality for linear constraints) Given any
function f : E →(−∞, +∞], any linear map A : E →Y, and any element
b of Y, the weak duality inequality
inf
x∈E{f(x) | Ax = b} ≥sup
φ∈Y
{⟨b, φ⟩−f ∗(A∗φ)}
holds. If f is convex and b belongs to core (Adom f) then equality holds, and
the supremum is attained when ﬁnite.
A pretty application of the Fenchel duality circle of ideas is the calculation
of polar cones. The (negative) polar cone of the set K ⊂E is the convex
cone
K−= {φ ∈E | ⟨φ, x⟩≤0,
for all x ∈K},
and the cone K−−is called the bipolar. A particularly important example of
the polar cone is the normal cone to a convex set C ⊂E at a point x in C,
since NC(x) = (C −x)−.
We use the following two examples extensively: the proofs are simple
exercises.
Proposition 3.3.12 (Self-dual cones)
(Rn
+)−
=
−Rn
+,
and
(Sn
+)−
=
−Sn
+.
The next result shows how the calculus rules above can be used to derive
geometric consequences.

§3.3
The Fenchel conjugate
65
Corollary 3.3.13 (Krein-Rutman polar cone calculus) For any cones
H ⊂Y and K ⊂E and any linear map A : E →Y, the relation
(K ∩A−1H)−⊃A∗H−+ K−
holds. Equality holds if H and K are convex and satisfy H −AK = Y (or
in particular AK ∩int H ̸= ∅).
Proof. Rephrasing the deﬁnition of the polar cone shows that for any cone
K ⊂E, the polar cone K−is just ∂δK(0). The result now follows by the
Fenchel theorem above.
♠
The polarity operation arises naturally from Fenchel conjugation, since
for any cone K ⊂E, we have δK−= δ∗
K, whence δK−−= δ∗∗
K . The next result,
which is an elementary application of the Basic separation theorem (2.1.6),
leads naturally into the development of the next chapter by identifying K−−
as the closed convex cone generated by K.
Theorem 3.3.14 (Bipolar cone) The bipolar cone of any nonempty set
K ⊂E is given by K−−= cl (conv (R+K)).
For example, we deduce immediately that the normal cone NC(x) to a convex
set C at a point x in C, and the (convex) tangent cone to C at x deﬁned by
TC(x) = cl R+(C −x), are polars of each other.
Exercise 20 outlines how to use these two results about cones to charac-
terize pointed cones (those closed convex cones K satisfying K ∩−K = {0}).
Theorem 3.3.15 (Pointed cones) A closed convex cone K ⊂E is pointed
if and only if there is an element y of E for which the set
C = {x ∈K | ⟨x, y⟩= 1}
is compact and generates K (that is, K = R+C).

66
Fenchel duality
Exercises and commentary
The conjugation operation has been closely associated with the names of Leg-
endre, Moreau, and Rockafellar, as well as Fenchel: see [149, 63]. Fenchel’s
original work is [68].
A good reference for properties of convex cones is
[137]: see also [19]. The log barriers of Proposition 3.3.3 play a key role in
interior point methods for linear and semideﬁnite programming — see for
example [135]. The self-duality of the positive semideﬁnite cone is due to
Fejer [88].
Hahn-Banach extension (Exercise 13(e)) is a key technique in
functional analysis: see for example [87]. Exercise 21 (Order subgradients)
is aimed at multi-criteria optimization: a good reference is [155]. Our ap-
proach may be found, for example, in [19]. The last three functions g in Table
3.3 are respectively known as the ‘Boltzmann-Shannon’, ‘Fermi-Dirac’, and
‘Bose-Einstein’ entropies.
1. For each of the functions f in the table at the end of the section, check
the calculation of f ∗, and check f = f ∗∗.
2. (Quadratics) For all matrices A in Sn
++, prove the function x ∈Rn →
xTAx/2 is convex and calculate its conjugate. Use the order-reversing
property of the conjugacy operation to prove
A ⪰B
⇔
B−1 ⪰A−1 for A and B in Sn
++.
3. Verify the conjugates of the log barriers lb and ld claimed in Proposi-
tion 3.3.3.
4. ∗(Self-conjugacy) Consider functions f : E →(−∞, +∞].
(a) Prove f = f ∗if and only if f(x) = ∥x∥2/2 for all points x in E.
(b) Find two distinct functions f satisfying f(−x) = f ∗(x) for all
points x in E.
5. ∗(Support functions) The conjugate of the indicator function of
a nonempty set C ⊂E, namely δ∗
C : E →(−∞, +∞], is called the
support function of C. Calculate it for the following sets:
(a) the halfspace {x | ⟨a, x⟩≤b}, for 0 ̸= a ∈E and b ∈R;
(b) the unit ball B;

§3.3
The Fenchel conjugate
67
(c) {x ∈Rn
+ | ∥x∥≤1};
(d) the polytope conv {a1, a2, . . . , am}, for given elements a1, a2, . . . , am
of E;
(e) a cone K;
(f) the epigraph of a convex function f : E →(−∞, +∞];
(g) the subdiﬀerential ∂f(¯x), where the function f : E →(−∞, +∞]
is convex and the point ¯x lies in core (dom f).
(h) {Y ∈Sn
+ | tr Y = 1}.
6. Calculate the conjugate and biconjugate of the function
f(x1, x2) =
⎧
⎪
⎪
⎨
⎪
⎪
⎩
x2
1
2x2 + x2 log x2 −x2,
if x2 > 0,
0,
if x1 = x2 = 0,
+∞,
otherwise.
7. ∗∗(Maximum entropy example)
(a) Prove the function g deﬁned by (3.3.1) is convex.
(b) For any point y in Rm+1, prove
g∗(y) =
sup
x∈Rm+1

i
(xi⟨ai, y⟩−exp∗(xi))


i
xi = 1

.
(c) Apply Exercise 27 in §3.1 to deduce the conjugacy formula (3.3.2).
(d) Compute the conjugate of the function of x ∈Rm+1,
 
i exp∗(xi)
(

i xi = 1)
+∞
(otherwise)
8. Prove the Fenchel-Young inequality.
9. ∗(Fenchel duality and convex calculus) Fill in the details for the
proof of Theorem 3.3.5 as follows.
(a) Prove the weak duality inequality.
(b) Prove the inclusion (3.3.10).

68
Fenchel duality
Now assume f and g are convex.
(c) Prove the function h deﬁned in the proof is convex, with domain
dom g −Adom f.
(d) Prove the implication (3.3.9) ⇒(3.3.8).
Finally, assume in addition condition (3.3.8) holds.
(e) Suppose φ ∈∂(f + g ◦A)(¯x). Use the ﬁrst part of the theorem
and the fact that ¯x is an optimal solution of the problem
inf
x∈E{(f(x) −⟨φ, x⟩) + g(Ax)}
to deduce equality in part (b).
(f) Prove points ¯x ∈E and ¯φ ∈Y are optimal for problems (3.3.6)
and (3.3.7) respectively if and only if they satisfy the conditions
A∗¯φ ∈∂f(¯x) and −¯φ ∈∂g(A¯x).
10. (Normals to an intersection) If the point x lies in two convex
subsets C and D of E satisfying 0 ∈core (C −D) (or in particular
C ∩int D ̸= ∅), use §3.1, Exercise 4 (Subgradients and normal cones)
to prove
NC∩D(x) = NC(x) + ND(x).
11. ∗(Failure of convex calculus)
(a) Find convex functions f, g : R →(−∞, +∞] with
∂f(0) + ∂g(0) ̸= ∂(f + g)(0).
(Hint: §3.1, Exercise 5.)
(b) Find a convex function g : R2 →(−∞, +∞] and a linear map
A : R →R2 with A∗∂g(0) ̸= ∂(g ◦A)(0).
12. ∗(Inﬁmal convolution) For convex functions f, g : E →(−∞, +∞],
we deﬁne the inﬁmal convolution f ⊙g : E →[−∞, +∞] by
(f ⊙g)(y) = inf
x {f(x) + g(y −x)}.

§3.3
The Fenchel conjugate
69
(a) Prove f ⊙g is convex. (On the other hand, if g is concave prove
so is f ⊙g.)
(b) Prove (f ⊙g)∗= f ∗+ g∗.
(c) If dom f ∩cont g ̸= ∅, prove (f + g)∗= f ∗⊙g∗.
(d) Given a set C ⊂E, deﬁne the distance function by
dC(x) = inf
y∈C ∥x −y∥.
(i) Prove d2
C is a diﬀerence of convex functions, by observing
(dC(x))2 = ∥x∥2/2 −(∥· ∥2/2 + δC)∗(x).
Now suppose C is convex.
(ii) Prove dC is convex and d∗
C = δB + δ∗
C.
(iii) For x in C prove ∂dC(x) = B ∩NC(x).
(iv) If C is closed and x ̸∈C, prove
∇dC(x) = dC(x)−1(x −PC(x)),
where PC(x) is the nearest point to x in C.
(v) If C is closed, prove
∇(d2
C/2)(x) = x −PC(x)
for all points x.
(e) Deﬁne the Lambert W-function W : R+ →R+ as the inverse of
y ∈R+ →yey. Prove the conjugate of the function
x ∈R →exp∗(x) + x2/2
is the function
y ∈R →W(ey) + (W(ey))2/2.
13. ∗(Applications of Fenchel duality)
(a) (Sandwich theorem) Let the functions f : E →(−∞, +∞] and
g : Y →(−∞, +∞] be convex, and the map A : E →Y be
linear. Suppose f ≥−g ◦A and 0 ∈core (dom g −Adom f) (or
Adom f ∩cont g ̸= ∅). Prove there is an aﬃne function α : E →R
satisfying f ≥α ≥−g ◦A.

70
Fenchel duality
(b) Interpret the Sandwich theorem geometrically in the case when A
is the identity.
(c) (Pshenichnii-Rockafellar conditions [141]) Suppose the con-
vex set C in E satisﬁes the condition C ∩cont f ̸= ∅(or int C ∩
dom f ̸= ∅). If f is bounded below on C, use part (a) to prove
there is an aﬃne function α ≤f with infC f = infC α.
De-
duce that a point ¯x minimizes f on C if and only if it satisﬁes
0 ∈∂f(¯x) + NC(¯x).
(d) Apply part (c) to the following two cases:
(i) C a single point {x0} ⊂E;
(ii) C a polyhedron {x | Ax ≤b}, where b ∈Rn = Y.
(e) (Hahn-Banach extension) If the function f : E →R is every-
where ﬁnite and sublinear, and for some linear subspace L of E
the function h : L →R is linear and dominated by f (in other
words f ≥h on L), prove there is a linear function α : E →R,
dominated by f, which agrees with h on L.
14. Fill in the details of the proof of the Krein-Rutman calculus (3.3.13).
15. ∗(Bipolar theorem) For any nonempty set K ⊂E, prove the set
cl (conv (R+K)) is the smallest closed convex cone containing K. De-
duce Theorem 3.3.14 (Bipolar cones).
16. ∗(Sums of closed cones)
(a) Prove that any cones H, K ⊂E satisfy (H + K)−= H−∩K−.
(b) Deduce that if H and K are closed convex cones then (H ∩K)−=
cl (H−+ K−), and prove that the closure can be omitted under
the condition K ∩int H ̸= ∅.
In R3, deﬁne sets
H
=
{x | x2
1 + x2
2 ≤x2
3,
x3 ≤0},
and
K
=
{x | x2 = −x3}.
(c) Prove H and K are closed convex cones.
(d) Calculate the polar cones H−, K−, and (H ∩K)−.

§3.3
The Fenchel conjugate
71
(e) Prove (1, 1, 1) ∈(H ∩K)−\ (H−+ K−), and deduce that the sum
of two closed convex cones is not necessarily closed.
17. ∗(Subdiﬀerential of a max-function) With the notation of §3.2,
Exercise 13, suppose
dom gj ∩

i∈I\{j}
cont gi ̸= ∅
for some index j in I. Prove
∂(max
i
gi)(¯x) = conv

i∈I
∂gi(¯x).
18. ∗(Order convexity) Given a Euclidean space Y and a closed convex
cone S ⊂Y, we write u ≤S v for points u and v in Y if v −u lies in S.
(a) Identify the partial order ≤S in the following cases:
(i) S = {0};
(ii) S = Y;
(iii) Y = Rn and S = Rn
+;
Given a convex set C ⊂E, we say a function F : C →Y is S-convex
if it satisﬁes
F(λx + µz) ≤S λF(x) + µF(z)
for all points x and z in E and nonnegative reals λ and µ satisfying
λ + µ = 1. If furthermore C is a cone and this inequality holds for all
λ and µ in R+ then we say F is S-sublinear.
(b) Identify S-convexity in the cases listed in part (a).
(c) Prove F is S-convex if and only if the function ⟨φ, F(·)⟩is convex
for all elements φ of −S−.
(d) Prove the following functions are Sn
+-convex:
(i) X ∈Sn →X2;
(ii) X ∈Sn
++ →−X−1;
(iii) X ∈Sn
+ →−X1/2.
Hint: use Exercise 25 in §3.1.

72
Fenchel duality
(e) Prove the function X ∈S2 →X4 is not S2
+-convex. Hint: consider
the matrices

4
2
2
1

and

4
0
0
8

.
19. (Order convexity of inversion) For any matrix A in Sn
++, deﬁne a
function qA : Rn →R by qA(x) = xTAx/2.
(a) Prove q∗
A = qA−1.
(b) For any other matrix B in Sn
++, prove 2(qA ⊙qB) ≤q(A+B)/2. (See
Exercise 12.)
(c) Deduce (A−1 + B−1)/2 ⪰((A + B)/2)−1.
20. ∗∗(Pointed cones and bases) Consider a closed convex cone K in
E. A base for K is a convex set C with 0 ̸∈cl C and K = R+C. Using
Exercise 16, prove the following properties are equivalent by showing
the implications
(a) ⇒(b) ⇒(c) ⇒(d) ⇒(e) ⇒(f) ⇒(a).
(a) K is pointed.
(b) cl (K−−K−) = E.
(c) K−−K−= E.
(d) K−has nonempty interior. (Here you may use the fact that K−
has nonempty relative interior — see §1.1, Exercise 13.)
(e) There exists a vector y in E and real ϵ > 0 with ⟨y, x⟩≥ϵ∥x∥, for
all points x in K.
(f) K has a bounded base.
21. ∗∗(Order-subgradients) This exercise uses the terminology of Exer-
cise 18, and we assume the cone S ⊂Y is pointed: S ∩−S = {0}. An
element y of Y is the S-inﬁmum of a set D ⊂Y (written y = infS D)
if the conditions
(i) D ⊂y + S and
(ii) D ⊂z + S for some z in Y implies y ∈z + S
both hold.

§3.3
The Fenchel conjugate
73
(a) Verify that this notion corresponds to the usual inﬁmum when
Y = R and S = R+.
(b) Prove every subset of Y has at most one S-inﬁmum.
(c) Prove decreasing sequences in S converge:
x0 ≥S x1 ≥S x2 . . . ≥S 0
implies limn xn exists and equals infS(xn). (Hint: prove S∩(x0−S)
is compact, using §1.1, Exercise 6 (Recession cones).)
An S-subgradient of F at a point x in C is a linear map T : E →Y
satisfying
T(z −x) ≤S F(z) −F(x) for all z in C.
The set of S-subgradients is denoted ∂SF(x). Suppose now x ∈core C.
Generalize the arguments of §3.1 in the following steps.
(d) For any direction h in E, prove
∇SF(x; h) = inf
S {t−1(F(x + th) −F(x)) | t > 0, x + th ∈C}
exists and, as a function of h, is S-sublinear.
(e) For any S-subgradient T ∈∂SF(x) and direction h ∈E, prove
Th ≤S ∇SF(x; h).
(f) Given h in E, prove there exists T in ∂SF(x) satisfying Th =
∇SF(x; h). Deduce the max formula
∇SF(x; h) = max{Th | T ∈∂SF(x)},
and in particular that ∂SF(x) is nonempty. (You should interpret
the ‘max’ in the formula.)
(g) The function F is Gˆateaux diﬀerentiable at x (with derivative the
linear map ∇F(x) : E →Y) if
lim
t→0 t−1(F(x + th) −F(x)) = (∇F(x))h
holds for all h in E. Prove this is the case if and only if ∂SF(x) is
a singleton.

74
Fenchel duality
Now ﬁx an element φ of −int (S−).
(h) Prove ⟨φ, F(·)⟩′(x; h) = ⟨φ, ∇SF(x; h)⟩.
(i) Prove F is Gˆateaux diﬀerentiable at x if and only if ⟨φ, F(·)⟩is
likewise.
22. ∗∗(Linearly constrained examples) Prove Corollary 3.3.11 (Fenchel
duality for linear constraints). Deduce duality theorems for the follow-
ing problems
(a) Separable problems
inf
 n

i=1
p(xi)
 Ax = b

,
where the map A : Rn →Rm is linear, b ∈Rm, and the function
p : R →(−∞, +∞] is convex, deﬁned as follows:
(i) (Nearest points in polyhedrons) p(t) = t2/2 with domain
R+;
(ii) (Analytic centre) p(t) = −log t with domain R++;
(iii) (Maximum entropy) p = exp∗.
What happens if the objective function is replaced by 
i pi(xi)?
(b) The BFGS update problem in §2.1, Exercise 13.
(c) The DAD problem in §3.1, Exercise 28.
(d) Example (3.3.1).
23. ∗(Linear inequalities) What does Corollary 3.3.11 (Fenchel duality
for linear constraints) become if we replace the constraint Ax = b by
Ax ∈b + K where K ⊂Y is a convex cone? Write down the dual
problem for §3.2, Exercise 2, part (a), solve it, and verify the duality
theorem.
24. (Symmetric Fenchel duality) For functions f, g : E →[−∞, +∞],
deﬁne the concave conjugate g∗: E →[−∞, +∞] by
g∗(φ) = inf
x∈E{⟨φ, x⟩−g(x)}.

§3.3
The Fenchel conjugate
75
Prove
inf(f −g) ≥sup(g∗−f ∗),
with equality if f is convex, g is concave, and
0 ∈core (dom f −dom (−g)).
25. ∗∗(Divergence bounds [122])
(a) Prove the function
t ∈R →2(2 + t)(exp∗t + 1) −3(t −1)2
is convex, and is minimized when t = 1.
(b) For v in R++ and u in R+, deduce the inequality
3(u −v)2 ≤2(u + 2v)(u log(u/v) −u + v).
Now suppose the vector p in Rn
++ satisﬁes n
1 pi = 1.
(c) If the vector q ∈Rn
++ satisﬁes n
1 qi = 1, use the Cauchy-Schwarz
inequality to prove the inequality
 n

1
|pi −qi|
2
≤3
n

1
(pi −qi)2
pi + 2qi
,
and deduce the inequality
n

1
pi log(pi/qi) ≥1
2
 n

1
|pi −qi|
2
.
(d) Hence show the inequality
log n +
n

1
pi log pi ≥1
2
 n

1
pi −1
n

2
.
(e) Use convexity to prove the inequality
n

1
pi log pi ≤log
n

1
p2
i .
(f) Deduce the bound
log n +
n

1
pi log pi ≤max pi
min pi
−1.

76
Fenchel duality
f(x) = g∗(x)
dom f
g(y) = f ∗(y)
dom g
0
R
0
{0}
0
R+
0
−R+
0
[−1, 1]
|y|
R
0
[0, 1]
y+
R
|x|p/p (1 < p ∈R)
R
|y|q/q ( 1
p + 1
q = 1)
R
|x|p/p (1 < p ∈R)
R+
|y+|q/q ( 1
p + 1
q = 1)
R
−xp/p (p ∈(0, 1))
R+
−(−y)q/q ( 1
p + 1
q = 1)
−R++
√
1 + x2
R
−√1 −y2
[−1, 1]
−log x
R++
−1 −log(−y)
−R++
cosh x
R
y sinh−1(y) −√1 + y2
R
−log(cos x)
(−π
2, π
2)
y tan−1(y) −1
2 log(1 + y2)
R
log(cosh x)
R
y tanh−1(y) + 1
2 log(1 −y2)
(−1, 1)
ex
R
⎧
⎨
⎩
y log y −y
(y > 0)
0
(y = 0)
R+
log(1 + ex)
R
⎧
⎪
⎪
⎨
⎪
⎪
⎩
y log y + (1 −y) log(1 −y)
(y ∈(0, 1))
0
(y = 0, 1)
[0, 1]
−log(1 −ex)
R
⎧
⎪
⎪
⎨
⎪
⎪
⎩
y log y −(1 + y) log(1 + y)
(y > 0)
0
(y = 0)
R+
Table 3.1: Conjugate pairs of convex functions on R

§3.3
The Fenchel conjugate
77
f = g∗
g = f ∗
f(x)
g(y)
h(ax) (a ̸= 0)
h∗(y/a)
h(x + b)
h∗(y) −by
ah(x) (a > 0)
ah∗(y/a)
Table 3.2: Transformed conjugates

Chapter 4
Convex analysis
4.1
Continuity of convex functions
We have already seen that linear functions are always continuous. More gen-
erally, a remarkable feature of convex functions on E is that they must be
continuous on the interior of their domains. Part of the surprise is that an
algebraic/geometric assumption (convexity) leads to a topological conclusion
(continuity). It is this powerful fact that guarantees the usefulness of reg-
ularity conditions like Adom f ∩cont g ̸= ∅(3.3.9) that we studied in the
previous section.
Clearly an arbitrary function f is bounded above on some neighbourhood
of any point in cont f. For convex functions the converse is also true, and
in a rather strong sense, needing the following deﬁnition. For a real L ≥0,
we say that a function f : E →(−∞, +∞] is Lipschitz (with constant L)
on a subset C of dom f if |f(x) −f(y)| ≤L∥x −y∥for any points x and
y in C.
If f is Lipschitz on a neighbourhood of a point z then we say
that f is locally Lipschitz around z. If Y is another Euclidean space we make
analogous deﬁnitions for functions F : E →Y, with ∥F(x)−F(y)∥replacing
|f(x) −f(y)|.
Theorem 4.1.1 (Local boundedness) Let f : E →(−∞, +∞] be a con-
vex function. Then f is locally Lipschitz around a point z in its domain if
and only if it is bounded above on a neighbourhood of z.
Proof. One direction is clear, so let us without loss of generality take z = 0,
f(0) = 0, and suppose f ≤1 on 2B: we shall deduce f is Lipschitz on B.
78

§4.1
Continuity of convex functions
79
Notice ﬁrst the bound f ≥−1 on 2B, since convexity implies f(−x) ≥
−f(x) on 2B. Now for any distinct points x and y in B, deﬁne α = ∥y −x∥
and ﬁx a point w = y +α−1(y −x), which lies in 2B. By convexity we obtain
f(y) −f(x) ≤
1
1 + αf(x) +
α
1 + αf(w) −f(x) ≤
2α
1 + α ≤2∥y −x∥,
and the result now follows, since x and y may be interchanged.
♠
This result makes it easy to identify the set of points at which a convex
function on E is continuous. First we prove a key lemma.
Lemma 4.1.2 Let ∆be the simplex {x ∈Rn
+ |  xi ≤1}. If the function
g : ∆→R is convex then it is continuous on int ∆.
Proof.
By the above result, we just need to show g is bounded above on
∆. But any point x in ∆satisﬁes
g(x)
=
g
 n

1
xiei + (1 −xi)0

≤
n

1
xig(ei) + (1 −xi)g(0)
≤
max{g(e1), g(e2), . . ., g(en), g(0)}
(where {e1, e2, . . ., en} is the standard basis in Rn).
♠
Theorem 4.1.3 (Convexity and continuity) Let f : E →(−∞, +∞] be
a convex function. Then f is continuous (in fact locally Lipschitz) on the
interior of its domain.
Proof.
We lose no generality if we restrict ourselves to the case E = Rn.
For any point x in int (dom f) we can choose a neighbourhood of x in dom f
which is a scaled-down, translated copy of the simplex (since the simplex is
bounded, with nonempty interior). The proof of the preceding lemma now
shows f is bounded above on a neighbourhood of x, and the result follows
by Theorem 4.1.1 (Local boundedness).
♠
Since it is easy to see that if the convex function f is locally Lipschitz around
a point ¯x in int (dom f) with constant L then ∂f(¯x) ⊂LB, we can also
conclude that ∂f(¯x) is a nonempty compact convex set. Furthermore, this

80
Convex analysis
result allows us to conclude quickly that ‘all norms on E are equivalent’ (see
Exercise 2).
We have seen that for a function f that is convex, the two sets cont f and
int (dom f) are identical. By contrast, our algebraic approach to the existence
of subgradients involved core (dom f). It transpires that this is the same set.
To see this we introduce the idea of the gauge function γC : E →(−∞, +∞]
associated with a nonempty set C in E:
γC(x) = inf{λ ∈R+ | x ∈λC}.
It is easy to check γC is sublinear (and in particular convex) when C is
convex. Notice γB = ∥· ∥.
Theorem 4.1.4 (Core and interior) The core and the interior of any
convex set in E are identical and convex.
Proof. Any convex set C ⊂E clearly satisﬁes int C ⊂core C. If we suppose,
without loss of generality, 0 ∈core C, then γC is everywhere ﬁnite, and hence
continuous by the previous result. We claim
int C = {x | γC(x) < 1}.
To see this, observe that the right hand side is contained in C, and is open
by continuity, and hence is contained in int C. The reverse inclusion is easy,
and we deduce int C is convex. Finally, since γC(0) = 0, we see 0 ∈int C,
which completes the proof.
♠
The conjugate of the gauge function γC is the indicator function of a set
C◦⊂E deﬁned by
C◦= {φ ∈E | ⟨φ, x⟩≤1 for all x ∈C}.
We call C◦the polar set for C. Clearly it is a closed convex set containing
0, and when C is a cone it coincides with the polar cone C−. The following
result therefore generalizes the Bipolar cone theorem (3.3.14).
Theorem 4.1.5 (Bipolar set) The bipolar set of any subset C of E is given
by
C◦◦= cl (conv (C ∪{0})).

§4.1
Continuity of convex functions
81
The ideas of polarity and separating hyperplanes are intimately related. The
separation-based proof of the above result (which we leave as an exercise) is
a good example, as is the next theorem, whose proof is outlined in Exercise
6.
Theorem 4.1.6 (Supporting hyperplane) Suppose that the convex set
C ⊂E has nonempty interior, and that the point ¯x lies on the boundary of
C. Then there is a supporting hyperplane to C at ¯x: there is a nonzero
element a of E satisfying ⟨a, x⟩≥⟨a, ¯x⟩for all points x in C.
(The set {x ∈E | ⟨a, x −¯x⟩= 0} is the supporting hyperplane.)
To end this section we use this result to prove a remarkable theorem of
Minkowski describing an extremal representation of ﬁnite-dimensional com-
pact convex sets. An extreme point of a convex set C ⊂E is a point x in C
whose complement C \ {x} is convex. We denote the set of extreme points
by ext C. We start with another exercise.
Lemma 4.1.7 Given a supporting hyperplane H of a convex set C ⊂E, any
extreme point of C ∩H is also an extreme point of C.
Our proof of Minkowski’s theorem depends on two facts: ﬁrst, any convex
set which spans E and contains 0 has nonempty interior (see §1.1, Exercise
13(b))); secondly, we can deﬁne the dimension of a set C ⊂E (written dim C)
as the dimension of span (C −x) for any point x in C (see §1.1, Exercise 12
(Aﬃne sets)).
Theorem 4.1.8 (Minkowski) Any compact convex set C ⊂E is the convex
hull of its extreme points.
Proof.
Our proof is by induction on dim C: clearly the result holds when
dim C = 0. Assume the result holds for all sets of dimension less than dim C.
We will deduce it for the set C.
By translating C, and redeﬁning E, we can assume 0 ∈C and span C = E.
Thus C has nonempty interior.
Given any point x in bd C, the Supporting hyperplane theorem (4.1.6)
shows C has a supporting hyperplane H at x. By the induction hypothesis
applied to the set C ∩H we deduce, using Lemma 4.1.7,
x ∈conv (ext (C ∩H)) ⊂conv (ext C).

82
Convex analysis
So we have proved bd C ⊂conv (ext C), whence conv (bd C) ⊂conv (ext C).
But since C is compact it is easy to see conv (bd C) = C, and the result now
follows.
♠
Exercises and commentary
An easy introduction to convex analysis in ﬁnite dimensions is [160]. The
approach we adopt here (and in the exercises) extends easily to inﬁnite di-
mensions: see [87, 118, 139]. The Lipschitz condition was introduced in [116].
Minkowski’s theorem ﬁrst appeared in [128, 129]. The Open mapping theo-
rem (Exercise 9) is another fundamental tool of functional analysis [87]. For
recent references on Pareto minimization (Exercise 12), see [40].
1. ∗(Points of continuity) Suppose the function f : E →(−∞, +∞] is
convex.
(a) Use the Local boundedness theorem (4.1.1) to prove that f is
continuous and ﬁnite at x if and only if it minorizes a function
g : E →(−∞, +∞] which is continuous and ﬁnite at x.
(b) Suppose f is continuous at some point y in dom f. Use part (a) to
prove directly that f is continuous at any point z in core (dom f).
(Hint: pick a point u in dom f such that z = δy + (1 −δ)u for
some real δ ∈(0, 1); now observe that the function
x ∈E →δ−1(f(δx + (1 −δ)u) −(1 −δ)f(u))
minorizes f.)
(c) Prove that f is continuous at a point x in dom f if and only if
(x, f(x) + ϵ) ∈int (epi f)
for some (all) real ϵ > 0.
(d) Assuming 0 ∈cont f, prove f ∗has bounded level sets. Deduce
that the function X ∈Sn →⟨C, X⟩+ ld (X) has compact level
sets for any matrix C in Sn
++.
(e) Assuming x ∈cont f, prove ∂f(x) is a nonempty compact convex
set.

§4.1
Continuity of convex functions
83
2. (Equivalent norms) A norm is a sublinear function |∥· |∥: E →R+
which satisﬁes |∥x|∥= |∥−x|∥> 0 for all nonzero points x in E. By
considering the function |∥· |∥on the standard unit ball B, prove any
norm |∥·|∥is equivalent to the Euclidean norm ∥·∥: there are constants
K ≥k > 0 with k∥x∥≤|∥x|∥≤K∥x∥for all x.
3. (Examples of polars) Calculate the polars of the following sets:
(a) conv (B ∪{(1, 1), (−1, −1)});
(b) {(x, y) ∈R2 | y ≥b + x2/2} (b ∈R).
4. (Polar sets and cones) Suppose the set C ⊂E is closed, convex, and
contains 0. Prove the convex cones in E × R
cl R+(C × {1}) and cl R+(C◦× {−1})
are mutually polar.
5. ∗(Polar sets) Suppose C is a nonempty subset of E.
(a) Prove γ∗
C = δC◦.
(b) Prove C◦is a closed convex set containing 0.
(c) Prove C ⊂C◦◦.
(d) If C is a cone, prove C◦= C−.
(e) For a subset D of E, prove C ⊂D implies D◦⊂C◦.
(f) Prove C is bounded if and only if 0 ∈int C◦.
(g) For any closed halfspace H ⊂E containing 0, prove H◦◦= H.
(h) Prove the Theorem 4.1.5 (Bipolar set).
6. ∗(Polar sets and strict separation) Fix a nonempty set C in E.
(a) For points x in int C and φ in C◦, prove ⟨φ, x⟩< 1.
(b) Assume further that C is a convex set. Prove γC is sublinear.
(c) Assume in addition 0 ∈core C. Deduce
cl C = {x | γC(x) ≤1}.

84
Convex analysis
(d) Finally, suppose in addition that D ⊂E is a convex set dis-
joint from the interior of C. By considering the Fenchel problem
inf{δD + γC}, prove there is a closed halfspace containing D but
disjoint from the interior of C.
7. ∗(Polar calculus [22]) Suppose C and D are subsets of E.
(a) Prove (C ∪D)◦= C◦∩D◦.
(b) If C and D are convex, prove
conv (C ∪D) =

λ∈[0,1]
(λC + (1 −λ)D).
(c) If C is a convex cone and the convex set D contains 0, prove
C + D ⊂cl conv (C ∪D).
Now suppose the closed convex sets K and H of E both contain 0.
(d) Prove (K ∩H)◦= cl conv (K◦∪H◦).
(e) If furthermore K is a cone, prove (K ∩H)◦= cl (K◦+ H◦).
8. ∗∗(Polar calculus [22]) Suppose P is a cone in E and C is a nonempty
subset of a Euclidean space Y.
(a) Prove (P × C)◦= P ◦× C◦.
(b) If furthermore C is compact and convex (possibly not containing
0), and K is a cone in E × Y, prove
(K ∩(P × C))◦= (K ∩(P × C◦◦))◦.
(c) If furthermore K and P are closed and convex, use Exercise 7 to
prove
(K ∩(P × C))◦= cl (K◦+ (P ◦× C◦)).
(d) Find a counterexample to part (c) when C is unbounded.
9. ∗(Open mapping theorem) Suppose the linear map A : E →Y is
surjective.

§4.1
Continuity of convex functions
85
(a) Prove any set C ⊂E satisﬁes Acore C ⊂core AC.
(b) Deduce A is an open map: the image of any open set is open.
(c) Prove another condition ensuring condition (3.3.8) in the Fenchel
theorem is that A is surjective and there is a point ˆx in int (dom f)
with Aˆx in dom g. Prove similarly that a suﬃcient condition for
Fenchel duality with linear constraints (Corollary 3.3.11) to hold
is A surjective and b ∈A(int (dom f)).
(d) Deduce that any cones H ⊂Y and K ⊂E, and any surjective
linear map A : E →Y satisfy (K ∩A−1H)−= A∗H−+ K−,
providing H ∩A(int K) ̸= ∅.
10. ∗(Conical absorption)
(a) If the set A ⊂E is convex, the set C ⊂E is bounded, and
R+A = E, prove there exists a real δ > 0 such that δC ⊂A.
Now deﬁne two sets in S2
+ by
A
=

y
x
x
z

∈S2
+
 |x| ≤y2/3

,
and
C
=
{X ∈S2
+ | tr X ≤1}.
(b) Prove that both A and C are closed, convex, and contain 0, and
that C is bounded.
(c) Prove R+A = S2
+ = R+C.
(d) Prove there is no real δ > 0 such that δC ⊂A.
11. (H¨older’s inequality) This question develops an alternative approach
to the theory of the p-norm ∥· ∥p deﬁned in §2.3, Exercise 6.
(a) Prove p−1∥x∥p
p is a convex function, and deduce the set
Bp = {x | ∥x∥p ≤1}
is convex.
(b) Prove the gauge function γBp(·) is exactly ∥· ∥p, and deduce ∥· ∥p
is convex.

86
Convex analysis
(c) Use the Fenchel-Young inequality (3.3.4) to prove that any vectors
x and φ in Rn satisfy the inequality
p−1∥x∥p
p + q−1∥φ∥q
q ≥⟨φ, x⟩.
(d) Assuming ∥u∥p = ∥v∥q = 1, deduce ⟨u, v⟩≤1, and hence prove
that any vectors x and φ in Rn satisfy the inequality
⟨φ, x⟩≤∥φ∥q∥x∥p.
(e) Calculate B◦
p.
12. ∗(Pareto minimization) We use the notation of §3.3, Exercise 18
(Order convexity), and we assume the cone S is pointed and has non-
empty interior. Given a set D ⊂Y, we say a point y in D is a Pareto
minimum of D (with respect to S) if
(y −D) ∩S = {0},
and a weak minimum if
(y −D) ∩int S = ∅.
(a) Prove y is a Pareto (respectively weak) minimum of D if and only
if it is a Pareto (respectively weak) minimum of D + S.
(b) Use the fact that the map X ∈Sn
+ →X1/2 is Sn
+-order-preserving
(§1.2, Exercise 5) to prove, for any matrix Z in Sn
+, the unique
Pareto minimum of the set
{X ∈Sn | X2 ⪰Z2}
with respect to Sn
+ is Z.
For a convex set C ⊂E and an S-convex function F : C →Y, we say
a point ¯x in C is a Pareto (respectively weak) minimum of the vector
optimization problem
inf{F(x) | x ∈C}
(4.1.9)
if F(¯x) is a Pareto (respectively weak) minimum of F(C).
(c) Prove F(C) + S is convex.

§4.1
Continuity of convex functions
87
(d) (Scalarization) Suppose ¯x is a weak minimum of the problem
(4.1.9). By separating (F(¯x)−F(C)−S) and int S (using Exercise
6), prove there is a nonzero element φ of −S−such that ¯x solves
the scalarized convex optimization problem
inf{⟨φ, F(x)⟩| x ∈C}.
Conversely, show any solution of this problem is a weak minimum
of (4.1.9).
13. (Existence of extreme points) Prove any nonempty compact convex
set C ⊂E has an extreme point without using Minkowski’s theorem,
by considering the furthest point in C from the origin.
14. Prove Lemma 4.1.7.
15. For any compact convex set C ⊂E, prove C = conv (bd C).
16. ∗(A converse of Minkowski’s theorem) Suppose D is a subset
of a compact convex set C ⊂E satisfying cl (conv D) = C.
Prove
ext C ⊂cl D.
17. ∗(Extreme points) Consider a compact convex set C ⊂E.
(a) If dim E ≤2 prove the set ext C is closed.
(b) If E is R3 and C is the closed convex hull of the set
{(x, y, 0) | x2 + y2 = 1} ∪{(1, 0, 1), (1, 0, −1)},
prove ext C is not closed.
18. ∗(Exposed points) A point x in a convex set C ⊂E is called exposed
if there is an element φ of E such that ⟨φ, x⟩> ⟨φ, z⟩for all points
z ̸= x in C.
(a) Prove any exposed point is an extreme point.
(b) Find a set in R2 with an extreme point which is not exposed.
19. ∗∗(Tangency conditions) Let Y be a Euclidean space. Fix a convex
set C in E and a point x in C.

88
Convex analysis
(a) Show x ∈core C if and only if TC(x) = E. (You may use Exercise
20(a).)
(b) For a linear map A : E →Y, prove ATC(x) ⊂TAC(Ax).
(c) For another convex set D in Y and a point y in D, prove
NC×D(x, y) = NC(x) × ND(y) and TC×D(x, y) = TC(x) × TD(y).
(d) Suppose the point x also lies in the convex set G ⊂E. Prove
TC(x) −TG(x) ⊂TC−G(0), and deduce
0 ∈core (C −G)
⇔
TC(x) −TG(x) = E.
(e) Show that the condition (3.3.8) in the Fenchel theorem can be
replaced by the condition
Tdom g(Ax) −ATdom f(x) = Y,
for an arbitrary point x in dom f ∩A−1dom g.
20. ∗∗(Properties of the relative interior) (We use Exercise 9 (Open
mapping theorem), as well as §1.1, Exercise 13.)
(a) Let D be a nonempty convex set in E. Prove D is a linear subspace
if and only if cl D is a linear subspace. (Hint: ri D ̸= ∅.)
(b) For a point x in a convex set C ⊂E, prove the following properties
are equivalent:
(i) x ∈ri C,
(ii) the tangent cone cl R+(C −x) is a linear subspace,
(iii) the normal cone NC(x) is a linear subspace,
(iv) y ∈NC(x) ⇒−y ∈NC(x).
(c) For a convex set C ⊂E and a linear map A : E →Y, prove
Ari C ⊃ri AC, and deduce
Ari C = ri AC.
(d) Suppose U and V are convex sets in E. Deduce
ri (U −V ) = ri U −ri V.

§4.1
Continuity of convex functions
89
(e) Apply §3.1, Exercise 29 (Relativizing the Max formula) to con-
clude that the condition (3.3.8) in the Fenchel theorem (3.3.5)
can be replaced by
ri (dom g) ∩Ari (dom f) ̸= ∅.
(f) Suppose the function f : E →(−∞, +∞] is bounded below on
the convex set C ⊂E, and ri C ∩ri (dom f) ̸= ∅. Prove there is
an aﬃne function α ≤f with infC f = infC α.
21. ∗∗(Essential smoothness) For any convex function f and any point
x ∈bd(dom f), prove ∂f(x) is either empty or unbounded. Deduce
that a function is essentially smooth if and only if its subdiﬀerential is
always singleton or empty.
22. ∗∗(Birkhoﬀ’s theorem [14]) We use the notation of §1.2.
(a) Prove Pn = {(zij) ∈Γn | zij = 0 or 1 for all i, j}.
(b) Prove Pn ⊂ext (Γn).
(c) Suppose (zij) ∈Γn \ Pn. Prove there exist sequences of distinct
indices i1, i2, . . . , im, and j1, j2, . . . , jm, such that
0 < zirjr, zir+1jr < 1
(r = 1, 2, . . ., m)
(where im+1 = i1). For these sequences, show the matrix (z′
ij)
deﬁned by
z′
ij −zij =
⎧
⎪
⎨
⎪
⎩
ϵ
if (i, j) = (ir, jr) for some r,
−ϵ
if (i, j) = (ir+1, jr) for some r,
0
otherwise,
is doubly stochastic for all small real ϵ. Deduce (zij) ̸∈ext (Γn).
(d) Deduce ext (Γn) = Pn. Hence prove Birkhoﬀ’s theorem (1.2.5).
(e) Use Carath´eodory’s theorem (§2.2, Exercise 5) to bound the num-
ber of permutation matrices needed to represent a doubly stochas-
tic matrix in Birkhoﬀ’s theorem.

90
Convex analysis
4.2
Fenchel biconjugation
We have seen that for many important convex functions h : E →(−∞, +∞],
the biconjugate h∗∗agrees identically with h. The table in §3.3 lists many
one-dimensional examples, and the Bipolar cone theorem (3.3.14) shows δK =
δ∗∗
K for any closed convex cone K.
In this section we isolate exactly the
circumstances when h = h∗∗.
We can easily check that h∗∗is a minorant of h (that is, h∗∗≤h point-
wise). Our speciﬁc aim in this section is to ﬁnd conditions on a point x in E
guaranteeing h∗∗(x) = h(x). This becomes the key relationship for the study
of duality in optimization. As we see in this section, the conditions we need
are both geometric and topological. This is neither particularly surprising
or stringent. Since any conjugate function must have a closed convex epi-
graph, we cannot expect a function to agree with its biconjugate unless it
itself has a closed convex epigraph. On the other hand, this restriction is not
particularly strong since, as the previous section showed, convex functions
automatically have strong continuity properties.
We say the function h : E →[−∞, +∞] is closed if its epigraph is a closed
set. We say h is lower semicontinuous at a point x in E if
lim inf h(xr) (= lim
s→∞inf
r≥s h(xr)) ≥h(x)
for any sequence xr →x. A function h : E →[−∞, +∞] is lower semi-
continuous if it is lower semicontinuous at every point in E: this is in fact
equivalent to h being closed, which in turn holds if and only if h has closed
level sets. Any two functions h and g satisfying h ≤g (in which case we call
h a minorant of g) must satisfy h∗≥g∗, and hence h∗∗≤g∗∗.
Theorem 4.2.1 (Fenchel biconjugation) The properties below are equiv-
alent, for any function h : E →(−∞, +∞]:
(a) h is closed and convex;
(b) h = h∗∗;
(c) for all points x in E,
h(x) = sup{α(x) | α an aﬃne minorant of h}.

§4.2
Fenchel biconjugation
91
Hence the conjugacy operation induces a bijection between proper closed con-
vex functions.
Proof.
We can assume h is proper. Since conjugate functions are always
closed and convex we know property (b) implies property (a). Also, any
aﬃne minorant α of h satisﬁes α = α∗∗≤h∗∗≤h, and hence property (c)
implies (b). It remains to show (a) implies (c).
Fix a point x0 in E.
Assume ﬁrst x0 ∈cl (dom h), and ﬁx any real
r < h(x0). Since h is closed, the set {x | h(x) > r} is open, so there is an
open convex neighbourhood U of x0 with h(x) > r on U. Now note that the
set dom h∩cont δU is nonempty, so we can apply the Fenchel theorem (3.3.5)
to deduce that some element φ of E satisﬁes
r ≤inf
x {h(x) + δU(x)} = {−h∗(φ) −δ∗
U(−φ)}.
(4.2.2)
Now deﬁne an aﬃne function α(·) = ⟨φ, ·⟩+ δ∗
U(−φ) + r. Inequality (4.2.2)
shows that α minorizes h, and by deﬁnition we know α(x0) ≥r. Since r was
arbitrary, (c) follows at the point x = x0.
Suppose on the other hand x0 does not lie in cl (dom h). By the Basic
separation theorem (2.1.6) there is a real b and a nonzero element a of E
satisfying
⟨a, x0⟩> b ≥⟨a, x⟩,
for all points x in dom h.
The argument in the preceding paragraph shows there is an aﬃne minorant
α of h. But now the aﬃne function α(·) + k(⟨a, ·⟩−b) is a minorant of h for
all k = 1, 2, . . .. Evaluating these functions at x = x0 proves property (c) at
x0. The ﬁnal remark follows easily.
♠
We can immediately deduce that a closed convex function h : E →[−∞, +∞]
equals its biconjugate if and only if it is proper or identically +∞or −∞.
Restricting the conjugacy bijection to ﬁnite sublinear functions gives the
following result.
Corollary 4.2.3 (Support functions) Fenchel conjugacy induces a bijec-
tion between everywhere-ﬁnite sublinear functions and nonempty compact
convex sets in E:
(a) If the set C ⊂E is compact, convex and nonempty then the support
function δ∗
C is everywhere ﬁnite and sublinear.

92
Convex analysis
(b) If the function h : E →R is sublinear then h∗= δC, where the set
C = {φ ∈E | ⟨φ, d⟩≤h(d) for all d ∈E}
is nonempty, compact and convex.
Proof. See Exercise 9.
♠
Conjugacy oﬀers a convenient way to recognize when a convex function
has bounded level sets.
Theorem 4.2.4 (Moreau-Rockafellar) A closed convex proper function
on E has bounded level sets if and only if its conjugate is continuous at 0.
Proof.
By Proposition 1.1.5, a convex function f : E →(−∞, +∞] has
bounded level sets if and only if it satisﬁes the growth condition
lim inf
∥x∥→∞
f(x)
∥x∥> 0.
Since f is closed we can check that this is equivalent to the existence of a
minorant of the form ϵ∥·∥+k ≤f(·), for some constants ϵ > 0 and k. Taking
conjugates, this is in turn equivalent to f ∗being bounded above near 0, and
the result then follows by Theorem 4.1.1 (Local boundedness).
♠
Strict convexity is also easy to recognize via conjugacy, using the following
result — see Exercise 19 for the proof.
Theorem 4.2.5 (Strict-smooth duality) A proper closed convex function
on E is essentially strictly convex if and only if its conjugate is essentially
smooth.
What can we say about h∗∗when the function h : E →[−∞, +∞] is
not necessarily closed? To answer this question we introduce the idea of the
closure of h, denoted cl h, deﬁned by
epi (cl h) = cl (epi h).
(4.2.6)
It is easy to verify that cl h is then well-deﬁned. The deﬁnition immediately
implies cl h is the largest closed function minorizing h. Clearly if h is convex,
so is cl h. We leave the proof of the next simple result as an exercise.

§4.2
Fenchel biconjugation
93
Proposition 4.2.7 (Lower semicontinuity and closure) A convex func-
tion f : E →[−∞, +∞] is lower semicontinuous at a point x where it is ﬁnite
if and only if f(x) = (cl f)(x). In this case f is proper.
We can now answer the question we posed at the beginning of the section.
Theorem 4.2.8 Suppose the function h : E →[−∞, +∞] is convex.
(a) If h∗∗is somewhere ﬁnite then h∗∗= cl h.
(b) For any point x where h is ﬁnite, h(x) = h∗∗(x) if and only if h is lower
semicontinuous at x.
Proof.
Observe ﬁrst that since h∗∗is closed and minorizes h, we know
h∗∗≤cl h ≤h. If h∗∗is somewhere ﬁnite then h∗∗(and hence cl h) is never
−∞, by applying Proposition 4.2.7 (Lower semicontinuity and closure) to
h∗∗. On the other hand, if h is ﬁnite and lower semicontinuous at x then
Proposition 4.2.7 shows cl h(x) is ﬁnite, and applying the proposition again
to cl h shows once more that cl h is never −∞. In either case, the Fenchel
biconjugation theorem implies cl h = (cl h)∗∗≤h∗∗≤cl h, so cl h = h∗∗. Part
(a) is now immediate, while part (b) follows by using Proposition 4.2.7 once
more.
♠
Any proper convex function h with an aﬃne minorant has its biconju-
gate h∗∗somewhere ﬁnite. (In fact, because E is ﬁnite-dimensional, h∗∗is
somewhere ﬁnite if and only if h is proper — see Exercise 25.)
Exercises and commentary
Our approach in this section again extends easily to inﬁnite dimensions:
see for example [63]. Our deﬁnition of a closed function is a little diﬀerent
to that in [149], although they coincide for proper functions. The original
version of von Neumann’s minimax theorem (Exercise 16) had both the sets
C and D simplices. The proof was by Brouwer’s ﬁxed point theorem (8.1.3).
The Fisher information function introduced in Exercise 24 is useful in signal
reconstruction [33]. The inequality in Exercise 20 (Logarithmic homogeneity)
is important for interior point methods [135, Prop. 2.4.1].
1. Prove that any function h : E →[−∞, +∞] satisﬁes h∗∗≤h.

94
Convex analysis
2. (Lower semicontinuity and closedness) For any given function
h : E →[−∞, +∞], prove the following properties are equivalent:
(a) h is lower semicontinuous;
(b) h has closed level sets;
(c) h is closed.
Prove that such a function has a global minimizer on any nonempty,
compact set.
3. (Pointwise maxima) Prove that if the functions fγ : E →[−∞, +∞]
are all convex (respectively closed) then the function deﬁned by f(x) =
supγ fγ(x) is convex (respectively closed). Deduce that for any function
h : E →[−∞, +∞], the conjugate function h∗is closed and convex.
4. Verify directly that any aﬃne function equals its biconjugate.
5. ∗(Midpoint convexity)
(a) A function f : E →(−∞, +∞] is midpoint convex if it satisﬁes
f
x + y
2

≤f(x) + f(y)
2
for all x and y in E.
Prove a closed function is convex if and only if it is midpoint
convex.
(b) Use the inequality
2(X2 + Y 2) ⪰(X + Y )2 for all X and Y in Sn
to prove the function Z ∈Sn
+ →−Z1/2 is Sn
+-convex (see §3.3,
Exercise 18 (Order convexity)).
6. Is the Fenchel biconjugation theorem (4.2.1) valid for functions h : E →
[−∞, +∞]?
7. (Inverse of subdiﬀerential) Consider a function h : E →(−∞, +∞].
If points x and φ in E satisfy φ ∈∂h(x), prove x ∈∂h∗(φ). Prove the
converse if h is closed and convex.

§4.2
Fenchel biconjugation
95
8. ∗(Closed subdiﬀerential) If a function h : E →(−∞, +∞] is closed,
prove the multifunction ∂h is closed:
φr ∈∂h(xr), xr →x, φr →φ
⇒φ ∈∂h(x).
Deduce that if h is essentially smooth and a sequence of points xr in
int (dom h) approaches a point in bd (dom h) then ∥∇h(xr)∥→∞.
9. ∗(Support functions)
(a) Prove that if the set C ⊂E is nonempty then δ∗
C is a closed
sublinear function, and δ∗∗
C = δcl convC. Prove that if C is also
bounded then δ∗
C is everywhere ﬁnite.
(b) Prove that any sets C, D ⊂E satisfy
δ∗
C+D
=
δ∗
C + δ∗
D,
and
δ∗
conv(C∪D)
=
max(δ∗
C, δ∗
D).
(c) Suppose the function h : E →(−∞, +∞] is positively homoge-
neous, and deﬁne a closed convex set
C = {φ ∈E | ⟨φ, d⟩≤h(d), ∀d}.
Prove h∗= δC. Prove that if h is in fact sublinear and everywhere
ﬁnite then C is nonempty and compact.
(d) Deduce Corollary 4.2.3 (Support functions).
10. ∗(Almost homogeneous functions [18]) Prove that a function
f : E →R has a representation
f(x) = max
i∈I {⟨ai, x⟩−bi}
(x ∈E)
for a compact set {(ai, bi) | i ∈I} ⊂E × R if and only if f is convex
and satisﬁes supE |f −g| < ∞for some sublinear function g.
11. ∗Complete the details of the proof of the Moreau-Rockafellar theorem
(4.2.4).
12. (Compact bases for cones) Consider a closed convex cone K. Using
the Moreau-Rockafellar theorem (4.2.4), show that a point x lies in
int K if and only if the set {φ ∈K−| ⟨φ, x⟩≥−1} is bounded. If the
set {φ ∈K−|⟨φ, x⟩= −1} is nonempty and bounded, prove x ∈int K.

96
Convex analysis
13. For any function h : E →[−∞, +∞], prove the set cl (epi h) is the
epigraph of some function.
14. ∗(Lower semicontinuity and closure) For any convex function
h : E →[−∞, +∞], and any point x0 in E, prove
(cl h)(x0) = lim
δ↓0
inf
∥x−x0∥≤δ h(x).
Deduce Proposition 4.2.7.
15. For any point x in E and any function h : E →(−∞, +∞] with a
subgradient at x, prove h is lower semicontinuous at x.
16. ∗(Von Neumann’s minimax theorem [164]) Suppose Y is a Eu-
clidean space. Suppose that the sets C ⊂E and D ⊂Y are nonempty
and convex, with D closed, and that the map A : E →Y is linear.
(a) By considering the Fenchel problem
inf
x∈E{δC(x) + δ∗
D(Ax)},
prove
inf
x∈C sup
y∈D⟨y, Ax⟩= max
y∈D inf
x∈C⟨y, Ax⟩,
(where the max is attained if ﬁnite), under the assumption
0 ∈core (dom δ∗
D −AC).
(4.2.9)
(b) Prove property (4.2.9) holds in either of the two cases
(i) D is bounded, or
(ii) A is surjective and 0 lies in int C. (Hint: use the Open map-
ping theorem, §4.1, Exercise 9).
(c) Suppose both C and D are compact. Prove
min
x∈C max
y∈D ⟨y, Ax⟩= max
y∈D min
x∈C ⟨y, Ax⟩.
17. (Recovering primal solutions) Assume all the conditions for the
Fenchel theorem (3.3.5) hold, and that in addition the functions f and
g are closed.

§4.2
Fenchel biconjugation
97
(a) Prove that if the point ¯φ ∈Y is an optimal dual solution then
the point ¯x ∈E is optimal for the primal problem if and only if
it satisﬁes the two conditions ¯x ∈∂f ∗(A∗¯φ) and A¯x ∈∂g∗(−¯φ).
(b) Deduce that if f ∗is diﬀerentiable at the point A∗¯φ then the only
possible primal optimal solution is ¯x = ∇f ∗(A∗¯φ).
(c) ∗∗Apply this result to the problems in §3.3, Exercise 22.
18. Calculate the support function δ∗
C of the set C = {x ∈R2 | x2 ≥x2
1}.
Prove the ‘contour’ {y | δ∗
C(y) = 1} is not closed.
19. ∗(Strict-smooth duality) Consider a proper closed convex function
f : E →(−∞, +∞].
(a) If f has Gˆateaux derivative y at a point x in E, prove the inequality
f ∗(z) > f ∗(y) + ⟨x, z −y⟩
for elements z of E distinct from y.
(b) If f is essentially smooth, prove f ∗is essentially strictly convex.
(c) Deduce the Strict-smooth duality theorem (4.2.5), using Exercise
23 in §3.1.
20. ∗(Logarithmic homogeneity) If the function f : E →(−∞, +∞] is
closed, convex and proper, then for any real ν > 0 prove the inequality
f(x) + f ∗(φ) + ν log ⟨x, −φ⟩≥ν log ν −ν for all x, φ ∈E
holds (where we interpret log α = −∞when α ≤0) if and only f
satisﬁes the condition
f(tx) = f(x) −ν log t for all x ∈E, t ∈R++.
(Hint: consider ﬁrst the case ν = 1, and use the inequality
α ≤−1 −log(−α). )
21. ∗(Coﬁniteness) Consider a function h : E →(−∞, +∞], and the
following properties:
(i) h(·) −⟨φ, ·⟩has bounded level sets for all φ in E;

98
Convex analysis
(ii) lim∥x∥→∞h(x)/∥x∥= +∞;
(iii) h∗is everywhere-ﬁnite.
Complete the following steps.
(a) Prove properties (i) and (ii) are equivalent.
(b) If h is closed, convex and proper, use the Moreau-Rockafellar the-
orem (4.2.4) to prove properties (i) and (iii) are equivalent.
22. ∗∗(Computing closures)
(a) Prove any closed convex function g : R →(−∞, +∞] is continu-
ous on its domain.
(b) Consider a convex function f : E →(−∞, +∞]. For any points x
in E and y in int (dom f), prove
f ∗∗(x) = lim
t↑1 f(y + t(x −y)).
Hint: use part (a) and the Accessibility lemma (§1.1, Exercise 11).
23. ∗∗(Recession functions) This exercise uses §1.1, Exercise 6 (Re-
cession cones).
The recession function of a closed convex function
f : E →(−∞, +∞] is deﬁned by
0+f(d) = sup
t∈R++
f(x + td) −f(x)
t
for d in E,
where x is any point in dom f.
(a) Prove 0+f is closed and sublinear.
(b) Prove epi (0+f) = 0+(epi f), and deduce that 0+f is independent
of the choice of the point x.
(c) For any real α > inf f, prove
0+{y ∈E | f(y) ≤α} = {d ∈E | 0+f(d) ≤0}.
24. ∗∗(Fisher information function) Let f : R →(−∞, +∞] be a given
function, and deﬁne a function g : R2 →(−∞, +∞] by
g(x, y) =

yf(x/y)
(y > 0)
+∞
(otherwise.)

§4.2
Fenchel biconjugation
99
(a) Prove g is convex if and only if f is convex.
(b) Suppose f is essentially strictly convex. For y and v in R++ and
x and u in R, prove
g(x, y) + g(u, v) = g(x + y, u + v)
⇔
x
y = u
v .
(c) Calculate g∗.
(d) Suppose f is closed, convex, and ﬁnite at 0. Using Exercises 22
and 23, prove
g∗∗(x, y) =
⎧
⎪
⎨
⎪
⎩
yf(x/y)
(y > 0)
0+f(x)
(y = 0)
+∞
(otherwise.)
(e) If f(x) = x2/2 for all x in R, calculate g.
(f) Deﬁne a set C = {(x, y) ∈R2 | x2 ≤y ≤x} and a function
h(x, y) =
⎧
⎪
⎨
⎪
⎩
x3/y2
((x, y) ∈C \ {0})
0
((x, y) = 0)
+∞
(otherwise.)
Prove h is closed and convex, but is not continuous relative to
its (compact) domain C. Construct another such example with
supC h ﬁnite.
25. ∗∗(Finiteness of biconjugate) Consider a convex function h : E →
[−∞, +∞].
(a) If h is proper and has an aﬃne minorant, prove h∗∗is somewhere
ﬁnite.
(b) If h∗∗is somewhere ﬁnite, prove h is proper.
(c) Use the fact that any proper convex function has a subgradient
(§3.1, Exercise 29) to deduce that h∗∗is somewhere ﬁnite if and
only if h is proper.
(d) Deduce h∗∗= cl h for any convex function h : E →(−∞, +∞].

100
Convex analysis
26. ∗∗(Self-dual cones [7]) Consider a function h : E →[−∞, ∞) for
which −h is closed and sublinear, suppose there is a point ˆx ∈E
satisfying h(ˆx) > 0.
Deﬁne the concave polar of h as the function
h◦: E →[−∞, ∞) given by
h◦(y) = inf{⟨x, y⟩| h(x) ≥1}.
(a) Prove −h◦is closed and sublinear, and, for real λ > 0, we have
λ(λh)◦= h◦.
(b) Prove the closed convex cone
Kh = {(x, t) ∈E × R | |t| ≤h(x)}
has polar (Kh)−= −Kh◦.
(c) Suppose the vector α ∈Rn
++ satisﬁes

i αi = 1, and deﬁne a
function hα : Rn →[−∞, +∞) by
hα(x) =
 
i xαi
i
(x ≥0)
−∞
(otherwise).
Prove hα
◦= hα/hα(α), and deduce the cone
Pα = K(hα(α))−1/2hα
is self-dual: P −
α = −Pα.
(d) Prove the cones
Q2
=
{(x, t, z) ∈R3 | t2 ≤2xz, x, z ≥0}. and
Q3
=
{(x, t, z) ∈R3 | 2|t|3 ≤
√
27xz2,
x, z ≥0}
are self-dual.
(e) Prove Q2 is isometric to S2
+: in other words, there is a linear map
A : R3 →S2
+ preserving the norm and satisfying AQ2 = S2
+.
27. ∗∗(Conical open mapping [7]) Deﬁne two closed convex cones in
R3:
Q
=
{(x, y, z) ∈R3 | y2 ≤2xz, x, z ≥0}. and
S
=
{(w, x, y) ∈R3 | 2|x|3 ≤
√
27wy2,
w, y ≥0}.
These cones are self-dual, by Exercise 26. Now deﬁne convex cones in
R4 by
C = (0 × Q) + (S × 0)
and
D = 0 × R3.

§4.2
Fenchel biconjugation
101
(a) Prove C ∩D = 0 × Q.
(b) Prove −C−= (R × Q) ∩(S × R).
(c) Deﬁne the projection P : R4 →R3 by P(w, x, y, z) = (x, y, z).
Prove P(C−) = −Q, or equivalently,
C−+ D−= (C ∩D)−.
(d) Deduce the normal cone formula
NC∩D(x) = NC(x) + ND(x) for all x in C ∩D,
and, by taking polars, the tangent cone formula
TC∩D(x) = TC(x) ∩TD(x) for all x in C ∩D.
(e) Prove C−is closed convex pointed cone with nonempty interior
and D−is a line, and yet there is no constant ϵ > 0 satisfying
(C−+ D−) ∩ϵB ⊂(C−∩B) + (D−∩B).
(Hint: prove, equivalently, there is no ϵ > 0 satisfying
P(C−) ∩ϵB ⊂P(C−∩B),
by considering the path {(t2, t3, t) | t ≥0} in Q.) Compare this
with the situation when C and D are subspaces, using the Open
mapping theorem (§4.1, Exercise 9).
(f) Consider the path
u(t) = (2/
√
27, t2, t3, 0)
(t ≥0).
Prove dC(u(t)) = 0 and dD(u(t)) = 2/
√
27 for all t ≥0 and yet
dC∩D(u(t)) →+∞as t →+∞.
(Hint: use the isometry in Exercise 26.)
28. ∗∗(Expected surprise [17]) An event occurs once every n days, with
probability pi on day i for i = 1, 2, . . ., n. We seek a distribution max-
imizing the average surprise caused by the event. Deﬁne the ‘surprise’

102
Convex analysis
as minus the logarithm of the probability that the event occurs on
day i given that it has not occurred so far. Using Bayes conditional
probability rule, our problem is
inf

S(p)

n

1
pi = 1

,
where we deﬁne the function S : Rn →(−∞, +∞] by
S(p) =
n

i=1
h
⎛
⎝pi,
n

j=i
pj
⎞
⎠,
and the function h : R2 →(−∞, +∞] by
h(x, y) =
⎧
⎪
⎨
⎪
⎩
x log(x/y)
(x, y > 0)
0
(x ≥0, y = 0)
+∞
(otherwise).
(a) Prove h is closed and convex, using Exercise 24 (Fisher informa-
tion function).
(b) Hence prove S is closed and convex.
(c) Prove the problem has an optimal solution.
(d) By imitating §3.1, Exercise 27 (Maximum entropy), show the so-
lution ¯p is unique and is expressed recursively by
¯p1 = µ1,
¯pk = µk

1 −
k−1

1
¯pj

(k = 2, 3, . . ., n),
where the numbers µk are deﬁned by the recursion
µn = 1,
µk−1 = µke−µk (k = 2, 3, . . ., n).
(e) Deduce that the components of ¯p form an increasing sequence,
and that ¯pn−j is independent of j.
(f) Prove ¯p1 ∼1/n for large n.

§4.3
Lagrangian duality
103
4.3
Lagrangian duality
The duality between a convex function h and its Fenchel conjugate h∗that we
outlined earlier is an elegant piece of theory. The real signiﬁcance, however,
lies in its power to describe duality theory for convex programs, one of the
most far-reaching ideas in the study of optimization.
We return to the convex program that we studied in §3.2:
⎧
⎪
⎨
⎪
⎩
inf
f(x)
subject to
g(x)
≤
0,
x
∈
E.
(4.3.1)
Here, the function f and the components g1, g2, . . ., gm : E →(−∞, +∞]
are convex, and satisfy ∅̸= dom f ⊂∩m
1 dom gi. As before, the Lagrangian
function L : E × Rm
+ →(−∞, +∞] is deﬁned by L(x; λ) = f(x) + λTg(x).
Notice that the Lagrangian encapsulates all the information of the primal
problem (4.3.1): clearly
sup
λ∈Rm
+
L(x; λ) =

f(x),
if x is feasible,
+∞,
otherwise,
so if we denote the optimal value of (4.3.1) by p ∈[−∞, +∞], we could
rewrite the problem in the following form:
p = inf
x∈E sup
λ∈Rm
+
L(x; λ).
(4.3.2)
This makes it rather natural to consider an associated problem:
d = sup
λ∈Rm
+
inf
x∈E L(x; λ),
(4.3.3)
where d ∈[−∞, +∞] is called the dual value. Thus the dual problem consists
of maximizing over vectors λ in Rm
+ the dual function Φ(λ) = infx L(x; λ).
This dual problem is perfectly well-deﬁned without any assumptions on the
functions f and g. It is an easy exercise to show the ‘weak duality inequality’
p ≥d. Notice Φ is concave.
It can happen that the primal value p is strictly larger than the dual value
d (see Exercise 5). In this case we say there is a duality gap. In this section
we investigate conditions ensuring there is no duality gap. As in §3.2, the

104
Convex analysis
chief tool in our analysis is the primal value function v : Rm →[−∞, +∞],
deﬁned by
v(b) = inf{f(x) | g(x) ≤b}.
(4.3.4)
Below we summarize the relationships between these various ideas and pieces
of notation.
Proposition 4.3.5 (Dual optimal value)
(a) The primal optimal value p is v(0).
(b) The conjugate of the value function satisﬁes
v∗(−λ) =

−Φ(λ),
if λ ≥0,
+∞,
otherwise.
(c) The dual optimal value d is v∗∗(0).
Proof. Part (a) is just the deﬁnition of p. Part (b) follows from the identities
v∗(−λ)
=
sup{−λTb −v(b) | b ∈Rm}
=
sup{−λTb −f(x) | g(x) + z = b, x ∈dom f, b ∈Rm, z ∈Rm
+}
=
sup{−λT(g(x) + z) −f(x) | x ∈dom f, z ∈Rm
+}
=
−inf{f(x) + λTg(x) | x ∈dom f} + sup{−λTz | z ∈Rm
+}
=

−Φ(λ),
if λ ≥0,
+∞,
otherwise.
Finally, we observe
d = sup
λ∈Rm
+
Φ(λ) = −inf
λ∈Rm
+
−Φ(λ) = −inf
λ∈Rm
+
v∗(−λ) = v∗∗(0),
so part (c) follows.
♠
Notice the above result does not use convexity.
The reason for our interest in the relationship between a convex function
and its biconjugate should now be clear, in light of parts (a) and (c) above.
Corollary 4.3.6 (Zero duality gap) Suppose the value of the primal prob-
lem (4.3.1) is ﬁnite. Then the primal and dual values are equal if and only
if the value function v is lower semicontinuous at 0. In this case the set of
optimal dual solutions is −∂v(0).

§4.3
Lagrangian duality
105
Proof. By the previous result, there is no duality gap exactly when the value
function satisﬁes v(0) = v∗∗(0), so Theorem 4.2.8 proves the ﬁrst assertion.
By part (b) of the previous result, dual optimal solutions λ are characterized
by the property 0 ∈∂v∗(−λ), or equivalently, v∗(−λ) + v∗∗(0) = 0. But we
know v(0) = v∗∗(0), so this property is equivalent to the condition −λ ∈
∂v(0).
♠
This result sheds new light on our proof of the Lagrangian necessary
conditions (3.2.8): the proof in fact demonstrates the existence of a dual
optimal solution. We consider below two distinct approaches to proving the
absence of a duality gap. The ﬁrst uses the Slater condition, as in Theorem
3.2.8, to force attainment in the dual problem. The second (dual) approach
uses compactness to force attainment in the primal problem.
Theorem 4.3.7 (Dual attainment) If the Slater condition holds for the
primal problem (4.3.1) then the primal and dual values are equal, and the
dual value is attained if ﬁnite.
Proof.
If p is −∞there is nothing to prove, since we know p ≥d. If on
the other hand p is ﬁnite then, as in the proof of the Lagrangian necessary
conditions (3.2.8), the Slater condition forces ∂v(0) ̸= ∅. Hence v is ﬁnite
and lower semicontinuous at 0 (§4.2, Exercise 15), and the result follows by
Corollary 4.3.6 (Zero duality gap).
♠
An indirect way of stating the Slater condition is that there is a point
ˆx in E for which the set {λ ∈Rm
+ | L(ˆx; λ) ≥α} is compact for all real α.
The second approach uses a ‘dual’ condition to ensure the value function is
closed.
Theorem 4.3.8 (Primal attainment) Suppose that the functions
f, g1, g2, . . ., gm : E →(−∞, +∞]
are closed, and that for some real ˆλ0 ≥0 and some vector ˆλ in Rm
+, the
function ˆλ0f + ˆλTg has compact level sets. Then the value function v deﬁned
by equation (4.3.4) is closed, and the inﬁmum in this equation is attained
when ﬁnite. Consequently, if the functions f, g1, g2, . . . , gm are in addition
convex and the dual value for the problem (4.3.1) is not −∞, then the primal
and dual values, p and d, are equal, and the primal value is attained when
ﬁnite.

106
Convex analysis
Proof.
If the points (br, sr) lie in epi v for r = 1, 2, . . ., and approach
the point (b, s), then for each integer r there is a point xr in E satisfying
f(xr) ≤sr + r−1 and g(xr) ≤br. Hence we deduce
(ˆλ0f + ˆλTg)(xr) ≤ˆλ0(sr + r−1) + ˆλTbr →ˆλ0s + ˆλTb.
By the compact level set assumption, the sequence (xr) has a subsequence
converging to some point ¯x, and since all the functions are closed, we know
f(¯x) ≤s and g(¯x) ≤b. We deduce v(b) ≤s, so (b, s) lies in epi v as we
required. When v(b) is ﬁnite, the same argument with (br, sr) replaced by
(b, v(b)) for each r shows the inﬁmum is attained.
If the functions f, g1, g2, . . . , gm are convex then we know (from §3.2) v
is convex. If d is +∞then, then again from the inequality p ≥d, there is
nothing to prove. If d (= v∗∗(0)) is ﬁnite then Theorem 4.2.8 shows v∗∗= cl v,
and the above argument shows cl v = v. Hence p = v(0) = v∗∗(0) = d, and
the result follows.
♠
Notice that if either the objective function f or any one of the constraint
functions g1, g2, . . . , gm has compact level sets then the compact level set
condition in the above result holds.
Exercises and commentary
An attractive elementary account of ﬁnite-dimensional convex duality theory
appears in [138]. A good reference for this kind of development in inﬁnite
dimensions is [87]. When the value function v is lower semicontinuous at 0 we
say the problem (4.3.1) is normal (see [149]). If ∂v(0) ̸= ∅(or v(0) = −∞) the
problem is called stable (see for example [5]). For a straightforward account
of interior point methods and the penalized linear program in Exercise 4
(Examples of duals), see [166, p. 40]. For more on the minimax theory in
Exercise 14, see for example [55].
1. (Weak duality) Prove that the primal and dual values, p and d, de-
ﬁned by equations (4.3.2) and (4.3.3), satisfy p ≥d.
2. Calculate the Lagrangian dual of the problem in §3.2, Exercise 3.

§4.3
Lagrangian duality
107
3. (Slater and compactness) Prove the Slater condition holds for prob-
lem (4.3.1) if and only if there is a point ˆx in E for which the level sets
{λ ∈Rm
+ | −L(ˆx; λ) ≤α}
are compact for all real α.
4. (Examples of duals) Calculate the Lagrangian dual problem for the
following problems (for given vectors a1, a2, . . ., am and c in Rn).
(a) The linear program
inf
x∈Rn{⟨c, x⟩| ⟨ai, x⟩≤bi (i = 1, 2, . . ., m)}.
(b) The linear program
inf
x∈Rn{⟨c, x⟩+ δRn
+(x) | ⟨ai, x⟩≤bi (i = 1, 2, . . ., m)}.
(c) The quadratic program (for C ∈Sn
++)
inf
x∈Rn{xTCx/2 | ⟨ai, x⟩≤bi (i = 1, 2, . . ., m)}.
(d) The separable problem
inf
x∈Rn
⎧
⎨
⎩
n

j=1
p(xj)
 ⟨ai, x⟩≤bi (i = 1, 2, . . . , m)
⎫
⎬
⎭,
for a given function p : R →(−∞, +∞].
(e) The penalized linear program
inf
x∈Rn{⟨c, x⟩+ ϵlb (x) | ⟨ai, x⟩≤bi (i = 1, 2, . . ., m)},
(for real ϵ > 0).
For given matrices A1, A2, . . . , Am and C in Sn, calculate the dual of
the semideﬁnite program
inf
X∈Sn
+
{tr (CX) + δSn
+(X) | tr (AiX) ≤bi (i = 1, 2, . . ., m)},
and the penalized semideﬁnite program
inf
X∈Sn
+
{tr (CX) + ϵld X | tr (AiX) ≤bi (i = 1, 2, . . ., m)}
(for real ϵ > 0).

108
Convex analysis
5. (Duﬃn’s duality gap, continued)
(a) For the problem considered in §3.2 Exercise 8, namely
inf
x∈R2 {ex2 | ∥x∥−x1 ≤0} ,
calculate the dual function and hence ﬁnd the dual value.
(b) Repeat part (a) with the objective function ex2 replaced by x2.
6. Consider the problem
⎧
⎪
⎨
⎪
⎩
inf
exp∗(x1) + exp∗(x2)
subject to
x1 + 2x2 −1
≤
0,
x
∈
R2.
Write down the Lagrangian dual problem, solve the primal and dual
problems, and verify the optimal values are equal.
7. Given a matrix C in Sn
++, calculate
inf
X∈Sn
++
{tr (CX) | −log(det X) ≤0}
by Lagrangian duality.
8. ∗(Mixed constraints) Explain why an appropriate dual for the prob-
lem
inf{f(x) | g(x) ≤0, h(x) = 0}
(for a function h : dom f →Rk) is
sup
λ∈Rm
+ , µ∈Rk
inf
x∈dom f{f(x) + λTg(x) + µTh(x)}.
9. (Fenchel and Lagrangian duality) Let Y be a Euclidean space. By
suitably rewriting the primal Fenchel problem
inf
x∈E{f(x) + g(Ax)}
(for given functions f : E →(−∞, +∞], g : Y →(−∞, +∞], and
linear A : E →Y), interpret the dual Fenchel problem
sup
φ∈Y{−f ∗(A∗φ) −g∗(−φ)}
as a Lagrangian dual problem.

§4.3
Lagrangian duality
109
10. (Trust region subproblem duality [154]) Given a matrix A in Sn
and a vector b in Rn, consider the nonconvex problem
⎧
⎪
⎨
⎪
⎩
inf
xTAx + bTx
subject to
xTx −1
≤
0,
x
∈
Rn.
Complete the following steps to prove there is an optimal dual solution,
with no duality gap.
(i) Prove the result when A is positive semideﬁnite.
(ii) If A is not positive deﬁnite, prove the primal optimal value does
not change if we replace the inequality in the constraint by an
equality.
(iii) By observing, for any real α, the equality
min{xTAx + bTx | xTx = 1} =
−α + min{xT(A + αI)x + bTx | xTx = 1},
prove the general result.
11. ∗∗If there is no duality gap, prove that dual optimal solutions are the
same as Karush-Kuhn-Tucker vectors (§3.2, Exercise 9).
12. ∗(Conjugates of compositions) Consider the composition g ◦f of
a nondecreasing convex function g : R →(−∞, +∞] with a convex
function f : E →(−∞, +∞]. We interpret g(+∞) = +∞, and we
assume there is a point ˆx in E satisfying f(ˆx) ∈int (dom g).
Use
Lagrangian duality to prove the formula, for φ in E,
(g ◦f)∗(φ) = inf
t∈R+{g∗(t) + tf ∗(φ/t)},
where we interpret
0f ∗(φ/0) = δ∗
dom f(φ).
13. ∗∗(A symmetric pair [27])
(a) Given real γ1, γ2, . . ., γn > 0, deﬁne h : Rn →(−∞, +∞] by
h(x) =
 n
i=1 x−γi
i
(x ∈Rn
++)
+∞
(otherwise).

110
Convex analysis
By writing g(x) = exp(log g(x)) and using the composition for-
mula in Exercise 12, prove
h∗(y) =

−(γ + 1) n
i=1(−yi/γi)γi/(γ+1)
(−y ∈Rn
+)
+∞
(otherwise),
where γ = 
i γi.
(b) Given real α1, α2, . . . , αn > 0, deﬁne α = 
i αi and suppose a
real µ satisﬁes µ > α + 1. Now deﬁne a function f : Rn × R →
(−∞, +∞] by
f(x, s) =

(sµ/µ) 
i x−αi
i
(x ∈Rn
++, s ∈R+)
+∞
(otherwise).
Use part (a) to prove
f ∗(y, t) =

ρ(tν/ν)

i(−yi)−βi
(−y ∈Rn
++, t ∈R+)
+∞
(otherwise),
for constants
ν =
µ
µ −(α + 1),
βi =
αi
µ −(α + 1),
ρ =
	
i
αi
µ
βi
.
(c) Deduce f = f ∗∗, whence f is convex.
(d) Give an alternative proof of the convexity of f by using §4.2,
Exercise 24(a) (Fisher information function) and induction.
(e) Prove f is strictly convex.
14. ∗∗(Convex minimax theory) Suppose that Y is a Euclidean space,
that the sets C ⊂Y and D ⊂E are nonempty, and consider a function
ψ : C × D →R.
(a) Prove the inequality
sup
y∈D inf
x∈C ψ(x, y) ≤inf
x∈C sup
y∈D ψ(x, y).

§4.3
Lagrangian duality
111
(b) We call a point (¯x, ¯y) in C × D a saddlepoint if it satisﬁes
ψ(¯x, y) ≤ψ(¯x, ¯y) ≤ψ(x, ¯y),
for all x ∈C, y ∈D.
In this case, prove
sup
y∈D inf
x∈C ψ(x, y) = ψ(¯x, ¯y) = inf
x∈C sup
y∈D ψ(x, y).
(c) Suppose the function py : E →(−∞, +∞] deﬁned by
py(x) =

ψ(x, y),
if x ∈C,
+∞,
otherwise,
is convex, for all y in D. Prove the function h : Y →[−∞, +∞]
deﬁned by
h(z) = inf
x∈C sup
y∈D{ψ(x, y) + ⟨z, y⟩}
is convex.
(d) Suppose the function qx : Y →(−∞, +∞] deﬁned by
qx(y) =

−ψ(x, y),
if y ∈D,
+∞,
otherwise,
is closed and convex for all points x in C. Deduce
h∗∗(0) = sup
y∈D inf
x∈C ψ(x, y).
(e) Suppose that for all points y in D the function py deﬁned in part
(c) is closed and convex, and that for some point ˆy in D, pˆy has
compact level sets. If h is ﬁnite at 0, prove it is lower semicontin-
uous there. If the assumption in part (d) also holds, deduce
sup
y∈D inf
x∈C ψ(x, y) = min
x∈C sup
y∈D ψ(x, y).
(f) Suppose the functions f, g1, g2, . . . , gs : Rt →(−∞, +∞] are
closed and convex. Interpret the above results in the following
two cases:

112
Convex analysis
(i)
C
=
(dom f) ∩(∩s
i=1dom gi),
D
=
Rs
+, and
ψ(u, w)
=
f(u) +
s

i=1
wigi(u);
(ii)
C
=
Rs
+,
D
=
(dom f) ∩(∩s
i=1dom gi), and
ψ(u, w)
=
−f(w) −
s

i=1
uigi(w).
(g) (Kakutani [98]) Suppose that the nonempty sets C ⊂Y and
D ⊂E are compact and convex, that the function ψ : C ×D →R
is continuous, that ψ(x, y) is convex in the variable x for all ﬁxed
y in D, and that −ψ(x, y) is convex in the variable y for all points
x in C. Deduce ψ has a saddlepoint.

Chapter 5
Special cases
5.1
Polyhedral convex sets and functions
In our earlier section on theorems of the alternative (§2.2), we observed
that ﬁnitely generated cones are closed. Remarkably, a ﬁnite linear-algebraic
assumption leads to a topological conclusion. In this section we pursue the
consequences of this type of assumption in convex analysis.
There are two natural ways to impose a ﬁnite linear structure on the sets
and functions we consider. The ﬁrst we have already seen: a ‘polyhedron’
(or polyhedral set) is a ﬁnite intersection of closed halfspaces in E, and we
say a function f : E →[−∞, +∞] is polyhedral if its epigraph is polyhedral.
On the other hand, a polytope is the convex hull of a ﬁnite subset of E, and
we call a subset of E ﬁnitely generated if it is the sum of a polytope and a
ﬁnitely generated cone (in the sense of formula (2.2.11)). Notice we do not
yet know if a cone which is a ﬁnitely generated set in this sense is ﬁnitely
generated in the sense of (2.2.11): we return to this point later in the section.
The function f is ﬁnitely generated if its epigraph is ﬁnitely generated. A
central result of this section is that polyhedra and ﬁnitely generated sets in
fact coincide.
We begin with some easy observations collected together in the following
two results.
Proposition 5.1.1 (Polyhedral functions) Suppose the function f : E →
[−∞, +∞] is polyhedral. Then f is closed and convex, and can be decomposed
in the form
f = max
i∈I gi + δP,
(5.1.2)
113

114
Special cases
where the index set I is ﬁnite (and possibly empty), the functions gi are aﬃne,
and the set P ⊂E is polyhedral (and possibly empty). Thus the domain of f
is polyhedral, and coincides with dom ∂f if f is proper.
Proof. Since any polyhedron is closed and convex, so is f, and the decom-
position (5.1.2) follows directly from the deﬁnition. If f is proper then both
the sets I and P are nonempty in this decomposition. At any point x in
P (= dom f) we know 0 ∈∂δP(x), and the function maxi gi certainly has a
subgradient at x since it is everywhere ﬁnite. Hence we deduce the condition
∂f(x) ̸= ∅.
♠
Proposition 5.1.3 (Finitely generated functions) Suppose the function
f : E →[−∞, +∞] is ﬁnitely generated. Then f is closed and convex, and
dom f is ﬁnitely generated. Furthermore, f ∗is polyhedral.
Proof.
Polytopes are compact and convex (by Carath´eodory’s theorem
(§2.2, Exercise 5)), and ﬁnitely generated cones are closed and convex, so
ﬁnitely generated sets (and therefore functions) are closed and convex, by
§1.1, Exercise 5(a). We leave the remainder of the proof as an exercise.
♠
An easy exercise shows that a set P ⊂E is polyhedral (respectively, ﬁnitely
generated) if and only if δP is likewise.
To prove that polyhedra and ﬁnitely generated sets in fact coincide, we
consider the two extreme special cases: ﬁrst, compact sets, and secondly,
cones. Observe ﬁrst that compact, ﬁnitely generated sets are just polytopes,
directly from the deﬁnition.
Lemma 5.1.4 Any polyhedron has at most ﬁnitely many extreme points.
Proof. Fix a ﬁnite set of aﬃne functions {gi | i ∈I} on E, and consider the
polyhedron
P = {x ∈E | gi(x) ≤0 for i ∈I}.
For any point x in P, the ‘active set’ is {i ∈I | gi(x) = 0}. Suppose two
distinct extreme points x and y of P have the same active set. Then, for any
small real ϵ, the points x ± ϵ(y −x) both lie in P. But this contradicts the
assumption that x is extreme. Hence diﬀerent extreme points have diﬀerent
active sets, and the result follows.
♠

§5.1
Polyhedral convex sets and functions
115
This lemma, together with Minkowski’s theorem (4.1.8) reveals the nature
of compact polyhedra.
Theorem 5.1.5 Any compact polyhedron is a polytope.
We next turn to cones.
Lemma 5.1.6 Any polyhedral cone is a ﬁnitely generated cone (in the sense
of (2.2.11)).
Proof.
Given a polyhedral cone P ⊂E, deﬁne a subspace L = P ∩−P,
and a pointed polyhedral cone K = P ∩L⊥. Observe the decomposition
P = K ⊕L. By the Pointed cone theorem (3.3.15), there is an element y of
E for which the set
C = {x ∈K | ⟨x, y⟩= 1}
is compact and satisﬁes K = R+C. Since C is polyhedral, the previous result
shows it is a polytope. Thus K is ﬁnitely generated, whence so is P.
♠
Theorem 5.1.7 (Polyhedrality) A set or function is polyhedral if and only
if it is ﬁnitely generated.
Proof.
For ﬁnite sets {ai | i ∈I} ⊂E and {bi | i ∈I} ⊂R, consider the
polyhedron in E deﬁned by
P = {x ∈E | ⟨ai, x⟩≤bi for i ∈I}.
The polyhedral cone in E × R deﬁned by
Q = {(x, r) ∈E × R | ⟨ai, x⟩−bir ≤0 for i ∈I}
is ﬁnitely generated, by the previous lemma, so there are ﬁnite subsets
{xj | j ∈J} and {yt | t ∈T} of E with
Q =
⎧
⎨
⎩

j∈J
λj(xj, 1) +

t∈T
µt(yt, 0)
 λj ∈R+ for j ∈J, µt ∈R+ for t ∈T
⎫
⎬
⎭.
We deduce
P
=
{(x, 1) ∈Q}
=
conv {xj | j ∈J} +

t∈T
µtyy
 µt ∈R+ for t ∈T

,

116
Special cases
so P is ﬁnitely generated. We have thus shown that any polyhedral set (and
hence function) is ﬁnitely generated.
Conversely, suppose the function f : E →[−∞, +∞] is ﬁnitely gener-
ated. Consider ﬁrst the case when f is proper. By Proposition 5.1.3, f ∗
is polyhedral, and hence (by the above argument) ﬁnitely generated. But
f is closed and convex, by Proposition 5.1.3, so the Fenchel biconjugation
theorem (4.2.1) implies f = f ∗∗. By applying Proposition 5.1.3 once again
we see f ∗∗(and hence f) is polyhedral. We leave the improper case as an
exercise.
♠
Notice these two results show our two notions of a ﬁnitely generated cone do
indeed coincide.
The following collection of exercises shows that many linear-algebraic
operations preserve polyhedrality.
Proposition 5.1.8 (Polyhedral algebra) Consider a Euclidean space Y
and a linear map A : E →Y.
(a) If the set P ⊂E is polyhedral then so is its image AP.
(b) If the set K ⊂Y is polyhedral then so is its inverse image A−1K.
(c) The sum and pointwise maximum of ﬁnitely many polyhedral functions
are polyhedral.
(d) If the function g : Y →[−∞, +∞] is polyhedral then so is the composite
function g ◦A.
(e) If the function q : E × Y →[−∞, +∞] is polyhedral then so is the
function h : Y →[−∞, +∞] deﬁned by h(u) = infx∈E q(x, u).
Corollary 5.1.9 (Polyhedral Fenchel duality) All the conclusions of the
Fenchel duality theorem (3.3.5) remain valid if the regularity condition (3.3.8)
is replaced by the assumption that the functions f and g are polyhedral with
dom g ∩Adom f nonempty.
Proof. We follow the original proof, simply observing that the value function
h deﬁned in the proof is polyhedral, by the Polyhedral algebra proposition
above. Thus when the optimal value is ﬁnite, h has a subgradient at 0.
♠

§5.1
Polyhedral convex sets and functions
117
We conclude this section with a result emphasizing the power of Fenchel
duality for convex problems with linear constraints.
Corollary 5.1.10 (Mixed Fenchel duality) All the conclusions of the
Fenchel duality theorem (3.3.5) remain valid if the regularity condition (3.3.8)
is replaced by the assumption that dom g∩Acont f is nonempty and the func-
tion g is polyhedral.
Proof. Assume without loss of generality the primal optimal value
p = inf
x∈E{f(x) + g(Ax)} =
inf
x∈E, r∈R{f(x) + r | g(Ax) ≤r}
is ﬁnite. By assumption there is a feasible point for the problem on the right
at which the objective function is continuous, so there is an aﬃne function
α : E × R →R minorizing the function (x, r) →f(x) + r such that
p =
inf
x∈E, r∈R{α(x, r) | g(Ax) ≤r}
(see §3.3, Exercise 13(c)). Clearly α has the form α(x, r) = β(x)+r for some
aﬃne minorant β of f, so
p = inf
x∈E{β(x) + g(Ax)}.
Now we apply the Polyhedral Fenchel duality theorem to deduce the existence
of an element φ of Y such that
p = −β∗(A∗φ) −g∗(−φ) ≤−f ∗(A∗φ) −g∗(−φ) ≤p
(using the weak duality inequality), and the duality result follows.
The
calculus rules follow as before.
♠
It is interesting to compare this result with the version of Fenchel duality
using the Open mapping theorem (§4.1, Exercise 9), where the assumption
that g is polyhedral is replaced by surjectivity of A.
Exercises and commentary
Our approach in this section is analogous to [160]. The key idea, Theorem
5.1.7 (Polyhedrality), is due to Minkowski [128] and Weyl [165].
A nice
development of geometric programming (see Exercise 13) appears in [138].

118
Special cases
1. Prove directly from the deﬁnition that any polyhedral function has a
decomposition of the form (5.1.2).
2. Finish the proof of the Finitely generated functions proposition (5.1.3).
3. Use Proposition 4.2.7 ((Lower semicontinuity and closure) to show that
if a ﬁnitely generated function f is not proper then it has the form
f(x) =

+∞,
if x ∈K,
−∞,
if x ̸∈K,
for some ﬁnitely generated set K.
4. Prove a set K ⊂E is polyhedral (respectively, ﬁnitely generated) if and
only if δK is likewise. Do not use the Polyhedrality theorem (5.1.7).
5. Complete the proof of the Polyhedrality theorem (5.1.7) for improper
functions, using Exercise 3.
6. (Tangents to polyhedra) Prove the tangent cone to a polyhedron P
at a point x in P is given by TP(x) = R+(P −x).
7. ∗(Polyhedral algebra) Prove Proposition 5.1.8 using the following
steps.
(i) Prove parts (a)–(d).
(ii) In the notation of part (e), consider the natural projection
PY×R : E × Y × R →Y × R.
Prove the inclusions
PY×R(epi q) ⊂epi h ⊂cl (PY×R(epi q)).
(iii) Deduce part (e).
8. If the function f : E →(−∞, +∞] is polyhedral, prove the subdif-
ferential of f at a point x in dom f is a nonempty polyhedron, and is
bounded if and only if x lies in int (dom f).

§5.1
Polyhedral convex sets and functions
119
9. (Polyhedral cones) For any polyhedral cones H ⊂Y and K ⊂E
and any linear map A : E →Y, prove the relation
(K ∩A−1H)−= A∗H−+ K−,
using convex calculus.
10. Apply the Mixed Fenchel duality corollary (5.1.10) to the problem
inf{f(x) | Ax ≤b}, for a linear map A : E →Rm and a point b in
Rm.
11. ∗(Generalized Fenchel duality) Consider convex functions
h1, h2, . . ., hm : E →(−∞, +∞]
with ∩icont hi nonempty. By applying the Mixed Fenchel duality corol-
lary (5.1.10) to the problem
inf
x,x1,x2,...,xm∈E
 m

i=1
hi(xi)
 xi = x (i = 1, 2, . . ., m)

,
prove
inf
x∈E

i
hi(x) = −
inf
φ1,φ2,...,φm∈E

i
h∗
i (φi)


i
φi = 0

.
12. ∗∗(Relativizing Mixed Fenchel duality) In the Mixed Fenchel du-
ality corollary (5.1.10), prove the condition dom g ∩Acont f ̸= ∅can
be replaced by dom g ∩Ari (dom f) ̸= ∅.
13. ∗∗(Geometric programming) Consider the constrained geometric
program
inf
x∈E{h0(x) | hi(x) ≤1 (i = 1, 2, . . ., m)},
where each function hi is a sum of functions of the form
x ∈E →c log
⎛
⎝
n

j=1
exp ⟨aj, x⟩
⎞
⎠
for real c > 0 and elements a1, a2, . . ., an of E. Write down the La-
grangian dual problem and simplify it using Exercise 11 and the form
of the conjugate of each hi given by (3.3.1). State a duality theorem.

120
Special cases
5.2
Functions of eigenvalues
Fenchel conjugacy gives a concise and beautiful avenue to many eigenvalue
inequalities in classical matrix analysis. In this section we outline this ap-
proach.
The two cones Rn
+ and Sn
+ appear repeatedly in applications, as do their
corresponding logarithmic barriers lb and ld , which we deﬁned in §3.3. We
can relate the vector and matrix examples, using the notation of §1.2, through
the identities
δSn
+ = δRn
+ ◦λ,
and ld = lb ◦λ.
(5.2.1)
We see in this section that these identities fall into a broader pattern.
Recall the function [·] : Rn →Rn rearranges components into nonin-
creasing order. We say a function f on Rn is symmetric if f(x) = f([x]) for
all vectors x in Rn: in other words, permuting components does not change
the function value. The following formula is crucial.
Theorem 5.2.2 (Spectral conjugacy) Any function f : Rn →[−∞, +∞]
which is symmetric satisﬁes the formula
(f ◦λ)∗= f ∗◦λ.
Proof. By Fan’s inequality (1.2.2), any matrix Y in Sn satisﬁes the inequal-
ities
(f ◦λ)∗(Y )
=
sup
X∈Sn{tr (XY ) −f(λ(X))}
≤
sup
X {λ(X)Tλ(Y ) −f(λ(X))}
≤
sup
x∈Rn{xTλ(Y ) −f(x)}
=
f ∗(λ(Y )).
On the other hand, ﬁxing a spectral decomposition Y = UT(Diag λ(Y ))U
for some matrix U in On leads to the reverse inequality:
f ∗(λ(Y ))
=
sup
x∈Rn{xTλ(Y ) −f(x)}
=
sup
x {tr ((Diag x)UY UT) −f(x)}
=
sup
x {tr (UT(Diag x)UY ) −f(λ(UTDiag xU))}
≤
sup
X∈Sn{tr (XY ) −f(λ(X))}
=
(f ◦λ)∗(Y ).
♠

§5.2
Functions of eigenvalues
121
This formula, for example, makes it very easy to calculate ld ∗(see the Log
barriers proposition (3.3.3)), and to check the self-duality of the cone Sn
+.
Once we can compute conjugates easily, we can also recognize closed
convex functions easily, using the Fenchel biconjugation theorem (4.2.1).
Corollary 5.2.3 (Davis) Suppose the function f : Rn →(−∞, +∞] is
symmetric. Then the ‘spectral function’ f ◦λ is closed and convex if and only
if f is closed and convex.
We deduce immediately that the logarithmic barrier ld is closed and convex,
as well as the function X →tr (X−1) on Sn
++, for example.
Identifying subgradients is also easy using the conjugacy formula and the
Fenchel-Young inequality (3.3.4).
Corollary 5.2.4 (Spectral subgradients) Suppose f : Rn →(−∞, +∞]
is a symmetric function. Then for any two matrices X and Y in Sn, the
following properties are equivalent:
(i) Y ∈∂(f ◦λ)(X);
(ii) X and Y have a simultaneous ordered spectral decomposition and satisfy
λ(Y ) ∈∂f(λ(X));
(iii) X = UT(Diag x)U and Y = UT(Diag y)U for some matrix U in On
and vectors x and y in Rn satisfying y ∈∂f(x).
Proof. Notice the inequalities
(f ◦λ)(X) + (f ◦λ)∗(Y ) = f(λ(X)) + f ∗(λ(Y )) ≥λ(X)Tλ(Y ) ≥tr (XY ).
The condition Y ∈∂(f ◦λ)(X) is equivalent to equality between the left- and
right-hand-sides (and hence throughout), and the equivalence of properties
(i) and (ii) follows, using Fan’s inequality (1.2.1). For the remainder of the
proof, see Exercise 9.
♠
Corollary 5.2.5 (Spectral diﬀerentiability) Suppose that the function
f : Rn →(−∞, +∞] is symmetric, closed and convex. Then f ◦λ is diﬀer-
entiable at a matrix X in Sn if and only if f is diﬀerentiable at λ(X).

122
Special cases
Proof.
If ∂(f ◦λ)(X) is a singleton, so is ∂f(λ(X)), by the Spectral sub-
gradients corollary above.
Conversely, suppose ∂f(λ(X)) consists only of
the vector y ∈Rn. Using Exercise 9(b), we see the components of y are
nonincreasing, so by the same corollary, ∂(f ◦λ)(X) is the nonempty convex
set
{UT(Diag y)U | U ∈On, UTDiag (λ(X))U = X}.
But every element of this set has the same norm (namely ∥y∥), so the set
must be a singleton.
♠
Notice that the proof in fact shows that when f is diﬀerentiable at λ(X) we
have the formula
∇(f ◦λ)(X) = UT(Diag ∇f(λ(X)))U,
(5.2.6)
for any matrix U in On satisfying UT(Diag λ(X))U = X.
The pattern of these results is clear: many analytic and geometric prop-
erties of the matrix function f ◦λ parallel the corresponding properties of
the underlying function f. The following exercise is another example.
Corollary 5.2.7 Suppose the function f : Rn →(−∞, +∞] is symmetric,
closed and convex. Then f ◦λ is essentially strictly convex (respectively,
essentially smooth) if and only if f is likewise.
For example, the logarithmic barrier ld is both essentially smooth and es-
sentially strictly convex.
Exercises and commentary
Our approach in this section follows [109]. The Davis theorem (5.2.3) ap-
peared in [54] (without the closure assumption). Many convexity properties
of eigenvalues like Exercise 4 (Examples of convex spectral functions) can be
found in [88] or [9], for example. A survey of eigenvalue optimization appears
in [115].
1. Prove the identities (5.2.1).
2. Use the Spectral conjugacy theorem (5.2.2) to calculate ld ∗and δ∗
Sn
+.

§5.2
Functions of eigenvalues
123
3. Prove the Davis characterization (Corollary 5.2.3) using the Fenchel
biconjugation theorem (4.2.1).
4. (Examples of convex spectral functions) Use the Davis charac-
terization (Corollary 5.2.3) to prove the following functions of a matrix
X ∈Sn are closed and convex:
(a) ld (X);
(b) tr (Xp), for any nonnegative even integer p;
(c)

−tr (X1/2),
if X ∈Sn
+,
+∞,
otherwise;
(d)

tr (X−p),
if X ∈Sn
++,
+∞,
otherwise,
for any nonnegative integer p;
(e)

tr (X1/2)−1,
if X ∈Sn
++,
+∞,
otherwise;
(f)

−(det X)1/n,
if X ∈Sn
+,
+∞,
otherwise.
Deduce from the sublinearity of the function in part (f) the property
0 ⪯X ⪯Y ⇒0 ≤det X ≤det Y
for matrices X and Y in Sn.
5. Calculate the conjugate of each of the functions in Exercise 4.
6. Use formula (5.2.6) to calculate the gradients of the functions in Exer-
cise 4.

124
Special cases
7. For a matrix A in Sn
++ and a real b > 0, use the Lagrangian suﬃcient
conditions (3.2.3) to solve the problem
⎧
⎪
⎨
⎪
⎩
inf
f(X)
subject to
tr (AX)
≤
b,
X
∈
Sn,
where f is one of the functions in Exercise 4.
8. ∗(Orthogonal invariance) A function h : Sn →(−∞, +∞] is orthog-
onally invariant if all matrices X in Sn and U in On satisfy the relation
h(UTXU) = h(X): in other words, orthogonal similarity transforma-
tions do not change the value of h.
(a) Prove h is orthogonally invariant if and only if there is a symmetric
function f : Rn →(−∞, +∞] with h = f ◦λ.
(b) Prove that an orthogonally invariant function h is closed and con-
vex if and only if h ◦Diag is closed and convex.
9. ∗Suppose the function f : Rn →(−∞, +∞] is symmetric.
(a) Prove f ∗is symmetric.
(b) If vectors x and y in Rn satisfy y ∈∂f(x), prove [y] ∈∂f([x]),
using Proposition 1.2.4.
(c) Complete the proof of the Spectral subgradients corollary (5.2.4).
(d) Deduce ∂(f ◦λ)(X) = ∅
⇔
∂f(λ(X)) = ∅.
(e) Prove Corollary 5.2.7.
10. ∗(Fillmore-Williams [70]) Suppose the set C ⊂Rn is symmetric:
that is, PC = C holds for all permutation matrices P. Prove the set
λ−1(C) = {X ∈Sn | λ(X) ∈C}
is closed and convex if and only if C is closed and convex.
11. ∗∗(Semideﬁnite complementarity) Suppose matrices X and Y lie
in Sn
+.
(a) If tr (XY ) = 0, prove −Y ∈∂δSn
+(X).

§5.2
Functions of eigenvalues
125
(b) Hence prove the following properties are equivalent:
(i) tr (XY ) = 0;
(ii) XY = 0;
(iii) XY + Y X = 0.
(c) Using Exercise 5 in §1.2, prove, for any matrices U and V in Sn,
(U2 + V 2)1/2 = U + V
⇔
U, V ⪰0 and tr (UV ) = 0.
12. ∗∗(Eigenvalue sums) Consider a vector µ in Rn
≥.
(a) Prove the function µTλ(·) is sublinear, using §2.2, Exercise 9
(Schur-convexity).
(b) Deduce the map λ is (−Rn
≥)−-sublinear. (See §3.3, Exercise 18
(Order convexity).)
(c) Use §3.1, Exercise 10 to prove
∂(µTλ)(0) = λ−1(conv (Pnµ)).
13. ∗∗(Davis theorem) Suppose the function f : Rn →[−∞, +∞] is
symmetric (but not necessarily closed). Use Exercise 12 (Eigenvalue
sums) and §2.2, Exercise 9(d) (Schur-convexity) to prove that f ◦λ is
convex if and only if f is convex.
14. ∗(DC functions) We call a real function f on a convex set C ⊂E
a DC function if it can be written as the diﬀerence of two real convex
functions on C.
(a) Prove the set of DC functions is a vector space.
(b) If f is a DC function, prove it is locally Lipschitz on int C.
(c) Prove λk is a DC function on Sn for all k, and deduce it is locally
Lipschitz.

126
Special cases
5.3
Duality for linear and semideﬁnite pro-
gramming
Linear programming (‘LP’) is the study of optimization problems involving a
linear objective function subject to linear constraints. This simple optimiza-
tion model has proved enormously powerful in both theory and practice, so
we devote this section to deriving linear programming duality theory from our
convex-analytic perspective. We contrast this theory with the corresponding
results for ‘semideﬁnite programming’ (‘SDP’), a class of matrix optimization
problems analogous to linear programs but involving the positive semideﬁnite
cone.
Linear programs are inherently polyhedral, so our main development fol-
lows directly from the polyhedrality section (§5.1). But to begin, we sketch
an alternative development directly from the Farkas lemma (2.2.7). Given
vectors a1, a2, . . . , am and c in Rn and a vector b in Rm, consider the primal
linear program
⎧
⎪
⎨
⎪
⎩
inf
⟨c, x⟩
subject to
⟨ai, x⟩−bi
≤
0,
for i = 1, 2, . . ., m,
x
∈
Rn.
(5.3.1)
Denote the primal optimal value by p ∈[−∞, +∞].
In the Lagrangian
duality framework (§4.3), the dual problem is
⎧
⎪
⎨
⎪
⎩
sup
−bTµ
subject to
m
i=1 µiai
=
−c
µ
∈
Rm
+,
(5.3.2)
with dual optimal value d ∈[−∞, +∞]. From §4.3 we know the weak duality
inequality p ≥d. If the primal problem (5.3.1) satisﬁes the Slater condition
then the Dual attainment theorem (4.3.7) shows p = d with dual attainment
when the values are ﬁnite. However, as we shall see, the Slater condition is
superﬂuous here.
Suppose the primal value p is ﬁnite.
Then it is easy to see that the
‘homogenized’ system of inequalities in Rn+1,
⎧
⎪
⎨
⎪
⎩
⟨ai, x⟩−biz
≤
0,
for i = 1, 2, . . ., m,
−z
≤
0,
and
⟨−c, x⟩+ pz
>
0,
x ∈Rn,
z ∈R,
(5.3.3)

§5.3
Duality for linear and semideﬁnite programming
127
has no solution. Applying the Farkas lemma (2.2.7) to this system, we deduce
there is a vector ¯µ in Rn
+ and a scalar β in R+ satisfying
m

i=1
¯µi(ai, −bi) + β(0, −1) = (−c, p).
Thus ¯µ is a feasible solution for the dual problem (5.3.2), with objective value
at least p. The weak duality inequality now implies ¯µ is optimal and p = d.
We needed no Slater condition: the assumption of a ﬁnite primal optimal
value alone implies zero duality gap and dual attainment.
We can be more systematic using our polyhedral theory. Suppose that Y
is a Euclidean space, that the map A : E →Y is linear, and consider cones
H ⊂Y and K ⊂E. For given elements c of E and b of Y, consider the
primal ‘abstract linear program’
⎧
⎪
⎨
⎪
⎩
inf
⟨c, x⟩
subject to
Ax −b
∈
H,
x
∈
K.
(5.3.4)
As usual, denote the optimal value by p. We can write this problem in Fenchel
form (3.3.6) if we deﬁne functions f on E and g on Y by f(x) = ⟨c, x⟩+δK(x)
and g(y) = δH(y −b). Then the Fenchel dual problem (3.3.7) is
⎧
⎪
⎨
⎪
⎩
sup
⟨b, φ⟩
subject to
A∗φ −c
∈
K−,
φ
∈
−H−,
(5.3.5)
with dual optimal value d. If we now apply the Fenchel duality theorem
(3.3.5) in turn to problem (5.3.4), and then to problem (5.3.5) (using the
Bipolar cone theorem (3.3.14)), we obtain the following general result.
Corollary 5.3.6 (Cone programming duality) Suppose the cones H and
K in problem (5.3.4) are convex.
(a) If any of the conditions
(i) b ∈int (AK −H),
(ii) b ∈AK −int H, or

128
Special cases
(iii) b ∈A(int K) −H, and
H is polyhedral or
A is surjective
hold then there is no duality gap (p = d) and the dual optimal value d
is attained if ﬁnite.
(b) Suppose H and K are also closed. If any of the conditions
(i) −c ∈int (A∗H−+ K−),
(ii) −c ∈A∗H−+ int K−, or
(iii) −c ∈A∗(int H−) + K−, and
K is polyhedral or
A∗is surjective
hold then there is no duality gap and the primal optimal value p is
attained if ﬁnite.
In both parts (a) and (b), the suﬃciency of condition (iii) follows by applying
the Mixed Fenchel duality corollary (5.1.10), or the Open mapping theorem
(§4.1, Exercise 9). In the fully polyhedral case we obtain the following result.
Corollary 5.3.7 (Linear programming duality) Suppose the cones H
and K in the the dual pair of problems (5.3.4) and (5.3.5) are polyhedral. If
either problem has ﬁnite optimal value then there is no duality gap and both
problems have optimal solutions.
Proof.
We apply the Polyhedral Fenchel duality corollary (5.1.9) to each
problem in turn.
♠
Our earlier result, for the linear program (5.3.1), is clearly just a special case
of this corollary.
Linear programming has an interesting matrix analogue. Given matri-
ces A1, A2, . . . , Am and C in Sn
+ and a vector b in Rm, consider the primal
semideﬁnite program
⎧
⎪
⎨
⎪
⎩
inf
tr (CX)
subject to
tr (AiX)
=
bi,
for i = 1, 2, . . ., m,
X
∈
Sn
+.
(5.3.8)

§5.3
Duality for linear and semideﬁnite programming
129
This is a special case of the abstract linear program (5.3.4), so the dual
problem is
⎧
⎪
⎨
⎪
⎩
sup
bTφ
subject to
C −
m
i=1 φiAi
∈
Sn
+,
φ
∈
Rm,
(5.3.9)
since (Sn
+)−= −Sn
+, by the Self-dual cones proposition (3.3.12), and we
obtain the following duality theorem from the general result above.
Corollary 5.3.10 (Semideﬁnite programming duality) When the pri-
mal problem (5.3.8) has a positive deﬁnite feasible solution, there is no duality
gap and the dual optimal value is attained when ﬁnite. On the other hand, if
there is a vector φ in Rm with C −

i φiAi positive deﬁnite then once again
there is no duality gap and the primal optimal value is attained when ﬁnite.
Unlike linear programming, we need a condition stronger than mere con-
sistency to guarantee no duality gap. For example, if we consider the primal
semideﬁnite program (5.3.8) with
n = 2, m = 1, C =

0
1
1
0

, A1 =

1
0
0
0

, and b = 0,
the primal optimal value is 0 (and is attained), whereas the dual problem
(5.3.9) is inconsistent.
Exercises and commentary
The importance of linear programming duality was ﬁrst emphasized by Dant-
zig [53], and that of semideﬁnite duality by Nesterov and Nemirovskii [135]. A
good general reference for linear programming is [49]. A straightforward ex-
position of the central path (see Exercise 10) may be found in [166]. Semidef-
inite programming has wide application in control theory [42].
1. Check the form of the dual problem for the linear program (5.3.1).
2. If the optimal value of problem (5.3.1) is ﬁnite, prove system (5.3.3)
has no solution.
3. (Linear programming duality gap) Give an example of a linear
program of the form (5.3.1) which is inconsistent (p = +∞) and yet
the dual problem (5.3.2) is also inconsistent (d = −∞).

130
Special cases
4. Check the form of the dual problem for the abstract linear program
(5.3.4).
5. Fill in the details of the proof of the Cone programming duality corol-
lary (5.3.6). In particular, when the cones H and K are closed, show
how to interpret problem (5.3.4) as the dual of problem (5.3.5).
6. Fill in the details of the proof of the linear programming duality corol-
lary (5.3.7).
7. (Complementary slackness) Suppose we know the optimal values
of problems (5.3.4) and (5.3.5) are equal and the dual value is attained.
Prove a feasible solution x for problem (5.3.4) is optimal if and only if
there is a feasible solution φ for the dual problem (5.3.5) satisfying the
conditions
⟨Ax −b, φ⟩= 0 = ⟨x, A∗φ −c⟩.
8. (Semideﬁnite programming duality) Prove Corollary 5.3.10.
9. (Semideﬁnite programming duality gap) Check the details of the
example after Corollary 5.3.10.
10. ∗∗(Central path) Consider the dual pair of linear programs (5.3.1)
and (5.3.2). Deﬁne a linear map A : Rn →Rm by (Ax)i = (ai)Tx for
each index i. Make the following assumptions:
(i) There is a vector x in Rn satisfying b −Ax ∈Rn
++.
(ii) There is a feasible solution µ in Rm
++ for problem (5.3.2).
(iii) The set {a1, a2, . . . , am} is linearly independent.
Now consider the ‘penalized’ problem (for real ϵ > 0)
inf
x∈Rn{cTx + ϵlb (b −Ax)}.
(5.3.11)
(a) Write this problem as a Fenchel problem (3.3.6), and show the
dual problem is
⎧
⎪
⎨
⎪
⎩
sup
−bTµ −ϵlb (µ) −k(ϵ)
subject to
m
i=1 µiai
=
−c
µ
∈
Rm
+,
(5.3.12)
for some function k : R+ →R.

§5.3
Duality for linear and semideﬁnite programming
131
(b) Prove that both problems (5.3.11) and (5.3.12) have optimal so-
lutions, with equal optimal values.
(c) By complementary slackness (§3.3, Exercise 9(f)), prove problems
(5.3.11) and (5.3.12) have unique optimal solutions xϵ ∈Rn and
µϵ ∈Rm, characterized as the unique solution of the system
m

i=1
µiai
=
−c,
µi(bi −(ai)Tx)
=
ϵ,
for each i,
b −Ax
≥
0,
and
µ ∈Rm
+
,
x ∈Rn.
(d) Calculate cTxϵ + bTµϵ.
(e) Deduce that, as ϵ decreases to 0, the feasible solution xϵ ap-
proaches optimality in problem (5.3.1) and µϵ approaches opti-
mality in problem (5.3.2).
11. ∗∗(Semideﬁnite central path) Imitate the development of Exercise
10 for the semideﬁnite programs (5.3.8) and (5.3.9).
12. ∗∗(Relativizing cone programming duality) Prove other condi-
tions guaranteeing part (a) of Corollary 5.3.6 are
(i) b ∈A(ri K) −ri H, or
(ii) b ∈A(ri K) −H and H polyhedral.
(Hint: use §4.1, Exercise 20, and §5.1, Exercise 12.)

132
Special cases
5.4
Convex process duality
In this section we introduce the idea of a ‘closed convex process’. These are
set-valued maps whose graphs are closed convex cones. As such, they provide
a powerful unifying formulation for the study of linear maps, convex cones,
and linear programming. The exercises show the elegance of this approach
in a range of applications.
Throughout this section we ﬁx a Euclidean space Y.
For clarity, we
denote the closed unit balls in E and Y by BE and BY respectively.
A
multifunction Φ : E →Y is a map from E to the set of subsets of Y. The
domain of Φ is the set
D(Φ) = {x ∈E | Φ(x) ̸= ∅}.
We say Φ has nonempty images if its domain is E. For any subset C of
E we write Φ(C) for the image ∪x∈CΦ(x), and the range of Φ is the set
R(Φ) = Φ(E). We say Φ is surjective if its range is Y. The graph of Φ is the
set
G(Φ) = {(x, y) ∈E × Y | y ∈Φ(x)},
and we deﬁne the inverse multifunction Φ−1 : Y →E by the relationship
x ∈Φ−1(y) ⇔y ∈Φ(x),
for x in E and y in Y.
A multifunction is convex, or closed, or polyhedral, if its graph is likewise.
A process is a multifunction whose graph is a cone. For example, we can
interpret linear maps as closed convex processes in the obvious way.
Closure is one example of a variety of continuity properties of multifunc-
tions we study in this section. We say the multifunction Φ is LSC at a point
(x0, y) in its graph if, for all neighbourhoods V of y, the image Φ(x) inter-
sects V for all points x close to x0. (In particular, x0 must lie in int (D(Φ)).)
Equivalently, for any sequence of points (xn) approaching x0 there is a se-
quence of points yn ∈Φ(xn) approaching y. If, for x0 in the domain, this
property holds for all points y in Φ(x0), we say Φ is LSC at x0. (The notation
comes from ‘lower semicontinuous’, a name we avoid in this context because
of incompatibility with the single-valued case — see Exercise 5.)
On the other hand, we say Φ is open at a point (x, y0) in its graph if, for all
neighbourhoods U of x, the point y0 lies in int (Φ(U)). (In particular, y0 must
lie in int (R(Φ)).) Equivalently, for any sequence of points (yn) approaching
y0 there is a sequence of points (xn) approaching x such that yn ∈Φ(xn) for

§5.4
Convex process duality
133
all n. If, for y0 in the range, this property holds for all points x in Φ−1(y0),
we say Φ is open at y0. These properties are inverse to each other, in the
following sense.
Proposition 5.4.1 (Openness and lower semicontinuity) Any multi-
function Φ : E →Y is LSC at a point (x, y) in its graph if and only if Φ−1
is open at (y, x).
We leave the proof as an exercise.
For convex multifunctions, openness at a point in the graph has strong
global implications: the following result is another exercise.
Proposition 5.4.2 If a convex multifunction is open at some point in its
graph then it is open throughout the interior of its range.
In particular, a convex process Φ : E →Y is open at (0, 0) ∈E × Y if
and only if it is open at 0 ∈Y: we just say Φ is open at zero (or, dually, Φ−1
is LSC at zero).
There is a natural duality for convex processes which generalizes the ad-
joint operation for linear maps. Speciﬁcally, for a convex process Φ : E →Y,
we deﬁne the adjoint process Φ∗: Y →E by
G(Φ∗) = {(µ, ν) | (ν, −µ) ∈G(Φ)−}.
Then an easy consequence of the Bipolar cone theorem (3.3.14) is
G(Φ∗∗) = −G(Φ),
providing Φ is closed. (We could deﬁne a ‘lower’ adjoint by the relationship
Φ∗(µ) = −Φ∗(−µ), in which case (Φ∗)∗= Φ.)
The language of adjoint processes is elegant and concise for many varia-
tional problems involving cones. A good example is the cone program (5.3.4).
We can write this problem as
inf
x∈E{⟨c, x⟩| b ∈Ψ(x)},
where Ψ is the closed convex process deﬁned by
Ψ(x) =

Ax −H,
if x ∈K,
∅,
otherwise,
(5.4.3)

134
Special cases
for points c in E, b in Y, and closed convex cones H ⊂Y and K ⊂E. An
easy calculation shows the adjoint process is
Ψ∗(µ) =

A∗µ + K−,
if µ ∈H−,
∅,
otherwise,
(5.4.4)
so we can write the dual problem (5.3.5) as
sup
µ∈Y{⟨b, µ⟩| −c ∈Ψ∗(−µ)}.
(5.4.5)
Furthermore the constraint qualiﬁcations in the Cone programming duality
corollary (5.3.6) become simply b ∈int R(Ψ) and −c ∈int R(Ψ∗).
In §1.1 we mentioned the fundamental linear-algebraic fact that the null
space of any linear map A and the range of its adjoint satisfy the relationship
(A−1(0))−= R(A∗).
(5.4.6)
Our next step is to generalize this to processes.
We begin with an easy
lemma.
Lemma 5.4.7 Any convex process Φ : E →Y and subset C of Y satisfy
Φ∗(C◦) ⊂(Φ−1(C))◦.
Equality in this relationship requires more structure.
Theorem 5.4.8 (Adjoint process duality) Let Φ : E →Y be a convex
process, and suppose the set C ⊂Y is convex, with R(Φ) ∩C nonempty.
(a) Either of the assumptions
(i) the multifunction x ∈E →Φ(x) −C is open at zero (or, in
particular, int C contains zero), or
(ii) Φ and C are polyhedral,
imply
(Φ−1(C))◦= Φ∗(C◦).
(b) On the other hand, if C is compact and Φ is closed then
(Φ−1(C))◦= cl (Φ∗(C◦)).

§5.4
Convex process duality
135
Proof.
Suppose assumption (i) holds in part (a). For a ﬁxed element φ
of (Φ−1(C))◦, we can check that the ‘value function’ v : Y →[−∞, +∞]
deﬁned, for elements y of Y, by
v(y) = inf
x∈E{−⟨φ, x⟩| y ∈Φ(x) −C}
(5.4.9)
is convex. The assumption φ ∈(Φ−1(C))◦is equivalent to v(0) ≥−1, while
the openness assumption implies 0 ∈core (dom v).
Thus v is proper, by
Lemma 3.2.6, and so the Max formula (3.1.8) shows v has a subgradient
−λ ∈Y at 0. A simple calculation now shows λ ∈C◦and φ ∈Φ∗(λ), which,
together with Lemma 5.4.7, proves the result.
If Φ and C are polyhedral, the Polyhedral algebra proposition (5.1.8)
shows v is also polyhedral, so again has a subgradient, and our argument
proceeds as before.
Turning to part (b), we can rewrite φ ∈(Φ−1(C))◦as
(φ, 0) ∈(G(Φ) ∩(E × C))◦,
and apply the polarity formula in §4.1, Exercise 8 to deduce
(φ, 0) ∈cl (G(Φ)−+ (0 × C◦)).
Hence there are sequences (φn, −ρn) in G(Φ)−and µn in C◦with φn ap-
proaching φ and µn −ρn approaching 0. We deduce
φn ∈Φ∗(ρn) ⊂Φ∗(C◦+ ϵnBY),
where the real sequence ϵn = ∥µn −ρn∥approaches 0. Since C is bounded we
know int (C◦) contains 0 (by §4.1, Exercise 5), and the result follows using
the the positive homogeneity of Φ∗.
♠
The null space/range formula (5.4.6) thus generalizes to a closed convex
process Φ:
(Φ−1(0))◦= cl (R(Φ∗)),
and the closure is not required if Φ is open at zero.
We are mainly interested in using these polarity formulae to relate two
‘norms’ for a convex process Φ : E →Y. The ‘lower norm’
∥Φ∥l = inf{r ∈R++ | Φ(x) ∩rBY ̸= ∅, ∀x ∈BE}

136
Special cases
quantiﬁes Φ being LSC at zero: it is easy to check that Φ is LSC at zero if
and only if its lower norm is ﬁnite. The ‘upper norm’
∥Φ∥u = inf{r ∈R++ | Φ(BE) ⊂rBY}
quantiﬁes a form of ‘upper semicontinuity’ (see §8.2). Clearly Φ is bounded
(that is, bounded sets have bounded images), if and only if its upper norm is
ﬁnite. Both norms generalize the norm of a linear map A : E →Y, deﬁned
by
∥A∥= sup{∥Ax∥| ∥x∥≤1}.
Theorem 5.4.10 (Norm duality) Any closed convex process Φ satisﬁes
∥Φ∥l = ∥Φ∗∥u.
Proof. For any real r > ∥Φ∥l we know BE ⊂Φ−1(rBY), by deﬁnition. Tak-
ing polars implies BE ⊃r−1Φ∗(BY), by the Adjoint process duality theorem
(5.4.8), whence ∥Φ∗∥u < r.
Conversely, ∥Φ∗∥u < r implies Φ∗(BY) ⊂rBE. Taking polars and apply-
ing the Adjoint process duality theorem again followed by the Bipolar set
theorem (4.1.5) shows BE ⊂r(cl (Φ−1(BY))). But since BY is compact we
can check Φ−1(BY) is closed, and the result follows.
♠
The values of the upper and lower norms of course depend on the spaces
E and Y.
Our proof of the Norm duality theorem above shows that it
remains valid when BE and BY denote unit balls for arbitrary norms (see
§4.1, Exercise 2), providing we replace them by their polars B◦
E and B◦
Y in
the deﬁnition of ∥Φ∗∥u.
The next result is an immediate consequence of the Norm duality theorem.
Corollary 5.4.11 A closed convex process is LSC at zero if and only if its
adjoint is bounded.
We are now ready to prove the main result of this section.
Theorem 5.4.12 (Open mapping) The following properties of a closed
convex process Φ are equivalent:
(a) Φ is open at zero;

§5.4
Convex process duality
137
(b) (Φ∗)−1 is bounded.
(c) Φ is surjective.
Proof.
The equivalence of parts (a) and (b) is just Corollary 5.4.11 (after
taking inverses and observing the identity G((Φ∗)−1) = −G((Φ−1)∗). Part
(a) clearly implies part (c), so it remains to prove the converse. But if Φ is
surjective then we know
Y =
∞

n=1
Φ(nBE) =
∞

n=1
nΦ(BE),
so 0 lies in the core, and hence the interior, of the convex set Φ(BE). Thus
Φ is open at zero.
♠
Taking inverses gives the following equivalent result.
Theorem 5.4.13 (Closed graph) The following properties of a closed con-
vex process Φ are equivalent:
(a) Φ is LSC at zero;
(b) Φ∗is bounded.
(c) Φ has nonempty images.
Exercises and commentary
A classic reference for multifunctions is [12], and [102] is a good compendium,
including applications in mathematical economics. Convex processes were
introduced by Rockafellar [148, 149]. The power of normed convex processes
was highlighted by Robinson [143, 144]. Our development here follows [22,
23]. The importance of the ‘distance to inconsistency’ (see Exercise 21) was
ﬁrst made clear in [142].
1. (Inverse multifunctions) For any multifunction Φ : E →Y, prove
(a) R(Φ−1) = D(Φ).
(b) G(Φ−1) = {(y, x) ∈Y × E | (x, y) ∈G(Φ)}.

138
Special cases
2. (Convex images) Prove the image of a convex set under a convex
multifunction is convex.
3. For any proper closed convex function f : E →(−∞, +∞], prove
∂(f ∗) = (∂f)−1.
4. Prove Proposition 5.4.1 (Openness and lower semicontinuity).
5. (LSC and lower semicontinuity) Let the function f : E →[−∞, ∞]
be ﬁnite at the point z ∈E.
(a) Prove f is continuous at z if and only if the multifunction
t ∈R →f −1(t)
is open at (f(z), z).
(b) Prove f is lower semicontinuous at z if and only if the multifunc-
tion whose graph is epi (−f) is LSC at (z, f(z)).
6. ∗Prove Proposition 5.4.2. (Hint: see §4.1, Exercise 1(b).)
7. (Biconjugation) Prove any closed convex process Φ satisﬁes
G(Φ∗∗) = −G(Φ).
8. Check the adjoint formula (5.4.4).
9. Prove Lemma 5.4.7.
10. Prove the value function (5.4.9) is convex.
11. ∗Write a complete proof of the Adjoint process duality theorem (5.4.8).
12. If the multifunction Φ : E →Y is closed and the set C ⊂Y is compact,
prove Φ−1(C) is closed.
13. Prove any closed convex process Φ satisﬁes G((Φ∗)−1) = −G((Φ−1)∗).
14. (Linear maps) Consider a linear map A : E →Y, and deﬁne a
multifunction Φ : E →Y by Φ(x) = {Ax} for all points x in E.
(a) Prove Φ is a closed convex process.

§5.4
Convex process duality
139
(b) Prove Φ∗is the closed convex process y ∈Y →{A∗y}.
(c) Prove ∥Φ∥l = ∥Φ∥u = ∥A∥.
(d) Prove A is an open map (that is, maps open sets to open sets) if
and only if Φ is open throughout Y.
(e) Hence deduce the Open mapping theorem for linear maps (see
§4.1, Exercise 9) as a special case of Theorem 5.4.12.
(f) For any closed convex process Ω: E →Y, prove
(Ω+ A)∗= Ω∗+ A∗.
15. ∗(Normal cones) A closed convex cone K ⊂E is generating if it
satisﬁes K −K = E. For a point x in E, the order interval [0, x]K is
the set K ∩(x −K). We say K is normal if there is a real c > 0 such
that
y ∈[0, x]K ⇒∥y∥≤c∥x∥.
(a) Prove the multifunction Φ : E →E deﬁned by Φ(x) = [0, x]K is a
closed convex process.
(b) Calculate (Φ∗)−1.
(c) (Krein-Grossberg) Deduce K is normal if and only if K−is
generating.
(d) Use §3.3, Exercise 20 (Pointed cones) to deduce K is normal if
and only if it is pointed.
16. (Inverse boundedness) By considering the convex process (5.4.3),
demonstrate that the following statements are equivalent for any linear
map A : E →Y and closed cones K ⊂E and H ⊂Y:
AK −H
=
Y ;
{y ∈H−| A∗y ∈BE −K−}
is bounded.
17. ∗∗(Localization [23]) Given a closed convex process Φ : E →Y and
a point b in Y, deﬁne the ‘homogenized’ process Ψ : E × R →Y × R
by
Ψ(x, t) =

(Φ(x) −tb) × (t −R+),
if t ≥0,
∅,
if t < 0.

140
Special cases
(a) Prove Ψ is a closed convex process.
(b) Prove Ψ is surjective if and only if b lies in core (R(Φ)).
(c) Prove Ψ is open at zero if and only if Φ is open at b.
(d) Calculate Ψ∗.
(e) Prove the following statements are equivalent:
(i) Φ is open at b;
(ii) b lies in core (R(Φ));
(iii) The set
{µ ∈Y | Φ∗(µ) ∩BE ̸= ∅and ⟨µ, b⟩≤1}
is bounded.
(f) If R(Φ) has nonempty core, use a separation argument to prove
the statements in part (e) are equivalent to
{µ ∈(Φ∗)−1(0) | ⟨µ, b⟩≤0} = {0}.
18. ∗∗(Cone duality) By applying part (e) of Exercise 17 to example
(5.4.3) with A = 0 and K = E, deduce that a point b lies in the core
of the closed convex cone H ⊂Y if and only if the set
{µ ∈H−| −⟨µ, b⟩≤1}
is bounded. Hence give another proof that a closed convex cone has a
bounded base if and only if its polar has nonempty interior (see §3.3,
Exercise 20).
19. ∗∗(Order epigraphs)
(a) Suppose C ⊂E is a convex cone, S ⊂Y is a closed convex cone,
and F : C →Y is an S-sublinear function (see §3.3, Exercise 18
(Order convexity)). Prove the multifunction Φ : E →Y deﬁned
by
Φ(x) =

F(x) + S,
if x ∈C
∅,
otherwise,
is a convex process, with adjoint
Φ∗(µ) =

∂⟨µ, F(·)⟩(0),
if µ ∈−S−
∅,
otherwise.

§5.4
Convex process duality
141
(b) Use §5.2, Exercise 12 to prove the adjoint of the closed convex
process
X ∈Sn →λ(X) −(Rn
≥)−
is the closed convex process with domain Rn
≥deﬁned by
µ →λ−1(conv (Pnµ)).
20. ∗∗(Condition number [112]) Consider a given closed convex process
Φ : E →Y and a linear map G : E →Y.
(a) If ∥G∥−1 > ∥Φ−1∥u, prove the process (Φ + G)−1 is bounded.
(b) If ∥G∥−1 > ∥Φ−1∥l, use part (a) to prove the process Φ + G is
surjective.
(c) Suppose Φ is surjective and the point y lies on the boundary of the
set Φ(BE). By considering a supporting hyperplane, prove there
is a rank-one linear map G : E →Y, deﬁned by
Gx = ⟨µ, x⟩y
for some element µ of E, such that Φ + G is not surjective.
(d) Deduce
min{∥G∥| Φ + G not surjective} = ∥Φ−1∥−1,
where the minimum is attained by a rank-one map when ﬁnite.
21. ∗∗(Distance to inconsistency [112]) Consider a given linear map
A : E →Y and an element b of Y. Suppose the space E × R has the
norm ∥(x, t)∥= ∥x∥+ |t|.
(a) Prove the linear map
(x, t) ∈E × R →Ax −tb
has norm ∥A∥∨∥b∥.
Now consider closed convex cones P ⊂E and Q ⊂Y, and systems
(S)
b −Ax
∈
Q,
x
∈
P,
and
(Sz)
z + tb −Ax
∈
Q,
x
∈
P,
t ∈R+, ∥x∥+ |t| ≤1.

142
Special cases
Let I denote the set of pairs (A, b) such that system (S) is inconsistent,
and let I0 denote the set of (A, b) such that the process
(x, t) ∈E × R →

Ax −tb + Q
(x ∈P, t ∈R+)
∅
(otherwise)
is not surjective.
(b) Prove I = cl I0.
(c) By applying Exercise 20 (Condition number), prove the distance
of (A, b) from I is given by the formula
dI(A, b) = inf{∥z∥| (Sz) inconsistent}.

Chapter 6
Nonsmooth optimization
6.1
Generalized derivatives
From the perspective of optimization, the subdiﬀerential ∂f(·) of a convex
function f has many of the useful properties of the derivative. For example,
it gives the necessary optimality condition 0 ∈∂f(x) when the point x is
a (local) minimizer (Proposition 3.1.5), it reduces to {∇f(x)} when f is
diﬀerentiable at x (Corollary 3.1.10), and it often satisﬁes certain calculus
rules such as ∂(f + g)(x) = ∂f(x) + ∂g(x) (Theorem 3.3.5). For a variety
of reasons, if the function f is not convex the subdiﬀerential ∂f(·) is not a
particularly helpful idea. This makes it very tempting to look for deﬁnitions
of the subdiﬀerential for a nonconvex function. In this section we outline
some examples: the most appropriate choice often depends on context.
For a convex function f : E →(−∞, +∞] with x in dom f, we can
characterize the subdiﬀerential via the directional derivative: φ ∈∂f(x)
if and only if ⟨φ, ·⟩≤f ′(x; ·) (Proposition 3.1.6).
A natural approach is
therefore to generalize the directional derivative. Henceforth in this section
we make the simplifying assumption that the real function f (a real-valued
function deﬁned on some subset of E) is locally Lipschitz around the point
x in E.
Partly motivated by the development of optimality conditions, a simple
ﬁrst try is the Dini directional derivative:
f −(x; h) = lim inf
t↓0
f(x + th) −f(x)
t
.
A disadvantage of this idea is that f −(x; ·) is not usually sublinear (consider
143

144
Nonsmooth optimization
for example f = −| · | on R), so we could not expect an analogue of the
Max formula (3.1.9). With this in mind, we introduce the Clarke directional
derivative,
f ◦(x; h) = lim sup
y→x, t↓0
f(y + th) −f(y)
t
= inf
δ>0
sup
∥y−x∥≤δ, 0<t<δ
f(y + th) −f(y)
t
,
and the Michel-Penot directional derivative,
f ⋄(x; h) = sup
u∈E lim sup
t↓0
f(x + th + tu) −f(x + tu)
t
.
Proposition 6.1.1 If the real function f has Lipschitz constant K around
the point x in E then the Clarke and Michel-Penot directional derivatives
f ◦(x; ·) and f ⋄(x; ·) are sublinear, and satisfy
f −(x; ·) ≤f ⋄(x; ·) ≤f ◦(x; ·) ≤K∥· ∥.
Proof. The positive homogeneity and upper bound are straightforward, so
let us prove subadditivity in the Clarke case. For any sequences xr →x in
E and tr ↓0 in R, and any real ϵ > 0, we have
f(xr + tr(u + v)) −f(xr + tru)
tr
≤
f ◦(x; v) + ϵ,
and
f(xr + tru) −f(xr)
tr
≤
f ◦(x; u) + ϵ,
for all large r. Adding and letting r approach ∞shows
f ◦(x; u + v) ≤f ◦(x; u) + f ◦(x; v) + 2ϵ,
and the result follows. We leave the Michel-Penot case as an exercise. The
inequalities are straightforward.
♠
Using our knowledge of support functions (Corollary 4.2.3), we can now
deﬁne the Clarke subdiﬀerential
∂◦f(x) = {φ ∈E | ⟨φ, h⟩≤f ◦(x; h), for all h ∈E},
and the Dini and Michel-Penot subdiﬀerentials ∂−f(x) and ∂⋄f(x) analo-
gously. Elements of the respective subdiﬀerentials are called subgradients.
We leave the proof of the following result as an exercise.

§6.1
Generalized derivatives
145
Corollary 6.1.2 (Nonsmooth max formulae) If the real function f has
Lipschitz constant K around the point x in E then the Clarke and Michel-
Penot subdiﬀerentials ∂◦f(x) and ∂⋄f(x) are nonempty, compact and convex,
and satisfy
∂−f(x) ⊂∂⋄f(x) ⊂∂◦f(x) ⊂KB.
Furthermore, the Clarke and Michel-Penot directional derivatives are the sup-
port functions of the corresponding subdiﬀerentials:
f ◦(x; h)
=
max{⟨φ, h⟩| φ ∈∂◦f(x)},
and
(6.1.3)
f ⋄(x; h)
=
max{⟨φ, h⟩| φ ∈∂⋄f(x)}
(6.1.4)
for any direction h in E.
Notice the Dini subdiﬀerential is also compact and convex, but may be
empty.
Clearly if the point x is a local minimizer of f then any direction h in E
satisﬁes f −(x; h) ≥0, and hence the necessary optimality conditions
0 ∈∂−f(x) ⊂∂⋄f(x) ⊂∂◦f(x)
hold. If g is another real function which is locally Lipschitz around x then
we would not typically expect ∂◦(f + g)(x) = ∂◦f(x) + ∂◦g(x) (consider
f = −g = | · | on R at x = 0 for example). On the other hand, if we are
interested in an optimality condition like 0 ∈∂◦(f + g)(x), it is the inclusion
∂◦(f + g)(x) ⊂∂◦f(x) + ∂◦g(x) which really matters. (A good example we
see later is Corollary 6.3.9.) We address this in the next result, along with
an analogue of the formula for the convex subdiﬀerential of a max-function
in §3.3, Exercise 17. We write f ∨g for the function x →max{f(x), g(x)}.
Theorem 6.1.5 (Nonsmooth calculus) If the real functions f and g are
locally Lipschitz around the point x in E, then the Clarke subdiﬀerential
satisﬁes
∂◦(f + g)(x) ⊂∂◦f(x) + ∂◦g(x),
and
(6.1.6)
∂◦(f ∨g)(x) ⊂conv (∂◦f(x) ∪∂◦g(x)).
(6.1.7)
Analogous results hold for the Michel-Penot subdiﬀerential.

146
Nonsmooth optimization
Proof. The Clarke directional derivative satisﬁes
(f + g)◦(x; ·) ≤f ◦(x; ·) + g◦(x; ·),
since lim sup is a sublinear function. Using the Max formula (6.1.3) we deduce
δ∗
∂◦(f+g)(x) ≤δ∗
∂◦f(x)+∂◦g(x) ,
and taking conjugates now gives the result using the Fenchel biconjugacy
theorem (4.2.1) and the fact that both sides of inclusion (6.1.6) are compact
and convex.
To see inclusion (6.1.7), ﬁx a direction h in E and choose sequences xr →x
in E and tr ↓0 in R satisfying
(f ∨g)(xr + trh) −(f ∨g)(xr)
tr
→(f ∨g)◦(x; h).
Without loss of generality, suppose (f ∨g)(xr + trh) = f(xr + trh) for all r
in some subsequence R of N, and now note
f ◦(x; h)
≥
lim sup
r→∞, r∈R
f(xr + trh) −f(xr)
tr
≥
lim sup
r→∞, r∈R
(f ∨g)(xr + trh) −(f ∨g)(xr)
tr
=
(f ∨g)◦(x; h).
We deduce (f ∨g)◦(x; ·) ≤f ◦(x; ·) ∨g◦(x; ·), which, using the Max formula
(6.1.3), we can rewrite as
δ∗
∂◦(f∨g)(x) ≤δ∗
∂◦f(x) ∨δ∗
∂◦g(x) = δ∗
conv(∂◦f(x)∪∂◦g(x)) ,
using Exercise 9(b) (Support functions) in §4.2. Now the Fenchel biconjugacy
theorem again completes the proof. The Michel-Penot case is analogous. ♠
We now have the tools to derive a nonsmooth necessary optimality con-
dition.
Theorem 6.1.8 (Nonsmooth necessary condition) Suppose the point ¯x
is a local minimizer for the problem
inf{f(x) | gi(x) ≤0 (i ∈I)},
(6.1.9)

§6.1
Generalized derivatives
147
where the real functions f and gi (for i in ﬁnite index set I) are locally
Lipschitz around ¯x. Let I(¯x) = {i | gi(¯x) = 0} be the active set. Then there
exist real λ0, λi ≥0, for i in I(¯x), not all zero, satisfying
0 ∈λ0∂⋄f(¯x) +

i∈I(¯x)
λi∂⋄gi(¯x).
(6.1.10)
If furthermore some direction d in E satisﬁes
g⋄
i (¯x; d) < 0 for all i in I(¯x)
(6.1.11)
then we can assume λ0 = 1.
Proof. Imitating the approach of §2.3, we note that ¯x is a local minimizer
of the function
x →max{f(x) −f(¯x) , gi(x) (i ∈I(¯x))}.
We deduce
0 ∈∂⋄(max{f −f(¯x) , gi (i ∈I(¯x))})(¯x) ⊂conv
⎛
⎝∂⋄f(¯x) ∪

i∈I(¯x)
∂⋄gi(¯x)
⎞
⎠,
by inclusion (6.1.7).
If condition (6.1.11) holds and λ0 is 0 in condition (6.1.10), we obtain the
contradiction
0 ≤max
⎧
⎨
⎩⟨φ, d⟩
 φ ∈

i∈I(¯x)
λi∂⋄gi(¯x)
⎫
⎬
⎭=

i∈I(¯x)
λig⋄
i (¯x; d) < 0.
Thus λ0 is strictly positive, and hence without loss of generality equals 1. ♠
Condition (6.1.10) is a Fritz John type condition analogous to Theorem
2.3.6. Assumption (6.1.11) is a Mangasarian-Fromovitz type constraint qual-
iﬁcation like Assumption 2.3.7, and the conclusion is a Karush-Kuhn-Tucker
condition analogous to Theorem 2.3.8. We used the Michel-Penot subdiﬀer-
ential in the above argument because it is in general smaller than the Clarke
subdiﬀerential, and hence provides stronger necessary conditions. By con-
trast to our approach here, the developments in §2.3 and §3.2 do not assume
local Lipschitzness around the optimal point ¯x.

148
Nonsmooth optimization
Exercises and commentary
Dini derivatives were ﬁrst used in [58]. The Clarke subdiﬀerential appeared
in [50]. A good reference is [51]. The Michel-Penot subdiﬀerential was intro-
duced in [125, 126]. A good general reference for this material is [4].
1. (Examples of nonsmooth derivatives) For the following functions
f : R →R deﬁned, for each point x in R, by
(a) f(x) = |x|,
(b) f(x) = −|x|, and
(c) f(x) =

x2 sin(1/x),
x ̸= 0,
0,
x = 0,
(d) f(x) =
⎧
⎪
⎨
⎪
⎩
3n,
if 3n ≤x ≤2(3n) for any integer n,
2x −3n+1,
if 2(3n) ≤x ≤3n+1 for any integer n,
0,
if x ≤0,
compute the Dini, Michel-Penot and Clarke directional derivatives and
subdiﬀerentials at x = 0.
2. (Continuity of Dini derivative) For a point x in E, prove the func-
tion f −(x; ·) is Lipschitz if f is locally Lipschitz around x.
3. Complete the proof of Proposition 6.1.1.
4. (Surjective Dini subdiﬀerential) Suppose the continuous function
f : E →R satisﬁes the growth condition
lim
∥x∥→∞
f(x)
∥x∥= +∞.
For any element φ of E, prove there is a point x in E with φ in ∂−f(x).
5. Prove Corollary 6.1.2 (Nonsmooth max formulae), using Corollary 4.2.3
(Support functions).
6. (Failure of Dini calculus) Show that the inclusion
∂−(f + g)(x) ⊂∂−f(x) + ∂−g(x)
can fail for locally Lipschitz functions f and g.

§6.1
Generalized derivatives
149
7. ∗Complete the details of the proof of the Nonsmooth calculus theorem
(6.1.5).
8. ∗Prove the following results:
(a) f ◦(x; −h) = (−f)◦(x; h).
(b) (λf)◦(x; h) = λf ◦(x; h), if 0 ≤λ ∈R.
(c) ∂◦(λf)(x) = λ∂◦f(x) for all λ in R.
Derive similar results for the Michel-Penot version.
9. ∗(Mean value theorem [108])
(a) Suppose the function f : E →R is locally Lipschitz. For any
points x and y in E, prove there is a real t in (0,1) satisfying
f(x) −f(y) ∈⟨x −y, ∂⋄f(tx + (1 −t)y)⟩.
(Hint: consider a local minimizer or maximizer of the function
g : [0, 1] →R deﬁned by g(t) = f(tx + (1 −t)y).)
(b) (Monotonicity and convexity) If the set C in E is open and
convex and the function f : C →R is locally Lipschitz, prove f
is convex if and only if it satisﬁes
⟨x −y, φ −ψ⟩≥0,
for all x, y ∈C, φ ∈∂⋄f(x) and ψ ∈∂⋄f(y).
(c) If ∂⋄f(y) ⊂kB for all points y near x, prove f has local Lipschitz
constant k about x.
Prove similar results for the Clarke case.
10. ∗(Max-functions) Consider a compact set T ⊂Rn and a continuous
function g : E × T →R. For each element t of T deﬁne a function
gt : E →R by gt(x) = g(x, t) and suppose, for all t, that this function
is locally Lipschitz around the point z. Deﬁne G : E →R by
G(x) = max{g(x, t) | t ∈T},
and let Tz be the set {t ∈T | g(z, t) = G(z)}. Prove the inclusion
∂◦G(z) ⊂cl
⎛
⎝conv

t∈Tz
∂◦gt(z)
⎞
⎠.

150
Nonsmooth optimization
11. ∗∗(Order statistics [114]) Calculate the Dini, the Michel-Penot, and
the Clarke directional derivatives and subdiﬀerentials of the function
x ∈Rn →[x]k.

§6.2
Nonsmooth regularity and strict diﬀerentiability
151
6.2
Nonsmooth regularity and strict diﬀeren-
tiability
We have outlined, in §2.3 and §3.2, two very distinct versions of the necessary
optimality conditions in constrained optimization. The ﬁrst, culminating in
the Karush-Kuhn-Tucker conditions (2.3.8), relied on Gˆateaux diﬀerentiabil-
ity, while the second, leading to the Lagrangian necessary conditions (3.2.8),
used convexity. A primary aim of the nonsmooth theory of this chapter is to
unify these types of results: in this section we show how this is possible.
A principal feature of the Michel-Penot subdiﬀerential is that it coincides
with the Gˆateaux derivative when this exists.
Proposition 6.2.1 (Unique Michel-Penot subgradient) A real func-
tion f which is locally Lipschitz around the point x in E has a unique Michel-
Penot subgradient φ at x if and only if φ is the Gˆateaux derivative ∇f(x).
Proof. If f has a unique Michel-Penot subgradient φ at x, then all directions
h in E satisfy
f ⋄(x; h) = sup
u∈E lim sup
t↓0
f(x + th + tu) −f(x + tu)
t
= ⟨φ, h⟩.
The cases h = w with u = 0, and h = −w with u = w show
lim sup
t↓0
f(x + tw) −f(x)
t
≤⟨φ, w⟩≤lim inf
t↓0
f(x + tw) −f(x)
t
,
so we deduce f ′(x, w) = ⟨φ, w⟩as required.
Conversely, if f has Gˆateaux derivative φ at x then any directions h and
u in E satisfy
lim sup
t↓0
f(x + th + tu) −f(x + tu)
t
≤
lim sup
t↓0
f(x + t(h + u)) −f(x)
t
−lim inf
t↓0
f(x + tu) −f(x)
t
=
f ′(x; h + u) −f ′(x; u) = ⟨φ, h + u⟩−⟨φ, u⟩
=
⟨φ, h⟩= f ′(x; h) ≤f ⋄(x; h).
Now taking the supremum over u shows f ⋄(x; h) = ⟨φ, h⟩for all h, as we
claimed.
♠

152
Nonsmooth optimization
Thus for example the Fritz John condition (6.1.10) reduces to Theorem 2.3.6
in the diﬀerentiable case (under the extra assumption of local Lipschitzness).
The above result shows that when f is Gˆateaux diﬀerentiable at the point
x, the Dini and Michel-Penot directional derivatives coincide. If they also
equal the Clarke directional derivative then we say f is regular at x. Thus a
real function f, locally Lipschitz around x, is regular at x exactly when the
ordinary directional derivative f ′(x; ·) exists and equals the Clarke directional
derivative f ◦(x; ·).
One of the reasons we are interested in regularity is that when the two
functions f and g are regular at x, the nonsmooth calculus rules (6.1.6) and
(6.1.7) hold with equality (assuming f(x) = g(x) in the latter). The proof is
a straightforward exercise.
We know that a convex function is locally Lipschitz around any point
in the interior of its domain (Theorem 4.1.3).
In fact such functions are
also regular at such points: consequently our various subdiﬀerentials are all
generalizations of the convex subdiﬀerential.
Theorem 6.2.2 (Regularity of convex functions) Suppose the function
f : E →(−∞, +∞] is convex. If the point x lies in int (dom f) then f is
regular at x, and hence the convex, Dini, Michel-Penot and Clarke subdiﬀer-
entials all coincide:
∂◦f(x) = ∂⋄f(x) = ∂−f(x) = ∂f(x).
Proof. Fix a direction h in E , and choose a real δ > 0. Denoting the local
Lipschitz constant by K, we know
f ◦(x; h)
=
lim
ϵ↓0
sup
∥y−x∥≤ϵδ
sup
0<t<ϵ
f(y + th) −f(y)
t
=
lim
ϵ↓0
sup
∥y−x∥≤ϵδ
f(y + ϵh) −f(y)
ϵ
≤
lim
ϵ↓0
f(x + ϵh) −f(x)
ϵ
+ 2Kδ
=
f ′(x; h) + 2Kδ,
using the convexity of f. We deduce
f ◦(x; h) ≤f ′(x; h) = f −(x; h) ≤f ⋄(x; h) ≤f ◦(x; h),

§6.2
Nonsmooth regularity and strict diﬀerentiability
153
and the result follows.
♠
Thus for example, the Karush-Kuhn-Tucker type condition that we obtained
at the end of §6.1 reduces exactly to the Lagrangian necessary conditions
(3.2.8), written in the form 0 ∈∂f(¯x)+
i∈I(¯x) λi∂gi(¯x), assuming the convex
functions f and gi (for indices i in I(¯x)) are continuous at the optimal solution
¯x.
By analogy with Proposition 6.2.1 (Unique Michel-Penot subgradient),
we might ask when the Clarke subdiﬀerential of a function f at a point x
is a singleton {φ}? Clearly in this case f must be regular, with Gˆateaux
derivative ∇f(x) = φ, although Gˆateaux diﬀerentiability is not enough, as
the example x2 sin(1/x) shows (Exercise 1 in §6.1). To answer the question
we need a stronger notion of diﬀerentiability.
For future reference we introduce three gradually stronger conditions for
an arbitrary real function f. We say an element φ of E is the Fr´echet deriva-
tive of f at x if it satisﬁes
lim
y→x, y̸=x
f(y) −f(x) −⟨φ, y −x⟩
∥y −x∥
= 0,
and we say φ is the strict derivative of f at x if it satisﬁes
lim
y,z→x, y̸=z
f(y) −f(z) −⟨φ, y −z⟩
∥y −z∥
= 0.
In either case, it is easy to see ∇f(x) is φ. For locally Lipschitz functions
on E, a straightforward exercise shows Gˆateaux and Fr´echet diﬀerentiability
coincide, but notice that the function x2 sin(1/x) is not strictly diﬀerentiable
at 0. Finally, if f is Gˆateaux diﬀerentiable close to x with gradient map
∇f(·) continuous, then we say f is continuously diﬀerentiable around x. In
the case E = Rn we see in elementary calculus that this is equivalent to
the partial derivatives of f being continuous around x. We make analogous
deﬁnitions of Gˆateaux, Fr´echet, strict and continuous diﬀerentiability for a
function F : E →Y (where Y is another Euclidean space). The derivative
∇f(x) is in this case a linear map from E to Y.
The following result clariﬁes the idea of a strict derivative, and suggests
its connection with the Clarke directional derivative: we leave the proof as
another exercise.

154
Nonsmooth optimization
Theorem 6.2.3 (Strict diﬀerentiability) A real function f has strict
derivative φ at a point x in E if and only if it is locally Lipschitz around
x with
lim
y→x, t↓0
f(y + th) −f(y)
t
= ⟨φ, h⟩,
for all directions h in E. In particular this holds if f is continuously diﬀer-
entiable around x, with ∇f(x) = φ.
We can now answer our question about the Clarke subdiﬀerential.
Theorem 6.2.4 (Unique Clarke subgradient) A real function f which
is locally Lipschitz around the point x in E has a unique Clarke subgradient
φ at x if and only if φ is the strict derivative of f at x. In this case f is
regular at x.
Proof.
One direction is clear, so let us assume ∂◦f(x) = {φ}. Then we
deduce
lim inf
y→x, t↓0
f(y + th) −f(y)
t
=
−lim sup
y→x, t↓0
f((y + th) −th) −f(y + th)
t
=
−f ◦(x; −h) = ⟨φ, h⟩= f ◦(x; h)
=
lim sup
y→x, t↓0
f(y + th) −f(y)
t
,
and the result now follows, using Theorem 6.2.3 (Strict diﬀerentiability). ♠
The Clarke subdiﬀerential has a remarkable alternative description which
is often more convenient for computation. It is a reasonably straightforward
measure-theoretic consequence of Rademacher’s theorem, which states that
locally Lipschitz functions are almost everywhere diﬀerentiable.
Theorem 6.2.5 (Intrinsic Clarke subdiﬀerential) Suppose that the real
function f is locally Lipschitz around the point x in E and that the set S ⊂E
has measure zero. Then the Clarke subdiﬀerential of f at x is
∂◦f(x) = conv {lim
r ∇f(xr) | xr →x, xr ̸∈S}.

§6.2
Nonsmooth regularity and strict diﬀerentiability
155
Exercises and commentary
Again, references for this material are [51, 125, 126, 4].
A nice proof of
Theorem 6.2.5 (Intrinsic Clarke subdiﬀerential) appears in [13]. For some
related ideas applied to distance functions, see [31]. Rademacher’s theorem
can be found in [64], for example.
For more details on the functions of
eigenvalues appearing in Exercise 15, see [110, 113].
1. Which of the functions in §6.1, Exercise 1 are regular at 0?
2. (Regularity and nonsmooth calculus) If the functions f and g are
regular at the point x, prove that the nonsmooth calculus rules (6.1.6)
and (6.1.7) hold with equality (assuming f(x) = g(x) in the latter),
and that the resulting functions are also regular at x.
3. Show by a direct calculation that the function x ∈R →x2 sin(1/x) is
not strictly diﬀerentiable at the point x = 0.
4. Prove the special case of the Lagrangian necessary conditions we claim
after Theorem 6.2.2.
5. ∗Prove that the notions of Gˆateaux and Fr´echet diﬀerentiability coin-
cide for locally Lipschitz real functions.
6. Without using Theorem 6.2.4, prove that a unique Clarke subgradient
implies regularity.
7. ∗Prove the Strict diﬀerentiability theorem (6.2.3).
8. Write out a complete proof of the unique Clarke subgradient theorem
(6.2.4).
9. (Mixed sum rules) Suppose that the real function f is locally Lips-
chitz around the point x in E and that the function g : E →(−∞, +∞]
is convex, with x in int (dom g). Prove
(a) ∂⋄(f + g)(x) = ∇f(x) + ∂g(x) if f is Gˆateaux diﬀerentiable at x,
and
(b) ∂◦(f + g)(x) = ∇f(x) + ∂g(x) if f is strictly diﬀerentiable at x.

156
Nonsmooth optimization
10. (Types of diﬀerentiability) Consider the function f : R2 →R,
deﬁned for (x, y) ̸= 0 by
f(x, y) =
xayb
xp + yq
,
with f(0) = 0, in the ﬁve cases:
(i) a = 2, b = 3, p = 2 and q = 4,
(ii) a = 1, b = 3, p = 2 and q = 4,
(iii) a = 2, b = 4, p = 4 and q = 8,
(iv) a = 1, b = 2, p = 2 and q = 2, and
(v) a = 1, b = 2, p = 2 and q = 4.
In each case determine if f is continuous, Gˆateaux, Fr´echet, or contin-
uously diﬀerentiable at 0.
11. Construct a function f : R →R which is strictly diﬀerentiable at 0
but not continuously diﬀerentiable around 0.
12. ∗(Closed subdiﬀerentials)
(a) Suppose the function f : E →(−∞, +∞] is convex, and the point
x lies in int (dom f).
Prove the convex subdiﬀerential ∂f(·) is
closed at x: in other words, xr →x and φr →φ in E with φr in
∂f(xr) implies φ ∈∂f(x). (See Exercise 8 in §4.2.)
(b) Suppose the real function f is locally Lipschitz around the point
x in E.
(i) For any direction h in E, prove the Clarke directional deriva-
tive has the property that −f ◦(·; h) is lower semicontinuous
at x.
(ii) Deduce the Clarke subdiﬀerential is closed at x.
(iii) Deduce further the inclusion ⊂in the Intrinsic Clarke subd-
iﬀerential theorem (6.2.5).
(c) Show that the Dini and Michel-Penot subdiﬀerentials are not nec-
essarily closed.

§6.2
Nonsmooth regularity and strict diﬀerentiability
157
13. ∗(Dense Dini subgradients) Suppose the real function f is locally
Lipschitz around the point x in E. By considering the closest point in
epi f to the point (x, f(x) −δ) (for a small real δ > 0), prove there are
Dini subgradients at points arbitrarily close to x.
14. ∗∗(Regularity of order statistics [114]) At which points is the
function
x ∈Rn →[x]k
regular? (See §6.1, Exercise 11.)
15. ∗∗(Subdiﬀerentials of eigenvalues) Deﬁne a function γk : Rn →R
by γk(x) =
k
i=1[x]i for k = 1, 2, . . .n. (See §2.2, Exercise 9 (Schur-
convexity).)
(a) For any point x in Rn
≥satisfying xk > xk+1, prove ∇γk(x) =
k
1 ei
(where ei is the i’th standard unit vector in Rn).
Now deﬁne a function σk : Sn →R by σk =
k
1 λi.
(b) Prove σk = γk ◦λ.
(c) Deduce σk is convex and hence locally Lipschitz.
(d) Deduce λk is locally Lipschitz.
(e) If the matrix X in Sn satisﬁes λk(X) > λk+1(X), prove σk is
Gˆateaux diﬀerentiable at X, and calculate the derivative. (Hint:
use formula (5.2.6).)
(f) If the matrix X in Sn satisﬁes λk−1(X) > λk(X) > λk+1(X), prove
∇λk(X) = uuT
for any unit vector u in Rn satisfying λk(X)u = Xu.
(g) Using the Intrinsic Clarke subdiﬀerential theorem (6.2.5), deduce
the formula
∂◦λk(X) = conv {uuT | Xu = λk(X)u, ∥u∥= 1}.
(h) (Isotonicity of λ) Using the Mean value theorem (§6.1, Exercise
9), deduce, for any matrices X and Y in Sn,
X ⪰Y
⇒
λ(X) ≥λ(Y ).

158
Nonsmooth optimization
6.3
Tangent cones
We simpliﬁed our brief outline of some of the fundamental ideas of nonsmooth
analysis by restricting attention to locally Lipschitz functions. By contrast,
the convex analysis we have developed lets us study the optimization problem
inf{f(x) | x ∈S} via the function f + δS, even though the indicator function
δS is not locally Lipschitz on the boundary of the set S. The following simple
but very important idea circumvents this diﬃculty. We deﬁne the distance
function to the nonempty set S ⊂E by
dS(x) = inf{∥y −x∥| y ∈S}
(6.3.1)
(see §3.3, Exercise 12 (Inﬁmal convolution).) We can easily check that dS has
Lipschitz constant 1 on E, and is convex if and only if S has convex closure.
Proposition 6.3.2 (Exact penalization) For a point x in a set S ⊂E,
suppose the real function f is locally Lipschitz around x.
If x is a local
minimizer of f on S then for real L suﬃciently large, x is a local minimizer
of f + LdS.
Proof.
Suppose the Lipschitz constant is no larger than L. Fix a point z
close to x. Clearly dS(z) is the inﬁmum of ∥z −y∥over points y close to x
in S, and such points satisfy
f(z) + LdS(z) ≥f(y) + L(dS(z) −∥z −y∥) ≥f(x) + L(dS(z) −∥z −y∥).
The result follows by taking the supremum over y.
♠
With the assumptions of the previous proposition, we know that any
direction h in E satisﬁes
0 ≤(f + LdS)◦(x; h) ≤f ◦(x; h) + Ld◦
S(x; h),
and hence the Clarke directional derivative satisﬁes f ◦(x; h) ≥0 whenever h
lies in the set
TS(x) = {h | d◦
S(x; h) = 0}.
(6.3.3)
Since d◦
S(x; ·) is ﬁnite and sublinear, and an easy exercise shows it is non-
negative, it follows that TS(x) is a closed convex cone. We call it the Clarke
tangent cone.

§6.3
Tangent cones
159
Tangent cones are ‘conical’ approximations to sets in an analogous way to
directional derivatives being sublinear approximations to functions. Diﬀerent
directional derivatives give rise to diﬀerent tangent cones. For example, the
Dini directional derivative leads to the cone
KS(x) = {h | d−
S (x; h) = 0},
(6.3.4)
a (nonconvex) closed cone containing TS(x) called the contingent cone. If the
set S is convex then we can use the ordinary directional derivative to deﬁne
the cone
TS(x) = {h | d′
S(x; h) = 0},
(6.3.5)
which again will be a closed convex cone called the (convex) tangent cone. We
can use the same notation as the Clarke cone because ﬁnite convex functions
are regular at every point (Theorem 6.2.2). We also show below that our
notation agrees in the convex case with that of §3.3.
Our deﬁnitions of the Clarke and contingent cones do not reveal that
these cones are topological objects, independent of the choice of norm. The
following are more intrinsic descriptions. We leave the proofs as exercises.
Theorem 6.3.6 (Tangent cones) Suppose the point x lies in a set S in E.
(a) The contingent cone KS(x) consists of those vectors h in E for which
there are sequences tr ↓0 in R and hr →h in E such that x + trhr lies
in S for all r.
(b) The Clarke tangent cone TS(x) consists of those vectors h in E such
that for any sequences tr ↓0 in R and xr →x in S, there is a sequence
hr →h in E such that xr + trhr lies in S for all r.
Intuitively, the contingent cone KS(x) consists of limits of directions to points
near x in S, while the Clarke tangent cone TS(x) ‘stabilizes’ this tangency
idea by allowing perturbations of the base point x.
We call the set S tangentially regular at the point x ∈S if the contin-
gent and Clarke tangent cones coincide (which clearly holds if the distance
function dS is regular at x). The convex case is an example.
Corollary 6.3.7 (Convex tangent cone) If the point x lies in the convex
set C ⊂E, then C is tangentially regular at x, with
TC(x) = KC(x) = cl R+(C −x).

160
Nonsmooth optimization
Proof.
The regularity follows from Theorem 6.2.2 (Regularity of convex
functions). The identity KC(x) = cl R+(C −x) follows easily from the con-
tingent cone characterization in Theorem 6.3.6.
♠
Our very ﬁrst optimality result (Proposition 2.1.1) required the condition
−∇f(x) ∈NC(x) if the point x is a local minimizer of a diﬀerentiable function
f on a convex set C ⊂E. If the function f : E →(−∞, +∞] is convex,
and continuous at x ∈C, then in fact a necessary and suﬃcient condition
for global minimality is
0 ∈∂(f + δC)(x) = ∂f(x) + NC(x),
using the sum formula in Theorem 3.3.5. This suggests transforming the
result of our earlier discussion in this section into an analogous form. We use
the following idea.
Theorem 6.3.8 For a point x in a set S ⊂E, the Clarke normal cone,
deﬁned by NS(x) = TS(x)−, is cl (R+∂◦dS(x)).
Proof.
By the Bipolar cone theorem (3.3.14), all we need to show is
(∂◦dS(x))−= TS(x), and this follows from the Max formula (6.1.3).
♠
Notice that our notation for the normal cone is again consistent with the
convex case we discussed in §3.3.
Corollary 6.3.9 (Nonsmooth necessary conditions) For a point x in
a set S ⊂E, suppose the real function f is locally Lipschitz around x. Any
local minimizer x of f on S must satisfy the condition
0 ∈∂⋄f(x) + NS(x).
Proof. For large real L, the point x is a local minimizer of f + LdS by the
Exact penalization proposition (6.3.2), so it satisﬁes
0 ∈∂⋄(f + LdS)(x) ⊂∂⋄f(x) + L∂⋄dS(x) ⊂∂⋄f(x) + NS(x),
using the nonsmooth sum rule (6.1.6).
♠
In particular in the above result, if f is Gˆateaux diﬀerentiable at x then
−∇f(x) ∈NS(x), and when S is convex we recover the ﬁrst order neces-
sary condition (2.1.1). However, we can obtain a more useful, and indeed
fundamental, geometric necessary condition by using the contingent cone.

§6.3
Tangent cones
161
Proposition 6.3.10 (Contingent necessary condition) Suppose a point
x is a local minimizer of the real function f on the set S ⊂E. If f is Fr´echet
diﬀerentiable at x, then the condition
−∇f(x) ∈KS(x)−
must hold.
Proof. If the condition fails then there is a direction h in KS(x) which sat-
isﬁes ⟨∇f(x), h⟩< 0. By Theorem 6.3.6 (Tangent cones) there are sequences
tr ↓0 in R and hr →h in E satisfying x+trhr in S for all r. But then, since
we know
lim
r→∞
f(x + trhr) −f(x) −⟨∇f(x), trhr⟩
tr∥hr∥
= 0,
we deduce f(x+trhr) < f(x) for all large r, contradicting the local minimality
of x.
♠
Precisely because of this result, our aim in the next chapter will be to
identify concrete circumstances where we can calculate the contingent cone
KS(x).
Exercises and commentary
Our philosophy in this section is guided by [51]. The contingent cone was
introduced by Bouligand [41]. Scalarization (see Exercise 12) is a central
tool in multi objective optimization [93]. For the background to Exercise 13
(Boundary properties), see [36, 37, 38].
1. (Exact penalization) For a set U ⊂E, suppose that the function
f : U →R has Lipschitz constant L′, and that the set S ⊂U is closed.
For any real L > L′, if the point x minimizes f +LdS on U prove x ∈S.
2. (Distance function) For any nonempty set S ⊂E, prove the distance
function dS has Lipschitz constant 1 on E, and it is convex if and only
if cl S is convex.
3. (Examples of tangent cones) For the following sets S ⊂R2, calcu-
late TS(0) and KS(0):

162
Nonsmooth optimization
(a) {(x, y) | y ≥x3};
(b) {(x, y) | x ≥0 or y ≥0};
(c) {(x, y) | x = 0 or y = 0};
(d) {r(cos θ, sin θ) | 0 ≤r ≤1, π/4 ≤θ ≤7π/4}.
4. ∗(Topology of contingent cone) Prove that the contingent cone is
closed, and derive the topological description given in Theorem 6.3.6.
5. ∗(Topology of Clarke cone) Suppose the point x lies in the set
S ⊂E.
(a) Prove d◦
S(x; ·) ≥0.
(b) Prove
d◦
S(x; h) =
lim sup
y→x in S, t↓0
dS(y + th)
t
.
(c) Deduce the topological description of TS(x) given in Theorem
6.3.6.
6. ∗(Intrinsic tangent cones) Prove directly from the intrinsic descrip-
tion of the Clarke and contingent cones (Theorem 6.3.6) that the Clarke
cone is convex and the contingent cone is closed.
7. Write a complete proof of the Convex tangent cone corollary (6.3.7).
8. (Isotonicity) Suppose x ∈U ⊂V ⊂E. Prove KU(x) ⊂KV (x), but
give an example where TU(x) ̸⊂TV (x).
9. (Products) Let Y be a Euclidean space. Suppose x ∈U ⊂E and
y ∈V ⊂Y. Prove TU×V (x, y) = TU(x) × TV (y), but give an example
where KU×V (x, y) ̸= KU(x) × KV (y).
10. (Tangents to graphs) Suppose the function F : E →Y is Fr´echet
diﬀerentiable at the point x in E. Prove
KG(F )(x, F(x)) = G(∇F).
11. ∗(Graphs of Lipschitz functions) Given a Euclidean space Y, sup-
pose the function F : E →Y is locally Lipschitz around the point x in
E.

§6.3
Tangent cones
163
(a) For elements µ of E and ν of Y, prove
(µ, −ν) ∈(KG(F )(x, F(x)))◦
⇔
µ ∈∂−⟨ν, F(·)⟩(x).
(b) In the case Y = R, deduce
µ ∈∂−F(x)
⇔
(µ, −1) ∈(KG(F )(x, F(x)))◦
12. ∗∗(Proper Pareto minimization) We return to the notation of §4.1,
Exercise 12 (Pareto minimization), but dropping the assumption that
the cone S has nonempty interior. Recall that S is pointed, and hence
has a compact base, by §3.3, Exercise 20. We say the point y in D is a
proper Pareto minimum (with respect to S) if it satisﬁes
−KD(y) ∩S = {0},
and the point ¯x in C is a proper Pareto minimum of the vector opti-
mization problem
inf{F(x) | x ∈C}
(6.3.11)
if F(¯x) is a proper Pareto minimum of F(C).
(a) If D is a polyhedron, use §5.1, Exercise 6 to prove any Pareto
minimum is proper. Show this can fail for a general convex set D.
(b) For any point y in D, prove
KD+S(y) = cl (KD(y) + S).
(c) (Scalarization) Suppose ¯x is as above. By separating the cone
−KF (C)+S(F(¯x)) from a compact base for S, prove there is an
element φ of −int S−such that ¯x solves the convex problem
inf{⟨φ, F(x)⟩| x ∈C}.
Conversely, show any solution of this problem is a proper Pareto
minimum of the original problem (6.3.11).
13. ∗∗(Boundary properties) For points x and y in E, deﬁne the line
segments
[x, y] = x + [0, 1](y −x),
(x, y) = x + (0, 1)(y −x).
Suppose the set S ⊂E is nonempty and closed. Deﬁne a subset
star S = {x ∈S | [x, y] ⊂S for all y in S}.

164
Nonsmooth optimization
(a) Prove S is convex if and only if star S = S.
(b) For all points x in S, prove star S ⊂(TS(x) + x).
The pseudo-tangent cone to S at a point x in S is
PS(x) = cl (conv KS(x)).
We say x is a proper point of S if PS(x) ̸= E.
(c) If S is convex, prove the boundary points of S coincide with the
proper points.
(d) Prove the proper points of S are dense in the boundary of S.
We say S is pseudo-convex at x if PS(x) ⊃S −x.
(e) Prove any convex set is pseudo-convex at every element.
(f) (Nonconvex separation) Given points x in S and y in E satis-
fying [x, y] ̸⊂S, and any real ϵ > 0, prove there exists a point z
in S such that
y ̸∈PS(z) + z and ∥z −x∥≤∥y −x∥+ ϵ.
(Complete the following steps. Fix a real δ in (0, ϵ) and a point
w in (x, y) such that the ball w + δB is disjoint from S. For each
real t deﬁne a point xt = w + t(x −w) and a real
τ = sup{t ∈[0, 1] | S ∩(xt + δB) = ∅}.
Now pick any point z in S ∩(xτ +δB), and deduce the result from
the properties
PS(x)
⊂
{u ∈E | ⟨u, z −xτ⟩≥0},
and
0
≥
⟨y −xτ, z −xτ⟩.)
(g) Explain why the nonconvex separation principle in part (f) gen-
eralizes the Basic separation theorem (2.1.6).
(h) Deduce ∩x∈S(PS(x) + x) ⊂star S.

§6.3
Tangent cones
165
(i) Deduce

x∈S
(PS(x) + x) = star S =

x∈S
(TS(x) + x)
(and hence starS is closed).
Verify this formula for the set in
Exercise 3(d).
(j) Prove a set is convex if and only if it is pseudo-convex at every
element.
(k) If star S is nonempty, prove its recession cone (see §1.1, Exercise
6) is given by

x∈S
PS(x) = 0+(star S) =

x∈S
TS(x).
14. (Pseudo-convexity and suﬃciency) Given a set S ⊂E and a real
function f which is Gˆateaux diﬀerentiable at a point x in S, we say f
is pseudo-convex at x on S if
⟨∇f(x), y −x⟩≥0, y ∈S
⇒
f(y) ≥f(x).
(a) Suppose S is convex, the function g : S →R+ is convex, the
function h : S →R++ is concave, and both g and h are Fr´echet
diﬀerentiable at the point x in S. Prove the function g/h is pseudo-
convex at x.
(b) If the contingent necessary condition −∇f(x) ∈KS(x)−holds and
f and S are pseudo-convex at x, prove x is a global minimizer of
f on S (see Exercise 13).
(c) If the point x is a local minimizer of the convex function f on the
set S, prove x minimizes f on x + PS(x) (see Exercise 13).
15. (No ideal tangent cone exists) Consider a convex set QS(x), deﬁned
for sets S ⊂R2 and points x in S, and satisfying the properties
(i) (isotonicity) x ∈R ⊂S ⇒QR(x) ⊂QS(x).
(ii) (convex tangents) x ∈closed convex S ⇒QS(x) = TS(x).
Deduce Q{(u,v) | u or v=0}(0) = R2.

166
Nonsmooth optimization
16. ∗∗(Distance function [30]) We can deﬁne the distance function
(6.3.1) with respect to any norm ∥· ∥. Providing the norm is contin-
uously diﬀerentiable away from 0, prove that for any nonempty closed
set S and any point x outside S, we have
(−dS)◦(x; ·) = (−dS)⋄(x; ·).

§6.4
The limiting subdiﬀerential
167
6.4
The limiting subdiﬀerential
In this chapter we have seen a variety of subdiﬀerentials. As we have ob-
served, the smaller the subdiﬀerential, the stronger the necessary optimality
conditions we obtain by using it. On the other hand, the smallest of our
subdiﬀerentials, the Dini subdiﬀerential, is in some sense too small. It may
be empty, it is not a closed multifunction, and it may not always satisfy a
sum rule:
∂−(f + g)(x) ̸⊂∂−f(x) + ∂−g(x) in general.
In this section we show how to enlarge it somewhat to construct what is, in
many senses, the smallest adequate closed subdiﬀerential.
Consider for the moment a real function f which is locally Lipschitz
around the point x in E. Using a construction analogous to the Intrinsic
Clarke subdiﬀerential theorem (6.2.5), we can construct a nonempty subd-
iﬀerential incorporating the local information from the Dini subdiﬀerential.
Speciﬁcally, we deﬁne the limiting subdiﬀerential by closing the graph of the
Dini subdiﬀerential:
∂af(x) = {lim
r φr | xr →x, φr ∈∂−f(xr)}.
(Recall ∂−f(z) is nonempty at points z arbitrarily close to x by §6.2, Exercise
13.) We sketch some of the properties of the limiting subdiﬀerential in the
exercises. In particular, it is nonempty and compact, it coincides with ∂f(x)
when f is convex and continuous at the point x, and any local minimizer x of
f must satisfy 0 ∈∂af(x). Often the limiting subdiﬀerential is not convex;
in fact its convex hull is exactly the Clarke subdiﬀerential. A harder fact is
that if the real function g is also locally Lipschitz around x then a sum rule
holds:
∂a(f + g)(x) ⊂∂af(x) + ∂ag(x).
We prove a more general version of this rule below.
We begin by extending our deﬁnitions beyond locally Lipschitz functions.
As in the convex case, the additional possibilities of studying extended-real-
valued functions are very powerful. For a function f : E →[−∞, +∞] which
is ﬁnite at the point x ∈E, we deﬁne the Dini directional derivative of f at
x in the direction v ∈E by
f −(x; v) = lim inf
t↓0, u→v
f(x + tu) −f(x)
t
,

168
Nonsmooth optimization
and the Dini subdiﬀerential of f at x is the set
∂−f(x) = {φ ∈E | ⟨φ, v⟩≤f −(x; v) for all v in E}.
If f(x) is inﬁnite we deﬁne ∂−f(x) = ∅. These deﬁnitions agree with our
previous notions, by §6.1, Exercise 2 (Continuity of Dini derivative).
For real δ > 0, we deﬁne a subset of E by
U(f, x, δ) = {z ∈E | ∥z −x∥< δ, |f(z) −f(x)| < δ}.
The limiting subdiﬀerential of f at x is the set
∂af(x) =

δ>0
cl (∂−f(U(f, x, δ))).
Thus an element φ of E belongs to ∂af(x) if and only if there is a sequence of
points (xr) in E approaching x with f(xr) approaching f(x), and a sequence
of Dini subgradients φr ∈∂−f(xr) approaching φ.
The case of an indicator function is particularly important. Recall that
if the set C ⊂E is convex and the point x lies in C then ∂δC(x) = NC(x).
By analogy, we deﬁne the limiting normal cone to a set S ⊂E at a point x
in E by
Na
S(x) = ∂aδS(x).
We ﬁrst prove an ‘inexact’ or ‘fuzzy’ sum rule: point and subgradients are
all allowed to move a little. Since such rules are central to modern nonsmooth
analysis, we give the proof in detail.
Theorem 6.4.1 (Fuzzy sum rule) If the functions
f1, f2, . . ., fn : E →[−∞, +∞]
are lower semicontinuous near the point z ∈E then the inclusion
∂−

i
fi

(z) ⊂δB +

i
∂−fi(U(fi, z, δ)).
holds for any real δ > 0.

§6.4
The limiting subdiﬀerential
169
Proof. Assume without loss of generality z = 0 and fi(0) = 0 for each i. We
assume 0 belongs to the left-hand-side of our desired inclusion, and deduce
it belongs to the right-hand-side, or in other words
δB ∩

i
∂−fi(U(fi, 0, δ)) ̸= ∅.
(6.4.2)
(The general case follows by adding a linear function to f1.)
Since 0 ∈∂−(
i fi)(0), Exercise 3 shows 0 is a strict local minimizer of
the function g = δ∥· ∥+

i fi. Choose a real ϵ from the interval (0, δ) such
that
0 ̸= x ∈ϵB
⇒
g(x) > 0 and fi(x) ≥−1/n for each i
(using the lower semicontinuity of the fi’s). Deﬁne a sequence of functions
pr : En+1 →[−∞, +∞] by
pr(x0, x1, . . . , xn) = δ∥x0∥+

i

fi(xi) + r
2∥xi −x0∥2

for r = 1, 2, . . ., and for each r choose a minimizer (xr
0, xr
1, . . . , xr
n) of pr on
(ϵB)n+1. Since pr(0, 0, . . ., 0) = 0, we deduce
pr(xr
0, xr
1, . . . , xr
n) ≤0
(6.4.3)
for each r.
Our choice of ϵ implies 
i fi(xr
i) ≥−1, so
δ∥xr
0∥+ r
2

i
∥xr
i −xr
0∥2 ≤pr(xr
0, xr
1, . . . , xr
n) + 1 ≤1
for each r. Hence for each index i the sequence (xr
i) is bounded, so there
is a subsequence S of N such that limr∈S xr
i exists for each i. The above
inequality also shows this limit must be independent of i: call it ¯x, and note
it lies in ϵB.
From inequality (6.4.3) we see δ∥xr
0∥+ 
i fi(xr
i ) ≤0 for all r, and using
lower semicontinuity shows
g(¯x) = δ∥¯x∥+

i
fi(¯x) ≤0,
so our choice of ϵ implies ¯x = 0. We have thus shown
lim
r∈S xr
i = 0 for each i.

170
Nonsmooth optimization
Inequality (6.4.3) implies 
i fi(xr
i) ≤0 for all r, and since
lim inf
r∈S
fi(xr
i) ≥fi(0) = 0 for each i,
by lower semicontinuity, we deduce
lim
r∈S fi(xr
i ) = 0
for each i.
Fix an index r in S large enough to ensure ∥xr
0∥< ϵ, ∥xr
i∥< ϵ and
|fi(xr
i)| < δ for each i = 1, 2, . . ., n. For this r, the function pr has a lo-
cal minimum at (xr
0, xr
1, . . . , xr
n), so its Dini directional derivative in every
direction (v0, v1, . . . , vn) ∈En+1 is nonnegative. Deﬁne vectors
φi = r(xr
0 −xr
i ) for i = 1, 2, . . ., n.
Then for any nonzero i, setting vj = 0 for all j ̸= i shows
f −
i (xr
i; vi) −⟨φi, vi⟩≥0 for all vi in E,
whence
φi ∈∂−fi(xr
i ) for i = 1, 2, . . ., n.
On the other hand, setting vi = 0 for all nonzero i shows
δ∥v0∥+ ⟨
i φi, v0⟩≥0 for all v0 in E,
whence 
i φi ∈δB, and the desired relationship (6.4.2) now follows.
♠
It is not diﬃcult to construct examples where the above result fails if
δ = 0 (see Exercise 4). In fact there are also examples where
∂a(f1 + f2)(z) ̸⊂∂af1(z) + ∂af2(z).
In general the following result is the best we can expect.
Theorem 6.4.4 (Limiting subdiﬀerential sum rule) If one of the func-
tions f, g : E →[−∞, +∞] is locally Lipschitz and the other is lower semi-
continuous near the point z in E then
∂a(f + g)(z) ⊂∂af(z) + ∂ag(z).

§6.4
The limiting subdiﬀerential
171
Proof. For any element φ of ∂a(f + g)(z) there is a sequence of points (zr)
approaching z in E with (f + g)(zr) approaching (f + g)(z), and a sequence
of Dini subgradients φr ∈∂−(f + g)(zr) approaching φ. By the Fuzzy sum
rule above, there exist points wr and yr in E satisfying
∥wr −zr∥, ∥yr −zr∥, |f(wr) −f(zr)|, |g(yr) −g(zr)| < 1
r,
and elements µr of ∂−f(wr) and ρr of ∂−g(yr) satisfying
∥µr + ρr −φr∥≤1
r
for each r = 1, 2, . . ..
Now since f is locally Lipschitz, the sequence (µr) is bounded so has
a subsequence converging to some element µ of ∂fa(z). The corresponding
subsequence of (ρr) converges to an element ρ of ∂ag(z), and since these
elements satisfy µ + ρ = φ, the result follows.
♠
Exercises and commentary
Properties of the limiting subdiﬀerential were ﬁrst studied by Mordukhovich
in [130], followed by joint work with Kruger in [105], and by work of Ioﬀe
[91, 92]. For a very complete development, see [150]. A comprehensive survey
of the inﬁnite-dimensional literature (including some background to Exercise
11 (Viscosity subderivatives)) may be found in [39]. Somewhat surprisingly,
on the real line the limiting and Clarke subdiﬀerentials may only diﬀer at
countably many points, and at these points the limiting subdiﬀerential is the
union of two (possibly degenerate) intervals [29].
1. For the functions in §6.1, Exercise 1, compute the limiting subdiﬀeren-
tial ∂af(0) in each case.
2. Prove the convex, Dini, and limiting subdiﬀerential all coincide for
convex functions.
3. (Local minimizers) Consider a function f : E →[−∞, +∞] which is
ﬁnite at the point x ∈E.
(a) If x is a local minimizer, prove 0 ∈∂−f(x).

172
Nonsmooth optimization
(b) If 0 ∈∂−f(x), prove for any real δ > 0 that x is a strict local
minimizer of the function f(·) + δ∥· −x∥.
4. (Failure of sum rule) Construct two lower semicontinuous functions
f, g : R →[−∞, +∞] satisfying the conditions ∂af(0) = ∂ag(0) = ∅
and ∂a(f + g)(0) ̸= ∅.
5. If the real function f is continuous at x prove the multifunction ∂af is
closed at x (see §6.2, Exercise 12 (Closed subdiﬀerentials)).
6. Prove a limiting subdiﬀerential sum rule for a ﬁnite number of lower
semicontinuous functions, with all but one being locally Lipschitz.
7. ∗(Limiting and Clarke subdiﬀerential) Suppose the real function
f is locally Lipschitz around the point x in E.
(a) Use the fact that the Clarke subdiﬀerential is a closed multifunc-
tion to show ∂af(x) ⊂∂◦f(x).
(b) Deduce from the Intrinsic Clarke subdiﬀerential theorem (6.2.5)
the property ∂◦f(x) = conv ∂af(x).
(c) Prove ∂af(x) = {φ} if and only if φ is the strict derivative of f at
x.
8. ∗(Topology of limiting subdiﬀerential) Suppose the real function
f is locally Lipschitz around the point x ∈E.
(a) Prove ∂af(x) is compact.
(b) Use the Fuzzy sum rule to prove ∂−f(z) is nonempty at points z
in E arbitrarily close to x (c.f. §6.2, Exercise 13).
(c) Deduce ∂af(x) is nonempty.
9. ∗(Tangents to graphs) Consider a point z in a set S ⊂E, and a
direction v in E.
(a) Prove δ−
S (z; v) = δKS(z)(v).
(b) Deduce ∂−δS(z) = (KS(z))◦.
Now consider a Euclidean space Y, a function F : E →Y which is
locally Lipschitz around the point x in E, and elements µ of E and ν
of Y.

§6.4
The limiting subdiﬀerential
173
(c) Use §6.3, Exercise 11 (Graphs of Lipschitz functions) to prove
(µ, −ν) ∈∂−δG(F )(x, F(x))
⇔
µ ∈∂−⟨ν, F(·)⟩(x).
(d) Deduce
(µ, −ν) ∈Na
G(F )(x, F(x))
⇔
µ ∈∂a⟨ν, F(·)⟩(x).
(e) If Y = R, deduce
(µ, −1) ∈Na
G(F )(x, F(x))
⇔
µ ∈∂aF(x).
(e) If F is strictly diﬀerentiable at x, deduce
Na
G(F )(x, F(x)) = G(−(∇F(x))∗).
10. ∗∗(Composition) Given a Euclidean space Y, functions F : E →Y,
and f : Y →[−∞, +∞], deﬁne a function p : E × Y →[−∞, +∞] by
p(x, y) = f(y) for points x in E and y in Y).
(a) Prove ∂ap(x, y) = {0} × ∂af(y).
(b) Prove ∂−(f ◦F)(x) × {0} ⊂∂−(p + δG(F ))(x, F(x)).
(c) Deduce ∂a(f ◦F)(x) × {0} ⊂∂a(p + δG(F ))(x, F(x)).
Now suppose F is continuous near a point z in E and f is locally
Lipschitz around F(z).
(d) Use the Limiting subdiﬀerential sum rule to deduce
∂a(f ◦F)(z) × {0} ⊂({0} × ∂af(F(z))) + Na
G(F )(z, F(z)).
(e) (Composition rule) If F is strictly diﬀerentiable at z, use Ex-
ercise 9 (Tangents to graphs) to deduce
∂a(f ◦F)(z) ⊂(∇F(z))∗∂af(z).
Derive the corresponding formula for the Clarke subdiﬀerential,
using Exercise 7(b).

174
Nonsmooth optimization
(f) (Mean value theorem) If f is locally Lipschitz on Y then for
any points u and v in Y prove there is a point z in the line segment
(u, v) such that
f(u) −f(v) ∈⟨∂af(z) ∪−∂a(−f)(z), u −v⟩.
(Hint: consider the functions t →±f(v + t(u −v)).)
(g) (Max rule) Consider two real functions g and h which are locally
Lipschitz around z and satisfy g(z) = h(z). Using the functions
x ∈E
→
F(x) = (g(x), h(x)) ∈R2,
and
(u, v) ∈R2
→
f(u, v) = max{u, v} ∈R
in part (d), apply Exercise 9 to prove
∂a(g ∨h)(z) ⊂

γ∈[0,1]
∂a(γg + (1 −γ)h)(z).
Derive the corresponding formula for the Clarke subdiﬀerential,
using Exercise 7(b)
(h) Use the Max rule in part (g) to strengthen the Nonsmooth neces-
sary condition (6.1.8) for inequality-constrained optimization.
11. ∗(Viscosity subderivatives) Consider a real function f which is
locally Lipschitz around 0 and satisﬁes f(0) = 0 and 0 ∈∂−f(0).
Deﬁne a function ρ : R+ →R by
ρ(r) = min{f(x) | ∥x∥= r}.
(a) Prove ρ is locally Lipschitz around 0.
(b) Prove ρ−(0; 1) ≥0.
(c) Prove the function γ = min{0, ρ} is locally Lipschitz and satisﬁes
f(x)
≥
γ(∥x∥) for all x in E, and
lim
t↓0
γ(t)
t
=
0.

§6.4
The limiting subdiﬀerential
175
(d) Consider a real function g which is locally Lipschitz around a
point x ∈E. If φ is any element of ∂−g(x) then prove φ is a
viscosity subderivative of g: there is a real function h which is
locally Lipschitz around x, minorizes g near x, and satisﬁes h(x) =
g(x) and has Fr´echet derivative ∇h(x) = φ. Prove the converse is
also true.
(e)∗∗Prove the function h in part (d) can be assumed continuously
diﬀerentiable near x.
12. ∗∗(Order statistic [114]) Consider the function x ∈Rn →[x]k (for
some index k = 1, 2, . . ., n).
(a) Calculate ∂−[·]k(0).
(b) Hence calculate ∂−[·]k(x) at an arbitrary point x in Rn.
(c) Hence calculate ∂a[·]k(x).

Chapter 7
The Karush-Kuhn-Tucker
theorem
7.1
An introduction to metric regularity
Our main optimization models so far are inequality-constrained.
A little
thought shows our techniques are not useful for equality-constrained prob-
lems like
inf{f(x) | h(x) = 0}.
In this section we study such problems by linearizing the feasible region
h−1(0), using the contingent cone.
Throughout this section we consider an open set U ⊂E, a closed set
S ⊂U, a Euclidean space Y, and a continuous map h : U →Y.
The
restriction of h to S we denote h|S. The following easy result (see Exercise
1) suggests our direction.
Proposition 7.1.1 If h is Fr´echet diﬀerentiable at the point x ∈U then
Kh−1(h(x))(x) ⊂N(∇h(x)).
Our aim in this section is to ﬁnd conditions guaranteeing equality in this
result.
Our key tool is the next result. It states that if a closed function attains
a value close to its inﬁmum at some point, then a nearby point minimizes a
slightly perturbed function.
176

§7.1
An introduction to metric regularity
177
Theorem 7.1.2 (Ekeland variational principle)
Suppose the function
f : E →(−∞, +∞] is closed and the point x ∈E satisﬁes f(x) ≤inf f + ϵ,
for some real ϵ > 0. Then for any real λ > 0 there is a point v ∈E satisfying
the conditions
(a) ∥x −v∥≤λ,
(b) f(v) ≤f(x), and
(c) v is the unique minimizer of the function f(·) + (ϵ/λ)∥· −v∥.
Proof. We can assume f is proper, and by assumption it is bounded below.
Since the function
f(·) + ϵ
λ∥· −x∥
therefore has compact level sets, its set of minimizers M ⊂E is nonempty
and compact. Choose a minimizer v for f on M. Then for points z ̸= v in
M we know
f(v) ≤f(z) < f(z) + ϵ
λ∥z −v∥,
while for z not in M we have
f(v) + ϵ
λ∥v −x∥< f(z) + ϵ
λ∥z −x∥.
Part (c) follows by the triangle inequality. Since v lies in M we have
f(z) + ϵ
λ∥z −x∥≥f(v) + ϵ
λ∥v −x∥for all z in E.
Setting z = x shows the inequalities
f(v) + ϵ ≥inf f + ϵ ≥f(x) ≥f(v) + ϵ
λ∥v −x∥.
Properties (a) and (b) follow.
♠
As we shall see, a precise calculation of the contingent cone Kh−1(h(x))(x)
requires us ﬁrst to bound the distance of a point z to the set h−1(h(x))
in terms of the function value h(z). This leads us to the notion of ‘metric
regularity’. In this section we present a somewhat simpliﬁed version of this
idea, which suﬃces for most of our purposes: we defer a more comprehensive
treatment to a later section. We say h is weakly metrically regular on S at
the point x in S if there is a real constant k such that
dS∩h−1(h(x))(z) ≤k∥h(z) −h(x)∥for all z in S close to x.

178
The Karush-Kuhn-Tucker theorem
Lemma 7.1.3 Suppose 0 ∈S and h(0) = 0. If h is not weakly metrically
regular on S at 0, there is a sequence vr →0 in S such that h(vr) ̸= 0 for all
r, and a strictly positive sequence δr ↓0 such that the function
∥h(·)∥+ δr∥· −vr∥
is minimized on S at vr.
Proof. By deﬁnition there is a sequence xr →0 in S such that
dS∩h−1(0)(xr) > r∥h(xr)∥for all r.
(7.1.4)
For each index r we apply the Ekeland principle with
f = ∥h∥+ δS,
ϵ = ∥h(xr)∥,
λ = min{rϵ, √ϵ},
and x = xr
to deduce the existence of a point vr in S such that
(a) ∥xr −vr∥≤min
 
r∥h(xr)∥,

∥h(xr)∥
!
, and
(c) vr minimizes the function
∥h(·)∥+ max
"
r−1,

∥h(xr)∥
#
∥· −vr∥
on S.
Property (a) shows vr →0, while (c) reveals the minimizing property of vr.
Finally, inequality (7.1.4) and property (a) prove h(vr) ̸= 0.
♠
We can now present a convenient condition for weak metric regularity.
Theorem 7.1.5 (Surjectivity and metric regularity) If h is strictly dif-
ferentiable at the point x in S and
∇h(x)(TS(x)) = Y
then h is weakly metrically regular on S at x.

§7.1
An introduction to metric regularity
179
Proof.
Notice ﬁrst h is locally Lipschitz around x (see Theorem 6.2.3).
Without loss of generality, suppose x = 0 and h(0) = 0. If h is not weakly
metrically regular on S at 0 then by Lemma 7.1.3 there is a sequence vr →0
in S such that h(vr) ̸= 0 for all r, and a real sequence δr ↓0 such that the
function
∥h(·)∥+ δr∥· −vr∥
is minimized on S at vr. Denoting the local Lipschitz constant by L, we
deduce from the sum rule (6.1.6) and the Exact penalization proposition
(6.3.2) the condition
0 ∈∂◦(∥h∥)(vr) + δrB + L∂◦dS(vr).
Hence there are elements ur of ∂◦(∥h∥)(vr) and wr of L∂◦dS(vr) such that
ur + wr approaches 0.
By choosing a subsequence we can assume
∥h(vr)∥−1h(vr) →y ̸= 0
and an exercise then shows ur →(∇h(0))∗y. Since the Clarke subdiﬀerential
is closed at 0 (§6.2, Exercise 12) we deduce
−(∇h(0))∗y ∈L∂◦dS(0) ⊂NS(0).
But by assumption there is a nonzero element p of TS(0) such that ∇h(0)p =
−y, so we arrive at the contradiction
0 ≥⟨p, −(∇h(0))∗y⟩= ⟨∇h(0)p, −y⟩= ∥y∥2 > 0.
♠
We can now prove the main result of this section.
Theorem 7.1.6 (Liusternik) If h is strictly diﬀerentiable at the point x
and ∇h(x) is surjective, then the set h−1(h(x)) is tangentially regular at x
and
Kh−1(h(x))(x) = N(∇h(x)).
Proof.
Assume without loss of generality x = 0 and h(0) = 0. In light of
Proposition 7.1.1, it suﬃces to prove
N(∇h(0)) ⊂Th−1(0)(0).

180
The Karush-Kuhn-Tucker theorem
Fix any element p of N(∇h(0)) and consider a sequence xr →0 in h−1(0)
and tr ↓0 in R++. The previous result shows h is weakly metrically regular
at 0, so there is a constant k such that
dh−1(0)(xr + trp) ≤k∥h(xr + trp)∥
holds for all large r, and hence there are points zr in h−1(0) satisfying
∥xr + trp −zr∥≤k∥h(xr + trp)∥.
If we deﬁne directions pr = t−1
r (zr −xr) then clearly the points xr + trpr lie
in h−1(0) for large r, and since
∥p −pr∥
=
∥xr + trp −zr∥/tr
≤
k∥h(xr + trp) −h(xr)∥/tr
→
k∥(∇h(0))p∥
=
0,
we deduce p ∈Th−1(0)(0).
♠
Exercises and commentary
Liusternik’s original study of tangent spaces appeared in [117]. Closely re-
lated ideas were pursued by Graves [76] — see [59] for a good survey. The
Ekeland principle ﬁrst appeared in [62], motivated by the study of inﬁnite-
dimensional problems, where techniques based on compactness may not be
available. As we see in this section, it is a powerful idea even in ﬁnite di-
mensions: the simpliﬁed version we present here was observed in [84]. The
inversion technique we use (Lemma 7.1.3) is based on the approach in [90].
The recognition of ‘metric’ regularity (a term perhaps best suited to nons-
mooth analysis ) as a central idea began largely with Robinson: see [144, 145]
for example. Many equivalences are discussed in [150, 4].
1. Suppose h is Fr´echet diﬀerentiable at the point x ∈S.
(a) Prove for any set D ⊃h(S) the inclusion
∇h(x)KS(x) ⊂KD(h(x)).

§7.1
An introduction to metric regularity
181
(b) If h is constant on S, deduce
KS(x) ⊂N(∇h(x)).
(c) If h is a real function and x is a local minimizer of h on S, prove
−∇h(x) ∈(KS(x))−.
2. (Lipschitz extension) Suppose the real function f has Lipschitz con-
stant k on the set C ⊂E. By considering the inﬁmal convolution of
the functions f + δC and k∥· ∥, prove there is a function ˜f : E →R
with Lipschitz constant k which agrees with f on C. Prove furthermore
that if f and C are convex then ˜f can be assumed convex.
3. ∗(Closure and the Ekeland principle) Given a subset S of E,
suppose the conclusion of Ekeland’s principle holds for all functions of
the form g + δS where the function g is continuous on S. Deduce S is
closed. (Hint: for any point x in cl S, let g = ∥· −x∥.)
4. ∗∗Suppose h is strictly diﬀerentiable at 0 and satisﬁes
h(0) = 0, vr →0, ∥h(vr)∥−1h(vr) →y, and ur ∈∂◦(∥h∥)(vr).
Prove ur →(∇h(0))∗y. Write out a shorter proof when h is continu-
ously diﬀerentiable at 0.
5. ∗∗Interpret Exercise 27 (Conical open mapping) in §4.2 in terms of
metric regularity.
6. ∗∗(Transversality) Suppose the set V ⊂Y is open and the set R ⊂V
is closed. Suppose furthermore h is strictly diﬀerentiable at the point
x in S, with h(x) in R and
∇h(x)(TS(x)) −TR(h(x)) = Y.
(7.1.7)
(a) Deﬁne the function g : U × V →Y by g(z, y) = h(z) −y. Prove
g is weakly metrically regular on S × R at the point (x, h(x)).
(b) Deduce the existence of a constant k′ such that the inequality
d(S×R)∩g−1(g(x,h(x)))(z, y) ≤k′∥h(z) −y∥
holds for all points (z, y) in S × R close to (x, h(x)).

182
The Karush-Kuhn-Tucker theorem
(c) Apply Proposition 6.3.2 (Exact penalization) to deduce the exis-
tence of a constant k such that the inequality
d(S×R)∩g−1(g(x,h(x)))(z, y) ≤k(∥h(z) −y∥+ dS(z) + dR(y))
holds for all points (z, y) in U × V close to (x, h(x)).
(d) Deduce the inequality
dS∩h−1(R)(z) ≤k(dS(z) + dR(h(z)))
holds for all points z in U close to x.
(e) Imitate the proof of Liusternik’s theorem (7.1.6) to deduce the
inclusions
TS∩h−1(R)(x)
⊃
TS(x) ∩(∇h(x))−1TR(h(x)),
KS∩h−1(R)(x)
⊃
KS(x) ∩(∇h(x))−1TR(h(x)).
(f) Suppose h is the identity map, so
TS(x) −TR(x) = E.
If either R or S is tangentially regular at x, prove
KR∩S(x) = KR(x) ∩KS(x).
(g) (Guignard) By taking polars, and applying the Krein-Rutman
polar cone calculus (3.3.13) and condition (7.1.7) again, deduce
NS∩h−1(R)(x) ⊂NS(x) + (∇h(x))∗NR(h(x)).
(h) If C and D are convex subsets of E satisfying 0 ∈core (C −D)
(or ri C ∩ri D ̸= ∅), and the point x lies in C ∩D, use part (e) to
prove
TC∩D(x) = TC(x) ∩TD(x).
7. ∗∗(Liusternik via inverse functions) We ﬁrst ﬁx E = Rn. The
classical inverse function theorem states that if the map g : U →Rn is
continuously diﬀerentiable then at any point x in U at which ∇g(x) is

§7.1
An introduction to metric regularity
183
invertible, x has an open neighbourhood V whose image g(V ) is open,
and the restricted map g|V has a continuously diﬀerentiable inverse
satisfying the condition
∇(g|V )−1 (g(x)) = (∇g(x))−1 .
Consider now a continuously diﬀerentiable map h : U →Rm, and
a point x in U with ∇h(x) surjective, and ﬁx a direction d in the
null space N(∇h(x)). Choose any (n × (n −m)) matrix D making
the matrix A = (∇h(x), D) invertible, deﬁne a function g : U →Rn
by g(z) = (h(z), Dz), and for a small real δ > 0 deﬁne a function
p : (−δ, δ) →Rn by
p(t) = g−1(g(x) + tAd).
(a) Prove p is well-deﬁned providing δ is small.
(b) Prove the following properties:
(i) p is continuously diﬀerentiable;
(ii) p(0) = x;
(iii) p′(0) = d;
(iv) h(p(t)) = h(x) for all small t.
(c) Deduce that a direction d lies in N(∇h(x)) if and only if there is
a function p : (−δ, δ) →Rn for some δ > 0 in R satisfying the
four conditions in part (b).
(d) Deduce Kh−1(h(x))(x) = N(∇h(x)).

184
The Karush-Kuhn-Tucker theorem
7.2
The Karush-Kuhn-Tucker theorem
The central result of optimization theory describes ﬁrst order necessary op-
timality conditions for the general nonlinear problem
inf{f(x) | x ∈S},
(7.2.1)
where, given an open set U ⊂E, the objective function is f : U →R and
the feasible region S is described by equality and inequality constraints:
S = {x ∈U | gi(x) ≤0 for i = 1, 2, . . ., m, h(x) = 0}.
(7.2.2)
The equality constraint map h : U →Y (where Y is a Euclidean space) and
the inequality constraint functions gi : U →R (for i = 1, 2, . . . , m) are all
continuous. In this section we derive necessary conditions for the point ¯x in
S to be a local minimizer for the problem (7.2.1).
In outline, the approach takes three steps. We ﬁrst extend Liusternik’s
theorem (7.1.6) to describe the contingent cone KS(¯x). Next we calculate
this cone’s polar cone, using the Farkas lemma (2.2.7). Finally we apply the
Contingent necessary condition (6.3.10) to derive the result.
As in our development for the inequality-constrained problem in §2.3, we
need a regularity condition. Once again, we denote the set of indices of the
active inequality constraints by I(¯x) = {i | gi(¯x) = 0}.
Assumption 7.2.3 (The Mangasarian-Fromovitz constraint qualiﬁ-
cation) The active constraint functions gi (for i in I(¯x)) are Fr´echet diﬀer-
entiable at the point ¯x, the equality constraint map h is strictly diﬀerentiable
at ¯x, and the set
{p ∈N(∇h(¯x)) | ⟨∇gi(¯x), p⟩< 0 for i in I(¯x)}
(7.2.4)
is nonempty.
Notice in particular that the set (7.2.4) is nonempty in the case where the
map h : U →Rq has components h1, h2, . . . , hq and the set of gradients
{∇hj(¯x) | j = 1, 2, . . ., q} ∪{∇gi(¯x) | i ∈I(¯x)}
(7.2.5)
is linearly independent (see Exercise 1).

§7.2
The Karush-Kuhn-Tucker theorem
185
Theorem 7.2.6 Suppose the Mangasarian-Fromovitz constraint qualiﬁca-
tion (7.2.3) holds. Then the contingent cone to the feasible region S deﬁned
by equation (7.2.2) is given by
KS(¯x) = {p ∈N(∇h(¯x)) | ⟨∇gi(¯x), p⟩≤0 for i in I(¯x)}.
(7.2.7)
Proof.
Denote the set (7.2.4) by ˜K and the right-hand-side of formula
(7.2.7) by K. The inclusion
KS(¯x) ⊂K
is a straightforward exercise. Furthermore, since ˜K is nonempty, it is easy
to see K = cl ˜K. If we can show ˜K ⊂KS(¯x) then the result will follow since
the contingent cone is always closed.
To see ˜K ⊂KS(¯x), ﬁx an element p of ˜K. Since p lies in N(∇h(¯x)),
Liusternik’s theorem (7.1.6) shows p ∈Kh−1(0)(¯x). Hence there are sequences
tr ↓0 in R++ and pr →p in E satisfying h(¯x + trpr) = 0 for all r. Clearly
¯x+trpr ∈U for all large r, and we claim gi(¯x+trpr) < 0. For indices i not in
I(¯x) this follows by continuity, so we suppose i ∈I(¯x) and gi(¯x + trpr) ≥0
for all r in some subsequence R of N. We then obtain the contradiction
0
=
lim
r→∞in R
gi(¯x + trpr) −gi(¯x) −⟨∇gi(¯x), trpr⟩
tr∥pr∥
≥
−⟨∇gi(¯x), p⟩
∥p∥
>
0.
The result now follows.
♠
Lemma 7.2.8 Any linear maps A : E →Rq and G : E →Y satisfy
{x ∈N(G) | Ax ≤0}−= A∗Rq
+ + G∗Y.
Proof.
This is an immediate application of §5.1, Exercise 9 (Polyhedral
cones).
♠

186
The Karush-Kuhn-Tucker theorem
Theorem 7.2.9 (Karush-Kuhn-Tucker conditions) Suppose the point
¯x is a local minimizer for problem (7.2.1) and the objective function f is
Fr´echet diﬀerentiable at ¯x. If the Mangasarian-Fromovitz constraint qualiﬁ-
cation (7.2.3) holds then there exist multipliers λi in R+ (for i in I(¯x)) and
µ in Y satisfying
∇f(¯x) +

i∈I(¯x)
λi∇gi(¯x) + ∇h(¯x)∗µ = 0.
(7.2.10)
Proof. The Contingent necessary condition (6.3.10) shows
−∇f(¯x)
∈
KS(¯x)−
=
{p ∈N(∇h(¯x)) | ⟨∇gi(¯x), p⟩≤0 for i in I(¯x)}−
=

i∈I(¯x)
R+∇gi(¯x) + ∇h(¯x)∗Y,
using Theorem 7.2.6 and Lemma 7.2.8.
♠
Exercises and commentary
A survey of the history of these results may be found in [140]. The Mangas-
arian-Fromovitz condition originated with [120], while the Karush-Kuhn-
Tucker conditions ﬁrst appeared in [100] and [106].
The use of penalty
functions (see Exercise 11 (Quadratic penalties)) is now standard practice
in computational optimization, and is crucial for interior point methods: ex-
amples include the penalized linear and semideﬁnite programs we considered
in §4.3, Exercise 4 (Examples of duals).
1. (Linear independence implies Mangasarian-Fromovitz) If the
set of gradients (7.2.5) is linearly independent, then by considering the
equations
⟨∇gi(¯x), p⟩
=
−1 for i in I(¯x),
⟨∇hj(¯x), p⟩
=
0 for j = 1, 2, . . ., q,
prove the set (7.2.4) is nonempty.
2. Consider the proof of Theorem 7.2.6.

§7.2
The Karush-Kuhn-Tucker theorem
187
(a) Prove KS(¯x) ⊂K.
(b) If ˜K is nonempty, prove K = cl ˜K.
3. (Linear constraints) If the functions gi (for i in I(¯x)) and h are aﬃne,
prove the contingent cone formula (7.2.7) holds.
4. (Bounded multipliers) In Theorem 7.2.9 (Karush-Kuhn-Tucker con-
ditions), prove the set of multiplier vectors (λ, µ) satisfying equation
(7.2.10) is compact.
5. (Slater condition) Suppose the set U is convex, the functions
g1, g2, . . . , gm : U →R
are convex and Fr´echet diﬀerentiable, and the function h : E →Y
is aﬃne and surjective. Suppose further there is a point ˆx in h−1(0)
satisfying gi(ˆx) < 0 for i = 1, 2, . . ., m. For any feasible point ¯x for
problem (7.2.1), prove the Mangasarian-Fromovitz constraint qualiﬁ-
cation holds.
6. (Largest eigenvalue) For a matrix A in Sn, use the Karush-Kuhn-
Tucker theorem to calculate
sup{xTAx | ∥x∥= 1, x ∈Rn}.
7. ∗(Largest singular value [89, p. 135]) Given any m × n matrix A,
consider the optimization problem
α = sup{xTAy | ∥x∥2 = 1, ∥y∥2 = 1},
(7.2.11)
and the matrix
˜A =

0
A
AT
0

.
(a) If µ is an eigenvalue of ˜A, prove so is −µ.
(b) If µ is a nonzero eigenvalue of ˜A, use a corresponding eigenvector
to construct a feasible solution to problem (7.2.11) with objective
value µ.
(c) Deduce α ≥λ1( ˜A).

188
The Karush-Kuhn-Tucker theorem
(d) Prove problem (7.2.11) has an optimal solution.
(e) Use the Karush-Kuhn-Tucker theorem to prove any optimal solu-
tion of problem (7.2.11) corresponds to an eigenvector of ˜A.
(f) (Jordan [97]) Deduce α = λ1( ˜A). (This number is called the
largest singular value of A.)
8. ∗∗(Hadamard’s inequality [79]) The matrix with columns x1, x2,
. . . ,xn in Rn we denote by (x1, x2, . . . , xn). Prove (¯x1, ¯x2, . . . , ¯xn) solves
the problem
⎧
⎪
⎨
⎪
⎩
inf
−det(x1, x2, . . . , xn)
subject to
∥xi∥2
=
1,
for i = 1, 2, . . ., n,
x1, x2, . . . , xn
∈
Rn,
if and only if the matrix (¯x1, ¯x2, . . . , ¯xn) has determinant 1 and has
columns comprising an orthonormal basis, and deduce the inequality
det(x1, x2, . . ., xn) ≤
n
	
i=1
∥xi∥.
9. (Nonexistence of multipliers [69]) Deﬁne the function sgn : R →R
by
sgn(v) =
⎧
⎪
⎨
⎪
⎩
1
if v > 0,
0
if v = 0,
−1
if v < 0,
and a function h : R2 →R by
h(u, v) = v −sgn(v)(u+)2.
(a) Prove h is Fr´echet diﬀerentiable at (0, 0) with derivative (0, 1).
(b) Prove h is not continuous on any neighbourhood of (0, 0), and
deduce it is not strictly diﬀerentiable at (0, 0).
(c) Prove (0, 0) is optimal for the problem

inf
f(u, v)
=
u
subject to
h(u, v)
=
0,
and yet there is no real λ satisfying
∇f(0, 0) + λ∇h(0, 0) = (0, 0).

§7.2
The Karush-Kuhn-Tucker theorem
189
(Exercise 14 in §8.1 gives an approach to weakening the conditions
required in this section.)
10. ∗(Guignard optimality conditions [78]) Suppose the point ¯x is a
local minimizer for the optimization problem
inf{f(x) | h(x) ∈R, x ∈S},
where R ⊂Y. If the functions f and h are strictly diﬀerentiable at ¯x
and the transversality condition
∇h(¯x)TS(¯x) −TR(h(¯x)) = Y
holds, use §7.1, Exercise 6 (Transversality) to prove the optimality
condition
0 ∈∇f(¯x) + ∇h(¯x)∗NR(h(¯x)) + NS(¯x).
11. ∗∗(Quadratic penalties [123]) Take the nonlinear program (7.2.1)
in the case Y = Rq, and now let us assume all the functions
f, g1, g2, . . . , gm, h1, h2, . . ., hq : U →R
are continuously diﬀerentiable on the set U. For positive integers k we
deﬁne a function pk : U →R by
pk(x) = f(x) + k
⎛
⎝
m

i=1
(g+
i (x))2 +
q

j=1
(hj(x))2
⎞
⎠.
Suppose the point ¯x is a local minimizer for the problem (7.2.1). Then
for some compact neighbourhood W of ¯x in U we know f(x) ≥f(¯x)
for all feasible points x in W. Now deﬁne a function rk : W →R by
rk(x) = pk(x) + ∥x −¯x∥2,
and for each k = 1, 2, . . . choose a point xk minimizing rk on W.
(a) Prove rk(xk) ≤f(¯x) for each k = 1, 2, . . ..
(b) Deduce
lim
k→∞g+
i (xk)
=
0,
for i = 1, 2, . . ., m,
lim
k→∞hj(xk)
=
0,
for j = 1, 2, . . ., q.

190
The Karush-Kuhn-Tucker theorem
(c) Hence show xk →¯x as k →∞.
(d) Calculate ∇rk(x).
(e) Deduce
−2(xk −¯x) = ∇f(xk) +
m

i=1
λk
i ∇gi(xk) +
q

j=1
µk
j∇hj(xk),
for some suitable choice of vectors λk in Rm
+ and µk in Rq.
(f) By taking a convergent subsequence of the vectors
∥(1, λk, µk)∥−1(1, λk, µk) ∈R × Rm
+ × Rq,
show from parts (c) and (e) the existence of a nonzero vector
(λ0, λ, µ) in R × Rm
+ × Rq satisfying the Fritz John conditions:
(i) λigi(¯x) = 0, for i = 1, 2, . . ., m, and
(ii) λ0∇f(¯x) + m
i=1 λi∇gi(¯x) + q
j=1 µj∇hj(¯x) = 0.
(g) Under the assumption of the Mangasarian-Fromovitz constraint
qualiﬁcation (7.2.3), show that the Fritz John conditions in part
(f) imply the Karush-Kuhn-Tucker conditions.

§7.3
Metric regularity and the limiting subdiﬀerential
191
7.3
Metric regularity and the limiting subd-
iﬀerential
In §7.1 we presented a convenient test for the weak metric regularity of a
function at a point in terms of the surjectivity of its strict derivative there
(Theorem 7.1.5). This test, while adequate for most of our purposes, can be
richly reﬁned using the limiting subdiﬀerential.
As before, we consider an open set U ⊂E, a Euclidean space Y, a
closed set S ⊂U, and a function h : U →Y which we assume throughout
this section is locally Lipschitz. We begin with the full deﬁnition of metric
regularity, strengthening the notion of §7.1. We say h is metrically regular
on S at the point x in S if there is a real constant k such that the estimate
dS∩h−1(y)(z) ≤k∥h(z) −y∥
holds for all points z in S close to x and all vectors y in Y close to h(x).
(Before we only required this to be true when y = h(x).)
Lemma 7.3.1 If h is not metrically regular on S at x then there are se-
quences (vr) in S converging to x, (yr) in Y converging to h(x), and (ϵr) in
R++ decreasing to 0 such that, for each index r we have h(vr) ̸= yr and the
function
∥h(·) −yr∥+ ϵr∥· −vr∥
is minimized on S at vr.
Proof. The proof is completely analogous to that of Lemma 7.1.3: we leave
it as an exercise.
♠
We also need the following chain-rule-type result: we leave the proof as
an exercise.
Lemma 7.3.2 At any point x in E where h(x) ̸= 0 we have
∂a∥h(·)∥(x) = ∂a⟨∥h(x)∥−1h(x), h(·)⟩(x).
Using this result and a very similar proof to Theorem 7.1.5, we can now
extend the surjectivity and metric regularity result.

192
The Karush-Kuhn-Tucker theorem
Theorem 7.3.3 (Limiting subdiﬀerential and regularity) For a point
x in S, if no nonzero element w of Y satisﬁes the condition
0 ∈∂a⟨w, h(·)⟩(x) + Na
S(x),
then h is metrically regular on S at x.
Proof.
If h is not metrically regular, we can apply Lemma 7.3.1, so, with
that notation, the function
∥h(·) −yr∥+ ϵr∥· −vr∥
is minimized on S at vr. By Proposition 6.3.2 (Exact penalization) we deduce,
for large enough real L,
0
∈
∂a(∥h(·) −yr∥+ ϵr∥· −vr∥+ LdS(·))(vr)
⊂
∂a∥h(·) −yr∥(vr) + ϵrB + L∂adS(vr),
for all r, using the Limiting subdiﬀerential sum rule (6.4.4).
If we write
wr = ∥h(vr) −yr∥−1(h(vr) −yr), we obtain, by Lemma 7.3.2,
0 ∈∂a⟨wr, h(·)⟩(vr) + ϵrB + L∂adS(vr),
so there are elements ur in ∂a⟨wr, h(·)⟩(vr) and zr in L∂adS(vr) such that
∥ur + zr∥≤ϵr. The sequences (wr), (ur) and (zr) are all bounded so by
taking subsequences we can assume wr approaches some nonzero vector w,
zr approaches some vector z, and ur approaches −z.
Now, using the sum rule again we observe
ur ∈∂a⟨w, h(·)⟩(vr) + ∂a⟨wr −w, h(·)⟩(vr)
for each r. The local Lipschitz constant of the function ⟨wr −w, h(·)⟩tends
to zero, so since ∂a⟨w, h(·)⟩is a closed multifunction at x (by §6.4, Exercise
5) we deduce
−z ∈∂a⟨w, h(·)⟩(x).
Similarly, since ∂adS(·) is closed at x, we see
z ∈L∂adS(x) ⊂Na
S(x),
by Exercise 4, and this contradicts the assumption of the theorem.
♠
This result strengthens and generalizes the elegant test of Theorem 7.1.5,
as the next result shows.

§7.3
Metric regularity and the limiting subdiﬀerential
193
Corollary 7.3.4 (Surjectivity and metric regularity) If h is strictly
diﬀerentiable at the point x in S and
(∇h(x)∗)−1(Na
S(x)) = {0},
or in particular
∇h(x)(TS(x)) = Y,
then h is metrically regular on S at x.
Proof.
Since it is easy to check, for any element w of Y, the function
⟨w, h(·)⟩is strictly diﬀerentiable at x with derivative ∇h(x)∗w, the ﬁrst con-
dition implies the result by Theorem 7.3.3. On the other hand, the second
condition implies the ﬁrst, since for any element w of (∇h(x)∗)−1(Na
S(x))
there is an element z of TS(x) satisfying ∇h(x)z = w, and now we deduce
∥w∥2 = ⟨w, w⟩= ⟨w, ∇h(x)z⟩= ⟨∇h(x)∗w, z⟩≤0,
using Exercise 4, so w = 0.
♠
As a ﬁnal extension to the idea of metric regularity, consider now a closed
set D ⊂Y containing h(x). We say h is metrically regular on S at x with
respect to D if there is a real constant k such that
dS∩h−1(y+D)(z) ≤kdD(h(z) −y)
for all points z in S close to x and vectors y close to h(x). Our previous
deﬁnition was the case D = {0}. This condition estimates how far a point
z ∈S is from feasibility for the system
h(z) ∈y + D,
z ∈S,
in terms of the constraint error dD(h(z) −y).
Corollary 7.3.5 If the point x lies in the closed set S ⊂E with h(x) in
the closed set D ⊂Y and no nonzero element w of Na
D(h(x)) satisﬁes the
condition
0 ∈∂a⟨w, h(·)⟩(x) + Na
S(x),
then h is metrically regular on S at x with respect to D.

194
The Karush-Kuhn-Tucker theorem
Proof.
Deﬁne a function ˜h : U × Y →Y by ˜h(z, y) = h(z) −y, a set
˜S = S × D, and a point ˜x = (x, h(x)). Since, by Exercise 5, we have
Na
˜S(˜x)
=
Na
S(x) × Na
D(h(x)),
and
∂a⟨w, ˜h(·)⟩(˜x)
=
∂a⟨w, h(·)⟩(x) × {−w}
for any element w of Y, there is no nonzero w satisfying the condition
0 ∈∂a⟨w, ˜h(·)⟩(˜x) + Na
˜S(˜x),
so ˜h is metrically regular on ˜S at ˜x, by Theorem 7.3.3 (Limiting subdiﬀer-
ential and regularity). Some straightforward manipulation now shows h is
metrically regular on S at x with respect to D.
♠
The case D = {0} recaptures Theorem 7.3.3.
A nice application of this last result estimates the distance to a level set
under a Slater-type assumption, a typical illustration of the power of metric
regularity.
Corollary 7.3.6 (Distance to level sets) If the function g : U →R is
locally Lipschitz around a point x in U satisfying
g(x) = 0 and 0 ̸∈∂ag(x),
then there is a real constant k > 0 such that the estimate
dg−1(−R+)(z) ≤kg(z)+
holds for all points z in E close to x.
Proof.
Let S ⊂U be any closed neighbourhood of x and apply Corollary
7.3.5 with h = g and D = −R+.
♠
Exercises and commentary
In many circumstances, metric regularity is in fact equivalent to weak metric
regularity: see [24]. The power of the limiting subdiﬀerential as a tool in
recognizing metric regularity was ﬁrst observed by Mordukhovich [131]: there
is a comprehensive discussion in [150, 132].

§7.3
Metric regularity and the limiting subdiﬀerential
195
1. ∗Prove Lemma 7.3.1.
2. ∗Assume h(x) ̸= 0.
(a) Prove
∂−∥h(·)∥(x) = ∂−⟨∥h(x)∥−1h(x), h(·)⟩(x).
(b) Prove the analogous result for the limiting subdiﬀerential. (You
may use the Limiting subdiﬀerential sum rule (6.4.4).)
3. (Metric regularity and openness) If h is metrically regular on S
at x, prove h is open on S at x: that is, for any neighbourhood U of x
we have h(x) ∈int h(U ∩S).
4. ∗∗(Limiting normals and distance functions) For any z in E,
PS(z) denotes the nearest point to z in S.
(a) For α in [0, 1], prove PS(αz + (1 −α)PS(z)) = PS(z).
(b) For z not in S, deduce every element of ∂−dS(z) has norm 1.
(c) For any element w of E, prove
dS(z + w) ≤dS(z) + dS(PS(z) + w).
(d) Deduce ∂−dS(z) ⊂∂−dS(PS(z)).
Now consider a point x in S.
(e) Prove φ is an element of ∂adS(x) if and only if there are sequences
(xr) in S approaching x, and (φr) in E approaching φ satisfying
φr ∈∂−dS(xr) for all r.
(f) Deduce R+∂adS(x) ⊂Na
S(x).
(g) Suppose φ is an element of ∂−δS(x). For any real ϵ > 0, apply §6.4,
Exercise 3 (Local minimizers) and the Limiting subdiﬀerential sum
rule to prove
φ ∈(∥φ∥+ ϵ)∂adS(x) + ϵB.
(h) By taking limits, deduce
Na
S(x) = R+∂adS(x).

196
The Karush-Kuhn-Tucker theorem
(i) Deduce
NS(x) = cl (conv Na
S(x)),
and hence
TS(x) = Na
S(x)−.
(Hint: use §6.4, Exercise 7 (Limiting and Clarke subdiﬀerential).)
(j) Hence prove the following properties are equivalent:
(i) TS(x) = E.
(ii) Na
S(x) = {0}.
(iii) x ∈int S.
5. (Normals to products) For closed sets S ⊂E and D ⊂Y and points
x in S and y in D, prove
Na
S×D(x, y) = Na
S(x) × Na
D(y).
6. ∗Complete the remaining details of the proof of Corollary 7.3.5.
7. Prove Corollary 7.3.6 (Distance to level sets).
8. (Limiting versus Clarke conditions) Deﬁne a set
S = {(u, v) ∈R2 | u ≤0 or v ≤0}
and a function h : R2 →R by h(u, v) = u + v. In Corollary 7.3.4
(Surjectivity and metric regularity), prove the ﬁrst, limiting normal
cone condition holds at the point x = 0, and yet the second, Clarke
tangent cone condition fails.
9. ∗∗(Normals to level sets) Under the hypotheses of Corollary 7.3.6
(Distance to level sets), prove
Na
g−1(R+)(x) = R+∂ag(x).
(Hint: use Exercise 4 and the Max rule (§6.4, Exercise 10(g).)

§7.4
Second order conditions
197
7.4
Second order conditions
Optimality conditions can be reﬁned using second order information: we saw
an early example in Theorem 2.1.5 (Second order conditions). Because of the
importance of curvature information for Newton-type methods in numerical
optimization, second order conditions are widely useful.
In this section we present prototypical second order conditions for con-
strained optimization. Our approach is a simple and elegant blend of convex
analysis and metric regularity.
Consider an open set U ⊂E, a Euclidean space Y. Given any function
h : U →Y which is Fr´echet diﬀerentiable on U, the gradient map ∇h is a
function from U to the vector space L(E, Y) of all linear maps from E to Y,
with the operator norm
∥A∥= max
x∈BE ∥Ax∥
(A ∈L(E, Y)).
If this map ∇h is itself Fr´echet diﬀerentiable at the point ¯x in U then we say
h is twice Fr´echet diﬀerentiable at ¯x: the gradient ∇2h(¯x) is a linear map
from E to L(E, Y), and for any element v of E we write
(∇2h(¯x)v)(v) = ∇2h(¯x)(v, v).
In this case h has the following quadratic approximation at ¯x:
h(¯x + v) = h(¯x) + ∇h(¯x)v + 1
2∇2h(¯x)(v, v) + o(∥v∥2),
for small v.
We suppose throughout this section that the functions f : U →R and h are
twice Fr´echet diﬀerentiable at ¯x, and that the closed convex set S contains
¯x. We consider the nonlinear optimization problem
⎧
⎪
⎨
⎪
⎩
inf
f(x)
subject to
h(x)
=
0,
x
∈
S,
(7.4.1)
and we deﬁne the narrow critical cone at ¯x by
C(¯x) = {d ∈R+(S −¯x) | ∇f(¯x)d ≤0, ∇h(¯x)d = 0}.

198
The Karush-Kuhn-Tucker theorem
Theorem 7.4.2 (Second order necessary conditions) Suppose that the
point ¯x is a local minimum for the problem (7.4.1), that the direction d lies
in the narrow critical cone C(¯x), and that the condition
0 ∈core (∇h(¯x)(S −¯x))
(7.4.3)
holds. Then there exists a multiplier λ in Y such that the Lagrangian
L(·) = f(·) + ⟨λ, h(·)⟩
(7.4.4)
satisﬁes the conditions
∇L(¯x)
∈
−NS(¯x),
and
(7.4.5)
∇2L(¯x)(d, d)
≥
0.
(7.4.6)
Proof. Consider ﬁrst the convex program
⎧
⎪
⎨
⎪
⎩
inf
∇f(¯x)z
subject to
∇h(¯x)z
=
−∇2h(¯x)(d, d),
z
∈
R+(S −¯x).
(7.4.7)
Suppose the point z is feasible for problem (7.4.7). It is easy to check, for
small real t ≥0, the path
x(t) = ¯x + td + t2
2 z
lies in S. Furthermore, the quadratic approximation shows this path almost
satisﬁes the original constraint for small t:
h(x(t))
=
h(¯x) + t∇h(¯x)d + t2
2 (∇h(¯x)z + ∇2h(¯x)(d, d)) + o(t2)
=
o(t2).
But condition (7.4.3) implies in particular that ∇h(¯x)TS(¯x) = Y: in fact
these conditions are equivalent, since the only convex set whose closure is
Y is Y itself (see §4.1, Exercise 20(a) (Properties of the relative interior)).
Hence by Theorem 7.1.5 (Surjectivity and metric regularity), h is (weakly)
metrically regular on S at ¯x. Hence the path above is close to feasible for
the original problem: there is a real constant k such that, for small t ≥0, we
have
dS∩h−1(0)(x(t)) ≤k∥h(x(t))∥= o(t2).

§7.4
Second order conditions
199
Thus we can perturb the path slightly to obtain a set of points
{˜x(t) | t ≥0} ⊂S ∩h−1(0)
satisfying ∥˜x(t) −x(t)∥= o(t2).
Since ¯x is a local minimizer for the original problem (7.4.1), we know
f(¯x) ≤f(˜x(t)) = f(¯x) + t∇f(¯x)d + t2
2 (∇f(¯x)z + ∇2f(¯x)(d, d)) + o(t2),
using the quadratic approximation again.
Hence ∇f(¯x)d ≥0, so in fact
∇f(¯x)d = 0, since d lies in C(¯x). We deduce
∇f(¯x)z + ∇2f(¯x)(d, d) ≥0.
We have therefore shown the optimal value of the convex program (7.4.7) is
at least −∇2f(¯x)(d, d).
For the ﬁnal step in the proof, we rewrite problem (7.4.7) in Fenchel form:
inf
z∈E
 
⟨∇f(¯x), z⟩+ δR+(S−¯x)(z)

+ δ{−∇2h(¯x)(d,d)}(∇h(¯x)z)
!
.
Since condition (7.4.3) holds, we can apply Fenchel duality (3.3.5) to deduce
there exists λ ∈Y satisfying
−∇2f(¯x)(d, d)
≤
−δ∗
R+(S−¯x)(−∇h(¯x)∗λ −∇f(¯x)) −δ∗
{−∇2h(¯x)(d,d)}(λ)
=
−δNS(¯x)(−∇h(¯x)∗λ −∇f(¯x)) + ⟨λ, ∇2h(¯x)(d, d)⟩,
whence the result.
♠
Under some further conditions we can guarantee that for any multiplier λ
satisfying the ﬁrst order condition (7.4.5), the second order condition (7.4.6)
holds for all directions d in the narrow critical cone: see Exercises 2 and 3.
We contrast the necessary condition above with a rather elementary sec-
ond order suﬃcient condition.
For this we use the broad critical cone at
¯x:
¯C(¯x) = {d ∈KS(¯x) | ∇f(¯x)d ≤0, ∇h(¯x)d = 0}.
Theorem 7.4.8 (Second order suﬃcient condition) Suppose for each
nonzero direction d in the broad critical cone ¯C(¯x) there exist multipliers µ
in R+ and λ in Y such that the Lagrangian
¯L(·) = µf(·) + ⟨λ, h(·)⟩

200
The Karush-Kuhn-Tucker theorem
satisﬁes the conditions
∇¯L(¯x)
∈
−NS(¯x),
and
∇2 ¯L(¯x)(d, d)
>
0.
Then for all small real δ > 0, the point ¯x is a strict local minimizer for the
perturbed problem
⎧
⎪
⎨
⎪
⎩
inf
f(x) −δ∥x −¯x∥2
subject to
h(x)
=
0,
x
∈
S.
(7.4.9)
Proof. Suppose there is no such δ, so there is a sequence of feasible solutions
(xr) for problem (7.4.9) converging to ¯x and satisfying
lim sup
r→∞
f(xr) −f(¯x)
∥xr −¯x∥2
≤0.
(7.4.10)
By taking a subsequence, we can assume
lim
r→∞
xr −¯x
∥xr −¯x∥= d,
and it is easy to check the nonzero direction d lies in ¯C(¯x). Hence by as-
sumption there exist the required multipliers µ and λ.
From the ﬁrst order condition we know
∇¯L(¯x)(xr −¯x) ≥0,
so by the quadratic approximation we deduce, as r →∞,
µ(f(xr) −f(¯x))
=
¯L(xr) −¯L(¯x)
≥
1
2∇2 ¯L(¯x)(xr −¯x, xr −¯x) + o(∥xr −¯x∥2).
Dividing by ∥xr −¯x∥2 and taking limits shows
µ lim inf
r→∞
f(xr) −f(¯x)
∥xr −¯x∥2
≥1
2∇2 ¯L(¯x)(d, d) > 0,
which contradicts inequality (7.4.10).
♠

§7.4
Second order conditions
201
Notice this result is of ‘Fritz John’ type (like Theorem 2.3.6): we do not
assume the multiplier µ is nonzero. Furthermore, we can easily weaken the
assumption that the set S is convex to the condition
(S −¯x) ∩ϵB ⊂KS(¯x) for some ϵ > 0.
Clearly the narrow critical cone may be smaller than the broad critical cone,
even when S is convex. They are equal if S is quasi-polyhedral at ¯x: that is,
KS(¯x) = R+(S −¯x)
(as happens in particular when S is polyhedral). However, even for uncon-
strained problems there is an intrinsic gap between the second order necessary
conditions and the suﬃcient conditions.
Exercises and commentary
Our approach here is from [24] (see also [11]). There are higher order ana-
logues [10]. Problems of the form (7.4.11) where all the functions involved
are quadratic are called quadratic programs. Such problems are particularly
well-behaved: the optimal value is attained, when ﬁnite, and in this case the
second order necessary conditions developed in Exercise 3 are also suﬃcient
(see [20]).
For a straightforward exposition of the standard second order
conditions, see [119], for example.
1. (Higher order conditions) By considering the function
sgn(x) exp(−1/x2)
on R, explain why there is no necessary and suﬃcient n-th order opti-
mality condition.
2. ∗(Uniform multipliers) With the assumptions of Theorem 7.4.2
(Second order necessary conditions), suppose in addition that for all
directions d in the narrow critical cone C(¯x) there exists a solution z
in E to the system
∇h(¯x)z
=
−∇2h(¯x)(d, d),
and
z
∈
span (S −¯x).

202
The Karush-Kuhn-Tucker theorem
By considering problem (7.4.7), prove that if the multiplier λ satisﬁes
the ﬁrst order condition (7.4.5) then the second order condition (7.4.6)
holds for all d in C(¯x). Observe this holds in particular if S = E and
∇h(¯x) is surjective.
3. ∗∗(Standard second order necessary conditions) Consider the
problem
⎧
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎩
inf
f(x)
subject to
gi(x)
≤
0,
for i = 1, 2, . . ., m,
hj(x)
=
0,
for j = 1, 2, . . ., q,
x
∈
Rn,
(7.4.11)
where all the functions are twice Fr´echet diﬀerentiable at the local
minimizer ¯x and the set of gradients
A = {∇gi(¯x) | i ∈I(¯x)} ∪{∇hj(¯x) | j = 1, 2, . . ., q}
is linearly independent (where we denote the set of indices of the active
inequality constraints by I(¯x) = {i | gi(¯x) = 0}, as usual). By writing
this problem in the form (7.4.1) and applying Exercise 2, prove there
exist multipliers µi in R+ (for i in I(¯x)) and λ1, λ2, . . . , λq in R such
that the Lagrangian
L(·) = f(·) +

i∈I(¯x)
µigi +
q

j=1
λjhj
satisﬁes the conditions
∇L(¯x)
=
0,
and
∇2L(¯x)(d, d)
≥
0 for all d in A⊥.
4. (Narrow and broad critical cones are needed) By considering the
set
S = {x ∈R2 | x2 ≥x2
1}
and the problem
inf{x2 −αx2
1 | x ∈S}
for various values of the real parameter α, explain why the narrow and
broad critical cones cannot be interchanged in either the Second order
necessary conditions (7.4.2) or the suﬃcient conditions (7.4.8).

§7.4
Second order conditions
203
5. (Standard second order suﬃcient conditions) Write down the
second order suﬃcient optimality conditions for the general nonlinear
program in Exercise 3.
6. ∗(Guignard-type conditions) Consider the problem of §7.2, Exer-
cise 10,
inf{f(x) | h(x) ∈R, x ∈S},
where the set R ⊂Y is closed and convex. By rewriting this problem
in the form (7.4.1), derive second order optimality conditions.

Chapter 8
Fixed points
8.1
Brouwer’s ﬁxed point theorem
Many questions in optimization and analysis reduce to solving a nonlinear
equation h(x) = 0, for some function h : E →E. Equivalently, if we deﬁne
another map f = I −h (where I is the identity map), we seek a point x in
E satisfying f(x) = x: we call x a ﬁxed point of f.
The most potent ﬁxed point existence theorems fall into three categories:
‘geometric’ results, devolving from the Banach contraction principle (which
we state below), order-theoretic results (to which we brieﬂy return in §8.3),
and ‘topological’ results, for which the prototype is the theorem of Brouwer
forming the main body of this section. We begin with Banach’s result.
Given a set C ⊂E and a continuous self map f : C →C, we ask whether
f has a ﬁxed point. We call f a contraction if there is a real constant γf < 1
such that
∥f(x) −f(y)∥≤γf∥x −y∥for all x, y ∈C.
(8.1.1)
Theorem 8.1.2 (Banach contraction) Any contraction on a closed subset
of E has a unique ﬁxed point.
Proof. Suppose the set C ⊂E is closed and the function f : C →C satisﬁes
the contraction condition (8.1.1). We apply the Ekeland variational principle
(7.1.2) to the function
z ∈E →

∥z −f(z)∥,
if z ∈C,
+∞,
otherwise,
204

§8.1
Brouwer’s ﬁxed point theorem
205
at an arbitrary point x in C, with the choice of constants
ϵ = ∥x −f(x)∥and λ =
ϵ
1 −γf
.
This shows there is a point v in C satisfying
∥v −f(v)∥< ∥z −f(z)∥+ (1 −γf)∥z −v∥
for all points z ̸= v in C. Hence v is a ﬁxed point, since otherwise choosing
z = f(v) gives a contradiction. The uniqueness is easy.
♠
What if the map f is not a contraction?
A very useful weakening of
the notion is the idea of a nonexpansive map, which is to say a self map f
satisfying
∥f(x) −f(y)∥≤∥x −y∥for all x, y
(see Exercise 2).
A nonexpansive map on a nonempty compact set or a
nonempty closed convex set may not have a ﬁxed point, as simple examples
like translations on R or rotations of the unit circle show. On the other hand,
a straightforward argument using the Banach contraction theorem shows this
cannot happen if the set is nonempty, compact and convex. However, in this
case we have the following more fundamental result.
Theorem 8.1.3 (Brouwer) Any continuous self map of a nonempty com-
pact convex subset of E has a ﬁxed point.
In this section we present an ‘analyst’s approach’ to Brouwer’s theorem.
We use the two following important analytic tools, concerning C(1) (contin-
uously diﬀerentiable) functions on the closed unit ball B ⊂Rn.
Theorem 8.1.4 (Stone-Weierstrass) For any continuous map f : B →
Rn, there is a sequence of C(1) maps fr : B →Rn converging uniformly to
f.
An easy exercise shows that, in this result, if f is a self map then we can
assume each fr is also a self map.
Theorem 8.1.5 (Change of variable) Suppose that the set W ⊂Rn is
open and that the C(1) map g : W →Rn is one-to-one with ∇g invertible
throughout W. Then the image g(W) is open, with measure

W | det ∇g|.

206
Fixed points
We also use the elementary topological fact that the open unit ball int B is
connected: that is, it cannot be written as the disjoint union of two nonempty
open sets.
The key step in our argument is the following topological result.
Theorem 8.1.6 (Retraction) The unit sphere S is not a C(1) retract of
the unit ball B: that is, there is no C(1) map from B to S whose restriction
to S is the identity.
Proof.
Suppose there is such a retraction map p : B →S.
For real t
in [0, 1], deﬁne a self map of B by pt = tp + (1 −t)I.
As a function of
the variables x ∈B and t, the function det ∇pt(x) is continuous, and hence
strictly positive for small t. Furthermore, pt is one-to-one for small t (see
Exercise 7).
If we denote the open unit ball B \ S by U, then the change of variables
theorem above shows, for small t, that pt(U) is open, with measure
ν(t) =

U det ∇pt.
(8.1.7)
On the other hand, by compactness, pt(B) is a closed subset of B, and we
also know pt(S) = S. A little manipulation now shows we can write U as a
disjoint union of two open sets:
U = (pt(U) ∩U) ∪(pt(B)c ∩U).
(8.1.8)
The ﬁrst set is nonempty, since pt(0) = tp(0) ∈U. But as we observed, U is
connected, so the second set must be empty, which shows pt(B) = B. Thus
the function ν(t) deﬁned by equation (8.1.7) equals the volume of the unit
ball B for all small t.
However, as a function of t ∈[0, 1], ν(t) is a polynomial, so it must be
constant.
Since p is a retraction we know that all points x in U satisfy
∥p(x)∥2 = 1. Diﬀerentiating implies (∇p(x))p(x) = 0, from which we de-
duce det ∇p(x) = 0, since p(x) is nonzero. Thus ν(1) is zero, which is a
contradiction.
♠
Proof of Brouwer’s theorem Consider ﬁrst a C(1) self map f on the unit
ball B. Suppose f has no ﬁxed point. A straightforward exercise shows there
are unique functions α : B →R+ and p : B →S satisfying the relationship

§8.1
Brouwer’s ﬁxed point theorem
207
p(x) = x + α(x)(x −f(x)),
for all x in B.
(8.1.9)
Geometrically, p(x) is the point where the line extending from the point f(x)
through the point x meets the unit sphere S. In fact p must then be a C(1)
retraction, contradicting the retraction theorem above. Thus we have proved
that any C(1) self map of B has a ﬁxed point.
Now suppose the function f is just continuous. By the Stone-Weierstrass
theorem (8.1.4), there is a sequence of C(1) maps fr : B →Rn converging
uniformly to f, and by Exercise 4 we can assume each fr is a self map. Our
argument above shows each fr has a ﬁxed point xr. Since B is compact, the
sequence (xr) has a subsequence converging to some point x in B, which it
is easy to see must be a ﬁxed point of f. So any continuous self map of B
has a ﬁxed point.
Finally, consider a nonempty compact convex set C ⊂E and a continuous
self map g on C. Just as in our proof of Minkowski’s theorem (4.1.8), we may
as well assume C has nonempty interior. Thus there is a homeomorphism (a
continuous onto map with continuous inverse) h : C →B — see Exercise 11.
Since h ◦g ◦h−1 is a continuous self map of B, our argument above shows it
has a ﬁxed point x in B, and therefore h−1(x) is a ﬁxed point of g.
♠
Exercises and commentary
Good general references on ﬁxed point theory are [61, 153, 74]. The Banach
contraction principle appeared in [6]. Brouwer proved the three dimensional
case of his theorem in 1909 [45] and the general case in 1912 [46], with
another proof by Hadamard in 1910 [80]. A nice exposition of the Stone-
Weierstrass theorem may be found in [15], for example.
The Change of
variable theorem (8.1.5) we use can be found in [156]: a beautiful proof of
a simpliﬁed version, also suﬃcient to prove Brouwer’s theorem, appeared in
[107]. Ulam conjectured and Borsuk proved their result in 1933 [16].
1. (Banach iterates) Consider a closed subset C ⊂E and a contraction
f : C →C with ﬁxed point xf. Given any point x0 in C, deﬁne a
sequence of points inductively by
xr+1 = f(xr)
(r = 0, 1, . . .).

208
Fixed points
(a) Prove limr,s→∞∥xr −xs∥= 0. Since E is complete, the sequence
(xr) converges. (Another approach ﬁrst shows (xr) is bounded.)
Hence prove in fact xr approaches xf. Deduce the Banach con-
traction theorem.
(b) Consider another contraction g : C →C with ﬁxed point xg. Use
part (a) to prove the inequality
∥xf −xg∥≤supz∈C ∥f(z) −g(z)∥
1 −γf
.
2. (Nonexpansive maps)
(a) If the n × n matrix U is orthogonal, prove the map x ∈Rn →Ux
is nonexpansive.
(b) If the set S ⊂E is closed and convex then for any real λ in the
interval [0, 2] prove the relaxed projection
x ∈E →(1 −λ)x + λPS(x)
is nonexpansive. (Hint: use the nearest point characterization in
§2.1, Exercise 8(c).)
(c) (Browder-Kirk [47, 101]) Suppose the set C ⊂E is compact
and convex and the map f : C →C is nonexpansive. Prove f
has a ﬁxed point. (Hint: choose an arbitrary point x in C and
consider the contractions
z ∈C →(1 −ϵ)f(z) + ϵx
for small real ϵ > 0.)
(d)∗In part (c), prove the ﬁxed points form a nonempty compact con-
vex set.
3. (Non-uniform contractions)
(a) Consider a nonempty compact set C ⊂E and a self map f on C
satisfying the condition
∥f(x) −f(y)∥< ∥x −y∥for all distinct x, y ∈C.
By considering inf ∥x −f(x)∥, prove f has a unique ﬁxed point.

§8.1
Brouwer’s ﬁxed point theorem
209
(b) Show the result in part (a) can fail if C is unbounded.
(c) Prove the map x ∈[0, 1] →xe−x satisﬁes the condition in part
(a).
4. In the Stone-Weierstrass theorem, prove that if f is a self map then we
can assume each fr is also a self map.
5. Prove the interval (−1, 1) is connected. Deduce the open unit ball in
Rn is connected.
6. In the Change of variable theorem (8.1.5), use metric regularity to prove
the image g(W) is open.
7. In the proof of the Retraction theorem (8.1.6), prove the map p is
Lipschitz, and deduce that the map pt is one-to-one for small t. Also
prove that if t is small then det ∇pt is strictly positive throughout B.
8. In the proof of the Retraction theorem (8.1.6), prove the partition
(8.1.8), and deduce pt(B) = B.
9. In the proof of the Retraction theorem (8.1.6), prove ν(t) is a polyno-
mial in t.
10. In the proof of Brouwer’s theorem, prove the relationship (8.1.9) deﬁnes
a C(1) retraction p : B →S.
11. (Convex sets homeomorphic to the ball) Suppose the compact
convex set C ⊂E satisﬁes 0 ∈int C. Prove that the map h : C →B
deﬁned by
h(x) =

γC(x)∥x∥−1x,
if x ̸= 0,
0,
if x = 0
(where γC is the gauge function we deﬁned in §4.1) is a homeomor-
phism.
12. ∗(A non-closed nonconvex set with the ﬁxed point property)
Let Z be the subset of the unit disk in R2 consisting of all lines through
the origin with rational slope. Prove every continuous self map of Z
has a ﬁxed point.

210
Fixed points
13. ∗(Change of variable and Brouwer) A very simple proof may be
found in [107] of the formula

(f ◦g)∇g =

f
when the function f is continuous with bounded support and the func-
tion g is diﬀerentiable, equalling the identity outside a large ball. Prove
any such g is surjective by considering an f supported outside the range
of g (which is closed). Deduce Brouwer’s theorem.
14. ∗∗(Brouwer and inversion) The central tool of the last chapter, the
Surjectivity and metric regularity theorem (7.1.5), considers a function
h whose strict derivative at a point satisﬁes a certain surjectivity con-
dition. In this exercise, which comes out of a long tradition, we use
Brouwer’s theorem to consider functions h which are merely Fr´echet
diﬀerentiable. This exercise proves the following result.
Theorem 8.1.10 Consider an open set U ⊂E, a closed convex set
S ⊂U, and a Euclidean space Y, and suppose the continuous function
h : U →Y has Fr´echet derivative at the point x ∈S satisfying the
surjectivity condition
∇h(x)TS(x) = Y.
Then there is a neighbourhood V of h(x), a continuous, piecewise linear
function F : Y →E, and a function g : V →Y which is Fr´echet
diﬀerentiable at h(x) and satisﬁes (F ◦g)(V ) ⊂S and
h((F ◦g)(y)) = y for all y ∈V .
Proof. We can assume x = 0 and h(0) = 0.
(a) Use §4.1, Exercise 20 (Properties of the relative interior) to prove
∇h(0)(R+S) = Y.
(b) Deduce there is a basis y1, y2, . . ., yn of Y and points u1, u2, . . ., un
and w1, w2, . . . , wn in S satisfying
∇h(0)ui = yi = −∇h(0)wi
(i = 1, 2, . . ., n).

§8.1
Brouwer’s ﬁxed point theorem
211
(c) Prove the set
B1 =
 n

1
tiyi
 t ∈Rn,
n

1
|ti| ≤1

and the function F deﬁned by
F
 n

1
tiyi

=
n

1

t+
i ui + (−ti)+wi

satisfy F(B1) ⊂S and ∇(h ◦F)(0) = I.
(d) Deduce there exists a real ϵ > 0 such that ϵBY ⊂B1 and
∥h(F(y)) −y∥≤∥y∥/2 whenever ∥y∥≤2ϵ.
(e) For any point v in the neighbourhood V = (ϵ/2)BY, prove the
map
y ∈V →v + y −h(F(y))
is a continuous self map of V .
(f) Apply Brouwer’s theorem to deduce the existence of a ﬁxed point
g(v) for the map in part (e). Prove ∇g(0) = I, and hence complete
the proof of the result.
(g) If x lies in the interior of S, prove F can be assumed linear.
(Exercise 9 (Nonexistence of multipliers) in §7.2 suggests the impor-
tance here of assuming h continuous.)
15. ∗(Knaster-Kuratowski-Mazurkiewicz principle [103]) In this ex-
ercise we show the equivalence of Brouwer’s theorem with the following
result.
Theorem 8.1.11 (KKM) Suppose for every point x in a nonempty
set X ⊂E there is an associated closed subset M(x) ⊂X. Assume the
property
conv F ⊂

x∈F
M(x)
holds for all ﬁnite subsets F ⊂X. Then for any ﬁnite subset F ⊂X
we have

x∈F
M(x) ̸= ∅.

212
Fixed points
Hence if some subset M(x) is compact we have

x∈X
M(x) ̸= ∅.
(a) Prove the ﬁnal assertion follows from the main part of the theorem,
using Theorem 8.2.3 (General deﬁnition of compactness).
(b) (KKM implies Brouwer) Given a continuous self map f on a
nonempty compact convex set C ⊂E, apply the KKM theorem
to the family of sets
M(x) = {y ∈C | ⟨y −f(y), y −x⟩≤0}
(x ∈C)
to deduce f has a ﬁxed point.
(c) (Brouwer implies KKM) With the hypotheses of the KKM the-
orem, assume ∩x∈FM(x) is empty for some ﬁnite set F. Consider
a ﬁxed point z of the self map
y ∈conv F →

x∈F dM(x)(y)x

x∈F dM(x)(y) ,
and deﬁne F ′ = {x ∈F | z ̸∈M(x)}. Show z ∈conv F ′, and
derive a contradiction.
16. ∗∗(Hairy ball theorem [127]) Let Sn denote the Euclidean sphere
{x ∈Rn+1 | ∥x∥= 1}.
A tangent vector ﬁeld on Sn is a function w : Sn →Rn+1 satisfying
⟨x, w(x)⟩= 0 for all points x in Sn. This exercise proves the following
result.
Theorem 8.1.12 For every even n, any continuous tangent vector
ﬁeld on Sn must vanish somewhere.
Proof. Consider a nonvanishing continuous tangent vector ﬁeld u on
Sn.

§8.1
Brouwer’s ﬁxed point theorem
213
(a) Prove there is a nonvanishing C(1) tangent vector ﬁeld on Sn, by
using the Stone-Weierstrass theorem (8.1.4) to approximate u by
a C(1) function p and then considering the vector ﬁeld
x ∈Sn →p(x) −⟨x, p(x)⟩x.
(b) Deduce the existence of a positively homogeneous C(1) function
w : Rn+1 →Rn+1 whose restriction to Sn is a unit norm C(1)
tangent vector ﬁeld: ∥w(x)∥= 1 for all x in Sn.
Deﬁne a set
A = {x ∈Rn+1 | 1 < 2∥x∥< 3},
and use the ﬁeld w in part (b) to deﬁne functions wt : Rn+1 →Rn+1
for real t by
wt(x) = x + tw(x).
(c) Imitate the proof of Brouwer’s theorem to prove the measure of
the image set wt(A) is a polynomial in t when t is small.
(d) Prove directly the inclusion wt(A) ⊂
√
1 + t2A.
(e) For any point y in
√
1 + t2A, apply the Banach contraction the-
orem to the function x ∈kB →y −tw(x) (for large real k) to
deduce in fact
wt(A) =
√
1 + t2A
for small t.
(f) Complete the proof by combining parts (c) and (e).
♠
(g) If f is a continuous self map of Sn, where n is even, prove either
f or −f has a ﬁxed point.
(h) (Hedgehog theorem) Prove, for even n, that any nonvanishing
continuous vector ﬁeld must be somewhere normal: |⟨x, f(x)⟩| =
∥f(x)∥for some x in Sn.
(i) Find examples to show the Hairy ball theorem fails for all odd n.
17. ∗(Borsuk-Ulam theorem) Let Sn denote the Euclidean sphere
{x ∈Rn+1 | ∥x∥= 1}.
We state the following result without proof.

214
Fixed points
Theorem 8.1.13 (Borsuk-Ulam) For any positive integers m ≤n,
if the function f : Sn →Rm is continuous then there is a point x in Sn
satisfying f(x) = f(−x).
(a) If m ≤n and the map f : Sn →Rm is continuous and odd, prove
f vanishes somewhere.
(b) Prove any odd continuous self map f on Sn is surjective. (Hint:
for any point u in Sn, apply part (a) to the function
x ∈Sn →f(x) −⟨f(x), u⟩u. )
(c) Prove the result in part (a) is equivalent to the following result:
Theorem 8.1.14 For positive integers m < n there is no contin-
uous odd map from Sn to Sm.
(d) (Borsuk-Ulam implies Brouwer [157]) Let B denote the unit
ball in Rn, and and let S denote the boundary of the set B ×
[−1, 1]:
S = {(x, t) ∈B × [−1, 1] | ∥x∥= 1 or |t| = 1}.
(i) If the map g : S →Rn is continuous and odd, use part (a) to
prove g vanishes somewhere on S.
(ii) Consider a continuous self map f on B. By applying part (i)
to the function
(x, t) ∈S →(2 −|t|)x −tf(tx),
prove f has a ﬁxed point.
18. ∗∗(Generalized Riesz lemma) Consider a smooth norm |∥· ∥| on
E (that is, a norm which is continuously diﬀerentiable except at the
origin), and linear subspaces U, V ⊂E satisfying dim U > dim V = n.
Denote the unit sphere in U (in this norm) by S(U).
(a) By choosing a basis v1, v2, . . . , vn of V and applying the Borsuk-
Ulam theorem (see Exercise 17) to the map
x ∈S(U) →(⟨∇|∥· ∥|(x), vi⟩)n
i=1 ∈Rn,
prove there is a point x in S(U) satisfying ∇|∥· ∥|(x) ⊥V .

§8.1
Brouwer’s ﬁxed point theorem
215
(b) Deduce the origin is the nearest point to x in V (in this norm).
(c) With this norm, deduce there is a unit vector in U whose distance
from V is 1.
(d) Use the fact that any norm can be uniformly approximated arbi-
trarily well by a smooth norm to extend the result of part (c) to
arbitrary norms.
(e) Find a simpler proof when V ⊂U.
19. ∗∗(Riesz implies Borsuk) In this question we use the generalized
Riesz lemma, Exercise 18, to prove the Borsuk-Ulam result, Exercise
17(a). To this end, suppose the map f : Sn →Rn is continuous and
odd. Deﬁne functions
ui : Sn
→
R (i = 1, 2, . . ., n + 1),
and
vi : Rn
→
R (i = 1, 2, . . ., n),
by ui(x) = xi and vi(x) = xi for each index i. Deﬁne spaces of contin-
uous odd functions on Sn by
U
=
span {u1, u2, . . . .un+1},
V
=
span {v1 ◦f, v2 ◦f, . . . , vn ◦f}, and
E
=
U + V,
with norm ∥u∥= max u(Sn) (for u in E).
(a) Prove there is a function u in U satisfying ∥u∥= 1 and whose
distance from V is 1.
(b) Prove u attains its maximum on Sn at a unique point y.
(c) Use the fact that for any function w in E, we have
(∇∥· ∥(u))w = w(y)
to deduce f(y) = 0.

216
Fixed points
8.2
Selection results and the Kakutani-Fan
ﬁxed point theorem
The Brouwer ﬁxed point theorem in the previous section concerns functions
from a nonempty compact convex set to itself. In optimization, as we have
already seen in §5.4, it may be convenient to broaden our language to consider
multifunctions Ωfrom the set to itself and seek a ﬁxed point — a point x
satisfying x ∈Ω(x).
To begin this section we summarize some deﬁnitions for future reference.
We consider a subset K ⊂E, a Euclidean space Y, and a multifunction
Ω: K →Y. We say Ωis USC at a point x in K if every open set U containing
Ω(x) also contains Ω(z) for all points z in K close to x. Equivalently, for
any sequence of points (xn) in K approaching x, any sequence of elements
yn ∈Ω(xn), is eventually close to Ω(x). If Ωis USC at every point in K we
simply call it USC. On the other hand, as in §5.4, we say Ωis LSC if, for
every x in K, every neighbourhood V of any point in Ω(x) intersects Ω(z)
for all points z in K close to x.
We refer to the sets Ω(x) (x ∈K) as the images of Ω. The multifunc-
tion Ωis a cusco if it is USC with nonempty compact convex images. Clearly
such multifunctions are locally bounded: any point in K has a neighbourhood
whose image is bounded. Cuscos appear in several important optimization
contexts. For example, the Clarke subdiﬀerential of a locally Lipschitz func-
tion is a cusco (see Exercise 5).
To see another important class of examples we need a further deﬁnition.
We say a multifunction Φ : E →E is monotone if it satisﬁes the condition
⟨u −v, x −y⟩≥0 whenever u ∈Φ(x) and v ∈Φ(y).
In particular, any (not necessarily self-adjoint) positive semideﬁnite linear
operator is monotone, as is the subdiﬀerential of any convex function. One
multifunction contains another if the graph of the ﬁrst contains the graph of
the second. We say a monotone multifunction is maximal if the only mono-
tone multifunction containing it is itself. The subdiﬀerentials of closed proper
convex functions are examples (see Exercise 16). Zorn’s lemma (which lies
outside our immediate scope) shows any monotone multifunction is contained
in a maximal monotone multifunction.
Theorem 8.2.1 (Maximal monotonicity) Any maximal monotone mul-
tifunction is a cusco on the interior of its domain.

§8.2
Selection results and the Kakutani-Fan ﬁxed point theorem
217
Proof. See Exercise 16.
♠
Maximal monotone multifunctions in fact have to be single-valued generi-
cally, that is on sets which are ‘large’ in a topological sense, speciﬁcally on
a dense set which is a ‘Gδ’ (a countable intersection of open sets) — see
Exercise 17.
Returning to our main theme, the central result of this section extends
Brouwer’s theorem to the multifunction case.
Theorem 8.2.2 (Kakutani-Fan) If the set C ⊂E is nonempty, compact
and convex, then any cusco Ω: C →C has a ﬁxed point.
Before we prove this result, we outline a little more topology. A cover of
a set K ⊂E is a collection of sets in E whose union contains K. The cover
is open if each set in the collection is open. A subcover is just a subcollection
of the sets which is also a cover. The following result, which we state as
a theorem, is in truth the deﬁnition of compactness in spaces more general
than E.
Theorem 8.2.3 (General deﬁnition of compactness) Any open cover
of a compact set in E has a ﬁnite subcover.
Given a ﬁnite open cover {O1, O2, . . . , Om} of a set K ⊂E, a partition of
unity subordinate to this cover is a set of continuous functions p1, p2, . . . , pm :
K →R+ whose sum is identically 1 and satisfying pi(x) = 0 for all points
x outside Oi (for each index i). We outline the proof of the next result, a
central topological tool, in the exercises.
Theorem 8.2.4 (Partition of unity) There is a partition of unity subor-
dinate to any ﬁnite open cover of a compact subset of E.
Besides ﬁxed points, the other main theme of this section is the idea of
a continuous selection of a multifunction Ωon a set K ⊂E, by which we
mean a continuous map f on K satisfying f(x) ∈Ω(x) for all points x in K.
The central step in our proof of the Kakutani-Fan theorem is the following
‘approximate selection’ theorem.
Theorem 8.2.5 (Cellina) Given any compact set K ⊂E, suppose the mul-
tifunction Ω: K →Y is USC with nonempty convex images. Then for any

218
Fixed points
real ϵ > 0 there is a continuous map f : K →Y which is an ‘approximate
selection’ of Ω:
dG(Ω)(x, f(x)) < ϵ for all points x in K.
(8.2.6)
Furthermore the range of f is contained in the convex hull of the range of Ω.
Proof. We can assume the norm on E × Y is given by
∥(x, y)∥E×Y = ∥x∥E + ∥y∥Y for all x ∈E and y ∈Y
(since all norms are equivalent — see §4.1, Exercise 2). Now, since Ωis USC,
for each point x in K there is a real δx in the interval (0, ϵ/2) satisfying
Ω(x + δxBE) ⊂Ω(x) + ϵ
2BY.
Since the sets x + (δx/2)int BE (as the point x ranges over K) comprise an
open cover of the compact set K, there is a ﬁnite subset {x1, x2, . . . , xm} of
K with the sets xi + (δi/2)int BE comprising a ﬁnite subcover (where δi is
shorthand for δxi for each index i).
Theorem 8.2.4 shows there is a partition of unity p1, p2, . . . , pm : K →R+
subordinate to this subcover. We now construct our desired approximate
selection f by choosing a point yi from Ω(xi) for each i and deﬁning
f(x) =
m

i=1
pi(x)yi,
for all points x in K.
(8.2.7)
Fix any point x in K and deﬁne the set I = {i|pi(x) ̸= 0}. By deﬁnition,
x satisﬁes ∥x −xi∥< δi/2 for each i in I. If we choose an index j in I
maximizing δj, the triangle inequality shows ∥xj −xi∥< δj, whence we
deduce the inclusions
yi ∈Ω(xi) ⊂Ω(xj + δjBE) ⊂Ω(xj) + ϵ
2BY
for all i in I. In other words, for each i in I we know dΩ(xj)(yi) ≤ϵ/2. Since
the distance function is convex, equation (8.2.7) shows dΩ(xj)(f(x)) ≤ϵ/2.
Since we also know ∥x −xj∥< ϵ/2, this proves inequality (8.2.6). The ﬁnal
claim follows immediately from equation (8.2.7).
♠

§8.2
Selection results and the Kakutani-Fan ﬁxed point theorem
219
Proof of the Kakutani-Fan theorem With the assumption of the the-
orem, Cellina’s result above shows, for each positive integer r, there is a
continuous self map fr of C satisfying
dG(Ω)(x, fr(x)) < 1
r for all points x in C.
By Brouwer’s theorem (8.1.3), each fr has a ﬁxed point xr in C, which
therefore satisﬁes
dG(Ω)(xr, xr) < 1
r for each r.
Since C is compact, the sequence (xr) has a convergent subsequence, and its
limit must be a ﬁxed point of Ωbecause Ωis closed, by Exercise 3(c) (Closed
versus USC).
♠
In the next section we describe some variational applications of the Kaku-
tani-Fan theorem. But we end this section with an exact selection theorem
parallel to Cellina’s result but assuming a LSC rather than an USC multi-
function.
Theorem 8.2.8 (Michael) Given any closed set K ⊂E, suppose the mul-
tifunction Ω: K →Y is LSC with nonempty closed convex images. Then,
given any point (¯x, ¯y) in G(Ω), there is a continuous selection f of Ωsatis-
fying f(¯x) = ¯y.
We outline the proof in the exercises.
Exercises and commentary
Many useful properties of cuscos are summarized in [26]. An excellent gen-
eral reference on monotone operators is [139]. The topology we use in this
section can be found in any standard text: see [95, 60], for example. The
Kakutani-Fan theorem ﬁrst appeared in [98], and was extended in [66]. Cel-
lina’s approximate selection theorem appears, for example, in [3, p. 84]. One
example of the many uses of the Kakutani-Fan theorem is establishing equi-
libria in mathematical economics. The Michael selection theorem appeared
in [124].
1. (USC and continuity) Consider a closed subset K ⊂E and a mul-
tifunction Ω: K →Y.

220
Fixed points
(a) Prove the multifunction
x ∈E →

Ω(x)
(x ∈K),
∅
(x ̸∈K),
is USC if and only if Ωis USC.
(b) Prove a function f : K →Y is continuous if and only if the
multifunction x ∈K →{f(x)} is USC.
(c) Prove a function f : E →[−∞, +∞] is lower semicontinuous at a
point x in E if and only if the multifunction whose graph is the
epigraph of f is USC at x.
2. ∗(Minimum norm) If the set U ⊂E is open and the multifunction
Ω: U →Y is USC, prove the function g : U →Y deﬁned by
g(x) = inf{∥y∥| y ∈Ω(x)}
is lower semicontinuous.
3. (Closed versus USC)
(a) If the multifunction Φ : E →Y is closed and the multifunction
Ω: E →Y is USC at the point x in E with Ω(x) compact, prove
the multifunction
z ∈E →Ω(z) ∩Φ(z)
is USC at x.
(b) Hence prove that any closed multifunction with compact range is
USC.
(c) Prove any USC multifunction with closed images is closed.
(d) If an USC multifunction has compact images, prove it is locally
bounded.
4. (Composition) If the multifunctions Φ and Ωare USC prove so is
their composition x →Φ(Ω(x)).
5. ∗(Clarke subdiﬀerential) If the set U ⊂E is open and the function
f : U →R is locally Lipschitz, use §6.2, Exercise 12 (Closed subd-
iﬀerentials) and Exercise 3 (Closed versus USC) to prove the Clarke
subdiﬀerential x ∈U →∂◦f(x) is a cusco.

§8.2
Selection results and the Kakutani-Fan ﬁxed point theorem
221
6. ∗∗(USC images of compact sets) Consider a given multifunction
Ω: K →Y.
(a) Prove Ωis USC if and only if for every open subset U of Y the
set {x ∈K | Ω(x) ⊂U} is open in K.
Now suppose K is compact and Ωis USC with compact images. Using
the general deﬁnition of compactness (8.2.3), prove the range Ω(K) is
compact by following the steps below.
(b) Fix an open cover {Uγ | γ ∈Γ} of Ω(K). For each point x in K,
prove there is a ﬁnite subset Γx of Γ with
Ω(x) ⊂

γ∈Γx
Uγ.
(c) Construct an open cover of K by considering the sets
⎧
⎨
⎩z ∈K
 Ω(z) ⊂

γ∈Γx
Uγ
⎫
⎬
⎭,
as the point x ranges over K.
(d) Hence construct a ﬁnite subcover of the original cover of Ω(K).
7. ∗(Partitions of unity) Suppose the set K ⊂E is compact with a
ﬁnite open cover {O1, O2, . . ., Om}.
(i) Show how to construct another open cover {V1, V2, . . . , Vm} of K
satisfying cl Vi ⊂Oi for each index i. (Hint: each point x in K
lies in some set Oi, so there is a real δx > 0 with x + δxB ⊂Oi;
now take a ﬁnite subcover of {x + δxint B | x ∈K}, and build the
sets Vi from it.)
(ii) For each index i, prove the function qi : K →[0, 1] given by
qi =
dK\Oi
dK\Oi + dVi
is well-deﬁned and continuous, with qi identically zero outside the
set Oi.

222
Fixed points
(iii) Deduce that the set of functions pi : K →R+ deﬁned by
pi =
qi

j qj
is a partition of unity subordinate to the cover {O1, O2, . . . , Om}.
8. Prove the Kakutani-Fan theorem is also valid under the weaker as-
sumption that the images of the cusco Ω: C →E always intersect the
set C, using Exercise 3(a) (Closed versus USC).
9. ∗∗(Michael’s theorem) Suppose all the assumptions of Michael’s
theorem (8.2.8) hold. We consider ﬁrst the case with K compact.
(a) Fix a real ϵ > 0. By constructing a partition of unity subordinate
to a ﬁnite subcover of the open cover of K consisting of the sets
Oy = {x ∈E | dΩ(x)(y) < ϵ} for y in Y ,
construct a continuous function f : K →Y satisfying
dΩ(x)(f(x)) < ϵ for all points x in K.
(b) Construct a sequence of continuous functions f1, f2, . . . : K →Y
satisfying
dΩ(x)(fi(x))
<
2−i for i = 1, 2, . . ., and
∥fi+1(x) −fi(x)∥
<
21−i for i = 1, 2, . . .,
for all points x in K. (Hint: construct f1 by applying part (a)
with ϵ = 1/2; then construct fi+1 inductively by applying part (a)
to the multifunction
x ∈K →Ω(x) ∩(fi(x) + 2−iBY),
with ϵ = 2−i−1.
(c) The functions fi of part (b) must converge uniformly to a contin-
uous function f. Prove f is a continuous selection of Ω.
(d) Prove Michael’s theorem by applying part (c) to the multifunction
ˆΩ(x) =

Ω(x),
if x ̸= ¯x,
{¯y},
if x = ¯x.

§8.2
Selection results and the Kakutani-Fan ﬁxed point theorem
223
(e) Now extend to the general case where K is possibly unbounded in
the following steps. Deﬁne sets Kn = K∩nBE for each n = 1, 2, . . .
and apply the compact case to the multifunction Ω1 = Ω|K1 to
obtain a continuous selection g1 : K1 →Y. Then inductively ﬁnd
a continuous selection gn+1 : Kn+1 →Y from the multifunction
Ωn+1(x) =

{gn(x)}
(x ∈Kn)
Ω(x)
(x ∈Kn+1 \ Kn),
and prove the function deﬁned by
f(x) = gn(x)
(x ∈Kn, n = 1, 2, . . .)
is the required selection.
10. (Hahn-Katetov-Dowker sandwich theorem) Suppose the set K ⊂
E is closed.
(a) For any two lower semicontinuous functions f, g : K →R satis-
fying f ≥−g, prove there is a continuous function h : K →R
satisfying f ≥h ≥−g, by considering the multifunction x →
[−g(x), f(x)].
Observe the result also holds for extended-real-
valued f and g.
(b) (Urysohn lemma) Suppose the closed set V and the open set
U satisfy V ⊂U ⊂K. By applying part (i) to suitable func-
tions, prove there is a continuous function f : K →[0, 1] which is
identically equal to 1 on V and to 0 on Uc.
11. (Continuous extension) Consider a closed subset K of E and a con-
tinuous function f : K →Y. By considering the multifunction
Ω(x) =

{f(x)}
(x ∈K)
cl (conv f(K))
(x ̸∈K),
prove there is a continuous function g : E →Y satisfying g|K = f and
g(E) ⊂cl (conv f(K)).
12. ∗(Generated cuscos) Suppose the multifunction Ω: K →Y is
locally bounded, with nonempty images.

224
Fixed points
(a) Among those cuscos containing Ω, prove there is a unique one
with minimal graph, given by
Φ(x) =

ϵ>0
cl conv (Ω(x + ϵB))
(x ∈K).
(b) If K is nonempty, compact and convex, Y = E, and Ωsatisﬁes
the conditions Ω(K) ⊂K and
x ∈Φ(x) ⇒x ∈Ω(x)
(x ∈K),
prove Ωhas a ﬁxed point.
13. ∗(Multifunctions containing cuscos) Suppose the multifunction
Ω: K →Y is closed with nonempty convex images, and the function
f : K →Y has the property that f(x) is a point of minimum norm in
Ω(x) for all points x in K. Prove Ωcontains a cusco if and only if f is
locally bounded. (Hint: use Exercise 12 (Generated cuscos) to consider
the cusco generated by f.)
14. ∗(Singleton points) For any subset D of Y, deﬁne
s(D) = inf{r ∈R | D ⊂y + rBY for some y ∈Y}.
Consider an open subset U of E.
(a) If the multifunction Ω: U →Y is USC with nonempty images,
prove for any real ϵ > 0 the set
Sϵ = {x ∈U | s(Ω(x)) < ϵ}
is open. By considering the set ∩n>1S1/n, prove the set of points
in U whose image is a singleton is a Gδ.
(b) Use Exercise 5 (Clarke subdiﬀerential) to prove that the set of
points where a locally Lipschitz function f : U →R is strictly
diﬀerentiable is a Gδ. If U and f are convex (or if f is regular
throughout U), use Rademacher’s theorem (in §6.2) to deduce f
is generically diﬀerentiable.
15. (Skew symmetry) If the matrix A ∈Mn satisﬁes 0 ̸= A = −AT,
prove the multifunction x ∈Rn →xTAx is maximal monotone, yet is
not the subdiﬀerential of a convex function.

§8.2
Selection results and the Kakutani-Fan ﬁxed point theorem
225
16. ∗∗(Monotonicity) Consider a monotone multifunction Φ : E →E.
(a) (Inverses) Prove Φ−1 is monotone.
(b) Prove Φ−1 is maximal if and only if Φ is.
(c) (Applying maximality) Prove Φ is maximal if and only if it has
the property
⟨u −v, x −y⟩≥0 for all (x, u) ∈G(Φ)
⇒
v ∈Φ(y).
(d) (Maximality and closedness) If Φ is maximal prove it is closed,
with convex images.
(e) (Continuity and maximality) If Φ is everywhere single-valued
and hemicontinuous (that is, continuous on every line in E), prove
it is maximal. (Hint: apply part (c) with x = y + tw for w in E
and t ↓0 in R.)
(f) We say Φ is hypermaximal if Φ + λI is surjective for some real
λ > 0. In this case, prove Φ is maximal. (Hint: apply part (c)
and use a solution x ∈E to the inclusion v + λy ∈(Φ + λI)(x).)
What if just Φ is surjective?
(g) (Subdiﬀerentials) If the function f : E →(−∞, +∞] is closed,
convex and proper, prove ∂f is maximal monotone. (Hint: for
any element φ of E, prove the function
x ∈E →f(x) + ∥x∥2 + ⟨φ, x⟩
has a minimizer, and deduce ∂f is hypermaximal.)
(h) (Local boundedness) By completing the following steps, prove
Φ is locally bounded at any point in the core of its domain.
(i) Assume 0 ∈Φ(0) and 0 ∈core D(Φ), deﬁne a convex function
g : E →(−∞, +∞] by
g(y) = sup{⟨u, y −x⟩| x ∈B, u ∈Φ(x)}.
(ii) Prove D(Φ) ⊂dom g.
(iii) Deduce g is continuous at 0.
(iv) Hence show |g(y)| ≤1 for all small y, and deduce the result.

226
Fixed points
(j) (Maximality and cuscos) Use parts (d) and (h), and Exercise
3 (Closed versus USC) to conclude that any maximal monotone
multifunction is a cusco on the interior of its domain.
(k) (Surjectivity and growth) If Φ is surjective, prove
lim
∥x∥→∞∥Φ(x)∥= +∞.
(Hint: assume the maximality of Φ, and hence of Φ−1; deduce
Φ−1 is a cusco on E, and now apply Exercise 6 (USC images of
compact sets).)
17. ∗∗(Single-valuedness and maximal monotonicity) Consider a
maximal monotone multifunction Ω: E →E and an open subset U of
its domain, and deﬁne the minimum norm function g : U →R as in
Exercise 2.
(a) Prove g is lower semicontinuous. An application of the Baire cat-
egory theorem now shows that any such function is generically
continuous.
(b) For any point x in U at which g is continuous, prove Ω(x) is a
singleton.
(Hint: prove ∥· ∥is constant on Ω(x) by assuming
y, z ∈Ω(x) and ∥y∥> ∥z∥and deriving a contradiction from the
condition
⟨w −y, x + ty −x⟩≥0
for all small t > 0 and w ∈Ω(x + ty).)
(c) Conclude that any maximal monotone multifunction is generically
single-valued.
(d) Deduce that any convex function is generically diﬀerentiable on
the interior of its domain.

§8.3
Variational inequalities
227
8.3
Variational inequalities
At the very beginning of this book we considered the problem of minimizing
a diﬀerentiable function f : E →R over a convex set C ⊂E. A necessary
optimality condition for a point x0 in C to be a local minimizer is
⟨∇f(x0), x −x0⟩≥0 for all points x in C,
(8.3.1)
or equivalently
0 ∈∇f(x0) + NC(x0).
If the function f is convex instead of diﬀerentiable, the necessary and suﬃ-
cient condition for optimality (assuming a constraint qualiﬁcation) is
0 ∈∂f(x0) + NC(x0),
and there are analogous nonsmooth necessary conditions.
We call problems like (8.3.1) ‘variational inequalities’. Let us ﬁx a mul-
tifunction Ω: C →E. In this section we use the ﬁxed point theory we have
developed to study the multivalued variational inequality
V I(Ω, C) :
Find points x0 in C and y0 in Ω(x0) satisfying
⟨y0, x −x0⟩≥0 for all points x in C.
A more concise way to write the problem is:
Find a point x0 in C satisfying 0 ∈Ω(x0) + NC(x0).
(8.3.2)
Suppose the set C is closed, convex and nonempty. Recall that the pro-
jection PC : E →C is the (continuous) map which sends points in E to their
unique nearest points in C (see §2.1, Exercise 8). Using this notation we can
also write the variational inequality as a ﬁxed point problem:
Find a ﬁxed point of
PC ◦(I −Ω) : C →C.
(8.3.3)
This reformulation is useful if the multifunction Ωis single-valued, but less
so in general because the composition will often not have convex images.
A more versatile approach is to deﬁne the (multivalued) normal mapping
ΩC = (Ω◦PC) + I −PC, and repose the problem as:
Find a point ¯x in E satisfying 0 ∈ΩC(¯x);
(8.3.4)

228
Fixed points
then setting x0 = PC(¯x) gives a solution to the original problem. Equiva-
lently, we could phrase this as:
Find a ﬁxed point of (I −Ω) ◦PC : E →E.
(8.3.5)
As we shall see, this last formulation lets us immediately use the ﬁxed point
theory of the previous section.
The basic result guaranteeing the existence of solutions to variational
inequalities is the following.
Theorem 8.3.6 (Solvability of variational inequalities) If the subset
C of E is compact, convex and nonempty, then for any cusco Ω: C →E the
variational inequality V I(Ω, C) has a solution.
Proof. We in fact prove Theorem 8.3.6 is equivalent to the Kakutani-
Fan ﬁxed point theorem (8.2.2).
When Ωis a cusco its range Ω(C) is compact — we outline the proof in
§8.2, Exercise 6. We can easily check that the multifunction (I−Ω)◦PC is also
a cusco, because the projection PC is continuous. Since this multifunction
maps the compact convex set conv (C −Ω(C)) into itself, the Kakutani-Fan
theorem shows it has a ﬁxed point, which, as we have already observed,
implies the solvability of V I(Ω, C).
Conversely, suppose the set C ⊂E is nonempty, compact and convex.
For any cusco Ω: C →C, the Solvability theorem (8.3.6) implies we can
solve the variational inequality V I(I −Ω, C), so there are points x0 in C and
z0 in Ω(x0) satisfying
⟨x0 −z0, x −x0⟩≥0 for all points x in C.
Setting x = z0 shows x0 = z0, so x0 is a ﬁxed point.
♠
An elegant application is von Neumann’s minimax theorem, which we
proved by a Fenchel duality argument in §4.2, Exercise 16. Consider Eu-
clidean spaces Y and Z, nonempty compact convex subsets F ⊂Y and G ⊂
Z, and a linear map A : Y →Z. If we deﬁne a function Ω: F × G →Y × Z
by Ω(y, z) = (−A∗z, Ay), then it is easy to see that a point (y0, z0) in F × G
solves the variational inequality V I(Ω, F ×G) if and only if it is a saddlepoint:
⟨z0, Ay⟩≤⟨z0, Ay0⟩≤⟨z, Ay0⟩
for all y ∈F, z ∈G.

§8.3
Variational inequalities
229
In particular, by the Solvability of variational inequalities theorem, there
exists a saddlepoint, so
min
z∈G max
y∈F ⟨z, Ay⟩= max
y∈F min
z∈G ⟨z, Ay⟩.
Many interesting variational inequalities involve a noncompact set C. In
such cases we need to impose a growth condition on the multifunction to
guarantee solvability. The following result is an example.
Theorem 8.3.7 (Noncompact variational inequalities) If the subset C
of E is nonempty, closed and convex, and the cusco Ω: C →E is coercive,
that is, it satisﬁes the condition
lim inf
∥x∥→∞, x∈C inf ⟨x, Ω(x) + NC(x)⟩> 0,
(8.3.8)
then the variational inequality V I(Ω, C) has a solution.
Proof. For any large integer r, we can apply the solvability theorem (8.3.6)
to the variational inequality V I(Ω, C ∩rB) to ﬁnd a point xr in C ∩rB
satisfying
0
∈
Ω(xr) + NC∩rB(xr)
=
Ω(xr) + NC(xr) + NrB(xr)
⊂
Ω(xr) + NC(xr) + R+xr
(using §3.3, Exercise 10). Hence for all large r, the point xr satisﬁes
inf ⟨xr, Ω(xr) + NC(xr)⟩≤0.
This sequence of points (xr) must therefore remain bounded, by the coercivity
condition (8.3.8), and so xr lies in int rB for large r and hence satisﬁes
0 ∈Ω(xr) + NC(xr), as required.
♠
A straightforward exercise shows in particular that the growth condition
(8.3.8) holds whenever the cusco Ωis deﬁned by x ∈Rn →xTAx for a
matrix A in Sn
++.
The most important example of a noncompact variational inequality is
the case when the set C is a closed convex cone S ⊂E. In this case V I(Ω, S)
becomes the multivalued complementarity problem:
Find points x0 in S and y0 in Ω(x0) ∩(−S−)
satisfying ⟨x0, y0⟩= 0.
(8.3.9)

230
Fixed points
As a particular example, we consider the dual pair of abstract linear programs
(5.3.4) and (5.3.5):
⎧
⎪
⎨
⎪
⎩
inf
⟨c, z⟩
subject to
Az −b
∈
H,
z
∈
K,
(8.3.10)
(where Y is a Euclidean space, the map A : E →Y is linear, the cones
H ⊂Y and K ⊂E are closed and convex, and b and c are given elements of
Y and E respectively), and
⎧
⎪
⎨
⎪
⎩
sup
⟨b, φ⟩
subject to
A∗φ −c
∈
K−,
φ
∈
−H−.
(8.3.11)
As usual, we denote the corresponding primal and dual optimal values by
p and d. We consider the corresponding variational inequality on the space
E × Y,
V I(Ω, K × (−H−)),
where
Ω(z, φ) = (c −A∗φ, Ax −b).
(8.3.12)
Theorem 8.3.13 (Linear programming and variational inequalities)
Any solution of the above variational inequality (8.3.12) consists of a pair of
optimal solutions for the linear programming dual pair (8.3.10) and (8.3.11).
The converse is also true, providing there is no duality gap (p = d).
We leave the proof as an exercise.
Notice that the linear map appearing in the above example, M : E×Y →
E × Y deﬁned by M(z, φ) = (−A∗φ, Az), is monotone. We study monotone
complementarity problems further in Exercise 7.
To end this section we return to the complementarity problem (8.3.9) in
the special case where E is Rn, the cone S is Rn
+, and the multifunction Ω
is single-valued: Ω(x) = {F(x)} for all points x in Rn
+. In other words, we
consider the following problem:
Find a point x0 in Rn
+ satisfying F(x0) ∈Rn
+ and ⟨x0, F(x0)⟩= 0.
The lattice operation ∧is deﬁned on Rn by (x ∧y)i = min{xi, yi} for points
x and y in Rn and each index i. With this notation we can rewrite the above
problem as an order complementarity problem:
OCP(F) :
Find a point x0 in Rn
+ satisfying x0 ∧F(x0) = 0.

§8.3
Variational inequalities
231
The map x ∈Rn →x ∧F(x) ∈Rn is sometimes amenable to ﬁxed point
methods.
As an example, let us ﬁx a real α > 0, a vector q ∈Rn, and an n×n matrix
P with nonnegative entries, and deﬁne the map F : Rn →Rn by F(x) =
αx −Px + q. Then the complementarity problem OCP(F) is equivalent to
ﬁnding a ﬁxed point of the map Φ : Rn →Rn deﬁned by
Φ(x) = 1
α(0 ∨(Px −q)),
(8.3.14)
a problem which can be solved iteratively — see Exercise 9.
Exercises and commentary
A survey of variational inequalities and complementarity problems may be
found in [83]. The normal mapping ΩC is especially well studied when the
multifunction Ωis single-valued with aﬃne components and the set C is
polyhedral. In this case the normal mapping is piecewise aﬃne (see [146]).
More generally, if we restrict the class of multifunctions Ωwe wish to con-
sider in the variational inequality, clearly we can correspondingly restrict the
versions of the Kakutani-Fan theorem or normal mappings we study. Order
complementarity problems are studied further in [25]. The Nash equilibrium
theorem (Exercise 10(d)), which appeared in [134], asserts the existence of a
Pareto eﬃcient choice for n individuals consuming from n associated convex
sets with n associated joint cost functions.
1. Prove the equivalence of the various formulations (8.3.2), (8.3.3), (8.3.4)
and (8.3.5) with the original variational inequality V I(Ω, C).
2. Use §8.2, Exercise 4 (Composition) to prove the multifunction
(I −Ω) ◦PC
in the proof of Theorem 8.3.6 (Solvability of variational inequalities) is
a cusco.
3. By considering the function
x ∈[0, 1] →

1/x
(x > 0)
−1
(x = 0),

232
Fixed points
show the assumption in Theorem 8.3.6 (Solvability of variational in-
equalities) that the multifunction Ωis USC cannot be weakened to Ω
closed.
4. ∗(Variational inequalities containing cuscos) Suppose the set
C ⊂E is nonempty, compact and convex, and consider a multifunction
Ω: C →E.
(a) If Ωcontains a cusco, prove the variational inequality V I(Ω, C)
has a solution.
(b) Deduce from Michael’s theorem (8.2.8) that if Ωis LSC with non-
empty closed convex images then V I(Ω, C) has a solution.
5. Check the details of the proof of von Neumann’s minimax theorem.
6. Prove Theorem 8.3.13 (Linear programming and variational inequali-
ties).
7. (Monotone complementarity problems) Suppose the linear map
M : E →E is monotone.
(a) Prove the function x ∈E →⟨Mx, x⟩is convex.
For a closed convex cone S ⊂E and a point q in E, consider the
optimization problem
⎧
⎪
⎨
⎪
⎩
inf
⟨Mx + q, x⟩
subject to
Mx + q
∈
−S−,
x
∈
S.
(8.3.15)
(b) If the condition −q ∈core (S−+ MS) holds, use the Fenchel du-
ality theorem (3.3.5) to prove problem (8.3.15) has optimal value
0.
(c) If the cone S is polyhedral, problem (8.3.15) is a convex ‘quadratic
program’: when the optimal value is ﬁnite it is known that there is
no duality gap for such a problem and its (Fenchel) dual, and that
both problems attain their optimal value. Deduce that when S is
polyhedral and contains a point x with Mx + q in −S−, there is
such a point satisfying the additional complementarity condition
⟨Mx + q, x⟩= 0.

§8.3
Variational inequalities
233
8. ∗Consider a compact convex set C ⊂E satisfying C = −C, and a
continuous function f : C →E. If f has no zeroes, prove there is
a point x on the boundary of C satisfying ⟨f(x), x⟩< 0. (Hint: for
positive integers n, consider V I(f + I/n, C).)
9. (Iterative solution of OCP [25]) Consider the order complementar-
ity problem OCP(F) for the function F that we deﬁned before equation
(8.3.14). A point x0 in Rn
+ is feasible if it satisﬁes F(x0) ≥0.
(a) Prove the map Φ in equation (8.3.14) is isotone: x ≥y implies
Φ(x) ≥Φ(y) for points x and y in Rn.
(b) Suppose the point x0 in Rn
+ is feasible. Deﬁne a sequence (xr) in
Rn
+ inductively by xr+1 = Φ(xr). Prove this sequence decreases
monotonically: xr+1
i
≤xr
i for all r and i.
(c) Prove the limit of the sequence in part (b) solves OCP(F).
(d) Deﬁne a sequence (yr) in Rn
+ inductively by y0 = 0 and yr+1 =
Φ(yr). Prove this sequence increases monotonically.
(e) If OCP(F) has a feasible solution, prove the sequence in part (d)
converges to a limit ¯y which solves OCP(F). What happens if
OCP(F) has no feasible solution?
(f) Prove the limit ¯y of part (e) is the minimal solution of OCP(F):
any other solution x satisﬁes x ≥¯y.
10. ∗(Fan minimax inequality [66]) We call a real function g on a
convex set C ⊂E quasi-concave if the set {x ∈C | g(x) ≥α} is convex
for all real α.
Suppose the set C ⊂E is nonempty, compact and convex.
(a) If the function f : C ×C →R has the properties that the function
f(·, y) is quasi-concave for all points y in C and the function f(x, ·)
is lower semicontinuous for all points x in C, prove Fan’s inequality
min
y
sup
x f(x, y) ≤sup
x f(x, x).
(Hint: apply the KKM theorem (§8.1, Exercise 15) to the family
of sets
{y ∈C | f(x, y) ≤β}
(x ∈C),
where β denotes the right-hand-side of Fan’s inequality.)

234
Fixed points
(b) If the function F : C →E is continuous, apply Fan’s inequality
to the function f(x, y) = ⟨F(y), y −x⟩to prove the variational
inequality V I(F, C) has a solution.
(c) Deduce Fan’s inequality is equivalent to the Brouwer ﬁxed point
theorem.
(d) (Nash equilibrium) Deﬁne a set C = C1 × C2 × . . . × Cn, where
each set Ci ⊂E is nonempty, compact and convex.
For any
continuous functions f1, f2, . . . , fn : C →R, if each function
xi ∈Ci →fi(y1, . . . , xi, . . . , yn)
is convex for all elements y of C, prove there is an element y of C
satisfying the inequalities
fi(y) ≤fi(y1, . . . , xi, . . . , yn) for all xi ∈Ci, i = 1, 2, . . ., n.
(Hint: apply Fan’s inequality to the function
f(x, y) =

i
(fi(y) −fi(y1, . . . , xi, . . . , yn)).)
(e) (Minimax) Apply the Nash equilibrium result from part (d) in
the case n = 2 and f1 = −f2 to deduce the Kakutani minimax
theorem (§4.3, Exercise 14).
11. (Bolzano-Poincar´e-Miranda intermediate value theorem) Con-
sider the box
J = {x ∈Rn | 0 ≤xi ≤1 for all i}.
We call a continuous map f : J →Rn reversing if it satisﬁes the
condition
fi(x)fi(y) ≤0 whenever xi = 0 and yi = 1 (i = 1, 2, . . ., n).
Prove any such map vanishes somewhere on J, by completing the fol-
lowing steps.
(a) Observe the case n = 1 is just the classical intermediate value
theorem.

§8.3
Variational inequalities
235
(b) For all small real ϵ > 0, prove the function f ϵ = f + ϵI satisﬁes,
for all i,
xi = 0 and yi = 1
⇒
either
f ϵ
i (y) > 0,
f ϵ
i (x) ≤0,
or
f ϵ
i (y) < 0,
f ϵ
i (x) ≥0.
(c) From part (b), deduce there is a function ˜f ϵ, deﬁned coordinate-
wise by ˜f ϵ
i = ±f ϵ
i , for some suitable choice of signs, satisfying the
conditions (for each i)
˜f ϵ
i (x) ≤0
whenever
xi = 0 and
˜f ϵ
i (x) > 0
whenever
xi = 1.
(d) By considering the variational inequality V I( ˜f ϵ, J), prove there is
a point xϵ in J satisfying ˜f ϵ(xϵ) = 0.
(e) Complete the proof by letting ϵ approach 0.
12. (Coercive cuscos) Consider a multifunction Ω: E →E with non-
empty images.
(a) If Ωis a coercive cusco, prove it is surjective.
(b) On the other hand, if Ωis monotone, use §8.2, Exercise 16 (Mono-
tonicity) to deduce Ωis hypermaximal if and only if it is maximal.
(We generalize this result in Exercise 13 (Monotone variational in-
equalities).)
13. ∗∗(Monotone variational inequalities) Consider a monotone mul-
tifunction Φ : E →E and a continuous function G : E →E.
(a) Given a nonempty compact convex set K ⊂E, prove there is
point x0 in K satisfying
⟨x −x0, y + G(x0)⟩≥0 for all x ∈K, y ∈Φ(x),
by completing the following steps.
(i) Assuming the result fails, show the collection of sets
{x ∈K | ⟨z −x, w + G(x)⟩< 0}
(z ∈K, w ∈Φ(z))
is an open cover of K.

236
Fixed points
(ii) For a partition of unity p1, p2, . . . , pn subordinate to a ﬁnite
subcover K1, K2, . . .Kn corresponding to points zi ∈K and
wi ∈Φ(zi) (for i = 1, 2, . . ., n), prove the function
f(x) =

i
pi(x)zi
is a continuous self map of K.
(iii) Prove the inequality
⟨f(x) −x,

i pi(x)wi + G(x)⟩
=

i,j
pi(x)pj(x)⟨zj −x, wi + G(x)⟩
<
0
by considering the terms in the double sum where i = j and
sums of pairs where i ̸= j separately.
(iv) Deduce a contradiction with part (ii).
(b) Now assume G satisﬁes the growth condition
lim
∥x∥→∞∥G(x)∥= +∞
and
lim inf
∥x∥→∞
⟨x, G(x)⟩
∥x∥∥G(x)∥> 0.
(i) Prove there is a point x0 in E satisfying
⟨x −x0, y + G(x0)⟩≥0 whenever y ∈Φ(x).
(Hint: apply part (a) with K = nB for n = 1, 2, . . ..)
(ii) If Φ is maximal, deduce −G(x0) ∈Φ(x0).
(c) Apply part (b) to prove that if Φ is maximal then for any real
λ > 0, the multifunction Φ + λI is surjective.
(d) (Hypermaximal ⇔maximal) Using §8.2, Exercise 16 (Mono-
tonicity), deduce a monotone multifunction is maximal if and only
if it is hypermaximal.
(e) (Resolvent) If Φ is maximal then for any real λ > 0 and any point
y in E prove there is a unique point x satisfying the inclusion
y ∈Φ(x) + λx.

§8.3
Variational inequalities
237
(f) (Maximality and surjectivity) Prove a maximal Φ is surjective
if and only if it satisﬁes the growth condition
lim
∥x∥→∞inf ∥Φ(x)∥= +∞.
(Hint: the ‘only if’ direction is §8.2, Exercise 16(k) (Monotonic-
ity); for the ‘if’ direction, apply part (e) with λ = 1/n for n =
1, 2, . . ., obtaining a sequence (xn); if this sequence is unbounded,
apply maximal monotonicity.)
14. ∗(Semideﬁnite complementarity) Deﬁne a function F : Sn ×Sn →
Sn by
F(U, V ) = U + V −(U2 + V 2)1/2.
For any function G : Sn →Sn, prove U ∈Sn solves the variational
inequality V I(G, Sn
+) if and only if F(U, G(U)) = 0. (Hint: see §5.2,
Exercise 11.)

Chapter 9
Postscript: inﬁnite versus ﬁnite
dimensions
9.1
Introduction
We have chosen to ﬁnish this book by indicating many of the ways in which
ﬁnite dimensionality has played a critical role in the previous chapters. While
our list is far from complete it should help illuminate the places in which care
is appropriate when “generalizing”. Many of our main results (on subgra-
dients, variational principles, open mappings, Fenchel duality, metric reg-
ularity) immediately generalize to at least reﬂexive Banach spaces. When
they do not, it is principally because the compactness properties and sup-
port properties of convex sets have become signiﬁcantly more subtle. There
are also signiﬁcantly many properties which characterize Hilbert space. The
most striking is perhaps the deep result that a Banach space X is (isomorphic
to) Hilbert space if and only if every closed vector subspace is complemented
in X. Especially with respect to best approximation properties, it is Hilbert
space which best captures the properties of Euclidean space.
Since this chapter will be primarily helpful to those with some knowledge
of Banach space functional analysis, we make use of a fair amount of standard
terminology without giving details. In the exercises more speciﬁc cases are
considered.
Throughout, X is a real Banach space with continuous dual space X∗
and f : X →(−∞, +∞], is usually convex and proper (somewhere ﬁnite).
If f is everywhere ﬁnite and lower semicontinuous then f is continuous —
238

§9.1
Introduction
239
since a Banach space is barreled, as it is a Baire space (see Exercise 1). This
is one of the few signiﬁcant analytic properties which hold in a large class
of incomplete normed spaces. By contrast, it is known that completeness
is characterized by the nonemptiness or maximality of subdiﬀerentials on a
normed space. For example, on every incomplete normed space there is a
closed convex function with an empty subdiﬀerential, and a closed convex
set with no support points.
The convex subdiﬀerential is deﬁned by
∂f(x) = {x∗∈X∗: ⟨x∗, h⟩≤f(x + h) −f(x), ∀h ∈X} .
In what follows, sets are usually closed and convex and B(X) denotes the
closed unit ball, B(X) = {x|∥x∥≤1}. In general our notation and terminol-
ogy are consistent with the Banach space literature. We will interchangeably
write ⟨x∗, h⟩or x∗(h) depending whether functional or vectorial ideas are
ﬁrst in our minds.
A point x∗of a convex set C is a (proper) support point of C if there
exists a linear continuous functional φ with
φ(x∗) = σ = sup
C φ > inf
C φ.
Then φ is said to be a (nontrivial) supporting functional and H = φ−1(σ) is
a supporting hyperplane. In the case when C = B(X), then φ is said to be
norm attaining.
We complete the preliminaries by recalling some derivative notions. Let
β denote a bornology: that is, a family of bounded and centrally symmetric
subsets of X, closed under positive scalar multiplication and ﬁnite unions,
and whose union is X. We write x∗∈∂βf(x) if for all sets B in β and real
ϵ > 0, there exists real δ > 0 such that
⟨x∗, h⟩≤f(x + th) −f(x)
t
+ ϵ
for all t ∈(0, δ) and h ∈B.
It is useful to identify the following bornologies:
points
↔
Gˆateaux (G)
(norm) compacts
↔
Hadamard (H)
weak compacts
↔
weak Hadamard (WH)
bounded
↔
Fr´echet (F).

240
Postscript: inﬁnite versus ﬁnite dimensions
Then ∂Hf(x) = ∂Gf(x) for any locally Lipschitz f, while ∂F f(x) = ∂W Hf(x)
when X is a reﬂexive space.
With this language we may deﬁne the β-
derivative of f at x by
{∇βf(x)} = ∂βf(x) ∩−∂β(−f)(x)
so that
{∇βf(x)} = ∂βf(x)
for concave f.
For convex functions there is a subtle interplay between these notions.
For example, a convex function which is weak Hadamard diﬀerentiable at a
point of X is Fr´echet diﬀerentiable at that point if ℓ1(N) ̸⊂X. For general
Lipschitz mappings the situation is much simpler. For example, on every
nonreﬂexive but smooth Banach space there is a distance function which is
everywhere weak Hadamard diﬀerentiable but is not Fr´echet diﬀerentiable
at some point. Hence the situation on c0(N) diﬀers entirely for convex and
distance functions.
9.2
Finite dimensionality
We begin with a compendium of standard and relatively easy results whose
proofs may be pieced together from many sources. Sometimes, the separable
version of these results is simpler.
Theorem 9.2.1 (Closure, continuity and compactness) The following
statements are equivalent:
(i) X is ﬁnite-dimensional.
(ii) Every vector subspace of X is closed.
(iii) Every linear map taking values in X has closed range.
(iv) Every linear functional on X is continuous.
(v) Every convex function f : X →R is continuous.
(vi) The closed unit ball in X is (pre-) compact.

§9.2
Finite dimensionality
241
(vii) For each closed set C in X and for each x in X, the distance
dC(x) = inf{∥x −y∥| y ∈C}
is attained.
(viii) The weak and norm topologies coincide on X.
(ix) The weak-star and norm topologies coincide on X∗.
Turning from continuity to tangency properties of convex sets we have:
Theorem 9.2.2 (Support and separation) The following statements are
equivalent:
(i) X is ﬁnite-dimensional.
(ii) Whenever a lower semicontinuous convex f : X →(−∞, +∞] has a
unique subgradient at x then f is Gˆateaux diﬀerentiable at x.
(iii) X is separable and every (closed) convex set in X has a supporting
hyperplane at each boundary point.
(iv) Every (closed) convex set in X has nonempty relative interior.
(v) A ∩R = ∅, A closed and convex, R a ray (or line) ⇒A and R are
separated by a closed hyperplane.
It is conjectured, but not proven, that (iii) holds in all nonseparable Banach
spaces.
In essence these two results say ‘don’t trust ﬁnite dimensionally derived
intuitions’. In Exercise 6 we present a nonconvex tangency characterization.
By comparison, the following is a much harder and less well-known set of
results.
Theorem 9.2.3 The following statements are equivalent:
(i) X is ﬁnite-dimensional.
(ii) Weak-star and norm convergence agree for sequences in X∗.
(iii) Every continuous convex f : X →R is bounded on bounded sets.

242
Postscript: inﬁnite versus ﬁnite dimensions
(iv) For every continuous convex f : X →R, ∂f is bounded on bounded
sets.
(v) For every continuous convex f : X →R, any point of Gˆateaux diﬀer-
entiability is a point of Fr´echet diﬀerentiability.
Proof sketch. (i) ⇒(iii) or (v) is clear; (iii) ⇒(iv) is easy.
To see (v) ⇒(ii) and (iii) ⇒(ii) we proceed as follows. Consider sequences
(x∗
n) in X∗and (αn) in R satisfying ∥x∗
n∥= 1 and 0 < αn ↓0. Deﬁne
f(x) = sup
n∈N{⟨x∗
n, x⟩−αn}.
Then f is convex and continuous, and satisﬁes
Gˆateaux diﬀerentiable at 0
⇔
x∗
n
w∗
→0,
and
Fr´echet diﬀerentiable at 0
⇔
∥x∗
n∥∗→0.
Thus (v) ⇒(ii).
Now consider the function
f(x) =

n
ϕn(⟨x∗
n, x⟩),
(9.2.1)
where ϕn(t) = n

|t| −1
2
+. Then f is
ﬁnite (continuous)
⇔
x∗
n
w∗
→0,
and is
bounded on bounded sets ⇔∥x∗
n∥∗→0.
Thus (iii) ⇒(ii).
♠
Note that the sequential coincidence of weak and norm topologies char-
acterizes the so-called Schur spaces (such as ℓ1(N)), while the sequential
coincidence of weak and weak-star topologies characterizes the Grothendieck
spaces (reﬂexive spaces and nonreﬂexive spaces such as ℓ∞(N)).
The last four statements of the previous theorem are equivalent in the
strong sense that they are easily interderived while no ‘easy proof’ is known
of (ii) ⇒(i). (This is the Josephson-Nissenzweig theorem, ﬁrst established
in 1975.) For example, (ii) ⇒(iii) follows from the next result.

§9.3
Counterexamples and exercises
243
Proposition 9.2.4 Suppose that f : X →R is continuous and convex and
that {xn} is bounded while f(xn) →∞. Then
x∗
n ∈∂f(xn) ⇒ψn =
x∗
n
∥x∗n∥
w∗
→0.
♠
Thus each such function yields a Josephson-Nissenzweig sequence of unit
vectors w∗-convergent to 0.
Theorem 9.2.3 highlights the somewhat disconcerting fact that even in-
nocent seeming examples of convex functions inevitably involve deeper ques-
tions about the structure of Banach spaces.
Thus for example:
• in c0(N) with the supremum norm, ∥· ∥∞one may ﬁnd an equivalent
norm ball, B0(X), so that the sum B∞(X) + B0(X) is open. This is
certainly not possible in a reﬂexive space, where closed bounded convex
sets are weakly compact.
• a Banach space X is reﬂexive if and only if each continuous linear
functional is norm attaining: that is, it achieves its norm on the unit
ball in X. (This is the celebrated theorem of James.) In consequence,
in each nonreﬂexive space there is a closed hyperplane H such that for
no point x outside H is dH(x) attained.
• in most nonseparable spaces there exist closed convex sets C each of
whose points is a proper support point. This is certainly not possible
in a separable space, wherein quasi relative interior points must exist.
9.3
Counterexamples and exercises
1. (Absorbing sets) A convex set C with the property X = ∪{tC|t ≥0}
is said to be absorbing (and zero is said to be in the core of C).
(a) A normed space is said to be barreled if every closed convex ab-
sorbing subset C has zero in its interior. Use the Baire Category
theorem to show that Banach spaces are barreled.
(There are

244
Postscript: inﬁnite versus ﬁnite dimensions
normed spaces which are barreled but in which the Baire category
theorem fails and Baire normed spaces which are not complete:
appropriate dense hyperplanes and countable codimension sub-
spaces will do the job.)
(b) Let f be proper lower semicontinuous and convex. Suppose that
zero lies in the core of the domain of f. By considering the set
C = {x ∈X | f(x) ≤1},
deduce that f is continuous at zero.
(c) Show that an inﬁnite-dimensional Banach space cannot be writ-
ten as a countable union of ﬁnite-dimensional subspaces, and so
cannot have a countable but inﬁnite vector space basis.
(d) Let X = ℓ2(N) and let C = {x ∈X | |xn| ≤2−n}. Show
X ̸=

{tC | t ≥0} but X = cl

{tC | t ≥0}.
(e) Let X = ℓp(N) for 1 ≤p < ∞. Let
C = {x ∈X | |xn| ≤4−n},
and let
D = {x ∈X | xn = 2−nt, t ≥0}.
Show C ∩D = {0}, and so
TC∩D(0) = {0}
but
TC(0) ∩TD(0) = D.
(In general, we need to require something like 0 ∈core(C −D),
which fails in this example — see also §7.1, Exercise 6(h).)
(f) Show that in every (separable) inﬁnite-dimensional Banach space,
there is a proper vector subspace Y with cl (Y ) = X. Thus, show
that in every such space there is a nonclosed convex set with empty
interior whose closure has interior.

§9.3
Counterexamples and exercises
245
2. (Unique subgradients)
(a) Show that in any Banach space, a lower semicontinuous convex
function is continuous at any point of Gˆateaux diﬀerentiability.
(b) Let f be the indicator function of the non-negative cone in ℓp(N)
for 1 ≤p < ∞. Let x∗have strictly positive coordinates. Then
prove 0 is the unique element of ∂f(x∗) but f is not continuous
at x∗.
(c) Let X = L1[0, 1] with Lebesgue measure. Consider the negative
Boltzmann-Shannon entropy function:
B(x) =
 1
0 x(t) log x(t))dt
for x(t) ≥0 almost everywhere, and B(x) = +∞otherwise.
Show B is convex, nowhere continuous (but lower semicontinu-
ous) and has a unique subgradient throughout its domain, namely
1 + log x(t).
3. (Norm attaining functionals)
(a) Find a non-norm-attaining functional in c0(N), in ℓ∞(N), and in
ℓ1(N).
(b) Consider the unit ball of ℓ1(N) as a set C in ℓ2(N). Show that
C is closed and bounded and has empty interior. Determine the
support points of C.
4. (Support points)
(a) Let X be separable and let C ⊂X be closed, bounded and convex.
Let {xn | n ∈N} be dense in C. Let x∗= ∞
n=1 2−nxn. Then
any linear continuous functional f with f(x∗) = supC f must be
constant on C and so x∗is not a proper support point of C.
(b) Show that every point of the nonnegative cone in the space ℓ1(R)
is a support point.

246
Postscript: inﬁnite versus ﬁnite dimensions
5. (Sums of closed cones)
(a) Let X = ℓ2(N). Construct two closed convex cones (subspaces)
S and T such that S ∩T = {0} while S−+ T −̸= ℓ2(N). Deduce
that the sum of closed subspaces may be dense.
(b) Let X = ℓ2(N). Construct two continuous linear operators map-
ping X to itself such that each has dense range but their ranges
intersect only at zero. (This is easier if one uses the Fourier iden-
tiﬁcation of L2 with ℓ2.)
6. (Epigraphical and tangential regularity)
(a) let C be a closed subset of a ﬁnite-dimensional space. Show that
d−
C(0; h) = dKC(0)(h)
for all h ∈X. Show also that dC is regular at x ∈C if and only
if C is regular at x.
(b) In every inﬁnite-dimensional space X there is necessarily a se-
quence of unit vectors {un} such that inf{∥un −um∥> 0|n ̸= m}.
Consider the set
C = {4−n(u0 + un/4) | n = 0, 1, 2, · · ·} ∪{0}.
Show the following results:
(i) TC(0) = KC(0) = 0.
(ii) For all h ∈X,
∥h∥= d◦
C(0; h) = dKC(0)(h)
≥d−
C(0; h) ≥−(−d)◦
C(0; h) = −∥h∥.
(iii) d◦
C(0; u0) = dKC(0)(u0) > d−
C(0; u0).
(iv) (−d)◦
C(0; u0) > (−d)−
C(0; u0).
Conclude that C is regular at 0, but that neither dC nor −dC is
regular at 0.
(c) Establish that X is ﬁnite-dimensional if and only if regularity of
sets coincides with regularity deﬁned via distance functions.

§9.3
Counterexamples and exercises
247
7. (Polyhedrality) There is one especially striking example where ﬁnite-
dimensional results ‘lift’ very satisfactorily to the inﬁnite-dimensional
setting. A set in a Banach space is a polyhedron if it is the intersec-
tion of a ﬁnite number of halfspaces. The deﬁnition of a polytope is
unchanged since its span is ﬁnite-dimensional.
(a) Observe that polyhedra and polytopes coincide if and only if X is
ﬁnite-dimensional.
(b) Show that a set is a polyhedron if and only if it is the sum of a
ﬁnite-dimensional polyhedron and of a closed ﬁnite-codimensional
subspace of X.
So each polyhedron really ‘lives’ in a ﬁnite-dimensional quotient space.
In essence, this is why convex problems subject to a ﬁnite number of
linear inequality constraints are so tractable. By contrast, note that
Theorem 9.2.2(v) shows that even a ray may cause diﬃculties when the
other set is not polyhedral.
8. (Semicontinuity of separable functions on ℓp) Let functions ϕi :
R →[0, +∞] be given for i ∈N. Let the function F be deﬁned on
X = ℓp for 1 ≤p < ∞by
F(x) =

i
ϕi(xi).
Relatedly, suppose the function ϕ : R →(−∞, +∞] is given, and
consider the function
Fϕ(x) =

i
ϕ(xi).
(a) Show that F is convex and lower semicontinuous on X if and only
if each ϕi is convex and lower semicontinuous on R.
(b) Suppose 0 ∈dom Fϕ. Show that Fϕ is convex and lower semicon-
tinuous on X if and only if
(i) ϕ is convex and lower semicontinuous on R, and
(ii) infR ϕ = 0 = ϕ(0).
Thus for ϕ = exp∗we have Fϕ is a natural convex function which
is not lower semicontinuous.

248
Postscript: inﬁnite versus ﬁnite dimensions
9. (Sums of subspaces)
(a) Let M and N be closed subspaces of X. Show that M + N is
closed when N is ﬁnite-dimensional.
(Hint: First consider the case when M ∩N = {0}.)
(b) Let X = ℓp for 1 ≤p < ∞. Deﬁne closed subspaces M and N by
M = {x | x2n = 0} and N = {x | x2n = 2−nx2n−1}.
Show that M + N is not closed. Observe that the same result
obtains if M is replaced by the cone
K = {x | x2n = 0, x2n−1 ≥0}.
(Hint: Denote the unit vectors by (un). Let
xn =

k<n
u2k−1 and yn = xn +

k<n
2−ku2k.
Then xn ∈M, yn ∈N but xn −yn ∈M + N converges to

k<∞2ku2k ̸∈M + N.]
(c) Relatedly, let X := ℓ2 and denote the unit vectors by (un). Sup-
pose (αn) is a sequence of positive real numbers with 1 > αn > 0
and limn αn = 1, suﬃciently fast. Set
en = u2n−1,
fn = αnu2n−1 +

1 −α2nu2n.
Consider the subspaces
M1 = cl span{e1, e2, . . .} and M2 = cl span{f1, f2, . . .}.
(i) Show M1 ∩M2 = {0} and that the sum M⊥
1 + M⊥
2 is dense in
X but not closed.
(ii) Dually, show that M⊥
1 ∩M⊥
2 = {0} and that the sum M1+M2
is dense in X but not closed.
(iii) Find two continuous linear operators on X, T1 and T2, such
that both have dense range but R(T1) ∩R(T2) = {0}. (Such
subspaces are called disjoint operator ranges.)

§9.4
Notes on previous chapters
249
9.4
Notes on previous chapters
9.4.1
Chapter 1: Background
In inﬁnite-dimensional spaces, the separation theorem is known as the geo-
metric version of the Hahn-Banach theorem, and is one of the basic principles
of functional analysis (for example see [158] or [151]).
The Bolzano-Weierstrass theorem requires some assumption on the space
to hold. One of its main applications can be stated as follows: any lower
semicontinuous real-valued function on a countably compact space (a space
for which every countable open cover has a ﬁnite subcover) is bounded below
and assumes its minimum [151].
Exercise 13 in §1.1 (The relative interior) does not extend to the inﬁnite-
dimensional setting. As a simple counterexample, consider the nullspace H
of a discontinuous linear functional. It is dense (and so not closed), convex
and nonempty but has empty relative interior. To overcome that diﬃculty,
new deﬁnitions were given to classify sets that are big enough in some sense
(compactly epi-Lipschitz sets, epi-Lipschitz-like sets, . . .).
All these deﬁ-
nitions agree in ﬁnite dimensions.
Another approach considers the ‘quasi
relative interior’ (see [32]).
9.4.2
Chapter 2: Inequality constraints
First order necessary conditions hold in general spaces [94, 118]. However,
one has to be careful about nearest point properties (§2.1, Exercise 8). We
have existence and unicity of the nearest point to a closed convex set in a
Hilbert space or for weakly compact convex sets in a strictly convex norm,
but no longer without any assumptions. Often one can deal with approxi-
mations by using density results such as the Bishop-Phelps theorem: the set
of continuous linear functionals which attain their norm on the unit ball in
a Banach space is norm dense in the dual [139, 73].
9.4.3
Chapter 3: Fenchel duality
The main results (Fenchel duality, Lagrange multiplier theorem) still hold in
a very general setting [94, 118]. Properties of convex functions deﬁned on
Banach spaces are investigated in [139, 73]. Note that many properties of

250
Postscript: inﬁnite versus ﬁnite dimensions
cones coincide in ﬁnite dimensions, while one has to be more careful in the
inﬁnite-dimensional setting (see [28]).
9.4.4
Chapter 4: Convex analysis
Convexity in general linear spaces is studied in [87].
In inﬁnite dimensions, Minkowski’s theorem requires some assumption
on the space since there may be bounded closed convex sets which do not
have supporting hyperplanes (indeed, James’ theorem states that a Banach
space is reﬂexive if, and only if, every continuous linear functional achieves
its maximum on the closed unit ball). Here is a generalization of Minkowski’s
theorem: any weakly compact (respectively closed bounded) convex subset of
a Banach space (respectively Banach space with the Radon-Nikod´ym prop-
erty) is the closed convex hull of its strongly exposed points [57].
The Open mapping theorem extends to general Banach spaces (for ex-
ample see [158]). Similarly, the Moreau-Rockafellar theorem holds in general
spaces [133, 147]. Furthermore, Lagrangian duality, which is equivalent to
Fenchel duality, can be established in great generality [118, 94].
9.4.5
Chapter 5: Special cases
The theory of linear operators is well-developed in inﬁnite dimensions. See
[136] for spectral theory in Banach algebras, and [167] on compact opera-
tors. Many of the eigenvalue results have extensions for compact selfadjoint
operators [35].
As we saw, closed convex processes are natural generalizations of linear
mappings: in Banach space they admit open mapping, closed graph and
uniform boundedness theorems (see [4], and also [2] for applications to dif-
ferential inclusions).
9.4.6
Chapter 6: Nonsmooth optimization
All the calculus rules and the mean value theorem extend. Note however
that Hadamard and Fr´echet derivatives are no longer equal (see [51] and also
this chapter). Density theorems extend (see [139]).
Various subdiﬀerentials have been deﬁned in inﬁnite dimensions. See the
recent survey [39] for how calculus rules and main properties are proved, as
well as for some applications.

§9.4
Notes on previous chapters
251
9.4.7
Chapter 7: The Karush-Kuhn-Tucker theorem
Ekeland’s variational principle holds in complete metric spaces (see [2]). It
has numerous applications: for example it is used in [139] to obtain the
Brønsted-Rockafellar theorem, which in turn implies the Bishop-Phelps the-
orem (see also [73]).
The idea of a variational principle is to consider a point where the function
is almost minimized, and show it is the minimum of a slightly perturbed func-
tion. In Ekeland’s variational principle, the perturbed function is obtained
by adding a Lipschitz function to the original function. On the other hand,
the Borwein-Preiss variational principle adds a smooth convex function. This
latter principle is used in [39] to obtain several results on subdiﬀerentials.
There are several other such principles: examples include Stella’s varia-
tional principle [52] (which adds a linear function), and the Deville-Godefroy-
Zizler variational principle (see [139, §4]).
Metric regularity results extend to Banach space: see [132], for example.
Constraint qualiﬁcations take various forms in inﬁnite dimensions, see
[94, 118] for some examples.
9.4.8
Chapter 8: Fixed points
The Banach contraction principle holds in complete metric spaces. More-
over, in the Banach space setting, ﬁxed point theorems hold not only for
contractions but also for certain nonexpansive maps: see [57] for more pre-
cise formulations. See also [168] for a more extensive reference on ﬁxed point
theorems and applications.
Brouwer’s theorem holds in Banach spaces for continuous self maps on a
compact convex set [168]. Michael’s selection theorem extends to appropriate
multifunctions from a paracompact space into a Banach space [2], as does
the Cellina selection theorem.

Chapter 10
List of results and notation
10.1
Named results and exercises
§1.1: Euclidean spaces
Theorem 1.1.1 (Basic separation)
Theorem 1.1.2 (Bolzano-Weierstrass)
Proposition 1.1.3 (Weierstrass)
Exercise 4 (Radstrom cancellation)
Exercise 5 (Strong separation)
Exercise 6 (Recession cones)
Exercise 9 (Composing convex functions)
Exercise 10 (Convex growth conditions)
Exercise 11 (Accessibility lemma)
Exercise 12 (Aﬃne sets)
Exercise 13 (The relative interior)
§1.2: Symmetric matrices
Theorem 1.2.1 (Fan)
Proposition 1.2.4 (Hardy-Littlewood-Polya)
Theorem 1.2.5 (Birkhoﬀ)
252

List of results and notation
253
Exercise 3 (S3
+ is not strictly convex)
Exercise 4 (A non-lattice ordering)
Exercise 5 (Order preservation)
Exercise 6 (Square-root iteration)
Exercise 7 (The Fan and Cauchy-Schwarz inequalities)
Exercise 12 (Fan’s inequality)
Exercise 13 (A lower bound)
Exercise 14 (Level sets of perturbed log barriers)
Exercise 15 (Theobald’s condition)
Exercise 16 (Generalizing Theobald’s condition)
Exercise 17 (Singular values and von Neumann’s lemma)
§2.1: Optimality conditions
Proposition 2.1.1 (First order necessary condition)
Proposition 2.1.2 (First order suﬃcient condition)
Corollary 2.1.3 (First order conditions, linear constraints)
Theorem 2.1.5 (Second order conditions)
Theorem 2.1.6 (Basic separation)
Exercise 2 (Examples of normal cones)
Exercise 3 (Self-dual cones)
Exercise 4 (Normals to aﬃne sets)
Exercise 6 (The Rayleigh quotient)
Exercise 8 (Nearest points)
Exercise 8(e) (Projection on Rn
+ and Sn
+)
Exercise 9 (Coercivity)
Exercise 11 (Kirchhoﬀ’s law)
Exercise 12 (Matrix completion)
Exercise 13 (BFGS update)
Exercise 15 (Nearest polynomial with a given root)
§2.2: Theorems of the alternative
Theorem 2.2.1 (Gordan)
Lemma 2.2.7 (Farkas)

254
List of results and notation
Exercise 5 (Carath´eodory’s theorem)
Exercise 7 (Ville’s theorem)
Exercise 8 (Stiemke’s theorem)
Exercise 9 (Schur-convexity)
§2.3: Max-functions and ﬁrst order conditions
Proposition 2.3.2 (Directional derivatives of max-functions)
Theorem 2.3.6 (Fritz John conditions)
Assumption 2.3.7 (The Mangasarian-Fromowitz constraint
qualiﬁcation)
Theorem 2.3.8 (Karush-Kuhn-Tucker conditions)
Exercise 2 (Failure of Karush-Kuhn-Tucker)
Exercise 3 (Linear independence implies Mangasarian-Fro-
mowitz)
Exercise 5 (Cauchy-Schwarz and steepest descent)
Exercise 6 (H¨older’s inequality)
Exercise 8 (Minimum volume ellipsoid)
§3.1: Subgradients and convex functions
Proposition 3.1.1 (Sublinearity)
Proposition 3.1.2 (Sublinearity of the directional deriva-
tive)
Proposition 3.1.5 (Subgradients at optimality)
Proposition 3.1.6 (Subgradients and the directional deriva-
tive)
Theorem 3.1.8 (Max formula)
Corollary 3.1.10 (Diﬀerentiability of convex functions)
Theorem 3.1.11 (Hessian characterization of convexity)
Exercise 2 (Core versus interior)
Exercise 4 (Subgradients and normal cones)
Exercise 8 (Subgradients of norm)
Exercise 9 (Subgradients of maximum eigenvalue)
Exercise 12 (Recognizing convex functions)

List of results and notation
255
Exercise 13 (Local convexity)
Exercise 14 (Examples of convex functions)
Exercise 15 (Examples of convex functions)
Exercise 16 (Bregman distances)
Exercise 17 (Convex functions on R2)
Exercise 19 (Domain of subdiﬀerential)
Exercise 20 (Monotonicity of gradients)
Exercise 21 (The log barrier)
Exercise 24 (Minimizers of essentially smooth functions)
Exercise 25 Convex matrix functions
Exercise 26 (Log-convexity)
Exercise 27 (Maximum entropy)
Exercise 28 (DAD problems)
Exercise 29 (Relativizing the Max formula)
§3.2: The value function
Proposition 3.2.3 (Lagrangian suﬃcient conditions)
Theorem 3.2.8 (Lagrangian necessary conditions)
Exercise 5 (Mixed constraints)
Exercise 6 (Extended convex functions)
Exercise 7 (Nonexistence of multiplier)
Exercise 8 (Duﬃn’s duality gap)
Exercise 9 (Karush-Kuhn-Tucker vectors)
Exercise 11 (Normals to epigraphs)
Exercise 12 (Normals to level sets)
Exercise 13 (Subdiﬀerential of max-function)
Exercise 14 (Minimum volume ellipsoid)
§3.3: The Fenchel conjugate
Proposition 3.3.3 (Log barriers)
Proposition 3.3.4 (Fenchel-Young inequality)
Theorem 3.3.5 (Fenchel duality and convex calculus)
Corollary 3.3.11 (Fenchel duality for linear constraints)

256
List of results and notation
Proposition 3.3.12 (Self-dual cones)
Corollary 3.3.13 (Krein-Rutman polar cone calculus)
Theorem 3.3.14 (Bipolar cone)
Theorem 3.3.15 (Pointed cones)
Exercise 2 (Quadratics)
Exercise 4 (Self-conjugacy)
Exercise 5 (Support functions)
Exercise 7 (Maximum entropy example)
Exercise 9 (Fenchel duality and convex calculus)
Exercise 10 (Normals to an intersection)
Exercise 11 (Failure of convex calculus)
Exercise 12 (Inﬁmal convolution)
Exercise 13 (Applications of Fenchel duality)
Exercise 13(a) (Sandwich theorem)
Exercise 13(c) (Pshenichnii-Rockafellar conditions)
Exercise 13(e) (Hahn-Banach extension)
Exercise 15 (Bipolar theorem)
Exercise 16 (Sums of closed cones)
Exercise 17 (Subdiﬀerential of a max-function)
Exercise 18 (Order convexity)
Exercise 19 (Order convexity of inversion)
Exercise 20 (Pointed cones and bases)
Exercise 21 (Order-subgradients)
Exercise 22 (Linearly constrained examples)
Exercise 22(a) Separable problems
Exercise 22(a)(i) (Nearest points in polyhedrons)
Exercise 22(a)(ii) (Analytic centre)
Exercise 22(a)(iii) (Maximum entropy)
Exercise 22(b) (BFGS update)
Exercise 22(c) (DAD problem)
Exercise 23 (Linear inequalities)
Exercise 24 (Symmetric Fenchel duality)
Exercise 25 (Divergence bounds)
§4.1: Continuity of convex functions
Theorem 4.1.1 (Local boundedness)

List of results and notation
257
Theorem 4.1.3 (Convexity and continuity)
Theorem 4.1.4 (Core and interior)
Theorem 4.1.5 (Bipolar set)
Theorem 4.1.6 (Supporting hyperplane)
Theorem 4.1.8 (Minkowski)
Exercise 1 (Points of continuity)
Exercise 2 (Equivalent norms)
Exercise 3 (Examples of polars)
Exercise 4 (Polar sets and cones)
Exercise 5 (Polar sets)
Exercise 6 (Polar sets and strict separation)
Exercise 7 (Polar calculus)
Exercise 8 (Polar calculus)
Exercise 9 (Open mapping theorem)
Exercise 10 (Conical absorption)
Exercise 11 (H¨older’s inequality)
Exercise 12 (Pareto minimization)
Exercise 12(d) (Scalarization)
Exercise 13 (Existence of extreme points)
Exercise 16 (A converse of Minkowski’s theorem)
Exercise 17 (Extreme points)
Exercise 18 (Exposed points)
Exercise 19 (Tangency conditions)
Exercise 20 (Properties of the relative interior)
Exercise 22 (Birkhoﬀ’s theorem)
§4.2: Fenchel biconjugation
Theorem 4.2.1 (Fenchel biconjugation)
Corollary 4.2.3 (Support functions)
Theorem 4.2.4 (Moreau-Rockafellar)
Theorem 4.2.5 (Strict-smooth duality)
Proposition 4.2.7 (Lower semicontinuity and closure)
Exercise 2 (Lower semicontinuity and closedness)
Exercise 3 (Pointwise maxima)
Exercise 5 (Midpoint convexity)

258
List of results and notation
Exercise 7 (Inverse of subdiﬀerential)
Exercise 8 (Closed subdiﬀerential)
Exercise 9 (Support functions)
Exercise 10 (Almost homogeneous functions)
Exercise 12 (Compact bases for cones)
Exercise 14 (Lower semicontinuity and closure)
Exercise 16 (Von Neumann’s minimax theorem)
Exercise 17 (Recovering primal solutions)
Exercise 19 (Strict-smooth duality)
Exercise 20 (Logarithmic homogeneity)
Exercise 21 (Coﬁniteness)
Exercise 22 (Computing closures)
Exercise 23 (Recession functions)
Exercise 24 (Fisher information function)
Exercise 25 (Finiteness of biconjugate)
Exercise 26 (Self-dual cones)
Exercise 27 (Conical open mapping)
Exercise 28 (Expected surprise)
§4.3: Lagrangian duality
Proposition 4.3.5 (Dual optimal value)
Corollary 4.3.6 (Zero duality gap)
Theorem 4.3.7 (Dual attainment)
Theorem 4.3.8 (Primal attainment)
Exercise 1 (Weak duality)
Exercise 3 (Slater and compactness)
Exercise 4 (Examples of duals)
Exercise 5 (Duﬃn’s duality gap, continued)
Exercise 8 (Mixed constraints)
Exercise 9 (Fenchel and Lagrangian duality)
Exercise 10 (Trust region subproblem duality)
Exercise 12 (Conjugates of compositions)
Exercise 13 (A symmetric pair)
Exercise 14 (Convex minimax theory)

List of results and notation
259
§5.1: Polyhedral convex sets and functions
Proposition 5.1.1 (Polyhedral functions)
Proposition 5.1.3 (Finitely generated functions)
Theorem 5.1.7 (Polyhedrality)
Proposition 5.1.8 (Polyhedral algebra)
Corollary 5.1.9 (Polyhedral Fenchel duality)
Corollary 5.1.10 (Mixed Fenchel duality)
Exercise 6 (Tangents to polyhedra)
Exercise 7 (Polyhedral algebra)
Exercise 9 (Polyhedral cones)
Exercise 11 (Generalized Fenchel duality)
Exercise 12 (Relativizing Mixed Fenchel duality)
Exercise 13 (Geometric programming)
§5.2: Functions of eigenvalues
Theorem 5.2.2 (Spectral conjugacy)
Corollary 5.2.3 (Davis)
Corollary 5.2.4 (Spectral subgradients)
Corollary 5.2.5 (Spectral diﬀerentiability)
Exercise 4 (Examples of convex spectral functions)
Exercise 8 (Orthogonal invariance)
Exercise 10 (Filmore-Williams)
Exercise 11 (Semideﬁnite complementarity)
Exercise 12 (Eigenvalue sums)
Exercise 13 (Davis’ theorem)
Exercise 14 (DC functions)
§5.3: Duality for linear and semideﬁnite programming
Corollary 5.3.6 (Cone programming duality)
Corollary 5.3.7 (Linear programming duality)
Corollary 5.3.10 (Semideﬁnite programming duality)
Exercise 3 (Linear programming duality gap)

260
List of results and notation
Exercise 7 (Complementary slackness)
Exercise 8 (Semideﬁnite programming duality)
Exercise 9 (Semideﬁnite programming duality gap)
Exercise 10 (Central path)
Exercise 11 (Semideﬁnite central path)
Exercise 12 (Relativizing cone programming duality)
§5.4: Convex process duality
Proposition 5.4.1 (Openness and lower semicontinuity)
Theorem 5.4.8 (Adjoint process duality)
Theorem 5.4.10 (Norm duality)
Theorem 5.4.12 (Open mapping)
Theorem 5.4.13 (Closed graph)
Exercise 1 (Inverse multifunctions)
Exercise 2 (Convex images)
Exercise 5 (LSC and lower semicontinuity)
Exercise 7 (Biconjugation)
Exercise 14 (Linear maps)
Exercise 15 (Normal cones)
Exercise 15(c) (Krein-Grossberg)
Exercise 16 (Inverse boundedness)
Exercise 17 (Localization)
Exercise 18 (Cone duality)
Exercise 19 (Order epigraphs)
Exercise 20 (Condition number)
Exercise 21 (Distance to inconsistency)
§6.1: Generalized derivatives
Corollary 6.1.2 (Nonsmooth max formulae)
Theorem 6.1.5 (Nonsmooth calculus)
Theorem 6.1.8 (Nonsmooth necessary condition)
Exercise 1 (Examples of nonsmooth derivatives)
Exercise 2 (Continuity of Dini derivative)

List of results and notation
261
Exercise 4 (Surjective Dini subdiﬀerential)
Exercise 6 (Failure of Dini calculus)
Exercise 9 (Mean value theorem)
Exercise 9(b) (Monotonicity and convexity)
Exercise 10 (Max-functions)
Exercise 11 (Order statistics)
§6.2: Nonsmooth regularity and strict diﬀerentiability
Proposition 6.2.1 (Unique Michel-Penot subgradient)
Theorem 6.2.2 (Regularity of convex functions)
Theorem 6.2.3 (Strict diﬀerentiability)
Theorem 6.2.4 (Unique Clarke subgradient)
Theorem 6.2.5 (Intrinsic Clarke subdiﬀerential)
Exercise 2 (Regularity and nonsmooth calculus)
Exercise 9 (Mixed sum rules)
Exercise 10 (Types of diﬀerentiability)
Exercise 12 (Closed subdiﬀerentials)
Exercise 13 (Dense Dini subgradients)
Exercise 14 (Regularity of order statistics)
Exercise 15 (Subdiﬀerentials of eigenvalues)
Exercise 15(h) (Isotonicity of λ)
§6.3: Tangent cones
Proposition 6.3.2 (Exact penalization)
Theorem 6.3.6 (Tangent cones)
Corollary 6.3.7 (Convex tangent cone)
Corollary 6.3.9 (Nonsmooth necessary conditions)
Proposition 6.3.10 (Contingent necessary condition)
Exercise 1 (Exact penalization)
Exercise 2 (Distance function)
Exercise 3 (Examples of tangent cones)
Exercise 4 (Topology of contingent cone)
Exercise 5 (Topology of Clarke cone)

262
List of results and notation
Exercise 6 (Intrinsic tangent cones)
Exercise 8 (Isotonicity)
Exercise 9 (Products)
Exercise 10 (Tangents to graphs)
Exercise 11 (Graphs of Lipschitz functions)
Exercise 12 (Proper Pareto minimization)
Exercise 12(c) (Scalarization)
Exercise 13 (Boundary properties)
Exercise 13(f) (Nonconvex separation)
Exercise 14 (Pseudo-convexity and suﬃciency)
Exercise 15 (No ideal tangent cone exists)
Exercise 16 (Distance function)
§6.4: The limiting subdiﬀerential
Theorem 6.4.1 (Fuzzy sum rule)
Theorem 6.4.4 (Limiting subdiﬀerential sum rule)
Exercise 3 (Local minimizers)
Exercise 4 (Failure of sum rule)
Exercise 7 (Limiting and Clarke subdiﬀerential)
Exercise 8 (Topology of limiting subdiﬀerential)
Exercise 9 (Tangents to graphs)
Exercise 10 (Composition)
Exercise 10(e) (Composition rule)
Exercise 10(f) (Mean value theorem)
Exercise 10(g) (Max rule)
Exercise 11 (Viscosity subderivatives)
Exercise 12 (Order statistic)
§7.1: An introduction to metric regularity
Theorem 7.1.2 (Ekeland variational principle)
Theorem 7.1.5 (Surjectivity and metric regularity)
Theorem 7.1.6 (Liusternik)
Exercise 2 (Lipschitz extension)

List of results and notation
263
Exercise 3 (Closure and the Ekeland principle)
Exercise 6 (Transversality)
Exercise 6(g) (Guignard)
Exercise 7 (Liusternik via inverse functions)
§7.2: The Karush-Kuhn-Tucker theorem
Assumption 7.2.3 (The Mangasarian-Fromowitz constraint
qualiﬁcation)
Theorem 7.2.9 (Karush-Kuhn-Tucker conditions)
Exercise 1 (Linear independence implies Mangasarian-Fro-
mowitz)
Exercise 3 (Linear constraints)
Exercise 4 (Bounded multipliers)
Exercise 5 (Slater condition)
Exercise 6 (Largest eigenvalue)
Exercise 7 (Largest singular value)
Exercise 7(f) (Jordan)
Exercise 8 (Hadamard’s inequality)
Exercise 9 (Nonexistence of multipliers)
Exercise 10 (Guignard optimality conditions)
Exercise 11 (Quadratic penalties)
§7.3: Metric regularity and the limiting subdiﬀerential
Theorem 7.3.3 (Limiting subdiﬀerential and regularity)
Corollary 7.3.4 (Surjectivity and metric regularity)
Corollary 7.3.6 (Distance to level sets)
Exercise 3 (Metric regularity and openness)
Exercise 4 (Limiting normals and distance functions)
Exercise 5 (Normals to products)
Exercise 8 (Limiting versus Clarke conditions)
Exercise 9 (Normals to level sets)

264
List of results and notation
§7.4: Second order conditions
Theorem 7.4.2 (Second order necessary conditions)
Theorem 7.4.8 (Second order suﬃcient condition)
Exercise 1 (Higher order conditions)
Exercise 2 (Uniform multipliers)
Exercise 3 (Standard second order necessary conditions)
Exercise 4 (Narrow and broad critical cones are needed)
Exercise 5 (Standard second order suﬃcient conditions)
Exercise 6 (Guignard-type conditions)
§8.1: Brouwer’s ﬁxed point theorem
Theorem 8.1.2 (Banach contraction)
Theorem 8.1.3 (Brouwer)
Theorem 8.1.4 (Stone-Weierstrass)
Theorem 8.1.5 (Change of variable)
Theorem 8.1.6 (Retraction)
Exercise 1 (Banach iterates)
Exercise 2 (Nonexpansive maps)
Exercise 2(c) (Browder-Kirk)
Exercise 3 (Non-uniform contractions)
Exercise 11 (Convex sets homeomorphic to the ball)
Exercise 12 (A non-closed nonconvex set with the ﬁxed
point property)
Exercise 13 (Change of variable and Brouwer)
Exercise 14 (Brouwer and inversion)
Exercise 15 (Kuratowski-Knaster-Mazurkiewicz principle)
Exercise 15(b) (KKM implies Brouwer)
Exercise 15(c) (Brouwer implies KKM)
Exercise 16 (Hairy ball theorem)
Exercise 16(h) (Hedgehog theorem)
Exercise 17 (Borsuk-Ulam theorem)
Exercise 17(d) (Borsuk-Ulam implies Brouwer)
Exercise 18 (Generalized Riesz lemma)
Exercise 19 (Riesz implies Borsuk)

List of results and notation
265
§8.2: Selection results and the Kakutani-Fan theorem
Theorem 8.2.1 (Maximal monotonicity)
Theorem 8.2.2 (Kakutani-Fan)
Theorem 8.2.3 (General deﬁnition of compactness)
Theorem 8.2.4 (Partition of unity)
Theorem 8.2.5 (Cellina)
Theorem 8.2.8 (Michael)
Exercise 1 (USC and continuity)
Exercise 2 (Minimum norm)
Exercise 3 (Closed versus USC)
Exercise 4 (Composition)
Exercise 5 (Clarke subdiﬀerential)
Exercise 6 (USC images of compact sets)
Exercise 7 (Partitions of unity)
Exercise 9 (Michael’s theorem)
Exercise 10 (Hahn-Katetov-Dowker sandwich theorem)
Exercise 10(b) (Urysohn lemma)
Exercise 11 (Continuous extension)
Exercise 12 (Generated cuscos)
Exercise 13 (Multifunctions containing cuscos)
Exercise 14 (Singleton points)
Exercise 15 (Skew symmetry)
Exercise 16 (Monotonicity)
Exercise 16(a) (Inverses)
Exercise 16(c) (Applying maximality)
Exercise 16(d) (Maximality and closedness)
Exercise 16(e) (Continuity and maximality)
Exercise 16(g) (Subdiﬀerentials)
Exercise 16(h) (Local boundedness)
Exercise 16(j) (Maximality and cuscos)
Exercise 16(k) (Surjectivity and growth)
Exercise 17 (Single-valuedness and maximal monotonicity)

266
List of results and notation
§8.3: Variational inequalities
Theorem 8.3.6 (Solvability of variational inequalities)
Theorem 8.3.7 (Noncompact variational inequalities)
Theorem 8.3.13 (Linear programming and variational in-
equalities)
Exercise 4 (Variational inequalities containing cuscos)
Exercise 7 (Monotone complementarity problems)
Exercise 9 (Iterative solution of OCP)
Exercise 10 (Fan minimax inequality)
Exercise 10(d) (Nash equilibrium)
Exercise 10(e) (Minimax)
Exercise 11 (Bolzano-Poincar´e-Miranda intermediate val-
ue theorem)
Exercise 12 (Coercive cuscos)
Exercise 13 (Monotone variational inequalities)
Exercise 13(d) (Hypermaximal ⇔maximal)
Exercise 13(e) (Resolvent)
Exercise 13(f) (Maximality and surjectivity)
Exercise 14 (Semideﬁnite complementarity)
§9.2: Finite dimensions
Theorem 9.2.1 (Closure, continuity and compactness)
Theorem 9.2.2 (Support and separation)
Exercise 1 (Absorbing sets)
Exercise 2 (Unique subgradients)
Exercise 3 (Norm attaining functionals)
Exercise 4 (Support points)
Exercise 5 (Sums of closed cones)
Exercise 6 (Epigraphical and tangential regularity)
Exercise 7 (Polyhedrality)
Exercise 8 (Semicontinuity of separable functions on ℓp)
Exercise 9 (Sums of subspaces)

List of results and notation
267
10.2
Notation
§1.1: Euclidean spaces
E: a Euclidean space
R: the reals
⟨·, ·⟩: inner product
Rn: the real n-vectors
∥· ∥: the norm
B: the unit ball
C + D, C −D, ΛC: set sum, diﬀerence, and scalar product
×: Cartesian product
R+: the nonnegative reals
Rn
+: the nonnegative orthant
Rn
≥: the vectors with nonincreasing components
span : linear span
conv : convex hull
int : interior
Rn
++: the interior of the nonnegative orthant
→, lim: (vector) limit
cl : closure
bd : boundary
Dc: set complement

268
List of results and notation
A∗: adjoint map
N(·): null space
G⊥: orthogonal complement
inf, sup: inﬁmum, supremum
◦: composition of functions
0+(·): recession cone
aﬀ, ri : aﬃne hull, relative interior
§1.2: Symmetric matrices
Sn: the n × n real symmetric matrices
Sn
+: the positive semideﬁnite matrices
≤,
<,
≥,
>: componentwise ordering
⪯,
≺,
⪰,
≻: semideﬁnite ordering
Sn
++: the positive deﬁnite matrices
I: identity matrix
tr : trace
λi(·): i’th largest eigenvalue
Diag (·): diagonal matrix
det: determinant
On: the orthogonal matrices
X1/2: matrix square-root
[·]: nonincreasing rearrangement

List of results and notation
269
Pn: the permutation matrices
Γn: the doubly stochastic matrices
Mn: the n × n real matrices
σi(·): i’th largest singular value
§2.1: Optimality conditions
f ′(·; ·): directional derivative
∇: Gˆateaux derivative
NC(·): normal cone
∇2: Hessian
y+: positive part of vector
PC: projection on C
§2.2: Theorems of the alternative
PY: orthogonal projection
§2.3: Max-functions and ﬁrst order conditions
I(·): active set
N: the natural numbers
L(·; ·): Lagrangian

270
List of results and notation
§3.1: Subgradients and convex functions
δC: indicator function
dom : domain
lin : lineality space
core : core
∂: subdiﬀerential
dom ∂f: domain of subdiﬀerential
Γ(·): Gamma function.
§3.2: The value function
L(·; ·): Lagrangian
v(·): value function
epi : epigraph
dom : domain
§3.3: The Fenchel conjugate
h∗: conjugate
lb : log barrier on Rn
++
ld : log det on Sn
++
cont : points of continuity
K−: polar cone
TC(·): (convex) tangent cone

List of results and notation
271
⊙: inﬁmal convolution
dC: distance function
g∗: concave conjugate
§4.1: Continuity of convex functions
∆: the simplex
γC: gauge function
C◦: polar set
ext (·): extreme points
§4.2: Fenchel biconjugation
lim inf h(xr): liminf of sequence
cl h: closure of function
0+f: recession function
h◦: concave polar
§4.3: Lagrangian duality
Φ: dual function
§5.4: Convex process duality
D(·): domain of multifunction
Φ(C): image under a multifunction

272
List of results and notation
R(·): range of multifunction
G(·): graph of multifunction
BE: unit ball in E
Φ−1: inverse multifunction
Φ∗: adjoint multifunction
∥· ∥l: lower norm
∥· ∥u: upper norm
§6.1: Generalized derivatives
f −(·; ·): Dini directional derivative
f ◦(·; ·): Clarke directional derivative
f ⋄(·; ·): Michel-Penot directional derivative
∂◦: Clarke subdiﬀerential
∂−: Dini subdiﬀerential
∂⋄: Michel-Penot subdiﬀerential
f ∨g: pointwise maximum of functions
§6.3: Tangent cones
dS: distance function
TS(·): Clarke tangent cone
KS(·): contingent cone
NS(·): Clarke normal cone

List of results and notation
273
[x, y], (x, y): line segments
star: star of a set
PS(·): pseudo-tangent cone
§6.4: The limiting subdiﬀerential
f −(·; ·): Dini directional derivative
∂−: Dini subdiﬀerential
∂a: limiting subdiﬀerential
Na
S(·): limiting normal cone
U(f; x; δ): f-neighbourhood of x.
§7.1: An introduction to metric regularity
h|S: h restricted to S
§7.2: The Karush-Kuhn-Tucker theorem
sgn: sign function
§7.4: Second order conditions
L(E, Y): the linear maps from E to Y
∇2h(¯x): second derivative
∇2h(¯x)(v, v): evaluated second derivative
C(¯x): narrow critical cone

274
List of results and notation
L(·), ¯L(·): Lagrangians
¯C(¯x): broad critical cone
§8.1: Brouwer’s ﬁxed point theorem
γf: contraction constant
C(1): continuously diﬀerentiable
S: unit sphere
Sn: unit sphere in Rn+1
S(U): unit sphere in U
§8.2: Selection results and the Kakutani-Fan ﬁxed point theorem
Gδ: countable intersection of open sets
§8.3: Variational inequalities
V I(Ω, C): variational inequality
§9.1: Euclidean space
X: a real Banach space
X∗: continuous dual space
x∗: a continuous linear functional
B(X): closed unit ball
β, G, H, WH, F: a bornology, Gˆateaux, Hadamard, weak Hadamard, Fr´echet

List of results and notation
275
∂β: bornological subdiﬀerential
∇β: bornological derivative
ℓp(N), c0(N): classical sequence spaces
∥· ∥∗: dual norm

Bibliography
[1] T.M. Apostol. Linear Algebra: a First Course, with Applications. Wi-
ley, New York, 1997.
[2] J.-P. Aubin.
Systems and Control: Foundations and Applications.
Birkh¨auser, Boston, 1991.
[3] J.-P. Aubin and A. Cellina. Diﬀerential Inclusions. Springer-Verlag,
Berlin, 1984.
[4] J.-P. Aubin and H. Frankowska.
Set-Valued Analysis.
Birkh¨auser,
Boston, 1990.
[5] M. Avriel. Nonlinear Programming. Prentice-Hall, Englewood Cliﬀs,
N.J., 1976.
[6] S. Banach.
Sur les op´erations dans les ensembles abstraits et leur
application aux ´equations int´egrales. Fund. Math., 3:133–181, 1922.
[7] H.H. Bauschke, J.M. Borwein, and P. Tseng. Metric regularity, strong
CHIP, and CHIP are distinct properties.
Technical Report CECM
98:112, Simon Fraser University, 1998. Submitted to Journal of Convex
Analysis.
[8] M.S. Bazaraa and C.M. Shetty. Nonlinear Programming. Wiley, New
York, 1979.
[9] R. Bellman.
Introduction to Matrix Analysis.
SIAM, Philadelphia,
1997.
[10] A. Ben-Tal and J. Zowe.
Necessary and suﬃcient conditions for a
class of nonsmooth minimization problems.
Mathematical Program-
ming, 24:70–91, 1982.
276

Bibliography
277
[11] A. Ben-Tal and J. Zowe. A uniﬁed theory of ﬁrst-order and second-
order conditions for extremum problems. Mathematical Programming
Study, 19:39–76, 1982.
[12] C. Berge.
Espaces Topologiques et Fonctions Multivoques.
Dunod,
Paris, 1959.
[13] D.N. Bessis and F.H. Clarke. Partial subdiﬀerentials, derivates and
Rademacher’s Theorem.
Trasactions of the American Mathematical
Society, 1999. To appear.
[14] G. Birkhoﬀ. Tres observaciones sobre el algebra lineal. Universidad
Nacionale Tucam´an Revista, 5:147–151, 1946.
[15] B. Bollob´as. Linear Analysis. Cambridge University Press, Cambridge,
U.K., 1999.
[16] K. Borsuk.
Drei S¨atze ¨uber die n-dimensionale Euklidische Sph¨are.
Fund. Math., 21:177–190, 1933.
[17] D. Borwein, J.M. Borwein, and P. Mar´echal. Surprise maximization.
American Mathematical Monthly, 1999. To appear.
[18] J.M. Borwein. The direct method in semi-inﬁnite programming. Math-
ematical Programming, 21:301–318, 1981.
[19] J.M. Borwein.
Continuity and diﬀerentiability properties of convex
operators. Proceedings of the London Mathematical Society, 44:420–
444, 1982.
[20] J.M. Borwein. Necessary and suﬃcient conditions for quadratic min-
imality. Numerical Functional Analysis and Applications, 5:127–140,
1982.
[21] J.M. Borwein. A note on the existence of subgradients. Mathematical
Programming, 24:225–228, 1982.
[22] J.M. Borwein.
Adjoint process duality.
Mathematics of Operations
Research, 8:403–434, 1983.
[23] J.M. Borwein.
Norm duality for convex processes and applications.
Journal of Optimization Theory and Applications, 48:53–64, 1986.

278
Bibliography
[24] J.M. Borwein. Stability and regular points of inequality systems. Jour-
nal of Optimization Theory and Applications, 48:9–52, 1986.
[25] J.M. Borwein. The linear order-complementarity problem. Mathemat-
ics of Operations Research, 14:534–558, 1989.
[26] J.M. Borwein. Minimal cuscos and subgradients of lipschitz functions.
In J.-B. Baillon and M. Thera, editors, Fixed Point Theory and its Ap-
plications, Pitman Lecture Notes in Mathematics, pages 57–82, Essex,
U.K., 1991. Longman.
[27] J.M. Borwein. A generalization of Young’s lp inequality. Mathematical
Inequalities and Applications, 1:131–136, 1997.
[28] J.M. Borwein. Cones and orderings. Technical report, CECM, Simon
Fraser University, 1998.
[29] J.M. Borwein and S. Fitzpatrick. Characterization of Clarke subgradi-
ents among one-dimensional multifunctions. In Proceedings of the Op-
timization Miniconference II, pages 61–73. University of Balarat Press,
1995.
[30] J.M. Borwein, S.P. Fitzpatrick, and J.R. Giles. The diﬀerentiability
of real functions on normed linear spaces using generalized gradients.
Journal of Optimization Theory and Applications, 128:512–534, 1987.
[31] J.M. Borwein and J.R. Giles. The proximal normal formula in Banach
spaces. Transactions of the American Mathematical Society, 302:371–
381, 1987.
[32] J.M. Borwein and A.S. Lewis. Partially ﬁnite convex programming,
Part I, Duality theory. Mathematical Programming B, 57:15–48, 1992.
[33] J.M. Borwein, A.S. Lewis, and D. Noll. Maximum entropy spectral
analysis using ﬁrst order information. Part I: Fisher information and
convex duality. Mathematics of Operations Research, 21:442–468, 1996.
[34] J.M. Borwein, A.S. Lewis, and R. Nussbaum. Entropy minimization,
DAD problems and doubly-stochastic kernels. Journal of Functional
Analysis, 123:264–307, 1994.

Bibliography
279
[35] J.M. Borwein, A.S. Lewis, J. Read, and Q. Zhu. Convex spectral func-
tions of compact operators. International Journal of Convex and Non-
linear Analysis, 1999. To appear.
[36] J.M. Borwein and H.M. Strojwas. Tangential approximations. Nonlin-
ear Analysis: Theory, Methods and Applications, 9:1347–1366, 1985.
[37] J.M. Borwein and H.M. Strojwas. Proximal analysis and boundaries
of closed sets in Banach space, Part I: theory. Canadian Journal of
Mathematics, 38:431–452, 1986.
[38] J.M. Borwein and H.M. Strojwas. Proximal analysis and boundaries of
closed sets in Banach space, Part II. Canadian Journal of Mathematics,
39:428–472, 1987.
[39] J.M. Borwein and Q. Zhu. A survey of smooth subdiﬀerential calculus
with applications. Nonlinear Analysis: Theory, Methods and Applica-
tions, 1998. To appear.
[40] J.M. Borwein and D. Zhuang. Super-eﬃcient points in vector optimiza-
tion. Transactions of the American Mathematical Society, 338:105–122,
1993.
[41] G. Bouligand. Sur les surfaces d´epourvues de points hyperlimites. An-
nales de la Societ´e Polonaise de Math´ematique, 9:32–41, 1930.
[42] S. Boyd, L. El Ghaoui, E. Feron, and V. Balikrishnan. Linear Matrix
Inequalities in System and Control Theory. SIAM, Philadelphia, 1994.
[43] S. Boyd and L. Vandenberghe. Introduction to convex optimization
with engineering applications. Technical report, Stanford University,
1997.
[44] L.M. Bregman. The method of successive projection for ﬁnding a com-
mon point of convex sets.
Soviet Mathematics Doklady, 6:688–692,
1965.
[45] L.E.J. Brouwer. On continuous one-to-one transformations of surfaces
into themselves.
Proc. Kon. Ned. Ak. V. Wet. Ser. A, 11:788–798,
1909.

280
Bibliography
[46] L.E.J. Brouwer.
Uber Abbildungen vom Mannigfaltigkeiten.
Math.
Ann., 71:97–115, 1912.
[47] F.E. Browder. Nonexpansive nonlinear operators in a Banach space.
Proc. Nat. Acad. Sci. U.S.A., 54:1041–1044, 1965.
[48] C. Carath´eodory. Uber den Variabilet¨atsbereich der Fourier’schen Kon-
stanten von positiven harmonischen Funktionen.
Rend. Circ. Mat.
Palermo, 32:193–217, 1911.
[49] V. Chv´atal. Linear Programming. Freeman, New York, 1983.
[50] F.H. Clarke. Generalized gradients and applications. Transactions of
the American Mathematical Society, 205:247–262, 1975.
[51] F.H. Clarke. Optimization and Nonsmooth Analysis. Wiley, New York,
1983.
[52] F.H. Clarke, Y.S. Ledyaev, R.J. Stern, and P.R. Wolenski. Nonsmooth
Analysis and Control Theory. Springer-Verlag, New York, 1998.
[53] G.B. Dantzig.
Linear Programming and Its Extensions.
Princeton
University Press, Princeton, N.J., 1963.
[54] C. Davis. All convex invariant functions of hermitian matrices. Archiv
der Mathematik, 8:276–278, 1957.
[55] V.F. Dem’yanov and V.M. Malozemov.
Introduction to Minimax.
Dover, New York, 1990.
[56] J.E. Dennis and R.B. Schnabel. Numerical Methods for Unconstrained
Optimization and Nonlinear Equations.
Prentice-Hall, New Jersey,
1983.
[57] J. Diestel. Geometry of Banach Spaces - Selected Topics, volume 485
of Lecture Notes in Mathematics. Springer-Verlag, New York, 1975.
[58] U. Dini. Fondamenti per la teoria delle funzioni di variabili reali. Pisa,
1878.
[59] A. Dontchev. The Graves theorem revisited. Journal of Convex Anal-
ysis, 3:45–54, 1996.

Bibliography
281
[60] J. Dugundji. Topology. Allyn and Bacon, Boston, 1965.
[61] J. Dugundji and A. Granas.
Fixed Point Theory.
Polish Scientiﬁc
Publishers, Warsaw, 1982.
[62] I. Ekeland.
On the variational principle.
Journal of Mathematical
Analysis and Applications, 47:324–353, 1974.
[63] I. Ekeland and R. Temam. Convex Analysis and Variational Problems.
North-Holland, Amsterdam, 1976.
[64] L.C. Evans and R.F. Gariepy. Measure Theory and Fine Properties of
Functions. CRC Press, Boca Raton, Florida, 1992.
[65] K. Fan. On a theorem of Weyl concerning eigenvalues of linear trans-
formations. Proceedings of the National Academy of Sciences of U.S.A.,
35:652–655, 1949.
[66] K. Fan. Fixed point and minimax theorems in locally convex topolog-
ical linear spaces. Proceedings of the National Academy of Sciences of
U.S.A., 38:431–437, 1952.
[67] J. Farkas. Theorie der einfachen Ungleichungen. Journal f¨ur die reine
und angewandte Mathematik, 124:1–27, 1902.
[68] W. Fenchel.
On conjugate convex functions.
Canadian Journal of
Mathematics, 1:73–77, 1949.
[69] L.A. Fern´andez. On the limits of the Lagrange multiplier rule. SIAM
Review, 39:292–297, 1997.
[70] P.A. Fillmore and J.P. Williams. Some convexity theorems for matrices.
Glasgow Mathematical Journal, 12:110–117, 1971.
[71] R. Fletcher. A new variational result for quasi-Newton formulae. SIAM
Journal on Optimization, 1:18–21, 1991.
[72] D. Gale.
A geometric duality theorem with economic applications.
Review of Economic Studies, 34:19–24, 1967.
[73] J.R. Giles. Convex Analysis with Application in the Diﬀerentiation of
Convex Functions. Pitman, Boston, 1982.

282
Bibliography
[74] K. Goebel and W.A. Kirk. Topics in Metric Fixed Point Theory. Cam-
bridge University Press, Cambridge, U.K., 1990.
[75] P. Gordan. Uber die Auﬂ¨osung linearer Gleichungen mit reelen Coef-
ﬁcienten. Mathematische Annalen, 6:23–28, 1873.
[76] L.M. Graves. Some mapping theorems. Duke Mathematical Journal,
17:111–114, 1950.
[77] B. Grone, C.R. Johnson, E. Marques de S´a, and H. Wolkowicz. Positive
deﬁnite completions of partial Hermitian matrices. Linear Algebra and
its Applications, 58:109–124, 1984.
[78] M. Guignard. Generalized Kuhn-Tucker conditions for mathematical
programming in Banach space. SIAM Journal on Control and Opti-
mization, 7:232–241, 1969.
[79] J. Hadamard. R´esolution d’une question relative aux d´eterminants.
Bull. Sci. Math., 2:240–248, 1893.
[80] J. Hadamard. Sur quelques applications de l’indice de Kronecker. In
J. Tannery, Introduction `a la Th´eorie des Fonctions d’une Variable,
volume II. Hermann, Paris, second edition, 1910.
[81] P.R. Halmos. Finite-Dimensional Vector Spaces. Van Nostrand, Prince-
ton, N.J., 1958.
[82] G.H. Hardy, J.E. Littlewood, and G. P´olya. Inequalities. Cambridge
University Press, Cambridge, U.K., 1952.
[83] P.T. Harker and J.-S. Pang. Finite-dimensional variational inequal-
ity and nonlinear complementarity problems: a survey of theory, al-
gorithms and applications.
Mathematical Programming, 48:161–220,
1990.
[84] J.-B. Hiriart-Urruty. A short proof of the variational principle for ap-
proximate solutions of a minimization problem. American Mathemat-
ical Monthly, 90:206–207, 1983.

Bibliography
283
[85] J.-B. Hiriart-Urruty. What conditions are satisﬁed at points minimizing
the maximum of a ﬁnite number of diﬀerentiable functions. In Non-
smooth Optimization: Methods and Applications. Gordan and Breach,
New York, 1992.
[86] J.-B. Hiriart-Urruty and C. Lemar´echal. Convex Analysis and Mini-
mization Algorithms. Springer-Verlag, Berlin, 1993.
[87] R.B. Holmes.
Geometric Functional Analysis and its Applications.
Springer-Verlag, New York, 1975.
[88] R.A. Horn and C. Johnson. Matrix Analysis. Cambridge University
Press, Cambridge, U.K., 1985.
[89] R.A. Horn and C.R. Johnson. Topics in Matrix Analysis. Cambridge
University Press, Cambridge, U.K., 1991.
[90] A.D. Ioﬀe. Regular points of Lipschitz functions. Transactions of the
American Mathematical Society, 251:61–69, 1979.
[91] A.D. Ioﬀe.
Sous-diﬀ´erentielles approch´ees de fonctions num´eriques.
Comtes Rendus de l’Acad´emie des Sciences de Paris, 292:675–678,
1981.
[92] A.D. Ioﬀe. Approximate subdiﬀerentials and applications. I: The ﬁ-
nite dimensional theory. Transactions of the American Mathematical
Society, 281:389–416, 1984.
[93] J. Jahn.
Scalarization in multi objective optimization.
In P. Ser-
aﬁni, editor, Mathematics of Multi Objective Optimization, pages 45–
88. Springer-Verlag, Vienna, 1985.
[94] J. Jahn.
An Introduction to the Theory of Nonlinear Optimization.
Springer-Verlag, Berlin, 1996.
[95] G.J.O. Jameson. Topology and Normed Spaces. Chapman and Hall,
1974.
[96] Fritz John. Extremum problems with inequalities as subsidiary con-
ditions. In Studies and Essays, Courant Anniversary Volume. Inter-
science, New York, 1948.

284
Bibliography
[97] C. Jordan. M´emoire sur les formes bilin´eaires. J. Math. Pures Appl.,
2:35–54, 1874.
[98] S. Kakutani. A generalization of Brouwer’s ﬁxed point theorem. Duke
Mathematical Journal, 8:457–459, 1941.
[99] S. Karlin. Mathematical Methods and Theory in Games, Programming
and Economics. McGraw-Hill, New York, 1960.
[100] W. Karush. Minima of functions of several variables with inequalities
as side conditions. Master’s thesis, University of Chicago, 1939.
[101] W.A. Kirk. A ﬁxed point theorem for nonexpansive mappings which do
not increase distance. American Mathematical Monthly, 72:1004–1006,
1965.
[102] E. Klein and A.C. Thompson. Theory of Correspondences, Including
Applications to Mathematical Economics. Wiley, New York, 1984.
[103] B. Knaster, C. Kuratowski, and S. Mazurkiewicz.
Ein Beweis des
Fixpunktsatzes f¨ur n-dimesionale Simplexe. Fund. Math., 14:132–137,
1929.
[104] D. K¨onig. Theorie der Endlichen und Unendlichen Graphen. Akademis-
che Verlagsgesellschaft, Leipzig, 1936.
[105] A.Y. Kruger and B.S. Mordukhovich. Extremal points and the Euler
equation in nonsmooth optimization. Doklady Akademia Nauk BSSR
(Belorussian Academy of Sciences), 24:684–687, 1980.
[106] H.W. Kuhn and A.W. Tucker. Nonlinear programming. In Proceed-
ings of the Second Berkeley Symposium on Mathematical Statistics and
Probability. University of California Press, Berkeley, 1951.
[107] P. Lax. Change of variables in multiple integrals. American Mathe-
matical Monthly, 106:497–501, 1999.
[108] G. Lebourg. Valeur moyenne pour gradient g´en´eralis´e. Comptes Rendus
de l’Acad´emie des Sciences de Paris, 281:795–797, 1975.
[109] A.S. Lewis. Convex analysis on the Hermitian matrices. SIAM Journal
on Optimization, 6:164–177, 1996.

Bibliography
285
[110] A.S. Lewis. Derivatives of spectral functions. Mathematics of Opera-
tions Research, 6:576–588, 1996.
[111] A.S. Lewis. Group invariance and convex matrix analysis. SIAM Jour-
nal on Matrix Analysis and Applications, 17:927–949, 1996.
[112] A.S. Lewis.
Ill-conditioned convex processes and linear inequalities.
Mathematics of Operations Research, 1999. To appear.
[113] A.S. Lewis. Lidskii’s theorem via nonsmooth analysis. SIAM Journal
on Matrix Analysis, 1999. To appear.
[114] A.S. Lewis.
Nonsmooth analysis of eigenvalues.
Mathematical Pro-
gramming, 84:1–24, 1999.
[115] A.S. Lewis and M.L. Overton. Eigenvalue optimization. Acta Numer-
ica, 5:149–190, 1996.
[116] R. Lipschitz. Lehrbuch der Analysis. Cohen und Sohn, Bonn, 1877.
[117] L.A. Liusternik. On the conditional extrema of functionals. Matem-
aticheskii Sbornik, 41:390–401, 1934.
[118] D.G. Luenberger. Optimization by Vector Space Methods. Wiley, New
York, 1969.
[119] D.G. Luenberger.
Linear and Nonlinear Programming.
Addison-
Wesley, Reading, Ma, 1984.
[120] O.L. Mangasarian and S. Fromovitz. The Fritz John necessary opti-
mality conditions in the presence of equality and inequality constraints.
Journal of Mathematical Analysis and Applications, 17:37–47, 1967.
[121] A.W. Marshall and I. Olkin. Inequalities: Theory of Majorization and
its Applications. Academic Press, New York, 1979.
[122] M. Mati´c, C.E.M. Pearce, and J. Peˇcari´c.
Improvements on some
bounds on entropy measures in information theory. Mathematical In-
equalities and Applications, 1:295–304, 1998.
[123] E.J. McShane. The Lagrange multiplier rule. American Mathematical
Monthly, 80:922–924, 1973.

286
Bibliography
[124] E. Michael. Continuous selections I. Annals of Mathematics, 63:361–
382, 1956.
[125] P. Michel and J.-P. Penot. Calcul sous-diﬀ´erentiel pour les fonctions
lipschitziennes et non lipschitziennes. C. R. Acad. Sci. Paris, 298:269–
272, 1984.
[126] P. Michel and J.-P. Penot. A generalized derivative for calm and stable
functions. Diﬀerential and Integral Equations, 5:433–454, 1992.
[127] J. Milnor. Analytic proofs of the Hairy ball theorem and the Brouwer
ﬁxed point theorem.
American Mathematical Monthly, 85:521–524,
1978.
[128] H. Minkowski. Geometrie der Zahlen. Teubner, Leipzig, 1910.
[129] H. Minkowski. Theorie der konvexen K¨orper, insbesondere Begr¨undung
ihres Oberﬂ¨achenbegriﬀs. In Gesammelte Abhandlungen II. Chelsea,
New York, 1967.
[130] B.S. Mordukhovich. Maximum principle in the problem of time optimal
response with nonsmooth constraints. Journal of Applied Mathematics
and Mechanics, 40:960–969, 1976.
[131] B.S. Mordukhovich. Nonsmooth analysis with nonconvex generalized
diﬀerentials and adjoint mappings.
Doklady Akademia Nauk BSSR,
28:976–979, 1984.
[132] B.S. Mordukhovich.
Complete characterization of openness, metric
regularity, and Lipschitzian properties of multifunctions. Transactions
of the American Mathematical Society, 340:1–35, 1993.
[133] J.-J. Moreau.
Sur la fonction polaire d’une fonction semi-continue
sup´erieurement. C. R. Acad. Sci. Paris, 258:1128–1130, 1964.
[134] J. Nash. Non-cooperative games. Ann. of Math., 54:286–295, 1951.
[135] Y. Nesterov and A. Nemirovskii. Interior-Point Polynomial Algorithms
in Convex Programming. SIAM Publications, Philadelphia, 1994.
[136] G.K. Pedersen. Analysis Now. Springer-Verlag, New York, 1989.

Bibliography
287
[137] A.L. Peressini. Ordered Topological Vector Spaces. Harper and Row,
New York, 1967.
[138] A.L. Peressini, F.E. Sullivan, and J.J. Uhl. The Mathematics of Non-
linear Programming. Springer, New York, 1988.
[139] R.R. Phelps. Convex Functions, Monotone Operators and Diﬀerentia-
bility, volume 1364 of Lecture Notes in Mathematics. Springer-Verlag,
New York, 1989.
[140] B.H. Pourciau.
Modern multiplier rules.
American Mathematical
Monthly, 87:433–452, 1980.
[141] B. Pshenichnii. Necessary Conditions for an Extremum. Dekker, New
York, 1971.
[142] J. Renegar. Linear programming, complexity theory and elementary
functional analysis. Mathematical Programming, 70:279–351, 1995.
[143] S.M. Robinson. Normed convex processes. Transactions of the Ameri-
can Mathematical Society, 174:127–140, 1972.
[144] S.M. Robinson. Regularity and stability for convex multivalued func-
tions. Mathematics of Operations Research, 1:130–143, 1976.
[145] S.M. Robinson. Stability theory for systems of inequalities, part II:
diﬀerentiable nonlinear systems. SIAM Journal on Numerical Analysis,
13:497–513, 1976.
[146] S.M. Robinson. Normal maps induced by linear transformations. Math-
ematics of Operations Research, 17:691–714, 1992.
[147] R.T. Rockafellar. Level sets and continuity of conjugate convex func-
tions. Transactions of the American Mathematical Society, 123:46–63,
1966.
[148] R.T. Rockafellar. Monotone Processes of Convex and Concave Type,
volume Memoir No. 77. American Mathematical Society, 1967.
[149] R.T. Rockafellar. Convex Analysis. Princeton University Press, Prince-
ton, N.J., 1970.

288
Bibliography
[150] R.T. Rockafellar and R.J.-B. Wets. Variational Analysis. Springer,
Berlin, 1998.
[151] H.L. Royden. Real Analysis. Macmillan, New York, 1988.
[152] M. Slater. Lagrange multipliers revisited: a contribution to non-linear
programming. Technical Report Discussion Paper Math. 403, Cowles
Commission, 1950.
[153] D.R. Smart. Fixed Point Theorems. Cambridge University Press, Lon-
don, 1974.
[154] R.J. Stern and H. Wolkowicz. Indeﬁnite trust region subproblems and
nonsymmetric eigenvalue perturbations. SIAM Journal on Optimiza-
tion, 5:286–313, 1995.
[155] R.E. Steuer. Multiple Criteria Optimization: Theory, Computation and
Application. Wiley, New York, 1986.
[156] K.R. Stromberg. An Introduction to Classical Real Analysis. Wads-
worth, Belmont, CA, 1981.
[157] F.E. Su. Borsuk-Ulam implies Brouwer: a direct construction. Ameri-
can Mathematical Monthly, 109:855–859, 1997.
[158] C. Swartz. An Introduction to Functional Analysis. Marcel Dekker,
New York, 1992.
[159] C.M. Theobald. An inequality for the trace of the product of two sym-
metric matrices.
Mathematical Proceedings of the Cambridge Philo-
sophical Society, 77:265–266, 1975.
[160] J. Van Tiel. Convex Analysis: an Introductory Text. Wiley, New York,
1984.
[161] H. Uzawa. The Kuhn-Tucker Theorem in concave programming. In
L. Hurwicz K.J. Arrow and H. Uzawa, editors, Studies in Linear and
Nonlinear Programming. Stanford University Press, Stanford, 1958.
[162] L. Vandenberghe, S. Boyd, and S.-P. Wu. Determinant maximization
with linear matrix inequality constraints.
SIAM Journal on Matrix
Analysis and Applications, 19:499–533, 1998.

Bibliography
289
[163] J. von Neumann. Some matrix inequalities and metrization of matric-
space. Tomsk University Review, 1:286–300, 1937. In: Collected Works,
Pergamon, Oxford, 1962, Volume IV, 205-218.
[164] J. von Neumann and O. Morgenstern. The Theory of Games and Eco-
nomic Behaviour. Princeton University Press, Princeton, N.J., 1948.
[165] H. Weyl. Elementare Theorie der konvexen Polyeder. Commentarii
Math. Helvetici, 7:290–306, 1935.
[166] S.J. Wright. Primal-Dual Interior-Point Methods. SIAM, Philadelphia,
1997.
[167] K. Yosida. Functional Analysis. Springer-Verlag, Berlin, 1995.
[168] E. Zeidler.
Nonlinear Functional Analysis and its Applications I.
Springer-Verlag, New York, 1986.

Index
absorbing set, 243
abstract linear program, 127, 129
Accessibility lemma, 14, 98
active
constraint, 38
set, 37, 114, 147, 184, 202
adjoint, 9, 20 etc
process, 133–141
aﬃne
combination, 14
function, 9, 231
conjugate, 94
hull, 14
minorant, see minorant
set, 14
normals to, 26
almost homogeneous, 95
analytic centre, 74
approximate
minimizer, see variational prin-
ciple
selection, 217–219
arithmetic-geometric mean, 12, 19
attainment, see also existence
and lower semicontinuity, 249
dual, 105
in best approximation, see dis-
tance function
in Fenchel problems, 63
in LP and SDP, 126–131
primal, 105
quadratic program, 201, 232
Baire
category theorem, 226, 244
space, 239
ball, 7
Banach
contraction principle, 204–213
in metric space, 251
space, 238–251
barreled, 239, 243
base, see cone, base for
Basic separation theorem, see sep-
aration, Basic
Bauschke, Heinz, 6
Bayes conditional probability rule,
102
best approx., see nearest point
BFGS update, 29, 74
biconjugate, see Fenchel biconju-
gate
of process, 138
bipolar
cone, see cone
set, 80, 83, 136
Birkhoﬀ’s theorem, 18, 20, 89
Bishop-Phelps theorem, 249, 251
Boltzmann-Shannon entropy, 66,
245
Bolzano
290

Index
291
-Poincar´e-Miranda thm, 234
-Weierstrass theorem, 9, 10,
249
bornology, 239
Borsuk, 207
-Ulam theorem, 213–215
Borwein-Preiss variational princi-
ple, 251
Bose-Einstein entropy, 66
Bouligand, 161
boundary, 8
properties, 163, 241
bounded, 9 etc
convex functions, 241
level set, see level set
process, 136–142
set of multipliers, 187
subdiﬀerential map, 242
Bregman distance, 49
broad critical cone, 199–203
Brouwer, 207
ﬁxed point theorem, 93, 204–
219, 234
in Banach space, 251
Browder
-Kirk theorem, 208
Brønsted-Rockafellar theorem, 251
calculus of variations, 6
Carath´eodory’s theorem, 33, 89
Cartesian product, 7 etc
tangent cone to, 162
Cauchy-Schwarz inequality, 7, 17,
19, 75
and steepest descent, 40
Cellina approximate selection the-
orem, 217–219, 251
central path, 129
for LP, 130
for SDP, 131
chain rule, 62, 173, 191
change of variable theorem, 205–
209
Chi, Lily, see Hedgehog
Clarke
directional derivative, 144–166
normal cone, 160
calculus, 182
versus limiting, 196
subdiﬀerential, 144–175
and generic diﬀerentiability,
224
as a cusco, 216, 220
intrinsic, 154–157, 167, 172
of composition, 173
of sum, see nonsmooth calcu-
lus
subgradient, 144
unique, 153–155
tangent cone, 158–162, 196
and metric regularity, 193
and transversality, 181–182
closed
function, see lower semicontin-
uous
graph theorem, 137, 250
images, 220
level set, 90
multifunction, see multi-
function
range, 240
set, 8 etc
subdiﬀerential, see subdiﬀer-
ential
subspace, 240
closure

292
Index
of a function, 92
of a set, 8
codimension
countable, 244
ﬁnite, 247
coercive, 28
multifunction, 229, 235
coﬁnite, 97
compact, 9 etc
and Ekeland principle, 180
convex hull of, 33
convex sets, 81
countably, 249
general deﬁnition, 212, 217
images, 220, 221
in inﬁnite dimensions, 238
level sets, see level set
operator, 250
polyhedron, 115
range of multifunction, 220
unit ball, 240
weakly, see weakly compact
compactly epi-Lipschitz, 249
complement, orthogonal, 10
complementarity
problem, 229–237
semideﬁnite, see semideﬁnite
complementary slackness, 37, 54,
56, 131
in cone programming, 130
complemented subspace, 238
complete, 208, 239, 244
and Ekeland’s principle, 251
composing
convex functions, 13
USC multifunctions, 220, 227
concave
conjugate, 74
function, 42
condition number, 141, 142
cone, 8, 16 etc
and processes, 132
base for, 72
compact, 95, 140, 163
bipolar, 64, 65, 70, 80, 90, 127,
133, 160
contingent, see contingent cone
critical, see critical cone
dual, 35
ﬁnitely generated, see ﬁnitely
generated cone
generating, 139
inﬁnite dimensional, 250
lattice, 16
nonnegative, 245
normal, see normal cone
normality of, 139
open mapping theorem, 100
pointed, 65, 72, 86, 101, 115,
139, 163
polar, 5, 64, 65, 80, 83, 184
of sum and intersection, 70
polyhedral, see polyhedral
program, 127–131, 133, 134
pseudo-tangent, 164
recession, 11, 12, 73, 98, 165
self-dual, see self-dual cone
semideﬁnite, see semideﬁnite
cone
sums, 70, 246
support function of, 67
tangent, see tangent cone
variational inequality over, 229
conical absorption, 85
conjugate, see Fenchel conjugate
connected, 206, 209

Index
293
constraint
active, 38
equality, 37, 176, 184
error, 193
function, 37
inequality, 22–41, 184
convex, 54
in inﬁnite dimensions, 249
linear, 23, 26, 29, 62, 64, 74,
126, 187
in inﬁnite dimensions, 247
qualiﬁcation, 38, 227
equivalence of Slater and
Mangasarian et al., 56
in cone programming, 134
inﬁnite-dimensional, 251
linear independence, 38, 184,
186, 202
Mangasarian. . . , 38–41, 147,
184–190
Slater, 55–59, 105, 107, 126,
127, 187, 194
contingent
cone, 159–166, 176–187
to feasible region, 184, 185
necessary condition, 161, 181,
184, 186
suﬃciency, 165
continuity, 9 etc
and bounded level sets, 92
and maximality, 225
and USC, 219
generic, 226
in inﬁnite dimensions, 238–251
of convex functions, 62, 78–82,
90, 240
failure, 99
univariate, 98
of extensions, 223
of linear functionals, 240
of multifunctions, 132
of partial derivatives, 153
of projection, 27, 228
of selections, 217–226
continuously diﬀerentiable, see dif-
ferentiable
contour, 97
contraction, 204
Banach space, 251
non-uniform, 208
control theory, 5, 129
convergent subsequence, 9 etc
convex
analysis, 5–6
inﬁnite-dimensional, 82, 250
polyhedral, 113
calculus, 62, 64, 67, 160
failure, 68
combination, 8, 12 etc
constraint, 54 etc
function, 11, 42, 55 etc
bounded, 241
characterizations, 47
composition, 13
conditions for minimizer, 23
continuity of, see continuity
critical points of, 23, 42
diﬀerence of, 69, 125
diﬀerentiability of, 46
directional derivative, 23
examples, 48
extended-valued, 42, 55, 58
etc
Hessian characterization, see
Hessian
of matrices, 50

294
Index
on Banach space, 249
recognizing, 46, 48
regularity, 152, 160
symmetric, 35
growth conditions, 13
hull, 8, 11 etc
and exposed points, 250
and extreme points, 81
and Gordan’s theorem, 30
of limiting subdiﬀ., 167, 172
image, 216–226
log-, 51
midpoint, 94
multifunction, 132, 133
order-, see order-convex
process, see process
program, 54–60, 62 etc
duality, 103
Schur-, 32, 35, 47, 125, 157
set, 8 etc
spectral function, see spectral
function
strictly, see strictly convex
subdiﬀerential, 152 etc
and limiting, 167
convexity, see convex
and continuity, see continuity
and diﬀerentiability, 22
and monotonicity, 149
in linear spaces, 250
in optimization, 42 etc
core, 43
in inﬁnite dimensions, 244
versus interior, 47, 80
cost function, 231
countable basis, 244
countable codimension, 244
countably compact, 249
cover, 217, 249
critical cone
broad, 199–203
narrow, 197–203
critical point, 23
approximate, 25
unique, 26
curvature, 197
cusco, 216–235
DAD problems, 52, 74
Davis theorem, 121, 122, 123, 125
DC function, see convex function,
diﬀerence of
dense
hyperplane, 244
range, 246, 248
subspace, 246
derivative, see diﬀerentiability
directional, see directional de-
rivative
Fr´echet, see Fr´echet
Gˆateaux, see diﬀerentiability
generalized, 143
Hadamard, see Hadamard
strict, see strict
weak Hadamard, see weak Ha-
damard
determinant, 17, 188, 205, 209
order preservation, 123
Deville-Godefroy-Zizler variational
principle, 251
diﬀerentiability
and pseudo-convexity, 165
bornological, 239
continuous, 153–156, 181, 182,
189
approximation by, 205

Index
295
Fr´echet, see Fr´echet
Gˆateaux, 22, 36, 73, 151–157,
160, 240–245
generic, 224, 226
of convex functions, 46, 97
of distance function, 69
of Lipschitz functions, 154
of spectral functions, 121
strict, see strict
twice, 197–202
diﬀerential inclusion, 250
dimension, 81
inﬁnite, see inﬁnite dimensions
Dini
calculus, failure, 148
derivative, 148
directional derivative, 167, 170
and contingent cone, 159
continuity, 148, 168
Lipschitz case, 143, 150, 152
subdiﬀerential, 144, 145, 150,
152, 167
of distance function, 195
surjective, 148
subgradient, 144, 168, 171
exist densely, 157, 167, 172
Dirac, see Fermi-Dirac
directional derivative, 22, 23, 73
and subgradients, 45, 143
and tangent cone, 159
Clarke, see Clarke
Dini, see Dini
Michel-Penot, see Michel-
Penot
of convex function, 43–53
of max-functions, 36, 42, 48
sublinear, 43, 143, 144, 159
disjoint operator ranges, 248
distance
Bregman, 49
from feasibility, 193
function, 69, 155, 158–166
attainment, 241, 243, 249
diﬀerentiability, 240
directional derivative, 166
regularity, 159, 246
subdiﬀerentials, 195
to level set, 196
to inconsistency, 137, 141
divergence bounds, 75
domain
of convex function, 42, 55, 78
of multifunction, 132
of subdiﬀerential, 44
not convex, 50
polyhedral, 114
doubly stochastic, 17, 20, 89
pattern, 52
Dowker, 223
dual
attainment, see attainment
cone, 35
function, 103
linear program, 126, 230
problem, 103
examples, 107
solution, 97, 104, 105
space, 238
value, 63, 103–112
in LP and SDP, 126–131
duality, 5, 9, 90 etc
cone program, see cone
program
duality-based algorithms, 5
Fenchel, see Fenchel duality
gap, 103–112

296
Index
Duﬃn’s, 58, 108
in LP and SDP, 127–131, 230
geometric programming, 119
in convex programming, 103
inﬁnite-dimensional, 106, 249
Lagrangian, see Lagrangian
LP, 5, 32, 126–131, 230
nonconvex, 109
norm, 136
process, 132–142
quadratic programming, 232
SDP, 5, 126–131
strict-smooth, see strict-
smooth duality
weak
cone program, 126, 127
Fenchel, 63–64, 117
Lagrangian, 103, 106
Duﬃn’s duality gap, see duality
eﬃcient, 231
eigenvalues, 16
derivatives of, 157
functions of, see spectral func-
tion
isotonicity of, 157
largest, 187
of operators, 250
optimization of, 122
subdiﬀerentials of, 157
sums of, 125
eigenvector, 26, 187
Einstein, see Bose-Einstein
Ekeland variational principle, 25,
177–181, 204
in metric space, 251
entropy
Boltzmann-Shannon, 66
Bose-Einstein, 66
Fermi-Dirac, 66
maximum, 51, 67, 74
and DAD problems, 52
and expected surprise, 102
epi-Lipschitz-like, 249
epigraph, 55 etc
as multifunction graph, 220
closed, 90, 96
normal cone to, 59
polyhedral, 113
regularity, 246
support function of, 67
equilibrium, 219
equivalent norm, see norm
essentially smooth, 46, 89, 95
conjugate, 92, 97
log barriers, 62
minimizers, 50
spectral functions, 122
essentially strictly convex, see str-
ictly convex
Euclidean space, 7–16, 238
subspace of, 31
exact penalization, see penaliz-
ation
existence (of optimal solution), 10,
94, 105 etc
expected surprise, 101
exposed point, 87
strongly, 250
extended-valued, 167
convex functions, see convex
function
extension
continuous, 223
extreme point, 81
existence of, 87

Index
297
of polyhedron, 114
set not closed, 87
versus exposed point, 87
Fan
-Kakutani ﬁxed point theorem,
216–228, 231
inequality, 17–21, 120, 121
minimax inequality, 233
theorem, 17, 21
Farkas lemma, 30–32, 127, 184
and ﬁrst order conditions, 30
and linear programming, 126
feasible
in order complementarity, 233
region, 37, 184
solution, 37, 54, 127
Fenchel, 66
-Young inequality, 62, 63, 86,
121
biconjugate, 61, 67, 90–99, 116,
121, 123, 146
and duality, 104
conjugate, 30, 61–75
and duality, 103
and eigenvalues, 120
and subgradients, 62
examples, 76
of aﬃne function, 94
of composition, 109
of exponential, 61, 67, 74, 75
of indicator function, 66
of quadratics, 66
of value function, 104
self-, 66
strict-smooth duality, see
strict-smooth duality
transformations, 77
duality, 62–75, 88, 91, 96, 119
and complementarity, 232
and LP, 127–131
and minimax, 228
and relative interior, 88
and second order conditions,
199
and strict separation, 84
generalized, 119
in inﬁnite dimensions, 238,
249, 250
linear constraints, 64, 74, 85,
117
polyhedral, 116, 117
symmetric, 74
versus Lagrangian, 108
problem, see Fenchel duality
Fermi-Dirac entropy, 66
Fillmore-Williams theorem, 124
ﬁnite codimension, 247
ﬁnite dimensions, 238–251
ﬁnitely generated
cone, 32, 33, 113–116
function, 113–118
set, 113–118
ﬁrst order condition(s)
and max-functions, 36–41
and the Farkas lemma, 30
Fritz John, see Fritz John
in inﬁnite dimensions, 249
Karush-Kuhn-Tucker, see Kar-
ush-Kuhn-Tucker
linear constraints, 23, 26, 29,
52
necessary, 22, 23, 37, 160, 184,
199, 200
suﬃcient, 23
Fisher information, 93, 98, 102

298
Index
ﬁxed point, 204–228
in inﬁnite dimensions, 251
methods, 231
property, 209
theorem
of Brouwer, see Brouwer
of Kakutani-Fan, see Kakut-
ani-Fan
Fourier identiﬁcation, 246
Fr´echet derivative, 153–156, 176
and contingent necessary con-
dition, 161, 180
and inversion, 210–211
and multipliers, 188
and subderivatives, 175
in constraint qualiﬁcation, 184
in inﬁnite dimensions, 240–250
Fritz John conditions, 37–39, 152,
190
and Gordan’s theorem, 38
nonsmooth, 147
second order, 201
functional analysis, 238, 249
furthest point, 87
fuzzy sum rule, 168, 171, 172
Gˆateaux
derivative, see derivative
diﬀerentiable, see diﬀerentia-
bility
Gamma function, 51
gauge function, 80, 85, 209
Gδ, 217, 224
generalized derivative, 143
generated cuscos, 223
generating cone, 139
generic, 217
continuity, 226
diﬀerentiability, 224, 226
single-valued, 226
geometric programming, 117, 119
global minimizer, see minimizer
Godefroy, see Deville-Godefroy-Zi-
zler
Gordan’s theorem, 30–35
and Fritz John conditions, 38
graph, 132, 216
minimal, 224
normal cone to, 172
of subdiﬀerential, 167
Graves, 180
Grossberg, see Krein-Grossberg
Grothendieck space, 242
growth condition, 11, 28
coﬁnite, 97
convex, 13
multifunction, 229, 236
Guignard
normal cone calculus, 182
optimality conditions, 189, 203
Haberer, Guillaume, 6
Hadamard, 207
derivative, 240–250
inequality, 60, 188
Hahn
-Banach extension, 66, 70
geometric version, 249
-Katetov-Dowker sandwich th-
eorem, 223
Hairy ball theorem, 212–213
halfspace
closed, 9, 32 etc
in inﬁnite dimensions, 247
open, 30, 32
support function of, 66

Index
299
Halmos, 6
Hardy et al. inequality, 17–19
Hedgehog theorem, 213
hemicontinuous, 225
Hessian, 24, 197–202
and convexity, 46, 48, 50
higher order optimality conditions,
201
Hilbert space, 238
and nearest points, 249
Hiriart-Urruty, 5, 32
H¨older’s inequality, 40, 51, 85
homeomorphism, 207, 209
homogenized
linear system, 126
process, 139
hypermaximal, 225, 235, 236
hyperplane, 9, 32 etc
dense, 244
separating, see separation
supporting, 81, 141, 239–250
identity matrix, 16
improper polyhedral function, 118
incomplete, 239
inconsistent, 37, 129
distance to, 141
indicator function, 42, 80, 158
limiting subdiﬀerential of, 168
subdiﬀerential of, 47
inequality constraint, see constrai-
nt
inﬁmal convolution, 68, 158, 181
inﬁmum, 10 etc
inﬁnite-dim, 6, 93, 180, 238–251
interior, 8 etc
relative, see relative interior
tangent characterization, 196
versus core, see core
interior point methods, 5, 66, 93,
106, 186
inverse
boundedness, 139
function theorem, 182, 210
image, 9, 116
Jacobian, 205
multifunction, 132–142
Ioﬀe, 171
isometric, 100, 101
isotone, 13, 233
contingent cone, 162
eigenvalues, 157
tangent cone, 165
James theorem, 243, 250
Jordan’s theorem, 188
Josephson-Nissenzweig
sequence, 243
thm, 242
Kakutani
-Fan ﬁxed point theorem, 216–
228, 231
minimax theorem, 112, 234
Karush-Kuhn-Tucker
theorem, 38–41, 151, 184
convex case, 54–56, 153
inﬁnite-dimensional, 251
nonsmooth, 147
vector, 58, 109
Katetov, 223
Kirchhoﬀ’s law, 28
Kirk, see Browder-Kirk
Knaster-Kuratowski-Mazurkie-
wicz principle, 211, 233
K¨onig, 18

300
Index
Krein
-Grossberg theorem, 139
-Rutman theorem, 65, 182
Kruger, 171
Kuhn, see Karush-Kuhn-Tucker
Lagrange multiplier, 24, 37–41, 186
and second order conditions,
198–202
and subgradients, 55
bounded set, 187
convex case, 54–59
in inﬁnite dimensions, 249
nonexistence, 58, 188, 211
Lagrangian, 37, 198–202
convex, 54, 103
duality, 103–112, 119
inﬁnite-dimensional, 250
linear programming, 126
necessary conditions, see nec-
essary conditions
suﬃcient cdns, 54–60, 124
Lambert W-function, 69
lattice
cone, 16
ordering, 18, 230
Legendre, 66
Lemar´echal, Claude, 5, 6
level set, 9, 20
bounded, 10, 11, 13, 82, 92, 97
closed, 90
compact, 28, 52, 62, 111, 177
of Lagrangian, 105, 106
distance to, 194
normal cone to, 59, 196
Ley, Olivier, 6
limit (of sequence of points), 8
limiting
mean value theorem, 174
normal cone, see normal cone
subdiﬀerential, 167–175
and regularity, 191–196
of composition, 173
of distance function, 195
sum rule, see nonsmooth cal-
culus
line segment, 8, 163
lineality space, 43
linear
constraint, see constraint
functional
continuous, 240
discontinuous, 249
inequality constraints, 74
map, 9 etc
as process, 138
objective, 126
operator, 250
programming, 5, 66, 107
abstract, 127, 129, 230
and Fenchel duality, 127–131
and processes, 132
and variational inequalities,
230
duality, see duality, LP
penalized, 106, 130, 186
primal problem, 126
space, 250
span, 8
subspace, 8
Linear independence qualiﬁcation,
see constraint qualiﬁcation
linearization, 176
Lipschitz, 78, 79, 82, 143–175, 179,
209
bornological derivatives, 240

Index
301
eigenvalues, 125, 157
extension, 181
generic diﬀerentiability, 224
non-, 147
perturbation, 251
Liusternik, 180
theorem, 179, 182, 184
via inverse functions, 182
local minimizer, 22–26, 37 etc
strict, 200
localization, 139
locally bounded, 78, 79, 82, 92,
216, 220, 223–225
locally Lipschitz, see Lipschitz
Loewner ordering, 16
log, 12, 20, 61, 66, 74, 107, 120
log barrier, see log, log det
log det, 20, 22, 28, 29, 40, 41, 47,
50, 57, 60, 61, 66, 82, 108,
120–123
log-convex, 51
logarithmic homogeneity, 93, 97
lower semicontinuous, 46, 90–96,
118
and attainment, 249
and USC, 220
approximate minimizers, 176
calculus, 168–171
generic continuity, 226
in inﬁnite dimensions, 238
multifunction, 132
sandwich theorem, 223
value function, 104, 105, 111
LP, see linear programming
LSC (multifn), 132–138, 216, 219–
223, 232
Lucet, Yves, 6
Mangasarian-Fromowitz qualiﬁcat-
ion, see constraint qualiﬁ-
cation
mathematical economics, 6, 137,
219
matrix, see also eigenvalues
analysis, 120
completion, 28, 50
optimization, 126
Max formula, 45–53, 63, 73, 135,
144
and Lagrangian necessary con-
ditions, 56
nonsmooth, 145, 146, 160
relativizing, 53, 89
max-function(s)
and ﬁrst order conditions, 36–
41
directional derivative of, 36
subdiﬀerential of, 59, 71, 145
Clarke, 149, 174
limiting, 174, 196
maximal monotonicity, 216–237
maximizer, 5, 10 etc
maximum entropy, see entropy
Mazurkiewicz, see Knaster-Kura-
towski-Mazurkiewicz
mean value theorem, 149, 157
inﬁnite-dimensional, 250
limiting, 174
metric regularity, 5, 176–183, 209,
210
and second order conditions,
197–198
and subdiﬀerentials, 191–196
in Banach space, 251
in inﬁnite dimensions, 238
weak, 177–181

302
Index
metric space, 251
Michael selection theorem, 219–
223, 232
inﬁnite dimensional, 251
Michel-Penot
directional derivative, 144–166
subdiﬀerential, 144–156
subgradient, 144
unique, 151, 153
midpoint convex, 94
minimal
graph, 224
solution in order complemen-
tarity, 233
minimax
convex-concave, 110
Fan’s inequality, 233
Kakutani’s theorem, see Kaku-
tani
von Neumann’s theorem, see
von Neumann
minimizer, 5, 10 etc
and diﬀerentiability, 22
and exact penalization, 158
approximate, 176
existence, see existence
global, 10, 23, 42 etc
local, 22–26, 37 etc
nonexistence, 25
of essentially smooth functions,
50
strict, 200
subdiﬀerential zeroes, 44, 143
minimum volume ellipsoid, 41, 50,
60
Minkowski, 11, 117
theorem, 81, 87, 115, 207
converse, 87
in inﬁnite dimensions, 250
minorant, 90
aﬃne, 90, 93, 99, 117
closed, 92
Miranda, see Bolzano-Poincar´e-M-
iranda
monotonicity
and convexity, 149
maximal, 216–237
multifunction, 216–237
of complementarity problems,
230, 232
of gradients, 50
Mordukhovich, 171, 194
Moreau, 66
-Rockafellar thm, 92–98, 250
multi objective optimization, see
optimization, vector
multifunction, 5, 132–142, 216–237
closed, 95
and maximal monotone, 225
versus USC, 220
subdiﬀerential, 44
multiplier, see Lagrange multiplier
multivalued
complementarity problem, 229
variational inequality, 227
narrow critical cone, 197–203
Nash equilibrium, 231, 234
nearest point, 27, 31, 69, 208, 215
and subdiﬀerentials, 195
and variational ineqs, 227
in epigraph, 157
in inﬁnite dimensions, 238, 249
in polyhedron, 74
selection, 220, 226
necessary condition(s), 145, 160

Index
303
and subdiﬀerentials, 143
and suﬃcient, 201
and variational ineqs, 227
contingent, see contingent
ﬁrst order, see ﬁrst order con-
dition(s), necessary
Fritz John, see Fritz John
Guignard, 189, 203
higher order, 201
Karush-Kuhn-Tucker, see Kar-
ush-Kuhn-Tucker
Lagrange, 55–58, 61, 105, 151,
153
nonsmooth, 146, 151, 160, 167,
171, 174
limiting and Clarke, 196
second order, 198
stronger, 147, 167
neighbourhood, 8
Newton-type methods, 197
Nikod´ym, see Radon-Nikod´ym
Nissenzweig, see Josephson-Niss-
enzweig
noncompact variational inequality,
229
nondiﬀerentiable, 25, 42 etc
nonempty images, 132, 137
nonexpansive, 205, 208
in Banach space, 251
nonlinear
equation, 204
program, 184, 203
nonnegative cone, 245
nonsmooth
analysis, 5 etc
and metric regularity, 180
inﬁnite-dimensional, 171
Lipschitz, 158
calculus, 145, 149, 160, 179
and regularity, 155
equality in, 152
failure, 167, 172
fuzzy, 168
inﬁnite-dimensional, 250
limiting, 167, 170–174, 192,
195
mixed, 155
normed function, 191
max formulae, see max formula
necessary conditions, see nec-
essary condition(s)
optimization, see optimization
regularity, see regular
norm, 7
-preserving, 17, 19
attaining, 239, 243, 245
equivalent, 80, 83, 218
of linear map, 136
of process, 135–142
smooth, 214
strictly convex, 249
subgradients of, 47
topology, 241–242
norm attaining, 249, 250
normal cone, 22, 23, 26
and polarity, 64
and relative interior, 88
and subgradients, 47, 68
and tangent cone, 65
Clarke, see Clarke
examples, 26
limiting, 168, 192–196
and subdiﬀerential, 172
to epigraph, 59
to graphs, 172
to intersection, 68, 101

304
Index
to level sets, 59
normal mapping, 227, 231
normal problem, 106
normal vector, 22
normed space, 239, 243
null space, 9, 134, 135
objective function, 37, 38 etc
linear, 126
one-sided approximation, 44
open, 8
functions and regularity, 195,
209
mapping theorem, 84, 96, 117,
128, 139
for cones, 100
for processes, 136
in Banach space, 250
in inﬁnite dimensions, 238
multifunction, 132–140
operator
linear, 250
optimal
control, 6
solution, 10 etc
value, 62, 63, 103–112, 116,
117, 199
function, see value function
in LP and SDP, 126–131, 230
optimality conditions, 5, 22–29
and the Farkas lemma, 31
and variational ineqs, 227
ﬁrst order, see ﬁrst order con-
ditions
higher order, 201
in Fenchel problems, 68, 97
necessary, see necessary condi-
tion(s)
nonsmooth, 143
second order, see second order
conditions
suﬃcient, see suﬃcient condi-
tion(s)
optimization, 5, 10 etc
and calculus, 23
and convexity, 42
and nonlinear equations, 204
computational, 5, 186, 197
duality in, 90, 103
inﬁnite-dimensional, 6, 93, 180
linear, 126
matrix, 126
multi-criteria, 66
nonsmooth, 36, 42, 143–175
inﬁnite-dimensional, 250
one-sided approximation, 44
problem, 10, 37 etc
subgradients in, 44, 143
vector, 86, 161, 163
order
-convex, 71–74, 86, 94, 125
-reversing, 61
-sublinear, 71–74, 125, 140
-theoretic ﬁxed point results,
204
complementarity, 230–233
epigraph, 140
inﬁmum, 72
interval, 139
preservation, 18, 86
of determinant, 123
statistic, 150
regularity, 157
subdiﬀerential, 175
subgradients, 66, 72–74
ordered spectral decomposition, 17

Index
305
ordering, 16
lattice, 18
orthogonal
complement, 10
invariance, 124
matrix, 17, 208
projection, 33
similarity transformation, 124
to subspace, 31
orthonormal basis, 188
p-norm, 40, 85
paracompact, 251
Pareto minimization, 86, 231
proper, 163
partition of unity, 217–222, 236
penalization, 106, 130, 186
exact, 158–161, 179, 182, 192
quadratic, 189
Penot, see Michel-Penot
permutation
matrix, 17, 35, 89, 124
perturbation, 54, 62 etc
Phelps, see Bishop-Phelps
piecewise linear, 210
Poincar´e, see Bolzano-Poincar´e-M-
iranda
pointed, see cone
pointwise maximum, 94
polar
calculus, 84, 135
concave, 100
cone, see cone
set, 80, 83–84
polyhedral
algebra, 116–118, 135
calculus, 117
complementarity problem, 232
cone, 115, 119, 128, 131, 185
Fenchel duality, 116
function, 113–119
multifunction, 132
problem, 126, 127
process, 134, 135
quasi-, 201
set, see polyhedron
variational inequality, 231
polyhedron, 9, 16, 18, 70, 113–119
compact, 115
in vector optimization, 163
inﬁnite-dimensional, 247
nearest point in, 74
tangent cone to, 118
polynomial
nearest, 29
polytope, 67, 113–115
in inﬁnite dimensions, 247
positive (semi)deﬁnite, 16 etc
positively homogeneous, 43
Preiss, see Borwein-Preiss
primal
linear program, 126
problem, 103
recovering solutions, 96
semideﬁnite program, 128
value, see optimal value
process, 132–142, 250
product, see Cartesian product
projection, see also nearest point
onto subspace, 31
orthogonal, 33
relaxed, 208
proper
function, 42, 55, 91, 114, 135
Pareto minimization, 163
point, 164

306
Index
pseudo-convex
function, 165
set, 164, 165
Pshenichnii-Rockafellar
conditions, 70
quadratic
approximation, 197–200
conjugate of, 66
path, 198
penalization, 189
program, 107, 201, 232
quasi relative interior, 243, 249
quasi-concave, 233
quasi-polyhedral, 201
quotient space, 247
Rademacher’s theorem, 154, 155,
224
Radon-Nikod´ym property, 250
Radstrom cancellation, 12
range
closed, 240
dense, see dense range
range of multifunction, 132, 218,
220, 221, 228
rank-one, 141
ray, 241, 247
Rayleigh quotient, 26
real function, 143
recession
cone, see cone
function, 98
reﬂexive Banach space, 238–250
regular, 151–157, 159, 160
and generic diﬀblty, 224
regularity
condition, 38, 39, 55, 78, 116,
117, 184
epigraphical, 246
metric, see metric regularity
tangential, see tangential regu-
larity
relative interior, 11–15, 198, 210
and cone calculus, 182
and cone programming, 131
and Fenchel duality, 88, 119
and Max formula, 53
calculus, 88
in inﬁnite dimensions, 241, 249
quasi, 243, 249
relaxed projection, 208
resolvent, 236
retraction, 206, 209
reversing, 234
Riesz lemma, 214
Robinson, 137, 180
Rockafellar, 5, 66, 70, 92, 137, 251
Rutman, see Krein-Rutman
saddlepoint, 111, 112, 228, 229
Sandwich theorem, 69
Hahn-Katetov-Dowker, 223
scalarization, 87, 161, 163
Schur
-convexity, see convex, Schur-
space, 242
Schwarz, see Cauchy-Schwarz
SDP, see semideﬁnite
programming
second order conditions, 24, 197–
203
selection, 216–226
self map, 204–214, 236
in Banach space, 251
self-conjugacy, 66

Index
307
self-dual cone, 26, 64, 66, 100, 121,
129
selfadjoint, 250
semideﬁnite
complementarity, 124, 237
cone, 16, 26, 64, 66, 120, 122,
126
matrix, 16
program, 5, 66, 107, 126–131,
186
central path, 131
Sendov, Hristo, 6
separable, 74, 107
and semicontinuity, 247
Banach space, 240–245
separation, 9, 11, 32 etc
and bipolars, 65, 81
and Gordan’s theorem, 30
and Hahn-Banach, 249
and scalarization, 163
Basic theorem, 9, 24, 91
in inﬁnite dimensions, 241
nonconvex, 164
strict, 83
strong, 12
set-valued map, see multifunction
Shannon, see Boltzmann-Shannon
signal reconstruction, 93
simplex, 79, 93
simultaneous ordered spectral de-
composition, 17, 121
single-valued, 217, 224
generic, and maximal mono-
tonicity, 226
singular value, 21
largest, 187
skew symmetric, 224
Slater condition, see constraint qu-
aliﬁcation
smooth Banach space, 240
solution
feasible, see feasible solution
optimal, 10 etc
solvability of variational inequali-
ties, 228–237
spectral
conjugacy, 120, 122, 123
decomposition, 17, 27
diﬀerentiability, 121
function, 120–125, 155
convex, 121, 123
subgradients, 121, 122, 124
theory, 250
sphere, 206, 212–215
square-root iteration, 19
stable, 106
Clarke tangent cone, 159
steepest descent
and Cauchy-Schwarz, 40
Stella’s variational principle, 251
Stiemke’s theorem, 34
Stone-Weierstrass thm, 205–209
strict
derivative, 153–156, 172, 173,
178–193
generic, 224
local minimizer, 200
separation, 83
strict-smooth duality, 92, 97
strictly convex, 11, 48–52
and Hessian, 48
conjugate, see strict-smooth
duality
essentially, 44, 50, 99
log barriers, 62

308
Index
norm, 249
power function, 28
spectral functions, 122
unique minimizer, 27
strictly diﬀerentiable, see strict
derivative
subadditive, 43
subcover, 217
subdiﬀerential, see subgradient(s)
and essential smoothness, 89
bounded multifunction, 242
calculus, 143
Clarke, see Clarke
closed multifunction, 95, 156,
167, 172, 179, 192
compactness of, 79
convex, see convex
Dini, see Dini
domain of, see domain
in inﬁnite dimensions, 250, 251
inverse of, 94
limiting, see limiting
maximality, 239
Michel-Penot, see Michel-
Penot
monotonicity, 216, 224, 225
nonconvex, 143
nonempty, 45, 239
of eigenvalues, 157
of polyhedral function, 118
on real line, 171
smaller, 167
support function of, 67
versus derivative, 143
subgradient(s), 5, 44
and conjugation, 62
and Lagrange multipliers, 55
and lower semicontinuity, 96
and normal cone, 47, 68
at optimality, 44
Clarke, see Clarke
construction of, 45
Dini, see Dini
existence of, 45, 54, 63, 116,
135
Michel-Penot, see Michel-
Penot
of convex functions, 42–53
of max-functions, see max-
function
of maximum eigenvalue, 47
of norm, 47
of polyhedral function, 114
of spectral functions, see spec-
tral subgradients
order, see order subgradient
unique, 46, 241, 245
subgradients
in inﬁnite dimensions, 238
sublinear, 43, 45, 70, 80, 83, 100,
123, 125, 158
and support functions, 91
directional derivative, see dir-
ectional derivative
everywhere-ﬁnite, 91
order-, 71–74
recession functions, 98
subspace, 8
closed, 240
complemented, 238
countable-codimensional, 244
dense, 246
ﬁnite-codimensional, 247
projection onto, 31
sums of, see sum of subspaces
suﬃcient condition(s)

Index
309
and pseudo-convexity, 165
ﬁrst order, see ﬁrst order con-
dition(s), suﬃcient
Lagrangian, see Lagrangian
nonsmooth, 172
second order, 199
sum
direct, 10
of cones, see cone
of sets, 7
of subspaces, 246, 248
rule
convex, see convex calculus
nonsmooth, see nonsmooth
calculus
support function(s), 66, 95, 97
and sublinear functions, 91
directional deriv., 144–148
of subdiﬀerentials, 145
support point, 239–245
supporting
functional, 239–245
hyperplane, see hyperplane
supremum, 10
norm, 243
surjective
and growth, 226, 235
and maximal monotone, 225,
237
Jacobian, 178, 179, 183, 191,
198, 202, 210
linear map, 84, 85, 117, 128
process, 132–142
surprise
expected, 101
symmetric
convex function, 35
function, 120–125
matrices, 16–21
set, 124
tangency properties, 241
tangent cone, 158–166
and directional derivatives, 159
as conical approximation, 159
calculus, 87, 101, 182
Clarke, see Clarke
coincidence of Clarke and con-
tingent, 159
convex, 65, 88, 159
ideal, 165
intrinsic descriptions, 159, 162
to graphs, 162, 172
to polyhedron, 118
tangent space, 180
tangent vector ﬁeld, 212
tangential regularity, 159, 179, 182,
246
Theobald’s condition, 20, 21
theorems of the alternative, 30–35,
113
Todd, Mike, 6
trace, 16
transversality, 181, 189
trust region, 109
Tucker, see Karush-Kuhn-Tucker
twice diﬀerentiable, see diﬀeren-
tiable
Ulam, 207
uniform
boundedness theorem, 250
convergence, 205, 222
multipliers, 201
unique
ﬁxed point, 204, 208

310
Index
minimizer, 27
nearest point, 249
subgradient, see subgradient
upper semicontinuity (of multifu-
nctions), 136
Urysohn lemma, 223
USC (multifunction), 216–235
value function, 54–60, 63, 104–106,
135, 138
polyhedral, 116
variational
inequality, 227–237
principle
in inﬁnite dimensions, 238,
251
of Ekeland, see Ekeland
vector ﬁeld, 212–213
vector optimization, see optimiza-
tion
Ville’s theorem, 33
viscosity subderivative, 171, 174
von Neumann, 18
lemma, 21
minimax theorem, 93, 96, 228,
232
Wang, Xianfu, 6
weak
-star topology, 241–242
duality, see duality
Hadamard derivative, 240
metric regularity, see metric
regularity
minimum, 86
topology, 241–242
weakly compact, 243, 250
and nearest points, 249
Weierstrass, see also Bolzano-Wei-
erstrass, Stone-Weierstrass
proposition, 10, 25 etc
Wets, 5
Weyl, 117
Williams, see Filmore-Williams
Young, see Fenchel-Young
Zizler, see Deville-Godefroy-Zizler
Zorn’s lemma, 216

