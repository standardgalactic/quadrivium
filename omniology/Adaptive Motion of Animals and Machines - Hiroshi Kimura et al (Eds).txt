Hiroshi Kimura, Kazuo Tsuchiya, Akio Ishiguro,
Hartmut Witte (Editors)
Adaptive Motion of Animals and Machines

Hiroshi Kimura, Kazuo Tsuchiya,
Akio Ishiguro, Hartmut Witte (Editors)
Adaptive Motion of
Animals and Machines
With 241 Figures
ABC

Hiroshi Kimura
Graduate School of Information Systems
University of Electro-Communications
1-5-1 Chofu-ga-oka, Chofu, Tokyo 182-8585, Japan
Kazuo Tsuchiya
Department of Aeronautics and Astronautics
Graduate School of Engineering
Kyoto University
Yoshida-honmachi, Sakyo-ku, Kyoto 606-8501, Japan
Akio Ishiguro
Department of Computational Science and Engineering
Graduate School of Engineering
Nagoya University
Furo-cho, Chikusa-ku, Nagoya 464-8603, Japan
Hartmut Witte
Department of Biomechatronics
Faculty of Mechanical Engineering
Technical University of Ilmenau
Pf 10 05 65, D-98684 Ilmenau, Germany
Library of Congress Control Number: 2005936106
ISBN-10  4-431-24164-7  Springer-Verlag Tokyo Berlin Heidelberg New York
ISBN-13  978-4-431-24164-5  Springer-Verlag Tokyo Berlin Heidelberg New York
Printed on acid-free paper
© Springer-Verlag Tokyo 2006
Printed in Japan
This work is subject to copyright. All rights are reserved, whether the whole or part of the material
is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microfilms or in other ways, and storage in data banks.
The use of registered names, trademarks, etc. in this publication does not imply, even in the absence of a
specific statement, that such names are exempt from the relevant protective laws and regulations and
therefore free for general use.
Springer is a part of Springer Science+Business Media
springeronline.com
Printing and binding: Hirakawa Kogyosha, Japan

Preface
• Motivation
It is our dream to understand the principles of animals’ remarkable ability
for adaptive motion and to transfer such abilities to a robot. Up to now,
mechanisms for generation and control of stereotyped motions and adaptive
motions in well-known simple environments have been formulated to some
extent and successfully applied to robots. However, principles of adaptation to
various environments have not yet been clariﬁed, and autonomous adaptation
remains unsolved as a seriously diﬃcult problem in robotics.
Apparently, the ability of animals and robots to adapt in a real world
cannot be explained or realized by one single function in a control system
and mechanism. That is, adaptation in motion is induced at every level from
the central nervous system to the musculoskeletal system. Thus, we organized
the International Symposium on Adaptive Motion in Animals and
Machines (AMAM) for scientists and engineers concerned with adaptation
on various levels to be brought together to discuss principles at each level and
to investigate principles governing total systems.
• History
AMAM started in Montreal (Canada) in August 2000. It was organized by
H. Kimura (Japan), H. Witte (Germany), G. Taga (Japan), and K. Osuka
(Japan), who had agreed that having a small symposium on motion control,
with people from several ﬁelds coming together to discuss speciﬁc issues, was
worthwhile. Those four organizing committee members determined the scope
of AMAM as follows.
+ motion principles in nature
+ biologically inspired technical motion systems
+ nonlinear system dynamics and control
+ dynamic autonomous adaptation to terrain
+ dynamic adaptive mechanism
+ passive dynamic walking
+ autonomous pattern adaptation
+ evolution of mechanism and control/nervous system
These topics involve a broad range of background disciplines, i.e., biology,
physiology, biomechanics, non-linear system dynamics, and robotics. It is
usually diﬃcult for people from diﬀerent disciplines to discuss speciﬁc is-
sues. Therefore, in order to ease this problem we invited nine speakers, each
of whom had an impressive academic background in his ﬁeld. Finally, 41
papers, including nine keynote lectures, were presented in single-track style
over four days. Because the quality of each presentation, the intensive discus-
sion concentrating on the single issue of adaptive motion, and the interaction

VI
among people of diﬀerent backgrounds were so well received, we agreed on
holding the 2nd AMAM in Kyoto (Japan) in March 2003.
For the 2nd AMAM, the international organizing committee (AMAM
IOC) was formally organized. We received sponsorship from the Japan Soci-
ety for the Promotion of Science (JSPS) and co-sponsorship from the CREST
Program of the Japan Science and Technology Corporation (JST). While
keeping the symposium style of AMAM2000, 59 high-quality papers, includ-
ing nine invited keynote lectures, were presented in single-track style over
ﬁve days.
The 3rd AMAM was held in Ilmenau (Germany) in September 2005. The
proceedings of AMAM2005 will be published on DVD. The members of the
current AMAM IOC are:
Kazuo Tsuchiya, general chair
Auke Ijspeert
Hiroshi Kimura, secretary
Martin Buehler
Akio Ishiguro, treasurer
Avis H. Cohen
Hartmut Witte
• Publication
This proceedings comprises 23 papers selected from the CD-ROM proceed-
ings of the 1st and 2nd AMAMs. The topics can be loosely placed into six
categories:
(1) motion generation and adaptation in animals; (2) adaptive
mechanics; (3) machine design and control; (4) bipedal locomotion utilizing
natural dynamics; (5) neuro-mechanics and CPG and/or reﬂexes; and (6)
adaptation at higher nervous levels.
• Towards the Future
What we discuss, e.g., science vs engineering or biology vs robotics, is not
one of the key issues of AMAM. When we solve complicated problems, it
is desirable to proceed with analysis and synthesis concurrently. It is well
known that analysis by synthesis is a worthwhile and important methodology
to understand underlying principles. We hope AMAM marks the beginning
of a new interdisciplinary research ﬁeld where science and engineering are
merged.
Tokyo, Kyoto, Nagoya (Japan) and Ilmenau (Germany)
Hiroshi Kimura
November 2005
Kazuo Tsuchiya
Akio Ishiguro
Hartmut Witte

Contents
Part 1 Motion Generation and Adaptation in Animals
Overview of Adaptive Motion in Animals and Its Control
Principles Applied to Machines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
3
Avis H. Cohen
Robust Behaviour of the Human Leg . . . . . . . . . . . . . . . . . . . . . . . . .
5
Reinhard Blickhan, Andre Seyfarth, Heiko Wagner, Arnd Friedrichs,
Michael G¨unther, Klaus D. Maier
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
5
2
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
6
3
Perspective. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
14
Control of Hexapod Walking in Biological Systems . . . . . . . . . . .
17
Holk Cruse, Volker D¨urr, Josef Schmitz, Axel Schneider
1
Walking: a nontrivial behavior . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
17
2
Control of the step rhythm of the individual leg . . . . . . . . . . . . . . . . . .
19
3
Control of the selector network: coordination between legs. . . . . . . . .
19
4
Control of the swing movement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
21
5
Control of the stance movement and coordination of supporting legs
24
6
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
26
Purposive Locomotion of Insects in an Indeﬁnite Environment
31
Masafumi Yano
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
31
2
Motion control system . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
32
3
Central pattern generator model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
35
4
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
5
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
38
Control Principles for Locomotion –Looking Toward Biology .
41
Avis H. Cohen
1
Introduction to Central Pattern Generators and their sensory control 41
2
CPG and muscle activation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
41
3
Sensory feedback . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
45
4
Summary and conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
49
Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
in Non-Human Primates; Common and Speciﬁc Properties . . .
53
Shigemi Mori, Futoshi Mori, Katsumi Nakajima
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
53

VIII
2
Locomotor control CNS mechanisms including anticipatory and re-
active control mechanisms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
54
3
Emergence, acquisition and reﬁnement of Bp locomotion in Juvenile
Japanese monkeys. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
56
4
Common and diﬀerent control properties of Qp and Bp locomotion .
58
5
Similarity and diﬀerence in the kinematics of lower limbs during Bp
walking between our monkey model and the human . . . . . . . . . . . . . .
59
6
Summary and discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
60
Part 2 Adaptive Mechanics
Interactions between Motions of the Trunk and the Angle
of Attack of the Forelimbs in Synchronous Gaits of the Pika
(Ochotona rufescens) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
69
Remi Hackert, Hartmut Witte, Martin S. Fischer
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
70
2
Preliminiary question: do pikas prefer one forelimb as trailing limb?
70
3
Trajectories of the centre of mass of pikas in half-bound gait . . . . . .
72
4
Does the angle of attack couple with speed? . . . . . . . . . . . . . . . . . . . . .
74
5
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
75
On the Dynamics of Bounding and Extensions: Towards the
Half-Bound and Gallop Gaits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
Ioannis Poulakakis, James Andrew Smith, Martin Buehler
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
79
2
Bounding experiments with Scout II . . . . . . . . . . . . . . . . . . . . . . . . . . . .
80
3
Self-stabilization in the SLIP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
81
4
Modeling the Bounding Gait . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
82
5
Local stability of passive bounding . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
85
6
The half-bound and rotary gallop gaits . . . . . . . . . . . . . . . . . . . . . . . . .
85
7
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
88
Part 3 Machine Design and Control
Jumping, Walking, Dancing, Reaching: Moving into the
Future. Design Principles for Adaptive Motion . . . . . . . . . . . . . . .
91
Rolf Pfeifer
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
91
2
Design principles: overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
93
3
Information theoretic implications of embodiment . . . . . . . . . . . . . . . .
97
4
Exploring “ecological balance”—artiﬁcial evolution and morphogen-
esis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102
5
Discussion and conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

IX
Towards a Well-Balanced Design in the Particle Deﬂection Plane 107
Akio Ishiguro, Kazuhisa Ishimaru, Toshihiro Kawakatsu
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107
2
Lessons from biological ﬁndings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 108
3
The model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109
4
Proposed method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110
5
Preliminary simulation results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111
6
Conclusion and future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114
Experimental Study on Control of Redundant 3-D Snake Robot
Based on a Kinematic Model
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
Fumitoshi Matsuno, Kentaro Suenaga
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117
2
Redundancy controllable system
. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
3
Kinematic model of snake robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119
4
Condition for redundancy controllable system . . . . . . . . . . . . . . . . . . . 122
5
Controller design for main-objective . . . . . . . . . . . . . . . . . . . . . . . . . . . . 123
6
Controller design for sub-objective . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124
7
Experiments. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
8
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125
Part 4 Bipedal Locomotion Utilizing Natural Dynamics
Simulation Study of Self-Excited Walking of a Biped
Mechanism with Bent Knee . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
Kyosuke Ono, Xiaofeng Yao
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131
2
The analytical model and basic equations . . . . . . . . . . . . . . . . . . . . . . . 132
3
The results of simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 135
4
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140
Design and Construction of MIKE;
a 2-D Autonomous Biped Based on Passive Dynamic Walking 143
Martijn Wisse, Jan van Frankenhuyzen
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143
2
Foot shape . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144
3
McKibben muscles as adjustable springs . . . . . . . . . . . . . . . . . . . . . . . . 146
4
Pneumatic system. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148
5
Pressure control unit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149
6
Walking experiments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 151
7
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153

X
Learning Energy-Eﬃcient Walking with Ballistic Walking . . . . . 155
Masaki Ogino, Koh Hosoda, Minoru Asada
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155
2
Ballistic walking with state machine . . . . . . . . . . . . . . . . . . . . . . . . . . . . 156
3
Energy minimization by a learning module . . . . . . . . . . . . . . . . . . . . . . 159
4
Comparing with human data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161
5
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163
Motion Generation and Control of Quasi Passsive Dynamic
Walking Based on the Concept of Delayed Feedback Control . 165
Yasuhiro Sugimoto, Koichi Osuka
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165
2
Model of the walking robot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166
3
Stability of passive dynamic walking . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167
4
DFC-based control method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 168
5
Computer simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171
6
Conclusion and future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174
Part 5 Neuro-Mechanics & CPG and/or Reﬂexes
Gait Transition from Swimming to Walking: Investigation of
Salamander Locomotion Control Using Nonlinear Oscillators . 177
Auke Jan Ijspeert, Jean-Marie Cabelguen
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177
2
Neural control of salamander locomotion . . . . . . . . . . . . . . . . . . . . . . . . 178
3
Mechanical simulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179
4
Locomotion controller . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180
5
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 186
Nonlinear Dynamics of Human Locomotion: from Real-Time
Adaptation to Development . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189
Gentaro Taga
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189
2
Real-time adaptation of locomotion through global entrainment . . . . 190
3
Anticipatory adjustment of locomotion through visuo-motor coor-
dination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195
4
Computational “lesion” experiments in gait pathology . . . . . . . . . . . . 197
5
Freezing and freeing degrees of freedom in the development of loco-
motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199
6
Concluding comments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 201
Towards Emulating Adaptive Locomotion of a Quadrupedal
Primate by a Neuro-musculo-skeletal Model . . . . . . . . . . . . . . . . . . 205
Naomichi Ogihara, Nobutoshi Yamazaki

XI
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205
2
Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 206
3
Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211
4
Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 214
Dynamics-Based Motion Adaptation for a Quadruped Robot . 217
Hiroshi Kimura, Yasuhiro Fukuoka
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217
2
Adaptive dynamic walking based on biological concepts . . . . . . . . . . . 218
3
Entrainment between pitching and rolling motions . . . . . . . . . . . . . . . 221
4
Adaptive walking on irregular terrain . . . . . . . . . . . . . . . . . . . . . . . . . . . 223
5
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225
A Turning Strategy of a Multi-legged Locomotion Robot . . . . . 227
Kazuo Tsuchiya, Shinya Aoi, Katsuyoshi Tsujita
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 227
2
Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 228
3
Stability analysis of walking . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229
4
Turning walk control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 234
5
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235
A Behaviour Network Concept for Controlling Walking
Machines . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
Jan Albiez, Tobias Luksch, Karsten Berns, R¨udiger Dillmann
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237
2
Activation, activity, target rating and behaviours . . . . . . . . . . . . . . . . 238
3
The walking machine BISAM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 241
4
Implementing a behaviour network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 242
5
Conclusion and outlook . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 243
Part 6 Adaptation at Higher Nervous Level
Control of Bipedal Walking in the Japanese Monkey,
M. fuscata: Reactive and Anticipatory Control Mechanisms . . 249
Futoshi Mori, Katsumi Nakajima, Shigemi Mori
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 249
2
Reactive control of Bp locomotion on a slanted treadmill belt . . . . . . 250
3
Reactive and anticipatory control of Bp locomotion on an obstacle-
attached treadmill belt . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253
4
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 257
Dynamic Movement Primitives –A Framework for Motor
Control in Humans and Humanoid Robotics . . . . . . . . . . . . . . . . . . 261
Stefan Schaal
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261

XII
2
Dynamic movement primitives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263
3
Parallels in biological research . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 269
4
Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 275
Coupling Environmental Information from Visual System to
Changes in Locomotion Patterns: Implications for the Design
of Adaptable Biped Robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281
Aftab E. Patla, Michael Cinelli, Michael Greig
1
Introduction. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 281
2
The twelve postulates for visual control of human locomotion . . . . . . 282
3
Challenges for applying this knowledge to building of adaptable
biped robots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 284
4
Avoiding collisions with obstacles in the travel path . . . . . . . . . . . . . . 286
5
Avoiding stepping on a speciﬁc landing area in the travel path . . . . . 293
6
Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296

Part 1
Motion Generation and Adaptation
in Animals

Overview of Adaptive Motion in Animals and
Its Control Principles Applied to Machines
Avis H. Cohen
University of Maryland, Biology Department and Institute for Systems Research,
College Park, MD 20742, USA
avis@isr.umd.edu
Animals have developed their locomotor strategies and control mecha-
nisms under the intense pressure of the need to survive and reproduce. They
must escape from predators and capture prey. They also must use as little
energy as possible in order to preserve their resources. With this in mind,
roboticists might well look to biology for design and control principles. Thus,
in the articles that follow the reader is oﬀered a collection of observations and
suggestions from researchers who have spent many years of experimenting on
a range of animals, including both vertebrates and invertebrates.
The perspectives bring an increasing level of complexity. Reinhard Blick-
han brings the mechanics of the organism into the picture, and argues that we
behave with ease and without being overwhelmed by the complicated task
in dynamic situations such as running, hopping or jumping. Holk Cruse
uses nothing by sensory feedback to control his robots. His ideas have been
developed through observations of an insect, the stick insect, that during
slow walking are using sensory feedback almost exclusively in the control of
their movements. In the overview I oﬀer, I introduce the concept of the central
pattern generator (CPG) that provides feedforward control signals to pattern
muscle activity during locomotion of all animals. The CPG strongly interacts
with sensory feedback. Some of the universal and some of the less universal
control principles are oﬀered as potential strategies for robots. Masafumi
Yano oﬀers a perspective that incorporates sensorimotor integration, me-
chanics and descending control from the brain. This rich viewpoint illustrates
the power of the fully integrated organism to survive in an indeﬁnite environ-
ment. Finally, Shigemi Mori, demonstrates the ﬂexibility of the sub-human
primate control of locomotion. He shows clearly that the sub-human primate,
M fuscata, are able, with extensive training, to walk bipedally, even though
their normal locomotion is quadrupedal. This surprising results shows that
the sub-human primate locomotor control system is capable of more plas-
ticity even in such a basic movement as locomotion than had been thought
possible.

Robust Behaviour of the Human Leg
Reinhard Blickhan, Andre Seyfarth, Heiko Wagner, Arnd Friedrichs,
Michael G¨unther and Klaus D. Maier
Dpt. Biomechanics, Institute of Sportscience, D-07740 Jena, Germany
reinhard.blickhan@uni-jena.de
Abstract. The human leg with segments, joints and many muscles is a complicated
device. Yet, in dynamic situations such as running, hopping or jumping we behave
with ease and without being overwhelmed by the complicated task. We argue that
this is possible due to a careful arrangement and ﬁne tuning of all properties from
which stability and robustness emerges. Robust and stable systems are easy to
control.
1
Introduction
Wheeled vehicles are able to economically cover long distances as long as the
substrate is suﬃciently convenient. On rough terrain legged systems are of
advantage. They can use deﬁned footholds, can jump across obstacles and can
orient their bodies. However this results in a much higher degree of freedom of
the movement system. Wheeled vehicles have a degree of freedom of two. The
frontal movement is powered by the motor, the lateral movement is enabled
by the steering movements of the driver. In contrast animals and humans can
also raise and rotate their bodies. In addition each of the multisegmented
body appendages has additional degrees of freedom (ca. 7). This is the main
reason for the enormous diﬃculty to control legged robots.
Most walking machines are slow. This facilitates control. Another strategy
is to reduce degrees of freedom. Examples for this strategy are mixed wheeled
and legged systems and pantograph legs [1]. The only fast machines built
so far, are the hopping machines and their successors built at the MIT-leg
laboratory [2]. Here the construction not only used reduced degrees of freedom
but also the inherent dynamics provided by elastic telescope springs. This can
also be seen as a way to reduce the complexity of the control system. The
control system determines the angle of attack of the leg and the time of
telescopic expansion of the pneumatic spring. In fact bouncing is due to the
principal roughness of legged locomotion, where the leg is facing an impact at
each touch down, the only mode of fast locomotion. A springy leg determines
the time course of force generation and thus facilitates leg control. If this
is not guaranteed the controller must deliver its decisions within the short
contact times (see below). Everybody who observed the walking of artiﬁcial
quadrupeds knows that this demand is far from present possibilities.
Technical walking and running is per se inspired from natural examples.
With respect to the question how to solve the formidable task of locomotion

6
Reinhard Blickhan et al.
control it is again worthwhile to examine nature. We are used to talk about
central pattern generators, reﬂex loops, and heterarchic control. However,
we have neglected for many years the intimate relationship between the me-
chanical properties of the system and those of the control. Recently several
studies have revealed their relevance and some have even coined the contra-
dicting term ”neuromechanics” for a newly emerging ﬁeld. Let me give some
prominent examples. The pendulum mechanism for walking as championed
by Hemami [3], Cavagna et al. [4], and Mochon and McMahon [5] has been
known for many years. However with respect to robotics the break through
came with the studies of McGeer [6] who constructed simple passive walkers
to support his calculations. Physical modelling helped him to understand,
that the length relation between shank and thigh is not just an accident of
evolution but is necessary for swing leg to clear ground. In many studies [7,8]
we have put forward that many legged systems in nature such as crabs and
cockroaches use the same basic dynamics during locomotion as vertebrates.
During fast locomotion the legs interact to operate like a single spring. Re-
cent realisations in diﬀerent machines conﬁrm the elegance of this approach
(Full, pers. comm.). In fact the sprawled posture of the arthropods generally
interpreted in terms of static stability has turned out to be a measure to
increase stability of locomotion in the horizontal direction. Disturbances at
the legs are compensated due to passive features of the system [9,10]. It is
important to realise that footing of each leg becomes much less critical. Even
small and imprecise neural networks are suﬃcient for control.
It is well known in mechanics that systems described by coupled non-
linear equations can behave very diﬀerent depending on initial conditions
and selected parameters. They may display unpredictable chaotic behaviour
or may converge to stable situations e.g. limiting cycles. Pedal systems are
per se nonlinear. In addition, in biological systems the comprising materials
have complicated properties. By applying a series of models from very simple
lumped-parameter models to multi-body models with many degrees of free-
dom combined with experimental investigations we try to identify principles
of operation of the human leg. Recently, we focus on stability.
2
Results
2.1
The global properties of the human leg during running
Running as a bouncing gait can be described by a simple lumped parameter
model: the spring-mass system [11] (Fig.1). The system generates an impact
onto the ground depending on landing velocity. Depending on the stiﬀness
of the spring the contact time can be short (stiﬀspring) or long (compliant
spring). The distribution of horizontal force is described by the angle of at-
tack of the system. For the case of symmetric operation deceleration is equal
to acceleration and continuous locomotion possible. The point of operation of
such a system is partly set by physical physiological conditions. The friction

Robust Behaviour of the Human Leg
7
coeﬃcient limits the angle of attack. The amplitudes of the vertical oscilla-
tion should be small to facilitate visual sensation and diminish the cost of
locomotion. This is due to the fact that small oscillations reduce the vertical
force and enhance contact time which can be generated with slower muscles.
Fig. 1. Simple spring-mass system describing hopping running and jumping
Recent observations (Seyfarth, Geyer, pers. com.) are signalling that other
issues may be of similar importance. A small deviation in the angle of attack
of the leg spring at touch down results in net acceleration or deceleration of
the system. Imagine that the leg would continue the same landing strategy
i.e. the same angle of attack at the next step. Due to the acceleration during
the previous step there is now an increasing or decreasing mismatch between
speed and angle of attack. For close to natural leg stiﬀness the angles of
attack used by the human runner are within a range where running may be
stable with respect to speed. Slight mismatches in the motor program are
compensated by the behaviour of the system.
2.2
The contribution of the diﬀerent joints
Due to the degrees of freedom of a system with two joints the quasi-elastic
operation of the leg in principle could be realised by compensating inelastic
operation of the two joints. Experimental observations [12] have shown, that
quasi-elastic operation is a good ﬁrst approximation. (The deviations will be
discussed below.) During hopping knee and ankle joint are operating largely
synchronous. During running the knee joint in general reaches the point of
maximum bending slightly earlier than the ankle joint. In the long jump the
goal of maximum jumping distance results in a similar synchronous operation
of the joints. Synchronous operation seems to be of advantage [13].
Copying nature in its essentials one could envision a robot leg built of three
segments of equal length with built in rotational springs. Unfortunately, such
a system is highly unstable. After a short rotation synchronisation alters.

8
Reinhard Blickhan et al.
Fig. 2. Starting from a symmetric condition with linear rotational springs at the
joints either the knee or the ankle joint over extents.
Flexion in one joint is accompanied by extension in the other (Fig.2). The
joints are working against each other. In overextending joints torque changes
sign. Such a highly unstable situation would impose serious demands on any
control system. A closer look to nature oﬀers a basket with solutions [14].
One answer is geometry: Imitating the arrangement of leg segments of hu-
man runners result in a considerable enhancement of the synchronous working
range. An additional improvement is possible by introducing slightly nonlin-
ear spring characteristics. Another measure is to introduce springs spanning
two joints.
2.3
Coping with losses
Any real mechanical system has to cope with losses due to friction. These
might be reduced by improving the joints. However, during running quite dif-
ferent sources of loss must be considered. Running is generated by the cyclic
operation of human legs. The horizontal velocity of the foot necessarily oscil-

Robust Behaviour of the Human Leg
9
lates from zero during contact with the substrate to a value of about double
running speed during the aerial phase. Similarly, in vertical direction the foot
comes to a sudden hold at touch down. The strategy to adapt the velocity of
the foot to ground speed at touch down would be highly demanding for con-
trol systems. Especially, in axial direction the corresponding demand would
require active leg shortening with velocities of about half running speed. In
addition, the necessary active accelerations and the decrease in energy storage
would increase cost of locomotion.
Instead, the human runner accepts the impact due to the sudden deceler-
ation of the distal masses. The properties of the heel pad, of the sole of the
running shoes, the viscoelastic suspension of the muscles (Fig.3), comprising
a large part of the distal masses [13] diminish the amplitude and rise-time of
the reaction force at touch down. This critically damped impact entails an
unavoidable loss. To maintain running speed, the runner is forced to work.
The work could be done at diﬀerent joints. As the main losses occur in axial
direction of the leg it is plausible to compensate the losses by active length-
ening of the leg. Runners do that by landing with the knees bent, thereby
diminishing the impact on all proximal joint surfaces, and by straightening
at take of. This lengthening of the leg- and knee-spring can be provided by
a drive in series to the spring.
2.4
Muscle properties and attractive legs
The serial arrangement of active and passive elements introduces another
complication. Now, the muscle-tendon complex as a whole must guarantee
spring-like operation. Muscles have complicated nonlinear behaviour charac-
terised by the force-displacement and force-velocity characteristics. By work-
ing at the ascending slope of the force-displacement curve quasi-elastic op-
eration of the muscle could be guaranteed. More complicated to deal with is
the force-velocity curve. The force-velocity curve can be understood as an im-
portant part of the gears of the locomotor system. While pulling at the drive
the forces are high. With shortening speed the muscle’s capabilities of force
generation diminish. Ideally the muscle-tendon complex takes advantage of
energy storage in the tendon and apodemes and simultaneously of the cheap
eccentric force generation. This is exactly what happens during long jump
[15]. The tendon is stretched immediately after touch down (Fig.4). The rise
in force is dominated by muscle recruitment and eccentric force enhancement
is easy to maintain due to the eccentric operation of the whole leg. During
take oﬀthe elastic recoil of the tendon powers straightening of the knee as
well as prolonged eccentric loading of the muscle. After the load has fallen
below the isometric point of operation muscle shortening dominates. Such a
co-operation requires a delicate tuning between muscle properties and proper-
ties of the passive tissue. Only technical drives with muscle like characteristics
could take advantage of this strategy.

10
Reinhard Blickhan et al.
Fig. 3. Viscoelastic suspension of wobbling masses reduce the sharpness of the
impact at touch down. Left: anthropomorphic model; lumped-parameter model
We have seen that under certain conditions the spring might help to
stabilise locomotion. A springy leg confronted with a rough ground returns
automatically to the point of equilibrium. A vertically oscillating spring-mass
system without damper would do this inﬁnitely despite of any disturbances.
But we have seen, that the human leg entails serial arrangements of elastic
elements and musculature (Fig.5). It is by no means obvious how such a
system reacts to axial disturbances.
For cyclic systems the Ljapunov-Criteria can be used to examine whether
the system asymptotically returns to the prescribed path after disturbance
[16]. It assumes an exponential return to the undisturbed condition in the
state space. The local slope of this return can be determined from the Eigen-
values of the Jacobian of the equations of motion. In our case with changing
conditions during eccentric and concentric periods of the loading cycle these
criteria can be taken as a ﬁrst hint together with numeric simulations. More
advanced mathematical methods support our results.

Robust Behaviour of the Human Leg
11
Fig. 4. Time course of strain of the serial elastic element (tendon and apodeme) and
the contractile element. dashed line: positive slope or lengthening.(after Seyfarth,
et al., 1999)
The results of our calculations show that for a leg model consisting of two
massless segments and a knee extensor stabilisation is only possible if the
Hill-type muscle with a realistic force length curve is paralleled by a spring
and the joint is described realistically including a moving joint axis. In fact
stabilisation requires a ﬁne tuning of all these properties (Fig.6).
Especially if the antagonist is spanning two joints antagonistic systems
can provide stability with minor requirements with respect to tuning [17].
This is achieved at the cost of co-activation. For the single extensor system
described above the activation of the muscle providing a suitable input for
the cyclic movement is uniquely determined. For antagonistic systems this
is not the case, the system is underdetermined. However, we can calculate
activation pattern which provide stability for the system. The stability crite-
rion serves as the necessary additional condition in the system of diﬀerential
equations. With this approach we ﬁnd stability for very simple activation
patterns. Both muscles are activated simultaneously working against each
other in the deﬂection phase. During the extension phase the ﬂexor is de-
activated earlier. New movements can be learned with co-activated muscles
providing maximum stability. The neural network controlling the movement
then learns to use the ﬁne tuned properties of the system and decreases the
co-activation.

12
Reinhard Blickhan et al.
Fig. 5. Two segment model to investigate stability.
Fig. 6. Phaseplots for a stable(left) and an unstable(right) situation. dashed line:
undisturbed; fat line: disturbed

Robust Behaviour of the Human Leg
13
2.5
Robust control
In highly dynamic situations such as running and jumping the delays within
the spinal and cortical reﬂex loops do not allow ﬁne tuned action during
the short contact times. These events are largely steered by feed forward
control. This requires robust behaviour of the leg as described in the preceding
sections. If the leg behaves robust and does not break down in a catastrophic
event during ground contact, control, and corrections are possible step by
step.
Using the simplest model of a bouncing system, the spring-mass-system,
we investigated the suitability of neuronal networks for control [18,19]. De-
sired speed and angle of attack at next touch down served as input param-
eters, the take oﬀangles where asked for as output and fed back into the
network. It turned out that Multi-Layer-Perceptrons consisting of 7 and 9
neurons in two hidden layers were able to steer such a conservative system
to any velocity and along any path (Fig.7). Even though the system learned
only to run at various velocities it was able to cover rough ground, i.e. to
correct on a step by step basis by adapting the angle of attack. A quite lim-
ited number of very simple neurons is suﬃcient to control such a dynamic
behaviour as long as the system properties remain simple and robust.
2.6
Conservative behaviour of the human leg
The human leg has to fulﬁl many diﬀerent tasks such as static support during
standing, in a hammer like action during a kick, or as a compliant axial strut
during running. We investigate to which extent control and properties of the
human leg are adapted to certain loading regimes by exposing it to artiﬁcial
loading situations. An instrumented inclined track allows axial hopping like
loading under reduced gravity and with loads from 28 kg to three times body
mass.
The results show that the leg adapts to increasing loads by increasing the
distance of deceleration. This is achieved by extending the leg to a higher
degree at take up and push oﬀ. Furthermore the amplitude and the time
course of the angular velocity is rather similar in the diﬀerent tasks. Almost
independent of the load and thus of reaction force and muscle recruitment
the system is used in a way that presumably allows optimum operation of
the participating musculature.
In the machine we could identify similar basic strategies as during hop-
ping: a) quasielastic bouncing where the movement is largely determined by
the action of the ankle joint and which is normally used during hopping at the
spot; b) compliant bouncing where large excursions are generated by bending
of the knee. Whereas in the ﬁrst case reﬂexes and material properties seem
to be tuned to generate smooth sinusoidal force patterns, the second shows
bumpy force-time series. This indicates that during the long contact times

14
Reinhard Blickhan et al.
Fig. 7. Neuronal network for robust control of a spring-mass system
involved the quasi-elastic action of the leg is hampered and the suitable re-
action force is generated by the concerted action of a series of reﬂex loops.
Similar strategies might be useful in robot legs. With increasing speed and
decreasing time for the system to react the contribution of the mechanics of
the system should grow.
3
Perspective
We have seen that robust behaviour of the human leg is the result of a very
delicate geometrical design twined with intrinsic properties of the muscle
tendon complex. Robustness reduces the load on the neuronal control system
which is especially important in situations where the time for corrections is
limited. In biomechanics legs are considered to be simple. This does not imply
that we know all about legs, however, our knowledge about the whole loco-
motory system including the trunk in dynamic situations is rather limited.
Perhaps, simple models which already help to predict operating frequencies
may be useful to describe the global behaviour of such complicated arrange-
ments (Fig.8). In addition like in engineering the design of movement systems
is determined by intrinsic boundary conditions given by the limited material
properties within the participating structures. Transfer of principles from bi-
ology into engineering would be facilitated if the inﬂuence of these internal
conditions could be identiﬁed.

Robust Behaviour of the Human Leg
15
Fig. 8. Elastic beams under torsion and bending describe the action of the trunk
of quadruped during trotting and galloping.
Acknowledgements
Supported by grants of the DFG: Innovation College ”Motion Systems”, INK
A22/1-2 TP: B2, C1; Research program ”Autonomous Walking”, Bl236/8-1,
and Bl 236/7.
References
1. Hirose, S., 1984 A study of design and control of a quadruped walking vehicle.
Internat. J. Robot. Res. 3, 113-133
2. Raibert, M. H., 1986, Legged robots that balance. MIT Press, Cambridge, MA.
3. Hemami, H., Weimer, F., and Koozekanani, S., 1973 Some aspects of the in-
verted pendulum problem for modeling of locomotion systems. IEEE Transac-
tions on Automatic Control, pages 658-661
4. Cavagna, G.A., Thys, H., Zamboni, A., 1976, The sources of external work in
level walking and running. J. Physiol. Lond. 262:639-657
5. Mochon, S., McMahon, T.A., 1980, Ballistic walking: an improved model.
Mathematical Biosciences 52:241-260
6. McGeer, T., 1993, Dynamics and control of bipedal locomotion. Journal of
Theoretical Biology, 163:277-314.
7. Blickhan R, Full RJ, 1987, Locomotion energetics of the ghost crab: II Mechan-
ics of the center of mass. J Exp Biol 130:155-174
8. Blickhan, R., Full, R.J., 1993, Similarity in multilegged locomotion: Bouncing
like a monopode. J. Comp. Physiol. A-173:509-517
9. Full, R.J., Koditschek, D.E., 1999, Templates and anchors: neuromechanical
hypothesis of legged locomotion on land. J. Exp. Biol. 202:3325-3332

16
Reinhard Blickhan et al.
10. Kubow, T.M. and Full, R.J., 1999, The role of the mechanical system in con-
trol: a hypothesis of self-stabilization in hexapedal runners. Phil. Trans. Royal
Society London B-354:849-862.
11. Blickhan, R., 1989a, The spring mass model for running and hopping. J.
Biomech. 22:1217 - 1227
12. G¨unther, M., Sholukha, V., Blickhan, R., in prep, Joint stiﬀness of the ankle
and the knee in running - an inverse dynamic analysis and forward simulation
approach.
13. Seyfarth, A., Friedrichs, A., Wank, V., et. al., 1999, Dynamics of the long jump.
J Biomechanics 32(12):1259-67
14. Seyfarth, A., G¨unther, M., Blickhan, R., in prep., A three segmental spring-
mass model.
15. Seyfarth, A., Blickhan, R., van Leeuven, J., 2000, Optimum take-oﬀtechniques
and muscle design for long jump. J. exp. Biol. 203:741-750
16. Wagner, H., Blickhan, R., 1999, Stabilising function of skeletal muscles: an
analytical investigation. J theoret Biol 199:163-179
17. Wagner H., Blickhan R., 1999, Stabilising function of antagonistic neuromuscu-
loskeletal systems - an analytical investigation-” (J. biol. Cybernet. submitted)
18. Maier, K.D., Glauche, V., Blickhan, R., et al. ,2000a, Controlling one-legged
three-dimensional hopping movement. Intern Symp. Adaptive Motion of Ani-
mals and machines (AMAM 2000)
19. Maier, K.D., Glauche, V., Beckstein, et al., in prep, Controlling fast spring-
legged locomotion with artiﬁcial neural networks. Soft computing

Control of Hexapod Walking in Biological
Systems
Holk Cruse, Volker D¨urr, Josef Schmitz and Axel Schneider
Faculty of Biology, University of Bielefeld, Postfach 100131, D-33501 Bielefeld,
Germany
holk.cruse@uni-bielefeld.de
Abstract. To investigate walking we perform experimental studies on animals in
parallel with software and hardware simulations of the control structures and the
body to be controlled. In this paper, we will ﬁrst describe the basic behavioral prop-
erties of hexapod walking, as the are known from stick insects. Then we describe a
simple neural network called Walknet which exempliﬁes these properties and also
shows some interesting emergent properties. The latter arise mainly from the use of
the physical properties to simplify explicit calculations. The model is simple, too,
because it uses only static neuronal units. The system is currently tested using an
adapted version of the robot TARRY II.
Keywords: walking, stick insect, decentralized control, Walknet, positive feed-
back
1
Walking: a nontrivial behavior
From a cognitive standpoint, walking seems to be rather uninteresting be-
cause it appears to be a fairly automatic behavior. We do not have to think
consciously about moving the joints when walking. Nevertheless, we will argue
that walking in a natural environment requires considerable ,,motor intelli-
gence“ and can be regarded as a paradigm for control of behavior in general.
First of all, walking, as almost all behavior, has to deal with redundancy. In
most biological systems for motor control, particularly those concerned with
walking, the number of degrees of freedom is normally larger than that nec-
essary to perform the task. This requires the system to select among diﬀerent
alternatives according to some, often context-dependent optimization criteria,
which means that the system usually has to have some autonomy. Therefore,
the experimenter does not have direct control of some important inputs to the
motor system. Further, such natural systems are physical systems ”situated”
in complex, often unpredictable environments, which means that any move-
ment may be modiﬁed by the physics of the system and the environment.
In turn, adapting to real environments requires the use of sensory informa-
tion about the environment and the results of the system’s actions. Together,
these two factors create a loop through the environment which means that
the actual behavior is determined by the properties of the environment as well
as those of the walking system. Despite these experimental and theoretical

18
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
diﬃculties, the complexity makes the study of motor mechanisms especially
challenging, particularly because they illustrate to a high degree the task
of integrating inﬂuences from the environment, mediated through peripheral
sensory systems, with central processes reﬂecting the state and needs of the
organism. In a walking insect at least 18 joints, three per leg, have to be
controlled. Because the environment may change drastically from one step to
the next, and even the geometrical properties of the body may change, the
control of walking is all but a trivial task. Traditional technical solutions take
sensory input into account only to a small degree and usually use hierarchi-
cally structured control architectures. In both respects these solutions diﬀer
strongly from solutions found by biological systems. Most probably, this dif-
ference is the main reason for the failure of traditional solutions when being
tested in a realistic environment. Biologically inspired autonomous systems
appear to be the solution when one searches for systems being able to act in
unpredictable and hostile environments.
The control system explained here consists of a number of distinct mod-
ules which are responsible for solving particular subtasks. Some of them might
be regarded as being responsible for the control of special ,,microbehaviors“:
for example, a walking leg can be regarded as being in one of two states,
namely performing a swing movement or a stance movement. During stance,
the leg is on the ground, supports the body and, in the forward walking
animal, moves backwards with respect to the body.
Fig. 1. Sketch of a stick insect leg showing the arrangement of the joints and their
axes of rotation.

Control of Hexapod Walking in Biological Systems
19
During swing, the leg is lifted oﬀthe ground and moved in the direction of
walking to where it can begin a new stance. These two ,,microbehaviors“ are
mutually exclusive. A leg cannot be in swing and in stance at the same time,
a situation also holding for many ”macrobehaviors” such as ﬁght or ﬂight,
for instance. Therefore, the control structure has to include a mechanism
for deciding whether the swing or the stance module is in charge of the
motor output. To solve this problem, a simple network, based on positive
feedback, is used. This network works like a ,,two-way“ subsumption system
[1], although there is no direct suppression and subsumption inﬂuence. Note
that no central oscillator is used.
2
Control of the step rhythm of the individual leg
As mentioned, the step cycle of the walking leg can be divided into two
functional states, stance and swing. The anterior transition point, i.e., the
transition from swing to stance in the forward walking animal, is called the
anterior extreme position (AEP) and the posterior transition point is called
the posterior extreme position (PEP). Diﬀerences in the constraints acting
during the two states and in the conditions for their termination suggest that
the leg controller consists of three separate control networks. Two low-level
networks, a swing network and a stance network, control the movement of
the leg during swing and stance, respectively. The transition between swing
and stance is controlled by a selector network. The swing network and the
stance network are always active, but the selector network determines which
of the two networks controls the motor output.
3
Control of the selector network: coordination
between legs
The pattern of leg movement in insect walking is usually described as tripod
or tetrapod gait (Fig. 2). These terms may suggest a rigid central control
structure. However both gaits should rather be considered as extremes of a
continuum (e.g. [2]). Actually very diﬀerent step patterns can be observed
e.g. after a brief disturbance of the movement of a single leg or when animals
start walking from diﬀerent leg conﬁgurations [3, 4]. Insect gaits may therefore
better be described by the term ”free gait” [5]. The usually observed tripod
or tetrapod patterns represent limit cycle solutions that are only apparent
in undisturbed situations [6]. For insects and crustaceans, it has been shown
that a small number of local rules acting between neighboring legs suﬃce for
the emergence of diﬀerent gaits and the recovery from diﬀerent disturbances.
In the following these rules will be summarized brieﬂy.
In all, six diﬀerent coupling mechanisms have been found in behavioral
experiments with the stick insect (Fig. 5a). One mechanism serves to correct

20
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
Fig. 2. The step patterns of a tripod (a) and a tetrapod (b) gait as produced by a
stick insect. The latter is also referred to as a wave gait. The six traces represent the
six legs. Black bars correspond to swing movement. Legs are designated as left (L)
or right (R) and numbered from front to rear. Left and right legs on each segment
(e.g., L1 and R1) always have a phase value of approximately 0.5. The phase value
of adjacent ipsilateral legs (e.g., L1 and L2) is 0.5 in the tripod gait but diﬀers in
the tetrapod gait (after [2]).
errors in leg placement; another has to do with distributing propulsive force
among the legs. The other four are used in the present model. The begin-
ning of a swing movement, and therefore the end-point of a stance movement
(PEP), is modulated by three mechanisms arising from ipsilateral legs: (1)
a rostrally directed inhibition during the swing movement of the next cau-
dal leg, (2) a rostrally directed excitation when the next caudal leg begins
active retraction, and (3) a caudally directed inﬂuence depending upon the
position of the next rostral leg. Inﬂuences (2) and (3) are also active between
contralateral legs. The end of the swing movement (AEP) in the animal is
modulated by a single, caudally directed inﬂuence (4) depending on the po-
sition of the next rostral leg. This mechanism is responsible for the targeting
behavior–the placement of the tarsus at the end of a swing close to the tarsus
of the adjacent rostral leg. These signals are used be the selector network to
decide on swing or stance. Mechanisms (1) to (3) are illustrated in Fig. 3.

Control of Hexapod Walking in Biological Systems
21
4
Control of the swing movement
The task of ﬁnding a network that produces a swing movement is simpler than
ﬁnding a network to control the stance movement because a leg in swing is
mechanically uncoupled from the environment and therefore, due to its small
mass, essentially uncoupled from the movement of the other legs.
A simple, two-layer feedforward net with three output units and six input
units can produce movements (see Fig. 5b, swing net) which closely resemble
the swing movements observed in walking stick insects [7]. The inputs cor-
respond to three coordinates deﬁning the actual leg conﬁguration and three
deﬁning the target–the conﬁguration desired at the end of the swing. In the
simulation, the three outputs, interpreted as the angular velocities of the
joints, dα/dt, dβ/dt, and dγ/dt, are used to control the joints. The actual
angles (for deﬁnition see Fig. 1) are measured and fed back into the net.
Through optimization, the network can be simpliﬁed to only 8 (front and
middle leg) or 9 (hind leg) non-zero weights (for details see [8]). We believe
this represents the simplest possible network for the task; it can be used as
a standard of comparison with physiological results from stick insects. De-
spite its simplicity, the net not only reproduces the trained trajectories, it is
able to generalize over a considerable range of untrained situations, demon-
strating a further advantage of the network approach. Moreover, the swing
net is remarkably tolerant with respect to external disturbances. The learned
trajectories create a kind of attractor to which the disturbed trajectory re-
turns. This compensation for disturbances occurs because the system does
not compute explicit trajectories, but simply exploits the physical properties
of the world. The properties of this swing net can be described by the 3D
vector ﬁeld in which the vectors show the movement produced by the swing
net at each tarsus position in the workspace of the leg. Fig. 4 shows the pla-
nar projections of one parasagittal section (a), and one horizontal section (b)
through the work space.
This ability to compensate for external disturbances permits a simple
extension of the swing net in order to simulate an avoidance behavior observed
in insects. When a leg strikes an obstacle during its swing, it initially attempts
to avoid it by retracting and elevating brieﬂy and then renewing its forward
swing from this new position. In the augmented swing net, an additional
input similar to a tactile or force sensor signals such mechanical disturbances
at the front part of the tibia (Fig. 5b, r1) or the femur (Fig. 5b, r2). These
units are connected by ﬁxed weights to the three motor units in such a way
as to produce the brief retraction and elevation seen in the avoidance reﬂex.
Other reﬂexes can been observed when the tibia is mechanically stimulated
laterally (r3) or when the femur is touched dorsally (r4). These reﬂexes have
been implemented in an analogous manner (Fig. 5b).
In the model, the targeting inﬂuence reaches the leg controller as part of
the input to the swing net (Fig. 5b). These signals can be generated by a sim-
ple feedforward net with three hidden units and logistic activation functions

22
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
Fig. 3. Illustrations of the mechanisms 1 to 3 (see Fig. 5a) as shown from above to
below.
(Fig. 5b, ”target net”) which directly associates desired ﬁnal joint angles for
the swing to current joint angles of a rostral leg such that the tarsus of the
posterior leg is moved in the direction of that of the anterior leg. Compared to
a ﬁrst version [9] the new target net has direct connection between the input
and the output layer. There is no explicit calculation of either tarsus posi-
tion. Physiological recordings from local and intersegmental interneurons [10]
support the hypothesis that a similar approximate algorithm is implemented
in the nervous system of the stick insect.

Control of Hexapod Walking in Biological Systems
23
Fig. 4. Vector ﬁeld representing the movement of the tarsus of a left front leg
produced by the swing net. (a) Projection of a parasagittal section (y = 12 mm,
for coordinates see Fig. 1). (b) Projection of a horizontal section slightly below the
leg insertion (z =-3mm). Left is posterior, right is anterior. The average posterior
extreme position (start of swing movement) and of the average anterior extreme
position (end of swing movement) are shown by an open square and by a closed
square, respectively.

24
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
5
Control of the stance movement and coordination of
supporting legs
For the stance movement, simple solutions can be found for straight walking
on a ﬂat surface [11]. In more natural situations, the task of controlling the
stance movements of all the legs on the ground poses several major problems.
It is not enough simply to specify a movement for each leg on its own: the
mechanical coupling through the substrate means that eﬃcient locomotion
requires coordinated movement of all the joints of all the legs in contact with
the substrate, that is, a total of 18 joints when all legs of an insect are on
the ground. However, the number and combination of mechanically coupled
joints varies from one moment to the next, depending on which legs are lifted.
The task is quite nonlinear, particularly when the rotational axes of the joints
are not orthogonal, as is often the case for insect legs and for the basal leg
joint in particular. A further complication occurs when the animal negotiates
a curve, which requires the diﬀerent legs to move at diﬀerent speeds.
In machines, these problems can be solved using traditional, though com-
putationally costly, methods, which consider the ground reaction forces of all
legs in stance and seek to optimize some additional criteria, such as mini-
mizing the tension or compression exerted by the legs on the substrate. Due
to the nature of the mechanical interactions and inherent in the search for
a globally optimal control strategy, such algorithms require a single, central
controller; they do not lend themselves to distributed processing. This makes
real-time control diﬃcult, even in the still simple case of walking on a rigid
substrate.
Further complexities arise in more complex, natural walking situations,
making solution diﬃcult even with high computational power. These occur,
for example, when an animal or a machine walks on a slippery surface or on a
compliant substrate, such as the leaves and twigs encountered by stick insects.
Any ﬂexibility in the suspension of the joints further increases the degrees
of freedom that must be considered and the complexity of the computation.
Further problems for an exact, analytical solution occur when the length of
leg segments changes during growth or their shape changes through injury.
In such cases, knowledge of the geometrical situation is incomplete, making
an explicit calculation diﬃcult, if not impossible.
Despite the evident complexity of these tasks, they are mastered even
by insects with their “simple“ nervous systems. Hence, there has to be a
solution that is fast enough that on-line computation is possible even for
slow neuronal systems. To solve the particular problem at hand, we propose
to replace a central controller with distributed control in the form of local
positive feedback [8]. Compared to earlier versions [12], this change permits
the stance net to be radically simpliﬁed. The positive feedback occurs at
the level of single joints: the position signal of each is fed back to control
the motor output of the same joint. Earlier experiments [13] have shown
that body height in the stick insect is controlled by a distributed system in

Control of Hexapod Walking in Biological Systems
25
Fig. 5. Fig. 5. (a) Schematic diagram showing the arrangement of the mechanisms
coordinating the movements of the diﬀerent legs. (b) The leg controller consists of
three parts: the swing net, the stance net, and the selector net which determines
whether the swing or the stance net can control the motor output, i.e., the velocity
of the three joints α, β, and γ. The selector net contains four units: the PEP unit
signalling posterior extreme position, the GC unit signalling ground contact, the RS
unit controlling the return stroke (swing movement), and the PS unit controlling
the power stroke (stance movement). The target net transforms information on the
conﬁguration of the anterior, target leg, α1, β1, and γ1, into angular values for
the next caudal leg which place the two tarsi close together. These desired ﬁnal
values (αt, βt, γt) and the current values (α, β, and γ) of the leg angles are input
to the swing net together with a bias input (1) and four sensory inputs (r1 - r4)
which are activated by obstructions blocking the swing and thereby initiate diﬀerent
avoidance movements. A non-linear inﬂuence (NL) modulates the velocity proﬁle.
For details see Cruse et al. (1998).

26
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
which each leg acts like an independent, proportional controller. However,
maintaining a given height via negative feedback appears at odds with the
proposed local positive feedback for forward movement. To solve this problem
we assume that during walking positive feedback is provided for the α joints
and the γ joints, but not for the β joints (Fig. 5b, stance net). The β joint is
the major determinant of the separation between leg insertion and substrate,
which determines body height. The value for the β joint is given by a three
layered feedforward network (height net) with three input units (α, β, γ),
5 hidden units and one output unit. This net has been trained using the
known leg geometry and approximates data from [14], where force-height
characteristics of the standing animal have been measured.
There are, however, several problems to be solved. Only two will be men-
tioned below. To permit the system to control straight walking and to ne-
gotiate curves, a supervisory system was introduced which, in a simple way,
simulates optomotor mechanisms for course stabilisation that are well-known
from insects and have also been applied in robotics. This supervisory system
uses information on the rate of yaw, such as visual movement detectors might
provide. Second, we have to address the question of how walking speed is de-
termined in such a positive feedback controller. Again, we assume a central
value which represents the desired walking speed vref. This is compared with
the actual speed, which could be measured by visual inputs or by monitoring
leg movement (Fig. 5b, boxes marked by broken lines).
One major disadvantage of our simulation is its pure kinematic nature. To
test the principle of local positive feedback at least for straight walking, we
have performed a dynamic simulation for the six-legged system under positive
feedback control during stance. The basic software was kindly provided by F.
Pfeiﬀer, TU Munich. No problems occurred. Nevertheless, a hardware test of
the walking situations is necessary. Currently, we are performing such a test
by using the robot Tarry IIb, i.e., a reconstructed version of TARRY II [15].
The changes made concern the introduction of passive compliance in each leg
joint, a necessary condition for application of positive feedback. For a single
leg walking on a treadmill, the test turned out to be successful.
6
Conclusion
As has been shown for the case of straight walking, this network is able to
control proper coordination. Steps of ipsilateral legs are organized in triplets
forming ”metachronal waves”, which proceed from back to front, whereas
steps of the contralateral legs on each segment step approximately in alter-
nation. With increasing walking speed, the typical change in coordination
from the tetrapod to a tripod-like gait is found. For slow and medium veloc-
ities the walking pattern corresponds to the tetrapod gait with four or more
legs on the ground at any time and diagonal pairs of legs stepping approxi-
mately together; for higher velocities the gait approaches the tripod pattern

Control of Hexapod Walking in Biological Systems
27
with front and rear legs on each side stepping together with the contralat-
eral middle leg. The coordination pattern is very stable. For example, when
the movement of one leg is interrupted brieﬂy during the power stroke, the
normal coordination is regained immediately at the end of the perturbation.
Furthermore, the model can cope with obstacles higher than the normal dis-
tance between the body and the substrate (see Fig. 6 for an example). It
continues walking when a leg has been injured, such that, for example, half
of the tibia is removed (see [16]).
Fig. 6. Simulated walk over an obstacle. Movement direction is from left to right.
Leg positions, as viewed from the side, are illustrated only during stance and only
for every ﬁfth time interval in the simulation. Upper panel: the ﬁrst part of the
walk until both front legs reach the top of the obstacle. Lower panel: descent from
the obstacle until both front legs and one middle leg touch the lower ground.
What about curve walking? The typical engineer’s solution is to determine
the curve radius and the center of the curve. With these values the trajectories
of the diﬀerent legs are calculated and then, using inverse kinematics, the
trajectories for the joint angles are determined. In our case, too, a value is
required to determine the tightness of the curve. This, however, does not need
to quantitatively correspond to the curve radius. The value is only used as
an ampliﬁcation factor for the positive feedback loop of front and hind legs.
This value can deliberately be changed from one moment to the next. No
further calculations are necessary.
The introduction of the local band-pass ﬁltered positive feedback in 12
of the 18 leg joints provides a control system which as far as we can see
cannot be further simpliﬁed, because it is decentralized down to the level
of the single joints. This simpliﬁcation has the side eﬀect that computation
time can be minimized. The essential advantage, however, is that, by means
of this simpliﬁcation and the consideration of physical properties of the body
and the environment, all problems mentioned above (Sect. 5) can easily be
solved, although they, at ﬁrst sight, seemed to be very diﬃcult.
Unexpectedly, the following interesting behavior was observed. A massive
perturbation, for example by clamping the tarsi of three legs to the ground,
can make the system fall. Although this can lead to extremely disordered
arrangements of the six legs, the system was always able to stand up and
resume proper walking without any help. This means that the simple solution

28
H. Cruse, V. D¨urr, J. Schmitz, A. Schneider
proposed here also eliminates the need for a special supervisory system to
rearrange leg positions after such an emergency. Some animations can be
found in: http://www.uni-bielefeld.de /biologie/Kybernetik
Recent results show that internal ”motivational” states are necessary in
order to enable the system to react to a given stimulus in diﬀerent ways
depending on the actual internal state. The state itself depends on sensory
input, too.
References
1. Brooks, RA (1986) A robust layered control system for a mobile robot. J.
Robotics and Automation 2, 1423
2. Graham, D. (1985) Pattern and control of walking in insects. Advances in Insect
Physiology, 18, 31140
3. Graham, D. (1972) A behavioural analysis of the temporal organisation of
walking movements in the 1st instar and adult stick insect. J.comp.Physiol.81,
2352
4. Dean, J., Wendler, G. (1984) Stick insect locomotion on a wheel: Patterns of
stopping and starting. J. exp. Biol. 110, 203216
5. McGee, R.B., Iswandhi, G.I. (1979) Adaptive locomotion of a multilegged robot
over rough terrain. IEEE Transactions on Systems, Man, and Cybernetics,
SMC-9, (4), 176-182
6. Cymbalyuk, G.S., Borisyuk, R.M., M¨uller-Wilm,U., Cruse, H. (1998) Oscilla-
tory networks controlling six-legged locomotion. Optimization of model’s pa-
rameters. Neural Networks 11, 1449-1460
7. Cruse, H, and Bartling, C (1995) Movement of joint angles in the legs of a
walking insect, Carausius morosus. J. Insect Physiol. 41, 761-771
8. Cruse, H, Bartling, C, Dean, J, Kindermann, T, Schmitz, J, Schumm, M, and
Wagner, H (1996) Coordination in a six-legged walking system: simple solutions
to complex problems by exploitation of physical properties. In: P Maes, MJ
Mataric, J-A Meyer, J Pollack and SW Wilson (eds.) From animals to animats
4. Cambridge MA, MIT Press, pp. 84-93
9. Dean, J. (1990) Coding proprioceptive information to control movement to a
target: simulation with a simple neural network. Biol. Cybern., 63, 115120.
10. Brunn, D. and Dean, J. (1994) Intersegmental and local interneurones in the
metathorax of the stick insect, Carausius morosus. J. Neurophysiol., 72, 1208-
1219.
11. M¨uller-Wilm, U, Dean, J, Cruse, H, Weidemann, HJ, Eltze, J, and Pfeiﬀer, F
(1992) Kinematic model of stick insect as an example of a 6-legged walking
system. Adaptive Behavior 1, 155-169
12. Cruse, H, Bartling, C, Kindermann, T (1995) High-pass ﬁltered positive feed-
back for decentralized control of cooperation. In: F Moran, A Moreno, JJ
Merelo, P Chacon (eds.), Advances in Artiﬁcial Life, pp. 668-678. Springer
1995
13. Cruse, H (1976) The control of the body position in the stick insect (Carausius
morosus), when walking over uneven surfaces. Biol. Cybern. 24, 2533
14. Cruse, H, Riemenschneider, D, Stammer, W (1989) Control of body position
of a stick insect standing on uneven surfaces. Biol. Cybern. 61, 7177

Control of Hexapod Walking in Biological Systems
29
15. Frik, M, Guddat, M, Karatas, M, Losch, CD (1999) A novel approach to au-
tonomous control of walking machines. In: G. S. Virk, M. Randall, D. Howard
(eds.). Proceedings of the 2nd International Conference on Climbing and Walk-
ing Robots CLAWAR 99, 13-15 September, P ortsmouth, UK, pp. 333-342,
Professional Engineering Publishing Limited, Bury St. Edmunds
16. Cruse, H, Kindermann, T, Schumm, M, Dean, J, Schmitz, J (1998) Walknet -
a biologically inspired network to control six-legged walking. Neural Networks
11, 1435- 1447

Purposive Locomotion of Insects in an
Indeﬁnite Environment
Masafumi Yano
Research Institute of Electrical Communication, Tohoku University, 2-1-1
Katahira Aoba-Ku, Sendai, 980-8577, Japan
masafumi@riec.tohoku.ac.jp
Abstract. There are many scientiﬁc and technological problems that we cannot
deal with today. Our current scientiﬁc methodology cannot be applied to what is
called the real world problem. Because the real world is unpredictably and dy-
namically changing, it is impossible to objectify it in advance and to apply the
traditional methodology to it. This real world problem especially arises in informa-
tion processing systems such as the recognition and the control systems coping with
the real world. The current information systems request in advance the complete
information to deal with. In the case of robot in the real world, to attain the pur-
pose a robot is usually required to solve the inverse problem adjusting the changes
of the real world. It is always an ill-posed problem. When the robot autonomously
solves the ill-posed problem, some proper constraints should be self-organized in the
robot. In addition to the self-organization of the constraints, the robot is required to
satisfy the constraints in real time. Here we propose a new real-time control mech-
anism for the purposive movements of a robot under the unpredictably changing
environment.
1
Introduction
The real world is by far more complicated than what we up until today
have been able to clarify fully through the natural sciences. It contains many
phenomena that the methodology of the separation of self and other cannot
be applied to.When one isolates something, there is always something left.
Therefore, there are always intrinsic problems remaining in the parts left
over. There are many problems that we cannot deal with today. Since the
real world is unpredictably and dynamically changing, it is impossible to ob-
jectify it in advance and to apply the traditional methodology to it.Especially
this real world problem is crucial in information processing systems, that is,
the recognition and the control systems coping with the real world. Since the
current information systems could only deal with explicit and complete infor-
mation, all problems should be deﬁned and formalized in advance. That is,
our current methodology could be applied only to a limited problem, which
is rigorously objectiﬁed in advance, but the real world is not the case.
This diﬃculty is arisen from the uncertainties of the real world. There
are two kinds of uncertainties in the world. One is a deﬁnite uncertainty and
the other is an indeﬁnite uncertainty. The former is related to the stochastic

32
Masafumi Yano
problem. When the stochastic phase space can be deﬁned but it is enormous
large, it is possible to ﬁnd the solution in principle, but actually impossible to
ﬁnd the solution from its very large phase space. In this sense, it is a deﬁnite
uncertainty. On the contrary, the real world is essentially indeﬁnite, because it
is unpredictably and dynamically changing. So it is impossible to prepare the
complete information in advance, indicating an indeﬁnite uncertainty. In the
cases of indeﬁnite uncertainty, these are always ill-posed problems. It means
that the information processing systems coping with the real world should
have the ability to self-emerge the information needed for.I will point out the
requirements that the emergent systems should satisfy. The system should
be indeﬁnite, which is well known as the law of requisite variety proposed by
Ashby. It means that the information system interacting with the complex
environment should have more complexity than that of environment. Second,
the system should be self-referential, because the necessary information could
not be added externally. Finally, the emergence of information might be ab-
duction process. The deductive and the inductive logic can be applicable only
for the deﬁnite problems.
In order to change the ill-posed problem to the well-posed one, it is nec-
essary some appropriate constraints to make up the incompleteness of the
information of the problem. In the traditional methodology, it is possible to
add some appropriate constraints externally, if we can objectify the problem
in advance. If the pre-assumed world is stationary, this methodology will be
powerful and useful. For example, in the case of locomotion, the trajecto-
ries are usually determined in advance and then the robot walks along the
trajectory by feedback control. Or the locomotive patterns are determined
kinematically in advance, one of which is selected depending on the condition
of the locomotion. On the contrary, in the real world the system itself should
incessantly emerge the necessary constraints in a self-referential way in re-
sponse to the ever-changing environment and satisfy them at every moment.
Here we propose a new paradigm for the purposive locomotion in the real
world.
2
Motion control system
The motion control systems of animals seem to autonomously create appro-
priate information depending on the purposes self-organized in the system
under the unpredictably changing environment. The motor systems of the
animals are generally controlled through three sub-regions in a hierarchical
way, the brain, the central pattern generator (CPG) and the eﬀector organs.
The ﬂexibility of the movements is generated by the neural network as a
control system, indicating that they can organize dynamically their gait pat-
terns quickly in response to the changes of the environment. To coordinate
the movements of the muscles in response to the unpredictably changing en-
vironments, the control system should be indeﬁnite. Indeﬁnite system means

Purposive Locomotion of Insects in an Indeﬁnite Environment
33
that the properties of the elements of the system and the relationship of them
are not speciﬁed in advance. If the control system is deﬁnite, it is impossible
to adapt to the unpredictably changing environment.
2.1
Higher centers
Since the decision-making mechanism is far complicated and not clariﬁed
suﬃciently yet, it is assumed that the instruction of behavior is generated
in the higher center of cerebrum. So the higher center of cerebrum can be
regarded as the highest constraint generator for motor control. The organized
program and instructions in the higher center are the sequence of the pur-
posive direction and the velocity. Although the detail of the mechanism of
the higher center is not clariﬁed yet, some physiological experiments indicate
that the higher center can be considered as coordinating organ between the
purposive movement and posture control. There are parallel pathways from
the brain stems to the motoneurons, one of which is directly pathway to mo-
toneurons and the other is the descending to the thoracic ganglion known as
the CPG. The former might be thought to adjust the muscle tone to main-
tain its posture and the latter to contribute the coordination of the muscle
movements to attain the purposive behavior. To coordinate the functions be-
tween the higher center and the thoracic ganglion, neurotmodulators play
profound eﬀects on the organization of the behavioral states by switching a
neural network from one operating mode to another. The walking patterns
are quickly changed depending on the walking velocities and load [1-6]. In
the case of stick insect, at high speed the front leg and the hind move si-
multaneously and the middle antiphasic to the others, forming a tripod to
support their body. On the contrary, when they walk slowly, the three legs
of each side move metachronally. A pair of legs of the same segment step al-
ternately. As increasing the walking velocity, the insect changes the patterns
critically depending on their velocity, resembled to a phase transition. The
walking patterns also vary with the load [1.5,6]. In the case of horse, energy
consumption during walking does not depend on the walking distance, but
almost on the distance.
2.2
Central pattern generator
The thoracic ganglions, as central pattern generators, are an indeﬁnite con-
trol system to coordinate between the purposive movements and the un-
predictably changing environment, which is well known as the polymorphic
circuits or multi-functional circuit [7]. Recently, we have demonstrated that
the polymorphic circuits can generate various spatio-temporal patterns using
a hard-wired model [8]. But the indeﬁnite control system is only one of nec-
essary conditions. To attain the purpose, the proper constraints should be
self-organized and fulﬁlled by the system itself in response to the changes of

34
Masafumi Yano
the purpose and the current environment. These motor control organizations
are summarized in Fig.1.
Fig. 1. Hierarchical organization of motor control.
One of the aims of biological motion is to reach its destination. If more
complex purpose such as reaching a destination with a required velocity is
imposed on the system, the arrival to the destination takes the priority over
all other purposes. The velocity of stance phase of right and left side legs is
tuned proportional to the angle between the axis of the body and the direction
of the destination, which is feed backed until the second time derivative of
the angle becomes zero. The velocities of the two sides are given by
Vleg.req = Vbody ± k1θ ± k2 × f

d2θ
dt2

(1)
Insects walk usually at an optimal stride, indicating that they have an optimal
anterior and posterior extreme point. From the viewpoint of the balancing
constraints, the frequencies of the two sides should be the same. At lower
walking velocity, the frequency of the leg motion is almost constant but min-
imal, showing that its stride increases with the velocity up to the extreme
points. Beyond the velocity determined by the minimal frequency and the
maximal stride, they quicken the pace to attain the required velocity. In the
turning motion at higher velocity, the frequencies of the two sides tend to
be diﬀerent, but the balancing constraint requires the same frequencies of
the two sides. In this case we assume that the lower velocity side increase its
frequency to its posture, decreasing the stance duration. The tuning of the
frequency of the lower velocity side is given by
dDopt/dt = Dmax −(Dopt + Kb)
∆kb = +k1
∆kb = −k2
kb ≥0
(2)
This quantity is feedbacked to the rhythmic neuron as follows;
∆DR = kd(Dopt −Ds tan ce).
(3)

Purposive Locomotion of Insects in an Indeﬁnite Environment
35
So the higher center of brain sends velocities and the frequencies of the two
sides to the CPG as the constraints of the purposive movement and posture
control.
3
Central pattern generator model
In our model we focus on the walking of insect, so we discuss the control of
the motor system after the decision-making, that is, selection of the behav-
ior. The higher center of brain sends the velocities of the both sides of the
limbs and their muscle tones as the instructions to CPG after coordinating
the purposive movements and the standing posture. In this model the neural
network of the control system composed of the higher center of brain and
CPG is shown in Fig.2. The CPG send motor outputs to control leg muscles
and receive the external aﬀerents as to position, load and force of each muscle.
We have already demonstrated in the case of insect walking that the well co-
ordinated motion among the legs is organized not only by the neural system
composed of the three ganglion, connected through the inter-segmental con-
nectives, but by the mechanical interaction through the movements of legs.
Central pattern generators (CPG) are networks of neurons to control the
motor system generating spatio-temporal pattern of neural activities. In this
paper, we also construct a coupled nonlinear-oscillator system as the poly-
morphic network, which can produce various walking pattern by modulating
the properties of the composing neurons.
The walking of the insect is controlled by the three thoracic ganglions,
prothoracic, mesothoracic and methathoracic ganglions [9]. These ganglions
send motor outputs to control leg muscles and receive the external aﬀerents
as to position, load and force of each muscle. These ganglions are internally
connected each other through a pair of thoracic connectives. It has been clar-
iﬁed that the well coordinated motion among the legs is organized not only
by the neural system composed of the three ganglion, connected through the
inter-segmental connectives, but by the mechanical interaction through the
movements of legs. Central pattern generators (CPGs) are networks of neu-
rons to control the motor system generating spatio-temporal pattern of neural
activities. In this paper, we construct a coupled nonlinear-oscillator system
as the polymorphic network, which can produce various walking pattern by
modulating the properties of the composing neurons.
Inter-segmental inter-neurons in a thoracic ganglion of locust have been
extensively investigated by Laurent and Burrows [10,11]. We adopt funda-
mentally their results as schematically shown in Fig.1.In thoracic ganglion,
this signal is transformed into rhythmic wave by rhythmic neuron correspond-
ing to a spiking inter-neuron in the ganglion. The rhythmic neuron makes
direct synaptic connection with nonspiking inter-neuron (NS neuron), which
is great important to integrate the information on the states of muscles and
inter-segmental pathway. NS neuron transforms the output of the rhythmic

36
Masafumi Yano
neurons to send the motor neuron. We adopt fundamentally their results as
schematically shown in Fig.2.In thoracic ganglion, this signal is transformed
into rhythmic wave by rhythmic neuron corresponding to a spiking inter-
neuron in the CPG.
Fig. 2. Inter-segmental connection among CPGs.
The rhythmic neuron makes direct synaptic connection with non-spiking
inter-neuron (NS neuron), which is great important to integrate the infor-
mation on the states of muscles and inter-segmental pathway. NS neuron
transforms the output of the rhythmic neurons to send the motor neuron.
Inter-segmental connections between rhythmic neurons in the CPG are in-
hibitive, which produce asynchronous oscillation between neighboring rhyth-
mic neurons. The frequency of the rhythmic neuron determines the temporal
patterns of walking, which inhibits each other to appear any phase relation-
ship among the movement of legs. In this sense, the rhythmic neuron is a
kind of command neuron that receives the information of walking velocity,
that is, purpose of the animal created in the brain. The spatio-temporal pat-
terns of the movement of legs are emerged by integration of the dynamical
information of the eﬀector organs in the NS neurons under the constraint
driven from the purpose. Under unpredictably changing environment, the
system requires some rule to satisfy the constraints, and then walking pat-
terns of the animals should be emerged as the results of the coordination of
the movements of the leg muscles. The constraints on the robot should be
contented by optimally integrating each objective function of the elements
through competition and cooperation among them. The objective function
is derived from the energetics of muscle contraction, in which muscle has an
optimal shortening velocity to provide the highest eﬃciency of the energy
conversion. So we introduce ”the least dissatisfaction for the greatest num-
ber of the elements” rule to generate the walking patterns. This rule is quite

Purposive Locomotion of Insects in an Indeﬁnite Environment
37
similar to the Pareto optimum in the economics and brings forth the coop-
eration and/or competition among leg movements, resulting in emerging the
most eﬃcient walking pattern [12,13].
The equations of rhythmic neuron model are given by
dxRi/dt = −yRi −f(xRi) −
j
α NSij(xRj −xRi) + βNSixNSi
dyRi/dt = g(xRi) + DR
f(x) = (A1x2 + B1x + C1) x
g(x) = (A2x2 + B2x + C2) x
(4)
, where x denotes voltage of neuron and DR is the input to the rhythmic
neuron, which determines the frequency of the oscillation.
The NS neurons is given by
dxNSi/dt = −yNSi −f(xNSi) + βRixRi
dyNSi/dt = g(xNSi) + DNSi
f(x) = (A1x2 + B1x + C1) x
g(x) = (A2x2 + B2x + C2) x
(5)
where DNs is the input to the rhythmic neuron, which controls the phase
relationship among the movement of legs. And the motoneuron is governed
by the following equation,
xmi(t) = Λ sigmoid(Gth
i (t)H(xNsi) + Gag
i (t)F F RF )
Gth
i (t) =
kth
i (Vbody,req −Vbody)
Gag
i (t) =
kag
P (θ offset −θ i)
,
(6)
where xmi and F F RF are the activity of the motoneuron, which determines
the motive force of the leg, and the average repulsive force against the ﬂoor,
respectively. Each motoneuron is connected to the each corresponding muscle.
The outputs of non-spiking neuron are transformed to the excitation with the
strength of 1 when above a threshold, otherwise 0. Then they are sent to the
corresponding motoneurons.
In order to self-organize the walking pattern according to the circum-
stance, it is necessary to obtain the information on the surroundings and the
state of the legs. At the beginning of the stance phase, only the posterior
muscle shortens, but at the end of the stance phase the position sensor of the
posterior muscle should strongly inhibit the motoneuron of it, activating the
motoneuron of the anterior muscle. In the case of the swing phase, the inter-
action between the pair of muscles should be reversed. These interactions can
be presented by the direct synaptic connection of the position sensor of each
muscle with the motoneurons and by the feedback to the connectives between
the nonspiking neuron and the motoneuron as shown in Fig.1. The hind leg
moves antiphasic to the middle, which also moves antiphasic to the front leg,
although there is no strong coupling between the hind and the front legs.

38
Masafumi Yano
So, the information required to optimize the eﬃciency of energy conversion
is given as follows.
∆xNSi = kη
⎡
⎣∂η i/∂f i −
⎛
⎝

j̸=i
fi ∗∂η i/∂f i
	

i
fi
⎞
⎠
⎤
⎦
It means that the legs moved synchronously tend to share the load equiva-
lently, where ηdenote the eﬃciency curve of the energy conversion of muscle.
Each leg requires working more eﬃciently, so the feedback to NS neuron is
∆DNSi = kDNSi
⎡
⎣
j
T

0
fi ∗(∂η i/∂f i)dt
⎤
⎦
	⎡
⎣
i
T

0
fidt/T
⎤
⎦
(7)
This feedback information determines the degree of the synchronization among
the legs.
The feedback information from leg to motoneuron is given by
∆Gth
i
= kη(Vi.req −Vi).
(8)
4
Results
In case of straight walking, the required velocity is the only purpose of the
robot, which is the strong constraint for our model system to attain at any
required velocity and any load on the system. Our insect robot can fundamen-
tally generate the two diﬀerent walking patterns depending on the walking
velocities and loads. The walking patterns are characterized by the phase rela-
tionship among the six legs, showing the walking pattern of metachronal gait.
The phase relationship between the hind and the front drastically changes
as the walking velocity increases. As increases the velocity, our robot shows
that the front and the hind legs move simultaneously, called tripod gait as
reported previously.
In this model, the structure of leg is composed of only two muscles, ﬂexor
and extensor muscles, so the movements of legs are limited to move parallel
to the axis of the body. When the angle between the axis of the body and
the direction of the destination is large, the walking velocity should become
slower and the gait pattern is metachronal. When is small, the insect can turn
at higher velocity with a tripod gait. At intermediate angle, outer side legs
and inner side legs take tripod and metachronal gait, respectively, as shown
in Fig.4 a) and b).
5
Discussion
We have simulated an insect robot as an example that can generate appro-
priate walking patterns to walk eﬃciently. Since the walking pattern changes

Purposive Locomotion of Insects in an Indeﬁnite Environment
39
Fig. 3. Trajectories of slow a) and fast b) walk.
Fig. 4. Gait patterns of turning walk at slow speed a) and high speed b).
crucially depending on their walking velocities and loads, animals could gen-
erate a great number of diversities of walking patterns to adapt the unpre-
dictable changes of their surroundings.
We have also showed that a new control mechanism installed in the insect
robot, which can walk attaining more complex purposes of the system as
possible as it can operate at higher eﬃciency of energy conversion under
unpredictable changes of the environment. This control mechanism is derived

40
Masafumi Yano
from a metarule to determine the constraints on the motor system. In case of
turning walk, the destination takes the priority over all other purposes. So the
constraints are self-organized every moment depending on the current state
of the system and the environment to attain the purpose. And the constraints
may be always fulﬁlled with more optimal eﬃciency. As the result the optimal
trajectory and the walking patterns emerged.
References
1. Peason, K.G., (1972). Central programming and reﬂex control of walking on the
cockroach. J.Exp.Biol. 56:173-193
2. Peason, K.G, (1976). The control of walking Sci. Am. 235, 72-86
3. Graham, D., (1979). The eﬀects of circumo-esophageal lesion on he behavior of
the stick insect Carausius morosus. I. Cyclic behavior patterns. Biol. Cybern.
32:139-145
4. Graham, D., (1979). The eﬀects of circumo-esophageal lesion on the behavior
of the stick insect Carausius morosus. II. Change in walking coordination. Biol.
Cybern. 32,147-152
5. Foth E. and Graham D. (1983a) Inﬂuence of loading parallel to the body axis
on the walking coordination of an insect. I. Ipsilateral eﬀects. Biol. Cybern. 4
7:17-23
6. Foth E. and Graham D. (1983a) Inﬂuence of loading parallel to the body axis
on the walking coordination of an insect. II.Contralateral eﬀects. Biol. Cybern.
48:149-157
7. Getting PA. and Dekin MS. (1985) Tritonia swimming: a model system for
integration within rhythmic motor systems. In: Selverston AI(ed) Model neural
networks and behavior. Plenum Press. New York, pp 3-20
8. Makino Y., Akiyama M. & Yano M., (2000). Emergent mechanisms in multiple
pattern generations of the lobster pyloric network. Biol. Cybern. 82443-454
9. Dean, J., (1989). Leg coordination in the stick insect Carausius morosus J. Exp.
Biol. 145, 103-131
10. Laurent, G., & Burrows, M., (1989a). Distribution of intersegmental inputs to
nonspiking local interneurons and motor neurons in the locust. J. Neurosci. 8,
3019-3029
11. Laurent, G., & Burrows, M., (1989b). Distribution of intersegmental inputs to
nonspiking local interneurons and motor neurons in the locust. J. Neurosci. 8,
3030-3039
12. Kimura S., Yano M., & Shimizu, H., (1993). A self-organizing model of walking
patterns of insects. Biol. Cybern. 69 183-193
13. Kimura S., Yano M., & Shimizu, H., (1994). A self-organizing model of walking
patterns of insects II. The loading eﬀect and leg amputation. Biol. Cybern. 70
505-512

Control Principles for Locomotion
–Looking Toward Biology
Avis H. Cohen
University of Maryland, Biology Department and Institute for Systems Research,
College Park, MD 20742, USA
avis@isr.umd.edu
1
Introduction to Central Pattern Generators and
their sensory control
Presented here is an overview of some principles for control of locomotion
that are seen in all animals and which oﬀer ideas for robotic design and con-
trol. The intention of the overview is to suggest new ways to think about and
to perhaps design legged machines taking inspiration and guidance from biol-
ogy. Some additional potential features of motor control seen in mammalian
species are also presented as further examples of concepts that might prove
useful for robotic design.
The discussion in this paper will focus on universal principles present
in virtually all animals studied, vertebrate and invertebrate. We can have
some conﬁdence that the principles that cut across such a wide variety of
animals have most likely been heavily selected over evolutionary time to help
in that survival, and that the principles are important and highly adaptive
control strategies. Two less universal principles are also described for poten-
tial robotic design, with some discussion of how they are implemented in the
biological system and what they might contribute to artiﬁcial systems. Ex-
amples of how one might implement the control strategies will be presented
from robots of colleagues, H. Kimura, University of Electro-Communications,
Tokyo, and A. Lewis, Iguana Robotics. The paper will provide further expla-
nation of the principles as well as pointing to additional material including
references, and pedagogical lectures made available in PDF format.
2
CPG and muscle activation
2.1
CPG structure and basic motor pattern
Locomotion in animals could be produced by passive mechanics as the limbs
impact the environment (for a passive robot cf. Ref. 1). The muscles and
tendons of animal limbs have a remarkable ability to store and release energy
(cf. Full, this volume), but, passive mechanics would be inadequate for swim-
ming, uphill locomotion or for locomotion on an absorbent substrate such as
sand. It is also known that during locomotion a feedforward excitation to the

42
Avis H. Cohen
muscles exists that can be independent of sensory feedback and brain input
[2, 3] (ﬁgure1).
Fig. 1. Demonstration of the existence of CPG in mammals:
Above, the pattern of ﬂexion and extension seen in a cat that is either fully intact
or spinalized but with sensory feedback present. Below, a fully isolated spinal cord a
neonatal rat is capable of producing a stable alternating pattern of muscle activity
similar to that seen during walking. (Adapted from ref 4, data from isolated rat
spinal cord from ref 5)
The feedforward muscle activation is generated by a “central pattern gen-
erator (CPG)” within the spinal cord. The basic pattern, while not requiring
sensory feedback or brain input, does interact with feedback during move-
ment (see below for description of this interaction.)
There is one example of an invertebrate that seems to rely almost entirely
on sensory activated reﬂexes for its locomotion (cf. Cruse presentation), but
its walking is so slow that the reﬂex activation provides perfect ongoing ad-
justments to environmental conditions.
There is considerable evidence that the spinal CPG of vertebrates is a
neural circuit of coupled non-linear oscillators, coordinated by ascending and
descending ﬁbers via strong connections. The structure and organization of
the spinal CPG is best understood in the lamprey, a ﬁsh-like animal that
is evolutionarily at the bottom of the vertebrate line. Its spinal cord, while
simple, contains all the critical vertebrate components of the nervous sys-
tem. Furthermore, the outputs of the CPG throughout the vertebrates can
be shown to be related to each other by only simple transformations [6].
Thus, the organizational principles found in lamprey are apt to hold for

Control Principles for Locomotion –Looking Toward Biology
43
other vertebrates, even those with limbs. In addition to its anatomical sim-
plicity, the lamprey also has the advantage that it lacks any limbs or paired
ﬁns. Its locomotion is a series of traveling waves with the body forming a
single wavelength for optimal eﬃciency [7]. Increases in speed are achieved
by increasing the frequency of the traveling waves, but basically preserving
the overall shape of the body. The pattern of motor output giving rise to the
traveling waves is strict alternation of activity from the left and right sides
within a single segment, and a traveling wave of excitation along ﬁrst one and
then the other side of the body. The activation of any two pairs of segments
has a constant phase relationship regardless of the speed of propagation of
the traveling wave (ﬁgure 2).
Fig. 2. Lamprey traveling wave observed in isolated spinal cord
The motor outputs recorded from a 50 segments piece of isolated spinal cord bathed
in excitatory neural transmitter (adapted from ref 8). The numbers denote the
spinal segment in the isolated piece. The output at a single segment alternates
(R03-L03), with a wave of activity descending down the spinal cord.
Study of the lamprey CPG has revealed a distributed chain of segmental
oscillators, where each oscillator is no more than three spinal segments [9].

44
Avis H. Cohen
Each segmental oscillator has its own intrinsic frequency under any given set
of conditions [10]. These intrinsic frequencies diﬀer among each other. The
oscillators maintain a single frequency via coupling provided by a system of
ascending and descending ﬁbers that apparently make very strong connec-
tions overall. There is also evidence that the functional connections of the
ﬁbers can be made on segments nearby or upon segments up to more than 20
segments away [11]. The ﬁber systems are also distributed across the width
of the spinal cord [12] (ﬁgure 3).
My colleagues and I have modeled the lamprey CPG as a chain of coupled
limit cycle oscillators [13]. Coupling has been modeled as a periodic function
of the phase diﬀerence between any two pairs of oscillators [13, 14]
Fig. 3. Functional organization of the lamprey CPG
Each segment or small group of segments consists of a pair of coupled oscillators.
The coupling is ascending and descending, and long and short. (adapted from ref
12)
With this view of the CPG in mind, Ralph Etienne-Cummings, Johns
Hopkins University, designed an analog VLSI chip to produce periodic burst-
ing to generate the rhythmic output of an actuator for the joint of a limb. The
chip diverges in many ways from its biological counterpart, but captures the
functional equivalence of the periodicity and strict alternation of a segmental
oscillator (ﬁgure 4).
When two oscillators are used to control a pair of legs, coupling via mech-
anisms in keeping with the spirit of the earlier mathematical modeling is
eﬀectively works to couple the pair of chips to maintain the limbs phase
locked (unpubl. observation). Below, is further discussion of the basic chip
and its interaction with sensory feedback from a bipedal limb robot designed
by Anthony Lewis, Iguana Robotics.

Control Principles for Locomotion –Looking Toward Biology
45
Fig. 4. Circuit for CPG chip (from ref 15)
An example of the use of the CPG to produce stable locomotion in a
quadruped is seen in the robot, Tekken, designed by Hiroshi Kimura and his
colleagues at University of Electro-Communications, Tokyo. It can generate
a range of gait patterns and speeds of locomotion with remarkably smooth
action [16].
2.2
Muscle co-activation
By contrast with the lamprey, the muscle activation pattern for limbed ani-
mals is not simple alternation, but is often co-activation of antagonistic mus-
cles. Co-activation provides stiﬀness and stabilization of the joints. For exam-
ple, during extension of a cat hindlimb, the extensors provide the propulsive
force, but ﬂexors are co-active to produce stabilization of the joint (ﬁgure
5: data from J-P. Gossard). Similarly, extensors are active during the end
of ﬂexion to brace the limb for the impact with the ground [17]. This pat-
tern of co-activation is produced by the CPG of a functionally isolated spinal
cord of the cat (ﬁgure 5), demonstrating that the pattern is intrinsic to the
CPG and does not require sensory feedback or control descending from the
brain. David Boothe [18] has shown several neural network models capable
of generating this type of co-activation during rhythmic activity of a CPG.
The use of co-activation is also shown in a robotic biped recently devel-
oped by Lewis (cf. Presentation by A. Lewis). The use of co-activation damps
foot contact and provides increased control of the limb movements generally.
3
Sensory feedback
3.1
Resetting the step cycle
For all CPGs there is one or more critical feedback cue that triggers or resets
a cycle period. This mechanism serves to adapt the cycle to the needs of the

46
Avis H. Cohen
Fig. 5. Co-activation seen in functionally isolated spinal cord of the cat
Recordings from ﬂexor and extensor muscle nerves in a paralyzed cat with its spinal
cord cut. Notice the ﬂexors have a low level of activity during the phase of the cycle
that extensors are active. Data from J-P. Gossard.
animal under all environmental situations. Phenomenologically, the sensory
feedback entrains the locomotor cycle [20]. In cats, it’s been shown that sev-
eral diﬀerent muscles of the hindlimb can serve this purpose [19] (ﬁgure 6).
In lampreys, stretch receptors located along the edges of the spinal cord itself
serve this purpose. By bending the spinal cord directly, the stretch sensors
can entrain the rhythm of the isolated spinal cord [21, 22].
In a biped with passive knees designed by Lewis and controlled by the
analog VLSI chip of Etienne-Cummings, an angle sensor of the hip maintained
the limbs adaptively while walking on a treadmill. The chip was designed
explicitly with a bias to prevent the biped from maintaining itself centered
on the moving belt. Thus, with no sensors, the joint angles drift, while with
the sensors on, they remain within a relatively stable range of values (ﬁgure
7). Through the use of the sensory feedback the biped attained a steady and
stable gait [15].
Another example of this form of limb control in a robot is seen in Tekken,
the robot developed by H. Kimura and his colleagues [16]. Control of Tekken
uses feedback from the limb to create mutual entrainment of the limb and
the oscillator that controls it. The success of this kind of dynamic control is
seen in the movies of Tekken (cf. H. Kimura presentation), as it walks up and
down inclines and over irregular terrain.
3.2
Phase dependent corrections
To guarantee that movement is properly integrated with the environment,
all sensory feedback is adaptively gated through the CPG. This means that

Control Principles for Locomotion –Looking Toward Biology
47
Fig. 6. Hip joint entrains rhythm
Illustration of the entrainment of the CPG with sensory feedback (above) and the
resetting of the step cycle (below): the recordings are integrated traces of muscle
potentials recorded from a spinal cat. The feedback is stretch of hip muscle. Adapted
from ref 4, with data from ref 19.
corrections for perturbations of the limb are gated through the CPG during
any form of locomotion. Reﬂexes that during rest are simple short latency
responses of selective muscles, become more complex responses during lo-
comotion. For example, the response to a perturbation to the walking limb
will depend on the phase of the cycle during which it occurs. The simple
reﬂex response to a painful stimulus applied to the bottom of the foot is
withdrawal through activation of the ﬂexors. However, if one limb is already
oﬀthe ground when such a stimulus is given to the opposite limb that is in
extension, the perturbed limb does not withdraw from the stimulus. Rather,
the foot is driven harder onto the stimulus as a result of extensor activity [23],
and the opposite limb is moved rapidly down to provide support. However,
if the same stimulus is given while the foot is in its ﬂexion phase, the ﬂexors
are, indeed, activated. Thus, the response adaptively adjusts to the phase of
the step cycle.

48
Avis H. Cohen
Fig. 7. Biped joint angles with and without feedback
Joint angles with and without sensory feedback to reset the CPG chip: the dark lines
indicate the joint angles when the feedback is on; the light lines when the feedback
is oﬀ. Note how the angles drift away from a steady state when the feedback is oﬀ.
(from ref 15)
In all CPGs, the same gating of reﬂexes is seen [24]. The response to a
stimulus is adaptively ﬁltered through the CPG to produce a phase depen-
dent response to perturbing stimuli. H. Kimura and his colleagues demon-
strate that this principle can eﬀectively be applied to a quadrupedal robot
to produce stable walking even when subjected to unexpected perturbations
[16]. Cf. Kimura’s presentation for dynamic integration of sensory feedback
to step over obstacles and over irregular terrain.
3.3
Smart sensors – muscle stretch receptors
The typical stretch receptors for mammalian muscles, also oﬀer potential for
robotics. These receptors are part of complex structure called the spindle
organ (cf. Ref 4 for overview and references). The stretch receptor itself is
embedded in a small muscle ﬁber that is activated by specialized motor neu-
rons (γ-motor neurons) in the spinal cord that are situated among the motor
neurons (αtmotor neurons) that activate the force producing muscle ﬁbers.
The spindle’s motor neurons are often separately controlled and serve as part
of servo-control system that regulates the excitability of the force producing
muscles. Such control produces the unexpected result that the spindle re-
ceptors of some muscles are most active when its respective force producing
muscle is at its shortest, that is, during contraction. This pattern of activity,

Control Principles for Locomotion –Looking Toward Biology
49
while ﬁrst shown in decerebrate animals has also been seen during locomo-
tion of intact walking cats [25]. The reason for this counter-intuitive result, is
that the activity of the spindle receptor neurons is responsible for activation
of the motor neurons to the force producing muscles via synaptic connections
of the spindle ﬁbers directly upon the α-motor neurons. Thus, the spindle
organs appear to be part of a servo-assist mechanism for the control of the
force production in mammalian muscle. The output of the spindle stretch
receptors is highly non-linear, as a consequence of the control exerted on the
γ-motor neurons. In reference 25, there are mathematical models that can
predict the ﬁring pattern of the spindle organs when controlled by γ-motor
neurons.
Importantly, a robotic spindle has been implemented and can replicate
a great deal of the function of its biological counterpart[26]. Unfortunately,
the robotic spindle has not yet been implemented with the activity patterns
seen during mammalian locomotion. However, it would appear to contain the
necessary structural complexity to produce the full range of behavior that has
been documented to date.
It isn’t clear that one needs or wants to include a full robotic imple-
mentation of the spindle in a robotic limb designed for walking. However, it’s
possible that one could use the control strategy of a non-linear control of force
production for robotic actuators where the stretch receptors, in association
with force receptors are used to control the activity of the actuators. Having
some kind of complex non-linear control on the force production could poten-
tially provide considerably more ﬂexibility and sophistication in movement.
Such a non-linear control strategy would not be the ﬁrst order strategy, but
could be a higher order improvement.
Fig. 8. Spindle implementation by Jaax and Hannaford[26]
4
Summary and conclusions
Presented here is an overview of some principles for control of locomotion
that are seen in all animals and which oﬀer ideas for robotic design and con-
trol. The intention of the overview is to suggest new ways to think about

50
Avis H. Cohen
and to perhaps design legged machines taking inspiration and guidance from
biology. Biological systems have had eons to ﬁnd and develop optimal meth-
ods for control. An animal dies that fails to escape its enemies eﬀectively
because of a failure of its locomotor control system. The only control princi-
ples for locomotion that are seen universally are those that do allow animals
to escape and procreate. Examples are given in which the principles have
been applied successfully to limbed robots. The application of the biological
principles makes the implementation of the robotic locomotion remarkably
smooth and adaptive to most conditions including irregular terrain and ran-
dom perturbations. Kimura’s dynamic integration of sensory input with a
limit cycle oscillator provides an example of a robotic system that puts all
the pieces together. The movement of Tekken speaks for itself.
Additional suggestions are also provided for potential new approaches
that one might consider for legged robots. These suggestions come from less
universal features of motor control, but features that nonetheless may oﬀer
novel perspectives. The use of co-activation of actuators acting across a single
joint, and complex non-linear integration of sensory feedback could oﬀer more
ﬂexibility and optimality in both bipedal and quadrupedal machines.
References
1. Garcia, M., Chatterjee, A., Ruina, A., 1998, The simplest walking model: sta-
bility, complexity, and scaling, J. of Biomechanical Eng., 120:281-288
2. Grillner S, Wall´en P. 1985 Central pattern generators for locomotion, with
special reference to vertebrates. Ann. Rev. Neurosci. 8:233-61
3. Delcomyn F. 1980 Neural basis of rhythmic behavior in animals. Science.
210:492-498.
4. E.R. Kandel, J.H. Schwartz, T.M. Jessell, (Eds.) Principles of Neural Science,
McGraw-Hill/Appleton & Lange; 4th edition, 2000
5. Cazalets JR, Borde M, Clarac F. 1995 Localization and organization of the
central pattern generator for hindlimb locomotion in newborn rat. J. Neurosci.
15:4943-4951
6. Cohen, A.H., 1988, Evolution of the vertebrate central pattern generator for
locomotion. In: Cohen, AH, Rossignol, S, Grillner, S (eds) Neural control of
rhythmic movements in vertebrates. Wiley, New York Chichester Brisbane, pp.
129-166.
7. Williams T.L., Bowtell, G., Carling, J.C., Sigvardt, K.A., and Curtin, N.A.,
1995, Interactions between muscle activation, body curvature and the water in
the swimming lamprey. Symp Soc Exp Biol 49:49-59
8. Mellen, N., Kiemel, T, and Cohen A.H. 1995 Correlational analysis of ﬁctive
swimming in the lamprey reveals strong functional intersegmental coupling. J
Neurophysiol 73:1020-30
9. Cohen, A.H., Wall´en, P. 1980 The neuronal correlate of locomotion in ﬁsh.
”Fictive swimming” induced in an in vitro preparation of the lamprey spinal
cord. Exp Brain Res. 41:11-8.
10. Cohen, A. H. 1987a. Eﬀects of oscillator frequency on phase-locking in the
lamprey central pattern generator.J. Neurosci. Meth. 21: 113-125.

Control Principles for Locomotion –Looking Toward Biology
51
11. Miller, W.L., Sigvardt, K.A. 2000 Extent and role of multisegmental coupling
in the Lamprey spinal locomotor pattern generator. J Neurophysiol 83:465-76
12. Cohen, A. H. 1987b. Intersegmental coordinating system of the lamprey central
pattern generator for locomotion. J. Comp. Physiol. 160: 181-193.
13. Cohen, A. H., Holmes, P. J. and Rand, R. H. 1982. The nature of the coupling
between segmental oscillators of the lamprey spinal generator for locomotion:
A mathematical model. J. Math. Biol. 13: 345-369.
14. N. Kopell and G.B. Ermentrout, 1986 Symmetry and phaselocking in chains of
weakly coupled oscillators. Comm. Pure Appl. Math., 39:623-660.
15. Lewis, M. A., Etienne-Cummings, R., Hartmann, M.J., Xu, Z. R. and Cohen,
A.H. 2003 An in silico central pattern generator: silicon oscillator, coupling,
entrainment, and physical computation, Biol. Cybern. 88 2, 137-151
16. Fukuoka, Y., Kimura, H., and Cohen, A.H. 2003, Adaptive Dynamic Walking
of a Quadruped Robot on Irregular Terrain based on Biological Concepts, Int.
J. Robotics Res. 22:187-202
17. Engberg, I., Lundberg, A. 1969, An electromyographic analysis of muscular
activity in the hindlimb of the cat during unrestrained locomotion. Acta Physiol
Scand 75:614-630
18. D. Boothe and A.H. Cohen, submitted, Models of the locomotor central pattern
generator that achieve coactivation and alternation
19. Hiebert, G.W., Whelan, P.J., Prochazka, A., Pearson, K.G. 1996 Contribution
of hind limb ﬂexor muscle aﬀerents to the timing of phase transitions in the
cat step cycle. J Neurophysiol 75:1126-37
20. Andersson, O., Grillner, S. 1983 Peripheral control of the cat’s step cycle. II.
Entrainment of the central pattern generators for locomotion by sinusoidal hip
movements during ”ﬁctive locomotion.”. Acta Physiol Scand 118:229-39
21. S. Grillner, A. McClellan, and C. Perret. 1981 Entrainment of the spinal pattern
generators for swimming by mechanosensitive elements in the lamprey spinal
cord in vitro. Brain Res., 217:380-386.
22. McClellan, A.D., Sigvardt, K.A. 1988 Features of entrainment of spinal pattern
generators for locomotor activity in the lamprey spinal cord. J Neurosci. 8:133-
45.
23. Forssberg H. 1979 Stumbling corrective reaction: a phase-dependent compen-
satory reaction during locomotion. J. Neurophysiol. 42:936-53.
24. Rossignol et al. chapter 1988 In: Cohen, AH, Rossignol, S, Grillner, S (eds) Neu-
ral control of rhythmic movements in vertebrates. Wiley, New York Chichester
Brisbane, pp.
25. Prochazka, A, Gorassini, M. 1998 Ensemble ﬁring of muscle aﬀerents recorded
during normal locomotion in cats. J. Physiol. 507:293-304
26. K.N. Jaax and B. Hannaford 2002 A Biorobotic Structural Model of the Mam-
malian Muscle Spindle Primary Aﬀerent Response. Ann. Biomed. Eng. Vol. 30,
pp. 84-96

Higher Nervous Control of Quadrupedal vs
Bipedal Locomotion in Non-human Primates;
Common and Speciﬁc Properties
Shigemi Mori, Futoshi Mori and Katsumi Nakajima
National Institute for Physiological Sciences, Okazaki, Aichi 444-8585, Japan
Abstract. Bipedal (Bp) terrestrial locomotion is a routine, everyday activity for
humans and advanced non-human primates. While its elaboration seems simple, it
actually involves much skill and long-term locomotor learning, such that the CNS
can achieve a seamless spatial and temporal integration of multiple motor segments.
To advance understanding of the CNS control mechanisms that operate during Bp
locomotion, it seemed necessary to make use of a non-human primate model. This
strategy invites the possibility of employing state-of-the-art interventional recording
techniques and cellular-to-systems level of neuroscientiﬁc analysis to the study of
locomotion. We think that the study of posture and locomotion is fundamental
to the understanding of basic brain-behavior relationships from the cellular to the
behavioral level of analysis. To this end, we used operant conditioning to train
the normally quadrupedal (Qp)-walking juvenile Japanese monkey (M. fuscata) to
stand upright and walk bipedally on the surface of a moving treadmill belt. Our M.
fuscata studies have started to reveal brain mechanisms involved in the successful
emergence and elaboration of Bp locomotion.
1
Introduction
We acquire the novel capability of walking bipedally according to a geneti-
cally designed program. Based on this program, we develop postnatally our
musculoskeletal system and its control system so as to elaborate bipedal (Bp)
standing and Bp walking [1]. The musculoskeletal system comprises multiple
motor or movement segments such as head, neck, trunk, fore- and hind-limbs,
each segment having a number of degrees of freedom. The control system is
the central nervous system (CNS) comprised of the cerebrum, basal gan-
glia, cerebellum, brainstem and spinal cord [2]. Neural circuits functionally
uniting them also develop postnatally with maturation of individual CNS
components. Motor segments are innervated by spinal motoneurons (MNs)
which are referred to as the “ﬁnal common path” because most command
motor signals descending from supraspinal structures, and ascending signals
arising from the motor segments, converge on them [3]. Thus, the MNs inte-
grate all the descending and ascending signals and send ﬁnal motor outputs
to the skeletal muscles of motor segments.
Previous studies have shown that the brainstem and spinal cord are
equipped with neuronal structures that can subserve a variety of postural

54
S. Mori, F. Mori, K. Nakajima
reﬂexes and fundamental movements [2,4]. From a phylogenetical point of
view, the motor pathways descending from the brainstem to the spinal cord
are the earliest developing ones [5]. In contrast, the motor cortices estab-
lish functional connections postnatally ﬁrst with the cervical MNs innervat-
ing the fore-limbs and then the lumbar MNs innervating the hind-limbs. In
the macaque monkey, full myelination (maturation) of corticospinal axons in
the spinal cord occurs at around 36 months of age [6]. Such a rostrocaudal
development of cortico-motoneuronal (CM) connections is well reﬂected in
the postnatal developmental pattern of posture and movements in both the
human [1] and non-human primates [7]. In parallel with the growth of the
musculoskeletal system and the CNS, locomotor learning from daily practice
and experience is necessary for the acquisition of the skill of Bp locomotion.
Locomotor practice and experience help the development of CM connections
to distally located muscles of the foot, and build up and storage of ‘locomotor
memory’ and/or reference centers [2,8].
To advance understanding of CNS control of Bp standing and Bp walk-
ing, we have been analyzing the unrestrained normal quadrupedal (Qp) and
operantly-trained Bp locomotor behavior of a non-human primate, the Japanese
monkey, M fuscata [9-13]. Japanese monkeys are originally Qp, but with long-
term locomotor training, they acquire the novel strategy of walking bipedally
on the surface of a moving treadmill belt. To describe the functional signiﬁ-
cance of our ﬁndings, the present report addresses four major aspects relat-
ing to the elaboration of Bp locomotion: (a) our concept of locomotor control
CNS mechanisms including anticipatory and reactive control mechanisms, (b)
emergence, acquisition and reﬁnement of Bp locomotion in juvenile Japanese
monkeys, and integration of posture and locomotion (c) common and dif-
ferent control properties of Qp and Bp locomotion, and (d) similarity and
diﬀerence in the kinematics of lower limbs during Bp walking in our monkey
model and in the human. The last section addresses a future perspective for
understanding “brain-locomotor behavior” relationships.
2
Locomotor control CNS mechanisms including
anticipatory and reactive control mechanisms
We have recently proposed a new concept of CNS mechanisms related to
locomotor control [2]. As shown conceptually in Figure 1, we hypothesize that
descending commands from the cognitive and emotive portions of the higher
CNS, and activity of both locomotion evoking centers and posture control
centers are constantly compared with that of the reference centers, with their
collective output sent to the integration centers. Such a system incorporates
both anticipatory and reactive control processes [14]. Critical components of
the reference centers are the postural and locomotor memory that is built up
by daily walking practice and experience. Its other component includes the
postural body scheme or the reference frame of bodily conﬁguration essential

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
55
for Bp locomotion [2,15]. The integration centers participate in a comparative
function: comparing top-down locomotor command feedforward signals with
bottom-up feedback signals revealing the current state of locomotion, and
minimizing impairments of posture and locomotion. The integration center’s
eﬀerent output is distributed by way of executing centers. The latter’s concern
is that motor signals must be sent to a number of diﬀerent muscle control
systems such that the multiple motor segments they control are activated in
a coordinated manner.
Major elements of motor control units are ‘interneuronal circuits includ-
ing the central pattern generator (CPG)’, spinal MN columns and motor
segments [2,16]. Output signals arising from the execution centers are carried
to the spinal cord by the phylogenetically old reticulospinal (RS) and vestibu-
lospinal (VS) pathways, and ensure that appropriate and timely forces are
applied to relevant limb joints, the result being a smooth execution of locomo-
tion, with correctly phased limb movements and adequate levels of postural
muscle tone [2,4]. Output signals arising from the higher CNS, such as the
primary motor area (M1) and supplementary motor area (SMA), are also
carried to the MNs of motor control units by way of phylogenetically recent
corticospinal and cortico-reticulospinal pathways, and contribute to the re-
ﬁnement of limb movements such as to avoid obstacles on the walking path
[2].
During Bp standing and Bp walking, changes in body conﬁguration are
ﬁrst registered by both the labyrinthine and proprioceptive receptors em-
bedded in the motor segments. Changes in the external world are perceived
by telereceptors, such as the eyes and ears [3]. By continuous reception and
processing of multi-modal interoceptive and exteroceptive aﬀerent inputs, the
integration centers can compare the body’s moment-to-moment conﬁguration
relative to the immediate and distant environment. When both quadrupeds
and bipeds encounter unexpected obstacles, they adopt preparatory or antic-
ipatory postures to avoid them. When they fail to clear the obstacles, they
take reactive and/or defensive postures to minimize and compensate for the
impairments to ongoing locomotion [14]. The central feedback from the inte-
gration center combined with peripheral feedback at the cerebral cortical level
enables the animal conscious perception of its kinesthetic aspects of volitional
(anticipatory) and automatic (reactive) adjustments to locomotion [2]. An-
ticipatory control mechanisms are probably stored at a high CNS levels such
as the visual cortex, SMA and M1 and interconnecting networks, whereas
reactive control mechanisms are probably stored at low CNS levels such as
the cerebellum, brainstem and spinal cord and interconnecting networks [2].

56
S. Mori, F. Mori, K. Nakajima
Environment
reactive control
Locomotion
multiple
motor
control
units
execution
centers
locomotion
evoking centers
reference
centers
posture control
centers
Cognitive brain
anticipatory
control
Emotive
brain
reactive control
integration
centers
Fig. 1. A conceptualization of the overall integrated control of posture and lo-
comotion including anticipatory and reactive control. From the left to right, the
CNS structures and their proposed processes include: cognitive processing, emotive
processing, locomotion evoking centers, posture control centers, reference centers,
integration centers, execution centers, and multiple motor control units. Open and
closed arrowheads represent the ascending and descending ﬂow of signals. Modiﬁed
from reference [2].
3
Emergence, acquisition and reﬁnement of Bp
locomotion in Juvenile Japanese monkeys
Genetically Qp young Japanese monkey, M. fuscata, can acquire a novel ca-
pability of Bp walking on the surface of a moving treadmill belt [13]. The
operant-conditioning methods with which monkey learned to walk quadrupedally
and/or bipedally are described in detail elsewhere [10, 12]. After suﬃcient
physical growth and locomotor learning (12 to 24 months), young monkeys
(estimated age: 1.6 to 2.4 years) gradually acquired a more upright and a
more stable posture, a more stable (less variable) cyclic patterns of joint an-
gles in the lower limbs and coupling among the neighboring joints, and also
faster speeds of Bp walking [13]. It was also found that stability of kinematic
patterns developed in a rostro-caudal direction, i.e. in the same direction
as observed in developing human infants [1]. Our ﬁndings demonstrated for
the ﬁrst time the basic principles of the developing monkey to integrate the
neural and musculoskeletal mechanisms required for suﬃcient coordination
of upper (head, neck, trunk) and lower (hind-limbs) motor segments so that
Bp standing could be maintained and Bp walking elaborated.
Once the monkeys acquired Bp walking capability, they still could walk
bipedally even after a few weeks of cessation of locomotor training. This
suggests that the monkeys stored a postural body scheme or the reference

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
57
frame of bodily conﬁguration necessary for Bp walking. We also found that
the Qp walking monkey on the moving treadmill belt could right its posture
and continue Bp locomotion [17]. The transition from Qp to Bp walking
always began when the left (L) or right (R) hind-limb initiated a stance (ST)
phase of the step. For example, at the time when the imaginary position
of the monkey’s center of body mass (CoM) projected to the supporting
L hind-limb, the monkey began an upward excursion of the angle of the
weight-bearing hip joint. The L forelimb was then freed from the constraints
of weight bearing. With further upward excursion of the hip joint angle,
the monkey started to right its posture and initiate reaching and grasping
movements, extending the freed fore-limb forward to attain the reward and to
eat it ad libitum. This suggests that the monkey’s CNS can rapidly select and
combine integrated subsets of posture- and locomotor-related neural control
mechanisms appropriate for the elaboration of a required task. Our animal
model thus provides a unique opportunity to compare the kinematics of Qp
and Bp locomotion in a single animal.
During the transitional period from Qp to Bp locomotion, the monkey
coordinated sequentially independent movements of multiple motor segments
such as eyes, head, neck, trunk, fore and hind-limbs, in order to satisfy the
dual purpose of freeing the forelimbs from the constraints of weight-bearing
and adopting Bp walking. The locomotion conversion process involved the
rapid and smooth succession of targeting, orienting, and righting. Targeting
requires the coordinated activity of head, neck, trunk and fore-limbs, and
righting that of head, neck, trunk and hind-limb. Kinematics of eye-head
position, body axis, and major joint angles of the hind-limbs revealed the
signiﬁcance of a hip maneuver strategy for the monkey’s conversion from
stable Qp to similarly stable Bp locomotion [17]. Each of these processes
includes visuo-motor and vestibulo-motor coordination. The latter is based
on interactions of vestibular information with sensory information arising
from SW and ST limbs and thus ensuring a good postural stability and
postural orientation over a wide range of environmental condition [18]. It is
conceivable that spinal reﬂexes play a crucial role in the coordination of SW
and ST limbs. According to Zehr and Stein, generally cutaneous reﬂexes act
to alter SW limb trajectory to avoid stumbling and falling. Stretch reﬂexes
act to stabilize limb trajectory and assist force production during ST. Load
receptor reﬂexes have an eﬀect on both ST phase body weight support and
step cycle timing [19].
We have previously proposed that the fastigial nucleus (FN) in the cere-
bellum is importantly involved in the initiation of Qp locomotion, and in ad-
dition in the rapid and smooth succession of targeting, orienting, and righting
necessary for the conversion from Qp to Bp walking [2, 17]. In a high decer-
ebrate cat, we have demonstrated that train-pulse microstimulation of the
hook bundle of Russell at its midline (cerebellar locomotor region, CLR),
through which the crossed fastigiofugal ﬁbers pass, evokes Qp locomotion on

58
S. Mori, F. Mori, K. Nakajima
the surface of a moving treadmill belt [20,21]. Descending fastigiofugal ﬁbers
projecting contralaterally include fastigio-RS, fastigio-VS, fastigiospinal and
fastigio-tecto-RS ﬁbers [2]. In both cats [4,22] and monkeys [23,24], command
signals related to righting and walking are mediated to the spinal cord by the
RS and VS pathways. Command signals carried by fastigiospinal pathway
contribute to the control of neck extensor muscles (targeting), whereas those
carried by fastigio-tecto-RS pathway contribute to the coordinated control of
head, neck, and body movements (orienting)[2]. Presumably, the command
signals descend in parallel from a number of interconnected CNS regions, and
the weighting function of each CNS site may vary depending on the external
and internal requirements for the execution and purpose of locomotion.
It is important to note that the FN is under the control of the cerebellar
vermis, to which visual, vestibular, prorpioceptive and exteroceptive aﬀerents
converge [25,26]. In the FN, there is an additional group of cells, which project
to the SMA and M1 via the fastigiothalamic projection [27]. These cells in
the FN may conceivably participate even in the volitional control aspect of
locomotion [2]. In Sherrington’s classic 1906 monograph he described interac-
tions between posture and movements as “posture follows movements like a
shadow” [3]. In parallel command signals arising from the FN will certainly
contribute to the control and integration of posture and locomotor-related
neuronal subsystems in the CNS.
4
Common and diﬀerent control properties of Qp and
Bp locomotion
During monkey’s Qp walking, there were periods in which the CoM was
supported by either three or two diagonal limbs. At treadmill speeds of 0.4
and 0.7 m/s, for example, the body mass was supported by the L fore-limb,
R hind-limb and R fore-limb when the monkey lifted the L hind-limb from
the treadmill belt initiating the ‘swing (SW) phase’. At treadmill speeds
of 1.0 and 1.3m/s, the body mass was supported mainly by the fore- and
hindlimbs on a diagonal axis. During this period, the two other diagonal
limbs were often lifted from the treadmill surface and were in ‘SW phase’.
With an increase in treadmill speed, the period of double support phase (ST
phase) by the diagonal limbs was shortened so that these two limbs promptly
initiated the next SW phase. In addition, the monkey considerably increased
‘stride length’ of the fore- and hind-limbs by increasing ‘mobile ranges’ of hip
joint angle. Such changes in the stride length were accompanied by marked
dorsi- and plantar ﬂexion of fore- and hind-limb’ toes during SW and ST
phases, respectively [28].
As during the human Bp walking, M. fuscata showed Bp walking charac-
terized by double and/or single support phases of the L and R hind-limbs.
During the SW phase of the L hind-limb, the weight of the body mass was
fully supported by the R hind-limb alone (single support phase). The stance

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
59
R hind-limb soon became the swing limb. However, ‘stride length’ of the
Bp hind-limbs was considerably shorter than that of Qp hind-limbs due to
kinematic reconﬁgurations of the hind-limbs, presumably related to biome-
chanical constraints of Bp standing. These included smaller mobile ranges
of the hip and ankle joints, and shorter ST phase. Interestingly, the proﬁle
of angular changes of the knee joint was similar for Qp and Bp locomotion,
except for a slight change at the ST phase. At faster speed of Bp walking, the
monkey inclined its body axis maximally during the period of double support
phase. Marked dorsi- and plantar ﬂexion of hind-limb toes were also observed
during SW and ST phases, respectively [28].
The SW and ST phases and step cycle frequency are interactive parame-
ters during Bp walking in the human [29]. In two adult monkeys, we compared
the changes in these interactive parameters during Qp and Bp walking as the
treadmill speeds were increased from 0.4 to 1.5 m/s. As forward speed in-
creased from 0.4 to 1.5 m/s, the average duration of the ST phase for the two
animals during Qp locomotion reduced from ∼0.9 to ∼0.4s, whereas the SW
phase remained at ∼0.3 s. The associated increase in step cycle frequency
was ∼0.9 to 1.5 Hz. During Bp locomotion, the corresponding changes were:
ST phase, 0.7 to 0.3; SW phase, constant at ∼0.2 s; and step cycle frequency,
∼1.1 to ∼2.0 Hz. These results show that M. fuscata increased the speed
of its trained Bp locomotion by an increase in the stepping frequency of the
hind-limbs whereas it increased the speed of its Qp locomotion by an increase
in the total excursion distance of the fore- and hind-limbs. Similar changes in
these interactive parameters suggest that our monkeys used the same overall
CNS strategy for both Qp and Bp locomotion.
5
Similarity and diﬀerence in the kinematics of lower
limbs during Bp walking between our monkey model
and the human
The bipedal striding gait is uniquely human, and is a most eﬃcient way
of moving overground [30]. With Bp walking overground, there is a heel-
strike at start of the ST phase and push-oﬀby the big toe at the end. The
hip joint extends steadily from approximately 160o at initial foot contact
to approximately 180o at the end of the ST phase, whereas the knee joint
shows initial ﬂexion (∼20o) and extension (∼15o) at mid-ST phase followed
by major ﬂexion (∼45o) at the latter half of this phase. The mobile ranges
of the hip and knee joints were estimated to be approximately 50o and 70o,
respectively [31]. In ﬁve species of non-human primates (chimpanzee, gibbon.
baboon, Japanese macaques and spider monkey) walking overground, Okada
found that, at foot contact, the joint angles of hip and knee operated in
mobile ranges far from a completely stretched position (i.e., 180o) [32]. Hip
extension was delayed until the latter half of the ST phase, and the knee
joint ﬂexed steadily from the beginning to the end of this phase. All the

60
S. Mori, F. Mori, K. Nakajima
non-human primates excepting the spider monkeys walked with a bent-hip,
bent-knee posture.
From the above ﬁndings, Okada suggested that the propulsive force which
carries the CoM forward is contributed largely by the movement of hip joint
during human Bp walking, whereas the knee joint has this function in the
non-trained, non-human primates [32]. In our trained adult monkey, the Bp
walking pattern was quite diﬀerent from the “bent-hip, bent-knee” walking
pattern. We have not observed, however, a heel-strike at the start of ST
phase but we found push-oﬀby the toes, probably including the big toe,
at the end of this phase. During Bp walking, the mobile ranges of hip and
knee joints were approximately 50o (∼120o−∼170o) and 60o (∼95o−∼155o),
respectively. The general pattern of hip extension and ﬂexion was comparable
to the pattern in Bp walking humans. It was also noteworthy that at mid-
ST phase, knee joint angle changed from a decrease (ﬂexion) to an increase
(extension). This ﬂexion and extension pattern was also comparable to that
in humans. Our results suggest that, for Bp walking, M. fuscata acquired a
new hip and ankle joint motion appropriate for the generation of propulsive
force in a fashion similar to that of the human.
Our suggestion has been reinforced by results related to anticipatory and
reactive control of Bp locomotion in the human [33,34]. To study the anticipa-
tory and reactive control capabilities of Bp walking monkey, it was necessary
to elicit walking on the treadmill belt on which a rectangular block was at-
tached as an obstacle (block height: 3, 5 or 7 cm) (14 and F Mori et al.,
in this volume). We have found that the monkey cleared the obstacle with
larger than usual ﬂexion of hip and knee joints so that the trailing hind-limb
produced enough clearance space over the obstacle while the leading limb
alone supported the weight of the body mass. Even before encountering the
obstacle, the monkey adopted this “hip and knee ﬂexion strategy” indicat-
ing the recruitment of “anticipatory control mechanisms”. The observed “hip
and knee ﬂexion strategy” in the monkey was essentially the same as that
in the human [33]. When it failed to clear the obstacle, the monkey adopted
a defensive posture to compensate for the perturbed posture, indicating the
recruitment of “reactive control mechanisms”.
6
Summary and discussion
In the study of Qp and Bp locomotion of non-human primates, most previ-
ous studies were by anthropologists and biologists seeking to elucidate their
kinematics and the relationships between morphology and species-speciﬁc
locomotor behavior. Recently, D’Aoˆut et al., studied kinesiological features
of bonobo (Pan panicus) walking, the extant great apes, because of their
phylogenetical and morphological similarities with early hominids [35]. They
compared spatio-temporal characteristics of natural Bp and Qp walking over-
ground, especially of hind-limb joint movements, and found that they diﬀer

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
61
strongly from the human patterns as characterized by “bent-hip, bent-knee”
walking. In relation to the heel, they found it was being lifted relative to the
toe tips throughout ST phase.
The control mechanisms of Bp human locomotion have been the sub-
ject of studies since Marey’s ﬁrst study in 1894 [36]. A series of photograph
was taken of human Bp walking by Muybridge [37]. Bernstein depicted stick
ﬁgures of body movements from such photographs [38]. Herman et al. mea-
sured angular displacement of the hip, knee and ankle joints during human Bp
walking and revealed a precise spatio-temporal ordering between them [29].
Nilsson and Thorstensson recorded three orthogonal ground reaction force
components in the weight bearing limbs during Bp walking and running, and
found complex interaction between the vertical and horizontal forces needed
for propulsion and equilibrium [39]. Patla studied and discussed the impor-
tance of visual information for “avoidance strategies” and “accommodation
strategies” related to planning and execution of changes in gait patterns when
safe travel is threatened [34]. For six species of anthropoid primates including
the human, Yamazaki calculated muscular forces acting at the joints during
Bp walking using computer simulation [40]. Using SPECT (Single Photon
Emission Computed Tomography), Fukuyama et al. identiﬁed several brain
regions where activity increased during Bp walking in human [41].
The change from Qp walking to Bp walking must have required a re-
design of the CNS along with reconﬁguration of the musculoskeletal system.
In Eccles’s 1989 monograph he mentioned that much of the evolution from
the simpler mammalian brains had already been accomplished in the higher
primates [30]. From an evolutional point of view, he also summarized sev-
eral anatomical changes speciﬁc to humans. These included elongation of the
hind-limb relative to the fore-limb; shortening and broadening of the pelvis;
reshaping of the foot; a forward curvature of the vertebral column in the lum-
bar region (lordosis) with a forward rotation of the iliac portion of the pelvis.
The movements of human Bp walking based on such anatomical changes
clearly demonstrate that there had been a transformation in the operation
of the neural machinery of the brain, but far fewer studies have been under-
taken from a movement neuroscience perspective, and our knowledge of the
neuronal machinery involved in Bp standing and/or Bp walking, and causal
relationships between CNS activity and the control mode of the multiple
motor segments is still inadequate.
Our group’s long-term goal is to elucidate CNS mechanisms in the non-
human primate that contribute to the control of Bp standing and Bp walking,
and especially of the adaptability of locomotor movements to meet the envi-
ronmental demands. This adaptability is one of the most important charac-
teristics of human Bp walking [34]. In this model animal, non-invasive studies
of the CNS and functional inactivation are feasible. Our preliminary study
using PET (Positron Emission Tomography) has already revealed that the
activity of the M1, SMA, visual cortex and the cerebellum increased in par-

62
S. Mori, F. Mori, K. Nakajima
allel, with some intriguing diﬀerences noted between Bp and Qp walking [42].
Inactivation of the M1 [43] and SMA by microinjection of muscimol into each
area [44] also resulted, respectively, in focal and general impairments of the
Bp standing and Bp walking. With the newly developed Bp walking monkey
model, we are now at the beginning of a long-term investigation to compare
and extrapolate such discovered mechanisms to those that might operate in
the human. We plan to continue such investigations on M. fuscata, in the
hope that our multi-disciplinary approach will help understanding “brain-
locomotor behavior” relationships by providing deﬁnitive information about
the role and operation of higher CNS structure in the integrated control of Bp
standing and Bp walking. Within this spectrum of experimental approaches,
there is a clear and important role for approaches that feature use of the
theory, modeling/simulation and techniques of system neuroscience.
Acknowledgments
The author expresses sincere appreciation to Dr. Edger Garcia-Rill for his
critical review and to Dr. D.G. Stuart for his editing of the original version
of this manuscript. This study was supported by: a Grant-in Aid for General
Scientiﬁc Research to S.M., from the Ministry of Education, Science, Sports,
Culture and Technology of Japan; and a Grant in Aid on Comprehensive
Research on Aging and Health to S.M. from the Ministry of Health and
Welfare of Japan.
References
1. McGraw, M. B. 1940. Neuromuscular development of the human infant as ex-
empliﬁed in the achievement of erect locomotion, J. Pediatrics 17:747–771.
2. Mori, S., Nakajima, K., Mori, F. 2003. Integration of multiple motor segments
for the elaboration of locomotion: the role of fastigial nucleus of the cerebellum.
Brain Mechanisms for the Integration of Posture and Movement. S. Mori, M.
Wiesendanger and D.G. Stuart Eds, Elsevier, Amsterdam, pp. 335–345.
3. Sherrington, C. S. 1906. The Integrative Action of the Nervous System, Yale
Univ. Press, Yale.
4. Mori, S. 1987. Integration of posture and locomotion in acute decerebrate cats
and in awake, freely moving cats. Prog. Neurobiol. 26:161–195.
5. Brodal, A. 1981. Neurological Anatomy in relation to Clinical Medicine, Oxford
Univ. Press, London.
6. Olivier, E., Edgley, S.A., Armand, J., and Lemon, R. 1997. An electrophysio-
logical study of the postnatal development of the corticospinal system in the
macaque monkey, J. Neurosci. 17:267–276.
7. Hildebrand. M., 1967. Symmetrical gaits of primates, Am. J. Phys. Anthropol.
26:119–130.
8. Brooks, V. B. 1986. The Neural Basis of Motor Control, Oxford Univ. Press.
Oxford.

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
63
9. Mori, S., Miyashita, E., Nakajima, K., and Asanome, M. 1996. Quadrupedal lo-
comotor movements in monkeys (M. fuscata) on a treadmill: kinematic analyses,
Neuroreport 7:2277–2285.
10. Mori, S., Matsuyama, K., Miyashita, E., Nakajima, K., and Asanome, M. 1996.
Basic neurophysiology of primate locomotion, Folia Primatol. 66:192–203.
11. Mori, F., Nakajima, K., Gantchev, N., Matsuyama, K., and Mori, S. 1999
A new model for the study of the neurobiology of bipedal locomotion: The
Japanese monkey, M. fuscata. From Basic Motor Control to Functional Recov-
ery, N. Gantchev and G.N. Gantchev Eds, Academic Publishing House, Soﬁa,
pp. 47–51.
12. Mori, F., Tachibana, A., Takasu, C., Nakajima, K., and Mori, S. 2001. Bipedal
locomotion by the normally quadrupedal Japanese monkey, M. fuscata: Strate-
gies for obstacle clearance and recovery from stumbling, Acta Physiol. Pharma-
col. Bulg. 26:147–150.
13. Tachibana, A., Mori, F., Boliek, C. A., Nakajima, K., Takasu, C., and Mori,
S. 2003. Acquisition of operant-trained bipedal locomotion in juvenile Japanese
monkeys (Macaca fuscata): a longitudinal study, Motor Control 7: 395–420.
14. Mori, F., Nakajima, K., Tachibana, A., Takasu, C., Mori, M., Tsujimoto, T.,
Tsukada, H., and Mori, S. 2003. Reactive and anticipatory control of posture
and bipedal locomotion in a non-human primate. Brain Mechanisms for the in-
tegration of Posture and Movement, S. Mori, M. Wiesendanger and D.G. Stuart
Eds, Elsevier, Amsterdam, pp. 191–198.
15. Massion, J. 1992. Movement, posture and equilibrium: interaction and coordi-
nation, Prog. Neurobiol. 38:35–56.
16. Grillner, S. 2003. The motor infrastructure: from ion channels to neuronal net-
work. Nature Rev. Neurosci. 4:573–586.
17. Nakajima, K., Mori, F., Takasu, C., Tachibana, A., Okumura, T., Mori, M.,
and Mori, S. 2001. Integration of upright posture and bipedal locomotion in
non-human primates. Sensorimotor Control, R. Dengler and A.R. Kossev Eds,
IOS Press, Amsterdam, pp. 95–102.
18. Horak, F.B., Mirka, A., and Shupert, C.L. 1989. The role of peripheral vestibu-
lar disorders in postural dyscontrol in the elderly. The Development of posture
and gait across the lifespan, A. Woollacott and A. Shumway-Cook Eds. Univ. of
South Carolina Press, Columbia. pp. 253–279.
19. Zehr,E.P., and Stein, R.B. 1999. What functions do reﬂexes serve during human
locomotion? Prog. Neurobiol. 58:185–205.
20. Mori, S., Matsui, T., Kuze, B., Asanome, M., Nakajima, K., and Matsuyama,
K. 1999. Stimulation of a restricted region in the midline cerebellar white matter
evokes coordinated quadrupedal locomotion in the decerebratre cat. J. Neuro-
physiol. 82:290–300.
21. Mori, S., Matsui, T., Mori, F., Nakajima,, K., and Matsuyama, K. 2000. Instiga-
tion and control of treadmill locomotion in high decerebrate cats by stimulation
of the hook bundle of Russell in the cerebellum, Can. J. Physiol. Pharmacol.
78:945–957.
22. Shik, M.L., and Orlovsky, G.N. 1976. Neurophysiology of locomotor automa-
tism. Physiol. Rev. 56: 465–501.
23. Lawrence, D. G., and Kuypers, H. G. J. M. 1968. The functional organization
of the motor system in the monkey. I. The eﬀects of bilateral pyramidal tract
lesion. Brain 91:1–14.

64
S. Mori, F. Mori, K. Nakajima
24. Lawrence, D. G., and Kuypers, H. G. J. M. 1968. The functional organization
of the motor system in the monkey. II. The eﬀects of lesions of the descending
brain-stem pathways. Brain 91:15–36
25. Arshavsky, Y. I., Gelfand, I. M., and Orlovsky, G. N. 1986. Cerebellum and
Rhythmical Movements. Springer-Verlag. Berlin.
26. Armstrong, D. M. 1986. Supraspinal contribution to the initiation and control
of locomotion in the cat. Prog. Neurobiol. 26:273–361.
27. Steriade, M. 1995. Two channels in the cerebellothalamocortical system. J.
Comp. Neurol. 354:57–70.
28. Nakajima, k., Mori, F., Takasu, C., Mori, M., Matsuyama, K., and Mori, S.
2003 Biomechanical constraints in hindlimb joints during the quadrupedal vs.
bipedal locomotion of M. fuscata. Brain Mechanisms for the Integration of Pos-
ture and Movement. S. Mori, M. Wiesendanger and D.G. Stuart Eds, Elsevier,
Amsterdam. pp. 183–190.
29. Herman, R. M., Wirta, R., Bampton, S., and Finley, F. R. 1976. Human so-
lutions for locomotion. I. Single limb analysis. Neural Control of Locomotion,
Advances in Behavioral Biology 18, R.M. Herman, S. Grillner, P.S.G. Stein and
D.G. Stuart Eds, Plenum Press, New York, pp.13–49.
30. Eccles, J. C. 1989. Evolution of the Brain: Creation of the Self, Routledge,
London and New York.
31. Kondo, S. 1985. Locomotor Analyses and human Bipedalism, Tokyo Univ. Press,
Tokyo.
32. Okada. M. 1985. Primate bipedal walking: Comparative kinematics. Primate
Morphophysiology, Locomotor Analyses and human Bipedalism, S. Kondo Ed,
Tokyo Univ. Press, Tokyo, pp. 47–58.
33. McFadyen, B. J., and Winter, D. A. 1991. Anticipatory locomotor adjustments
during obstructed human walking, Neurosci. Res. Commun. 9:37–44.
34. Patla. A. E. 1991, Visual control of human locomotion. Adaptability of Human
Gait, A.E. Patla Ed, Elsevier Science Publishers B.V. North-Holland. pp. 55–97.
35. D’Aoˆut, K., Aerts, P., De Clercq, D., De Meester, K., and Van Elsacker, L.
2002. Segment and joint angles of hind limb during bipedal and quadrupedal
walking of the Bonobo (Pan paniscuc). Am. J. Physical Anthropol. 119:37–51.
36. Marey, E. J. 1894. Le Movement, G. Masson, Paris.
37. Muybridge, E. 1957. Animals in Motion, Dover, New York.
38. Bernstein, N. 1967. The Co-ordination and Regulation of Movements. Perga-
mon Press. Oxford.
39. Nilsson, J., and Thorstensson, A. 1989. Ground reaction forces at diﬀerent
speeds of human walking and running, Acta Physiol. Scan. 136:217–227.
40. Yamazaki, N. 1985. Primate bipedal walking: Computer simulation. Primate
Morphophysiology, Locomotor Analyses and human Bipedalism, S. Kondo Ed,
Tokyo Univ. Press. Tokyo, pp. 105–130.
41. Fukuyama, H., Ouchi, Y., Matsuzaki, S., Nagahama, Y., Yamauchi, H., Ogawa,
M., Kimura, J., and Shibasaki, H. 1997. Brain functional activity during gait in
normal subject: a SPECT study. Neurosci. Lett. 228:183–186.
42. Mori, F, Nakajima, K., Tachibana, A., et al., 2002. “High-order CNS control
mechanisms during bipedal locomotion in the Japanese monkey,” Program No.
854.9, Abstract Viewer/Itinerary Planner, Washington, DC: Society for Neuro-
science, CD-ROM

Higher Nervous Control of Quadrupedal vs Bipedal Locomotion
65
43. Nakajima, K., Mori, F., Tachibana, A., Nambu, A., and Mori, S. 2003. Cortical
mechanisms for the control of bipedal locomotion in Japanese monkeys: I. Local
inactivation of the primary motor cortex (M1). Neurosci. Res. 46(suppl. 1):S156.
44. Mori, F., Nakajima, K., Tachibana, A., Nambu, A., and Mori, S. 2003. Cortical
mechanisms for the control of bipedal locomotion in Japanese monkeys: II. Local
inactivation of the supplementary motor area (SMA). Neurosci. Res. 46(suppl.
1):S157.

Part 2
Adaptive Mechanics

Interactions between Motions of the Trunk
and the Angle of Attack of the Forelimbs in
Synchronous Gaits of the Pika (Ochotona
rufescens)
Remi Hackert1, Hartmut Witte1,2 and Martin S. Fischer1
1 Institut f¨ur Spezielle Zoologie und Evolutionsbiologie,
Friedrich-Schiller-Universit¨at Jena, Erbertstraße 1, D-07743 Jena, Germany,
Remi.Hackert@animals-in-motion.com
2 Fachgebiet Biomechatronik, Technische Universit¨at Ilmenau, Pf 100565,
D-98684 Ilmenau, Hartmut.Witte@tu-ilmenau.de
Abstract. During half-bound gait on a treadmill pikas (Ochotona rufescens: Lago-
morpha) show a preference in the choice of the trailing limb (“handedness”). Du-
ration of steps shows signiﬁcantly higher variation in the trailing limb than in the
leading limb. This observation motivated calculations of the position of the center of
mass (CoM) in the body frame of the pika during half-bound cycles. CoM is aligned
with ﬁrst of the ulna of the trailing and second of the leading limb during major
parts of the forelimbs‘ stance phase. Referring to our large cineradiographic data
base on the kinematics of the legs we could note that the horizontal motion of the
CoM in the body is mainly determined by ﬂexion and extension of the back. This
observation underlines the determinant role of the trunk as the main engine for fast
locomotion. Using high-speed video ﬁlms we measured the angle of attack (deﬁned
as the angle between the ulna and the ground at touch down). We couldn’t observe
any signiﬁcant change with speed during half-bound, indicating the important role
of self-stabilising mechanisms on the choice of kinematics.
Fig. 1. Pika (Ochotona rufescens) in half-bound. Cineradiography with 150 fps. Six
events during one motion cycle in time intervals of 25 ms are shown. The hindlimbs
move synchronously, while the forelimb show a phase diﬀerence (leading vs. trailing
limb). Please note especially the ﬂexion of the spine.

70
R. Hackert, H. Witte, M. S. Fischer
1
Introduction
Synchronous gaits, where the feet within a pair of fore- or hindlimbs touch the
ground with only slight time diﬀerences, gain growing interest in robotics. In
comparison to the machines using symmetrical gaits (where feet are placed in
diagonals - deﬁnition of gaits cf. Hildebrand 1965, 1977), programming work
is simpliﬁed considerably. In the extreme case, the Buehler hopper shows a
pure “bound“, with no phase diﬀerence within each pair of legs. Animals
are as well able to produce a pure bound (e. g. “bouncing“ goats), but the
common synchronous locomotor mode of small (and ancestral) mammals is
“half-bound“. The hindlimbs are moved synchronously, while the forelimbs
show a ﬂuctuating phase lag. The leg which touches the ground ﬁrst is called
“trailing limb“, the other one shows the greater cranial excursion and thus is
called the (spatially) “leading limb“ (ﬁg. 1).
We performed analyses on four male pikas (Ochotona rufescens: Lagomor-
pha), small tailless mammals living in the steppes of central Asia. They own
body weights of 150-200 g, crown-rump-lengths of 140 mm and heights of the
CoM over ground of 45 mm. Kinematics have been described in detail in [4].
Pikas are performing half-bound at speeds between 1.2 m/s and 2.4 m/s.
2
Preliminiary question: do pikas prefer one forelimb
as trailing limb?
We ﬁlmed the animals in lateral view with a high speed video system (Micromac R⃝
Camsys R⃝+ Zoom lenses Fujinon R⃝2,0/12.5-75.5 mm) at 500 Hz. The dura-
tion of each session accounted for about one hour. The pikas ran 30 seconds
and were ﬁlmed 15 seconds at each sequenc followed by a recreation period of
3 minutes. Speed was staged between 1.2 m/s and 2.2 m/ with a step width
of about 0.1 m/s. The eﬀective treadmill speed was controlled via tracking
the movements of markers disposed along the treadmill belt. The results of
the experiment clearly indicate that pikas systematically prefer one of their
forelimbs as the trailing one (ﬁg. 2). With increasing speed this preference be-
comes more evident but the diﬀerences between medium and fast half-bound
not always were signiﬁcant.
The step duration of a pika is described by a decreasing power like func-
tion of speed (Fischer and Lehmann, 1998). In the range of half-bound speed,
this function may be linearized (cf. ﬁg. 3). At very high speeds
(> 1.75 m/sec), in the individuals under study here we noted that the stan-
dard deviation of the step duration measured from touch-down of the leading
limb to the next touch-down was signiﬁcantly smaller than the standard de-
viation of the step duration measured for the trailing limb.
These results indicate that even in animals using their “hands” (fore feet)
for running a handedness exists, which even in a small group of animals
shows diﬀerences between individuals what concerns the preferred side. May

Interactions between Motions of the Trunk and the Angle of Attack
71
this be an indicator of a body side speciﬁc specialization of the extremities (in
mechanical performance and/or control), even without profound knowledge
about the bases of this eﬀect it indicates that “the” motion scheme of “the”
pika does not exist – in so far pikas are real individuals.
Fig. 2. The four individuals under study systematically preferred one of their fore-
limbs for the ﬁrst touch down in a motion cycle of half-bound (trailing forelimb).
Fig. 3. Step duration of the pika (Ochotona rufescens) in half-bound. At speeds >
1.75 m/sec, the S.D. of the step duration is signiﬁcantly higher (p < 0.05) for the
leading limb than that for the trailing limb. At each speed n = 20 motion cycles
were analysed.

72
R. Hackert, H. Witte, M. S. Fischer
3
Trajectories of the centre of mass of pikas in
half-bound gait
3.1
Method: Videoradiography.
The animals were ﬁlmed at a frequency of 1,000 fps, half-bounding on a
treadmill at a speed of 2.0 m/s. At this speed, the step frequency is about 8
cycles per second. At 1,000 fps the high speed cameras provide a resolution of
256 x 64 pixels. The treadmills belt is twice as wide as a pika’s body width.
One camera was used to ﬁlm the pikas from the lateral side (the ground
appears to be a line on the screen). To control the permanence of speed, this
lateral zoom-camera was adjusted with the maximal focus length (75 mm)
in such a way that the picture just covered the length of the animal when
it was maximally extended. A second camera documented the front view, to
ensure that the pika was running straight forward.
3.2
Method: Digitization
To control the eﬀects of optical distorsion, a reference grid (mesh width 10 ±
0.05 mm, steel balls of 1 ± 0.01 mm in diameter) was ﬁlmed and served as a
control for linearization means. The outline of the body was digitised in the
global frame with 35 points alternately distributed on the dorsal and on the
ventral border of the sagittal projection of the animal. Limb segments were
incorporated into the body shape proximally of the elbow and knee joints.
The background of the picture (grid of the Faraday‘s cage of our laboratory)
was ﬁlled with vertical lines spaced approx. 1 cm. We took advantage from
these lines to get an equal distribution of the digitisation points along the
body contour. 90% of the animal’s mass is included in this digitised area.
The number of points used for digitising the body outline arose to be a
good compromise between the needs for the binding line between two even
following points to stay near to the contour line and the wish to limit the
expense for the digitising work.
3.3
Method: Weighing of triangle segments of trunk elements
The distribution of the points on the body outline deﬁned a series of triangles,
the areas and centers of which were computed from their corner coordinates.
To take account of the mass distribution, we weighed a series of 14 transversal
slices of a pika cadaver frozen in its extended position (ﬁg. 4). These values
were the base for the computational weight distribution onto the triangles.
We thus implicitely neglected the eﬀect of oscillating masses, or seen the
other way round, since the thickness of the zone deﬁned by the base of the
triangle is about 1 cm, this means that the masses have been considered to
oscillate locallly in this volume.

Interactions between Motions of the Trunk and the Angle of Attack
73
3.4
Results
Motion of the center of mass in the body:
• The CoM is located underneath the lung base. It is closer to the ventral
outline than to the dorsal one (40:60) (ﬁg. 4).
• The position of the center of mass relatively to the nose (which is a
representative for the rather unaccelerated head) is not constant. The
horizontal excursion of the CoM is in ﬁxed phase coupling with the motion
of the back. During spinal extension, which takes place during the stance
phase of the hindlimbs, and at the beginning of the forelimbs’ stance phase
the CoM moves in the cranio-caudal direction. During spinal bending the
CoM moves in the caudo-cranial direction. This excursion equals about
10 % of the animals’ length (ﬁg. 5).
Fig. 4. Left: Mass distribution of the trunk of a pika (Ochotona rufescens) including
the upper arm (proximally of the elbow joint) and the thigh. Right: position of the
center of mass at touch down of the forelimbs (extended back) and of the hindlimbs
(bended back). The radius of the circle corresponds to the strength of the interval
of conﬁdence.
Vertical motions of the CoM in the global frame:
• The amplitude of the motion of the CoM at 2 m/sec accounts for about
6 mm (10% of the animal’s height) (ﬁg. 5).
• During the extension of the back the CoM globally moves down, during
the bending of the back it globally moves up (ﬁg. 5).
• The pattern of the CoM vertical motion has more than two extrema.

74
R. Hackert, H. Witte, M. S. Fischer
Fig. 5. Motions of the CoM during half-bound of a pika (Ochotona rufescens).
Left: horizontal excursions relative to the nose
Right: Vertical excursions with corresponding footfall patterns
Position of the CoM relative to the forelimbs.
• The angle wrist-elbow-CoM of the trailing forelimb is about 180˚ during
that part of its stance phase when no other ground contacts exist (ﬁg. 6).
• After the leading forelimb touches the ground, the weight is transferred
to it: the alignment CoM-trailing ulna decreases while the alignment with
the leading ulna becomes almost complete.
4
Does the angle of attack couple with speed?
The angle of attack is deﬁned as the angle formed by the connection line of
CoM and the ground contact point versus ground. To quantify the variation
of the angle of attack with speed we took advantage of the above described ef-
fect that at touch down of the trailing limb the ulna points is in the direction
of the CoM. The orientation of the ulna does not coincide exactly with the
direction deﬁned by the connection line of the ground contact point (under-
neath the metatarso-phalangial joint) and the CoM. This error is systematic
and accounts for + 5˚.
4.1
Methods
The high speed X-Ray camera accessible to us provided 150 fps. This frame
rate is insuﬃcient to determine signiﬁcant values for the angle of attack, since
a pika at observation speed may run up to 8 cycles per second. Consecutively
we shaved the forelimbs of a pika and ﬁlmed the half-bounding animal on the
treadmill with the high speed video system (500 fps, resolution of 256x256
pixels).
The camera ﬁeld was adjusted to cover one pika length. This enables a
rigorous control of pika speed.

Interactions between Motions of the Trunk and the Angle of Attack
75
4.2
Results
1. The angle of attack does not variate strongly with increasing speed (ﬁg.7).
2. The angle ulna/ground equals about 50˚, consecutively the angle of at-
tack is about 45˚.
Fig. 6. The angle wrist-elbow-CoM of the trailing forelimb is about 180˚ during
that part of its stance phase when no other ground contacts exist. During late mid
stance the leading forelimb takes over and its ulna points to the CoM. Alignment of
the shank (kinematically eqivalent to the upper arm) mainly occurs during aerial
phases.
5
Conclusions
The small mammal’s limb is a four segmented ﬂexed structure, which may be
compared to a pantograph [5]. It eﬀectively allows for compensation of small
irregularities of the ground. It also plays the role of a spring-damper system
as the pika runs or trots. The occurance of elastic phenomena during legged
locomotion is commonly accepted in biology (cf. [6], [7], [8] and succeeding
publications). The movement of the human CoM during running may be
described using spring-mass models [9] [10]. The vertical excursion of the
CoM of a half-bounding pika (about 5-6 mm) relatively to the leg length
(70 mm) is quite comparable to the excursion of the CoM in human running
(about 10 %) [11]. From this point of view (in addition to many others), it
also seems promising to extend these templates to quadrupedal locomotion

76
R. Hackert, H. Witte, M. S. Fischer
Fig. 7. Variations of the angle ulna/ground with speed are small. The right scale
gives the number of steps N used to calculate the mean values and the standard
deviations.
[12]. In humans the spring-leg and the mass (CoM) are well aligned. The
above described results indicate, that the common linear spring-point mass
model may as well be applied to the situation in the pika’s forelimbs. In
the hindlimbs, the consideration of the mass extension of the trunk seems
inevitable. The variation of the CoM height found in this study is very similar
to that for the dog derived from numerical integration of ground reaction
forces by Cavagna et al. [7]. In that case the vertical displacement of the CoM
over time showed more than two extrema. McMahon & Cheng [13] calculated
how the angle of attack of a spring-mass system deﬁned as the angle which
minimized the maximum of the force during the stance phase variates as a
function of the horizontal and vertical velocity. The variation of this angle
with horizontal velocity also is small (about 7˚). The reasons for an almost
constancy of this angle still are poorly understood as far as the dynamics of
locomotion is concerned, but perhaps may ﬁnd an explanation by the results
of further studies on the dynamic stability of quadrupedal locomotion.
Our study shows that the motion of the trunk is a determinant factor in
the motion of the CoM. The model of a rigid body that jumps from one limb
to the other is not able to explain the variety of the pattern of vertical motions
of CoM provoked by running locomotor modes. Bending of the back is not a
passive bending due to inertia of the back. For robotics the Raibert idea of
minimizing dissipative energy ﬂows in combination with the usage of “intelli-
gent“, self-stabilising mechanics with minimal neuronal/computational con-
trol eﬀort is attractive. Understanding of motion systems evolutively tested
for longer periods in this context may be a promising directive.

Interactions between Motions of the Trunk and the Angle of Attack
77
Acknowledgments
We thank Prof. R. Blickhan, who kindly provided us access to the high speed
camera system. Dr. D. Haarhaus invested his ecxperience in a multitude of
cineradiographic experiments.
References
1. Hildebrand M.(1965): Symmetrical gaits of horses. – Science 150: 701-708.
2. Hildebrand M.(1977): Analysis of asymmetrical gaits. – J Mamm 58(2 ): 131-156.
3. Jenkins F.A.(1971): Limb posture and locomotion in the Virginia opossum
(Didelphis marsupialis) and other non-cursorial mammals. J Zool (Lond) 165:
303-315.
4. Fischer M.S. & Lehmann R.(1998): Application of cineradiography for the metric
and kinematic study of in-phase gaits during locomotion of the pika (Ochotona
rufescens, Mammalia: Lagomorpha). - Zoology 101: 12-37.
5. MS Fischer & H Witte (1998): The functional morphology of the three-
segmented limb of mammals and its specialities in small and medium-sized
mammals. Proc Europ Mechanics Coll Euromech 375 Biology and Technology
of Walking: 10–17.
6. Cavagna G.A., Saibene & Margaria (1964) Mechanical work in running - J Appl
Physiol 19(2) 249-256.
7. Cavagna G.A., Heglund N.C. & Taylor C.R. (1977): Mechanical work in terres-
trial locomotion: two basic mechanisms for minimizing energy expenditure. - Am
J Physiol 233: 243-2.
8. McMahon T.A.(1985): The role of compliance in mammalian running gaits. - J
exp Biol 115: 263-282.
9. Bernstein N.A.(1967): The coordination and regulation of movements. Perga-
mon, London.
10. Blickhan R.(1989): The spring-mass model for running and hopping. - J
Biomech 22(11/12): 1217-1227.
11. Lee C.R., Farley C. (1998): Determinant of the center of mass in human walking
and running. - J exp Biol 201(pt 21): 2935-2944.
12. Full R.J., Koditschek D.E.(1999): Templates and anchors: neuromechanical hy-
potheses of legged locomotion on land. – J exp Biol 202(Pt 23), 3325–3332.
13. McMahon T.A. & Cheng G.C. (1990): The mechanics of running: how does
stiﬀness couple with speed? – J Biomech 23 (Suppl. 1): 65-78.

On the Dynamics of Bounding and Extensions:
Towards the Half-Bound and Gallop Gaits
Ioannis Poulakakis, James Andrew Smith, and Martin Buehler
Ambulatory Robotics Laboratory, Centre for Intelligent Machines,
McGill University, Montr´eal QC H3A 2A7, Canada
Abstract. This paper examines how simple control laws stabilize complex running
behaviors such as bounding. First, we discuss the unexpectedly diﬀerent local and
global forward speed versus touchdown angle relationships in the self-stabilized
Spring Loaded Inverted Pendulum. Then we show that, even for a more complex
energy conserving unactuated quadrupedal model, many bounding motions exist,
which can be locally open loop stable! The success of simple bounding controllers
motivated the use of similar control laws for asymmetric gaits resulting in the ﬁrst
experimental implementations of the half-bound and the rotary gallop on Scout II.
1
Introduction
Many mobile robotic applications might beneﬁt from the improved mobil-
ity and versatility of legs. Twenty years ago, Raibert set the stage with his
groundbreaking work on dynamically stable legged robots by introducing a
simple and highly eﬀective three-part controller for stabilizing running on
his one-, two-, and four-legged robots, [9]. Other research showed that even
simpler control laws, which do not require task level or body state feedback,
can stabilize running as well, [1]. Previous work on the Scout II quadruped
(Fig. 1) showed that open loop control laws simply positioning the legs at a
desired touchdown angle, result in stable running at speeds over 1 m/s, [12].
Fig. 1. Scout II: A simple four-legged robot.
Motivated by experiments on cockroaches (death-head cockroach, Blaber-
ous discoidalis), Kubow and Full studied the role of the mechanical sys-
tem in control by developing a simple two-dimensional hexapedal model, [5].
The model included no equivalent of nervous feedback and it was found to

80
I. Poulakakis, J. A. Smith, M. Buehler
be inherently stable. This work ﬁrst revealed the signiﬁcance of mechanical
feedback in simplifying neural control. Full and Koditschek set a foundation
for a systematic study of legged locomotion by introducing the concepts of
templates and anchors, [2]. To study the basic properties of sagittal plane
running, the Spring Loaded Inverted Pendulum (SLIP) template has been
proposed, which describes running in animals that diﬀer in skeletal type, leg
number and posture, [2]. Seyfarth et al., [11], and Ghigliazza et al., [3], found
that for certain leg touchdown angles, the SLIP becomes self-stabilized if the
leg stiﬀness is properly adjusted and a minimum running speed is exceeded.
In this paper, we ﬁrst describe some interesting aspects of the relation-
ship between forward speed and leg touchdown angles in the self-stabilized
SLIP. Next, we attempt to provide an explanation for simple control laws
being adequate in stabilizing complex tasks such as bounding, based on a
simple sagittal “template” model. Passively generated cyclic bounding mo-
tions are identiﬁed and a regime where the system is self-stabilized is also
found. Furthermore, motivated by the success of simple control laws to gen-
erating bounding running, we extended the bounding controller presented in
[12] to allow for asymmetric three- and four-beat gaits. The half-bound, [4],
and the rotary gallop [4,10], expand our robots’ gait repertoire, by introduc-
ing an asymmetry to the bound, in the form of the leading and trailing legs.
To the authors’ best knowledge this is the ﬁrst implementation of both the
half-bound and the gallop in a robot.
2
Bounding experiments with Scout II
Scout II (Fig. 1) has been designed for power-autonomous operation. One of
its most important features is that it uses a single actuator per leg. Thus,
each leg has two degrees of freedom (DOF): the actuated revolute hip DOF,
and the passive linear compliant leg DOF.
In the bound gait the essential components of the motion take place in
the sagittal plane. In [12] we propose a controller, which results in fast and
robust bounding running with forward speeds up to 1.3 m/s, without body
state feedback. The controller is based on two individual, independent front
and back virtual leg controllers. The front and back virtual legs each detect
two leg states - stance and ﬂight. During ﬂight, the controller servoes the
ﬂight leg to a desired, ﬁxed, touchdown angle. During stance the leg is swept
back with a constant commanded torque until a sweep limit is reached. Note
that the actual applied torque during stance is determined primarily by the
motor’s torque-speed limits, [12]. The sequence of the phases of the resulting
bounding gait is given in Fig. 2.
Scout II is an underactuated, highly nonlinear, intermittent dynamic sys-
tem. The limited ability in applying hip torques due to actuator and friction
constraints and due to unilateral ground forces further increases the complex-
ity. Furthermore, as Full and Koditschek state in [2], “locomotion results from

On the Dynamics of Bounding and Extensions
81
complex high-dimensional, dynamically coupled interaction between an or-
ganism and its environment”. Thus, the task itself is complex too, and cannot
be speciﬁed via reference trajectories. Despite this complexity, simple control
laws, like the one described above and in [12], can stabilize periodic motions,
resulting in robust and fast running without requiring any task level feedback
like forward velocity. Moreover, they do not require body state feedback.
Fig. 2. Bounding phases and events.
It is therefore natural to ask why such a complex system can accomplish
such a complex task without intense control action. As outlined in this paper,
and in more detail in [7,8], a possible answer is that Scout II’s unactuated,
conservative dynamics already exhibit stable bounding cycles, and hence a
simple controller is all that is needed for keeping the robot bounding.
3
Self-stabilization in the SLIP
The existence of passivelly stable gaits in the conservative, unactuated SLIP,
discussed in [3,11], is a celebrated result that suggests the signiﬁcance of the
mechanical system in control as was ﬁrst pointed out by Kubow and Full in
[5]. However, the mechanism that results in self-stabilization is not yet fully
understood, at least in a way that could immediately be applicable to improve
existing control algorithms. It is known that for a set of initial conditions
(forward speed and apex height), there exists a touchdown angle at which
the system maintains its initial forward speed, see Fig. 3 (left). As Raibert
noticed, [9], if these conditions are perturbed, for example, by decreasing the
touchdown angle, then the system will accelerate in the ﬁrst step, and, if the
touchdown angle is kept constant, it will also accelerate in the subsequent
steps and ﬁnally fall due to toe stubbing. However, when the parameters are
within the self-stabilization regime, the system does not fall! It converges to
a periodic motion with symmetric stance phases and higher forward speeds.
This fact is not captured in Raibert’s linear steady-state argument, [9], based
on which one would be unable to predict self-stabilization of the system.
A question we address next is what is the relationship between the forward
speed at which the system converges i.e. the speed at convergence, and the
touchdown angle. To this end, simulation runs have been performed in which

82
I. Poulakakis, J. A. Smith, M. Buehler
the initial apex height and initial forward velocity are ﬁxed, thus the energy
level is ﬁxed, while the touchdown angle changes in a range where cyclic
motion is achieved. For a given energy level, this results in a curve relating the
speed at convergence to the touchdown angle. Subsequently, the apex height
is kept constant, while the initial forward velocity varies between 5 and 7 m/s.
This results in a family of constant energy curves, which are plotted in Fig.
3 (right). It is interesting to see in Fig. 3 that in the self-stabilizing regime
of the SLIP, an increase in the touchdown angle at constant energy results in
a lower forward speed at convergence. This means that higher steady state
forward speeds can be accommodated by smaller touchdown angles, which,
at ﬁrst glance, is not in agreement with the global behavior that higher speeds
require bigger (ﬂatter) touchdown angles and is evident in Fig. 3 (right).
Fig. 3. Left: Symmetric stance phase in the SLIP. Right: Forward speed at conver-
gence versus touchdown angle at ﬁxed points obtained for initial forward speeds 5
to 7 m/s and apex height equal to 1 m (l0 =1 m, k =20 kN/m and m =1 kg).
The fact that globally ﬁxed points at higher speeds require greater (ﬂatter)
touchdown angles was reported by Raibert and it was used to control the
speed of his robots based on a feedback control law, [9]. However, Fig. 3 (right)
suggests that in the absence of control and for constant energy, reducing the
touchdown angle results in an increase of the speed at convergence. Thus,
one must be careful not to transfer results from systems actively stabilized to
passive systems, because otherwise opposite outcomes from those expected
may result. Note also that there might exist parameter values resulting in a
local behavior opposite to that in Fig. 3, illustrating that direct application
of the above results in designing intuitive controllers is not trivial.
4
Modeling the Bounding Gait
In this section the passive dynamics of Scout II in bounding is studied based
on the template model shown in Fig. 4 and conditions allowing steady state
cyclic motion are determined.

On the Dynamics of Bounding and Extensions
83
Assuming that the legs are massless and treating toes in contact with the
ground as frictionless pin joints, the equations of motion for each phase are
d
dt
q
˙q

=

˙q
−M−1 (Fel + G)

,
(1)
where q = [xy θ]T (Fig. 4), M, is the mass matrix and Fel, G are the vectors
of the elastic and gravitational forces, respectively. The transition conditions
between phases corresponding to touchdown and lift-oﬀevents are
y ± L sin θ ≤l0 cos γtd
i , li ≤l0,
(2)
where i = b, f for the back (- in (2)) and front (+ in (2)) leg respectively.
Fig. 4. A template for studying sagittal plane running.
To study the bounding cycle of Fig. 2 a return map is deﬁned using the
apex height in the double leg ﬂight phase as a reference point. The states at
the nth apex height constitute the initial conditions for the cycle, based on
which we integrate successively the dynamic equations of all the phases. This
process yields the state vector at the (n+1)th apex height, which is the value
of the return map P : ℜ4 × ℜ2 →ℜ4 calculated at the nth apex height, i.e.
xn+1 = P(xn, un),
(3)
with x = [y θ ˙x ˙θ]T , u = [γtd
b γtd
f ]T ; the touchdown angles are control inputs.
We seek conditions that result in cyclic motion and correspond to ﬁxed
points ¯x of P, which can be determined by solving x −P(x) = 0 for all
the (experimentally) reasonable touchdown angles. The search space is 4-
dimensional with two free parameters and the search is conducted using the
Newton-Raphson method. An initial guess, x⟨0⟩
n , for a ﬁxed point is updated
by
x⟨k+1⟩
n
= x⟨k⟩
n
+

I −∇P

x⟨k⟩
n
−1 
P

x⟨k⟩
n

−x⟨k⟩
n

,
(4)
where n corresponds to the nth apex height and k to the number of iterations.
Evaluation of (4) until convergence (the error between x⟨k⟩
n
and x⟨k+1⟩
n
is
smaller than 1e−6) yields the solution. To calculate P at x⟨k⟩
n , we numerically
integrate (1) for each phase using the adaptive step Dormand-Price method
with 1e −6 and 1e −7 relative and absolute tolerances, respectively.

84
I. Poulakakis, J. A. Smith, M. Buehler
Implementation of (4) resulted in a large number of ﬁxed points of P,
for diﬀerent initial guesses and touchdown angles, which exhibited some very
useful properties, [7,8]. For instance, the pitch angle was found to be always
zero at the apex height. More importantly, the following condition was found
to be true for all the ﬁxed points calculated randomly using (4)
γtd
f = −γlo
b , γtd
b = −γlo
f .
(5)
It is important to mention that this property resembles the case of the SLIP,
in which the condition for ﬁxed points is the lift-oﬀangle to be equal to the
negative of the touchdown angle (symmetric stance phase), [3].
It is desired to ﬁnd ﬁxed points at speciﬁc forward speeds and apex
heights. Therefore, the search scheme described above is modiﬁed so that
the forward speed and apex height become its input parameters, speciﬁed
according to running requirements, while the touchdown angles are now con-
sidered to be “states” of the search procedure, i.e. variables to be determined
from it, [7,8]. Thus, the search space states and the “inputs” to the search
scheme are x∗= [θ ˙θ γtd
b γtd
f ]T and u∗= [y ˙x]T , respectively.
Fig. 5 illustrates that for 1 m/s forward speed, 0.35 m apex height and
varying pitch rate there is a continuum of ﬁxed points, which follows an “eye”
pattern accompanied by two external branches. The existence of the external
branch implies that there is a range of pitch rates where two diﬀerent ﬁxed
points exist for the same forward speed, apex height and pitch rate. This
is surprising since the same total energy and the same distribution of that
energy among the three modes of the motion -forward, vertical and pitch-
can result in two diﬀerent motions depending on the touchdown angles. Fixed
points that lie on the internal branch correspond to a bounding motion where
the front leg is brought in front of the torso, while ﬁxed points that lie on
the external branch correspond to a motion where the front leg is brought
towards the torso’s Center of Mass (COM), see Fig. 5 (right).
Fig. 5. Left: Fixed points for 1m/s forward speed and 0.35 m apex height. Right:
Snapshots showing the corresponding motions.

On the Dynamics of Bounding and Extensions
85
5
Local stability of passive bounding
The fact that bounding cycles can be generated passively as a response to the
appropriate initial conditions may have signiﬁcant implications for control.
Indeed, if the system remains close to its passive behavior, then the actuators
have less work to do to maintain the motion and energy eﬃciency, an impor-
tant issue to any mobile robot, is improved. Most importantly there might
exist operating regimes where the system is passively stable, thus active sta-
bilization will require less control eﬀort and sensing. The local stability of
the ﬁxed points found in the previous section is now examined. A periodic
solution corresponding to a ﬁxed point ¯x is stable if all the eigenvalues of the
matrix A = ∂P(x, u)/∂x|x=¯x have magnitude less than one.
Fig. 6 (left) shows the eigenvalues of A for forward speed 1 m/s, apex
height 0.35 m and varying pitch rate, ˙θ. The four eigenvalues start at dark
reqions (small ˙θ), move along the directions of the arrows and converge to the
points marked with “x” located in the brighter regions (large ˙θ) of the root
locus. One of the eigenvalues (#1) is always located at one, reﬂecting the
conservative nature of the system. Two of the eigenvalues (#2 and #3) start
on the real axis and as ˙θ increases they move towards each other, they meet
inside the unit circle and then move towards its rim. The fourth eigenvalue
(#4) starts at a high value and moves towards the unit circle but it never
gets into it, for those speciﬁc values of forward speed and apex height. Thus,
the system cannot be passively stable for these parameter values.
To illustrate how the forward speed aﬀects stability we present Fig. 6
(right), which shows the magnitude of the larger eigenvalue (#4) at two dif-
ferent forward speeds. For suﬃciently high forward speeds and pitch rates,
the larger eigenvalue enters the unit circle while the other eigenvalues remain
well behaved. Therefore, there exists a regime where the system can be pas-
sively stable. This is a very important result since it shows that the system
can tolerate perturbations of the nominal conditions without any control ac-
tion taken! This fact could provide a possible explanation to why Scout II can
bound without the need of complex state feedback controllers. It is important
to mention that this result is in agreement with recent research from biome-
chanics, which shows that when animals run at high speeds, passive dynamic
self-stabilization from a feed-forward, tuned mechanical system can reject
rapid perturbations and simplify control, [2,3,5,11]. Analogous behavior has
been discovered by McGeer in his passive bipedal running work, [6].
6
The half-bound and rotary gallop gaits
This section describes the half-bound and rotary gallop extensions to the
bound gait. The controllers for both these gaits are generalizations of the
original bounding controller, allowing two asymmetric states to be observed
in the front lateral leg pair and adding control methods for these new states.
In the half-bound and rotary gallop controllers the lateral leg pair state
machine adds two new asymmetric states: the left leg can be in ﬂight while the

86
I. Poulakakis, J. A. Smith, M. Buehler
Fig. 6. Left: Root locus showing the paths of the four eigenvalues as the pitch rate,
˙θ, increases. Right: Largest eigenvalue norm at various pitch rates and for forward
speeds 1.5 and 4m/s. The apex height is 0.35 m.
right leg is in stance, and vice versa. In the regular bounding state machine
these asymmetric states are ignored and state transitions only occur when
the lateral leg pair is in the same state: either both in stance or both in ﬂight.
The control action associated with the asymmetric states enforces a phase
diﬀerence between the two legs during each leg’s ﬂight phase, but is otherwise
unchanged from the bounding controller as presented in [12].
The following describes the front leg control actions. Leg 1 (left) touches
down before Leg 3 (right):
Case 1: Leg 1 and Leg 3 in ﬂight. Leg 1 is actuated to a touchdown
angle (17o, with respect to the body’s vertical). Leg 3 is actuated to a larger
touchdown angle (32o) to enforce separate touchdown times.
Case 2: Leg 1 and Leg 3 in stance. Constant commanded torques until 0o.
Case 3: Leg 1 in stance, Leg 3 in ﬂight. Leg 1 is commanded as in Case 2
and Leg 3 as in Case 1.
Case 4: Leg 1 in ﬂight, Leg 3 in stance. Leg 1 is commanded as in Case 1
and Leg 3 as in Case 2.
Application of the half-bound controller results in the motion shown in
Fig. 7; the front legs are actuated to the two separate touchdown angles and
maintain an out-of-phase relationship during stance, while the back two legs
have virtually no angular phase diﬀerence at any point during the motion.
Application of the rotary gallop controller results in the motion in Fig. 8; the
front and back leg pairs are actuated to out-of-phase touchdown angles (Leg
1: 17o, Leg 3: 32o, Leg 4: 17o, Leg 2: 32o).
Fig. 9 (left) illustrates the half-bound footfall pattern. The motion sta-
bilizes approximately one second after it begins (at 132 s), without back leg
phase diﬀerence. Fig. 9 (right) shows the four-beat footfall pattern for the
rotary gallop. The major diﬀerence between both the bound and the half-

On the Dynamics of Bounding and Extensions
87
bound controllers and the gallop controller is that a phase diﬀerence of 15o
(Leg 4: 17o; Leg 2: 32o) is enforced between the two back legs during the
double-ﬂight phase. It must be mentioned here that although the half-bound
and the rotary gallop gaits have been studied in biological systems [4], to the
authors’ best knowledge this is the ﬁrst implementation on a robot.
Fig. 7. Left: Snapshots of Scout II during the half bound: back legs (#2,4) in
stance, front left leg (#1) touchdown, front right leg (#3) touchdown, and back
legs (#2,4) touchdown. Right: Leg angles in the half-bound.
Fig. 8. Snapshots of Scout II during the rotary gallop: All legs in ﬂight, ﬁrst front leg
(#1) touchdown, second front leg (#3) touchdown, ﬁrst back leg (#4) touchdown
and second back leg (#2) touchdown. Right: Leg angles in the rotary gallop.
Fig. 9. Stance phases (shaded) for the half-bound (left) and rotary gallop (right).

88
I. Poulakakis, J. A. Smith, M. Buehler
7
Conclusion
This paper examined the diﬀerence between the local and global forward
speed versus touchdown angle relationships in the self-stabilized SLIP. It
then showed that a more complex model for quadruped sagittal plane run-
ning can exhibit passively generated bounding cycles under appropriate ini-
tial conditions. Most strikingly, under some initial conditions the model was
found to be self-stable! This might explain why simple controllers as those
in [12], are adequate in stabilizing a complex dynamic task like running.
Self-stabilization can facilitate the control design for dynamic legged robots.
Furthermore, preliminary experimental results of the half-bound and rotary
gallop running gaits have been presented. Future work includes the applica-
tion of asymmetric gaits to improving maneuverability on Scout II.
Acknowledgments
Support by IRIS III and by NSERC is gratefully acknowledged. The work of
I. Poulakakis has been supported by a R. Tomlinson Doctoral Fellowship and
by the Greville Smith McGill Major Scholarship.
References
1. Buehler M. 2002. Dynamic Locomotion with One, Four and Six-Legged Robots.
J. of the Robotics Society of Japan 20(3):15-20.
2. Full R. J. and Koditschek D. 1999. Templates and Anchors: Neuromechanical
Hypotheses of Legged Locomotion on Land. J. Exp. Biol. 202:3325-3332.
3. Ghigliazza R. M., Altendorfer R., Holmes P. and Koditschek D. E. 2003. A Sim-
ply Stabilized Running Model. SIAM J. on Applied Dynamical Systems 2(2):187-
218.
4. Hildebrand M. 1977. Analysis of Asymmetrical Gaits. J. of Mammalogy
58(31):131-156.
5. Kubow T. and Full R. 1999. The Role of the Mechanical System in Control: A
Hypothesis of Self-stabilization in Hexapedal Runners. Phil. Trans. R. Soc. of
Lond. Biological Sciences 354(1385):854-862.
6. McGeer T. 1989. Passive Bipedal Running. Technical Report, CSS-IS TR 89-02,
Centre For Systems Science, Burnaby, BC, Canada.
7. Poulakakis I. 2002. On the Passive Dynamics of Quadrupedal Running. M. Eng.
Thesis, McGill University, Montr´eal, QC, Canada.
8. Poulakakis I., Papadopoulos E., Buehler M. 2003. On the Stable Passive Dynam-
ics of Quadrupedal Running. Proc. IEEE Int. Conf. on Robotics and Automation
(1):1368-1373.
9. Raibert M. H. 1986. Legged Robots That Balance. MIT Press, Cambridge MA.
10. Schmiedeler J.P. and Waldron K.J. 1999. The Mechanics of Quadrupedal
Galloping and the Future of Legged Vehicles. Int. J. of Robotics Research
18(12):1224-1234.
11. Seyfarth A., Geyer H., Guenther M. and Blickhan R. 2002. A Movement Cri-
terion for Running, J. of Biomechanics 35:649-655.
12. Talebi S., Poulakakis I., Papadopoulos E. and Buehler M. 2001. Quadruped
Robot Running with a Bounding Gait. Experimental Robotics VII, D. Rus and
S. Singh (Eds.), pp. 281-289, Springer-Verlag.

Part 3
Machine Design and Control

Jumping, Walking, Dancing, Reaching:
Moving into the Future. Design Principles for
Adaptive Motion
Rolf Pfeifer
Artiﬁcial Intelligence Laboratory, Department of Information Technology,
University of Zurich, Andreasstrasse 15, CH-8050 Zurich, Switzerland.
pfeifer@iﬁ.unizh.ch, phone: +41 1 63 5 4320/31, fax: +41 1 635 68 09,
http://www.iﬁ.unizh.ch/∼pfeifer
Abstract. Designing for adaptive motion is still largely considered an art. In recent
years, we have been developing a set of heuristics or design principles, that on the
one hand capture theoretical insights about adaptive systems, and on the other
provide guidance in actually designing and building adaptive systems. In this paper
we discuss, in particular, the principle of “ecological balance” which is about the
relation between morphology, materials, and control. As we will argue, artiﬁcial
evolution together with morphogenesis is not only “nice to have” but turns out to
be a necessary design tool for adaptive motion.
1
Introduction
The ﬁeld of adaptive systems, as loosely characterized by conferences such as
SAB (Simulation of Adaptive Behavior), AMAM (Adaptive Motion in An-
imals and Machines), Artiﬁcial Life, etc., is very heterogeneous and there
is a deﬁnite lack of consensus on the theoretical foundations. As a conse-
quence, agent design is – typically – performed in an ad hoc and intuitive
way. Although there have been some attempts at elaborating principles, gen-
eral agreement is still lacking. In addition, much of the work on designing
adaptive systems is focused on the programming of the robots. But what we
are really interested is in designing entire systems. The research conducted in
our laboratory, but also by many others, has demonstrated that often, bet-
ter, cheaper, more robust and adaptive agents can be developed if the entire
agent is the design target rather than the program only. This implies taking
embodiment into account and going beyond the programming level proper.
Therefore we prefer to use the term “engineering agents for adaptive motion”
rather than “programming agents”.
If this idea of engineering agents is the goal, the question arises what form
the theory should have, i.e. how the experience gained so far can be captured
in a concise scientiﬁc way. The obvious candidate is the mathematical theory
of dynamical systems, and there seem to be many indications that ultimately
this may be the tool of choice for formulating a theory of intelligence. For the
time being, it seems that progress over the last few years in the ﬁeld has been

92
Rolf Pfeifer
slow, and we may be well-advised to search for an intermediate solution for
the time being. The form of design principles seems well-suited for a number
of reasons. First, at least at the moment, there don’t seem to be any real
alternatives. The information processing paradigm, another potential candi-
date, has proven ill-suited to come to grips with natural, adaptive forms of
intelligence. Second, because of the unﬁnished status of the theory, a set of
principles is ﬂexible and can be dynamically changed and extended. Third,
design principles represent heuristics for actually building systems. In this
sense, they instantiate the synthetic methodology (see below). And fourth,
evolution can also be seen as a designer, a “blind one” perhaps, but an ex-
tremely powerful one. We hope to convince the reader that this is a good
idea, and that some will take it up, modify the principles, add new ones, and
try to make the entire set more comprehensive and coherent. The response
so far has been highly encouraging and researchers as well as educated lay
people seem to be able to relate to these principles very easily.
A ﬁrst version of the design principles was published at the 1996 con-
ference on Simulation of Adaptive Behavior (SAB 1996, “From Animals to
Animats”) (Pfeifer, 1996). A more elaborate version has been published in the
book “Understanding Intelligence” (Pfeifer and Scheier, 1999). More recently,
some principles have been extended to incorporate ideas on the relation be-
tween morphology, materials, and control (Ishiguro et al., this volume; Hara
and Pfeifer, 2000a; Pfeifer, 2003).
Although most of the literature is still about programming, some of the
research explicitly deals with complete agent design and includes aspects
of morphology (e.g. Bongard, 2002; Bongard and Pfeifer, 2001; Hara and
Pfeifer, 2000a; Lipson and Pollack, 1999; Pfeifer, 1996; Pfeifer and Scheier,
1999; Pfeifer, 2003). Our own approach over the six years or so has been
to try and systematize the insights gained in the ﬁelds of adaptive behavior
and adaptive motion by incorporating ideas from biology, psychology, neuro-
science, engineering, and artiﬁcial intelligence into a set of design principles
(Pfeifer, 1996; Pfeifer and Scheier, 1999); they form the main topic of this
paper.
We start by giving a very short overview of the principles. We then pick
out and discuss in detail “ecological balance” and provide a number of ex-
amples for illustration. We then show how artiﬁcial evolution together with
morphogenesis can be employed to design ecologically balanced systems. It
is clear that these considerations are only applicable to embodied systems.
This is not a technical paper but a conceptual one. The goal is to provide
a framework within which technical research can be conducted that takes
into account the most recent insights in the ﬁeld. In this sense, the paper has
somewhat of a tutorial and overview ﬂavor and should be viewed as such.

Jumping, Walking, Dancing, Reaching: Moving into the Future
93
2
Design principles: overview
There are diﬀerent types of design principles: Some are concerned with the
general “philosophy” of the approach. We call them “design procedure prin-
ciples”, as they do not directly pertain to the design of the agents but more
to the way of proceeding. Another set of principles is concerned more with
the actual design of the agent. We use the qualiﬁer “more” to express the
fact that we are often not designing the agent directly but rather the initial
conditions and the learning and developmental processes or the evolutionary
mechanisms and the encoding in the genome as we will elaborate later. The
current over will, for reasons of space, be very brief; a more extended version
is in preparation (Pfeifer and Glatzeder, in preparation).
Table 1. Overview of the design principles.

94
Rolf Pfeifer
2.1
P-Princ 1: The synthetic methodology principle.
The synthetic methodology, “understanding by building” implies on the one
hand constructing a model of some phenomenon of interest (e.g. how an insect
walks, how a monkey is grasping a banana). On the other we want to abstract
general principles.
2.2
P-Princ 2: The principle of emergence.
The term emergence is controversial, but we use it in a very pragmatic way,
in the sense of not being preprogrammed. When designing for emergence, the
ﬁnal structure of the agent is the result of the history of its interaction with
the environment. Strictly speaking, behavior is always emergent,; it is always
the result of a system-environment interaction. In this sense, emergence is
not all or none, but a matter of degree: the further removed from the actual
behavior the designer commitments are made, the more we call the resulting
behavior emergent.
2.3
P-Princ 3: The diversity-compliance principle.
Intelligent agents are characterized by the fact that they are on the one hand
exploiting the speciﬁcs of the ecological niche and on the other by behavioral
diversity. In a conversation I have to comply with the rules of grammar of
the particular language, and then I have to react to what the other individ-
ual says, and depending on that, I have to say something diﬀerent. Always
uttering one and the same sentence irrespective of what the other is saying
would not demonstrate great behavioral diversity.
2.4
P-Princ 4: The time perspectives principle.
A comprehensive explanation of behavior of any system must incorporate at
least three perspectives: (a) state-oriented, the “here and now”, (b) learning
and development, the ontogenetic view, and (c) evolutionary, the phylogenetic
perspective. The fact that these perspectives are adopted by no means implies
that they are separate. On the contrary, they are tightly intertwined, but it
is useful to tease them apart for the purpose of scientiﬁc investigation.
2.5
P-Princ 5: The frame-of-reference principle.
There are three aspects to distinguish whenever designing an agent: (a) the
perspective, i.e. are we talking about the world from the agent’s perspec-
tive, the one of the observer, or the designer; (b) behavior is not reducible
to internal mechanism; trying to do that would constitute a category error;
and (c) apparently complex behavior of an agent does not imply complex-
ity of the underlying mechanism. Although it seems obvious that the world

Jumping, Walking, Dancing, Reaching: Moving into the Future
95
“looks” very diﬀerent to a robot than to a human because the robot has
completely diﬀerent sensory systems, this fact is surprisingly often ignored.
Second, behavior cannot be completely programmed, but is always the result
of a system-environment interaction. Again, it is surprising how often this
obvious fact is ignored even by roboticists.
2.6
A-Princ 1: The three-constituents principle.
This very often ignored principle states that whenever designing an agent we
have to consider three components. (a) the deﬁnition of the ecological niche
(the environment), (b) the desired behaviors and tasks, and (c) the agent
itself. The main point of this principle is that it would be a fundamental mis-
take to design the agent in isolation. This is particularly important because
much can be gained by exploiting the physical and social environment.
2.7
A-Princ 2: The complete agent principle.
The agents of interest are autonomous, self-suﬃcient, embodied and situ-
ated. This view, although extremely powerful and obvious, is not very often
considered explicitly.
2.8
A-Princ 3: The principle of parallel, loosely coupled
processes.
Intelligence is emergent from an agent-environment interaction based on a
large number of parallel, loosely coupled processes that run asynchronously
and are connected to the agent’s sensory-motor apparatus. The term “loosely
coupled” is used in contrast to hierarchically coupled processes where there
is a program calling a subroutine and the calling program has to wait for
the subroutine to complete its task before it can continue. In that sense, this
hierarchical control corresponds to very strong coupling.
2.9
A-Princ 4: The principle of sensory-motor coordination
All intelligent behavior (e.g., categorization, memory) is to be conceived as
a sensory-motor coordination. This sensory-motor coordination, in addition
to enabling the agent to interact eﬃciently with the environment, serves the
purpose of structuring its sensory input. One implication is that the problem
of categorization in the real world is greatly simpliﬁed through the interaction
with the environment because of the generation of “good” (correlated, and
stationary) patterns of sensory stimulation.

96
Rolf Pfeifer
2.10
A-Princ 5: The principle of cheap design.
Designs must be parsimonious, and exploit the physics and the constraints of
the ecological niche. This principle is related to the diversity compliance prin-
ciple in that it implies, for example, compliance with the laws of physics(e.g.,
robots with wheels that exploit the fact that the ground is mostly ﬂat).
2.11
A-Princ 6: The redundancy principle.
Agents should be designed such that there is an overlap of functionality of
the diﬀerent subsystems. For example, the visual and the haptic systems
both deliver spatial information, but they are based on diﬀerent physical
processes (electromagnetic waves vs. mechanical touch). Merely duplicating
components does not lead to very interesting redundancy; the partial overlap
of functionality and the diﬀerent physical processes are essential. If there is
a haptic system in addition to the visual one, the system can also function
in complete dark, whereas one with 10 cameras ceases to function if the light
goes out.
2.12
A-Princ 7: The principle of ecological balance.
This principle consists of two parts, the ﬁrst one concerns the relation be-
tween the sensory system, the motor system, and the neural control. The
“complexity” of the agent has to match the complexity of the task envi-
ronment, in particular: given a certain task environment, there has to be a
match in the complexity of the sensory, motor, and neural system. The sec-
ond is about the relation between morphology, materials, and control: Given
a particular task environment, there is a certain balance or task distribution
between morphology, materials, and control (for references to both ideas, see,
e.g. Hara and Pfeifer, 2000a; Pfeifer, 1996; Pfeifer, 1999, 2000; Pfeifer and
Scheier, 1999). Because we are dealing with embodied systems, there will be
two dynamics, the physical one or body dynamics and the control or neural
dynamics. There is the deep and important question of how the two can be
coupled in optimal ways. The research initiated by Ishiguro and his colleagues
(e.g. Ishiguro et al., 2003) promises deep and important pertinent insights.
2.13
A-Princ 8: The value principle.
This principle is, in essence, about motivation. It is about why the agent
does anything in the ﬁrst place. Moreover, a value system tells the agent
whether an action was good or bad, and depending on the result, the prob-
ability of repetition of an action will be increased or decreased. Because of
the unknowns in the real world, learning must be based on mechanisms of
self-organization. The issue of value systems is central to agent design and

Jumping, Walking, Dancing, Reaching: Moving into the Future
97
must be somehow resolved. However, it seems that to date no generally ac-
cepted solutions have been developed. Research on artiﬁcial motivation and
emotion, is highly relevant in this context (e.g. Breazeal, 2002; Manzotti,
2000; Picard, 1997; Pfeifer, 2000b).
Although it does capture some of the essential characteristics of adaptive
systems, this set is by no means complete. A set of principles for designing evo-
lutionary systems and collective systems, are currently under development.
As mentioned earlier, all these principles only hold for embodied systems. In
this paper, we focus on the principle of ecological balance which is at the
heart of embodiment.
3
Information theoretic implications of embodiment
There is a trivial meaning of embodiment namely that “intelligence requires
a body”. In this sense, anyone using robots for his or her research is doing
embodied artiﬁcial intelligence and have to take into account gravity, fric-
tion, torques, inertia, energy dissipation, etc. However, there is a non-trivial
meaning, namely that there is a tight interplay between the physical and the
information theoretic aspects of an agent. The design principles all directly
or indirectly refer to this issue, but some focus on this interplay, i.e. the prin-
ciple of sensory-motor coordination where through the embodied interaction
with the environment sensory-motor patterns are induced, the principle of
cheap design where the proper embodiment leads to simpler and more robust
control, the redundancy principle which states that proper choice and posi-
tioning of sensors leads to robust behavior, and the principle of ecological
balance that explicitly capitalizes on the relation between morphology, mate-
rials, and neural control. For the purpose of illustration we will capitalize on
the latter in this paper. We proceed by presenting a number of case studies
illustrating the application of these principles to designing adaptive motion.
In previous papers we have investigated in detail the eﬀect of changing sensor
morphology on neural processing (e.g. Lichtensteiger and Eggenberger, 1999;
Maris and te Boekhorst, 1996; Pfeifer, 2000a, b; Pfeifer and Scheier, 1999).
In this paper we focus on the motor system.
3.1
The passive dynamic walker
The passive dynamic walker which goes back to McGeer (1990a, b), illustrated
in ﬁgure 1a, is a robot (or, if you like, a mechanical device) capable of walking
down an incline, there are no motors and there is no microprocessor on the
robot; it is brainless, so to speak. In order to achieve this task the passive
dynamics of the robot, its body and its limbs, must be exploited (the robot
is equipped with wide feet of a particular shape to guide lateral motion, soft
heels to reduce instability at heel strike, counter-swinging arms to negate yaw
induced by leg swinging, and lateral-swinging arms to stabilize side-to-side

98
Rolf Pfeifer
lean (Collins et al., 2001)). This kind of walking is very energy eﬃcient (the
robot is – loosely speaking – operated near one of its Eigenfrequencies) and
there is an intrinsic naturalness to it (perhaps the natural feel comes from
the exploitation of the dynamics, e.g. the passive swing of the leg.). However,
its “ecological niche” (i.e. the environment in which the robot is capable of
operating) is extremely narrow: it only consists of inclines of certain angles.
A diﬀerent approach has been taken by the Honda design team. There the
goal was to have a robot that could perform a large number of diﬀerent types
of movements. The methodology was to record human movements and then
to reproduce them on the robot which leads to a relatively natural behavior
of the robot. On the other hand control – or the neural processing, if you like
– is extremely complex and there is no exploitation of the intrinsic dynamics
as in the case of the passive dynamic walker. The implication is also that the
movement is not energy eﬃcient. Of course, the Honda robot can do many
things like walking up and down the stairs, pushing a cart, opening a door,
etc., whereas the ecological niche of the passive dynamic walker is conﬁned
to inclines of a particular angle.
Fig. 1. Two approaches to robot building. (a) The passive dynamic walker (Collins
et al., 2001), (b) the Honda robot Asimo.
In term of the design principles, this case study illustrates the principles
of cheap design and ecological balance. The passive dynamic walker fully
exploits the fact that it is always put on inclines that provide its energy
source and generates the proper dynamics for walking. Loosely speaking, we

Jumping, Walking, Dancing, Reaching: Moving into the Future
99
can also say that the control tasks, the neural processing, is taken over by
having the proper morphology and the right materials. In fact, the neural
processing reduces to zero. At the same time, energy eﬃciency is achieved.
However, if anything is changed, e.g. the angle of the incline, the agent ceases
to function. This is the trade-oﬀof cheap design. In conclusion, as suggested
by the principle of ecological balance, there is a kind of trade-oﬀor balance:
the better the exploitation of the dynamics, the simpler the control, the less
neural processing will be required.
3.2
Muscles – control from materials: reaching and grasping
Let us pursue this idea of exploiting the dynamics a little further and show
how it can be taken into account to design actual robots. Most robot arms
available today work with rigid materials and electrical motors. Natural arms,
by contrast, are built of muscles, tendons, ligaments, and bones, materials
that are non-rigid to varying degrees. All these materials have their own in-
trinsic properties like mass, stiﬀness, elasticity, viscosity, temporal character-
istics, damping, and contraction ratio to mention but a few. These properties
are all exploited in interesting ways in natural systems. For example, there
is a natural position for a human arm which is determined by its anatomy
and by these properties. Reaching for and grasping an object like a cup with
the right hand is normally done with the palm facing left, but could also be
done – with considerable additional eﬀort – the other way around. Assume
now that the palm of your right hand is facing right and you let go. Your arm
will immediately turn back into its natural position. This is not achieved by
neural control but by the properties of the muscle-tendon system: On the one
hand the system acts like a spring – the more you stretch it, the more force
you have to apply and if you let go the spring moves back into its resting
position. On the other there is intrinsic damping. Normally reaching equilib-
rium position and damping is conceived of in terms of electronic (or neural)
control, whereas in this case, this is achieved (mostly) through the material
properties. Or put diﬀerently, the morphology (the anatomy), and the mate-
rials provide physical constraints that make the control problem much easier.
The main task of the brain, if you like, is to set the material properties of the
muscles, the spring constants. Once these constraints are given, the control
task is much simpler.
These ideas can be transferred to robots. Many researchers have started
building artiﬁcial muscles (for reviews of the various technologies see, e.g.,
Kornbluh et al., 1998 and Shahinpoor, 2000) and used them on robots, as
illustrated in ﬁgure 2.
Facial expressions also provide an interesting illustration for the point to
be made here. If the facial tissue has the right sorts of material properties
in terms of elasticity, deformability, stiﬀness, etc., the neural control for the
facial expressions becomes much simpler. For example, for smiling, although

100
Rolf Pfeifer
Fig. 2. Robots with artiﬁcial muscles. (a) The service robot ISAC by Peters (Van-
derbilt University) driven by McKibben pneumatic actuators. (b) The humanoid
robot Cog by Rodney Brooks (MIT AI Laboratory), driven by series-elastic actua-
tors. (c) The artiﬁcial hand by Lee and Shimoyama (University of Tokyo), driven by
pneumatic actuators. (d) The “Face Robot” by Kobayashi, Hara, and Iida (Science
University of Tokyo), driven by shape-memory alloys.
it involves the entire face, the actuation is very simple: the “complexity” is
added by the tissue properties.
3.3
The dancing robot Stumpy – a synthesis
Figure 3 shows the walking and hopping robot Stumpy which lower body is
made of an inverted “T” mounted on wide springy feet. The upper body is
an upright “T” connected to the lower body by a rotary joint, the “waist”
joint, providing one degree of freedom in the frontal plane. The horizontal
beam on the top is weighted on the ends to increase its moment of inertia.

Jumping, Walking, Dancing, Reaching: Moving into the Future
101
Fig. 3. The dancing, walking, and hopping robot Stumpy. (a) Photograph of the
robot. (b) Schematic drawing (details, see text).
It is connected to the vertical beam by a second rotary joint, providing one
rotational degree of freedom, in the plane normal to the vertical beam, the
“shoulder” joint. Stumpy’s vertical axis is made of aluminum, while both its
horizontal axes and feet are made of oak wood. Although Stumpy has no real
legs or feet, it can locomote in many interesting ways: it can move forward in
a straight or curved line, it has diﬀerent gait patterns, it can move sideways,
and it can turn on the spot. Interestingly, this can all be achieved by actuating
only two joints with one degree of freedom – the robot is virtually “brainless”.
The reason this works is because the dynamics, given by its morphology and
its materials (elastic, spring-like materials, surface properties of the feet), is
exploited in clever ways. There is a delicate interplay of momentum exerted
on the feet by moving the two joints in particular ways (for more detail, see
Paul et al., 2002a, b).
Let us brieﬂy summarize the ideas concerning ecological balance. First,
given a particular task environment, the (physical) dynamics of the agent can
be exploited which leads not only to a natural behavior of the agent, but also
to higher energy-eﬃciency. Second, by exploiting the dynamics of the agent,
often control can be signiﬁcantly simpliﬁed while maintaining a certain level
behavioral diversity. Third, materials have intrinsic control properties. And
fourth, because ecological balance is exploited, Stumpy displays a surprisingly
diverse behavior (dancing walking, and hopping in diﬀerent ways). In this
sense, Stumpy also illustrates the diversity-compliance principle: on the one
hand, it exploits the physical dynamics in interesting ways and on the other
it displays high diversity.
In section 2 we postulated a set of design principles for adaptive motion.
The principle of ecological balance, for example, tells us that given a particu-

102
Rolf Pfeifer
lar task environment, there is an optimal task distribution between morphol-
ogy, materials, and control. The principle of emergence asks the question of
how a particular “balance” has emerged, how it has come about. In the study
of biological systems, we can speculate about this question. However, there
is a possibility of systematically investigating this balance, namely artiﬁcial
evolution and morphogenesis. Pertinent experiments promise a deeper under-
standing of these relationships. The remainder of this paper will be devoted
to this question.
4
Exploring “ecological balance”—artiﬁcial evolution
and morphogenesis
The standard approach for using artiﬁcial evolution for design is to take a
particular robot and use a genetic algorithm to evolve a control architecture
for a particular task.The problem with including morphology and materials
into our evolutionary algorithms is that the search space which is already
very large for control architectures only, literally explodes.
This issue can be approached in various ways, we just mention two. The
ﬁrst is to parameterize the shapes, thus bringing in biases from the designer
on the types of shapes that are possible. An example that has stirred a lot of
commotion in the media recently is provided by Hod Lipson and Jordan Pol-
lack’s robots that were automatically produced (Lipson and Pollack, 2000).
While this example is impressive, it still implies a strong designer bias. If
we want to explore diﬀerent types of morphologies, we want to introduce as
little designer bias as possible. This can be done using ideas from biology, i.e.
genetic regulatory networks.
4.1
The mechanics of artiﬁcial genetic regulatory networks
The basic idea is the following. A genetic algorithm is extended to include
ontogenetic development by growing agents from genetic regulatory networks.
In the example presented here, agents are tested for how far they can push a
large block (which is why they are called “block pushers”). Figure 4a shows
the physically realistic virtual environment. The ﬁtness determination is a
two-stage process: the agent is ﬁrst grown and then evaluated in its virtual
environment. Figure 4b illustrates how an agent grows from a single cell into
a multicellular organism, (for details, see, e.g. Bongard and Pfeifer (2001; in
press)).
4.2
Emergence – the achievements of artiﬁcial evolution and
morphogenesis.
Here are some observations: (1) Organisms early on in evolution are typically
smaller than those of later generations: evolution discovers that in order to

Jumping, Walking, Dancing, Reaching: Moving into the Future
103
Fig. 4. Examples of Bongard’s “block pushers”. (a) An evolved agent in its phys-
ically realistic virtual environment. (b) growth phase starting from a single cell,
showing various intermediate stages (last agent after 500 time steps).
push a block of large size, it is necessary to have a large body. (2) Evolu-
tion comes up with means of locomotion. In small creatures, these are very
local reﬂex-like mechanisms distributed through the entire organism. Larger
creatures tend to have additional tentacles that can be used to push against
the block, which requires a diﬀerent kind of control. (3) There is no direct

104
Rolf Pfeifer
relation between genotype length and phenotypic ﬁtness – the two are largely
dissociated. (4) There is functional specialization, i.e. cells diﬀerentiate into
units containing both sensors and actuators (the white colored cells in ﬁg-
ure 4), cells that only contain sensors but no actuators (gray coloring), and
cells not containing anything, only providing structural support (black col-
oring). (5) There is repeated structure, i.e. some combination of cells occur
in slightly modiﬁed form in various places on the agent. An example from
biology are ﬁngers that are similar but diﬀer individually. (6) Some genes
specialize to become “master regulatory genes”, i.e. they regulate the activ-
ity of other genes. Thus, to an outside observer, it looks as if a hierarchical
structure were evolving in the regulatory network. Note that this hierarchy
is emergent and results from a “ﬂat” dynamical system. Thus, it can change
at a later point in time, unlike “structural” hierarchies. It is important to
mention that this has all been “discovered” by simulated evolution and has
not been programmed into the system.
5
Discussion and conclusions
By employing the form of design principles we have attempted to make a
ﬁrst step in the direction of providing a coherent framework for design. In
the present form we have proposed the principles and argued why they are
plausible. The passive dynamic walker and Stumpy provide illustrations of
the principles of cheap design and ecological balance.
While this is acceptable and interesting, the design principles would be
much more compelling and powerful if they could be demonstrated to emerge
from an evolutionary process. Using the principles of genetic regulatory net-
works, we have worked out methods by which entire agents can be evolved,
including their morphology, their material properties, and their control sys-
tems.
There are a number of limitations of this approach that we will put on
the research agenda for the coming years. One is the incorporation of in-
teraction with the environment during ontogenetic development. Moreover,
the “rewrite rules” for neuronal growth will be replaced by more biologi-
cal mechanisms. Third, instead of deﬁning a ﬁtness function, we will turn
to “open-ended evolution” where the survival of the individual is the sole
criterion. This requires the deﬁnition of pertinent resources that need to be
maintained. Fourth, we need to incorporate the variation of material prop-
erties into the evolutionary algorithm, so that this aspect can be studied as
well. And last but not least, we need to be able to increase the complexity of
our task environments which requires much higher computational power.
Let us conclude by raising an issue that is always in the air when working
with relatively simple systems (such as block pushers), the one of scalabil-
ity. By scalability we mean in this context whether the methods proposed
(genetic regulatory networks) will be suﬃciently powerful to evolve much

Jumping, Walking, Dancing, Reaching: Moving into the Future
105
more complex creatures capable of many behaviors in very diﬀerent types
of environments. This question, we believe is still open as it is not clear to
what extent the real world plays an essential role in evolution, or whether
simulated environments can be made suﬃciently complex.
Acknowledgements
I would like to thank the members of the Artiﬁcial Intelligence Laboratory for
many discussions, in particular Josh Bongard for his patience in explaining
evolution to me and Gabriel G´omez for discussing the manuscript. Credit also
goes to the Swiss National Science Foundation for supporting the research
presented in this paper, grant # 20-61372.00.
References
1. Breazeal, C.L. (2002). Designing Sociable Robots (Intelligent Robotics and Au-
tonomous Agents). Cambridge, Mass.: MIT Press.
2. Bongard, J.C. (2002). Evolving modular genetic regulatory networks. In Proc.
IEEE 2002 Congress on Evolutionary Computation (CEC2002). MIT Press,
305-311.
3. Bongard, J.C., and Pfeifer, R. (2001). Repeated structure and dissociation of
genotypic and phenotypic complexity in artiﬁcial ontogeny. In L. Spector et al.
(eds.). Proc. of the Sixth European Conference on Artiﬁcial Life, 401-412.
4. Collins, S.H., Wisse, M., and Ruina, A. (2001). A three-dimensional passive-
dynamic walking robot with two legs and knees. The International Journal of
Robotics Research, 20, 607-615.
5. Ishiguro, A., Ishimaru, K., Hayakawa, K., and Kawakatsu, T. (2003). Toward
a “well-balanced” design: a robotic case study. How should control and body
dynamics be coupled? This volume.
6. Hara, F., and Pfeifer, R. (2000). On the relation among morphology, material
and control in morpho-functional machines. In Meyer, Berthoz, Floreano, Roit-
blat, and Wilson (eds.): From Animals to Animats 6. Proceedings of the sixth
International Conference on Simulation of Adaptive Behavior 2000, 33-40.
7. Kornbluh, R. D., Pelrine, R., Eckerle, J., and Joseph, J. (1998). Electrostric-
tive polymer artiﬁcial muscle actuators. Proceedings of the IEEE International
Conference on Robotics and Automation 1998. New York, N.Y.: IEEE, 2147-
2154.
8. Lipson, H., and Pollack J. B. (2000), Automatic design and manufacture of
artiﬁcial life forms. Nature, 406, 974-978.
9. Lichtensteiger, L., and Eggenberger, P. (1999). Evolving the morphology of
a compound eye on a robot. Proceedings of the third European Workshop
on Advanced Mobile Robots (Eurobot’99). IEEE, Piscataway, NJ, USA; 1999;
127-34 .
10. Manzotti,
R.
(2000).
Intentional
robots.
The
design
of
a
goal-seeking
environment-driven agent. Unpublished Doctoral Dissertation, University of
Genova.

106
Rolf Pfeifer
11. Maris, M., and te Boekhorst, R. (1996). Exploiting physical constraints: heap
formation through behavioral error in a group of robots. Proceedings of the
IROS’96, IEEE/RSJ International Conference on Intelligent Robots and Sys-
tems, 1655—1660.
12. McGeer, T. (1990a). Passive dynamic walking. Int. Journal of Robotics Re-
search, 9, 62-82.
13. McGeer, T. (1990b). Passive walking with knees. Proc. of the IEEE Conference
on Robotics and Automation, 2, 1640-1645.
14. Paul, C., Dravid, R. and F. Iida (2002a) Control of lateral bounding for a
pendulum driven hopping robot. to appear in Proceedings of the International
Conference of Climbing and Walking Robots , Paris, France (to appear)..
15. Paul, C., Dravid, R. and F. Iida (2002b) Design and Control of a Pendulum
Driven Hopping Robot. Proc of the IEEE/RSJ International Conference on In-
telligent Robots and Systems, IROS-2002, Lausanne, Switzerland (to appear).
16. Pfeifer, R. (1996). Building “Fungus Eaters”: Design principles of autonomous
agents. In P. Maes, M. Mataric, J.-A. Meyer, J. Pollack, and S.W. Wilson
(eds.): From Animals to Animats 4. Proceedings of the fourth International.
Conference on Simulation of Adaptive Behavior. Cambridge, Mass.: A Bradford
Book, MIT Press, 3-12.
17. Pfeifer, R. (1999). Dynamics, morphology, and materials in the emergence of
cognition. In Burgard, W., Christaller, T., Cremers, A. B. (eds.): KI-99 Ad-
vances in Artiﬁcial Intelligence. Proceedings of the 23rd Annual German Con-
ference on Artiﬁcial Intelligence, Bonn, Germany, 1999, Lecture Notes in Com-
puter Science, Springer, 1701, 27-44.
18. Pfeifer, R. (2000a). On the role of morphology and materials in adaptive behav-
ior. In Meyer, Berthoz, Floreano, Roitblat, and Wilson (eds.): From Animals
to Animats 6. Proceedings of the sixth International Conference on Simulation
of Adaptive Behavior 2000, 23-32.
19. Pfeifer, R. (2000b). On the role of embodiment in the emergence of cognition
and emotion. In H. Hatano, N. Okada, and H. Tanabe (eds.). Aﬀective minds.
Amsterdam: Elsevier, 43-57.
20. Pfeifer, R. (2001). Embodied Artiﬁcial Intelligence: 10 years back, 10 years
forward. In: R. Wilhelm (ed.). Informatics – 10 years back, 10 years ahead.
Lecture Notes in Computer Science. Berlin: Springer, 294-310.
21. Pfeifer, R. (in press). Robots as cognitive tools. Journal of Cognitive Technology
(to appear).
22. Pfeifer, R. (2003). Morpho-functional machines: basics and research issues. In
F. Hara, and R. Pfeifer (eds.). Morpho-functional machines: the new species.
Tokyo: Springer, 2003.
23. Pfeifer, R., and Glatzeder, B. (in preparation). How the body shapes the way
we think: the embodied revolution in artiﬁcial intelligence. Cambridge, Mass.:
MIT Press.
24. Pfeifer, R., and Scheier, C. (1999). Understanding intelligence. Cambridge,
Mass.: MIT Press.

Towards a “Well-Balanced” Design: How
Should Control and Body Systems be
Coupled?
Akio Ishiguro1, Kazuhisa Ishimaru1, and Toshihiro Kawakatsu2
1 Dept. of Computational Science and Engineering, Nagoya University, Nagoya
464-8603, Japan
2 Dept. of Physics, Tohoku University, Sendai 980-8578, Japan
Abstract. This study is intended to deal with the interdependency between con-
trol and body systems, and to discuss the “relationship as it should be” between
these two systems. To this end, a decentralized control of a multi-legged robot is
employed as a practical example. The results derived indicate that the convergence
of decentralized gait control can be signiﬁcantly ameliorated by modifying its in-
teraction between the control system and its body system to be implemented.
1
Introduction
In robotics, traditionally, a so-called hardware ﬁrst, software last based design
approach has been employed, which seems to be still dominant. Recently,
however, it has been widely accepted that the emergence of intelligence is
strongly inﬂuenced by not only control systems but also their embodiments,
that is the physical properties of robots’ body[1]. In other words, the in-
telligence emerges through the interaction dynamics among the control sys-
tems (i.e. brain-nervous systems), the embodiments (i.e. musculo-skeletal
systems), and their environment (i.e. ecological niche). In sum, control dy-
namics and its body (i.e. mechanical) dynamics cannot be designed separately
due to their tight interdependency. This leads to the following conclusions: (1)
there should be a “best combination” or a “well-balanced coupling” between
control and body dynamics, and (2) one can expect that quite an interesting
phenomenon will emerge under such well-balanced coupling.
On the other hand, since the seminal works of Sims[2][3], so far vari-
ous methods have been intensively investigated in the ﬁeld of Evolutionary
Robotics by exploiting concepts such as co-evolution, in the hope that they
allow us to simultaneously design control and body systems[4][5]. Most of
them, however, have mainly focused on automatically creating both control
and body systems, and thus have paid less attention to gain an understand-
ing of well-balanced coupling between the two dynamics. To our knowledge,
still very few studies have explicitly investigated this point, i.e., appropriate
coupling1.
1 Pfeifer introduced several useful design principles for constructing autonomous
agents[1]. Among them, the principle of ecological balance does closely relate to

108
A. Ishiguro, K. Ishimaru, T. Kawakatsu
In light of these facts, this study is intended to deal with the interaction
dynamics between control and body systems, and to analytically and syn-
thetically discuss a well-balanced relationship between the dynamics of these
two systems. More speciﬁcally, the aim of this study is to clearly answer the
following questions:
• How these two dynamics should be coupled?
• What sort of phenomena will emerge under the well-balanced coupling?
Since there are virtually no studies in existence which discuss what the
well-balanced coupling is, it is of great worth to accumulate various case
studies at present. Based on this consideration, a decentralized control of
a multi-legged robot consisting of several body segments is employed as a
practical example. The derived result indicates that the convergence of de-
centralized gait control can be signiﬁcantly ameliorated by modifying both
control dynamics (e.g. information pathways among the body segments) and
body dynamics (e.g. stiﬀness of the spine) to be implemented.
2
Lessons from biological ﬁndings
Before explaining our approach, it is highly worthwhile to look at some bio-
logical ﬁndings. Beautiful instantiations of well-balanced couplings between
nervous and body systems can be found particularly in insects. In what fol-
lows, let us brieﬂy illustrate some of these instantiations.
Compound eyes of some insects such as houseﬂies show special facet, i.e.,
vision segment, distributions; the facets are densely spaced toward the front
whilst widely on the side. Franceschini et al. demonstrated with a real physical
robot2 that this non-uniform layout signiﬁcantly contributes to detect easily
and precisely the movement of an object without increasing the complexity
of neural circuitry[6].
Another elegant instantiation can be observed in insects’ wing design[9][10].
As shown in Fig.1(a), very roughly speaking, insects’ wings are composed of
hard and soft materials. It should be noted that the hard material is dis-
tributed asymmetrically along the moving direction. Due to this material
conﬁguration, insects’ wings show complicated behavior during each stroke
cycle, i.e., twist and oscillation. This allows them to create useful aerody-
namic force, and thus they can realize agile ﬂying. If they had symmetrical
material conﬁguration as shown in Fig.1(b), the complexity of neural circuitry
responsible for ﬂapping control would be signiﬁcantly increased.
this point, which states that control systems, body systems and their material
to be implemented should be balanced. However, there still remains much to be
understood about how these systems should be coupled.
2 Another interesting robot can be found in [7][8].

Towards a Well-Balanced Design
109
hard material
soft material
front
body
hard material
soft material
front
body
(a)
(b)
Fig. 1. Material conﬁguration in insects’ wings.
3
The model
In order to investigate well-balanced coupling as it should be between control
and body systems, a decentralized control of a multi-legged robot is taken as a
case study. Figure 2 schematically illustrates the structure of the multi-legged
robot. As shown in the ﬁgure, this robot consists of several identical body
segments, each of which has two legs, i.e., right and left legs. For simplicity,
the right and left legs of each body segment are allowed to move in phase, and
the duty factor and trajectory of all the legs are assumed to be identical, which
have to be prespeciﬁed before actually moving the robot. For convenience,
hereafter the phase of the leg movement of the ith body segment is denoted
as θi (i = 1, 2, · · · , n). Thus, the control parameters in this model end up to
be the set of the phases θ1, θ2, · · · , θn.
The task of this robot is to realize rapid gait convergence which leads to
a gait with minimum energy consumption rate from arbitrary initial relative-
phase conditions. Note that each body segment controls the phase of its own
legs in a decentralized manner, which will be explained in more detail in the
following section.
(a) top view
(b) side view
Fig. 2. Structure of the multi-legged robot taken as a practical example.

110
A. Ishiguro, K. Ishimaru, T. Kawakatsu
4
Proposed method
4.1
Analysis of the gait convergence
Based on the above arrangements, this section analytically discusses how the
control and body dynamics inﬂuence the gait convergence. Let P be the total
energy consumption rate of this robot, then P can be expressed as a function
of the phases as:
P = P(θ),
(1)
θ = (θ1, θ2, · · · , θn)T .
(2)
Here, for the purposes of simpliﬁed analysis, a simple learning scheme based
on a gradient method is employed. It is denoted by
∆θ(k) = −η ∂P(θ)
∂θ
θ
(k) ,
(3)
where ∆θ(k) is the phase modiﬁcation at time step k, η is an n × n matrix
which speciﬁes how a body segment will exploit the information about phase
modiﬁcation done in other body segments in its determination of the phase
modiﬁcation. Based on Equation (3), the set of the phases at time step k is
expressed in the following form:
θ(k+1) = θ(k) + ∆θ(k) = θ(k) −η ∂P(θ)
∂θ
θ
(k) .
(4)
Let θ(∞) be a set of converged phases. By performing the Taylor series ex-
pansion around θ(∞), the partial diﬀerentiation of P(θ) with respect to θ
is:
∂P(θ)
∂θ
≃C(θ −θ(∞)),
(5)
C = ∂2P(θ)
∂θ∂θ
θ
(∞) ,
(6)
where C is an n × n Hesse matrix. Hence, the substitution of Equation (5)
into Equation (4) yields:
θ(k+1) = θ(k) −ηC(θ(k) −θ
(∞)).
(7)
For the sake of the following discussion, a residual vector e(k) is introduced,
which is equivalent to θ(k) −θ(∞). Then, Equation (7) can be rewriten as:
e(k+1) = Ae(k),
(8)
A = I −ηC,
(9)
where I is an n × n unit matrix.

Towards a Well-Balanced Design
111
4.2
Physical meaning of η and C
A in Equation (8) is a matrix which characterizes the property of gait con-
vergence. This will automatically lead to the following fact: for rapid conver-
gence, the spectral radius of A should be less than 1.0.
What should be stressed here is the fact that as shown in Equation (9) the
matrix A is composed of the two matrices: η and C. As has been already ex-
plained, the matrix η speciﬁes the information pathways (or neuronal/axonal
interconnectivity) among the body segments, which will be used to calculate
the phase modiﬁcation. This implies that the matrix η does relate to the
design of the control dynamics.
On the other hand, obviously from the deﬁnition (see Equation (6)), C
is a matrix whose nondiagonal elements will be salient as the long-distance
interaction among the body segments through the physical connections (i.e.
the spine of the robot) becomes signiﬁcant. This strongly suggests that the
property of this matrix is highly inﬂuenced by the design of the body dynam-
ics.
4.3
An eﬀective design of the body dynamics
The design of the control dynamics can be easily done by tuning the elements
of the matrix η. In contrast, much attention has to be paid to the design of
the body dynamics. This is simply because one cannot directly access the
elements of the matrix C nor tune them unlike the matrix η.
Before introducing our proposed method, let us brieﬂy conduct a simple
yet instructive thought experiment. Imagine a multi-legged robot in which
its body segments are tightly connected via a rigid spine. In such a case,
the phase modiﬁcation of a certain leg will signiﬁcantly aﬀect the energy
consumption rate of distant legs due to the eﬀect of the long-distance inter-
action.
As has been demonstrated in the thought experiment mentioned above,
the stiﬀness of the spine poses serious inﬂuence on the property of the matrix
C, particularly the values of its nondiagonal elements. Therefore, it seems to
be reasonable to connect the body segments via a springy joint. This idea is
schematically illustrated in Fig. 3, in which only the two body segments are
shown for clarity.
Based on the above consideration, a well-balanced design is investigated
by tuning the parameters in the matrix η and the ones of the springs inserted
between the body segments, which will lead to a reasonable gait convergence.
5
Preliminary simulation results
In order to eﬃciently investigate well-balanced coupling, a simulator has been
developed. The following simulations have been conducted with the use of a

112
A. Ishiguro, K. Ishimaru, T. Kawakatsu
body segment  
  
      
 spine
stopper
nonlinear spring
Fig. 3. An eﬀective structure for adjusting the body dynamics.
Fig. 4. A view of the developed simulator.
physics-based, three-dimensional simulation environment[11]. A view of the
developed simulator is shown in Fig. 4. This environment simulates both the
internal and external forces acting on the agent and objects in its environ-
ment, as well as various other physical properties such as contact between
the agent and the ground, and torque applied by the motors to the joints
within an acceptable time limit.
Before carrying out a thorough search of the design parameters, a pre-
liminary experiment has been done to understand the inﬂuence of the two
dynamics on the gait convergence. In this experiment, the property of the
spring inserted between the body segments is assumed to be expressed as:
f = −k(∆x)α,
(10)
where f is the resultant force, k is a spring constant, α controls the degree
of the nonlinearity of the spring, and ∆x is a displacement.
Shown in Fig. 5 are the resultant data in this experiment; the vertical
axis denotes the total energy consumption rate whilst the horizontal axis

Towards a Well-Balanced Design
113
 80
 100
 120
 140
 160
 180
 200
 0
 50
 100
 150
 200
Number of Phase Modification
Energy Consumption Rate
 80
 100
 120
 140
 160
 180
 200
 0
 50
 100
 150
 200
Number of Phase Modification
Energy Consumption Rate
(a) α = 0.25
(b) α = 1.0
 80
 100
 120
 140
 160
 180
 200
 0
 50
 100
 150
 200
Number of Phase Modification
Energy Consumption Rate
 80
 100
 120
 140
 160
 180
 200
 0
 50
 100
 150
 200
Number of Phase Modification
Energy Consumption Rate
(c) α = 2.0
(d) rigid joint
Fig. 5. Preliminary simulation results.
depicts the number of phase modiﬁcation conducted. Note that each graph
was obtained by averaging over 20 diﬀerent initial relative-phase conditions.
As a rudimentary stage of the investigation, only α was varied under the
following conditions: the number of the body segments was 5; duty factor
0.5; k 1.0; and η set to 0.04 × I. For the ease of comparison, a representative
data under the condition where the body segments were connected via rigid
joints is also depicted (see in the ﬁgure (d)). As shown in Fig. 5, the gait
convergence is highly inﬂuenced by the stiﬀness of the joints, which leads to
varying the property of the matrix C.
At present, due to the computationally expensive cost, the parameter
optimization for both the control and body systems is totally diﬃcult to be
done systematically. Therefore, we took a quite primitive approach; we tried
to manually tune these parameters. A best individual obtained in a hand-
crafted manner is illustrated in Fig. 6. This data was obtained under the

114
A. Ishiguro, K. Ishimaru, T. Kawakatsu
following conditions: the number of the body segments was 5; duty factor
0.5; k 1.0; α 1.0; and η set to
0.04 ×
⎛
⎜
⎜
⎜
⎜
⎝
1.000 −0.472
0.223 −0.105
0.049
−0.472
1.000 −0.472
0.223 −0.105
0.223 −0.472
1.000 −0.472
0.223
−0.105
0.223 −0.472
1.000 −0.472
0.049 −0.105
0.223 −0.472
1.000
⎞
⎟
⎟
⎟
⎟
⎠
.
Interestingly, this result outperforms the ones shown in Fig. 5. In spite
of the simplicity, these results strongly support the conclusion that the in-
terdependency between the control and body dynamics imposes signiﬁcant
inﬂuence on the gait convergence.
 80
 100
 120
 140
 160
 180
 200
 0
 50
 100
 150
 200
Number of Phase Modification
Energy Consumption Rate
Fig. 6. A representative data obtained by hand-crafted optimization.
6
Conclusion and future work
This paper investigated “well-balanced coupling as it should be” between
control and body systems. For this purpose, a decentralized control of a
multi-legged robot was employed as a case study. The preliminary experi-
ments conducted in this paper support several conclusions and have clariﬁed
some interesting phenomena for further investigation, which can be sum-
marized as: ﬁrst, control and body dynamics signiﬁcantly inﬂuence the gait
convergence; second, well-balanced design in this case study can be analyt-
ically discussed in terms of the spectral radius of a matrix which speciﬁes
the property of gait convergence; third and ﬁnally, as demonstrated in the
preliminary experiments, the property of gait convergence can be tuned by
varying the dynamics experimentally, which suggests that there should be an
appropriate coupling between the two systems.
In order to gain a deep insight into what well-balanced coupling is and
should be, an intensive search of the design parameters in the control and
body systems is highly indispensable. For this purpose, it seems to be rea-
sonable to implement an evolutionary computation scheme such as a genetic

Towards a Well-Balanced Design
115
algorithm to eﬃciently search these parameters. This is currently under in-
vestigation. In addition to this simulations, a real physical robot is currently
being constructed for experimental veriﬁcation. A view of this experimen-
tal robot is shown in Figure 7. For clarity, the springy joints implemented
between the body segments of this robot is also illustrated in the ﬁgure.
Another important point to be stressed is closely related to the concept of
emergence. One of the crucial aspects of intelligence is the adaptability under
hostile and dynamically changing environments. How can such a remarkable
ability be achieved under limited/ﬁnite computational resources? One and
the only solution would be to exploit emergence phenomena created by the
interaction dynamics among control systems, body systems, and their envi-
ronment. This research is a ﬁrst step to shed some light on this point in terms
of balancing control systems with their body systems.
Fig. 7. The experimental multi-legged robot developed. Left: an overall view. Right:
Springy joints implemented between the body segments of the experimental robot
for the adjustment of its body dynamics.
Acknowledgements
This research was supported in part by a Grant-in-Aid from the Japanese
Ministry of Education, Culture, Sports, Science and Technology (No. 14750367)
and a Grant-in-Aid from The OKAWA Foundation for Information and Telecom-
munications (No. 02-22). Many helpful suggestions for the simulator from
Yutaka Nakagawa at our laboratory, Josh C. Bongard at Computational
Synthesis Lab. of Cornell University, and Martin C. Martin at AI lab. of
Massachusetts Institute of Technology were greatly appreciated.
References
1. R. Pfeifer and C. Scheier: Understanding Intelligence, MIT Press (1999)

116
A. Ishiguro, K. Ishimaru, T. Kawakatsu
2. K. Sims: Evolving virtual creatures, Computer Graphics, 28, pp.15-34 (1994)
3. K. Sims: Evolving 3D morphology and behavior by competition, Artiﬁcial Life
IV Proceedings, MIT Press, pp.28-39 (1994)
4. W.P. Lee, J. Hallam, and H.H. Lund: A Hybrid GA/GP Approach for Co-
evolving Controllers and Robot Bodies to Achieve Fitness-Speciﬁed Tasks,
Proc. of The IEEE 3rd International Conference on Evolutionary Computation,
pp.384-389 (1996)
5. C. Paul and J.C. Bongard: The Road Less Traveled: Morphology in the Op-
timization of Biped Robot Locomotion, Proc. of The IEEE/RSJ International
Conference on Intelligent Robots and Systems (2001)
6. N. Franceschini, J.M. Pichon, and C. Blanes: From insect vision to robot vi-
sion, Philosophical Transactions of the Royal Society, London B, 337, pp.283-294
(1992)
7. L. Lichtensteiger and P. Eggenberger: Evolving the Morphology of a Compound
Eye on a Robot, Proc. of The Third European Workshop on Advanced Mobile
Robots, pp.127-134 (1999)
8. L. Lichtensteiger and R. Salomon: The Evolution of an Artiﬁcial Compound
Eye by Using Adaptive Hardware, Proc. of The 2000 Congress on Evolutionary
Computation, pp.1144-1151 (2000)
9. R. Wootton: How Flies Fly, Nature, Vol.400(8 July), pp.112-113 (1999)
10. R. Wootton: Design, Function and Evolution in the Wings of Holometabolous
Insects, Zoologica Scripta, Vol.31, No.1, pp.31-40 (2002)
11. http://www.q12.org/ode/ode.html

Experimental Study on Control of Redundant
3-D Snake Robot Based on a Kinematic Model
Fumitoshi Matsuno and Kentaro Suenaga
Department of Mechanical Engineering and Intelligent Systems, University of
Electro-Communications, 1-5-1 Chofu-ga-oka, Chofu, Tokyo 182-8585, Japan
Abstract. In this paper, we derive a kinematic model and a control law for 3D
snake robots which have wheeled link mechanism. We deﬁne the redundancy con-
trollable system and ﬁnd that introduction of links without wheels makes the system
redundancy controllable. Using redundancy, it becomes possible to accomplish both
main objective of controlling the position and the posture of the snake robot head,
and sub-objective of the singular conﬁguration avoidance. Experiments demonstrate
the eﬀectiveness of the proposed control law.
1
Introduction
Unique and interesting gait of the snakes makes them able to crawl, climb a
hill, climb a tree by winding and move on very slippery ﬂoor [1]. Snake does
not have hands and legs, however it has many functions. It is useful to consider
and understand the mechanism of the gait of the snakes for mechanical design
and control law of snake robots.
Snake robots are active code mechanism and useful for search and rescue
operation in disaster. Utilization of autonomous intelligent robots in Search
and Rescue is a new challenging ﬁeld of robotics dealing with tasks in ex-
tremely hazardous and complex disaster environments. Intelligent, biologically-
inspired mobile robots, and, in particular, snake-like robots have turned out
to be the widely used robot type, aiming at providing eﬀective, immediate,
and reliable response to many strategic planning for search and rescue opera-
tions. Design and control of the snake-like robot have recently been receiving
much attention, and many locomotion modes for snake-like robot have been
proposed [2–5].
Hirose has long investigated snake robots and produced several snake
robots, and he models the snake by a wheeled link mechanism with no side
slip [2]. Some other snake-like mechanisms are developed in [3–5]. The present
research [2,4,5] is looking for other variety of possible locomotion modes ”Ring
mode”, ”Inching mode”, ”Wheeled Locomotion mode” and ”Bridge mode”
as shown in Fig. 1.
1. Ring mode: The two ends of the robot body are brought together by its
own actuation to form a circular shape. The drive to make the uneven
circular shape to rotate is expected to be achieved by proper deformation
and shifting the center of gravity as necessary.

118
Fumitoshi Matsuno, Kentaro Suenaga
Fig. 1. Variety of possible locomotion of snake robot
2. Inching mode: This is one of the common undulatory movements of ser-
pentine mechanisms. The robot generates a vertical wave-shape using
its units from the rear end and propagates the ’wave’ along its body -
resulting a net advancement in its position.
3. Twisting mode: In this mode the robot mechanism folds certain joints
to generate a twisting motion within its body, resulting in a side-wise
movement [5] .
4. Wheeled locomotion mode: This is one of the common wheeled locomo-
tion mode where the passive wheels (without direct drive) are attached on
the units resulting low friction along the tangential direction of the robot
body line while increasing the friction in the direction perpendicular to
that [2].
5. Bridge mode: In this mode the robot conﬁgures itself to ”stand” on its two
end units in a bridge like shape. This mode has the possibility of imple-
mentation of two-legged walking type locomotion. The basic movement
consists of left-right swaying of the center of gravity in synchronism with
by lifting and forwarding one of the supports, like bipedal locomotion.
Motions such as somersaulting may also be some of the possibilities.
The snake robots which have many functions, locomotion modes and 3D mo-
tion have been developed, but in the study of controller design for the snake
robots the movement is restricted to 2D motion. Construction of a controller
which accomplishes 3D motion of 3D snake robots is one of challenging and
important problems.
Chirikijian and Burdick discuss the sidewinding locomotion of the snake
robots based on the kinematic model [6]. Ostrowski and Burdick analyze the
controllability of a class of nonholonomic systems, that the snake robots are
included, on the basis of the geometric approach [7]. The feedback control
law for the snake head’s position using Lyapunov method has been developed
by Prautesch et al. on the basis of the wheeled link model [8]. They point out
the controller can stabilize the head position of the snake robot to its desired

Experimental Study on Control of Redundant 3-D Snake Robot
119
value, but the conﬁguration of it converges to a singular conﬁguration. We
ﬁnd that introduction of links without wheels and shape controllable points
in the snake robot’s body makes the system redundancy controllable.
In this paper we consider the singular conﬁguration avoidance of the re-
dundant 3D snake robots. Using redundancy, it becomes possible to accom-
plish both the main objective of controlling the position and the posture
of the snake robot head and the sub-objective of the singular conﬁguration
avoidance. Experimental results by using a 13-link snake robot (ACM-R3 [9])
are shown.
2
Redundancy controllable system
In our previous paper we deﬁne the redundancy controllable system and
propose structure design methodology of redundant snake robots based on
the wheeled link model [10].
Let q ∈R¯n be the state vector, u ∈R¯p be the input vector, w ≡Sq ∈R¯q
be the state vector to be controlled, S be a selection matrix whose row vec-
tors are independent unit vectors related to generalized coordinates, A(q) ∈
R ¯m×¯q, B(q) ∈R ¯m×¯p, where ¯m is number of equations. We deﬁne that the
system
A(q) ˙w = B(q)u,
u = u1 + u2
(1)
is redundancy controllable if ¯p > ¯q (redundancy I), ¯p > ¯m (redundancy II),
1 the matrix A is full column rank, B is full row rank, and following two
conditions are satisﬁed.
1. There exists an input u1 which accomplishes the main objective of the
convergence of the vector w to the desired state wd (w →wd, ˙w →˙wd).
2. There exists an input u = u1 + u2 which accomplishes the increase (or
decrease) of a cost function V (q) related to the sub-objective compared to
the input u1 and does not disturb the main objective.
For a snake robot based on the wheeled link model we discuss the condi-
tion that the system is redundancy controllable [10].
3
Kinematic model of snake robots
Let us consider a redundant n-link snake robot on a ﬂat plane. We introduce
a coordinate frame ΣA which is ﬁxed on the head of the snake robot. The tip
point of the snake head is taken as the origin of ΣA. The reference conﬁgu-
ration is set as a straight line conﬁguration on the ground as shown in Fig.
2. The Ax axis is set as the central body axis of the snake robot taking the
1 In the case of ¯m = ¯p, if the state vector to be controlled ˙w in (1) is given, the
input u is determined uniquely. In this sense the system is not redundant, so we
introduce the redundancy II.

120
Fumitoshi Matsuno, Kentaro Suenaga
reference conﬁguration. All joints rotate around y axis or z axis in the ref-
erence conﬁguration. Let Aˆli = [li, 0, 0]T be a link vector from the i-th joint
to the (i −1)-th joint with respect to ΣA in Fig. 2. Let φi be the relative
Fig. 2. Reference conﬁguration of 3D snake robot
joint angle between link i and i + 1. The link vector Ali with respect to ΣA
is expressed as
Ali = Rφ1 · · · Rφi−1
Aˆli (i = 1, · · · , n)
(2)
where Rφi is Rot(y, φi) = Rjφi or Rot(z, φi) = Rkφi. The 3D snake robot
divided two parts. One is the base part and the other is the head part. We
deﬁne that the ﬁrst nh links (head part) are not contact with the ground,
and the residual nb links (base part) are on the same plane which is parallel
to the ground. In the base part wheeled links are contact with the ground.
Let us introduce inertial Cartesian coordinate frame ΣW and the coordinate
frame ΣB which is ﬁxed on the end point of the base part ((nh + 1)-th link)
as shown in Fig. 3. We introduce following three assumptions.
[assumption 1]: All joints of the base part rotate around z axis.
[assumption 2]: Environment is ﬂat.
[assumption 3]: The robot is supported by the wheels of the base part and
the head part is not contact with the ground.
Fig. 3. Coordinate systems of 3D snake robot

Experimental Study on Control of Redundant 3-D Snake Robot
121
The rotation matrix from ΣB to ΣA is given as
ARB = Rφ1 · · · Rφnh.
(3)
Let ψ be the absolute attitude angle of the head of the base part about z
axis, then the rotation matrix from ΣB to Σ is expressed as
W RB = Rkψ
(4)
where Rkψ = Rot(z, ψ). The rotation matrix W RA from ΣA to Σ is expressed
as
W RA = W RB(ARB)−1 = RkψR−φnh · · · R−φ1.
(5)
Using (5) and (2) gives the link vector li with respect to Σ
li = RkψR−φnh · · · R−φi
Aˆli (i = 1, · · · , nh)
lnh+1 = RkψAˆlnh+1
li = RkψRφnh+1 · · · Rφi−1Aˆli (i = nh + 2, · · · , n).
(6)
Let (R, P, Y ) be roll, pitch, yaw angles, then we obtain
R = atan2(± ˜R32, ± ˜R33)
P = atan2(−˜R31, ±

˜R2
11 + ˜R2
21)
Y −ψ = atan2(± ˜R21, ± ˜R11)
(7)
where R = R−φnh · · · R−φ1. Using (6) and (7) yields
li = Rk(Y −atan2(± ˜
R21,± ˜
R11))R−φnh · · · R−φi
Aˆli
(i = 1, · · · , nh)
lnh+1 = Rk(Y −atan2(± ˜
R21,± ˜
R11))Aˆlnh+1
li = Rk(Y −atan2(± ˜
R21,± ˜
R11))Rφnh+1 · · · Rφi−1Aˆli
(i = nh + 2, · · · , n).
(8)
The middle position P i = [xi, yi, zi]T of the rotational axis of two wheels
attached on the link i is expressed as
P i = P h −l1 −l2 −· · · −li−1 −lwi
li
li
(9)
where P h is the position vector of the snake head and lwi is the distance
between the joint i and the attached position of the wheel of the link i. As
the wheel does not slip to the side direction, the velocity constraint condition
should be satisﬁed. If the i-th link is wheeled and contact with the ground,
the constraint can be written as
˙xi sin θi −˙yi cos θi = 0
(10)

122
Fumitoshi Matsuno, Kentaro Suenaga
where θi is the absolute attitude of the i-th link about z-axis and it is ex-
pressed as
θi = ψ +
i−1

j=nh+1
φj
= Y −atan2(± ˜R21, ± ˜R11) +
i−1

j=nh+1
φj.
(11)
From the assumption 3 z-element of the position vector of the ﬁrst link of
the base part is constant. We set it as h, then we obtain
(P h −l1 −l2 −· · · −lnh)T ez = h
(12)
where lz = [0 0 1]T . Using time derivative of the geometric relation (7)(9)(12)
and the velocity constraint condition (10) yields kinematic model of 3D snake
robot.
4
Condition for redundancy controllable system
We consider control of position and posture of the snake head. Let w =
[ xh
yh
zh
R
P
Y ]T be the vector of the position and the posture of
the snake head, θ = [ φ1
· · ·
φn−1 ]T be the vector of relative joint angles,
q = [ wT
θT ]T ∈Rn+5 be the generalized coordinates. The angular velocity
of each joint is regarded as the input of the robot system. If a wheel free link
is connected to the tail, the movement of the added link does not contribute
to the movement of the snake head. So we assume that wheel is attached at
the tail link. If all links are wheeled, then we obtain
¯A(q) ˙w = ¯B(q)u , u = ˙θ
(13)
where
¯A =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
a11
a12 0 0 0 a16
a21
a22 0 0 0 a26
...
...
... ... ...
...
anb1 anb2 0 0 0 anb6
0
0
1 0 0
0
0
0
0 1 0
0
0
0
0 0 1
0
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦
¯B =
⎡
⎢⎢⎢⎢⎢⎢⎢⎢⎢⎣
b11
· · ·
b1nh
0
· · ·
0
b21
· · ·
b2nh
−lw(nh+2) · · ·
0
...
...
...
...
bnb1
· · ·
bnbnh
bnb(nh+1) · · · −lwn
b(nb+1)1 · · · b(nb+1)nh
0
· · ·
0
b(nb+2)1 · · · b(nb+2)nh
0
· · ·
0
b(nb+3)1 · · · b(nb+3)nh
0
· · ·
0
⎤
⎥⎥⎥⎥⎥⎥⎥⎥⎥⎦

Experimental Study on Control of Redundant 3-D Snake Robot
123
In (13), the ﬁrst nb equations are obtained from (9) (10), the (nb + 1)-th
from the derivative of (12), and the (nb + 2)-th and (nb + 3)-th equations
from derivative of the ﬁrst two equations of (7).
Let m be the number of wheeled links of the base part. The kinematic
model is expressed as
A(q) ˙w = B(q)u , u = ˙θ
(14)
We consider conditions so that the n-link snake robot system can be regarded
as the redundancy controllable system which is deﬁned in the section 2. To
satisfy the redundancy II the inequality
[condition 1] : 3 ≤m < n −4
should be satisﬁed. To satisfy the full row rankness of the matrix B we should
introduce following conditions.
[condition 2] :
In the case that the (nh + 1)-th link is wheel free : nh ≥3
In the case that the (nh + 1)-th link is wheeled : nh ≥4
[condition 3] :
All joints of the head part do not have same direction of rotational axes.
These three conditions are suﬃcient condition so that the system is redun-
dancy controllable [10].
The necessary and suﬃcient condition for the existence of the solution of
the system (14) is
rank[A, Bu] = rankA.
(15)
5
Controller design for main-objective
Let us deﬁne the control input as
u = ˙θ = B+A{ ˙wd −K(w −wd)}
+ (I −B+B)k
(16)
where B+ is a pseudo-inverse matrix of B, k is an arbitrary vector and K > 0.
The ﬁrst term of the right side of (16) is the control input term to accomplish
the main objective of the convergence of the state vector w to the desired
value wd. As the second term (I −B+B)k belongs to the null space of the
matrix B, we obtain
Bu = A{ ˙
wd −K(w −wd)}.
(17)

124
Fumitoshi Matsuno, Kentaro Suenaga
As the vector Bu can be expressed as a linear combination of column vectors
of the matrix A, the condition (14) of the existence of the solution (14)
is satisﬁed. The second term in (16) does not disturb the dynamics of the
controlled vector w. As there is no interaction between w and θ, we ﬁnd that
the control law (16) accomplishes the sub-objective.
The closed-loop system is expressed as
A{( ˙w −˙
wd) + K(w −wd)} = 0.
(18)
If the matrix A is full column rank, the uniqueness of the solution is guaran-
teed. The solution of (18) is given as
˙w −˙
wd + K(w −wd) = 0
and we ﬁnd that the controller ensures the convergence of the controlled state
vector to the desired value (w −→wd). A set of joint angles which satisﬁes
rankA < q (A is not full column rank) means the singular conﬁguration, for
example a straight line (φi = 0, i = 1, · · · , n −1).
6
Controller design for sub-objective
We consider the controller design for the sub-objective. In the control law
(16), k is an arbitrary vector. Let us introduce the cost function V (q) which
is related to the sub-objective. If we set the vector k as the gradient k1 of the
cost function V (q) with respect to the vector θ related to the input vector
u, we obtain
k1 = ∇θV (q) =
 ∂V
∂θ1
· · ·
∂V
∂θn−1

and we ﬁnd that the second term of (16) accomplishes the increase of the
cost function V . Actually we can derive
˙V (q) = (∂V/∂w) ˙w + (∂V/∂θ) ˙θ
= (∂V/∂w) ˙w + kT B+A{ ˙wd−K(w−wd)}
+ kT
1 (I −B+B)k1.
(19)
As I −B+B ≥0 [11], we ﬁnd that the second term of the input (16) accom-
plishes the increase of the cost function V .
In the case that the sub-objective is the singularity avoidance, we set
B+ = BT (BBT )−1 and
V = α(det(AT A)) + β(det(BBT ))
(20)
where α, β > 0. The ﬁrst term of the right side of (20) implies the measure of
the singular conﬁguration. The second term of the right side of (20) is related
to the manipulability of the system.

Experimental Study on Control of Redundant 3-D Snake Robot
125
7
Experiments
To demonstrate the validity of the proposed control law experiments have
been carried out. The snake robot that we use for the experiments is ACM-
R3 [9] as shown in Fig. 4. The snake robot has 13 links and the 2, 6, 8,
9, 10, 12, 13-th links are wheeled. The length li(i = 1, · · · , 13) of the links
are as follows: l1 = l7 = l8 = l9 = l10 = l11 = l12 = 0.16[m], l2 = l3 =
l4 = l5 = l6 = l13 = 0.08[m]. We set K = I, α = 0.2, β = 2.0 × 106. The
initial position and posture of the head of the snake robot and initial relative
joint angles are set as w(0) = [0, −0.1, 0.142, 0.0715, −0.143, π/10]T , θ(0) =
[0, π/18, π/30, π/18, π/12, −π/9, π/6, π/6, −π/9, −π/6, −π/10, π/30]T .
Fig. 4. A research platform robot (ACM-R3)
In experiments, to measure the position and the posture of the snake head
we use Quick MAG IV stereo vision system with two ﬁxed CCD cameras. The
desired trajectory wd corresponding to w is represented as the broken lines
in Figs. 5 and 6. Fig. 5 shows the transient responses for the controller (16)
without using redundancy (k = 0). From Fig. 5(a) and (c) we ﬁnd that
the snake robot can not track the desired head trajectory because of the
convergence to the singular conﬁguration of a straight line. Fig. 6 shows the
transient responses for the controller (16) with using redundancy (k = k1).
From Fig. 6 (a) and (c) we ﬁnd that the snake robot avoids the singular
conﬁguration of the straight line. Experimental results show the eﬀectiveness
of the proposed controller.
8
Conclusion
We have considered control of redundant 3D snake robot based on kinematic
model. We derived conditions so that the snake robot system is redundancy
controllable. We propose controller that the snake head tracks the desired
trajectory and the robot avoids singular conﬁgurations by using redundancy.
Experimental results ensure the eﬀectiveness of the proposed control law.

126
Fumitoshi Matsuno, Kentaro Suenaga
0
5
10
15
0
0.5
1
1.5
2
2.5
xh , xhd [m]
0
5
10
15
0
0.5
1
1.5
2
2.5
yh , yhd [m]
0
5
10
15
0
0.1
0.2
0.3
zh , zhd [m]
0
5
10
15
−1
−0.5
0
0.5
1
R , Rd [rad]
0
5
10
15
−1
−0.5
0
0.5
1
P , Pd [rad]
t [s]
0
5
10
15
−0.5
0
0.5
1
1.5
Y , Yd [rad]
t [s]
(a) w(−−−−) and wd(−−−)
0
5
10
15
−1
0
1
u1 [rad/s]
0
5
10
15
−1
0
1
u2 [rad/s]
0
5
10
15
−1
0
1
u3 [rad/s]
0
5
10
15
−1
0
1
u4 [rad/s]
0
5
10
15
−1
0
1
u5 [rad/s]
0
5
10
15
−1
0
1
u6 [rad/s]
0
5
10
15
−1
0
1
u7 [rad/s]
0
5
10
15
−1
0
1
u8 [rad/s]
0
5
10
15
−1
0
1
u9 [rad/s]
0
5
10
15
−1
0
1
u10 [rad/s]
0
5
10
15
−1
0
1
u11 [rad/s]
t [s]
0
5
10
15
−1
0
1
u12 [rad/s]
t [s]
b) Input u1, · · · , u12
0
2
4
6
8
10
12
14
16
18
0
0.5
1
1.5
2
det(ATA)
0
2
4
6
8
10
12
14
16
18
0
0.5
1
1.5
2
2.5
3
x 10
8
det(BBT)
t [s]
(c) det(AT A) and det(BBT )
Fig. 5. Transient responses for controller without using redundancy (k = 0)

Experimental Study on Control of Redundant 3-D Snake Robot
127
0
5
10
15
0
0.5
1
1.5
2
2.5
xh , xhd [m]
0
5
10
15
0
0.5
1
1.5
2
2.5
yh , yhd [m]
0
5
10
15
0
0.1
0.2
0.3
zh , zhd [m]
0
5
10
15
−1
−0.5
0
0.5
1
R , Rd [rad]
0
5
10
15
−1
−0.5
0
0.5
1
P , Pd [rad]
t [s]
0
5
10
15
−0.5
0
0.5
1
1.5
Y , Yd [rad]
t [s]
(a) w(−−−−) and wd(−−−)
0
5
10
15
−1
0
1
u1 [rad/s]
0
5
10
15
−1
0
1
u2 [rad/s]
0
5
10
15
−1
0
1
u3 [rad/s]
0
5
10
15
−1
0
1
u4 [rad/s]
0
5
10
15
−1
0
1
u5 [rad/s]
0
5
10
15
−1
0
1
u6 [rad/s]
0
5
10
15
−1
0
1
u7 [rad/s]
0
5
10
15
−1
0
1
u8 [rad/s]
0
5
10
15
−1
0
1
u9 [rad/s]
0
5
10
15
−1
0
1
u10 [rad/s]
0
5
10
15
−1
0
1
u11 [rad/s]
t [s]
0
5
10
15
−1
0
1
u12 [rad/s]
t [s]
(b) Input u1, · · · , u12
0
2
4
6
8
10
12
14
16
18
0
0.5
1
1.5
2
det(ATA)
0
2
4
6
8
10
12
14
16
18
0
0.5
1
1.5
2
x 10
8
det(BBT)
t [s]
(c) det(AT A) and det(BBT )
Fig. 6. Transient responses for the controller with using redundancy (k = k1)

128
Fumitoshi Matsuno, Kentaro Suenaga
References
1. J. Gray, Animal Locomotion, pp. 166-193, Norton, 1968
2. S. Hirose, Biologically Inspired Robots (Snake-like Locomotor and Manipulator),
Oxford University Press, 1993
3. B. Klaassen and K. Paap, GMD-SNAKE2: A Snake-Like Robot Driven by
Wheels and a Method for Motion Control, Proc. IEEE Int. Conf. on Robotics
and Automation, pp. 3014-3019, 1999.
4. M. Yim, D. Duﬀand K. Poufas, PolyBot: a Modular Reconﬁgurable Robot,
Proc. IEEE Int. Conf. on Robotics and Automation, pp. 514-520, 2000.
5. T. Kamegawa, F. Matsuno and R. Chatterjee, Proposition of Twisting Mode
of Locomotion and GA based Motion Planning for Transition of Locomotion
Modes of a 3-dimensional Snake-like Robot, Proc. IEEE Int. Conf. on Robotics
and Automation, pp. 1507-1512, 2002.
6. G. S. Chirikijian and J. W. Burdick, The Kinematics of Hyper-Redundant
Robotic Locomotion, IEEE Trans. on Robotics and Automation, Vol. 11, No.
6, pp. 781-793, 1995
7. J. Ostrowski and J. Burdick, The Geometric Mechanics of Undulatory Robotic
Locomotion, Int. J. of Robotics Research, Vol. 17, No. 6, pp. 683-701, 1998
8. P. Prautesch, T. Mita, H. Yamauchi, T. Iwasaki and G. Nishida, Control and
Analysis of the Gait of Snake Robots, Proc. COE Super Mechano-Systems Work-
shop’99, pp. 257-265, 1999
9. M. Mori and S. Hirose, Development of Active Cord Mechanism ACM-R3 with
Agile 3D Mobility, Proc. IEEE/RSJ Int. Conf. on Intelligent Robots and Sys-
tems, pp. 1552-1557, 2001.
10. F. Matsuno and K. Mogi, Redundancy Controllable System and Control of
Snake Robot with Redundancy based on Kinematic Model, Proc. IEEE Conf.
on Decision and Control, pp. 4791-4796, 2000.
11. Y. Nakamura, H. Hanafusa and T. Yoshikawa, Task-Priority Based Redundancy
Control of Robot Manipulators, Int. J. of Robotics Research , Vol. 6, No. 2, pp.
3-15, 1987

Part 4
Bipedal Locomotion
Utilizing Natural Dynamics

Simulation Study of Self-Excited Walking of a
Biped Mechanism with Bent Knee
Kyosuke Ono and Xiaofeng Yao
Tokyo Institute of Technology, Department of Mechanical and Control
Engineering, 2-12-1 Ookayama, Meguro-ku, Tokyo, Japan 152-8552,
ono@mech.titech.ac.jp
Abstract. This paper presents a simulation study of self-excited walking of a four-
link biped model whose support leg is holding a bending angle at the knee. We found
that the biped model with a bent knee can walk faster than the straight support
leg model that has been studied so far. The convergence characteristics of the self-
excited walking are shown in relation to the bent knee angle. By using standard
link parameter values we investigated the eﬀect of the bent knee angle and foot
radius on walking performance. We found that the walking speed of 0.7 m/s can
be achieved when the bent knee angle is 15 degrees and the foot radius is 40mm.
1
Introduction
Since a biped robot is the ultimate goal of robotic machines in terms of versa-
tility with environments, friendliness to the human society and sophistication
of locomotion, it has been studied by a great number of researchers. In the
ﬁrst age of research of biped mechanisms or humanoid robots from the 1970s
to 1995, many control strategies of a biped walking were proposed [1-7]. In
addition, dynamic stability of walking locomotion inherent to a biped mech-
anism on a shallow slope were also studied by a number of researchers [8-10]
and passive walking are presented by McGeer [11-13].
At the end of 1995, Honda developed an advanced humanoid robot based
on trajectory planning and zero moment point (ZMP) control [14]. Since
then, the research of humanoid robots have focused on realizing various kinds
of intelligent functions similar to human beings. However, these humanoid
robots consume a high power in spite of slow walking compared with human.
For this reason it will be important to study a biped mechanism that can
perform natural walking in order to improve the walking eﬃciency.
As a control method of the natural dynamics of the biped mechanism,
Ono et al. proposed a self-excitation control of a 2-degree-of-freedom (2-
DOF) swing leg and showed that a four-link biped mechanism with and
without feet can walk on a level ground by means of only one hip motor in
numerical simulation and experiment [15-16]. In this biped model the stance
leg is assumed to be kept straight by some rock mechanism. Walking speed
can be increased to over 0.4m/s by using a cylindrical foot, but it is still slow
compared with human natural walking.

132
Kyosuke Ono, Xiaofeng Yao
This study aims to ﬁnd principles of fast biped walking with high eﬃciency
based on self-excitation. Through our understanding of human walking pat-
terns, we know that people always retain some knee ﬂexion during walking
[17] when we want to walk fast. Therefore, we try to apply a bent knee angle
to the support leg in order to make it walk faster.
In the next section, the analytical model and its basic equations of loco-
motion will be introduced. In section 3, we show the typical simulated results
of stable biped locomotion on level ground with and without a bent knee
angle and foot and the convergence characteristics of the self-excited walking
in relation to the bent angle. Next, we present the calculated results of the
eﬀect of the knee bent angle with and without a foot radius on the walking
performance.
2
The analytical model and basic equations
Figure 1 shows the biped mechanism that walks with a bent knee. We consider
the biped walking motion on a sagittal plane. The biped model consists of
only two legs and does not have a torso. The two legs are connected in a series
at the hip joint through a motor. Both legs have a thigh and a shank that
are connected at the knee joint. We assume that the biped has knee brakes
so that the knee can be locked at any bent angle after the knee collision of
the swing leg. The support leg does not extend fully but retains some ﬂexion
during the stance phase. Therefore the brake is activated before the swing leg
becomes straight and keeps a desired knee angle between the thigh and the
shank. The brake is released just when the supporting leg enters the swing
phase.
Fig. 1. Self-excited mechanism with bent knee and cylindrical foot

Simulation Study of Self-Excited Walking of a Biped Mechanism
133
Fig. 2. Two phases of biped walking
Figure 2 shows the algorithm of biped walking. Biped walking can be
divided into two phases: the swing leg phase and the touch down phase,
1. From the start of the swinging leg motion to the lock of the knee joint
of the swinging leg by the brake. In this phase, only the brake of the
supporting leg is activated.
2. From the lock of the knee joint of the swinging leg to the touch down of
the bent swinging leg. In this phase, the brakes of both legs are activated.
We assume that the change of the supporting leg to the swinging leg occurs
instantly and the friction force between the foot and the ground is large
enough to prevent a slip.
To realize stable biped walking on a level ground, the swinging leg should
bend at the knee to prevent the tip from touching the ground. In addition, the
energy dissipated through knee and foot collisions and joint friction should be
supplied by the motor. The swing leg motion can be autonomously generated
by the asymmetrical feedback of the form,
T2 = −kθ3
(1)
If the feedback gain k is increased to a certain value, the swing leg motion
begins to be self-excited and the kinetic energy of the swinging leg increases.
Since the swing motion has a constant period at any swing amplitude, there is
an angular velocity of the support leg whose swing motion as an inverted pen-
dulum can synchronize with the swing leg motion. This velocity determines
the walking speed.

134
Kyosuke Ono, Xiaofeng Yao
In addition, the synchronized motion between the inverted pendulum mo-
tion of the supporting leg and the two-DOF pendulum motion of the swinging
leg, as well as the balance of the input and the output energy, should have
stable characteristics against small deviations from the synchronized motion.
Fig. 3. Analyical model of three degree of freedom walking mechanism
It is also assumed that a small viscous rotary damper with coeﬃcient γ3
is applied to the knee joint of the swing leg, which produces a torque as:
T3 = −γ3( ˙θ3 −˙θ2)
(2)
Under the assumption of a ﬁxed bent knee angle of the supporting leg and
a free knee joint of the swinging leg, the analytical model during the ﬁrst
phase is treated as a three-DOF link system, as shown in Fig.3. We get the
equation of motion in the ﬁrst phase as:
⎡
⎣
M111 M112 M113
M122 M123
sym
M133
⎤
⎦
⎡
⎣
¨θ1
¨θ2
¨θ3
⎤
⎦+
⎡
⎣
0
C112 C113
−C112
0
C123
−C113 −C123
0
⎤
⎦
⎡
⎣
˙θ2
1˙θ2
2˙θ2
3
⎤
⎦+
⎡
⎣
K11
K12
K13
⎤
⎦
=
⎡
⎣
−T2
T2 −T3
−T3
⎤
⎦(3)
where the elements M1ij,C1ijand K1iof the matrices are shown in Ap-
pendix 1. T2 is the feedback input torque given by Eq.(1) while T3 is the
viscous resistance torque at the knee joint, which is given by Eq.(2).

Simulation Study of Self-Excited Walking of a Biped Mechanism
135
When the angle between the shank and thigh of the swing leg becomes a
certain value, the brake is activated and locks the knee joint. This signiﬁes
the end of the ﬁrst phase. We assume the knee collision occurs plastically at
this time. From the assumption of conservation of momentum and angular
momentum before and after the knee collision, angular velocities after the
knee collision are calculated from the condition ˙θ+
2 = ˙θ+
3 , and the equation
is written as:
⎡
⎣
˙θ+
1˙θ+
2˙θ+
3
⎤
⎦= [M]−1
⎡
⎣
f1(θ1, ˙θ−
1 )
f2(θ2, θ−
2 ) −τ
f3(θ3, θ−
3 ) + τ
⎤
⎦
(4)
where the elements of the matrix[M] are the same as M1ij in Eq.(3). f1, f2and
f3 are presented in Appendix 2. τ is the impulse moment at the knee.
During the second phase, the biped system can be regarded as a two-DOF
link system. The basic equation becomes

M211 M212
M212 M222
  ¨θ1
¨θ2

+

0
C212
−C212
0
  ˙θ1
˙θ2

+

K21
K22

= 0
(5)
where the elements M2ij, C2ijand K2ij of the matrices are shown in Ap-
pendix 3.
We assume that the collision of the swinging leg with the ground occurs
un-elastically and the friction between the foot and the ground is large enough
to prevent slipping. Just like knee collision, the angular velocities of the links
after the collision can be derived from conservation laws of momentum and
angular momentum. At this time, τ = 0 is put into Eq.(4). After the collision,
the supporting leg turn to the swinging leg immediately and the system enter
the ﬁrst phase again.
Table 1. Link parameter values used for simulation
Parameters
Thigh Shank Leg
Length li[m]
0.4
0.4
0.8
Mass ni[kg]
2.0
2.0
4.0
Center of mass ai[m]
0.2
0.2
0.4
Moment of inertia at mass center Ii[kgm2] 0.027
0.027
0.21
3
The results of simulation
The values of the link parameters used in the simulation are shown in Table
1. We use the same values as in our preceding paper [15] because it is easy
to ﬁnd the inﬂuence of the bent knee angle by comparing the two results.
The fourth order Runge-Kutta method was used to numerically solve the

136
Kyosuke Ono, Xiaofeng Yao
basic equations. In order to increase the accuracy, the time step is set to be
1ms. Regarding the eﬀect of viscous rotary damper γ3, it is found that a
proper value will yield the phase delay of the shank. This helps to increase
the foot clearance. By considering the eﬃciency, γ3 = 0.15 Nms/rad is used
in the simulation. In the numerical simulation, steady walking locomotion
is obtained with bent knee angles of less than 17 degrees. When the angle
is larger than 17 degrees, the step length decreases suddenly and the biped
mechanism falls forward.
Figure 4 illustrates the stick ﬁgures of the stable self-excited walking gaits
during four steps (two walking cycles) under the conditions of when the model
has the bent knee angle and foot or not. For the convenience of comparison,
the feedback gain k is set to be 8Nm/rad in all the cases. In Fig.4 (a), the
biped has no bent knee angle and no foot. The step length is 0.18 m and the
period of one step is 0.64 s, so the walking velocity is 0.28 m/s. In Fig.4 (b),
10 degrees of the bent knee angle is added to the support leg. The step length
increases to 0.31 m and the period decreases a little, so that the velocity is
increased to 0.5 m/s. The velocity increase is mainly caused by the increase
in the moment to drive the supporting leg forward due to the forward shift
of the mass center of the leg. In Fig.4 (c), the velocity is increased further to
0.65 m/s by giving the model a foot whose radius R is 0.3 m. From the stick
ﬁgures, we can clearly observe the increase of the walking speed. We also
note that the shank motion of the swing leg delays from the thigh motion
that yields a foot clearance (the height of the tip of the swing leg from the
ground) for stable walking.
The initial start condition of the supporting leg that can lead to stable
walking and the typical converging process of the self-excited walking are
shown in Fig. 5 when the knee angle αgs zero and the feedback gain k is
6 Nm/rad. Figure 5(a) shows the initial start angle and angular velocity of
the supporting leg that can converge to a limit cycle of walking motion and
the converging processes from the three diﬀerent initial conditions of 1 to 3.
This graph shows the basin of a limit cycle on a Poincare phase plane at the
start of a swing of the supporting leg. The star symbol indicates the start
condition of the supporting leg in the steady walking motion (limit cycle). We
note that the same unique start condition of the limit cycle can be obtained
from three diﬀerent initial conditions that are far apart from each other.
Figure 5(b) shows the change of step length as a function of time in the
converging process from the three diﬀerent initial conditions corresponding
to those in Fig.5(a). Since the walking period is 1.3 seconds, as will be shown
later, steady walking can be achieved after about ten cycles of walking.
α = 0◦R = 0mα = 10◦R = 0mα = 10◦R = 0.3m
Figure 6 shows the change of the stable start condition when the bent knee
angle is changed to 5, 10 and 15 degrees. We note from these ﬁgures that
stable walking becomes diﬃcult as the bent knee angle increases when the
mass distribution of the biped has not changed. The straight line on the main

Simulation Study of Self-Excited Walking of a Biped Mechanism
137
Fig. 4. Stick ﬁgures duringin two walking cycles
trunk of the basin is calculated from the synchronizing condition between
the supporting leg and swinging leg based on a physical model, although
not explained in detail. A good agreement between the line and calculated
point of the stable start condition indicates that stable self-excited walking is
generated when the swing leg motion and the support leg motion synchronize
with each other..
Figure 7 shows the eﬀect of the bent knee angle on the walking velocity,
input power, speciﬁc cost, step length and period respectively when k=8
Nm/rad and R=0 m. The average input power is calculated by:
P =
1
tend
 tend
0
 ˙θ2kθ3
dt
(6)
The speciﬁc cost is deﬁned as:
E =
P
mgV
(7)
From Fig. 7 we note that as the bent angle increases, the step length increases,
the period decrease and then the walking velocity increases. It should be
noted that the walking velocity at α = x6 increases by 2.3 times that at
α=0, whereas the increased rate in speciﬁc cost is 1.4. The reason for this
is considered as follows: As the bent knee angle increases, the position of
the mass center of the swing leg approaches the hip joint. Therefore, the
swing period will decrease. At the same time, the center of mass is moved

138
Kyosuke Ono, Xiaofeng Yao
Fig. 5. Start angular position and velocity of support leg that can converge
to a limit cycle of walking and converging processes from three diﬀerent initial
conditions(α = 0).(a)Start angular position and velocity of support leg that result
in a limit cycle of walking and converging processes from three diﬀerent start con-
ditions.(b)Converging processes of step length from three diﬀerent start conditions.
Fig. 6. Start angular position and velocity of support leg that can result in a stable
walking for various values of bent knee angles
forward in contrast to that of the straight leg. Therefore, the supporting leg
rotates forward faster than in the straight leg model because the oﬀset of
mass yields the gravity torque to make the support leg rotate in the forward
direction. With a shorter swing period and a longer step length, faster walking
is realized in the simulation. However, the speciﬁc cost increases until bent
knee angle αreaches 8 degrees because of the rapid increase of input power.
When α > 8◦the speciﬁc cost stops to increase and even decreases a little
because the increase in velocity is faster than the increase in input power.
Since the input torque at the hip joint is proportional to the angle of linkage
3 and θ3 is larger in the bent-knee mode than in the straight-leg mode, the
input power increases when the bent angle increases.
Although not shown here, we also found the inﬂuence of feedback gain
on the walking motion. As the feedback gain increases from 7 Nm/rad to 8
Nm/rad, the step length increases a little but the period increases notably

Simulation Study of Self-Excited Walking of a Biped Mechanism
139
Fig. 7. Walking performance as a function of bent knee angle(R = 0)
when the bent knee angle is larger than 5 degrees. Therefore, it is not appli-
cable to increase the velocity by increasing the feedback gain only. However,
in order to make the biped locomotion enter the limit cycle, we have to in-
crease the feedback gain as the bent knee angle increases. For the straight-leg
mode, k=4.6Nm/rad is enough to obtain a stable walk. But when the bent
knee angle increases to 12 degrees, k=7Nm/rad is indispensable to obtain a
stable walk. In addition, the foot clearance is inﬂuenced by the feedback gain
k. The clearance becomes minimum in the middle of the swing phase. As
k increases, the minimum clearance also increases. In the bent-knee walking
model, the clearance decreases as the bent angle increases. Since the mini-
mum clearance can be regarded as a margin of stable walking, it is necessary
to increase the value of k in order to realize steady walking.
α = 10◦k = 8.0Nm/radAs seen in Fig.4, the walking speed can be further
increased by increasing the radius of the cylindrical foot. Figure 7 shows the
eﬀect of foot radius on the walking performance when bent knee angle αgs 10
degrees and k=8Nm/rad. Here the mass of the foot is ignored in simulation.
From Fig. 7 we can note that as the foot radius increases, the step length
and velocity increase almost linearly. This is because the contact point of the
support leg is carried by the rolling motion of the cylindrical foot surface in
addition to the angular motion as an inverted pendulum. As the radius of
the foot reaches 0.4 m, the velocity increases to 0.7 m/s. This means a 40%

140
Kyosuke Ono, Xiaofeng Yao
increase in contrast to the model without the foot. But we may encounter the
problem of losing stability because the foot clearance from the ground will
decrease as the radius of the foot increases. When the radius is larger than 0.4
m, the toe of the swing foot may strike the ground. From the simulation, we
found that the walking speed of 0.7m/s can also be achieved when R=0.3m
and α=15.
Fig. 8. Eﬀect of foot radius on walking characteristics (α=10◦and k=8.0Nm/rad)
4
Conclusion
By giving the supporting leg a bent knee angle, the walking speed of the
biped mechanism increases signiﬁcantly due to the increase in step length
and the decrease in period as the knee angle increases. The increasing rate of
the bent knee model at 16 bent knee angle from the straight knee model is
2.3 whereas the increasing rate of the speciﬁc cost remains 14. The walking
speed can be further increased by increasing the foot radius. When α=10, the
walking velocity increases by 40% whereas the speciﬁc cost increases only by
20%. Walking velocity of 0.7 m/s can be obtained when the bent knee angle
is 15 and the foot radius is 0.3m or when the bent knee angle is 10 and the
foot radius is 0.4m.

Simulation Study of Self-Excited Walking of a Biped Mechanism
141
References
1. Kato T., Takanishi A., and Naito G., et al, 1981, “The realization of the qusasi
dynamic walking by the biped walking machine,” Proceedings of the Inter-
national Symposium on Theory and Practice and Manipulators, POMANSY,
pp.341-351.
2. Miyazaki F., and Arimoto S., 1980, “A control theoretic study on dynamical
biped locomotion,” Journal of Dynamic Systems, Measurement, and Control,
102(4), pp.233-239.
3. Mita T., Yamagaguchi T., Kashiwase T., and Kawase, T., 1984, “Realization
of a high speed biped using modern control theory,” International Journal of
Control, 40(1), pp.107-119.
4. Miura, H., and Shimoyama, I., 1984, “Dynamic Walk of a Biped,” Int. J. of
Robotics Research, 3(2), pp.60-74.
5. Furusho, j., and Masubuchi, M, 1986, “Control of a Dynamical Biped Loco-
motion System for Steady Walking,” Trans. ASME, J. of Dynamic Systems,
Measurement, and Control, 108(2), pp.111-118.
6. Kajita, S. and Kobayashi, A., 1987, “Dynamic Walk Control of a Biped Robot
with Potential Energy Conserving Orbit,” Journal of SICE, 23(3), pp.281-287.
7. Sano A., Furusho J., 1990, “3D dynamic walking robot by controlling the an-
gular momentum,” Journal of the SICE, 26(4), pp.459-466.
8. Goswami, A., Espiau, B., and Keramane, A., 1997, Limit Cycles in a Passive
Compass Gait Biped and Passivity-Mimicking Control Laws, J. Autonomous
Robots, 4(3), pp.273-286.
9. Garcia, M., Chatterrjee, A., Riuna, A., and Coleman, M., J., 1998, The Simplest
Walking Model: Stability, Complexity,and Scaling, ASME J. of Biomech. Eng.
120(2), pp.281-288.
10. Goswami,A., Thuilot, B., and Espiau,B., 1998, A Study of the Passive Gait of a
Compass-Like Biped Robot: Symmetry and Chaos, Int. J. Robot. Res. 17(12),
pp.1282-1301.
11. McGeer T., 1990, “Passive dynamic walking,” International Journal of Robotics
Research, 9(2), pp.62-81.
12. McGeer, T., 1990, “Passive walking with knees,” Proceedings of 1990 IEEE
Robotics and Automation Conf., pp.1640-1645.
13. McGeer, T., 1993, “Dynamics and control of bipedal locomotion,” Journal of
Theoretical Biology, 163, pp.277-314.
14. Hirai, K., Hirose, M., Haikawa, Y., and Takenaka, T., 1998, “The Development
of Honda Humanoid Robot, Proc. IEEE Int. Conf. Robotics and Automation,”
pp.983-985.
15. Ono K., Takahashi R., Shimada T., 2001, “Self-Excited Walking of a Biped
Mechanism,” Int. J. of Robotics Research, Vol.20, No.12, pp.953-966.
16. Ono K., Furuichi T., and Takahashi, R., 2004, “Self-Excited Walking of a Biped
Mechanism with Feet,” International Journal of Robotics Research, 23(1),
pp.55-68.
17. Jessica Rose and James G. Gamble, 1993, Human Walking (Second Edition),
Waverly Company.
Appendix 1
M111 = I1 + m1a2
1 + m2l2
1 + m3l2
1

142
Kyosuke Ono, Xiaofeng Yao
M112 = (m2a2 + m3l2)l1 cos(θ2 −θ1)
M113 = m3a3l1 cos(θ3 −θ1)
M122 = I2 + m2a2
2 + m3l2
2
M123 = m3a3l2 cos(θ3 −θ2)
M133 = I3 + m3a2
3
C112 = −(m2a2 + m3l2)l1 sin(θ2 −θ1)
C113 = −m3a3l1 sin(θ3 −θ1)
C123 = −m3a3l2 sin(θ3 −θ2)
K11 = (m1a1 + m2l1 + m3l1)g sin(θ1 + β1)
K12 = (m2a2 + m3l2)g sin θ2
K13 = m3a3g sin θ3
Appendix 2
f1(θ1, ˙θ−
1 ) = I1 ˙θ−
1 + {a1m1v1x + l1(m2v2x + m3v3x)} cos θ1
+{a1m1v1y + l1(m2v2y + m3v3y)} sin θ1
f2(θ2, ˙θ−
2 ) = I2 ˙θ−
2 + (a2m2v2x + l2m3v3x) cos θ2 + (a2m2v2y + l2m3v3y) sinθ2
f3(θ3, ˙θ−
3 ) = I3 ˙θ−
3 + a3m3v3x cos θ3 + a3m3v3y sin θ3
Appendix 3
M211 = I1 + m1a2
1 + m2l2
1
M212 = m2a2l1 cos(θ2 −θ1)
M222 = I2 + m2a2
2
C212 = −m2a2l1 sin(θ2 −θ1)
K21 = (m1a1 + m2l1)g sin θ1
K22 = m2a2g sin θ2

Design and Construction of MIKE;
a 2-D Autonomous Biped Based on Passive
Dynamic Walking
Martijn Wisse and Jan van Frankenhuyzen
Delft University of Technology, Dept. of Mechanical Engineering, Mekelweg 2,
NL-2628 CD Delft, The Netherlands
Abstract. For research into bipedal walking machines, autonomous operation is an
important issue. The key engineering problem is to keep the weight of the actuation
system small enough. For our 2D prototype MIKE, we solve this problem by apply-
ing pneumatic McKibben actuators on a passive dynamic biped design. In this paper
we present the design and construction of MIKE and elaborate on the most crucial
subsystem, the pneumatic system. The result is a fully autonomous biped that can
walk on a level ﬂoor with the same energy eﬃciency as a human being. We encour-
age the reader to view the movies of the walking results at http://dbl.tudelft.nl/.
1
Introduction
We are performing research into bipedal walking robots with two long-term
goals in mind. First, we expect that it increases our understanding of human
walking, which in turn can lead to better rehabilitation of the impaired. Sec-
ond, autonomous walking robots could greatly enhance the entertainment ex-
perience for visitors of theme parks and the like. Both long-term goals impose
identical requirements on bipedal robots. They should be anthropomorphic
in function and appearance, their locomotion should be robust, natural and
energy eﬃcient, and they should be easy to construct and control.
A solution for energetic eﬃciency is the exploitation of the ’natural dy-
namics’ of the locomotion system. In 1989 McGeer [6] introduced the idea
of ‘passive dynamic walking’. He showed that a completely unactuated and
therefore uncontrolled robot can perform a stable walk when walking down a
shallow slope. His most advanced prototype (Figure 1A) has knees and a hip
joint, which connect in total four thighs and shanks (with rigidly attached
circular feet). The inner two legs form a pair and so do the outer legs, so that
the machine essentially has 2D behavior.
We believe that passive dynamic walking should be the starting point
for successful biped design. For a human-like robot walking on level ground,
a necessity of actuation arises for energy input (instead of walking down a
slope), and for stabilization against large disturbances. We propose a robot
design that can perform a robust motion as a result of the passive dynamics,
while the actuators only compensate for friction and impact energy losses.

144
Martijn Wisse, Jan van Frankenhuyzen
(A)
(B)
Fig. 1.
(A)
Close
copy
of
McGeer’s walker by Garcia et
al., (B) 2D biped prototype
MIKE
We are materializing this combination of passive dynamic walking and
actuation in the form of our new prototype MIKE (see Figure 1B). On top
of the speciﬁcations of McGeer’s machine, MIKE is provided with McKibben
muscles (pneumatic actuators) in the hip and knee joints that can provide
energy for propulsion and control, thus eliminating the need for a slope and
providing an enhanced stability. In this paper we will describe the design and
construction of MIKE, focusing in sections II - V on the key construction
elements; foot shape, McKibben muscles, pneumatic system, pressure control
unit. Section VI presents walking experiments of MIKE walking downhill and
on a level ﬂoor.
2
Foot shape
2.1
Foot shape in literature
The human foot is shaped so that the center of pressure (the average contact
point) travels forward during the progression of a walking step. This eﬀect
is known as ‘foot roll-over’. When replicating the human foot for prostheses
or for walking robots, many designers apply a curved foot sole with an ap-
proximately circular foot roll-over shape. For contemporary foot prostheses,
Hansen et al. [4] shows the eﬀective foot roll-over shapes of diﬀerent makes.
From his graphs we conclude that they all have a foot radius of 30-35 [cm].
Apparently that was empirically determined to be the best foot shape.
In passive dynamic walking robot research, many computer models and
prototypes are equipped with circular feet, following McGeer’s example. McGeer [6]
determined the eﬀect of the foot radius on the local stability (i.e. small dis-
turbances) of his walkers and so concluded that a foot radius of about 1/3 of
the leg length would be a good choice. However, we argue that a good local
stability does not imply a good disturbance rejection for larger disturbances.
As an example, we compare the ﬁndings of Garcia et al. [2] on the simplest
walking model with our own. Their simplest walking model was equipped

Design and Construction of MIKE
145
with point feet (foot radius equal to zero), and showed stable downhill walk-
ing for slopes up to 0.015 [rad]. However, when studying the allowable size
of the disturbances for that model [10], we found that even a 2% change of
the initial stance leg velocity could make the model fall over. In conclusion,
more information is needed about the eﬀect of the foot roll-over shape on the
allowable size of the disturbances.
2.2
Test machine for foot roll-over shape
We built a test machine (Figure 2) to answer the question: ‘with what foot
radius can the largest disturbance be handled?’ The test machine weighs 3 [kg]
and is, with a leg length of 38 [cm], approximately half the size of MIKE. It
has no knees, the only joint is at the hip. The test machine was placed on a
shallow slope with a disturbance half-way. The disturbance was realized by
lowering the second half of the walkway. The stability was quantiﬁed as the
largest amount of lowering that the test machine could still recover from and
continue walking to the end of the slope.
0
2
4
6
8
100
200
300
400
foot radius [mm]
* *
*
*
    max disturbance [mm]
Fig. 2. Stability results of the
test machine (left) tested with
four diﬀerent foot radii: 50,
100, 190 and 380 [mm] with a
foot length limited to approx.
8 [cm]. Apparently a larger
foot radius is always better
We built four diﬀerent sets of feet with radii from 50 [mm] to 380 [mm],
but limited the foot length to about 8 [cm]. The results are plotted in Figure 2.
Apparently, the larger the foot radius the better, as coincides with intuition.
Of course, when the foot length is limited, there is no gain in increasing the
foot radius above a certain value; the walker would just spend more time on
the heel and toe.
2.3
Construction
Theoretically, MIKE needs feet with a radius as large as possible. In practice
however, there is a limitation to the length of the foot due to the required
foot clearance. If the foot is long, bending the knee will not result in enough
clearance for the swing leg, but rather in the opposite. Based on the empiri-
cally determined prosthetic foot shape and some experimenting with MIKE,

146
Martijn Wisse, Jan van Frankenhuyzen
eventually we decided on a foot radius of 25 [cm] and a length of 13 [cm].
This is pretty close to McGeer’s recommended 1/3 of the leg length.
Another practical consideration is the place of attachment of the foot to
the shank. McGeer shifted the feet somewhat forward from the center, so that
the passive reaction torques would keep the knees locked during the stance
phase. We don’t need this, for we have muscles to actively extend the knees.
However, empirical study showed that the best stability results were obtained
indeed with the feet shifted forward about 6 [cm], see Figure 3.
Fig. 3. In practice, we obtained the best results
with a foot radius of 25 [cm], a foot length of 13 [cm],
and a forward displacement of 6 [cm]. The foot
switch allows the controller to adapt to the actual
step time by registering the exact instant of heel
strike
3
McKibben muscles as adjustable springs
3.1
Background and requirements
For autonomous systems, it is crucial to apply lightweight actuators. For a
passive dynamic walker, another requirement is that the actuators should
not interfere with the passive swinging motions of the legs. McGeer says the
following about this matter: “The geared motors or ﬂuidic actuators used
on most mechanical bipeds do not satisfy this requirement; lift one of their
legs, and it will hang catatonically or, at best, grind slowly to a halt at
the bottom of its swing.” We chose to use pneumatic McKibben muscles as
actuators that fulﬁll these requirements. In comparison to other alternatives,
such as commercially available pneumatic cylinders, McGeer’s LITHE [7],
Direct Drive torque motors, or MIT Leglab’s Series Elastic Actuators [9],
the McKibben muscles are very lightweight and simple in construction and
application.
Under constant pressure the McKibben muscles behave like a spring with
low hysteresis. Because the muscles can only provide tension force, we use
them in a pair of antagonists, counteracting on the same passive joint (see
Figure 4). Increasing the internal pressure results in a higher spring stiﬀness,
which in turn increases the natural frequency of the limb.
3.2
Operating principle, technical realization and results
A McKibben muscle consists of ﬂexible rubber tube, covered by a weave of
ﬂexible yet non-extensible threads, see Figure 5. The operating principle is

Design and Construction of MIKE
147
Fig. 4. Overview of the McKibben muscles on MIKE. Each
muscle drawn represents two muscles performing the same
function in the machine
best explained when starting with a non-attached, pressurized muscle. If from
that state the muscle is extended, the non-extensible threads are forced into
an orientation with a smaller inter-thread angle, thus decreasing the diam-
eter of the muscle. The cumulative eﬀect of muscle extension and diameter
0.45 MPa
0.4 MPa
0.3 MPa
0.2 MPa
40
30
20
10
0
5
10
15
20
Travel (mm)
Force
(N)
50
P
P
F
F
Fig. 5. McKibben muscles; (left top) operating principle, (left bottom) photo-
graph of the Shadow muscle, (right) force-length diagram
reduction is a decrease of muscle volume. Against an assumed constant mus-
cle pressure, reducing the muscle volume costs work. This work can only be
supplied by a tension force in the muscle attachments. In other words; mus-
cle extension causes a counteracting force, which makes the muscles act like
tension springs. A more detailed study of the McKibben muscle used as an
adjustable spring can be found in [11], where the relation between muscle
extension and tension force is presented as:
F =
b2P ′
2πn2L0
∆L
(1)
with F = muscle force, b = length of weave threads, P ′ = relative muscle
pressure, n = number of turns of a thread, L0 = muscle rest length, and
∆L = relative muscle extension. This relation reveals the most important
characteristics of a McKibben muscle:

148
Martijn Wisse, Jan van Frankenhuyzen
• The muscles behave like linear springs,
• The spring constant is proportional to the muscle pressure.
McKibben muscles are based on a simple concept and are generally easy
to construct. However, it is our experience that the choice of materials and
connectors is important for the muscle lifetime. Therefore, we use commer-
cially available muscles (Figure 5) made by the Shadow Group [3], which
they sell at £6 each. The muscles weigh less than 10 grams and can produce
a force of 40 [N] at 0.40 [MPa].
Figure 5 shows the mechanical behavior of one type of Shadow muscle (6
mm diameter, 150 mm length) at diﬀerent pressure levels. Note that indeed
the muscles behave like linear springs (in this range). Also, note that there
is a small but noticeable hysteresis-loop, representing losses mainly due to
friction between the scissoring threads and the rubber tube.
4
Pneumatic system
4.1
Background and presumptions
Because a McKibben muscle needs pressurized gas for functioning, our au-
tonomous biped MIKE needs to be provided with an eﬃcient, lightweight
and properly working pneumatic system. First of all, we have to carry along
our own reservoir of pressurized gas. The gas should be stored at saturation
pressure in order to keep the necessary container volume as small as possible.
Secondly, the high pressure from this container has to be reduced to various
operation pressure levels between 0.1 [MPa] and 0.4 [MPa].
Minimizing gas consumption helps to increase the autonomous operation
time. Van der Linde [11] developed the so called ‘Actively Variable Passive
Stiﬀness’-system. This system includes a solenoid 3/2 valve that switches the
internal muscle pressure between two preset pressure levels. In this way, only
a small volume of gas is needed every time the muscle is activated, because
the muscle pressure is never completely vented to ambient pressure.
4.2
Requirements
To have time for proper experiments, we need a few minutes of autonomous
operation time on one gas container. Measurements on the amount of exhaust
gas, during a pressure decrease from 0.35 to 0.15 [MPa] in one muscle, tell
us that we need 44 milligrams CO2 per actuation. During each step 4 muscle
activations take place, so that we need 176 milligrams of gas each step. The
step time is 0.6 seconds. By choosing an ISI CO2-bulb [5] with 86 grams of
gas, we have an acceptable 5 minutes of continuous experimental time.
Because our goal is to build a transportable and easy to handle biped, we
(intuitively) put the maximum total weight on 7 kg. Regarding the amount

Design and Construction of MIKE
149
(and weight) of the electrical and mechanical sub-systems, a total weight of
the pneumatic system of 1 kg seems to be acceptable.
Since the muscle pressure is directly related to the stiﬀness, it is important
to be able to control the pressure levels with high accuracy. A relatively short
response time is needed to make it possible to execute control actions during
a step time of 0.6 seconds.
4.3
System overview
The pneumatic system provides the actuation for our prototype MIKE. The
pneumatic system receives input from the on-board controller in the form of
valve control signals. The controller determines when each muscle is activated
or de-activated. The two respective muscle pressures are to be preset manually
when tuning the prototype. The output of the pneumatic system obviously
has the form of joint torques that inﬂuence the passive dynamic leg motions.
PRESSURE REGULATING SYSTEM (SEE FIG. 8)
McKIBBEN MUSCLE (SEE FIG. 5)
SOLENOID VALVE (SMC-
TYPE VQZ 115)
CARBONDIOXIDE-CONTAINER
Fig. 6.
Overview of the pneu-
matic system on MIKE
To provide for this desired input-output behavior, the pneumatic sys-
tem consists of four components (see Figure 6): 1) gas container, 2) manu-
ally adjustable pressure reduction valves, 3) electronically controlled 3/2-way
switching valves, and 4) McKibben muscles. The pressure reduction system
is the most crucial part of the pneumatic system. We developed this system
and will present it in the next section. For the valves we use the pilot pressure
operated VQZ 115 valves from SMC [8]. Although these are about the most
eﬃcient commercially available valves, they still consume 0.5 Watts each. We
are encouraging suppliers to develop more eﬃcient valves. The McKibben
muscles have been discussed in the previous section.
5
Pressure control unit
5.1
Background and requirements
The pressure control unit must be able to regulate the desired muscle pres-
sures accurately and fast (well within the step time of 0.6 seconds). Second,

150
Martijn Wisse, Jan van Frankenhuyzen
application in an autonomous biped requires a compact, lightweight and gas
eﬃcient solution.
There are two commercially available regulator principles, each of which
can only fulﬁll part of the above requirements. The indirectly controlled pres-
sure regulators (ﬂapper-nozzle type) provide fast and accurate pressure con-
trol at the cost of a high internal gas consumption and relatively large physical
dimensions. Directly controlled pressure regulators (piston type) are generally
small and lightweight and need no extra gas supply for internal consumption,
but are not sensitive and accurate enough for our application. We used the
directly controlled principle, as small size and gas eﬃciency are the most
important requirements, and minimized the disadvantages.
5.2
Operating principle
The piston type pressure regulator is drawn in Figure 7. A valve separates
the input pressure from the output pressure. The output pressure acts on a
spring loaded piston, where the manually adjustable spring load represents
the output pressure level. If the output pressure falls below this preset value,
A
Pin
Pout
A
Exhaust
C
Pin
C
From high pressure
       supply
From muscle
(via valve)
Relief into 
atmosphere
To muscle (via valve)
a)
b)
Fig. 7. Working principle of (a) pres-
sure regulator valve and (b) pressure
relief valve
the spring loaded piston opens the valve and the output pressure level is
restored. To ascertain that the pressure regulator is sensitive, it needs to be
constructed with a high ratio of A:C (see Figure 7) and with low internal
friction.
The low preset pressure level is realized by integrating a separate pressure
relief valve (see Figure 7) in the muscle outlet. The spring loaded piston in
the pressure relief valve is open as long as the muscle pressure is higher than
the preset level (drawn situation).
5.3
Technical realization and results
The principles discussed above are translated into functioning prototypes.
Experiments have convinced us that the required relatively high accuracy
cannot be met by a single-stage pressure regulator, due to pressure overshoot
and steady state oﬀset. Therefore we have divided the pressure reduction in
two stages, see Figure 8.

Design and Construction of MIKE
151
First, one main pressure regulator directly on the gas bulb brings the pres-
sure from 5.8 [MPa] to about 1.0 [MPa]. Second, a second-stage reduction
from 1.0 [MPa] to 0.2 – 0.4 [MPa], with 4 diﬀerent preset manually adjustable
pressure levels, is realized in the input pressure control block (‘IN’, Figure 8).
In these valves, the pistons are equipped with diaphragms to minimize fric-
tion eﬀects and to provide the required sensitivity and accuracy. The output
pressure control block (‘OUT’) includes four adjustable pressure relief valves.
Basically the same piston construction as in the input pressure reduction
valves has been used. The two pressure-control blocks together weigh about
180 gram and have a volume of less than 8 x 5.5 x 1.5 cubic centimeter.
After assembling the complete pneumatic system, it is possible to evaluate
the behaviour by measuring the muscle pressure in time, during a switching-
action of the described solenoid valve. Figure 8 shows the dynamic response
of the complete system (see Figure 6) when pressurized from 0.15 [MPa]
to 0.35 [MPa] and back. We obtain an accuracy/repeatability of about 10
[kPa], and a relatively slow response as was to be expected with the choice
of pressure regulator type. However, the system is fast enough according to
the successful walking results.
IN
OUT
MAIN
TO
SOLENOID
VALVE
0.2
0.25
0.3
0.35
0
0.2
0.3
0.4
0.5
0.6
0.1
0.15
0.4
Relative
pressure
(MPa)
Time (seconds)
Fig. 8. (left) technical drawings of pressure reduction system, (right) dynamic
response of the complete pneumatic system
6
Walking experiments
6.1
Downhill walking
We performed walking experiments with an increasing number of active de-
grees of freedom, starting with walking down a slope with rigid knees. With
rigid knees, foot scuﬃng is inevitable. To eliminate this problem for our ini-
tial experiments, we constructed ’stepping stones’ at the expected footfall

152
Martijn Wisse, Jan van Frankenhuyzen
locations. Together with the slope angle this required some tuning, eventu-
ally resulting in stable walking with steps of 0.24 [m] at a slope angle of
0.06 [rad].
In this setting, we could start with experiments with rigid knees, similar
to the testing machine in Figure 2. With the Agilent HEDS-5540 incremental
optical encoder on the hip joint, the hip angle was recorded during a successful
run as shown in Figure 9. As is apparent from the ﬁgure, the gait was not
symmetrical. When the middle legs were swinging (positive hip angle), the
step was much longer in duration. Heel strike only occurred when they were
already far on their way back, noticeable by the small bump (impact shock) in
the graph. It is not clear whether this asymmetry resulted from a non-perfect
launch or from the machine’s natural dynamics. A simulation study in the
near future should reveal this. Although not symmetrical, the emergent gait
was encouraging enough to continue with experiments with bending knees.
0
1
2
3
4
5
6
-0.6
-0.3
0
0.3
0.6
time [s]
relative hip angle  [rad]
heel
strike
heel
strike
inner
legs
swing
outer
legs
swing
manual
launch
manual
stop (catch)
0
1
2
3
4
5
6
7
-0.6
-0.3
0
0.3
0.6
time [s]
heel
strike
knee
strike
Fig. 9. Walking results (left) with stiﬀknees on a ﬂoor with stepping stones on
a 0.06 [rad] slope, (right) with active knees on a 0.06 [rad] slope. The prototype
completes 7 symmetrical steps until the end of the walking surface
By bending the knee for the appropriate time interval during the swing
phase of a leg, the prototype can gain just enough foot clearance for contin-
uous walking without stepping stones. As McGeer has shown, it is possible
to obtain the appropriate timing with pure passive dynamics by tuning the
mechanical properties. In our experience, it is then essential to keep the cen-
ter of mass of the shank very close below the knee joint. However, we want
the ability to actively interfere with the knee motion for future rough terrain
walking experiments, so MIKE was provided with knee-stretching muscles.
Having these muscles there anyway, we decided to actively control the knee
motion rather than completely rely on the passive dynamic motion.
The knee is stretched actively with a McKibben muscle counteracted by
a passive spring, see Figure 4. The default knee muscle pressure is ‘high’
(0.35 [MPa]), which is switched to ‘low’ (0.08 [MPa]) at the other leg’s heel
strike, and switched back to ’high’ after an empirically determined 400 [ms].
With this activation pattern we obtained steady walking for the entire length

Design and Construction of MIKE
153
of the slope (5 [m]) with the appearance to be able to continue to walk
indeﬁnitely, see Figure 9. It is easy to launch the prototype by hand, so
we would call it ‘pretty stable’. We have not yet performed experiments to
determine the exact stability of the gait.
In these walking experiments MIKE has about the same speciﬁc resistance
as a walking human being, using about 10 [W] to pull its 7 [kg] along at a
speed of 0.4 [m/s]. The energy consumption consists of three components.
First, the propulsion is obtained from gravity by walking down a 0.06 [rad]
slope, which counts for 1.6 [W]. Second, the knee muscles use approximately
0.4 [MPa] CO2 which accounts for 5.3 [W]. Actually, to keep the storage
volume small, the CO2 is stored and supplied at the saturation pressure,
5.8 [MPa]. The inevitable loss of energy in the process of pressure reduction
from 5.8 to 0.4 [MPa] is not taken into account. Third, the prototype is
equipped with a number of sensors and a a low power (less then 1 [W]) Strong-
Arm based Linux machine (the LART [1]), which use together about 3 [W].
Obviously, the bulk of the energy consumption goes to the architecture for
improving the stability even when using low-power components. We hope to
increase the walking stability without increasing the energy consumption even
more by using the timing of the muscle activations as a control parameter [11].
6.2
Walking on level ﬂoor
Finally, we activated the hip muscles and leveled out the walking surface.
That made the robot lose its natural tendency to tilt and walk forward,
so we had to shift the center of mass forward with a few centimeters. The
hip muscles are the same as the knee muscles, but operate as antagonistic
pairs. When heel strike is detected one muscle is set to high, its antagonist
to low, so that the swing leg is pulled forward. We have not yet performed
accurate measurements on the torque that the muscles exert on the hip, but
it is estimated to be below 2.5 [Nm], approximately the same as the maximal
torque from gravity. This simple form of hip control is suﬃcient to obtain a
robust gait, see [12].
Mike performs a steady walk on a level ﬂoor, as demonstrated with video’s
at http://dbl.tudelft.nl/. It can handle irregularities in the terrain, such as
the sidewalk in front of our building.
With the ability to walk on level ground, we ﬁnally had the opportunity
to perform an endurance test. On the 86 grams of CO2, MIKE can walk 3.5
minutes. After a continuous walk that long, the main pressure regulator is
deeply frozen due to gas expansion; apparently it is a little undersized for the
actual gas ﬂow.
7
Conclusion
We started this research with the question: “How to keep the actuators and
energy storage device lightweight enough to enable autonomous operation for

154
Martijn Wisse, Jan van Frankenhuyzen
a walking biped?” Our solution is provide the biped with a pneumatic actua-
tion system. This form of actuation is successful when applying the following
two ideas: 1) use McKibben muscles as adjustable springs and 2) develop a
compact and well performing pneumatic system. With these developments
we were able to construct a fully autonomous biped. We have succeeded in
making it walk in a stable manner on a level ﬂoor, see http://dbl.tudelft.nl/.
Now that we have concluded the ﬁrst phase of this project, we are aiming
at the following goals: ﬁrst to add an upper body while maintaining passive
dynamic properties, and ﬁnally to extend to three dimensions.
Acknowledgements
This research is funded by the Dutch national technology foundation STW.
Thanks to Richard van der Linde, Arend Schwab, Dick Plettenburg, Frans
van der Helm, Erik Mouw and Jan-Derk Bakker.
References
1. LART board. Strong-arm based low power linux machine, developed at delft
university of technology. (http://www.lart.tudelft.nl/).
2. M. Garcia, A. Chatterjee, A. Ruina, and M. J. Coleman. The simplest walking
model: Stability, complexity, and scaling. ASME J. Biomech. Eng., 120(2):281–
288, April 1998.
3. Shadow Group.
(http://www.shadow.org.uk).
4. A. H. Hansen, D. S. Childress, and E. H. Knox. Prosthetic foot roll-over shapes
with implications for alignment of trans-tibial prostheses. Prosthetics and Or-
thotics International, 24:205–215, 2000.
5. ISI.
(http://www.isi-group.com).
6. T. McGeer. Passive dynamic walking. Intern. J. Robot. Res., 9(2):62–82, April
1990.
7. T. McGeer. Passive dynamic biped catalogue. In R. Chatila and G. Hirzinger,
editors, Proc., Experimental Robotics II: The 2nd International Symposium,
pages 465–490, Berlin, 1992. Springer–Verlag.
8. SMC pneumatics.
(http://www.smcusa.com).
9. G. Pratt and M. Williamson. Series elastic actuators. In Proceedings of IROS
’95, Pittsburgh, PA, 1995.
10. A. L. Schwab and M. Wisse. Basin of attraction of the simplest walking model.
In Proc., International Conference on Noise and Vibration, Pennsylvania, 2001.
ASME.
11. R. Q. vd. Linde. Design, analysis and control of a low power joint for walking
robots, by phasic activation of mckibben muscles. IEEE Trans. Robotics and
Automation, 15(4):599–604, August 1999.
12. M. Wisse, A. L. Schwab, R. Q. van der Linde, and F. C. T. van der Helm. How
to keep from falling forward; elementary swing leg action for passive dynamic
walkers. Submitted to IEEE Transactions on Robotics, 2004.

Learning Energy-Eﬃcient Walking with
Ballistic Walking
Masaki Ogino1, Koh Hosoda1,2 and Minoru Asada1,2
1 Dept. of Adaptive Machine Systems, Graduate School of Engineering,Osaka
University, 2-1 Yamadaoka, Suita, Osaka, 565-0871, Japan
2 HANDAI Frontier Research Center, Osaka University, 2-1 Yamadaoka, Suita,
Osaka, 565-0871, Japan
Abstract. This paper presents a method for energy eﬃcient walking of a biped
robot with a layered controller. The lower layer controller has a state machine for
each leg. The state machine consists of four states: 1) constant torque is applied to
hip and knee joints of the swing leg, 2) no torque is applied so that the swing leg can
move in a ballistic manner, 3) a PD controller is used so that the certain posture
can be realized at the heel contact, which enables a biped robot to walk stably, and
4) as the support leg, hip and knee joints are servoed to go back and the torque
to support upper leg is applied. With this lower layer controller, the upper layer
controller can search parameters that enable the robot to walk as energy eﬃciently
as human walking without paying any attention to fall down.
1
Introduction
Comparing with human walking, bipedal walking of the current robots is
rather rigid since it does not utilize natural dynamics while human walking
does. Passive dynamic walking (PDW) is the walking mode in which a robot
can go down a shallow incline without any control nor any actuation, only
with its own mechanical dynamics [1], and it is one approach to realize natural
motion in a robot. This walking looks so similar to human walking that
many researchers have intensively studied its characteristic features and the
conditions that enable a robot to walk in a PDW manner [2][3][8][9][10][13].
Although PDW teaches us that mechanical dynamics of a robot can reduce
control eﬀorts for walking, the structural parameters and initial conditions
to realize PDW are strictly limited, and it is not always known how we can
apply PDW properties to walking on a level ﬂoor. The properties that a
controller should have in order to realize both stable and energy eﬃcient
walking simultaneously are not known yet.
We suppose that one of such properties is to have a control phase in which
no torque is applied to a robot, instead the gravitational and inertial force
are utilized for motion. Such kind of walking is called ”ballistic walking”.
Ballistic walking is supposed to be a human walking model suggested by
Mochon and McMahon [6]. They got the idea from the observation of human
walking data, in which the muscles of the swing leg are activated only at the
beginning and the end of the swing phase.

156
M. Ogino, K. Hosoda, M. Asada
There are a number of methods to realize ballistic walking. Taga proposed
a CPG controller that enables a human model to walk very stably with as
the same energy eﬃciency as human walking [14]. The torque proﬁle of his
model shows the ballistic properties clearly. His CPG model is, however, very
complicated and it is not always necessary to use CPG to realize energy ef-
ﬁcient walking in a robot if the same properties are realized with a simpler
controller. Actually, Linde shows that the energy eﬃcient walking can be real-
ized by a simple controller in which muscle contraction is activated by sensor
information of foot contact [4]. Recently, Pratt demonstrated in simulation
and in a real robot that energy eﬃcient walking is possible with a simple
state machine controller, in which the knee joint of the swing leg moves pas-
sively in the middle of the swing phase [11]. He determined the parameters
of walking by hand coding and genetic algorithm, and it is unclear to make
the energy eﬃcient walking with learning from non-eﬃcient walking.
In this paper, to utilize mechanical dynamics of a robot structure, we let
the hip joint free in the middle of the swing phase, and use torque control
instead of a PD controller in the beginning of the swing phase. Moreover, the
learning module is added to the state machine controller so that the minimum
energy walking can be realized.
The rest of the paper is organized as follows. First, the state machine
controller to realize ballistic walking is introduced. Next, the learning module
to optimize the parameters of the state machine controller is described. Then,
the proposed controller is applied to a biped model that has the same length
and mass to a human.
2
Ballistic walking with state machine
Here, we use a robot model consisting of 7 links: a torso, two thighs, two
shanks and two foots as shown in Fig.1. The parameters of the robot are
shown in Table 1.
The state machine controller at each leg consists of four states, as shown
in Fig 2: the beginning of the swing phase (swing I ), the middle of the swing
phase (swing II ), the end of the swing phase (swing III ), and the support
phase (support).
In the support phase, the hip joint is controlled with a proportional deriva-
tive (PD) manner so that the torso stands up and the support leg goes back.
To the knee joint, torque is applied so that the knee joint becomes straighten
during the support phase. Therefore, the torque applied to the hip and waist
joint are given by the following equations;
τ1 = −Kp(θ1 −θ1d) −Kv( ˙θ1 −˙θ1d) −Kwpθw −Kwv ˙θw,
(1)
τ2 = −Kp(θ2 −θ2d) −Kv( ˙θ2 −˙θ2d).
(2)
The reference trajectory for the above PD controllers are described with the
simple sinusoidal functions which connect the angle of the beginning of the

Learning Energy-Eﬃcient Walking with Ballistic Walking
157
Upper Body (3.0[kg] )
Thigh (0.5[kg] )
Shank (0.5[kg] )
Foot  (0.2[kg])
0.5[m]
0.3[m]
0.3[m]
 0.08 [m]
w
1
2
3
Fig. 1. Robot model
support
swing I
swing II
swing III 
t > Tswg1
t > Tswg1 +Tswg2
Heel Contact
(t is set to 0)
Heel Contact
of another leg
(t is set to 0)
Fig. 2. A state machine controller consisting of four states
state to the desired angle which should be realized at the end of the state,
θ1d(t) =

(θ1e−θ1s)
2
(1 −cos
πt
Tspt ) + θ1s (t < Tspt)
θ1e
(t ≥Tspt) ,
(3)
˙θ1d(t) =

π(θ1e−θ1s)
2Tspt
sin
πt
Tspt (t < Tspt)
0
(t ≥Tspt) ,
(4)

158
M. Ogino, K. Hosoda, M. Asada
θ2d(t) =

(θ2e−θ2s)
2
(1 −cos
πt
Tspt ) + θ2s (t < Tspt)
θ2e
(t ≥Tspt)
(5)
and
˙θ2d(t) =

π(θ2e−θ2s)
2Tspt
sin
πt
Tspt (t < Tspt)
0
(t ≥Tspt)
(6)
where θ∗s indicates the angle at the moment when the controller enters the
support phase (the moment of contact of the swing leg with the ground),
and θ∗e indicates the desired angle that should be realized at the end of the
support phase. t is the time since the controller enters to the support phase
and Tspt is the desired time when the support phase ends. In this simulation,
the control gains are set as Kp = 300.0 [Nm/rad], Kv = 3.0 [Nm sec/rad],
Kwp = 300.0 [Nm/rad] and Kwv = 0.3[Nm sec/rad], and the desired angles
of the end of the support phase are set as θ1e = 20.0 [deg] and θ2e = 0.0
[deg].
The swing phase is separated to three states; swing I (the beginning
phase), swing II (the middle phase), and swing III (the end phase). In swing
I, the controller applies constant torque to both the hip and knee joint. After
the certain time passes, the control state changes to swing II, in which no
torque is applied to the hip and knee joints. Therefore, in swing II, the swing
leg moves in a fully passive manner. After the swing time passes Tswg2, the
control state changes to swing III, in which the joints are servoed using PD
controllers so that the desired posture at the end of the swing phase can be
realized. By taking a certain posture at the moment of ground contact, a
certain degree of walking stability can be assured. The state of the controller
transits to the state support when the swing leg contacts with the ground.
The output torque can be summarized as the following equations,
τ1 =
⎧
⎨
⎩
A
(t < Tswg1)
0
(Tswg1 ≤t < Tswg1 + Tswg2)
−Kp(θ1 −θ1d) −Kv( ˙θ1 −˙θ1d) (Tswg1 + Tswg2 ≤t)
(7)
and
τ2 =
⎧
⎨
⎩
−B
(t < Tswg1)
0
(Tswg1 ≤t < Tswg1 + Tswg2)
−Kp(θ2 −θ2d) −Kv( ˙θ2 −˙θ2d) (Tswg1 + Tswg2 ≤t)
, (8)
where the reference trajectory in swing III is given in the same manner as
the support phase, eqs.(4)-(7). In our study, the desired angles of the hip
and knee joints at the end of the swing phase are set as θ1e = −20 [deg] and
θ2e = 0 [deg], respectively. Tswg1 and Tswg2 are set to 0.2 [sec], and 0.05 [sec].
Throughout walking, a PD controller with the weak gains (K′
p = 3.0
[Nm/rad] and K′
v = 0.3 [Nm sec/rad]) is used to the ankle joints,
τ3 = −K′
p(θ3 −θ3d) −K′
v( ˙θ3 −˙θ3d)
(9)

Learning Energy-Eﬃcient Walking with Ballistic Walking
159
The desired angle of the ankle joint is always ﬁxed to 90 [deg]. Therefore, the
ankle joint works as a spring is attached.
The simulation result of the controller is shown in Fig. 3, in which the
resultant torque curves are shown with control mode during one period (two
steps). In this ﬁgure, the control modes 1, 2, 3 and 4 correspond to swing
I, swing II, swing III and support, respectively. In Fig. 3, large torque is
-15
-10
-5
0
5
10
15
Torque [Nm]
1.4
1.2
1.0
0.8
0.6
0.4
0.2
0.0
Time [sec]
4
3
2
1
Control Mode
hip
knee
ankle
Control State
Fig. 3. State machine mode and torque during one period
observed at the end of the swing phase and the beginning of the support
phase. This torque might be caused by too large or too small torque applied
at the beginning of the swing phase. If the appropriate torque is applied in
swing I (at the beginning of the swing phase), this feedback torque might be
lessen and the more energy-eﬃcient walking could be realized. In the next
section, the optimization of this torque is attempted by adding a learning
module.
3
Energy minimization by a learning module
To realize the energy eﬃcient walking, a learning module which searches
appropriate output torque in swing I is added to the controller described
in the previous section (Fig.4). Besides torque, the learning module searches
the appropriate value of control parameters which determine the end of the
duration of passive movement, Tswg2. It is noted that these parameters are
not related to the PD controller which stabilizes walking. For the evaluation
of energy eﬃciency, we use the average of all the torque which is applied
during one walking period (two steps),
Eval =
1
Tstep
 Tstep
0
3

i=1
τidt
(10)
Using this performance function, the appropriate values of the parameters
are searched in the probabilistic ascent algorithm as follows.

160
M. Ogino, K. Hosoda, M. Asada
Learning Module
right leg
support
swing 1
swing 2
swing 3 
Evaluation of Torque
Control
Parameters
(A,B,Tswg2)
State Machine Layer
left leg
swing 1
swing 2
swing 3 
Fig. 4. Ballistic walking with learning module
1
if(Eval < Evalmin)
2
Amin = A
3
Bmin = B
4
Tswg2min = Tswg2
5
A = A + random perturbation
6
B = B + random perturbation
7
Tswg2 = Tswg2 + random perturbation
The simulation results are shown in Fig. 5. Figures 5 (a), (b) and (c) show
the time courses of the output torque applied to the hip and knee joints in
swing I, A, B, and the passive time, Tswg2, and the average of total torque,
Eval, respectively. Even though the input torque changes variously, the PD
controller in swing III which keeps the posture at ground contact constant
realizes a stable walking.
1.2
0.8
0.4
0.0
Torque [Nm]
140
120
100
80
60
40
20
Walking Step
Amin
A
Bmin
B
(a) torque
0.25
0.20
0.15
0.10
0.05
Tswg2 [sec]
140
120
100
80
60
40
20
Walking Step
Tswg2min
Tswg
(b) Tswg2
12
10
8
6
4
Eval
140
120
100
80
60
40
20
Walking Step
Eval_min
Eval
(c) average of total
torque
Fig. 5. Learning curve of control parameters and total torque
Comparing the ﬁrst step with the 80th the average of total torque de-
creases (Fig. 5(c)), even though the output torque of the beginning of the

Learning Energy-Eﬃcient Walking with Ballistic Walking
161
-15
-10
-5
0
5
10
15
Torque [Nm]
1.6
1.4
1.2
1.0
0.8
0.6
0.4
0.2
0.0
Time [sec]
4
3
2
1
Control Mode
ankle
knee
hip
Control State
Fig. 6. State machine mode and torque by a state machine controller with a learning
module
swing phase at the 80th step is almost the same as the ﬁrst step (Fig. 5(a)),
whereas the passive time, Tswg2, increases (Fig. 5(b)). The total torque of
walking, therefore, depends more on the passive time than the magnitude of
the feed forward torque that is given in the beginning of the swing phase.
Furthermore, in the ﬁnal stage of learning, after the 120th step, the output
torque of the hip joint at the beginning in the swing phase becomes zero while
the torque of the knee joint increases. This result might be strange because
many researchers have applied torque to hip joint in swing phase. In this
stage, the large energy output appears among weak ones (Fig. 5(c)). This
may be because a robot walks on a wing and a prayer on the subtle balance
between dynamics and energy. Once the balance is lost, the PD controller
compensates stability with large torque.
Fig. 6 is the time-course of the torque around the 80th step. Comparing
the torque appeared in Fig. 6 with those in Fig. 3, the total torque are reduced
about 1/10 in the hip and knee joints, whereas the torque proﬁle at the ankle
joint is almost the same.
4
Comparing with human data
In this section, we apply the proposed controller to the model that has the
same mass and length of links as human, and the torque and angle of each
link are compared with the observed data in human walking.
For parameters of human model, we use the same model as that of Ogihara
and Yamazaki [7], which is shown in Table 1. The control gains at hip and
knee joints are set as Kp = 6000.0 [Nm/rad], Kv = 300.0 [Nm sec/rad],
Kwp = 6000.0 [Nm/rad] and Kwv = 100.0 [Nm sec/rad]. The desired angles
at the end of the swing and support phases are the same as in Section 2.
The time course of angle and torque of the simulation results are shown
in Figs. 7 with human walking data (from [15]). The horizontal axis is nor-
malized by the walking period.

162
M. Ogino, K. Hosoda, M. Asada
Mass Length Inertia
[kg]
[m]
[kg m2]
HAT 46.48 0.542
3.359
Tigh
6.86
0.383
0.133
Shank 2.76
0.407
0.048
Foot
0.89
0.148
0.004
Table 1. Mass and length of human model links
-20
-10
0
10
20
Angle [deg]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
(a) angle at hip joint
60
40
20
0
-20
Angle [deg]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
(b) angle at knee joint
-20
-10
0
10
20
Angle [deg]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
(c)
angle
at
ankle
joint
80
60
40
20
0
-20
-40
-60
Torque [Nm]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
Control State
Human
Simulation
(d) torque at hip joint
-100
-50
0
50
100
Torque [Nm]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
(e)
torque
at
knee
joint
120
80
40
0
Torque [Nm]
100
80
60
40
20
0
Walking Period [%]
4
3
2
1
Control State
(f)
torque
at
ankle
joint
Fig. 7. Comparing with human walking data
Human Simulation
Support : Swing [%:%]
60:40
60:40
Walking Rate [steps/sec]
1.9
1.3
Walking Speed [m/sec]
1.46
0.46
Walking Step [m]
0.76
0.36
Energy Consumption [cal/m kg]
0.78
0.36
Table 2. Characteristics of simulation and human walking
At the hip joint, while the time course of joint angle is almost same as
human, torque curve is quite diﬀerent, especially in around 80% and 30%
walking periods in which strong eﬀects of PD controllers appears (Fig. 7(b)).
At the knee joint, the pattern of the time course of joint angle roughly re-
sembles human data in shape except at around the end of the swing phase

Learning Energy-Eﬃcient Walking with Ballistic Walking
163
and the beginning of the support phase, in which the knee joint of human
data becomes straighten but that of simulation data does not. Moreover, the
torque pattern is quite diﬀerent from human data. At the ankle joint, it is
surprised that the torque pattern shares common traits with human data,
even though the ankle joint is modeled as simple spring joint. Fig. 7(f) shows
that, although the control state after the support phase is named ”swing I ”,
it works as double support phase. The rate of swing phase to support phase
is the same as human data (40:60).
Table 2 compares characteristics of walking in the simulation result with
that in human data ([12]). It shows that the simulation algorithm succeeds
in ﬁnding the parameters which enable the human model to walk with 45%
less energy consumption. But this walk may not necessarily mean the energy
eﬃcient walking because the walking speed (and the walking rate) is much
slower than human walking. This may be because the proposed controller
uses the ankle joint only passively, and only the energy consumption is taken
into consideration in the evaluation function (eq. 10). Acquiring fast walking
is our future issue.
5
Discussion
Our controller has a state machine on each leg, which aﬀects each other
by sensor signals. Even this simple controller enables a biped robot to walk
stably. There are two reasons. First, PD controllers at the end of the swing
phase ensure that a biped touches down on the ground with the same posture.
This prevents a swing leg from contacting with too shorter or too longer step
length because of inadequate forward torque given at the beginning of the
swing phase. But this stabilization does not always work well. It mainly
depends on the posture at ground contact. How this posture is determined is
the issue we should attack next.
The second reason for stable walking is that the controller has some com-
mon features to CPG (Central Pattern Generator). In the CPG model, the
activities of neurons are aﬀected by sensor signals (or environment), and as
a result global entrainment between a neural system and the environment
takes place [14]. Our proposed controller doesn’t have a walking period ex-
plicitly. The period of the controller is strongly aﬀected by the information
from touch sensors, which determine the state transition of a state machine
in each leg. It can be said that our controller has some properties like global
entrainment between the state machine controller and the environment.
Walking mode realized in this paper is much slower than human walking
as shown in Table 2. We suppose that the reason of this slow walking owes
to the passive use of the ankle joint. To realize fast walking, it is necessary
to shorten the walking period and to make the step length longer. They are
closely related to the ankle joint setting because the speed of falling forward
of the support leg is largely aﬀected by the stiﬀness of the ankle joint, and the

164
M. Ogino, K. Hosoda, M. Asada
step length can be longer if the support leg rotates around the toe. Controlling
the walking speed is another issue to be attacked.
Acknowledgments
This study was performed through the Advanced and Innovational Research
program in Life Sciences from the Ministry of Education, Culture, Sports,
Science and Technology, the Japanese Government.
References
1. Asano, F. Yamakita, M. and Furuta, K., 2000, “Virtual passive dynamic walk-
ing and energy-based control laws”, Proceedings of the 2000 IEEE/RSJ Int.
Conf. on Intelligent Robots and Systems, pp. 1149-1154.
2. Garcia, M. Chatterjee, A. Ruina, A. and Coleman, M., 1998, “The simplest
walking model: stability, complexity, and scaling”, J. Biomechanical Engineer-
ing, Vol. 120, pp. 281-288.
3. Goswami, A. Thuilot, B. and Espiau, B., 1998, “A Study of the Passive Gait of
a Compass-Like Biped Robot: symmetry and Chaos”, Int. J. Robotics Research,
Vol. 17, No. 12, pp.1282-1301.
4. Van der Linde, R, Q., 2000, “Actively controlled ballistic walking”, Proceed-
ings of the IASTED Int. Conf. Robotics and Applications 2000, August 14-16,
Honolulu, Hawaii, USA.
5. McGeer, T., 1990, “Passive walking with knees”, 1990 IEEE Int. Conf. on
Robotics and Automation, 3, Cincinnati, pp.1640-1645.
6. Mochon, S. and McMahon, T.A., 1980, “Ballistic walking”, J. Biomech., 13,
pp. 49-57.
7. Ogihara, N. and Yamazaki, N., 2001, “Generation of human bipedal locomotion
by a bio-mimetic neuro-musculo-skeletal model”, Biol. Cybern., 84, pp. 1-11.
8. Ogino, M. Hosoda, K. and M, Asada., 2002, “Acquiring passive dynamic walk-
ing based on ballistic walking”, 5th Int. Conf. on Climbing and Walking Robots,
pp.139-146.
9. Ono, K. Takahashi, R. Imadu, A. and Shimada, T., 2000, “Self-excitation con-
trol for biped walking mechanism”, Proceedings of the 2000 IEEE/RSJ Int.
Conf. on Intelligent Robots and Systems, pp. 1149-1154.
10. Osuka, K. and Kirihara, K., 2000, “Development and control of new legged
robot quartet III - from active walking to passive walking-”, Proceedings of the
2000 IEEE/RSJ Int. Conf. on Intelligent Robots and Systems, pp. 991-995.
11. Pratt, J., 2000, “Exploiting Inherent Robustness and Natural Dynamics in the
Control of Bipedal Walking Robots”, Doctor thesis, MIT, June.
12. Shumway-Cook, A. Woollacott, M., 1995, “Motor Control : Theory and Prac-
tical Applications”, Williams and Wilkins.
13. Sugimoto, Y. and Osuka, K., 2002: “Walking control of quasi-passive-dynamic-
walking robot ’Quartet III’ based on delayed feedback control”, Proceedings of
the Fifth Int. Conf. on Climbing and Walking Robots, pp. 123-130.
14. Taga, G., 1995, “A model of the neuro-musculo-skeletal system for human lo-
comotion: I. Emergence of basic gait”, Biol. Cybern., 73, pp. 97-111.
15. Winter, DA., 1984, “Kinematic and kinetic patterns of human gait; variability
and compensating eﬀects”, Human Movement Science, 3, pp. 51-76.

Motion Generation and Control of Quasi
Passsive Dynamic Walking Based on the
Concept of Delayed Feedback Control
Yasuhiro Sugimoto and Koichi Osuka
Dept. of Systems Science, Graduate School of Informatics, Kyoto University, Uji,
Kyoto, 611-0011, JAPAN
Abstract. Recently, Passive-Dynamic-Walking (PDW) has been noticed in the
research of biped walking robots. In this paper, focusing on the entrainment phe-
nomena which is the one of character of PDW, we provide a new control method of
Quasi-Passive-Dynamic-Walking. Concretely, at ﬁrst, for the sake of the continuous
walking of robot and taking place of the entrainment phenomenon, we adopt a kind
of PD control which gains are regulated by the state of the contact phase of swing
leg. And, considering the making use of the concept of DFC, we use (k-1)-th trajec-
tory of the walking robot as the reference trajectory of the k-th step. As a result, it
can be expected that the robot itself generates the optimum stable trajectory and
the walking is stabilized by using this trajectory.
1
Introduction
Recently a lot of researches of humanoid robots or biped locomotion have
been carried out. ASIMO(HONDA) and HRP-series(AIST) are very famous
examples. In such researches of walking robots, recently, Passive Dynamic
Walking(PDW) which was studied by McGeer[1] at ﬁrst, has been noticed.
As the features of this motion, the following are raised: This walking is very
smooth and similar to human’s walking. Secondly, it can be realized only
by the dynamics of robot without any input torques if the robot walks on
smooth slope. Moreover, by using the eﬀect of gravitational ﬁeld skillfully,
the robot walks with high energy eﬃciency. From these features, the various
studies of applications of PDW have been made expecting a realization of a
high-eﬃcient and smooth walking of robot [2][3][4][5][6].
Especially, in the application of PDW, some control methods of Quasi-
Passive-Dynamic-Walking(Quasi-PDW) have been proposed [4][5][6]. Quasi-
PDW means that the robot usually does PDW without any torque inputs,
and just only when the walking begins or disturbances come in, the actuators
of the robot are used for stabilization of walking. As one of this control
method, focusing the contact phase of the swing leg with the ground (we
call it’s state Impact point), we proposed a control method which based on
Delayed Feedback Control(DFC) [5][6]. This control method is very simple
and does not require making any reference trajectory. But, it can not stabilize
the walking without a proper set of initial conditions. (especially it requires

166
Yasuhiro Sugimoto, Koichi Osuka
proper initial velocities) And since it focuses just only on impact point, the
performance of stabilization is relatively small.
Then, refering to the one of the control method of Quasi-PDW[4], we
consider both following two: one is to make use of the concept of the DFC
and the second one is to provide some reference trajectory for continuous
walking. From the above, in this paper, we will propose a new control method
in which (k-1)-th step’s trajectory of the walking robot are used as k-th
reference trajectory and the PD gains in this control low are regulated in each
steps depending on the state of the impact point. By doing so, it is expected
that the robot walks continuously and the entrainment phenomena of PDW
will occur, and then, its walking will converge to the stable trajectory. This
trajectory is equivalent to the trajectory which the robot in PDW generates.
This means that the robot walking ﬁnally becomes to be stabilized by using
PDW trajectory which is made by the robot itself.
2
Model of the walking robot
A model of the biped robot which we consider is shown in Fig.1.
Fig. 1. Compass model of Walking robot
Let the support leg angle be θp , the swing (non-supported) leg angle be
θw, a slope angle be parameter α, and a torque vector which is supplied to
the support leg and the swing leg be τ(t) = [τp , τw]T . And β is the support
leg angle at the collision of the swing leg with the ground. Then, the dynamic
equation of the robot can be derived using the well known Euler-Lagrange
approach:
M(θ)¨θ + N(θ, ˙θ) ˙θ + g(θ, α) = τ(t),
(1)
where M(θ) is the inertia matrix, N(θ, ˙θ) ˙θ is the centrifugal and Colioris term,
and g(θ, α) is the gravity term. See [4] or [6] in detail. If we assume that a
transition of the support leg and the swing leg occurs instantaneously and

Motion Generation and Control of Quasi Passsive Dynamic Walking
167
the impact of the swing leg with the ground is inelastic and occurs without
sliding, the equation of transition at the collision can be derived by using the
conditions of conservation of angular momentum:
Pb(β) ˙θ−= Pa(β) ˙θ+,
(2)
where ˙θ−, ˙θ+ are the pre-impact and the post-impact angular velocities re-
spectively. The details of Pb(β), Pa(β) are provided in [4] or [6].
And we diﬁne an vector p as:
p(k) = (βk, ˙θ−
p,k, ˙θ−
w,k)T ,
(3)
where βk is β at the k-th collision, ˙θ−
p,k and ˙θ−
w,k are the k-th pre-impact
angular velocities of the support leg and the swing leg respectively. And we
call this p as Impact point.
3
Stability of passive dynamic walking
If the input torques are assumed to be constant over each k-th step and some
assumptions will be hold, it can be stated that the discrete dynamic system of
impact point: p(k+1) = P(p(k), τ(k)) can be well deﬁned and the stability of
the equilibrium point of this system is equivalent to the stability of PDW [5].
Here, expanding this statement, we show that the stability of the equilibrium
point of this system is equivalent to the stability of PDW even if the input
torques are not constant but continue and diﬀerentiable between each k-th
step.
Theorem 1
Let the input torques τ(t) be continue and diﬀerentiable be-
tween each k-th step. Then, with regard to impact point p(k) and input
torques τ(t), a following map Pcl
p(k + 1) = Pcl(p(k), τ)
(4)
can be deﬁned. And, p∗is a stable equilibrium point of this map Eq.(4) with
τ(t) = 0 for Tp(k −1) ≤t∀< Tp(k), if and only if, the continuous trajectory
of the motion of the robot that passes through p∗is stable in the sense of
Lyapunov, where Tp(k) is a time when the k-th impact occurs.
Proof
Basically, it can be proved by similar way of the proof of lemma 1
and 2 in [5]. At ﬁrst, let the set of the states of the robot just before impact
be S, then the target system of the robot can be denoted as follows:
Σ :
!
˙x(t) = fcl(x(t))
(x−(t) ̸∈S)
x+(t) = ∆(x−(t))
(x−(t) ∈S),
(5)
where,
x(t) := (θp, θw, ˙θp, ˙θw)T , fcl := f(x(t)) + g(x(t))τ(t),
f(x(t)) =

( ˙θp, ˙θw)T
−M −1(θ)(N(θ, ˙θ) ˙θ + g(θ, α))

, g(x(t)) =

0
M −1(θ)

.

168
Yasuhiro Sugimoto, Koichi Osuka
Because of the condition of τ(t), it can be said that fcl(t) can have a unique
solution which depends continuously on the initial condition between the
each k-th step, and then, the map Pcl,x(x, τ) can be well-deﬁned [7]. This
map means that the state just before the k-th collision x−
k is mapped to the
state just before the (k+1)-th collision x−
k+1 when input torques τ are used.
Then, using the following matrixes:
E =
⎛
⎜
⎝
1 0 0
−1 0 0
0 1 0
0 0 1
⎞
⎟
⎠, F =
" 1 0 0 0
0 0 1 0
0 0 0 1
#
,
we can deﬁned a map Pcl(p(k), τ) as follows:
p(k + 1) = FPcl,x(Ep(k), τ(k)): = Pcl(p(k), τ).
(6)
Secondly, because the existence of the map Pcl,x(x, τ) can be shown, using the
same way of proof of lemma 2 in [5], we can say that p∗is a stable equilibrium
point of the system: p(k + 1) = Pcl(p(k), τ) with τ(t) = 0 for Tp(k −1) ≤
t∀< Tp(k), if and only if, the continuous trajectory of the robot that passes
through p∗is stable in the sense of Lyapunov.
From this theorem, it can be said that even if the input torques are not
constant but continue and diﬀerentiable between each k-th step, the stability
of impact point p(k) on the discrete dynamical system is greatly related to
the stability of PDW.
4
DFC-based control method
To propose a new control method of Quasi-Passive-Dynamic-Walking, we
particularly consider the following two key ideas. The ﬁrst one is making use
of the concept of DFC so as not to design the reference trajectory which the
robot in PDW generates correctly. The second one is providing roughly de-
signed reference trajectory and stabilizing the walking by using this reference
trajectory so as to be possible to start its walking without a proper initial
condition or to continuous walking even if some disturbances come in.
To construct new controller with the above ideas, in this paper, we focus
on the entrainment phenomena which is one of the properties of PDW. The
entrainment phenomena of PDW means that even if the robot starts walking
with diﬀerent initial conditions, its walking converges to a speciﬁc trajectory
which is agree with the trajectory of PDW. However, the states of robot which
can cause the entrainment phenomena will exist in narrow region because the
initial conditions which can cause PDW exist in very narrow region and PDW
is very sensitive to disturbance. So, it seems that it is diﬃcult to stabilize
Quasi-Passive-Dynamic-Walking only by using the entrainment phenomena.
Then, we construct a new control method which has the next two proper-
ties, that is, “generation of PDW using the entrainment phenomena and the

Motion Generation and Control of Quasi Passsive Dynamic Walking
169
concept of DFC so as to be needless of correctly design of the reference tra-
jectory of PDW” and “stabilization the walking for the sake of its continuous
walking and taking place of the entrainment phenomena”.
4.1
Our previous control method of quasi-PDW
Discrete-DFC based control method
As an example of the control
method of Quasi-PDW, the discrete-DFC based control method [5] or [6] can
be given. This control method is that, since it can be proved that the stability
of PDW is equivalent to the stability of the equilibrium impact point on the
discrete dynamical system:
p(k + 1) = P(p(k), τ),
(7)
Quasi-Passive-Dynamic-Walking can be stabilized by using the input torques
τ(k) which stabilize p(k) of the system Eq.(7):
τ(k) = K(y(k) −y(k −1)) = K
 Pp(k) −Pp(k −1)
Pw(k) −Pw(k −1)

,
(8)
where Pp(k), Pw(k) are the kinetic energy of the support and swing leg at
impact point respectively. From Eq.(8), we can see that this control method
is very simple and does not need any information of the equilibrium point p∗
of Eq.(7), that is, it can stabilize Quasi-PDW without making any reference
trajectory. However, focusing only on impact point, the performance of this
control method is relatively not so good. So, this can not stabilize the walk-
ing when big disturbances come in. Furthermore, this can not stabilize the
walking without proper initial conditions especially initial velocities of the
legs.
Weekly guidance control method
On the contrary, as one of the con-
trol method which utilizes the entrainment phenomena, Osuka and Saruta
proposed the following control method [4] (we call it “weekly guidance control
method”):
τ = Kf(δ(k))[M(θ)s + N(θ) ˙θ2 + g(θ, α)],
(9)
δ(k) = β(k) −β(k −1),
s = ¨θd + Kv( ˙θd −˙θ) + Kp(θd −θ),
where, Kf(x) is deﬁned by
Kf(x) =
! 1
∥x∥≥γ
(−cos( xπ
γ ) + 1)/2
∥x∥≤γ,
(10)
and an example of Kf(x) is shown in Fig.2.
As the features of this control method, the following can be given: |βk −
βk−1| is adopted as an evaluate function of the stability of walking and it is

170
Yasuhiro Sugimoto, Koichi Osuka
Fig. 2. Example of function Kf at γ = 1.0
used as the weight of trajectory tracking controller. According to the features,
even if there is an error between the reference trajectory rd = [θd, ˙θd] used
in this control method and the trajectory rid = [θid, ˙θid] which the robot
in PDW generates, the trajectory of robot converges to rid and |βk −βk−1|
becomes small gradually during the robot walks continuously, owing to the
entrainment phenomena. And ﬁnally, |βk −βk−1| becomes zero and then the
robot becomes to do PDW. Therefore, it can be expected that Quasi-PDW,
will be realized by using this control method.
However, we think that there are the following problems in this control
method (9).
•
In case that the robot’s walking is disordered by some disturbances
after its walking converges to rid, that is, after robot come to do PDW,
is it unreasonable to make the walking to converge to PDW using the rd
once again ? Since the ideal trajectory rid will be made already by robot
itself, are there some method of making use of rid for stabilization of its
walking ?
•
How on earth do we make the reference trajectory rd ?
•
From Section 3, is it better to use the data of impact point p(k) than
βk when the stability of walking is evaluated ?
Especially, with regard to rd, even if there would be some diﬀerences between
rd and rid, we could expect the walking would converge to rid owing to the
entrainment phenomena. But, it is desired that the diﬀerence between rd and
rid is as small as possible to improve the eﬃciency of this control method.
Therefore, it is needed to make a suﬃcient proper reference trajectory rd in
advance, and then, it can not be said any more that this control method fully
makes use of the entrainment phenomena of PDW.
4.2
The propose control method
From 4.1, 4.1 and the consequence of Section 3 which means that the impact
point p(k) is greatly related to the stability of robot’s walking, we propose
the following control method.

Motion Generation and Control of Quasi Passsive Dynamic Walking
171
Updating reference trajectory control method based on DFC
τk = Kf(δk)[Kv( ˙θk−1 −˙θk) + Kp(θk−1 −θk)]
(11)
δk = ||p(k) −p(k −1)||φ,
where θk is k-th step’s θ = (θp, θw)T , Kf(·) is deﬁned by Eq.(10), φ is a
constant matrix φ ∈R3×3 and || · ||M is a norm deﬁned by ||x||M =
√
xT Mx
and a constant matrix M ∈Rm×n.
As one of the features of this control method(11), the following can be
given: at ﬁrst, it evaluates the stability of walking by using the data of impact
point p(k) and p(k −1). And secondly, it realizes tracking control not with
rd which is made in advance but with rk−1 which is the (k-1)-th trajectory
of robot. As a result, the reference trajectory is updated in each steps.
Since the walking is stabilized by PD-control whose gains are regulated
depending on the stability of walking, it can be said that this proposed control
method (11) satisﬁes the speciﬁcation which is “stabilization of the walking
for the sake of its continuous walking and taking place of the entrainment
phenomena”.
And, since updating the reference trajectory using the (k-1)-th step trajec-
tory in each steps is equivalent to doing continuous-DFC and the entrainment
phenomena will cause because walking will continue, we can expect that its
walking will converge to rid without making correctly design of the trajec-
tory rid during the robot walks continuously. Therefore, the proposed control
method can satisfy the secondary speciﬁcation which is “to generate of PDW
using the entrainment phenomena and the concept of DFC so as to be need-
less of correctly design of the reference trajectory of PDW”. Moreover, if once
the walking of robot converges to PDW, it holds true that rk = rk−1 = rid.
So, it is also the advantage of this control method that it can use rid as the
reference trajectory after the convergence to PDW.
Furthermore, with regard to initial reference trajectory r0, since it can ex-
pected that the robot itself makes the ideal trajectory rid during the walking,
it is enough to design r0 roughly with which walking can be occur without
falling down.
Remark
In case of using the proposed method Eq.(11) with a real robot,
it is more reasonable that we obtain rid−sim by some simulation using the
proposed method with an roughly designed r0 at ﬁrst, then we use this rid−sim
as r0 when we actually apply the proposed method to the real robot.
5
Computer simulation
In this section, we investigate the validity of the proposed control method (11)
by several simulations. We use same physical parameters of robot as Quartet
III [4]. The initial conditions of the robot are set as θ0(0) = [−0.34, 0.34, 0, 0]T
and

172
Yasuhiro Sugimoto, Koichi Osuka
Kp =
$
30 0
0 30
%
,
Kv =
$
25 0
0 25
%
, φ =
" 5 0
0
0 0.1 0
0 0 0.1
#
,
γ = 1.0.
The initial reference trajectory r0(t) is set as,
θp,0(t) = 2.2667t2 + 0.79333t −0.34000,
˙θp,0(t) = 4.4894t + 0.79333,
θw,0(t) = 8.4524t2 −5.0810t −0.34000,
˙θw,0(t) = 16.905t −5.0810.
These are obtained as following. At ﬁrst, θp(t) and θw(t) are given as quadratic
equations which pass [(0,-0.34),(0.25,0),(0.4,0.34)] and [(0,0.34),(0.3,-0.4),(0.4,-
0.34)] respectively. Then, ˙θp(t) and ˙θw(t) are obtained by diﬀerentiating θp(t)
and θw(t) respectively. Furthermore, since it can be that k-th step’s walking
period is bigger than (k-1)-th step’s walking period, we use a 7th polynomial
which is approximated to (k-1)-th step’s trajectory as k-th step’s reference
trajectory.
Simulation results are shown in Fig.3-Fig.5. Fig.3 shows the support leg
angle and swing leg angle θp(t) and θw(t). Fig.4 shows the input torques
τ(t), where the solid line means the support leg and the dotted line means
the swing leg respectively. Fig.5 shows the 1,2,3,7 and 24th step’s reference
trajectory respectively. To compare with our previous control method, the
simulation results with weekly guidance control method Eq.(9) in which the
same r0 is used as the reference trajectory, are shown in Fig.6 and 7.
0
1
2
3
4
5
6
7
8
9
10
- 0.5
0
0.5
time[sec]
θp, θw[rad]
support leg
swing leg
Fig. 3. Trajectory of θp, θw by Eq.(11)
0
1
2
3
4
5
6
7
8
9
10
-20
-15
-10
- 5
0
5
10
15
20
time[sec]
torque [Nm]
support leg
swing leg
Fig. 4. Input torque by Eq.(11)
From these ﬁgures, though the robot’s walking is not uniformly and the
input torques are needed to continue walking at the beginning of walking,
the input torques τ and Kf are decreasing gradually during some steps. And
ﬁnally, rk becomes equivalent to rk−1 and the robot becomes to walk via
PDW. On the contrary, the robot’s waking with the weekly guidance control
can not converge to PDW though the robot can continue walking. This is
because it does not use the proper reference trajectory rd. So, we can say
that the proposed control method Eq.(11) works well.
Secondly, we investigate the robustness of the proposed control method
against disturbance. Simulation results in which the slope angle α is set as

Motion Generation and Control of Quasi Passsive Dynamic Walking
173
0
0.1
0.2
0.3
0.4
- 0.5
- 0.4
- 0.3
- 0.2
- 0.1
0
0.1
0.2
0.3
0.4
0.5
time[sec]
θp [rad]
step 1
step 2
step 7
step 10
step 24
Fig. 5. Reference trajectory of θp
0
1
2
3
4
5
6
7
8
9
10
- 0.5
0
0.5
time[sec]
θp, θw[rad]
support leg
swing leg
Fig. 6. Trajectory of θp, θw by Eq.(9)
0
1
2
3
4
5
6
7
8
9
10
- 0.5
0
0.5
time[sec]
θp, θw[rad]
support leg
swing leg
Fig. 7. Input torque by Eq.(9)
6[deg] (nominal value of α is 3[deg]) between 5[sec] and 6[sec], are shown
in Fig.8 and 9. To compare with our previous control methods, simulation
results when Eq.(8) and Eq.(9) are used are also shown in the same ﬁgures.
Here, there is a problem how we set the reference trajectory rd in Eq.(9).
In this simulation, for easily convergence to PDW, we make the reference
trajectory which is very close to the trajectory of PDW but is not agree
perfectly and use it.
0
1
2
3
4
5
6
7
8
9
10
- 0.5
0
0.5
time[sec]
θp, θw[rad]
proposed method Eq.(10)
discret DFC method Eq.(7)
weekly guidance method Eq.(8)
Fig. 8. Trajectory of θp, θw
0
1
2
3
4
5
6
7
8
9
10
-20
-15
-10
- 5
0
5
10
15
20
time[sec]
torque [Nm]
propose method Eq.(
10)
discreteDFC method Eq.(
7)
weekly guidance methol Eq.(
8)
Fig. 9. Input torque

174
Yasuhiro Sugimoto, Koichi Osuka
From these ﬁgures, we can see that the robot with the discrete-DFC based
control Eq.(8) can not continue walking after the disturbance is added, and
the robot with the weekly guidance control Eq. (9) can not converge to PDW
again. On the contrary, the robot with the proposed method Eq.(11) can
walk down continually after the disturbance is added and becomes to walk
via PDW again. So we can say that the proposed method works well.
6
Conclusion and future work
In this paper, making use of the concept of DFC and the entrainment phe-
nomena of PDW, we proposed a new control method of Quasi-PDW. Con-
cretely, the proposed method uses (k-1)-th step’s trajectory of the walking
as the reference trajectory of the k-th step and regulates the gain according
to impact Point. And the eﬀectiveness of the proposed control method was
shown through several simulations.
As a problem yet to be solved in the future is to prove the eﬀectiveness of
the proposed control method and obtain the systematic derivation methods
of Kp, Kv and φ in Eq.(11). Furthermore, we should carry out experiments
with a real robot.
References
1. T.McGeer: “Passive Dynamic Walking”, Int.J.of Rob.Res., Vol.9, No.2, 1990
2. A. Goswami, B. Thuilot and B. Espiau: “A Study of the Passive Gait of
a Compass-Like Biped Robot: Sysmmetry and Chaos”,Int. J.of Rob. Res.
pp.1282–1301,2000
3. F. Asano, M. Yamakita, N. Kamamichi, Z. LUO, “A Novel Gait Generation
for Biped Walking Robots Based on Mechanical Energy Constraint”, Proc. of
the IEEE/RSJ Int. Conf. on Intellignet Robots and Systems(IROS), pp.2637–
2644, 2002
4. K.Osuka,Y.Saruta: “Gait Control of Legged Robot Quartet III via Passive
Walking”, Proc. of the 8 th Symposium on Control Technology8th, pp.355–
360,2000 ( in Japanese)
5. Y. Sugimoto, K. Osuka, “Stabilization of semi passive dynamic walking based
on delayed feedback control”, Proc. of the 7 th Robotics Symposia, pp89–94,
2002 (in Japanese)
6. Y. Sugimoto, K. Osuka, “Walking Control of Quasi-Passive-Dynamic-Walking
Robot “Quartet III” based on Delayed Feedback Control”, Proc. of the 5th
Int. Conf. on Climbing and Walking Robots(CLAWAR), pp.123–130, 2002
7. J. W. Grizzle, F. Plestan and G. Abba: “Poincare’s Method for Systems with
Impulse Eﬀects: Application to Mechanical Biped Locomotion”, Proc. of the
38th Conference on Decision & Control, pp. 3869–3876,1999
8. K.Pyragas,“Continuous
control
of
chaos
by
selfcontrolling
feedback”,
Phys.Lett.A,vol 170,pp.421–428,1992

Part 5
Neuro-Mechanics
& CPG and/or Reﬂexes

Gait Transition from Swimming to Walking:
Investigation of Salamander Locomotion
Control Using Nonlinear Oscillators
Auke Jan Ijspeert1 and Jean-Marie Cabelguen2
1 Swiss Federal Institute of Technology, CH-1015 Lausanne, Switzerland
2 Inserm EPI9914, Inst. Magendie 1 rue C. St-Sa¨ens, F-33077 Bordeaux, France
Abstract. This article presents a model of the salamander’s locomotion controller
based on nonlinear oscillators. Using numerical simulations of both the controller
and of the body, we investigated diﬀerent systems of coupled oscillators that can
produce the typical swimming and walking gaits of the salamander. Since the exact
organization of the salamander’s locomotor circuits is currently unknown, we used
the numerical simulations to investigate which type of coupled-oscillator conﬁgu-
rations could best reproduce some key aspects of salamander locomotion. We were
in particular interested in (1) the ability of the controller to produce a traveling
wave along the body for swimming and a standing wave for walking, and (2) the
role of sensory feedback in shaping the patterns. Results show that conﬁgurations
which combine global couplings from limb oscillators to body oscillators, as well
as inter-limb couplings between fore- and hind-limbs come closest to salamander
locomotion data. It is also demonstrated that sensory feedback could potentially
play a signiﬁcant role in the generation of standing waves during walking.
1
Introduction
The salamander, a tetrapod capable of both swimming and walking, oﬀers a
remarkable opportunity to investigate vertebrate locomotion. It represents,
among vertebrates, a key element in the evolution from aquatic to terrestrial
habitats.
This article investigates the mechanisms underlying locomotion and gait
transition in the salamander. We develop computational models of the spinal
circuits controlling the axial and limb musculature, and investigate how these
circuits are coupled to generate, and switch between, the aquatic and terres-
trial gaits. In previous work, one of us developed neural network models of
the salamander’s locomotor circuit based on the hypothesis that the circuit
is constructed from a lamprey-like central pattern generator (CPG) extended
by two limb CPGs [2]. In that work, a genetic algorithm was used to instan-
tiate synaptic weights in the models such as to optimize the ability of the
CPG to generate salamander-like swimming and walking patterns. Here, we
develop models based on coupled nonlinear oscillators, and extend that work
by systematically investigating diﬀerent types of couplings between the oscil-
lators capable of producing the patterns of activity observed in salamander

178
Auke Jan Ijspeert and Jean-Marie Cabelguen
Neck
Trunk
Tail
Forelimb
CPG
CPG
Body
Hindlimb
CPG
1
5
10
15
20
25
30
35
40
Fig. 1. Left: Schematic dorsal view of the salamander’s body. Right: Patterns of
EMG activity recorded from the axial musculature during swimming (top) and
walking (bottom), adapted from Delvolv´e et al. 1997.
locomotion. The use of nonlinear oscillators instead of neural network oscilla-
tors allows us to reduce the number of state variables and parameters in the
models, and to focus on a systematic study of the inter-oscillator couplings.
We address the following questions: (1) how are body and limb CPGs
coupled to produce traveling waves of lateral displacement of the body during
swimming and standing waves during walking? (2) how is sensory feedback
integrated into the CPGs? (3) does sensory feedback play a major role in
the transition from traveling waves to standing waves? (4) to what extent
is the inter-limb coordination between fore and hind limbs due to inter-limb
coupling and/or the coupling with the body CPG? Clearly most of these
questions are relevant to tetrapods in general.
2
Neural control of salamander locomotion
The salamander uses an anguiliform swimming gait very similar to the lam-
prey. The swimming is based on axial undulations in which rostrocaudal
waves with a piece-wise constant wavelength are propagated along the whole
body with limbs folded backwards (Figure 1, right). As in the lamprey, the
average wavelength usually corresponds to the length of the body (i.e. the
body produces one complete wave) and does not vary with the frequency of
oscillation [3]. On ground, the salamander switches to a stepping gait, with
the body making S-shaped standing waves with nodes at the girdles [3]. The
stepping gait has the phase relation of a trot, in which laterally opposed
limbs are out of phase, while diagonally opposed limbs are in phase. The
limbs are coordinated with the bending of the body such as to increase the
stride length in this sprawling gait. EMG recordings [3] have conﬁrmed the
bimodal nature of salamander locomotion, with axial traveling waves along

Gait Transition from Swimming to Walking
179
Retractor
Joints
Tail
Muscles
4
5
6
7
8
9
10
11
12
Protractor
Rigid links
Foot contact
14
15
13
16
Trunk
Neck
1
2
3
−2
−1.5
−1
−0.5
0
0.5
1
1.5
−1.5
−1
−0.5
0
0.5
1
1.5
X
V
Fig. 2. Left: Mechanical model of the salamander’s body. The two-dimensional
body is made of 16 rigid links connected by one-degree-of-freedom joints. Each
joint is actuated by a pair of antagonist muscles simulated as spring and dampers.
Right: Limit cycle behavior of the nonlinear oscillator, time evolution with diﬀerent
random initial conditions.
the body for swimming, and mainly standing waves coordinated with the
limbs for walking (Figure 1).
The CPG underlying axial motion —the body CPG— is located all along
the spinal cord. Similarly to the lamprey [1], it spontaneously propagates
traveling waves corresponding to ﬁctive swimming when induced by NMDA
excitatory baths in isolated spinal cord preparations [4]. Small isolated parts
of 2 to 3 segments can be made to oscillate suggesting that rhythmogenesis
is similarly distributed in salamander as in the lamprey. The neural centers
for the limb movements are located within the cervical segments C1 to C5
(Figure 1 left) for the forelimbs and within the thoracic segments 14 to 18
for the hindlimbs [5–7]. These regions can be decomposed into left and right
neural centers which independently coordinate each limb [5,7].
3
Mechanical simulation
The two-dimensional mechanical simulation of the salamander is an exten-
sion of Ekeberg’s simulation of the lamprey [8]. The 25 cm long body is made
of twelve rigid links representing the neck, trunk and tail, and four links
representing the limbs (Figure 2). The links are connected by one-degree-
of-freedom joints, and the torques on each joint are determined by pairs
of antagonist muscles simulated as springs and dampers. The signals sent by
the motoneurons contract muscles by modifying (increasing) their spring con-
stant. The accelerations of the links are due to four types of forces: the torques
due to the muscles, inner forces linked with the mechanical constraints due
to the joints, contact forces between body and limbs, and the forces due
to the environment (friction on ground, and inertial hydrodynamic forces in
water). The dynamics equations underlying the simulation are described in
more detail in [2].

180
Auke Jan Ijspeert and Jean-Marie Cabelguen
4
Locomotion controller
4.1
Nonlinear oscillator
We construct our models of the CPGs by using the following nonlinear oscil-
lator to represent a local oscillatory center:
τ ˙v = −α x2 + v2 −E
E
v −x
τ ˙x = v
where τ, α, and E are positive constants. This oscillator has the interesting
property that its limit cycle behavior is a sinusoidal signal with amplitude
√
E and period 2πτ (x(t) indeed converges to ˜x(t) =
√
E sin(t/τ + φ), where
φ depends on the initial conditions, see also Figure 2, right).
We assume that the diﬀerent oscillators of the CPG are coupled together
by projecting to each other signals proportional to their x and v states in the
following manner
τ ˙vi = −α x2
i + v2
i −Ei
Ei
vi −xi +

j
(aijxj + bijvj) +

j
cijsj
τ ˙xi = vi
where aij and bij are constants (positive or negative) determining how
oscillator j inﬂuences oscillator i. In these equations, the inﬂuence from sen-
sory inputs sj weighted by a constant cij is also added, see next sections for
further explanations.
4.2
Body CPG
We assume that the body CPG is composed of a double chain of oscillators
all along the 40 segments of spinal cord. The type of connections investigated
in this article are illustrated in Figure 3 (left). For simplicity, we assume that
only nearest neighbor connections exist between oscillators. In our ﬁrst in-
vestigation, the oscillators are assumed to be identical along the chain (with
identical projections), as well as between each side of the body. The connec-
tivity of the chain is therefore deﬁned by 6 parameters, two (the aij and bij
parameters) for each projection from one oscillator to the other (i.e. the ros-
tral, caudal, and contralateral projections). Of these 6 parameters, we ﬁxed
the couplings between contralateral oscillators to aij = 0 and bij = −0.5 in
order to force them to oscillate in anti-phase. We systematically investigated
the diﬀerent combinations of the four remaining parameters (the rostral and
caudal projections) with values ranging from -1.0 to 1.0, with a 0.1 step.

Gait Transition from Swimming to Walking
181
0
2
4
6
8
10
12
0
5
10
15
20
25
30
35
40
Signal X in segment i
Time [s]
Fig. 3. Left: Conﬁguration of the body CPG. Right: oscillations in a 40-segment
chain (only the activity in a single side is shown).
Traveling wave Experiments on isolated spinal cords of the salamander sug-
gest that, similarly to the lamprey, the body CPG tends to propagate rostro-
caudal (from head to tail) traveling waves of neural activity. During (in-
tact) swimming, the wavelength of the wave corresponds approximately to
a bodylength. We therefore systematically investigated the parameter space
of the body CPG conﬁguration to identify sets of parameters leading to sta-
ble oscillations with phase lags between consecutive segments approximately
equal to 2.5% of the period (in order to obtain a 100% phase lag between head
and tail). The goal is to obtain traveling waves which are due to asymmetries
of interoscillator coupling, while maintaining the same intrinsic period (the
same τ) for all oscillators.
We found that several coupling schemes could lead to such traveling waves.
The coupling schemes can qualitatively be grouped in three diﬀerent cate-
gories: dominantly caudal couplings, balanced caudal and rostral couplings,
and dominantly rostral couplings.1 By dominant, we mean that the sum of
the absolute values of the weights in one direction are signiﬁcantly larger
than in the other direction. While all groups can produce traveling waves
corresponding to salamander swimming, solutions which have balanced cau-
dal and rostral couplings need signiﬁcantly more cycles to stabilize into the
traveling wave (starting from random initial conditions) than the solutions
in which one type of coupling is dominant. It is therefore likely that the sala-
mander has one type of coupling which is dominant compared to the other.
A very similar conclusion has been made concerning the lamprey swimming
controller [9].
Figure 3 (right) illustrates the traveling waves generated by one of the
dominantly caudal chains. As can be observed, starting from random initial
1 Dominantly caudal and rostral couplings are essentially equivalent since each
coupling type which is dominant in one direction has an equivalent in the other
direction by inverting the sign of some weights. However, that equivalence is lost
when the intrinsic frequencies of some oscillators are varied, see the “Piece-wise
constant wavelength” paragraph.

182
Auke Jan Ijspeert and Jean-Marie Cabelguen
states, the oscillations rapidly evolve to a traveling wave. Since the period of
the oscillations explicitly depend on the parameter τ, the period can be mod-
iﬁed independently of the wavelength. The wavelength of one-body length is
therefore maintained for any period, when all oscillators have the same value
of τ (i.e. the same intrinsic period). This allows one to modify the speed of
swimming by only changing the period of oscillation, as observed in normal
lamprey and salamander swimming.
Interestingly, while the connectivity of the oscillators favors a one-body
length wavelength, it is possible to vary the wavelength by modifying the
intrinsic period of some oscillators, the oscillators closest to the head, for
instance. Reducing the period of these oscillators leads to an increase of
the phase lag between consecutive oscillators(a reduction of the wavelength),
while increasing their period leads to a decrease of the phase lag, and can
even change the direction of the wave (i.e. generate a caudo-rostral wave).
This type of behavior is typical of chains of oscillators [9].
Piece-wise constant wavelength We identify at least four potential causes
for the small changes of wavelength observed along the body at the level of
the girdles: (1) diﬀerences of intrinsic frequencies between the oscillators at
the girdles and the other body oscillators, (2) diﬀerences in intersegmental
coupling along the body CPG (with three regions: neck, trunk, and tail),
(3) eﬀect of the coupling from the limb CPG, (4) eﬀect of sensory feedback.
Recent in-vitro recordings on isolated spinal cords showed that a change of
wavelength is also obtained during ﬁctive swimming. It therefore seems that
the phenomenon is mainly due to the CPG conﬁguration rather than to sen-
sory feedback (explanation number four is therefore the less likely). We tested
these diﬀerent hypotheses with the numerical simulations. For the hypoth-
esis 2, it meant adding 8 parameters for diﬀerentiating the intersegmental
couplings in the neck, trunk and tail regions.
The results suggest that, in our framework, the most likely cause of the
three-wave pattern is a combination of diﬀerences in intersegmental coupling
and of intrinsic frequencies of the oscillators at the girdles. The diﬀerences in
intersegmental coupling lead to variations in the wavelength of the undulation
along the spinal cord. But they do not explain the abrupt changes of phases
at the level of the girdles. These are best explained by small diﬀerences in
intrinsic frequencies of the oscillators of the body CPGs at the two girdles
(these could also potentially be due to the projections from the limb CPG,
see next sections).
We can furthermore tell that the eﬀect of variations of the intrinsic fre-
quencies depend on which coupling is dominant in the body CPG. The pat-
terns observed in the salamander are best explained with either a combination
of dominantly caudal coupling and higher intrinsic frequency at the girdles,
or dominantly rostral coupling and lower intrinsic frequencies at the girdles.
The resulting activity in the latter conﬁguration is illustrated in Figure 5
(left).

Gait Transition from Swimming to Walking
183
L
B
B
L
A
B
C
D
E
Global
With interlimb c.
Unilateral
Bilateral
Global
With interlimb c.
Unilateral
Local
With interlimb c.
Local
Bilateral
Without interlimb c
Bilateral
Local
With interlimb c.
Fig. 4. Diﬀerent potential CPG conﬁgurations.
Swimming We tested the body CPG in the mechanical simulation for con-
trolling swimming. Since the mechanical simulation has only 11 joints along
the body, 11 pairs of equally-spaced oscillators were picked from the body
CPG to drive the muscle models, such that the oscillators in one pair project
to the muscle on their respective side. A “motoneuron” mi signal is obtained
from the states xi with the following equation mi = β max(xi, 0), where is β
a positive constant gain. This motoneuron signal controls how much a mus-
cle contracts by essentially changing the spring constant of the spring-and-
damper muscle model (see [2]). An example of the swimming gait is shown
in Figure 5 (left). The speed of swimming can be modulated by changing
the frequency of all oscillators (through the parameter τ), while the direction
of swimming can be modulated by applying an asymmetry of the amplitude
parameter E between left and right sides of the chain. The salamander will
then turn toward the side which receives the highest amplitude parameter.
4.3
Diﬀerent body-limb CPG conﬁgurations for gait transition
One of the goals of this article is to investigate diﬀerent types of couplings
between the body and limb CPGs, and how these couplings aﬀect the gait
transitions between swimming and walking. There are currently too few bi-
ological data available to indicate how the diﬀerent neural oscillators in the
body and limb CPGs are interconnected. Our aim is to investigate which of
these conﬁgurations can best reproduce some key characteristics of salaman-
der locomotion.
We tested ﬁve diﬀerent types of coupling (Figure 4). These couplings dif-
fer in three characteristics: unilateral/bilateral couplings, in which the limb
CPGs are either unilaterally or bilaterally (i.e. in both directions) coupled
to the body CPG, global/local couplings, in which the limb CPGs project
either to many body CPG oscillators, or only those close to the girdles, and
with/without interlimb couplings between fore- and hindlimbs. In our pre-
vious work [2], we tested conﬁguration A (unilateral, global, with interlimb

184
Auke Jan Ijspeert and Jean-Marie Cabelguen
12
13
14
15
16
17
18
19
20
0
5
10
15
20
25
30
35
40
Signal X in segment i
Time [s]
0
2
4
6
8
10
12
0
5
10
15
20
25
30
35
40
Signal X in segment i
Time [s]
Fig. 5. Left, top: Swimming gait. Left, bottom: corresponding activity in the the
body CPG (only the activity in a single side is shown). Note the piece-wise constant
wavelength. The oscillations at the level of the girdles are drawn with thicker lines.
Right top: walking gait. Right bottom: corresponding oscillations along the body
in a CPG of type A.
coupling) using neural network oscillators. The unilateral projections from
limb to body CPG essentially means a hierarchical structure in the CPG for
that conﬁguration.
In all conﬁgurations, we assume that two diﬀerent control pathways exist
for the body and the limb CPGs, in order words, that the control parameters
τ and E can be modulated independently for the body and limb oscillators.
In particular, we make the hypothesis that the gait transition is obtained as
follows: swimming is generated when only the body CPG is activated (Ebody
= 1.0 and Elimb = 0.005), and walking is generated when both body and limb
CPGs are activated (Ebody = 1.0 and Elimb = 1.0).
The simulation results show that only conﬁgurations A and B, i.e. those
with global coupling between limb and body CPG can produce standing
waves (in the absence of sensory feedback). For these conﬁgurations, the
global coupling from limb oscillators to body oscillators ensures that the body
CPG oscillates approximately in synchrony in the trunk and in the tail when
the limb CPG is activated (Figure 5, right). For the other conﬁgurations (C,
D, and E) the fact that the couplings between limb and body CPGs are only
local means that traveling waves are still propagated in the trunk and the
tail, despite the inﬂuence from the limb oscillators. Conﬁgurations E, which
lacks interlimb couplings can still produce walking gaits very similar to those
of conﬁgurations C and D, because the coupling with the body CPG gives
a phase relation between fore- and hindlimbs of approximately 50% of the
period (because fore and hindlimbs are separated by approximately the half
of one body-length).

Gait Transition from Swimming to Walking
185
4
4.5
5
5.5
6
6.5
7
0
10
20
30
40
X body left
4
4.5
5
5.5
6
6.5
7
0
10
20
30
40
S body left
Time [s]
4
4.5
5
5.5
6
6.5
7
0
10
20
30
40
X body left
4
4.5
5
5.5
6
6.5
7
0
10
20
30
40
S body left
Time [s]
Fig. 6. Left: Walking gait produced by conﬁguration D, without sensory feedback.
Right: Walking gait produced by conﬁguration D, with sensory feedback. Top:
output of the body CPG, Bottom: output of the stretch sensors.
Having bilateral couplings between limb and body CPGs does not aﬀect
the walking pattern in a signiﬁcant way. However, if the coupling from body
CPG to limb CPG is strong, it will aﬀect the swimming gait. In that case,
even if the amplitude of the limb oscillators is set to a negligible value (Elimb
= 0.005), the inputs from the body CPG will be suﬃcient to drive the limb
oscillators which in return will force the body CPG to generate a wave which
is a mix between a traveling wave and standing wave. It is therefore likely
that the couplings between limb and body CPG are stronger from limb to
body CPG than in the opposite direction.
Note that the fact that CPG conﬁgurations B, C and D can not pro-
duce standing waves, does however not exclude the possibility that these
conﬁgurations produce standing waves when sensory feedback is added to
the controller. This will be investigated in the next section.
Eﬀect of sensory feedback When a lamprey is taken out of the water and
placed on ground, it tends to make undulations which look almost like stand-
ing waves because the lateral displacements do not increase along the body
but form quasi-nodes (i.e. points with very little lateral displacements) at
some points along the body [10].
Interestingly, the same is true in our simulation. When the swimming gait
is used on ground (without sensory feedback), the body makes a S-shaped
standing wave undulation instead of the traveling wave undulation generated
in water. This is due to the diﬀerences between hydrodynamic forces in water
(which have strongly diﬀerent components between directions parallel and
perpendicular to the body) and the friction forces on ground (which are
more uniform). The sensory signals from such a gait are then reﬂecting this
S-shaped standing wave, despite the traveling waves sent to the muscles.
Sensory feedback is therefore a potential explanation for the transition
from a traveling wave for swimming to a standing wave for walking. We
therefore tested the eﬀect of incorporating sensory feedback in the diﬀerent

186
Auke Jan Ijspeert and Jean-Marie Cabelguen
CPG conﬁgurations described above. Sensory feedback to the salamander’s
CPG is provided by sensory receptors in joints and muscles. We designed
an abstract model of sensory feedback by including sensory units located on
both sides of each joint which produce a signal proportional to how much that
side is stretched: si = max(φi, 0) where φi is the angle of joint i measured
positively away from the sensory unit. For simplicity, we only consider sensory
feedback in the body segments (i.e. not in the limbs), and assume that a
sensory unit for a speciﬁc joint is coupled only locally to the two (antagonist)
oscillators activating that joint.
Figure 6shows the activity of the body CPG and the sensor units pro-
duced during a stepping gait with a controller with conﬁguration D. Without
sensory feedback (Figure 6, left), this controller produces a traveling wave
during walking because the limb oscillators have only local projections to
the body CPG. Despite this traveling wave of muscular activity, the body
(in contact with the ground) makes essentially an S-shaped standing wave
as illustrated by the sensory signals (synchrony in the trunk and in the tail,
with an abrupt change of phase in between). When these sensory signals are
fed back into the CPG (Figure 6, right), the body CPG activity is modiﬁed
to approach the standing wave (i.e. the phase lag between segments decrease
in the trunk and in particular in the tail). Note that if the sensory feedback
signals are too strong, the stepping gait becomes irregular. Interestingly, the
sensory feedback leads to an increase of the oscillation’s frequency, something
which has also been observed in a comparison between swimming with and
without sensory feedback in the lamprey [11].
5
Discussion
The primary goal of this article was to investigate which of diﬀerent CPG
conﬁgurations was most likely to control salamander locomotion. To the best
of our knowledge, only three previous modeling studies investigated which
type of neural circuits could produce the typical swimming and walking gaits
of the salamander. In [12], the production of S-shaped standing waves was
mathematically investigated in a chain of coupled non-linear oscillators with
long range couplings. In that model, the oscillators are coupled with closest
neighbor couplings which tend to make oscillators oscillate in synchrony, and
with long range couplings from the extremity oscillators to the middle oscil-
lators which tend to make these coupled oscillators oscillate in anti-phase. It
is found that for a range of strengths of the long range inhibitory coupling,
a S-shaped standing wave is a stable solution. Traveling waves can also be
obtained but only by changing the parameters of the coupling. In [2], one
of us demonstrated that a leaky-integrator neural network model of conﬁgu-
ration A could produce stable swimming and walking gaits. Finally, in [13],
it was similarly demonstrated that a neural network model of the lamprey
swimming controller could produce the piece-wise constant swimming of sala-
mander and the S-shaped standing of walking depending on how phasic input

Gait Transition from Swimming to Walking
187
drives (representing signals from the limb CPGs and/or sensory feedback) are
applied to the body CPG. The current paper extends these previous stud-
ies by investigating more systematically diﬀerent potential body-limb CPGs
conﬁgurations underlying salamander locomotion.
The simulation results presented in this article suggest that CPG conﬁg-
urations which have global couplings from limb to body CPGs, and interlimb
couplings (conﬁgurations A or B) are the most likely in the salamander.
These conﬁgurations can indeed produce stable swimming and walking gaits
with all the characteristics of salamander locomotion. Our investigation does
not exclude the other conﬁgurations, but suggest that these would need a
signiﬁcant input from sensory feedback to force the body CPG to produce
the S-shaped standing wave along the body. These results suggest new neuro-
physiological experiments. It would, for instance, be interesting to make new
EMG recordings during walking without sensory feedback (e.g. by lesion of
the dorsal roots). If the EMG recordings remain a standing wave, it would
suggest that conﬁgurations A or B are most likely, while if they correspond
to a standing wave if would suggest that conﬁgurations C, D, or E are most
likely.
To make our investigation tractable, we made several simplifying assump-
tions. First of all, we based our investigation on nonlinear oscillators. Clearly,
these are only very abstract models of oscillatory neural networks. In partic-
ular, they have only few state variables, and fail to encapsulate all the rich
dynamics produced by cellular and network properties of real neural net-
works. We however believe they are well suited for investigating the general
structure of the locomotion controller. To some extent, some properties of
interoscillator couplings are universal, and do not depend on the exact im-
plementation of the oscillators. This is observed for instance in chains [9],
as well as rings of oscillators [14]. Our goal was therefore to analyze these
general properties of systems of coupled oscillators.
An interesting aspect of this work was to combine a model of the con-
troler and of the body, since this allowed us to investigate the mechanisms of
entrainment between the CPG, the body and the environment. We believe
such an approach is essential to get a complete understanding of locomotion
control, since the complete loop can generate dynamics that are diﬃcult to
predict by investigating the controller (the central nervous system) in isola-
tion of the body. The transformation of traveling waves of muscular activity
into standing waves of movements when the salamander is placed on ground is
an illustration of the complex dynamics which can results from the complete
loop.
Finally, this work has also direct links with robotics, since the controllers
could equally well be used to control a swimming and walking robot. Espe-
cially interesting is the ability of the controller to coordinate multiple degrees
of freedom while receiving very simple input signals for controling the speed,
direction, and type of gait.

188
Auke Jan Ijspeert and Jean-Marie Cabelguen
Acknowledgements
We would like to acknowledge support from the french “Minist`ere de la
Recherche et de la Technologie” (program “ACI Neurosciences Int´egratives et
Computationnelles”) and from a Swiss National Science Foundation Young
Professorship grant to Auke Ijspeert.
References
1. A.H. Cohen and P. Wallen. The neural correlate of locomotion in ﬁsh. ”ﬁctive
swimming” induced in a in vitro preparation of the lamprey spinal cord. Exp.
Brain Res., 41:11–18, 1980.
2. A.J. Ijspeert. A connectionist central pattern generator for the aquatic and
terrestrial gaits of a simulated salamander. Biological Cybernetics, 85(5):331–
348, 2001.
3. I. Delvolv´e, T. Bem, and J.-M. Cabelguen. Epaxial and limb muscle activity
during swimming and terrestrial stepping in the adult newt, Pleurodeles Waltl.
Journal of Neurophysiology, 78:638–650, 1997.
4. I. Delvolv´e, P. Branchereau, R. Dubuc, and J.-M. Cabelguen. Fictive rhyth-
mic motor patterns induced by NMDA in an in vitro brain stem-spinal cord
preparation from an adult urodele. Journal of Neurophysiology, 82:1074–1077,
1999.
5. G. Sz´ekely and G. Cz´eh. Organization of locomotion. In Frog Neurobiology, a
Handbook, pages 765–792. Springer Verlag, Berlin, 1976.
6. M. Wheatley, M. Edamura, and R.B. Stein. A comparison of intact and in-vitro
locomotion in an adult amphibian. Experimental Brain Research, 88:609–614,
1992.
7. J. Cheng, R.B. Stein, K. Jovanovic, K. Yoshida, D.J. Bennett, and Y. Han.
Identiﬁcation, localization, and modulation of neural networks for walking in
the mudpuppy (necturus maculatus) spinal cord. The Journal of Neuroscience,
18(11):4295–4304, 1998.
8. ¨O. Ekeberg. A combined neuronal and mechanical model of ﬁsh swimming.
Biological Cybernetics, 69:363–374, 1993.
9. N. Kopell. Chains of coupled oscillators. In M.A. Arbib, editor, The handbook
of brain theory and neural networks, pages 178–183. MIT Press, 1995.
10. G. Bowtell and T.L. Williams.
Anguiliform body dynamics: modelling the
interaction between muscle activation and body curvature.
Phil. Trans. R.
Soc. Lond. B, 334:385–390, 1991.
11. Li Guan, T. Kiemel, and A.H. Cohen. Impact of movement and movement-
related feedback on the lamprey central pattern generator for locomotion. The
Journal of Experimental Biology, 204:2361–2370, 2001.
12. B. Ermentrout and N. Kopell. Inhibition-produced patterning in chains of cou-
pled nonlinear oscillators. SIAM Journal of Applied Mathematics, 54(2):478–
507, 1994.
13. T. Bem, J.-M. Cabelguen, O. Ekeberg, and S. Grillner. From swimming to
walking: a single basic network for two diﬀerent behaviors. Biological Cyber-
netics, page In press, 2002.
14. J.
Collins
and
Richmond.
Hard-wired
central
pattern
generators
for
quadrupedal locomotion. Biological Cybernetics, 71:375–385, 1994.

Nonlinear Dynamics of Human Locomotion:
from Real-Time Adaptation to Development
Gentaro Taga
Graduate School of Education, University of Tokyo
7-3-1 Hongo, Bunkyo-ku, Tokyo 113-0033, Japan
Abstract. The nonlinear dynamics of the neuro-musculo-skeletal system and the
environment play central roles for the control of human bipedal locomotion. Our
neuro-musculo-skeletal model demonstrates that walking movements emerge from
a global entrainment between oscillatory activity of a neural system composed of
neural oscillators and a musculo-skeletal system. The attractor dynamics are re-
sponsible for the stability of locomotion when the environment changes. By linking
the self-organizing mechanism for the generation of movements to the optical ﬂow
information that indicates the relationship between a moving actor and the environ-
ment, visuo-motor coordination is achieved. Our model can also be used to simulate
pathological gaits due to brain disorders. Finally, a model of the development of
bipedal locomotion in infants demonstrates that independent walking is acquired
through a mechanism of freezing and freeing degrees of freedom.
1
Introduction
The theory of nonlinear dynamics, which claims that spatio-temporal pat-
terns arise spontaneously from the dynamic interaction between components
with many degrees of freedom [1,2], is progressively attracting more atten-
tion in the ﬁeld of motor control. The concept of self-organization in move-
ment was initially applied to describe motor actions such as rhythmic arm
movements [3]. In the meantime, neurophysiological studies of animals have
revealed that the neural system contains a central pattern generator (CPG),
which generates spatio-temporal patterns of activity for the control of rhyth-
mic movements through the interaction of coupled neural oscillators [4]. More-
over, it has been reported that the centrally generated rhythm of the CPG
is entrained by the rhythm of sensory signals at rates above and below the
intrinsic frequency of the rhythmic activity [4]. This phenomenon is typical
for a nonlinear oscillator that is externally driven by a sinusoidal signal.
Inspired by the theoretical and experimental approaches to self-organized
motor control, we proposed that human bipedal locomotion emerges from
a global entrainment between the neural system’s CPG and the musculo-
skeletal system’s interactions with a changing environment [5]. A growing
number of simulation studies have focused on the dynamic interaction of neu-
ral oscillators and mechanical systems in order to understand the mechanisms
of generation of adaptive movements in insects [6], ﬁsh [7] and quadruped

190
Gentaro Taga
animals [8-10]. In the ﬁeld of robotics, an increasing number of studies have
implemented neural oscillators to control movements of real robots [11-13].
The concept of self-organization argues that movements are generated as a
result of dynamic interaction between the neural system, the musculo-skeletal
system and the environment. If this is the case, the implicit assumption that
the neural system is a controller and that the body is a controlled system
needs to be revised. This paper presents a series of our models of human
bipedal locomotion, all of which demonstrate the nonlinear properties of the
neuro-musculo-skeletal system. The aim of this paper is to provide a frame-
work for understanding the generation of bipedal locomotion [5, 14], real-time
ﬂexibility in an unpredictable environment [15], anticipatory adaptation of
locomotion when confronted with an obstacle [16], visuo-motor coordination
using optical ﬂow information [17], the generation of pathological gaits and
the acquisition of locomotion during development [18].
2
Real-time adaptation of locomotion through global
entrainment
2.1
A model of the neuro-musculo-skeletal system for human
locomotion
In principle, bipedal walking of humanoid robots can be controlled if the
speciﬁc trajectory of each joint and of the zero moment point (ZMP) are
planned in advance and feedback mechanisms are incorporated [19]. However,
it is obvious that this method of control is not robust against unpredictable
changes in the environment.
Is it possible to generate bipedal locomotion by using a neural model of
the CPG in a self-organized manner? Let us assume that the entire system is
composed of two dynamical systems: a neural system that is responsible for
generating locomotion and a musculo-skeletal system that generates forces
and moves in an environment. The neural system is described by diﬀeren-
tial equations for coupled neural oscillators, which produce motor signals to
induce muscle torques and which receive sensory signals indicating the cur-
rent state of the musculo-skeletal system and the environment. The musculo-
skeletal system is described by Newtonian equations for multiple segments of
the body. The input torque is generated by the output of the neural system.
Using computer simulation we proved that a global entrainment between the
neural system and the musculo-skeletal system is responsible for generating
a stable walking movement [5].
Here I will present a model of [14]. As shown in Fig.1, the musculo-skeletal
system consists of eight segments in the sagittal plane. The triangular foot
interacts with the ground at its heel and/or toe. According to the output
of the neural system, each of twenty ”muscles” generates torque at speciﬁc
joints. It is important to note that a number of studies have produced exam-
ples of walking robots, such as the passive dynamic walkers [20, 21] and the

Nonlinear Dynamics of Human Locomotion
191
dynamic running machines [22], which exploit the natural dynamics of the
body. The oscillatory property of the musculo-skeletal system is an important
determinant to establishing a walking pattern.
Our simulated neural system was designed based on the following assump-
tions:
(1) The neural rhythm generator (RG) is composed of neural oscillators,
each of which controls the movement of a corresponding joint. As a model
neural oscillator, we adopt the half-center model, which is composed of two
reciprocally inhibiting neurons and which generates alternative activities be-
tween the two neurons [23].
(2) All of the relevant information about the body and the environment
is taken into account. The angles of the body segments in an earth-ﬁxed
frame of reference and ground reaction forces are available to the sensory
system. Global information on the position of the center of gravity (COG)
with respect to the position of the center of pressure (COP) is also available.
We assume that a gait is represented as a cyclic sequence of what we call
global states: the double-support phase, the ﬁrst half of the single-support
phase, and the second half of the single-support phase. The global states are
deﬁned by the sensory information on the alternation of the foot contacting
the ground and the orientation of the vector from the COP to the COG.
(3) Reciprocal inhibitions are incorporated between the neural oscillators
on the contralateral side, which generates the anti-phase rhythm of muscles
between the two limbs. Connections between the neural oscillators on the
ipsilateral side change in a phase-dependent manner, using the global state
to generate complex phase relationships of activity among the muscles within
a limb.
(4) Both the local information on the angles of the body segments and the
global information on the entire body are sent to the neural oscillators in a
manner similar to the functional stretch reﬂex, so that neural oscillation and
body movement are synchronized. Sensory information is sent only during
the relevant phase of the gait cycle by modulating the gains of the sensory
pathways in a phase-dependent manner, which is determined by the global
state.
(5) All of the neural oscillators share tonic input from the higher center,
which is represented by a single parameter. By changing the value of this
parameter, the excitability of each oscillator can be controlled so that diﬀerent
speeds of locomotion are generated.
(6) While the neural rhythm generator induces the rhythmic movement
of a limb, a posture controller (PC) is responsible for maintaining the static
posture of the stance limb by producing phase-dependent changes in the
impedance of speciﬁc joints. The ﬁnal motor command is a summation of the
signals from the neural rhythm generator and the posture controller.
The computer simulation demonstrated that, given a set of initial condi-
tions and values of various parameters, a stable pattern of walking emerged

192
Gentaro Taga
as an attractor formed in the state space of both the neural and musculo-
skeletal system. Figure 2 shows neural activities, muscle torques and a stick
picture of walking within one gait cycle. The attractor was generated by the
global entrainment between the oscillatory activity of the neural system and
rhythmic movements of the musculo-skeletal system.
When we ﬁrst proposed the model of bipedal locomotion [5], there were
few studies to suggest the existence of a spinal CPG in humans. More recently,
several studies have shown evidence for a spinal CPG in human subjects
with spinal cord injury [24-26]. Our model is likely to capture the essential
mechanism for the generation of human bipedal locomotion.
Fig. 1. A model of the neuro-musculo-skeletal system for human locomotion [14].

Nonlinear Dynamics of Human Locomotion
193
Fig. 2. The results of computer simulation of emergence of neural activity, muscle
torque and walking movements generated in a self-organized manner.

194
Gentaro Taga
2.2
Real-time ﬂexibility of bipedal locomotion in an
unpredictable environment
When the solution of the diﬀerential equations representing the neural and
musculo-skeletal systems converged to a limit cycle that was structurally sta-
ble, walking movement was maintained even with small changes in the initial
conditions and parameter values [15]. For example, when part of the body
was disturbed by a mechanical force, walking was maintained and the steady
state was recovered due to the orbital stability of the limit cycle attractor.
When part of the body was loaded by a mass, which can be applied by chang-
ing the inertial parameters of the musculo-skeletal system, the gait pattern
did not change qualitatively but converged to a new steady state, where the
speed of walking clearly decreased. When the walking path suddenly changed
from level to uneven terrain, the stability of walking was maintained but the
speed and the step length spontaneously changed as shown in Fig. 3. Natu-
rally, the stability of walking was broken for a heavy load and over a steep
and irregular terrain.
This real-time adaptability is attributed not only to the aﬀerent control
based on the proprioceptive information generated by the interaction between
the body and the mechanical environment, but also to the eﬀerent control
of movements based on intention and planning. In this model, a wide range
of walking speeds was available using the nonspeciﬁc input from the higher
center to the neural oscillators, which was represented by a single parame-
ter. Changes in the parameter can produce bifurcations of attractors, which
correspond to diﬀerent motor patterns [5,15].
It is open to question whether a 3D model of the body with a similar
model of the neural system will perform dynamic walking with stability and
ﬂexibility. Designing such a model is a crucial step toward constructing a
humanoid robot that walks in a real environment [27].
Fig. 3. Walking over uneven terrain.

Nonlinear Dynamics of Human Locomotion
195
3
Anticipatory adjustment of locomotion through
visuo-motor coordination
3.1
Anticipatory adjustment of locomotion during obstacle
avoidance
As long as the stability of the attractor is maintained, the locomotor sys-
tem can produce adaptive movements even in an unpredictable environment.
However, this way of generating motor patterns is not suﬃcient when the at-
tractor loses stability due to drastic changes in the environment. For example,
when we step over an obstacle during walking, the path of limb motion must
be quickly and precisely controlled using visual information that is avail-
able in advance. Given the emergent properties of the neuro-musculo-skeletal
system for producing the basic pattern of walking, how is this anticipatory
adaptation to the environment realized? Neurophysiological studies in cats
have shown that the motor cortex is involved in visuo-motor coordination
during anticipatory modiﬁcation of the gait pattern [28].
It was examined whether modiﬁcations of the basic gait pattern could
produce rapid enough changes so as to clear an obstacle placed in its path.
As shown in Fig. 4, the neural rhythm generator was combined with a system
referred to as a discrete movement generator, which receives both the output
of the neural oscillators and visual information regarding the obstacle and
generates discrete signals for modiﬁcation of the basic gait pattern [16].
By computer simulation, avoidance of obstacles of varying heights and
proximity was demonstrated, as shown in Fig. 5. An obstacle placed at an
arbitrary position can be cleared by sequential modiﬁcations of gait, namely
by modulating the step length when approaching the obstacle and modifying
the trajectory of the swinging limbs while stepping over it. An essential point
is that a dynamic interplay between advance information about the obstacle
and the on-going dynamics of the neural system produces anticipatory move-
ments. This implies that the planning of limb trajectory is not free from the
on-going dynamics of the lower levels of the neural system, body dynamics,
and environmental dynamics.
3.2
A model of the neuro-musculo-skeletal system for human
locomotion
The maintenance of gait when changes in the environment occur quickly rela-
tive to the walking rhythm was possible with the addition of a neural process-
ing component. A further question is what mechanism would be responsible
for adaptation through the action perception cycle of the visuo-motor coor-
dination. For example, how can the precise positioning of a foot on a visible
target on the ﬂoor during walking be achieved? The ecological approach of
perception and action argues that adaptation to the complex environment
is achieved not by the construction and the use of internal representations

196
Gentaro Taga
Fig. 4. A model of obstacle avoidance via anticipatory adaptation during walking
[16].
of the world but rather by the use of real time information available in the
optical ﬂow [29]. Time to contact an obstacle or a target, which information
can be obtained directly from a set of invariants present in the optical ﬂow,
has been studied as a key element in the visual control of locomotion [30].
We assumed that the step length modulation command, which was mod-
elled in [a] previous study, was continuously related to optical information
about the time remaining before one reached the target with the current eye-
foot axis [17]. This optical variable in relation to the subject’s own movement
was labelled as time-to-foot (TTF) as shown in Fig. 6. We further assumed
that the current step period was available and that it could be used with
TTF to determine whether the step length must be shortened or lengthened
to position the foot on the target.

Nonlinear Dynamics of Human Locomotion
197
Fig. 5. Result of computer simulation of [16].
Results of computer simulation gave rise to successful pointing behavior
as shown in Fig. 7. The generated behaviors for regulating step length were
similar to those observed in human subjects performing a locomotor pointing
task: namely, the time course of the inter-trial variability of the toe-target
distance and the relationship between the step number at which the regula-
tion is initiated and the total amount of adjustments involved. An important
point of this model was that the adaptation of locomotion emerged from
a perception-action coupling type of control based on temporal information
rather than on the representation of the target. This is the ﬁrst attempt to
bridge the gap between the ecological approach to perception and the self-
organized control of locomotion based on global entrainment.
4
Computational “lesion” experiments in gait
pathology
It is well known that speciﬁc damage to the brain or the peripheral nervous
system leads to locomotor disorders. Although the musculo-skeletal dynam-
ics during walking have been intensively studied in clinical applications of
orthopaedic issues [31], very few studies have taken a modelling approach to
understanding pathological gaits due to brain dysfunctions. A question to be
asked here is whether the generic model for the emergence of a basic gait
can be used to reproduce pathological patterns of gait by changing model
parameters.

198
Gentaro Taga
Fig. 6. Time-to-foot information [17].
Fig. 7. Result of computer simulation of locomotor pointing tasks [17]. a. steady
state walking. b. adjustment of step by shortening of step length. c. adjustment of
step by lengthening of step length.

Nonlinear Dynamics of Human Locomotion
199
As shown in Fig. 8, asymmetric gaits, irregular gaits with changing step
lengths and shuﬄing gaits with very small step lengths were generated by
changing the values of the parameters of the motor or sensory pathways
asymmetrically, decreasing the strength of the connections between the neu-
ral oscillators and decreasing the tonic input to the rhythm generator, respec-
tively. These patterns of gaits were similar to those of patients with hemi-
plegia, cerebellar disease, and Parkinson’s disease. The results demonstrated
that qualitative changes in gait patterns were produced by the computa-
tional ”legion” study. This inferred that the generation of pathological gaits
can be viewed as a self-organizing process, where dynamic interactions be-
tween remaining parts of the system spontaneously produce speciﬁc patterns
of activity.
Fig. 8. Generation of pathological gaits. (a), (b) and (c) in the model show the area
aﬀected by the changes, and the gaits generated by these changes are presented in
the three columns on the right-hand side.
5
Freezing and freeing degrees of freedom in the
development of locomotion
Once we had chosen a structure of the neural system and a set of parameter
values that produced a walking movement as a stable attractor, the model
exhibited ﬂexibility against various changes in the environmental conditions.
However, it was diﬃcult to determine the structure of the model and to
tune the parameters, since the entire system was highly nonlinear. A number
of studies have used a genetic algorithm [32,33] and reinforcement learning
[34] to obtain good locomotor performance in animals and in humans. An-
other approach to overcoming the diﬃculty of parameter tuning of locomotor
systems is to explore the motor development of infants and to unravel a de-
velopmental principle of the neuro-musculo-skeletal system. Here I show that

200
Gentaro Taga
freezing and freeing degrees of freedom is one of the key mechanisms for the
acquisition of bipedal locomotion during development.
A prominent feature of locomotor development is that newborn infants
who are held erect under their arms perform locomotor-like activity [35].
The existence of newborn stepping behavior implies that the neural system
already contains a CPG for rhythmic movements of the lower limbs. Inter-
estingly, this behavior disappears after the ﬁrst few months. Then, around
one year of age, infants start walking independently. Why are the succes-
sive appearance, disappearance and reappearance of stepping observed in
the development of locomotion? According to traditional neurology, the dis-
appearance of motor patterns is due to the maturation of the cerebral cortex,
which inhibits the generation of movements on the spinal level. However, it
was reported that the stepping of infants of a few months of age can be easily
induced on a treadmill [35]. It is likely that the spinal CPG is used for the
generation of independent walking.
I hypothesized that this change reﬂects the freezing and freeing degrees
of freedom of the neuro-musculo-skeletal system, which may be produced by
the interaction between a neural rhythm generator (RG) composed of neu-
ral oscillators and a posture controller (PC). A computational model was
constructed to reproduce qualitative changes in motor patterns during devel-
opment of locomotion by the following sequence of changes in the structure
and parameters of the model, as shown in Fig. 9 [18].
(1) It was assumed that the RG of newborn infants consists of six neural
oscillators which interact through simple excitatory connections and that the
PC is not yet functioning. When the body was mechanically supported and
the RG was activated, the model produced a stepping movement, which was
similar to newborn stepping. Tightly synchronized movements of the joints
were generated by highly synchronized activities of the neural oscillators on
the ipsilateral side of the RG, which we called ”dynamic freezing” of the
neuro-muscular degrees of freedom.
(2) When the PC was recruited and its parameters were adjusted, the
model became able to maintain static posture by ”static freezing” of degrees
of freedom of the joints. The disappearance of the stepping was caused by
interference between the RG and the PC.
(3) When inhibitory interaction between the RG and the PC was de-
creased, independent stepping appeared. This movement was unable to pro-
duce forward motion. We called this mechanism as ”static freeing,” since the
frozen degrees of freedom of the musculo-skeletal system by the PC were
freed.
(4) By decreasing the output of the PC and increasing the input of the
sensory information on the segment displacements to the RG, forward walking
was gradually stabilized. The simply synchronized pattern of neural activity
in the RG changed into a complex pattern with each neural oscillator gener-
ating rhythmic activity asynchronously with respect to one another. By this

Nonlinear Dynamics of Human Locomotion
201
mechanism, called ”dynamic freeing,” gait patterns became more similar to
those of adults.
This model suggests that the u-shaped changes in performance of stepping
movements can be understood as the sequence of dynamic freezing, static
freezing, static freeing and dynamic freeing of degrees of freedom of the neuro-
musculo-skeletal system. This mechanism is considered to be important for
the acquisition of stable and complex movements during development. In
particular, parameter tuning for dynamic walking becomes easier after the
control of a static posture is established.
6
Concluding comments
To understand human locomotion, we need a multidisciplinary approach that
includes diﬀerent types of studies such as biomechanics, neurophysiology, eco-
logical psychology, developmental psychology, theoretical physics, computer
science and robotics. The purpose of the present paper was to present a
general framework capable of integrating diﬀerent types of observations. We
have shown that the neuro-musculo-skeletal model can reproduce varieties of
behaviours concerning human locomotion on a basis of nonlinear dynamics.
A lot of questions remained to be solved with regard to the development
of locomotion. In early infancy, we can observe spontaneous movements of
the head, trunk, arms and legs. The patterns of movements are not random
and are more complex than simply rhythmic movements [36]. It is not clear
whether the spontaneous movements are manifestations of activity by the
spinal central pattern generator or not. This is an extremely important point
to clarify in understanding the mechanism of the development of walking and
other voluntary movements. Another interesting issue is that young infants
can perceive the human walking pattern long before they start to walk. Do
they use some form of representation of the walking pattern when they prac-
tice independent walking? If so, is the mechanism the same as the one for
learning a new movement in adults? Brain imaging techniques in infants pro-
gressively reveal the status of brain development in early infancy [37]. The
advancement of this type of technique may provide deeper insight into the
design principle of human locomotion in the near future.
References
1. Nicolis, G., Prigogine, I., 1977, Self-organization in Nonequilibrium Systems,
John Wiley and Son..
2. Haken, H., 1976, Synergetics - An Introduction, Springer-Verlag.
3. Sch()ner, G., Kelso, J.A.S., 1988, Dynamic pattern generation in behavioral
and neural systems, Science, 239, 1513-1520.
4. Grillner, S., 1985, Neurobiological bases of rhythmic motor acts in vertebrates,
Science, 228, 143-149.

202
Gentaro Taga
Fig. 9. A model of the development of bipedal locomotion of infants and results of
computer simulation.

Nonlinear Dynamics of Human Locomotion
203
5. Taga, G., Yamaguchi, Y., and Shimizu, H., 1991, Self-organized control of
bipedal locomotion by neural oscillators in unpredictable environment, Biol.
Cybern., 65, 147-159.
6. Kimura, S., Yano, M., Shimizu, H., 1993, A self-organizing model of walking
patterns of insects, Biol. Cybern., 69, 183-193.
7. Ekeberg, O., 1993, A combined neuronal and mechanical model of ﬁsh swim-
ming, Biol. Cybern., 69, 363-374.
8. Wadden, T., Ekeberg, O., 1998, A neuro-mechanical model of legged locomo-
tion: single leg control. Biol. Cybern., 79, 161-173.
9. Ijspeert, A.J. 2001. A connectionist central pattern generator for the aquatic
and terrestrial gaits of a simulated salamander. Biol. Cybern. 84, 331-348.
10. Lewis, M. A., Etienne-Cummings, Hartmann, M. J., Xu, Z. R., and Cohen,
A. H. 2003. An in silico central pattern generator: silicon oscillator, coupling,
entrainment, and physical computation. Biol. Cybern. 88:137-151.
11. Miyakoshi, S., Yamakita, M., Furata, K., 1994, Juggling control using neural
oscillators, Proc. IEEE/RSJ IROS, 2, 1186-1193.
12. Kimura, H., Sakurama, K., Akiyama, S., 1998, Dynamic walking and running
of the quadraped using neural oscillators, Proc. IEEE/RSJ, IROS, 1, 50-57.
13. Williamson, M., M., 1998, Neural control of rhythmic arm movements, Neural
Networks, 11, 1379-1394.
14. Taga, G., 1995, A model of the neuro-musculo-skeletal system for human loco-
motion. I. Emergence of basic gait, Biol. Cybern., 73, 97-111.
15. Taga, G., 1995, A model of the neuro-musculo-skeletal system for human loco-
motion. II. Real-time adaptability under various constraints, Biol. Cybern., 73,
113-121.
16. Taga, G., 1998, A model of the neuro-musculo-skeletal system for anticipatory
adjustment of human locomotion during obstacle avoidance. Biol. Cybern., 78,
9-17.
17. de Rugy A., Taga, G., Montagne, G., Buekers, M., J., Laurent M., 2002,
Perception-action coupling model for human locomotor pointing, Biol. Cybern.
87, 141-150.
18. Taga, G., 1997, Freezing and freeing degrees of freedom in a model neuro-
musculo-skeletal system for development of locomotion, Proc. XVIth Int. Soc.
Biomech. Cong., 47.
19. Vukobratovic, M., Stokic, D., 1975, Dynamic control of unstable locomotion
robots, Math. Biosci. 24, 129-157.
20. McGeer, T., 1993, Dynamics and control of bipedal locomotion, J. Theor. Biol.
163, 277-314.
21. van der Linde, R. Q., 1999, Passive bipedal walking with phasic muscle con-
traction, Biol. Cybern. 81, 227-237.
22. Raibert, M., H., 1984, Hopping in legged systems - modeling and simulation
for the two-dimensional one-legged case, IEEE Trans. SMC, 14, 451-463.
23. Matsuoka, K., 1985, Sustained oscillations generated by mutually inhibiting
neurons with adaptation, Biol. Cybern. 52, 367-376.
24. Calancie, B., Needham-Shropshire, B., Jacobs, et al., 1994, Involuntary step-
ping after chronic spinal cord injury, Evidence for a central rhythm generator
for locomotion in man, Brain, 117, 1143-1159.
25. Dimitrijevic, M., R., Gerasimenko, Y., Pinter, M., M., 1998, Evidence for a
spinal central pattern generator in humans, Ann NY Acad Sci, 860, 360-376.

204
Gentaro Taga
26. Dietz V., 2002, Proprioception and locomotor disorders, Nature Rev. Neurosci.
3, 781-790
27. Miyakoshi, S., Taga, G., Kuniyoshi, Y. et al., 1998, Three dimensional bipedal
stepping motion using neural oscillators - towards humanoid motion in the real
world. Proc. IEEE/RSJ, 1, 84-89.
28. Drew, T., 1988, Motor cortical cell discharge during voluntary gait modiﬁcation,
Brain Res., 457, 181-187.
29. Gibson, J. J., 1979, An ecological approach to visual perception. Houghton-
Miﬄin, Boston.
30. Lee, D. N., 1976, A theory of visual control of braking based on information
about time-to-collision. Perception 5, 437-459.
31. Zajac F. E., Neptune, R. R., Kautz, S. A., 2003, Biomechanics and muscle
coordination of human walking Part II: Lessons from dynamical simulations
and clinical implications. Gait and Posture, 17, 1-17.
32. Lewis, M., A., Fagg, A., H., Bekey, G. A., 1994, Genetic Algorithms for Gait
Synthesis in a Hexapod Robot, In Zheng, Y., F., ed. Recent Trends in Mobile
Robots, World Scientiﬁc, New Jersey, 317-331.
33. Yamazaki, N., Hase, K., Ogihara, N., et al. 1996, Biomechanical analysis of the
development of human bopedal walking by a neuro-musculo-skeletal model,
Folia Primatologica, 66, 253-271.
34. Sato, M., Nakamura, Y., Ishii, S., 2002, Reinforcement learning for biped loco-
motion. Lect. Notes Comput. Sc. 2415, 777-782.
35. Thelen, E., Smith, L., B., 1994, A Dynamic Systems Approaches to the Devel-
opment of Cognition and Action, MIT Press.
36. Taga, G., Takaya, R., Konishi, Y., 1999, Analysis of general movements of
infants towards understanding of developmental principle for motor control.
Proc. IEEE SMC, V678-683
37. Taga,G., Asakawa, K., Maki, A., Konishi, Y., Koizumi, H., 2003, Brain imaging
in awake infants by near infrared optical topography, PNAS 100-19, 10722-
10727

Towards Emulating Adaptive Locomotion of a
Quadrupedal Primate by a
Neuro-musculo-skeletal Model
Naomichi Ogihara1 and Nobutoshi Yamazaki2
1 Department of Zoology, Graduate School of Science, Kyoto University
Kitashirakawa-Oiwakecho, Sakyo, Kyoto 606-8502, Japan
2 Department of Mechanical Engineering, Faculty of Science and Technology,
Keio University, 3-14-1, Hiyoshi, Kohoku, Yokohama 223-8522, Japan
Abstract. A neuro-musuculo-skeletal model of a quadrupedal primate is con-
structed in order to elucidate the adaptive nature of primate locomotion by the
means of simulation. The model is designed so as to spontaneously induce locomo-
tion adaptive to environment and to its body structure, due to dynamic interaction
between convergent dynamics of a recurrent neural network and passive dynam-
ics of a body system. The simulation results show that the proposed model can
generate a stepping motion natural to its body structure while maintaining its pos-
ture against an external perturbation. The proposed framework for the integrated
neuro-control of posture and locomotion may be extended for understanding the
adaptive mechanism of primate locomotion.
1
Introduction
Variations in osteological and muscular anatomy in primates are well corre-
lated with diﬀerences in their primary locomotor habits [1]. Modiﬁcations in
limb length and body proportion are also connected to their locomotion since
these parameters determine the natural oscillation pattern of a body system
[2,3,4]. These ﬁndings imply that primate locomotion is basically generated
in such a way that they utilize the structures of body system, which are ra-
tionally acquired through their evolutional process. Locomotion of animals,
including that of primates, is often regarded adaptive in terms of robust-
ness against environmental changes and unknown perturbations. However,
there are actually two sides in adaptive mechanism of primate locomotion -
adaptivity to the environment, and to the body structure.
Such a twofold adaptivity found in the primate locomotion can be hypoth-
esized to be emerged by dynamic interaction between the nervous system and
the musculo-skeletal system. A network of neurons recurrently connecting to
the others can be viewed as a dynamical system, which autonomously behaves
based on a minimization principle; it behaves convergently to decrease an en-
ergy function deﬁned in it [5]. Moreover, a body is also a dynamical system
that has passive properties due to its physical characteristics such as segment
inertial parameters and joint mobilities [6]. If these dynamical systems are

206
Naomichi Ogihara, Nobutoshi Yamazaki
mutually connected as they are in actuality, appropriate constraints may be
self-organized because of the convergent characteristics of the systems, and
the adaptive nature of the primate locomotion could be spontaneously emu-
lated. In the present study, a neuro-musculo-skeletal model of a quadrupedal
primate is constructed based on the above-mentioned idea.
2
Model
2.1
Mechanical model
A quadrupedal primate is modeled as a 16-segment, three-dimensional rigid
body kinematic chain as shown in Fig. 1. The equation of motion of the model
is derived as
M¨q + h(˙q, q) + g −α(q) + β(˙q) = T + Φ
(1)
where q is a (51 x 1) vector of translational and angular displacement of
the middle trunk segment and 45 joint angles, T is a vector of joint torques, M
is an inertia matrix, h is a vector of torque component depending on Coriolis
and centrifugal force, g is a vector of torque component depending on gravity,
α and β are vectors of elastic and viscous elements due to joint capsules and
ligaments (passive joint structure) which restrict ranges of joint motions, Φ is
a vector of torque component depending of the ground reaction forces acting
on the limbs, respectively. The primate model is constructed after a female
Japanese macaque cadaver. Each segment is approximated by a truncated
elliptical cone in order to calculate its inertial parameters.
All joints are modeled as three degree-of-freedom gimbal joints. How-
ever, here we restrict abduction-adduction and medial-lateral rotation of
limb joints by visco-elastic elements. Joints connecting trunk segments are
also restricted, so that the head and the trunk segments can be treated as
one segment. The other joint elastic elements are represented by the double-
exponential function [7]:
αj = kj1 exp(−kj2(qj −kj3)) −kj4 exp(−kj5(kj6 −qj))
βj = cj ˙qj
(2)
where αj and βj the torque exerted by elastic and viscous element around
the j th joint, qj is the j th joint angle, and kj1∼6 and cj are coeﬃcients deﬁn-
ing the passive joint properties, respectively. In this study, the coeﬃcients
kj1∼6 are determined so as to roughly imitate actual joint properties. The
ground is also modeled by visco-elastic elements. The hand and the foot are
modeled with four points that can contact the ground. The actual center of
pressure (COP) is calculated using the points. The global coordinate system
and the body (trunk) coordinate system are deﬁned as illustrated in Fig. 1.

Towards Emulating Adaptive Locomotion of a Quadrupedal Primate
207
Fig. 1. Mechanical model of a quadrupedal primate.
2.2
Nervous model
Integrated control of posture and locomotion It is generally accepted
that locomotion is generated by alternating the activities of the extensor
and ﬂexor muscles under the control of rhythm-generating neural circuits in
the spinal cord known as the central pattern generator (CPG) [8,9]. How-
ever, previous research on decerebellated cats shows that coordination of
limbs is greatly disturbed and balance of the trunk is lost in these animals
[10]; whereas decerebrate cats, whose cerebellums are left intact, can bal-
ance themselves and walk in more coordinated ways [11]. The cerebellum is
a region where various sensory information, such as the vestibular organ and
the aﬀerent signals from proprioceptors and exteroceptors, is all integrated.
Thus, the integration of multimodal aﬀerent information in the cerebello-
spinal systems is suggested indispensable for integrated control of posture
and locomotion [12].
From biomechanical and kinesiological viewpoint, both posture and loco-
motion can be seen as being controlled by adjusting ground reaction forces
acting on the limbs. To sustain the trunk segment at a certain position and

208
Naomichi Ogihara, Nobutoshi Yamazaki
orientation in three-dimensional space, appropriate force and moment have
to be applied to the center of the mass (COM) of the trunk. In case of loco-
motion, they must be applied in a traveling direction to displace the body.
In primates, such a force and a moment can only be applied by generating
the reaction forces acting on the limbs from the ground, and the nervous
system somehow needs to adjust them in an integrative manner. Here we
assume that activities of the neurons in the nervous system represent ground
reaction forces necessary to maintain the posture and locomotion, and ap-
propriate forces are spontaneously generated based on the various sensory
inputs.
Recurrent neural network model In this study, an array of 12 neurons
is expressed as u = [u1 u2 u3 u4]T , where uL is the (3 x 1) vector of the
state variables corresponding to three components of the ground reaction
force vector of the Lth limb (L=1,2,3,4; 1=right fore, 2=left fore, 3=right
hind, 4=left hind). In order to sustain the trunk posture, the nervous system
consisting of the neurons is assumed to behave so as to spontaneously fulﬁll
the following equations of equilibrium:
BF =
4
L=1
γLuL
BN =
4
L=1
(BrL) × (γLuL) =
4
L=1
S(BrL) · γLuL
(3)
where BF and BN are the (3 x 1) vectors corresponding to the neuronal
representation of force and moment should be applied at the COM of the
trunk segment, BrL is the position vector from the COM to the COP of the
L th limb, γL is the signal from the cutaneous receptor of the palm/sole of
the L th limb (=1 when the limb touches the ground, and 0 otherwise), S(r)
is a matrix representing skew operation on the vector r, respectively. The left
superscript B indicates that the vectors are represented in the body (trunk)
coordinate frame. Such a nervous system can be modeled by a recurrent
neural network [5] as follows:
duL
dt
= −γLA·QT
L·W·
"
L
QLγLuL −
 BF
BN
#
−BuL,
QL =

I
S(BrL)

(4)
where QL is the (6 x 3) matrix, I is the (3 x 3) unit matrix, W is the (6 x 6)
diagonal weight matrix, A is the (3 x 3) diagonal matrix of reciprocals of time
constants, B is the (3 x 3) diagonal matrix, respectively. The neural states u
autonomously behave so as to decrease the following potential function:
E = 1
2
"
L
QLγLuL −
 BF
BN
#T
·W·
"
L
QLγLuL −
 BF
BN
#
+1
2uT
LBuL(5)

Towards Emulating Adaptive Locomotion of a Quadrupedal Primate
209
where E is the potential function representing the weighted summation
of square errors of Eq. (3). Therefore, the proposed neural network, given the
input BF and BN, can autonomously estimate the ground reaction forces
necessary to sustain the balance of the posture while minimizing the force.
BF and BN, are assumed to be determined by the intention (motivation)
to keep the trunk stable at an appropriate position and orientation, and the
input from the vestibular organ, which works as the sensor of the translational
and rotational velocities of the head (trunk) segment, as
BF = KF(Bpd) −κ(δ −ζ)Bng −CF
B ˙p
(6)
BN = KN
BΘd −CN
Bω
(7)
Bpd =

L
γL
BrL
	
L
γL
(8)
where Bpd is the position vector from the COM to the centroid of the
polygon formed by the COP’s of the limbs, Bng is the unit vector showing
the direction of the gravitational force, B ˙p is the velocity of the COM of the
trunk segment, δ is the distance between the COM and the ground along
the vector Bng, BΘd is the Eulerian angles between the present and the
desired orientation of the body, Bω is the angular velocity vector of the trunk
segment, κ and ζ are coeﬃcients, KF , KN, CF , CN are (3 x 3) diagonal
matrices of coeﬃcients, respectively. The third term in the right side in Eq.
(6) and the second term in Eq. (7) show the input from the vestibular organ,
while others show the intention of motion, which is to keep the body position
at some distance apart from the ground.
Since Bpd, Bng, B ˙p, and Bω are all represented in the body reference
frame, the nervous system is assumed to be able to sense these quantities;
Bpd by the cutaneous receptors on the palm/sole and the muscle spindles
(joint angle sensors), and Bng, B ˙p, and Bω by the vestibular system. The
sensory-motor map, Q and J, are assumed to be correctly represented in the
nervous system.
Rhythm pattern generator The rhythm pattern generator, which coordi-
nates sequential limb movement in a quadrupedal animal, exists in primates
as well [14]. Here it is modeled by the equations proposed by Matsuoka [15,16]:
τ ˙UL = −UL + 
i
zLiyi + s0 −hLVL
τ ′ ˙VL = −VL + yL yL = max(UL, 0)
(9)
where UL is the inner state of the L th CPG neuron whose activation
corresponds to the stance-swing phase of the L th limb, VL is a variable
representing self-inhibition of the UL, τ and τ ′ are time constants, yL is the

210
Naomichi Ogihara, Nobutoshi Yamazaki
output of the L th CPG neuron, zLi is the weight of neural connections, hL is
the weight of self-inhibition, s0 is the constant input, respectively. The CPG
is assumed to represent swing phase of the L th limb if (yl −η) >0 and stance
phase if otherwise (η is a constant). To command the limb motion in a swing
phase according to the CPG signal, we assume another neural variables vL
which correspond to three components of the ground reaction force vector of
the L th limb:
vL = (yL −η)mL
(10)
where mL is a (3 x 1) vector of coeﬃcients determining the uplift motion
of limb in swing phase. mL is assumed to be zero when in stance phase. In
order for the nervous system not to depend on the swing limb for supporting
the body against gravity, the CPG signal is assumed to be inputted in Eq.
(4) as
duL
dt = −γLA · QT
L · W ·
$
L
QLγLuL −
 BF
BN
%
−BuL
+λε · [max(−εuL,x, 0), 0, 0]T
(11)
where ε = sgn(yL −η), and uL,x is the x component of uL. The third
term represents that uL,x should be positive when the CPG commands the
L th limb to be in swing phase, and negative when in stance phase.
Fig. 2. Schematic diagram of the neural network. The CPG output and the cuta-
neous signal are drawn only forL=2.
Joint torque The joint torques are generated according to the signals from
the nervous system, uL and vL, as
nL = −JT
L(uL + vL)
(12)

Towards Emulating Adaptive Locomotion of a Quadrupedal Primate
211
where nL is the (9 x 1) vector of the joint torques of the L th limb, JL is
the (9 x 3) Jacobian matrix. Another recurrent neural network can be added
which produces the joint torques based on the anatomical constraints of the
musculo-skeletal systems [13]. However, for simplicity, here we compute the
torques by the principle of virtual work.
2.3
Mutual interaction between neuro-mechanical systems
Fig. 2 shows a schematic diagram of the interaction between the neuro-
mechanical systems. Given the intention to keep the posture, the nervous
system can autonomously generate the signal u, which corresponds to the
ground reaction forces, such as to decrease the potential function deﬁned in
Eq. (5). In addition, the CPG generates the rhythmic signal v. u and v are
then transformed by the sensory-motor map J to produce the joint torque n.
On the other hand, the sensory information of resultant motion is returned
to the nervous system by the vestibular systems ( Bng, B ˙p, and Bω), the cu-
taneous receptor (γL), and the proprioceptor (q), so that the entire systems
are mutually integrated.
If the CPG is not activated, a stationary posture is generated. When the
model intends to locomote, the CPG is activated and the limbs start to move
sequentially. The rhythmic signals can be regarded as a perturbation inter-
fering maintenance of the posture. But because of the inherent convergent
properties of the nervous system and the body system, adaptive locomotion
may be self-organized.
2.4
Calculation Method
The model is expressed as simultaneous diﬀerential equations. They are nu-
merically integrated using the variable time-step Runge-Kutta method with
Merson error estimator. It is diﬃcult to estimate a steady states of the entire
systems because the touches to the ground at many points. Therefore, the
model is initially placed apart from the ground. The neural parameters which
deﬁne the behavior of the system, such as W, A, B, K, and C are arbitrarily
chosen. The neurons in the rhythm pattern generator are so connected that
the limbs move in diagonal sequence.
3
Results
3.1
Generation of stationary postures
In order for a quadrupedal animal to sustain its posture, of course, appropri-
ate joint torques has to be generated by the nervous system. Fig. 3A shows
that the primate model with the proposed neural network can autonomously
generate appropriate joint torques and successfully sustain its body. Fur-
thermore, the model can alter inclination of the trunk segment and its axial

212
Naomichi Ogihara, Nobutoshi Yamazaki
rotation without falling down, as illustrated in Fig. 3B and C. The model
can change its intended posture autonomously by coordinating joint torques,
just by altering one signal input from the cortex, BΘd. It should be noted
that the model stands without any prior knowledge about the environment.
Therefore, the same model should be able to stand on an uneven terrain.
Fig. 3. Generated stationary postures. A Normal posture. B The trunk segment is
inclined. C The trunk is rotated.
3.2
Generation of stepping motion
Fig. 4 illustrates the stick picture of a generated stepping behavior of the
model (A), and changes in vertical ground reaction force (B) and joint an-
gles (C, D) over time. The stick diagram is traced every 0.3 sec for 1.5 sec
(approximately equal to its stepping cycle). In this study, soon after the cal-
culation is started, the impulsive reaction force due to foot-ground contact
is applied to the model, and the model comes to a steady position. After
that, according to the activation of the CPG, the model starts to generate
a stepping motion; thus the ground reaction forces are sequentially altered.
However, the joint angle proﬁles show that, while ranges of forelimb joint mo-
tions are large, those of hindlimb become small, and the hindlimb is actually
not lifted up from the ground here, although the model tries to, as seen in
the Fig. 4B. Because the tuning of the parameters in the nervous system is
not optimized, the model has not succeeded in generating locomotion pattern
that is comparable to that of actual monkeys. But the model autonomously
reacts to keep its balance while continuously jiggling the body.
To examine the adaptivity of the stepping motion, a perturbation is ap-
plied (10N in the forward direction plus 10N in the lateral direction for 0.1sec)
to the trunk segment. Fig. 5 shows changes in the ground reaction force and
the joint angles over time, and the arrows in the ﬁgure indicate the time when
the perturbation is applied. As the graphs show, the body is swayed and the
joint motions are disturbed because of the perturbation, but it can spon-
taneously coordinate its joint torques to balance itself due to the combined
dynamics of the neural and the body systems.
In this study, no mechanism is implemented for precisely controlling the
swing phase. In addition, an intention to move forward is not given to the

Towards Emulating Adaptive Locomotion of a Quadrupedal Primate
213
Fig. 4. Generated stepping motion
Fig. 5. Reaction to an external perturbation. The arrows indicate when the per-
turbation is applied.

214
Naomichi Ogihara, Nobutoshi Yamazaki
model; thus it dose not walk but jiggle. If proper constraints are additionally
considered in the nervous system as we did previously [17], and the intention
to walk is set, locomotion may hopefully be generated.
4
Discussion
The results show that the proposed model generates an adaptive stepping
motion. Here, the joint torques are not preplanned like a humanoid robot
[18] at all, but they are spontaneously yielded by the natural behavior of
the combined dynamics of the body and the neural circuit. As in Eq. (4),
the neural network is implicitly designed to generate ground reaction forces
as if a virtual visco-elastic element is attached between the body and the
space [19,20]. Therefore, the enormous number of joint degree of freedom is
spontaneously coordinated to produce appropriate reaction forces, and at the
same time, motions are naturally generated in terms of the body structure.
The model also shows robustness to changes in body parameters and noises
on the neural activities. Even though the mass of a segment or a parameter
deﬁning a joint property is altered, the model can still maintain its posture.
Local reﬂex mechanism, such as righting reﬂexes, could also be added in this
model coordinately, since the proposed neural system can adapt the resultant
eﬀect of the added reﬂex.
Although there is no direct evidence showing such a proposed network ac-
tually exists, however, recently, the fastigial nucleus in the cerebellum is found
to be a new locomotion inducing site [21,22], indicating that the integration
of multimodal sensory information and the rhythmic signals at this level is
important for generation of coordinated limb movements. It is also noted that
load receptors take very important roles in generation of locomotion [23,24],
suggesting that reaction forces may be computed by the neurons, and the
posture and locomotion is functionally integrated by them. The framework
of the proposed model may be biologically feasible and similar representation
and integration of the neural information may be implemented in the actual
nervous system.
We believe this kind of synthetic approach is important for elucidating
adaptive nature of primate locomotion. It is because physiological study by
itself does not illuminate how the actual nervous system functions as a dy-
namical system. Certainly, advances in physiology and neuroscience have re-
vealed to where each of neurons is connected and how it functions. Newly
developed instrumentations also successfully visualize functional localization
of activity in the brain in various tasks or functions including human walking
[25]. However, these ﬁndings alone do not indicate how the nervous system
controls the timing and magnitude of activity of each of muscles to gen-
erate adaptive locomotion in various environments. Whereas the proposed
synthetic approach can qualitatively predict the interactive dynamics of the
entire neuro-musculo-skeletal system, so that the underlying hypothesis can

Towards Emulating Adaptive Locomotion of a Quadrupedal Primate
215
be tested, and insights on the adaptive mechanism can be gained through
the simulation, as insisted in the systems biology approach [26].
Yet, the adaptive nature of primate locomotion does not emerge in the
nervous system by itself. In biological systems, the body dynamics becomes
a part of the neural dynamics and vise versa, as mimicked in this simula-
tion. Therefore, the physical characteristics of the body system determined
by its anatomy and morphology greatly aﬀects the integrated dynamics. Un-
derstanding of inherent reasonability of the primate body structure is thus
also essential, and it should be incorporated into the model as well.
Acknowledgements
The authors are grateful to Prof. H. Ishida and Dr. M. Nakatsukasa for their
continuous supports and encouragement. This work is supported by the grant-
in-aid from the Japan Society for the Promotion of Science (#13740496) and
the grant-in-aid for the 21st Century COE Research (A2).
References
1. Gebo DL (ed) (1993) Postcranial Adaptation in Nonhuman Primates. Northern
Illinois University Press, DeKalb
2. Mochon S, McMahon TA (1980) Ballistic walking. J Biomech 13: 49-57
3. Yamazaki N (1990) The eﬀect of gravity on the interrelationship between body
proportions and brachiation in the gibbon. Hum Evol 5: 543-558
4. Yamazaki N (1992) Biomechanical interrelationship among body proportions,
posture, and bipedal walking. In: Matano S, Tuttle RH, Ishida H, Goodman M
(eds) Topics in Primatology Vol. 3. University of Tokyo Press, Tokyo, pp.243-
257
5. Hopﬁeld JJ, Tank DW (1986) Computing with neural circuits: A model. Science
233: 625-633
6. McGeer T (1992) Principles of walking and running. In: Alexander M (ed) Me-
chanics of Animal Locomotion (Advances in Comparative and Environmental
Physiology Vol.11). Springer-Verlag, Berlin, pp.113-139
7. Davy DT, Audu ML (1987) A dynamic optimization technique for predicting
muscle forces in the swing phase of gait. J Biomech 20: 187-201
8. Grillner S (1975) Locomotion in vertebrates: central mechanisms and reﬂex
interaction. Physiol Rev 55: 274-304
9. Shik ML, Orlovsky GN (1976) Neurophysiology of locomotor automatism.
Physiol Rev 56: 465-501
10. Orlovsky GN (1970) Inﬂuence of the cerebellum on the reticulo-spinal neurones
during locomotion. Biophysics 15: 928-936
11. Mori S (1987) Integration of posture and locomotion in acute decerebrate cats
and in awake, freely moving cats. Progress in Neurobiology 28: 161-195
12. Armstrong DM, Apps R, Marple-Horvat DE (1997) Aspects of cerebellar func-
tion in relation to locomotor movements. In: de Zeeuw CI, Strata P, Voogd J
(eds) Progress in Brain Research. The Cerebellum: From Structure to Control.
Elsevier, Amsterdam, pp.401-421

216
Naomichi Ogihara, Nobutoshi Yamazaki
13. Ogihara N, Yamazaki N (2001) Generation of spontaneous reaching movement
based on human anatomical constraints (in Japanese with English abstract).
Transactions of the Japan Society of Mechanical Engineers C-67: 2314-2320
14. Eidelberg E, Walden JG, Nguyen LH (1981) Locomotor control in macaque
monkeys. Brain 104: 647-663
15. Matsuoka K (1985) Sustained oscillations generated by mutually inhibiting
neurons with adaptation. Biol Cybern 52: 367-376
16. Matsuoka K (1987) Mechanisms of frequency and pattern control in the neural
rhythm generators. Biol Cybern 56: 345-353
17. Ogihara N, Yamazaki N (2001) Generation of human bipedal locomotion by a
bio-mimetic neuro-musculo-skeletal model. Biol Cybern 84: 1-11
18. Hirai K, Hirose M, Haikawa Y, Takenaka T (1998) The development of Honda
humanoid robot. Proc IEEE Intl Conf Robotics and Automations 1321-1326
19. Pratt J, Chew CM, Torres A, Dilworth P, Pratt G (2001) Virtual model control:
An intuitive approach for bipedal locomotion. Int J Robot Res 20: 129-143
20. Sari K, Nelson G, Quinn R (2000) Dynamics and control of a simulated 3-D
humanoid biped. Proc Intl Symp Adaptive Motion of Animals and Machines
1: ThP-I-2
21. Mori S, Matsui T, Kuze B, Asanome M, Nakajima K, Matsuyama K (1999)
Stimulation of a restricted region in the midline cerebellar white matter evokes
coordinated quadrupedal locomotion in the decerebrate cat. J Neurophysiol 82:
290-300
22. Mori S, Matsui T, Mori F, Nakajima K, Matsuyama K (2000) Instigation and
control of treadmill locomotion in high decerebrate cats by stimulation of the
hook bundle of Russell in the cerebellum. Can J Physiol Pharmacol 78: 945-957
23. Dietz V, Muller R, Colombo G (2002) Locomotor activity in spinal man: sig-
niﬁcance of aﬀerent input from joint and load receptors. Brain 125: 2626-2634
24. Duysens J, Van de Crommert HWAA, Smits-Engelsman BCM, Van der Helm
FCT (2002) A walking robot called human: lessons to be learned from neural
control of locomotion. J Biomech 35: 447-453
25. Miyai I, Tanabe CT, Sase I, Eda H, Oda I, Konishi I, Tsunazawa Y, Suzuki T,
Yanagida T, Kubota K (2001) Cortical mapping of gait in humans: A Near-
Infrared spectroscopic topography study. Neuroimage 14: 1186-1192
26. Kitano H (2002) Computational systems biology. Nature 420: 206-210

Dynamics-Based Motion Adaptation for a
Quadruped Robot
Hiroshi Kimura and Yasuhiro Fukuoka
Graduate School of Information Systems, University of Electro-Communications,
1-5-1 Chofu-ga-oka, Chofu, Tokyo 182-8585, Japan
Abstract. In this paper, we propose the necessary conditions for stable dynamic
walking on irregular terrain in general, and we design the mechanical system and
the neural system by comparing biological concepts with those necessary condi-
tions described in physical terms. PD-controller at joints can construct the virtual
spring-damper system as the visco-elasticity model of a muscle. The neural sys-
tem model consists of a CPG (central pattern generator) and reﬂexes. A CPG
receives sensory input and changes the period of its own active phase. CPGs, the
motion of the virtual spring-damper system of each leg and the rolling motion of
the body are mutually entrained through the rolling motion feedback to CPGs,
and can generate adaptive walking. We report our experimental results of dynamic
walking on terrains of medium degrees of irregularity in order to verify the eﬀec-
tiveness of the designed neuro-mechanical system. The motion adaptation can be
integrated based on the dynamics of the coupled system constructed by the me-
chanical system and the neural system. MPEG footage of these experiments can be
seen at: http://www.kimura.is.uec.ac.jp.
1
Introduction
Many previous studies of legged robots have been performed, including stud-
ies on running and dynamic walking on irregular terrain. However, studies
of autonomous dynamic adaptation allowing a robot to cope with an inﬁnite
variety of terrain irregularities have been started only recently and by only
a few research groups. One example is the recent achievement of high-speed
mobility of a hexapod over irregular terrain, with appropriate mechanical
compliance of the legs[1,2]. The purpose of this study is to realize high-speed
mobility on irregular terrain using a mammal-like quadruped robot, the dy-
namic walking of which is less stable than that of hexapod robots, by referring
to the marvelous abilities of animals to autonomously adapt to their environ-
ment.
As many biological studies of motion control progressed, it has become
generally accepted that animals’ walking is mainly generated at the spinal
cord by a combination of a CPG (central pattern generator) and reﬂexes re-
ceiving adjustment signals from a cerebrum, cerebellum and brain stem[3,4].
A great deal of the previous research on this attempted to generate walk-
ing using a neural system model, including studies on dynamic walking in
simulation[5–8], and real robots[9–13]. But autonomously adaptable dynamic

218
Hiroshi Kimura, Yasuhiro Fukuoka
Table 1. Biological concepts of legged locomotion control.
Limit Cycle based
ZMP based
by Neural System
by Mechanism
(CPG and reﬂexes)
(spring and damper)
good for
posture and low medium speed walking high speed running
control of
speed walking
main
upper neural sys-
lower neural system
musculoskeltal sys-
controller tem acquired by
(at spinal cord, brain
tem through self
learning
stem, etc.)
stabilization
walking on irregular terrain was rarely realized in those earlier studies. This
paper reports on our progress in the past couple of years using a newly de-
veloped quadruped called “Tekken,” which contains a mechanism designed
for 3D space walking (pitch, roll and yaw planes) on irregular terrain[14].
2
Adaptive dynamic walking based on biological
concepts
Methods for legged locomotion control are classiﬁed into ZMP-based control
and limit-cycle-based control (Table.1). ZMP (zero moment point) is the
extension of the center of gravity considering inertia force and so on. It was
shown that ZMP-based control is eﬀective for controlling posture and low-
speed walking of a biped and a quadruped. However, ZMP-based control is
not good for medium or high-speed walking from the standpoint of energy
consumption, since a body with a large mass needs to be accelerated and
decelerated by actuators in every step cycle.
In contrast, motion generated by the limit-cycle-based control has supe-
rior energy eﬃciency. But there exists the upper bound of the period of the
walking cycle, in which stable dynamic walking can be realized[15]. It should
be noted that control by a neural system consisting of CPGs and reﬂexes is
dominant for various kinds of adjustments in medium-speed walking of ani-
mals[3]. Full et al.[16] also pointed out that, in high-speed running, kinetic
energy is dominant, and self-stabilization by a mechanism with a spring and
a damper is more important than adjustments by the neural system. Our
study is aimed at medium-speed walking controlled by CPGs and reﬂexes
(Table.1).
2.1
The quadruped “Tekken”
We designed Tekken to solve the mechanical problems which occurred in our
past study using a planar quadruped “Patrush”[13]. The length of the body
and a leg in standing are 23 and 20 [cm]. The weight of the whole robot is
3.1 [Kg]. Each leg has a hip pitch joint, a hip yaw joint, a knee pitch joint,

Dynamics-Based Motion Adaptation for a Quadruped Robot
219
and an ankle pitch joint. The hip pitch joint, knee pitch joint and hip yaw
joint are activated by DC motors of 20, 20 and 5 [W] through gear ratio of
15.6, 18.8 and 84, respectively. The ankle joint can be passively rotated in
the direction if the toe contacts with an obstacle in a swing phase, and is
locked while the leg is in a stance phase.
Two rate gyro sensors and two inclinometers for pitch and roll axes are
mounted on the body in order to measure the body pitch and roll angles.
The direction in which Tekken moves while walking can be changed by using
the hip yaw joints.
2.2
Virtual spring-damper system
Full et al.[16,17] pointed out the importance of the mechanical visco-elasticity
of muscles and tendons independent of sensory input under the concepts of
“SLIP(Spring Loaded Inverted Pendulum)” and the “preﬂex”. Those biolog-
ical concepts were applied for the development of hexapods with high-speed
mobility over irregular terrain[1,2]. Although we are referring to the concept
of SLIP, we employ the model of the muscle stiﬀness, which is generated by
the stretch reﬂex and variable according to the stance/swing phases, aiming
at medium-speed walking on irregular terrain adjusted by the neural system
All joints of Tekken are PD controlled to move to their desired angles
in each of three states (A, B, C) in Fig.1 in order to generate each motion
such as swinging up (A), swinging forward (B) and pulling down/back of a
supporting leg (C). The constant desired angles and constant P-gain of each
joint in each state were determined through experiments.
Since Tekken has high backdrivability with small gear ratio in each joint,
PD-controller can construct the virtual spring-damper system with relatively
low stiﬀness coupled with the mechanical system. Such compliant joints of
legs can improve the passive adaptability on irregular terrain.
2.3
Rhythmic motion by CPG
Although actual neurons as a CPG in higher animals have not yet become
well known, features of a CPG have been actively studied in biology, physiol-
ogy, and so on. Several mathematical models were also proposed, and it was
pointed out that a CPG has the capability to generate and modulate walking
patterns and to be mutually entrained with a rhythmic joint motion[3–6].
As a model of a CPG, we used a neural oscillator: N.O. proposed by
Matsuoka[18], and applied to the biped simulation by Taga[5,6]. In Fig.4, the
output of a CPG is a phase signal: yi. The positive or negative value of yi
corresponds to activity of a ﬂexor or extensor neuron, respectively. We use
the hip joint angle feedback as a basic sensory input to a CPG called a “tonic
stretch response” in all experiments of this study[14]. This negative feedback
makes a CPG be entrained with a rhythmic hip joint motion.

220
Hiroshi Kimura, Yasuhiro Fukuoka
A
yi < 0
yi > 0
desired
 state
present
state
virtual spring-
damper system
swing phase
stance phase
B
C
Fig. 1. tate transition in the virtual spring-damper system, where yi is the output
phase signal of a CPG.
By connecting the CPG of each leg (Fig.4), CPGs are mutually entrained
and oscillate in the same period and with a ﬁxed phase diﬀerence. This mutual
entrainment between the CPGs of the legs results in a gait. We newly propose
an asymmetric CPG network shown in Fig.4 in order to generate an arbitrary
gait from a trot to a pace via a walk with a single network conﬁguration of
CPGs. In Fig.4, a CPG of a foreleg is inhibited by a CPG of a hindleg with
a connecting weight, and a CPG of a hindleg is not inhibited by a CPG of a
foreleg.
2.4
Necessary conditions for stable dynamic walking on irregular
terrain
We propose the necessary conditions for stable dynamic walking on irregular
terrain, which can be itemized in physical terms:
(a) the swinging legs should be free to move forward during the ﬁrst period
of the swing phase,
(b) the swinging legs should land reliably on the ground during the second
period of the swing phase,
(c) the angular velocity of the supporting legs relative to the ground should
be kept constant during their pitching motion around the contact points
at the moment of landing or leaving,
(d) the phase diﬀerence between rolling motion of the body and pitching
motion of legs should be maintained regardless of a disturbance from
irregular terrain, and
(e) the phase diﬀerences between the legs should be maintained regardless
of delay in the pitching motion of a leg receiving a disturbance from
irregular terrain.

Dynamics-Based Motion Adaptation for a Quadruped Robot
221
2.5
Reﬂexes and responses
It is well known in physiology that
• some sensory stimuli modify CPG activity and reﬂexive responses to sen-
sory stimuli are phase dependent under CPG activity[4].
Such interaction between CPG activity and a sensory stimulus is very impor-
tant for adaptation and corresponds to the necessary conditions described in
physical terms in Section 2.4.. In this paper, we deﬁne a “reﬂex” as joint
torque generation based on sensor information and a “response” as CPG
phase modulation through sensory feedback to a CPG.
The ﬂexor and extensor reﬂexes contribute to satisfy the conditions (a)
and (b), respectively. The ﬂexor reﬂex is implemented as the passive anke
joint mechanism in Tekken. The extensor reﬂex has not yet been implemented
in Tekken.
In addition, the following biological concepts are known[19]:
• when the vestibule in a head detects an inclination in pitch or roll plane, a
downward-inclined leg is extended while an upward-inclined leg is ﬂexed.
We call the reﬂex/response for an inclination in the pitch plane a “vestibu-
lospinal reﬂex/response”, the role of which corresponds to the condition (c)
and (e). In Tekken, hip joint torque in the stance phase is adjusted by the
vestibulospinal reﬂex, since the body pitch angle is added to pitch hip joint
angle. For the vestibulospinal response, the body pitch angle is feedbacked
to the CPGs.
On the other hand, we call the response for an inclination in the roll plane
a “tonic labyrinthine response for rolling”, the role of which corresponds to
the condition (b) and (d). The tonic labyrinthine response is employed as
rolling motion feedback to CPGs in Section 3..
The necessary condition (e) can be satisﬁed by the mutual entrainments
between CPGs and the pitching motion of legs and the mutual entrainments
among CPGs[13].
3
Entrainment between pitching and rolling motions
3.1
Rolling motion feedback to CPGs
Since a dynamic system similar to an inverted pendulum appears in the two-
legged stance phase, a rolling motion is naturally generated in most of the
gaits as a result. The amplitude of the rolling motion generated in walking on
ﬂat terrain is determined mainly by the gait, duty factor, and the period of
the pitching motion cycle. As described as the condition (d) in Section 2.4.,
the change of the phase diﬀerence between rolling motion of the body and
pitching motion of legs disturbs stable walking.

222
Hiroshi Kimura, Yasuhiro Fukuoka
Therefore, we made the body angle around the roll axis be input to the
CPGs as a feedback signal in order to synchronize rolling motion and pitching
motion (upper left part of Fig.4)[14]. In Fig.2, CPGs, the pitching motion of
the legs and the rolling motion of the body are mutually entrained through
the rolling motion feedback to CPGs. This means that the rolling motion
can be the standard oscillation for whole oscillations, in order to compensate
for the weak connection between the fore and hind legs in the CPG network
(Fig.4). As a result, the phase diﬀerence between the fore and hind legs is
ﬁxed, and the gait becomes stable.
Excitatory Connection
Inhibitory  Connection
Rolling
Motion
of a Body
Pitching
Motion
of a Leg
angle
phase
(supporting
 / swinging)
phase
Fig. 2. Relationship among the CPGs, the pitching motion of a leg, and the rolling
motion of the body in walking with rolling motion feedback to CPGs.
3.2
Tonic labyrinthine response for rolling
When a leg lands on a bump while walking on irregular terrain, the distur-
bance of the rolling motion to the pitching motion becomes larger. Therefore,
the periods of the current phases of the CPGs in the pitching motion should
be adjusted according to the rolling motion, in order to satisfy the condition
(b) and (d) described in Section 2.4..
The rolling motion feedback to CPGs contributes to an appropriate ad-
justment of the periods of the stance and swing phases while walking on
irregular terrain (Fig.3), as a tonic labyrinthine response for rolling (TLRR)
described in Section 2.5.. In Fig.3, the right foreleg lands on a bump in a
trot gait, and the body is inclined in a roll plane. Extending the stance phase
of the left hindleg (E+), and shortening the stance phase of the right foreleg
(E-) and the swing phase of the left foreleg (F-), prevent the body from the

Dynamics-Based Motion Adaptation for a Quadruped Robot
223
excess inclination in a roll plane and help the condition (d) be satisﬁed. Ex-
tending the swing phase of the right hindleg (F+) enables the reliable landing
of the leg on the ground and helps the condition (b) be satisﬁed..
F -
E +
E -
F +
Left
hindleg
Right
foreleg
body roll angle
Right
foreleg
Left
foreleg
Right
hindleg
Left
hindleg
E -
F +
E -
F +
E +
F -
E +
F -
front view
left side view
Fig. 3. A tonic labyrinthine response for rolling. E or F means the extensor or
ﬂexor neuron of a CPG, respectively. ’+’ or ’-’ means the activity of the neuron is
increased or decreased by rolling motion feedback to CPGs, respectively.
3.3
Walking on ﬂat terrain
The desired angle of the hip joint in the stance phase: θstance, the time
constant of N.O.: τ are variables to change the indexes of walking such as the
walking speed and the cyclic period of walking, respectively. For examples,
when we shorten the cyclic period of walking by decreasing τ, the stride
becomes short since the period of the state (B) in Fig.1 becomes short. As a
result, the walking speed is kept almost constant. However, we cannot change
the single index independent of other indexes in general, since those variables
inﬂuence each other and walking is generated through interaction with ﬂoor.
Values of all parameters in the neural system including the virtual spring-
damper system except for θstance and τ were determined experimentally. But
it should be noted that those values were constant in the following experi-
ments independent of terrain.
4
Adaptive walking on irregular terrain
4.1
Experiments on terrain of medium degree of irregularity
Since the phase diﬀerence between rolling motion of the body and pitching
motion of legs is largely changed in walking on irregular terrain, a tonic
labyrinthine response for rolling (TLRR) is essential.

224
Hiroshi Kimura, Yasuhiro Fukuoka
-
θ swing
+
vestibule
-
interneurons
spinal cord
α
yi
θ vsr
CPG
LF
body
roll angle
body
pitch angle
extensor motor neuron
flexor motor neuron
α
θ
stance
+
LH
RF
RH
ktlrr
LF:left foreleg
LH:left hindleg
RF:right foreleg
RH:right hindleg
θ
-
yi > 0
yi < 0
φ
θ vsr
θ vsr
tonic labyrinthine
response for rolling
tonic stretch
     response
ψ
vestibulospinal
reflex/response
Fig. 4. Control diagram for Tekken.
(a)
(b)
(c)
(d)
Fig. 5. Walking over irregular ter-
rain.
We made Tekken walk on several irregular terrains with the ﬁxed values of
parameters. Tekken walked over an obstacle 4 [cm] in height while stumbling
and landing on the obstacle (Fig.5-(a)). Tekken walked up and down a slope of
10 [deg] in the forward direction (Fig.5-(b)), and walked over slopes of 3 and
5 [deg] in a side ways direction (Fig.5-(c)) with an appropriate adjustment
of periods of the stance and swing phases. Tekken also walked over terrains
consisting of several boards 1.5 [cm] in height, and series of obstacles (Fig.5-
(d)) with speed 0.7 [m/s]. Without a TLRR, the gait was greatly disturbed,
even if Tekken didn’t fall down.
Consequently, it was shown that method proposed in this study gives
Tekken autonomous adaptation ability, since walking over unknown terrain
of medium degree of irregularity was realized with ﬁxed values of parameters.
4.2
Trade-oﬀof stability and energy consumption
We have to solve the trade-oﬀproblem between the stability and the en-
ergy consumption[14] in order to determine the value of the time constant of

Dynamics-Based Motion Adaptation for a Quadruped Robot
225
N.O.: τ. In this study, we employ the following Eq.(1) in order to change τ
according to the wide stability margin (WSM)1 measured using joint angle
sensors. Eq.(1) means that we choose the large value of τ while WSM is high
in order to decrease the energy consumption, and choose the small value of
τ while WSM is low in order to increase WSM.
τ = 0.12(wide stability margin)/w
(1)
where WSM is normalized by the body width of Tekken (w = 120 [mm]).
As a result of experiments[14], it was shown that stable walking on irreg-
ular terrain with the lower energy consumption was obtained using Eq.(1).
4.3
Visual adaptation
By detecting the height and the distance to obstacles using vision, the robot
can adjust the time constant of N.O.: τ for increasing the stability on terrain
of high irregularity while keeping energy consumption low on terrain of low
irregularity. In addition, the robot can change the leg length in the swinging
phase based on vision in order to prevent the leg from stumbling on obstacles.
As a result, Tekken can walk over an obstacle 5.5 [cm] in height (28% of the
leg length) with vision.
5
Conclusion
In the neural system model proposed in this study, the relationships among
CPGs, sensory input, reﬂexes and the mechanical system are simply deﬁned.
The physical oscillations such as the motion of the virtual spring-damper
system of each leg and the rolling motion of the body are mutually entrained
with CPGs as the neural oscillations. A CPG receives sensory input and
changes the period of its own active phase as responses. The virtual spring-
damper system also receives sensory input and outputs torque as reﬂexes.
The states in the virtual spring-damper system are switched based on the
phase signal of the CPG. Consequently, the adaptive walking is generated
through the interaction with environment.
The motion adaptation can be integrated based on the dynamics of the
coupled system constructed by the mechanical system and the neural system.
The neural system centering the CPGs can aﬀord autonomous adaptation at
the several levels from the lower virtual spring-damper system to the higher
vision system.
1 The WSM is deﬁned as the shortest distance from the projected point of the
center of gravity to the edges of the polygon constructed by the projected points
of legs independent of their stance or swing phases.

226
Hiroshi Kimura, Yasuhiro Fukuoka
References
1. Saranli, U., Buehler, M., and Koditschek, D. E. 2001. RHex: a simple and highly
mobile hexapod robot. Int. J. Robotics Research 20(7):616–631.
2. Cham, J. G., Bailey, S. A., Clark J. E., Full, R. J., Cutkosky, M. R. 2002. Fast
and Robust: Hexapedal Robots via Shape Deposition Manufacturing. Int. J.
Robotics Research 21(10-11):869–882.
3. Grillner, S. 1981. Control of locomotion in bipeds, tetrapods and ﬁsh. Handbook
of Physiology II American Physiol. Society, Bethesda, MD. 1179–1236.
4. Cohen, A. H., and Boothe, D. L. 1999. Sensorimotor interactions during locomo-
tion: principles derived from biological systems. Autonomous Robots 7(3):239–
245.
5. Taga, G., Yamaguchi, Y., and Shimizu, H. 1991. Self-organized control of bipedal
locomotion by neural oscillators. Biolog. Cybern. 65:147–159.
6. Taga, G. 1995. A model of the neuro-musculo-skeletal system for human loco-
motion II. - real-time adaptability under various constraints. Biolog. Cybern.
73:113–121.
7. Miyakoshi, S., Taga, G., Kuniyoshi, Y., and Nagakubo, A. 1998. Three dimen-
sional bipedal stepping motion using neural oscillators - towards humanoid mo-
tion in the real world. Proc. of IRSO1998, pp. 84–89.
8. Ijspeert, A.J. 2001. A connectionist central pattern generator for the aquatic
and terrestrial gaits of a simulated salamander. Biolog. Cybern. 84(5):331–348.
9. Kimura, H., Akiyama, S., and Sakurama, K. 1999. Realization of dynamic walk-
ing and running of the quadruped using neural oscillator. Autonomous Robots
7(3):247–258.
10. Ilg, W., Albiez, J., Jedele, H., Berns, K., and Dillmann, R. 1999. Adaptive
periodic movement control for the four legged walking machine BISAM. Proc.
of ICRA1999, pp. 2354–2359.
11. Lewis, M. A., Etienne-Cummings, Hartmann, M. J., Xu, Z. R., and Cohen,
A. H. 2003. An in silico central pattern generator: silicon oscillator, coupling,
entrainment, and physical computation. Biolog. Cybern. 88:137–151.
12. Tsujita, K., Tsuchiya, K., and Onat, A. 2001. Adaptive Gait Pattern Control
of a QuadrupedLocomotion Robot, Proc. of IROS2001, pp. 2318–2325.
13. Kimura, H., Fukuoka, Y., and Konaga, K. 2001. Adaptive dynamic walking of a
quadruped robot using neural system model. Advanced Robotics 15(8):859–876.
14. Fukuoka, Y., Kimura, H., Cohen, A.H. 2003. Adaptive Dynamic Walking of
a Quadruped Robot on Irregular Terrain based on Biological Concepts. Int. J.
Robotics Research, 22(3-4):187–202.
15. Kimura, H., Shimoyama, I., and Miura, H. 1990. Dynamics in the dynamic
walk of a quadruped robot. Advanced Robotics 4(3):283–301.
16. Full, R. J., and Koditschek, D. E. 1999. Templates and anchors: neuromechan-
ical hypotheses of legged locomotion on land. J. Exp. Biol. 202:3325–3332.
17. Full, R. J. 2000. Biological inspiration: lessons from many-legged locomotors.
Robotics Research 9, J.M.Hollerbach and D.E.Koditschek Eds, Springer London.
pp. 337–341.
18. Matsuoka, K. 1987. Mechanisms of frequency and pattern control in the neural
rhythm generators. Biolog. Cybern. 56:345-353.
19. Nanzando’s Medical Dictionary 18th Ed. 1998. Nanzando, Tokyo. 1211. (in
Japanese)

A Turning Strategy of a Multi-legged
Locomotion Robot
Kazuo Tsuchiya, Shinya Aoi and Katsuyoshi Tsujita
Dept. of Aeronautics and Astronautics, Graduate School of Engineering, Kyoto
University, Yoshida-honmachi, Sakyo-ku, Kyoto 606-8501, Japan
Abstract. In this paper, we analyze the walking stability of a multi-legged loco-
motion robot. Based on dynamic characteristics, we propose a strategy for turning
whose eﬀectiveness is veriﬁed by numerical simulations. The robot can turn more
eﬃciently with fewer slips after decreasing walking stability. That is, the maneu-
verability of the robot increases by changing the dynamic properties of the robot.
1
Introduction
The locomotion of a robot with many legs has the advantage of stability, since
it is supported by many legs. However, this design lacks maneuverability since
the robot is constrained to the ground by many legs. An established method
of controlling a robot consists of motion planning and motion control. Motion
planning computes the movement of the joints to realize a given motion, and
motion control manipulates the joints to achieve a designed motion. This
method is not eﬃcient, and solutions cannot adapt to changes in environment.
From a practical viewpoint, it is important to improve the maneuverability
of multi-legged locomotion robots.
In ethology, research on arthropod locomotion has advanced. Arthropod
locomotion is very stable and can maneuver on rough terrain, climb over ob-
stacles, and turn quickly. Research is trying to elucidate how the arthropod
produces stable locomotion and maneuverability. Dean et al. [2] and Schmitz
et al. [8] examined the locomotion of the stick insect, Carausius morosus, and
proposed a control system for a hexapod robot that achieves straight and
curve walking and straight walking over obstacles by numerical simulations.
Watson et al. [9], [10] studied the kinematics and neural legged locomotion
control of the obstacle climbing of the cockroach, Blaberus discoidalis. Based
on the results, Quinn et al. [5] developed locomotion controllers for hexapod
robots. Jindrich and Full [3] and Kubow and Full [4] investigated the dynamic
properties of the turning motions of the cockroach. Schmitt and Holmes [6],
[7] analyzed the dynamics of turning behavior based on a simpliﬁed mathe-
matical model, which revealed that the cockroach decreases walking stability
by moving the points on its body where the intermittent forces from the
ground act, enabling it to turn quickly.
This paper deals with the turning motion of a multi-legged locomotion
robot. First, we analyze the walking stability of the robot. The analysis re-
veals that by changing control parameters, walking stability decreases, and

228
K. Tsuchiya, S. Aoi, K. Tsujita
Joint 2
Link 1
Link 2
Module 1
Module 2
Module 6
Leg 1
Leg 2
Joint 1
Coupler 1
Coupler 5
Fig. 1. Schematic 3-D model of the multi-legged locomotion robot
beyond a critical point, a meandering motion appears. Based on dynamic
properties, we propose a control strategy for the robot that realizes an eﬃ-
cient turning motion by decreasing walking stability; in other words, increas-
ing the maneuverability of the robot by changing its dynamic characteristics.
2
Model
2.1
3-D dynamics model
We considered the multi-legged locomotion robot shown in Fig. 1. It has six
modules, each with one body and two legs. Each leg consists of two links
that are connected to each other through a one degree of freedom (DOF)
rotational joint. They are connected to the body by a one DOF rotational
joint. Each module is connected to each other through a coupler composed
of roll, pitch, and yaw joints. The modules are enumerated from Module 1 to
Module 6, and the coupler between Module i and Module (i+1) is numbered
as Coupler i (i = 1, · · · , 5). The left and right legs are numbered as Legs 1
and 2, respectively. The joints and the links of each leg are numbered from
the side of the body as Joints 1 and 2 and Links 1 and 2. The coordinate axes
{ai} = {ai1, ai2, ai3} (i = 0, · · · , 6) are ﬁxed on the ground (i = 0) or on the
body of Module i (i = 1, · · · , 6), where axis ai1 is toward the nominal direction
of locomotion and axis ai3 is toward the vertical direction. The position vector
of the body of Module 1 is given by vector r0 expressed as r0 = [ r01, r02, r03 ]
in {a0}. The posture of the body of Module 1 is expressed as Euler angles
θ0 = [ θ01, θ02, θ03 ], where θ01, θ02, and θ03 are the rotation angles around
axes a01, a02, and a03, respectively. Similarly, we deﬁne θim(i = 1, · · · , 5,
m = 1, 2, 3) as the components of Euler angles from {ai} to {ai+1}, and
θ(j)
ik (i = 1, · · · , 6, j = 1, 2, k = 1, 2) as the relative angle of Joint k of Leg j
of Module i.

A Turning Strategy of a Multi-legged Locomotion Robot
229
The state variable is deﬁned as qT = [ r0m, θi−1m, θ(j)
ik ](i = 1, · · · , 6, j =
1, 2, k = 1, 2, m = 1, 2, 3). An equation of motion for state variable q is
derived using Lagrangian formulation by
M ¨q + H(q, ˙q) = G +

i,j
τij +

i,j,k
τ (j)
ik + Λ
(1)
where M is the inertia matrix, H(q, ˙q) is the nonlinear term that includes
Coriolis and centrifugal forces, G is the gravity term, τij(i = 1, · · · , 5, j =
1, 2, 3) and τ (j)
ik (i = 1, · · · , 6, j = 1, 2, k = 1, 2) are the input torques of the
actuators at the joints (j = 1 : roll, j = 2 : pitch, j = 3 : yaw) of Coupler i
and Joint k of Leg j of Module i, and Λ is the reaction force from the ground.
The reaction force is modeled using a spring and damper model.
2.2
Clock-driven leg controller
Here, we explain a locomotion control system. The robot has a simple clock-
driven, open-loop gait. All the joints have motors and are controlled by a
proportional-derivative (PD) controller. The leg joints are controlled by in-
corporation of the periodic desired angles, while the joints of the couplers are
passively controlled without incorporating the desired angles. To design the
desired angles of the leg joints, ﬁrst we introduce Oscillator i, j(i = 1, · · · , 6,
j = 1, 2) for Leg j of Module i. Oscillator i, j has phase φ(j)
i
whose angular ve-
locity is constant. Second, we design the nominal trajectory ˆη(j)
i (i = 1, · · · , 6,
j = 1, 2) of the tip of Leg j of Module i in the sagittal plane of {ai} as a
function of phase φ(j)
i , that is, ˆη(j)
i
= ˆη(j)
i (φ(j)
i ). Trajectory ˆη(j)
i
consists of
the trajectories of swinging stage ˆη(j)
iSw and supporting stage ˆη(j)
iSp(i = 1, · · · , 6,
j = 1, 2), which are also the functions of phase φ(j)
i
and change at the anterior
extreme position (AEP) and the posterior extreme position (PEP) as shown
in Fig. 2.
ˆη(j)
i (φ(j)
i ) =

ˆη(j)
iSw(φ(j)
i )
0 ≤φ(j)
i
< φA
ˆη(j)
iSp(φ(j)
i )
φA ≤φ(j)
i
< 2π
i = 1, · · · , 6, j = 1, 2
(2)
where φA = 2π(1−β) that indicates the phase value at AEP, and β is a duty
ratio that indicates the ratio between the time interval for the supporting
stage and the period of one step of locomotion. Finally, from inverse kine-
matics, we obtained the desired angle ˆθ(j)
ik (i = 1, · · · , 6, j = 1, 2, k = 1, 2) of
Joint k of Leg j of Module i as the function of phase φ(j)
i .
3
Stability analysis of walking
In this section, we simpliﬁed the actual 3-D model of the multi-legged loco-
motion robot to a 2-D model and then analyze the walking stability based on

230
K. Tsuchiya, S. Aoi, K. Tsujita
ˆ”(j)
i
AEP
PEP
Joint 1
Joint 2
ˆ”(j)
iSw
ˆ”(j)
iSp
Fig. 2. Nominal trajectory of the leg
r01
r02
θ03
θ13
θ23
F
F
F
F
F
F
Module 1
Module 2
Module 3
Fig. 3. Simpliﬁed 2-D model of the multi-legged locomotion robot
the simpliﬁed 2-D model. Next, we veriﬁed that walking changes naturally
into meandering by comparing the analysis results based on the 2-D model
with the numerical simulation results of the actual 3-D model.
3.1
Simpliﬁed 2-D dynamics model
We assumed that many of the robot legs always touch the ground when it
walks, and so the vertical motion of the robot can be ignored. Next, using the
numerical simulations of the actual 3-D model, we found that the periodic
meandering motion is longer than the period of the cyclic motion of the legs.
We assumed that intermittent forces from the ground can be modeled as
constant forces. We also assumed that the locomotion speed of the robot is
constant.
Based on these assumptions, the 3-D model shown in Fig. 1 is simpliﬁed
to the 2-D model shown in Fig. 3. This simpliﬁed 2-D model consists of
rigid bodies that are connected to each other through a one DOF rotational
joint and constrained on a plane. As propulsive forces, the constant follower
forces, F, parallel to each module act on both sides of each module. As
friction forces, the forces tangential to each module whose magnitudes are
proportional to the velocities of these directions act on both sides of each
module. In light of the assumptions, we contracted the state variables by
¯qT = [ r02, θ03, · · · , θ53 ]. Note that state variable r01 is also contracted since
it is outside of our interest, and its equation can be separated from the other
equations. By putting ξT = [ ˙¯qT, ¯qT ], (1) is written simply as
˙ξ = f(ξ)
(3)

A Turning Strategy of a Multi-legged Locomotion Robot
231
-4
-3
-2
-1
0
1
2
3
4
-60
-50
-40
-30
-20
-10
0
10
-3
-2
-1
0
1
2
3
-4
-3
-2
-1
0
1
(a) Trajectories of all the eigenvalues
(b) Enlarged detail
Fig. 4. Trajectories of the eigenvalues of the linearized equation while chaning the
compliances of the yaw joints of the couplers
3.2
Stability analysis
We deﬁne ξ0(= [ 0, · · · , 0 ]T) as the equilibrium solution of (3) and δξ as a
perturbation from the equilibrium solution and then deﬁne ξ = ξ0 + δξ. By
substituting ξ into (3), we obtain a linearized equation by
˙δξ = Dξf(ξ0)δξ
(4)
where Dξ ≡
∂
∂ξ. From (4), we investigated the walking stability, while the
compliances of the yaw joints of the couplers are increased. To increase the
compliances, the corresponding PD feedback gains Ki3 and Di3(i = 1, · · · , 5)
are decreased by using parameter f as follows:
!
Ki3 = K0(2πf)2
Di3 = 2K0ζ(2πf)
i = 1, · · · , 5
(5)
where ζ and K0 are set as 0.8 and 0.01, respectively. The physical parameters
of the 2-D model are given as follows: The mass of each module is 0.8 [kg],
F = 3.32 [N], and ˙r01 = 0.167 [m/s]. Figures 4a and b show the trajectories of
the eigenvalues of the linearized equation (4). These ﬁgures show that when
parameter f decreases and reaches a critical point, a pair of eigenvalues cross
the imaginary axis and become unstable. That is, Hopf bifurcation occurs.
Note that this system has two zero eigenvalues and that in Fig. 4a the points
enclosed by circles correspond to the eigenvalues when bifurcation occurs.
From these results, it is revealed that when the compliances are small, walking
is stable, but when the compliances increase beyond a bifurcation point,
walking becomes unstable through Hopf bifurcation.
3.3
Numerical simulation
Here, we validated that walking actually becomes unstable through Hopf bi-
furcation when the compliances of the yaw joints of the couplers are increased

232
K. Tsuchiya, S. Aoi, K. Tsujita
-2
-1.5
-1
-0.5
0
0.5
1
1.5
2
0
2
4
6
8
10
12
14
16
18
20
22
θ33[rad]
1 / f2
Fig. 5. Plot of the yaw angle θ33 of Coupler 3 at φ(1)
6
=0 versus parameter 1/f 2
Fig. 6. Meandering motion obtained by 3-D numerical simulation
beyond a critical point, based on the numerical simulation of the 3-D model.
Second, we veriﬁed that the stability analysis based on the 2-D model is valid
by comparing the results of numerical simulation and stability analysis. The
physical parameters of the 3-D model are given as follows: The mass of each
body is 0.6 [kg], the mass of Links 1 and 2 of each leg are 0.05 [kg], the length
of Links 1 and 2 of each leg are 0.05 [m], the period of each leg motion is
0.5 [s], the stride of each leg is 0.05 [m], and β = 0.6. The nominal gait pattern
of the robot is set so that Legs 1 and 2 of each module and the unilateral legs
on adjacent modules move out of phase with each other. That is, the phases
of the oscillators have relationships such that φ(1)
i
−φ(2)
i
= π(i = 1, · · · , 6)
and φ(j)
i
−φ(j)
i+1 = π(i = 1, · · · , 5, j = 1, 2).
First, we carried out numerical simulations of the 3-D model, while the
compliances of the yaw joints of the couplers are increased by using a pa-
rameter f that is similar to (5). Fig. 5 shows the plot of the yaw angle θ33
of Coupler 3 on the Poincar´e sections with respect to parameter 1/f 2 that
corresponds to the compliances. In this paper, the Poincar´e section is as-
sumed to be φ(1)
6
= 0. Since φ(j)
i
is 2π-periodic, the sampling interval is equal
to the period of the leg motion. This ﬁgure indicates that there is a critical
point beyond which the robot begins to meander (Fig. 6). Thus, it is veriﬁed
that walking becomes unstable through Hopf bifurcation and then smoothly
becomes meandering. But note that the vertical line of each Poincar´e section
with respect to parameter 1/f 2 is ﬁlled, since the motion of the legs and

A Turning Strategy of a Multi-legged Locomotion Robot
233
Numerical simulation
Stability analysis
0
0.05
0.1
0.15
0.2
0.25
0.3
6
8
10
12
14
16
18
20
22
24
Ratio of Amplitudes
1 / f2
θ03
θ13
θ23
θ33
θ43
θ53
0
0.05
0.1
0.15
0.2
0.25
0.3
6
6.5
7
7.5
8
8.5
Ratio of Amplitudes
1 / f2
θ03
θ13
θ23
θ33
θ43
θ53
(a) Ratios of the amplitudes of the state variables versus parameter 1/f 2
0
0.5
1
1.5
2
2.5
3
6
8
10
12
14
16
18
20
22
24
Phase Difference with θ53 [×π rad]
1 / f2
r02
θ03
θ13
θ23
θ33
θ43
θ53
0
0.5
1
1.5
2
2.5
3
6
6.5
7
7.5
8
8.5
Phase Difference with θ53 [×π rad]
1 / f2
r02
θ03
θ13
θ23
θ33
θ43
θ53
(b) Phase diﬀerences of the state variables with yaw angle θ53 of Coupler 5
versus parameter 1/f 2
Fig. 7. Comparison between numerical simulation and stability analysis
the meandering motion are not synchronized. As expected from the analy-
sis of the 2-D model, this bifurcation does not depend on the gait pattern.
For example, a similar bifurcation exists, even if Legs 1 and 2 of each mod-
ule move in phase and the legs on adjacent modules move out of phase (i.e.
φ(1)
i
= φ(2)
i (i = 1, · · · , 6), φ(j)
i
−φ(j)
i+1 = π(i = 1, · · · , 5, j = 1, 2)). Further-
more, the simulation results veriﬁed that the meandering period is about 14
times longer than the period of the leg movements.
Next, to verify the validity of the stability analysis based on the 2-D
model, we compared the unstable eigenvectors obtained by stability analysis
with the state variables of the meandering motion obtained by numerical sim-
ulations. In Figures 7a and b, we compared the ratios of the amplitudes and
the phase diﬀerences with yaw angle θ53 of Coupler 5 of the state variables
with respect to parameter 1/f 2 between numerical simulation and stability
analysis. From these ﬁgures, we found that the results of the numerical sim-
ulations and the stability analyses resemble each other, especially near the
bifurcation point which is indicated by arrows. These results veriﬁed that the
stability analysis based on the 2-D model is valid.

234
K. Tsuchiya, S. Aoi, K. Tsujita
r01
r02
Destination Point
Coupler 1
Module 1
θ13
θ03
ψ
(r∗
01, r∗
02)
Fig. 8. Turning walk control
4
Turning walk control
In this section, based on the dynamic properties of walking analyzed in the
previous section, we propose a turning strategy for the robot.
4.1
Turning strategy
1. When the robot starts to turn, the compliances of the yaw joints of all
the couplers except for Coupler 1 are increased.
2. The input torque at the yaw joint of Coupler 1 is activated by incorporat-
ing the desired angle that directs the ﬁrst module in a turning direction.
To turn the robot, this strategy attempts to direct the ﬁrst module to the
turning direction and then make the other modules follow the ﬁrst module,
since they are passively connected to each other. Note that, now, the robot
can turn with less constraint forces, since it has less walking stability.
4.2
Numerical analysis
Here, we verify the eﬀectiveness of the proposed turning strategy by numerical
simulations. We consider a task in which the robot approaches a destination
point (r∗
01, r∗
02) while walking and turning. We assume that the robot can
get information about the angle ψ between the walking direction and the
direction of the destination point (Fig. 8). Then, input torque τ13 at the yaw
joint of Coupler 1 is given by
τ13 = −K13(θ13 + ψ) −D13 ˙θ13
(6)
Numerical simulations were carried out as followings: First, the robot starts
to walk in the direction of the r01-axis by setting the compliances of the
yaw joints of the couplers low enough; when the ﬁrst module reaches point
(r01, r02)=(0,0)[m], the robot begins to turn almost perpendicularly by set-
ting the destination point as (r∗
01, r∗
02) = (0, 50)[m]. Note that we consider

A Turning Strategy of a Multi-legged Locomotion Robot
235
(a) Turning behavior (f = 1.0)
-0.5
0
0.5
1
1.5
2
2.5
3
3.5
4
0
10
20
30
40
50
60
70
80
90
100
θ03 [rad]
Time [s]
f=0.3
f=1.0
f=3.0
0
0.02
0.04
0.06
0.08
0.1
0.12
0
1
2
3
4
5
6
7
8
9
10
Slide Average [m]
f
(b) Walking direction θ03 of Module 1
(c) Average slippage of each leg
versus time
versus parameter f
Fig. 9. Turning behavior
t = 0 [s] when the robot starts to turn. At that time, we changed the com-
pliances of the yaw joints of the couplers, except for Coupler 1, by changing
parameter f similar to (5), while Coupler 1 is ﬁxed. Fig. 9a shows the turning
behavior for changed parameter f = 1. Fig. 9b shows the proﬁle of the walk-
ing direction θ03 of the ﬁrst module for the three kinds of changed parameter
f. Fig. 9c shows the average slippage of each leg to the ground compared to
changed parameter f. These results suggest that in the region where compli-
ances are very small, the modules cannot follow the ﬁrst module eﬃciently
because the amount of slippage has become too large, and so many modules
are lugged. On the other hand, in the region where compliances are very large,
the modules can follow eﬀectively, but the legs slip and the robot can not
walk eﬃciently due to the appearance of meandering. When the compliances
are set just before the value at which walking becomes unstable, the robot
can walk and turn most eﬃciently.
5
Conclusion
In this paper, we analyzed the dynamic properties of walking of a multi-legged
robot. We found that walking degenerates into meandering through Hopf
bifurcation by changing the compliances of the yaw joints of the couplers.
This transfer of walking pattern is an example of the destabilization due to

236
K. Tsuchiya, S. Aoi, K. Tsujita
the follower forces [1]. Then, based on the dynamic properties of the robot,
we propose a turning strategy. Numerical simulations veriﬁed that the robot
can turn eﬀectively with fewer slips by decreasing the walking stability of the
robot. Note that this means that the maneuverability of the robot is increased
by compliance controls.
References
1. Bolotin, V. V. (1963) Nonconservative Problems of the Theory of Elastic Sta-
bility. Pergamon Press, New York.
2. Dean, J., Kindermann, T., Schmitz, J., Schumm, M., and Cruse, H. (1999) Con-
trol of walking in the stick insect: from behavior and physiology to modeling.
Autonomous Robots 7(3):271–288.
3. Jindrich, D. and Full, R. J. (1999) Many-legged maneuverability: dynamics of
turning in hexapods. J. Exp. Biol. 202:1603–1623.
4. Kubow, T. M. and Full, R. J. (1999) The role of the mechanical system in
control: a hypothesis of self-stabilization in hexapedal runners. Phil. Trans. R.
Soc. Lond. B 354:849–861.
5. Quinn, R. D., Nelson, G. M., Bachmann, R. J., Kingsley, D. A., Oﬃ, J., and
Ritzmann, R. E. (2001) Insect designs for improved robot mobility. Proc. of 4th
Int. Conf. on Climbing and Walking Robots (CLAWAR 2001), pp. 69–76.
6. Schmitt, J. and Holmes, P. (2000) Mechanical models for insect locomotion:
dynamics and stability in the horizontal plane I. Theory. Biol. Cybern. 83:501–
515.
7. Schmitt, J. and Holmes, P. (2000) Mechanical models for insect locomotion:
dynamics and stability in the horizontal plane II. Application. Biol. Cybern.
83:517–527.
8. Schmitz, J., Dean, J., Kindermann, T., Schumm, M., and Cruse, H. (2001) A bi-
ologically inspired controller for hexapod walking: simple solutions by exploiting
physical properties. Biol. Bull. 200:195–200.
9. Watson, J. T., Ritzmann, R. E., Zill, S. N., and Pollack, A. J. (2002) Control of
obstacle climbing in the cockroach, Blaberus discoidalis. I. Kinematics. J. Comp.
Physiol. A 188:39–53.
10. Watson, J. T., Ritzmann, R. E., and Pollack, A. J. (2002) Control of climbing
behavior in the cockroach, Blaberus discoidalis. II. Motor activities associated
with joint movement. J. Comp. Physiol. A 188:55–69.

A Behaviour Network Concept for Controlling
Walking Machines
Jan Albiez1, Tobias Luksch2, Karsten Berns2, and R¨udiger Dillmann1
1 Forschungszentrum Informatik Karlsruhe,
Interactive Diagnosis- and Service Systems,
Haid–und–Neu–Str. 10–14, 76131 Karlsruhe, Germany
2 AG Robtersysteme, Fakult¨at f¨ur Informatik
Universit¨at Kaiserslautern
D-67653 Kaiserslautern, Germany
Abstract. The high complexity of the mechanical system and the diﬃcult task of
walking itself makes the task of designing the control for legged robots a diﬀcult one.
Even if the implementation of parts of the desired functionality, like posture control
or basic swing/stance movement, can be solved by the usage of classical engeneering
approaches, the control of the overall system tends to be very unﬂexible. This paper
introduces a new method to combine apects of classical robot control and behaviour
based control. Inspired by the activation patterns in the brain and the spinal cord
of animals we propose a behaviour network architecture using special signals like
activity or target rating to inﬂuencce and coordinate the behaviours. The general
concept of a single behaviour as well as their interaction within the network is
described. This architecture is tested on the four-legged walking machine BISAM
and experimental results are presented.
1
Introduction
Walking robots have been a ﬁeld of increasing activity in the last years. Espe-
cially the ability to adapt to unstructured terrain and the resulting demands
on the control architecture have been in the focus of researchers. These eﬀorts
can be separated into two diﬀerent approaches, one being the classical engi-
neering approach using and reﬁning the known methods of loop-back control
structures and dynamic modelling to control the robot, e.g. [16]. The other
way is to adopt as much from biological paragons for locomation as possible
regarding both mechanical design and control architecture, e.g. [7] and [22] .
The methods proposed in this paper follow the second approach by applying
a reﬂex or behaviour based control architecture to a four-legged walking ma-
chine, this way performing sensor-based adaptation to motion on irregular
terrain.
Biological research of the last years has identiﬁed several key elements
being used in nature for adapting locomotion. These range from the geomet-
rical structure of legs [34] and dynamic properties of muscles [29] to neural
networks used for walking by insects [11]. The results of this research suggest
a transfer of these principles to legged robots. Due to the high complexity of

238
Jan Albiez et al.
real walking machines and the impracticality of mimicking especially nature’s
activators and sensors, up to now only some of the ideas have been trans-
ferred to the control architectures of real robots. In [21,22] a neuro-oscillator
based pattern generator is introduced. The adaptation to the terrain is solved
by directly inﬂuencing the activation of the oscillator neurons. [6] also uses
neuro-oscillators which are parametrized using the results from the analysis
of lobsters. [17] proposes a reﬂex based gait generation system, triggered by
the input of a camera system mounted on the robot. A distributed control
system for a hexapod using reﬂexes to stabilize the body is presented in [14].
In the last years several methods were successfully applied to control the
four-legged walking machine BISAM [8]. These include the usage of coupled
neuro-oscillators for gait generation [18] and the application of radial basis
function neural networks and reinforcement learning methods for posture
control while trotting [1]. All these methods were successfull but lacked a
certain extensibility when confronted with more demands than they were
initially designed for (e.g. both dynamically stable trott and statically stable
walking). Thus the necessity arrised to build an architecture being able to
handle these demands.
2
Activation, activity, target rating and behaviours
There have been several approaches to use behaviour based control in mobile
robots over the last years. The main area of application have been wheel
driven, kinematically extremly simple robots, with the main focus on the
robot’s task eg. navigation and group behaviour [13,5,27]. Therefore these ar-
chitectures concentrate on the coordination of a set of high level behaviours
operating mostly on the same semantic level and producing abstract com-
mands for the robot’s hardware. Since the coordaintion of behaviours is cru-
cial part in behaviour based robotics a lot of work has been done there.
Examples include comfort zones [25] or case based reasoning [26]; a good
overview on behaviour coordination can be found in [30].
There have only been a few attempts to use behaviour based architec-
tures on the lower levels of the control architecture for kinematically more
complex robots like walking machines. The best known and most successful
is the subsumption architecture [9,15] used on several hexapods. A more bio-
logical inspired approach for a lobster robot is proposed in [7]. But there are
several drawbacks to these architectures, among them a general tendency to-
wards scalability problems, weaknesses when adding new behaviours or trying
reusing existing ones and in most cases a highly problem speciﬁc approach
(see [4]).
When considering the insights gained through PET and EEG scans and
spinal cord activity plots of animals performing certain tasks [20,29], as well as
the problems when dealing with real sensor information and highly complex
robots, the following key aspects can be identiﬁed:

A Behaviour Network Concept for Controlling Walking Machines
239
Fig. 1. (left) Basic behaviour block, (right) Behaviour fusion using activities as
weight
• A certain action of an animal always creates activity in the same area of
the animal’s brain or its spinal cord.
• Such an active area can result in the stimulation of further regions as
well as inhibit activity in others.
• Even though the classical approach to robot control has diﬃculties han-
dling the complexity of the whole system, these established methods
should be applied to solve simpler sub-problems.
• As hierarchical systems have been approved in robotics as well as in
nature it is advisable to use some kind of leveled system with an increasing
degree of abstraction regarding sensor data and motor signals.
Taking these observation into consideration, we designed a control archi-
tecture consisting of a hierarchical network of behaviours. Each behaviour or
reﬂex1 is developed using methods of classical control system design or arti-
ﬁcial intelligence. Only the interaction of the behaviours and their placement
in the network will result in the desired actions of the overall system.
Each such behaviour B as used in this architecture can formally be deﬁned
as
B = (e, u, ι, F, r, a).
This functional unit uses the input vector e and generates the output vector
u. It possesses another dedicated input value ι to activate the behaviour on
a scale between 0 (disabled) and 1 (fully activated). This allows to ensure
the robot’s safety to a certain degree by activating only a deﬁned set of
behaviours and enables the usage of the behaviour as an abstract actor by
other higher level behaviours. The transfer function F can then be deﬁned
as
F : ℜn × [0; 1] →ℜm;
F(e, ι) = u.
1 A reﬂex refers to a simple behaviour close to the hardware thus being more
reactive than deliberative

240
Jan Albiez et al.
sensors
actors
robot
R1
B11
...
...
...
B21
(reflexes)
machine
R2
R3
B22
B23
B12
R4
B12’s
region of
influence
deliberative
more
more
reactive
behaviours
Fig. 2. Behaviour coordination network
Each behaviour generates two further output values, the target rating r
and the activity a. These are set apart from the control output u as they are
not used for control purposes but more treated as kind of sensor information
about the behaviour’s state. The target rating r evaluates the system state
from the restricted view e of the behaviour.
r : ℜn →[0; 1]; r(e) = r
It is constantly calculated even if the behaviour is deactivated and gener-
ates no output. A value of 0 indicates that the robot’s state matches the
behaviour’s goal, a value of 1 that it does not. The activity a reﬂects the
magnitude of the behaviours action:
a : ℜm →[0; 1] : a(u) ∼||u||
Apart from giving crucial visualisable information for the control sys-
tem developer, ι, r and a are responsible for the interaction between the
behaviours within the network. The network itself is a hierachical distribu-
tion of the behaviours according to their functionality. The more reﬂex-like
a behaviour is the lower it is placed inside the network (see ﬁgure 2). Higher
behaviours are using the functionality of lower ones via their ι inputs like
these could be using motor signals to generate robot movement. From this
activation mechanism emerge the regions of inﬂuence R as shown in ﬁgure 2
which are recursively deﬁned as
R(B) =
&
Bi∈Act(B)
{Bi ∪R(Bi)} ,
R(B) = ∅,
if
Act(B) = ∅,
where Act(B) is the set of behaviours being inﬂuenced by B via ι. This
aﬃliation of a behaviour to a region is not exclusive, it only expresses its

A Behaviour Network Concept for Controlling Walking Machines
241
cooperation with other behaviours. The activity of the complete network will
concentrate in the region of one high level behaviour.
The state variables a and r are used to pass information about a behaviour
to others. The target rating r hints on the behaviour’s estimation of the
situation whereas the activity a describes how much it is working on changing
this situation thus inﬂuencing other behaviours decisions and actions.
The activity also acts as a mean for the fusion of the outputs of competing
behaviours (see ﬁgure 1). Either only the output of the behaviour with the
highest activity (winner takes it all) is used or the average of all outputs
weighted by the activities is calculated.
3
The walking machine BISAM
BISAM (Biologically InSpired wAlking Machine), developed ath the FZI,
consists of one main body and four equal legs (ﬁgure 3). The main body is
Fig. 3. The quadrupedal walking machine BISAM. Due to the ﬁve active degrees
of freedom in the body and the ability to rotate the shoulder and hip, BISAM
implements key elements of mammal-like locomotion.
composed of four segments being connected by ﬁve rotary joints. Each leg
consists of four segments connected by three parallel rotary joints and at-
tached to the body by a fourth. The joints are all driven by DC motors and
ball screw gears. The height of the robot is 70 cm, its weight is about 23 kg.
21 joint angle encoders, four three dimensional foot sensors and two incli-
nometers mounted on the central body provide the necessary sensoric input.
A more detailed description of the development and speciﬁcation of BISAM
can be found in [8,19]. Research on BISAM aims at the implementation of
mammal-like movement and diﬀerent gaits like statically stable walking and
dynamic trotting with continuous gait transitions. Due to this target, BISAM
is developed with joints in the shoulder and in the hip, a mammal-like leg-
construction and small foot contact areas. These features have strong impact
on the appliable methods for measuring stability and control. For example,
caused by BISAM’s small feet the ZMP-Criterion [32] is not fully adequate
to describe the aspired movements.

242
Jan Albiez et al.
The control design has to consider the high number of 21 active joints
and especially the ﬁve joints in the body. One common way to reduce the
model complexity is to combine joints and legs by the approach of the virtual
leg, as used in many walking machines [31,23,35]. This approach poses prob-
lems when modelling BISAM’s body joints and lead to a strong reduction
in the ﬂexibility of the walking behaviour [28]. A second way is to reduce
the mechanical complexity of the robot so it is possible to create an exact
mathematical model of the robot [10].
Taking the described problems into consideration BISAM was used as the
ﬁrst plattform to implement the proposed behaviour based architecture ([3,2].
This ﬁrst implementation has been expanded to a complete and consistent
framework, which allows BISAM to automatically switch between standing,
a free gait and a normal walking gait.
4
Implementing a behaviour network
Up to now we have implemented a behaviour network for BISAM which
realises stable standing and a free gait. The sub-network controlling one leg
is shown in ﬁgure 4. Note that the stance behaviour is inhibited by the swing
behaviour via the activity to guarantee that stancing will stop as soon as the
leg is cleared for swinging. The two ”helper” behaviours, preparing a swing
phase and keeping the ground contact, are the most reactive in this group
and as such are placed at the bottom.
Fig. 4. Behaviour network for one leg
The overall network of BISAM is shown in ﬁgure 5. For clarity reasons
the networks of the legs are only shown as blocks, since they operate in-
dependent from each other. Above them reside the posture behaviours as
described in ([3]). The walking behaviours on the highest level only activate
lower behaviours and don’t generate direct control signals at all. The fusion
knots between the walking and the posture behaviours guarantee that only
the output of the active walking behaviour is used. The transition between
standing and diﬀerent gaits is done by the walking behaviours themselves.

A Behaviour Network Concept for Controlling Walking Machines
243
Fig. 5. Behaviour network of the complete robot
To demonstrate the activities and the coordination of the bahaviours a
simple step on even terrain as performed in free gait is described here. In
ﬁgure 6 the swing phase of the leg is represented by its x-coordinate (upper-
most plot) and several involved behaviours are visualized by their activation
ι, activity a and target rating r (top-down). All behaviour plots scale from
0 to 1. Not all behaviours involved in actual walking are described here but
are ignored for reasons of simplicity.
Between two swing cycles the free gait will try to stabilize the robot on
four legs while adapting the posture to the terrain. The force distributing re-
ﬂex (ﬁrst behaviour in ﬁgure 6) represents the posture control being activated
after the swing leg hits the ground (high ι). At once its activity increases, the
posture of the robot is corrected, so the target rating descreases accordingly.
At the beginning of a new swing cycles the leg relieve behaviour is acti-
vated. It tries to remove most of the weight from the selected swing leg by
shifting the robot’s posture. The better the relieve situation of the swing leg
is rated, the more the swing behaviour is activated. As soon as the swing
behaviour decides to start swinging, its activity increases, the leg is lifted
from the ground. Simultaneously the stace behaviour is inhibited which will
no longer activate the ground contact reﬂex (bottom-most plot in ﬁgure 6).
The target rating of the ground contact reﬂex will shoot up as soon as the
leg leaves the ground, but the relfex cannot change the situation as it is not
activated; its acitivity a remains Zero.
It is to be noted here that walking on unstructured terrain won’t diﬀer
greatly from the situation above. The main diﬀernce will be some more ac-
tivity of the posture reﬂexes, the swing and stance mechanisms remain the
same. Obstacles are hidden from them by the posture control and the collision
reﬂex.
5
Conclusion and outlook
This paper introduced an hierarchical activation based behaviour architec-
ture. Three dedicated signals, the activity a, the activation ι and the target

244
Jan Albiez et al.
foot
points
leg 0 and
leg 2
Leg 0
5
10
15
20
25
30
35
Leg 2
a
force
distri-
bution
reﬂex
ι
a
5
10
15
20
25
30
35
r
leg relieve
behaviour
ι
a
5
10
15
20
25
30
35
r
swing
behaviour
leg 0
ι
a
5
10
15
20
25
30
35
r
ground
contact
reﬂex leg 0
ι
a
5
10
15
20
25
30
35
time [sec]
r
Fig. 6. Some of the behaviours involved while walking on even terrain in free gait
rating r are used to coordinate the interaction of behaviours within the net-
work. Such a network for stable standing and a free gait was successfully im-
plemented for a complex four-legged walking robot. Future work will mainly
consist of the design and testing of diﬀerent gait transition schemes and the
integration of more sensors to allow anticipatory activation of the behaviours
on BISAM. Furthermore there is ongoing work on using this architecture on
other Robot’s of FZI, namely the six-legged walking machines AirBug and
Lauron III and the new four-legged Panter.
References
1. Albiez, J., Ilg, W., Luksch, T., Berns, K., and Dillmann, R. (2001). Learning
reactive posture control on the four-legged walking machine bisam. In Inter-
national Conference on Intelligent Robots and Systems (IROS), Hawaii, USA.
2. Albiez, J., Luksch, T., Berns, K., and Dillmann, R. (2002a). An activation
based behaviour control architecture for walking machines. In Proceedings of
the 7th International Conference on Simulation of Adaptive Behaviour SAB,
Edingburgh, UK.
3. Albiez, J., Luksch, T., Ilg, W., Berns, K., and Dillmann, R. (2002c). Reactive
reﬂex based control for a four-legged walking machine. In Proceedings of the 7th
International Conference on Inteligent Autonomous Systems IAS, Los Angeles,
California, USA.

A Behaviour Network Concept for Controlling Walking Machines
245
4. Arkin, R. (2000). Behavior-Based Robotics. MIT Press.
5. Arkin, R., Kahled, A., Weitzenfeld, A., and Cervantes-Prez, F. (2000). Behav-
ioral models of the praying mantis as a basis for robotic behavior. Journal of
Autonomous Systems.
6. Ayers, J., Witting, J., Olcott, C., McGruer, N., and Massa, D. (2000a). Lob-
ster robots. In Wu, T. and Kato, N., (Eds.), Proceedings of the International
Symposium on Aqua Biomechanisms.
7. Ayers, J., Witting, J., Wilbur, C., Zavracky, P., McGruer, N., and Massa, D.
(2000b). Biomimetic robots for shallow water mine countermeasures. In Proc.
of the Autonomous Vehicles in Mine Countermeasures Symposium.
8. Berns, K., Ilg, W., Deck, M., Albiez, J., and Dillmann, R. (1999). Mechanical
construction and computer architecture of the four-legged walking machine
BISAM. IEEE Transactions on Mechatronics, 4(1):1–7.
9. Brooks, R. (1986). A robust layered control system for a mobile robot. IEEE
Journal of Robotics and Automation, RA-2(1):14–23.
10. Buehler, M., Cocosco, A., Yamazaki, K., and Battaglia, R. (1999).
Stable
open loop walking in quadruped robots with stick legs. In Proceedings of the
IEEE International Conference on Robotics and Automation, pages 2348–2354,
Detroit.
11. Cruse, H., D¨urr, V., and Schmitz, J. (2001). Control of a hexapod walking - a
decentralized solution based on biological data. In Proc. of the 4th International
Conference on Climbing and Walking Robots (CLAWAR), Karlsruhe, Germany.
12. D¨urr, V. and Krause, A. (2001). The stick insect antenna as a biological paragon
for an actively moved tactile probe for obstacle detection. In Proc. of the 4th
International Conference on Climbing and Walking Robots (CLAWAR).
13. Endo, Y. and Arkin, R. (2001).
Implementing tolman’s schematic sowbug:
Behaviour-based robotics in the 1930’s. In Proceedings of the 2001 IEEE In-
ternational Conference on Robotics and Autonomous Systems.
14. Espenschied, K., Quinn, R., Chiel, H., and Beer, R. (1996). Biologically-based
distributed control and local reﬂexes to improve rough terrain locomotion in a
hexapod robot. Robotics and Autonomous Systems, 18:59–64.
15. Ferrell, C. (1995). Global behavior via cooperative local control. volume 2,
pages 105 – 125.
16. Gienger, M., L¨oﬄer, K., and Pfeiﬀer, F. (2001). In Proc. of the IEEE Interna-
tional Conference on Robotics and Automation (ICRA).
17. Hosoda, K., Miyashita, T., and Asada, M. (2000). Emergence of quadruped
walk by a combination of reﬂexes. In Procceedings of the International Sympo-
sium on adaptive Motion of Animals and Machines, Montreal.
18. Ilg, W., Albiez, J., and Jedele, H. (1998a). A biologically inspired adaptive
control architecture based on neural networks for a four-legged walking ma-
chine. In Proceedings of the 8th International Conference on Artiﬁcial Neural
Networks, pages 455–460, Skoevde.
19. Ilg, W., Berns, K., Jedele, H., Albiez, J., Dillmann, R., Fischer, M., Witte,
H., Biltzinger, J., Lehmann, R., and Schilling, N. (1998b). Bisam: From small
mammals to a four legged walking machine. In Proceedings of the Fifth In-
ternational Conference on Simulation of Adaptive Behaviour, pages 400–407,
Zurich.
20. Kandel, E., Schwartz, J., and Jessell, T. M. (2000). Principles of Neural Science.
McGraw-Hill, 4th ed. edition.

246
Jan Albiez et al.
21. Kimura, H. and Fukuoka, Y. (2000). Biologically inspired dynamic walking on
irregular terrain - adaptation at spinal cord and brain stem. In International
Symposium on Adaptive Motion of Animals and Machines, Montreal.
22. Kimura, H., Fukuoka, Y., Hada, Y., and Takase, K. (2001). Three-dimensional
adpative dynamic walking of a quadruped robot by using neural system model.
In Proc. of the 4th International Conference on Climbing and Walking Robots
(CLAWAR), Karlsruhe. FZI.
23. Kimura, H., Shimoyama, I., and Miura, H. (1990). Dynamics in the dynamic
walk of a quadruped robot. Advanced Robotics, 4(3):283–301.
24. L¨oﬄer, K., Gienger, M., and Pfeiﬀer, F. (2001). Simulation and control of a
biped jogging robot.
In Proceedings of the 4th International Conference on
Climbing and Walking Robots (CLAWAR).
25. Likhachev, M. and Arkin, R. (2000). Robotic comfort zones. In Proceedings of
the SPIE: Sensor Fusion and Decentralized Control in Robotic Systems, volume
4196, pages 27–41.
26. Likhachev, M. and Arkin, R. (2001). Spatio-temporal case-based reasoning for
behavioral selection. In Proceedings of the 2001 IEEE International Conference
on Robotics and Automation (ICRA), pages 1627–1634.
27. Mataric, M. J. (1997).
Behavior-based control: Examples from navigation,
learning, and group behavior. Journal of Experimental and Theoretical Artiﬁ-
cial Intelligence, Special issue on Software Architectures for Physical Agents,
9(2-3):323–336.
28. Matsumoto, O., Ilg, W., Berns, K., and Dillmann, R. (2000). Dynamical stable
control of the four-legged walking machine bisam in trot motion using force
sensors. In Intelligent Autonomous Systems 6.
29. Pearson, K. (1995). Proprioceptive regulation of locomotion. Current Opinions
in Neurobiology, 5(6):768–791.
30. Pirajanian, P. (1999). Behaviour coordination mechanisms - state-of-the-art.
Technical Report IRIS-99-375, Institute for Robotics and Intelligent Systems,
School of Engineering, University of Southern California.
31. Raibert, M. H. (1986). Legged Robots That Balance. MIT Press, Cambridge,
MA.
32. Vukobratovic, M., Borovac, B., Surla, D., and Stokic, D. (1990). Biped Loco-
motion. Springer–Verlag, Heidelberg, Berlin, New York.
33. Witte, H., Hackert, R., Fischer, M. S., Ilg, W., Albiez, J., Dillmann, R., and
Seyfarth, A. (2001a). Design criteria for the leg of a walking machine derived
by biological inspiration from quadruped mammals. In Proc. of the 4th Inter-
national Conference on Climbing and Walking Robots (CLAWAR), Karlsruhe,
Germany.
34. Witte, H., Hackert, R., Lilje, K., Schilling, N., Voges, D., Klauer, G., Ilg, W.,
Albiez, J., Seyfarth, A., Germann, D., Hiller, M., Dillmann, R., and Fischer,
M. (2001b). Transfer of biological priciples into the construction of quadruped
walking machines. In Second International Workshop On Robot Motion And
Control, Bukowy Dworek, Poland.
35. Yoneda, K. and Hirose, S. (1992).
Dynamic and Static Fusion Gait of
a Quadruped Walking Vehicle on a Winding Path.
In Proceedings of the
IEEE/RSJ International Conference on Intelligent Robots and Systems, pages
143–148, Nizza.

Part 6
Adaptation at Higher Nervous Level

Control of Bipedal Walking in the Japanese
Monkey, M. fuscata: Reactive and
Anticipatory Control Mechanisms
Futoshi Mori1, Katsumi Nakajima2 and Shigemi Mori1
1 Department of Biological Control System, National Institute for Physiological
Sciences, Okazaki, Aichi 444-8585, Japan
2 Department of Physiology, Kinki University School of Medicine, Osaka-Sayama,
Osaka 589-8511, Japan
Abstract. While the young Japanese monkey, M. fuscata, is growing, it can be
trained operantly to maintain an upright posture and use bipedal (Bp) walking on a
moving treadmill belt. For Bp locomotion, the animal generates suﬃcient propulsive
force to smoothly and swiftly move the center of body mass (CoM) forward. The
monkey can also adapt its gait to meet changing environmental demands. This
appears to be accomplished by use of CNS strategies that include reactive and
anticipatory control mechanisms. In this chapter, we provide evidence that the Bp
walking monkey can select the most appropriate body-leg kinematic parameters
to solve a variety of walking tasks. This recently developed non-human primate
model has the potential to advance understanding of CNS operating principles
that contribute to the elaboration and control of Bp walking in the human.
1
Introduction
Locomotion is a complex motor behavior that requires the integrated control
of multiple, moving body segments including the head, neck, trunk, and limbs.
Appropriate control of each body segment in space is necessary for the stable
execution of both bipedal (Bp) and quadrupedal (Qp) locomotion, and for
adapting posture and gait to a variety of external disturbances. For these
needs, the CNS must integrate the control of (1) antigravity support, (2)
stepping movements, (3) equilibrium, and (4) propulsive force generation [1,
2]. To advance understanding of such CNS control in the human, it was
considered necessary to develop a Bp walking, non-human primate model.
Its use should enable the multifaceted and interlocking study of behavioral,
biomechanical, neuroanatomical, and neurophysiological mechanisms. To this
end, we recently used operant conditioning to train the Japanese monkey, M.
fuscata, to stand upright and use Bp walking on a moving treadmill belt
[3-8]. In this chapter, we focus on how this model adapts its Bp walking
pattern to accommodate changes in treadmill inclination (uphill, downhill),
and other postural and gait perturbations. Relevant preceding human studies
include those that have addressed changes in walking speed and/or slope [9-
14], obstacles on a walking path [15-20], and stair ambulation [21, 22].

250
F. Mori, K. Nakajima, S. Mori
2
Reactive control of Bp locomotion on a slanted
treadmill belt
Previous human studies have shown that gait adaptation on an inclined sur-
face is achieved by changing the pattern of lower limb kinematics [10-12, 14].
Recently, it was also demonstrated that a trunk tilt is necessary in the healthy
human subject to move the CoM ahead of the base of support, thereby as-
sisting forward propulsion [13]. These postural adaptations were shown to be
task-speciﬁc and made possible by recruiting reactive control mechanisms,
which presumably involve use of neuronal circuitry in subcortical structures
of the brain.
We have recently shown that in the face of changes in treadmill speed,
our Bp walking M. fuscata model can automatically adapt its upright pos-
ture and lower limb kinematics, including body axis angle, stride length, and
stepping frequency. This suggested that M. fuscata can select body-leg kine-
matic parameters most appropriate for the execution of a given walking task.
These adaptations must involve use of reactive control mechanisms [23, 24].
To further study this capability, we examined the monkey’s trunk and limb
kinematics during Bp walking on a slanted treadmill surface. An additional
focus was to compare the results to those obtained in previous work on the
human.
2.1
Trunk adaptation to changes in treadmill inclination
In uphill walking, the limbs need to generate a larger acceleration force to
transfer the CoM forward. Similarly, in downhill walking, the limbs generate
a larger deceleration force to prevent excessive forward transfer of the CoM.
Figure 1 shows representative Bp walking patterns of M. fuscata on an uphill
(+15o, A), level (0o, B) and downhill (-15o, C) treadmill set at a ﬁxed belt
speed (1.3 m/s). Lines are drawn on the animal sketches in Figure 1 to depict
relevant kinematic and joint angles: i.e., ear-hip angle and the angles at the
hip, knee, and ankle joint. The line between ear and hip represents the body
axis. The body axis angle is deﬁned as the intercept of the body axis line and
a reference line passing through the hip joint and vertical to the treadmill
surface.
Figure 1A-C show the instantaneous postural shift when the monkey
placed the foot of its left, forward limb on a moving treadmill belt: i.e.,
touchdown, the onset of the stance (ST) phase of the left limb. Subsequently,
the monkey lifted the foot of the right, rearward limb up from the surface
of the treadmill belt: i.e., take-oﬀ, the onset of the swing (SW) phase of the
right limb. In uphill walking (Fig. 1A), the monkey inclined its body axis
maximally during the ST phase of both limbs. The extent of forward body
axis inclination was much larger than that observed during level walking.
In downhill walking (Fig.1C), the monkey also inclined its body axis maxi-
mally during the ST phase of both limbs. The extent of body axis inclination

Control of Bipedal Walking in the Japanese Monkey, M. fuscata
251
was much smaller, however, than that observed during level walking. These
results show that in order to appropriately propel the CoM forward, the mon-
key was able to reactively adapt its body axis angle to changes in treadmill
inclination.
Fig. 1. Sketches of Bp walking monkey on the uphill (15o, A), level (0o, B) and
downhill (-15o, C) treadmill belt at the same speed (1.3m/s). In Fig.1, Fig. 2 and
3, the treadmill belt moved from left to right, and the monkey walked from right to
left. Dotted line in each sketch represents the reference vertical line to the treadmill
belt (see the text). Body axis, body axis angle, lower limb joints (hip, knee and
ankle) and each joint angles were deﬁned as shown in sketches A and B. Note the
body axis angle is much larger during uphill walking than during downhill walking.
Modiﬁed from [7].
At a ﬁxed treadmill speed (1.3m/s), we found that the body axis angle
increased proportionately with an increase in treadmill grade (from –15oto
15o). An uphill increase from 0o to 7o to 15o resulted in an increase in the
maximum body axis angle from 15o to 24o to 37o, respectively. Similarly,
a downhill increase in treadmill grade from 0o to –7o to –15o resulted in a
decrease in the maximum body axis angle from 15o to 8oto 2o, respectively.
Such a relationship between changes in treadmill grade and body axis angle
was nearly linear across all three of the tested treadmill speeds (0.7, 1.0 and
1.3m/s). On the treadmill belt at the same grade, the extent of body axis
inclination became more pronounced as treadmill speed increased. All of the
above changes have also been seen during human Bp walking [13].

252
F. Mori, K. Nakajima, S. Mori
2.2
Lower limb adaptation to changes in the treadmill inclination
Throughout a single uphill vs. level step cycle, the monkey exhibited a larger
ﬂexion of the hip joint, lesser extension of the knee joint, and larger ankle
dorsi-ﬂexion during the mid-SW and early-ST phase. Also, there was a larger
knee joint extension in the late ST phase. Throughout a single downhill vs.
level step cycle, the monkey exhibited a larger extension of the knee joint
and a lesser ﬂexion of the hip joint during the late SW and early ST phase.
In addition, there was a lesser extension of the hip joint and larger ﬂexion of
the knee joint during the late ST and early SW phase.
During level treadmill walking at a ﬁxed treadmill speed (0.7m/s), the
duration of the ST and SW phase of the step was ∼0.60 and ∼0.25 s, re-
spectively. Uphill and downhill walking at the same speed involved more
prolonged and shortened ST-phase duration, respectively. This relationship
was maintained across treadmill speeds of 1.0 and 1.3m/s. The duration of
the SW phase of the step cycle, however, did not change signiﬁcantly. We
also found a linear relationship between treadmill grade and stride length:
i.e., a progressively longer stride for an increase in treadmill grade from –15o
to +15o. There were clear associations between stride length, and treadmill
grade and speed. During uphill walking, step-cycle frequency decreased as
stride length and treadmill speed increased, with the reverse during downhill
walking.
Presumably, the increase in body axis angle during uphill walking en-
ables the limbs to generate greater momentum to propel the CoM forward
and counteract the resistance due to gravity. It thus becomes necessary for
the body axis to have a greater degree of forward inclination, especially at
faster treadmill speeds. The need to generate this greater momentum is also
accompanied by a progressive increase in stride length, as the treadmill slope
becomes steeper. During downhill walking, the body is moved forward and
downward by the mechanical eﬀect of the slope. To counteract these exter-
nal constraints, lower limb joints need to absorb more energy and decrease
the forward momentum of the body [25]. This decrease is accompanied by
a progressive decrease in stride length, as the treadmill inclination becomes
steeper in downhill conditions. During downhill walking, a backward tilt of
the body axis is needed to move the CoM relatively backward and upward,
and thereby help decrease the forward and downward momentum caused by
gravity.
Taken together, the above results suggest that the operant-trained Bp
locomotion of M. fuscata is smooth and versatile during changes in treadmill
inclination. By recruiting reactive control mechanisms and selecting appro-
priate kinematic parameters the animal is better able to couple movements
of head, body, and lower limbs during walking on a slanted treadmill. Again,
healthy human subjects make quite similar adjustments [10-13] to those de-
scribed above for M. fuscata.

Control of Bipedal Walking in the Japanese Monkey, M. fuscata
253
3
Reactive and anticipatory control of Bp locomotion
on an obstacle-attached treadmill belt
In routine, daily locomotion, the feet often collide with unexpected obstacles,
thereby requiring compensatory postural and gait adjustments to prevent
stumbling and falling, and reestablish smooth and stable locomotion [5, 19].
Tripping and slipping perturbations commonly occur when the swing foot
strikes a small object on the walking path. They are the major cause of falls
during Bp walking in the elderly human [26]. Both occur primarily during
the SW phase of the trailing limb, when the CoM is outside the base of
supporting limb. The nature of postural and gait adjustments to unexpected
perturbations have been studied experimentally in the human by having the
subject walk on an obstacle-obstructed pathway [16-19], or a moving treadmill
belt [15, 20]. Previous studies have already demonstrated that the Bp walking
human recruits anticipatory control mechanisms to adjust posture and gait
before encountering unexpected obstacles [24]. Anticipatory adjustments of
posture and gait occur in a proactive way during all phases of the step cycle,
with visuomotor coordination playing a crucial role [27-29]. We have therefore
examined the extent to which M. fuscata can recruit anticipatory control
mechanisms during its Bp walking on an obstacle-attached treadmill belt.
3.1
Reactive and compensatory adjustments during perturbed
locomotion
Unexpected obstacles that impede the smooth trajectory of the swing foot
during Bp walking activate a variety of sensory receptors, and perturb the
stability of moving body segments. Visual, vestibular, proprioceptive and ex-
teroceptive aﬀerent inputs must be integrated to produce responses that en-
sure the removal of the limb from the obstacle, as well as the safe continuation
of Bp walking. The relationship between the walking subject and the envi-
ronment is mediated primarily through the visual system [29]. Other sensory
modalities such as vestibular aﬀerents also provide information about body
orientation and equilibrium. Vestibular information is also used to maintain
clear vision during movements of the head and keep the head stable in space
[26]. Cutaneous and muscle aﬀerents, which originate from both the trailing
and leading limbs, contribute to the control of SW and ST phases of the
limbs, and also to the transition from SW to ST and vice versa [30].
Figure 2 shows the monkey’s adoption of a defensive posture, and some
other compensatory processes, after slipping up an obstacle during the late
SW phase. Stumbling occurred routinely when the trailing foot failed to clear
the obstacle. This was presumably due to the absence of visual sampling of
the up-coming obstacle. Such stumbling usually occurred when the toe of the
trailing limb stepped on or slipped up the obstacle during its late SW phase.
A late SW perturbation poses a greater threat for a fall, because the CoM is
already well anterior to the supporting foot.

254
F. Mori, K. Nakajima, S. Mori
Fig. 2. Serial sketches of perturbed bipedally walking monkey. The monkey slipped
on the obstacle at 2 and showed defensive posture during 3 and 5 with the correction
of the perturbed posture.
Immediately after foot-obstacle contact (2 in Fig. 2), the monkey moved
its body axis slightly backward. This was followed by a rapid and pronounced
(∼40o) forward movement of the body axis (4 in Fig. 2). Subsequently, the
animal (1) shortened the SW period of the leading limb, (2) lowered the
CoM to the treadmill belt, and (3) extended its left (and/or right) forelimb
forward and/or downward, and (4) extended its lower limb joints to raise
the lowered CoM upward. This serial postural compensation was usually
accomplished within a few hundred milliseconds. The ﬁrst three of these
defensive compensatory reactions of multiple motor segments stabilized the
perturbed posture. The last (fourth) one, an extension of the lower limb
joints, especially the hip and knee joints, helped to restore the animal’s head
and body position to their pre-perturbed position in space. All four reactions
made it possible for the animal to restore its posture and walk safely and
smoothly without interruption. Presumably, such a serial recovering of normal
posture and gait is based on the recruitment of reactive control mechanisms.
Interestingly, correction of the head position always occurred ﬁrst, followed by
that of the body axis and ﬁnally the limbs. It seems likely that the restoration
of head position in space is a critical determinant of the nature and extent
of subsequent reactive responses.
3.2
Anticipatory avoidance strategy during obstacle-encountered
locomotion
During Bp walking along an unperturbed straight path, ﬁnely controlled loco-
motor mechanisms, such as visuo-motor coordination, may not be necessary.
Once the walking circumstances are dramatically changed, however, there is
need in the CNS to make use of both external and internal sensory infor-
mation. These include visual, vestibular, proprioceptive, and exteroceptive
inputs (indeed, as many as are available), which help prepare the posture
for the impending perturbations. It has been well demonstrated that visual
and vestibular information interacts with that from other sensory systems to
maintain postural stability over a wide range of environmental condition [26].

Control of Bipedal Walking in the Japanese Monkey, M. fuscata
255
The most powerful means of ensuring such stability is to proactively avoid
the perturbation by the recruitment of anticipatory control mechanisms.
Fig. 3. Sketches of Bp walking monkey’s instantaneous posture. A; control (no
obstacle) level walking, B: obstacle is 3-4 steps ahead of walking monkey and out-
of-site, C; successful clearance of the obstacle. Treadmill speed is 1.0 m/s. Modiﬁed
from [7]. Arrows indicate the elevating hip position by “biasing strategy” (see the
text).
Figure 3 shows the instantaneous upright posture of a Bp walking monkey
during control (no obstacle) level walking (A) vs. when the obstacle is 2-
3 steps ahead (B) vs. out-of-site (C). The task was to clear a 7-cm high
rectangular obstacle, which was attached to the left walking path on the
moving treadmill. In the control walking condition, the CoM was supported
by the right limb alone. This involved moderate ﬂexion of the left limb at
the hip and knee joints (Fig. 3A). During walking on the obstacle-attached
treadmill belt, the monkey ﬂexed the hip and knee joints of the trailing limb
to greater extent than in the control condition (Fig 3B). This was done even
when the obstacle was out of sight. This ﬁnding shows that the monkey
adopted a preparatory posture, thereby anticipating the up-coming obstacle
(anticipatory control). For this, the monkey presumably using the learned
memory of both how to clear the obstacle and the consequence of failing to
do so.
We have also found that the number of stumbles in a single trial of the
obstacle-clearance walking task, which consisted of ∼100 successive step cy-
cles, decreased after several trials. Apparently, the monkey perceived the up-
coming obstacles by their visual sampling, and gradually learned how to clear
them, using what in humans has been termed a “hip-knee ﬂexion strategy”

256
F. Mori, K. Nakajima, S. Mori
[17]. This strategy involved the monkey simultaneously increasing the extent
of ﬂexion of the left trailing hip and knee joints. This enabled the animal
to have enough clearance space over the obstacle, and it allowed use of the
leading right limb alone for supporting the CoM and maintaining equilibrium
(Fig. 3C). Our kinematic analyses of the hip and knee joints of the trailing
limb revealed that they used larger ﬂexions for obstacles of higher height.
This result demonstrated that the monkey was able to use visual information
about obstacle height to help select the most appropriate hip-knee ﬂexion
strategy to clear the obstacle.
Patla and Rietdyk have proposed that the human uses two diﬀerent strate-
gies to clear obstacles on a walking path [18]. The ﬁrst involves an exaggerated
“ﬂexing” of the swing limb to increase ground clearance (ﬂexion strategy).
They termed the second one “biasing” for an exaggerated upward motion
of the swing phase trajectory (elevating strategy). The upward bias in the
swing limb trajectory is reﬂected in the vertical position of the hip. If it is
higher there is a bias, whereas if only limb ﬂexion is used to produce a higher
limb elevation, the hip’s vertical position remains as during normal unper-
turbed locomotion. To lift the trailing foot higher, M. fuscata recruited not
only the human’s hip-knee ﬂexion strategy, but also the elevating strategy
(Fig. 3C). The monkey also adapted its foot trajectory in relation to obstacle
height: i.e., the hip was elevated higher as a function of obstacle height and
a greater parabolic foot trajectory was used. Such ﬁndings also indicate the
pronounced similarity between the locomotion strategies of the monkey vs.
human.
3.3
Anticipatory control based visuo-motor coordination
Figure 3C shows an example of a successful obstacle clearance. During this
clearance, hip-knee ﬂexion was further enhanced by additional dorsi-ﬂexion
of the ankle joint (i.e., Fig. 3B vs. C). The monkey changed its foot trajectory
from that used during control Bp walking. It was easier for the monkey to
clear the obstacle when it was met during the early to mid-SW phase of the
trailing limb. Probably, this was because it allowed suﬃcient time to calculate
the new parabolic trajectory of the foot, which was required for clearance of
the upcoming obstacle. Presumably, this was more challenging during the late
SW phase of trailing left limb, when the swinging left foot began to approach
the top surface of the obstacle. At this moment, the monkey needed an extra
eﬀort to lift the foot upward and over the obstacle. With repeated practice
of this obstacle clearance task, however, the monkey became to modulate the
foot trajectory even during the late SW phase.
When the monkey cleared the obstacle during the mid-swing phase of
the trailing limb, the trajectory of the foot was nearly parabolic. When the
obstacle was cleared during the late SW-phase, however, the foot trajectory
took on a double parabolic shape, with a second trajectory initiated in the
middle of the ﬁrst one. Possibly, this new foot trajectory was achieved by the

Control of Bipedal Walking in the Japanese Monkey, M. fuscata
257
recruitment of a visuo-motor coordination based on an anticipatory control
mechanism. This proposition is supported by the fact that when the mon-
key could not sample suﬃcient visual information, it could not change its
foot trajectory. Rather, it always stumbled over the obstacle even when us-
ing a preparatory locomotor posture. Sampled visual information apparently
helped scaling of the toe clearance as a function of obstacle size, thereby
providing a large safety margin as is also observed in the human [18].
4
Summary
Our analysis of the Bp walking of M. fuscata demonstrates quite clearly that
this non-human primate model and the human make use of similar body-limb
kinematics for the integration of posture and locomotion under a variety of
circumstances.
When the monkey walked on a slanted treadmill belt, it utilized optimal
kinematic parameters for coordination of multiple motor segments. When it
encountered an obstacle, it changed its foot trajectory to advance (antici-
patory control) and produce a larger-than-usual clearance space above the
obstacle. Moreover, when the monkey stumbled over the obstacle, it quickly
recovered from its perturbed posture, and continued smooth Bp locomotion.
All of these ﬁndings suggest that the CNS of the Bp walking monkey received
and transformed in an integrative manner salient visual, vestibular, proprio-
ceptive, and exteroceptive sensory information. The result was an output of
command motor signals, which were appropriate for the task at hand. This
accommodation appeared to make use of reactive and anticipatory control
mechanisms. These allowed the monkey to continuously adjust its ongoing
locomotor patterns and accompanying postures.
At the present stage of our kinematic studies, a number of questions
relevant to the underlying CNS mechanisms remain unanswered. We do not
know how reactive and anticipatory control mechanisms interact to produce
command signals to the motoneurons that innervate multiple motor segments.
Nor do we know the subcortical and cortical neural networks that provide
reactive and anticipatory control of posture and locomotion. Nonetheless, it
is clear that our M. fuscata model has much potential for the further study
of brain mechanisms that integrate posture and locomotion under normal,
environmentally perturbed and pathological states.
References
1. Martin, J. P., 1967. The Basal Ganglia and Posture, Pitman Medical Publish-
ing, London.
2. Mori, S., 1997. Neurophysiology of locomotion: Recent advances in the study
of locomotion. In: Gait Disorders of Aging (J. C. Masdeu, L. Sundarsky, L.
Wolfson, eds), Lippincott-Raven, Philadelphia, pp. 55-78.

258
F. Mori, K. Nakajima, S. Mori
3. Mori, F., Nakajima, K., Gantchev, N., Matsuyama, K., and Mori, S., 1999.
A new model for the study of the neurobiology of bipedal locomotion: The
Japanese monkey, M. fuscata. In: From basic motor control to functional re-
covery (N. Gantchev and G. N. Gantchev, eds), Academic Publishing House,
Soﬁa, pp. 47-51.
4. Nakajima, K., Mori, F., Takasu, C., Tachibana, A., Okumura, T., Mori, M.,
and Mori, S., 2001. Integration of upright posture and bipedal locomotion in
non-human primates. In: Sensorimotor Control (R. Dengler and A. R. Kossev,
eds), IOS Press, Amsterdam, pp. 95-102.
5. Mori, F., Tachibana, A., Takasu, C., Nakajima, K., and Mori, S., 2001. Bipedal
locomotion by the normally quadrupedal Japanese monkey, M. fuscata: Strate-
gies for obstacle clearance and recovery from stumbling, Acta Physiol. Phar-
macol. Bulg. 26: 147-150.
6. Nakajima, K., Mori, F., Takasu, C., Mori, M., Matsuyama, K., and Mori, S.,
2003. Biomechanical constraints in hindlimb joints during the quadrupedal vs.
bipedal locomotion of M. fuscata. In: Brain Mechanisms for the integration of
Posture and Movement (S. Mori, M. Wiesendanger, and D. G. Stuart, eds),
Elsevier, Amsterdam, pp. 183-190.
7. Mori, F., Nakajima, K., Tachibana, A., Takasu, C., Mori, M., Tsujimoto, T.,
Tsukada, H., and Mori, S., 2003. Reactive and anticipatory control of posture
and bipedal locomotion in a non-human primate. In: Brain Mechanisms for the
integration of Posture and Movement (S. Mori, M. Wiesendanger, and D. G.
Stuart, eds), Elsevier, Amsterdam, pp. 191-198.
8. Tachibana, A., Mori, F., Boliek, C. A., Nakajima, K., Takasu, C., and Mori, S.,
2003. Acquisition of operant-trained locomotion in juvenile Japanese monkeys
(Macaca fuscata): a longitudinal study. Motor Control 7: 395-420.
9. Murray, M. P., Kory, R. C., Clarkson, B. H., and Sepic, S. B., 1966. Comparison
of free and fast speed walking patterns of normal men. Am. J. Phys. Med. 45:
8-24.
10. Wall, J. Z. C., Nottrodt, J. W., Charteris, J., 1981. The eﬀect of uphill and
downhill walking on pelvic oscillations in the transverse plane. Ergonomics 24:
807-816.
11. Kawamura, K., Tokuhiro, A., Takachi, H., 1991. Gait analysis of slope walking:
a study on step length, stride width, time factors and deviation in the center
of pressure. Acta Med. Okayama 45: 179-184.
12. Vogt, L., and Banzer, W., 1999. Measurement of lumbar spine kinematics in
incline treadmill walking. Gait Posture 9: 18-23.
13. Leroux, A., Fung, J., and Barbeau, H., 2002. Postural adaptation to walking
on inclined surfaces: I. Normal strategies. Gait Posture 15: 64-74.
14. Cromwell, R. L., 2003. Movement strategies for head stabilization during incline
walking. Gait Posture 17: 246-253.
15. Dietz, V., Quitern, J. Q., and Sillem, M., 1987. Stumbling reactions in man:
signiﬁcance of proprioceptive and pre-programmed mechanisms. J. Physiol. 386:
149-163.
16. Patla, A., Beuter, A., and Prentice, S., 1991. A two stage correction of limb
trajectory to avoid obstacles during stepping. Neurosci. Res. Commun. 8: 153-
159.
17. McFadyen, B. J., and Winter, D. A., 1997. Anticipatory locomotor adjustments
during obstructed human walking. Neurosci. Res. Commun. 9: 37-44.

Control of Bipedal Walking in the Japanese Monkey, M. fuscata
259
18. Patla, A. E., and Rietdyk, S., 1993. Visual control of limb trajectory over
obstacles during locomotion: eﬀect of obstacle height and width. Gait Posture
1: 45-60.
19. Eng, J. J., Winter, D. A., and Patla, A. E., 1994. Strategies for recovery from
a trip in early and late swing during human walking, Exp. Brain Res. 102:
339-349.
20. Schillings, A. M., Van Wezel, B. M. H., and Duysens, J., 1996. Mechanically
induced stumbling during human treadmill walking, J. Neurosci. Methods 67:
11-17.
21. Heller, M. O., Bergmann, G., Deuretzbacher, G., D¨urselen, L., Pohl, M., Claes,
L., Haas, N. P., and Duda, G. N. 2001. Musculo-skeletal loading conditions at
the hip during walking and stair climbing. J. Biomechanics 34: 883-893.
22. Riener, R., Rabuﬀetti, M., and Frigo, C., 2002. Stair ascent and descent at
diﬀerent inclinations. Gait Posture 15: 32-44.
23. Mori, S., 1987. Integration of posture and locomotion in acute decerebrate cats
and in awake, freely moving cat. Prog. Neurobiol. 28: 161-195.
24. McFadyen, B. J., and B´elanger, M., 1997. Neuromechanical concepts for the as-
sessment of the control of human gait. In: Three-dimensional analysis of bipedal
locomotion (P. Allard, A. Cappozzo, A. Lundberg and C. L. Vaughan, eds),
John Wiley & Sons, Chichester, pp. 49-66.
25. Redfen, M. S., and DiPasquale, J., 1997. Biomechanics of descending ramps.
Gait Posture 6: 119-125.
26. Horak, F.B., Mirka, A., and Shupert, C.L. 1989. The role of peripheral vestibu-
lar disorders in postural dyscontrol in the elderly. In: The Development of
Posture and Gait Across the Lifespan (M. Woolacott, and A. Shumway-Cook,
eds), Univ. of South Carolina Press, Columbia, pp. 253-279.
27. Georgopoulos, A. P., and Grillner, S., 1986. Visuomotor coordination in reach-
ing and locomotion. Science 245: 1209-1210.
28. Drew, T., 1991. Visuomotor coordination in locomotion. Curr. Opin. Neurobiol.
1: 652-657.
29. Patla, A.E. Visual control of human locomotion. 1991. In: Adaptability of Hu-
man Gait (A.E. Patla, ed) Elsevier Science Publishers B.V. North-Holland,
30. Zehr, E.P., and Stein, R.B. 1999. What functions do reﬂexes serve during human
locomotion? Prog. Neurobiol. 58: 185-205.

Dynamic Movement Primitives –A Framework
for Motor Control in Humans and Humanoid
Robotics
Stefan Schaal1,2
1 Computer Science and Neuroscience, University of Southern California, Los
Angeles, CA 90089-2520, USA
2 ATR Human Information Science Laboratory, 2-2 Hikaridai, Seika-cho,
Soraku-gun, 619-02 Kyoto, Japan
Abstract. Given the continuous stream of movements that biological systems ex-
hibit in their daily activities, an account for such versatility and creativity has to
assume that movement sequences consist of segments, executed either in sequence
or with partial or complete overlap. Therefore, a fundamental question that has per-
vaded research in motor control both in artiﬁcial and biological systems revolves
around identifying movement primitives (a.k.a. units of actions, basis behaviors,
motor schemas, etc.). What are the fundamental building blocks that are strung
together, adapted to, and created for ever new behaviors? This paper summarizes
results that led to the hypothesis of Dynamic Movement Primitives (DMP). DMPs
are units of action that are formalized as stable nonlinear attractor systems. They
are useful for autonomous robotics as they are highly ﬂexible in creating com-
plex rhythmic (e.g., locomotion) and discrete (e.g., a tennis swing) behaviors that
can quickly be adapted to the inevitable perturbations of a dynamically changing,
stochastic environment. Moreover, DMPs provide a formal framework that also
lends itself to investigations in computational neuroscience. A recent ﬁnding that
allows creating DMPs with the help of well-understood statistical learning meth-
ods has elevated DMPs from a more heuristic to a principled modeling approach.
Theoretical insights, evaluations on a humanoid robot, and behavioral and brain
imaging data will serve to outline the framework of DMPs for a general approach
to motor control in robotics and biology.
1
Introduction
When searching for a general framework of how to formalize the learning of
coordinated movement, some of the ideas developed in the middle of the 20th
century still remain useful. At this time, theories from optimization theory, in
particular in the context of dynamic programming [1, 2], described the goal of
learning control in learning a policy. A policy is formalized as a function that
maps the continuous state vector x of a control system and its environment,
possibly in a time dependent way, to a continuous control vector u:
u = π (x, α, t)
(1)

262
Stefan Schaal
The parameter vector α denotes the problem speciﬁc adjustable parame-
ters in the policy ?—not unlike the parameters in neural network learning. At
the ﬁrst glance, one might suspect that not much was gained by this overly
general formulation. However, given some cost criterion that can evaluate
the quality of an action u in a particular state x, dynamic programming, and
especially its modern relative, reinforcement learning, provide a well founded
set of algorithms of how to compute the policy ? for complex nonlinear con-
trol problems. Unfortunately, as already noted in Bellman’s original work,
learning of ? becomes computationally intractable for even moderately high
dimensional state-action spaces. Although recent developments in reinforce-
ment learning increased the range of complexity that can be dealt with [e.g.
3, 4, 5], it still seems that there is a long way to go to apply general policy
learning to complex control problems.
In most robotics applications, the full complexity of learning a control
policy is strongly reduced by providing prior information about the policy.
The most common priors are in terms of a desired trajectory, , usually hand-
crafted by the insights of a human expert. For instance, by using a PD con-
troller, a (explicitly time dependent) control policy can be written as:
u = π (x, α (t) , t) = π (x, [xd (t) , ˙xd (t)] , t)
= Kx (xd (t) −x) + K ˙x (˙xd (t) −˙x)
(2)
For problems in which the desired trajectory is easily generated and in which
the environment is static or fully predictable, as in many industrial applica-
tions, such a shortcut through the problem of policy generation is highly suc-
cessful. However, since policies like in are usually valid only in a local vicinity
of the time course of the desired trajectory, they are not very ﬂexible. When
dealing with a dynamically changing environment in which substantial and
reactive modiﬁcations of control commands are required, one needs to modify
trajectories appropriately, or even generate entirely new trajectories by gen-
eralizing from previously learned knowledge. In certain cases, it is possible to
apply scaling laws in time and space to desired trajectories [6, 7], but those
can provide only limited ﬂexibility, as similarly recognized in related theories
in psychology [8]. Thus, for general-purpose reactive movement, the “desired
trajectory” approach seems to be too restricted.
From the viewpoint of statistical learning, Equation constitutes a nonlin-
ear function approximation problem. A typical approach to learning complex
nonlinear functions is to compose them out of basis functions of reduced
complexity. The same line of thinking generalizes to learning policies: a com-
plicated policy could be learned from the combination of simpler (ideally
globally valid) policies, i.e., policy primitives or movement primitives, as for
instance:
Indeed, related ideas have been suggested in various ﬁelds of research, for
instance in computational neuroscience as Schema Theory [9] and in mobile
robotics as behavior-based or reactive robotics [10]. In particular, the latter

Dynamic Movement Primitives
263
approach also emphasized to remove the explicit time dependency of ?, such
that complicated “clocking” and “reset clock” mechanisms could be avoided,
and the combination of policy primitives becomes simpliﬁed. Despite the
successful application of policy primitives in the mobile robotics domain,
so far, it remains a topic of ongoing research [11, 12] how to generate and
combine primitives in a principled and autonomous way, and how such an
approach generalizes to complex movement systems, like human arms and
legs.
Thus, a key research topic, both in biological and artiﬁcial motor control,
revolves around the question of movement primitives: what is a good set of
primitives, how can they be formalized, how can they interact with perceptual
input, how can they be adjusted autonomously, how can they be combined
task speciﬁcally, and what is the origin of primitives? In order to address
the ﬁrst four of these questions, we suggest to resort to some of the most
basic ideas of dynamic systems theory. The two most elementary behaviors
of a nonlinear dynamic system are point attractive and limit cycle behaviors,
paralleled by discrete and rhythmic movement in motor control. Would it
be possible to generate complex movement just out of these two basic ele-
ments? The idea of using dynamic systems for movement generation is not
new: motor pattern generators in neurobiology [13, 14], pattern generators
for locomotion [15, 16], potential ﬁeld approaches for planning [e.g., 17], and
more recently basis ﬁeld approaches for limb movement [18] have been pub-
lished. Additionally, work in the dynamic systems approach in psychology
[19-23] has emphasized the usefulness of autonomous nonlinear diﬀerential
equations to describe movement behavior. However, rarely have these ideas
addressed both rhythmic and discrete movement in one framework, task spe-
ciﬁc planning that can exploit both intrinsic (e.g., joint) coordinates and
extrinsic (e.g., Cartesian) coordinate frames, and more general purpose be-
havior, in particular for multi-joint arm movements. It is in these domains,
that the present study oﬀers a novel framework of how movement primitives
can be formalized and used, both in the context of biological research and
humanoid robotics.
2
Dynamic movement primitives
Using nonlinear dynamic systems as policy primitives is the most closely re-
lated to the original idea of motor pattern generators (MPG) in neurobiology.
MPGs are largely thought to be hardwired with only moderately modiﬁable
properties. In order to allow for the large ﬂexibility of human limb control, the
MPG concept needs to be augmented by a component that can be adjusted
task speciﬁcally, thus leading to what we call a Dynamic Movement Primitive
(DMP). We assume that the attractor landscape of a DMP represents the
desired kinematic state of a limb, e.g., positions, velocities, and accelerations.
This approach deviates from MPGs which are usually assumed to code motor

264
Stefan Schaal
commands, and is strongly related to the idea developed in the context of
“mirror laws” by B¨uhler, Rizzi, and Koditschek [24, 25]. As shown in Figure
1, kinematic variables are converted to motor commands through an inverse
dynamics model and stabilized by low gain feedback control. The motivation
for this approach is largely inspired by data from neurobiology that demon-
strated strong evidence for the representation of kinematic trajectory plans
in parietal cortex [26] and inverse dynamics models in the cerebellum [27,
28]. Kinematic trajectory plans are equally backed up by the discovery of the
principle of motor equivalence in psychology [e.g., 29], demonstrating that
diﬀerent limbs (e.g., ﬁngers, arms, legs) can produce cinematically similar
patterns despite having very diﬀerent dynamical properties; these ﬁndings
are hard to reconcile with planning directly in motor commands. Kinematic
trajectory plans, of course, are also well known in robotics from computed
torque and inverse dynamics control schemes [30]. From the view point of
movement primitives, kinematic representations are more advantageous than
direct motor command coding since this allows for workspace independent
planning, and, importantly, for the possibility to superimpose DMP. However,
it should be noted that a kinematic representation of movement primitives is
not necessarily independent of dynamic properties of the limb. Propriocep-
tive feedback can be used to modify the attractor landscape of a DMP in the
same way as perceptual information [25, 31, 32].
u = π (x, α, t) =
K

k=1
πk (x, αk, t)
(3)
2.1
Formalization of DMPs
In order to accommodate discrete and rhythmic movements, two kinds of
DMPs are needed, a point attractive system and a limit system. Although
it is possible to construct nonlinear diﬀerential equations that could realize
both these behaviors in one set of equations [e.g., 33], for reasons of robust-
ness, simplicity, functionality, and biological realism (see below), we chose an
approach that separates these two regimes. Every degree-of-freedom (DOF)
of a limb is described by two variables, a rest position and a superimposed
oscillatory position, , as shown in Figure 1. By moving the rest position, dis-
crete motion is generated. The change of rest position can be anchored in joint
space or, by means of inverse kinematics transformations, in external space.
In contrast, the rhythmic movement is produced in joint space, relative to the
rest position. This dual strategy permits to exploit two diﬀerent coordinate
systems: joint space, which is the most eﬃcient for rhythmic movement, and
external (e.g., Cartesian) space, which is needed to reference a task to the
external world. For example, it is now possible to bounce a ball on a racket
by producing an oscillatory up-and-down movement in joint space, but using
the discrete system to make sure the oscillatory movement remains under the

Dynamic Movement Primitives
265
Fig. 1. Sketch of control diagram with dynamic movement primitives. Each degree-
of-freedom of a limb has a rest state and an oscillatory state .
ball such that the task can be accomplished—this task actually motivated
our current research [34].
The key question of DMPs is how to formalize nonlinear dynamic equa-
tions such that they can be ﬂexibly adjusted to represent arbitrarily com-
plex motor behaviors without the need for manual parameter tuning and the
danger of instability of the equations. We will develop our approach in the
example of a discrete dynamic system for reaching movements. Assume we
have a basic point attractive system, for instance, instantiated by the second
order dynamics
u = π (x, α, t) =
K

k=1
πk (x, αk, t)
(4)
where gis a known goal state, αz and βz are time constants, τ is a temporal
scaling factor (see below) and y,
correspond to the desired position and velocity generated by the equa-
tions, interpreted as a movement plan. For appropriate parameter settings
and f=0, these equations form a globally stable linear dynamical system
with g as a unique point attractor. Could we ﬁnd a nonlinear function f
in Equation to change the rather trivial exponential convergence of y to al-
low more complex trajectories on the way to the goal? As such a change of
Equation enters the domain of nonlinear dynamics, an arbitrary complexity
of the resulting equations can be expected. To the best of our knowledge,

266
Stefan Schaal
this has prevented research from employing generic learning in nonlinear dy-
namical systems so far. However, the introduction of an additional canonical
dynamical system (x,v)
u = π (x, α, t) =
K

k=1
πk (x, αk, t)
and the nonlinear function f
u = π (x, α, t) =
K

k=1
πk (x, αk, t)
can alleviate this problem. Equation is a second order dynamical system
similar to Equation , however, it is linear and not modulated by a nonlinear
function, and, thus, its monotonic global convergence to g can be guaranteed
with a proper choice of αv and βv, e.g., such that Equation is critically
damped. Assuming that all initial conditions of the state variables x,v,y,z
are initially zero, the quotient x/g ∈[0, 1] can serve as a phase variable to
anchor the Gaussian basis functions ψi (characterized by a center ci and
bandwidth hi), and v can act as a “gating term” in the nonlinear function
such that the inﬂuence of this function vanishes at the end of the movement.
Assuming boundedness of the weights wi in Equation , it can be shown that
the combined system in Equations ,, asymptotically converges to the unique
point attractor g.
Given that f is a normalized basis function representation with linear pa-
rameterization, it is obvious that this choice of a nonlinearity allows applying
a variety of learning algorithms to ﬁnd the wi. For instance, if a sample trajec-
tory is given in terms as ydemo(t), ˙ydemo(t) and a duration T, e.g., as typical in
imitation learning [35], a supervised learning problem can be formulated with
the target trajectory ftarget = τ ˙ydemo −zdemo for the right part of Equation
, where zdemo is obtained by integrating the left part of Equation with ydemo
instead of y. The corresponding goal is g = ydemo(t = T) −ydemo(t = 0), i.e.,
the sample trajectory was translated to start at y=0. In order to make the
nominal (i.e., assuming f=0) dynamics of Equations and span the duration
T of the sample trajectory, the temporal scaling factor τ is adjusted such that
the nominal dynamics achieves 95% convergence at t = T. For solving the
function approximation problem, we chose a nonparametric regression tech-
nique from locally weighted learning (RFWR) [36] as it allows us to determine
the necessary number of basis functions N, their centers ci, and bandwidth
hi automatically—in essence, for every basis function ψi, RFWR performs a
locally weighted regression of the training data to obtain an approximation
of the tangent of the function to be approximated within the scope of the ker-
nel, and a prediction for a query point is achieved by a ψi-weighted average
of the predictions of all local models. Moreover, the parameters wi learned
by RFWR are also independent of the number of basis functions, such that
they can be used robustly for categorization of diﬀerent learned DMPs.

Dynamic Movement Primitives
267
In summary, by anchoring a linear learning system with nonlinear basis
functions in the phase space of a canonical dynamical system with guaranteed
attractor properties, we are able to learn complex attractor landscapes of
nonlinear diﬀerential equations without losing the asymptotic convergence
to the goal state. Ijspeert et al [37] demonstrate how the same strategy as
described for a point attractive system above can also be applied to limit cycle
oscillators, thus creating oscillator systems with almost arbitrarily complex
limit cycles. It is also straightforward to augment the suggested approach of
DMPs to multiple DOFs: there is only one canonical system (cf. Equation ),
but for each DOF a separate function f is learned. Even highly complex phase
relationships between diﬀerent DOFS, as for instance needed for locomotion,
are easily and stably realizable in this approach.
2.2
Application to humanoid robotics
We implemented our DMP system on a 30 DOF Sarcos Humanoid robot.
Desired position, velocity, and acceleration information was derived from the
states of the DMPs to realize a compute-torque controller. All necessary
computations run in real-time at 420Hz on a multiple processor VME bus
operated by VxWorks. We realized arbitrary rhythmic “3-D drawing” pat-
terns, sequencing of point-to-point movements and rhythmic patterns like ball
bouncing with a racket. Figure 2a shows our humanoid robot in a drumming
task. The robot used both arms to generate a regular rhythm on a drum and
a cymbal. The arms moved in 180-degree phase diﬀerence, primarily using
the elbow and wrist joints, although even the entire body was driven with
oscillators for reasons of natural appearance. The left arm hit the cymbal on
beat 3, 5, and 7 based on an 8-beat pattern. The velocity zero crossings of the
left drum stick at the moment of impact triggered the discrete movement to
the cymbal. Figure 2b shows a trajectory piece of the left and the right elbow
joint angles to illustrate the drumming pattern. Given the independence of
a discrete and rhythmic movement primitives, it is very easy to create the
demonstrated bimanual coordination without any problems to maintain a
steady drumming rhythm.
Another example of applying the DMP is in the area of imitation learning,
as outlined in the previous section. Figure 3 illustrates the teaching of a tennis
forehand to our humanoid, using an exoskeleton to obtain joint angle data
from the human demonstration. The learned multi-joint DMP can be re-used
for diﬀerent targets and at diﬀerent speeds due to the ﬂexible appearance of
the goal parameter g and time scaling τ—in the example in Figure 3, the
Cartesian ball position is ﬁrst converted to a joint angle target by inverse
kinematics algorithms, and subsequently each DOF of the robot receives a
separate joint space goal state for its DMP component.

268
Stefan Schaal
Fig. 2. a) Humanoid robot in drumming task, b) coordination of left and right
elbow, demonstrating the superposition of discrete and rhythmic DMPs.

Dynamic Movement Primitives
269
3
Parallels in biological research
Our ideas on dynamic movement primitives for motor control are based on
biological inspiration and complex system theory, but do they carry over to
biology? Over the last years, we explored various experimental setups that
could actually demonstrate that dynamic movement primitives as outlined
above are indeed an interesting modeling approach to account for various
phenomena in behavioral and even brain imaging experiments. The remainder
of this paper will outline some of the results that we obtained.
3.1
Dynamic manipulation tasks
From the viewpoint of motor psychophysics, the task of bouncing a ball
on a racket constitutes an interesting testbed to study trajectory planning
and visuomotor coordination in humans. The bouncing ball has a strong
stochastic component in its behavior and requires a continuous change of
motor planning in response to the partially unpredictable behavior of the
ball.
In previous work [34], we examined which principles were employed by
human subjects to accomplish stable ball bouncing. Three alternative move-
ment strategies were postulated. First, the point of impact could be planned
with the goal of intersecting the ball with a well-chosen movement veloc-
ity such as to restore the correct amount of energy to accomplish a steady
bouncing height [38]; such a strategy is characterized by a constant velocity
of the racket movement in the vicinity of the point of racket-ball impact.
An alternative strategy was suggested by work in robotics: the racket move-
ment was assumed to mirror the movement of the ball, thus impacting the
ball with in increasing velocity proﬁle, i.e., positive acceleration [25]. The
dynamical movement primitives introduced above allow yet another way of
accomplishing the ball bouncing task: an oscillatory racket movement creates
a dynamically stable basin of attraction for ball bouncing, thus allowing even
open-loop stable ball bouncing. This movement strategy is characterized by
a negative acceleration of the racket during impacting the ball [39]—a quite
non-intuitive solution: why would one break the movement before hitting the
ball?
Examining the behavior of six subjects revealed the surprising result that
dynamic movement primitives captured the human behavior the best: all sub-
jects reliably hit the ball with a negative acceleration at impact, as illustrated
in Figure 4. Manipulations of bouncing amplitude also showed that the way
the subjects accomplished such changes could easily be captured by a simple
re-parameterization of the oscillatory component of the movement, similarly
as suggested for our DMPs above.

270
Stefan Schaal
Fig. 3. Left Column: Teacher demonstration of a tennis swing, Right Column:
Imitated movement by the humanoid robot.

Dynamic Movement Primitives
271
Fig. 4. Trial means of acceleration values at impact, ¨xP,n, for all six experimen-
tal conditions grouped by subject. The symbols diﬀerentiate the data for the two
gravity conditions G. The dark shading covers the range of maximal local stabil-
ity for Greduced the light shading the range of maximal stability for Gnormal. The
overall mean and its standard deviation refers to the mean across all subjects and
all conditions.
3.2
Apparent movement segmentation
Invariants of human movement have been an important area of research for
more than two decades. Here we will focus on two such invariants, the 2/3
power law and piecewise planar movement segmentation, and how a parsimo-
nious explanation of those eﬀects can be obtained. Studying handwriting and
2D drawing movements, Viviani and Terzuolo [40] ﬁrst identiﬁed a systematic
relationship between angular velocity and curvature of the endeﬀector traces
of human movement, an observation that was subsequently formalized in the
“2/3 power law” [41]:
a(t) denotes the angular velocity of the endpoint trajectory, and c(t) the
corresponding curvature; this relation can be equivalently expressed by a 1/3
power-law relating tangential velocity v(t) with radius of curvature r(t):
Since there is no physical necessity for movement systems to satisfy this
relation between kinematic and geometric properties, and since the relation
has been reproduced in numerous experiments (for an overview see [42]),
the 2/3-power law has been interpreted as an expression of a fundamental
constraint of the CNS, although biomechanical properties may signiﬁcantly
contribute [43]. Additionally, Viviani and Cenzato [44] and Viviani [45] in-
vestigated the role of the proportionality constant k as a means to reveal

272
Stefan Schaal
movement segmentation: as k is approximately constant during extended
parts of the movement and only shifts abruptly at certain points of the tra-
jectory, it was interpreted as an indicator for segmented control. Since the
magnitude of kalso appears to correlate with the average movement velocity
in a movement segment, k was termed the “velocity gain factor.” Viviani
and Cenzato [44] found that planar elliptical drawing patterns are character-
ized by a single k and, therefore, consist of one unit of action. However, in
a ﬁne-grained analysis of elliptic patterns of diﬀerent eccentricities, Wann ,
Nimmo-Smith, and Wing [46] demonstrated consistent deviations from this
result. Such departures were detected from an increasing variability in the
log-v–log-r-regressions for estimating k and the exponent β of Equation (2),
and ascribed to several movement segment each of which having a diﬀerent
velocity gain factor k.
The second movement segmentation hypothesis we want to address par-
tially arose from research on the power law. Soechting and Terzuolo [47, 48]
provided qualitative demonstrations that 3D rhythmic endpoint trajectories
are piecewise planar. Using a curvature criterion as basis for segmentation,
they conﬁrmed and extended Morasso’s [49] results that rhythmic movements
are segmented into piecewise planar strokes. After Pellizzer, Massay, Lurito,
and Georgopoulus [50] demonstrated piecewise planarity even in an isometric
task, movement segmentation into piecewise planar strokes has largely been
accepted as one of the features of human and primate arm control.
We repeated some of the experiments that led to the derivation of the
power law, movement segmentation based on the power law, and movement
segmentation based on piecewise planarity. We tested six human subjects
when drawing elliptical patterns and ﬁgure-8 patterns in 3D space freely in
front of their bodies. Additionally, we used an anthropomorphic robot arm,
a Sarcos Dexterous Arm, to create similar patterns as those performed by
the subjects. The robot generated the elliptical and ﬁgure-8 patterns solely
out of joint-space oscillations, as described for the DMPs above. For both
humans and the robot, we recorded the 3D position of the ﬁngertip and the
seven joint angles of the performing arm.
Figure 5 illustrates data traces of one human subject and the robot subject
for elliptical drawing patterns of diﬀerent sizes and diﬀerent orientations. For
every trajectory in this graph, we computed the tangential velocity of the
ﬁngertip of the arm and plotted it versus the radius of curvature raised to
the power 1/3. If the power law were obeyed, all data points should lie on
a straight line through the origin. Figure 5a,b clearly demonstrates that for
large size patterns, this is not the case, indicating that the power seems to be
violated for large size patterns. However, the development of two branches
for large elliptical patterns in Figure 5a,b could be interpreted that large
elliptical movement patterns are actually composed of two segments, each
of which obeys the power law. The rejection of the latter point comes from
the robot data in Figure 5c,d. The robot produced strikingly similar features

Dynamic Movement Primitives
273
Fig. 5. Tangential velocity versus radius of curvature to the power 1/3 for ellipses
of small, medium, and large size for elliptical pattern orientations in the frontal and
oblique workspace plane: a) human frontal; b) human oblique; c) robot frontal; d)
robot oblique.

274
Stefan Schaal
in the trajectory realizations as the human subjects. However, the robot
simply used oscillatory joint space movement to create these patterns, i.e.,
there was no segmented movement generation strategy. Some mathematical
analysis of the power law and the kinematic structure of human arms could
ﬁnally establish that the power law can be interpreted as an epiphenomenon
of oscillatory movement generation: as long as movement patterns are small
enough, the power law holds, while for large size patterns the law breaks
down [51, 52].
Using ﬁgure-8 patterns instead of elliptical patterns, we were also able to
illuminate the reason for apparent piecewise-planar movement segmentation
in rhythmic drawing patterns. Figure 6 shows ﬁgure-8 patterns performed by
human and robot subjects. If realized with an appropriate width-to-height
ratio, ﬁgure-8 patterns look indeed like piecewise planar trajectories and in-
vite the hypothesis of movement segmentation at the node of the ﬁgure-8.
However, as in the previous experiment, the robot subject produced the same
features of movement segmentation despite it used solely joint space oscilla-
tions to create the patterns, i.e., no movement segmentation. Again, it was
possible to explain the apparent piecewise planarity from a mathematical
analysis of the kinematics of the human arm, rendering piecewise planarity
to be an epiphenomenon of oscillatory joint space trajectories and the non-
linear kinematics of the human arm. [51].
Fig. 6. Planar projection of one subject’s ﬁgure-8 patterns of small, medium, and
large width/height ratio: a-c) human data; d-f) corresponding robot data.
3.3
Superposition of discrete and rhythmic movement
In another experiment, we addressed the hypothesis of DMP that two sepa-
rate movement primitives generate discrete and rhythmic movement. Subjects

Dynamic Movement Primitives
275
performed oscillatory elbow movements around a given point in space and
shifted the mean position of the elbow at an auditory signal to another point.
In previous work [53], it was argued that such a discrete shift terminates the
oscillatory elbow movement and restarts it after the shift. Using the model
of dynamic movement primitives, we were able to demonstrate that a sim-
ple coupling structure between the discrete and rhythmic movement system
can actually explain all the phenomena observed in this experiment, includ-
ing phase resetting, a restricted set of onset phases for the discrete movement
within the rhythmic movement, and kinematic features of the trajectory after
the discrete shift [54, 55].
3.4
Brain activation in discrete and rhythmic movement
A last set of experiments addressed the question whether discrete and rhyth-
mic movements make use of diﬀerent brain centers. In a 4Tesla scanner, sub-
jects performed either continuous oscillations with the wrist at two diﬀerent
frequencies, or discrete ﬂexion and extension movements with pseudo-random
movement start times. Both conditions were executed either with or with-
out metronome pacing, and even with the foot instead of the wrist in three
subjects. SPM99 based data analysis, including averaging across 11 subjects,
provided highly statistically signiﬁcant results (Figure 7). While rhythmic
movement was conﬁned to activation in primary contralateral motor cortices,
supplementary motor cortex, and ipsilateral cerebellum, discrete movement
elicited additional activation in contralateral premotor and parietal areas,
and also in various ipsilateral cortical regions. These results indicate that
discrete movements, even as simple as wrist ﬂexion-extension movements,
recruit signiﬁcantly more cortical areas than rhythmic movement, and that
discrete and rhythmic movement may have diﬀerent movement generating
principles in the brain. Thus, the model of rhythmic and discrete movement
primitives may even have physiological signiﬁcance.
4
Conclusion
The present study describes research towards generating ﬂexible movement
primitives out of nonlinear dynamic attractor systems. We focused on moti-
vating appropriate dynamic systems such that discrete and rhythmic move-
ments could be generated with high-dimensional movement systems. We also
described some implementations of our system of Dynamic Movement Prim-
itives on a complex anthropomorphic robot. In the last sections of the pa-
per, we outlined various behavioral and imaging studies that resulted from
our more theoretically motivated model. We believe that the combination of
robotic, theoretical, and biological work that we pursued for the presented
studies exempliﬁes a new path towards research in biomimetic robotics and
computational neuroscience. Both disciplines can oﬀer diﬀerent and new ideas

276
Stefan Schaal
Fig. 7. Diﬀerence in brain activation between discrete and rhythmic movement ob-
tained by contrasting discrete and rhythmic wrist movement. See legend on the
left of the ﬁgure for explanations of which contrasts are displayed (note that this
plot may not be clear in a black-and-white printout—download a PDF version at
http://www-clmc.usc.edu/publications). Rhythmic-Rest and Discrete-Rest in
the middle plot of all subﬁgures demonstrate the main eﬀects of brain activity dur-
ing Rhythmic and Discrete movement conditions—when there is overlap between
the two contrasts, the Overlay Color Legend on the left of the subﬁgures is used
to highlight the degree of overlap. Rhythmic-Discrete shows brain areas where
rhythmic movement has stronger activity than discrete movement. Analogously,
Discrete-Rhythmic displays areas that showed signiﬁcantly more activation than
rhythmic movement. The right plot of all three subﬁgures shows the Rhythmic-
Discrete and Discrete-Rhythmic contrasts in isolation for the sake of clarity—
no overlap is possible. The left plot in all subﬁgures superimposes the activities from
the other plots in the subﬁgure to allow an easy comparison of activation locations.
All results shown are statistically signiﬁcant at a level of p<0.00001, corrected for
multiple comparisons within the entire brain volume. Abbreviations are[56]: AC:
anterior commissure; PC: posterior commissure; VAC: vertical line perpendicular
to the AC-PC, passing through the AC; PAC: vertical line perpendicular to the
AC-PC, passing through the PC; CCZ: caudal cingulate zone; RCZ: rostral cingu-
late zone, divided in an anterior (RCZa) and posterior (RCZp) part; SMA: caudal
portion of the supplementary motor area, corresponding to SMA proper; pre-SMA:
rostral portion of the supplementary motor area; M1: primary motor cortex; S1:
primary sensory cortex; PMdr: rostral part of the dorsal premotor cortex; PMdc:
caudal part of the dorsal premotor cortex; BA7: Brodman area 7 in parietal cortex;
BA40: Brodman area 40 in parietal cortex.

Dynamic Movement Primitives
277
and techniques that will ultimately lead to reciprocal beneﬁts in both disci-
plines.
Acknowledgments
This work was made possible by awards #9710312/#0010312 and #0082995
of the National Science Foundation, award AC#98-516 by NASA, an AFOSR
grant on Intelligent Control, the ERATO Kawato Dynamic Brain Project
funded by the Japanese Science and Technology Agency, and the ATR Human
Information Processing Research Laboratories.
References
1. R. Bellman, Dynamic programming. Princeton, N.J.: Princeton University Press,
1957.
2. P. Dyer and S. R. McReynolds, The computation and theory of optimal control.
New York: Academic Press, 1970.
3. G. Tesauro, ”Temporal diﬀerence learning of backgammon strategy,” in Proceed-
ings of the Ninth International Workshop Machine, D. Sleeman and P. Edwards,
Eds. San Mateo, CA: Morgan Kaufmann, 1992, pp. 9-18.
4. D. P. Bertsekas and J. N. Tsitsiklis, Neuro-dynamic Programming. Bellmont,
MA: Athena Scientiﬁc, 1996.
5. R. S. Sutton and A. G. Barto, Reinforcement learning : An introduction. Cam-
bridge: MIT Press, 1998.
6. J. M. Hollerbach, ”Dynamic scaling of manipulator trajectories,” Transactions
of the ASME, vol. 106, pp. 139-156, 1984.
7. S. Kawamura and N. Fukao, ”Interpolation for input torque patterns obtained
through learning control,” presented at International Conference on Automation,
Robotics and Computer Vision (ICARCV’94), Singapore, Nov., 1994, 1994.
8. R. A. Schmidt, Motor control and learning. Champaign, Illinois: Human Kinet-
ics, 1988.
9. M. A. Arbib, ”Perceptual structures and distributed motor control,” in Handbook
of Physiology, Section 2: The Nervous System Vol. II, Motor Control, Part 1,
V. B. Brooks, Ed.: Bethesda, MD: American Physiological Society, 1981, pp.
1449-1480.
10. R. A. Brooks, ”A robust layered control system for a mobile robot,” IEEE
Journal of Robotics and Automation, vol. 2, pp. 14-23, 1986.
11. R. R. Burridge, A. A. Rizzi, and D. E. Koditschek, ”Sequential composition
of dynamically dexterous robot behaviors,” International Journal of Robotics
Research, vol. 18, pp. 534-555, 1999.
12. W. Lohmiller and J. J. E. Slotine, ”On contraction analysis for nonlinear sys-
tems,” Automatica, vol. 6, 1998.
13. A. I. Selverston, ”Are central pattern generators understandable?,” The Be-
havioral and Brain Sciences, vol. 3, pp. 555-571, 1980.
14. E. Marder, ”Motor pattern generation,” Curr Opin Neurobiol, vol. 10, pp. 691-
8., 2000.

278
Stefan Schaal
15. M. Raibert, Legged robots that balance. Cambridge, MA: MIT Press, 1986.
16. G. Taga, Y. Yamaguchi, and H. Shimizu, ”Self-organized control of bipedal
locomotion by neural oscillators in unpredictable environment,” Biological Cy-
bernetics, vol. 65, pp. 147-159, 1991.
17. D. E. Koditschek, ”Exact robot navigation by means of potential functions:
Some topological considerations,” presented at Proceedings of the IEEE Interna-
tional Conference on Robotics and Automation, Raleigh, North Carolina, 1987.
18. F. A. Mussa-Ivaldi and E. Bizzi, ”Learning Newtonian mechanics,” in Self-
organization, Computational Maps, and Motor Control, P. Morasso and V. San-
guineti, Eds. Amsterdam: Elsevier, 1997, pp. 491-501.
19. D. Sternad, M. T. Turvey, and R. C. Schmidt, ”Average phase diﬀerence theory
and 1:1 phase entrainment in interlimb coordination,” Biological Cybernetics,
vol. no.67, pp. 223-231, 1992.
20. J. A. S. Kelso, Dynamic patterns: The self-organization of brain and behavior.
Cambridge, MA: MIT Press, 1995.
21. S. Grossberg, C. Pribe, and M. A. Cohen, ”Neural control of interlimb oscilla-
tions. I. Human bimanual coordination,” Biol Cybern, vol. 77, pp. 131-40, 1997.
22. C. Pribe, S. Grossberg, and M. A. Cohen, ”Neural control of interlimb oscil-
lations. II. Biped and quadruped gaits and bifurcations,” Biol Cybern, vol. 77,
pp. 141-52, 1997.
23. M. T. Turvey, ”The challenge of a physical account of action: A personal view,”
1987.
24. M. B¨uhler, ”Robotic tasks with intermittent dynamics,” Yale University New
Haven, 1990.
25. A. A. Rizzi and D. E. Koditschek, ”Further progress in robot juggling: Solv-
able mirror laws,” presented at IEEE International Conference on Robotics and
Automation, San Diego, CA, 1994.
26. J. F. Kalaska, ”What parameters of reaching are encoded by discharges of
cortical cells?,” in Motor Control: Concepts and Issues, D. R. Humphrey and H.
J. Freund, Eds.: John Wiley & sons, 1991, pp. 307-330.
27. N. Schweighofer, M. A. Arbib, and M. Kawato, ”Role of the cerebellum in
reaching movements in humans. I. Distributed inverse dynamics control,” Eur J
Neurosci, vol. 10, pp. 86-94, 1998.
28. N. Schweighofer, J. Spoelstra, M. A. Arbib, and M. Kawato, ”Role of the cere-
bellum in reaching movements in humans. II. A neural model of the intermediate
cerebellum,” Eur J Neurosci, vol. 10, pp. 95-105, 1998.
29. N. A. Bernstein, The control and regulation of movements. London: Pergamon
Press, 1967.
30. J. J. Craig, Introduction to robotics. Reading, MA: Addison-Wesley, 1986.
31. S. Schaal and D. Sternad, ”Programmable pattern generators,” presented at
3rd International Conference on Computational Intelligence in Neuroscience,
Research Triangle Park, NC, 1998.
32. M. Williamson, ”Neural control of rhythmic arm movements,” Neural Networks,
vol. 11, pp. 1379-1394, 1998.
33. G. Sch¨oner, ”A dynamic theory of coordination of discrete movement,” Biolog-
ical Cybernetics, vol. 63, pp. 257-270, 1990.
34. S. Schaal, D. Sternad, and C. G. Atkeson, ”One-handed juggling: A dynamical
approach to a rhythmic movement task,” Journal of Motor Behavior, vol. 28,
pp. 165-183, 1996.

Dynamic Movement Primitives
279
35. S. Schaal, ”Is imitation learning the route to humanoid robots?,” Trends in
Cognitive Sciences, vol. 3, pp. 233-242, 1999.
36. S. Schaal and C. G. Atkeson, ”Constructive incremental learning from only
local information,” Neural Computation, vol. 10, pp. 2047-2084, 1998.
37. A. Ijspeert, J. Nakanishi, and S. Schaal, ”Learning attractor landscapes for
learning motor primitives,” in Advances in Neural Information Processing Sys-
tems 15, S. Becker, S. Thrun, and K. Obermayer, Eds.: Cambridge, MA: MIT
Press, 2003.
38. E. W. Aboaf, S. M. Drucker, and C. G. Atkeson, ”Task-level robot learing: Jug-
gling a tennis ball more accurately,” presented at Proceedings of IEEE Intera-
tional Conference on Robotics and Automation, May 14-19, Scottsdale, Arizona,
1989.
39. S. Schaal and C. G. Atkeson, ”Open loop stable control strategies for robot
juggling,” presented at IEEE International Conference on Robotics and Au-
tomation, Georgia, Atlanta, 1993.
40. P. Viviani and C. Terzuolo, ”Space-time invariance in learned motor skills,” in
Tutorials in Motor Behavior, G. E. Stelmach and J. Requin, Eds. Amsterdam:
North-Holland, 1980, pp. 525-533.
41. F. Lacquaniti, C. Terzuolo, and P. Viviani, ”The law relating the kinematic and
ﬁgural aspects of drawing movements,” Acta Psychologica, vol. 54, pp. 115-130,
1983.
42. P. Viviani and T. Flash, ”Minimum-jerk, two-thirds power law, and isochrony:
Converging approaches to movement planning,” Journal of Experimental Psy-
chology: Human Perception and Performance, vol. 21, pp. 32-53, 1995.
43. P. L. Gribble and D. J. Ostry, ”Origins of the power law relation between
movement velocity and curvature: Modeling the eﬀects of muscle mechanics and
limb dynamics,” Journal of Neurophysiology, vol. 76, pp. 2853-2860, 1996.
44. P. Viviani and M. Cenzato, ”Segmentation and coupling in complex move-
ments,” Journal of Experimental Psychology: Human Perception and Perfor-
mance, vol. 11, pp. 828-845, 1985.
45. P. Viviani, ”Do units of motor action really exist?,” in Experimental Brain
Research Series 15. Berlin: Springer, 1986, pp. 828-845.
46. J. Wann, I. Nimmo-Smith, and A. M. Wing, ”Relation between velocity and
curvature in movement: Equivalence and divergence between a power law and a
minimum jerk model,” Journal of Experimental Psychology: Human Perception
and Performance, vol. 14, pp. 622-637, 1988.
47. J. F. Soechting and C. A. Terzuolo, ”Organization of arm movements. Motion
is segmented,” Neuroscience, vol. 23, pp. 39-51, 1987.
48. J. F. Soechting and C. A. Terzuolo, ”Organization of arm movements in three
dimensional space. Wrist motion is piecewise planar,” Neuroscience, vol. 23, pp.
53-61, 1987.
49. P. Morasso, ”Three dimensional arm trajectories,” Biological Cybernetics, vol.
48, pp. 187-194, 1983.
50. G. Pellizzer, J. T. Massey, J. T. Lurito, and A. P. Georgopoulos, ”Three-
dimensional drawings in isometric conditions: planar segmentation of force tra-
jectory,” Experimental Brain Research, vol. 92, pp. 326-227, 1992.
51. D. Sternad and D. Schaal, ”Segmentation of endpoint trajectories does not
imply segmented control,” Experimental Brain Research, vol. 124, pp. 118-136,
1999.

280
Stefan Schaal
52. S. Schaal and D. Sternad, ”Origins and violations of the 2/3 power law in
rhythmic 3D movements,” Experimental Brain Research, vol. 136, pp. 60-72,
2001.
53. S. V. Adamovich, M. F. Levin, and A. G. Feldman, ”Merging diﬀerent motor
patterns: coordination between rhythmical and discrete single-joint,” Experi-
mental Brain Research, vol. 99, pp. 325-337, 1994.
54. D. Sternad, E. L. Saltzman, and M. T. Turvey, ”Interlimb coordination in a
simple serial behavior: A task dynamic approach,” Human Movement Science,
vol. 17, pp. 392-433, 1998.
55. D. Sternad, A. De Rugy, T. Pataky, and W. J. Dean, ”Interaction of discrete
and rhythmic movements over a wide range of periods,” Exp Brain Res, vol. 147,
pp. 162-74, 2002.
56. N. Picard and P. L. Strick, ”Imaging the premotor areas,” Curr Opin Neurobiol,
vol. 11, pp. 663-72., 2001.

Coupling Environmental Information from
Visual System to Changes in Locomotion
Patterns: Implications for the Design of
Adaptable Biped Robots
Aftab E. Patla, Michael Cinelli and Michael Greig
Gait and Posture Lab, Department of Kinesiology, University of Waterloo,
Waterloo, Ontario N2L3G1
Abstract. Information at a distance provided by vision is critical for adaptive
human locomotion. In this paper we focus on which visually observable environ-
mental features from the visual images on the retina are extracted and how they are
coupled to changes in appropriate locomotion patterns. Studies related to environ-
mental features that pose a danger to the mobile agent are described: these include
obstacles; sliding doors and undesirable foot landing area in the travel path. Both
static and dynamic environmental features result in changing optic ﬂow patterns:
environmental features that change independently pose an added challenge. Key
results from these studies are discussed in terms of issues that are important for
the implementation of visually guided adaptable biped robot.
1
Introduction
“Locomotion is controlled by information; control lies in the animal-environment
system” (Gibson, 1979). The fact that sensory information plays a critical role
in the control of locomotion is not an issue: rather the challenge has been to
identify the roles played by various sensory inputs and delineate the transfor-
mation of the sensory input into appropriate motor output (Dickinson et al.,
2000). A sensory modality that is able to provide information at a distance
is essential for adaptive locomotion in unstructured and changing environ-
ments. Research has shown that vision is the only modality that can provide
accurate and precise advance information about inanimate features of the en-
vironment (Patla, Davies & Niechweij, 2003). It is not surprising that most
animals rely on vision to guide locomotion and Gibson in 1938 stated that
“locomotion is guided chieﬂy by vision”.
The importance of vision for the control of adaptive locomotion was recog-
nized early on. Liddell & Phillips (1944) showed that following pyramidotomy
(which involves the cutting of the primary motor pathway from the cortex
to the spine) cats were unable to walk in challenging environments where
visually guided limb movements were essential. This proves that vision will
mediate through higher cortical centers when visual information is necessary
to safely move in a complex environment. Researchers have quantiﬁed corti-
cal motor signals which represent one of the outputs from the visual system

282
A. E. Patla, M. Cinelli, M. Greig
(Drew et al., 1986). The challenge has been on the sensory side, speciﬁcally
controlling the visual input, determining the spatial and temporal link and
the transformation between the sensory input and motor output and identify-
ing the many roles visual input plays in controlling locomotion. Psychophys-
ical studies examining perceptual responses to visual inputs (abstraction of
naturally occurring stimuli pattern during locomotion) focus on the sensory
side without examining how the relevant information is used to guide ac-
tion. Recording of neural activity in animals in response to similar stimuli
or functional neuro-imaging studies in humans while fruitful also do not pro-
vide insights into the actual information and strategies used during adaptive
locomotion. In our lab we have manipulated the environment, and/or visual
input and examined the spatial and temporal characteristics of the changes
that occur in the gait patterns.
2
The twelve postulates for visual control of human
locomotion
Based on a series of experiments done in our lab, we have been able to come
up with a set of postulates that provide unique insights into visual control of
human locomotion (Patla, 1997, Patla, 1998; Patla, 2003). These are grouped
under a series of questions that have guided our research.
Q1: What information does vision provide, that is unique and
cannot be easily substituted by other sensory modalities?
P1. Vision provides unique, accurate and precise information at the right
time and location about the environment at a distance (Exteroceptive), infor-
mation about posture and movements of the body/body segment and infor-
mation about self-motion (Ex-proprioceptive). For example, environmental
information provided by haptic sense, used so eﬀectively by visually impaired
individuals, is not accurate or precise enough and takes much longer to obtain
the information (see Patla, Davies & Niechweij, 2003).
Q2. Where and when are diﬀerent types of visual information
used?
P2. Environmental information, both visually observable and visually in-
ferred, is used in a sampled feed-forward control mode to adapt basic walking
patterns by inﬂuencing whole body motor patterns.
P3. Postural and movement information about the lower limbs is used in a
sampled on-line control mode to ﬁne-tune the adaptive swing limb trajectory
(Patla et al, 2002).
P4. Self-motion information is used in a sampled on-line control mode to
maintain postural orientation and balance during locomotion.
Q3. How is this visual information acquired?
P5. Combination of whole body, head and eye movements are used to
acquire visual information. The most common gaze pattern during adaptive
locomotion does not involve active gaze transfer to objects of interest: rather

Coupling Environmental Information from Visual System to Changes
283
gaze is anchored in front of the feet and is carried by the moving observer
giving rise to optic ﬂow (Patla, 2003). This has clear implications for the
control of moving image capture in legged robots: as long as the video cam-
eras are stabilized and oriented appropriately relative to the terrain, relevant
information can be extracted from the optic ﬂow.
Fig. 1. Dominant gaze behavior is similar to carrying a torch shining at a ﬁxed
distance on the ground ahead of the person.
Q4. What are the characteristics of the visual-to-motor trans-
formation?
P6. Visual-motor transformation for adaptive locomotion is not just de-
pendent on visual input: prediction of future limb trajectory along with a
priori rules inﬂuences the selection of an adaptive strategy.
P7. Proactive adaptive gait strategies involve global modiﬁcations to move-
ment patterns and exploit inter-segmental dynamics to provide simple and
eﬃcient control.
P8. The duration and the pattern of available visual information inﬂuence
accuracy and precision of local and global control of posture and balance
during locomotion.
P9. The dynamic temporal stability margin during adaptive locomotion is
constrained within narrow limits, necessitating a fast backup reactive system
(reﬂexes) to ensure stability in case of error in visual-motor transformation.
P10. Visual-motor transformation for control of locomotion is primarily
carried out in the occipito-parietal stream.
P11. Cognitive factors play an important role in both the selection of
adaptive strategies and modulation of locomotion patterns.
Q5. What happens when there is conﬂicting information from
other modalities?
P12. Visual information dominates over inappropriate kinesthetic infor-
mation and voluntarily generated vestibular information for the control of
swing limb trajectory.

284
A. E. Patla, M. Cinelli, M. Greig
3
Challenges for applying this knowledge to building
of adaptable biped robots
Creating an internal, environmentally detailed map from the visual images
has clearly been recognized as not the way to use visual information to con-
trol a biped robot. Besides being prohibitively time consuming and hence
too slow to implement any changes quickly, it is also not the way the bi-
ological system has evolved and functions. We know that the same visual
information is processed diﬀerently and in diﬀerent areas to guide action
versus aiding perception (Milner & Goodale, 1991). Gibson (1958) proposed
similar functional visuo-motor loops to serve diﬀerent locomotor functions.
He argued that our movements through the world result in changes of the
images on the retina: this optic ﬂow provides rich sources of information to
guide movements. Information present in the visual stimulus under ecological
conditions is suﬃcient and can be used to guide movements accurately and
precisely (Gibson, 1979). The brain is tuned to pick up the appropriate visual
information in the stimulus, similar to the tuner picking up a radio signal.
The relevant information present in the stimulus is a complex, higher order
spatial-temporal structure, which Gibson called an invariant. One such in-
variant is the variable “Tau” that provides information about time to contact
with an object and has been argued to guide interceptive action (see review
by Lee, 1998). Other invariants would control other actions. Gibson’s ideas
are mirrored in the revised architecture for robots proposed by Brooks (1989).
Figure 2 below summarizes the convergence of engineering, behavioral and
biological thinking on how vision is used to control locomotor functions.
3.1
Geometric versus non-geometric features of the environment:
role of past experience in interpreting visual information
Most geometric features of the environment are available in the changing im-
age on the retina as the person moves through that environment. In contrast,
non-geometric features such as surface properties (for example compliance
and frictional characteristics) require some inference based on past experi-
ence. For example, the potential for slipping on a banana peel in the travel
path is inferred from past experience and is not directly available in the
changing visual image.
Our work has shown that accommodating surfaces with diﬀerent physical
properties involve major modiﬁcations once contact has been made: while
there are some changes to the pattern prior to landing, these are based on
knowledge and/or prior experience with the surfaces (Marigold & Patla, 2002;
Marigold et al., 2003). Modulations following ground contact probably rely
more on information from other modalities (somatosensory for example) than
vision. It is best therefore to focus on the extraction of visually observable
environmental features from the visual images and linking them to changes
in appropriate biped locomotor patterns.

Coupling Environmental Information from Visual System to Changes
285
Fig. 2. a) Engineering architecture for control adaptable robots; b) Gibson’s ideas
about visual control of locomotion; c) Concept of cortical visual processing in ani-
mals adapted from Milner & Goodale (1991).

286
A. E. Patla, M. Cinelli, M. Greig
Fig. 3. Schematic ﬂow chart showing the inputs besides vision to adapt normal gait
patterns for diﬀerent environments.
The focus of this paper will be on studies related to environmental fea-
tures that pose a danger to the locomotor agent: obstacles, moving/oscillating
doors and undesirable foot landing area in the travel path are examples
of such hazards. Both static and dynamic environmental features result in
changing optic ﬂow patterns. Environmental features that change indepen-
dent of the mobile agent pose an added challenge. Key results from these
studies are discussed in terms of issues that are important for implementa-
tion of visuo-motor algorithms for adaptable biped robot.
4
Avoiding collisions with obstacles in the travel path
Avoiding a collision with obstacles in the travel path is a deﬁning feature of
legged locomotion. The ability to step over or under an obstacle besides going
around it, allows legged animals to travel over terrains that are not accessible
on wheels. This ability also minimizes damage to the terrain; wheeled vehi-
cles that roll over the uneven terrain transfer their weight on the surface and
can potentially harm the environment. The decision not to alter the travel
path direction and instead step over or under an obstacle has been argued
to be based on perceiving aﬀordances in the environment (Gibson, 1979).
Aﬀordances are based on visual information about the environment scaled
to an individual’s own body size or capability. For example, if an obstacle
exceeds a certain height in relation to the persons own stature, the individual
chooses to go around rather than over (Patla, 1997). To capture the complex-
ity and ﬂexibility of adaptive human gait behavior during collision avoidance

Coupling Environmental Information from Visual System to Changes
287
in legged robots is a daunting task. We have to take baby steps so to speak
before we run with the task of implementing the full repertoire of behavior.
4.1
Approaching and stepping over a single static obstacle in the
travel path
We begin with the simplest task of getting a legged robot to approach and
step over an obstacle that is static in its travel path. At ﬁrst glance this would
seem a trivial task and relatively easy to achieve, but this is not the case.
This task has been studied in healthy individuals quiet extensively with a
wealth of knowledge available (see review by Patla, 1997). While the primary
focus has been on mapping the changes in motor patterns as a function of
obstacle characteristics (see Patla and Rietdyk, 1993), researchers have also
examined the nature of the contribution of visual and proprioceptive sensory
systems to adaptive locomotion (Patla, 1998; Sorensen, Hollands and Patla,
2002; Mohagheghi et al., 2003). It has been shown that dominance of visual
input, which has the capability to provide information at a distance, can be
used to plan and modify step patterns (Patla, 1998).
Lewis & Simo (1999) implemented a unique learning algorithm to teach
a biped robot to step over an obstacle of a ﬁxed height. Depending on what
part of the swing limb trajectory made contact with the obstacle, preceding
foot placements were adjusted. Limb elevation was set for the obstacle height
(presumably early on) and the foot placement was modiﬁed in the approach
phase to ensure success. Depending on which part of the robot leg touched the
obstacle, the step length was either shortened (if the leg touches during the
lowering phase) or lengthened. The reduction in variability in foot placement
as the robot approached the obstacle was implemented by imposing a cost
penalty for making large changes in step length. Visual information about
the location of the obstacle was therefore being updated on-line to modulate
step length during the approach phase while obstacle height information was
programmed in for a ﬁxed height obstacle. An intriguing question such an im-
plementation poses is whether it is possible to dissociate the two critical pieces
of information necessary for task performance. If possible, the visuo-motor
algorithm could then be simpliﬁed by extracting obstacle height information
separately and early in the approach phase. On-line obstacle location infor-
mation could then be used to modulate primarily the foot placement during
the approach phase.
What we were interested in is seeing if humans use similar techniques
during obstacle avoidance. The easiest way to test the algorithm proposed by
Lewis & Simo (1999) is to examine the performance of the obstacle avoidance
task in an open-loop mode with the visual information about the obstacle
height and location available prior to gait initiation. The basic question being:
Can obstacle location and height information acquired prior to gait initiation
be used to successfully step over the obstacle? The experiment and key results
are described next.

288
A. E. Patla, M. Cinelli, M. Greig
Information about an obstacle in the travel path was acquired at a dis-
tance: the person was either standing (static viewing) or visually sampling
during three steps before (dynamic sampling). The experimental set-up is
shown below.
Fig. 4. Experimental set-up for obstacle avoidance following obstacle viewing under
diﬀerent conditions.
Compared to the full vision condition, visual information acquired at a
distance followed by open-loop control has a failure rate of ∼50%. The chal-
lenge is to determine what information is required on-line to ensure success
in this task: is it obstacle height or obstacle location? Two pieces of evidence
suggest that obstacle height information is relatively robust, while the lack
of on-line obstacle location information to modulate foot placement is the
reason why individuals fail in this seemingly simple task carried out in open
loop mode.
First evidence comes from examination of the types of errors that led to
failure. The graph below (Figure 5a) showing the diﬀerent error types shows
that a large proportion of failure occurs during the limb lowering phase. The
second piece of evidence comes from the comparison of the limb elevation for
the successful versus failure trials. Both the accuracy and precision of limb
elevation is similar for the successful and failure trials (Figure 5b). Therefore
limb elevation is appropriate, but where it occurs relative to the obstacle is
not correct. Thus poor foot placement in the approach phase is responsible
for the high failure rates.
As would be predicted, variability in foot placement when the task is per-
formed open-loop and results in failure is higher (Figure 5c). It is interesting
to see that even in open loop control the variability of foot placement is reg-
ulated as the individual approaches the obstacle. Thus previously acquired
visual information about obstacle location coupled with on-line kinesthetic in-
formation about limb movement can be used to tighten the foot placement as
one nears the obstacle. Clearly the reduction in variability of foot placement
in the absence of on-line visual information while possible is not suﬃcient:

Coupling Environmental Information from Visual System to Changes
289
the magnitude of reduction in foot placement variability is not suﬃcient to
compensate if the initial foot placement variability is very high. Thus on-line
visual information about obstacle location is necessary.
Previous research suggests how to extract obstacle height information
relatively easily (Sinai et al., 1998; Ooi et al., 2001. Sinai et al. (1998) have
shown that we use the ground surface as a reference frame for simplifying the
coding of an obstacle location, and use angle of declination below the horizon
to estimate absolute distance magnitude with the eye level as a reference (Ooi
et al., 2001). Obstacle height can be inferred from the diﬀerence in angle of
declination between the top and bottom edge of the obstacle, using the eye
level as a reference and assuming the obstacle is located on a continuous ter-
rain. Obstacles that are not anchored to the ground pose a challenge however
and probably need additional processing.
4.2
Avoiding collision with a moving/changing obstacle in the
travel path
During locomotion we often encounter potential obstacles that are moving
(vehicular or pedestrian traﬃc in the travel path) or changing in size and
shape. Common examples of obstacles that change shape and size include a
pet that decides to stand up as one is stepping over or sliding entrance doors
in department stores. Here the obstacle in the travel path is changing size
and shape independently. The individual has to extract appropriate infor-
mation about the dynamically changing environment and make appropriate
changes to their own movement to ensure safe travel. While we know a lot
about how locomotion is adapted to static environmental features, how and
when behavior changes are coupled to the changes in environment is not well
understood.
We focus on two experiments: in the ﬁrst experiment individuals were
required to avoid head-on collision with an object that was moving towards
them in the same travel path while in the second experiment individuals
were required to steer through gaps in the sliding doors, which oscillated at
diﬀerent frequencies.
Individuals are able to correctly estimate time-to-contact and implement
an appropriate response. This has been shown in interception tasks with the
upper limb (Savelsbergh et al., 1992; Watson and Jakobson, 1997; Port et al.,
1997). When self-motion information was manipulated either on a computer
screen (Delucia and Warren, 1994) or during a locomotor task (Bardy et al.,
1992), individuals timed their response accordingly. We wanted to study a
realistic simulation of head-on collision avoidance during a locomotor task.
Individuals were given no speciﬁc instructions: they were asked to avoid hit-
ting the object if it is in their travel path. The object, a life size manikin,
approached the person at diﬀerent velocities (2.2 m/s to 0.8 m/s) from the
opposite end of the travel path. The expected response was to change the di-
rection of locomotion and veer oﬀthe collision path. What we found was that

290
A. E. Patla, M. Cinelli, M. Greig
Fig. 5. (a) Collision error types; b) obstacle toe clearance and maximal toe elevation
for successful and failed trials; (c) foot placement consistency during successful (for
all conditions) and unsuccessful trials.

Coupling Environmental Information from Visual System to Changes
291
the time of initiation in change of travel path was independent of the veloc-
ity of the object, but the velocity of lateral displacement of the body center
of mass was modulated as a function of object velocity. Thus the subjects
were using vision to acquire action-relevant information and adapt their gait
patterns to avoid collision. Since there were no precise temporal constraints
on the individual’s response, the coupling between the changing environment
and changes in walking patterns were primarily guided by safety and initi-
ation of change was not modulated as a function of environmental changes
(Tresilian, 1999).
In the next study we increased the accuracy and precision demands of the
locomotor task by having individuals approach and go through sliding doors
that are continuously opening and closing. Montagne et al. (2002) used a vir-
tual reality set-up to investigate the changes in locomotor speed to pass safely
through the opening. The experimental set-up involved subjects walking on a
treadmill while viewing the virtually manipulated environment. They showed
that individuals modiﬁed their velocity of locomotion based on visual infor-
mation about the door oscillation frequency and amplitude, but because of
treadmill constraints subjects chose not to stop or slow down. Clearly the use
of a virtual reality environment inﬂuenced the outcome.
We used a physical set-up shown below (Figure 6a) and monitored the
person’s movement pattern to identify the responses when there were no
constraints on the subject’s response. We identiﬁed on-going changes to the
locomotor patterns as individual’s approached the oscillating doors (Figure
6b). The challenge to the individual was increased by varying the oscillating
speed of the doors.
Everyday behavior is controlled by a simple coupling between an action
and speciﬁc information picked up in optical ﬂow that is generated by that
action. Safe passage through a set of sliding doors requires individuals to
use information about the environment and their own body movement (ex-
propriospeciﬁc). In order to achieve this goal, individuals must try to keep
the rate of gap closure between them and the doors and that of the doors at a
constant rate. This action is known as tau coupling (Lee, 1998). Tau coupling
forces individuals to adjust their approach to the moving doors (controllable)
so that they can pass through the doors at an optimal point. This optimal
point is determined by the ﬁt between properties of the environment and
properties of the organism’s action system termed aﬀordance (Warren and
Whang, 1987).
Approach to the moving doors is the same as an approach to an object
in that it requires spatiotemporal information between the doors and the
moving observer. Time to Contact (TTC) is the concept that explains the
spatiotemporal relationship between an object and the point of observation.
In the case of moving doors, TTC will only tell the individuals when they will
reach the doors but will not tell the individuals what position the doors will be
in when they get there. Tau coupling data from this study were determined by

292
A. E. Patla, M. Cinelli, M. Greig
a)
b)
Fig. 6. a) Sliding door experimental setup; (b) coupling of speed of locomotion
with door opening.
subtracting the time when the peak door aperture occurred in the appropriate
cycle from the estimated time of arrival at the door. If this temporal diﬀerence
was zero, then the individuals have timed their arrival when the doors are
opened widest. This is the ideal coupling between the individual’s action and
changing environment, and provides the safest margin. Non-zero temporal
diﬀerence indicates arrival when either the doors are opening wide (positive
temporal diﬀerence representing earlier arrival with respect to maximum door
opening time) or closing in (negative temporal diﬀerence representing later
arrival with respect to maximum door opening time).
Reduction in magnitude of the temporal diﬀerence can be achieved by
modulating the velocity of progression: for positive temporal diﬀerence slow-
ing down is needed, whereas for the negative temporal diﬀerence, an increase
in speed of locomotion is required (Figure 6b). Clearly the margin for error is

Coupling Environmental Information from Visual System to Changes
293
dependent on the maximum door opening and opening and closing cycle time.
Smaller maximum door aperture and cycle time imposes tighter constraint
on the action: if it is not timed precisely within small temporal limits, safety
could be compromised. Thus this paradigm oﬀers a unique opportunity to
observe dynamic perception-action coupling during locomotion.
Typical proﬁles of from several trials for one individual from one of the
experiments are shown in Figure 6b. These proﬁles show both an increase and
decrease in speed of locomotion, depending on the trial, to time the arrival
at the door close to when the door is at its maximum. The adjustments in
speed of locomotion are gradual and occur during the approach phase and
are completed about 2s before arrival at the door. This funnel like control
seen in the proﬁle is similar to studies in upper limb control literature (cf.
Bootsma & Oudejans, 1993).
The overriding theme that emerges from the studies discussed so far is that
on-line visual information about the environment and self-motion is needed
to continuously modify and adapt walking patterns. So far control of action
is dependent on sensory information which speciﬁes the change needed. In
the next section we look at another common locomotor adaptation that is
not completely speciﬁed by the sensory input.
5
Avoiding stepping on a speciﬁc landing area in the
travel path
Path planning is an integral component of locomotion, and most often refers
to route plans to goals that are not visible from the start. The choice of a
particular travel path is dependent on a number of factors such as energy
cost (choosing the shorter of possible paths) and traversability (choosing a
path that has been selected and traversed by others). We consider this global
path planning. The focus here is on adjustments to gait that one routinely
makes to avoid stepping on or hitting undesirable surfaces, compromising
dynamic stability, possibly incurring injuries. These on-line adaptations to
gait termed local path planning include selection of alternate foot placement,
control of limb elevation, maintaining adequate head clearance and steering
control (Patla et al., 1989; 1991). We have been exploring the factors that
inﬂuence local path planning in several experiments and show that visual
input alone does not specify a unique action: other factors play a role in
decision making. The focus of the experiments was determining what guides
the selection of alternate foot placement during locomotion in a cluttered
environment.
Visual input alone in most cases is able to identify which area of the travel
surface to avoid, although in many cases prior experience and knowledge plays
an important role. For example, avoiding stepping on a banana peel is clearly
based on prior experience or knowledge that it can be a slippery surface.
For now we concentrate on the class and type of surfaces that are visually

294
A. E. Patla, M. Cinelli, M. Greig
determined to be undesirable to step on and an alternate foot placement is
required. While sensory input can tell you where not to step, it does not
specify where you should step. Our work (Patla et al., 1999) has shown that
the choices we make are not random, but systematic.
The ﬁrst critical observation from our work is that choice for the same
target area to be avoided is dependent on where in relation to the target area
one normally lands (see conditions ‘a’ and ‘b’ in Figure 7). This suggests that
visual input about the target area, shape and size is not enough: this has to
be coupled with prediction of where the foot in relation to the target (to
be avoided) would land. The latter has to be based on prediction from the
ongoing interaction between visual and propioceptive input. We believe that
this is done to predict the magnitude of the foot displacement that would
be needed for the diﬀerent choices such as stepping long, short, medial or
lateral. This is based on the second critical information from these studies: the
dominant alternate foot placement choices are the ones that require smallest
foot displacement from the normal landing spot among the possible choices.
This we have argued minimizes the eﬀort required to modify the normal step
pattern and possibly reduces metabolic cost.
If there is a unique single choice among the possible alternate foot place-
ment, the decision is simple, and is primarily based on available and predicted
sensory input. This would be relatively easy to implement in an algorithm.
The problem arises when more than one choice meets this criterion.
Fig. 7. Protocol and results from three conditions used by Patla et al., 1999.

Coupling Environmental Information from Visual System to Changes
295
When more than one possible foot placement choice satisﬁes this criterion,
sensory input alone is clearly not suﬃcient. See for example, the condition
‘c’ in Figure 7: stepping medial or lateral involves similar magnitude of foot
displacement from its normal landing spot. Despite that there is a dominant
choice of stepping medially. Here we have argued that the control system has
a set of hierarchical rules that guide the choice. These rules are based on func-
tional determinants of locomotion such as dynamic stability and maintenance
of travel in the intended direction.
For example, given a choice between stepping medial or lateral, step-
ping medial would minimize disturbance to balance but is dependent on step
length and situational constraints. When stepping medial or long result in
the same magnitude of foot displacement from the normal landing spot, step-
ping long is preferred since that ensures both dynamic stability and forward
progression. Our work has shown that individuals prefer choices that are in
the path of progression (stepping long or short versus stepping medial or
lateral). When there is choice between stepping long or short, they prefer
stepping long. Stepping medially (narrow) is preferred over stepping laterally
(wide). The relative weight given to the determinants is probably inﬂuenced
by any temporal constraints on the response (Moraes, Lewis & Patla, 2003).
A schematic decision tree guiding foot placement is shown in Figure 8. Clearly
such an algorithm would have to be built-in for a legged robot to safely tra-
verse a cluttered environment.
Fig. 8. Schematic of decision process for choosing a foot placement

296
A. E. Patla, M. Cinelli, M. Greig
6
Conclusions
In several studies we have attempted to focus on how and which visually
observable environmental features are extracted to control adaptive human
locomotion. These studies provide insights into possible algorithms for visual
control of biped robots.
Acknowledgements
This work was supported by a grant from Oﬃce of Naval Research, USA.
References
1. Bardy, B.G., Baumberger, B., Fluckiger, M. and Laurent, M. (1992). On the
role of global and local visual information in goal-directed walking. Acta Psy-
chologica (Amsterdam), 81(3):199-210.
2. Bootsma, R.J., Oudejans, R.R.D. (1993). Visual information about time-to-
collision between two objects. Journal of Experimental Psychology: Human
Perception and Performance, 19(5):1041-1052.
3. Brooks, R.A. (1989). A robot that walks: Emergent behavior from a carefully
evolved network. Neural Computation 1(2):253-262.
4. Delucia, P.R. and Warren, R. (1994). Pictorial and motion-based information
during active control of self-motion: Size arrival eﬀects on collision avoidance.
Journal of Experimental Psychology: Human Perception and Performance,
20:783-798.
5. Dickinson, M.H., Farley, C.T., Full, R.J., Koehl, M.A.R., Kram, R., Lehman,
S. (2000). How animals move: An integrative view. Science, 288:100-106.
6. Drew, T., Dubuc, R., Rossignol, S. (1986). Discharge patterns of reticulospinal
and other reticular neurons in chronic, unrestrained cats walking on a treadmill.
Journal of Neurophysiology, 55(2):375-401.
7. Gibson, J.J. and Crooks, L.E. (1938). A theoretical ﬁeld-analysis of automobile-
driving. American Journal of Psychology, 51:453-471.
8. Gibson, J.J. (1958). Visually controlled locomotion and visual orientation in
animals. British Journal of Psychology, 49:182-189.
9. Gibson J.J. (1979). The ecological approach to visual perception. Boston, MA:
Houghton Miﬄin.
10. Lee, DN. (1998). Guiding Movement by Coupling Taus: Ecological Psychology.
10(3-4): 221-250.
11. Lewis, M.A. & Sim, L.S. (1999). Elegant stepping: A model of visually triggered
gait adaptation. Connection Science, 11(3&4):331-344.
12. Liddell, E.G.T., & Phillips, C.G. (1944) Pyramidal section in the cat. Brain,
67:1-9
13. Marigold, D.S. and Patla, A.E. (2002). Strategies for dynamic stability during
locomotion on a slippery surface: eﬀects of prior experience and knowledge.
Journal of Neurophysiology, 88:339-353.

Coupling Environmental Information from Visual System to Changes
297
14. Marigold, D.S., Bethune, A.J. and Patla, A.E. (2003). Role of the unperturbed
limb and arms in the reactive recovery response to an unexpected slip during
locomotion. Journal of Neurophysiology, 89:1727-1737.
15. Milner A.D. & Goodale, M.A. (1993). Visual pathways to perception and ac-
tion. Progress in Brain Research, 95:317-337.
16. Mohagheghi, A.A., Moraes, R. and Patla, A.E. (2003). The eﬀects of distant
and on-line visual information on the control approach phase and step over an
obstacle during locomotion. Experimental Brain Research (in press).
17. Montagne, G., Buekers, M., De Rugy, A., Camachon, C. and Laurent, M.
(2002). The control of human locomotion under various task constraints. Ex-
perimental Brain Research, 143:133-136.
18. Moraes, R., Lews, M.A. and Patla, A.E. (2003). Strategies and determinants
for selection of alternate foot placement during human locomotion: inﬂuence of
spatial but not temporal constraints. Experimental Brain Research (accepted
pending revisions).
19. Ooi, T.J., Wu, B. and He, Z.J. (2001). Distance determined by the angular
declination below the horizon. Nature, 414:197-200.
20. Patla, A.E., Robinson, C., Samways, M., & Armstrong, C.J. (1989). Visual
control of step length during overground locomotion: Task-speciﬁc modulation
of the locomotion synergy. Journal of Experimental Psychology: Human Per-
ception and Performance, 15(3): 603-617.
21. Patla, A.E., Prentice, S., Robinson, C., & Neufeld, J. (1991). Visual control of
locomotion: Strategies for changing direction and for going over obstacles. Jour-
nal of Experimental Psychology: Human Perception and Performance, 17(3):
603-634.
22. Patla, A.E. and Rietdyk, S. (1993). Visual control of limb trajectory over obsta-
cles during locomotion: eﬀect of obstacle height and width. Gait and Posture,
1:45-60.
P
23. atla A.E. (1997). Understanding the roles of vision in the control of human
locomotion. Gait and Posture. 5:54-69.
24. Patla A.E. (1998). How is human gait controlled by vision? Ecological Psychol-
ogy (Invited peer-reviewed paper), 10 (3-4): 287-302.
25. Patla A.E., Prentice S.D., Rietdyk S., Allard F. and Martin C. (1999). What
guides the selection of foot placement during locomotion in humans.. Experi-
mental Brain Research, 128:441-450.
26. Patla, A.E., Niechwiej, E, Racco, V., Goodale, M.A., (2002). Understanding
the contribution of binocular vision to the control of adaptive locomotion. Ex-
perimental Brain Research, 142:551-561.
27. Patla, A.E., (2003). Gaze behaviours during adaptive human locomotion: In-
sights into the nature of visual information used to regulate locomotion. In:
Optic ﬂow and beyond. Edited by: L. Vania, S. Rushton, in press.
28. Patla, A.E., Davies, C., Niechweij, E. (2003). Obstacle avoidance during lo-
comotion using haptic information in normally sighted humans. Experimental
Brain Research (in press).
29. Port, N.L., Lee, D., Dassonville, P. and Gergopoulos, A.P. (1997). Manual in-
terception of moving targets: I. Performance and movement initiation. Experi-
mental Brain Research, 116(3):406-420.

298
A. E. Patla, M. Cinelli, M. Greig
30. Savelsbergh, G.J.P., Whiting, H.T.A., Burden, A.M. and Bartlett, R.M. (1992).
The role of predictive visual temporal information in the coordination of muscle
activity in catching. Experimental Brain Research, 89:223-228.
31. Sinai, M.J., Ooi, T.J. & He, Z.J. (1998). Terrain inﬂuences the accurate judge-
ment of distance. Nature, 395:497-500.
32. Sorensen, K.L. Hollands, M.A. and Patla A.E. (2002). The eﬀects of human
ankle muscle vibration on posture and balance during adaptive locomotion.
Experimental Brain Research, 143(1):24-34.
33. Tresilian, J.R. (1999). Visually timed action: time-out for “tau”? Trends in
Cognitive Sciences, 3:301-310.
34. Warren, W.H. Jr. and Whang, S. (1987). Visual guidance of walking through
apertures: body-scaled aﬀordances. Journal of experimental psychology. Human
perception and performance, 13(3):371-383
35. Watson, MK and Jakobson, L.S. (1997). Time to contact and the control of
manual prehension. Experimental Brain Research, 117(2):273-280.

