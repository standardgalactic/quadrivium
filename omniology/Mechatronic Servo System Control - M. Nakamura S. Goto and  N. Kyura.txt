
Lecture Notes
in Control and Information Sciences
300
Editors: M. Thoma · M. Morari

Springer
Berlin
Heidelberg
NewYork
Hong Kong
London
Milan
Paris
Tokyo

M. Nakamura  S. Goto  N. Kyura
Mechatronic
Servo System
Control
Problems in Industries
and their Theoretical Solutions
Translated by Tao Zhang
With 79 Figures and 21 Tables
1 3

Series Advisory Board
A. Bensoussan · P. Fleming · M.J. Grimble · P. Kokotovic ·
A.B. Kurzhanski · H. Kwakernaak · J.N. Tsitsiklis
Authors
Masatoshi Nakamura
Satoru Goto
Department of Advanced Systems
Department of Advanced Systems
Control Engineering
Control Engineering
Saga University
Saga University
Japan
Japan
Nobuhiro Kyura
Translator:
Department of Electrical and
Tao Zhang
Communication Engineering
Intelligent Systems Research Division
Kyushu School of Engineering
National Institute of Informatics
Kinki University
Japan
Japan
Translation from the Japanese edition
© Morikita Shuppan Co., Ltd. 1998
All Rights Reserved.
ISSN 0170-8643
ISBN 3-540-21096-2
Springer-Verlag Berlin Heidelberg New York
Library of Congress Control Number: 2004103117
This work is subject to copyright. All rights are reserved, whether the whole or part of the mate-
rial is concerned, speciﬁcally the rights of translation, reprinting, reuse of illustrations, recitation,
broadcasting, reproduction on microﬁlm or in other ways, and storage in data banks. Duplication
of this publication or parts thereof is permitted only under the provisions of the German Copyright
Law of September 9, 1965, in its current version, and permission for use must always be obtained
from Springer-Verlag. Violations are liable for prosecution under German Copyright Law.
Springer-Verlag is a part of Springer Science+Business Media
springeronline.com
© Springer-Verlag Berlin Heidelberg 2004
Printed in Germany
The use of general descriptive names, registered names, trademarks, etc. in this publication does
not imply, even in the absence of a speciﬁc statement, that such names are exempt from the relevant
protective laws and regulations and therefore free for general use.
Typesetting: Data conversion by the authors.
Final processing by PTP-Berlin Protago-TeX-Production GmbH, Berlin
Cover-Design: design & production GmbH, Heidelberg
Printed on acid-free paper
62/3020Yu - 5 4 3 2 1 0

From the Main Author
As a main author of Mechatronic Servo System Control (in Japanese), I would
like to express my thanks to Dr. Zhang Tao who translated our book into
English. The authors, myself, Dr. Goto and Prof. Kyura published the original
book which mainly consisted of the authors’ original research achievement
of mechatronic servo systems control during last over ten years. The original
book was fortunately awarded as the best book from the Society of Instrument
and Control Engineering (SICE in Japan) in 2001. Moreover, the book was
already translated into Korea language by a Korean publisher. As the authors
believe that our book is eﬀective for students and engineers who are involved
in the ﬁeld of Mechatronic Control and Robotics, we have been intended
the translation of it in English. The authors themselves made the Japanese-
English dictionary for the terminologies in the book, and ask to Dr. Zhang
Tao for the translation of the book by use of the dictionary. Dr. Zhang Tao
has completed the translation by use of his every night times during last
several months. I would like to show my great gratitude for his eﬀort for the
translation. I also express my great thanks to Prof. Jeﬀrey Johnson and Dr.
Mike Richards (Open University in UK) who helped the ﬁnal check of the
translation.
November 2002
Main author Masatoshi NAKAMURA

From the Translator
Since the term ”Mechatronics” was ﬁrst introduced by a Yaskawa Electric en-
gineer in 1969, and its rigorous deﬁnition was given by a technical committee,
i.e., The International Federation for the Theory of Machines and Mecha-
nism (IFToMM), as “Mechatronics is the synergistic combination of precision
mechanical engineering, electronic control, and systems thinking in design of
products and manufacturing processes”, the development of mechatronic tech-
niques has led to widespread adoption of electronics in machinery. At the same
time, as one of the key techniques of mechatronics, servo control system has
been well deﬁned for various kinds of mechanical system. At present, mecha-
tronic techniques are essential for advanced mechanical engineering. Further-
more, the introduction of servo control system design to engineers engaged in
mechanical engineering is thought to be indispensable.
As a researcher on mechatronic technique, when I ﬁrstly read the Japanese
version of this book ”Mechatronic Servo System Control”, written by Prof.
Nakamura, Dr. Goto and Prof. Kyura, I was attracted by its meticulous study
on the issues of mechatronic servo control system arising from mechanical en-
gineering as well as the signiﬁcance of application. Additionally, I aroused a
strong desire to transfer its valuable achievements to whole researchers and
engineers who are engaging in the mechatronic techniques or willing to ob-
tain knowledge related with mechatronic techniques. After I heard that this
book was awarded the 2001 Works Reward of The Society of Instrument and
Control Engineers (SICE), and Prof. Nakamura also had the same desire to
translate it into other languages for readers, I expressed my strong wish to be
responsible for translating this book into English. With deep trust and great
encouragement from Prof. Nakamura, I started this challenging project from
one year ago.
Through the great eﬀorts, the English version of ”Mechatronic Servo Con-
trol System” was ﬁnished recently. As I read the English version of this book
once again, I have also obtained great enlightenment from it, particularly for
my further research on mechatronic techniques. From the contents of this
book, I believe all readers will share the same feeling. The proﬁt of this book

VIII
From the Translator
will be reﬂected not only in the research or teaching on mechatronic tech-
niques, but also for engineers working on mechanical engineering.
Finally, I also want to express my great gratitude to Prof. Nakamura,
Dr. Goto and Prof. Kyura to distribute such a great valuable book on their
achievements within several decades of years to whole readers. For the kindly
help from Dr. D. Kushida during the period of my translation, especially
the valuable review of this book from Prof. Jeﬀrey Johnson and Dr. Mike
Richards, Open University, UK, I transfer my deep appreciate to them.
Because of my insuﬃciency of knowledge on translation between Japanese
and English, there might have some mistakes in this book. It will be very kind
if you can indicate them to me and I will make my best eﬀorts continuously
to improve them.
November 2002
Tao ZHANG

Preface
The editor and composer is engaging in the study on systems control and
their applications in university. As one of his research ﬁelds, with a plenty of
opportunities of discussion with Kyura, who is long-term working on the servo
controller design and its application in mechatronic industry, on the control
of mechatronic machine during the past ten years, the cooperative research
has been made greatly progress. These discussion meetings were held several
times once a year. Achievements on the items of these discussion meetings were
compiled into reports, each of which has between 50∼100 pages. Then, many
valuable commends were obtained from Kyura in terms of these achievements.
Moreover, new research directions were found. The distributions of co-authors
are that,
Kyura illustrated the issues on the control in the servo parts of an indus-
trial robot adopted in industry, numerical control working machine, three-
dimensional measurement machine, a mechatronic machine called a chip
mounter, etc.;
Nakamura explained these issues in systems control theory and formulized
the obtained crucial points of problem solution;
Goto made computer simulations for the solution of these problems as
well as veriﬁed the appropriation of these distinct theoretical results by us-
ing mechatronics-related experimental devices in the laboratory. In addition,
among the undergraduate students, master students, doctor students who
have interests in the control of mechatronic servo system, some items were
allocated to them and the relevant achievements were obtained by research
supervision. So far, about 60 conference presentations as well as 20 reviewed
papers on the mechatronic control have been completed.
Based on the above research story, the motivation of writing this book was
written down. Through the question answering in the conference for presenting
the obtained research achievement or dealing with the paper reviewers or the
conversation in the visiting the universities or research institutes which are
doing research on robot manipulator, we felt strongly that a lot of researchers

X
Preface
or engineers have many misunderstanding on the already solved problems in
industry.
In fact, according to the words of coauthor Kyura, the strategies for the
encountered problems in the servo controller design in industry depending on
the experience with trial errors of designers and engineers are just responding
to the demand of the world. These technologies have not become distinct in
the so-called know-how world. Since they are not logical strategies, even suc-
cessfully performing them, there are still many cases that the understandable
explanation can not be obtained. In industry, even the clariﬁcation of the un-
desired points was conducted concretely, the contents are not announced. It
is still in the present condition that why the good pursuit is hardly realized.
Through the collaboration, the essence of problems encountered in indus-
try was analyzed and formulized logically and mathematically. According to
the solution of derived equations and the veriﬁcation of justiﬁability of these
results, many useful items were obtained. At the present time, these items
are summarized systematically. The opaque technologies under the name of
know-how until now are explained distinctly. Therefore, many researchers or
engineers can know them widely and eﬀectively use them. These are the mo-
tivation of writing this book.
The problems discussed in this book are based on the common needs of
industries rather than the pending problem areas of one research engineer in
industry. The results for them, which were being caught empirically until now,
are clariﬁed logically. Therefore, the results are adapted for a real machine,
and various performances or control methods of controller design previously
determined with the experience of an expert can now are decided logically
based on the adopted results. Moreover, a know-how only suitable for special
situations until now, is changed into a more complicated and more ingenious
universal technology. This book is unique in handling these problems.
The organization of this book is that, the design of the servo controller of
mechatronic servo system is with respect to the ﬁelds of modeling, analysis and
controller design control. It is from the introduction to the following chapters
till 7.
In the introduction, the outline of mechatronic servo system and its main
points of the problem in industry are given.
In chapter 2, these problems are solved reasonably, which are the achieve-
ments of cooperative research of co-authors. In each chapter, main points are
attached.
The present conditions and problems in industry, main results, signiﬁcant
of results as well as the explanation of the main points of applications about
each item are conducted at the commencement of each chapter.
It is acceptable even if the reader reads this book from the beginning. For
the reader who wants to learn with the purpose of understanding, it is also
good to learn each section of one chapter for dealing with the problems which
are combined from the problems personally held and described in introduction.
In each section of each chapter, main points are inserted at the beginning of

Preface
XI
each section for recommending the text reading thoroughly. The contents of
each section are based on one of authors’ papers which is speciﬁed with the
quotation article number in the place of the bibliography list. Finally, the
book contains an index, a glossary of terms, a collection of symbols and a
description of the experimental devices used in our experiments.
During preparation, the book was read with distribution of sections of this
book by seven master students of department of advanced systems control and
engineering, graduate school of science and engineering, Saga university (Mr.
Shigeto Aoki, Mr. Tatsuro Katafuchi, Mr. Daisuke Kushida, Mr. Kenta Shira-
masa, Mr.Shojiro Yamagami, Mr. Masashi Tamura, Mr. Minoru Nishizawa).
Referring to their impressions of the book, the book was revised to improve
readability. The signiﬁcance of the problems took up it in this book and the ef-
forts are in making the essence of a problem to the formula appropriately. The
keys to solution of many formulas are the easily adopted basis of classical con-
trol (Laplace transformation) or modern control (diﬀerential equation) learnt
with the university bachelor degree, and the most fundamental knowledge in
the control theory explained in appendix. Therefore, not only the enterprise
directly related with system control or postgraduate students of university or
researchers, but also the undergraduate students with the purpose to make the
theory learnt in university into practice can be expected to read it widely. We
expect that the knowledge obtained from this book can be adopted widely in
mechatronic industries, and expect simultaneously that the research planted
the root in this kind of ground will be expanded at the research institute etc.
of an enterprise and, expecially and university.
At the end of the preface, since the materials of this book are all ob-
tained from the cooperative research, the conditions of cooperative research,
thoughts and feelings aroused from the cooperative research, are written as
below, though it may be redundant.
1. The cooperative researcher should be proﬁcient in each ﬁeld.
2. Keep frequent discussion for a long time among cooperative researchers.
3. Respect the views of the partner mutually.
4. Fine mutual human relations.
Concerning the writing of this book, Mr. Kojiro Kobayashi, Department
of production of the Morikita press, and Mr. Shoji Ishida, Department of
compilation of the Morikita press, took care of it very much. All my great
gratitude are here expressed.
October 1998
Editor-composer Masatoshi NAKAMURA

1
Outline of Mechatronic Servo Systems
The mechatronic servo system is the major theme studied in this book. In
particular, the servo system adopted in an electric servo motor is explained in
this chapter. Several items of its utilization from the development stage to the
present as well as its performances. The so-called mechanism machine (called
as mechatronic servo system at the following), i.e., the servo system adopted
in the numerical control machine or industrial robot, is generally diﬀerent
from the servo system introduced in the textbook of automatic control, which
is very important when discussing the mechatronic servo system.
Firstly, the control pattern assigned in mechatronic servo system is illus-
trated. The properties of current servo system satisfying the control pattern
and its utilization are introduced. Next, as the discussion items, the analysis
on mechatronic servo system and its utilization are carried out.
1.1 Emergence of Mechatronic Servo Systems
1.1.1 Control Pattern of Mechatronic Servo Systems
The mechatronic servo system, as the control system satisfying the motion
conditions of transfer axis of numerical control machine, was originally (about
1967) created when developing the DC servo motor. Then, in 1975 by Yaskawa
Electric, the velocity control equipment (servo driver unit) uniﬁed the compen-
sator of control system and power ampliﬁer was sold. Initially, it was mainly
adopted for the transfer axis control of working machine. From 1980, it was
also adopted for the position and velocity controls of various kinds of mecha-
nisms such as the industrial robot. At the generation of this mechatronic servo
system, the control pattern, as the start point of servo system construction,
is according to the following.
1. The velocity oﬀset for step-shape torque disturbance is below n[rpm] (gen-
erally below 1[rpm]).
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 1–15, 2004.
Springer-Verlag Berlin Heidelberg 2004

2
1 Outline of Mechatronic Servo Systems
2. The velocity control ratio is one to several thousands (minimum 1[rpm]
and maximum 3000–5000[rpm]).
3. The capability of power ampliﬁer is eﬀectively adopted (regulation time
is shortened from the rated current acceleration/deceleration adopted for
limited value).
Concerning the above three items, their necessity and signiﬁcant in appli-
cation are introduced respectively. In the transfer axis of a working machine,
the pattern is determined from the motion of installed in tools for cutting
or rotative cutting. There has the contact of the blades of these tools with
processed product and the load to transfer axis as entering tools is the motion
friction torque added constantly. When starting the process, there is negative
force of processing in the transfer axis installed in tools. Certainly, the degree
of negative force is diﬀerent from the processing state. The negative force con-
ducted at this time can be regarded as the step-shape torque load. This torque
load is added as the torque disturbance to motor in control system. Therefore,
at this time, the velocity oﬀset is appeared, and the error of processed shape
with designed shape is generated by the transfer axis. Hence, there exists the
phenomenon of unexpected velocity oﬀset due to torque disturbance.
The second item is necessary when a circular trajectory cannot be ap-
proximated by a polygon. In order to realize the circular trajectory, it is very
diﬃcult to accurately generate analogous sinusoidal or cosine instructions.
Therefore, when generating the circular trajectory, the straight-line command
approximating the circular trajectory by polygon is given with considering the
velocity for the two-axis servo system constructing a plane. In order to move
with constant speed along one edge of the polygon, two axes must move ac-
cording to the velocity ratio corresponding to the axis incline. At the edges
orthogonal between x axis and y axis, their velocity is inﬁnite. To understand
this case easily, the velocity command of driving system causing one axis mo-
tion should be needed from zero to inﬁnite in theory. In fact, the edge number
of approximated polygon is determined by the velocity control ratio of the
driving system which can actually be implemented.
The third item is required by operational eﬃciency and power ampliﬁer
economics. The operational eﬃciency is evaluated by the actual operation
time of the mechanism for an element, for example, the time of mechanism
motion from beginning to end. Therefore, the time without cutting by knife is
expected to be minimum. Moreover, a reduction in the time needed to reach
the constant speed (regulation time of speed) is also attempted. However,
it is not permitted to cost so much for this purpose. In general, the cost
of a power ampliﬁer is aﬀected greatly by its output voltage and permitted
maximal current. Thus, in the velocity control, it is required that the power
ampliﬁer is adopted with its maximal capability (allowance current) and the
acceleration/deceleration time is shortened.
The structure of a mechatronic servo system designed for satisfying these
performances is illustrated in Fig.1.1 for DC motor. As an aid to understand-

1.1 Emergence of Mechatronic Servo Systems
3
ing the ﬁgure, generally, the position control is designed as ratio control and
the velocity as well as current minor-loop in its inside is designed. Moreover,
in the structure of power ampliﬁer, PWM ampliﬁer is always adopted. The
carrier frequency of basic wave when using this PWM is from several to a few
dozens [kHz] is used.
The structure component of this mechatronic servo system is changed from
the original DC servo motor to an AC servo motor. Moreover, the controller
using position, velocity, current loop can be also changed into a software servo
system with a software algorithms using a micro processor, from the original
hardware computing ampliﬁer.
1.1.2 Characteristic of Servo System Applications
The emergence and structure of mechatronics have been brieﬂy introduced in
the former part. In order to understand that the usage of this mechatronic
servo system is diﬀerent from the general servo system, the main points are
listed as below.
1. In a mechatronic servo system, there are two types of control. One is po-
sition control (PTP: point to point) emphasizing the arriving time and
stop position from any position without considering the response route.
Another is the contour control (contouring or CP: continuous path) em-
phasizing the motion trajectory from the current position to the next
position (position at each moment and its motion velocity). These shapes
are shown in Fig.1.2. The former one is the robot arm for element assem-
bly, spot welding, etc, or used for the control of moving axis of mechanism
for drilling a hole. The latter one is the arm of welding robot, painting
robot, laser cutting robot, etc, or used for the control of transfer axis
of mechanism implementing any three-dimensional shape processing (ma-
chine center, etc).
2. In the contour control, the servo system, as a position control system,
requires strict velocity control for many kinds of response. Concerning
the robot for welding, the importance of velocity control can be easily
K
K (Ts+1)
T s
K (T s+1)
T  s
1
(T s+1)
K
K  s+1
1
L  s+R
K
1
J   s
1
s
1
N
1
N
K
1
J    s
1
s
D
p
i
i
a
a
1
o
a
a
τ
M
L
L
L
v
2
a
-
-
-
-
-
-
1
T  s+1
f
v
Ke
s
-
G
G
Position
control part
Position
controller
Velocity
control part
Velocity
controller
Current
controller
Current
control part
Velocity
filter
Axis
resonance
filter
Power
amplifier
Amplifier
part
Motor
Motor
electric term Torque
constant
Spring
constant
Mechanism
part
Gear
Gear
Fig. 1.1. Construction of position control system of one-axis mechatronic servo
system

4
1 Outline of Mechatronic Servo Systems
understood. In electric welding using an automatic welding machine, after
setting voltage and current, the motion velocity of the torch (the tool
spraying the ﬁne solvent continuously after turning on the voltage) is
determined according to the heat rate given along the curve of welding.
Therefore, the motion velocity of this torch is changing while the given
heat rate is also changing. If the over heat rate is thrown into, the mouth
of relevant part is opened and the appropriate welding which should be
with little given heat rate is impossible. In addition, for a painting robot,
if the motion velocity of painting can is changed, the spot of painting is
easily appeared. Besides, in the cutting operation of various materials,
keeping the constant cutting velocity can guarantee the cutting quality.
3. In the contour control, an overshoot in the position control system should
not occur. In many cases, velocity control system is also regulated so that
the overshoot cannot occur. In the various kinds of actual processes, the
generation of overshoot of position will cause fatal defect of shape. For
example, in the process of constructing a shaft, if an overshoot occurs,
the radius of the part becomes smaller, reducing the strength of this part.
Moreover, if the vibrated trajectory exists insuﬃciency of shape, it cannot
be revised at the later motion.
4. The objective command to servo system is obtained correctly before con-
trol in many cases. It can be said that, the element size, setting method,
etc, of operation object of robot or process object of working machine can
be completely known before starting the desired operation. In addition,
the motion velocity at this time is also deﬁnitely determined. Therefore,
the tract information necessary for motion is known before starting con-
trol. In addition, it can be supposed that external disturbance is mixed
into the control system. When the mixed disturbance over the supposi-
tion, concerning the safety of equipment, the motion of control system
should be stopped and the power source for driving should be isolated
P
P
P
i
i-1
i+1
x
y
0
Fig. 1.2. PTP control and CP control

1.1 Emergence of Mechatronic Servo Systems
5
as far as possible. That is to say, the motor must be selected from the
clearly discussed results on the necessary maximal torque for executing
operation. In addition, the size of continuously mixed disturbance must
be below the continuous rated torque of motor.
5. In many servo systems, a feedback system can be only established based
on the information of servo actuator, but not according to the information
of each moveable tip or motion tip. It means that, the detector of position
and velocity in the opposite load side of motor (side without load) is
installed and then the feedback system of actuator control is resembled
by the obtained information. This kind of control system is called a semi-
closed loop. Generally, it is very diﬃcult to construct the feedback system
by motion tip information in many mechanism machines. The structure of
a full-closed loop on the feedback of moveable tip information adopted in
some parts is shown in Fig.1.3. In addition, almost all mechanic structures
of industrial six-freedom degree robots are semi-closed loop. The relation
with servo actuator is brieﬂy shown in Fig.1.4. The structure of this kind
of semi-closed loop cannot be obtained in the mechatronic servo system as
same as the general feedback system. For taking into account the system
as same as the general feedback system, the condition is that the system
should be rigidly uniﬁed with the actuator when mechanism is within the
control region according to the desired motion command.
6. The actuator installed in the mechanism structured for multi-axis move-
able mechanism generally corresponds to the forward motion of one actua-
tor as well as rotation of one axis (freedom degree). The arbitrary curve in
three-dimensional space implemented by simultaneous control of multiple
axes is given in a servo system as the command of time function about
the position for desired motion in each independent axis. The precondi-
tion in control system is that axis is regarded as independence. In fact,
for example, in the case of a multi-axis robot arm, the reaction of one axis
motion aﬀects other axes, i.e., axis interference occurs. This axis interfer-
ence is very important when trying to minimize it in mechanism design.
Moreover, in a mechatronic servo system, when considering one axis, the
eﬀect from other axes due to its reaction is regarded as the disturbance.
Detector Actuator
Mechanism part
Upper controller
Servo driver
Fig. 1.3. Structure of industrial servo system

6
1 Outline of Mechatronic Servo Systems
Fig. 1.4. Structure of industrial robot and arrangement of actuator
And for reducing the eﬀect in control to a minimum, the motion of axis
should be changed as be capable of independence.
7. The generation of objective reference input for realizing mechanism move-
ment structured with a multi-axis mechanism is by the servo system in
which the independent motion of each axis including introduced machine
mechanism can be realized. The features of reference input is regulated for
keeping the consistence of each axis. In almost all cases, position control
system is regarded as a 1st order system. The feedforward gain should be
identical. If regulating like this, it is very easy to implement the algorithm
of reference input generation to a multi-axis servo system for any spatial
curve.
8. For realizing an arbitrary curve in three-dimensional space, in most of
cases, the curve is approximated by a folded line. As its results, the refer-
ence input to each axis servo system is renewed in each given coordinate
point and the ramp input with various slope angles is given continuously.
The velocity of each axis is calculated for making the given synthetic
velocity as a desired velocity. In addition, in the case of performing the
acceleration/deceleration control at start/stop point, the reference input
for simultaneous start/stop of all axes, i.e., same command to each axis
at acceleration/deceleration point, is generated.
9. The data regarded as objective reference input to servo system from the
upper control device, such as computer or special control, should be given
according to the designated period (designated time interval). Therefore,
the reference input for servo system is described with the form of a velocity

1.2 Issues in Mechatronic Servo Systems
7
command. Here, the period of this command or time interval is called as
the system clock of the servo system in the controller or servo data rate of
the controller. Since this reference time interval is selected based on the
property of the servo system dependent on the mechanism part structure
and related with the capability of control devise, its value represents the
synthetic performance of a machine. In the numerical control device of
a working machine, several [ms] as well as ten and several or several ten
times [ms] are adopted.
The knowledge of industrial expects cannot be understood deﬁnitely.
Therefore, so far, the theoretical analysis on the properties of the control
system structure, as well as the various properties of mechatronic servo sys-
tem taking into account its utilization, as above, cannot be found. For this
purpose, in this book, stepping on the utilization of mechatronic servo system,
various adopted control methods and realized control performances by these
methods are ﬁrstly discussed theoretically or arguably as the main point, and
then the discussion on the development in the future is added.
1.2 Issues in Mechatronic Servo Systems
In order to understand the current mechatronic servo system and develop
servo systems with better performance than at present, this servo system
must be investigated from various points of view. The discussion points are
listed as below.
1. Modeling of a mechatronic servo system
2. Performance of one axis in a mechatronic servo system
3. Performance of multiple axes in a mechatronic servo system
4. Command to servo system
The above viewpoints come from the system components of servo system
in theory. It means that a servo system is one of the system components for es-
tablishing a mechanism machine and needed to know that in which step servo
system can be thought as good enough so that the system is constructed eﬃ-
ciently, desired mechanism as well as performances is realized, etc. Therefore,
the description sequence of subsequent chapters is diﬀerent from the expla-
nation sequence in this chapter. Each section is divided by the items listed
above.
1.2.1 Discussion on Modeling of a Mechatronic Servo System
From the view of using the model of mechatronic servo system, this model
should be divided into two points. One is the model with the servo system not
only taking into account the mechanism structure but also the load. Another
is the model combining the modeled mechanism structure and servo system.

8
1 Outline of Mechatronic Servo Systems
For the mechanism performing orthogonal motion, various discussions can be
carried out only by the former modeling. But for the machine as an articulated
robot, the latter modeling is also necessary.
(1) Modeling of the Overall Mechatronic Servo System
In the mechatronic servo system adopted in any mechanism, such as a numeri-
cal control working machine, industrial robot, etc., representing the industrial
mechanism machine, the property of previous or present servo system can be
expressed by Kp. In general, the value of Kp is the high rigid of huge ma-
chine. In the general rotation plate, machine center, etc, the value of Kp is
35–40[1/s]. In an industrial robot, the value of Kp is 15[1/s]. It is naturally
the most simple approximation 1st order system in control system. However,
concerning the mechatronic servo system, it should be considered which con-
ditions must be satisﬁed in its internal structure, and additionally, it is nearly
not clear about the usage condition of this 1st order delay system. Actually, if
the maximal speed used in this machine is about 1/10 speed region, this ap-
proximation can model the whole system quite well. However, if it is number
for one speed, it will have big deviation with the actual system.
In analyzing the current servo system, the mechanism is thought to com-
bine with shaft of motor which is as rigid. Under this precondition, the servo
motor for a driving mechanism is selected. The control parameter regulation
of such a servo system is also following this consideration. Therefore, the 1st
order approximation with precondition is pursued to be clariﬁed[4]. However,
in fact, it is diﬃcult to satisfy this precondition due to various restraints.
High-speed and high-precision motion of mechatronics machines has been the
objective in recent years. For ﬁnding out the control strategy, it is required to
model control system correctly.
Concerning about this problem, it is explained in 2.1 and 2.2.
(2) Modeling of a Multi-Jointed Robot
Generally, in the multi-jointed industrial robot, orthogonal motion (in working
coordinate) data is generated by using coordinate calculation based on inverse
kinematics. By the servo system for joint angle control (in joint coordinate),
the motion can be realized in working coordinate system as the orthogonal co-
ordinate system. The inverse kinematics calculation of orthogonal coordinate
value is performed at each reference input time interval.
When given two points for performing orthogonal motion, with high-speed
motion, the phenomenon of deviation of several millimeters in the motion
trajectory of the line between two points is apparent. The motion velocity of
this time is about 1[m/s]. The reference input time interval of robot controller
is generally adopted with about 20[ms]. This velocity is lower than the velocity
of appearing centrifugal force rated with two times velocity for general issue
or collision rated with two axes velocity integral. Therefore, the trajectory

1.2 Issues in Mechatronic Servo Systems
9
deviation is diﬃcult to consider based on these eﬀects. But if lengthening the
reference input time interval or whether or not orthogonal motion happening,
several reasons should be considered.
When the velocity of present contour control is below 25[m/min], the tra-
jectory deviation does not occur. Therefore, in the control based on the previ-
ous position decision control concept, the trajectory precision can be required.
In the position decision control, the motion with the highest velocity allowed
by this robot can be performed in almost all cases. In the actual examples of
these kinds of application, such as hard-cutting, spot-welding, etc, the posi-
tion variation (trajectory precision) is several [mm]. Recently, the following is
also required.
In order to analyze the control strategy for satisfying these requirements,
the correct modeling for multi-jointed robot is needed. The relevant detail
description is given in section 2.3. The discussed modeling combining the
modeling of the whole servo system in the former part, the importance of
modeling control system in future mechanism machines is illustrated.
1.2.2 Discussion on the Performance of One Axis in a Mechatronic
Servo System
In a usual, mechatronic servo system consists of multi-axis mechanism. When
taking into account the performance of a mechanism machine, the analysis
on multi-axis servo system must be carried out. However, the structure for
this actuator is basically independent for one axis. For the basic feature of
a mechatronic servo system, the discussion based on the state of one axis
structure is suﬃcient.
Hence, there are two problems on discrete time interval when analyzing the
one axis performance of mechatronic servo system. One is that the structure of
current mechatronic servo systems are almost all software servo systems and
they must be thought of coming from the sampling control systems. Therefore,
the data renewal time interval of control system is determined by sampling
frequency. In general mechatronic servo system, there exist same delay time
and 0th order hold with this time interval. Therefore, this time interval greatly
aﬀects the characteristic of closed-loop control system.
Another is that, the upper controller seen from the servo system, i.e., the
computer using for internal trajectory calculation of the controller, is per-
formed in a time interval providing command given in the servo system. From
the relation between this time interval and performance of the control system,
the overall mechatronic servo system performance of a mechatronic machine
can be determined. From this point of view, the value of these discrete time
intervals are very important for analyzing the performance of a mechatronic
servo system.

10
1 Outline of Mechatronic Servo Systems
(1) Proper Sampling Frequency
In the middle of 1980s, microprocessor (CPU), i.e., digital signal processor
(DSP) became cheaper. These processors are equipped into closed-loop of
servo system. Hence, servo system is constructed and movement can be re-
markably ﬂexible. Software servo systems were developed.
These servo systems were developed in the laboratory belonging to one of
authors. From the experiments, an experience rule, was obtained. The eigen-
value of position control system using for a mechatronic machine based on the
realized software servo from the analogue velocity of a control device cannot
be over about 1/30 sampling frequency. Moreover, the velocity control system
is made by the software servo system and its inside can be found similar with
the analogue pattern.
The great diﬀerence here between the general sampling control system and
the control system used in the mechanism machine is the delay time. In the
usually equipped process control, comparing with the sampling time interval,
the consumed time for working out the state input and operation value can be
neglected. However, in the servo system of a mechanism machine, this cannot
be successful.
If the software servo system adopted in a mechanism machine is the object
of simulation, various unknown parts are closed up. How to set the property
of power ampliﬁer with PWM pattern, and how to catch the timing of state
input and the dynamic of operation output can be obtained.
In general, in a software servo system, a very big sampling frequency is
adopted. Namely, under the restraint of hardware cost, the maximal sampling
frequency is selected. In determining the sampling frequency by this way, the
performance boundary of the servo system when using this frequency is not
distinct. Even though expecting to raise its performance, which component of
control system should be improved is also unknown.
In section 3.1, the quite simple form of mechatronic servo system was ana-
lyzed. The relation between the performance of a control system and sampling
time interval when considering the utilization situation of a servo system was
clariﬁed.
(2) Reference Input Time Interval
When considering the characteristic of a mechatronic servo system as intro-
duced before, and regarding the loop structure of a control system about
actuator above investigation of servo system characteristic as the identical
important item with its controller design, how to provide the command to
servo system is a problem. This problem is about the form of time function of
command. The problem of command containing the way of data given must
be discussed.
In the discussion of this command system, with the current controller
structure, as the item about the control performance of a servo system, the

1.2 Issues in Mechatronic Servo Systems
11
time interval of given data to the servo system through the interface from the
upper controller is expected. Generally, in the controller of the mechanism
machine, the data to the servo system is given in a designated period. This
designated period is called the reference input time interval. This is also called
the (controller) system clock.
This reference input time interval is discrete width as the data to the servo
system. Within this interval, the command function of each axis is calculated.
Then, this calculated value is obtained in the servo system with the state of
zero order hold. From this, the motion of the servo system generates velocity
periodic variation relied on this time interval and trajectory deterioration.
Previously, the reference input time interval is obtained as the value rep-
resenting the controller performance. At present, in the newly developed con-
troller, this value has the trend to be minimal. However, dominated by the
development of the microprocessor, the desired performance is expected to
be realized without great cost. Therefore, the reasonable explanation of the
relationship between this reference input time interval and various generated
phenomenon is almost non-existent.
The competition of mechatronic product cost is rapidly increased. High
performance is required meanwhile keeping the current situation. In this sit-
uation, the performance of servo driver unit, the performance of the upper
controller (reference input time interval, etc) as well as the characteristic of
load are analyzed comprehensively. By taking these performances obtained
the balance when observing these performances respectively as the whole, it
is very important to realize these desired performances comprehensively. As
the ﬁrst stage for analyzing them, from the view of the servo system char-
acteristic of one axis, the discussion on the reference input time interval is
carried out in section 3.2 and 3.3.
(3) Quantization Error and Control Performance of Control
System
The structure of the software servo system was developed from only the po-
sition controller software to both velocity controller and current controller
software, from the development of utilized CPS, i.e., DSP. In the construction
of the control system, high response performance is generally required from its
internal minor-loop. In the electric servo system, current feedback loop is the
inner-most loop. How resolution of current detection is expected for satisfying
the required performance of servo system is an important item to discuss in
the stage of designing hardware constructing servo system.
As usual, although the control performances about the position and veloc-
ity of the servo system were clear, the theoretical equations for expressing the
design which the control performance must be satisﬁed about its internal is
unknown. In view of the concrete circuit structure, the discussion of the item
on quantization error is formulated. However, the analysis solution on various
internal parameters relation to the control system structure is very diﬃcult

12
1 Outline of Mechatronic Servo Systems
to solve. Its diﬃculty would be estimated by taking into account the equation
expression of power ampliﬁer of PWM pattern. From this point of view, in
almost all present cases, the quantization scale of control system internal, i.e.,
resolution is determined based on experience.
Here, for the current (torque) loop of the motor, the most internal loop
of mechatronic servo system, the relationship between the necessary perfor-
mance in the control system and the resolution of current detection part is
investigated. In order to clarify the main issue on considering the current
structure of the mechatronic servo system, the foreseen whole control system
is considered and the problems are formulated.
On these problems, is discussed in chapter 4, after analyzing the resolution
of position detection ﬁrstly in section 4.1, the torque resolution is investigated
in section 4.2. From the formulation illustrated here, the resolution of torque
command considering velocity variation ratio as a control performance is clear.
According to this result, the necessity of identical precision with the necessary
resolution in current detection is clear. Moreover, in the case of zero-zone of
power ampliﬁer, i.e., nonlinear characteristic, it is easy to evaluate that the
high resolution is necessary from the obtained results here.
1.2.3 Discussion on the Performance of a Multi-Axis Mechatronic
Servo System
The basic part of on discussion on mechatronic servo systems can be carried
out as a one-axis servo system. However, when investigating the performance
of mechanism machines, they must be investigated as multiple axes. The mo-
tion of multi-axis servo systems causing basic phenomena due to torque sat-
uration can be found. When using a servo system in the state of one axis,
there is almost no problem in the induced phenomenon due to torque sat-
uration from the servo system performance point of view. However, if this
phenomenon occurs in the multi-axis contour control, it will produce great
eﬀects on servo system performance. These problems are discussed in section
5.1 and 5.2.
(1) Torque Saturation
Generally, in mechatronic servo systems, the ratio of maximal torque that can
be used in rated torque and acceleration/deceleration is about 1:3∼5. In actual
servo systems, constant coulomb friction from motion resistance occupies a
big part of rated torque when the servo system is set into the mechanism. It
means that, the opposite force in operation is regarded as the torque load.
In order to allow these torques in the control system when performing the
movement along a straight line, their values are reduced remarkably. Hence,
in contour control, the servo system must guarantee the movement along the
straight line. When clarifying the application condition of the mechatronic
system, it must grasp that in which scale torque reaches saturation in the

1.2 Issues in Mechatronic Servo Systems
13
state of capable motion of the mechanism as well as in which degree control
performance deteriorates due to torque saturation.
The mechatronic servo system design should select a servo motor for the
driving mechanism in many cases except the stage of research. Therefore, in
servo motor selection, the velocity proﬁle (stage form) for driving is designed
and acceleration/deceleration as well as constant motion torque for designated
parameters (acceleration time, maximal velocity, etc) are calculated. In the
mechatronic servo system driven by the motor selected as above, it is almost
impossible to consider clearly the torque reﬂecting the actual adopted status.
In section 5.1, ﬁrstly, the measurement method of torque saturation is
shown. Based on this method, the torque saturation of the actual mechanism
with the diﬀerent statuses of a single motor can be known. Moreover, from
grasping the occurred phenomenon when existing torque saturation as in the
above illustration, the reason of actual phenomena can be deﬁnitely judged.
For avoiding torque saturation naturally, the actuator capable of exporting
torque with big capacity is needed to use. In reality, the correct motion is
more important than changing the application method. For this purpose, it is
necessary to know the simple avoidance method, which is discussed in section
5.2.
(2) Master-Slave Synchronous Positioning Control
The master-slave synchronous positioning control method is the control that
must satisfy the ratio relation between the movement of one axis and that
of another axis between two axes. This control is generated from the motion
performance required in the tapping process of the machining center. In the
tapping process, the 1st axis is the master axis of the machining center. This
axis is moving as the control system performing start and stop for stage form
driving installed in the rotational tools. The transfer axis as the second axis
should be traced, namely synchronized. So then it performs a parallel move-
ment as a position control part. When the tapper, a tool for standing tap
for rotation movement kept in the master axis, is rotated once, the transfer
axis must be moved correct one pitch of the spring. Since this correct motion
cannot be guaranteed, the tool called a soft-tapper is used to keep the tap-
per through the spring and the synchronous error of rotation and transfer is
absorbed.
However, since this soft-tapper is very expensive, for the decrease of run-
ning cost for tapping, high-precision master-slave synchronous positioning
control is demanded. In the middle of the 1980s, not only was the present
soft-tapper adopted, but also the general tapping process was realized. At
this time, the rotation times of master axis is from 3000 to 4000[rpm].
In order to improve production in the future, high-speed master axis ro-
tation number is demanded. For the relevant high-level spring, high-precision
master-slave synchronous positioning control is required as well. The relevant

14
1 Outline of Mechatronic Servo Systems
discussion is carried out in section 7.1. In addition, the possibility of adapt-
ing this master-slave synchronous positioning control in contour control is
explained in section 7.2.
1.2.4 Discussion on the Command of Mechatronic Servo Systems
For improving the motion performance of the whole mechatronic servo system,
the method for providing the command to the servo system at each moment
is a very important factor. It means that the ﬁnal desired motion of current
mechatronic servo systems should be approximated from the known informa-
tion before the beginning of control. As the precondition of use state of present
servo system, the revision method for the known command for realizing the
desired motion is analyzed in chapter 6.
(1) Modiﬁed Taught Data Method
The contour control for a three-dimensional curve in the present industrial
robot, the curve is approximated by a folded line. In the contour control, the
locus (position) as the form and its motion speed are the important control
parameters. As usual, the ramp input with a designated slope for each axis
as its command is introduced.
In such a kind of robot performing this control, when given three points
and angles are described by a line trajectory, at the corner part, the trajec-
tory deviates from the corner point depending on the velocity. Certainly, the
velocity is also decreased. For dealing with this kind of situation, skilled op-
erator of teaching is successfully carried out by given taught data varied from
the ﬁnal needed shape for eliminating the deviation from the corner point in
continuous motion. This method is illustrated concretely for realizing desired
motion by revising commands to servo system.
When approximating a robot arm by a 1st order delay system and assum-
ing it as an orthogonal coordinate robot, concerning the quite long straight
line, the theoretical explanation of this phenomenon realizing skilled operator
can be easily carried out. However, it is known that this method is almost im-
possible by the above formulation when it is adopted for the general multi-axis
mechatronic servo system.
In sections 6.1, 6.2 and 6.3, the solution of the method for improving the
eﬀective motion performance by the taught point which is a circular trajec-
tory but not linear trajectory, namely the composed trajectory is given. Here,
taking the taught point information as the desired ﬁnal robot motion, the
analysis solution for the issue, that how the taught point information is re-
vised to be given in a servo system so that the desired motion can be desired,
is illustrated. The ﬂowchart is expected to remember the solution whose roots
must be deﬁnitely used in a mechatronic servo system.
The command method adopted in this book is not only introduced in
this chapter, but also considered for the performance improvement of the

1.2 Issues in Mechatronic Servo Systems
15
future mechatronic servo system. The command method to the servo system,
considering the properties of mechanism, the features of disturbance size, the
features of process conditions, etc., is regarded as an important item similar
with the servo system characteristic improvement as the feedback loop.

2
Mathematical Model Construction of a
Mechatronic Servo System
In this chapter, from the view of servo controller design of mechatronic equip-
ment, such as an industrial robot, NC machine tool, chip mounter, etc, and
stepping on the action of a mechatronic servo system driven by the signals of a
power ampliﬁer, the4th order model expressing faithfully the action observed
from the appearance, the reduced order model simplifying the 4th order model
according to the action condition and the approximated linear 1st order model
in working coordinate are introduced.
These models are constructed for the characteristic analysis of mechatronic
servo system and the design of servo controller. The mechatronic systems
model introduced in this chapter are the basis of all analysis and design in
the following chapters. Each model is the general linear model in terms of
the form. In the deduction of this equation, the characteristics of the actual
mechatronic servo system can be expressed correctly with this simple equation
for the ﬁrst time, according to adopting appropriately the actual restriction
conditions of mechatronic servo systems of the industrial ﬁeld.
2.1 4th Order Model of One Axis in a Mechatronic
Servo System
In the determination of parameters of a mechatronic servo system controller,
such as position loop gain Kp, velocity loop gain Kv, etc, as well as in the
discussion of control strategies adopted in the controller; it is necessary to
construct a mathematical model expressing the action characteristic of mecha-
tronic servo system appropriately. In an industrial ﬁeld, determination of
parameters of the servo controller is mostly based on the empirical rule of
practician. There is no mathematical model comprehensively expressing the
mechatronic servo system including all mechanism parts, servo motor, servo
controller, etc.
Since the structure of mechatronic servo systems in industry is the high
order for expressing all factors, the 4th order model as (2.8), which retains
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 17–52, 2004.
Springer-Verlag Berlin Heidelberg 2004

18
2 Mathematical Model Construction of a Mechatronic Servo System
the necessary parts taking into account the servo properties in the general
mechanism by eliminating the unnecessary properties of the servo ampliﬁer
converter inverter, etc, from the view of servo controller design, is proposed.
This 4th order model correctly expresses the response characteristic of one
axis of a mechatronic servo system. In the mechatronic servo system with a
multi-axis structure, this 4th order model can be expressed by combining sev-
eral independent axes. For realizing the expected action characteristics of a
mechatronic servo system, the relation between the necessary servo parame-
ters (Kp, Kv) and natural angular frequency (ωL) of mechanism part, called
as empirical rule, is Kp ≤Kv/6. The appropriation of this equivalent relation
(cp = 0.24, cv = 0.82) can be theoretically shown in the 4th order model. In
addition, by using this mathematical model, the various control properties of
the mechatronic servo system can be analyzed and they can be adopted in
the design of the servo controller.
2.1.1 Mechatronic Servo Systems
(1) Structure of an Industrial Mechatronic Servo System
Fig. 2.1 illustrates the whole structure of a mechatronic servo system. As
shown in this ﬁgure, the industrial mechatronic servo system is the servo
system including the mechanism part, the servo motor driving axis included
in the mechanism part, the servo motor and the servo controller. In this
system, the management part managing the entire mechanism part and the
reference input generator are separated. The servo system of each axis is
constructed by the motor part , the power ampliﬁer part , the current
control part , the velocity control part and the position control part
and sensor (position detector, velocity detector, current detector) in order to
detect the signal from various parts, and connected with the mechanism part
by hardware.
...
Management
part
Reference
input
generator
Motor
Motor
Position
control part
Position
control part
Velocity
control part
Velocity
control part
Current
control part
Current
control part
Power
control part
Power
control part
Position signal
Position signal
Velocity signal
Velocity signal Current signal
Current signal
Reaction force
Reaction force
Mechanism
part
1
st axis 
n
th axis 
Fig. 2.1. Industrial mechatronic servo system structure

2.1 4th Order Model of One Axis in a Mechatronic Servo System
19
In an industrial mechatronic servo system, the servo system of each axis
is always controlled independently (refer to 1.1.2 item 6,7). Actually, the in-
terference or friction of each axis is diﬀerent according to the structure of
the mechanism part. Although it is possible to design an optimal servo con-
troller corresponding to the various mechanism, the cost of designing a servo
controller respectively for each mechanism became very high and hence the
implementation in industry is very diﬃcult. Therefore, for designing a servo
system which can be adopted, this servo system is combined into each axis
corresponding to the mechanism part. That is to say, in an industrial mecha-
tronic servo system, the discussion on servo system is carried out for only
one axis, because of the importance of the servo problem for each axis. If
this one axis problem can be solved, the general industrial mechatronic servo
system problem can be solved, when each axis of an industrial mechatronic
servo system is simply combined and the characteristic in joint coordinate can
be analyzed approximately by characteristic in working coordinate by using
nonlinear coordinate transform between the working coordinate and the joint
coordinate about articulated robot arm.
(2) Servo Controller of Industrial Mechatronic Servo System
The block diagram of servo system of each axis in a mechatronic servo system
is a 13th order or higher high-order system strictly illustrated in Fig. 1.1(refer
to item 1.1.2). From Fig. 1.1, the information of locus is not feedback in the
servo controller. From this 13th order model, the features of modeling from
the point of the servo controller of a mechatronic servo system is summarized
as [4]:
1. The power ampliﬁer can be obtained linearly when a big carrier frequency
is designed greatly;
2. The dead zone of the power ampliﬁer can be neglected;
3. The resonance frequency of axis torque of each axis motor is about 5∼8
times that of the natural frequency of the mechanism part and can be
neglected when eliminating axis resonance by an axis resonance ﬁlter;
4. The cut-oﬀfrequency of the velocity detection ﬁlter and axis resonance
ﬁlter can be neglected if it is higher than the natural frequency of the
whole mechatronic servo system;
5. The current control part is designed by considering the balance of the
electric features of motor;
6. The position detection is obtained by the logical calculation of two pulse
signals of the encoder and judgement of direction and increase/decrease.
The countering of the pulse without noise in the pulse counter is consid-
ered;
7. The delay in response can be neglected if the response velocity of velocity
detection is higher than the response velocity of the mechanism;
8. The torque disturbance is compensated in the integral (I) action of PI
controller of velocity loop.

20
2 Mathematical Model Construction of a Mechatronic Servo System
According to these characteristics, the original complex structure of indus-
trial mechatronic servo systems can be simpliﬁed using a simple mathematical
model in the contour control.
2.1.2 Mathematical Model Derivation of a Mechatronic Servo
System
(1) 4th Order Model of an Industrial Mechatronic Servo System
For combining the mechanism part of a mechatronic servo system and the
mechanical part of the motor, a two mass model is adopted[5, 6]. The two-
mass model is the model in which the inertial moment of the motor and the
inertial moment of the load are connected by a spring. The motion equation
in the motor side and the mechanism part side can be written as below, which
including the inertial moment of motor JM, the rotation angle θM, the inertial
moment JL of load in the mechanism part, the viscous friction coeﬃcient DL,
the whole spring constant KL with the gear for connecting the mechanism
part and motor axis, gear ratio NG and torque TM generated in the motor
side,
JM
d2θM(t)
dt2
= TM(t) −TL(t)
(2.1)
JL
d2θL(t)
dt2
= NGTL(t) −DL
dθL(t)
dt
(2.2)
TL(t) = KL (θM(t) −NGθL(t))
N 2
G
(2.3)
where TL(t) in (2.3) is the reaction force added on the motor side from the
mechanism part side. However, the friction of the motor itself is ignored be-
cause it is too small. When equations (2.1) and (2.2) are transformed by a
Laplace transform (refer to appendix A.1), the transfer function of the two
mass model is as
θM(s) = TM(s) −TL(s)
JMs2
(2.4)
θL(s) =
NG
JLs2 + DLsTL(s)
(2.5)
TL(s) = KL
N 2
G
(θM(s) −NGθL(s).
(2.6)
Concerning the servo controller side, from the features 3, 4, 5, 8 of an
industrial mechatronic servo system introduced in 2.1.1(2), the inﬂuence of the
axis resonance ﬁlter feature and velocity detection ﬁlter feature in Fig. 1.1 can
be neglected due to their slightness. When making the current loop transfer
function in the servo controller as one and the velocity controller is expressed
as P control, the transfer function of the servo controller and the electric part
of motor is changed as

2.1 4th Order Model of One Axis in a Mechatronic Servo System
21
K
J s
s
N
N
K
J    s
s
D
p
M
L
L
L
-
-
-
-
-
Kv
T
θ
U
L
L
g
G
G
1
1
1
1
1
1
Servo controller
2 mass model
Fig. 2.2. Block diagram of 4th order model of industrial mechatronic servo system
TM(s) = Kg
v[Kp{U(s) −θM(s)} −sθM(s)]
(2.7)
where TM(s) in equation (2.7) denotes the torque generated from the motor.
The ﬁrst item of (2.7) is the transfer function of the servo controller. The
second item expresses the inﬂuence of the reaction force TL(s). U(s) is the
angle input to the motor. Kp is position loop gain. Kg
v is velocity ampliﬁer
gain.
The transfer function from the angle input U(s) for the motor of the
whole mechatronic servo system to the angle output θL(s) of the load can be
written as below, when deriving the relation equation between U(s) and θL(s)
by eliminating θM(s), TL(s), TM(s) from four relation equation (2.4)∼(2.7)
with ﬁve variables U(s), θL(s), θM(s), TL(s), TM(s) (refer to Fig. 2.2).
G(s) =
a0
NG(s4 + a3s3 + a2s2 + a1s + a0)
(2.8)
a0 = KLKpKg
v
JLJM
a1 = KLKg
v
JLJM
+ DLKpKg
v
JLJM
+
DLKL
N 2
GJLJM
a2 = KL
JL
+ DLKg
v
JLJM
+ KpKg
v
JM
+
KL
N 2
GJM
a3 = DL
JL
+ Kg
v
JM
.
This 4th order model of a mechatronic servo system can be eﬀectively adopted
in the development of servo parameter determination or control strategy.
In the actual mechatronic servo system, for changing velocity controller as
PI controller, it is as shown strictly in the block diagram of Fig. 1.1. To this
controller, in the 4th order model of Fig. 2.2, velocity controller is expressed
by an equivalent P control. The integral (I) action in velocity controller in the
actual mechatronic servo system is performed for torque disturbance com-
pensation. The time shift of output response is nominated by the gain of P

22
2 Mathematical Model Construction of a Mechatronic Servo System
control. On above way, the ratio gain Ks
v of PI control in the general motion of
an actual system is not the velocity ampliﬁer gain Kg
v in the model of Fig. 2.2,
but is expressed by the ratio gain when PI Controller is equivalent to the P
control.
(2)
Normalized 4th Order Model for Servo Parameter
Determination
The parameters of the servo controller in the 4th order mode (2.8) are position
loop gain Kp and velocity ampliﬁer gain Kg
v. Concerning the velocity ampliﬁer
gain Kg
v, the total inertial moment transformed from the motor axis with a
rigid connection is assumed as
JT = JM + JL
N 2
G
.
(2.9)
Kv is deﬁned as the velocity loop gain by using this JT as
Kv = Kg
v
JT
.
(2.10)
This velocity loop gain is regarded as a servo parameter. Hence, position loop
gain Kp and velocity loop gain Kv has the same order for using later. In
addition, in equation (2.8), by viscous friction coeﬃcient DL, spring constant
KL and load moment of inertia JL, the natural angular frequency ωL and
damping factor ζL expressed by the features of mechanism part is written as
ωL =
D
KL
JL
(2.11a)
ζL =
DL
2√JLKL
.
(2.11b)
When expressing the general features of the mechanism part, for convenient
expression by natural angular frequency ωL and damping factor ζL with vis-
cous friction coeﬃcient DL and spring constant KL, ωL and ζL are adopted
as the parameters of the mechanism part.
The 4th order model derived in the last part is determined by the natural
angular frequency ωL and damping factor ζL as the features of the mecha-
nism part, as well as the servo parameter Kp, Kv. However, since the natural
angular frequency of the mechanism part has a strong dependence on its size
or mass, it is expected that the standard determination of servo parameters is
not based on the natural angular frequency of the mechanism part. Therefore,
the position loop gain Kp and velocity loop gain Kv are expressed as below
by using the natural angular frequency ωL of the mechanism part as
Kp = cpωL
(2.12a)
Kv = cvωL.
(2.12b)

2.1 4th Order Model of One Axis in a Mechatronic Servo System
23
It is the transformation of equation (2.8) using cp, cv in equation (2.12a) and
(2.12b). When we put equation (2.11b)∼(2.12b) into (2.8), the normalized 4th
order model without dependence on natural angular frequency ωL is derived
Gc(s) =
b0
NG(s4 + b3s3 + b2s2 + b1s + b0)
(2.13)
b0 = (1 + NL)cpcv
b1 = (1 + NL)(cv + 2cpcvζL) + 2NLζL
b2 = (1 + NL)(1 + 2cvζL + cpcv)
b3 = 2ζL + (1 + NL)cv
where
NL =
JL
N 2
GJM
(2.14)
is the ratio between the inertial moment and motor axis equivalent inertial
moment of the mechanism part. By using this normalized 4th order model
(2.13), the common discussion on the arbitrary natural angular frequency ωL
of the mechanism part can be carried out.
2.1.3 Determination Method of Servo Parameters Using a
Mathematical Model
(1) Control Performance Required in an Industrial Mechatronic
Servo System
The response characteristic of an industrial mechatronic servo system is re-
quired to have a fast response in the system within the region where there is
no generation of oscillation and overshoot (refer to 1.1.2 item 3). Previously,
the servo parameters are determined by satisfying the requirement based on
the test error or experience. The proper determination method can be derived
by a normalized 4th order model (2.15) here
In an industrial mechatronic servo system, the following conditions are
successful:
•
The motor is selected when the moment of inertia JM of the motor is
satisfying 3 ≤NL ≤10 from the moment of inertia JL of the mechanism
part and gear ratio;
•
The damping factor ζL of mechanism part is 0 ≤ζL ≤0.02.
For the latter condition, since the damping factor ζL is very small in an
industrial mechatronic servo system, then ζL = 0. However, ζL = 0 is existed
in the situation of continuous oscillation generation which is the most diﬃcult
to control. Then this assumption is suﬃcient for this situation. When put
ζL = 0 into equation (2.13), it can be as

24
2 Mathematical Model Construction of a Mechatronic Servo System
Gc(s) ≈
1
NG
$
s4
(1 + NL)cpcv
+ s3
cp
+ (1 + cpcv)s2
cpcv
+ s
cp
+ 1
).
(2.15)
From the current utilization of an industrial mechatronic servo system,
there are the following conditions for servo parameters determination satisfy-
ing the desired control performances
1. There are two real poles and one complex conjugate root in the normalized
4th order model (2.15) (condition A)
2. The response component of the complex conjugate root is smaller than
the response component of the principal root (condition B).
3. The response component of the complex conjugate root is more quickly
converged than the response component of the principal root (condition
C).
4. If satisfying the above three conditions, the servo parameters Kp, Kv can
be determined for a faster response.
(2) Ramp Response of the Normalized 4th Order Model
For determining the servo parameters satisfying the required control perfor-
mance introduced in 2.1.3(1), the ramp response of the normalized 4th order
model (2.15) should be worked out. The reason for using a ramp response is
that, the ramp input can be adopted in each axis of an industrial mechatronic
servo system in almost all contour control (refer to 1.1.2 item 8).
For the ramp response of the normalized 4th order model, ramp input is
u(t) = vt. From condition A, there are given two poles as −τ1, −τ2 (τ1 < τ2)
and one complex conjugate root −σ + jρ, −σ −jρ, and the ramp response is
calculated as (refer to appendix A.2)
y4(t) =
5
t −K0 + K1e−τ1t + K2e−τ2t
+ K3e−σt sin(ρt + 2φ1 −φ2 −φ3)
<
v
(2.16)
K0 = (τ1 + τ2)(σ2 + ρ2) + 2στ1τ2
τ1τ2(σ2 + ρ2)
K1 =
τ2(σ2 + ρ2)
τ1(τ2 −τ1)(τ2
1 −2στ1 + σ2 + ρ2)
K2 =
τ1(σ2 + ρ2)
τ2(τ1 −τ2)(τ2
2 −2στ2 + σ2 + ρ2)
K3 =
τ1τ2
ρ
C
((τ1 −σ)2 + ρ2)((τ2 −σ)2 + ρ2)
where φ1 = tan−1(ρ/σ), φ2 = tan−1(ρ/(τ1 −σ)), φ3 = tan−1(ρ/(τ2 −σ)),
K0 steady-state velocity deviation of the 4th order model, K1, K2 response
component of two real poles, K3 response component of complex conjugate
root.

2.1 4th Order Model of One Axis in a Mechatronic Servo System
25
(3) Relation between Servo Parameters and Characteristic Root
By using the ramp response of the normalized 4th order model, the relation
between servo parameters and characteristic root is investigated. The moment
of inertia ratio is given as NL = 3, whose value is always adopted in industrial
mechatronic servo systems.
The region of cp and cv satisfying conditions A, B, C is illustrated in
Fig. 2.3(a),(b),(c), respectively. Fig. 2.3(d) shows the equivalent height line
about the region of cp and cv satisfying conditions A, B, C and principal root
τ1. When the region of the response component of the complex conjugate root
of condition B is very small,
K3
K1
≤0.1
(2.17)
is given. When the region of the response component of the complex conjugate
root of condition C is converged quickly
σ
τ1
≥2.0
(2.18)
is given.
For reference, the calculated ratio of the response component K1 of prin-
cipal root when changing parameters cp and cv, and response component K3
of the complex conjugate root is shown in Fig. 2.4(a). The calculated ratio of
the principal root −τ1 and the real part −σ of the complex conjugate root
0.5
1
1.5
2
0.1
0.2
0.3
0.4
0.5
Cv
Cp
A
0.5
1
1.5
2
0.1
0.2
0.3
0.4
0.5
Cv
Cp
B
(a) Condition A
(b) Condition B
0.5
1
1.5
2
0.1
0.2
0.3
0.4
0.5
Cv
Cp
C
0.5
1
1.5
2
0.1
0.2
0.3
0.4
0.5
Cv
Cp
A∩B∩C
0.82
0.24
τ1=-0.1
τ1=-0.2
τ1=-0.3
τ1=-0.492
τ1=-0.6
τ1=-0.7
τ1=-0.4
(c) Condition C
(d) Condition ABC
Fig. 2.3. Relation of cp and cv for various conditions

26
2 Mathematical Model Construction of a Mechatronic Servo System
0.1
0.2
0.3
0
0.05
0.1
0.15
Cv=0.4
Cv=0.6
Cv=0.9
Cv=0.8
Cv=1.2
Cv=1.4
Cv=1.6
Cv=1.8
Cv=2.0
K3/K1
Cp
Cv=0.82
0.1
0.2
0.3
0
1
2
3
4
5
Cv=0.4
Cv=0.6
Cv=0.8
Cv=0.9
Cv=1.2
Cv=1.4
Cv=1.6
Cv=1.8
Cv=2.0
Cp
σ/τ1
Cv=0.82
(a) Relation of K3/K1 and cp
(b) Relation of σ/τ1 and cp
Fig. 2.4. Relation of various parameters for various cv
is shown in Fig. 2.4(b). From Fig.(a), when cv is ﬁxed and cp is increased,
K3/K1 becomes big. That is, the response component of the complex conju-
gate root cannot be neglected. In Fig.(b), when cv is ﬁxed and cp is increased,
σ/τ1 becomes small. That is, the declination of the response component of
complex conjugate root is delayed.
(4) Determination Method of Servo Parameters Based on Control
Performance
From the servo parameter determination conditions of 2.1.3(1), the servo pa-
rameters cp and cv are determined in order to obtain the fast response when
satisfying equation (2.17) in 2.1.3(3) and equation (2.18), i.e., the principal
root τ1 is small.
According to the equivalent height line of principal root τ1 shown in
Fig. 2.3(d), when the servo parameters are cp = 0.24 and cv = 0.82, the
minimal value is τ1 = −0.492. This is the general result which is not de-
pendent on the natural angular frequency ωL of the mechanism part in the
normalized 4th order model (2.15).
In order to verify the obtained servo parameter results, the results of ramp
response calculated by equation (2.16) are illustrated in Fig. 2.5. Fig.(a) shows
the results when NL = 3. Fig.(b) shows the results when NL = 10. In the com-
mon velocity response of Fig.(a) and Fig.(b), the conditions of faster response
in the region of no oscillation or overshoot generation are cp = 0.24 and
cv = 0.82. In addition, by comparing the results of Fig.(a) and Fig.(b), the
position and velocity are almost the same. With the general industrial ﬁeld
condition 3 ≤NL ≤10, the conditions of faster response in velocity response
without oscillation or overshoot generation are cp = 0.24 and cv = 0.82.
From these results, the servo parameters Kp, Kv are calculated by the
natural angular frequency ωL of the mechanism in experiment. In equation
(2.12a) and (2.12b)
cp = 0.24
(2.19a)
cv = 0.82
(2.19b)

2.1 4th Order Model of One Axis in a Mechatronic Servo System
27
0.92
0.94
0.96
0.98
1
Cp=0.24, Cv=0.82
Cp=0.3, Cv=0.82
Cp=0.2, Cv=0.82
Cp=0.24, Cv=1.2
Cp=0.24, Cv=0.7
Objective trajectory
Position[1]
55
60
65
0
0.01
0.02
Velocity[1/s]
Time[s]
0.92
0.94
0.96
0.98
1
Cp=0.24, Cv=0.82
Cp=0.3, Cv=0.82
Cp=0.2, Cv=0.82
Cp=0.24, Cv=1.2
Cp=0.24, Cv=0.7
Objective trajectory
Position[1]
55
60
65
0
0.01
0.02
Velocity[1/s]
Time[s]
(a) NL = 3
(b) NL = 10
Fig. 2.5. Simulation results of normalized 4th order model as equation (2.15) with
various cpandcv cp = 0.24, cv = 0.82; cp = 0.3, cv = 0.82; cp = 0.2, cv = 0.82;
cp = 0.24, cv = 1.2; cp = 0.24, cv = 0.7, (a) NL = 3, (b) NL = 10.
are given. The regulation of a mechatronic servo system, for fast response
without oscillation or overshoot, can be carried out.
2.1.4 Experiment Veriﬁcation of the Mathematical Model
(1) Simulation and Experiment
The appropriation of the determination method for the servo parameter of
industrial mechatronic servo system, derived in the former part, is veriﬁed
by the experiment of DEC-1 (refer to experiment device E.1). The sampling
time interval of the experiment is given as 1[ms] (refer to 3.1). The value of
position loop gain Kp can be changed in the computer program. The value
of velocity loop gain Kv needs the equivalent value when Ks
v in Fig. 1.1 is
adjusted by altering the variable resistance. The concrete method is that,
when the position loop is at the outside and the step signal of velocity is
given, the time constant corresponding to this response wave is worked out
and Kv is calculated by its inverse value. When changing the value of variable
resistance, the variable resistance, as the regulation value, which is consistent
with the determined Kv value by the above experiment with the method of
2.1.3(4), is adopted. With this method, the ratio gain Ks
v of the PI controller
of the actual velocity controller, corresponding to the optimal gain Kv of P
controller of velocity control in the 4th order model, can also be worked out.
The motion velocity of the mechatronic servo system serves as the op-
eration velocity in the general industrial ﬁeld. With about 1/10 of motor
rated speed u(t) = 10t[rad/s] as well as two conditions (a) Kp=22.6[1/s],

28
2 Mathematical Model Construction of a Mechatronic Servo System
0
5
10
Position[rad]
Objective trajectory
Simulation
Experiment
0
1
2
0
5
10
Time[s]
Velocity[rad/s]
0
0.5
1
1.5
8.5
9
9.5
10
x[rad]
y[rad]
Objective locus
Simulation
Experiment
(a) Kp=22.6[1/s], Kv=77.24[1/s]
0
5
10
Position[rad]
Objective trajectory
Simulation
Experiment
0
1
2
0
5
10
Time[s]
Velocity[rad/s]
0
0.5
1
1.5
8.5
9
9.5
10
x[rad]
y[rad]
Objective locus
Simulation
Experiment
(b) Kp=50[1/s], Kv=50[1/s]
Fig. 2.6. Experimental results by using DEC-1 experiment device and comparison
with simulation results by using 4th order model
Kv=77.24[1/s], (b) Kp=50[1/s], the experiment was carried out. Condition (a)
is the appropriate servo parameter calculated by putting cp = 0.24, cv = 0.82
and ωL = 94.2[rad/s] into equation (2.12a) and (2.12b). Condition (b) is the
deviation of the servo parameter from the proper value. These experimental
results and simulation results are illustrated in Fig. 2.6. However, for grasping
visually the inﬂuence given to contour control performance, Fig. 2.6 shows the
expansion graph of the angular part of the contour control results when same
experimental results were used twice for the positions of the x axis and the y
axis.
For proper servo parameters and servo parameters complete with errors,
the simulation results based on the 4th order model of a mechatronic servo
system are almost identical to the actual experimental results. Therefore, it
veriﬁed that the 4th order model is the correct expression of the dynamic
characteristic of an industrial mechatronic servo system. The validation of

2.2 Reduced Order Model of One Axis in a Mechatronic Servo System
29
adaptation of the 4th order model in the design of a servo controller is also
shown.
Moreover, in the simulation and experimental result of condition (a), the
desired response characteristics without oscillation or overshoot at all in both
position response and velocity response is illustrated. However, in condition
(b), the position response is near to the objective trajectory comparing with
that of (a). But oscillation is generated both in the position response and ve-
locity response. Additionally, in contour control, the overshoot has occurred
and the control performance has deteriorated. Since this overshoot must be
avoided in the contour control in the industrial ﬁeld, this condition cannot be
adopted in the contour control. Based on the above explanation, the eﬀective-
ness of the proposed determination method of servo parameter was veriﬁed
by experimental results.
In an industrial mechatronic servo system, for regulating each axis charac-
teristic with consistence, this method is adapted for all axes of the mechatronic
servo system and the high-precision contour control of industrial mechatronic
servo systems can be realized.
2.2 Reduced Order Model of One Axis in a Mechatronic
Servo System
The expression of a mechatronic servo system by a reduced order model cor-
responding to the movement velocity condition is desired from the simple
controller design.
According to the 4th order model, the model approximation error is deﬁned
and the linear 1st order equation (2.23) and the linear 2nd order equation
(2.29) are constructed. The relation between the model parameters of the 4th
order model and the model parameters of the reduced order model is given in
equations (2.24), (2.30) and (2.37).
The 1st order model for expressing the low speed operation of the mecha-
tronic servo system (velocity below 1/20 rated speed) and the 2nd order model
for expressing the middle speed operation (velocity below 1/5 rated speed)
trace the experience of one of the authors. The signiﬁcance of these reduced
order models has been proved. The eﬀective usage of the model for servo
controller design is also veriﬁed by example.
2.2.1 Necessary Conditions of the Reduced Order Model
As introduced in section 2.1, one axis of mechatronic servo system is con-
structed by many blocks (parts). These blocks (parts) have respectively at
least one or two order transfer functions. From block diagrams expressing cor-
rectly these blocks, it is very diﬃcult to grasp quickly and entirely the features
of the servo system. In an industrial ﬁeld, these mechatronic servo systems

30
2 Mathematical Model Construction of a Mechatronic Servo System
are previously regarded as a simple 1st order system (refer to 1.2.1(1)). How-
ever, since these are the approximated judgment from the movement of the
mechatronic servo system, it is hard to say that this possesses the distinctly
theoretical ground.
In this section, considering the selection method of the servo motor ﬁrstly,
the necessity of the reduced order model of the mechatronic servo system is
arranged as below.
1. In the mechanism part determined from the operation purpose (the fea-
tures of mechanism part are expressed by natural angular frequency and
damping rate), the servo motor is set up according to the motor selection
method [8]. When controlling this servo motor by the servo controller, the
actual mechanism is established according to the whole features of the
servo system and the entire servo system is known before regulation.
2. For understanding the entire features, the exchange of the mechanism part
is needed and also the revision of motor selection should be judged.
3. From this feature, it should judge how long to follow the current as-
sumed operation pattern (Generally, trapezoidal wave of velocity is always
adopted in the positioning control).
4. In the contour control, the trace of actual trajectory in term of command
should be judged and the proper action should be brieﬂy known.
Next, the important factors in the reduced order model are listed below.
1. The features of the main structure blocks of the mechatronic servo system
(such as natural angular frequency of the mechanism part, properties of
damping rate and motor, etc) should be reﬂected.
2. The general regulation condition of the servo system (overshoot is not
absolutely generated not only in the position loop but also in the velocity
loop) should be reﬂected.
3. The action conditions of the servo system (e.g., the instruction is the ramp
input of each independent axis, the trajectory speed in the contour control
is below 1/5 of maximum velocity, etc) should be reﬂected.
4. The reduced order is adopted for modeling and one model can be used for
one action status.
The reduced order model of mechatronic servo systems satisfying the above
conditions is the 1st order model in low speed contour control, i.e., the charac-
teristic parameter is only Kp1; the 2nd order model in middle contour control,
i.e., the characteristic parameters are Kp2, Kv2. The detailed explanation is
as below.
2.2.2 Structure Standard of Model
With the 4th order model (2.13) as standard, for the contour control of indus-
trial mechatronic servo systems, low speed 1st order model expressing properly

2.2 Reduced Order Model of One Axis in a Mechatronic Servo System
31
the 1/20 of rated speed and middle speed 2nd order model expressing prop-
erly the system with the speed from 1/20 of rated speed to 1/5 of rated speed
are constructed. Concerning the above velocities, from the nonlinear feature
in the control system, especially the eﬀect of torque saturation, modeling is
very complicated. Moreover, from this nonlinear feature, if the contour control
cannot be carried out for position determination, modeling is not needed for
contour control.
The structure standard of the reduced order model is determined by the
following conditions based on the 4th order model expressing by equation
(2.13).
1. The steady-state velocity deviation between the 4th order model and the
reduced order model are consistent.
2. The oscillation does not occur in the ramp response of the reduced order
model.
3. The squared integral of the ramp response error between the 4th order
model and the reduced order model is minimized.
Regarding the ramp response as standard is to agree with the actual appli-
cation that in the contour control in industrial applications there are many
kinds of motion with a constant trajectory velocity.
2.2.3 Derivation of Low Speed 1st Order Model
With the movement velocity smaller than 1/20 of rated speed, the low speed
1st order model expressing properly the industrial mechatronic servo system
can be derived. This low speed 1st order model is expressed as a 1st order
system. In the mechanism part, the inertial moment of the load is trans-
formed into the motor axis. Considering both the whole inertial moment of
the mechatronic servo system and the electric characteristic of the servo mo-
tor, the whole mechatronic servo system is as
dy(t)
dt
= −cp1{y(t) −u(t)}
(2.20)
and its model expressed by transfer function is as
Gc1(s) =
cp1
s + cp1
(2.21)
where the relation of parameter cp1 and the position loop gain Kp1 of the low
speed 1st order model (refer to Fig. 2.7) is as
Kp1 = cp1ωL.
(2.22)
The low speed 1st order model as equation (2.21) is the model independent
of the load natural angular frequency ωL, as similar with the normalized 4th
order model as equation (2.13). That is, if given the natural angular frequency

32
2 Mathematical Model Construction of a Mechatronic Servo System
ωL, the low speed 1st order model can be derived corresponding to the ωL of
equation (2.21), (2.22). The transfer function G1(s) of the low speed 1st order
model without normalization by using position loop gain Kp1 is as
G1(s) =
Kp1
s + Kp1
.
(2.23)
When equation (2.22) is put into equation (2.21), the form is changed by
revising sωL with s. That is, the scale of time axis is transformed from t/ωL
to t.
The parameter cp1 in the low speed 1st order model (2.21) can be derived
with the condition 1 of 2.2.2 and for agreement with the steady-state velocity
deviation as
cp1 = b0
b1
≈cp,
(2.24)
Here, the ﬁnal approximation equation in (2.24) is the results approximated
with ζL ≈0 for very small damping rate from 0 to 0.02 of the mechanism
part in the industrial mechatronic servo system. When given cp = 0.24 in the
mechatronic servo system regulated properly, cp1 = 0.24 is better to be given
for approximation of equation (2.24).
2.2.4 Derivation of the Middle Speed 2nd Order Model
Next, the middle speed 2nd order model expressing properly the industrial
mechatronic servo system from 1/20 to 1/5 of rated speed can be derived. This
middle speed 2nd order model is the 2nd order system. The whole mechatronic
servo system is as
d2y(t)
dt2
= −cv2
dy(t)
dt
−cp2cv2y(t) + cp2cv2u(t)
(2.25)
and the model expressing by transfer function is as
Gc2(s) =
cv2cp2
s2 + cv2s + cv2cp2
.
(2.26)
U(s)
-
K p1
+
Y(s)
1-
s
Mechatronic servo system
Servo
controller
Motor and
mechanism part
Position loop
Fig. 2.7. Low speed 1st order model of industrial mechatronic servo system

2.2 Reduced Order Model of One Axis in a Mechatronic Servo System
33
U(s)
-
-
K p2
K
+
+
v2
Y(s)
1-
s
1-
s
Mechatronic servo system
Servo controller  
Motor and
mechanism part
Position loop
Velocity loop
Fig. 2.8. Middle speed 2nd order model of industrial mechatronic servo system
Here, the relationship between the parameter cp2, cv2, position loop gain Kp2
and velocity loop gain Kv2 of the middle speed 2nd order model (refer to
Fig. 2.8) are as
Kp2 = cp2ωL
(2.27)
Kv2 = cv2ωL.
(2.28)
That is, if given the natural angular frequency ωL, the middle speed 2nd
order model corresponding to the ωL in equation (2.26), (2.27) and (2.28) can
be derived. As same as the low speed 1st order model, the transfer function
G2(s) of the middle speed 2nd order model without normalization by using
position loop gain Kp2 and velocity loop gain Kv2 is as
G2(s) =
Kv2Kp2
s2 + Kv2s + Kv2Kp2
.
(2.29)
From the condition 1 of item 2.2.2 and for agreement with the steady-
state velocity error, the parameter cp2 and cv2 in middle speed 2nd order
model (2.26) is as
cp2 = b0
b1
≈cp.
(2.30)
Next, analyzing conditions 2 and 3 in item 2.2.2, the squared integral of the
model output error between the normalized 4th order model and the middle
speed 2nd order model is derived.
If the 2nd order model (2.26) is expressed as
Gc2 =
ω2
2
s2 + 2ζ2ω2s + ω2
2
(2.31)
cp2 = ω2
2ζ2
cv2 = 2ζ2ω2
from the condition 2 of item 2.2.2, the condition of no oscillation generation in
the response of the 2nd order model is ﬁrstly considered as ζ2 > 1 for satisfying

34
2 Mathematical Model Construction of a Mechatronic Servo System
ζ2 ≥1. When ζ2 > 1, i.e., there are two real poles p1, p2, the response of the
2nd order model is as below with the ramp input u = vt from equation (2.26).
y2(t) =
4
t −2ζ2
ω2
+
(ζ2 −
C
ζ2
2 −1)ep1t
2ω2(1 −ζ2
2 −ζ2
C
ζ2
2 −1)
+
(ζ2 +
C
ζ2
2 −1)ep2t
2ω2(1 −ζ2
2 + ζ2
C
ζ2
2 −1)
;
v
(2.32)
where, p1 = −(ζ2 +
C
ζ2
2 −1)ω2 and p2 = −(ζ2 −
C
ζ2
2 −1)ω2. When we
put K0(= b1/b0) = 2ζ2/ω2(= 1/cp2), which is the equivalent condition of
the velocity steady-state deviation between the normalized 4th order model
and the 2nd order model, into the equation (2.32), the squared integral of
the model output error between the normalized 4th order model, which is
from the ramp response (2.16) of relationship ω2 = 2ζ2cp2 and normalized 4th
model, and the 2nd order model is given as
J2 =
6(τ1 + τ2)(K2
1τ2 + K2
2τ1) + 4K1K2τ1τ2
2τ1τ2(τ1 + τ2)
+ 16ζ4
2 −4ζ2
2 + 1
32c3
p2ζ4
2
−2K1((τ1 −cp2)ζ2 + 4cp2ζ3
2)
cp2τ 2
1 ζ2 + 4c2
p2(τ1 + cp2)ζ3
2
−2K2((τ2 −cp2)ζ2 + 4cp2ζ3
2)
cp2τ 2
2 ζ2 + 4c2
p2(τ2 + cp2)ζ3
2
;
v2.
(2.33)
The squared integral of the output error between the normalized 4th order
model and the 2nd order model is calculated with the diﬀerential about ζ2 by
equation (2.33) as
dJ2
dζ2
=
4
2ζ2
2 −1
8c3
p2ζ5
2
+
16K1c4
p2ζ3
2
(cp2τ 2
1 ζ2 + 4c2
p2(τ1 + cp2)ζ2
3)2
+
16K2c4
p2ζ3
2
(cp2τ 2
2 ζ2 + 4c2
p2(τ2 + cp2)ζ3
2)2
;
v2.
(2.34)
This value is often positive if ζ2 > 1. That is, since J2(ζ2) is the mono-increase
function in the scale of ζ2 > 1, J2min = limζ2→1 J2(ζ2). If ζ2 = 1, the squared
integral of the output error between the normalized 4th order model and the
2nd order model is given with a minimum value. If ζ2 = 1 then cp2 = ω2/2
and cv2 = 2ω2. Its result is cv2 = 4cp2. In addition, its ramp response of the
2nd order model is
y2(t) =
6
t −1
cp2
+
6
t + 1
cp2
=
e−2cp2t
=
v.
(2.35)
Besides, the minimal value of the squared integral of the output error between
the normalized 4th order model and the 2nd order model is calculated as

2.2 Reduced Order Model of One Axis in a Mechatronic Servo System
35
Table 2.1. Evaluation of reduced order model (rated speed VM = 104[rad/s], ωL =
94.2[rad/s], servo parameter of low speed 1st order model Kp1 = 23.6[1/s], servo
parameter of middle speed 2nd order model Kp2 = 23.6[1/s], Kv2 = 84.8[1/s])
Velocity [rad/s] Low velocity eq(2.23)[rad2] Middle velocity eq(2.29)[rad2]
5.02(= VM/20) 7.07 × 10−5
⃝5.18 × 10−5
⃝
20.1(= VM/5)
1.13 × 10−3
× 8.30 × 10−5
⃝
34.0(= VM/3)
7.07 × 10−3
× 5.18 × 10−4
×
J2min =
6(τ1 + τ2)(K2
1τ2 + K2
2τ1) + 4K1K2τ1τ2
2τ1τ2(τ1 + τ2)
+
13
32c3
p2
−2K1(τ1 + 3cp2)
cp2(τ1 + 2cp2)2 −2K2(τ2 + 3cp2)
cp2(τ2 + 2cp2)2
=
v2.
(2.36)
From the above discussion, cv2 satisfying conditions can be derived for the
minimum by
cv2 = 4cp2 ≈4cp.
(2.37)
The approximation equation (2.30) is as same as (2.24). The approximation
equation (2.37) uses the approximation equation of (2.30). In the mechatronic
servo system regulated properly, cp = 0.24 is given. From equation (2.30) and
(2.37), cp2 = 0.24 and cv2 = 0.96 are given.
2.2.5 Evaluation of the Low Speed 1st Order Model and the
Middle Speed 2nd Order Model
Through the respective movement velocities of the low speed 1st order model
and the middle speed 2nd order model derived in 2.2.3 and 2.2.4, the appro-
priate modeling mechatronic servo system is illustrated. In the contour control
of an industrial mechatronic servo system, ramp input is always adopted. As
the performance standard of the reduced order model, the error squared inte-
gral of the ramp response error between the 4th order model and the reduced
order model is adopted.
In the contour control, the ramp input of mechatronic servo system is 1/20
of the maximum in the scale of motor rated speed from 1/100 to 1/20, or 1/5
of maximum in that of rated speed from 1/20 to 1/5, or 1/3 of maximum in
that of rated speed from 1/5 to 1/3. The calculation results of the squared
integral of the model output error between the reduced order model and the
normalized 4th order model are illustrated in table 2.1. If given the allowance
error 1×10−4[rad2], the symbol ⃝in the table denotes satisfying the allowance
error and × denotes not satisfying the allowance error.
From the table 2.1, in the low speed operation from 1/100 to 1/20 of
the rated speed of the motor, the evaluation error between the low speed
1st order model and the middle speed 2nd order model is smaller than the

36
2 Mathematical Model Construction of a Mechatronic Servo System
required allowable error. When constructing the model, in order to obtain the
simple model with satisfying the required precision, the model should be the
low speed 1st order model for the low speed operation. Additionally, in the
middle speed operation from 1/20 to 1/5 of rated speed, the evaluation error
of the low speed 1st order model is bigger than the required allowance error
and smaller than that in the middle speed 2nd order model. In the high-speed
motion over 1/5 of rated speed of the motor, the evaluation error between
the low speed 1st order model and middle speed 2nd order model is bigger
than the required allowance error. From these results, the adaptable scale and
boundary of the reduced order model can be judged.
The correct modeling of actual industrial mechatronic servo system by
derived reduced order model was veriﬁed by experiment. The adopted ex-
perimental device for veriﬁcation is a DEC-1 similar to item 2.1.3 (refer to
experimental device E.1). The low speed of motion velocity is 5[rad/s] about
1/20 of rated speed, and middle speed is 20[rad/s] about 1/5 of rated speed.
Fig. 2.9 illustrates the modeling error between the output and the reduced
order model in the experiment. From the results in Fig. 2.9, in the low speed
operation, the modeling error of both the low speed 1st order model and the
middle speed 2nd order model is smaller than 0.05[rad], which is almost con-
sistent with the experimental results. In the middle speed operation, the error
between the low speed 1st order model and experimental results is bigger than
the maximal 0.14[rad]. In the middle speed 2nd order model, the modeling
error is smaller than 0.05[rad]. Therefore, the modeling is appropriate. From
these experimental results, the appropriateness of the reduced order model
expressing the dynamic of industrial mechatronic servo system was veriﬁed.
0
0.2
0.4
0
0.1
Time[s]
Modeling error[rad]
Low speed model
Middle speed model
0
0.2
0.4
0
0.1
Time[s]
Modeling error[rad]
Low speed model
Middle speed model
(a) Low speed (5[rad/s])
(b) Middle speed (20[rad/s])
Fig. 2.9. Evaluation of low speed 1st order model and middle speed 2nd order
model

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
37
Objective trajectory
[ Working coordinate ]
[ Working coordinate ]
[ Joint coordinate ]
Motor
Inverse
kinematics
Kinematics
Servo
controller
Objective joint angle
Following joint angle
Following trajectory
Division by
reference input
time interval
Fig. 2.10. Block diagram of industrial articulated robot arm
2.3 Linear Model of the Working Coordinates of an
Articulated Robot Arm
In an industrial articulated robot arm, instructions are given in working co-
ordinate. The motor is driven in the joint coordinate space transformed by
nonlinear coordinates by calculation in the controller. Hence, the mechanism
part is moved in the working coordinate space. Therefore, according to the
special region in working coordinates, there is the problem of precision dete-
rioration of the contour control of robot arm.
The approximation model (2.46) in the working coordinate of an articu-
lated robot arm and its approximation error (2.54) are derived.
By using this model, the working linearizable approximation possible re-
gion for keeping the movement precision of an articulated robot arm within
the allowance is clariﬁed. The region, in which the high-precision contour
control of the robot arm is capable to realize, is conﬁrmed. Besides, from the
discussion in this section, by holding this view of approximation error, the one
axis characteristic in the joint coordinate given in 2.1 and 2.2 can express the
characteristics of the mechatronic servo system in working coordinates. The
simpliﬁcation of the analysis and design of mechatronic servo systems is very
important.
2.3.1 A Working Linearized Model of an Articulated Robot Arm
(1) An Industrial Articulated Robot Arm Control System
The block diagram of contour control of an industrial articulated robot arm is
illustrated in Fig. 2.10. At ﬁrst, the objective trajectory in working coordinates
is divided into each reference input time interval (refer to section 3.2 and
3.3). The joint angle of each axis is calculated at each division point. The
rotation angle of the servo motor is controlled by various axis joint angles
with constant velocity movements based on the objective joint angle divided in
joint coordinate. The servo motor of each axis is rotated only with its deﬁned
movement. Thus, the arm tip is moved along the objective trajectory of the
working coordinate with the coordinate transform in the arm mechanism.
If the objective trajectory is given in working coordinates and the robot
arm control of each axis is independent of the joint coordinate with nonlinear

38
2 Mathematical Model Construction of a Mechatronic Servo System
transform, the following trajectory is evaluated in working coordinates with
nonlinear transform. When controlling a robot arm with this control pattern,
the control system of an industrial robot arm, with each linear independent co-
ordinate axis, is generally approximated in working coordinates. For preparing
the discussion (in 2.3.2) of appropriate linear approximation in this working
coordinate, the working linearized approximation trajectory, based on the ac-
tual trajectory and working linearized model of working coordinate of this
robot arm control system, is derived.
(2) Actual Trajectory of a Two-Axis Robot Arm
For analyzing the characteristics of multiple axes, the nature of two axes
is discussed and the analysis is expanded into multiple axes in 2.3.2(4). In
Fig. 2.11, two rigid links are expressed with
!. The conceptual graph of a two-
axis robot arm with movement of the tip on this plate is shown. The (θ1, θ2)
in ﬁgure is the joint angle in joint coordinates. (px, py) is the tip position in
working coordinates, l1, l2 are the lengths of axis 1 and axis 2, respectively.
This two-axis robot arm is the basic structure of a multi-axis robot arm. In
the SCARA robot arm, the plate position determination is carried out for
these two axes.
At ﬁrst, for determining the relationship between the working coordinate
and joint coordinate, the transformation from joint coordinate (θ1, θ2) to work-
ing coordinate (px, py) (kinematics) and the transformation from working co-
ordinate (px, py) to joint coordinate (θ1, θ2) are explained. From Fig. 2.11, the
kinematics is as
px = l1 cos θ1 + l2 cos(θ1 + θ2)
(2.38a)
py = l1 sin θ1 + l2 sin(θ1 + θ2).
(2.38b)
x
y
θ
(
,
)
l
l
1
2
θ
 x       y
p p
1
2
Joint
Joint
link 1
link 2
Fig. 2.11. Structure of two-degree-of-freedom articulated robot arm

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
39
-
Kp
+
1-
s
Objective joint angle
Following joint angle
[ Joint coordinate ]
Motor
Servo
controller
Position loop
Fig. 2.12. Block diagram of 1st order model in joint coordinate of industrial mecha-
tronic servo system
From the solution of (θ1, θ2) in equation (2.38a) and (2.38b), the inverse kine-
matics is given as
θ1 = sin−1
⎛
⎝
py
A
p2x + p2y
⎞
⎠−sin−1
⎛
⎝l2 sin θ2
A
p2x + p2y
⎞
⎠
(2.39a)
θ2 = ± cos−1
4
p2
x + p2
y −l2
1 −l2
2
2l1l2
;
(2.39b)
where the symbol of equation (2.39b) denotes that one assigned point in work-
ing coordinate has two possibilities in the joint coordinate.
Next, the dynamics of the robot arm is given in the joint coordinate. In an
industrial robot arm, if the gear ratio is large, then the load inertia is small.
Moreover, if using a parallel link, the eﬀect of no-angle part of inertia matrix
is small. The servo motor in the actuator performs the control on the robot
arm in each independent axis. For an actual industrial robot arm, when the
motion velocity of the robot arm is below 1/20 of rated speed, each axis can
be expressed with a 1st order system as (refer to 2.2.3).
dθ1(t)
dt
= −Kpθ1(t) + Kpu1(t)
(2.40a)
dθ2(t)
dt
= −Kpθ2(t) + Kpu2(t).
(2.40b)
The model expressed by equation (2.40) is called a joint linearized model.
Here, u1(t) and u2(t) denotes the angle input of axis 1 and axis 2, respec-
tively. Kp denotes Kp1 of equation (2.23) in the low speed 1st order model of
2.2.3. Fig. 2.12 illustrates the block diagram of the 1st order system. In this
section, each axis dynamic is expressed by equation (2.40) in joint coordinates.
For clarifying the expression of actual robot dynamics by the joint linearized
model. The following discussion is carried out with this assumption.
The robot arm is analyzed about how to trace the objective trajectory
divided into small intervals. Concerning the various trajectories divided from
the objective trajectory, the beginning point and end point in working coordi-
nates within one divided small interval are expressed by (p0
x, p0
y), (p∆T
x
, p∆T
y
),

40
2 Mathematical Model Construction of a Mechatronic Servo System
(
,
)
p
p
p
(
,
)
x
y
θ
θ
T
T
∆
∆
θ
θ
0
0
1
2
1
2
x
yp
0
0
x
y
∆
∆
T
T
Fig. 2.13. One interval of objective trajectory divided by reference input time
interval
respectively, and the beginning point and end point in joint coordinates are
expressed by (θ0
1, θ0
2), (θ∆T
1
, θ∆T
2
), respectively. The relationship between joint
coordinates and working coordinates in this small interval is given in Fig. 2.13.
The relation between (p0
x, p0
y) and (θ0
1, θ0
2) as well as between (θ∆T
1
, θ∆T
2
) and
(p∆T
x
, p∆T
y
) are expressed as below based on the expression of the relationship
between working coordinates and joint coordinates from equation (2.38a) and
(2.38b).
p0
x = l1 cos θ0
1 + l2 cos(θ0
1 + θ0
2)
(2.41a)
p0
y = l1 sin θ0
1 + l2 sin(θ0
1 + θ0
2)
(2.41b)
p∆T
x
= l1 cos θ∆T
1
+ l2 cos(θ∆T
1
+ θ∆T
2
)
(2.41c)
p∆T
y
= l1 sin θ∆T
1
+ l2 sin(θ∆T
1
+ θ∆T
2
).
(2.41d)
Concerning the industrial robot arm, from the given constant angle ve-
locity input (v1, v2) of each axis in divided small intervals, the angle in-
put (u1(t), u2(t)) for each axis dynamic of the robot arm (2.40) is given as
(u1(t), u2(t))
u1(t) = θ0
1 + v1t,
v1 = θ∆T
1
−θ0
1
∆T
(2.42a)
u2(t) = θ0
2 + v2t,
v2 = θ∆T
2
−θ0
2
∆T
(2.42b)
where ∆T denotes the reference input time interval (refer to 3.2, 3.3). The
time of the beginning division point is zero.
If the angle input is expressed by equation (2.42), the robot arm position
in working coordinates can be derived. When the objective trajectory is the

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
41
same as the position of the actual trajectory as (θ1(0), θ2(0)) = (θ0
1, θ0
2) in the
initial time of robot arm, the position in joint coordinates of the robot arm is
as below from the solution of diﬀerential equation after putting angle input
of equation (2.42) into (2.40) (refer to appendix A.2).
θ1(t) = θ0
1 + v1λ(t)
(2.43a)
θ2(t) = θ0
2 + v2λ(t)
(2.43b)
λ(t) = t + e−Kpt −1
Kp
.
(2.44)
At this time, the position of the robot arm in working coordinate can be
calculated when putting the nonlinear transform equation (2.43) into (2.38a),
(2.38b)
px(t) = l1 cos
#
θ0
1 + v1λ(t)
(
+ l2 cos
#
θ0
1 + θ0
2 + (v1 + v2)λ(t)
(
(2.45a)
py(t) = l1 sin
#
θ0
1 + v1λ(t)
(
+ l2 sin
#
θ0
1 + θ0
2 + (v1 + v2)λ(t)
(
.
(2.45b)
This equation (2.45) expresses the actual trajectory of the robot arm tip
in working coordinates. Concerning this actual trajectory, as the problem of
this section, the working linearized approximation trajectory in the working
linearized model is derived after linearized approximation of each coordinate
axis independently of the working coordinates.
(3) Working Linearized Approximation Trajectory of a Two-Axis
Robot Arm
In working coordinates, the control system of the robot arm is as below when
x axis y axis are linearly approximated independently, respectively
dˆpx(t)
dt
= −Kpˆpx(t) + Kpux(t)
(2.46a)
dˆpy(t)
dt
= −Kpˆpy(t) + Kpuy(t)
(2.46b)
where (ˆpx(t), ˆpy(t)) denotes the robot arm position in the working coordinate
linearly approximation. (ux(t), uy(t)) denotes the position input in working
coordinates. This equation (2.46) is the working linearized model as the discus-
sion object of this section. When the objective trajectory is divided as shown
in Fig. 2.13 with the linearized approximation equation (2.46), the robot arm
response at small intervals is derived. Here, the objective trajectory is the
same as the position of the working linearized approximation trajectory as
(ˆpx(0), ˆpy(0)) = (p0
x, p0
y) at the initial time of the robot arm. Strictly speak-
ing, The input in working coordinate corresponding to the input (2.42) in
the joint coordinate needs to be derived according to the coordinate trans-
form (2.38a), (2.38b). If the input in the working coordinate is not a constant

42
2 Mathematical Model Construction of a Mechatronic Servo System
velocity, the input in working coordinates is approximated with a constant
velocity by
ux(t) = p0
x + vxt,
vx = p∆T
x
−p0
x
∆T
(2.47a)
uy(t) = p0
y + vyt,
vy = p∆T
y
−p0
y
∆T
.
(2.47b)
Its approximation error can almost be neglected. If the input of the equation
(2.47) is put into the working linearized model of equation (2.46), the working
linearized approximation trajectory of the robot arm from the solution of
diﬀerential equation is as
ˆpx(t) = p0
x + vxλ(t)
(2.48a)
ˆpy(t) = p0
y + vyλ(t).
(2.48b)
That is, the working linearized approximation trajectory corresponding to the
actual trajectory (2.45) of the robot arm in working coordinates is given by
equation (2.48).
2.3.2 Derivation of Adaptable Region of the Working Linearized
Model
(1) Approximation Error of the Working Linearized Model
From the comparison between the actual trajectory (2.45) of the robot arm
control system and the working linearized approximation trajectory (2.48),
the approximation precision of the working linearized model for the object
discussed in this section is evaluated. The approximation error in the working
coordinate is the error between equation (2.45) and (2.48) as
ex(t) = ˆpx(t) −px(t)
(2.49a)
ey(t) = ˆpy(t) −py(t).
(2.49b)
(ex(t), ey(t)) of equation (2.49) is called the working linearized approximation
error. In order to evaluate separately the item about the time and the item
about the space in equation (2.49), the actual position of the robot arm in
working coordinates expressed by equation (2.45) is calculated as below with
1st order approximation by Taylor expansion when the movement of (θ0
1, θ0
2)
is very small.
˜px(t) = l1{cos(θ0
1) −sin(θ0
1)v1λ(t)}
+ l2{cos(θ0
1 + θ0
2) −sin(θ0
1 + θ0
2)(v1 + v2)λ(t)}
(2.50a)
˜py(t) = l1{sin(θ0
1) + cos(θ0
1)v1λ(t)}
+ l2{sin(θ0
1 + θ0
2) + cos(θ0
1 + θ0
2)(v1 + v2)λ(t)}.
(2.50b)

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
43
Between the actual trajectory and the 1st order approximation trajectory by
Taylor expansion of equation (2.50) is as [9]
px(t) = ˜px(t) + l1o{v1λ(t)} + l2o{(v1 + v2)λ(t)}
= ˜px(t) + o{λ(t)}
(2.51a)
py(t) = ˜py(t) + l1o{v1λ(t)} + l2o{(v1 + v2)λ(t)}
= ˜py(t) + o{λ(t)}.
(2.51b)
The o{λ(t)} in equation (2.51) denotes the high level inﬁnitesimal of λ(t). By
using triangle inequality, the size of error between the actual trajectory and
the working linearized approximation trajectory can be restrained by equation
(2.48) and (2.50)
|ˆpx(t) −px(t)| ≤|ˆpx(t) −˜px(t)| + |˜px(t) −px(t)|
= |εxλ(t)| + |o{λ(t)}|
(2.52a)
|ˆpy(t) −py(t)| ≤|ˆpy(t) −˜py(t)| + |˜py(t) −py(t)|
= |εyλ(t)| + |o{λ(t)}|
(2.52b)
where (εx, εy) is
εx = vx + p0
yv1 + l2 sin(θ0
1 + θ0
2)v2
(2.53a)
εy = vy −p0
xv1 −l2 cos(θ0
1 + θ0
2)v2.
(2.53b)
If the position of the robot arm is depended on velocity, there has the error
item not depended on the time. When λ(t) is very small, the item o{λ(t)} in
equation (2.51) can be neglected. Therefore, the working linearized approxi-
mation error can be approximated as
ex(t) ≈εxλ(t)
(2.54a)
ey(t) ≈εyλ(t).
(2.54b)
That is, if the λ(t) can be very small and the division interval of the ob-
jective trajectory is very small, the working linearized approximation error
can be expressed by equation (2.54). The equation (2.54) is given by item
(εx, εy) depended on the robot arm position in equation (2.53) and the in-
tegral with item λ(t) dependent on time. The (εx, εy) in equation (2.53) is
the function of the robot arm position (p0
x, p0
y), (θ0
1, θ0
2) and motion veloc-
ity (vx, vy), (v1, v2). Here, the robot arm position (θ0
1, θ0
2) expressed in joint
coordinates can be expressed in working coordinates by kinematic equation
(2.38a), (2.38b). Moreover, the motion velocity in joint coordinates, expressed
by (v1, v2) = ((θ∆T
1
−θ0
1)/∆T, (θ∆T
2
−θ0
2)/∆T) in equation (2.42), can be
also expressed in working coordinates as (p0
x, p0
y), (p∆T
x
, p∆T
y
) from kinematics
(2.38a), (2.38b). Equation (2.54) can express the robot arm position (p0
x, p0
y),
(p∆T
x
, p∆T
y
) in working coordinates. This equation (2.54) expresses the working
linearized approximation error, as the purpose. From the evaluating the size

44
2 Mathematical Model Construction of a Mechatronic Servo System
of this error, the appropriation of the working linearized model of the control
system of the robot arm as well as the working linearizable approximation
possible region can be derived.
(2) Quantity Evaluation of the Working Linearized Model
The small region of working linearized approximation error of the working
linearized model as (2.46) in working coordinates of robot arm, i.e., work-
ing linearizable region, is quantitatively evaluated. In Fig. 2.14, within the
moveable region of the robot arm is enclosed by a dotted line in working
coordinates, when the robot arm is moved along the arrow direction from
each beginning point (p0
x, p0
y) (bullet • in ﬁgure) of 188 points divided in each
0.2[m], the value of (εx, εy) about position of working linearized approxima-
tion error is calculated by (2.53) (line from bullet • in ﬁgure) and its results
are illustrated. The length of the arm is l1 = 0.7[m], l2 = 0.9[m]. The motion
velocity is vx = 0.1[m/s], vy = 0.1[m/s]. The symbol of inverse kinematics
(2.39b) of the robot arm is often positive. From Fig. 2.14, the approximation
precision of the working linearized model deteriorates near the boundary of
the moveable region along the motion direction of the robot arm. Moreover,
in the shrinking region of the robot arm, the working linearized approxima-
tion error becomes large. Since the working linearized approximation error is
dependent on the posture of the arm but absolutely independent on the posi-
tion in working coordinates of the arm, the results of the working linearized
approximation error in Fig. 2.14 expresses that, the robot arm is moved not
only along the error direction, but also rotated around the original point in
Fig. 2.14 along any direction, and also the movement direction of arm is along
−2
2
−2
2
x[m]
y[m]
εx 0.01[m/s]
εy 0.01[m/s]
Moving direction
Fig. 2.14. Working linearized approximation error for various initial position (bullet
•: initial position of robot arm; division from bullet •: working linearized approxi-
mation error vector (εx, εy))

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
45
the arrow direction in the ﬁgure and it is the dependent item of the working
linearized approximation error.
Next, when changing the view point, from one beginning point of the robot
arm (the distance from the initial point to the arm tip position is written as
r =
A
(p0x)2 + (p0y)2), how the working linearized approximation error changes
along various motion directions can be seen. At four points r = 0.25, 0.38,
1.5, 1.55[m] and with motion velocity v =
A
v2x + v2y =
√
0.02 ≈0.141[m/s],
when the arm is moved one cycle 2π at each direction with regarding initial
position as the center, the results of position dependent item size
A
ε2x + ε2y
of the working linearized approximation error are illustrated in Fig. 2.15. The
horizontal axis φ of Fig. 2.15 represents the movement angle of arm. From the
angle standard φ = 0[rad] of angle stretching direction, φ = π[rad] denotes
the arm shrinking direction. From Fig. 2.15, at r = 0.25[m] and 1.55[m] near
the boundary of the arm moveable region (0.2 ≤r ≤1.6[m]), the working
linearized approximation error becomes large at the arm stretching action. In
the movement at the pull-push direction and vertical direction, the working
linearized approximation error becomes fairly small.
When the working linearized approximation error (2.54) is dependent on
time, the time shift with Kp = 15[1/s] of the time depending item λ(t), is
illustrated in Fig. 2.16. In the reference input time interval ∆T = 0.02[s],
λ(t) is 0.0027[s]. From Fig. 2.15, the position dependent item size
A
ε2x + ε2y
of the working linearized approximation error is below 0.001[m/s] with any
direction motion within the region 0.38 ≤r ≤1.5[m]. Therefore, the maximum
of the working linearized approximation error is 0.0027[mm]. This value is
about 0.1% of the small interval length 0.141[m/s]×0.02[s] = 0.00282[m] with
reference input time interval ∆T = 0.02[s] and it is very small value. That is,
when the reference input time interval is 0.02[s] with the robot arm motion
velocity 0.141[m/s], the working linearized approximation error is within 0.1%
0
0
0.001
0.002
0.003
φ [rad]
εx
2 +εy
2 [m/s]
π
2π
r=0.25[m]
r=0.38[m]
r=1.5[m]
r=1.55[m]
Fig. 2.15. Working linearized approximation error for various movement direction
φ, initial position of robot arm r (r = 0.25[m], r = 0.38[m], r = 1.5[m], r = 1.55[m])

46
2 Mathematical Model Construction of a Mechatronic Servo System
0
0.01
0.02
0
0.001
0.002
Time [s]
δ(t) [s]
Fig. 2.16. Time dependence of working linearized approximation error λ(t)
of the objective trajectory in one division scale of objective trajectory, and
the working linearizable approximation possible region can be as 0.38 ≤r ≤
1.5[m].
To a general robot arm, the derivation procedure of the working lineariz-
able region is arranged. The length of link of the robot arm is l1, l2. The
position loop gain is Kp. The reference input time interval is ∆T. The arm
motion velocity is v. The distance from the initial point to the arm tip posi-
tion is r (without losing generality, robot arm tip is on the x axis). The size
of the working linearized approximation error at motion direction φ can be
calculated by the following method.
1. Set (p0
x, p0
y) = (r, 0), (p∆T
x
, p∆T
y
) = (p0
x + v∆T cos φ, p0
y + v∆T sin φ)
2. Using inverse kinematics (2.39), (θ0
1, θ0
2), (θ∆T
1
, θ∆T
2
) can be worked out.
3. The motion velocity in working coordinate velocity (vx, vy) = (v cos φ, v sin φ)
and the motion velocity in joint coordinate (v1, v2) = ((θ∆T
1
−θ0
1)/∆T, (θ∆T
2
−
θ0
2)/∆T) are calculated.
4. Using equation (2.53), the position dependent item of the working lin-
earized approximation error (εx, εy) is calculated. And its size
A
ε2x + ε2y
is calculated.
5. Using equation (2.44), the time dependent item of the working linearized
approximation error λ(∆T) is calculated.
6. The size of working linearized approximation error
A
ε2x + ε2y λ(∆T) is
calculated.
The working linearizable approximation possible region is deﬁned with the
region in which the working linearized approximation error for one interval of
objective is below ξ% of small interval v∆T divided of objective trajectory. In
the working linearizable approximation possible region, the distance r from
one initial point to the arm tip position is changed and the size of the working
linearized approximation error
A
ε2x + ε2y λ(∆T) along two arm motion direc-
tion φ = 0 ∼2π is calculated. Its size can be judged whether or not it is below
the allowance ξv∆T/100.

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
47
(3) Accumulation of Errors in the Working Linearized Model
In the evaluation so far, the appropriation of linearized approximation for
divided one scale is evaluated on objective trajectory division. The derivation
method of the working linearizable approximation possible region is given. The
actual objective trajectory corresponds with the division trajectory and the
working linearized approximation error of each region in the whole trajectory
is checked about the time duration and how to integral.
(i) Shift of the working linearized approximation error in one region
In 2.3.1(2) and 2.3.1(3), for making objective trajectory at the beginning
point of divided small interval, actual trajectory and position of the work-
ing linearized approximation trajectory similar, the derivation of the actual
trajectory and the position of the working linearized approximation trajec-
tory is carried out. In this part, when there are diﬀerent values among the
objective trajectory at the beginning point, actual trajectory and the work-
ing linearized approximation trajectory respectively, the working linearized
approximation error in one region is analyzed. The positions of objective tra-
jectory at the initial moment in working coordinate and joint coordinate are
respectively (u0
x, u0
y), (u0
1, u0
2). The actual trajectory in working coordinates
and joint coordinates are respectively (p0
x, p0
y), (θ0
1, θ0
2). The position of the
working linearized approximation trajectory in working coordinate is (ˆp0
x, ˆp0
y).
When we put equation (2.42) into (2.40), solve (θ1(t), θ2(t)) by using initial
condition (θ0
1, θ0
2) and put this solution into equations (2.38a), (2.38b), the
actual trajectory of the robot arm is as
px(t) = l1cos
#
θ0
1 + (u0
1 −θ0
1)σ(t) + v1λ(t)
(
+ l2cos
#
θ0
1 + θ0
2 + (u0
1 + u0
2 −θ0
1 −θ0
2)σ(t) + (v1 + v2)λ(t)
(
(2.55a)
py(t) = l1sin
#
θ0
1 + (u0
1 −θ0
1)σ(t) + v1λ(t)
(
+ l2sin
#
θ0
1 + θ0
2 + (u0
1 + u0
2 −θ0
1 −θ0
2)σ(t) + (v1 + v2)λ(t)
(
(2.55b)
where
σ(t) = 1 −e−Kpt.
(2.56)
When we put equation (2.47) into (2.46) and solve (ˆpx(t), ˆpy(t)) by using the
initial condition (ˆp0
x, ˆp0
y), the working linearized approximation trajectory is
calculated by
ˆpx(t) = ˆp0
x + (u0
x −ˆp0
x)σ(t) + vxλ(t)
(2.57a)
ˆpy(t) = ˆp0
y + (u0
y −ˆp0
y)σ(t) + vyλ(t).
(2.57b)
From the error between equation (2.57) and (2.55), the error between the
actual trajectory and the working linearized approximation trajectory can be
calculated by

48
2 Mathematical Model Construction of a Mechatronic Servo System
ex(t) = ˆpx(t) −px(t)
= ˆpx(t) −˜px(t) + o{σ(t)}
= (ˆp0
x −p0
x)e−Kpt + εxλ(t) + {(ux0 −p0
x) + p0
y(u0
1 −θ0
1)
+ l2 sin(θ0
1 + θ0
2)(u0
2 −θ0
2)}σ(t) + o{σ(t)}
(2.58a)
ey(t) = ˆpy(t) −py(t)
= ˆpy(t) −˜py(t) + o{σ(t)}
= (ˆp0
y −p0
y)e−Kpt + εyλ(t) + {(uy0 −p0
y) + p0
x(u0
1 −θ0
1)
−l2 cos(θ0
1 + θ0
2)(u0
2 −θ0
2)}σ(t) + o{σ(t)}.
(2.58b)
The (˜px(t), ˜py(t)) transformation is the Taylor expansion one order approxi-
mation of the actual trajectory (2.55) as
˜px(t) = p0
x + l1 sin θ0
1{(u0
1 −θ0
1)σ(t) + v1λ(t)}
+ l2 sin(θ0
1 + θ0
2){(u0
1 + u0
2 −θ0
1 −θ0
2)σ(t) + (v1 + v2)λ(t)}
(2.59a)
˜py(t) = p0
y −l1 cos θ0
1{(u0
1 −θ0
1)σ(t) + v1λ(t)}
−l2 cos(θ0
1 + θ0
2){(u0
1 + u0
2 −θ0
1 −θ0
2)σ(t) + (v1 + v2)λ(t)}.
(2.59b)
The ﬁrst item in equation (2.58) is the item based on the diﬀerence between
the actual trajectory (p0
x, p0
y) at the initial time and the working linearized
approximation trajectory (ˆp0
x, ˆp0
y). The second item is the working linearized
approximation error (2.54) derived when the objective trajectory in 2.3.2(1) is
identical with the actual trajectory and the working linearized approximation
trajectory. The third item is the error item based on the position diﬀerence
between the objective trajectory and the actual trajectory at the initial mo-
ment. The fourth item is the error item according to the Taylor expansion one
order approximation of equation (2.59).
At the initial time, the working linearized approximation error (ˆp0
x −
p0
x, ˆp0
y −p0
y) is deteriorated with an index along time from the 1st item in
the ﬁnal equation in (2.58).
(ii) Accumulation of the working linearized approximation error
From the previous discussion, the time shift characteristic of the working lin-
earized approximation error is similar with the x axis and y axis. Therefore,
the x axis is discussed here. The upper boundary of the working linearized ap-
proximation error is analyzed by using triangle inequality when the reference
input time interval ∆T increases. The size of the working linearized approxi-
mation error in reference input time interval ∆T is restrained from equation
(2.58) as
|ex(∆T)| = |(ˆp0
x −p0
x)e−Kp∆T + εxλ(∆T)
+ {(ux0 −p0
x) + p0
y(u0
1 −θ0
1) + l2 sin(θ0
1 + θ0
2)(u0
2 −θ0
2)}σ(∆T)
+ o{σ(∆T)}|
≤E0e−Kp∆T + E1σ(∆T).
(2.60)

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
49
E0 = |ˆp0
x −p0
x|, E1 are the positive constants for expressing the size of
the working linearized approximation error generated newly in one region.
λ(∆T) = o{σ(∆T)} is adopted in the transformation of the ﬁnal equation.
Similarly, the size of the working linearized approximation error in the Nth
division of the objective trajectory can be restrained.
|ex(N∆T)| ≤|ex{(N −1)∆T }|e−Kp∆T + ENσ(∆T).
(2.61)
According to using (2.61) step by step, the upper boundary of the size of the
working linearized approximation error in the N th region is expressed as below
based on the accumulation of the working linearized approximation error from
initial value.
|ex (N∆T)| ≤|ex{(N −1)∆T }|e−Kp∆T + ENσ(∆T)
≤[|ex{(N −2)∆T }|e−Kp∆T + EN−1σ(∆T)]e−Kp∆T + ENσ(∆T)
≤E0e−NKp∆T + E1σ(∆T)e−(N−1)Kp∆T + · · · + ENσ(∆T)
≤E0e−NKp∆T + Emaxσ(∆T)(e−(N−1)Kp∆T + e−(N−2)Kp∆T + · · · + 1)
= E0e−NKp∆T + Emaxσ(∆T)1 −e−NKp∆T
1 −e−Kp∆T
= E0e−NKp∆T + Emax(1 −e−NKp∆T )
(2.62)
where Emax = max(E1, E2, · · · , EN) and using value σ(∆T) of equation (2.56)
in the derivation procedure. The ﬁrst item of equation (2.62) represents the
eﬀect of the working linearized approximation error in the initial moment.
The second item represents the accumulation value of the working linearized
approximation error generated in each division region of the objective trajec-
tory. From equation (2.62), even the division number N is big, the working
linearized approximation error is not divergent and it converges to a limited
determined value. This Emax in 2.3.2(1) is the constant value according to the
error based on the diﬀerences when the working linearized approximation er-
ror equation (2.54) is derived by the objective trajectory, actual trajectory and
working linearized approximation trajectory. Moreover, when the dynamics of
robot arm is good, i.e., the position loop gain Kp is big, the upper boundary
of integral of the working linearized approximation error is Emax. In addi-
tion, when the time N∆T of the objective trajectory is constant, the division
number of the objective trajectory is big and the division time is short, i.e.,
N →∞, ∆T →0, the upper boundary of the integral value of the work-
ing linearized approximation error is unchanged in (2.62). If we evaluate this
upper boundary of error, when the robot arm is moved from (−0.8, 0.8[m])
to (−0.7, 0.8[m]) with 0.1[m/s] at the positive direction of x axis under the
same conditions with 2.3.2(2), the actual working linearized approximation
error at the end point is 6.89 × 10−3[mm]. From equation (2.62), the upper
boundary of the calculated error is 6.10 × 10−2[mm]. The working linearized
approximation error accumulated by the error upper boundary is of such a
size that it can be neglected.

50
2 Mathematical Model Construction of a Mechatronic Servo System
x
y
Tip
3rd axis
Joint
Fig. 2.17. Three-degree-of-freedom robot arm x axis and the third axis
(4) Expansion to a Multi-Axis Robot Arm
In the discussion so far, the working linearizable region for a two-axis robot
arm is derived. In this part, the working linearizable region is discussed from
a two-axis robot arm to a multi-axis robot arm. Concerning the SCALAR
robot whose the third axis is the direct movement along z axis, the working
linearizable region is to move the working linearizable region of a two-axis
robot arm along the z axis direction. Since the 4th axis is the self-rotation of
the end-eﬀect, there is no need to make operation linearizable approximation.
Next, when determining the position in the working coordinates of a six-
axis robot arm, three axes are considered from the base. The third axis of this
six-axis robot arm is adopted as the y axis of a two-axis robot arm expressed
by Fig. 2.11 for rotation. Therefore, to these three axes, the moveable region
of robot arm is a ball with an empty center hole. The robot arm at the plate
made by the third axis and x axis is illustrated by Fig. 2.17. When making
a linearizable approximation in this plate by this third axis and x axis, it is
diﬀerent from the linear approximation of a two-axis robot arm discussed in
the previous part. The former is that one axis is rotated and one axis is moved
directly. The latter is that both axes are rotated. That is to say, the linear
approximation of the two-axis robot arm discussed in the previous part means
that the transformation from two axes rotation to two axes direct movement
is possible. Therefore, the transformation from one axis rotation and one axis
direct movement in the formed plate by the third axis and x axis is same
as the linear approximation discussion of the two-axis robot arm discussed
in the former part. That is to say, the robot arm in the formed plate by the
third axis and x axis is possibly linearly approximated in working coordinates.
The working linearizable region of the three-axis robot arm is the region that
the working linearizable region of the two-axis robot arm is rotated by the
y axis. Considering the third axis similar to hand, it is no need to make the
operation linear approximation for self-rotation of the end-eﬀect at the ball
surface regarding the hand tip as the center in the operation space.

2.3 Linear Model of the Working Coordinates of an Articulated Robot Arm
51
2.3.3 Adaptable Region of the Working Linearized Model and
Experiment Veriﬁcation
In order to observe the operation linearized approximation about control per-
formance of the robot arm discussed so far, a computer simulation is carried
out. The robot arm for simulation is l1 = 0.7[m], l2 = 0.9[m], Kp = 15[1/s].
The objective trajectory is to move 0.15[m] in the direction of the y axis
with a velocity 0.25[m/s] and then to move 0.15[m] in the direction of the x
axis. In the objective trajectory, the working linearized approximation error
is within 0.2% and the working linearizable region is (p0
x, p0
y) =(−0.8, 0.65[m])
within 0.5≤r ≤1.45[m] and (p0
x, p0
y) =(−1.13137, 0.98137[m]) out of possible
region. Then the simulation is carried out. The reference input time interval
is ∆T = 20[ms].
The operational linear approximation error in the top point (x, y) =
(−0.8, 0.8[m]) within the working linearizable region is (εx, εy) =(0.68, −0.09
[mm/s]). The working linearized approximation error 0.0018[mm] generated
in one region of the objective trajectory is 0.037% of the divided objective
trajectory 5[mm] and therefore it is very small. The working linearized ap-
proximation error in the top point (x, y) =(−1.13137, 1.13137[m]) out of the
working linearizable region is (εx, εy) = (0.0, 25.0[mm/s]). The working lin-
earized approximation error 0.675[mm] is generated within one region of the
objective trajectory is 13.5% of the divided objective trajectory 5[mm].
In Fig. 2.18, the comparison of (a) response locus of linear approximated
actual locus in the working linearizable approximation possible region and (b)
the response locus of a linear approximated actual locus out of the working
linearizable region about the two-axis robot arm is shown. In the working
linearizable region of Fig.(a), the response locus of linear approximated is
consistent with the actual locus in the ﬁgure. The maximal error of them is
−0.8
−0.7
0.7
0.8
x[m]
y[m]
Objective locus
Linear approximation
Linear approximation
in joint coordinates
in working coordinates
−1.1
−1
1
1.1
x[m]
y[m]
Objective locus
Linear approximation
in joint coordinates
Linear approximation
in working coordinates
(a) Inside of working linearizable region
(b) Outside of working linearizable region
Fig. 2.18. Comparison between linear approximation in joint coordinates and in
working coordinates for a two-degree-of-freedom robot arm

52
2 Mathematical Model Construction of a Mechatronic Servo System
0.2[mm], which can be neglected. Out of the working linearizable approxima-
tion possible region of Fig.(b), the response locus linear approximated has
deviation with the actual locus. The maximal error of them is 2.7[mm], which
is quite large. Moreover, out of the working linearizable region, overshoot is
generated in the actual trajectory and the control performance of the robot
arm itself is degraded. Besides, in the working linearizable region, when ob-
taining near equivalence between the actual trajectory of robot arm and the
working linearized approximation trajectory, the control performance of the
robot arm can be evaluated in working coordinates. However, out of the work-
ing linearizable region, the evaluation of the robot arm in working coordinates
becomes diﬃcult and control performance also deteriorates from the control
performance expressed by the working linearized model.
Next, for illustrating the appropriation of the linear approximated model,
the contour control experiment on a six-axis industrial robot arm (Performer
K3S, maximal load is 3[kg]) was carried out (refer to experimental device E.2).
The experimental results are shown in Fig. 2.19. The experimental results are
almost the same as the simulation results in the working linearized model
in Fig. 2.18(a). From this point of view, in the working linearizable region
derived in this section, the working linearized model expressing the industrial
robot arm can be veriﬁed by experiment.
Fig. 2.19. Experimental results in the working linearizable region of the six-degree-
of-freedom robot

3
Discrete Time Interval of a Mechatronic Servo
System
The servo controller of a mechatronic system consists of the reference input
generator, the position control part, the velocity control part, the current
control part and the power ampliﬁer part. By this controller, the motor is
rotated and the mechanism part connected with the motor is moved. 15 years
ago, the servo controllers were almost all constructed in hardware. In recent
years, the reference input generator, position control part and velocity control
part are digitally implemented using a micro processor and the current control
part is analogically implemented. When the micro processor is installed into
the closed-loop of the control system, this system must be considered as the
sampling control system.
In this chapter, this sampling control system is diﬀerent from the general
discrete system. With the prerequisite that the dead time is very long, the
relationship between the sampling time interval and contour control precision
in the position loop and velocity loop, and also the relationship between the
time interval of the command generation and the locus irregularity generated
in the contour control as well as velocity ﬂuctuation are discussed.
3.1 Sampling Time Interval
In the sampling control of the position loop and the velocity loop in the
contour control of the mechatronic servo system, for calculating the control
input in the next sampling period when the state has been known, the dead
time is equivalent to the sampling time interval should be explained. Moreover,
for making the control input as the 0th order hold, the constant control input
should be the constant within the sampling time interval and there should be
a big dead time for the entire system. According to experience, the sampling
frequency, for the desired control performance which has no overshoot of locus
in the contour control, is needed to be a value that is more than 30 times that
of the entire cut-oﬀfrequency of the mechatronic servo system. However, there
is no quantity analysis.
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 53–78, 2004.
Springer-Verlag Berlin Heidelberg 2004

54
3 Discrete Time Interval of a Mechatronic Servo System
The mechatronic servo system is expressed by the 1st order system. In order
to generate no oscillation (overshoot condition) in this transient response,
the dead time equivalent to several sampling time interval was introduced. In
addition, its cut-oﬀfrequency is not smaller than the cut-oﬀfrequency of the
system without including dead time. By calculating the sampling frequency
which satisﬁes the above two conditions, the relation of equation (3.6) fs ≥
27.5fc1 can be derived.
By using the obtained equation, the proper sampling frequency in the sam-
pling control system can be determined. It means that, it not only can prevent
any decrease of the control performance of the mechatronic servo system gen-
erated with the low sampling frequency, but also can save the waste of the
sampling control of high sampling frequency over the necessity. Moreover, in
order to declare theoretically the reason for deterioration of the contour con-
trol performance with the rough sampling time interval including the dead
time of the computing time, if there is dead time compensation in the con-
trol strategy, the control performance can be satisﬁed even with the rough
sampling time interval.
3.1.1 Conditions Required in the Mechatronic Servo System
In the control of a mechatronic servo system, such as a robot arm, table of
machine tool, etc, there are many kinds of sampling control using comput-
ers. When performing the contour control of a robot arm or machine tool,
it is extremely important to avoid the overshoot of objective value (refer to
1.1.2 item 3). However, when this sampling control of the servo system is
performed using a low sampling frequency sampler, the state measurement,
control input calculation as well as the control signal output needs at least
one sampling time interval. If it is dead time, there will appear an overshoot
or oscillation in the output and also a deterioration of control performance ac-
cording to general experience. The control law for compensating for dead time
is actively studied theoretically [15]. But this kind of compensation method
is with complicated control law. It cannot be adopted generally in the actual
industrial servo system control. Therefore, in order to not generate control
deterioration without performing dead time compensation, the sampler with
a high sampling frequency is adopted and from one to several [kHz] frequen-
cies is adopted for safety in the current industrial robot. If the sampler of
high sampling frequency is adopted in the unnecessary case in the sampling
control, the cost of hardware will be over the necessary expense for realizing
a sampler of high frequency.
For the calculation of the control input in the velocity command without
whole time. The transfer function of the 1st order system of the desired state
without delay when output the control input obtained from the observed a
value is written as (refer to item 2.2.3)
G1(s) =
Kp
s + Kp
(3.1)

3.1 Sampling Time Interval
55
where Kp denotes Kp1 of equation (2.23) in the low speed 1st order model of
item 2.2.3. The cut-oﬀfrequency of this servo system is fc1 = Kp/2π. For only
including the delay frequency factors from the cut-oﬀfrequency, the possibility
that can be of tracing correctly objective of this servo system should be hold
in relation with the smooth objective trajectory. However, when performing
the sampling control of this servo system and outputting the control input,
the dead time actually exists due to the calculation delay of control input
in the controller and the delay in reading states. For these cases, the servo
system contains the sum L1 of various dead times. When this sum of dead
times is q1 (q1 is an integer over 1) times of the sampling time interval, there is
L1 = q1∆tp (∆tp: sampling time interval). There has also the relation between
the dead time and sampling frequency as L1 = q1/fs (fs: sampling frequency).
If the sampling frequency of the sampling control is low, for this dead
time, the overshoot and oscillation in the transient response occurred. The
control performance has deteriorated. This overshoot is avoided completely
in the contour control of the servo system (refer to the 1.1.2 item 3). For an
understanding of the relation between control property of the servo system
and the sampling frequency in the sampling control, the theoretical decision of
the necessary sampling frequency for keeping control performance should be
carried out. Therefore, in the sampling control, the dead time is only focused
on and the eﬀect of discretization is neglected. Based on this approximation,
the strict analysis of the problem in the Z domain can be expressed in the
s domain approximately. Hence, the following simple analysis can be carried
out.
The transfer function of the 1st order system with dead time is as
GL1(s) =
Kpe−L1s
s + Kpe−L1s .
(3.2)
In this servo system with dead time, the conditions required from control prop-
erties are considered. In the servo system, the required control performance
in the contour control is pursued correctly without overshoot for the complex
objective trajectory with transient response of the servo system. Therefore,
after arranging the required control performance, the two following conditions
can be summarized.
(A) There is no divergence and no oscillation in the transient response (over-
shoot condition)
(B) The cut-oﬀfrequency of the system with dead time is not smaller than
the cut-oﬀfrequency of the desired state (cut-oﬀfrequency condition)
The sampling frequency satisfying these two (A), (B) conditions simulta-
neously is calculated as below.

56
3 Discrete Time Interval of a Mechatronic Servo System
3.1.2 Relation between Control Properties and Sampling
Frequency
(1) Relation Equation for the Overshoot Condition
The sampling frequency satisfying the overshoot condition of condition (A)
imposed into the servo system is calculated.
In the transfer function (3.2) including dead time, by using the Pade ap-
proximation e−L1s ≈(2 −L1s)/(2 + L1s) of the dead time factors is easily
adopted for analysis, the transfer function of equation (3.2) is approximately
expressed as
GP 1(s) =
Kp
6 2
L1
−s
=
s2 +
6 2
L1
−Kp
=
s + 2Kp
L1
.
(3.3)
In order to satisfy the overshoot conditions that the servo system with
dead time does not generate oscillations in the transient response and con-
verge, the characteristic roots of equation (3.3) should be all negative. If this
condition equation has several negative roots when the judgment equation
of the characteristic equation is positive, the relation equation between the
sampling frequency and cut-oﬀfrequency is obtained as
fs ≥18.3q1fc1.
(3.4)
However, in the transfer function of the Pade approximation of equation
(3.3), which including unstable zero (s = 2/L1), a few undershoots at the
initial stage of the response are generated [16]. But the undershoots do not
occur in the previous dead time system because the dead time is dealt with in
the Pade approximation. The approximation error of the Pade approximation
of dead time is bigger at the initial stage of response and tends to decrease
with index function with time. The Pade approximation error in the delay time
band in terms of overshoot possibly occurred according to the characteristic
root is almost neglected. Therefore, the overshoot found in the approximated
error is actually neglected. Only the overshoot in the characteristic root is
discussed.
(2) Relation Equation for the Cut-OﬀFrequency Condition
The cut-oﬀfrequency condition of condition (B) is discussed here. Firstly, the
cut-oﬀfrequency of the servo system of the desired state is fc1 = Kp/2π. On
the other hand, the cut-oﬀfrequency of the servo system including dead time
can be calculated by the following equation obtained from transfer function
(3.3) by using Pade approximation.
fcP = 1
2π
⎧
⎨
⎩
1
L1
−Kp
2 −
B6 1
L1
−Kp
2
=2
−2Kp
L1
⎫
⎬
⎭
(3.5)

3.1 Sampling Time Interval
57
where, fcP must be bigger than fc1 in order to satisfy the cut-oﬀfrequency
condition. The condition, that fcP is bigger than fc1, can be held with the L1
value when satisfying the overshoot condition (A).
3.1.3 Sampling Frequency Required in the Sampling Control
For a system with general dead time q1∆tp, the relation equation (3.4) of the
sampling frequency can be adopted in the sampling control problem of a servo
system commonly existing the 0th order hold and dead time calculation of one
sampling.
The continuous signal f(t) is sampled in terms of the sampler (discretiza-
tion). By the 0th order hold, the quantization error combining with the middle
value of one sampling time interval is ignored. Therefore, for the previous sig-
nal f(t), the delay with 1/2 sampling time can be found. In this sampling
control, 1/2 sampler considering the 0th order hold and the generation of
dead time in one sampling time from the calculation time is concerned. Hence,
there are a total of 1.5 sampling time delays. The sum of the dead time is
L1 = 1.5∆tp. With q1 = 1.5 in the relation equation (3.4) of the sampling
frequency, it can be obtained that
fs ≥27.5fc1.
(3.6)
This result is almost equal to the value of sampling frequency known from
experience, which is necessarily over 30 times that of the cut-oﬀfrequency.
According to the above, the experience value of about 30 times should be
considered in theory.
3.1.4 Experimental Veriﬁcation of the Sampling Frequency
Determination Method
The servo system device used in the experiment consists of the table driven
by a 0.85kW DC servo motor and ball spring, a servo controller (Yaskawa
motor CPCR-MR-CA15) and a personal computer (NEC-PC9801). In the
part of servo controller and the DC servo motor, the velocity loop is formed.
Moreover, in the computer, the position loop is constructed. In this case, the
velocity loop gain is Kv = 185[1/s] and the position loop gain is Kp = 1[1/s]
as well as Kv ≫Kp. The part of velocity loop can be approximated by
the direct connection (i.e. 1) in the block diagram. The overall servo system
is expressed by the 1st order system of equation (3.1). If Kp is set with a
small value, the remarkable deterioration in the sampling time interval can be
illustrated. According to the signal ﬂow, the position information of the DC
servo motor can be obtained by integrating the tachogenerator signal read in
the computer. The velocity command signal, calculated by the error of the
position information and position command, is added into the servo controller
through a D/A converter. Then, the velocity control is performed analogically

58
3 Discrete Time Interval of a Mechatronic Servo System
0
5
10
15
0
50
100
Time[s]
Position[mm]
0
5
10
15
0
50
100
Time[s]
Position[mm]
(a) fs = 31.4fc
(b) fs = 15.7fc
Fig. 3.1. Experimental results of the positioning control using shaft-driven device
by the DC servo motor according to the servo controller. Here, the sampling
time interval is changed freely using the computer in the position loop. For
verifying the eﬀectiveness, this part is implemented by hardware as the digital
(software) servo.
The experimental results are illustrated in Fig. 3.1. When satisfying the
relation equation (3.6) of the necessary sampling frequency in fs = 31.4fc1
of Fig.(a), there is the transient response wave which is almost equal to the
simulation results of the desired state without dead time. Thus, the desired
control properties can be obtained. When the relation equation (3.6) with
rough sampling time interval is not satisﬁed for the fs = 15.7fc1 of Fig.(b),
the overshoot was generated in the transient response and the control prop-
erties was decreased. Besides, the amplitude of the stage variation of graph
existed within the sampling time interval. From this point of view, the rela-
tion equation derived theoretically about the sampling frequency of equation
(3.6) can be veriﬁed. In the experiment system with strict high order items,
it is better to satisfy the relation equation (3.6) of the sampling frequency
calculated with the 1st order approximation of the servo system.
3.2 Relation between Reference Input Time Interval and
Velocity Fluctuation
In the servo controller, the general reference input generator is performed
digitally. The objective trajectory generation needs computing time. The gen-
erated objective trajectory is then changed into the step-wise function (refer
to 1.1.2 item 9) in a constant time interval (reference input time interval).
From this discrete command signal, the velocity ﬂuctuation of the reference
input time interval in the performed servo system is generated.
In the current mechatronic system of the industrial ﬁeld, for eliminat-
ing this velocity ﬂuctuation, the position command of the step between the
reference input time intervals is revised in the one-order hold value in each
sampling time interval of the servo system. That is to say, the output between
the reference input time interval is interpolated by line in each sampling time

3.2 Relation between Reference Input Time Interval and Velocity Fluctuation
59
interval. This is the method to produce consistency in the reference input time
interval and the sampling time interval.
In this section, the theoretical relation equation (3.9) of the reference input
time interval and the velocity ﬂuctuation is derived. The steady-state veloc-
ity ﬂuctuation is theoretically included when the strategy can be perfectly
adopted based on the above industrial ﬁeld pattern. Since the transient veloc-
ity ﬂuctuation cannot be solved by the above method, the reason for velocity
ﬂuctuation generation is explained clearly.
For the servo controller in which the position loop is increased by hand, when
the command of objective trajectory from outside based on the device on
sale is given, the velocity ﬂuctuation equivalent to equation (3.9) is generated
because the conditions of the industrial ﬁeld pattern is not satisﬁed. The
occurred velocity ﬂuctuation can be evaluated by the analysis results in this
part.
3.2.1 Mathematical Model of a Mechatronic Servo System
Concerning Reference Input Time Interval
(1) Velocity Fluctuation Generation within the Reference Input
Time Interval
In the reference input generator of a mechatronic servo system, the objective
position command values of each axis are calculated from the given opera-
tion task of the management part. At this time, the command values of an
articulated robot should be transformed from working coordinates to joint
coordinates. In addition, the curve part of the objective locus of an ellipse,
etc, should be approximated by a line in the orthogonal type of NC machine
tool. This necessary real calculation takes a long time, therefore, the reference
input time interval is deﬁned with a rough time interval. Thus, since the com-
mand input for the position control part is adopted when the objective value
of each reference input time interval is given, sampled and held, the deviation
of the rotational velocity of the motor, by the following velocity command
part, current reference part and power ampliﬁer part, and the velocity ﬂuc-
tuation in the response of the operation tip of the mechanism part driven by
motor is also generated. Hence, the control performance deteriorates.
Generally, the velocity ﬂuctuation factor of a mechatronic servo system
often exists in the transient state and its variation is bigger than the steady
state. Therefore, for avoiding the transition-state part and adopting a steady
state, in fact, the utilization method for keeping the motion precision of
the mechatronic servo system and the operational method for one axis are
adopted. In this section, the velocity ﬂuctuation of each reference input time
interval as the study object cannot be avoided in the steady state of one axis
operation. Moreover, since the velocity ﬂuctuation factors of a mechatronic
servo system are existed, it is very important to analyze them one by one.
For this purpose, the analysis on the relationship between the reference input

60
3 Discrete Time Interval of a Mechatronic Servo System
time interval of a mechatronic servo system and velocity ﬂuctuation is more
important than the analysis of their control performances.
(2) A Mathematical Model of a Mechatronic Servo System for
Analyzing the Velocity Fluctuation
The model for analyzing the velocity ﬂuctuation of each reference input time
interval of a mechatronic servo system is constructed. The model of a mecha-
tronic servo system for analyzing the relationship between the reference input
time interval and velocity ﬂuctuation can be expressed by the continuous 2nd
order system illustrated in Fig. 3.2, where r denotes objective trajectory. ∆T
denotes the reference input time interval in which the output command value
from the reference input generator to the position control part. hr denotes 0th
order hold in the reference input generator. up denotes the position command
value, Kp denotes the position loop gain, ∆tp denotes the sampling time inter-
val in the position loop. hp denotes the 0th order hold in the position control
part. uv denotes the velocity command value. Kv denotes the velocity loop
gain. v denotes the velocity of motion. p denotes the position of motion. In
the general operation, the objective trajectory r is the ramp input r = vreft
as the objective velocity vref.
The motion velocity of the mechatronic servo system of Fig. 3.2 is ex-
pressed as
dv(t)
dt
= −Kvv(t) + Kvuv(t)
(3.7)
where, Kv has the meaning of Kv2 in the equation (2.29) of the middle speed
2nd order model in the 2.2.4 item. Moreover, k is the number of the reference
input time interval. j is the sampling number of the position loop in ∆T (0 ≤
j < ∆T/∆tp). The random moment can be expressed by (k∆T + j∆tp + tp)
(0 ≤tp < ∆tp).
The position command value up is up(k∆T + j∆tp + tp) = vrefk∆T after
sampling the objective trajectory r(t) = vreft as the reference input time in-
terval ∆T and making it with 0th order hold. Therefore, the velocity command
value uv(k∆T + j∆tp + tp) can be expressed as
uv(k∆T + j∆tp + tp) = (vrefk∆T −p (k∆T + j∆tp)) Kp.
(3.8)
Fig. 3.2. 2nd order model of mechatronic servo system

3.2 Relation between Reference Input Time Interval and Velocity Fluctuation
61
When we input equation (3.8) into equation (3.7) and solving it on v(t),
then the motion velocity v(k∆T + j∆tp + tp) can be as
v(k∆T+ j∆tp + tp) =
5
1 −e−Kvtp<
(vrefk∆T −p (k∆T + j∆tp)) Kp
+ v (k∆T + j∆tp) e−Kvtp,
(0 ≤tp < ∆tp).
(3.9)
The analytical solution can be easily found out.
The e−Kvtp part of equation (3.9) expresses the change in ∆tp. The
vrefk∆T −p(k∆T + j∆tp) part expresses the change of ∆tp in ∆T. Based on
them, the velocity ﬂuctuation occurs in the mechatronic servo system illus-
trated in Fig. 3.2.
3.2.2 Industrial Field Strategy of the Velocity Fluctuation
Generated in Reference Input Time Interval
(1) Equivalent Method in Sampling Time Interval to the
Reference Input Time Interval
In the industrial ﬁeld, this kind of velocity ﬂuctuation should be avoided. One
way is to let the reference input time interval ∆T be equal to the sampling
time interval ∆tp of the position loop[18].
For the motion velocity equation (3.9) of the mechatronic servo system,
when we input the condition ∆tp = ∆T and eliminate the initial value by
adding the steady-state condition, the motion velocity can be as
v(k∆T + tp) = (vrefk∆T −p (k∆T)) Kp.
(0 ≤tp < ∆T)
(3.10)
The motion velocity v(k∆T + tp) is the constant within the reference input
time interval ∆T. From this point of view, the steady-state velocity ﬂuctuation
of each reference input time interval does not occur.
Although this method is simple, the control performance has deteriorated
because ∆tp is roughly adapted for ∆T and the position loop characteristic
cannot be improved. In addition, since the reference input time interval must
be reduced for shortening the ∆T to adapt for ∆tp, as a shortcoming, it is
costly.
(2) Conversion Method of Each Reference Input Time Interval
from the 0th Order Hold to the 1st Order Hold
Another method is that the 0th order hold hr of each reference input time
interval of each axis position command value calculated in the reference input
generator is converted into the 1st order hold[17].
Since the ramp-shape objective trajectory r(t) = vreft is 1st order hold
with vreft in ∆T, the position command is as up(k∆tp + tp) = vrefk∆tp, if
r(t) = vreft is 0th order hold in each sampling interval ∆tp of the position

62
3 Discrete Time Interval of a Mechatronic Servo System
loop. Therefore, the motion velocity of equation (3.9) is changed as below
after ∆T is replaced by ∆tp.
v(k∆tp + tp) = (vrefk∆tp −p (k∆tp)) Kp,
(0 ≤tp < ∆tp).
(3.11)
The motion velocity v(k∆tp + tp) becomes constant within ∆tp. Therefore,
the steady-state velocity ﬂuctuation of each reference input time interval does
not occur.
In this method, since ∆T can be lengthened and ∆tp can be shortened, it
does not need to change the reference input time interval ∆T mostly into the
short. However, for constructing the position control part by integer calcu-
lation, the 1st order hold of the position command value must be calculated
into the integer value and then the fractional control is needed. The algorithm
becomes complicated.
3.2.3 Parameter Relation between the Steady-State Velocity
Fluctuation and the Mechatronic Servo System
(1) Velocity Fluctuation in the Steady State
The strategy of restraining the velocity ﬂuctuation in the previous section
can be adopted at any time without limitation. In recent years, a mechatronic
servo system complete with the position loop has been on sale. The manage-
ment part and the reference input generator are constructed by computer and
therefore the simple mechatronic system can be constructed. By using this
kind of product, it is diﬃcult to adopt the strategy as introduced in the for-
mer section because the position loop is installed in advance. In recent years,
the module robot and self-organized robot are studied widely. Since the axis
number installed with the position loop and the number of robots are desired
to be able to change freely. Moreover, there are many complex trajectory
calculations when constructing the mechatronic servo system in the labora-
tory, adopting the strategy introduced in the former section is very diﬃcult.
Therefore, in this case, the theoretical analysis of the steady-state velocity
ﬂuctuation is important for the control performance prediction, design and
adjustment.
For the mechatronic servo system with the states introduced as above,
since ∆T ≫∆tp, the position loop can be continuously adopted. Therefore,
the mathematical models of the position control part, velocity control part,
motor part and mechanism part can be expressed as
d2p(t)
dt2
= −Kv
dp(t)
dt
−KvKpp(t) + KvKpup(t)
(3.12)
where Kp, Kv have the meaning of Kp2, Kv2 in equation (2.29) of the middle
speed 2nd order model in 2.2.4 item, respectively. Moreover, the input up(t)
is expressed by a step-wise function of

3.2 Relation between Reference Input Time Interval and Velocity Fluctuation
63
up(k∆T + tp) = vrefk∆T.
(3.13)
From equation (3.12) and (3.13), the velocity response of stage k in the steady
state is as
v(k∆T + tp) =
ps
1ps
2
ps
2 −ps
1
6
eps
2tp
1 −eps
2∆T −
eps
1tp
1 −eps
1∆T
=
vref∆T
(3.14)
(0 ≤tp < ∆T)
ps
1 = −Kv +
C
K2v −4KvKp
2
ps
2 = −Kv −
C
K2v −4KvKp
2
.
Therefore, from the maximum value and minimum value in the reference in-
put time interval ∆T of equation (3.14), the velocity ﬂuctuation es
v can be
calculated by
es
v =
ps
1ps
2
ps
2 −ps
1
61 −eps
1ts
max
1 −eps
1∆T −1 −eps
2ts
max
1 −eps
2∆T
=
vref∆T
(3.15)
ts
max =
1
ps
2 −ps
1
log ps
1
5
1 −eps
2∆T <
ps
2
5
1 −eps
1∆T <.
(3.16)
For this purpose, the velocity ﬂuctuation is generated in the steady state
of a mechatronic servo system. Its size is proportional to the objective velocity
vref.
(2) Application of the Analysis Results
By concerning the equation (3.15) expressing the relation between the ref-
erence input time interval ∆T derived in the last section and the velocity
ﬂuctuation es
v, the properties are obtained and graphed. Their application
method is also discussed.
When graphing the property of the velocity ﬂuctuation es
v, there are ﬁve
related parameters: es
v, Kp, Kv, vref, ∆T. These parameters can be worked
out by the relevant ratio of velocity ﬂuctuation es
v/vref, gain ratio npv =
Kv/Kp and Kp∆T. When setting gain ratio npv = Kv/Kp with 7, 10, 15,
20 respectively, Fig. 3.3 can be drawn with the vertical axis es
v/vref and
horizontal axis Kp∆T. From this ﬁgure, the relevant ratio es
v/vref of velocity
ﬂuctuation is increased following the increase of Kp∆T and gain ratio npv.
In the industrial ﬁeld, the design procedures of a mechatronic servo system
is that: ﬁrstly, the mechanism corresponding to the operational aim is designed
and the properties of the constructed mechanism are tested; then the servo
parameters (loop gains of velocity and position) without generating overshoot
is determined from the tested property; ﬁnally, the digital controller which
can implement the determined servo parameters is constructed.

64
3 Discrete Time Interval of a Mechatronic Servo System
Fig. 3.3. Relative velocity ﬂuctuation for Kp∆T
By using Fig. 3.3 and based on the velocity ﬂuctuation, the controller
design and machine type selection can be carried out. From the properties
of the mechanism, when using gain Kp = 20[1/s], Kv = 140[1/s], the refer-
ence input time interval ∆T of the reference input generator is determined
for making the relevant ratio of the velocity ﬂuctuation to converge within
es
v/vref = 4[%]. From the ﬁgure of npv = Kv/Kp = 7 in Fig. 3.3 and the cross
point of es
v/vref = 4[%], the Kp∆T = 0.22 can be read out. In order to make
the reference input time interval below ∆T = (0.22/20) × 1000 = 11[ms], the
controller is designed or selected.
As another application method in Fig. 3.3, the parameters Kp, Kv, vref,
∆T of mechatronic servo system are given. The velocity ﬂuctuation generation
of this mechatronic servo system can be predicted beforehand. For example, if
Kp = 15[1/s], Kv = 150[1/s], vref = 50[cm/s], ∆T = 20[ms], npv = Kv/Kp =
10 is drawn in Fig. 3.3. From the cross point of Kp∆T = 15 × 0.02 = 0.3,
es
v/vref = 10.0[%] can be read out. Therefore, the velocity ﬂuctuation is as
es
v = 50 × 0.10 = 5.0[cm/s]. The size of the generated velocity ﬂuctuation in
this mechatronic servo system can be known in advance.
3.2.4 Experimental Veriﬁcation of the Steady-State Velocity
Fluctuation
(1) Experimental Device and Experiment Conditions
In order to verify the property of the velocity ﬂuctuation expressed by equa-
tion (3.15), the experiment using DEC-1 (refer to experiment device E.1)
was carried out. The velocity loop gain of the servo controller of DEC-1 is
Kv = 100[1/s]. The position loop gain is given as Kp = 5[1/s] in the com-
puter. The experiment was carried out with the reference input time interval
∆T = 40[ms], objective velocity vref = 100[rpm], sampling time interval of
the position loop ∆tp = 1[ms] and control time 1[s]. The Kp is set with low
value for remarkable variation.

3.2 Relation between Reference Input Time Interval and Velocity Fluctuation
65
(2) Experimental Result
The experimental results between 0.9∼1 second with constant velocity ﬂuctu-
ation is illustrated in Fig. 3.4(a). The horizontal axis is time t[s], the vertical
axis is velocity v[rpm] and the solid line is the velocity response. The velocity
of motion is read in by computer the after A/D conversion of the tachogenera-
tor. Since the high-frequent noise mixing, the remarkable velocity ﬂuctuation
occurred in each ∆T near the objective velocity 100[rpm]. For making com-
parison with this experimental results, the analysis velocity output based on
the 2nd order model as equation (3.14) is shown by a broken line. From the
ﬁgure, there are similar shapes of the wave from the experiment and the bro-
ken line. In the experiment, the mean of velocity ﬂuctuation is 4.5[rpm]. It
is almost same as the theoretical value es
v = 4.3[rpm] calculated from the
equation (3.15) expressing the velocity ﬂuctuation derived in the last section.
Next, the velocity ﬂuctuation restraint strategy (∆tp = ∆T) illustrated
in 3.2.2(1) was performed. The experimental results and simulation results
of the mechatronic servo system are shown in Fig. 3.4(b). In this case, the
velocity ﬂuctuation with the reference input time interval occurred.
From the above experimental results, the equation (3.15) expressing the re-
lation between reference input time interval which is derived by the model and
the velocity ﬂuctuation can be veriﬁed. This mathematical model as equation
(3.7) is constructed based on the assumption, which is deﬁned when construct-
ing the continuous system mathematical model including the sampler derived
for velocity ﬂuctuation analysis of the mechatronic servo system.
The eﬀectiveness of equation (3.15) was veriﬁed by the experiment of above
one axis. Additionally, for a mechatronic servo system with an orthogonal
motion, the expansion from one axis to multiple axes can be carried out. Since
the articulated mechatronic servo system can be approximated in orthogonal
coordinates (refer to section 2.3) in the possible region of linear approximation
Fig. 3.4. Comparison between the experimental results using DEC-1 and the sim-
ulation results based on 2nd order model

66
3 Discrete Time Interval of a Mechatronic Servo System
within the general working region, the eﬀectiveness of the proposed method
can be also veriﬁed indirectly in the articulated mechatronic servo system.
3.2.5 Relation between Reference Input Time Interval and
Transient Velocity Fluctuation
(1) Transient Velocity Fluctuation of the Mechatronic Servo
System
In the industrial ﬁeld, the controller of a mechatronic servo system which can
restrain the velocity ﬂuctuation is designed. In the mechatronic servo system
which can restrain completely the steady-state velocity ﬂuctuation, the hold
circuit hr between the reference input generator and position control part uses
one-order hold circuit. The reference input time interval ∆T is set to be equal
to the sampling time interval ∆tp of the position loop (refer to 3.2.2).
In this part, since the transient velocity ﬂuctuation occurred even when re-
straining the steady-state velocity ﬂuctuation, its analysis is carried out as be-
low. As the control strategy, the transient velocity ﬂuctuation when ∆T = ∆tp
in 3.2.2(1) is adopted in the restraining the steady-state velocity ﬂuctuation.
In the continuous system, the mathematical model of the velocity control part,
motor part and mechanism part is expressed as
dv(t)
dt
= −Kvv(t) + Kvuv(t).
(3.17)
If k is the stage of the reference input time interval ∆T, any moment can
be expressed by (k∆T + tp)(0 ≤tp < ∆T). The position command value up
is up(k∆T + tp) = vref(k + 1)∆T by the 0th order hold when the objective
trajectory r(t) = vreft is sampled by the reference input time interval ∆T.
Therefore, the velocity command value uv(k∆T + tp) is expressed by
uv(k∆T + tp) = (vref(k + 1)∆T −p (k∆T)) Kp.
(3.18)
When equation (3.18) is put into equation (3.17), by a inverse Laplace
transform (refer to appendix A.1), the motion velocity v(k∆T+tp) is expressed
as
v(k∆T + tp) =
5
1 −e−Kvtp<
(vref(k + 1)∆T −p (k∆T)) Kp
+ v (k∆T) e−Kvtp,
(0 ≤tp < ∆T).
(3.19)
Therefore, the analytical solution can be easily solved. This equation (3.19) is
describing the damping of velocity command value changed stepwise within
time constant 1/Kv.
From the velocity of equation (3.19), in the zero inﬁnite state (objective
trajectory r(t) = vreft is continuous) of the reference input time interval, the
diﬀerence of velocity as

3.2 Relation between Reference Input Time Interval and Velocity Fluctuation
67
vr(t) = vref
$
1 +
1
ps
1 −ps
2
3
ps
2eps
1t −ps
1eps
2t:)
(3.20)
ps
1 = −Kv +
C
K2v −4KvKp
2
ps
2 = −Kv −
C
K2v −4KvKp
2
is obtained with ∆T and using the maximum and maximum of maximal error
(the ﬁrst reference input time interval (k = 1) of the smallest damping), the
maximal transient velocity ﬂuctuation et
v is deﬁned as
et
v = v(tt
max) −vr(tt
max)
(3.21)
= vref
.
∆TKp
3
1 −e−Kvtt
max
:
−
$
1 +
1
ps
1 −ps
2
3
ps
2eps
1tt
max −ps
1eps
2tt
max
:)0
.
(3.22)
However, tt
max is calculated by
∆Te−Kvtt
max +
1
ps
1 −ps
2
3
eps
2tt
max −eps
1tt
max
:
= 0.
(3.23)
(2) Graph of the Relationship Equation of the Transient Velocity
Fluctuation
In the analytical solution equation (3.22), since using many parameters is
diﬃcult, the relation between frequently adopted parameters and the transient
velocity ﬂuctuation is graphed.
When Kv = 100[1/s] is ﬁxed, Fig. 3.5 illustrated the reference input time
interval ∆T[s] when using Kp =1, 5, 10, 20[1/s] and the division et
v/vref[%]
of the transient velocity ﬂuctuation for the objective velocity. By using this
ﬁgure, the relationship between the reference input time interval and the tran-
sient velocity ﬂuctuation can be known.
3.2.6 Experimental Veriﬁcation of the Transient Velocity
Fluctuation
In order to verify the transient velocity ﬂuctuation within the reference
input time interval analyzed in the last part, an experiment was carried
out using DEC-1(refer to experiment device E.1). The experimental con-
ditions are ∆T = ∆tp = 40[ms], Kp = 5[1/s] and the objective velocity
vref = 10.5[rad/s](100[rpm]). The velocity response between 0.4 second from
the beginning of control is shown in Fig. 3.6(a). Figure 3.6(b) shows the ve-
locity ﬂuctuation. Here, the horizontal axis is the time t[s], the upper part of
the vertical axis is the velocity v(t)[rad/s] and the bottom part is the velocity

68
3 Discrete Time Interval of a Mechatronic Servo System
0
10
20
30
40
50
0
0.02
0.04
0.06
0.08
0.1
∆T
e   / v      
  v     ref
Kp
10
5
1
[%]
[s]
= 20 [1/s]
Fig. 3.5. Relation between velocity ﬂuctuation es
v and reference input time interval
∆T (Kv = 100[1/s])
[s]
[rad/s]
simulation
experiment
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
t
v
(a) Velocity response
[s]
[rad/s]
0
0.2
0.4
0.6
0.8
1
1.2
1.4
0
0.1
0.2
0.3
0.4
t
e   v
(b) Velocity ﬂuctuation
Fig. 3.6. Experimental results using DEC-1 and simulation results using 2nd order
model
ﬂuctuation et
v(t)[rad/s]. The solid line denotes the experimental result, and
the dotted line is the simulation results analyzed strictly by using Neuman
series for diﬀerential equation of (3.17) within 1[ms]. The characteristics of
the transient velocity ﬂuctuation between the experiment and the simulation
are very close. In each reference input time interval ∆T = 40[ms], the velocity
ﬂuctuation occurred and then decreased slowly. In the experiment, the size
of the initial maximal velocity ﬂuctuation of the initial stage is 1.10[rad/s].
By using Fig. 3.5 for visualizing the equation (3.22), with Kv = 100[1/s],
∆T = 40[ms] and Kp = 5[1/s], the velocity ﬂuctuation to objective velocity

3.3 Relationship between Reference Input Time Interval and Locus Irregularity 
69
can be as et
v/vref =  11.0[%]. Therefore, the theoretical value of the transient
velocity ﬂuctuation is et
v =  0.110×10.5 = 1.16[rad/s]. It is almost the same as
the experimental result. Based on the above, the eﬀectiveness of the analysis
results can be veriﬁed.
3.3 Relationship between Reference Input Time Interval
and Locus Irregularity
The reference input time interval and the velocity ﬂuctuation in the digital
controller was introduced in the section 3.2. However, in the contour control,
this ﬂuctuation may occur on the surface of the product and this surface can be
changed as rough expressed as locus irregularity. This locus irregularity may
occur in each reference input time interval when the servo system property of
each axis in the mechanism is not consistent. The generation mechanism of
this locus irregularity and its quantitative analysis are expected.
The analytical solution of locus irregularity generated in each reference input
time interval is given in equation (3.29).
By using the theoretical analysis solution of the locus irregularity, the predic-
tion of movement precision of the robot or machine tool as well as the design
arrangement of the mechatronic servo system of the required locus precision
are possible.
3.3.1 Locus Irregularity in the Reference Input Time Interval
(1) Mathematical Model of the Orthogonal Two-Axis Mechatronic
Servo System
For analyzing the relation between the reference input time interval of a
mechatronic servo system and locus irregularity, ﬁrstly, the mathematical
model of the orthogonal two-axis mechatronic servo system is constructed,
and then its response in each reference input time interval is calculated. The
relationship between the reference input time interval and the locus irregu-
larity is analyzed quantitatively. Next, its analysis result is expanded into the
joint coordinates and space coordinates. The general locus irregularity of the
mechatronic system is discussed.
As the reason of deterioration of the control performance, the eﬀect of coor-
dinate transform and mechanism dynamics, the calculation time in the digital
controller, the resolution of the encoder or D/A converter, cogging torque as
well as stick-slip should be considered. Generally, when a mechatronic sys-
tem is structured with multiple axes. But it is better to separately consider
the problem of generation in each axis of servo system and the problem of
generation of multi-axis structure (refer to 1.1.2 item 6).
The reference input generators and position control parts are always
adopted with a digital controller. Since the position control part is simply

70
3 Discrete Time Interval of a Mechatronic Servo System
used for computation, its computation cycle is carried out within the narrow
sampling time interval. But the reference input generator performs compli-
cated computation, such as inverse kinematics computation, etc. Therefore,
its computation cycle is longer than the sampling time interval. According
to this width of reference input time interval, the velocity ﬂuctuation occurs
at one axis and the locus irregularity occurs when combining two such axes.
Therefore, the problem of the locus irregularity is ﬁrstly solved in the orthogo-
nal two-axis mechatronic system with x axis and y axis, and then the problem
of locus irregularity of the general mechatronic system with coordinate trans-
form is solved.
With the general motion condition, the model of x axis and y axis in the
orthogonal two-axis mechatronic servo system can be constructed with a 1st
order system respectively (refer to the item 2.2.3)
dpx(t)
dt
= −Kpxpx(t) + Kpxux(t)
(3.24a)
dpy(t)
dt
= −Kpypy(t) + Kpyuy(t)
(3.24b)
where px(t), py(t) are positions in time t, dpx(t)/dt, dpy(t)/dt are velocities,
ux(t), uy(t) are servo system input of each axis, Kpx, Kpy have the meanings
of Kp1 in the low speed 1st order model equation (2.23) of item 2.2.3 at x axis
and y axis
For a mechatronic system, in order to make the steady-state error values
of each axis similar at the initial arrangement time of device, the position loop
gain of the controller of each axis in servo system should be regulated. Ac-
cording to the motion condition and working load based on the arrangement,
the property of the servo system will be changed slightly. There are existing
the regulation error at the initial self-arrangement. Therefore, these summed
errors accumulate the diﬀerence of position loop gain Kpx of equation (3.24a),
(3.24b) and Kpy express the property of the mechatronic servo system with
the 1st order system. The diﬀerence of Kpx and Kpy is the reason for the
generation of locus irregularity.
(2) Response of a Mechatronic Servo System in Each Reference
Input Time Interval
The locus irregularity, as the analysis object, occurred in the rough reference
input time interval, occurred in the transient state with changeable input,
cannot be found in the steady state. Generally, in the transient state, there
have been other kinds of locus deterioration except this locus irregularity.
Comparing with the transient state, the locus precision of contour control
in the steady state can be improved. However, the locus irregularity in each
reference input time interval in this section is the main reason of dominant rest
contour control performance deterioration in the steady state. Wherein, the

3.3 Relationship between Reference Input Time Interval and Locus Irregularity    71
steady state analysis as the discussion point is performed. In the steady state,
the response features with the reference input time interval is the transient
response.
The aim of this analysis is to understand the quantitative relation between
the reference input time interval and the steady state of locus irregularity.
Therefore, the drawn objective locus of the mechatronic system is a straight
line (the objective operation velocity of each axis is constant) and the input
of the model of a mechatronic servo system as the equation (3.24a)(3.24b) is
constructed.
The objective working velocity of each axis is vx, vy, respectively. The
input ux(t), uy(t) of each axis of the servo system calculated in each reference
input time interval ∆T is expressed by the step-wise function of ∆T amplitude
as
ux(t) = vx∆TU(t) + vx∆TU(t −∆T)
+ vx∆TU(t −2∆T )  + vx∆TU(t −3∆T )  + · · ·
(3.25a)
uy(t) = vy∆TU(t) + vy∆TU(t −∆T)
+ vy∆TU(t −2∆T )  + vy∆TU(t −3∆T )  + · · ·
(3.25b)
where U(t) is the unit step function.
For analyzing the locus irregularity generated with a rough reference input
time interval, the above equation (3.24a)∼(3.25b) are one of the main point of
this analysis and their solutions can be easily obtained by the existed analysis
method. Here, a Laplace transform (refer to the appendix A.1) is carried out
in equation (3.25a), (3.25b), and put them into the equation (3.24a), (3.24b)
which have been also transformed by a Laplace transform. Then the response
in each ∆T can be solved. If performing an inverse Laplace transform (refer
to appendix A.1), the response in one reference input time interval ∆T with
big enough stage m of ∆T is as
px(m∆T + t) = vx∆T 
6
m −
e−Kpxt
1 −e−Kpx∆T
=
, (0 ≤t < ∆T).
(3.26a)
py(m∆T + t) = vy∆T
6
m −
e−Kpyt
1 −e−Kpy∆T
=
, (0 ≤t < ∆T).
(3.26b)
For this purpose, since the input of the mechatronic servo system and the
servo system can be clearly expressed by the equations (3.24a), (3.24b) and
(3.25a), (3.25b), the response in each reference input time interval ∆T in the
steady state can be clearly worked out. These response equations (3.26a),
(3.26b) in each ∆T is adopted for the locus irregularity analysis in the next
part.
(3) Theoretical Solution of the Locus Irregularity
From the response equation (3.26a) and (3.26b) in each reference input time
interval ∆T, the time t is eliminated, and then the response locus of the

72
3 Discrete Time Interval of a Mechatronic Servo System
x
y
Locus irregularity
Objective locus
y = (vy /vx) x
Pmax = (x(m∆T+tm),y(m∆T+tm))
Pmin = (x(m∆T+0),y(m∆T+0))
Pmax
Pmin
Fig. 3.7. Locus irregularity in mechatronic servo system
mechatronic system is obtained. The error between the locus of this mecha-
tronic system and the objective locus is the locus error . This locus error is
determined by the normal vector distance from the objective locus to the lo-
cus of the servo system. By the error of maximum value and minimum value
of locus error in one reference input time interval, the locus irregularity is
deﬁned.
In Fig. 3.7, the response among many reference input time intervals of
an orthogonal two-axis mechatronic servo system is shown. In Fig. 3.7, the
horizontal axis is the x axis, vertical axis is the y axis and the dotted broken
line is the objective locus y = (vy/vx)x. At the moment (m∆T + t), the
normal vector distance from objective locus y = (vy/vx)x to locus coordinate
(x(m∆T + t), y(m∆T + t)) is
e(t) = |vyx(m∆T + t) −vxy(m∆T + t)|
A
v2x + v2y
.
(3.27)
When we put px, py of equation (3.26a), (3.26b) into x and y, the locus error
e(t) is as
e(t) = vxvy∆T
A
v2x + v2y
JJJJ
e−Kpxt
1 −e−Kpx∆T −
e−Kpyt
1 −e−Kpy∆T
JJJJ .
(3.28)
As shown in Fig. 3.7, if the locus is minimal position Pmin at t = 0 and the
maximal position Pmax as de(t)/dt = 0, the locus irregularity em is as below
by the error of maximal value and minimal value of the locus error e(t) and
using equation (3.28).
em = |e(tm) −e(0)|

3.3 Relationship between Reference Input Time Interval and Locus Irregularity    73
= vxvy∆T
A
v2x + v2y
JJJJ
e−Kpxtm −1
1 −e−Kpx∆T −e−Kpytm −1
1 −e−Kpy∆T
JJJJ
(3.29)
where tm is as below with de(t)/dt = 0
tm =
1
Kpx −Kpy
log Kpx
5
1 −e−Kpy∆T <
Kpy (1 −e−Kpx∆T ) .
(3.30)
This equation (3.29) is the analytical solution of locus irregularity occur-
ring in each reference input time interval ∆T. From equation (3.29), if the
position loop gain Kpx of the x axis and Kpy of the y axis are the same, em
is zero. In general, it is diﬃcult to make the position loop gain Kpx and Kpy
of the servo system in the mechatronic servo system absolutely the same, i.e.,
(Kpx ̸= Kpy). As the reason, the generation of locus irregularity according
to the equation (3.29) in each reference input time interval ∆T can be found
from the above equation.
(4) Expansion to the Articulated Robot
The discussion on the analysis of locus irregularity occurred in the orthogonal
two-axis mechatronic servo system, carried out at 3.3.1(3), is expanded to the
articulated robot. The articulated robot with two axes is constructed with
two rigid links and two joints, as illustrated in Fig. 2.11 of section 2.3. Each
joint has a servo motor and is constructed by a position control system. Its
each joint angle is controlled to follow the objective angle.
The mathematical model of each axis in the articulated robot shown in
Fig. 2.11 is expressed as the following 1st order system with the same discus-
sion with equation (3.24a) and (3.24b).
dθ1(t)
dt
= −Kp1θ1(t) + Kp1u1(t)
(3.31a)
dθ2(t)
dt
= −Kp2θ2(t) + Kp2u2(t)
(3.31b)
where dθ1(t)/dt, dθ2(t)/dt are the angle velocities, Kp1, Kp2 have the meanings
of Kp1 in the low speed 1st order model equation (2.23) of item 2.2.3 for each
joint. u1(t), u2(t) are input of each axis.
For discussing the locus irregularity on the working coordinates (x, y) for
this articulated robot, the relation with the locus irregularity in the joint
coordinates (θ1, θ2) is worked out. The transformation from joint coordinates
(θ1, θ2) to working coordinates (x, y) is expressed as (refer to section 2.3)
x = l1 cos(θ1) + l2 cos(θ1 + θ2)
(3.32a)
y = l1 sin(θ1) + l2 sin(θ1 + θ2).
(3.32b)
The transformation between two coordinates is a nonlinear transform. It
adopts the linear transformation within the small part. The relation between

74
3 Discrete Time Interval of a Mechatronic Servo System
the slight change (dθ1, dθ2) near (θ0
1, θ0
2) in the joint coordinates and the slight
change (dx, dy) in the working coordinates is expressed by a one-order approx-
imation of a Taylor expansion as
6
dx
dy
=
= J
6
dθ1
dθ2
=
(3.33)
where J is the Jacobian matrix
J =
6 −l1 sin(θ0
1) −l2 sin(θ0
1 + θ0
2) −l2 sin(θ0
1 + θ0
2)
l1 cos(θ0
1) + l2 cos(θ0
1 + θ0
2)
l2 cos(θ0
1 + θ0
2)
=
.
(3.34)
Moreover, by using the same Jacobian matrix J, two coordinates for velocity
can be expressed as
⎛
⎜
⎝
dx
dt
dy
dt
⎞
⎟
⎠= J
⎛
⎜
⎝
dθ1
dt
dθ2
dt
⎞
⎟
⎠.
(3.35)
With the common motion condition, in the joint coordinates of the artic-
ulated robot, the model (3.31a), (3.31b) can be approximated by the model
(3.24a), (3.24b) of an orthogonal two-axis mechatronic servo system (refer to
section 2.3). In an articulated robot with the discussion of 3.3.1(1)∼(3) by
using (3.24a), (3.24b), the locus irregularity can be expressed approximately
by the relation equation (3.29).
(5) Expansion to the Three-Axis Mechatronic Servo System
The discussion in 3.3.1(4) is the locus irregularity discussion on the plate of
two axes. In this part, the locus irregularity discussion is expanded to three
axes. In the expansion from two axes discussion to three axes, the z axis is
added with the x axis and the y axis in the mechatronic servo system model
(3.24a), (3.24b)
dpz(t)
dt
= −Kpzpz(t) + Kpzuz(t)
(3.36)
where pz(t) is the position of the z axis, dpz(t)/dt is velocity, uz(t) is the input
of servo system, Kpz has the meaning of Kp1 in the low speed 1st order model
(2.23) of item 2.2.3 in the z axis. The input uz(t) of servo system of the z axis
is as
uz(t) = vz∆TU(t) + vz∆TU(t −∆T)
+ vz∆TU(t −2∆T ) + vz∆TU(t −3∆T ) + · · · .
(3.37)
If calculating the response of the z axis after enough stage number m is put
into equation (3.36), as similar as equation (3.26a), (3.26b), it can be obtained
that

3.3 Relationship between Reference Input Time Interval and Locus Irregularity    75
pz(m∆T + t) = vz∆T 
6
m −
e−Kpzt
1 −e−Kpz∆T
=
,
(0 ≤t < ∆T)
(3.38)
where vz is the objective velocity of the z axis.
In the orthogonal plate with an objective locus, the locus error e3(t) is the
distance with the space coordinates (px(m∆T +t), py(m∆T +t), pz(m∆T +t))
of the servo system calculated according to the (3.26a), (3.26b), (3.38) about
the objective space coordinates. By using the locus error at the moment of
t = 0 and de3(t)/dt = 0, the locus irregularity can be calculated by
em3 = |e3(tm3) −e3(0)|
(3.39)
where tm3 is the moment of de3(t)/dt = 0.
Based on the above, the locus irregularity discussion about two axes can
be expanded into the three axes.
3.3.2 Experimental Veriﬁcation of the Locus Irregularity
Generated in the Reference Input Time Interval
(1) Experimental Result of Locus Irregularity
For verifying the theoretical analysis results of equation (3.29) of locus irreg-
ularity in each reference input time interval derived in item 3.3.1, the experi-
mental work was carried out using DEC-1 (refer to experiment deviceE.1). In
a mechatronic system, since it is diﬃcult to make the gain of the servo system
of each axis exactly consistent, the locus irregularity occurs in each reference
input time interval. This experiment imitates the actual situation. The DC
servo motor is rotated two cycles by changing the conditions of one motor.
The ﬁrst rotation is the motion of the x axis and second rotation is the motion
of the y axis. Combining the motion results of two rotations, the experiment
of an orthogonal two-axis mechatronic servo system was carried out. The in-
consistency of position loop gain of the servo system was realized by changing
the setting of position loop gain Kp in the computer for experiment.
The control conditions are reference input time interval ∆T = 0.1[s], ob-
jective velocity vx = vy = 6[rad/s], sampling time interval ∆tp = 0.01[s], x
axis (Kp = 10[1/s] = Kpx) for the ﬁrst rotation, y axis (Kp = 11[1/s] = Kpy)
for the second rotation. These control conditions are selected if the torque
limitation (current limitation) of the servo driver need not be considered in
the experiment.
The experimental results are shown in Fig. 3.8 and Fig. 3.9. Fig. 3.8 il-
lustrates the objective locus and the results of the locus in the experiment of
the orthogonal two-axis mechatronic servo system. The horizontal axis is the
x axis position [rad]. The vertical axis is the y axis position [rad]. In Fig. 3.8,
for checking the locus irregularity that occurred in experiment, the calculated
locus error is given in Fig. 3.9. The horizontal axis is the motion distance [rad]
combining the x axis and the y axis. The vertical axis is locus error [rad]. The

76
3 Discrete Time Interval of a Mechatronic Servo System
solid line is the experimental results and the dotted line is simulation results
of the servo system using the 1st order system as (3.24a), (3.24b).
From Fig. 3.9, the steady-state error and occurred unevenness in each
reference input time interval of the locus can be seen. Since this steady-state
error is diﬀerent from the error of considered object in this research, it is the
reason of the response delay of control system. The unevenness generated in
each reference input time interval is the locus irregularity which is the object
of this research. This locus irregularity causes the coarseness of movement
in the robot. From the ﬁgure, the locus irregularity is 4.44 × 10−3[rad]. It is
consistent with the calculated value 5.12 × 10−3[rad] based on the theoretical
analytical solution of equation (3.29). It proves that the theoretical analytical
solution about locus irregularity is as almost same as the experimental results
in terms of shape and values. Moreover, there are about 0.003[rad] diﬀerence
in faces to 0.04[rad] in the steady-state error of locus error. However, from the
overall point of view, the simulation is very consistent with the experiment.
0
5
10
0
5
10
x [rad]
y [rad]
Experiment
Objective locus
Fig. 3.8. Experimental result of locus irregularity
0
5
10
0
0.02
0.04
Position[rad]
Locus irregularity[rad]
Experiment
Simulation
Fig. 3.9. Comparison between experimental results and simulation results based on
1st order model

3.3 Relationship between Reference Input Time Interval and Locus Irregularity    77
10
20
30
0
20
40
Kpx = 20 [1/s]
∆T [ms]
em/vref [µs]
Kpy = 20.2 [1/s]
20.5
21
22
Fig. 3.10. Relation between reference input time interval and locus irregularity
Besides, the angle opening in the wave shape in the experimental results is
caused by the rough encoder resolution 2000[pulse/rev].
Based on the above, the eﬀectiveness of the relation equation (3.29) of
the reference input time interval of the orthogonal two-axis mechatronic servo
system in the steady state and locus irregularity was veriﬁed. According to
the explanation in 3.3.1(4) and (5), it veriﬁed that the proposed method can
be also adopted in the articulated robot because the experimental results can
be approximated within allowance in the working linearizable region.
3.3.3 Application Value of the Theoretical Analysis Result
In this part, the application method of equation (3.29) of the theoretical
analysis results of locus irregularity veriﬁed by experiment is discussed. From
equation (3.29), with 0 ≤vx, vy ≤vref, the size of locus irregularity becomes
maximum when the objective operation velocity adopts vx = vy = vref of the
maximal value for both two axes. Therefore, if we put vx = vy = vref into
equation (3.29) as
em = vref∆T
√
2
JJJJ
e−Kpxtm −1
1 −e−Kpx∆T −e−Kpytm −1
1 −e−Kpy∆T
JJJJ
(3.40)
the locus irregularity em is then proportional to the objective operation ve-
locity vref.
This equation (3.40) is drawn in the graph. In order to understand the
relationship of various parameters in a two-dimensional graph easily, the ver-
tical axis is the locus irregularity em/vref for objective working velocity. The
calculation results in the steady state about the objective working velocity in
the reference input time interval ∆T is shown in Fig. 3.10. In the industrial
ﬁeld or a robot, there have been several percent to 10% diﬀerence amongst the
gains of each axis of the servo system in the machine tool. For understanding
the regions of these properties, the position loop gain of the x axis is ﬁxed as
Kpx = 20[1/s]. The position loop gains of the y axis is changed as Kpy =20.2
(1[%]), 20.5 (2.5[%]), 21 (5[%]), 22 (10[%])[1/s] (% denotes the division of
Kpx and Kpy). The locus irregularity is increased along the increment of the

78
3 Discrete Time Interval of a Mechatronic Servo System
reference input time interval ∆T. In addition, the deviationof Kpx andKpy
can be easily found visually with their increment. By using this graph, if the
deviation of Kpx and Kpy of the mechatronic servo system is known, the occur-
rence of locus irregularity can be predicted in advance. Concretely, the gains
are Kpx = 20[1/s] and Kpy = 21[1/s](5% error), the reference input time in-
terval is ∆T = 20[ms] and the objective operation velocity is vref = 0.4[m/s].
As shown by the dotted line in Fig. 3.10, the locus irregularity em/vref of
the objective velocity is 35[µs] for ∆T = 20[ms] and Kpy = 21[1/s]. If the
objective operation velocity is vref = 0.4[m/s], the locus irregularity is then
0.4 × 35 = 14[µm].
In general, there are many reasons for locus irregularity. For restraining
it, the encoder resolution is always raised and the sampling time interval of
the position loop is shortened in the industrial ﬁeld. Based on the theoreti-
cal analysis, it is known the fact that the locus irregularity occurred in the
reference input time interval ∆T is the main eﬀect on the locus precision.
Next, by using the Fig. 3.10 graphing the analysis results, how many ref-
erence input time intervals determines the control precision is discussed. If
the position loop gains of a mechatronic servo system are Kpx = 20[1/s] and
Kpy = 20.5[1/s](2.5% error), objective operation velocity is vref = 0.1[m/s]
and locus irregularity is below 1[µm], the reference input time interval ∆T
can be worked out. Since the objective working velocity is vref = 0.1[m/s],
locus irregularity is em/vref = 10[µs]. From the broken line in Fig. 3.10, ∆T
can be 15[ms]. Therefore, for restraining the locus irregularity below 1[µm],
it is necessary to set the reference input time interval of the digital controller
below ∆T = 15[ms]. For this purpose, it should prepare the computer which is
capable of computing the velocity within 15[ms] for objective command calcu-
lation. In the industrial ﬁeld, the allowance of locus irregularity is varied from
the working aim. In the current NC machine tool, if the encoder resolution
adopted in the motor is 1[µm] and its locus precision is required as 0.5[µm],
the 10[µm] locus precision in laser cutting is needed. For guaranteeing this lo-
cus precision, the size of locus irregularity should be restrained to be a small
value for satisfying the locus precision in the other reference input time in-
tervals in the steady state. By using the relationship between reference input
time interval and locus irregularity shown in Fig. 3.10, the reference input
time interval ∆T can be determined based on the required locus precision in
the design process. Fig. 3.10 can be also adopted as the useful ﬁgure in the
design process.

4
Quantization Error of a Mechatronic Servo
System
The control circuit of a servo controller is a completely software servo system
equipped by software (micro-computer) and adopted widely in mechatronic
systems in recent years. The rotation position of the motor is obtained from an
encoder in the position detector installed in the motor. The resolution of the
position is determined by a bit number of the encoder (encoder resolution).
The quantization of torque information driving the motor (torque resolution)
is determined by a D/A converter generating a command in the power ampli-
ﬁer according to motor current, equivalent to torque, and the bit number of the
A/D conversion for performing feedback. In this chapter, encoder resolution
and control performance of torque resolution and servo system is introduced.
4.1 Encoder Resolution
In the software servo system, a general velocity feedback signal is obtained
according to the diﬀerence computation of the pulse signal about the position
in encoder. When the encoder resolution is low, the resolution of velocity
information then becomes low and contour control performance is degraded.
In general, encoder resolution is determined from the positioning precision in
many cases in industry. However, it is insuﬃcient. Although it is necessary to
determine the resolution considering contour control performance, the relation
between the resolution of the encoder and control performance is not distinct
in the past.
Concerning the software servo system, a mathematical model is derived while
keeping the essential nature of encoder. Through analyzing this equation,
the encoder resolution can be determined by equation (4.6) according to its
contour control performance.
From contour control performance required in a software servo system, en-
coder resolution is determined properly.
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 79–96, 2004.
Springer-Verlag Berlin Heidelberg 2004

80
4 Quantization Error of a Mechatronic Servo System
4.1.1 Encoder Resolution of the Software Servo System
(1) Software Servo System Structure
In a software servo system, the position controller and the velocity controller
are constructed in software. In addition, the current controller is also con-
structed in software. In this section, concerning the control problem about
position, the position controller and velocity controller are only taken into
account by neglecting the current controller and power ampliﬁer whose prop-
erties are ideally considered. The relevant structure of the software servo sys-
tem is shown in ﬁgure 4.1. The software servo system is brieﬂy classiﬁed into
the servo controller, motor and mechanism part. The position and velocity of
motor are controlled by the servo controller. The control system of the servo
controller is always constructed with the position loop and the velocity loop
in the industrial ﬁeld.
The positioning precision of a software servo system is determined by the
resolution of the encoder installed in the servo motor, i.e., according to the
measured position of the motor through dividing one rotation of the motor.
The position output of the servo motor is the accumulated pulse output of the
encoder by a counter, and measured by putting data at each sampling time
interval (refer to section 3.1) into the servo controller.
In an analogue servo system, the velocity signal can be measured contin-
uously by a velocity detector. In a software servo system, however, since the
velocity detector is not installed, so as to reduce the cost, velocity is calculated
from the position signal. Velocity calculation often adopted in the industrial
ﬁeld is the method according to the simple diﬀerence of position. In the fol-
lowing analysis, velocity computation is performed by diﬀerence computation.
Since velocity can be only calculated based on resolution determined by the
diﬀerence computation of the pulse in software servo system, the precision
of velocity feedback is deteriorated compared with an analogue servo system.
Hence, control performance is degraded due to a decrease of resolution of the
velocity feedback signal because of diﬀerence computation, and ripple-type
velocity ﬂuctuation in the output of the the servo system is generated. This
velocity ﬂuctuation is diﬀerent compared with the ripple-type velocity in the
velocity detector of an analogue servo system. Since ripple-type velocity in
dy/dt
-
-
K p
K
+
+
u
y
v
d y/dt
1
s-
1
s-
2
2
Servo controller
Motor and mechanism part
Velocity 
signal
Position signal
Difference
operation
Counter
Encoder
Fig. 4.1. Structure of software servo system

4.1 Encoder Resolution
81
a velocity detector is generated as the detection noise of rotation velocity,
ripple-type velocity can be prevented by smoothing this detection noise with
a low pass ﬁlter. However, a ripple-type velocity ﬂuctuation of a software servo
system cannot be smoothed by a low pass ﬁlter because varied frequency in-
troduced later is related with the objective velocity. Therefore, it is necessary
to determine the encoder resolution for forcing the velocity ﬂuctuation within
the allowance region.
(2) Present Condition of Encoder Resolution Determination
The determination of present encoder resolution in the industrial mechatronic
software serve system is carried out according to the necessity of positioning
precision of a mechatronic servo system[4]. When performing contour control,
the encoder resolution calculated from positioning precision is used without
change. When required, control performance cannot be obtained, the encoder
resolution with test error will be regulated. The determination of encoder res-
olution cannot be realized theoretically for the required control performance.
Therefore, in this chapter, the theoretical determination method for encoder
resolution for control performance, especially about contour control issue, con-
sidering the relationship between ripple-type velocity ﬂuctuation and encoder
resolution, is proposed.
4.1.2 A Mathematical Model and Resolution Judgement for
Encoder Resolution
(1) A Mathematical Model of a Software Servo System
An industrial mechatronic servo system is always under the velocity condition
of motion of the operated motor at 1/20 ∼1/5 of maximum velocity. Its
dynamics is expressed by the 2nd order system as (refer to the 2.2.4)
Y (s) =
KpKv
s2 + Kvs + KpKv
U(s)
(4.1)
where Y (s) is the position output of the servo system, U(s) is the position in-
put of the servo system. Kp, Kv have the meaning of Kp2, Kv2 in the equation
(2.29) of the middle speed 2nd order model in the item 2.2.4, respectively.
The control system of the mechatronic servo system expressed by (4.1)
is picked out from the software servo system shown in ﬁgure 4.1 for encoder
resolution analysis. The model of software servo system for simplifying the
analysis is shown in ﬁgure 4.2. From the structure of the software servo system
(Fig. 4.1), the velocity feedback calculated based on diﬀerence computation
is easily obtained from the external input. However, this external input, as
a simple external input, is the same as the velocity signal in Fig. 4.1. This
external input is the continuous feedback of the velocity output in an analogue

82
4 Quantization Error of a Mechatronic Servo System
-
-
K p
K
+
+
u
y
v
d y/dt
dy/dt
1
s-
1
s-
2
2
Velocity feedback signal
Discretization and quantization
Fig. 4.2. Software servo system model for encoder resolution analysis
servo system. But in a software servo system, it is a discrete feedback. The
basic unit of the position signal is 1[pulse]. The velocity signal is calculated
with the diﬀerence computation of the position signal. The basic unit of the
velocity signal according to diﬀerence computation is 1/∆tp[pulse/s], where
∆tp[s] is the sampling time.
(2) Relationship between Control Performance and Encoder
Resolution
The relative equation between velocity ﬂuctuation, occurred according to en-
coder resolution, and servo parameters is derived. In this part, the velocity
ﬂuctuation is analyzed when the motion of the servo motor is under the con-
stant velocity, which is always adopted in the industrial ﬁeld (refer to item 8
of 1.1.2). The ﬂow of signal is as Fig. 1.1.2.
1. The diﬀerence divided according to velocity resolution 1/∆tp, determined
by diﬀerence computation of the position signal, is accumulated. When
the accumulated value is over the velocity resolution, the velocity feedback
signal is added with 1/∆tp. This added velocity feedback signal is the
reason for the velocity ﬂuctuation.
2. According to the velocity loop gain Kv added into the velocity feedback
signal, the input of the motor is varied with the step of Kv/∆tp[pulse/s2].
3. The change of velocity output of the motor based on the added velocity
feedback signal is as (Kv/∆tp) × ∆tp = Kv[pulse/s], according to the
integral of the input of the motor based on the sampling time interval
∆tp.
That is to say, the size of velocity ﬂuctuation, occurred by the signal added into
velocity feedback according to the eﬀect of velocity resolution, is consistent
with the value of velocity loop gain Kv. This relation can be expressed, if
considering the unit, as
∆N = 60Kv
RE
(4.2)
where ∆N[rev/min] denotes the velocity ﬂuctuation amplitude with the
ripple-type shape, RE[pulse/rev] denotes the encoder resolution deﬁned by
the pulse number of the encoder when the motor rotates through one cycle.

4.1 Encoder Resolution
83
This derived equation (4.2) is the fundamental equation for determining the
following encoder resolution.
Next, the relationship between the velocity ﬂuctuation period with the
ripple-type shape and velocity of the objective trajectory is derived. If the ve-
locity of the objective trajectory is as Vref[pulse/s], the velocity feedback, ob-
tained from the diﬀerence computation, is changed as (⌈Vref∆tp⌉)/∆tp when
the velocity resolution is 1/∆tp, where ⌈x⌉is the maximal integer below x.
From 1, this error is accumulated in each sampling time interval. Since the
velocity ﬂuctuation with the ripple-type shape occurred when the error is over
1/∆tp, The sampling time n at the moment of over 1/∆tp is as
n
6
Vref −⌈Vref∆tp⌉
∆tp
=
=
1
∆tp
.
(4.3)
From (4.3), the velocity ﬂuctuation frequency fr[Hz] is calculated by
fr =
1
n∆tp
= Vref∆tp −⌈Vref∆tp⌉
∆tp
.
(4.4)
From (4.4), the velocity ﬂuctuation frequency fr is depended on the velocity
of objective trajectory Vref. In order that the velocity ﬂuctuation frequency fr
is not changed into a monotonic function about Vref, a low pass ﬁlter cannot
be adopted for smoothing.
(3) Determination of Encoder Resolution
By using (4.2), the relation equation between velocity ﬂuctuation and encoder
resolution derived by 4.1.2(2), the determination equation of the encoder res-
olution can be obtained. When the motor is rotated with a constant velocity,
the ratio between the scale of the velocity ﬂuctuation and the maximal ve-
locity, called velocity ﬂuctuation ratio RN, is adopted as a speciﬁcation of
a mechatronic servo system, in order to express clearly the motion level of
velocity of the motor. From this point of view, in the software servo system,
the velocity ﬂuctuation ratio RN generated in the encoder resolution can be
expressed by
RN = ∆N
Nmax
(4.5)
where, Nmax denotes the maximal velocity [rev/min] of the servo motor. If we
put (4.5) into (4.2), based on the solution of the encoder resolution RE, the
encoder resolution can be determined by
RE =
60Kv
RNNmax
.
(4.6)
The equation (4.6) is the ﬁnal derived result in this section. According to
this equation, proper encoder resolution RE can be decided for satisfying the
velocity ﬂuctuation ratio RN, determined according to the application of the
servo motor from the maximal velocity Nmax and velocity loop gain Kv.

84
4 Quantization Error of a Mechatronic Servo System
4.1.3 Experimental Veriﬁcation of the Encoder Resolution
Determination
(1) Experimental Veriﬁcation of the Relationship between the
Encoder Resolution and Control Performance
From the experiment, the relationship between the encoder resolution and the
velocity ﬂuctuation is veriﬁed. In the experiment, DEC-1( refer to the exper-
iment deviceE.1) was adopted. Actually, DEC-1 was originally constructed
with an analogue servo system. However, in this experiment, a software servo
system using a computer was used. That is to say, the pulse output of the
servo motor is accumulated by a counter equipped in the computer. The com-
puter program implements the servo controller. Its output is put into servo
(a) Experiment results of software servo system
(b) Simulation results of software servo system
(c) Experimental results of analogue servo system
Fig. 4.3. Veriﬁcation of velocity ripple in software servo system

4.1 Encoder Resolution
85
ampliﬁer by using a D/A converter for constructing the software servo system.
The resolution of D/A conversion is adopted with reduction by a 1/100 am-
pliﬁer from the D/A converter, which can permit ±5[V] with a resolution of
12[bit]. Since 1[bit] is about 2.44×10−5[V], the eﬀect of resolution to control
performance can be neglected. In addition, the velocity of the servo motor is
measured using digital data storage providing velocity detector (tachogener-
ator) output equipped with a load generator. This tachogenerator output is
7[V] with a rotational frequency of 1000[rev/min] of the servo motor. Since
there are many factors of noises in the tachogenerator, the 100[Hz] low pass
ﬁlter is adopted to eliminate these noise factors. The resolution of the encoder
installed in the servo motor is 2000[pulse/rev]. But from the tested two in-
crease and decrease signals of the encoder output as putting them into the
pulse counter, the original 1[pulse] is changed into 4[pulse]. Through the 4
times circuit, it can be obtained as RE = 8000[pulse/rev]. The maximal ve-
locity is Nmax = 1000[rev/min], the sampling time interval ∆tp = 4[ms] (refer
to 3.1). The position loop gain and velocity loop gain are set as Kp = 12[1/s]
and Kv = 68[1/s] so that there is no oscillation or overshoot in the analogue
servo system (refer to 2.1.2). Since velocity ﬂuctuation is one of the problems
in the industrial ﬁeld, for big velocity ﬂuctuation in low speed, ramp input
for DEC 1 is u(t) = 40t[pulse], i.e., rotation speed of motor is 0.3[rev/min]
for low speed. In the steady state, the experimental results and simulation
results are illustrated in Fig. 4.3. From Fig.(a), (b), in the steady state, the
amplitude in experimental results and in simulation results are both 0.004[V].
The frequency in both about is 40[Hz]. The shape of the waves are both tri-
angular. From the above, it can be veriﬁed that the experimental results and
simulation results are almost the same. In Fig.(a) of experimental results, the
size of velocity ﬂuctuation is about 0.004[V], i.e., 0.57[rev/min]. This value is
almost the same as the size ∆N = 60 × 68/8000 = 0.51[rev/min] of velocity
ﬂuctuation calculated by equation (4.2). In addition, the velocity ﬂuctuation
frequency is also consistent with the frequency 40[Hz] calculated by equation
(4.4).
To verify, the experimental results of an analogue servo system with same
conditions are illustrated in Fig.(c). In the analogue servo system, the velocity
ﬂuctuation does not occur at all. The velocity ﬂuctuation in Fig.(a) is veriﬁed
that it is the cause of the resolution of software servo system by the experiment
of 4.1.2(2).
(2) Application of Encoder Resolution Determination
Using equation (4.6) derived by 4.1.2(3), the example of determining the
encoder resolution is illustrated. In DEC-1 adopted in the previous exper-
iment, the necessary encoder resolution is RE = 60 × 68 × 1000/1000 =
4080[pulse/rev] obtained from equation (4.6) if the velocity ﬂuctuation ra-
tion is given as RN = 1 × 10−3. In contrast, if the installed encoder res-
olution is actually RE = 8000[pulse/rev], the velocity ﬂuctuation ratio is

86
4 Quantization Error of a Mechatronic Servo System
RN = 60 × 68/(1000 × 8000) = 5.1 × 10−4. From this point of view, according
to the encoder resolution determination equation (4.6), the encoder resolution
can be easily determined from the required velocity ﬂuctuation ratio.
4.2 Torque Resolution
In the software servo system, the feedback of the motor current equivalent to
the torque is carried out through a micro-computer. Between the power ampli-
ﬁer for driving the motor and the micro-computer is the A/D, D/A conversion.
The theoretical relation between the A/D, D/A conversion quantization error
and control performance must be clariﬁed.
The appropriate mathematical model for the relationship between the torque
resolution of the software servo system and control performance is derived.
According to the solution of the mathematical model, the positioning preci-
sion by equation (4.8) and the position ﬂuctuation of the ramp response by
equation (4.15)∼(4.17), with regard to the torque resolution, can be clariﬁed.
According to the bit number proposed in the A/D, D/A converter, the con-
trol performance of the servo system can be clearly estimated. Additionally,
the minimal necessary bit number of the D/A, A/D conversion for testing
out torque command and current feedback, in order to implement the neces-
sary control performance of the software servo system, can be determined by
equation (4.25).
4.2.1 Mathematical Model of the Mechatronic Servo System for
Torque Resolution
The conceptual graph of the discussed software servo system in this section
is shown in Fig. 4.4. The software servo system is shown in Fig. 4.4. In order
to construct the control circuit of the servo controller using micro-computer
software, the torque (current) command output from the control circuit is
quantized. Therefore, the current reference input to the power ampliﬁer actu-
ally needs a D/A converter. The block diagram of the 2nd order system of the
servo system including torque quantization is illustrated by Fig. 4.5. Kp[1/s],
Kv[1/s] have the meanings of Kp2, Kv2 in the middle speed 2nd order model
equation (2.29) of item 2.2.4. In addition, the sampling time interval of the
velocity loop is ∆tv[s]. The servo system is usually constructed with position
feedback, velocity feedback and current feedback. The position feedback and
velocity feedback refer to the feedback of the actual motor output for the
servo controller. The current feedback refers to the feedback of power ampli-
ﬁed. It is not changed into the actual torque. For the mathematical model
of the servo system in the block diagram of Fig. 4.5, the position feedback
and velocity feedback is widely considered. The current feedback is simply
assumed as the output of the power ampliﬁer. The control method of the ve-
locity loop is P control or PI control. But the entire property of the velocity

4.2 Torque Resolution
87
D/A
Servo controller
Quantization
Computer
Power
amplifier
Input (current)
Output
Motor
Fig. 4.4. Structure of software servo system
-
-
Kp
K
1-
+
+
v
U(s)
Y(s)
s
1-
s
Servo controller
Motor
Velocity loop
Position loop
Quantization
Fig. 4.5. The 2nd order model of software servo system including torque quantiza-
tion
loop is expressed by the 1st order system. The position control and velocity
control are combined into the 2nd order system (refer to item 2.2.4).
In this section, the torque quantization with A/D, D/A conversion, as a
problem, is expressed according to the quantization term in Fig. 4.5. By the
function f(·) for quantization of torque, the mathematical model of a servo
system including the torque quantization is as
d2y(t)
dt2
= f
6
KpKvu(t) −KpKvy(t) −Kv
dy(t)
dt
=
.
(4.7)
For measuring the rotation angle of the servo motor by a pulse [pulse] ac-
cording to the encoder, the rotation angle u of motor as a position com-
mand is expressed by a pulse. The angular velocity input, as the veloc-
ity command, is Kp{u(t) −y(t)}[pulse/s]. The angular acceleration input,
regarded as the torque command to torque quantization, is Kv[Kp{u(t) −
y(t)} −dy(t)/dt][pulse/s2]. In order to make the angular acceleration quanti-
zation function f(x) as the step-wise function of Fig. 4.6, the input angular
acceleration x[pulse/s2] is quantized by the angular acceleration resolution
RA[pulse/s2].
In addition, considering the eﬀect of torque quantization on the control
performance, it assumed that position and velocity without quantization are
feedback with continuous values. In the actual software servo system, the en-
coder resolution of the servo motor is inﬁnite. That is, the position and velocity
information is continuously obtained at the desired state. Compared with the
actual software servo system with an encoder, the control performance with
this assumption is the maximum possible. The condition of deriving torque
resolution is considered as the prerequisite condition. In the software servo sys-

88
4 Quantization Error of a Mechatronic Servo System
0
x[pulse/s2]
f(x)[pulse/s2]
RA
RA
Fig. 4.6. Quantization of angular acceleration
tem, for realizing the required control performance, the A/D, D/A conversion
is carried out with torque resolution capable of satisfying the lower limitation.
Moreover, since introducing this assumption, the analysis of the eﬀect on the
control performance of torque resolution becomes easy and it is possible to
derive the torque resolution condition equation by 4.2.4(1), (2). The appro-
priation of this condition equation in 4.2.4(4) is completely expressed by a
computer simulation taking into account the encoder of the servo motor.
4.2.2 Deterioration of Positioning Precision Due to Torque
Quantization Error
(1) Position Determination of the Software Servo System
For determining the position of the software servo system, the eﬀect of
the torque quantization error is considered. The positioning error Es
p =
Pref −y(∞)[pulse], which is the error of objective position Pref [pulse] and
the steady-state value of the position output y(∞)[pulse], is determined based
on the servo parameter Kp, Kv and the angular acceleration resolution. The
relationship equation is derived theoretically. As illustrated in Fig. 4.7, the
servo motor is rotated with a constant velocity input according to the objec-
tive position Pref . The position can be determined. If the angular acceleration
RA is quantized, the velocity of the servo motor will be also quantized in each
sampling time interval ∆tv of the velocity loop. That is, in the servo sys-
tem with the angular acceleration quantization, the velocity output is only
changed with the unit of RA∆tv[pulse/s]. This quantized resolution is called
the angular velocity resolution. From this case, for the servo system with an-
gular acceleration quantization, the velocity feedback is carried out until that
angular velocity output becomes 0[pulse/s]. When the angular velocity output
becomes zero, the velocity feedback is cut oﬀand the steady state is continued
until the position output becomes constant.

4.2 Torque Resolution
89
(2) Relationship between Positioning Error and Angular
Acceleration Resolution
At the moment that the input is equal to the objective position Pref , the
input to the quantization term of Fig. 4.5 is expressed by Kv(Kp(Pref −y) −
dy/dt). When this value larger than the angular acceleration resolution RA,
the position and velocity is feedback. If the angular acceleration resolution is
not full, that is, dy/dt = 0[pulse/s], the output of the quantization term is 0
and the position output remains constant.
In the steady state that the position output is constant, the size of the
input to the quantization term is expressed by |KpKvEs
p| with the positioning
error Es
p, as Fig. 4.7. When this value is not full of resolution RA of the angular
acceleration, the position error Es
p can be expressed by Kp, Kv, RA as
|Es
p| <
RA
KpKv
.
(4.8)
From (4.8), the upper limit of the position error Es
p is proportional with the
angular acceleration resolution RA and inversely proportional to the position,
velocity loop gain Kp, Kv.
4.2.3 Deterioration of Ramp Response Due to Torque
Quantization Error
(1) Ramp Response of the Software Servo System
Next, with regard to the ramp input of the software servo system, the eﬀect of
torque quantization error is considered. The objective trajectory of the servo
motor is given with the constant velocity Vref [pulse/s]. When the angular
acceleration is quantized in each RA, if the objective angular velocity is the
integer times of the angular velocity resolution, the angular velocity output
is not changed for making the objective angular velocity consistent with an-
gular velocity output. However, if the objective angular velocity is not the
0
0
Time
Position
Ep
s
Pref
Fig. 4.7. Deterioration of position control in software servo system

90
4 Quantization Error of a Mechatronic Servo System
0
0
0
Time
Velocity
Td
Tu
Tf
Ev
r=RA∆tv
Vref
Vu
Vd
Position
Ep
r
Ed
Eu
Fig. 4.8. Deterioration of ramp response in software servo system
integer times of the angular velocity resolution, the angular velocity output
is changed because of inconsistence between objective angular velocity and
angular velocity output.
Fig. 4.8 illustrated the variation of the angular velocity output. The upper
part of Fig. 4.8 shows the position ﬂuctuation and the bottom part shows the
angular velocity ﬂuctuation. From Fig. 4.8, the response is divided into two
states: one is that the angular velocity output is below the objective angular
velocity (scale of Td[s]) and another is that the angular velocity output is over
the objective angular velocity (scale of Tu[s]).
(2) State of Angular Velocity Output under Objective Angular
Velocity Vref
At the state of that the angular velocity output is below the objective angu-
lar velocity Vref , from the angular velocity quantization, the output angular
velocity is as Vd = ⌈Vref /(RA∆tv)⌉RA∆tv[pulse/s] (where ⌈x⌉is expressed as
the maximal integer below x). The error Vref −Vd between objective angular
velocity and angular velocity output is made integral as the position output
error. If the angular acceleration input is over half of the angular acceleration
resolution RA/2 (refer to Fig. 4.6), the positive pulse equivalent to the angu-
lar acceleration resolution is generated. When generating the pulse and the
position output error is Ed[pulse], the angular acceleration input is expressed
as Kv(KpEd −Vd) with the loop of Fig. 4.5. When this value is half of the
angular acceleration resolution RA/2, the following relationship equation is

4.2 Torque Resolution
91
successful
Kv(KpEd −Vd) = RA
2 .
(4.9)
If solving the equation (4.9) for Ed, it is as
Ed = RA + 2KvVd
2KpKv
.
(4.10)
The amplitude of the position error is in the positive direction in equation
(4.10). Additionally, the amplitude of this velocity error is as Vref −Vd.
(3) State of Angular Velocity Output over Objective Angular
Velocity Vref
If generating the pulse equivalent to the angular acceleration resolution,
the angular velocity output RA∆tv is increased as Vu = ⌈Vref /(RA∆tv) +
1⌉RA∆tv[pulse/s]. The error Vu−Vref of the objective angular velocity and an-
gular velocity output is made integral as the position output error. If the angu-
lar acceleration input is over half of the angular acceleration resolution RA/2
(refer to Fig. 4.6), the negative pulse equivalent to the angular acceleration
resolution is generated. If generating the pulse and the position output error
is Eu[pulse], the angular acceleration input is expressed as −Kv(KpEu + Vu).
If this value is half of the angular acceleration resolution RA/2, the following
relation equation is successful
−Kv(KpEu + Vu) = −RA
2 .
(4.11)
If solving the equation (4.11) for Eu, it is as
Eu = RA −2KvVu
2KpKv
.
(4.12)
The amplitude of the position error is in the positive direction in equation
(4.12). Moreover, the amplitude of the velocity error is as Vu −Vref . When
generating this negative pulse, the angular velocity output is back to the
state that the angular velocity output of 4.2.3(2) is over the objective angular
velocity. Because of these two states, a ﬂuctuation of the ramp response exists.
(4) Amplitude and Cycle of Position Fluctuation
From Fig. 4.8, if the position has deviation Eu + Ed, when the error between
the objective velocity and tracing velocity Vref −Vd is continued at the time
Td, the time Td of that the angular velocity output is continuously below the
objective angular velocity is as

92
4 Quantization Error of a Mechatronic Servo System
Td = Ed + Eu
Vref −Vd
= RA(1 −Kv∆tv)
KpKv(Vref −Vd)
(4.13)
by using equation (4.10) and (4.12). Similarly, the time Tu of that is the
angular velocity output is continuously over the objective angular velocity, is
as
Tu = Ed + Eu
Vu −Vref
= RA(1 −Kv∆tv)
KpKv(Vu −Vref ).
(4.14)
The ﬂuctuation period Tf[s] is as
Tf = Td + Tu
=
R2
A∆tv(1 −Kv∆tv)
KpKv(Vref −Vd)(Vu −Vref )
(4.15)
by combining the Td of equation (4.13) and the Tu of equation (4.14). The
amplitude of position ﬂuctuation Er
p[pulse] is as
Er
p = Ed + Eu
= RA + Kv(Vd −Vu)
KpKv
= RA(1 −Kv∆tv)
KpKv
(4.16)
by combining the equation (4.10) and equation (4.12). The amplitude of the
velocity Er
v[pulse/s] is as
Er
v = RA∆tv
(4.17)
from the angular acceleration resolution.
From above derived equation (4.15), the equation (4.17) is the relationship
equation expressing the relation among ﬂuctuation period Tf, amplitude of
position ﬂuctuation Er
p, velocity ﬂuctuation amplitude Er
v and angular ac-
celeration resolution RA. By analyzing their properties from these relation
equations, the amplitude of position ﬂuctuation Er
p and the velocity ﬂuctua-
tion amplitude Er
v are proportional to the angular acceleration resolution RA,
and the ﬂuctuation period Tf proportional to twice that of the angular ac-
celeration resolution RA. In addition, the ﬂuctuation period Tf is dependent
on the objective velocity Vref . The amplitude of position ﬂuctuation Er
p and
the velocity ﬂuctuation amplitude Er
v are not reliant on the objective velocity
Vref . The angular acceleration resolution RA is dependent on the parameter
Kp, Kv, ∆tv of the servo controller.

4.2 Torque Resolution
93
4.2.4 Derivation of Torque Resolution Determination
(1) Positioning Precision
If the positioning error output Es
p is not full of 1[pulse] of encoder output,
there is no eﬀect of torque resolution compared with the encoder resolution.
If the right side of equation (4.8) is not full of 1 as
|Es
p| <
RA
KpKv
< 1
(4.18)
and by solving the RA, the condition of angular acceleration resolution RA if
the position error Es
p is not full of 1 can be expressed as
RA < KpKv.
(4.19)
That is, in order to make the positioning precision Es
p of the servo motor
is full of 1, the angular acceleration resolution RA should be determined by
satisfying the equation (4.19).
(2) Fluctuation of Ramp Response
In the ramp response, the torque resolution is determined when the amplitude
of angular velocity output deterioration Er
v and the amplitude of position out-
put deterioration Er
p are within the allowance Er
limv[pulse/s] and Er
limp[pulse],
respectively. The upper bound RAp[pulse/s2] of the angular acceleration res-
olution satisfying the condition of amplitude of position output deterioration
can be calculated using equation (4.16)
RAp =
KpKvEr
limp
1 −Kv∆tv
.
(4.20)
The upper bound RAv[pulse/s2] of the angular acceleration resolution satisfy-
ing the condition of the amplitude of the angular velocity output deterioration
can be calculated using equation (4.17)
RAv = Er
limv
∆tv
.
(4.21)
The angular acceleration resolution RA is needed from equation (4.20) and
equation (4.21)
RA ≤min(RAv, RAp).
(4.22)
That is, when the angular acceleration resolution RA can be determined for
satisfying the equation (4.22), the restraint of the deterioration of ramp re-
sponse within the demanded allowance can be realized.

94
4 Quantization Error of a Mechatronic Servo System
(3) Calculation of Bit Numbers of torque resolution
The angular acceleration resolution RA should correspond to the bit number
of the D/A, A/D conversion which is adopted for the current reference and
feedback of the software servo system. First of all, the angular acceleration
resolution is converted into the torque resolution RT [Nm] using the pulse
number P[pulse/rev] equivalent to the moment of inertia JM[kgm2] of the
motor and the encoder of one time rotation.
RT = 2πRAJM
P
.
(4.23)
Next, the bit number of the A/D, D/A conversion should be converted.
That is, the maximum of the bit number of the A/D, D/A conversion adopted
for the software servo system must be able to output the maximum torque
of the motor except the symbol bit. The relation equation amongst the bit
number B[bit] of the resolution of the A/D, D/A conversion, the maximum
torque Tmax[Nm] of the maximum torque of motor and the torque resolution
RT [Nm] should be given as
2B−1 = Tmax
RT
=
TmaxP
2πRAJM
.
(4.24)
The ﬁnal conversion is based on equation (4.23). The equation (4.24) is
changed after solution about bit number B of the resolution of the A/D,
D/A conversion as
B = log2
TmaxP
πRAJM
.
(4.25)
By using the bit number from equation (4.25), the performance of a A/D,
D/A conversion satisfying the demanded precision of the ramp response can
be determined.
(4) Numerical Example of Torque Resolution Determination
The eﬀectiveness of using the relationship between the derived control per-
formance of the software servo system and the bit number of the A/D, D/A
conversion in the software servo system is veriﬁed here.
The designed position loop gain and the velocity loop gain of the servo
controller are Kp = 40[1/s] and Kv = 200[1/s], respectively. The sampling
time interval for the velocity loop is ∆tv = 50[µs]. The rated values of the servo
motor are JM = 0.13 × 10−4[kgm2], Tmax = 1.47[Nm], P = 5000[pulse/rev].
For making the positioning precision as (4.19), the deterioration of the ramp
response as Er
limp = 1[pulse] and Er
limv = 1[pulse/s], the angular acceleration
resolution is determined by equation (4.22), and the calculation of the bit
number B of the torque resolution using equation (4.25) for B = 15[bit].

4.2 Torque Resolution
95
When existing quantization of the position information in the actual soft-
ware servo system, in order to investigate the degree of the obtained the
control performance based on the torque resolution, the computer simulation
is made using torque resolution and considering the quantization of position
information. The objective trajectory is u(t) = 10000t[pulse] (0 ≤t < 1[s]),
u(t) = 10000[pulse] (1 ≤t ≤2[s]). The approximation of the velocity informa-
tion is based on the discrete error of the position information. Additionally, the
positioning precision is Es
p = 1[pulse], the position ﬂuctuation of the ramp re-
sponse is Er
p = 2[pulse] and the velocity ﬂuctuation is Er
v = 200[pulse/s]. Even
without considering the torque resolution and only considering the quantiza-
tion of the position information, all of the positioning precision, the position
ﬂuctuation of the ramp response and the velocity ﬂuctuation have the same
values. When existing quantization of the position, the eﬀect of torque quanti-
zation in the derived torque resolution can be neglected for making the results
consistent between considering the torque quantization and not considering
the torque quantization. Moreover, in the desired state without considering
the quantization of position, if comparing the design values and simulation re-
sults, the expected control performance can be obtained by using the derived
torque resolution about the positioning precision and the position ﬂuctuation
of the ramp response. The reason for deterioration of the design values caused
by velocity ﬂuctuation is that the position information is simply discrete when
approximating the velocity information. That is, the resolution of the velocity
approximation values is as 1[pulse]/∆tv[s] = 1/(50 × 10−6) = 20000[pulse/s]
when approximating the velocity information based on the discrete values. If
standardizing the resolution of the velocity approximation value, the velocity
ﬂuctuation is very small at 1%.
Next, in order to calculate the bit number of the torque resolution sat-
isfying the general required control performance, the relationship equation
among the positioning error Es
p expressed by equation (4.8), the amplitude of
position ﬂuctuation Er
p expressed by equation (4.16), the velocity ﬂuctuation
amplitude Er
v expressed by equation (4.17), and the angular acceleration res-
olution RA can be converted into the bit number B of the torque resolution
by equation (4.25). This relationship is shown in Fig. 4.9.
According to the use of Fig. 4.9, although the bit number of the torque
resolution cannot be worked out from the required control performance, the
positioning precision and the control performance of the ramp response can be
obtained from the bit number of the torque resolution of the actual operated
software servo system.
(5) Relationship Among Control Performance, Torque Resolution
and Servo Parameter
The relationship amongst the control performance, torque resolution and servo
parameter of the software servo system is summarized as below.

96
4 Quantization Error of a Mechatronic Servo System
1. As shown in Fig. 4.9, the logarithm of positioning error Es
p, the amplitude
of position ﬂuctuation Er
p, the velocity ﬂuctuation amplitude Er
v and the
bit number B of the torque resolution are expressed by a 1st order function.
2. From equation (4.8) and equation (4.16), the positioning error Es
p and
the amplitude of position ﬂuctuation Er
p of the ramp response have the
negative proportion with the position loop gain Kp.
3. From equation (4.17), the velocity ﬂuctuation amplitude Er
v is not depen-
dent on the servo parameter Kp, Kv.
4. From equation (4.15), the ﬂuctuation period Tf of ramp response is de-
pendent on the objective velocity Vref .
0
10
20
30
10−5
100
Torque resolution [bit]
Ep
s[pulse], Ep
r[pulse], Ev
r[pulse/s]
Ev
r
Ep
s
Ep
r
Fig. 4.9. Relation between the resolution of A/D, D/A conversion and control
performance

5
Torque Saturation of a Mechatronic Servo
System
In order to realize the high-speed motion of a mechatronic system, the power
ampliﬁer current for driving the torque of servo motor is adopted. This of-
ten generates a deterioration of contour control performance when occurring
torque saturation. In this chapter, the measurement method of torque satura-
tion and a simple algorithm of generating the motion velocity for preventing
the deterioration of contour control performance, when the torque saturation
properties are known, is shown.
5.1 Measurement Method for the Torque Saturation
Property
The previous torque saturation property refers to the use of a power ampliﬁer
property without any change. The saturation property of a power ampliﬁer
is deﬁned by measuring the relationship of the output signal with the sim-
ple ampliﬁer input signal. However, in a mechatronic servo system, the power
ampliﬁer is installed in the servo controller and it drives the motor connecting
with the mechanism part. When analyzing the contour control performance of
this mechatronic servo system, the torque saturation property of the mecha-
tronic servo system cannot be reﬂected suﬃciently when only considering the
saturation property of the power ampliﬁer and it is also diﬃcult to grasp the
performance deterioration quantitatively.
It will introduce the calculation method of the torque saturation property
according to the comparison between the output of a linear mathematical
model expressing the motion property of a mechatronic servo system and the
actual output.
Since the torque saturation property can be calculated through the proper
expressed mathematical model on the dynamics of a mechatronic servo system
during the contour control, the torque saturation property can be adopted
eﬀectively to improve the contour control performance of a mechatronic servo
system.
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 97–119, 2004.
Springer-Verlag Berlin Heidelberg 2004

98
5 Torque Saturation of a Mechatronic Servo System
5.1.1 Torque Saturation of a Mechatronic Servo System
(1) Torque Saturation Problem in the Mechatronic Servo System
and Necessity of Torque Saturation Property Measurement
Torque saturation, as a big problem, is the reason for performance deteri-
oration when performing high-speed contour control of a mechatronic sys-
tem. Torque saturation refers to the phenomenon generated according to the
properties of a servo controller and motor and also the phenomenon that
the response torque cannot be generated actually corresponding to the given
big torque command in the mechatronic servo system. Torque saturation can
occur under the movement with 1/5 of the rated speed. It is not a special
phenomenon that will be generated near the highest velocity. In the contour
control of an industrial mechatronic servo system, if torque saturation occurs,
there will appear to be an obvious deviation between objective trajectory
and the following trajectory. Therefore, torque saturation is absolutely not
permitted to occur.
By summarizing the items related to the torque of an industrial mecha-
tronic servo system, there are following items.
1. Servo stops with overload current: if the current is over the maximum
allowable current, which is equal to the torque of the transient motor
output (3 ∼5 times of rated torque), ﬂows into the motor over 1[s],
the servo will stop with a current interruption. Namely, the servo will
stop when the current is more than the equivalent rated torque ﬂows for a
certain time. They are the measures to avoid motor damage from overload
current.
2. Wind up measure: when there are many PI control systems used in the
current control part and the velocity control part, a wind-up phenomenon
will occur at the saturation of the integral (I) action. The wind-up phe-
nomenon is the phenomenon that the output cannot be decreased along
with the input decrease because the controller continuously increases the
deviation of a certain symbol according to the diﬀerence between the re-
quired manipulation and actual manipulation after saturation, when ma-
nipulation contains saturation in the controller including the integrator.
PI control part of the current control part is designed so that it absolutely
does not enter into the saturation region in the whole control period, and
several strategies, such as current interruption, etc., are adopted to stop
the servo when the PI control part passing through the ﬁxed period of
entering into the saturation region. Concerning the PI controller of the
velocity control part, it will perform when the current reference, as an
output of the PI controller, is within the torque which can be output by
the motor. However, when the current reference is over the torque which
can be output by the motor, integral (I) action will be divided and P
control will be performed to avoid the wind-up phenomenon.

5.1 Measurement Method for the Torque Saturation Property
99
3. Counter-electromotive force compensation: the current value, which can
be adopted in the torque of acceleration-deceleration from the diﬀer-
ence between the terminal voltage input added into the motor and
counter-electromotive force of the motor, can be guaranteed by counter-
electromotive force compensation. This counter-electromotive force com-
pensation is a method that the current of the motor will be ﬂown with
3 ∼5 times of the rated torque even in high-speed rotational frequency,
when the current is equivalent to a large terminal input voltage of the
motor in the PWM ampliﬁer corresponding to the counter-electromotive
force in the high-speed rotational frequency of the motor.
In the industrial mechatronic servo system with the above features, torque
saturation will occur in the mechatronic system due to the saturation feature
of the current output of the power ampliﬁer or torque output of the servo
motor. Around this saturation, the movement of the mechatronic servo sys-
tem is very diﬃcult. Taking into account the safety of the equipment, the
clip (restriction) should be equipped in the velocity control part and current
control part in the servo controller before saturation occurs. The clip of the
velocity control part is the variation of the velocity, i.e., variation of velocity
not over acceleration. The clip of the current control part is the value which
is not over the current value. Both of above clips exist not over the current
variation. From these clips, restriction is extorted for the torque of the mecha-
tronic servo system. In this chapter, torque output with restriction according
to the clip is called torque saturation.
In the current situation, when high-precision contour control of the mecha-
tronic servo system is required, it can be realized in the linear region of low
velocity without generation of torque saturation. Nevertheless, the high-speed
motion is always demanded. Therefore, it is very important to grasp the torque
saturation property in the high-precision contour control. If understanding the
torque saturation property correctly, it is possible to realize high-precision con-
tour control performance for objective velocity in the possible limited velocity
according to the torque saturation property.
In the following analysis, discussion will be carried out for the servo system
with one axis. The industrial mechatronic system is composed of each inde-
pendently controlled axis. Also, in the articulated robot arm using nonlinear
kinematics between working coordinates and joint coordinates, for making the
servo system of each axis with basic structure exactly the same, the general
torque saturation of an industrial mechatronic system can be regarded as the
issue of one axis (refer to 1.1.2 item 6).
(2) Analysis Method of Reasons for Load Torque Generation in
the Mechatronic Servo System and Derivation Method of the
Torque Saturation Property
In the industrial mechatronic servo system, the biggest load torque is coulomb
friction and next is viscous friction. The generation cause of coulomb friction

100
5 Torque Saturation of a Mechatronic Servo System
and viscous friction lies in the frictional part or the sleeve part. The inten-
sity of friction is variable from the tightening of bearing or adopted grease.
Comparing with the friction of the motor itself, friction of the mechanism is
dominant. In the industrial mechatronic servo system, these frictions often
compose 60% ∼70% of the rated torque. Coulomb friction is determined by
the constructed status of the mechanism part. Viscous friction can be consid-
ered as a certain load torque for not causing large-scale velocity variation in
the movement status.
In the case of an articulated robot arm, generally, there is no constant
velocity in joint coordinates even with a constant velocity in working coor-
dinates, because of nonlinear coordinate transforms between working coordi-
nates and joint coordinates. However, in the working ﬁeld generally adopted
in contour control and working status, constant velocity should be set in or-
der to have no great change of velocity of the motor. Besides, the motor axis
equivalent moment of inertial should be changed along with the change of
attitude of the robot and so on. But these torque variations introduced above
is smaller than the frictional torque in the normal scale of movement. In addi-
tion, most of the load of the servo motor is loaded from the mechanism part.
The mechanism part cannot be executed with non-load operation, but often
can be moved around the rated load in the status of a mechatronic servo sys-
tem after construction. Thus, discussion with the condition of a certain load
torque for the entirety can be carried out.
From the view of the contour control of a mechatronic servo system, the
torque saturation property is not a saturation property of the power ampliﬁer
itself. Concerning the impact of the torque saturation property on contour
control, the expected torque output with an assumption of no torque satura-
tion is deﬁned as standard. If the relation with the generated actual torque can
be measured according to the impact of torque saturation of the system, the
torque saturation property can be obtained from contour control performance.
Namely, according to the calculated torque output based on a linear model
expressing correctly dynamics of a mechatronic servo system when performing
contour control without torque saturation, the torque saturation curve can be
worked out by comparing it with the torque output of an actual mechatronic
servo system. In the following part, a new measurement method of the torque
saturation property will be described from the above contour control point of
view.
(3) Measurement Method of the Torque Saturation Property
Based on the Comparison with the Desired Conditions
Based on the analysis method of 5.1.1(2), the derivation method of the torque
saturation property of an actual mechatronic servo system is introduced. First,
the velocity step response of the actual mechatronic servo system is worked
out respectively. This step response of velocity is consistent with the veloc-
ity response in the expected status without torque saturation at low speeds.

5.1 Measurement Method for the Torque Saturation Property
101
However, due to the impact of torque saturation when the step response of ve-
locity is over a limited value, the response of an actual system is disappeared
as the expectation. In order to understand these characteristics, the procedure
of the measurement method of the torque saturation property, based on the
comparison with the theoretical value, is shown. In the following explanation
on the procedure of measurement method, the discussion is carried out using
the acceleration-deceleration in the proportion relation with torque adopted
in acceleration-deceleration. The procedure of measurement for the torque
saturation is summarized as below.
1. Velocity output is measured at a given velocity step input of actual system.
2. Acceleration output is calculated based on the information of the velocity
output.
3. Maximal acceleration output is calculated from the acceleration output
wave.
4. To a given velocity command, the theoretical acceleration output is worked
out based on the linear model expressing the dynamics of system with an
assumption of no torque saturation.
5. A graph is plotted with horizontal axis showing the theoretical value of
the acceleration output at the status calculated in 4, and the vertical axis
representing the acceleration output measured from the actual system
calculated in 3.
6. Expanding to the whole velocity region used in contour control, the typical
points of acceleration saturation properties is worked out by repeating
steps 1∼5 for diﬀerent velocity step input values. By interpolating between
these points, the torque saturation curve is drawn out.
According to the above steps, the acceleration saturation property can be
understood. For the proportional relationship between acceleration and torque
adopted in acceleration-deceleration, this graph can express the torque satu-
ration when the motor axis equivalent moment of inertia in the acceleration
is drawn by curve and the torque which cannot occur linearly according to
the expectation is graphed. The torque saturation property worked out by
this way, i.e., the upper bound and lower bound of torque saturation cannot
be found and torque is always linearly output even in the region, in which
saturation does not occur.
Real system
Mathematical
Input
Acceleration
Torque saturation curve
model
Fig. 5.1. Conceptual graph of torque saturation property derivation

102
5 Torque Saturation of a Mechatronic Servo System
By using a mathematical model expressing the dynamics of the system
when torque saturation does not occur as a desired status, the theoretical
acceleration output needed in step 1 of measure procedure, is explained.
The conceptual graph of torque saturation property 5.1 is shown con-
cretely in Fig. 5.2. The adopted mathematical model is the linear 2nd order
model expressing the property in the state of without torque saturation in a
mechatronic servo system. It is illustrated in the bottom part of Fig. 5.2.
To position input U(s) of the mechatronic servo system, dynamics of ac-
celeration output s2Y (s) is expressed as (refer to item 2.2.4).
s2Y (s) =
KpKvs2
s2 + Kvs + KpKv
U(s)
(5.1)
where Kp, Kv have the meanings as Kp2, Kv2 in the middle speed 2nd or-
der model as equation (2.29) in item 2.2.4, respectively. s2Y (s) describes the
Laplace transform of the acceleration output (refer to appendix A.1). Since
the command in a mechatronic servo system is given with a designated ve-
locity in contour control, it is necessary to measure the saturation property
under the same conditions for working out torque saturation. Acceleration
output is calculated if input U(s) is a ﬁxed velocity as
U(s) = v
s2 .
(5.2)
Acceleration can be worked out according to the following simple analytical
solution. The mechatronic servo system in the industrial ﬁeld generally has
two diﬀerent real poles in equation (5.1) according to the relationship between
position loop gain Kp and velocity loop gain Kv (refer to item 2.2.4). To
input
Kp
Torque saturation
Motor
TG
1
s
output
Position loop
Differential
Polynomial
approximation
output
Vertial axis
Real system
operation
Velocity loop
Acceleration
Velocity
Position
Kp
Kv
No torque saturation
1
s
1
s
Velocity loop
Position loop
Acceleration
Horizontal axis
Linear model
Torque saturation
curve
output
Kv
+
−
+
−
+ −
+
−
s2
s
Fig. 5.2. Block diagram of corner acceleration saturation property measurement

5.1 Measurement Method for the Torque Saturation Property
103
velocity step input of equation (5.2) of a mechatronic servo system, equation
(5.1) is input into equation (5.2). Through a inverse Laplace transform (refer
to appendix A.1), the acceleration output can be calculated by
d2y(t)
dt2
= KpKvv
ps
1 −ps
2
eps
1t −KpKvv
ps
1 −ps
2
eps
2t
(5.3)
ps
1 = −Kv +
C
K2v −4KvKp
2
ps
2 = −Kv −
C
K2v −4KvKp
2
.
At this time, in order to calculate the maximum value of torque, the diﬀeren-
tial of equation (5.3) is as
d3y(t)
dt3
= −KpKvvps
1
ps
2 −ps
1
eps
1t + KpKvvps
2
ps
2 −ps
1
eps
2t.
(5.4)
The moment tM, when the acceleration of equation (5.3) reaches a maximum
value, can be obtained from the solution of d3y(t)/dt3=0 as
tM =
1
ps
2 −ps
1
log ps
1
ps
2
.
(5.5)
Furthermore, for the step response of the velocity, i.e. about acceleration, on
velocity, acceleration output peak of impulse response (maximum accelera-
tion) can be worked out by
d2y(tM)
dt2
= KpKvv
ps
1 −ps
2
eps
1tM −KpKvv
ps
1 −ps
2
eps
2tM .
(5.6)
Namely, this value is the theoretical value of maximum acceleration of the
velocity step input of the velocity of equation (5.2) is v. Based on equation
(5.6), the theoretical torque output in the bottom of Fig. 5.2 can be calculated.
On the other aspect, the actual system is shown in the top part of Fig. 5.2.
It expresses the simple equation including torque saturation, as well as satu-
ration function. However, their meaning are unknown in the actual measure-
ment. Only the input output data can be tested. From the actual measured
velocity output of the velocity step input of velocity v in equation (5.2), and
the acceleration by calculating diﬀerence operation, the torque of actual sys-
tem is worked out. Through drawing these values and the theoretical acceler-
ation output derived from equation (5.6) respectively by the vertical axis and
the horizontal axis of torque saturation. The torque saturation property can
be measured. In the next item, the results of measuring concretely the torque
saturation curve for an actual mechatronic servo system is illustrated.

104
5 Torque Saturation of a Mechatronic Servo System
5.1.2 Measurement of the Torque Saturation Curve and
Experimental Veriﬁcation
(1) Experimental Equipment
According to the measurement method of the torque saturation property in-
troduced in 5.1.1(3), the torque saturation curve was worked out in the ac-
tual mechatronic servo system. The objective is DEC-1 (refer to experiment
equipment E.1). The driving and load parts were connected by a rigid body
coupling. The experimental conditions are a position loop gain Kp=10[1/s],
velocity loop gain Kv=56[1/s] and a sampling time interval ∆tp=10[ms].
(2) Measurement Results of the Torque Saturation Curve
Based on the procedure 5.1.1(3), the measurement of torque saturation curve
of DEC-1 was carried out
1. When velocity step input was within the scale of −13.39 ∼13.89[rev/s]
(Fig. 5.3(a)) with an interval of 1.39[rev/s], velocity output was read
out by the tachogenerator. The typical results with 2.78, 5.56, 8.33,
11.11[rev/s] in Fig. 5.3 were shown. Velocity responses to Fig. (b) re-
spectively with a velocity command for 2.78, 5.56, 8.33, 11.11[rev/s] were
shown in Fig. (a). The impact of torque saturation, was that inclination
of the response velocity is not bigger than the constant at the start point
in Fig. (b), namely, raising part of the velocity with linear inclination, was
assured.
2. Through one-order discrete of velocity output, acceleration output (Fig. 5.3(c))
can be calculated.
3. In order to eliminate the noise in the acceleration output wave, an accel-
eration wave was described by a four-order polynomial I4
i=0 aiti and its
coeﬃcient ai can be worked out by the least-square method (Fig. 5.3(d)).
From the peak value of the polynomial function, maximal acceleration can
be worked out.
4. From equation (5.6), the peak of acceleration output without torque sat-
uration can be calculated. If Kp=10[1/s], Kv=56[1/s], and tM of equation
(5.5) is 0.04[s], then the peak value of the acceleration output in equation
(5.6) can be worked out by d2y(0.04)/dt2 = 7.75v.
5. The horizontal axis represents the theoretical maximum acceleration out-
put and vertical axis represents actual maximum acceleration output.
6. For a given velocity step and repeating steps 1∼5, the torque saturation
curve among calculated points can be worked out by interpolating between
these points.
According to the above procedure, the results of measuring the torque satu-
ration property are as below and illustrated in Fig. 5.4.

5.1 Measurement Method for the Torque Saturation Property
105
0
0.2
0.4
0
10
Time [s]
Velocity input [rev/s]
2.78[rev/sec]
5.56[rev/sec]
8.33[rev/sec]
11.11[rev/sec]
0
0.2
0.4
0
10
Time [s]
Velocity output [rev/s]
(a) Velocity input
(b) Velocity output
0
0.2
0.4
0
50
Time [s]
Acceleration output [rev/s2]
0
0.2
0.4
0
50
Time [s]
Velocity output [rev/s2]
(c) Acceleration output
(d) Acceleration output
(polynomial approximation)
Fig. 5.3. Acceleration output results according to the constant velocity input (2.78,
5.56, 8.33, 11.11[rev/s])
sat(x) =
⎧
⎨
⎩
80 (80 < x)
x
(−80 ≤x ≤80)
−80 (x < −80).
(5.7)
From these results, it can be veriﬁed that the torque will enter into the sat-
uration region when the command velocity increase and the linear boundary
with change of command velocity. In the next part, how much of the actual
torque saturation property can be described correctly will be veriﬁed.
(3) Veriﬁcation and Evaluation of the Measured Torque
Saturation Property
In order to verify the appropriation of the obtained torque saturation prop-
erty, the experiment and simulation are compared. In the experiment, an or-
thogonal type two-axis robot arm is emulated by a combination of two times

106
5 Torque Saturation of a Mechatronic Servo System
−100
0
100
−100
0
100
Theoretical acceleration [rev/s
2]
Actual acceleration [rev/s
2]
Fig. 5.4. Measurement results of torque saturation property of DEC-1
experiment of DEC-1. In the simulation, each axis is expressed by equation
(5.1) and (5.7) and they are combined into two axes. In the experiment and
simulation, the objective trajectory of contour control, illustrated in Fig. 5.5,
is given as
vx(t) = 9.26
(0 ≤t ≤1.08[s])
(5.8a)
vy(t) =
$
9.26
(0 ≤t ≤0.54[s])
−9.26
(0.54 < t ≤1.08[s]).
(5.8b)
In the upper part of Fig. 5.5(a), following the locus of computer simulation
results by two methods are shown. In the upper part of Fig. 5.5(b), following
locus of experimental results are shown. In Fig. 5.5(a), one of two methods is
about simulation without torque saturation. Another is the simulation result
including the torque saturation simulated by experiment. The simulation in-
cluding the torque saturation is performed by replacement of the measured
results of the torque saturation curve in Fig. 5.4 with the part without torque
saturation (expressed by line), which is in the part of acceleration output of
the 2nd order system of the linear model expressed in Fig. 5.2.
In the locus without torque saturation, the corner part indicated by circle
has no overshoot. However, in the locus of the system including torque sat-
uration, overshoot exists in the following locus. The simulation results about
the latter are almost the same as that in the experimental results shown in
Fig. 5.5(b). This property in the time domain can be seen by the position,
velocity and acceleration shown from the second to top of Fig. 5.5. Since satu-
ration is not generated owing to no velocity change in the x axis, the impact of
saturation is shown in the trajectory of position, velocity, acceleration about
features of the y axis. In order to make a comparison for this trajectory in
detail, the contour control results of the simulation by using the torque satura-
tion property measured through the proposed procedures are almost the same

5.2 Contour Control Method with Avoidance of Torque Saturation
107
0
10
0
2
4
x axis position [rev]
y axis position [rev]
Objective locus
No torque saturation
Torque saturation
Locus
0
10
0
2
4
x axis position [rev]
y axis position [rev]
Objective locus
Experiment
Locus
0
2
4
y axis position [rev]
Objective trajectory
No torque saturation
Torque saturation
y axis trajectory
0
2
4
y axis position [rev]
Objective trajectory
Experiment
y axis trajectory
−10
0
10
y axis velocity [rev/s]
−10
0
10
y axis velocity [rev/s]
0
1
2
−100
0
100
Time [s]
y axis acceleration [rev/s2]
0
1
2
−100
0
100
Time [s]
y axis acceleration [rev/s2]
(a) Simulation
(b) Experiment
Fig. 5.5. Simulation results and experimental results of contour control
as the results of the DEC-1 experimental results. From the above veriﬁcation,
it shows that the torque saturation curve calculated by the proposed method
can match the torque saturation property correctly in the actual system.
5.2 Contour Control Method with Avoidance of Torque
Saturation
In order to obtain the high-precision contour control performance in an in-
dustrial ﬁeld and not generate torque saturation, the action is performed with
delay totally. Even saturation occurred partly, the working time is lengthened.
In the corner part of the objective locus where occurred torque saturation,
the necessary minimal velocity is deﬁned so as to avoid torque saturation.
Other parts were moved under designated velocity. This method for minimiz-

108
5 Torque Saturation of a Mechatronic Servo System
ing the working time is illustrated. Moreover, the compensation method for
dynamic delay in the overall system were also introduced.
The proposed method has a high signiﬁcance of utilization in the industrial
ﬁeld due to the improvement of control performance without any change of
hardware.
5.2.1 Contour Control Performance with Torque Saturation and
High-Precision Contour Control Method
(1) Mathematical Model on a Machine Tool
Based on the measured torque saturation in the last section, the contour
control method for avoiding torque saturation is introduced in the velocity
ﬁeld when torque saturation occurred. Firstly, the objective is a machine tool,
in which each axis can be handled independently in orthogonal coordinates.
The block diagram of a mechatronic servo system, including torque satu-
ration, is shown in Fig. 5.6. In this ﬁgure, U(s) and Y (s) are the input and
output of a mechatronic servo system, respectively. Kp and Kv have the mean-
ings of Kp2 and Kv2 in the middle speed 2nd order model as equation (2.29)
of item 2.2.4. The torque saturation property is obviously contained in the
servo controller of Fig. 5.6. Dynamics is expressed for each axis independently
as (refer to Fig. 5.6)
d2y(t)
dt2
= sat
.
Kv
$
Kp(u(t) −y(t)) −dy(t)
dt
)0
(5.9)
where sat(z) is torque output considering saturation as
sat(z) =
⎧
⎨
⎩
Amax
(Amax < z)
z
(−Amax ≤z ≤Amax)
−Amax (z < −Amax).
(5.10)
Amax in equation (5.10) is the maximal acceleration of each axis. Amax
is used here to replace the maximum torque in order to have proportional
relation with maximum torque.
-
-
Kp
K
1
-s
+
+
v
Y(s)
U(s)
1
-s
Servo controller 
Motor and
mechanism part
Following
trajectory
Torque
Input 
trajectory
Velocity loop
Position loop
saturation
Fig. 5.6. Block diagram of mechatronic servo system including torque saturation

5.2 Contour Control Method with Avoidance of Torque Saturation
109
In the region without torque saturation, the dynamics of a mechatronic
servo system is expressed by the 2nd order system (refer to item 2.2.4) as
Y (s) =
KpKv
s2 + Kvs + KpKv
U(s).
(5.11)
In order to avoid torque saturation, contour control is performed in the region
where dynamics of the mechatronic servo system is expressed by equation
(5.11).
(2) Contour Control Performance under Torque Saturation
For simplicity, contour control is investigated in an two-dimensional orthog-
onal coordination. In the three-dimensional case, plate with objective trajec-
tory is considered. The orthogonal coordinate system in the plate is handled
similarly for the two-dimensional case.
The objective locus formed by the two lines illustrated by Fig. 5.7, con-
tour control performance is derived under torque saturation. When objective
velocity v is constant in contour control, the necessity of realizing the cor-
ner part approximated by a polygonal line is that the acceleration should be
inﬁnite. Such a polygonal line cannot be described by a mechatronic servo
system. In this part, as shown in Fig. 5.7, the objective locus in the corner
part approximated by a polygonal line is performed with a circle approxima-
tion. The radius of circle r is deﬁned by the working precision ϵ which is the
maximum value of errors between the generated locus by circle and polygonal
line objective locus. The relationship between circle radius r and the working
precision ϵ is as geometry relation in Fig. 5.7 as
cos
6θc2 −θc1
2
=
=
r
r + ϵ.
(5.12)
θ
θ
x
x
x
x
t2
t4
t1
t3
r
ε
x
y
2
c1
c2
Objective locus
axis
axis
Generated locus
θc2-θc1
Fig. 5.7. Trajectory generation corresponding to the objective trajectory of two
lines

110
5 Torque Saturation of a Mechatronic Servo System
By solving equation (5.12) on r, circle radius r satisfying working precision ϵ
can be calculated as
r =
ϵ cos{(θc2 −θc1)/2}
1 −cos{(θc2 −θc1)/2}.
(5.13)
The maximal acceleration Amax obtained from the mechatronic servo sys-
tem is dependent on the equipment. As shown in Fig. 5.7, the locus angle
θc1 and θc2 of the objective locus are given. According to the working task
of contour control, minimal velocity vmin needed with the lowest limitation
in operation under objective velocity v and working precision ϵ are given. In
the following part, equations related with minimal velocity vmin in the objec-
tive of control performance and maximal acceleration Amax, which is about
relationship between working precision ϵ and torque, are derived.
(i) Boundary values of working precision ϵ with a given maximal velocity
vmin
Acceleration of the circle trajectory is a = rω2. If ω = v/r, then r = v2/a.
Therefore, the region of circle radius with minimal velocity vmin and maximal
velocity Amax is expressed as
r ≥v2
min
Amax
.
(5.14)
The relationship between radius r and the working precision ϵ is expressed by
the equation (5.13) and the solution of ϵ is as
ϵ =
.
1
cos{(θc2 −θc1)/2} −1
0
r.
From the relationship between this equation and equation (5.14), the scale of
working precision ϵ, if given minimal velocity vmin, is as
ϵ ≥
.
1
cos{(θc2 −θc1)/2} −1
0 v2
min
Amax
.
(5.15)
(ii) Boundary values of minimal vmin when given working precision ϵ
Radius r is expressed by equation (5.13) when given working precision ϵ. The
minimal velocity vmin with this radius r and maximal acceleration Amax can
be expressed as vmin ≤√Amaxr from equation (5.14). If we put r of this
equation into equation (5.13), the scale of minimal velocity vmin, if given
working precision ϵ, is expressed as
vmin ≤
B
Amaxϵ cos{(θc2 −θc1)/2}
1 −cos{(θc2 −θc1)/2} .
(5.16)

5.2 Contour Control Method with Avoidance of Torque Saturation
111
(3) Contour Control Considering Torque Saturation
In the contour control of an industrial mechatronic servo system, motion is
performed in the region without generating torque saturation. In order to
implement it, the trajectory of mechatronic servo system should be determined
without torque saturation. Fig. 5.8 illustrates the contour control structure of
a mechatronic servo system. The contour control considering torque saturation
is divided into two big parts. One is the generation part of the trajectory in
working coordinates without torque saturation. Another is the compensation
part of dynamics of the mechatronic servo system.
For generation of trajectory (wx(t), wy(t)), a locus is generated by sat-
isfying the working precision ϵ between the objective locus (rx, ry) and the
generated locus (wx, wy) without torque saturation in a mechatronic servo
system as shown in Fig. 5.8 ﬁrstly. The velocity given in locus (wx, wy) gen-
eration is approximated with the objective velocity v with a limitation in the
region without torque saturation.
If directly using the generated trajectory (wx(t), wy(t)) as an input trajec-
tory (ux(t), uy(t)), following the locus (x, y) generated from the locus (wx, wy)
will be degraded because of the dynamics of the mechatronic servo system.
If using the inverse dynamics of the mechatronic servo system in equation
(5.11) without torque saturation, the input trajectory (ux(t), uy(t)) can be
adopted with revised generated trajectory (wx(t), wy(t)). Then, any delay of
the mechatronic servo system is compensated, and the following trajectory
(px(t), py(t)) is consistent with the generated trajectory (wx(t), wy(t)). More-
over, the following locus (x, y) is satisﬁed with working precision of ϵ.
(4) Trajectory Generation Considering Torque Saturation
For an objective locus (rx, ry) generated from two lines for approximating the
trajectory shown in Fig. 5.7, the trajectory generation method, if generating
a trajectory along the time shift under the limitation of the torque of the
mechatronic servo system, is explained below.
1. When there exists an angle in the objective locus (rx, ry), the angle will
be approximated by a circle satisfying working precision ϵ.
2. Radius r of the circle included in the locus (wx, wy) is calculated by a
tangent velocity between the minimal radius rmin(= v2/Amax) satisfying
torque constraints and the maximal acceleration Amax.
(r  ,r  )
x
y
x
y
x
y
(w (t),w  (t))
(u  (t),u  (t))
(x(t),y(t))
v
Objective locus
Objective velocity
Generated
trajectory
Input 
trajectory
Following
trajectory
Trajectory
generator
Inverse
dynamics
Mechatronic
servo system
Fig. 5.8. Contour control structure of mechatronic servo system including torque
saturation

112
5 Torque Saturation of a Mechatronic Servo System
a) If r ≥rmin: generated trajectory (wx(t), wy(t)) is calculated for chang-
ing the objective tangent velocity into tangent velocity.
b) If r < rmin: trajectory is generated according to the following proce-
dure.
i. In the region from t1 to t2, the tangent velocity is decelerated
with maximal deceleration of −Amax from v to vmin(the tangent
velocity is vmin = √Amaxr if the acceleration of radius r circle is
Amax).
ii. In the region from t2 to t3, the locus is described by circle.
iii. In the region from t3 to t4, the tangent velocity is accelerated with
a maximal acceleration of Amax from vmin to v.
3. In the beginning point and end point of the objective locus, acceleration
and deceleration are performed with a maximal acceleration Amax.
Based on the above introduced procedure, a trajectory (wx(t), wy(t)) can be
generated without torque saturation and the generated locus (wx, wy) can be
made consistent with the objective locus (rx, ry) within the working precision
ϵ.
In the case of 2b, trajectory generation can be derived by
wx(t) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
vt cos θc1
(t ≤t1)
wx(t1) +
$
v(t −t1) −Amax(t −t1)2
2
)
cos θc1
(t1 < t ≤t2)
wx(t2) + r
.
sin
$
θc1 + vmin(t −t2)
r
)
−sin θc1
0
(t2 < t ≤t3)
wx(t3) +
$
v(t −t3) + Amax(t −t3)2
2
)
cos θc2
(t3 < t ≤t4)
wx(t4) + vt cos θc2
(t4 < t)
(5.17a)
wy(t) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
vt sin θc1
(t ≤t1)
wy(t1) +
$
v(t −t1) −Amax(t −t1)2
2
)
sin θc1
(t1 < t ≤t2)
wy(t2) + r
.
cos
$
θc1 + vmin(t −t2)
r
)
−cos θc1
0
(t2 < t ≤t3)
wy(t3) +
$
v(t −t3) + Amax(t −t3)2
2
)
sin θc2
(t3 < t ≤t4)
wy(t4) + vt sin θc2
(t4 < t)
(5.17b)
where the time interval of deceleration and acceleration is t4 −t3 = t2 −t1 =
(v−vmin)/Amax, describing the time of the circle is t3 −t2 = r(θc2 −θc1)/vmin.
This method is performed under condition of 2b r < rmin and with the lowest

5.2 Contour Control Method with Avoidance of Torque Saturation
113
limitation of velocity for preventing a rapid change in velocity. Besides, the
control time becomes longer in order to describe a circle. The high-precision
contour control will be performed under the conditions of that following the
locus (x, y) at the angle part also should be satisﬁed torque constraints, and
the generated locus (wx, wy) should be in agreement with the objective locus
(rx, ry) within the working precision ϵ.
(5) Delay Compensation Based on Inverse Dynamics
In order to compensate for the dynamics of the mechatronic servo system, the
trajectory should be revised by using inverse dynamics. Although the inverse
dynamics of equation (5.11) contains a second-order diﬀerential, the trajec-
tory (wx(t), wy(t)) is possible to obtain a 2nd order diﬀerential, compensation
based on inverse dynamics can be realized to design acceleration without
torque saturation. The inverse dynamics of a mechatronic servo system as in
equation (5.11) without torque saturation is expressed as
F(s) = s2 + Kvs + KpKv
KpKv
.
(5.18)
The input trajectory (ux(t), uy(t)) is derived according to a revised trajectory
(wx(t), wy(t)) based on inverse dynamics (5.18) as
ux(t) = wx(t) + 1
Kp
dwx(t)
dt
+
1
KpKv
d2wx(t)
dt2
(5.19a)
uy(t) = wy(t) + 1
Kp
dwy(t)
dt
+
1
KpKv
d2wy(t)
dt2
.
(5.19b)
When input trajectory (ux(t), uy(t)) are adopted as the command of the
mechatronic servo system, the following trajectory (px(t), py(t)) can be in
good agreement with the generated trajectory (wx(t), wy(t)).
(6) Contour Control Algorithm Considering Torque Saturation
The procedure of contour control considering torque saturation is illustrated
as below.
1. A trajectory is generated based on equation (5.17a), (5.17b) according to
the procedure of 5.2.1(4) from the objective trajectory (rxi(t), ryi(t)).
2. An input trajectory is calculated for compensating delay of dynamics by
using inverse dynamics of equation (5.19)
3. Input command of objective trajectory, which can compensate for the
dynamics delay of the mechatronic servo system, is given.

114
5 Torque Saturation of a Mechatronic Servo System
0
5
10
0
5
x axis position [rev]
y axis position [rev]
Conventional method
Consider only
working precision
Consider inverse dynamics
Objective locus
Locus
0
5
10
0
5
x axis position [rev]
y axis position [rev]
Conventional method
Consider only
working precision
Consider inverse dynamics
Objective locus
Locus
0
2
4
y axis position [rev]
Objective trajectory
Conventional method
Without 
inverse dynamics
With
inverse dynamics
y axis trajectory
0
2
4
y axis position [rev]
Objective trajectory
Conventional method
Without 
inverse dynamics
With
inverse dynamics
y axis trajectory
−10
0
10
y axis velocity [rev/s]
−10
0
10
y axis velocity [rev/s]
0
1
2
−50
0
50
Time [s]
y axis acceleration [rev/s2]
0
1
2
−2
0
2
Time [s]
y axis torque monitor [V]
(a) Simulation
(b) Experiment
Fig. 5.9. Experimental results and simulation results corresponding to the objective
trajectory of two lines
5.2.2 Experimental Veriﬁcation of Contour Control Considering
Torque Saturation
(1) Experiment Using DEC-1
In order to verify the eﬀectiveness of the contour control method avoiding
torque saturation, a computer simulation and experiment using the DEC-1
( experiment equipment referring E.1) were carried out. As contour control
approaches, three methods are compared, i.e., conventional method with orig-
inal objective trajectory usually used in the industrial ﬁeld, considering only
working precision without performing acceleration and deceleration, and con-
tour control avoiding torque saturation. The conditions of computer simula-
tion and experiment are as below: position loop gain Kp = 10[1/s], velocity

5.2 Contour Control Method with Avoidance of Torque Saturation
115
loop gain Kv = 56[1/s], maximal acceleration Amax = 80[rev/s2, sampling
time interval 10[ms], working precision ϵ = 0.1[rev], objective tangent velocity
v = 13.1[rev/s]. The objective trajectory is given as
drx(t)
dt
= 9.26
(0 ≤t ≤1.08[s])
(5.20a)
dry(t)
dt
=
$
9.26
(0 ≤t ≤0.54[s])
−9.26
(0.54 < t ≤1.08[s]).
(5.20b)
Input trajectory (ux(t), uy(t)) is derived according to the procedure of 5.2.1(4).
In Fig. 5.9, the computer simulation results and experimental results are illus-
trated. The acceleration output in the experimental results is measured by a
torque monitor. As shown in Fig. 5.9, the following locus generated overshoot
is based on the conventional method. This overshoot is not permitted to oc-
cur in contour control in industry (refer to 1.1.2 item 3). However, overshoot
does not occur in the proposed method which considers working precision. In
addition, the following locus has a large error compared with objective locus
in the conventional method, but in the proposed method, the following locus
is almost the same as the objective locus when considering working precision.
In the experimental results, the locus error is 0.17[rev]. From the acceleration
output in the experimental results shown in the ﬁgure, torque saturation is
generated. The torque saturation is 3[V] response of the torque monitor. Con-
cerning the bad impact of the conventional method, the tangent velocity by
conventional method will become larger than the objective tangent velocity
v = −9.26[rev/s]. At the peek point, the velocity is −11.5[rev/s] in the simu-
lation and −11.0[rev/s] in the experimental results. However, in the contour
control method avoiding torque saturation, the tangent velocity is also con-
sistent with the objective tangent velocity. From these results, the proposed
method is eﬀective in comparing other two methods.
(2) Experiment Using an Articulated Robot Arm (Performer
MK3S)
The proposed contour control method considering torque saturation was
adopted for an articulated robot arm (Performer MK3S; experiment device
refers to E.3). There are nonlinear transforms between working coordinates
and joint coordinates adopted in the articulated robot arm. As introduced
above, the contour control method avoiding torque saturation cannot be
adopted without change. If generating trajectory considering torque satura-
tion in working coordinates and compensating for delay in joint coordinates,
the proposed method can be adopted. In the delay compensation in joint co-
ordinates, modiﬁed taught data method (refer to section 6.1) is used here.
Besides, the relationship between maximal acceleration amax in joint coor-
dinates and maximal acceleration Amax in working coordinates is calculated
according to coordinate transform by using Jacobian with a reference input
time interval.

116
5 Torque Saturation of a Mechatronic Servo System
Although Performer MK3S uses 5 axes for a 5-freedom-degree articulated
robot arm, only two axes are used in the experiment. The servo motor in
each axis is connected with the servo controller for carrying out velocity and
current control. The servo controller is connected with the computer when
performing position control. In each axis, an AC servo motor (rated speed
3000[rpm]) is used and driving arm through deceleration device. The con-
ditions of the device are: position loop gain Kp = 25[1/s], velocity loop
gain Kv = 150[1/s], maximum acceleration amax = 11.0[rad/s2], sampling
time interval ∆t = 6[ms](refer to section 3.1), length of arm l1 = 0.25[m],
l2 = 0.215[m], gear ratio of each axis n1 = 160, n2 = 161. In the experiment,
the value multiplying position loop gain Kp in the error between position
input and motor position output are put into the motor as velocity input
through a D/A converter.
(i) Supposed torque saturation generation
The Performer MK3S used in the experiment can output very large amounts
of torque. In order to verify the signiﬁcance of the proposed method, the
supposed torque saturation can be generated by this device. This method
focuses on velocity input. If the actual measured angular acceleration output
multiplying velocity loop gain Kv with the error between velocity input vi
and output vf satisﬁed
|Kv(vi −vf)| > amax
(5.21)
velocity input vi is changed as
vi = sign(vi −vf)
6amax
Kv
=
+ vf
(5.22)
angular acceleration is not over amax. Torque saturation is changeable de-
pended on the device type. Based on the proposed method, the experiment is
realized in the same device considering various torque properties.
(ii) Simulation and experimental results
Fig. 5.10 illustrates the locus for four methods in 5.11, synthesized velocity
and simulation results and experimental results of the B axis acceleration with
saturation. (a) conventional method (objective trajectory is used as input of
the robot arm without any change), (b)conventional method in the state with
supposed torque saturation generation, (c) contour control method (consider-
ing precision) considered torque saturation, (d) contour control method (con-
sidering velocity) considered torque saturation are adopted. The conditions
of the simulation are designated tangent velocity v = 0.15[m/s], objective lo-
cus 0.05[m] length two lines of (0.135, 0.365) ∼(0.185, 0.365) ∼(0.185, 0.415)
which is turned as a vertical angle. As introduced in 5.2.1(4), maximal ac-
celeration amax in joint coordinates and maximal acceleration in working co-
ordinates given from the objective are calculated as Amax = 1.0[m/s2]. In

5.2 Contour Control Method with Avoidance of Torque Saturation
117
0.14
0.16
0.18
0.36
0.38
0.4
0.42
x[m]
y[m]
0.14
0.16
0.18
x[m]
0
0.1
0.2
Velocity[m/s]
0
0.2
0.4
0.6
-20
-10
0
10
20
Time[s]
B axis acceleration[rad/s2]
0
0.2
0.4
0.6
Time[s]
(a) Without torque saturation (b) With torque saturation
0.14
0.16
0.18
0.36
0.38
0.4
0.42
x[m]
y[m]
0.14
0.16
0.18
x[m]
0
0.1
0.2
Velocity[m/s]
0
0.2
0.4
0.6
0.8
1
-20
-10
0
10
20
Time[s]
B axis acceleration[rad/s2]
0
0.2
0.4
0.6
0.8
Time[s]
(c) Proposed method
(considering precision)
(d) Proposed method
(considering velocity)
Fig. 5.10. Simulation results

118
5 Torque Saturation of a Mechatronic Servo System
0.14
0.16
0.18
0.36
0.38
0.4
0.42
x[m]
y[m]
0.14
0.16
0.18
x[m]
0
0.1
0.2
Velocity[m/s]
0
0.2
0.4
0.6
-20
-10
0
10
20
Time[s]
B axis acceleration[rad/s2]
0
0.2
0.4
0.6
Time[s]
(a) Without torque saturation (b) With torque saturation
0.14
0.16
0.18
0.36
0.38
0.4
0.42
x[m]
y[m]
0.14
0.16
0.18
x[m]
0
0.1
0.2
Velocity[m/s]
0
0.2
0.4
0.6
0.8
1
-20
-10
0
10
20
Time[s]
B axis acceleration[rad/s2]
0
0.2
0.4
0.6
0.8
Time[s]
(c) Proposed method
(considering precision)
(d) Proposed method
(considering velocity)
Fig. 5.11. Experimental results

5.2 Contour Control Method with Avoidance of Torque Saturation
119
the contour control considering torque saturation for focusing on precision in
Fig. (c), the working precision is ϵ = 1.0 × 10−4[m] focusing on locus, min-
imal velocity vmin = 0.0155[m/s] is given when velocity is decreased to 10%
of objective velocity. In the contour control considering torque saturation for
focusing on velocity in Fig. (d), there exists a decrease of contour control pre-
cision when the response cannot be ﬁt for the situation that velocity is over
dropped at the corner at the operation of laser cutting, or input current of laser
is over reduced, or increasing current cost so much time at velocity increasing.
For these cases, the delay issue of input current response will disappear when
velocity is only equal to 70% of the objective velocity. Then, the working pre-
cision was calculated under the condition that the velocity was decreased till
70% of objective velocity. If ϵ = 0.005[m], minimal velocity vmin = 0.1[m/s]
is given when velocity is decreased to 70% of objective velocity. The common
pole of regulator in Fig. (c) and (d) was given as γ = −30.
In the following locus of Fig. (a), the deterioration of locus as roundness
at the corner part of the simulation and experiment can be found. The rea-
son for deterioration is the delay dynamics of the robot arm and it can be
understood even from the results of acceleration to be not linked to torque
saturation. On the other hand, the marked part of B axis acceleration exist
0.33∼0.44[s] saturation by observing the results of each axis acceleration in
the simulation and experimental results in Fig. (b). In addition, the error in
the experiment is smaller in the simulation results and experimental results.
With same trend at the marked part of the following locus, in the simulation
error is 1.35[mm], but in the experiment is 0.74[mm]. At the marked combined
velocity, in the simulation the overshoot is 0.3[m/s], but in the experiment is
0.12[m/s]. Overshoot must be avoided as much as possible in order to improve
precision (refer to 1.1.2 item 3). From the simulation and experimental results
in Fig. (c), there are no overshoots in the following locus results. From the
combined velocity, spending more time than Fig. (a) and (b) at the marked
corner part for using necessary minimal velocity. Hence, the dynamics of the
robot arm is compensated and there is no torque limitation. In addition, the
minimal velocity is satisﬁed as vmin = 0.015[m/s]. From the simulation and
experimental results in Fig. (d), there is no overshoot in the following locus
results, and the designated working precision is satisﬁed as ϵ = 0.005[m].
Spending time is not longer than Fig. (a), (b), and there is no torque limita-
tion. Additionally, from the synthesis velocity, minimal velocity is larger than
vmin = 0.1[m/s] in order to reduce the velocity at the marked corner part.
From the above simulation and experimental results, the contour control
method considering torque saturation satisﬁes working precision and mini-
mal velocity within the torque saturation, and it can be realized within the
limitation of contour control performance.

6
The Modiﬁed Taught Data Method
In order to realize the movement of an industrial robot, the given objective tra-
jectory is always used without any change when their coordinate values which
are the taught data obtained from the teaching. Therefore, in the movement
response of the robot at the playback, the errors between the objective lo-
cus and the following locus of the robot appeared because of the time delay
generated at each axis. In this chapter, the modiﬁed taught data method is
proposed in order to improve the precision of the trajectory in the contour
control.
6.1 Modiﬁed Taught Data Method Using a
Mathematical Model
In the operation of the robot, the practician, who is performing the teach-
ing of the robot in the industrial ﬁeld, improved the precision of the contour
control of the robot successfully through the teaching points with a little over
movement from the actual objective points at the corner part of objective
locus (modiﬁed taught data). However, this method can be only adapted for
the limited action situation.
From the investigation of the adopted method by the practician and the
reasons of performance improvement, the deterioration of control performance
owing to the dynamics delay of the mechatronic servo system and the real-
ization method of dynamic compensation (modiﬁed taught data) have been
found. With the model of a mechatronic servo system in chapter 1, the mod-
iﬁed taught data method with pole assignment regulator for the dynamic
compensation was proposed and the construction of the modiﬁcation element
was introduced. In order to use this method for the semi-closed pattern which
is without a sensor for measuring the tip position of the robot arm in the
mechatronic servo system (refer to 1.1.2 item 5), the modiﬁcation element
was revised from the closed-loop form with the control law to the open-loop
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 121–147, 2004.
Springer-Verlag Berlin Heidelberg 2004

122
6 The Modiﬁed Taught Data Method
form as (6.7), (6.25). With the characteristic evaluation of the obtained mod-
iﬁcation element of the taught data by a frequency transfer function, the
realization of the phase-lead compensation was known.
According to this modiﬁed taught data method, any shape of the objective
locus not only the rectangle can be realized. If the servo parameters Kp, Kv
were clear and understood, this method can be adopted for any mechatronic
servo system. Also, it is only necessary to revise the software in this method.
The existing hardware does not need to be changed. Therefore, this method
is very useful in the industrial ﬁeld.
6.1.1 Derivation of the Modiﬁed Taught Data Method
(1) Concept of the Modiﬁed Taught Data Method
In the working coordinates of a mechatronic servo system, the relationship
between the input and output of the each independent coordinate axis can be
expressed independently as
Y (s) = G(s)U(s)
(6.1)
where U(s) denotes taught data, Y (s) the following trajectory of the mecha-
tronic servo system and G(s) the dynamics of the mechatronic servo system.
The teaching playback robot refers to the semi-closed type control system (re-
fer to 1.1.2 item 5) with the feedforward control, but without the measure of
the tip position or velocity of the mechatronic servo system and the change of
hardware. Moreover, the modiﬁcation element F(s) for the objective trajec-
tory R(s) through the taught data U(s) can be generated. That means that
the taught data U(s) can be expressed as,
U(s) = F(s)R(s).
(6.2)
Fig. 6.1 shows the block diagram of the modiﬁed taught data method. In
order to realize the desired control performance Y (s) = R(s), i.e., keeping the
mechatronic servo system the concordance with objective trajectory, the mod-
iﬁcation element F(s) was required for the inverse dynamics G−1(s) of the
mechatronic servo system. However, in the design of the modiﬁcation element
by F(s) = G−1(s), if there is no proper inverse dynamic G−1(s), the taught
data will diverge when the objective trajectory is not diﬀerential. Therefore,
R(s)
F(s)
U(s)
Y(s)
G(s)
Modification
element
Mechatronic
servo system
Fig. 6.1. Block diagram of the modiﬁed taught data method

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
123
the mechatronic servo system will be expressed by the state-space representa-
tion and the modiﬁcation element will be designed with the pole assignment
regulator (refer to appendix A.3) in order to change the mechatronic servo
system F(s)G(s) into the appropriate closed-loop control system.
(2) A modiﬁed taught data method based on the 1st order model
(i) Mathematical model
Firstly, deriving the modiﬁcation element easily, the 1st order model of the
mechatronic servo system is derived by the modiﬁed taught data method.
When the actuator of the mechatronic servo system, i.e., the velocity of the
servo motor, is moved under 1/20 of the rated value, the whole control system
of the mechatronic servo system including control equipment, servo system
and mechanism shown in Fig. 6.2 can be expressed as the 1st order model in
the working coordinates with each independent coordinate axis (refer to the
2.2.3)
G1(s) =
Kp
s + Kp
(6.3)
where Kp denotes the meaning of Kp1 in the equation (2.23) of the low speed
1st order model of 2.2.3.
(ii) Modiﬁcation element
As expressed in the state space of the equation (6.3) of the mechatronic servo
system, the modiﬁcation element F1(s) is derived by the pole assignment
regulator (refer to the appendix A.3). For the objective trajectory r(t), assume
dr(t)/dt ≃0. From the equation (6.3) and the assumption dr(t)/dt ≃0, the
mechatronic servo system expressed by a state-space representation is changed
as
dx(t)
dt
= −Kpx(t) + Kpr∗(t)
(6.4)
x(t) = y(t) −r(t)
r∗(t) = u(t) −r(t).
R(s)
U(s)
F (s)
-
Kp
+
1
Modification
element
Y(s)
1-
s
Mechatronic servo system
Servo
controller
Motor and
mechanism part
Position loop
Fig. 6.2. Block diagram of the modiﬁed taught data method based on the 1st order
model

124
6 The Modiﬁed Taught Data Method
If the state equation (6.4) can be derived with the assumption dr(t)/dt ≃0,
the pole assignment regulator can be adopted and the modiﬁcation term of
the taught data r∗(t) is easily derived. Thus, as one of the key conditions the
meaning of the assumption dr(t)/dt ≃0 which brought about good results
will be explained in the 6.1.2.
From the pole assignment regulator, the control input is given as
r∗(t) = Ksx(t)
(6.5)
where Ks denotes the feedback gain of the regulator. The relationship between
the feedback gain Ks and the pole of the regulator γ is shown as
γ = −Kp(1 −Ks).
(6.6)
When the equation (6.5) and equation (6.6) are input into the equation (6.3)
which expresses the 1st order model, the taught data u(t) is given as
du(t)
dt
−γu(t) = −γ
Kp
6dr(t)
dt
+ Kpr(t)
=
.
(6.7)
From the Laplace transform of the equation (6.7)(refer to the appendix A.1),
the modiﬁcation element F1(s) is given as
F1(s) = −γ(s + Kp)
Kp(s −γ).
(6.8)
From the solution of the diﬀerential equation (6.7) about u(t), the taught data
u(t) can be calculated based on the 1st order model of the mechatronic servo
system.
When the modiﬁcation element F1(s) is adopted in the mechatronic servo
system G1(s), the control system of the robot arm after revision can be
changed as
Y (s) =
−γ
s −γ R(s).
(6.9)
From the comparison between the original mechatronic servo system (6.3) and
the revised mechatronic servo system (6.9), the modiﬁcation element changes
the pole of the mechatronic servo system from −Kp to γ.
(iii) Selection of the pole
The selection of the regulator pole γ is given by the designer in the equation
(6.8) of the modiﬁcation element is introduced. Firstly, in order to improve
the control performance of the mechatronic servo system, it is necessary to
satisfy the following equation so that the response of the control system of the
mechatronic servo system after revision is faster than that before revision.
γ ≤−Kp.
(6.10)

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
125
Then, the velocity limitation of the servo motor, i.e., the actuator of the
mechatronic servo system, must be considered when using the modiﬁed taught
data method in the actual mechatronic servo system. When the maximum
velocity of the servo motor is Vmax, the velocity limitation is shown as,
|Kp{u(t) −y(t)}| ≤Vmax.
(6.11)
The left-hand side of (6.11) denotes the velocity input of the servo motor. In
fact, the computer simulation of the modiﬁed taught data method with the
pole which has a certain error in the left side of (6.11) is made. The minimal
pole which is satisﬁed the by conditions of (6.10) and (6.11) is selected.
(3) Modiﬁed Taught Data Method Based on the 2nd Order Model
(i) Mathematical model
When the velocity of the motion of the mechatronic servo system becomes high
and the velocity of the servo motor is between 1/5 ∼1/20 of the rated value,
considering the characteristics of the velocity control of the servo motor and
the control system of the whole mechatronic servo system shown in Fig. 6.3,
it is necessary to express each coordinate independently with the 2nd order
model as (refer to 2.2.4)
G2(s) =
KpKv
s2 + Kvs + KpKv
(6.12)
where Kp, Kv have the meanings of Kp2, Kv2 in (2.29) of the middle speed
2nd order model in 2.2.4, respectively.
(ii) Modiﬁcation element
The mechatronic servo system is expressed by a state-space representation
based on the 2nd order model (6.12). The modiﬁcation element can be derived
by the pole assignment regulator (refer to appendix A.3) and the minimum
F (s)
R(s)
U(s)
-
-
Kp
K
+
+
v
2
Y(s)
1-
s
1-
s
Modification
element
Mechatronic servo system
Servo controller
Motor and
mechanism part
Velocity loop
position loop
Fig. 6.3. Block diagram of the modiﬁed taught data method based on the 2nd order
model

126
6 The Modiﬁed Taught Data Method
order observer (refer to appendix A.4). Since the 2nd order model contains
the velocity loop, the derivation of the modiﬁcation element F2(s) is more
complex than that of the 1st order model.
From (6.12) and the assumption of d2r(t)/dt2+Kvdr(t)/dt ≃0, the mecha-
tronic servo system can be expressed with a state-space representation as,
dx(t)
dt
= Ax(t) + br∗(t),
y∗(t) = cx(t)
(6.13)
A =
6
−Kv
1
−KpKv
0
=
,
b =
6
0
KpKv
=
,
c = (1
0)
(6.14a)
x(t) =
6
y∗(t)
dy∗(t)/dt + Kvy∗(t)
=
(6.14b)
y∗(t) = y(t) −r(t),
r∗(t) = u(t) −r(t).
(6.14c)
The assumption d2r(t)/dt2 + Kvdr(t)/dt ≃0 is adapted for regulator the-
ory. The signiﬁcance of introducing the assumption d2r(t)/dt2+Kvdr(t)/dt ≃
0 is explained in 6.1.2.
The state-space representation equation (6.13) of the mechatronic servo
system is ﬁt for the pole assignment regulator and a minimum order observer.
The pole assignment regulator is expressed as (refer to the appendix A.3)
r∗(t) = (f1
f2)ˆx(t)
(6.15)
f1 = 1 −Kv
Kp
−γ1 + γ2
Kp
−γ1γ2
KpKv
f2 =
1
Kp
+ γ1 + γ2
KpKv
.
Moreover, the minimum order observer is changed as (refer to the appendix
A.4)
dz(t)
dt
= µz(t) −(KpKv + µKv + µ2)y∗(t) + KpKvr∗(t)
(6.16a)
ˆx(t) =
6
0
1
=
z(t) +
6
1
−µ
=
y∗(t).
(6.16b)
When we input ˆx(t) into (6.15), the control input r∗(t) can be derived as
r∗(t) = (f1 −µf2)y∗(t) + f2z(t).
(6.17)
In order to obtain the modiﬁcation element F2(s), (6.14c), (6.16a) and (6.17)
are transformed into the frequency domain as

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
127
Y ∗(s) = Y (s) −R(s),
R∗(s) = U(s) −R(s)
(6.18a)
Z(s) = −KpKv −µKv −µ2
s −µ
Y ∗(s) + KpKv
s −µ R∗(s)
(6.18b)
R∗(s) = (f1 −µf2)Y ∗(s) + f2Z(s).
(6.18c)
When we input (6.18b) into (6.18c), the relationship between R∗(s) and Y ∗(s)
can be obtained as
R∗(s) = (s −µ)f1 −(µs + KpKv + µKv)f2
s −µ −f2KpKv
Y ∗(s).
(6.19)
From (6.18a) and (6.19), U(s) can be given with R(s) and Y (s)
U(s) = {1 −P(s)}R(s) + P(s)Y (s)
(6.20)
where
P(s) = (s −µ)f1 −(µs + KpKv + µKv)f2
s −µ −f2KpKv
.
(6.21)
The relationship between the objective trajectory R(s) and the following tra-
jectory of the mechatronic servo system Y (s) is changed from (6.12) and (6.20)
as
Y (s) = G2(s){1 −P(s)}
1 −G2(s)P(s) R(s).
(6.22)
Finally, the modiﬁcation element F2(s) is derived from (6.22) as
F2(s) =
1 −P(s)
1 −G2(s)P(s).
(6.23)
When we input f1 and f2, the modiﬁcation element F2(s) can be expressed
by the poles of the regulator γ1, γ2(< 0), the pole of the observer µ(< 0) and
the servo parameterKp, Kv as
F2(s) = α3s3 + α2s2 + α1s + α0
(s −γ1)(s −γ2)(s −µ)
(6.24)
α0 = −µγ1γ2
α1 = (Kv + µ)(γ1 + γ2) + K2
v + γ1γ2 + Kvµ −µγ1γ2
Kp
α2 =
1
Kp
{(Kv + µ)(γ1 + γ2) + K2
v + γ1γ2 + Kvµ} −µγ1γ2
KpKv
α3 =
1
KpKv
{(Kv + µ)(γ1 + γ2) + K2
v + γ1γ2 + Kvµ}.
In the time domain, the modiﬁcation element F2(s) can be transformed as
6 d
dt −γ1
= 6 d
dt −γ2
= 6 d
dt −µ
=
u(t)
=
6
α3
d3r(t)
dt3
+ α2
d2r(t)
dt2
+ α1
dr(t)
dt
+ α0r(t)
=
.
(6.25)

128
6 The Modiﬁed Taught Data Method
According to the solution of the diﬀerential equation (6.25) about u(t), the
modiﬁed taught data u(t) can be calculated based on the 2nd order model.
From the modiﬁcation element F2(s) and the mechatronic servo system
(6.12), the mechatronic servo system after revision can be described as
Y (s) =
β1s + β0
(s −γ1)(s −γ2)(s −µ)R(s)
(6.26)
β0 = −µγ1γ2
β1 = (Kv + γ1 + γ2)(Kv + µ) + γ1γ2.
(iii) Selection of a pole
In the design of the modiﬁcation element as (6.24), the appropriate selection
poles of the regulator γ1, γ2 and the pole of the observer is necessary. Since
the pole of the observer should be smaller than the pole of the regulator, i.e.,
µ < min(γ1, γ2).
(6.27)
concerning the pole of the regulator, γ1 ≤γ2 is assumed without losing gener-
ality. If applying the modiﬁed taught data method in the actual mechatronic
servo system, the overshoot must be avoided in the following trajectory of the
mechatronic servo system (refer to 1.1.2 item 3). In the third order system
(6.26) with one zero, the condition of not generating an overshoot is that it
is better to deﬁne the most pole below the zero. Therefore, the pole of the
regulator is selected for meeting the following condition,
γ2 ≥
µγ1γ2
(Kv + γ1 + γ2)(Kv + µ) + γ1γ2
.
(6.28)
With the transformation of (6.28) as
(Kv + γ2)(Kv + µ + γ1) ≥0
(6.29)
because of the µ < γ1 ≤γ2 < 0, it can be obtained as
γ2 ≥−Kv
(6.30)
In order to realize the fastest response of the condition (6.30), the pole is as
γ2 = −Kv and deﬁning
Y (s) =
µγ1
(s −γ1)(s −µ)R(s).
(6.31)
From the original mechatronic servo system (6.12) and the mechatronic servo
system after revision (6.31), the modiﬁcation element transforms the poles
of the mechatronic servo system from (−Kv ±
C
K2v −4KvKp)/2 to γ1 and
µ. Similar as the 1st order system, since the control system of mechatronic
servo system after revision becomes faster than that before revision in order to

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
129
improve the control performance of the mechatronic servo system, γ1 should
be satisﬁed
γ1 ≤−Kv −
C
K2v −4KvKp
2
.
(6.32)
Besides, in the selection of poles γ1 and µ, the conditional equation (6.11)
of velocity limitation of the servo motor and the torque limitation of the
servo motor should be considered. The torque limitation of the servo motor
is described as
C
JJJJKv
.
Kp{u(t) −y(t)} −dy(t)
dt
0JJJJ ≤Tmax
(6.33)
where Tmax denotes the maximum torque of the servo motor and C the co-
eﬃcient of transformation from acceleration to torque. These parameters are
the ﬁxed values of the instrumentation. Through the computer simulation,
the poles γ1 and µ are satisﬁed (6.11), (6.32) and (6.33) with minimum are
selected.
6.1.2 Properties Analysis of the Modiﬁed Taught Data Method
The introduced modiﬁed taught data method in this section is based on the
theory of the pole assignment regulator. The regulator theory is always used
in order to let the objective point reaching the system output. However, the
control of the mechatronic servo system is the following control, i.e., the objec-
tive trajectory is time-variable. Besides, in the derivation of the modiﬁcation
element, the assumption dr(t)/dt ≃0 is introduced when using the 1st order
model and the assumption d2r(t)/dt2 + Kvdr(t)/dt ≃0 is introduced when
using the 2nd order model in order to adopt the pole assignment regulator
theory. However, these assumptions are not often satisﬁed actually for the ob-
jective trajectory when considering the utilization conditions of mechatronic
servo system. Therefore, the meaning of introducing these assumptions should
be discussed. The improvement of the response properties of using the modi-
ﬁed taught data method and that of using the conventional method with the
original objective trajectory in the taught data should be compared in the
time domain and frequency domain.
(1) The 1st Order Model
The properties analysis of the modiﬁed taught data method based on the 1st
order model is discussed. Firstly, the analysis is made in the time domain.
Based on the inverse Laplace transform (refer to the appendix A.1), the equa-
tion on the relationship between the objective trajectory r(t) of the modiﬁed
taught data method and the output y(t) of the control system in the time
domain can be changed from the transfer function (6.9) to

130
6 The Modiﬁed Taught Data Method
dy(t)
dt
= γy(t) −γr(t).
(6.34)
On the other hand, based on the inverse Laplace transformation, the equation
which describes the properties of the objective trajectory r(t) and output y(t)
when the values of the objective trajectory is directly used as the taught data
in the conventional method as u(t) = r(t) can be changed from the transfer
function (6.3)to
dy(t)
dt
= −Kpy(t) + Kpr(t).
(6.35)
With the comparison between the properties of the modiﬁed taught data
method (6.34) and that of the conventional method (6.35), the coeﬃcient of
−y(t) and r(t) can be changed from Kp to −γ. Namely, in the modiﬁed taught
data method, the properties of the system are transformed from Kp to −γ
according to the proper taught data. In order to design properly the pole of
the regulator γ in the scale of γ < −Kp, where the time constant of (6.34)
is −1/γ, the time constant 1/Kp of (6.35) in the conventional method can
become smaller. Therefore, the output y(t) can trace the objective trajectory
r(t) quickly with the small time constant in the modiﬁed taught data method.
If with the same precision of the contour control, the velocity of the objective
trajectory in the proposed method is increased to −γ/Kp times than that in
the conventional method.
Next, the analysis is made in the frequency domain. Fig. 6.4 shows the
Bode diagram under the conditions of Kp = 15[1/s], γ = −60[1/s]. The Bode
diagrams of the system before revision as Fig. (a) and that of the system after
revision as Fig. (b) are compared. From the Bode diagram of the system after
revision in Fig. (b), the frequency considered with a boundary is ω = 30 [rad/s]
when the gain property is constant at 0 [dB]. This frequency is higher than
the ω = 7 [rad/s] of the gain property of the control system of the mechatronic
servo system in Fig. (a). Concerning the phase characteristics, the boundary
frequency ω = 1 [rad/s] at which there nearly does not generate time delay is
higher comparing with ω = 0.02 [rad/s] in Fig. (a). With these improvements
in properties by the revision of the taught data, the cut-oﬀfrequency can be
changed from −Kp to −γ. The gain properties of the modiﬁcation element is
changed from(6.8) as
|F1(jω)| = −γ
Kp
B
ω2 + K2p
ω2 + γ2 .
(6.36)
From the gain property of Fig. (c), the gain of the modiﬁcation element begins
to increase accompanying the increase of frequency near ω = 7 [rad/s] and
reaches about 12 [dB] at ω = 500 [rad/s]. This frequency ω = 7 [rad/s] from
which the gain of the modiﬁcation element begins to increase is the same as the
frequency from which the gain of the mechatronic servo system begins to drop.
This phenomenon of the modiﬁcation element describes the compensation of
the gain of the control system in the original mechatronic servo system.

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
131
Besides, the phase characteristics of the modiﬁcation element is changed
from (6.8) to
argF1(jω) = −tan−1 (γ + Kp)ω
ω2 −Kpγ .
(6.37)
With the phase characteristics in Fig. (c), the modiﬁcation element can
cause the phase to advance in the high frequency band comparing with
ω = 0.02 [rad/s]. This frequency is identical with the frequency whose phase
of the control system in the mechatronic servo system begins the delay. The
maximum phase of the modiﬁcation element can be calculated as
sin φm = γ + Kp
γ −Kp
.
(6.38)
The frequency at this moment is changed as [28]
10−2
100
102
−40
−20
0
−50
0
Angular frequency [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(a) Original system
10−2
100
102
−40
−20
0
−50
0
Angular frequency  [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(b) Modiﬁed system
10−2
100
102
0
10
0
10
20
30
Angular frequency [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(c) Modiﬁcation element
Fig. 6.4. Bode diagram of modiﬁed taught data method based on the 1st order
model (Kp = 15[1/s], γ = −60[1/s])

132
6 The Modiﬁed Taught Data Method
ωm =
C
−Kpγ.
(6.39)
From the above analysis, the modiﬁcation element brings about the phase-
lead compensation. Because of it and according to the modiﬁcation element,
the mechatronic servo system does not generate the gain deterioration and
phase delay and also traces the objective trajectory quickly facing to the
objective trajectory including the high-frequency factors compared with the
conventional method using the original objective trajectory in the taught data.
Comparing with the previously adopted feedback control by inverse dy-
namics with the modiﬁcation element F1(s) in the feedforward control by
inverse dynamics, the modiﬁed taught data will be diverse when the objec-
tive trajectory cannot be diﬀerentiated. Facing this problem, the modiﬁed
taught data cannot be diﬀerentiated from the proper modiﬁcation element
from equation (6.8) in the modiﬁed taught data method. Besides, in the limit
of γ →−∞, the modiﬁed taught data method corresponds to the feedforward
control by inverse dynamics.
In addition, comparing the revised taught data based on the servo theory
without using the assumption dr(t)/dt ≃0, the proposed method based on the
pole assignment regulator using the assumption dr(t)/dt ≃0 is predominance.
The diﬀerential equation about the taught data, which is represented in
the 2nd order state space of systems with one integrator, constructed b the
1st order servo based on the minimum order observer (refer to the appendix
A.4) and pole assignment regulator (refer to the appendix A.3) and equivalent
to the equation (6.7) derived by the pole assignment regulator, can be derived
as
d3u(t)
dt3
+ a2
d2u(t)
dt2
+ a1
du(t)
dt
+ a0u(t) = b2
d2r(t)
dt2
+ b1
dr(t)
dt
+ b0r(t) (6.40)
a0 = lK2
p(f1 + f2)
a1 = Kp(lKp + f1 + f2 + lf2)
a2 = lKp + Kp + f2
b0 = lK2
p(f1 + f2)
b1 = Kp(f1 + lf1 + 2lf2)
b2 = f1 + lf2
where f1 and f2 are calculated by the poles of server system γ1, γ2 in the
feedback gain as
f1 = Kp + γ1 + γ2 + γ1γ2
Kp
(6.41a)
f2 = −Kp −γ1 −γ2.
(6.41b)
l has the relationship with the pole of the observer µ in the design of the
parameter as

6.1 Modiﬁed Taught Data Method Using a Mathematical Model
133
µ = −lKp.
(6.42)
The transfer function Gs(s) of the whole control system using the 1st order
servo can be described by the third order system with zero as
Gs(s) =
Kp(c1s + c0)
s3 + a2s2 + a1s + a0
(6.43)
c0 = lKp(f1 + f2)
c1 = f1 + lf2.
The poles of Gs(s) are γ1, γ2, µ and the zeros are γ1γ2µ/{(Kp+γ1 +γ2)(Kp +
µ)+γ1γ2}. Comparing with the zeros of Gs(s) and the real parts of the poles,
overshoot will be generated when the zeros are always bigger than that of the
real parts of the poles.
For this case, the modiﬁed taught data method with a servo theory has
the shortcoming of generating an overshoot when the following a trajectory
tracing the objective trajectory comparing it with the modiﬁed taught data
method with the pole assignment regulator and the properties of tracing the
time variation of the objective trajectory can be found. Therefore, the modiﬁed
taught data method based on the pole assignment regulator theory shows the
predominance because the correct locus expressed by the arm position is very
important in the contour control of the mechatronic servo system and the
generation of an overshoot is the fatal shortcoming.
(2) The 2nd Order Model
In this part, the properties analysis of the modiﬁed taught data method based
on the 2nd order model is made. The properties in the 2nd order model is al-
most that same as that based on the 1st order model. In the time domain, the
modiﬁcation element transformed the poles of the mechatronic servo system
from (−Kv ±
C
K2v −4KvKp)/2 to γ1 and µ comparing the original mecha-
tronic servo system (6.12) with the mechatronic servo system after revision
(6.31). In the frequency domain, the Bode diagram of the modiﬁed taught data
method is based on the 2nd order model with the parameters of Kp = 15[1/s],
Kv = 60[1/s], γ1 = γ2 = −60[1/s], µ = −120[1/s] is shown in Fig. (6.5). It is
almost the same with the properties based on the 1st order model shown in
(6.4). The modiﬁed taught data method is based on the 2nd order model can
be also regarded as the phase-lead compensator.
6.1.3 Experimental Veriﬁcation of the Modiﬁed Taught Data
Method
In order to verify the eﬀectiveness of the modiﬁed taught data method, an ex-
periment was made with the six-freedom-degree robot arm (Performer K10S;

134
6 The Modiﬁed Taught Data Method
10−2
100
102
−80
−60
−40
−20
0
−100
0
Angular frequency [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(a) Original system
10−2
100
102
−80
−60
−40
−20
0
−100
0
Angular frequency [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(b) Modiﬁed system
10−2
100
102
0
10
0
20
40
Angular frequency [rad/s]
Gain [dB]
Phase [deg]
Gain
Phase
(c) Modiﬁcation element
Fig. 6.5. Bode diagram of modiﬁed taught data method based on the 2nd order
model (Kp = 15[1/s], Kv = 60[1/s], γ1 = γ2 = −60[1/s], µ = −120[1/s])
please refer to the experiment instrumentation E.3). The position loop gain of
the Performer and its velocity loop gain are Kp = 15[1/s] and Kv = 60[1/s],
respectively. The torque limitation is Tmax = 1.0[Nm] with a velocity limita-
tion of the servo motor Vmax = 1[m/s], and the coeﬃcient of transformation
from acceleration to torque is C = 5.3 × 10−3[kgm]. Installing the pen at
the tip of the robot arm, an experiment has been made with drawing the
two-dimensional trajectory at the robot arm.
The method of generation of the revised taught data is that, ﬁrstly, the
revised taught data u(t) was calculated with the solution of the diﬀerential
equation based on the 1st order model (6.7) and the diﬀerential equation
based on the 2nd order model (6.25). In the solution of the diﬀerential equa-
tion, the Euler method was used. The taught position was derived from the
sampled taught data u(t) with a time interval of 20[ms]. Additionally, the

6.2 Modiﬁed Taught Data Method Using a Gaussian Network
135
taught velocity was calculated by taking the discreteness of the continuous
taught position.
Fig. 6.6 shows the experimental result. The objective trajectory is as the
left top part of Fig. 6.6 which contains three line segments and two angles.
The velocity of the objective trajectory is 250[mm/s]. Fig. 6.6 shows the ex-
perimental results with three methods. The poles of the regulator and the
observer were γ = −60[1/s] based on the 1st order model and γ1 = −60[1/s],
γ2 = −60[1/s], µ = −120[1/s] based on the 2nd order model in the computer
simulation.
In the following locus shown in Fig. (a) used in the conventional method,
there was the movement delay of the robot arm at the angle. In the following
locus using the modiﬁed taught data method based on the 1st order model
as Fig. (b) or the 2nd order model as Fig. (c), the delay of the robot arm
has been properly compensated and traced the angles correctly. However, the
overshoot can be found in the results based on the 1st order model. In the
contour control of the mechatronic servo system, this kind of overshoot should
be avoided (refer to the 1.1.2 item 3). Therefore, from the results based on
the 2nd order model, the overshoot has disappeared and the following locus
was identical with the original objective locus. The reasons for generating an
overshoot in the results based on the 1st order model, are that the modeling
error cannot be neglected when the robot arm was modeled by the 1st order
model with the objective velocity 250[mm/s].
Comparing the surface area of the errors between the objective locus and
the following locus, in the conventional method is 136[mm2], in the modiﬁed
taught data method based on the 1st order model is 60[mm2], and in the
modiﬁed taught data method based on the 2nd order model is 40[mm2]. From
these results, the eﬀectiveness of the modiﬁed taught data method was veriﬁed.
6.2 Modiﬁed Taught Data Method Using a Gaussian
Network
In the modiﬁed taught data method based on the model in the previous sec-
tion, the servo parameters Kp, Kv in the model are necessary to be correctly
identiﬁed in advance.
In the modiﬁed taught data method based on one type of neural network,
the Gaussian network, and the information of the movement with the test
pattern, the identiﬁcation of the mechatronic servo system can be realized by
the Gaussian network as equation (6.46). The revision by taught data based
on this kind of Gaussian network can be also conducted.
Although the role of the taught data revision is the same as the method
based on the model in the former section, the merit of this method based
on the Gaussian network is that the characteristics of the mechatronic servo
system need not be known in advance.

136
6 The Modiﬁed Taught Data Method
(a) Conventional method
(b) Modiﬁed taught data method based on the 1st order model
(c) Modiﬁed taught data method based on the 2nd order model
Fig. 6.6. Experimental results by using industrial robot. The left ﬁgures are about
taught data and the right ﬁgures are following locus.

6.2 Modiﬁed Taught Data Method Using a Gaussian Network
137
6.2.1 Derivation of Modiﬁed Taught Data Method Using a
Gaussian Network
(1) Principle of the Modiﬁed Taught Data Method
The modiﬁed taught data method is to compensate for the delay of the mecha-
tronic servo system by the taught data which is the input of the servo system
(refer to the 6.1.1). When revising the taught data and the modeling of the
servo system is correct, although the modiﬁcation element can be constructed
for revising the taught data based on the above model and it is possible to
obtain the high-precision contour control, it is diﬃcult to obtain the correct
general model and there are always many modeling errors in the equation
(6.45). Therefore, with neural networks and learning from the inverse system,
control performance can be improved. In this section, through using a Gaus-
sian network, the modiﬁcation element can be constructed by learning the
actual dynamics of servo system.
(2) A Mathematical Model of the Mechatronic Servo System
The mathematical model of a mechatronic servo system which is necessary
for the construction of the Gaussian network and determination of the initial
parameters will be introduced. As the mathematical model of mathematic
servo system, the 2nd order model which approximates the actual servo system
until the velocity loop is adopted (refer to 2.2.4). The equation of the 2nd order
model is shown as
d2y(t)
dt2
= −Kv
dy(t)
dt
−KpKvy(t) + KpKvu(t)
(6.44)
where u(t) denotes the position input to the servo system, y(t) denotes the
position output to the servo system and Kp, Kv have the meaning of Kp2,
Kv2 of the middle speed 2nd order model as in equation (2.29) in section
2.2.4, respectively. Also, the construction of the inverse dynamics of the servo
system by the Gaussian network is based on the inverse solution of equation
(6.44) with y(t) = r(t), which r(t) denotes the objective trajectory
u(t) = r(t) + 1
Kp
dr(t)
dt
+
1
KvKp
d2r(t)
dt2 .
(6.45)
This mathematical model expresses the characteristics of the servo system.
However, the real parameters have the diﬀerence with the setting values for
products. Also, the nonlinear terms which cannot be expressed by the 2nd
order model exist in the dynamics. Therefore, the modeling error is assumed
to exist in the inverse dynamics of equation (6.45), and the learning from the
inverse dynamics of the servo system by the Gaussian network will conduct.

138
6 The Modiﬁed Taught Data Method
(3) Construction of Inverse Dynamics by the Gaussian Network
(i) Gaussian network
The Gaussian network is a type of neural network whose units use a Gaussian
function (Gaussian unit)[30]. As the characteristics of the Gaussian units, the
output of the units is toward the input around the mean. If the input leaves the
mean, the output of the unit approaches to 0. Though Gaussian units which
are the components of a general Gaussian network possess multiple inputs, in
order to simplify the structure, the part about the mutual correlation of the
Gaussian function in the Gaussian unit which is as one input, are all regarded
as zero, and one input and one output Gaussian unit is used.
In this section, the adopted Gaussian network is composed of multiple
units. From the following equation
φ(x) =
M
H
i=1
wiψi(xi)
(6.46)
each unit is the one input Gaussian unit
ψi(xi) = exp
$
−(xi −mi)2
2σ2
i
)
(6.47)
where x = (x1, · · · , xM) is the input of the network, φ(x) is the output of the
network, M is the number of units, wi is the weight of the ith unit, ψi(xi) is
the output of the ith unit, mi is the mean of the ith unit, and σi is the standard
deviation of the ith unit. According to the equation of the Gaussian network
(6.46), the inverse dynamics of the actual servo system can be constructed.
(ii) Determination of the structure
As shown in the Fig. 6.7, the adopted Gaussian network has three layers,
three input, six intermediate units and one output. In the structure shown
in Fig. 6.7, three inputs of the Gaussian network are realized by the six in-
termediate units x = (x1, · · · , x6) in which every two units have the same
input. The inputs of the network (r, dr/dt, d2r/dt2), in another word, are the
x1 = x2 = r, x3 = x4 = dr/dt, x5 = x6 = d2r/dt2. The ﬁrst item of the
right-hand side of the inverse dynamics equation (6.45) is approximated by
the ﬁrst and second units, the second item by the third and fourth units and
the third item by the ﬁfth and sixth units. The output of the Gaussian net-
work is regarded as the input of the servo system for the revised taught data.
In the Fig. 6.7, • denotes the Gaussian unit and ◦denotes the linear unit.
(iii) Determination of the initial parameter
In order to approximate the inverse dynamics of (6.45) by a Gaussian neu-
ral with the initial parameters, the initial parameters should be determined.

6.2 Modiﬁed Taught Data Method Using a Gaussian Network
139
In the determination of the initial parameters, the Gaussian network shown
in the Fig. 6.7 should be divided into three parts and the one-input, two-
intermediate-unit and one-output Gaussian network is considered. In this
Gaussian network, the symbols of the means of the two units are changed
as below in order to approximate the general linear function y = ax,
φ(x) = w exp
$
−(x −m)2
2σ2
)
−w exp
$
−(x + m)2
2σ2
)
.
(6.48)
Equation (6.48) is approximated by the one-order Taylor expansion,
φ(x) ≈2wm
σ2
exp
6
−m2
2σ2
=
x.
(6.49)
If the inclination of the linear function is as
a = 2wm
σ2
exp
6
−m2
2σ2
=
(6.50)
the linearization in the neighborhood of x = 0 can be realized. The variation
of the relationship between the standard deviation σ and the mean m can
be described in Fig. 6.8. With the results when the coeﬃcient which hung
on mean m is changed in each 0.01 and σ = 0.57m, φ(x) can approximate
the ax in the scale of x. In another words, the linear function y = ax can
be approximated when the parameters of the Gaussian network are as below
and the φ(x) of Gaussian network is linearized within the xmax, and equation
(6.50) and σ = 0.57m are used,
m = xmax, σ = 0.57xmax, w = 0.757axmax.
(6.51)
At this moment, the minimum of φ(x) is −0.755axmax with x = −xmax and
the maximum is 0.755axmax with x = xmax.
Using this relationship, the initial parameters of the whole three-inputs,
six-units and one-output Gaussian network can be give as
m1 = −m2 = xp
max
σ1 = σ2 = 0.57xp
max
w1 = w2 = 0.757xp
max
⎫
⎬
⎭
(6.52a)
w
w
w
w
w
w1
2
3
4
5
6
φ
r
dr
dt
d  r
dt
2
2
Fig. 6.7. Structure of Gaussian network

140
6 The Modiﬁed Taught Data Method
00
x
xmax
−xmax
σ=0.45m
σ=0.57m
σ=m
φ(x)
ax
Fig. 6.8. Determination of initial parameters of Gaussian network
m3 = −m4 = xv
max
σ3 = σ4 = 0.57xv
max
w3 = w4 = 0.757xv
max
Kp
⎫
⎪
⎪
⎬
⎪
⎪
⎭
(6.52b)
m5 = −m6 = xa
max
σ5 = σ6 = 0.57xa
max
w5 = w6 = 0.757xa
max
KpKv
⎫
⎪
⎪
⎬
⎪
⎪
⎭
(6.52c)
the inverse dynamics in equation (6.45) can be appropriately approximated by
the initial parameters of the Gaussian network. where xp
max, xv
max, xa
max in the
equation (6.52) denote the detail variables of the parameters xmax designed
by linearizable regions for the position, velocity and acceleration, respectively.
Like this, even the input signal of the Gaussian network has a big error over the
input scale of the servo system, the safety of the instrument can be guaranteed
because the output of the Gaussain network can be changed into 0 owing to
using a Gaussian network when designing the modiﬁcation elements.
(iv) Learning algorithm
Through the Gaussian network with the initial parameters, the inverse dy-
namics expressed in equation (6.45) can be approximated. However, since the
modeling error exists in the mathematical model of the servo system expressed
with the general equation (6.44), there exist errors in the inverse dynamics
given by equation (6.45). In order to reduce the errors of this modeling error,
the learning of Gaussian network should be preformed using the teaching sig-
nal from the experimental results when the servo system was actually moved.
The loss function during the learning of Gaussian network is as
Erms =
F
G
G
E 2
L
L
H
l=1
El
(6.53)

6.2 Modiﬁed Taught Data Method Using a Gaussian Network
141
El = 1
2{ul −φ(xl)}2
(6.54)
where (ul, xl) = (ul, xl
1, · · · , xl
6) denotes the teaching signal during the learn-
ing of the Gaussian network and L denotes the number of the teaching signal.
In the learning of Gaussian network parameters, error back propagation
learning is used [31]. The variation of parameters pi = (wi, mi, σi), ∆pi =
(∆wi, ∆mi, ∆σi), i = 1, · · · , 6 with a learning rate η can be described as
pnew
i
= pold
i
+ η∆pi,
i = 1, · · · , 6
(6.55)
∆wi = −∂El
∂wi
= {ul −φ(xl)}ψi(xl
i)
∆mi = −∂El
∂mi
= (xl
i −mi)
(σi)2
ψi(xl
i){ul −φ(xl)}wi
∆σi = −∂El
∂σi
= (xl
i −mi)2
(σi)3
ψi(xl
i){ul −φ(xl)}wi.
The learning process will stop when the loss function of equation (6.53) is
below the threshold. The learning of the Gaussian network can be expressed
by the functions in the structure of Fig. 6.7 for the whole parameters. With
the learning, the Gaussian network can learn from the inverse dynamics of
the real servo system. For example, according to the symbol of the input
of the servo system, the characteristics of the servo system will be changed.
Moreover, when the inclination a of linear function is changed according to
the positive or negative input, the nonlinear part which cannot be expressed
by the linear neural network can be realized.
(4) Utilization of the Gaussian Network
After learning, the Gaussian network is used for the modiﬁcation elements.
The Gaussian network cannot only express the inverse dynamics of the servo
system and provide the revised taught data by its output for the servo system,
but also the servo system moved by this taught data can expect that the
following trajectory approaches the objective trajectory. In the learning of
the inverse dynamics of the servo system by the Gaussian network, there is
no need to let the objective trajectory for producing the teaching signal is
same the objective trajectory in the actual operation. That is to say, after one
time learning of the Gaussian network for the inverse dynamics of the servo
system, the following trajectory can approach any objective trajectory when
using this Gaussian network for the modiﬁcation elements.

142
6 The Modiﬁed Taught Data Method
6.2.2 Experimental Veriﬁcation for Modiﬁed Taught Data Method
Using a Gaussian Network
(1) Conditions of the Experiment
In order to verify the eﬀectiveness of a Gaussian network based on the 2nd
order model shown in 6.2.1, the experiment of contour control using an XY
table was made (refer to the experiment instrument E.4). The control of the
XY table is constructed by two Gaussian networks in equation (6.46) for
independent axes in order to conduct the independent movement of the x axis
and the y axis, respectively. The experimental results will be shown when the
objective trajectory of the XY table is as
ux(t) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
4.8
(0 ≤t < 0.5)
4 cos
$π(t −0.5)
2
)
+ 4
5 cos
$5π(t −0.5)
2
)
(0.5 ≤t < 4.5)
4.8
(4.5 ≤t ≤5)
uy(t) =
⎧
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎩
0
(0 ≤t < 0.5)
4 sin
$π(t −0.5)
2
)
+ 4
5 sin
$5π(t −0.5)
2
)
(0.5 ≤t < 4.5)
0
(4.5 ≤t ≤5).
(2) Generation of the Teaching Signal
In the determination of the initial parameters of the Gaussian network, the
deﬁned value Kp = 5[1/s] of the position loop gain of the equipment in the
equation (6.52) was used, and the critical condition from Kv = 4Kp to Kv =
20[1/s] of the velocity loop gain used in the industrial ﬁeld, which cannot be
deﬁned directly, was used. This Kv which was not the value measured by the
actual device was considered to contain large errors. But the high-precision
contour control can be realized because in the proposed method the Gaussian
network for the modiﬁcation element was used and the inverse dynamics can
be constructed based on the learning from the actual equipment.
Besides, the linearizable region condition of the equipment was considered
as 15[cm] in the movable region of the table. The output scale of the two
Gaussian units about the position were set as −7.5 ≤φ(r) ≤7.5[cm] when
xp
max = 10[cm]. The maximal velocity of the equipment was considered as
9.3[cm/s]. The output scale of the two Gaussian units about velocity were set
as −11.325 ≤φ(dr/dt) ≤11.325[cm/s] when xv
max = 15[cm/s]. Concerning
the safety of the equipment, the output scale of the two Gaussian units about
acceleration were set as −60.4 ≤φ(d2r/dt2) ≤60.4[cm/s2] which was not over
the maximal acceleration of 84.7[cm/s2]. The teaching signal of learning for
the above Gaussian network with initial parameters came from the output

6.2 Modiﬁed Taught Data Method Using a Gaussian Network
143
−5
0
5
0
1
2
3
4
5
−5
0
5
Time[s]
y axis[cm]
Objective trajectory
Gaussian
Conventional
x axis[cm]
−5
0
5
−5
0
5
x[cm]
y[cm]
Gaussian
objective locus
Start point
Conventional
(a) Following trajectory
(b) Following locus
Fig. 6.9. Experimental results by using XY Table
data obtained by the computer when the properties of the servo system ex-
pressed in the movement can be given arbitrary and the XY table was moved
with the original objective trajectory in the experiment. The sampling time
interval is ∆tp = 10[ms] when making the teaching signal was the same as
that of the contour control experiment. Therefore, the teaching signals were
obtained as (ul, xl) = (u(l∆tp), y(l∆tp), y(l∆tp), dy(l∆tp)/dt, dy(l∆tp)/dt,
d2y(l∆tp)/dt2, d2y(l∆tp)/dt2), l = 0, · · ·, 500. However, the data obtained by
the computer from the actual XY table were only the velocity output dy/dt
of the techogenerator obtained from the servo motor. The position output y
was the numerical integral of the velocity output and the acceleration output
¨y was the numerical diﬀerential of the velocity output. Additionally, the ve-
locity output dy/dt of the techogenerator were the results whose noise have
been deleted by the band pass ﬁlter of 0 ∼10[Hz]. With the learning rate
of η = 0.001 during the Gaussian network learning, the learning process will
stop when the common threshold of the x axis and the y axis was below the
0.35[mm]. There were 182 learning times when the data set of the teaching
signal (ul, xl), l = 0, · · · , 500 was regarded as one time learning.
(3) Experimental Results of the Contour Control
By using the Gaussian network shown in the Fig. 6.7 after learning, the ex-
perimental results of contour control with the input of the XY table using the
revised taught data revised by the Gaussian network were shown. Fig. 6.9(a)
shows the following trajectory of the experimental results in the Gaussian
network after learning. Fig. 6.9(b) shows the following locus in the XY plate.
Here, the objective trajectory without any revision was used in the conven-
tional method. Comparing with the conventional method without any revi-

144
6 The Modiﬁed Taught Data Method
sion, the following trajectory was regarded as the following locus was clearly
approaching the objective when using the Gaussian network to realize the
revision. Therefore, the high-precision control can be realized.
6.3 A Modiﬁed Taught Data Method for a Flexible
Mechanism
When the movement of the robot arm becomes faster, the ﬂexible mechanism
of the robot arm is necessary for the ﬂexibility of the manipulator and ﬂexible
connection of the link. If neglecting the characteristics of ﬂexibility, oscillation
or overshoot in the movement of the robot arm will occur. The contour control
performance will deteriorate and the determination time of the position will
increase.
According to the ﬂexible mechanism, the mathematical model is made.
Based on this equation, the taught data modiﬁcation element of the former
section is constructed. The high-precision contour control can be realized in
the robot manipulator of the ﬂexible mechanism.
Then, the requirement of a high-speed, high-precision movement of a ma-
nipulator in industry, the proposed technique as the control method which
can bring the current system into maximal eﬀect is very important without
huge change of hardware in the current system.
6.3.1 Derivation of Contour Control with Oscillation Restraint
Using the Modiﬁed Taught Data Method
In order to realize contour control with oscillation restraint in the movement of
the ﬂexible arm, the block diagram of the control system in the one axis ﬂexible
arm shown in 6.10 is considered. In the Fig. 6.10, R(s) denotes the objective
trajectory, Z(s) denotes the position of the arm fulcrum, Y (s) denotes the
output (tip position of the arm), Kp denotes the position loop gain. The
modiﬁed taught data method (refer to 6.1.1) is adopted with the modiﬁcation
element F3(s) for constructing the taught data revised from the objective
trajectory of arm. In this section, although only one axis is considered, the
realization of control with oscillation restraint for one axis can also be adapted
for the multi-axis mechatronic servo system.
The dynamics of the servo system which causes the movement of the arm
is expressed by the 1st order model (refer to the 2.2.3). The ﬂexible arm of the
elasticity body is expressed by the 2nd order system, where ζL denotes the
damping factor and ωL denotes the natural angular frequency. Therefore, the
whole transfer function of the control system of this ﬂexible arm is expressed
as

6.3 A Modiﬁed Taught Data Method for a Flexible Mechanism
145
G3(s) =
a0
s3 + a2s2 + a1s + a0
(6.56)
a0 = Kpω2
L
a1 = ω2
L + 2ζLωLKp
a2 = Kp + 2ζLωL.
In the modiﬁed taught data method, the modiﬁcation element F3(s) is
derived using the pole assignment regulator and the minimum order observer
for the control system to solve the characteristics of the closed-loop system
and transfer it to the open-loop system whose relationship of the input and
output is equivalent to the transfer function of the closed-loop system. For
the control system of equation (6.57), the modiﬁcation element is as
F3(s) =
b5s5 + b4s4 + b3s3 + b2s2 + b1s + b0
(s −γ1)(s −γ2)(s −γ3)(s −µ1)(s −µ2)
(6.57)
b0 = a0(h0 −g0)
b1 = a0(h1 −g1) + a1(h0 −g0)
b2 = a0(1 −g2) + a1(h1 −g1) + a0(h0 −g0)
b3 = a1(1 −g2) + a2(h1 −g1) + h0 −g0
b4 = a2(1 −g2) + h1 −g1
b5 = 1 −g2
g0 = l2f1 + (l1l2 + k2)f2 + (l2
2 + l1k2 −l2k1)f3
g1 = l1f1 + (l2
1 + k1)f2 + (l1l2 + k2)f3
g2 = f1 + l1f2 + l2f3
h0 = l2 −a0f2 −a0l1f3
h1 = l1 −a0f3
l1 = −(µ1 + µ2)
l2 = µ1µ2
k1 = −l2
1 + l2 −a1 + a2l1
k2 = −l1l2 −a0 + a2l2
-
Kp
+
1-
s
F (s)
L
ω
L
ω
L
ω
s  +          s +
2
2
2
2ζ
Objective
trajectory
R(s)
Motor output
Z(s)
Following trajectory
Y(s)
Taught data
U(s)
3
Servo controller and motor
Flexible arm
Fig. 6.10. Block diagram of modiﬁed taught data method for ﬂexible arm

146
6 The Modiﬁed Taught Data Method
f1 = −(d1 −a2d2 + (a2
2 −a1)d3 −a0 −a3
2 + 2a1a2)/a0
f2 = −(d2 −a2d3 −a1 + a2
2)/a0
f3 = −(d3 −a2)/a0
d1 = −γ1γ2γ3
d2 = γ1γ2 + γ2γ3 + γ3γ1
d3 = −(γ1 + γ2 + γ3).
In the equation (6.57), the modiﬁcation element expressed by the 1st order
transfer function for the rigid body system shown in 6.1.1 is expanded into
the ﬁfth-order modiﬁcation element including the observer. γ1, γ2, γ3 are the
poles of the regulator and µ1, µ2 are the poles of the minimal order observer.
From the taught data u(t) generated through the modiﬁcation element F3(s),
tracing correctly the objective trajectory without oscillation in the ﬂexible
arm can be realized.
6.3.2 Experimental Veriﬁcation of Oscillation Restraint Control
Using the Modiﬁed Taught Data Method
Through the experimental device of the ﬂexible arm which emphasizes the
arm elasticity characteristic of one axis of the mechatronic servo system, the
eﬀectiveness of the proposed method can be veriﬁed. With the metal plate in
the ﬂexible arm, the bottom edge of this ﬂexible arm is installed in the base
seat of the drive device which consists of combinations with a DC servo motor
and the ball screw. The control purpose is to make the ﬂexible arm correspond
to the objective trajectory without the oscillation from the static state of the
base seat to another static state after moving to the objective position. The
size of the metal board is as follows, the length is 0.83[m], width is 0.028[m]
and height is 0.002[m]. The mass is 351[g], the elasticity coeﬃcient is K =
73785.2[g/s2], the viscous frictional coeﬃcient is DL = 3.626[g/s], the natural
angular frequency is ωL = 14.5[Hz], the damping factor is ζL = 3.56 × 10−4,
and the position loop gain is Kp = 15[1/s]. The objective trajectory is the
moving trajectory with the velocity of 0.03[m/s]. The design parameters in
the equation (6.57) are the poles of the regulator γ = −10 (three-fold root)
and the poles of the observer γ = −20 (two-fold root).
Fig. 6.11 shows the experimental results of the proposed method with the
equivalent velocity movement with 0.03[m/s] of the base seat. The horizontal
axis of the graph is time and the vertical axis is the oscillation in the center
of gravity of ﬂexible arm. From the results of the oscillation in the Fig. (a)
with the modiﬁed taught data method of the proposed method, the maximal
amplitude is 0.45[mm]. The maximal value of the oscillation in the results
of the equivalent velocity movement in Fig. (b) is 2.0[mm]. Comparing with
one another, the amplitude of oscillation in the center of gravity of the arm
is reduced to the 1/4. The left oscillation is from the modeling error which
cannot be generated in the ideal simulation results.

6.3 A Modiﬁed Taught Data Method for a Flexible Mechanism
147
0
5
10
15
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
Time[s]
Center of gravity[cm]
(a) Modiﬁed taught data method
0
5
10
15
−0.3
−0.2
−0.1
0
0.1
0.2
0.3
Time[s]
Center of gravity[cm]
(b) Uniform velocity movement
Fig. 6.11. Experimental result
The adaptiveness possibility of the modeling error of the modiﬁed taught
data method was investigated. With the simulation, the scale of the oscillation
arm when the design error is put in the damping factor ζL or the natural
angular frequency ωL was calculated. When the size of the oscillation of the
arm with the put design error was within the allowance of modeling error in
order to let it below 10[%] of the maximal oscillation without design error,
and the natural angular frequency ωL is −4.1 ∼2.8[%], then the size of the
oscillation became −100 ∼3549[%] in the damping factor ζL.

7
Master-Slave Synchronous Positioning Control
When one robot manipulator has many links and each of them corresponds
to one axis of the motor, it is very important to realize the synchronous po-
sitioning of each axis in the high-precision contour control. In this chapter,
we propose a new high-precision contour control not subject to the restriction
of the current conditions. It is adapted for the master-slave synchronous po-
sitioning control, which supposes one axis as the master-axis and another as
the slave-axis without a large characteristic value Kp of the servo system.
7.1 The Master-Slave Synchronous Positioning Control
Method
The typical applications which requires synchronous movement based on the
relationship between the master axis and the slave axis are tapping process
work, installing tapping tools in the rotated master axis and processing screw
by an up and down movement of master axis (sending) with rotation, and so
on. Since the process speciﬁcation of the screw pitch of the product is regular,
if the rotations of the master axis and sending position are not synchronous,
the screw pitch will be changed, or tools will be broken an the extreme case.
The master-slave synchronous positioning method is to generate modiﬁca-
tion term of inverse dynamics for the servo system and with this modiﬁcation
term, the position output of the master axis is taken as the input signal of
the slave axis. If there mixed with disturbance in the master axis, from the
proposed method, the slave-axis synchronous positioning method can be im-
plemented properly.
The command of the servo system of each industrial robot axis is indepen-
dently given. The command of the slave axis is revised by software. Therefore,
since it is expected that the existing hardware is not changed and the desirable
synchronous positioning can be realized, the value of any industrial applica-
tion of this method is very high.
M. Nakamura et al.: Mechatronic Servo System Control, LNCIS 300, pp. 149–168, 2004.
Springer-Verlag Berlin Heidelberg 2004

150
7 Master-Slave Synchronous Positioning Control
7.1.1
Necessity of Master-Slave Synchronous Positioning Control
(1) Mathematical Model of the Objective of the Master-Slave
Synchronous Positioning Control
Concerning the control objective with the requirement of position synchro-
nization, the overall control system with the control equipment and the servo
system are almost all controlling master axes and slave axes independently.
For the actuator, many servo motors have been used. In order to use high-
performance device in the servo motors and their control equipments, the
property of velocity control of the servo motor is considered as a ﬁxed con-
stant when the processing speed is not very high and the property of the
position control is only considered (refer to 2.2.3). Therefore, the transfer
function of the servo system is expressed as
Px(s) =
Kpx
s(s + Kpx)Ux(s) +
1
s + Kpx
Dx(s)
(7.1a)
Py(s) =
Kpy
s(s + Kpy)Uy(s)
(7.1b)
where, the x axis is the master axis, the y axis is the slave axis, Px(s), Py(s) are
the positions of the x axis and the y axis, Ux(s), Uy(s) are the velocity input
reference of the x axis and the y axis, Kpx, Kpy have the meanings of Kp1 in
the equation (2.20) for the 1st order model written in the item 2.2.3 about the
x axis and the y axis. The disturbance, expressed as Dx(s), is only added in the
master axis, supposed in the tap processing. The ﬁrst item of equation (7.1a)
describes the relationship between the velocity input Ux(s) and the position
output of the x axis. The second item describes the relationship between
the disturbance Dx(s) inputing into the x axis and position output of the x
axis. The property of control system is described by Kpx, Kpy. Their values
are determined by the structure of the hardware. In addition, 1/s before the
servo system denotes the integral from the velocity input to the position input.
The control purpose of the master-slave synchronous positioning control is to
make the position output of the x axis and the y axis are synchronous, that
is, to make the following equation successfully
Py(s) = kcPx(s)
(7.2)
where kc is the proportional constant. If the position output of the x axis
and the y axis satisﬁes equation (7.2), the position synchronization can be
realized.
(2) Issues without Expectation of Position Synchronization
If the dynamics of the x axis and the y axis are not considered and the velocity
input Uy(s) of y axis is kc times of velocity input of the x axis, the position
output of the y axis is as

7.1 The Master-Slave Synchronous Positioning Control Method
151
Py(s) =
kcKpy
s(s + Kpy)Ux(s).
(7.3)
The position output error of the y axis to the x axis, from equation (7.1a)
and (7.3), is as
kcPx(s) −Py(s) =
kc(Kpx −Kpy)
(s + Kpx)(s + Kpy)Ux(s) +
kc
s + Kpx
Dx(s).
(7.4)
From equation (7.4), if there is no position synchronization, the position out-
put of the x axis and the position output of the y axis are not synchronous
because the position output error is not 0. Since the position loop gains of the
x axis and the y axis are diﬀerence, there exists a deviation of position output.
From this case, if we use velocity input reference of the x axis without change,
the synchronous action cannot be realized because the position loop gains of
the x axis and the y axis are not the same. In addition, without setting the
compensation of the y axis for the disturbance Dx(s) of the x axis is another
reason for synchronization.
7.1.2 Derivation and Property Analysis of the Master-Slave
Synchronous Positioning Control Method
(1) Derivation of the Master-Slave Synchronous Positioning
Control Method
In the former part, the problem that the kc times of velocity input reference
of the x axis is simply used as the velocity input reference of the y axis was in-
troduced. In order to make the position of the y axis synchronization with the
position of axis x, the velocity input reference of axis x is revised for compen-
sating the diﬀerent dynamics between axis x and axis y. If the velocity input
reference of axis y is performed like this, the position synchronization can be
realized. However, if performing a revision in the velocity input reference of
axis x is only for the velocity input reference of axis y, the compensation for
disturbance in axis x cannot be implemented and the high-precision position
synchronization cannot be realized. But if the position output of axis x is
feedback as the position input of y, the impact of a disturbance in the axis
x can be overcome by the feedback of the position output of axis x. If the
only feedback in the position output of axis x without any change, the syn-
chronization of axis x with the movement delay caused by the dynamics of
axis y cannot be realized. Therefore, by using the inverse dynamics of axis y
and revising the feedback signal of the position output of axis x, the position
synchronization can be realized. Namely, in order to change the dynamics of
axis y into 1, feedforward compensation is performed according to the inverse
dynamics of axis y.
In order to realize the above properties, the inverse dynamics of the 1st
order system of axis y Fs(s) can be constructed as

152
7 Master-Slave Synchronous Positioning Control
Fs(s) = s + Kpy
Kpy
.
(7.5)
The master-slave synchronous positioning control method, with the position
output of axis x as the position input of axis y, can be given according to
Fs(s), is shown. This master-slave synchronous positioning control method is
based on the prerequisite of diﬀerent dynamics between axis x and axis y. It
can be also used for compensation for any fatal eﬀects of disturbance Dx(s)
mixed into axis x. When feedback the position output of axis x, it is assumed
that there are no observational noises (In the mechatronic servo system, there
are no observational noise because of the position test by pulse measurement
in the encoder). Moreover, discussion is carried out with the assumption of
correctly modeling the dynamics of axis y in the following part. When a
modeling error exists, it is necessary to adjust correctly the value of Kpy
in equation (7.5) to minimize the modeling error. The block diagram of the
master-slave synchronous positioning control method is illustrated in Fig. 7.1.
(2) Property Analysis of the Master-Slave Synchronous
Positioning Control Method
The position output of axis y in the master-slave synchronous positioning
control method is as
Py(s) =
kcKpx
s(s + Kpx)Ux(s) +
kc
s + Kpx
Dx(s).
(7.6)
U (s)
F (s)
D (s)
-
K px
+
-
K py
+
++
k
1-
s
s
1-
s
1-
s
x
 x
P (s)
 x
P (s)
 y
c
X axis servo system
Servo controller
Motor and
mechanism
part
Position loop
Modification
element
Y axis servo system
Servo controller
Motor and
mechanism
part
Position loop
Fig. 7.1. Block diagram of master-slave synchronous positioning control method

7.1 The Master-Slave Synchronous Positioning Control Method
153
Comparing equation (7.1a) and (7.6), the relationship of the position output
between axis x and axis y is as
kcPx(s) −Py(s) = 0.
(7.7)
It satisﬁes the condition of equation (7.2). Namely, axis y is synchronized on
position with axis x although the disturbance is input into axis x. However, it
is necessary to make the initial value synchronization in order to coordinate
with the time response for equation (7.7) in the frequency domain.
From the discussion of the realization of this method, it is necessary to
conﬁrm that the input of axis y after revision does not diverge when the mod-
iﬁcation element Fs(s) contains a diﬀerential. Therefore, the position input
signal of axis y should be calculated as
Fs(s)Px(s) = Kpx(s + Kpy)
Kpys(s + Kpx)Ux(s) +
s + Kpy
Kpy(s + Kpx)Dx(s).
(7.8)
In order to possess the common proper transfer function (the times of denom-
inator polynomial is bigger than that of molecule polynomial), the transfer
function of the position input Fs(s)Px(s) of axis y in connection with the
velocity input reference Ux(s) of axis x and disturbance Dx(s) in axis x is for
avoiding the divergence of the position input reference of axis y. Therefore,
there is no problem when using (7.6) as the modiﬁcation element Fs(s) and
the eﬀectiveness of the master-slave synchronous positioning control method
can be veriﬁed.
7.1.3 Experimental Test of the Master-Slave Synchronous
Positioning Control Method
By using the master-slave synchronous positioning control method, the eﬀec-
tiveness of the position synchronization of axis x and axis y can be veriﬁed
using computer simulation and an experiment by using XY table (refer to E.4
about experimental equipment). The conditions of the simulation and the ex-
periment are a position loop gain of axis x Kpx = 5[1/s], position loop gain of
axis y Kpy = 15[1/s], proportional constant kc = 1 and sampling time interval
∆tp = 0.02[s].
(1) Simulation of the Master-Slave Synchronous Positioning
Control
There are two kinds of supposed disturbances in the required equipment when
performing position synchronization. Concerning these disturbances, simula-
tion is made with (a) master-slave synchronous positioning control method,
(b) without expectation of position synchronization and (c) a tracking control
method between two servo systems [35]. The tracking control method between

154
7 Master-Slave Synchronous Positioning Control
two servo systems in (c) is the method used to compensate for the velocity
input of axis x by the position output feedback of axis x. The velocity input
contains the features of the ramp and the step. After cutting the screw and
returning to a trapezoidal wave as in Fig. 7.2, it is function as
ux(t) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
90t
(0 ≤t ≤0.6)
54
(0.6 < t ≤1.2)
−90t + 162
(1.2 < t ≤1.8)
0
(1.8 < t ≤2.0, 3.8 < t ≤4.0)
−90t + 180
(2.0 < t ≤2.6)
−54
(2.6 < t ≤3.2)
90t −342
(3.2 < t ≤3.8).
0
1
2
3
4
−50
0
50
Time[s]
ux(t) [mm/s]
Fig. 7.2. Input trajectory (trapezoidal wave)
(i)
Step disturbance
The step disturbance is generated when using the force with a step shape at the
moment of cutting the screw in the tab processing. Based on the simulation,
the step disturbance is as
dx(t) =
$ 0
(0 ≤t ≤0.5, 2.0 < t ≤4.0)
−5
(0.5 < t ≤2.0).
Its wave is shown in Fig. 7.3.
In order to compare the master-slave synchronous positioning control
method with step disturbance, the simulation results of the tracking control
method between the servo system without position synchronization is shown
in Fig. 7.4. From the left side, the locus of the XY table, time change of axis
x and y and trajectory error e(t) = px(t) −py(t) of axis x and axis y are
illustrated.
Fig. 7.4(b) illustrates the results without position synchronization for in-
creasing the response of axis y compared with that of axis x. In this case,
the maximal trajectory error is 8[mm] among the diﬀerent large position loop
gains of axis x and axis y as well as a diﬀerent response velocity. In addition,
for the big errors with diﬀerent position loop gains, it cannot be seen that

7.1 The Master-Slave Synchronous Positioning Control Method
155
0
1
2
3
4
−5
−4
−3
−2
−1
0
Time[s]
dx(t) [mm/s]
Fig. 7.3. Step disturbance
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t), py(t)
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(a) Master-slave synchronous positioning control method
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t)
py(t)
0
1
2
3
4
−5
0
5
Time[s]
e(t) [mm]
(b) Conventional method
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t), py(t)
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(c) Tracking control method between two servo system
Fig. 7.4. Simulation results on step disturbance
the impact of step disturbance input between 0∼2[s] from the graph of the
trajectory error (ampliﬁed with 25 times).
Comparing Fig. 7.4(a) and (c), two methods are making position synchro-
nization as long as looking the graph of locus and time change of the XY
table. Additionally, in the two methods, the impact of any step disturbance
input between 0∼2[s] shown in the trajectory errors is quite small at 0.1[mm]
in Fig. (a) compared with 0.25[mm] in Fig. (c). Moreover, the locus error

156
7 Master-Slave Synchronous Positioning Control
0
1
2
3
4
−5
−4
−3
−2
−1
0
Time[s]
dx(t) [mm/s]
Fig. 7.5. Disturbance wave with Saw tooth state cycle
out of the moment of mixing the step disturbance in Fig. (c) is bigger than
that of Fig. (a). Besides, in the situation without step disturbance between
2∼4[s], the trajectory error of 0.25[mm] in Fig. (c) is bigger than the 0.1[mm]
in Fig. (a). From the above comparisons, the eﬀectiveness of the master-slave
synchronous positioning control method is veriﬁed. The impact of a distur-
bance in master-slave synchronous positioning control method is due to the
diﬀerent operation in the computer for the controller for the diﬀerential of
inverse dynamics Fs(s) expressed in equation (7.6).
(ii) Saw-tooth-shape cycle disturbance
The saw-tooth-shape disturbance refers to the disturbance cyclically generated
by the processing edge hits whilst cutting the screw in tap processing. The
saw-tooth-shape cycle disturbance adopted in the simulation can be expressed
as
dx(t) =
⎧
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎨
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎪
⎩
0
(0 ≤t ≤0.18, 1.98 < t ≤2.00)
−5
$
1 + sin
625πt
9
=)
(0.36 < t ≤0.72, 1.08 < t ≤1.44, 1.80 < t ≤1.98)
−5
$
1 −sin
625πt
9
=)
(0.18 < t ≤0.36, 0.72 < t ≤1.08, 1.44 < t ≤1.80).
Its wave is shown in Fig. 7.5.
In order to compare it with the master-slave synchronous positioning con-
trol method with the saw-tooth-shape cycle disturbance, the simulation results
of the tracking control method between the servo system without position syn-
chronization is shown in Fig. 7.6. The trajectory error e(t) = px(t) −py(t) of
axis y to axis x is only shown, which is diﬀerent from the simulation results
with step disturbance.
Fig. (b) has almost the same results when existing step disturbance. From
the Fig. (c) and the results based on Fig. (a), axis y can be synchronized on
position with axis x when exhibiting the saw-tooth-shape cycle disturbance.
However, from the graph of trajectory error, there are two times of trajectory
error 0.3[mm] in Fig. (c) comparing with 0.15[mm] in Fig. (a) when con-
sidering the impact of the saw-tooth-shape cycle disturbance input between

7.1 The Master-Slave Synchronous Positioning Control Method
157
0∼2[s]. If there are no saw-tooth-shape cycle disturbances between 2∼4[s], the
results are consistent with the situation of step disturbance. Therefore, the
eﬀectiveness of the master-slave synchronous positioning control method was
veriﬁed.
(2) Experiment of Master-Slave Synchronous Positioning Control
In the former part, a simulation was made with a disturbance generated in
the computer and good results were obtained. Next, an experiment will be
made with the actual XY table. The experiment is carried out with two input
methods of disturbance Dx(s). One is with a disturbance generated in the
computer, i.e., disturbance is supposed to exist in the controller of the XY
table. The disturbance is put into the computer and it is generated considering
the various input possibilities of the actual equipment. Another one is that
the disturbance is put physically into the actual experiment equipment and
it is generated according to the actual situation of operation.
(i) In the case of putting the disturbance into the computer
With the same input command as the former part, an experiment is carried
out with the same conditions. Fig. 7.7 illustrates the experimental results
under the step disturbance with the master-slave synchronous positioning
control method and simulation results of the tracking control method between
two servo system without position synchronization. Fig. 7.8 illustrates the
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
0
1
2
3
4
−5
0
5
Time[s]
e(t) [mm]
(a) Master-slave synchronous
positioning control method
(b) Conventional method
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(c) Tracking control method between two servo systems
Fig. 7.6. Simulation results with saw tooth state cycle disturbance

158
7 Master-Slave Synchronous Positioning Control
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t), py(t)
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(a) Master-slave synchronous positioning control method
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t)
py(t)
0
1
2
3
4
−5
0
5
Time[s]
e(t) [mm]
(b) Conventional method
locus
trajectory
trajectory error
0
20
40
60
0
20
40
60
px(t) [mm]
py(t) [mm]
0
1
2
3
4
0
20
40
60
Time[s]
px(t), py(t) [mm]
px(t), py(t)
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(c) Tracking control method between two servo systems
Fig. 7.7. Experimental results of master-slave synchronous positioning control
method for the step disturbance based on XY table
experimental results with the saw-tooth-shape cycle disturbance under the
same conditions.
The whole simulation results and experimental results are consistent. How-
ever, from the trajectory error with the saw-tooth-shape cycle disturbance, the
saw-tooth-shape cycle disturbance can be shown in the simulation. But it can-
not be shown in the experiment. The reason is that the impact of quantization
error is almost unchanged in order to connect the A/D, D/A converter into
the controller between the XY table and the personal computer.
(ii) Disturbance input in the actual equipment
In order to approach the motion conditions adopted in the actual equipment,
an experiment, in which disturbance was directly added to the experiment
equipment, was carried out. In the XY table, the y axis is completely moved
along the direction of the x axis in order to make the y axis moving based
on the x axis. Therefore, it is only possible to put disturbance into the x

7.1 The Master-Slave Synchronous Positioning Control Method
159
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
0
1
2
3
4
−5
0
5
Time[s]
e(t) [mm]
(a) Master-slave synchronous
positioning control method
(b) Conventional method
0
1
2
3
4
−0.2
0
0.2
Time[s]
e(t) [mm]
(c) Tracking control method between two servo systems
Fig. 7.8. Simulation results for the saw tooth state cycle disturbance wave-like
based on XY table
axis because the force opposite to the movement of the x axis can be added
in the y axis. When the XY table is moving, a step disturbance is gener-
ated due to the external force added on the y axis of 700∼800[N] in the XY
axis. In the XY table, an experiment was carried out based on the tracking
control method between two servo systems and the master-slave synchronous
positioning control method. The input command is
ux(t) = 28.2
(0 ≤t ≤5).
When adding disturbance to the actual equipment, the experimental re-
sults based on the master-slave synchronous positioning control method and
tracking control method between two servo systems are illustrated in the
Fig. 7.9, respectively. The left-hands side illustrates the results of the XY table
locus, trajectory error e(t) = px(t) −py(t) of the y axis corresponding to the
x axis. From the locus of the XY table, position synchronization of the y axis
output in the x axis output can be realized based on both methods. However,
from the trajectory error graph, there appeared large errors about 0.6[mm]
after the beginning of the experiment the both methods. The reason is that
the feedback signal is not input during the initial step in order to discretely
approximate the diﬀerential of feedback signal of the x axis position output
for both methods. In Fig. 7.9(c), the error reduction is very slow after the be-
ginning of the experiment and the maximal error amplitude is 0.15[mm] after
dropping of the constant. But the amplitude of the constant error in Fig. (a)
is very small at 0.07[mm]. Therefore, the eﬀectiveness of the master-slave syn-

160
7 Master-Slave Synchronous Positioning Control
locus
trajectory error
0
100
0
100
px(t) [mm]
py(t) [mm]
0
1
2
3
4
5
0
0.2
0.4
0.6
Time[s]
e(t) [mm]
(a) Master-slave synchronous positioning control method
locus
trajectory error
0
100
0
100
px(t) [mm]
py(t) [mm]
0
1
2
3
4
5
0
0.2
0.4
0.6
Time[s]
e(t) [mm]
(c) Tracking control method between two servo systems
Fig. 7.9. Experimental results with actual disturbance based on XY table
chronous positioning control method when adding disturbance to the actual
equipment was veriﬁed.
7.2 Contour Control with Master-Slave Synchronous
Positioning
In the proposed master-slave position synchronization, there exists a large de-
viation in the following locus of objective locus at the corner of the trajectory
when using contour control for any objective trajectory.
In master-slave position synchronization, the response locus of the objec-
tive trajectory has a deviation because of the response delay to the objective
trajectory at the corner of the trajectory. Therefore, the following two control
methods added to the master-slave synchronous positioning control method
are proposed, namely, the method with command of extending the linear in-
terval before following a locus approximating the objective trajectory after
putting into objective trajectory of the position, and the method of high-
precision contour control with a little time synchronization at the corner.
The servo controllers of industrial mechatronic systems almost all control
each axis independently. In the proposed method, it is not necessary to change
the existing hardware and software, which provide commands, it is only nec-
essary to revise with simple deﬁnition of the master axis and the slave axis.

7.2 Contour Control with Master-Slave Synchronous Positioning
161
7.2.1 Derivation of the Contour Control Method with
Master-Slave Synchronous Positioning
(1) Deﬁnition of the Problem
The control objective is a kind of mechatronic systems which has a structure
with two axes like an XY table. The control purpose is to realize high-precision
contour control of a mechatronic servo system tracing an objective trajectory
even without strict property (Kp). Moreover, for the mechatronic servo system
with a deﬁned master axis and slave axis, if the problem for the maximal two
axes could be solved, it can be expanded to the multiple axes if the mecha-
tronic servo system with multiple axes also contains the same relationship
between the master axis and the slave axis. In the typical processing as tap,
since the impact of disturbance mixed into the control system on the slave
axis can be neglected comparing with that on the master axis in the direction
of rotation, therefore, a disturbance can be only mixed into the master axis.
In the contour control of the mechatronic servo system, the objective lo-
cus is approximated by diﬀerent lines (refer to 1.1.2 item 8). In the nth linear
interval, the velocity v is put into move from the objective point (xn, yn) as
original point to the n+1th objective point (xn+1, yn+1). If the control objec-
tive reaches the objective point (xn+1, yn+1), the same movement will begin
from this new original point. Such a kind of movement will stop until when
reaching the ﬁnal objective point. However, there exists a delay in the servo
system and the ﬁnal part of the line trajectory is lost because the position
output cannot reach the objective point even when the position input of the
objective locus reaching the objective point. Therefore, contour control for
the trajectory composed of the line trajectories will be separately considered
into a linear interval and a corner part.
(2) Control Method with a Linear Interval
In order to realize the correct contour control, it is necessary to make the
proportional relationship between the master-axis position output Px(s) and
the slave-axis position output Py(s). The control system with this relation
adapts the master-slave synchronous positioning control method introduced
in 7.1. In the master axis, the velocity input Ux(s) as standard is the input and
in the slave axis, the master-axis position output is regarded as the inverse
dynamics modiﬁcation element Fs(s) of the slave axis. The line between the
nth objective point (xn, yn) and the n+1 objective point (xn+1, yn+1) is given
after multiplying the coeﬃcient kc (region A in Fig. 7.10). This master-axis
position Px(s) and slave-axis position Py(s) is expressed according to the 1st
order model of the servo system as
Px(s) =
Kpx
s + Kpx
1
sUx(s) +
1
s + Kpx
Dx(s)
(7.9a)
Py(s) =
Kpy
s + Kpy
kcFs(s)Px(s)
(7.9b)

162
7 Master-Slave Synchronous Positioning Control
where Dx(s) denotes velocity disturbance. Kpx and Kpy have the meanings
of Kp1 in equation (2.20) in the low speed 1st order model of 2.2.3 about the
master axis and the slave axis, respectively. Moreover, Fs(s) is as the following
equation when using inverse dynamics based on the slave-axis feature.
Fs(s) = s + Kpy
Kpy
.
(7.10)
Therefore, in the contour control in this region, the master-axis position input
command is ux(t) = L−1{Ux(s)/s} and the slave-axis revised input command
is uy(t) = L−1{kcFs(s)Px(s)}. They are given to the servo system as the
command of each sampling time interval ∆tp.
(3) Control Method with the Corner Part
Since there is a response delay corresponding to the objective trajectory, the
response locus will be missed to the objective locus in the corner part. In
order to prevent locus deterioration due to such a miss, after the position
input reaching the objective point and at the moment of the following locus
reaching into the distance within the time of v∆tp from the objective point
(region B in Fig. 7.10), the control method (Fig. 7.1) on the linear interval
will be continued without a change of kc and the command time will be also
lasted. The input scale of extended command is within the radius of v∆tp
from objective point and until realizing position output. The reason is that
the advancing distance within one sampling time interval ∆tp with the given
objective tangent velocity v is v∆tp. When the following locus reaches within
v∆tp, in order to change the position input command into the next linear
interval position input, v is as the velocity introduced in 7.2.1(1) generally,
even generating locus deviation deterioration as Fig. 7.10. Since ∆tp is also
very small, the error is actually very slight. Moreover, proper v and ∆tp can
x axis
y axis
(xn, yn)
r
v∆t
Moving direction
Region A
Region B
Fig. 7.10. Contour control at the corner part

7.2 Contour Control with Master-Slave Synchronous Positioning
163
be previously worked out according to the allowable error. After the following
locus reaches the radius v∆tp of the objective point and based on Fig. 7.1,
the next control of the linear interval will be carried out with a command
for synchronization. The above proposal is the contour control method of
master-slave synchronous positioning.
7.2.2 Property Analysis and Evaluation of the Contour Control
Method with Master-Slave Synchronous Positioning
(1) Property Analysis of the Contour Control Method with
Master-Slave Synchronous Positioning
The eﬀectiveness of the contour control method of master-slave synchronous
positioning is evaluated according to the analytical solution using a mathemat-
ical model of equation (7.9a)∼(7.10). In the equation (7.9a), (7.9b), a inverse
Laplace transform (refer to appendix A.1) is conducted with Ux(s) = vx/s,
Dx(s) = dx/s as
px(t) = x(0)e−Kpxt +
6e−Kpxt −1
Kpx
+ t
=
vx + 1 −e−Kpxt
Kpx
dx
(7.11a)
py(t) = y(0)e−Kpyt + kcx(0)e−Kpxt + kc
6e−Kpxt −1
Kpx
+ t
=
vx
+ kc
1 −e−Kpxt
Kpx
dx
(7.11b)
where vx denotes the velocity of the x direction if the objective tangent ve-
locity is v. dx denotes disturbance.
Using equation (7.11a), (7.11b), locus error in the vertical direction of the
following locus corresponding to the objective locus in the contour control
method of the master-slave synchronous positioning can be calculated. Locus
error can be calculated according to |px(t) sin ϕ−py(t) cos ϕ| if angel between
the x axis and the objective locus is calculated with ϕ. Then it is put into
equation (7.11a), (7.11b). And here, proportional constant kc is changed as
tan ϕ by using ϕ, and based on the handling in the corner part with the
contour control method of master-slave synchronous positioning, the small
values of x(0), y(0) as initial values for the next interval can be approximated
to x(0) = y(0) = 0 because the following locus is made to approximate the
objective point. According to above procedure,
e(t) = |α(sin ϕ −tan ϕ cos ϕ)| = 0
(7.12)
in theory, the locus error will be 0 when mixed with any kinds of disturbances.
But there exist as
α =
6e−Kpxt −1
Kpx
+ t
=
vx + 1 −e−Kpxt
Kpx
dx.
(7.13)

164
7 Master-Slave Synchronous Positioning Control
Namely, if there are no modeling errors in the contour control method of
master-slave synchronous positioning and the slave axis is tracing correctly
the master axis at any time, it shows that the locus error of contour control
is 0.
(2) Property Analysis of the Modeling Error
In the contour control method of master-slave synchronous positioning, the
servo system is expressed by the 1st order model. The position synchronization
is carried out using its inverse dynamics equation (7.10). In fact, it is very diﬃ-
cult to make the property values Kpx, Kpy of each axis consistence completely
because of the variation of moment of inertial according to the mechanical
movement states and the variation of the spring constant. For example, Kpx,
Kpy are not consistent even thought that disturbance is not mixed. Therefore,
the deterioration occurred in the contour control performance of the contour
control method of the master-slave synchronous positioning because there ex-
ist modeling errors in the Kpy of the mathematical model. The deterioration
degree, i.e., robustness of this contour control method corresponding to the
modeling error Kpy, is discussed. When Kpy of the modiﬁcation element Fs(s)
is diﬀerent from ∆Kpy of the actual control objective, the relationship between
the proposed method and modeling error can be distinguished by investigating
the control performance of the master-slave synchronous positioning control
method. And here, the property is investigated when Kpy and ∆Kpy are dif-
ferent from the previous assumption of gain of the modiﬁcation element Fs(s)
and disturbance and the initial value is 0. the modiﬁcation element ˆFs(s) is
expressed if existing modeling error Kpy as
ˆFs(s) = s + Kpy + ∆Kpy
Kpy + ∆Kpy
.
(7.14)
The stationary term of locus error e(t) using equation (7.14) is expressed
as below when Fs(s) in equation (7.11a), (7.9b) are changed into ˆFs(s) and
deviated analytical solution py(t) is used.
e =
JJJJ
∆Kpy
K2py + Kpy∆Kpy
vx sin ϕ
JJJJ
(7.15)
where locus error e(t) is as e which is not changed depends on time t. This
equation (7.15) expresses the locus error of contour control when the adopted
contour control method of the master-slave synchronous positioning with mod-
eling error ∆Kpy.
If existing modeling error, the signiﬁcance of using the contour control
method of the master-slave synchronous positioning is evaluated according to
the comparison with contour control performance without complete position
synchronization. In the conventional method without position synchroniza-
tion, the locus error is expressed as below if Fs(s)Px(s) in equation (7.11a)

7.2 Contour Control with Master-Slave Synchronous Positioning
165
and (7.9b) is changed into Ux(s)/s and the stationary item can be calculated
if put into the analytical solution py(t)
e =
JJJJ
Kpx −Kpy
KpxKpy
vx sin ϕ
JJJJ .
(7.16)
This equation (7.16) is also about e which is not dependent on time t. If
∆Kpy in equation (7.15) is changed, the locus error will be adjusted in the
small scale comparing with the locus error in equation (7.16) of conventional
method. And here, Kpy = nxyKpx when carrying out analysis. The solution
of inequality of the conventional method and the contour control method of
master-slave synchronous positioning are as
(1 −nxy)Kpx ≤∆Kpy < ∞,
(2 ≤nxy)
(7.17a)
(1 −nxy)Kpx ≤∆Kpy < nxy(1 −nxy)
nxy −2
Kpx,
(1 < nxy < 2)
(7.17b)
nxy(1 −nxy)
nxy −2
Kpx < ∆Kpy < (1 −nxy)Kpx,
(0 < nxy < 1).
(7.17c)
When the x axis is the master axis and the y axis is the slave axis, generally,
in order to deﬁne the response property of the slave axis faster than that of
the master axis and Kpx ≤Kpy, the results in the scale of nxy ≥1 in equation
(7.17a), (7.17b) is very important.
In order to evaluate the appropriation, when these condition equations
are regarded as evaluation criteria of the contour control method of master-
slave synchronous positioning, a simulation of contour control is conducted.
With conditions of ∆tp=10[ms], v=10[mm/s], Kpx=5[1/s], the results with
ﬁve types of Kpy, 7, 10, 20, 30, 50[1/s], are illustrated in Fig. 7.11. The objec-
tive locus is performed (0, 0) →(20, 20) as the objective point. The horizontal
axis is the ratio Ry = (Kpy + ∆Kpy)/Kpy of modeling error corresponding
0.1
1
10
100
0
1
Ry=(Kpy+∆Kpy)/Kpy
Error e [mm]
nxy=Kpy / Kpx
1.0
1.4
2.0
4.0
6.0
10.0
4.0
6.0
10.0
Fig. 7.11. The relationship between the locus error e and the modeling error rate
Ry

166
7 Master-Slave Synchronous Positioning Control
to the actual value Kpy. The left vertical axis is the locus error e. The right
vertical axis is the ratio of nxy = Kpy/Kpx. In these ﬁgures, the dotted line
in the graph is the locus error of the contour control if there is no position
synchronization of the conventional method. If the locus error of the contour
control method of the master-slave synchronous positioning is under the dot-
ted line, the signiﬁcant of position synchronization can be judged even there
have been modeling errors. Furthermore, the eﬀective scale of the proposed
method can be shown in the scale of the horizontal axis Ry described by the
unbroken line in the graph.
From these results, the scale, when the locus error of contour control
method of master-slave synchronous positioning with Ry < 1 is bigger than
that of the conventional method, exists. Therefore, the proposed method is
eﬀective within the limit scale in which Ry > 1, nxy ≥2, and the locus error
is smaller than the conventional method with any ∆Kpy, and 1 < nxy < 2.
However, in fact, if the property of the servo system of the equipment is known
clearly, the modeling error of Kpy, in general, will be several percents to times
of percents. From the results of Fig. 7.11, the locus error is very slight when
Ry = 1 is equivalent to the actual modeling error. Based on the above analyt-
ical results of the modeling error and considering that the current state of the
actual modeling error, in fact, it is possible to adapt eﬀectively the contour
control with position synchronization of the contour control method of the
master-slave synchronous positioning.
7.2.3 Experimental Test of the Contour Control Method of
Master-Slave Synchronous Positioning
The experiment with the contour control method of master-slave synchronous
positioning was carried out using an actual XY table (refer to E.4 about exper-
iment equipment). The experimental conditions are, ∆tp=10[ms], v=3(about
1/23 rated speed)[mm/s], the position loop gains of the 1st order model are
Kpx=5[1/s] of master axis and Kpy=10[1/s] of the slave axis. The objective
trajectory, illustrated in Fig. 7.12, is moved from 1 at (0, 0) to 2 at →to 3 at
→to 4 at →to 1. The disturbances are put into as −5[mm/s] step between
3∼7 second at the region of 2→3 and as −1[mm/s] step between 3∼7 second
at the region of 3→4. Fig. 7.12(a) is about the conventional method by which
each axis is controlled independently. Fig. (b) is about the contour control
method of the master-slave synchronous positioning. Fig. (c) illustrates the
results of the contour control method of master-slave synchronous position-
ing when adding the modeling error ∆Kpy = 1[1/s]. The left graph shows
the locus if the horizontal axis is the position output of the x axis and the
vertical axis is the position output of the y axis. The right graph shows the
time change of the locus error. In Fig. (a), the error occurred with an aver-
age 0.1[mm] according to the diﬀerence of servo features among axis (Kpx=5,
Kpy=10) and also occurred due to disturbance inﬂuence. Thus, the following
locus cannot reach the ﬁnal objective point. In Fig. (b), in all regions, the

7.2 Contour Control with Master-Slave Synchronous Positioning
167
error is about 0.02[mm] if contour control is correctly performed because of
good position synchronization even in the part added with disturbance. In
addition, in the Fig. (c), the locus error is 0.03[mm] when the precision of
contour control is very high.
In order to use the diﬀerential of the modiﬁcation element of the contour
control method of master-slave synchronous positioning, the noise mixed into
the input signal of the slave axis should be considered. If making diﬀerential
(discrete) on a signal with much noise, the problem of amplitude increment
will be generated. If using pulse output of the encoder which is often applied in
the mechatronic servo system of the industrial ﬁeld, there will be no problem
on the discrete of master-axis output values. Even using the tachogenerator
output as position output and these values including the integral value of the
tachogenerator output, there are also no problems on their discrete. In the
current experiment, good results were obtained when using the tachogenerator
output.
Based on the proposed position synchronization contour control method,
good control performance can be veriﬁed not only by theoretical analysis but
also with experiment results.

168
7 Master-Slave Synchronous Positioning Control
0
20
40
60
0
20
40
60
x[mm]
y[mm]
Objective locus
Following locus
1
2
3
4
Step disturbance
Ramp disturbance
0
20
40
60
0
0.2
0.4
0.6
0.8
Time[s]
Error e(t) [mm]
1
2
3
4
1
(a) Conventional method
0
20
40
60
0
20
40
60
x[mm]
y[mm]
Objective locus
Following locus
1
2
3
4
Step disturbance
Ramp disturbance
0
20
40
60
0
0.2
0.4
0.6
0.8
Time[s]
Error e(t) [mm]
1
2
3
4
1
(b) Master-axis position synchronization (without modeling error)
0
20
40
60
0
20
40
60
x[mm]
y[mm]
Objective locus
Following locus
1
2
3
4
Step disturbance
Ramp disturbance
0
20
40
60
0
0.2
0.4
0.6
0.8
Time[s]
Error e(t) [mm]
1
2
3
4
1
(c) Master-axis position synchronization (with modeling error)
Fig. 7.12. Experimental results of contour control based on XY table

Glossary
A. Deﬁnition of device
axis: minimal unit of mechanism corresponding to one motor movement, such as
rotational axis, proceeding axis, etc., including control part of each motor in each
articulated part of robot arm.
current control part: control current ﬂowing in motor by current command of
motor and current sensor.
command part: generation part of position and velocity (trajectory) for the mecha-
tronic servo system movement driven by numerical input or taught data. (man-
agement part) reference input generation part.
reference input time interval: time interval of data alternation of objective tra-
jectory given from reference input generation part to position control part, also
called as system clock.
encoder resolution: position detector installed in motor axis, (using PPR: pulse
per resolution).
ﬂexible arm: spring factor included in deceleration part of robot arm is with low
rigid, robot arm is ﬂexibly structured, and it is needed in the ﬂexible body of
arm but not rigid. It is the name of arm with ﬂexible body.
management part: management of movement of robot arm, movement related
with surrounding devices (command of movement, emergence stop, etc. according
to operation procedure).
mechanism: construct the mechanic movement part of mechatronic servo system.
mechatronic servo system, mechatronic system: The overall title of servo
part of mechatronic machine composed by (management part) reference input
generator, position control part, velocity control part, current control part, power
ampliﬁer, motor and mechanism.
motor: drive mechanism transforming power into rotational movement and change
torque of rotational movement according to input current.
objective point: angle part when approximating linearly the given objective locus
in contour control.
position control system, servo, servo system: from position command of one
axis of mechatronic servo system, to position output of motor, including position
control part, velocity control part, current control part, power ampliﬁer part,
motor part and mechanism part.

170
Glossary
power ampliﬁer: ampliﬁer of providing power to motor according to current com-
mand, generally, using ampliﬁer with PWM (pulse width modulation) pattern.
position control part: control motor position by given position information of
motor and observer value, generally, used for ratio control.
reduction ratio: ratio of input rotation times, of decelerator connecting motor and
mechanism part, and output rotation times.
reference input generator: compute something in each designated time interval
for position control of each link based on objective trajectory and put into position
control part.
sampling time: time interval till exporting torque (velocity) command, by observ-
ing state based on the (updated) data input when velocity control part (position
control part) is structured with digital controller, and necessary computing.
servo ampliﬁer: power ampliﬁer part providing output rated with input signal
(current control part).
servo controller: from position input of one axis of mechatronic servo system to
current input of motor, including (position control part,) velocity control part,
current control part and power ampliﬁer part.
servo parameters: parameters including in servo controller, such as Kp, Kv, etc.
torque resolution: determined from the motor current whose analogue current
command calculated in current control part is transformed by D/A transforma-
tion, and feedback into current control part is determined by A/D transformation
resolution to be driving force of motor.
velocity control part: control velocity of motor by velocity command of motor
and observer value, generally used for ratio integral control.
velocity control part: from velocity input of one axis of mechatronic servo system,
to velocity output of motor, including velocity control part, current control part,
power ampliﬁer and motor part.
B. Deﬁnition of control method
contouring control: control to realize trajectory of position output of mechatronic
servo system. In industrial application, the curve of objective locus is approxi-
mated by line and the tangential velocity is always constant.
full-closed loop: it is the control system structured by feedback system with the
information of each moveable tip or motion tip.
modiﬁed taught data method: method for improving the contour control perfor-
mance through the delay dynamics compensation of mechatronic servo system.
position control: for realizing position of mechatronic servo system without prob-
lems in the part of locus. It is called PTP(point to point).
semi-closed loop: it is not constructed by the feedback system with the information
of each moveable tip or motion tip, but by the information of servo actuator part.
synchronous position control: master and slave: realize synchronous position
control through the compensation of delay dynamics.
C. Deﬁnition of model
1st order model: model expressed by 1st order model of the overall mechatronic
servo system. In general, it can be adopted with the velocity below 1/20 motor
rated velocity.
2nd order model: model expressed by 2nd order system of the overall mechatronic
servo system. In general, it can be adopted with the velocity of 1/20∼1/5 motor
rated velocity.

Glossary
171
4th order model: model with the combination that motor rotation part and mech-
anism part of mechatronic servo system are expressed by two mass model, and
electric part of servo controller is expressed by 2nd order model.
centrifugal force: inertial force of object in rotational coordinate system. Namely,
assumed force of movement with acceleration faced to rotation center by taking
into account the halt balance.
coriolis force: act on the object moving in the rotational coordinate system and
the force being proportional with velocity.
linear dynamic model in joint coordinates: model constructed by linear ap-
proximation of dynamics of articulated robot arm independently in each coordi-
nate axis in joint coordinates.
linear dynamic model in working (cartesian) coordinates: model constructed
by linear approximation of dynamics of articulated robot arm independently in
each coordinate axis in cartesian (orthogonal) coordinate.
modeling error: error of modeling control object with the actual control object.
reduced order model: General title of 1st and 2nd order model of mechatronic
servo system.
two mass model: model constructed by connecting the system model, structured
by the mechanism driven using motor, with motor inertia moment and load inertia
moment with spring.
D. Deﬁnition of performance
locus: ﬁnal results of position of mechatronic servo system without concerning time
shift , and not time function.
locus error: error between objective locus and tracing locus, not time function.
locus error: phenomenon of error occurred in locus because of periodic ripple of
motor position.
trajectory: time shift of position of mechatronic servo system, and time function.
trajectory error: error between objective trajectory and tracing trajectory, time
function.
torque saturation: phenomenon can not be permitted in command that motor
torque output reaching the limitation of output about performance of current
control part or power ampliﬁer part.
velocity ripple: phenomenon of periodic ripple of motor velocity.

Nomenclature
The symbols of each chapter in this book are summarized.
2. Mathematical model of a mechatronic servo system
2.1 4th order model of one axis in a mechatronic servo system
Symbols Units
Meanings
u(t)
rad
angular input of motor
y(t)
rad
angular output of motor
JM
kgms2
inertial moment of motor
JL
kgms2
inertial moment of mechanism
DL
Nms
viscous coeﬃcient of mechanism part
KL
Nm
spring constant of mechanism part
ωL
rad/s
natural angular frequency of mechanism part
ζL
damping factor in mechanism part
TM
Nm
torque occurred in motor
TL
Nm
reaction force from mechanism part
NG
gear ratio
NL
moment ratio (JL/N2
GJM)
θM
rad
angular output of motor
θL
rad
angular output of mechanism part
Kp
1/s
position loop gain
Kv
1/s
velocity loop gain
JT
kgms2
total inertial moment of motor and mechanism part
Kg
v
velocity ampliﬁer gain
cp
normalized position loop gain
cv
normalized velocity loop gain

174
Nomenclature
2.2 Reduced order model of one axis in a mechatronic servo system
Symbols Units
Meanings
Gc1(s)
normalized low speed 1st order model
Gc2(s)
normalized middle speed 2nd order model
Kp1
1/s
position loop gain of low speed 1st order model
Kp2
1/s
position loop gain of middle speed 2nd order model
Kv2
1/s
velocity loop gain of middle speed 2nd order model
cp1
1/s
position loop gain of normalized low speed 1st order model
cp2
1/s
position loop gain of normalized middle speed 2nd order model
cv2
1/s
velocity loop gain of normalized 2nd order model
2.3 Linear model of the working coordinates of an articulated robot arm
Symbols Units
Meanings
θ1
rad
Angle of 1st axis
θ2
rad
angle of 2nd axis
px
m
position of X axis
py
m
position of Y axis
l1
m
length of 1st axis
l2
m
length of 2nd axis
∆T
s
reference input time interval
λ(t)
s
λ(t) = t + (eKpt −1)/Kp
ˆpx
m
position of X axis in working coordinate model
ˆpy
m
position of Y axis in working linear model
v1
rad/s
velocity of 1st axis
v2
rad/s
velocity of 2nd axis
vx
m/s
velocity of X axis
vy
m/s
velocity of Y axis
ϵx
m/s
error at the X direction of working linear model
ϵy
m/s
error at the Y direction of working linear model
v
m/s
objective velocity
3. Discrete time interval of a mechatronic servo system
3.1 Sampling time interval
Symbols Units
Meanings
G1(s)
transfer function of 1st order system
GL1(s)
transfer function of 1st order system with time delay
GP 1(s)
transfer function of 1st order system with time delay Pade ap-
proximation
f 0
c
Hz
Sampling frequency
L1
s
sum of required time from state sample of position loop to con-
trol input calculation and delay time in 0th order hold of control
input
fcP
Hz
cut-oﬀfrequency of transfer function of 1st order system with
time delay Pade approximation
fc1
Hz
cut-oﬀfrequency of transfer function of 1st order system
∆tp
s
sampling time interval
q1
q1 = qL1/∆tp
fs
Hz
fs = 1/∆tp

Nomenclature
175
3.2 Relation between reference input time interval and velocity ﬂuctuation
Symbols Units
Meanings
ps
1
1/s
pole of 2nd order model
ps
2
1/s
pole of 2nd order model
es
v
maximal constant velocity ﬂuctuation
et
v
maximal transient velocity ﬂuctuation
hr
0th order hold in reference input generator
up
position command
hp
0th order hold in position command part
uv
velocity command
r
objective trajectory
vref
objective velocity
npv
npv = Kv/Kp gain ratio
3.3 Relation between reference input time interval and locus irregularity
Symbols Units
Meanings
Kpx
1/s
position loop gain of x axis of 1st order model
Kpy
1/s
position loop gain of y axis of 1st order model
J
Jacobian matrix
pz
m
position of z axis
Kpz
1/s
position loop gain of z axis of 1st order model
4. Quantization error of a mechatronic servo system
4.1 Encoder resolution
Symbols Units
Meanings
∆N
rev/min
amplitude of velocity ﬂuctuation
fr
s
frequency of velocity ﬂuctuation
RE
pulse/rev
encoder resolution
Nmax
pulse/s
maximal velocity of servo motor
RN
RN = ∆N/Nmax velocity ﬂuctuation rate
Vref
pulse/s
command velocity

176
Nomenclature
4.2 Torque resolution
Symbols Units
Meanings
Pref
pulse
objective position
Es
p
pulse
position decision error
∆tv
s
sampling time interval of velocity loop
Td
s
time of angular velocity output below objective velocity
Tu
s
time of angular velocity output over objective velocity
Vd
pulse/s
velocity of angular velocity output below objective velocity
Vu
pulse/s
velocity of angular velocity output over objective velocity
Ed
pulse
maximal position deviation of angular velocity output below
objective velocity
Eu
pulse
maximal position deviation of angular velocity output over ob-
jective velocity
Tf
s
period of ﬂuctuation
Er
p
pulse
amplitude of position ﬂuctuation
Er
v
pulse/s
amplitude of velocity ﬂuctuation
Rp
pulse/s2
angular acceleration resolution upper boundary satisfying am-
plitude condition of position output error
Rv
pulse/s2
angular acceleration resolution upper boundary satisfying am-
plitude condition of angular velocity output error
RA
pulse/s2
angular acceleration resolution
RT
Nm
torque resolution
Tmax
Nm
maximal torque
B
bit
bit number corresponding to torque resolution
5. Torque saturation of a mechatronic servo system
5.1 Measurement method for the torque saturation property
Symbols Units
Meanings
a
m/s2
input acceleration
tM
s
moment of torque taking maximal output
sat(x)
saturation curve

Nomenclature
177
5.2 Contour control method with avoidance of torque saturation
Symbols Units
Meanings
Amax
m/s2
maximal acceleration
ϵ
m
working precision
V
m/s
command tangential velocity
rx(t)
m
objective trajectory at the direction of x axis
ry(t)
m
objective trajectory at the direction of y axis
wx(t)
m
input considering working precision at the direction of x axis
wy(t)
m
input considering working precision at the direction of y axis
ux(t)
m
revised input at the direction of x axis
uy(t)
m
revised input at the direction of y axis
rmin
m
rmin = V 2/Amaxpossible minimal radius of circular trajectory
of movement for maximal acceleration
r
m
circular radius satisfying working precision ϵ
Vm
m
Vm =
√
Amaxrvelocity satisfying maximal acceleration Amax
when drawing radius r
amax
m/s2
maximal angular acceleration
θc1
rad
angle with x axis of objective locus 1
θc2
rad
angle with x axis of objective locus
F(s)
modiﬁcation term
6. The modiﬁed taught data method
6.1 Modiﬁed taught data method using a mathematical model
Symbols Units
Meanings
r(t)
m
objective trajectory
G1(s)
transfer function of 1st order model
F1(s)
modiﬁcation term based on 1st order model
G2(s)
transfer function of 2nd order model
F2(s)
modiﬁcation term based on 2nd order model
ωc
rad/s
cut-oﬀfrequency
γ
1/s
pole of pole assignment regulator by 1st order model
Ks
feedback gain of pole assignment regulator
φm
rad
maximal phase-lead value of modiﬁcation term
ωm
rad
frequency of maximal phase-lead value of modiﬁcation term
γi
1/s
pole of pole assignment regulator by 2nd order model
µ
1/s
pole of observer by 2nd order model

178
Nomenclature
6.2 Modiﬁed taught data method by using a Gaussian network
Symbols Units
Meanings
φ(x)
output of Gaussian network
wi
weight of Gaussian network
ψi(xi)
Gaussian unit
M
number of Gaussian units
xi
input to Gaussian network
mi
mean of Gaussian unit
σi
Variance of Gaussian unit
xmax
linear approximation region of Gaussian network
xp
max
m
constant determining linear approximation region of position
xv
max
m/s
constant determining linear approximation region of velocity
xa
max
m/s2
constant determining linear approximation region of accelera-
tion
Erms
lose function of learning of Gaussian network
El
factors of lose function of learning of Gaussian network
(uk, xk)
taught data for learning of Gaussian network
K
number of taught data
p
parameter of Gaussian network
pnew
i
modiﬁed parameter of Gaussian network
pold
i
parameter of Gaussian network before modiﬁcation
η
learning rate of Gaussian network
6.3 Modiﬁed taught data method for a ﬂexible mechanism
Symbols Units
Meanings
R(s)
objective trajectory
U(s)
taught data
Z(s)
position of fulcrum of arm
Y (s)
output
G3(s)
overall transfer function of control system
F3(s)
modiﬁcation term
7. Master-slave synchronous positioning control
7.1 The master-slave synchronous positioning control method
Symbols Units
Meanings
kc
sloping ratio between two axes of objective trajectory
7.2 Contour control with master-slave synchronous positioning
Symbols Units
Meanings
vx
s
velocity input to master axis(x axis)
e
mm
locus error
ˆF(s)
modiﬁcation term if existing modeling error
Ry
Ry = (Kpy + ∆Kpy)/Kpycoeﬃcient for modeling error evalua-
tion

Experimental Equipments
The main experimental device using in the experiment of this book are illus-
trated.
E.1 DEC-1
DEC-1 (made by Yahata Electric Machinery Inc.) using in section 2.1,
2.2, 3.2, 3.3, 4.1, 5.1, 5.2 is shown in Fig.E.1. Its speciﬁcations are given in
table E.1. DEC-1 is composed of servo controller, servo motor, coupling as
mechanism part as well as load generator. This experimental device is made
from the DC servo motor and servo controller used actually in industry. It
is equivalent to the driving part or mechanism part adopted in each axis of
(a) Proﬁle (citation from catalogue)
Position
controller
PC
Velocity
controller
Servo
amplifier
Motor
Soft coupling
Mechanism
part
(load)
Servo controller 
(b) Outline structure
Fig. E.1. DEC-1

180
Experimental Equipments
Table E.1. Speciﬁcation of DEC-1
rated output of motor
kW
0.2
rated torque of motor
kgm
0.195
rated velocity of motor
rev/min
1000
inertia moment of motor axisJM
kgm2
0.00224
inertia moment of mechanism partJL
kgm2
0.00653
natural angle frequency of mechanism partωL rad/s
94.2
damping rate of mechanism partζL
0.002
encoder resolution
pulse/rev
2000
gear deceleration ratioNG
1
mechatronic servo system, such as industrial robot, working machine, etc.. If
the analysis or control problems of mechatronic servo system using this device
can be solved, it is possible to analyze the improvement of control performance
of the general industrial mechatronic servo system regulated for having similar
properties in each axis, and concrete its improvement strategy. Motor of DEC-
1 and load generator are connected by soft-coupling. In this experimental
device, velocity control part, current control part, power ampliﬁer part in
servo controller are structured by hardware analogue circuit. Position control
part is structured by software in computer. Therefore, velocity loop gain Kv
is needed to be changed with the regulation of changeable resistance. Position
loop gain Kp can be easily changed in software of computer.
E.2 Motoman
The proﬁle of Motoman (made by Yaskawa Inc.) used in section 2.3, 6.1
is shown in Fig.E.2 and its speciﬁcations are given in table E.2, respectively.
Motoman is an industrial articulated robot arm. Its transportable weigh is
from 3 to 150[kg]. It is classiﬁed from K3 to K150.
Most of industrial robot arms including Motoman are moved according
to the designated taught position series and their velocity. The robot arm
using teaching box is moved by taught position and hence its position must
be memorized. The taught velocity is given by key input in operation panel.
After given all position and velocity, robot arm will move when pushing play
key of operation panel.

E.4 XY Table
181
Fig. E.2. Proﬁle of Motoman (citation from catalogue)
Table E.2. Speciﬁcation of Motoman K10
(a) Overall speciﬁcation
degree of freedom
6
precision of repeated PTP control mm ±0.1
power capacity
kVA
8
transportable weigh
kg
10
body mass
kg
300
(b) Speciﬁcation of each axis
1 axis 2 axis 3 axis 4 axis 5 axis 6 axis
length of arm
mm
200
600
770
-
100
-
maximal velocity rad/s 2.09
2.09
2.09
4.59
4.59
6.98
E.3 Performer MK3S
The proﬁle of Performer MK3s (made by Yahata Electric Machinery Inc.)
used in section 5.2 is shown in Fig.E.3 and its speciﬁcation is given in table
E.3.
In order to be able to construct controller freely in Performer MK3S,
in the authors’ laboratory, velocity loop is constructed by hardware in servo
controller. Nevertheless, the position loop is rebuilt to be able to construct in
computer. Therefore, position loop gain can be set freely in computer.
E.4 XY Table
XY table (made by Yaskawa Inc.) used in section 6.2, 7.1, 7.2 is shown in
Fig. E.4 and its speciﬁcation is given in table E.4. XY table is the device used
for transferring knives of working machine because of its independent move-
ment of x axis and y axis according to the ball spring installed in two servo
motors, respectively. For making similar of XY table with Performer MK3S,
velocity loop is constructed by hardware in servo controller and position loop
is constructed in computer. Therefore, position loop gain can be set freely in
computer.

182
Experimental Equipments
Fig. E.3. Proﬁle of Performer MK3S (citation from catalogue)
Table E.3. Speciﬁcation of Performer MK3S
(a) Overall speciﬁcation
degree of freedom
5
driving properties
V/pulse
5.0[V]/(2048[pulse/rev]×3000[rpm]/60[s])
detection properties V/pulse
0.5[V]/(2048[pulse/rev]×1000[rpm]/60[s])
encoder resolution
pulse/rev
8192
transportable mass kg
2(maximal velocity), 3(low velocity)
body brief mass
kg
32
(b) Speciﬁcation of each axis
1 axis 2 axis 3 axis 4 axis 5 axis
length of arm
mm
135
250
215
100
-
output
W
80
80
80
30
30
rated torque
Nm
0.319 0.319 0.159 0.095 0.095
rated rotation number
rpm
2400
2400
3000
3000
3000
rated voltage
V
100
100
100
100
100
rated current
A
2.2
2.2
0.9
0.63
0.63
deceleration ratio
1/120 1/160 1/160 1/120 1/88
inertia moment of motor axis ×10−7Nms2
4.0
4.0
2.7
2.1
2.1
Table E.4. Speciﬁcation of XY table
rated output of motor kW
0.2
rated torque of motor
kgm 0.065
rated velocity of motor rpm 3000
spring pitch
mm
1.4

E.4 XY Table
183
(a) Proﬁle
PC
Servo
controller
Servo motor
X axis
Y axis
Servo motor
(b) Outline structure
Fig. E.4. XY table

Appendix
A.1 Laplace Transform and Inverse Laplace Transform
If there is a function f(t) on time t
1 ∞
0
f(t)e−stdt = L[f(t)] = F(s)
(A.1)
it is called as Laplace transform of f(t)[36] The inverse transform of equation (A.1)
f(t) = L−1{F(s)}
(A.2)
is called as inverse Laplace transform. In s domain, the inverse Laplace transform
of rational function F(s) is transformed by partial fraction factorization as
F(s) = N(s)
D(s) =
K1
s −s1 +
K2
s −s2 + · · · +
Ki
s −si + · · · +
Kn
s −sn
(A.3)
and the determination of its coeﬃcients are calculated by
Ki =
.
N(s)(s −si)
D(s)
0
s=si
.
(A.4)
Therefore, Laplace transform is as illustrated in table A.1.
Table A.1. Laplace transform table
f(t)
F(s)
f(t)
F(s)
δ(t)
1
te−σt
1/(s + σ)2
u(t)
1/s
sin ωt
ω/(s2 + ω2)
t
1/s2
cos ωt
s/(s2 + ω2)
t2/2
1/s3
e−σt sin ωt ω/((s + σ)2 + ω2)
e−σt
1/(s + σ)
e−σt cos ωt s/((s + σ)2 + ω2)

186
Appendix
Table A.2. Formula of Laplace transform
Linear
L[af(t)] = aF (s), L[f1(t) + f2(t)] = F1(s) + F2(s)
Diﬀerential
L [df(t)/dt] = sF (s) −f(+0)
Integral
L -2
f(t)dt/
= F(s)/s −2 +0
0
f(t)dt/s
Shift in t domain L[f(t −L)] = e−sLF(s)
Shift in s domain L[f(t)e−at] = F(s + a)
Final value
limt→∞f(t) = lims→0 sF (s)
Initial value
limt→0 f(t) = lims→∞sF (s)
Convolution
L[2 t
0 f1(τ)f2(t −τ)dt] = F1(s)F2(s)
A.2 Transition Response
If given input U(s) in the factors held in transfer function G(s), the output Y (s)
is calculated by
Y (s) = G(s)U(s)
(A.5)
By using inverse Laplace transform, the output y(t) is calculated by
y(t) = L−1[Y (s)] = L−1[G(s)U(s)]
(A.6)
This y(t) is called as transition response, namely transitional state before reaching
constant state [41] [36] The transition response of basic input, such as impulse re-
sponse U(s) = 1, step response U(s) = 1/s, ramp response U(s) = 1/s2, etc., can be
calculated by putting these basic inputs into (A.5) and calculating Y (s), and ﬁnally
can be obtained by inverse Laplace transform.
In this book, 1st order system
G(s) =
Kp
s + Kp
(A.7)
is always adopted and its impulse response, step response and ramp response re-
spectively are calculated as
g(t) = e−Kpt
(A.8)
f(t) = 1 −e−Kpt
(A.9)
h(t) = t −1
Kp (1 −e−Kpt).
(A.10)
For 2nd order system with two diﬀerent real roots
G(s) =
KpKv
s2 + Kvs + KpKv
(A.11)
the impulse response, step response and ramp response respectively are calculated
as

A.3 Pole Assignment Regulator
187
g(t) =
s1s2
s1 −s2 (es1t −es2t)
(A.12)
f(t) = 1 +
s2
s1 −s2 es1t +
s1
s2 −s1 es2t
(A.13)
h(t) = t −1
Kp +
s2
s1(s1 −s2)es1t +
s1
s2(s2 −s1)es2t
(A.14)
s1 = −Kv +
C
K2v −4KpKv
2
s2 = −Kv −
C
K2v −4KpKv
2
.
A.3 Pole Assignment Regulator
To control object expressed by state space
dx(t)
dt
= Ax(t) + bu(t)
(A.15)
the control input is selected as
u(t) = −fx(t)
(A.16)
and the control purpose x(t) →0 (t →∞) can be implemented with any initial
state x(0) = x0. From equation (A.15) and (A.16), the regulator for setting poles
(eigenvalue of A −bf) of closed-loop system is called as pole assignment regulator
[42].
1. Eigen-equation of A is
|sI −A| = sn + an−1sn−1 + · · · + a1s + a0
(A.17)
and conversion matrix for controllable canonical form is calculated
T = (b, Ab, · · · , An−1b)
⎛
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎜
⎝
a2 a3 a4 · · · an 1
a3 a4 · · · an
1
...
a4 · · · an
1
...
... an
1
...
an
1
...
1 · · · · · · · · · · · · 0
⎞
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎟
⎠
.
(A.18)
2. To pole µ1 ∼µn
(s −µ1)(s −µ2) · · · (s −µn) = sn + dn−1sn−1 + · · · + d1s + d0
(A.19)
is calculated.
3. Feedback gain f is calculated by
f = (d0 −a0, d1 −a1, · · · , dn−1 −an−1)T −1.
(A.20)

188
Appendix
A.4 Minimal Order Observer
When calculating state feedback (A.16), the state variable x(t) must be com-
pletely observed. However, the state variable actually can not be completely ob-
served. The possible observed variable is
y(t) = Cx(t).
(A.21)
At this time, the structure for estimating the state variable x(t) with observed value
y(t) and control input u(t) is called as observer [43]. The observer is implemented in
d!(t)
dt
= ˆA! + Ky(t) + ˆBu(t)
(A.22)
ˆx(t) = D!(t) + Hy(t)
(A.23)
by
1. select proper matrix W with (S ̸= 0) in
S =
.
C
W
0
.
(A.24)
2. Calculate
SAS−1 =
.
A11 A12
A21 A22
0
,
SB =
.
B1
B2
0
.
(A.25)
3. Consider the design parameter
ˆA = A22 −LA12
(A.26)
the eigenvalues of matrix L are γ1, γ2, · · · , γn−l, and the L can be determined
by the pole assignment regulator method.
4. Calculate
K = ˆA + A21 −LA11
(A.27)
ˆB = −LB1 + B2
(A.28)
D = S−1
.
0
In−l
0
(A.29)
H = S−1
.
Il
L
0
.
(A.30)

References
The papers included in this book and the literature referred by these
papers are summarized in terms of each chapter. The papers being base of
each chapter are indicated in parentheses. (in Japanese)
Chapter 2 [1][2][3]
[1] J. Zou, M. Nakamura, S. Goto and N. Kyura: Model Construction and Servo
Parameter Determination of Industrial Mechatronic Servo Systems Based on
Contour Control Performance, Journal of the Japan Society for Precision En-
gineering, vol. 64, no. 8, pp. 1158-1164, 1998. (in Japanese)
[2] S. Goto, M. Nakamura and N. Kyura: Reduced Order Model Conﬁguration of
Industrial Mechatronic Servo Systems and Its Signiﬁcance, Proceedings of the
17th SICE Kyushu Branch Annual Conference, 1998. (in Japanese)
[3] S. Goto, M. Nakamura and N. Kyura: Propriety of Linear Model of Servo Sys-
tem for Industrial Articulated Robot Arms and Evaluation of Its Linearization
Error, vol. 7, no. 3, pp. 103-112, 1994. (in Japanese)
[4] Y. Fujino and N. Kyura: Motion Control, Sangyo Tosho, pp. 85-117, 1996. (in
Japanese)
[5] K. Kuki, T. Murakami and K. Ohnishi: Vibration Control of a 2 Mass Resonant
System by the Resonance Ratio Control, Trans. of the Institute of Electrical
Engineers of Japan, vol. 113-D, no. 10, pp. 1162-1169, 1993. (in Japanese)
[6] Y. Hori: Introduction to Control of Torsional Vibration System, Proceedings of
the IEE of Japan Industrial Applications Society, S. 12-1, 1994. (in Japanese)
[7] S. Arimoto: Dynamics and Control of Robot, Asakura Shoten, 1990. (in
Japanese)
[8] Edited by Yaskawa Electric Co.: Basic of Servo Technology for Mechatronics,
pp. 12-25, Nikkan Kogyo Shimbun, 1986. (in Japanese)
[9] S. Takagi: Introduction of Analysis Revision 3, Iwanami Shoten, pp. 62-63,
1973. (in Japanese)
Chapter 3 [10][11][12][13][14]
[10] M. Nakamura, H. Koda and N. Kyura: Determination of Required Sampling
Rate for Sampling Control of Continuous Contour Control by Servo System,
Trans. of SICE, vol. 28, no. 5, pp. 649-651, 1992. (in Japanese)

190
References
[11] M. Nakamura, H. Koda and N. Kyura: Determination of Sampling Frequencies
for Sampling Control of Servo System with Multi-Samplers, Trans. of SICE,
vol. 29, no. 1, pp. 63-70, 1993. (in Japanese)
[12] N. Egashira, M. Nakamura and N. Kyura: Analysis of Locus Ripples at Every
Reference Input Time Interval in Mechatronic Servo Systems, Journal of the
Robotics Society of Japan, vol. 13, no. 8, pp. 1153-1159, 1995. (in Japanese)
[13] N. Egashira, M. Nakamura and N. Kyura: Analysis of Stational Velocity Ripples
at Each Reference Input Time Interval for Mechatronic Servo Systems, Journal
of the Robotics Society of Japan, vol. 16, no. 1, pp. 74-79, 1998. (in Japanese)
[14] N. Egashira, M. Nakamura and N. Kyura: Analysis for Transitional Velocity
Ripples of Mechatronic Servo Systems at Each Reference Input Time Interval,
Trans. of SICE, vol. 34, no. 10, pp. 1504-1506, 1998. (in Japanese)
[15] T. Mita: Design of Digital Control Systems with Operation Time, Journal of
SICE, vol. 22, no. 7, pp. 614-619, 1983. (in Japanese)
[16] T. Matsuo: Zeroes and Their Relevance to Control–IV –Relationship between
Zeros and Output Responses–, Journal of the SICE, vol. 29, no. 6, pp. 543-550,
1990. (in Japanese)
[17] N. Kyura: Servo Technology –Relationship between Position Loop and Velocity
Loop–, Nikkei Mechanical, vol. 226, no. 8, pp.135-140, 1986. (in Japanese)
[18] N. Sasaki: Software of Digital Servo, Kindai Tosho, pp.118-124, 1994. (in
Japanese)
Chapter 4 [19][20]
[19] S. Goto, M. Nakamura and N. Kyura: Relationship between Control Perfor-
mance and Encoder Resolution in Mechatronic Software Servo Systems, Pro-
ceedings of the 15th SICE Kyushu Branch Annual Conference, pp. 387-390,
1996. (in Japanese)
[20] S. Goto, M. Nakamura and N. Kyura: Determination Method of Torque Res-
olution in Software Servo Systems Based on the Requirement of Control Per-
formances, Trans. of the Institute of Electrical Engineers of Japan, vol. 114-C,
no. 7/8, pp. 783-788, 1994. (in Japanese)
Chapter 5 [21][22]
[21] M. Nakamura, H. Yoshino, S. Goto and N. Kyura: A Method for Measurement
of Torque Saturation Characteristic for Mechatronic Servo Systems, Proceed-
ings of the 14th SICE Kyushu Branch Annual Conference, pp. 355-358, 1995. (in
Japanese)
[22] S. Goto, M. Nakamura and N. Kyura: Trajectory Generation for Contour Con-
trol of Mechatronic Servo Systems Subjected to Torque Constraints, Proceed-
ings of the 1994 Korean Automatic Control Conference, IS-04-3, pp. 66-70,
1994.
Chapter 6 [23][24][25][26]
[23] S. Goto, M. Nakamura and N. Kyura: Method for Modifying Taught Data for
Accurate High Speed Positioning of Robot Arm, Trans. of SICE, vol. 27, no. 12,
pp. 1396-1404, 1991. (in Japanese)
[24] S. Goto, M. Nakamura and N. Kyura: A Modiﬁed Taught Data Method by
Using a Gaussian Network for Accurate Contour Control of Mechatronic Servo

References
191
Systems, Trans. of the Institute of Electric Engineers of Japan, vol. 115-C,
no. 1, pp. 111-116, 1995. (in Japanese)
[25] S. Goto, M. Nakamura and N. Kyura: Accurate Contour Control of Mechatronic
Servo Systems Using Gaussian Networks, IEEE Trans. Indust. Elect., vol. 43,
no. 4, pp. 469-476, 1996.
[26] M. Nakamura, K. Tsukahara, S. Goto and N. Kyura: Contour Control of Flex-
ible Manipulators by Use of Modiﬁed Taught Data Method, Trans. of SICE,
vol. 33, no. 2, pp. 143-144, 1997. (in Japanese)
[27] T. Katayama: Basic of Feedback Control, Asakura Shoten, pp. 62-64, 1987.
[28] S. M. Shinners: Modern Control System Theory and Application, Mas-
sachusetts : Addison-Wesley, pp. 286-289, 1972.
[29] M. Kawato: Adaptation and Learning for Autokinetic Control, Journal of the
Robotics Society of Japan, vol. 4, no. 2, pp. 184-193, 1986. (in Japanese)
[30] S. Lee and R. M. Kil: A Gaussian potential function network with hierarchically
self-organizing learning, Neural Networks, vol. 4, pp. 207-224, 1991.
[31] B. Widrow and M. A. Lehr: 30 years of adaptive neural network: perceptron,
madaline, and backpropagation, in C. Lau (Ed.), Neural Networks, New York,
IEEE Press, Part 2, pp. 27-53, 1992.
Chapter 7 [32][33][34]
[32] S. Goto, M. Nakamura, S. Oka and N. Kyura: A Method of Synchronous Po-
sition Control for Multi Servo Systems by Using Inverse Dynamics of Slave
Systems, Trans. of SICE, vol. 30, no. 6, pp. 669-676, 1994. (in Japanese)
[33] M. Nakamura, D. Hiyamizu, K. Nakamura and N. Kyura: A Method for Syn-
chronous Position Control of Mechatronic Servo System with Master-Slave
Axes by Use of Second Order Model, Trans. of SICE, vol. 33, no. 9, pp. 975-977,
1997. (in Japanese)
[34] M. Nakamura, D. Hiyamizu and N. Kyura: A Method for Precise Contour
Control of Mechatronic Servo System with Master-Slave Axes by Use of Syn-
chronous Position Control, Trans. of SICE, vol. 33, no. 4, pp. 274-279, 1997. (in
Japanese)
[35] N. Kyura and Y. Hiraga: A Method of Following Control between Two Servo
Systems, Bulletin of Japan Patent Oﬃce, Shou63-268011, 1988. (in Japanese)
Appendix
[36] N. Mizugami: Automatic Control, Asakura Shoten, pp. 23-41, 1968. (in
Japanese)
[37] H. Kogou and T. Mita: Basic of System Control, Jikkyo Shuppan, pp. 124-130,
1979. (in Japanese)

Index
0th order hold, 57, 60
1st order model, 123, 144, 161, 162, 164,
166
1st order servo, 132, 133
1st order system, 39, 54, 70, 73, 128
2nd order model, 125, 133, 137
2nd order system, 32, 60, 81, 86, 87, 144
4th order model, 17, 20
A/D conversion, 94
acceleration output, 101
acceleration saturation property, 101
actual maximum acceleration output,
104
actuator, 39
allowable error, 36, 163
amplitude of angular velocity output
deterioration, 93
amplitude of position ﬂuctuation, 92
amplitude of position output deteriora-
tion, 93
analogue, 53
analogue servo system, 80
angular acceleration resolution, 87, 89,
93
angular velocity ﬂuctuation, 90
approximation error, 42
axis resonance, 19
axis resonance ﬁlter, 19, 20
band pass ﬁlter, 143
bearing, 100
bit number, 94
Bode diagram, 130, 131
carrier frequency, 19
characteristic root , 25
characteristic roots equation, 56
chip mounter, 17
circle approximation, 109
clip, 99
closed-loop control system, 123
cogging torque, 69
complex conjugate root, 24
continuous oscillation, 23
contour control, 30
contour control method of master-slave
synchronous positioning, 160
control performance , 26
coordinate transform, 37
corner part, 162
Coulomb friction, 99
counter, 80
counter-electromotive force, 99
counter-electromotive force compensa-
tion, 99
current control part, 18, 19
current detector, 18
current feedback, 94
current interruption, 98
current loop, 20
current reference, 86, 98
cut-oﬀ frequency, 19, 53, 56, 130
cut-oﬀ frequency condition, 55, 56
D/A conversion, 94
D/A converter, 57, 69, 85, 86
damping factor, 22, 23, 144, 146, 147
dead time, 53, 57

194
Index
dead zone, 19
design of servo controller, 17
detection noise, 81
determination method of servo
parameter, 23
diﬀerence computation, 81
digital, 53
discrete time interval, 53
discretization, 57
disturbance, 150, 151
dynamics, 81, 121
empirical rule, 17
encoder, 19, 69, 80, 87
encoder resolution, 79, 82, 83
error back propagation learning, 141
extended command, 162
feedback gain, 124, 132
feedforward compensation, 151
feedforward control, 122, 132
ﬂexible arm, 144–146
ﬂexible mechanism, 144
ﬂuctuation of ramp response, 93
ﬂuctuation period, 92
follow, 30
following control, 129
following locus, 121
following trajectory, 122
fractional control, 62
frequency domain, 126, 130
friction, 19
friction torque, 100
gain property, 130
Gaussian function, 138
Gaussian unit, 138
gear ratio, 20, 39
impulse response, 103
industrial robot, 17
inertia matrix, 39
inertial moment, 20
inﬁnitesimal, 43
initial parameter, 138
initial value, 153, 163, 164
integral (I) action, 19, 98
integrator, 132
interference, 19
intermediate unit, 138
inverse dynamics, 122, 132, 137
inverse kinematics, 39
inverse system, 137
Jacobian matrix, 74
joint coordinate, 19, 37, 73
joint linearized model, 39
kinematics, 38
Laplace transform, 20
learning, 140, 141
learning rate, 141, 143
linear function, 139
linear interval, 160, 161
linear model, 101
linear region, 99
liniarizable region, 140
locus error, 72, 75, 163–166
locus irregularity, 69, 70, 73, 74
loss function, 140, 141
low pass ﬁlter, 81, 83
low speed 1st order model, 31
low speed operation, 35
management part, 18
master-axis, 149
master-slave synchronous positioning
control method, 149
mathematical model, 20
maximum acceleration, 116
maximum acceleration output, 104
maximum allowable current, 98
maximum phase, 131
maximum torque, 94, 129
maximum velocity, 30, 125
mean, 138
mechanism, 19, 30
mechanism part, 18, 100
mechatronic servo system, 17, 18
micro processor, 53
middle speed 2nd order model, 32
middle speed operation, 36
minimum order observer, 126
model construction, 17
model outputs error, 35
modeling error, 36, 135, 137, 140, 
164, 165

Index
195
modiﬁcation element, 121, 125, 144,
145, 153, 161
modiﬁed taught data method , 121
module robot, 62
moment of inertia, 23
motor axis equivalent inertial moment,
23
motor part, 18
natural angular frequency, 22, 144, 146
natural frequency, 19
NC machine tool, 17
Neumann series, 68
nonlinear coordinate transform, 19
nonlinear term, 137
nonlinear transform, 38
normal vector, 72
normalized 4th order model, 22, 23, 31
numerical diﬀerential, 143
numerical integral, 143
objective joint angle, 37
objective locus, 121
objective trajectory, 37, 39
observation noise, 152
oscillation, 23
overload current, 98
overshoot, 23
overshoot condition, 54
P control, 20, 86
Pade approximation, 56
parallel link, 39
phase characteristics, 130, 131
phase-lead compensation, 132
PI control, 86
PI controller, 19
playback, 121
pole, 124, 128
pole of observer, 127, 128, 132
pole of regulator, 124, 128
pole of servo system, 132
position control part, 18
position detector, 18
position ﬂuctuation, 90, 91
position loop, 62
position loop gain, 21, 31, 33
positioning control, 30
positioning error, 89, 93
positioning preciseness, 80, 88
positioning precision, 93
power ampliﬁer, 19, 86
power ampliﬁer part, 18
principal root, 24
proper, 122, 130, 132, 153
proportional constant, 150
pulse, 87
pulse counter, 19
pulse output, 80
pulse signal, 19
quantization error, 57, 86
quantization term, 87, 89
ramp input, 24, 30, 60
ramp response, 24, 31, 89
rated speed, 32, 39
rated torque, 98
reaction force, 20
real pole, 24
reduced order, 29
reduced order model, 29, 31
reference input generator, 18
reference input time interval, 40, 59, 69,
70, 75
resolution, 69, 80
resonance frequency of axis torsion, 19
response component, 24
rigid body system, 146
rigid connection , 22
rigid link, 38
robustness, 164
sampling control, 53, 57
sampling control system, 53
sampling frequency, 54, 56, 57
sampling time, 82
sampling time interval, 53, 54, 86
sampling time interval for velocity loop,
88
saturation region, 98, 105
saw tooth state cycle disturbance, 157,
159
self-organized robot, 62
semi-closed type control system, 122
sensor, 18
servo controller, 18–20
servo motor, 18
servo parameter, 22, 82

196
Index
servo theory, 132
slave-axis, 149
small interval, 39
software servo, 79
software servo system, 80, 81, 86
spring constant, 20, 22
squared integral, 31
standard deviation, 138
state-space representation, 123, 125
steady state, 70
steady-state error, 70
steady-state value, 88
steady-state velocity deviation, 24, 31,
32
steady-state velocity ﬂuctuation, 61
step disturbance, 154, 155
step-wise function, 71, 87
stick-slip, 69
structure, 138
tachogenerator, 57
tapping process work, 149
taught data, 121, 122
Taylor expansion, 42, 48, 74, 139
teaching playback robot, 122
teaching signal, 140, 141
theoretical acceleration output, 101
theoretical torque output, 103
time constant, 130
time domain, 129
torque, 21
torque command, 87
torque disturbance, 19
torque limitation, 129
torque of acceleration-deceleration, 99
torque quantization, 86, 87
torque quantization error, 88
torque resolution, 86, 93, 94
torque saturation , 97
torque saturation curve, 101, 104
torque saturation property , 100
total inertial moment, 22
tracking control method between two
servo systems, 153, 154
trajectory speed, 30
transient state, 70
transient velocity ﬂuctuation, 66
trapezoidal wave, 30
triangle inequality, 43, 48
two mass model, 20
undershoot, 56
unit, 138
unit step function, 71
unstable zero, 56
velocity ampliﬁer gain, 21
velocity control part, 18
velocity controller, 20
velocity detection ﬁlter, 20
velocity detector, 18, 80
velocity disturbance, 162
velocity feedback, 81, 82
velocity ﬂuctuation, 58, 62, 64, 82, 83
velocity ﬂuctuation amplitude, 92
velocity ﬂuctuation frequency, 83
velocity ﬂuctuation period, 83
velocity ﬂuctuation ratio, 83
velocity input reference, 150
velocity limitation, 125, 129
velocity loop, 19, 86, 126
velocity loop gain, 22, 33
velocity resolution, 82
velocity step input, 101
viscous friction, 99
viscous friction coeﬃcient, 20, 22
weight of unit, 138
wind-up phenomenon, 98
working coordinate, 19, 37, 73, 123
working linearizable approximation
possible region, 44
working linearized approximation error,
42–44
working linearized approximation
trajectory, 41
working linearized model, 37
working precision, 109
zero, 128, 133

