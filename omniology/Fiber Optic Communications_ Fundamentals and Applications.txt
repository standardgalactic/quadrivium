

FIBER OPTIC
COMMUNICATIONS


FIBER OPTIC
COMMUNICATIONS
FUNDAMENTALS AND APPLICATIONS
Shiva Kumar and M. Jamal Deen
Department of Electrical and Computer Engineering, McMaster University, Canada

This edition first published 2014
© 2014 John Wiley & Sons, Ltd
Registered office
John Wiley & Sons Ltd, The Atrium, Southern Gate, Chichester, West Sussex, PO19 8SQ, United Kingdom
For details of our global editorial offices, for customer services and for information about how to apply for permission to reuse the
copyright material in this book please see our website at www.wiley.com.
The right of the author to be identified as the author of this work has been asserted in accordance with the Copyright, Designs and
Patents Act 1988.
All rights reserved. No part of this publication may be reproduced, stored in a retrieval system, or transmitted, in any form or by any
means, electronic, mechanical, photocopying, recording or otherwise, except as permitted by the UK Copyright, Designs and Patents
Act 1988, without the prior permission of the publisher.
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may not be available in
electronic books.
Designations used by companies to distinguish their products are often claimed as trademarks. All brand names and product names
used in this book are trade names, service marks, trademarks or registered trademarks of their respective owners. The publisher is not
associated with any product or vendor mentioned in this book.
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in preparing this book, they make
no representations or warranties with respect to the accuracy or completeness of the contents of this book and specifically disclaim any
implied warranties of merchantability or fitness for a particular purpose. It is sold on the understanding that the publisher is not
engaged in rendering professional services and neither the publisher nor the author shall be liable for damages arising herefrom. If
professional advice or other expert assistance is required, the services of a competent professional should be sought
The advice and strategies contained herein may not be suitable for every situation. In view of ongoing research, equipment
modifications, changes in governmental regulations, and the constant flow of information relating to the use of experimental reagents,
equipment, and devices, the reader is urged to review and evaluate the information provided in the package insert or instructions for
each chemical, piece of equipment, reagent, or device for, among other things, any changes in the instructions or indication of usage
and for added warnings and precautions. The fact that an organization or Website is referred to in this work as a citation and/or a
potential source of further information does not mean that the author or the publisher endorses the information the organization or
Website may provide or recommendations it may make. Further, readers should be aware that Internet Websites listed in this work may
have changed or disappeared between when this work was written and when it is read. No warranty may be created or extended by any
promotional statements for this work. Neither the publisher nor the author shall be liable for any damages arising herefrom.
Library of Congress Cataloging-in-Publication Data
Kumar, Shiva, Dr.
Fiber optic communications : fundamentals and applications / Shiva Kumar and M. Jamal Deen.
pages cm
Includes bibliographical references and index.
ISBN 978-0-470-51867-0 (cloth)
1. Optical fiber communication. 2. Fiber optics. I. Deen, M. Jamal. II. Title.
TK5103.592.F52K816 2014
621.36′92–dc23
2013043803
A catalogue record for this book is available from the British Library.
ISBN: 9780470518670
Set in 10/12pt TimesLTStd by Laserwords Private Limited, Chennai, India
1
2014

MJD
To my late parents, Mohamed and Zabeeda Deen
SK
To my late parents, Saraswathi and Narasinga Rao


Contents
Preface
xv
Acknowledgments
xvii
1
Electromagnetics and Optics
1
1.1
Introduction
1
1.2
Coulomb’s Law and Electric Field Intensity
1
1.3
Ampere’s Law and Magnetic Field Intensity
3
1.4
Faraday’s Law
6
1.4.1
Meaning of Curl
7
1.4.2
Ampere’s Law in Differential Form
9
1.5
Maxwell’s Equations
9
1.5.1
Maxwell’s Equation in a Source-Free Region
10
1.5.2
Electromagnetic Wave
10
1.5.3
Free-Space Propagation
11
1.5.4
Propagation in a Dielectric Medium
12
1.6
1-Dimensional Wave Equation
12
1.6.1
1-Dimensional Plane Wave
15
1.6.2
Complex Notation
16
1.7
Power Flow and Poynting Vector
17
1.8
3-Dimensional Wave Equation
19
1.9
Reflection and Refraction
21
1.9.1
Refraction
22
1.10
Phase Velocity and Group Velocity
26
1.11
Polarization of Light
31
Exercises
31
Further Reading
34
References
34
2
Optical Fiber Transmission
35
2.1
Introduction
35
2.2
Fiber Structure
35
2.3
Ray Propagation in Fibers
36
2.3.1
Numerical Aperture
37

viii
Contents
2.3.2
Multi-Mode and Single-Mode Fibers
39
2.3.3
Dispersion in Multi-Mode Fibers
39
2.3.4
Graded-Index Multi-Mode Fibers
42
2.4
Modes of a Step-Index Optical Fiber*
44
2.4.1
Guided Modes
46
2.4.2
Mode Cutoff
51
2.4.3
Effective Index
52
2.4.4
2-Dimensional Planar Waveguide Analogy
53
2.4.5
Radiation Modes
54
2.4.6
Excitation of Guided Modes
55
2.5
Pulse Propagation in Single-Mode Fibers
57
2.5.1
Power and the dBm Unit
60
2.6
Comparison between Multi-Mode and Single-Mode Fibers
68
2.7
Single-Mode Fiber Design Considerations
68
2.7.1
Cutoff Wavelength
68
2.7.2
Fiber Loss
69
2.7.3
Fiber Dispersion
74
2.7.4
Dispersion Slope
76
2.7.5
Polarization Mode Dispersion
78
2.7.6
Spot Size
79
2.8
Dispersion-Compensating Fibers (DCFs)
79
2.9
Additional Examples
81
Exercises
89
Further Reading
91
References
91
3
Lasers
93
3.1
Introduction
93
3.2
Basic Concepts
93
3.3
Conditions for Laser Oscillations
101
3.4
Laser Examples
108
3.4.1
Ruby Laser
108
3.4.2
Semiconductor Lasers
108
3.5
Wave–Particle Duality
108
3.6
Laser Rate Equations
110
3.7
Review of Semiconductor Physics
113
3.7.1
The PN Junctions
118
3.7.2
Spontaneous and Stimulated Emission at the PN Junction
120
3.7.3
Direct and Indirect Band-Gap Semiconductors
120
3.8
Semiconductor Laser Diode
124
3.8.1
Heterojunction Lasers
124
3.8.2
Radiative and Non-Radiative Recombination
126
3.8.3
Laser Rate Equations
126
3.8.4
Steady-State Solutions of Rate Equations
128
3.8.5
Distributed-Feedback Lasers
132
* Advanced material which may need additional explanation for undergraduate readers

Contents
ix
3.9
Additional Examples
133
Exercises
136
Further Reading
138
References
138
4
Optical Modulators and Modulation Schemes
139
4.1
Introduction
139
4.2
Line Coder
139
4.3
Pulse Shaping
139
4.4
Power Spectral Density
141
4.4.1
Polar Signals
142
4.4.2
Unipolar Signals
142
4.5
Digital Modulation Schemes
144
4.5.1
Amplitude-Shift Keying
144
4.5.2
Phase-Shift Keying
144
4.5.3
Frequency-Shift Keying
145
4.5.4
Differential Phase-Shift Keying
146
4.6
Optical Modulators
149
4.6.1
Direct Modulation
149
4.6.2
External Modulators
150
4.7
Optical Realization of Modulation Schemes
158
4.7.1
Amplitude-Shift Keying
158
4.7.2
Phase-Shift Keying
160
4.7.3
Differential Phase-Shift Keying
162
4.7.4
Frequency-Shift Keying
163
4.8
Partial Response Signals∗
163
4.8.1
Alternate Mark Inversion
169
4.9
Multi-Level Signaling∗
172
4.9.1
M-ASK
172
4.9.2
M-PSK
174
4.9.3
Quadrature Amplitude Modulation
178
4.10
Additional Examples
182
Exercises
185
Further Reading
186
References
187
5
Optical Receivers
189
5.1
Introduction
189
5.2
Photodetector Performance Characteristics
190
5.2.1
Quantum Efficiency
193
5.2.2
Responsivity or Photoresponse
197
5.2.3
Photodetector Design Rules
199
5.2.4
Dark Current
200
5.2.5
Speed or Response Time
201
5.2.6
Linearity
202
5.3
Common Types of Photodetectors
202
5.3.1
pn Photodiode
203

x
Contents
5.3.2
pin Photodetector (pin-PD)
203
5.3.3
Schottky Barrier Photodetector
204
5.3.4
Metal–Semiconductor–Metal Photodetector
204
5.3.5
Photoconductive Detector
206
5.3.6
Phototransistor
206
5.3.7
Avalanche Photodetectors
207
5.3.8
Advanced Photodetectors∗
212
5.4
Direct Detection Receivers
219
5.4.1
Optical Receiver ICs
220
5.5
Receiver Noise
224
5.5.1
Shot Noise
224
5.5.2
Thermal Noise
226
5.5.3
Signal-to-Noise Ratio, SNR
227
5.6
Coherent Receivers
227
5.6.1
Single-Branch Coherent Receiver
228
5.6.2
Balanced Coherent Receiver
232
5.6.3
Single-Branch IQ Coherent Receiver
234
5.6.4
Balanced IQ Receiver
237
5.6.5
Polarization Effects
239
Exercises
242
References
244
6
Optical Amplifiers
247
6.1
Introduction
247
6.2
Optical Amplifier Model
247
6.3
Amplified Spontaneous Emission in Two-Level Systems
248
6.4
Low-Pass Representation of ASE Noise
249
6.5
System Impact of ASE
251
6.5.1
Signal–ASE Beat Noise
253
6.5.2
ASE–ASE Beat Noise
256
6.5.3
Total Mean and Variance
256
6.5.4
Polarization Effects
258
6.5.5
Amplifier Noise Figure
260
6.5.6
Optical Signal-to Noise Ratio
262
6.6
Semiconductor Optical Amplifiers
263
6.6.1
Cavity-Type Semiconductor Optical Amplifiers
264
6.6.2
Traveling-Wave Amplifiers
268
6.6.3
AR Coating
270
6.6.4
Gain Saturation
271
6.7
Erbium-Doped Fiber Amplifier
274
6.7.1
Gain Spectrum
274
6.7.2
Rate Equations∗
275
6.7.3
Amplified Spontaneous Emission
280
6.7.4
Comparison of EDFA and SOA
281
6.8
Raman Amplifiers
282
6.8.1
Governing Equations
283

Contents
xi
6.8.2
Noise Figure
287
6.8.3
Rayleigh Back Scattering
287
6.9
Additional Examples
288
Exercises
298
Further Reading
300
References
300
7
Transmission System Design
301
7.1
Introduction
301
7.2
Fiber Loss-Induced Limitations
301
7.2.1
Balanced Coherent Receiver
306
7.3
Dispersion-Induced Limitations
313
7.4
ASE-Induced Limitations
315
7.4.1
Equivalent Noise Figure
317
7.4.2
Impact of Amplifier Spacing
318
7.4.3
Direct Detection Receiver
319
7.4.4
Coherent Receiver
322
7.4.5
Numerical Experiments
326
7.5
Additional Examples
327
Exercises
333
Further Reading
334
References
334
8
Performance Analysis
335
8.1
Introduction
335
8.2
Optimum Binary Receiver for Coherent Systems
335
8.2.1
Realization of the Matched Filter
342
8.2.2
Error Probability with an Arbitrary Receiver Filter
345
8.3
Homodyne Receivers
345
8.3.1
PSK: Homodyne Detection
347
8.3.2
On–Off Keying
349
8.4
Heterodyne Receivers
350
8.4.1
PSK: Synchronous Detection
351
8.4.2
OOK: Synchronous Detection
353
8.4.3
FSK: Synchronous Detection
356
8.4.4
OOK: Asynchronous Receiver
359
8.4.5
FSK: Asynchronous Detection
364
8.4.6
Comparison of Modulation Schemes with Heterodyne Receiver
367
8.5
Direct Detection
368
8.5.1
OOK
368
8.5.2
FSK
371
8.5.3
DPSK
374
8.5.4
Comparison of Modulation Schemes with Direct Detection
379
8.6
Additional Examples
381
Exercises
387
References
388

xii
Contents
9
Channel Multiplexing Techniques
389
9.1
Introduction
389
9.2
Polarization-Division Multiplexing
389
9.3
Wavelength-Division Multiplexing
391
9.3.1
WDM Components
394
9.3.2
WDM Experiments
401
9.4
OFDM
402
9.4.1
OFDM Principle
402
9.4.2
Optical OFDM Transmitter
406
9.4.3
Optical OFDM Receiver
407
9.4.4
Optical OFDM Experiments
408
9.5
Time-Division Multiplexing
409
9.5.1
Multiplexing
409
9.5.2
Demultiplexing
410
9.5.3
OTDM Experiments
412
9.6
Additional Examples
413
Exercises
415
References
416
10
Nonlinear Effects in Fibers
419
10.1
Introduction
419
10.2
Origin of Linear and Nonlinear Refractive Indices
419
10.2.1
Absorption and Amplification
423
10.2.2
Nonlinear Susceptibility
424
10.3
Fiber Dispersion
426
10.4
Nonlinear Schrödinger Equation
428
10.5
Self-Phase Modulation
430
10.6
Combined Effect of Dispersion and SPM
433
10.7
Interchannel Nonlinear Effects
437
10.7.1
Cross-Phase Modulation
438
10.7.2
Four-Wave Mixing
448
10.8
Intrachannel Nonlinear Impairments
454
10.8.1
Intrachannel Cross-Phase Modulation
454
10.8.2
Intrachannel Four-Wave Mixing
455
10.8.3
Intra- versus Interchannel Nonlinear Effects
457
10.9
Theory of Intrachannel Nonlinear Effects
457
10.9.1
Variance Calculations
463
10.9.2
Numerical Simulations
466
10.10 Nonlinear Phase Noise
471
10.10.1 Linear Phase Noise
471
10.10.2 Gordon–Mollenauer Phase Noise
474
10.11 Stimulated Raman Scattering
478
10.11.1 Time Domain Description
481
10.12 Additional Examples
483
Exercises
491
Further Reading
493
References
493

Contents
xiii
11
Digital Signal Processing
497
11.1
Introduction
497
11.2
Coherent Receiver
497
11.3
Laser Phase Noise
498
11.4
IF Estimation and Compensation
501
11.5
Phase Estimation and Compensation
503
11.5.1
Phase Unwrapping
505
11.6
CD Equalization
506
11.6.1
Adaptive Equalizers
510
11.7
Polarization Mode Dispersion Equalization
513
11.8
Digital Back Propagation
516
11.8.1
Multi-Span DBP
521
11.9
Additional Examples
522
Exercises
524
Further Reading
525
References
525
Appendix A
527
Appendix B
533
Index
537


Preface
The field of fiber-optic communications has advanced significantly over the last three decades. In the early
days, most of the fiber’s usable bandwidth was significantly under-utilized as the transmission capacity was
quite low and hence, there was no need to apply techniques developed in non-optical communication sys-
tems to improve the spectral efficiency. However, with the recent revival of coherent detection, high spectral
efficiency can be realized using advanced modulation formats.
This book grew out of our notes for undergraduate and graduate courses on fiber-optic communications.
Chapters 1 to 6 discuss, in depth, the physics and engineering applications of photonic and optoelectronic
devices used in fiber-optic communication systems. Chapters 7 to 11 focus on transmission system design,
various propagation impairments, and how to mitigate them.
Chapters 1 to 7 are intended for undergraduate students at the senior level or for an introductory gradu-
ate course. The sections with asterisks may be omitted for undergraduate teaching or they may be covered
qualitatively without the rigorous analysis provided. Chapters 8 to 11 are intended for an advanced course
on fiber-optic systems at the graduate level and also for researchers working in the field of fiber-optic com-
munications. Throughout the book, most of the important results are obtained by first principles rather than
citing research articles. Each chapter has many worked problems to help students understand and reinforce
the concepts.
Optical communication is an interdisciplinary field that combines photonic/optoelectronic devices and
communication systems. The study of photonic devices requires a background in electromagnetics. There-
fore, Chapter 1 is devoted to a review of electromagnetics and optics. The rigorous analysis of fiber modes
in Chapter 2 would not be possible without understanding the Maxwell equations reviewed in Chapter 1.
Chapter 2 introduces students to optical fibers. The initial sections deal with the qualitative understanding of
light propagation in fibers using ray optics theory, and in later sections an analysis of fiber modes using wave
theory is carried out. The fiber is modeled as a linear system with a transfer function, which enables students
to interpret fiber chromatic dispersion and polarization mode dispersion as some kind of filter.
Two main components of an optical transmitter are the optical source, such as a laser, and the optical mod-
ulator, and these components are discussed in Chapters 3 and 4, respectively. After introducing the basic
concepts, such as spontaneous and stimulated emission, various types of semiconductor laser structures are
covered in Chapter 3. Chapter 4 deals with advanced modulation formats and different types of optical mod-
ulators that convert electrical data into optical data. Chapter 5 deals with the reverse process – conversion
of optical data into electrical data. The basic principles of photodetection are discussed. This is followed
by a detailed description of common types of photodetectors. Then, direct detection and coherent detection
receivers are covered in detail. Chapter 6 is devoted to the study of optical amplifiers. The physical principles
underlying the amplifying action and the system impact of amplifier noise are covered in Chapter 6.

xvi
Preface
In Chapters 7 and 8, the photonics and optoelectronics devices discussed so far are put together to form a
fiber-optic transmission system. Performance degradations due to fiber loss, fiber dispersion, optical ampli-
fier noise, and receiver noise are discussed in detail in Chapter 7. Scaling laws and engineering rules for
fiber-optic transmission design are also provided. Performance analysis of various modulation formats with
direct detection and coherent detection is carried out in Chapter 8.
To utilize the full bandwidth of the fiber channel, typically, channels are multiplexed in time, polarization
and frequency domains, which is the topic covered in Chapter 9. So far the fiber-optic system has been treated
as a linear system, but in reality it is a nonlinear system due to nonlinear effects such as the Kerr effect and
Raman effect. The origin and impact of fiber nonlinear effects are covered in detail in Chapter 10.
The last chapter is devoted to the study of digital signal processing (DSP) for fiber communication sys-
tems, which has drawn significant research interest recently. Rapid advances in DSP have greatly simplified
the coherent detection receiver architecture – phase and polarization alignment can be done in the electrical
domain using DSP instead of using analog optical phase-locked loop and polarization controllers. In addi-
tion, fiber chromatic dispersion, polarization mode dispersion and even fiber nonlinear effects to some extent
can be compensated for using DSP. About a decade ago, these effects were considered detrimental. Different
types of algorithm to compensate for laser phase noise, chromatic dispersion, polarization mode dispersion
and fiber nonlinear impairments are discussed in this chapter.
Supplementary material including PowerPoint slides and MATLAB coding can be found by following
the related websites link from the book home page at http://eu.wiley.com/WileyCDA/WileyTitle/productCd
-0470518677.html.

Acknowledgments
MJD sincerely acknowledges several previous doctoral students: CLF Ma, Serguei An, Yegao Xiao, Yasser
El-batawy, Yasaman Ardershirpour, Naser Faramarzpour and Munir Eldesouki, as well as Dr. Ognian Mari-
nov, for their generous assistance and support. He is also thankful to his wife Meena as well as their sons,
Arif, Imran and Tariq, for their love, support and understanding over the years.
SK would like to thank his former and current research students, P. Zhang, D. Yang, M. Malekiha, S.N.
Shahi and J. Shao, for reading various chapters and assisting with the manuscript. He would also like to thank
Professor M. Karlsson and Dr. S. Burtsev for making helpful suggestions on several chapters. Finally, he owes
a debt of gratitude to his wife Geetha as well as their children Samarth, Soujanya and Shashank for their love,
patience and understanding.


1
Electromagnetics and Optics
1.1
Introduction
In this chapter, we will review the basics of electromagnetics and optics. We will briefly discuss various
laws of electromagnetics leading to Maxwell’s equations. Maxwell’s equations will be used to derive the
wave equation, which forms the basis for the study of optical fibers in Chapter 2. We will study elementary
concepts in optics such as reflection, refraction, and group velocity. The results derived in this chapter will
be used throughout the book.
1.2
Coulomb’s Law and Electric Field Intensity
In 1783, Coulomb showed experimentally that the force between two charges separated in free space or
vacuum is directly proportional to the product of the charges and inversely proportional to the square of the
distance between them. The force is repulsive if the charges are alike in sign, and attractive if they are of
opposite sign, and it acts along the straight line connecting the charges. Suppose the charge q1 is at the origin
and q2 is at a distance r as shown in Fig. 1.1. According to Coulomb’s law, the force F2 on the charge q2 is
F2 = q1q2
4𝜋𝜖r2 r,
(1.1)
where r is a unit vector in the direction of r and 𝜖is called the permittivity that depends on the medium in
which the charges are placed. For free space, the permittivity is given by
𝜖0 = 8.854 × 10−12 C2∕Nm2.
(1.2)
For a dielectric medium, the permittivity 𝜖is larger than 𝜖0. The ratio of the permittivity of a medium to the
permittivity of free space is called the relative permittivity, 𝜖r,
𝜖
𝜖0
= 𝜖r.
(1.3)
It would be convenient if we could find the force on a test charge located at any point in space due to a given
charge q1. This can be done by taking the test charge q2 to be a unit positive charge. From Eq. (1.1), the force
on the test charge is
E = F2 =
q1
4𝜋𝜖r2 r.
(1.4)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

2
Fiber Optic Communications
F2
q2
q1
r
r
Figure 1.1
Force of attraction or repulsion between charges.
The electric field intensity is defined as the force on a positive unit charge and is given by Eq. (1.4). The
electric field intensity is a function only of the charge q1 and the distance between the test charge and q1.
For historical reasons, the product of electric field intensity and permittivity is defined as the electric flux
density D,
D = 𝜖E =
q1
4𝜋r2 r.
(1.5)
The electric flux density is a vector with its direction the same as the electric field intensity. Imagine a sphere
S of radius r around the charge q1 as shown in Fig. 1.2. Consider an incremental area ΔS on the sphere. The
electric flux crossing this surface is defined as the product of the normal component of D and the area ΔS.
Flux crossing
ΔS = Δ𝜓= DnΔS,
(1.6)
where Dn is the normal component of D. The direction of the electric flux density is normal to the surface of
the sphere and therefore, from Eq. (1.5), we obtain Dn = q1∕4𝜋r2. If we add the differential contributions to
the flux from all the incremental surfaces of the sphere, we obtain the total electric flux passing through the
sphere,
𝜓= ∫d𝜓= ∮S
DndS.
(1.7)
D
D
q1
Δs
s
(a)
(b)
Figure 1.2
(a) Electric flux density on the surface of the sphere. (b) The incremental surface ΔS on the sphere.

Electromagnetics and Optics
3
Since the electric flux density Dn given by Eq. (1.5) is the same at all points on the surface of the sphere, the
total electric flux is simply the product of Dn and the surface area of the sphere 4𝜋r2,
𝜓= ∮S
DndS =
q1
4𝜋r2 × surface area = q1.
(1.8)
Thus, the total electric flux passing through a sphere is equal to the charge enclosed by the sphere. This is
known as Gauss’s law. Although we considered the flux crossing a sphere, Eq. (1.8) holds true for any arbitrary
closed surface. This is because the surface element ΔS of an arbitrary surface may not be perpendicular to
the direction of D given by Eq. (1.5) and the projection of the surface element of an arbitrary closed surface
in a direction normal to D is the same as the surface element of a sphere. From Eq. (1.8), we see that the
total flux crossing the sphere is independent of the radius. This is because the electric flux density is inversely
proportional to the square of the radius while the surface area of the sphere is directly proportional to the
square of the radius and therefore, the total flux crossing a sphere is the same no matter what its radius is.
So far, we have assumed that the charge is located at a point. Next, let us consider the case when the charge
is distributed in a region. The volume charge density is defined as the ratio of the charge q and the volume
element ΔV occupied by the charge as it shrinks to zero,
𝜌= lim
ΔV→0
q
ΔV .
(1.9)
Dividing Eq. (1.8) by ΔV where ΔV is the volume of the surface S and letting this volume shrink to zero,
we obtain
lim
ΔV→0
∮SDndS
ΔV
= 𝜌.
(1.10)
The left-hand side of Eq. (1.10) is called the divergence of D and is written as
div D = ∇⋅D = lim
ΔV→0
∮SDndS
ΔV
;
(1.11)
Eq. (1.11) can be written as
div D = 𝜌.
(1.12)
The above equation is called the differential form of Gauss’s law and it is the first of Maxwell’s four equations.
The physical interpretation of Eq. (1.12) is as follows. Suppose a gunman is firing bullets in all directions,
as shown in Fig. 1.3 [1]. Imagine a surface S1 that does not enclose the gunman. The net outflow of the
bullets through the surface S1 is zero, since the number of bullets entering this surface is the same as the
number of bullets leaving the surface. In other words, there is no source or sink of bullets in the region S1. In
this case, we say that the divergence is zero. Imagine a surface S2 that encloses the gunman. There is a net
outflow of bullets since the gunman is the source of bullets and lies within the surface S2, so the divergence
is not zero. Similarly, if we imagine a closed surface in a region that encloses charges with charge density 𝜌,
the divergence is not zero and is given by Eq. (1.12). In a closed surface that does not enclose charges, the
divergence is zero.
1.3
Ampere’s Law and Magnetic Field Intensity
Consider a conductor carrying a direct current I. If we bring a magnetic compass near the conductor, it will
orient in the direction shown in Fig. 1.4(a). This indicates that the magnetic needle experiences the magnetic
field produced by the current. The magnetic field intensity H is defined as the force experienced by an isolated

4
Fiber Optic Communications
S1
S2
Gunman
Figure 1.3
Divergence of bullet flow.
H
H
L1
L2
I
I
S
S
S
S
N
N
N
N
(a)
(b)
Figure 1.4
(a) Direct current-induced constant magnetic field. (b) Ampere’s circuital law.
unit positive magnetic charge (note that an isolated magnetic charge qm does not exist without an associated
−qm), just like the electric field intensity E is defined as the force experienced by a unit positive electric charge.
Consider a closed path L1 or L2 around the current-carrying conductor, as shown in Fig. 1.4(b). Ampere’s
circuital law states that the line integral of H about any closed path is equal to the direct current enclosed by
that path,
∮L1
H ⋅dL = ∮L2
H ⋅dL = I.
(1.13)
The above equation indicates that the sum of the components of H that are parallel to the tangent of a closed
curve times the differential path length is equal to the current enclosed by this curve. If the closed path is a
circle (L1) of radius r, due to circular symmetry, the magnitude of H is constant at any point on L1 and its

Electromagnetics and Optics
5
direction is shown in Fig. 1.4(b). From Eq. (1.13), we obtain
∮L1
H ⋅dL = H × circumference = I
(1.14)
or
H =
I
2𝜋r.
(1.15)
Thus, the magnitude of the magnetic field intensity at a point is inversely proportional to its distance from the
conductor. Suppose the current is flowing in the z-direction. The z-component of the current density Jz may
be defined as the ratio of the incremental current ΔI passing through an elemental surface area ΔS = ΔXΔY
perpendicular to the direction of the current flow as the surface ΔS shrinks to zero,
Jz = lim
ΔS→0
ΔI
ΔS.
(1.16)
The current density J is a vector with its direction given by the direction of the current. If J is not perpendicular
to the surface ΔS, we need to find the component Jn that is perpendicular to the surface by taking the dot
product
Jn = J ⋅n,
(1.17)
where n is a unit vector normal to the surface ΔS. By defining a vector ΔS = ΔSn, we have
JnΔS = J ⋅ΔS
(1.18)
and the incremental current ΔI is given by
ΔI = J ⋅ΔS.
(1.19)
The total current flowing through a surface S is obtained by integrating,
I = ∫S
J ⋅dS.
(1.20)
Using Eq. (1.20) in Eq. (1.13), we obtain
∮L1
H ⋅dL = ∫S
J ⋅dS,
(1.21)
where S is the surface whose perimeter is the closed path L1.
In analogy with the definition of electric flux density, magnetic flux density is defined as
B = 𝜇H,
(1.22)
where 𝜇is called the permeability. In free space, the permeability has a value
𝜇0 = 4𝜋× 10−7 N/A2.
(1.23)
In general, the permeability of a medium 𝜇is written as a product of the permeability of free space 𝜇0 and a
constant that depends on the medium. This constant is called the relative permeability 𝜇r,
𝜇= 𝜇0𝜇r.
(1.24)

6
Fiber Optic Communications
The magnetic flux crossing a surface S can be obtained by integrating the normal component of magnetic flux
density,
𝜓m = ∫S
BndS.
(1.25)
If we use Gauss’s law for the magnetic field, the normal component of the magnetic flux density integrated
over a closed surface should be equal to the magnetic charge enclosed. However, no isolated magnetic charge
has ever been discovered. In the case of an electric field, the flux lines start from or terminate on electric
charges. In contrast, magnetic flux lines are closed and do not emerge from or terminate on magnetic charges.
Therefore,
𝜓m = ∫S
BndS = 0
(1.26)
and in analogy with the differential form of Gauss’s law for an electric field, we have
div B = 0.
(1.27)
The above equation is one of Maxwell’s four equations.
1.4
Faraday’s Law
Consider an iron core with copper windings connected to a voltmeter, as shown in Fig. 1.5. If you bring a
bar magnet close to the core, you will see a deflection in the voltmeter. If you stop moving the magnet, there
will be no current through the voltmeter. If you move the magnet away from the conductor, the deflection
of the voltmeter will be in the opposite direction. The same results can be obtained if the core is moving
and the magnet is stationary. Faraday carried out an experiment similar to the one shown in Fig. 1.5 and
from his experiments, he concluded that the time-varying magnetic field produces an electromotive force
which is responsible for a current in a closed circuit. An electromotive force (e.m.f.) is simply the electric
field intensity integrated over the length of the conductor or in other words, it is the voltage developed. In
the absence of electric field intensity, electrons move randomly in all directions with a zero net current in
any direction. Because of the electric field intensity (which is the force experienced by a unit electric charge)
due to a time-varying magnetic field, electrons are forced to move in a particular direction leading to current.
V
Voltmeter
Magnet
N
S
Iron core
Figure 1.5
Generation of e.m.f. by moving a magnet.

Electromagnetics and Optics
7
Faraday’s law is stated as
e.m.f. = −d𝜓m
dt ,
(1.28)
where e.m.f. is the electromotive force about a closed path L (that includes a conductor and connections to a
voltmeter), 𝜓m is the magnetic flux crossing the surface S whose perimeter is the closed path L, and d𝜓m∕dt is
the time rate of change of this flux. Since e.m.f. is an integrated electric field intensity, it can be expressed as
e.m.f. = ∮L
E ⋅dl.
(1.29)
The magnetic flux crossing the surface S is equal to the sum of the normal component of the magnetic flux
density at the surface times the elemental surface area dS,
𝜓m = ∫S
BndS = ∫S
B ⋅dS,
(1.30)
where dS is a vector with magnitude dS and direction normal to the surface. Using Eqs. (1.29) and (1.30) in
Eq. (1.28), we obtain
∮L
E ⋅dl = −d
dt∫S
B ⋅dS
= −∫S
𝜕B
𝜕t ⋅dS.
(1.31)
In Eq. (1.31), we have assumed that the path is stationary and the magnetic flux density is changing with time;
therefore the elemental surface area is not time dependent, allowing us to take the partial derivative under the
integral sign. In Eq. (1.31), we have a line integral on the left-hand side and a surface integral on the right-hand
side. In vector calculus, a line integral could be replaced by a surface integral using Stokes’s theorem,
∮L
E ⋅dl = ∫S
(∇× E) ⋅dS
(1.32)
to obtain
∫S
[
∇× E + 𝜕B
𝜕t
]
⋅dS = 0.
(1.33)
Eq. (1.33) is valid for any surface whose perimeter is a closed path. It holds true for any arbitrary surface
only if the integrand vanishes, i.e.,
∇× E = −𝜕B
𝜕t .
(1.34)
The above equation is Faraday’s law in the differential form and is one of Maxwell’s four equations.
1.4.1
Meaning of Curl
The curl of a vector A is defined as
curl A = ∇× A = Fxx + Fyy + Fzz
(1.35)
where
Fx = 𝜕Az
𝜕y −
𝜕Ay
𝜕z ,
(1.36)

8
Fiber Optic Communications
Fy = 𝜕Ax
𝜕z −𝜕Az
𝜕x ,
(1.37)
Fz =
𝜕Ay
𝜕x −𝜕Ax
𝜕y .
(1.38)
Consider a vector A with only an x-component. The z-component of the curl of A is
Fz = −𝜕Ax
𝜕y .
(1.39)
Skilling [2] suggests the use of a paddle wheel to measure the curl of a vector. As an example, consider the
water flow in a river as shown in Fig. 1.6(a). Suppose the velocity of water (Ax) increases as we go from the
bottom of the river to the surface. The length of the arrow in Fig. 1.6(a) represents the magnitude of the water
velocity. If we place a paddle wheel with its axis perpendicular to the paper, it will turn clockwise since the
upper paddle experiences more force than the lower paddle (Fig. 1.6(b)). In this case, we say that curl exists
along the axis of the paddle wheel in the direction of an inward normal to the surface of the page (z-direction).
A larger speed of the paddle means a larger value of the curl.
Suppose the velocity of water is the same at all depths, as shown in Fig. 1.7. In this case the paddle wheel
will not turn, which means there is no curl in the direction of the axis of the paddle wheel. From Eq. (1.39), we
find that the z-component of the curl is zero if the water velocity Ax does not change as a function of depth y.
Eq. (1.34) can be understood as follows. Suppose the x-component of the electric field intensity Ex is chang-
ing as a function of y in a conductor, as shown in Fig. 1.8. This implies that there is a curl perpendicular to the
page. From Eq. (1.34), we see that this should be equal to the time derivative of the magnetic field intensity
Ax
y
River surface
River bottom
Ax(y+∇y)
|Ax(y+∇y)| > |Ax(y)|
Ax(y)
x
(b)
(a)
Figure 1.6
Clockwise movement of the paddle when the velocity of water increases from the bottom to the surface of
a river.
Ax
River surface
River bottom
Figure 1.7
Velocity of water constant at all depths. The paddle wheel does not rotate in this case.

Electromagnetics and Optics
9
Ex
Conductor
B=Bzz
y
+
–
x
Figure 1.8
Induced electric field due to the time-varying magnetic field perpendicular to the page.
in the z-direction. In other words, the time-varying magnetic field in the z-direction induces an electric field
intensity as shown in Fig. 1.8. The electrons in the conductor move in a direction opposite to Ex (Coulomb’s
law), leading to the current in the conductor if the circuit is closed.
1.4.2
Ampere’s Law in Differential Form
From Eq. (1.21), we have
∮L1
H ⋅dl = ∫S
J ⋅dS.
(1.40)
Using Stokes’s theorem (Eq. (1.32)), Eq. (1.40) may be rewritten as
∫S
(∇× H) ⋅dS = ∫S
J ⋅dS
(1.41)
or
∇× H = J.
(1.42)
The above equation is the differential form of Ampere’s circuital law and it is one of Maxwell’s four equations
for the case of current and electric field intensity not changing with time. Eq. (1.40) holds true only under
non-time-varying conditions. From Faraday’s law (Eq. (1.34)), we see that if the magnetic field changes with
time, it produces an electric field. Owing to symmetry, we might expect that the time-changing electric field
produces a magnetic field. However, comparing Eqs. (1.34) and (1.42), we find that the term corresponding
to a time-varying electric field is missing in Eq. (1.42). Maxwell proposed adding a term to the right-hand
side of Eq. (1.42) so that a time-changing electric field produces a magnetic field. With this modification,
Ampere’s circuital law becomes
∇× H = J + 𝜕D
𝜕t .
(1.43)
In the absence of the second term on the right-hand side of Eq. (1.43), it can be shown that the law of con-
servation of charges is violated (see Exercise 1.4). The second term is known as the displacement current
density.
1.5
Maxwell’s Equations
Combining Eqs. (1.12), (1.27), (1.34) and (1.43), we obtain
div D = 𝜌,
(1.44)
div B = 0,
(1.45)

10
Fiber Optic Communications
∇× E = −𝜕B
𝜕t ,
(1.46)
∇× H = J + 𝜕D
𝜕t .
(1.47)
From Eqs. (1.46) and (1.47), we see that a time-changing magnetic field produces an electric field and a
time-changing electric field or current density produces a magnetic field. The charge distribution 𝜌and cur-
rent density J are the sources for generation of electric and magnetic fields. For the given charge and current
distribution, Eqs. (1.44)–(1.47) may be solved to obtain the electric and magnetic field distributions. The
terms on the right-hand sides of Eqs. (1.46) and (1.47) may be viewed as the sources for generation of field
intensities appearing on the left-hand sides of Eqs. (1.46) and (1.47). As an example, consider the alternating
current I0 sin (2𝜋ft) flowing in the transmitter antenna. From Ampere’s law, we find that the current leads to a
magnetic field intensity around the antenna (first term of Eq. (1.47)). From Faraday’s law, it follows that the
time-varying magnetic field induces an electric field intensity (Eq. (1.46)) in the vicinity of the the antenna.
Consider a point in the neighborhood of the antenna (but not on the antenna). At this point J = 0, but the
time-varying electric field intensity or displacement current density (second term on the right-hand side of (Eq.
(1.47)) leads to a magnetic field intensity, which in turn leads to an electric field intensity (Eq. (1.46)). This
process continues and the generated electromagnetic wave propagates outward just like the water wave gener-
ated by throwing a stone into a lake. If the displacement current density were to be absent, there would be no
continuous coupling between electric and magnetic fields and we would not have had electromagnetic waves.
1.5.1
Maxwell’s Equation in a Source-Free Region
In free space or dielectric, if there is no charge or current in the neighborhood, we can set 𝜌= 0 and J = 0 in
Eqs. (1.44) and (1.47). Note that the above equations describe the relations between electric field, magnetic
field, and the sources at a space-time point and therefore, in a region sufficiently far away from the sources,
we can set 𝜌= 0 and J = 0 in that region. However, on the antenna, we can not ignore the source terms 𝜌or J
in Eqs. (1.44)–(1.47). Setting 𝜌= 0 and J = 0 in the source-free region, Maxwell’s equations take the form
div D = 0,
(1.48)
div B = 0,
(1.49)
∇× E = −𝜕B
𝜕t ,
(1.50)
∇× H = 𝜕D
𝜕t .
(1.51)
In the source-free region, the time-changing electric/magnetic field (which was generated from a distant
source 𝜌or J) acts as a source for a magnetic/electric field.
1.5.2
Electromagnetic Wave
Suppose the electric field is only along the x-direction,
E = Exx,
(1.52)
and the magnetic field is only along the y-direction,
H = Hyy.
(1.53)

Electromagnetics and Optics
11
Substituting Eqs. (1.52) and (1.53) into Eq. (1.50), we obtain
∇× E =
⎡
⎢
⎢
⎢⎣
x
y
z
𝜕
𝜕x
𝜕
𝜕y
𝜕
𝜕z
Ex 0
0
⎤
⎥
⎥
⎥⎦
= 𝜕Ex
𝜕z y −𝜕Ex
𝜕y z = −𝜇
𝜕Hy
𝜕t y.
(1.54)
Equating y- and z-components separately, we find
𝜕Ex
𝜕z = −𝜇
𝜕Hy
𝜕t ,
(1.55)
𝜕Ex
𝜕y = 0.
(1.56)
Substituting Eqs. (1.52) and (1.53) into Eq. (1.51), we obtain
∇× H =
⎡
⎢
⎢
⎢⎣
x
y
z
𝜕
𝜕x
𝜕
𝜕y
𝜕
𝜕z
0 Hy 0
⎤
⎥
⎥
⎥⎦
= −
𝜕Hy
𝜕z x +
𝜕Hy
𝜕x z = 𝜖𝜕Ex
𝜕t x.
(1.57)
Therefore,
𝜕Hy
𝜕z = −𝜖𝜕Ex
𝜕t ,
(1.58)
𝜕Hy
𝜕x = 0.
(1.59)
Eqs. (1.55) and (1.58) are coupled. To obtain an equation that does not contain Hy, we differentiate Eq. (1.55)
with respect to z and differentiate Eq. (1.58) with respect to t,
𝜕2Ex
𝜕z2 = −𝜇
𝜕Hy
𝜕t𝜕z,
(1.60)
𝜇
𝜕2Hy
𝜕z𝜕t = −𝜇𝜖𝜕2Ex
𝜕t2 .
(1.61)
Adding Eqs. (1.60) and (1.61), we obtain
𝜕2Ex
𝜕z2 = 𝜇𝜖𝜕Ex
𝜕t2 .
(1.62)
The above equation is called the wave equation and it forms the basis for the study of electromagnetic wave
propagation.
1.5.3
Free-Space Propagation
For free space, 𝜖= 𝜖0 = 8.854 × 10−12 C2∕Nm2, 𝜇= 𝜇0 = 4𝜋× 10−7 N/A2, and
c =
1
√𝜇0𝜖0
≃3 × 108 m/s,
(1.63)

12
Fiber Optic Communications
where c is the velocity of light in free space. Before Maxwell’s time, electrostatics, magnetostatics, and optics
were unrelated. Maxwell unified these three fields and showed that the light wave is actually an electromag-
netic wave with velocity given by Eq. (1.63).
1.5.4
Propagation in a Dielectric Medium
Similar to Eq. (1.63), the velocity of light in a medium can be written as
𝑣=
1
√𝜇𝜖
,
(1.64)
where 𝜇= 𝜇0𝜇r and 𝜖= 𝜖0𝜖r. Therefore,
𝑣=
1
√𝜇0𝜖0𝜇r𝜖r
.
(1.65)
Using Eq. (1.64) in Eq. (1.65), we have
𝑣=
c
√𝜇r𝜖r
.
(1.66)
For dielectrics, 𝜇r = 1 and the velocity of light in a dielectric medium can be written as
𝑣=
c
√𝜖r
= c
n,
(1.67)
where n = √𝜖r is called the refractive index of the medium. The refractive index of a medium is greater than
1 and the velocity of light in a medium is less than that in free space.
1.6
1-Dimensional Wave Equation
Using Eq. (1.64) in Eq. (1.62), we obtain
𝜕2Ex
𝜕z2 = 1
𝑣2
𝜕2Ex
𝜕t2 .
(1.68)
Elimination of Ex from Eqs. (1.55) and (1.58) leads to the same equation for Hy,
𝜕2Hy
𝜕z2
= 1
𝑣2
𝜕Hy
𝜕t2 .
(1.69)
To solve Eq. (1.68), let us try a trial solution of the form
Ex(t, z) = f(t + 𝛼z),
(1.70)
where f is an arbitrary function of t + 𝛼z. Let
u = t + 𝛼z,
(1.71)
𝜕u
𝜕z = 𝛼,
𝜕u
𝜕t = 1,
(1.72)
𝜕Ex
𝜕z = 𝜕Ex
𝜕u
𝜕u
𝜕z = 𝜕Ex
𝜕u 𝛼,
(1.73)

Electromagnetics and Optics
13
𝜕2Ex
𝜕z2 = 𝜕2Ex
𝜕u2 𝛼2,
(1.74)
𝜕2Ex
𝜕t2 = 𝜕2Ex
𝜕u2 .
(1.75)
Using Eqs. (1.74) and (1.75) in Eq. (1.68), we obtain
𝛼2 𝜕2Ex
𝜕u2 = 1
𝑣2
𝜕2Ex
𝜕u2 .
(1.76)
Therefore,
𝛼= ±1
𝑣,
(1.77)
Ex = f
(
t + z
𝑣
)
or
Ex = f
(
t −z
𝑣
)
.
(1.78)
The negative sign implies a forward-propagating wave and the positive sign indicates a backward-propagating
wave. Note that f is an arbitrary function and it is determined by the initial conditions as illustrated by the
following examples.
Example 1.1
Turn on a flash light for 1 ns then turn it off. You will generate a pulse as shown in Fig. 1.9 at the flash light
(z = 0) (see Fig. 1.10). The electric field intensity oscillates at light frequencies and the rectangular shape
shown in Fig. 1.9 is actually the absolute field envelope. Let us ignore the fast oscillations in this example
and write the field (which is actually the field envelope1) at z = 0 as
Ex(t, 0) = f(t) = A0 rect
(
t
T0
)
,
(1.79)
A0
f(t) = A0 rect (t/T0)
T0 = 1 ns
t
Figure 1.9
Electrical field Ex(t, 0) at the flash light.
z = 0
1 m
Flash light
Screen
z = 1 m
Figure 1.10
The propagation of the light pulse generated at the flash light.
1 It can be shown that the field envelope also satisfies the wave equation.

14
Fiber Optic Communications
At flash light
1 ns
At screen
A0rect (t/T0)
A0rect (t/T0 – 0.33E-8 s/T0)
z/c = 0.33E-8 s
t
Figure 1.11
The electric field envelopes at the flash light and at the screen.
where
rect(x) =
{
1,
if
|x| < 1∕2
0,
otherwise
(1.80)
and T0 = 1 ms. The speed of light in free space 𝑣= c ≃3 × 108 m/s. Therefore, it takes 0.33 × 10−8 s to get
the light pulse on the screen. At z = 1 m (see Fig. 1.11),
Ex(t, z) = f
(
t −z
𝑣
)
= A0 rect
(
t −0.33 × 10−8
T0
)
.
(1.81)
Example 1.2
A laser shown in Fig. 1.12 operates at 191 THz. Under ideal conditions and ignoring transverse distributions,
the laser output may be written as
Ex(t, 0) = f(t) = A0 cos (2𝜋f0t),
(1.82)
where f0 = 191 THz. The laser output arrives at the screen after 0.33 × 10−8 s (see Fig. 1.12). The electric
field intensity at the screen may be written as
Ex(t, z) = f
(
t −z
𝑣
)
= A cos
[
2𝜋f0
(
t −z
𝑣
)]
= A cos [2𝜋f0(t −0.33 × 10−8)].
(1.83)
1 m
Screen
Laser
Figure 1.12
The propagation of laser output in free space.

Electromagnetics and Optics
15
Example 1.3
The laser output is reflected by a mirror and it propagates in a backward direction as shown in Fig. 1.13. In
Eq. (1.78), the positive sign corresponds to a backward-propagating wave. Suppose that at the mirror, the
electromagnetic wave undergoes a phase shift of 𝜙.2 The backward-propagating wave can be described by
(see Eq. (1.78))
Ex−= A cos [2𝜋f0(t + z∕𝑣) + 𝜙].
(1.84)
The forward-propagating wave is described by (see Eq. (1.83))
Ex+ = A cos [2𝜋f0(t −z∕𝑣)].
(1.85)
The total field is given by
Ex = Ex+ + Ex−.
(1.86)
Laser
Figure 1.13
Reflection of the laser output by a mirror.
1.6.1
1-Dimensional Plane Wave
The output of the laser in Example 1.2 propagates as a plane wave, as given by Eq. (1.83). A plane wave can
be written in any of the following forms:
Ex(t, z) = Ex0 cos
[
2𝜋f
(
t −z
𝑣
)]
= Ex0 cos
[
2𝜋ft −2𝜋
𝜆z
]
= Ex0 cos (𝜔t −kz),
(1.87)
where 𝑣is the velocity of light in the medium, f is the frequency, 𝜆= 𝑣∕f is the wavelength, 𝜔= 2𝜋f is the
angular frequency, k = 2𝜋∕𝜆is the wavenumber, and k is also called the propagation constant. Frequency and
wavelength are related by
𝑣= f𝜆,
(1.88)
or equivalently
𝑣= 𝜔
k .
(1.89)
Since Hy also satisfies the wave equation (Eq. (1.69)), it can be written as
Hy = Hy0 cos (𝜔t −kz).
(1.90)
From Eq. (1.58), we have
𝜕Hy
𝜕z = −𝜖𝜕Ex
𝜕t .
(1.91)
2 If the mirror is a perfect conductor, 𝜙= 𝜋.

16
Fiber Optic Communications
Using Eq. (1.87) in Eq. (1.91), we obtain
𝜕Hy
𝜕z = 𝜖𝜔Ex0 sin (𝜔t −kz).
(1.92)
Integrating Eq. (1.92) with respect to z,
Hy = 𝜖Ex0𝜔
k
cos (𝜔t −kz) + D,
(1.93)
where D is a constant of integration and could depend on t. Comparing Eqs. (1.90) and (1.93), we see that D
is zero and using Eq. (1.89) we find
Ex0
Hy0
= 1
𝜖𝜐= 𝜂,
(1.94)
where 𝜂is the intrinsic impedance of the dielectric medium. For free space, 𝜂= 376.47 Ohms. Note that Ex
and Hy are independent of x and y. In other words, at time t, the phase 𝜔t −kz is constant in a transverse plane
described by z = constant and therefore, they are called plane waves.
1.6.2
Complex Notation
It is often convenient to use complex notation for electric and magnetic fields in the following forms:
̃Ex = Ex0ei(𝜔t−kz) or ̃Ex = Ex0e−i(𝜔t−kz)
(1.95)
and
̃Hy = Hy0ei(𝜔t−kz) or ̃Hy = Hy0e−i(𝜔t−kz).
(1.96)
This is known as an analytic representation. The actual electric and magnetic fields can be obtained by
Ex = Re [ ̃Ex
] = Ex0 cos (𝜔t −kz)
(1.97)
and
Hy = Re [ ̃Hy
] = Hy0 cos (𝜔t −kz).
(1.98)
In reality, the electric and magnetic fields are not complex, but we represent them in the complex forms
of Eqs. (1.95) and (1.96) with the understanding that the real parts of the complex fields correspond to the
actual electric and magnetic fields. This representation leads to mathematical simplifications. For example,
differentiation of a complex exponential function is the complex exponential function multiplied by some
constant. In the analytic representation, superposition of two eletromagnetic fields corresponds to addition
of two complex fields. However, care should be exercised when we take the product of two electromagnetic
fields as encountered in nonlinear optics. For example, consider the product of two electrical fields given by
Exn = An cos (𝜔nt −knz),
n = 1, 2
(1.99)
Ex1Ex2 = A1A2
2
cos [(𝜔1 + 𝜔2)t −(k1 + k2)z]
+ cos [(𝜔1 −𝜔2)t −(k1 −k2)z].
(1.100)
The product of the electromagnetic fields in the complex forms is
̃Ex1 ̃Ex2 = A1A2 exp [i(𝜔1 + 𝜔2)t −i(k1 + k2)z].
(1.101)

Electromagnetics and Optics
17
If we take the real part of Eq. (1.101), we find
Re [ ̃Ex1 ̃Ex1
] = A1A2 cos [(𝜔1 + 𝜔2)t −(k1 + k2)z]
≠Ex1Ex2.
(1.102)
In this case, we should use the real form of electromagnetic fields. In the rest of this book we sometimes omit ̃
and use Ex(Hy) to represent a complex electric (magnetic) field with the understanding that the real part is the
actual field.
1.7
Power Flow and Poynting Vector
Consider an electromagnetic wave propagating in a region V with the cross-sectional area A as shown
in Fig. 1.14. The propagation of a plane electromagnetic wave in the source-free region is governed by
Eqs. (1.58) and (1.55),
𝜖𝜕Ex
𝜕t = −
𝜕Hy
𝜕z
(1.103)
𝜇
𝜕Hy
𝜕t
= −𝜕Ex
𝜕z .
(1.104)
Multiplying Eq. (1.103) by Ex and noting that
𝜕E2
x
𝜕t = 2Ex
𝜕Ex
𝜕t ,
(1.105)
we obtain
𝜖
2
𝜕E2
x
𝜕t = −Ex
𝜕Hy
𝜕z .
(1.106)
Ex
Ex
Pz
Hy
Hy
Area A
y
y
y
z
z
V
z
x
x
x
Figure 1.14
Electromagnetic wave propagation in a volume V with cross-sectional area A.

18
Fiber Optic Communications
Similarly, multiplying Eq. (1.104) by Hy, we have
𝜇
2
𝜕H2
y
𝜕t
= −Hy
𝜕Ex
𝜕z .
(1.107)
Adding Eqs. (1.107 ) and (1.106) and integrating over the volume V, we obtain
𝜕
𝜕t∫V
[
𝜖E2
x
2
+
𝜇H2
y
2
]
dV = −A ∫
L
0
[
Ex
𝜕Hy
𝜕z + Hy
𝜕Ex
𝜕z
]
dz.
(1.108)
On the right-hand side of Eq. (1.108), integration over the transverse plane yields the area A since Ex and Hy
are functions of z only. Eq. (1.108) can be rewritten as
𝜕
𝜕t∫V
[
𝜖E2
x
2
+
𝜇H2
y
2
]
dV = −A ∫
L
0
𝜕
𝜕z
[ExHy
] dz = −AExHy
||||||
L
0
.
(1.109)
The terms 𝜖E2
x∕2 and 𝜇H2
y∕2 represent the energy densities of the electric field and the magnetic field, respec-
tively. The left-hand side of Eq. (1.109) can be interpreted as the power crossing the area A and therefore,
ExHy is the power per unit area or the power density measured in watts per square meter (W/m2). We define
a Poynting vector as
= E × H.
(1.110)
The z-component of the Poynting vector is
z = ExHy.
(1.111)
The direction of the Poynting vector is normal to both E and H, and is in fact the direction of power flow.
In Eq. (1.109), integrating the energy density over volume leads to energy and, therefore, it can be
rewritten as
1
A
d
dt = z(0) −z(L).
(1.112)
The left-hand side of (1.112) represents the rate of change of energy per unit area and therefore, z has the
dimension of power per unit area or power density. For light waves, the power density is also known as the
optical intensity. Eq. (1.112) states that the difference in the power entering the cross-section A and the power
leaving the cross-section A is equal to the rate of change of energy in the volume V. The plane-wave solutions
for Ex and Hy are given by Eqs. (1.87) and (1.90),
Ex = Ex0 cos (𝜔t −kz),
(1.113)
Hy = Hy0 cos (𝜔t −kz),
(1.114)
z =
E2
x0
𝜂cos2 (𝜔t −kz).
(1.115)
The average power density may be found by integrating it over one cycle and dividing by the period T = 1∕f,
av
z = 1
T
E2
x0
𝜂∫
T
0
cos2 (𝜔t −kz)dt,
(1.116)
= 1
T
E2
x0
𝜂∫
T
0
1 + cos [2(𝜔t −kz)]
2
dt
(1.117)
=
E2
x0
2𝜂.
(1.118)

Electromagnetics and Optics
19
The integral of the cosine function over one period is zero and, therefore, the second term of Eq. (1.118) does
not contribute after the integration. The average power density av
z is proportional to the square of the electric
field amplitude. Using complex notation, Eq. (1.111) can be written as
z = Re [ ̃Ex
] Re [ ̃Hy
]
(1.119)
= 1
𝜂Re [ ̃Ex
] Re [ ̃Ex
] = 1
𝜂
[ ̃Ex + ̃E∗
x
2
] [ ̃Ex + ̃E∗
x
2
]
.
(1.120)
The right-hand side of Eq. (1.120) contains product terms such as ̃E2
x and ̃E∗2
x . The average of E2
x and E∗2
x over
the period T is zero, since they are sinusoids with no d.c. component. Therefore, the average power density
is given by
av
z
=
1
2𝜂T ∫
T
0
|| ̃Ex||
2dt = | ̃Ex|2
2𝜂,
(1.121)
since | ̃Ex|2 is a constant for the plane wave. Thus, we see that, in complex notation, the average power density
is proportional to the absolute square of the field amplitude.
Example 1.4
Two monochromatic waves are superposed to obtain
̃Ex = A1 exp [i(𝜔1t −k1z)] + A2 exp [i(𝜔2t −k2z)].
(1.122)
Find the average power density of the combined wave.
Solution:
From Eq. (1.121), we have
av
z =
1
2𝜂T ∫
T
0
|| ̃Ex||
2dt
=
1
2𝜂T
{
T|A1|2 + T|A2|2 + A1A⋆
2 ∫
T
0
exp [i(𝜔1 −𝜔2)t −i(k1 −k2)z]dt
+ A2A⋆
1 ∫
T
0
exp [−i(𝜔1 −𝜔2) + i(k1 −k2)z]
}
dt.
(1.123)
Since integrals of sinusoids over the period T are zero, the last two terms in Eq. (1.123) do not contribute,
which leads to
av
z
= |A1|2 + |A2|2
2𝜂
.
(1.124)
Thus, the average power density is the sum of absolute squares of the amplitudes of monochromatic waves.
1.8
3-Dimensional Wave Equation
From Maxwell’s equations, the following wave equation could be derived (see Exercise 1.6):
𝜕2𝜓
𝜕x2 + 𝜕2𝜓
𝜕y2 + 𝜕2𝜓
𝜕z2 −1
𝜐2
𝜕2𝜓
𝜕t2 = 0,
(1.125)

20
Fiber Optic Communications
where 𝜓is any one of the components Ex, Ey, Ez, Hx, Hy, Hz. As before, let us try a trial solution of the form
𝜓= f(t −𝛼xx −𝛼yy −𝛼zz).
(1.126)
Proceeding as in Section 1.6, we find that
𝛼2
x + 𝛼2
y + 𝛼2
z = 1
𝜐2 .
(1.127)
If we choose the function to be a cosine function, we obtain a 3-dimensional plane wave described by
𝜓= 𝜓0 cos [𝜔(t −𝛼xx −𝛼yy −𝛼zz)]
(1.128)
= 𝜓0 cos (𝜔t −kxx −kyy −kzz),
(1.129)
where kr = 𝜔𝛼r, r = x, y, z. Define a vector k = kxx + kyy + kzz. k is known as a wave vector. Eq. (1.127)
becomes
𝜔2
k2 = 𝜐2
or
𝜔
k = ±𝜐,
(1.130)
where k is the magnitude of the vector k,
k =
√
k2
x + k2
y + k2
z.
(1.131)
k is also known as the wavenumber. The angular frequency 𝜔is determined by the light source, such as a
laser or light-emitting diode (LED). In a linear medium, the frequency of the launched electromagnetic wave
can not be changed. The frequency of the plane wave propagating in a medium of refractive index n is the
same as that of the source, although the wavelength in the medium decreases by a factor n. For given angular
frequency 𝜔, the wavenumber in a medium of refractive index n can be determined by
k = 𝜔
𝜐= 𝜔n
c = 2𝜋n
𝜆0
,
(1.132)
where 𝜆0 = c∕f is the free-space wavelength. For free space, n = 1 and the wavenumber is
k0 = 2𝜋
𝜆0
.
(1.133)
The wavelength 𝜆m in a medium of refractive index n can be defined by
k = 2𝜋
𝜆m
.
(1.134)
Comparing (1.132) and (1.134), it follows that
𝜆m = 𝜆0
n .
(1.135)
Example 1.5
Consider a plane wave propagating in the x–z plane making an angle of 30∘with the z-axis. This plane wave
may be described by
𝜓= 𝜓0 cos (𝜔t −kxx −kzz).
(1.136)

Electromagnetics and Optics
21
kx
kz
k
30°
x
z
Figure 1.15
A plane wave propagates at angle 30∘with the z-axis.
The wave vector k = kxx + kzz. From Fig. 1.15, kx = k cos 60∘= k∕2 and kz = k cos 30∘= k
√
3∕2.
Eq. (1.136) may be written as
𝜓= 𝜓0 cos
[
𝜔t −k
(
1
2x +
√
3
2 z
)]
.
(1.137)
1.9
Reflection and Refraction
Reflection and refraction occur when light enters into a new medium with a different refractive index. Consider
a ray incident on the mirror MM
′, as shown in Fig. 1.16. According to the law of reflection, the angle of
reflection 𝜙r is equal to the angle of incidence 𝜙i,
𝜙i = 𝜙r.
The above result can be proved from Maxwell’s equations with appropriate boundary conditions. Instead, let
us use Fermat’s principle to prove it. There are an infinite number of paths to go from point A to point B after
striking the mirror. Fermat’s principle can be stated loosely as follows: out of the infinite number of paths to
go from point A to point B, light chooses the path that takes the shortest transit time. In Fig. 1.17, light could
choose AC′B, AC′′B, AC′′′B, or any other path. But it chooses the path AC′B, for which 𝜙i = 𝜙r. Draw the
line M′B′ = BM′ so that BC′ = C′B′, BC′′ = C′′B′, and so on. If AC′B′ is a straight line, it would be the
shortest of all the paths connecting A and B′. Since AC′B(= AC′B′), it would be the shortest path to go from A
to B after striking the mirror and therefore, according to Fermat’s principle, light chooses the path AC′B which
takes the shortest time. To prove that 𝜙i = 𝜙r, consider the point C′. Adding up all the angles at C′, we find
𝜙i + 𝜙r + 2(𝜋∕2 −𝜙r) = 2𝜋
(1.138)
or
𝜙i = 𝜙r.
(1.139)
ϕi
ϕr
A
M
C
B
Mʹ
Figure 1.16
Reflection of a light wave incident on a mirror.

22
Fiber Optic Communications
ϕi
ϕr
A
M
B
Mʹ
Cʹʹ
Cʹʹʹ
Cʹ
Bʹ
Figure 1.17
Illustration of Fermat’s principle.
1.9.1
Refraction
In a medium with constant refractive index, light travels in a straight line. But as the light travels from a
rarer medium to a denser medium, it bends toward the normal to the interface, as shown in Fig. 1.18. This
phenomenon is called refraction, and it can be explained using Fermat’s principle. Since the speeds of light
in two media are different, the path which takes the shortest time to reach B from A may not be a straight
line AB. Feynmann et al. [1] give the following analogy: suppose there is a little girl drowning in the sea at
point B and screaming for help as illustrated in Fig. 1.19. You are at point A on the land. Obviously, the paths
AC2B and AC3B take a longer time. You could choose the straight-line path AC1B. But since running takes
less time than swimming, it is advantageous to travel a slightly longer distance on land than sea. Therefore,
the path AC0B would take a shorter time than AC1B. Similarly, in the case of light propagating from a rare
medium to a dense medium (Fig. 1.20), light travels faster in the rare medium and therefore, the path AC0B
may take a shorter time than AC1B. This explains why light bends toward the normal. To obtain a relation
between the angle of incidence 𝜙1 and the angle of refraction 𝜙2, let us consider the time taken by light to go
from A to B via several paths:
tx = n1ACx
c
+ n2CxB
c
,
x = 0, 1, 2, …
(1.140)
ϕ1
ϕ2
B
C
A
Dense medium, n2
Rare medium, n1
Figure 1.18
Refraction of a plane wave incident at the interface of two dielectrics.

Electromagnetics and Optics
23
Shoreline
Girl B
Sea
A
Land
C2
C1
C0
C3
Figure 1.19
Different paths to connect A and B.
A
B
C2
C1
C0
C3
C4
n2
n1
Figure 1.20
Illustration of Fermat’s principle for the case of refraction.
From Fig. 1.21, we have
AD = x,
CxD = y,
ACx =
√
x2 + y2,
(1.141)
BE = AF −x,
BCx =
√
(AF −x)2 + BG2.
(1.142)
Substituting this in Eq. (1.140), we find
tx = n1
√
x2 + y2
c
+ n2
√
(AF −x)2 + BG2
c
.
(1.143)
Note that AF, BG, and y are constants as x changes. Therefore, to find the path that takes the least time, we
differentiate tx with respect to x and set it to zero,
dtx
dx =
n1x
√
x2 + y2 −
n2(AF −x)
√
(AF −x)2 + BG2 = 0.
(1.144)
From Fig. 1.21, we have
x
√
x2 + y2 = sin 𝜙1,
AF −x
√
(AF −x)2 + BG2 = sin 𝜙2.
(1.145)

24
Fiber Optic Communications
A
D
F
B
E
G
x
y
Cx
n2
n1
ϕ1
ϕ2
Figure 1.21
Refraction of a light wave.
Therefore, Eq. (1.144) becomes
n1 sin 𝜙1 = n2 sin 𝜙2.
(1.146)
This is called Snell’s law. If n2 > n1, sin 𝜙1 > sin 𝜙2 and 𝜙1 > 𝜙2. This explains why light bends toward the
normal in a denser medium, as shown in Fig. 1.18.
When n1 > n2, from Eq. (1.146), we have 𝜙2 > 𝜙1. As the angle of incidence 𝜙1 increases, the angle of
refraction 𝜙2 increases too. For a particular angle, 𝜙1 = 𝜙c, 𝜙2 becomes 𝜋∕2,
n1 sin 𝜙c = n2 sin 𝜋∕2
(1.147)
or
sin 𝜙c = n2∕n1.
(1.148)
The angle 𝜙c is called the critical angle. If the angle of incidence is increased beyond the critical angle, the
incident optical ray is reflected completely as shown in Fig. 1.22. This is called total internal reflection (TIR),
and it plays an important role in the propagation of light in optical fibers.
Note that the statement that light chooses the path that takes the least time is not strictly correct. In Fig. 1.16,
the time to go from A to B directly (without passing through the mirror) is the shortest and we may wonder
why light should go through the mirror. However, if we put the constraint that light has to pass through the
mirror, the shortest path would be ACB and light indeed takes that path. In reality, light takes the direct path
n2
n1
n1 > n2
ϕ
ϕ
ϕc
ϕ2 = 90°
Figure 1.22
Total internal reflection when 𝜙> 𝜙c.

Electromagnetics and Optics
25
AB as well as ACB. A more precise statement of Fermat’s principle is that light chooses a path for which
the transit time is an extremum. In fact, there could be several paths satisfying the condition of extremum and
light chooses all those paths. By extremum, we mean there could be many neighboring paths and the change
of time of flight with a small change in the path length is zero to first order.
Example 1.6
The critical angle for the glass–air interface is 0.7297 rad. Find the refractive index of glass.
Solution:
The refractive index of air is close to unity. From Eq. (1.148), we have
sin 𝜙c = n2∕n1.
(1.149)
With n2 = 1, the refractive index of glass, n1 is
n1 = 1∕sin 𝜙c
= 1.5.
(1.150)
Example 1.7
The output of a laser operating at 190 THz is incident on a dielectric medium of refractive index 1.45. Calculate
(a) the speed of light, (b) the wavelength in the medium, and (c) the wavenumber in the medium.
Solution:
(a) The speed of light in the medium is given by
𝑣= c
n
(1.151)
where c = 3 × 108 m/s, n = 1.45, so
𝑣= 3 × 108 m/s
1.45
= 2.069 × 108 m/s.
(1.152)
(b) We have
speed = frequency × wavelength
𝑣= f𝜆m
(1.153)
where f = 190 THz, 𝑣= 2.069 × 108 m/s, so
𝜆m = 2.069 × 108
190 × 1012 m = 1.0889 μm.
(1.154)
(c) The wavenumber in the medium is
k = 2𝜋
𝜆m
=
2𝜋
1.0889 × 10−6 = 5.77 × 106 m−1.
(1.155)

26
Fiber Optic Communications
Example 1.8
The output of the laser of Example 1.7 is incident on a dielectric slab with an angle of incidence = 𝜋∕3, as
shown in Fig. 1.23. (a) Calculate the magnitude of the wave vector of the refracted wave and (b) calculate the
x-component and z-component of the wave vector. The other parameters are the same as in Example 1.7.
Solution:
Using Snell’s law, we have
n1 sin 𝜙1 = n2 sin 𝜙2.
(1.156)
For air n1 ≈1, for the slab n2 = 1.45, 𝜙1 = 𝜋∕3. So,
𝜙2 = sin−1
{sin (𝜋∕3)
1.45
}
= 0.6401 rad.
(1.157)
The electric field intensity in the dielectric medium can be written as
Ey = A cos (𝜔t −kxx −kzz).
(1.158)
(a) The magnitude of the wave vector is the same as the wavenumber, k. It is given by
|k| = k = 2𝜋
𝜆m
= 5.77 × 106 m−1.
(1.159)
(b) The z-component of the wave vector is
kz = k cos (𝜙2) = 5.77 × 106 × cos (0.6401) m−1 = 4.62 × 106 m−1.
(1.160)
The x-component of the wave vector is
kx = k sin (𝜙2) = 5.77 × 106 × sin (0.6401) m−1 = 3.44 × 106 m−1.
(1.161)
x
z
Air
Dielectric slab
n1
n2
ϕ2
ϕ1 = π/3
Figure 1.23
Reflection of light at air–dielectric interface.
1.10
Phase Velocity and Group Velocity
Consider the superposition of two monochromatic electromagnetic waves of frequencies 𝜔0 + Δ𝜔∕2 and
𝜔0 −Δ𝜔∕2 as shown in Fig. 1.24. Let Δ𝜔≪𝜔0. The total electric field intensity can be written as
E = E1 + E2.
(1.162)

Electromagnetics and Optics
27
2
– ω0 –
– ω0 – ω0 +
Δω
2
Δω
2
ω0 –
ω0  ω0 +
Δω
2
Frequency
Amplitude
Δω
Figure 1.24
The spectrum when two monochromatic waves are superposed.
Let the electric field intensity of these waves be
E1 = cos [(𝜔0 −Δ𝜔∕2)t −(k −Δk∕2)z] ,
(1.163)
E2 = cos [(𝜔0 + Δ𝜔∕2)t −(k + Δk∕2)z] .
(1.164)
Using the formula
cos C + cos D = 2 cos
(C + D
2
)
cos
(C −D
2
)
,
Eq. (1.162) can be written as
E = 2 cos (Δ𝜔t −Δkz)
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
field envelope
cos (𝜔0t −k0z)
⏟⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏟
carrier
.
(1.165)
Eq. (1.165) represents the modulation of an optical carrier of frequency 𝜔0 by a sinusoid of frequency Δ𝜔.
Fig. 1.25 shows the total electric field intensity at z = 0. The broken line shows the field envelope and the
solid line shows rapid oscillations due to the optical carrier. We have seen before that
𝑣ph = 𝜔0
k0
is the velocity of the carrier. It is called the phase velocity. Similarly, from Eq. (1.165), the speed with which
the envelope moves is given by
𝑣g = Δ𝜔
Δk
(1.166)
t
Envelope
2
0
Figure 1.25
Superposition of two monochromatic electromagnetic waves. The broken lines and solid lines show the
field envelope and optical carrier, respectively.

28
Fiber Optic Communications
where 𝑣g is called the group velocity. Even if the number of monochromatic waves traveling together is more
than two, an equation similar to Eq. (1.165) can be derived. In general, the speed of the envelope (group
velocity) could be different from that of the carrier. However, in free space,
𝑣g = 𝑣ph = c.
The above result can be proved as follows. In free space, the velocity of light is independent of frequency,
𝜔1
k1
= 𝜔2
k2
= c = 𝑣ph.
(1.167)
Let
𝜔1 = 𝜔0 −Δ𝜔
2 ,
k1 = k0 −Δk
2 ,
(1.168)
𝜔2 = 𝜔0 + Δ𝜔
2 ,
k2 = k0 + Δk
2 .
(1.169)
From Eqs. (1.168) and (1.169), we obtain
𝜔2 −𝜔1
k2 −k1
= Δ𝜔
Δk = 𝑣g.
(1.170)
From Eq. (1.167), we have
𝜔1 = ck1,
𝜔2 = ck2,
𝜔1 −𝜔2 = c(k1 −k2).
(1.171)
Using Eqs. (1.170) and (1.171), we obtain
𝜔1 −𝜔2
k1 −k2
= c = 𝑣g.
(1.172)
In a dielectric medium, the velocity of light 𝑣ph could be different at different frequencies. In general,
𝜔1
k1
≠𝜔1
k2
.
(1.173)
In other words, the phase velocity 𝑣ph is a function of frequency,
𝑣ph = 𝑣ph(𝜔),
(1.174)
k =
𝜔
𝑣ph(𝜔) = k(𝜔).
(1.175)
In the case of two sinusoidal waves, the group speed is given by Eq. (1.166),
𝑣g = Δ𝜔
Δk .
(1.176)
In general, for an arbitrary cluster of waves, the group speed is defined as
𝑣g = lim
Δk→0
Δ𝜔
Δk = d𝜔
dk .
(1.177)

Electromagnetics and Optics
29
Sometimes it is useful to define the inverse group speed 𝛽1 as
𝛽1 = 1
𝑣g
= dk
d𝜔.
(1.178)
𝛽1 could depend on frequency. If 𝛽1 changes with frequency in a medium, it is called a dispersive medium.
Optical fiber is an example of a dispersive medium, which will be discussed in detail in Chapter 2. If the
refractive index changes with frequency, 𝛽1 becomes frequency dependent. Since
k(𝜔) = 𝜔n(𝜔)
c
,
(1.179)
from Eq. (1.178) it follows that
𝛽1(𝜔) = n(𝜔)
c
+ 𝜔
c
dn(𝜔)
d𝜔.
(1.180)
Another example of a dispersive medium is a prism, in which the refractive index is different for different
frequency components. Consider a white light incident on the prism, as shown in Fig. 1.26. Using Snell’s law
for the air–glass interface on the left, we find
𝜙2(𝜔) = sin−1
(sin 𝜙1
n2(𝜔)
)
(1.181)
where n2(𝜔) is the refractive index of the prism. Thus, different frequency components of a white light travel
at different angles, as shown in Fig. 1.26. Because of the material dispersion of the prism, a white light is
spread into a rainbow of colors.
Next, let us consider the co-propagation of electromagnetic waves of different angular frequencies in a
range [𝜔1, 𝜔2] with the mean angular frequency 𝜔0 as shown in Fig. 1.27. The frequency components near
the left edge travel at an inverse speed of 𝛽1(𝜔1). If the length of the medium is L, the frequency components
corresponding to the left edge would arrive at L after a delay of
T1 =
L
𝑣g(𝜔1) = 𝛽1(𝜔1)L.
Similarly, the frequency components corresponding to the right edge would arrive at L after a delay of
T2 = 𝛽1(𝜔2)L.
The delay between the left-edge and the right-edge frequency components is
ΔT = |T1 −T2| = L|𝛽1(𝜔1) −𝛽1(𝜔2)|.
(1.182)
Rainbow
colors
White light
n2
φ1
Figure 1.26
Decomposition of white light into its constituent colors.

30
Fiber Optic Communications
0
Left edge
ω1
ω2
ω0
ω
∣E(ω)∣
Δω
Right edge
Figure 1.27
The spectrum of an electromagnetic wave.
Differentiating Eq. (1.178), we obtain
d𝛽1
d𝜔= d2k
d𝜔2 ≡𝛽2.
(1.183)
𝛽2 is called the group velocity dispersion parameter. When 𝛽2 > 0, the medium is said to exhibit a nor-
mal dispersion. In the normal-dispersion regime, low-frequency (red-shifted) components travel faster than
high-frequency (blue-shifted) components. If 𝛽2 < 0, the opposite occurs and the medium is said to exhibit
an anomalous dispersion. Any medium with 𝛽2 = 0 is non-dispersive. Since
d𝛽1
d𝜔= lim
Δ𝜔→0
𝛽1(𝜔1) −𝛽1(𝜔2)
𝜔1 −𝜔2
= 𝛽2
(1.184)
and
𝛽1(𝜔1) −𝛽1(𝜔2) ≃𝛽2Δ𝜔,
(1.185)
using Eq. (1.185) in Eq. (1.182), we obtain
ΔT = L|𝛽2|Δ𝜔.
(1.186)
In free space, 𝛽1 is independent of frequency, 𝛽2 = 0, and, therefore, the delay between left- and right-edge
components is zero. This means that the pulse duration at the input (z = 0) and output (z = L) would be the
same. However, in a dispersive medium such as optical fiber, the frequency components near 𝜔1 could arrive
earlier (or later) than those near 𝜔2, leading to pulse broadening.
Example 1.9
An optical signal of bandwidth 100 GHz is transmitted over a dispersive medium with 𝛽2 = 10 ps2∕km. The
delay between minimum and maximum frequency components is found to be 3.14 ps. Find the length of
the medium.
Solution:
Δ𝜔= 2𝜋100 Grad/s,
ΔT = 3.14 ps,
𝛽2 = 10 ps2∕km.
(1.187)
Substituting Eq. (1.187) in Eq. (1.186), we find L = 500 m.

Electromagnetics and Optics
31
a
y
x
ax
θ
ay
Figure 1.28
The x- and y-polarization components of a plane wave. The magnitude is |a| =
√
a2
x + a2
y and the angle is
𝜃= tan−1(ay∕ax).
1.11
Polarization of Light
So far we have assumed that the electric and magnetic fields of a plane wave are along the x- and y-directions,
respectively. In general, an electric field can be in any direction in the x–y plane. This plane wave propagates
in the z-direction. The electric field intensity can be written as
E = Axx + Ayy,
(1.188)
Ax = ax exp [i(𝜔t −kz) + i𝜙x],
(1.189)
Ay = ay exp [i(𝜔t −kz) + i𝜙y],
(1.190)
where ax and ay are amplitudes of the x- and y-polarization components, respectively, and 𝜙x and 𝜙y are the
corresponding phases. Using Eqs. (1.189) and (1.190), Eq. (1.188) can be written as
E = a exp [i(𝜔t −kz) + i𝜙x],
(1.191)
a = axx + ay exp (iΔ𝜙)y,
(1.192)
where Δ𝜙= 𝜙y −𝜙x. Here, a is the complex field envelope vector. If one of the polarization components
vanishes (ay = 0, for example), the light is said to be linearly polarized in the direction of the other polarization
component (the x-direction). If Δ𝜙= 0 or 𝜋, the light wave is also linearly polarized. This is because the
magnitude of a in this case is a2
x + a2
y and the direction of a is determined by 𝜃= ±tan−1(ay∕ax) with respect
to the x-axis, as shown in Fig. 1.28. The light wave is linearly polarized at an angle 𝜃with respect to the x-axis.
A plane wave of angular frequency 𝜔is characterized completely by the complex field envelope vector a. It
can also be written in the form of a column matrix, known as the Jones vector:
a =
[
ax
ay exp (iΔ𝜙)
]
.
(1.193)
The above form will be used for the description of polarization mode dispersion in optical fibers.
Exercises
1.1
Two identical charges are separated by 1 mm in vacuum. Each of them experience a repulsive force
of 0.225 N. Calculate (a) the amount of charge and (b) the magnitude of electric field intensity at the
location of a charge due to the other charge.
(Ans: (a) 5 nC; (b) 4.49 ×107 N/C.)

32
Fiber Optic Communications
1.2
The magnetic field intensity at a distance of 1 mm from a long conductor carrying d.c. is 239 A/m. The
cross-section of the conductor is 2 mm2. Calculate (a) the current and (b) the current density.
(Ans: (a) 1.5 A; (b) 7.5 ×105 A/m2.)
1.3
The electric field intensity in a conductor due to a time-varying magnetic field is
E = 6 cos (0.1y) cos (105t)x V/m
(1.194)
Calculate the magnetic flux density. Assume that the magnetic flux density is zero at t = 0.
(Ans: B = −0.6 sin (0.1y) sin (106t)z μT.)
1.4
The law of conservation of charges is given by
∇⋅J + 𝜕𝜌
𝜕t = 0.
Show that Ampere’s law given by Eq. (1.42) violates the law of conservation of charges and Maxwell’s
equation given by Eq. (1.43) is in agreement with the law of conservation of charges.
Hint: Take the divergence of Eq. (1.42) and use the vector identity
∇⋅∇× H = 0.
1.5
The x-component of the electric field intensity of a laser operating at 690 nm is
Ex(t, 0) = 3 rect (t∕T0) cos (2𝜋f0t) V/m,
(1.195)
where T0 = 5 ns. The laser and screen are located at z = 0 and z = 5 m, respectively. Sketch the field
intensities at the laser and the screen in the time and frequency domain.
1.6
Starting from Maxwell’s equations (Eqs. (1.48)–(1.51)), prove that the electric field intensity satisfies
the wave equation
∇2E −1
c2
𝜕2E
𝜕t2 = 0.
Hint: Take the curl on both sides of Eq. (1.50) and use the vector identity
∇× ∇× E = ∇(∇⋅E) −∇2E.
1.7
Determine the direction of propagation of the following wave:
Ex = Ex0 = cos
[
𝜔
(
t −
√
3
2c z + x
2c
)]
.
1.8
Show that
Ψ = Ψ0 exp
[
−(𝜔t −kxx −kyy −kzz)2]
(1.196)
is a solution of the wave equation (1.125) if 𝜔2 = 𝜐2(k2
x + k2
y + k2
z).
Hint: Substitute Eq. (1.196) into the wave equation (1.125).

Electromagnetics and Optics
33
1.9
A light wave of wavelength (free space) 600 nm is incident on a dielectric medium of relative permit-
tivity 2.25. Calculate (a) the speed of light in the medium, (b) the frequency in the medium, (c) the
wavelength in the medium, (d) the wavenumber in free space, and (e) the wavenumber in the medium.
(Ans: (a) 2 × 108 m/s; (b) 500 THz; (c) 400 nm; (d) 1.047 × 107 m−1; (e) 1.57 × 107 m−1.)
1.10
State Fermat’s principle and explain its applications.
1.11
A light ray propagating in a dielectric medium of index n = 3.2 is incident on the dielectric–air inter-
face. (a) Calculate the critical angle; (b) if the angle of incidence is 𝜋∕4, will it undergo total internal
reflection?
(Ans: (a) 0.317 rad; (b) yes.)
1.12
Consider a plane wave making an angle of 𝜋∕6 radians with the mirror, as shown in Fig. 1.29. It
undergoes reflection at the mirror and refraction at the glass–air interface. Provide a mathematical
expression for the plane wave in the air corresponding to segment CD. Ignore phase shifts and losses
due to reflections.
Air
Mirror
Glass, n1 = 1.5
B
30°
A
C
D
x
z
Figure 1.29
Plane-wave reflection at the glass–mirror interface.
1.13
Find the average power density of the superposition of N electromagnetic waves given by
Ex =
N
∑
n=1
An exp [in(𝜔t −kz)].
(1.197)
1.14
A plane electromagnetic wave of wavelength 400 nm is propagating in a dielectric medium of index
n = 1.5. The electric field intensity is
E+ = 2 cos (2𝜋f0t(t −z∕𝑣))x V/m.
(1.198)
(a) Determine the Poynting vector. (b) This wave is reflected by a mirror. Assume that the phase shift
due to reflection is 𝜋. Determine the Poynting vector for the reflected wave. Ignore losses due to prop-
agation and mirror reflections.
1.15
An experiment is conducted to calculate the group velocity dispersion coefficient of a medium of
length 500 m by sending two plane waves of wavelengths 1550 nm and 1550.1 nm. The delay between
these frequency components is found to be 3.92 ps. Find |𝛽2|. The transit time for the higher-frequency
component is found to be less than that for the lower-frequency component. Is the medium normally
dispersive?
(Ans: 100 ps2/km. No.)

34
Fiber Optic Communications
Further Reading
J.D. Jackson, Classical Electrodynamics, 3rd edn. John Wiley & Sons, New York, 1998.
M. Born and E. Wolf, Principles of Optics, 7th edn. Cambridge University Press, Cambridge, 2003.
A. Ghatak and K. Thyagarajan, Optical Electronics. Cambridge University Press, Cambridge, 1998.
W.H. Hayt, Jr., Engineering Electromagnetics, 5th edn. McGraw-Hill, Newyork, 1989.
B.E.A. Saleh and M.C. Teich, Fundamentals of Photonics. John Wiley & Sons, Hoboken, NJ, 2007.
References
[1] R.P. Feynmann, R.B. Leighton, and M. Sands, The Feynman Lectures on Physics, Vol. 1. Addison-Wesley,
New york, 1963.
[2] H.H. Skilling, Fundamentals of Electric Waves, 2nd edn. John Wiley & Sons, New York, 1948.

2
Optical Fiber Transmission
2.1
Introduction
Until the mid-1970s, communication systems transmitted information over copper cables or free space. In
1966, Charles Kao and George Hockham working at Standard Telecommunications in the UK proposed that
an optical fiber might be used as a means of communication provided the signal loss could be much less than
20 dB/km [1]. They also illustrated that the attenuation in fibers available at that time was caused by impurities
which could be removed. At Corning Glass Works, Robert Maurer, Douald Keck, and Peter Schultz worked
with fused silica, a material that can be made extremely pure. In 1970, they developed a single-mode fiber with
attenuation below 20 dB/km [2]. In 1977, the first optical telecommunication system was installed about 1.5
miles under downtown Chicago and each optical fiber carried the equivalent of 672 voice channels. In 1979,
single-mode fibers with a loss of only 0.2 dB/km at 1550 nm were fabricated [3]. The availability of low-loss
fibers combined with the advent of semiconductor lasers led to a new era of optical fiber communication.
Today, more than 80% of the world’s long-distance traffic is carried over optical fiber cable and about 25
million kilometers of optical fiber has been installed worldwide.
This chapter deals with light propagation in optical fibers. Multi-mode and single-mode fibers are discussed
using a ray-optics description in Section 2.3. A rigorous solution of the wave equation is derived in Section 2.4,
and a wave-optics description of the single-mode and multi-mode fibers is presented. Pulse propagation in
single-mode fibers is discussed in Section 2.5. The comparison between single-mode fibers and multi-mode
fibers is made in Section 2.6. Section 2.7 focuses on the design of single-mode fibers.
2.2
Fiber Structure
An optical fiber consists of a central core clad with a material of slightly lower refractive index, as shown in
Fig. 2.1. If the refractive index of the core is constant, such a fiber is called a step-index fiber. Most of the
fibers are made from glass, i.e., silica. The refractive index of the core is increased by doping the silica with
GeO2. The cladding is pure silica. A polymer jacket is used to protect the fiber from moisture and abrasion.
For short-distance (<1 km) and low-bit-rate (∼Mb/s) transmission systems, plastic fibers can be used. They
are: (i) inexpensive, (ii) flexible, and (iii) easy to install and connect. However, they do not transmit light
efficiently because of high absorption. For long-distance and high-bit-rate systems, glass fibers are typically
used. Optical fibers have the following advantages over copper cable.
(i) Bandwidth: To transmit more bits of information in a given time period, the transmission medium should
have a high bandwidth. Typically, the bandwidth is of the order of the carrier frequency. In the case of
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

36
Fiber Optic Communications
Cladding
Core
Polymer jacket
Radial distance
Index
n0
n2
n1
Figure 2.1
Refractive index profile and cross-section of a step-index fiber.
optical signals, the carrier frequency is 200 THz and the bandwidth of the fiber is several THz, whereas
the bandwidth of the copper cable is typically several GHz or MHz.
(ii) Attenuation: The loss of a silica optical fiber is around 0.2 dB/km, which is much lower than that of
copper cable. Because of the lower loss, optical signals can propagate over a longer distance without
requiring repeaters.
(iii) Electromagnetic interference (EMI): Optical fibers are not affected by electromagnetic interference. This
is because optical fibers are purely dielectric waveguides with no metal parts. In the case of copper cables,
electromagnetic noise fields set up conduction currents which interfere with the signal transmission.
2.3
Ray Propagation in Fibers
Consider a step-index fiber with core index n1 greater than the cladding index n2. Let 𝜙c be the critical angle.
Consider a ray with an angle 𝜙> 𝜙c, as shown in Fig. 2.2. This ray undergoes total internal reflection at B.
The reflected ray BC undergoes total internal reflection again at C. This process continues till the output end
and is called frustrated total internal reflection. With this mechanism, light is successfully transmitted from
the input end to the output end of the fiber.
B
ø ø
ø ø
A
C
E
Core
n2
n1
D
Figure 2.2
Signal propagation in a fiber by frustrated total internal reflection.

Optical Fiber Transmission
37
Reflective coating
Silica core
Figure 2.3
Signal propagation in a fiber by repeated normal reflections.
The power reflection coefficient may be defined as
Rp = reflected power
incident power .
(2.1)
In the case of total internal reflection, Rp = 1, which means all the power of the incident ray appears in
the reflected ray. That is why it is called total internal reflection (TIR). In contrast, the normal reflection is
always accompanied by refraction and Rp < 1. Suppose the core of a silica fiber is surrounded by a reflective
coating instead of a dielectric cladding, as shown in Fig. 2.3. In this case, the light is guided by the “normal”
reflections at the interface. By choosing a coating with high reflectivity, the power loss during each reflection
can be minimized. However, significant power is lost after multiple reflections. In contrast, TIR is a more
efficient way to transmit an optical signal over a long distance.
2.3.1
Numerical Aperture
Consider a ray which is incident on the fiber input making an angle i as shown in Fig. 2.4. Using Snell’s law,
we have
sin i = n1 sin 𝜃= n1 cos 𝜙,
(2.2)
where we have assumed the refractive index of air to be unity. If this ray has to suffer total internal reflection
at the core–cladding interface, the angle 𝜙should be larger than the critical angle 𝜙c,
𝜙> 𝜙c,
sin 𝜙> sin 𝜙c.
(2.3)
Jacket
B
A
C
Air,
Jacket
Cladding, n= n2
Core, n =n1
i
 n= 1
θ ø
Figure 2.4
Numerical aperture of the fiber. If the incidence angle i is less than the acceptance angle, it undergoes total
internal reflection.

38
Fiber Optic Communications
Jacket
Jacket
imax
i
i
Jacket
(a)
Jacket
(b)
Cladding
Cladding
Core
Core
Figure 2.5
(a) If i ≤imax, light is guided. (b) If i > imax, light escapes from the core.
Using Eq. (1.148), we obtain
n2
1sin2𝜙> n2
2
or
n2
1cos2 𝜙< n2
1 −n2
2.
(2.4)
Using Eqs. (2.2) and (2.4), it follows that, to have a total internal reflection, we should have the following
condition:
sin i < (n2
1 −n2
2)1∕2.
(2.5)
If (n2
1 −n2
2)1∕2 > 1, total internal reflection occurs for any incidence angle i. But for most of the practical
fiber designs, (n2
1 −n2
2)1∕2 ≪1. In this case, as the angle of incidence i increases, 𝜙decreases and the light
ray could escape the core–cladding interface without total internal reflection. From Eq. (2.5), the maximum
value of sin i for a ray to be guided is given by
sin imax = (n2
1 −n2
2)1∕2.
(2.6)
Therefore, the numerical aperture (NA) of the fiber is defined as
NA = sin imax = (n2
1 −n2
2)1∕2,
(2.7)
and imax is called the acceptance angle. Let us define the relative index difference as
Δ = n1 −n2
n1
.
(2.8)
If the difference between n1 and n2 is small, n1 + n2 ≈2n1 and Eq. (2.7) can be approximated as
NA ≈n1(2Δ)1∕2.
(2.9)
Let us construct a cone with the semi-angle being equal to imax, as shown in Fig. 2.5(a). If the incident ray
is within the cone (i < imax), it will be guided through the fiber. Otherwise, it will escape to the cladding and
then to the jacket, as shown in Fig. 2.5(b). From a practical standpoint, it is desirable to have most of the
source power launched to the fiber, which requires large NA.
Example 2.1
The core and cladding refractive indices of a multi-mode fiber are 1.47 and 1.45, respectively. Find (a) the
numerical aperture, (b) the acceptance angle, and (c) the relative index difference Δ.

Optical Fiber Transmission
39
Solution:
(a) n1 = 1.47, n2 = 1.45. From Eq. (2.7), we find
NA = (n2
1 −n2
2)1∕2 = 0.2417.
(2.10)
(b) From Eq. (2.6), the acceptance angle is
imax = sin−1(NA) = 0.2441 rad.
(2.11)
(c) From Eq. (2.8), the refractive index difference Δ is
Δ = n1 −n2
n1
= 0.0136.
(2.12)
2.3.2
Multi-Mode and Single-Mode Fibers
If the index difference (n1 −n2) is large or the core radius a is much larger than the wavelength of light, an
optical fiber supports multiple guided modes. A guided mode can be imagined as a ray that undergoes total
internal reflection. A mathematical description of guided modes is provided in Section 2.4. From ray-optics
theory, it follows that total internal reflection occurs for any angle in the interval [𝜙c, 𝜋∕2]. This implies an
infinite number of guided modes. However, from the wave-optics theory, it follows that not all the angles in the
interval [𝜙c, 𝜋∕2] are permitted. Light guidance occurs only at discrete angles {𝜙1, 𝜙2, · · · } in the interval
[𝜙c, 𝜋∕2], as shown in Fig. 2.6. Each discrete angle in Fig. 2.6 corresponds to a guided mode. Typically, a
multi-mode fiber can support thousands of guided modes. As the index difference (n1 −n2) becomes very
large and/or the core diameter becomes much larger than the wavelength of light, the fiber supports a very
large number of modes N which approaches infinity, and total internal reflection occurs for nearly any angle in
the interval [𝜙c, 𝜋∕2]. In this case, the ray-optics theory is valid. As the index difference (n1 −n2) becomes
smaller and/or the core diameter becomes comparable with the wavelength of light, the number of guided
modes decreases. In fact, by the proper design, a fiber could support only one guided mode (in ray-optics
language, one ray with a specific angle). Such a fiber is called a single-mode fiber, which is of significant
importance for high-speed optical communication.
2.3.3
Dispersion in Multi-Mode Fibers
A light pulse launched into a fiber broadens as it propagates down the fiber because of the different times
taken by different rays or modes to propagate through the fiber. This is known as intermodal dispersion. In
Fig. 2.7, the path length of ray 1 is longer than that of ray 3 and, therefore, the fraction of the incident pulse
carried by ray 3 arrives earlier than that by ray 1, leading to pulse broadening.
Core diameter = 2a
ø1
ø2
ø2
ø1
øc
n1
n2
Figure 2.6
When the angle of incidence exceeds 𝜙c, total internal reflection occurs only for certain discrete angles.

40
Fiber Optic Communications
Input pulse
Input pulse
Output pulse
1
1 2
3
2
3
Figure 2.7
Pulse broadens because of the different times taken by different rays to pass through the fiber.
Suppose an impulse is launched to the fiber. Let us now estimate the pulse width at the output end. For a
ray making an angle 𝜙with the axis (see Fig. 2.8), the distance AB is traversed in time
tAB = AC + CB
𝑣1
=
AB
𝑣1 sin 𝜙,
(2.13)
where 𝑣1 = c∕n1 is the speed of light in the core. ACB can be imagined as one unit cell. Let the fiber length
L be composed of N such unit cells. The time taken by the ray to traverse a fiber length L is
tL = N(AB)n1
c sin 𝜙
=
n1L
c sin 𝜙.
(2.14)
For multi-mode fibers, we assume that all the rays making angles in the interval [𝜙c, 𝜋∕2] are present.
This is a good approximation if the multi-mode fiber supports many modes. The ray which makes an angle
𝜙= 𝜋∕2 propagates almost along the axis and takes the shortest time. From Eq. (2.14), the time taken by this
ray is
tmin =
n1L
c sin 𝜋∕2 = n1L
c .
(2.15)
The ray which makes an angle 𝜙= 𝜙c takes the longest time. The time taken by this ray is
tmax =
n1L
c sin 𝜙c
=
n2
1L
cn2
.
(2.16)
The time taken by a ray with angle 𝜙in the interval [𝜙c, 𝜋∕2] is somewhere in between tmin and tmax. If an
impulse is incident at the input end, it would excite all the rays in the interval [𝜙c, 𝜋∕2] and the rays occupy
a time interval at the output end of duration ΔT given by
ΔT = tmax −tmin =
n2
1L
cn2
−n1L
c
= n1L
c
(n1
n2
−1
)
=
n2
1LΔ
cn2
,
(2.17)
AC sin ø
BC sin ø
B
A
C
ø
ø
ø
ø
n2
n1
n2
Figure 2.8
A ray undergoing multiple total internal reflections in a multi-mode fiber.

Optical Fiber Transmission
41
Power (arb. units)
Power (arb. units)
(a)
(b)
TB
ΔT
t
t
Figure 2.9
The pulse train at (a) fiber input and (b) fiber output. The individual pulses shown here are outputs in the
absence of input pulses at the other bit slots.
where Δ is defined in Eq. (2.8). Fig. 2.9(b) shows the power profiles of individual pulses in the absence of
other pulses. The pulse width at the output end is ΔT, as shown in Fig. 2.9(b). If the bit rate is B, the interval
between bits is given by
TB = 1
B.
(2.18)
To avoid intersymbol interference, the pulse width ΔT ≤TB. Using Eqs. (2.17) and (2.18), we have
BL ≤cn2
n2
1Δ
.
(2.19)
Eq. (2.19) provides the maximum bit rate–distance product possible for multi-moded fibers. From Eq. (2.19),
we see that the product BL can be maximized by decreasing Δ, but from Eq. (2.9), we see that it leads to a
reduction in NA, which is undesirable since it lowers the power launched to the fiber. So, there is a trade-off
between power coupling efficiency and the maximum achievable bit rate–distance product.
From a practical standpoint, it is desirable to reduce the delay ΔT. From Eq. (2.17), we see that the delay
ΔT increases linearly with fiber length L. The quantity ΔT∕L is a measure of intermodal dispersion.
Example 2.2
Consider a multi-mode fiber with n1 = 1.46, Δ = 0.01, and fiber length L = 1 km. From Eq. (2.8)
n2 = n1(1 −Δ) = 1.4454
(2.20)
and
ΔT =
n2
1LΔ
cn2
≈50 ns.
(2.21)

42
Fiber Optic Communications
Power (arb. units)
Power (arb. units)
50 ns
50 ns
10 ns
500 ns
500 ns
(a)
(b)
Time
Time
Figure 2.10
A pulse train at the fiber output: (a) bit rate B = 2 Mb/s; (b) B = 100 Mb/s. The individual pulses shown
here are the outputs in the absence of input pulses at the other bit slots.
This implies that an impulse traversing through the fiber becomes a pulse of duration about 50 ns. If
B = 2 Mb/s, TB = 500 ns and the pulses at the output end are quite resolvable, as shown in Fig. 2.10(a).
However, if the bit interval is 10 ns (B = 100 Mb/s), the pulses would be absolutely unresolvable at the output
end, as shown in Fig. 2.10(b). From Eq. (2.19), the maximum bit rate–distance product is
(BL)max = cn2
n2
1Δ
= 20.3 Mb∕s km.
(2.22)
This implies that the maximum achievable bit rate is 20.3 Mb/s for a system consisting of a 1-km fiber. Note
that the power profiles in Fig. 2.10 are those of individual pulses in the absence of other pulses. To find the
actual power profiles, the fields of individual pulses should be added and then the power of the combined field
should be calculated.
2.3.4
Graded-Index Multi-Mode Fibers
In a step-index multi-mode fiber, the pulse width at the output is given by
ΔT =
n2
1LΔ
cn2
.
(2.23)
To minimize this delay, graded-index multi-mode fibers are used. The refractive index profile, in this case, is
given by
n(r) =
{
n1
[1 −Δ(r∕a)𝛼]
if
r < a
n2 = n1(1 −Δ)
otherwise,

Optical Fiber Transmission
43
(a)
(b)
(c)
n1
a
a
a
r
r
n2
n(r)
n1
n2
n(r)
r
n1
n2
n(r)
Figure 2.11
(a) Parabolic index profile. (b) Triangular index profile. (c) Step-index fiber.
A : High speed, long route
B : Low speed, short route
Home
Office
Figure 2.12
Two paths to connect home and office which could take roughly the same time.
where a is the core radius, n2 is the cladding index, n1 is the core index at r = 0, Δ = (n1 −n2)∕n1, and
𝛼determines the index profile. When 𝛼= 2, such a profile is called a parabolic index profile, as shown in
Fig. 2.11(a). When 𝛼= ∞, we get a step-index profile. A rigorous mathematical calculation shows that, if
𝛼= 2(1 −Δ)(≈2), the pulse width, ΔT, is a minimum and is given by [4, 5]
ΔT = n1Δ2L
8c
.
(2.24)
From Eqs. (2.23) and (2.24), we see that the pulse broadening is proportional to Δ in step-index fibers whereas
it is proportional to Δ2 in graded-index fibers (with 𝛼= 2(1 −Δ)). Since Δ ≪1, pulse broadening can be
significantly reduced using graded-index fibers.
The reduction in pulse delay can be understood from the following analogy: suppose A takes a highway to
go to the office from his home which is faster, but longer distance, as shown in Fig. 2.12. B takes a shorter route
but there are many traffic lights, leading to delays. It is possible that A and B arrive at the same time to the
office, which implies that there is no delay between the arrival times of A and B. In the case of graded-index
fibers, the axial ray is confined mostly to the core center (because it undergoes total internal reflection closer
to the center of the core due to the higher refractive index) and travels slowly because of the higher refractive
index. The off-axis ray travels faster because it passes through the region of lower refractive index. But it
has to travel a longer zig-zag path. So, the arrival time difference between these rays could be smaller. This
explains why the delay given by Eq. (2.24) is smaller than that given by Eq. (2.23).
Example 2.3
Compare ΔT for a step-index fiber with that for a parabolic-index fiber. Length = 1 km, n1 = 1.47, and
n2 = 1.45.

44
Fiber Optic Communications
Solution:
Δ = n1 −n2
n1
= 0.0136.
(2.25)
For a step-index fiber, from Eq. (2.23), we find
ΔT =
n2
1LΔ
cn2
= 67.58 ns.
(2.26)
For a parabolic-index fiber, from Eq. (2.24), we find
ΔT =
n2
1Δ2L
8c
= 0.1133 ns.
(2.27)
Thus, we see that the intermodal dispersion can be significantly reduced by using a parabolic-index fiber.
2.4
Modes of a Step-Index Optical Fiber∗
To understand the electromagnetic field propagation in optical fibers, we should solve Maxwell’s equations
with the condition that the tangential components of electric and magnetic fields should be continuous at the
interface between core and cladding [6, 7]. When the refractive index difference between core and cladding
is small, a weakly guiding or scalar wave approximation can be made [8–11] and in this approximation, the
electromagnetic field is assumed to be nearly transverse as in the case of free-space propagation. Under this
approximation, the one set of modes consists of Ex and Hy components (x-polarized) and the other set of
modes consists of Ey and Hx components (y-polarized). These two sets of modes are independent and known
as linearly polarized (LP) modes. The x- or y- component of the electric field intensity satisfies the scalar
wave equation Eq. (1.125),
∇2𝜓−
1
𝜐2(r)
𝜕2𝜓
𝜕t2 = 0,
(2.28)
where 𝜐(r) is the speed of light given by
𝜐(r) =
c
n(r)
(2.29)
with
n(r) =
{
n1 for r < a
n2 for r ≥a ,
(2.30)
where a = core radius. We assume that n1 > n2, as shown in Fig. 2.13. In cylindrical coordinates, the Laplacian
operator ∇2 can be written as
∇2𝜓= 𝜕2𝜓
𝜕r2 + 1
r
𝜕𝜓
𝜕r + 1
r2
𝜕2𝜓
𝜕𝜙2 + 𝜕2𝜓
𝜕z2 .
(2.31)
Suppose this fiber is excited with a laser oscillating at angular frequency 𝜔. In a linear dielectric medium,
the frequency of the electromagnetic field should be the same as that of the source. Therefore, we look for a
solution of Eq. (2.28) in the form
Ψ(r, 𝜙, z, t) = f(r, 𝜙, z)e−i𝜔t.
(2.32)

Optical Fiber Transmission
45
Core
a
r
Refractive index
Cladding
n1
n2
Figure 2.13
Refractive-index profile of a step-index fiber.
Substituting Eq. (2.32) in Eq. (2.28) and using Eqs. (2.29) and (2.31), we obtain
𝜕2f
𝜕r2 + 1
r
𝜕f
𝜕r + 1
r2
𝜕2f
𝜕𝜙2 + 𝜕2f
𝜕z2 + k2
0n2(r)f = 0,
(2.33)
where k0 = 𝜔∕c = 2𝜋∕𝜆0 is the free-space wavenumber. The above equation is known as the Helmholtz
equation. We solve Eq. (2.33) by separation of variables:
f(r, 𝜙, z) = R(r)Φ(𝜙)Z(z).
(2.34)
This technique may not work for all types of partial differential equations. Especially, if the partial differential
equation is nonlinear, the method of separation of variables fails. Substituting Eq. (2.34) in Eq. (2.33), we
obtain
(
d2R
dr2 + 1
r
dR
dr
)
ΦZ + 1
r2
d2Φ
d𝜙2 RZ + d2Z
dz2 RΦ + k2
0n2(r)RΦZ = 0.
(2.35)
Dividing Eq. (2.35) by RΦZ, we obtain
1
R
(
d2R
dr2 + 1
r
dR
dr
)
+ k2
0n2(r) +
1
Φr2
d2Φ
d𝜙2 = −d2Z
dz2
1
Z .
(2.36)
In Eq. (2.34), we assumed that f can be decomposed into three parts R, Φ, and Z which are functions of r,
𝜙, and z, respectively. Since the right-hand side of Eq. (2.36) depends only on z while the left-hand side of
Eq. (2.36) depends only on R and Φ, they can be equated only if each of them is a constant independent of r,
𝜙, and z. Let this constant be 𝛽2:
−1
Z
d2Z
dz2 = 𝛽2,
(2.37)
Z(z) = A1ei𝛽z + A2e−i𝛽z.
(2.38)
Using Eq. (2.34) and substituting Eq. (2.38) in Eq. (2.32), we obtain
𝜓(r, 𝜙, z, t) = R(r)Φ(𝜙) [A1e−i(𝜔t−𝛽z) + A2e−i(𝜔t+𝛽z)] .
(2.39)
The first and second terms represent forward- and backward-propagating waves, respectively. In this section,
let us consider only the forward-propagating modes by setting A2 = 0. For example, the laser output is
launched to the fiber from the left so that only forward-propagating modes are excited. If the fiber medium has

46
Fiber Optic Communications
no defect, there would be no reflection occurring within the fiber and the assumption of a forward-propagating
mode is valid. From the left-hand side of Eq. (2.36), we obtain
r2
R
(
d2R
dr2 + 1
r
dR
dr
)
+ r2 [k2
0n2(r) −𝛽2] = −1
Φ
d2Φ
d𝜙2 .
(2.40)
The left-hand side of Eq. (2.40) is a function of r only and the right-hand side is a function of 𝜙only. As
before, each of these terms should be a constant. Let this constant be m2:
−1
Φ
d2Φ
d𝜙2 = m2,
(2.41)
Φ(𝜙) = B1eim𝜙+ B2e−im𝜙.
(2.42)
The first and second terms represent the modes propagating in counter-clockwise and clockwise directions,
respectively, when m is positive. Let us consider only one set of modes, say counter-clockwise modes, and set
B2 = 0. If the initial conditions at the input end of the fiber are such that both types of modes are excited, we
can not ignore the second term in Eq. (2.42). In Section 2.4.6, we will study how to combine various modes
to satisfy the given initial conditions. Using Eq. (2.41) in Eq. (2.40), we obtain
d2R
dr2 + 1
r
dR
dr +
[
k2
0n2(r) −𝛽2 −m2
r2
]
R = 0.
(2.43)
Using Eq. (2.30) for n2(r), we obtain
d2R
dr2 + 1
r
dR
dr −m2
r2 R + (k2
0n2
1 −𝛽2)R = 0
r < a,
(2.44)
d2R
dr2 + 1
r
dR
dr −m2
r2 R + (k2
0n2
2 −𝛽2)R = 0
r ≥a.
(2.45)
Fiber modes can be classified into two types: (i) k2
0n2
2 < 𝛽2 < k2
0n2
1–these modes are called guided modes
and (ii) 𝛽2 < k2
0n2
2–these modes are called radiation modes. It can be shown that there exists no mode when
𝛽2 > k2
0n2
1.
2.4.1
Guided Modes
Since 𝛽2 < k2
0n2
1, the last term in Eq. (2.44) is positive and the solution of Eq. (2.44) for this case is given by
the Bessel functions
R(r) = C1Jm(𝛼1r) + C2Ym(𝛼1r),
r ≤a,
(2.46)
where 𝛼1 =
√
k2
0n2
1 −𝛽2, Jm(𝛼1r) and Ym(𝛼1r) are the Bessel functions of first kind and second kind, respec-
tively, and are plotted in Fig. 2.14. The solution Ym(𝛼1r) has to be rejected, since it becomes −∞as r →0.
Therefore,
R(r) = C1Jm(𝛼1r),
r ≤a.
(2.47)
Since 𝛽2 > k2
0n2
2, the last term in Eq. (2.45) is negative. The solution of Eq. (2.45) is given by the modified
Bessel function
R(r) = D1Km(𝛼2r) + D2Im(𝛼2r),
r ≥a,
(2.48)

Optical Fiber Transmission
47
0
5
10
15
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
x
Jm
Ym
J0(x)
Y0(x)
Y1(x)
Y2(x)
Y3(x)
J2(x) J3(x)
J1(x)
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
–50
–40
–30
–20
–10
0
10
x
(a)
(b)
Figure 2.14
Bessel functions of (a) the first kind and (b) the second kind.
0
1
2
3
4
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
x
0
1
2
3
4
5
0
0.5
1
1.5
2
2.5
3
3.5
4
4.5
5
x
Km
Im
I0(x)
I1(x)
I2(x)
I3(x)
K3(x)
K2(x)
K1(x)
K0(x)
(a)
(b)
Figure 2.15
Modified Bessel function of (a) the first kind and (b) the second kind.
where 𝛼2 =
√
𝛽2 −k2
0n2
2. Im(𝛼2r) and Km(𝛼2r) are modified Bessel functions of the first and second kind,
respectively, and are plotted in Fig. 2.15. The solution Im(𝛼2r) has to be rejected since it becomes infinite as
r →∞. Therefore,
R(r) = D1Km(𝛼2r),
r ≥a.
(2.49)
Now we make use of the fact that R and dR∕dr should be continuous at the core–cladding interface. If dR∕dr
is not continuous, d2R∕dr2 will be a Dirac delta function centered at the interface and from Eq. (2.43), we find
that d2R∕dr2 could be a Dirac delta function only if the refractive index at the interface is infinity. Otherwise,
Eq. (2.43) will not be satisfied at the interface. Since the refractive index is finite, it follows that dR∕dr is
continuous at the interface. Similarly, it can be proved that R(r) is continuous at the interface. Continuity of

48
Fiber Optic Communications
R(r) and dR∕dr at the core–cladding interface leads to the following equations:
C1Jm(𝛼1a) = D1Km(𝛼2a),
(2.50)
C1𝛼1J
′
m(𝛼1a) = D1𝛼2K
′
m(𝛼2a),
(2.51)
where
′ denotes differentiation with respect to the argument. Dividing Eq. (2.51) by Eq. (2.50), we obtain the
following eigenvalue equation:
J′
m(𝛼1a)
Jm(𝛼1a) = 𝛼2
𝛼1
K′
m(𝛼2a)
Km(𝛼2a)
(2.52)
where
𝛼1 =
√
k2
0n2
1 −𝛽2
(2.53)
and
𝛼2 =
√
𝛽2 −k2
0n2
2.
(2.54)
Note that in Eq. (2.52), the only unknown parameter is the propagation constant 𝛽. It is not possible to solve
Eq. (2.52) analytically. Eq. (2.52) may be solved numerically to obtain the possible values of 𝛽. It would be
easier to solve Eq. (2.52) numerically if we avoid differentiations in Eq. (2.52). This can be done using the
following identities:
𝛼1aJ′
m(𝛼1a) = −mJm(𝛼1a) + 𝛼1aJm−1(𝛼1a),
(2.55)
𝛼2aK′
m(𝛼2a) = −mKm(𝛼2a) −𝛼2aKm−1(𝛼2a).
(2.56)
Using Eqs. (2.55) and (2.56) in Eq. (2.52), we obtain
Jm−1(𝛼1a)
Jm(𝛼1a)
= −𝛼2
𝛼1
Km−1(𝛼2a)
Km(𝛼2a) .
(2.57)
The propagation constants 𝛽obtained after solving Eq. (2.57) lie in the interval [k0n2, k0n1]. It is convenient
to define the normalized propagation constant
b =
𝛽2∕k2
0 −n2
2
n2
1 −n2
2
(2.58)
so that when 𝛽= k0n2, b = 0 and when 𝛽= k0n1, b = 1. For any guided mode of a step-index fiber, we have
0 < b < 1. Eq. (2.57) can be solved for various design parameters such as wavelength 𝜆and core radius a, and
the numerically calculated propagation constant 𝛽can be plotted as a function of a specific design parameter.
Instead, it is more convenient to define the normalized frequency
V = a
√
𝛼2
1 + 𝛼2
2 = k0a
√
n2
1 −n2
2
= 2𝜋fa
c
(n2
1 −n2
2)1∕2,
(2.59)
where f is the mean frequency of the light wave. Using Eq. (2.7), Eq. (2.59) may be rewritten as
V = 2𝜋a
𝜆NA.
(2.60)

Optical Fiber Transmission
49
Figure 2.16
Plot of normalized propagation constant b versus normalized frequency V.
The solutions of Eq. (2.57) for a normalized propagation constant b as a function of normalized frequency V
give us universal curves as shown in Fig. 2.16.
To solve Eq. (2.57), we first calculate V using Eq. (2.59). Let us first set m = 0. Since Eq. (2.57) is an
implicit function of b, the left-hand side and right-hand side of Eq. (2.57) are plotted for various values of b in
the interval [0, 1]. The point of intersection of the curves corresponding to the left-hand side and right-hand
side of Eq. (2.57) gives the normalized propagation constant b of the guided mode supported by the fiber.
As can be seen from Fig. 2.17, there can be many intersections which means there are several guided-mode
solutions. This procedure is repeated for m = 1, 2, … , M. For m = M + 1, we find that Eq. (2.57) admits no
solution. When there is only one intersection (M = 1), such a fiber is called a single-mode fiber. The values
of b corresponding to the intersections for a particular value of V are shown in Fig. 2.16 by the broken lines.
This process is repeated for different values of V.
The advantage of the universal curve shown in Fig. 2.16 is that it can be used for a step-index fiber with
arbitrary refractive indices and core radius. The dependence of the propagation constant 𝛽on the specific
design parameter can be extracted from Fig. 2.16 using Eqs. (2.58) and (2.59).
For many applications, it is required to obtain the frequency dependence of propagation constant 𝛽in a
single-mode fiber. This information can be obtained from Fig. 2.16. For the given fiber parameters and for the
desired range of frequencies, V-parameters are calculated using Eq. (2.59). Using Fig. 2.16, the corresponding
normalized propagation constants, b are calculated (corresponding to LP01) and with the help of Eq. (2.58),
propagation constants 𝛽for this range of frequencies can be calculated. For a specific value of m, Eq. (2.57)
has a finite number of solutions and the nth solution is known as the LPmn mode. LP stands for linearly
polarized mode. Under the weakly guiding approximation, the electromagnetic field is nearly transverse and
each LP mode corresponds to either an x-polarized or a y-polarized mode. For an ideal cylindrical fiber, the
propagation constants of the x-polarized LPmn and the y-polarized LPmn are identical. When the refractive

50
Fiber Optic Communications
Figure 2.17
Left-hand side (LHS) and right-hand side (RHS) of Eq. (2.57) as a function of b. V = 8.
index difference between the core and the cladding is large, a weakly guiding approximation is not valid.
Under this condition, Ez and/or Hz could be nonzero [5, 12].
Suppose one of the solutions of Eq. (2.57) is 𝛽mn. Using Eqs. (2.47), (2.49), (2.42), and (2.39), the electric
field distribution of this guided mode can be written as
𝜓=
{
C1Jm
(𝛼1r) e−i(𝜔t−𝛽mnz−im𝜙)
for
r ≤a
D1Km(𝛼2r)e−i(𝜔t−𝛽mnz−im𝜙)
for
r ≥a.
(2.61)
From Eq. (2.50), we have
D1 = C1Jm(𝛼1a)
Km(𝛼2a) .
(2.62)
Using Eq. (2.62) in Eq. (2.61), we see that the only unknown parameter in Eq. (2.61) is C1, which can be
determined from the average power carried by this guided mode. In Section 1.7, the average power density
carried by an electromagnetic wave in a homogeneous medium is found to be
av
z
= |𝜓|2
2𝜂.
(2.63)
Under the weakly guiding approximation, the field is nearly transverse and Eq. (2.63) may be used to calculate
the power. The total power carried by a mode is [8, 9]
Ptot = |C1|2
{
∫
2𝜋
0
∫
a
0
J2
m
(𝛼1r)
2𝜂1
rdrd𝜙+ ∫
2𝜋
0
∫
∞
a
J2
m(𝛼1a)
2𝜂2K2
m(𝛼2a)
K2
m(𝛼2r)rdrd𝜙
}
= Fmn|C1|2,
(2.64)

Optical Fiber Transmission
51
where 𝜂1 and 𝜂2 are the characteristic impedances of core and cladding, respectively. Fmn can be determined
after performing the integrations in Eq. (2.64) numerically. Eq. (2.61) can be normalized so that the power
carried by this mode is unity,
Ptot = 1
or
C1 =
1
√
Fmn
(2.65)
and
𝜓= Rmn(r)e−i(𝜔t−𝛽mnz−im𝜙),
(2.66)
where
Rmn(r) =
{Jm
(𝛼1r) ∕
√
Fmn
for
r ≤a
[Jm(𝛼1a)∕Km(𝛼2a)]Km(𝛼2r)∕
√
Fmn
for
r > a
.
(2.67)
Figs. 2.18–2.21 show the optical intensity as a function of radial distance for various LPmn modes. The total
number of guided modes M is given by an approximate expression [4, 13],
M ≅V2
2 .
(2.68)
2.4.2
Mode Cutoff
Fig. 2.16 shows the plot of normalized propagation constant b as a function of normalized frequency V
obtained by solving Eq. (2.57). From Fig. 2.16, we see that when V = 10, there are six possible values of
b which means there are six guided modes. From Eq. (2.59), it follows that V is large if the ratio of core
radius to wavelength is large or the index difference is large. When V = 3, the fiber supports two modes, LP01
and LP11. From Fig. 2.16, we see that when V < 2.4048, the fiber supports only one mode. This can be proved
as follows. Any LPmn mode ceases to exist when b < 0 because it then corresponds to a radiation mode, since
𝛽< k0n2 (Eq. (2.58)). For LP11 mode, when 𝛽= k0n2, using Eqs. (2.54) and (2.58), we obtain
𝛼2 = 0
and
b = 0.
(2.69)
–1
–0.5
0
0.5
1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Figure 2.18
Optical field and power distributions of LP01 mode. V = 5 and b = 0.84.

52
Fiber Optic Communications
–1
–0.5
0
0.5
1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Figure 2.19
Optical field and power distributions of LP02 mode. V = 5.3 and b = 0.278.
–1
–0.5
0
0.5
1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Figure 2.20
Optical field and power distributions of LP11 mode. V = 4 and b = 0.44.
In this case, using Eq. (2.53) in Eq. (2.59), we find V = 𝛼1a and with m = 1, Eq. (2.57) becomes
J0(V) = 0.
(2.70)
The first zero of the zeroth-order Bessel function (Fig. 2.14) occurs at V = 2.4048. Therefore, LP11 ceases
to exist if V < 2.4048. Thus, when 0 < V < 2.4048, the fiber supports only LP01 mode. In other words, to
ensure that the fiber is single-moded, V should be smaller than 2.4048.
2.4.3
Effective Index
From Eq. (2.39), we find that the forward-propagating mode can be written as
𝜓(r, 𝜙, z, t) = A1R(r)Φ(𝜙) exp [−i(𝜔t −𝛽z)].
(2.71)

Optical Fiber Transmission
53
–0.5
0.5
–1
0
1
–1
–0.8
–0.6
–0.4
–0.2
0
0.2
0.4
0.6
0.8
1
Figure 2.21
Optical field and power distributions of LP22 mode. V = 10.3 and b = 0.456.
In analogy with a 1-dimensional plan wave (Section 1.6.1), the phase speed of this mode can be written as
𝑣= 𝜔
𝛽.
(2.72)
The phase speed of an electromagnetic wave propagating in a uniform medium of refractive index neff is
𝑣=
c
neff
.
(2.73)
Combining Eqs. (2.72) and (2.73), we find
𝛽= 𝜔
c neff = k0neff.
(2.74)
Thus, neff can be interpreted as the effective index “seen” by the mode with propagating constant 𝛽. Guided
modes occur if k0n2 < 𝛽< k0n1 or n2 < neff < n1.
2.4.4
2-Dimensional Planar Waveguide Analogy
Consider a 2-D planar waveguide as shown in Fig. 2.22. Let
n(x) =
{
n1
for
|x| < d∕2
n2
otherwise
Figure 2.22
A 2-dimensional planar waveguide.

54
Fiber Optic Communications
and n1 > n2. For simplicity, let us ignore the variations with respect to the y-coordinate. The ray AB corre-
sponds to a plane wave,
Eincident = Ae−i𝜔t+i(𝛼x+i𝛽z).
(2.75)
There is a total internal reflection at the interface. The reflected ray BC corresponds to
Eref = Ae−i𝜔t−i𝛼x+i𝛽z.
(2.76)
Note that the z-component of the wave vector does not change after the reflection, but the x-component
reverses its sign. The total field in the waveguide can be written as
E = Eincident + Eref = 2A cos (𝛼x)e−i(𝜔t−𝛽z).
(2.77)
Thus, incident and reflected plane waves set up a standing wave in the x-direction. The rigorous solution to
the planar waveguide problem by solving Maxwell’s equation shows that 𝛽can take discrete values 𝛽n and
2𝜋n2∕𝜆0 < 𝛽n < 2𝜋n1∕𝜆0. In the case of an optical fiber, cos (𝛼x) is replaced by the Bessel function and the
rest is nearly the same. In Section 2.4 we have found that for single-mode fibers there is only one mode, with
field distribution given by
𝜓= A1R01(r)e−i𝜔t+i𝛽01z
(2.78)
where 𝛽01 is the propagation constant obtained by solving Eq. (2.57). Therefore, a guided mode of an optical
fiber can be imagined as a standing wave in transverse directions and a propagating wave in the z-direction
resulting from the superposition of the ray AB and the reflected ray BC. The propagation constant 𝛽01 and
angle 𝜙are related by
𝛽01 = k0n1 sin 𝜙.
(2.79)
the discrete value of the propagation constant 𝛽01 implies that 𝜙can not take arbitrary values in the interval
[𝜙c, 𝜋∕2], but only a discrete value as determined from Eqs. (2.57) and (2.79).
2.4.5
Radiation Modes
For radiation modes, 𝛽2 < k2
0n2
2. In this case, the last terms on the left-hand sides of Eqs. (2.44) and (2.45) are
both positive and their solutions are given by Bessel functions,
R(r) =
{
C1Jm
(𝛼1r)
r ≤a
E1Jm(𝛼2r) + E2Ym(𝛼2r) r > a
.
Continuity of R(r) and dR∕dr at the core–cladding interface leads to two equations as before. But now we
have four unknowns C1, E1, E2, and 𝛽. C1 can be determined from the power carried by the mode and this
leaves us with three unknowns and two equations of continuity. Therefore, we can not write an eigenvalue
equation for 𝛽as was done in Section 2.4.1 for guided modes. In fact, 𝛽can take arbitrary values in the range
0 < 𝛽< k0n2. A connection with ray optics can be made by defining
𝛽= k1 sin 𝜙i = k0n1 sin 𝜙i,
(2.80)
where 𝜙i is the angle of incidence, as shown in Fig. 2.23. The ray undergoes refraction as it goes from core
to cladding if the angle of incidence 𝜙i < 𝜙c. When 𝜙i = 𝜙c, we have
sin 𝜙c = n2
n1
(2.81)

Optical Fiber Transmission
55
Figure 2.23
(a) Radiation modes corresponding to refraction with angle of incidence 𝜙i < 𝜙c. (b) Guided modes cor-
responding to total internal reflection with 𝜙i ≥𝜙c.
and from Eq. (2.80), we obtain
𝛽= 𝛽c = k0n2.
(2.82)
Therefore, the condition that 𝛽< k0n2 for radiation modes corresponds to 𝜙i < 𝜙c and the ray undergoes
refraction, as shown in Fig. 2.23(a). Similarly, the condition that k0n2 < 𝛽< k0n1 for guided modes cor-
responds to 𝜙c < 𝜙< 𝜋∕2 and rays undergo total internal reflection for this range of angle of incidence, as
shown in Fig. 2.23(b). The difference between guided modes and radiation modes is that the propagation con-
stants of guided modes form a discrete set while those of radiation modes are continuous. Radiation modes
do not propagate a longer distance since they are absorbed by the polymer jacket.
2.4.6
Excitation of Guided Modes
The total field in an optical fiber can be expressed as a superposition of fields due to guided modes and
radiation modes. Radiation modes are attenuated strongly due to absorption by the polymer jacket. Therefore,
the total field can be expressed as the superposition of fields due to guided modes given by Eq. (2.66):
𝜓(r, 𝜙, z, t) =
M
∑
m=−M
Nm
∑
n=1
AmnRmn(r)e−i(𝜔t−𝛽mnz−im𝜙),
(2.83)
where Nm is the number of solutions of the eigenvalue equation (2.57) for the given m, Amn is the mode weight
factor which is to be determined from launch conditions, and Rmn(r)eim𝜙is the transverse field distribution
given by Eq. (2.67). For convenience, Eq. (2.83) may be rewritten as
𝜓(x, y, z, t) =
J∑
j=1
AjΦj(x, y)e−i(𝜔t−𝛽jz),
(2.84)
where
Aj ≡Amn,
Φj(x, y) ≡Rmn(r)eim𝜙,
𝛽j ≡𝛽mn,
(2.85)

56
Fiber Optic Communications
and J is the total number of modes. Suppose the output of a laser is monochromatic and it is used as fiber
input. The fiber input field can be written as
𝜓(x, y, z = 0, t) = f(x, y)e−i𝜔t.
(2.86)
Using Eq. (2.86) in Eq. (2.84), we obtain
f(x, y) =
J∑
j=1
AjΦj(x, y).
(2.87)
To determine Aj, multiply Eq. (2.87) by Φ∗
k(x, y) and integrate over the cross-section to obtain
∫
+∞
−∞∫
+∞
−∞
f(x, y)Φ∗
k(x, y)dxdy =
J∑
j=1
Aj ∫
+∞
−∞∫
+∞
−∞
Φj(x, y)Φ∗
k(x, y)dxdy.
(2.88)
Using the orthogonality relation,
∫
+∞
−∞∫
+∞
−∞
Φj(x, y)Φ∗
k(x, y)dxdy = 𝛿jk,
(2.89)
where 𝛿jk is the Kronecker delta function defined as
𝛿jk =
{
1,
if
j = k
0,
otherwise .
(2.90)
Eq. (2.88) reduces to
Ak = ∫
+∞
−∞∫
+∞
−∞
f(x, y)Φ∗
k(x, y)dxdy.
(2.91)
Thus, for the given input field distribution f(x, y), we can find the mode weight factors Ak using Eq. (2.91)
and the total field distribution at any distance z is given by Eq. (2.84). Suppose the output of the laser has
exactly the same transverse distribution as that of the fundamental mode of the step-index fiber, i.e., if f(x, y) =
Φ1(x, y) = R01(r), from Eq. (2.91), we find A1 = 1 and Am = 0 for m > 1. Therefore, from Eq. (2.84), the field
distribution at z is
𝜓(x, y, z, t) = Φ1(x, y)e−i(𝜔t−𝛽1z).
(2.92)
Ideally speaking, the fundamental mode LP01 can be launched to the fiber, which propagates down the fiber
without any change in shape and thereby intermodal dispersion can be avoided. However, in practice, the fiber
imperfections and refractive index fluctuations due to temperature and stress can easily transfer power from
the LP01 mode to higher-order modes. Therefore, the safest way to avoid intermodal dispersion is by ensuring
that the fiber is single-moded at the operating wavelength.
Suppose a multi-mode fiber is excited with the Gaussian input
f(x, y) = exp
(
−x2 + y2
2R2
0
)
.
The mode weight factors Ap can be calculated using Eq. (2.91) and are shown in Fig. 2.24. As can be seen,
in this example, most of the power is carried by the LP01 mode (p = 1).

Optical Fiber Transmission
57
Figure 2.24
Mode weight factor versus mode index p. Core radius = 31.25 μm, Δ = 0.01 μm, and R0 = 15 μm.
2.5
Pulse Propagation in Single-Mode Fibers
In the case of multi-mode fibers (MMFs), pulse broadening occurs because of the different times taken by the
different rays (or modes) to propagate through the fiber. This broadening can be avoided by using single-mode
fibers (SMFs). One may think that in the case of a SMF, there is only one path and hence pulses should
not broaden, but this is not true. If a monochromatic light wave of infinite duration is launched to a SMF, it
corresponds to a single ray path. However, such an optical signal does not convey any information. To transmit
data over a fiber, the optical carrier has to be modulated. As a result, the optical signal propagating in the fiber
consists of a range of frequency components. Since the propagation constant is frequency dependent (see
Fig. 2.16), different frequency components undergo different amounts of delay (or phase shifts) and arrive
at different times at the receiver, leading to pulse broadening even in a SMF. This is known as intramodal
dispersion. The degree of pulse broadening in a SMF is much smaller than that in a MMF, but for high-rate
transmission systems (>2.5 Gb/s) even the pulse spreading in a SMF could limit the maximum error-free
transmission distance.
When the output of a CW (continuous wave) laser operating at frequency 𝜔is incident on a single-mode
fiber, the optical field distribution can be written as (Eq. (2.84) with j = 1)
𝜓(x, y, z, t) = Φ(x, y, 𝜔)A(𝜔)e−i[𝜔t−𝛽(𝜔)z].
(2.93)
The mode weight factor A and the transverse field distribution Φ could vary with frequency 𝜔. So far we have
assumed that the fiber is lossless. In the presence of fiber loss, the refractive index appearing in Eq. (2.29)
should be complex and, as a result, the propagation constant 𝛽becomes complex,
𝛽(𝜔) = 𝛽r(𝜔) + i𝛼(𝜔)∕2,
(2.94)
where 𝛽r(𝜔) = Re[𝛽(𝜔)] and 𝛼(𝜔) = 2Im[𝛽(𝜔)]. Using Eq. (2.94) in Eq. (2.93), we obtain
𝜓(x, y, z, t) = Φ(x, y, 𝜔)A(𝜔)e−𝛼(𝜔)z∕2e−i[𝜔t−𝛽r(𝜔)z].
(2.95)

58
Fiber Optic Communications
If an optical fiber is excited with multiple frequency components, the total field distribution is the superposition
of the fields due to each frequency component,
𝜓(x, y, z, t) = Φ(x, y)e−𝛼z∕2
N
∑
n=1
A(𝜔n)e−i𝜔nt+i𝛽r(𝜔n)z.
(2.96)
In Eq. (2.96), we have ignored the frequency dependency of the transverse field distribution Φ and also that
of the loss coefficient 𝛼. This is valid if the frequency spread Δ𝜔= |𝜔N −𝜔1| is much smaller than the mean
frequency of the incident field. If the incident field envelope is a pulse, its frequency components are closely
spaced and we can replace the summation in Eq. (2.96) with an integral
𝜓(x, y, z, t) = Φ(x, y)F(t, z)
(2.97)
where
F(t, z) = e−𝛼z∕2
2𝜋
∫
∞
−∞
̃A(𝜔)e−i[𝜔t−𝛽r(𝜔)z] d𝜔,
(2.98)
̃A(𝜔) = 2𝜋lim
Δ𝜔n→0
A(𝜔n)
Δ𝜔n
.
(2.99)
From Eq. (2.98), we have
F(t, 0) = 1
2𝜋∫
+∞
−∞
̃A(𝜔)e−i𝜔t d𝜔.
(2.100)
Eq. (2.100) represents the inverse Fourier transform of ̃A(𝜔). Therefore, the Fourier transform ̃A(𝜔) of the
incident pulse F(t, 0) is
̃A(𝜔) = ∫
+∞
−∞
F(t, 0)ei𝜔tdt.
(2.101)
Thus, for the given incident pulse shape, we can calculate ̃A(𝜔) using Eq. (2.101) and the optical field distri-
bution at any z can be calculated using Eqs. (2.97) and (2.98). The impact of the fiber is characterized by 𝛽(𝜔).
However, in practice, the dependence of the propagation constant on frequency for the commercially available
fibers is not known. Besides, from the fiber-optic system design point of view, it is desirable to characterize
the fiber using a few parameters. Therefore, we do the following approximation. The propagation constant
at any frequency 𝜔can be written in terms of the propagation constant and its derivative at some reference
frequency (typically the carrier frequency) 𝜔0 using Taylor series,
𝛽r(𝜔) = 𝛽0 + 𝛽1(𝜔−𝜔0) + 1
2𝛽2(𝜔−𝜔0)2 + · · · ,
(2.102)
where
𝛽0 = 𝛽r(𝜔0),
(2.103)
𝛽1 = d𝛽r
d𝜔
||||𝜔=𝜔0
= 1
𝜐g
,
(2.104)
𝛽2 = d2𝛽r
d𝜔2
|||||𝜔=𝜔0
.
(2.105)
𝛽1 is the inverse group velocity and 𝛽2 is the second-order dispersion coefficient (see Section 1.10). If the
signal bandwidth is much smaller than the carrier frequency 𝜔0, we can truncate the Taylor series after the

Optical Fiber Transmission
59
second term on the right-hand side. To simplify Eq. (2.98), let us choose the variable Ω = 𝜔−𝜔0. Using
Eq. (2.102) in Eq. (2.98), we obtain
F(t, z) = 1
2𝜋∫
+∞
−∞
̃B(Ω) exp [−𝛼z∕2 −i(𝜔0t −𝛽0z) + i𝛽1Ωz + i𝛽2Ω2z∕2] exp (−iΩt) dΩ
= exp [−𝛼z∕2 −i(𝜔0t −𝛽0z)]
2𝜋
∫
+∞
−∞
̃B(Ω) exp (i𝛽1Ωz + i𝛽2Ω2z∕2 −iΩt) dΩ
= exp [−i(𝜔0t −𝛽0z)]
2𝜋
∫
+∞
−∞
̃B(Ω)Hf (Ω, z) exp (−iΩt) dΩ,
(2.106)
where
Hf (Ω, z) = exp (−𝛼z∕2 + i𝛽1Ωz + i𝛽2Ω2z∕2)
(2.107)
is called the fiber transfer function and
̃B(Ω) ≡̃A(𝜔0 + Ω).
(2.108)
The linear phase shift 𝛽1Ωz corresponds to a delay in time domain. To see that, set 𝛽2 = 0 in Eq. (2.107) and
the fiber output at z = L,
F(t, L) = exp [−𝛼z∕2 −i(𝜔0t −𝛽0L)]
2𝜋
∫
+∞
−∞
̃B(Ω) exp [−iΩ(t −𝛽1L)] dΩ
= exp [−𝛼z∕2 −i(𝜔0t −𝛽0L)]B(t −𝛽1L).
(2.109)
In a dispersion-free fiber (𝛽2 = 0), the pulse is simply delayed by 𝛽1L at the fiber output without any change
in pulse shape, as in the free-space propagation. Using Eqs. (2.98) and (2.106), the optical field distribution
can be written as
𝜓(x, y, z, t) =
Φ(x, y)
⏟⏟⏟
transverse field
exp [−i(𝜔0t −𝛽0z)]
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
carrier
s(t, z)
⏟⏟⏟
field envelope
,
(2.110)
where
s(t, z) = 1
2𝜋∫
+∞
−∞
̃B(Ω)Hf (Ω, z) exp (−iΩt) dΩ
(2.111)
and
̃B(Ω) = ∫
+∞
−∞
s(t, 0) exp (iΩt)dt.
(2.112)
Eqs. (2.111) and (2.112) can be rewritten as
s(t, z) = −1 [̃B(Ω)Hf (Ω, z)] ,
(2.113)
̃B(Ω) = [s(t, 0)],
(2.114)
̃B(Ω) ⇌s(t, 0),
(2.115)
where and −1 denote Fourier and inverse Fourier transforms, respectively, and ⇌indicates that they are
Fourier transform pairs. In this section, we focus mainly on the field envelope s(t, z). Let us assume that the
transverse field distribution of the laser output is the same as that of the fiber, and therefore there is no change
in the transverse field distribution along the fiber. Let the field envelope of the laser output be si(t),
si(t) = s(t, 0)
(2.116)

60
Fiber Optic Communications
Si (t)
So(t)
Hf (Ω, L)
Si (Ω)
~
So(Ω) = Si(Ω)Hf (Ω, L) 
~
~
Figure 2.25
Optical fiber as a linear time-invariant system.
and
̃B(Ω) = [si(t)] = ̃si(Ω).
(2.117)
The fiber can be imagined as a linear system with transfer function Hf (Ω, z) (see Fig. 2.25), The impact of
the fiber nonlinearity is discussed in Chapter 10. Let the field envelope of the fiber output s(t, L) be so(t),
s(t, L) = so(t),
(2.118)
[so(t)] = ̃so(Ω) = Hf (Ω, L)̃si(Ω).
(2.119)
The optical signal propagation in a single-mode fiber can be summarized as follows.
Step 1: Input field envelope si(t) is known. Take its Fourier transform to obtain ̃si(Ω).
Step 2: Multiply ̃si(Ω) by Hf (Ω, L) to get the output spectrum ̃so(Ω).
Step 3: Take the inverse Fourier transform of ̃so(Ω) to obtain the output field envelope so(t).
Step 4: The total field distribution at the output is obtained by
𝜓(x, y, L, t) = Φ(x, y) exp [−i(𝜔0t −𝛽0L)]so(t).
(2.120)
The advantage of this approach over that using Eq. (2.98) is that the fiber is characterized by three parameters
𝛽0, 𝛽1, and 𝛽2 instead of 𝛽(𝜔). As the spectral width of the signal transmitted over the fiber increases, it may
be necessary to include higher-order dispersion coefficients such as 𝛽3 and 𝛽4. 𝛽1 and 𝛽2 can be measured
experimentally even if the fiber index profile is unknown. For example, by transmitting the output of a CW
laser of angular frequency 𝜔0 over a fiber of length L, the time of flight ΔT0 to traverse the distance L can be
measured and 𝛽1(𝜔0) is ΔT0∕L. Repeating the same experiment at 𝜔0 + Δ𝜔, 𝛽1(𝜔0 + Δ𝜔) can be calculated.
𝛽2 can be estimated as
𝛽2 ≅𝛽1(𝜔0 + Δ𝜔) −𝛽1(𝜔0)
Δ𝜔
.
(2.121)
2.5.1
Power and the dBm Unit
The average power density of a plane wave is given by
Pav
z = | ̃Ex|2
2𝜂,
(2.122)
where ̃Ex is the peak amplitude of the electric field intensity and 𝜂is the intrinsic impedance of the dielectric
medium. A plane wave has infinite spatial extension in x- and y-directions and, therefore, the power carried
by a plane wave is infinite. Under the LP-mode approximation, a fiber mode can be interpreted as a plane
wave with finite spatial extension in the x- and y-directions and, therefore, power carried by a fiber mode can
be obtained by integrating the absolute square of electric field intensity as done in Eq. (2.64),
P = ∫
∞
−∞
|| ̃Ex||
2 1
2𝜂dxdy = |s(t, z)|2
2
∫
∞
−∞
|𝜙(x, y)|2
𝜂
dxdy
= K|s(t, z)|2.
(2.123)

Optical Fiber Transmission
61
Thus, we see that the power is proportional to the absolute square of the field envelope s(t, z). Throughout
this book, unless otherwise specified, we set K = 1 so that the absolute square of the electric field envelope
is equal to the power.
Often it is convenient to use the logarithmic unit for power. The optical power in dBm units is expressed as
power (dBm) = 10 log10
[power (mW)
1 mW
]
.
(2.124)
In Eq. (2.124), 1 mW is chosen as a reference power and the letter “m” in dBm is a reminder of the 1 mW
reference. For example, 1 mW of transmitter power corresponds to 0 dBm. If the transmitter power is increased
to 2 mW, a factor of 2 in linear scale corresponds to 3 dB, and, therefore, in this case, the transmitter power is
3 dBm. Note that the optical power expressed in dBm units is not really a unit of power such as mW, but the
ratio of the power in mW and 1 mW expressed in dB units. Typically, the loss and gain in a fiber-optic system
are expressed in dB units. The advantage of using dBm units is that multiplications and divisions involving
power and loss factors can be replaced by additions and subtractions as illustrated in Examples 2.8 and 2.9.
Inverting Eq. (2.124), we find
power (mW) = 10power (dBm)∕10 mW.
(2.125)
Example 2.4
The power transmitted in a fiber-optic system is 0.012 W. (a) Convert this into dBm units. (b) The received
power is −5 dBm. Convert this into mW units.
Solution:
(a) From Eq. (2.124), the transmitted power in dBm units is
Ptr(dBm) = 10 log10
[12 mW
1 mW
]
= 10.79 dBm.
(2.126)
(b) The received power is
Prec(dBm) = −5 dBm.
(2.127)
Using Eq. (2.125), we find
Prec(mW) = 10−5∕10 mW = 0.3162 mW.
(2.128)
Example 2.5 Rectangular Pulse
The laser shown in Fig. 2.26 operates at 375 THz. It is turned on for 50 ps and then turned off. Sketch the field
envelope at the screen if the medium is (a) free space, (b) fiber with 𝛽2 = 0, (c) fiber with 𝛽2 = −21 ps2/km.
Ignore fiber loss.
Solution:
Under steady-state conditions, the electric field intensity of a CW laser (ignoring the transverse field distri-
bution) may be written as
F(t, 0) = f(t) = A exp [−i2𝜋f0t],
(2.129)

62
Fiber Optic Communications
Figure 2.26
Pulse propagation in free space and optical fiber.
where f0 = 375 THz. When the laser is turned on for 50 ps and then turned off, a rectangular pulse is generated
and, in this case, the electric field intensity is
F(t, 0) = f(t) = si(t) exp [−i2𝜋f0t],
(2.130)
where
si(t) = A rect
(
t
T0
)
(2.131)
and T0 = 50 ps.
(a) In Section 1.6, the electric field intensity at the screen (z = L) is found to be
F(t, L) = f(t −T1) = so(t −T1) cos [2𝜋f0(t −T1)],
(2.132)
where
so(t) = rect
(t −T1
T0
)
,
(2.133)
T1 = L∕c, and c is the velocity of light in free space. The field is delayed by T1 = L∕c, which is the propagation
delay as shown in Fig. 2.27.
(b) In the case of an optical fiber, let us first consider the case 𝛽2 = 0.
Step 1:
si(t) = A rect
(
t
T0
)
,
̃si(f) = A ∫
T0∕2
−T0∕2
exp (i2𝜋ft)dt = A sin(𝜋fT0)
𝜋f
.
(2.134)
Step 2: The transfer function of a loss-free fiber in the absence of 𝛽2 is
Hf (f, L) = exp (i2𝜋f𝛽1L),
(2.135)
̃so(f) = ̃si(f)Hf (f, L) = A sin(𝜋fT0)
𝜋f
exp (i2𝜋f𝛽1L).
(2.136)

Optical Fiber Transmission
63
Figure 2.27
In free space, the pulse shape does not change.
Step 3: The delay in time domain corresponds to a constant phase shift in frequency domain,
g(t −T0) ⇌̃g(f) exp (i2𝜋fT0).
(2.137)
Using Eqs. (2.134) and (2.136), the output field envelope may be written as
so(t) = si(t −𝛽1L) = rect
(t −𝛽1L
T0
)
.
(2.138)
Fig. 2.28 shows the field envelope. As can be seen, there is no change in the pulse shape at z = L. It
is simply delayed by 𝛽1L, similar to the case of free-space propagation.
(c) When 𝛽2 ≠0, Eq. (2.136) may be written as
̃so(f) = A sin (𝜋fT0)
𝜋f
exp [i2𝜋f𝛽1L + i(2𝜋f)2𝛽2L∕2]
(2.139)
so(t) = −1[̃so(f)].
(2.140)
It is not possible to do the inverse Fourier transform analytically. Fig. 2.29 shows the output field envelope
so(t) obtained using numerical techniques when 𝛽2 = −21 ps2∕km and L = 80 km. As can be seen, there is a
significant pulse broadening after fiber propagation.
Step 4: The total field distribution at the fiber output is
𝜓(x, y, L, t) = Φ(x, y) exp [−i(𝜔0t −𝛽0z)]s0(t).
(2.141)
Fig. 2.30 shows the total field distribution at the fiber input and output (transverse field distribution
is not shown).
Figure 2.28
The field envelopes at the laser and at the screen. In optical fibers with 𝛽2 = 0, the pulse shape does not
change.

64
Fiber Optic Communications
Figure 2.29
Optical field envelopes when 𝛽2 ≠0. L = 80 km, 𝛽2 = −21 ps2/km.
Figure 2.30
Total field distribution at the laser and at the screen when 𝛽2 ≠0.
Example 2.6 Gaussian Pulse
The input field envelope is
si(t) = A exp (−t2∕2T2
0),
(2.142)
where T0 represents the half-width at 1∕e-intensity point and A is the peak amplitude. Find the output field
envelope in a dispersive fiber. Ignore fiber loss and constant delay due to 𝛽1.
Solution:
To relate T0 to the full-width at half-maximum (FWHM), Tin
FWHM, let us first write an equation for power
P(t) = |si(t)|2 = A2e−t2∕T2
0 ,
(2.143)
Pmax = P(0) = A2.
(2.144)
Let th be the time at which the power is half of the peak power, as shown in Fig. 2.31. Since FWHM means
the full-width at half-power point, we have
P(th) = A2∕2 = A2 exp (−t2
h∕T2
0).
(2.145)
Taking logarithms on both sides, we obtain
th = T0(ln 2)1∕2
(2.146)

Optical Fiber Transmission
65
Figure 2.31
A Gaussian pulse.
and
Tin
FWHM = 2th = 2(ln 2)1∕2T0 ≃1.665T0.
(2.147)
The transfer function of an optical fiber in the absence of fiber loss is given by Eq. (2.107) as
Hf (f, L) = exp [i𝛽1(2𝜋f)L + i𝛽2(2𝜋f)2L∕2].
(2.148)
As mentioned before, the first term on the right-hand side introduces a constant delay and, hence, it can be
ignored for the purpose of evaluating the output pulse shape. Using the following identity:
exp (−𝜋t2) ⇌exp (−𝜋f 2) ,
(2.149)
where ⇌indicates that they are Fourier transform pairs and using the scaling property
g(at) ⇌1
a ̃g(f∕a),
Re(a) > 0,
(2.150)
the Fourier transform of si(t) can be calculated. Taking
a =
1
√
2𝜋T0
,
(2.151)
si(t) = A exp [−𝜋(at)2] ⇌A
a exp [−𝜋(f∕a)2] = ̃si(f).
(2.152)
Therefore, we have
̃so(f) = ̃si(f)Hf (f, L)
= A
a exp
[
−𝜋f 2
a2 + i𝛽2(2𝜋f)2L∕2
]
= A
a exp (−𝜋f 2∕b2),
(2.153)
where
1
b2 = 1
a2 −i2𝜋𝛽2L.
(2.154)

66
Fiber Optic Communications
Using Eqs. (2.149) and (2.150), the inverse Fourier transform of ̃so(f) is
so(t) = Ab
a exp [−𝜋(tb)2] .
(2.155)
Using Eqs. (2.151) and (2.154), we have
a
b =
[T2
0 −i𝛽2L]1∕2
T0
,
(2.156)
𝜋b2t2 =
t2
2(T2
0 −i𝛽2L)
.
(2.157)
Therefore, the output field envelope is
so(t) =
AT0
(T2
0 −i𝛽2L)1∕2 exp
[
−
t2
2 (T2
0 −i𝛽2L)
]
.
(2.158)
To find the pulse width at the output, let us first calculate the output power
Po(t) = |so(t)|2 =
A2T2
0
|||
(T2
0 −i𝛽2L)1∕2|||
2
||||||
exp
[
−
t2
2 (T2
0 −i𝛽2L)
]||||||
2
.
(2.159)
Since
t2
2(T2
0 −i𝛽2L)
=
t2(T2
0 + i𝛽2L)
2(T4
0 + 𝛽2
2L2)
,
(2.160)
we obtain
Po(t) = T0A2
T1
exp
(
−t2
T2
1
)
(2.161)
where T2
1 = (T4
0 + 𝛽2
2L2)∕T2
0. The FWHM at the output is given by
Tout
FWHM = 2(ln 2)1∕2T1 = 2(ln 2)1∕2 (T4
0 + 𝛽2
2L2)1∕2
T0
.
(2.162)
To determine the amount of pulse broadening, the ratio of output to input pulse widths is calculated as
𝛼=
Tout
FWHM
Tin
FWHM
=
(T4
0 + 𝛽2
2L2)1∕2
T2
0
.
(2.163)
When
|𝛽2L| =
√
3T2
0
(2.164)
we find 𝛼= 2, which means that the output pulse width is twice the input pulse width. Note that the amount
of pulse broadening is independent of the sign of the dispersion coefficient 𝛽2.
The frequency chirp or instantaneous frequency deviation is defined as
𝛿𝜔(t) = −d𝜙
dt ,
(2.165)

Optical Fiber Transmission
67
where 𝜙is the instantaneous phase of the field envelope and 𝛿𝜔(t) is the instantaneous frequency deviation
from the carrier frequency. Note that the optical carrier is of the form exp (−i𝜔0t). A negative sign is introduced
above so that a positive value of 𝛿𝜔implies the frequency is up-shifted. At the fiber output, from Eq. (2.160),
the instantaneous phase is
𝜙(t) = −t2𝛽2L
2T2
1T2
0
+ const.
(2.166)
Substituting Eq. (2.166) in Eq. (2.165), we find
𝛿𝜔(t) =
(
𝛽2L
T2
1T2
0
)
t.
(2.167)
Fig. 2.32 illustrates the evolution of power and chirp along the fiber length. At the fiber output, the pulse
becomes chirped and the sign of the chirp depends on the sign of the dispersion coefficient 𝛽2. In Fig. 2.32
(b) and (c), we see that the trailing edge is down-shifted in frequency (or red-shifted) and the leading edge
is up-shifted (or blue-shifted). This can be explained as follows. When the dispersion is anomalous (𝛽2 < 0),
high-frequency components of the pulse travel faster than low-frequency components (see Section 1.10).
Since these components arrive at different times, this leads to pulse broadening. Since the low-frequency
components of the pulse (components whose frequency is lower than the carrier frequency) travel slower,
they arrive later and, therefore, they are present near the trailing edge, which is another way of saying that the
trailing edge is down-shifted in frequency.
Figure 2.32
Evolution of unchirped Gaussian pulse in optical fiber. 𝛽2 = −21 ps2/km, T0 = 30 ps.

68
Fiber Optic Communications
2.6
Comparison between Multi-Mode and Single-Mode Fibers
MMFs have several advantages over SMFs. The core radius of a multi-mode fiber (25–35 μm) is much larger
than that of a single-mode fiber (4–9 μm). Therefore, it is easier to launch optical power into a MMF and
also to splice two MMFs. The large core of a MMF facilitates simple fiber-to-fiber or fiber-to-transceiver
alignment and, hence, is best suited to local area network (LAN) applications [14]. The relative index
difference Δ of a MMF is larger than that of a SMF. Therefore, the numerical aperture of a MMF is large,
which implies more light can be launched to the fiber from an inexpensive optical source that has a large
angular spread, such as a LED. To have a reasonable power coupling efficiency, SMFs are excited with laser
diodes. Inexpensive short-haul fiber-optic links can be designed using LEDs and multi-mode fibers. How-
ever, multi-mode fibers are not used for long-haul and/or high-bit-rate applications because of intermodal
dispersion. Although the dispersion can be reduced to some extent using graded-index multi-mode fibers,
the pulse broadening increases linearly with distance (Eq. (2.24)) and becomes unacceptably large for a
fiber-optic link that is hundreds of kilometers long. Typically, the transmission reach of a MMF fiber-optic
link at a bit rate of 1 Gb/s is limited to a few kilometers. Intermodal dispersion would be absent if there was
only one mode. Therefore, single-mode fibers are used for long-haul (1000 km–30,000 km) and high-bit-rate
(10 Gb/s–100 Gb/s) applications.
From the information theory point of view, the channel capacity of a multi-mode fiber is larger than that of a
single-mode fiber. This is because, in principle, each mode of a MMF can carry as much information as a SMF.
When different modes of a MMF carry independent sets of data it is known as mode-division multiplexing,
which has attracted significant attention recently [15–19]. In an ideal MMF with M guided modes, there is
no power coupling among modes and the channel capacity can be enhanced by the factor M. However, due to
refractive index fluctuations along the fiber, there is an exchange of power among modes, leading to cross-talk
between channels of a mode division multiplexed system. This cross-talk can be compensated for by using
digital signal processing techniques [15].
2.7
Single-Mode Fiber Design Considerations
The parameters that are important for the design of a single-mode fiber are (i) cutoff wavelength, (ii) fiber loss,
(iii) dispersion, (iv) dispersion slope, (v) polarization mode dispersion, and (vi) spot size. Using a step-index
optical fiber, it is not possible to optimize all these parameters. Therefore, the refractive index profile n(r)
is chosen so that the design parameters listed above are optimum for a specific application. For the given
refractive index profile n(r), the Helmholtz equation (2.28) is solved to obtain the propagation constant 𝛽(𝜔)
and the mode distribution function Φ(x, y). From this data, design parameters can be calculated. As an inverse
problem, the refractive index profile n(r) can be constructed to meet the given specifications on the design
parameters. However, in some cases, a solution to the inverse problem does not exist. For example, it is
desirable to have a large spot size (to reduce nonlinear effects) as well as a low dispersion slope to improve
the performance of a wavelength-division multiplexing (WDM) system. But it turns out that as the spot size
increases, the dispersion slope also increases. In the following subsections, important design parameters of a
single-mode fiber and their interrelationships are discussed.
2.7.1
Cutoff Wavelength
For high-bit-rate and long-haul applications, it is essential that the fiber is single-moded. The single mode
condition for a step-index fiber is given by Eqs. (2.70) and (2.59),
V = 2𝜋a
𝜆(n2
1 −n2
2)1∕2 ≤2.4048.
(2.168)

Optical Fiber Transmission
69
For example, if 𝜆= 1.55 μm, a = 4 μm, and (n2
1 −n2
2)1∕2 = 0.1, V = 1.62. Therefore, this fiber is
single-moded at this wavelength. However, if 𝜆= 0.7 μm corresponding to optical communication in
the visible spectrum, V becomes 3.59 and the fiber is not single-moded at this wavelength. For the given
fiber parameters, the cutoff wavelength is defined as
𝜆c =
2𝜋a(n2
1 −n2
2)1∕2
2.4048
= 2𝜋a NA
2.4048 .
(2.169)
If the operating wavelength 𝜆is less than 𝜆c, the fiber will not be single-moded. For fibers with arbitrary index
profiles, the Helmholtz equation (2.28) should be solved numerically to find the propagation constants 𝛽n as
a function of frequency, from which the conditions for the cutoff of higher-order modes can be established.
Example 2.7
The cutoff wavelength for a step-index fiber is 1.1 μm. The core index n1 = 1.45 and Δ = 0.005. Find the
core radius. Is this fiber single-moded at 1.55 μm?
Solution:
From Eq. (2.8), we find
n2 = n1(1 −Δ) = 1.4428.
(2.170)
Using Eq. (2.169), we find
a =
2.4048𝜆c
2𝜋(n2
1 −n2
2)1∕2 = 2.907 μm.
(2.171)
Since the operating wavelength 𝜆= 1.55 μm > 𝜆c, it is single-moded at this wavelength.
2.7.2
Fiber Loss
Before the advent of optical amplifiers, the maximum transmission distance of a fiber-optic system was deter-
mined by the fiber loss, as the optical receivers need a certain amount of optical power to detect the transmitted
signal reliably. Now the optical amplifiers are widely used and yet the maximum reach is affected by the fiber
loss. This is because the optical amplifiers add noise whose power spectral density is proportional to the
amplifier gain, which in turn is proportional to the fiber loss (see Chapter 6). In other words, the amount of
noise in a long-haul communication system is directly related to fiber loss. In addition, if the fiber loss is
small, the amplifier spacing can be increased, which reduces the system cost. So, it is important to design a
fiber with the lowest possible loss.
Let us consider a CW input to the fiber. The optical field distribution is given by Eq. (2.95),
𝜓(x, y, z, t) =
Φ(x, y, 𝜔)
⏟⏞⏞⏟⏞⏞⏟
transverse distribution
A(𝜔) exp (−𝛼z∕2)
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
field envelope
exp [−i(𝜔t −𝛽r(𝜔)z)]
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
optical carrier
.
(2.172)
The optical power is given by Eq. (2.123),
P(z) = |A(𝜔) exp (−𝛼z∕2)|2.
(2.173)

70
Fiber Optic Communications
At the fiber input,
Pin = P(0) = |A(𝜔)|2.
(2.174)
At the fiber output z = L,
Pout = P(L) = |A(𝜔)|2 exp (−𝛼L) = Pin(t) exp (−𝛼L).
(2.175)
The optical power loss in dB units due to propagation in a fiber of length L is defined as
loss(dB) = −10 log10
Pout
Pin
= −10(−𝛼L) log10e = 4.343𝛼L.
(2.176)
Here, 𝛼is the attenuation coefficient in units of km−1. The loss per unit length is
𝛼(dB∕km) = 4.343𝛼.
(2.177)
Next, let us consider the origin of fiber loss. The light wave is attenuated as it propagates in fiber mainly
due to (i) Rayleigh scattering and (ii) material absorption. In the following subsections, we discuss these
mechanisms in detail.
2.7.2.1
Rayleigh Scattering
Consider a perfect crystal with uniformly spaced atoms or molecules. When a light wave is incident on this
crystal, electrons in the atoms oscillate and emit light waves of the same frequency as the incident light
wave under a linear approximation (see Chapter 10). In other words, each atom acts as a tiny receiving and
transmitting antenna. The light emitted by an atom could be in all directions. However, for a perfect crystal
with uniformly spaced atoms or molecules, it can be shown that the emitted light waves add up coherently in
the direction of the incident light wave; in any other direction, we get no light as they add up destructively [20].
In other words, in a perfect crystal, there is no scattering of incident light. Next, consider a crystal with defects
such as atoms missing or irregularly placed in the lattice structure. In this case, light waves emitted by atoms
may not add up destructively over a range of directions, which leads to scattering.
Rayleigh scattering is the scattering of light by atoms or molecules of size much smaller than the wave-
length of the light. It is an important mechanism arising from local microscopic fluctuations in density and
compositional variations. The fluctuations in density correspond to irregularly spaced atoms or molecules in
a lattice structure and as a result, incident light is scattered over a range of angles as shown in Fig. 2.33. If
the angle of scattering 𝜃is less than the critical angle, it will escape to the cladding and then be absorbed
at the polymer jacket. A part of the optical field is back-reflected as well, due to Rayleigh scattering which
propagates as a backward-propagating mode. These effects lead to loss of power in the forward-propagating
Figure 2.33
Rayleigh scattering in optical fibers.

Optical Fiber Transmission
71
direction. The loss coefficient due to Rayleigh scattering can be written as
𝛼R ∝1
𝜆4 .
(2.178)
Because of the strong wavelength dependence of Rayleigh scattering, short wavelengths (blue) are scattered
more than long wavelengths (red). The scattering at 400 nm is 9.2 times as great as that at 700 nm for equal
incident intensity. Rayleigh scattering of sunlight in a clear atmosphere is the reason why the sky is blue. This
also explains why the sun looks red in the morning/evening. The distance between the sun and an observer is
large in the morning/evening and the light has to go through a thicker atmosphere, causing the lower wave-
lengths (violet, blue) to suffer higher losses (see Eq. (2.178)) and their intensities would be too low to detect.
The dominant contributions to the fiber loss come from Rayleigh scattering in the wavelength range of
practical interest, 1550–1620 nm. One of the reasons why fiber-optic communication systems operate in the
infrared region instead of the visible region (400–700 nm) is that the loss due to Rayleigh scattering is much
smaller in the former region because of its 𝜆−4 dependence. Fig. 2.34 shows the measured loss spectrum
of a single-mode fiber with 9.4 μm core diameter and Δ = 0.0019 [3]. As can be seen, the lowest fiber loss
occurs at 1.55 μm wavelength. For the silica fiber, at 𝜆= 1.55 μm, the loss due to Rayleigh scattering alone
is 𝛼R = 0.1559 dB∕km. Thus, for the fiber shown in Fig. 2.34, 77% of the total loss at 1.55 μm comes from
Rayleigh scattering.
Conventional optical fibers are fabricated by doping the silica with GeO2. The addition of a small amount
of GeO2 increases the refractive index and, therefore, enhancement of the core refractive index relative to
the cladding index is achieved. However, the addition of GeO2 increases the Rayleigh scattering. Therefore,
efforts have been made to fabricate pure silica core fibers (PSCFs) in which the core is pure silica [21, 22]. The
refractive index of cladding is reduced relative to the core index by adding a small amount of flourine. Since
most of the light is confined to the core, the PSCF has lower Rayleigh scattering coefficient than the conven-
tional silica–GeO2 core fiber. The attenuation of 1570 nm for PSCFs is 0.154 dB/km [21], which is the lowest
attenuation reported, whereas the lowest attenuation for the silica–GeO2 core fiber is about 0.19 dB/km.
2.7.2.2
Material Absorption
Material absorption can be divided into two types: (a) intrinsic absorption and (b) extrinsic absorption.
0.8
1.0
1.2
Wavelength (μm)
Loss (dB/km)
1.4
1.6
0.1
0.5
1
5
10
50
100
Figure 2.34
The measured loss spectrum of a single-mode fiber. Source: (After Ref. [3]. (c) IET. Reprinted with per-
mission from [3]. Copyright (1979) IET.

72
Fiber Optic Communications
Intrinsic Absorption
This loss is caused by the interaction of light with pure silica. An electron in the silica molecule absorbs light
and it makes a transition from one electron state to another. This kind of resonance occurs in the ultraviolet
region (𝜆< 0.4 μm) for silica and the tail of the absorption band extends throughout the visible spectrum.
A photon could interact with a molecule, causing a change in its vibrational state. This also leads to photon
absorption or optical power loss. This kind of vibrational resonance occurs in the far infrared region 𝜆> 7 μm,
and the tail of the vibrational resonances can be seen in Fig. 2.34 for 𝜆> 1.6 μm.
Extrinsic Absorption
This loss is caused by the interaction of light with impurities in silica. Metal impurities such as Cu, Fe,
Cr, Ni and V lead to a strong signal attenuation. These impurities can be reduced to less than one part in
1010 by glass-refining techniques such as vapor-phase oxidation [23]. One of the major sources of extrinsic
absorption is the water vapors present in silica fibers. The OH ion of the water vapor is bonded into the
glass structure and has a fundamental vibrational resonance at 2.73 μm. Its overtones and combination tones
with the fundamental silica vibrational resonances lead to strong absorption at 1.38, 1.24, 0.95, and 0.88 μm
wavelengths. As shown in Fig. 2.34, the absorption at 1.31 μm is the strongest and its tail at 1.3 μm was the
main hurdle for the development of fiber-optic communication systems at 1.3 microns. Efforts have been
made to reduce the absorption at 1.31 μm to less than about 0.35 dB/km by reducing the water content in the
glass [24, 25]. The majority of fiber-optic systems operate around the wavelength windows centered at 1.3 μm
and 1.55 μm. This is because the window centered at 1.3 μm has the lowest dispersion for a standard SMF
and the window at 1.55 μm has the lowest loss.
Example 2.8
A fiber of length 80 km has a loss coefficient of 0.046 km−1. Find the total loss. If the power launched to this
fiber is 3 dBm, find the output power in mW and dBm units.
Solution:
The loss per unit length (dB/km) = 4.343 × 0.046 = 0.2 dB/km. Total loss = 0.2 × 80 = 16 dB. From
Eq. (2.124), we have
P(dBm) = 10 log10
P(mW)
1 mW .
(2.179)
From Eq. (2.175), we find
Pout(mW) = Pin(mW) exp (−𝛼L).
(2.180)
Dividing Eq. (2.180) by 1 mW and taking logarithms, we find
Pout(dBm) = 10 log10
{Pin(mW) exp (−𝛼L)
1 mW
}
= Pin(dBm) + 10 log10 exp (−𝛼L)
= Pin(dBm) + 10 log10
Pout
Pin
.
(2.181)

Optical Fiber Transmission
73
Using Eq. (2.176), we find
Pout(dBm) = Pin(dBm) −loss(dB)
= 3 dBm −16 dB
= −13 dBm.
(2.182)
Note that using dBm units, multiplication (Eq. (2.180)) is replaced by subtraction (Eq. (2.182)). Using
Eq. (2.125), we find
Pout(mW) = 10−13∕10 mW = 0.05 mW.
(2.183)
Example 2.9
Consider a fiber-optic system consisting of a fiber with loss F followed by an amplifier of gain G (see
Fig. 2.35). The launch power is Pin. Calculate the output power of the amplifier in dBm units.
Solution:
Fiber loss (dB) = F(dB) = −10 log10
Fiber-out
Pin
.
(2.184)
Fiber loss in linear units,F = Fiber-out
Pin
.
(2.185)
Fiber-out = FPin.
(2.186)
Similarly, the amplifier output power is
Pout = GFPin.
(2.187)
From Eq. (2.124), we find
P(dBm) = 10 log10
P(mW)
1 mW .
(2.188)
Suppose that Pout and Pin in Eq. (2.187) are given in units of mW. Divide Eq. (2.187) by 1 mW and take
logarithms on both sides to obtain
10 log10
Pout
1 mW = 10 log10
[GFPin
1 mW
]
,
(2.189)
Fiber
Fiber-out = Amp-in
Amplifier
Pout
Pin
F
G
Figure 2.35
A fiber-optic link consisting of a fiber and an amplifier.

74
Fiber Optic Communications
Pout(dBm) = 10 log10G + 10 log10F + 10 log10Pin
= G(dB) −F(dB) + Pin(dBm).
(2.190)
Note that any loss (such as fiber attenuation) in the system is subtracted from the input power in dBm units
and any gain (such as amplifier gain) is added.
2.7.3
Fiber Dispersion
A medium is said to be dispersive if the group speed of light changes with the frequency of the optical wave.
For example, a pulse p1 with carrier frequency f1 = 193 THz and inverse group speed 𝛽1(f1) = 5 μs/km is
delayed by
ΔT1 = 𝛽1(f1)L = 50 μs
(2.191)
after propagating through a 10-km fiber. Consider another pulse p2 with a different carrier frequency
f2 = f1 + Δf. If the fiber is not dispersive (𝛽2 = 0), the inverse group speed 𝛽2(f2) is the same as 𝛽1(f1) and,
therefore, the pulse p2 is delayed by the same amount
ΔT2 = 𝛽1(f2)L = 50 μs.
(2.192)
In this case, the differential delay between the pulses is zero. Next, consider a dispersive fiber with
𝛽2 = 100 ps2∕km at 193 THz. By definition,
𝛽2(𝜔) = d2𝛽0
d𝜔2 = d𝛽1
d𝜔= 1
2𝜋
d𝛽1
df
≃1
2𝜋
𝛽1(f1 + Δf) −𝛽1(f)
Δf
(2.193)
or
𝛽1(f2) = 𝛽1(f1) + 2𝜋Δf𝛽2.
(2.194)
Let Δf = 1 THz. The pulse p2 is delayed by
ΔT2 = 𝛽1(f2)L = 𝛽1(f1)L + 2𝜋Δf𝛽2L
(2.195)
= 50.00628 μs.
(2.196)
The differential delay between the pulses is given by
ΔT = ΔT2 −ΔT1 = 2𝜋Δf𝛽2L
(2.197)
= 6.28 ns.
(2.198)
In other words, pulse p2 arrives at the fiber output later than pulse p1 by 6.28 ns. Instead of finding the deriva-
tive of 𝛽1 with respect to frequency as in Eq. (2.193), we could define its derivative with respect to wavelength,
D = d𝛽1
d𝜆,
(2.199)

Optical Fiber Transmission
75
where D is called the dispersion parameter. Since
f = c
𝜆,
(2.200)
df = −c
𝜆2 d𝜆.
(2.201)
Using Eq. (2.201) in Eq. (2.199) and making use of Eq. (2.193), we obtain
D = −2𝜋c
𝜆2
𝛽2.
(2.202)
Substituting Eq. (2.202) in Eq. (2.197), the differential delay can be rewritten as
ΔT = DLΔ𝜆,
(2.203)
where Δ𝜆= −cΔf∕f 2
1 . The above relation can be understood from the fact that 𝛽1 is the delay per unit length
and D is the delay per unit length per unit wavelength (Eq. (2.199)).
Fiber dispersion can be divided into two parts: (i) material dispersion and (ii) waveguide dispersion. Material
dispersion is due to the frequency dependence of the refractive index of glass. Just like a prism spreads white
light into a rainbow of colors (see Section 1.10), different frequency components travel at different speeds
in glass, leading to pulse spreading. The second contribution to fiber dispersion comes from the waveguide
effect and is known as waveguide dispersion. The dependence of the propagation constant on frequency can
be varied by changing the refractive index profile. For example, if we change the refractive index profile from
step index to parabolic index, the dispersion coefficient 𝛽2 could vary significantly. In a hypothetical case in
which the refractive index of core/cladding does not change with frequency, the fiber dispersion coefficient
𝛽2 could be nonzero because of waveguide dispersion. The product of the dispersion parameters D and fiber
length is called accumulated dispersion.
A curve fitting to an experimentally measured dispersion parameter of a standard single-mode fiber (SSMF)
is given by
D(𝜆) = S0
4
[
𝜆−
𝜆4
0
𝜆3
]
ps∕(nm ⋅km),
(2.204)
where 𝜆0 = 1317 nm and S0 = 0.088 ps∕(nm2 ⋅km). From Eq. (2.204), at 𝜆= 𝜆0, D(𝜆0) = 0 and, therefore,
𝜆0 is called the zero dispersion wavelength and
dD
d𝜆
||||𝜆=𝜆0
= S0.
(2.205)
S0 is called the dispersion slope at 𝜆0. Fiber loss is the lowest at 1550 nm and, therefore, most of the opti-
cal communication systems operate in the wavelength range 1520–1620 nm. In this wavelength range, the
dispersion parameter of a standard SMF is quite high, which leads to strong intersymbol interference (ISI)
at the receiver. To avoid this problem, dispersion-shifted (DS) fibers were invented in the 1980s and 1990s
[26, 27] which have 𝜆0 = 1550 nm. In the absence of fiber nonlinearity, the ideal characteristics of a fiber
are low dispersion parameter |D| and low loss, which can be achieved using DS fibers. However, it was soon
realized that DS fibers are not suitable for WDM systems since nonlinear interactions between channels, such
as four-wave mixing (FWM) and cross-phase modulation (XPM), are enhanced because of low dispersion
(see Chapter 10). In the mid-1990s, nonzero dispersion-shifted fibers (NZ-DSFs) were invented, for which 𝜆0
is chosen to be out of the wavelength region 1530–1565 nm [28]. For NZ-DSFs, dispersion near 1550 nm is
large enough to suppress the nonlinear effects and yet low enough to avoid strong ISI due to dispersion. Alter-
natively, the dispersion of the transmission fiber can be compensated for by using dispersion-compensating
fibers (DCFs) (see Section 2.8) or using an equalizer in the electrical domain. This topic is discussed in detail
in Chapter 11.

76
Fiber Optic Communications
2.7.4
Dispersion Slope
The dispersion parameter depends on the wavelength. For a single-channel low-bit-rate optical communica-
tion system, the spectral width Δf (and therefore the wavelength spread |Δ𝜆|) is quite small and the dispersion
parameter D(𝜆) can be considered as a constant over a small Δ𝜆. However, for a high-bit-rate wide-band
communication system, the dependence of D on the wavelength can not be ignored. For example, the spectral
width of an optical non-return-to-zero (NRZ) signal at B = 160 Gb/s is roughly (see Chapter 4)
Δf ≃2B = 320 GHz.
(2.206)
Since c = f𝜆,
Δ𝜆
𝜆= −Δf
f .
(2.207)
At the carrier wavelength 𝜆c = 1550 nm, Δ𝜆= −2.56 nm. The change in dispersion over such a large wave-
length spread around 1550 nm can not be ignored. It is useful to define the dispersion slope as
S = dD
d𝜆.
(2.208)
Using Eq. (2.204), the dispersion slope for a standard SMF can be calculated as
S = S0
4
[
1 +
3𝜆4
0
𝜆4
]
.
(2.209)
If the dispersion parameter Dc and the dispersion slope Sc at the carrier wavelength 𝜆c are known, the disper-
sion parameter in the vicinity of the carrier wavelength can be obtained by the linear approximation [29]
D(𝜆) = Dc + Sc(𝜆−𝜆0).
(2.210)
In Eq. (2.102), we have retained the Taylor expansion terms up to 𝛽2Ω2∕2. Under this approximation, 𝛽2 or
D is constant over the spectral width of the signal. To include the impact of the dispersion slope, we need to
include a higher-order term in the Taylor expansion of Eq. (2.102),
𝛽(Ω) = 𝛽0 + 𝛽1Ω + 𝛽2Ω2∕2 + 𝛽3Ω3∕6,
(2.211)
where
𝛽3 = d3𝛽
d𝜔3
|||||𝜔=𝜔0
= d𝛽2
d𝜔
||||𝜔=𝜔0
.
(2.212)
Substituting Eq. (2.211) in Eq. (2.98), we obtain
F(t, z) = exp [−i (𝜔0t −𝛽0z)]
∫
∞
−∞
̃B(Ω)Hf (Ω, z) exp (−iΩt) dΩ,
(2.213)
where the fiber transfer function is modified as
Hf (Ω, z) = exp [−𝛼z + i𝛽1Ωz + i𝛽2Ω2z∕2 + i𝛽3Ω3z∕6].
(2.214)
The field envelope at the output is given by Eq. (2.113) as before,
so(t) = −1 [̃so(Ω)] = −1 [Hf (Ω, z)̃si(Ω)].
(2.215)

Optical Fiber Transmission
77
Figure 2.36
Impact of third-order dispersion on an ultra-short Gaussian pulse. FWHM = 1.56 ps, L = 4.7 km.
The dispersion slope, S and 𝛽3 are related using Eqs. (2.208) and (2.202),
𝛽3 = d𝛽2
d𝜔= d(−D𝜆2∕2𝜋c)
d𝜆
d𝜆
d𝜔= S
(
𝜆2
2𝜋c
)2
+ 𝜆3D
2𝜋2c2 .
(2.216)
Fig. 2.36(a) shows the field envelope at the output of a fiber in the presence of 𝛽3 when 𝛽1 = 𝛽2 = 0. The effect
of 𝛽3 is to cause a pulse broadening asymmetrically. When 𝛽2 ≠0, pulses broaden symmetrically due to 𝛽2
as well as asymmetrically due to 𝛽3 (Fig. 2.36(b)). If the sign of 𝛽3 is changed, the pulse distortion occurs
at the other edge whereas if the sign of 𝛽2 is changed, the amount of pulse broadening is not affected for an
unchirped pulse (Eq. (2.162)).
Example 2.10
For a fiber-optic system, the channel wavelengths are in the range of 1530–1560 nm. Design a single-mode
fiber such that the absolute accumulated dispersion should not exceed 1100 ps/nm over the wavelength range
of interest. Assume that the dispersion varies linearly with wavelength. Fiber length = 80 km.
Solution:
The dependence of dispersion on wavelength is given by
D(𝜆) = (𝜆−𝜆0)S.
(2.217)
If we choose the zero-dispersion wavelength 𝜆0 in the center of the band, the maximum allowable dispersion
slope could be large. Therefore, we choose 𝜆0 = 1545 nm. Using Eq. (2.217), the absolute dispersion at the
right edge of the band is
|D(1560 nm)| = |S|(1560 −1545) ps/nm/km,
(2.218)
or
|S| = |D(1560 nm)|
15
ps/nm2∕km.
(2.219)
Since
|D(1560 nm)L| ≤1100 ps/nm,
(2.220)

78
Fiber Optic Communications
with L = 80 km and using Eqs. (2.219) and (2.220), we obtain
|S| ≤0.917 ps/nm2∕km.
(2.221)
2.7.5
Polarization Mode Dispersion
Weakly guiding approximation implies that the electromagnetic field propagates almost in the z-direction
and, therefore, the electric and magnetic field components are nearly transverse (see Section 2.4). The scalar
field 𝜓of Section 2.4 could either represent the electric field intensity Ex or Ey. Therefore, a single-mode
fiber supports two independent propagation modes [30–32]. For one of the modes, the electric field com-
ponent is along the ̂x-direction, the magnetic field component is along the ̂y-direction, and the propagation
constant is 𝛽x (x-polarization). For the other mode, the electric field component is along the ̂y-direction, the
magnetic field component is along the ̂x-direction, and the propagation constant is 𝛽y (y-polarization). If the
fiber cross-section is perfectly circular, these two modes are degenerate, i.e., 𝛽x = 𝛽y. However, it is hard to
fabricate a fiber whose cross-section is perfectly circular. Because of the asymmetry introduced during the
fiber manufacturing process, and external factors such as bending or twisting, the propagation constants 𝛽x
and 𝛽y differ. The inverse group speeds 𝛽1x and 𝛽1y corresponding to the x- and y-polarization components
are also different. As a result, the x- and y-polarization components of the input signal arrive at the fiber out-
put at different times, leading to pulse broadening if a direct detection receiver is used. This phenomenon is
known as polarization mode dispersion (PMD) [33–37]. Owing to random fluctuations in the fiber refractive
index along the fiber axis, there is an exchange of power between these polarization components that occurs
randomly along the fiber. Therefore, the pulse broadening due to PMD is stochastic in nature.
Using Eq. (2.110), the x- and y-components of the electric field intensity can be written as
Ex(x, y, z, t) = sx(t, z)Φ(x, y) exp [−i(𝜔t −𝛽xz)],
Ey(x, y, z, t) = sy(t, z)Φ(x, y) exp [−i(𝜔t −𝛽yz)],
(2.222)
where sx and sy are electrical field envelopes, 𝛽x and 𝛽y are propagation constants for the x- and y-polarization
components, respectively. The transverse field distributions are nearly the same for x- and y-polarization. As
in Section 2.5, input and output electrical field envelopes are related by
̃sx,out(Ω) = ̃sx,in(Ω)Hx(Ω, L),
̃sy,out(Ω) = ̃sy,in(Ω)Hy(Ω, L),
(2.223)
where
Ha(Ω, L) = exp
[
−𝛼z∕2 + i
(
𝛽1aΩz + 𝛽2Ω2z
2
)]
,
a = x, y.
(2.224)
Eqs. (2.223) and (2.224) can be written in matrix form using Jones’ vector notation (see Section 1.11):
̃sout(Ω) =
[̃sx,out(Ω)
̃sy,out(Ω)
]
,
̃sin(Ω) =
[̃sx,in(Ω)
̃sy,in(Ω)
]
,
(2.225)
̃sout(Ω) = H(Ω, L)̃sin(Ω),
(2.226)
H(Ω, L) =
[Hx(Ω, L)
0
0
Hy(Ω.L)
]
,
(2.227)

Optical Fiber Transmission
79
In the case of multi-mode fibers, modes propagate at different speeds and arrive at different times. Similarly,
in a single-mode fiber, x-(y-)polarization component propagates at the speed of 1∕𝛽1x (1∕𝛽1y) and, therefore,
the time delay ΔT between two polarization components at the output of the fiber of length L is
ΔT = L|𝛽1x −𝛽1y|.
(2.228)
The above equation is valid when there is no coupling between x- and y-polarization components. However, for
standard telecommunication fibers, there is a random coupling between these components due to perturbations
such as stress and micro-bending. The fiber vector transfer function given by Eq. (2.227) does not take into
account the random coupling between x- and y-polarization components. In general, the fiber vector transfer
function can be written as [38]
H(Ω, L) =
[
Hxx(Ω, L) Hxy(Ω, L)
Hyx(Ω, L) Hyy(Ω, L)
]
.
(2.229)
The transfer functions Hxy(Ω, L) and Hyx(Ω, L) represent the random coupling between x- and y-polarization
components. Because of the random nature of the coupling, it is hard to characterize these functions. Nev-
ertheless, these functions change over a time scale that is longer than the symbol period and, therefore, it is
possible to estimate H(Ω, L) and compensate for it using digital signal processing (see Chapter 11) in coherent
communication systems.
2.7.6
Spot Size
The transverse extent of the field distribution of the fundamental mode plays an important role in determining
splice loss between fibers, bending loss, fiber dispersion, and the threshold power required to have significant
nonlinear effects (discussed in Chapter 10). The root mean square (r.m.s.) spot size or Petermann-1 spot size
is defined as [39–40]
𝑤p1 =
[
2 ∫∞
0
Φ2(r)r3dr
∫∞
0
Φ2(r)rdr
]1∕2
,
(2.230)
where Φ(r) is the transverse field distribution of the fundamental mode, which is radially symmetric. When
a fiber mode has a large transverse extent the spot size is large, leading to enhancement of bending losses.
On the contrary, large spot size is desirable to reduce the effect of fiber nonlinearity on optical pulses and,
thereby, transmission performance can be improved. This is because, for the given launch power, the power
per unit cross-sectional area (= optical intensity) is larger when the spot size is smaller and the nonlinear
change in refractive index is directly proportional to the optical intensity. Typically, as the spot size increases,
the dispersion slope increases too. Therefore, the refractive index profile n(r) of a fiber should be optimized so
that (i) it has a single mode and has low loss at the desired wavelength range and (ii) the spot size is sufficiently
large for the transmission performance to not be impaired by nonlinear effects and, yet, be small enough so
that the dispersion slope and bending losses are not enhanced.
2.8
Dispersion-Compensating Fibers (DCFs)
For long-haul and/or high-bit-rate optical communication systems, the pulse broadening due to intramodal
dispersion leads to intersymbol interference, which degrades transmission performance. The pulse broadening
can be compensated using a DCF, as shown in Fig. 2.37. Using Eq. (2.107), the transfer functions of the

80
Fiber Optic Communications
Figure 2.37
Fiber-optic system consisting of TF and DCF. TF = transmission fiber, DCF = dispersion-compensating
fiber, TX = transmitter.
transmission fiber and DCF after ignoring 𝛽1 and fiber loss can be written as
HTF(f) = exp
[
i(2𝜋f)2𝛽TF
2 LTF
2
]
,
HDCF(f) = exp
[
i(2𝜋f)2𝛽DCF
2
LDCF
2
]
,
(2.231)
where the superscripts TF and DCF stand for transmission fiber and dispersion-compensating fiber, respec-
tively. The total transfer function is
Htot(f) = HTF(f)HDCF(f).
(2.232)
To keep the output pulse width equal to the input pulse width, we require
Htot(f) = 1,
(2.233)
or
𝛽TF
2 LTF = −𝛽DCF
2
LDCF.
(2.234)
When the loss is not ignored, the output of the DCF is attenuated by a factor exp [−𝛼TFLTF −𝛼DCFLDCF]
without affecting the pulse broadening. When 𝛽1 is included, the pulse is simply delayed by a factor 𝛽TF
1 LTF +
𝛽DCF
1
LDCF. Typically, SSMFs or NZDSFs are used as transmission fibers, which have anomalous dispersion.
Therefore, the DCF should have normal dispersion. As mentioned before, the fiber dispersion coefficient can
be altered by changing the amount of waveguide dispersion. The material dispersion of glass at 1550 nm is
anomalous and the waveguide dispersion of the standard SMF is a small fraction of the total dispersion (at
1550 nm). If the sign of the waveguide dispersion is made opposite to that of the material dispersion by a
proper choice of refractive index profile, the total fiber dispersion becomes normal. This is the underlying
principle behind the design of a DCF. To design a DCF, the refractive index profile of a fiber is divided into
several segments. Each segment is characterized by two or more parameters. For example, a segment could
have a parabolic index profile or it could have a triangular index profile. By optimizing the parameters of
these segments, the desired dispersion coefficient 𝛽2 can be obtained. For WDM applications (see Chapter 9),
it is desirable to compensate dispersion over a wide band. With proper design, the dispersion slope of the
transmission fiber can also be compensated [41]. Such a fiber is called a dispersion-slope compensating fiber.
Example 2.11
A transmission fiber of length 80 km has a dispersion of −21 ps2/km. The transmission fiber is followed by a
DCF of dispersion 130 ps2/km. (a) Find the length of the DCF such that the pulse width at the input of the trans-
mission fiber is the same as that at the output of the DCF. (b) Suppose the power launched into the transmission
fiber is 2 mW, losses of the transmission fiber and DCF are 0.2 dB/km and 0.5 dB/km, respectively. Calculate

Optical Fiber Transmission
81
the power at the output of the DCF. Assume a splice loss of 0.5 dB between the transmission fiber and the
DCF. (c) Find the gain of the amplifier such that the signal power at the output of the amplifier is the same as
that at the input.
Solution:
(a) From Eq. (2.234), we have
𝛽TF
2 LTF = −𝛽DCF
2
LDCF,
(2.235)
𝛽TF
2
= −21 ps2∕km,
LTF = 80 km,
(2.236)
𝛽DCF
2
= 130 ps2∕km,
(2.237)
LDCF =
−𝛽TF
2 LTF
𝛽DCF
2
= 12.9 km.
(2.238)
(b) The launch power in dBm units is given by Eq. (2.124) as
Pin(dBm) = 10 log10
2 mW
1 mW = 3 dBm.
(2.239)
Loss budget:
loss in transmission fiber = 0.2 × 80 dB = 16 dB,
loss in DCF = 0.5 × 12.9 dB = 6.45 dB,
splice loss = 0.5 dB,
total loss = 16 + 6.45 + 0.5 dB = 22.95 dB.
The power at the output of the DCF is
Pout,DCF = 3 dBm −22.95 dBm = −19.95 dBm.
(2.240)
(c) To keep the signal power at the output of the amplifier the same as the input, the amplifier gain should be
equal to the total loss in the system, i.e.,
amplifier gain = 22.95 dBm.
(2.241)
2.9
Additional Examples
Example 2.12
The numerical aperture of a multi-mode fiber is 0.2. Find the delay between the shortest and longest path. Fiber
length = 2 km and core index = 1.45. Assume that the difference between the core index and the cladding
index is small.
Solution:
The NA is given by Eq. (2.9) as
NA = n1
√
2Δ,
(2.242)

82
Fiber Optic Communications
Δ = (NA)2
2n2
1
,
(2.243)
NA = 0.2, n1 = 1.45.
From Eq. (2.243), we find
Δ = 0.0095.
When the difference between the core index and the cladding index is small, n1 ≈n2 and Eq. (2.17) can be
approximated as
ΔT ≈= n1LΔ
c
,
(2.244)
n1 = 1.45, L = 2 km, Δ = 0.0095, and c = 3 × 108 m/s.
Substituting these values in Eq. (2.244), the delay between the shortest and longest paths is
ΔT = 91.95 ns.
Example 2.13
The propagation constant at the wavelength 𝜆0 = 1550 nm is 6 × 106 rad/m. Calculate the propagation con-
stant at 𝜆1 = 1551 nm. Assume 𝛽1 = 0.5 × 10−8 s/m and 𝛽2 = −10 ps2/km. Ignore 𝛽n, n > 2.
Solution:
From Eq. (2.102), we find
𝛽(𝜔1) = 𝛽0 + 𝛽1(𝜔1 −𝜔0) + 𝛽2(𝜔1 −𝜔0)2∕2.
(2.245)
Using c = f𝜆, we have
𝜔0 = 2𝜋f0 = 2𝜋c
𝜆0
= 1.2161 × 1015 rad/s,
𝜔1 = 2𝜋f1 = 2𝜋c
𝜆1
= 1.2153 × 1015 rad/s,
𝜔1 −𝜔0 = −8.168 × 1011 rad/s,
𝛽0 = 6 × 1016 rad/m.
Substituting these values in Eq. (2.245), we find
𝛽(𝜔1) = 5.9959 × 106 rad/s.
Note that the change in propagation constant is very small.

Optical Fiber Transmission
83
Example 2.14
Consider a fiber-optic system as shown in Fig. 2.38. Fiber loss = 0.2 dB/km, length = 80 km, loss in optical
filter = 0.5 dB, and amplifier gain = 15 dB. If the minimum power required at the receiver to have a good
signal-to-noise ratio is −3 dBm, calculate the lower limit on the transmitter power in dBm and mW units.
Solution:
Fiber loss,
F1(dB) = −0.2 × 80 = −16 dB.
Filter loss,
F2(dB) = −0.5 dB.
Amplifier gain,
G(dB) = 15 dB.
The minimum power required at the receiver is
Pout(dBm) = −3 dBm,
Pout(dBm) = Pin(dBm) + F1(dB) + F2(dB) + G(dB).
Therefore, the lower limit on the transmitter power is
Pin(dBm) = −3 + 16 + 0.5 −15 dBm = −1.5 dBm.
Using Eq. (2.125), the transmitter power in mW units is
Pin = 100.1Pin(dBm) = 0.7079 mW.
Figure 2.38
A fiber-optic system with loss and gain.
Example 2.15
The electric field envelope at the fiber input is
sin(t) = A cos (2𝜋fmt).
(2.246)
Show that the electric field envelope at the fiber output is
sout(t) = A cos (2𝜋fmt) exp [i(2𝜋fm)2𝛽2L∕2] .
(2.247)
Ignore fiber loss and 𝛽1.

84
Fiber Optic Communications
Solution:
Taking the Fourier transform of Eq. (2.246), we find
̃sin(f) = [sin(t)] = A
2 [𝛿(f −fm) + 𝛿(f + fm)],
(2.248)
where 𝛿is the Dirac delta function. From Eq. (2.107), we have the fiber transfer function (after ignoring 𝛽1
and loss)
H(f) = exp [i𝛽2(2𝜋f)2L∕2].
(2.249)
The output spectrum is
̃sout(f) = ̃sin(f)H(f)
= A
2
[𝛿(f −fm) + 𝛿(f + fm)] exp [i𝛽2(2𝜋f)2L∕2] .
(2.250)
Taking the inverse Fourier transform of Eq. (2.250), we obtain
so(t) = A
2 ∫
∞
−∞
[𝛿(f −fm) + 𝛿(f + fm)] exp
[
−i2𝜋ft + i(2𝜋f)2 𝛽2L
2
]
df.
(2.251)
Using the following relation:
∫
∞
−∞
𝛿(f −fm)X(f)df = X(fm),
(2.252)
Eq. (2.251) is simplified as
so(t) = A
2
[exp (−i2𝜋fmt) + exp (i2𝜋fmt)] exp [i(2𝜋fm)2𝛽2L∕2]
= A cos (2𝜋fmt) exp [i(2𝜋fm)2𝛽2L∕2].
(2.253)
Comparing Eqs. (2.246) and (2.253), we find that if the field envelope is a sinusoid, it acquires only a
phase shift.
Example 2.16
Consider a fiber-optic system as shown in Fig. 2.39. A Gaussian pulse is launched into the transmission fiber.
Find the length of DCF so that the pulse width (FWHM) at the output of the DCF is twice the pulse width
at the input of the TF. Assume 𝛽TF
2
= −21 ps2/km, 𝛽DCF
2
= 130 ps2/km, LTF = 80 km. FWHM at the input of
TF = 12.5 ps. Ignore loss and 𝛽1.
Tx
Rx
TF
DCF
Figure 2.39
Fiber-optic system consisting of TF and DCF. TF = transmission fiber, DCF = dispersion-compensating
fiber, Tx = transmitter, and Rx = receiver.

Optical Fiber Transmission
85
Solution:
The effective transfer function is given by Eq. (2.232) as
Heff(f) = exp
{
i
[(𝛽TF
2 LTF + 𝛽DCF
2
LDCF) (2𝜋f)2
2
]}
= exp [i𝛽eff
2 Leff(2𝜋f)2∕2],
(2.254)
where
𝛽eff
2 Leff = 𝛽TF
2 LTF + 𝛽DCF
2
LDCF.
(2.255)
In Example 2.6, we found that when |𝛽2L| =
√
3T2
0, the output pulse width is twice the input pulse width.
Replacing 𝛽2L by 𝛽eff
2 Leff, we find
|𝛽TF
2 LTF + 𝛽DCF
2
LDCF| =
√
3T2
0,
(2.256)
𝛽TF
2
= −21 ps2∕km,
LTF = 80 km,
𝛽DCF
2
= 130 ps2∕km,
TFWHM = 12.5 ps,
T0 = TFWHM∕1.665 = 7.507 ps.
Eq. (2.256) may be written as
−21 × 80 + 130LDCF = ±
√
3 × 7.5072.
Therefore, LDCF = 12.17 km or 13.67 km. As the pulse propagates in the DCF, the pulse undergoes compres-
sion. At LDCF = 12.17 km, the pulse width is twice the initial pulse width. If 𝛽TF
2 LTF = −𝛽DCF
2
LDCF, the pulse
width becomes equal to the initial pulse width. This corresponds to a propagation distance of 12.92 km in the
DCF. After this, pulse broadening takes place and when LDCF = 13.67 km, the output pulse width is twice the
initial pulse width again.
Example 2.17
The zero dispersion wavelength of a transmission fiber (TF) is chosen as 1490 nm, so that the local dispersion
in the desired wavelength range 1530–1560 nm is not zero (so as to avoid the enhancement of nonlinear
effects). Find the accumulated dispersion of the DCF so that the net accumulated dispersion does not exceed
1100 ps/nm. Assume that the dispersion slopes of the TF and DCF are 0.08 ps/nm2/km and 0 ps/nm2/km,
respectively. Total transmission distance = 800 km. Other parameters are the same as in Example 2.10.
Solution:
In the absence of DCF, the dispersion at 1560 nm is
DTF(1560 nm) = 0.08(1560 −1490) ps/nm/km = 5.6 ps/nm/km.
(2.257)
The accumulated dispersion at 1560 nm is
DTFLTF = 4480 ps/nm.
(2.258)

86
Fiber Optic Communications
The net accumulated dispersion is
|DTFLTF + DDCFLDCF| ≤1100 ps/nm.
(2.259)
Therefore, the accumulated dispersion of the DCF should be
DDCFLDCF < −3380 ps/nm.
(2.260)
Example 2.18
Let the input field envelope be
si(t) = A exp
[
−t2 (1 + iC)
2T2
0
]
,
(2.261)
where C is the chirp parameter. Show that the field envelope at the fiber output is
so(t) = AT0
T1
exp
[
−(1 + iC) t2
2T2
1
]
,
where
T1 = [(T2
0 + 𝛽2LC) −i𝛽2L]1∕2.
Plot the power and frequency deviation 𝛿𝜔at different fiber lengths for 𝛽2C > 0 and 𝛽2C < 0. Ignore fiber
loss and 𝛽1.
Solution:
Using Eqs. (2.150) and (2.152), we find
̃si(f) = A
a exp [−𝜋(f∕a)2],
(2.262)
where
a2 = 1 + iC
2𝜋T2
0
.
(2.263)
The output field envelope is given by Eq. (2.155), with b2 = a2∕(1 −i2𝜋𝛽2La2) as,
so(t) = AT0
T1
exp
[
−(1 + iC) t2
2T2
1
]
,
(2.264)
where
T1 = [(T2
0 + 𝛽2LC) −i𝛽2L]1∕2.
(2.265)
As in Example 2.6, the output pulse width can be calculated as
Tout
FWHM = Tin
FWHM
⎡
⎢
⎢⎣
(
1 + C𝛽2L
T2
0
)2
+
(
𝛽2L
T2
0
)2⎤
⎥
⎥⎦
1∕2
.
(2.266)

Optical Fiber Transmission
87
The field envelope may be written as
s(t, z) = A(t, z) exp [i𝜙(t, z)].
(2.267)
The instantaneous frequency deviation from the carrier frequency is given by Eq. (2.165) as
𝛿𝜔(t, z) = −d𝜙
dt .
(2.268)
At the fiber input, we have
𝜙(t, 0) = −t2C
2T2
0
.
(2.269)
So, the instantaneous frequency deviation from the carrier frequency is
𝛿𝜔(t, 0) = Ct
T2
0
.
(2.270)
Fig. 2.40 shows the output pulse width as a function of propagation distance L. As can be seen from
Eq. (2.266), the pulse broadening depends on the sign of 𝛽2C. When 𝛽2C ≥0, the pulse width increases
with distance monotonically. When 𝛽2C < 0, the first term within the square bracket of Eq. (2.266) becomes
less than unity and, therefore, the output pulse width can be less than the input pulse width for certain
distances. Fig. 2.40 shows that the pulse undergoes compression initially for C = 4 and 𝛽2 < 0. The physical
explanation for pulse compression is as follows. When C > 0, from Eq. (2.270), we see that the leading edge
is down-shifted in frequency and the trailing edge is up-shifted at the fiber input. In an anomalous dispersion
fiber (𝛽2 < 0), low-frequency (red) components travel slower than high-frequency (blue) components and,
therefore, the frequency components at the leading edge travel slowly. In other words, they are delayed and
move to the right (later time) as shown by the arrow in Fig. 2.41(a), and the frequency components at the
leading edge move to the left (earlier time), leading to pulse compression as shown in Fig. 2.41(b). Since
the frequency chirp imposed on the pulse at the input is of opposite sign to the frequency chirp developed
via pulse propagation in an anomalous dispersion fiber, these two frequency chirps cancel at L = 12.5 km
and the pulse becomes unchirped (see the bottom of Fig. 2.41(b)). At this distance, the pulse width is the
shortest. Thereafter, pulse propagation is the same as discussed in Example 2.6, leading to pulse broadening.
Figure 2.40
Output pulse width of a chirped Gaussian pulse. 𝛽2 = −21 ps2/km.

88
Fiber Optic Communications
(b)
(a)
(c)
Figure 2.41
Power and frequency deviations of a chirped Gaussian pulse. 𝛽2 = −21 ps2/km, C = +3.
(b)
(a)
(c)
Figure 2.42
Power and frequency deviations of a chirped Gaussian pulse. 𝛽2 = −21 ps2/km, C = −3.

Optical Fiber Transmission
89
If C < 0, at the fiber input, the leading edge is up-shifted in frequency whereas the trailing edge is
down-shifted. The frequency components corresponding to the leading edge travel faster than those
corresponding to the trailing edge in an anomalous dispersion fiber. Therefore, as shown by the arrows in
Fig. 2.42(a), the leading edge moves to the left (earlier time) and the trailing edge moves to the right, which
leads to pulse broadening. The frequency chirp at the fiber input in this case has the same sign (as that due to
dispersion as given by Eq. (2.167)) and, therefore, these two chirps add up, leading to enhanced broadening
as seen in Fig. 2.40 (C = −4) compared with the case of an unchirped pulse.
Exercises
2.1
A step-index fiber has a cutoff wavelength = 900 nm, and NA = 0.22. (a) Calculate the core radius.
(b) What could be the maximum allowable core radius to make this fiber single-moded at 500 nm?
(Ans: (a) 3.44 μm; (b) 2.29 μm.)
2.2
Consider a small fiber section of length ΔL as shown in Fig. 2.43. Let F(ΔL) = P(ΔL)∕Pin. Next,
consider a cascade of identical fiber sections as shown in Fig. 2.44. Let M be the total number of fiber
sections. When M →∞(or ΔL →0), show that
Ftot = Pout
Pin
= exp (−𝛼L),
(2.271)
where 𝛼= −dF∕d(ΔL).
Δ
Δ
Δ
Figure 2.43
An infinitesimal fiber section.
Δ
in
out
Figure 2.44
A fiber of length L with M sections of length ΔL.
Hint: Ftot = [F(ΔL)]L∕ΔL, expand F(ΔL) in a Taylor series with F(0) = 1 and use
e = LimM→∞(1 + 1∕M)M.
(2.272)

90
Fiber Optic Communications
2.3
A step-index multi-mode fiber has to be designed to support bit rates up to 10 Mb/s. The link length is
1.5 km. Calculate the upper limit on the relative index difference, Δ. Assume the core refractive index
is approximately equal to the cladding refractive index.
(Ans: Δ ≤0.02.)
2.4
In a step-index multi-mode fiber, the critical angle for the core–cladding interface is 85∘. The core
refractive index is 1.46 and the core diameter is 100 μm. Find (a) the V-number and (b) the approximate
number of guided modes M at the wavelength 1.3 μm.
(Ans: V = 25.79, M = 332.)
2.5
The maximum achievable bit rate–distance product in a step-index multi-mode fiber is 16 Mb/s⋅km.
The core refractive index n1 (≈cladding index n2) = 1.45. Calculate (a) the numerical aperture and (b)
the critical angle for the core–cladding interface.
(Ans: (a) 0.2795; (b) 1.3768 rad.)
2.6
A step-index multi-mode fiber has an acceptable angle of 0.2077 rad and the critical angle for the
core–cladding interface is 1.4266 rad. Calculate the speed of light in the fiber core. It may be assumed
that ray-optics theory is valid.
(Ans: 2.076 × 108 m/s.)
2.7
A single-mode fiber has to be designed to operate at 1.55 μm with a cutoff wavelength less than 1.5 μm.
The core and cladding refractive indices are 1.45 and 1.445, respectively. Calculate the maximum
allowable core radius.
(Ans: 4.77 μm.)
2.8
The power launched into a fiber is 5 mW and the power at the fiber output is 0.3 mW. Calculate the
fiber loss in dBm units.
(Ans: 12.22 dBm.)
2.9
A 40-km single-mode fiber has a dispersion parameter D = 10 ps/nm⋅km. An optical signal of band-
width 10 GHz is launched into the fiber. Find the delay between the highest- and lowest-frequency
components. The carrier wavelength = 1.55 μm.
(Ans: 32.033 ps.)
2.10
A single-mode fiber has a zero-dispersion wavelength at 1550 nm. The dispersion slope =
0.06 ps/nm2/km. Find the absolute dispersion |D| at 1600 nm. Assume that the dispersion varies
linearly with wavelength.
(Ans: 3 ps/nm/km.)
2.11
A Gaussian pulse is transmitted in a long single-mode fiber with dispersion coefficient 𝛽2 =
−10 ps2/km. The input and output pulse widths (FWHM) are 8 ps and 32 ps, respectively. Calculate
the fiber length.
(Ans: 8.9 km.)

Optical Fiber Transmission
91
2.12
The outputs of CW lasers of frequencies 193.5 THz and 193.6 THz are transmitted over a fiber of
length 2 km. It is found that the lower-frequency optical wave arrived later than the higher-frequency
component by 6 ps. Calculate the dispersion coefficient 𝛽2.
(Ans: −4.77 ps2/km.)
2.13
A fiber-optic link consists of a TF followed by a DCF of length 5 km. The transmission fiber has a dis-
persion parameter D = 10 ps/nm/km, loss = 0.25 dB/km, and length = 50 km. (a) Find the dispersion
parameter of the DCF such that the pulse width (FWHM) at the output of the DCF is the same as the
pulse width at the input of the TF. (b) The power launched into the TF is 2 mW and the power at the
output of the DCF is −12 dBm. Find the loss coefficient of the DCF in dB/km.
(Ans: (a) −100 ps/nm/km; (b) 0.5 dB/km.)
Further Reading
K. Okamoto, Fundamentals of Optical Waveguide, 2nd edn. Academic Press, New York, 2006.
T. Okoshi, Optical Fibers. Academic Press, San Diego, CA, 1982.
L.B. Jeunhomme, Single-mode Fiber Optics, 2nd edn. Marcel Dekker, New York, 1990.
E.G. Neumann, Single-mode Fibers, Springer-Verlag, New York, 1988.
A.W. Snyder and J.D. Love, Optical Waveguide Theory. Chapman & Hall, London, 1983.
J.M. Senior, Optical Fiber Communications, 2nd edn. Prentice-Hall, London, 1992.
H. Kolimbris, Fiber Optic Communications. Prentice-Hall, Englewood Cliffs, NJ, 2004.
R.P. Khare, Fiber Optics and Optoelectronics. Oxford University Press, New York, 2004.
References
[1] C.K. Kao and G.A. Hockham, Proc. IEE, vol. 113, p. 1151, 1966.
[2] R.D. Maurer, D.B. Keck, and P. Schultz, Optical waveguide fibers. US patent no. 3,711,262, 1973.
[3] T. Miya, Y. Terunuma, T. Husaka, and T. Miyoshita, Electron. Lett., vol. 15, p. 106, 1979.
[4] J. Gower, Optical Communication Systems, 2nd edn. Prentice-Hall, London, 1993.
[5] G.P. Agrawal, Fiber-Optic Communication Systems, 4th edn. John Wiley & Sons, New York, 2010.
[6] D. Marcuse, Theory of Dielectric Optical Waveguides, 2nd edn. Academic Press, New York, 1991.
[7] J.A. Buck, Fundamentals of Optical Fibers, 2nd edn. John Wiley & Sons, Hoboken, NJ, 2004.
[8] A. Ghatak and K. Thyagarajan, Optical Electronics. Cambridge University Press, Cambridge, 1991.
[9] D. Gloge, “Weakly guiding fibers,” Appl. Opt., vol. 10, p. 2252, 1971.
[10] D. Marcuse, D. Gloge, and E.A.J. Marcatili, “Guiding properties of fibers.” In S.E. Miller and A.G. Chynoweth
(eds), Optical Fiber Telecommunications. Academic Press, New York, 1979.
[11] A.W. Snyder, IEEE Trans. Microwave Theory Tech., vol. MTT-17, p. 1130, 1969.
[12] G. Keiser, Optical Fiber Communications, 4th edn. McGraw-Hill, New York, 2011.
[13] R.M. Gagliardi and S. Karp, Optical Communications, 2nd edn. John Wiley & Sons, New York, 1995.
[14] Communication News, March 2006. Nelson Publishing, www.comnews.com.
[15] R. Ryf et al., J. Lightwave Technol., vol. 30, p. 521, 2012.
[16] X. Chen et al., Opt. Exp., vol. 20, p. 14302, 2012.
[17] B. Neng et al., Opt. Exp., vol. 20, p. 2668, 2012.
[18] N. Hanzawa et al., Optical Fiber Conference, paper OWA4, 2012.
[19] H.S. Chen, H.P.A. van den Boom, and A.M.J. Koonen, IEEE Photon. Technol. Lett., vol. 23, 2011.
[20] R.P. Feynmann, R.B. Leighton, and M. Sands, The Feyman Lectures on physics, vol. 1, chapter 32. Addison-Wesley,
New York, 1963.

92
Fiber Optic Communications
[21] H. Kanamori et al., J. Lightwave Technol., vol. LT-4, p. 1144, 1986.
[22] Y. Chigusa et al., J. Lightwave Technol., vol. 23, p. 3541, 2005.
[23] H. Osanai et al., Electron. Lett., vol. 12, p. 549, 1976.
[24] G.E. Berkey et al., US patent no. EP1181254 B1, 2006.
[25] F.W. Dabby, US patent no. 20130025326 A1, 2013.
[26] A. Ohashi et al., US patent no. 4,755,022, 1988.
[27] T. Kato et al., US patent no. 5,721,800, 1998.
[28] Y. Liu and M.A. Newhouse, US patent no. EP1158323 A1, 1996.
[29] Corning product sheet information, www.corning.com/opticalfiber.
[30] I.P. Kaminov, IEEE J. Quantum Electron., vol. 17, p. 15, 1981.
[31] S.C. Rashleigh, J. Lightwave Technol., vol. LT-1, p. 312, 1983.
[32] X.-H. Zheng, W.M. Henry, and A.W. Snyder, J. Lightwave Technol., vol. 6, p. 312, 1988.
[33] C.D. Poole, J.H. Winters, and J.A. Nagel, Opt. Lett., vol. 16, p. 372, 1991.
[34] G.J. Foschini and C.D. Poole, J. Lightwave Technol., vol. 9, p. 1439, 1991.
[35] J. Zhou and M.J. O’Mahony, IEEE Photon. Technol. Lett., vol. 6, p. 1265, 1994.
[36] P.K.A. Wai and C.R. Menyuk, J. Lightwave Technol., vol. 14, p. 148, 1996.
[37] A. Galtarossa and C.R. Menyuk (eds), Polarization Mode Dispersion. Springer-Verlag, New York, 2005.
[38] C.D. Poole and R.E. Wagner, Electron. Lett., vol. 22, p. 1029, 1986.
[39] K. Petermann, Electron. Lett., vol. 19, p. 712, 1983.
[40] C. Pask, Electron. Lett., vol. 20, p. 144, 1984.
[41] S. Bickham et al., US patent no. 06671445, 2003.

3
Lasers
3.1
Introduction
LASER is an acronym for light amplification by stimulated emission of radiation. In 1917, Einstein postulated
that an atom in the excited level is stimulated to emit radiation that has the same frequency and phase as the
radiation [1]. This is known as stimulated emission, which remained a theoretical curiosity until Schewlow
and Townes in the USA [2], and Basov and Prokhorov in the USSR, proposed that stimulated emission can be
used in the construction of lasers. Townes, Gordon, and Zeiger built the first ammonia MASER (microwave
amplification by stimulated emission of radiation) at Columbia University in 1953. This device used stim-
ulated emission in a stream of energized ammonia molecules to produce amplification of microwaves at a
frequency of about 24 GHz. In 1960, Maiman demonstrated the ruby laser, which is considered to be the first
successful optical laser [3]. In 1962, the first semiconductor laser diode was demonstrated by a group led by
Hall [4]. The first diode lasers were homojunction lasers. The efficiency of light generation can be significantly
enhanced using double heterojunction lasers, as demonstrated in 1970 by Alferov and his collaborators [5].
Fiber-optic communications would not have progressed without lasers. Lasers have not only revolutionized
fiber-optic communications, but also found diverse applications in laser printers, barcode readers, optical data
recording, combustion ignition, laser surgery, industrial machining, CD players, and DVD technology.
In this chapter, we first discuss the basic concepts such as absorption, stimulated emission, and spontaneous
emission. Next, we analyze the conditions for laser oscillations. After reviewing the elementary semiconduc-
tor physics, the operating principles of the semiconductor laser are discussed.
3.2
Basic Concepts
Consider two levels of an atomic system as shown in Fig. 3.1. Let the energy of the ground state be E1 and
that of the excited state be E2. Let N1 and N2 be the atomic densities in the ground state and excited state,
respectively. If radiation at an angular frequency
𝜔= E2 −E1
ℏ
,
(3.1)
where ℏ= h∕(2𝜋), h = Planck’s constant = 6.626 × 10−34 J ⋅s, is incident on the atomic system, it can inter-
act in three distinct ways [1].
(a) An atom in the ground state of energy E1 absorbs the incident radiation and goes to the excited state
of energy E2, as shown in Fig. 3.2. In other words, an electron in the atom jumps from an inner orbit to an
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

94
Fiber Optic Communications
E2
E1
N2
N1
ħ
E2 − E1
ω =
Figure 3.1
Two-level atomic system interacting with electromagnetic radiation.
(a)
(b)
E2
E1
E2
E1
N2
N1
N2
N1
Figure 3.2
Two-level atomic system absorbing a photon (a) Before absorption and (b) After absorption.
outer orbit. To make this transition, atoms require energy corresponding to the difference in energy levels and
this is provided by the incident electromagnetic radiation. The rate of absorption depends on the population
density in the level E1 and also on the energy spectral density per unit volume of the radiation. Einstein
postulated that the number of atoms undergoing absorption per unit time per unit volume from level 1 to
level 2 is given by
Rabs ≡−
(dN1
dt
)
abs
= B12us(𝜔)N1,
(3.2)
where us(𝜔) is the electromagnetic energy spectral density per unit volume, B12 is a constant, and Rabs is the
rate of absorption. The negative sign in Eq. (3.2) indicates that the population density in level 1 decreases
due to absorption. For example, consider an atomic system of volume 1 m3. If 1015 atoms make an upward
transition per second after absorbing the incident radiation in a volume of 1 m3, the absorption rate is
Rabs = 1015 s−1 m−3. This also means that 1015 photons are absorbed per second per cubic meter.
(b) An atom which is in the excited state of energy E2 is stimulated to emit radiation at frequency
𝜔= (E2 −E1)∕ℏif the radiation at that frequency is already present. After emitting the radiation, it goes
to state of energy E1, as shown in Fig. 3.3. This process is called stimulated emission. Einstein postulated
that the rate of emission is proportional to the energy spectral density of radiation at frequency 𝜔and the
population density at the excited state E2,
Rstim ≡−
(dN2
dt
)
stim
= B21us(𝜔)N2,
(3.3)
(a)
(b)
ħω
E2
E1
E2
E1
N2
N1
N2
N1
Figure 3.3
Two-level atomic system emitting a photon due to stimulated emission (a) Before stimulated emission and
(b) After stimulated emission.

Lasers
95
where Rstim is the stimulated emission rate that is equal to the number of atoms undergoing stimulated emission
per unit time per unit volume, and B21 is a constant.
(c) An atom in the excited state of energy E2 can also make a spontaneous emission and return to the ground
state whether or not the radiation at frequency 𝜔is present, as illustrated in Fig. 3.4. This occurs randomly and
is called spontaneous emission. The rate of spontaneous emission is independent of the intensity of incident
radiation. Therefore,
Rspont ≡−
(dN2
dt
)
spont
= A21N2,
(3.4)
where A21 is a constant and Rspont is the spontaneous emission rate.
At thermal equilibrium between the atomic system and the radiation field, the number of upward transitions
must be equal to the number of downward transitions. If not, for example if downward transition occurs more
frequently than upward transition, this would result in an increase in radiation with time, which implies it is
not in equilibrium. At thermal equilibrium, we have
Rup = Rdown,
(3.5)
Rabs = Rstim + Rspont,
(3.6)
B12us(𝜔)N1 = B21us(𝜔)N2 + A21N2,
(3.7)
us(𝜔) =
A21
(N1∕N2)B12 −B21
.
(3.8)
According to Boltzmann’s law, the ratio of populations of level 1 and level 2 at equilibrium is
N2
N1
= exp (−ΔE∕kBT),
(3.9)
where ΔE = E2 −E1 is the energy difference, kB = 1.38 × 10−23 J/K is Boltzmann’s constant, and T is the
absolute temperature in Kelvin. Since the energy difference ΔE = ℏ𝜔, Eq. (3.9) can be written as
N2 = N1 exp (−ℏ𝜔∕kBT).
(3.10)
Eq. (3.9) is valid for any systems having different energy levels. For example, the number of air molecules
decreases as we go to higher altitudes. If N1 and N2 are the number of molecules near the ground and at
height h, respectively, at thermal equilibrium, their ratio is
N2
N1
= exp
(
−ΔE
kBT
)
= exp
(
−mgh
kBT
)
,
(3.11)
E2
E1
E2
E1
N2
N1
N2
N1
(a)
(b)
Figure 3.4
Two-level atomic system emitting a photon due to spontaneous emission (a) before spontaneous emission
and (b) after spontaneous emission.

96
Fiber Optic Communications
E2 = mgh
E1 = 0 
h
Air
molecules 
Figure 3.5
Air molecules at ground and at height h.
where ΔE = mgh is the energy required to lift a molecule of mass m to the height h, and g is the gravitational
constant (see Fig. 3.5).
Using Eq. (3.10) in Eq. (3.8), we obtain
us(𝜔) =
A21∕B21
(B12∕B21) exp (ℏ𝜔∕kBT) −1.
(3.12)
According to Planck’s law, the energy spectral density per unit volume at thermal equilibrium is given by
us(𝜔) =
ℏ𝜔3n3
0
𝜋2c3
1
exp (ℏ𝜔∕kBT) −1,
(3.13)
where n0 is the refractive index and c is the velocity of light in vacuum. Consider a hollow container heated to
a temperature T by a furnace, as shown in Fig. 3.6. Under thermal equilibrium, if you make a very small hole
and observe the spectrum of radiation, it would look like the curves shown in Fig. 3.7. For all these curves, the
energy of low-frequency and high-frequency components of the electromagnetic waves approaches zero and
the peak of the energy spectral density increases with temperature. A similar experiment was carried out by
Rubens and Kurlbaum [6], and Planck developed a theoretical description for the enclosed radiation [7]. From
his derivation it follows that the energy spectral density at thermal equilibrium is given by Eq. (3.13) and it is
shown in Fig. 3.7, which is in good agreement with the measured data of Rubens and Kurlbaum [6]. Planck
assumed that energy exchange between radiation and matter takes place as a discrete packet or quantum of
Spectrometer
Furnace
Hollow  container
Figure 3.6
The radiation trapped in a hollow container under thermal equilibrium.

Lasers
97
0
1
2
3
4
5
6
7
8
9
10
0
0.2
0.4
0.6
0.8
1
1.2
1.4
1.6
× 10−16
Angular frequency, ω (rad/s)
u(ω), Arb. unit
T = 3000 K 
T = 4000 K 
T = 5000 K 
 × 1015 
Figure 3.7
The energy spectral density as a function of angular frequency under thermal equilibrium.
energy, which is proportional to frequency. Planck’s model and his assumptions to derive the radiation formula
were milestones in the development of quantum mechanics.
The interesting fact is that the energy spectral density at thermal equilibrium depends only on the absolute
temperature and not on the shape of the container or the material type. The radiation is continuously interacting
with the walls of the container but when thermal equilibrium is reached, the intensity of radiation does not
depend on the parameters characterizing the container, but only on the temperature.
Similarly, in the case of the atomic system of Fig. 3.1, radiation interacts with the atoms causing upward
and downward transitions. At thermal equilibrium, the energy spectral density should depend only on tem-
perature. Therefore, the energy spectral density per unit volume given by Eqs. (3.12) and (3.13) should be
equal. Comparing Eqs. (3.12) and (3.13), we find
B12 = B21 ≡B,
(3.14)
A21 =
Bℏ𝜔3n3
0
𝜋2c3
≡A.
(3.15)
The coefficients A and B are called Einstein coefficients. At thermal equilibrium, the ratio of spontaneous
emission rate and stimulated emission rate is given by
Rspont
Rstim
=
A21N2
B21N2us(𝜔) = exp
(
𝜔
𝜔c
)
−1,
(3.16)

98
Fiber Optic Communications
where
𝜔c = kBT
ℏ.
(3.17)
Typically for an optical source, 𝜔> 𝜔c. Therefore, spontaneous emission dominates stimulated emission.
As an example, consider an optical source at temperature T = 300 K:
𝜔c = kBT
ℏ
= 1.38 × 10−23 × 300
1.054 × 10−34
= 3.92 × 1013 rad∕s.
(3.18)
For 𝜔> 3.92 × 1013 rad∕s, radiation would mostly be due to spontaneous emission. If the operating wave-
length of the optical source is 700 nm, 𝜔= 2.69 × 1015 rad/s and
Rspont
Rstim
= exp
(
2.69 × 1015
3.92 × 1013
)
−1 ≃6.34 × 1029.
(3.19)
The above equation indicates that, on average, one out of 6.34 × 1029 emissions is a stimulated emission.
Thus, at optical frequencies, the emission is mostly due to spontaneous emission and hence the light from the
usual light sources is not coherent. From Eqs. (3.2) and (3.3), we see that
Rstim
Rabs
= N2
N1
.
(3.20)
Therefore, the stimulated emission rate exceeds the absorption rate only when N2 > N1. This condition is
called population inversion. For systems in thermal equilibrium, from Eq. (3.10), we find that N2 is always
less than N1 and population inversion can never be achieved. Therefore, all lasers should operate away from
thermal equilibrium. To achieve population inversion, atoms should be pumped to the excited state by means
of an external energy source known as a pump. A flash pump could act as an optical pump and atoms are
excited into higher-energy states through absorption of the pump energy. Alternatively, an electrical pump
can be used to achieve population inversion as discussed in Section 3.8.
The photons generated by stimulated emission have the same frequency, phase, direction, and polariza-
tion as the incident light. In contrast, the spontaneous emission occurs randomly in all directions and both
polarizations, and often acts as noise. In lasers, we like to maximize the stimulated emission by achieving
population inversion.
The Einstein coefficient A is related to the spontaneous emission lifetime associated with state 2 to state 1
transition. Let us consider a system in which stimulated emission is negligible and atoms in the excited state
spontaneously emit photons and return to the ground state. Considering only spontaneous emission, the decay
rate of the excited level is given by Eq. (3.4),
dN2
dt
= −A21N2.
(3.21)
The solution of Eq. (3.21) is
N2(t) = N2(0) exp (−t∕tsp),
(3.22)
where
tsp =
1
A21
.
(3.23)
At t = tsp, N2(t) = N2(0)e−1. Thus, the population density of level 2 reduces by e over a time tsp which is
known as the spontaneous lifetime associated with 2 →1 transition.
So far we have assumed that the energy levels are sharp, but in reality these levels consist of several
sublevels or bands. The spectrum of the electromagnetic waves due to spontaneous or stimulated emission

Lasers
99
from collection of atoms is not perfectly monochromatic; this is because the emission can take place due to
transition from any of the sublevels. The interaction of electromagnetic waves over a range of frequencies
with the two-band system is described by a lineshape function l(𝜔). Out of N2 (or N1) atoms per unit volume,
N2l(𝜔)d𝜔(or N1l(𝜔)d𝜔) atoms interact with electromagnetic waves in the frequency interval [𝜔, 𝜔+ d𝜔].
The lineshape function is normalized such that
∫N2l(𝜔)d𝜔= N2.
(3.24)
In other words, N2 represents the total number of atoms per unit volume in band 2 and N2l(𝜔)d𝜔represents
the fraction of atoms per unit volume that could interact with radiation ranging from 𝜔to 𝜔+ d𝜔. Therefore,
the total stimulation rate per unit volume is
Rstim = ∫Bus(𝜔)l(𝜔)N2d𝜔.
(3.25)
Similarly, the absorption rate per unit volume is modified as
Rabs = ∫Bus(𝜔)l(𝜔)N1d𝜔.
(3.26)
Let us consider a special case in which the radiation is a monochromatic wave of frequency 𝜔0. The energy
spectral density per unit volume of a monochromatic wave is an impulse function given by
us(𝜔) = u𝛿(𝜔−𝜔0)∕(2𝜋).
(3.27)
Since the energy spectral density is energy per unit frequency interval, its integration over frequency is energy.
Therefore,
∫us(𝜔)d𝜔= u ∫𝛿(𝜔−𝜔0)d𝜔∕(2𝜋) = u.
(3.28)
Here, u is energy per unit volume or energy density. Substituting Eq. (3.27) in Eqs. (3.25) and (3.26), we find
Rstim = Bul(𝜔0)N2,
(3.29)
Rabs = Bul(𝜔0)N1.
(3.30)
By letting Bl(𝜔0) →B, Eqs. (3.29) and (3.30) are the same as Eqs. (3.3) and (3.2), respectively, with the
exception that us is replaced by energy density u.
Example 3.1
In an atomic sytem, the spontaneous lifetime associated with 2 →1 transition is 2 ns and the energy difference
between the levels is 2.4 × 10−19 J. Calculate the Einstein A and B coefficients. Assume that the velocity of
light in the medium is 1.25 × 108 m∕s.
Solution:
From Eq. (3.23), we have
A21 = 1
tsp
= 5 × 108 s−1.

100
Fiber Optic Communications
The energy difference ΔE is
ΔE = ℏ𝜔,
𝜔= ΔE∕ℏ= 2.28 × 1015 rad/s.
From Eq. (3.15), we have
B = A𝜋2𝑣3
ℏ𝜔3 ,
where 𝑣= c∕n0 is the velocity of light in the medium. With 𝑣= 1.25 × 108 m/s, we obtain
B = 5 × 108 × 𝜋2 × (1.25 × 108)3
1.054 × 10−34 × (2.28 × 1015)3
= 7.71 × 1021 m3∕J ⋅s2.
Example 3.2
The energy levels of an atomic system are separated by 1.26 × 10−19 J. The population density in the ground
state is 1019 cm−3. Calculate (a) the wavelength of light emitted, (b) the ratio of spontaneous emission rate to
stimulated emission rate, (c) the ratio of stimulated emission rate to absorption rate, and (d) the population
density of the excited level. Assume that the system is in thermal equilibrium at 300 K.
Solution:
(a) The energy difference
ΔE = ℏ𝜔= ℏ2𝜋f
= hf,
where h = ℏ2𝜋= 6.626 × 10−34 J ⋅s and
f = ΔE
h
= 1.26 × 10−19
6.626 × 10−34 = 191 THz.
The wavelength of the light emitted is given by
𝜆= c
f =
3 × 108
191 × 1012 = 1.56 μm.
(b) The ratio of spontaneous emission to stimulated emission rate is given by Eq. (3.16),
Rspont
Rstim
= eℏ𝜔∕kBT −1 = eΔE∕kBT −1,
kB = 1.38 × 10−23 J∕K,
T = 300 K,
Rspont
Rstim
= exp
(
1.26 × 10−19
1.38 × 10−23 × 300
)
−1
= 1.88 × 1013.

Lasers
101
(c) From Eq. (3.20), we have
Rstim
Rabs
= N2
N1
.
According to Boltzmann’s law,
N2 = N1e−ℏ𝜔∕kBT,
Rstim
Rabs
= e−ℏ𝜔∕kBT = exp
(
−1.26 × 10−19
1.38 × 10−23 × 300
)
= 5.29 × 10−14.
(d) The population density of the excited level is
N2 = N1e−ℏ𝜔∕kBT
= 5.29 × 105 cm−3.
3.3
Conditions for Laser Oscillations
Consider a lossless gain medium as shown in Fig. 3.8, in which the incident light wave is amplified by stim-
ulated emission. The optical intensity at z can be phenomenologically described as
(z) = (0) exp (gz),
(3.31)
where g is the gain coefficient associated with stimulated emission. For the atomic system with two levels, an
expression for g can be obtained in terms of the population densities N1, N2 and the Einstein coefficient B (see
Section 3.6 for details). By differentiating (z) with respect to z, Eq. (3.31) can be rewritten in differential
form as
d
dz = g(0) exp (gz)
= g.
(3.32)
The optical field is attenuated in the gain medium due to scattering and other possible loss mechanisms
similar to attenuation in optical fibers. The effect of loss is modeled as
(z) = (0) exp (−𝛼intz),
(3.33)
Gain medium
L
I(0)
I(L) = I(0)exp(gL)
Figure 3.8
Light amplification in a gain medium.

102
Fiber Optic Communications
where 𝛼int is the coefficient of internal loss due to scattering and other loss mechanisms in the gain medium.
The gain and attenuation occur simultaneously in the gain medium. So, we have
(z) = (0) exp (gnetz),
(3.34)
where gnet = g −𝛼int is the coefficient of the net gain.
A laser is an oscillator operating at optical frequencies. Just like an electronic oscillator, the optical oscillator
(laser) has three main components: (i) amplifier, (ii) feedback, and (iii) power supply, as shown in Fig. 3.9.
The atomic system we have discussed before can act as a gain medium and the light is amplified by stimulated
emission. The feedback is provided by placing the gain medium between two mirrors, as shown in Fig. 3.10.
The optical or electrical pumps required to achieve population inversion are the power supply.
Consider the optical wave propagating in the Fabry–Perot (FP) cavity shown in Fig. 3.10. Let (0) be the
optical intensity at A. After passing through the gain medium, the intensity is (0) exp (gnetL), where L is the
length of the cavity. The light wave is reflected by the mirror at B, whose reflectivity is R2. This means that
the reflected intensity at B is R2(0) exp (gnetL). The reflected field passes through the gain medium again and
is reflected by the mirror at A with reflectivity R1. The optical intensity after a round trip is (see Fig. 3.11)
(0)R1R2 exp [2(g −𝛼int)L].
(3.35)
The condition for laser oscillation is that the optical intensity after one round trip should be the same as the
incident intensity (0). Otherwise, after several round trips, the optical intensity in the cavity would be too
Amplifier 
Power Supply
Feedback
Figure 3.9
The structure of an optical oscillator (laser) or electronic oscillator.
Gain medium
R1
R2
z = 0 
z = L
A
B
Figure 3.10
The Fabry–Perot cavity formed by mirrors.

Lasers
103
exp[(g − αint)L]
z = 0
A
R2
R1
B
... ...
A
B
one round trip
R2
I(0)
exp[(g − αint)L]
exp[(g − αint)L]
Figure 3.11
Illustration of multiple reflections in a FP cavity.
low or too high. For a stable laser operation, we need
(0)R1R2 exp [2(g −𝛼int)L] = (0).
(3.36)
Simplifying Eq. (3.36), we find
g = 𝛼int + 1
2L ln
(
1
R1R2
)
.
(3.37)
In Eq. (3.37), the second term represents the loss due to mirrors,
𝛼mir = 1
2L ln
(
1
R1R2
)
.
(3.38)
Using Eq. (3.38) in Eq. (3.37), we find
g = 𝛼int + 𝛼mir = 𝛼cav,
(3.39)
where 𝛼cav is the total cavity loss coefficient. Therefore, to have a stable laser operation, one of the essential
conditions is that the total cavity loss should be equal to the gain. Suppose you are on a swing. Because of
the frictional loss, the oscillations will be dampened and it will stop swinging unless you pump yourself or
someone pushes you. To have sustained oscillations, the frictional loss should be balanced by the gain due to
“pumping.” In the case of a laser, the gain is provided by optical/electrical pumps. A monochromatic wave
propagating in the cavity is described by a plane wave,
𝜓= 𝜓0 exp [−i(𝜔t −kz)].
(3.40)
The phase change due to propagation from A to B is kL. And the phase change due to a round trip is 2kL.
The second condition for laser oscillation is that the phase change due to a round trip should be an integral
multiple of 2𝜋,
2kL = 4𝜋n
𝜆0
L = 2m𝜋,
m = 0, ±1, ±2, …
(3.41)
Otherwise, the optical field 𝜓at A would be different after each round trip. Here, 𝜆0 is the wavelength in free
space and n is the refractive index of the medium. If the condition given by Eq. (3.41) is not satisfied, the
superposition of the field components after N round trips,
𝜓N = 𝜓0 exp (−i𝜔t)
N
∑
n=0
exp (i2knL),
(3.42)

104
Fiber Optic Communications
approaches zero as N →∞. This is because sometimes the field component after a round trip may be positive
and sometimes it may be negative, and the net sum goes to zero if m is not an integer. When m is an integer,
the optical fields after each round trip add up coherently.
From Eq. (3.41), we see that only a discrete set of frequencies or wavelengths are supported by the cavity.
They are given by
𝜆m = 2nL
m ,
m = 1, 2, … ,
(3.43)
or
fm = mc
2nL.
(3.44)
These frequencies correspond to the longitudinal modes of the cavity, and can be changed by varying the
cavity length L. The laser frequency f must match one of the frequencies of the set fm, m = 1, 2, … The
spacing Δf between longitudinal modes is constant,
Δf = fm −fm−1 =
c
2nL.
(3.45)
The longitudinal spacing Δf is known as the free spectral range (FSR). In a two-level atomic system, the
gain would occur only for the frequency 𝜔= (E2 −E1)∕ℏ. However, in practical systems, these levels are
not sharp; each level is a broad collection of sublevels and, therefore, the gain would occur over a range of
frequencies. Fig. 3.12 shows the loss and gain profiles of a FP laser. Many longitudinal modes of the FP
cavity experience gain simultaneously. The mode for which the gain is equal to the loss (shown as the lasing
mode) becomes the dominant mode. In theory, other modes should not reach the threshold since their gain
is less than the loss of the cavity. In practice, the difference in gain between many modes of the cavity is
extremely small, and one or two neighboring modes on each side of the main mode (lasing mode) carry a sig-
nificant fraction of power. Such a laser is called a multi-longitudinal-mode laser. Fig. 3.13 shows the output
of a multi-longitudinal-mode laser. If a multi-longitudinal-mode laser is used in fiber-optic communication
systems, each mode of the laser propagates at a slightly different group velocity in the fiber because of dis-
persion, which leads to intersymbol interference at the receiver. Therefore, for high-bit-rate applications, it
is desirable to have a single-longitudinal-mode (SLM) laser. A distributed Bragg grating is used to obtain a
single longitudinal mode, as discussed in Section 3.8.5.
Frequency, f
Gain coefficient
Cavity loss
Lasing mode
Longitudinal
modes 
c/2nL
αcav
Figure 3.12
Loss and gain profiles of a Fabry–Perot laser.

Lasers
105
Frequency,  f
Longitudinal modes
c/2nL
Figure 3.13
The output spectrum of a Fabry–Perot laser.
Eq. (3.31) provides the evolution of the optical intensity as a function of the propagation distance. Some-
times, it is desirable to find the evolution of the optical intensity as a function of time. To obtain the time
rate of change of the optical intensity, we first develop an expression relating optical intensity and energy
density u. The optical intensity is power P per area S, which is perpendicular to the direction of propagation,
= P
S .
(3.46)
The power is energy ΔE per unit time,
P = ΔE
Δt ,
(3.47)
where Δt is a suitably chosen time interval. Combining Eqs. (3.46) and (3.47), we find
= ΔE
SΔt.
(3.48)
Fig. 3.14 shows the optical intensity at z and z + Δz. The number of photons crossing the area S at z + Δz
over a time interval Δt is the same as the number of photons present in the volume SΔz if
Δz = 𝑣Δt,
(3.49)
where 𝑣is the speed of light in the medium. For example, if Δt is chosen as 1 ns, Δz is 0.2m assuming
𝑣= 2 × 108 m∕s. Using Eq. (3.49) in Eq. (3.47), Eq. (3.46) becomes
= ΔE𝑣
SΔz = u𝑣,
(3.50)
where u is the energy density or energy per unit volume. Since I ∝u, Eq. (3.32) can be written as
du
dz = gu.
(3.51)

106
Fiber Optic Communications
Area S 
z
z + ∆z
I(z + ∆z)
Atomic system
I(z)
Figure 3.14
Optical intensity incident on the atomic system of volume SΔz.
Eq. (3.51) provides the rate of change of energy density as a function of the propagation distance in the gain
medium. This can be converted to the time rate of change of energy density by using dz = 𝑣dt,
du
𝑣dt = gu,
(3.52)
du
dt = Gu,
(3.53)
where
G = 𝑣g.
(3.54)
If we include the cavity loss, Eq. (3.53) should be modified as
du
dt = (G −𝑣𝛼cav)u.
(3.55)
Note that the cavity loss has a contribution from internal loss and mirror loss. The mirror loss is lumped,
whereas the internal loss is distributed. Therefore, Eq. (3.55) becomes inaccurate for time intervals less than
the transit time 2L∕𝑣.
Example 3.3
A Fabry–Perot laser has the following parameters: internal loss coefficient 50 dB/cm, R1 = R2 = 0.3, and
distance between mirrors = 500 μm. Calculate the longitudinal mode spacing and the minimum gain required
for laser oscillation. Assume that the refractive index n = 3.5.
Solution:
The longitudinal mode spacing Δf is given by Eq. (3.45),
Δf =
c
2nL =
3 × 108
2 × 3.5 × 500 × 10−6 = 85.71 GHz.
The minimum gain required is
g = 𝛼int + 𝛼mir,
𝛼mir = 1
2L ln
1
R1R2
.

Lasers
107
The internal loss is given in dB/cm. To convert this into cm−1, consider a length of 1 cm. The loss over a
length of 1 cm is 50 dB,
Pout = Pin exp (−𝛼int.1 cm).
10 log10
Pout
Pin
= −50 dB,
10 log10e−𝛼int.1 cm = −𝛼int × 1 cm × 10 log10e = −50 dB,
𝛼int (cm−1) =
50
4.3429 cm−1 = 11.51 cm−1.
The distance between mirrors, L = 0.05 cm:
R1 = R2 = 0.3,
𝛼mir (cm−1) =
1
2 × 0.05 ln
1
0.32
= 24.07 cm−1,
and
g = 𝛼int + 𝛼mir
= (11.51 + 24.07) cm−1
= 35.58 cm−1.
Example 3.4
In a gain medium, under steady-state conditions, the mean power is 20 mW. The area perpendicular to the
direction of light propagation is 100 μm2. The refraction index of the gain medium is 3.2. Calculate the energy
density.
Solution:
The optical intensity is power per unit area perpendicular to the direction of light propagation,
= P
A =
20 × 10−3
100 × 10−12 = 2 × 108 W/m2.
The relation between optical intensity and energy density is given by Eq. (3.50),
I = u𝑣
= uc
n .
The energy density is
u = nI
c = 3.2 × 2 × 108
3 × 108
= 2.13 J/m3.

108
Fiber Optic Communications
3.4
Laser Examples
3.4.1
Ruby Laser
The ruby laser was the first laser to be operated and it was demonstrated by Maiman [3] at the Hughes
Research Laboratory in early 1960. The ruby laser is a three-level laser system, as shown in Fig. 3.15. The
three-level system consists of a ground level with energy E1, a metastable level with energy E2, and a third
level with energy E3. Under thermal equilibrium, the number of chromium ions of the ruby crystal in level 2
is less than that in level 1 and, therefore, laser action can not be achieved. The chromium ions absorb the light
of a flash lamp and make transitions to the level with energy E3. The upper pumping level (E3) is actually a
broad collection of levels and, therefore, an optical source such as a flash lamp with wide spectrum can be
used as the optical pump. The chromium ions drop down to a level with energy E2 by rapid non-radiative
transition. The chromium ions spend an unusually long time at the metastable state E2. As a result, the
population density of level 2 becomes more than that of the ground state, and the population inversion is
achieved. The chromium ions make transitions from level 2 to level 1 by emitting photons of wavelength
694 nm corresponding to red light.
3.4.2
Semiconductor Lasers
The energy levels of electrons and holes are similar to the two-level atomic system we have discussed before. If
an electron is recombined with a hole, the energy difference between them is released as radiation. To achieve
population inversion, we need to have more electrons in the conduction band than in the valence band. This
is done by means of an electrical pumping scheme. We will discuss these issues in detail in Section 3.8.
3.5
Wave–Particle Duality
We know that light acts as a wave in free space, and propagation is governed by the wave equation. However,
when light interacts with matter, it may act like a particle. This is known as wave–particle duality. Although
Maxwell’s equations explain the effects such as interference and diffraction resulting from the wave nature of
light, they fail to explain the effects associated with light–matter interaction such as the photoelectric effect.
Light can be imagined to consist of particles known as photons of energy
E = ℏ𝜔,
(3.56)
E2
E1
Non-radiative
transition 
E3
Strong red fluorescence
694 nm 
Optical
pumping
by flash
lamp 
Figure 3.15
Ruby laser–a three-level laser system.

Lasers
109
where 𝜔is the angular frequency. In the wave picture, the optical field of a plane wave can be written as
𝜓= A exp [−i(𝜔t −kxx −kyy −kzz)].
(3.57)
It has four degrees of freedom, 𝜔, kx, ky, and kz. If we imagine light as a particle, it has four degrees of freedom
too. They are energy E and momenta px, py, and pz in the x-, y- and z-directions, respectively. Energy (particle
picture) and frequency (wave picture) are related by Eq. (3.56). Similarly, the wave vector components are
related to the momenta by
px = ℏkx,
py = ℏky,
pz = ℏkz,
(3.58)
or
p = ℏk,
(3.59)
where
p = pxx + pyy + pzz,
(3.60)
k = kxx + kyy + kzz.
(3.61)
From Eq. (3.59), we see that the photon carries a momentum in the direction of propagation. The magnitude
of the momentum is
p = |p| = ℏ|k| = ℏk.
(3.62)
If k = kxx + kyy + kzz,
p = ℏ
√
k2
x + k2
y + k2
z.
(3.63)
Light is a wave in free space, but it sometimes acts like a particle when it interacts with matter. In the early
1920s, De Broglie proposed that every particle (atom, electron, photon, etc.) has a wave nature associated
with it. If a particle has energy E and momentum p, the angular frequency associated with its wave part is
E∕ℏand the wave vector is k = p∕ℏor the wavenumber is
k = 2𝜋
𝜆= p
ℏ,
(3.64)
or
𝜆= 2𝜋ℏ
p .
(3.65)
This wavelength is called the De Broglie wavelength. The wave nature of particles has been confirmed by
several experiments. The first electron-diffraction experiment was done by Davisson and Germer in 1927 [8].
In this experiment, the incident beam was obtained by the acceleration of electrons in an electrical potential
and diffraction of the electron beam by a single crystal is studied. This experiment showed that electrons
behave as waves, exhibiting the features of diffraction and interference. From the electron interference pattern,
it is possible to deduce the experimental value of the electron wavelength which is in good agreement with
De Broglie’s formula, Eq. (3.65). However, it turns out that these are not real waves, but probabilistic waves.
If electrons were matter waves, we would expect that the intensity of the interference pattern should reduce
as the intensity of the incident beam decreases, but the interference pattern should not become discontinuous;
electron diffraction experiments contradict the above property of a matter wave. If the intensity of the incident
electron beam in these experiments is reduced to a very low value, we would observe a single impact either on
the central spot or on one of the diffraction rings, which shows the particle nature of electrons. The simplest
interpretation we could give of wave–particle duality is a statistical interpretation: the intensity of the wave
at each point on the diffraction pattern gives the probability of occurence of an impact at that point [9].

110
Fiber Optic Communications
The energy and momentum of a free non-relativistic particle are related by
E = p2
2m0
= ℏ2k2
2m0
= ℏ2
2m0
(2𝜋
𝜆
)2
,
(3.66)
where m0 is the mass of a particle. Thus, an electron with high energy has a large momentum or in other words,
has a short wavelength (see Eq. (3.65)). Typically, the highest achievable resolution of an optical microscope is
of the order of the wavelength of the light used (∼0.4 −2 μm) and, therefore, it is hard to study the structure
of a nanoparticle using optical microscopes. If we increase the energy of an electron, the corresponding
De Broglie wavelength can be made quite small. This property is the principle behind electron microscopy.
The energy can be measured in several units, such as Joules (J) and electron volts (eV). Voltage is defined
as the potential energy E per unit charge,
V = E
q .
(3.67)
The energy required to carry an electron of charge 1.602 × 10−19 C over a potential barrier of 1 V is 1 eV.
With q = 1.602 × 10−19 C and V = 1 volt, from Eq. (3.67) we have
E = qV
= 1.602 × 10−19 × 1 J
= 1 eV.
(3.68)
Note that the electron volt is not a unit of voltage, but of energy.
Example 3.5
The energy difference between the two states of an ammonia maser is 10−4 eV. Calculate the frequency of
the electromagnetic wave emitted by stimulated emission.
Solution:
E = 10−4 eV = 10−4 × 1.602 × 10−19 J,
f =
E
2𝜋ℏ= 10−4 × 1.602 × 10−19
2𝜋× 1.054 × 10−34
= 24 GHz.
3.6
Laser Rate Equations
In this section, we consider the gain rate and loss rate of photons and population densities in states 1 and 2 due
to stimulated emission, spontaneous emission, and various loss mechanisms. This is similar to the population
growth rate of a country. The population of a country increases due to new births and immigration, while it
decreases due to death and migration to other countries. Suppose N(t) is the population at t, the net rate of
population growth may be modeled as
dN
dt = Rborn + Rimmigration + Rdeath + Rmigration.
(3.69)
To model lasers, we follow a similar approach. Let us consider the atomic system with two levels. The popula-
tion density of the excited state decreases due to stimulated emission, spontaneous emission, and non-radiative

Lasers
111
transition, while it increases due to absorption and external pumping. The net growth rate of the population
density of state 2 is
dN2
dt
= Rpump + Rabs + Rstim + Rspont + Rnr.
(3.70)
Here, Rabs, Rstim, and Rspont are given by Eqs. (3.2), (3.3), and (3.4), respectively. Rpump refers to the pumping
rate, which is the rate at which the population density of state 2 grows due to an external pump. A specific
pumping scheme is discussed in Section 3.8.
An atom in state 2 could drop down to state 1 by releasing the energy difference as translational, vibra-
tional, or rotational energies of the atom or nearby atoms/molecules. This is known as non-radiative transition,
since no photon is emitted as the atom makes transition from state 2 to state 1 and Rnr represents the rate of
non-radiative transition from state 2 to state 1. It is given by
Rnr = CN2,
(3.71)
where C is a constant similar to the Einstein coefficient A.
Using Eqs. (3.2), (3.3), (3.4), and (3.71) in Eq. (3.70), we find
dN2
dt
= Rpump + BuN1 −BuN2 −(A + C)N2.
(3.72)
The population density of the ground state increases due to stimulated emission, spontaneous emission, and
non-radiative transition, while it decreases due to absorption. The rate of change of the population density of
the ground state is
dN1
dt = Rstim + Rspont + Rnr + Rabs
= BuN2 + (A + C)N2 −BuN1.
(3.73)
Next, let us consider the growth rate of photons. Let Nph be the photon density. When an atom makes a
transition from the excited state to the ground state due to stimulated emission, it emits a photon. If there are
Rstim transitions per unit time per unit volume, the growth rate of photon density is also Rstim. The photon
density in a laser cavity increases due to stimulated emission and spontaneous emission, while it decreases
due to absorption and loss in the cavity. The growth rate of photon density is given by
dNph
dt
= Rstim + Rspont + Rabs + Rloss.
(3.74)
Here, Rloss refers to the loss rate of photons due to internal loss and mirror loss in the cavity. Since the energy
of a photon is ℏ𝜔, the mean number of photons present in the electromagnetic radiation of energy E is
nph = E
ℏ𝜔.
(3.75)
The photon density Nph is the mean number of photons per unit volume and the energy density u is the energy
per unit volume. Therefore, they are related by
Nph =
nph
V =
E
ℏ𝜔V = u
ℏ𝜔.
(3.76)
In Section 3.3, we developed an expression for the time rate of change of the energy density u in the presence
of stimulated emission and loss as
du
dt = (G −𝑣𝛼cav)u.
(3.77)

112
Fiber Optic Communications
Since u ∝Nph, the time rate of change of photon density is
dNph
dt
= GNph −
Nph
𝜏ph
,
(3.78)
where
𝜏ph =
1
𝑣𝛼cav
(3.79)
is the photon lifetime. In the absence of gain (G = 0), Eq. (3.78) can be solved to yield
Nph(t) = Nph(0) exp (−t∕𝜏ph).
(3.80)
At t = tph, Nph(t) = Nph(0)e−1. Thus, the photon density reduces by e over a time tph. In Eq. (3.78), G repre-
sents the net gain coefficient due to stimulated emission and absorption and, therefore, the first term on the
right-hand side of Eq. (3.78) can be identified as
Rstim + Rabs = GNph,
(3.81)
or
BuN2 −BuN1 = GNph.
(3.82)
Since u = Nphℏ𝜔, from Eq. (3.82) we find
G = B(N2 −N1)ℏ𝜔.
(3.83)
In Eq. (3.78), the second term represents the loss, rate due to scattering, mirror loss, and other possible loss
mechanisms,
Rloss = −
Nph
𝜏ph
.
(3.84)
Eq. (3.78) does not include the photon gain rate due to spontaneous emission. Using Eqs. (3.81), (3.84), and
(3.4) in Eq. (3.74), we find
dNph
dt
= GNph + AN2 −
Nph
𝜏ph
.
(3.85)
Note that when N2 > N1, population inversion is achieved, G > 0 (see Eq. (3.83)) and amplification of photons
takes place. In other words, the energy of the atomic system is transferred to the electromagnetic wave. When
N2 < N1, the electromagnetic wave is attenuated and the energy of the wave is transferred to the atomic system.
Using Eq. (3.82), Eqs. (3.72) and (3.73) can be rewritten as
dN2
dt
= Rpump −GNph −N2
𝜏21
,
(3.86)
dN1
dt
= GNph + N2
𝜏21
,
(3.87)
where
𝜏21 =
1
A + C
(3.88)
is the lifetime associated with spontaneous emission and non-radiative decay from the excited state to the
ground state. Eqs. (3.86) and (3.87) can be simplified further under the assumption that the population density

Lasers
113
of the ground state is negligibly small compared with the population density of the excited state [10, 11].
Assuming N1 ≈0, Eqs. (3.86) and (3.85) become
dN2
dt
= Rpump −GNph −N2
𝜏21
,
(3.89)
dNph
dt
= GNph + AN2 −
Nph
𝜏ph
,
(3.90)
where
G = BN2ℏ𝜔.
(3.91)
The equations describing the population densities of electrons and photons in a semiconductor laser are
similar to Eqs. (3.89) and (3.90). In Section 3.8, we will solve Eqs. (3.89) and (3.90) for a specific pump-
ing scheme.
3.7
Review of Semiconductor Physics
In conductors, such as metals, electrons move around freely in the lattice and are available for conduction.
These electrons can be drifted by applying an electric field across its terminals. In contrast, the insulators
hardly have free electrons in the lattice and, therefore, they do not conduct. Semiconductor materials have
conduction properties that are typically intermediate between that of a metal and an insulator. For example,
silicon has four electrons in its outermost shell, by which it makes covalent bonds with its neighboring atoms,
as shown in Fig. 3.16. These electrons are somewhat loosely bound. An electron can gain energy by external
means, such as thermal energy, to break the covalent bond and, thereby, contribute to the conduction band.
Si
Si
Si
Si
Si
Figure 3.16
Covalent band structure of silicon.

114
Fiber Optic Communications
Loosely speaking, if an electron is confined to the outermost shell of the atom, it is said to be in the valence
band and if it is moving freely in the lattice, it is said to be in the conduction band. Strictly speaking, atoms of
solid-state materials have such a strong interaction that they cannot be treated as individual entities. Valence
electrons are not attached to individual atoms, instead, they belong to the system of atoms as a whole.
The conduction band and valence band are separated by an energy gap, or band gap Eg, as shown in Fig. 3.17.
For Si, the band gap is 1.1 eV. At low temperature, the chance that an electron occupies the conduction band
is approximately proportional to exp (−Eg∕kBT). Materials with a filled valence band and a large band gap
(>3 eV) are insulators. Those for which the gap is small or non-existent are conductors. Semiconductors have
band gaps that lie roughly in the range of 0.1 to 3 eV.
At very low temperature, the conduction band is nearly empty and, therefore, the valence band is nearly full,
as shown in Fig. 3.18. As the temperature increases, electrons in the valence band gain energy to cross the
band gap and get into the conduction band. This leads to a concentration of free electrons in the conduction
band, which leaves behind equal numbers of vacancies or holes in the valence band. A hole refers to the
absence of an electron and it acts as if it is a positive charge. Consider a semiconductor material connected to
the terminals of a battery, as shown in Fig. 3.19. The electron in the leftmost region is attracted to the positive
terminal of the battery and it leaves behind a hole (Fig. 3.19(a)). An electron from the neighboring atom jumps
to fill the hole, thereby creating a hole as shown in Fig. 3.19(b). This process continues, and holes move to
the right constituting a hole current. In addition, electrons moving freely in the lattice are also attracted to the
positive terminal constituting the electron current. Free electrons can move far more easily around the lattice
than holes. This is because the free electrons have already broken the covalent bond, whereas for a hole to
travel through the structure, an electron must have sufficient energy to break the covalent bond each time a
hole jumps to a new position.
When an electron comes out of the outermost shell of an atom after picking up thermal energy, it does not
really become a free particle. This is because the electron is in periodic Coulomb potential due to atoms in
the lattice, as shown in Fig. 3.20. Consider an electron in the vicinity of atom 1. There is a chance that it will
Conduction band
Valence band
Eg
Conduction band
Valence band
Eg
Conduction band
Valence band
Eg
Insulators
Semiconductors
Conductors
Figure 3.17
Energy band diagrams.
Conduction band
Valence band
At T = 0 K  
Conduction band
Valence band
At moderate  temperature 
Electrons
Holes
Figure 3.18
Temperature dependence of electron density in the conduction band.

Lasers
115
Si
(a)
(b)
(c)
Si
Si
Si
Si
Si
Si
Si
Si
+
‒
+
‒
+
‒
Figure 3.19
Electron and hole current in Si.
+
+
+
+
.... ....
.... ....
Atom 1
Atom 2
Atom 3
Atom n
Figure 3.20
Electron in a periodic Coloumb potential.
be attracted toward the nucleus of atom 2. When it is in the vicinity of atom 2, there is a chance that it will
be attracted toward atom 3 or atom 1. An alectron can hop on and off from atom to atom as if it were a free
classical particle, but with the following difference. A free non-relativistic particle can acquire any amount of
energy and the energy states are continuous. However, for an electron in periodic potential, there is a range of
energy states that are forbidden and this is called the energy band gap. The existence of a band gap can only
be explained by quantum mechanics. At very low temperature, electrons have energy states corresponding
to valence bands. As the temperature increases, electrons occupy energy states corresponding to conduction
bands, but are not allowed to occupy any energy states that are within the band gap, as shown in Fig. 3.21.
For a free electron, the energy increases quadratically with k as given by Eq. (3.66),
E = ℏ2k2
2m0
,
(3.92)
where m0 is the rest mass of an electron. Differentiating Eq. (3.92) twice, we find
m0 =
ℏ2
d2E∕dk2 .
(3.93)
The dotted line in Fig. 3.21 shows the plot of energy as a function of the wavenumber, k, for the free electron.
For an electron in a pure semiconductor crystal, the plot of energy vs. wavenumber is shown as a solid line.
We define the effective mass of an electron in the periodic potential as
meff(k) =
ℏ2
d2E∕dk2
(3.94)
in the allowed range of energy states, in analogy with the case of free electrons. The effective mass can be
larger or smaller than the rest mass, depending on the nature of the periodic potential. For example, for GaAs,

116
Fiber Optic Communications
Energy
Wavenumer, k
Band gap 1
(Forbidden energy states)
Allowed energy states
Band gap 2
Free electron
Eg1
Valence band edge
Figure 3.21
Plot of energy vs. wavenumber. The dotted line and solid line correspond to the energy of a free electron
and an electron in a pure semiconductor crystal, respectively.
meff = 0.07m0 in the conduction band. The significance of the effective mass can be explained as follows.
Suppose an electron in the pure semiconductor crystal is subjected to an external electric field intensity, 𝜓,
then the equation of motion is given by Newton’s law,
d(meff𝑣)
dt
= force = q𝜓,
(3.95)
where 𝑣and q are the velocity and charge of an electron, respectively. Note that an electron in a pure semicon-
ductor crystal behaves as if it is a free particle with effective mass meff. An electron with meff < m0 experiences
more acceleration than a free electron subjected to the same force q𝜓.
The chance that an electron occupies an energy state E in thermal equilibrium is described by the
Fermi–Dirac function [12]
f(E) =
1
exp [(E −EF)∕kBT] + 1,
(3.96)
where EF is called the Fermi level. From Eq. (3.96), we see that when E = EF, f(E) = 0.5. Fig. 3.22 shows
the Fermi–Dirac function as a function of energy. Note that the Fermi function f(E) is not normalized and,
therefore, it is not a probability density function. For an intrinsic semiconductor, the Fermi level is in the
middle of the energy gap, as shown in Fig. 3.23.
For example, at the conduction band bottom, Ec = E𝑣+ Eg and EF = E𝑣+ Eg∕2, at temperature T = 300 K,
kBT ≈0.025 eV, and with Eg = 1 eV,
f(Ec) =
1
exp
[ Eg
2kBT
]
+ 1
≈exp
[
−
Eg
2kBT
]
= exp (−20).
(3.97)
Thus, at room temperature, the chance that an electron occupies the conduction band is very small and,
therefore, the electrical conductivity of the intrinsic semiconductor is quite low. But the conductivity can be
increased by adding impurity atoms. The basic semiconductor without doping is called an intrinsic semicon-
ductor. Doping consists of adding impurities to the crystalline structure of the semiconductor. For example,
a small amount of group V elements such as arsenic can be added to silicon. Arsenic has five electrons in the
outermost shell; four electrons form a covalent bond with neighboring silicon atoms, as shown in Fig. 3.24,
but there is one electron left over that can not take part in bonding. This fifth electron is very loosely attached

Lasers
117
0
0.5
1
E
f (E)
EF
T > 0 K 
T = 0 K
Figure 3.22
Fermi–Dirac function.
Conduction band
bottom
Valance band
top
EF
Ec
Ev
Fermi level
Eg
Conduction
band
Valence
band
Figure 3.23
Energy-band diagram of an intrinsic semiconductor.
and it is free to move through the crystal when an electric field is applied. Thus the number of free electrons in
the crystal is enhanced by doping with arsenic. Group V elements such as arsenic added to group IV elements
are called donors, since they contribute free electrons. The resultant semiconductor material is known as an
n-type semiconductor.
When a small amount of group III elements such as gallium are added to silicon, three valence electrons of
gallium form a covalent bond with the neighboring three silicon atoms, while the fourth silicon atom shown
in Fig. 3.25 is deprived of an electron to complete a total of eight electrons. The missing electron is a hole
that can be filled by an electron that is in the neighborhood. Thus, the number of holes is increased by doping
with group III elements, which are known as acceptors, and the resultant semiconductor is known as a p-type
semiconductor.

118
Fiber Optic Communications
Loose
electron
Si
Si
Si
Si
As
Figure 3.24
Molecular structure of an n-type semiconductor.
Hole
Si
Si
Si
Si
Ga
Figure 3.25
Molecular structure of a p-type semiconductor.
3.7.1
The PN Junctions
A PN junction or diode is formed by bringing p-type and n-type materials in contact, as shown in Fig. 3.26.
The n-side is electron-rich while the p-side has only a few electrons. So, the electrons diffuse from the n-side to
the p-side. Similarly, holes diffuse from the p-side to the n-side. As the electrons and holes cross the junction,
they combine. When an electron combines with a hole, it means that it becomes part of the covalent bond.
As a result, a region close to the junction is depleted of electrons and holes and hence this region is called a
depletion region. Because of the addition of electrons on the p-side, the depletion region on the p-side consists
of negative acceptor ions and similarly, the depletion region on the n-side consists of positive donor ions due
to migration of holes. Note that the p-type material (in the absence of the n-type material on the right) is
electrically neutral even though it has holes. This is because the charge of holes and that of the lattice cancel

Lasers
119
+
+
+
+
+
+
+
+
−  −
−  −
−  −
 −  − 
p-type
n-type
Depletion region
Figure 3.26
A PN junction or diode.
each other on average (if this was not the case, you would get a shock when you touched the p-type material).
Similarly, n-type material is also charge neutral in the absence of the p-type material. However, when these
materials are brought together to form a PN junction, we have negatively charged acceptor ions on the p-side
and positively charged donor ions on the n-side, which acts as a battery. This is known as contact potential.
This potential V0 is about 0.6 to 0.7 V for silicon.
Next, let us consider the case when the diode is connected to the terminals of a voltage source. The diode is
said to be reverse-biased when the positive terminal of the source is connected to the n-side and the negative
terminal of the source is connected to the p-side, as shown in Fig. 3.27. Now, electrons in the rightmost region
of the n-side are attracted to the positive terminal of the battery, and electrons closer to the PN junction move
to the right, which enhances the width of the depletion region on the n-side. A similar effect happens on the
p-side, which leads to the widening of the depletion region, as shown in Fig. 3.27.
The diode is said to be forward-biased when the positive terminal of the source is connected to the p-side
and the negative terminal of the source is connected to the n-side, as shown in Fig. 3.28. The electrons on
the n-side are attracted to the positive terminal of the voltage source and the holes on the p-side are attracted
p-type
n-type
Depletion region after
reverse-bias 
Depletion region before
reverse-bias 
+
+
+
+
+
+
+
+
+
+
+
+
*
*
*
*
+
*
*
*
*
*
*
*
*
*
Figure 3.27
The PN junction under reverse-bias.

120
Fiber Optic Communications
p-type
n-type
Depletion region before
forward-bias 
Depletion region after
forward-bias
+
+
+
+
+
+
+
+
+
+
+
+
*
*
*
*
+
*
*
*
*
*
*
*
*
*
Figure 3.28
The PN junction under forward-bias.
to the negative terminal of the source. As a result, there is a current across the PN junction. The external
voltage counteracts the contact potential and, therefore, the width of the depletion region decreases as shown
in Fig. 3.28. We assume that the external voltage V is less than the contact potential. An external resistor must
be inserted in series with the voltage source to protect the PN junction from an excess current flow.
3.7.2
Spontaneous and Stimulated Emission at the PN Junction
The conduction band and valence band are similar to the excited state and ground state of the atomic system
discussed in Section 3.2, respectively. In the case of the atomic system, an atom in the ground state absorbs
a photon and makes a transition to the excited state. Similarly, in a semiconductor, an electron in the valence
band could jump to the conduction band by absorbing a photon if its energy exceeds the band-gap energy.
As the electron moves to the conduction band, it leaves behind a hole in the valence band. In other words, a
photon is annihilated to create an electron–hole pair. An electron in the conduction band is stimulated to emit
a photon if a photon of the same kind is already present, and it jumps to the valence band. In other words, an
electron combines with a hole, releasing the difference in energy as a photon. An electron in the conduction
band could jump to the valence band spontaneously, whether or not a photon is present. This occurs randomly,
leading to spontaneous emission.
Now let us consider the forward-biased PN junction. As electrons and holes cross the junction, they com-
bine and release the difference in energy as photons. The spontaneously generated photons act as a seed for
stimulated emission. As electrons are lost due to electron–hole recombination, the external voltage source
injects electrons. Thus, the voltage source acts as an electrical pump to achieve population inversion.
3.7.3
Direct and Indirect Band-Gap Semiconductors
Fig. 3.29 shows a plot of energy as a function of wavenumber. Let Eg be the minimum energy required to
excite an electron to the conduction band. If an electron absorbs the energy E1 > Eg, the excess energy appears

Lasers
121
Eg
E1 > Eg
Valence band top
Wavenumber, k
k1
Conduction band
Energy
(Arb. unit) 
Figure 3.29
E–k diagram assuming parabolic conduction band.
in the form of kinetic energy. If we assume that the energy depends on the wavenumber quadratically in the
conduction band as in the case of a free particle, the energy of an electron in the conduction band is given
by [13]
E1 = Eg +
ℏ2k2
1
2meff,1
,
(3.98)
where meff,1 is the effective mass of an electron in the conduction band and ℏk1 is the momentum. If the bottom
of the conduction band is aligned with the top of the valence band as shown in Fig. 3.30, such a material is
called a direct band-gap material. For example, GaAs and InP are direct band-gap materials. For indirect
band-gap materials, the conduction band minimum and valence band maximum occur at different values of
momentum, as shown in Fig. 3.31. Silicon and germanium are indirect band-gap semiconductors.
Eg
E
Electron
Hole
k
Conduction band
Valence band
Eg + ħ2k1
2/meff,1
E1
E2
‒ħ2k2
2/meff,2
Figure 3.30
Simplified E–k diagram for a direct band-gap material.

122
Fiber Optic Communications
Eg
E
k
Conduction band
Valence band
Figure 3.31
Simplified E–k diagram for an indirect band-gap material.
Let us first consider a direct band-gap semiconductor. Let the energy of the top of the valence band be the
reference with E = 0. The energy of an electron in the conduction band with effective mass meff,1 is
E1 = Eg +
ℏ2k2
1
2meff,1
.
(3.99)
The energy of an electron in the valence band, or equivalently that of a hole with effective mass meff,2, is
E2 = −
ℏ2k2
2
2meff,2
.
(3.100)
When an electron makes a transition from energy state E1 to E2, a photon of energy ℏ𝜔is emitted. In other
words, an electron in the conduction band recombines with a hole in the valence band, releasing the energy
difference as a photon. The conservation of energy yields
E1 = E2 + ℏ𝜔,
ℏ𝜔= E1 −E2 = Eg + 1
2
[
ℏ2k2
1
meff,1
+
ℏ2k2
2
meff,2
]
.
(3.101)
Similarly, the conservation of momentum yields
ℏk𝟏= ℏk𝟐+ ℏkph,
(3.102)
where ℏkph is the photon momentum. At optical frequencies, ℏkph ≪ℏkj, j = 1, 2. From Eq. (3.102), it follows
that k1 ≅k2 and, therefore, the transition from energy state E1 to E2 in Fig. 3.30 is almost vertical. From
Eq. (3.101), we find
ℏ𝜔= Eg +
ℏ2k2
1
2mr
,
(3.103)

Lasers
123
where
mr =
meff,1meff,2
meff,1 + meff,2
(3.104)
is the reduced effective electron mass [13]. For indirect band-gap materials, the momenta of electrons in
the conduction band and in the valence band are different. Typically, the difference in momenta is much
larger than the photon momentum and, therefore, the momentum can not be conserved in the electron–photon
interaction unless the photon emission is mediated through a phonon. A phonon refers to the quantized lattice
vibration or sound wave. If the momentum of the phonon is equal to the difference ℏ(k1 −k2), the chance of
photon emission as an electron jumps from conduction band to valence band increases. In other words, in the
absence of phonon mediation, the event that an electron makes a transition from conduction band to valence
band emitting a photon is less likely to happen. Therefore, indirect band-gap materials such as silicon and
germanium are not used for making lasers, while direct band-gap materials such as GaAs and InP (and their
mixtures) are used for the construction of lasers. However, silicon can be used in photo-detectors. As we will
discuss in Chapter 5, an electron in the valence band jumps to the conduction band by absorbing a photon.
We may expect that such an event is less likely to happen in silicon because of the momentum mismatch in
the electron–photon interaction. But the crystal lattice vibrations (crystal momentum) provide the necessary
momentum so that the momentum is conserved during the photon-absorption process. In contrast, during the
photon-emission process, phonon mediation is harder to come by since the free electrons in the conduction
band are not bound to atoms, and, therefore, they do not vibrate within the crystal structure [10].
Example 3.6
In a direct band-gap material, an electron in the conduction band having a crystal momentum of
7.84 × 10−26 Kg⋅m/s makes a transition to the valence band emitting an electromagnetic wave of wavelength
0.8 μm. Calculate the band-gap energy. Assume that the effective mass of an electron in the conduction
band is 0.07m and that in the valence band is 0.5m, where m is the electron rest mass. Assume parabolic
conduction and valence band.
Solution:
The reduced mass mr is related to the effective masses by Eq. (3.104),
mr =
meff,1meff,2
meff,1 + meff,2
.
meff,1 = 0.07m, meff,2 = 0.5m, electron mass m = 9.109 × 10−31 kg,
mr = 0.07 × 0.5
0.07 + 0.5 × 9.109 × 10−31 = 5.59 × 10−32 kg.
The electron momentum is
ℏk1 = 7.84 × 10−26 kg ⋅m/s.
The photon energy is
ℏ𝜔= ℏ2𝜋c
𝜆= 1.054 × 10−34 × 2𝜋× 3 × 108
0.8 × 10−6
= 2.48 × 10−19 J.

124
Fiber Optic Communications
From Eq. (3.103), we have
Eg = ℏ𝜔−
ℏ2k2
1
2mr
= 2.48 × 10−19 −(7.84 × 10−26)2
2 × 5.59 × 10−32 J
= 1.93 × 10−19 J.
3.8
Semiconductor Laser Diode
The light emission in laser diodes is mostly by stimulated emission, whereas that in LEDs is mostly by
spontaneous emission. Laser diodes can emit light at high powers (∼100 mW) and also it is coherent. Because
of the coherent nature of laser output, it is highly directional. The narrower angular spread of the output
beam compared with a LED allows higher coupling efficiency for light coupling to single-mode fibers. An
important advantage of the semiconductor laser is its narrow spectral width, which makes it a suitable optical
source for WDM optical transmission systems (see Chapter 9). A semiconductor laser in its simplest form is
a forward-biased PN junction. Electrons in the conduction band and holes in the valence band are separated
by the band gap and they form a two-band system similar to the atomic system discussed in Sections 3.2
and 3.6. As electrons and holes recombine at the junction, the energy difference is released as photons, as
discussed in Section 3.7.2. To obtain oscillation, optical feedback is required, which is achieved by cleaving
the ends of the laser cavity. Cleaving provides flat and partially reflecting surfaces. Sometimes one reflector
is partially reflecting and used as laser output port and the other has a reflectivity close to unity. By coating
the side opposite the output with a dielectric layer, the reflection coefficient could be close to unity.
3.8.1
Heterojunction Lasers
The PN junction shown in Fig. 3.32 is called a homojunction. The problem with the homojunction is that
when it is forward-biased, electron–hole recombination occurs over a wide region (1 −10 μm). Therefore,
high carrier densities can not be realized.
A heterojunction is an interface between two adjoining semiconductors with different band-gap energies. In
Fig. 3.33, a thin layer is sandwiched between p-type and n-type layers. The band gap of this layer is smaller
than that of the p-type and n-type layers, as shown in Fig. 3.34(b). This leads to two heterojunctions and
such devices are called double heterostructures. The thin layer, known as the active region, may or may not
be doped depending on the specific design. For example, the middle layer could be p-type GaAs and the
surrounding layers p-type AlGaAs and n-type AlGaAs as shown in Fig. 3.33.
Double-heterojunction lasers have the following advantages: the band-gap difference between the active
region and the surrounding layers results in potential energy barriers for electrons in the conduction band and
p-type
n-type
Homojunction
Figure 3.32
A homojunction.

Lasers
125
p-type   GaAs – active region
Laser output
p-type   AlGaAs 
n-type   AlGaAs 
Cleaved facet
Dielectric reflective
layer 
Figure 3.33
A double-heterojunction Fabry–Perot laser diode. The cleaved end functions as a partially reflecting mirror.
n1
n1
n2
Eg2
Eg1
Eg1
Valence band
Conduction band
p-type
n-type
Active region
Index, n
Energy
(a)
(b)
(c)
Heterojunctions
Figure 3.34
Double heterostructure: (a) heterojunctions; (b) band gap; (c) refractive index.
for holes in the valence band. Electrons and holes trapped in the active region could escape to the surrounding
layers only if they have sufficient energy to cross the barriers. As a result, both electrons and holes are mostly
confined to the active region. Because of the smaller band gap, the active region has a slightly higher refractive
index. As discussed in Chapter 2, this acts as an optical waveguide and light is confined to the middle layer of
the higher refractive index due to total internal reflection. Therefore, not only electrons and holes are confined

126
Fiber Optic Communications
to the active region, but also photons, which increases the interaction among them, and the efficiency of light
generation in a double heterostructure is much higher than in the devices using homojunctions.
3.8.2
Radiative and Non-Radiative Recombination
When a PN junction is forward-biased, electrons and holes recombine to produce light. This is called radiative
recombination. In a semiconductor, electrons and holes can also recombine non-radiatively. In this case, the
energy difference is released as lattice vibrations or given to another electron or hole to increase its kinetic
energy [14–16]. This type of recombination is called non-radiative recombination. In a practical light source,
we like to maximize the radiative recombination by reducing the energy loss due to non-radiative recombi-
nation. Therefore, it is useful to define the internal quantum efficiency of a light source as
𝜂int = Rrr
Rtot
=
Rrr
Rrr + Rnr
,
(3.105)
where Rrr is the radiative recombination rate, Rnr is the non-radiative recombination rate, and Rtot is the total
recombination rate. Radiative recombination occurs in two different ways: (i) spontaneous emission and (ii)
stimulated emission,
Rrr = Rspont + Rstim.
(3.106)
For direct band-gap materials, the radiative recombination rate could be larger than the non-radiative rate
since the conservation of energy as well as momentum can be achieved when an electron makes a transition
from the conduction band to the valence band emitting a photon. In contrast, for indirect band-gap materi-
als, such as Si and Ge, the electron–hole recombination is mostly non–radiative and, therefore, the internal
quantum efficiency is quite small. Typically, nint is of the order of 10−5 for Si and Ge.
3.8.3
Laser Rate Equations
In Section 3.6 we developed the rate equations for an atomic system with two levels. In the atomic system, the
interaction takes place among the photons, the atoms in the excited level, and in the ground level. Similarly,
in the semiconductor laser diode, the interaction is between the electrons in the conduction band, holes in the
valence band, and photons. Therefore, Eqs. (3.89) and (3.90) may be used to describe the time rate of change
of electrons and photons in a cavity with N2 being replaced by the electron density Ne,
dNe
dt
= Rpump + Rstim + Rsp + Rnr
= Rpump −GNph −Ne
𝜏e
,
(3.107)
dNph
dt
= Rstim + Rsp + Rloss
= GNph + Rsp −
Nph
𝜏ph
.
(3.108)
Here, 𝜏e ≡𝜏21 represents the lifetime of electrons associated with spontaneous emission and non-radiative
transition. In Section 3.3, we found that G = g𝑣. This result was derived under the assumption that the light
is a plane wave. But in a double-heterojunction laser, the active region has a slightly higher refractive index

Lasers
127
than the surrounding layers and, therefore, it acts as a waveguide. The tails of an optical mode extend well
into the surrounding regions, but they do not contribute to the photon density in the active region. Since the
electron–hole recombination by photon emission depends on the photon density in the active region, we
introduce a confinement factor Γ,
G = Γg𝑣,
(3.109)
where Γ is the ratio of optical power in the active region to total optical power carried by the mode.
Let us consider the growth of photons due to stimulated emission alone. Eqs. (3.107) and (3.108) become
dNe
dt
= −GNph,
(3.110)
dNph
dt
= GNph.
(3.111)
Adding Eqs. (3.110) and (3.111), we find
d(Ne + Nph)
dt
= 0
(3.112)
or
Ne + Nph = Const.
(3.113)
This implies that the total number of electrons and photons is conserved under these conditions. In other
words, if you lose 10 electrons per unit volume per unit time by recombination, you gain 10 photons per unit
volume per unit time.
Now, let us find an expression for Rpump. The electrons and holes are consumed by stimulated emission.
Therefore, the external power supply should inject electrons continuously. The current is
I = neq
T ,
(3.114)
where ne is the number of electrons, q is the electron charge = 1.602 × 10−19 C, and T is the time interval.
The number of electrons crossing the active region per unit time is
ne
T = I
q.
(3.115)
The above equation gives the electron pumping rate. We divide it by the volume of the active region to obtain
the electron pumping rate per unit volume,
Rpump = ne
TV =
I
qd𝑤L,
(3.116)
where d, 𝑤, and L are thickness, width, and length of the active layer, respectively, as shown in Fig. 3.35(b).
Using Eq. (3.116) in Eqs. (3.107) and (3.108), we find
dNe
dt
= I
qV −GNph −Ne
𝜏e
,
(3.117)
dNph
dt
= GNph + Rsp −
Nph
𝜏ph
.
(3.118)
In the case of an atomic system, we have derived an expression for G (see Eq. (3.91)). But in the case of a
semiconductor laser, it is hard to find an exact analytical expression for the gain coefficient g. Instead, we use

128
Fiber Optic Communications
p-type 
Metal contact
Active region
n-type 
Current, I
Cleaved facet
Active region
L
w
d
Current direction
Dielectric layer
(a)
(b)
Figure 3.35
(a) Forward-biased heterojunction laser. (b) Active region.
the following approximation [16]:
g = 𝜎g(Ne −Ne0),
(3.119)
where 𝜎g and Ne0 are parameters that depend on the specific design. 𝜎g is called the gain cross-section and
Ne0 is the value of the carrier density at which the gain coefficient becomes zero. Using Eq. (3.109), we find
G = Γg𝑣= G0(Ne −Ne0)
(3.120)
where
G0 = Γ𝜎g𝑣.
(3.121)
3.8.4
Steady-State Solutions of Rate Equations
Eqs. (3.117) and (3.118) describe the evolution of electron density and photon density in the active region,
respectively. In general, they have to be solved numerically on a computer. However, the steady-state solution
can be found analytically under some approximations. First, we ignore the spontaneous emission rate since it
is much smaller than the stimulated emission rate for a laser. Second, we use Eq. (3.120) for the gain, which
is an approximation to the calculated/measured gain. Now, Eqs. (3.117) and (3.118) become
dNph
dt
= GNph −
Nph
𝜏ph
,
(3.122)
dNe
dt
= −GNph −Ne
𝜏e
+ I
qV .
(3.123)
We assume that the current I is constant. Under steady-state conditions, the loss of photons due to cavity loss
is balanced by the gain of photons due to stimulated emission. As a result, the photon density does not change
as a function of time. Similarly, the loss of electrons due to radiative and non-radiative transitions is balanced
by electron injection from the battery. So, the electron density does not change with time too. Therefore, under
steady-state conditions, the time derivatives in Eqs. (3.122) and (3.123) can be set to zero,
dNph
dt
= dNe
dt
= 0.
(3.124)

Lasers
129
From Eq. (3.122), we have
G𝜏ph = 1.
(3.125)
Using Eq. (3.120), we obtain
G0(Ne −Ne0)𝜏ph = 1,
(3.126)
Ne = Ne0 +
1
G0𝜏ph
.
(3.127)
From Eq. (3.125), it follows that
Γg = 𝛼cav,
(3.128)
which is a restatement of the fact that gain should be equal to loss. If the current I is very small, there will not
be enough electrons in the conduction band to achieve population inversion. In this case, the gain coefficient
will be much smaller than the loss coefficient and photons will not build up. For a certain current I, the gain
coefficient Γg becomes equal to the loss coefficient 𝛼cav and this current is known as the threshold current, Ith.
If I > Ith, stimulated emission could become the dominant effect and the photon density could be significant.
Under steady-state conditions, there are two possibilities.
Case (i) I = Ith−. Stimulated emission is negligible and Nph ≅0,
dNe
dt
= −Ne
𝜏e
+ I
qV = 0.
(3.129)
Let Ne = Ne,th. From Eq. (3.129), we have
Ith =
Ne,th qV
𝜏e
.
(3.130)
From Eq. (3.127), we have
Ne,th = Ne0 +
1
G0𝜏ph
.
(3.131)
Case (ii) I > Ith. When the current exceeds the threshold current, we may expect the electron density Ne to be
larger than Ne,th. However, the electron density will be clamped to Ne,th when I > Ith. This can be explained
as follows. The threshold current is the minimum current required to achieve population inversion. When
I > Ith, the excess electrons in the conduction band recombine with holes and, therefore, the photon density
increases while the electron density would maintain its value at threshold. Fig. 3.36(a) and 3.36(b) shows the
numerical solution of the laser rate equations for I = 50 mA and 100 mA, respectively. The threshold current
in this example is 9.9 mA. In Fig. 3.36(a) and 3.36(b), after t > 5 ns, we may consider it as steady state since
Nph and Ne do not change with time. Comparing Fig. 3.36(a) and 3.36(b), we find that the steady-state electron
density is the same in both cases, although the bias currents are different. In fact, it is equal to Ne,th as given
by Eq. (3.131). Using Eqs. (3.124) and (3.125) in Eq. (3.123), we obtain
Nph
𝜏ph
= I
qV −
Ne,th
𝜏e
.
(3.132)
Using Eq. (3.130), Eq. (3.132) can be written as
Nph =
(I −Ith)𝜏ph
qV
.
(3.133)

130
Fiber Optic Communications
0
1
2
3
4
5
6
0
0.5
1
1.5
2
2.5
3
3.5
4  1024
 1024
Time (ns)
(a)
Time (ns)
(b)
Electron density, m*3  
Electron density, m*3 
0
1
2
3
4
5
6
0
0.5
1
1.5
2
2.5
3
3.5
4
Figure 3.36
Numerical solution of the rate equation using typical parameters of an InGaAsP laser diode: (a) I = 50 mA;
(b) I = 100 mA.
The next step is to develop an expression for the optical power generated as a function of the current. Since
the energy of a photon is equal to ℏ𝜔, the mean photon density of Nph corresponds to the energy density,
u = Nphℏ𝜔.
(3.134)
The relation between energy density and optical intensity is given by Eq. (3.50),
= u𝑣= Nphℏ𝜔𝑣.
(3.135)
Since optical intensity is power per unit area perpendicular to photon flow, the mean optical power generated
can be written as
Pgen = A = Nphℏ𝜔𝑣A,
(3.136)
where A is the effective cross-section of the mode. Using Eq. (3.133) in Eq. (3.136), we finally obtain
Pgen =
(I −Ith)𝜏phℏ𝜔𝑣A
q𝑤dL
.
(3.137)
Note that the above equation is valid only when I > Ith. If I ≤Ith, Pgen = 0 under our approximations.
Example 3.7
A 1300-nm InGaAs semiconductor laser has the following parameters:
Active area width 𝑤= 3 μm
Active area thickness d = 0.3 μm

Lasers
131
Length L = 500 μm
Electron lifetime = 1 ns (associated with spontaneous and non-radiative recombination)
Threshold electron density = 0.8 × 1024 m−3
Internal cavity loss = 46 cm−1
Refractive index = 3.5
Reflectivity R1 = R2 = 0.65
Under steady-state conditions, calculate (a) the photon lifetime, (b) the threshold current, and (c) the current
required to generate a mean photon density of 8.5 × 1021 m−3.
Solution:
(a) The photon lifetime is given by Eq. (3.79),
𝜏p =
1
𝑣(𝛼int + 𝛼mir),
(3.138)
𝛼int = 46 cm−1 = 46 × 102 m−1.
(3.139)
The mirror loss is, by Eq. (3.38),
𝛼mir = 1
2L ln
(
1
R1R2
)
=
1
2 × 500 × 10−6 ln
(
1
0.652
)
= 8.61 × 102 m−1,
(3.140)
𝑣= c
n = 3 × 108
3.5
= 8.57 × 107 m/s.
(3.141)
Using Eqs. (3.139), (3.140), and (3.141) in Eq. (3.138), we find
𝜏p =
1
8.57 × 107(46 × 102 + 8.61 × 102) = 2.13 ps.
(b) The threshold current Itn is related to the threshold electron density by Eq. (3.130),
Ith =
Ne,thqV
𝜏e
,
where V is the active volume,
V = 𝑤dL
= 0.3 × 10−6 × 3 × 10−6 × 500 × 10−6 m3
= 4.5 × 10−16 m3.
The electron lifetime 𝜏e = 1 × 10−9 s and Ne,th = 0.8 × 1024 m−3,
Ith = 0.8 × 1024 × 1.602 × 10−19 × 4.5 × 10−16
1 × 10−9
A
= 52.7 mA.

132
Fiber Optic Communications
(c) The mean photon density and the current are related by Eq. (3.133),
Nph =
(I −Ith)𝜏ph
qV
or
I = Ith +
NphqV
𝜏ph
= 52.7 × 10−3 + 8.5 × 1021 × 1.602 × 10−19 × 4.5 × 10−16
2.13 × 10−12
= 340.4 mA.
3.8.5
Distributed-Feedback Lasers
In Section 3.3, we saw that a Fabry–Perot laser supports many longitudinal modes. For many applications,
it is desirable to have a single-longitudinal-mode laser. In the case of Fabry–Perot lasers, the cleaved facets
act as mirrors. The mirrors can be replaced by periodically corrugated reflectors or Bragg gratings, as shown
in Fig. 3.37(b). This type of laser is known as a distributed Bragg reflector (DBR) laser [17]. Bragg gratings
are formed by periodically changing the refractive index. If Λ is the period of refractive index variations, the
Bragg grating acts as a reflector with reflection maxima occurring at frequencies
f Bragg
m
= mc
2nΛ,
m = 1, 2, … ,
(3.142)
where n is the effective mode index. The above condition is known as the Bragg condition. The longitudinal
modes of the cavity which do not satisfy the Bragg condition do not survive, since the cavity loss (= internal
loss + Bragg reflector loss) increases substantially for those longitudinal modes. The longitudinal modes of
the cavity are given by Eq. (3.44),
fl =
lc
2nL,
l = 0, 1, 2, …
(3.143)
As an example, if L = 300 μm and n = 3.3, the frequency separation between longitudinal modes
= 0.15 THz. If the main mode frequency = 190 THz, the frequency of two neighboring modes is 189.85 THz
and 190.15 THz. The reflection is the strongest for first-order gratings (m = 1). If we choose the grating
period such that f Bragg
m
= 190 THz for m = 1, from Eq. (3.142), we find Λ = 0.24 μm. The neighboring
I
I
I
p-type
p-type
p-type
n-type
n-type
n-type
Active
Cleaved facet
Bragg grating
Bragg grating
Bragg grating
(a)
(b)
(c)
Fabry-Perot laser
DBR laser
DFB laser
Figure 3.37
Different laser configurations: (a) FP laser, (b) DBR laser, (c) DFB laser.

Lasers
133
modes do not satisfy the Bragg condition given by Eq. (3.142) and, therefore, they suffer huge losses.
One drawback of the DBR is that the corrugated region is part of the cavity and it is somewhat lossy, which
lowers the efficiency of the device. Instead, the corrugated region can be fabricated above the active region
as shown in Fig. 3.37(c). Such a laser is known as a distributed-feedback (DFB) laser [18, 19]. The grating
placed above the waveguide changes the effective index periodically and is equivalent to the waveguide
with periodic index variation in the core region. This grating provides coupling between forward- and
backward-propagating waves and maximum coupling occurs for frequencies satisfying the Bragg condition,
Eq. (3.142). The advantage of a DFB laser is that the corrugated region is not part of the cavity and, therefore,
cavity loss does not increase because of the grating. DFB lasers are widely used in applications such as CD
players, transmitters in fiber-optic communications, and computer memory readers.
3.9
Additional Examples
Example 3.8
For an atomic system under thermal equilibrium conditions, the ratio of spontaneous emission rate to stimu-
lated emission rate is 2 × 1014. Find the wavelength of the light emitted. Assume that the temperature is 30∘C.
Solution:
From Eq. (3.16), we have
Rspont
Rstim
= exp
(
ℏ𝜔
kBT
)
−1,
2 × 1014 = exp
(
ℏ𝜔
kBT
)
−1,
2 × 1014 ≈exp
(
ℏ𝜔
kBT
)
,
ℏ𝜔
kBT = ln(2 × 1014).
With T = 30∘C = 303 K, kB = 1.38 × 10−23 J/K, and ℏ= 1.054 × 10−34 J ⋅s,
𝜔= 1.3 × 1015 rad/s.
The wavelength is
𝜆= c
f = 2𝜋c
𝜔
= 2𝜋× 3 × 108
1.3 × 1015
= 1.44 μm.
Example 3.9
A laser diode operating at 1.3 μm has a cavity length of 300 μm and the refractive index n of the active region
is 3.5. (a) What is the frequency separation between modes? (b) What is the wavelength separation between
modes?

134
Fiber Optic Communications
Solution:
(a) The frequency separation Δf is given by Eq. (3.45),
Δf = fn+1 −fn =
c
2nL =
3 × 108
2 × 3.5 × 300 × 10−6 = 142.8 GHz.
(b) Since
f = c
𝜆,
we have
df = −c
𝜆2 d𝜆
or
|Δ𝜆| = 𝜆2
c Δf = (1.3 × 10−6)2 × (1.428 × 1011)
3 × 108
m = 0.8 μm.
Example 3.10
In a direct band-gap material, an electron in the valence band having a crystal momentum of 9 × 10−26 kg ⋅m/s
makes a transition to the conduction band absorbing a light wave of frequency 3.94 × 1014 Hz. The band gap
is 1.18 eV and the effective mass of an electron in the conduction band is 0.07m, where m is the electron rest
mass. Calculate the effective mass of the electron in the valence band.
Solution:
From Eq. (3.103), we have
hf = Eg +
ℏ2k2
1
2mr
,
(3.144)
where
1
mr
=
1
meff,1
+
1
meff,2
(3.145)
and
Eg = 1.18 eV = 1.18 × 1.602 × 10−19 J = 1.89 × 10−19 J.
For a direct band-gap material, k1 ≈k2. The crystal momentum ℏk1 = 9 × 10−26 kg ⋅m/s and the energy of
the photon is
hf = 6.626 × 10−34 × 3.94 × 1014 J = 2.61 × 10−19 J.
From Eq. (3.144), we have
ℏ2k2
1
2mr
= hf −Eg = (2.61 × 10−19 −1.89 × 10−19) J = 7.2 × 10−20 J,
mr = (9 × 10−26)2
14.4 × 10−20 = 5.62 × 10−32 kg.

Lasers
135
Since the electron rest mass, m = 9.109 × 10−31 kg, meff,1 = 0.07m = 6.37 × 10−32 kg, using Eq. (3.145), we
obtain
1
meff,2
= 1
mr
−
1
meff,1
=
1
5.62 × 10−32 −
1
6.37 × 10−32 kg−1
meff,2 = 4.78 × 10−31 kg.
Example 3.11
A laser diode has a 320-μm cavity length, the internal loss coefficient is 10 cm−1. The mirror reflectivities are
0.35 at each end. The refractive index of the active region is 3.3 under steady-state conditions. Calculate (a) the
optical gain coefficient Γg required to balance the cavity loss and (b) the threshold electron density Ne. Assume
that the gain can be modeled as G = G0(Ne −Ne0), G0 = 1.73 × 10−12 m3∕s and Ne0 = 3.47 × 1023 m−3.
Solution:
The total cavity loss coefficient is given by Eq. (3.39),
𝛼cav = 𝛼int + 𝛼mir,
where
𝛼mir = 1
2L ln
[
1
R1R2
]
=
1
2 × 320 × 10−6 ln
[
1
0.352
]
= 3.28 × 103 m−1.
The internal loss coefficient is 𝛼int = 103 m−1,
𝛼cav = 103 + 3.28 × 103 m−1 = 4.28 × 103 m−1.
The optical gain coefficient Γg to balance the cavity loss is
Γg = 𝛼cav = 4.28 × 103 m−1.
(b) The threshold electron density is given by Eq. (3.131),
Ne,th = Ne,0 +
1
G0𝜏ph
,
where
𝜏ph =
1
𝑣𝛼cav
,
𝑣= c
n = 3 × 108
3.3
= 9.09 × 107 m∕s,
𝜏ph =
1
9.09 × 107 × 4.28 × 103 = 2.57 ps,
Ne,th = 3.47 × 1023 +
1
1.73 × 10−12 × 2.57 × 10−12 m−3
= 5.71 × 1023 m−3.

136
Fiber Optic Communications
Exercises
3.1
Explain the three processes by which a ligh twave interacts with an atom.
3.2
The operating wavelength of an optical source is 400 nm. Calculate the ratio of spontaneous to stim-
ulated emission rate under thermal equilibrium. Assume T = 293 K. Is the optical source coherent?
Provide an explanation.
(Ans: 4.12 × 1033. No.)
3.3
In an atomic system, the spontaneous lifetime associated with 2 →1 transition is 3 ns and the Einstein
coefficient B is 6 × 1021 m3∕J ⋅s2. Calculate the energy difference between the levels 1 and 2. Assume
that the speed of light is 1.5 × 108 m∕s.
(Ans: 2.73 × 10−19 J.)
3.4
In an atomic system under thermal equilibrium conditions, the population density of the ground level
is 2 × 1026 m−3 and the energy difference between the levels is 1.5 eV. Calculate the population density
of the excited level. Assume that the temperature is 30∘C.
(Ans: 22 m−3.)
3.5
Under thermal equilibrium conditions, the ratio of spontaneous emission rate to stimulated emission
rate is 2.33 × 1017, the population density of the ground state is 1.5 × 1026 m−3, and the temperature
is 300 K. Calculate (a) the energy difference between the levels and (b) the population density of the
excited level.
(Ans: (a) 1.65 × 10−19 J; (b) 6.47 × 10 8m−3.)
3.6
An electron has a momentum of 4.16 × 10−26 kg ⋅m∕s. Calculate (a) the De Brogile wavelength and
(b) the wavenumber.
(Ans: (a) 1.59 × 10−8m; (b) 3.94 × 108 m−1.)
3.7
A Fabry–Perot laser diode has a cavity length of 250 μm, the internal loss coefficient is 45 cm−1, and
the photon lifetime is 1.18 ps. Calculate the mirror reflectivity. Assume that the reflectivities are equal
and the velocity of light in the active region is 9.09 × 107 m/s.
(Ans: R1 = R2 = 0.299.)
3.8
If one end of the laser cavity of Exercise 3.7 is coated with a dielectric reflector so that its reflectivity
is 0.95, calculate the photon lifetime. Other parameters are the same as in Exercise 3.7.
(Ans: 1.56 ps.)
3.9
Show that the peak wavelength of the light emitted is related to the band-gap energy by
𝜆(μm) =
1.24
Eg (eV).
Here, (μm) indicates that the wavelength is in units of μm.

Lasers
137
3.10
The wavelength separation between longitudinal modes of a 1300-nm Fabry–Perot laser is 0.8 μm.
Calculate the cavity length. Assume that the refractive index n = 3.5.
(Ans: 300 μm.)
3.11
The two cleaved facets of a 350-nm long semiconductor laser act as mirrors of reflectivity,
R1 = R2 =
(n −1
n + 1
)2
,
(3.146)
where n is the refractive index of the gain medium. If the internal loss coefficient is 15 cm−1, calculate
the gain coefficient required to offset the loss.
(Ans: 50.75 cm−1.)
3.12
Explain the difference between direct and indirect band-gap materials.
3.13
In a direct band-gap material, an electron in the conduction band makes transition to the valence band,
emitting a light wave of frequency 75 × 1014 Hz. The band-gap energy is 1.8 eV. Calculate the crystal
momentum of the electron. Assume that the effective mass of an electron in the conduction band and
the valence band is 0.07m and 0.5m, respectively, where m is the rest mass of an electron = 9.109 ×
10−31 kg.
(Ans: 7.23 ×10−25 kg ⋅m/s.)
3.14
The threshold electron density in a 800-nm Fabry–Perot laser diode is 4.2 × 1023 m−3, the electron
lifetime 𝜏e is 1.5 ns, and the volume of the active region is 5 × 10−16 m−3. Calculate (a) the photon
lifetime and (b) the threshold current. Assume that the gain can be modeled as G = G0(Ne −Ne0),
with G0 = 2 × 10−12 m3∕s and Ne0 = 3.2 × 1023 m−3.
(Ans: (a) 5 ps; (b) 22.4 mA.)
3.15
A semiconductor laser diode has the following parameters:
Active area width 𝑤= 4 μm
Active area thickness d = 0.5 μm
Length L = 400 μm
Electron lifetime = 1.5 ns
Internal cavity loss = 10 cm−1
Reflective index = 3.3
Reflectivity R1 = 0.32
Reflectivity R2 = 0.92
G0 = 1.5 × 10−12 m3/s
N0 = 3.4 × 1023 m−3
The bias current is 65 mA. Under steady-state conditions, calculate (a) the photon lifetime, (b) the
threshold electron density, (c) the threshold current, (d) the photon density, and (e) the optical intensity.
(Ans: (a) 4.35 ps, (b) 4.93 ×1023 m−3, (c) 42.1 mA, (d) 7.75 ×1023 m−3, (e) 1.75 ×1010 W/m2.

138
Fiber Optic Communications
3.16
Explain how the Bragg gratings can be used to make a single-longitudinal-mode laser.
3.17
A 1550-nm DFB laser has a cavity length of 300.07 μm. Find the grating period to have the strongest
reflection (first-order grating) at 1550 nm. Assume n = 3.2.
Further Reading
A.E. Siegman, Lasers. University Science Books, Sausalito, CA, 1986.
P.W. Milonni and J.H. Eberly, Laser Physics. John Wiley & Sons, Englewood Cliffs, NJ, 2010.
G.P. Agrawal and N.K. Datta, Semiconductor Lasers, 2nd edn. Van Nostrand Reinhold, New York, 1993.
A.K. Ghatak and K. Thyagaratan, Optical Electronics. Cambridge University Press, Cambridge, 1990.
B.E.A. Saleh and M.C. Teich, Fundamentals of Photonics, 2nd edn. John Wiley & Sons, Englewood Cliffs, NJ, 2007.
J.M. Senior, Optical Fiber Communications, 2nd edn. Prentice-Hall, London, 1992.
G. Keiser, Optical Fiber Communications, 4th edn. McGraw-Hill, New York, 2011.
G. Lachs, Fiber Optic Communications, McGraw-Hill, New York, 1998.
References
[1] A. Einstein, Phys. Z., vol. 18, p. 121, 1917.
[2] A.L. Schewlow and C.H. Townes, Phys. Rev., vol. 112, p. 1940, 1958.
[3] T.H. Maiman, Nature, vol. 187, p. 493, 1960.
[4] R.N. Hall, G.E. Fenner, T.J. Soltys, and R.O. Carlson, Phys. Rev. Lett., vol. 9, p. 366, 1962.
[5] Z. Alferov, IEEE J. Spec. Top. Quant. Electr., vol. 6, p. 832, 2000.
[6] H. Rubens and F. Kurlbaum, Sbsr. Press. Akad. Wiss p. 929, 1900.
[7] M. Planck, Verh. Dt. Phys. Ges., vol. 2, p. 237, 1900.
[8] C. Davisson and L.H. Germer, Phys. Rev., vol. 30, p. 705, 1927.
[9] A. Messiah, Quantum Mechanics. Dover Publications, New York, 1999.
[10] G. Lachs, Fiber Optic Communications. McGraw-Hill, New York, 1998.
[11] A.E. Siegman, Lasers. University Science Books, Sansalito, CA, 1986.
[12] C. Kittel, Introduction to Solid State Physics, 5th edn. John Wiley & Sons, Hoboken, NJ, 1976.
[13] A.F.J. Levi, Applied Quantum Mechanics, 2nd edn. Cambridge University Press, Cambridge, 2006.
[14] S.L. Chuang, Physics of Optoelectronic Devices, 2nd edn. John Wiley & Sons, Hoboken, NJ, 2008.
[15] G.P. Agrawal, Fiber Optic Communication, 4th edn. John Wiley & Sons, Hoboken, NJ, 2010.
[16] G.P. Agrawal and N.K. Datta, Semiconductor Lasers, 2nd edn. Van Nostrand Reinhold, New York, 1993.
[17] W.T. Tsang and S. Wang, Appl. Phys. Lett., vol. 28, p. 596, 1976.
[18] D.R. Scifres, R.D. Burham, and W. Streifer, Appl. Phys. Lett., vol. 25, p. 203, 1974.
[19] H. Ghafouri-shiraz, Distributed Feedback Laser Diodes and Optical Tunable Filters. John Wiley & Sons, Hoboken,
NJ, 2004.

4
Optical Modulators and
Modulation Schemes
4.1
Introduction
To convey a message, the amplitude, frequency, and phase of an optical carrier are switched in accordance
with the message data. For example, bits ‘1’ and ‘0’ can be transmitted by turning a laser diode on and off,
respectively. Typically, the message signal is in the form of binary data in an electrical domain, and optical
modulators are used to convert the data into an optical domain. Sections 4.2 to 4.5 review the various line
coders, pulse shapes, and digital modulation schemes. Sections 4.6 and 4.7 deal with different types of optical
modulators and generation of modulated signals using optical modulators. The benefit of adding a controlled
amount of ISI is discussed in Section 4.8. Section 4.9 deals with multi-level signaling, which enables higher
transmission data rates without having to increase the bandwidth.
4.2
Line Coder
Digital data can be represented by electrical waveforms in a number of ways. This process is called line
coding. In the binary case, bit ‘1’ is sent by transmitting a pulse p(t) and bit ‘0’ is sent by transmitting no
pulse. This line code is known as unipolar or on–off, as shown in Fig. 4.1(a). If a bit ‘1’ and bit ‘0’ are
represented by p(t) and −p(t), respectively, such a line code is polar. This is shown in Fig. 4.1(b). If a bit
‘0’ is represented by no pulse and a bit ‘1’ is represented by p(t) and −p(t), such a line code is known as
bipolar. In a bipolar line code, bit ‘1’ is encoded by p(t) if the previous bit ‘1’ is encoded by −p(t) and bit ‘1’
is encoded by −p(t) if the previous bit ‘1’ is encoded by p(t), as shown in Fig. 4.1(c). In other words, pulses
representing consecutive bit ‘1’s (no matter how many ‘0’s are between the ‘1’s) alternate in sign. Hence, this
line code is also called alternate mark inversion (AMI).
4.3
Pulse Shaping
The message signal can be the internet data, voice data after analog-to-digital conversion (ADC), or any
other form of digital data in an electrical domain. The widely used pulse shapes (p(t)) are non-return-to-zero
(NRZ) and return-to-zero (RZ). In the case of NRZ, the signal does not return to a zero level if there are two
consecutive ‘1’s in a bit stream, whereas in the case of RZ, the signal returns to zero at the end of each bit
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

140
Fiber Optic Communications
Unipolar
1
2
3
4
5
6
7
8
9
10
Polar
Bipolar
A
–A
A
A
–A
0
Time
Time
Time (Arb. units) 
(b)
(a)
(c)
1
1
0
1
1
1
0
0
0
1
Voltage
Voltage
Voltage
Figure 4.1
Various line codes: (a) unipolar, (b) polar, and (c) bipolar.
NRZ
t
(a)
1
1
0
1
1
1
t
(b)
1
0
1
1
1
1
RZ
x(t)
x(t)
Figure 4.2
Pulse shapes: (a) NRZ, and (b) RZ.
slot, as shown in Fig. 4.2. The advantage of NRZ is that fewer transitions between ‘0’ and ‘1’ are required
compared with RZ, since the signal amplitude remains the same if consecutive bits are ‘1’ or ‘0’. Therefore,
the bandwidth of a NRZ signal is less than that of a RZ signal. The wider spectral width of a RZ signal can
also be understood from the fact that the pulse width of RZ pulse is shorter than that of a NRZ pulse. The
message signal may be written as
m(t) = A0
∞
∑
n=−∞
anp(t −nTb),
(4.1)
where an is the binary data in the bit slot, p(t) represents the pulse shape, and A0 is a real constant.
An important parameter that characterizes a RZ signal is the duty cycle. This is defined as the time for which
the light is turned on in a bit interval divided by the bit interval, i.e., the fraction of time over which the light
is on “duty” within a bit interval. For example, for a 10-Gb/s system, the bit interval Tb is 100 ps and if the

Optical Modulators and Modulation Schemes
141
duration of the signal pulse is 30 ps, the duty cycle is 30%. The duty cycle of a NRZ signal can be considered
to be 100%. In the above definition, we have assumed rectangular pulses. For pulses of arbitrary shape, the
duty cycle x can be defined as the ratio of the FWHM of a pulse to the bit interval Tb,
x = FWHM
Tb
.
(4.2)
When rectangular pulses are used, a RZ pulse in a bit interval [−Tb∕2, Tb∕2] may be written as
p(t) = 1 for |t| < xTb∕2
= 0 otherwise.
(4.3)
4.4
Power Spectral Density
In this section, we find an expression for the power spectral density (PSD) of various line coders. Let the
message signal be of the form
m(t) = A0 lim
L→∞
L
∑
l=−L
alp(t −lTb).
(4.4)
Noting that
{p(t −lTb)} = ̃p(f)ei2𝜋flTb,
(4.5)
the Fourier transform of m(t) is
̃m(f) = A0̃p(f) lim
L→∞
L
∑
l=−L
alei2𝜋flTb.
(4.6)
The PSD is defined as
𝜌m(f) = lim
T→∞
< | ̃m(f)|2 >
T
,
(4.7)
where T = (2L + 1)Tb and <
> denotes the ensemble average. From Eq. (4.6), we have
| ̃m(f)|2 = ̃m(f) ̃m∗(f)
= A2
0̃p(f) lim
L→∞
L
∑
l=−L
alei2𝜋flTb ̃p∗(f)
L
∑
k=−L
a∗
ke−i2𝜋fkTb
= A2
0|̃p(f)|2 lim
L→∞
L
∑
l=−L
L
∑
k=−L
ala∗
kei2𝜋f(l−k)Tb.
(4.8)
Using Eq. (4.8) in Eq. (4.7), we obtain
𝜌m(f) = A2
0|̃p(f)|2 lim
L→∞
1
(2L + 1)Tb
L
∑
l=−L
L
∑
k=−L
< ala∗
k > ei2𝜋f(l−k)Tb.
(4.9)
Let us first consider the case of a polar signal in which al is a random variable that takes values ±1 with equal
probability. When k ≠l,
< ala∗
k >= 0.
(4.10)
This can be explained as follows. When ala∗
k = 1, it corresponds to ak = 1 and al = 1, or ak = −1 and al = −1;
when ala∗
k = −1, it corresponds to ak = −1 and al = 1, or ak = 1 and al = −1. The chance that ala∗
k = 1 is the

142
Fiber Optic Communications
same as that of having ala∗
k = −1. Therefore, the ensemble average of ala∗
k is zero when k ≠l. When k = l,
< ala∗
k >=< |ak|2 >= 1.
(4.11)
The terms in Eq. (4.9) can be divided into two groups; terms with k = l and terms with k ≠l,
𝜌m(f) = A2
0|̃p(f)|2 lim
L→∞
1
(2L + 1)Tb
[
L
∑
k=−L
< |ak|2 > +
L
∑
l=−L
L
∑
k=−L,k≠l
< ala∗
k > ei2𝜋f(l−k)Tb
]
.
(4.12)
Using Eqs. (4.10) and (4.11) in Eq. (4.12), we find
𝜌m(f) = A2
0|̃p(f)|2 lim
L→∞
2L + 1
(2L + 1)Tb
=
A2
0|̃p(f)|2
Tb
.
(4.13)
4.4.1
Polar Signals
Consider a polar signal with RZ pulses. The pulse shape function p(t) is
p(t) = rect
(
t
xTb
)
,
(4.14)
̃p(f) = xTbsinc (xTbf),
(4.15)
where sinc (y) = sin (𝜋y)∕(𝜋y). Using Eq. (4.15) in Eq. (4.13), we find
𝜌RZ
m (f) = A2
0x2Tbsinc2(xTbf).
(4.16)
When x = 1, this corresponds to a NRZ pulse and the PSD is
𝜌NRZ
m
(f) = A2
0Tbsinc2(Tbf).
(4.17)
Fig. 4.3 shows the PSD of a polar signal with NRZ and RZ pulses. As can be seen, the signal bandwidth of RZ
pulses with 50% duty cycle is twice that of NRZ. For a polar signal with NRZ, the effective signal bandwidth
(up to the first null) is B Hz. This is twice the theoretical bandwidth required to transmit B pulses per second
[1]. Therefore, the polar signal is not the most bandwidth-efficient modulation format.
4.4.2
Unipolar Signals
The PSD of a unipolar signal is given by (see Example 4.5)
𝜌m(f) =
A2
0|̃p(f)|2
4Tb
[
1 + 1
Tb
∞
∑
l=−∞
𝛿(f −l
Tb
)
]
.
(4.18)
For RZ pulses, ̃p(f) is given by Eq. (4.15). Substituting Eq. (4.15) in Eq. (4.18), we find
𝜌RZ
m (f) =
A2
0x2Tb
4
sinc2(xTbf)
[
1 + 1
Tb
∞
∑
l=−∞
𝛿(f −l
Tb
)
]
.
(4.19)

Optical Modulators and Modulation Schemes
143
f
(a)
f
(b)
–3B
–2B
–B
0
3B
2B
B
–3B
–2B
–B
0
3B
2B
B
ρm( f)
ρm( f)
Figure 4.3
Spectrum of a polar signal: (a) NRZ, and (b) RZ with 50% duty cycle. B = bit rate.
When x = 1 (NRZ), the sinc function has nulls at f = l∕Tb, l ≠0, which coincide with the locations of the
delta functions. Therefore, the PSD of a unipolar NRZ signal is
𝜌NRZ
m
(f) =
A2
0Tb
4
sinc2(Tbf)
[
1 + 𝛿(f)
Tb
]
.
(4.20)
Fig. 4.4 shows the PSD of unipolar NRZ and RZ signals. The PSD has continuous and discrete components
corresponding to the first and second terms on the right-hand side of Eq. (4.19). For a RZ signal, the discrete
components are located at f = l∕Tb. However, the PSD of a unipolar NRZ signal has only a d.c. component
(f = 0). The origin of the discrete components can be understood as follows. The unipolar NRZ signal can
be imagined as a polar signal with constant bias. The PSD of this constant bias is the discrete component at
f = 0. In the case of unipolar RZ, it can be imagined as a polar signal added to a periodic pulse train. Since
the Fourier series expansion of the periodic pulse train leads to frequency components at the clock frequency
1∕Tb, and its harmonics, the PSD has discrete components at these frequencies.
f
f
(a)
(b)
–3B
–2B
–B
0
3B
2B
B
–3B
–2B
–B
0
3B
2B
B
ρm( f)
ρm( f)
Figure 4.4
Spectrum of a unipolar signal: (a) NRZ, and (b) RZ with 50% duty cycle. B = bit rate. The arrows indicate
delta functions.

144
Fiber Optic Communications
4.5
Digital Modulation Schemes
4.5.1
Amplitude-Shift Keying
A laser is an optical carrier whose amplitude and/or phase can be varied in accordance with a message signal
by means of an optical modulator. Let the laser output be (Fig. 4.5(a))
c(t) = A cos (2𝜋fct + 𝜃).
(4.21)
In Eq. (4.21), the amplitude A, frequency fc, and phase factor 𝜃are constants. When the amplitude A is varied
in accordance with a message signal m(t) while keeping fc and 𝜃constant, the resulting scheme is known as
amplitude modulation. Suppose the amplitude is proportional to the message signal m(t),
A(t) = kam(t),
(4.22)
where ka is amplitude sensitivity. Now, the carrier is said to be amplitude modulated. The modulated signal
can be written as
s(t) = kam(t) cos (2𝜋fct + 𝜃).
(4.23)
When the message signal m(t) is a digital signal, such as shown in Fig. 4.5(b), the modulation scheme is
known as amplitude-shift keying (ASK) or on–off keying (OOK). In general, to transmit bit ‘1’, a sinusoid of
certain amplitude A1 is sent and to transmit bit ‘0’, a sinusoid of amplitude A2 is sent.
4.5.2
Phase-Shift Keying
When the phase 𝜃of the carrier is varied in accordance with the message signal m(t) while keeping the
amplitude A and frequency fc constant, the resulting scheme is known as phase modulation. Suppose the
phase is proportional to the message signal,
𝜃(t) = kpm(t),
(4.24)
Optical carrier
0
t
(a)
Modulated signal
Message signal
t
(b)
(c)
1
1
0
1
0
1
1
1
t
m(t)
c(t)
s(t)
Figure 4.5
Modulation of the optical carrier by digital data: (a) carrier, (b) data, and (c) modulated signal.

Optical Modulators and Modulation Schemes
145
t
(a)
PSK
Message signal
t
(b)
(c)
1
1
0
1
0
1
1
1
t
FSK
s(t)
s(t)
m(t)
180° phase jump
Figure 4.6
Phase and frequency modulation of an optical carrier. (a) Message signal, (b) Phase-shift keying, and
(c) Frequency-shift keying.
where kp is called the phase sensitivity. Now, the optical carrier is said to be phase modulated. The modulated
signal can be written as
s(t) = A cos [2𝜋fct + kpm(t)].
(4.25)
For example,
m(t) =
{
−V
for bit ‘1’
V
for bit ‘0’ ,
(4.26)
where V = 𝜋∕(2kp). From Eq. (4.25), it follows that
s(t) =
{
A sin (2𝜋fct)
for bit ‘1’
−A sin (2𝜋fct)
for bit ‘0’ .
(4.27)
When the message m(t) is a digital signal, such as shown in Fig. 4.6(a), the modulation scheme is known as
phase-shift keying (PSK) or binary phase-shift keying (BPSK). Fig. 4.6(b) shows the modulated signal when
the modulation scheme is PSK. Note that there is a 180∘phase jump at the bit boundaries if the digital data
in the consecutive bit intervals are different. In general, PSK can be described as a scheme in which a bit ‘1’
is transmitted by sending a sinusoid of phase 𝜃1 and a bit ‘0’ is transmitted by sending a sinusoid of phase 𝜃2.
Fig. 4.7 shows the schematic of PSK generation.
4.5.3
Frequency-Shift Keying
FSK can be described as a scheme in which a bit ‘1’ is transmitted by sending a sinusoid of frequency f1 and
a bit ‘0’ is transmitted by sending a sinusoid of frequency f2, as shown in Fig. 4.6(c). Let the message signal

146
Fiber Optic Communications
PSK signal
Message signal m(t)
PM
Carrier
Acos(2π fct)
Figure 4.7
Generation of a PSK signal. PM = phase modulator.
be binary data of the form
m(t) =
{
m1
for bit ‘1’
m2
for bit ‘0’ .
(4.28)
The transmitted signal within a bit interval [0, Tb] can be written as
s(t) = A cos [𝜙(t)],
(4.29)
where
𝜙(t) =
{
2𝜋f1t
for bit ‘1’
2𝜋f2t
for bit ‘0’ ,
(4.30)
fi = fc + kf mi, i = 1, 2.
(4.31)
kf is the frequency modulation index. Suppose the phase 𝜙(t) in the bit interval [0, Tb] is 2𝜋f1t and the phase
𝜙(t) in the next interval is 2𝜋f2t. At t = Tb, 𝜙(Tb−) = 2𝜋f1Tb and 𝜙(Tb+) = 2𝜋f2Tb. This could cause phase
discontinuity at the bit boundaries, which is undesirable in some applications. One possible way of avoiding
phase discontinuities is to choose the frequencies such that the phase accumulated over a bit interval is an
integral multiple of 2𝜋,
fc + kf m1 = n
Tb
, n is an integer,
fc + kf m2 = l
Tb
, l is an integer.
(4.32)
Under these conditions, the phase would be continuous throughout and such a scheme is known as continuous
phase frequency-shift keying (CPFSK). Note that the ASK signal has a constant frequency and the amplitude
is varying, whereas FSK is a constant-amplitude signal but the instantaneous frequency is changing with time.
4.5.4
Differential Phase-Shift Keying
When a PSK signal is transmitted, it requires a complex receiver architecture to detect the phase. This is
because the optical signal acquires a phase due to propagation, which fluctuates due to temperature, stress,

Optical Modulators and Modulation Schemes
147
...
...
PM
NRZ data m(t) 
exp(i2πfct)
Laser
Fiber link
Laser (LO)
DSP
Coherent receiver
front end 
m(t)
exp{i[2π fct + kpm(t) + ɵ]}
exp{i[2π fct + kpm(t)]}
exp[i(2π fct)]
Figure 4.8
Block diagram of a fiber-optic system based on PSK.
and other factors. Therefore, to estimate the transmitted phase, we need a reference at the receiver which
is provided by a laser known as a local oscillator (LO), whose phase is aligned with that of the received
optical carrier (see Chapters 5 and 11). The phase alignment is achieved by phase estimation in digital domain
using digital signal processing (DSP) techniques. This concept is illustrated in Fig. 4.8. The estimation of the
absolute phase of the optical carrier is difficult, and also the linewidth of the LO should be quite small to
avoid impairment due to laser phase noise. Instead of using the LO as a reference, the phase of the previous
bit can be taken as a reference for the current bit. In this case, the local oscillator is replaced by the previous
bit, which is obtained by delaying the current bit by the bit interval Tb. This scheme works relatively well
under the assumption that the phase shift introduced due to propagation (𝜃in Fig. 4.8) is the same for both the
current bit and the previous bit. In other words, the phase shift due to propagation should not fluctuate within
a time period Tb. Under this condition, the previous bit could act as a reference to estimate the phase of the
current bit. This is known as differential phase detection. The data at the transmitter should be encoded so that
the phase of the current bit should be changed by 0 or 𝜋relative to the previous bit. In contrast, in the case
of PSK, a phase of 0 or 𝜋is encoded relative to the absolute phase of the optical carrier corresponding to the
current bit. Suppose the binary data to be transmitted is 010111. Let the message signal m(t) in the interval
[0, Tb] be −1 V. This would serve as a reference for the next bit. To transmit the first bit ‘0’ of the binary
data 010111 in the interval [Tb, 2Tb], we introduce no phase shift relative to the previous bit. To transmit the
next bit ‘1’ of the binary data, we introduce a phase shift of 𝜋relative to the previous bit, i.e., if the previous
voltage level is −1 V, the current voltage level will be +1 V and vice versa. Continuing this process, we obtain
the message signal shown in Table 4.1 and in Fig. 4.9. This type of coding is known as differential coding. In
summary, the transmission of bit ‘1’ is done by toggling from +1 V to −1 V or vice versa and the transmission
of bit ‘0’ is done by retaining the voltage of the previous bit. The above observation leads to a simple detection
Table 4.1
Differential coding.
Bit interval
[Tb, 2Tb]
[2Tb, 3Tb]
[3Tb, 4Tb]
[4Tb, 5Tb]
[5Tb, 6Tb]
[6Tb, 7Tb]
Binary data
0
1
0
1
1
1
Message signal m(t)
−1 V
+1 V
+1 V
−1 V
+1 V
−1 V

148
Fiber Optic Communications
2Tb
–1V
+1V
3Tb
4Tb
6Tb
5Tb
7Tb
Tb
0
m(t)
Figure 4.9
The DPSK signal corresponding to the binary data of Table 4.1.
NRZ data
Delay Tb 
Phase
modulator 
m(t)
Acos(2π fct)
DPSK signal
XOR
b(t)
Acos[2π fct + kpm(t)]
Figure 4.10
Generation of a DPSK signal.
scheme: take a product of the current bit (after demodulation) with the previous bit. If the product is negative,
the transmitted data at the current bit is ‘1’. Otherwise, it is ‘0’.
The differential encoding can be realized using a XOR gate and a delay circuit as shown in Fig. 4.10. Let
us assign a voltage level of +1 V and −1 V to the logic levels of 1 and 0, respectively. Let m(t) be the encoded
message signal. If the incoming binary data b(t) to be transmitted is 0 and the previous message bit (of m(t))
is 0 (or −1 V), the current message bit will also be 0 since we introduce no phase shift relative to the previous
message bit. If the binary data b(t) is 1 and the previous message bit is 0 (1), the current bit will be 1 (0) since
we need to introduce a 𝜋phase shift (or inversion of the amplitude) with respect to the previous message bit.
Thus, we have
m(t) = b(t) ⊕m(t −Tb),
(4.33)
where ⊕denotes the exclusive OR (XOR) operation. The truth table is shown in Table 4.2 and the waveforms
for the input data b(t) and the message signal m(t) are shown in Fig. 4.11.
Table 4.2
Truth table.
b(t)
m(t −Tb)
m(t)
Logic level
Voltage level (V)
Logic level
Voltage level (V)
Logic level
Voltage level (V)
0
−1
0
−1
0
−1
0
−1
1
1
1
1
1
1
0
−1
1
1
1
1
1
1
0
−1

Optical Modulators and Modulation Schemes
149
t
t
t
0
1
0
1
1
1
m(t)
m(t – Tb)
2Tb
–1
–1
–1
+1
+1
+1
3Tb
4Tb
6Tb
5Tb
Tb
0
b(t)
Figure 4.11
Input waveform b(t) and message waveform m(t).
Example 4.1
Consider the input data sequence
{bn} = 01101110.
To proceed with the deferential encoding, add an extra bit to the encoder output. This extra bit may be chosen
arbitrarily to be 0. Determine the encoded message sequence mn.
Solution:
Let the first bit of the sequence mn be 0 (or −1 V), which serves as the reference. To transmit the first bit
0 of {bn}, we introduce no phase shift relative to the reference voltage. Therefore, the voltage level of the
second bit of {mn} is −1 V (or 0). To transmit the second bit 1 of {bn}, we introduce a 𝜋phase shift relative
to the reference voltage (the voltage corresponding to the second bit of {mn}). Therefore, the voltage level
corresponding to the third bit of {mn} is +1 V (or 1). Continuing this process, we find
{mn} = 001001011.
4.6
Optical Modulators
The simplest optical modulator we could think of is the switch of a flash light. Suppose we turn on a flash
light for 1 second and turn it off for 1 second. We generate digital data ‘1’ and ‘0’, respectively, as shown in
Fig. 4.12. In this example, the bit rate of the optical data generated from the flash light is 1 bit/s.
Optical modulation techniques can be divided into two types: (i) direct modulation of lasers and (ii) external
modulation of lasers.
4.6.1
Direct Modulation
The laser drive current can be modulated by a message signal, as shown in Fig. 4.13. For example, when the
message signal is bit ‘0’ (bit ‘1’), the laser is turned off (on) and, therefore, the information in the electrical
domain is encoded onto the optical domain. Directly modulated lasers (DMLs) have some major drawbacks.

150
Fiber Optic Communications
1
2
3
4
0
Intensity (Arb. units) 
1
0
1
1
Time (s) 
Figure 4.12
A simple optical modulator: the switch of a flash light.
Laser
1
Electrical data
Fiber link
1 0 1
1
0
t
1 1 0 1
1
0
Power
Optical output
...
...
Figure 4.13
Direct modulation of a laser.
First, the instantaneous frequency of the laser output changes with time. This frequency chirping is caused by
the refractive index changes of the active layer due to the carrier density modulation. The interaction of the
positive chirp of the laser with the anomalous dispersion of the transmission fiber leads to pulse broadening
(Example 2.18) and sets a limit on the maximum achievable transmission distance. However, the interac-
tion of the laser chirp with the normal dispersion of the fiber leads to pulse compression initially (Example
2.18). In fact, the error-free transmission distance can be increased using positively chirped lasers and nor-
mal dispersion transmission fibers [2]. However, the pulses broaden eventually (even in normal dispersion
fibers) and the laser chirp leads to transmission penalties for long-haul applications. Directly modulated lasers
are usually used for transmission systems operating at low bit rates (≤10 Gb/s) and for short-haul applica-
tion (<100 km). The pulse distortion and frequency chirp prevent the use of directly modulated lasers for
high-bit-rate applications.
4.6.2
External Modulators
Fig. 4.14 shows the schematic of a transmitter using external modulators. Widely used external modulators
are: (i) the phase modulator, (ii) the Mach–Zehnder (MZ) interferometer modulator, and (iii) the electroab-
sorption (EA) modulator.

Optical Modulators and Modulation Schemes
151
Laser
Electrical data
Fiber optical link
Modulator
1 1 0 1
1
0
1 1 0 1
1
0
Field
t
Field
t
...
...
Figure 4.14
A transmitter using an external modulator.
4.6.2.1
Phase Modulators
The phase modulation of an optical carrier can be achieved in a number of ways. When an electric field is
applied to an electro-optic crystal, the refractive index of the crystal changes and, therefore, the phase (∝
refractive index) of an optical carrier propagating in the crystal also changes. The refractive index change is
directly proportional to the applied electric field intensity [3], [4]. This effect is known as the Pockels effect
or linear electro-optic effect.
Consider the light propagation in a LiNbO3 crystal as shown in Fig. 4.15. Suppose E is the electric field
intensity due to the applied voltage and an optical wave is propagating along the x-axis with its direction of
polarization parallel to the z-axis. The dependence of the refractive index on the reflective field intensity is
given by [3], [4]
n = n0 −1
2n3
0r33Ez
(4.34)
where n0 is the refractive index in the absence of the applied electric field, and r33 is a coefficient describing
the electro-optic effect. If V is the voltage applied across the crystal and d is the thickness of the crystal, the
z-component of the electric field intensity is
Ez = V∕d.
(4.35)
Optical input
Electrode
Ez
Optical output
V
Electrode
x
z
LiNbO3 crystal
L
d
Figure 4.15
Phase modulation of an optical signal in a LiNbO3 crystal.

152
Fiber Optic Communications
Suppose the optical field of the incident optical wave is
𝜓(t, 0) ≡𝜓in(t) = A0 exp (−i2𝜋fct).
(4.36)
Using Eqs. (1.95), (4.34), and (4.35), the optical wave emerging from the LiNbO3 crystal is
𝜓in(t, L) = A0 exp [−i(2𝜋fct −𝜙)],
(4.37)
where
𝜙= 2𝜋
𝜆0
nL = 2𝜋L
𝜆0
(
n0 −
n3
0r33V
2d
)
= 𝜙0 −Δ𝜙.
(4.38)
Here, 𝜙0 is the constant phase shift in the absence of the applied electric voltage, L is the length of the crystal,
and
Δ𝜙=
𝜋Ln3
0r33V
𝜆0d
(4.39)
is the phase change. The required voltage to yield a phase change of 𝜋is known as the half-wave voltage or
switching voltage V𝜋, and is given by
Δ𝜙= 𝜋=
𝜋Ln3
0r33V𝜋
𝜆0d
or V𝜋=
𝜆0
n3
0r33
d
L.
(4.40)
Substituting Eq. (4.40) in Eq. (4.37), we obtain
𝜓in(t, L) = A0 exp
[
−i
(
2𝜋fct −𝜙0 + 𝜋V
V𝜋
)]
.
(4.41)
Thus, we see that the phase change is directly proportional to the applied voltage. If V(t) is a message signal,
the phase of the optical carrier can be varied in accordance with the message signal. For the example, if
V(t) = V𝜋, in a bit interval 0 < t < Tb, the carrier phase is shifted by 𝜋. If V(t) = 0, no phase shift is introduced.
Thus, the PSK or DPSK signal can easily be generated using a phase modulator.
Example 4.2
An electro-optic modulator operating at 1530 nm has the following parameters:
Thickness d = 10 μm
Length L = 5 cm
Index n0 = 2.2
Pockel coefficient r33 = 30 pm/V
Calculate the voltage required to introduce a phase shift of 𝜋∕2.
Solution:
From Eq. (4.39), we have
V = Δ𝜙𝜆0d
𝜋Ln3
0r33
.

Optical Modulators and Modulation Schemes
153
With Δ𝜙= 𝜋∕2,
V =
𝜋∕2 × 1530 × 10−9 × 10 × 10−6
𝜋× 5 × 10−2 × (2.2)3 × (30 × 10−12)V
= 0.47 V.
4.6.2.2
Dual-Drive Mach–Zehnder Modulators (MZMs)
A MZM consists of two arms, as shown in Fig. 4.16. Voltages V1 and V2 are applied to the upper and lower
arms, respectively. The exact analysis of the field propagation in this structure requires knowledge of the
transverse field distributions. Instead, we follow an approximate approach in which the guided modes of the
waveguide are replaced by plane waves propagating in the direction of the x-axis. We ignore the losses in the
y-branches and arms. Let the electric field of the input optical beam be
𝜓in = A0 exp (−i2𝜋fct),
(4.42)
where fc is the frequency of the optical carrier. The first y-branch splits the input wave into two optical beams
of equal power. Therefore, the electric field of the optical beam entering the upper (or lower) arm of the
interferometer is
A0
√
2
exp (−i2𝜋fct).
(4.43)
In Eq. (4.43), we have ignored a constant phase factor due to propagation in the y-branch. The factor 1∕
√
2
is introduced so that the total power is conserved. From the law of reciprocity, it follows that if the input and
output of a y-branch are reversed, i.e., if the y-branch is used as a two-input/one-output device with inputs
being 𝜓in∕
√
2, its output would be 𝜓in, which is 1∕
√
2 times the addition of its inputs. This fact will be used
later to find the output of the second y-branch.
The optical beams in the upper and lower arms undergo a phase shift of 𝜙1 and 𝜙2, respectively, in the
presence of applied voltages. Using Eqs. (4.38) and (4.40), we have
𝜙j = 2𝜋L
𝜆0
(
n0 −1
2n3
0r33Vj(t)∕d
)
, j = 1, 2
= 𝜙0 −
Vj𝜋
V𝜋
.
(4.44)
x
z
Electrodes
Electrodes
A0 exp(–i2πfct)
V1
V2
Aout exp(–i2πfct)
Figure 4.16
A dual-drive MZM.

154
Fiber Optic Communications
The optical beams in the upper and lower arms are recombined via a second y-branch. The optical fields at
the inputs of the second y-branch are
𝜓j = A0
√
2
exp [−i(2𝜋fct −𝜙j)], j = 1, 2.
(4.45)
The output of the second y-branch is
𝜓out = 𝜓1 + 𝜓2
√
2
.
(4.46)
Substituting Eqs. (4.45) and (4.44) in Eq. (4.46), we find that the output of the MZM is [5], [6]
𝜓out = A0
√
2
exp (−i𝜋fct)
[
exp (i𝜙1)
√
2
+ exp (i𝜙2)
√
2
]
= Aout exp (−i𝜋fct),
(4.47)
where
Aout = A0 exp [i(𝜙1 + 𝜙2)∕2]exp [i(𝜙1 −𝜙2)∕2] + exp [−i(𝜙1 −𝜙2)∕2]
2
= A0 exp [i(𝜙1 + 𝜙2)∕2] cos [(𝜙1 −𝜙2)∕2].
(4.48)
From Eq. (4.48), we see that the power is conserved when 𝜙1 = 𝜙2. When 𝜙1 = 𝜙2 + 𝜋, optical fields coming
from two branches of the second y-branch do not excite a guided mode in the output waveguide; instead,
radiation modes are excited which go out of the waveguide [3]. From Eq. (4.48), it appears that conservation
of power is not satisfied when 𝜙1 ≠𝜙2. But, if we take into account radiation modes, conservation of power
is always satisfied. Using Eq. (4.44) in Eq. (4.48), we obtain
Aout = A0 exp (i ̄𝜙) cos
{[V1(t) −V2(t)] 𝜋
2V𝜋
}
,
(4.49)
where
̄𝜙= 𝜙1 + 𝜙2
2
= 𝜙0 −[V1(t) + V2(t)]𝜋
2V𝜋
.
(4.50)
The instantaneous frequency shift or frequency chirp is given by (Eq. (2.165))
𝜔i = −d ̄𝜙
dt =
𝜋
2V𝜋
(dV1
dt + dV2
dt
)
.
(4.51)
The output optical power is
Pout = |Aout|2 = P0cos2
{[V1(t) −V2(t)] 𝜋
2V𝜋
}
,
(4.52)
where P0 = A2
0. The frequency chirp combined with fiber dispersion could lead to pulse broadening (see
Example 2.18) and performance degradations. Therefore, it is desirable to have zero chirp. From Eq. (4.51),
we see that the chirp is zero if
dV1(t)
dt
= −dV2(t)
dt
(4.53)
or
V1(t) = −V2(t) + Vbias,
(4.54)

Optical Modulators and Modulation Schemes
155
where Vbias is a constant bias voltage. This driving condition is known as a balanced driving or push–pull
operation. Let V1(t) be the message signal m(t). Using Eq. (4.54) in Eqs. (4.48) and (4.52) and ignoring
constant phase shift, we obtain
Aout = A0 cos
{[
m(t) −Vbias
2
]
𝜋
V𝜋
}
,
(4.55)
Pout = P0cos2
{[
m(t) −Vbias
2
]
𝜋
V𝜋
}
.
(4.56)
Let us consider two cases: (i) Vbias = V𝜋∕2 and (ii) Vbias = V𝜋.
Case (i) Vbias = V𝜋∕2. Let
Aout = A0 cos
[m(t)𝜋
V𝜋
−𝜋
4
]
= A0
√
2
[
cos
(m(t)𝜋
V𝜋
)
+ sin
(m(t)𝜋
V𝜋
)]
.
(4.57)
When m(t) ≪V𝜋∕𝜋,
cos
[m(t)𝜋
V𝜋
]
≅1 and sin
[m(t)𝜋
V𝜋
]
≅m(t)𝜋
V𝜋
.
(4.58)
Therefore, we have
𝜓out = A0
√
2
[
1 + m(t)𝜋
V𝜋
]
exp (−i2𝜋fct).
(4.59)
The above equation corresponds to an amplitude modulated (AM) wave used in commercial AM broadcasting.
Thus, in the small signal limit and with Vbias = V𝜋∕2, the MZ modulator acts as an AM modulator.
Case (ii) Vbias = V𝜋. Now, Eq. (4.55) becomes
Aout = A0 sin
[m(t)𝜋
V𝜋
]
.
(4.60)
When m(t)𝜋∕V𝜋≪1,
𝜓out =
(A0𝜋
V𝜋
)
m(t) exp (−i2𝜋fct).
(4.61)
Now, the MZM acts as a product modulator which multiplies the message signal and optical carrier. The above
equation also corresponds to a form of AM modulation known as double sideband with suppressed carrier
(DSB-SC). The output power in the small-signal limit is
Pout ≅
A2
0𝜋2
V2
𝜋
m2(t).
(4.62)

156
Fiber Optic Communications
D.c. Extinction Ratio
So far we have assumed equal power splitting between two arms of the interferometers. In practice, the power
splitting may not be exactly 50 ∶50 due to temperature or stress fluctuations. In general, the optical field
distribution entering the arm j is
A0𝛼j exp (−i2𝜋fct), j = 1, 2,
(4.63)
with 𝛼2
1 + 𝛼2
2 = 1. Now, Eq. (4.47) is modified as
𝜓out = A0 exp (−i2𝜋fct)
𝛼1 + 𝛼2
[𝛼1 exp (i𝜙1) + 𝛼2 exp (i𝜙2)]
(4.64)
and the output optical power is
Pout =
P0
(𝛼1 + 𝛼2)2 [𝛼2
1 + 𝛼2
2 + 2𝛼1𝛼2 cos (𝜙1 −𝜙2)].
(4.65)
When 𝜙1 −𝜙2 = 0, the interference is constructive and the output is maximum:
Pmax
out = P0.
(4.66)
When 𝜙1 −𝜙2 = 𝜋, the interference is destructive and the output is minimum:
Pmin
out = P0(𝛼1 −𝛼2)2
(𝛼1 + 𝛼2)2 .
(4.67)
The d.c. extinction ratio is defined as the ratio of maximum to minimum power:
𝛿=
Pmax
out
Pmin
out
=
(𝛼1 + 𝛼2
𝛼1 −𝛼2
)2
.
(4.68)
In dB units, it may be expressed as
𝛿(dB) = 10 log10𝛿.
(4.69)
In the ideal case, 𝛼1 = 𝛼2 = 1∕
√
2 and 𝛿is infinite. For ASK, it is desirable to have zero power for bit ‘0’. How-
ever, because of the power-splitting imperfections, the minimum power is not zero and, as a result, the distance
between constellation points becomes smaller, which leads to performance degradations (see Chapter 8).
Eq. (4.68) can be written in a different form [5], [6],
r =
√
𝛿−1
√
𝛿+ 1
,
(4.70)
where r = 𝛼2∕𝛼1. Eq. (4.54) provides the biasing condition to obtain zero chirp. However, Eq. (4.54) is
obtained for the ideal case of infinite d.c. extinction ratio. For the case of finite extinction ratio, there will
be residual chirp even when the zero-chirp biasing condition given by Eq. (4.54) is used, which degrades the
performance [5].

Optical Modulators and Modulation Schemes
157
4.6.2.3
Electroabsorption Modulator (EAM)
Electroabsorption refers to the dependence of the absorption coefficient of a semiconductor on the applied
electric field. The band gap of a semiconductor decreases as the applied field increases. Consider an optical
carrier with frequency fc < Eg0∕h, where Eg0 is the band gap in the absence of the applied electric field. Let
the driving voltage V(t) vary from 0 to V0 volts, as shown in Fig. 4.17. When V(t) = 0, the photon energy
is less than the band gap and the optical carrier is not absorbed. When V(t) = V0, the band gap decreases.
Now the photon energy could be larger than the band gap and the optical carrier is absorbed, which generates
electron–hole pairs. Thus, the information in the electrical domain is translated into the optical domain.
Fig. 4.18 shows the typical dependence of the absorption coefficient on the wavelength. Suppose the carrier
wavelength is 𝜆0. Let 𝛼0 and 𝛼1 be the absorption coefficients at V(t) = 0 and V(t) = V0, respectively. If L is
the length of the modulator, the optical power exiting the modulator is
Pout =
{
Pmax = P0 exp (−𝛼0L)
when V(t) = 0
Pmin = P0 exp (−𝛼1L)
when V(t) = V0
(4.71)
Light signal
EA
modulator 
t
V0
t
Field
envelope
V(t)
V(t)
Figure 4.17
Amplitude modulation using an EAM.
Wavelength, λ
V = 0
V = V0
α1
α0
λ0
Absorption coefficient
Figure 4.18
Typical dependence of absorption coefficient on wavelength.

158
Fiber Optic Communications
where P0 is the input power; the extinction ratio is
𝛿= Pmax
Pmin
= exp (−𝛼0L)
exp (−𝛼1L).
(4.72)
To obtain the optimum performance, a high extinction ratio is desirable. To achieve this, typically InP-based
semiconductors are used for 1300-nm or 1550-nm applications.
The absorption coefficient can be changed significantly by applying a relatively lower driving voltage.
Therefore, the EAMs are very effective and the size could be quite small. The length of EAMs is typically
200 mm, whereas that of electro-optic modulators is a few centimeters. EAMs can easily be integrated with
the laser diode, since both are based on similar semiconductor materials. The drawbacks of EAMs are as
follows. (i) They have residual chirps similar to directly modulated lasers. The interaction of the chirp and
fiber dispersion could lead to enhanced pulse broadening. (ii) The extinction ratio is typically ≤10 dB, which
could lead to a power penalty [8].
4.7
Optical Realization of Modulation Schemes
4.7.1
Amplitude-Shift Keying
The optical ASK signal can be generated using a MZM, as shown in Fig. 4.19. The optical power of the MZM
output may be written as (Eq. (4.56))
Pout = P0cos2
[m(t)𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
.
(4.73)
Let the message signal be a polar NRZ,
m(t) =
{
+V
for bit ‘1’
−V
for bit ‘0’ .
(4.74)
Laser
NRZ data
MZM
1
1
0
1
1
0
Voltage
t
ASK signal
1
1
0
1
1
0
t
Power
1
1
0
1
1
0
Field
t
Figure 4.19
Generation of ASK signal using a MZM.

Optical Modulators and Modulation Schemes
159
The desired Mach–Zehnder output power is
Pout =
{
P0
for bit ‘1’
0
for bit ‘0’ .
(4.75)
For bit ‘1’, substituting Eq. (4.74) in Eq. (4.73) and using Eq. (4.75), we obtain
P0cos2
[m(t)𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
= P0,
V𝜋
V𝜋
−Vbias𝜋
2V𝜋
= j𝜋, j = 0, ±1, ±2, …
(4.76)
Similarly, for bit ‘0’,
P0cos2
[m(t)𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
= 0,
−V𝜋
V𝜋
−Vbias𝜋
2V𝜋
= l𝜋
2 , l = ±1, ±3, …
(4.77)
Subtracting Eq. (4.77) from Eq. (4.76), we find
V =
(
j −l
2
) V𝜋
2 .
(4.78)
Addition of Eqs. (4.76) and (4.77) leads to
Vbias = −
(
j + l
2
)
V𝜋.
(4.79)
If we choose j = 0 and l = −1, we find
V = V𝜋
4 ,
(4.80)
Vbias = V𝜋
2 .
(4.81)
Thus, the polar NRZ in an electrical domain becomes a unipolar NRZ in an optical domain, as shown in
Fig. 4.19. The process of modulation can be visualized using Fig. 4.20. When V = V𝜋∕4 corresponding to
bit ‘1’, constructive interference occurs and the MZM power transmission is at its peak. When V = −V𝜋∕4,
destructive interference occurs and the MZM power output is zero. There are two approaches for the gen-
eration of RZ-ASK. The first approach is to apply the message signal, which is a polar RZ, as shown in
Fig. 4.21(a). The output of the MZ modulator will be a RZ-ASK signal. However, the achievable bit rate is
limited to 10 Gb/s using this approach [8]. The second approach is to introduce a RZ pulse carver in series
with a MZ modulator, as shown in Fig. 4.21(b). The pulse carvers can be realized by driving the MZ mod-
ulator with a sinusoidal electrical signal [8]. The advantage of the second approach is that higher bit rates
(≥40 Gb/s) can be realized.

160
Fiber Optic Communications
0
P0
0
1 1
1
1
t
0
1
1
0
1
0
1
t
–5Vπ/4
5Vπ/4
–Vπ/4
Vπ/4
Message voltage
Pout
Power transmission
P0
Figure 4.20
Power transmission function of the MZM. Vbias = V𝜋∕2.
Laser
Polar RZ signal
MZM
RZ-ASK signal
1
1
1
1
0
(a)
Laser
Polar NRZ signal
MZM
Power
(b)
Power
RZ pulse
carver
1
0
1
1
1
t
1
1
1
0
t
1
Field
t
Field
t
1
1
1
1
0
t
Power
1
0
1
1
1
t
t
Figure 4.21
Generation of RZ-ASK. (a) Using RZ signal in electrical domain. (b) Using RZ pulse carver in optical
domain.
4.7.2
Phase-Shift Keying
The optical field envelope of the MZM output can be written as (Eq. (4.55))
Aout = A0 cos
[m(t)𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
.
(4.82)

Optical Modulators and Modulation Schemes
161
Let the message signal be a polar NRZ given by Eq. (4.74). The desired field envelope of the Mach–Zehnder
output is
Aout =
{
+A0
for bit ‘1’
−A0
for bit ‘0’ .
(4.83)
For bit ‘1’, substituting Eq. (4.74) in Eq. (4.82) and using Eq. (4.83), we obtain
A0 cos
[
V𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
= A0,
V𝜋
V𝜋
−Vbias𝜋
2V𝜋
= 2j𝜋, j = 0, ±1, ±2, …
(4.84)
Similarly, for bit ‘0’, we have
A0 cos
[
−V𝜋
V𝜋
−Vbias𝜋
2V𝜋
]
= −A0,
−V𝜋
V𝜋
−Vbias𝜋
2V𝜋
= (2l + 1)𝜋, l = 0, ±1, ±2, …
(4.85)
Simplifying Eqs. (4.84) and (4.85), we obtain
V = [2(j −l) −1]V𝜋
2
,
Vbias = −[2(j + l) + 1]V𝜋.
(4.86)
If we choose j = 0 and l = −1, V = V𝜋∕2 and Vbias = V𝜋. Fig. 4.22 shows a schematic of the PSK signal
generation. Fig. 4.23 shows the MZM field transmission as a function of message signal m(t). When the
message signal m(t) = +V𝜋∕2, the field transmission is maximum and when m(t) = −V𝜋∕2, it is minimum.
Note that the field envelope is negative (𝜋phase) for bit ‘0’ and positive (0 phase) for bit ‘1’. However, the
power, which is the absolute square of the field, remains constant throughout. The PSK with NRZ rectangular
PSK signal
t
Laser
NRZ data
MZM
1
0
1
1
1
0
Field
Power
t
t
Phase reversal
1
0
1
1
1
–V
+V
P0
m(t)
Figure 4.22
Generation of optical PSK signal.

162
Fiber Optic Communications
1
0
1
1
1
t
Message voltage
MZM field transmission
Field envelope
1
0
1
1
1
A0
–A0
t
–Vπ –Vπ/2
Vπ
Vπ/2
Figure 4.23
MZM field transmission. Vbias = V𝜋.
Table 4.3
Voltage levels of the message signal.
Binary data
1
0
1
1
1
m(t)
V𝜋∕2
−V𝜋∕2
V𝜋∕2
V𝜋∕2
V𝜋∕2
Optical phase
0
𝜋
0
0
0
pulses is a constant power signal and there is a reversal of phase at the bit boundaries when the data changes
from ‘0’ to ‘1’ and vice versa. RZ-PSK can be generated using a RZ pulse carver in series with a MZM,
similar to RZ-ASK.
PSK can also be generated using a phase modulator. When the message signal corresponds to bit ‘1’, the
phase modulator provides no phase change and when it corresponds to bit ‘0’, the phase modulator changes
the carrier phase by 𝜋(see Table 4.3). However, the performance characteristics of a phase-modulator-based
PSK are worse than those of a MZM-based PSK [9]. This is because, in the case of the MZM, imperfections
in driving conditions are translated into optical power variations, but the information-bearing optical phase
is intact, whereas when a phase modulator is used, waveform imperfections distort the optical phase as well,
which degrades the performance [9].
4.7.3
Differential Phase-Shift Keying
The DPSK signal generation is analogous to PSK generation except for a precoder which provides differential
coding as discussed in Section 4.5.4. The differentially encoded signal m(t) is used to drive a PM or a MZM
as shown in Fig. 4.24.

Optical Modulators and Modulation Schemes
163
NRZ data 
Delay
Tb 
MZM
or PM
0
DPSK signal
m(t)
0 1
0
1 1 1
t
0 1 1
0 1
0
t
Laser
1
1
0
1
0
t
Precoder
Field
Aexp(i2πfct)
Figure 4.24
Optical DPSK signal generation.
4.7.4
Frequency-Shift Keying
In complex notation, the FSK signal in a bit interval [0, Tb] can be written as (Eq. (4.29))
s(t) = A exp {i[2𝜋(fct + kf m
′(t))]},
(4.87)
where
m
′(t) =
{
m1t
for bit ‘1’
m2t
for bit ‘0’ .
(4.88)
Suppose the message signal m(t) is a polar NRZ signal with m1 = +1 V and m2 = −1 V. The signal m
′(t) can
be obtained by integrating m(t) within a bit interval [0, Tb] and resetting it to zero at the end of the bit interval.
The signal m
′(t) is used to drive the phase modulator, as shown in Fig. 4.25.
4.8
Partial Response Signals∗
If the symbols in the adjacent bit slots interfere, this leads to degradation in transmission performance. How-
ever, if we introduce a controlled amount of ISI, it is possible to correct for it at the receiver since the amount
of ISI introduced is known. Suppose we add the kth bit and the (k −1)th bit, so that a known amount of ISI
is introduced. This can be accomplished by a delay-and-add filter as shown in Fig. 4.26. The delay-and-add
filter adds the signal uin(t) and the delayed version of uin(t),
uout(t) = uin(t) + uin(t −Tb).
(4.89)

164
Fiber Optic Communications
PM
FSK signal
Laser
Integrator
t
1 0
1 1 1
t
t
Field
1
0
1
1
1
s(t) = Aexp[i2π(fct + kfm'(t))]
m(t)
m'(t)
Tb
Tb
Figure 4.25
Optical FSK signal generation.
uin(t)
Delay
Tb
uout(t)
+
Figure 4.26
A duobinary encoder using delay-and-add filter.
If the voltage levels in the (k −1)th bit slot and the kth bit slot of uin(t) are both +1 V (or −1 V), this leads
to a voltage level of +2 V (or −2 V) in the kth bit slot of uout(t). If the voltage level in the (k −1)th bit slot
is of opposite polarity to that in the kth bit slot, this leads to a voltage level of 0 V in the kth bit slot of
uout(t). Thus, a two-level voltage waveform is translated into a three-level waveform, as shown in Fig. 4.27.
This scheme is called duobinary encoding. The above observation leads to the following decision rule: if
the voltage at the sample instant is positive, the present and previous bits are both ‘1’s. If the voltage at the
sample instant is negative, the present and previous bits are both ‘0’s. If the voltage is zero, the present bit is
a complement of the previous bit. In this case, knowledge of the decision on the logic level of the previous bit
is required to determine the current bit. The superposition of the (k −1)th bit and the kth bit leads to a known
amount of ISI only at the sampling instant Tb. This scheme of introducing a known amount of ISI is called
correlative coding. This is because there is a correlation between values of uout(t) between two successive bit
intervals. This scheme is also referred to as a partial response scheme [10]. One of the disadvantages of the
scheme shown in Fig. 4.26 is that the decision on the current bit at the receiver requires knowledge of the
decision on the previous bit. This implies that if the decision on the previous bit is wrong, the decision on
the current bit is also wrong, leading to error propagation. However, if we use the differential coding discussed
in Section 4.5.4, error propagation can be prevented. Suppose the binary data to be transmitted at the kth bit
slot is ‘1’. If differential coding is used, the current bit (kth bit slot) will have a phase shift of 𝜋relative to
the previous bit, i.e., if the voltage level of the previous bit is +1 V, the voltage level of the current bit will
be −1 V. Superposition of these two bits leads to a sample value of 0 V at kTb. Similarly, if the binary data to
be transmitted is 0, the voltage level of the current bit has a zero phase shift relative to the previous bit, i.e.,
the voltage level in the current and the previous bit slots is identical. In this case, the superposition of bits

Optical Modulators and Modulation Schemes
165
t
t
0
1
0
1
1
1
0
0
–1 V
+1 V
–2 V
+2 V
uout(t)
uin(t)
Figure 4.27
Duobinary encoding. The data in the interval −Tb < t < 0 of uin(t) is assumed to be ‘0’ (−1 V).
Polar NRZ data
+
Add-and-delay filter 
Differential coding
Duobinary data
m(t)
b(t)
b'(t)
Delay Tb
Delay
Tb 
Figure 4.28
Duobinary encoder.
leads to a sample value of ±2 V at kTb. This significantly simplifies the decision rule: if the absolute sample
value is ≤1 V, ‘1’ is transmitted. Otherwise, ‘0’ is transmitted. Fig. 4.28 shows the realization of a duobinary
encoder and Fig. 4.29 an example of duobinary encoding.
We can introduce a known amount of ISI such that a pulse in the 0th bit slot interferes only with a pulse in
the first bit slot and does not interfere with pulses in other bit slots at sampling instants t = nTb, where n is
an integer. Such a pulse can be described by
p(nTb) =
{
1
n = 0, 1
0
otherwise .
(4.90)
An example of a pulse satisfying the requirement of Eq. (4.90) is a Nyquist pulse [1], [7],
p(t) =
sin (𝜋Bt)
𝜋Bt(1 −Bt),
(4.91)

166
Fiber Optic Communications
Polar NRZ data
t
t
–2
+2
t
Differentially
encoded data 
Duobinary data
0
1
0
1
0
0
0
m(t)
–1
+1
b(t)
–1
+1
b'(t)
Tb
Figure 4.29
Duobinary encoding.
t
1
p(t)
0
p(t ‒ Tb)
2Tb
3Tb
4Tb
–Tb
Tb
–2Tb
–3Tb
Figure 4.30
A duobinary pulse in the 0th bit slot interacts only with a pulse in the first slot at t = Tb. At any other
sampling instants, p(t) = 0.
and is shown in Fig. 4.30. The pulse p(t) is used to transmit a ‘1’ and −p(t) is used to transmit a ‘0’. As can
be seen from Fig. 4.30, pulses p(t) and p(t −Tb) do not interfere at any sampling instants except at t = Tb.
Although pulses interfere at other times, this does not lead to performance degradations since the decisions
are made based on the sample values at t = nTb. The duobinary signal may be written as
m(t) =
∞
∑
n=−∞
bnp(t −nTb),
(4.92)

Optical Modulators and Modulation Schemes
167
0
1
2
–2
–1
1
0
1
1
0
0
Differentially
encoded NRZ data
Duobinary data
b(t)
m(t)
Tb
2Tb
3Tb
4Tb
5Tb
6Tb
Figure 4.31
Input waveform b(t) and duobinary waveform m(t). The data in the interval −Tb < t < 0 is assumed to
be ‘1’.
where bn is the differentially encoded message data. Using Eq. (4.90), we find
m(t) = bn + bn−1 at nTb.
(4.93)
Superposition of pulses p(t) and p(t −Tb) leads to a sample value of 2 at Tb. If both the pulses are −p(t) and
−p(t −Tb), the sample value would be −2 at Tb and if the pulses are p(t) and −p(t −Tb), the sample value
would be zero, as illustrated in Fig. 4.31. The Fourier transform of the pulse described by Eq. (4.91) is (see
Example 4.7)
̃p(f) = 2
B cos
(𝜋f
B
)
rect
( f
B
)
exp
(
−i𝜋f
B
)
.
(4.94)
From Fig. 4.32, we see that the bandwidth of the pulse is B∕2 Hz. In contrast, the bandwidth of NRZ-OOK
or RZ-OOK is ≥B Hz. Eq. (4.94) can be rewritten as
̃p(f) = 1
B[1 + exp (i2𝜋fTb)]rect (f∕B).
(4.95)
The factor exp (i2𝜋fTb) corresponds to a time delay of Tb and, therefore, the pulse p(t) can be generated by
cascading a delay-and-add filter and an ideal Nyquist filter with the transfer function
HN(f) =
{
1
for |f| < B∕2
0
otherwise
,
(4.96)
–B/2
B/2
0
f (Hz) 
~|p( f )|
Figure 4.32
Spectrum of the duobinary pulse.

168
Fiber Optic Communications
Impulse
+
0
1
Delay-and-add filter
Duobinary pulse
p( f )
~
Delay
Tb
HN( f )
–Tb
2Tb
xin(t)
xout(t) = p(t)
Figure 4.33
Duobinary pulse generation.
as shown in Fig. 4.33. Using Eq. (4.96), Eq. (4.95) can be written as
̃p(f) = 1
B[1 + exp (i2𝜋fTb)]HN(f).
(4.97)
If an impulse is applied to the filter with the transfer function ̃p(f), the output is a duobinary pulse p(t) (see
Fig. 4.33). This is because the output xout(t) and input xin(t) of Fig. 4.33 are related by
̃xout(f) = ̃xin(f)̃p(f).
(4.98)
For an impulse, ̃xin(f) = 1. Therefore, we have
xout(t) = p(t).
(4.99)
Fig. 4.34 shows the duobinary encoding scheme using the pulse shown in Fig. 4.33. The impulse generator
generates a positive impulse if the input is +1 V and it generates a negative impulse if the input is −1 V.
The delay-and-add filter in conjunction with a Nyquist filter generates the corresponding duobinary pulses.
Optical generation of partial response formats based on duobinary pulses is discussed in Ref. [8]. Fig. 4.35
shows the schematic of optical duobinary generation. The duobinary encoder shown in Fig. 4.35 could be
realized using either a delay-and-add filter (Fig. 4.26) or a delay-and-add filter in conjunction with a Nyquist
Differentially encoded
NRZ data 
Delay
Tb
+
HN( f)
Impulse
generator
b(t)
y(t)
m(t)
Delay-and-add filter
h(t)
Duobinary data
Figure 4.34
Duobinary encoder.

Optical Modulators and Modulation Schemes
169
Polar NRZ data
b'(t)
MZM
Differential coding
b(t)
Duobinary
encoder 
Laser
t
m(t)
Delay Tb 
A0 out
A0
Figure 4.35
Optical duobinary signal generation.
filter (Fig. 4.34). After the duobinary encoder, the message signal m(t) is used to drive the MZM. When
Vbias = V𝜋, the MZM output is given by Eq. (4.60),
Aout = A0 sin
[m(t)𝜋
V𝜋
]
,
(4.100)
Aout =
⎧
⎪
⎨
⎪⎩
A0
when m(t) = V𝜋∕2
−A0
when m(t) = −V𝜋∕2
0
when m(t) = 0
.
(4.101)
Thus, a three-level electrical signal is converted to an optical signal with three levels in an optical field enve-
lope, as shown in Fig. 4.36. The optical power of the MZM is
Pout =
{||A0||
2
when m(t) = ±V𝜋∕2
0
when m(t) = 0
.
(4.102)
Therefore, three voltage levels are translated into two power levels.
4.8.1
Alternate Mark Inversion
As discussed in Section 4.2, pulses representing two consecutive, ‘1’s would have opposite signs no matter
how many ‘0’s are between these ‘1’s. For example, the voltage levels of the AMI signal corresponding to
a bit sequence bn = {100110001} are {A00 −AA000 −A}, where A is the amplitude. To generate an AMI
signal, let us first consider the differential coding of the bit sequence bn. The voltage levels of the differentially
encoded data b
′(t) are given by {−1111 −11111 −1}, as shown in Fig. 4.37. From the figure, we observe
that the occurrence of bit ‘1’ of b(t) leads to a voltage transition from −1 V to 1 V of b
′(t); the occurrence of
the next bit ‘1’ leads to a voltage transition from 1 V to −1 V, no matter how many ‘0’ bits are between the
‘1’s. If we delay the differentially encoded data by Tb and subtract it from the current bit, the resulting signal
will have the desired properties of an AMI signal. The AMI signal is given by
m(t) = b′(t) −b′(t −Tb).
(4.103)

170
Fiber Optic Communications
1
0
1
0
1
t
b(t)
m(t)
q(t)
t
t
t
t
0
0
0
b'(t)
Polar NRZ
data 
After 
differential
coding
Optical field
envelope of
MZM output 
After
duobinary
encoder 
0
Optical power
of MZM output 
Tb
2Tb
3Tb
4Tb
Pout(t)
Ain
–Ain
Figure 4.36
Electrical/optical waveforms at various stages of optical duobinary signal generation.

Optical Modulators and Modulation Schemes
171
NRZ data
Differentially
encoded data 
AMI signal
b(t)
1
0
0
1
1
0
0
0
1
t
t
t
m(t)
b'(t)
–1
+1
–1
–2
+1
+2
Figure 4.37
Waveforms of the input signal b(t), the differentially encoded signal b
′(t), and the AMI signal m(t).
If the voltage levels of the previous bit and the current bit of b′(t) are −1 V and 1 V, respectively (corresponding
to the bit ‘1’ of bn), delay and subtraction leads to +2 V. If the voltage levels of the previous bit and the
current bit are +1 V and −1 V, respectively, the delay-and-subtract circuit gives −2 V. Since a bit ‘1’ of bn
corresponds to a voltage change from −1 V to 1 V (or 1 V to −1 V) and the next ‘1’ of bn corresponds to a
voltage change from 1 V to −1 V (or −1 V to 1 V), this ensures that alternate marks (‘1’s) are inverted. If the
voltage levels of the adjacent bits are both +1 V (or −1 V) corresponding to ‘0’ of the original bit sequence bn,
the delay-and-subtract circuit output is 0 V. Fig. 4.38 shows an optical realization of an AMI using MZMs.
Biasing of a MZM is the same as in the duobinary case. Alternatively, an AMI can be generated using a
delay-and-subtract operation in an optical domain [8]. This can be achieved using a MZ delay interferometer
(DI), as shown in Fig. 4.39. A phase shift of 𝜋is introduced to one of the arms of the DI and a delay 𝜏is also
introduced. Therefore, the output optical field envelope can be written as (see Section 4.6.2.2)
uout(t) = 1
2[uin(t) −uin(t −𝜏)].
(4.104)
Polar NRZ data
Delay Tb
b'(t)
MZM
Differential coding
b(t)
Laser
+
Σ
–
Delay-and-subtract filter
m(t) = b'(t) – b'(t – TB)
Aout
Delay
Tb
Figure 4.38
Generation of optical AMI signal.

172
Fiber Optic Communications
uin(t)
Phase
shift
π 
Delay
τ 
uin(t)
2
uin(t)
2
−uin(t)
2
−uin(t − τ)
2
[uin(t) − uin(t − τ)]
2
1
uout (t) = 
Figure 4.39
Mach–Zehner DI to perform delay-and-subtract operation.
Polar NRZ data
Delay Tb 
MZM
Differential coding
Laser
π
τ
DI
AMI signal
Figure 4.40
AMI signal generation using a Mach–Zehnder DI.
Thus, the DI acts as a delay-and-subtract circuit. When 𝜏= Tb, the AMI signals generated using the schemes
shown in Figs. 4.38 and 4.40 are similar, and both techniques generate a NRZ-AMI signal in an optical
domain. By varying 𝜏, the RZ-AMI signals of different duty cycles can be generated [8]. Therefore, there is
no need for an active RZ pulse-carving modulator. This is clearly an advantage of the optical realization of the
delay-and-subtract operation. Although AMIs are used in non-optical communication systems to enable the
use of a.c. coupling during transmission, this format is beneficial in optical communication systems as well.
Because of the phase transitions, intrachannel four-wave mixing (IFWM)(see Chapter 10) can be suppressed
using a RZ-AMI signal [11].
4.9
Multi-Level Signaling∗
So far we have assumed that the message signal is binary data with two levels represented by the symbols ‘0’
and ‘1’. Instead, the message signal could consist of multiple levels. For example, we could have four levels
with voltages −3 V, −1 V, 1 V, and 3 V. These four levels can be represented by four symbols, ‘00’, ‘01’,
‘10’, and ‘11’. We may do the following mapping: −3 V →‘00’, −1 V →‘01’, 1 V →‘11’, and 3 V →‘10’.
These four symbols could correspond not only to four amplitude levels (4-ASK), but also to four phase levels
(4-PSK), or a combination of amplitude and phase levels (4-QAM). In this section, we discuss the following
multi-level formats: (i) M-ASK, (ii) M-PSK, and (iii) quadrature amplitude modulation (QAM).
4.9.1
M-ASK
Here M stands for the number of symbols or levels. The simplest example we could think of is the switch of a
flash light with two levels of brightness and an off button. In total, there are three power (or amplitude) levels
corresponding to 3-ASK.

Optical Modulators and Modulation Schemes
173
When M = 4, the four symbols can be represented by four amplitude levels ±3A, ±A. The smallest sep-
aration between any two amplitude levels is 2A, to ensure equal noise immunity. Fig. 4.41 shows the four
symbols of 4-ASK. When M = 8, we need three binary digits or bits to represent eight symbols: ‘000’, ‘001’,
… , ‘111’ and eight amplitude levels: ±7A, ±5A, ±3A, and ±A. The M-ASK signal in an interval 0 ≤t ≤Ts
may be written as
sj(t) = mj(t) cos (2𝜋fct),
(4.105)
where
mj(t) = ajp(t).
(4.106)
Here p(t) represents the pulse shape in a symbol interval and aj is a random variable that takes values [−(M −
1)A, −(M −3)A, … , −3A, −A, A, 3A, … , (M −1)A] with equal probability. Suppose the symbol interval is
Ts, corresponding to a symbol rate of Bs = 1∕Ts. M symbols convey information of log2M bits. For example,
when M = 8, we have three bits of information encoded in a single symbol interval, i.e., if we were to use
binary ASK (BASK), we would need three bit slots within a symbol interval to convey the same amount of
information. Therefore, if we transmit Bs symbols per second, it is equivalent to transmitting Bslog2 M bits/s,
B = Bslog2M,
(4.107)
where B is the bit rate of an equivalent binary ASK signal. Equivalently, the data rate is enhanced by a factor of
log2M compared with a binary ASK using the same symbol interval (= bit interval for BASK). For example,
if M = 4, we have log2M = 2 bits to represent all the four levels. Fig. 4.42(a) shows the waveform of a 4-ASK
signal at a symbol rate of 10 GSym/s or 10 GBaud, with each symbol chosen out of the symbol set shown in
Fig. 4.41. This is equivalent to transmitting a BASK signal at a bit rate of 20 Gb/s as shown in Fig. 4.42(b).
Note that the symbol interval in Fig. 4.42(b) is half of that in Fig. 4.42(a). Typically, the bandwidth required
to transmit a NRZ-BASK signal at a bit rate of B bits/s on a fiber channel is around 2B Hz. If we were to
transmit the same amount of information by NRZ-MASK, the symbol interval Ts is TBlog2M where TB is
the bit interval and the required bandwidth to transmit NRZ-MASK would be 2Bs = 2B∕log2M. Thus, the
bandwidth reduces by a factor of log2M. This reduction in bandwidth comes at the price of reduced power
efficiency, i.e., the average transmitter power required to achieve the given performance increases as M2 (see
Example 4.3). This can be explained as follows: the symbol error rate is determined by the separation between
‘01’
‘11’
‘10’
‘00’
A
A
3A
3A
–3A
–3A
–A
–A
0
2A
Field envelope
Carrier
(a)
(b)
Figure 4.41
(a) Amplitude levels of 4-ASK. (b) Constellation diagram.

174
Fiber Optic Communications
10
00
11
t
t
1
1
0
1
0 0
1
A
(a)
(b)
0
1
0
1
0 0
1
10
10
10
01
A
3A
−3A
−A
Tb
Ts
Figure 4.42
4-ASK and BASK signal for 20 Gb/s transmission: (a) 4-ASK with Ts = 100 ps, (b) BASK with Tb = 50 ps.
constellation points of Fig. 4.41(b). The larger the separation, the less is the chance of mistaking one symbol
for another. If we fix the average power and the information rate of MASK to be the same as those of BASK,
then the constellation points come closer and, therefore, the error rate increases. Equivalently, for a given error
rate, the separation between constellation points for MASK should be the same as for BASK and then the
spread of the amplitude levels would range from −(M + 1)A to (M + 1)A, whereas the corresponding range
is from −A to A for BASK. Therefore, the average power of MASK (M > 2) increases relative to BASK. The
trade-off between bandwidth and power efficiency is a common feature of all multi-level modulation formats.
4.9.2
M-PSK
When M = 2, we have a binary PSK or BPSK signal with two phase levels 0 or 𝜋, as shown in Fig. 4.43. See
also Fig. 4.44. When M = 4, the signal is called quadriphase-shift keying (QPSK). The phase of the carrier
takes on one of four values, 0, 𝜋∕2, 𝜋, and 3𝜋∕2, as shown in Fig. 4.45. See also Fig. 4.46. In general, the
A
‘1’
‘0’
0
π
π/2
3π/2
3π/2
π/2
0
π
t = 0
t = 0
t
t
A
–A
–A
Acos(2πfct)
–Acos(2πfct)
Figure 4.43
BPSK symbols ‘1’ and ‘0’.

Optical Modulators and Modulation Schemes
175
π
0
π/2
3π/2
Figure 4.44
BPSK constellation diagram.
A
–A
‘00’
‘01’
‘11’
‘10’
0
π
t
0
A
–A
0
A
–A
0
A
–A
0
t
t
t
π/2
3π/2
Figure 4.45
QPSK symbols.
10
11
01
00
Figure 4.46
Constellation diagram of QPSK.
M-PSK signal in an interval kTs ≤t ≤(k + 1)Ts may be written as
sj(t) = Ap(t) cos [2𝜋fct + kpmj(t) + 𝜃0],
(4.108)
where
kpmj(t) = 2𝜋(j −1)
M
, j = 1, 2, … , M
(4.109)
and 𝜃0 is a phase constant.

176
Fiber Optic Communications
10
00
01
11
t
t
1
1
0
0
1
0
0
1
Phase (rad)
Phase (rad)
3π
2
2
(a)
(b)
Ts
Tb
π
π
π
Figure 4.47
Time diagrams for (a) QPSK and (b) BPSK signals. Ts = 100 ps and Tb = 50 ps.
Fig. 4.47(a) shows the waveform of QPSK at a symbol rate of 10 GSym/s. This is equivalent to transmitting
a BPSK signal at a bit rate of 20 Gb/s, as shown in Fig. 4.47(b). In a symbol interval kTs ≤t ≤(k + 1)Ts, any
one of the messages mj(t) is sent. Using the formula cos (A + B) = cos A cos B −sin A sin B, Eq. (4.108) can
be rewritten as
sj(t) = A[mI(t) cos (2𝜋fct) + mQ(t) sin (2𝜋fct)]
(4.110)
where
mI(t) = p(t) cos [kpmj(t) + 𝜃0],
mQ(t) = −p(t) sin [kpmj(t) + 𝜃0].
(4.111)
mI(t) and mQ(t) can be imagined as two message signals modulating an in-phase carrier, cos (2𝜋fct) and a
quadrature carrier, sin (2𝜋fct), respectively. See Table 4.4 and Fig. 4.48. mI(t) and mQ(t) are called the in-phase
and quadrature components of the message signal, respectively. mI(t) cos (2𝜋fct + 𝜃0) and mQ(t) sin (2𝜋fct +
𝜃0) can be thought of as two amplitude-modulated waves on orthogonal carriers with a constraint that [m2
I (t) +
m2
Q(t)]∕p2(t) = 1. For example, when M = 4, let us choose 𝜃0 = 𝜋∕4. If kpm(t) = 0, mI(t) = p(t)∕
√
(2) and
mQ(t) = −p(t)∕
√
(2). If kpm(t) = 𝜋/2, mI(t) = −p(t)∕
√
(2) and mQ(t) = −p(t)∕
√
(2). For all the symbols of
QPSK, it can be verified that mI(t) = ±p(t)∕
√
(2) and mQ(t) = ±p(t)∕
√
(2) (see Table 4.4). Thus, a QPSK
signal can be generated using two polar NRZ data streams. The optical realization of QPSK can be achieved
using a phase modulator, as shown in Fig. 4.49. However, a multi-level driving signal mj(t) is required, which
degrades the system performance due to higher eye spreading when overlapping binary electrical signals with
multi-level signals [12]. An alternative is to use the optical IQ modulator shown in Fig. 4.50, which is the
optical analog of the scheme shown in Fig. 4.48 [12–14]. The output of the laser passes through the pulse
carver and its output is split into two equal parts using a 3-dB coupler. The upper arm is known as the in-phase
(I) arm and the lower arm is known as the quadrature (Q) arm. In the I-arm, the optical signal amplitude is
modulated using a MZM. In the Q-arm, the optical signal is first phase-shifted by −𝜋∕2 and then its amplitude
is modulated using a MZM. The d.c. bias of the MZMs is the same as used for a BPSK (see Section 4.7.2 and
Table 4.4
In-phase and quadrature amplitudes.
kpm(t)
0
𝜋∕2
𝜋
3𝜋∕2
mI(t)
p(t)
1∕
√
2
−1∕
√
2
−1∕
√
2
1∕
√
2
mQ(t)
p(t)
−1∕
√
2
−1∕
√
2
1∕
√
2
1∕
√
2

Optical Modulators and Modulation Schemes
177
X
X
–π/2
~
+
QPSK signal
A
–A
A
–A
mI(t)cos(2πfct)
mI(t)cos(2π fct) + mQ(t)sin(2π fct)
NRZ data, mI(t)
NRZ data, mQ(t)
cos(2πfct)
sin(2πfct)
mQ(t)sin(2π fct)
Figure 4.48
Generation of QPSK signal using two BPSK signals.
Laser
Acos(2πfct)
Electrical message signal
mj(t)
Pulse
carver 
Optical
phase modulator 
Ap(t)cos(2πfct)
Ap(t)cos[2π fct + kpmj(t)]
Figure 4.49
Optical QPSK generation using a phase modulator.
Laser
Acos(2π fct)
QPSK signal
Pulse carver
Ap(t)cos(2π fct)
MZM
MZM
–π/2
mQ(t)
3-dB coupler
3-dB coupler
Ap(t)cos(2π fct)/ 2
Ap(t)cos(2π fct)/ 2
+1
–1
mI(t)
+1
–1
1 0 1 1 1
0 0 0 1 0
t
t
2
Ap(t)mQ(t)sin(2πfct)/
2
Ap(t)mI(t)cos(2πfct)/
Optical IQ modulator
I-arm
Q-arm
Figure 4.50
Optical QPSK generation using two MZMs.

178
Fiber Optic Communications
QPSK signal
PM
NRZ data stream
8-PSK signal
Figure 4.51
Generation of an 8-PSK signal.
Fig. 4.22). The optical signal is recombined using a 3-dB coupler to obtain the QPSK signal. The advantage
of this scheme is that both mI(t) and mQ(t) are binary NRZ data streams. An 8-PSK signal can be obtained
from a QPSK signal after passing through a phase modulator which changes the phase of the QPSK signal
by 𝜋∕4 or 0 depending on whether the electrical driving signal is V𝜋∕4 or zero, respectively (see Fig. 4.51).
This is because an 8-PSK signal is nothing but a phase-modulated QPSK signal. To see that, let us rewrite
Eq. (4.108) in the complex notation
s8-PSK
j
(t) = Ap(t) exp
{
i
[
2𝜋fct + (j −1)2𝜋
8
]
+ 𝜃0
}
, j = 1, 2, … , 8
= Ap(t) exp
{
i
[
2𝜋fct + (l −1)2𝜋
4
+ k𝜋
4
]
+ 𝜃0
}
,
l = 1, 2, 3, 4
k = 0, 1
j = (2l −1) + k
= Ap(t)sQPSK
l
(t) exp (ik𝜋∕4).
(4.112)
4.9.3
Quadrature Amplitude Modulation
In M-ary ASK, the amplitude of the carrier is modulated in accordance with a message signal with the con-
straint that frequency fc and 𝜃of Eq. (4.21) are constant. This constraint leads to the straight-line constellation
of Fig. 4.41. In M-ary PSK, the phase of the carrier is modulated in accordance with a message signal with
the constraint that amplitude A and frequency fc of Eq. (4.21) are constant, which leads to the circular con-
stellation of Fig. 4.46. However, if we let the amplitude and phase of the carrier vary simultaneously, we get
a modulation scheme known as an M-ary quadrature amplitude modulation (QAM) or M-ary amplitude and
phase-shift keying (APSK). The signal waveform in the interval 0 ≤t ≤Ts may be expressed as
sj(t) = Ajp(t) cos (2𝜋fct + 𝜃j) j = 1, 2, … , M
= mI(t) cos (2𝜋fct) + mQ(t) sin (2𝜋fct),
(4.113)
where
mI(t) = p(t)Aj cos (𝜃j),
mQ(t) = −p(t)Aj sin (𝜃j).
(4.114)
The amplitude of the in-phase carrier cos (2𝜋fct) is modulated by mI(t) and that of the quadrature carrier
sin (2𝜋fct) is modulated by mQ(t). Hence, this scheme is known as quadrature amplitude modulation. This is
similar to QPSK, except that the amplitude Aj (=
√
m2
I + m2
Q∕p(t)) is constant in QPSK whereas it may be

Optical Modulators and Modulation Schemes
179
A1
A2
M = 4
(a)
M = 4
(b)
A3 = A1
A4 = A2
Figure 4.52
4-QAM constellations: (a) circular, (b) rectangular.
(b)
M = 16
(a)
M = 16
Figure 4.53
16-QAM constellations: (a) circular, (b) rectangular.
changing in QAM. For example, when M = 4, one possible way of realizing QAM is by choosing A1 = A3,
A2 = A4, 𝜃1 = 0, 𝜃2 = 𝜋∕2, 𝜃3 = 𝜋, and 𝜃4 = 3𝜋∕2. The corresponding constellation is shown in Fig. 4.52(a).
The other possible way is to choose the four corners of a rectangle, A1 = A2 = A3 = A4, and 𝜃1 = 0, 𝜃2 =
𝜋∕2, 𝜃3 = 𝜋, and 𝜃4 = 3𝜋∕2 (Fig. 4.52(b)). This scheme is the same as QPSK. Fig. 4.53 shows 16-QAM
constellations.
In complex notation, assuming p(t) to be real, the QAM signal waveform may be written as
sj(t) = p(t)̃Aj exp [i(2𝜋fct + 𝜃m)]
=
p(t)̃Aj
⏟⏟⏟
field envelope
exp (i2𝜋fct)
⏟⏞⏞⏞⏟⏞⏞⏞⏟
optical carrier
,
(4.115)
where ̃Aj is the complex amplitude which is related to the real amplitude Aj by
̃Aj = Aj exp (i𝜃m).
(4.116)
Thus, the simultaneous amplitude and phase modulation of the carrier are described by the complex variable
̃Aj. Fig. 4.54 shows a possible realization of star 16-QAM [12, 13]. An 8-PSK signal can be generated using
a QPSK modulator and a phase modulator (see Section 4.9.2). The 8-PSK signal passes through the MZM,

180
Fiber Optic Communications
Laser
m1
QPSK
modulator 
QPSK 
PM
NRZ data 
m2
8-PSK 
MZM
Unipolar NRZ data 
m3
A2
A1
16 QAM
Figure 4.54
Schematic of 16-QAM generation using a QPSK modulator.
Laser
QAM signal 
Pulse carver
MZM
MZM
t
Optical IQ modulator
4-ASK signal
4-ASK signal
Acos(2π fct)
Ap(t)cos(2π fct)
3-dB coupler
3-dB coupler
Ap(t)cos(2π fct)/ 2
Ap(t)cos(2π fct)/ 2
I-arm
Q-arm
–π/2
mI(t)
mQ(t)
Figure 4.55
16-QAM generation using an optical IQ modulator.
which acts as an amplitude modulator. The bias conditions for a MZM to act as an amplitude modulator are
discussed in Section 4.6.2.2. When the message signal m3 = A1 and A2 (> A1) volts, we obtain the inner and
outer circles of the constellation, respectively.
A QAM signal may be interpreted as a signal obtained by simultaneous amplitude modulation of in-phase
and quadrature carriers (see Eq. (4.113)). This suggests that a QAM signal can be generated using an optical
IQ modulator as shown in Fig. 4.55 [15]. To obtain a square 16-QAM signal, 4-ASK electrical signals are
used to drive the optical IQ modulator, as discussed in Section 4.9.2.
Example 4.3 A MASK signal transmitted over the fiber channel
The driving voltage to the MZM is adjusted such that the optical field amplitudes are equally spaced. The
MZM output in a symbol slot 0 < t < Ts is
Aout =
√
P0(2m + 1),
(4.117)

Optical Modulators and Modulation Schemes
181
where m is an integer, m ∈[−M∕2, M∕2 −1], and M is even. Assume that the occurrence of any of these
symbols is equally probable. Find the mean optical power.
Solution:
Since the M symbols could occur with equal probability, the mean power is
̄Pout = P0
M
M∕2−1
∑
m=−M∕2
(2m + 1)2.
(4.118)
Let n = m + M∕2 + 1. Now, Eq. (4.118) becomes
̄Pout = P0
M
M
∑
n=1
[2n −(M + 1)]2
= P0
M
M
∑
n=1
[4n2 + (M + 1)2 −4n(M + 1)].
(4.119)
Using the following relations,
M
∑
n=1
n = M(M + 1)
2
,
M
∑
n=1
n2 = M(M + 1)(2M + 1)
6
.
Eq. (4.119) is simplified as
̄Pout = P0
M
[4M(M + 1)(2M + 1)
6
+ M(M + 1)2 −4M(M + 1)2
2
]
= P0(M2 −1)
3
.
(4.120)
Note that the mean power scales as M2 for M ≫1.
Example 4.4
Repeat Example 4.3 for an M-ary rectangular QAM signal.
Solution:
Let X and Y be the number of levels of in-phase and quadrature components with M = XY. The QAM signal
in a symbol interval 0 < t < Ts may be written as (see Eq. (4.113))
Aout(t) = mI(t) cos (2𝜋fct) + mQ(t) sin (2𝜋fct),
(4.121)

182
Fiber Optic Communications
where
mI(t) =
√
P0(2x + 1) x ∈[−X∕2, X∕2 −1],
(4.122)
mQ(t) =
√
P0(2y + 1) y ∈[−Y∕2, Y∕2 −1].
(4.123)
Here, x and y are integers. In complex notation, Eq. (4.121) can be written as
Aout =
√
m2
I + m2
Q ei(2𝜋fct+𝜃),
(4.124)
where
𝜃= tan−1
[mQ
mI
]
,
(4.125)
Pout = |Aout|2 = m2
I + m2
Q,
(4.126)
̄Pout = 1
XY
X∕2−1
∑
x=−X∕2
Y∕2−1
∑
y=−Y∕2
m2
I + m2
Q
= P0
XY
[
Y
X∕2−1
∑
x=−X∕2
(2x + 1)2 + X
Y∕2−1
∑
y=−Y∕2
(2y + 1)2
]
= P0[(X2 −1) + (Y2 −1)]
3
.
(4.127)
4.10
Additional Examples
Example 4.5
Find the power spectral density of the unipolar signals.
Solution:
From Eq. (4.9), we have
𝜌m(f) = A2
0|̃p(f)|2 lim
L→∞
1
(2L + 1)Tb
L
∑
l=−L
L
∑
k=−L
< alak > ei2𝜋f(l−k)Tb.
(4.128)
For unipolar signals, ak takes values 1 or 0 with equal probability. Let us write
ak = bk + 1
2,
(4.129)
where bk is a random variable that takes values ±1∕2 with equal probability similar to the random variable
associated with the polar signal. Using Eq. (4.129), Eq. (4.128) can be expanded as
𝜌m(f) = A2
0|̃p(f)|2 lim
L→∞
1
(2L + 1)Tb
L
∑
l=−L
L
∑
k=−L
[
⟨bkbl⟩+ 1
2⟨bk⟩+ 1
2⟨bl⟩+ 1
4
]
exp (i2𝜋f(l −k)Tb).
(4.130)

Optical Modulators and Modulation Schemes
183
Since
⟨bkbl⟩= 1
4 if
k = l
= 0 otherwise
(4.131)
and
⟨bk⟩= 0,
(4.132)
Eq. (4.130) reduces to
𝜌m(f) = A2
0|̃p(f)|2
{
1
4Tb
+ lim
L→∞
1
4(2L + 1)Tb
L
∑
l=−L
L
∑
k=−L
ei2𝜋f(l−k)Tb
}
.
(4.133)
Using the following identities:
lim
L→∞
L
∑
l=−L
ei2𝜋flTb = lim
L→∞
1
Tb
L
∑
l=−L
𝛿(f −l
Tb
),
lim
L→∞
1
2L + 1
L
∑
k=−L
e−i2𝜋fkTb = 1,
(4.134)
Eq. (4.133) reduces to
𝜌m(f) =
A2
0|̃p(f)|2
4Tb
{
1 + 1
Tb
∞
∑
l=−∞
𝛿(f −l
Tb
)
}
.
(4.135)
Example 4.6
A raised-cosine pulse is defined as
p(t) = 1
2
[
1 + cos
(
𝜋t
TB
)]
rect
(
t
2TB
)
.
(4.136)
In a polar signaling scheme, raised-cosine pulses are used. Find the PSD.
Solution:
First let us calculate the Fourier transform of p(t).

[
rect
(
t
2Tb
)]
= 2Tbsinc (2fTb),
(4.137)

[
x(t) cos
(
𝜋t
Tb
)]
= 
[exp (i2𝜋f0t) + exp (−i2𝜋f0t)
2
x(t)
]
= ̃x(f −f0) + ̃x(f + f0)
2
,
(4.138)

184
Fiber Optic Communications
where f0 = 1∕2Tb. In Eq. (4.138), we have used the fact that a phase shift in time domain leads to a frequency
shift in frequency domain. Using Eqs. (4.137) and (4.138), we find

[
cos
(
𝜋t
Tb
)
rect
(
t
2Tb
)]
= Tbsinc
[
2Tb
(
f −
1
2Tb
)]
+ sinc
[
2Tb
(
f +
1
2Tb
)]
= −Tb sin (2𝜋Tbf)
[
1
𝜋(2Tbf −1) +
1
𝜋(2Tbf + 1)
]
= −Tb
𝜋
sin (2𝜋Tbf)4Tbf
4T2
bf 2 −1
,
(4.139)
where we have used
sinc
[
2Tb
(
f ±
1
2Tb
)]
= sin (2𝜋Tbf ± 𝜋)
𝜋(2Tbf ± 1)
.
(4.140)
The Fourier transform of p(t) is
̃p(f) = 1
2
[
2Tb sin (2𝜋fTb)
2𝜋fTb
−Tb sin (2𝜋Tbf)4Tbf
𝜋(4T2
bf 2 −1)
]
= Tbsinc (2fTb)
(1 −4T2
bf 2)
.
(4.141)
The PSD is given by Eq. (4.13) as
𝜌m(f) =
A2
0|̃p(f)|2
Tb
=
A2
0Tbsinc2(2fTb)
(1 −4T2
bf 2)2
.
(4.142)
Example 4.7
Show that the Fourier transform of the duobinary pulse
p(t) =
sin (𝜋Bt)
𝜋Bt(1 −Bt)
(4.143)
is
̃p(f) = 2
B cos
(𝜋f
B
)
rect
( f
B
)
exp (i𝜋f∕B).
(4.144)
Solution:
Note that
1
t(1 −Bt) = 1
t −
1
t −Tb
.

Optical Modulators and Modulation Schemes
185
Eq. (4.143) can be written as
p(t) = sin (𝜋Bt)
𝜋Bt
−sin (𝜋Bt)
𝜋B(t −Tb).
(4.145)
The first term on the right-hand side of Eq. (4.145) is in the form of a sinc function. To bring the second term
into sinc form, consider
sin [𝜋B(t −Tb)] = sin (𝜋Bt −𝜋) = −sin (𝜋Bt).
(4.146)
Using Eq. (4.146) in Eq. (4.145), we find
p(t) = sin (𝜋Bt)
𝜋Bt
−sin (𝜋Bt)
𝜋B(t −Tb) = sinc (Bt) + sinc [B(t −Tb)].
(4.147)
Using the following identities:
[sinc (Bt)] = 1
Brect (f∕B),
[x(t −Tb)] = ̃x(f) exp (i2𝜋fTb),
the Fourier transform of Eq. (4.147) is
̃p(f) = 1
Brect (f∕B)[1 + exp (i2𝜋fTb)]
= 2 exp (i𝜋fTb)rect (f∕B)
B
[exp (−i𝜋fTb) + exp (i𝜋fTb)]
2
= 2
B exp (i𝜋f∕B)rect (f∕B) cos (𝜋f∕B).
(4.148)
Exercises
4.1
Explain the differences between NRZ and RZ formats. Which of these formats has a wider spectrum?
4.2
Discuss the following modulation schemes: (i) ASK, (ii) PSK, and (iii) FSK.
4.3
The pulse shape of a RZ signal is described by
p(t) = exp (−t2∕2T2
0).
Find the PSD assuming (a) polar and (b) unipolar signaling.
4.4
Derive an expression for the PSD of a bipolar signal such as AMI. Assume rectangular pulses with
100% duty cycle.
4.5
Discuss the differences between binary PSK and DPSK. Does DPSK require a reference laser (local
oscillator) at the receiver?
4.6
Explain the Pockels effect. Show that the phase change is proportional to the applied voltage in an
electro-optic crystal.

186
Fiber Optic Communications
4.7
An electro-optic modulator operating at 1550 nm has the following parameters:
Thickness d = 8μm
Index n0 = 2.2
Pockel coefficient r33 = 30 pm/V
It is desired that the half-wave voltage V𝜋is less than 2 V. Find the lower limit on the length L.
(Ans: 1.94 cm.)
4.8
Explain how an electroabsorption modulator can be used as an amplitude modulator.
4.9
The d.c. extinction ratio of a MZM is 13 dB. Calculate the power-splitting ratio 𝛼2
1 ∶𝛼2
2. Assume that
𝛼2
1 + 𝛼2
2 = 1.
(Ans: 0.71 : 0.29.)
4.10
The input power to a dual-drive MZM is 0 dBm. The MZM is used to generate a NRZ-OOK signal.
Find the drive voltage V and the bias voltage Vbias. If the d.c. extinction ratio is 10 dB, calculate the
optical power levels corresponding to bit ‘1’ and ‘0’. Assume V𝜋= 4 V.
(Ans: V = 1 V, Vbias = 2 V, power of bit ‘1’ = 1 mW, power of bit ‘0’ = 0.1 mW.)
4.11
Consider the input data sequence
{bn
′} = [110111011].
This data passes through the differential encoder and add-and-delay filter shown in Fig. 4.28. Deter-
mine the duobinary data voltage sequence mn at instants nTb (=m(nTb)). To proceed with differential
encoding, add an extra bit to the encoder output. State the decision rule.
(Ans: {mn} = [0 0 −2 0 0 0 2 0 0] V.)
4.12
Repeat Exercise 4.11 for the case of AMI generation as shown in Fig. 4.38. State the decision rule.
(Ans: {mn} = [2 −2 0 2 −2 2 0 −2 2].)
4.13
Explain how the correlative coding combined with differential coding simplifies the decision rule at
the receiver.
4.14
The 4-ASK signal is transmitted over a fiber channel with a mean power of 0 dBm. Rectangular pulses
with 50% duty cycle are used in each symbol slot. Sketch the waveform of the 4-ASK signal for a
sequence {3, 1, 3, −1, −1, 1} showing the peak powers of each symbol. Assume that the optical field
amplitudes are equally spaced.
4.15
Repeat Exercise 4.14 for a square 16-QAM signal.
Further Reading
G.P. Agrawal, Lightwave Technology. John Wiley & Sons, New York, 2005.
S. Haykin and M. Moher, Communication Systems, 5th edn. John Wiley & Sons, New York, 2009.

Optical Modulators and Modulation Schemes
187
D.P. Lathi and Z. Ding, Modern Digital and Analog Communication Systems, 4th edn. Oxford University Press, Oxford,
2009.
S. Haykin and M. Moher, Introduction to Analog and Digital Communications, 2nd edn. John Wiley & Sons, New York,
2007.
References
[1] D.P. Lathi and Z. Ding, Modern Digital and Analog Communication Systems, 4th edn. Oxford University Press,
Oxford, 2009.
[2] I. Tomkos et al., IEEE J. Spec. Top. Quant. Elect., vol. 7, p. 439, 2001.
[3] A. Yariv and P. Yeh, Photonics, 6th edn. Oxford University Press, Oxford, 2007, chapter 9.
[4] B.E.A. Saleh and M.C. Teich, Fundamentals of Photonics. John Wiley & Sons, Hoboken, NJ, 2007.
[5] S. Walklin and J. Conradi, IEEE Photon. Technol. Lett., vol. 9, p. 1400, 1998.
[6] J. Conradi, “Bandwidth-efficient modulation formats for digital fiber transmission systems.” I. Kaminow and T. Li
(eds.), Optical Fiber Telecommunications IV B Academic Press, San Diego, 2002.
[7] S. Haykin and M. Moher, Communication Systems, 5th edn. John Wiley & Sons, New York, 2009.
[8] P.J. Winzer and R.-J. Essiambre, Proc. IEEE, vol. 94, p. 952, 2006.
[9] A.H. Gnauck and P.J. Winzer, J. Lightwave Technol., vol. 23, p. 115, 2005.
[10] P. Kabal and S. Pasupathy, IEEE Trans. Commun., vol. COM-23, p. 921, 1975.
[11] A.V. Kanaev, G.G. Luther, V. Kovanis, S.R. Bickham, and J. Conradi, J. Lightwave Technol., vol. 21, p. 1486, 2003.
[12] M. Seimetz, M. Noelle, and E. Patzak, J. Lightwave Technol., vol. 25, p. 1515, 2007.
[13] M. Seimetz. In S. Kumar (ed.), Impact of nonlinearities on Fiber-Optic communications. Springer-Verlag, Berlin,
2011.
[14] K.P. Ho and H.-W. Cuei, J Lightwave Technol., vol. 23, p. 764, 2005.
[15] P.J. Winzer, A.H. Gnauck, C.R. Doerr, M. Magarini, and L.L. Buhl, J. Lightwave Technol., vol. 28, p. 547, 2010.


5
Optical Receivers
5.1
Introduction
In the past few decades, there have been tremendous advances in optoelectronic integrated circuits (OEICs),
primarily because of their widespread use in optical communication systems. Among OEICs, some of the
key drivers have been high performance, low cost, and small size of photoreceivers. And in photoreceivers
and optical receivers, the photodetector and preamplifiers are critical components. The photodetector’s
function is to convert light (photons) or radiant energy into charge carriers, electrons and holes, which can
then be processed, stored, or transmitted again [1]. Further, a monolithically integrated photoreceiver has
several advantages–low parasitics, compact size, and low cost. To date, various designs and structures of
photodetectors, transistors, and integrated circuits have been used to produce high-performance integrated
photoreceivers. In the design of integrated photoreceivers, various devices and circuit parameters are
involved. To obtain the best possible photoreceiver performance, the parameters of both the photodetector
and the preamplifier should be optimized. Therefore, we concentrate on describing some important pho-
todetector structures and optical receivers. An example of a typical optical detection system is shown in
Fig. 5.1, [1–4]. In an optical communication system, the photodetector can be configured either as a direct
or incoherent detector, or as a coherent detector.
In direct or incoherent detection, the “direct” detector converts the incident radiation into an electrical
signal (sometimes called the photo-signal) that is proportional to the power of the incident light. There is
no phase or frequency information and the photo-signal is then processed electronically using a low-noise
preamplifier followed by signal processing circuits. The preamplifier should have very low noise and wide
enough bandwidth to accurately reproduce the temporal characteristics of the input signal, which may be a
10 or 40 Gb/s pulse stream. Minimization of noise in an optical direct detection system is a critical issue. In
particular, the various sources of noise from the background, the photodetector itself, biasing resistors, and
other additional noise sources such as the signal processing circuits must be minimized if the optical detection
system is to have an acceptable signal-to-noise ratio and low bit-error rates for a given input signal power.
A coherent detector, in contrast, is one in which the output electrical signal is related to the phase of the
input as well as the input power. The coherent detector requires a local oscillator whose phase is “locked”
onto the phase of the received signal or the phase difference between the two should be corrected dynamically
using digital signal processing (DSP). More details on these two types of photodetection system will be
presented later.
In this chapter, we will discuss various types of photodetector. We will describe photodetectors without
internal gain, such as pn photodiodes, pin photodetectors (pin-PDs), Schottky barrier photodetectors, and
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

190
Fiber Optic Communications
Incident
light
Optical
System
Detector
Pre-
amplifier
Signal
Processing
Integrated
Circuits
Figure 5.1
Simple schematic representation of a typical optical detector system.
metal–semiconductor–metal photodetectors (MSM-PDs). We will also describe photodetectors with internal
gain, like avalanche photodetectors (APDs), photoconductive photodetectors, and phototransistors. Then, we
will describe some advanced photodetectors, such as resonant cavity-enhanced photodetectors (RCE-PDs)
and waveguide photodetectors (WG-PDs). We describe noise sources in photodetection systems as well as
optical detection system architectures. Finally, it should be noted that some of the material in this chapter is
common to that in chapter 8 of Ref. [1], which was written by one of the authors.
5.2
Photodetector Performance Characteristics
A photodetector is a device in which an electron–hole pair is generated by photon absorption. In the case
of lasers, electrons and holes recombine (stimulated emission) and their energy difference appears in the
form of light. In other words, an electron and a hole annihilate each other to create the photon. In the case
of photodetectors, the reverse process takes place. A photon with energy hf > Eg, where Eg is the band-gap
energy (see Fig. 5.2), is annihilated to create an electron–hole pair.
The photon energy (Eph) decreases as the wavelength (𝜆) increases according to
Eph = hf = hc
𝜆,
(5.1)
where h = Planck’s constant (6.626 × 10−34 J ⋅s), c = speed of light, f = frequency of light (Hz), and 𝜆=
wavelength of light (m). If the energy Eph of the incident photon is greater than or equal to the band-gap energy
Eg, an electron makes a transition from the valence band to the conduction band, absorbing the incident
photon. Fig. 5.3 shows the dependence of the absorption coefficient on wavelength or photon energy. The
wavelength 𝜆co at which the absorption coefficient 𝛼becomes zero is called the cutoff wavelength. If the
incident wavelength 𝜆is greater than 𝜆co, the photodiode will not absorb light. This is because, if 𝜆> 𝜆co,
f < fco =
Eg
h .
(5.2)
Conduction
band
hf ≥ Eg
Vanlence
band
Eg
Figure 5.2
Photon absorption in a semiconductor.

Optical Receivers
191
106
105
104
103
102
10
0.2
3
Ge
GaAs
InP
Si
a–Si:H
In0.7Ga0.3As0.64P0.36
In0.53Ga0.47As
2
1
0.7
0.6
1.0
Wavelength (μm)
Photon energy (eV)
Absorption coefficient (cm−1)
1.4
1.8
Figure 5.3
Absorption coefficient 𝛼versus wavelength (bottom x-axis) or photon energy (top x-axis) for seven common
semiconductors.
Therefore, the energy of the photon (∝f) will not be adequate to excite an electron into the conduction band
if 𝜆> 𝜆co, and such a photon will not be absorbed. Eq. (5.2) may be rewritten as
𝜆co = hc
Eg
(5.3)
or
𝜆co =
1.2
Eg(eV)(μm).
(5.4)
In a silicon photodiode, 𝜆co ≃1.1 μm, so at 1.1 μm, the photon energy is just sufficient to transfer an electron
across the silicon energy band gap, thus creating an electron–hole pair, as shown in Fig. 5.4 [5]. As this cutoff
wavelength is approached, the probability of photon absorption decreases rapidly.
Table 5.1 shows some common semiconductors used as the active (absorption) materials in photodetectors
and their corresponding cutoff wavelengths. This results in a spectral range of response of the photodetector,
that is, the range of wavelengths over which the semiconductor material of the absorption layer of the pho-
todetector is sensitive to input radiation. Also indicated in Table 5.1 are which semiconductors are direct band
gap and which are indirect band gap.
In indirect band-gap semiconductors such as silicon or germanium, photon absorption requires the assis-
tance of a phonon so that both momentum and energy are conserved (see Section 3.7.3). In this case, the
absorption process can be sequential, with excited electron–hole pairs thermalizing within their respective
energy bands by releasing some energy/momentum through phonons. Therefore, compared with absorption
in a direct band gap where no phonons are involved, absorption in indirect band-gap semiconductors is less
efficient. Below, we discuss briefly the features of different semiconductor absorption layer materials that
have been used in commercial photodetectors.

192
Fiber Optic Communications
Ebandgap
hf
‒
+
Figure 5.4
Absorption of photons with energies equal to or greater than the band gap.
Table 5.1
Some common semiconductor materials used in photodetectors
with their Eg and 𝜆co values.
Semiconductor
Bandgap (eV) at 300 K
Cutoff wavelengths 𝜆co (μm)
Silicon
1.12 (indirect)
1.1
Germanium
0.66 (indirect)
1.85
GaAs
1.42 (direct)
0.87
GaSb
0.73 (direct)
1.7
AlAs
2.16 (direct)
0.57
InAs
0.36 (direct)
3.5
InP
1.35 (direct)
0.92
In0.14Ga0.86As
1.15 (direct)
1.08
In0.47Ga0.53As
0.75 (direct)
1.65
Silicon (Si)
• Indirect band-gap material with a small absorption coefficient.
• It has a high ratio of ionization coefficient of holes (𝛽i) to electrons (𝛼i). It is a good choice for avalanche
photodetectors, especially for local area networks (LANs) or short-wavelength applications.
• It is not suitable for the long-haul communications that typically operate at 1.3 or 1.55 μm.
Germanium (Ge)
• Indirect band-gap material with a small absorption coefficient.
• High 𝛽i∕𝛼i ratio. It can be used for avalanche photodetectors for both local area networks and long-distance
communications due to its long cutoff wavelength.
Gallium arsenide (GaAs)
• Direct band-gap material.
• Easy lattice matched to the InP substrate.

Optical Receivers
193
• It is not suitable for high-quality avalanche photodetectors since 𝛽i ≈𝛼i.
• It is not suited for long-distance applications due to its short cutoff wavelength.
Indium gallium arsenide (InGaAs)
• It can have a tunable band-gap energy depending on the ratio of Ga to In.
• It is a very good material for long-haul communications at 1.55 μm.
• It can be lattice matched to the InP substrate.
Indium gallium arsenide phosphide (InGaAsP)
• Suitable for both 1.3- and 1.55-μm applications.
• It can be lattice matched to the InP substrate.
In a semiconductor photodetector, there are two or three key processes depending on the type of photode-
tector.
(i) Absorption and generation. Here, the photons of appropriate energy (that is, the energy of the incom-
ing photon should be at least equal to the active semiconductor material’s band-gap energy) generate free
electron–hole pairs (ehps) through the photoconductive (or internal photoemission) effect when they are
absorbed in the photoresponsive (or active) region of the photodetector. Note that in the photoconductive
effect, the photogenerated carriers remain in the semiconductor material and they result in an increase in
its conductivity. This is in contrast to photoelectric emission, in which the photogenerated electrons escape
from the material and are then free to move outside the material under an applied electric field. Photoelectric
emission is used in photomultiplier tubes (PMTs).
(ii) Transport. The generated ehps drift under the influence of an applied electric field E. This results in a
current that flows in the circuit.
(iii) Amplification. In some photodetectors, when the electric field is sufficiently large, the photogenerated
carriers moving in the applied electric-field can gain sufficient energy to impact ionize. Upon impact
ionization, additional carriers are generated, creating more ehps. In this way, one photogenerated ehp can
result in many more ehps, leading to a photodetector with gain. In more detail, the gain of the photodetector
is defined as the ratio of the number of collected ehps to the number of primary photogenerated pairs. Gain
expresses the sensitivity of the photodetector at the operating wavelength. One popular photodetector with
gain is the avalanche photodiode.
5.2.1
Quantum Efficiency
In a semiconductor photodetector, when a photon of energy Eph ≥Eg is absorbed, an ehp is formed. Then,
a photocurrent is produced when the photon-generated ephs are separated in an applied electric field, with
electrons moving to the n-region and holes to the p-region (Fig. 5.5). However, the photons of appropriate
wavelength do not always generate ehps, nor are all ehps collected at the respective terminals. Therefore,
quantum efficiency QE (or 𝜂) is defined as the probability that a photon incident on the photodetector generates
an ehp (photocarrier) that contributes to the photodetector current and is given by
𝜂= number of photocarriers that contribute to the photocurrent
number of incident photons
.
(5.5)
Note that 0 < 𝜂≤1, that is, the maximum value of 𝜂in a photodetector without gain is 1 or 100%, which
means that each incident photon generates an ehp. The QE depends on the photon wavelength, type of semi-
conductor, and structure of the photodetector.

194
Fiber Optic Communications
The mean number of photons, Nph, in an optical wave of energy E and frequency f0 is
Nph = E
hf0
.
(5.6)
Therefore, the mean number of photons per unit time, or photon rate or photon flux, is given by
Nph
T
=
E
Thf0
= P
hf0
.
(5.7)
If the incident optical power on the photodetector is PI, the mean number of photons incident per unit time,
or photon incidence rate, is
Rincident = PI
hf0
.
(5.8)
Let the number of photocarriers generated be NPC. Not all the photocarriers contribute to the photocur-
rent, as some of them recombine before reaching the terminals of the photodetector. Let 𝜁be the fraction of
photocarriers that contribute to the photocurrent. The effective photocarrier generation rate may be written as
Rgen = 𝜁NPC
T
= IPC
q ,
(5.9)
where q is the electron charge. Using Eqs. (5.8) and (5.9), Eq. (5.5) may be rewritten as
𝜂= photocarrier generation rate
photon incidence rate
= IPC∕q
PI∕hf0
= IPC
PI
hc
q
1
𝜆0
.
(5.10)
From Eq. (5.10), it is noted that 𝜂is inversely proportional to wavelength 𝜆0. However, at short wavelengths,
𝜂decreases due to surface recombination because most of the light is absorbed very close to the surface.
For example, if the absorption coefficient 𝛼= 105 to 106 cm−1, then most of the light is absorbed within
the penetration distance 1∕𝛼= 0.1 to 0.01 μm. At these distances, close to the surface, the recombination
lifetime is very short, so the majority of photogenerated carriers recombine before they can be collected at
the terminals. This gives rise to the short-wavelength limit in the quantum efficiency of the photodetector.
However, with careful surface treatment, it may be possible to extend the short-wavelength limit to lower
values of wavelength 𝜆.
An example of a simple pn-homojunction photodetector operating in the photoconductive mode (third quad-
rant of the I–V characteristics) is shown in Figs. 5.5 and 5.6. In Fig. 5.6, the main absorption or photoactive
region is the depletion region, where the electric field sweeps the photogenerated electrons to the n-side and
holes to the p-side. This results in a photocurrent that is a drift current flowing in the reverse direction, that
is, from the n-side (cathode) to the p-side (anode), and this is the main contribution to the total photocurrent.
In addition, if ehps are generated within one diffusion length of the depletion region boundaries, they can
also contribute to the photocurrent. For example, the photogenerated minority carriers–holes on the n-side
and electrons on the p-side–can reach the depletion boundary by diffusion before recombination happens.
Once they reach the depletion region, they will be swept to the other side by the electric field. Thus, there is
also a diffusion current flowing in the reverse direction and contributing to the photocurrent.
In contrast, in the bulk p- or n-regions, although the generation of ehps occurs by photon absorption, they do
not contribute to the photocurrent. This is because there is negligible electric field to separate photogenerated

Optical Receivers
195
Diffusion
Diffusion
Active region
Depletion layer width
p
n
Drift
Drift
Neutral
n-region
Neutral
n-region
hf
Le
W
Lh
Figure 5.5
Photoexcitation and energy-band diagram of a pn photodiode and its symbol.
Antireflection
coating
High positive
bias
(a)
(b)
Depletion
region
Increasing light intensity
p-type
Electrons
Cathode contact
n+ region
p+ region
n-type
‒I
‒V
Figure 5.6
(a) Schematic representation of a simple photodiode with coating of reflectivity Rp. Note that only electrons
are shown moving toward the n-type semiconductor from the depletion. An equivalent number of holes move in the
opposite direction. (b) Typical reverse-bias characteristics where the photocurrent increases with light levels.
charges and hence they recombine randomly. For this pn-junction, if its cross-sectional area is A and the
incident photons generate G electron–hole pairs per second per unit volume (ehp/s/cm3), and if Le and Lh are
the respective minority diffusion lengths in the p- and n-regions, then the resulting photocurrent from the n-
to the p-region is
IPC = qAG(W + Le + Lh),
(5.11)
In practice, when computing 𝜂, we need to consider the details of the photodetector–the photoactive material
through its absorption coefficient and geometry as well as its surface. A schematic representation of a pn
photodiode with antireflection coating is shown in Fig. 5.6(a).
Let the optical power incident on one side of the pn-photodiode be PI. If Rp is the power reflection coefficient
at the air–semiconductor interface, the power transmitted at the interface is (1 −Rp)PI. The transmitted power

196
Fiber Optic Communications
through the photodiode is
Ptr = (1 −Rp)PI exp (−𝛼W),
(5.12)
where 𝛼is the absorption coefficient and W is the thickness of the depletion or active region of the photode-
tector. Therefore, the power absorbed in the photodiode is
Pabs = (1 −Rp)PI −Ptr = (1 −Rp)PI[1 −exp (−𝛼W)].
(5.13)
From Eq. (5.7), we find that the mean number of photons absorbed per unit time, or photon absorption
rate, is Pabs∕(hf0). If a photon is absorbed, an electron–hole pair is generated. Therefore, the number of
electron-hole pairs generated per unit time is
NPC
T
= Pabs
hf0
.
(5.14)
Using Eqs. (5.14) and (5.13) in Eq. (5.10), we find
𝜂= Pabs𝜁
PI
= (1 −Rp)𝜁[1 −exp (−𝛼W)].
(5.15)
The quantum efficiency is equal to a product of:
1. the power transmission coefficient at the air–semiconductor interface, 1 −Rp;
2. the photons absorbed in the active region of thickness W, given by the term 1 −exp (−𝛼W); and
3. the fraction of photocarriers 𝜁that reach the device terminal and contribute to the measured photocurrent.
The third term is usually the most difficult to determine as it depends on a number of factors, such as carrier
lifetimes, transit paths, surface properties, and the physical dimensions of the device.
Example 5.1
If the incident optical signal on a pn photodiode is at a wavelength of 550 nm, its absorption coefficient 𝛼=
104 cm−1, width of the active region W = 3 μm, and optical power 1 nW, calculate (a) the photon incidence
rate, (b) the photon absorption rate, and, (c) the quantum efficiency. Assume Rp = 0 and 𝜁= 0.9.
Solution:
(a) The energy of a photon is
Eph = hc
𝜆0
= 3.6 × 10−19 J.
The photon incidence rate is given by Eq. (5.8),
Rincident = PI
Eph
= 1 × 10−9 W
3.6 × 10−19 photons/s
= 2.77 × 109 photons/s.

Optical Receivers
197
(b) Using Eq. (5.13), with Rp = 0, the photon absorption rate is
Rabs = Rincident[1 −exp (−𝛼W)]
= 2.77 × 109 × [1 −exp (−104 × 3 × 10−4)] photons/s
= 2.63 × 109 photons/s.
(c) The quantum efficiency is given by Eq. (5.15),
𝜂= (1 −Rp)𝜁[1 −exp (−𝛼W)]
= 0.9 × (1 −exp (−104 × 3 × 10−4))
= 0.855.
5.2.2
Responsivity or Photoresponse
The responsivity or photoresponse (sometimes also called sensitivity) is a measure of the ability of the pho-
todetector to convert optical power into an electrical current or voltage. It depends on the wavelength of
the incident radiation, the type of photoresponsive (or active) material in the detector, and the structure and
operating conditions of the photodetector. It is defined as
R = IPC
PI
,
(5.16)
where IPC is the photocurrent and PI is the input optical power.
The photocurrent, in turn, depends on the absorption characteristics of the active (photoresponsive) material
on the photodetector and the quantum efficiency. In a photodetector, the intrinsic quantum efficiency is the
number of ehps generated per incident photon. In the ideal case, the quantum efficiency, which is a measure
of the number of photogenerated ehps per incident photon, is 1 or 100%, that is, each photon of appropriate
energy (equal to or greater than the energy band gap Eg of the active semiconductor material) generates one
ehp. For a pn photodiode, using Eq. (5.10) in Eq. (5.16), we find
R = 𝜂q
hf0
.
(5.17)
If we insert the numerical values for q, c, and h and with f0 = c∕𝜆0, Eq. (5.17) may be rewritten as
R(A/W) = 𝜂𝜆0(μm)
1.24 .
(5.18)
Note that the responsivity is proportional to both the quantum efficiency 𝜂and the free-space wavelength 𝜆0.
Fig. 5.7 shows schematically how the responsivity varies with wavelength. Notice that the responsivity curve
falls at both longer and shorter wavelengths for all three photoresponsive materials. The long-wavelength drop
is related to the energy band gap of the semiconductor. For example, for silicon, the energies of photons with
wavelengths approaching 1.1 μm are close to its indirect band-gap energy, beyond which silicon is transparent.
At the other extreme, at short wavelengths, as mentioned before, the quantum efficiency decreases rapidly due
to surface recombination effects as most of the light is absorbed close to the surface.

198
Fiber Optic Communications
Wavelength (μm)
0.7
1.0
Quantum
efficiencies
Si
Ge
InGaAs
0.8
0.6
0.4
0.2
90%
70%
50%
30%
10%
0
0.9
1.1
1.3
1.5
1.7
Responsivity (A/W)
Figure 5.7
Schematic representation of responsivity vs. wavelength for three common absorption materials and various
QEs from 10% to 90%.
Example 5.2
In a GaAs photodiode, if the quantum efficiency 𝜂= 0.9, band-gap energy Eg = 1.42 eV, and operating
(free-space) wavelength = 1.1 μm, calculate (a) the responsivity R and (b) the cutoff wavelength 𝜆co.
Solution:
(a) From Eq. (5.18), we have
R = 𝜂𝜆0(μm)
1.24
A/W
= 0.9 × 1.1
1.24
A/W = 0.9 A/W.
(b) The cutoff wavelength is given by Eq. (5.4),
𝜆co =
1.2
Eg(eV)μm
= 1.2
1.42 μm = 0.873 μm.

Optical Receivers
199
Example 5.3
Consider radiation of wavelength 𝜆= 700 nm incident on a photodetector whose measured responsivity is
0.4 A/W. What is its quantum efficiency at this wavelength? If the wavelength is reduced to 500 nm, what is
the new QE assuming that the responsivity is the same?
Solution:
Using Eq. (5.18), we get
0.4 A/W = 𝜂𝜆0(μm)
1.24
⇒𝜂= 0.4 × 1.24
0.7
= 0.7086(≃71%).
For 𝜆0 = 500 nm, the new QE is
𝜂= 0.7086 × 0.5
0.7 = 0.506(≃51%).
5.2.3
Photodetector Design Rules
As shown in Eq. (5.15), to improve the quantum efficiency, we should minimize light reflections (Rp term)
from the semiconductor surface or maximize the light transmitted into the semiconductor. For this, we can
use an antireflection coating to achieve better light transmittance. If the light is incident from air (refractive
index nair) into the semiconductor (refractive index nsc), then we should choose a material whose refractive
index nAR (refractive index of antireflection coating) is given by
nAR = √nairnsc.
(5.19)
If we use a quarter-wavelength antireflection coating of a transparent material with a refractive index nAR,
then the thickness tAR which causes minimum reflection of the incoming radiation is given by (see Section
6.6.3)
tAR =
𝜆
4nAR
,
(5.20)
where 𝜆is the free-space wavelength of the incident light onto the antireflection coating.
Example 5.4
If we use a silicon photodetector to detect red light at 680 nm, and refractive index of air (nair) = 1, refractive
index of silicon (nSi) = 3.6, determine the refractive index and thickness of the antireflection coating.
Solution:
The required antireflection coating should have a refractive index nAR = √nairnSi = 1.9 and its thickness
should be tAR = 𝜆∕(4nAR) = 680 nm∕(4 × 1.9) ≃90 nm. At 680 nm, the refractive index of silicon nitride
(Si3N4) ∼2 and that of silicon dioxide (SiO2) ∼1.5. Therefore, Si3N4 would be a good (though not perfect)

200
Fiber Optic Communications
choice for the antireflection coating. Note that if we do not use an antireflection coating, then the reflectivity
of silicon at 680 nm is ∼0.32. This means that ∼68% of the incident light is transmitted into the silicon
photoactive region. Note that the reflection coefficient Rp is computed using,
Rp =
(nSi(𝜆) −1
nSi(𝜆) + 1
)2
.
(5.21)
In addition to the antireflection coating, we also need to design a suitable absorption layer thickness (W)
or appropriately select the reverse-bias voltage of the photodiode to be large enough so that adequate light
is absorbed. However, as will be shown later, if the absorption region is too thick, then the speed of a
transit-time-limited photodetector will be degraded. A good rule of thumb is to have the absorption layer
thickness satisfy the following inequality:
2
𝛼< W < 1
𝛼.
(5.22)
where 𝛼is the absorption coefficient and its inverse (1/𝛼) is the penetration depth of the incident light.
For the above example of a silicon detector used for 680-nm light, the inverse of the absorption coefficient is
1∕(2.21 × 103) ≅4.5 μm. Therefore, according to the design rule in Eq. (5.22), the absorption layer thickness
should be between 4.5 and 9 μm. However, in practice, using standard silicon semiconductor technology, this
large a thickness may be difficult to achieve, so the QE would be degraded.
5.2.4
Dark Current
The dark current is the current generated in the photo-detector without an incident optical signal or when it
is in the dark. This current originates from the generation of an ehp due to thermal radiation or stray light.
Here, we briefly introduce typical theoretical current expressions for three mechanisms that contribute to
the dark current in a photodetector under reverse bias. The main mechanisms of transport in a reverse-bias
homojunction diode are diffusion of minority carriers Jdiff, generation–recombination current (for example,
due to trap-assisted and band-to-band tunneling) JGR, or surface leakage JS. These three mechanisms can be
described by the following expression:
Jdiff =
qn2
i
A
(
1
NA
√
Dn
𝜏n
+ 1
ND
√
Dp
𝜏p
)
[exp (qV∕kT) −1],
(5.23)
JGR = qniW
A𝜏GR
[exp (qV∕2kT) −1],
(5.24)
and
JS = BsVT3∕2
A
exp (−Eg∕2kT).
(5.25)
In these expressions, A is the area of the photodiode, W is the depletion width at reverse-bias voltage V, ni is
the intrinsic carrier concentration, NA and ND are acceptor and donor densities, respectively, Eg is the band-gap
energy, D’s and 𝜏’s are minority carrier diffusion constants and lifetimes, and Bs is a fitting parameter. The
corresponding D’s and diffusion lengths L can be calculated using the Einstein relation D∕𝜇= kT∕q where
𝜇= mobility and T = absolute temperature. Note that if dislocations are present, we also need to include a
model for the leakage current originating from the dislocations.

Optical Receivers
201
5.2.5
Speed or Response Time
The speed of response or bandwidth of a pin photodetector, shown in Fig. 5.8, depends on the following
factors.
1. The transit time 𝜏t of the photogenerated carriers through the depletion or active region, given by
𝜏t = W
𝑣,
(5.26)
where 𝑣is the speed of the carrier. If the carriers are not traveling at their saturation velocity 𝑣sat, then
𝑣= 𝜇E where 𝜇is the mobility of the carrier traveling in an electric field E. The electric field intensity
is in turn computed from E ∼V∕W, where V is the voltage across the depletion region W. Therefore, we
can write 𝜏t as
𝜏t =
{
W∕𝑣sat, for carriers traveling at their saturation velocity
W2∕(μV), for carriers traveling below their saturation velocity.
(5.27)
2. The slower (relative to drifting carriers) diffusion of carriers occurs outside the depletion region. To min-
imize this diffusion time effect, generally the depletion region is made as large as possible. For example,
a pin photodiode (Fig. 5.8) may be used instead of a pn photodiode where the i-region is much larger
than a typical reverse-biased depletion region. Also, because the doping concentration in the i-region is
significantly lower than that in the p- or n-regions in a pin photodiode, then most of the depletion width is
the i-region and the carrier transit time is drift dominated.
3. The RC time constant 𝜏RC is due to the resistance R (the sum of the diode’s parasitic resistance RS and the
load resistance RL) and the capacitance C of the diode. In this case, the RC time constant is given by
𝜏RC = RC.
(5.28)
Therefore, the total response time 𝜏tot can be written as the root-mean-square value
𝜏tot =
√
𝜏2
RC + 𝜏2
t .
(5.29)
Reverse-bias
voltage VR
Load resistor RL
i-layer
p+
n+
+
‒
Figure 5.8
Schematic representation of a pin photodiode showing the photoactive region where electron–hole pairs are
generated.

202
Fiber Optic Communications
Note that a fast transit time implies a thin detector active region, while low capacitance and high responsivity
require a thicker active region. Thus, there are trade-offs between fast transit times and low capacitance for
high-speed response, high quantum efficiency, low dark current, and good coupling efficiency when used in a
fiber system. For example, a fast transit time requires a thin detector photoactive region, while low capacitance
and high responsivity (or quantum efficiency) require a thick active region. It is very generally favorable to
design the absorption region to be larger than the penetration depth using expression (5.22).
Also, a smaller detector active area leads to lower dark current and smaller junction capacitance, but may
be inefficient for detector coupling to the fiber when used in fiber-coupled systems. Therefore, building on
the above examples, a silicon-based sensor that is optimized for 680-nm detection should be designed to have
the thickness of the semiconductor within 4.5–9 μm.
5.2.6
Linearity
Typically, reverse-biased photodetectors are highly linear devices (Fig. 5.9). Detector linearity means that the
output electrical current (photocurrent) of the photodiode is linearly proportional to the input optical power.
Reverse-biased photodetectors remain linear over an extended range (six decades or more) of photocurrent
before saturation occurs. Output saturation occurs at input optical power levels typically greater than 1 mW.
Because fiber-optic communication systems operate at low optical power levels, detector saturation is gener-
ally not a problem.
5.3
Common Types of Photodetectors
As mentioned in Section 5.1, semiconductor photodetectors can be broadly classified into those without inter-
nal gain and those with internal gain. In the first category are pn photodiodes, pin photodetectors, Schottky
barrier photodetectors, and MSM-PDs. In the second category are photoconductors, phototransistors, and
APDs. These second types of photodetector are used to improve the overall sensitivity of the front-end pho-
toreceiver.
Dynamic
range
Ideal
response
Saturation
Total noise
Pn
Pn
PI(dBm)
IPC(A)
Figure 5.9
Response characteristics of a typical photodetector. Important features of the response characteristics are
indicated in the figure.

Optical Receivers
203
5.3.1
pn Photodiode
A pn photodiode is basically a pn junction diode operating under reverse bias. It has already been described
in Section 5.2.1 and Fig. 5.5. In a pn photodiode, the incident photons may be absorbed in both depletion
and diffusion regions, and the number of ehps generated is proportional to the optical power (see Eqs. (5.11)
and (5.16)). The ehps are separated in the depletion region and are induced to drift under the influence of
the external applied electric field. In designing a pn photodiode, the depletion or absorption region should be
wide enough to achieve high quantum efficiency, but at the same time, it should not be too wide because the
drift time increases with the width, resulting in a decrease of the bandwidth of the photodiode. As mentioned
before, this exemplifies the compromise between quantum efficiency and speed for almost all photodetectors.
5.3.2
pin Photodetector (pin-PD)
The pin photodetector is one of the popular types used in fiber-optic communications and it was previously
introduced in Section 5.2.5. The performance of pin-PDs surpasses that of pn photodiodes because they can
easily be tailored for optimum quantum efficiency and bandwidth (see the sensitivity–bandwidth trade-off
discussed in Section 5.2.5). The basic pin-PD consists of three regions: heavily doped p+ and n+ layers and an
intrinsic i-layer that is typically a much lower-doped semiconductor. The i-layer sandwiched between the p+
and n+ layers is shown in Fig. 5.10. In a pin-PD, the photon absorption takes place primarily in the intrinsic
region that is depleted when reverse-bias voltage is applied to its terminals. The collection process for the
generated carriers is therefore fast and efficient. Thus, the intrinsic bandwidth is very high, and the overall
bandwidth that is limited by the extrinsic effects can be tens of gigahertz. Fabrication of pin photodetectors
is relatively easy, with well-established semiconductor processes, and the fabricated devices are very reliable
and of low noise. An example of a front-illuminated InP/InGaAs homojunction pin photodiode is shown in
Fig. 5.10. Typically, pin-PDs are combined with erbium-doped fiber amplifiers (EDFAs) in order to increase
the overall sensitivity of the receiver.
Similar to the pn photodiode, there is a compromise between quantum efficiency and bandwidth when
designing a pin-PD. For an optimized structure, the quantum efficiency–bandwidth product (𝜂-BW) is
approximately constant. For example, the bandwidth can be increased from a few tens of gigahertz to more
Optical
input
p
i
n
p+ InGaAs
n+ InP buffer
n+ InP substrate
Back contact metal
Ti/Au contact
n intrinsic InGaAs
absorption region
AR coating
Figure 5.10
Schematic structure of a front-side-illuminated InGaAs–InP pin photodiode.

204
Fiber Optic Communications
than 100 GHz [6] by using a matching network and decreasing the device size, but this reduces the quantum
efficiency. If a side-entry or a waveguide-fed pin-PD is fabricated, then the 𝜂-BW product can be further
improved [7]. The 𝜂-BW product can also be increased by inserting the pin-PD inside a resonant cavity as
in RCE-PDs, where the quantum efficiency is enhanced even for a thin absorption layer due to reflections
of light through the bottom and top mirrors of the cavity, resulting in multi-passes of light through the
absorption layer. This is discussed in more detail later in section 5.3.8.1.
5.3.3
Schottky Barrier Photodetector
The Schottky barrier photodiode is made of metal–semiconductor–metal rectifying junctions rather than pn
semiconductor junctions. Fig. 5.11 shows a simple schematic structure of a Schottky barrier photodetector.
Schottky barrier photodiodes have narrow active layers compared with pin or pn PDs. An important advantage
of Schottky barrier photodetectors is the very short carrier transit time, resulting in a very high bandwidth.
However, this advantage due to the narrow active layer comes at the expense of poor quantum efficiency.
Schottky photodetectors using InGaAs/InP-based material for the 1.3–1.55 μm wavelength region are also
useful photodetectors in the visible and ultraviolet wavelength range due to their large absorption coefficients
at these shorter wavelengths. However, one of the technical challenges in manufacturing the Schottky diode
is how to avoid surface traps and recombination centers that cause substantial loss of photogenerated carriers
at the surface, and therefore a reduction in quantum efficiency. Also, because the quantum efficiency is very
low in the 1.3–1.55 μm wavelength region, the Schottky barrier photodetectors are not widely used in optical
fiber communication systems.
5.3.4
Metal–Semiconductor–Metal Photodetector
A MSM-PD uses an absorption layer of semiconductor material that is sensitive to the wavelength of interest.
On top of this layer, metal electrodes are deposited as interdigitated fingers to form back-to-back Schottky
diodes with a suitable antireflection coating between them. Each electrode forms a Schottky barrier contact
with the semiconductor. It is connected to a large contact pad for subsequent interconnection to the external
circuit. The MSM-PD is a variation of a Schottky barrier photodetector with both contacts made on the same
side of the substrate. A top view of a MSM-PD is shown in Fig. 5.12, while a schematic of the cross-section
of this photodetector is shown in Fig. 5.13. The rectified I-V characteristic of a Schottky diode is similar to
that of a pn junction. However, a Schottky barrier occurs only for certain metal–semiconductor junctions
n+ layer
Metal-n+
contact
Metal-n+
contact
n‒ layer
Semi-insulating
substrate
Semi-transparent
gold contact
Figure 5.11
Schematic structure of Schottky barrier photodetector.

Optical Receivers
205
Schottky Contacts
Schottky Contacts
(a)
(b)
Figure 5.12
(a) Top view of a MSM-PD. and (b) Circuit schematic of a MSM-PD.
Semi-insulating substrate
Undoped active layer
Schottky contacts
Figure 5.13
A schematic structure of the cross-section of a MSM-PD.
which can also be ohmic. The doping levels in the p- and n-semiconductors control the potential barrier of
a pn junction. However, in a Schottky diode, the potential barrier (𝜑b) is controlled by the work functions
of the metal and semiconductor materials. A key difference between a pn diode and a Schottky diode is that
pn junctions allow both electrons and holes to flow under forward bias, while a Schottky diode is a majority
carrier device (only one type of carrier flows).
A MSM-PD is planar and requires only a single photolithography step for fabrication. The electrode
deposition stage may generally be combined with other metallizations in the fabrication of an integrated
receiver circuit. This makes the fabrication and monolithic integration with other electronic devices, such as
a metal–semiconductor field-effect transistor (MESFET), relatively easy.
The MSM-PD also has the same compromise problem between quantum efficiency and bandwidth as with
the other photodetector structures discussed above. While the quantum efficiency can be maintained by using
a multi-finger interdigitated layout, the bandwidth is increased by reducing the effective absorption layer
thickness. This can be achieved by artificially restricting the electric field within a certain layer near the
surface by introducing, for example, a highly doped layer at a certain depth. The impulse response for a
MSM-PD shows a tail response due to the photogenerated carrier distribution away from the surface. The
slow tail response can be removed by tailoring the carrier lifetime in the material so that the lifetime is almost
equal to the transit time between the electrodes.

206
Fiber Optic Communications
Some MSM-PD technology can provide very thin fingers and narrow spacing between fingers. Therefore,
the transit time can be made very small, but the limiting factor is now the capacitance Cd and the speed of the
MSM-PD is mainly controlled by its RtotCd time constant, where Rtot is the total resistance of the PD. The
capacitance may be calculated using the conformal mapping approach [8] and is given by
Cd = 𝜀0(1 + 𝜀r)K(k)
K(k′)
,
(5.30)
where 𝜀0 is the absolute permittivity of vacuum, 𝜀r is the relative dielectric constant of semiconductor, and K
is the elliptic integral of the first kind. In Eq. (5.27), k and k′ are defined as
k = tan2
(
𝜋Wfinger
4(Wfinger + Lgap)
)
(5.31)
and
k′ =
√
1 −k2,
(5.32)
where Wfinger and Lgap are the width and spacing of the fingers, respectively. For Wfinger = Lgap = 0.5 μm, and
40 fingers, each 10 μm long, the capacitance of the photodetector becomes 24 fF, which is a very small value
compared with other conventional photodetectors. This value can further be reduced by using a series–parallel
configuration of the fingers [8].
Regarding the geometry of a MSM-PD, it is noted that the signals are coupled to photodetectors through
optical fibers which have circular cross-sections. Therefore, a rectangular structure does not help in utiliz-
ing the entire surface area and thus the responsivity is reduced. Circular structures can instead be used for
improving the responsivity and the capacitance of a MSM-PD [5].
5.3.5
Photoconductive Detector
A photoconductive photodetector is made up of an absorptive semiconductor together with two electrical
terminals. When it is illuminated, the electrical conductivity increases because the photogenerated carriers
carry an electrical current. The internal gain mechanism arises from the space-charge neutrality requirement.
The photogenerated carriers move toward their respective collecting terminals with different velocities. The
carriers moving faster reach the terminal first, resulting in an excessive charge in the photoconductor. The
excessive charge draws additional carriers into the conducting layer, until the slowest carrier is recombined or
collected so that total charge neutrality in the photoconductor is satisfied. In this way, we can define the internal
gain as the ratio of the transit time of the slow carrier to that of the fast carrier. One limitation is its bandwidth,
which is inversely proportional to the transit time of the slow carrier. Therefore, photoconductors typically
have bandwidths up to a few hundred megahertz. Higher bandwidths, in the gigahertz range, can be achieved
by optimizing the distribution of photogenerated carriers along the device. Photoconductive devices are easy
to fabricate and incorporate into OEICs. However, they are not often used in optical fiber communication
systems due to their limited bandwidth and large leakage current.
5.3.6
Phototransistor
A phototransistor is similar to a bipolar junction transistor (BJT), but with normally only two terminals–the
collector and the emitter–used as electrical contacts. The base and the base–collector junction are used as the
absorption layer. The photogenerated holes in the absorption region accumulate in the base. This excessive

Optical Receivers
207
n InP substrate
n InP collector
InGaAs base
n InP emitter
Metal
Metal
AR coating
Optical
input
Figure 5.14
Schematic structure of an n–p–n InGaAs/InP phototransistor.
charge results in electrons being injected from the emitter. The current gain mechanism is the same as in
normal electrical operation of a BJT. The schematic structure of an n–p–n InGaAs/InP phototransistor is
shown in Fig. 5.14.
Heterojunction phototransistor (HPT) technology is promising, and can be built using different semicon-
ductor structures. For example, resonant-cavity-enhanced HPTs can be developed to improve both quantum
efficiency and responsivity. The HPT can also be integrated with a traveling wave device that is optimized for
microwave performance [9].
5.3.7
Avalanche Photodetectors
APDs are the most important photodetectors with internal gain that have been widely used in fiber-optic com-
munication systems. The APD is commonly used for detection of extremely low-intensity optical radiation
due to its high sensitivity characteristics [10–14]. The APD can be made using Si, Ge, or III–V semiconductor
materials. Its internal gain comes from the avalanche multiplication process through impact ionization events.
The impact ionization phenomenon has been extensively investigated, both theoretically and experimentally
[15–19], and a schematic representation is shown in Fig. 5.15.
Unlike the photodetector structures discussed above, an APD operates under sufficiently high reverse volt-
age to generate a high enough electric field in which highly energized photogenerated ehps can impact ionize.
In more detail, under a high electric field, the high-energy conduction band electrons initially scatter with an
electron in the valence band and knock it out into the conduction band, resulting in multiplication of the num-
ber of electrons in the conduction band and holes in the valence band. This results in a multiplication of the
number of current-carrying charges in this avalanche process. This avalanche process could also happen to
high-energy valence band holes that impact ionize. To cause impact ionization, the required minimum carrier
energy is the ionization threshold energy that should be larger than the band-gap energy.
The process of ionization is exponentially dependent on the magnitude of the electric field. The ionization
coefficients of electrons 𝛼and holes 𝛽are defined as the inverse of the mean distance between ionization
collisions, but electrons and holes can lose energy in non-ionizing collision processes such as phonon scat-
tering. One carrier undergoing the impact ionization process creates a pair of free carriers. All three carriers
get accelerated, and then continue to undergo impact ionization events and generate more free carriers. This

208
Fiber Optic Communications
Initial state of
an electron
Final state of
two electrons in
CB and one
hole in VB
VB
CB
Figure 5.15
Schematic representation of impact ionization in a direct band-gap semiconductor. Note: CB = conduction
band and VB = valence band.
process terminates when all the free carriers are swept out of the high-electric-field region. In the end, one ini-
tial electron or hole generates M extra e–h pairs, where M is called the multiplication gain of the photodetector.
A generalized theory regarding the impact ionization phenomena in semiconductor materials has been
developed by Baraff [20] in terms of threshold ionization energy (Ei), optical phonon scattering energy (Er),
and carrier mean free path (𝜆) limited due to optical phonon scattering. However, Baraff’s expression for the
impact ionization could be evaluated only numerically. A simple expression for the ionization parameters
of the charged carrier in a semiconductor as a function of an electric field and a lattice temperature has been
developed by Okuto and Crowell [17, 19]. They expressed the ionization parameters in terms of a power-series
expansion of the functions of an electric field (F), optical phonon energy, carrier mean free path due to optical
phonon scattering, and threshold energy for ionization. By fitting Baraff’s numerical results for 𝛼and 𝛽versus
electric field at low field values and imposing energy conservation conditions, Okuto and Crowell obtained a
semi-analytical expression for ionization coefficients. The expression is given by
𝛼; 𝛽= qF
Eie;h
exp
⎧
⎪
⎨
⎪⎩
0.217
(Eie;h
Ere;h
)1.14
−
√
√
√
√
√
[
0.217
(Eie;h
Ere;h
)1.14]2
+
[ Eie;h
qF𝜆e;h
]2⎫
⎪
⎬
⎪⎭
,
(5.33)
where Eie;h denotes the threshold energy of electron and hole ionization, 𝜆e;h and Ere;h represent the mean free
path and average energy loss of carriers per collision, respectively, due to optical phonons. The temperature
dependence of 𝛼and 𝛽in the above relation comes from the temperature dependence of Eie;h, 𝜆e;h, and Ere;h
and is given below (Eg is for the case in InP, as an example)
Eg(T) = 1.421 −3.63 × 10−4
(T + 162) T2,
(5.34)
Eie(T) = Eg(T) ⋅
Eieo
Eg(300),
Eih(T) = Eg(T) ⋅
Eiho
Eg(300),

Optical Receivers
209
𝜆e;h = 𝜆0e;h tanh
(Rr0e;h
2kT
)
,
Ere;h = Er0e;h tanh
(Rr0e;h
2kT
)
,
where 𝜆0e;h, Er0e;h, and k are the carrier mean free path at T = 0 K, average energy loss per collision for an
electron and a hole, respectively, and Boltzmann’s constant. Eg is the semiconductor (e.g., InP) band gap, and
Eie0 and Eih0 are the electron and hole ionization energies at 0 K. From Eq. (5.34), the breakdown conditions
are expected to be temperature independent in the low-temperature limit.
The mathematical description of the avalanche multiplication has been well documented [21–24]. The
theoretical research in these reviews is based on the assumption that the multiplication layer is thick, and the
multiplication process is continuous. Therefore, statistically, the discrete nature of the multiplication process is
averaged out. This is reflected, for example, in the fact that there is no “dead” space–a space where ionization
is impossible because the carrier has not acquired enough energy to initiate the multiplication process. Under
these assumptions, the multiplication occurs only in the multiplication region of thickness W (between 0 and
W). For details, see Fig. 5.16.
The electron component Jn(x) of the total current increases, and the hole component Jp(x) of the total current
decreases along the positive x-direction. The rate equation for Jn(x) and Jp(x) in this case can be written as
d
dxJn(x) = 𝛼(x) ⋅Jn(x) + 𝛽(x) ⋅Jp(x) + q ⋅G(x),
(5.35)
−d
dxJp(x) = 𝛼(x) ⋅Jn(x) + 𝛽(x) ⋅Jp(x) + q ⋅G(x),
(5.36)
electric field
P
N
0
 > 
 > 
(a)
(b)
W
Jn(0)
M(x)
Mn
Mp
Mp
Mn
Jn(W)
Jp(W)
Jp(0)
x
x
0
W
Figure 5.16
(a) Avalanche multiplication within a multiplication region of thickness W and (b) gain along the x-direction
for the cases 𝛼> 𝛽and 𝛼< 𝛽.

210
Fiber Optic Communications
where G(x) is the space charge generation rate due to optical or thermal generation. The total current density
J = Jn(x) + Jp(x) is a constant throughout the structure, to satisfy current continuity. Substituting this con-
dition into Eqs. (5.35) and (5.36), and integrating both sides from 0 to W, the total current density can be
obtained in two equivalent forms:
J =
Jp(W) + Jn(0) exp [𝜙(W)] + q exp [𝜙(W)] ∫W
0 G(x) exp [𝜙(x)]dx
1 −∫W
0 𝛽exp [𝜙(W) −𝜙(x)]dx
,
(5.37)
J =
Jp(W) exp [−𝜙(W)] + Jn(0) + q ∫W
0 G(x) exp [−𝜙(x)]dx
1 −∫W
0 𝛼exp [−𝜙(x)]dx
,
(5.38)
where exp (−∫x
0 (𝛼−𝛽) dx) ≡exp (−𝜙(x)). The multiplication gains with pure electron injection are Jp(W) =
0, Mn, and with pure hole injection are Jn(W) = 0, Mp, which can respectively be derived as
Mn =
J
Jn(0) =
exp [𝜙(W)]
1 −∫W
0 𝛽exp [𝜙(W) −𝜙(x)]dx
=
1
1 −∫W
0 𝛼exp [−𝜙(x)]dx
,
(5.39)
Mp =
J
Jp(W) =
1
1 −∫W
0 𝛽exp [𝜙(W) −𝜙(x)]dx
=
exp [−𝜙(W)]
1 −∫W
0 𝛼exp [−𝜙(x)]dx
.
(5.40)
Further, it can be shown that for both pure electron and hole injections, the breakdown condition when the
multiplication gain is infinite is the same. This condition is expressed as
1 −∫
W
0
𝛼exp [−𝜙(x)]dx = 1 −∫
W
0
𝛽exp [𝜙(W) −𝜙(x)]dx = 0.
(5.41)
It can also be shown that if 𝛼> 𝛽, then Mn > Mp, and vice versa. If the carriers with larger ionization coeffi-
cient are injected, then a higher gain should be obtained. This is also the condition for lower excess noise and
higher bandwidth. Note that the formalism for photogain presented above was based on the assumption that
the multiplication layer was thick. It did not take the discrete and statistical nature of the multiplication pro-
cess into consideration. More sophisticated theories for ionization multiplication can be found in the research
literature.
The multiplication gain described in Eqs. (5.40) and (5.41) represents only the average gain. The avalanche
multiplication process is actually a stochastic process, and the statistical variation of the multiplication gain
is responsible for the multiplication excess noise associated with the current. The total mean square noise
spectral density can be described by
⟨IM⟩2 = 2q
(
2
[
In (0) M2
n + Ip(W)M2
p + ∫
W
0
G(x)M2(x)dx
]
+ I
[
2 ∫
W
0
[𝛼M2
n (x) dx −M2
p
]])
.
(5.42)
Here, I is the total current. Eq. (5.42) can be simplified in the case of pure electron or pure hole injection as
⟨IM⟩2 = 2qIp0M2F.
(5.43)
Note that Ip0 is the primary photocurrent, M is the multiplication, and F is the excess noise factor, which in
turn is a function of the multiplication, device, and material parameters. If Ip is the total photocurrent, then
the expression for M is
M =
Ip
Ip0
(5.44)

Optical Receivers
211
The expression for F is given by
F = M ⋅
[
1 −(1 −k) ⋅(M −1)2
M2
]
= kM(1 −k)(2 −1∕M).
(5.45)
Here, k is replaced by either keff or k′
eff:
keff =
k2 −k2
1
1 −k2
,
(5.46)
k′
eff = keff
k2
1
,
(5.47)
and
k1 =
∫W
0 𝛽(x) ⋅M(x)dx
∫W
0 𝛼(x) ⋅M(x)dx
,
(5.48)
k2 =
∫W
0 𝛽(x) ⋅M2(x)dx
∫W
0 𝛼(x) ⋅M2(x)dx
.
(5.49)
For the case of a uniform electric field in the multiplication region, it turns out that keff = 𝛽∕𝛼and k′
eff = 𝛼∕𝛽.
From the computed results of excess noise factor F vs. gain M, it can be shown that, for lower excess noise,
the carriers with higher ionization coefficient should be injected. Also, the ionization coefficients for electrons
and holes should be significantly different for better performance of the APD. An APD provides gain with-
out the need for an amplifier. However, its main limitation comes from its bandwidth. Because of the long
avalanche build-up time, the inherent bandwidth of APDs is small. But APDs are very important because
their internal gain is suitable for long-haul communication systems with a minimum number of repeaters,
and also for dense wavelength-division multiplexing systems. Special structures can be used to improve the
high-frequency performance. Unlike pin-PDs, even for moderate or high applied bias, the absorption layer
may be at a low bias. This is because the multiplication layer should be under a high field for impact ioniza-
tion. Therefore, the absorption and multiplication regions should be decoupled. The separate absorption and
multiplication (SAM) structure with a bulk InP multiplication layer and an InGaAs absorption layer is shown
in Fig. 5.17. Here, the objective is to make avalanche multiplication occur in a wider band-gap layer, such as
InP, but for absorption to occur in a narrower band-gap layer, such as InGaAs.
To improve the performance of a SAM APD, a grading (G) layer is introduced in order to smooth out a band
discontinuity between InP and InGaAs. This reduces a hole pile-up at the interface and, therefore, improves
its frequency response at low biasing voltage [25–27]. Next, a charge (C) layer is used to control the electric
field distribution between the absorption and multiplication layers. This is necessary because the electric field
should be high enough to initiate impact ionization in the InP multiplication layer, and low enough to suppress
ionization in the absorption layer, which could lead to a lower bandwidth. Depending on the particular design,
different layers can be merged to perform the same tasks. For example, the charge layer can be merged with the
multiplication layer, resulting in a very narrow multiplication layer. This leads to the SAGCM APD, which,
despite its complexity, has an electric field profile that can be optimized for gain–bandwidth performance. It
offers the most flexibility in terms of tuning the electric field profile for a particular application. Also, edge
breakdown is suppressed because the charge sheet density is higher in the center of the device due to the mesa
structure, which results in a higher electric field in the center of the device than in its periphery.
In order for this structure to operate properly as an APD, some practical conditions must be satisfied. For
example, the electric field at the InGaAs/InP heterointerface should be smaller than 15 V/μm at operating

212
Fiber Optic Communications
n InP multiplication
n InGaAs absorption
n InP buffer
Guard ring
Optical input
AR coating
Dielectric‒
p+ InP
n+ InP substrate
Metal contact
(a)
Figure 5.17
(a) Schematic structure of a planar SAM InP/InGaAs APD.
bias voltages to avoid significant tunneling currents at this heterointerface. The absorption layer should be
completely depleted with minimum electric field of 10 V/μm to ensure that the photogenerated carriers are
swept at their saturated velocities to the InP multiplication region at the operating bias voltages. Further,
the absorption layer width should be large enough to obtain good quantum efficiency by ensuring adequate
absorption, but not too large so as to increase unnecessarily the carrier transit time and reduce the bandwidth.
The maximum electric field in the InP multiplication layer should be larger than 45 V/μm to achieve significant
avalanche multiplication. And the doping concentration in the InP multiplication layer should be smaller than
2 × 1017 cm−3 to avoid the large tunneling current [25, 26].
In [11] and [21], a manufacturable bulk InP avalanche photodiode suitable for 10-Gb/s applications was
introduced. It builds on the SAM structure with a bulk InP multiplication layer and an InGaAs absorption
layer. Then, three InGaAsP grading layers between the field control and absorption layer are included to
minimize hole trapping resulting from the valence band discontinuity that forms at an InGaAs–InP het-
erointerface. Also, edge breakdown is controlled by shaping the diffusion profile using a double-diffusion
technique to create a wider multiplication region with a higher breakdown voltage around the device periph-
ery. The back-illuminated geometry minimizes capacitance and dark current for a given optical coupling
diameter. This separate absorption, grading, charge, and multiplication (SAGCM) APD structure is one in
which the absorption, grading, charge, and absorption layers occur in sequence, as shown in Fig. 5.18, and it
has excellent optoelectronic performance characteristics.
5.3.8
Advanced Photodetectors*
The performance of photoreceivers can be improved by using some advanced photodetector structures. As
mentioned before, in the conventional surface-illuminated photodetectors, there is a trade-off between the
quantum efficiency and the bandwidth as thinner absorption layer results in a higher bandwidth (transit-time
limited) but a low quantum efficiency. Resonant cavity-enhanced (RCE) structures with a very thin active
layer are a possible solution as the thin layer gives rise to a large bandwidth, and the multiple passes of light
in the absorption layer in the resonant cavity increase the quantum efficiency [28–34]. A thin absorption
region is placed in an asymmetric Fabry–Prot cavity. The top and bottom reflectors, which can be fabricated
by distributed Bragg reflectors (DBRs), form the cavity. This is discussed in more detail in Section 5.3.8.1.

Optical Receivers
213
n InGaAs grading
n InGaAs
p+ InP diffused
AR SiO2
p-metal
Energy (a.u.)
Distance
Valence band
Fenni
level
n‒ InP multiplication
n‒ InP buffer
n+ InP charge    
n+ InP substrate
n‒ InGaAs
absorption
tmesa
xd
yactive
yperiphery
xj
tg
tbuff
th
tabsorp
(a)
(b)
tund
SiO2
Conduction band
tInP
Figure 5.18
(a) Schematic structure of a mesa overgrown planar SAGCM InP/InGaAs APD. (b) Schematic representa-
tion of the band profile within the active region without an applied bias voltage.
Another means to improve the quantum efficiency as well as the transit-time limited bandwidth is to use
edge-coupled structures. In this type of photodetector, the requirements for high efficiency and high band-
width are decoupled by illuminating the photodetector from the side of the absorption layer. Therefore, the
quantum efficiency is a function of the length of the absorption layer and not its thickness. So, a long thin
absorption layer is good enough to get high efficiency and concurrently, the transit-time limited bandwidth is
increased. Thus, the edge-coupled structure uses the attributes of waveguides [35–40] to improve both speed
and quantum efficiency.
5.3.8.1
Resonant Cavity Enhancement
As mentioned earlier in this chapter, in a conventional surface-illuminated photodetector, there is a trade-off
between the quantum efficiency and the bandwidth, two of the most important characteristics of a photode-
tector. The response time or speed of the photodetector is limited by two time constants.
(1) First, we have the transit time, defined as the time taken by photogenerated carriers to travel through
the absorption region and to get collected by the electrical contacts. This time constant gives rise to a 3-dB
bandwidth called the intrinsic bandwidth because it is linked to the intrinsic properties of the photodetector
and the charge carrier.
(2) Second is the RtotCd time constant, where Cd is the photodetector’s capacitance and Rtot is the sum
of its equivalent resistance and the load resistance. This bandwidth is called the extrinsic bandwidth. The
3-dB bandwidth depends on the thickness of the absorption layer of the photodetector, and can be increased
by reducing this thickness. But a thin absorption layer which gives a large bandwidth (transit-time limited)
results in a low quantum efficiency.

214
Fiber Optic Communications
One possible solution to this trade-off is to use a RCE structure such as a Fabry–Perot cavity with a very
thin active layer for a large bandwidth, and multiple passes of light in the absorption layer in the resonant
cavity to increase the quantum efficiency. In this structure, a thin absorption region is placed in an asymmetric
Fabry–Perot cavity (see Section 3.3). The top and bottom reflectors, which can be fabricated by DBRs, form
the cavity. Below, we discuss some relevant details of the resonant cavity structure.
The Fabry–Perot cavity generally has two parallel mirrors comprised of quarter wavelength stacks (QWS)
with a periodic modulation of the refractive index. That is, we use alternating materials that have different
refraction indices in a multilayer form, which results in reflection at the interfaces. This multilayer structure is
exploited to create optical mirrors, which reflect the light back to the optical absorption layer, thus effectively
increasing the absorption width of the otherwise physically thin layer. Having mirrors on both sides of the
absorption layer, the light gets “trapped” in the “cavity” between the mirrors until absorbed. The resonant
frequency of a Fabry–Perot cavity is given by Eq. (3.43),
𝜆
n = 2L∕integer,
(5.50)
where 𝜆is the light wavelength in vacuum, n is the refraction index of the material in the cavity, so that
𝜆∕n is the light wavelength in the material, and L is the distance between the mirrors. Owing to the electro-
magnetic wave property of the light, the “cavity” of mirrors can cause constructive or destructive summation
of the waves, depending on the ratio of the distance between the mirrors to the wavelength of the light.
Therefore, the spectrum of the enhancement becomes a quasi-oscillatory function of the light wavelength.
The peak-to-valley ratio also depends on the energy loss between the mirrors, or more precisely, the photon
absorption. For particular wavelengths, there is electromagnetic resonance in the cavity, which is the origin
of the term “resonant cavity enhancement”.
The classical arrangement of a RCE photodetector structure shown in Fig. 5.19(b) has a DBR as the front
mirror on the side where the light is incident and a metal reflector as the back mirror on the other side for
better reflection. Both mirrors can be electrically conductive, or one can place additional conductive sheets on
the sides of the absorption layer with width W, and the photogenerated carriers are swept out by the bias of the
photodetector traversing the structure once, thus, the transit time of the photodetector is virtually unaffected
by the optical mirrors. A requirement is for the incident light to pass through the front mirror, and then to be
reflected by the front mirror when traveling back into the cavity. Unfortunately, such a “diode-like” behavior
of optical mirrors is not strong, although it can be achieved with proper selection of anti-reflection coating of
the surface of the photodetector. Therefore, the front mirror is semitransparent, having similar reflectivities
for incident and cavity light, RS ≈R1 < 1, and consequently, similar transmissivities (1 −RS) ≈(1 −R1) < 1
in both directions. Ideally, the back mirror should have a very high reflectivity, R2 ∼1. The materials (Si and
Ge) in the cavity and in the absorption layer usually have similar refractive indices, weakly dependent on
bias and charge or doping concentrations; so, we can neglect reflections inside the cavity. For other materials,
this can be different; for example, in III–V semiconductors, organic semiconductors. The operation of the
photodiode in a RCE was analyzed in Ref. [41], and the responsivity is given in Refs. [41, 42].
Iph
Popt
=
{ q𝜂
hf0
× [1 −exp (−𝛼W)
] × (1 −RS)
}
× RCE,
where
(5.51)
RCE =
1 +
R2
exp(𝛼W)
1 −2
√
R1R2
exp(𝛼W) cos (2𝛽L + Ψ1 + Ψ2) +
R1R2
exp(2𝛼W)
with (q𝜂∕hf0) the responsivity of the absorption material of infinite thickness, W the width of the absorption
layer with absorption coefficient 𝛼, and RS ≈R1 the reflection from the photodiode surface. Thus, (1 −RS)

Optical Receivers
215
Trapped light until absorbed
Front
mirror
(a)
(b)
Incident
light
Mirrors
L (Cavity length)
Reflected
light (loss)
Back
mirror
L
Cavity
W

R2
R1
RS
Figure 5.19
Fabry–Perot resonator: (a) concept and (b) arrangement in a photodetector.
is the transmissivity of incident light into the cavity, R1 and R2 are the magnitudes of the reflections of the
front and back mirrors on both sides of the cavity, Ψ1 and Ψ2 are the phase shifts in the reflections introduced
by the mirrors (since the reflection in real mirrors is at a certain depth in the mirror, but not exactly from the
surface, especially for a DBR), L is the cavity length, and 𝛽= 2n𝜋∕𝜆is the propagation constant of the light
in the cavity with refraction index n. The terms in the curly bracket in equation Eq. (5.51) are the responsivity
of the photodetector without a RCE, and the second line describes the resonant cavity enhancement. The RCE
is a periodic function of L and 𝜆or, more precisely, their ratio. Constructive resonance in the cavity occurs at
the condition
(2𝛽L + Ψ1 + Ψ2) = (4n𝜋L∕𝜆o + Ψ1 + Ψ2)
= 2𝜋× integer in steps of halves of the wavelength, L
= integer × 1
2
(𝜆o
n
)
.
(5.52)
With this condition for resonance at a wavelength 𝜆0, the RCE is maximum and is given by
RCEmax =
1 + R2 exp (−𝛼W)
[1 −
√
R1R2 exp (−𝛼W)]2
≈
1 + R2
(1 −
√
R1R2)2 ,
when 𝛼W << 1, since exp (−𝛼W) ≈1
≈
2
(1 −
√
R1)2 , when also R2 ≈1.
(5.53)
Thus, the RC enhancement increases with the reflectivities of the mirrors. However, the enhancement is in a
narrow optical “bandwidth” given by
1
F = FWHM
FSR
=
1 −
√
R1R2 exp (−𝛼W)
𝜋
√√
R1R2 exp (−𝛼W)
≈
1 −
√
R1
𝜋
√√
R1
∼
1 −
√
R1
𝜋
,
when 𝛼W << 1, R2 ≈1, and R1 →1.
(5.54)

216
Fiber Optic Communications
Here F is called the “finesse” of the resonator and F is the ratio of the “free spectral range” FSR = 𝜆2
0∕(2nL),
which is the spacing between RC enhancement maxima and the spectral FWHM, which is the opti-
cal “bandwidth.” The finesse in resonators corresponds to the quality factor QLC = 2Δf3dB∕fo in LC
(inductor–capacitor) electrical resonators at frequency fo, with 2Δf3dB being the 3-dB bandwidth around fo,
which is the same as FWHM. The principal difference between an LC resonator and a Fabry–Perot cavity
is that the LC resonator is a lumped-element resonator with only one resonance frequency fo, whereas the
Fabry–Perot cavity is a delay resonator with periodic resonance frequencies and spacing FSR between the
wavelengths corresponding to these frequencies. The last expression in Eq. (5.51) suggests that a high R1
is favorable for RC enhancement, e.g., R1 = 0.9 would provide an RC enhancement ≈750. However, the
narrowing of the bandwidth of RCE at high R1 sets tight requirements for precision of distances in the
Fabry–Perot cavity, so that the inaccuracy 𝛿L = (ΔL∕L) < (0.5∕F) of the resonator length is a fraction of the
RCE bandwidth.
Example 5.5
Given a high R1 = 0.9 in the last approximate expression in Eq. (5.54), the RCE relative bandwidth is 1∕F =
(1 −
√
0.9)∕𝜋= 1.6%. Using a conservative value for the refractive index of Si, n =
√
(𝜀Si∕𝜀o) =
√
(11.9) ≈
3.5, and choosing 𝜆o = 850 nm, then for integer = 4, the resonator length is L = integer × 𝜆o∕(2n) = 4 ×
850 nm∕(2 × 3.5) ≈486 nm. Consequently, to be within the resonance, the resonator should be fabricated
with inaccuracy ΔL < L × 0.5∕F = 486 nm × 0.5 × 1.6% ≈4 nm.
Comments: The fabrication of a stack of heterogeneous materials for two mirrors and silicon in-between with
accuracy of 4 nm is not simple. The materials might not be perfect, or the calculation might not be accurate,
in order to guarantee 0.8% accuracy; e.g., the refractive index of Si is not 3.5, but 3.65 at 𝜆o = 850 nm, which
gives a much larger error of 4% in the calculation. Thus, we cannot really exploit RCE with large values. In
real structures, RCE is in the range of 10, partially because of inaccuracy and additionally because R2 > 0.9
for the back mirror is also difficult to achieve (metals have reflections of about this value and DBR requires
more than four undulations of Si–SiO2 for higher reflections from the Bragg mirror).
Another limitation for RCE is that the external quantum efficiency is not a monotonic function of reflections
and absorption in the Fabry–Perot cavity. The terms in Eq. (5.51) that determine the maximum RCE external
quantum efficiency 𝜂max as a ratio of the material quantum efficiency at the resonant condition
(2𝛽L + Ψ1 + Ψ2) = (4n𝜋L∕𝜆o + Ψ1 + Ψ2) = 2𝜋× integer
(5.55)
are arranged in the following equation:
𝜂max(4nL∕𝜆0 = 2 × integer) =
Iph∕Popt
hf0∕q𝜂
= [1 −exp (−𝛼W)][1 + R2 exp (−𝛼W)]
[1 −
√
R1R2 exp (−𝛼W)]2
(1 −RS),
(5.56)
with RS ≈R1. Eq. (5.58) is for the minimum RCE external quantum efficiency 𝜂min as a ratio of the material
quantum efficiency at the antiresonant condition
(2𝛽L + Ψ1 + Ψ2) = (4n𝜋L∕𝜆o + Ψ1 + Ψ2) = 𝜋+ 2𝜋× integer,
(5.57)

Optical Receivers
217
𝜂min(4nL∕𝜆0 = 1 + 2 × integer) =
Iph∕Popt
hf0∕q𝜂
= [1 −exp (−𝛼W)][1 + R2 exp (−𝛼W)]
[1 +
√
R1R2 exp (−𝛼W)]2
(1 −RS),
(5.58)
with RS ≈R1. As follows from Eqs. (5.56) and (5.58), the undulation of RC enhancement between peak and
valley values, at resonance and antiresonance, is
𝜂max
𝜂min
=
[
1 +
√
R1R2 exp (−𝛼W)
1 −
√
R1R2 exp (−𝛼W)
]2
≈
(
1 +
√
R1R2
1 −
√
R1R2
)2
, when 𝛼W << 1, since exp (−𝛼W) ≈1;
≈
(
1 +
√
R1
1 −
√
R1
)2
,
when 𝛼W << 1, and also R2 ≈1;
≤
4
(1 −
√
R1)2 ∼
1
1 −
√
R1
≈F
𝜋, when 𝛼W << 1,
R2 ≈1, and R1 →1,
(5.59)
where the last line shows that the cavity finesse F and RCE undulation 𝜂max∕𝜂min between peak and valley
values are related, recalling the approximate relations in Eq. (5.54).
The behavior of RCE is illustrated in Fig. 5.20 and compared with a non-resonant photodetector. The hori-
zontal axis is reversed, considering that a particular photodetector has fixed width W of the absorption layer,
and the absorption coefficient decreases for longer wavelengths, thus, the left-hand sides of the plots corre-
spond to shorter wavelengths, while the right-hand sides correspond to longer wavelengths. The behavior of
RCE is discussed further below. At shorter wavelengths in photodetectors with thick absorption layers, the
product 𝛼× W is larger than 1. In this case, the light is absorbed before reaching the back mirror, and the
RCE structure behaves identically with the non-resonant photodetector–all lines overlap for 𝛼× W > 3 in
Fig. 5.20 and the back mirror, if any, is irrelevant. Of course, a portion of the incident light is reflected by the
front mirror (or the surface of the photodetector), and we desire R1 = RS to be as low as possible.
At longer wavelengths in photodetectors with thin absorption layers, the product 𝛼× W is smaller than 1,
and RCE becomes relevant. If the back mirror is ideal (R2 = 1, left-hand plot in Fig. 5.20), the resonance
in the Fabry–Perot resonator would help to increase the quantum efficiency (non-monotonic thin lines) and
even restore the ideal value 𝜂max = 1 at condition exp (−𝛼W) =
√
R1. However, real mirrors have reflection
R2 < 1, and the decrease in back mirror reflection R2 to 0.9 and 0.8 (still high) degrades the ability of RCE to
restore the quantum efficiency, as seen in the middle and right-hand plots of Fig. 5.20, especially for high front
mirror reflection R1 (which is also the reflection from the photodetector surface, RS ≈R1). The condition for
maximum quantum efficiency becomes a complicated expression:
√
R1R2 = 1 + R2 [2 exp (−𝛼W) −1]
2 −(1 −R1) exp (−𝛼W) ,
(5.60)
but tends to (R1 × R2) ≈(1 −2𝛼W) when (𝛼W) ≤0.1 and R2 ≥0.8. In addition, if the resonator is not tuned
at the wavelength, then RCE will suppress the quantum efficiency, as shown with symbols on dashed lines in
Fig. 5.20. The suppression is less than 3 dB, which is not a dramatic decrease in responsivity, but we realize
that the RCE is not favorable if the cavity is not precisely tuned at the wavelength of interest, e.g., in cases of

218
Fiber Optic Communications
10
RCE max
no RCE
RCE min
RCE max
no RCE
RCE min
RCE max
no RCE
RCE min
1
0.1
Quantum efficiency
0.01
0.001
10
1
0.1
0.01
0.001
100
R1 = 0
R1 = 0.50
R1 = 0.70
R1 = xx
R1 = xx
R1 = 0
R1 = 0.50
R1 = 0.70
R1 = xx
R1 = xx
R1 = 0
R1 = 0.50
R1 = 0.70
R1 = xx
R1 = xx
10
1
0.1
  W
  W
  W
0.01
0.001
100
10
1
0.1
0.01
0.001
100
10
1
0.1
0.01
0.001
R2 = 1
R2 = 0.9
R2 = 0.8
Figure 5.20
Resonant cavity enhancement (RCE max, non-monotonic thin lines) of photodetectors with Fabry–Perot
resonator as a function of the product 𝛼× W of the absorption coefficient 𝛼and the absorption layer width W compared
with non-resonant photodetectors (thick lines, R2 = 0) and suppression in RCE (RCE min, dashed lines with symbols)
for several reflections of the front mirror (R1 = RS, as indicated by labels on the lines) and back mirror (R2 = 1, 0.9 and
0.8, in the plots from left to right).
˜10 μm
Figure 5.21
Cross-section of the oxide stack in a six-metal CMOS, around year 2000.
broad-spectrum photosensors for imager arrays, or by temperature and fabrication variations. Note that not
all the curves in Fig. 5.20 exceed unity, which means that RCE can only remedy incomplete absorption in
thin layers.
Submicrometer Si technologies usually have a thick stack of oxide layers, in the range of 3–10 μm as shown
in Fig. 5.21 from Ref. [43], since many metal layers need to be accommodated for electrical interconnections.

Optical Receivers
219
p+
n+
1
0.8
0.6
0.4
0.2
0
400 450 500 550 600
One uniform dielectric layer
Transmittance as External Quantum Efficiency
 ≈19 μm optical
 ≈ 9.5 μm physical
Twelve dielectric layers
650 700 750 800
1
0.8
0.6
0.4
0.2
0
400 450 500 550 600 650 700 750 800
Wavelength (λ, nm)
μm
0.60
7.5
4.2
4.2
4.2
4.2
4.2
4.2
4.2
4.0
3.7
3.7
3.7
3.7
3.7
11.0
0.75
1.00
0.35
1.10
1.10
1.10
1.10
1.10
0.75
(a)
(b)
0.20
0.20
0.20
0.2
εr
Figure 5.22
Layer content corresponding to Fig. 5.21 around year 2000. (a) Thicknesses (in microns) and relative
permittivity of the layers. (b) Transmittance of the dielectric stack calculated at assumptions for uniform (upper plot) and
alternated (bottom plot) refractive index.
Apart from the problem of having an unobstructed optical path in the web of metal wires, the oxide stack is not
uniform but alternate silicon nitride and silicon dioxide layers in order to enable nanometer-scale lithography
and etching for metal wires and vias for electrical interconnection, as shown in Fig. 5.22(a). The optical
transmittance of the stack, being a multiplier in the external quantum efficiency, has been calculated in Ref.
[43] with two assumptions, as shown in Fig. 5.22(b). One assumption is to consider a nearly uniform dielectric
with an average refractive index, since the majority of layers have similar permittivity, thus
√
4.2 ≈
√
3.7 ≈2.
Using this assumption, the external quantum efficiency of the photodetector is undulating between two values,
as shown in the upper plot. The bottom plot is the result from calculation with a transfer matrix method,
showing additional modulation with slowly varying components due to thinner cavities in the dielectric stack.
In either case, the spacing between minima and maxima can be estimated by FSR = (𝜆2∕Lopt), where Lopt ≈
(ΣnL) ≈19.5 μm, here, n is the refractive index. Depending on the wavelength 𝜆, the values of FSR are
between 9 nm and 32 nm. These values are relatively small for broadband light in natural scenes. Thus, the
RCE effects do not compromise the use of CMOS technology for imager arrays. However, for special cases
in spectrometry, it is clear that standard CMOS may not be the best choice.
5.4
Direct Detection Receivers
Fig. 5.23 shows the block diagram of a digital optical receiver. It has three parts: (i) front end, (ii) linear chan-
nel, and (iii) data recovery section (see Ref. [3] for more details). The front end consists of a reverse-biased
photodiode. The photodiode converts the optical data into electrical data. The output of the photodiode passes
through a preamplifier.

220
Fiber Optic Communications
The linear channel consists of a high-gain amplifier (Amp) followed by a low-pass filter (LPF). The LPF
is used to truncate the noise spectrum. Since the variance of receiver noise is proportional to the receiver
bandwidth, it is desirable to keep the bandwidth of a LPF sufficiently low. However, the LPF truncates the
signal spectrum too. The bandwidth of the LPF should be optimized so that the signal-to-noise ratio (SNR) is
maximum. Typically, the SNR is maximum if the receiver bandwidth is of the order of the bit rate frequency.
To have the best SNR, the receiver transfer function should be matched to the transmitted signal (see Chapter
8), which is hard to achieve in practice.
The data-recovery section consists of a decision circuit and a clock-recovery circuit. Suppose the bit pattern
at the input end of a fiber-optic link is ‘1011’, as shown in Fig. 5.24. Some of these bits may be corrupted due
to the noise added by the fiber-optic link or by the receiver. Suppose that the peak current at the receiver is
100 mA and the threshold current is 30 mA. If the received current is more than 30 mA, at the sampling time
(usually at the middle of the bit interval), the decision circuit interprets it as ‘1’, otherwise the received bit is
zero. In the figure, the third bit transmitted is ‘1’, but because of the noise, the received current corresponding
to that bit is less than the threshold current. Therefore, the decision circuit interprets it as ‘0’, causing a bit
error. The sampling time for the decision is provided by a clock which is extracted from the received signal
using a clock-recovery circuit.
5.4.1
Optical Receiver ICs
To form a complete photoreceiver, the photodetector is integrated with a preamplifier. The most common
preamplifiers that are combined with photodetectors are built with either high-electron mobility transistors
(HEMTs) or heterojunction bipolar transistors (HBTs).
Photo
diode
LPF
Decision
circuit
Clock
recovery
Amp
data
Received
optical signal
Front end
Linear channel
Data recovery
Pre-
amp
Figure 5.23
Block diagram of a direct detection receiver. LPF = low-pass filter.
Fiber-optic
link
RX
Input optical signal
t
P(t)
t
P(t)
t
I(t)
Output optical signal
Electrical signal
Threshold
Figure 5.24
Bit patterns at the various stages of a fiber-optic system.

Optical Receivers
221
5.4.1.1
pin-HEMT
Monolithic pin-HEMT photoreceivers were demonstrated in many research publications, for example, in
[44, 45]. In [44], an InAlAs/InGaAs pin-HEMT was reported, where the HEMT epitaxial layers are fabri-
cated first and then the InGaAs pin-PD layers are grown. A schematic structure of this photoreceiver is shown
in Fig. 5.25. This photoreceiver has a good response of 1.6 Gb/s non-return-to-zero (NRZ) signals using a
standard common-emitter/common-collector amplifier. In [45], a transimpedance amplifier (TIA) configura-
tion with a feedback resistance of 500 Ω had a high sensitivity of −17.3 dBm with a monolithically integrated
pin-HEMT photoreceiver at 10 Gb/s for a BER of 10−9 using a (223 −1) pseudorandom binary sequence
NRZ lightwave signal. The receiver bandwidth is 7.4 GHz. When an erbium doped fiber amplifier (EDFA)
was inserted before the pin-HEMT receiver, there was a significant improvement in its sensitivity (−30.6 dBm)
[45]. Also, a high-impedance design may produce a high performance if it is followed by a suitable equalizer.
5.4.1.2
pin-HBT
HBTs have several advantages compared with compound semiconductor FETs. For example, HBTs have
tremendous potential for high-speed circuits with very modest lithographic design rules. A monolithically
integrated front-end pin-HBT photoreceiver can be fabricated by first growing pin-PD layers and then growing
HBT epitaxial layers implemented with a single epitaxial growth technique and a self-aligned fabrication
technology. The advantage of this type of fabrication is that both pin-PD and HBT designs can be individually
controlled to obtain their optimum performance. Such a pin-HBT photoreceiver is demonstrated in Ref. [46],
where the receiver circuit incorporating a cascode preamplifier and capacitors showed a bandwidth of 2.8 GHz
and a sensitivity of −21 dBm. This technique has the disadvantages of increased parasitics and non-planarity.
The fabrication technique that uses shared-layer integration becomes attractive as shown in Fig. 5.26, where
the subcollector, collector, and base layers are the same as the n-, i- and p-layers of pin-PD, respectively [47].
This structure has the advantage of minimizing the number of growth layers.
Note that the photodetector and HBT designs are not completely independent. For example, the design
used in [49] for an integrated pin-PD and InP/InGaAs HBT photoreceiver is suitable for the HBT, but not
for the photodetector. The photoreceiver consisting of a pin-PD and a transimpedance amplifier operated at
2.5 Gb/s, though the amplifier bandwidth is as high as 19 GHz as the performance is limited mainly by the
characteristics of the photodetector.
For the heterojunction in the HBT, we can use InAlAs/InGaAs. In [50], an integrated InAlAs/InGaAs
pin-HBT transimpedance photoreceiver using a three-stage amplifier configuration results in an improvement
in the bandwidth (∼7.1 GHz). In this preamplifier, the first stage is a TIA and the last two stages are emitter
p-GaInAs
GaInAs
pin-PD
n-InAlAs/GaInAs
HEMT
S.I. InP
n-GaInAs
GaInAs
InP
n-ohmic
InAlAs
SiN
Gate
i-GaInAs
p-ohmic
Ti/Au
InP
Figure 5.25
Schematic structure of a monolithic InAlAs/InGaAs pin-HEMT. Adapted from [44].

222
Fiber Optic Communications
N InGaAs contact layer
N AlGaAs Emitter
GaAs P Base
GaAs Collector
Collector
contact
N contact, P contact, absorber
GaAs
Figure 5.26
Shared-layer monolithic pin-HBT . Adapted from [59].
followers. With an optimum choice of collector thickness and use of a booster inductance, the InAlAs/InGaAs
pin-HBT receiver achieved a bandwidth of 20 GHz [51].
Double heterojunction bipolar transistor (DHBT) configurations are superior to single heterojunction bipo-
lar transistor (SHBT) in terms of radio-frequency (RF) performance and breakdown voltage. In [52], a mono-
lithic pin-HBT receiver using DHBT of various collector thicknesses was fabricated. The collector layers are
composed of undoped InGaAs, pn pair doped InGaAs, and n-InP. With this double-heterojunction technol-
ogy, a receiver bandwidth of 26.7G Hz with a large transimpedance gain of 48.9 dBΩ was obtained. However,
the SHBT structure with shared-layer integration has the advantage of fewer layers to fabricate, thus the cost
would be less. Therefore, suitable device design and circuits can be used to obtain improved performance
from SHBT systems. For example, using a (1 μm × 5 μm) HBT and a 9-μm diameter photodetector for a
monolithic pin-SHBT photoreceiver [53], bandwidths as high as 46 GHz were achieved. Using a common
base configuration as an input stage, further improvement in bandwidth was observed [54]. In [54], by a sim-
ple reduction of the photodetector’s area and an adjustment of the feedback resistance, a bandwidth of 60 GHz
was predicted.
5.4.1.3
MSM-HEMT
The integration of metal-semiconductor-metal (MSM) photo-detector and HEMT is usually based on
stacked-layer technology. A schematic diagram of the layers for an integrated MSM-HEMT photoreceiver
is shown in Fig. 5.27. As shown in Fig. 5.27(a), if the HEMT layers are grown over the MSM layers, the
structure may be termed a HEMT/MSM structure. Another possibility is, therefore, a MSM/HEMT config-
uration. The overall photoreceiver performance depends on the performance of each individual component.
In [55, 56], it has been shown that MSM/HEMT structures are superior to HEMT/MSM structures.
The intrinsic bandwidth of a MSM-PD is very high, and the main limitation of its high-frequency perfor-
mance comes from the preamplifier. The transimpedance amplifier configuration is a good choice with respect
to high bandwidth, wide dynamic range, and low noise at high frequencies. The feedback resistance is very
important in a TIA. It can be either a fixed metallic resistance formed on the substrate, or a voltage-controlled
variable resistance [55]. In [55], a two-stage variable TIA with a common-gate HEMT was used as the feed-
back resistance (see Fig. 5.28). By adjusting the d.c. voltage to the gate of this HEMT, transimpedance gains
ranging from 55.8 dBΩ to 38.1 dBΩ with corresponding 3-dB cutoff frequencies from 6.3 GHz to 18.5 GHz
were obtained.
Noise consideration is a critical factor for the performance of the photoreceivers. It is usually expressed
in terms of the equivalent input current noise spectral density. Current noise spectral densities of 7.5, 8,

Optical Receivers
223
8nm InGaAs:5 × 1018 cm‒3
2.5nm i-AlAs etch
17nm i-InAlAs
5nm i-InAlAs
20nm i-InGaAs
100nm         InP:Fe
50nm i-InAlGaAs
5nm i-InAlAs
25nm i-InAlAs:Fe
1μm InP:Fe barrier/etch
1μm InGaAs
50nm InP:Fe
InP:Fe substrate
5nm i-InGaAs etch
50nm i-
8nm InGaAs:5 × 1018 cm‒3 Si
2.5nm i-AlAs etch stop
17nm i-InAlAs
5nm i-InAlAs
20nm i-InGaAs
50nm i-InAlGaAs (graded)
5nm i-InAlAs
25nm i-InAlAs:Fe
1μm InGaAs absorption
50nm InP:Fe
MSM
MSM
HEMT
(b)
(a)
HEMT
InP:Fe substrate
50nm i-InAlAs
Figure 5.27
Schematic structure of (a) HEMT/MSM and (b) MSM/HEMT. Adapted from [54].
InP substrate
Delta-doped
pseudomorphic
In0.76Ga0.26As
channel with a
InAlAs spacer
HEMT
S
G
D
InGaAs
contact layer
MSM-PD
Interdigitated
In0.63Ga0.47As
InAlAs buffer
Absorption layer
InAlAs barrier layer
Figure 5.28
MSM and HEMT grown in parallel. Information for schematic taken from [57].
and 12 pA/Hz1∕2 were obtained for bandwidths of 6.3, 8, and 13.7 GHz, respectively in [55]. The noise per-
formance of a receiver in the case of a digital signal is usually defined by its sensitivity, or the minimum
detectable signal power in the presence of noise for a particular bit error rate (BER). As standard practice,
a BER of 10−9 is used for characterization of most receivers. For example, the sensitivity of an InP-based
MSM-HEMT photoreceiver described in [57] is measured to be −10.7 dBm at 10 Gb/s with 1 μm spacing of
the MSM electrodes. The noise performance is frequently shown by eye diagrams. The more open the eye is,
the better is the noise performance and, hence, the inter-symbol interference (ISI) is less.
Although the performance of InP-based structures is very good, the electronic device technology is more
established for GaAs-based structures. This significantly reduces their cost. Thus, GaAs-based structures are
more popular and attractive for commercial applications. Also, compared with pin-PDs, MSM-PDs have the
advantage of high intrinsic bandwidth, ultra-low capacitance, and easy planar integrability with HEMTs and
HBTs [59, 60].

224
Fiber Optic Communications
5.4.1.4
APD-HEMT
In [12], an optical APD photoreceiver operating at 10 Gb/s was introduced. The optical front end consists
of a SAM-APD and a TIA preamplifier constructed from HEMT devices using hybrid circuit techniques.
The planar InGaAs SAM-APD is back-illuminated and has a reflecting P-contact to maximize the quantum
efficiency. This photoreceiver had a maximum gain bandwidth of 75 GHz, a quantum efficiency of 80%, and
a parasitic capacitance of 13 pF. The three-transistor preamplifier uses a feedback resistance of 330 Ω after
the second stage, while the third resistance is used to perform impedance matching to 50 Ω. High sensitivity
of −29.4 dBm at 10 Gb/s is achieved using a hybrid APD-HEMT photoreceiver [13]. A noise-matching net-
work between APD and HEMT amplifier stages helps to increase the sensitivity. It is implemented using an
InAlAs/InGaAs superlattice APD and HEMTs.
5.5
Receiver Noise
An optical receiver not only translates the data in the optical domain into an electrical domain, but it also adds
noise. Two important noise sources are (i) shot noise and (ii) thermal noise.
5.5.1
Shot Noise
As mentioned in Section 5.2.1, if the power of an optical signal in an interval T is P, it corresponds to a photon
rate of P∕hf0 where f0 is the frequency of the light wave. In other words, the mean number of photons in this
optical signal is n = PT∕hf0. Owing to the quantum nature of photons, the actual number of photons in the
interval T is random–sometimes more than n and sometimes less. For light from an ideal laser, the number
of photons in an optical signal of power P in a time interval T obeys the Poisson probability distribution [61]
p(n) = nn exp (−n)
n!
,
n = 0, 1, 2, …
(5.61)
Here, n is the number of photons. Fig. 5.29 shows the Poisson probability distribution. As can be seen,
the curve becomes broader as the mean photon number n increases. An important property of the Poisson
distribution is that the mean is the same as the variance,
< n >= 𝜎2 =< n2 > −< n>2 = n.
(5.62)
Thus, if the mean number of photons is 16, the actual number of photons is approximately in the range
16 ± 4. Next, let us consider an ideal photodiode with quantum efficiency 𝜂= 1. If n photons are incident on
this photodiode, the number of photocarriers generated is also n. Since the number of photons in an interval
T is random (even though the optical power is fixed), the number of photocarriers generated in that interval
is also random and it obeys the same Poisson probability distribution as the photon given by Eq. (5.61). For a
non-ideal photodiode (with quantum efficiency 𝜂< 1), the probability of the event that a photon incident on
the photodiode generates an electron–hole pair that contributes to the photocurrent is 𝜂, or the probability of
this event not happening is 1 −𝜂. The randomly generated photocarriers lead to fluctuations in photocurrent,
which is known as shot noise. In summary, the noise component in a photocurrent has two contributing
factors. (i) Owing to the quantum nature of photons, the photon arrival times within an interval T are random,
which leads to ehp generation at random times. (ii) Not all the photons incident are absorbed, and not all the
photocarriers generated contribute to the photocurrent as there is a chance of recombination before reaching
the terminals of the photodetector. When an optical signal of power PI falls on the pin photodiode, the current
can be written as
I(t) = IPC + ishot(t),
(5.63)

Optical Receivers
225
0
2
4
6
8
10
12
14
16
18
20
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
0.16
0.18
Photon number n
p(n)
mean n = 5
mean n = 8
mean n = 11
Figure 5.29
Poisson probability distribution for different mean photon numbers n.
where IPC = RPI is the deterministic part of the current and ishot(t) is the noise component of the current due
to shot noise. The shot noise current ishot(t) is a random variable with zero mean, i.e., < ishot(t) >= 0. The
noise power dissipated due to ishot(t) in a 1-Ω resistor is i2
shot(t). The mean noise power is
N1
shot =< i2
shot(t) >= 𝜎2
shot,
(5.64)
where 𝜎shot is the standard deviation and superscript 1 indicates that it is the noise power dissipated in a 1-Ω
resistor. Thus, the variance is the same as the mean noise power dissipated in a 1-Ω resistor.
The shot noise is a white noise process, and its power spectral density is constant. Using Eq. (5.62), it can
be shown that the PSD of the shot noise is [61]
𝜌shot(f) = qIPC,
(5.65)
where q is the electron charge.
For simplicity, let us assume that the receiver is an ideal low-pass filter with bandwidth Be. The receiver
transfer equation ̃He(f) is given by
̃He(f) =
{
1,
if
|f| < Be
0,
otherwise.
(5.66)
The shot noise generated in the photodiode passes through the rest of the receiver circuit. The PSD at the
receiver output is
𝜌shot,out(f) = 𝜌shot(f)| ̃He(f)|2.
(5.67)
The PSD refers to the mean power per unit frequency interval and, therefore, the mean noise power at the
receiver output (dissipated in a 1-Ω resistor) can be obtained by integrating the PSD over frequency,
N1
shot = ∫
∞
−∞
𝜌shot,out(f)df.
(5.68)

226
Fiber Optic Communications
Using Eqs. (5.65) and (5.66) in Eq. (5.68), we obtain
N1
shot = qIPC ∫
∞
−∞
| ̃He(f)|2df
= 2qIPCBe.
(5.69)
Using Eq. (5.64), we find the variance of shot noise as
𝜎2
shot = N1
shot = 2qIPCBe.
(5.70)
Eq. (5.70) is valid for arbitrary filter shapes if the effective bandwidth Be is defined as
Be = 1
2 ∫
∞
−∞
| ̃He(f)|2df.
(5.71)
When the dark current Id is not negligible, Eq. (5.70) is modified as
𝜎2
shot = 2q(IPC + Id)Be.
(5.72)
For APD receivers, the variance of shot noise is given by (see Section 5.3.7) [62]
𝜎2
shot = 2qM2F(RPI + Id)Be,
(5.73)
where M is the multiplication factor and F is the excess noise factor.
5.5.2
Thermal Noise
Electrons move randomly in a conductor. As the temperature increases, electrons move faster and therefore
the electron current increases. However, the mean value of the current is zero since, on average, there are as
many electrons moving in one direction as there are in the opposite direction. Because of the random motion
of electrons, the resulting current is noisy and is called “thermal noise” or “Johnson noise”.
In the presence of thermal noise, the current in the receiver circuit may be written as
I(t) = IPC + ithermal(t),
(5.74)
where IPC is the mean photocurrent (deterministic), and ithermal(t) is the thermal noise current.
For low frequencies (f ≪kBT∕h), thermal noise can be regarded as white noise, i.e., its power spectral
density is constant. It is given by
𝜌thermal(f) = 2kBT∕RL,
(5.75)
where kB is Boltzmann’s constant, RL is the load resistance, and T is the absolute temperature. If Be is the
effective bandwidth of the receiver, the noise variance can be calculated as before,
𝜎2
thermal =< i2
thermal >= 4kBTBe∕RL.
(5.76)
Eq. (5.76) does not include the noise sources in the amplifier circuit, such as that coming from resistors and
active elements. Eq. (5.76) can be modified to account for the noise sources within the amplifier as [24, 63]
𝜎2
thermal = 4kBTBeFn∕RL,
(5.77)
where Fn is the amplifier noise factor.

Optical Receivers
227
5.5.3
Signal-to-Noise Ratio, SNR
Let us first consider pin receivers. The mean signal power is
S = I2
PCRL = (RPI)2RL.
(5.78)
Using Eq. (5.72), the mean noise power dissipated in the resistor RL due to the shot noise current is
Nshot =< i2
shot(t) > RL = 2q(IPC + Id)BeRL.
(5.79)
Using Eq. (5.77), the mean noise power due to thermal noise is
Nthermal =< i2
thermalRL >= 4kBTBeFn.
(5.80)
The total mean noise power is
N = Nshot + Nthermal = (𝜎2
shot + 𝜎2
thermal)RL.
(5.81)
The SNR is defined as
SNRpin = mean signal power
mean noise power
= S
N =
I2
PC
𝜎2
shot + 𝜎2
thermal
=
R2P2
I
[2q(RPI + Id) + 4kBTFn∕RL]Be
.
(5.82)
For APD receivers, the signal power is
S = (MRPI)2RL.
(5.83)
Using Eq. (5.73), the SNR can be calculated as
SNRAPD =
(MRPI)2
[2qM2F(RPI + Id) + 4kBTFn∕RL]Be
.
(5.84)
5.6
Coherent Receivers
In the 1990s, coherent detection was pursued mainly because the fiber-optic systems were then loss limited.
Coherent receivers have higher sensitivity than direct detection receivers and, hence, coherent detection is
more attractive for loss-limited systems (see Chapter 7). However, with the development and deployment of
EDFAs in the mid-1990s, fiber loss was no longer a problem and coherent receivers were not pursued due
to the technical hurdles associated with aligning the phase and polarization of the local oscillator (LO) with
those of the received signal. Owing to the rapid advances in digital signal processing (DSP), coherent detec-
tion has drawn renewed interest recently [64–73]. The polarization and phase alignment can be performed
using DSP as discussed in Chapter 11, which is easier than optical phase-locked loop (PLL) used in 1990s’
coherent receivers. Unlike direct detection, coherent detection allows us to retrieve both amplitude and phase
information. The advantages of the coherent receiver are the following. (i) In the case of direct detection, the
detection process is nonlinear–photocurrent is proportional to the absolute square of the optical field. Since
the phase information is lost during the detection, it is hard to compensate for dispersion and polarization

228
Fiber Optic Communications
mode dispersion (PMD) in an electrical domain. In the case of coherent detection, the detection process is
linear–the complex optical field envelope is linearly translated into an electrical domain and, therefore, the
inverse fiber transfer function can be realized using DSP to compensate for dispersion and PMD. (ii) With
coherent detection, higher spectral efficiencies can be realized using multi-level modulation formats that make
use of both amplitude and phase modulation.
5.6.1
Single-Branch Coherent Receiver
In this section, we assume that the polarization of the received signal is perfectly aligned with that of the local
oscillator (LO), and we use scalar notation. The polarization effects are considered in Section 5.6.5. Let the
transmitted signal be
qT(t) = ATs(t) exp (−i𝜔ct),
(5.85)
where s(t) is the complex field envelope, 𝜔c is the frequency of the optical carrier, and A2
T is the peak trans-
mitter power. Let us assume a perfect optical channel that introduces neither distortion nor noise. However,
the phase of the optical carrier changes due to propagation, and the field amplitude may be attenuated. Let
the received signal be
qr(t) = Ars(t) exp [−i(𝜔ct + 𝜙c)]
(5.86)
and the local oscillator output be
qLO(t) = ALO exp [−i(𝜔LOt + 𝜙LO)],
(5.87)
where A2
LO = PLO is the LO power, and 𝜙LO is the phase. These two signals are combined using a 3-dB
coupler and pass through a photodetector (PD), as shown in Fig. 5.301. The photocurrent is proportional to
the absolute square of the incident optical field. Therefore, the photocurrent is
I(t) = R|[qr(t) + qLO(t)]∕
√
2|2
= R
2 {|Ars(t)|2 + |ALO|2 + 2ArALORe {s(t) exp [−i(𝜔IFt + 𝜙c −𝜙LO)]}}
(5.88)
where
𝜔IF = 𝜔c −𝜔LO
(5.89)
Tx
Optical
channel
C
PD
ESP
LO
I(t)
Received
signal
2
[qr(t) + qLO(t)]/
qLO(t)
qr(t)
qT(t)
Figure 5.30
Block diagram of a single-branch coherent receiver. Tx = transmitter, LO = local oscillator, C = 3-dB
coupler, PD = photo-detector, ESP = electrical signal processor.
1 An unbalanced directional coupler can be used to combine the signals to maximize SNR [74]. In this section, a 3-dB coupler is used
for simplicity.

Optical Receivers
229
is called the intermediate frequency. To obtain Eq. (5.88), we have used the formula
Re (X) = (X + X∗)∕2.
(5.90)
When the LO power PLO is much larger than the signal power A2
r, the first term in Eq. (5.88) can be neglected.
Since the LO output is cw, A2
LO is a constant and it leads to a d.c. component in the photocurrent which can be
removed by capacitive coupling from the photodetector to the front end of the electrical amplifier. Therefore,
the signal that goes to the front end can be written as
Id(t) = RArALORe {s(t) exp [−i(𝜔IFt + 𝜙c −𝜙LO)]}.
(5.91)
With
Pr = A2
r,
(5.92)
PLO = A2
LO,
(5.93)
Eq. (5.91) may be rewritten as
Id(t) = R
√
PrPLORe {s(t) exp [−i(𝜔IFt + 𝜙c −𝜙LO)]}.
(5.94)
5.6.1.1
Homodyne Single-Branch Receiver
If 𝜔IF = 0, such a receiver is known as a homodyne receiver. If 𝜔IF < 2𝜋Bs, where Bs is the symbol rate, it
is sometimes referred to as intradyne. Otherwise, it is called a heterodyne receiver. For a homodyne receiver,
the phase of the received carrier 𝜙c should be exactly the same as the phase of the local oscillator. This can
be achieved using an optical phase-locked loop or it can be post-corrected using digital phase estimation
techniques (see Chapter 11). When the phases are exactly aligned (𝜙c = 𝜙LO), Eq. (5.94) can be written as
Id(t) = RP0Re [s(t)],
(5.95)
where P0 =
√
PrPLO. If the transmitted signal is real such as that corresponding to binary OOK or PSK, the
real part of s(t) has all the information required to retrieve the transmitted data. If the transmitted signal is
complex, as in the case of amplitude and phase-modulated signals, in-phase and quadrature (IQ) receivers are
required to estimate the transmitted information, which will be discussed in Sections 5.6.3 and 5.6.4. Note that
in Eq. (5.95), the responsivity R is multiplied by
√
PrPLO. If we choose a very large local oscillator power,
PLO, the effective responsivity, RP0, could be increased and, therefore, the sensitivity of the coherent receiver
was significantly larger than that of the direct detection receiver. This was one of the reasons for pursuing
coherent receivers in the 1980s. If the phase of the local oscillator is not fully aligned with the phase of the
carrier, Eq. (5.94) can be written as
Id(t) = RP0Re [s(t) exp (−iΔ𝜙)],
(5.96)
where Δ𝜙≡𝜙c −𝜙LO is the phase error. If Δ𝜙is 𝜋∕2 and s(t) is 1 within a bit interval, Id(t) = 0 and, therefore,
the phase error leads to bit errors.
Example 5.6
A BPSK-NRZ signal is transmitted over a fiber of length 100 km. The peak power of the signal at the transmit-
ter is 12 dBm. The fiber loss is 0.2 dB/km. Assuming that the receiver is a homodyne single-branch receiver,
find the peak current if (a) LO power = 10 dBm, (b) LO power = −10 dBm. Assume R = 0.9 A/W.

230
Fiber Optic Communications
Solution:
The power at the transmitter,
PT(dBm) = 12 dBm.
Fiber loss,
loss(dB) = 0.2 dB/km × 100 km = 20 dB.
The power at the receiver,
Pr(dBm) = PT(dBm) −loss(dB) = (12 −20) dBm = −8 dBm.
(a)
PLO(dBm) = 10 dBm,
PLO = 100.1PLO(dBm) mW = 10 mW,
Pr = 100.1Pr(dBm) mW = 0.1585 mW.
For a BPSK signal assuming rectangular NRZ pulses, s(t) takes values ±1. From Eq. (5.95), we have
Peak current = |Id| = R
√
PrPLO = 0.9 ×
√
10 × 0.1585 mA
= 1.1331 mA.
If we use Eq. (5.88) after ignoring the d.c. term, we find the peak current as
|I| = RPr∕2 + R
√
PrPLO = 1.204 mA.
(5.97)
Note that |I| ≈|Id|. The difference |I −Id| is known as intermodulation cross-talk.
(b)
PLO(dBm) = −10 dBm,
PLO = 100.1×−10 mW = 0.1 mW,
|Id| = 0.9
√
0.1 × 0.1585 = 0.1133 mA.
The peak current |I| after ignoring the d.c. term is
|I| = RPr∕2 + R
√
PrPLO = 0.1846 mA.
(5.98)
In this case, the intermodulation cross-talk is comparable to Id.
5.6.1.2
Heterodyne Single-Branch Receiver
When the frequency offset between the transmitter laser and LO is in the microwave range, the signal Id(t)
given by Eq. (5.91) may be interpreted as the message s(t) modulating the microwave carrier of frequency 𝜔IF.
Let us assume that s(t) is real and Eq. (5.91) can be written as
Id(t) = I0s(t) cos (𝜔IFt + Δ𝜙),
(5.99)

Optical Receivers
231
where I0 = RP0. The corresponding signal spectrum is shown in Fig. 5.31(b). Suppose the bandwidth of the
signal s(t) is 𝜔B∕2𝜋(Fig. 5.31(a)). The bandwidth of Id(t) is 2𝜔B, as shown in Fig. 5.31(b). The photocurrent
Id(t) in a homodyne receiver is proportional to s(t) and, therefore, the bandwidth of the homodyne receiver
circuit is approximately 𝜔B∕2𝜋, whereas the signal spectrum is centered around 𝜔IF in the case of a hetero-
dyne receiver with bandwidth 𝜔B∕𝜋. Therefore, the bandwidth of the heterodyne receiver circuit should be
approximately (𝜔IF + 𝜔B)∕(2𝜋). The large bandwidth requirement is one of the disadvantages of the hetero-
dyne receiver. The signal Id(t) is multiplied by a microwave oscillator whose phase is aligned with that of
Id(t), as shown in Fig. 5.32. The resulting signal is
I1(t) = I0s(t)cos2 (𝜔IFt + Δ𝜙) = I0s(t)
2
{1 + cos [2(𝜔IF + Δ𝜙)]}.
(5.100)
The first term on the right-hand side of Eq. (5.100) corresponds to the baseband and the second term cor-
responds to a signal with its spectrum centered around 2𝜔IF, as shown in Fig. 5.33. If we introduce a LPF
Angular frequency
I0s (ω) / 2
–ωIF
ωIF
2ωB
(a)
(b)
Angular frequency
Id (ω)
˜
˜
s (ω)
˜
ωB
Figure 5.31
(a) Signal spectrum at the transmitter. (b) Signal spectrum after the photo-detector.
Heterodyne
receiver
front end
MLO
X
LPF
cos(ωIFt + ∆ϕ)
s(t)I0 cos(ωIFt + ∆ϕ)
s(t)I0 cos2(ωIFt + ∆ϕ)
I0s(t) / 2
Figure 5.32
Block diagram of a single-branch heterodyne receiver. MLO = microwave local oscillator, LPF = low-pass
filter.

232
Fiber Optic Communications
Low-pass filter
Angular frequency
(b)
–2ωIF
ωB
2ωIF
Figure 5.33
Signal spectrum after multiplication.
with its bandwidth roughly equal to the bandwidth of s(t) (= 𝜔B∕2𝜋), shown in Fig. 5.32, we can remove the
spectrum centered around 2𝜔IF. After passing through the LPF, the final output is
I2(t) = I0s(t)
2
,
(5.101)
which is proportional to the transmitted signal s(t). Historically, homodyne receivers required optical
phase-locked loops to align the phase of the LO with the received carrier. For heterodyne receivers, it is not
essential to employ the optical PLL to align the phase of the optical carrier with the phase of the optical
LO. This is because the phase of Id(t) can be arbitrary. However, the microwave LO phase should be aligned
with Id(t) using an electrical PLL. The electrical PLL is easier to implement than an optical PLL. However,
with the advent of high-speed digital signal processors, phase estimation can be done in the digital domain
for homodyne/heterodyne systems and, therefore, analog optical/electrical PLL is no longer required (see
Chapter 11).
5.6.2
Balanced Coherent Receiver
In the case of a single-branch receiver, the intermodulation cross-talk (|Ars(t)|2 of Eq. (5.88)) can lead to
penalty unless the LO power is very large. This problem can be avoided by using the balanced receiver shown
in Fig. 5.34. The outputs of the optical channel and local oscillator are connected to a directional coupler
(DC). The directional coupler is a two-input/two-output device. The DC can be fabricated by bringing two
optical waveguides or fibers very close, as shown in Fig. 5.35. If the light is launched to the DC through
input port In 1 only, it gets coupled to the waveguide 2. The length L and spacing d can be chosen so that
at the output, the power is equally distributed between output ports Out 1 and Out 2. In this case, the DC
acts as a 3-dB power splitter. Let qin
j and qout
j
be the optical fields at the input port In j and output port Out j,
respectively. The output fields when qin
2 = 0 can be written as
|qout
1 | = |qin
1 |∕
√
2,
(5.102)
|qout
2 | = |qin
1 |∕
√
2.
(5.103)
When qin
2 ≠0, the DC can be designed such that the output fields can be given by [75]
qout
1
= (qin
1 −iqin
2 )∕
√
2,
(5.104)
qout
2
= (−iqin
1 + qin
2 )∕
√
2.
(5.105)

Optical Receivers
233
Tx
Optical
channel 
DC
PD1
PD2
ESP
LO
+
–
Σ
I+
I–
ALO exp[–i(ωLOt + ϕLO)]
As(t)exp[–i(ωct + ϕc)]
I = I+ – I– 
Figure 5.34
Block diagram of a balanced coherent receiver. Tx = transmitter, DC = directional coupler, PD = photode-
tector, ESP = electronic signal processing.
In 1 
Waveguide 1 
Waveguide 2 
d
q1
in
q1
out
q2
out
q2
in In 2 
Out 1 
Out 2 
L
Figure 5.35
Directional coupler.
In other words, the transfer function of the DC is
TDC =
1
√
2
[
1 −i
−i 1
]
.
(5.106)
In Fig. 5.34, the received signal field and local oscillator output are the input fields of the DC. The DC
outputs with these inputs are
qout
1
= {Ars(t) exp [−i(𝜔ct + 𝜙c)] −iALO exp [−i(𝜔LOt + 𝜙LO)]}∕
√
2,
(5.107)
qout
2
= {−iArs(t) exp [−i(𝜔ct + 𝜙c)] + ALO exp [−i(𝜔LOt + 𝜙LO)]}∕
√
2.
(5.108)
The outputs of the DC are fed to two identical photo-detectors. The photocurrents are given by
I+(t) = R|qout
1 |2
= R
2 {A2
r|s(t)|2 + A2
LO −2ArALOIm{s(t) exp [−i(𝜔IFt + Δ𝜙)]}},
(5.109)
I−(t) = R|qout
2 |2
= R
2 {A2
r|s(t)|2 + A2
LO + 2ArALOIm{s(t) exp [−i(𝜔IFt + Δ𝜙)]}}.
(5.110)

234
Fiber Optic Communications
Id(t) = I+(t) −I−(t) = −2RArALOIm{s(t) exp [−i(𝜔IFt + Δ𝜙)]}.
(5.111)
From Eq. (5.111), we see that the intermodulation cross-talk and DC terms are canceled because of the bal-
anced detection. For homodyne receivers, 𝜔IF = 0. When Δ𝜙= 𝜋∕2, Eq. (5.111) becomes
Id(t) = 2RP0Re {s(t)}.
(5.112)
For binary modulation schemes, s(t) is real and in this case the current is proportional to the received signal
s(t). For M-ary signals, s(t) is complex and an IQ receiver is required, which is discussed in Sections 5.6.3
and 5.6.4. For a heterodyne receiver, the current Id(t) should be multiplied by a microwave carrier, as is done
in Section 5.6.1.2.
Example 5.7
Repeat Example 5.6 assuming that the balanced receiver is used instead of the single-branch receiver. Com-
ment on the intermodulation cross-talk in a single-branch receiver and the balanced receiver.
Solution:
From Eq. (5.112), we have
|Id(t)| = 2RP0.
(a)
PLO = 10 mW,
P0 =
√
PrPLO = 1.259 mW,
|Id(t)| = 2 × 0.9 × 1.259 mW = 2.2662 mW.
(b)
PLO = 0.1 mW,
P0 =
√
PrPLO = 0.1258 mW,
|Id(t)| = 2 × 0.9 × 0.1258 mA = 0.2266 mA.
Since PLO < Pr, in the case of a single-branch receiver, the first term in Eq. (5.88) cannot be ignored. There-
fore, a single-branch receiver would have a significant amount of cross-talk. In contrast, for a balanced
receiver, intermodulation cross-talk is canceled out due to the balanced detection (see Eqs. (5.109)–(5.112)).
5.6.3
Single-Branch IQ Coherent Receiver
So far we have assumed that the message signal s(t) is real. Now we consider a more generalized case, in which
s(t) is complex. The examples of complex signals are multi-level PSK and QAM. To recover the real part of
s(t), the LO phase should be aligned with that of the optical carrier. Similarly, to recover the imaginary part of
s(t), the LO phase should be shifted by 𝜋∕2(exp (i𝜋∕2) = i) with respect to the optical carrier. Fig. 5.36 shows
a block diagram of the single-branch IQ coherent receiver. The received signal and LO outputs are divided

Optical Receivers
235
PD1
ESP
LO
PD2
2
π
Received signal
PS
C
PS
Phase-shifter
C
qr(t)
IQ
II
qLO(t)
qr(t)/  2
  qr(t)/  2
  qLO(t)/  2
  qLO(t)/  2
qout, I(t)
qout,Q(t)
    2×2  90o hybrid 
Figure 5.36
Block diagram of a single-branch IQ receiver. PS = power splitter, C = combiner, LO = local oscillator,
PD = photodetector, ESP = electrical signal processor.
into two parts using power splitters and are mixed together as done in Section 5.6.1. Let us first consider the
in-phase component. The optical input of PD1 is
qout,I(t) =
1
√
2
[
qr(t)
√
2
+ qLO(t)
√
2
]
.
(5.113)
The corresponding photocurrent after ignoring the intermodulation cross-talk and DC terms is (see Section
5.6.1)
II(t) = R|qout,I|2
(5.114)
≈RArALO
2
Re {s(t) exp [−i(𝜔IFt + Δ𝜙)]}
≈RArALO
2
|s(t)| cos (𝜔IFt + 𝜙s(t) + Δ𝜙),
(5.115)
where
s(t) = |s(t)| exp [−i𝜙s(t)].
(5.116)
The other part of the LO is 90∘phase-shifted and is mixed with the received signal. The optical input of PD2
is
qout,Q(t) =
1
√
2
[
qr(t)
√
2
+ iqLO(t)
√
2
]
.
(5.117)

236
Fiber Optic Communications
Note that i = ei𝜋∕2 corresponding to a 90∘phase shift as shown in Fig. 5.36. The corresponding photocurrent
is
IQ(t) = R|qout,Q|2
(5.118)
≈RArALO
2
Im{s(t) exp [−i(𝜔IFt + Δ𝜙)]}
≈RArALO
2
|s(t)| sin (𝜔IFt + 𝜙s(t) + Δ𝜙).
(5.119)
To obtain Eq. (5.118), we have used the formula
2iIm{X} = (X −X∗).
(5.120)
For a homodyne receiver, 𝜔IF = 0 and when the phase mismatch Δ𝜙= 0, we have
II(t) = RArALO
2
Re [s(t)],
(5.121)
IQ(t) = RArALO
2
Im [s(t)].
(5.122)
The electrical signal processing unit forms the complex current I(t) = II(t) + iIQ(t) = RArALOs(t)∕2. Thus, the
transmitted complex signal could be retrieved. In Fig. 5.36, the components inside the rectangle constitute a
2 × 2 90∘optical hybrid. It is a device with two inputs and two outputs, as shown in Fig. 5.37. The transfer
matrix of an ideal 2 × 2 90∘hybrid can be written as
T = 1
2
[
1 1
1 i
]
.
(5.123)
Let the input of the 2 × 2 90∘hybrid be
qin =
[
qr(t)
qLO(t)
]
,
(5.124)
where qr(t) and qLO(t) are the complex fields of received signal and local oscillator, respectively, as shown in
Fig. 5.37. Let the outputs of the 2 × 2 90∘hybrid be
qout =
[qout,I
qout,Q
]
.
(5.125)
Now, Eqs. (5.113) and (5.117) can be rewritten as
qout = Tqin.
(5.126)
Tx
PD1
ESP
LO
PD2
Channel
qr
II
qLO
qout,I
qout,Q
IQ
2 × 2  90°
Hybrid 
Figure 5.37
Single-branch coherent IQ receiver using a 2 × 2 90∘hybrid.

Optical Receivers
237
PD1
LO
Received signal
PS
DC 1
PS
2
π
Phase-shifter
PD2
ESP
Σ
IQ+
IQ−
IQ = IQ+ −IQ−
II = II+ −II−
PD3
PD4
ESP
Σ
II+
II−
q1
out
q2
out
q3
out
q4
out
    2 × 4  90° hybrid 
DC 2
+
‒
+
‒
Figure 5.38
Block diagram of a balanced IQ receiver. DC = directional coupler, PS = power splitter, LO = local
oscillator, PD = Photodetector.
5.6.4
Balanced IQ Receiver
It is straightforward to modify the block diagram of Fig. 5.36 to obtain the balanced IQ receiver, shown in
Fig. 5.38. The inputs of DC1 are
qin
1 = qr
√
2
,
(5.127)
qin
2 = qLO
√
2
.
(5.128)
The transfer function of DC1 is given by Eq. (5.106),
TDC =
1
√
2
[
1 −i
−i 1
]
.
(5.129)
Therefore, the output of DC1 is
qout = Tdcqin,
(5.130)
qout
1
= 1
2[qr −iqLO],
(5.131)

238
Fiber Optic Communications
qout
2
= 1
2[−iqr + qLO],
(5.132)
qout =
[
qout
1
qout
2
]
.
(5.133)
The photocurrents IQ+ and IQ−can be calculated as in Section 5.6.2. Proceeding as before, the quadrature
current IQ is given by
IQ = IQ+ −IQ−
(5.134)
= −RArALOIm {s(t) exp [−i(𝜔IFt + Δ𝜙)]}.
(5.135)
For the I-branch, the LO output is phase-shifted by 90∘. The in-phase component of the current is
II = II+ −II−
(5.136)
= RArALORe {s(t) exp [−i(𝜔IFt + Δ𝜙)]}.
(5.137)
For homodyne receivers, 𝜔IF = 0. When Δ𝜙= 0, from Eqs. (5.136) and (5.134), we find
II = RArALORe {s(t)},
(5.138)
IQ = −RArALOIm {s(t)},
(5.139)
I = II −iIQ = RArALOs(t).
(5.140)
The components inside the rectangular line constitute a 2 × 4 90∘hybrid. The transfer matrix of the 2 × 4 90∘
hybrid can be written as
T =
⎡
⎢
⎢
⎢⎣
1 −i
−i 1
1
1
−i i
⎤
⎥
⎥
⎥⎦
.
(5.141)
Let the output of the 2 × 4 90∘hybrid be
qout =
⎡
⎢
⎢
⎢
⎢
⎢⎣
q1
out
q2
out
q3
out
q4
out
⎤
⎥
⎥
⎥
⎥
⎥⎦
.
(5.142)
Now, the input–output relationship of the 2 × 4 90∘hybrid can be written as
qout = Tqin.
(5.143)
Example 5.8
Repeat Example 5.7(a) with the BPSK signal replaced by the QPSK signal. Let s(t) be 1∠3𝜋∕4. Find the
in-phase and quadrature components of the current of a balanced IQ receiver.

Optical Receivers
239
Solution:
PLO = 10 mW,
s(t) = ei3𝜋∕4 = −1
√
2
+ i 1
√
2
,
Pr = 0.1585 mW,
P0 =
√
PrPLO = 1.259 mW.
From Eq. (5.138), we find the in-phase component of the current as
II = RP0Re [s(t)] = 0.9 × 1.259 × −1
√
2
mA = −0.8012 mA.
From Eq. (5.139), we find
IQ = −RP0Im [s(t)] = −0.9 × 1.259 ×
1
√
2
mA = −0.8012 mA.
5.6.5
Polarization Effects
So far we have ignored the state of polarization of light. In this section, we consider the optical signal modu-
lated in orthogonal polarizations. Let the transmitted signal be
qT =
[qT,x
qT,y
]
,
(5.144)
where
qT,x = AT
√
2
sx(t) exp (−i𝜔ct),
(5.145)
qT,y = AT
√
2
sy(t) exp (−i𝜔ct),
(5.146)
sx(t) and sy(t) are the data in x- and y-polarizations, respectively. In fiber, the propagation constants of x-
and y-polarization components are slightly different due to a possible asymmetry in fiber geometry and, as
a result, these components acquire different amounts of phase shift. Besides, because of the perturbations
during the propagation, there is a power transfer between the x- and y-components. These effects can be taken
into account by a channel matrix (see Chapter 2):
M =
[Mxx Mxy
Myx Myy
]
.
(5.147)
The output of the fiber-optic link may be written as
qr =
[qr,x
qr,y
]
= MqT,
(5.148)
qr,x = [MxxqT,x + MxyqT,y]ei𝜙c,
(5.149)
qr,y = [MyxqT,x + MyyqT,y]ei𝜙c,
(5.150)

240
Fiber Optic Communications
where 𝜙c is the common phase of both polarizations. Owing to fluctuations in ambient properties, the matrix
M changes with time. Typically, the rate of change of the matrix elements of M is much slower than the
transmission data rate. Therefore, the matrix elements can be estimated using digital signal processing, which
is discussed in Chapter 11.
Let the output of the local oscillator be
qLO =
[qLO,x
qLO,y
]
,
(5.151)
qLO,j = ALO
√
2
exp [−i(𝜔LOt + 𝜙LO)],
j = x or y.
(5.152)
Fig. 5.39 shows a schematic of the receiver. The x- and y-components of the received field and LO output are
separated using polarization beam splitters PBS1 and PBS2, respectively. The x-components of the received
field and the LO output are combined using a 2 × 4 90∘optical hybrid and pass through the four photodetectors
as discussed in Section 5.6.4. With 𝜔IF = Δ𝜙= 0, the outputs II,x and IQ,x are given by
II,x = RATALO
2
Re [Mxxsx + Mxysy],
(5.153)
PBS1
PBS2
    2 × 4  90o
optical hybrid 
    2 × 4  90o
optical hybrid 
Σ
II+,x
II+,y
II,y
IQ,y
IQ+,x
IQ+,y
IQ,x
II,x
II*,x
IQ*,x
II*,y
IQ*,y
Σ
Σ
Σ
qr
qLO
qr,x
qr,y
qLO,x
qLO,y
+
‒
+
‒
+
‒
+
‒
Figure 5.39
Block diagram of a dual polarization IQ receiver PBS = polarization beam splitter, LO = local oscillator.

Optical Receivers
241
IQ,x = −RATALO
2
Im [Mxxsx + Mxysy].
(5.154)
The complex photocurrent corresponding to x-polarization is
Ix = II,x −iIQ,x
(5.155)
= RATALO
2
[Mxxsx + Mxysy].
(5.156)
Similarly, the y-components of the received field and LO output pass through a second balanced IQ receiver.
Its outputs are
IQ,x = RATALO
2
Re [Myxsx + Myysy],
(5.157)
IQ,y = −RATALO
2
Im [Myxsx + Myysy].
(5.158)
The complex photocurrent corresponding to y-polarization is
Iy = II,y −iIQ,y
(5.159)
= RATALO
2
[Myxsx + Myysy].
(5.160)
Eqs. (5.156) and (5.159) can be rewritten as
RATALO
2
[Mxx Mxy
Myx Myy
] [sx
sy
]
=
[Ix
Iy
]
.
(5.161)
In the DSP unit of the coherent receiver, the matrix elements of M are adaptively estimated and its inverse is
calculated (see Chapter 11). Multiplying Eq. (5.161) by M−1, we find
[sx
sy
]
=
2
RATALO
M−1
[Ix
Iy
]
.
(5.162)
Thus, the transmitted data can be estimated using Eq. (5.162).
Example 5.9
Repeat Example 5.8 with a polarization modulated (PM) QPSK signal given by
s(t) =
[sx
sy
]
=
[
1∠𝜋∕4
1∠5𝜋∕4
]
.
Assume M to be of the form
M =
[
1 0
0 1
]
e−𝛼L∕2,

242
Fiber Optic Communications
where 𝛼is the fiber-loss coefficient and L is the transmission distance. From Eq. (5.161), we have
Ix = RATALO
2
e−𝛼L∕2sx
= RArALO
2
sx
= RP0
2 sx
= 0.9 × 1.259
2
1∠𝜋∕4 mA = 0.566∠𝜋∕4,
II,x = Re (Ix) = 0.4006 mA,
IQ,x = −Im (Ix) = −0.4006 mA.
Similarly,
Iy = RATALO
2
e−𝛼L∕2sy
= RArALO
2
sy
= RP0
2 sy
= 0.9 × 1.259
2
1∠5𝜋∕4 mA = 0.566∠5𝜋∕4,
II,y = Re (Iy) = −0.4006 mA,
IQ,y = −Im (Iy) = 0.4006 mA.
Exercises
5.1
Compare qualitatively the features of a direct detection receiver with a coherent detection one.
5.2
Discuss the strengths and weaknesses of pn, pin, and Schottky barrier photodiodes. Which one would
you choose for a 10-Gb/s fiber-optic receiver? State the reasons for your choice of structure.
5.3
Compare the characteristics of avalanche photodiodes and pin photodiodes. Which one would you
choose for a 10-Gb/s fiber-optic receiver? If the bit rate is increased to more than 40 Gb/s, would your
choice remain the same or would you switch to the other photodiode. Why?
5.4
Avalanche photodiodes can be made as in the following structures: normal pn junctions, SAM, SACM,
and SAGCM. Compare and contrast the characteristics of each structure. Which structure is most
suitable for a low-Gb/s fiber-optic receiver?
5.5
Discuss the key design features of a RCE photodiode.

Optical Receivers
243
5.6
Compare vertical illumination RCE, edge-coupled, and waveguide-coupled photodiode structures. Dis-
cuss how each structure addresses the bandwidth–quantum efficiency trade-off. Discuss also their ease
of manufacturing.
5.7
The band-gap energy of diamond and silicon carbide is 5.5 eV and 3.0 eV, respectively. Determine their
long-wavelength cutoff values.
5.8
A 500-nm light source delivers 10 μW of power uniformly on a photodetector with a photosensitive
area of 400 μm2. Determine the light intensity in W/cm2. Next, determine the photon flux per unit time,
that is, the number of photons/cm2/s. If the quantum efficiency of this photodiode is 90%, what is its
responsivity?
5.9
A large-area photodiode has a radius of 200 μm and is used to detect light at 650 nm. When illuminated
with light at 100 μW/cm2, 60 nA of photocurrent flows in the detector. Determine the photodiode’s
responsivity and quantum efficiency.
5.10
Given the responsivity of a photodiode of 0.6 A/W for light at 900 nm, what is its quantum efficiency?
For the same quantum efficiency, if the wavelength is decreased to 400 nm, what is the new value of
the responsivity?
5.11
The wavelength of the laser diode in a music CD player is ∼800 nm and the ideal responsivity of the
photodiode is ∼0.6 A/W. If the laser diode emits 2 mW, how much current flows in the photodiode?
5.12
The refractive index of silicon is 3.5. If light is incident from air onto a silicon photodiode, how much
of it is lost through reflection. Describe quantitatively how you would reduce this reflection loss.
5.13
The noise equivalent power (NEP) of a photodiode is defined as the ratio of the root-mean-square
(r.m.s.) noise current to its responsivity. If the current in a photodiode is 1 nA (gives shot noise), its
shunt resistance is 0.5 GΩ (gives thermal noise), and its responsivity is 0.6 A/W, then for a bandwidth
of 1 Hz, determine the total noise current (in A) and the NEP (in W). The electronic charge is 1.6 ×
10−19 C and Boltzmann’s constant is 1.38 × 10−23 J/K. Assume that the photodiode is operating at
room temperature or 300 K.
5.14
A commercial silicon photodiode has a responsivity of 0.6 A/W at 850 nm and a NEP in a 1-Hz band-
width of 40 fW. Determine the total r.m.s noise of the photodiode.
5.15
Plot the excess noise factor F versus multiplication M for various values of the ratio of ionization
coefficients k (where k = 𝛼∕𝛽) is varied from 0 to 1.0 in steps of 0.1. Comment on your results.
5.16
The impact ionization for electrons and holes is given by
(𝛼, 𝛽) = qF
Ei
exp
⎧
⎪
⎨
⎪⎩
0.217
( Ei
Er
)1.14
−
√
√
√
√
√
[
0.217
( Ei
Er
)1.14]2
+
[ Ei
qF𝜆
]2⎫
⎪
⎬
⎪⎭
(5.163)
with
Er
Ero
= 𝜆
𝜆0
= tanh (Ero∕2kT),
(5.164)
where F is the electric field, Ei is the threshold energy, 𝜆and 𝜆0 are the mean free path, and Er and Ero
are the optical phonon energy at temperatures T K and 0 K respectively. Given that Ero = 28.4 meV

244
Fiber Optic Communications
and for electrons: 𝜆e = 55 Å, 𝜆o = 100 Å, Ei,e = 0.682 eV, and for holes: 𝜆h = 56 Å, 𝜆o = 112 Å, and
Ei,h = 1.2 eV, plot the ionization coefficients versus 1∕F2 for F between 105 V/cm and 4 × 105 V/cm.
5.17
Explain the different types of noise mechanism in a pin receiver.
5.18
Explain the differences between homodyne and heterodyne coherent receivers. Which of these
receivers requires a larger bandwidth?
References
[1] M.J. Deen and P.K. Basu, Silicon Photonics – Fundamentals and Devices. John Wiley & Sons, New York, 2012.
[2] A. Bandyopadhyay and M.J. Deen. In H.S. Nalwa (ed.), Photodetectors and Fiber Optics. Academic Press, New
York, pp. 307–368, 2001.
[3] G.P. Agrawal, Fiber-Optic Communication System, 4th edn. John Wiley & Sons, Hoboken, NJ, 2010.
[4] G. Keiser, Optical Fiber Optic Communications, 4th edn. McGraw-Hill, New York, p. 688, 2010.
[5] J. Burm et al., IEEE Photon. Technol. Lett., vol. 6, p. 722, 1994.
[6] Y.-G. Wey et al., IEEE J. Lightwave Technol., vol. 13, p. 1490, 1995.
[7] K.S. Giboney et al., IEEE Photon. Technol. Lett., vol. 7, p. 412, 1995.
[8] Y.C. Lim and R.A. Moore, IEEE Trans. Electron Dev., vol. 15, p. 173, 1968.
[9] D.P. Prakash et al., IEEE Photon. Technol. Lett., vol. 9, p. 800, 1997.
[10] Z. Bielecki, IEEE Proc.-Optoelectron., vol. 147, p. 234, 2000.
[11] M.A. Itzler et al., Optical Fiber Communication Conference, vol. 4, p. 126, 2000.
[12] A.H. Gnauck, C.A. Burrus, and D.T. Ekholm, IEEE Photon. Technol. Lett., vol. 4, p. 468, 1992.
[13] T.Y. Yun et al., IEEE Photon. Technol. Lett., vol. 8, p. 1232, 1996.
[14] A. Torres-J and E.A. Gutiérrez-D, IEEE Electron Dev. Lett., vol. 18, p. 568, 1997.
[15] A.G. Chynoweth, Semiconductors and Semimetals, Vol. 4. Academic Press, New York, 1968.
[16] G.E. Stillman and C.M. Wolfe, Semiconductor and Semimetals, Vol. 12. Academic Press, New York, 1977.
[17] Y. Okuto and C.R. Crowell, Phys. Rev. B, vol. 6, p. 3076, 1972.
[18] F. Capasso, Semiconductors and Semimetals, Vol. 22D. Academic Press, New York, 1985.
[19] Y. Okuto and C.R. Crowell, Phys. Rev. B, vol. 10, p. 4284, 1974.
[20] G.A. Baraff, Phys. Rev., vol. 128, p. 2507, 1962; vol. 133, p. A26, 1964.
[21] C.L.F. Ma, M.J. Deen, and L. Tarof, Adv. Imag. Electron Phys., vol. 99, p. 65, 1998.
[22] M. Casalino et al., Physica E: Low-dimensional Systems and Nanostructures, Proceedings of the E-MRS 2008
Symposium C: Frontiers in Silicon-Based Photonics, Vol. 41, p. 1097, 2009.
[23] C. Li et al., J. Appl. Phys., vol. 92, p. 1718, 2002.
[24] M. Ghioni et al., IEEE Trans. Electron Dev., vol. 43, p. 1054, 1996.
[25] N.R. Das and M.J. Deen, J. Vac. Sci. Technol. A, vol. 20, p. 1105, 2002.
[26] N.R. Das and M.J. Deen, IEEE J. Quant. Electron., vol. 37, p. 1574, 2001.
[27] N.R. Das and M.J. Deen, IEEE J. Quant. Electron., vol. 37, p. 69, 2001.
[28] G. Kinsey et al., IEEE Photon. Technol. Lett., vol. 10, p. 1142, 1998.
[29] R.G. Decorby, A.J.P. Hnatiw, and G. Hillier, IEEE Photon. Technol. Lett., vol. 11, p. 1165, 1999.
[30] H. Nie et al., IEEE Photon. Technol. Lett., vol. 10, p. 409, 1998.
[31] C. Lenox et al., IEEE Photon. Technol. Lett., vol. 11, p. 1162, 1999.
[32] M.S. Ünlü and S. Strite, J. Appl. Phys., vol. 78, p. 607, 1995.
[33] H.H. Tung and C.P. Lee, IEEE J. Quant. Electron., vol. 33, p. 753, 1997.
[34] J.A. Jervase and Y. Zebda, IEEE J. Quant. Electron., vol. 34, p. 1129, 1998.
[35] A. Umbach, M. Leone, and G. Unterbrsch, J. Appl. Phys., vol. 81, p. 2511, 1997.
[36] L. Giraaudet et al., IEEE Photon. Technol. Lett., vol. 11, p. 111, 1999.
[37] K. Kato, IEEE Trans. Microw. Theory Tech., vol. 47, p. 1265, 1999.
[38] C.L. Ho et al., IEEE J. Quant. Electron., vol. 36, p. 333, 2000.

Optical Receivers
245
[39] St. Kollakowski et al., IEEE Photon. Technol. Lett., vol. 9, p. 496, 1997.
[40] G.S. Kinsey et al., IEEE Photon. Technol. Lett., vol. 12, p. 416, 2000.
[41] K. Kishino et al., IEEE J. Quant. Electron., vol. 27, p. 2025, 1991.
[42] C. Li et al., IEEE Photon. Technol. J., vol. 12, p. 1373, 2000.
[43] Y. Ardeshirpour and M.J. Deen, CMOS photodetectors, unpublished results, 2005.
[44] G. Sasaki et al., Electron. Lett., vol. 24, p. 1201, 1988.
[45] Y. Akatsu et al., IEEE Photon. Technol. Lett., vol. 5, p. 163, 1993.
[46] S. Chandrasekhar et al., Electron. Lett., vol. 26, p. 1880, 1990.
[47] K.D. Pedrotti et al., IEEE GaAs IC Symposium, p. 205, 1991.
[48] K. Takahata et al., Electron. Lett., vol. 33, p. 1576, 1997.
[49] E. Sano et al., J. Lightwave Technol., vol. 12, p. 638, 1994.
[50] J. Cowles et al., IEEE Photon. Technol. Lett., vol. 6, p. 963, 1994.
[51] K. Yang et al., J. Lightwave Technol., vol. 14, p. 1831, 1996.
[52] E. Sano et al., IEEE Trans. Electron Dev., vol. 43, p. 1826, 1996.
[53] D. Huber et al., Electron. Lett., vol. 35, p. 40, 1999.
[54] D. Huber et al., J. Lightwave Technol., vol. 18, p. 992, 2000.
[55] P. Fay et al., J. Lightwave Technol., vol. 15, p. 1871, 1997.
[56] P. Fay, C. Caneau, and I. Adesida, IEEE Proceedings on Microwave and Optoelectronics Conference, SBMO/IEEE
MTT-S IMOC’99, Vol. 2, p. 537, 1999.
[57] P. Fay et al., IEEE Photon. Technol. Lett., vol. 9, p. 991, 1997.
[58] U. Hodel et al., Proceedings of the International Conference on Indium Phosphide and Related Compounds/2000,
p. 466, 2000.
[59] P. Bhattacharya, Semiconductor Optoelectronic Devices. Prentice-Hall, Englewood Cliffs, NJ, 1994.
[60] N.R. Das, P.K. Basu, and M.J. Deen, IEEE Trans. Electron Dev., vol. 47, p. 2101, 2000.
[61] B.E.A. Saleh and M.C. Teich, Fundamentals of Photonics, 2nd edn. John Wiley & Sons, Hoboken, NJ, 2007.
[62] R.J. McIntyre, IEEE Trans. Electron. Dev., vol. 19, p. 703, 1972; vol. 13, p. 164, 1966.
[63] J.M. Senior, Optical Fiber Communications, 2nd edn. Prentice-Hall, London, 1992.
[64] Y. Han and G. Li, Opt. Expr., vol. 13, p. 7527, 2005.
[65] K. Kikuchi and S. Tsukamoto, J. Lightwave Technol., vol. 26, p. 1817, 2008.
[66] B. Zhang et al., Opt. Expr., vol. 20, p. 3225, 2012.
[67] S.J. Savory, IEEE J. Select. Top. Quant. Electron., vol. 16, p. 1164, 2010.
[68] C.R. Doerr et al., IEEE Photon. Technol. Lett., vol. 23, p. 694, 2011.
[69] K. Kikuchi. In I.P. Kaminow, T. Li, and A.E. Willner (eds), Optical Fiber Telecommunications, V, Vol. B. Elsevier,
Amsterdam, chapter 3, 2008.
[70] M. Birk et al., J. Lightwave Technol., vol. 29, p. 417, 2011.
[71] Y. Painchaud et al., Opt. Expr., vol. 17, p. 3659, 2009.
[72] D.-S. Ly-Gagnon et al., J. Lightwave Technol., vol. 29, p. 12, 2006.
[73] E. Ip et al., Opt. Expr., vol. 16, p. 758, 2008.
[74] S. Betti, G. DeMarchis, and E. Iannone, Coherent Optical Communication Systems. John Wiley & Sons, New York,
1995.
[75] K. Okamoto, Fundamentals of Optical Waveguides. Academic Press, San Diego, 2000.


6
Optical Amplifiers
6.1
Introduction
The optical amplifier may be considered as a laser without feedback, or one in which the feedback is
suppressed. In the 1980s, optical amplifiers were not commercially available and long-haul fiber-optic
communication systems used electrical amplifiers to compensate for the fiber loss. The optical signal was
first converted to the electrical signal (O/E conversion) using a photodetector and then converted back
to the optical domain (E/O conversion) after amplification in the electrical domain. However, this type of
optoelectronic regenerator is expensive for multi-channel optical communication systems. With the advent of
optical amplifiers, the optical signal can be amplified directly without having to do O/E and E/O conversion.
There are different physical mechanisms that can be used to amplify the optical signal. In semiconductor
optical amplifiers (SOAs), an electrical pump (power supply) is used to achieve population inversion. In the
presence of signal photons that have energy close to the band gap, electrons are stimulated to recombine with
holes and, thereby, emit photons due to stimulated emission. Thus, the input signal photons are amplified.
In EDFAs, an optical pump is used to achieve population inversion. In the presence of signal photons, the
erbium ions in the excited state emit light by stimulated emission and make transitions to the ground state. In
Raman amplifiers, an optical pump gives up its energy to create a signal photon of lower energy and the rest
appears as molecular vibration (or optical photons). This is known as stimulated Raman scattering (SRS). If
a signal photon of lower energy is already present, it is amplified by SRS.
In this chapter, we focus mainly on three types of optical amplifiers: (1) the semiconductor optical amplifier,
(2) the erbium-doped fibers amplifier, and (3) the Raman amplifier. In each case, the physical principles,
governing equations, noise amplifications, and practical applications are discussed. From Sections 6.2 to 6.5,
we consider a generic amplifier and the system impact of noise is discussed. In Sections 6.6 to 6.8, we focus
on specific amplifiers.
6.2
Optical Amplifier Model
In Sections 6.2 to 6.5, we consider a simple amplifier model in which the amplifier magnifies the input power
by a factor of G and adds white noise, as shown in Fig. 6.1. Let the signal field envelope at the input and
output of an amplifier be 𝜓in and 𝜓out, respectively. They are related by
𝜓out =
√
G𝜓in
(6.1)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

248
Fiber Optic Communications
G
ψin
ψout (=   Gψin) + n
Figure 6.1
Simple amplifier model.
or
Pout = |𝜓out|2 = G|𝜓in|2 = GPin,
(6.2)
where G is the amplifier power gain. The amplifier adds noise n(t) and the total field envelope at the amplifier
output is
𝜓tot = 𝜓out + n(t) =
√
G𝜓in + n(t).
(6.3)
The gain is provided by the stimulated emission and the noise in the amplifier is mainly due to the spontaneous
emission, which is discussed in the next section. We assume that the samples of n(t) are identically distributed
Gaussian complex random variables.
6.3
Amplified Spontaneous Emission in Two-Level Systems
The light wave generated due to stimulated emission has the same polarization, frequency, and phase as that
of the incident wave, whereas the light wave generated by spontaneous emission has random phase and fre-
quency, and it propagates in all directions. The spontaneously emitted photons are amplified by the amplifier
and this is known as amplified spontaneous emission (ASE). ASE is the main source of noise in the amplifiers.
The mean number of photons at the output of an amplifier of length L is given by (see Appendix A)
nph(L) = nph(0)G + nsp(G −1),
(6.4)
where nph(0) is the mean number of photons at the amplifier input (z = 0), G is the amplifier gain, and nsp is
the spontaneous emission factor or population-inversion factor, given by
nsp =
N2
N2 −N1
,
(6.5)
where N1 and N2 are the population densities at state 1 and 2, respectively. Eq. (6.4) is of fundamental signifi-
cance. The first and second terms on the right-hand side represent the photon gain due to stimulated emission
and spontaneous emission, respectively. When there is full population inversion, N1 = 0 and nsp = 1. This
corresponds to an ideal amplifier. For a realistic amplifier, N1 ≠0 and nsp is greater than 1.
The mean number of photons nsp(G −1) corresponds to the mean noise power PASE in the frequency range
of f0 to f0 + Δf in a single polarization (see Appendix A):
PASE,sp = nsph f0(G −1)Δf.
(6.6)
Here, the subscript sp refers to single polarization. The noise power given by Eq. (6.6) is the noise power per
mode. In a single-mode fiber, there are actually two modes corresponding to two polarizations. Therefore, the
noise power in two polarizations is
PASE,dp = 2nsp(G −1)h f0Δf.
(6.7)

Optical Amplifiers
249
The noise power per unit frequency interval is the power spectral density (PSD), which is given by
𝜌ASE,dp =
PASE,dp
Δf
= 2nsp(G −1)h f0.
(6.8)
Note that the PSD given by Eq. (6.8) is single-sided, i.e., the frequency components are positive. The power
spectral density is constant over the bandwidth Δf ≪f0, and the ASE can be considered as a white noise
process. The single-sided PSD per polarization is
𝜌ASE,sp = nsph f0(G −1).
(6.9)
Example 6.1
An optical amplifier operating at 1550 nm has a one-sided ASE power spectral density of 5.73 × 10−17 W/Hz
in both polarizations. Calculate the gain G. Assume nsp = 1.5.
Solution:
From Eq. (6.8), we have
𝜌ASE,dp = 2nsp(G −1)h f0,
f0 = c
𝜆=
3 × 108
1550 × 10−9 = 193.55 THz,
G =
𝜌ASE,dp
2nsph f0
+ 1
=
5.73 × 10−17
2 × 1.5 × 6.626 × 10−34 × 193.55 × 1012 + 1
= 150.
6.4
Low-Pass Representation of ASE Noise
The complex ASE noise field in a single polarization may be written as
𝜙n(t) = n(t) exp[−i(2𝜋f0t)],
(6.10)
where n(t) is the slowly time-varying field envelope of noise. Taking the Fourier transform of Eq. (6.10),
we find
ñ(f) = ̃𝜙n(f −f0).
(6.11)
Note that 𝜙n(t) is a band-pass noise process, and n(t) is its low-pass equivalent. Fig. 6.2(a) and 6.2(b) shows
the absolute of the Fourier transform of 𝜙n(t) and n(t), respectively. As can be seen, ̃𝜙n(f) occupies a spectral
region f0 −Bo∕2 ≤f ≤f0 + Bo∕2 and ñ(f) is band-limited to B0∕2. Let us first consider the ASE noise as a
band-pass process with the single-sided PSD given by Eq. (6.9),
𝜌ASE,sp = nsph f0(G −1).
(6.12)
The noise power in a bandwidth of Bo is
N = 𝜌ASE,spBo.
(6.13)

250
Fiber Optic Communications
fo
f
Bo
Bo
0
f
(a)
(b)
∣n( f )∣
˜
∣ϕn( f )∣
˜
Figure 6.2
Fourier transform of (a) the complex noise field, (b) its envelope.
Fig. 6.3 shows the single-sided PSD of the band-pass signal 𝜙n(t).
Next let us consider the equivalent low-pass representation. Since n(t) is the low-pass signal, its PSD, by
definition, is
𝜌LP
ASE,sp = lim
T→∞
< |ñ(f)|2 >
T
,
(6.14)
where T is a long time interval. Fig. 6.4 shows the low-pass representation of the ASE PSD. 𝜌LP
ASE,sp can be
determined by the condition that the noise power in the low-pass representation should be the same as that in
the band-pass representation, as given by Eq. (6.13), i.e.,
N = 𝜌LP
ASE,spBo = 𝜌ASE,spBo,
(6.15)
𝜌LP
ASE,sp = 𝜌ASE,sp = nsph f0(G −1).
(6.16)
In other words, the double-sided PSD of the low-pass signal n(t) is the same as the single-sided PSD, 𝜌ASE,sp
of 𝜙n(t). From now on, we omit the subscripts and superscripts and denote the PSD of the n(t) as 𝜌ASE,
𝜌ASE ≡𝜌LP
ASE,sp = 𝜌ASE,sp = nsph f0(G −1).
(6.17)
PSD
fo
f
Bo
ρASE, sp
Figure 6.3
Band-pass representation of ASE PSD.

Optical Amplifiers
251
PSD
0
f
Bo
LP
ρASE,sp
Figure 6.4
Low-pass representation of ASE PSD.
6.5
System Impact of ASE
Consider an amplifier with gain G. Let 𝜌ASE be the power spectral density of ASE noise and 𝜓in be the optical
field envelope at the amplifier input. We assume that the input of the amplifier is CW, i.e., 𝜓in is a constant, and
consider the case of a single polarization. The impact of ASE for the case of dual polarizations is discussed
in Section 6.5.4. The optical field envelope at the amplifier output can be written as
𝜓tot = 𝜓out + n(t),
(6.18)
where 𝜓out =
√
G𝜓in is the output signal field envelope and n(t) is the noise field envelope due to ASE. The
amplifier output passes through an optical filter, as shown in Fig. 6.5. Let the transfer function of the optical
filter be ̃Hopt(f). The noise output of the optical filter is
̃nF(f) = ̃n(f) ̃Hopt(f),
(6.19)
where
̃nF(f) = [nF(t)],
̃n(f) = [n(t)].
The power spectral density of nF(t) is
𝜌nF(f) = 𝜌ASE| ̃Hopt(f)|2,
(6.20)
G
OF
PD 
EF
I = R |ψout + nF|2
IF
ψout + n
ψout + nF
ψin
Figure 6.5
A fiber-optic system consisting of an amplifier, an optical band-pass filter, a photodetector, and an electrical
low-pass filter. OF = optical filter, PD = photodetector, EF = electrical filter.

252
Fiber Optic Communications
and is shown in Fig. 6.6. The mean noise power is
PASE = < |nF(t)|2 >= ∫
∞
−∞
𝜌nF(f)df = 𝜌ASE ∫
∞
−∞
| ̃Hopt(f)|2df
= 𝜌ASEBo,
(6.21)
where
Bo = ∫
+∞
−∞
|Hopt(f)|2df
(6.22)
is the effective bandwidth of the optical filter. Since the field envelope is a low-pass signal, we model the
optical band-pass filter as the low-pass filter. An ideal band-pass filter is modeled as an ideal low-pass filter
with the transfer function
̃Hopt(f) = 1
for |f| < fo∕2
= 0
otherwise.
(6.23)
Here, fo is the full bandwidth of the optical filter. Using Eq. (6.23), Eq. (6.22) becomes
Bo = ∫
fo∕2
−fo∕2
df = fo.
(6.24)
The optical filter output passes through the photodetector and the photocurrent I is proportional to the incident
power,
I = R|𝜓out + nF(t)|2
= R[|𝜓out|2 + |nF(t)|2 + 𝜓outn∗
F(t) + 𝜓∗
outnF(t)].
(6.25)
Let
I0 = R|𝜓out|2,
(6.26)
Is−sp = R[𝜓outn∗
F(t) + 𝜓∗
outnF(t)],
(6.27)
Isp−sp = R|nF(t)|2.
(6.28)
Arb. unit
f
f
(a)
(b)
PSD ( f )
ρASE
Hopt( f) 2
˜
Hopt( f ) 2
˜
ρnF (f ) = ρASE
Figure 6.6
Impact of the optical filter on noise: (a) absolute square of the filter transfer function, and (b) PSD of the
noise at the filter output.

Optical Amplifiers
253
Now Eq. (6.25) may be written as
I = I0 + Is−sp + Isp−sp.
(6.29)
Here, I0 is a constant photocurrent, Is−sp(t) is the noise current due to signal–ASE beating, and Isp−sp is
the noise current due to ASE–ASE beating (nF(t)n∗
F(t)). Since I0 is the deterministic current, its variance
is zero and it only alters the mean of the photocurrent. Using Eq. (6.29), the mean and variance of I can be
calculated as
< I >=< I0 > + < Is−sp > + < Isp−sp >,
(6.30)
𝜎2 = < I2 > −< I>2
= 𝜎2
s−sp + 𝜎2
sp−sp + 2Rs−sp,sp−sp,
(6.31)
where
𝜎2
s−sp = < I2
s−sp > −< Is−sp>2,
(6.32)
𝜎2
sp−sp = < I2
sp−sp > −< Isp−sp>2,
(6.33)
Rs−sp,sp−sp = < Is−spIsp−sp > −< Is−sp >< Isp−sp > .
(6.34)
In Eq. (6.31), the first term and second term on the right-hand side represent the variance of signal–ASE beat
noise and ASE–ASE beat noise, respectively, and the last term represents the correlation between the two.
It can be shown that these two noise processes are uncorrelated and, therefore, the last term of Eq. (6.31) is
zero. Total variance may be written as
𝜎2 = 𝜎2
s−sp + 𝜎2
sp−sp.
(6.35)
In the following subsections, we develop expressions for each of the terms.
6.5.1
Signal–ASE Beat Noise
In this section, we develop an analytical expression for the variance of Is−sp(t). Let us first consider the case
in which the electrical filter bandwidth is much larger than Bo and, hence, its impact can be ignored. Let
𝜓out = |𝜓out| exp(i𝜃out),
(6.36)
nF = |nF| exp(i𝜃F).
(6.37)
We obtain
𝜓outn∗
F + 𝜓∗
outnF = |𝜓out||nF|[exp(iΔ𝜃) + exp(−iΔ𝜃)]
= 2|𝜓out||nF| cos (Δ𝜃),
(6.38)
where Δ𝜃= 𝜃out −𝜃F. Δ𝜃is a random variable with uniform distribution in the interval [0, 2𝜋]. Now, using
Eq. (6.38) in Eq. (6.27), the mean of Is−sp(t) is given by
< Is−sp(t) >= 2R|𝜓out| < |nF| >< cos (Δ𝜃) >= 0,
(6.39)

254
Fiber Optic Communications
since cos (Δ𝜃) takes positive values with the same probability as it takes negative values. The variance is
𝜎2
s−sp =< I2
s−sp(t) >= 4R2|𝜓out|2 < |nF|2 >< cos 2(Δ𝜃) > .
(6.40)
Using the following relation:
cos 2(Δ𝜃) = 1 + cos (2Δ𝜃)
2
,
(6.41)
and making use of Eq. (6.21), Eq. (6.40) becomes
𝜎2
s−sp = 4R2PoutPASE < 1
2 + 1
2 cos (2Δ𝜃) >
= 2R2PoutPASE.
(6.42)
Eq. (6.42) is an important result. We will use this result later in Section 7.4 to evaluate the performance of a
fiber-optic system consisting of a chain of amplifiers. Using Eq. (6.21) in Eq. (6.42), we find
𝜎2
s−sp = 2R2Pout𝜌ASEBo.
(6.43)
Eq. (6.43) may be rewritten as
𝜎2
s−sp = 2IoutIASE,
(6.44)
where IASE and Iout are the noise current due to ASE and signal current, respectively, given by
IASE = RPASE = R𝜌ASEBo,
(6.45)
Iout = RPout.
(6.46)
Next, let us consider the case in which the optical filter is absent, but the electrical filter is present. Let the
current I(t) pass through an electrical filter with the transfer function ̃He(f). The signal–ASE noise current
before the electrical filter is given by Eq. (6.27),
Is−sp = R[𝜓outn∗(t) + 𝜓∗
outn(t)].
(6.47)
Since the optical filter is absent, nF(t) of Eq. (6.27) is replaced by n(t). Suppose n(t) is the input of the electrical
filter, its output would be
ñEF(f) = ñ(f) ̃He(f).
(6.48)
Therefore, if Is−sp(t) is the input of the electrical filter, its output is
Is−sp,EF(t) = R[𝜓outn∗
EF(t) + 𝜓∗
outnEF(t)].
(6.49)
Eq. (6.49) is the same as Eq. (6.38) except that nF(t) is replaced by nEF(t). So, proceeding as before, the
variance may be written as
𝜎2 = 2R2Pout < |nEF|2 > .
(6.50)
The mean noise power after the electrical filter can be calculated as follows. The power spectral density after
the electrical filter is
𝜌nEF(f) = 𝜌ASE| ̃He(f)|2.
(6.51)

Optical Amplifiers
255
The noise power is
< |nEF|2 > = ∫
∞
−∞
𝜌nEF(f)df
= 2𝜌ASEBe,
(6.52)
where
Be = 1
2 ∫
∞
−∞
| ̃He(f)|2df.
(6.53)
Substituting Eq. (6.52) in Eq. (6.50), we find
𝜎2
s−sp = 4R2Pout𝜌ASEBe.
(6.54)
Eq. (6.54) may be rewritten as
𝜎2
s−sp = 2IoutIASE,
(6.55)
where Iout and IASE are the signal current and noise current in the electrical bandwidth of Be, respectively,
given by
Iout = RPout,
(6.56)
IASE = 2R𝜌ASEBe.
(6.57)
When the electrical filter is an ideal low-pass filter with cutoff frequency fe,
̃He(f) = 1
for
|f| < fe
= 0
otherwise,
(6.58)
Eq. (6.53) becomes
Be = 1
2 ∫
∞
−∞
df = fe.
(6.59)
Next, let us consider the case in which the bandwidths of optical and electrical filters are comparable. When
the optical filter is an ideal band-pass filter with full bandwidth fo and the electrical filter is an ideal low-pass
filter with cutoff frequency fe, the variance is (see Example 6.8)
𝜎2
s−sp = 4R2Pout𝜌ASEBeff,
(6.60)
Beff = min{fo∕2, fe}.
(6.61)
Example 6.2
The ASE PSD of an amplifier 𝜌ASE is 1.3 × 10−16 W/Hz. The gain of the amplifier G = 20 dB and the input
power of the amplifier is 10 μW. The output of the amplifier is incident on a photodetector with responsivity
R = 0.8 A/W. Calculate the variance of the signal–ASE beat noise. Assume that the receiver can be modeled
as an ideal low-pass filter with cutoff frequency fe = 7 GHz. Ignore the optical filter.

256
Fiber Optic Communications
Solution:
G(dB) = 20 dB = 10 log10(G).
The gain in the linear unit is
G = 10G(dB)∕10 = 100.
The output power of the amplifier is
Pout = GPin = 100 × 10 × 10−6 W = 1 mW.
The variance of the signal–ASE beat noise current is
𝜎2
s−sp = 4R2Pout𝜌ASE fe
= 4 × 0.82 × 1 × 10−3 × 1.3 × 10−16 × 7 × 109 A2
= 2.32 × 10−9 A2.
6.5.2
ASE–ASE Beat Noise
The absolute square of the ASE noise leads to the noise current Isp−sp, known as the ASE–ASE beat noise
current given by Eq. (6.28). Analytical expressions for the variance of ASE–ASE beat noise for arbitrary
transfer functions of optical and electrical filters is discussed in Example 6.11. Here we consider a few spe-
cial cases. When the optical filter bandwidth Bo is much smaller than the electrical filter bandwidth Be, the
impact of the electrical filter can be ignored and, in this case, the mean and variance are calculated as (see
Example 6.10)
< Isp−sp >= R𝜌ASEBo,
(6.62)
𝜎2
sp−sp = R2𝜌2
ASEB2
o.
(6.63)
When the optical filter is an ideal band-pass filter with full bandwidth fo and the electrical filter is an ideal
low-pass filter with cutoff frequency fe, the mean and variance are given by [1] (see Example 6.11),
< Isp−sp >= R𝜌ASE fo,
(6.64)
𝜎2
sp−sp = R2𝜌2
ASE(2fo −fe)fe
if
fe < fo,
= R2𝜌2
ASEf 2
o
otherwise.
(6.65)
When fe ≪fo, Eq. (6.65) becomes
𝜎2
sp−sp = 2R2𝜌2
ASEfofe.
(6.66)
6.5.3
Total Mean and Variance
Let us assume that the optical and electrical filters are ideal filters with bandwidths fo and fe, respectively.
Since the mean of the signal–ASE beat current is zero, the total mean current is the sum of the deterministic
photocurrent given by Eq. (6.26) and the mean of the ASE–ASE beat current,
< I >= I0 + R𝜌ASEfo.
(6.67)

Optical Amplifiers
257
From Eq. (6.35), we have
𝜎2 = 𝜎2
s−sp + 𝜎2
sp−sp.
(6.68)
Using Eqs. (6.60) and (6.65) in Eq. (6.68), we find
𝜎2 = R2𝜌ASEfo[2Pout + 𝜌ASEfo]
if
fo ≤fe
= R2𝜌ASEfo[2Poutfo + 𝜌ASE(2fo −fe)fe]
if
fe < fo < 2fe
= R2𝜌ASE[4Poutfe + 𝜌ASE(2fo −fe)fe]
otherwise.
(6.69)
When the signal power Pout is much larger than the noise power PASE, the dominant contribution to the
variance comes from the signal–ASE beat noise. However, when the noise power is comparable with
the signal power, the second term in Eq. (6.68) becomes comparable with the first term, as illustrated in
the following example.
Example 6.3
An optical amplifier at 1530 nm has a gain G = 30 dB and nsp = 5. The input power of the amplifier Pin is
−27 dBm. Calculate (a) the variance of the signal–ASE beat noise current, (b) the variance of the ASE–ASE
beat noise current, and (c) the total variance. Assume R = 0.8 A/W, optical and electrical filters are ideal with
fo = 16 GHz and fe = 9 GHz. Repeat this example if Pin = −60 dBm.
Solution:
f0 = c
𝜆= 196.08 THz,
Pout(dBm) = Pin(dBm) + G(dB)
= −27 + 30 dBm = 3 dBm,
Pout = 10Pout(dBm)∕10 mW = 2 × 10−3 W
G = 10G(dB)∕10 = 1000.
From Eq. (6.17), we have
𝜌ASE = nsph f0(G −1)
= 5 × 6.626 × 10−34 × 196.08 × 1012 × (1000 −1)
= 6.48 × 10−16 W/Hz.
(a) Using Eq. (6.60), we find
𝜎2
s−sp = 4R2Pout𝜌ASEBeff,
Beff = min{fo∕2, fe} = 8 GHz,
𝜎2
s−sp = 4 × 0.82 × 6.48 × 10−16 × 2 × 10−3 × 8 × 109 A2
(6.70)
= 2.657 × 10−8 A2.
(6.71)

258
Fiber Optic Communications
(b) From Eq. (6.65), we have
𝜎2
sp−sp = R2𝜌2
ASE(2fo −fe)fe
= 0.82 × (6.48 × 10−16)2 × (2 × 16 −9) × 109 × 9 × 109 A2
= 5.56 × 10−11 A2.
(c) The total variance is
𝜎2
tot = 𝜎2
s−sp + 𝜎2
sp−sp
= 2.657 × 10−8 + 5.56 × 10−11 A2
≅2.663 × 10−8 A2 ≅𝜎2
s−sp.
When Pin is −60 dBm,
Pout(dBm) = Pin(dBm) + G(dB)
= −60 + 30 dBm = −30 dBm,
Pout = 10Pout(dBm)∕10 mW = 10−6 W.
(a)
𝜎2
s−sp = 4 × 0.82 × 6.48 × 10−16 × 10−6 × 8 × 109 A2
= 1.328 × 10−11 A2.
(b) 𝜎2
sp−sp is unaffected by the change in signal power, i.e.,
𝜎2
sp−sp = 5.56 × 10−11 A2.
(c) In this case, 𝜎2
s−sp is smaller than 𝜎2
sp−sp. The total variance is
𝜎2
tot = 6.89 × 10−11 A2.
6.5.4
Polarization Effects
So far, we have considered the signal and noise in a single polarization. Since a single-mode fiber has two
polarization modes, the electric field envelopes in x- and y-polarization components after the optical filter
may be written as
Ex = 𝜓out, x + nF,x,
(6.72)
Ey = 𝜓out,y + nF,y,
(6.73)
where 𝜓out and nF represent the signal and noise outputs of the optical filter, respectively. The total power
incident on the photodetector is
P = |Ex|2 + |Ey|2 = |𝜓out, x + nF,x|2 + |𝜓out,y + nF,y|2.
(6.74)

Optical Amplifiers
259
Without loss of generality, we can assume that the signal field at the receiver is polarized in the x-direction
with a suitably chosen reference axis so that 𝜓out,y = 0. Now, Eq. (6.74) becomes
P = |𝜓out, x + nF,x|2 + |nF,y|2.
(6.75)
The photocurrent is
I = RP
(6.76)
= R{|𝜓out, x|2 + 𝜓out, xn∗
F,x + 𝜓∗
out, xnF,x + |nF,x|2 + |nF,y|2}
(6.77)
= I0 + Is−sp + Isp−sp,
(6.78)
where
I0 = RPout = R|𝜓out, x|2,
(6.79)
Is−sp = R(𝜓out, xn∗
F,x + 𝜓∗
out, xnF,x),
(6.80)
Isp−sp = R(|nF,x|2 + |nF,y|2).
(6.81)
Since Eq. (6.80) is the same as Eq. (6.27) with nF replaced by nF,x, we have
< Is−sp >= 0,
(6.82)
𝜎2
s−sp = 4R2𝜌ASEPoutBeff.
(6.83)
Here, 𝜌ASE is the PSD of nF,x. nF,x and nF,y are two independent noise processes. So, the mean ASE–ASE
beat noise current is doubled, i.e.,
< Isp−sp >= 2 < |nF,x|2 >= 2R𝜌ASEfo.
(6.84)
From Eq. (6.81), we find
< I2
sp−sp >= R2(< |nF,x|4 > + < |nF,y|4 > +2 < |nF,x|2 >< |nF,y|2 >).
(6.85)
Since < |nF,x|m >=< |nF,y|m >, m = 1, 2,..., 4, Eq. (6.85) reduces to
< I2
sp−sp >= 2R2[< |nF,x|4 > + < |nF,x|2>2],
(6.86)
𝜎2
sp−sp = < I2
sp−sp > −< Isp−sp>2 = 2R2[< |nF,x|4 > −< |nF,x|2>2]
(6.87)
= 2R2𝜌2
ASE(2fo −fe)fe
if
fe < fo
(6.88)
= 2R2𝜌2
ASEf 2
o
otherwise.
(6.89)
Note that the variance of the signal–noise beating with two polarizations given by Eq. (6.83) is the same as
that obtained earlier for the case of a single polarization. This is because the noise field can be split into two
polarization components: one aligned with the signal and the other orthogonal to the signal. The noise com-
ponent orthogonal to the signal does not interfere with it and hence the variance of the signal–noise beating
obtained in the two cases is identical. However, the mean and variance of the noise–noise beating current
are doubled compared with the single-polarization case since the amplifier noise power in both polarizations
leads to noise current. In Sections 6.5.1 to 6.5.3, we assumed that there is only one polarization. Such an
assumption is valid if a polarizer aligned with the signal polarization is placed before the photodetector that
removes the noise in the orthogonal polarization.

260
Fiber Optic Communications
6.5.5
Amplifier Noise Figure
The noise figure is commonly used to characterize the noise added by an amplifier. It is defined as the ratio
of the electrical SNR at the amplifier input to that at the amplifier output [3, 4],
Fn = (SNR)in
(SNR)out
.
(6.90)
See Fig. 6.7. Since (SNR)out can never exceed (SNR)in, the noise figure is greater than unity. Note that the
SNRs appearing in the above equation are measured in the electrical domain using photodetectors at the input
and output of the amplifiers, and measuring the electrical signal and noise powers. To minimize the parameters
of the measurement unit entering into the definition of Fn, ideal photodetectors with 100% quantum efficiency
are used, and thermal noise is ignored. Let us first consider (SNR)in. When the incident power is Pin, the
photocurrent is
Iin = RPin,
(6.91)
where responsivity is given by Eq. (5.17),
R =
𝜂
h f0
=
q
h f0
,
(6.92)
assuming 𝜂= 1. Here, f0 is the carrier frequency. The electrical signal power delivered to a load resistor RL is
Sin = I2
inRL.
(6.93)
We assume that there is no noise in the optical signal before the amplifier. The noise power at the output of
PD1 is due to the shot noise and is given by Eq. (5.79),
Nshot = 2qIinRLBe.
(6.94)
Here, we have ignored the dark current. Therefore, we have
SNRin =
Sin
Nshot
= RPin
2qBe
.
(6.95)
Next, consider SNRout. The output optical power of the amplifier is
Pout = GPin,
(6.96)
SNRin
G
Pin
PD 1 
PD  2
Pout
SNRout
Figure 6.7
Measurement of the amplifier noise figure.

Optical Amplifiers
261
and the corresponding photocurrent and electrical signal power are
Iout = RGPin,
(6.97)
Sout = (RGPin)2RL,
(6.98)
respectively. The noise power delivered to a resistor RL consists mainly of two components. They are due
to shot noise and signal–ASE beating noise. In this analysis, we ignore the ASE–ASE beating noise and
assume that the optical filter is absent. The total noise power can be obtained by adding the shot noise given
by Eq. (6.94) and the signal–ASE beating noise power given by Eq. (6.60),
Nout = Nshot + Ns−sp
= 2qRPoutRLBe + 4R2𝜌ASEPoutBeRL.
(6.99)
Note that the power spectral density of the ASE noise in Eq. (6.99) is in single polarization. Although the
amplifier adds noise in both polarizations, the noise in the polarization orthogonal to the signal polarization
does not interfere with the signal to generate signal–ASE beat noise. The SNR at the output of PD2 can be
written as
SNRout = Sout
Nout
=
(RGPin)2RL
[q + 2R𝜌ASE]2RGPinBeRL
=
RGPin
(q + 2R𝜌ASE)2Be
.
(6.100)
Substituting Eqs. (6.95) and (6.100) in Eq. (6.90), we find
Fn = RPin
2qBe
(q + 2R𝜌ASE)2Be
RGPin
= q + 2R𝜌ASE
Gq
.
(6.101)
Using Eq. (6.92), Eq. (6.101) can be written as
𝜌ASE = (GFn −1)h f0∕2.
(6.102)
The power spectral density 𝜌ASE can also be expressed in terms of nsp (see Eq. (6.17)),
𝜌ASE = nsp(G −1)h f0.
(6.103)
Equating the right-hand sides of Eqs. (6.102) and (6.103), we find an expression that relates the amplifier
noise figure and spontaneous emission factor nsp,
Fn =
2nsp(G −1)
G
+ 1
G.
(6.104)
When G ≫1,
Fn ≅2nsp.
(6.105)
Since the minimum value of nsp is 1, the lowest achievable noise figure is 2. The noise figure is expressed in
dB units as
Fn(dB) = 10 log 10Fn.
(6.106)
When nsp = 1, Fn = 3 dB, which corresponds to an ideal amplifier with the lowest ASE noise.

262
Fiber Optic Communications
Example 6.4
An optical amplifier at 1550 nm has a noise figure of 4.5 dB. The signal output of the amplifier is 0 dBm,
which is incident on a photodetector. Calculate the amplifier gain if the standard deviation of the signal–ASE
beat noise current is 0.066 mA. Assume R = 0.9 A/W, Be = 7.5 GHz, and the optical filter is absent.
Solution:
Pout(dBm) = 0 dBm,
Pout = 10Pout(dBm)∕10 mW = 1 mW.
From Eq. (6.54), we have
𝜌ASE =
𝜎2
s−sp
4R2BePout
=
(0.066 × 10−3)2
4 × 0.92 × 7.5 × 109 × 1 × 10−3 W/Hz
= 1.79 × 10−16 W/Hz,
Fn = 10Fn(dB)∕10 = 2.818,
f0 = c
𝜆= 193.55 THz.
Using Eq. (6.102), we find
G = 1
Fn
(2𝜌ASE
h f0
+ 1
)
=
1
2.818
(
2 × 1.79 × 10−16
6.626 × 10−34 × 193.55 × 1012 + 1
)
= 992.
6.5.6
Optical Signal-to Noise Ratio
The noise added by an amplifier is characterized by the noise figure, which is the ratio of electrical SNRs
at the input and output of the amplifier. The noise added by the amplifier may also be characterized by the
optical signal-to-noise ratio (OSNR), defined as
OSNR =
mean signal power
mean noise power in a bandwidth of 0.1 nm.
(6.107)
At 1550 nm, 0.1 nm corresponds to Bopt = 12.49 GHz and the mean noise power in the bandwidth of Bopt is
PASE = 2𝜌ASEBopt,
(6.108)
OSNR = Pout
PASE
.
(6.109)
Or in decibels,
OSNR (dB) = 10 log10OSNR,
(6.110)
The factor 2 is introduced in Eq. (6.108) to account for two polarizations. Note that Bopt is not the same as
the effective bandwidth of the optical filter Bo defined in Eq. (6.22). Bopt is a reference bandwidth used in the
definition of OSNR, which may or may not be equal to Bo.

Optical Amplifiers
263
Example 6.5
An amplifier operating at 1545 nm has a gain G = 25 dB, Fn = 6 dB, and input power Pin = −22 dBm. Cal-
culate the OSNR in a bandwidth of 12.49 GHz.
Solution:
Pout = GPin,
Pout(dBm) = G(dB) + Pin(dBm)
= 25 dB −22 dBm
= 3 dBm,
Pout = 10Pout(dBm)∕10 mW
= 2 mW.
From Eq. (6.102), we have
𝜌ASE = (GFn −1)h f0
2 ,
Fn = 10Fn(dB)∕10 = 3.98,
G = 10G(dB)∕10 = 316.22,
f0 = c
𝜆0
=
3 × 108
1545 × 10−9 = 194.17 THz,
𝜌ASE = (316.22 × 3.98 −1) × 6.626 × 10−34 × 194.17 × 1012∕2 W/Hz
= 8.09 × 10−17 W/Hz
Bopt = 12.49 GHz,
OSNR =
Pout
2𝜌ASE Bopt
=
2 × 10−3
2 × 8.09 × 10−17 × 12.49 × 109 = 989,
OSNR(dB) = 10 log 10(OSNR) = 29.95 dB.
6.6
Semiconductor Optical Amplifiers
A semiconductor optical amplifier (SOA) or semiconductor laser amplifier (SLA) is nothing but a laser oper-
ating slightly below threshold. The optical field incident on one facet is amplified at the other accompanied
by the ASE. The SOAs can be divided into two types: (i) cavity-type SOA or Fabry–Perot amplifier (FPA),
(ii) traveling wave amplifier (TWA).

264
Fiber Optic Communications
6.6.1
Cavity-Type Semiconductor Optical Amplifiers
Let the power reflectivities of mirrors M1 and M2, shown in Fig. 6.8, be R1 and R2, respectively. Assuming
that the power is conserved at each mirror, the corresponding power transmittivities at mirror Mj are given by
Tj = 1 −Rj,
j = 1, 2.
(6.111)
The optical field transmitted at A is t1𝜓in, where 𝜓in =
√
Pin and |tj| = √Tj,
j = 1, 2. Let g be the gain
coefficient and 𝛼int be the cavity internal loss. The net gain coefficient is gs = Γg −𝛼int, where Γ is the overlap
factor introduced in Eq. (3.109). As shown in Fig. 6.9, the partial optical field 𝜓0 at B after a single pass is
𝜓0 = 𝜓int1t2
√
Gs exp(i𝜙0),
(6.112)
where 𝜙0 = 2𝜋nL∕𝜆is the phase-shift due to propagation, n is the refractive index of the gain medium, and
𝜆is the free-space wavelength. In the small-signal limit, the single-pass gain is
Gs = exp(gsL).
(6.113)
A fraction of the optical field is reflected at the mirror M2 and then at M1. After one round trip, the partial
field at B is (see Fig. 6.9)
𝜓1 = 𝜓int1r2r1t2[
√
Gs exp(i𝜙0)]3,
(6.114)
L
M1
M2
R1
R2
A
B
Gain medium
ψin
ψout
Figure 6.8
Cavity-type semiconductor optical amplifier.
∑
A
B
Gseiφ0
Gseiφ0
Gseiφ0
Gseiφ0
… ...
B
… ...
… ...
B
A
r1
r2
r2
r2
t2
t2
t2
ψout
ψin
ψ0
ψ1
ψn
t1
Figure 6.9
The optical signal output of the amplifier is the sum of the partial fields due to repeated reflections.

Optical Amplifiers
265
where |rj| = √Rj, j = 1, 2. After j round trips, the partial field at B is
𝜓j = 𝜓int1t2(r1r2)j[
√
Gs exp(i𝜙0)]2j+1.
(6.115)
The total field output at B is the superposition of partial fields,
𝜓out =
∞
∑
j=0
𝜓j = t1t2𝜓in
√
Gs exp(i𝜙0)
∞
∑
j=0
hj,
(6.116)
where
h = r1r2Gs exp(i2𝜙0).
(6.117)
The summation in Eq. (6.116) is a geometric series and if
|h| < 1,
(6.118)
we have
∞
∑
j=0
hj =
1
1 −h.
(6.119)
Therefore, Eq. (6.116) becomes
𝜓out =
𝜓int1t2
√
Gs
1 −h
exp(i𝜙0).
(6.120)
The overall gain G is defined as
G(f) = |𝜓out|2
|𝜓in|2 =
|t1|2|t2|2Gs(f)
[1 −h(f)][1 −h∗(f)].
(6.121)
Using Eq. (6.117 ), Eq. (6.121) can be rewritten as
G(f) =
(1 −R1)(1 −R2)Gs(f)
1 + R1R2G2
s(f) −2
√
R1R2Gs(f) cos (2𝜙0)
.
(6.122)
Using the relation
cos (2𝜙0) = 1 −2sin 2𝜙0,
(6.123)
Eq. (6.122) can be put in a different form:
G(f) =
(1 −R1)(1 −R2)Gs(f)
(1 −RGs)2 + 4RGssin 2(2𝜋nfL∕c),
(6.124)
where R =
√
R1R2 is the geometric mean of facet reflectivities. From Eq. (6.124), we see that the peak gain
occurs when
2𝜋nfL
c
= m𝜋,
m = 0, ±1, ±2, …
(6.125)
or
fm = mc
2nL,
(6.126)
which is the same as the resonant frequency given by Eq. (3.44). Therefore, the cavity-type optical amplifier
amplifies any input signal whose frequency is matched to the resonant frequency fm of the cavity. The peak

266
Fiber Optic Communications
gain occurs when the signal frequency is equal to one of the resonant frequencies given by Eq. (6.126), and
it is given by
Gpeak = (1 −R1)(1 −R2)Gs(f)
(1 −RGs)2
.
(6.127)
The separation between two peaks is known as the free spectral range (FSR):
FSR = fm+1 −fm =
c
2nL.
(6.128)
Fig. 6.10 shows the gain of the amplifier as a function of the frequency of the input signal. When the phase
accumulated in a round trip is 2m𝜋, the partial fields add up coherently, leading to signal amplification. As the
frequency of the input field deviates from the resonant frequency, mc∕2nL, the gain decreases. Fig. 6.11 shows
the gain within a free spectral range for different values of R. As can be seen, as R decreases, the bandwidth
increases and the peak gain decreases. For example, on a hot day, if you leave your car outside with all the
windows closed, it becomes too hot (large gain) because of the repeated reflections of radiation within the car.
If you open one of the windows, the reflectivity is reduced, which lowers the gain. The common characteristic
of cavity-type amplifiers is that there exists a trade-off between gain and bandwidth. To see that, let us first
define the half-width at half-maximum (HWHM) as the frequency deviation Δf from fm at which the G(f)
becomes half of the peak gain, G(fm), i.e.,
G(fm + Δf) = 0.5Gpeak.
(6.129)
0
5
10
15
20
Frequency (THz) 
Gain, G (dB)
c/(2nL)
Figure 6.10
Gain of a cavity-type SOA vs. frequency. When the signal frequency coincides with one of the resonant
frequencies of the cavity, the gain is maximum.

Optical Amplifiers
267
1.935
1.935
1.935
1.935
1.935
1.935
1.935
0
2
4
6
8
10
12
14
16
18
20
Frequency (THz)
Gain, G (dB)
R = 0.1
R = 0.3
× 104
Figure 6.11
Gain–bandwidth trade-off in cavity-type SOA.
Using Eq. (6.127), Eq. (6.124) can be written as
G(f) =
Gpeak
1 + 4RGssin 2(2𝜋nfL∕c)∕(1 −RGs)2 .
(6.130)
Using Eqs. (6.129) and (6.130) and noting that 2𝜋nfmL∕c = m𝜋, we obtain
sin 2
(2𝜋ΔfLn
c
)
= (1 −RGs)2
4RGs
.
(6.131)
The FWHM is defined as 2Δf. The FWHM is also known as the 3-dB bandwidth. From Eq. (6.131), we have
f3 dB = 2Δf =
c
𝜋Ln sin −1
{
1 −RGs
2
√
RGs
}
.
(6.132)
In obtaining Eq. (6.132), we have assumed that the single-pass gain Gs varies much more slowly with fre-
quency compared with variations of G, and Gs can be treated as a constant. From Eq. (3.39), it follows that
at the threshold the total cavity loss equals the net gain, i.e., RGs = 1. Since |h| = RGs, Eq. (6.118) corre-
sponds to the situation where the amplifier is biased below threshold and the expression for the gain given by
Eq. (6.124) is valid only if RGs < 1. Typically, the amplifier is biased slightly below threshold and 1 −RGs
is much smaller than unity. Using sin x ≅x, for x ≪1, Eq. (6.132) can be approximated as
f3 dB ≈
c
2𝜋Ln
1 −RGs
√
RGs
.
(6.133)
From Eq. (6.127), we find that the peak gain increases as RGs approaches unity. However, from Eq. (6.133), it
follows that the 3-dB bandwidth becomes quite small under this condition. Thus, there is a trade-off between

268
Fiber Optic Communications
gain and bandwidth. As an example, consider R1 = R2 = 0.3, Gs = 2.5, and L = 300 μm. Using Eqs. (6.127)
and (6.132), we find Gpeak = 20 and f3 dB = 36 GHz. For optical communication systems, the desired amplifier
bandwidth is typically greater than 1 THz and, therefore, a cavity-type semiconductor amplifier is unsuitable
as an in-line amplifier for high-bit-rate optical communication systems. In addition, they are very sensitive to
fluctuations in bias current, temperature, and polarization of the incident field [5].
Example 6.6
In a cavity-type SOA, the cavity length is 500 μm, R1 = R2 = 0.32, and the peak gain is 15 dB. Find the
single-pass gain and the 3-dB bandwidth. Assume n = 3.2.
Solution:
Gpeak = 15 dB,
Gpeak = 10Gpeak(dB)∕10 = 31.62.
From Eq. (6.127), we have
(1 −RGs)2Gpeak = (1 −R1)(1 −R2)Gs,
1 + 0.322G2
s −2 × 0.32Gs = 0.0146Gs,
or
0.1024G2
s −0.6546Gs + 1 = 0.
This quadratic equation has solutions
Gs = 2.52
or
3.86.
Eq. (6.127) is derived under the assumption that |h| < 1 or RGs < 1. When Gs = 3.86, RGs > 1, and therefore
it is not consistent with Eq. (6.127) and this solution is rejected.
The 3-dB bandwidth is given by Eq. (6.132),
f3 dB =
c
𝜋Ln sin −1
(
1 −RGs
2
√
RGs
)
=
3 × 108
𝜋× 500 × 10−6 × 3.2sin −1
(
1 −0.32 × 2.52
2(0.32 × 2.52)1∕2
)
= 6.44 GHz.
6.6.2
Traveling-Wave Amplifiers
From Fig. 6.11, it can be seen that as R decreases, the bandwidth increases. In the limiting case of R = 0,
Eq. (6.124) becomes G = Gs, i.e., the overall gain is equal to the single-pass gain Gs. This should be expected
since there are no partial fields due to round trips when R = 0. Such an amplifier is known as a traveling-wave
amplifier (TWA).

Optical Amplifiers
269
It is useful to calculate the ratio of the peak gain to the minimum gain. From Eq. (6.124), we find that the
gain is minimum when sin 2𝜙0 = 1, and it is given by
Gmin = (1 −R1)(1 −R2)Gs(f)
(1 + RGs)2
,
(6.134)
and Gmax = Gpeak. Using Eqs. (6.127) and (6.134), we find the gain ripple as
ΔG = Gmax
Gmin
= (1 + RGs)2
(1 −RGs)2 .
(6.135)
Or in decibels,
ΔG(dB) = Gmax(dB) −Gmin(dB).
(6.136)
Fig. 6.12 shows the gain as a function of frequency of the input optical field and the gain ripple ΔG is the sepa-
ration between the points corresponding to the maximum and minimum gains. For example, when RGs = 0.9,
ΔG is 25.5 dB. The fluctuations in gain as a function of frequency are undesirable for wide-band amplifiers.
To keep the gain ripple quite small, RGs ≪1, which can be achieved by reducing the reflectivities of the end
facets. To have ΔG < 3 dB, RGs ≤0.17, which can be achieved by reducing the facet reflectivities.
From Eq. (6.135), we find that the gain ripple ΔG of an ideal TWA (R = 0) is 0 dB and it has a large
bandwidth determined solely from the characteristics of the gain medium. However, in practice, even with
the best antireflection (AR) coatings, there is some residual reflectivity. Therefore, some authors [5, 6] use
the term nearly traveling-wave amplifier (NTWA) to denote an amplifier with RGs ≤0.17. For a NTWA, the
gain ripple ΔG ≤3 dB. A NTWA has been fabricated with R = 4 × 10−4 [7] and it has a 3-dB bandwidth
1.935
1.935
1.935
1.935
1.935
1.935
1.935
1.935
1.935
× 104
‒5
0
5
10
15
20
25
Frequency (THz)
G (dB)
∆G = 25.5 dB
RGs = 0.9
RGs = 0.17
∆G = 3 dB
Figure 6.12
The gain ripple ΔG increases as RGs approaches unity.

270
Fiber Optic Communications
about 9 THz and a gain ripple ΔG of about 1.5 dB. Owing to the non-resonant character of the NTWA, it was
found to be less sensitive to temperature, bias current, and input signal polarization fluctuations compared
with the FPA.
In order to reduce the reflectivities of the end facets, AR coatings may be applied to the end facets. The
optical field transmission at a dielectric interface is accompanied by reflection. However, if we deposit an
intermediate layer (AR coating) between the two dielectric media, it is possible to avoid reflections. In the
following section, the principle behind the AR coating is discussed.
6.6.3
AR Coating
The purpose of an AR coating is to avoid the reflection occurring at the interface between two dielectric
media. This reflection can be avoided by introducing an AR coating between the dielectrics with different
permittivities. Consider a three-layered dielectric medium as shown in Fig. 6.13. The optical field incident
from the left gets partially reflected at the interface 1 and the rest is transmitted. Let the reflected field at
the interface 1 be 𝜓1. At the interface 2, the field gets partially reflected again. Let the reflected field at the
interface 2 arriving at interface 1 be 𝜓2. If the reflected fields add destructively, there will be no reflection to
the left of the interface 1, i.e., 𝜓1 + 𝜓2 = 0. For destructive interference, the phase accumulated over a round
trip in the middle layer should be (2l + 1)𝜋, l = 0, ±1, ±2, … The acquired phase in a round trip is
𝜙= 2k2𝑤= 4𝜋n2𝑤
𝜆0
= (2l + 1)𝜋
or
𝑤= (2l + 1)𝜆0
4n2
,
(6.137)
where k2 is the propagation constant of the middle layer with refractive index n2, 𝜆0 is the free-space wave-
length, and 𝑤is the width of the middle layer. Thus, by introducing a coating of width (2l + 1)𝜆0∕4n2 between
two media of refractive indices n1 and n3, the backward reflection can be avoided and therefore the power of
optical signal transmitted to layer 3 is the same as the incident power to layer 1. The middle layer is known
as the AR coating. In the absence of the AR coating, the transmitted power is less than the incident power.
In some other application, it may be desired to have the power of the incident wave the same as the reflected
wave at interface 1 and no optical field should be transmitted to the medium with refractive index n3. To make
this happen, the field reflected at interface 2 should add in-phase with the field reflected at interface 1. In this
case, the phase accumulated over a round trip in the middle layer should be 2l𝜋, l = 0, ±1, ±2, … , i.e.,
𝜙= 4𝜋𝑤n2
𝜆0
= 2l𝜋
or
𝑤= l𝜆0
2n2
.
(6.138)
In this case, the structure shown in Fig. 6.13 acts as a dielectric mirror.
Interface
1 
Interface
2 
Incident 
wave
Transmitted 
wave
w
n2
n1
n3
ψ1
ψ2
Figure 6.13
Three-layered dielectric structure.

Optical Amplifiers
271
The reflectivity of the AR coating is quite sensitive to the width 𝑤and refractive index n2 of the AR coating.
To increase the tolerance, a multilayer AR coating can be used. The experimental results of Ref. [8] show that
the tolerances in 𝑤and n2 of a single-layer AR coating for realizing the power reflectivity R ≤1 × 10−3 are
about ±60∘A and ±0.05, respectively. The double-layer AR coating has larger tolerances, ±90∘A in widths
and ±0.3 in refractive index, for the same power reflectivity as in the single-layer AR coating. In this section,
we have assumed that the optical field is a plane wave and as a result, we obtained a simple expression for
the width of the AR coating. However, in a waveguide, plane waves should be replaced by the modes of the
waveguide and the reflectivity should be calculated [8].
6.6.4
Gain Saturation
As the input signal power increases beyond a certain threshold, the gain G decreases for both cavity-type
FPA and TWA. This is known as gain saturation. This phenomenon can be explained as follows. When the
population inversion is achieved, the stimulated emission dominates the absorption. Since the stimulated
emission rate is proportional to photon density, a larger input signal power enhances the stimulated emission
and, therefore, the excited carriers are depleted and the gain decreases. Under steady-state conditions, we can
set dNe∕dt to zero in Eq. (3.123) to obtain
G0(Ne −Ne,0)Nph + Ne
𝜏e
= I
qV ,
(6.139)
where
G0 = Γ𝜎g𝑣.
(6.140)
Simplifying Eq. (6.139), we find
Ne =
I∕qV + G0Ne,0Nph
G0Nph + 1∕𝜏e
,
(6.141)
g = 𝜎g(Ne −Ne,0) =
(I∕qV −Ne,0∕𝜏e)𝜏e𝜎g
G0Nph𝜏e + 1
.
(6.142)
Eq. (6.142) can be rewritten as
Γg =
Γg0
1 + Nph∕Nph,sat
,
(6.143)
where
g0 = (I∕qV −Ne,0∕𝜏e)𝜎g𝜏e,
(6.144)
Nph,sat =
1
Γ𝜎g𝑣𝜏e
.
(6.145)
The optical power P and photon density Nph are related by (Eq. (3.136))
P = Nphℏ𝜔0𝑣A.
(6.146)
So, Eq. (6.143) may be rewritten in terms of P as
Γg =
Γg0
1 + P∕Psat
,
(6.147)
Psat = ℏ𝜔0A
Γ𝜎g𝜏e
.
(6.148)

272
Fiber Optic Communications
Psat is known as the saturation power. When P ≪Psat, g ≈g0. Therefore, g0 is known as a small signal gain.
When P is comparable with Psat, g decreases. This is because, as the photon density increases, the stimulated
emission rate increases, which depletes the carriers in the conduction band and from Eq. (6.142) it follows
that g decreases as Ne decreases. The evolution of power in the amplifier is given by
dP
dz =
(
Γg0
1 + P∕Psat
−𝛼
)
P.
(6.149)
The single-pass gain is
Gs = P(L)
P(0) .
(6.150)
When the internal loss (𝛼≈0) is small, Eq. (6.149) may be rewritten as
(1 + P∕Psat
P
)
dP = Γg0dz.
(6.151)
Integrating Eq. (6.151) from 0 to amplifier length L, we obtain
∫
P(L)
P(0)
[
1
P +
1
Psat
]
dP = ∫
L
0
Γg0dz,
ln P(L)
P(0) + P(L) −P(0)
Psat
= Γg0L.
(6.152)
Let
Gs0 = exp(Γg0L)
(6.153)
–15
–10
–5
0
5
10
15
20
25
30
35
0
2
4
6
8
10
12
14
16
18
20
Input signal power (dBm)
Gain (dB)
Gs0
Saturation region
Figure 6.14
Dependence of gain on the input signal power. As the input signal power increases, the gain becomes
smaller. Psat = 0 dBm, Gs0 = 20 dB, and the internal loss is ignored.

Optical Amplifiers
273
be the small signal gain. Using Eqs. (6.150) and (6.153), Eq. (6.152) can be expressed as
Gs = Gs0 exp
[
−(Gs −1)P(L)
GsPsat
]
.
(6.154)
When P(0)(= P(L)∕Gs) ≪Psat, the exponent in Eq. (6.154) is close to zero and Gs ≈Gs0. Fig. 6.14 shows
the gain Gs as a function of the input signal power P(0). When P(0) exceeds Psat, the gain Gs decreases from
its unsaturated value Gs0.
For a TWA, the overall gain G ≈Gs. For a cavity-type SOA, the gain is given by Eq. (6.124). For both types
of amplifier, G decreases as the input power increases due to gain saturation. The saturation power for a TWA
is higher than that for a cavity-type SOA [7]. This is because the electron lifetime 𝜏e is lower at higher carrier
density and from Eq. (6.147), we see that Psat is inversely proportional to 𝜏e. The carrier density is higher for
a TWA since Gs can be much larger and still RGS < 1.
Example 6.7
A 1530-nm TWA has the following parameters:
Effective area of mode A = 5 μm2
Active volume = 7.5 × 10−16 m3
Carrier lifetime = 1 ns
Gain cross-section 𝜎g = 7.3 × 10−20 m2
Ne,0 = 3.5 × 1023 m−3
Overlap factor Γ = 0.3
Calculate (a) the saturation power and (b) the bias current I to have the small signal gain coefficient g0 =
4.82 × 103 m−1.
Solution:
The saturation power is given by Eq. (6.148),
Psat = hfoA
Γ𝜎g𝜏e
,
(6.155)
f0 = c
𝜆0
=
3 × 108
1530 × 10−9 = 196.08 THz,
(6.156)
Psat = 6.626 × 10−34 × 196.08 × 1012 × 5 × 10−12
0.3 × 7.3 × 10−20 × 1 × 10−9
W
= 29.7 mW.
(6.157)
The relation between g0 and I is given by Eq. (6.144),
g0 =
(
I
qV −
Ne,0
𝜏e
)
𝜎g𝜏e,
(6.158)

274
Fiber Optic Communications
I =
[ g0
𝜎g𝜏e
+
Ne,o
𝜏e
]
qV
=
[
4.82 × 103
7.3 × 10−20 × 1 × 10−9 + 3.5 × 1023
1 × 10−9
]
× 1.602 × 10−19 × 7.5 × 10−16 A
= 50 mA.
6.7
Erbium-Doped Fiber Amplifier
Optical fibers have the lowest loss around 1550 nm, and therefore the operating wavelength of long-haul
fiber-optic systems is around 1550 nm. It is desirable to have the signal amplification around 1550 nm. It is
found that Er3+ ions have an excited state which is separated from the ground state by the energy differ-
ence corresponding to a wavelength of ∼1530 nm and, therefore, an information-bearing signal at the carrier
wavelength around 1550 nm can be amplified by means of stimulated emission if the population inversion is
achieved. Optical pumps at the wavelength of 980 nm or 1480 nm are typically used to achieve the popula-
tion inversion. Erbium-doped fibers (EDFs) are the silica optical fibers doped with erbium. Sometimes they
are co-doped with aluminum to increase the solubility of the Er3+. Fig. 6.15 shows the structure of a typical
EDFA. The signal to be amplified is combined with the pump beam at either 1480 nm or 980 nm using a
wavelength-selective coupler (WSC). Semiconductor laser diodes are used as the optical pumps. For ruby
lasers or Nd–Yag lasers, a flash light with a broad spectrum can be used as the optical pump whereas for
EDFA, a flash light can not be used because the linewidth of the energy band that absorbs the pump is quite
narrow and therefore a semiconductor laser with narrow linewidth is used as the pump. In the EDFA, the
signal is amplified and the pump is attenuated. An optical isolator is used at the output end so that the reflec-
tions occurring at various points along the fiber-optic transmission lines after the EDFA should not interfere
with the signal inside the amplifier. The configuration shown in Fig. 6.15 is known as a forward-pumping
scheme. There are other configurations in which the pump propagates backward, or two pumps with one
pump propagate forward and the other propagates backward [1, 9].
6.7.1
Gain Spectrum
An EDFA has a very broad spectrum (∼30 nm). The broad bandwidth of EDFAs makes them useful in
WDM systems (see Chapter 9). If the excited level 2 does not have any energy sublevels, the optical signal
corresponding to the energy difference between the ground level and level 2 would be the only frequency
Input signal
EDF
Pump
Isolator
Output signal 
WSC
Figure 6.15
Erbium-doped fiber amplifier. WSC = wavelength selective coupler, EDF = erbium-doped fiber.

Optical Amplifiers
275
component amplified. This corresponds to the very narrow (impulse) gain spectrum. However, level 2 is a
collection of sublevels. Broadening of the energy levels occurs when the erbium ions are incorporated into
the glass of optical fibers and, thus, the gain spectrum is also broadened. This broadening is both homogeneous
(all erbium ions exhibit the identical broadened spectrum) and inhomogeneous (different ions in different glass
locations exhibit different spectra). Homogeneous broadening is due to the interactions with photons of the
glass, whereas inhomogeneous broadening is caused by differences in the glass sites where different ions
are hosted.
6.7.2
Rate Equations∗
Consider a three-level system as shown in Fig. 6.16. An optical pump beam of frequency 𝜔p causes upward
transitions from level 1 to level 3. Let the population densities of the level j be Nj, j = 1, 2, 3. The erbium
ions excited to level 3 relax to level 2 by spontaneous emission and non-radiative processes. In practice, it
is mostly non-radiative. The stimulated emission occurring between level 2 and level 1 is responsible for
the signal amplification. Let the lifetime associated with spontaneous emission and non-radiative processes
between any levels j and k be 𝜏jk. First consider the gain and loss rates for level 3. The population density of
level 3 increases because of the net absorption of pump photons and it decreases because of the non-radiative
emission,
dN3
dt
= Rabs + Rstim + Rnr + Rsp.
(6.159)
Consider the pump absorption. From the Einstein relation (see Eqs. (3.2) and (3.30)), we have
Rabs = B13N1up,
(6.160)
where up is the energy density of the pump. We will write Eq. (6.160) in a slightly different form. The pump
intensity p and energy density are related by (Eq. (3.50))
up =
p
𝑣,
(6.161)
where 𝑣is the speed of light in the medium. The photon flux density is defined as the mean number of photons
per unit area per unit time. In other words, if np photons cross the area A over the time interval Δt, the photon
flux density is
𝜙p =
np
AΔt.
(6.162)
Level 3
ħωp
ħωs
Non-radiative transition
Level 2
Ground level 1
Figure 6.16
A three-level system. Signal amplification in erbium-doped fiber.

276
Fiber Optic Communications
If a light wave of energy Ep crosses the area A over the time interval Δt, the optical intensity is
p =
Ep
AΔt.
(6.163)
Since the energy Ep = npℏ𝜔p, where 𝜔p is the frequency of the pump wave, we find
𝜙p =
p
ℏ𝜔p
.
(6.164)
Using Eqs. (6.161) and (6.164) in Eq. (6.160), we find
Rabs = 𝜎13N1𝜙p,
(6.165)
where
𝜎13 =
ℏ𝜔pB13
𝑣
(6.166)
is known as the absorption cross-section associated with the transition from level 1 to level 3. The physical
meaning of 𝜎13 is as follows. The optical power absorbed by an erbium ion is proportional to the optical
intensity p of the light wave incident,
Pabs = kp,
(6.167)
where k is a constant of proportionality that depends on the medium. Since Pabs∕ℏ𝜔p is the number of photons
absorbed per unit time by an erbium ion (photon absorption rate) and p∕ℏ𝜔p is the photon flux density
(Eq. (6.164)), dividing Eq. (6.167) by ℏ𝜔p, we find
Pabs
ℏ𝜔p
= k𝜙p.
(6.168)
If there are N1 erbium ions per unit volume in the ground state, the total absorption rate is
Rabs = kN1𝜙p,
(6.169)
which is the same as Eq. (6.165) if k = 𝜎13. Thus, the absorption cross-section can be imagined as an effective
area that “captures” a fraction of the incident photons [1]. Similarly, the stimulated emission rate from level
3 to level 1 is given by
Rstim = −𝜎31N3𝜙p,
(6.170)
where 𝜎jk = Bjkℏ𝜔jk∕𝑣is the cross-section associated with the transition from j to k and 𝜔jk is the energy
difference between the levels j and k. Since the transition from level 3 to level 2 is mostly non-radiative,
absorption and stimulated emission between level 3 and level 2 can be ignored. Using Eqs. (6.165) and (6.170)
in Eq. (6.159), we find
dN3
dt
= (𝜎13N1 −𝜎31N3)𝜙p −N3
𝜏32
.
(6.171)
In the case of the two-level atomic system discussed in Chapter 3, Section 3.2, we found that B12 = B21, which
implies that the emission and absorption cross-section are equal. However, in general, they could be different

Optical Amplifiers
277
if the two levels are combinations of sublevels that are populated to various extents depending on the thermal
distribution [1]. It is straightforward to write the rate equations for population densities N1 and N2 as
dN2
dt = N3
𝜏32
−(N2𝜎21 −N1𝜎12)𝜙s −N2
𝜏21
,
(6.172)
dN1
dt = (N2𝜎21 −N1𝜎12)𝜙s + (N3𝜎31 −N1𝜎13)𝜙p + N2
𝜏21
,
(6.173)
where 𝜙s is the photon flux density of the signal. Consider the rate equation (6.171). As soon as the pump
photons cause transition from level 1 to level 3, erbium ions relax to level 2 by the non-radiative processes
involving interaction with phonons of the glass matrix. Therefore, the second term N3𝜎31𝜙p in Eq. (6.171)
that accounts for the stimulated emission can be ignored. Under steady-state conditions, dN3∕dt = 0 and from
Eq. (6.171), we obtain
N3
𝜏32
= (N1𝜎13 −N3𝜎31)𝜙p ≈N1𝜎13𝜙p.
(6.174)
Substituting Eq. (6.174) into Eqs. (6.172) and (6.173) and ignoring N3𝜎31𝜙p, we obtain [1]
dN2
dt = N1𝜎13𝜙p −N2
𝜏21
−(N2𝜎21 −N1𝜎12)𝜙s,
(6.175)
dN1
dt = (N2𝜎21 −N1𝜎12)𝜙s −N1𝜎13𝜙p + N2
𝜏21
.
(6.176)
Note that Eq. (6.175) is similar to Eq. (3.89), corresponding to the two-level system with Rpump = N1𝜎13𝜙p.
The erbium ions are excited to level 2 from level 1 by an alternate route, i.e., first they make an upward
transition to level 3 from level 1 by absorbing pump photons and they relax to level 2 by means of non-radiative
processes. If the population inversion is achieved (𝜎21N2 > 𝜎12N1), the energy of the pump is transferred to
the signal.
Adding Eqs. (6.175) and (6.176), we find
d(N1 + N2)
dt
= 0
or
N1 + N2 = NT
(a constant).
(6.177)
Here, NT denotes the erbium ion density. The steady-state solution of Eqs. (6.175) and (6.176) can be obtained
by setting
dN1
dt
= dN2
dt
= 0.
(6.178)
Using Eq. (6.177) in Eq. (6.175), we obtain under the steady-state condition
N2 =
NT[𝜎13𝜙p + 𝜎12𝜙s]𝜏21
1 + 𝜎13𝜏21𝜙p + (𝜎12 + 𝜎21)𝜙s𝜏21
.
(6.179)
The photon flux density 𝜙p and optical power Pp are related by Eq. (6.164),
𝜙p =

ℏ𝜔p
=
Pp
Aeffℏ𝜔p
,
(6.180)
where Aeff is the cross-section of the erbium ion distribution. Similarly, we have
𝜙s =
Ps
Aeffℏ𝜔s
.
(6.181)

278
Fiber Optic Communications
Substituting Eqs. (6.180) and (6.181) in Eq. (6.179), we obtain
N2 =
NT[P
′
s + P
′
p]
1 + P
′
p + P
′
s(1 + 𝜂)
,
(6.182)
N1 =
NT𝜂P′
s
1 + P
′
p + P
′
s(1 + 𝜂)
,
(6.183)
P
′
s = Ps
Pth
s
,
P
′
p =
Pp
Pth
p
,
(6.184)
𝜂= 𝜎21
𝜎12
,
(6.185)
where Pth
s and Pth
p are threshold powers given by
Pth
s = Aeffℏ𝜔s
𝜎12𝜏21
,
Pth
p =
Aeffℏ𝜔p
𝜎13𝜏21
.
(6.186)
The evolution of the signal beam due to stimulated emission, absorption, and scattering is similar to that of a
semiconductor laser (see Eq. (3.32)),
dPs
dz = ΓsgsPs −𝛼sPs,
(6.187)
where
gs = N2𝜎21 −N1𝜎12,
(6.188)
Γs is the overlap factor that accounts for the fraction of the optical mode cross-section of the signal that
overlaps with the erbium ion transverse distribution profile, and 𝛼s is the internal loss coefficient of the
erbium-doped fiber at the signal wavelength. Similarly, we have
dPp
dz = ΓpgpPp −𝛼pPp,
(6.189)
where
gp = −N1𝜎13.
(6.190)
Note that gp is negative and the pump power is attenuated, whereas gs could be positive indicating signal
amplification. Using Eqs. (6.180) and (6.183) in Eqs. (6.187) and (6.188), we obtain
gp = −NT𝜎13[1 + 𝜂P
′
s]
1 + P
′
P + P
′
s(1 + 𝜂)
,
(6.191)
gs =
NT𝜎12[𝜂P
′
p −1]
1 + P
′
P + P
′
s(1 + 𝜂)
.
(6.192)
Eqs. (6.187) and (6.189) together with Eqs. (6.191) and (6.192) form a coupled nonlinear differential equation
which governs the growth of signal and pump powers in the EDFA. Fig. 6.17 shows the numerical solution
of Eqs. (6.187) and (6.189) assuming the typical EDFA parameters. As can be seen, the signal is amplified
whereas the pump is attenuated. The small signal gain can be found analytically from Eqs. (6.187) and (6.189)
when Ps(z) ≪Pth
s and Pp(z) ≫Pth
p at any z, i.e., the signal is weak and the pump is strong. Under these
conditions, Eq. (6.192) reduces to

Optical Amplifiers
279
0
2
4
6
8
10
0
2
4
6
8
10
12
14
16
18
20
Amplifier length (m)
Power (mW)
Ps
Pp
Figure 6.17
Evolution of signal and pump power in EDFA.
gs = NT𝜎12𝜂,
(6.193)
and from Eq. (6.187) we obtain
Ps(L) = Ps(0) exp[(ΓsNT𝜎12𝜂−𝛼s)L].
(6.194)
Typically, 𝛼s ≪ΓsNT𝜎12𝜂and therefore, signal power grows exponentially with distance. Fig. 6.18 shows the
amplifier gain G as a function of the amplifier length for various pump powers. For the given pump power,
0
5
10
15
20
–50
–40
–30
–20
–10
0
10
20
30
Length (m)
G (dB)
Pp(0) = 0 dBm
Pp(0) = 3 dBm
Pp(0) = 6 dBm
Pp(0) = 12 dBm
Figure 6.18
Amplifier gain vs. length in EDFA. The amplifier gain becomes maximum at a certain amplifier length
which is a function of pump power.

280
Fiber Optic Communications
gain increases with distance initially and then it decreases. This is because the pump decays as it propagates
through the EDF and at a certain length, the pump power becomes less than or equal to Pth
p (Eq. (6.194) is no
longer valid in this case) and from Eq. (6.192), we find that gs could become zero or negative, which indicates
that the signal is attenuated. Physically, when the pump power is less than a certain threshold, erbium ions
pumped to level 2 (via level 3) are not adequate to cause population inversion. From a practical standpoint, it
is desirable to have a low pump threshold so that the population inversion can be achieved at relatively lower
pump powers. From Eq. (6.186), we see that the pump threshold is inversely proportional to the product of
pump absorption cross-section 𝜎13 and lifetime associated with the transition from level 2 to level 1, 𝜏21. The
larger pump absorption cross-section enables higher pump absorption. As a result, more erbium ions make
the transition to level 3 and consequently to level 2. The longer lifetime 𝜏21 implies that erbium ions are in
the excited level 2 for a longer time. For the erbium-doped silica fiber, the lifetime 𝜏21 is very large (∼10 ms)
and as result, the population inversion can be achieved with a low pump power.
Fig. 6.19 shows the dependence of the gain on the input signal power for various pump powers. The gain
saturates at large signal powers, which is similar to the case of semiconductor optical amplifiers.
6.7.3
Amplified Spontaneous Emission
So far we have ignored the impact of spontaneous emission. The Er3+ ions in the excited level spontaneously
emit photons. These photons are amplified as they propagate down the fiber leading to ASE. The population
density of the excited level is depleted because of the ASE and, therefore, the amplifier gain decreases. In the
case of EDFA, the fiber-loss coefficient is much smaller than the gain coefficient g and Eq. (6.5) can be used
to calculate the spontaneous noise factor nsp with a slight modification. Eq. (6.5) is valid for a non-degenerate
system. It is straightforward to modify Eq. (6.5) for the case of a degenerate system, as
nsp =
𝜎21N2
𝜎21N2 −𝜎12N1
.
(6.195)
Since the population densities N2 and N1 vary along the fiber length, Eq. (6.187) has to be solved numeri-
cally to obtain the ASE power. Typically, the noise figure (≈2nsp) of an EDFA is in the range of 4–8 dB.
Spontaneous emission occurs at random and in all directions. The optical field due to spontaneous emission
–60
–60
–50
–50
–40
–30
–20
–10
0
0
5
10
15
20
25
30
35
40
Input signal power (dBm)
G (dB)
Pp (0) =  6 dBm
Pp (0) = 5 dBm
Pp (0) = 3 dBm
Figure 6.19
Gain saturation in EDFA.

Optical Amplifiers
281
can be expressed as the superposition of the guided mode and radiation modes of the erbium-doped fiber.
The radiation modes escape to the cladding and do not degrade the system performance. Similarly, the ASE
propagating as a guided mode in the backward direction does not a effect the system performance. However,
backward-propagating ASE and radiation modes lead to degradation of the amplifier performance since the
ASE reduces the gain of the amplifier.
6.7.4
Comparison of EDFA and SOA
One of the disadvantages of SOAs is their polarization sensitivity. The amplifier gain G depends on whether
the mode in the waveguide is transverse electric (TE) or transverse magnetic (TM). Therefore, the incident
optical field with arbitrary polarization experiences different amounts of gain for its x- and y- polarization
components. This is known as polarization-dependent gain (PDG), which is undesirable for light-wave sys-
tems since it alters the polarization state of the light wave. Fiber amplifiers such as EDFA provide a uniform
gain for x- and y- polarization components because of the circular symmetry of the fiber.
Another drawback of the SOA is the presence of interchannel cross-talk for WDM systems (see Chapter 9).
Consider the signal corresponding to two channels of a WDM system,
q(t, z) = s1(t, z) exp(i𝜔1t) + s2(t, z) exp(i𝜔2t),
(6.196)
where 𝜔j and sj(t, z) are the optical carrier frequency and field envelope of the jth channel. The total signal
power is
P = |q|2 = |s1|2 + |s2|2 + 2|s1||s2| cos (Δ𝜔t + 𝜃1 −𝜃2),
(6.197)
where Δ𝜔= |𝜔1 −𝜔2| is the channel separation and 𝜃j = Arg[sj]. Substituting Eqs. (6.197) in Eqs. (3.117)
and (3.120), we obtain
dNe
dt
=
I
qV −Ne
𝜏e
−G0(Ne −N0)
ℏ𝜔
[|s1|2 + |s2|2 + 2|s1||s2| cos (Δ𝜔t + 𝜃1 −𝜃2)].
(6.198)
On the right-hand side of Eq. (6.198), we have a term oscillating at the beat frequency Δ𝜔. This leads to the
carrier population density Ne oscillating at the beat frequency Δ𝜔. Since the gain coefficient is related to Ne
by Eq. (6.142), the gain is also modulated at frequency Δ𝜔and from Eq. (3.32), we have
𝜕P
𝜕z = g(z, t)P.
(6.199)
Since the gain coefficient g(z, t) depends on the instantaneous channel powers |s1(t, z)|2 and |s2(t, z)|2, the
amplifier gain changes with time depending on the bit patterns in channels 1 and 2. Owing to the randomly
changing bit patterns, the noise in the system is enhanced, leading to performance degradations. This is known
as interchannel cross-talk. This cross-talk can be avoided if the SOA operates in the unsaturated regime.
However, in the WDM system, saturation occurs quickly because there are many channels and the signal
saturation power is the sum of the powers of each channel.
The carrier lifetime 𝜏e (𝜏e ∼0.5 ns) of the SOA is much shorter than the lifetime 𝜏21 (𝜏21 ∼10 ms) associated
with the excited state of erbium ions. When the bit interval Tb is much shorter than the lifetime 𝜏21, erbium
ions do not follow the fast variations of the signal, but they respond only to the average power of the signal.
Therefore, in this case, all pulses experience the same gain in the case of an EDFA. For example, when the
bit rate is 2.5 Gb/s, Tb = 0.4 ns ≪𝜏21 and the EDFA gain does not change from bit to bit. However, for SOA,
Tb and 𝜏e are comparable and the gain experienced by the current bit depends on the signal power of the
previous bits.

282
Fiber Optic Communications
6.8
Raman Amplifiers
Distributed Raman amplifiers have become a viable alternative to EDFAs because of their relatively lower
ASE [10, 13–15]. Raman amplifiers are based on stimulated Raman scattering, which occurs in fibers at high
powers (see Chapter 10 for more details). As an intense pump beam of frequency 𝜔p propagates down the
fiber, an optical wave of lower frequency 𝜔s is generated due to SRS. The frequency difference, 𝜔p −𝜔s = Ω,
is known as Stokes’s shift. If a signal field of frequency 𝜔s (Stokes wave) is incident at the input of the fiber
along with the pump beam, the signal field gets amplified due to SRS. As shown in Fig. 6.20, the pump photons
cause transitions to the excited level 3 from level 1, and silica molecules relax to one of the vibrational levels
in band 2; the energy difference ℏ(𝜔p −𝜔s) appears as molecular vibrations or optical phonons. If a signal
photon corresponding to the energy difference between level 3 and one of the levels in band 2 is present, the
molecules are stimulated to emit signal photons of the same kind, leading to the amplification of the signal
photons, which is known as SRS. The silica molecule could also make a transition to band 2 from level 3
by spontaneous emission, whether or not the signal beam is present. This is known as spontaneous Raman
scattering and is the source of noise in Raman amplifiers. Band 2 is a collection of vibrational states of silicon
molecules. In other words, part of the pump energy is converted into signal energy and the rest is dissipated as
molecular vibrations. Quantum mechanically, a pump photon of energy ℏ𝜔p is annihilated to create a signal
photon of lower energy ℏ𝜔s and an optical phonon of energy ℏΩ. A semiclassical description of the Raman
scattering is provided in Section 10.11. Fig. 6.21 shows the typical Raman gain spectrum as a function of
the frequency shift for a silica-core single-mode fiber. The frequency shift shown in Fig. 6.21 refers to the
frequency deviation of the Stokes wave from the pump. The Raman gain curve has a peak around a frequency
shift, Ω of about 14 THz. In amorphous materials such as fused silica, molecular vibrational states form a
continuum [14] shown by crossed lines in Fig. 6.20 and, therefore, the Raman gain occurs over a broad range
of frequencies up to 40 THz. Fig. 6.22 shows a schematic of the Raman amplifier with co-propagating pump.
Level 3
ħΩ
ħωs
ħωp
Level 1
Band 2 
(vibrational levels)
Figure 6.20
Energy levels of silica.
0
14 THz 
24 THz
Frequency shift
Normalized Raman 
gain coefficient
Figure 6.21
Typical Raman gain spectrum of silica fibers.

Optical Amplifiers
283
The signal and pump are combined using a fiber coupler and the combined signal is launched into the fiber.
For a signal wavelength at 1550 nm, the pump wavelength should be about 1450 nm to ensure the highest gain
(corresponding to a frequency difference of about 14 THz). To achieve a gain flatness over a broad range of
signal frequencies, multiple pumps are usually used in practical systems [10].
Fig. 6.23 shows a schematic of a Raman amplifier with counter-propagating pump. The advantage of a
counter-propagating pump scheme is that the transfer of power fluctuations from the pump to the signal can
be reduced compared with the co-propagating scheme. The lifetime associated with the excited state of silica
is in the range of 3 to 6 fs. Because of such a short lifetime, the transfer of power from the pump to the signal
is almost instantaneous, leading to the transfer of pump fluctuations to the signal. However, if the pump is
counter-propagating, the interaction time is equal to the transit time (= fiber length/speed of light) through
the fiber, which would be the effective lifetime. For an 80-km fiber length, the transit time is about 0.4 ms,
which is much larger than the actual lifetime (in the range of femtoseconds). In the scheme of co-propagating
pumps, the pump lasers must be very quiet, i.e., they must have very low-intensity fluctuations [10]. Some
light-wave systems use both co-propagating and counter-propagating pumps.
Raman amplifiers can be divided into two types: distributed and lumped. Distributed Raman amplifiers
utilize the existing transmission fiber as a gain medium, whereas in lumped Raman amplifiers a dedicated
short-span fiber is used to provide amplification. Typically, the length of the lumped amplifier is less than
15 km. In the case of lumped amplifiers, a highly nonlinear fiber with very small effective area can be used
so that the pump intensity (= power/area) and gain can be maximized. In contrast, in the case of a distributed
Raman amplifier, the fiber parameters can not be optimized to achieve the maximum gain since the nonlinear
effects are enhanced in small-effective-area fibers which leads to performance degradation (see Chapter 10).
6.8.1
Governing Equations
Assuming the signal and pump beams are CW, the evolution of the signal and pump powers for the
forward-pumping scheme is governed by (see Section 10.11)
dPs
dz =
gRPpPs
Ap
−𝛼sPs,
(6.200)
dPp
dz = −
𝜔p
𝜔s
gRPpPs
As
−𝛼pPp,
(6.201)
Fiber coupler
Pump, ωp
Signal, ωs
Fiber 
Amplified signal
Figure 6.22
Schematic of the Raman amplifier. The pump co-propagates with the signal.
Coupler
Signal
Fiber 
Amplified signal
Raman pump
Figure 6.23
Schematic of the Raman amplifier in which the pump is counter-propagating.

284
Fiber Optic Communications
where gR is the Raman gain coefficient; P, 𝛼, and A denote the power, loss coefficient, and effective
cross-section, respectively; and the subscripts p and s denote the pump and the signal, respectively. In
general, these equations have to be solved numerically to calculate the amplifier gain. But more insight can
be gained if we do the undepleted pump approximation. Under this approximation, the depletion of the pump
due to the transfer of power to the signal (first term in Eq. (6.201)) is ignored. The solution of Eq. (6.201)
under this approximation is
Pp(z) = Pp(0) exp(−𝛼pz).
(6.202)
Substituting Eq. (6.202 ) in Eq. (6.200) and rearranging, we obtain
dPs
Ps
=
gRPp(0) exp(−𝛼pz)
Ap
−𝛼s.
(6.203)
Integrating Eq. (6.203) from 0 to L, we find
ln Ps(L) −ln Ps(0) =
gRPp(0)Leff
Ap
−𝛼sL
(6.204)
or
Ps(L) = Ps(0) exp
[gRPp(0)Leff
Ap
−𝛼sL
]
,
(6.205)
where
Leff =
1 −exp(−𝛼pL)
𝛼p
(6.206)
is the effective fiber length over which the pump power is significant. The Raman amplifier gain may be
defined as
G =
Ps(L)
Ps(0) exp(−𝛼sL) = exp
[gRPp(0)Leff
Ap
]
.
(6.207)
When 𝛼pL >> 1, Leff ≈1∕𝛼p and Eq. (6.207) can be approximated as
G ≈exp
[gRPp(0)
Ap𝛼p
]
.
(6.208)
From Eq. (6.208), we see that the gain increases exponentially with the pump launch power and it is indepen-
dent of the fiber length (when 𝛼pL >> 1).
Fig. 6.24 shows the gain as a function of the fiber length obtained by solving Eqs. (6.200) and (6.201)
numerically. As can be seen, the gain becomes approximately independent of length for L > 40 km. The solid
and dotted lines in Fig. 6.25 show the evolution of signal power in the presence and absence of the Raman
pump, respectively. From Fig. 6.26, we see that the pump is almost depleted at the end of the fiber due to SRS
and fiber internal loss. Fig. 6.27 shows the gain as a function of the pump power for various signal powers. As
can be seen, the gain reduces as the signal launch power increases. This saturation effect is similar to that in
EDFA or SOA, and it can be understood from Eq. (6.201). When the signal launch power is large, the pump
depletes rapidly since the first term on the right-hand side is proportional to the signal power. A reduction in
pump power leads to a lower level of population inversion and the gain decreases. Nevertheless, the gain sat-
uration of Raman amplifiers occurs at much higher signal powers than that of SOA and EDFA signal powers,
which make them attractive for multi-channel amplification. Typically, the pump power required to achieve

Optical Amplifiers
285
0
10
20
30
40
50
0
2
4
6
8
10
12
14
Length (Km)
G (dB)
Pp(0) = 24 dBm
Pp(0) = 22  dBm
Pp(0) = 20 dBm
Figure 6.24
The gain of the Raman amplifier becomes roughly independent of length for large L. Signal launch power =
−6 dBm, gR = 6 × 10−14 m/W, Ap = 40 μm2, As = 50 μm2, 𝛼p = 9.21 × 10−5 m−1, 𝛼s = 4.605 × 10−5 m−1.
a certain gain for Raman amplifiers is larger than that needed for EDFA in the unsaturated regime. However,
as the signal power increases because of the increase in number of channels of a WDM system, the gain
of a Raman amplifier is greater than that of an EDFA [10]. This is because of the higher saturation power of
the Raman amplifier.
0
10
20
30
40
50
–20
–15
–10
–5
0
Length (km)
Signal Power (dBm)
In the presence of the pump
In the absence of the pump
Figure 6.25
Evolution of signal power in the Raman amplifier with and without the pump. Pp(0) = 23 dBm for the solid
line. The parameters are the same as those of Fig. 6.24.

286
Fiber Optic Communications
0
10
20
30
40
50
0
50
100
150
200
Length (km)
Pump power (mW)
Figure 6.26
Decay of the Raman pump. The parameters are the same as those of Fig. 6.24.
20
22
24
26
28
30
5
10
15
20
25
30
35
Pump power (dBm)
 G (dB)
Ps(0) = 0 dBm
Ps(0) = –6 dBm
Ps(0) = 6 dBm
Figure 6.27
Dependence of gain on the pump power. Gain saturates as the signal power increases. The parameters are
the same as those of Fig. 6.24.
For the backward-pumping scheme, the evolution of signal and pump powers is given by
dPs
dz = gr
Ap
PpPs −𝛼sPs,
(6.209)
−
dPp
dz = −
𝜔p
𝜔s
gR
As
PpPs −𝛼pPp.
(6.210)

Optical Amplifiers
287
Under the undepleted pump approximations, Eqs. (6.209) and (6.210) can be solved as before since the pump
is injected at z = L, the pump power at z = L, Pp(L) is known. Ignoring the first term on the right-hand side
of Eq. (6.210), the solution of Eq. (6.210) is
Pp(z) = PP(L) exp[−𝛼p(L −z)].
(6.211)
Substituting Eq. (6.211) in Eq. (6.209) and proceeding as before, we obtain the same expression for Ps(L) as in
Eq. (6.205). Thus, the gain for the forward- and backward-pumping scheme is the same under the undepleted
pump approximations.
6.8.2
Noise Figure
Spontaneous Raman scattering occurs randomly over the entire bandwidth of the amplifier and spontaneous
emission photons are amplified by SRS. The spontaneous emission factor, nsp, is nearly unity since a Raman
system acts as a fully inverted system with the ground-state population density N1 ≈0. Therefore, the noise
figure of the Raman amplifier is close to 3 dB, whereas that of the EDFA is typically in the range of 4 to 8 dB.
Distributed Raman amplifiers can be imagined as tiny amplifiers placed throughout the fiber transmission line
with very small amplifier spacing. Because of the distributed nature of the amplification, the OSNR of the
distributed Raman amplifiers is higher than that of the lumped amplifiers such as EDFA (see Section 7.4.2).
6.8.3
Rayleigh Back Scattering
One of the primary sources of noise in Raman amplifiers is double Rayleigh back scattering (DRBS). Consider
a signal propagating in the forward direction and ASE propagating backward in a distributed Raman amplifier
as shown in Fig. 6.28. Because of the microscopic non-uniformity of the silica composition, ASE gets reflected
and, therefore, it interferes with the signal, leading to performance degradation. This is known as single
Rayleigh back scattering (SRBS). Consider the signal and ASE both propagating in the forward direction, as
shown in Fig. 6.29. The ASE is reflected backward by a scatterer and it is reflected again by another scatterer,
Signal
Scatterer
ASE
Fiber core
Figure 6.28
Single Rayleigh back scattering.
Signal
Scatterer
Scatterer
ASE
Fiber core
Figure 6.29
Double Rayleigh back scattering.

288
Fiber Optic Communications
so that now the ASE and signal are both propagating in the forward direction. This is known as double
Rayleigh back scattering (DRBS). The DRBS occurs not only for ASE, but also for the signal modulated by
the data, i.e., a part of the modulated signal undergoes the DRBS process and interferes with the current bit.
Since the Rayleigh back scattering can occur anywhere along the fiber, the part of the signal that undergoes
DRBS has a random delay and it acts as noise on the current bit, leading to performance degradation. DRBS
also occurs in fibers without distributed amplification. However, in the presence of Raman amplification, the
back-scattered signal and ASE are amplified by SRS in both directions and, therefore, DRBS is one of the
primary sources of noise in the distributed Raman amplifiers.
6.9
Additional Examples
Example 6.8
In Fig. 6.30, transfer functions of the optical and electrical filters are ̃Hopt(f) and ̃He(f), respectively. Show
that the variance of the signal–ASE beat noise is
𝜎2
s−sp = 4R2Pout𝜌ASEBeff,
where
Beff = 1
2 ∫
∞
−∞
| ̃Hopt(f)|2| ̃He(f)|2df.
Solution:
From Eq. (6.27), we have
Is−sp(t) = R[𝜓outn∗
F(t) + 𝜓∗
outnF(t)].
The signal–ASE beat noise current passes through the electrical filter, as shown in Fig. 6.30. Let the corre-
sponding output of the electrical filter be IF(t), i.e.,
̃IF(f) = ̃Is−sp(f) ̃He(f).
(6.212)
Let
[nF(t)] = ̃nF(f),
(6.213)
[n∗
F(t)] = ̃n∗
F(−f).
(6.214)
Taking the Fourier transform of Eq. (6.27) and using Eqs. (6.212), (6.213), and (6.214), we obtain
̃IF(f) = R[𝜓out̃n∗
F(-f) + 𝜓∗
out̃nF(f)] ̃He(f).
(6.215)
G
OF
Hopt( f )
He( f )
PD 
EF
IO = R∣ψout + nF∣2
ψout + n
ψout + nF
ψin
Figure 6.30
Impact of optical and electrical filter on ASE. OF = optical filter, PD = photodetector, EF = electrical
filter.

Optical Amplifiers
289
Using Parseval’s theorem, the mean noise power is
Ns−sp = lim
T→∞
1
T ∫
T∕2
−T∕2
< I2
F(t) > dt
= lim
T→∞
1
T ∫
∞
−∞
< |̃IF(f)|2 > df.
(6.216)
From Eq. (6.215), we have
< |̃IF(f)|2 > = R2| ̃He(f)|2[|𝜓out|2 < |̃nF(f)|2 > +|𝜓out|2 < |̃nF(−f)|2 >
+(𝜓∗
out)2 < ̃nF(f)̃nF(−f) > +𝜓2
out < ̃n∗
F(−f)̃n∗
F(f) >].
(6.217)
The contribution of the third and fourth terms on the right-hand side of Eq. (6.217) is zero. This can be shown
by writing
nF(f) = |nF(f)| exp[i𝜃F(f)],
(6.218)
𝜓out = |𝜓out| exp[i𝜃out],
(6.219)
(𝜓∗
out)2 < ̃nF(f)̃nF(−f) > = < |̃nF(f)||̃nF(−f)| exp(i[𝜃F(f) + 𝜃F(−f) −2𝜃out] >)
𝜓2
out < ̃n∗
F(−f)̃n∗
F(f) > = < |̃nF(f)||̃nF(−f)| exp(i[−𝜃F(f) −𝜃F(−f) + 2𝜃out]) >,
(6.220)
(𝜓∗
out)2 < ̃nF(f)̃nF(−f) > +𝜓2
out < ̃n∗
F(−f)̃n∗
F(f) > = 2|𝜓out|2|̃nF(f)||̃nF(−f)|
< cos [𝜃F(f) + 𝜃F(−f) −2𝜃out] >
= 0,
(6.221)
since 𝜃F(f) is a random variable with uniform distribution in the interval [0, 2𝜋]. By definition, the power
spectral densities are
𝜌ASE = lim
T→∞
< |̃n(f)|2 >
T
,
(6.222)
𝜌nF = lim
T→∞
< |̃nF(f)|2 >
T
= 𝜌ASE| ̃Hopt(f)|2,
(6.223)
𝜌IF = lim
T→∞
< |̃IF(f)|2 >
T
.
(6.224)
Using Eqs. (6.217), (6.223), and (6.224), we find
𝜌IF = 2R2| ̃He(f)|2|𝜓out|2𝜌nF
= 2R2Pout𝜌ASE| ̃Heff(f)|2,
(6.225)
where
̃Heff(f) = ̃Hopt(f) ̃He(f)
(6.226)

290
Fiber Optic Communications
is the transfer function of an effective filter, which is the cascade of optical and electrical filters. From
Eqs. (6.216), (6.224), and (5.79), we have
Ns−sp = 𝜎2
s−spRL = RL ∫
∞
−∞
𝜌IF(f)df.
(6.227)
Therefore,
𝜎2
s−sp = 2R2Pout𝜌ASE ∫
∞
−∞
| ̃Heff(f)|2df
= 4R2Pout𝜌ASEBeff,
(6.228)
where Beff is the effective bandwidth of the filter obtained by cascading the optical and electrical filters.
Let us consider two limiting cases of Eq. (6.228). When the electrical filter bandwidth is much larger than the
optical filter bandwidth, i.e., ̃He(f) ≅1, from Eq. (6.226), we have ̃Heff(f) = ̃Hopt(f) and Eq. (6.228) reduces to
Eq. (6.42). When the optical filter bandwidth is much larger than the electrical filter bandwidth, i.e., ̃Hopt(f) ≅
1, ̃Heff(f) = ̃He(f), and Eq. (6.228) becomes
𝜎2
s−sp = 4R2Pout𝜌ASEBe,
(6.229)
where
Be = 1
2 ∫
∞
−∞
| ̃He(f)|2df.
(6.230)
When the optical filter is an ideal band-pass filter with full bandwidth fo and the electrical filter is an ideal
low-pass filter with bandwidth fe, it is easy to see that
Beff = min(fe, fo∕2).
(6.231)
Example 6.9
An amplifier has an output signal power of 0 dBm and a noise power per polarization per unit frequency
interval (single-sided) of −126 dBm/Hz. Calculate the variance of the signal–ASE beat noise current. Assume
Bo = 20 GHz, Be ≫Bo, and R = 0.9 A/W.
Solution:
Pout = 10Pout(dBm)∕10 = 1 mW.
The noise power per polarization per unit frequency interval is the single-sided power spectral density,
𝜌ASE,sp = 10𝜌ASE(dBm/Hz)∕10 mW/Hz
= 1.58 × 10−13 mW/Hz.
From Eq. (6.17), we have 𝜌ASE = 1.58 × 10−13 mW/Hz. Noise power PASE = 𝜌ASEBo = 3.17 mW.
The variance of the signal–ASE beat noise current is
𝜎2
s−sp = 2R2PoutPASE = 5.13 × 10−9 A2.

Optical Amplifiers
291
Example 6.10
Find an analytical expression for the mean and variance of ASE–ASE beat noise. Assume that the optical filter
is an ideal band-pass filter with bandwidth Bo and the samples of ASE noise n(t) are identically distributed
complex Gaussian random variables. Ignore the electrical filter.
Solution:
From Eqs. (6.21) and (6.28), it follows that
< Isp−sp > = R < |nF(t)|2 >= R𝜌ASEBo,
(6.232)
< I2
sp−sp > = R2 < |nF(t)|4 > .
(6.233)
Let
nF = nFr + inFi.
(6.234)
With the assumption that the samples of n(t) are identically distributed complex random variables, it follows
that
< n2
Fr > = < n2
Fi >= < |nF|2 >
2
= 𝜌ASEBo
2
,
(6.235)
< nFrnFi > = 0,
(6.236)
< |nF|4 > = < (n2
Fr + n2
Fi)2 >=< n4
Fr > + < n4
Fi > +2 < n2
Frn2
Fi > .
(6.237)
For Gaussian random variables N1, N2, N3, and N4, from the moment theorem, we have
< N1N2N3N4 >=< N1N2 >< N3N4 > + < N1N3 >< N2N4 > + < N1N4 >< N2N3 > .
(6.238)
If we choose Ni = nFr, i = 1, 2, 3, 4, using Eqs. (6.235) and (6.236), we find
< n4
Fr >= 3(< n2
Fr >)2 = 3𝜌2
ASEB2
o∕4.
(6.239)
Similarly,
< n4
Fi >= 3(< n2
Fi >)2 = 3𝜌2
ASEB2
o∕4.
(6.240)
If we choose N1 = N2 = nFr and N3 = N4 = nFi, we find
< n2
Frn2
Fi >= 𝜌2
ASEB2
o∕4.
(6.241)
Substituting Eqs. (6.239)–(6.241) in Eq. (6.237), and using Eq. (6.233), we obtain
< I2
sp−sp > = 2R2𝜌2
ASEB2
o,
(6.242)
𝜎2
sp−sp = < I2
sp−sp > −< Isp−sp>2,
(6.243)
𝜎2
sp−sp = R2𝜌2
ASEB2
o.
(6.244)

292
Fiber Optic Communications
Example 6.11
Show that the variance of ASE–ASE beat noise current for the case of arbitrary optical and electrical filters
(see Fig. 6.31) and for the case of a single polarization is given by
𝜎2
sp−sp = R2𝜌2
ASEB2
oe,
(6.245)
where
B2
oe = ∫∫H2
opt(t′′ −t′)He(t′)He(t′′)dt′dt′′.
(6.246)
Further, when the optical filter is an ideal band-pass filter with full bandwidth fo and the electrical filter is an
ideal low-pass filter with cutoff frequency fe, show that
B2
oe = (2fo −fe)fe
if
fe < fo,
(6.247)
= f 2
o
otherwise.
(6.248)
Solution: From Eq. (6.25), the current before the electrical filter is
Iin(t) = R{|𝜓out|2 + |nF(t)|2 + 2Re[𝜓outn∗
F(t)]}.
(6.249)
Let
Iin,sp−sp(t) = R|nF(t)|2.
(6.250)
Iout,sp−sp(t) = −1[̃Iin,sp−sp(f) ̃He(f)]
= ∫
∞
−∞
Iin,sp−sp(t′)He(t −t′)dt′.
(6.251)
Without loss of generality, let us assume that the decision is based on the sample at t = 0,
Iout,sp−sp(0) = ∫
∞
−∞
Iin,sp−sp(t′)He(−t′)dt′.
(6.252)
< Iout,sp−sp(0) > = R ∫
∞
−∞
< |nF(t′)|2 > He(−t′)dt′
= R𝜌ASEBo ∫
∞
−∞
He(t)dt,
(6.253)
where we have used Eq. (6.21 ). Since
̃He(f = 0) = ∫
∞
−∞
He(t)dt,
(6.254)
Optical 
~
Hopt(f)
Electrical filter
Photodetector
Iin(t) = R|ψout(t) + nF(t)|2
Iout(t)
 
ψout(t) + n(t)
ψout(t) + nF(t)
~He(f)
|  |2.
Figure 6.31
Impact of optical and electrical filters on ASE.

Optical Amplifiers
293
the mean noise current due to ASE–ASE noise beating is
< Isp−sp >=< Iout,sp−sp(0) >= R𝜌ASEBo ̃He(f = 0).
(6.255)
If the electrical filter is an ideal low-pass filter given by
He(f) = rect
( f
2fe
)
,
(6.256)
Eq. (6.255) becomes
< Isp−sp >= R𝜌ASEBo.
(6.257)
Squaring Eq. (6.252) and then averaging, we find
< I2
out,sp−sp(0) > = ∫
∞
−∞∫
∞
−∞
< Iin,sp−sp(t′)Iin,sp−sp(t′′)He(−t′)He(−t′′) > dt′dt′′
= R2
∫
∞
−∞∫
∞
−∞
< [n2
Fr(t′) + n2
Fi(t′)][n2
Fr(t′′) + n2
Fi(t′′)] >
×He(−t′)He(−t′′)dt′dt′′.
(6.258)
Using the moment theorem (see Eq. (6.238)), we obtain
< n2
Fr(t′)n2
Fr(t′′) > = < n2
Fr(t′) >< n2
Fr(t′′) > +2 < nFr(t′)nFr(t′′)>2,
(6.259)
< n2
Fi(t′)n2
Fi(t′′) > = < n2
Fi(t′) >< n2
Fi(t′′) > +2 < nFi(t′)nFi(t′′)>2,
(6.260)
< n2
Fr(t′)n2
Fi(t′′) > = < n2
Fr(t′) >< n2
Fi(t′′) > +2 < nFr(t′)nFi(t′′)>2.
(6.261)
< n2
Fr(t′) > = < n2
Fi(t′) >= 𝜌ASEBo∕2,
(6.262)
< nFr(t′)nFr(t′′) > = < nFi(t′)nFi(t′′) >= 𝜌ASE
2
opt(t′ −t′′),
(6.263)
< nFr(t′)nFi(t′′) > = 0,
(6.264)
where
[opt(t)] = | ̃Hopt(f)|2.
(6.265)
Using Eqs. (6.259)–(6.264) in Eq. (6.258), we find
< [n2
Fr(t′) + n2
Fi(t′)][n2
Fr(t′′) + n2
Fi(t′′)] >= 𝜌2
ASEB2
o + 𝜌2
ASE2
opt(t′ −t′′),
(6.266)
< I2
out,sp−sp(0) >= R2𝜌2
ASE[B2
oe + B2
oe],
(6.267)
B2
oe = ∫∫2
opt(t′′ −t′)He(t′)He(t′′)dt′dt′′,
(6.268)
e =
[
∫He(t′)dt′
]2
,
(6.269)
𝜎2
sp−sp =< I2
out,sp−sp > −< Iout,sp−sp>2.
(6.270)

294
Fiber Optic Communications
Using Eqs. (6.253) and (6.267), we obtain
𝜎2
sp−sp = R2𝜌2
ASEB2
oe.
(6.271)
Next, let us consider the case in which the optical filter is an ideal band-pass filter with full bandwidth fo and
the electrical filter is an ideal low-pass filter with cutoff frequency fe.
̃Hopt(f) = rect
( f
fo
)
,
(6.272)
̃He(f) = rect
( f
2fe
)
,
(6.273)
̃opt(f) = |Hopt(f)|2 = [rect(f∕fo)]2
(6.274)
= rect(f∕fo),
(6.275)
opt(t) = −1[rect(f∕fo)]
(6.276)
= fosinc(fot),
(6.277)
where
sinc(x) = sin (𝜋x)
𝜋x
,
(6.278)
2
opt(t) = f 2
o sinc2(fot).
(6.279)
Eq. (6.268) may be rewritten as
B2
oe = ∫u(t′′)He(t′′)dt′′,
(6.280)
u(t′′) = 2
opt(t′′) ∗He(t′′).
(6.281)
Here ∗denotes the convolution. Since the convolution in the time domain becomes a multiplication in the
frequency domain, the Fourier transform of Eq. (6.281) is
̃u(f) = ̃opt2(f)He(f).
(6.282)
̃opt2(f) = [2
opt(t′′)]
(6.283)
= [f 2
o sinc2(fot)]
(6.284)
= triang (f∕fo)fo,
(6.285)
where
triang (f∕fo) = 1 −|f|∕fo
if
|f| < fo,
(6.286)
= 0
otherwise.
(6.287)

Optical Amplifiers
295
Substituting Eq. (6.283) in Eq. (6.282), we find
̃u(f) = triang (f∕fo)rect(f∕(2fe))fo.
(6.288)
The product in Eq. (6.280) may be rewritten as a convolution in the frequency domain at f = 0 as
B2
oe = ∫
̃u(f) ̃He(−f)df,
(6.289)
̃u(f) ̃He(−f) = triang (f∕fo)rect
( f
2fe
)
rect
( f
2fe
)
fo,
(6.290)
= triang (f∕fo)rect
( f
2fe
)
fo.
(6.291)
First let us consider the case fe < fo. The integral in Eq. (6.289) is equal to the area of the shaded region shown
in Fig. 6.32.
B2
oe = (2fo −fe)fe.
(6.292)
If fe ≥fo, B2
oe equals the area of the triangle,
B2
oe = f 2
o .
(6.293)
Substituting Eqs. (6.292) and (6.293) in Eq. (6.271), we find
𝜎2
sp−sp = R2𝜌2
ASE(2fo −fe)fe
if
fe ≤fo,
(6.294)
= R2𝜌2
ASEf 2
o
otherwise.
(6.295)
fo
–fo
fo
fe
fo
fo triang (f/fo)
fo – fe
Figure 6.32
Calculation of the variance of ASE–ASE beat noise for the case of ideal optical and electrical filters.

296
Fiber Optic Communications
Example 6.12
The electrical SNRs at the amplifier input and output are 30 dB and 25 dB, respectively. The signal power
at the input and output of the amplifier are −13 dBm and 2 dBm, respectively. Find the ASE power spectral
density per polarization, 𝜌ASE. Assume that the carrier frequency f0 = 195 THz.
Solution:
Fn = SNRin
SNRout
Fn(dB) = (SNR)in(dB) −(SNR)out(dB)
= (30 −25) dB
= 5 dB,
Fn = 10Fn(dB)∕10 = 3.1623.
The amplifier gain is
G = Pout
Pin
,
G(dB) = Pout(dBm) −Pin(dBm) = 2 dBm −(−13) dBm = 15 dBm,
G = 10G(dB)∕10 = 31.62.
The ASE PSD is given by Eq. (6.102),
𝜌ASE = h f0(GFn −1)
2
= 6.626 × 10−34 × 195 × 1012 × (31.62 × 3.162 −1)∕2 W/Hz
= 6.39 × 10−18 W/Hz.
Example 6.13
A Fabry–Perot amplifier has a peak gain Gmax of 20 dB and a single-pass gain Gs of 5 dB. Calculate the
geometric mean of the facet reflectivity R. Assume R1 = R2.
Solution:
From Eq. (6.127), we have
√
Gmax =
(1 −R)
√
Gs
1 −RGs
.

Optical Amplifiers
297
10log 10Gmax = 20,
Gmax = 102 = 100,
Gs = 105∕10 = 3.16,
(1 −3.16R) × 10 = (1 −R)
√
3.16,
R = 0.276.
Example 6.14
A Fabry–Perot amplifier has to be designed such that its full 3-dB bandwidth is greater than 25 GHz. Calculate
the upper bound on the single-pass gain Gs. Assume R1 = R2 = 0.3, refractive index n = 3.5, amplifier length
L = 200 μm.
Solution:
From Eq. (6.128), we have
FSR =
c
2nL =
3 × 108
2 × 3.5 × 200 × 10−6 = 214 GHz.
From Eq. (6.132), the 3-dB bandwidth is
f3 dB = 2 FSR
𝜋
sin −1
{
1 −RGs
(4RGs
)1∕2
}
,
or
sin
(𝜋f3 dB
2FSR
)
= 1 −RGs
(4RGs)1∕2 .
(6.296)
If f3 dB = 25 GHz, the left-hand side of Eq. (6.296) becomes 0.1805:
(1 −0.3Gs)2 = 1.2Gs × (0.1805)2.
Solving the above quadratic equation, we find
Gs = 4.79
or
2.31.
If Gs = 4.79, (1 −RGs) < 0, which corresponds to biasing above the threshold and violates the condition
given by Eq. (6.118) and, therefore, it has to be rejected. To have f3 dB > 25 GHz, Gs has to be less than 2.31.

298
Fiber Optic Communications
Example 6.15
For a Fabry–Perot amplifier, show that the round-trip amplitude gain is
RGs =
√
Gmax −
√
Gmin
√
Gmax +
√
Gmin
,
where Gmax and Gmin are the maximum and minimum values of G.
Solution:
From Eq. (6.135), we have
√
Gmax
√
Gmin
= 1 + RGs
1 −RGs
= x,
or
(1 −RGs)x = (1 + RGs),
RGs = x −1
x + 1
=
√
Gmax −
√
Gmin
√
Gmax +
√
Gmin
.
Exercises
6.1
Explain the meaning of (a) signal–ASE beating noise and (b) ASE–ASE beating noise.
6.2
An optical amplifier operating at 1300 nm has a mean noise power per unit frequency interval per
polarization (single-sided) of −125 dBm/Hz. Calculate the noise figure. Assume G = 30 dB.
(Ans: 6 dB.)
6.3
The output of an amplifier passes through an ideal optical band-pass filter of bandwidth (fo) 20 GHz, a
photodetector of responsivity 0.9 A/W, and an ideal electrical low-pass filter of bandwidth (fe) 8.5 GHz.
The amplifier input power is −23 dBm and its gain is 20 dB. The OSNR at the amplifier output (in a
bandwidth of 12.49 GHz) is 15 dB. A polarizer is placed just before the photodetector, which blocks
one of the polarization modes. Find (a) the variance of the signal–ASE beat noise current and (b) the
variance of the ASE–ASE beat noise current. Repeat (a) and (b) if the polarizer is absent.
(Ans: (a) 8.75 × 10−9 A2; (b) 8.73 × 10−11 A2. When the polarizer is absent, (a) 8.75 × 10−9 A2;
(b) 1.746 × 10−10 A2.)
6.4
State the difference between OSNR and electrical SNR.

Optical Amplifiers
299
6.5
The OSNR (within a bandwidth of 0.1 nm) at the output of an amplifier operating at 1550 nm is 22 dB.
The output of the amplifier passes through an ideal photo-detector (𝜂= 1). Calculate the electrical
SNR at the photodetector. Ignore the thermal noise and ASE–ASE beat noise. Assume that the input
power of the amplifier is −20 dBm, gain G = 23 dB, Be ≪Bo, R = 0.8 A/W, and Be = 8 GHz.
(Ans: 20.92 dB.)
6.6
In a cavity-type SOA, R1 = R2 = 0.3, FSR = 30 GHz, and the single-pass gain Gs = 4.75 dB. Find (a)
the peak gain and (b) the gain G at frequency Δf = 5 GHz, where Δf is the frequency shift from the
resonant frequency. Assume n = 3.3.
(Ans: (a) 21.28 dB; (b) 2.07 dB.)
6.7
Explain the gain–bandwidth trade-off in semiconductor amplifiers.
6.8
In a cavity-type SOA, the maximum and minimum gains are 20.78 dB and 4.43 dB, respectively. The
geometric mean of the reflectivities, R, is 0.32. Calculate the single-pass gain Gs.
(Ans: 4.47 dB.)
6.9
In a cavity-type SOA, FSR = 300 GHz, refractive index n = 3.3, Gs = 4.3 dB. (a) Calculate the peak
gain Gpeak and the 3-dB bandwidth if R1 = R2 = 0.3, (b) repeat if R1 = R2 = 0.1.
(Ans: (a) Gpeak(dB) = 17.62 dB and f3 dB = 16.06 GHz; (b) Gpeak(dB) = 6.4 dB and f3 dB =
141.8 GHz.)
6.10
Explain how population inversion is achieved in an EDFA.
6.11
Explain the meaning of absorption cross-section.
6.12
Solve Eqs. (6.187) and (6.189) numerically and plot the signal power as a function of amplifier length
for various pump powers, Pp(0) = 10 mW and Ps(0) = 10 μW. Assume NT = 1.1 × 1025 m−3, Γs = 0.4,
Γp = 0.64, 𝜎13 = 2.7 × 10−25 m−2, 𝜎12 = 1.8 × 10−25 m−2, 𝜏21 = 12 ms, Aeff = 3.4 × 10−12 m−2.
6.13
Explain the difference between spontaneous Raman scattering and stimulated Raman scattering.
6.14
Solve Eqs. (6.200) and (6.201) numerically. Plot the gain as a function of the length for pump powers
Pp(0) = 200 mW and Ps(0) = 1 mW. Plot the gain obtained by the undepleted pump approximation
given by Eq. (6.207) and compare the analytical result (Eq. (6.207)) and that obtained by the numerical
solution of Eqs. (6.200 ) and (6.201). Assume 𝛼s = 0.2 dB/km and 𝛼p = 0.5 dB/km.
6.15
Provide an explanation as to why gain saturates for large signal powers in any type of amplifier.
6.16
In a distributed Raman amplifier system, the pump power of the input = 250 mW, effective area of
the pump mode = 30 μm2, loss coefficient at the pump wavelength = 9.5 × 10−5 m−1, Raman gain
coefficient gR = 6 × 10−14 m/W, and length = 50 km. Calculate the gain of the amplifier under the
undepleted pump approximation.
(Ans: 7.17 dB.)

300
Fiber Optic Communications
6.17
In a hybrid Raman/EDFA amplified system, the fiber loss at the signal wavelength = 0.18 dB/km,
EDFA gain = 14 dB. The hybrid Raman/EDFA compensates for the fiber loss exactly. Calculate the
Raman pump power. Assume the following parameters: Ap = 25 μm2, 𝛼p = 9 × 10−5 m−1, gR = 5.8 ×
10−14 m/W, fiber length = 100 km.
(Ans: 96.99 mW.)
6.18
Explain the difference between single Rayleigh scattering and double Rayleigh scattering.
Further Reading
A.E. Siegman, Lasers. University Science Books, Mill Valley, CA, 1986.
E. Desurvire, Erbium-doped Fiber Amplifiers John Wiley & Sons, Hoboken, NJ, 2002.
P.C. Becker, N.A. Olsson, and J.R. Simpson, Erbium-doped Fiber Amplifiers, Fundamentals and Technology. Academic
Press, SanDiego, 1999.
P.W. Milonni and J.H. Eberly, Laser Physics. John Wiley & Sons, Hoboken, NJ, 2010.
G.P. Agrawal and N.K. Datta, Semiconductor Lasers, 2nd edn., Van Nostrand Reinhold, New York, 1993.
B.E.A. Saleh and M.C. Teich, Fundamentals of Photonics, 2nd edn., John Wiley & Sons, Hoboken, NJ, 2007.
J.M. Senior, Optical Fiber Communications, 2nd edn., Prentice-Hall, London, 1992.
G. Keiser, Optical Fiber Communications, 4th edn., McGraw-Hill, New York, 2011.
G. Lachs, Fiber Optic Communications. McGraw-Hill, New York, 1998.
References
[1] G. Keiser, Optical Fiber Communications, 4th edn. McGraw-Hill, New York, 2011, chapter 11.
[2] P.C. Becker, N.A. Olsson, and J.R. Simpson, Erbium-doped Fiber Amplifiers, Fundamentals and Technology. Aca-
demic Press, San Diego, 1999.
[3] H. Kogelnik and A. Yariv, Proc. IEEE, vol. 52, p. 165, 1964.
[4] A. Yariv, Opt. Lett., vol. 15, p. 1064, 1990.
[5] G. Eisenstein and R.M. Jopson, Int. J. Electron., vol. 60, p. 113, 1986.
[6] M.J. Mahonny, J. Lightwave Technol., vol. 6, p. 531, 1988.
[7] T. Saitoh and T. Mukai, J. Lightwave Technol., vol. 6, p. 1656, 1988.
[8] T. Saitoh, T. Mukai, and O. Mukami, J. Lightwave Technol., vol. LT3, p. 288, 1985.
[9] E. Desurvire, Erbium-doped Fiber Amplifiers. John Wiley & Sons, Hoboken, NJ, 2002.
[10] M.N. Islam, IEEE J. Select. Top. Quant. Electron., vol. 8, p. 548, 2002.
[11] K. Rottwitt and A.J. Stentz, Raman amplification in lightwave communication systems. In I.P. Kaminow and
L. Tingye (eds), Optical Fiber Telecommunications IV A. Academic Press, San Diego, 2002, p. 217.
[12] A.F. Evans, A. Kobyakov, and M. Vasilyev, Distributed Raman transmission: applications and fiber issues. In M.N.
Islam (ed.), Raman Amplifiers in Telecommunications 2: Sub-Systems and Systems. Springer-Verlag, New York,
2004, p. 383.
[13] Y. Emori, S Kado, and S. Namiki, Opt. Fiber Technol., vol. 8, p. 383, 2002.
[14] R. Shuker and R.W. Gammon, Phys. Rev. Lett., vol. 25, p. 222, 1970.
[15] G.P. Agrawal, Nonlinear Fiber Optics, 4th edn. Academic Press, New York, 2007, chapter 8.

7
Transmission System Design
7.1
Introduction
So far, we have discussed photonic/optoelectronic components such as lasers, modulators, optical fibers,
optical amplifiers, and receivers. In this chapter, we put together these components to form a fiber-optic
transmission system. Critical system/signal parameters that affect the performance are identified and design
guidelines are provided. In Section 7.2, the performance of a simple fiber-optic system consisting of a trans-
mitter, a fiber, a preamplifier, and a receiver is analyzed. The transmission performance advantage of a
coherent receiver over the direct detection receiver for this unrepeatered system is discussed. Section 7.3
covers the dispersion-induced limitations and provides a simple design rule relating the bit rate, dispersion
coefficient, and reach. In Section 7.4, optical amplifier noise-induced limitations are discussed. For a long-haul
fiber-optic system, optical amplifier noise is one of the dominant impairments. A design rule pertaining to
amplifier spacing, number of amplifiers, and total reach is also discussed in Section 7.4.
7.2
Fiber Loss-Induced Limitations
Let us consider an unrepeatered direct detection system based on OOK, as shown in Fig. 7.1. Let Pin be the
transmitted power when ‘1’ is sent. The received power is
Pr =
{
P1r = Pin exp (−𝛼L)
when ‘1’ is sent,
P0r = 0
when ‘0’ is sent.
(7.1)
The variances of shot noise and thermal noise are given by Eqs. (5.72) and (5.76). Ignoring the dark current,
for bit ‘1’, we have
𝜎2
1,shot = 2qI1Be,
(7.2)
𝜎2
1,thermal = 4KBTBe∕RL,
(7.3)
where
I1 = RPin exp (−𝛼L)
(7.4)
is the mean photocurrent of bit ‘1’. The mean photocurrent of bit ‘0’ is
I0 = RP0r = 0.
(7.5)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

302
Fiber Optic Communications
Figure 7.1
A simple fiber-optic system consisting of a transmitter, a receiver, and an optical fiber.
The total variance is
𝜎2
1 = 𝜎2
1,shot + 𝜎2
1,thermal = 2qI1Be + 4KBTBe∕RL.
(7.6)
For bit ‘0’, the mean photocurrent I0 is zero and, therefore, the shot noise variance is negligible. The total
noise variance is
𝜎2
0 = 4KBTBe∕RL.
(7.7)
Fig. 7.2 shows a plot of current vs. time when the bit pattern is 1011. When the bit pattern is long, it is more
convenient to superpose the signals in two bit slots and obtain the eye diagram as shown in Fig. 7.3. If there is
no noise in the system, the lines overlap and the eye diagram would have four lines; the eye is then said to be
wide open (see Fig. 7.3(a)). In the presence of noise, the current in each bit slot fluctuates and the eye would
be partially closed (see Fig. 7.3(b)). If the difference between I1 and I0 is small, the eye opening is small and
if there is noise, this would lead to poor system performance. Therefore, to assess the quality of a signal at
the receiver, the Q-factor is defined as
Q = I1 −I0
𝜎1 + 𝜎0
.
(7.8)
Here, I1 and I0 are the mean currents at the upper level (bit ‘1’) and lower level (bit ‘0’) of the eye diagram,
respectively, and 𝜎1 and 𝜎0 are the standard deviations of bit ‘1’ and bit ‘0’, respectively. The analytical
expressions for these quantities are given by Eqs. (7.4)–(7.7). Physically, 𝜎j is a measure of the spread of
levels of bit ‘j’, j = 0, 1, and Ij is the mean of the levels of bit ‘j’ in the eye diagram. When the difference
0
1
2
3
4
5
0
1
0.2
0.2
0.4
0.6
0.8
1.2
1.4
1.6
Time, t/Tb
Current, I 
1
0
1
1
I1
I0
Figure 7.2
Time diagram of the current at the receiver.

Transmission System Design
303
0.5
0
0.5
1
x 10–10
0
1
0.2
0.4
0.6
0.8
1.2
1.4
Time (s)
Current, I 
0
1
0.2
0.4
0.6
0.8
1.2
1.4
Current, I 
I1
I0
0.5
0
0.5
1
x 10–10
Time (s)
(a) At the transmitter
(b) At the receiver
I1
I0
Figure 7.3
Eye diagrams. (a) At the transmitter and (b) at the receiver.
between the mean levels I1 −I0 is large and/or the spreads of the levels are small, the eye is wide open and
the Q-factor is large. Using Eqs. (7.4)–(7.8), the Q-factor may be written as
Q =
RP1r
√
aP1r + b +
√
b
,
(7.9)
where
P1r = Pin exp (−𝛼L),
(7.10)
a = 2qRBe,
(7.11)
b = 4kBTBe∕RL.
(7.12)
From Eqs. (7.9)–(7.10), we see that as the fiber loss increases, Q decreases. At the receiver, the samples
of current are taken at t = nTb and if the current sample is higher than the threshold current, IT, the decision
circuit decides that a bit ‘1’ is sent. Otherwise, a bit ‘0’ is sent. In the presence of noise and distortion, when
a bit ‘1’ is sent, the received current sample could be lower than IT, causing a bit error. Suppose there are Ne
bit errors in a long bit sequence consisting of N bits; the bit error rate is defined as
BER = lim
N→∞
Ne
N .
(7.13)
If we assume that the noise is Gaussian distributed, BER can be related to the Q-factor by (see Chapter 8)
BER = 1
2erfc
(
Q
√
2
)
≈exp(−Q2∕2)
√
2𝜋Q
.
(7.14)
When the variances of bit ‘1’ and ‘0’ are large or the difference between the means of ‘1’ and ‘0’ is small,
Q is small and hence the BER becomes large. To achieve a BER of 10−9, the required Q is 6. If Q < 6,
BER > 10−9. Therefore, the maximum transmission distance to achieve the fixed BER is determined by the
total loss in the system. Fig. 7.4 shows the BER as a function of transmission distance L for a 10-Gb/s system.
For fixed fiber length, the BER decreases as the received power (or the fiber launch power) increases. Suppose

304
Fiber Optic Communications
120
140
160
180
200
220
10–25
10–20
10–15
10–10
10–5
100
Fiber length (km)
BER
Pin= 0 dBm
109
Pin= 4 dBm
Pin= 2 dBm
Figure 7.4
BER as a function of fiber length. B = 10 Gb/s, Be = 7.5 GHz, RL = 1 kΩ, R = 1 A/W, T = 290 K, fiber loss
coefficient 𝛼= 0.2 dB/km.
Figure 7.5
A fiber-optic system consisting of a transmitter, a fiber, an amplifier, and a receiver.
we introduce a preamplifier of gain G, as shown in Fig. 7.5. Now, the received power is GPin exp (−𝛼L) when
‘1’ is sent. The preamplifier adds ASE noise with the PSD per polarization given by Eq. (6.17). The mean
current for bit ‘0’ is given by Eq. (6.84),
I0 = 2R𝜌ASEBo.
(7.15)
We assume that the optical filter is an ideal band-pass filter with bandwidth fo, the electrical filter is an ideal
low-pass filter with bandwidth fe, and fe < fo. In this case Bo = fo. The variance of bit ‘0’ is
𝜎2
0 = 𝜎2
shot,0 + 𝜎2
thermal,0 + 𝜎2
sp−sp.
(7.16)
Using Eqs. (5.72), (5.76), and (6.87), we find
𝜎2
0 = 2qI0fe + 4kBTfe
RL
+ 2R2𝜌2
ASE(2fo −fe) fe.
(7.17)
Similarly, the mean and variance for bit ‘1’ are
I1 = RGPin + 2R𝜌ASEfo,
(7.18)
𝜎2
1 = 𝜎2
shot,1 + 𝜎2
thermal,1 + 𝜎2
s−sp + 𝜎2
sp−sp.
(7.19)
Using Eqs. (5.72), (5.76), (6.83), and (6.87), we find
𝜎2
1 = 2qI1fe + 4kBTfe
RL
+ 2R2𝜌ASE[2Pout fe + 𝜌ASE(2fo −fe)fe].
(7.20)

Transmission System Design
305
120
140
160
180
200
220
10–20
10–15
10–10
10–5
100
Fiber length (km)
BER
10–9
with preamp.
w/o preamp.
Figure 7.6
BER as a function of fiber length with and without preamplifier. Pin = 2 dBm, nsp = 1.5, and G = 20 dB.
Other parameters are the same as in Fig. 7.4.
Using Eqs. (7.15), (7.17), (7.18), and (7.20) in Eqs. (7.8) and (7.14), the BER is calculated and shown in
Fig. 7.6. Using a preamplifier of 20-dB gain, the maximum transmission distance at a BER of 10−9 is about
200 km when the fiber launch power Pin = 2 dBm. Note that for the same launch power, the maximum trans-
mission distance is limited to about 130 km when no preamplifier is used. It can be increased to about 140 km
if the launch power is 4 dBm (see Fig. 7.4). Here, we have ignored the fiber nonlinear effects. In the pres-
ence of fiber nonlinearity, as the launch power increases, nonlinear distortions limit the maximum achievable
transmission distance (see Chapter 10).
Example 7.1
In the fiber-optic system of Fig. 7.1, it is desired that Q ≥6 at the receiver. Fiber loss coefficient
𝛼= 0.046 km−1 and length = 130 km. Find the lower limit on the transmitter power. Assume T = 25∘C,
RL = 50 Ω, R = 1 A/W, and Be = 7 GHz.
Solution:
From Eq. (7.9), we have
Q =
RP1r
√
aP1r + b +
√
b
,
(7.21)
P1r = Pin exp (−𝛼L),
(7.22)
a = 2qRBe,
(7.23)
= 2 × 1.602 × 10−19 × 1 × 7 × 109 A2∕W
= 2.24 × 10−9 A2∕W,

306
Fiber Optic Communications
b = 4kBTBe∕RL
= 4 × 1.38 × 10−23 × 298 × 7 × 109
50
A2
= 2.3 × 10−12A2.
(7.24)
Rearranging Eq. (7.21), we have
√
aP1r + b = RP1r
Q
−
√
b.
(7.25)
Squaring Eq. (7.25) and simplifying, we obtain
aP1r =
(RP1r
Q
)2
−2RP1r
√
b
Q
.
(7.26)
or
P1r = 2
√
b
RQ + aQ2
R2 .
(7.27)
When Q = 6,
P1r = 2 ×
√
2.3 × 10−12
6
+ 2.24 × 10−9 × 36
= 1.829 mW.
(7.28)
From Eq. (7.22),
Pin = P1r exp (𝛼L)
= 1.829 × 10−2 × exp (0.046 × 130)
= 7.23 mW.
(7.29)
The lower limit on the transmitter peak power is 7.23 mW. If Pin < 7.23 mW, Q < 6.
7.2.1
Balanced Coherent Receiver
Consider a fiber-optic system based on OOK. Let the output of the fiber-optic link be connected to a balanced
homodyne coherent receiver as shown in Fig. 7.7. In this analysis, we ignore the LO phase noise, relative
Figure 7.7
A fiber-optic system with a balanced coherent receiver.

Transmission System Design
307
intensity noise (RIN), and imperfections in 90∘hybrid. In the presence of shot noise, Eqs. (5.109) and (5.110)
are modified as (with 𝜔IF = 0, Δ𝜙= 𝜋∕2)
I+ = R
2 {Ar|s(t)|2 + |ALO|2 + 2ArALORe{s(t)}} + nshot+,
(7.30)
I−= R
2 {Ar|s(t)|2 + |ALO|2 −2ArALORe{s(t)}} + nshot−,
(7.31)
where nshot+ and nshot−are the shot noise introduced by PD+ and PD−, respectively. Subtracting Eq. (7.30)
from Eq. (7.31), we have
I = I+ −I−= 2RArALORe{s(t)} + nshot+ −nshot−.
(7.32)
Let
nshot = nshot+ −nshot−.
(7.33)
Since nshot+ and nshot−are statistically independent, the variance of nshot is the sum of the variances of nshot+
and nshot−:
𝜎2
shot = 𝜎2
shot+ + 𝜎2
shot−
= 2qI+Be + 2qI−Be.
(7.34)
Let
PLO = A2
LO,
(7.35)
Pr(t) = A2
rs2(t).
(7.36)
Here, PLO and Pr are the LO and receiver power, respectively. First consider the OOK. For bit ‘1’ (s(t) = 1
within the bit slot), the mean and variances of the current are
I1 = 2R
√
P1rPLO,
(7.37)
P1r = A2
r,
(7.38)
𝜎2
1,shot = 2qI1+Be + 2qI1−Be,
(7.39)
I1+ = R
2
{
P1r + PLO + 2
√
P1rPLO
}
,
(7.40)
I1−= R
2
{
P1r + PLO −2
√
P1rPLO
}
.
(7.41)
Using Eqs. (7.40) and (7.41), Eq. (7.39) becomes
𝜎2
1,shot = 2qBeR(P1r + PLO).
(7.42)
The total noise variance of ‘1’ is
𝜎2
1 = 𝜎2
1,shot + 𝜎2
1,thermal
= 2qBeR(P1r + PLO) + 4kBTBe∕RL.
(7.43)
Similarly, for bit ‘0’, we have
I0 = 0,
(7.44)

308
Fiber Optic Communications
𝜎2
0,shot = 2qBeRPLO,
(7.45)
𝜎2
0 = 2qBeRPLO + 4kBTBe∕RL.
(7.46)
The Q-factor is calculated as
QOOK = I1 −I0
𝜎1 + 𝜎0
.
(7.47)
Some approximations can be made to Eq. (7.47) to gain some insight. When PLO ≫P1r, from Eqs. (7.42)
and (7.45) we have
𝜎2
1,shot = 𝜎2
0,shot = 2qBeRPLO.
(7.48)
Let the photocurrent due to LO be ILO. Eq. (7.48) may be rewritten as
𝜎2
shot, eff ≡𝜎2
1,shot = 2qILOBe.
(7.49)
Comparing Eq. (7.49) with Eq. (5.72), the effective PSD of shot noise in balanced detection is
𝜌shot, eff = qILO
(7.50)
If PLO is sufficiently large, the shot noise will dominate the thermal noise and it may be ignored in Eqs. (7.43)
and (7.46),
𝜎2
1 = 𝜎2
0 = 2qBeRPLO.
(7.51)
Now Eq. (7.47) reduces to
QOOK =
2R
√
P1rPLO
2
√
2qBeRPLO
,
=
√
RP1r
2qBe
.
(7.52)
Note that the Q-factor is independent of PLO under these conditions. Using Eq. (5.17), the Q-factor may be
rewritten as
QOOK =
√
𝜂P1r
2hfBe
.
(7.53)
where f is the mean frequency. The energy of a bit ‘1’ at the receiver is E1r = P1rTb. If the receiver filter is
an ideal Nyquist filter (Be = 1∕(2Tb)), Eq. (7.53) becomes
QOOK =
√
𝜂N1r,
(7.54)
where N1r = E1r∕hf is the number of signal photons of bit ‘1’. For an OOK signal, the mean number of
received photons per bit, Nrec = N1r∕2. So, Eq. (7.54) becomes [1]
QOOK =
√
2𝜂Nrec.
(7.55)
For an ideal photondetector, 𝜂= 1. To have a BER of 10−9, Q = 6 and from Eq. (7.55), we see that the average
number of signal photons per bit, Nrec, should be 18. In other words, if the mean number of signal photons is

Transmission System Design
309
less than 18 for an OOK system, the BER exceeds 10−9. Since Pr = Pin exp(−𝛼L), the maximum transmission
distance at which the mean number of photons becomes equal to 18 can easily be calculated. For example,
when the peak fiber launch power Pin = 2 dBm and bit rate = 10 Gb/s, the peak received power is
Pr(dBm) = Pin(dBm) −loss(dB),
(7.56)
Pr = N1rhf
Tb
,
(7.57)
Pr(dBm) = 10 log10(2NrechfB)
(7.58)
= −43.3 dBm,
where Nrec = 18 and f = 193.54 THz is used. From Eq. (7.56), we find
loss(dB) = Pin(dBm) −Pr(dBm)
(7.59)
= 2 dBm −(−43.3) dBm
= 45.3 dB.
With fiber loss coefficient 𝛼= 0.2 dB/km, the maximum transmission distance to reach the BER of 10−9 is
about 225 km. This should be compared with the results shown in Fig. 7.4 for the case of a direct detection
system, in which the transmission distance is limited to about 130 km for the same launch power. Fig. 7.8
shows the BER as a function of the length for various launch powers. Solid line and × marks show the BER
using the exact Q (Eq. (7.47)) and the approximate Q (Eq. (7.52)), respectively. As can be seen, there is a
good agreement between the two. However. if the LO power is not sufficiently large, the thermal noise could
dominate the shot noise and Eq. (7.52) would not be accurate. Fig. 7.9 shows the dependence of BER on the
LO power for different load resistances, calculated using Eq. (7.47). As can be seen, when the LO power is
small, the BER is large due to thermal noise. When the LO power is large, the shot noise dominates over the
thermal noise and the BER becomes roughly equal for a range of load resistances.
230
240
250
260
270
280
290
300
10–10
10–5
100
Fiber length (km)
BER
Pin = 0 dBm
Pin = 2 dBm
Pin = 4 dBm
Figure 7.8
BER as a function of the fiber length for a fiber-optic system based on OOK with balanced coherent detection.
Parameters: PLO = 100 mW, T = 290 K, RL = 100 Ω, and 𝜂= 1. Laser phase noise is ignored.

310
Fiber Optic Communications
5
0
5
10
15
10–6
10–8
10–10
10–12
10–4
LO power (dBm)
BER
100 Ohms
200 Ohms
50 Ohms
Figure 7.9
BER as a function of LO power. L = 230 km, other parameters are the same as those of Fig. 7.8 except for
LO power and RL.
Next, let us consider PSK. For bit ‘1’, the mean and variances are the same as those of OOK given by Eqs.
(7.37)–(7.46). For bit ‘0’,
I0 = −2R
√
P1rPLO,
(7.60)
𝜎2
0 = 𝜎2
1.
(7.61)
When the PLO is sufficiently large, the Q-factor can be calculated as before:
QPSK =
√
2𝜂P1r
hfBe
= 2
√
𝜂N1r.
(7.62)
For PSK, Nrec = N1r. So, Eq. (7.62) becomes
QPSK = 2
√
𝜂Nrec.
(7.63)
To have a BER of 10−9, the average number of signal photons per bit should be 9 assuming 𝜂= 1 [1, 2].
Comparing Eqs. (7.55) and (7.63), we see that the receiver sensitivity can be improved by 3 dB using PSK
for the fixed number of mean received photons. Fig. 7.10 shows the theoretical limit on the achievable
BER for a shot noise-limited system. As can be seen, for the given mean received power, the PSK outper-
forms the OOK. In other words, to achieve a given BER, the mean received power for OOK should be 3 dB
higher than that for PSK. The reason for the superior performance of the PSK is that constellation points are
separated by 2
√
Prec for PSK, whereas the corresponding separation for OOK is
√
2Prec(Prec = P1,rec∕2).
In [3], the receiver sensitivity close to the shot noise limit is experimentally demonstrated in a 10-Gb/s
PSK system.

Transmission System Design
311
52
51
50
49
48
47
46
45
Av. received power (dBm)
BER
3 dB
PSK
OOK
10–5
10–9
10–10
10–15
10–20
Figure 7.10
BER as a function of the mean received power. Thermal noise is ignored.
Example 7.2
In a 1.55-μm coherent fiber-optic system as shown in Fig. 7.7, the parameters are as follows. Mean fiber
launch power = 1 dBm, fiber loss = 0.2 dB/km, fiber length = 240 km, quantum efficiency 𝜂= 0.7, T = 290 K,
RL = 100 Ω, PLO = 10 dBm, and Be = 7.5 GHz. Calculate exact and approximate Q-factor if the signal is (a)
OOK, (b) PSK. Assume that the NRZ format with rectangular pulses is used.
Solution:
The mean frequency
f = c
𝜆=
3 × 108
1.55 × 10−6 = 193.54 THz.
(7.64)
The responsivity is given by Eq. (5.17),
R = 𝜂q
hf
=
0.7 × 1.602 × 10−9
6.626 × 10−34 × 193.54 × 1012 A/W.
= 0.874 A/W.
(7.65)
(a) For OOK, the peak power is twice the average power Pin when the NRZ with rectangular pulses is used:
Pin = 2Pin.
(7.66)
Eq. (7.66) may be rewritten in dB units as
Pin(dBm) = 10 log102 + Pin(dBm)
(7.67)
= 4 dBm.
The received peak power is
P1r = Pin exp(−𝛼L),
(7.68)

312
Fiber Optic Communications
P1r(dBm) = Pin(dBm) −loss(dB)
(7.69)
= 4 −0.2 × 240 = −44 dBm
= 10P1r(dBm)∕10 mW = 3.98 × 10−5 mW,
PLO = 10PLO(dBm)∕10 mW = 10 mW.
(7.70)
The mean of bit ‘1’ is
I1 = 2R
√
P1rPLO
(7.71)
= 2 × 0.874
√
3.98 × 10−5 × 10 mA
= 3.48 × 10−2 mA.
The total noise variance of ‘1’ is given by Eq. (7.43),
𝜎2
1 = 2qBeR(P1r + PLO) + 4kBTBe∕RL
(7.72)
= 2 × 1.602 × 10−19 × 7.5 × 109 × 0.874 × (3.98 × 10−8 + 10−2)
+ 4 × 1.38 × 10−23 × 290 × 7.5 × 109∕100 A2
= 2.22 × 10−11 A2.
The mean and variance of ‘0’ are calculated as follows:
I0 = 0.
(7.73)
Since P1r ≪PLO, comparing Eqs. (7.43) and (7.46), we find
𝜎2
1 = 𝜎2
0 = 2.22 × 10−11 A2,
(7.74)
Q = I1 −I0
𝜎1 + 𝜎0
(7.75)
=
3.48 × 10−5
2 ×
√
2.22 × 10−11
= 3.7.
The approximate Q-factor is given by Eq. (7.53),
Q =
√
𝜂P1r
2hfBe
= 3.8.
(7.76)
(b) For PSK, the peak power is the same as the average power,
Pin = Pin.
(7.77)
Pin(dBm) = 1 dBm.
(7.78)
The peak power at the receiver is
P1r(dBm) = Pin(dBm) −loss(dB)
(7.79)
= 1 −0.2 × 240
= −47 dBm,
(7.80)

Transmission System Design
313
P1r = 1.99 × 10−5 mW.
(7.81)
The mean of bit ‘1’ is
I1 = 2R
√
P1rPLO,
(7.82)
= 2.46 × 10−2 mA.
(7.83)
The noise variance of ‘1’ may be calculated as before,
𝜎2
1 = 2qBeR(P1r + PLO) + 4kBTBe∕RL
(7.84)
= 2.22 × 10−11 A2.
(7.85)
For bit ‘0’,
I0 = −I1
(7.86)
= −2.46 × 10−2 mA,
𝜎0 = 𝜎1.
(7.87)
Therefore, the Q-factor is
Q = I1
𝜎1
= 5.23.
(7.88)
The approximate Q-factor for PSK is given by Eq. (7.62),
QPSK =
√
2𝜂P1r
hfBe
(7.89)
= 5.38.
(7.90)
7.3
Dispersion-Induced Limitations
Consider a simple fiber-optic system consisting of an OOK transmitter, a receiver, and a fiber, as shown in
Fig. 7.11. Fig. 7.12 shows the input and output bit patterns. As can be seen, a pulse corresponding to bit ‘1’
broadens and occupies the adjacent bit slot corresponding to bit ‘0’. This is known as inter-symbol interference
(ISI), and it leads to performance degradation. To estimate the maximum achievable transmission distance
with negligible ISI for the given bit rate, let us consider a single Gaussian pulse launched to the fiber,
u(t, 0) = Ain exp
(
−t2
2T2
0
)
.
(7.91)
Figure 7.11
A simple fiber-optic system.

314
Fiber Optic Communications
–2
–1
0
(a)  Input
(b)  Output
1
2
0
0.2
0.4
0.6
0.8
1
Time (t/Tb)
Time (t/Tb)
Power (mW)
1
1
1
0
–3
–2
–1
0
1
2
3
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
Power (mW)
Figure 7.12
Input and output of the fiber. 𝛽2 = −21 ps2/km, L = 40 km, FWHM = 50 ps, bit rate = 10 Gb/s. Fiber loss
is ignored. (a) Input and (b) output.
After propagating a distance L, the power distribution is given by Eq. (2.161),
P(t, L) = Pin exp
(
−t2
T2
L
)
,
(7.92)
where
T2
L =
T4
0 + 𝛽2
2L2
T2
0
.
(7.93)
The FWHM at the transmitter and the receiver is 1.665T0 and 1.665TL, respectively. From Eq. (7.93), we see
that if we choose very small T0, TL becomes very large since T2
0 appears in the denominator. If we choose
very large T0, TL could become large when T4
0 ≫𝛽2
2L2. Therefore, for the given |𝛽2|L, T0 has to be optimized.
The optimum T0 can be found by setting
dTL
dT0
= 0.
(7.94)
Using Eq. (7.93 ) in Eq. (7.94), we find the optimum T0 as
Topt
0
=
√
𝛽2L.
(7.95)
The r.m.s. width of a Gaussian pulse is related to T0 by [4]
𝜎(z = 0) ≡𝜎0 = T0∕
√
2,
(7.96)
𝜎(z = L) ≡𝜎L = TL∕
√
2.
(7.97)
Now, Eq. (7.93) may be rewritten as
𝜎2
L =
4𝜎4
0 + 𝛽2
2L2
4𝜎2
0
.
(7.98)

Transmission System Design
315
To have negligible ISI, the pulse at the receiver should remain within its bit slot. The commonly used criterion
is [4]
𝜎L ≤TB∕4,
(7.99)
where TB is the bit interval. Using Eqs. (7.98) and (7.99), we obtain
[
4𝜎4
0 + 𝛽2
2L2
4𝜎2
0
]1∕2
B ≤1
4.
(7.100)
If we choose the optimum pulse width Topt
0 , the corresponding 𝜎opt
0
is
√
𝛽2L∕2. Using this value of 𝜎0 in
Eq. (7.100), we find [4]
B(|𝛽2|L)1∕2 ≤1
4.
(7.101)
For fixed |𝛽2|, as the bit rate increases linearly, the maximum transmission distance decreases as L−1∕2. To
undo the pulse broadening due to fiber dispersion, a DCF may be used (see Chapter 2) or it may be com-
pensated in the electrical domain using a DSP (see Chapter 11). In some applications such as metro/access
networks, it would be expensive to use DCF or coherent receivers. For such applications, Eq. (7.101) provides
a simple design rule relating the reach, bit rate, and dispersion.
Example 7.3
A fiber-optic system is upgraded to operate at 10 Gb/s from 2.5 Gb/s. The maximum transmission distance at
2.5 Gb/s at a BER of 10−9 was 100 km. Find the corresponding distance at 10 Gb/s. Assume that the trans-
mission fiber is unchanged and the penalty due to fiber dispersion is the same in both systems.
Solution:
Let
B1 = 2.5 Gb/s, B2 = 10 Gb/s,
L1 = 160 km.
From Eq. (7.101), we have
B1L1∕2
1
= B2L1∕2
2 ,
L2 = 10 km.
7.4
ASE-Induced Limitations
To transmit an optical signal over a long distance, amplifiers have to be introduced along the transmission
line. Otherwise, the received power could be too low to detect. In Section 7.2.1, we found that 9 photons/bit
is required at the receiver for a PSK signal to achieve a BER of 10−9. The number of photons/bit at the
receiver can be increased by introducing amplifiers. However, amplification by stimulated emission is always
accompanied by ASE, which enhances the noise in the system. In a long-haul fiber-optic system consisting
of a chain of amplifiers, ASE builds up over many amplifiers, which degrades the transmission performance.

316
Fiber Optic Communications
Figure 7.13
A long-haul fiber-optic system consisting of a transmitter, a receiver, N fibers, and N amplifiers.
In this section, we ignore the fiber dispersion and consider only the fiber loss, amplifier gain, and ASE.
Fig. 7.13 shows a fiber-optic system consisting of transmission fibers and in-line amplifiers. Let Hj and Gj,
j = 1, … , N be the fiber loss and amplifier gain of the jth stage, respectively. The power spectral density of
ASE introduced by the jth amplifier per polarization is
𝜌ASE,j = nsphf(Gj −1).
(7.102)
Let us first consider the signal propagation in the absence of noise. Let Pin be the mean transmitter output
power. In this section, we assume that the transmitter output is CW. Later, in Sections 7.4.3 and 7.4.4, we
consider the OOK/PSK modulation formats. The received power is
Pr =
N
∏
j=1
HjGjPin.
(7.103)
Next, let us consider the propagation of ASE due to the first amplifier. Let the full bandwidth of the optical
filter be Δf. The noise power per polarization within the filter bandwidth immediately after the first amplifier
is nsphf(G −1)Δf. Therefore, the mean noise power at the receiver due to the first amplifier is
P1,ASE = nsphf(G1 −1)Δf
N
∏
j=2
HjGj.
(7.104)
The mean noise power at the receiver due to the nth amplifier is
Pn,ASE = nsphf(Gn −1)Δf
N
∏
j=n+1
HjGj.
(7.105)
The total mean noise power at the receiver due to all the amplifiers is
PASE =
N
∑
n=1
Pn,ASE = nsphfΔf
N
∑
n=1
(Gn −1)
N
∏
j=n+1
HjGj.
(7.106)
When an in-line amplifier fully compensates for the fiber loss, we have Gj = 1∕Hj. From now on, we assume
that amplifiers (and fibers) are identical and Gj = 1∕Hj. Now, Eq. (7.106) can be simplified as
PASE = NnsphfΔf(G −1),
(7.107)
where G = Gj, j = 1, 2, … , N. The cascade of in-line amplifiers and fibers is equivalent to a single amplifier
with unity gain and power spectral density of ASE,
𝜌eq
ASE = Nnsphf(G −1).
(7.108)

Transmission System Design
317
In this section, we assume ideal in-line amplifiers. If EDFAs are used as in-line amplifiers, the saturation
power of each successive amplifier has to be increased slightly to compensate for the gain saturation caused
by the build-up of the ASE [5]. The optical signal-to-noise ratio is defined as (Eq. (6.107))
OSNR =
mean signal power
mean noise power in a bandwidth of Bopt
,
(7.109)
where Bopt is the reference bandwidth, typically chosen to be 12.5 GHz. The noise power in both polarizations
is twice that given by Eq. (7.107). Using Eqs. (7.103) and (7.107), we find the OSNR at the receiver to be
OSNR =
Pin
2Nnsphf(G −1)Bopt
.
(7.110)
Sometimes, it is convenient to express OSNR in dB units. Assuming G ≫1 and noise figure Fn ≅2nsp, and
dividing the numerator and denominator of Eq. (7.110) by 1 mW, it can be written in dB units as
OSNR(dB) = Pin[dBm] −N[dB] −G[dB] −Fn[dB] −10 log10
(
hfBopt
1 mW
)
= Pin[dBm] −N[dB] −G[dB] −Fn[dB] + 58,
(7.111)
where we have used f = 194 THz.
7.4.1
Equivalent Noise Figure
Fig. 7.14(a) shows a two-stage amplifier with loss element, such as a dispersion compensation module
between the two stages. Fig. 7.14(b) shows the equivalent amplifier with gain Geq and noise figure Fn,eq.
From Fig. 7.14(a), it is easy to see that
Pout = G1HG2Pin.
(7.112)
Therefore,
Geq = G1HG2.
(7.113)
The ASE PSD of the amplifier j is given by Eq. (6.102),
𝜌ASE,j = (GjFn, j −1) hf∕2,
j = 1, 2.
(7.114)
The noise power per polarization due to the amplifier 1 in a bandwidth of Δf is
N1 = 𝜌ASE,1Δf.
(7.115)
(a) Two-stage amplifier
(b) Equivalent amplifier
Figure 7.14
Two-stage amplifier with a loss element in between. (a) Two-stage amplifier and (b) Equivalent amplifier.

318
Fiber Optic Communications
The ASE due to amplifier 1 is attenuated by the loss element and, then, it is amplified by the second amplifier.
Therefore, the noise power due to amplifier 1 at the output end is
Nout,1 = 𝜌ASE,1ΔfHG2.
(7.116)
Similarly, the noise power due to amplifier 2 at the output end is 𝜌ASE,2Δf, and the total noise power at the
output is
Nout = (𝜌ASE,1HG2 + 𝜌ASE,2)Δf.
(7.117)
Therefore, the PSD at the output is
𝜌ASE,eq = Nout
Δf = 𝜌ASE,1HG2 + 𝜌ASE,2.
(7.118)
Using Eq. (7.114), we obtain
𝜌ASE,eq = [G1Fn,1G2H + G2Fn,2 −HG2 −1] hf∕2.
(7.119)
For an equivalent amplifier shown in Fig. 7.14(b), we have
𝜌ASE,eq = (GeqFn,eq −1)hf∕2.
(7.120)
Comparing Eqs. (7.119) and (7.120), we obtain
Fn,eq = Fn,1 +
Fn,2
G1H −1
G1
.
(7.121)
Note that in Eq. (7.121), the noise figure of the second amplifier is divided by the gain of the first ampli-
fier and the loss, H. Therefore, in practice, an amplifier with higher noise figure is used as the second
stage and/or an amplifier with higher gain is used as the first stage. Typically, G1 ≫1 and Eq. (7.121)
reduces to
Fn,eq ≅Fn,1 +
Fn,2
G1H .
(7.122)
If two amplifiers are cascaded without a loss element in between, H = 1 and Eq. (7.122) becomes [4, 6]
Fn,eq ≅Fn,1 +
Fn,2
G1
.
(7.123)
The effective noise figure of a cascaded chain of k amplifiers is given by (Exercise 7.9)
Fn,eq = Fn,1 +
Fn,2 −1
G1
+
Fn,3 −1
G1G2
+ · · · +
Fn,k −1
G1G2 · · · Gk−1
.
(7.124)
7.4.2
Impact of Amplifier Spacing
Consider the long-haul fiber-optic system with identical amplifier gains and noise figures. The power spectral
density of ASE at the output is given by (Eq. (7.108))
𝜌eq
ASE,1 = nsphf[exp (𝛼La) −1]N,
(7.125)
where L is the amplifier spacing and G = exp (𝛼La). Let the total transmission distance, Ltot, be NL. Eq.
(7.125) can be rewritten as
𝜌eq
ASE,1 = nsphf[exp (𝛼La) −1]Ltot
La
.
(7.126)

Transmission System Design
319
0
50
100
150
0
0.5
1
1.5
2
2.5
3
3.5 x 10–16
Amplifier spacing,  L (km)
ρeq
ASE
Figure 7.15
Dependence of the effective PSD on the amplifier spacing in a long-haul fiber-optic system.
Suppose we reduce the amplifier spacing by a factor of 2, but keep Ltot fixed. Now, the PSD is
𝜌eq
ASE,2 = nsphf[exp (𝛼La∕2) −1] Ltot
La∕2.
(7.127)
By expanding the exponential function by a Taylor series, it is easy to show that 𝜌ASE,2 < 𝜌ASE,1. In general,
as the amplifier spacing is increased, the PSD of ASE at the output becomes large. This is because the PSD
increases exponentially with L due to the first term in the square bracket of Eq. (7.126) when exp(𝛼La) ≫1,
although it scales inversely with La due to the term in the denominator. In practice, exp(𝛼La) ≫1 and the
exponential growth dominates the linear increment. Fig. 7.15 shows the PSD of ASE at the receiver as a func-
tion of amplifier spacing. As can be seen, the PSD of ASE increases almost exponentially with the amplifier
spacing. From the theoretical standpoint, it is desirable to make the amplifier spacing as small as possible.
However, due to practical limitations, the amplifier spacings are in the range of 60–125 km for long-haul
terrestrial communication systems. If distributed amplification, such as Raman amplifiers, is used, the growth
of ASE power can be substantially reduced.
7.4.3
Direct Detection Receiver
Let us consider the impact of ASE in a long-haul direct detection system consisting of a chain of amplifiers
as shown in Fig. 7.13 based on OOK. When a bit ‘1’ is sent, the optical power at the receiver is
P1r = Pin,
(7.128)
where Pin is the peak power. The mean currents are
I1 = RPin + 2R𝜌eq
ASEBo,
(7.129)
I0 = 2R𝜌eq
ASEBo.
(7.130)

320
Fiber Optic Communications
As in Section 7.2, we assume that the optical filter is an ideal band-pass filter with bandwidth B0 = f0, and
the electrical filter is an ideal low-pass filter with bandwidth fe. The variances of bit ‘0’ and ‘1’ are given by
Eqs. (7.17) and (7.20), respectively as
𝜎2
0 = 2qI0 fe + 4kBTfe
RL
+ 2R2(𝜌eq
ASE
)2(2fo −fe)fe,
(7.131)
𝜎2
1 = 2qI1 fe + 4kBTfe
RL
+ 2R2𝜌eq
ASE[2Pin fe + 𝜌eq
ASE(2fo −fe)fe].
(7.132)
The long-haul fiber-optic systems are typically amplifier noise-limited and, hence, some approximations
can be made while calculating the Q-factor. The variance of shot noise and thermal noise can be ignored
compared with the variance of signal–spontaneous beat noise. Also, when the signal power is large,
spontaneous–spontaneous beat noise can be ignored as well. Under these conditions,
𝜎2
1 ≅4R2Pin[Nnsphf(G −1)]fe,
(7.133)
𝜎2
0 ≅0,
(7.134)
Q ≅
√
Pin
4Nnsphf(G −1)fe
.
(7.135)
From Eq. (7.135), we see that the Q-factor is independent of the responsivity R, under these approximations.
Q can be increased by increasing Pin or decreasing the gain G. Since G = 1∕H, Q can be increased by using
low-loss fibers. From Eq. (7.135), we see that as the number of amplifiers (or nsp or G) increases, Pin has to
be increased to keep the Q-factor at a fixed value. The enhancement of the signal power to counter the noise
increase is known as the power penalty. Suppose the number of amplifiers increases from N to 2N, then the
launched power should be doubled to keep the Q-factor fixed (or equivalently, BER fixed). In this case the
power penalty is 3 dB. Using Eqs. (7.110) and (7.135), we find
OSNR = Q2fe
Bopt
,
(7.136)
where we have used Pin = Pin∕2 for OOK. Solid and dotted lines in Fig. 7.16 show the BER obtained using
the exact Q-factor (Eqs. (7.131) and (7.132)) and approximate Q-factor (Eq. (7.135)), respectively. Since
50
60
70
80
90
100
No. of amplifiers
BER
Pin= –6 dBm
Pin= –3 dBm
10–5
10–10
10–15
10–20
10–25
Figure 7.16
BER vs. number of amplifiers for direct detection system. Parameters: nsp = 2, 𝛼= 0.2 dB/km, amp. spacing
= 80 km, gain G = 16 dB, RL = 1000 Ω, T = 200 K, R = 1 A/W.

Transmission System Design
321
the difference between these curves is negligible, the approximation that the variance of receiver noise is
much smaller than that of ASE is good. When spontaneous–spontaneous beat noise is comparable with
signal–spontaneous beat noise, Eq. (7.136) needs to be modified [7–9]. Note that the Gaussian distribu-
tion is an approximation and the amplifier noise after the photodetector is actually chi-square distributed [7]
(see Chapter 8).
Example 7.4
In a 1.55-μm long-haul fiber-optic system based on NRZ-OOK as shown in Fig. 7.13, 80 identical amplifiers
are placed periodically with a spacing of 80 km. The mean fiber launch power = −3 dBm, fiber loss coeffi-
cient 𝛼= 0.0461 km−1, amplifier loss is fully compensated by the amplifiers, and nsp = 1.5. Electrical filter
bandwidth, fe = 7 GHz and fe < f0. Calculate (a) OSNR in a reference bandwidth of 0.1 nm, (b) Q-factor.
Ignore shot noise, thermal noise, and spontaneous–spontaneous beat noise.
Solution:
(a) Since
f = c
𝜆,
df = −c
𝜆2 d𝜆.
With d𝜆= 0.1 nm,
df = Bopt = −3 × 108 × (0.1 × 10−9)
(1.55 × 10−6)2
Hz
= 12.48 GHz,
G = exp(𝛼La)
= exp(0.0461 × 80)
= 39.96,
G(dB) = 10 log10G
= 16.01 dB,
N(dB) = 10 log1080
= 19.03 dB,
Fn ≅2nsp,
Fn(dB) = 4.77 dB,
Pin(dBm) = −3 dBm.
Using Eq. (7.111), we find
OSNR(dB) = Pin(dBm) −N(dB) −G(dB) −Fn(dB) + 58
= −3 −19.03 −16.01 −4.77 + 58
= 15.19 dB.

322
Fiber Optic Communications
The mean launch power
Pin = −3 dBm.
So the peak power is (assuming NRZ rectangular pulses)
Pin = 2Pin
= 2 × 10−(3∕10) mW
= 1 mW.
Using Eq. (7.135), we find
Q =
√
Pin
4Nnsphf(G −1)fe
=
√
1 × 10−3
4 × 80 × 1.5 × 6.626 × 10−34 × 193.5 × 1012 × (39.96 −1) × 7 × 109
= 7.71.
7.4.4
Coherent Receiver
Consider the fiber-optic system shown in Fig. 7.13 with balanced coherent detection. Let the received field
envelope be
q(t) = Ars(t) + nASE(t),
(7.137)
where Ars(t) and nASE(t) are the signal and ASE noise field envelopes, respectively. In this case, Eq. (7.32) is
modified as
I = 2RALORe{Ars(t) + nASE(t)} + nshot+ −nshot−.
(7.138)
Consider a bit ‘1’ of the OOK system. Let us first ignore the shot noise and write Eq. (7.138) as
I = I + 𝛿I,
(7.139)
I = 2R
√
PLOP1r,
(7.140)
𝛿I = 2R
√
PLORe {nASE
} .
(7.141)
Let
nASE = |nASE| exp(i𝜃),
(7.142)
Re {nASE
} = |nASE| cos(𝜃).
(7.143)
Since 𝜃is a random variable with uniform distribution, it follows that
< 𝛿I >= 0,
(7.144)
< 𝛿I2 >= 4R2PLO < |nASE|2cos2𝜃> .
(7.145)

Transmission System Design
323
Proceeding as in Section 6.5.1, Eq. (7.145) is simplified as
< 𝛿I2 >= 2R2PLOPASE,
(7.146)
where PASE is the mean noise power within the receiver bandwidth. The variance given by Eq. (7.146)
represents the signal–spontaneous beat noise due to the interaction of the LO signal and ASE. Note that
spontaneous–spontaneous beat noise is absent when the balanced coherent receiver is used. We assume that
PLO ≫P1r. So the variances of ‘1’ due to ASE, shot noise, and thermal noise are
𝜎2
1,ASE = 2R2PLOPASE,
(7.147)
𝜎2
1,shot = 2qBeRPLO,
(7.148)
𝜎2
1,thermal = 4kBTBe∕RL,
(7.149)
𝜎2
1 = 𝜎2
1,ASE + 𝜎2
1,shot + 𝜎2
1,thermal.
(7.150)
Similarly, for bit ‘0’, we have
𝜎2
0,ASE = 𝜎2
1,ASE,
(7.151)
𝜎2
0,shot = 𝜎2
1,shot,
(7.152)
𝜎2
0,thermal = 𝜎2
1,thermal,
(7.153)
𝜎2
0 = 𝜎2
1.
(7.154)
The mean currents of bit ‘1’ and ‘0’ are
I1 = 2R
√
PLOP1r,
(7.155)
I0 = 0.
(7.156)
The Q-factor is
QOOK = I1
2𝜎1
(7.157)
=
R
√
PLOP1r
√
2R2PLOPASE + 2qBeRPLO + 4kBTBe∕RL
.
(7.158)
For a long-haul fiber-optic system, the ASE noise due to amplifier chains is dominant. Hence, the shot noise
and thermal noise can be ignored in Eq. (7.157) to obtain
QOOK =
√
P1r
2PASE
.
(7.159)
For a fiber-optic system with the loss fully compensated by amplifier gain, we have
P1r = Pin = 2Pin.
(7.160)
We assume that the electrical filter bandwidth Be is smaller than the optical filter bandwidth, so that (see
Eq. (6.52))
PASE = 2𝜌eq
ASEBe.
(7.161)

324
Fiber Optic Communications
Eq. (7.159) becomes
QOOK =
√
√
√
√
Pin
2𝜌eq
ASEBe
.
(7.162)
Note that the Q-factor is independent of the responsivity R and LO power PLO when the shot noise and thermal
noise are ignored. For PSK, I0 = −I1 and Eq. (7.159) is modified as
QPSK =
√
√
√
√
Pin
𝜌eq
ASEBe
.
(7.163)
Fig. 7.17 shows the BER as a function of the number of amplifiers. Solid lines show the exact Q-factors
obtained by including shot noise and thermal noise and the × marks show the approximate Q-factors obtained
using Eqs. (7.159) and (7.163). As can be seen, PSK outperforms OOK. For a fixed BER, the transmis-
sion reach can be doubled by using PSK compared with OOK. Eq. (7.163) can be cast into another form
by setting
Ns = PinTb
hf
,
(7.164)
Nn = PASETb
hf
.
(7.165)
Here, Ns and Nn denote the mean number of signal photons and noise photons, respectively. Using Eqs. (7.164)
and (7.165) in Eq. (7.163) and with Be = 1∕(2Tb), we find
Q2
PSK = 2Ns
Nn
.
(7.166)
60
80
100
120
140
160
180
10–5
10–10
10–15
10–20
100
No. of amplifiers
BER
OOK
PSK
Figure 7.17
BER as a function of the number of amplifiers for a coherent fiber-optic system. Parameters: nsp = 2, 𝛼
= 0.2 dB/km, amp. spacing = 80 km, gain G = 16 dB, RL = 1000 Ω, T = 200 K, R = 1 A/W, Pin = −6 dBm, and PLO =
10 mW.

Transmission System Design
325
To have Q = 6, the signal photon-to-noise photon ratio Ns∕Nn should be 18. When Nn is very small, the
amplifier noise variance becomes comparable with the shot noise and Eq. (7.166) becomes less accurate.
When the shot noise is included, Eq. (7.166) is modified as (see Example 7.8)
Q2
PSK =
2Ns
Nn + 1∕2.
(7.167)
Example 7.5
In a 1.55-μm coherent long-haul fiber-optic system based on PSK as shown in Fig. 7.13, fiber loss =
0.2 dB/km, amplifier spacing La = 100 km. Fiber loss is fully compensated by the amplifier placed periodi-
cally along the transmission line. The mean fiber launch power = −2 dBm, nsp = 1.4, and Be = 5 GHz. Find
the transmission distance at which the BER becomes equal to 10−9. Ignore shot noise, thermal noise, and
spontaneous–spontaneous beat noise.
Solution:
loss(dB) = 0.2 × 100 = 20 dB.
When the loss is fully compensated by the gain, we have
G(dB) = loss(dB)
= 20 dB,
G = 1020∕10 = 100.
The ASE power spectral density
𝜌eq
ASE = Nnsphf(G −1)
= N × 1.4 × 6.626 × 10−34 × 193.54 × 1012 × (100 −1)
= N × 1.77 × 10−17 W/Hz.
From Eq. (7.163), we have
QPSK =
√
√
√
√
Pin
𝜌eq
ASEBe
=
√
√
√
√
Pin
Nnsphf(G −1)Be
,
Pin = 10−2∕10 mW = 6.309 × 10−4 mW.
To have a BER of 10−9, Q should be 6,
6 =
√
6.309 × 10−4
N × 1.77 × 10−17 × 5 × 109 ,
or
N = floor(197.24) = 197.
Total transmission distance = 197 × 100 km
= 19, 700 km.

326
Fiber Optic Communications
7.4.5
Numerical Experiments
Consider a 10-Gb/s fiber-optic direct detection system based on OOK. The schematic of the system is shown
in Fig. 7.13. We assume that the gains of the amplifiers are identical and fiber lengths are the same. Let
us first consider the impact of ASE only by ignoring the fiber dispersion. Fig. 7.18(a) shows the eye dia-
gram at the receiver for system #1 when the amplifier spacing = 100 km and number of amplifiers = 30,
so that the total transmission distance = 3000 km. Fig. 7.18(b) shows the eye diagram for system #2 when
the amplifier spacing = 25 km and number of amplifiers = 120, i.e., we reduce the amplifier spacing by a
factor of 4 and increase the number of amplifiers by the same factor. Comparing Fig. 7.18(a) and 7.18(b),
we find that the impact of ASE is much less in system #2 than in system #1. This is because the variance of
signal–ASE beating, 𝜎2
s−sp, increases, linearly with the number of amplifiers (Eq. (7.133)). But, as the number
of amplifiers is increased, the amplifier spacing is reduced, which reduces the fiber loss and also the gain G.
The gain G is
G = exp(𝛼La),
(7.168)
where 𝛼is the fiber loss coefficient and La is the amplifier spacing. When La is reduced by a factor of 4, but
the total transmission distance is fixed, G reduces exponentially whereas the number of amplifiers increases
linearly. Since the exponential decrease dominates the linear increase, the net effect is to lower 𝜎2
s−sp and the
performance increases if we choose a smaller amplifier spacing.
Next, we consider the impact of fiber dispersion and ignore ASE. Fig. 7.19(a) and (b) shows the eye dia-
grams when 𝛽2 = −1 ps2/km and 𝛽2 = −5 ps2/km, respectively. As can be seen, as the dispersion coefficient
increases the pulses broaden, leading to performance degradation. Fig. 7.20(a) and (b) shows the eye diagrams
when ASE is turned on and 𝛽2 = −1 ps2/km and 𝛽2 = −5 ps2/km, respectively.
–0.5
0
0.5
1
x 10–10
0
1
0.2
0.4
0.6
0.8
1.2
1.4
Time (s)
(a)
(b)
–0.5
0
0.5
1
x 10–10
Time (s)
Current, I
0
1
0.2
0.4
0.6
0.8
1.2
1.4
Current, I
Figure 7.18
Eye diagrams for a direct detection system based on OOK. Total transmission distance = 3000 km, bit rate
= 10 Gb/s, and nsp = 1.5. (a) System #1. Amplifier spacing = 100 km, number of amplifiers = 30 and (b) System #2.
Amplifier spacing = 25 km, number of amplifiers = 120.

Transmission System Design
327
0
0.2
0.4
0.6
0.8
1
1.2
1.4
0
0.5
1
1.5
2
2.5
Current, I
Current, I
–0.5
0
0.5
1
x 10–10
Time (s)
(a)
(b)
–0.5
0
0.5
1
x 10–10
Time (s)
Figure 7.19
Eye diagrams for a direct detection system. Amplifier spacing = 100 km, number of amplifiers = 10. ASE
is turned off. (a) 𝛽2 = −1 ps2/km and (b) 𝛽2 = −5 ps2/km.
0
0.2
0.4
0.6
0.8
1
1.2
1.4
0
0.5
1
1.5
2
2.5
Current, I
Current, I
–0.5
0
0.5
1
x 10–10
Time (s)
(a)
(b)
–0.5
0
0.5
1
x 10–10
Time (s)
Figure 7.20
Eye diagrams for a direct detection system. The parameters are the same as those of Fig. 7.19, except that
ASE is turned on. nsp = 1.5, number of amplifiers = 10. (a) 𝛽2 = −1 ps2/km and (b) 𝛽2 = −5 ps2/km.
7.5
Additional Examples
Example 7.6
In the fiber-optic system of Fig. 7.5, 𝛼= 0.18 dB/km and fiber length L = 190 km, T = 298 K, Pin = 1 dBm,
R = 1.1 A/W, RL = 200 Ω, fe = 7.5 GHz, and fo = 20 GHz. The noise figure and gain of the preamplifier are

328
Fiber Optic Communications
4.5 dB and 20 dB, respectively. Find the Q-factor at the receiver, assuming that the operating wavelength is
1.55 μm.
Solution:
The optical power at the receiver after the preamplifier is
Pout(dBm) = Pin(dBm) −loss(dB) + gain of the preamplifier(dB),
loss(dB) = 0.18 × 190 dB
= 34.2 dB.
Gain of the preamplifier(dB) = G(dB) = 20 dB,
Pout(dBm) = 1 −34.2 + 20 dBm
= −13.2 dBm.
Pout = 10−13.2∕10 mW = 4.78 × 10−2 mW,
𝜌ASE = hf(G −1)nsp,
f = c
𝜆=
3 × 108
1.55 × 10−6 = 193.54 THz.
From Eq. (6.105), we have
Fn ≅2nsp,
Fn(dB) = 4.5 dB,
Fn = 104.5∕10 = 2.818,
nsp = 1.409,
G = 10G(dB)∕10 = 100,
𝜌ASE = 6.626 × 10−34 × 193.54 × 1012 × (100 −1) × 1.409
= 1.78 × 10−17 W/Hz,
I1 = RPout + 2𝜌ASE fo
= 1.1 × 4.7 × 10−5 + 2 × 1.78 × 10−17 × 20 × 109 A
= 5.32 × 10−2 mA,
I0 = 2R𝜌ASE fo
= 2 × 1.1 × 1.78 × 10−17 × 20 × 109 A
= 7.83 × 10−4 mA,

Transmission System Design
329
𝜎2
1 = 2qI1fe + 4kBTfe
RL
+ 2R2𝜌ASE[2Pout fe + 𝜌ASE(2fo −fe)fe]
= 2 × 1.602 × 10−19 × 5.32 × 10−5 × 7.5 × 109 + 4 × 1.38 × 10−23 × 298 × 7.5 × 109
200
+ 2 × 1.12 × 1.78 × 10−17 × [2 × 4.78 × 10−5 × 7.5 × 109
+ 1.78 × 10−17 × (2 × 20 × 109 −7.5 × 109) × 7.5 × 109]
= 3.18 × 10−11 A2,
𝜎2
0 = 2qI0fe + 4kBTfe
RL
+ 2R2𝜌2
ASEB(2fo −fe)fe
= 2 × 1.602 × 10−19 × 7.83 × 10−7 × 7.5 × 109 + 4 × 1.38 × 10−23 × 298 × 7.5 × 109
200
+ 2 × 1.12 × (1.78 × 10−17)2 × (2 × 20 × 109 −7.5 × 109) × 7.5 × 109
= 8.05 × 10−13 A2,
Q = I1 −I0
𝜎1 + 𝜎0
=
5.32 × 10−5 −7.83 × 10−7
√
3.18 × 10−11 +
√
8.05 × 10−13
= 8.031.
Example 7.7
A two-stage amplifier with a DCF between the stages needs to be designed. The insertion loss of the DCF
is 7 dB. There are two amplifiers Amp1 and Amp2 with gains G1 = 8 dB and G2 = 16 dB, respectively. The
noise figures of the amplifiers are Fn,1 = 7 dB and Fn,2 = 5.5 dB. Find the optimum amplifier configuration.
Solution:
Since Amp2 has the lower noise figure, let us first choose Amp2 as the first amplifier. From Eq. (7.122) with
the indices reversed, we have
Fn,eq = Fn,2 +
Fn,1
G2H ,
Fn,1 = 10Fn,1(dB)∕10 = 5.01,
Fn,2 = 10Fn,2(dB)∕10 = 3.54,
G2 = 10G2(dB)∕10 = 39.81,
H = 10H(dB)∕10 = 5.01,

330
Fiber Optic Communications
Fn,eq = 3.54 +
5.01
39.81 × 5.01 = 3.56,
Fn,eq(dB) = 5.52 dB.
Thus, the Fn of the equivalent amplifier is roughly the same as that of Amp2. The net gain is
Geq = G2HG1,
Geq(dB) = G2(dB) + H(dB) + G1(dB)
= 16 −7 + 8 dB
= 17 dB.
If we choose Amp1 as the first amplifier, from Eq. (7.122) we find
Fn,eq = Fn,1 +
Fn,2
G1H
= 5.01 +
3.54
6.309 × 5.52
= 5.11,
Fn,eq(dB) = 7.08 dB.
In this case, the equivalent noise figure is roughly the same as that of Amp1. Therefore, the optimum config-
uration is the one in which the first amplifier is Amp2.
Example 7.8
In the presence of ASE noise and shot noise, show that the Q-factor of a fiber-optic system based on PSK
with balanced detection is given by
Q2 =
2Ns
Nn + 1∕2,
(7.169)
where Ns and Nn are the mean number of signal photons and noise photons, respectively. Assume 𝜂= 1.
Solution:
For PSK, I1 = −I0. Ignoring the thermal noise, Eq. (7.158) is modified as
QPSK =
2R
√
PLOP1r
√
2R2PLOPASE + 2qBeRPLO
.
(7.170)
Since R = 𝜂q∕hf and 𝜂= 1, Eq. (7.170) becomes
QPSK =
√
2P1r
PASE + hfBe
.
(7.171)

Transmission System Design
331
Using a Nyquist filter,
Be =
1
2Tb
.
(7.172)
Eq. (7.171) becomes
QPSK =
√
2P1rTb
PASETb + hf∕2
.
(7.173)
Using Eqs. (7.164) and (7.165), Eq. (7.173) becomes
Q2
PSK =
2Ns
Nn + 1∕2.
(7.174)
Example 7.9
A 1.55-μm long-haul fiber-optic system based on OOK that uses a direct detection receiver is shown in
Fig. 7.21. The output of the TF passes through a two-stage amplifier with gain G1 = 16 dB and G2 deter-
mined by the condition that the output power of Amp2 is the same as that at the transmitter output. The noise
figures of Amp1 and Amp2 are 5.5 dB and 7.5 dB, respectively. The loss and dispersion coefficients of the TF
are 0.18 dB/km and −21 ps2/km, respectively, and the corresponding coefficients of the DCF are 0.5 dB/km
and 145 ps2/km, respectively. Other parameters: mean transmitter output power = −2 dBm, length of the TF
= 100 km, number of spans = 70, fe = 7 GHz. Calculate (a) the length of the DCF so that the DCF compen-
sates for 90% of the accumulated dispersion of the TF, (b) the gain G2, and (c) the Q-factor. Ignore the shot
noise, thermal noise, and spontaneous–spontaneous beat noise.
Figure 7.21
A long-haul fiber-optic system based on OOK.
Solution:
(a) Total accumulated dispersion of the single-span TF:
sTF = 𝛽2,TFLTF
= −21 × 10−27 × 100 × 103 s2
= −2.1 × 10−21 s2.
Accumulated dispersion of the DCF:
sDCF = −0.9sTF = 1.89 × 10−21 s2,

332
Fiber Optic Communications
LDCF = sDCF
𝛽2,DCF
= 1.89 × 10−21
145 × 10−27 = 13.03 km.
(b) Since the amplifiers compensate for the loss due to TF and DCF exactly, we have
G1(dB) + G2(dB) = HTF(dB) + HDCF(dB),
HTF(dB) = 0.18 × 100 = 18 dB,
HDCF(dB) = 0.5 × 13.03 = 6.517 dB,
G1(dB) = 16,
G2(dB) = 18 + 6.517 −16 = 8.517 dB.
(c) A two-stage amplifier with a DCF in between can be replaced by an equivalent amplifier with gain
Geq(dB) = G1(dB) + G2(dB) −HDCF(dB) = 18 dB,
Geq = 1018∕10 = 63.09,
Fn,eq = Fn,1 +
Fn,2
G1HDCF
−1
G1
,
Fn,1(dB) = 5.5 dB,
Fn,1 = 105.5∕10 = 3.548,
Fn,2(dB) = 7.5 dB,
Fn,2 = 107.5∕10 = 5.62,
HDCF = 10−HDCF(dB)∕10 = 0.223,
G1 = 1016∕10 = 39.81,
Fn,eq = 3.548 +
5.62
39.81 × 0.223 −
1
39.81 = 4.156.
Since we have 70 identical spans, the PSD of the ASE at the receiver is
𝜌ASE,eq = 70 × hf(GeqFn,eq −1)∕2
= 70 × 6.626 × 10−34 × 193.54 × 1012 × (63.09 × 4.156 −1)∕2 W/Hz
= 1.17 × 10−15 W/Hz.
For OOK, the peak power is twice the average power:
Pin = 2 × 10Pin(dBm)∕10 mW
= 1.2 × 10−3 W.

Transmission System Design
333
Using Eq. (7.135), we find
Q =
√
Pin
4𝜌ASE,eqfe
=
√
1.26 × 10−3
4 × 1.17 × 10−15 × 7 × 109
= 6.2
Exercises
7.1
In a fiber-optic system based on OOK as shown in Fig. 7.1, fiber loss = 0.21 dB/km, length
L = 120 km, peak power at the transmitter = 2 dBm, T = 23∘C, RL = 100 Ω, Be = 7 GHz, and
R = 1.1 A/W. Find (a) the peak power at the receiver, (b) the Q-factor, and (c) the BER.
(Ans: (a) −23.3 dBm, (b) 4.89, (c) 4.84 × 10−7.)
7.2
In a 1.55-μm fiber-optic system based on OOK as shown in Fig. 7.5, the peak transmitter power Pin =
2 dBm, fiber loss coefficient 𝛼= 0.2 dB/km, T = 290 K, RL = 1000 Ω, R = 1 A/W, Bo = 20 GHz, Be =
7.5 GHz, gain and nsp of the preamplifier are 25 dB and 1.5, respectively. Find the maximum achievable
transmission distance to have a BER of 10−9.
(Ans: 190.5 km.)
7.3
In a 1.55-μm coherent fiber-optic system based on PSK, as shown in Fig. 7.7, find the lower limit on
the LO power such that the shot noise dominates the thermal noise and the difference between the
Q-factor given by Eq. (7.62) and the exact Q-factor is ≤2.5%. The mean received power = −45 dBm,
T = 293 K, 𝜂= 0.8, RL = 200 Ω, and Be = 7 GHz.
(Ans: 5 mW.)
7.4
The received signal of an unrepeatered coherent fiber-optic system passes through a preamplifier of
gain G and spontaneous noise factor nsp, as shown in Fig. 7.22. Develop a mathematical expression
for the Q-factor including the LO–spontaneous beat noise and shot noise.
Figure 7.22
A balanced coherent receiver with a preamplifier.
7.5
Find the maximum transmission distance of a metro network operating at 10 Gb/s in which the fiber
dispersion is not compensated in the optical or electrical domain if the transmission fiber dispersion
𝛽2 is (a) 5 ps2/km, (b) −21 ps2/km. Use the criteria given by Eq. (7.101).
(Ans: (a) 125 km, (b) 29.76 km.)

334
Fiber Optic Communications
7.6
For a long-haul fiber-optic system consisting of 10 identical amplifiers with gain G = 30 dB and noise
figure Fn = 4.5 dB, it is desirable to have a OSNR of 15 dB (in 0.1 nm bandwidth) at the receiver. Find
the transmitter power launched to the fiber.
(Ans: −1.5 dBm.)
7.7
A 20,000-km transmission system at 10 Gb/s based on OOK with direct detection needs to be designed.
The required Q-factor at the receiver should be ≥5. Fiber loss = 0.18 dB/km and the loss is exactly
compensated by periodically placed amplifiers. Write a program to find the maximum amplifier spacing
allowed. Assume Be = 7.5 GHz, R = 1 A/W. Ignore shot noise and thermal noise.
7.8
Explain how a larger amplifier spacing deteriorates the system performance in a long-haul fiber-optic
system.
7.9
For a cascaded chain of k amplifiers, show that
Fn,eq = Fn,1 +
Fn,2 −1
G1
+
Fn,3 −1
G1G2
+ · · · +
Fn,k −1
G1G2· · ·Gk−1
,
(7.175)
where Fn,j and Gj are the noise figure and gain of the jth amplifier, respectively.
7.10
Write a program to calculate the OSNR and BER of a long-haul fiber-optic system with
direct/coherent detection. Include shot noise, thermal noise, signal–spontaneous beat noise and
spontaneous–spontaneous beat noise (if applicable). Compare the BERs obtained using the
exact Q-factor and approximate Q-factor obtained by ignoring shot noise, thermal noise, and
spontaneous–spontaneous beat noise.
Further Reading
G. Keiser, Optical Fiber Communications, 4th edn. McGraw-Hill, New York, 2011.
G.P. Agrawal, Fiber-optic Communication Systems. John Wiley & Sons, Hoboken, NJ 2010.
K.P. Ho, Phase Modulated Optical Communication Systems. Springer-Verlag, Berlin, 2005.
J. M. Senior, Optical Fiber Communications, 2nd edn. Prentice-Hall, London, 1992.
S. Betti, G. DeMarchis, and E. Iannone, Coherent Optical Communication Systems. John Wiley & Sons, New York, 1995.
T. Okoshi and K. Kikuchi, Coherent Optical Fiber Communications. Kluwer Academic, Dordrecht, 1998.
References
[1] K.P. Ho, Phase Modulated Optical Communication Systems. Springer-Verlag, Berlin, 2005.
[2] S. Betti, G. De Marchis, and E. Iannone, Coherent Optical Communication Systems. John Wiley, Hoboken, NJ, 1995.
[3] K. Kikuchi and S. Tsukamoto, J. Lightwave Technol., vol. 26, p. 1817, 2008.
[4] G.P. Agrawal, Fiber-optic Communication Systems. John Wiley & Sons, Hoboken, NJ, 2010.
[5] C.R. Giles and E. Desurvire, J. Lightwave Technol., vol. 9, p. 147, 1991.
[6] Y. Yamamoto and T. Mukai, Opt. Quant. Electron., vol. 21, p. S1, 1989.
[7] P.A. Humblet and M. Azizoglu, J. Lightwave Technol., vol. 9, p. 1576, 1991.
[8] D. Marcuse, J. Lightwave Technol., vol. 8, p. 1816, 1990.
[9] D. Marcuse, J. Lightwave Technol., vol. 9, p. 505, 1991.

8
Performance Analysis
8.1
Introduction
In Chapter 4, various types of digital modulation schemes such as PSK, OOK, and FSK were introduced and
in Chapter 5, different receiver architectures such as direct detection, homodyne, and heterodyne detections
were discussed. In this chapter, the performances of these modulation schemes with the different receiver
architectures are investigated. Firstly, the concept of a matched filter is introduced in Section 8.2. In practice,
optical matched filters are rarely used in optical communication systems due to the difficulties involved in
fabricating such a matched filter. Nevertheless, the performance is optimum when the matched filters are
used, and the expressions for the error probability developed in this Chapter using the matched filters provide
a lower bound on the achievable BER.
8.2
Optimum Binary Receiver for Coherent Systems
In this section, we consider the generalized model for the optimum binary receivers (See Fig. 8.1) and later, we
apply this model to various detection schemes. Let x1(t) and x2(t) be the real optical signals used to transmit
bits ‘1’ and ‘0’, respectively:
x(t) =
{
x1(t)
when the message = ‘1’
x0(t)
when the message = ‘0’.
(8.1)
Here, xj(t), j = 0, 1 are arbitrary pulses of duration ≤Tb, where Tb is the bit interval. We assume that the
channel can be modeled as an additive white Gaussian noise (AWGN) channel, which means that the power
spectral density of the noise is constant and the probability distribution of the noise process is Gaussian. The
output of the channel may be written as
y(t) = x(t) + n(t),
(8.2)
where n(t) is the noise added by the channel and
𝜌n = N0∕2
(8.3)
is the power spectral density of n(t). Let the Fourier transform of xj(t) be
̃xj(𝜔) = [xj(t)], j = 0, 1.
(8.4)
The channel output is passed through a filter. The purpose of this filter is to alter the ratio of the signal power
and noise power so that the best performance can be attained. The filter multiplies the signal spectrum by
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

336
Fiber Optic Communications
Threshold
device
 
t = Tb
r(Tb)
AWGN
channel
Tx
x(t)
n(t)
x(t) + n(t)
r(t) = u(t) + nF(t)
H(ω)
Decison
+
+
∑
Figure 8.1
A generalized model for the optimum binary receivers.
H(𝜔) and, therefore, after passing through the filter, the signal component is
u(t) =
{
u1(t)
when bit ‘1’ is transmitted
u0(t)
when bit ‘0’ is transmitted
(8.5)
with
uj(t) = 1
2𝜋∫
∞
−∞
̃xj(𝜔)H(𝜔) exp (−i𝜔t) d𝜔,
j = 0, 1.
(8.6)
After passing through the filter, the noise variance is given by
𝜎2 = 1
2𝜋∫
∞
−∞
N0
2 |H(𝜔)|2 d𝜔.
(8.7)
The received signal r(t) can be written as the superposition of the signal and noise at the filter output. The
decision is based on samples of r(t):
r(t) = u(t) + nF(t),
(8.8)
where nF(t) is the noise at the filter output. To determine if the message is bit ‘0’ or bit ‘1’, the received signal
r(t) is sampled at intervals of Tb. Since the noise sample nF(Tb) is a Gaussian random variable with zero mean
and variance 𝜎2, the received signal sample r(Tb) is a Gaussian random variable with mean u(Tb) and variance
𝜎2. Its pdf is given by
p(r) =
1
√
2𝜋𝜎
exp
{
−
[r −u(Tb)]2
2𝜎2
}
.
(8.9)
Let rT be the threshold. If r(Tb) > rT, the threshold device decides that the bit ‘1’ is transmitted. Otherwise,
the bit ‘0’ is transmitted. When a bit ‘1’ is transmitted, u(Tb) = u1(Tb). In this case, the conditional pdf is
p(r|‘1’ sent) ≡p1(r) =
1
√
2𝜋𝜎
exp
{
−
[r −u1(Tb)]2
2𝜎2
}
.
(8.10)
Fig. 8.2 shows the conditional pdf p1(r). The area of the shaded region in Fig. 8.2 is the chance that the
received signal r(Tb) < rT when bit ‘1’ is transmitted. A bit error is made if the decision device chooses a bit
‘0’ when a bit ‘1’ is transmitted. This happens if r(Tb) < rT. Therefore, the probability of mistaking a bit ‘1’
as a bit ‘0’ is the area under the curve p1(r) from −∞to rT and is given by
P(0|1) =
1
√
2𝜋𝜎∫
rT
−∞
exp
{
−
[r −u1(Tb)]2
2𝜎2
}
dr.
(8.11)

Performance Analysis
337
r
p
p0(r)
p1(r)
P(1∣0)
P(0∣1)
u0(Tb)
u1(Tb)
rT
Figure 8.2
Conditional pdfs. P(0|1) is the chance of mistaking bit ‘1’ as bit ‘0’. P(1|0) is the chance of mistaking bit
‘0’ as bit ‘1’.
Similarly, when a bit ‘1’ is sent, the conditional pdf is
p(r|‘0’ sent) ≡p0(r) =
1
√
2𝜋𝜎
exp
{
−
[r −u0(Tb)]2
2𝜎2
}
.
(8.12)
The probability of mistaking a bit ‘0’ as a bit ‘1’ is the area under the curve p0(r) from rT to ∞(shown as
slanted lines in Fig. 8.2):
P(1|0) =
1
√
2𝜋𝜎∫
∞
rT
exp
{
−
[r −u0(Tb)]2
2𝜎2
}
dr.
(8.13)
The total BER is given by
Pb = P(0|1)P(1) + P(1|0)P(0),
(8.14)
where P(j) is the probability of sending bit ‘j’, j = 0, 1. Assuming that the bits ‘1’ and ‘0’ are equally probable,
we obtain
Pb = 1
2[P(0|1) + P(1|0)].
(8.15)
Substituting Eqs. (8.13) and (8.11) in Eq. (8.15), we find
Pb = 1
2
[
∫
rT
−∞
p1(r)dr + ∫
∞
rT
p0(r)dr
]
(8.16)
=
1
2
√
2𝜋𝜎
{
∫
rT
−∞
exp
{
−
[r −u1(Tb)]2
2𝜎2
}
dr + ∫
∞
rT
exp
{
−
[r −u0(Tb)]2
2𝜎2
}
dr.
(8.17)

338
Fiber Optic Communications
To find the minimum BER, the threshold rT and the filter transfer function H(𝜔) should be optimized. Let us
first consider the optimization of threshold rT. Pb is minimum or maximum when
𝜕Pb
𝜕rT
= 0.
(8.18)
Differentiating Eq. (8.16) with respect to rT and setting it to zero, we find
p1(rT) = p0(rT),
(8.19)
exp
{
−
[rT −u1(Tb)]2
2𝜎2
}
= exp
{
−
[rT −u0(Tb)]2
2𝜎2
}
.
(8.20)
Thus, the optimum threshold rT corresponds to the inter section of curves p0(r) and p1(r) in Fig. 8.2. From
Eq. (8.20), we see that
rT −u1(Tb) = ±[rT −u0(Tb)].
(8.21)
Taking the negative sign in Eq. (8.21), we find
rT = [u0(Tb) + u1(Tb)]∕2.
(8.22)
If we choose the positive sign, it would lead to u0(Tb) = u1(Tb), which is not true in our case. The optimum
threshold condition given by Eq. (8.19) is valid for arbitrary pdfs, while that given by Eq. (8.22) holds true
for Gaussian distributions. From Eq. (8.22), we see that the optimum threshold rT is at the middle of u0(Tb)
and u1(Tb). Since the conditional pdfs p1(r) and p0(r) are symmetrically located with respect to the optimum
threshold rT (Fig. 8.2), P(0|1) and P(1|0) should be equal. Therefore, Eq. (8.17) can be rewritten as
Pb =
1
√
2𝜋𝜎∫
∞
rT
exp
{
−
[r −u0(Tb)]2
2𝜎2
}
dr.
(8.23)
Let
z = r −u0(Tb)
√
2𝜎
,
(8.24)
Pb =
1
√
𝜋∫
∞
[rT−u0(Tb)]∕
√
2𝜎
exp (−z2) dz
= 1
2erfc
(
rT −u0(Tb)
√
2𝜎
)
,
(8.25)
where erfc(⋅) is the complementary error function defined as
erfc(z) =
2
√
𝜋∫
∞
z
exp (−y2) dy.
(8.26)
Using Eq. (8.22), Eq. (8.25) becomes
Pb = 1
2erfc
(√
𝑣
8
)
,
(8.27)

Performance Analysis
339
where
𝑣= [u1(Tb) −u0(Tb)]2
𝜎2
(8.28)
=
[∫∞
−∞
[̃x1(𝜔) −̃x0(𝜔)] H(𝜔) exp (−i𝜔Tb) d𝜔]2
𝜋N0 ∫∞
−∞|H(𝜔)|2 d𝜔
.
(8.29)
From Fig. 8.3, we see that as 𝑣increases, Pb decreases and therefore, to minimize Pb, 𝑣should be maximized.
𝑣can be maximized by the proper choice of filter transfer function H(𝜔). If the filter is too wide (Fig. 8.4(a)),
the variance of noise given by Eq. (8.7) increases since the variance is proportional to the area under the
0
5
10
15
20
25
30
10*3
10*2
10*1
100
v
Pb
Figure 8.3
Dependence of the BER on 𝑣.
∣ℱ[r(t)]∣2
∣H(ω)∣2
(a)
Frequency, ω
0
(b)
Frequency, ω
0
Figure 8.4
Received signal spectrum and the receiver filter transfer function: (a) wide-bandwidth filter;
(b) narrow-bandwidth filter.

340
Fiber Optic Communications
curve |H(𝜔)|2 and, therefore, 𝑣decreases. If the filter is too narrow (Fig. 8.4(b)), a significant fraction of the
signal component is truncated by the filter and, therefore, the numerator of Eq. (8.29) becomes too small. The
optimum filter transfer function can be obtained by setting the variation of 𝑣with respect to H(𝜔) and H∗(𝜔)
to zero:
𝛿𝑣
𝛿H = 0
and
𝛿𝑣
𝛿H∗= 0.
(8.30)
To find the variations given by Eq. (8.30), let us replace the integrals of Eq. (8.29) by summations:
𝑣=
lim
Δ𝜔n→0
[∑
n
[̃x1(𝜔n) −̃x0(𝜔n)] H(𝜔n) exp (−i𝜔nTb)Δ𝜔n
]2
𝜋N0
∑
n
|H(𝜔n)|2Δ𝜔n
.
(8.31)
𝑣can be optimized by setting its partial derivatives with respect to H(𝜔n) and H∗(𝜔n) to zero. Note that
H(𝜔n) and H∗(𝜔n) are independent variables. Alternatively, Re[H(𝜔n)] and Im[H(𝜔n)] can also be chosen as
independent variables:
𝜕𝑣
𝜕H(𝜔n) = 2
√
N[̃x1(𝜔n) −̃x0(𝜔n)] exp (−i𝜔nTb)
D
−𝜋N0H∗(𝜔n) N
D2 = 0,
(8.32)
where N and D denote the numerator and denominator of Eq. (8.29), respectively. Simplifying Eq. (8.32), we
obtain
H(𝜔n) = k[̃x∗
1(𝜔n) −̃x∗
0(𝜔n)] exp (i𝜔nTb),
H(𝜔) = k[̃x∗
1(𝜔) −̃x∗
0(𝜔)] exp (i𝜔Tb),
(8.33)
where
k =
(
2D
√
N
)
1
𝜋N0
(8.34)
is an arbitrary constant, which we set to unity from now on. The same result can be obtained by setting the
variation of 𝑣with respect to H∗(𝜔) to zero. The filter with the transfer function given by Eq. (8.33) is called
a matched filter. Using Eq. (8.33) in Eq. (8.29), we obtain
𝑣max =
1
𝜋N0 ∫
∞
−∞
|̃x1(𝜔) −̃x0(𝜔)|2 d𝜔
= 2
N0 ∫
Tb
0
[x1(t) −x0(t)]2 dt,
(8.35)
where we have made use of Parseval’s relations. Let
Ejk = ∫
Tb
0
xj(t)xk(t) dt,
j = 1, 0,
(8.36)
Ejj ≡Ej.
(8.37)
Using Eqs. (8.36) and (8.37) in Eqs. (8.35) and (8.27), we obtain
𝑣max = 2
N0
[E1 + E0 −2E10],
(8.38)
Pb, min = 1
2erfc
(√𝑣max
8
)
.
(8.39)

Performance Analysis
341
Threshold
device
t = Tb
r(Tb)
r(t)
If r(Tb) > rT
select x1(t) 
If r`(Tb) < rT
select x0(t) 
x1(Tb * t)
x0(Tb * t)
y(t)
h(t)
+
*
∑
Figure 8.5
The matched filter as a parallel combination of two filters.
The transfer function of the matched filter may be rewritten as
H(𝜔) = ̃x∗
1(𝜔) exp (i𝜔Tb) −̃x∗
0(𝜔) exp (i𝜔Tb).
(8.40)
Substituting Eq. (8.40) in Eq. (8.6), the signal sample at t = Tb is
u(Tb) = 1
2𝜋∫
∞
−∞
̃x(𝜔)[̃x∗
1(𝜔) −̃x∗
0(𝜔)] d𝜔.
(8.41)
Taking the inverse Fourier transform of Eq. (8.40), we obtain the impulse response of the matched filter as
h(t) = x1(Tb −t) −x0(Tb −t).
(8.42)
This filter can be implemented as a parallel combination of two filters, as shown in Fig. 8.5. The optimum
threshold is given by Eq. (8.22),
rT =
[u1(Tb) + u0(Tb)
2
]
= 1
4𝜋∫
∞
−∞
[̃x1(𝜔) + ̃x0(𝜔)]H(𝜔) exp (−i𝜔Tb) d𝜔.
(8.43)
Using Eq. (8.40), Eq. (8.43) becomes
rT = 1
4𝜋∫
∞
−∞
[|̃x1(𝜔)|2 −|̃x0(𝜔)|2 + ̃x0(𝜔)̃x∗
1(𝜔) −̃x∗
0(𝜔)̃x1(𝜔)] d𝜔.
(8.44)
Since xj(t) is real, we have
̃x∗
j (𝜔) = ̃xj(−𝜔),
j = 1, 2.
(8.45)
So, the last two terms of Eq. (8.44) become
I = ∫
∞
−∞
̃x0(𝜔)̃x1(−𝜔) d𝜔−∫
∞
−∞
̃x0(−𝜔)̃x1(𝜔) d𝜔.
(8.46)
After substituting 𝜔= −𝜔
′ in the first integral, we find I = 0. So, using Eq. (8.36) and Parseval’s relations,
Eq. (8.44) becomes
rT = 1
2[E1 −E0].
(8.47)
Thus, the optimum threshold is half of the energy difference.

342
Fiber Optic Communications
8.2.1
Realization of the Matched Filter
Suppose the input to the matched filter is y(t) (= x(t) + n(t)). The decision is based on the signal r(t), which
is given by
r(t) = [−1{̃y(𝜔)H(𝜔)}] = ∫
∞
−∞
y(𝜏)h(t −𝜏) d𝜏.
(8.48)
In Eq. (8.48), we have used the fact that the product in the spectral domain becomes convolution in the time
domain. From Eq. (8.42), we have
h(t) = x1(Tb −t) −x0(Tb −t),
(8.49)
h(t −𝜏) = x1[Tb −(t −𝜏)] −x0[Tb −(t −𝜏)].
(8.50)
Hence,
r(t) = ∫
∞
−∞
y(𝜏)[x1(Tb + 𝜏−t) −x0(Tb + 𝜏−t)] d𝜏.
(8.51)
The decision is made based on the sample of r(t) at t = Tb:
r(Tb) = ∫
∞
−∞
y(𝜏)[x1(𝜏) −x0(𝜏)]d𝜏= r1(Tb) −r0(Tb),
(8.52)
where
rj(Tb) = ∫
Tb
0
y(𝜏)xj(𝜏)d𝜏,
j = 0, 1.
(8.53)
In Eq. (8.53), we have made use of the fact that xj(t) is zero when t < 0 and t > Tb. Thus, the matched filter
can be realized by the correlation receiver shown in Fig. 8.6. If the energies of the signal u1(t) and u0(t) are
equal, i.e., E1 = E0, from Eq. (8.47) we have rT = 0. In this case, the equivalent form of correlation receiver is
shown in Fig. 8.7. If x0(t) = −x1(t), a simplified form of correlation receiver as shown in Fig. 8.8 may be used.
Decision
device 
If r(Tb) > rT
select x1(t) 
Otherwise
select x0(t)
r1(Tb)
r0(Tb)
r(Tb)
n(t)
x(t)
x1(t)
x0(t)
0
Tb
 ʃ (∙)dt
0
Tb
 ʃ (∙)dt
+
*
∑
∑
Figure 8.6
Realization of the matched filter using correlators.

Performance Analysis
343
Comparator
1(T b
If r1(Tb) > r0(Tb)
select x1(t), 
otherwise select
x0(t).
r1(Tb)
r0(Tb)
n(t)
x(t)
x1(t)
x0(t)
0
Tb
ʃ (∙)dt
0
Tb
ʃ (∙)dt
∑
Figure 8.7
Realization of the matched filter using a correlator when E1 = E0.
Decision
device
If r(Tb) > 0
select x1(t), 
otherwise
select x0(t).
x1(t)
r(Tb)
0
Tb
ʃ (∙)dt
Received signal
Figure 8.8
A realization of the matched filter when x1(t) = −x0(t).
Example 8.1
Find the matched filter and its output at t = Tb for the following signals.
(a)
x(t) =
{
±A
0 < t < TB
0
otherwise.
(8.54)
(b)
x(t) =
⎧
⎪
⎨
⎪⎩
±A exp
[
−(t−TB∕2)2
2T2
0
]
0 < t < TB
0
otherwise.
(8.55)
Assume T0 << TB.
Solution:
(a) To transmit ‘1’ (‘0’), A (−A) is sent over the interval 0 < t < TB. Suppose ‘1’ is transmitted. The Fourier
transform of x(t) is
̃x1(𝜔) = A ∫
TB
0
exp (−i𝜔t)dt = 2A sin (𝜔Tb∕2)
𝜔
e−i𝜔Tb∕2
(8.56)
= −̃x0(𝜔).
(8.57)

344
Fiber Optic Communications
From Eq. (8.33), the matched filter is
H(𝜔) = [̃x∗
1(𝜔) −̃x∗
0(𝜔)] exp (−i𝜔TB)
= 4A sin (𝜔Tb∕2)
𝜔
exp (−i𝜔Tb∕2).
(8.58)
Using Eq. (8.6), the signal sample at t = TB is
u(TB) = ±8A2
2𝜋∫
∞
−∞
sin2 (𝜔TB∕2)
𝜔2
d𝜔
= ±2A2TB.
(8.59)
Note that A2Tb is the pulse energy, E1. Since x0(t) = −x1(t), the matched filter can also be realized using a
correlation receiver as shown in Fig. 8.8:
r(TB) = ∫
TB
0
y(t)x1(t) dt,
(8.60)
u(TB) = ∫
TB
0
x(t)x1(t) dt = ±A2Tb,
(8.61)
r(Tb) = u(Tb) + nF(Tb).
(8.62)
If r(TB) is positive (negative), the threshold device selects bit ‘1’ (‘0’). Note that the signal value given by
Eq. (8.61) is half of that given by Eq. (8.59). As far as the BER is concerned, this makes no difference since
the noise sample corresponding to Fig. 8.8 is half of that corresponding to Fig. 8.5.
(b) Since T0 << TB, the signal power outside the bit interval is negligible. So, we approximate Eq. (8.55) as
x(t) = s(t −TB∕2),
(8.63)
s(t) = ±A exp
(
−t2
2T2
0
)
.
(8.64)
From Eq. (2.152), we have
̃s(𝜔) = ±A
a exp
[
−𝜔2
4𝜋a2
]
,
(8.65)
a =
1
√
2𝜋T0
.
(8.66)
Using the time-shifting property, we find
̃x(𝜔) = ̃s(𝜔)ei𝜔Tb∕2,
(8.67)
̃x1(𝜔) = −̃x0(𝜔) = A
a exp
[
−𝜔2
4𝜋a2 + i𝜔Tb∕2
]
,
(8.68)
H(𝜔) = 2A
a exp
[
−𝜔2
4𝜋a2 + i𝜔Tb
2
]
.
(8.69)

Performance Analysis
345
Substituting Eqs. (8.67) and (8.69) in Eq. (8.6), we find
u(Tb) = ± A2
𝜋a2 ∫
∞
−∞
e
−𝜔2
2𝜋a2 d𝜔
= ±2A2√
𝜋T0,
(8.70)
where A2√
𝜋T0 is the pulse energy E1.
8.2.2
Error Probability with an Arbitrary Receiver Filter
From Eqs. (8.27) and (8.28), we have
Pb = 1
2erfc
(√
𝑣
8
)
,
(8.71)
𝑣= [u1(Tb) −u0(Tb)]2
𝜎2
,
(8.72)
where uj(Tb) and 𝜎2 are given by Eqs. (8.6) and (8.7), respectively. Eqs. (8.71) and (8.72) are valid for arbitrary
filter shapes. From Eq. (7.8), we have
Q = I1 −I0
𝜎1 + 𝜎0
.
(8.73)
Since the mean of bit ‘1’ (‘0’) is u1(Tb)(u0(Tb)), Eq. (8.72) becomes
𝑣=
(I1 −I0
𝜎
)2
.
(8.74)
When 𝜎1 = 𝜎0 ≡𝜎, from Eqs. (8.74) and (8.73), we find
𝑣= 4Q2,
(8.75)
Pb = 1
2erfc
(
Q
√
2
)
.
(8.76)
8.3
Homodyne Receivers
Consider a fiber-optic transmission system with a homodyne balanced receiver, as shown in Fig. 8.9. Its
mathematical representation is shown in Fig. 8.10. Let the transmitted optical field distribution be
qs = s(t) exp (−i𝜔ct),
(8.77)
where s(t) is the complex field envelope, 𝜔c is the angular frequency of the optical carrier. We make the
following assumptions to find the best achievable performance.
(1) Fiber dispersion, PMD, and nonlinearity are absent so that the fiber channel can be modeled as an AWGN
channel. In fact, fiber dispersion and PMD cause distortion, and nonlinearity causes both distortion and noise
enhancement, which will be discussed in Chapters 10 and 11.
(2) The frequency, phase, and polarization of the local oscillator are exactly aligned with the received signal.

346
Fiber Optic Communications
…  
BPF
A
A
F
F
qin = s(t)e*iωct
qout = u(t)e*iωct
Homodyne
receiver 
u(t)
Figure 8.9
A fiber-optic transmission system with a homodyne receiver. F = fiber, A = amplifier, BPF = band-pass
filter.
Threshold
device
t = Tb
r(Tb)
AWGN
Channel
Tx
Coherent
Rx
LPF
H (ω)
nd
r(t) = u(t) + nF
LO
Decision
s(t)e*iωct
[s(t) + nc (t)]e*iωct
nc(t)e*iωct
ALOe*iωct
2RALORe[s(t) + nc(t)]
+
+
+
+
∑
∑
Figure 8.10
Mathematical representation of fiber-optic link with homodyne coherent receiver. LO = local oscillator,
LPF = low-pass filter.
The fiber-optic channel noise can be written as
qn = nc(t) exp (−i𝜔ct),
(8.78)
where nc(t) is the complex field envelope of the noise field with its PSD given by Eq. (6.17),
𝜌ASE = nsphf(G −1).
(8.79)
where f is the mean frequency. The output of the fiber-optic link is the sum of the signal field and the noise
field,
qout = [s(t) + nc(t)] exp (−i𝜔ct).
(8.80)
When the phase and frequency of the LO are aligned with those of the received signal, the current output of
the balanced homodyne receiver may be written as (see Eq. (5.112))
Is(t) = 2RALORe[s(t) + nc(t)] = 2RALO[s(t) + ncr(t)].
(8.81)
Here, the subscript r denotes the real part and s(t) is assumed to be real. Let nd(t) be the noise introduced at
the detection stage. We assume that the LO power is sufficiently large so that the shot noise dominates the
thermal noise. Ignoring the thermal noise, the PSD of nd(t) is given by Eq. (7.50),
𝜌nd = 𝜌shot,eff = qRA2
LO.
(8.82)
The total current is
Itot = Is(t) + nd(t) = 2RALO[s(t) + n(t)],
(8.83)

Performance Analysis
347
where
n(t) = ncr(t) + nd(t)
2RALO
(8.84)
is a white noise process with Gaussian distribution. Its PSD is
𝜌n =
Nhomo
0
2
= 𝜌ASE
2
+
𝜌shot,eff
4A2
LOR2
(8.85)
= 𝜌ASE
2
+ q
4R.
(8.86)
The factor 1∕2 is introduced in the first term of Eq. (8.85) since the PSD of the real part of nc(t) is half of that
of nc(t). The scaling factor 2RALO appearing in Eq. (8.83) multiplies both signal and noise and, hence, it is of
no consequence in evaluating the performance. Dropping this term, we write the normalized signal used for
decision as
Id = s(t) + n(t).
(8.87)
8.3.1
PSK: Homodyne Detection
The optical field envelope may be written as
s(t) =
{
s1(t)
for bit ‘1’
s0(t) = −s1(t)
for bit ‘0’.
(8.88)
We assume that s(t) is real and the filter shown in Fig. 8.6 is matched to s(t). Replacing x(t) by s(t) in Eq. (8.36),
we obtain
E1 = ∫
Tb
0
s2
1(t)dt = E0,
(8.89)
E10 = −∫
Tb
0
s2
1(t)dt = −E1,
(8.90)
𝑣max =
2
Nhomo
0
(E1 + E0 −2E10) =
8E1
Nhomo
0
.
(8.91)
Since the bits ‘1’ and ‘0’ are equally probable, the average energy transmitted is
Eav = E1 + E0
2
= E1.
(8.92)
The average energy forms a basis for comparison of various modulation formats and Eq. (8.91) can be written
as
𝑣max = 8Eav
Nhomo
0
.
(8.93)
The matched filter is given by (Eq. (8.40))
H(𝜔) = [̃s∗
1(𝜔) −̃s∗
0(𝜔)] exp (−i𝜔Tb) = 2̃s∗
1(𝜔) exp (−i𝜔Tb),
(8.94)
and the threshold rT is (Eq. (8.47))
rT = E1 −E0
2
= 0.
(8.95)

348
Fiber Optic Communications
Using Eq. (8.93) in Eq. (8.39), we obtain
Pb = 1
2erfc(
√
𝛾homo),
(8.96)
𝛾homo =
Eav
Nhomo
0
.
(8.97)
The parameter 𝛾homo represents the normalized energy per bit, which serves as a figure of merit in digital
communication.
When 𝛾homo is much larger than unity, Eq. (8.96) can be approximated as
Pb ≅exp (−𝛾homo)
2
√
𝜋𝛾homo .
(8.98)
8.3.1.1
Relation between Q-factor and BER
The BER and Q-factor are related as follows. From Eq. (7.8), we have
Q = I1 −I0
𝜎1 + 𝜎0
.
(8.99)
For a PSK signal, I1 = −I0 and 𝜎1 = 𝜎0. So,
Q = I1
𝜎1
.
(8.100)
Suppose that the correlator shown in Fig. 8.8 is used as the matched filter. The mean of bit ‘1’ after the
correlator is (after setting the scaling factor 2RALO to unity in Eq. (8.83))
I1 = ∫
Tb
0
s2
1(t) dt
= Eav.
(8.101)
In this case, we have
h(t) = s1(Tb −t),
(8.102)
H(𝜔) = s∗
1(𝜔) exp (−i𝜔Tb).
(8.103)
The variance of bit ‘1’ (or bit ‘0’) after the correlator is (see Eq. (8.7))
𝜎2
1 =
Nhomo
0
2
1
2𝜋∫
∞
−∞
|H(𝜔)|2d𝜔=
Nhomo
0
2
∫
Tb
0
s2
1(t)dt =
Nhomo
0
2
Eav.
(8.104)
Here, we have used Parseval’s relations. Substituting Eqs. (8.101) and (8.104) in Eq. (8.100), we find
Q =
√
2Eav
Nhomo
0
.
(8.105)
From Eqs. (8.97) and (8.96), we have
𝛾homo = Q2
2 ,
(8.106)
Pb = 1
2erfc
(
Q
√
2
)
.
(8.107)
Eq. (8.107) holds true even when the matched filter is not used (see Section 8.2.2).

Performance Analysis
349
8.3.2
On–Off Keying
In this case, the optical field envelope may be written as
s(t) = s1(t)
for bit ‘1’
(8.108)
= 0
for bit ‘0’
(8.109)
Therefore,
E0 = 0
and
E10 = 0.
(8.110)
The average energy is
Eav = E1∕2.
(8.111)
Using Eqs. (8.111) and (8.110), Eqs. (8.38) and (8.39) can be written as
𝑣max = 4Eav∕Nhomo
0
= 4𝛾homo
(8.112)
and
Pb = 1
2erfc
(√
𝛾homo
2
)
(8.113)
≅exp (−𝛾homo∕2)
√
2𝜋𝛾homo
when
𝛾homo ≫1.
(8.114)
Fig. 8.11 shows the error probability as a function of the parameter 𝛾homo. Comparing Eqs. (8.113) and (8.96),
we see that to achieve a fixed BER, the average energy should be doubled for the systems based on OOK
compared with the systems based on PSK when the noise power of the channel is fixed. Alternatively, when
the average energy of the transmitted signal is fixed, the system based on PSK can tolerate twice the noise
power compared with the systems based on OOK to achieve the same BER.
*10
*5
0
5
10
15
10*15
10*10
10*5
100
γhomo (dB)
Pb
PSK
OOK
Figure 8.11
Plot of error probability vs. 10log 10𝛾homo.

350
Fiber Optic Communications
8.4
Heterodyne Receivers
The photocurrent in a heterodyne receiver is given by Eq. (5.94),
I(t) = 2RALORe{[s(t) + nc(t)] exp [−i(𝜔IFt + Δ𝜙)]}.
(8.115)
Ignoring the thermal noise, the PSD of the noise current nd(t) introduced at the detection stage is
𝜌nd = 𝜌shot,eff = qRA2
LO.
(8.116)
The total current is
Itot(t) = 2RALO[s(t) + ncI(t)] cos (𝜔IFt + Δ𝜙)
+2RALOncQ(t) sin (𝜔IFt + Δ𝜙) + nd(t),
(8.117)
where
ncI(t) = Re[nc(t)],
ncQ(t) = Im[nc(t)],
(8.118)
and s(t) is real. See Fig. 8.12. The total current may be rewritten as a summation of signal current and noise
current:
Itot(t) = Is(t) + nhet(t),
(8.119)
where
Is(t) = 2RALOs(t) cos (𝜔IFt + Δ𝜙),
(8.120)
nhet(t) = 2RALO
{
ncI cos (𝜔IFt + Δ𝜙) + ncQ sin (𝜔IFt + Δ𝜙) + nd(t)
2RALO
}
.
(8.121)
Note that 2RALO appears as a scaling factor both in the signal and noise components. As before, we drop this
scaling factor from now on. The PSD of nhet(t) is (see Example 8.5)
Nhet
0
2
= 𝜌ASE
4
+
𝜌shot,eff
4R2A2
LO
(8.122)
= 𝜌ASE
4
+ q
4R.
(8.123)
t = Tb
r(Tb)
r(t)
Tx
Coherent
Rx 
Decision
device 
AWGN
channel 
LO
ALOe*i(ωLOt  + φLO)
nd(t)
Synchronous or
non-synchronous
detection 
s(t)e*iωct
[s(t) + nc(t)]e*iωct
2RALORe{[s(t) + nc(t)]e*i(ωIFt + Δφ)}
nc(t)e*iωct
∑
∑
Figure 8.12
A fiber-optic link with heterodyne receiver.

Performance Analysis
351
For signals such as OOK, the information is contained only in the amplitude and if a detection scheme ignores
the phase of the received signal, it does not lead to the loss of information. Such a scheme is known as asyn-
chronous detection. For example, if the received signal passes through an envelope detector, the phase infor-
mation is lost and the transmitted information is retrieved asynchronously without having to track the phase
of the received signal. In non-optical communication, asynchronous receivers are known as non-coherent
receivers [1, 2]. In contrast, a detector can detect the phase of the transmitted signal by carefully aligning the
phase of the microwave oscillator (or equivalently synchronizing the timings of the oscillator output) with the
received signal and such a scheme is known as synchronous detection. For PSK signals, a synchronous detec-
tor has to be used. For homodyne receivers, asynchronous detection schemes can be realized by introducing
an envelope detector in the DSP unit. The performance of modulation schemes with homodyne asynchronous
detection is similar to the corresponding heterodyne receivers.
8.4.1
PSK: Synchronous Detection
The received signal in the absence of noise can be written as
I(t) =
{
I1(t)
for ‘1’
I0(t)
for ‘0’
(8.124)
where
Ij(t) = sj(t) cos (𝜔IFt + Δ𝜙),
j = 0, 1,
(8.125)
with s0(t) = −s1(t). We assume that s(t) is real. The filter matched to I(t) is (see Eq. (8.40))
HI(𝜔) = [̃I∗
1(𝜔) −̃I∗
0(𝜔)] exp (i𝜔Tb)
= [̃s∗
1(𝜔−𝜔IF)eiΔ𝜙+ ̃s∗
1(𝜔+ 𝜔IF)e−iΔ𝜙] exp (i𝜔Tb).
(8.126)
This matched filter can be realized as a correlator, as shown in Fig. 8.13. In this case, Eq. (8.52) is modified as
r(Tb) = ∫
Tb
0
y(𝜏)[I1(𝜏) −I0(𝜏)] d𝜏
= 2 ∫
Tb
0
y(𝜏)s1(𝜏) cos (𝜔IF𝜏+ Δ𝜙) d𝜏.
(8.127)
Using Eq. (8.35), we have
𝑣max =
2
Nhet
0
∫
Tb
0
[I1(t) −I0(t)]2dt =
8
Nhet
0
∫
Tb
0
s2
1(t)cos2(𝜔IFt + Δ𝜙)dt = 4E1
Nhet
0
.
(8.128)
Decision
device 
s(t)cos(ωIFt + ∆φ) + nhet(t)
2s1(t)cos(ωIFt + ∆φ)
r(t) = u(Tb) + nF(Tb)
0
Tb
ʃ (∙)dt
Figure 8.13
Matched filter for a PSK signal in a fiber-optic system with heterodyne receiver.

352
Fiber Optic Communications
Decision
device 
Hs (ω)
t = Tb
s(t)cos(ωIFt + ∆φ)
cos(ωIFt + ∆φ)
r(Tb) = u(Tb) + nF(Tb)
Figure 8.14
Matched filter for the baseband signal after down-conversion.
Alternatively, the photocurrent can be down-converted to the baseband by demodulating synchronously and
the result is applied to a filter Hs(𝜔), matched to the baseband signal s(t), as shown in Fig. 8.14. In this case,
we find that (see Example 8.7)
𝑣max = 4E1
Nhet
0
.
(8.129)
In both cases, we obtain the same 𝑣max and, using Eq. (8.129) in Eq. (8.39), we obtain
Pb = 1
2 erfc
(√
𝛾het
2
)
(8.130)
where
𝛾het = Eav
Nhet
0
.
(8.131)
8.4.1.1
ASE Limited Systems
When 𝜌ASE ≫𝜌shot∕(4A2
LOR2), the second term of Eq. (8.122) can be ignored. In this case,
Nhet
0
= 𝜌ASE
2
.
(8.132)
Now, Eq. (8.130) reduces to
Phet
b
= 1
2 erfc
(√
Eav
𝜌ASE
)
.
(8.133)
Under the same conditions, from Eq. (8.85), we have
Nhomo
0
= 𝜌ASE
(8.134)
and
Phomo
b
= 1
2 erfc
(√
Eav
𝜌ASE
)
.
(8.135)
Thus, the performances of the homodyne and heterodyne receivers are the same for a PSK signal when the
ASE is dominant.
8.4.1.2
Shot Noise-Limited Systems
In this case, 𝜌shot ≫𝜌ASEA2
LOR2 and we ignore the first term of Eq. (8.122) and use Eq. (8.82) to obtain
Nhet
0
=
𝜌shot,eff
2R2A2
LO
= hf
2𝜂
(8.136)

Performance Analysis
353
and
Phet
b
= 1
2 erfc
(√
𝜂Eav
hf
)
.
(8.137)
The corresponding expressions for homodyne detection are
Nhomo
0
= hf
2𝜂,
(8.138)
Phomo
b
= 1
2 erfc
(√
2𝜂Eav
hf
)
.
(8.139)
Comparing Eqs. (8.137) and (8.139), we find that the homodyne receiver has a 3-dB advantage over the
heterodyne receiver when the shot noise is dominant [3]–[5]. In other words, to reach a fixed error probability,
the received signal power in the case of a heterodyne receiver should be twice that of a homodyne receiver.
This can be explained as follows. In the case of the heterodyne receiver, the signal is modulated by a carrier at
a frequency 𝜔IF. Since the average energy of the signal s(t) cos (𝜔IFt + Δ𝜙) is half of that of the transmitted
signal s(t), the heterodyne receivers have a 3-dB disadvantage over the homodyne receivers. However, for
long-haul systems, the noise due to in-line amplifiers is dominant and, hence, the performances of homodyne
and heterodyne receivers are roughly the same.
Sine Eav∕hf is the mean number of received signal photons Ns, Eqs. (8.137) and (8.139) may be rewritten as
Phet
b
= 1
2 erfc(
√
𝜂Ns),
(8.140)
Phomo
b
= 1
2 erfc(
√
2𝜂Ns).
(8.141)
For example, when 𝜂= 1 and Ns = 9, Phomo
b
= 1
2erfc(
√
18) = 10−9, in agreement with Eq. (7.63). When Ns =
18, Phet
b
= 10−9 [4].
8.4.2
OOK: Synchronous Detection
The received signal in the absence of noise can be written as
I(t)
{
= I1(t)
for ‘1’
= I0(t)
for ‘0’
(8.142)
Ij(t) = sj(t) cos (𝜔IFt),
j = 0, 1,
(8.143)
with s0(t) = 0. Here Δ𝜙is set to zero for simplicity. Proceeding as in Section 8.4.1, we find
Pb = 1
2 erfc
(√
𝛾het
4
)
.
(8.144)

354
Fiber Optic Communications
Example 8.2
In a 10-Gb/s unrepeatered fiber-optic system based on PSK, rectangular NRZ pulses are transmitted with a
peak power of 5 dBm. The fiber loss is 50 dB. The gain and nsp of the pre-amplifier used at the receiver are
30 dB and 1.5, respectively. R = 0.9 A/W. Find the error probability if the receiver is (a) a balanced homodyne
or (b) a balanced heterodyne. Ignore thermal noise. Repeat this example if the signal is OOK with the same
peak power.
Solution:
Signal calculation
Launch peak power = P0(dBm) = 5 dBm
Fiber loss(dB) = 50 dB
Preamplifier gain, G(dB) = 30 dB
The peak power of the received signal is
Pr(dBm) = P0(dBm) −fiber loss(dB) + G(dB)
= 5 dBm −50 dB + 30 dB
= −15 dBm,
(8.145)
Pr = 10Pr(dBm)∕10 mW = 3.16 × 10−5 W.
(8.146)
The bit interval is
Tb =
1
10 × 109 = 10−10 s.
(8.147)
The energy of bit ‘1’ is
E1 = PrTb
= 3.16 × 10−5 × 10−10 J
= 3.16 × 10−15 J.
(8.148)
For PSK, the average energy Eav = E1.
Noise calculation
The PSD of ASE is given by Eq. (6.17),
𝜌ASE = nsphf(G −1),
(8.149)
nsp = 1.5,
(8.150)
h = 6.626 × 10−34 Js,
(8.151)
f = c
𝜆=
3 × 108
1550 × 10−9 = 193.54 THz,
(8.152)
G = 10G(dB)∕10 = 1000,
(8.153)

Performance Analysis
355
𝜌ASE = 1.5 × 6.626 × 10−34 × 193.54 × (1000 −1)
= 1.921 × 10−16 W/Hz.
(8.154)
The PSD of effective shot noise is given by Eq. (7.50),
𝜌shot,eff = qILO
= qRA2
LO.
(8.155)
From Eq. (8.85), we have
Nhomo
0
= 𝜌ASE +
𝜌shot,eff
2R2A2
LO
= 𝜌ASE + q
2R.
(8.156)
Electron charge q = 1.602 × 10−19 C,
R = 0.9 A/W,
(8.157)
Nhomo
0
= 1.921 × 10−16 + 1.602 × 10−19
2 × 0.9
W/Hz
= 1.922 × 10−16 W/Hz,
(8.158)
From Eq. (8.122), we have
Nhet
0
= 𝜌ASE
2
+
𝜌shot,eff
2R2A2
LO
= 9.617 × 10−17 W/Hz,
(8.159)
Error Probability
(a) For a balanced homodyne receiver with PSK signal, the error probability is given by Eq. (8.96),
PPSK
b
= 1
2erfc
(√
Eav
Nhomo
0
)
= 1
2erfc
(√
3.16 × 10−15
1.922 × 10−16
)
= 4.86 × 10−9.
(8.160)
If the signal is OOK, from Eq. (8.113) we have
POOK
b
= 1
2erfc
(√
Eav
2Nhomo
0
)
,
(8.161)
Eav = E1
2 = 1.58 × 10−15 J,
(8.162)
POOK
b
= 1
2erfc
(√
1.58 × 10−15
2 × 1.922 × 10−16
)
= 2.06 × 10−3.
(8.163)

356
Fiber Optic Communications
(b) For a balanced heterodyne receiver with PSK signal, the error probability is given by Eq. (8.130),
PPSK
b
= 1
2erfc
(√
Eav
2Nhet
0
)
= 1
2erfc
(√
3.16 × 10−15
2 × 9.617 × 10−17
)
= 4.901 × 10−9.
(8.164)
If the signal is OOK, from Eq. (8.144) we have
POOK
b
= 1
2erfc
(√
Eav
4Nhet
0
)
= 2.07 × 10−3.
(8.165)
8.4.3
FSK: Synchronous Detection
To transmit bit ‘1’ (‘0’), the frequency of the optical carrier is shifted by Δ𝜔∕2 (−Δ𝜔2). The complex field
envelopes corresponding to bits ‘1’ and ‘0’ are
s1(t) = A exp
(−iΔ𝜔t
2
)
,
s0(t) = A exp
(iΔ𝜔t
2
)
,
(8.166)
for a duration of Tb. The photocurrents are
I = I1(t)
for bit ‘1’
(8.167)
= I0(t)
for bit ‘0’
(8.168)
where
I1(t) = Re[s1(t) exp (−i𝜔IFt)] = A cos
[(
𝜔IF + Δ𝜔
2
)
t
]
,
I0(t) = A cos
[(
𝜔IF −Δ𝜔
2
)
t
]
.
(8.169)
Here, we have ignored the constant factor 2RALO and Δ𝜙is set to zero. The filter matched to I(t) can be
realized as a correlator, as shown in Fig. 8.15. Replacing x1(t) and x0(t) of Eq. (8.36) by I1(t) and I0(t),
respectively, we obtain
Ee
10 = ∫
Tb
0
I1(t)I0(t) dt
= A2
2 ∫
Tb
0
[cos (Δ𝜔t) + cos (𝜔IFt)] dt
= A2Tb
2
[sinc(Δ𝜔Tb∕𝜋) + sinc(𝜔IFTb∕𝜋)],
(8.170)

Performance Analysis
357
Decision
device 
If  r(Tb) > 0
select ‘1’
Otherwise
select ‘0’
r(Tb)
I(t)
0
Tb
ʃ (∙)dt
0
Tb
ʃ (∙)dt
2
∆ω
ωIF +
Acos
t
2
∆ω
ωIF *
Acos
t
*
+
∑
Figure 8.15
Matched filter for FSK signal in a fiber-optic system with heterodyne receiver.
where
sinc(x) = sin (𝜋x)
𝜋x
.
(8.171)
The superscript e is introduced to indicate that E represents the energy of a bit in the electrical domain. When
𝜔IF ≫1∕Tb, the second term on the right-hand side of Eq. (8.170) can be ignored. Similarly,
Ee
0 = Ee
1 = A2
∫
Tb
0
cos2 [(
𝜔IF + Δ𝜔
2
)
t
]
dt
= A2
2 ∫
Tb
0
{
1 + cos
[
2
(
𝜔IF + Δ𝜔
2
)
t
]}
dt
= A2Tb
2
.
(8.172)
The contribution from the second term on the right-hand side of Eq. (8.172) is negligible since 𝜔IF ≫1∕Tb.
Here, Ee
j denotes the normalized energy of the bit ‘j’, j = 0, 1 in the electrical domain. The corresponding
energy in the optical domain is
Eopt
1
= ∫
Tb
0
|s1(t)|2dt = A2Tb = Eav.
(8.173)
Substituting Eqs. (8.172) and (8.170) in Eq. (8.38), we obtain
𝑣max = 2Eav
Nhet
0
[1 −sinc(Δ𝜔Tb∕𝜋)],
(8.174)
Pb = 1
2erfc
(√𝑣max
8
)
.
(8.175)
The above equation is valid for arbitrary frequency difference Δ𝜔. To find the minimum achievable BER,
we need to minimize Pb with respect to Δ𝜔or equivalently maximize 𝑣max. In other words, the sinc function
should be minimum. From Fig. 8.16, we see that the minimum value is −0.217 at Δ𝜔Tb = 1.43𝜋. Choosing

358
Fiber Optic Communications
0
0.5
1
1.5
2
2.5
3
3.5
4
*0.4
0
0.2
0.4
0.6
0.8
1
*0.217
 Sinc(∆ωTb/π) 
∆ωTb/π 
Figure 8.16
Sinc function.
this value of Δ𝜔in Eq. (8.174), we obtain
Pb = 1
2erfc
(√
1.217𝛾het
4
)
.
(8.176)
Comparing Eqs. (8.144) and (8.176), we find that a system based on OOK requires an average energy 1.217
times that of a system based on FSK to achieve the given BER.
8.4.3.1
Orthogonal FSK
The signals I1(t) and I0(t) are said to be orthogonal if
Ee
10 = ∫
Tb
0
I1(t)I0(t) dt = 0.
(8.177)
From Eq. (8.170), we find that Ee
10 is zero if
Δ𝜔Tb = n𝜋,
n = 1, 2, 3, …
(8.178)
or
Δf =
n
2Tb
.
(8.179)
As Δf increases, the signal bandwidth increases too. The minimum frequency separation occurs when n = 1:
Δfmin =
1
2Tb
.
(8.180)

Performance Analysis
359
The FSK scheme using the frequency separation given by Eq. (8.180) is called minimum shift keying (MSK).
Since Ee
10 is zero for orthogonal FSK,
𝑣max =
2
Nhet
0
(Ee
1 + Ee
0) = 2Eav
Nhet
0
(8.181)
and
Pb = 1
2erfc
(√
𝛾het
4
)
.
(8.182)
Comparing Eqs. (8.182) and (8.144), we see that the expression for Pb for systems based on OOK is the same
as that for systems based on orthogonal FSK when synchronous detection is used in both systems.
8.4.4
OOK: Asynchronous Receiver
In Section 8.4.2, we discussed the error probability for the OOK signal with the receiver filter matched to I(t)
exactly. Here, we consider the case in which the receiver filter is matched to I(t) except for the phase. The
transmitted optical field envelope can be written as
s(t) =
{
s1(t)
for bit ‘1’
0
for bit ‘0’
(8.183)
Without loss of generality, we assume that s(t) is real. The received signal passes through a filter matched to
s1(t) cos (𝜔IFt). From Eq. (8.120), the photocurrent is
I1(t) = s1(t) cos (𝜔IFt + Δ𝜙),
̃I1(𝜔) = [̃s1(𝜔−𝜔IF) exp (−iΔ𝜙) + ̃s1(𝜔+ 𝜔IF) exp (iΔ𝜙)]
2
.
(8.184)
As before, we have ignored the scaling factor 2RALO. The matched filter need not match the phase Δ𝜙of I1(t).
One possible way of realizing this type of matched filter is to use the envelope detector which detects only
the envelope and ignores the phase, i.e., it is matched to s1(t) cos (𝜔IFt). The transfer function of the matched
filter is
HI(𝜔) = {[s1(t) cos (𝜔IFt)]}∗exp (i𝜔Tb)
=
[̃s∗
1(𝜔−𝜔IF) + ̃s∗
1(𝜔+ 𝜔IF)] exp (i𝜔Tb)
2
.
(8.185)
The impulse response of the matched filter can be found from Eq. (8.42) by replacing x1(t) with s1(t) cos (𝜔IFt)
and x0(t) with zero:
hI(t) = s1(Tb −t) cos [𝜔IF(Tb −t)].
(8.186)
The matched filter can be realized as a correlator (see Fig. 8.6), and the signal component of its output is
(Eq. (8.48))
IF(t) = ∫
Tb
0
s(𝜏) cos (𝜔IF𝜏+ Δ𝜙)s1(Tb + 𝜏−t) cos [𝜔IF(Tb + 𝜏−t)]d𝜏
(8.187)
= 1
2 ∫
Tb
0
s(𝜏)s1(Tb + 𝜏−t){cos [𝜔IF(t −Tb) + Δ𝜙]
+ cos (𝜔IF(2𝜏+ Tb −t) + Δ𝜙)}d𝜏.
(8.188)

360
Fiber Optic Communications
t = Tb
Coherent
Rx 
Decision
device 
r(t)
r(Tb)
LO
nd (t)
HI (ω)
(∙)2
LPF
(∙)
Envelope detector
[s(t) + nc(t)]e*iωct
2RALORe{[s(t) + nc(t)]e*i(ωIF + ∆φ)}
ALOe*iωLO + φLO
∑
Figure 8.17
A heterodyne receiver with an envelope detector and a matched filter HI(𝜔) for OOK.
In Eq. (8.188), the second term on the right-hand side corresponds to the Fourier transform of s(𝜏)s1(𝜏+ Tb −
t) at 𝜔= ±2𝜔IF. Since the spectral width of s(𝜏) is much smaller than 𝜔IF, the second term can be ignored.
Therefore,
IF(t) = sF(t)
2
⏟⏟⏟
envelope
cos [𝜔IF(t −Tb) + Δ𝜙],
(8.189)
where
sF(t) = ∫
Tb
0
s(𝜏)s1(Tb + 𝜏−t) d𝜏.
(8.190)
The output of the matched filter passes through an envelope detector which can be imagined as a cascade of
squarer, low-pass filter, and square-rootor, as shown in Fig. 8.17. When we square IF(t), we obtain a term
proportional to cos [2𝜔IF(t −Tb) + Δ𝜙] which is rejected by the low-pass filter. The signal output of the
envelope detector is the envelope of IF(t) (shown in Eq. (8.189)), which is given by
u(t) = sF(t)∕2,
(8.191)
u(Tb) = sF(Tb)
2
= 1
2 ∫
Tb
0
s(𝜏)s1(𝜏) d𝜏,
(8.192)
u(Tb) = E1∕2
when ‘1’ is sent
= 0
when ‘0’ is sent.
(8.193)
Next, consider the noise component before the matched filter given by Eq. (8.121),
n(t) = ncI cos (𝜔IFt + Δ𝜙) + ncQ sin (𝜔IFt + Δ𝜙) + nd(t)
2RALO
.
(8.194)
Here, we have dropped the scaling factor 2RALO. Since the ASE is expressed as the modulated noise process,
it is convenient to express the detector noise as the modulated noise process as well, i.e.,
nd(t) = ndI cos (𝜔IFt + Δ𝜙) + ndQ sin (𝜔IFt + Δ𝜙),
(8.195)

Performance Analysis
361
where ndI and ndQ are the in-phase and quadrature components of the detector noise. Substituting Eq. (8.195)
in Eq. (8.194), we find
n(t) = nI cos (𝜔IFt + Δ𝜙) + nQ sin (𝜔IFt + Δ𝜙),
(8.196)
where
nI = ncI + ndI∕(2RALO),
(8.197)
nQ = ncQ + ndQ∕(2RALO).
(8.198)
We assume that n(t) is a narrow-band Gaussian noise process with zero mean and it is band-limited to the fre-
quency interval fIF −B ≤|f| ≤fIF + B. First consider nI cos (𝜔IFt + Δ𝜙). After passing through the matched
filter, it becomes (see Eq. (8.188))
1
2 ∫
Tb
0
nI(𝜏)s1(Tb + 𝜏−t){cos [𝜔IF(t −Tb) + Δ𝜙] + cos (𝜔IF(2𝜏+ Tb −t) + Δ𝜙)} d𝜏.
(8.199)
As before, the second term on the right-hand side can be ignored. So, it becomes
nFI cos [𝜔IF(t −Tb) + Δ𝜙],
(8.200)
where
nFI = 1
2 ∫
Tb
0
nI(𝜏)s1(Tb + 𝜏−t) d𝜏.
(8.201)
Similarly, the second term of Eq. (8.196) becomes
nFQ sin [𝜔IF(t −Tb) + Δ𝜙],
(8.202)
where
nFQ = 1
2 ∫
Tb
0
nQ(𝜏)s1(Tb + 𝜏−t) d𝜏.
(8.203)
Combining Eqs. (8.200) and (8.202), the noise output of the matched filter is
nF(t) = [nFI cos (𝜔IF(t −Tb) + Δ𝜙) + nFQ sin (𝜔IF(t −Tb) + Δ𝜙)],
(8.204)
where nFI(t) and nFQ(t) are the in-phase and quadrature components of nF(t). The PSD of n(t) is Nhet
0 ∕2. From
Eq. (8.7), we have
𝜎2
F = < n2
F >
=
Nhet
0
2
1
2𝜋∫
∞
−∞
|HI(𝜔)|2 d𝜔
(8.205)
=
Nhet
0
16𝜋∫
∞
−∞
[|̃s1(𝜔−𝜔IF)|2 + |̃s1(𝜔+ 𝜔IF)|2 d𝜔].
(8.206)
In Eq. (8.205) we ignore cross-products such as ̃s∗
1(𝜔−𝜔IF)s1(𝜔+ 𝜔IF). This is because ̃s1(𝜔−𝜔IF) and
̃s∗
1(𝜔+ 𝜔IF) represent frequency components centered around 𝜔IF and −𝜔IF, respectively. If the spectral width
of s1(t) is smaller than 𝜔IF, these frequency components do not overlap. Noting that the contributions from
the first and second terms on the right-hand side of Eq. (8.206) are the same, we find
𝜎2
F =
Nhet
0
8𝜋∫
∞
−∞
|̃s1(𝜔)|2d𝜔=
Nhet
0 E1
4
.
(8.207)

362
Fiber Optic Communications
The total output of the matched filter is
IF(t) + nF(t) =
(sF(t)
2
+ nFI(t)
)
cos 𝜃+ nFQ(t) sin 𝜃
=
√[sF(t)
2
+ nFI(t)
]2
+ n2
FQ(t)
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
envelope
⋅cos (𝜃−𝜙),
(8.208)
where
𝜃= 𝜔IF(t −Tb) + Δ𝜙,
(8.209)
𝜙= tan−1
{
nFQ(t)
sF(t)∕2 + nFI(t)
}
.
(8.210)
After passing through the envelope detector, the output sample at t = Tb is proportional to the envelope:
r(Tb) =
√
[sF(Tb)∕2 + nFI(Tb)]2 + n2
FQ(Tb).
(8.211)
When a bit ‘0’ is transmitted, sF(Tb) = 0. Therefore,
r(Tb) =
√
n2
FI(Tb) + n2
FQ(Tb).
(8.212)
For a narrow-band noise process, it can be shown that the variances of the in-phase component nFI(t) and
the quadrature component nFQ(t) are the same as for the narrow-band noise nF(t) [2]. Therefore, nFI(Tb) and
nFQ(Tb) are Gaussian random variables with variance 𝜎2
F given by Eq. (8.207). The pdf of the envelope when
‘0’ is transmitted is given by the Rayleigh distribution [6],
p(r|‘0’ sent) = r
𝜎2
F
exp
(
−r2
2𝜎2
F
)
.
(8.213)
When a bit ‘1’ is transmitted, r(t) is an envelope of a cosine wave in the presence of Gaussian noise
(Eq. (8.208)), its amplitude sF(Tb)∕2 = E1∕2 (see Eq. (8.193)) and, therefore, the pdf of r(t) is given by the
Rician distribution [6]
p(r|‘1’ sent) = r
𝜎2
F
exp
(
−
r2 + E2
1∕4
2𝜎2
F
)
I0
(
rE1
2𝜎2
F
)
,
(8.214)
where I0(x) is the modified zero-order Bessel function of the first kind. The threshold is determined by the
intersection of two curves p(r|‘1’ sent) and p(r|‘0’ sent) (see Eq. (8.19)):
p(r|‘1’ sent) = p(r|‘0’ sent),
(8.215)
exp
(
−
E2
1∕4
2𝜎2
F
)
I0
(
rTE1
2𝜎2
F
)
= 1.
(8.216)

Performance Analysis
363
This equation is satisfied to a close approximation [1]
rT = E1
4
√
√
√
√1 +
8𝜎2
F
E2
1∕4
(8.217)
= E1
4
√
1 +
8Nhet
0
E1
,
(8.218)
where we have used Eq. (8.207) for 𝜎2
F. When a bit ‘0’ is transmitted, if r > rT, ‘0’ is mistaken as ‘1’ and this
probability is
P(1|0) = ∫
∞
rT
p(r|‘0’ sent)dr = 1
𝜎2
F ∫
∞
rT
r exp
(
−r2
2𝜎2
F
)
dr
(8.219)
= exp
(
−
r2
T
2𝜎2
F
)
≅exp
[
−𝛾het
4
(
1 +
4
𝛾het
)]
,
(8.220)
where we have used Eq. (8.218) for rT and
𝛾het = Eav
Nhet
0
.
(8.221)
For OOK, Eav = E1∕2, so
𝛾het =
E1
2Nhet
0
.
(8.222)
When 𝛾het ≫1,
P(1|0) ≅exp
(
−𝛾het
4
)
.
(8.223)
Similarly, the probability of mistaking ‘1’ as ‘0’ is
P(0|1) = ∫
rT
0
p(r|‘1’ sent)dr = 1
𝜎2
F ∫
rT
0
r exp
(
−
r2 + E2
1∕4
2𝜎2
F
)
I0
(
rE1
2𝜎2
F
)
dr.
(8.224)
Let
x = r
𝜎F
,
(8.225)
a = E1
2𝜎F
=
√
2𝛾het.
(8.226)
Now, Eq. (8.224) becomes
P(0|1) = ∫
rT∕𝜎F
0
x exp
(
−a2 + x2
2
)
I0(ax) dx
=
[
1 −Q1
(
a, rT
𝜎F
)]
,
(8.227)

364
Fiber Optic Communications
t = Tb
t = Tb
Heterodyne Rx
front end 
Comparator
r0(Tb)
r1(Tb)
If r1(Tb) > r0(Tb) 
select ‘1’
HI1 (ω)
HI0 (ω)
Envelope
detector
Envelope
detector
 I(t) = 2RALORe{[s(t) + nc(t)]e*i(ωIFt + ▵φ)} + nd
Figure 8.18
A heterodyne receiver with envelope detectors and matched filters for FSK.
where Q1(a, rT∕𝜎F) is the generalized Marcum Q-function defined as [6]
Q1(a, b) = ∫
∞
b
x exp
(
−a2 + x2
2
)
I0(ax) dx
= exp
(
−a2 + b2
2
) ∞
∑
k=0
(a
b
)k
Ik(ab),
b > a > 0.
(8.228)
Substituting Eqs. (8.226) and (8.217) in Eq (8.227), we obtain
P(0|1) =
⎡
⎢
⎢⎣
1 −Q1
⎛
⎜
⎜⎝
√
2𝛾het,
√
𝛾het
2
(
1 +
4
𝛾het
)⎞
⎟
⎟⎠
⎤
⎥
⎥⎦
.
(8.229)
Combining Eqs. (8.224) and (8.229), we find
Pb = 1
2[P(1|0) + P(0|1)]
= 1
2
{
exp
[
−𝛾het
4
(
1 +
4
𝛾het
)]
+ 1 −Q1
(√
2𝛾het,
√
𝛾het
2
(1 + 4∕𝛾het)
)}
.
(8.230)
8.4.5
FSK: Asynchronous Detection
The transmitted signals s1(t) and s0(t) are the same as those in Section 8.4.3 (Eq. (8.166)). The output of the
heterodyne receiver front end in the absence of noise may be written as
I(t) =
{
I1(t)
when s1(t) is transmitted
I0(t)
when s0(t) is transmitted,
(8.231)
where
I1(t) =
{
2RALOA cos
[(
𝜔IF + Δ𝜔
2
)
t + Δ𝜙
]
for 0 < t ≤Tb
0
otherwise,
(8.232)

Performance Analysis
365
I0(t) =
{
2RALOA cos
[(
𝜔IF −Δ𝜔
2
)
t + Δ𝜙
]
for 0 < t ≤Tb
0
otherwise.
(8.233)
As before, we ignore the scaling factor 2RALO. The matched filter HIj(𝜔) is matched to Ij(t), j = 0, 1 except
for the phase factor as in Section 8.4.4 (See Fig. 8.18). Suppose s1(t) is transmitted so that I(t) = I1(t). HIj(𝜔)
can be realized as correlators and their outputs in the absence of noise can be written as
I1F(t) = A2
∫
Tb
0
I1(𝜏) cos
[(
𝜔IF + Δ𝜔
2
)
(𝜏+ Tb −t)
]
d𝜏,
(8.234)
I0F(t) = A2
∫
Tb
0
I1(𝜏) cos
[(
𝜔IF −Δ𝜔
2
)
(𝜏+ Tb −t)
]
d𝜏.
(8.235)
Eq. (8.234) is similar to Eq. (8.188). Ignoring the frequency component centered around 2𝜔IF and simplifying
Eq. (8.234), we obtain
I1F(t) = E1
2 ,
(8.236)
where E1 = A2Tb. Similarly, from Eq. (8.235), we obtain
I0F(t) = A2
2 ∫
Tb
0
cos
[
Δ𝜔𝜏+
(
𝜔IF −Δ𝜔
2
)
(t −Tb) + Δ𝜙
]
d𝜏
= A2
2 ∫
Tb
0
[cos (Δ𝜔𝜏) cos 𝜃(t) −sin (Δ𝜔𝜏) sin 𝜃(t)] d𝜏
= A2
2
[
sin (Δ𝜔Tb
)
Δ𝜔
]
cos 𝜃(t) −
[
cos (Δ𝜔Tb
) −1
Δ𝜔
]
sin 𝜃(t),
(8.237)
where
𝜃(t) =
(
𝜔IF −Δ𝜔
2
)
(t −Tb) + Δ𝜙.
(8.238)
If
2𝜋ΔfTb = 2n𝜋,
n = 1, 2, … ,
Δf = n
Tb
,
(8.239)
from Eq. (8.237) we find that I0F(t) = 0. The signals are orthogonal for asynchronous detection if the output
of the filter HIj(𝜔) is zero when sk, k ≠j is transmitted. Comparing Eqs. (8.178) and (8.239), we find that
the minimum frequency difference to achieve orthogonality for asynchronous detection is twice that for syn-
chronous detection. In this section, we assume that Δf = 1∕Tb so that the output of the filter HI0(𝜔) is zero
(ignoring noise) when s1(t) is transmitted. In this case, the outputs of the envelope detectors can be written as
r1(Tb) =
√[E1
2 + n1FI(Tb)
]2
+ n2
1FQ(Tb),
(8.240)
r0(Tb) =
√
n2
0FI(Tb) + n2
0FQ(Tb),
(8.241)

366
Fiber Optic Communications
where njFI and njFQ are the in-phase and quadrature components of the noise output of the matched filter,
HIj(𝜔), respectively. The variance of njFI and njFQ, j = 1, 0 is given by Eq. (8.207)
𝜎2
F ≡𝜎2
jFI = 𝜎2
jFQ =
Nhet
0 E1
4
,
j = 0, 1.
(8.242)
The pdf of the envelope r0(Tb) when s1(t) is transmitted is given by the Rayleigh distribution
pr0(r0|‘1’ sent) = r0
𝜎2
F
exp
(
−
r2
0
2𝜎2
F
)
.
(8.243)
The pdf of the envelope r1(Tb) is given by the Rician distribution
pr1(r1|‘1’ sent) = r1
𝜎2
F
exp
(
−
r2 + E2
1∕4
2𝜎2
F
)
I0
(
rE1
2𝜎2
F
)
.
(8.244)
If r1(Tb) > r0(Tb), it will be decided that ‘1’ is transmitted. Therefore, an error is made if r1(Tb) < r0(Tb)
when s1(t) is transmitted. So, the probability of mistaking ‘1’ as ‘0’ is
P(0|‘1’ sent) = P(r1(Tb) < r0(Tb)|‘1’ sent).
(8.245)
The probability that r1(Tb) < r0(Tb) can be found as follows. Since r1(Tb) and r0(Tb) are independent random
variables, the joint pdf of r1(Tb) and r0(Tb) can be written as
pr1r0(r1, r0|‘1’ sent) = pr0(r0|‘1’ sent)pr1(r1|‘1’ sent).
(8.246)
The chance that r1(Tb) < r0(Tb) is the same as that r1(Tb) has a value r1 in the range 0 < r1 < ∞and r0(Tb)
has a value greater than r1,
P(r1(Tb) < r0(Tb)|‘1’ sent) = ∫
∞
r1
{
∫
∞
0
pr1r0
(r1, r0 |‘1’ sent) dr1
}
dr0.
(8.247)
Using Eqs. (8.243), (8.244), and (8.246), Eq. (8.247) can be simplified as
P(0|‘1’ sent) = ∫
∞
0
pr1(r1)
{
∫
∞
r1
pr0(r0)dr0
}
dr1
= ∫
∞
0
pr1(r1) exp
(
−
r2
1
2𝜎2
F
)
dr1
= 1
𝜎2
F ∫
∞
0
r1 exp
(
−
r2
1 + E2
1∕8
𝜎2
F
)
I0
(
r1E1
2𝜎2
F
)
dr1.
(8.248)
Let
r′
1 = r1
√
2,
(8.249)
E′
1 = E1∕
√
2.
(8.250)

Performance Analysis
367
Eq. (8.248) becomes
P(0|‘1’ sent) =
1
2𝜎2 exp
(
−
E2
1
16𝜎2
F
)
∫
∞
0
r′
1 exp
(
−
r
′2
1 + E
′2
1 ∕4
2𝜎2
F
)
I0
(
r′
1E′
1
2𝜎2
F
)
dr′
1
= 1
2 exp
(
−
E2
1
16𝜎2
F
)
∫
∞
0
pr1(r1|‘1’ sent)dr1
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
=1
= 1
2 exp
(
−𝛾het
4
)
.
(8.251)
Owing to the symmetry of the problem, P(1|‘0’ sent) is the same as P(0|‘1’ sent). Therefore,
Pb = P(0|‘1’ sent) = 1
2 exp
(
−𝛾het
4
)
.
(8.252)
8.4.6
Comparison of Modulation Schemes with Heterodyne Receiver
Fig. 8.19 shows the error probability as a function of 𝛾het for various modulation schemes with the heterodyne
receiver. First consider the synchronous detection. OOK requires 3 dB more 𝛾het (equivalently 3 dB more
power or 3 dB less noise) than PSK to reach the same BER. FSK outperforms OOK by roughly 0.85 dB. Next
consider the asynchronous detection. OOK performs slightly better than FSK. However, from the practical
*10
*5
0
5
10
15
20
10*10
10*8
10*6
10*4
10*2
100
γ het (dB)
Pb
OOK SYNC
OOK ASYNC
FSK SYNC
FSK ASYNC
PSK SYNC
Figure 8.19
Error probability in heterodyne receiver as a function of 𝛾het. SYNC = synchronous detection.
ASYNC =asynchronous detection.

368
Fiber Optic Communications
stand point, FSK is preferred over OOK since the optimum threshold of FSK is fixed, whereas the optimum
threshold of OOK depends on 𝛾het (see Eq. (8.217)). The performance with synchronous detection is always
better than that with asynchronous detection, but synchronous detection is more sensitive to laser phase noise.
8.5
Direct Detection
In a direct detection system, the photocurrent is directly proportional to the optical signal power. Hence, the
phase information of the optical field is lost. In other words, it is not possible to encode information on the
phase of the optical carrier (PSK) although it is possible to encode information as the phase change of a current
bit relative to the previous bit (DPSK). In this section, we analyze the performances of OOK, FSK, and DPSK.
8.5.1
OOK
Let s(t) and nc(t) be the complex field envelope of the transmitted signal and channel noise, respectively (See
Fig. 8.20). At the receiver, the signal passes through an optical filter with transfer function H(𝜔) that matches
the transmitted signal. As in the case of asynchronous detection for OOK, the matched filter need not be phase
synchronized with the received optical signal, but it can differ by an arbitrary phase factor 𝜙. Using Eq. (8.40)
and taking x0(t) = 0, we have
H(𝜔) = ̃x∗
1(𝜔) exp (i𝜔Tb + i𝜙)
= ̃s∗
1(𝜔−𝜔c) exp (i𝜔Tb + i𝜙).
(8.253)
Here, we have replaced x(t) of Section 8.2 by s(t)e−i𝜔ct. Let the optical filter output be
r(t) = [sF(t) + nF(t)]e−i𝜔ct,
(8.254)
with
sF(t)e−i𝜔ct = 1
2𝜋∫
∞
−∞
̃x(𝜔)H(𝜔) exp (−i𝜔t) d𝜔,
(8.255)
nF(t)e−i𝜔ct = 1
2𝜋∫
∞
−∞
̃nc(𝜔)H(𝜔) exp (−i𝜔t) d𝜔,
(8.256)
where sF(Tb) and nF(Tb) are the base-band signal and noise field envelopes, respectively. When a bit ‘1’ is
sent, ̃x(𝜔) = ̃s1(𝜔−𝜔c) and when a bit ‘0’ is sent, ̃x(𝜔) = 0. Using Eq. (8.253) in Eq. (8.255), we obtain
sF(Tb) = exp (i𝜔cTb + i𝜙)
2𝜋
∫
∞
−∞
|s1(𝜔−𝜔c)|2 d𝜔
= exp [i(𝜔cTb + 𝜙)]E1
when ‘1’ is sent
= 0
when ‘0’ is sent.
(8.257)
Threshold
device
t = Tb
Tx
x(t) =
s(t)e*iωct
H(ω)
PD
I(t)
If I(Tb) > IT
select ‘1’ 
I(Tb)
[s(t) + nc(t)]e*iωct
[sF(t) + nF(t)]e*iωct
+
+
∑
nc(t)e*iωct
Figure 8.20
Direct detection receiver for OOK.

Performance Analysis
369
The output of the matched filter passes through the photodetector and the signal component of the photocur-
rent is
Is(t) = R|sF(Tb)|2
= RE2
1
when ‘1’ is sent
= 0
otherwise.
(8.258)
The total current at the decision instant Tb is
I(Tb) = R|sF(Tb) + nF(Tb)|2
= R[(sFI(Tb) + nFI(Tb))2 + (sFQ(Tb) + nFQ(Tb))2],
(8.259)
where yI = Re[y] and yQ = Im[y], y = sF, nF. Without loss of generality, we can assume sF(Tb) to be real so
that sFQ(Tb) = 0 and sFI(Tb) = E1.
√
RnFI(Tb) and
√
RnFQ(Tb) are independent Gaussian random variables
with zero mean and variance,
𝜎2 = R < n2
FI >= R < n2
FQ >= R
2 < |nF|2 >
= R
4𝜋∫
∞
−∞
𝜌ASE|H(𝜔)|2d𝜔= 𝜌ASE
2
E1R.
(8.260)
When a bit ‘0’ is transmitted, sFI(Tb) = sFQ(Tb) = 0 and in this case the pdf of I is given by the central
chi-square distribution
p(I|‘0’ sent) ≡p0(I) =
1
2𝜎2 exp
(
−I
2𝜎2
)
.
(8.261)
When a bit ‘1’ is transmitted, the current in the absence of noise is RE2
1 and in this case the pdf is given by
the non-central chi-square distribution
p(I|‘1’ sent) ≡p1(I) =
1
2𝜎2 exp
(
−
RE2
1 + I
2𝜎2
)
I0
⎛
⎜
⎜
⎜⎝
√
IRE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
.
(8.262)
The threshold current is determined by the interSection of two curves p0(I) and p1(I):
p1(IT) = p0(IT)
(8.263)
or
exp
(
−
RE2
1
2𝜎2
)
I0
⎛
⎜
⎜
⎜⎝
√
ITRE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
= 1.
(8.264)
This equation is satisfied to a close approximation [1]
IT =
RE2
1
4
(
1 + 8𝜎2
RE2
1
)
=
RE2
1
4
(
1 + 4𝜌ASE
E1
)
.
(8.265)

370
Fiber Optic Communications
When a bit ‘0’ is transmitted, if I > IT, the bit ‘0’ is mistaken as the bit ‘1’ and this probability is
P(1|0) = ∫
∞
IT
p0(I)dI =
1
2𝜎2 ∫
∞
IT
exp
(
−I
2𝜎2
)
dI
= exp
(
−IT
2𝜎2
)
.
(8.266)
Using Eqs. (8.260) and (8.265), we obtain
P(1|0) = exp
[
−𝛾DD
2
(
1 +
2
𝛾DD ,
)]
(8.267)
where 𝛾DD is given by
𝛾DD = Eav
𝜌ASE
.
(8.268)
For OOK, Eav = E1∕2. So
𝛾DD =
E1
2𝜌ASE
,
(8.269)
When 𝛾DD ≫1, P(1|0) ≅exp (−𝛾DD∕2).
Similarly, the probability of mistaking bit ‘1’ as bit ‘0’ is
P(0|1) = ∫
IT
0
p1(I)dI
=
1
2𝜎2 ∫
IT
0
exp
(
−
RE2
1 + I
2𝜎2
)
I0
⎛
⎜
⎜
⎜⎝
√
IRE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
dI.
(8.270)
Changing the variable of integration from I to x, where
x2 = I
𝜎2 ,
(8.271)
and letting a2 = RE2
1∕𝜎2, Eq. (8.270) becomes
P(0|1) = ∫
√
IT∕𝜎
0
x exp
(
−a2 + x2
2
)
I0(ax) dx
= 1 −Q1
(
a,
√
IT
𝜎
)
(8.272)
where Q1(a,
√
IT∕𝜎) is the generalized Marcum’s Q-function given by Eq. (8.228). Using Eqs. (8.260),
(8.265), and (8.268), Eq. (8.272) can be rewritten as
P(0|1) = 1 −Q1
⎛
⎜
⎜⎝
2
√
𝛾DD,
√
𝛾DD
(
1 +
2
𝛾DD
)⎞
⎟
⎟⎠
(8.273)

Performance Analysis
371
Combining Eqs. (8.267) and (8.273), we obtain
Pb = 1
2[P(1|0) + P(0|1)]
= 1
2
⎧
⎪
⎨
⎪⎩
exp
[
−𝛾DD
2
(
1 +
2
𝛾DD
)]
+ 1 −Q1
⎛
⎜
⎜⎝
2
√
𝛾DD,
√
𝛾DD
(
1 +
2
𝛾DD
)⎞
⎟
⎟⎠
⎫
⎪
⎬
⎪⎭
.
(8.274)
Note that Eq. (8.274) is the same as Eq. (8.230) obtained for the case of a heterodyne receiver if we replace
𝛾het by 2𝛾DD. In this analysis, we have ignored the receiver noise mechanisms such as shot noise and thermal
noise and assumed that the optical filter is a matched filter. Without these approximations and assumptions,
the analysis is quite cumbersome. When the optical filter is not matched to the transmitted signal, analyti-
cal expressions can be obtained using the approaches in Refs. [7]–[9]. In a simplified approach, chi-square
distributions are approximated by Gaussian distributions and the BER can be estimated by calculating the
Q-factor as in Chapter 7. This Gaussian approximation gives reasonably accurate results for OOK, although
it is found to be inaccurate for DPSK signals with direct detection [7].
8.5.2
FSK
For FSK with direct detection, the transmitted signals s1(t) and s0(t) are the same as those in Section 8.4.3.
(Eq. (8.166)). Since the energies of signals s1(t) and s0(t) are equal, we use the matched filters shown in
Fig. 8.21 (similar to Fig. 8.7). The matched filters can be realized as a bank of band-pass filters. As before,
the matched filters need not be synchronized with the received signal, but can differ by a phase factor 𝜙. The
signal field uj(t) and noise field nFj(t) at the output of the matched filters are given by
uj(t) = 1
2𝜋∫
∞
−∞
̃x(𝜔)Hj(𝜔)e−i𝜔td𝜔, j = 0, 1,
(8.275)
nFj(t) = 1
2𝜋∫
∞
−∞
̃nc(𝜔)Hj(𝜔)e−i𝜔td𝜔, j = 0, 1.
(8.276)
Comparator
t = Tb
t = Tb
Tx
nc(t)e*iωct
H1(ω)
u1(t) + nF1(t)
u0(t) + nF0(t)
H0(ω)
If I1(Tb) > I0(Tb)
select ‘1’,
    
I0(Tb)
I1(Tb)
PD1
|∙|2
PD0
|∙|2
x(t) =
s(t)e*iωct
∑
+
+
otherwise,
select ‘0’.
Figure 8.21
Direct detection receiver for FSK.

372
Fiber Optic Communications
The transfer function of the matched filter is
Hj(𝜔) = x∗
j (𝜔)ei𝜙+i𝜔Tb, j = 0, 1
= ̃s∗
j (𝜔−𝜔c)ei𝜙+i𝜔Tb,
(8.277)
where 𝜙is an arbitrary phase factor. The output of the photodetector j at t = Tb is
Ij(Tb) = R[|uj(Tb) + nFj(Tb)|2],
j = 0, 1.
(8.278)
First let us consider the photodetector outputs in the absence of noise. Suppose a bit ‘1’ is transmitted so that
x(t) = x1(t). The output of PD1 is
I1(Tb) = R[|u1(Tb)|2].
(8.279)
From Eqs. (8.275) and (8.277), we have
u1(Tb) = ei𝜙
2𝜋∫
∞
−∞
|x1(𝜔)|2d𝜔= E1ei𝜙,
(8.280)
I1(Tb) = RE2
1.
(8.281)
For this case, the output of PD0 is
I0(Tb) = R|u0(Tb)|2
= R||||
1
2𝜋∫
∞
−∞
̃x1(𝜔)̃x∗
0(𝜔) d𝜔||||
2
.
(8.282)
Using Parseval’s relations,
1
2𝜋∫
∞
−∞
̃x1(𝜔)̃x∗
0(𝜔)d𝜔= ∫
∞
−∞
x1(t)x∗
0(t) dt,
(8.283)
Eq. (8.282) may be rewritten as
I0(Tb) = R
|||||∫
Tb
0
x1(t)x∗
0(t) dt
|||||
2
= R
|||||∫
Tb
0
s1(t)s∗
0(t) dt
|||||
2
= R
|||||∫
Tb
0
exp (−i2𝜋Δft) dt
|||||
2
= R
||||
exp (−i𝜋ΔfTb) sin (𝜋ΔfTb)
𝜋Δf
||||
2
= Rsin 2(𝜋ΔfTb)
𝜋2Δf 2
.
(8.284)

Performance Analysis
373
I0(Tb) is zero if
𝜋ΔfTb = n𝜋,
n = 1, 2, …
(8.285)
or
Δf = n
Tb
.
(8.286)
Comparing Eqs. (8.286) and (8.239), we find that the orthogonality conditions for the asynchronous receiver
and direct detection receiver are the same. In this section, we assume that the orthogonality condition is
satisfied so that the output of PD0 (PD1) is zero when bit ‘1’ (bit ‘0’) is transmitted in the absence of noise.
Since the photo-detector output is not sensitive to the phase factor 𝜙, we ignore it from now on.
Case (i): bit ‘1’ transmitted. Expanding Eq. (8.278), we obtain
I1(Tb) = R[u2
1(Tb) + 2u1(Tb)nF1r(Tb) + n2
F1r(Tb) + n2
F1i(Tb)]
= R{[E1 + nF1r(Tb)]2 + n2
F1i(Tb)},
(8.287)
I0(Tb) = R[n2
F0r(Tb) + n2
F0i(Tb)],
(8.288)
where we have used u1(Tb) = E1 and subscripts r and i denote the real and imaginary parts, respectively. Let
us first consider I1(Tb).
√
R[E1 + nF1r(Tb)] and
√
RnF1i are Gaussian random variables with means
√
RE1 and
zero, respectively. The variances of these two random variables are equal and given by
𝜎2 = R
2𝜋∫
∞
−∞
𝜌ASE
2
|H1(𝜔)|2d𝜔= R𝜌ASEE1
2
.
(8.289)
The pdf of I1(Tb) is given by the non-central chi-square distribution
p1(I1) =
1
2𝜎2 exp
[
−
(RE2
1 + I1
)
2𝜎2
]
I0
⎛
⎜
⎜
⎜⎝
√
I1RE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
.
(8.290)
The pdf of I0(Tb) is given by the central chi-square distribution
p1(I0) =
1
2𝜎2 exp
(
−I0
2𝜎2
)
.
(8.291)
If I1(Tb) > I0(Tb), it will be decided that the bit ‘1’ is transmitted. Therefore, an error is made if I1(Tb) < I0(Tb)
when s1(t) is transmitted:
P(0|‘1’ sent) = P(I0(Tb) > I1(Tb)|‘1’ sent).
(8.292)
The chance that I1(Tb) < I0(Tb) can be found as follows. Since I1(Tb) and I0(Tb) are independent random
variables, the joint pdf of I1 and I0 can be written as
p1(I1, I0) = p1(I1)p1(I0).
(8.293)
The chance that I1(Tb) < I0(Tb) is the same as that I1(Tb) has a value i1 and I0(Tb) has a value i0 greater than
i1. Since I1(Tb) can take any value in the range (0, ∞), we have
P(I0(Tb) > I1(Tb)|‘1’ sent) = ∫
∞
i1
{
∫
∞
0
p1
(i1, i0
) di1
}
di0.
(8.294)

374
Fiber Optic Communications
Using Eqs. (8.290), (8.291), and (8.293), we obtain
P(0|1) = ∫
∞
0
p1(i1)di1 ∫
∞
i1
p1(i0)di0
=
1
(2𝜎2)2 ∫
∞
0
exp
[
−
RE2
1 + i1
2𝜎2
]
I0
⎛
⎜
⎜
⎜⎝
√
i1RE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
di1 ∫
∞
i1
exp
(
−i0
2𝜎2
)
di0
=
1
2𝜎2 ∫
∞
0
exp
[
−
RE2
1 + 2i1
2𝜎2
]
I0
⎛
⎜
⎜
⎜⎝
√
i1RE2
1
𝜎2
⎞
⎟
⎟
⎟⎠
di1.
(8.295)
Let i′
1 = 2i1 and x = RE2
1∕2. Now, Eq. (8.295) becomes
P(0|1) =
1
4𝜎2 ∫
∞
0
exp
[
−
2x + i′
1
2𝜎2
]
I0
⎛
⎜
⎜
⎜⎝
√
i′
1x
𝜎2
⎞
⎟
⎟
⎟⎠
di′
1
=
1
4𝜎2 e
−
x
2𝜎2
∫
∞
0
exp
[
−
x + i′
1
2𝜎2
]
I0
⎛
⎜
⎜
⎜⎝
√
i′
1x
𝜎2
⎞
⎟
⎟
⎟⎠
di′
1
= 1
2e
−
x
2𝜎2
∫
∞
0
p1(i1)di1
= 1
2 exp
(
−
E1
2𝜌ASE
)
.
(8.296)
For FSK, E1 = E0 = Eav. Using Eq. (8.268), Eq. (8.296) may be rewritten as
P(0|1) = 1
2 exp
(
−𝛾DD
2
)
.
(8.297)
Case (ii): bit ‘0’ transmitted. Owing to the symmetry of the problem, P(0|1) is same as P(1|0). The error
probability is
Pb = 1
2[P(0|1) + P(1|0)] = 1
2 exp
(
−𝛾DD
2
)
(8.298)
Note that this error probability is the same as that given by Eq. (8.251) for asynchronous detection if we
replace 𝛾het by 2𝛾DD. If we ignore shot noise, we see that two expressions are identical.
8.5.3
DPSK
In the case of PSK, the information is transmitted as the absolute phase of the complex field envelope s(t).
But in the case of DPSK, the information is transmitted as the phase of the field envelope relative to the
previous bit. To estimate the absolute phase of the transmitted PSK signal, a reference is required at the
receiver. This reference is provided by the local oscillator whose phase should be synchronized with that of

Performance Analysis
375
the optical carrier (or it should be post-corrected using the DSP). In contrast, for systems based on DPSK, the
transmitted signal of the previous bit interval acts as a reference and, therefore, there is no need for the local
oscillator and the phase synchronization. However, one of the drawbacks is that the phase of the previous bit
is noisy and, therefore, this leads to performance degradation for DPSK compared with PSK.
Let s1(t) and s0(t) be the optical field envelopes of duration ≤Tb with s0(t) = −s1(t). We assume that s(t) is
real. To send a bit ‘1’, the pulse in the current bit slot is the same as that in the previous bit slot and to send
bit ‘0’, the pulse in the current bit slot has a phase of ±𝜋radians relative to the previous bit slot. Using s1(t)
and s0(t), let us construct orthogonal signals over the period 2Tb:
s′
1(t) = s1(t) + s1(t −Tb)
set I
or
s′
1(t) = s0(t) + s0(t −Tb)
set II
⎫
⎪
⎬
⎪⎭
to send bit ‘1’;
(8.299)
s′
0(t) = s1(t) + s0(t −Tb)
set I
or
s′
0(t) = s0(t) + s1(t −Tb)
set II
⎫
⎪
⎬
⎪⎭
to send bit ‘0’.
(8.300)
Since s0(t) = −s1(t), the signals corresponding to set I are negative of the signals corresponding to set II and
we could use either of these sets. Figs. 8.22 and 8.23 show the signals sj(t) and s
′
j(t), j = 0, 1, using Gaussian
pulses. From Fig. 8.23, we see that s′
0(t) is antisymmetric with respect to the point Tb while s′
1(t) is symmetric;
therefore, they are orthogonal over a period of 2Tb:
|||||∫
2Tb
0
s′
1(t)s′
0(t)dt
|||||
2
= 0.
(8.301)
In the case of direct detection of orthogonal FSK, we have seen that the optical receiver consists of matched
filters, square-law detectors (i.e., photodetectors), and a comparator. The results of direct detection orthogonal
FSK are applicable for DPSK signals as well, since the signals s′
1(t) and s′
0(t) are orthogonal. Therefore, the
schematic of the optical receiver is the same as that of the direct detection FSK if we use the signals s′
1(t) and
Tb
0
0
Tb
s1(t)
s0(t)
t
t
Figure 8.22
Optical complex field envelopes s1(t) and s0(t).

376
Fiber Optic Communications
2Tb
2Tb
0
Tb
2Tb
Tb
2Tb
Tb
Tb
set I
set II
s'1(t)
s'0(t)
s'0(t)
s'1(t)
s1(t)
s1(t)
s1(t * Tb)
s0(t * Tb)
t
t
0
0
t
t
0
Figure 8.23
Orthogonal signals s′
1(t) and s′
0(t) constructed using s1(t) and s0(t).
s′
0(t), and this is shown in Fig. 8.24. H′
1(𝜔) and H′
0(𝜔) are the filters matched to s′
1(t) and s′
0(t), except that
they can have an arbitrary constant phase shift:
H′
j(𝜔) = s′
j
∗(𝜔−𝜔c) exp (i𝜔Tb + i𝜙),
j = 0, 1.
(8.302)
Taking the Fourier transform of Eq. (8.299) (set I) and using the shifting property of the Fourier transform,
H′
1(𝜔) = [s∗
1(𝜔−𝜔c) + s∗
1(𝜔−𝜔c) exp (i𝜔Tb)] exp (i𝜔Tb + i𝜙)
= H1(𝜔)[1 + exp (i𝜔Tb)],
(8.303)
where H1(𝜔) is the filter matched to s1(t)e−i𝜔ct except for the phase factor 𝜙(see Eq. (8.277)). Fig. 8.25 shows
the realization of H′
1(𝜔) using a delay-and-add filter. The second term of Eq. (8.303) corresponds to the delay
by Tb. Similarly,
H′
0(𝜔) = [s∗
1(𝜔−𝜔c) + s∗
0(𝜔−𝜔c) exp (i𝜔Tb)] exp (i𝜔Tb + i𝜙)
= H1(𝜔)[1 −exp (i𝜔Tb)].
(8.304)

Performance Analysis
377
Comparator
Tx
nc(t)e*iωct
s'(t)e*iωct
H'
1(ω)
H'
0(ω)
PD1
|∙|2
PD0
|∙|2
t = Tb
t = Tb
I0(Tb)
I1(Tb)
If I1(Tb) > I0(Tb)
select ‘1’
    
∑
+
+
otherwise,
select ‘0’
Figure 8.24
Direct detection receiver for DPSK.
Delay
Tb
H'1(ω)
H1(ω)
∑
Figure 8.25
The filter matched to s′
1(t).
*
H'0(ω)
H1(ω)
Delay
Tb
∑
+
Figure 8.26
The filter matched to s′
0(t).
Fig. 8.26 shows the realization of H′
0(𝜔) using a delay-and-subtract filter. Therefore, the schematic shown in
Fig. 8.24 can be redrawn with signal s(t) instead of s′(t), as shown in Fig. 8.27.
The energy of the signal s′
1(t) is
E′
1 = ∫
2Tb
0
|s1(t) + s1(t −Tb)|2dt
= ∫
Tb
0
|s1(t)|2dt + ∫
2Tb
Tb
|s1(t −Tb)|2dt + 2 ∫
2Tb
0
s1(t)s1(t −Tb) dt.
(8.305)
Since s1(t) is a pulse that is zero outside the interval [0, Tb], the last term in Eq. (8.305) vanishes and,
therefore, we obtain
E′
1 = 2E1,
(8.306)
where E1 is the energy of the signal s1(t). A similar calculation shows that E′
0 = 2E1. Since the energies of
the signals s′
1(t) and s′
0(t) are equal and they are orthogonal, the analytical expression derived for the case of

378
Fiber Optic Communications
Channel
PD1
|∙|2
PD2
|∙|2
Comparator
n(t)
H1(ω)
s(t)
Tb
I1
I0
Select bit ‘1’ if I1 > I0
Select bit ‘0’ if I1 < I0
+
*
+
+
∑
∑
Figure 8.27
DPSK receiver.
the FSK with direct detection or asynchronous detection is applicable in this case except that the energy E1
appearing in Eq. (8.297) should be replaced by 2E1 (= 2Eav), where Eav is the average energy of s(t):
Pb = 1
2 exp
(
−Eav
𝜌ASE
)
= 1
2 exp (−𝛾DD).
(8.307)
Comparing Eqs. (8.307) and (8.298), we see that the direct detection orthogonal FSK requires 3 dB more
power than DPSK to reach the same BER.
Example 8.3
50% duty cycle rectangular RZ pulses are used in a direct detection long-haul 40-Gb/s DPSK system operating
at 1550 nm. The peak transmitter power is 3 dBm. The fiber-optic link consists of N spans of 80-km standard
SMF with a loss of 0.2 dB/km followed by an optical amplifier with nsp = 1 and gain G being equal to the
fiber loss. Find the maximum transmission distance so that the error probability is <= 10−5. Ignore receiver
noise.
Solution:
For 50% duty RZ pulses, we have
average power = peak power
2
,
(8.308)
average power (dBm) = peak power (dBm) + 10 log 10(1∕2)
= 3 dBm −3 dB
= 0 dBm,
(8.309)
average power = 100∕10 mW = 1 mW,
(8.310)
average energy of a pulse = Eav = average power × bit interval.
(8.311)
Bit interval,
Tb =
1
40 × 109 s = 25
ps,
(8.312)
Eav = 1 mW × 25 ps = 2.5 × 10−14 J.
(8.313)
Operating frequency,
f =
3 × 108
1550 × 10−9 = 193.54 THz,
(8.314)

Performance Analysis
379
fiber loss per span = 0.2 dB/km × 80 km
= 16 dB.
(8.315)
Amplifier gain,
G(dB) = 16 dB,
(8.316)
G = 1016∕10 = 39.81.
(8.317)
PSD per amplifier,
𝜌ASE,1 = nsphf(G −1)
= 6.626 × 10−34 × 193.54 × 1012 × (39.81 −1)
= 7.465 × 10−18 J.
(8.318)
Total PSD due to all amplifiers,
𝜌tot
ASE = N𝜌ASE,1.
(8.319)
From Eq. (8.307), we have
Pb = 1
2 exp
(
−Eav
𝜌tot
ASE
)
,
(8.320)
Eav = −ln(2Pb)𝜌tot
ASE,
(8.321)
N = −
Eav
ln(2Pb)𝜌ASE,1
= −
2.5 × 10−14
ln(2 × 10−5) × 7.465 × 10−18
≅309.
(8.322)
Maximum achievable transmission distance so that Pb <= 10−5,
Lmax = 309 × 80 km
= 24, 720 km.
(8.323)
8.5.4
Comparison of Modulation Schemes with Direct Detection
Fig. 8.28 shows the performance of OOK, FSK, and DPSK in a direct detection system. The performance of
OOK and FSK is roughly similar, and DPSK has a 3-dB advantage over FSK. To compare the performance
of DPSK and PSK, let us ignore the shot noise. In this case
Nhomo
0
= 𝜌ASE
(8.324)
and
𝛾homo = 𝛾DD ≡𝛾.
(8.325)

380
Fiber Optic Communications
*10
*5
0
5
10
15
20
10*15
10*10
10*5
100
10*20
γdd (dB)
Pb
DPSK
OOK
FSK
Figure 8.28
Error probability of various modulation formats in a direct detection system.
From Eq. (8.96), we have
PPSK
b
= 1
2erfc(
√
𝛾).
(8.326)
When 𝛾>> 1,
PPSK
b
≅exp (−𝛾)
2√𝜋𝛾
.
(8.327)
From Eq. (8.307), we have
PDPSK
b
= 1
2 exp (−𝛾).
(8.328)
DPSK
PSK
10*15
10*10
10*5
100
Pb
*10
*5
0
5
10
15
γdd (dB)
Figure 8.29
Comparison of the performances of homodyne PSK and direct detection DPSK.

Performance Analysis
381
Comparing Eqs. (8.327) and (8.328), we find that PSK and DPSK have a similar exponential dependence on
𝛾when 𝛾is large. Fig. 8.29 shows the performance of PSK with homodyne receiver and DPSK with direct
detection receiver. To reach a BER of 10−3, the DPSK requires roughly 1.2 dB more power than the PSK
when the noise power is kept constant. However, to reach a BER of 10−9, the DPSK requires only 0.5 dB
more power than the PSK.
8.6
Additional Examples
Example 8.4
An optical signal passes through the single-mode fiber with dispersion coefficient 𝛽2 and length L. The trans-
mitted field envelope is
xtr(t) =
⎧
⎪
⎨
⎪⎩
±A exp
[
−(t−TB∕2)2
2T2
0
]
for
0 < t < TB
0
otherwise.
(8.329)
Find the filter matched to the received signal. Ignore 𝛽1 and 𝛽3. Assume T0 << TB.
Solution:
Since T0 ≪Tb, we approximate that the signal is Gaussian in the range [−∞, ∞] since T0 << TB:
xtr(t) = si(t −TB∕2).,
(8.330)
si(t) = ±A exp
(
−t2
2T2
0
)
(8.331)
From Eq. (2.153), the Fourier transform of the signal s0(t) after the fiber transmission is
̃s0(𝜔) = ̃si(𝜔)Hf (𝜔, L)
= ±A
a exp
(
−𝜔2
4𝜋b2
)
,
(8.332)
1
b2 = 1
a2 −i2𝜋𝛽2L
(8.333)
a =
1
√
2𝜋
T0.
(8.334)
The received signal is
xo(t) = so(t −TB∕2),
(8.335)
xo(𝜔) = ̃so(𝜔)ei𝜔Tb∕2.
(8.336)
Let the received signal corresponding to bit ‘1’ and bit ‘0’ be xo,1(t) and xo,0(t), respectively:
̃xo,1(𝜔) = −̃xo,0(𝜔) = A
a exp
[
−𝜔2
4𝜋b2 + i𝜔Tb
2
]
.
(8.337)

382
Fiber Optic Communications
TX
RX
Matched filter
DCF
TF
xi(t)
BPF
Figure 8.30
The filter matched to the received signal after the dispersive fiber channel. Tx = transmitter, TF =
transmission fiber, DCF = dispersion compensation fiber.
The filter matched to the received signal is
H(𝜔) = [̃x∗
o,1(𝜔) −̃x∗
o,0(𝜔)] exp (i𝜔Tb)
= 2A
a exp
[
−
𝜔2
4𝜋(b2)∗+ i𝜔Tb
2
]
= 2A
a exp
[
−𝜔2
4𝜋a2
]
⏟⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏟
band-pass filter
exp
[
−i𝜔2𝛽2L
2
]
⏟⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏟
dispersion
compensation
fiber
exp
[i𝜔Tb
2
]
.
(8.338)
As shown in Fig. 8.30, the matched filter can be realized by cascading a first-order Gaussian filter with a
dispersion compensating fiber or fiber Bragg grating whose accumulated dispersion is equal in magnitude to
that of the transmission fiber, but of opposite sign. The last term in Eq. (8.338) corresponds to a delay of Tb∕2,
which implies that the decision should be made at t = Tb∕2 (instead of at t = Tb).
Example 8.5
Show that the PSD of noise in a balanced heterodyne receiver is
𝜌nhet = 𝜌ASE
4
+
𝜌shot,eff
4R2A2
LO
.
(8.339)
Solution:
Let
nhet = nASE(t) + nd(t)∕2RALO,
(8.340)
nASE = ncI cos (𝜔IFt) + ncQ sin (𝜔IFt).
(8.341)
The PSD of ncI (or ncQ) is 𝜌ASE∕2. Let us consider impact of multiplication by cos (𝜔IFt) (or sin (𝜔IFt)). Let
n1(t) = ncI(t) cos (𝜔IFt),
(8.342)
̃n1(𝜔) = ̃ncI(𝜔+ 𝜔IF) + ̃ncI(𝜔−𝜔IF)
2
,
(8.343)

Performance Analysis
383
⟨|̃n1(𝜔)|2⟩= 1
4{⟨|̃ncI(𝜔+ 𝜔IF)|2⟩+ ⟨|̃ncI(𝜔−𝜔IF)|2⟩
+⟨̃ncI(𝜔+ 𝜔IF)̃n∗
cI(𝜔−𝜔IF) + c.c.⟩}.
(8.344)
Typically, an optical filter of bandwidth Bo is introduced before the photodetectors. Bo is greater than the signal
bandwidth, but much smaller than 𝜔IF∕2𝜋. In this case, ncI(t) and ncQ(t) are band-limited to Bo∕2 and the
spectra due to ̃ncI(𝜔+ 𝜔IF) and ̃ncI(𝜔−𝜔IF) do not overlap. Hence, the last two terms on the right-hand side
of Eq. (8.344) are zero. Since the PSD of n1(t) is proportional to ⟨|̃n1(𝜔)|2⟩, from Eq. (8.344) and Fig. 8.31(b),
we find
𝜌n1(f) = 𝜌ASE
8
for
|f −fIF| < Bo∕2
= 𝜌ASE
8
for
|f + fIF| < Bo∕2
= 0
elsewhere.
(8.345)
Let
n2(t) = ncQ sin (𝜔IFt + Δ𝜙).
(8.346)
Proceeding as before, we find
𝜌n2(f) = 𝜌ASE
8
for
|f −fIF| < Bo∕2
= 𝜌ASE
8
for
|f + fIF| < Bo∕2
= 0
elsewhere.
(8.347)
f
Bo
(a)
f
(b)
f IF
Bo
Bo
* f IF
ρncI ( f * f IF)/4
ρncI ( f + f IF)/4
ρncI
ρn1
ρASE/2
ρASE/8
Figure 8.31
ASE PSD: (a) base band; (b) after multiplication by cos(𝜔IFt).

384
Fiber Optic Communications
From Eq. (8.341),
nASE = n1 + n2,
(8.348)
𝜌nASE = 𝜌ASE
4
for
|f −fIF| < Bo∕2
= 𝜌ASE
4
for
|f + fIF| < Bo∕2
= 0
otherwise,
(8.349)
where we have used the fact that n1 and n2 are statistically independent random processes. Since the signal
spectrum is centered around fIF extending from fIF −Bo∕2 to fIF + Bo∕2, nASE may be approximated as a
white noise process over the band of interest,
𝜌nASE = 𝜌ASE
4
.
(8.350)
The PSD of nd(t)∕2RALO is
𝜌nd
4R2ALO
=
𝜌shot,eff
4R2A2
LO
.
(8.351)
Combining Eqs. (8.350) and (8.351), we find the PSD of nhet(t) is
𝜌nhet =
Nhet
0
2
= 𝜌ASE
4
+
𝜌shot,eff
4R2A2
LO
.
(8.352)
Example 8.6
To reach an error probability of 10−9, find the mean number of signal photons required in a shot noise-limited
coherent communication system based on OOK for the following cases: (i) balanced homodyne receiver; (ii)
balanced heterodyne receiver. Assume quantum efficiency, 𝜂= 1.
Solution:
(i) Let us first consider the case of the homodyne receiver with OOK. From Eq. (8.113), we have
Pb = 1
2erfc
(√
Eav
2Nhomo
0
)
.
(8.353)
For a shot noise-limited system, the PSD of ASE can be ignored. From Eq. (8.86), we have
Nhomo
0
= q
2R = hf
2𝜂.
(8.354)
The mean number of signal photons is
Ns = Eav
hf
.
(8.355)

Performance Analysis
385
Substituting Eqs. (8.354) and (8.355) in Eq. (8.353), we find
Pb = 1
2erfc(
√
𝜂Ns)
= 10−9.
(8.356)
When 𝜂= 1,
√
Ns = erfc−1(2 × 10−9)
= 4.2411
(8.357)
Ns ≅18.
(8.358)
(ii) From Eq. (8.144), we have
Pb = 1
2erfc
(√
Eav
4Nhet
0
)
.
(8.359)
From Eq. (8.123), we find
Nhet
0
= hf
2𝜂.
(8.360)
Substituting Eqs. (8.360) and (8.355) in Eq. (8.359), we obtain
Pb = 1
2erfc(
√
𝜂Ns∕2) = 10−9
(8.361)
√
Ns = erfc−1(2 × 10−9)
√
2
(8.362)
Ns ≅36.
(8.363)
Example 8.7
Show that the error probability in a fiber-optic system based on PSK that uses a heterodyne receiver with
synchronous demodulator and a filter matched to the transmitted signal s(t) (see Fig. 8.14) is given by
Pb = 1
2erfc
(√
Eav
2Nhet
0
)
.
(8.364)
Solution:
Let the signal output of the synchronous demodulator be
x(t) = s(t)cos2 (𝜔IFt + Δ𝜙)
= s(t)
2 [1 + cos (2𝜔IFt + 2Δ𝜙)].
(8.365)

386
Fiber Optic Communications
Since the filter is not matched to x(t), Eq. (8.35) can not be used to find 𝑣max. Instead, we use Eqs. (8.27) and
(8.28) to calculate Pb. The Fourier transform of Eq. (8.365) is
̃x(𝜔) = ̃s(𝜔)
2
+ ̃s(𝜔−2𝜔IF)e−i2Δ𝜙
4
+ ̃s(𝜔+ 2𝜔IF)ei2Δ𝜙
4
.
(8.366)
The transfer function of the filter matched to s(t) is
Hs(𝜔) = [̃s∗
1(𝜔) −̃s∗
0(𝜔)] exp (i𝜔Tb)
= 2̃s∗
1(𝜔) exp (i𝜔Tb).
(8.367)
Substituting Eqs. (8.366) and (8.367) into Eq. (8.6), we find
u1(Tb) = 1
2𝜋∫
∞
−∞
̃s1(𝜔)
2
⋅2̃s∗
1(𝜔)d𝜔,
(8.368)
where we have ignored the overlap between the frequency components at 𝜔± 2𝜔IF and 𝜔since the bandwidth
of s(t) is assumed to be much smaller than 𝜔IF. From Parseval’s relations, it follows that
u1(Tb) = E1 = −u0(Tb).
(8.369)
Next, let us consider the noise propagation. Let the noise before the demodulator be
nhet(t) = nASE(t) + nd(t),
(8.370)
nASE = ncI cos 𝜃+ ncQ sin 𝜃,
(8.371)
nd = ndI cos 𝜃+ ndQ sin 𝜃,
(8.372)
𝜃= 𝜔IFt + Δ𝜙,
(8.373)
nhet(t) = nhet,I cos 𝜃+ nhet,Q sin 𝜃,
(8.374)
nhet,I(t) = ncI + ndI,
(8.375)
nhet,Q(t) = ncQ + n dQ.
(8.376)
After the synchronous demodulator, the noise is
n(t) = nhet(t) cos 𝜃
= nhet,I(t)cos 2𝜃+ nhet,Q(t) sin 𝜃cos 𝜃
=
nhet,I(t)
2
+
nhet,I(t) cos 2𝜃+ nhet,Q sin 2𝜃
2
,
(8.377)
̃n(𝜔) =
̃nhet,I(𝜔)
2
+ terms at 2𝜔IF.
(8.378)
The components of ̃n(𝜔) around 2𝜔IF are removed by the low-pass filter, Hs(𝜔) placed just before the decision.
Hence, we ignore these terms and obtain
⟨|̃n(𝜔)|2⟩=
⟨|̃nhet,I(𝜔)|2⟩
4
(8.379)

Performance Analysis
387
or
𝜌n(𝜔) =
𝜌nhet,I(𝜔)
4
.
(8.380)
Since
𝜌nhet,I(𝜔) = 2𝜌nhet = Nhet
0
(8.381)
then
𝜌n(𝜔) =
Nhet
0
4 .
(8.382)
Using Eq. (8.7 ), the variance of noise after the filter is
𝜎2 =
Nhet
0
4
1
2𝜋∫
∞
−∞
|Hs(𝜔)|2 d𝜔.
(8.383)
Using Eq. (8.367) in Eq. (8.383), we obtain
𝜎2 = Nhet
0 E1.
(8.384)
Using Eqs. (8.369) and (8.384) in Eqs. (8.28) and (8.27), we find
𝑣=
4E2
1
Nhet
0 E1
= 4E1
Nhet
0
,
(8.385)
Pb = 1
2erfc
(√
Eav
2Nhet
0
)
.
(8.386)
Exercises
8.1
The transmitted signal is
x(t) = A rect
(t −TB∕2
TB
)
,
(8.387)
where
rect(x) = 1 if |x| < 1∕2
= 0 Otherwise
(8.388)
Show that the filter matched to the transmitted signal is an integrator with the limits of integration
from 0 to TB (integrate-and-dump filter).
8.2
Explain the meaning of a matched filter.
8.3
In a 25-Gb/s homodyne fiber-optic system operating at 1530 nm, the PSD of the ASE at the receiver
𝜌ASE is 7.78 × 10−16 W/Hz. Find the average signal power required at the receiver to reach the BER

388
Fiber Optic Communications
of 10−9 if the signal is (a) PSK, (b) OOK. Assume that quantum efficiency 𝜂is 0.9 and rectangular
NRZ pulses are used to transmit the data. Ignore thermal noise.
(Ans: (a) −4.55 dBm; (b) −1.55 dBm.)
8.4
Explain the difference between synchronous and asynchronous detection.
8.5
Show that the BER of DPSK with a heterodyne receiver and asynchronous detection is
Pb = 1
2 exp
(−𝛾het
2
)
.
(8.389)
8.6
Write a computer program to estimate the BER of the following modulation schemes with a hetero-
dyne receiver and asynchronous detection: (a) OOK, (b) FSK, (c) DPSK.
8.7
Ns and Nn are the mean number of signal photons and noise photons at the receiver of the unrepeatered
fiber-optic system with a preamplifier. The spontaneous noise factor and gain of the preamplifier are
nsp and G, respectively and Nn = nsp(G −1). Show that the error probabilities of FSK and DPSK are
given by
PFSK
b
= exp
(−Ns
2Nn
)
,
(8.390)
PDPSK
b
= exp
(−Ns
Nn
)
,
(8.391)
respectively. Ignore shot noise and thermal noise.
8.8
Rectangular NRZ pulses are used in a direct detection 25-Gb/s DPSK system operating at 1540 nm.
The average optical power at the receiver is 0 dBm. The fiber-optic link consists of 20 spans of identi-
cal fibers followed by amplifiers which exactly compensate the loss of fibers preceding. Each amplifier
introduces ASE whose PSD is 𝜌(1)
ASE. It is desirable that the BER <= 2.1 × 10−3. Find the upper limit
on 𝜌(1)
ASE.
(Ans: 3.654 × 10−16 W/Hz.)
References
[1] B.P. Lathi, Modern Digital and Analog Communication Systems, 3rd edn. Oxford University Press, New York, 1998.
[2] S. Haykin, Communication Systems, 4th edn. John Wiley & Sons, New York, 2001.
[3] S. Betti, G. De Marchis, and E. Iannone, Coherent Optical Communication Systems. John Wiley & Sons, New York,
1995.
[4] K.P. Ho, Phase-modulated Optical Communication Systems. Springer-Verlag, Berlin, 2005.
[5] G.P. Agrawal, Fiber-optic Communication Systems, 4th edn. John Wiley, & Sons, Hoboken, NJ, 2010.
[6] J.G. Proakis, Digital Communications, 4th edn. McGraw-Hill, New York, 2001, chapter 2.
[7] P.A. Humblet and M. Azizoglu, J. Lightwave Technol., vol. 9, p. 1576, 1991.
[8] D. Marcuse, J. Lightwave Technol., vol. 8, p. 1816 1990.
[9] D. Marcuse, J. Lightwave Technol., vol. 9, p. 505 1991.

9
Channel Multiplexing Techniques
9.1
Introduction
Typically, the single-channel symbol rates range from 10 Gsym/s to 40 Gsym/s. A symbol rate beyond
40 Gsym/s is hard to achieve in practice because of the speed of electronic components in transmitter
and receiver circuits. In the low-loss region of the fiber (1530–1620 nm), it has a bandwidth greater than
10 THz. To utilize the full bandwidth of the fiber, several channels can be multiplexed and they can share
the same fiber channel. An EDFA operating in C-band (1530–1565 nm) has a bandwidth of about 4.3 THz
and, therefore, several channels can be amplified simultaneously by a single amplifier. The multiplexing
techniques can be divided into three types: (i) polarization division multiplexing (PDM) or polariza-
tion multiplexing (PM), (ii) frequency or wavelength-division multiplexing (WDM), (iii) time-division
multiplexing (TDM).
9.2
Polarization-Division Multiplexing
PDM is an effective technique to double the capacity. Commercial coherent systems make use of PDM and
WDM to enhance the capacity. A single-mode fiber supports two polarization modes–one with the electric
field aligned with the x-axis and the other aligned with the y-axis (see Section 2.7.5). Therefore, it is possible
to transmit information using each of these polarization modes. A schematic of the PDM or PM is shown in
Fig. 9.1. At the transmitter, a polarization beam splitter is used to split the x- and y-polarization components
of the laser source. The x- (y-)polarization component of the laser is modulated by the electrical data mx (my)
using an optical modulator Mod x (Mod y). If the modulators are operating in the linear region, their outputs
are (see Section 4.6.2.2)
𝚿x = xAcmx(t)e−i2𝜋fct,
(9.1)
𝚿y = yAcmy(t)e−i2𝜋fct,
(9.2)
where fc is the laser frequency. The polarization beam combiner (PBC) combines these polarization compo-
nents. The output of the PBC is
𝚿= 𝚿x + 𝚿y = Ace−i2𝜋fct[mx(t)x + my(t)y].
(9.3)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

390
Fiber Optic Communications
electrical data,
mx
electrical data,
my
x
Mod x
Mod y
PBC
PC
PBS
Fiber
channel
Laser
y
ψy
ψx
ψ
Figure 9.1
Polarization-division multiplexing. PC = polarization controller, PBS = polariaztion beam splitter, PBC =
polarization beam combiner, Mod = optical modulator.
PBS
Recieved signal
IQ Rx1
IQ Rx2
ESP
mx
Ix,I
Ix,Q
Iy,Q
Iy,I
my
x
y
Figure 9.2
Block diagram of the polarization demultiplexing receiver. ESP = electrical signal processing.
These polarization components propagate as two polarization modes in a single-mode fiber. At the receiver,
two IQ receivers are used to detect the x- and y-polarization components as shown in Fig. 9.2 (see
Section 5.6.5). Let the complex currents corresponding to x- and y-polarization components be
Ix(t) = Ix,I(t) + iIx,Q(t),
(9.4)
Iy(t) = Iy,I(t) + iIy,Q(t).
(9.5)
Note that the x- and y-axes at the receiver may not be the same as those at the transmitter and, in addition,
there is a coupling between the polarization modes during the fiber propagation due to random fluctuations
in the refractive index. So, in the absence of noise, the complex currents in the frequency domain may be
written as
̃Ix(𝜔) = ̃mx(𝜔) ̃Mxx(𝜔) + ̃Mxy(𝜔)̃my(𝜔),
(9.6)
̃Iy(𝜔) = ̃mx(𝜔) ̃Myx(𝜔) + ̃Myy(𝜔)̃my(𝜔)
(9.7)
or
̃I = ̃M̃m,
(9.8)
̃I =
[̃Ix
̃Iy
]
,
(9.9)

Channel Multiplexing Techniques
391
̃M =
[ ̃Mxx(𝜔) ̃Mxy(𝜔)
̃Myx(𝜔) ̃Myy(𝜔)
]
,
(9.10)
̃m =
[̃mx(𝜔)
̃my(𝜔)
]
.
(9.11)
Multiplying Eq. (9.8) by ̃M−1 on both sides, we find
̃m = ̃M−1̃I.
(9.12)
The digital signal processing of the coherent receiver can be used to compute ̃M−1 (see Chapter 11) and, thus,
the message signal vector ̃m can be retrieved.
9.3
Wavelength-Division Multiplexing
In a WDM system, multiple optical carriers of different wavelengths are modulated by independent elec-
trical data. Since wavelength 𝜆and frequency f are related by 𝜆= c∕f, WDM may also be considered as
frequency-division multiplexing (FDM). Fig. 9.3 shows the schematic of a WDM system. A CW laser oper-
ating at 𝜆j, j = 1, 2, … , N is modulated by electrical data j. The modulated signals are combined using a
multiplexer and then launched to a fiber-optic link. At the end of the fiber-optic link, the channels are demul-
tiplexed using a demultiplexer. If the data rate of a data stream modulating an optical carrier of wavelength 𝜆j
is B, the total data rate is NB. Fig. 9.4 shows the WDM spectrum. Suppose that each channel is band-limited to
fs Hz. The spectrum of the channel j extends from fj −fs∕2 to fj + fs∕2, where fj = c∕𝜆j. Typically, the optical
carrier frequencies are equally spaced and the frequency difference between adjacent carriers is known as
the channel spacing Δf. If the channel spacing Δf is smaller than the signal bandwidth fs, the spectra of the
neighboring channels overlap, leading to cross-talk and performance degradation. If the channel spacing Δf
is much larger than fs, it is a waste of fiber bandwidth. It is useful to define the spectral efficiency of a WDM
system as
𝜂= B
Δf ,
(9.13)
Data 1
Mod 1
Mod 1
Mod 1
Laser 1
Laser 2
Laser N
1
2
N
1
2
N
Data 2
MUX
DEMUX
Fiber-optic link
Rx 1
Rx 2
Rx N
Data N
Figure 9.3
Schematic of a WDM system: Mod = modulator, MUX = multiplexer, DEMUX = demultiplexer.

392
Fiber Optic Communications
f1
f2
f1 * fs
2
f2 * fs
2
fN * fs
2
fN +
fN 
fs
2
f1 + fs
2
f2 + fs
2
f
Δ f
Figure 9.4
WDM spectrum.
where B is the data rate of a channel. If there are N channels, the total data rate is NB and the total bandwidth
is about NΔf. Therefore, the spectral efficiency is also the ratio of the total data rate to the total bandwidth.
For example, for a direct detection system based on NRZ-OOK, let the bit rate B be 10 Gb/s. If rectangular
pulses are used, the first null of the NRZ spectrum occurs at 10 GHz (see Fig. 4.4) and the signal bandwidth
fs in a channel ≅20 GHz. If the channel spacing Δf is 20 GHz, the spectral efficiency 𝜂is 0.5 b/s/Hz. In this
example, the overlap between the channel spectra is small and, hence, the cross-talk between the channels
is negligible. The channel spacing is determined by the signal bandwidth in a channel. In this example, if
the channel spacing is less than 20 GHz, there would be a significant overlap of spectra of adjacent channels,
leading to cross-talk. However, if a Nyquist pulse is used instead, the signal bandwidth in a channel is 10 GHz
(see Section 4.8) and in this case, the channel spacing can be reduced by a factor of two compared with the
case of NRZ, which leads to an improvement in spectral efficiency by a factor of two. The spectral efficiency
can also be considerably enhanced using coherent detection. For example, for a system based on QAM-16,
let the symbol rate Bs be 25 Gsym/s. For QAM-16, the data rate B is Bslog216 = 100 Gb/s (see Section 4.9). If
the channel spacing Δf = 50 GHz, the spectral efficiency = 2 b/s/Hz. The spectral efficiency can be increased
using higher-order modulation formats such as QAM-64, but these signals suffer from distortions due to fiber
nonlinear effects (see Chapter 10) limiting the maximum achievable transmission reach. Therefore, there is
a trade-off between spectral efficiency and reach. When polarization multiplexing is used, the data rate is
doubled for the given bandwidth and, therefore, the spectral efficiency is doubled compared with the case of
single polarization.
In 2002, the International Telecommunication Union (ITU) standardized the channel wavelengths (or fre-
quencies) of WDM systems on a 100-GHz (≈0.8 nm) grid in a wavelength range of 1528.77 nm to 1563.86 nm
as defined by ITU-T G.694.1 [1]. However, for coherent communication systems with a symbol rate of
28 Gsym/s, such a large channel spacing leads to poor spectral efficiency. Recently, ITU standardized the
WDM channels with a frequency spacing ranging from 12.5 GHz to 100 GHz and wider [1].
Example 9.1
Nyquist pulses are used in a single-polarization WDM system based on QAM-64. The symbol rate is
10 Gsym/s and the number of channels is 12. Calculate (a) the channel spacing to have a spectral efficiency
of 6 b/s/Hz, (b) the signal bandwidth in a channel and the total bandwidth of the WDM signal, and (c) the
total data rate.

Channel Multiplexing Techniques
393
Solution:
From Eq. (9.13), we have
𝜂= B
Δf .
(9.14)
For QAM-64, from Section 4.9, we find
B = Bslog264 = 6 × 10 Gb/s.
(9.15)
(a) The channel spacing is given by
Δf = B
𝜂= 60
6 GHz
= 10 GHz.
(9.16)
(b) For a Nyquist pulse, the one-sided bandwidth fs∕2 is Bs∕2. Therefore, the signal bandwidth in a channel
fs = Bs = 10 GHz.
Total bandwidth of the WDM system = (N −1)Δf + 2fs∕2
= (11 × 10 + 10) GHz
= 120 GHz.
(9.17)
(c)
Total data rate = NB = 12 × 60 Gb/s
= 720 Gb/s.
(9.18)
Example 9.2
A WDM system consists of 11 channels with a channel spacing of 100 GHz. The signal in each channel is
band-limited to 50 GHz. The average power per channel is 0 dBm. The WDM signal is transmitted over a
fiber of length 50 km. Fiber loss = 0.2 dB/km. Find the total power at the fiber output.
Solution:
Let the signal in channel k at the fiber input be
qk(t) =
∑
n
an,kf(t −nTs)ei2𝜋kΔft, k = −5, −4, … , 5
= gk(t)ei2𝜋kΔft,
(9.19)
where Δf = 100 GHz. The total signal field at the fiber input is
qin(t) =
5
∑
k=−5
qk(t).
(9.20)
Taking the Fourier transform of Eq. (9.20), we find
̃qin(f) =
5
∑
k=−5
̃qk(f) =
5
∑
k=−5
̃gk(f −kΔf),
(9.21)

394
Fiber Optic Communications
where we have used the frequency-shifting property. Using Parseval’s relation, the total energy is
Etot = ∫
∞
−∞
|qin(t)|2 dt = ∫
∞
−∞
|̃qin(f)|2 df
= ∫
∞
−∞
̃qin(f)̃q∗
in(f)df
= ∫
∞
−∞
5
∑
k=−5
̃gk(f −kΔf)
5
∑
l=−5
̃g∗
l (f −lΔf)df
= ∫
∞
−∞
⎡
⎢
⎢
⎢⎣
5
∑
k=−5
||̃gk(f −kΔf)||
2 +
∑
k
∑
l
k≠l
̃gk(f −kΔf)̃g∗
l (f −lΔf)
⎤
⎥
⎥
⎥⎦
df.
(9.22)
Consider the second term on the right-hand side of Eq. (9.22). ̃gk(f −kΔf) corresponds to the channel k
centered at kΔf with a bandwidth of 50 GHz. Since Δf > 50 GHz, the overlap term ̃gk(f −kΔf)̃g∗
l (f −lΔf)
is zero when k ≠l. Therefore, the total energy is
Etot =
5
∑
k=−5 ∫
∞
−∞
|̃gk(f −kΔf)|2df
=
5
∑
k=−5 ∫
∞
−∞
|qk(t)|2dt.
(9.23)
Thus, we see that the total energy is the sum of the energy of each channel. So, it follows that the total power
is 11 times the power per channel:
power per channel = 0 dBm
= 100.1×0 mW = 1 mW;
(9.24)
total power = 11 mW
= 10 log1011 dBm
= 10.413 dBm;
(9.25)
total fiber loss = 0.2 × 50 = 10 dB;
(9.26)
total power at the fiber output = 10.413 dBm −10 dBm
= 0.413 dBm.
(9.27)
9.3.1
WDM Components
Multiple wavelengths are combined using a multiplexer. The inverse operation of separating the wavelengths
of a combined signal is achieved using a demultiplexer. The photonic device used as a multiplexer can also
be used as a demultiplexer if the direction of propagation is reversed, because of the reciprocity property of
optical field propagation. The simplest example for a multiplexer/demultiplexer is a prism which separates

Channel Multiplexing Techniques
395
1 + 2 + ... + N
1
2
N * 1
N
White light
Figure 9.5
Wavelength separation using a prism.
(or combines) the different colors of white light, as shown in Fig. 9.5. But the angular separations provided by
the prism are not large enough to separate the wavelengths of a WDM signal. The multiplexers can be divided
into two categories: (i) interference-based multiplexers use Mach–Zehnder or other types of interferometer;
(ii) diffraction-based multiplexers make use of diffraction to spatially separate the wavelengths. Examples
include prisms and gratings.
9.3.1.1
Mach–Zehnder Interferometer-Based Demultiplexer
Mach–Zehnder interferometers can be cascaded to form a 1 × N demultiplexer [2–5]. Let us first consider the
theory of the 1 × 2 demultiplexer that separates two wavelengths. Fig. 9.6 shows a schematic of the demulti-
plexer. The 3-dB coupler is described by a matrix,
Mcoupler =
1
√
2
[
1 i
i 1
]
.
(9.28)
The outputs of the 3-dB coupler 1 are
Aco1
out = McouplerAin,
(9.29)
where
Ain =
[
A0
0
]
,
(9.30)
A0 is the input field envelope. Substituting Eqs. (9.28) and (9.30) in Eq. (9.29), we find
Aco1
out,1 = A0∕
√
2,
(9.31)
Aco1
out,2 = iA0∕
√
2
(9.32)
3-dB
Coupler 1
3-dB
Coupler 2
Port 1
Port 2
A0
L + ΔL/2
L * ΔL/2
Figure 9.6
1 × 2 wavelength demultiplexer.

396
Fiber Optic Communications
Aco1
out =
[Aco1
out,1
Aco1
out,2
]
.
(9.33)
Optical fields in the upper and lower arms of the interferometer undergo phase shifts k(L + ΔL∕2) and k(L −
ΔL∕2), respectively, where k is the propagation constant and ΔL is the path-length difference between two
arms. Therefore, the inputs of the 3-dB coupler 2 can be written as
Aco2
in,1 = A0
√
2
exp [ik(L + ΔL∕2)],
(9.34)
Aco2
in,2 = iA0
√
2
exp [ik(L −ΔL∕2)].
(9.35)
The outputs of the 3-dB coupler are
Aco2
out = McouplerAco2
in ,
(9.36)
Aco2
out,1 = A0 exp (ikL)i sin (kΔL∕2),
(9.37)
Aco2
out,2 = A0 exp (ikL)i cos (kΔL∕2).
(9.38)
The corresponding output powers are
Pout,1 = |Aco2
out,1|2 = A2
0sin2 (kΔL∕2),
(9.39)
Pout,2 = |Aco2
out,2|2 = A2
0cos2 (kΔL∕2).
(9.40)
Fig. 9.7 shows the power transmittances of ports 1 and 2. At a specific frequency, the power transmittance of
port 1 is maximum and at the same frequency, the power transmittance of port 2 is zero. This implies that if
the channel frequencies of a two-channel WDM system coincide with the frequencies corresponding to the
peak power transmittances of ports 1 and 2, they can be separated.
Power transmittance (Arb. units)
Relative frequency (GHz)
1
0
20
40
60
80 100 120 140 160 180 200
Port 1
Port 2
Figure 9.7
Power transmittance as a function of frequency deviation from the reference frequency of 194.8 THz.

Channel Multiplexing Techniques
397
Consider an optical wave with propagation constant k1 = 2𝜋n∕𝜆1, where n is the refractive index of the MZ
interferometer. If
k1ΔL = (2m + 1)𝜋, m = 0, ±1, ±2,
(9.41)
we have
Pout,1 = A2
0,
Pout,2 = 0.
(9.42)
So, all the input power appears in port 1. Given another optical wave with k2 = 2𝜋n∕𝜆2 and if
k2ΔL = 2l𝜋, l = 0, ±1, ±2,
(9.43)
we find that all the input power appears in port 2. Therefore, if we choose the wavelengths 𝜆1 and 𝜆2 such
that
nΔL
𝜆1
= (2m + 1)
2
,
(9.44)
nΔL
𝜆2
= l,
(9.45)
the optical fields with wavelengths 𝜆1 and 𝜆2 appear in ports 1 and 2, respectively. From Eqs. (9.44) and
(9.45), we obtain
𝜆2 −𝜆1 = 𝜆1𝜆2(2m′ + 1)
2nΔL
, m′ = m −l = 0, ±1, ±2.
(9.46)
Since fj = c∕𝜆j, j = 1, 2, from Eqs. (9.41) and (9.43), we obtain
Δf = (2m′ + 1)c
2nΔL
,
(9.47)
where Δf = f1 −f2 is the channel spacing. For example, wavelengths 𝜆1 = 1540 nm and 𝜆2 = 1540.4 nm are
multiplexed in a WDM system. At the receiver, these wavelengths can be separated if
ΔL = 𝜆1𝜆2(2m + 1)
(𝜆2 −𝜆1)2n , m = 0, ±1, ±2, … .
(9.48)
If we choose m = 0, we find ΔL = 2 mm.
A 1 × N demultiplexer can be constructed by cascading the 1 × 2 demultiplexer of Fig. 9.6. Fig. 9.8 shows
a schematic of a 1 × 4 demultiplexer. Suppose the input consists of four channels with wavelengths 𝜆1, 𝜆2,
1  2
Demux 1
1  2
Demux 2
Port
1  2
Demux 3
1, 2, 3, 4
1
2, 4
1, 3
2
3
4
4
3
2
1
2
1
Figure 9.8
1 × 4 wavelength demultiplexer.

398
Fiber Optic Communications
𝜆3, and 𝜆4, equally spaced in frequency. Let the frequency spacing be Δf. The path-length difference ΔL of
Demux 1 is chosen so that odd and even wavelengths are directed to ports 1 and 2 of Demux 1, respectively.
The frequency difference between channels 1 and 3 is 2Δf. If ΔL is chosen using Eq. (9.48), channels 1 and 2
are directed to ports 1 and 2 of Demux 1, respectively. Since the power transmittance is periodic with period
2Δf (see Fig. 9.7), channels 1 and 3 have the maximum power transmittance at port 1 of Demux 1. Channels
1 and 3 are separated using Demux 2. Since the frequency difference between channels 1 and 3 is 2Δf, ΔL
of Demux 2 should be half that of Demux 1. In this analysis, we assume that the couplers are ideal 3-dB
couplers and the MZ interferometer arms have no losses. As a result, we find that when the power output at
port 1 is maximum that at port 2 is zero, and vice versa (see Fig. 9.7). This corresponds to zero cross-talk
between channels. In practice, the power-coupling ratio deviates from 3 dB and the loss due to propagation
in MZ cannot be ignored. When these effects are included, it is found that the power output at port 2 is not
zero while that at port 1 is maximum, which leads to cross-talk between channels [5]. A 10 GHz-spaced
silica-based integrated-optic 8-channel MZ multi/demultiplexer is fabricated with a cross-talk of −10 dB
or less [5].
9.3.1.2
Diffraction-Based Multiplexer/Demultiplexers
Diffraction-based multi/demultiplexers make use of Bragg diffraction to isolate/combine the wavelength
components [6, 7]. Fig. 9.9 shows a schematic of the bulk grating-based demultiplexer. The WDM signal
consisting of multiple wavelength components is incident on the grating. Different wavelength components
diffract at different angles and they are collected by output fibers. One of the problems with bulk grating-based
demultiplexers is that the output fiber core must be much larger than the input fiber core in order to obtain the
required flat pass band [6, 7]. Instead, an array of optical waveguides acting as a grating could be used. Such
gratings are known as arrayed-waveguide gratings or phased-array demultiplexers.
9.3.1.3
Arrayed-Waveguide Gratings
The principle of wavelength multiplexing/demultiplexing using the AWG is discussed in Refs. [8–12]. Sup-
pose the input consists of two channels centered around 𝜆1 and 𝜆2. The input field propagates in a uniform
1, 2, 3
3
2
1
Input fiber
Lens
Grating
Output fibers
Figure 9.9
Bulk grating-based demultiplexer.

Channel Multiplexing Techniques
399
2
1
2
10
*1
*2
Input
Arrayed waveguides
Output waveguide 1
Output waveguide 2
1, 2
Figure 9.10
AWG demultiplexer.
medium and then it is incident on the waveguide array (or arrayed waveguides), as shown in Fig. 9.10. The
lengths of waveguides lj, j = −N∕2, … , −1, 0, 1, … , N∕2 −1 are chosen so that the phase shifts introduced
by each single-mode waveguide are an integral multiple of 2𝜋at wavelength 𝜆1. The phase of the optical field
arriving through waveguide j at the output is
𝜙j(𝜆1) = 𝛽(𝜆1)lj + 𝜃j(𝜆1) = 2𝜋mj + 𝜃j(𝜆1),
(9.49)
where 𝛽is the propagation constant of the waveguide j, 𝜃j is the initial phase at the input of the waveguide
j and mj is an integer. For simplicity, let us assume that the input is a point source and the wave front at the
input of the waveguides is spherical, so that 𝜃j = 𝜃. When the lengths of the waveguides are chosen so that
Eq. (9.49) is satisfied, the waveguide array behaves like a phased array with uniform phase distribution at
the output. Because of the geometry, the diverging wave front at the input of the waveguide array becomes a
converging wave front at its output. The part of the spectrum centered around 𝜆j, j = 1, 2 at the output of the
waveguide array focuses on the output waveguide j. The reason for the spatial separation of the wavelengths
can be understood as follows. From Eq. (9.49), the phase difference between the adjacent waveguides at 𝜆1 is
𝛿𝜙(𝜆1) ≡𝜙j(𝜆1) −𝜙j−1(𝜆1) = 𝛽(𝜆1)Δl = 2m𝜋,
(9.50)
where Δl = lj −lj−1 and m = mj −mj−1 is an integer. Let
𝜆2 = 𝜆1 + Δ𝜆.
(9.51)
The Taylor-series expansion of the propagation constant around 𝜆1 is
𝛽(𝜆2) ≅𝛽(𝜆1) + kΔ𝜆,
(9.52)
k = d𝛽
d𝜆
||||𝜆=𝜆1
.
(9.53)
From Eqs. (9.49) and (9.52), we have
𝜙j(𝜆2) = 𝛽(𝜆2)lj + 𝜃(𝜆2)
= 𝜙j(𝜆1) + Δ𝜃+ kΔ𝜆lj,
(9.54)
where
Δ𝜃= 𝜃(𝜆2) −𝜃(𝜆1) = 𝜃j(𝜆2) −𝜃j(𝜆1).
(9.55)

400
Fiber Optic Communications
Wavefront at 1
a
Wavefront at 2
j
j * 1
Δ
Δx
Figure 9.11
Wavefronts at 𝜆1 and 𝜆2.
From Eqs. (9.50) and (9.54), it follows that the phase difference between adjacent waveguides at 𝜆2 is
𝛿𝜙(𝜆2) = 𝜙j(𝜆2) −𝜙j−1(𝜆2) = kΔ𝜆Δl.
(9.56)
Thus, although the phases of the adjacent waveguides are identical at 𝜆1, they are shifted by kΔ𝜆Δl at 𝜆2.
Consider two adjacent waveguides j and j −1 separated by a, as shown in Fig. 9.11. Suppose the optical field
in waveguide j propagates an additional distance Δx, then the phases of the output of waveguides j and j −1
become identical, i.e.,
kΔ𝜆Δl = 𝛽(𝜆2)Δx.
(9.57)
Thus, the wave front (the locus of all the points having the same phase) at 𝜆2 is tilted by an angle Δ =
Δx∕a. Therefore, in Fig. 9.10, the output of the waveguide array corresponding to wavelength 𝜆2 focuses on
a different port than the wavelength 𝜆1.
A waveguide grating demultiplexer on InP which resolves 16 channels with a channel spacing of 1.8 nm
and with low polarization sensitivity was demonstrated in 1994 [11]. A 4-channel phased-array wavelength
demultiplexer on InGaAsP/InP with a channel spacing of 1 nm was demonstrated in 1996 [12].
Example 9.3
A 1 × 2 AWG demultiplexer has to be designed. 𝜆1 = 1550 nm, 𝜆2 = 1550.8 nm, 𝛽0 = 5.87 × 106 m−1 at 𝜆1,
𝛽1 = 4.86 × 10−9 s/m at 𝜆1. (a) Find the lengths of the adjacent waveguides l1 and l2 such that the phase
shifts 𝜙1 and 𝜙2 at the fiber outputs at 𝜆1 are integral multiples of 2𝜋. (b) Calculate 𝜙1 and 𝜙2 at 𝜆2. Assume
𝜃1 = 𝜃2 = 0.
Solution:
(a) Let
𝛽(𝜆1)l1 = 2𝜋m1,
(9.58)
𝛽(𝜆1)l2 = 2𝜋m2.
(9.59)
Here, m1 and m2 could be any integers. Let m1 = 100 and m2 = 110:
𝛽(𝜆1) = 𝛽0 = 5.87 × 106 m−1,
(9.60)
l1 = 2𝜋× 100
𝛽0
= 107.04 μm,
(9.61)

Channel Multiplexing Techniques
401
l2 = 2𝜋× 110
𝛽0
= 117.74 μm.
(9.62)
(b)
d𝛽
d𝜆= d𝛽
d𝜔
d𝜔
d𝜆= 2𝜋d𝛽
d𝜔
df
d𝜆,
(9.63)
f = c
𝜆,
(9.64)
df = −c
𝜆2 d𝜆,
(9.65)
df
d𝜆
|||𝜆1=1550 nm =
−3 × 108
(1550 × 10−9)2 m−1 s−1 = −1.24 × 1020 m−1 s−1
(9.66)
𝛽1 = d𝛽
d𝜔
|||𝜆=1550 nm = 4.86 × 10−9 s/m.
(9.67)
Eq. (9.63) may be written as
d𝛽
d𝜆
|||𝜆1=1550 nm = 2𝜋𝛽1
df
d𝜆
|||𝜆1=1550 nm
= −3.81 × 1012 m−2.
(9.68)
From Eqs. (9.49) and (9.54), we have
𝜙1(𝜆2) = 𝛽(𝜆2)l1
= 𝛽(𝜆1)l1 + (𝜆2 −𝜆1)l1
d𝛽
d𝜆
|||𝜆1=1550 nm
= 2𝜋× 100 −0.8 × 10−9 × 107.04 × 10−6 × 3.81 × 1012 rad
= 6.279 × 102 rad,
(9.69)
𝜙2(𝜆2) = 𝛽(𝜆2)l2
= 𝛽(𝜆1)l2 + (𝜆2 −𝜆1)l2
d𝛽
d𝜆
|||𝜆1=1550 nm
= 2𝜋× 110 −0.8 × 10−9 × 117.74 × 10−6 × 3.81 × 1012 rad
= 6.907 × 102 rad.
(9.70)
9.3.2
WDM Experiments
WDM has been studied extensively and is used in commercial transmission systems. Early WDM experiments
were carried out using direct detection [13]. With the advent of digital coherent receivers, the information
capacity and spectral efficiency have increased significantly. A data rate of 7.2 Tb/s over a distance of 7040 km
with a spectral efficiency of 2 bit/s/Hz is achieved using PDM and QPSK [14]. The baud rate of each WDM
channel in this experiment is 25 GBaud, excluding the FEC overhead. Because of QPSK modulation forma-
tion, the bit rate of each PDM channel is 50 Gb/s. Since there are two PDM channels for each optical carrier, the
total bit rate per WDM channel is 100 Gb/s. The total number of WDM channels is 72, leading to a total bit rate

402
Fiber Optic Communications
of 7.2 Tb/s. The optical bandwidth occupied by the WDM signal is 28 nm (or 3.5 THz), leading to a spectral
efficiency of 7.2∕3.5 ≅2 bit/s/Hz. The spectral efficiency can be increased further by using MPSK or QAM. A
17-Tb/s (161 × 114 Gb/s) polarization-multiplexed WDM signal is transmitted over 662 km using RZ-8PSK
[15]. A spectral efficiency of 4.2 bit/s/Hz was achieved in this experiment [15]. A 32-Tb/s (320 × 114 Gb/s)
polarization-multiplexed RZ-8QAM signal was transmitted over 580 km of SMF-28 with a spectral efficiency
of 4 bit/s/Hz [16]. As the spectral efficiency increases, the transmission distance decreases because of fiber
nonlinear effects (see Chapter 10).
9.4
OFDM
WDM is a FDM technique in which the carriers are typically not orthogonal. A special class of FDM in
which the carriers (or subcarriers) are orthogonal is known as orthogonal frequency-division multiplexing
(OFDM). In a WDM system, if the channel spacing is smaller than the bandwidth of the channels, this leads
to cross-talk and performance degradation. However, in an OFDM system, if the separation between carriers
is smaller than the band width of the data in each carrier, there is a significant spectral overlap between the
neighboring channels and yet there would be no cross-talk or performance degradation because of carrier
orthogonality conditions.
OFDM has drawn significant research interest in optical communications recently [17–33]. OFDM is
widely used in wired and wireless communication systems because it is resilient to ISI caused by disper-
sive channels. It has been used for digital audio broadcasting, HDTV terrestrial broadcasting, and wireless
LANS. The first proposal to use orthogonal frequencies for transmission appeared in a 1966 patent by Chang
[34]. In 1969, Salz and Weinstein [35] introduced orthogonal carriers by using the discrete Fourier transform
(DFT). In 1971, Weinstein and Ebert [36] applied the discrete cosine transform (DCT) to a multi-carrier trans-
mission system as part of a modulation and demodulation process. The cyclic prefix, which is an important
aspect of the OFDM system, was proposed in 1980 [37].
9.4.1
OFDM Principle
Consider a multi-carrier communication system as shown in Fig. 9.12. Suppose d1(t), d2(t), … , dN(t) are the
complex data streams to be transmitted:
dn(t) =
{
dn0
for 0 < t < Ts
0
otherwise,
(9.71)
X
X
X
X
X
X
Channel
d1
d2
dN
∑
ʃ
ʃ
ʃ
d1ˆ
d2ˆ
d3ˆ
exp(*i2π f1t)
exp(i2π f1t)
exp(*i2π f2t)
exp(*i2π fNt)
exp(i2π f2t)
exp(i2π fNt)
Figure 9.12
A multi-carrier communication system.

Channel Multiplexing Techniques
403
where Ts is the symbol period and dn0 is a constant. Let f1, f2, … , fN be the carrier frequencies. The carrier
exp (i2𝜋fnt) is modulated by the data stream dn, n = 1, 2, … , N and then the modulated signals are combined
to obtain the transmitted signal.
str(t) =
N
∑
n=1
dn(t) exp (i2𝜋fnt).
(9.72)
At the receiver, the received signal is multiplexed by the bank of local oscillators and integrators. In the
absence of channel distortion and noise effects, the signal after the integrator can be written as
̂dm = 1
Ts ∫
Ts
0
str(t) exp (−i2𝜋fmt)dt, m = 1, 2, … , N
(9.73)
= 1
Ts ∫
Ts
0
N
∑
n=1
dn(t) exp [i2𝜋(fn −fm)]dt.
(9.74)
The integrator is nothing but a low-pass filter and the terms oscillating at frequencies fn −fm, n ≠m do not
contribute significantly if fn −fm is larger than 1∕Ts. Therefore, a significant contribution comes only from
the d.c. term corresponding to n = m in Eq. (9.74), leading to
̂dm ≅dm0.
(9.75)
One of the disadvantages of this approach is that frequency separation between carriers should be sufficiently
large so that the contributions from the cross-terms at frequencies fn −fm, n ≠m in Eq. (9.74) are small. This
leads to excessive bandwidth requirements. Besides, the transmitter and receiver require a bank of analog
oscillators, product modulators, and filters, increasing the complexity of the architecture.
The bandwidth can be utilized efficiently if the carriers are orthogonal. Suppose we choose the carrier
frequencies such that
1
Ts ∫
Ts
0
exp [i2𝜋(fm −fn)t] =
{
1
if m = n
0
otherwise.
(9.76)
Now, the carriers are said to be orthogonal over the interval [0, Ts]. If
fm = m∕Ts, m = 1, 2, … , N,
(9.77)
it can easily be verified that Eq. (9.76) is satisfied. Therefore, the carrier frequencies should be integral multi-
ples of the symbol rate (= 1∕Ts). For example, the first carrier is a sinusoid with period Ts, the second carrier
is a sinusoid with period Ts∕2, and so on. Using Eqs. (9.71) and (9.77), Eq. (9.72) may be rewritten as
str(t) =
N
∑
n=1
dn0 exp
(
i2𝜋nt
Ts
)
, 0 < t < Ts.
(9.78)
If we discretize the time interval
t = kΔt, k = 1, 2, … , N,
(9.79)
where Δt is the sampling interval with
NΔt = Ts,
(9.80)
Eq. (9.78) is modified as
str(kΔt) ≡sk =
N
∑
n=1
dn0 exp
[i2𝜋kn
N
]
, k = 1, 2, … , N.
(9.81)

404
Fiber Optic Communications
sk is the inverse discrete Fourier transform (IDFT) of the data sequence {dn0}, n = 1, 2, … , N. IDFT can be
computed efficiently using the inverse fast Fourier transform (IFFT). In other words, the bank of oscillators,
product modulators, and adders in the transmitter section of Fig. 9.12 can be replaced by an IDFT operation in
the digital domain. Similarly, the bank of correlators at the receivers can be replaced by a DFT. In Eq. (9.74),
because of the orthogonality condition given by Eq. (9.76), all the terms at frequencies fn −fm vanish except
for the d.c. term with n = m. Therefore,
̂dm = dm0.
(9.82)
Replacing the integral in Eq. (9.73) by summation with t = kΔt and using Eqs. (9.77) and (9.80), we obtain
̂dm = 1
N
N
∑
k=1
str(kΔt) exp
(
−i2𝜋mk
N
)
, m = 1, 2, … , N.
(9.83)
Thus, ̂dm is the DFT of sk, which can be computed using the FFT. Fig. 9.13 shows a simplified block diagram of
an optical OFDM system. Consider the data sequence {d1, d2, … , dN}k in a symbol interval [kTs, (k + 1)Ts].
The IDFT of this sequence is computed by means of IFFT. After parallel-to-serial conversion (P/S), the optical
carrier (laser) is modulated by the electrical OFDM symbol and then it propagates through the fiber-optic
link. At the receiver, a coherent receiver is used to retrieve the electrical OFDM symbol. After performing
the serial-to-parallel (S/P) and DFT operations, the transmitted data sequence {d1, d2, … , dN}k of the kth
OFDM symbol can be recovered in the absence of noise and distortion. The IDFT operation at the transmitter
and the DFT operation at the receiver are repeated for every OFDM symbol.
In a dispersive channel such as an optical fiber, different frequency components travel with different speeds.
In a normal dispersion fiber, a higher-frequency subcarrier of a given OFDM symbol is delayed and it would
interfere with the data in the neighboring symbol. Suppose, at the receiver, the timing offset is chosen so that
the DFT window is synchronized with subcarrier 1. Now, subcarrier N is delayed by (see Eqs. (2.197) and
(2.203))
ΔT = |𝛽2|Δ𝜔L = DΔ𝜆L,
(9.84)
where 𝛽2 is the dispersion coefficient, D is the dispersion parameter, L is the fiber length, and Δ𝜔is the angular
frequency difference between subcarrier 1 and subcarrier N. From Fig. 9.14, it can be seen that subcarrier
Digital signal processing (DSP)
Elect. OFDM symbol
Opt.
Mod.
Laser
d1
d2
dN
d1
d2
dN
Fiber
Opt.
Link
Opt
Rx
S/P
IFFT
P/S
FFT
Figure 9.13
Block diagram of an optical OFDM system. Opt. mod. = optical modulator, P/S = parallel to serial, S/P =
serial to parallel.

Channel Multiplexing Techniques
405
Delay due to fiber dispersion = DΔL
At Rx
At Tx
Subcar 1
Subcar N
Time
Disp.
channel
1
1
0.5
0
*0.5
*1
0
*1
0
2
4
6
8
10
0
2
3
1
4
5
6
7
8
9 10
1
0.5
0
*0.5
*1
0
2
3
1
4
5
6
7
8
9 10
Time
1
0
*1
0
2
4
6
8
10
DFT window
Figure 9.14
Subcarriers of the OFDM system with no cyclic prefix.
N has moved out of the DFT window. This leads to two issues. First, it would interfere with the data in
the neighboring OFDM symbol if there is no guard interval between the two. This is known as intercarrier
interference (ICI) and could lead to performance degradation. Second, as can be seen from Fig. 9.14, the first
few cycles of the subcarrier N at the receiver are empty within the DFT window and, therefore, subcarriers
1 and N are no longer orthogonal over the symbol interval. The breakdown of orthogonality conditions also
leads to performance degradations.
To preserve the orthogonality, a cyclic prefix is used [27, 28]. Instead of leaving the guard interval empty,
the last few cycles of subcarrier N within a block are copied to the guard interval, as shown in Fig. 9.15.
Cyclic prefix
At Rx
At Tx
Subcar 1
Subcar N
Time
1
1
0.5
0
*0.5
*1
0
*1
0
5
10
15
0
2
4
6
8
10
12
14
1
0.5
0
*0.5
*10
2
4
6
8
10
12
14
Time
1
0
*1
0
5
10
15
DFT window
Figure 9.15
Subcarriers of the OFDM system with cyclic prefix.

406
Fiber Optic Communications
Although subcarrier N moves out of the DFT due to fiber dispersion, because of its identical copy in the
guard interval, the signal corresponding to subcarrier N at the receiver is the same as that at the transmitter
except for a phase jump, as shown in Fig. 9.15. The phase jump can be removed after channel estimation at
the receiver. As long as the maximum delay ΔT introduced by the dispersive channel is less than the guard
interval Tg, the subcarriers are orthogonal at the receiver. The maximum delay ΔT is
ΔT = |𝛽2|(2𝜋NΔf)L,
(9.85)
where Δf = 1∕Ts is the frequency spacing between subcarriers. Therefore, the guard interval should be chosen
so that
|𝛽2|(2𝜋NΔfL) < Tg.
(9.86)
To preserve the orthogonality of all the subcarriers, the last few cycles of each subcarrier should be copied
to the guard interval. Although the guard interval increases the tolerance against delay due to dispersion, it
reduces the efficiency since the guard interval is discarded by the receiver.
9.4.2
Optical OFDM Transmitter
Fig. 9.16 shows a block diagram of an optical OFDM transmitter. First, the binary serial input is converted to
parallel (S/P). For example, a bit sequence {00110111} is broken into {00}, {11}, {01}, and {11}. Each of
these subsequences is mapped into QPSK data using a symbol mapper, i.e.,
{00} →(−1 −i)∕
√
2 = d1
{11} →(1 + i)∕
√
2 = d2
and so on. By breaking the bit sequence {00110111} into {0011} and {0111}, a symbol mapper could map it
onto QAM-16 data. The output of the symbol mapper is complex data which passes through the IFFT block.
After the parallel-to-serial conversion (P/S) and guard interval insertion, the digital signal is converted to an
analog signal using a digital-to-analog converter (DAC). In fact, the IFFT output is complex in general and,
therefore, two DACs are needed. The outputs of the DACs are used to modulate an optical IQ modulator.
Binary
input
DSP
DAC
S/P
Symbol
mapper
IFFT
P/S
00
11
0011...1
Guard
interval
OFDM
Laser
Optical IQ
modulator
To fiber channel
Figure 9.16
Block diagram of the OFDM transmitter. S/P = serial to parallel, P/S = parallel to serial, DAC =
digital-to-analog converters.

Channel Multiplexing Techniques
407
Laser
DAC
DAC
Imaginary part of OFDM data
Real part of OFDM data
π/2
MZM-Q
MZM-I
Figure 9.17
Block diagram of an IQ modulator. MZM = Mach–Zehnder modulator, DAC = digital-to-analog converter.
A description of the IQ modulator is provided in Fig. 9.17. Real and imaginary parts of the OFDM data
modulate the laser light using a Mach–Zehnder modulator-I (MZM-I) and MZM-Q, respectively. Let the real
and imaginary parts of the OFDM data be mr(t) and mi(t), respectively. Assuming that the MZMs operate in
the linear regime, the MZM-I and MZM-Q outputs can be written as (see Section 4.6.2.2)
qI = Ac
√
2
mr(t) exp (−i2𝜋fct),
(9.87)
qQ = Ac
√
2
mi(t) exp (−i2𝜋fct).
(9.88)
The output of MZM-Q passes through a 𝜋∕2 phase shifter, which is equivalent to multiplying by i. After the
output y-branch in Fig. 9.17, the output is given by
q = (qI + iqQ)∕
√
2
= Ac
2 m(t) exp (−i2𝜋fct),
(9.89)
where m(t) = mr(t) + imi(t) is the complex OFDM data.
9.4.3
Optical OFDM Receiver
Fig. 9.18 shows a block diagram of an optical OFDM receiver with coherent detection. The output of the
fiber-optic link passes through an optical IQ receiver (see Chapter 5) consisting of a 90∘hybrid and an array
of photodetectors. The I- and Q-branches of the IQ receiver output correspond to the real and imaginary
parts of the OFDM data, respectively. After the analog-to-digital conversion (ADC), the I and Q signals pass
through the DSP unit for further signal processing. Combining the real and imaginary parts, complex OFDM
data is formed and the DFT of this data is computed using FFT, after serial-to-parallel conversion on each
OFDM symbol. In the absence of laser phase noise, fiber propagation effects, and ASE, the output of the FFT

408
Fiber Optic Communications
ADC
ADC
I
Q
DSP
d1
d2
d3
r1
r2
rN
Complex
data
S/P
FFT
Phase
Est.
Chan.
Est.
&
Equal.
Fiber
link
Local
Osc.
IQ
receiver
Figure 9.18
Block diagram of an optical OFDM receiver. S/P = serial to parallel, ADC = analog-to-digital converter,
DSP = digital signal processing.
block would be the actual data in each subcarrier. However, because of the noise and fiber propagation effects,
the signal is distorted. To undo these distortions, phase and channel estimation and equalization are carried
out in the digital domain. More details can be found in Ref. [38].
9.4.4
Optical OFDM Experiments
Transmission of a 1-Tb/s OFDM superchannel over 8000 km of SSMF link at a spectral efficiency of
3.1 bit/s/Hz has been demonstrated experimentally [39]. Each channel of a WDM system can use OFDM
as modulation format. Since OFDM has a compact spectrum, the guard band between WDM channels can
be reduced. The experimental demonstration of an 8-channel dense WDM (DWDM) transmission with a
spectral efficiency of 7 bit/s/Hz using a 65.1-Gb/s coherent PDM–OFDM signal in each channel with 8-GHz
channel spacing utilizing 32-QAM data on each subcarrier of an OFDM over a 240-km SSMF link has been
carried out [40].
Using a coded modulation scheme for coherent OFDM, a 231.5-Gb/s OFDM signal at a record spectral
efficiency of 11.15 bit/s/Hz over an 800-km ultra-large-area fiber link has been demonstrated experimentally
[41]. The spectral efficiency in this experiment is close to the Shannon limit. However, the signal reception in
most of the experimental reports is processed off-line. This is because it is hard to implement DFT and IDFT
in real time at higher data rates. Multi-band real-time coherent OFDM reception at a data rate of 110 Gb/s
based on a field programmable gate array (FPGA) with an individual sub-band of 3.33 Gb/s over a 600-km
fiber-optic link has been demonstrated [42].
Example 9.4
An optical OFDM system has 128 subcarriers with a frequency spacing of 78.125 MHz between subcarriers.
The dispersion of the transmission fiber is −22 ps2/km. The guard interval is 1.28 ns. Calculate the maximum
reach up to which the carrier orthogonality is preserved.
Solution:
The carrier orthogonality will not be preserved if
|𝛽2|(2𝜋NΔfL) < Tg.
(9.90)

Channel Multiplexing Techniques
409
The maximum reach is given by
Lmax =
Tg
|𝛽2|(2𝜋NΔf) =
1.28 × 10−9
22 × 10−27 × 2𝜋× 128 × 78.125 × 106
= 925 km.
(9.91)
9.5
Time-Division Multiplexing
In the case of frequency-division multiplexing, parallel streams of data are modulated by carriers with differ-
ent frequencies so that the data spectra do not overlap (see Fig. 9.4). Instead, the parallel streams of data can be
converted to serial data in such a way that the individual streams do not overlap in time. This type of multiplex-
ing is known as time-division multiplexing (TDM). Fig. 9.19 illustrates the schematic of a two-channel TDM.
Let Ts be the symbol interval of the individual data streams corresponding to a symbol rate of Bs = 1∕Ts.
TDM converts the parallel data streams into serial data with two symbols within the symbol interval Ts, as
shown in Fig. 9.19. To avoid the overlap in time, the pulse widths should be less than Ts∕2. In this example,
the total symbol rate is 2Bs. In general, for an N-channel TDM system, the pulse widths should be less than
Ts∕N and the total symbol rate is NBs.
TDM can be performed in either an electrical or an optical domain. However, as the bit rate increases beyond
40 Gb/s, if becomes hard to do electrical TDM because of the limitations imposed by high-speed electronics.
Instead, channels can be multiplexed in the optical domain and such a scheme is known as optical TDM
(OTDM). Because of the wide bandwidth of optical devices, OTDM can be used to obtain a total bit rate of
several terabits per seconds.
9.5.1
Multiplexing
To realize OTDM, ultra-short laser pulses and delay lines are required [7, 43]. Fig. 9.20 shows a schematic of a
four-channel OTDM system. A train of ultra-short pulses is split into four branches. Each branch is modulated
by the electrical data. To avoid the temporal overlap of channels, channel j, j = 1, 2, 3, 4, is delayed by (j −1)T,
where T = Ts∕4, using a delay line. The delay lines can be realized using fiber segments (see Example 2.5).
The output of all branches is combined to obtain a TDM signal.
TDM
Ch. 1
Ch. 1
Ch. 2
Ch. 2
Ch. 2
Ch. 1
TDM signal
Ts
Ts
Ts
Ch. 1
Ch. 2
Ch. 1
Ch. 2
Figure 9.19
Schematic of a two-channel TDM.

410
Fiber Optic Communications
Ch. 2
Ch. 3
Ch. 4
Ch. 1
Ch. 1 2 3 4
2 3 4
1
2 3 4
1
Mod
T
2T
3T
Mod
Mod
Mod
TDM signal
Laser
Electrical data
Ts
Ts
Figure 9.20
Schematic of a four-channel OTDM. Mod = optical modulator and T refers to a delay of Ts∕4.
Ch. 1
Ch. 1
1
1
2
1
2
1
2
Electrical clock
signal
Demultiplexed
channel 1
MZM
OTDM signal
Figure 9.21
Schematic of an OTDM demultiplexer. MZM = Mach–Zehnder modulator.
9.5.2
Demultiplexing
Fig. 9.21 shows a schematic of a two-channel OTDM demultiplexer. The MZM is driven by the electrical
signal at a clock rate of Bs. To demultiplex channel 1, the amplitude of the electrical driving voltage is
chosen so that channel 1 is at the peak of the MZM transmittivity and channel 2 is at the null (see Section
4.6.2.2). Therefore, the modulator transmits channel 1 without significant attenuation while it rejects channel
2. A similar MZM with the appropriate delay transmits channel 2 while rejecting channel 1. MZMs can
easily be cascaded to demultiplex a channel from an N-channel OTDM signal [7, 43]. To avoid cross-talk
from other channels, the extinction ratio of the modulator should be high [43]. A moderate extinction ratio
(∼15 dB) can be realized with MZMs. To enhance the extinction further, electroabsorption modulators
can be used.
Example 9.5
A pulse incident on a 3-dB splitter as shown in Fig. 9.22 has a pulse width (FWHM) = 5 ps and a peak power =
5 mW. The length of fiber 1 is 1 mm. Find the length of fiber 2 so that the separation between pulses after the
combiner is 25 ps. Assume 𝛽1 = 0.5 × 10−8 s/m and 𝛽2 = 0 for both fibers.

Channel Multiplexing Techniques
411
2.5 mW
5 mW
2.5 mW
Fiber 1
Combiner
25 ps
3-dB
Splitter
Fiber 2
Figure 9.22
Generation of OTDM bit stream.
Solution:
The 3-dB splitter splits the optical pulse into two pulses, each with half power.
The delay occurring in fiber 1 is 𝛽1L = 0.5 × 10−8 × 1 × 10−3 s = 5 ps.
To have a separation of 25 ps between pulses, the delay in fiber 2 should be 25 ps + 5 ps = 30 ps. Therefore,
the length of fiber 2 is given by
delay
𝛽1
= 30 × 10−12
0.5 × 10−8 = 6 mm.
(9.92)
Example 9.6
Develop an OTDM to multiplex four 10-Gb/s data streams into a single 40-Gb/s data stream. Assume the
same parameters as in Example 9.5.
Ch. 1
Ch. 1
1
1
1
0
100 ps
2
4
3
1 1
1
1
1 2
4
3
1 2
4
3
1 1
0
1
1
1
1
t
L1
L2
L3
L4
t
t
t
1
1
1
0
1
1
1
1
0
10-Gb/s data stream
40-Gb/s signal
Combiner
Ch. 2
Ch. 3
Ch. 4
Figure 9.23
Multiplexing four 10-Gb/s data streams into a 40-Gb/s bit stream.

412
Fiber Optic Communications
Solution:
The bit interval for a 10-Gb/s signal is equal to
1
10 × 109 ps = 100 ps.
(9.93)
The bit interval for a 40-Gb/s signal is equal to
1
40 × 109 ps = 25 ps.
(9.94)
Fig. 9.23 shows a schematic of an OTDM which multiplexes four 10-Gb/s bit streams into a 40-Gb/s bit
stream. To have a delay of 25 ps between Ch. 1 and Ch. 2, L2 = L1 + 25 ps/𝛽1. If L1 = 1 mm, L2 = 6 mm.
Similarly, L3 = 11 mm and L4 = 16 mm. Fig. 9.24 shows the pulses of 10-Gb/s channels within a bit interval
of the 40-Gb/s signal.
40-Gb/s signal
Ch. 1
Ch. 2
Ch. 3
Ch. 4
25 ps
100 ps
t
Figure 9.24
40-Gb/s signal obtained by multiplexing four 10-Gb/s signals.
9.5.3
OTDM Experiments
In one of the early OTDM transmission experiments [44], a 100-Gb/s OTDM signal was transmitted over
560 km. The OTDM signal was obtained by multiplexing 16 channels at a bit rate of 6.3 Gb/s. A 40-km
normal dispersion fiber was used in the first half of an 80-km fiber span and a 40-km anomalous dispersion
fiber was used in the other half so that second-order dispersion was compensated. The transmission distance
in the above experiment was mainly limited by higher-order dispersion. As the bit rate increased beyond
40 Gb/s, the performance was degraded by the ISI caused by higher-order dispersion. This problem can be
alleviated by using a dispersion slope compensation fiber which compensates for third-order dispersion.
A 400-Gb/s OTDM signal was transmitted over 40 km using a dispersion slope compensation fiber [45].
A 1-Tb/s OTDM soliton signal was transmitted over 1000 km using a DMF consisting of alternating
sections of normal and anomalous dispersion fiber [46]. The section length in the above experiment was
around 10 km. The normal dispersion fiber section not only compensated for second-order dispersion
of the anomalous dispersion fiber section, but also for the dispersion slope. OTDM can be combined
with WDM to increase the capacity. A six-channel WDM system with each channel consisting of a
170.6-Gb/s OTDM signal was demonstrated over a 2000-km nonzero dispersion fiber using RZ-DPSK
format [47].

Channel Multiplexing Techniques
413
9.6
Additional Examples
Example 9.7
In a polarization-multiplexed WDM system based on QAM-16, the number of channels = 24 and the symbol
rate per polarization = 28 GBaud. Ideal Nyquist pulses are used in each channel. Assuming that the channel
spacing Δf is equal to the signal bandwidth fs in a channel, calculate (a) the total data rate and (b) the spectral
efficiency.
Solution:
(a) The data rate of a channel per polarization, Bs = 28 GBaud. For QAM-16, we have
B = Bslog216
= 112 Gb/s.
(9.95)
Here, B is the data rate of a channel per polarization.
Total data rate = B × no. of polarizations × no. of channels
= 112 × 2 × 24 Gb/s
= 5.376 Tb/s.
(9.96)
(b) For a Nyquist pulse, the signal bandwidth fs = Bs = 28 GHz. With fs = Δf, the total WDM signal band-
width is
NΔf = 28 × 24 GHz
= 672 GHz,
(9.97)
spectral efficiency = total data rate
total bandwidth
= 5376
672 b/s/Hz
= 8 b/s/Hz.
(9.98)
Example 9.8
In an optical OFDM system, each subcarrier is modulated by QPSK data. The guard interval is 7% of the
OFDM symbol period and the carrier orthogonality should be preserved over a transmission distance of at
least 5000 km. Find the number of subcarriers required to transmit information at a data rate of about 10 Gb/s.
Assume 𝛽2 = −22 ps2/km.
Solution:
Let the symbol rate of a subcarrier be Bs. For QPSK, we have
B = Bslog24 = 2Bs.
(9.99)

414
Fiber Optic Communications
Therefore, the total bit rate is
NB = 2NBs = 10 Gb/s,
(9.100)
where N is the number of subcarriers. Since the frequency separation between the subcarriers Δf = 1
Ts = Bs,
Eq. (9.86) may be rewritten as
Lmax =
Tg
|𝛽2|(2𝜋NBs),
(9.101)
where Lmax is the maximum reach up to which carrier orthogonality is preserved. From Eq. (9.101), we find
Tg = 5000 × 103 × 22 × 10−27 × 10 × 109 × 𝜋s
= 3.4558 ns.
(9.102)
Since Tg = 0.07Ts, Ts = 49.368 ns. Using Eq. (9.100), with Ts = 1∕Bs, we find
N = floor
{
10 × 109 × 49.368 × 10−9
2
}
= 246.
(9.103)
Example 9.9
In a polarization-multiplexed OFDM system, there are 64 subcarriers and each carrier is modulated by
QAM-64. OFDM symbol period = 12.8 ns, launch power to the fiber = 2 dBm, fiber loss = 0.19 dB/km,
fiber length = 70 km. Calculate (a) the signal power/subcarrier/polarization at the fiber output, (b) the data
rate and (c) the spectral efficiency.
Solution:
(a)
Total loss = 0.19 × 70 = 13.3 dB.
(9.104)
Input power = 2 dBm.
(9.105)
Output power Pout(dBm) = 2 −13.3 dBm
= −11.3 dBm.
(9.106)
Pout(mW) = 10−11.3∕10 mW
= 0.0741 mW.
(9.107)
No. of subcarriers = 64.
(9.108)
No. of polarizations = 2.
(9.109)
Signal power/subcarrier/polarization = 0.0741
2 × 64 mW
= 5.789 × 10−4 mW.
(9.110)

Channel Multiplexing Techniques
415
(b)
OFDM symbol period Ts = 12.8 × 10−9 s.
(9.111)
Symbol rate/subcarrier Bs = 1
Ts
= 78.125 MBaud.
(9.112)
For QAM-64, we have
bit rate B = log264Bs = 468.75 Mb/s.
(9.113)
Since there are 64 subcarriers and two polarizations, the total data rate is
Btot = 468.75 × 106 × 2 × 64
= 60 Gb/s.
(9.114)
(c)
Separation between subcarriers Δf = 1
Ts
= 78.125 MHz.
(9.115)
Total bandwidth = no. of subcarriers × Δf
= 5 GHz.
(9.116)
Spectral efficiency = total data rate
total bandwidth
= 12 b/s/Hz.
(9.117)
Exercises
9.1
In a polarization-multiplexed WDM system, number of channels = 20, total data rate = 2 Tb/s, and
spectral efficiency = 4 b/s/Hz. Calculate the channel spacing.
(Ans: 25 GHz.)
9.2
In a polarization-multiplexed WDM system based on NRZ-OOK, the first null of the NRZ spectrum
occurs at f0 = 40 GHz. WDM signal bandwidth = 34.3 nm. The channel spacing = 2.5f0 and spectral
efficiency = 0.2 b/s/Hz. Calculate (a) the number of channels and (b) the total data rate.
(Ans: (a) 43, (b) 0.86 Tb/s.)
9.3
A polarization-multiplexed WDM signal is transmitted over a 60-km-long fiber. Number of channels
= 20, fiber loss = 0.18 dB/km, channel spacing = 100 GHz, signal in each channel band-limited to
40 GHz. If the total power at the fiber output is −12.8 dBm, find the signal power/channel/polarization
at the fiber output.
(Ans: 0.0158 mW.)
9.4
Explain the operating principles of an AWG multiplexer/demultiplexer.
9.5
In a WDM system, an AWG is used to demultiplex two channels. Find the length difference Δl of the
adjacent single-mode waveguides such that the corresponding phase-shift difference is 10𝜋. Assume
𝛽0 = 5.8 × 106 m−1.
(Ans: 5.416 μm.)

416
Fiber Optic Communications
9.6
Explain the difference between WDM and OFDM systems.
9.7
In a polarization-multiplexed optical OFDM system, there are 256 subcarriers and each subcarrier is
modulated by QAM-16 data. OFDM symbol period = 81.92 ns and fiber dispersion 𝛽2 = −22 ps2/km.
The optical OFDM signal needs to be transmitted over a distance of 1000 km. Find (a) the minimum
guard interval to ensure carrier orthogonality and (b) the total data rate.
(Ans: (a) 0.4319 ns, (b) 25 Gb/s.)
9.8
Discuss the significance of the cyclic prefix.
9.9
A polarization-multiplexed OFDM signal is transmitted over a 50-km-long fiber. Total OFDM band-
width = 2.5 GHz, fiber loss = 0.19 dB/km, OFDM symbol period = 204.8 ns. If the total power at the
fiber output is −13 dBm, find the signal power/subcarrier/polarization at the transmitter.
(Ans: 4.362 × 10−4 mW.)
9.10
In a polarization-multiplexed optical OFDM system, there are 128 subcarriers and each carrier is mod-
ulated by QAM-16 data. It is desired that the guard interval should not exceed 5% of the OFDM symbol
period and the carrier orthogonality should be preserved over a distance of 500 km. Calculate (a) the
OFDM symbol period and (b) the spectral efficiency. Assume 𝛽2 = −22 ps2/km.
(Ans: (a) 13.302 ns, (b) 8 b/s/Hz.)
9.11
Write a computer program to simulate the polarization-multiplexed OFDM system with the following
parameters: total data rate = 28 Gb/s, modulation = QPSK, transmission distance = 1000 km, ampli-
fier spacing = 100 km, fiber loss = 0.18 dB/km, fiber dispersion 𝛽2 = −22 ps2/km. The guard interval
should not exceed 6% of the OFDM symbol period. Choose the OFDM symbol period such that car-
rier orthogonality is preserved. Assume that Mach–Zehnder modulators operating in the linear regime
are used and ignore fiber nonlinearity and amplifier noise. Plot the OFDM symbol in the time and
frequency domain at the fiber-optic link input and at the receiver after DFT.
9.12
Develop an optical TDM scheme to multiplex four 25-Gb/s data streams into a single 100-Gb/s data
stream. Explain how the TDM signal can be demultiplexed at the receiver.
References
[1] ITU-T-694.1, Spectral grids for WDM applications: DWDM freq-grid. ITU-T website.
[2] H. Toba et al., Electron. Lett., vol. 23, p. 788, 1987.
[3] K. Oda et al., IEEE Photon. Technol. Lett., vol. 1, p. 137, 1989.
[4] B.H. Verbeek et al., J. Lightwave Technol., vol. 6, p. 1011, 1988.
[5] N. Takato et al., IEEE J. Select. Top. Comm., vol. 8, p. 1120, 1990.
[6] H. Ishio, J. Minowa, and K. Nosu, J. Lightwave Technol., vol. 2, p. 448, 1984.
[7] G.P. Agrawal, Fiber-Optic Communication System, 4th edn. John Wiley & Sons, Hoboken, NJ, 2010.
[8] M.K. Smit, Electron. Lett., vol. 29, p. 285, 1988.
[9] A.R. Vellekoop and M.K. Smit, J. Lightwave Technol., vol. 9, p. 310, 1991.
[10] A.R. Vellekoop and M.K. Smit, J. Lightwave Technol., vol. 8, p. 118, 1990.
[11] H. Bissessur et al., Electron. Lett., vol. 30, p. 336, 1994.
[12] L.H. Spiekman et al., J. Lightwave Technol., vol. 14, p. 991, 1996.
[13] N.S. Bergano and C.R. Davidson, J. Lightwave Technol., vol. 14, p. 1299, 1996.

Channel Multiplexing Techniques
417
[14] G. Charlet et al., Optical Fiber Communication Conference/National Fiber Optic Engineers Conference, PDP B6,
2009.
[15] J. Yu et al., European Conference on Optical Communications (ECOC), vol. 7–27, Th.3.E2, 2008.
[16] X. Zhou et al., Optical Fiber Communication Conference (OFC), PDP B4, 2009.
[17] W. Shie and C. Athaudage, Electron. Lett., vol. 42, p. 587, 2006.
[18] A.J. Lowery and J. Armstrong, Opt. Expr., vol. 14, p. 2079, 2006.
[19] I.B. Djordjevic and B. Vasic, Opt. Expr., vol. 14, p. 3767, 2006.
[20] A.J. Lowery, S. Wang, and M. Premaratne, Opt. Expr., vol. 15, p. 13,282, 2007.
[21] A.J. Lowery, Opt. Expr., vol. 15, p. 12,965, 2007.
[22] A.J. Lowery, J. Lightwave Technol., vol. 25, p. 131, 2007.
[23] H. Bao and W. Shieh, Opt. Expr., vol. 15, p. 4410, 2007.
[24] W. Shieh, H. Bao, and Y. Tang, Opt. Expr., vol. 16, p. 841, 2008.
[25] S.L. Jansen, I. Morita, T.C.W. Schenk, N. Takeda, and H. Tanaka, J. Lightwave Technol., vol. 26, p. 6, 2008.
[26] L.B. Du and A.J. Lowery, Opt. Expr., vol. 16, p. 19,920, 2008.
[27] W. Shie, Q. Yang, and Y. Ma, Opt. Expr., vol. 16, p. 6378, 2008.
[28] J. Armstrong, J. Lightwave Technol., vol. 27, p. 189, 2009.
[29] Q. Yang, Y. Tang, Y. Ma, and W. Shieh, J. Lightwave Technol., vol. 27, p. 168, 2009.
[30] Q. Yang, S. Chen, Y. Ma, and W. Shieh, Opt. Expr., vol. 17, p. 7985, 2009.
[31] X. Yi, W. Shie, and Y. Ma, J. Lightwave Technol., vol. 26, p. 1309, 2008.
[32] S.L. Jansen, I. Morita, T.C.W. Schenk, and H. Tanaka, J. Lightwave Technol., vol. 27, p. 177, 2009.
[33] X. Yi, W. Shie, and Y. Tang, IEEE Photon. Technol. Lett., vol. 19, p. 919, 2007.
[34] R.W. Chang, Orthogonal frequency multiplex data transmission, US patent 3,488,445, 1966.
[35] J. Salz and S.B. Weinstein, Fourier transform communication system. In Proceedings of ACM Symposium on Prob-
ability Optimization in Data Communication Systems, Pine Mountain, GA, 1969.
[36] S.B. Weinstein and P.M. Ebert, Data transmission by FDM using discrete Fourier transform. IEEE Trans. Comm.
Tech., vol. COM-19, 1971.
[37] A. Peled and A. Ruiz, Proc. ICASSP 80, Denver, CO, Vol. III, pp. 964–967, 1980.
[38] W. Shieh and I. Djordjevic, OFDM for Optical Communications. Academic Press, New York, 2010.
[39] A. Li, X. Chen, and W. Sheih, J. Lightwave Technol., vol. 30, p. 3931, 2012.
[40] H. Takahashi et al., J. Lightwave Technol., vol. 28, p. 406, 2010.
[41] T. Lotz et al., J. Lightwave Technol., vol. 31, p. 538, 2013.
[42] S. Chen, Y. Ma, and W. Shieh, IEEE Photon. J., vol. 2, p. 454, 2010.
[43] D.M. Spirit, A.D. Ellis, and P.E. Barnsley, IEEE Commun., vol. 32, p. 56, 1994.
[44] S. Kawanishi et al., Electron. Lett., vol. 32, p. 470, 1996.
[45] S. Kawanishi et al., Electron. Lett., vol. 32, p. 916, 1996.
[46] H. Anis et al., European Conference on Optical Communication (ECOC), vol. I, p. 230, 1999.
[47] A.H. Gnauck et al., IEEE Photon. Technol. Lett., vol. 15, p. 1618, 2003.


10
Nonlinear Effects in Fibers
10.1
Introduction
So far, we have treated the fiber optic system as a linear system, but it is actually a nonlinear system because
the refractive index of the fiber changes with the intensity of signal due to the Kerr and Raman effects. In
Section 10.2, the origin of linear and nonlinear refractive indices and the Kerr effect are discussed. Since the
change in refractive index due to the Kerr effect translates into a phase shift, the signal phase is modulated
by its power distribution, which is known as self-phase modulation (SPM). SPM leads to spectral broaden-
ing and the exact balance between dispersion and SPM leads to soliton formation. A soliton is a pulse that
propagates without any change in shape over long distances. Sections 10.3–10.6 present the effects of dis-
persion, SPM, and soliton formation. In WDM systems, several channels co-propagate down the fiber. The
phase of a signal in a channel is modulated not only by its channel power, but also by other channels, which
is known as cross-phase modulation (XPM). In addition, nonlinear interaction among two or more chan-
nels leads to four-wave mixing (FWM), which acts as noise on channels. The impact of XPM and FWM on
the system performance of a WDM system is discussed in Section 10.7. In a high-bit-rate highly dispersive
single-channel system, signal pulses overlap strongly in the time domain, leading to intra-channel four-wave
mixing (IFWM) and intra-channel cross-phase modulation (IXPM). These intrachannel nonlinear effects are
discussed in Sections 10.8–10.10. The propagation of a high-intensity optical pulse leads to an instanta-
neous as well as a delayed change in refractive index. The instantaneous response is responsible for the Kerr
effect, while the delayed response is associated with the Raman effect. Section 10.11 is devoted to the stimu-
lated Raman effect, which is responsible for the amplification of a low-frequency signal by a high-frequency
intense pump.
10.2
Origin of Linear and Nonlinear Refractive Indices
In a dielectric medium, light travels at a speed lower than that in free space. This can be understood
qualitatively as follows. The electric field of the light wave acts on an electron, making it oscillate in
accordance with Coulomb’s law. An oscillating charge acts as a tiny antenna which radiates electromagnetic
radiation at a frequency the same as that of the incident wave in a linear approximation. The newly generated
electromagnetic field is the same as the incident field, except for a phase shift. In other words, absorption of
the incident field by a molecule and re-radiation delays the propagation of light compared with free-space
propagation. The exact determination of the displacement of electrons due to the electric field of a light
wave is a complicated problem of quantum mechanics. Instead, we use a classical electron oscillator model
in which the electron is modeled as a charged cloud surrounding the nucleus, as shown in Fig. 10.1(a) [1].
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

420
Fiber Optic Communications
Electron charge cloud
Nucleus
x
Ex
(a)
(b)
Figure 10.1
Classical electron oscillator model: (a) in equilibrium; (b) in the presence of an external field.
When an external electric field intensity Ex is applied to an atom, the electron charge cloud is displaced
from its equilibrium position, as shown in Fig. 10.1(b). The equation of motion for the center of the electron
charge cloud is given by Newton’s law,
md2x
dt2 = Fext = qeEx,
(10.1)
where x(t) is the displacement of the center of the electron charge cloud, m is the electron mass, and qe
is the electron charge. When the center of the electron cloud moves away from the equilibrium position
(Fig. 10.1(b)), there is a force of attraction between the nucleus and the electron charge cloud. If the displace-
ment x(t) is small, the restoration force can be approximated as
Frestoration = −Kx,
(10.2)
where K is a constant. The negative sign indicates that the restoration force acts in a direction opposite to
the external force. The situation is similar to the case of a simple pendulum pushed away from the equilib-
rium position by an external force; there is a restoration force due to gravitation which pulls it back to the
equilibrium position. The net force acting on the electron is given by
Fnet = Fext + Frestoration = qeEx −Kx.
(10.3)
Combining Eq. (10.3) with Newton’s law, we obtain
md2x
dt2 = Fnet = qeEx −Kx
(10.4)
or
d2x
dt2 + 𝜔2
0x =
(qe
m
)
Ex,
(10.5)
where 𝜔0 = (K∕m)1∕2 is the natural frequency of oscillation. Suppose the applied field is of the form
Ex = E0 exp (−i𝜔t).
(10.6)

Nonlinear Effects in Fibers
421
We expect that the displacement x(t) should also change harmonically in the steady state and try a trial solution
x(t) = B exp (−i𝜔t).
(10.7)
Substituting Eqs. (10.7) and (10.6) into Eq. (10.5), we obtain
B =
E0qe
m(𝜔2
0 −𝜔2)
(10.8)
and
x(t) =
qe
m(𝜔2
0 −𝜔2)
Ex.
(10.9)
The dipole moment of an atom is defined as
px = qex =
q2
e
m(𝜔2
0 −𝜔2)
Ex.
(10.10)
In general,
p =
q2
e
m(𝜔2
0 −𝜔2)
E.
(10.11)
Our next step is to determine the electromagnetic field generated by the oscillating electron charge cloud.
Each atom acts as a current source since the oscillating electron cloud can be imagined as a tiny current
element. One of Maxwell’s equations in the presence of a current source is (Eq. (1.47))
∇× H = J + 𝜖0
𝜕E
𝜕t .
(10.12)
Consider an incremental volume dV = Adx of an atomic system as shown in Fig. 10.2. Using Eq. (10.10), the
current I is given by
I = dq
dt = dq
dx
dx
dt = 1
qe
dq
dx
dpx
dt .
(10.13)
Let N be the number of atoms per unit volume. The charge in volume dV is
dq = qeN dV = qeN Adx
(10.14)
or
dq
dx = qeNA.
(10.15)
Using Eq. (10.15) in Eq. (10.13), we obtain
I = NAdpx
dt .
(10.16)
Since Jx = I∕A, we obtain
Jx = N dpx
dt .
(10.17)
In general,
J = N dp
dt .
(10.18)

422
Fiber Optic Communications
dx
Area A
Figure 10.2
A slice of atomic system consisting of N atoms per unit volume.
If we define P = Np as the polarization, Eq. (10.18) can be written as
J = dP
dt .
(10.19)
From Eq. (10.11), it follows that
P =
Nq2
e
m(𝜔2
0 −𝜔2)
E.
(10.20)
Polarization is directly proportional to electric field intensity, and is often written as
P = 𝜖0𝜒(1)E,
(10.21)
where 𝜖0𝜒(1) is known as the first-order susceptibilty or linear susceptibility. Comparing Eqs. (10.20) and
(10.21), we find
𝜒(1) =
Nq2
e
m(𝜔2
0 −𝜔2)𝜖0
.
(10.22)
Substituting Eq. (10.19) in Eq. (10.12), we find
∇× H = 𝜕(𝜖0E + P)
𝜕t
.
(10.23)
If we define the electric flux density D as
D = 𝜖0E + P,
(10.24)
Eq. (10.23) becomes
∇× H = 𝜕D
𝜕t ,
(10.25)
which is the same as Maxwell’s equation in a medium (Eq. (1.51)) in the absence of current source. In fact,
the induced current and charge due to applied electromagnetic field are taken into account by using electric

Nonlinear Effects in Fibers
423
flux density D instead of 𝜖0E in Maxwell’s equations for free space. Substituting Eq. (10.21) in Eq. (10.24),
we obtain
D = 𝜖0
[1 + 𝜒(1)] E.
(10.26)
In Section 1.2, we defined the electric flux density as
D = 𝜖0𝜖rE.
(10.27)
Therefore, the relative permittivity is
𝜖r = 1 + 𝜒(1).
(10.28)
Since the relative permittivity and refractive index are related by n2 = 𝜖r, we obtain the result
n2 = 1 + 𝜒(1) = 1 +
Nq2
e
m𝜖0(𝜔2
0 −𝜔2)
.
(10.29)
From Eq. (10.29), we see that the refractive index is dependent on the frequency of the incident electromag-
netic signal. This is known as chromatic dispersion. In free space, n = 1 for all frequencies and the medium
is not dispersive. In a dispersive medium, suppose 𝜔< 𝜔0. As 𝜔increases (with 𝜔< 𝜔0), the denominator
of Eq. (10.29) decreases and the refractive index increases with frequency. This explains why a prism bends
light more at the violet end than the red end of the visible spectrum.
10.2.1
Absorption and Amplification
From Eq. (10.9), when 𝜔0 = 𝜔, we see that the displacement becomes infinite, which is unphysical. This
is because we ignored the loss effects. The situation is similar to that of an oscillating simple pendulum in
which the oscillations decrease with time due to frictional forces that carry away the energy. In the case of
an electron cloud, its vibration leads to the generation of electromagnetic waves that carry away the energy
and as a result, the vibration is damped. There are also other reasons for the dissipation of energy, such as
collision between atoms. Mathematical modeling of the vibrating electron cloud should include a damping
force of the form
Fdamp = −rdx
dt ,
(10.30)
to account for energy dissipation. Here, r is the damping coefficient. When this force is included, the equation
of motion (Eq. (10.5)) is modified as
md2x
dt2 + rdx
dt + Kx = qeEx,
(10.31)
Assuming that the applied electric field intensity is of the form given by Eq. (10.6) and proceeding as before,
the expression for the displacement is
x(t) =
qeEx
m(𝜔2
0 −𝜔2 −ir𝜔∕m)
.
(10.32)
Using Eq. (10.32), the polarization becomes
P =
Nq2
eE
m(𝜔2
0 −𝜔2 −ir𝜔∕m)
(10.33)

424
Fiber Optic Communications
and
n2 = 1 +
Nq2
e
m(𝜔2
0 −𝜔2 −ir𝜔∕m)
(10.34)
= (nr + ini)2,
(10.35)
where nr = Re(n) and ni = Im(n). From Eq. (10.34), we see that the refractive index becomes complex in the
presence of damping force. The forward-propagating plane wave solution takes the form (Eq. (1.95))
Ex = E0 exp [−𝛼z∕2 −i(𝜔t −𝜔nrz∕c)],
(10.36)
where
𝛼= 2𝜔ni
c
.
(10.37)
When atoms absorb electromagnetic energy (which is used to increase the internal energy of the atomic
system), 𝛼> 0 and the incident electromagnetic signal is attenuated. If the atoms transfer energy to the elec-
tromagnetic signal due to a mechanism such as stimulated emission (see Chapter 3), 𝛼becomes negative and
the incident electromagnetic signal is amplified.
10.2.2
Nonlinear Susceptibility
So far we have assumed that the restoration force is proportional to the displacement of the electron cloud
(Eq. (10.2)), which leads to harmonic oscillation of the electron cloud when the incident electromagnetic
field is harmonic (Eq. (10.6)). This holds true when the incident field is weak. As the incident electromag-
netic field becomes intense, the assumption of the linear dependence of the restoration force on displacement
breaks down and in this case, electron cloud oscillation is not harmonic. As a result, the generated electro-
magnetic field is also not harmonic. When the incident electromagnetic field is weak, we have found that
polarization is directly proportional to incident electric field intensity (Eq. (10.21)),
P = 𝜖0𝜒(1)E.
(10.38)
If the medium is not isotropic, the susceptibility depends on direction as well and Eq. (10.38) is modified as
Pj = 𝜒(1)
jx Ex + 𝜒(1)
jy Ey + 𝜒(1)
jz Ez,
j = x, y, z
(10.39)
or
P = 𝜖0𝛘(1).E.
(10.40)
Here, 𝛘(1) is a 3 × 3 matrix and . denotes matrix multiplication. However, as the incident field becomes strong,
the linear dependence does not hold true and P becomes a function of E. In general, P can be expanded in
terms of increasing powers of E,
P = 𝜖0𝛘(1) ⋅E + 𝜖0𝛘(2) ∶EE + 𝜖0𝛘(3)⋮EEE + … ,
(10.41)
where 𝛘(j) is the jth-order susceptibility and is a tensor of rank j + 1. The first-order susceptibility 𝛘(1) is
related to the linear refractive index (Eq. (10.29)). The second-order susceptibility 𝛘(2) is responsible for
second harmonic generation; if the incident optical wave is sinusoidal of frequency 𝜔, a new optical wave of
frequency 2𝜔is generated. Anharmonic oscillation of the electron cloud due to intense electromagnetic field
can be expanded as a Fourier series with frequency components 𝜔, 2𝜔, … , n𝜔, and electron cloud oscillations

Nonlinear Effects in Fibers
425
at frequency 2𝜔lead to the generation of an electromagnetic wave at 2𝜔. Crystals such as quarts have no center
of symmetry and, therefore, they have a nonzero 𝛘(2) coefficient. In the case of optical glass fibers, SiO2
(silica) is a symmetric molecule and 𝛘(2) is zero. Therefore, second harmonic generation does not normally
occur in optical fibers. The third-order susceptibility 𝛘(3) is responsible for third harmonic generation and the
Kerr effect.
Suppose the incident electromagnetic field has only Ex and Hy components. For a centrally symmetric
dielectric material, the tensor equation (10.41) can be simplified to obtain
Px = 𝜖0𝜒(1)
xx Ex + 𝜖0𝜒(3)
xxxxE3
x,
(10.42)
where 𝜒(3)
xxxx is a component of the fourth-rank tensor 𝛘(3). Suppose the incident optical field is a monochro-
matic wave,
Ex = E0 exp (−i𝜔t).
(10.43)
To find E3
x, as pointed out in Section 1.6.2, we should first take the real part of Ex,
Re[Ex] = 1
2[E0 exp (−i𝜔t) + E∗
0 exp (i𝜔t)],
(10.44)
{Re[Ex]}3 = 1
8{E3
0 exp (−3i𝜔t) + E∗3
0 exp (3i𝜔t)
+ 3|E0|2[E0 exp (−i𝜔t) + E∗
0 exp (i𝜔t)]}.
(10.45)
From Eqs. (10.42) and (10.45), we find that the incident field oscillating at frequency 𝜔leads to a component
of polarization oscillating at frequency 3𝜔, which is responsible for third harmonic generation. The electro-
magnetic wave at frequency 3𝜔becomes significant only when special phase-matching techniques are used.
Otherwise, the component of polarization at frequency 3𝜔can be ignored. Hence, we ignore the first two
terms on the right-hand side of Eq. (10.45).
Let the polarization at frequency 𝜔be
Px = P0 exp (−i𝜔t),
(10.46)
Re[Px] = 1
2[P0 exp (−i𝜔t) + P∗
0 exp (i𝜔t)].
(10.47)
From Eq. (10.42), we have
Re[Px] = 𝜖0𝜒(1)
xx Re[Ex] + 𝜖0𝜒(3)
xxxxRe[Ex]3,
(10.48)
where the imaginary parts of the susceptibility are ignored. Substituting Eqs. (10.44) and (10.45) into
Eq. (10.48), collecting the terms that are proportional to exp (−i𝜔t), and comparing it with Eq. (10.47), we
obtain
P0 = 𝜖0
(
𝜒(1)
xx + 3||E0||
2
4
𝜒(3)
xxxx
)
E0 = 𝜖0𝜒effE0,
(10.49)
where 𝜒eff is the effective susceptibility that includes both linear and nonlinear susceptibilities. From Eq.
(10.29), in the absence of nonlinearity, we have n2 = 1 + 𝜒(1)
xx . Now, we modify it as
n2 = 1 + 𝜒eff = 1 + 𝜒(1)
xx + 3|E0|2
4
𝜒(3)
xxxx
(10.50)
= n2
0 + 3|E0|2
4
𝜒(3)
xxxx,
(10.51)

426
Fiber Optic Communications
where n0 is the linear refractive index and the second term of Eq. (10.51) represents the nonlinear contribution
to the refractive index. Typically, the nonlinear part of the refractive index is much smaller than the linear part.
From Eq. (10.51), we have
n = n0
(
1 + 3||E0||
2
4n2
0
𝜒(3)
xxxx
)1∕2
≅n0 + n2|E0|2,
(10.52)
where
n2 = 3𝜒(3)
xxxx
8n0
(10.53)
is called the Kerr coefficient. In Eq. (10.52), we have used the following approximation:
(1 + x)1∕2 ≈1 + x∕2,
if x ≪1,
(10.54)
which is valid since the nonlinear part of the refractive index is much smaller than its linear part. From
Eq. (10.52), we see that the change in refractive index (n −n0) is directly proportional to the optical intensity
|E0|2. This effect is called the Kerr effect.
For silica, n2 ≈3 × 10−20 m2/W. If a light beam of intensity 1 W/m2 is incident on silica media of
cross-sectional area 1 m2, the change in refractive index is 3 × 10−20, which is very small. However, silica
fiber has an effective cross-sectional area of 100 μm2 or less, and the change in refractive index due to the
Kerr effect is comparable with the variations in refractive index due to dispersion, leading to interesting
nonlinear phenomena such as soliton formation.
10.3
Fiber Dispersion
As mentioned in Chapter 2, a pulse propagating in a fiber broadens due to fiber dispersion. When the fiber
nonlinear effects are ignored, the complex field envelope in a field is given by Eqs. (2.119) and (2.107) as
̃q(𝜔, z) = ̃q(𝜔, 0)e−𝛼z∕2+i𝛽1𝜔z+i𝛽2𝜔2z∕2.
(10.55)
Differentiating Eq. (10.55) with respect to z, we find
𝜕̃q(𝜔, z)
𝜕z
= ̃q(𝜔, z)
(
−𝛼
2 + i𝛽1𝜔+ i𝛽2𝜔2)
.
(10.56)
Since
−1{(−i𝜔)ñq(𝜔, z)} = 𝜕nq(t, z)
𝜕tn
,
(10.57)
taking the inverse Fourier transform of Eq. (10.56), we find
𝜕q(t, z)
𝜕z
= −𝛼
2 q(t, z) −𝛽1
𝜕q(t, z)
𝜕t
−i𝛽2
2
𝜕2q(t, z)
𝜕t2
.
(10.58)
As mentioned in Chapter 2, the term exp (i𝛽1𝜔z) of Eq. (10.55) introduces a constant time shift due to propa-
gation and it could be dropped as we are primarily interested in assessing the quality of the signal at the fiber
output. Let
Z = z,
(10.59)
T = t −𝛽1z.
(10.60)

Nonlinear Effects in Fibers
427
Note that (t, z) are the coordinates of an optical impulse with the origin (0, 0) at the transmitter. If a receiver
is placed at Z = z, T denotes the time at the receiver if the receiver clock is shifted from the transmitter clock
by the time of flight 𝛽1z. Since Z and T are functions of z and t, we have
𝜕T
𝜕t = 1,
𝜕T
𝜕z = −𝛽1,
(10.61)
𝜕Z
𝜕t = 0,
𝜕Z
𝜕z = 1,
(10.62)
𝜕q
𝜕z = 𝜕q
𝜕Z
𝜕Z
𝜕z + 𝜕q
𝜕T
𝜕T
𝜕z
= 𝜕q
𝜕Z ⋅1 + 𝜕q
𝜕T (−𝛽1),
(10.63)
𝜕q
𝜕t = 𝜕q
𝜕Z
𝜕Z
𝜕t + 𝜕q
𝜕T
𝜕T
𝜕t
= 𝜕q
𝜕T ⋅1,
(10.64)
𝜕2q
𝜕t2 = 𝜕
𝜕Z
(𝜕q
𝜕t
)
𝜕Z
𝜕t + 𝜕
𝜕T
( 𝜕q
𝜕T
)
𝜕T
𝜕t
= 𝜕2q
𝜕T2 .
(10.65)
Substituting Eqs. (10.63)–(10.65) in Eq. (10.58), we find
𝜕q(T, Z)
𝜕Z
+ 𝜕q(T, Z)
𝜕T
(−𝛽1) = −𝛼
2 q(T, Z) −𝛽1
𝜕q(T, Z)
𝜕T
−i𝛽2
2
𝜕2q(T, Z)
𝜕T2
or
i 𝜕q
𝜕Z −𝛽2
2
𝜕2q
𝜕T2 = −i𝛼q
2 .
(10.66)
Eq. (10.66) describes the propagation of the optical field envelope in a fiber when the nonlinear effects are
ignored. Eq. (10.66) is equivalent to Eq. (10.56). For a Gaussian input, the output electric field envelope is
given by Eq. (2.158),
q(T, Z) =
√
P0T0
T1
exp
(
−T2
2T2
1
)
,
(10.67)
T1 = (T2
0 −i𝛽2Z)1∕2.
(10.68)
Let
T1 = |T1| exp (i𝜃1),
(10.69)
where
|T1|2 = (T4
0 + 𝛽2
2Z2)1∕2,
(10.70)
𝜃1 = −1
2tan−1
(
𝛽2Z
T2
0
)
.
(10.71)

428
Fiber Optic Communications
Eq. (10.67) may be rewritten as
q(T, Z) = A(Z, T)ei𝜃(T,Z)
=
√
P0T0
|T1|ei𝜃1 exp
[
−
T2 (T2
0 + i𝛽2Z)
2(T4
0 + 𝛽2
2Z2)
]
,
(10.72)
A(T, Z) =
√
P0T0
|T1|
exp
[
−
T2T2
0
2 (T4
0 + 𝛽2
2Z2)
]
,
(10.73)
𝜃(T, Z) = −𝜃1(Z) −
T2𝛽2Z
2(T4
0 + 𝛽2
2Z2)
,
(10.74)
The instantaneous power is
P(T, Z) = A2(T, Z) =
P0T2
0
|T1|2 exp
[
−
T2T2
0
|T1|4
]
,
(10.75)
and the instantaneous frequency is (see Eq. (2.165))
𝛿𝜔(T) = −𝜕𝜃
𝜕T =
T𝛽2Z
(T4
0 + 𝛽2
2Z2)
.
(10.76)
The negative sign is chosen because the carrier wave is exp (−i𝜔0t). The actual instantaneous frequency is
𝜔0 + 𝛿𝜔.
The instantaneous power P(T, Z) and instantaneous frequency 𝛿𝜔are plotted in Fig. 2.32 for an anomalous
dispersion fiber (𝛽2 < 0). From Eq. (10.76) and Fig. 10.3, when 𝛽2 < 0, we see that near the leading edge
(T < 0) 𝛿𝜔is positive (blue shift) whereas it is negative (red shift) near the trailing edge (T > 0). These
changes in frequency occur continuously as the signal propagates down the fiber. Since the blue components
travel faster than the red components in the anomalous dispersion fiber, the frequency components near the
leading edge arrive early and the frequency components near the trailing edge arrive late. This explains why
the pulse is broadened at the fiber output. For a fiber with normal dispersion, the situation is exactly opposite.
10.4
Nonlinear Schrödinger Equation
Owing to the Kerr effect, an optical signal undergoes a phase shift that is proportional to the signal power as
given by Eq. (10.52). If this nonlinear effect is included, Eq. (10.58) is modified as (see Appendix B)
i
(𝜕q
𝜕z + 𝛽1
𝜕q
𝜕t
)
−𝛽2
2
𝜕2q
𝜕t2 + 𝛾|q|2q = −i𝛼q
2 ,
(10.77)
where 𝛾is the nonlinear coefficient related to the Kerr coefficient n2 by (Appendix B)
𝛾= n2𝜔0
cAeff
,
(10.78)
where Aeff is the effective area of the fiber mode. Using the frame of reference that moves with the group
speed of the pulse,
T = t −𝛽1z,
(10.79)
Z = z,
(10.80)

Nonlinear Effects in Fibers
429
–1500
–1000
–500
0
500
1000
1500
–0.1
–0.08
–0.06
–0.04
–0.02
0
0.02
0.04
0.06
0.08
0.1
Time, T (ps)
Electrical field (arb. units)
Blue shift
Red shift
Figure 10.3
The electric field distribution at the fiber output. The broken line shows the field envelope and the rapid
oscillation shows the actual field. 𝛽2 < 0.
Eq. (10.77) becomes
i 𝜕q
𝜕Z −𝛽2
2
𝜕2q
𝜕T2 + 𝛾|q|2q = −i𝛼q
2 .
(10.81)
Eq. (10.81) is known as the nonlinear Schrödinger equation (NLSE); it is of significant importance in mod-
eling fiber-optic transmission systems and can not be solved analytically for arbitrary inputs. Numerical
techniques such as the split-step Fourier scheme (SSFS) are used to solve the NLSE (see Chapter 11).
Example 10.1
The Kerr coefficient of a single-mode fiber is 2.5 × 10−20 m2∕W. Its effective area is 80 μm2. Find the non-
linear coefficient 𝛾at the wavelength 1550 nm.
Solution:
From Eq. (10.78), we have
𝛾= n2𝜔0
cAeff
= n22𝜋f0
cAeff
= 2𝜋n2
𝜆0Aeff
,
(10.82)
𝛾=
2𝜋× 2.5 × 10−20
1550 × 10−9 × 80 × 10−12 W−1 m−1
= 1.26 × 10−3 W−1 m−1.
(10.83)

430
Fiber Optic Communications
10.5
Self-Phase Modulation
To find the impact of fiber nonlinearity acting alone, let us ignore 𝛽2. To solve Eq. (10.81) under this condition,
we separate the amplitude and phase,
q = Aei𝜃.
(10.84)
Substituting Eq. (10.84) into Eq. (10.81), we find
i
[𝜕A
𝜕Z + i 𝜕𝜃
𝜕Z A
]
= −
[
𝛾A2 + i𝛼
2
]
A.
(10.85)
Separating real and imaginary parts, we obtain
𝜕A
𝜕Z = −𝛼
2 A
(10.86)
or
A(T, Z) = A(T, 0) exp (−𝛼Z∕2),
(10.87)
𝜕𝜃
𝜕Z = 𝛾A2(T, Z) = 𝛾A2(T, 0)e−𝛼Z.
(10.88)
Let the fiber length be L. Integrating Eq. (10.88) from 0 to L, we obtain
𝜃(T, L) = 𝜃(T, 0) + 𝛾A2(T, 0) ∫
L
0
e−𝛼ZdZ
= 𝜃(T, 0) + 𝛾A2(T, 0)Leff,
(10.89)
where
Leff = 1 −exp (−𝛼L)
𝛼
.
(10.90)
Substituting Eqs. (10.87) and (10.89) into Eq. (10.84), we find
q(T, L) = A(T, L)ei𝜃(T,L)
= A(T, 0)e−𝛼L∕2ei[𝜃(T,0)+𝛾A2(T,0)Leff]
= q(T, 0)e−𝛼L∕2+i𝛾|q(T,0)|2Leff,
(10.91)
where
q(T, 0) = A(T, 0)ei𝜃(T,0).
(10.92)
Here, |q(T, 0)|2 represents the instantaneous power at the input. Since the phase of the optical signal is mod-
ulated by its own power distribution, this effect is known as self-phase modulation (SPM). From Eq. (10.91),
we find that
|q(T, L)| = |q(T, 0)|e−𝛼L∕2.
(10.93)
So, the amplitude of the signal decreases exponentially with distance, but the pulse width at the fiber output
remains the same as that at the fiber input. However, the spectral width at the output is larger than that at the
input. This is because the nonlinear mixing of the input frequency components due to SPM generates new
frequency components. Using Eq. (10.89), the instantaneous frequency at L is
𝛿𝜔(T, L) = −d𝜃(T, L)
dT
= −d𝜃(T, 0)
dT
−𝛾Leff
d|q(T, 0)|2
dT
.

Nonlinear Effects in Fibers
431
–300
–200
–100
0
100
200
300
–10
0
10
20
30
40
Time, T (ps)
Power (mw)
–20
0
20
40
60
80
100
120
140
δω/2π (GHz)
Figure 10.4
Power and instantaneous frequency at the fiber output.
Suppose the input field envelope is given by
q(T, 0) =
√
P exp (−T2∕2T2
0).
(10.94)
The instantaneous frequency at L is
𝛿𝜔(T) = 2𝛾PLeffT
T2
0
exp
(
−T2
T2
0
)
.
(10.95)
The instantaneous power and frequency at the fiber output are shown in Fig. 10.4. The instantaneous frequency
is negative (or less than the carrier frequency) near the leading edge, whereas it is positive near the trailing
edge. In other words, it is down-shifted in frequency (red shift) near the leading edge and up-shifted (blue
shift) near the trailing edge, as shown in Fig. 10.5.
Example 10.2
In a 1000-km fiber-optic link, it is desired that the peak nonlinear phase shift accumulated over the link
should be less than 0.5 rad. The system has the following parameters: loss coefficient 𝛼= 0.046 km−1, ampli-
fier spacing = 100 km, Kerr coefficient n2 = 2.5 × 10−20 m2∕W, 𝜆0 = 1550 nm, and peak power at the fiber
input = 0 dBm. Find the lower limit on the effective area of the fiber. Ignore 𝛽2.
Solution:
The peak nonlinear phase shift accumulated over a single span is given by Eq. (10.91),
𝜑NL = 𝛾LeffPpeak,
(10.96)

432
Fiber Optic Communications
Red shift
Blue shift
Time
Electrical field (arb. units)
Figure 10.5
Instantaneous electric field at the fiber output.
where Ppeak is the peak power and
Leff = 1 −exp (−𝛼L)
𝛼
,
(10.97)
𝛼= 0.046 km−1,
(10.98)
L = 100 km.
(10.99)
Leff = 21.52 km.
(10.100)
No. of spans = total length
amp. spacing
= 1000 km
100 km
= 10.
(10.101)
Total nonlinear phase shift = 10 𝜑NL.
(10.102)
Ppeak(dBm) = 0 dBm,
(10.103)
Ppeak = 10Ppeak(dBm)∕10 mW
= 1 mW,
(10.104)
10 𝜑NL < 0.5,
(10.105)
10 × 𝛾× 21.52 × 103 × 1 × 10−3 < 0.5,
𝛾< 2.32 × 10−3 W−1 m−1.

Nonlinear Effects in Fibers
433
From Eq. (10.78), we have
𝛾= n2𝜔0
cAeff
= 2𝜋n2
𝜆0Aeff
< 2.32 × 10−3 W−1 m−1,
(10.106)
Aeff >
2𝜋n2
𝜆0 × 2.32 × 10−3 m2,
(10.107)
Aeff > 43.61 μm2.
(10.108)
The effective area should be greater than 43.61 μm2 to have the peak nonlinear phase shift less than or equal
to 0.5 rad.
10.6
Combined Effect of Dispersion and SPM
First let us consider the case of a normal dispersion fiber. Fig. 10.6(a) shows the optical field at the fiber input.
Owing to SPM acting down, the instantaneous frequency near the trailing edge is higher than that near the
leading edge (see Fig. 10.5). Since the high-frequency (blue) components travel slower than the low-frequency
(red) components in a normal dispersion fiber, the trailing edge arrives late while the leading edge arrives early
at the fiber output. In other words, the combined effect of SPM and normal dispersion is to cause the pulse
broadening as shown in Fig. 10.6(b).
Next, let us consider the case of anomalous dispersion. Owing to SPM acting alone (see Fig. 10.5), the
leading edge is red-shifted (lower frequency) while the trailing edge is blue-shifted (higher frequency). Since
the high-frequency components travel faster than the low-frequency components in an anomalous disper-
sion fiber, the trailing edge arrives early whereas the leading edge arrives later, causing pulse compression.
Comparing Figs. 10.3 and 10.5, we see that the instantaneous frequency due to SPM and that due to anoma-
lous dispersion are of opposite sign. For a specific pulse shape and power level, we might expect that these
frequency shifts cancel exactly. Under this condition, the instantaneous frequency (relative to the carrier fre-
quency) across the pulse is zero (or a constant) and therefore, all parts of the pulse travel at the same speed,
–300
–200
–100
0
(a)
100
200
300
–0.2
–0.15
–0.1
–0.05
0
0.05
0.1
0.15
0.2
Time, T (ps)
Electrical field (arb. units)
–1500 –1000 –500
0
500
1000
1500
–0.1
–0.08
–0.06
–0.04
–0.02
0
0.02
0.04
0.06
0.08
0.1
Time, T (ps)
Electrical field (arb. units)
Red shift
Blue shift
(b)
Figure 10.6
Electric field intensity at (a) fiber input and (b) fiber output. 𝛽2 > 0.

434
Fiber Optic Communications
–500
0
500
–0.015
–0.01
–0.005
0
0.005
0.01
0.015
Electrical field (arb. units)
Time, T (ps)
Figure 10.7
Electric field intensity of a soliton. Solid and broken lines show the carrier and the field envelope,
respectively.
which implies that there is no change in pulse shape as it propagates down the fiber. Such a pulse is called a
soliton. A pulse can be called a soliton if and only if (i) it preserves its shape and (ii) when it collides with
another soliton or a pulse it comes out unscathed except for a phase shift. In this sense, the soliton mimics the
massive particles. The broken line in Fig. 10.7 shows the field envelope corresponding to a soliton. This pulse
shape does not change as the pulse propagates down a loss-less fiber. The instantaneous frequency across the
pulse remains constant as a function of T as well as Z.
A soliton is a normal mode of a special class of nonlinear systems which can be integrated by means of an
inverse scattering transform (IST) [2–6]. IST plays the role of a Fourier transform in a nonlinear system, and
sometimes it is called the nonlinear Fourier transform. The NLS equation is solved using an inverse scattering
transform to obtain soliton and breather solutions. The breathers or higher-order solitons undergo periodic
compression and expansion with a period which is known as the soliton period, whereas the fundamental
soliton propagates without any change in shape.
Even though the existence of optical solitons in fibers was theoretically predicted in 1973 [7], the exper-
imental verification only appeared in the early 1980s [8–10]. The analytical expression for the pulse shape
of a fundamental soliton can be calculated easily from the loss-less NLS equation without using an inverse
scattering transform. The phase of an optical soliton can change with propagation distance. Therefore, we
look for a solution of the form
q = g(T) exp [i𝜃(Z)].
(10.109)
When 𝛼= 0, substituting Eq. (10.109) into Eq. (10.81), we obtain
−kg −𝛽2
2
d2g
dT2 + 𝛾g3 = 0,
(10.110)
where k = d𝜃∕dZ. If k changes with T, this would imply that the instantaneous frequency is not a constant
and could lead to pulse broadening or compression. However, for the fundamental soliton, the pulse shape

Nonlinear Effects in Fibers
435
should not change as a function of Z and hence, we set k to be a constant. To solve Eq. (10.110), we multiply
Eq. (10.110) by dg∕dT and integrate from −∞to T to obtain
−k ∫
T
−∞
g dg
dT dT −𝛽2
2 ∫
T
−∞
d2g
dT2
dg
dT dT + 𝛾∫
T
−∞
g3 dg
dT dT = C,
(10.111)
−kg2 −𝛽2
4
( dg
dT
)2
+ 𝛾g4
4
= C,
(10.112)
where C is the constant of integration. To obtain Eq. (10.112), we have assumed that g(±∞) = 0. When
𝛽2 < 0, Eq. (10.112) can be rewritten as
dg
dT =
2
√
−𝛽2
[
C + kg2 −𝛾g4
4
]1∕2
(10.113)
or
∫
g
g0
dg
[
C + kg2 −𝛾g4
4
]1∕2 =
2
√
−𝛽2 ∫
T
0
dT,
(10.114)
where g0 = g(0). Using the table of integrals [11], Eq. (10.114) can be solved to give
g(T) =
𝜂
√𝛾
sech
(
𝜂T
√
−𝛽2
)
,
(10.115)
where 𝜂=
√
2k. Therefore, the total solution is
q =
𝜂
√𝛾
sech
(
𝜂T
√
−𝛽2
)
exp (i𝜂2Z∕2).
(10.116)
The above solution represents a fundamental soliton that propagates without any change in pulse shape. It
acquires a phase shift due to propagation that is proportional to the square of the amplitude.
Example 10.3
The FWHM of a fundamental soliton is 50 ps. Fiber dispersion coefficient 𝛽2 = −21 ps2/km, and nonlinear
coefficient 𝛾= 1.1 W−1 km−1. Calculate the peak power required to form a soliton. Ignore fiber loss.
Solution:
From Eq. (10.116), we have
P(t) = |q|2 = 𝜂2
𝛾sech2
(
𝜂T
√
−𝛽2
)
.
(10.117)
Let
𝜂2
𝛾= Ppeak,
(10.118)
√
−𝛽2
𝜂
= T0,
(10.119)

436
Fiber Optic Communications
P(t) = Ppeak sech2
(
T
T0
)
.
(10.120)
From Fig. 10.8, at t = Th, we find
P(Th) = 0.5Ppeak
= Ppeaksech2
(Th
T0
)
,
(10.121)
sech
(Th
T0
)
=
√
0.5,
(10.122)
Th = T0
sech−1(
√
0.5)
= 0.8813 T0,
(10.123)
TFWHM = 2Th = 1.763T0,
(10.124)
T0 =
50
1.763 ps = 28.37 ps.
(10.125)
Note that the peak power is proportional to 𝜂2 and the pulse width (FWHM) is inversely proportional to 𝜂.
Thus, for a soliton, as the peak power increases, its pulse width decreases.
From Eq. (10.119), we have
𝜂=
√
−𝛽2
T0
=
√
21 × 10−27
28.37 × 10−12 = 5.1 × 10−3 m−1∕2.
(10.126)
From Eq. (10.118), we find
Ppeak = 𝜂2
𝛾= (5.1 × 10−3)2
1.1 × 10−3
W
= 4.6 mW.
(10.127)
Ppeak
Th
Th
TFWHM
0.5 Ppeak
t
P(t)
Figure 10.8
FWHM of a soliton pulse.

Nonlinear Effects in Fibers
437
10.7
Interchannel Nonlinear Effects
So far we have considered the modulation of a single optical carrier. In a wavelength-division multiplexing
system (see Chapter 9), multiple carriers are modulated by electrical data and, in this case, the nonlinear
Schrödinger equation is valid if the total spectral width is much smaller than the reference carrier frequency.
Typically, the spectral width of a WDM signal is about 3 to 4 THz, which is much smaller than the carrier
frequency of 194 THz corresponding to the center of the erbium window. The total optical field may be
written as
Ψ =
N∕2−1
∑
n=−N∕2
qn(t, z)e−i(𝜔nt−𝛽nz),
(10.128)
where 𝜔n and qn(t, z) are the carrier frequency and the slowly varying envelope of the nth channel, respectively,
and N is the number of channels. Eq. (10.128) may be rewritten as
Ψ = qe−i(𝜔0t−𝛽0z),
(10.129)
where
q =
N∕2−1
∑
n=−N∕2
qn(t, z)e−i(Ωnt−𝛿nz)
(10.130)
and Ωn ≡𝜔n −𝜔0 is the relative center frequency of channel n with respect to a reference frequency 𝜔0,
which is usually chosen equal to the center of the signal spectrum (see Fig. 10.9); 𝛿n ≡𝛽n −𝛽0 is the relative
propagation constant.
When the total spectral width Δ𝜔≪𝜔0, the slowly varying envelope can be described by the NLSE,
Eq. (10.77). Substituting Eq. (10.130) in Eq. (10.77), we obtain
∑
n
{
i 𝜕qn
𝜕z −𝛿nqn + i𝛽1
𝜕qn
𝜕t + Ωn𝛽1qn −𝛽2
2
[
−Ω2
n −2iΩn
𝜕
𝜕t + 𝜕2
𝜕t2
]
qn + i 𝛼
2qn
}
e−i𝜃n
+𝛾
N∕2−1
∑
j=−N∕2
qje−i𝜃j
N∕2−1
∑
k=−N∕2
qke−i𝜃k
N∕2−1
∑
l=−N∕2
q∗
l ei𝜃l = 0,
(10.131)
where
𝜃j(z, t) = Ωjt −𝛿jz.
(10.132)
To obtain the last term of Eq. (10.131), we have used |q|2q = qqq∗. When the spectral width Δ𝜔is large
and/or the dispersion slope is high, third- and higher-order dispersion terms may have to be included in
Frequency
ω0 + Ω–1 
ω0 + Ω1 
ω0
Δω/2
Δω/2
Figure 10.9
The spectrum of a WDM signal.

438
Fiber Optic Communications
Eq. (10.131). From the last term on the left-hand side of Eq. (10.131), we see that nonlinear effects in the fiber
generate frequency components of the form Ωj + Ωk −Ωl. For a frequency band centered around Ωn, the only
frequency components that are of importance are Ωj + Ωk −Ωl = Ωn. All the other frequency components
generated through fiber nonlinearity have no effect on the frequency band centered around Ωn. Therefore,
collecting all the terms that oscillate at frequency Ωn and noticing that
𝛽n = 𝛽0 + 𝛽1Ωn + 𝛽2
2 Ω2
n,
(10.133)
we obtain
i
[𝜕qn
𝜕z + (𝛽1 + dn
) 𝜕qn
𝜕t
]
−𝛽2
2
𝜕2qn
𝜕t2 + 𝛾
N∕2−1
∑
j=−N∕2
N∕2−1
∑
k=−N∕2
N∕2−1
∑
l=−N∕2
qjqkq∗
l eiΔ𝛽jklnz = −i𝛼
2 qn
(10.134)
where
dn = 𝛽2Ωn,
(10.135)
Δ𝛽jkln = 𝛽j + 𝛽k −𝛽l −𝛽n,
(10.136)
Ωn = Ωj + Ωk −Ωl.
(10.137)
If j = k = l = n, the last term on the left-hand side is |qn|2qn, which represents SPM. If j = n and k = l ≠j,
the corresponding term in the summation is |qk|2qn, which represents cross-phase modulation (XPM). All
other terms in the above summation represent four-wave mixing (FWM).
As before, using a reference frame that moves at the group speed of the reference channel at 𝜔0,
T = t −𝛽1z,
(10.138)
Z = z,
(10.139)
we find
i
(𝜕qn
𝜕Z + dn
𝜕qn
𝜕T
)
−𝛽2
2
𝜕2qn
𝜕T2 +
𝛾
⎧
⎪
⎪
⎨
⎪
⎪⎩
|qn|2qn + 2
N∕2
∑
k=−N∕2
k≠n
|qk|2qn +
N∕2−1
∑
j=−N∕2
N∕2−1
∑
k=−N∕2
N∕2−1
∑
l=−N∕2
j+k−l=n
qjqkq∗
l eiΔ𝛽jklnZ
SPM
XPM
FWM
⎫
⎪
⎪
⎬
⎪
⎪⎭
(10.140)
= −i𝛼
2 qn.
10.7.1
Cross-Phase Modulation
In this section, we focus on XPM by ignoring the FWM terms of Eq. (10.140). The nonlinear interaction due
to SPM and XPM is described by
i
(𝜕qn
𝜕Z + dn
𝜕qn
𝜕T
)
−𝛽2
2
𝜕2qn
𝜕T2 + 𝛾
{
|qn|2qn + 2
N∕2−1
∑
k=−N∕2
|qk|2qn
}
= −i𝛼
2 qn.
(10.141)

Nonlinear Effects in Fibers
439
Here, dn denotes the difference between the inverse group speed of channel n and 𝛽1,
dn = 𝛽2Ωn.
(10.142)
When the bandwidth of the WDM and/or the dispersion slope is large, dn should be modified as
dn = 𝛽1(𝜔0 + Ωn) −𝛽1(𝜔0)
= 𝛽1(𝜔0) + d𝛽1
d𝜔
||||𝜔=𝜔0
Ωn + 1
2
d2𝛽1
d𝜔2
||||𝜔=𝜔0
Ω2
n −𝛽1(𝜔0)
= 𝛽2Ωn + 𝛽3
2 Ω2
n.
(10.143)
In Section 10.7.1.1, the XPM-induced timing shift is discussed qualitatively. In Section 10.7.1.2, a simple
analytical expression for the XPM efficiency is obtained and the impact of XPM on transmission performance
is covered in Section 10.7.1.3.
10.7.1.1
Timing Shift Due to XPM
Let us consider a two-channel WDM system described by Eq. (10.141) with N = 2. Owing to the Kerr effect,
two propagating pulses with different wavelengths induce a nonlinear phase shift on each other. This phase
shift is time-dependent and, therefore, the instantaneous frequency across a pulse in a channel is modified. In
a dispersive fiber, this frequency shift is translated into a timing shift since different frequency components
propagate at different speeds.
Fig. 10.10 shows two WDM channel inputs. A single pulse is launched at symbol slot 0 in each channel, and
initially the pulses are aligned. We assume that the fiber dispersion is anomalous (𝛽2 = −10 ps2/km) and the
center wavelength of channel 2 is longer than that of channel 1, so channel 2 propagates slower than channel
1. Our reference frame is fixed to channel 1 and the pulse in channel 2 moves with the inverse walk-off speed
of d2 = 𝛽2Ω (ignoring 𝛽3) relative to channel 1, where Ω is the channel spacing. Fig. 10.11 shows the pulses
of channels at the end of a L = 80 km span. As can be seen, due to the different channel speeds, channel 1
walked off channel 2. The pulse separation at the end of the span is given by
ΔT = d2L ≅250 ps.
(10.144)
Fig. 10.12 shows the pulse shape of channel 1 at the end of the fiber for three different cases. (1) Lin-
ear case (Lin): 𝛾= 0 W−1 km−1, which shows the linear response of the fiber-optics system. (2) SPM case
(Lin+SPM): channel 2 is turned off. (3) XPM case (Lin+SPM+XPM): both channels are present. Since
anomalous dispersion was assumed, in the presence of nonlinearity (Lin+SPM), the output pulse width is
narrower compared with the linear case (Lin). From Fig. 10.12, it can also be seen that when both channels
are present (Lin+SPM+XPM), the center of the pulse has moved to the right. As the fast channel (channel 1)
walks off, it induces the phase modulation on the slower channel (channel 2), and vice versa. In Fig. 10.10,
the pulses are initially aligned and during the propagation, the leading edge of the slow channel overlaps
with the trailing edge of the fast channel. The slope is positive at the leading edge of the pulse in channel
2. This leads to a negative instantaneous frequency shift of the pulse in channel 1 (see Eq. (10.167)) or, in
other words, channel 1 is red-shifted. Since red-shifted components travel slowly in an anomalous dispersion
fiber, the pulse of channel 1 arrives late or, in other words, there is a timing shift due to XPM (Fig. 10.12).
Since this timing shift is bit-pattern dependent, it leads to timing jitter in soliton systems [12, 13]. The timing
fluctuations leads to amplitude fluctuations of the signal samples used for decision and, hence, performance
degradations (see Section 10.7.1.3).

440
Fiber Optic Communications
–200
–100
0
100
200
300
400
500
0
0.05
0.1
Time (ps) 
Amp (arb. unit)
–200
–100
0
100
200
300
400
500
0
0.05
0.1
Time (ps) 
Amp (arb. unit)
Ch.2
Ch.1
Figure 10.10
Input pulses for channels 1 and 2. The following parameters were assumed: Ppeak = 8 mW, TFWHM = 50 ps,
channel spacing = 50 GHz, 𝛽2 = −10 ps2/km, 𝛽3 = 0 ps3/km, 𝛾= 2.43 W−1 km−1, fiber loss = 0.2 dB/km, and span length
80 km.
–200
–100
0
100
200
300
400
500
0
0.05
0.1
Time (ps) 
Amp (arb. unit)
–200
–100
0
100
200
300
400
500
0
0.05
0.1
Time (ps) 
Amp (arb. unit)
Ch.2
Ch.1
Figure 10.11
Output pulses for channels 1 and 2. Parameters are the same as those of Fig. 10.10.

Nonlinear Effects in Fibers
441
–60
–40
–20
0
20
40
60
0
1
2
3
4
5
6
7
8
Time (ps) 
Power (mW)
Lin
Lin + SPM
Lin + SPM + XPM
Figure 10.12
Channel 1 output pulse when (1) Lin: 𝛾= 0 W−1 km−1, (2) Lin+SPM: no pulse presents in channel 2, and
(3) Lin+SPM+XPM: both channels are present. Parameters are the same as those of Fig. 10.10.
10.7.1.2
XPM Efficiency
To see the impact of XPM, let us first ignore the pulse broadening due to dispersion and consider only two
channels–pump and signal. Let the central frequency of the signal channel be the same as the reference
frequency 𝜔0, so that dn for the signal is zero. We further assume that the pump is much stronger than the
signal, i.e., |qp|2 >> |qs|2. With these assumptions and approximations, Eq. (10.141) becomes
i𝜕qs
𝜕Z =
(
−i𝛼
2 −2𝛾|qp|2)
qs,
(10.145)
i
(𝜕qp
𝜕Z + dp
𝜕qp
𝜕T
)
=
(
−i𝛼
2 −𝛾|qp|2)
qp,
(10.146)
where the subscripts p and s denote pump and signal, respectively, and the walk-off parameter is
dp = 𝛽2Ωp + 𝛽3
2 Ω2
p;
(10.147)
Ωp is the frequency separation between the pump and the signal. To solve Eq. (10.146), we use the following
transformation:
T′ = T −dpZ,
(10.148)
Z′ = Z,
(10.149)
to obtain
i
𝜕qp
𝜕Z′ =
(
−i𝛼
2 −𝛾|qp|2)
qp.
(10.150)
Let
qp(T, Z) ≡qp(T′, Z′) = Ap(T′, Z′)ei𝜃p(T′,Z′).
(10.151)

442
Fiber Optic Communications
Substituting Eq. (10.151) in Eq. (10.150), we find
(
i
𝜕Ap
𝜕Z′ −
𝜕𝜃p
𝜕Z′ Ap
)
=
(
−i𝛼
2 −𝛾A2
p
)
Ap.
(10.152)
Separating the real and imaginary parts, we obtain
𝜕Ap(T′, Z′)
𝜕Z′
= −𝛼
2 Ap(T′, Z′)
(10.153)
or
Ap(T′, Z′) = Ap(T′, 0)e−𝛼Z′∕2,
(10.154)
𝜕𝜃p(T′, Z′)
𝜕Z′
= 𝛾A2
p(T′, 0)e−𝛼Z′.
(10.155)
Integrating Eq. (10.155) from 0 to Z′, we find
𝜃p(T′, Z′) −𝜃p(T′, 0) = 𝛾A2
p(T′, 0) ∫
Z′
0
e−𝛼Z′dZ′
= 𝛾A2
p(T′, 0)LEFF(𝛼, Z′)
(10.156)
where
LEFF(𝛼, x) = 1 −e−𝛼x
𝛼
.
(10.157)
Substituting Eqs. (10.154) and (10.156) in Eq. (10.151), we find
qp(T′, Z′) = Ap(T′, 0)e−𝛼Z′∕2ei[𝜃p(T′,0)+𝛾A2
p(T′,0)LEFF(𝛼,Z′)]
= qp(T′, 0)ei𝛾A2
p(T′,0)LEFF(𝛼,Z′)−𝛼Z′∕2.
(10.158)
Using Eqs. (10.148) and (10.149), Eq. (10.158) can be rewritten as
qp(T, Z) ≡qp(T′, Z′) = qp(T −dpZ, 0)e−𝛼Z∕2ei𝛾|qp(T−dpZ,0)|2LEFF(𝛼,Z).
(10.159)
Similarly, Eq. (10.145) can be solved by setting
qs = Asei𝜃s.
(10.160)
Substituting Eq. (10.160) in Eq. (10.145) and proceeding as before, we find
As(T, Z) = As(T, 0)e−𝛼Z∕2,
(10.161)
d𝜃s
dZ = 2𝛾|qp(T, Z)|2
= 2𝛾|qp(T −dpZ, 0)|2e−𝛼Z,
(10.162)
𝜃s(T, Z) = 𝜃s(T, 0) + 2𝛾∫
Z
0
|qp(T −dpZ, 0)|2e−𝛼ZdZ,
(10.163)
qs(T, Z) = qs(T, 0)e−𝛼Z∕2+i𝜙XPM(T,Z),
(10.164)

Nonlinear Effects in Fibers
443
𝜙XPM(T, Z) = 2𝛾∫
Z
0
|qp(T −dpZ, 0)|2e−𝛼ZdZ,
(10.165)
Ps(T, Z) = |qs(T, Z)|2 = Ps(T, 0)e−𝛼Z.
(10.166)
As in the case of SPM, the pulse width of the signal remains unchanged during propagation since we have
ignored dispersion. However, as can be seen from Eq. (10.165), the phase of the signal is modulated by the
pump. Hence, this is known as cross-phase modulation. The instantaneous frequency shift of the signal due
to XPM is
𝛿𝜔XPM = −𝜕𝜙XPM
𝜕T
= −2𝛾∫
Z
0
𝜕|qp(T −dpZ, 0)|2
𝜕T
e−𝛼ZdZ.
(10.167)
When the pump is sinusoidally modulated, its field envelope at the fiber input may be written as
qp(T, 0) =
√
Pp0 cos (ΩT),
(10.168)
|qp(T −dpZ, 0)|2 = Pp0cos2 [Ω(T −dpZ)]
=
Pp0
2 {1 + cos [2Ω(T −dpZ)]}.
(10.169)
Substituting Eq. (10.169) in Eq. (10.165), we find
𝜙XPM(T, L) = 𝛾Pp0 ∫
L
0
{1 + cos [2Ω(T −dpZ)]}e−𝛼ZdZ
= 𝛾Pp0Leff + 𝛾Pp0Re
{
∫
L
0
e−𝛼Z+i2Ω(T−dpZ)
dZ
}
,
(10.170)
where
Leff = 1 −exp (−𝛼L)
𝛼
.
(10.171)
The first term on the right-hand side of Eq. (10.170) is the constant phase shift due to XPM, which is of no
importance. The second term denotes the time-dependent phase shift, which could potentially degrade the
performance. Ignoring the first term, Eq. (10.170) can be simplified as follows [14]:
𝜙XPM(T, L) = 𝛾Pp0Re
{
ei2ΩT
[
1 −exp [−(𝛼+ i2Ωdp
) L]
𝛼+ i2Ωdp
]}
= 𝛾Pp0Leff
√𝜂XPM cos (2ΩT + 𝜃),
(10.172)
where 𝜂XPM is the XPM efficiency given by
𝜂XPM(Ω) =
𝛼2
𝛼2 + 4Ω2d2
p
[
1 +
4sin2 (ΩdpL) e−𝛼L
(1 −e−𝛼L)2
]
,
(10.173)
𝜃= tan−1
{
e−𝛼L sin (2ΩdpL)
1 −e−𝛼L cos (2ΩdpL)
}
−tan−1
{2Ωdp
𝛼
}
.
(10.174)
When the walk-off parameter dp = 0 or the modulation frequency Ω = 0, the XPM efficiency is maximum.
From Eq. (10.173), we find that 𝜂XPM = 1 for this case. As the walk-off increases, the interaction between the

444
Fiber Optic Communications
0
2
4
6
8
0
0.2
0.4
0.6
0.8
1
Walk-off parameter, |dp| (ps/km) 
XPM efficiency
Figure 10.13
XPM efficiency versus absolute of the walk-off parameter. Parameters: 𝛼= 0.046 km−1, fiber length =
80 km, modulating frequency Ω∕2𝜋= 5 GHz.
pump and the probe decreases and the XPM efficiency decreases. Fig. 10.13 shows the FWM efficiency as a
function of the absolute walk-off parameter. From Eq. (10.147), we see that as the channel spacing increases,
the walk-off increases and the XPM efficiency decreases. In other words, in a WDM system, the impact of the
XPM due to the nearest-neighbor channels is the greatest. An arbitrary pump may be written as a superposition
of sinusoids of the form given by Eq. (10.168), and the total XPM-induced phase shift can be calculated by
adding terms of the form given by Eq. (10.172) due to each frequency component.
Example 10.4
A pump is sinusoidally modulated with modulating frequency 10 GHz. The fiber-optic system has the follow-
ing parameters: loss coefficient 𝛼= 0.046 km−1, length L = 50 km, dispersion coefficient D = 17 ps/nm⋅km,
and dispersion slope S = 0.06 ps/nm2/km. The signal wavelength is 1550 nm and the pump wavelength is
1549.6 nm. Calculate the XPM efficiency.
Solution:
From Eqs. (2.216) and (2.202), we have
𝛽3 = S
(
𝜆2
2𝜋c
)2
+ D
𝜆3
2𝜋2c2 ,
(10.175)
𝛽2 = −D 𝜆2
2𝜋c,
(10.176)
D = 17 × 10−6 s∕m2,
(10.177)
S = 0.06 × 103 s∕m3,
(10.178)

Nonlinear Effects in Fibers
445
𝜆= 𝜆s = 1550 × 10−9 m,
(10.179)
c = 3 × 108 m∕s,
(10.180)
𝛽3 = 1.33 × 10−40 s3∕m,
(10.181)
𝛽2 = −2.166 × 10−26 s2∕m.
(10.182)
Using Eq. (10.147), the walk-off parameter is given by
dp = 𝛽2Ωp +
𝛽3Ω2
p
2
,
(10.183)
Ωp = 2𝜋(c∕𝜆p −c∕𝜆s)
= 3.14 × 1011 rad/s,
(10.184)
dp = −6.8 × 10−15 s∕m.
(10.185)
The XPM efficiency is given by Eq. (10.173),
𝜂XPM =
𝛼2
𝛼2 + 4Ω2d2
p
[
1 +
4sin2 (ΩdpL) e−𝛼L
(1 −e−𝛼L)2
]
.
(10.186)
Modulating frequency = 1010 Hz. So, Ω = 2𝜋× 1010 rad/s. Using this value in Eq. (10.186), we find
𝜂XPM = 3.34 × 10−3.
(10.187)
10.7.1.3
XPM Impact on System Performance
For intensity-modulated direct detection (IMDD) systems, the phase shift due to XPM does not degrade
the system performance if dispersion is absent. In a dispersive fiber, the frequency components generated
due to XPM travel at different speeds and arrive at different times at the fiber output, leading to amplitude
distortion. In other words, dispersion translates phase modulation (PM) into amplitude modulation (AM).
This is known as PM-to-AM conversion. The degradation due to XPM is one of the dominant impairments in
WDM systems and, hence, it has drawn significant attention [15–21]. The amplitude fluctuations due to XPM
can not be calculated analytically without approximations. In this section, we make a few approximations to
find a closed-form approximation for the amplitude distortion due to XPM. As before, we assume that the
pump is much stronger than the signal, so that the SPM of the probe can be ignored. Distortion of the pump due
to dispersion and nonlinearity is also ignored. While calculating the phase shift due to XPM, fiber dispersion
is ignored but its effect will be included later while converting PM to AM. Let the signal be CW,
qs(T, 0) =
√
Ps0.
(10.188)
Let the pump be the modulated signal,
qp(T, 0) =
√
Pp0
∑
n
anf(t −nTb),
(10.189)

446
Fiber Optic Communications
where {an} is the data sequence and f(t) is the pulse shape function. The pump power at the fiber input is
Pp(T, 0) = |qp(T, 0)|2 = Pp0
|||||
∑
n
anf (t −nTb
)|||||
2
,
(10.190)
|qp(T −dpZ, 0)|2 = Pp(T −dpZ, 0).
(10.191)
Taking the Fourier transform of Eq. (10.191), we find
{|qp(T −dpZ, 0)|2} = ̃Pp(𝜔)ei𝜔dpZ,
(10.192)
̃Pp(𝜔) = [Pp(T, 0)].
(10.193)
The phase shift of the signal due to XPM over a fiber length dZ can be found by differentiating Eq. (10.165)
with respect to Z,
d𝜙XPM(T, Z) = 2𝛾|qp(T −dpZ, 0)|2e−𝛼ZdZ.
(10.194)
Taking the Fourier transform of Eq. (10.194) and using Eq. (10.192), we obtain
d ̃𝜙XPM(𝜔, Z) = 2𝛾̃Pp(𝜔)e−(𝛼−i𝜔dp)ZdZ.
(10.195)
Let us deviate from XPM and consider a different problem. Suppose we have a linear dispersive fiber of
length Z and let the fiber input in the frequency domain be
̃qin(𝜔) = Ainei ̃𝜙in(𝜔).
(10.196)
The input phase ̃𝜙in(𝜔) is assumed to be small, and Ain is a constant. After passing through the dispersive
fiber, the phase fluctuations 𝛿̃𝜙in(𝜔) lead to amplitude fluctuations 𝛿̃A(𝜔) at the fiber output given by [22]
̃Aout(𝜔) = Ain + 𝛿̃A(𝜔),
(10.197)
𝛿̃A(𝜔) = −Ain ̃𝜙in(𝜔) sin
(𝛽2𝜔2Z
2
)
.
(10.198)
Now let us return to the phase shift due to XPM. Let d ̃𝜙XPM(𝜔, Z0) be the phase shift of the signal due to
XPM at Z0. After passing through the dispersive fiber of length L −Z0 where L is the fiber length, this phase
shift leads to an amplitude shift, as shown in Fig. 10.14, [16, 18],
d ̃As(𝜔) = −
√
Ps0
d ̃𝜙XPM(𝜔, Z0) sin
[
𝛽2 𝜔2 (L −Z0
)
2
]
.
(10.199)
The nonlinear phase shift due to XPM is distributed over the fiber length, with each infinitesimal phase shift
leading to an infinitesimal amplitude shift at the fiber output. Substituting Eq. (10.195) into Eq. (10.199) and
integrating the XPM contributions originating from 0 to L, we obtain [16–18]
Δ̃As(𝜔) = −2𝛾
√
Ps0 ∫
L
0
Pp(𝜔)e−(𝛼−i𝜔dp)Z0 sin
(
𝛽2 𝜔2 (L −Z0
)
2
)
dZ0
= −
√
Ps0𝛾Pp(𝜔)
i
∫
L
0
[e−[𝛼−i𝜔dp+ix]Z0+ixL −e−ixL−[𝛼−i𝜔dp−ix]Z0]dZ0
= i𝛾
√
Ps0 Pp(𝜔) { eixL LEFF [(𝛼−i𝜔dp + ix) , L] −e−ixL LEFF [(𝛼−i𝜔dp −ix) , L] },
(10.200)

Nonlinear Effects in Fibers
447
XPM phase shift
Z
L − Z0
L
dZ
Z0
Figure 10.14
Conversion of XPM-induced phase shift into amplitude shift.
where
x = 𝛽2𝜔2∕2,
(10.201)
LEFF(a, x) = 1 −exp (−ax)
a
.
(10.202)
Since the power modulation of the pump fluctuates as the bit pattern changes, the distortion of the signal due
to XPM, Δ̃As(𝜔), changes as a function of the bit pattern. To quantify the magnitude of the XPM distortion,
let us calculate the PSD of the XPM distortion as
𝜌XPM(𝜔) = lim
T→∞
⟨|Δ̃A(T)
s (𝜔)|2⟩
T
= lim
T→∞
⟨|P(T)
p (𝜔)|2⟩
T
× 𝛾2Ps0|eixLLEFF[(𝛼−i𝜔dp + ix), L] −e−ixLLEFF[(𝛼−i𝜔dp −ix), L]|2,
(10.203)
where T is the time interval of the bit pattern and
Δ̃A(T)
s (𝜔) = ∫
T∕2
−T∕2
ΔAs(t)ei𝜔tdt.
(10.204)
As an example, consider an OOK system that uses unipolar NRZ pulses. The pump field envelope may be
written as
qp(t) =
√
Pp0
∑
n
anrect
(t −nTb
Tb
)
,
(10.205)
where an is a random variable which takes the values 0 or 1 with equal probability,
Pp(t) = |qp(t)|2 = Pp0
∑
n
a2
nrect
(t −nTb
Tb
)
.
(10.206)

448
Fiber Optic Communications
–20
–10
0
10
20
0
0.5
1
1.5
2
2.5
× 10–4
Frequency (GHz) 
XPM PSD (mW/GHz)
∆f = 100 GHz
∆f = 200 GHz
∆f = 300 GHz
Figure 10.15
The power spectral density of the XPM distortion vs. frequency. Parameters: 𝛼= 0.046 km−1, Pp0 =
4 mW, Ps0 = 0.1 mW, L = 80 km, 𝛾= 1.1 × 10−3, 𝛽2 = −21 ps2/km, and 𝛽3 = 0. Bit rate = 10 Gb/s.
For the OOK–NRZ signal, a2
n = an. Therefore, the PSD of Pp(t) is given by Eq. (4.20), i.e.,
lim
T→∞
⟨|Pp(𝜔)|2⟩
T
=
Pp0
2 Tb
4
sinc2 (𝜔Tb∕2)
[
1 + 2𝜋𝛿(𝜔)
Tb
]
.
(10.207)
Fig. 10.15 shows the signal distortion due to XPM using Eqs. (10.203) and (10.207), and ignoring the discrete
part of the spectrum (second term in Eq. (10.207)). As can be seen, the PSD of XPM distortion decreases as
the channel spacing Δf(= Ωp∕(2𝜋)) increases.
This analysis can be modified by taking into account the pump envelope change due to dispersion [18]. The
amplitude and phase fluctuations of the modulated signal due to XPM can also be calculated using a first- or
second-order perturbation theory [20].
10.7.2
Four-Wave Mixing
Four-wave mixing refers to the generation of a fourth wave at the frequency Ωn due to the nonlinear interaction
of three waves at frequencies Ωj, Ωk, and Ωl. To study the impact of FWM alone, let us ignore the SPM and
XPM terms in Eq. (10.140). In addition, in order to simplify the analysis, let us assume that the signals in each
channel are CW (constant envelope), so that the second and third terms on the left-hand side of Eq. (10.140)
can also be ignored. With these simplifications, Eq. (10.140) becomes
𝜕qn
𝜕Z + 𝛼
2 qn = i𝛾
N∕2−1
∑
j=−N∕2
N∕2−1
∑
k=−N∕2
N∕2−1
∑
l=−N∕2
j+k−l=n
No SPM, no XPM
qjqkq∗
l eiΔ𝛽jklnZ.
(10.208)

Nonlinear Effects in Fibers
449
Let us first consider a single triplet {jkl} corresponding to channels at frequencies Ωj, Ωk, and Ωl satisfying
Ωj + Ωk −Ωl = Ωn.
(10.209)
Let the FWM field generated at Ωn be 𝜖n. Now, qn may be written as
qn = q(0)
n + 𝜖n,
(10.210)
where q(0)
n is the signal field in the absence of nonlinearity. We assume that |𝜖n| ≪|qn|. Considering only the
triplet {jkl}, Eq. (10.208) becomes
(
dq(0)
n
dZ + 𝛼
2 q(0)
n
)
+
(d𝜖n
dZ + 𝛼
2 𝜖n
)
= i𝛾q(0)
j q(0)
k q∗(0)
l
eiΔ𝛽jklnZ,
(10.211)
where
Δ𝛽jkln = 𝛽j + 𝛽k −𝛽l −𝛽n
(10.212)
is the phase mismatch. Note that qjqkq∗
l of Eq. (10.208) is replaced by q(0)
j q(0)
k q∗(0)
l
in Eq. (10.211), which is
known as the undepleted pump approximation. When the FWM power is much smaller than the signal power,
depletion of signal terms (i.e., FWM pumps) appearing in Eq. (10.211) may be ignored. Since q(0)
n is the signal
field in the absence of nonlinearity, it can be written as
q(0)
n
= Ane−𝛼
2 Z+i𝜃n,
n = −N
2 , −N
2 + 1, … , N
2 −1,
(10.213)
where An and 𝜃n are amplitude and phase at Z = 0, respectively. It can easily be seen that
dq(0)
n
dZ + 𝛼
2 q(0)
n
= 0.
(10.214)
So, Eq. (10.211) becomes
d𝜖n
dZ + 𝛼
2 𝜖n = i𝛾q(0)
j q(0)
k q∗(0)
l
eiΔ𝛽jklnZ.
(10.215)
When the third-order dispersion is ignored, the propagation constant is given by Eq. (10.133). Using
Eqs. (10.133), and Eq. (10.209) in Eq. (10.212), we find
Δ𝛽jkln = 𝛽1(Ωj + Ωk −Ωl −Ωn) + 𝛽2
2 [Ω2
j + Ω2
k −Ω2
l −(Ωj + Ωk −Ωl)2]
= 𝛽2[ΩlΩn −ΩjΩk].
(10.216)
When the bandwidth of the WDM signal and/or the dispersion slope is large, the third-order dispersion
coefficient can not be ignored. In this case, Eq. (10.216) is modified as (see Example 10.9)
Δ𝛽jkln = (ΩlΩn −ΩjΩk)
[
𝛽2 + 𝛽3
2
(Ωj + Ωk
)]
.
(10.217)
Substituting Eq. (10.213) in Eq. (10.215), we find
d𝜖n
dZ + 𝛼
2 𝜖n = i𝛾AjAkAle−(3𝛼∕2−iΔ𝛽jkln)Z+iΔ𝜃jkl,
(10.218)
where
Δ𝜃jkl = 𝜃j + 𝜃k −𝜃l.
(10.219)

450
Fiber Optic Communications
Eq. (10.218) is a first-order ordinary differential equation. The integrating factor is e𝛼Z∕2. So, multiplying Eq.
(10.218) by e𝛼Z∕2, we find
d(𝜖ne𝛼Z∕2)
dZ
= i𝛾AjAkAle−(𝛼−iΔ𝛽jkln)Z+iΔ𝜃jkl.
(10.220)
Integrating Eq. (10.220) from 0 to L with the condition 𝜖n(0) = 0, we obtain
𝜖n(L) = i𝛾AjAkAle−𝛼L∕2+iΔ𝜃jkl
∫
L
0
e−(𝛼−iΔ𝛽jkln)ZdZ
= Kjkl
[1 −e−𝛿jklnL]
𝛿jkln
,
(10.221)
where
Kjkl = i𝛾AjAkAleiΔ𝜃jkl−𝛼L∕2
(10.222)
and
𝛿jkln = 𝛼−iΔ𝛽jkln.
(10.223)
The power of the FWM component is [23, 24]
PFWM,n = |𝜖n|2 =
|Kjkl|2|1 −e−𝛿jklnL|2
|𝛿jkln|2
e−𝛼L
= 𝛾2PjPkPlL2
eff𝜂jklne−𝛼L,
(10.224)
𝜂jkln =
𝛼2 + 4e−𝛼Lsin2(Δ𝛽jklnL∕2)∕L2
eff
𝛼2 + (Δ𝛽jkln)2
,
(10.225)
Pj = A2
j ,
(10.226)
Leff = 1 −exp (−𝛼L)
𝛼
.
(10.227)
Here, 𝜂jkln represents the FWM efficiency. Fig. 10.16 shows the dependence of the efficiency on the dispersion
coefficient 𝛽2 when j = 1, k = 2, and l = 3. When 𝛽2 = 0, the efficiency is maximum and this is known as
phase matching. As |𝛽2| increases, the FWM efficiency decreases and it becomes significantly smaller when
|𝛽2| > 6 ps2/km. When the fiber is sufficiently long, the second term in Eq. (10.225) may be ignored and
Eq. (10.225) may be approximated as
𝜂jkln ≅
𝛼2
𝛼2 + (Δ𝛽jkln)2 .
(10.228)
Let the channel spacing be Δf and Ωj = j2𝜋Δf, j = −N∕2, −N∕2 + 1, … , N∕2 −1. Now, Eqs. (10.209) and
(10.216) become
j + k −l = n,
(10.229)
Δ𝛽jkln = (2𝜋Δf)2𝛽2[nl −jk].
(10.230)
With j = 1, k = 2, and l = 3, we find n = 0 and
𝜂1230 ≅
𝛼2
𝛼2 + 4𝛽2
2(2𝜋Δf)4 .
(10.231)

Nonlinear Effects in Fibers
451
–2
–1
0
1
2
0
0.2
0.4
0.6
0.8
1
Dispersion (ps.ps/km) 
FWM efficiency
Figure 10.16
FWM efficiency vs. 𝛽2 for j = 1, k = 2, and l = 3. Channel spacing, Δf = 100 GHz, Ω1 = 2𝜋Δf, Ω2 =
4𝜋Δf, L = 80 km, loss = 0.2 dB/km, and Ω3 = 6𝜋Δf.
0
100
200
300
400
0
0.2
0.4
0.6
0.8
1
Channel spacing (GHz) 
FWM efficiency
β2 = 0.5 ps.ps/km
β2 = 1 ps.ps/km
Figure 10.17
FWM efficiency vs. channel spacing, Δf. L = 80 km, loss = 0.2 dB/km, j = 1, k = 2, and l = 3.
Fig. 10.17 shows the dependence of the FWM efficiency on the channel spacing. As can be seen, the effi-
ciency decreases as the channel spacing and/or |𝛽2| increases. So far we have considered FWM generation
due to a single triple {jkl}. Considering all the triplets in Eq. (10.208), Eq. (10.221) should be modified as
𝜖n(L) =
∑
j
∑
k
j+k−l=n
No SPM, no XPM
∑
L
Kjkl
[1 −e−𝛿jklnL]
𝛿jkln
(10.232)

452
Fiber Optic Communications
FWM
tones 
FWM
tones 
signals
(a)
0
Δf
2Δf 3Δf 4Δf
(b)
0
Δf
2Δf 3Δf
signals
Figure 10.18
Two types of FWM: (a) non-degenerate FWM; (b) degenerate FWM.
and the FWM power is Pn = |𝜖n|2. Consider three channels of a WDM system centered at lΔf, l = 1, 2, 3.
The nonlinear interaction between these channels leads to a FWM field at 4Δf and 0, as shown in Fig. 10.18.
If we choose j = 1, k = 2, and l = 3, the FWM tone falls on the channel at 0 since j + k −l = 0. Choosing
j = 2, k = 3, and l = 1, we find j + k −l = 4 and, therefore, the FWM tone is generated at 4Δf as well, as
shown in Fig. 10.18. These types of FWM are known as non-degenerate FWM as j, k, and l are distinct. When
j = k = 1 and l = 2, j + k −l = 0 and the FWM tone falls on the channel at 0, as shown in Fig. 10.18(b). The
other possibility is j = k = 2 and l = 1, j + k −l = 3 and the FWM tone falls on the channel at 3Δf. These
types of FWM are known as degenerate FWM. Eq. (10.232) includes both types of FWM. Adding all the
possible FWM tones that satisfy the condition j + k −l = n, the total FWM field on the channel n can be
calculated using Eq. (10.232).
Fig. 10.19 shows the mean FWM power on the middle channel as a function of the number of channels
in a WDM system. Initial phases of channels (𝜃j) are assumed to be random and the mean FWM power
0
10
20
30
40
0
0.1
0.2
0.3
0.4
0.5
Number of channels 
FWM power (mW)
∣β2∣ = 6 ps.ps/km
∣β2∣ = 10 ps.ps/km
Figure 10.19
Mean FWM power on the middle channel vs. number of channels in a WDM system. Parameters: channel
spacing = 50 GHz, power/channel = 3 mW, number of spans = 20, amplifier spacing = 80 km, loss = 0.2 dB/km, and
𝛾= 1.1 W−1 km−1.

Nonlinear Effects in Fibers
453
is calculated by averaging over the random phases. The FWM field acts as noise on the channel, leading
to performance degradations. The FWM impairment becomes smaller as the dispersion increases, since the
phase matching becomes more difficult, and it increases as the channel spacing decreases. Therefore, FWM
is one of the dominant impairments in OFDM systems in which the subcarriers are closely spaced [25, 26].
There are a number of approximations in this FWM model. Firstly, the modulation of the channels is ignored.
When the channel modulation is included, the signal field qn is not independent of time and, therefore, the
second term on the left-hand side of Eq. (10.140) can not be ignored. Owing to dispersion, different channels
propagate at different speeds, which is not taken into account in this simple model. The FWM model may be
modified taking into account pump depletion [27], pump modulation [28–30], pump modulation and walk-off
[31–33]. Experimental validation of the CW FWM model can be found in Ref.[34].
Example 10.5
A WDM system consists of three channels centered at −Δf, 0, and Δf, with Δf = 50 GHz. The fiber loss
coefficient 𝛼= 0.046 km−1 and the fiber length L = 40 km. Calculate the efficiency of the non-degenerate
FWM tone at −2Δf if (a) 𝛽2 = −4 ps2/km, (b) 𝛽2 = 0 ps2/km. Ignore 𝛽3.
Solution:
From Eq. (10.90), we have
Leff = 1 −exp (−𝛼L)
𝛼
= 1 −exp (−0.046 × 40)
0.046
= 18.28 km.
(10.233)
From Eq. (10.225), the FWM efficiency is
𝜂jkln =
𝛼2 + 4e−𝛼Lsin2 (Δ𝛽jklnL∕2)∕L2
eff
𝛼2 + (Δ𝛽jkln)2
.
(10.234)
Let j = −1, k = 0, and l = 1 so that n = j + k −l = −2 corresponding to the FWM tone at −2Δf. From Eq.
(10.216), we have
Δ𝛽jkln = 𝛽2[ΩlΩn −ΩjΩk]
= 𝛽2(2𝜋Δf)2[1 ⋅(−2) −(−1) ⋅0].
(10.235)
(a) 𝛽2 = −4 ps2/km:
Δ𝛽−101−2 = −4 × 10−27 × (2𝜋× 50 × 109)2 × (−2) m−1
= 7.89 × 10−4 m−1;
(10.236)
𝜂−101−2 = (0.046 × 10−3)2 + 4 exp (−0.046 × 40)sin2(7.89 × 10−1 × 40∕2)∕(18.28 × 103)2
(0.046 × 10−3)2 + (7.89 × 10−4)2
= 3.4 × 10−3.
(10.237)
(b) 𝛽2 = 0 ps2/km:
Δ𝛽−101−2 = 0 m−1.
(10.238)
Now, from Eq. (10.225), we have 𝜂= 1.

454
Fiber Optic Communications
10.8
Intrachannel Nonlinear Impairments
In quasi-linear systems, dispersive effects are much stronger than nonlinear effects and the fiber nonlinearity
can be considered as a small perturbation in the linear system. Since the dispersive effects are dominant in
quasi-linear systems, neighboring pulses overlap and this system is also known as a strongly pulse-overlapped
system [35] or pseudo-linear system [36]. In contrast, in classical soliton systems, dispersion is balanced by
nonlinearity, the pulses are well confined within the bit period. In quasi-linear systems, the pulses that are
separated by several bit periods could interact nonlinearly because of the strong pulse overlap among the
pulses. In this section, we consider single-channel nonlinear impairments such as intrachannel four-wave
mixing (IFWM) [35–46] and intrachannel cross-phase modulation (IXPM) [47–49]. The variance in signal
distortion due to nonlinear effects is used as a measure to compare different fiber-optic systems. IXPM and
IFWM can be considered as deterministic signal–signal nonlinear impairments because if we know the bit
pattern, these effects can be undone using digital back propagation (DBP) at the transmitter or receiver (see
Chapter 11). In contrast, the nonlinear signal–ASE interaction such as Gordon–Mollenauer phase noise is
stochastic and the DBP can not compensate for it. In single-channel systems, the nonlinear interaction can be
divided into three types: (i) intrapulse SPM; (ii) IXPM; and (iii) IFWM. SPM has already been discussed in
Section 10.5. Here we discuss IXPM and IFWM.
10.8.1
Intrachannel Cross-Phase Modulation
IXPM is the phase modulation of a pulse by another pulse of the same channel. Consider the interaction
between two pulses q1(T, Z) and q2(T, Z) separated by Tb at the fiber input. Let the total field envelope be
q(T, Z) = q1(T, Z) + q2(T, Z).
(10.239)
Substituting Eq. (10.239) in Eq. (10.81), we find
i𝜕(q1 + q2)
𝜕Z
−𝛽2
2
𝜕2(q1 + q2)
𝜕T2
+ 𝛾|q1 + q2|2(q1 + q2) = −i𝛼(q1 + q2)∕2.
(10.240)
The last term on the left-hand side can be written as
|q1 + q2|2(q1 + q2) = (|q1|2 + 2|q2|2)q1 + (|q2|2 + 2|q1|2)q2 + q2
1q∗
2 + q2
2q∗
1.
(10.241)
The last two terms in Eq. (10.241) represent the intrachannel four-wave mixing, and this will be considered
in the next section. The term 2|q2|2q1 represents the phase modulation of q1 due to q2. If the IXPM terms
2|q2|2q1 and 2|q1|2q2 and the IFWM term q2
1q∗
2 + q2
2q∗
1 were to be absent, the pulses would experience intra-
pulse SPM only and there would be no change in the temporal position of the pulses as a function of the
propagation distance. However, due to IXPM, pulses could attract or repel each other. Figs. 10.20 and 10.21
show the nonlinear interaction between adjacent pulses. In this example, pulses repel each other, leading to
performance degradation. The timing jitter due to IXPM can be calculated using a variation approach [42, 49]
or a perturbation technique [48]. The repulsion between pulses can be explained as follows. The phase modu-
lation caused by the IXPM leads to instantaneous frequency change of a pulse. In a dispersive fiber, different
frequency components travel at different speeds and, therefore, the frequency change due to IXPM translates
into group speed changes. Therefore, the first pulse moves faster than the second pulse and it arrives at the
fiber output earlier than the second one, leading to a temporal separation longer than the bit interval. In the
absence of IXPM, pulses would have the same group speed and the separation between pulses would be equal
to the bit period. For systems based on OOK, ‘1’ and ‘0’ occur randomly and the timing shift caused by IXPM
is random, leading to time jitters and performance degradation.

Nonlinear Effects in Fibers
455
–200
0
200
0
500
1000
1500
0
5
10
Distance (km)
Time (ps) 
Power (mW) 
Figure 10.20
Nonlinear interaction between adjacent pulses. The pulses are separated by 25 ps at the input. Transmission
fiber is a standard single-mode fiber with 𝛽2 = −22 ps2/km. The dispersion is fully compensated in each span.
–2
–1
0
1
2
× 10–8
0
2
4
6
8
10
12
Time (ps)
Power (mW)
Input
Output
Figure 10.21
Optical power distribution at the fiber input and output. Fiber length = 1600 km. The parameters are the
same as in Fig. 10.20.
10.8.2
Intrachannel Four-Wave Mixing
When two or more pulses of the same channel interact nonlinearly, echo or ghost pulses are generated, as
shown in Figs. 10.22 and 10.23. This is called intrachannel four-wave mixing. In the case of interchannel
FWM shown in Fig. 10.24(a), the nonlinear interaction between the frequency components f1, f2, and f3 leads

456
Fiber Optic Communications
–200
–150
–100
–50
0
50
100
150
200
0
1000
2000
3000
4000
–200
–150
–100
–50
0
50
Distance (km)
Time (ps) 
Power (dBm) 
1st order
echo pulse
2nd order
echo pulse
Figure 10.22
Interaction of three signal pulses leading to echo pulses. The parameters are the same as in Fig. 10.20.
–2
–1.5
–1
–0.5
0
0.5
1
1.5
2
× 10–8
0
2
4
6
8
10
12
Time (ps) 
Power (mW)
1st order
Echo pulse
1st order
echo pulse
output
Input
Figure 10.23
Optical power distributions at the fiber input and output. Fiber length = 3200 km.
to FWM sidebands at f1 + f2 −f3 and f2 + f3 −f1. Similarly, in the case of IFWM, the nonlinear interaction
between pulses centered at t1, t2, and t3 leads to echo pulses at t1 + t2 −t3 and t2 + t3 −t1. The difference
between FWM and IFWM is that echo pulses appear in the time domain instead of in the frequency domain,
as shown in Fig. 10.24(b). Hence, it is also known as time-domain FWM. The nonlinear interaction between
signal pulses leads to first-order echo pulses, as shown in Figs. 10.22 and 10.23, and the nonlinear interaction
of signal pulses and first-order echo pulses leads to second-order echo pulses. However, the amplitudes of the

Nonlinear Effects in Fibers
457
Ch. 1
frequency
Ch. 2
Ch. 3
FWM
sideband
FWM
sideband
f1
f2
f3
f1 + f2 – f3
f3 + f2 – f1
Pulse
1
time
Pulse
2
Pulse
3
Echo
pulse
Echo
pulse
t1
t2
t3
t1 + t2 – t3
t3 + t2 – t1
Figure 10.24
The analogy between interchannel FWM and intrachannel FWM.
second-order echo pulses are very small, and they are not visible in the linear plot shown in Fig. 10.23. We
ignore second-order echo pulses in the analysis of IFWM.
Suppose the pulse centered at mTb is qm. The nonlinear interaction between ql, qm, and qn due to IFWM is
described by qlqmq∗
n and the resulting echo pulse is centered near (l + m −n)Tb. For example, in Figs. 10.22
and 10.23, the first-order echo pulses centered around −50 ps and 50 ps and generated due to the nonlinear
interaction of signal pulses centered at −25 ps, 0 ps, and 25 ps. The echo pulse at 50 ps is generated by a
nonlinear interaction of the form qlqmq∗
n where l = 1 (25 ps), m = 0 (0 ps), n = −1 (−25 ps), and l + m −n = 2
(50 ps). The nonlinear interaction of the first-order echo pulses and signal pulses leads to second-order echo
pulses at −75 ps and 75 ps (see Fig. 10.22).
When l = m, it is known as degenerate IFWM, similar to the degenerate interchannel FWM. Otherwise, it
is called non-degenerate IFWM. The echo pulse centered around 50 ps is generated not only by signal pulses
centered at −25 ps, 0 ps, and 25 ps (q1q0q∗
−1) due to non-degenerate IFWM, but also by pulses centered at
0 ps and 25 ps (q2
1q∗
0) due to degenerate IFWM. Note that the echo pulses are generated in the locations of
signal pulses as well. In Fig. 10.23, the nonlinear interaction of the signal pulses centered at −25 ps, 0 ps,
and 25 ps (q1q−1q∗
0) leads to an echo pulse around 0 ps (l = 1, m = −1, n = 0, l + m −n = 0). The coherent
superposition of the signal pulse and echo pulse around T = 0 ps leads to the distortion of the signal pulse at
T = 0 ps, as shown in Fig. 10.23. Section 10.9 provides the mathematical description of IFWM.
10.8.3
Intra- versus Interchannel Nonlinear Effects
Fig. 10.25 illustrates the difference between intrachannel and interchannel nonlinear impairments. The pulse
located at the center interacts nonlinearly with the pulses within the trapezoids. This interaction includes
both intrachannel and interchannel nonlinear effects (SPM, IXPM, IFWM, XPM, FWM). The area of the
trapezoids depends on the system parameters such as fiber dispersion, nonlinear coefficient, launch power,
and transmission distance. For example, if the launch power is higher and/or the transmission distance is
longer, the area of the trapezoids would be larger. The nonlinear interaction of the pulse located at the center
with the pulses within the ellipse corresponds to intrachannel impairments (SPM, IXPM, IFWM).
10.9
Theory of Intrachannel Nonlinear Effects
The optical field envelope in a fiber-optic transmission system can be described by the nonlinear Schrödinger
equation (NLS) (see Eq. (10.81))
i 𝜕q
𝜕Z −𝛽2(Z)
2
𝜕2q
𝜕T2 + 𝛾|q|2q = −i𝛼(Z)
2 q,
(10.242)

458
Fiber Optic Communications
Ch. 1
Ch. 2
Ch. 3
Ch. 4
Ch. 5
t
t
t
t
t
Intrachannel effects only
Central pulse
Figure 10.25
Illustration of the difference between intrachannel and inter channel nonlinear effects.
where 𝛼(Z) is the loss/gain profile which includes fiber loss as well as amplifier gain, 𝛽2 is the second-order
dispersion profile, and 𝛾is the fiber nonlinear coefficient. Fig. 10.26(a) shows a typical fiber-optic transmission
system. We assume that the amplifier compensates for the fiber loss. To separate the fast variation of optical
power due to fiber loss/gain, we use the following transformation [50]:
q(T, Z) = a(Z)u(T, Z),
(10.243)
where a(Z) is real. Differentiating Eq. (10.243), we find
𝜕̇q
𝜕Z = ̇au + a 𝜕u
𝜕Z ,
(10.244)
where ⋅denotes differentiation with regard to Z. Let
̇a = −𝛼(Z)
2 a.
(10.245)
Substituting Eqs. (10.244) and (10.245) in Eq. (10.242), we obtain the NLS equation in the lossless form as
i 𝜕u
𝜕Z −𝛽2(Z)
2
𝜕2u
𝜕T2 = −𝛾a2(Z)|u|2u.
(10.246)
Solving Eq. (10.245) with the initial condition a(0) = 1, we obtain
a(Z) = exp
[
−∫
Z
0
𝛼(s)
2 ds
]
.
(10.247)
The choice of this initial condition is arbitrary. The sole purpose of introducing a(Z) is to separate the varia-
tions of the optical field due to loss/gain from that due to dispersion and nonlinear effects. Between amplifiers,
when the fiber loss is constant, 𝛼(Z) = 𝛼0, it becomes
a(Z) = exp (−𝛼0Z′∕2),
(10.248)

Nonlinear Effects in Fibers
459
Tx.
Amp
Amp
Amp
Power
Distance, z
α(z)
Distance, z
Rx.
(a)
(b)
(c)
Figure 10.26
Typical fiber-optic transmission system: (a) block diagram, (b) power variation, (c) loss/gain profile.
a2(z)
Distance, z
La
Figure 10.27
Plot of a2(Z) v distance. La = amplifier spacing.
where Z′ = mod(Z, La), where La = amplifier spacing. Fig. 10.27 shows a2(Z) for a fiber-optic link with fiber
loss exactly compensated by the amplifier gain (see Example 10.12 for more details). The mean optical power
< |q|2 > fluctuates as a function of distance due to fiber loss and amplifier gain, but < |u|2 > is independent
of distance since the variations due to loss/gain are separated out using Eq. (10.243). Note that the nonlinear
coefficient is constant in Eq. (10.242), but the effective nonlinear coefficient 𝛾a2(Z) changes as a function of
distance in Eq. (10.246). Eq. (10.246) can be solved using perturbation theory. The solution of Eq. (10.246)
can be written as
u(T, Z) = u0(T, Z) + 𝛾u1(T, Z) + 𝛾2u2(T, Z) + · · · ,
(10.249)

460
Fiber Optic Communications
where uj(T, Z) is the jth order solution. The nonlinear term in Eq. (10.246) may be written as
|u(T, Z)|2u(T, Z) =
|||||
∞
∑
n=0
𝛾nun
|||||
2 ∞
∑
n=0
𝛾nun.
(10.250)
Using Eqs. (10.249) and (10.250) in Eq. (10.246) and separating terms proportional to 𝛾n, n = 0, 1, 2, … , we
obtain [20]
(𝛾0) ∶
i𝜕u0
𝜕Z −𝛽2
2
𝜕2u0
𝜕T2 = 0,
(10.251)
(𝛾1) ∶
i𝜕u1
𝜕Z −𝛽2
2
𝜕2u1
𝜕T2 = −a2(Z)|u0|2u0,
(10.252)
(𝛾2) ∶
i𝜕u2
𝜕Z −𝛽2
2
𝜕2u2
𝜕T2 = −a2(Z)(2|u0|2u1 + u2
0u∗
1).
(10.253)
Eq. (10.251) is the linear Schrödinger equation. The linear solution u0(T, Z) can be obtained using the lin-
ear fiber transfer function as discussed in Chapter 2. Eqs. (10.252) and (10.253) represent the first- and
second-order corrections due to nonlinear effects. The first (second)-order term u1 (u2) corresponds to the first
(second)-order echo pulses shown in Fig. 10.22. When the nonlinear effects are small, the terms of order 𝛾n,
n > 1, can be ignored. As an example, let us consider a single-span lossless (𝛼= 0) zero-dispersion (𝛽2 = 0)
fiber. Eq. (10.251) becomes
du0
dZ = 0,
(10.254)
u0 = k(const.).
(10.255)
Note that k may be a function of t. Since a2(Z) = 1 in this example, Eq. (10.252) becomes
i𝜕u1
𝜕Z = −|k|2k,
(10.256)
u1(T, Z) = u1(T, 0) + i|k|2kZ.
(10.257)
The initial condition is
u(T, 0) = u0(T, 0) + 𝛾u1(T, 0) + 𝛾2u2(T, 0) + · · · .
(10.258)
Since uj(T, 0) are arbitrary functions, one convenient choice would be
u0(T, 0) = u(T, 0) = k,
uj(T, 0) = 0
for
j > 1.
(10.259)
Using Eqs. (10.255)–(10.259) and ignoring terms of order 𝛾n, n > 1 in Eq. (10.249), we obtain
u(T, Z) = (1 + i𝛾|k|2Z) k.
(10.260)
In this simple example, Eq. (10.246) can easily be solved directly:
i du
dZ = −𝛾|u|2u,
u(T, Z) = exp [i𝛾|u(T, 0)|2]u(T, 0).
(10.261)

Nonlinear Effects in Fibers
461
Taylor series expansion of the exponential function in Eq. (10.261) yields
u(T, Z) =
(
1 + i𝛾|k|2Z −𝛾2Z2
2! |k|4 + · · ·
)
k.
(10.262)
Comparing Eqs. (10.260) and (10.262), we see that they match up to the first-order term in 𝛾. If we solve
Eq. (10.253) and add the second-order correction in Eq. (10.260), we find that Eqs. (10.260) and (10.262)
would match up to second order in 𝛾(see Example 10.11).
Now, let us consider a more general problem in which neither 𝛽2 nor 𝛼is zero. Let the optical field envelope
at the fiber input be
q(T, 0) = a(0)u(T, 0) =
∞
∑
n=−∞
bnf(T −nTs),
(10.263)
where Ts is the symbol interval and f(T) is the pulse shape. For systems based on OOK,
bn =
{
1
for ‘1’,
0
for ‘0’.
(10.264)
For systems based on PSK or DPSK,
bn =
{
1
for ‘1’,
−1
for ‘0’.
(10.265)
Eq. (10.251) can be solved using the Fourier transform technique (see Chapter 2). The solution is
u0(T, Z) = −1{̃u0(𝜔, 0) exp [i𝜔2S(Z)∕2]},
(10.266)
where ̃u0(𝜔, 0) = [u0(T, 0)], u0(T, 0) = u(T, 0), and S(Z) is the accumulated dispersion
S(Z) = ∫
Z
0
𝛽2(x)dx.
(10.267)
Taking the Fourier transform of Eq. (10.252), we obtain
id̃u1
dZ + 𝛽2(Z)
2
𝜔2̃u1(𝜔, Z) = −a2(Z) ̃F(𝜔, Z),
(10.268)
where ̃u1(𝜔, Z) = [u1(T, Z)] and ̃F(𝜔, Z) = [|u0(T, Z)|2u0(T, Z)]. Eq. (10.268) is a first-order ordinary dif-
ferential equation which can be solved to yield
̃u1(𝜔, Ltot)IF(Ltot) = i ∫
Ltot
0
a2(x) ̃F(𝜔, x)IF(x)dx,
(10.269)
where the integrating factor is
IF(Z) = exp [iS(Z)𝜔2∕2] ,
(10.270)
and Ltot is the total transmission distance. We assume that the dispersion is fully compensated either in the
optical or the electrical domain before the decision device. So, S(Ltot) = 0 and Eq. (10.269) becomes
̃u1(𝜔, Ltot) = i ∫
Ltot
0
a2(x) ̃F(𝜔, x)IF(x)dx.
(10.271)

462
Fiber Optic Communications
The first-order correction u1(T, Z) is obtained by performing the inverse Fourier transformation of ̃u1(𝜔, Z).
Typically, in quasi-linear systems, the nonlinear effects are smaller than the dispersive effects and the
first-order correction u1(T, Z) is often adequate to describe the nonlinear propagation. However, when
the transmission distance is long and/or the launch power is large, a second-order perturbation theory is
needed [20].
A closed-form expression for u0(T, Z) and u1(T, Z) can be obtained if we assume that the pulse shape f(T)
is Gaussian, i.e.,
f(T) =
√
P0 exp
(
−T2
2T2
0
)
,
(10.272)
where P0 is the peak power. The linear propagation of this pulse is described by (see Eq. (2.158))
T0
√
P0
T1(Z) exp
[
−
T2
2T2
1(Z)
]
,
(10.273)
where T2
1 = T2
0 −iS(Z). When a long bit sequence is launched to the fiber, u0(T, 0) is given by Eq. (10.263).
In this case, the linear solution is
u0(T, Z) =
T0
√
P0
T1
∞
∑
n=−∞
bn exp
[
−(T −nTs)2
2T2
1(Z)
]
,
(10.274)
F(T, Z) = |u0(T, Z)|2u0(T, Z) = P3∕2
0
T3
0
|T1|2T1
∞
∑
l=−∞
∞
∑
m=−∞
∞
∑
n=−∞
blbmbn
× exp
[
−(T −lTs)2
2T2
1
−(T −mTs)2
2T2
1
−(T −nTs)2
2(T2
1)∗
]
.
(10.275)
The Fourier transform of F(T, Z) is (Example 10.13)
̃F(𝜔, Z) =
P3∕2
0 T3
0
|T1|2T1
√𝜋
C(Z)
∑
lmn
blbmbn exp [−g(Z) + [i𝜔−d(Z)]2∕4C(Z)],
(10.276)
where
C(Z) =
3T2
0 + iS
2(T4
0 + S2)
,
(10.277)
d(Z) =
Ts[(l + m + n)T2
0 + i(l + m −n)S]
T4
0 + S2
,
(10.278)
g(Z) =
T2
s [(l2 + m2 + n2)T2
0 + i(l2 + m2 −n2)S]
2(T4
0 + S2)
.
(10.279)
Substituting Eq. (10.276) in Eq. (10.269), and after performing the inverse Fourier transformation, we find
u1(T, Ltot) =
∑
lmn
𝛿ulmn(T, Ltot)blbmbn,
(10.280)
𝛿ulmn(T, Ltot) = iP3∕2
0 T3
0 ∫
Ltot
0
a2(x) exp [−(2CT −d)2∕(4C(1 + i2SC) −C)]
√
(1 + i2SC)(T2
0 −iS)(T4
0 + S2)
dx.
(10.281)

Nonlinear Effects in Fibers
463
For a single-span system with constant loss 𝛼and dispersion coefficient 𝛽2, Eq. (10.281) reduces to [38, 43]
𝛿ulmn(T, L) = iP3∕2
0 T3
0 ∫
L
0
exp [−𝛼Z −(2CT −d)2∕(4C(1 + i2𝛽2CZ) −C)]
√
(1 + i2𝛽2CZ)(T2
0 −i𝛽2Z)(T4
0 + 𝛽2
2Z2)
dZ,
(10.282)
where L is the fiber length.
10.9.1
Variance Calculations
Without loss of generality, we consider the nonlinear distortion on the pulse located at T = 0. The total field
at the end of the transmission line is
u(T = 0, Ltot) = u0(T = 0, Ltot) + 𝛾u1(T = 0, Ltot)
=
√
P0T0
T1(Ltot)
[
b0 +
∞
∑
n=−∞,n≠0
bn exp
(
−n2T2
s
2T2
1
)]
+ 𝛾
∞
∑
l=−∞
∞
∑
m=−∞
∞
∑
n=−∞
blbmbn𝛿ulmn.
(10.283)
The second term on the right-hand side of Eq. (10.283) represents the ISI from the neighboring symbols
and the last term on the right-hand side represents the nonlinear distortion due to SPM, IXPM, and IFWM.
The nonlinear interaction between pulses centered at lTs, mTs, and nTs results in an echo pulse centered
approximately at (l + m −n)Ts. Therefore, the dominant contributions to the nonlinear distortion at T = 0
come from the symbol slots that satisfy l + m −n = 0 and all the other triplets in Eq. (10.283) can be ignored.
When l = m = n = 0, 𝛿u000 corresponds to SPM. When l = 0 and m = n, 𝛿u0mm corresponds to intrachannel
XPM (IXPM). All the other triplets satisfying l + m −n = 0 represent the echo pulses due to intrachannel
FWM (IFWM). Let us first calculate the variance of ‘1’ in BPSK systems. Let us assume that the bit in the
symbol slot is ‘1’, i.e., b0 = 1. Considering only the triplets that satisfy l + m −n = 0, Eq. (10.283) can be
written as
u(T = 0, Ltot) =
√
P0T0
T1(Ltot)
[
1 +
∞
∑
n=−∞,n≠0
bn exp
(
−n2T2
s
2T2
1
)]
+ 𝛾
⎡
⎢
⎢
⎢
⎢
⎢⎣
𝛿u000
⏟⏟⏟
SPM
+ 2
∞
∑
m=−∞
𝛿u0mm
⏟⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏟
IXPM
+
∑
l+m−n=0,l≠0,m≠0
𝛿ulmnblbmbn
⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏞⏟
IFWM
⎤
⎥
⎥
⎥
⎥
⎥⎦
.
(10.284)
The last term in Eq. (10.284) excludes SPM and IXPM. As can be seen from Eq. (10.284), the contribution
from SPM and IXPM leads to deterministic amplitude and phase changes. At the receiver, the dispersion
is fully compensated either in the optical domain or using the DSP (see Chapter 11). So, we assume that
T1(Ltot) = T0 in Eq. (10.284). For BPSK systems, the photocurrent is proportional to the real part of u(0, Ltot).
Setting the constant proportionality to be unity, the current at T = 0 can be written as
I = I0 + 𝛿I,
(10.285)

464
Fiber Optic Communications
where I0 is the mean current given by
I0 =
√
P0Re
{
1 + 𝛾
(
𝛿u000 + 2
∞
∑
m=−∞
𝛿u0mm
)}
(10.286)
and
𝛿I =
∞
∑
n=−∞,n≠0
bn𝛿ulin,n + 𝛾
∑
l+m−n=0,l≠0,m≠0
Re(𝛿ulmn)blbmbn,
(10.287)
where
𝛿ulin,n =
√
P0 exp (−n2T2
s ∕2T2
0).
(10.288)
For BPSK, we have
⟨bn⟩= 0,
(10.289)
⟨bnbm⟩= 𝛿nm,
(10.290)
where 𝛿nm is the Kronecker delta function. To calculate the variance, Eq. (10.287) is rewritten as
𝛿I = 𝛿Ilin + 𝛿IIFWM,d + 𝛿IIFWM,nd,
(10.291)
where 𝛿Ilin, 𝛿IIFWM,d, and 𝛿IIFWM,nd represent random currents due to linear ISI, degenerate IFWM, and
non-degenerate IFWM, respectively. An IFWM triplet is degenerate if l = m. From Eq. (10.287), we have
𝛿Ilin =
∞
∑
n=−∞,n≠0
bn𝛿ulin,n,
(10.292)
𝛿IIFWM,d = 𝛾
∑
l+m−n=0,l=m
Re{𝛿ulln}bn,
(10.293)
𝛿IIFWM,nd = 2𝛾
∑
l+m−n=0,l<m,l≠m≠n
Re{𝛿ulmn}blbmbn.
(10.294)
The factor 2 is introduced to account for the fact that the summation is carried out only over the region of
l < m. In Eqs. (10.293) and (10.294), the terms corresponding to intra-pulse SPM and IXPM are excluded.
The variance of 𝛿Ilin is
< 𝛿I2
lin >=
∑
m≠0
∑
n≠0
< bmbn > 𝛿ulin,m𝛿ulin,n,
(10.295)
Using Eq. (10.290), Eq. (10.295) simplifies to
< 𝛿I2
lin >=
∑
m≠0
𝛿u2
lin,m = P0
∑
m≠0
exp
(
−m2T2
s
T2
0
)
,
(10.296)
< 𝛿I2
IFWM,d > = 𝛾2
∑
l+m−n=0,l=m
∑
l′+m′−n′=0,l′=m′
Re[𝛿ulln]Re[𝛿ul′l′n′] < bnbn′ >
= 𝛾2
∑
l+m−n=0,l=m
(Re[𝛿ulln])2.
(10.297)
In Eq. (10.297), we have used Eq. (10.290) and when n = n′, l has to be equal to l′ to satisfy l + m −n = 0
and l′ + m′ −n′ = 0.

Nonlinear Effects in Fibers
465
Next consider the correlation between linear and degenerate IFWM,
< 𝛿Ilin𝛿IIFWM,d > = 𝛾
∑
l+m−n=0,l=m
∑
n′,n′≠0
Re[𝛿ulln]𝛿ulin,n′ < bnbn′ >
= 𝛾
√
P0
∑
l+m−n=0,l=m,n≠0
Re[𝛿ulln] exp
(
−n2T2
s
T2
0
)
.
(10.298)
The variance of 𝛿IIFWM,nd is
< 𝛿I2
IFWM,nd > = 4𝛾2
∑
l+m−n=0
l<m,l≠m≠n
∑
l′+m′−n′=0
l′<m′,l′≠m′≠n′
Re[𝛿ulmn]
Re[𝛿ul′m′n′] < blbmbnbl′bm′bn′ > .
(10.299)
Since < blbmbnbl′bm′bn′ >= 𝛿ll′𝛿mm′𝛿nn′, Eq. (10.299) is simplified as
< 𝛿I2
IFWM,nd >= 4𝛾2
∑
l+m−n=0,l<m,l≠m≠n
(Re{𝛿ulmn})2.
(10.300)
Using Eqs. (10.289) and (10.290) in Eq. (10.287), it is easy to show that
< 𝛿I >= 0,
(10.301)
𝜎2
PSK = < 𝛿I2 >=< 𝛿I2
lin > + < 𝛿I2
IFWM,d > + < 𝛿I2
IFWM,nd > +2 < 𝛿Ilin𝛿IIFWM,d >
+2 < 𝛿Ilin𝛿IIFWM,nd > +2 < 𝛿IIFWM,nd𝛿IIFWM,d > .
(10.302)
It can be shown that the correlation between degenerate IFWM and non-degenerate IFWM is zero and that
between linear ISI and non-degenerate IFWM is also zero. Hence, Eq. (10.302) becomes
𝜎2
PSK =< 𝛿I2
lin > + < 𝛿I2
IFWM,d > + < 𝛿I2
IFWM,nd > +2 < 𝛿Ilin𝛿IIFWM,d > .
(10.303)
Next, let us consider a direct detection OOK system. The photocurrent is
I ∝P = |u(T, Ltot)|2.
(10.304)
Setting the constant of proportionality to be unity and using Eq. (10.283),
I(T = 0) = |u0(T = 0, Ltot) + 𝛾u1(T = 0, Ltot)|2
= |u0(0, Ltot)|2 + 2𝛾Re{u0(0, Ltot)u∗
1(0, Ltot)} + 𝛾2|u1(0, Ltot)|2.
(10.305)
In Eq. (10.305), the first, second, and last terms on the right-hand side represent the currents due to the lin-
ear transmission, signal–nonlinear distortion beating, and nonlinear distortion–nonlinear distortion beating.
When the nonlinear distortion is small, the last term can be ignored. Eq. (10.305) can be written as
I = I0 + 𝛿Ilin + 𝛿Inl,
(10.306)
where
I0 = P0,
(10.307)

466
Fiber Optic Communications
𝛿Ilin ≈2
√
P0
∞
∑
n=−∞,n≠0
bn𝛿ulin,n,
(10.308)
𝛿Inl ≈2𝛾
√
P0
∑
l+m−n=0
blbmbnRe(𝛿ulmn).
(10.309)
The variance is calculated as (see Example 10.14)
𝜎2
OOK =< I2 > −< I>2
(10.310)
= 𝜎2
lin + 𝜎2
nl,
(10.311)
where
𝜎2
lin = P0
∞
∑
m=−∞
exp
(
−m2T2
s
T2
0
)
,
(10.312)
𝜎2
nl = 4𝛾2P0
∑
l+m−n=0
∑
l′+m′−n′=0
(
1
2x(l,m,n,l′,m′,n′) −
1
2r(l,m,n)−r(l′,m′,n′)
)
Re(𝛿ulmn)Re(𝛿ul′m′n′).
(10.313)
r(l, m, n) is the number of non-degenerate indices in the set {l, m, n} and x(l, m, n, l′, m′, n′) is the number of
non-degenerate indices in the set {l, m, n, l′, m′, n′}.
10.9.2
Numerical Simulations
To test the accuracy of the semi-analytical expressions for the variance, numerical simulation of the NLSE
is carried out using the symmetric split-step Fourier scheme (see Chapter 11). The fiber-optic link is shown
in Fig. 10.28. A dispersion-compensating fiber (DCF) is used for pre-, inline, and post-compensation. The
parameters of the transmission fiber (TF) and DCF are shown in Table 10.1. Two-stage EDFA is used with a
DCF between the amplifiers. Let the accumulated dispersions of the pre- and post-compensating fibers be pre
Opt.
Tx. 
Amp
TF
× N
Amp
DCF
Opt.
Rx.
Amp
Amp
Post-
compensation
Pre-
compensation
Figure 10.28
A typical fiber-optic transmission system. TF = transmission fiber, DCF = dispersion compensating fiber.
Table 10.1
Parameters of the transmission fiber and DCF.
Fiber type
D (ps/km/nm)
𝛾(W−1 km−1)
Loss (dB/km)
TF
17
1.1
0.2
DCF
−120
4.86
0.45

Nonlinear Effects in Fibers
467
and post, respectively. Dispersion of the TF is partially compensated by the in-line dispersion compensation.
Let res be the residual accumulated dispersion of a single span, i.e.,
res = DTFLTF + DinlineLinline,
(10.314)
where D and L denote the dispersion parameter (see Chapter 2) and length, respectively, and the subscripts
TF and inline correspond to the transmission fiber and inline DCF, respectively. We have assumed that the
total accumulated dispersion from transmitter to receiver is zero, i.e.,
pre + Nres + post = 0,
(10.315)
where N is the number of TF spans. The following parameters are used in the numerical simulation of the
direct detection OOK system. Bit rate = 40 Gb/s, pulsewidth (FWHM) = 5 ps, N = 10, peak powers launched
to TF and DCF are 10 dBm and 0 dBm, respectively. The lengths of pre-, inline, and post-compensating
fibers are chosen so that res = 100 ps/nm and post = pre = −500 ps/nm. The amplifier noise is turned off.
Two pulses centered at 25 ps and 50 ps are launched to the fiber-optic link. Owing to IFWM, echo pulses are
generated around 0 ps and 75 ps. The solid and broken lines in Fig. 10.29 show the echo pulses after 10 spans
obtained by the analytical expression (Eq. (10.281)) and numerical simulations, respectively. In this example,
a small pulse width is chosen so that the echo pulse is not affected by the ISI from the pulse centered at 25 ps.
In practice, short-duty-cycle pulses are rarely used because of the large bandwidth which leads to cross-talk
in WDM systems.
The percentage pre-compensation ratio is defined as
%pre-compensation ratio =
pre × 100
pre + post
.
(10.316)
Fig. 10.30 shows the variance as a function of pre-compensation ratio. The following parameters are used for
Fig. 10.30: pulsewidth (FWHM) = 12.5 ps, Dres = 100ps/nm, peak powers launched to TF and DCF are 0 dBm
–10
–5
0
5
10
–100
–80
–60
–40
–20
0
Time (ps) 
Power (dBm)
numeric
analytic
Figure 10.29
Comparison of the echo pulse power at the output obtained by the analytical expression (Eq. (10.281))
and numerical simulations. Two signal pulses centered around 25 ps and 50 ps are launched to the fiber (not shown in the
figure).

468
Fiber Optic Communications
0
20
40
60
80
100
0
0.5
1
1.5
× 10–3
% Pre−compensation
Variance (mW)
numeric
analytic
Figure 10.30
Variance of ‘1’ at the fiber output for an OOK direct detection system. res=100 ps/nm.
0
20
40
60
80
100
0
0.2
0.4
0.6
0.8
1
1.2 × 10–3
% Pre−compensation
Variance (mW)
Dres = 100 ps/nm
Dres = 150 ps/nm
Dres = 200 ps/nm
Figure 10.31
The variance of the signal amplitude calculated analytically for various residual accumulated dispersions
per span. The other parameters are the same as in Fig. 10.30.
and −3 dBm, respectively. The rest of the parameters are the same as in Fig. 10.29. To calculate the variance
of ‘1’, a 13-bit-long random bit sequence with the center bit being ‘1’ is transmitted over the fiber-optic link
in simulations. The bits are randomly varied, keeping the center bit fixed as ‘1’ and exhausting all possible
bit patterns. From Fig. 10.30, we see that the optimum pre-compensation ratio is about 90% when res =
100 ps/nm. However, if the residual dispersion per span is increased, the pre-compensation ratio is lowered,
as shown in Fig. 10.31.

Nonlinear Effects in Fibers
469
Example 10.6
A rectangular pulse of peak power 6 mW is transmitted over a dispersion-free fiber of length 40 km. Find the
nonlinear phase shift at the center of the pulse. Compare the exact results with those obtained using first- and
second-order perturbation theory. Assume fiber loss = 0.2 dB/km and 𝛾= 1.1 W−1 km−1.
Solution:
In the absence of dispersion, the field envelope evolution is given by the NLSE in lossless form (Eq. 10.246),
i 𝜕u
𝜕Z = −𝛾e−𝛼Z|u|2u.
(10.317)
Let
u = Aei𝜃.
(10.318)
Substituting Eq. (10.318) in Eq. (10.317), we find
idA
dZ ei𝜃−d𝜃
dZ Aei𝜃= −𝛾e−𝛼Z|A|2Aei𝜃.
(10.319)
Comparing the real and imaginary parts of Eq. (10.319), we find
dA
dZ = 0,
A = constant,
(10.320)
d𝜃
dZ = 𝛾e−𝛼Z|A|2,
(10.321)
𝜃(T, Z) −𝜃(T, 0) = 𝛾|A|2
∫
Z
0
e−𝛼ZdZ
= 𝛾|A|2Zeff,
(10.322)
Zeff = 1 −e−𝛼Z
𝛼
.
(10.323)
Note that A does not change as a function of Z, but it may depend on T. Since |u(T, Z)| = A does not change
with Z, we have
|u(T, 0)| = |u(T, Z)| = A.
(10.324)
Using Eq. (10.324) in Eqs. (10.322) and (10.318), we find
𝜃(T, Z) = 𝜃(T, 0) + 𝛾|u(T, 0)|2Zeff,
(10.325)
u(T, Z) = |u(T, 0)|ei[𝜃(T,0)+𝛾|u(T,0)|2Zeff]
(10.326)
= u(T, 0)ei𝛾|u(T,0)|2Zeff.
(10.327)
From Eqs. (2.177) and (10.323), we have
𝛼=
0.2
4.343 km−1 = 4.605 × 10−2 km−1,
(10.328)
Zeff = 1 −exp (−4.605 × 10−2 × 40)
4.605 × 10−2
= 18.27 km.
(10.329)

470
Fiber Optic Communications
The nonlinear phase shift is
𝜙NL(T) = 𝛾|u(T, 0)|2Zeff,
(10.330)
= 𝛾P(T, 0)Zeff.
(10.331)
At T = 0, we have
𝜙NL(0) = 1.1 × 10−3 × 6 × 10−3 × 18.27 × 103 = 0.1206 rad.
(10.332)
The Taylor expansion of Eq. (10.326) yields
u(T, Z) = u(T, 0)
{
1 + i𝛾|u(T, 0)|2Zeff −𝛾2
2! |u(T, 0)|4Z2
eff + · · ·
}
.
(10.333)
Here, the second and third terms on the right-hand sied of Eq. (10.333) represent the first-order and
second-order corrections due to nonlinear effects. First, let us consider only the first-order term
u(T, Z) = u(T, 0){1 + i𝛾|u(T, 0)|2Zeff}
(10.334)
= u(T, 0)B(T)ei𝜉(T),
(10.335)
where
B(T) =
√
1 + 𝛾2|u(T, 0)|4Z2
eff,
(10.336)
𝜉(T) = tan−1(𝛾|u(T, 0)|2Zeff).
(10.337)
At T = 0, we have
B(0) = 1.007,
(10.338)
𝜉(0) = 0.12002 rad.
(10.339)
B and 𝜉represent the amplitude shift and nonlinear phase shift using the first-order theory. Note that from the
exact solution given by Eq. (10.326), we see that there is no change in amplitude due to fiber nonlinearity;
the first-order approximation shows that the amplitude is shifted by a factor of 1.007.
Next, consider the terms up to second order in Eq. (10.333),
u(T, Z) = u(T, 0){x + iy},
(10.340)
x = 1 −𝛾2
2! |u(T, 0)|4Z2
eff,
(10.341)
y = 𝛾|u(T, 0)|2Zeff.
(10.342)
Let x + iy = Bei𝜉. Proceeding as before, we find
B(0) = 1.00002,
(10.343)
𝜉(0) = 0.12089 rad.
(10.344)
Comparing Eqs. (10.338) and (10.339) with Eqs. (10.343) and (10.344), we see that the second-order theory
is closer to the exact result.

Nonlinear Effects in Fibers
471
10.10
Nonlinear Phase Noise
So far we have ignored the nonlinear interaction between the signal and the ASE of inline amplifiers.
Owing to ASE, the amplitude or power of the optical signal fluctuates randomly about a mean value.
Since the nonlinear phase shift due to the SPM is proportional to power, the phase of the signal fluctuates
randomly. This type of noise was first studied by Gordon and Mollenauer [51] and, hence, this noise is also
known as Gordon-Mollenauer phase noise. The nonlinear phase-noise leads to performance degradations
in phase-modulated systems such as DPSK or QPSK systems. The analysis of nonlinear phase noise in
phase-modulated fiber-optic transmission systems has drawn significant attention [51–76]. In the following
section, we consider the impact of ASE when the nonlinear effects are absent and in Section 10.10.2, an
expression for the variance of phase noise including the SPM is derived.
10.10.1
Linear Phase Noise
Consider the output of the optical transmitter, sin(T), which is confined to the bit interval −Tb∕2 < T < Tb∕2.
Let
sin(T) = a0
√
Ep(T),
(10.345)
where a0 is the symbol in the interval −Tb∕2 < T < Tb∕2, p(T) is the pulse shape, E is the energy of the
pulse, and
∫
∞
−∞
|p(T)|2dT = 1.
(10.346)
For BPSK, a0 takes values 1 and −1 with equal probability. In this section, we ignore the fiber dispersion and
nonlinearity and include only fiber loss. To compensate for fiber loss, amplifiers are introduced periodically
along the transmission line with a spacing of La. The amplifier compensates for the loss exactly and introduces
ASE noise. Let us consider a single-span fiber-optic system with a single amplifier at the fiber output. Let the
amplifier compensate for the fiber loss exactly. The output of the amplifier may be written as
sout(T) = sin(T) + n(T),
(10.347)
where n(T) is the ASE noise which can be treated as white,
< n(T) >= 0,
(10.348)
< n(T)n∗(T′) >= 𝜌𝛿(T −T′),
(10.349)
< n(T)n(T′) >= 0,
(10.350)
where 𝜌is the ASE power spectral density per polarization given by (Eq. (6.17))
𝜌= nsphf(G −1).
(10.351)
Here, G is the gain of the amplifier, nsp is a spontaneous noise factor, h is Planck’s constant, and f is the mean
optical carrier frequency.
A signal of bandwidth B and duration Tb has 2J = 2BTb degrees of freedom (DOF). From the Nyquist
sampling theorem, it follows that if the highest frequency component of a signal is B∕2, the signal is described
completely by specifying the values of the signal at instants of time separated by 1∕B. Therefore, in the interval
Tb, there are BTb complex samples which fully describe the signal. Equivalently, the signal can be described

472
Fiber Optic Communications
by J complex coefficients (or 2J real coefficients) of the expansion in a set of orthonormal basis functions.
Let us represent the signal and noise fields using an orthonormal set of basis functions as
sin(T) =
J−1
∑
j=0
sjFj(T),
(10.352)
n(T) =
J−1
∑
j=0
njFj(T),
(10.353)
where {Fj(T)} is a set of orthonormal functions,
∫
∞
−∞
Fj(T)F∗
k(T)dT = 1 if j = k
= 0 otherwise.
(10.354)
Because of the orthogonality of the basis functions, it follows that
nj = ∫
∞
−∞
n(T)F∗
j (T)dT.
(10.355)
Using Eqs. (10.355) and (10.348)–(10.350), we obtain
< nj >= 0,
(10.356)
< njn∗
k > = 𝜌if j = k
= 0 otherwise,
(10.357)
< njnk) >= 0.
(10.358)
Using Eqs. (10.352) and (10.353) in Eq. (10.347), we find
sout(T) =
J−1
∑
j=0
(sj + nj)Fj(T).
(10.359)
Suppose ‘1’ is transmitted (a0 = 1). We choose F0(T) = p(T) so that
sj =
√
E if j = 0
= 0 otherwise.
(10.360)
Eq. (10.359) can be written as
sout(T) = (
√
E + n0)p(T) +
J−1
∑
j=1
njFj(T).
(10.361)
Let us assume that the signal power is much larger than the noise power and sin(T) is real. Let
n(T) = nr(T) + ini(T),
(10.362)

Nonlinear Effects in Fibers
473
where nr = Re{n(T)} and ni = Im{n(T)}. Eq. (10.347) can be written as
sout(T) = A(T) exp [i𝜙(T)],
(10.363)
where
A(T) = {[sin(T) + nr(T)]2 + n2
i (T)}1∕2,
(10.364)
𝜙(T) = tan−1
{
ni(T)
sin(T) + nr(T).
}
≈ni(T)
sin(T).
(10.365)
In Eq. (10.365), we have ignored higher-order terms such as n2
i and n2
r. Using Eqs. (10.352), (10.353),
(10.360), and (10.361) in Eq. (10.365), we obtain
𝜙(T) = n0i
√
E
+
J−1
∑
j=1
njiFj(T)
p(T)
√
E
,
(10.366)
where njr = Re{nj} and nji = Im{nj}. From Eqs. (10.366) and (10.356), it follows that
< 𝜙(T) >= 0.
(10.367)
Squaring and averaging Eq. (10.366) and using Eqs. (10.357) and (10.358), we obtain the variance of phase
noise as
𝜎2
lin =< 𝜙2 >= 𝜌
2E + 𝜌
2E
J−1
∑
j=1
F2
m(T)
F2
0(T)
.
(10.368)
Next, let us consider the impact of a matched filter on the phase noise. When a matched filter is used, the
received signal is
r = ∫
∞
−∞
sout(T)F∗
0(T)dT.
(10.369)
Substituting Eq. (10.361) in Eq. (10.369) and using Eq. (10.354), we obtain
r = (
√
E + n0).
(10.370)
Note that the higher-order noise components given by the second term on the right-hand side of Eq. (10.361)
do not contribute because of the orthogonality of basis functions. Now, Eq. (10.368) reduces to
𝜎2
lin =
< n2
0i >
E
= 𝜌
2E.
(10.371)
From Eq. (10.370), we see that when a matched filter is used, the noise field is fully described by two degrees
of freedom, namely, the in-phase component n0r and the quadrature component n0i. The other degrees of
freedom are orthogonal to the signal and do not contribute after the matched filter. From Eq. (10.371), we see
that the quadrature component n0i is responsible for the linear phase noise.

474
Fiber Optic Communications
10.10.2
Gordon–Mollenauer Phase Noise
The optical field envelope in a fiber-optic transmission system can be described by the NLSE in the lossless
form (Eq. (10.246)),
i 𝜕u
𝜕Z −𝛽2(Z)
2
𝜕2u
𝜕T2 = −𝛾a2(Z)|u|2u.
(10.372)
Amplifier noise effects can be introduced in Eq. (10.372) by adding a source term on the right-hand side,
which leads to
i 𝜕u
𝜕Z −𝛽2(Z)
2
𝜕2u
𝜕T2 = −𝛾a2(Z)|u|2u + iR(Z, T),
(10.373)
where
R(Z, T) =
Na
∑
m=1
𝛿(Z −mLa)n(T).
(10.374)
Here, Na is the number of amplifiers and n(T) is the noise field due to ASE, with statistical properties defined
in Eqs. (10.348)–(10.350).
In this section, we first consider the case in which the fiber dispersion is zero. Let us consider the solution
of Eq. (10.373) in the absence of noise. Let
u(Z, T) = A(Z, T) exp [i𝜙(Z, T)],
(10.375)
and
u(0, T) =
√
Ep(T).
(10.376)
Substituting Eq. (10.375) in Eq. (10.372), we find
dA
dZ = 0 →A(Z, T) = A(0, T) =
√
E|p(T)|,
(10.377)
d𝜙
dZ = 𝛾a2(Z)|u(0, T)|2
= 𝛾a2(Z)E|p(T)|2.
(10.378)
Solving Eq. (10.378), we find
𝜙(Z, T) = 𝛾E|p(T)|2
∫
Z
0
a2(s)ds,
(10.379)
u(Z, T) = u(0, T) exp
[
i𝛾|u(0, T)|2
∫
Z
0
a2(s)ds
]
.
(10.380)
We assume that the signal pulse shape is rectangular, with pulse width Tb. From Eq. (10.346), it follows that
|p(T)|2 = 1∕Tb. Since a2(Z) = exp (−𝛼0Z) between amplifiers, we have
∫
mLa−
0
a2(Z)dZ = mLeff,
(10.381)
where
Leff = 1 −exp (−𝛼0La)
𝛼0
.
(10.382)

Nonlinear Effects in Fibers
475
Substituting Eq. (10.381) in Eqs. (10.379) and (10.380), we find
𝜙(mLa−, T) = 𝛾EmLeff
Tb
,
(10.383)
u(mLa−, T) =
√
Ep(T) exp [i𝜙(mLa−)].
(10.384)
Next, let us consider the case when there is only one amplifier located at mLa that introduces ASE noise.
The optical field envelope after the amplifier is
u(mLa+, T) = u(mLa−, T) + n(T).
(10.385)
We assume that two degrees of freedom in the noise field are of importance. They are the in-phase component
n0r and the quadrature component n0i; we ignore other noise components. As mentioned in Section 10.10.1,
the noise field is fully described by these two degrees of freedom for a linear system. Gordon and Mollenauer
[51] assumed that these two degrees of freedom are adequate to describe the noise field even for a nonlinear
system. Using Eqs. (10.384) and (10.353) in Eq. (10.385), we find
u(mLa+, T) =
√
Ep(T) exp [i𝜙(mLa−)] + n0p(T)
= (
√
E + n′
0)p(T) exp [i𝜙(mLa−)],
(10.386)
where
n′
0 = n0 exp [−i𝜙(mLa−)].
(10.387)
n′
0 is the same as n0, except for a deterministic phase shift which does not alter the statistical properties, i.e.,
< n′
0 >= 0,
(10.388)
< n′
0n′
0
∗>= 𝜌,
(10.389)
< n′
0n′
0 >= 0.
(10.390)
From Eq. (10.386), we see that the complex amplitude of the field envelope has changed because of the
amplifier noise. Using u(mLa+, T) as the initial condition, the NLSE (10.372) is solved to obtain the field at
the end of the transmission line as
u(Ltot, T) = u(mLa+, T) exp
{
i𝛾|u(mLa+, T)|2
∫
Ltot
mLa+
a2(Z)dZ
}
= (
√
E + n′
0)p(T) exp [i𝜙(mLa−) + i𝛾|
√
E + n′
0|2(Na −m)Leff∕Tb],
(10.391)
where Ltot = NaLa is the total transmission distance. The phase at Ltot is
𝜙= tan−1
⎧
⎪
⎨
⎪⎩
n′
0i
√
E + n′
0r
⎫
⎪
⎬
⎪⎭
+
𝛾|
√
E + n′
0|2(Na −m)Leff
Tb
+ 𝛾EmLeff
Tb
≈
n′
0i
√
E
+ 𝛾(E + 2
√
En′
0r)(Na −m)Leff∕Tb + 𝛾EmLeff∕Tb.
(10.392)

476
Fiber Optic Communications
The total phase given by Eq. (10.392) can be separated into two parts:
𝜙= 𝜙d + 𝛿𝜙,
(10.393)
where 𝜙d is the deterministic nonlinear phase shift given by
𝜙d = 𝛾ENaLeff∕Tb
(10.394)
and 𝛿𝜙represents the phase noise,
𝛿𝜙=
n′
0i
√
E
+
2𝛾
√
En′
0r(Na −m)Leff
Tb
.
(10.395)
The first and second terms in Eq. (10.395) represent the linear and nonlinear phase noise, respectively. As
can be seen, the in-phase component n′
0r and the quadrature component, n′
0i are responsible for nonlinear and
linear phase noise, respectively. From Eq. (10.388), it follows that
< 𝛿𝜙>= 0.
(10.396)
Squaring and averaging Eq. (10.395) and using Eqs. (10.389) and (10.390), we find the variance of the phase
noise as
𝜎2
m = 𝜌
2E + 2𝜌E
[𝛾(Na −m)Leff
Tb
]2
.
(10.397)
So far, we have ignored the impact of ASE due to other amplifiers. In the presence of ASE due to other
amplifiers, the expression for the optical field envelope at mLa−given by Eq. (10.384) is inaccurate since it
ignores the noise field added by the amplifiers preceding the mth amplifier. However, when the signal power
is much larger than the noise power, second-order terms such as n2
0r and n2
0i can be ignored. At the end of the
transmission line, the dominant contribution would come from the linear terms n0i and n0i of each amplifier.
Since the noise fields of amplifiers are statistically independent, the total variance is the sum of the variance
due to each amplifier,
𝜎2 =
Na
∑
m=1
𝜎2
m
= 𝜌Na
2E + 2𝜌E
[𝛾Leff
Tb
]2 Na−1
∑
m=1
(Na −m)2
= 𝜌Na
2E +
(Na −1)Na(2Na −1)𝜌E𝛾2L2
eff
3T2
b
.
(10.398)
Refs. [55–58] provide a more rigorous treatment of the nonlinear phase noise without ignoring the
higher-order noise terms. From Eq. (10.398), we see that the variance of the linear phase noise (the first
term on the right-hand side) increases linearly with the number of amplifiers, whereas the variance of the
nonlinear phase noise (the second term) increases cubically with the number of amplifiers when Na is
large, indicating that nonlinear phase noise could be the dominant penalty for ultra-long-haul fiber-optic
transmission systems. In addition, the variance of linear phase noise is inversely proportional to the energy of
the pulse, whereas the variance of nonlinear phase noise is directly proportional to the energy. This implies

Nonlinear Effects in Fibers
477
that there exists an optimum energy at which the total phase variance is minimum. By setting d𝜎2∕dE to
zero, the optimum energy is calculated as
Eopt =
Tb
𝛾Leff
√
3
2(Na −1)(2Na −1).
(10.399)
When Na is large, (Na −1)(2Na −1) ≈2N2
a and using Eq. (10.394), we find that the phase variance is
minimum when the deterministic nonlinear phase shift 𝜙d ≈0.87 rad. Eqs. (10.397) and (10.398) are derived
under the assumption that dispersion is zero. In the presence of dispersion, Eq. (10.397) is modified as [60]
𝜎2
m = 𝜌
2E + 2𝜌E[𝛾gfr(mLa)2],
(10.400)
where
gfr(x) = T0
√
𝜋
Re
{
∫
Ltot
x
G(s)ds
}
,
(10.401)
G(s) =
a2(s)
√
(1 + T2
0Δ(s))(T4
0 + 3S2(s) + 2iT2
0S(s))
,
(10.402)
Δ(s) =
T2
0 −iS(s)
T2
0[T2
0 + i3S(s)]
.
(10.403)
T0 and S(z) are defined in Section 10.9. If a dispersion-managed fiber with zero mean dispersion per span is
used, the total variance can be expressed in a form similar to Eq. (10.398) [60],
𝜎2 = 𝜌Na
2E +
(Na −1)Na(2Na −1)𝜌E(𝛾hfr)2
3
,
(10.404)
hfr = T0
√
𝜋
Re
{
∫
La
0
G(s)ds
}
,
(10.405)
Comparing Eqs. (10.398) and (10.404), we see that these two expressions are the same except that Leff∕T0
is replaced by hfr. For a highly dispersive system, hfr is much smaller than Leff∕T0 and, hence, the variance
of nonlinear phase noise due to SPM is much smaller in a highly dispersive system. Eq. (10.404) does not
include contributions due to IXPM. Even if IXPM contributions are included, numerical simulations have
shown that for highly dispersive systems, the variance of nonlinear phase noise (signal–noise interaction)
is much smaller than that due to IFWM and IXPM (signal–signal interactions). In a WDM system, interac-
tion between ASE and XPM leads to nonlinear phase noise as well [76]. Using the digital back propagation
technique discussed in Chapter 11, it is possible to compensate for deterministic (symbol pattern-dependent
signal–signal interactions) nonlinear effects, but not for nonlinear phase noise (signal–ASE interactions).
So, when the DBP is used to compensate for intra- and interchannel nonlinear impairments, nonlinear phase
noise is likely to be one of the dominant impairments.
Example 10.7
A rectangular pulse of peak power 2 mW and pulse width 25 ps is transmitted over a periodically amplified
dispersion-free fiber-optic transmission system operating at 1550 nm. The fiber-optic link consists of 20
amplifiers with an amplifier spacing of 80 km. The parameters of the link are as follows: nonlinear coefficient

478
Fiber Optic Communications
𝛾= 1.1 W−1 km−1, loss coefficient 𝛼= 0.0461 km−1, spontaneous emission factor nsp = 1.5. Find the
variance of (a) linear phase noise, (b) nonlinear phase noise at the receiver.
Solution:
The PSD of ASE is
𝜌= hf(G −1)nsp,
G = exp (𝛼La) = exp (0.0461 × 80) = 39.96,
f = c
𝜆=
3 × 108
1550 × 10−9 Hz = 193.54 THz,
𝜌= 6.626 × 10−34 × 193.54(39.96 −1) × 1.5 J = 7.495 × 10−18 J.
The pulse energy is
E = PTb = 2 × 10−3 × 25 × 10−12 J = 5 × 10−14 J.
The variance of linear phase noise is
𝜎2
lin = Na𝜌
2E = 20 × 7.495 × 10−18
2 × 5 × 10−14
rad2 = 1.499 × 10−3 rad2.
The effective length is
Leff = 1 −exp (−𝛼La)
𝛼
= 1 −exp (−0.0461 × 80)
0.0461
km = 21.14 km.
The variance of the nonlinear phase noise is
𝜎2
nl =
(Na −1)Na(2Na −1)𝜌E𝛾2L2
eff
3T2
b
= 19 × 20 × 39 × 7.495 × 10−18 × 5 × 10−14 × (1.1 × 10−3 × 21.14 × 103)2
3 × (25 × 10−12)2
rad2
= 1.603 × 10−3 rad2.
The total variance is
𝜎2
tot = 𝜎2
lin + 𝜎2
nl
= 1.499 × 10−3 + 1.603 × 10−3 rad2
= 3.102 × 10−3 rad2.
10.11
Stimulated Raman Scattering
When a light wave propagates in a medium, a small fraction of light emerges in directions other than that
of the incident wave. Most of the scattered light has the same frequency as the incident light, a small part
has frequencies different from the incident light. This phenomenon was first observed by Raman [77] (and

Nonlinear Effects in Fibers
479
Vibrational
state
Virtual energy
state
Stokes Raman
Scattering
Anti-Stokes Raman
Scattering
Ω = ωp – ωs = ωa – ωp
ħΩ
ħωp
ħωs
ħωp
ħωa
Figure 10.32
Stokes and anti-Stokes Raman scattering.
independently by Landsberg and Manderlstam [78]) in 1928. The molecules in the medium have several
vibrational states (or phonon modes). When a light wave (photons) interacts with sound waves (phonons), the
frequency of the light wave is shifted up or down. The shift in frequency gives information about the phonon
modes of the molecules. When the scattered photon has a frequency lower than the incident photon, it is
known as Stokes shift. Stokes Raman scattering can be described quantum mechanically as the annihilation
of a pump photon of energy ℏ𝜔p and the creation of a Stokes photon of lower energy ℏ𝜔s, and absorption
of the energy ℏ(𝜔p −𝜔s) by the molecules by making transition from a low-energy vibrational state to a
high-energy vibrational state (see Fig. 10.32). A lower-energy photon has lower frequency and, therefore,
Stokes Raman scattering leads to a red shift of the incident light wave. If the molecule makes transition from
a high-energy vibrational state to a low-energy vibrational state in the presence of an incident pump of energy
ℏ𝜔p, the difference in energy is added to the incident photon, leading to a photon of higher energy ℏ𝜔a (which
is of higher frequency). This is known as anti-Stokes Raman scattering. Raman scattering is quite useful in
chemistry, since vibrational information is specific to the chemical bonds and symmetry of molecules.
Spontaneous Raman scattering is typically very weak. In 1962, it was found that an intense-pump optical
wave can excite molecular vibrations and, thereby, stimulate molecules to emit photons of reduced energy
(a Stokes wave), to which most of the pump energy is transferred [79]. This is known as stimulated Raman
scattering. The interaction between the pump and the Stokes wave is described by the following coupled
equations under CW conditions [80]:
ds
dZ = gRps −𝛼ss,
(10.406)
dp
dZ = −
𝜔p
𝜔s
gRps −𝛼pp,
(10.407)
where p and s are the optical intensities of the pump and the Stokes waves, respectively, 𝛼p and 𝛼s are the
fiber loss coefficients at the pump and the Stokes frequencies, respectively, and gR(Ω), Ω = 𝜔p −𝜔s is the
Raman gain coefficient. The amplification of the Stokes wave by the pump wave can be understood from
Eqs. (10.406) and (10.407). To simplify the analysis, we assume that the pump intensity is much larger than

480
Fiber Optic Communications
the Stokes intensity so that the depletion of the pump due to Stokes wave amplification can be ignored. Eq.
(10.407) may be approximated as
dp
dZ ≅−𝛼pp,
(10.408)
p(Z) = p(0)e−𝛼pZ.
(10.409)
From Eq. (10.406), we have
ds
s
= gRp(0)e−𝛼pZ −𝛼s.
(10.410)
Integrating Eq. (10.410) from 0 to L, we obtain
In
(s(L)
s(0)
)
= gRp(0)Leff,p −𝛼sL,
(10.411)
where the effective length of the pump, Leff,p, is given by
Leff,p =
1 −exp (−𝛼pL)
𝛼p
.
(10.412)
Rearranging Eq. (10.411), we find
s(L) = s(0)e−𝛼sL+gRp(0)Leff,p.
(10.413)
The Stokes wave is amplified if gRp(0)Leff,p > 𝛼sL. If a signal (Stokes wave) is down-shifted in frequency
by about 14 THz, it would have the highest amplification since gR(Ω) is maximum when the frequency shift
is about 14 THz (see Fig. 6.21).
Example 10.8
Stokes and pump beams co-propagate in a fiber of length 2 km. The Raman coefficient of the fiber gR =
1 × 10−13 m/W, input Stokes’s signal power = −10 dBm, input pump power = 20 dBm, 𝛼s = 0.046 km−1,
𝛼p = 0.08 km−1, and effective area of the fiber = 40 μm2. Calculate the Stokes signal power at the fiber output.
Solution:
The Stokes and pump powers in a fiber may be approximated as
p,s ≅
Pp,s
Aeff
.
(10.414)
So, Eq. (10.413) can be rewritten as
Ps(L) = Ps(0)e−𝛼sL+gRPp(0)Leff,p∕Aeff,
(10.415)
Pp(0) (dBm) = 20 dBm.
(10.416)
Pp(0) = 10Pp(0) (dBm)∕10 mW
= 100 mW,
(10.417)
Ps(0) (dBm) = −10 dBm,
(10.418)

Nonlinear Effects in Fibers
481
Ps(0) = 10Ps(0) (dBm)∕10 mW
= 0.1 mW,
(10.419)
Leff,p =
1 −exp (−𝛼pL)
𝛼p
= 1 −exp (−0.08 × 2)
0.08 × 10−3
= 1.848 km,
(10.420)
gRPp(0)Leff,p
Aeff
= 1 × 10−13 × 100 × 10−3 × 1.848 × 103
40 × 10−12
= 0.462,
(10.421)
𝛼sL = 0.092.
(10.422)
So, the gain dominates the loss. From Eq. (10.413), we find
Ps(L) = Ps(0)e−0.092+0.462
= 0.1447 mW.
(10.423)
10.11.1
Time Domain Description
In the time domain, stimulated Raman scattering can be explained as follows [81]. When a high-intensity
optical pulse interacts with a molecule, it perturbs the electronic structure of the molecule and results in
intensity-dependent polarizability of the molecule (see Section 10.2). This electronic effect occurs on a time
scale shorter than the pulse width of the optical pulse, and it can be considered instantaneous. However,
perturbation of the electronic structure by the optical pulse also perturbs the Coloumb interaction between the
nuclei and the electronic structure, which can excite molecular vibrations. These vibrations, in turn, perturb the
electronic structure, leading to a delayed change in polarizability. The time- and intensity-dependent change
in polarizability (or equivalent refractive index) associated with the excitation of a molecular vibration is the
Raman effect, whereas the instantaneous intensity-dependent change in polarizability is the Kerr effect.
As mentioned in Section 10.4, the Kerr effect is taken into account by the term 𝛾|q|2q in the nonlinear
Schrödinger equation. In the presence of the Raman effect, it can be modified as [82]
𝛾|q(T, Z)|2 →𝛾(1 −𝛼)|q(T, Z)|2 + 𝛾𝛼∫
∞
−∞
h(s)|q(T −s, Z)|2ds,
(10.424)
where 𝛼is the fraction of the nonlinearity resulting from the Raman contributions and h(T) is the normalized
Raman response function, with
∫
∞
−∞
h(T)dT = 1
(10.425)
and h(−|t|) = 0 to ensure causality. The response function h(T) is specific to the medium and the imaginary
part of its Fourier transform is related to the Raman gain coefficient g(Ω) [81, 83]. Let
P(T, Z) = |q(T, Z)|2,
(10.426)
P(T −s, Z) = |q(T −s, Z)|2.
(10.427)

482
Fiber Optic Communications
The Taylor series expansion of P(T −s, Z) around T is
P(T −s, Z) = P(T, Z) −s𝜕P
𝜕T + s2
2
𝜕2P
𝜕T2 + …
(10.428)
If the spectral width of the signal is sufficiently small, terms that are proportional to s2 and beyond may be
ignored. Under this condition, Eq. (10.424) becomes
𝛾|q(T, Z)|2 →𝛾(1 −𝛼)|q(T, Z)|2 + 𝛾𝛼∫
∞
−∞
[
|q(T, Z)|2 −s𝜕|q(T, Z)|2
𝜕T
]
h(s)ds.
(10.429)
Using Eq. (10.425), Eq. (10.429) is rewritten as
𝛾|q(T, Z)|2 →𝛾|q(T, Z)|2 −𝜅𝜕|q(T, Z)|2
𝜕T
,
(10.430)
where
𝜅= 𝛾𝛼∫
∞
−∞
sh(s)ds.
(10.431)
Substituting Eq. (10.430) in Eq. (10.81), we obtain
i 𝜕q
𝜕Z −𝛽2
2
𝜕2q
𝜕T2 + 𝛾|q|2q + i𝛼q
2 = 𝜅𝜕|q(T, Z)|2
𝜕T
q.
(10.432)
Eq. (10.432) is the modified nonlinear Schrodinger equation and the term on the right-hand side denotes
the Raman contributions. The energy exchange between the pump and the Stokes waves can be understood
from Eq. (10.432) by considering the pump and Stokes waves as CW:
q = qp + qs,
(10.433)
qp = Ape−iΩpT,
(10.434)
qs = Ase−iΩsT,
(10.435)
where Ap and As denote the complex amplitudes of pump and Stokes’s waves, respectively, and Ωp and Ωs
are the corresponding angular frequency offset from the reference. Let us first consider
|q|2 = |Ap|2 + |As|2 + ApA∗
se−iΩT + A∗
pAseiΩT,
(10.436)
𝜕|q|2
𝜕T q = (−iΩ)Ap|As|2e−iΩpT + (iΩ)As|Ap|2e−iΩsT + terms at 2Ωp −Ωs
and
2Ωs −Ωp,
(10.437)
where
Ω = Ωp −Ωs.
(10.438)
Substituting Eq. (10.437) in Eq. (10.432) and collecting the terms that are proportional to e−iΩpT and e−iΩsT,
we find
i
dAp
dZ + 𝛽2
2 Ω2
pAp + 𝛾{|Ap|2 + 2|As|2}Ap = −i𝜅Ω|As|2Ap −𝛼Ap,
(10.439)
idAs
dZ + 𝛽2
2 Ω2
sAs + 𝛾{|As|2 + 2|Ap|2}As = i𝜅Ω|Ap|2As −𝛼As.
(10.440)

Nonlinear Effects in Fibers
483
Eqs. (10.439) and (10.440) represent the evolution of the complex amplitudes of the pump and the Stokes
waves. To obtain the expression for the energy exchange between the pump and the Stokes waves, we multiply
Eq. (10.439) by A∗
p and subtract its complex conjugate to obtain
dPp
dZ = −gPpPs −𝛼Pp,
(10.441)
where Pp = |Ap|2 and g = 2𝜅Ω. Similar operations on Eq. (10.440) leads to
dPs
dZ = gPpPs −𝛼Ps.
(10.442)
From Eqs. (10.441) and (10.442), we see that the gain coefficients at the pump and the Stokes frequencies are
identical, but they are not the same in Eqs. (10.406) and (10.407). This is because of our linear approximation
(first term in the Taylor expansion) to the Raman time response function.
SRS has a number of applications. If an intense Raman pump is launched to the fiber, it can amplify a weak
signal if the frequency difference lies within the bandwidth of the Raman gain spectrum. SRS can also be used
to construct Raman fiber lasers which can be tuned over a wide frequency range (∼10 THz) [84–88]. In other
types of fiber amplifiers, the SRS process can be detrimental since the pump energy is used to amplify the
range of wavelengths over which amplification is not desired. In WDM systems, a channel of higher frequency
transfers energy to a channel of lower frequency, leading to Raman cross-talk and performance degradations
[89–91].
10.12
Additional Examples
Example 10.9
When the bandwidth of the WDM signal and/or the dispersion slope are large, 𝛽3 can not be ignored. In this
case, show that the phase mismatch factor given by Eq. (10.216) should be modified as
Δ𝛽jkln = (ΩlΩn −ΩjΩk)
[
𝛽2 + 𝛽3
2 (Ωj + Ωk)
]
.
(10.443)
Solution:
𝛽j = 𝛽0 + 𝛽1Ωj + 𝛽2
2 Ω2
j + 𝛽3
6 Ω3
j ,
(10.444)
Ωn = Ωj + Ωk −Ωl.
(10.445)
Consider the contribution to the phase mismatch Δ𝛽jkln due to the last term of Eq. (10.444),
𝛽3
6 [Ω3
j + Ω3
k −Ω3
l −Ω3
n] = 𝛽3
6 [Ω3
j + Ω3
k −Ω3
l −(Ωj + Ωk −Ωl)3].
(10.446)
Using the formula
(a + b + c)3 = a3 + b3 + 3a2b + 3ab2 + c3 + 3(a + b)2c + 3(a + b)c2,
(10.447)

484
Fiber Optic Communications
Eq. (10.446) is simplified as
𝛽3
6 {Ω3
j + Ω3
k −Ω3
l −[Ω3
j + Ω3
k + 3Ω2
j Ωk + 3ΩjΩ2
k −Ω3
l −3(Ωj + Ωk)2Ωl + 3(Ωj + Ωk)Ω2
l ]}
= −𝛽3
6 {3ΩjΩk(Ωj + Ωk) + 3(Ωj + Ωk)Ωl(Ωl −Ωj −Ωk)}
= −𝛽3
2 (Ωj + Ωk){ΩjΩk −ΩlΩn}.
(10.448)
Adding the contributions due to 𝛽3 and 𝛽2, Eq. (10.216) is modified as
Δ𝛽jkln = [ΩlΩn −ΩjΩk]
[
𝛽2 + 𝛽3
2 (Ωj + Ωk)
]
.
(10.449)
Example 10.10
A WDM system has five channels centered at lΔf, l = −2, −1, 0, 1, 2, Δf = 50 GHz. The launch power
per channel is 3 dBm, and the channels are CW. The transmission fiber has the following parameters:
𝛼= 0.046 km−1, L = 20 km, 𝛽2 = −4 ps2/km, and 𝛾= 1.8 W−1 km−1. The initial phases of the channels are
𝜃−2 = 0.5 rad, 𝜃−1 = −0.7 rad, 𝜃0 = 1.2 rad, 𝜃1 = 0.8 rad, and 𝜃2 = −1 rad. Find the FWM power on the
central channel (l = 0). Ignore 𝛽3.
Solution:
The FWM tones falling on the central channel should satisfy the condition
(j + k −l)Δf = nΔf = 0.
(10.450)
The possible triplets are shown in Table 10.2. Here, ND and D refer to non-degenerate and degenerate FWM
tones, respectively. From Eq. (10.216), we see that Δ𝛽jkln is invariant under the exchange of j and k, i.e.,
Δ𝛽jkln = Δ𝛽kjln.
(10.451)
Hence, the FWM tones corresponding to {j, k, l} and {k, j, l} should be identical. For example, the triplets
{−2, 1, −1} and {1, −2, −1} produce identical FWM tones. So, we need to consider only the tones listed in
Table 10.3. First consider the triplet {−2, 1, −1}. The FWM field for this triplet is given by Eq. (10.221),
𝜖(−2,1,−1,0)
0
(L) = i𝛾P3∕2e−𝛼L
2 +iΔ𝜃−2,1,−1 (1 −e−𝛿−2,1,−1,0L)
𝛿−2,1,−1,0
,
(10.452)
𝛿−2,1,−1,0 = 𝛼−iΔ𝛽−2,1,−1,0
= 𝛼+ i𝛽2Ω−2Ω1
= 0.046 × 10−3 −i4 × 10−27 × (2𝜋× 50 × 109)2 × (−2) m−1
= 4.6 × 10−5 + 7.89 × 10−4i m−1,
(10.453)

Nonlinear Effects in Fibers
485
Δ𝜃−2,1,−1 = 0.5 + 0.8 −(−0.7)
rad
= 2 rad,
(10.454)
P(dBm) = 3 dBm,
(10.455)
P(mW) = 10P(dBm)∕10 mW
= 2 mW.
(10.456)
Substituting Eqs. (10.453), (10.454), and (10.456) in Eq. (10.452), we find
𝜖(−2,1,−1,0)
0
(L) = (−0.8 + 1.6 i) × 10−4 √
W.
(10.457)
Similarly, the FWM fields due to other triplets are
𝜖(−2,2,0,0)
0
(L) = (3.33 × 10−7 −3.92 × 10−5 i)
√
W,
(10.458)
𝜖(−1,−1,−2,0)
0
(L) = (2.03 + 1.9 i) × 10−4 √
W,
(10.459)
𝜖(−1,1,0,0)
0
(L) = (2.28 −1.6 i) × 10−4 √
W,
(10.460)
𝜖(−1,2,1,0)
0
(L) = (−1.4 −1.12 i) × 10−4 √
W,
(10.461)
𝜖(1,1,2,0)
0
(L) = (1.435 −2.394 i) × 10−4 √
W.
(10.462)
The total FWM field is
𝜖0 = 2𝜖(−2,1,−1,0) + 2𝜖(−2,2,0,0) + 2𝜖(−1,1,0,0) + 2𝜖(−1,2,1,0) + 𝜖(1,1,2,0) + 𝜖(−1,−1,−2)
= (3.64 −3.509 i) × 10−4 √
W.
(10.463)
The FWM power at the fiber output is
PFWM = |𝜖0|2 = 2.56 × 10−4 mW.
(10.464)
Table 10.2
FWM tones on the central channel.
j
k
l
Type
−2
1
−1
ND
−2
2
0
ND
−1
−1
−2
D
−1
1
0
ND
−1
2
1
ND
1
−2
−1
ND
1
−1
0
ND
1
1
2
D
2
−2
0
ND
2
−1
1
ND

486
Fiber Optic Communications
Table 10.3
FWM tones on the central channel with the degeneracy factor.
Tone number
Number of tones
j
k
l
Type
1
2
−2
1
−1
ND
2
2
−2
2
0
ND
3
2
−1
1
0
ND
4
2
−1
2
1
ND
5
1
1
1
2
D
6
1
−1
−1
−2
D
Example 10.11
For a single-span dispersion-free fiber, find the nonlinear distortion up to second order using the perturbation
theory.
Solution:
When 𝛽2 = 0, from Eq. (10.252), we have
idu1
dZ = −a2(Z)|u0|2u0.
(10.465)
For a single-span system, a2(Z) = exp (−𝛼Z). From Eq. (10.255), we have u0 = k. Integrating Eq. (10.465)
and using u1(T, 0) = 0, we obtain
u1(T, Z) = iZeff|k|2k,
(10.466)
where
Zeff = 1 −exp (−𝛼Z)
𝛼
.
(10.467)
From Eq. (10.253), we have
du2
dZ = i exp (−𝛼Z)(2iZeff|k|4k −iZeff|k|4k)
= exp (−𝛼Z) −exp (−2𝛼Z)
𝛼
(−|k|4k).
(10.468)
Integrating Eq. (10.468), we obtain
u2(T, Z) = −
[1 −exp (−𝛼Z)
𝛼2
−1 −exp (−2𝛼Z)
2𝛼2
]
|k|4k
= −|k|4k
2
Z2
eff.
(10.469)
The total solution up to second order is
u = u0 + 𝛾u1 + 𝛾2u2
= k
(
1 + i𝛾|k|2Zeff −𝛾2|k|4Zeff
2
2)
.
(10.470)

Nonlinear Effects in Fibers
487
Example 10.12
The evolution of the complex field envelope in a periodically amplified fiber-optic system is governed by
i 𝜕q
𝜕Z −𝛽2(Z)
2
𝜕2q
𝜕T2 + 𝛾(Z)|q|2q = −i𝛼(Z)
2 q + iA
N
∑
n=1
𝛿(Z −nLa)q(T, nLa−),
(10.471)
where
𝛽2(Z) = 𝛽20
for 0 < mod(Z, La) < La
= 0
otherwise,
(10.472)
𝛾(Z) = 𝛾0
for 0 < mod(Z, La) < La
= 0
otherwise
(10.473)
𝛼(Z) = 𝛼0
for 0 < mod(Z, La) < La
= 0
otherwise
(10.474)
Using the transformation
q(Z, T) = a(Z)u(Z, T),
(10.475)
show that
i 𝜕u
𝜕Z −𝛽2(Z)
2
𝜕2u
𝜕T2 + 𝛾
2a2(Z)|u|2u = 0,
(10.476)
a(Z) = e−𝛼0Z∕2
for 0 < mod(Z, La) < La
= 1
otherwise.
(10.477)
Assume that the fiber loss is exactly compensated by the amplifier gain.
Solution:
Consider the propagation over a short length from nLa−to nLa−+ ΔZ corresponding to the amplifier located
at nLa. In this short length, 𝛽2(Z) = 𝛾(Z) = 𝛼(Z) = 0. Integrating Eq. (10.471) from nLa−to nLa−+ ΔZ, we
obtain
i ∫
nLa−+ΔZ
nLa−
dq
dZ dZ = iA ∫
nLa−+ΔZ
nLa−
𝛿(Z −nLa)q(T, nLa−),
(10.478)
q(T, nLa−+ ΔZ) −q(T, nLa−) = Aq(T, nLa−),
(10.479)
q(T, nLa−+ ΔZ)
q(T, nLa−)
= A + 1.
(10.480)
Since q(T, nLa−+ ΔZ) and q(T, nLa−) represent the amplifier output and input, respectively, we have
q(T, nLa−+ ΔZ) =
√
Gq(T, nLa−),
(10.481)

488
Fiber Optic Communications
where G = exp (𝛼0La) is the power gain of the amplifier. Comparing Eqs. (10.480) and (10.481), we find
A =
√
G −1.
(10.482)
Substituting Eq. (10.475) in Eq. (10.471), we find
iu da
dZ + ia 𝜕u
𝜕Z −𝛽2(Z)
2
a 𝜕2u
𝜕T2 + 𝛾a2|q|2q = −i𝛼(Z)
2 au
+i(
√
G −1)
N
∑
n=1
𝛿(Z −nLa)a(nLa−)u(T, nLa−).
(10.483)
Let
u da
dZ = −𝛼au
2
+ (
√
G −1)
N
∑
n=1
𝛿(Z −nLa)a(nLa−)u(T, nLa−),
(10.484)
so that Eq. (10.483) becomes
i 𝜕u
𝜕Z −𝛽2
2
𝜕2u
𝜕T2 + 𝛾a2(Z)|u|2u = 0.
(10.485)
Note that the optical field q increases abruptly at amplifier locations. Using the transformation of Eq. (10.475),
the amplitude fluctuations due to fiber loss and amplifier gain are separated out so that u(T, Z) changes
smoothly as a function of Z, i.e.,
u(T, nLa−) = u(T, nLa+).
(10.486)
Consider the region 0 < mod(Z, La) < La. In this region, 𝛼(Z) = 𝛼0 and the second term on the right-hand
side of Eq. (10.484) is zero. Solving Eq. (10.484), we find
a(Z) = a(0)e−𝛼0Z∕2.
(10.487)
Here a(0) could be chosen arbitrarily. For convenience, let a(0) = 1. Next, consider the length from nLa−to
nLa−+ ΔZ. Integrating Eq. (10.484) from nLa−to nLa−+ ΔZ, we find
a(nLa−+ ΔZ) −a(nLa−) = (
√
G −1)a(nLa−),
(10.488)
a(nLa−+ ΔZ) =
√
Ga(nLa−) =
√
Ge−𝛼0La∕2 = 1.
(10.489)
Combining Eqs. (10.489) and (10.487), we find
a(Z) = e−𝛼0Z∕2
for 0 < mod(Z, La) < La
= 1
otherwise.
(10.490)
Fig. 10.33 shows a plot of a(Z) as a function of Z. Note that a(Z) jumps by
√
G at the amplifier locations.

Nonlinear Effects in Fibers
489
z
2La
La
nLa
1
a(z)
G
Figure 10.33
Plot of a(Z) vs. distance Z.
Example 10.13
Show that the Fourier transformation of |u0|2u0 is
{|u0|2u0} =
P3∕2
0 T3
0
|T1|2T1
√
𝜋
C
∑
lmn
blbmbn exp [g + (i𝜔−d)2∕4C],
where
u0 =
√
P0T0
T1
∞
∑
n=−∞
bn exp
[
−(T −nTs)2
2T2
1
]
,
C =
3T2
0 + iS
2(T4
0 + S2)
,
d =
[(l + m + n)T2
0 + i(l + m −n)S]Ts
T4
0 + S2
,
g =
[(l2 + m2 + n2)T2
0 + (l2 + m2 −n2)iS]T2
s
2(T4
0 + S2)
.
Solution:
Let
rl = exp
[
−(T −lTs)2
2T2
1
]
,
(10.491)
|u0|2u0 = u0u0u∗
0 =
P3∕2
0 T3
0
|T1|2T1
∞
∑
l=−∞
blrl
∞
∑
m=−∞
bmrm
∞
∑
n=−∞
bnr∗
n
=
P3∕2
0 T3
0
|T1|2T1
∑
lmn
blbmbnrlrmr∗
n,
(10.492)

490
Fiber Optic Communications
rlrmr∗
n = exp
[
−(T −lTs)2 −(T −mTs)2
2T2
1
−(T −nTs)2
2(T2
1)∗
]
= exp [−(CT2 −dT) −g],
(10.493)
where
C =
3T2
0 + iS
2(T4
0 + S2)
,
(10.494)
d =
[(l + m + n)T2
0 + i(l + m −n)S]Ts
T4
0 + S2
,
(10.495)
g =
[(l2 + m2 + n2)T2
0 + (l2 + m2 −n2)iS]T2
s
2(T4
0 + S2)
.
(10.496)
{rlrmr∗
n} = exp (−g) ∫
∞
−∞
exp [−(CT2 −dT) −i𝜔T]dT
= exp (−g) ∫
∞
−∞
exp [−C(T2 + 2xT + x2) + Cx2]dt,
(10.497)
where
x = i𝜔−d
2C
.
(10.498)
{rlrmr∗
n} = exp (−g + Cx2) ∫
∞
−∞
exp [−C(T + x)2]dT.
(10.499)
Let
u =
√
C(T + x)
and
du =
√
CdT,
(10.500)
{rlrmr∗
n} = exp (−g + Cx2) 1
√
C ∫
∞
−∞
exp (−u2)du
=
√
𝜋
C exp [−g + (i𝜔−d)2∕4C],
(10.501)
{|u0|2u0} =
P3∕2
0 T3
0
|T1|2T1
√
𝜋
C
∑
lmn
blbmbn exp [g + (i𝜔−d)2∕4C].
(10.502)
Example 10.14
Find the variance of ‘1’ in a direct detection OOK system due to linear and nonlinear distortion.
Solution:
From Eq. (10.308), we obtain
< 𝛿I2
lin >= 4P0
∞
∑
n=−∞
n≠0
∞
∑
m=−∞
m≠0
< bnbm > 𝛿ulin,n𝛿ulin,m.
(10.503)

Nonlinear Effects in Fibers
491
For OOK, we have
< bn >= 1∕2,
(10.504)
< bnbm >=
{
1∕4
if n ≠m
1∕2
if n = m,
(10.505)
< 𝛿I2
lin >= P0
⎡
⎢
⎢
⎢
⎢⎣
∞
∑
n=−∞
n≠0
2𝛿u2
lin,n +
∞
∑
m=−∞
m≠0
m≠n
∞
∑
n=−∞
n≠0
𝛿ulin,m𝛿ulin,n
⎤
⎥
⎥
⎥
⎥⎦
,
(10.506)
< 𝛿Ilin >=
√
P0
∞
∑
n=−∞
n≠0
𝛿ulin,n,
(10.507)
𝜎2
lin =< 𝛿I2
lin > −< 𝛿Ilin>2 = P0
∞
∑
n=−∞
n≠0
𝛿u2
lin,n = P0
∞
∑
n=−∞
n≠0
exp
[
−m2T2
s
T2
0
]
.
(10.508)
From Eq. (10.309), we have
< 𝛿Inl >= 2𝛾
√
P0Re
[
∑
l+m−n=0
< blbmbn > 𝛿ulmn
]
,
(10.509)
< blbmbn >=
1
2r(l,m,n) ,
(10.510)
where r(l, m, n) is the number of non-degenerate indices in the set {l, m, n}. For example, if {l, m, n} = {2, 5, 7},
none of the indices are equal (l ≠m ≠n) and hence r(l, m, n) = 3; in a set {l, m, n} = {0, 3, 3} (l ≠m = n),
r(l, m, n) = 2; if l = m = n, r(l, m, n) = 1.
< 𝛿I2
nl >= 4𝛾2P0
∑
l+m−n=0
∑
l′+m′−n′=0
< blbmbnb′
lb′
mb′
n > Re(𝛿ulmn)Re(𝛿ul′m′n′),
(10.511)
< blbmbnb′
lb′
mb′
n >=
1
2x(l,m,n,l′,m′,n′) ,
(10.512)
where x(l, m, n, l′, m′, n′) is the number of non-degenerate indices in a set {l, m, n, l′, m′, n′}. For example, if
{l, m, n, l′, m′, n′} = {1, 2, 3, 2, 3, 5}, x is 4. Using Eqs. (10.509) and (10.511), the variance is calculated as
𝜎2
nl = < 𝛿I2
nl > −< 𝛿Inl>2
= 4𝛾2P0
∑
l+m−n=0
∑
l′+m′−n′=0
(
1
2x(l,m,n,l′,m′,n′) −
1
2r(l,m,n)+r(l′,m′,n′)
)
Re(𝛿ulmn)Re(𝛿ul′m′n′). (10.513)
Exercises
10.1
Discuss the origin of the nonlinear refractive index.

492
Fiber Optic Communications
10.2
A Kerr medium has a cross-sectional area of 500 μm2. Calculate the optical power required to change
the refractive index by 10−8. Assume n2 = 3 × 10−20 m2/W.
(Ans: 166.66 W.)
10.3
The nonlinear coefficient of a single-mode fiber is 1.2 W−1 km−1. Calculate the effective area. Assume
n2 = 2.5 × 10−20 m2/W and wavelength = 1530 nm.
(Ans: 85 μm2.)
10.4
A fiber-optic system has the following parameters: span length = 75 km, number of spans = 20,
fiber loss = 0.21 dB/km, Kerr coefficient n2 = 2.6 × 10−20 m2/W, wavelength 𝜆0 = 1540 nm, effec-
tive area = 50 μm2. Find the upper limit on the transmitter output power so that the nonlinear phase
shift accumulated over 20 spans is less than 0.5 rad.
(Ans: 0.585 mW.)
10.5
The effective length of a fiber Leff is 18 km and fiber loss = 0.17 dB/km. Find the fiber length.
(Ans: 31.15 km.)
10.6
A single Gaussian pulse of width (FWHM) 20 ps and a peak power of 10 mW is transmitted in a
dispersion-free fiber over 80 km. Find the nonlinear phase shift at the center of the pulse at the fiber
output. Assume 𝛾= 2.2 W−1 km−1 and fiber loss = 0.2 dB/km.
(Ans: 0.465 rad.)
10.7
Solve the previous exercise numerically using the split-step Fourier scheme (see Chapter 11) and
verify the analytical calculations.
10.8
Repeat Exercise 10.7 if 𝛽2 = −2 ps2/km (instead of 0 ps2/km). Is the nonlinear phase shift at the center
of the pulse smaller? Explain.
10.9
Explain the differences between the instantaneous frequency of a pulse due to (i) SPM, (ii) anomalous
dispersion, and (iii) normal dispersion.
10.10
Discuss the properties of a soliton in single-mode fibers.
10.11
A modulated pump with a modulating frequency of 8 GHz co-propagated with a weak CW signal.
Fiber loss = 0.18 dB/km, length L = 80 km, walk-off parameter d = 13.2 ps/km, signal wavelength
= 1530 nm, and pump wavelength = 1530.78 nm. Calculate the XPM efficiency.
(Ans: 9.72 × 10−4.)
10.12
Explain the differences between XPM and FWM.
10.13
A WDM system consists of three channels centered at Δf, 2Δf, and 3Δf with Δf = 100 GHz. Fiber
loss coefficient 𝛼= 0.0461 km−1, fiber length L = 60 km, and 𝛽2 = −4 ps2/km. Calculate the effi-
ciency of non-degenerate as well as degenerate FWM tones at 4Δf. Ignore 𝛽3.
(Ans: Non-degenerate, 2.27 × 10−4; degenerate, 8.66 × 10−4.)

Nonlinear Effects in Fibers
493
10.14
Two Gaussian pulses of width 40 ps separated by 25 ps are transmitted in a dispersion-free fiber over
80 km. Find the nonlinear phase shift at the center of either of the pulses at the fiber output. Assume
𝛾= 2.2 W−1 km−1, fiber loss = 0.2 dB/km, and peak power = 4 mW.
(Ans: 0.466 rad.)
10.15
In a 10-Gb/s fiber-optic system based on BPSK operating at 1530 nm there are Na in-line amplifiers
with a noise figure of 4.5 dB. NRZ rectangular pulses are used with a mean power of 0 dBm. The
fiber parameters are as follows: 𝛾= 2.2 W−1 km−1 and 𝛼= 0.0461 km−1. The variances of linear
and nonlinear phase noises at the fiber output are found to be 2.27 × 10−3 rad2 and 3.98 × 10−3 rad2,
respectively. Calculate the amplifier spacing. Ignore dispersion.
(Ans: 100 km.)
10.16
Discuss stimulated Raman scattering in optical fibers.
10.17
In a partially Raman amplified fiber-optic system, it is desired that the gain provided by the Raman
pump is 10 dB. The Raman coefficient of the fiber = 1 × 10−13 m/W, signal loss 𝛼s = 0.046 km−1,
pump loss 𝛼p = 0.09 km−1, length = 80 km, and effective area of the fiber = 80 μm2. Assuming that
the pump co-propagates with the signal, calculate the input pump power.
(Ans: 431 mW.)
Further Reading
G.P. Agrawal, Nonlinear Fiber Optics, 3rd edn. Academic Press, San Diego, CA, 2001.
R.W. Boyd, Nonlinear Optics, 3rd edn. Academic Press, San Diego, CA, 2007.
Y.R. Shen, Principles of Nonlinear Optics. John Wiley & sons, Hoboken, NJ, 2003.
A. Hasegawa and M. Matsumoto, Optical Solitons in Fibers, 3rd edn. Springer-Verlag, Berlin, 2003.
N. Bloembergen, Nonlinear Optics, 4th edn. World Scientific, Singapore, 1996.
J.V. Moloney and A.C. Newell, Nonlinear Optics. Westview Press, Boulder, CO, 2004.
References
[1] A.E. Siegman, Lasers. University Science Books, Sausalito, CA, 1986.
[2] V.E. Zakharov and A.B. Shabat, Sov. Phys. JETP, vol. 34, p. 62, 1972.
[3] V.E. Zakharov and F. Calogero, What is Integrability? Springer-Verlag, Berlin, 1991.
[4] S. Novikov, S.V. Manakov, L.P. Pitaevskii, and V.E. Zakharov, Theory of Solitons: The inverse scattering method.
Consultants Bureau, New York, 1984.
[5] M.J. Ablowitz, B. Fuchssteiner, and M. Kruskal, Topics in Soliton Theory and Exactly Solvable Nonlinear Equations.
World Scientific, Singapore, 1987.
[6] G.L. Lamb Jr., Elements of Soliton Theory. John Wiley & Sons, New York, 1980.
[7] A. Hasegawa and F. Tappert, Appl. Phys. Lett., vol. 23, p. 171, 1973.
[8] L.F. Mollenauer, R.H. Stolen, and J.P. Gordon, Phys. Rev. Lett., vol. 45(13), p. 1095, 1980.
[9] L.F. Mollenauer, R.H. Stolen, J.P. Gordon, and W.J. Tomlinson, Opt. Lett., vol. 8(5), p. 289, 1983.
[10] R.H. Stolen, L.F. Mollenauer, and W.J. Tomlinson, Opt. Lett., vol. 8(3), p. 186, 1983.
[11] I.S. Gradshteyn and I.M. Ryzhik, Table of Integrals, Series and Products, 6th edn. Academic Press, San Diego,
2000.

494
Fiber Optic Communications
[12] L.F. Mollenauer, S.G. Evangelides, and J.P. Gordon, J. Lightwave Technol., vol. 9, p. 362, 1991.
[13] A. Hasegawa, S. Kumar, and Y. Kodama, Opt. Lett., vol. 21, p. 39, 1996.
[14] T.K. Chiang, N. Kagi, M.E. Marhic, and L.G. Kazovsky, J. Lightwave Technol., vol. 14(3), p. 249, 1996.
[15] D. Marcuse, A.R. Chraplyvy, and R.W. Tkach, J. Lightwave Technol., vol. 12(5), p. 885, 1994.
[16] R. Hui, Y. Wang, K. Demarest, and C. Allen, IEEE Photon. Technol. Lett., vol. 10(9), p. 1271, 1998.
[17] R. Hui, K. Demarest, and C. Allen, J. Lightwave Technol., vol. 17(6), p. 1018, 1999.
[18] A.T. Cartaxo, J. Lightwave Technol., vol. 17(2), p. 178, 1999.
[19] Z. Jiang and C. Fan, J. Lightwave Technol., vol. 21(4), p. 953, 2003.
[20] S. Kumar and D. Yang, J. Lightwave Technol., vol.23(6), p. 2073, 2005.
[21] Z. Tao et al., J. Lightwave Technol., vol. 29(7), p. 974, 2011.
[22] J. Wang and K. Petermann, J. Lightwave Technol., vol. 10(1), p. 96, 1992.
[23] K. Inoue, IEEE Photon. Technol. Lett., vol. 10(11), p. 1553, 1992.
[24] R.W. Tkach, J. Lightwave Technol., vol. 13(5), p. 841, 1995.
[25] M. Nazarathy et al., Opt. Expr., vol. 16, p. 15,777, 2008.
[26] M. Nazarathy and R. Weidenfeld. In S. Kumar (ed.), Impact of Nonlinearities on Fiber Optic Communications.
Springer-Verlag, New York, 2011, chapter 3.
[27] Y. Chen and A.W. Snyder, Opt. Lett., vol. 14(1), p. 87, 1989.
[28] K. Inoue, IEEE Photon. Technol. Lett., vol. 8(2), p. 293, 1996.
[29] S. Burtsev et al., European Conference on Optical Communication, Nice, France, 1999.
[30] F. Matera et al., Opt. Commun., vol. 181(4–6), p. 407, 2000.
[31] S. Kumar, J. Lightwave Technol., vol. 23(1), p. 310, 2005.
[32] A. Akhtar, L. Pavel, and S. Kumar, J. Lightwave Technol., vol. 24(11), p. 4269, 2006.
[33] J. Du, Opt. Commun., vol. 282(14), p. 2983, 2009.
[34] K. Inoue, J. Lightwave Technol., vol. 12(6), p. 1023, 1994.
[35] P.V. Mamyshev and N.A. Mamysheva, Opt. Lett., vol. 24, p. 1454, 1999.
[36] R.J. Essiambre, B. Mikkelsen, and G. Raybon, Electron. Lett., vol. 35, p. 1576, 1999.
[37] I. Shake et al., Electron. Lett., vol. 34, p. 1600, 1998.
[38] A. Mecozzi, C.B. Clausen, and M. Shtaif, IEEE Photon. Technol. Lett., vol. 12, p. 292, 2000.
[39] M.J. Ablowitz and T. Hirooka, Opt. Lett., vol. 25, p. 1750, 2000.
[40] P. Killey et al., IEEE Photon. Technol. Lett., vol. 12, p. 1264, 2000.
[41] S. Kumar, IEEE Photon. Technol. Lett., vol. 13, p. 800, 2001.
[42] S. Kumar et al., IEEE J. Quant. Electron., vol. 8, p. 626, 2002.
[43] R.J. Essiambre, G. Raybon, and B. Mikkelsen. In I.P. Kaminov and T. Li (eds), Optical Fiber Telecommunications
IVB. Academic Press, New York, 2002, chapter 6.
[44] D. Yang and S. Kumar, J. Lightwave Technol., vol. 27, p. 2916, 2009.
[45] S. Turitsyn, M. Sorokina, and S. Derevyanko, Opt. Lett., vol. 37, p. 2931, 2012.
[46] A. Bononi et al., Opt. Exp., vol. 20, p. 7777, 2012.
[47] T. Yu et al., Opt. Lett., vol. 22, p. 793, 1997.
[48] A. Mecozzi et al., IEEE Photon. Technol. Lett., vol. 13, p. 445, 2001.
[49] M. Matsumoto, IEEE Photon. Technol. Lett., vol. 10, p. 373, 1998.
[50] A. Hasegawa and Y. Kodama, Opt. Lett., vol. 15, p. 1443, 1990; vol. 66, p. 161, 1991.
[51] J.P. Gordon and L.F. Mollenauer, Opt. Lett., vol. 15(23), p. 1351, 1990.
[52] H. Kim and A.H. Gnauck, IEEE Photon. Technol. Lett., vol. 15, p. 320, 2003.
[53] P.J. Winzer and R.-J. Essiambre, J. Lightwave Technol., vol. 24, no. 12, p. 4711, 2006.
[54] S.L. Jansen et al., IEEE J. Lightwave Technol., vol. 24, p. 54–64, 2006.
[55] A. Mecozzi, J. Lightwave Technol., vol. 12(11), p. 1993, 1994.
[56] K.-P. Ho, J. Opt. Soc. Am. B, vol. 20(9), p. 1875, 2003.
[57] K.-P. Ho, Opt. Lett., vol. 28(15), p. 1350, 2003.
[58] A. Mecozzi, Opt. Lett., vol. 29(7), p. 673, 2004.
[59] A.G. Green, P.P. Mitra, and L.G.L. Wegener, Opt. Lett., vol. 28, p. 2455, 2003.
[60] S. Kumar, Opt. Lett., vol. 30, p. 3278, 2005.
[61] C.J. McKinstrie, C. Xie, and T. Lakoba, Opt. Lett., vol. 27, p. 1887, 2002.

Nonlinear Effects in Fibers
495
[62] C.J. McKinstrie and C. Xie, IEEE J. Select. Top. Quantum Electron., vol. 8, p. 616, 2002.
[63] M. Hanna, D. Boivin, P.-A. Lacourt, and J.-P. Goedgebuer, J. Opt. Soc. Am. B, vol. 21, p. 24, 2004.
[64] K.-P. Ho and H.-C. Wang, IEEE Photon. Technol. Lett., vol. 17, p. 1426, 2005.
[65] K.-P. Ho and H.-C. Wang, Opt. Lett., vol. 31, p. 2109, 2006.
[66] F. Zhang, C.-A. Bunge, and K. Petermann, Opt. Lett., vol. 31(8), p. 1038, 2006.
[67] P. Serena, A. Orlandini, and A. Bononi, J. Lightwave Technol., vol. 24(5), p. 2026, 2006.
[68] X. Zhu, S. Kumar, and X. Li, Appl. Opt., vol. 45, p. 6812, 2006.
[69] A. Demir, J. Lightwave Technol., vol. 25(8), p. 2002, 2007.
[70] S. Kumar and L. Liu, Opt. Exp., vol. 15, p. 2166, 2007.
[71] M. Faisal and A. Maruta, Opt. Commun., vol. 282, p. 1893, 2009.
[72] S. Kumar, J. Lightwave Technol., vol. 27(21), p. 4722, 2009.
[73] A. Bononi, P. Serena, and N. Rossi, Optical Fiber Tech., vol. 16, p. 73, 2010.
[74] X. Zhu and S. Kumar, Opt. Expr., vol. 18(7), p. 7347, 2010.
[75] S. Kumar and X. Zhu. In S. Kumar (ed.), Impact of Nonlinearities on Fiber Optic Communications. Springer-Verlag,
New York, 2011, chapter 7.
[76] K.-P. Ho. In S. Kumar (ed.), Impact of Nonlinearities on Fiber Optic Communications. Springer-Verlag, New York,
2011, chapter 8.
[77] C.V. Raman, Ind. J. Phys., vol. 2, p. 387, 1928.
[78] G. Landsberg and L. Mandelstam, Naturwiss., vol. 16(28), p. 557, 1928.
[79] E.J. Woodbury and W.K. Ng, Proceedings of IRE50, 1962, p. 2347.
[80] G.P. Agrawal, Nonlinear Fiber Optics 3rd edn. Academic Press, San Diego, CA, 2001, chapter 8.
[81] R.H. Stolen et al., J. Opt. Soc. Am. B, vol. 6(6), p. 1159, 1989.
[82] R.H. Stolen and W.J. Tomlinson, J. Opt. Soc. Am. B, vol. 9(4), p. 565, 1992.
[83] J.P. Gordon, Opt. Lett., vol. 11, p. 662, 1986.
[84] K.O. Hill, B.S. Kawasaki, and D.C. Johnson, Appl. Phys. Lett., vol. 28(10), p. 608, 1976.
[85] R.H. Stolen, C. Lin, and R.K. Jain, Appl. Phys. Lett., vol. 30(7), p. 340, 1977.
[86] M. Nakazawa, T. Masamitsu, and N. Uchida, J. Opt. Soc. Am. B, vol. 1(1), p. 86, 1984.
[87] A.J. Stentz, Proceedings of SPIE 3263, Nonlinear Optical Engineering, 1998, p. 91.
[88] Y. Li et al., J. Lightwave Technol., vol. 23(5), p. 1907, 2005.
[89] F. Forghieri et al. In I. Kaminov and T.L. Koch (eds), Optical Fiber Telecommunications IIIA. Academic Press, San
Diego, 1997.
[90] J. Wang, X. Sun, and M. Zhang et al., IEEE Photon. Technol. Lett., vol. 10, p. 540, 1998.
[91] M. Muktoyuk and S. Kumar, IEEE Photon. Technol. Lett., vol. 15, p. 1222, 2003.


11
Digital Signal Processing
11.1
Introduction
The key component that revived coherent fiber communications in the mid-2000 was high-speed digital signal
processing. In the 1990s, coherent receivers used optical phase-locked loops (OPLL) to align the phases and
dynamic polarization controllers to match the polarization of the received signal with that of the LO. However,
dynamic polarization controllers are bulky and expensive [1], and each channel of a WDM system needs a
separate polarization controller. Phase locking in the optical domain using OPLL is difficult as well. With
the advances in high-speed DSP, phase alignment and polarization management can be done in the electrical
domain, as discussed in Sections 11.5 and 11.7, respectively. Linear impairments such as chromatic dispersion
(CD) and polarization mode dispersion can be compensated using equalizers, as discussed in Sections 11.6
and 11.7, respectively. It is also possible to compensate for the interplay between dispersion and nonlinearity
by using digital back propagation (DBP), in which the nonlinear Schrödinger equation is solved for a virtual
fiber whose signs of dispersion, loss, and nonlinear coefficients are opposite to those of the transmission fiber.
DBP is discussed in Section 11.8.
11.2
Coherent Receiver
Fig. 11.1 shows a schematic of the coherent IQ receiver with digital signal processing. The in-phase and
quadrature components of the received signal can be written as (see Chapter 5, Eqs. (5.114) and (5.118))
yI = RArALORe{s(t) exp [−i(𝜔IFt + Δ𝜙)]}∕2,
(11.1)
yQ = RArALOIm{s(t) exp [−i(𝜔IFt + Δ𝜙)]}∕2,
(11.2)
where s(t) is the transmitted data:
s(t) =
∑
m
amg(t −mTs),
(11.3)
Ts is the symbol period, and g(t) represents the pulse shape. Eqs. (11.1) and (11.2) have to be modified to take
into account the noise and delays due to 90∘hybrids:
yI = KRe{s(t −𝛿I) exp [−i(2𝜋fIF(t −𝛿I) + Δ𝜙)] + n(t)},
(11.4)
yQ = KIm{s(t −𝛿Q) exp [−i(2𝜋fIF(t −𝛿Q) + Δ𝜙)] + n(t)},
(11.5)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

498
Fiber Optic Communications
90°
Hybrid
PDs
and
front end
ADC
ADC
yI
yQ
yI,l
yQ,l
DSP
LO
Received
optical signal
Figure 11.1
Block diagram of a coherent IQ receiver. LO = local oscillator, PDs = photodiodes, ADC =
analog-to-digital converter, DSP = digital signal processing.
where K = R
√
PrPLO∕2, n(t) represents noise due to ASE and shot noise, and 𝛿I and 𝛿Q are the delays
introduced by 90∘hybrids and other parts of the coherent receiver. The constant K has no impact on the
performance. So, from now on, we set it to unity. An ADC discretizes the analog signal at a sampling rate
Rsamp ≥Bs, where Bs = 1∕Ts is the symbol rate. Typically, two samples per symbol are required. The samples
are combined into a complex number. The outputs of the ADC are written as
yI,l = Re{sI,l exp [−i(2𝜋fIF(tl −𝛿I,l) + Δ𝜙l)] + nl},
(11.6)
yQ,l = Im{sQ,l exp [−i(2𝜋fIF(tl −𝛿Q,l) + Δ𝜙l)] + nl},
l = 1, 2, … ,
(11.7)
where sI,l and sQ,l are the samples of s(t −𝛿I) and s(t −𝛿Q), respectively, at t = lTsamp, Tsamp = 1∕Rsamp. nl is
the sample of the noise at t = lTsamp. DSP performs the complex addition to obtain the received signal as
yl = yI,l + iyQ,l.
(11.8)
In general, 𝛿I could be different from 𝛿Q. Therefore, sI,l and sQ,l may be different, and the real and imaginary
parts of ̃yl may not correspond to the same symbol, which could lead to symbol errors. However, this is a
systematic error and can be corrected easily. Using the DSP, the delays experienced by I- and Q-channels can
be removed. After correcting for 𝛿I and 𝛿Q, we have
yl = xl exp [−i(2𝜋fIFtl + Δ𝜙l)] + nl,
l = 1, 2, … ,
(11.9)
where xl = sl ≡s(lTsamp).
11.3
Laser Phase Noise
The output of a single-frequency laser is not strictly monochromatic but rather has frequency deviations that
change randomly. The output field of a fiber-optic transmitter may be written as
qT(t) = ATs(t) exp {−i[2𝜋fct −𝜙(t)]},
(11.10)
where s(t) is the data, fc is the laser mean frequency, and 𝜙(t) is the laser phase noise. The instantaneous
frequency deviation can be written as (see Eq. (2.165))
fi = −1
2𝜋
d𝜙
dt .
(11.11)
The instantaneous frequency deviation is a zero-mean Gaussian noise process with standard deviation 𝜎f .
Integrating Eq. (11.11), it follows that
𝜙(t) = 𝜙(t0) −2𝜋∫
t
t0
fi(𝜏)d𝜏
(11.12)

Digital Signal Processing
499
is a Wiener process. If the interval (t −t0) is sufficiently small, the integration can be replaced by the rectan-
gular rule. With (t −t0) = Tsamp,
𝜙(t) = 𝜙(t −Tsamp) −2𝜋fi(t −Tsamp)Tsamp.
(11.13)
After discretization, Eq. (11.13) becomes
𝜙l = 𝜙l−1 −2𝜋fi,l−1Tsamp,
(11.14)
where t = lTsamp. The phase noise can be interpreted as a one-dimensional random walk [2]. As an example,
consider a drunken man walking randomly on the road. Suppose that at every step there is a 50% chance
that he moves either forward or backward. After two steps, there is a 25% chance that he has moved two
steps forward, a 25% chance that he has moved two steps backward, and 50% chance that he is at his initial
position. After many steps, the mean distance traversed would be close to zero and there would be a large
number of different paths he could have traversed. Since the chance of moving forward or backward at a given
step is independent of the decision at the previous steps, the variance of distance traversed is proportional to
the number of steps. Similarly, in the case of laser phase noise, the phase of the sample n is incremented by
−2𝜋Tsampfi,l−1, where fi,l−1 is a value of instantaneous frequency picked from the Gaussian distribution. From
Eq. (11.14), we have
𝛿𝜙l ≡𝜙(l) −𝜙(0) = −2𝜋Tsamp
l−1
∑
m=0
fi,m.
(11.15)
Squaring Eq. (11.15), averaging, and noting that the frequency deviations at each step are independent, we
find
< 𝛿𝜙2
l >= 4𝜋2T2
sampl𝜎2
f .
(11.16)
Note that the phase variance is proportional to l. Solving the laser rate equations with Langevin noise terms,
we find [3]
< 𝛿𝜙2
l >= 2𝜋Δ𝜈lTsamp,
(11.17)
where Δ𝜈is the laser linewidth (FWHM). Comparing Eqs. (11.16) and (11.17), we find
𝜎2
f =
Δ𝜈
2𝜋Tsamp
.
(11.18)
Fig. 11.2 shows a few possible evolutions of the laser phase 𝜙(t) when the linewidth Δ𝜈is 5 MHz. Fig. 11.3
shows the evolutions of the phase for two different linewidths. It can be seen that the phase fluctuation is
larger as the linewidth increases.
The phase noise is present in the LO output as well, and the LO output field may be written as
qLO(t) = ALO exp {−i[2𝜋fLOt + 𝜙LO(t)]},
(11.19)
with
< 𝛿𝜙2
LO,l >= 2𝜋Δ𝜈LOlTsamp,
(11.20)
where Δ𝜈LO is the linewidth of LO. The received signal after discretization is given by Eq. (11.9), with
Δ𝜙l = 𝜙TX,l + 𝜙p −𝜙LO,l,
(11.21)

500
Fiber Optic Communications
500
1000
1500
2000
*1.5
*1
*0.5
0
0.5
1
1.5
Sample # 
Phase (rad)
Figure 11.2
Evolution of laser phase noise. Each curve corresponds to a different realization of the phase noise. The
laser linewidth = 1 MHz for all curves.
200
400
600
800
1000
1200
1400
1600
1800
2000
*1.5
*1
*0.5
0
0.5
1
1.5
Sample # 
Phase (rad)
lw = 20 KHz
lw = 1 MHz
Figure 11.3
Laser phase noise evolution for two different linewidths; lw = linewidth. The fluctuations increase with
linewidth and time.
where 𝜙TX,l is the phase noise due to the transmitter laser and 𝜙p is the constant phase shift due to propagation.
The variance of Δ𝜙l is
𝜎2
Δ𝜙= < 𝛿𝜙2
TX,l > + < 𝛿𝜙2
LO,l >
= 2𝜋{Δ𝜈TX + Δ𝜈LO}lTsamp.
(11.22)
Here, we have assumed 𝜙TX,0 = 𝜙LO,0 = 0 and ignored dispersion and nonlinear effects in the fiber-optic
channel.

Digital Signal Processing
501
11.4
IF Estimation and Compensation
Nowadays, coherent optical communication systems use free-running LO lasers without any optical/digital
phase-locked loop (PLL). A typical temperature-stabilized DFB laser has a frequency fluctuation of about
±1.25 GHz [4]. External cavity lasers (ECLs) with linewidths < 100 kHz are also available. Typically, the
symbol rate is ≥10 GBaud and, therefore, coherent receivers with free-running LO lasers may be considered
as intradyne receivers [5]. A constant IF offset causes the absolute value of the phase to increase with time,
which leads to erroneous phase decisions. IF offset should be removed before channel synchronization if the
intermediate frequency fIF > 12.5% of symbol rate Bs, or it can be removed after channel synchronization
if fIF < 12.5% of Bs [6]. After channel synchronization, the complex signal is given by Eq. (11.9). There
are various techniques to estimate fIF, such as the phase increment algorithm [6, 7], Tratter IF estimation
algorithm, and Kay IF estimation algorithm [8]. In this book, we consider the phase increment algorithm
because of its simplitity. In the absence of laser phase noise (Δ𝜙l = 0) and phase modulation (xl = 1), the
phase shift between two consecutive samples yl, yl+1 is
Δ𝜃= 2𝜋fIFTsamp.
(11.23)
The objective of the frequency estimator is to estimate the phase shift Δ𝜃between two consecutive samples.
Fig. 11.4 shows a block diagram of the phase increment frequency estimator and compensator. First, the
current sample is multiplied by the complex conjugate of the previous sample. Using Eq. (11.9), we find
yly∗
l−1 = xlx∗
l−1 exp [−i(2𝜋fIFTsamp + Δ𝜙l −Δ𝜙l−1)] + n′
l,
(11.24)
where n′
l = xln∗
l−1 + x∗
l−1nl + nln∗
l−1 is the effective noise. First consider the case nl = 0 and Δ𝜙l = 0.
Eq. (11.24) may be rewritten as
yly∗
l−1 = |xl||xl−1| exp [−i(2𝜋fIFTsamp + 𝜃x,l)],
(11.25)
where 𝜃x,l = Arg(xlx∗
l−1). For M-PSK systems, 𝜃x,l takes values 2𝜋(m −n)∕M, m, n = 0, 1, … , M −1. The IF
estimation is complicated by the presence of phase modulation and laser phase noise. For an M-PSK system,
if we take the Mth power of yly∗
l−1, 𝜃x,l is multiplied by M, resulting in a phase that is an integral multiple of
2𝜋and hence it can be ignored. From Eq. (11.25), we have
Arg{(yly∗
l−1)M} = −(2𝜋fIFTsamp)M
(11.26)
Delay 
Σn(.)
yl*1
(.)M
yl
x
Arg(.)
M
exp(*i.)
exp(*i∆θ)
∆θ
x
(.)*
~yl
y*l*1  
Figure 11.4
Block diagram of IF estimation and compensation.

502
Fiber Optic Communications
0
500
1000
1500
2000
2500
*4
*2
0
2
4
Sample # 
Phase (rad)
w/o eq
w eq
Figure 11.5
Phase vs. sample number for the back-to-back case with no phase modulation. Parameters: Tx laser
linewidth = LO linewidth = 50 kHz, fIF = 200 MHz.
or
̂fIF =
−1
2𝜋TsampM Arg[(yly∗
l−1)M].
(11.27)
However, in the presence of nl and Δ𝜙l, the estimated frequency offset ̂fIF fluctuates from symbol to symbol.
Since nl and Δ𝜙l −Δ𝜙l−1 are zero-mean random variables, the fluctuations can be minimized if we average
over N samples,
̂fIF =
−1
2𝜋TsampM Arg
[ N
∑
l=1
(yly∗
l−1)M
]
.
(11.28)
The frequency estimate ̂fIF gets better as the block size N increases, as long as ̂fIF remains constant over
the block size. The IF is removed by multiplying yl by exp (−iΔ𝜃), where Δ𝜃= −2𝜋̂fIFTsamp. The solid and
broken lines in Fig. 11.5 show the phases with and without IF equalization, respectively, when the phase
modulation is turned off. In this example, we consider the back-to-back case with no fiber-optic channel
between transmitter and receiver. When IF equalization is not used, the phase increases constantly because
of the term 2𝜋fIFtl in Eq. (11.9). However, the Arg(⋅) function can not distinguish phases that differ by 2𝜋
and produces results in the [−𝜋, 𝜋] interval. When the IF equalization is used, from Fig. 11.5, we see that
the phase fluctuations are quite small, indicating that the equalizer is effective in removing IF. These phase
fluctuations after the IF removal are due to laser phase noise. Equalization of the phase noise is discussed in
the next section.
Fig. 11.6(a) and (b) shows the constellation diagrams before and after the IF removal, respectively, for the
QPSK signal. Before the IF removal, the phase varies almost uniformly over the range of 0 to 2𝜋. After the
IF removal, the phase is close to one of the transmitted phases 0, 𝜋∕2, 𝜋, 3𝜋∕2.

Digital Signal Processing
503
*0.1
*0.05
0
0.05
0.1
*0.06
*0.04
*0.02
0
0.02
0.04
0.06
In-phase (a.u.)
Quad. comp. (a.u.)
*0.06
*0.04
*0.02
0.02
0
0.04
0.06
Quad. comp. (a.u.)
*0.1
*0.05
0
0.05
0.1
In-phase (a.u.)
Figure 11.6
Constellation diagrams: (a) before IF removal, (b) after IF removal. Parameters: symbol rate = 10 GSym/s,
NRZ-QPSK, other parameters the same as in Fig. 11.5.
11.5
Phase Estimation and Compensation
The linewidth of ECL/DFB lasers used at the transmitter and receiver (as LO) ranges from 10 kHz to 10 MHz,
and the symbol rates are usually ≥10 GSym/s. Therefore, the phase Δ𝜙k of Eq. (11.9) varies much more
slowly than the rate of phase modulation. By averaging the phase Δ𝜙k over many symbol intervals, it is
possible to obtain an accurate phase estimate [9].
There exist a number of techniques for phase estimation and compensating [9–13]. Here, we describe the
commonly used technique known as the block phase noise estimation or Viterbi–Viterbi algorithm [9, 10].
The block diagrams of the phase estimation technique are shown in Figs. 11.7 to 11.9. After removal of the
IF, the signal input to the phase estimator is
̃yl = xl exp (−iΔ𝜙l) + nl.
(11.29)
For M-PSK systems, the phase modulation effect is removed by taking the Mth power of the signal as before,
( ̃yl)M = [xl exp (−iΔ𝜙l) + nl
]M.
(11.30)
Using the binomial theorem,
(A + B)M = AM +
(
M
1
)
AM−1B +
(
M
2
)
AM−2B2 + · · · + BM,
(11.31)
Eq. (11.30) may be written as
( ̃yl)M = xM
l exp (−iMΔ𝜙l) + n′
l,
(11.32)
where
n′
l =
(
M
1
)
xM−1
l
exp [−i(M −1)Δ𝜙l]nl +
(
M
2
)
xM−2
l
exp [−i(M −2)Δ𝜙l]n2
l + · · · nM
l .
(11.33)
In Eq. (11.32), the first term is the desired term and n′
l is the sum of unwanted cross-terms due to signal–noise
and noise–noise beating. It can be shown that n′
l is a zero-mean complex random variable (see Example 11.2)

504
Fiber Optic Communications
IF 
Removal 
1 to K
DEMUX
K to 1
MUX
 
yl
˜yl
...
1
2
K
Phase Comp
Phase Comp
Phase Comp
...
...
Figure 11.7
Block diagram of an IF and phase compensator. Demux = demultiplexer, Phase Comp = block phase esti-
mator and compensator, Mux = multiplexer.
1 to K
DEMUX 
 
...
1
2
K
...
...
...
˜yKN
y(K*1)N+1 y(K*1)N+2
˜
˜
˜y2N
˜yN
y1˜
˜ y2
yN+1
˜
˜ yN+2
yNK
˜
y2˜
y1˜
Figure 11.8
Demultiplexing of the data into K blocks with each block consisting of N samples.
(.)M
*Arg(.)
M
ˆ
Δϕk
X
xlˆ
yl~
∑n(.)
exp(i)
ˆ
exp(iΔϕk)
Figure 11.9
Block diagram of a block phase estimator and compensator for the kth block.
and, therefore, if we average (̃yl)M over N samples, the impact of n′
l can be minimized. First, the signal
is divided into K blocks with each block consisting of N samples, as shown in Fig. 11.7. In block k, k =
1, 2, … , K, the signal is raised to the Mth power and summed over N samples to obtain
kN
∑
l=(k−1)N+1
(̃yl)M =
kN
∑
l=(k−1)N+1
|xl|M exp [−iM(𝜃l + Δ𝜙l)] +
kN
∑
l=(k−1)N+1
n′
l,
(11.34)
where 𝜃l = Arg(xl). For M-PSK systems, |xl|M = A0 is a constant independent of modulation. In Eq. (11.34),
we assumed that the Δ𝜙l is approximately constant within the block. M𝜃l is an integral multiple of 2𝜋and,
hence, it can be ignored. If N is sufficiently large, the last term in Eq. (11.34) is close to zero. So, we have
kN
∑
l=(k−1)N+1
(̃yl)M ≅A0N exp (−iMΔ𝜙l).
(11.35)

Digital Signal Processing
505
From Eq. (11.35), we find
−1
M Arg
{
kN
∑
l=(k−1)N+1
(̃yl)M
}
≡Δ ̂𝜙k ≅Δ𝜙l.
(11.36)
Here, Δ ̂𝜙k is the phase estimate of the kth block. The signal sample ̃yl is multiplied by exp (iΔ ̂𝜙k) to obtain
the estimate of the transmitted signal,
̂xl = ̃yl exp (iΔ ̂𝜙k).
(11.37)
The computation in each block can be carried out using separate signal processors. Finally, the signal samples
in each block are combined using a multiplexer to obtain the serial data. The block size should be chosen
carefully. If N is too small, the impact of the noise term n′
l in Eq. (11.32) can not be ignored. If N is too
large, the laser phase may drift and Δ𝜙l may not remain constant within each block. The block size should
be optimized based on the laser linewidth.
11.5.1
Phase Unwrapping
The function Arg() in Eq. (11.36) can not distinguish between phases that differ by 2𝜋and it returns the results
in the interval [−𝜋, 𝜋]. If the phase is 𝜋+ 𝜖, 𝜖> 0, the function Arg() returns a phase of −𝜋+ 𝜖. This is known
as phase wrapping and it could lead to symbol errors. Special techniques have to be used to unwrap phases.
Consider the following example: suppose Δ𝜙l in the current block k is 𝜖≪𝜋, 𝜖> 0, and let Δ𝜙l be roughly
constant over the block. From Eq. (11.36), it follows that Δ ̂𝜙k = 𝜖. Now, let Δ𝜙l of the next block, k + 1 jump
by 𝜋∕M, i.e., Δ𝜙l of the (k + 1)th block is 𝜖+ 𝜋∕M. From Eq. (11.36) for the (k + 1)th block, we find
−1
M Arg
{(k+1)N
∑
l=kN+1
Al exp [−i (M𝜃l + M𝜖+ 𝜋)]
}
= −1
M Arg{exp [−i(M𝜖+ 𝜋)]}
= M𝜖−𝜋
M
= Δ ̂𝜙k+1.
(11.38)
Clearly, the estimated phase 𝜖−𝜋∕M is different from the actual phase, 𝜖+ 𝜋∕M. This is because of
the phase wrapping done by the function of Arg(). Phase wrapping in the context of coherent optical
communication has been studied in Refs. [14, 15]. Let the carrier phase prior to the unwrapping be Δ ̂𝜙k. If
we add 2𝜋∕M to Δ ̂𝜙k+1, the phase for the (k + 1)th block after the phase unwrapping is
Δ𝜙k+1 = Δ ̂𝜙k+1 + 2𝜋
M = 𝜖+ 𝜋∕M,
(11.39)
which is actually the phase of the (k + 1)th block. In general, an integral multiple of 2𝜋∕M is added to the
carrier phase. The carrier phase after the phase unwrapping can be written as
Δ𝜙k = Δ ̂𝜙k + m2𝜋∕M,
k = 1, 2,...,K,
(11.40)
where
m = Floor
(
0.5 + Δ𝜙k−1 −Δ ̂𝜙k
2𝜋∕M
)
.
(11.41)
Here, Floor() returns the nearest integer toward −∞. Suppose the phases of the kth and (k −1)th block are both
𝜖. In this case, m = 0 and the phase unwrapping block of the phase estimator Eq. (11.40) does not add 2𝜋∕M.

506
Fiber Optic Communications
0
2000
4000
6000
8000
10000
*1.2
*1
*0.8
*0.6
*0.4
*0.2
0
0.2
Sample # 
Phase (rad)
w/o eq
w eq
Figure 11.10
Plot of phase vs. sample number with and without phase equalizer. Parameters: no phase modulation, TX
laser linewidth = LO linewidth = 125 kHz, fIF = 200 MHz, block size N = 10. The signal passes through an IF equalizer
prior to the phase equalizer.
*0.06
*0.1
*0.05
0
0.05
0.1
*0.04
*0.02
0
0.02
0.04
0.06
In−phase (a.u.)
Quad. comp. (a.u.)
*0.06
*0.04
*0.02
0.02
0
0.04
0.06
Quad. comp. (a.u.)
*0.1
*0.05
0
0.05
0.1
In−phase (a.u.)
Figure 11.11
Constellation diagrams (a) before phase equalization, (b) after phase equalization. Parameters: symbol
rate = 10 GSym/s, NRZ-QPSK, and other parameters the same as in Fig. 11.10.
A back-to-back case (no fiber-optic channel between transmitter and receiver) is simulated. Fig. 11.10 shows
the phases of the signals after IF equalization when the phase modulation is turned off. In the absence of the
phase equalizer, the phase varies randomly in the interval [−𝜋, 𝜋]. After using the phase equalizer, the phase
fluctuations are significantly reduced. Fig. 11.11(a) and (b) shows the constellation diagrams before and after
phase noise removal for the QPSK signal, respectively. As can be seen, the phase equalizer is quite effective
in removing the phase fluctuations introduced by the transmitter and LO.
11.6
CD Equalization
In this section, we ignore laser phase noise, fiber nonlinear effects, ASE, and other noise sources, and consider
only the impact of fiber dispersion. The output field envelope of the fiber can be written as
y(t) = −1[̃y(f)],
(11.42)
̃y(f) = ̃H(f)̃x(f),
(11.43)
̃x(f) = [x(t)],
(11.44)

Digital Signal Processing
507
where x(t) is the input field envelope of the fiber and ̃H(f) is the fiber transfer function. The dispersion-
compensating filter (DCF) should have the transfer function
̃W(f) =
1
̃H(f)
,
(11.45)
so that the output of the DCF is the same as the fiber input, as shown in Fig. 11.12:
̂x(f) = ̃W(f)̃y(f)
(11.46)
= ̃W(f) ̃H(f)̃x(f) = ̃x(f).
(11.47)
Inverse Fourier transforming Eq. (11.46) and noting that a product in the frequency domain becomes a con-
volution in the time domain, we obtain
x(t) = ∫
∞
−∞
y(t −t′)W(t′) dt,
(11.48)
where
W(t) = −1[ ̃W(f)]
(11.49)
is the impulse response of the dispersion-compensating filter. The DCF discussed in Chapter 2 is a
dispersion-compensating filter in the optical domain. Owing to the linearity of coherent detection, a
dispersion-compensating filter can be realized in the electrical domain as well. For digital implementation,
Eq. (11.48) is discretized to obtain
x[n] =
∞
∑
k=−∞
W[k]y[n −k].
(11.50)
Here, the time t is discretized as t = kTsamp, where 1∕Tsamp is the sampling rate, k is an integer,
x[n] = x(nTsamp),
(11.51)
W[n] = TsampW(nTsamp),
(11.52)
y[n] = y(nTsamp).
(11.53)
Thus, if we know the impulse response of the dispersion-compensating filter, convolving it with the fiber
output field envelope could undo the distortions caused by fiber dispersion. As an example, consider the fiber
transfer function given by Eq. (2.107) (with no loss and no delay),
H(f) = exp (i2𝜋2f 2𝛽2L).
(11.54)
Using Eq. (11.45), the transfer function of the dispersion-compensating filter is
̃W(f) = exp (−i2𝜋2f 2𝛽2L).
(11.55)
Fiber
H( f )
˜
y( f )
˜
x( f )
˜
x( f ) = x ( f )
˜
ˆ
Disp.
compensation
   filter W( f )      
˜
Figure 11.12
CD equalizer using a digital DCF.

508
Fiber Optic Communications
The impulse response function of the dispersion-compensating filter is given by [16] (see Example 11.3)
W(t) =
√
1
2𝜋i𝛽2L exp [i𝜙(t)],
(11.56)
𝜙(t) = t2∕2𝛽2L.
(11.57)
A dispersion-compensating filter is an all-pass filter and its impulse response W(t) is infinite in duration. The
summation in Eq. (11.50) may be truncated to a finite number of terms, known as a finite impulse response
(FIR) filter. Now, Eq. (11.50) becomes
x[n] =
K
∑
k=−K
W[k]y[n −k],
(11.58)
W[k] = Tsamp
√
1
2𝜋i𝛽2L exp
[
ik2T2
samp
2𝛽2L
]
.
(11.59)
Fig. 11.13 shows a schematic of the FIR filter. The number of taps, 2K + 1, has to be decided based on the
Nyquist sampling theorem, which states that if the signal is band-limited to B, the sampling rate, Rsamp, has to
be greater than or equal to 2B. Otherwise, aliasing could occur. From Eq. (11.57), the instantaneous frequency
of W(t) is
fi = −1
2𝜋
d𝜙
dt =
−t
2𝜋𝛽2L.
(11.60)
From Eq. (11.60), we see that the magnitude of instantaneous frequency increases with t. When the summation
in Eq. (11.50) is truncated to 2K + 1 terms (see Eq. (11.58)), the highest-frequency component occurs at
t = KTsamp:
B = |fi,max| =
KTsamp
2𝜋|𝛽2|L.
(11.61)
Delay
T samp 
×
X
×
Delay
T samp 
y[n + K ]
y[n + K * 1]
y[n * K ]
W [*K ]
W [*K + 1]
W [K ]
xˆ(n)
∑
Figure 11.13
Schematic of the FIR dispersion-compensating filter.

Digital Signal Processing
509
*0.2
*0.1
0
0.1
0.2
*0.2
*0.15
*0.1
*0.05
0
0.05
0.1
0.15
In−phase (a.u.)
(a)
(b)
Quad. comp. (a.u.)
*0.1
*0.05
0
0.05
0.1
*0.1
*0.05
0
0.05
0.1
In−phase (a.u.)
Quad. comp. (a.u.)
Figure 11.14
Constellation diagrams for NRZ-QPSK system: (a) before dispersion equalizer, (b) after dispersion equal-
izer. Parameters: accumulated dispersion = 13, 600 ps/nm, number of samples/symbol = 2, number of taps = 47.
Using the Nyquist theorem, the sampling rate, Rsamp, should be at least equal to 2B,
Rsamp =
1
Tsamp
≥
KTsamp
𝜋|𝛽2|L
(11.62)
or
K ≥𝜋|𝛽2|L
T2
samp
.
(11.63)
Since K has to be an integer, we choose
K = ceil(𝜋|𝛽2|L∕T2
samp),
(11.64)
where ceil() gives the nearest integer toward ∞. From Eq. (11.64), we see that the number of taps increases
as |𝛽2|L. This can be understood from the fact that the pulse broadening increases with |𝛽2|L. To undo the
distortion due to dispersion at t = kTsamp, samples of y(t) extending from (k −K)Tsamp to (k + K)Tsamp are
required.
Fig. 11.14(a) and (b) shows the constellation diagrams of a system based on QPSK before and after the
dispersion-compensating filter, respectively. As can be seen, the distortions caused by fiber dispersion can
be mitigated using the dispersion-compensating filter. Alternatively, the dispersion-compensating filter can
be realized by using an IIR filter, which is computationally efficient but requires buffering [17]. When the
accumulated dispersion is large, it would be more efficient to compensate dispersion in the frequency domain
using FFTs, as discussed in Section 11.8.
Example 11.1
A 10-GSym/s fiber-optic system has the following parameters: 𝛽2 = −22 ps2∕km and transmission distance =
800 km. Assuming two samples per symbol, calculate the minimum number of taps needed to compensate
for the fiber dispersion.

510
Fiber Optic Communications
Solution:
For a 10-GSym/s system, the symbol period is 100 ps. Since there are two samples per symbol, Tsamp = 50 ps.
Using Eq. (11.64), we find
K = ceil
(
𝜋× 22 × 10−27 × 800 × 103
(50 × 10−12)2
)
= 23.
(11.65)
Therefore, the number of taps 2K + 1 = 47.
11.6.1
Adaptive Equalizers
The fiber dispersion could fluctuate due to environmental conditions. However, these fluctuations occur at
a rate that is much slower than the transmission data rate and, therefore, the tap weights of the FIR filter
shown in Fig. 11.13 can be adjusted adaptively. There exist a number of techniques to realize the tunable
dispersion-compensating filters [18–20]. In this section, we focus on two types of adaptive equalizer: least
mean squares (LMS) and constant modulus algorithm (CMA) equalizers.
Fig. 11.15 shows a schematic of a fiber-optic system with adaptive equalizer in the digital domain. Let the
input to the fiber-optic channel be x[k]. The channel output is
y[m] =
N
∑
k=−N
H[k]x[m −k] + n[m],
(11.66)
where H[k] is the channel impulse response and n[m] is the noise added by the channel. In Eq. (11.66), we
have assumed that the ISI at t = mTsamp could occur due to the samples of the optical signal ranging from
m −N to m + N. In other words, H[k] is assumed to be zero for |k| > N. The adaptive equalizer is a transversal
filter with tap weights W[k] and the output of the equalizer is
̂x[n] =
K
∑
k=−K
W[k]y[n −k].
(11.67)
Here, 2K + 1 is the number of taps. If the equalizer compensates for the channel effects, ̂x[n] should be equal
to x[n] in the absence of noise. The error between the desired response x[n] and the output of the equalizer
̂x[n] is
e[n] = x[n] −̂x[n].
(11.68)
The mean square error is
J(W[−K], W[−K + 1],...,W[K], W∗[−K],...,W∗[K]) = < |e[n]2| >
= < |x[n]|2 −x[n]̂x∗[n]
−̂x[n]x∗[n] + ̂x[n]̂x∗[n] > .
(11.69)
Fiber-optic 
channel
H
Adaptive 
equalizer
W
ˆx[k]
y[k]
x[k]
Figure 11.15
Adaptive equalization of the fiber-optic channel.

Digital Signal Processing
511
The adaptive equalizer has 2K + 1 adjustable complex coefficients. The coefficients W[k] can be adjusted so
that the mean square error is minimum,
𝜕J
𝜕W[k] = 0
(11.70)
and
𝜕J
𝜕W∗[k] = 0.
(11.71)
Using Eqs. (11.67) and (11.69) in Eq. (11.70), we find
𝜕J
𝜕W[k] = < −x∗[n]y[n −k] + y[n −k]̂x∗[n] >
= −< y[n −k]e∗[n] >= 0.
(11.72)
Note that W[k] and W∗[k] are independent variables and, therefore, 𝜕̂x∗[n]∕𝜕W[k] = 0. From Eq. (11.71), we
obtain
𝜕J
𝜕W∗[k] = −< y∗[n −k]e[n] >= 0,
(11.73)
which is nothing but the complex conjugate of Eq. (11.72).
The tap weights W[−K], W[−K + 1], … , W[K] are optimum when the cost function J is minimum. To find
the optimum tap weights, we follow an iterative procedure. Initially, tap weights are chosen arbitrarily as
W(0) = [W(0)[−K], W(0)[−K + 1], … , W(0)[K]],
(11.74)
where ‘(0)’ stands for the zeroth iteration. To update the tap weights for the next iteration, we need to move
in a vector space of 2K + 1 dimensions such that we are closer to a minimum of the cost function J. The
gradient vector is defined as
G = [g[−K], g[−K + 1], … , g[K]],
(11.75)
g[k] = 2
𝜕J
𝜕W∗[k] = −2 < y∗[n −k]e[n] > .
(11.76)
At the starting point, we have the tap weight vector W(0) and the gradient vector G(0). From Eq. (11.71), we
see that J is minimum when g[k] is zero. But at the starting point, g[k] may not be zero. Iteratively, we need
to find W[k] such that g[k] is close to zero. The tap weight vector for the next iteration should be chosen in
a direction opposite to G(0). This is because, if we move in the direction of G(0), J would be maximized. So,
the tap weights for the next iteration are chosen as
W(1) = W(0) −Δ
2 G(0)
(11.77)
or
W[k](1) = W[k](0) −Δ
2 g[k](0)
= W[k](0) + Δ < y∗[n −k]e[n] >,
(11.78)
where Δ is a step-size parameter and the factor 1∕2 in Eq. (11.77) is introduced for convenience. The con-
vergence of the iterative procedure depends on the value of Δ chosen. In practice, it is difficult to evaluate
the expectation operator of Eq. (11.78), which requires knowledge of the channel response H[n]. Instead, the

512
Fiber Optic Communications
gradient vector is approximated by the instantaneous value or an estimate of the gradient vector. Ignoring the
expectation operator in Eq. (11.78), the tap weights are altered at the (n + 1)th iteration as [18–20]
W[k](n+1) = W[k](n) + y∗[n −k]e[n]Δ,
k = −K, … , 0, … , K
(11.79)
e[n] = x[n] −̂x[n].
(11.80)
Eqs. (11.79) and (11.80) constitute the LMS algorithm for adaptive equalization. After a few iterations,
e[n] ≅0 and, thereafter, the tap weights remain roughly the same. Fig. 11.16 shows a schematic of the adap-
tive equalizer. Initially, the transmitter sends a training sequence x[n], n = 1, 2, 3, … which is known to the
receiver. This is received as y[n]. The purpose of sending a training sequence is to let the receiver find the tap
weights adaptively. The equalizer is switched to training mode, initially in Fig. 11.16. The period of training
is pre-decided between the transmitter and receiver, and the receiver has full information on the information
sequence x[n]. After the tap weights W[k] have reached their optimum values, it may be assumed that the
output of the decision device ̂x[n] is a reliable estimate of the information sequence x[n]. At the end of the
training period, actual data is transmitted. Since the receiver has no information on the transmitted data, the
output of the decision device ̃x[n] is used to calculate the error signal e[n] instead of the actual information
sequence x[n], as shown in Fig. 11.16. This is known as a decision-directed mode of adaption. In this mode,
an error signal is obtained as
e[n] = ̃x[n] −̂x[n].
(11.81)
The fiber dispersion varies slowly due to environmental fluctuations and the tap weights are adjusted adap-
tively to compensate for the slow variations in dispersion.
Delay 
Tsamp
Delay 
Tsamp
×
×
×
y[n + K]
y[n + K * 1]
y[n * K]
W[* K]
W[*K + 1]
W[K]
ˆx[n]
Adaptive tap 
weight
controller
Decision 
device
Training 
sequence
e[n]
x[n]
[ ]
x n
Received 
signal
Decision-directed mode
˜
Training mode
*
+


Figure 11.16
Block diagram of an adaptive equalizer.

Digital Signal Processing
513
Transversal 
filter W
Zero-memory
nonlinear
estimator
Tap weight 
control
e[k]
˜x[k]
ˆx[k]
y[k]
Received 
signal
*
+

Figure 11.17
Block diagram of a blind equalizer.
11.6.1.1
Blind Equalizers
In some applications, it is desirable for receivers to undo the distortions without using the training sequences.
Such equalizers are known as blind equalizers. Fig. 11.17 shows a schematic of a blind equalizer. The
blind equalizer is similar to the decision-directed equalizer except that the error signal is obtained using the
zero-memory nonlinear estimator instead of the decision device. Once the blind equalizer converges, it will be
switched to a decision-directed mode of operation. Godard proposed a family of blind equalization algorithms
[21]. In this section, we consider a special case of Godard’s algorithms, known as the constant-modulus
algorithm (CMA). In this case, the output of the zero-memory nonlinear estimator is [20, 21]
̃x[k] = ̂x[k](1 + R2 −|̂x[k]|2),
(11.82)
where
R2 = < |x[k]|4 >
< |x[k]|2 >.
(11.83)
The error signal is
e[k] = ̃x[k] −̂x[k]
= ̂x[k](R2 −|̂x[k]|2).
(11.84)
For constant-intensity modulation formats such as QPSK-NRZ, ⟨|x[n]|4⟩= ⟨|x[n]|2⟩= 1 assuming that the
transmitter power is normalized to unity. For these formats, Eq. (11.84) reduces to
e[k] = ̂x[k](1 −|̂x[k]|2).
(11.85)
If the tap weights are optimum, |̂x[k]|2 should be unity for constant-intensity formats and, therefore, the error
signal e[k] that is proportional to the deviation of |̂x[k]|2 from unity is used to adjust the tap weights. The tap
weights are adjusted in accordance with the stochastic gradient algorithm as discussed previously,
𝑤[k](n+1) = 𝑤[k](n) + y∗[n −k]e[n]Δ.
(11.86)
11.7
Polarization Mode Dispersion Equalization
Consider a polarization-multiplexed fiber-optic system as shown in Fig. 11.18. Let 𝜓x,in and 𝜓y,in be the field
envelopes of the x- and y- polarization components at the input of the fiber-optic channel. Ignoring the noise

514
Fiber Optic Communications
Laser
MZM
MZM
Coherent 
Rx. front
end
Data, x
Data, y
PBS
PBS
Fiber-optic channel
ψx,in
ψy,out
ψx,out
ψy,in
Figure 11.18
Polarization-multiplexed fiber-optic system. PBS = polarization beam splitter, MZM = Mach–Zehnder
modulator.
effects, the output of the coherent receiver front end can be written as (see Section 5.6.5)
[ ̃𝜓x,out(𝜔)
̃𝜓y,out(𝜔)
]
= F
[ ̃Hxx(𝜔) ̃Hxy(𝜔)
̃Hyx(𝜔) ̃Hyy(𝜔)
] [ ̃𝜓x,in(𝜔)
̃𝜓y,in(𝜔)
]
,
(11.87)
where F is a scalar that represents the loss in the fiber-optic channel. In the absence of the polarization-
dependent loss (PDL) or polarization-dependent gain (PDG), total power should be conserved, which implies
that the determinant of the matrix in Eq. (11.87) should be unity. Eq. (11.87) may be written as
̃𝜓x,out(𝜔) = F[ ̃Hxx(𝜔) ̃𝜓x,in(𝜔) + ̃Hxy(𝜔) ̃𝜓y,in(𝜔)],
(11.88)
̃𝜓y,out(𝜔) = F[ ̃Hyx(𝜔) ̃𝜓x,in(𝜔) + ̃Hyy(𝜔) ̃𝜓y,in(𝜔)].
(11.89)
After taking the inverse Fourier transform and discretizing, Eqs. (11.88) and (11.89) become
𝜓x,out[m] = F
N
∑
k=−N
{Hxx[k]𝜓x,in[m −k] + Hxy[k]𝜓y,in[m −k]},
(11.90)
𝜓y,out[m] = F
N
∑
k=−N
{Hyx[k]𝜓x,in[m −k] + Hyy[k]𝜓y,in[m −k]}.
(11.91)
Let
𝚿in[k] =
[𝜓x,in[k]
𝜓y,in[k]
]
,
(11.92)
𝚿out[k] =
[𝜓x,out[k]
𝜓y,out[k]
]
.
(11.93)
H[k] = F
[Hxx[k] Hxy[k]
Hyx[k] Hyy[k]
]
.
(11.94)
Now, Eqs. (11.90) and (11.91) may be rewritten as
𝚿out[m] =
N
∑
k=−N
H[k]𝚿in[m −k].
(11.95)

Digital Signal Processing
515
Fiber-optic 
Channel
H
Adaptive 
equalizer
W
Ψin[k]
Ψout[k]
Ψin[k]
ˆ
Figure 11.19
Adaptive equalization of the polarization-multiplexed fiber-optic channel.
Fig. 11.19 shows a schematic of the fiber-optic channel with adaptive equalizer in the digital domain. The
output of the equalizer is
̂𝜓x,in[n] = F
K
∑
k=−K
{Wxx[k]𝜓x,out[n −k] + Wxy[k]𝜓y,out[n −k]},
(11.96)
̂𝜓y,in[n] = F
K
∑
k=−K
{Wyx[k]𝜓x,out[n −k] + Wyy[k]𝜓y,out[n −k]}.
(11.97)
Let
̂Ψin[k] =
[ ̂𝜓x,in[k]
̂𝜓y,in[k]
]
,
(11.98)
W[k] =
[Wxx[k] Wxy[k]
Wyx[k] Wyy[k].
]
(11.99)
Eqs. (11.96) and (11.97) may be written as
̂Ψin[n] =
K
∑
k=−K
W[k]Ψout[x −k].
(11.100)
The adaptive equalizer for polarization mode dispersion consists of four transversal filters, Wxx, Wxy, Wyx, and
Wyy, as shown in Fig. 11.20. The tap weights of the equalizer can be updated using the training sequence or
blind equalization techniques, as described previously. Let us first consider an adaptive equalizer that uses a
LMS algorithm and training sequences. The weights are updated as (see Example 11.4)
Wxx[k](n+1) = Wxx[k](n) + 𝜓∗
x,out[n −k]ex[n]Δ,
(11.101)
Wxy[k](n+1) = Wxy[k](n) + 𝜓∗
y,out[n −k]ex[n]Δ,
(11.102)
Wyy[k](n+1) = Wyy[k](n) + 𝜓∗
y,out[n −k]ey[n]Δ,
(11.103)
Wyx[k](n+1) = Wyx[k](n) + 𝜓∗
x,out[n −k]ey[n]Δ,
(11.104)
where
er[n] = 𝜓r,in[n] −̂𝜓r,in[n],
r = x, y.
(11.105)
For a blind equalizer that uses CMA, the error signals are given by Eq. (11.84),
e′
r[k] = ̂𝜓r,in[k](1 −| ̂𝜓r,in[n]|2),
r = x, y.
(11.106)
The tap weights are adjusted in accordance with the stochastic gradient algorithm,
Wxx[k](n+1) = Wxx[k](n) + 𝜓∗
x,out[n −k]e′
x[n]Δ,
(11.107)

516
Fiber Optic Communications
Wxx
ψx,in
ˆ
ψx,in
ˆ
ψy,out
ψx,out


Wxy
Wyx
Wyy
Figure 11.20
Polarization mode dispersion compensation using four transversal filters.
Fixed DCF
Adaptive 
equalizer,
W, for PMD
Received signal 
after IF and phase
 noise removal
ψin[k]
ˆ
Figure 11.21
Block diagram of the digital equalizer for a polarization-multiplexed fiber-optic system.
Wxy[k](n+1) = Wxy[k](n) + 𝜓∗
y,out[n −k]e′
x[n]Δ,
(11.108)
Wyy[k](n+1) = Wyy[k](n) + 𝜓∗
y,out[n −k]e′
y[n]Δ,
(11.109)
Wyx[k](n+1) = Wyx[k](n) + 𝜓∗
x,out[n −k]e′
y[n]Δ
(11.110)
When a PMD equalizer is used, it is not necessary to have a separate adaptive equalizer for CD, as the diagonal
elements of the matrix H have contributions from CD. Typically, the fixed dispersion-compensating filter
compensates for the mean (non-time-varying) CD and the residual CD is compensated by the transversal
filters Wxx and Wyy. Wrr compensates for the residual CD of the r-polarization component, r = x, y. Fig. 11.21
shows block diagram of the digital equalizer that compensates for CD and PMD.
11.8
Digital Back Propagation
So far in this chapter, we have assumed that the fiber-optic system is a linear system and focused on the
mitigation of the linear impairments such as chromatic dispersion and polarization mode dispersion. In this
section, we consider the mitigation of fiber nonlinear effects. Fiber dispersion and nonlinear effects can be
compensated using the digital back-propagation techniques [22, 23]. Let us first consider a single-span system

Digital Signal Processing
517
with constant fiber dispersion, nonlinear, and loss coefficients. The evolution of the field envelope in a fiber
is described by the NLSE (see Chapter 10),
𝜕q
𝜕z = (N + D)q,
(11.111)
where D denotes the fiber dispersion effect,
D = −i𝛽2
2
𝜕2
𝜕t2
(11.112)
and N denotes the nonlinear and loss effects,
N(t, z) = i𝛾|q(t, z)|2 −𝛼
2 .
(11.113)
The formal solution of Eq. (11.111) can be obtained as follows:
dq
q = (N + D),
(11.114)
ln[q(t, z)]|L
0 = ∫
L
0
(N + D)dz,
(11.115)
q(t, L) = Mq(t, 0),
(11.116)
where
M = exp
{
∫
L
0
[N(t, z) + D(t)]dz
}
(11.117)
and L is the fiber length. In general, q(t, L) can not be obtained in a closed form since N(t, z) has a term
proportional to |q(t, z)|2 which is unknown for z > 0. Eq. (11.116) is just another way of writing Eq. (11.111),
and numerical techniques have to be used to find q(t, L) [24]. Multiplying Eq. (11.116) by M−1 on both sides,
we find
q(t, 0) = M−1q(t, L).
(11.118)
In Eq. (11.118), q(t, L) represents the received field envelope which is distorted due to fiber dispersion and
nonlinear effects. If we multiply the received field by the inverse fiber operator, M−1, distortions due to fiber
dispersion and nonlinear effects can be completely undone. Since
exp (̂x) exp (−̂x) = I,
(11.119)
where I is an identity operator (Example 11.4), taking
̂x = ∫
L
0
[N(t, z) + D(t)]dz,
(11.120)
we find
M−1 = exp
[
−∫
L
0
[N(t, z) + D(t)]dz
]
.
(11.121)
Eq. (11.118) with M−1 given by Eq. (11.121) is equivalent to solving the following partial differential
equation:
𝜕qb
𝜕z = −[N + D]qb,
(11.122)

518
Fiber Optic Communications
or
𝜕qb
𝜕(−z) = [N + D]qb,
(11.123)
with the initial condition qb(t, 0) = q(t, L). From Eq. (11.118), it follows that
M−1qb(t, 0) ≡qb(t, L) = q(t, 0).
(11.124)
Thus, by solving Eq. (11.123), qb(t, L) can be found, which should be equal to the fiber input q(t, 0). In other
words, if the fiber link inverse operator M−1 can be realized in the digital domain, by operating it on the fiber
link output, we can retrieve the fiber input q(t, 0). Since Eq. (11.123) is nothing but Eq. (11.111) with z →−z,
this technique is referred to as back propagation. Eq. (11.122) may be rewritten as
𝜕qb
𝜕z = [Nb + Db]qb,
(11.125)
with qb(t, 0) ≡q(t, L)
Db = −D = i𝛽2
𝜕2
𝜕t2 ,
(11.126)
Nb = −N = −i𝛾|qb|2 + 𝛼
2 .
(11.127)
The NLSE with reversed signs of dispersion, loss, and nonlinear coefficients is solved in the digital domain
to undo the distortion caused by the transmission fiber. Figs. 11.22 and 11.23 illustrate the forward and
backward propagation. Eq. (11.125) can be solved numerically using the split-step Fourier scheme [24]. In
Eq. (11.125), the operators Nb and Db act simultaneously and Nb changes with z, which makes it harder to
realize the operator M−1 numerically. However, over a small propagation step, Δz, Db, and Nb may be approx-
imated to act one after the other. Hence, this technique is known as the split-step technique. This is an approxi-
mation, and this technique becomes more accurate as Δz →0. First let us consider the unsymmetric split-step
Tx.
Rx.
front end
DSP
fiber
β2,γ,α
q(t, L)
q(t, 0)
Figure 11.22
Propagation in a single-span fiber (forward propagation).
IF and
phase noise
removal
DBP
Virtual fiber
–β2, –γ, –α
qb(t, 0)
= q(t, L)
qb(t, L)
= q(t, 0)
Rx.
front end
DSP
Figure 11.23
Backward propagation in the virtual fiber.

Digital Signal Processing
519
scheme. The received field q(t, L) = qb(t, 0). We wish to find qb(t, Δz), which corresponds to q(t, L −Δz). The
operator M−1 in this propagation step can be approximated as
M−1 = exp
[
∫
Δz
0
[Nb(t, z) + Db(t)]dz
]
≅exp
[
∫
Δz
0
[Nb(t, z)]dz
]
exp [Db(t)Δz],
(11.128)
qb(t, Δz) = M−1qb(t, 0) = exp
[
∫
Δz
0
Nb(t, z)dz
]
ql
b(t, Δz),
(11.129)
where
ql
b(t, Δz) = exp [Db(t)Δz]qb(t, 0).
(11.130)
Eq. (11.130) is equivalent to solving the following equation:
𝜕ql
b
𝜕z = Dbql
b = i𝛽2
2
𝜕2ql
b
𝜕t2 ,
(11.131)
with ql
b(t, 0) = qb(t, 0). To solve Eq. (11.131), we take the Fourier transform on both sides:
d̃ql
b(𝜔, z)
dz
= −i𝛽2𝜔2
2
̃ql
b(𝜔, z),
(11.132)
̃ql
b(𝜔, Δz) = −i𝛽2𝜔2Δz
2
̃ql
b(𝜔, 0).
(11.133)
The signal ql
b(t, Δz) can be obtained by the inverse Fourier transformation
ql
b(t, Δz) = −1[̃ql
b(𝜔, Δz)].
(11.134)
In other words, the initial spectrum ̃qb(𝜔, 0) is multiplied by the inverse fiber linear transfer function to obtain
qb(t, Δz) and, therefore, it represents the inverse linear response of the fiber. Computation of the Fourier
transform/inverse Fourier transform takes N2 complex additions/multiplications, where N is the number of
samples. To facilitate fast computation of the Fourier transform, fast Fourier transform (FFT) is used which
takes ∼Nlog2N complex additions/multiplications. Eq. (11.131) may also be solved using the FIR filter
approach [22], as discussed in Section 11.6. Next, let us consider the nonlinear operator in Eq. (11.129).
Eq. (11.129) is formally equivalent to the following equation:
𝜕qb
𝜕z = Nbqb =
(
−i𝛾|qb|2 + 𝛼
2
)
qb,
(11.135)
with qb(t, 0) = ql
b(t, Δz). Let
qb = A exp (i𝜃).
(11.136)
Substituting Eq. (11.136) into Eq. (11.135) and separating the real and imaginary parts, we find
dA
dz = 𝛼
2 A,
(11.137)
d𝜃
dz = −𝛾|A|2.
(11.138)
Integrating Eq. (11.137), we obtain
A(t, z) = exp
(𝛼z
2
)
A(t, 0),
(11.139)

520
Fiber Optic Communications
and from Eq. (11.138), we have
𝜃(t, Δz) = 𝜃(t, 0) −𝛾∫
Δz
0
|A(t, z)|2dz = 𝜃(t, 0) −𝛾Δzeff|A(t, 0)|2,
(11.140)
where
Δzeff = exp (𝛼Δz) −1
𝛼
.
(11.141)
Substituting Eqs. (11.140) and (11.139) in Eq. (11.136), we find
qb(t, Δz) = qb(t, 0) exp (−i𝛾Δzeff|qb(t, 0)|2 + 𝛼Δz),
(11.142)
where
qb(t, 0) = A(t, 0) exp [i𝜃(t, 0)].
(11.143)
With qb(t, 0) = ql
b(t, Δz), Eq. (11.142) becomes
qb(t, Δz) = ql
b(t, Δz) exp (−i𝛾Δzeff|ql
b(t, Δz)|2 + 𝛼Δz).
(11.144)
Fig. 11.24 illustrates the unsymmetric SSFS. This technique can be summarized as follows:
(i) Initial field qb(t, 0) is known. First, the nonlinear and loss effects ( ̂N) are ignored and the output of a
lossless, linear fiber ql
b(t, Δz) is calculated using the Fourier transformation technique.
(ii) Next, fiber dispersion ( ̂D) is ignored. The NLSE is analytically solved with the initial condition qb(t, 0) =
ql
b(t, Δz) and the field envelope at Δz, qb(t, Δz) is calculated using Eq. (11.144).
(iii) qb(t, 2Δz) is calculated with qb(t, Δz) as the initial condition by repeating (i) and (ii). This process is
repeated until z = L. The step size Δz should be chosen sufficiently small that the absolute value of
the nonlinear phase shift Δ𝜃accumulated over a distance Δz should be much smaller than 𝜋. From
Eq. (11.140), it follows that
|Δ𝜃| = |𝜃(t, Δz) −𝜃(t, 0)| = 𝛾Δzeff|A(t, 0)|2 ≪𝜋.
(11.145)
A disadvantage of the unsymmetric SSFS is that the step size has to be really small since the error scales
since as Δz2 [24]. The step size can be made significantly larger using the symmetric SSFS, which is described
as follows. From Eq. (11.125), we have
qb(t, Δz) = exp
[
∫
Δz
0
[Nb(t, z) + Db(t)]dz
]
qb(t, 0).
(11.146)
Dispersion
only
exp(Db∆z)
Dispersion
only
exp(Db∆z)
Dispersion
only
exp(Db∆z)
qb(t, 0)
= ql
b(t, 0)
ql
b(t, ∆z)
ql
b(t, 2∆z)
ql
b(t, L)
qb(t, ∆z)
qb(t, 2∆z)
qb(t, L – ∆z)
Nonlinear
operation
exp(∫∆z
 Nb(t, z)dz)
0
Nonlinear operation
exp(∫∆z
 Nb(t, z)dz)
0
Nonlinear operation
exp(∫∆z
 Nb(t, z)dz)
0
qb(t, L)
Figure 11.24
Unsymmetric split-step Fourier scheme for backward propagation.

Digital Signal Processing
521
exp(Db∆z / 2)
exp(Db∆z / 2)
qb(t, 0)
ql
b(t, ∆z / 2)
exp(∫∆z
 Nb(t, z)dz)
0
qb(t, ∆z)
Figure 11.25
Symmetric split-step Fourier scheme for a single-step Δz.
qb(t, 0)
exp(Db∆z / 2)
exp(Db∆z / 2)
exp(Db∆z)
exp(∫∆z
 Nb(t, z)dz)
0
exp(∫2∆z
 Nb(t, z)dz)
∆z
qb(t, 2∆z)
Figure 11.26
Symmetric split-step Fourier scheme for the propagation from 0 to 2Δz.
qb(t, Δz) can be approximated as
qb(t, Δz) =
[
exp
{DbΔz
2
}
exp
{
∫
Δz
0
Nb(t, z)dz
}
exp
{DbΔz
2
}]
qb(t, 0).
(11.147)
The above scheme is known as symmetric SSFS. Fig. 11.25 illustrates the symmetric SSFS. First, the NLSE
is solved with ̂Nb = 0 over a distance Δz∕2. The linear field ql
b(t, Δz∕2) is multiplied by the nonlinear phase
shift and amplified. The resulting field is propagated over a distance Δz∕2 with ̂Nb = 0. It may appear that
the computational effort for the symmetric SSFS is twice that of the unsymmetric SSFS. However, the com-
putational efforts are roughly the same when the step size is much smaller than the fiber length. This can be
understood from the propagation of the field from 0 to 2Δz, as shown in Fig. 11.26 . The linear propagation
operator, eDbΔz∕2 shown in the last block of Fig. 11.25 can be combined with eDbΔz∕2 corresponding to the
first block of the propagation from Δz to 2Δz, leading to a linear propagation operator eDbΔz, as indicated by
the third block in Fig. 11.26. Since the evaluation of eDbΔz or eDbΔz∕2 requires ∼Nlog2N complex multipli-
cations, the computational cost for the symmetric SSFS shown in Fig. 11.26 is roughly 3Nlog2N complex
multiplications, whereas that for the unsymmetric SSFS is roughly 2Nlog2N for propagation up to 2Δz. Over
M propagation steps the computational overhead for the symmetric SSFS increases as (M + 1)∕M. Thus, the
overhead is insignificant when M >> 1. For the given step size, the symmetric SSFS gives a more accurate
result than the unsymmetric SSFS. This is because the error in the case of symmetric SSFS scales as Δz3,
whereas it scales as Δz2 for unsymmetric SSFS [24]. Alternatively, for the given accuracy, a larger step size
could be chosen in the case of symmetric SSFS.
11.8.1
Multi-Span DBP
Fig. 11.27 shows the propagation in an N-span fiber-optic system. To undo the propagation effect, amplifiers
with gain Gn are substituted by loss elements 1∕Gn in the digital domain and a real fiber with parame-
ters (𝛽2n, 𝛾n, 𝛼n), n = 1, 2, … , N is replaced by a virtual fiber with parameters (−𝛽2n, −𝛾n, −𝛼n), as shown
in Fig. 11.28. Note that the signal distortions due to the last fiber in the fiber-optic link are compensated
first in the digital domain. Although the digital back propagation can compensate for deterministic (and
bit-pattern-dependent) nonlinear effects, it can not undo the impact of ASE and nonlinearity–ASE coupling,
such as Gordon–Mollenauer phase noise.

522
Fiber Optic Communications
q(t,0)
Tx.
Rx.
front end
Fiber 1 Amp. 1
Fiber 2 Amp. 2
Fiber N
Amp. N
G1
G2
GN
DSP
𝛽2,1, –𝛾1, –𝛼1
𝛽2,2, –𝛾2, –𝛼2
𝛽2,N, –𝛾N, –𝛼N
Figure 11.27
Propagation in an N-span fiber-optic system.
virtual
fiber N
virtual
fiber N – 1
virtual
fiber 1
Rx.
front end
IF and
phase noise
removal
Loss
1/GN
Decision
circuit
DSP
Loss
1/GN – 1
Loss
1/G1
–𝛽2,N, –𝛾N, –𝛼N
–𝛽2,N – 1, –𝛾N – 1,
–𝛼N – 1
–𝛽2,1, –𝛾1, –𝛼1
Figure 11.28
Digital back propagation for a N-span fiber-optic system.
11.9
Additional Examples
Example 11.2
The noise nl is a zero-mean complex random variable with Gaussian distribution. Show that the mean of the
effective noise n′
l given by Eq. (11.33) is zero.
Solution:
Let
nl = Al exp (i𝜃l) = Al cos (𝜃l) + iAl sin (𝜃l).
(11.148)
Since nl is a Gaussian random variable, it follows that 𝜃l is a random variable with uniform distribution in the
interval [0, 2𝜋]:
< nl >=< Al >< cos (𝜃l) > +i < Al >< sin (𝜃l) >= 0.
(11.149)
Consider
nk
l = Ak
l exp (ik𝜃l) = Ak
l cos (k𝜃l) + iAk
l sin (k𝜃l),
k = 1, 2, … , M
(11.150)
< nk
l >=< Ak
l >< cos (k𝜃l) > +i < Ak
l >< sin (k𝜃l) >= 0.
(11.151)
Since 𝜃l is a uniformly distributed random variable in the interval [0, 2𝜋], k𝜃l is also a uniformly distributed
random variable in the interval [0, 2𝜋k] and therefore < cos (k𝜃l) >=< sin (k𝜃l) >= 0. Eq. (11.33) may be
rewritten as
n′
l = K1nl + K2n2
l + · · · + KMnM
l ,
(11.152)
where Km, m = 1, 2, 3, … M, are complex constants:
< n′
l >= K1 < nl > +K2 < n2
l > + · · · + KM < nM
l > .
(11.153)
Since < nk
l > is zero, it follows that
< n′
l >= 0.
(11.154)

Digital Signal Processing
523
Example 11.3
Show that the impulse response of a dispersion-compensating filter is
W(t) =
√
1
2𝜋i𝛽2L exp
[
it2
2𝛽2L
]
.
(11.155)
Solution:
For a Gaussian pulse, we have the following relations:
[exp (−𝜋t2)] = exp [−𝜋f 2],
(11.156)
[W(at)] = 1
a
̃W(f∕a),
Re(a) > 0.
(11.157)
The transfer function of a dispersion-compensating filter is
̃W(f) = exp (−i2𝜋2f 2𝛽2L).
(11.158)
Choosing a2 = 1∕(2𝜋𝛽2Li), Eq. (11.158) can be written as
̃W(f) = exp (−𝜋f 2∕a2).
(11.159)
Using Eqs. (11.156), (11.157), and (11.158), we find
W(t) = a exp [−𝜋(at)2] =
1
√
2𝜋𝛽2Li
exp
[
it2
2𝛽2L
]
.
(11.160)
Example 11.4
Find the LMS for the updated weights of the PMD equalizer.
Solution:
Following the notation of Section 11.7, let
er[n] = 𝜓r,in[n] −̂𝜓r,in[n],
r = x, y,
(11.161)
Jr =< |er[n]|2 >=< |𝜓r,in[n]|2 −𝜓r,in[n] ̂𝜓∗
r,in[n] −𝜓∗
r,in[n] ̂𝜓r,in[n] + ̂𝜓r,in[n] ̂𝜓∗
r,in[n] > .
(11.162)
Using Eq. (11.76), the gradient vectors are
2
𝜕Jx
𝜕W∗
xx[n] = 2 < −𝜓x,in[n]𝜓∗
x,out[n −k] + 𝜓∗
x,out[n −k] ̂𝜓x,in[n] >= −2 < 𝜓∗
x,out[n −k]ex[n] >,
(11.163)
2
𝜕Jx
𝜕W∗
xy[n] = −2 < 𝜓∗
y,out[n −k]ex[n] > .
(11.164)

524
Fiber Optic Communications
As discussed in Section 11.6.1, the tap weights for the next iteration should be chosen in a direction opposite
to the gradient vector,
Wxx[k](n+1) = Wxx[k](n) + 𝜓∗
x,out[n −k]ex[n]Δ,
(11.165)
Wxy[k](n+1) = Wxy[k](n) + 𝜓∗
y,out[n −k]ex[n]Δ.
(11.166)
Similarly, the tap weights Wyy[k] and Wyx[k] are altered as
Wyy[k](n+1) = Wyy[k](n) + 𝜓∗
y,out[n −k]ey[n]Δ,
(11.167)
Wyx[k](n+1) = Wyx[k](n) + 𝜓∗
x,out[n −k]ey[n]Δ.
(11.168)
Example 11.5
Show that
exp (̂x) ⋅exp (−̂x) = I,
(11.169)
where ̂x is any operator and I is an identity operator.
Solution:
Expanding exp (±̂x) in a Taylor series, we find
exp (̂x) = I + ̂x + ̂x ⋅̂x
2! + · · ·
(11.170)
exp (−̂x) = I −̂x + ̂x ⋅̂x
2! + · · ·
(11.171)
Now consider the product
exp (̂x) ⋅exp (−̂x) =
(
I + ̂x + ̂x ⋅̂x
2
+ · · ·
)
⋅
(
I −̂x + ̂x ⋅̂x
2
+ · · ·
)
= I + (̂x ⋅I −I ⋅̂x) +
(I ⋅̂x ⋅̂x
2
−̂x ⋅̂x + ̂x ⋅̂x ⋅I
2
)
+ · · ·
= I.
(11.172)
Exercises
11.1
Explain the phase increment algorithm for IF estimation.
11.2
Discuss the phase-unwrapping techniques used in phase compensation.
11.3
Write a computer program to compensate for IF and laser phase noise in a back-to-back configuration
with the following parameters: transmitter laser linewidth = 5 MHz, LO linewidth = 10 MHz, fIF =
200 MHz, symbol rate = 25 GSym/s, modulation = NRZ-QPSK. Determine the optimum block size.
11.4
Discuss the advantages and disadvantages of CD compensation in the time domain and the frequency
domain.

Digital Signal Processing
525
11.5
Write a computer program to compensate for CD of a fiber-optic system with the following param-
eters: 𝛽2 = −22 ps2/km, transmission distance = 1000 km, symbol rate = 25 GSym/s, modulation =
NRZ-QPSK. Determine the number of taps required for the time domain technique using a FIR fil-
ter. Also, write a program to compensate for CD in the frequency domain using FFTs. Compare the
computational costs associated with time and frequency domain techniques.
11.6
Provide the algorithms of an adaptive equalizer based on the constant-modulus algorithm (CMA).
11.7
Explain the principles of digital back propagation (DBP). Can DBP compensate for the impairments
due to interaction between fiber nonlinearity and ASE?
11.8
Explain the differences between symmetric and asymmetric split-step Fourier schemes.
11.9
Write a computer program to simulate a single-span fiber-optic system using the symmetric
split-step Fourier scheme. The parameters of the system are as follows: symbol rate = 25 GSym/s,
NRZ-QPSK, span length L = 80 km, 𝛽2 = −22 ps2/km, loss = 0.2 dB/km, 𝛾= 1.1 W−1 km−1, launch
power = 10 dBm. At the receiver, introduce DBP with (a) step size = L, (b) step size = L/2. Compare
the constellation diagrams with and without DBP. Ignore laser phase noise.
Further Reading
R. Chassaing and D. Reay, Digital Signal Processing. John Wiley & Sons, New York 2008.
S. Haykin, Adaptive Filter Theory, 4th edn. Prentice-Hall, Englewood ciffs, NJ, 2001.
S. Haykin, Communication System, 4th edn. John Wiley & Sons, New York 2001.
J.G. Proakis, Digital Communications, 4th edn., McGraw-Hill, New York, 2001.
H. Meyr, M. Molenclaey, and S. Fechtel, Digital Communication Receivers, Synchronization, Channel Estimation, and
Signal Processing. John Wiley & Sons, New York, 1998.
References
[1] G. Li, Adv. Opt. Photon., vol. 1, p. 279, 2009.
[2] A. Einstein, Annal. Phys., vol. 17, p. 549, 1905.
[3] C.H. Henry, J. Lightwave Technol., vol. LT-4, p. 298, 1986.
[4] F. Funabashi et al., IEEE J. Select. Top. Quant. Electron., vol. 10(2), p. 312, 2004.
[5] F. Derr, Electron. Lett., vol. 23, p. 2177, 1991.
[6] H. Meyr, M. Molenclaey, and S. Fechtel, Digital Communication Receivers, Synchronization, Channel Estimation,
and Signal Processing. John Wiley & Sons, New York, 1998, chapter 8.
[7] A. Leven et al, IEEE Photon. Technol. Lett., vol. 19, p. 366, 2007.
[8] M. Morelli and U. Mengali, Eur. Trans. Telecommun., vol. 2, p. 103, 1998.
[9] D.S. Ly-Gagnon et al, J. Lightwave Technol., vol. 24, p. 12, 2006.
[10] A.J. Viterbi and A.M. Viterbi, IEEE Trans. Inform. Theory, vol. IT-29, p. 543, 1983.
[11] E. Ip and M. Kahn, J. Lightwave Technol., vol. 25, p. 2675, 2007.
[12] D.E. Crivelli, H.S. Cortnr, and M.L. Hunda, Proceedings of IEEE Global Telecommunications Conference (GLOBE-
COM), Dallas, TX, Vol. 4, p. 2545, 2004.
[13] T. Pfan, S. Hoffmann, and R. Nor, J. Lightwave Technol., vol. 27, p. 989, 2009.
[14] M.G. Taylor, Proceedings of European Conference on Optical Communication (ECOC), Vol. 2, p. 263, 2005.
[15] E. Ip and J.M. Kahn, J. Lightwave Technol., vol. 25, p. 2765, 2007.
[16] S.J. Savory, Opt. Expr., vol. 16, p. 804, 2008.
[17] G. Goldfarb and G. Li, IEEE Photon. Technol. Lett., vol. 19, p. 969, 2007.

526
Fiber Optic Communications
[18] J.G. Proakis, Digital Communications, 4th edn. McGraw-Hill, New York, 2001, chapter 11.
[19] S. Haykin, Communication Systems, 4th edn. John Wiley & Sons, New York, 2001.
[20] S. Haykin, Adaptive Filter Theory, 4th edn. Prentice-Hall, Englewood Cliffs, NJ, 2001, chapter 5.
[21] D.N. Godard, IEEE Trans. Commun., vol. com-28, p. 1867, 1980.
[22] Y. Li et al, Opt. Expr., vol. 16, p. 880, 2008.
[23] E. Ip and J. Kahn, J. Lightwave Technol., vol. 26, p. 3416, 2008.
[24] G.P. Agrawal, Nonlinear Fiber Optics, 3rd edn. Academic Press, San Diego, 2001.

Appendix A
From Eq. (3.15), we find that the Einstein coefficients A and B are related by
A = 𝛾ℏ𝜔B,
(A.1)
where
𝛾=
𝜔2n3
0
𝜋2c3 .
(A.2)
The spontaneous emission rate per unit volume is given by Eq. (3.4),
Rspont = −
(dN2
dt
)
spont
= 𝛾ℏ𝜔BN2.
(A.3)
In Eq. (A.3), the medium is assumed to be homogeneous with refractive index n0 and this emission rate takes
into account all the modes of the homogeneous medium in the frequency interval [𝜔,
𝜔+ d𝜔]. Typically,
amplifiers or lasers make use of single mode or multi-mode devices such as single/multi-mode fibers or
channel waveguides. In a single-mode fiber amplifier, the ASE coupled to a radiation mode escapes to the
cladding and does not contribute to the fiber amplifier output. Only the ASE coupled to the guided mode is of
practical interest. Therefore, we modify Eq. (A.3) such that the spontaneous emission rate corresponds to ASE
coupled to the guided mode. In fact, 𝛾of Eq. (A.2) represents the number of modes of a homogeneous medium
per unit volume per unit frequency interval. To see that, consider an electromagnetic wave in a homogeneous
medium confined to a cube of volume L3. The plane wave inside this cube is
𝜓= A cos(𝜔t −kxx −kyy −kzz),
(A.4)
with
𝜔= kc∕n0,
(A.5)
k2 = k2
x + k2
y + k2
z.
(A.6)
If L is infinite, kx, ky, and kz can take arbitrary values satisfying Eq. (A.6). The propagation of the plane wave
is in the direction of k = kx̂x + kŷy + kẑz. Therefore, spontaneous emission occurs uniformly in all directions.
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

528
Fiber Optic Communications
When L is finite, and if we assume that the walls of the cube are perfectly conducting, the field should vanish
at the walls. In this case kx, ky, and kz take discrete values given by
kx = 2𝜋nx
L
, ky =
2𝜋ny
L
,
and
kz = 2𝜋nz
L
,
(A.7)
where nx, ny, and nz are integers. In other words, they are the standing waves formed by the superposition
of plane waves propagating in opposite directions (cos(𝜔t −kxx −kyy −kzz) and cos(𝜔t + kxx + kyy + kzz)).
In this case, spontaneous emission occurs at discrete angles in the direction of k = kx̂x + kŷy + kz, ̂z with kx,
ky, and kz given by Eq. (A.7). We wish to find the number of modes per unit volume, with angular frequencies
ranging from 𝜔to 𝜔+ d𝜔. This corresponds to wave numbers ranging from k (= |k|) to k + dk. For the given
value of k, there can be a number of modes with different values of kx, ky, and kz satisfying Eq. (A.6). For
example, kx = k, ky = kz = 0 is a mode propagating in the x-direction and kx = k∕
√
2, ky = k∕
√
2, kz = 0 is
another mode propagating at angle 45∘to the x-axis and 45∘to the y-axis, and so on. The wave numbers
ranging from k to k + dk correspond to modes in the intervals [kx, kx + dkx],[ky, ky + dky], and [kz, kz + dkz]
with
k2 = k2
x + k2
y + k2
z
(A.8)
and
(k + dk)2 = (kx + dkx)2 + (ky + dky)2 + (kz + dkz)2.
(A.9)
From Eq. (A.7), we have
dkx = 2𝜋
L dnx,
(A.10)
where dnx is the number of modes in the interval [kx,
kx + dkx]. The total number of modes with the
x-component of the wave vector ranging from kx to kx + dkx, the y-component ranging from ky to ky + dky,
and the z-component ranging from kz to kz + dkz is
dnxdnydnz =
L3
(2𝜋)3 dkxdkydkz,
(A.11)
where dkxdkydkz represents the volume of the spherical shell enclosed between two spheres with radii k and
k + dk, as shown in Fig. A.1. Therefore,
dkxdkydkz = (area of the sphere with radius k) × dk
= 4𝜋k2dk.
(A.12)
Substituting Eq. (A.12) into Eq. (A.11), we find that the total number of modes per unit volume with angular
frequency ranging from 𝜔to 𝜔+ d𝜔is
dnxdnydnz
L3
= 4𝜋k2dk
(2𝜋)3
=
𝜔2n3
0d𝜔
2𝜋2c3 ,
(A.13)
where
𝜔n0∕c = k.
(A.14)

Appendix A
529
kx
ky
kz
k
k+dk
Figure A.1
Number of modes in the volume of a spherical shell enclosed between two spheres with radii k and k + dk.
For each mode defined by (kx̂x + kŷy + kẑz), there could be two polarizations (see Section 1.11). Therefore,
each mode can be considered as two polarization modes. The total number of modes per unit volume per unit
frequency interval, taking into account two polarization modes, is then
𝛾=
2dnxdnydnz
L3d𝜔
= Nm
L3
(A.15)
=
𝜔2n3
0
𝜋2c3 ,
(A.16)
where Nmd𝜔is the number of modes in the frequency interval [𝜔,
𝜔+ d𝜔]. Eq. (A.16) is valid only for a
homogeneous medium. In the case of an optical fiber, the general expression Eq. (A.15) should be used. From
Eq. (A.3), the photon gain rate per unit volume due to spontaneous emission is
Rspont =
(dNph
dt
)
spont
= 𝛾ℏ𝜔BN2 = Nmℏ𝜔BN2
L3
,
(A.17)
where Nph is the photon density. The spontaneous emission occurs over all the spatial and polarization modes
of an optical fiber, and Eq. (A.17) represents the total spontaneous emission rate over all the modes. However,
all the modes do not contribute to the spontaneous emission at the amplifier output. In a single-mode fiber,
only the spontaneous emission coupled to the guided mode is of interest. For a single mode fiber with a single
polarization mode, Nm = 1 and Eq. (A.17) becomes
Rspont =
(dNph
dt
)
spont
= AN2,
(A.18)
where
A = ℏ𝜔B∕L3.
(A.19)

530
Fiber Optic Communications
Next we consider the photon net gain rate due to absorption and spontaneous/stimulated emission. In this
analysis, we ignore the loss of photons due to scattering and other possible mechanisms. From Eqs. (3.74)
and (3.81), we have
dNph
dt
= Rstim + Rabs + Rspont
= ℏ𝜔BNph(N2 −N1) + AN2.
(A.20)
Let nph be the number of photons in the volume L3,
nph = NphL3.
(A.21)
Using Eqs. (A.21) and (A.19), Eq. (A.20) may be rewritten as
dnph
dt
= ℏ𝜔Bnph(N2 −N1) + ℏ𝜔BN2.
(A.22)
Using 𝑣= dz∕dt and simplifying Eq. (A.22), we obtain
dnph
(N2 −N1)nph + N2
= ℏ𝜔Bdz
𝑣
.
(A.23)
Eq. (A.23) can be rewritten as
dnph
nph + nsp
= ℏ𝜔B(N2 −N1)dz
𝑣
,
(A.24)
where
nsp =
N2
N2 −N1
(A.25)
is known as the spontaneous emission factor or population-inversion factor. For an amplifier, N2 > N1 and,
therefore, nsp ≥1. Integrating Eq. (A.24) from 0 to L, we find
ln [nph(L) + nsp] −ln [nph(0) + nsp] = gL,
(A.26)
g = ℏ𝜔B(N2 −N1)
𝑣
(A.27)
or
nph(L) = nph(0) exp(gL) + nsp[exp (gL) −1].
(A.28)
Since G = exp (gL), Eq. (A.28) can be written as
nph(L) = nph(0)G + nsp(G −1).
(A.29)
Eq. (A.29) is of fundamental significance. The first and second terms on the right hand side represent the
photon gain due to stimulated emission and spontaneous emission, respectively.
Next, let us consider the average noise power due to spontaneous emission. A photon of energy ℏ𝜔0 is
assumed to occupy a length L or equivalently time L∕𝑣[1, 2]. The noise power of a photon is
P𝜔0 = ℏ𝜔0
L∕𝑣.
(A.30)

Appendix A
531
In a single-mode fiber, the propagation part of the guided mode is of the form exp [i(𝜔t −kz)] with
𝜔
k = 𝑣=
c
neff
,
(A.31)
where neff is the effective refractive index of the mode (see Chapter 2). The spontaneous emission occurs
in both the forward and the backward direction. The forward propagating wave exp [i(𝜔t −kz)] and the
backward propagating wave exp [i(𝜔t + kz)] form a standing wave. In Section 3.3, we have found that the
frequency for the longitudinal modes is given by
𝜔= 𝜋m𝑣
L ,
m = 0, ±1, ±2, …
(A.32)
and
Δ𝜔= 𝜋r𝑣
L ,
(A.33)
where r is the number of longitudinal modes in the frequency interval [𝜔0,
𝜔0 + Δ𝜔]. The total noise power
of photons in this frequency interval is
Ptotal =
r∑
j=0
ℏ(𝜔0 + j𝛿𝜔)𝑣
L
,
(A.34)
where r𝛿𝜔= Δ𝜔. Assuming Δ𝜔≪𝜔0,
ℏ(𝜔0 + j𝛿𝜔) ≅ℏ𝜔0.
(A.35)
Now, using Eqs. (A.35) and (A.33), Eq. (A.34) reduces to
Ptotal = ℏ𝜔0𝑣r
L
= ℏ𝜔0Δ𝜔
𝜋
.
(A.36)
The noise power given by Eq. (A.36) includes the power emitted in the forward and backward directions. We
are mainly interested in the noise power accompanying the amplified signal in the forward direction, which
is half of that given by Eq. (A.36). Using Δ𝜔= 2𝜋Δf, we have
Pforward
total
= ℏ𝜔0Δf.
(A.37)
So far we have assumed a single photon of energy ℏ𝜔0. If there are nsp(G −1) photons, Eq. (A.37) is
modified as
PASE = nsp(G −1)hf0Δf,
(A.38)
where PASE is the mean noise power in the frequency interval [f0, f0 + Δf].
References
[1] P.C. Becker, N.A. Olsson, and J.R. Simpson, Erbium-Doped Fiber Amplifiers, Fundamentals and Technology,
Academic Press, San Diego, 1999.
[2] M.L. Dakss and P. Melman, J. Lightwave Technol, vol. LT-3, p. 806, 1985.


Appendix B
From Maxwell’s equations, we have
∇2E = 𝜇0
𝜕2D
𝜕t2 .
(B.1)
From Eq. (10.24), we have
D = 𝜖0E + P.
(B.2)
Let us consider the case of a single polarization:
E = Exx,
P = Pxx.
(B.3)
From Eq. (10.42), we have
Px(r,t) = PL(r,t) + PNL(r,t),
(B.4)
where
PL(r,t) = 𝜖0𝜒(1)Ex(r,t),
(B.5)
PNL(r,t) = 𝜖0𝜒(3)E3
x(r,t).
(B.6)
Here, we have ignored the subscripts ’xx’ and ’xxxx’. For a dispersive medium, the first-order susceptibil-
ity 𝜒(1) is a function of frequency (see Eq. (10.22)). Since the product in the frequency domain becomes a
convolution in the time domain, for a dispersive medium, Eq. (B.5) should be modified as
PL(r,t) = 𝜖𝜒(1)(r,t) ⊗Ex(r,t)
(B.7)
or
̃PL(r,𝜔) = 𝜖̃𝜒(1)(r,𝜔) ̃Ex(r,𝜔),
(B.8)
where ⊗denotes convolution. An optical pulse propagating down the fiber has rapidly varying oscillations at
the carrier frequency and a slowly varying envelope corresponding to the pulse shape. Therefore, the electric
field may be written in the following form:
Ex(r, t) = 1
2[E0(r, t) exp(−i𝜔0t) + c.c.],
(B.9)
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.

534
Fiber Optic Communications
where E0(r, t) is the slowly varying function of time and c.c stands for complex conjugate. Substituting
Eq. (B.9) in Eq. (B.6), we find
PNL(r, t) = 𝜖0𝜒(3)
8
[3|E(r, t)|2E(r, t) exp(−i𝜔0t) + E3(r, t) exp(−i3𝜔0t)] + c.c.
(B.10)
The first term in the square bracket corresponds to oscillations at 𝜔0 and the second term corresponds to third
harmonic frequency 3𝜔0. The efficiency of third harmonic generation in fibers is very small unless special
phase-matching techniques are used. Therefore, ignoring the second term and substituting Eqs. (B.7)–(B.10)
in Eq. (B.1), we obtain
∇2Ψ(r, t) −1
c2
𝜕2Ψ(r, t)
𝜕t2
= 1
c2
𝜕2
𝜕t2 [𝜒(1)(r,t) ⊗Ψ(r, t)] + 3𝜒(3)
4c2
𝜕2
𝜕t2 [|Ψ(r, t)|2Ψ(r, t)],
(B.11)
where
Ψ(r, t) = E0(r, t) exp(−i𝜔0t),
c2 =
1
𝜇0𝜖0
.
The electric field intensity in a single-mode fiber may be written as (see Chapter 2)
Ψ(r, t) = q(z, t)𝜙(x, y)e−i(𝜔0t−𝛽0z),
(B.12)
where 𝛽0 = 𝛽0(𝜔0) is the propagation constant, 𝜙(x, y) is the transverse field distribution, and q(z, t) is the
field envelope which is a slowly varying function of t and z. Substituting Eq. (B.12) in Eq. (B.11) and taking
the Fourier transform, we obtain
[
𝜙𝜕2̃q(z, Ω)
𝜕z2
+ 2i𝛽0𝜙𝜕̃q(z, Ω)
𝜕z
−𝛽2
0 ̃q(z, Ω)𝜙
]
+
{𝜕2𝜙
𝜕x2 + 𝜕2𝜙
𝜕y2 + 𝜔2𝜙
c2
[1 + ̃𝜒(1)(r, 𝜔)]}
̃q(z, Ω)
= −3𝜔2𝜒(3)
4c2
{𝜙3(x, y)[̃q(z, Ω) ⊗̃q∗(z, −Ω) ⊗̃q(z, Ω)]},
(B.13)
where Ω = 𝜔−𝜔0. To obtain Eq. (B.13), we have used the Fourier transform relations

(
𝜕2A
𝜕t2
)
= −𝜔2 ̃A(𝜔)
(B.14)
and
[A(t)B(t)] = ̃A(𝜔) ⊗̃B(𝜔)
= ∫
̃A
(
𝜔′
2𝜋
)
̃B
(
𝜔−𝜔′
2𝜋
)
d𝜔
2𝜋.
(B.15)
Under the slowly varying envelope approximation, the first term in Eq. (B.13) can be ignored, which is a good
approximation for pulse widths that are much longer than the period 2𝜋∕𝜔0. From Eq. (10.29), we have
1 + ̃𝜒(1)(r, 𝜔) = n2(r, 𝜔),
(B.16)

Appendix B
535
where n is the linear refractive index of the fiber. For a single-mode fiber we have
𝜕2𝜙
𝜕x2 + 𝜕2𝜙
𝜕y2 + 𝜔2n2(r, 𝜔)
c2
𝜙= 𝛽2(𝜔)𝜙,
(B.17)
where 𝛽(𝜔) is the propagation constant. Substituting Eqs. (B.16) and (B.17) in Eq. (B.13), we obtain
2i𝛽0
𝜕̃q(z, Ω)
𝜕z
𝜙+ [𝛽2(𝜔) −𝛽2
0]𝜙̃q = −3𝜔2𝜒(3)
4c2
{𝜙3(x, y)[̃q(z, Ω) ⊗̃q∗(z, −Ω) ⊗̃q(z, Ω)]}.
(B.18)
To remove the dependence of transverse field distributions, we multiply Eq. (B.18) by 𝜙(x, y) and integrate
from −∞to ∞in the x–y plane to obtain
i𝜕̃q
𝜕z +
[𝛽2(𝜔) −𝛽2
0]̃q
2𝛽0
= −3𝜔2𝜒(3)
8c2Aeff𝛽0
[̃q(z, Ω) ⊗̃q∗(z, −Ω) ⊗̃q(z, Ω)],
(B.19)
where
Aeff =
∫∞
−∞∫∞
−∞𝜙2(x, y)dxdy
∫∞
−∞∫∞
−∞𝜙4(x, y)dxdy
.
(B.20)
The second term on the left-hand side of Eq. (B.19) can be approximated as
[𝛽2(𝜔) −𝛽2
0]̃q
2𝛽0
= [𝛽(𝜔) + 𝛽0][𝛽(𝜔) −𝛽0]̃q
2𝛽0
≅[𝛽(𝜔) −𝛽0]̃q.
(B.21)
The above approximation is valid if the difference between 𝛽(𝜔) and 𝛽0 is quite small. If the spectral width
of the optical signal is comparable with or larger than 𝜔0, the above approximation could be incorrect. When
the spectral width Δ𝜔≪𝜔0, we can approximate 𝛽(𝜔) as a Taylor series around 𝜔0 and retain the first three
terms,
𝛽(𝜔) = 𝛽0 + 𝛽1(𝜔−𝜔0) + 𝛽2
2 (𝜔−𝜔0)2 + 𝛽3
6 (𝜔−𝜔0)3,
(B.22)
where
𝛽n = dn𝛽
d𝜔n
||||𝜔=𝜔0
(B.23)
is known as the nth-order dispersion coefficient (see Chapter 2). Substituting Eqs. (B.21) and (B.22) in
Eq. (B.19), we obtain
i𝜕̃q
𝜕z +
(
𝛽1Ω + 𝛽2
2 Ω2 + 𝛽3
6 Ω3
)
̃q = −3(𝜔0 + Ω)2𝜒(3)
8c2Aeff𝛽0
[̃q(z, Ω) ⊗̃q∗(z, −Ω) ⊗̃q(z, Ω)].
(B.24)
If we include the fiber losses by treating the refractive index n as complex with its imaginary part being
frequency independent, Eq. (B.24) is modified as
i𝜕̃q
𝜕z +
(
𝛽1Ω + 𝛽2
2 Ω2 + 𝛽3
6 Ω3
)
̃q = −i𝛼̃q
2 −3(𝜔0 + Ω)2𝜒(3)
8c2Aeff𝛽0
[̃q(z, Ω) ⊗̃q∗(z, −Ω) ⊗̃q(z, Ω)],
(B.25)
where 𝛼is the fiber loss coefficient related to the imaginary part of the refractive index through Eq. (10.37). We
have assumed 𝛼to be independent of frequency. Since Ω ≪𝜔0, (𝜔0 + Ω)2 ≃𝜔2
0 + 2𝜔0Ω. Now, performing
the inverse Fourier transform, we obtain
i
(𝜕q
𝜕z + 𝛽1
𝜕q
𝜕t
)
−𝛽2
𝜕2q
𝜕t2 + i𝛾|q|2q = i𝛽3
6
𝜕3q
𝜕t3 −i2𝛾
𝜔0
𝜕(|q|2q)
𝜕t
+ i𝛼
2 q,
(B.26)

536
Fiber Optic Communications
where
𝛾=
3𝜔2
0𝜒(3)
8c2Aeff𝛽0
(B.27)
is the nonlinear coefficient. Note that multiplication by Ω in the frequency domain leads to the operator i 𝜕
𝜕t in
the time domain. Eq. (B.26) in the absence of the right-hand side terms is called the nonlinear Schrödinger
equation (NLSE). The third term on the left-hand side represents self-phase modulation, which is discussed
in Section 10.5. The second term on the right-hand side of Eq. (B.26) is responsible for self-steepening.
The terms on the right-hand side of Eq. (B.26) become important for ultra-short pulses (pulse width < 1ps).
Eq. (B.26) in the presence of the right-hand-side terms is called the modified nonlinear Schrödinger equation
(MNLSE). From Eq. (10.53), we have
n2 = 3𝜒(3)
8n0
.
(B.28)
Using Eq. (B.28) in Eq. (B.27) and noting that 𝛽0 ≅𝜔0n0∕c, we obtain
𝛾= n2𝜔0
cAeff
.
(B.29)

Index
absorption coefficient, 157, 158
adaptive equalizers, 510, 512–3, 510–513
additive white Gaussian noise (AWGN) channel,
335
alternate mark inversion (AMI), 139, 140, 169–72,
170–172
Ampere’s circuital law, 4, 4–5
Ampere’s Law
Ampere’s circuital law, 4, 4–5
density, 4, 5
differential form, 9
magnetic field intensity, 3–6, 4
magnetic flux, 4, 5–6
permeability, 5
relative permeability, 5
amplified spontaneous emission (ASE)
amplifier noise figure, 260, 260–262
amplifier spacing impact, 318–19, 319, 323,
326–7, 326–7
ASE–ASE beat noise, 253, 256, 259, 261,
291–6, 292, 295, 323, 471
bandwidth, 252, 252, 262, 290, 292, 294
cutoff frequency, 255, 292, 294
dark current, 260
in EDFAs, 280–281
electrical filter, 254–5, 288–96, 292, 295
equivalent noise figure, 317, 317–18
field envelope, 251–2, 252
mean noise power, 254–5
mean (total), 256–8
noise, band-pass representation, 250, 250
Fiber Optic Communications: Fundamentals and Applications, First Edition. Shiva Kumar and M. Jamal Deen.
© 2014 John Wiley & Sons, Ltd. Published 2014 by John Wiley & Sons, Ltd.
noise, low-pass representation, 249–51,
250–251
noise output, 251–6, 252, 259–61, 260, 289
optical filter, 254, 288–96, 292, 295
optical signal-to-noise ratio (OSNR), 262–3,
317–318, 321–2
photocurrent, 259
polarization, 248
polarization (dual), 258–9, 262
polarization (single), 251–2, 252
power spectral density, 249–52, 251–2, 254–5,
261, 289, 296, 316–319, 319, 471, 478
principles, 248–9
Rayleigh back scattering, 287, 287–8
shot noise, 261
signal–ASE beat noise, 253–6, 259, 288–90,
326
signal-to-noise ratio (SNR), 260, 261, 296
spontaneous emission factor, 261
spontaneous emission factor
(population-inversion factor), 248
system impact generally, 251–3, 252
total power incident, 258
transmission system design, 315–317, 316
variance (total), 256–8
amplitude and phase-shift keying (APSK), 178–82,
179–80
amplitude modulation, 144, 144, 155, 157
amplitude-shift keying, 144, 144, 158, 158–60,
160
anti-Stokes Raman scattering, 479
APD-HEMT photoreceivers, 224

538
Index
APDs (avalanche photodetectors), 207–12, 208–9,
212
APSK, 178–82, 179–80
arbitrary receiver filter error probability, 345
arrayed-waveguide gratings, 398, 398–401
ASE–ASE beat noise, 253, 256, 259, 261, 291–6,
292, 295, 323, 471
avalanche photodetectors (APDs), 207–12, 208–9,
212
AWGN (additive white Gaussian noise) channel,
335
balanced coherent receivers, 232, 306, 306–13,
309–11
balanced IQ coherent receivers, 237–9
bandwidth
ASE, 252, 252, 262, 290, 292, 294
OFDM systems, 403, 414–5
optical fiber transmission, 35–6
partial response signals, 167–8, 167–8
photodetectors, 213–15
SOAs, 266–7, 266–8
transmission system design, 323–4
Baraff’s expression, 208
BASK, 172–4, 173–4
bipolar junction transistor (BJT), 206–7, 207
bit error rate (BER)
FSK, 373–4
homodyne receivers, 348, 349
optimum binary receivers, 337–9, 339, 344
phase-shift keying (PSK), 385–6
transmission system design, 303–305, 304–305,
308–313, 309–311, 320, 320–321, 324,
324–5
See also error probability
blind equalizers, 513, 513
Boltzmann’s law, 95, 101
B-PSK, 174–8, 175–8, 463–4, 471
cavity-type (Fabry–Perot) SOAs, 264, 264–8,
266–7, 273, 296–8
CD equalization, 506–13, 507–10, 513
coherent receivers
balanced, 232–4, 233
balanced IQ, 237–9
heterodyne (See heterodyne receivers)
homodyne (See homodyne receivers)
optimum binary receivers (See optimum binary
receivers)
polarization, 239–42, 240
principles, 227–8
single-branch, 228, 228–9
single-branch IQ, 234–7, 235–7
transmission system design, 322–5, 324
complementary error function, 338–9
constant modulus algorithm (CMA) equalizers,
510, 512–3, 510–513
Corning Glass Works, 35
Coulomb’s law
bullet flow divergence, 3, 4
charges, force of attraction/repulsion, 1–2, 2
divergence, 3
electrical field density, 1–3
electric flux density, 2, 2–3
flux crossing, 2
Gauss’s law, 3
Gauss’s law, differential form of, 3, 4, 6
permittivity, 1
radius, flux crossing relationship to, 3
sphere, electric flux passing through, 2, 2–3
test charge force, 1–2, 2
volume charge density, 3
cross-phase modulation (XPM)
distortion, 447–8, 448
efficiency, 441–5, 444
fiber dispersion, 75
optical fiber transmission, 75
phase noise, 477
phase shifting, 446–7, 447
power spectral density (PSD), 447–8, 448
principles, 419, 438–9
pulse separation, 439, 441–3
pump power, 445–6
SPM interactions with, 438–9
system performance impact, 445–8, 448
timing shift, 439–41, 440–441
variance calculations, 463–6
walk-off parameter, 443–4, 444
DBRs (distributed Bragg reflectors), 132, 212, 214
d.c. extinction ratio, 156
De Broglie wavelength, 109
differential phase-shift keying, 146–9, 147–9,
162–3, 163

Index
539
diffraction-based multi/demultiplexers, 398, 398
digital back-propagation, 516–22, 518, 520–521
digital signal processing
adaptive equalizers, 510, 512–3, 510–513
benefits, 497
blind equalizers, 513, 513
CD equalization, 506–13, 507–10, 513
coherent IQ receiver, 497–8, 497–8
digital back-propagation, 516–22, 518,
520–521
effective noise mean, 522
FIR filter, 508, 508
IF estimation and compensation, 501–3, 501–3
impulse response, 523
laser phase noise, 498–500, 500
multi-span DBP, 521–2, 522
Nyquist theorem, 509
operators, identity operators, 524
phase estimation and compensation, 503–6,
504, 506
phase unwrapping, 505–6, 506
polarization mode dispersion equalization,
513–16, 514–6, 523–4
dipole moment, 421
Dirac delta function, 47–8, 83–4
direct detection systems
DPSK, 374–9, 375–8, 461
FSK systems (See frequency-shift keying (FSK))
IMDD systems, 445–8, 448
modulation scheme comparison, 379–81, 380
OOK (See OOK systems)
photodetectors, 219–24, 220–223
principles, 368
transmission system design, 316, 319–22, 320,
326–7, 326–7, 331–3
dispersion-compensating fibers (DCFs)
CD equalization, 506–13, 507–10, 513
fiber dispersion, 75
FIR filter, 508, 508
impulse response, 523
nonlinear effects, 466–8, 466–71, 486
principles, 79–81, 80
pulse width/fiber length calculations, 84, 84–6
transmission system design, 331–3
distributed Bragg reflectors (DBRs), 132, 212, 214
distributed-feedback lasers, 132–3
DPSK systems
amplifier gain, 379
bit interval, 378
bit transmission, 374–5, 375
delay-and-add filter, 376, 377
delay-and-subtract filter, 377, 377
direct detection modulation scheme comparison,
379–81, 380
duty RZ pulses, 378
matched filters, 376, 377
maximum transmission distance, 378–9
operating frequency, 378–9
optical field envelopes, 375, 376
orthogonality, 375–6, 376
power spectral density, 379
principles, 374–9, 375–8, 461
signal energy, 377–8
echo pulses, 455–7, 456–7, 467, 467
EDFA. See erbium-doped fibers amplifier (EDFAs)
Einstein, Albert, 93, 94
Einstein coefficients, 97–100
electroabsorption (EA) modulators, 157, 157–8
electromagnetic wave propagation
anomalous dispersion, 30
described, 17, 17–19
energy densities, 18
group velocity, 26–31, 27
group velocity dispersion, 30
inverse group speed, 29, 30
optical intensity, 18
phase velocity, 26–31, 27
power density, 18
prism, light propagation, 29, 29
electron microscopy, 110
equivalent noise figure, 317, 317–318
erbium-doped fibers amplifier (EDFAs)
absorption cross-section, 276–7
amplified spontaneous emission, 280–281
carrier lifetime, 281
energy transfer, 277
gain coefficient, 281
gain saturation, 280, 280
gain spectrum, 274–5, 275, 285
interchannel cross-talk, 281
optical intensity, 276
photon flux density, 275
polarization-dependent gain (PDG), 281

540
Index
erbium-doped fibers amplifier (EDFAs) (continued)
population inversion, 280
principles, 247, 274, 274
pump absorption, 275
pump power, 278–80, 279
pump threshold, 280
rate equations, 275–80, 279
signal beam evolution, 278–80, 279
signal power, 278–80, 279
SOAs vs., 281
steady-state conditions, 277
wavelength-selective coupler (WSC), 274, 274
error probability
heterodyne receivers, 355–6, 362–4, 364,
366–7, 367
OOK systems, 355–6, 362–4, 364, 370–371,
384–5
optimum binary receivers, 338–9, 345
phase-shift keying (PSK), 385–6
See also bit error rate (BER)
Fabry–Perot resonator, 214–18, 218
Faraday’s Law
Ampere’s Law, differential form, 9
curl of vector, 7–9, 8–9
defined, 6, 6–7
electric field formation, 9
electromotive force (e.m.f.), 6, 6–7
integrals, 7
magnetic flux, 7
paddle wheel analogy, 8–9, 8–9
Stokes’s theorem, 7, 9
Fermat’s principle, 21–5, 22, 23
Fermi–Dirac function, 116, 117
fiber loss-induced limitations generally, 301–6,
302–5
field envelopes
ASE, 251–2, 252
complex, 426
DPSK systems, 375, 376
heterodyne receivers, 356, 359
homodyne receivers, 347, 349
modulators, modulation schemes, 161
MZ interferometer modulators, 395, 397
nonlinear effects in fibers, 487–9, 489
optical amplifiers, 247–50, 248, 250–251
optical fiber transmission, 58–70, 76–7, 83–4,
86–7, 487–9, 489
output, 427
single-mode fibers, 58–70, 76–7, 83–4, 86–7
FIR filter, 508, 508
four-wave mixing (FWM)
central channel tones, 484–6, 485–6
degenerate FWM, 452, 452
degenerate IFWM, 456, 457
echo pulses, 455–7, 456–7, 467, 467
efficiency, 450–453, 451
fiber dispersion, 75
interchannel/intrachannel analogy, 457, 458
mean power, 452, 452–3
non-degenerate FWM, 452, 452
non-degenerate IFWM, 456, 457
numerical simulation, NLSE, 466–8, 466–71
optical fiber transmission, 75
phase noise, 477
principles, 419, 435–6, 436, 438, 448–53,
451–2
variance calculations, 463–6
free spectral range (FSR), 266
frequency-division multiplexing (FDM), 391
frequency-shift keying (FSK)
asynchronous detection, 364–7
bit transmission, 373–4
direct detection, 371, 371–4
direct detection modulation scheme comparison,
379–81, 380
direct detection principles, 371, 371–4
error probabilities, 373–4
heterodyne receivers, 356–8, 357–8
matched filters, 371–2
modulation schemes comparison, 366–7, 367
MZ interferometer modulators, 145, 145–6,
163, 164
orthogonal, 358–9
orthogonality, 375
orthogonality conditions, 373
Parseval’s relations, 372
photodetector outputs, 372–3
principles, 145, 145–6, 163, 164
variances, 373
FSK. See frequency-shift keying (FSK)
full-width at half-maximum (FWHM), 64, 267, 314
FWM. See four-wave mixing (FWM)

Index
541
gallium arsenide photodetectors, 192, 192–3, 197
Gaussian pulse, 65–7, 65–7, 86–9, 87–8
Gauss’s law, 3
Gauss’s law, differential form of, 3, 4, 6
Godard’s algorithms, 513
Gordon–Mollenauer phase noise, 474–6
graded-index multi-mode fibers, 42–4, 43
group velocity, 26–31, 27
guided modes, 46–51, 47, 49–50, 54
half-wave voltage (switching voltage), 152
Helmholtz equation, 45
heterodyne receivers
ASE limited systems, 352
asynchronous detection, 351
asynchronous detection (FSK), 364–7
asynchronous detection (OOK), 359–64, 360,
364
BER, 357–8, 358
bit energy, 354, 357
bit transmission, 362–3, 366
electron charge, 355
envelope detector outputs, 365–6
error probability, 355–6, 362–4, 364, 366–7,
367
fiber-optic link model, 350, 350–351
field envelopes, 356, 359
frequency component, 361–2, 365
frequency-shift keying (FSK), 356–8, 357–8
Marcum Q-function, 364
matched filters, 351–2, 351–2, 356, 357,
359–62, 360, 364–5, 381–2
matched filter transfer function, 359
modulation schemes comparison, 366–7, 367
noise calculation, 354–5
orthogonal FSK, 358–9
orthogonal signals, 365
output sample, 362
pdf component, 362, 366
phase-key shifting (PSK), 351–3, 355–6
photocurrent, 350
photocurrents, 356
power spectral density (PSD), 350, 355, 361,
382–4
received signal power, 353
Rician distribution, 362, 366
scaling factor, 350, 359, 360, 365
shot noise limited systems, 352–3
signal calculation, 354, 381–2
sinc function, 357–8, 358
single-branch, principles, 230–232, 231–2
synchronous detection (FSK), 356–8, 357–8
synchronous detection (OOK), 353–6
synchronous detection (PSK), 351–3
threshold, 362–3
total current, 350
heterojunction lasers, 124–5, 124–6, 128
heterojunction phototransistor (HPT), 207
Hockham, G., 35
homodyne receivers
asynchronous detection, 351
average energy, 347, 349
bit error ratio, 348, 349
current output, 346–7
detection, 347–8
direct detection modulation scheme comparison,
379–81, 380
fiber-optic channel noise, 346
field envelope, 347, 349
matched filters, 347
noise, 346, 386–7
normalized energy per bit, 348
on–off keying, 349, 349
Parseval’s relations, 348, 386
phase-shift keying (PSK), 347–8, 385–7
power spectral density, 346, 347
Q factor/BER relationship, 348
received signal power, 353
scaling factor, 347
shot noise/thermal noise, 346
single-branch, principles, 229–30
transmission system principles, 345–6, 346
IF estimation and compensation, 501–3,
501–3
IFWM (intra-channel four-wave mixing), 419,
454–7, 456–7, 463–6, 477
IMDD systems, 445–8, 448
impact ionization phenomenon, 207–8, 208
indium gallium arsenide, 192, 193, 203, 203–4,
211–2
indium gallium arsenide phosphide, 192, 193, 203,
203–4, 211–2

542
Index
intersymbol interference (ISI)
causes, 75
delay-and-add filters, 163–5, 164–5
in eye diagrams, 223
Nyquist pulse, 165
in OFDM systems, 402
in OOK systems, 313–15, 314
variance calculations, 463–7
intra-channel cross-phase modulation (IXPM), 419,
454, 455, 463–6, 477
intra-channel four-wave mixing (IFWM), 419,
454–7, 456–7, 463–6, 477
inverse group speed, 29, 30
ISI. See intersymbol interference (ISI)
IXPM (intra-channel cross-phase modulation), 419,
454, 455, 463–6, 477
Johnson noise. See thermal noise
Kao, C., 35
Keck, D., 35
Kerr coefficient, 426, 428
Kerr effect, 419, 426, 439, 481
Kronecker delta function, 464
laser phase noise, 498–500, 500
lasers
absorption rate, 94, 94, 99
active regions, 124, 125, 127
De Broglie wavelength, 109
directly modulated, 149–50, 150
distributed-feedback, 132–3
Einstein coefficients, 97–100
enclosed radiation, 96–7, 96–8
energy density, 99–101, 106, 107, 111–2,
126–30, 130
energy difference, 95–6, 96
energy spectral density, 96–7, 97, 99–101
energy sublevels, 98–9
excited level decay rate, 98
Fabry–Perot cavity, 102–3, 102–4, 135
frequencies, wavelengths, 104, 133–4
heterojunction, 124–5, 124–6, 128
history, 93
homojunctions, 124, 124
longitudinal modes, 104, 104, 106–7
loss and gain profiles, FP laser, 104, 104
loss coefficient, 103, 106, 129, 135
loss effects, 101, 101–3, 106, 112, 135
monochromatic frequency radiation, 99
multi-longitudinal-mode, 104, 105
Nd–Yag laser, 274
non-radiative transition, 111
optical intensity evolution, 105–6, 106
oscillations, conditions for, 101–6, 101–7
oscillator components, 102, 102
output propagation, 1-dimensional wave
equation, 14–15
photon density growth rate, 111
photon lifetime, 112
population density, ground state, 111
population inversion, 98, 112–3
principles, 93–101, 94–7
pumps, 98, 111, 127
rate equations, 110–113, 126–8
rate equations steady-state solutions, 128–32,
130
round trip phase changes, 103–4
ruby laser, 108, 108, 274
semiconductor laser, 108
semiconductor laser diodes (See semiconductor
laser diodes)
semiconductor physics (See semiconductor
physics)
spontaneous emission, 100–101, 95, 95, 98
stimulated emission, 100–101, 94–5, 94–5, 98
wave–particle duality, 108–10
least mean squares (LMS) equalizers, 510,
510–513, 512–513
linear electro-optic effect (Pockels effect), 151
linear Schrödinger equation, 460
line coding, 139, 140
loss
fiber loss, single-mode fibers, 69–74, 70, 71
fiber loss-induced limitations generally, 301–6,
302–5
loss and gain profiles, FP laser, 104, 104
loss coefficient, lasers, 103, 106, 129, 135
loss effects, lasers, 101, 101–3, 106, 112, 135
mirror, 129, 131
Mach–Zehnder (MZ) interferometer modulators
alternate mark inversion, 169–72, 170–172
amplitude-shift keying, 144, 144, 158, 158–60,
160

Index
543
biasing, 171
channel spacing, 397–8
differential phase-shift keying, 146–9, 147–9,
162–3, 163
field envelope, 395, 397
frequency-shift keying (FSK), 145, 145–6, 163,
164
input power, 396–7
M-ASK, 172–4, 173–4
M-PSK, 174–82, 175–80
outputs, 395–6, 398
path-length difference, 396, 398
phase-shift keying (PSK), 144–5, 145–6,
160–162, 161–2
phase shifts, 396
power transmittances, 396, 396, 398
principles, 153, 153–6, 395–7, 395–8
propagation constant, 396
schematic, 395, 397
wavelengths, 397
MASER, 93
M-ASK, 172–4, 173–4, 180–181
Maurer, R., 35
Maxwell’s equations
current source, electron oscillation, 421–3
described, 9–10
dielectric medium propagation, 12
electrical field formation, 9–10
electromagnetic wave, 10–11
Faraday’s Law (See Faraday’s Law)
free-space propagation, 11–12
Gauss’s law, differential form of, 3, 4, 6
magnetic field formation, 9–10
nonlinear effects in fibers, 421–3
refractive index, 12
in source-free region, 10
wave equation, 11
mean
current, 323
effective noise, digital signal processing, 522
frequency, 308, 311
noise power, 254–5, 316, 323
noise power, ASE, 254–5
OOK systems, 310–313, 369, 465–6, 490–491
photocurrent, 301–3, 302–3
power, FWM, 452, 452–3
total, ASE, 256–8
transmission system design, 304–5, 307, 312–3,
320, 323
MESFET (metal–semiconductor field-effect
transistor), 205
modulators, modulation schemes
absorption coefficient, 157, 158
alternate mark inversion, 139, 140, 169–72,
170–172
amplitude modulation, 144, 144, 155, 157
amplitude-shift keying, 144, 144, 158, 158–60,
160
balanced driving (push–pull operation), 154–5
conservation of power, 154
d.c. extinction ratio, 156
differential coding, 147, 147–8
differential phase detection, 147
differential phase-shift keying, 146–9, 147–9,
162–3, 163
direct modulation, 149–50, 150
double sideband with suppressed
carrier(DSB-SC), 155
duty cycle, 140–141, 143
electroabsorption (EA) modulators, 157, 157–8
external modulators, 150–158, 151, 153, 157
field envelope, 161
frequency shift (frequency chirp), 154–5
frequency-shift keying (FKS), 145, 145–6, 163,
164
half-wave voltage (switching voltage), 152
line coding, 139, 140
local oscillator (LO), 147, 147
Mach–Zehnder (MZ) interferometer
modulators, 153, 153–6
multi-level signaling, 172–82, 173–80
non-return-to-zero (NRZ) (See
non-return-to-zero (NRZ))
output power, 154, 157, 159
partial response signals, 163–72, 164–71
phase modulation, 144–5, 145–6, 151, 151–3
phase-shift keying (PSK), 144–5, 145–6,
160–162, 161–2
Pockels effect (linear electro-optic effect), 151
polarity, 139, 140, 142–3, 143, 160, 182–3
power spectral density, 141–3, 143, 182–4
pulse shaping, 139–41, 140
radiation modes, 154
raised-cosine pulse, 183–4

544
Index
modulators, modulation schemes (continued)
return-to-zero (RZ), 139–41, 140, 142–3, 143,
158, 158–60, 160, 161–2
truth tables, 148, 148
unipolar signals, 139, 140, 142–3, 143, 182–3
waveforms, 148, 149
moment theorem, 291, 293
M-PSK, 174–8, 175–8
MSM-HEMT photoreceivers, 222–3, 223
MSM-PD (metal–semiconductor–metal
photodetector), 204–6, 205
multi-level signaling
amplitude and phase-shift keying (APSK),
178–82, 179–80
M-ASK, 172–4, 173–4, 180–181
M-PSK, 174–8, 175–8
principles, 172
quadrature amplitude modulation, 178–82,
179–80
multiplexing
arrayed-waveguide gratings, 398, 398–401
diffraction-based multi/demultiplexers, 398, 398
frequency-division multiplexing (FDM), 391
OFDM (See orthogonal frequency-division
multiplexing (OFDM))
polarization division multiplexing (PDM),
389–91, 390
time-division multiplexing (TDM), 409–10,
409–12
WDM (See wavelength-division multiplexing
(WDM) systems)
Nd–Yag laser, 274
nearly traveling-wave amplifier (NTWA), 269–70
Newton’s law, 420
noise
amplifier noise figure, 260, 260–262
ASE–ASE beat noise, 253, 256, 259, 261,
291–6, 292, 295, 323, 471
ASE noise, 304, 323
band-pass representation, 250, 250
equivalent noise figure, 317, 317–18
laser phase, 498–500, 500
low-pass representation, 249–51, 250–251
mean noise power, 254–5
optical signal-to-noise ratio (OSNR), 262–3,
317–8, 321–2
optimum binary receivers, 336, 339–40, 344
output, ASE, 251–6, 252, 259–61, 260, 289
phase noise, 471–8
photodetectors, 222–7, 225
shot (See shot noise)
signal–ASE beat noise, 253–6, 259, 288–90,
326
thermal (See thermal noise)
nonlinear effects in fibers
absorption, 423–4
amplification, 423–4
atoms per unit volume, 421–2, 422
channel spacing, 451, 451
chromatic dispersion, 423
complex field envelope, 426
constant of integration, 435
constant time shift, 426
cross-phase modulation (XPM) (See cross-phase
modulation (XPM))
current source, electron oscillation, 421–3
damping coefficient, 423
degenerate FWM, 452, 452
dipole moment, 421
dispersion coefficient (third-order), 449–50
electric flux density, 422–3
electron, net force acting on, 420
electron center motion, 420
electron oscillator model (classical), 419–23,
420, 422
energy dissipation, 423
fiber dispersion, 426–8
fiber dispersion/SPM combined effects, 433–4,
433–6, 436
field envelope, 487–9, 489
first-order susceptibility (linear susceptibility),
422
four-wave mixing (FWM) (See four-wave
mixing (FWM))
frequency, 425
frequency components, SPM, 430–434, 431–3
IFWM triplets, 464
instantaneous frequency, 428
instantaneous power, 428
interchannel effects generally, 437, 437–8
interchannel/intrachannel analogy, 457, 458
intrachannel, theory of, 457–63, 459

Index
545
intra-channel cross-phase modulation (IXPM),
419, 454, 455, 463–6, 477
intra-channel four-wave mixing (IFWM), 419,
454–7, 456–7, 463–6, 477
intrachannel impairments generally, 454
inverse scattering transform (IST), 434
Kerr coefficient, 426, 428
Kerr effect, 419, 426, 439, 481
Kronecker delta function, 464
linear Schrödinger equation, 460
Maxwell’s equations, 421–3
Newton’s law, 420
numerical simulation, NLSE, 466–8, 466–71
output field envelope, 427
peak nonlinear phase shift, 431–3
peak power, 432, 436
percentage pre-compensation ratio, 467–8, 468
perturbation theory, 459, 486
phase matching, 450, 483–4
phase mismatch, 449
phase noise, 471–8
plane wave (forward-propagating), 424
polarization, 422–5
propagation constant, 449
pseudo-linear system, 454
pulse separation, 439
refractive index, 423, 424, 426
relative permittivity, 423
restoration force, 420
self-phase modulation (SPM) (See self-phase
modulation (SPM))
soliton formation, 419, 433–6, 434–6
stimulated Raman scattering (SRS), 247,
478–83, 479
strongly pulse-overlapped system, 454
susceptibility, 424–6
variance calculations, 463–6, 490–491
WDM systems, 419, 437, 437–8
nonlinear Schrödinger equation
described, 428–9, 429
intrachannel nonlinear effects theory, 457–63,
458
numerical simulations, 466–8, 466–71
WDM systems, 437
non-return-to-zero (NRZ)
constellation diagrams, 509, 509
principles, 139–40, 140, 142–3, 143, 158,
158–60, 160
spectral efficiency, 392
spectral width, 76
nonzero dispersion-shifted fibers (NZ-DSFs), 75,
80
NTWA (nearly traveling-wave amplifier), 269–70
Nyquist filter (ideal), 308, 331
Nyquist pulse
partial response signals, 165–6, 166
WDM systems, 393
Nyquist sampling theorem, 471, 509
OFDM. See orthogonal frequency-division
multiplexing (OFDM)
1-dimensional wave equation
complex notation (analytic representation),
16–17
described, 12–15
laser output propagation, 14–15
light pulse propagation, 13–14
plane waves, 15–16
OOK systems
ASE noise, 319–22
asynchronous detection, 351, 359–64, 360, 364,
368
bit transmission, 362–3, 369–71
direct detection modulation scheme comparison,
379–81, 380
direct detection principles, 368, 368–71
dispersion-induced limitations, 313–15, 313–4,
466–7
error probability, 355–6, 362–4, 364, 370–371,
384–5
fiber loss-induced limitations generally, 301–6,
302–5
frequency components, 361–2
ISI in, 313–15, 314
Marcum Q-function, 364, 370
matched filter impulse response, 359
matched filter transfer function, 359, 368
mean and variance, 310–313, 369, 465–6,
490–491
modulation schemes comparison, 366–7, 367
noise component, 360–361
nonlinear Schrödinger equation, 428–9, 429,
437, 457–63, 458

546
Index
OOK systems (continued)
numerical simulation, NLSE, 467, 468
optical filter output, 368–9
output sample, 362
pdf component, 362, 369
power spectral density (PSD), 361
Q-factor, 308–9, 323–4, 332
Rician distribution, 362
scaling factor, 359, 360
signal output, 359–60, 360
spectral efficiency, 392
synchronous detection, 353–6
threshold, 362–3
threshold current, 369
total current at decision instant, 369
transmitted optical field envelope, 359
transmitter output power, 316, 326, 331–2
XPM (See cross-phase modulation (XPM))
optical amplifiers
ASE (See amplified spontaneous emission
(ASE))
dispersion-compensating fibers (DCFs) (See
dispersion-compensating fibers (DCFs))
erbium-doped fibers amplifier (EDFAs) (See
erbium-doped fibers amplifier (EDFAs))
field envelope, 247–50, 248, 250–251
historically, 247
mechanisms, 247
model, general, 247–8, 248
nearly traveling-wave amplifier (NTWA),
269–70
Raman amplifiers (See Raman amplifiers)
semiconductor optical amplifiers (SOAs) (See
semiconductor optical amplifiers (SOAs))
stimulated Raman scattering (SRS), 247,
478–83, 479
traveling-wave, 268–74, 269, 272
optical fiber transmission
acceptance angle, 38, 39
attenuation, 36
average power density, 50
bandwidth, 35–6
Bessel functions, 46–7, 47
bit rate–distance product, 41
carrier wavelength, 76–8
counter-clockwise modes, 46
cross-phase modulation (XPM), 75
cutoff wavelength, 68–9
differential delay, 74–5
Dirac delta function, 47–8, 83–4
dispersion in multi-mode fibers, 39–42, 40–41
dispersion parameter, 74–5
dispersion slope, 75–8, 77
effective index, 52–3
electromagnetic interference (EMI), 36
extrinsic absorption, 72
fiber dispersion, 74–5
fiber loss, 69–74, 70, 71
fiber nonlinearity, 60
fiber structure, 35–6, 36
fiber transfer function, 59
field distribution, 57–8, 69
field envelope, 58–70, 76–7, 83–4, 86–7,
487–9, 489
forward-propagating modes, 45–6, 52–3,
70–71
four-wave mixing (FWM) (See four-wave
mixing (FWM))
frequency, 48–50, 57–9, 75
frustrated total internal reflection, 36, 36–7
Gaussian pulse, 65–7, 65–7, 86–9, 87–8
graded-index multi-mode fibers, 42–4, 43
guided modes, 46–51, 47, 49–50, 54
guided modes, excitation, 55–6
Helmholtz equation, 45
history, 35
intermodal dispersion, 39, 40, 41, 56
intervals, 40–41, 40–41
intramodal dispersion, 57
intrinsic absorption, 72
linearly polarized (LP) modes, 44–5, 45
linear phase shift, 59
LPmn mode, 49–50
material absorption, 71–4
mode cutoff, 49, 51–2
mode-division multiplexing, 68
multi-mode fibers, 39, 39, 57, 68
non-return-to-zero (NRZ) signal (See
non-return-to-zero (NRZ))
nonzero dispersion-shifted fibers (NZ-DSFs),
75, 80
numerical aperture, 37–8, 37–9, 81–2
optical field distribution, 59–60, 60
optical intensity, 51, 51–3

Index
547
optical power, dBm units, 61
parabolic index profile, 43, 43, 44
phase speed, 53
polarization mode dispersion, 78–9
power/dBm unit relationships, 60, 62–7, 60–67,
83
power reflection coefficient, 37, 37
propagation constants, 48–50, 49, 54, 57–60,
60, 75, 82
pulse broadening, 39, 40, 57
pulse compression, 86, 87
radiation modes, 46, 54–5, 55
Rayleigh scattering, 70, 71, 70–71
ray-optics theory, 39
ray propagation in fibers, 36–43, 36–44
rectangular pulse, 62–4, 62–4
refractive index difference, 38–9
refractive index profile, 35, 36
single-mode fibers (See single-mode fibers)
spot size, 79
step-index fiber, 35, 43–4
step-index fiber modes, 44–57, 45, 47, 49–53,
55, 57
Taylor expansion, 76
Taylor series, 58–9
total internal reflection, 38, 38, 39, 40
total power calculation, 50–51, 51–3, 60–61
triangular index profile, 43
2-dimensional planar waveguide analogy, 53–4
universal curve, 49
zero dispersion wavelength, 75
optical receivers. See photodetectors
optical signal-to-noise ratio (OSNR), 262–3,
317–18, 321–2
optical time-division multiplexing (OTDM),
409–10, 409–12
optimum binary receivers
additive white Gaussian noise (AWGN) channel,
335
arbitrary receiver filter error probability, 345
bit error rate (BER), 337–9, 339, 344
bit transmission, 336–7, 337
complementary error function, 338–9
conditional pdf, 336–7, 337
correlation receivers, 342, 342–4
filters, 335–6, 339–40
generalized model, 335–41, 336–7, 339, 341
impulse response, matched filter, 341
matched filter, 340–341, 341
matched filter realization, 342–3, 342–4
noise variance, 336, 339–40, 344
optimum threshold, 338, 341, 344
Parseval’s relations, 340
power spectral density, 335, 342
pulse energy, 344–5
received signal, 336
signal component, 336
time-shifting property, 344–5
transfer function, 339, 339–41, 341
orthogonal frequency-division multiplexing
(OFDM)
bandwidth, 403, 414–5
block diagram, 404
carrier frequencies, 403–4
cyclic prefix, 405–6
DFT, 404
digital-to-analog converter (DAC), 406, 406–7
dispersion, 404–5, 405
experiments, 408–9
frequency separation, 403
IDFT, 404
IQ modulator, 406–7, 407
ISI in, 402
Mach–Zehnder modulator, 407, 407
polarization, 414–15
principles, 402, 402–6, 405–6
QAM-16, 406
receiver, 407–8, 408
signal power, 414–415
spectral efficiency, 414–5
subcarriers, 405, 405–6, 413–5
transmitter, 406, 406–7
orthogonal FSK, 358–9
orthonormal functions, 472
Parseval’s relations
FSK systems, 372
homodyne receivers, 348, 386
optimum binary receivers, 340
WDM systems, 394
Parseval’s theorem, 289
partial response signals
alternate mark inversion, 169–72, 170–172
correlative coding, 164

548
Index
partial response signals (continued)
delay-and-add filter, 163–4, 164, 168
duobinary encoding, 164–5, 165–6, 184–5
duobinary encoding scheme, 167–8, 168
duobinary signal generation, 168–9, 169–70
duobinary signal notation, 166–7
Nyquist pulse, 165–6, 166
output, 168
partial response scheme, 164
principles, 163–9, 164–9
pulse, pulse bandwidth, 167–8, 167–8
transfer functions, 167, 168
voltage, 164–5
percentage pre-compensation ratio, 467–8, 468
performance analysis
heterodyne receivers (See heterodyne receivers)
homodyne receivers, 345–9, 346
optimization, 335
optimum binary receivers (See optimum binary
receivers)
perturbation theory, 459, 486
phased-array demultiplexers, 398, 398–401
phase estimation and compensation, 503–6, 504,
506
phase modulation, 144–5, 145–6, 151, 151–3
phase noise
Gordon–Mollenauer, 474–6
laser, 498
linear, 471–3
matched filters, 473
Nyquist sampling theorem, 471
orthogonality, 472, 473
orthonormal functions, 472
terminology, 471
variance, 477–8
phase-shift keying (PSK)
differential, 146–9, 147–9, 162–3, 163
direct detection modulation scheme comparison,
379–81, 380
error probability, 385–6
heterodyne receivers, 351–3, 355–6
homodyne receivers, 347–8, 385–7
M-PSK, 174–8, 175–8
MZ interferometer modulators, 144–5, 145–6,
160–162, 161–2
nonlinear Schrödinger equation, 428–9, 429,
437, 457–63, 458
principles, 144–5, 145–6, 160–162, 161–2
synchronous detection, 351–3
transmission system design, 310, 312, 330–331
variance calculations, 463–6
phase unwrapping, 505–6, 506
phase velocity, 26–31, 27
photodetectors
absorption, generation, 193
absorption coefficient/wavelength relationship,
190, 191, 194, 217, 218
absorption layer thickness, 200
active region, 202
amplification, 193
APD-HEMT photoreceivers, 224
avalanche multiplication, 209, 209–12, 212
avalanche photodetectors (APDs), 207–12,
208–9, 212
bandwidth, 213–15
Baraff’s expression, 208
capacitance, 206
classification, types, 189, 191, 192, 202
coherent receivers (See coherent receivers)
components, design, 189, 190
constructive resonance, 215
cutoff wavelengths, 191, 192, 198
dark current, 200
depletion region, 194, 195
design rules, 199–200
DHBT configurations, 222
diffusion of minority carriers, 200
diffusion time effect, 201
direct detection receivers, 219–24, 220–223
direct (incoherent) detection, 189
distributed Bragg reflectors (DBRs), 212,
214
doping concentration, 201
Fabry–Perot resonator, 214–18, 218
finesse in resonators, 216
gallium arsenide, 192, 192–3, 197
generation–recombination current, 200
germanium, 191, 192, 192
heterojunction phototransistor (HPT), 207
impact ionization phenomenon, 207–8, 208
incident light transmissivity, 214–215
indirect (coherent) detection, 189, 191, 192
indium gallium arsenide, 192, 193, 203, 203–4,
211–212

Index
549
indium gallium arsenide phosphide, 192, 193,
203, 203–4, 211–212
linearity, 202, 202
maximum quantum efficiency expression,
217
metal–semiconductor field-effect transistor
(MESFET), 205
metal–semiconductor–metal photodetector
(MSM-PD), 204–6, 205
MSM-HEMT photoreceivers, 222–3, 223
noise, 222–7, 225
optical receiver ICs, 219–24, 220–223
oxide layer content, 218–219, 219
performance characteristics generally, 190–193,
190–193
photoconductive detector, 206
photocurrent, factors contributing to, 194–5, 195
photon absorption, 190–192, 190–192
photon absorption rate, 196, 197
photon incidence rate, 194, 196
photon rate (photon flux), 194
phototransistors, 206–7, 207
pin-HBT photoreceivers, 221–2, 222
pin-HEMT photoreceivers, 221, 221
pin photodiode, 201, 201–4, 203
pn photodiode, 194–9, 195, 197, 203
power spectral density, 225–6
quantum efficiency, 193–8, 195, 197, 212–3,
216–7
RC time constant, 201
refractive index, 199–200
resonant cavity-enhanced (RCE) structures,
212–19, 215, 218–9
resonant frequency, Fabry–Perot cavity, 214
responsivity (photoresponse, sensitivity), 198,
197–9, 214–5
SAGCM APD, 211, 213
SAM APD, 211, 212
Schottky barrier photodiode, 204, 204
semiconductor processes, 193
semiconductors used in, 191–3, 192
shot noise, 224–6, 225
signal-to-noise ratio (SNR), 227
silicon, 191, 192, 192, 197
speed (response time), 201, 201–2
surface leakage, 200
temperature dependence, 208–9
thermal noise (Johnson noise), 226
transmitted power, 195–6
transport, 193
wavelengths, 190, 191, 194, 197–200, 217–9,
218–9
pin-HBT photoreceivers, 221–2, 222
pin-HEMT photoreceivers, 221, 221
pin photodiode, 201, 201–4, 203
Planck, Max, 96, 97
Planck’s constant, 190
Planck’s law, 96
pn photodiode, 194–9, 195, 197, 203
Pockels effect (linear electro-optic effect), 151
polarization
ASE, 248
coherent receivers, 239–42, 240
dual, ASE, 258–9, 262
of light, 31
mode dispersion, optical fiber transmission,
78–9
mode dispersion, single-mode fibers, 78–9
nonlinear effects, 422–5
single, ASE, 251–2, 252
polarization division multiplexing (PDM), 389–91,
390
polarization mode dispersion equalization, 513–6,
514–6, 523–4
power flow, 17, 17–19
power spectral density
ASE, 254–5, 261
DPSK systems, 379
homodyne receivers, 346, 347
modulators, modulation schemes, 141–3, 143,
182–4
optimum binary receivers, 335, 342
photodetectors, 225–6
power spectral density (PSD)
ASE, 249–52, 251–2, 289, 296, 316–9, 319,
471, 478
cross-phase modulation (XPM), 447–8,
448
heterodyne receivers, 350, 355, 361, 382–4
OOK systems, 361
transmission system design, 304, 308, 316–9,
319, 325
poynting vector, 17, 17–19
prism, light propagation, 29, 29

550
Index
propagation constants, 48–50, 49, 54, 57–60, 60,
75, 82
pulse shaping, 139–41, 140
QAM-16 systems, 392, 406
QAM-64 systems, 392–3, 414–5
Q-factor, 303, 308–309, 311–3, 320–332
Q-PSK, 174–82, 175–80, 509, 509
quadrature amplitude modulation, 178–82, 179–80
raised-cosine pulse, 183–4
Raman amplifiers
anti-Stokes Raman scattering, 479
backward-pumping scheme, 286–7
counter-propagating pump, 283, 283
decay, 284, 286
gain spectrum, 282, 283, 284–7, 285–6
governing equations, 283–7, 285–6
Kerr effect, 481
noise, 282, 287
nonlinear Schrodinger equation, 482
principles, 282–3, 282–3
Rayleigh back scattering, 287, 287–8
schematic, 283
signal, pump powers evolution, 283–4
spontaneous Raman scattering (SRS), 282
stimulated Raman scattering (SRS), 247,
478–83, 479
Stokes’s shift, 282, 479
time domain description, 481–3
rate equations
EDFAs, 275–80, 279
lasers, 110–113, 126–8
steady-state solutions, 128–32, 130
Rayleigh back scattering, 287, 287–8
Rayleigh scattering, 70, 71, 70–71
RCE structures, 212–19, 215, 218–9
rectangular pulse, 62–4, 62–4
reflection, 21–6
refraction, 21–6
resonant cavity-enhanced (RCE) structures,
212–19, 215, 218–9
Rician distribution, 362, 366
ruby laser, 108, 108, 274
SAGCM APD, 211, 213
SAM APD, 211, 212
Schottky barrier photodiode, 204, 204
Schrödinger equation (linear), 460
Schrödinger equation (nonlinear). See nonlinear
Schrödinger equation
Schultz, P., 35
self-phase modulation (SPM)
fiber dispersion/SPM combined effects, 433–4,
433–6, 436
frequency components, 430–434, 431–3
peak nonlinear phase shift, 431–3
peak power, 432, 436
phase noise, 477
principles, 419, 430–436, 431–4, 436, 438–9
soliton formation, 419, 433–6, 434–6
variance calculations, 463–6
semiconductor laser, 108
semiconductor laser diodes
active regions, 124, 125, 127, 128
active volume, 131
distributed-feedback lasers, 132–3
electron lifetime, 128–32
energy density, 126–30, 130
gain coefficient, 127–8
heterojunction lasers, 124–5, 124–6, 128
laser rate equations, 126–8
mirror loss, 129, 131
optical gain coefficient, 135
optical intensity, 130
photon lifetime, 128–32
principles, 124
radiative, non-radiative recombination, 126
rate equations steady-state solutions, 128–32,
130
stimulated emission, 129
threshold current, 129, 131
semiconductor optical amplifiers (SOAs)
acquired phase, 270
AR coating, 270–271
bandwidth, 266–7, 266–8
carrier lifetime, 281
cavity-type (Fabry–Perot), 264, 264–8, 266–7,
273, 296–8
EDFA vs., 281
free spectral range (FSR), 266
full-width at half-maximum (FWHM), 267
gain, 266–7, 266–8
gain coefficient, 281

Index
551
gain saturation, 271–4, 272
half-width at half-maximum (HWHM), 266
input signal power, 272, 272
interchannel cross-talk, 281
nearly traveling-wave amplifier (NTWA),
269–70
optical signal output, 264, 264
polarization-dependent gain (PDG), 281
principles, 247, 263
total field output, 265
traveling-wave amplifiers, 268–74, 269,
272
types, 263
semiconductor physics
acceptors, 117
band gap Eg, 114, 114, 134–5
conduction band, 113–14, 114, 134–5
contact potential, 119
depletion region, 118, 119
direct, indirect band-gap semiconductors,
120–124, 121–2, 134–5
donors, 117
doping, 116
effective mass, 116
electron energy states, 115–17, 116
electron movement, 114–15, 114–15
energy band structure, 114, 114
Fermi–Dirac function, 116, 117
forward-biased diode, 119–20, 120, 128
holes, 114, 114–5
intrinsic semiconductors, 116–17, 117
n-type semiconductors, 117, 118–19
periodic Coulomb potential, 114–15, 115
PN junction (diode), 118–20, 119–20
PN junction spontaneous/stimulated emission,
120
principles, 113–18, 113–18
p-type semiconductors, 117, 118–19
reverse-biased diode, 119, 119
silicon bonding, 113, 113–14
valence band, 114, 114, 134–5
wavenumbers, 115–16, 116
shot noise
ASE, 261
heterodyne receivers, 352–3
homodyne receivers, 346
photodetectors, 224–6, 225
transmission system design, 301–2, 307–9, 320,
323
signal–ASE beat noise, 253–6, 259, 288–90, 326
signal-to-noise ratio (SNR)
ASE, 260, 261, 296
optical SNR, 317–18, 321–2
photodetectors, 227
silicon photodetectors, 191, 192, 192, 197
single-mode fibers
carrier wavelength, 76–8
cross-phase modulation (XPM), 75
cutoff wavelength, 68–9
design considerations, 68–79, 70, 71, 77
differential delay, 74–5
dispersion-compensating fibers (DCFs) (See
dispersion-compensating fibers (DCFs))
dispersion parameter, 74–5
dispersion slope, 75–8, 77
extrinsic absorption, 72
fiber dispersion, 74–5
fiber loss, 69–74, 70, 71
fiber nonlinearity, 60
fiber transfer function, 59
field distribution, 57–8, 69
field envelope, 58–70, 76–7, 83–4, 86–7
forward-propagating modes, 45–6, 52–3,
70–71
four-wave mixing (FWM), 75
frequency, 48–50, 57–9, 75
Gaussian pulse, 65–7, 65–7, 86–9, 87–8
generally, 39, 39, 49, 56, 68
intramodal dispersion, 57
intrinsic absorption, 72
linear phase shift, 59
material absorption, 71–4
mode-division multiplexing, 68
non-return-to-zero (NRZ) signal (See
non-return-to-zero (NRZ))
nonzero dispersion-shifted fibers (NZ-DSFs),
75, 80
optical field distribution, 59–60, 60
polarization mode dispersion, 78–9
power/dBm unit relationships, 60, 62–7, 60–67,
83
propagation constants, 48–50, 49, 54, 57–60,
60, 75, 82
pulse propagation, 57, 57–67, 60, 62–7

552
Index
single-mode fibers (continued)
Rayleigh scattering, 70, 71, 70–71
rectangular pulse, 62–4, 62–4
spot size, 79
step-index fiber modes, 44–57, 45, 47, 49–53,
55, 57
Taylor expansion, 76
Taylor series, 58–9
total power calculation, 50–51, 51–3, 60–61
zero dispersion wavelength, 75
Snell’s law, 24, 26
soliton formation, 419, 433–6, 434–6
Standard Telecommunications, 35
stimulated Raman scattering (SRS), 247, 478–83,
479
Stokes’s theorem, 7, 9
switching voltage (half-wave voltage), 152
thermal noise
homodyne receivers, 346
photodetectors, 226
transmission system design, 301–2, 308, 309,
320, 323
3-dimensional wave equation
critical angle, 24
described, 19–21
frequency, 20
laser output, 26
reflection, 21–6
refraction, 21–6
refractive index, 25
Snell’s law, 24, 26
total internal reflection (TIR), 24
wavelength, 20, 25
wavenumber, 20, 25
wave vector magnitude, 26
wave vector x-component, z-component, 26
time-division multiplexing (TDM), 409–10,
409–12
transmission system design
amplifier spacing impact, 318–19, 319, 323,
326–7, 326–7
ASE-induced limitations generally, 315–17, 316
ASE noise, 304, 323
balanced coherent receiver, 306, 306–13,
309–11
bandwidth, 323–4
bit error rate (BER), 303–305, 304–305,
308–313, 309–311, 320, 320–321, 324,
324–5
coherent receivers, 322–5, 324
direct detection receivers, 316, 319–22, 320,
326–7, 326–7, 331–3
dispersion-induced limitations, 313–14,
313–15, 466–7
equivalent noise figure, 317, 317–18
eye diagrams, 302, 303, 326–7
fiber loss-induced limitations generally, 301–6,
302–5
fullf-width at half-maximum (FWHM), 314
gain, 326
in-line amplifiers, 316–17
mean and variance, 304–5, 307, 312–13, 320,
323
mean current, 323
mean frequency, 308, 311
mean noise power, 316, 323
mean photocurrent, 301–3, 302–3
nonlinear Schrödinger equation, 428–9, 429,
437, 457–63, 458
numerical simulation, NLSE, 466–8, 466–71
Nyquist filter (ideal), 308, 331
optical signal-to-noise ratio, 317–18, 321–2
optimum configuration, 329–30
peak power, 311–13
phase noise, 471–8
phase-shift keying (PSK), 310, 312, 330–331
power penalty, 320
power spectral density (PSD), 304, 308, 316–9,
319, 325
Q-factor, 303, 308–309, 311–13, 320–332
received photons per bit, 308–9
receiver current/time relationship, 302, 302
relative intensity noise (RIN), 306–7
responsivity, 311, 320, 324
shot noise, 301–2, 307–9, 320, 323
signal photon-to-noise photon ratio, 325
spontaneous beat noise, 320–321, 323
thermal noise, 301–2, 308, 309, 320, 323
transmission distance, 305–6, 308–9, 313–15,
314–15, 325, 331–3
traveling-wave amplifiers, 268–74, 269, 272
2-dimensional planar waveguide analogy,
53–4

Index
553
unipolar signals, 139, 140, 142–3, 143, 182–3
variance
ASE, 256–8
FSK systems, 373
nonlinear effects, 463–6, 490–491
OOK systems, 310–313, 369, 465–6, 490–491
optimum binary receivers, 336, 339–40, 344
phase noise, 477–8
transmission system design, 304–5, 307, 312–3,
320, 323
wave equation, 11
wavelength-division multiplexing (WDM) systems
arrayed-waveguide gratings, 398, 398–401
bandwidth, 392–3
channel spacing, 391–3
components, 394–401, 395–400
data rate (total), 392–3, 413
diffraction-based multi/demultiplexers, 398, 398
dispersion coefficient (third-order), 449–50
energy (total), 393–4
experiments, 401–2
fiber dispersion, 75
four-wave mixing (FWM) (See four-wave
mixing (FWM))
frequency, 392
gain coefficient, 281
gain spectrum, 285
impairments, 445
interchannel cross-talk, 281
multiplexer/demultiplexer, 394–5, 395
MZ interferometers (See Mach–Zehnder (MZ)
interferometer modulators)
nonlinear effects, 419, 437, 437–8
nonlinear Schrödinger equation (See nonlinear
Schrödinger equation)
Nyquist pulse, 393
Parseval’s relation, 394
phase matching, 450, 483–4
phase noise, 477
principles, 391–2, 391–4
schematic, 391
spectral efficiency, 391–3, 413
spectrum, 392
XPM (See cross-phase modulation (XPM))
wave–particle duality, 108–10
WDM. See wavelength-division multiplexing
(WDM) systems
XPM. See cross-phase modulation (XPM)

