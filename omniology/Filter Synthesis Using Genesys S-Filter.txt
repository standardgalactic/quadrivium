Randall W. Rhea

Filter Synthesis Using Genesys S/Filter

For a complete listing of titles in the 
Artech House Microwave Library
turn to the back of this book.

Filter Synthesis Using Genesys S/Filter
Randall W. Rhea

Library of Congress Cataloging-in-Publication Data
A catalog record for this book is available from the U.S. Library of Congress.
British Library Cataloguing in Publication Data
A catalogue record for this book is available from the British Library.
Cover design by Vicki Kane
ISBN 13: 978-1-60807-802-8
© 2014 ARTECH HOUSE
685 Canton Street
Norwood, MA 02062
Cover image © Agilent Technologies, Inc. 2013–2014.
All rights reserved. Printed and bound in the United States of America. No part of this book 
may be reproduced or utilized in any form or by any means, electronic or mechanical, including 
photocopying, recording, or by any information storage and retrieval system, without permission 
in writing from the publisher.
 All terms mentioned in this book that are known to be trademarks or service marks have been 
appropriately capitalized. Artech House cannot attest to the accuracy of this information. Use of 
a term in this book should not be regarded as affecting the validity of any trademark or service 
mark.
10 9 8 7 6 5 4 3 2 1

 
To Marilynn: 
 
As just a boy, I made my choice, 
I now look back, and proudly smile. 
With wind in face, or at our backs, 
hand in hand, we trod our paths, 
some a thousand, some a mile. 
Youthful dreams, some wise some poor, 
but oh so sweet, the ones we store. 
For Hera’, only change endures, 
not so we say, tis love evermore,  
hand in hand, tis love evermore. 

 

 
 
Contents 
Preface 
xiii 
References 
xiv 
1 Transmission Zeros 
1 
1.1 Determining TZ by Inspection 
1 
1.2 Filter Degree 
4 
1.3 Canonical Realization 
4 
1.4 Influence of TZs on the Response 
4 
References 
6 
2 All-Pole Lowpass and Highpass 
7 
2.1 Initial All-Pole Lowpass Parameters 
7 
2.2 Dual Topologies 
9 
2.3 Chebyshev Approximation with Even Order 
10 
2.4 All-Pole Highpass Example 
11 
References 
12 
3 Lowpass with Finite Zeros 
13 
3.1 Introduction 
13 
3.2 Alternative Topologies 
15 
4 Conventional Bandpass 
17 
4.1 Bandpass Transform 
17 
4.2 Classification Symmetry or Antimetry 
17 
4.3 A 75- to 125-MHz Bandpass 
18 
4.4 A 96- to 104-MHz Bandpass Filter 
19 
4.5 Comparative Analysis of the Wide and Narrow Filters 
19 
Reference 
21 
5 Extraction Sequences 
23 
5.1 The Extraction Tab 
23 
Reference 
27 
6 Customized Bandpass Filters 
29 
6.1 Custom Filter Specification 
29 
6.2 Partial Extractions of FTZs 
33 
6.3 Inexact Extractions 
34 
6.4 Inexact Example 
34 
7 Norton Transforms 
39 
7.1 Norton Series Transform 
39 
7.2 Removing a Transformer with the Series Norton 
40 

viii 
Filter Synthesis Using Genesys S/Filter 
7.3 Norton Shunt Transform 
43 
7.4 Equal-Valued Inductor Bandpass 
44 
7.5 The History Tab 
45 
7.6 Equate All Ls 
46 
8 Bandpass with Resonators 
47 
8.1 Coupled Parallel-Resonator Filters 
47 
8.1.1 Exact Design of a Parallel Resonator All-Pole Filter 
49 
8.1.2 Termination Coupling Transforms 
51 
8.1.3 Find Dual Transform 
53 
8.1.4 Exact Design with Like Coupling Elements 
55 
8.1.5 The Equate All Shunt Ls or Shorted Stubs Transform 56 
8.1.6 Termination-Coupled Bandpass 
57 
8.2 Coupled Series-Resonator Filters 
58 
8.2.1 The Basic Series-Resonator Bandpass 
58 
8.2.2 Tubular Bandpass 
59 
8.2.3 Manufacture of the Tubular Bandpass 
61 
8.2.4 Generalized Series-Resonator Bandpass 
61 
8.2.5 Tunable Constant-Bandwidth Bandpass 
63 
Reference 
67 
9 TEM-Mode Resonators 
69 
9.1 Filter Insertion Loss 
69 
9.2 Filter Using 50-Ohm Coaxial Resonators 
70 
9.2.1 Lumped to Distributed Equivalents 
70 
9.2.2 The Convert Using Advanced Tline Routine 
72 
9.3 Generalized Bandpass Using Ceramic Resonators 
74 
9.3.1 Creating Parallel Resonators 
75 
9.3.2 Shifting the Internal Impedance Level 
76 
9.3.3 The Pi to Tee Transform: Increasing Coupling Caps 
77 
9.3.4 Converting the Parallel L-C to Coaxial Resonators 
77 
9.3.5 Optimizing the Values 
77 
9.4 Ceramic Bandpass with Two FTZs 
78 
References 
81 
10 Piezoelectric Devices 
83 
10.1 Quartz-Crystal Device Model 
83 
10.1.1 Physical Form of the Quartz Crystal 
83 
10.1.2 Insertion Response of a Quartz Crystal 
84 
10.1.3 Modeling the Quartz Crystal 
84 
10.1.4 Calculating Model Parameters from the Response 
85 
10.1.5 The Quartz-Crystal Model and Filter Design 
86 
10.2 Quartz-Crystal Filter Approximate Design 
86 
10.3 Nulling the Static Capacitance 
90 
10.4 Design of a Lower-Sideband Crystal Filter 
91 
10.5 Upper-Sideband Quartz-Crystal Filter 
97 
10.6 Filters with TZs Above and Below the Passband 
103 

Contents 
ix 
10.7 Wide-Bandwidth Quartz-Crystal Filters 
107 
10.8 Very Wide-Bandwidth Quartz-Crystal Filters 
108 
10.9 Ceramic-Piezoelectric Resonators 
111 
Reference 
113 
11 Symmetry 
115 
11.1 Physical Symmetry 
115 
11.1.1 A Lowpass Filter with FTZ Pairings 
115 
11.1.2 A Bandpass Filter with FTZ Pairings 
117 
11.2 Response Symmetry 
119 
11.2.1 All-Pole Symmetric Response Filters 
120 
11.2.2 Generalized Bandpass with Symmetric Response 120 
11.2.3 Symmetry by FTZ Placement 
123 
11.3 Group-Delay Equalization 
124 
References 
127 
12 Matching with S/Filter 
129 
12.1 Matching Concepts 
129 
12.1.1 Complex Conjugate Match 
130 
12.1.2 Two-Element Matching Networks 
130 
12.2 Real Terminations 
132 
12.2.1 Exploiting Extraction Sequences 
132 
12.2.2 Exploiting Resonator Filters 
138 
12.3 Complex Terminations 
139 
12.3.1 Fano’s Limit 
139 
12.3.2 Example: Power Amplifier Match 
140 
12.3.3 Example: Broadband Antenna Match 
142 
References 
144 
13 Distributed Filters 
145 
13.1 Comparing Distributed and Lumped Filters 
145 
13.2 The Genesys Microwave Filter Module 
146 
13.3 Distributed Synthesis Concepts 
149 
13.3.1 TLEs 
149 
13.3.2 Richards Transform 
150 
13.3.3 Kuroda Identities 
152 
13.3.4 Ikeno Transforms 
155 
13.3.5 Kuroda-Minnis Transform 
157 
13.3.6 Half-Angle Transform 
159 
13.3.7 Interdigital Transform 
161 
13.3.8 Combline Transform 
161 
13.4 Lumped to Distributed Equivalent Transforms 
162 
13.5 Inverters 
164 
13.6 The Convert Using Advanced TLine Routine 
165 
13.7 Box Modes 
166 
13.8 Introduction to Distributed Filter Examples 
166 
References 
167 

x 
Filter Synthesis Using Genesys S/Filter 
14 Distributed Lowpass Filters 
169 
14.1 Exact Methods 
169 
14.1.1 Lowpass with Redundant UEs 
169 
14.1.2 Stub TLEs and Contributing Unit Elements 
175 
14.1.3 Lowpass with Only Contributing UEs (Stepped-Z) 
176 
14.1.4 Generalized Lowpass Filter 
179 
14.2 Approximate Methods 
180 
14.2.1 All-Pole: Equivalent Series TLE and Shorted Stubs 182 
14.2.2 Stepped Impedance Lowpass 
183 
14.2.3 Generalized Lowpass 
187 
14.3 Size Reduction by Penetration 
190 
14.4 Radial Stub Lowpass 
192 
14.5 Hybrid Lowpass 
194 
14.6 Distributed Lowpass Summary 
196 
Reference 
198 
15 Distributed Bandstop Filters 
199 
15.1 All-Pole with Stubs and Contributing UEs 
199 
15.1.1 Wide Bandwidth Bandstop 
199 
15.1.2 Moderate Bandwidth Bandstop 
202 
15.1.3 Narrow Bandstop with Ikeno Transforms 
204 
15.2 Generalized Narrowband Bandstop 
205 
16 Distributed Bandpass Filters 
211 
16.1 Tutorials of Bandpass by Synthesis 
211 
16.1.1 Edge-Coupled Using Richards Transform 
211 
16.1.2 Edge-Coupled Using Inverters 
216 
16.1.3 Interdigital Using Inverters 
218 
16.2 Unique Bandpass Designs 
224 
16.2.1 Combline with Capacitive External Coupling 
224 
16.2.2 Miniature Bandpass with Contributing UEs 
228 
16.2.3 Narrow Bandwidth with UEs and an FTZ 
233 
16.2.4 Penetrating Combline 
238 
16.2.5 Minnis Class-D Bandpass 
245 
16.3 Hybrid Bandpass 
248 
16.3.1 Penetrating Combline with Capacitors 
248 
16.3.2 Generalized Combline Hybrid 
249 
16.3.3 Direct-Coupled Bandpass with Capacitors 
252 
References 
258 
17 Distributed Highpass Filters 
259 
17.1 The Hybrid Highpass 
259 
17.1.1 The All-Pole Hybrid: Distributed Synthesis 
259 
17.1.2 The All-Pole Hybrid Highpass: Lumped Synthesis 
261 
17.1.3 The Hybrid Highpass with UEs 
263 
17.1.4 The Hybrid Highpass with an FTZ 
266 
17.2 Purely Distributed Highpass 
268 

Contents 
xi 
17.2.1 Highpass with Three TZs at DC and a UE 
268 
17.2.2 Highpass with Three TZs at DC and Four UEs 
270 
17.3 The Highpass Synthesized as a Bandpass 
272 
17.3.1 Hybrid Highpass from an Eighth-Degree Bandpass 272 
17.3.2 Hybrid Highpass from a 10th-Degree Bandpass 
275 
18 Multiplexers 
277 
18.1 Contiguous Multiplexers 
277 
18.1.1 Contiguous Lowpass-Highpass Diplexer 
277 
18.1.2 Contiguous LP/BP/HP Multiplexer 
279 
18.2 Noncontiguous Multiplexers 
281 
18.2.1 Noncontiguous LP/HP Diplexer with FTZ 
281 
18.2.2 Noncontiguous Distributed Combline Diplexer 
284 
Reference 
287 
19 Electromagnetic Simulation 
289 
19.1 Overview 
289 
19.1.1 The EMPower Program 
290 
19.1.2 The Momentum Program 
291 
19.1.3 The EMPro Program 
292 
19.2 Box Modes 
292 
19.3 EM Simulation of Distributed Circuits 
295 
19.3.1 EM Simulation of Penetrating Stepped-Z Lowpass 295 
19.3.2 EM Simulation of a Combline Bandpass 
298 
19.3.3 EM Simulation of a Direct-Coupled Bandpass 
300 
19.4 Classic Method of Bandpass Design 
302 
19.4.1 Classic Method Fundamentals 
302 
19.4.2 Example: Determining K Values 
304 
19.4.3 Example: Determining Q Values 
307 
19.4.4 Filter Example Using the Classic Method 
307 
References 
310 
Appendix A: Example Summary 
313 
A.1 Lumped Examples 
313 
A.2 Distributed Examples 
315 
A.3 Hybrid Examples 
316 
A.4 Multiplexer Examples 
317 
Constants, Symbols, and Initialisms 
319 
About the Author 
323 
Index 
325 
 

 
 

 
xiii 
 
Preface 
Filter Synthesis Using Genesys S/Filter covers the design of practical 
lumped element, distributed, and resonator based filters from the 
perspective of transmission zeros. While this book is of some interest to all 
filter designers, it is written for users of the synthesis program Genesys 
S/Filter from the Agilent EEsof EDA division of Agilent Technologies. 
In the 1920s, filters were designed by cascading k-type sections with 
attenuation poles (transmission zeros) at infinite frequencies and m-type 
sections with additional transmission zeros at finite frequencies. This 
method was mathematically economic and suitable for the calculation tools 
then available, but the filter impedances and responses were only 
approximate. In the 1930s, theories of network synthesis evolved that 
produced exact designs with polynomial approximations to the ideal zonal 
(brick wall) response filter. By the 1950s, solutions to these more 
mathematically involved methods were found and tabulated. These tables 
only required simple impedance and frequency scaling to produce efficient 
lowpass and highpass filters, and simple transformations for bandpass and 
bandstop filters. This became known as the modern method and today it is 
still the common filter design technique. A reference to this method for RF 
and microwave applications is the venerable Microwave Filters, 
Impedance-Matching Networks, and Coupling Structures [1]. The 
popularization of the digital computer resulted in a plethora of software 
programs, most of which employ the modern method. 
The modern method which is based on only a subset of topologies 
available from general network synthesis does not necessarily result in the 
most efficient filter. Orchard and Temes solved certain synthesis problems 
caused by the precision of digital computers [2], and Szentirmai is a 
pioneer in the development of commercial software for the direct synthesis 
of filters [3]. Filter synthesis is a beautiful example of applied mathematics, 
arguably one of the better examples in engineering. However, this book is 
not about synthesis theory. This subject is treated in depth by [4],[5]. Note 
that this book is not a treatment of modeling, tuning, standard values, 
tolerance, or Q of elements and their effects on filter performance. Those 
topics are covered in depth in my other works [6],[7]. 
The focus of the book is common filter design problems and how to use 
direct synthesis to solve those problems. The emphasis is not on the 
S/Filter user environment. The software documentation provides that 
information. Rather, this book covers the application of S/Filter features to 
solving important and common filter problems. S/Filter’s strength is the 
incorporation of features that help simplify the powerful, but confusing-to-
the-novice, process of direct filter synthesis. S/Filter includes tools beyond 

xiv 
Filter Synthesis Using Genesys S/Filter 
direct synthesis, including a wide variety of both exact and approximate 
equivalent network transforms, methods for selecting the most desirable 
structure out of potentially thousands of synthesized alternatives, and a 
transform history record that simplifies design attempts requiring iteration. 
Very few software programs are based on direct synthesis, and the 
additional features of S/Filter make it a uniquely effective tool for filter 
design. The book assumes the reader is familiar with basic RF and 
microwave concepts. 
The author thanks How-Siang Yap of Agilent Technologies for 
suggesting the inclusion of a chapter on multiplexers and for other 
comments. He also thanks Rulon VanDyke of Agilent Technologies for 
leading the incorporation of improvements to S/Filter suggested during the 
writing of the book. The author also acknowloges the professional staff at 
Artech House for their assistance in finalizing the book.  
References 
[1] G. Matthaei, L. Young and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Dedham, MA, 1980. 
[2] H. Orchard and G. Temes, “Filter Design Using Transformed Variables,” IEEE 
Trans. on Circuit Theory, Vol. CT-15, December 1968, pp. 385-408. 
[3] G. Szentirmai, “FILSYN – A General Purpose Filter Synthesis Program,” Proc. of 
the IEEE, Vol. 65, October 1977, pp. 1443-1458. 
[4] A. Zverev, Handbook of Filter Synthesis, John Wiley, Hoboken, NJ, 1967 
[5] G. Temes and S. Mitra, editors, Modern Filter Theory and Design, John Wiley, 
New York, 1973. 
[6] R. Rhea, HF Filter Design and Computer Simulation, SciTech Publishing, 
Raleigh, NC, 1994. 
[7] R. Rhea, Practical Issues in RF Design (Three CD Series), SciTech Publishing, 
Raleigh, NC, 2003. 
 

 
1 
 
1 Transmission Zeros 
Central to filter design by direct synthesis is the specification of 
transmission zeros (TZs) and understanding their influence on the filter 
response. With the modern method refined in the 1950s, specified filter 
parameters include the type of approximation, such as Butterworth or 
Chebyshev, the passband frequencies, the termination impedance, and the 
order of the filter. The TZs are fixed by the filter type. Fixed TZs simplify 
the design process, but they restrict the characteristics of the filter. The 
newer direct synthesis method described in this book supports flexible 
specification of TZs, thus providing the designer with more control [1],[2]. 
The first step is to understand TZs and their influence on the filter. 
1.1 Determining TZ by Inspection 
Consider the fourth-order lowpass filter schematic in Fig. 1.1a. Also shown, 
as open or closed switches, are the transmission characteristics of each of 
the elements at DC and at infinite frequency (infinity). At DC, each of the 
inductors pass signal and each of the capacitors is open, and therefore do 
not shunt signal to ground. At infinity, each inductor is open and each 
capacitor shunts signal to ground. This filter has no TZ at DC and it has 
four TZs at infinity. Because this filter passes low frequencies and 
attenuates high frequencies, it is a lowpass filter. 
Consider the lowpass filter in Fig. 1.1b. The antiresonant series branch 
to ground produces a finite-frequency transmission zero (FTZ) at its 
resonant frequency. At infinity, the shunt inductor is an open and this 
shunt branch is ignored. Therefore, inductor L1 and L2 are redundant 
opens. They are redundant because two series inductors are replaced with a 
single inductor whose value is the sum of the individual inductors. 
Therefore, this filter has no TZs at DC, two TZs at infinity, and one FTZ. 
The FTZ has removed one TZ at infinity. The FTZ is placed above the 
passband. Filters with TZ at only DC or infinity are referred to as all-pole 
filters. Filters with FTZ are referred to as generalized filters [1]. As 
discussed in detail later, elliptic filters are a subclass of generalized filters. 
Highpass filters have TZs at DC and if present, FTZs are below the 
passband. 

2 
Filter Synthesis Using Genesys S/Filter 
 
Figure 1.1 (a) All-pole lowpass filter showing DC and Infinite TZs and (b) a generalized 
lowpass with also a TZ at finite frequency. 
Consider the third-order (sixth degree) bandpass filter in Fig. 1.2a. At 
DC, the shunt inductor in the first branch is a TZ, the series capacitor in the 
second branch is a TZ, and the shunt inductor in the third branch is a TZ. 
This filter has three TZs at DC. At infinity, the shunt capacitor in the first 

Transmission Zeros 
3 
branch is a TZ, the series inductor in the second branch is a TZ, and the 
capacitor in the third branch is a TZ. This filter has three TZs at infinity. 
Because it has TZ at both DC and infinity, this is a bandpass filter. 
 
 
Figure 1.2 (a) Conventional three-resonator all-pole bandpass filter and (b) generalized 
bandpass filter with FTZs. 
Consider the 45- to 85-MHz bandpass filter in Fig. 1.2b. At DC, all of 
the shunt branches are open and they play no role. Capacitor C5 is shorted 
by L3, so C5 plays no role. Capacitors C1, C4, and C7 are all in series and are 
replaced with one series capacitor of smaller value. This filter has one TZ at 
DC. At infinity, capacitors C4 and C5 form a short that places capacitors C3 
and C6 in parallel. These latter two capacitors are replaced with one 
capacitor of larger value. The branch containing L2 and C2 becomes an open 
because of L2 and this branch plays no role. Therefore, L1, C3 in parallel 
with C6, and L4 form three TZs at infinity. L2 and C2 series resonate at 30 
MHz forming a short to ground resulting in a FTZ. C5 and L3 resonate at 
102 MHz forming an open resulting in a FTZ. This filter has one TZ at DC, 
three TZs at infinity, one FTZ below the passband, and one FTZ above the 
passband. 

4 
Filter Synthesis Using Genesys S/Filter 
1.2 Filter Degree 
The degree of a filter [3] is the order of the transducer function polynomial, 
H(s). Each TZ at DC adds one degree to the filter transfer function. In 
addition, each TZ at infinity adds one degree to the filter. Each finite-
frequency TZ adds two degrees. 
1.3 Canonical Realization 
A canonical filter is a filter network realized using a minimum quantity of 
elements. All filters as initially synthesized by S/Filter are canonic. 
Although they possess the minimum quantity of elements, canonic filters 
may have element values that are difficult to realize, or a topology that is 
inconsistent with practical manufacturing methods. A powerful feature of 
S/Filter is the inclusion of numerous transforms that are easily 
implemented in the integrated environment of Genesys as the design 
moves seamlessly from specification, to schematic, to layout, and to 
electromagnetic (EM) simulation if desired. 
Certain of these transforms, such as the well-known pi to tee, retain a 
canonic form of the synthesized filter. Certain other transforms, such as the 
powerful Norton transforms, add additional elements and nullify the 
canonical status of the filter. Nevertheless, it is shown that these 
noncanonical transforms may improve the realizability of a filter. 
1.4 Influence of TZs on the Response 
Each element in an all-pole lowpass filter results in one TZ at infinity. For 
this type of filter, the number of TZs is equal to the filter degree. The solid 
trace in Fig. 1.3 is the transmission amplitude response of a fifth order (five 
element) Butterworth-approximation lowpass filter with a 0.05-dB cutoff of 
100 MHz. In the transition region from 200 to 400 MHz, the attenuation 
increases from 11.09 to 40.84 dB, or 29.75 dB. This is approximately five 
times 6.02 dB per octave. Each TZ adds approximately 6.02 dB per octave 
in the transition region. 
 

Transmission Zeros 
5 
 
Figure 1.3 Lowpass filter responses of a five-element Butterworth (solid), a five-element 0.5-
dB ripple Chebyshev (dashed), and a five-branch Cauer-Chebyshev (dash-dot). 
Next, consider a lowpass with five infinite TZ but a 0.05-dB passband-
ripple Chebyshev approximation. From 130 to 260 MHz, the attenuation 
increases 36.3 dB, or 7.3 dB per octave. As the passband ripple is increased, 
greater selectivity occurs near the cutoff. Deep into the stopband, the 
attenuation rate approaches 6.02 dB per octave for each TZ, regardless of 
the passband ripple. 
Fig. 1.4 shows a generalized lowpass filter with one TZ at infinity and 
two FTZs above the passband. This filter has a 0.18-dB passband ripple and 
40-dB minimum attenuation in the stopband. The amplitude transmission 
response is also plotted in Fig. 1.3. The FTZ are placed at 140 and 205 MHz 
to provide equal stopband attenuation. This class of filter with equal ripple 
in the passband and stopband is referred to as a Cauer-Chebyshev, or an 
elliptic filter. The nomenclature elliptic is used not because the zeros of the 
transmission function lie on an ellipse in the complex plane. This is true for 
an all-pole Chebyshev. The nomenclature elliptic [4] is used because the 
synthesis polynomials involve elliptic functions. 
The elliptic response depicted in Fig. 1.3 has zeros specifically placed to 
provide equal ripple in the stopband attenuation. This is a characteristic of 
Cauer-Chebyshev elliptic filters. This class of filter can be designed using 
the modern filter design method. However, it is overly restrictive because it 
dictates equal-stopband ripple. The design of filters using direct synthesis 
supports arbitrary placement of TZs and therefore provides custom 
responses and potentially a more economic design. 

6 
Filter Synthesis Using Genesys S/Filter 
There are rules governing the specification of TZ for synthesis in 
S/Filter. Some of these rules are absolute and must be adhered to. Other 
rules are required for exact synthesis but may be overruled if an 
approximate response is acceptable. These rules are discussed later. 
 
 
Figure 1.4 Lowpass filter with one TZ at infinity and two FTZ. 
References 
[1] R.W. Rhea, “Transmission Zeros in Filter Design,” Applied Microwave & 
Wireless, January 2001, pp. 92, 94, and 96. 
[2] R.W. Rhea, Filter Design by Transmission Zeros (CD), SciTech Publishing, 
Raleigh, NC, 2003. 
[3] G. Temes and S. Mitra, Modern Filter Theory and Design, John Wiley & Sons, 
New York, 1973. 
[4] A.I. Zverev, Handbook of Filter Synthesis, John Wiley & Sons, Hoboken, NJ, 
1967. 
 
 

 
7 
 
2 All-Pole Lowpass and Highpass 
The direct synthesis method offers no advantage over the modern 
method for all-pole lowpass and highpass filters. Nevertheless, the basic all-
pole filters are important and are used in this chapter to introduce the 
concept of direct-synthesis filter design. 
2.1 Initial All-Pole Lowpass Parameters 
Given in Fig. 2.1 is the Specification tab of the S/Filter program dialog 
window in the Genesys platform of the Agilent EEsof EDA division of 
Agilent Technologies [1]. It is launched by opening Genesys, right-clicking 
Designs in the workspace tree, and selecting Add, Synthesis, Run S/Filter. 
All programs in the Genesys platform comply with the concepts of the 
Common User Access standard and Microsoft Windows, so operation of 
S/Filter is intuitive for those who use other programs of this type. 
 
 
Figure 2.1 S/Filter dialog window showing the Specification tab. 
This example specifies a source and load resistance of 50 ohms and a 
cutoff frequency of 100 MHz. The passband ripple is specified as 0.5 dB. 
Table 2.1 relates filter reflection coefficient
,
ρ return losses, scattering 
parameters (Snn), voltage standing-wave ratios (VSWRs), and ripples (LA-
dB) for a filter with lossless elements. Table 2.1 is used to select a ripple 

8 
Filter Synthesis Using Genesys S/Filter 
based on the required passband return loss for an ideal filter. A passband 
ripple of 0.5 dB corresponds to a return loss of 9.65 dB.  
Table 2.1 Representative Values of Radial-Scaled Parameters 
n
ρ
 
Snn(dB) 
VSWRn 
LA(dB) 
0.010 
-40.00 
1.020 
0.0004 
0.032 
-30.00 
1.065 
0.0043 
0.056 
-25.00 
1.119 
0.0138 
0.100 
-20.00 
1.222 
0.0436 
0.158 
-16.00 
1.377 
0.1105 
0.200 
-14.00 
1.499 
0.1764 
0.251 
-12.00 
1.671 
0.2830 
0.316 
-10.00 
1.925 
0.4576 
0.333 
-9.54 
2.000 
0.5118 
0.398 
-8.00 
2.323 
0.7494 
0.500 
-6.02 
3.000 
1.2496 
0.600 
-4.44 
3.997 
1.9365 
0.707 
-3.01 
5.829 
3.0106 
0.794 
-2.00 
8.724 
4.3292 
 
These are referred to as radial-scaled parameters because they all 
represent a vector length outward from the center of the Smith chart. 
 
n
dB
nn
S
dB
RL
ρ
log
20
)
(
)
(
−
=
−
=
                (2.1 ) 
n
n
VSWR
ρ
ρ
−
+
= 1
1
                                        (2.2) 
(
)
2
1
log
10
)
(
n
A dB
L
ρ
−
−
=
                          (2.3) 
where n is the port number. 
In the S/Filter Specification tab, the ¼ Wave Freq is used only for 
distributed filters and it specifies the frequency at which each distributed 
element is a quarter-wavelength long. The process is lumped, meaning each 
element is an inductor or capacitor with no electrical length. The Shape 
refers to the transfer approximation in the passband. Max Flat is a 
Butterworth approximation and Equiripple is a Chebyshev approximation. 
During synthesis, S/Filter maintains these passband approximations 
regardless of the quantity and frequency of the transmission zeros. Linear-
phase passband approximations are not synthesized by S/Filter. 
The filter types synthesized by S/Filter include lowpass, highpass, and 
bandpass. Lumped-element bandstop filters are designed in S/Filter by 
parallel connecting lowpass and highpass filters. A more practical approach 
to designing bandstop filters is using the Passive Filter, Microwave Filter, 
and Active Filter modules of Genesys. 

All-Pole Lowpass and Highpass 
9 
To specify a fifth-order lowpass, five TZs at infinity are specified in the 
TZ table. 
2.2 Dual Topologies 
Given in Fig. 2.2 is the Extraction tab of the S/Filter window. Notice that 
Series Element First is not selected. This forces synthesis with the first 
element on the left as a shunt element, a capacitor in the case of a lowpass 
filter. If this selection is checked, the first element will be in series, an 
inductor in the case of a lowpass filter. 
 
 
Figure 2.2 Extraction tab of the S/Filter window. 
These two forms are given in Fig. 2.3. The two topologies are the dual 
of each other. The transmission characteristics of these dual forms are 
identical in all respects. The port-impedance characteristics as a function of 
frequency are different, which is important for the diplexer designs 
considered later. In addition, element values are different, and certain 
forms are advantageous for practical reasons. The designer is free to choose 
the desired topology. The remaining selections in the Extraction tab are 
covered later. 
 

10 
Filter Synthesis Using Genesys S/Filter 
C=54.3pF
C1
L=97.85nH
L1
C=80.88pF
C2
L=97.85nH
L2
C=54.3pF
C3
L=135.74nH
L1
C=39.14pF
C1
L=202.19nH
L2
C=39.14pF
C2
L=135.74nH
L3
 
Figure 2.3 Dual forms of the lowpass filter with shunt element first (top) and series element 
first (bottom). 
2.3 Chebyshev Approximation with Even Order 
Consider the fourth-degree Chebyshev lowpass filter on the left in Fig. 2.4. 
Four TZs at infinity are specified in the TZ table. The transmission 
amplitude and reflection responses are given on the right in Fig. 2.4 as the 
thicker lines. The transmission amplitude response for a true Chebyshev 
lowpass approximation has a quantity of transmission-response slope zeros 
equal to the degree of the filter. Likewise, the number of minimum and 
maximum in the passband return loss equals the order of the lowpass. In 
this case, notice that the quantity of transmission slope zeros is four. For 
even order, this forces attenuation at DC equal to the ripple value. 
 

All-Pole Lowpass and Highpass 
11 
C=53.17pF
C1
L=94.9nH
L1
C=75.32pF
C2
L=66.99nH
L2
ZO=50Ω
ZO=25.13Ω
 
Figure 2.4 Even order (fourth) lowpass filter schematic (left), and the transmission and 
reflection responses (right). 
Again, consider the schematic. At DC, the capacitive reactance 
approaches infinity and the capacitors effectively vanish. Similarly, the 
reactance of the inductors approaches zero and the inductors vanish. Since 
the source is therefore connected directly to the load, how can the 
attenuation at DC equal the ripple value? For attenuation to exist at DC 
there must be a mismatch [2]. Notice that this fourth-order Chebyshev 
lowpass has a load termination resistance of 25.13 ohms rather than 50 
ohms. Dissimilar terminations are required to achieve a true even-order 
Chebyshev response. 
The thinner lines in the response are with the load termination set at 
50 ohms and all elements optimized to achieve equal ripple in the 
passband. The attenuation at 140 MHz is reduced by about 1.5 dB. Notice 
that the quantity of minimum and maximum values in the passband return 
loss is three. The modified element values are substantially different: the 
new value for C1 is 41.3 pF, for L1 is 122.5 nH, for C2 is 49.4 pF, and for L2 is 
105.2 nH. However, optimization proceeds very quickly, so this is an 
effective design procedure. 
2.4 All-Pole Highpass Example 
The all-pole highpass has all TZs at DC. Like the all-pole lowpass, the 
highpass is easily designed using the modern method. The lowpass 
prototype g-values are inverted, representing a 1/s transform, and 
converting each shunt capacitor to a shunt inductor and each series 

12 
Filter Synthesis Using Genesys S/Filter 
inductor to a series capacitor. Then the values are scaled for frequency and 
termination resistance, just as with the lowpass. 
Fig. 2.5 shows the schematic and responses of a 0.1-dB ripple 
Chebyshev highpass with four TZs at DC. Notice that similar to the lowpass, 
the even-order Chebyshev highpass requires dissimilar termination 
resistance. 
 
L=57.74nH
L1
C=25.08pF
C1
L=38.71nH
L2
C=37.41pF
C2
ZO=50Ω
ZO=30.86Ω
 
Figure 2.5 Chebyshev all-pole highpass with four TZs. 
References 
[1] Agilent Technologies, GENESYS 2012.01 Documentation Set, www.agilent.com. 
[2] R.W. Rhea, HF Filter Design and Computer Simulation, SciTech Publishing, 
Raleigh, NC, 1994. 
 

 
13 
 
3 Lowpass with Finite Zeros 
As previously stated, direct synthesis offers no advantage over the 
modern method for all-pole lowpass filter design. However, this is not the 
case for generalized lowpass filters with FTZs. In this chapter, instruction 
on the use of S/Filter continues with the design of generalized lowpass 
filters. 
3.1 Introduction 
The design of generalized lowpass filters will begin with a specific filter 
requirement. Consider the following required filter specification: 
1) Nominal termination resistances: 
50 ohms 
2) Passband cutoff frequency:  
32 MHz 
3) Maximum passband return loss:  
16 dB 
4) Minimum rejection at 35 MHz:  
50 dB 
5) Minimum rejection above 38 MHz: 20 dB 
The goals are maximum economy with minimum inductor count. The 
rejection requirements are indicated on the graph in Fig. 3.1 as a mark at 35 
MHz and a shaded region above 38 MHz. 
An all-pole 0.1-dB ripple Chebyshev filter that just satisfies the 
requirements is 19th order, thus requiring nine inductors and ten 
capacitors. The response is given in Fig. 3.1 as the dotted trace. A schematic 
is not given here. 
Next, an elliptic Cauer-Chebyshev filter is designed using the modern 
filter design method. A schematic of the solution that just satisfies the 
requirement is given in Fig. 3.2. It satisfies the 35-MHz rejection 
requirement with frequency margin, but the next lower order filter is 
insufficient. This filter requires four inductors and nine capacitors, a 
significant improvement over the all-pole Chebyshev. It is incorrect to 
assume that Cauer-Chebyshev filters always have superior economy to all-
pole filters. This comparison depends on specific filter specifications. 
 

14 
Filter Synthesis Using Genesys S/Filter 
 
Figure 3.1 Rejection goals (mark and shaded region) and responses of a 0.1-dB ripple all-
pole Chebyshev filter (Chebyshev), an elliptic Cauer-Chebyshev (Cauer-Cheby), and a 
custom filter designed by S/Filter that just satisfies the requirements. 
 
Figure 3.2 A 0.1-dB passband ripple Cauer-Chebyshev (elliptic) filter that satisfies the above 
filter specification. 
Finally, S/Filter is used to design a filter, with a Specification tab given 
in Fig 3.3. the Lumped, Equiripple, and Lowpass radio buttons are 
selected, and the desired termination resistances, cutoff frequency, and 
ripple are entered. A FTZ at 35 MHz is entered and then the Quantity of TZ 
at infinity is increased to five until the rejection specifications are met. The 
resulting filter is given in Fig. 3.4.  
 

Lowpass with Finite Zeros 
15 
 
Figure 3.3 Specification tab for the S/Filter-designed custom filter. 
This solution requires three inductors and five capacitors, a savings of 
one inductor and four capacitors with respect to the Cauer-Chebyshev 
solution. Other solutions are available that are more economic than the 
Cauer-Chebyshev. For example, a filter that uses two TZs spread around 35 
MHz can broaden the frequency range of the 35 MHz notch but the filter is 
still more economic than the Cauer-Chebyshev by two capacitors. 
C=119.53pF
C1
L=360.59nH
L1
C=136.34pF
C2
L=117.1nH
L2
C=136.34pF
C4
L=360.59nH
L3
C=119.53pF
C5
ZO=50Ω
ZO=50Ω
C=176.58pF
C3
 
Figure 3.4 A 0.1-dB passband ripple custom filter designed using S/Filter to synthesize a 
solution with user-specified TZs. 
3.2 Alternative Topologies 
If you duplicate the Specification tab in Fig. 3.3, the filter schematic 
displayed by Genesys may be different than Fig. 3.4 because multiple 
topologies realize a given transfer function. Another advantage of direct 
synthesis is that all of these topologies are available for selection. Managing 
this process is discussed in Chapter 5. 
 


 
17 
 
4 Conventional Bandpass 
This chapter introduces the conventional bandpass  and discusses some 
of the difficulties that arise when designing bandpass filters. The design of 
bandpass filters is significantly more challenging than the design of the 
lowpass or highpass. 
4.1 Bandpass Transform 
Conventional bandpass filters are designed using the modern method by 
converting each shunt capacitor in the lowpass prototype to a shunt parallel 
resonator, and each series inductor in the lowpass prototype is transformed 
to a series resonator in series with the transmission path. Therefore, the 
conventional bandpass has twice the quantity of elements as the lowpass 
prototype. The lower and upper cutoff frequencies are referred to as fu and 
fl, respectively [1]. An important parameter is the absolute bandwidth 
l
u
f
f
BW
−
=
                                                             (4.1)  
The bandpass transform operates geometrically. Therefore the 
mathematical center frequency for this filter is not the average of the upper 
and lower cutoff but 
l
u f
f
f =
0
                                                               (4.2) 
This frequency is used to scale the lowpass prototype values. Then the 
fractional bandwidth is 
0f
BW
bw =
                                                              (4.3) 
The percentage bandwidth is the fractional bandwidth times 100%. 
These parameters are used to calculate element values using the modern 
method. The fractional bandwidth has significant repercussions in the 
design of bandpass filters. Small fractional bandwidth results in extreme 
element values and high dissipative insertion loss. 
4.2 Classification Symmetry or Antimetry 
Bandpass filters with an odd quantity of TZ at DC and an odd quantity of 
TZs at infinity are classified as electrically symmetric filters. Bandpass 
filters with an even quantity of TZs at DC and an even quantity of TZs at 

18 
Filter Synthesis Using Genesys S/Filter 
infinity are classified as antimetric filters. Notice that both classes have an 
even-quantity sum of TZs. Filters with an odd-quantity sum of TZs are 
classified as parametric filters. This class of bandpass filter requires 
approximate techniques and it is not designed by S/Filter. 
4.3  A 75- to 125-MHz Bandpass 
Given in Fig. 4.1 is the Specification tab for a three-section 75- to 125-MHz 
passband conventional bandpass filter. The absolute bandwidth is 50 MHz, 
the fractional bandwidth is 0.516, and the center frequency is 96.82 MHz. A 
schematic of the bandpass is given on the left in Fig. 4.2. At DC, each shunt 
inductor and each series capacitor forms a TZ, and at infinity, each shunt 
capacitor and each series inductor forms a TZ. There are three TZs at DC 
and three TZs at infinity for this filter. 
 
 
Figure 4.1 Specification tab for the 75- to 125-MHz Chebyshev bandpass. 
The transmission amplitude (S21), input reflection (S11), and group-
delay responses are given on the right in Fig. 4.2. With this example, the 
element Qs, (unloaded Qs) are specified as 1000 for the capacitors and 100 
for the inductors. This introduces dissipative insertion loss, primarily at 
frequencies near the passband. The passband ripple is set at 0.0436 dB 
resulting in a passband return loss of 20 dB. The group delay peaks at 
approximately 19 nS near the lower cutoff and 10 nS near the upper cutoff. 
 

Conventional Bandpass 
19 
L=50.69nH
L1
C=53.31pF
C1
ZO=50Ω
L=174.68nH
L2
C=15.47pF
C2
L=50.69nH
L3
C=53.31pF
C3
ZO=50Ω
 
Figure 4.2 Schematic and responses of the 75- to 125-MHz bandpass filter. 
4.4 A 96- to 104-MHz Bandpass Filter 
Next, consider a bandpass with the same parameters except with cutoff 
frequencies of 96 and 104 MHz. The geometric center frequency is 99.84 
MHz and the fractional bandwidth is 0.0801, or 8.01%. As the bandwidth 
narrows, the geometric center frequency approaches the arithmetic center 
frequency. The schematic and responses for this filter are given in Fig. 4.3. 
Notice the change of scale for the frequency-sweep axis and the group-delay 
axis. 
4.5 Comparative Analysis of the Wide and Narrow Filters 
First, consider the dissipative insertion loss. The insertion loss of the 50 
MHz bandwidth filter is barely discernable on the 6-dB per division scale. It 
is 0.26 dB. However, the dissipative insertion loss of the 8 MHz bandwidth 
filter is 1.65 dB. Interestingly, the shape of the dissipative insertion loss is 
approximately equal to the shape of the group delay. For example, the 
dissipative loss at the lower cutoff is 2.16 dB. This is a ratio of 1.3, equal to 
the ratio of the group delay and 96 MHz and band center. The transmission 
amplitude response and the group delay response are related by the Hilbert 
transform. 
 

20 
Filter Synthesis Using Genesys S/Filter 
L=7.62nH
L1
C=333.17pF
C1
ZO=50Ω
L=1091.74nH
L2
C=2.32pF
C2
L=7.62nH
L3
C=333.17pF
C3
ZO=50Ω
 
Figure 4.3 Schematic and responses of the 96- to 104-MHz bandpass filter. 
The ratio of the insertion losses is equal to the ratio of the bandwidths. 
The increase of the insertion loss with decreasing bandwidth is inherent 
with bandpass filters and this loss does not depend on the filter topology or 
whether the filters are designed using the modern method or direct 
synthesis. Improving the insertion loss requires elements or resonators 
with improved unloaded Q [1]. Achieving good resonator Q often requires a 
manufacturing process other than lumped inductors and capacitors (L-C), 
such as coaxial resonators and quartz resonators. This may require all 
parallel or all series resonators forms. Direct synthesis of filters with all 
equal-type resonators is covered in Chapter 8. 
Next, consider the group-delay responses. The group delay at band 
center is 8.06 nS for the wider filter and 54.54 nS, approximately inversely 
proportional to the bandwidth. 
Consider the symmetry of the group-delay responses and the rejection 
in the transition regions. The wide filter is highly asymmetric in group 
delay and the steepness of the transition region below the passband is 
greater than above the passband. This asymmetry is topology-dependent, 
and direct synthesis offers effective methods for dealing with these issues, 
as is discussed in Chapter 11. 
Finally, consider the element values. Notice that the ratio of the largest 
to smallest inductor value is 3.45 with the wider bandwidth filter and the 
ratio is 143.3 for the narrower filter. While the former ratio is manageable, 
realizing the inductor values in the narrow filter is difficult. For lowpass 
and highpass filters, the inductor and capacitor ratios are equal to the ratio 
of lowpass prototype g-values. Element values are closely related to the 
termination resistance for a given cutoff frequency, naturally resulting in 

Conventional Bandpass 
21 
good realizability. For bandpass filters, narrow bandwidth significantly 
decreases some, and increases other, element values.  
In summary, wide bandwidth presents challenges to filter symmetry 
while narrow bandwidth causes issues with element values and insertion 
loss. Direct synthesis is used in later chapters to solve the symmetry and 
element value problems, but the insertion loss problem is inherent. 
Reference 
[1] R.W. Rhea, HF Filter Design and Computer Simulation, SciTech 
Publishing, Raleigh, NC, 1994. 
 


 
23 
 
5 Extraction Sequences 
When a filter is synthesized, TZs are extracted into inductors or 
capacitors. The extraction sequence of the previous filters with three TZs at 
DC and three TZs at infinity is DC ∞ DC ∞ DC ∞. However, with direct 
synthesis the TZs may be extracted in other sequences. This offers 
alternative topologies and element values that may be more desirable from 
a manufacturing standpoint. The Extraction tab of S/Filter is explored in 
this chapter using the previous all-pole bandpass as an example. 
5.1 The Extraction Tab 
Fig. 5.1 shows the Extraction tab of S/Filter for the 75- to 125-MHz 
bandpass filter introduced in Chapter 4. If N is the total quantity of TZs, 
Nfinite is the number of FTZs, NDC is the quantity of TZs at DC, and N∞ is the 
quantity of TZs at infinity, then [1] 
!
!
!
!
∞
×
×
=
N
N
N
N
ns
Permutatio
DC
finite
                                         (5.1) 
In this case there are six total TZs, no FTZs, three TZs at DC, and three TZs 
at infinity, or 20 permutations. However, some permutations are not 
unique. For example, the sequence DC ∞ DC ∞ DC ∞ and the sequence ∞ 
DC ∞ DC ∞ DC are essentially identical because they only change the order 
of the elements in each shunt and each series resonator. In addition, for 
symmetric filters, the left and right ports may be exchanged resulting in an 
identical filter with the same element values and only exchanged positions. 
For this filter, six unique permutations exist. The filter shown at the middle 
left in Fig. 5.2 as DC  ∞ ∞ DC DC ∞ has eight different extraction sequences 
with an identical schematic because the elements may be reversed in each 
branch, and because this filter is electrically symmetric. This is the all-pole 
bandpass filter topology of the filter designed by the modern method. The 
extraction sequence shown as DC DC DC  ∞  ∞ ∞ has four different 
extraction sequences with an identical schematic because the elements may 
be reversed in the center branch, and because this filter has mirror 
symmetry. The four remaining extraction sequences each have two 
identical schematics because elements may be reversed in one branch. 
These four sequences require transformers or dissimilar termination 
resistances. Transformers are dealt with in a later chapter. 

24 
Filter Synthesis Using Genesys S/Filter 
 
Figure 5.1 Extraction tab for the 75- to 125-MHz bandpass filter. 
While the number of unique extraction sequences in this example is 
only six, even moderately complex filters can have a large number of 
extraction sequences, often reaching into the thousands. For example, a 
seventh-order Cauer-Chebyshev has 40,320 total permutations of which 
1,656 are unique. Therefore, the Extraction tab has the option Max 
Solutions to Display to limit the time and data space required to compute 
solutions. The maximum number of supported solutions to display is 
25,000, which takes a few minutes to compute, or to sort. 
Filters, which have FTZs, have certain constraints on the order of 
extraction, or the resulting solution is inexact. Occasionally these inexact 
solutions have desirable element values or topologies and the response is 
sufficiently accurate. Therefore, there is an option to allow inexact 
solutions. This topic is covered in Chapter 6. All extraction solutions for all-
pole filters are exact. 
A dual topology exists for all L-C filters. With each of the filters in Fig. 
5.2, the first element is shunt. By selecting the Series Element First option, 
an additional set of 20 extractions and six unique solutions are available. 
The duals of the previous bandpass filters without transformers are given in 
Fig. 5.3. The topology on the bottom is the all-pole form designed by the 
modern method. 
 

Extraction Sequences 
25 
L=50.7nH
L1
C=68.8pF
C1
L=11.4nH
L2
C=237pF
C2
L=39.3nH
L3
C=53.3pF
C3
DC  DC  DC  Inf  Inf  Inf
C=53.3pF
C1
L=39.3nH
L1
L=11.4nH
L2
ZO=50Ω
C=305.8pF
C2
L=2.6nH
L3
C=1053.9pF
C3
S=4.4
P=1
T1
ZO=50Ω
Inf  Inf  DC  DC  DC  Inf
 
L=50.7nH
L1
C=53.3pF
C1
L=174.7nH
L2
ZO=50Ω
C=15.5pF
C2
L=50.7nH
L3
ZO=50Ω
C=53.3pF
C3
DC  Inf  Inf  DC  DC  Inf
L=50.7nH
L1
ZO=50Ω
C=237pF
C2
L=8.8nH
L2
L=2.6nH
L3
C=1053.9pF
C3
C=68.8pF
C1
S=4.4
P=1
T1
ZO=50Ω
DC  DC  Inf  Inf  DC  Inf
L=50.7nH
L1
C=53.3pF
C1
DC  Inf  DC  DC  Inf  Inf
C=15.5pF
C2
L=225.4nH
L2
L=776.7nH
L3
C=2.7pF
C3
S=0.2
P=1
T1
ZO=50Ω
ZO=50Ω
L=50.7nH
L1
DC  Inf  Inf  Inf  DC  DC
ZO=50Ω
C=53.3pF
C1
L=174.7nH
L2
C=12pF
C2
L=1002nH
L3
C=3.5pF
C3
S=0.2
P=1
T1
ZO=50Ω
 
Figure 5.2 The six unique solutions to the bandpass filter with three TZs at DC and three TZs 
at infinity. 
The checkbox Specify Permutation allows the user specify a particular 
permutation sequence. Clicking the Edit Permutation button opens the 
dialog given in Fig. 5.4. The sequence is modified by selecting a TZ and 
moving that TZ earlier or later in the sequence. 
With all-pole filters such as this example, selecting the extraction 
sequence is of limited advantage. Unless the filter is used for matching, 
obviously the most desirable filters are the ones without transformers. 
Using S/Filter for matching is discussed in Chapter 12. Of the four filters 
without transformers, in this case, the filters with the smallest spread of 
inductor values are the dual forms of the conventional bandpass. 
 
 

26 
Filter Synthesis Using Genesys S/Filter 
DC  DC  DC  Inf  Inf  Inf
ZO=50Ω
C=20.3pF
C1
L=171.9nH
L1
L=592.6nH
L2
C=4.6pF
C2
C=15.7pF
C3
L=133.3nH
L3
ZO=50Ω
 
Inf  DC  DC  Inf  Inf  DC
ZO=50Ω
L=133.3nH
L1
C=20.3pF
C1
L=38.7nH
L2
C=69.9pF
C2
L=133.3nH
L3
C=20.3pF
C3
ZO=50Ω
 
Figure 5.3 Duals with a series element first of the two filters in Fig. 5.2 that do not have 
transformers. 
 
Figure 5.4 Custom Permutation Order dialog box of S/Filter. 
 
 

Extraction Sequences 
27 
As we explore complex filters with more TZ and FTZ, it becomes clear 
that realizability is greatly improved by direct synthesis and the ability to 
control the extractions. Finding the best solution to thousands of unique 
permutations requires tools. This is the function of the features Use Goals, 
Edit Goals, Customize Table, and Auto Fit Table. 
Reference 
[1] Genesys 2012: Synthesis, Agilent Technologies,  Santa Clara, CA 2012, p. 292. 
 


 
29 
 
6 Customized Bandpass Filters 
This chapter describes filter customization by the independent 
specification of TZs at DC, infinity and finite frequencies. This chapter also 
describes the tools within S/Filter used to find the optimum solution from 
potentially thousands of unique topologies. 
6.1 Custom Filter Specification 
Consider the following required filter specification: 
1) Nominal termination resistances: 
 
50 ohms 
2) Maximum passband return loss: 
 
20 dB 
3) Lower passband cutoff frequency:  
3.5 MHz 
4) Upper passband cutoff frequency:   
29.6 dB 
5) Minimum rejection below 2.0 MHz:  
40 dB 
6) Minimum rejection above 38 MHz:  
70 dB 
Manufacturability goals include no transformer, a minimum quantity 
of inductors, and the smallest possible ratio of inductor values.  
An S/Filter synthesis is added to Genesys. The filter passband is 
specified as 3.4 to 29.8 MHz to offer some tolerance for tuning the 
manufactured filter. An equiripple Chebyshev passband with a 0.043-dB 
ripple is entered to achieve a passband return loss of 20 dB. Optimization 
goals are added to easily visualize the passband and rejection specifications. 
Next, TZs are added and the FTZ frequencies are adjusted until the 
specification is satisfied. This is an interactive process, but because the 
objectives are visualized, the process is quick. In this case, it is discovered 
that four TZs at DC, two TZs at infinity, one TZ below the passband, and 
three TZs above the passband satisfy the requirements. The frequencies of 
the FTZs are listed in the Specification tab shown in Fig. 6.1. 
 
 

30 
Filter Synthesis Using Genesys S/Filter 
 
Figure 6.1 Specification tab for the custom filter. 
Next, the Extraction tab is utilized to select the optimum sequence. The 
Customize Table button is clicked to open the Customize Permutation 
Table dialog. The manufacturability goals for this filter involved inductors 
and the transformer, so Maximum C Value and Minimum C Value are 
selected in turn and shifted left to the Available column. Then Lmax/Lmin 
Ratio and Transformer Turns Ratio are selected in turn and shifted right 
to the Show in Table column and OK is clicked. The results are displayed in 
Fig. 6.2. 
 
 
Figure 6.2 Customize Permutation Table dialog after changes. 

Customized Bandpass Filters 
31 
In the Extraction tab, the Auto Fit Table button is clicked to 
automatically adjust the width of the columns in the displayed table. There 
are 75,600 extraction sequences. To reduce solution time and data space, 
8,000 is entered for the Max Solutions to Display. The objective is to locate 
the permutation with the fewest number of inductors, a transformer turns 
ratio of one, and a solution with a low Lmax/Lmin. An optimizer is 
available to match adjustable goals, but the number of inductors is not an 
available measurement, so the best technique is to sort the table. Clicking a 
column title sorts that column. If the TRF Ratio column is clicked first, 
followed by the #Inds column, all solutions with the fewest inductors are at 
the beginning of the list and the TRF Ratio is in sorted order. The list is 
scrolled until those entries with a transformer ratio of one are located. A 
quick scroll through this list reveals the solution with the lowest 
Lmax/Lmin. The Extraction tab scrolled to this entry is given in Fig. 6.3. 
Two sets of solutions are available, one set with a series element first and 
one set with a shunt element first. In this case, both sets offer a minimum 
inductor count of seven with no transformer. The series element first offers 
a slightly smaller Lmax/Lmin, 6.4 to 1. The extraction sequence is ∞ 38 42 
DC 54 DC 2.4 ∞ DC DC. 
 
 
Figure 6.3 Extraction tab for the custom bandpass filter example. 
The schematic is given in Fig. 6.4. Because of digital precision, the 
S/Filter schematic may include the transformer even if the turns ratio is 
unity. If so, the transformer is deleted. S/Filter may not always display 
schematic objects in the exact extraction sequence if the displayed 
schematics are exactly equivalent. For example, C3, C5, and L3 extract the 

32 
Filter Synthesis Using Genesys S/Filter 
42-MHz TZ, while C4 extracts a TZ at DC. The listed extraction sequence 
shows that the DC extraction is after the FTZ, while the schematic shows 
them reversed. However, the schematic is valid because C4 and C5/L3 may 
be reversed with no effective difference. 
 
 
Figure 6.4 Schematic of the custom bandpass filter with transformer removed. 
 
 
Figure 6.5 Amplitude transmission and reflection responses of the custom bandpass. 
A Cauer-Chebyshev designed using the modern method requires ninth 
order to just satisfy the 35-MHz rejection requirement. This over performs 
in the lower stopband, and the filter requires 13 inductors and 13 capacitors 
with Lmax/Lmin over 100. 

Customized Bandpass Filters 
33 
6.2 Partial Extractions of FTZs 
With all-pole filters, each TZ extracts into one inductor or capacitor. 
However, each FTZ requires three elements. Therefore, the previous 
custom filter with 10 TZs requires 18 elements. Generally, generalized 
filters are economic only when excellent rejection is required near the 
passband. 
The extraction of a FTZ requires a pole at the FTZ frequency. This 
requires forming a remainder impedance function at the FTZ frequency by 
the partial extraction of a TZ at DC or infinity. Each partial extraction and 
FTZ extraction results in a three-element network with one of the forms 
given in Fig. 6.6. 
Because a TZ at DC or infinity is only partially extracted, this process 
requires that the remaining portion is extracted after the FTZ is extracted. 
Therefore, the user must select an extraction sequence with the final TZ at 
DC extracted after all the FTZs below the passband are extracted. Likewise, 
the final TZ at infinity must be extracted after all FTZs above the passband 
are extracted. 
   
Figure 6.6 Four partial and FTZ extraction topologies. 

34 
Filter Synthesis Using Genesys S/Filter 
6.3 Inexact Extractions 
If the above partial extraction rules are violated, the resulting filter 
response is inexact. If the violation occurs early in the extraction process, 
impedance errors ripple through the filter causing significant response 
degradation. If the violation occurs late in the extraction process, the 
degradation may be minimal. S/Filter displays extraction sequences 
including those with violations if the Allow Inexact box is checked. It is 
advisable to explore this option, because the economy may be better, and 
response errors can potentially be corrected by optimization. 
6.4 Inexact Example 
Given in Fig. 6.7 is the Specification tab for a 50- to 90-MHz bandpass 
0.043-dB ripple filter with one TZ at DC, one TZ at infinity, TZs below the 
passband at 22 and 31 MHz, and two TZs above the passband at 144 and 
197 MHz. The TZs are specified to realize 70-dB rejection below 32 and 
above 140 MHz. The capacitor Q and inductor Q are set at 1000 and 100, 
respectively. 
 
Figure 6.7 Specification tab for the 50- to 90-MHz bandpass filter. 
The Extraction tab for the exact solutions is given in Fig. 6.8. The 
Series Element First type is selected because the inductor values for its dual 
are rather small. There are 720 permutations and 57 unique solutions. The 
number of unique solutions is a small fraction of the total permutations 
because there are only two nonfinite TZs and the elements in each of the 
FTZs may be exchanged. To find the best solution, the Permutation Table is 
sorted as before. One of the solutions with the minimum number of 
inductors, no transformer, and the smallest Lmax/Lmin is selected. The 

Customized Bandpass Filters 
35 
sequence selected is 22 31 DC 197 144 ∞. The schematic is given in Fig. 6.9. 
Seven inductors are required and Lmax/Lmin is 51.6. This ratio is generally 
difficult but manageable. 
 
 
Figure 6.8 Exact extractions for the 50- to 90-MHz bandpass filter. 
 
L=261.3nH
L1
L=979nH
L2
L=3316.5nH
L3
C=1.7pF
C5
L=86.5nH
L4
L=584.6nH
L5
L=64.2nH
L6
L=140.9nH
L7
ZO=50Ω
C=8.8pF
C3
C=33.7pF
C1
ZO=50Ω
C=200.3pF
C2
C=26.9pF
C4
C=7.5pF
C6
C=19pF
C7
 
Figure 6.9 Schematic of the exact solution to the 50- to 90-MHz bandpass filter. 
The transmission amplitude and reflection responses are given in the 
left graph of Fig. 6.10. The finite capacitor and inductor Q has resulted in a 
0.5-dB insertion loss at band center. 
 

36 
Filter Synthesis Using Genesys S/Filter 
 
Figure 6.10 Responses of the exact extraction (left) and the inexact extraction before 
optimization (dashed traces on the right graph) and after optimization (solid traces on the right 
graph). 
Next, the Allow Inexact selection box is checked to explore if an inexact 
solution has an advantage. This increases the quantity of unique solutions 
to 601, and both exact and inexact solutions display in the S/Filter table. All 
the permutations displayed in Fig. 6.11 are inexact and appear dark gray. 
Again, the same sorting procedure is used to find the best solution with the 
added criteria that while scrolling through the table the response is 
observed to ascertain that the response degradation is minimal. The 
solution chosen for this example is ∞ 22 144 31 197 DC and displays as dark 
black in Fig. 6.11. This permutation violates extraction rules because the 
last TZ at infinity is extracted before the FTZs above the passband are 
extracted. The extraction of the FTZs below the passband are exact because 
the TZ at DC is extracted after those FTZ. 
The transmission amplitude and reflection responses for this inexact 
permutation are given as dashed traces in the right graph of Fig. 6.10. The 
inexact extraction has resulted in minimal degradation of the responses. 
The transmission response is affected very little, and the return loss is 
degraded from about 22 dB for the exact permutations to about 18 dB. 
However, optimizing only the inductors in this filter, as shown by the solid 
traces on the right in Fig. 6.10, has improved the return loss to near the 
exact response. 
 

Customized Bandpass Filters 
37 
 
Figure 6.11 Extraction tab with inexact permutations included in the display. 
The schematic for this inexact permutation is given in Fig. 6.12. The 
filter is significantly superior to the best exact solution. Although the 
quantity of capacitors is increased from seven to nine, the quantity of 
inductors is reduced from seven to five and Lmax/Lmin is only 3.0, 17 
times lower than the exact solution, thus significantly enhancing inductor 
design options. 
 
 
Figure 6.12 Schematic of the inexact bandpass filter with values after optimization. 
 


 
39 
 
7 Norton Transforms 
Filter economy and manufacturability are often enhanced by the 
application of transforms. Scores of transforms are integrated into S/Filter, 
thus simplifying their application to specific filters. They are accessed 
through the Transform tab. Experience with transforms is essential to the 
mastery of filter design. The transforms are listed in the S/Filter 
documentation so a transform-by-transform description is not repeated 
here. Some of the more important transforms used to solve common filter 
design problems are illustrated throughout the remainder of the book. The 
Norton transforms are essential and the basis of many other “macro” 
transforms. For example, conversions between Pi, Tee, and L-network 
conversions use Norton transforms. Therefore, this chapter is devoted to a 
description of the Norton. 
7.1 Norton Series Transform 
The Norton transform has two basic forms: the series and the shunt. Given 
in Fig. 7.1 is the Norton series transform. The elements Z may be a 
capacitor, an inductor, a series L-C, or a parallel L-C. 
 
 
Figure 7.1 Norton series transform. 
The formulas relating these elements are 
n
Z
Za
−
= 1
                                                                  (7.1) 
n
Z
Zb =
                                                                     (7.2) 

40 
Filter Synthesis Using Genesys S/Filter 
(
)1
−
=
n
n
Z
Zc
                                                              (7.3) 
where n is the turns ratio of the transformer. In S/Filter dialog windows, n 
is referred to variously as n or N. Notice that when n>1 then Za is negative, 
and when n<1 then Zc is negative. The obvious question is why would it be 
desirable to utilize the Norton when one reactor is replaced with a negative 
reactor, two positive reactors, and a transformer. The answer is best 
illustrated with an example. 
7.2 Removing a Transformer with the Series Norton 
Consider the 55- to 85-MHz 0.043-dB ripple bandpass filter shown in Fig. 
7.2 with one TZ at DC, three TZ at infinity, one TZ at 35.7 MHz, and one TZ 
at 107.2 MHz. All the permutations of the exact synthesis of this filter have 
a transformer. The extraction sequence selected is ∞ 107.2 35.7 ∞ ∞ DC. 
 
Figure 7.2 A 55- to 85-MHz bandpass filter that requires a transformer. 
To remove the transformer, first L4 and C6 are swapped by selecting L4 
in the schematic, and applying the Basic Operations: Swap Element 
transform in the Transform tab (Fig. 7.3). This swap is necessary because 
the Norton transform adds an additional element, and for practical reasons, 
it is desirable to add a capacitor rather than an inductor. The Norton series 
transform creates a negative valued capacitor on one side of the series 
capacitor. To absorb the negative capacitor, the series capacitor must be 
adjacent to a larger, positive shunt capacitor. C4 is the target absorbing 
capacitor. 
 

Norton Transforms 
41 
 
Figure 7.3 The S/Filter Transform tab with Swap element selected. 
Next C6 is selected in the schematic and the Norton: Series Transform 
is applied. This invokes the Norton Transform dialog given in Fig. 7.4. Four 
options are available: choosing the left element Za, the right element Zc, the 
transformer ratio n, or letting S/Filter find the transformer ratio that 
cancels the existing transformer. In this case, the later option is selected. 
The application of this transform displays the schematic given in Fig. 7.5. 
 
 
Figure 7.4 Norton Transform dialog for specification of the transform parameter. 

42 
Filter Synthesis Using Genesys S/Filter 
 
Figure 7.5 Schematic of the 55- to 85-MHz bandpass filter after application of the series 
Norton. 
Next, the Simplify Circuit button in the Transform tab is clicked. This 
function combines all transformers and combines like-parallel and like-
series elements. S/Filter determines the resulting transformer has a unity 
turns ratio and eliminates it. In addition, S/Filter absorbs the negative 
capacitor C6 into C4, thus eliminating C6. The final schematic is given in Fig. 
7.6. It is unnecessary to swap C6 and the L3/C5 branch before applying the 
Simplify Circuit transform. The Simplify Circuit transform is schematically 
global in that it searches the entire schematic during simplification. 
Compare the original schematic in Fig. 7.2 with the final schematic in 
Fig. 7.6. Inspection of the Norton series diagram in Fig. 7.1 suggests that 
the Norton transform replaces a single capacitor with three capacitors and 
a transformer. In reality, when applied at the proper position in the filter, 
the affect is to replace a transformer with a more economical capacitor. 
When applied to an inductor, the Norton replaces a transformer with an 
inductor. 
In 
essence, 
the 
Norton 
transform 
is 
an 
impedance 
transformation. 
 

Norton Transforms 
43 
 
Figure 7.6 Schematic of the 55- to 85-MHz bandpass filter after simplification. 
7.3 Norton Shunt Transform 
The Norton shunt transform is the dual of the series transform applied to a 
shunt reactor or L-C pair. The schematic of the Norton shunt transform is 
given in Fig. 7.7. 
 
 
Figure 7.7 The Norton shunt transform. 
The formulas relating these elements are 
Z
n
Za





−
=
1
1
                                                             (7.4) 
n
Z
Zb =
                                                                     (7.5) 

44 
Filter Synthesis Using Genesys S/Filter 
Z
n
n
Zc





−
=
2
1
                                                             (7.6) 
For the Norton shunt transform, if n<1 then Za is negative and if n>1 
then Zc is negative. 
7.4 Equal-Valued Inductor Bandpass 
Because the Norton transforms shift the impedance level within the filter, 
they are often used to change reactor values within a filter. For example, 
repeated application of the Norton transform at various locations within a 
filter is used to equate all inductors to an identical value. This is desirable if 
only specific values of inductance are available. 
Again, the design begins with the 55- to 85-MHz bandpass filter given 
in Fig. 7.2. Starting on the left, C1 is selected for a Norton shunt transform. 
The radio button Choose Transformer Ratio (n) is selected. The reactance 
and therefore inductance value is proportional to n2. The square root of the 
ratio of L2 to L1, or 1.5288, is entered in the dialog box. The resulting 
schematic is given in Fig. 7.8. The application of the Simplify Circuit 
transform absorbs T1 into T2 and the negative C3 into the positive C4. Then, 
L1 and L2 are equal valued at 250.95 nH.  
 
 
Figure 7.8 Schematic after the application of the Norton shunt transform to the original C1. 
Norton transforms are applied to the left of each remaining inductor 
until all four inductors are of equal value. The Norton transforms are 
applied to capacitors to avoid increasing the quantity of inductors. Each 
Norton transform increases the capacitor count by one. The resulting 
schematic with all equal-valued inductors and three additional capacitors is 
given in Fig. 7.9. 
 

Norton Transforms 
45 
 
Figure 7.9 Final schematic of the 55- to 85-MHz bandpass filter with equal-valued inductors. 
7.5 The History Tab 
The History tab of the S/Filter dialog lists the selected permutation 
sequence and each transform that was applied to the filter. The History tab 
for the transforms of the previous bandpass filter is given in Fig. 7.10. The 
History tab is convenient for not only reviewing the applied transforms, but 
also to edit those transforms. Until experienced, you may apply 
inappropriate transforms, or you may use incorrect parameters. The 
History tab supports deleting, substituting, and editing of the transforms.  
 
 
Figure 7.10 History tab of the transforms applied in S/Filter. 
When a transform increases the element count, the element 
designators after that transform are automatically reassigned. In the above 
example, the first Norton shunt transform is applied to the original C1, the 

46 
Filter Synthesis Using Genesys S/Filter 
second Norton transform is applied to the capacitor with the new 
designator C4, and the final Norton transform is applied to the new C8.  
The schematic at each step in the History tab of the transform process 
is displayed by S/Filter whenever that line in the History tab is selected. 
Prior to Genesys 2014, the S/Filter dialog is not saved in the Genesys 
*.wsp workspace file. To save the S/Filter settings and the History tab it is 
necessary to save a *.SF$ file using the Start tab of the S/Filter dialog. In 
Genesys 2014 and later, the S/Filter settings are saved in the .wsx 
workspace file. 
7.6 Equate All Ls 
The previous example illustrates the combined use of Norton transforms to 
equalize all inductor values in the filter. This is a relatively common 
requirement, and so similar functions are built into the S/Filter as 
compound transforms. Four compound transforms are available: Equate 
All Ls, Equate All Cs, Equate All Shunt Ls or Shorted Stubs, and Equate All 
Shunt Cs or Open Stubs. The application of a single Equate All Ls to the 
previous initial filter results in a schematic identical to that in Fig. 7.9. 
 

 
47 
 
8 Bandpass with Resonators 
Consider the conventional bandpass filter in Fig. 4.2. This sixth-degree 
filter has three resonators. Two of the resonators are shunt, and one of the 
resonators is series. As the bandwidth narrows, the reactance of the shunt 
elements becomes low and the reactance of the series elements becomes 
high. This often leads to difficulty in the realization of the elements. 
Furthermore, realization with specific resonator technologies such as TEM-
mode coaxial resonators, piezoelectric resonators, and other devices often 
dictate that all resonators be of similar form; either all parallel or all series. 
In this chapter, techniques for designing these topologies are illustrated. 
8.1 Coupled Parallel-Resonator Filters 
One of the most popular filter topologies for the 30- to 1000-MHz 
frequency range is the parallel-resonator filter with coupling capacitors 
between resonators. Although not canonic, this topology uses a minimum 
quantity of inductors, inductors may all be equal valued, and either the 
grounded inductors or capacitors may be tuned.  
The classic text covering filters by Matthaei, Young, and Jones, still in 
print after nearly 50 years [1], reviews in detail extensions of the modern 
method for designing parallel-resonator and series-resonator filters, using 
various resonator-coupling techniques. Similar techniques are used by 
numerous software programs for designing these filters. Given in Fig 8.1 
are the top-C coupled parallel-resonator bandpass (top of figure) and the 
shunt-C coupled series-resonator bandpass (bottom) for a 0.0432-dB 
ripple Chebyshev with a 90- to 110-MHz passband. These filters are quickly 
and easily designed using the Passive Filter module of Genesys. This 
program designs lowpass, highpass, bandpass, and bandstop filters with 21 
different topologies and a wide variety of transfer approximation shapes. 
When the performance and economy of filters designed by the modern 
method are sufficient, Passive Filter is the tool of choice, since extraction 
sequences and transforms are not utilized, thus simplifying the design 
process. 
The parallel resonator and series resonator topologies are workhorse 
filters for the frequency range from HF through the lower microwave. They 
are effective and possess many desirable attributes. However, the design 
algorithms use impedance and admittance inverters that assume zero 
bandwidth. Inverters are described in Section 13.5. Design errors in the 
responses increase with increasing bandwidth. As with other bandpass 
filters designed by the modern method, these filters utilize fixed TZ 

48 
Filter Synthesis Using Genesys S/Filter 
placement and may not meet system requirements economically. The 
consequences of both the design error and inflexible TZ placement become 
worse with increasing bandwidth. 
L=100nH
L1
C=7.89pF
C2
C=15.78pF
C1
C=5.47pF
C3
L=100nH
L2
C=15.17pF
C4
C=5.47pF
C5
L=100nH
L3
C=7.89pF
C6
C=15.78pF
C7
ZO=50Ω
ZO=50Ω
 
 
C=48.95pF
C1
L=100nH
L1
C=57.86pF
C2
C=122.15pF
C3
L=100nH
L2
C=42.56pF
C4
C=122.15pF
C5
L=100nH
L3
C=57.86pF
C6
C=48.95pF
C7
ZO=50Ω
ZO=50Ω
 
Figure 8.1 A 90- to 110-MHz top-C coupled parallel-resonator bandpass (top) and shunt-C 
coupled series-resonator bandpass (bottom). 
Given in Fig. 8.2 are the responses of the 90- to 110-MHz bandpass 
filters designed in the Passive Filter module. The responses of the top-C 
coupled bandpass are given on the left, and the responses of the shunt-C 
coupled bandpass are given on the right. Inspection of the top-C coupled 
bandpass schematic in Fig. 8.1 reveals that the quantity of TZs at DC is 
seven and the quantity of TZs at infinity is one. Therefore, the selectivity of 
the response on the left in Fig. 8.2 is much greater below the passband. In 
the shunt-C coupled bandpass, the quantity of TZs at DC is one and the 
quantity at infinity is seven. Therefore, it has greater selectivity above the 
passband. 
The return loss peaks in the passband are not uniformly 20 dB. This is 
a consequence of errors in the inverter algorithms at 20% bandwidth. 
Notice that the center frequency is shifted slightly downward for the top-C 
coupled filter and slightly upward for the shunt-C coupled filter. The 
Passive Filter module of Genesys includes correction algorithms not 
included in Matthaei, Young, and Jones. Nevertheless, above 20% 
bandwidth the inverter errors become significant, and the correction 
algorithms begin to fail. In the next example, S/Filter is used for the exact 
synthesis of a parallel-resonator bandpass filter. 

Bandpass with Resonators 
49 
 
 
Figure 8.2 Responses of the 90- to 110-MHz top-C coupled bandpass (left) and the shunt-C 
coupled bandpass (right). 
8.1.1 Exact Design of a Parallel Resonator All-Pole Filter 
The design begins in S/Filter with the same passband specifications but 
with three TZs at DC and three at infinity. The extraction sequence DC ∞ ∞ 
DC DC ∞ is selected with a shunt element first. The resulting schematic is 
given in Fig. 8.3. 
L=18.88nH
L1
L=438.92nH
L2
C=135.52pF
C1
C=5.83pF
C2
C=135.52pF
C3
L=18.88nH
L3
ZO=50Ω
ZO=50Ω
 
Figure 8.3 Conventional 0.0432-dB 90- to 110-MHz passband filter with three TZs at DC and 
three TZs at infinity. 
 
 
Next, two series Norton transforms are used to convert the series 
resonator to a parallel resonator. First, inductor L2 is selected and a series 

50 
Filter Synthesis Using Genesys S/Filter 
Norton is applied. The option Choose Right Element is used to specify a 
shunt inductor equal to L1, 18.88nH, resulting in the schematic given in Fig. 
8.4. 
L=18.88nH
L1
C=135.52pF
C1
L=-100.96nH
L2
L=82.08nH
L3
L=18.88nH
L4
S=5.35
P=1
T1
C=5.83pF
C2
L=18.88nH
L5
C=135.52pF
C3
ZO=50Ω
ZO=50Ω
 
Figure 8.4 Conventional bandpass after application of a series Norton to the original L2. 
After applying Simplify Circuit, the second series Norton is applied to 
the series capacitor C2. The option Calculate n to Remove Existing 
Transformer is chosen. After Simplify Circuit is applied, the parallel-
resonator bandpass in Fig. 8.5 is displayed. 
 
C=135.52pF
C1
L=23.22nH
L1
L=82.08nH
L2
L=18.88nH
L3
C=135.52pF
C2
C=31.17pF
C3
L=18.88nH
L4
C=110.18pF
C4
ZO=50Ω
ZO=50Ω
 
Figure 8.5 Exact 90- to 110-MHz parallel-resonator bandpass filter. 
The responses of the exact 90- to 110-MHz parallel-resonator bandpass 
are given in Fig. 8.6. Notice that the return loss is uniform and equal to 20 
dB and the transmission response is more symmetric. The selectivity is 
somewhat greater below the passband. Achieving true response symmetry 
is addressed in Chapter 11. 
 

Bandpass with Resonators 
51 
 
Figure 8.6 Responses of the exact parallel-resonator bandpass filter. 
8.1.2 Termination Coupling Transforms 
The inductor values in the previous example are low for realization with 
good unloaded (element) Q at 100 MHz. This is resolved by adding series 
capacitors to couple to the 50-ohm terminations. This effectively increases 
the parallel termination resistance presented to the filter and allows a 
higher internal impedance, resulting in increased inductor values. The 
transform is given in Fig. 8.7. The shunt element is negative and must be 
absorbed by an adjacent parallel element of the same type. The element 
values are: 
2
1
n
nR
X
s
series
−
=
                                                       (8.1) 
series
series
s
shunt
X
X
R
n
X
2
2
4
+
=
                                                   (8.2) 
where n is the transformer turns ratio, Rs is the source resistance, Xseries is 
the reactance of the series element, and Xshunt is the reactance of the 
negative shunt element. At the source, n values less than 1 are used. 

52 
Filter Synthesis Using Genesys S/Filter 
 
Figure 8.7 Shunt inductor or capacitor to series-element termination-coupling transform. 
Capacitor C1 in the previous filter is swapped with L1 and the Shunt C to 
Series C Transform in the Termination Coupling group is applied to C1. 
This transform is approximate and so it is displayed as red in the transform 
tree in S/Filter. The filter center frequency of 100 MHz is entered in the 
first option and a turns ratio of 0.40 is chosen for the final option. This 
increases inductor values by
,
1
2
n
or 6.25. A Shunt C to Series C transform 
is then applied to the shunt capacitor at the load with a ratio of 1/0.40, or 
2.5. After Simplify Schematic is applied, the schematic in Fig. 8.8 results. 
 
 
C=13.9pF
C1
ZO=50Ω
L=145.14nH
L1
C=10.4121pF
C2
L=513.0034nH
L2
L=118nH
L3
C=21.68pF
C3
C=4.9875pF
C4
L=118nH
L4
C=6.2708pF
C5
C=13.9pF
C6
ZO=50Ω
 
Figure 8.8 Parallel-resonator bandpass with series-termination capacitors to increase the 
internal-filter impedance and the resulting inductor values. 
The responses are given in Fig. 8.9. Although the transform is 
approximate, for the moderate bandwidth of this filter, the return loss is 
maintained near the intended 20 dB. Notice, however, that the center 
frequency is shifted down approximately 2 MHz. This 2% shift is easily 
correctable using optimization of the resonator inductance or capacitance. 
The same optimization could be used to equalize the resonator inductor 
values if desired. 
Exact transforms do not change the TZs of a filter, while inexact 
transforms may. The Shunt C to Series C transforms added two TZs at DC. 

Bandpass with Resonators 
53 
These are false TZs, and their influence on the response is dependent on the 
degree of impedance shift. Notice that the response in Fig. 8.9 has 
somewhat greater selectivity below the passband. 
 
 
Figure 8.9 Responses of the parallel-resonator bandpass with series termination capacitors. 
8.1.3 Find Dual Transform 
Another potential solution to the small inductor values of the filter in Fig. 
8.5, which offers an exact solution, is the dual topology. This solution offers 
an identical response with larger values of inductance. Duals are 
automatically solved using the Find Dual of Schematic option in the 
Compound Operations folder of the Transform tab. The dual found using 
this transform is given in Fig. 8.10. The response is identical to Fig. 8.6. 
 
C=9.29pF
C1
L=338.81nH
L1
C=32.83pF
C2
C=7.55pF
C3
L=338.8nH
L2
L=77.93nH
L3
C=7.55pF
C4
L=275.45nH
L4
ZO=50Ω
ZO=50Ω
 
Figure 8.10 Series dual of the parallel-resonator 90- to 110-MHz bandpass. 

54 
Filter Synthesis Using Genesys S/Filter 
The History tab for transforms for the series-resonator bandpass is 
given in Fig. 8.11. This topology can also be derived by starting with a Series 
Element First extraction and applying two shunt Norton transforms to the 
shunt resonator of original filter. 
 
 
Figure 8.11 History tab for the exact series-resonator 90- to 110-MHz bandpass. 
In Section 8.1.2, the shunt to series termination-coupling transform 
illustrates using a series-coupling capacitor to increase the internal 
impedance and inductor values in the parallel-resonator filters. A related 
transform uses shunt-coupling capacitors to decrease the internal 
impedance and decrease inductor values in a series-resonator bandpass, as 
shown in Fig. 8.12. The element values are 
1
2
2
−
=
n
R
n
X
s
shunt
                                                           (8.3) 
1
2
4
1
−






+
=
s
shunt
shunt
series
R
n
X
X
X
                                             (8.4) 
where n is the transformer turns ratio, Rs is the source resistance, Xseries is 
the reactance of the series element, and Xshunt is the reactance of the 
negative shunt element. At the source, n values greater than 1 are used. The 
resonator-inductor values in series-resonator filters are reasonable except 
for wide bandwidth, and the termination-coupling transform is less 
frequently required for this filter. 

Bandpass with Resonators 
55 
 
Figure 8.12 Series capacitor or inductor-to-shunt-element termination-coupling transform. 
8.1.4 Exact Design with Like Coupling Elements 
This section describes the exact design of filters that have a topology 
identical to the popular, but inexact, resonator filters. Consider the case 
where parallel resonators and coupling capacitors are required. Four 
resonators with eight TZs are chosen: seven TZs at DC and one TZ at 
infinity. This results in greater selectivity below the passband. If greater 
selectivity is required above the passband, parallel resonators with coupling 
inductors or series resonators with shunt coupling capacitors are used. 
Design begins with any extraction sequence with one parallel resonator 
and alternating series capacitors and shunt inductors. An example is given 
in Fig. 8.13. The extraction sequence is DC ∞ DC DC DC DC DC DC. 
Because this filter has an odd number of TZs at both DC and infinity it is 
classified as symmetric, and the final design can have equal input and 
output terminations, so the transformer and difficult element values are 
ultimately resolved. The shunt parallel resonator may be in any other 
position, so other extraction sequences are useable. 
 
L=17.27nH
L1
C=147.41pF
C1
C=4.99pF
C2
L=518.13nH
L2
C=98.6e-3pF
C3
L=25883.85nH
L3
C=3.27e-3pF
C4
L=804909.95nH
L4
S=4.63e-3
P=1
T1
ZO=50Ω
ZO=50Ω
 
Figure 8.13 Initial bandpass with seven TZs at DC and one at infinity. 

56 
Filter Synthesis Using Genesys S/Filter 
Forming the next parallel resonator requires a capacitor in parallel with 
L2. A series Norton is applied to C2 with the right element chosen similar to 
C1. The negative element left of C2 is absorbed into C1. The value chosen is 
not critical as the shunt inductors are equalized as a final step. The 
schematic given in Fig. 8.14 results after the application of the first series 
Norton transform. 
 
Figure 8.14 Bandpass after application of the first series Norton. 
After applying Simplify Circuit, a series Norton is applied to the next 
series capacitor. This process is repeated until the final shunt inductor has 
a parallel-resonating capacitor. 
8.1.5 The Equate All Shunt Ls or Shorted Stubs Transform 
Finally, the transform in the Compound Operation folder entitled Equate 
All Shunt Ls or Shorted Stubs is applied. This adjusts the impedance level 
throughout the filter to equate all shunt inductors. The final filter is given 
in Fig. 8.15. If a unity ratio transformer is produced because of digital 
precision, it is deleted or absorbed into the load by an S/Filter transform. 
This design is exact. 
 
 
Figure 8.15 Exact capacitor-coupled bandpass with equal inductors. 

Bandpass with Resonators 
57 
8.1.6 Termination-Coupled Bandpass 
Again, the small inductor values are difficult to realize with good unloaded 
Q at 100 MHz. Therefore, the termination-coupling algorithm is applied as 
described in Section 8.3. The resulting filter is given in Fig. 8.16 and the 
responses are given in Fig. 8.17. As expected with most TZs at DC, the 
selectivity below the passband is high. The termination coupling transforms 
are approximate, and this design is not exact. The worst-case return loss is 
18 dB rather than 20 dB, and the return loss is not equal ripple. 
Optimization corrects the return loss if necessary. 
 
Figure 8.16 Bandpass with like-coupling elements and termination coupling. 
 
Figure 8.17 Responses of the filter with like-coupling elements and termination coupling. 

58 
Filter Synthesis Using Genesys S/Filter 
8.2 Coupled Series-Resonator Filters 
The parallel-resonator filter with coupling capacitors has greater selectivity 
below the passband than above the passband. If greater selectivity is 
desired above the passband, then coupling inductors are used. However, 
this increases the quantity of inductors significantly. Another solution for 
greater high-side selectivity is series-resonator filters with shunt coupling 
capacitors. If design begins with a parallel-resonator top-C coupled 
bandpass and the Find Dual transform as described in Section 8.1.3 is used, 
the resulting filter has series resonators but shunt coupling inductors. The 
design of series-resonator bandpass filters with shunt-coupling capacitors 
is covered next. 
8.2.1 The Basic Series-Resonator Bandpass 
 Consider a three-resonator 90 to 110 MHz bandpass (sixth degree) with 
two shunt-coupling capacitors. The Series Element First option is selected, 
and the canonic form synthesized by S/Filter with the extraction sequence 
DC ∞ ∞ ∞ ∞ ∞ is given in Fig. 8.18. 
 
L=338.83nH
L1
ZO=50Ω
C=7.64pF
C1
C=173.78pF
C2
L=14.73nH
L2
C=4127.52pF
C3
L=0.6nH
L3
S=23.73
P=1
T1
ZO=50Ω
 
Figure 8.18 Initial canonic bandpass with one TZ at DC and five at infinity. 
Next, a shunt-Norton transform is applied to C2. A transformer turns 
ratio is selected equal to the square root of L2/L1, or 0.2085, to equalize the 
value of the first and second inductors. A shunt-Norton transform is then 
applied to the last shunt capacitor with a turns ratio selected to eliminate 
the transformer. Because the filter is naturally symmetric, this equates the 
last inductor to the other two. Because of digital precision, the inductor and 
capacitor values may be slightly different. They are manually equalized if 
desired. The resulting schematic is given in Fig. 8.19. 
 

Bandpass with Resonators 
59 
L=338.83nH
L1
C=9.17pF
C1
C=36.23pF
C2
L=338.83nH
L2
C=12.08pF
C3
C=36.27pF
C4
L=338.1nH
L3
C=9.19pF
C5
ZO=50Ω
ZO=50Ω
 
Figure 8.19 Series-resonator bandpass after application of two shunt Norton transforms to the 
shunt capacitors. 
These series inductor values are reasonable for a 100-MHz filter. 
However, as the bandwidth is reduced, the inductor values become larger. 
If the inductor values are too large, or if a specific inductor value is desired, 
the Termination Coupling: Source: Series C to Shunt C is applied after 
swapping L1 with C1. To set the series inductors to 180 nH, the transform is 
applied with a turns ratio equal to the square root of 338.83/180, or 1.372. 
The load termination coupling transform is then applied to the final series 
capacitor with a turn ratio the inverse of the source ratio. Simplifying the 
circuit to eliminate the transformers produces the schematic in Fig. 8.20. 
C=29.9pF
C1
L=180nH
L1
C=23.66pF
C2
C=68.19pF
C3
L=180nH
L2
C=22.73pF
C4
C=68.27pF
C5
L=179.61nH
L3
C=23.74pF
C6
ZO=50Ω
ZO=50Ω
C=29.9pF
C7
 
Figure 8.20 Series-resonator bandpass with termination coupling capacitors to reduce and set 
the inductors at a specific value. 
8.2.2 Tubular Bandpass 
Another effective filter topology, popular in radio systems design, is the 
tubular bandpass. These inline filters, with connectors on each end, offer 
low loss, excellent temperature stability, and excellent stopband 
performance at reasonable cost. They typically are used in the 50- to 5000-
MHz frequency range with bandwidths from 4% to 40%. They are 
manufactured in a unique form that is described after the schematic is 
generated. 

60 
Filter Synthesis Using Genesys S/Filter 
Consider the basic series-resonator shunt-C coupled bandpass in Fig. 
8.19. Capacitor C3 is split into two equal capacitors using the Basic 
Operation: Split Series Element with the 2 Equal Pieces option. The left 
capacitor is then swapped with L2. After swapping L3 and the final series 
capacitor, two capacitor tees are formed with the shunt capacitors. The 
transform Basic Operations: Pi-Tee-L: Tee: Tee to Pi is applied to each 
capacitor Tee. The resulting topology is given in Fig. 8.21. 
 
L=338.83nH
L1
C=4.78pF
C1
C=3.18pF
C2
C=12.58pF
C3
L=338.83nH
L2
C=12.58pF
C4
C=3.19pF
C5
C=4.79pF
C6
L=338.1nH
L3
ZO=50Ω
ZO=50Ω
 
Figure 8.21 Filter topology known as the tubular bandpass created from the series-resonator 
bandpass. 
Only exact transforms are used to create this topology, so the 
responses, as given in Fig. 8.22, are exact. 
 
  
Figure 8.22 Responses of the sixth-degree tubular bandpass. 

Bandpass with Resonators 
61 
8.2.3 Manufacture of the Tubular Bandpass 
The internal structure used to manufacture this filter is given in Fig. 8.23. 
The solid black material is metal that forms the outer shield and the 
capacitive slugs. The capacitive slugs are isolated from the outer shield with 
dielectric material (shown as gray) to form the shunt capacitors. Dielectric 
disks isolate adjacent slugs to form the series capacitance. The inductors 
are connected to the slugs and input/output connectors and are supported 
by the dielectric rod. The inductors are modeled accurately as helical 
transmission lines. The shielded inductors do not radiate and have high Q 
when constructed with larger diameters. The slugs shield the inductors 
from coupling, and the small housing size reduces package waveguide 
modes, resulting in excellent stopband performance. Proper selection of 
metallic and dielectric materials results in excellent temperature 
performance. Tuning is accomplished by compressing or spreading the 
inductors though small access holes in the shield. An outer shield covers 
the tuning holes. 
 
Dielectric support rod
Dielectric spacers
Metal slugs and housing
Wire helical inductor
 
Figure 8.23 Physical structure of the tubular bandpass filter. 
8.2.4 Generalized Series-Resonator Bandpass 
Fig. 8.24 shows the initial canonic filter for a 90- to 110-MHz generalized 
shunt-C coupled bandpass of the sixth degree with 40-dB minimum 
rejection in the lower stopband and 30-dB minimum rejection in the upper 
stopband. The extraction sequence is 134 MHz ∞ 60 MHz DC. 
 

62 
Filter Synthesis Using Genesys S/Filter 
L=135.68nH
L1
L=1624.47nH
L3
L=233.42nH
L2
C=6.04pF
C1
C=1.57pF
C2
L=196.94nH
L4
C=23.93pF
C4
S=1.39
P=1
T1
C=35.73pF
C3
ZO=50Ω
ZO=50Ω
 
Figure 8.24 Generalized bandpass of the sixth degree with FTZs below and above the 
passband. 
The element values are reasonable, although the value of L3 is 
somewhat large. The transformer can be removed and the response almost 
recovered by optimization. To create a filter with all series resonators, the 
transformer is removed by applying a shunt-Norton transform to C3 and L4 
with the Calculate n to Remove Transformer option. This transforms the 
final branch from a series capacitor to a series L-C and it reduces L3 
slightly. At this point, a shunt-Norton transform applied to C1 and L2 adds 
only one more capacitor, significantly reduces L3, and results in all series 
resonators. This choice is particularly attractive if a manufacturing 
technology is available with high-Q resonators that are only series form. 
The resulting schematic is given in Fig. 8.25 and the exact responses are 
given in Fig. 8.26. 
 
L=252.39nH
L1
C=12.09pF
C1
ZO=50Ω
L=116.71nH
L2
L=260.42nH
L3
C=12.09pF
C2
C=9.52pF
C3
L=136.58nH
L4
L=242.28nH
L5
C=51.52pF
C4
C=8.71pF
C5
ZO=50Ω
 
Figure 8.25 Generalized bandpass converted to series resonators. 

Bandpass with Resonators 
63 
 
Figure 8.26 Responses of the generalized series-resonator bandpass. 
8.2.5 Tunable Constant-Bandwidth Bandpass 
Because the parallel-resonator bandpass filter with capacitive coupling 
elements is popular, it is tempting to use this topology for the design of 
tunable bandpass filters. Because each resonator has a shunt inductor, 
replacing the shunt capacitors with back-to-back varactor diodes requires a 
minimum of decoupling elements to apply the tuning voltage. An example 
schematic for a 100-MHz bandpass with 10-MHz bandwidth is given in Fig. 
8.27a, where capacitors C2, C4, and C6 would be replaced with back-to-back 
varactors. The responses of this filter with these capacitors adjusted to tune 
the filter to 75, 100, and 125 MHz are given on the left in Fig. 8.28. The 
filter is synthesized for 100 MHz, and the response is as expected at that 
frequency. However, tuning the capacitors to shift resonance does not 
result in appropriate values for the other elements. As a result, the 
responses are severely degraded with tuning. 
The primary difficulty is that as the frequency is tuned lower, for 
constant bandwidth, the coupling should be increased. At 100 MHz, the 
bandwidth is 10%. At 75 MHz, 10% bandwidth is only 7.5 MHz. To achieve 
constant bandwidth, the percentage bandwidth at 75 MHz must be 13.3%. 
The reactance of the capacitive-coupling elements increases as the 
frequency is reduced, which actually reduces rather than increases the 
bandwidth. The inverse situation exists when the frequency is tuned higher. 

64 
Filter Synthesis Using Genesys S/Filter 
 
 
 
Figure 8.27 Potential tunable bandpass filter topologies. 
The situation is significantly improved by utilizing a filter with 
inductive coupling elements as shown in Fig. 8.27b. In this case, as the 
frequency is tuned lower, the reduced inductive reactance increases the 
coupling and increases the percentage bandwidth. Responses are given on 
the right in Fig. 8.28. This filter has the disadvantage of increased inductor 
count, but it has much improved responses. The dual of this filter, a series-
resonator bandpass with shunt coupling elements also tunes well and 
returns the inductor count to three, but applying a tuning voltage to the 
series varactors requires additional coupling and decoupling elements. 

Bandpass with Resonators 
65 
 
Figure 8.28 Responses of the parallel-resonator bandpass filter with tuning with capacitive 
coupling elements (left) and with inductive coupling elements (right). 
As can be seen on the right in Fig. 8.28, the bandwidth compensation is 
not perfect, and the bandwidth is still too narrow as the frequency is tuned 
lower. Placing capacitors in parallel with the coupling inductors, as shown 
in Fig. 8.27c, increases the branch reactance as resonance is approached. 
This further compensates the bandwidth. This filter could be synthesized 
using a FTZ for each coupling branch. However, the correct frequency of 
the FTZs is unknown. In this case, the filter is synthesized as shown in Fig. 
8.27b and small capacitors are manually added in parallel with the coupling 
inductors. Next, two additional instances of the original filter are copied 
into the same schematic. These additional filters used ports three and four 
and ports five and six. The tuning capacitors are optimized individually for 
each filter, and all remaining elements are optimized to the same values 
using variables. The optimization goals are given in Fig. 8.29. 
The final values are given in Fig. 8.27c and the responses are given in 
Fig. 8.30. Although not ideal, the bandwidth is relatively constant and a 
better than 16-dB return loss is achieved with 60% tuning bandwidth. The 
achievable performance degrades with increased tuning bandwidth. 
 
 

66 
Filter Synthesis Using Genesys S/Filter 
 
Figure 8.29 Goals for the simultaneous optimization of the tunable filter at three frequencies. 
 
 
Figure 8.30 Responses of the bandwidth-compensated and optimized tunable bandpass. 

Bandpass with Resonators 
67 
Reference 
[1] G. Matthaei, L. Young, and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Dedham, MA, 1980. 
 
 


 
69 
 
9 TEM-Mode Resonators 
With narrow bandpass filters, insertion loss often dominates the design 
process. The solution requires higher unloaded (element) Q. Element Q is 
typically dominated by metal conductivity. Higher volume increases 
element Q. For a given volume, solenoid inductors typically have a higher 
element Q than distributed transmission line elements (TLEs). However, 
parasitics limit the allowable physical size of wire-wound inductors. 
Transmission lines have higher unloaded Q than inductors when they are 
physically larger [1]. 
Hybrid filters combine L-C elements and TLEs. These filters are readily 
designed using the Lumped to Distributed Equivalent group of transforms 
in S/Filter. Lumped and distributed equivalents and their theory are 
covered in HF Filter Design and Computer Simulation [2]. These 
transforms are approximate, but over the narrow bandwidth typically 
involved in this filter class, they are sufficiently accurate. In this chapter, 
the parallel-resonators discussed in Chapter 8 are transformed into TLE 
resonators in order to provide higher resonator unloaded Q. 
9.1 Filter Insertion Loss 
Well below the cutoff frequency, the dissipative insertion loss of all-pole 
lowpass filters, due to finite unloaded Q, is given approximately by [2] 
∑
=
=
−
=
N
n
n
n
ave
u
g
Q
dB
L
I
1
34
.4
)
.(
.
                                                  (9.1) 
where Qu-ave is the average unloaded Q of the elements, N is the prototype 
order, and gn are the lowpass prototype g-values of the transfer 
approximation from prototype tables. The sum of the g-value is very 
roughly equal to N+1.5 for Butterworth and low-ripple Chebyshev 
approximations. The sum is 6.47 for a fifth-order Butterworth and 6.49 for 
a fifth-order 0.0432-dB ripple Chebyshev. For a fifth-order lowpass with an 
average element unloaded Q of 50, the dissipative insertion loss is roughly 
0.56 dB. 
The expression for the dissipative insertion loss of an all-pole bandpass 
filter is similar, except the loss is multiplied by the filter loaded Q (Ql). It is 
important to recognize the difference between loaded and unloaded Q. 
Loaded Q is a design parameter dependent on the filter bandwidth. The 
loaded Q is 

70 
Filter Synthesis Using Genesys S/Filter 
BW
f
Ql
0
=
                                                                    (9.2) 
At midband, the dissipative insertion loss of all-pole bandpass filters is 
∑
=
=
−
=
N
n
n
n
ave
u
l
g
Q
Q
dB
IL
1
34
.4
)
(
                                                 (9.3) 
A fifth-order bandpass with a 4% bandwidth has a loaded Q of 1/0.04, 
or 25. With the same average unloaded Q as before, the midband insertion 
loss is 14 dB. Decreasing bandwidth requires ever-higher element unloaded 
Q to avoid excessive insertion loss. 
9.2 Filter Using 50-Ohm Coaxial Resonators 
This example is a 900-MHz bandpass filter with capacitive coupling and 
resonators constructed from shorted sections of 50-ohm coaxial line with 
air dielectric. Consider the following filter specifications: 
1) Nominal termination resistances: 
50 ohms 
2) Maximum passband return loss: 
20 dB 
3) Insertion loss midband maximum: 2.5 dB 
3) Lower passband cutoff frequency: 895 MHz 
4) Upper passband cutoff frequency:  905 dB 
5) Minimum rejection <880 MHz: 
60 dB 
6) Minimum rejection >920 MHz: 
60 dB 
The quantity of TZs at infinity is set to one. Using the initial L-C filter 
designed in S/Filter, the quantity of TZs at DC is increased until the 
specification is met with an odd quantity of TZs. Nine TZs are required, 
which is five resonators. The inductor Q is adjusted until the midband 
insertion loss is just met. The required inductor Q is 505. 
9.2.1 Lumped to Distributed Equivalents 
The equivalence between a parallel L-C resonator and a shorted 
transmission line stub is [2] 
πω
0
4Z
L =
                                                                   (9.4) 
where the transmission line is 900 long at the L-C resonant frequency. 
For 50-ohm coaxial line, the required inductance is 11.26 nH. A five-
resonator filter is designed using the series Norton transform as described 
in Sections 8.5 and 8.6. The resulting filter is given in Fig. 9.1. 
  

REM-Mode Resonators 
71 
 
Figure 9.1 Five-resonator narrow bandpass filter to be converted to a coaxial resonator filter. 
Next, the resonator inductors are scaled up to 11.26 nH by using the 
transform Termination Coupling: Source: Shunt C to Series C at 900 MHz 
and n equal to 0.09476, which is the inverse of the square root of the target 
inductor value and the initial inductor value. The Load: Shunt C to Series C 
transform is then applied with the inverse of the source value for n, or 
10.55. The result is given in Fig. 9.2. 
 
 
Figure 9.2 Narrow bandpass after the termination coupling transforms to increase the value of 
the inductors. 
The values of the internal coupling capacitors are very small. If the 
coaxial resonators are to be coupled using capacitive probes, these values 
are appropriate. If the coaxial resonators are to be mounted on a printed-
circuit boad (PCB), the coupling capacitors could be printed as interdigital 
microstrip gaps. If chip capacitors are to be used, the values are 
unreasonable. This is addressed in the next section covering microstrip 
resonators. 
The next step is converting the parallel L-C resonators to coaxial 
resonators using the Lumped to Distributed Equivalents: Parallel LC to 
Ground to Grounded Stub transform. The result is given in Fig. 9.3. The 
transform in S/Filter uses a transform frequency equal to the resonant 
frequency of the parallel L-C network. This is appropriate for many 
applications. However, this results in a slightly different characteristic 
impedance for each distributed resonator. Here, 50-ohm characteristic 
impedance is desired for each resonator. This is resolved by manually 
changing each resonator to 50 ohms and optimizing the response. The 

72 
Filter Synthesis Using Genesys S/Filter 
parallel L-C to grounded stub algorithm is approximate, so optimization is 
good practice anyway. 
 
 
Figure 9.3 Narrow bandpass with parallel L-C resonators transformed to coaxial resonators. 
Given in Fig. 9.4 is the filter after setting each resonator to 50 ohms 
and optimizing the length of the resonators. 
 
 
Figure 9.4 Narrow bandpass after setting each resonator to 50 ohms and optimizing the 
resonator lengths. 
9.2.2 The Convert Using Advanced Tline Routine 
The final step is converting the grounded stubs into physical TLEs. This is 
accomplished using the Convert Using Advanced TLine routine in the 
Genesys environment. All five grounded stubs are selected and the Convert 
Using Advanced TLine routine is selected in the Schematic tab of Genesys. 
The dialog in Fig. 9.5 is displayed. 
 

REM-Mode Resonators 
73 
 
Figure 9.5 Convert Using Advanced TLine dialog. 
This routine coverts the grounded stub transmission line model with 
electrical parameters into the selected physical transmission line model, in 
this case coax, using the previously defined substrate material Air. The Air 
material is defined by adding a Substrate in the workspace tree of Genesys. 
The dielectric in this case is air. The coax outer diameter determines the 
line loss and therefore the unloaded Q. Earlier, S/Filter was used to 
determine that the required unloaded Q required to achieve a dissipative 
insertion loss of 2.5 dB is 505. The unloaded Q of a quarter wave coaxial 
resonator due to conductor loss is 
(
)
a
b
a
b
b
MHZ
f
Qc
+
×
=
1
ln
)
(
10
513
.1
4
                                      (9.5) 
where b is the outer diameter in meters, a is the center conductor diameter 
in meters, and f(MHz) is the frequency in megahertz. For a 50-ohm coaxial 
line with air dielectric, b/a is 2.3. To achieve an unloaded Q of 505 requires 
coax with an outer conductor of 4.4 mm. For margin, an outer conductor 
diameter of 5 mm is specified in the Convert Using Advanced TLine dialog. 
The resulting responses are given in Fig. 9.7. 
 

74 
Filter Synthesis Using Genesys S/Filter 
 
Figure 9.6 Coaxial bandpass with electrical line models converted to physical line models. 
 
Figure 9.7 Responses of the 50–ohm coaxial resonator bandpass. 
9.3 Generalized Bandpass Using Ceramic Resonators 
The true power of direct synthesis lies in the ability to place transmission 
zeros at arbitrary frequencies. In this example, ceramic-loaded coaxial 
resonators are used with the placement of one FTZ above the passband to 
increase selectivity close to the passband. A 950- to 1000-MHz bandpass is 
required with attenuation of at least 50 dB below 840 MHz and above 1050 
MHz. TransTech 1000 series high-profile (HP), ceramic-loaded, square-
coaxial resonators are used. The characteristic impedance of these 
resonators is 25.3 ohms and the unloaded Q at 975 MHz is just over 900. 

REM-Mode Resonators 
75 
A four-resonator filter is eighth degree. Each FTZ adds two degrees, 
and each nonfinite TZ adds one degree, so one finite and six nonfinite TZs 
are specified. The FTZ is manually adjusted to achieve the rejection 
requirement at 1050 MHz. The initial S/Filter specification screen is given 
in Fig. 9.8 and the initial L-C filter with the extraction DC 1050 ∞ DC DC 
DC DC is given in Fig. 9.9. 
 
 
Figure 9.8 Specification tab for the generalized bandpass using ceramic-loaded coaxial 
resonators. 
L=0.45nH
L1
C=58.63pF
C1
L=3.41nH
L2
C=6.74pF
C2
C=0.96pF
C3
C=9.26e-3pF
C4
L=2888.85nH
L3
L=1.33e+6nH
L4
C=20.1e-6pF
C5
S=581e-6
P=1
T1
ZO=50Ω
ZO=50Ω
 
Figure 9.9 Initial L-C filter for the proposed generalized ceramic-loaded coaxial resonator. 
9.3.1 Creating Parallel Resonators 
The first step is converting C3, L3, and L4 to shunt resonators. A series 
Norton is applied to C2 and L2. It is valid to apply the Norton transform to 
not only individual reactors but to a parallel or series pair as well. A turns 
ratio greater than one is chosen so that the negative parallel L-C elements 

76 
Filter Synthesis Using Genesys S/Filter 
are absorbed into L1 and C1 and positive L-C values occur on the right. The 
turns ratio value is not critical as the shunt inductors are equalized later. 
Here, n equal to two is entered. Series Norton transforms are then applied 
to the two remaining series capacitors to place capacitance in parallel with 
the remaining shunt inductors. Again, n is not critical, and a value of 10 is 
specified. Next, Remove Existing Transformer is applied. Finally, the 
transform Compound Operations: Equate All Shunt Ls or Shorted Stubs is 
applied. The schematic with parallel shunt resonators is given in Fig. 9.10. 
 
Figure 9.10 Generalized bandpass before the termination coupling and coaxial-resonator 
transforms. 
9.3.2 Shifting the Internal Impedance Level 
Next, the source and load termination coupling transforms are applied to 
shift the impedance level up so that the shunt inductors are 5.258 nH to 
satisfy Eq. 9.4 and the 25.3-ohm characteristic impedance of the Trans 
Tech resonators. 
  
 
Figure 9.11 Generalized bandpass after impedance scaling by termination coupling to 
increase the shunt inductor values. 
The two internal series coupling capacitors are a small value. If this is 
manageable, then the steps in the next section are skipped.  

REM-Mode Resonators 
77 
9.3.3 The Pi to Tee Transform: Increasing Coupling Caps 
If coupling-capacitance values are excessively small, the following 
transforms are applied. Inductor L4 is swapped with capacitor C6. Both C4 
and C6 are then split into additional capacitors with 0.5-pF capacitors on 
each side of C5 by using the Basic Operation: Split-Shunt Element 
transform. Then the Basic Operation: Pi to Tee transform is applied to this 
pi of capacitors. The capacitor value is increased to 1.03 pF. The same 
process is applied to capacitor C7, creating another Tee with a capacitor 
value of 1.08 pF. 
9.3.4 Converting the Parallel L-C to Coaxial Resonators 
The parallel L-C resonators are next converted to transmission lines using 
the Lumped to Distributed Equivalents: Parallel LC to Ground to Ground 
Stub transform. Because S/Filter adjusts w in Eq. 9.4 to the frequency of 
each parallel L-C, the characteristic impedance of each line is slightly 
different from 25.3 ohms. Because the termination coupling and parallel L-
C to grounded stub routines are approximate, the final step is optimization. 
Therefore, each ground stub is manually changed to a 25.3-ohm 
characteristic impedance. 
9.3.5 Optimizing the Values 
The last step is optimization to correct the response after application of 
approximate transforms and setting each coaxial resonator at 25.3 ohms. 
Selected for optimization are the resonator line lengths, the FTZ branch 
values of L1 and C2, the two shunt coupling capacitors, and the two 
termination coupling capacitors. Because L1 is realized as a wound 
inductor, its Q is set at 100. The unloaded Q of the resonators is 
automatically determined by the conductivity, dielectric, and dimensional 
parameters of the square coaxial resonator model. The final filter after 
optimization is given in Fig. 9.12 and the responses are in Fig. 9.13. 
 

78 
Filter Synthesis Using Genesys S/Filter 
 
Figure 9.12 Final schematic of the generalized ceramic-loaded coaxial resonator bandpass 
with one FTZ. 
 
Figure 9.13 Responses of the ceramic-loaded coaxial resonator bandpass. 
9.4 Ceramic Bandpass with Two FTZs 
In this example, the previous bandpass is extended to a filter with FTZs 
both above and below the passband, resulting in steeper transitions on both 
sides of the passband. Again, the target filter contains four ceramic 
resonators. In this case, the specification begins with three TZs at DC and 
one at infinity. The FTZs are manually tuned to 899 and 1064 MHz to 
achieve the desired Amin of 50 dB. The initial schematic with an extraction 
sequence of DC 1064 ∞ DC 899 DC is given in Fig. 9.14a. 

REM-Mode Resonators 
79 
 
 
 
 
Figure 9.14 Transform steps for the four-section ceramic-resonator bandpass with FTZs 
above and below the passband. 

80 
Filter Synthesis Using Genesys S/Filter 
The following transforms complete the design. 
1) A Norton: Series Transform is applied to C2 and L2 with a specified 
transformer turns ratio of 2.0 followed by a Simplify Schematic. This 
effectively places an inductor in parallel with the second shunt 
capacitor. 
2) A Norton: Series Transform with a transformer turns ratio of 20 is 
applied to the series capacitor now designated C4 followed by a 
Simplify Schematic. This places a capacitor in parallel with the third 
shunt inductor. 
3) A Norton: Series Transform is applied L5 and C6 with the option to 
calculate n to remove the existing transformer. This places a capacitor 
in parallel with the final shunt L. 
4) The Compound Operations: Equate All Shunt Ls or Shorted Stubs is 
applied. This filter is symmetric so if a transformer remains, the turns 
ratio is near unity and the transformer is deleted. The resulting 
schematic is given in Fig. 9.14b. 
5) Basic Operations: Swap Element is applied to L1 to place C1 adjacent 
to the input. 
6) Termination Coupling: Source: Shunt C to Series C is applied to C1 
and the complementary transform is applied at the load. Next, 
Simplify Schematic eliminates the transformers. The resulting 
schematic is given in Fig. 9.14c. 
7) Lumped to Distributed Equivalents: Parallel LC to Ground to 
Grounded Stub is applied to each parallel resonator. This creates 
grounded stubs with electrical parameters. 
The four-grounded stubs are converted to coaxial resonators with 
square outer conductors using Advanced TLine. To realize Trans-Tech 
high-profile resonators a substrate is created with a relative dielectric 
constant of 10.5. Because S/Filter adjusts w in Eq. 9.4 to the frequency of 
each parallel L-C, the characteristic impedance of each line is slightly 
different from 25.3 ohms. Because the termination coupling and parallel L-
C to grounded stub routines are approximate, the final step is optimization. 
Therefore, the outer-side dimension and inner diameter of each resonator 
are manually changed to 12 mm and 3.3 mm, respectively, before 
optimization of the resonator lengths. The final schematic is given in Fig. 
9.14d and the responses are given in Fig. 9.15. 

REM-Mode Resonators 
81 
 
Figure 9.15 Initial synthesized ideal lumped bandpass with two FTZs (right) and after 
transformation to coaxial resonators (left). 
References 
[1] R. Rhea, “Technology Enables New Components,” Microwave Journal, 
November 2006. 
[2] R. Rhea, HF Filter Design and Computer Simulation, Noble 
Publishing(SciTech), Raleigh, NC, 1994. 
[3] G. Matthaei, L. Young, and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Dedham, MA, 1980. 
 


 
83 
 
10 Piezoelectric Devices 
Quartz and ceramic bulk-mode vibrational resonators offer extremely 
high-unloaded Q and excellent temperature and long-term stability. These 
attributes are critical for very narrow bandwidth applications. However, the 
equivalent electrical model parameters for these mechanical-vibration 
devices pose unique issues. This chapter illustrates bandpass filters that 
utilize these devices and includes a larger number of examples than 
previous chapters because of the unique difficulties in synthesizing filters 
with piezoelectric devices. 
10.1 Quartz-Crystal Device Model 
This section describes and models bulk-mode quartz piezoelectric 
resonators, often referred to as quartz crystals. 
10.1.1 Physical Form of the Quartz Crystal 
Fig. 10.1 shows diagrams and photographs of the physical form of a typical 
quartz crystal. The fundamental and overtone shear modes are illustrated 
in the diagram. 
 
 
Figure 10.1 Diagram of quartz-crystal resonator illustrating electrodes on a quartz blank, and 
the fundamental and overtone shear vibrational modes (left), and a photograph [1] of the 
resonator and  a metallic housing (right). 

84 
Filter Synthesis Using Genesys S/Filter 
The fact that mechanical vibration in quartz, and certain other 
materials, produces an electrical signal is referred to as piezoelectricity. It is 
reciprocal in that an electrical signal can induce a mechanical change. Even 
a small mechanical displacement occurring at such a high frequency, and 
the rigidity of the quartz, results in tremendous energy storage.  
10.1.2 Insertion Response of a Quartz Crystal 
Given in Fig. 10.2 is the transmission amplitude response swept in the 
frequency range near the fundamental-mode of a 9.6-MHz quartz crystal, 
inserted in series in a 50-ohm measurement system. The vertical scale is 10 
dB/div and the horizontal scale is 10 kHz/div. The peak of transmission on 
the left at 9.600 MHz is the series-resonant mode of the quartz crystal. The 
null to the right of this peak at 9.620 MHz is the parallel-resonate mode of 
the quartz crystal. The remaining inflections in the response to the right are 
spurious modes. This entire pattern of series, parallel, and spurious modes 
repeats at odd overtones of the fundamental frequency. They are referred to 
as overtones rather than harmonics because they are approximately, but 
not precisely, odd integer multiples of the fundamental frequency. 
 
 
Figure 10.2 Transmission amplitude response of the fundamental-mode of a 9.6-MHz quartz 
crystal. 
10.1.3 Modeling the Quartz Crystal 
An electrical model for the fundamental series and parallel-mode activity is 
given in Fig. 10.3. The capacitor C0 results from the metallic electrodes on 
the quartz blank. It is referred to as the static capacitance because it is not 
derived from vibration. It is measured with a low-frequency capacitance 
meter.  

Piezoelectric Devices 
85 
Cm
Rm
Lm
Co
 
Figure 10.3 Electrical model for quartz-crystal resonators. 
The parameters in the series R-L-C branch are referred to as motional 
parameters because they represent the electrical equivalent of the 
piezoelectric effect. Because the energy storage is tremendous, the value of 
the motional inductance is extremely large, typically many milliHenries and 
potentially as large as a Henry. Parasitics would preclude realizing these 
inductance values as wire-wound inductors. The motional capacitance 
resonates with the motional inductance at the series-resonant frequency of 
the quartz crystal. The motional resistance ranges from approximately 500 
ohms at 1 MHz downward to as low as 10 ohms at 20 MHz, and somewhat 
higher for overtone modes. The unloaded Q is extremely high, not because 
of low resistance, but because of extremely high reactance. More exhaustive 
modeling of piezoelectric resonators is given in [1]. 
Increasing the resonant frequency requires decreasing the thickness of 
the quartz blank. Above 20 to 30 MHz, the blank becomes so thin that it 
becomes too fragile for practical application. Operation through the ninth 
overtone extends the useful frequency range to about 200 MHz. A special 
manufacturing technique can produce inverted-mesa resonators that 
operate to about 600 MHz. Nevertheless, quartz-crystal filters are typically 
confined to 140 MHz or less, and fundamental mode filters up to 20 MHz 
are the most common. 
10.1.4 Calculating Model Parameters from the Response 
The four parameters of the quartz-crystal model in Fig. 10.3 are calculated 
from the measured static capacitance and the quartz-crystal insertion 
response. The static capacitance is measured with a low-frequency 
capacitance meter. Then the  motional capacitance is given by 








−






=
1
2
0
s
p
m
f
f
C
C
                                                        (10.1) 
and 
(
)
m
s
m
C
f
L
2
2
1
π
=
                                                           (10.2) 

86 
Filter Synthesis Using Genesys S/Filter 
Then assuming the reactance of C0 is much greater than Rm 




−
=
1
10
2
20
0
IL
m
Z
R
                                                    (10.3) 
where Z0 is the characteristic impedance of the measurement system and IL 
is the decibel insertion loss at the series-resonant transmission peak. 
10.1.5 The Quartz-Crystal Model and Filter Design 
The characteristics of wire-wound inductors are far different from the 
quartz crystal. A design that mixes quartz and L-C resonators is dominated 
by the poorer unloaded Q and stability of the inductors. Capacitor unloaded 
Q and stability in the frequency range of quartz-crystal filters is often 
acceptable. Therefore, quartz-crystal filter design typically includes the 
piezoelectric resonators and capacitors. An exception is when discrete 
inductors are used in quartz-crystal filters as described in Section 10.3. 
10.2 Quartz-Crystal Filter Approximate Design 
The extreme values of the motional branch elements, and the presence of 
the static capacitance, require that the filter topology comply with the 
model topology. This results in a more involved synthesis and transform 
process. For certain applications, the design procedure can ignore the static 
capacitance. The static capacitance is added after synthesis and before 
simulation to assess the effect on the response and make corrections if 
necessary. This design approach is simpler and is illustrated first. 
The measured static capacitance of the 9.6 MHz quartz crystal in Fig. 
10.2 is 5.45 pF. From Eq. 10.1, the motional capacitance is 22.73 fF and 
from Eq. 10.2 the motional inductance is 12.0920062 mH. The insertion 
loss at series resonance in the 50-ohm system is 0.95 dB. The reactance of 
C0 at 9.6 MHz is 3042 ohms, significantly higher than Rm, so Eq. 10.3 is 
valid and Rm is 11.56 ohms. The unloaded Q of the crystal resonator is the 
motional reactance divided by the motional resistance, which is 63,100. 
These parameters are the basis for the design of a 9.600- to 9.602-MHz 
four-section quartz crystal bandpass filter. This is a loaded Q of 
9.601/0.002, or 4,800. 
The series resonator of the motional branch is the defining element, so 
the static capacitance is temporarily ignored. Therefore, a series-resonator 
filter topology with shunt coupling capacitors is selected. Design begins 
with the S/Filter Specification tab in Fig. 10.4. The motional resistance is 
modeled by specifying the unloaded Q of the motional branch as the 
unloaded Q of the inductor. A maximally flat transmission-amplitude 
approximation (Butterworth) is used with cutoffs defined as 3.01-dB 
attenuation for the lossless case. 

Piezoelectric Devices 
87 
 
Figure 10.4 Specification tab for the approximate design four-section quartz-crystal bandpass. 
The initial synthesis with a series element first and the extraction 
sequence ∞ DC ∞ ∞ ∞ ∞ ∞ ∞ is given in Fig. 10.5. The topology is identical 
to the shunt-C coupled series-resonator bandpass filter introduced in 
Section 8.2, and the design proceeds as before. Shunt-Norton transforms 
are applied to the shunt capacitors to equate the series inductors and 
remove the transformer. The element values are displayed with eight-digit 
precision because of the extremely high Q of the design. The high stability 
of quartz justifies this expectation of precision. 
  
L=3.0452454e+6nH
L1
C=0.0902371pF
C1
L=0.0934436nH
L2
C=231.36976e+12pF
C3
L=1.1876835e-9nH
L3
C=7.5401426e+21pF
C4
L=36.444144e-18nH
L4
S=289.06617e+9
P=1
T1
C=2.9407491e+6pF
C2
ZO=50Ω
ZO=50Ω
 
Figure 10.5 Initial synthesis of the four-section quartz-crystal bandpass. 
The results after the three shunt-Norton transforms are given in Fig. 
10.6. The value of the series inductors is approximately 3 mH, far too large 
to realize as wire-wound inductors but consistent with quartz crystals. 

88 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.6 Quartz-crystal bandpass after conversion to series resonators. 
The next step is shifting the impedance level higher by the ratio of the 
quartz-resonator motional inductance and these schematic values. In this 
case, the termination resistance is increased to 198.5 ohms. The results are 
given in Fig. 10.7. 
 
Figure 10.7 Quartz-crystal bandpass after increasing termination resistance to 198.5 ohms. 
At this low frequency, the higher impedance can often be 
accommodated by higher-impedance amplifiers. Alternatively, a simple 
matching network or a 4-to-1 impedance transformer could step 50 ohms 
up to 200 ohms. Matching network design using S/Filter is covered in 
Chapter 12. 
The first and last resonators are loaded with the reactance of one 
shunt-coupling capacitor while the internal resonators are loaded by two 
coupling capacitors. This results in different resonant frequencies for the 
two groups of resonators. The resonant frequency of each series inductor 
and capacitor pair are given in Fig. 10.7. The filter could be built with two 
different quartz crystals. Alternatively, provided the difference in resonant 
frequency is small, a single quartz-crystal with a series resonant frequency 
of 9599.618 kHz could be used with a capacitor in series with resonators 
one and four to increase those branches’ frequency to 9600.159 kHz. This is 
illustrated in Fig. 10.8. These frequency-shifting capacitors are then tuned 
to achieve a maximally flat response by observing the return loss. The series 
L-C networks are replaced with the quartz-crystal model, which includes 
the motional resistance and static capacitance. The termination resistance 
and capacitor values are set to standard values. 

Piezoelectric Devices 
89 
C=130pF
C2
ZO=200Ω
Co=5.45pF
Cm=.02273182pF
L=12.092mH
R=11.6Ω
X1
C=200pF
C1
Co=5.45pF
Cm=.02273182pF
L=12.092mH
R=11.6Ω
X2
C=200pF
C4
Co=5.45pF
Cm=.02273182pF
L=12.092mH
R=11.6Ω
X3
C=130pF
C6
ZO=200Ω
Co=5.45pF
Cm=.02273182pF
L=12.092mH
R=11.6Ω
X4
C=200pF
C7
 
Figure 10.8 Quartz-crystal bandpass with standard values and identical quartz resonators. 
The response of the 9.6- to 9.602-quartz-crystal filter is given in Fig. 
10.9. The static capacitance adds four finite-frequency TZs at 9.62 kHz that 
are not involved in the initial synthesis. Their effect is to increase the 
selectivity above the passband and slightly reduce the bandwidth. The 
narrow bandwidth of this filter could not be achieved with L-C resonators 
because extremely high-unloaded Q is required in the resonators. The 
loaded Q of the shunt coupling elements is not critical. 
 
 
Figure 10.9 Responses of the four-section quartz crystal 9.6- to 9.602-MHz filter designed by 
approximate methods. 

90 
Filter Synthesis Using Genesys S/Filter 
10.3 Nulling the Static Capacitance 
It is parallel resonance in the quartz crystal and the resulting TZ in the 
response above the passband that causes the simplified design procedure in 
Section 10.2 to be approximate. It is the extreme values of the motional 
inductance and motional capacitance that causes very high unloaded Q in 
the quartz crystal. The static capacitance is a moderate value and it can be 
nullified with a moderate inductor value. For the 9.6 MHz quartz-crystal 
example, the 5.45-pF static capacitance is nulled with a 50.326-uH inductor 
in parallel with the quartz crystal. This value of inductance is practical at 
9.6 MHz using inductors wound on cores with permeability greater than 
one. The schematic of the previous quartz-crystal bandpass with nulling 
inductors is given in Fig. 10.10. 
 
Figure 10.10 A 9.6-MHz quartz-crystal filter with nulling inductors. 
The responses of the quartz-crystal filter with nulling inductors is given 
in Fig. 10.11. Compared to the quartz-crystal filter response without nulling 
in Fig. 10.9, the response is more symmetric due to a lack of TZs above the 
passband. Notice the bandwidth is now equal to the design value of 2 kHz 
because the parallel resonances have not constricted the upper side of the 
passband. 
The responses in Fig. 10.11 are a composite of 100 Monte Carlo runs 
with a Gaussian distribution of 5% standard deviation for the four nulling 
inductors, and with an unloaded inductor Q of 100. The result illustrates 
the relatively low sensitivity of the nulling inductors despite the loaded Q of 
4800 for the filter. 
 

Piezoelectric Devices 
91 
 
Figure 10.11 Responses of the quartz-crystal bandpass with inductors to null the static 
capacitance. Monte Carlo analysis displays the results of multiple simulations with 5% 
tolerance-nulling inductors. 
10.4 Design of a Lower-Sideband Crystal Filter 
As the bandwidth is increased, the frequency of the quartz-crystal parallel-
resonant mode approaches the upper cutoff of the filter. This results in 
increasing error when ignoring the static capacitance during the design 
process. In this section, the design of a 5-kHz bandwidth lower-sideband 
crystal filter is illustrated using a crystal similar to the 9.6-MHz quartz 
crystal modeled earlier in the chapter. The design considers the static 
capacitance, which then improves the accuracy of the design.  
The specified termination impedance is 50 ohms. The final termination 
resistance is much higher and this is dealt with in a later step. The specified 
unloaded Q is specified as one million and resonator loss is dealt with later. 
The desired passband is 9.600 to 9.605 MHz. The desired stopband is 80 
dB attenuation from 9.607 to 9.612 MHz. To create a topology consistent 
with the quartz-crystal resonator model, no TZs are specified at DC or 
infinity. All extractions are inexact because nonfinite TZs are unavailable 
for extraction after the FTZs. This results in unequal passband ripple, 
which is dealt with later in the design. The maximum allowable passband 
ripple, 0.25 dB, is entered, and FTZs are added and adjusted until the 
stopband attenuation requirement is achieved. Four FTZs result in four 
quartz-crystal resonators. The S/Filter Specification tab is given in Fig. 
10.12, the initial synthesis solution is given in Fig. 10.13, and the responses 
are given in Fig. 10.14.  
 

92 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.12 Specification tab for the four-section lower-sideband moderate-bandwidth 
quartz-crystal filter. 
 
Figure 10.13 Schematic of the four-section quartz-crystal filter as initially synthesized. 
Crystal filters are often employed in communication receivers and 
transmitters. The narrow bandwidth of amplitude-modulated voice, 
continuous-wave (CW) channels, and low-data rate systems, combined with 
the desirability of high IF frequencies for image rejection and IM 
performance, require quartz-crystal filters. This filter is referred to as a 
lower sideband because the greater rejection is above the passband in the 
regions of the carrier and upper sideband. 
 

Piezoelectric Devices 
93 
 
Figure 10.14 Responses of the four-section lower-sideband quartz-crystal filter. 
The first series inductor in Fig. 10.13 is used to create a shunt 
termination coupling inductor using the Termination Coupling: Source: 
Series L to Shunt L transform. A transform frequency at mid-passband, or 
9.6025 MHz is specified, followed by a turns ratio, n, of two. This value is 
not critical but must be within the specified range. The Simplify Circuit 
transform is applied followed by the Compound Operations: Find Dual of 
Schematic transform. The resulting schematic is given in Fig. 10.15. 
 
Figure 10.15 Schematic of the lower-sideband filter after the termination coupling and final 
dual transforms are applied. 
The next step creates capacitors in series with the first parallel-
resonant branch by applying a shunt-Norton transform to capacitor C2 in 
Fig. 10.15. Any transform turns ratio is acceptable that results in a left 
series capacitor that can be absorbed in capacitor C1. One option is selecting 

94 
Filter Synthesis Using Genesys S/Filter 
n so that this negative capacitor is exactly absorbed in C1 resulting in 
eliminating one capacitor. That value of n is just greater than 
1
2
1
1
C
C
nnull
+
=
                                                         (10.4) 
which in this case is 0.88789169. If n is just slightly larger than this value, 
the resulting capacitor value is extremely large and is deleted  
The left side part of the schematic resulting from this transform is given 
in Fig. 10.16. The form of the branch with L1, C3 and C4 is referred to as a 
dipole. With appropriate values, it is exactly equivalent to the quartz-crystal 
model dipole given in Fig. 10.3.  
L=1.319633nH
L1
C=810.530659pF
C5
C=2.2843906e+9pF
C1
ZO=50Ω
C=21.455715pF
C2
C=169.928106pF
C3
C=207975.150197pF
C4
 
Figure 10.16 Left-side portion of the schematic resulting from the application of the shunt-
Norton transform. 
Unfortunately, this dipole transform is not included in the many 
S/Filter transforms. The transform is given in Fig. 10.17 and Eqs. 10.5 
through 10.10. 
 
 
Figure 10.17 Synthesized and quartz-crystal dipoles with transform designators. 



+
=
3
4
4
1
1
C
C
C
C
                                                       (10.5) 

Piezoelectric Devices 
95 
4
3
2
C
C
C
+
=
                                                             (10.6) 














+
=
2
4
3
3
2
1
C
C
C
L
L
                                                   (10.7) 





+
=
C
C
C
C
1
2
3
1
                                                        (10.8) 



+
=
1
2
2
4
1
C
C
C
C
                                                         (10.9) 
(
)
2
2
2
1
1
2






+
=
C
C
C
L
L
                                                   (10.10) 
Substituting the values of the 9.6-MHz quartz-crystal resonator in 
Section 10.2, the required values of the left dipole in Fig. 10.16 are 
C1=1315.758 pF, C2=5.472670 pF, and L1=208.5877 nH. The value of L1 in 
Fig. 10.14 is now 1.319633 nH. To realize this filter using quartz-resonators 
similar to the 9.6-MHz quartz-crystal resonator requires that this value is 
raised to 208.5877 nH. This is accomplished by increasing the termination 
resistance in the Specification tab by the ratio of these values. Therefore, 
the termination resistance is increased to 7903.247 ohms. 
C=0.13574pF
C1
ZO=7903.247Ω
L=208.587744nH
L1
C=1315.757626pF
C3
C=2.465795pF
C4
C=3.245273pF
C5
L=208.587744nH
L2
C=1315.565905pF
C6
C=5.13692pF
C7
C=3.353582pF
C8
L=208.587744nH
L3
C=1315.114158pF
C9
C=8.056066pF
C10
L=208.587744nH
L4
C=1314.498515pF
C12
ZO=1481.042992Ω
C=3.018671pF
C11
C=1.389559pF
C2
 
Figure 10.18 Lower-sideband quartz-crystal filter after equating all inductors, deleting the 
original C1 and absorbing the transformer into the load resistance. 
The remaining series branches could be transformed to the correct 
form by applying shunt-Norton transforms to C5, C7, and then C9. However, 
applying the Compound Operations: Equate All Ls transform completes all 
three remaining transforms automatically. The schematic after deleting C1 

96 
Filter Synthesis Using Genesys S/Filter 
and absorbing the transformer into the loaded resistance is given in Fig. 
10.18. The values of C2, C5, C8, and C11 result in static capacitance in the 
quartz-crystal resonator dipoles that are smaller than the desired quartz-
crystal model. Therefore, these capacitors are split into two capacitors, one 
that becomes the static capacitance and one that can serve as tuning 
elements. Using Eqs. 10.8 through 10.10, the required value of capacitance 
in series with L1 and C3 in Fig. 10.18 that results in a static capacitance of  
5.45 pF in the quartz-crystal dipole is found to be 5.47267 pF. The 
transform Basic Operations: Split Series Element: Specify Left Value is 
applied with a left value of 5.47267 pF. The remainder is 1.862453 pF. 
These steps are applied to the remaining three resonator branches. The 
results after converting the dipoles to quartz-crystal resonator models are 
given in Fig. 10.19. 
 
Figure 10.19 Lower-sideband quartz-crystal 9.600- to 9.605-MHz bandpass. 
The resulting termination resistances are high. If these resistances 
cannot be accommodated by the source and load circuitry of the system 
then matching networks are employed. Because the filter is narrowband, 
broadband matching techniques are not required, and simple two-element 
networks are used. Because no TZs at DC and infinity are used in this 
design, the low- and high-frequency attenuation is poor. Therefore, both 
highpass and lowpass matching networks are used. Genesys includes an 
optional match synthesis program for designing these and much more 
difficult matching networks. Chapter 12 discusses the use of S/Filter to 
design matching networks. The final lower-sideband quartz-crystal 
bandpass filter with 50-ohm terminations is given in Fig. 10.20. All 
capacitors are placed on the nearest standard values. Because of the 
extreme values of termination resistance, tuning of the matching network 
inductors might be required in production if the return loss response is 
critical.  

Piezoelectric Devices 
97 
 
Figure 10.20 Lower-sideband bandpass with matching to 50-ohm terminations. 
Given in Fig. 10.21 are the responses of the final lower-sideband filter 
with unloaded inductor Q specified as 100. This Q has a small influence on 
the response as it improves the return loss without adding significant 
insertion loss. Unloaded capacitor Q in excess of 1000 has very little effect 
on the responses. 
 
 
Figure 10.21 Responses of the final lower-sideband quartz-crystal bandpass. 
10.5 Upper-Sideband Quartz-Crystal Filter 
The ladder filter with series quartz-crystal resonators in Fig. 10.20 is a 
common form because it is relatively easy to design, at least for narrow 
bandwidth, using the prevalent modern method of filter design. However, it 
naturally results in a lower-sideband form. Upper-sideband quartz-crystal 
filters are realized using the parallel-resonant mode of quartz crystals in 
shunt. The series resonance then forms TZs below the passband. The 
design of this type of filter is illustrated in this section. 

98 
Filter Synthesis Using Genesys S/Filter 
Given in Fig. 10.22 is the initial Specification tab for the proposed 
upper-sideband filter. The TZs are placed to achieve the desired responses 
given in Fig. 10.23. 
 
 
Figure 10.22 Specification tab for the upper-sideband quartz-crystal filter. 
The initial schematic for the extraction sequence 9.599  9.5983  9.5948 
DC ∞ is given in Fig. 10.24. Th e strategy is to apply a series Norton 
transform to the first three series capacitors to place capacitance in parallel 
with each series L-C to ground. These branches then have a topology that 
conforms to the quartz-crystal model. However, applying a series Norton to 
C1 with a positive capacitor to its right results in an unrealizable negative 
capacitor in shunt at the input. Therefore, it is necessary to create a shunt 
capacitor at the input that later will absorb the negative capacitance created 
by the series Norton. To create the input shunt capacitor a Termination 
Coupling: Source: Series C to Shunt C transform is applied to C1. This 
transform is approximate, but at the extreme narrow bandwidth of a 
quartz-crystal filter, the transform is nearly exact. The result with n=1.6 is 
given in Fig. 10.25. The value of n is not critical and is selected between the 
limits suggested by the S/Filter dialog. 
 

Piezoelectric Devices 
99 
 
Figure 10.23 Responses for the upper-sideband quartz-crystal filter. 
 
Figure 10.24 Initial schematic of the synthesized upper-sideband filter. 
It is then feasible to begin the series-Norton transforms. In the 
description of the remaining transforms, the designators refer to those that 
are created after the application of the previous transform. A Simplify 
Schematic is applied after any transform that adds a transformer. The 
transforms beginning with the filter in Fig. 10.25 are: 
1) A series Norton is applied to C2 with n>1 so that a positive capacitor is 
placed in parallel with the first series L-C to ground. Larger n results 
in a higher filter input impedance. n=1.2 is chosen. 

100 
Filter Synthesis Using Genesys S/Filter 
2) The source and load resistance in the Specification tab are increased 
by the ratio of the desired motional inductance, 12.092 mH, to the 
current value of L1. The resistance is 345.743738 ohms. L1 now equals 
the desired motional inductance. C3 is too large to equal the static 
capacitance. This is dealt with later. 
3) A series Norton is applied to C5 with n equal to the square root of the 
ratio of L2 and the desired motional inductance. n is 2.378502692. 
4) A series Norton is applied to C8 with n equal to the square root of the 
ratio of L3 to the desired motional inductance. n is 4.099802122. At 
this point, each of the shunt inductors equals the desired motional 
inductance, but L4 is too large in value. 
5) C10 is swapped with the L3/C9 branch. 
6) C10 is split, specifying the left value as the quartz-crystal static 
capacitance of 5.45 pF. 
7) A shunt Norton is applied to capacitor C11 with n equal to the square 
root of the ratio of L4 to the motional inductance. n is 8.035702256. 
8) C3 is then split with the left value specified as 5.45 pF. It is then 
swapped to be adjacent to the series L-C to ground. 
9)  C7 is treated in a similar fashion. 
10) The transformer is absorbed into the load. 
The result of these transforms is given in Fig. 10.26. The shunt 
resonators are all of the form of quartz-crystal resonators with the desired 
static capacitance and motional inductance. The final series resonator is 
also the desired motional inductance. Each of these quartz crystals is 
manufactured with the series resonant frequency equal to the resonant 
frequency calculated from the motional inductance and capacitance of that 
branch. The range of frequencies is 9594.727 to 9599.580 kHz. The series 
resonator does not have a parallel capacitor corresponding to the static 
capacitance. This is dealt with shortly. 
Next, each corresponding group of elements is replaced by a quartz-
crystal model with motional resistance as shown in Fig. 10.27. The static 
capacitance of the series resonator is included. In addition, each discrete 
capacitor is replaced with the nearest standard value. These replacements 
have only a minor effect on the return loss. 

Piezoelectric Devices 
101 
 
Figure 10.25 The upper-sideband filter after application of the Termination Coupling transform 
at the input. 
 
Figure 10.26 Upper-sideband filter after application of transforms preparing for replacement of 
resonators with quartz crystals. 

102 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.27 The upper-sideband quartz-crystal filter with standard values for the discrete 
capacitors. 
The responses of this final filter are given in Fig. 10.28. The motional 
resistance has introduced an approximately 1.7-dB insertion loss. The 
traces labeled “with Co” are with the static capacitance added to the series 
quartz crystal, and the traces labeled “original” are with a 50.3-uH nulling 
inductor in parallel with the quartz crystal. The designer may choose the 
more desirable response. The fact that the termination resistances are not a 
standard value is dealt with as in Section 10.2. 
 
 
Figure 10.28 Responses of the upper-sideband quartz-crystal filter. Transmission responses 
are with the static capacitance (solid line) and with the static capacitance nulled by a 50.3-uH 
inductor (dashed line). 

Piezoelectric Devices 
103 
10.6 Filters with TZs Above and Below the Passband 
When a more symmetric response is required, either the static capacitance 
is nulled, or in the case of generalized bandpass filters, TZs are added both 
above and below the passband. This section illustrates the design of a 
quartz crystal bandpass filter with one TZ below and one TZ above the 
passband. The filter is 1-kHz bandwidth centered at 9.605 MHz. TZ zeros 
are specified as given in Fig. 10.29 to create the responses given in Fig. 
10.30. The extraction sequence ∞ 9.5989  9.6021 ∞ ∞ ∞ ∞ DC results in the 
initial schematic given in Fig. 10.31. 
The elements C2, L2, and C3 are already the correct topology for a 
quartz-crystal model. However, the elements L3 and C4 are nonconforming. 
In the following list of transforms, the designators refer to those created 
after the previous transforms is applied. Simplify Schematic is applied after 
any transform that adds a transformer. The transforms are: 
1) Both termination resistances in the Specification tab are increased by 
the ratio of the desired motional inductance to the inductance of L1, or 
53.595266 ohms.  
2) A shunt Norton is applied to capacitor C2. The resulting negative 
capacitor on the left must absorb into C1 with a positive result. n equal 
to 0.1 is chosen. 
3) A series Norton is applied to capacitor C3 to create a capacitor in 
parallel with L2 and C4. The turns ratio is the square root of the ratio of 
L2 to the desired motional inductance. n equals 2.405301029. 
4) A shunt Norton is applied to capacitor C7 with n equal to 28.0222, the 
square root of the ratio of L4, and the desired motional inductance. 
5) A shunt Norton is applied to capacitor C10 with n equal to 13143.6, the 
square root of inductor L5, and the desired motional inductance. 
6) Capacitor C5 is split with the left value specified as the desired static 
capacitance, or 5.45 pF. 
7) Eqs. 10.8 through 10.10 are used to find the values of C7, C8, and L3 
that convert to the desired quartz-crystal model parameters. C7 is 
adjusted to so that the motional inductor in the equivalent quartz-
crystal model equals the desired motional inductance. In this case, C7 
equals 13.25082 pF. Capacitor C7 is split with this left value. 
8) Capacitor C7 is swapped with capacitor C8. 
9) The transformer is absorbed into the load. 
 

104 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.29 Specification tab for a quartz-crystal filter with one TZ below and one TZ above 
the passband. 
 
Figure 10.30 Desired responses of the quartz-crystal filter with two FTZs. 

Piezoelectric Devices 
105 
 
Figure 10.31 Initial synthesized schematic of the quartz-crystal filter with two FTZs. 
The resulting schematic is given in Fig. 10.32. L2, C4, and C5 are ready 
for replacement with a quartz-crystal resonator. When the network of C8, 
C9, and L3 is replaced with the quartz crystal using Eqs. 10.8 through 10.10, 
the motional values are correct. The required parallel capacitance is 
13.22806 pF, of which 5.45 pF is the quartz-crystal static capacitance and 
7.77806 pF is an added capacitor in parallel with the quartz crystal. The 
three remaining series resonators are replaced with quartz crystals, and the 
static capacitance is nulled using parallel inductors as before. 
The final schematic with quartz-crystal resonators and nulling 
inductance is given in Fig. 10.33. In addition, discrete capacitors and the 
termination resistance are set to standard values. An exception to standard 
values is the capacitor C5 in parallel with X3. Unless the return loss is not 
critical, this value is somewhat sensitive and possibly needs trimming in 
production. The series-resonant frequency specified for manufacture of the 
quartz-crystals range from 9593.848 to 9600.214 kHz. 
The responses for the final quartz-crystal filter are given in Fig. 10.34. 
Standard values, dissipation, and effects of the nulled static capacitance 
shift the passband up about 50 Hz. This could be compensated by shifting 
the resonant frequency specification of each quartz crystal down 50 Hz. 

106 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.32 Schematic of the filter with two FTZs ready for quartz-crystal resonators. 
 
Figure 10.33 Final quartz-crystal filter with FTZs below and above the passband. 
 

Piezoelectric Devices 
107 
 
Figure 10.34 Responses of the final quartz-crystal filter with FTZ below and above the 
passband. 
10.7 Wide-Bandwidth Quartz-Crystal Filters 
The bandwidth of quartz-crystal filters is generally restricted to less than 
the series/parallel inter-resonance spacing. This is 20 kHz for the example 
9.6-MHz quartz crystal. In practice, difficulties arise with bandwidths even 
less than this theoretical upper limit. Given in Fig. 10.35 is a 10-kHz 
bandwidth filter with one TZ at DC, five TZs at infinity, one TZ at 9.592 
MHz below the passband, and one TZ at 9.618 MHz above the passband. 
The design of this filter follows the same procedure as described in the 
previous section. The difficulty is that the required quartz-crystal static 
capacitance for X3 is 2.077596 pF. This is not feasible for the type of quartz 
crystal exemplified by the 9.6 MHz sample. For this filter, the problem is 
resolvable by nulling only a portion of the static capacitance. The 
susceptance of the 5.45 static capacitance is 0.328907 mS. The susceptance 
of the 2.0776-pF parallel capacitance required by the filter synthesis is 
0.125383 mS. An inductor in parallel with the quartz-crystal with the 
difference of 0.203524 mS causes the net effective capacitance to be 2.0776 
pF. This is an 80.415-uH inductor as shown in Fig. 10.35. 
 

108 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.35 Quartz-crystal resonator filter with a 10-kHz bandwidth. 
The response of the resulting filter is given in Fig. 10.36. The finite 
unloaded Q of the susceptance canceling inductor results in limited 
attenuation at the TZ above the passband. Otherwise, the 10-kHz 
bandwidth quartz-crystal design is successful. 
 
 
Figure 10.36 Responses of the wide-bandwidth quartz-crystal filter with partial nulling of X3 to 
realize a small static capacitance requirement. 
10.8 Very Wide-Bandwidth Quartz-Crystal Filters 
The next case considers very wide-bandwidth quartz-crystal filters where 
the passband must exceed the series/parallel inter-resonant spacing of the 
quartz crystal. The filter schematic given in Fig. 10.37 is a three-section 
9.625- to 9.675-MHz quartz-crystal filter. The 50-kHz passband is a factor 
of 2.5 times than the interresonant spacing of the example 9.6-MHz crystal. 

Piezoelectric Devices 
109 
It is necessary to null the parallel-resonant modes of the quartz crystals 
because the resulting TZs lie in the passband. Therefore, three 50.3-uH 
inductors are placed in parallel with the quartz crystals. 
 
C=5.306757pF
C2
Co=5.45pF
Cm=0.022591pF
L=12.092mH
R=11.6Ω
X1
L=50.3μH
L4
Co=5.45pF
Cm=0.022687pF
L=12.092mH
R=11.6Ω
X3
C=5.306762pF
C4
Co=5.45pF
Cm=0.022591pF
L=12.092mH
R=11.6Ω
X2
L=50.3μH
L5
L=50.3μH
L6
ZO=2914.5Ω
ZO=2914.5Ω
 
Figure 10.37 Schematic of the very wide-bandwidth quartz-crystal filter. 
The responses are given in Fig. 10.38. The results are satisfactory from 
about 9.25 to 10.05 MHz. However, well below and well above the passband 
the rejection decreases. Examination of the schematic in Fig. 10.37 reveals 
that when the static capacitance of the quartz crystals is considered, the 
quantity of TZs at DC is zero and the quantity at infinity is only one. 
Consequently, the attenuation at these frequency extremes is very poor. 
Notice that the very wide-bandwidth results in a high termination 
resistance. This is used to advantage in the next step by adding matching 
networks with a loaded Q of 50 at the input and output to match this filter 
to 50-ohm terminations. The schematic after optimization for best response 
and placing elements on standard values is given in Fig. 10.39 and the 
responses are given in Fig. 10.40 with an unloaded Q of 100 for all 
inductors. The high Q of the matching networks results in most of the 
passband insertion loss and probably requires tuning of one of the elements 
in each matching network.  
Although narrow bandwidth quartz-crystal filters are less susceptible to 
stopband issues, whenever inductors are used to null the static capacitance, 
it is wise to simulate the attenuation well into the stopbands. 
 

110 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.38 Responses of the very wide-bandwidth quartz-crystal filter. 
ZO=50Ω
ZO=50Ω
L=1000nH
L1
C=330pF
C2
C=6.2pF
C3
C=6.2pF
C4
L=49.2μH
L3
L=53.3μH
L4
L=48.5μH
L5
L=1000nH
L2
C=330pF
C5
C=1500pF
C1
C=1500pF
C6
Co=5.45pF
Cm=0.022565pF
L=12.092mH
R=11.6Ω
X1
Co=5.45pF
Cm=0.022621pF
L=12.092mH
R=11.6Ω
X3
Co=5.45pF
Cm=0.022565pF
L=12.092mH
R=11.6Ω
X2
 
Figure 10.39 Very wide-bandwidth quartz-crystal filter with matching networks and standard 
values for discrete elements. 
The static capacitance of the quartz-crystal posses special issues for 
filter design, particularly at wider bandwidths. However, filters with loaded 
Q over 100 cannot use purely L-C elements. In this case, L-C networks are 
used merely to clean the stopbands of a quartz-crystal filter.  

Piezoelectric Devices 
111 
 
Figure 10.40 Responses of the completed very-wide quartz-crystal filter. 
10.9 Ceramic-Piezoelectric Resonators 
A more elegant solution to the problem of filter bandwidths that lie 
between the optimum range for L-C and quartz-crystal resonators is to use 
ceramic piezoelectric resonators. These piezoelectric resonators are not to 
be confused with the ceramic-loaded coaxial resonators illustrated in 
Chapter 9. A piezoelectric material such as lead zirconium titanate replaces 
the quartz of quartz crystals. Ceramic resonators are typically used in the 
0.4- to 60-MHz frequency range with common application for 455-kHz and 
10.7-MHz IF filters. Multisection monolithic filters are common, but 
individual resonators may also be also used to construct filters. The loaded 
Q of ceramic resonators is typically in the 500 to 1000 range. 
The electrical equivalent model is identical to that of a quartz crystal, so 
the same terminology is used here. The parameters of an 11.607-MHz 
ceramic resonator, determined from the measured transmission response 
using Eqs. 10.1 through 10.3 are Rm=4.1 ohms, Lm=44.9805 uH, Cm=4.18 
pF, and C0=28.6 pF [1]. The unloaded Q is the motional reactance divided 
by the motional resistance, or 800 in this case. 
Because the model is identical to the quartz-crystal model, the 
constraints and available design techniques are similar. Consider the design 
of a four-section 100-kHz bandwidth filter centered at 11.6 MHz using a 
ceramic resonator similar to the unit just described. The design generally 
follows procedures used for the filter in Section 10.6 with single TZs below 
and above the passband but with three rather than five TZs at infinity. 
Beginning with the extraction sequence ∞ 11.488 11.712 ∞ ∞ DC, the 
transforms, minus step 5, result in the schematic given in Fig. 10.41.  

112 
Filter Synthesis Using Genesys S/Filter 
 
Figure 10.41 Schematic of the ceramic-resonator filter after application of transforms to the 
original extraction. 
The first and last resonators are replaced with ceramic resonators. The 
static capacitance is then nulled with 6.574 uH inductors. The dipole 
consisting of C5, C6, and L2 is ready for replacement with a ceramic 
resonator. When the dipole consisting of C7, C8, and L3 is replaced with the 
piezoelectric dipole using Eqs. 10.8 through 10.10, the values are ready for 
replacement with a ceramic resonator. However, the required static 
capacitance is higher than provided by the resonator. This is corrected by 
placing additional capacitance, C4, in parallel with the resonator. The 
ceramic resonator filter, after placing discrete capacitors on standard 
values is given in Fig. 10.42 and the responses are given in Fig. 10.43. 
 
Figure 10.42 Ceramic-resonator filter after replacing L-C dipoles with ceramic resonators. 

Piezoelectric Devices 
113 
 
Figure 10.43 Final responses of the ceramic-resonator filter. 
The final filter has a TZ at DC and one at infinity, so the stopband 
attenuation remains at least 50 dB through 50 MHz except for a false 
passband about 15 dB down around 4.4 MHz. If necessary, this false 
passband could be eliminated with matching networks that shift the 25.14-
ohm termination resistance. 
Reference 
[1] R. Rhea, Discrete Oscillator Design: Linear, Nonlinear, Transient, and Noise 
Domains, Artech House, Norwood, MA, 2010.  


 
115 
 
11 Symmetry 
Symmetry has two important manifestations in electrical filters: 
physical symmetry with element types and values mirrored with respect to 
the input and output, and response symmetry with equal selectivity above 
and below the passband [1]. Physical symmetry reduces the number of 
unique elements that are modeled, ordered, tested, stocked, picked, and 
assembled. For distributed element filters that are electromagnetically 
simulated, physical symmetry can reduce the required execution time and 
memory by a factor of 16 in simulators that take advantage of symmetry.  
The conventional all-pole bandpass filter with equal quantities 0f TZs 
at DC and infinity has geometric response symmetry. If the transmission 
amplitude response is plotted on a logarithmic-frequency scale, the slope of 
the transition regions below and above the passbands are equal. However, 
more often arithmetic symmetry is desired. Arithmetic symmetry results in 
group-delay symmetry. 
11.1 Physical Symmetry 
Physical symmetry can be achieved using the modern method of filter 
design for the first three classes of filters listed below, but direct synthesis 
is required for the last two classes. 
1) A Butterworth transfer approximation. 
2) Odd-order Chebyshev transfer approximation. 
3) Coupled-resonator bandpass filters with one TZ at DC and an odd 
quantity of TZs at infinity, or an odd quantity of TZs at DC and one TZ 
at infinity. 
4) Lowpass filters with FTZ pairings and an odd quantity of TZs at 
infinity. 
5) Bandpass filters with odd and equal quantities of nonfinite TZs and 
with paired FTZs below or above (not both) the passband. 
11.1.1 A Lowpass Filter with FTZ Pairings 
Consider case four in the above list. A lowpass filter is required that passes 
DC to 32 MHz with a maximum passband ripple of 0.1 dB (16.4-dB return 
loss) and a minimum rejection of 60 dB above 50 MHz. This requirement 
requires a tenth-degree all-pole lowpass with five inductors and five 
capacitors. This requires five unique values of inductors and five unique 
values of capacitors and results in dissimilar input and output impedance. 

116 
Filter Synthesis Using Genesys S/Filter 
The better solution is 11-th degree that adds only one capacitor (a total of 
six), but requires only three unique values of inductors and capacitor, and 
results in equal input and output impedance. An even better solution is a 
symmetry preserving lowpass with three TZs at infinity and two TZs at 54 
MHz. The Specification tab is given in Fig. 11.1 and the schematic for the 
extraction sequence 54 ∞ ∞ 54 ∞ is given in Fig. 11.2. This solution only 
requires three inductors. Given in Fig. 11.3 are the responses of this filter. 
The rejection specification is achieved with considerable margin. 
 
 
Figure 11.1 Specification tab for the value-symmetric lowpass created with two-paired FTZs. 
C=90.41pF
C1
L=264.69nH
L1
C=32.82pF
C2
C=190.03pF
C3
L=400.52nH
L2
C=190.03pF
C4
L=264.69nH
L3
C=32.82pF
C5
C=90.41pF
C6
ZO=50Ω
ZO=50Ω
 
Figure 11.2 Schematic of the value-symmetric lowpass. 

Symmetry 
117 
 
Figure 11.3 Responses of the value-symmetric lowpass. 
11.1.2 A Bandpass Filter with FTZ Pairings 
With case five in the above list, paired FTZs may exist either above or below 
the passband, but not both. Therefore, this case is useful when increased 
selectivity is required either above or below the passband. Consider the 
following 455-kHz IF bandpass filter with 30-kHz bandwidth. The S/Filter 
Specification tab is given in Fig. 11.4 and the resulting schematic with the 
extraction sequence 0.37 ∞ 0.37 DC is given in Fig. 11.5 . The responses of 
the 455-kHz bandpass filter is given in Fig. 11.6. 
Fortunately, for case five in the above list, the extraction sequences that 
result in value symmetry have a unity transformer turns ratio. 
Unfortunately, particularly for narrow bandwidth, this type of filter is 
susceptible to extreme element values, and large inductor or capacitor 
value ratios. For example, the inductor values are unreasonably small for 
the shunt-element first version of this filter. The Series Element First form 
has rather large inductor values, but this is consistent with realization using 
toroid or pot-core inductors, which also offer better unloaded Q at this 
frequency than air-cored inductors. 
 

118 
Filter Synthesis Using Genesys S/Filter 
 
Figure 11.4 Specification tab for the 455-kHz bandpass with paired FTZs below the 
passband. 
C=1346.458pF
C1
L=280533.943nH
L1
L=8.44e+6nH
L2
C=14.475pF
C3
L=280533.943nH
L3
C=1346.458pF
C5
ZO=50Ω
ZO=50Ω
C=659.556pF
C2
C=659.556pF
C4
 
Figure 11.5 Schematic of the 455-kHz bandpass. 

Symmetry 
119 
 
Figure 11.6 Responses of the 455-kHz bandpass. 
11.2 Response Symmetry 
The conventional all-pole bandpass has an equal number of TZs at DC and 
infinity. As shown in Fig. 4.2, when plotted with an arithmetic frequency 
scale, the response has greater selectivity below the passband. The response 
is symmetric with a logarithmic frequency scale; however, arithmetic 
symmetry is often required. The transmission amplitude response is 
directly related to the transmission phase response for ladder networks 
with no bridging elements. Arithmetic symmetry results in group-delay 
symmetry. For topologies that are not symmetric, the selectivity inequity 
worsens with increasing bandwidth. For narrow bandwidth filters, 
symmetry may not be a significant issue. For wide bandwidth filters, a 
solution is often required. 
Blinchikoff [2] offers a proof that for bandpass filters transformed from 
lowpass prototypes of order N, symmetry results when the quantity of TZs 
at DC equals N/2. For example, with N equal to four, the degree of the 
bandpass is eight. For symmetry, the quantity of TZs at DC is two and the 
quantity at infinity is six. Another way of stating this is that the quantity of 
TZs at infinity should exceed the quantity at DC by a factor of three. 
Blinchikoff then proceeded to describe topologies and tables for 
designing a few specific filters that meet this criteria. The ability to 
arbitrarily specify transmission zeros using direct synthesis provides a 
superior solution for designing symmetric filters. 

120 
Filter Synthesis Using Genesys S/Filter 
11.2.1 All-Pole Symmetric Response Filters 
Consider an eighth-degree, 140- to 260-MHz, 0.1-dB ripple, bandpass filter 
with two TZs at DC and six at infinity. There are approximately ten unique 
solutions to this specification with the Series Element First option, and ten 
with a shunt element first. All require dissimilar terminations so the 
automatic Remove Transformer transform is applied and the Extraction 
table is canvassed for the topology with the most reasonable element 
values. The selected topology is given in Fig. 11.7. 
 
L=73.76nH
L1
C=7.56pF
C1
L=374.97nH
L2
C=2.21pF
C2
C=8.93pF
C3
L=86.82nH
L3
C=34.99pF
C4
L=24.19nH
L4
C=29.48pF
C5
ZO=50Ω
ZO=50Ω
 
Figure 11.7 Schematic of the symmetric eighth-degree 140- to 260-MHz bandpass. 
Fig. 11.8 shows the transmission, group-delay, and return-loss 
responses for the symmetric-response bandpass in Fig. 11.7. Notice the 
excellent symmetry in both the transmission-amplitude and group-delay 
responses. 
11.2.2 Generalized Bandpass with Symmetric Response 
The Cauer-Chebyshev bandpass zigzag is one of the most inductor-
economic topologies [3]. This filter does not require direct synthesis and is 
designed by Genesys Passive Filter module. This topology requires even-
order lowpass prototypes of order four or greater. Given in Fig. 11.9 is a 50-
to 90-MHz example designed from a fourth-order lowpass. It has two TZs 
at DC and two at infinity, and one each below and above the passband. 
While it has a low inductor count, it has two disadvantages for certain 
applications: the Cauer-Chebyshev approximation requires specific FTZ 
placements, and the response is not symmetric because there is an equal 
quantity of TZs at DC and infinity. 

Symmetry 
121 
 
Figure 11.8 Responses of the symmetric-response all-pole bandpass. 
C=67.61pF
C2
C=23.27pF
C4
C=153.18pF
C3
L=129.02nH
L2
L=155.92nH
L3
C=10.3pF
C5
L=90.14nH
L4
C=55.99pF
C6
ZO=71.56Ω
L=223.59nH
L1
C=28.07pF
C1
ZO=50Ω
 
Figure 11.9 Zigzag (minimum-inductor elliptic) designed by the Genesys Passive Filter 
program. 

122 
Filter Synthesis Using Genesys S/Filter 
 
Figure 11.10 Responses of the zigzag Cauer-Chebyshev bandpass. 
The response is given in Fig. 11.10. The lack of arithmetic symmetry is 
evident from the group-delay response. Direct synthesis may be used to 
create a similar topology with corrected symmetry, or to place FTZs for a 
custom stopband attenuation. These filters may also improve inductor 
economy. S/Filter is used to synthesize a 50- to 90-MHz generalized 
bandpass, also with four nonfinite TZs, but with one at DC and three at 
infinity to achieve arithmetic symmetry. In this case, the FTZs are placed to 
achieve a minimum stopband attenuation of 40 dB and a symmetric 
response. The resulting schematic with the Remove Transformer transform 
applied and the extraction sequence  ∞ 22.5 114.2 ∞ ∞ DC is given in Fig. 
11.11. The responses are given in Fig. 11.12. 
Notice the dissimilar stopband attenuation that results when the FTZs 
are placed to achieve group-delay and selectivity symmetry. The FTZs may 
be placed to achieve specific stopband requirements at the expense of 
symmetry, but the symmetry is still improved over that of the elliptic 
Cauer-Chebyshev, because of better management of the nonfinite TZs. 

Symmetry 
123 
 
Figure 11.11 Generalized response of the symmetric 50- to 90-MHz bandpass filter. 
 
Figure 11.12 Responses of the generalized 50- to 90-MHz bandpass with symmetric 
responses. 
11.2.3 Symmetry by FTZ Placement 
Response symmetry can also be controlled by the placement of FTZs. For 
example, consider a symmetric requirement similar to the previous 50- to 
90-MHz bandpass, but with greater attenuation in the stopband above the 
passband. In this case, two TZs at both DC and infinity are specified. This 
results in asymmetry with greater selectivity below the passband. This is 

124 
Filter Synthesis Using Genesys S/Filter 
compensated by specifying an additional FTZ above the passband. The 
placement of FTZs is adjusted to achieve symmetry and meet the required 
stopband attenuation. The extraction sequence ∞ 38.3 122.5 DC 105.5 ∞ DC 
is selected, and after applying the Remove Transformer transform, the 
schematic given in Fig. 11.13 results. 
The responses of this filter are given in Fig. 11.14. The symmetric 
group-delay response is evidence of symmetry in the transmission 
amplitude response. The additional FTZ above the passband increases the 
stopband rejection in that stopband and provides symmetry even though 
the ratio of the quantity of TZs at infinity and DC is less than three.  
 
Figure 11.13 Schematic of the symmetric generalized 50- to 90-MHz bandpass with greater 
stopband attenuation above the passband. 
11.3 Group-Delay Equalization 
Many communications systems require near-constant group delay in the 
passband of filters. This can be achieved by filters that include elements 
that bridge across nodes in the filter [4]. Filters of this class with arbitrary 
TZ placement are economic, but they can be difficult to design and tune. An 
alternative approach is to design the filter using the synthesis techniques 
outlined in this book, followed by cascading the filter with a group-delay 
equalization network. 

Symmetry 
125 
 
Figure 11.14 Responses of the symmetric generalized 50- to 90-MHz bandpass with greater 
attenuation above the passband. 
The Genesys Equalization module automates the group-delay 
equalization of any Genesys simulated circuit. The Equalization module 
cascades a user-specified quantity of nine different types of L-C and op-
amp all-pass equalizer sections and optimizes the parameters of those 
sections to flatten the group-delay response over a user-specified frequency 
range. The original filter equalized in this case is the symmetric-response 
all-pole bandpass designed in Section 11.2.1. Group-delay equalizers of type 
three are added until a quantity of three achieved the desired error from a 
flat group-delay response. The resulting three-section group-delay 
equalizer is shown in Fig. 11.15. The original filter is automatically 
represented by data in the two-port network N1. 
The resulting cascade responses are given in Fig. 11.16. Both the 
original and equalized group-delay responses are given as dashed 
responses. The group-delay equalizer sections are all-pass networks and 
with high element Q, they have no affect on the transmission amplitude 
response. With finite-Q elements, these networks introduce midband 
insertion loss, but because the loaded Q of these sections is modest, the 
added insertion loss is typically rather small. 

126 
Filter Synthesis Using Genesys S/Filter 
 
Figure 11.15 Three-section group-delay equalizer cascaded with the all-pole symmetric-
response bandpass. 
 
Figure 11.16 All-pole symmetric response bandpass with group-delay equalization. 
Tuning of the filter and equalizer sections is best accomplished in 
phases. PCB jumpers allow tuning of the filter first, followed by tuning of 
each equalizer section individually to a presimulated group-delay response 
mask. 

Symmetry 
127 
References 
[1] R. Rhea, “Exploiting Filter Symmetry,” Microwave Journal, March 2001. 
[2] H. Blinchikoff and A. Zverev, Filtering in the Time and Frequency Domains, 
Noble Publishing(SciTech), Raleigh, NC, 2001. 
[3] R. Saal and E. Ulbrich, “On the Design of Filters by Synthesis,” IRE Trans. 
Circuit Theory, Vol. CT-5, December 1958. 
[4] J. Rhodes, “The Design and Synthesis of a Class of Microwave Bandpass Linear 
Phase Filters,” Trans. Microwave Theory and Techniques, Vol. 17, April 1969. 


 
129 
 
12 Matching with S/Filter 
Matching herein refers to the use of a network to cause maximum 
power transfer from an arbitrary source impedance to an arbitrary load 
impedance. Even with complex impedances, matching at a single 
frequency, or approximately over a narrow bandwidth, is a straightforward 
process requiring simple networks with closed form equations [1],[2].  
With wider bandwidth, the problem can be daunting. Genesys includes 
Impedance Match, a module designed to match real or complex 
impedances using eight built-in network algorithms, or a custom user-
specified network. One or more of these algorithms can find the optimum 
solution to an impedance-matching problem. For increasing bandwidth, 
the user specifies an increased quantity of elements. One of the Impedance 
Match algorithms uses a direct synthesis similar to that in S/Filter. When 
the problem is primarily a matching problem, Impedance Match is 
recommended. This chapter addresses matching techniques used with 
S/Filter when the problem is primarily a filtering problem, but the loads 
are dissimilar or complex. 
12.1 Matching Concepts 
Impedance mismatch may be viewed from a network or a wave perspective. 
For a network perspective, consider Fig. 12.1, with a 1-volt DC source with a 
50-ohm source impedance and a 50-ohm load impedance.  
VDC=1V
VS1
R=50Ω
Rsource
R=50Ω
Rload
SOURCE
LOAD
  
Figure 12.1 The matching problem from a network perspective. 

130 
Filter Synthesis Using Genesys S/Filter 
The current is 1 volt over 100 ohms, or 10 mA. The voltage source 
delivers 10 mW; 5 mW to the source resistance and 5 mW to the load 
resistance. If the load is 25 ohms, the current increases to 13.33 mA, and 
the 1-volt source delivers 13.33 mA. However, only 4.44 mW is delivered to 
the load, while the majority is delivered to the source resistance. If the load 
is 100 ohms, the current decreases to 6.67 mA, and the 1-volt source 
delivers 6.67 mW. While the majority is delivered to the load, again it is 
only 4.44 mW. Maximum transfer of power occurs when the load resistance 
equals the source resistance. 
From a wave perspective, when a signal propagating through a system 
encounters an impedance shift, a portion of the signal is reflected, thus 
reducing the transmitted signal. This is analogous to reflection in an optical 
system. Mismatch occurs when the impedance shift is either resistive or 
complex.  
12.1.1 Complex Conjugate Match 
When the load impedance is complex, the power delivered from a resistive 
source to the resistive component of the load is reduced. When the load 
impedance is R + jX, maximum power transfer is restored if the source 
impedance is R - jX. This is referred to as a complex conjugate match. The 
source may be purely resistive and a matching network may be used to 
present an effective R - jX to the load. This network may also shift the 
resistive component of the source to equal the load resistance. When the 
matching network added between the source and load is purely reactive, 
this network dissipates no energy and maximum power transfer occurs. 
12.1.2 Two-Element Matching Networks 
Two reactors may be used to match any complex source and load 
impedance [1],[2]. Given in Fig. 12.2 are the matching-spaces supported by 
the matching-network types one through eight. These types of diagrams 
were first introduced by Smith [3]. Complex loads RL + jXL within the 
enclosed spaces on the Smith chart are matched to a real source impedance 
R0 using the indicated two-reactor network. Given below are the closed-
form equations for computing the reactor values of the matching-network 
types one through eight in Fig. 12.2. At a design frequency f and with the 
load admittance given by 
2
2
2
2
L
L
L
L
L
L
L
L
L
X
R
X
j
X
R
R
jB
G
Y
+
−
+
=
+
=
                                  (12.1) 
and then setting  

Matching with S/Filter 
131 
2
0
L
L
G
R
G
A
−
=
                                                       (12.2) 
L
L
L
X
R
R
R
B
−
−
=
)
(
0
                                             (12.3) 
L
L
L
X
R
R
R
C
−
−
−
=
)
(
0
                                              (12.4) 
the network values are 
(
)
2
2
1
2
A
G
f
A
L
L +
=
π
                                                        (12.5) 
f
B
A
C
L
π
2
1
−
=
                                                            (12.6) 
(
)
L
B
A
f
L
+
=
π
2
1
2
                                                                                          (12.7) 
fA
A
G
C
L
π
2
2
2
2
+
=
                                                                                              (12.8) 
f
B
L
π
2
3 =
                                                                                                      (12.9) 
(
)
(
)
2
2
3
2
L
L
L
X
B
R
f
X
B
C
+
+
+
=
π
                                                                         (12.10) 
(
)
(
)
(
)
L
L
L
X
C
f
X
C
R
L
+
+
+
−
=
π
2
2
2
4
                                                                              (12.11) 
fC
C
π
2
1
4
−
=
                                                                                                (12.12) 
fA
A
G
C
L
a
π
2
2
2
5
+
=
                                                                                           (12.13) 
f
B
A
C
L
b
π
2
5
+
−
=
                                                                                           (12.14) 
(
)
2
2
6
2
A
G
f
A
L
l
a
+
=
π
                                                                                    (12.15) 

132 
Filter Synthesis Using Genesys S/Filter 
(
)
L
b
B
A
f
L
−
−
=
π
2
1
6
                                                                                     (12.16) 
fB
C a
π
2
1
7
−
=
                                                                                            (12.17) 
(
)
(
)
2
2
7
2
L
L
L
b
X
B
R
f
X
B
C
+
+
+
=
π
                                                                        (12.18) 
f
C
L a
π
2
8 =
                                                                                                  (12.19) 
(
)
(
)
(
)
C
X
f
C
X
R
L
L
L
L
b
+
+
+
−
=
π
2
2
2
8
                                                                        (12.20) 
Consider the match of a 50-ohm source to a load of 10 ohms in series 
with 6.366 pF at 100 MHz. The load impedance is 10 – j250 ohms. Types 
two, three, six, and eight are valid matching networks. For a lowpass type 
passband, type three is selected. From Eqs. 12.3, 12.4, 12.9, and 12.10, L3 is 
429.72 nH and C3 is 63.66 pF. The resulting S11 is given in Fig. 12.3.  
The match is exact at only the design center frequency. If the reactance 
is significant, or the ratio of Ro to RL differs significantly from unity, the 
matched bandwidth is narrow. In our example, the 20-dB return loss 
bandwidth is only 0.6 MHz, or 0.6% bandwidth. The problem of matching, 
at least for lossless elements, is largely an issue of bandwith. Increased 
bandwidth is achieved by using matching networks with an increased 
quantity of elements. The remainder of this chapter covers direct synthesis 
to create these matching networks. 
12.2 Real Terminations 
This section deals with S/Filter matching when the terminations are purely 
resistive with no reactive element. 
12.2.1 Exploiting Extraction Sequences 
As demonstrated in examples in previous chapters, certain extraction 
sequences result in a termination resistance different than the source 
resistance. This is used to advantage when matching dissimilar resistance. 

Matching with S/Filter 
133 
 
Figure 12.2 Match space for two-element matching networks. 

134 
Filter Synthesis Using Genesys S/Filter 
 
Figure 12.3 Match response of the two-element matching network. 
Fig. 12.4 shows plots of the maximum ratio of termination resistance 
that are to be matched by a bandpass filter given a ratio of the upper 
frequency to the lower frequency, for a match of 20-dB return loss in the 
passband. The four traces represent the quantity of nonfinite transmission 
zeros at DC and infinity. For example, the 2/4 trace represents a 
synthesized network with two TZs at DC and four TZs at infinity. Recall that 
for an all-pole network, six TZs result in a network with six elements when 
the network is canonic. 
Increasing the quantity of TZs increases the matching bandwidth for a 
given termination resistance ratio. For example, when matching a 50-ohm 
source to a 100-ohm load, the termination resistance ratio is two. The 
termination resistance ratio is also two when matching a 50-ohm source to 
a 25-ohm load. With two TZs at DC and at infinity, the maximum upper 
frequency is almost twice the lower frequency, an octave bandwidth. With 
six TZs at DC and at infinity, the bandwidth is a decade. Likewise, 
increasing the quantity of TZs increases the achievable bandwidth for a 
given termination resistance ratio. For example, over an octave bandwidth, 
2/2 matches a resistance ratio of almost two while 6/6 matches a resistance 
ratio of 100. 
 

Matching with S/Filter 
135 
 
Figure 12.4 Matchable termination resistance ratios versus the ratio of the upper to lower 
cutoff frequency for a passband return loss of 20 dB. 
For matching, even quantities of TZs are more economic than odd 
quantities. For example, 2/4 provides better bandwidth or higher 
termination resistance ratios than 3/3. All even TZ choices of the same 
quantity result in similar performance. For example, 2/6, 4/4, and 6/2 
provide similar performance. 
Fig. 12.4 is for the case with 20-dB passband return loss. A worse 
return loss improves the bandwidth and increases the termination 
resistance ratio. 
With respect to matching, FTZs are not economic. For a given quantity 
of elements, the specification of FTZs reduces the performance. FTZs are 
employed in filters used for matching only if the stopband requirements 
benefit. 
The above discussion involves design to maximize the bandwidth or 
termination resistance ratio. The general case of matching, however, 
involves matching a source resistance to a specific load resistance. For 
example, consider a required resistance ratio of 30 over an octave 
bandwidth. This requirement lies between TZ placements of 4/4 and 6/6. A 
number of techniques are employed: 
1) If the design is purely a matching issue, the 6/6 synthesis is used and 
the bandwidth is extended beyond the required bandwidth. This 
reduces the sensitivity of the design to element tolerance. 

136 
Filter Synthesis Using Genesys S/Filter 
2) If filtering is required and the stopband rejection must be retained, 
the 6/6 synthesis is used and a Norton transform is applied to adjust 
the load resistance. 
3) If filtering is required and the stopband rejection must be retained, 
the 6/6 synthesis is used and a different extraction sequence is used. 
Fig. 12.4 is derived by selecting the sequence resulting in the greatest 
performance. 
4) The passband ripple is reduced until the extraction sequence results 
in a TRF of unity. 
Fig. 12.4 is provided to illustrate the relationships between network 
complexity, the resistance ratio, and matching bandwidth. To illustrate how 
the design process might actually proceed, consider the following example. 
A 50-ohm source is matched to a 12.5-ohm load from 100 to 200 MHz. A 
passband return loss of 12 dB is required. No filtering specifications are 
involved. 
Given in Fig. 12.5 is the Specification tab specifying the above 
parameters. The load resistance is set at the required 12.5 ohms. The 
passband ripple is adjusted until the response indicated a 12-dB return loss. 
A review of Fig. 12.4 suggests that two TZs at DC and four TZs at infinity 
should be sufficient. 
 
 
Figure 12.5 Specification tab for matching example that exploits extraction sequences. 
The Extraction tab is selected and the Lmax/Lmin column is canvassed 
for a small inductor value ratio. The extraction sequence  ∞ ∞ ∞ DC ∞ DC is 
selected. Next, the Transform tab is selected and the Remove Transformer 
button is clicked. The resulting matching network is given in Fig. 12.6. The 
Norton transform added an inductor. Selecting the extraction sequence  ∞ 

Matching with S/Filter 
137 
DC ∞ DC ∞ ∞ foll owed by the Remove Transformer option adds a 
capacitor, thus reducing the inductor count to three. 
 
 
L=194.21nH
L1
C=43.12pF
C1
L=25.78nH
L2
L=10.02nH
L3
C=147.34pF
C2
L=26.96nH
L4
C=48.34pF
C3
ZO=12.5Ω
ZO=50Ω
 
Figure 12.6 A 50- to 12.5-ohm matching network designed by exploiting extraction 
sequences. 
Alternatively, the bandwidth is increased by decreasing the Lower 
Cutoff and increasing the Upper Cutoff until the TRF ratio for the selected 
extraction sequence is unity. In this case, no Remove Transformer option is 
required. The resulting schematic is given in Fig. 12.7 and the responses in 
Fig. 12.8. Another option is to decrease the passband ripple until a Norton 
transform is not required. In this case, a passband ripple of 0.16 dB with a 
return loss of 14.4 dB results in a canonic solution very similar to Fig. 12.7. 
 
C=35.85pF
C1
L=24.97nH
L1
L=12.03nH
L2
C=122.7pF
C2
L=22.44nH
L3
C=59.11pF
C3
ZO=12.5Ω
ZO=50Ω
 
Figure 12.7 Matching network with bandwidth expanded to avoid a Norton transform. 

138 
Filter Synthesis Using Genesys S/Filter 
 
Figure 12.8 Responses of the 50- to 12.5-ohm matching network with expanded bandwidth. 
12.2.2 Exploiting Resonator Filters 
Coupled resonator filters typically employ impedance transformations that 
may be exploited to match dissimilar terminations. This is particularly 
effective for narrow bandwidth filters. Consider the following example of an 
88- to 108-MHz three-section series resonator filters with matching of 100 
to 50 ohms with a 20-dB return loss. Both source and load terminations are 
specified as 100 ohms, the cutoff frequencies are specified, and a passband 
ripple of 0.0432 dB is specified. As described in Section 8.2.1, we begin 
with the Series Element First extraction sequence DC ∞ ∞ ∞ ∞ ∞ and apply 
shunt Norton transforms to the first shunt capacitor. A turns ratio value of 
n equal to 0.21082 results in equal first and second inductors. The resulting 
schematic is given in Fig. 12.9.  
L=666.37nH
L1
C=4.67pF
C1
C=18.22pF
C2
L=666.37nH
L2
C=4.87pF
C3
C=89.29pF
C4
L=27.75nH
L3
S=4.9
P=1
T1
ZO=100Ω
ZO=100Ω
 
Figure 12.9 Schematic of the 88- to 108-MHz bandpass used as a matching network. 

Matching with S/Filter 
139 
Notice that the transformer turns ratio is 4.9, thus indicating that 
without a transformer, this network matches 100 ohms down to about 4.2 
ohms. The application of a shunt Norton to the final shunt capacitor 
supports matching any resistance from 4.2 ohms up to 100 ohms. 
Therefore, the termination resistance in the Specification tab is set to the 
desired 50 ohms and a Norton Shunt transform is applied to C4, selecting n 
to remove the transformer. The filter matching 100 to 50 ohms is given in 
Fig. 12.10. 
 
L=666.37nH
L1
C=4.671pF
C1
C=18.22pF
C2
L=666.37nH
L2
C=5.6216pF
C3
C=25.79pF
C4
L=332.5nH
L3
C=10.4779pF
C5
ZO=100Ω
ZO=50Ω
 
Figure 12.10 Final schematic of the series-resonator bandpass used to match 100 to 50 
ohms. 
12.3 Complex Terminations 
As illustrated by Fig. 12.4, very wide-bandwidth, even as high as a decade or 
more, is readily achieved between resistive terminations. When the load is 
complex, the matching bandwidth is more limited.  
12.3.1 Fano’s Limit 
Three definitions of Q are required to define the matching problem with 
complex terminations. Loaded Q is the center frequency divided by the 3-
dB bandwidth of the response.  
lower
upper
loaded
f
f
f
Q
−
=
0
                                              (12.21) 
It is a finite value even if the circuit is built using elements with infinite 
Q. Element Q, or unloaded Q, is a measure of element quality. It is defined 
as 
f
π
2
times the stored energy divided by the dissipated energy in the 
element. It is as high as 200 for excellent inductors. Unloaded Q increases 
with physical size, so modern miniature chip inductors have low unloaded 
Q. Finally, Q of the load is a property of a complex termination. For series 
impedance it is given simply by 

140 
Filter Synthesis Using Genesys S/Filter 
L
L
load
of
R
X
Q
=
                                                       (12.22) 
and for parallel admittance it is 
L
L
load
of
G
B
Q
=
                                                        (12.23) 
As the Q of the load increases, the achievable match bandwidth 
decreases. In a classic paper, Fano [4] offers an elegant formula for 
predicting the relationship between the bandwidth and the best achievable 
reflection coefficient using a lossless, infinitely complex matching network.  
load
of
loaded
Q
Q
e
π
−
=
Γmin
                                                      (12.24) 
where 
min
Γ
 is the magnitude of the best reflection coefficient achievable 
over a bandwidth 
lower
upper
f
f
−
. The return loss of 
min
Γ
 is 
min
log
20
Γ
−
=
dB
RL
                                                 (12.25) 
Useful algebraic derivatives of Fano’s equation are 
π
min
ln Γ
−
=
load
of
loaded
Q
Q
                                          (12.26) 
min
ln Γ
−
=
loaded
load
of
Q
Q
π
                                                 (12.27) 
An octave bandwidth is 
5.1
=
loaded
Q
. Eq. 12.25 indicates that the 
reflection coefficient of 0.1 is a return loss of 20 dB. From Fano’s equation, 
to achieve a 20-dB return loss over an octave bandwidth requires 
load
of
Q
less than 2.047. Fano’s formula provides an absolute limit that is 
approached with an infinite quantity of elements. Fano’s limit is used to 
discover if a solution is possible, thus avoiding effort on an unsolvable 
problem. 
 
12.3.2 Example: Power Amplifier Match 
A transistor power amplifier output with 9.6 ohms resistance in parallel 
with 40 pF is to be matched to 50 ohms from 200 to 400 MHz with a 
worse-case return loss of 12 dB, or 
min
Γ
of 0.251. The Q of the load from Eq. 
12.23 is 0.4825 at 200 MHz and 0.9651 at 400 MHz. Using the higher Q of 
the load, from Eq. 12.24, for an octave bandwidth (loaded Q = 1.5), a 

Matching with S/Filter 
141 
reflection coefficient of 0.00758 is theoretically achievable with an infinite 
quantity of elements. Design begins with the Specification tab given in Fig. 
12.11. 
 
 
Figure 12.11 Initial Specification tab for the 200- to 400-MHz power-amplifier matching 
network. 
The matching network must include a shunt capacitor at the input that 
is sufficiently large to absorb the 40-pF transistor output capacitance. The 
extraction must therefore begin with a shunt element first. Furthermore, 
the extraction must result in a topology with a transformer turns ratio less 
than unity so that a Norton transform is available to remove the 
transformer. The quantity of nonfinite TZs is increased until a satisfactory 
extraction sequence is achieved. The lowest degree is six. Since harmonic 
suppression is desirable in a power amplifier, the extraction with one TZ at 
DC and five at infinity is selected with the sequence ∞ DC ∞ ∞ ∞ ∞. 
Finally, to avoid adding an additional capacitor with a Norton 
transform, to improve the design margin, and to retain the filtering 
functions of the network, the requested passband ripple in the Specification 
tab is reduced until the transformer turns ratio in the Extraction tab is 
unity. The resulting passband ripple is 0.0282 dB, or a passband return 
loss of 22 dB. The schematic for the power-amplifier matching network is 
given in Fig. 12.12. Capacitor C1 is replaced with a 24.84-pF capacitor with 
the remaining capacitance provided by the transistor output capacitance. 

142 
Filter Synthesis Using Genesys S/Filter 
L=6nH
L1
L=7.68nH
L2
C=38.51pF
C2
L=17.5nH
L3
C=12.47pF
C3
C=64.84pF
C1
ZO=9.6Ω
ZO=50Ω
 
Figure 12.12 Schematic of the 200- to 400-MHz power-amplifier matching network. C1 is 
reduced by the transistor output capacitance. 
12.3.3 Example: Broadband Antenna Match 
This example illustrates a matching network for a monopole antenna. The 
design is required to center the resonant frequency at 3.75 MHz, shift the 
resistive component up to 50 ohms, and broaden the bandwidth of the 
return loss. An R-L-C model for the antenna is 34 ohms in series with a 
series L-C of 19.5 uH and 87 pF. The VSWR of this antenna in a 50-ohm 
system is given as the solid trace in Fig. 12.13. The VSWR is a radial-scaled 
parameter often used with antennas. It is related to the magnitude of S11 by 
the following equation: 
11
11
1
1
S
S
VSWR
−
+
=
                                                    (12.28)  
The minimum VSWR in this example is not unity because of the 
mismatch of the 34-ohm antenna resistance to the 50-ohm system. The 
minimum occurs when the L-C components of the model resonate. 
Resonance does not occur at band center because the monopole antenna is 
electrically shorter than a quarter wavelength at 3.75 MHz. 

Matching with S/Filter 
143 
 
Figure 12.13 VSWR responses of the antenna before (solid trace) and after matching (dashed 
trace). 
The goal is to achieve a VSWR under 3:1 across the frequency span of 
3.5 to 4.0 MHz. Design begins with the specification of the 50-ohm source 
and 34-ohm load, frequency cutoffs of 3.5 and 4.0 MHz, and a passband 
ripple of 1.25 dB that corresponds to a VSWR of 3:1. The series L-C 
component of the model is incorporated into the final series branch of the 
matching network. The quantity of TZs is increased and an extraction 
sequence is selected so that the 3:1 VSWR is achieved over the desired 
band, and the matching network contains a final series L-C branch with the 
inductor greater than the antenna 19.5 uH, and a capacitor smaller than the 
antenna 87 pF. The extraction sequence selected is DC ∞ DC ∞ DC ∞. Then 
a Remove Transformer transform is applied to set the output resistance at 
34 ohms. The final matching network could be realized by absorbing the 
antenna L-C into the matching network values. However, to eliminate the 
matching network capacitor and to afford margin in the design, the ripple is 
reduced to 1.0776 dB to improve the VSWR maximum and the cutoffs are 
broadened to 3.48 and 4.02 MHz to widen the frequency response. This 
sets the capacitor C4 to exactly match the antenna capacitance. The network 
is shown in Fig. 12.14. The capacitor C4 is absent in the final network and 
the inductor is 20.857 uH minus 19.5 uH, or 1.357 uH. If the antenna is 
physically lengthened, this inductor is eliminated as well. The final 
response is given as a dashed trace in Fig. 12.13. 
 

144 
Filter Synthesis Using Genesys S/Filter 
L=30677.88nH
L1
C=59.02pF
C1
L=313.57nH
L2
C=32912.06pF
C2
C=7002.93pF
C3
L=20857.56nH
L3
C=87pF
C4
ZO=34Ω
ZO=50Ω
 
Figure 12.14 Matching and broadbanding network for the antenna. Refer to the text regarding 
L3 and C4. 
References 
[1] R. Rhea, The Yin-Yang of Matching: Part 1 – Basic Matching Techniques, High 
Frequency Electronics, March 2006. 
[2] R. Rhea, The Yin-Yang of Matching: Part 2 – Practical Matching Techniques, 
High Frequency Electronics, April 2006. 
[3] P. Smith, Electronic Applications of the Smith Chart, SciTech Publishing, 
Raleigh, NC, 1995. 
[4] R. Fano, “Theoretical Limitations on the Broadband Matching of Arbitrary 
Impedances,” Jour. Franklin Institute, January, 1950. 

 
145 
 
13 Distributed Filters 
Distributed filters use TLEs to realize the transfer function rather than 
using lumped inductors and capacitors. The reactance of ideal lumped 
elements is a linear function of the frequency variable ω , and practical 
elements exhibit this behavior over a wide bandwidth. When electrically 
much shorter than a quarter-wavelength, TLEs behave much like lumped 
reactors. The behavior of longer TLEs are a periodic function 
θ
tan
, where 
θ  is the electrical length of the TLE. Exact synthesis techniques are 
available for distributed filters by replacing the linear frequency variable ω  
with the periodic frequency variable tanθ . This is referred to as Richards’ 
transform [1]. Minnis is an excellent review of exact synthesis for 
microwave circuits using the Richards transform [2]. 
Therefore, two different design methods are used for distributed filters. 
One assumes electrically short TLEs, and it takes advantage of 
θ
θ ≈
tan
for 
smallθ . Although approximate, this method should not be dismissed. 
Filters constructed with short TLEs provide better stopband performance. 
Several practical filter topologies are easily designed using this approach. 
Furthermore, while the initial synthesis process using the Richards 
transform is exact, when realized with real transmission lines, 
discontinuities result in inexact realization. For any method of design, 
trade-offs and tuning or optimization are required. 
The second method, exact synthesis using Richards’ transform, 
requires all TLEs to be of equal length, referred to as commensurate. This 
synthesis often results in series TLE stubs that are realizable only in 
wireline, and not microstrip or stripline. This difficulty is resolved using 
transforms and an additional type of TLE, the unit element. Mastery of 
these techniques requires practice. Later chapters include many examples 
to illustrate these techniques. 
13.1 Comparing Distributed and Lumped Filters 
The decision to use lumped or distributed filters is typically based on 
frequency. Lumped filters are often employed below approximately 1 GHz, 
and distributed filters are selected for microwave frequencies. However, 
only a careful analysis of the requirements determines the optimum 
approach. Lumped filters are effectively used at microwave frequencies 
when small size is paramount, and distributed filters are sometimes used at 
lower frequencies when low loss is critical.  

146 
Filter Synthesis Using Genesys S/Filter 
Distributed filters offer a number of realization advantages that make 
them attractive for certain applications: 
1) Higher unloaded Q is achievable. 
2) Element tolerance is often tighter, depending primarily on the 
substrate dielectric constant and dimensional tolerances. This 
eliminates tuning in some applications. 
3) The absence of lumped elements and solder connections improves 
reliability. 
4) In certain applications, the absence of embedded elements is an 
advantage. 
However, TLEs also possess some significant disadvantages: 
1) Higher unloaded Q is achieved only with larger physical size than 
lumped elements [3]. 
2) Periodic behavior destroys stopband bandwidth. This is often the 
limiting factor for distributed filters. 
3) With larger size, box modes may further degrade stopband 
performance. 
4) Design is complicated by restricted TLE parameter range. For 
example, the minimum and maximum practical values of TLE 
characteristic impedances are roughly 20 and 120 ohms, respectively. 
For coupled TLE, extremely close spacing may be required. 
In summary, lumped filters are often limited by tuning requirements or 
losses associated with finite element Q, while distributed filters are often 
limited by size and poor stopband performance. 
13.2 The Genesys Microwave Filter Module 
Overcoming the previously listed TLE disadvantages typically requires 
clever and unintuitive design steps and transformations. This can be 
daunting to both the novice and experienced designer. A rich history of 
modern-method solutions exist using specific topologies. An excellent 
review of methods developed prior to 1964 is available in the classic book 
Microwave Filters, Impedance-Matching Networks, and Coupling 
Structures [4]. This book has served as an important reference for 50 years. 
These methods use adaptations of the modern method and do not require 
direct synthesis techniques. As such, they do not offer the flexibility of 
direct synthesis, but for all-pole distributed topologies, they work well and 
involve straightforward methods. 
The Microwave Filter module of Genesys automates the design of 
topologies derived from those reviewed in [4]. Alternative solutions can be 
designed and compared in minutes with the click of a mouse button. Four 
of the eight distributed bandpass topologies automated by Microwave 

Distributed Filters 
147 
Filter are given in Fig. 13.1. The microstrip metal patterns are 
approximately 3x actual size. These are five-section 6- to 6.2-GHz all-pole 
bandpass filters with a 0.0432-dB passband ripple on the Rogers TMM6 
25-mil thick substrate. 
 
 
Figure 13.1 Four of the eight different distributed bandpass filter topologies automatically 
designed by the Microwave Filter module of Genesys. 
The edge-coupled topology is larger and therefore less desirable than 
the folded version, referred to as hairpin. Each TLE resonator is electrically 
a half-wavelength long. End-effect capacitance requires physical shortening 
of the resonators. As the frequency is increased, the resonators become 
shorter and folding into hairpins is impractical. 
Some designers avoid the interdigital because of concern about the 
affects of the via holes. However, the affects of via-hole discontinuities is 
less than the open-end discontinuities. Open ends are particularly onerous 
as they serve as radiators, more so than other discontinuities. Interdigital 
resonators are only a one-quarter wavelength in length, resulting in a more 
compact size with reduced box modes in a smaller housing. The most 

148 
Filter Synthesis Using Genesys S/Filter 
compact topology is the combline. It requires capacitive loading of each 
resonator. In this example, each of the resonators is 600 in electrical length. 
Each of the filters shown in Fig. 13.1 utilizes transformer coupling at 
the input and output. The Microwave Filter module also supports tapped 
coupling to the first and last resonator, along with other options to 
customize these filters. These topologies may be designed using S/Filter, 
but many steps are involved. A more effective use for S/Filter is the design 
of topologies not automated by the Microwave Filter module. 
Given in Fig. 13.2 are four different five-section lowpass filters designed 
by Microwave Filter with a cutoff frequency of 2.4 GHz on the same TMM6 
substrate material. A minimum TLE characteristic impedance of 24 ohms 
and a maximum TLE characteristic impedance of 120 ohms are specified. 
The scale is approximately 3x actual size.  
 
Figure 13.2 Four different distributed lowpass topologies automatically designed by the 
Microwave Filter module of Genesys. 
The stepped-Z filter cascades high-impedance TLEs acting like series 
inductors with low-impedance TLEs acting like shunt capacitors. The stub 
lowpass is similar except that parallel open stubs less than 900 long act like 
the shunt capacitors. The elliptic lowpass has two FTZs with series 
inductors and series L-C branches in shunt. The stepped penetrating 
topology is described in detail later in this chapter. 

Distributed Filters 
149 
13.3 Distributed Synthesis Concepts 
This section covers fundamental concepts involved in the design of 
distributed element filters using both short-line approximations, and exact 
synthesis using Richards transform. 
13.3.1 TLEs 
Distributed synthesis utilizes six basic TLEs as shown in Fig. 13.3. A TLE in 
the transmission path is referred to as a unit element (UE). It does not add 
a TZ, but it may have an effect on the transfer function. 
 
Figure 13.3 The six basic elements of distributed synthesis. 
Each specified nonfinite TZ and each UE adds one degree to the filter 
transfer function and one TLE to the topology. Each FTZ adds two degrees 
to the filter and three TLEs to the topology. The open wireline and shorted 
wireline are not realizable in a planar process such as microstrip. This is 
resolved by transformation to one of the other basic elements. 
TLE elements are defined by their characteristic impedance, Z0, and 
electrical length θ . It is sometimes more convenient to use TLE 
characteristic admittance, Y0. The characteristic impedance and electrical 
length are related to the distributed inductance and capacitance per unit 
length by 
C
L
Z =
0
                                                                (13.1) 

150 
Filter Synthesis Using Genesys S/Filter 
LC
len
rad
×
= ω
θ
                                                        (13.2) 
(
)(
)
2
0
0
c
LC
r
r
r
r
ε
µ
ε
ε
µ
µ
µε
=
=
=
                                     (13.3) 
where len is the physical length of the line and c is the speed of light in a 
vacuum. With 
1
=
r
µ
, 
r
inch
r
mm
f
len
f
len
ε
ε
θ
8
9
0
10
05
.3
10
2.1
−
−
×
≅
×
≅
                   (13.4) 
cC
Z
r
ε
=
0
                                                            (13.5) 
A parallel-coupled line (PCL) that is symmetric with equal self-
impedance lines is defined by the even-mode (
e
Z0 ) and odd-mode (
o
Z0 ) 
characteristic impedance and the even and odd-mode electrical length. For 
pure TEM-mode propagation, 
.
o
e
θ
θ =
 This holds for stripline (triplate) and 
coupled rods between ground planes (slabline), but is only approximately 
valid for microstrip. Useful coupled-line relationships are 
o
eZ
Z
Z
0
0
0 =
                                                        (13.6) 
o
e
o
e
v
Z
Z
Z
Z
k
0
0
0
0
+
−
=
                                                        (13.7) 
o
e
o
e
w
Z
Z
Z
Z
k
0
0
0
0
2
−
=
                                                       (13.8) 
13.3.2 Richards Transform 
The Richards transform does not change the structure of a distributed 
circuit, but rather it is a mathematical transformation of the linear 
frequency variable to a form based on a trigonometric function. This 
facilitates network synthesis of distributed filters. Given in Fig. 13.4 are the 
input reactances of shorted and open stubs versus frequency. The 
independent axis is scaled in multiples of the one-quarter wave frequency, 
fq. The periodic behavior of the stubs is evident. Higher frequency 
resonances are referred to as reentrance modes. This reentrance limits the 
stopband performance of distributed filters. 
At fq, the shorted stub has infinite reactance. This behavior repeats at 
odd multiples of fq. Over limited bandwidth, this behavior mimics a parallel 
L-C network to ground. The reactance of a parallel L-C network is plotted 
as a dashed trace from 0.5 to 1.5 fq. At fq, the open stub has zero reactance. 
This behavior also repeats at odd multiples of fq. Over limited bandwidth, 
this behavior mimics a series L-C network to ground. The reactance of a 

Distributed Filters 
151 
series L-C network is plotted as a dashed-dot-dot trace from 0.5 to 1.5 fq. 
The shorted and open stubs reverse behavioral roles at even multiples of fq. 
The behavior of ideal lumped elements is a linear function of frequency. 
For example, the reactance of an inductor is 
,
L
ω
 where 
.
2 f
π
ω =
 The 
behavior of TLEs is a function of 
.
tanθ  Therefore, it is useful to define a 
new variable for synthesis, 
.
tanθ
=
Ω
 The Richards transform relates these 
two frequency variables by 






=
Ω
qf
f
2
tan
π
                                                           (13.9) 
 
Figure 13.4 Input reactance of a shorted stub (solid trace) and an open stub (dashed trace). 
Also plotted near fq are the reactance of series and parallel L-C networks to ground. 
The frequency mapping is illustrated in Fig. 13.5 using the transmission 
amplitude responses of a fifth-degree generalized lowpass filter with 40-dB 
Amin synthesized with ideal lumped elements (solid trace) and with ideal 
TLEs (dashed trace). In this design, the lowpass cutoff frequency is 1/3 fq. 
For lowpass, the center of the second passband occurs at 2 fq, so specifying 
a higher fq  increases the frequency of the second passband and improves 
the stopband bandwidth. However, as fq is increased, the characteristic 
impedance of the TLE eventually become too extreme to realize. 
 

152 
Filter Synthesis Using Genesys S/Filter 
 
Figure 13.5 Responses of a synthesized lumped (solid trace) and distributed (dashed trace) 
lowpass. 
13.3.3 Kuroda Identities 
A sampling of transforms based on Kuroda identities are illustrated in Fig. 
13.6. The Kuroda Wireline Transfers: Full: Series Shorted Left (Fig. 13.6a) 
converts the unrealizable series-shorted wireline, Z1a, into a structure with a 
conventional open-stub TLE, Z3a. A similar series shorted right form is 
available. All TLEs must be commensurate length. The characteristic 
impedances of the transformed TLEs are higher than the original values. 
The transformed characteristic impedances are: 
a
a
a
Z
Z
n
1
0
2
1+
=
                                                         (13.10) 
a
a
a
Z
n
Z
1
2
2 =
                                                         (13.11) 
a
a
a
Z
n
Z
0
2
3 =
                                                         (13.12) 
For example, the application of this Kuroda transform to a series TLE 
of 30 ohms cascaded with a shorted wireline of 80 ohms, results in n2 of 
1.375, a series TLE characteristic impedance of 41.25 ohms, and an open 
stub of 110 ohms. 
Fig. 13.6b illustrates the shifting of a series open-right element to the 
left of the UE. The transform is the Kuroda Wireline Transfer: Full: Series 
Open Right. The defining formulas are: 
b
b
b
Z
Z
n
0
1
2
1+
=
                                                        (13.13) 

Distributed Filters 
153 
2
0
2
b
b
b
n
Z
Z
=
                                                           (13.14) 
2
1
3
b
b
b
n
Z
Z
=
                                                            (13.15) 
Fig. 13.6c illustrates that a transform may be applied to a portion of a 
series wireline. This results in a second wireline on the mirrored side of the 
series TLE. S/Filter offers the option of specifying the transformer turns 
ratio, or the characteristic impedance of the resulting wireline or series 
TLE. Depicted in Fig. 13.6c is the option Kuroda Wireline Transfer: Equal: 
Series Open Right that results in two wirelines with equal characteristic 
impedance. A series open left form is also available. Transforms that create 
equal-valued wirelines on each side of a TLE are of the proper format to be 
later transformed into coupled combline and interdigital filter structures. 
The defining formulas for the Kuroda Wireline Transfer: Equal: Series 
Open Right transform are: 
c
c
c
Z
Z
n
0
1
1+
=
                                                        (13.16) 
c
c
c
n
Z
Z
0
2 =
                                                            (13.17) 
(
)1
1
4
3
+
=
=
c
c
c
c
c
n
n
Z
Z
Z
                                                (13.18) 
Fig. 13.6d illustrates the Kuroda Wireline Transfer: Equal: Shunt 
Grounded (shorted) Left, which creates a symmetric pair of shorted TLE 
stubs from a single shorted TLE stub. A similar shunt shorted right form is 
available. Formulas are: 
 
d
d
d
Z
Z
n
1
0
1+
=
                                                         (13.19) 
(
)
d
d
d
d
d
Z
n
n
Z
Z
1
5
3
1
+
=
=
                                               (13.20) 
d
d
nZ
Z
0
4
=
                                                           (13.21) 
 

154 
Filter Synthesis Using Genesys S/Filter 
 
Figure 13.6 Sample of Kuroda-derived transforms. 
 

Distributed Filters 
155 
Synthesis and later transforms may create a TLE pi network with 
unequal shunt shorted TLE stubs as depicted on the left in Fig. 13.6e. The 
transform Kuroda Wireline Transfer: Specify Transformer: Shunt Shorted 
Right (or Left) is used to equalize the shunt shorted TLE stubs. Symmetry 
about the series TLE is required to realize coupled-line pairs of equal width. 
The transfer prompts for n. The following value equalizes the stubs. 
e
e
e
e
e
e
e
e
e
Z
Z
Z
Z
Z
Z
Z
Z
n
2
1
1
0
2
1
2
0
+
+
=
                                               (13.22) 
e
e
e
e
e
e
e
Z
n
Z
Z
Z
Z
Z
1
1
0
1
0
3
−
+
=
                                              (13.23) 
e
e
e
n
Z
Z
0
4 =
                                                             (13.24) 
(
)1
0
5
−
=
e
e
e
e
n
n
Z
Z
                                                         (13.25) 
When the structure is simplified, Z5e and Z2e parallel combine to one 
stub with characteristic impedance equal to Z3e. 
13.3.4 Ikeno Transforms 
When the synthesis of a distributed filter results in TLE open stubs with an 
impractically high characteristic impedance, the Ikeno transform is used to 
moderate the characteristic impedance of the TLEs. When the 
characteristic impedance of Z2 in Fig. 13.7 is impractically high, the Ikeno 
transform replaces Z1 with coupled lines and Z2 with an open stub with 
lower characteristic impedance. The transform depicted in Fig. 13.7 is the 
Coupled Lines: Ikeno Lines: Open, Open Stub. The dual transform Open 
Stub, Open is the left/right mirror of the illustrated form. The descriptor 
refers to the terminations present on the nonthrough ports of the resulting 
coupled line.  
 
Figure 13.7 Ikeno transform to resolve excessively high characteristic impedance of Z2. 

156 
Filter Synthesis Using Genesys S/Filter 
Invoking this transform in S/Filter prompts the user for a parameter 
Zc1. This is the even-mode characteristic impedance of the resulting coupled 
lines, Z0e. The dialog indicates the minimum and maximum allowable 
values. The maximum value is twice the characteristic impedance Z1. The 
maximum and minimum values are: 
0
max
:
0
2Z
Z e
=
                                                          (13.26) 
(
)
(
)
1
0
1
1
0
1
min
:
0
−
+
−
+
=
Y
Y
Y
Y
Y
Z e
                                      (13.27) 
where the admittances Yn are the inverse of the impedances Xn. Specified 
values for Zc1 near the minimum value result in an open-stub TLE 
characteristic impedance near 0 ohms. Specified values for Zc1 near the 
maximum value result in an open-stub characteristic impedance near the 
high-original value, and an unrealistically low value of Z00. If the 
characteristic admittance of the final open-stub TLE is Ys, then with 
(
)(
)
1
1
0
0
1
Y
Y
Y
Y
Y
Y
Y
Y
A
s
s
s
−
+
+
=
                                             (13.28) 
the even- and odd-mode characteristic impedances are 
(
)
1
1
1
0
0
−






−
−
+
=
A
Y
Y
Y
Y
Y
Z
s
s
e
                                              (13.29) 
1
0
0
2
1
−






+
=
A
Z
Z
e
o
                                                   (13.30) 
The Ikeno transform dialog then prompts for a value for n, which must 
range from 1.0001 to 1000. Higher numbers result in lower values of the 
characteristic impedance of the resulting open stub.  
2
1
n
Zstub ∝
                                                           (13.31) 
Next, a message is returned with the characteristic impedance of the 
resulting open stub. The user then indicates if they wish to change the stub 
impedance. When Yes is selected, new values of Zc1 and n are requested. 
The open stub characteristic impedance is reduced by the square of the 
ratio of the new value of n to the original value of n. Iteration of the 
specified values of Zc1 and n generally results in realizable values. Finally, 
the relative dielectric contstant of the lines is prompted. 

Distributed Filters 
157 
13.3.5 Kuroda-Minnis Transform 
The Kuroda-Minnis transform is used to convert the shorted and open 
wirelines in Fig. 13.8a into realizable elements. Several intermediate steps 
are automatically invoked by S/Filter, with the result given as Fig. 13.8e. 
Normally, the left three elements of this final result are later converted to a 
combline PCL. S/Filter begins the Kuroda-Minnis transform by splitting 
the shorted wireline Z2 into two elements. The value of the left element is 
specified using Eq. 13.32. Next, a Kuroda Wireline Transfers: Full: Series 
Shorted Right is applied to Z1 resulting in Fig. 13.8c. Next, Z2b and Z3 are 
swapped and a Kuroda Wireline Transfers: Full: Series Open Right is 
applied to Z9, resulting in Fig. 13.8d. Finally, the transformer is shifted to 
the right and a Kuroda Wireline Transfers: Full: Series Shorted Right is 
applied to Z8 resulting in Fig. 13.8e. 
The resulting element values are 
a
ac
b
a
Z a
2
4
2
2
−
+
=
                                                (13.32) 
where 
3
2
1
2
Z
Z
Z
a
+
+
=
                                                    (13.33) 
(
)
3
1
2
1
2
Z
Z
Z
b
+
=
                                                     (13.34) 
2
2
1
3
2
1
Z
Z
Z
Z
Z
c
+
−
=
                                                 (13.35) 
then 
1
2
1
4
1
Z
Z
Z
Z
a 




+
=
                                                      (13.36) 
a
a
Z
Z
Z
Z
2
2
1
9
1





+
=
                                                    (13.37) 
9
3
1
1
Z
Z
nT
+
=
                                                           (13.38) 
1
9
8
T
n
Z
Z =
                                                              (13.39) 
1
3
5
T
n
Z
Z =
                                                              (13.40) 

158 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 13.8 Kuroda-Minnis transform steps. 
 

Distributed Filters 
159 
2
1
2
T
b
x
n
Z
Z =
                                                              (13.41) 
4
8
8
6
1
Z
Z
Z
Z
Z
x
=





+
=
                                                    (13.42) 
8
7
Z
Z
Z
x +
=
                                                          (13.43) 
The Kuroda-Minnis transform in S/Filter allows the user to split the 
series open-wireline Z3 before applying the transform. The parameter 
option k is the impedance fraction applied to the new Z3 used in the 
transform. The remaining fraction, (1-k)Z3, becomes a series open-wireline 
that remains after the transform. 
13.3.6 Half-Angle Transform 
Given in Fig. 13.9 are half-angle transforms. These transforms replace lines 
with lines of one-half the original length. When applied to a subset of lines, 
the filter is no longer commensurate and subsequent compound operations 
such as Equate All Open Stubs are voided. Nevertheless, half-angle 
transforms may result in better realization, and when combined with 
original length lines, the stopband performance is improved. 
In each case 
2
1
3
2
θ
θ
θ
=
=
                                                       (13.44) 
then the line characteristic impedance are 
a
a
a
Z
Z
Z
1
3
2
=
=
                                                    (13.45) 
2
1
3
2
b
b
b
Z
Z
Z
=
=
                                                    (13.46) 
c
c
c
Z
Z
Z
1
3
2
2
=
=
                                                   (13.47) 
2
1
3
2
a
d
d
Z
Z
Z
=
=
                                                    (13.48) 
e
e
e
Z
Z
Z
1
3
2
2
=
=
                                                    (13.49) 
1
2
5.0
1
2
+
=
f
f
Z
Z
                                                    (13.50) 
(
)1
2
5.0
1
3
+
=
f
f
Z
Z
                                                (13.51) 
 

160 
Filter Synthesis Using Genesys S/Filter 
 
Figure 13.9 Half-angle transforms. 
 

Distributed Filters 
161 
13.3.7 Interdigital Transform 
Given in Fig. 13.10a is the transform Coupled Lines: Interdigital Lines: 
Open, Open, which converts two open wirelines and a UE to an interdigital 
PCL. The formulas for the symmetric PCL with Z1 equal to Z3 are: 
2
1
0
2Z
Z
Z e
+
=
                                                    (13.52) 
1
0
Z
Z o =
                                                           (13.53) 
 
Figure 13.10 (a) Interdigital and (b) combline transforms. 
13.3.8 Combline Transform 
Fig. 13.10b shows the transform Coupled Lines: Comb Lines: Open, Open, 
which converts a wireline and two open stubs to a combline PCL. The 
formulas for the symmetric PCL with Z1 equal to Z3 are: 
1
0
Z
Z e =
                                                               (13.54) 
2
1
2
1
0
2
Z
Z
Z
Z
Z o
+
=
                                                      (13.55) 

162 
Filter Synthesis Using Genesys S/Filter 
13.4 Lumped to Distributed Equivalent Transforms 
Current flowing longitudinally in a TEM-mode transmission line develops 
an encircling magnetic field that impedes the current flow. The 
transmission line thus possesses series inductance. The electric field 
developed in the insulating material between the center conductor and the 
ground 
represents 
capacitance. 
This 
incremental 
inductance 
and 
capacitance is uniform along the length of the transmission line, thus the 
term “distributed.” Fig. 13.11 illustrates the relationships between short 
TLE parameters and the equivalent lumped-element circuit. The 
distributed and lumped parameters are related by: 
2
tan
2
0
1
θ
π
Z
fL =
                                                       (13.56) 
θ
π
sin
2
1
0
1
Z
fC =
                                                           (13.57) 
When the line is narrow, the inductance predominates and the 
capacitance is ignored. In this case, the series inductance of the model is 
the sum, or twice the value of L1. When the line is wide, capacitance 
predominates and the inductance is ignored. In summary, a narrow line 
appears inductive and a wide line appears capacitive. 
Ζο
θ
L1
L1
C1
TL1
 
Figure 13.11 Short TLE and lumped-element equivalent model. 
Fig. 13.12 illustrates the relationships between short TLEs configured 
as open or shorted stubs. When the stub is shorted, the TLE appears like an 
inductor to ground. When the stub is open, the TLE appears like a capacitor 
to ground. The TLE and lumped parameters are related by: 
θ
π
tan
2
0
2
Z
fL =
                                                         (13.58) 
θ
π
tan
2
1
0
3
Z
fC =
                                                           (13.59) 

Distributed Filters 
163 
 
Figure 13.12 Short TLE shorted and open stub and lumped-element equivalent model. 
Fig. 13.13 illustrates the relationships between resonant TLEs and 
lumped-element equivalents. A shorted TLE that is electrically 900 long 
appears like a parallel L-C to ground. An open TLE that is electrically 900 
long appears like a series L-C to ground. Finally, a TLE in series with the 
transmission path that is 1800 long appears like a series L-C. The parameter 
relationships are: 
π
π
0
5
4
2
Z
fL =
                                                               (13.60) 
4
2
0
6
Z
fL
π
π
=
                                                               (13.61) 
2
2
0
7
Z
fL
π
π
=
                                                               (13.62) 
x
x
fC
fL
π
π
2
1
2
=
                                                            (13.63) 
These circuits are only approximately equivalent. The accuracy of the 
short transmission-line equivalence improves with shorter line lengths, and 
the resonant TLE and lumped equivalents are exact only at the design 
frequency f. Nevertheless, these relationships are useful for designing 
distributed filters by beginning with a lumped-element circuit and 
converting these elements into TLEs. 
 

164 
Filter Synthesis Using Genesys S/Filter 
 
Figure 13.13 Resonant TLE and lumped-element equivalent model. 
13.5 Inverters 
An ideal impedance inverter behaves like a transmission line that is a 
quarter-wavelength long at all frequencies [4]. If the line with characteristic 
impedance K is terminated in an impedance Zb at one end, the impedance 
seen looking into the other end is Za where 
b
a
Z
K
Z
2
=
                                                              (13.64) 
Likewise, for an admittance inverter of characteristic admittance J, 
then 
b
a
Y
J
Y
2
=
                                                              (13.65) 
Inverters are used to obtain more realistic element values by scaling the 
impedance level of a filter. Inverters are also used to transform a parallel 
resonator to a series resonator, and vice versa. This can be used to convert a 
conventional bandpass filter into a topology with all parallel or all series 
resonators. The process of inserting an inverter is exact and does not alter 
the responses of the filter. However, ideal inverters do not exist. Inverters 
are replaced with realizable structures that approximate an ideal inverter 
over a limited bandwidth. For bandpass filters, the approximation is 
adequate for a wide variety of applications. One realizable structure is a 
transmission line of characteristic impedance K or admittance J that is a 
quarter-wavelength long at the center frequency of a bandpass filter. 
Certain pi, tee and “L” networks constructed using inductors or using 

Distributed Filters 
165 
capacitors behave as inverters over wider bandwidth than do quarter-
wavelength long lines. Some of the element values of these L-C networks 
are negative, but these networks are successfully used by absorbing the 
negative values into adjacent elements. Formula for replacing inverters 
with realizable networks are given in [4]. S/Filter includes over 30 
transforms for inserting and replacing inverters. These transforms are 
accessed through the Inverter folder in the Transform tab. This book 
includes numerous examples of inverter use for both lumped and 
distributed filters. 
13.6 The Convert Using Advanced TLine Routine 
Distributed synthesis generates a schematic with ideal transmission lines 
defined by electrical parameters. The Genesys environment includes the 
Convert Using Advanced TLine routine that automatically converts the 
schematic to physical models for the TLEs. The routine handles all 
transmission line processes supported within Genesys. The dialog that 
displays when this routine is invoked is given in Fig. 13.14. This routine has 
options to 
1) Select from substrate definitions included in the schematic or libraries. 
2) Select any or all of the TLEs. 
3) Select the desired manufacturing process. 
4) Using these first three options, to mix processes within the schematic. 
5) Automatically add DisCos, which are discontinuities with parameters 
that automatically track with adjacent lines that are tuned or 
optimized. 
6) Absorb DisCos into adjacent lines to attempt to preserve the response. 
For example, the line terminated by an open end is shortened to 
correct for the loading by the end-effect capacitance. 
The combination of these features significantly simplifies the process of 
transitioning a design from synthesis to a real design. 

166 
Filter Synthesis Using Genesys S/Filter 
 
Figure 13.14 Dialog for the Advanced TLine routine. 
13.7 Box Modes 
A conductive housing that encloses a filter is a cavity. At the frequencies of 
cavity resonance, TLE discontinuities such as open-ends, bends, and steps 
easily couple energy into and out of the cavity. At these resonant 
frequencies there is little attenuation from filter port to port, regardless of 
the ideal response of the filter. The result is total destruction of the stop 
bands. Between resonant frequencies, the ultimate stopband attenuation is 
severely limited. Larger housings lower the resonant frequencies and 
degrade the stopbands at lower frequencies. This is described analytically 
in Chapter 19. 
13.8 Introduction to Distributed Filter Examples 
The next four chapters include numerous examples of distributed lowpass, 
highpass, bandpass, and bandstop filters. The filters in these chapters were 
chosen for their variety and to illustrate concepts applicable to similar 
structures. Until the designer has considerable experience with distributed 
filters, the appropriate initial extraction, and which transforms must be 
applied, are far from obvious. An appropriate starting point for the novice 
is by using an example from these chapters that is similar to the target 
filter. 

Distributed Filters 
167 
References 
[1] P.I. Richards, “Resistor-Transmission-Line Circuits,” Proc. IRE,  Vol. 36, 
February 1948. 
[2] B. J. Minnis, Designing Microwave Circuits by Exact Synthesis, Artech House, 
Norwood, MA, 1996. 
[3] R. Rhea, “Technology Enables New Components,” Microwave Journal, 
November 2006. 
[4] G. Matthaei, L. Young, and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Norwood, MA, 1980. 


 
169 
 
14 Distributed Lowpass Filters 
This chapter covers the design of both all-pole and generalized 
distributed lowpass filters by both exact and approximate methods. This 
chapter also illustrates techniques for reducing the physical size of the 
filters to potentially reduce box-mode degradation of the stopbands. 
In this chapter, each example lowpass filter is fifth-degree designed 
with a 0.0432-dB passband ripple and a cutoff frequency of 2400 MHz. 
They are implemented on microstrip with a 50-mil-thick Rogers TMM6 
substrate with quarter-ounce copper. 
14.1 Exact Methods 
This section describes distributed lowpass filters that are initially 
synthesized using exact methods. This initial synthesis forms a foundation 
for the later realization of practical forms. The initial synthesis is also an 
important academic exercise. In this section, each example lowpass is 
carried through the design process to filters realized with microstrip or 
coaxial elements. 
14.1.1 Lowpass with Redundant UEs 
The design is based on Richards transform and utilizes commensurate-
length series and stub TLEs. Design begins with the Specification tab given 
in Fig. 14.1. Notice that the Distributed radio button is selected and the ¼ 
Wave Freq (fq) for the TLEs is specified as 6000 MHz. To result in the 
widest possible stopbands, this frequency should be as high as possible 
without resulting in unrealizable TLE characteristic impedance. Unless 
otherwise noted, extreme minimum and maximum characteristic 
impedances of 20 and 120 ohms are used in this book. The ¼ Wave Freq 
may require later iterative adjustment to optimally satisfy the minimum 
and maximum impedances. 

170 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.1 Specification tab for the exact lowpass filter with series and stub TLEs. 
The resulting filter is shown in Fig. 14.2a. The characteristic 
impedance, physical length in millimeters, and the effective relative 
dielectric constant for each TLE is listed. The electrical length is 900 at 6 
GHz, or 360 at the 2.4-GHz cutoff frequency. Unfortunately, the series wire-
line shorted stubs are unrealizable. To eliminate the series wire-line 
shorted stubs, the following transforms are applied: 
1) Two series 50-ohm transmission lines are added at the input and 
output of the filter. Since the characteristic impedance of these lines 
equals the termination impedance, they add only phase shift and do 
not influence the amplitude responses. Their length must equal the 
TLE commensurate length in Fig. 14.2a. This results in Fig. 14.2b. 
2) Kuroda Wireline Transfer: Full: Shunt Open Right transform is 
applied to TL2 in Fig. 14.2b. This converts TL2 and the open stub TL3 
into a series wireline shorted stub and a transmission line. This creates 
TL2 and TL3 in Fig. 14.2c. 
3) Similarly, a Kuroda Wireline Transfer: Full: Shunt Open Left is 
applied to TL8 in Fig. 14.2b. 
4) The four unrealizable series wire-line stubs are eliminated by applying 
four Kuroda Wireline Transfer: Full: Series Shorted Right or Series 
Shorted Left transforms to each pair of series transmission line and 
series-shorted stub beginning with TL1 and TL2. The resulting 
structure is given in Fig. 14.2d. 

Distributed Lowpass Filters 
171 
 
 
 
 
 
 
Figure 14.2 Transformation steps for the exact lowpass filter with series and stub TLEs. 
The filter does not quite meet the desired minimum and maximum 
characteristic-impedance limits in that TL1 and TL9 exceed the desired 
maximum TLE characteristic impedance of 120 ohms. The ¼ Wave Freq 
parameter could be increased to decrease the characteristic impedance of 
TL1, but this has the affect of decreasing the characteristic impedance of 
TL5. 
The amplitude responses of the filter are given in Fig. 14.3. As can be 
seen, the design is exact as evidenced by a cutoff at precisely 2.4 GHz and 
an equal passband return loss of 20 dB. Also evident is a primary limitation 

172 
Filter Synthesis Using Genesys S/Filter 
of distributed filters. TLE reentrance results in an additional passband 
beginning at 9.6 GHz. Actually, a second passband removed by four times 
the frequency of the desired passband is good stopband performance for a 
distributed filter. 
 
 
Figure 14.3 Responses of the five-section 2.4-GHz lowpass filter designed in S/Filter based 
on Richards’ transform and transformed using Kuroda. 
Given at the top in Fig. 14.4 is a schematic of the microstrip realization 
of this filter. Fifty-ohm input and output lines are manually added to the 
filter to provide interface with housing input and output connectors. This 
schematic is created automatically using the Convert Using Advanced 
TLine feature of Genesys. The conversion begins with the final electrical 
parameters given in Fig. 14.2 and executes the following steps: 
1) The electrical TLE parameters are converted to physical dimensions for 
the user specified manufacturing process, such as microstrip, stripline, 
and coax, on the user-specified substrate parameters. 
2) If requested, discontinuities are added as necessary at points such as 
line junctions, steps, bends, and open-ends. These automatic 
discontinuities are called “DisCos.” 
3) If requested, the line lengths are adjusted in an attempt to compensate 
for the effects of the DisCos. 
Notice that the lengths of the TLE are no longer commensurate. The TLE 
stubs are shorter because of compensation for the stub microstrip open-end 
discontinuities. 

Distributed Lowpass Filters 
173 
 
 
Figure 14.4 The 2.4-GHz lowpass schematic (top) as realized in microstrip with dimensions 
and discontinuities automatically added by the Genesys feature Covert Using Advanced 
TLine. The layout is given at the bottom (2X scale). 
Next, Add Layout is applied to the microstrip schematic in the Genesys 
workspace tree. The resulting layout is given at the bottom of Fig. 14.4. 
Notice the extreme dimensions of the series TLE to TLE stub Tee 
discontinuity. In addition, the width of the microstrip open-end is as great 
as the length of the TLE stubs. In fact, the Genesys program displays 
warnings about layout dimensions. 
The response computed by circuit theory simulation is given in Fig. 
14.5. The discontinuities required for the realization of this filter  
significantly disturb the response. The cutoff frequency is increased to 2.7 
GHz, the return loss is degraded to 16 dB, and the reentrance modes are 
modified. 
Given at the top in Fig. 14.6 is the schematic of the 2.4-GHz filter after 
optimization of TLE lengths to correct for the perturbations of the 
discontinuities. Variables are assigned to the lengths of TL2 through TL6 to 
retain physical symmetry and they are optimized. The optimized layout is 
shown at the bottom of Fig. 14.6. Optimization slightly lengthens the filter. 

174 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.5 Responses computed by circuit-theory simulation of the of the 2.4-GHz filter 
realized in microstrip. 
 
 
Figure 14.6 The 2.4-GHz lowpass schematic (top) with realized in microstrip after optimization 
of dimensions. The layout is shown at the bottom (2X scale). 
The response after optimization of line lengths is given in Fig. 14.7. 
Optimization goals are a 20-dB return loss from DC to 2.4 GHz with the 40-
dB stopband rejection frequency limits manually adjusted to 4 to 7.2 GHz 
to achieve the best available responses. 
 

Distributed Lowpass Filters 
175 
 
Figure 14.7 Optimized responses of the 2.4-GHz filter initially designed using exact methods. 
14.1.2 Stub TLEs and Contributing Unit Elements 
The four 50-ohm TLEs added to the previous lowpass as illustrated in Fig. 
14.2b are redundant. Driven or loaded by 50-ohm terminations, they do not 
contribute to the selectivity of the filter. Although their impedance is 
altered as they transform all elements to realizable form, they remain 
redundant. These redundant elements add four TLEs of commensurate 
length and therefore increase the physical size of the structure. 
Rather than specifying five TZs at infinity, three TZs are specified at 
infinity and two unit elements (UEs) are specified. The Specification tab is 
shown in Fig. 14.8. If the Series Element First option is selected in the 
Extraction tab, the synthesized topology includes three shorted wirelines 
cascaded with the UEs. This structure is unrealizable. However, if the 
Series Element First option is not selected, the UEs are cascaded with 
open-stub TLEs as illustrated in Fig. 14.9a. 
The characteristic impedances of the TLEs are less extreme than the 
desired 20- to 120-ohm limits. In order to improve the stopband 
performance, the ¼ Wave Freq is increased to 6557.5 MHz to increase the 
characteristic impedance of TL2 and TL4 to 120 ohms. The result is shown 
in Fig. 14.9b. This decreases the impedance of TL3 below 20 ohms. This is 
dealt with by splitting TL3 into two shunt elements as shown in Fig. 14.9c. 
TL4 is rotated 1800 in the schematic to facilitate realization of the structure. 
The synthesis and transforms to this point are exact. 
 

176 
Filter Synthesis Using Genesys S/Filter 
  
Figure 14.8 Specification tab for the lowpass with contributing UEs. 
Next, the electrical schematic is converted into microstrip and 
discontinuities using Convert using Advanced TLine and short lengths of 
input and output transmission lines are added. The results are given in Fig. 
14.9d. The conversion is approximate because discontinuities are required 
to realize the physical structure. 
The synthesized ideal responses of the resulting lowpass are given on 
the left in Fig. 14.10 and the simulated responses in microstrip with 
discontinuities are given on the right. 
14.1.3 Lowpass with Only Contributing UEs (Stepped-Z) 
A useful class of distributed filters consists entirely of cascaded 
transmission lines of alternating low and high impedance. These are often 
referred to as stepped-impedance or stepped-Z filters. They are particularly 
important for realization in coaxial line because stubs are inconvenient to 
manufacture. 
The design for a 2.4-GHz fifth-degree filter begins with the 
specification of no TZs at infinity and five UEs. The remaining parameters 
in the Specification tab are unchanged. The desired coaxial minimum and 
maximum characteristic-impedance targets selected are 10 and 110 ohms. 
Shunt element first results in the more desirable initial impedances. The 
initial design with a ¼ Wave Freq of 6 GHz is given in Fig. 14.11a. The ¼ 
Wave Freq is increased to 6.76 GHz so that the maximum characteristic 
impedance is 110 ohms with the result given in Fig. 14.11b. The dimensions 

Distributed Lowpass Filters 
177 
after converting with Convert Using Advanced TLine to coaxial elements 
are given in Fig. 14.11c. 
 
 
 
d
L=5.91mm
W=0.18mm
TL2
L=4.8mm
W=3.57mm
TL1
L=4.85mm
W=3.05mm
TL3
L=4.85mm
W=3.05mm
TL4
L=5.91mm
W=0.18mm
TL5
L=4.8mm
W=3.57mm
TL6
ZO=50Ω
L=1.45mm
W=1.88mm
TL7
ZO=50Ω
L=1.45mm
W=1.88mm
TL8
 
 
 
Figure 14.9 Design sequence for the 2.4-GHz lowpass with contributing UEs (2X scale). 

178 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.10 Initial synthesized responses (left) and microstrip responses (right) of the 2.4-
GHz lowpass with three TZs at infinity and two contributing UEs. 
The relatively low ratio of maximum to minimum characteristic 
impedance required to synthesize this filter results in very poor stopband 
performance. The responses are given in Fig. 14.12. 
 
 
 
 
Figure 14.11 Schematic with (a) a 6-GHz quarter-wave frequency, (b) a 6.76-GHz quarter-
wave frequency, and (c) realized in coax. 

Distributed Lowpass Filters 
179 
 
Figure 14.12 Responses of the coaxial stepped-impedance 2.4-GHz lowpass. 
A manufacturing process that allows a very thin center conductor with 
high characteristic impedance, or higher order, improves the stopband 
performance of this coaxial filter. Moding in coax is less of an issue than in 
housed microstrip, so the additional length of a higher-order filter is less 
problematic. 
The stepped-impedance lowpass is a convenient structure for many 
applications, and it is a common form of distributed-lowpass filters. 
Approximate design techniques that result in better stopband performance 
are illustrated in Section 14.2. 
14.1.4 Generalized Lowpass Filter 
Generalized filters offer improved skirt selectivity at the expense rejection 
well into the stopband. Because reentrance modes lower the expectation of 
stopband depth, the improved skirt selectivity of generalized filters is 
particularly attractive. 
Consider the following generalized fifth-degree Chebyshev passband 
lowpass with one FTZ and 30-dB minimum stopband attenuation. The 
initial specification includes a ¼ Wave Freq of 6 GHz, one TZ at infinity, 
two UEs, and one TZ at 3490 MHz. The electrical schematic is shown in 
Fig. 14.13a. Next, a Kuroda Wireline Transfer: Full: Series Shorted Right 
transform is applied to TL1 and TL2, and a mirror Series Shorted Left is 
applied to then TL5 and TL6. The transform Tlines: Stepped Resonators: 
Finite Zero to Two Step Stub is applied to TL3 and TL4. The result is given 
in Fig. 14.13b. The maximum TLE characteristic impedance is 98.25 ohms. 

180 
Filter Synthesis Using Genesys S/Filter 
The ¼ Wave Freq is then increased to increase the maximum 
characteristic impedance to approximately 120 ohms. This requires a small 
adjustment in the FTZ frequency to retain the minimum stopband 
attenuation of 30 dB. These two adjustments typically require a few 
iterations to satisfy the maximum characteristic impedance and minimum 
stopband attenuation. The final ¼ Wave Freq is 7540 MHz and the FTZ is 
set to 3550 MHz. The resulting electrical schematic is given in Fig. 14.13c. 
The high ¼ Wave Freq results in good stopband performance for a 
distributed filter, as shown on the left in Fig. 14.14. 
The electrical schematic is then converted to microstrip using Convert 
Using Advanced TLine with the 50-mil TMM6 substrate. Again, 1.45-mm 
long 50-ohm microstrip lines are added at the input and output. The 
microstrip schematic is given in Fig. 14.13d and the layout is given in Fig. 
14.15. 
The circuit-theory simulated response for the microstrip form is given 
on the right in Fig. 14.14. The ideal stopband performance from 3.6 to 11 
GHz of the electrical design is significantly compromised in the microstrip 
form. The large microstrip tees required to interface the wide TLE open 
stubs at the input and output are largely responsible for this stopband 
degradation. The Genesys simulator displays warnings about the physical 
dimensions for this filter. Some of the limitations imposed on this design by 
the commensurate requirements of Richards transform can be reduced by 
the use of approximate methods. Approximate methods are the subject of 
Section 14.2. 
14.2 Approximate Methods 
Previous examples show that the exact aspect of filter design is somewhat 
academic because realization of structures in physical form introduces 
discontinuities that have a significant effect on the responses. In addition, 
the introduction of additional TLEs to resolve unrealizable wire-line 
structures results in a filter that is significantly larger than necessary. 
Finally, the commensurate requirement of Richards transform may 
preclude the use of shorter lines to improve stopband performance. This 
section describes methods that are approximate but that avoid the later two 
issues. 
 

Distributed Lowpass Filters 
181 
   
 
 
 
 
Figure 14.13 Transform steps for the generalized fifth-degree 2.4-GHz lowpass. 

182 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.14 Responses of the electrical schematic (left) and microstrip form (right) of the 
generalized lowpass. 
 
Figure 14.15 Layout of the generalized 2.4-GHz lowpass (2X scale). 
14.2.1 All-Pole: Equivalent Series TLE and Shorted Stubs 
Consider the Series Element First form of the five-section all-pole lowpass 
in Fig. 14.2a. The reason for shifting to the Series Element First form is 
evident later in this section. The series-shorted TLE stubs are unrealizable, 
and in the exact design, redundant UEs are added to transform these 
series-shorted TLE stubs. This adds four TLEs of commensurate length, 
thus substantially increasing the size of the filter. In this section, the initial 
design of the 2.4-GHz lowpass filter uses approximate methods. Design 
begins with the same Specification tab except the ¼ Wave Freq is adjusted 
to 5858 MHz to set the maximum characteristic impedance of TL3 at 120 
ohms. The result is given in Fig. 14.16a. The following transforms are then 
applied: 
1) Both shunt TLE open stubs are converted to shunt capacitors using 
Distributed to Lumped Equivalents: Open Stub to Shunt C at the 
cutoff frequency 2400 MHz. These transforms are approximate. 
2) Both shunt Cs are split using Basic Operations: Split Shunt Element. 

Distributed Lowpass Filters 
183 
3) Each shunt capacitor is converted to a shunt TLE open stub using 
Lumped to Distributed Equivalents: Shunt C to Open Stub with the 
Chose Theta option. The conversion frequency is 2400 and the chosen 
TLE length is 180. This length causes the open stubs to be FTZs at 
12,000 MHz. 
4) Each shorted wireline is converted to a TLE using Tlines: Shorted 
Wireline to TLine. 
These steps result in Fig. 14.16b. The cutoff frequency is reduced to 
approximately 2 GHz. This is corrected by optimization later. Using the 
Genesys schematic editor, TL3 in Fig. 14.16b is rotated to vertical and 
moved to the left to form a cross with TL2. The same change is applied to 
the second pair of shunt TLE stubs. Short 50-ohm TLEs are added at the 
input and output. The electrical schematic is then converted to microstrip 
on TMM6 using Convert using Advanced TLine. The microstrip schematic 
is given in Fig. 14.16c.  
The responses are given on the left in Fig. 14.17. The discontinuities 
have a strong influence on the resulting response. The cutoff frequency is 
too low in frequency and the stopbands are degraded. The microstrip 
crosses are the primary offenders in this filter. The lengths of the series 
TLEs and the stubs, as well as the width of the stubs, are optimized in an 
attempt to correct the cutoff and improve the stopbands. Variables for these 
parameters are used to force symmetry. This also reduces the number of 
variables that must be optimized. The resulting responses are given on the 
right in Fig. 14.17. 
14.2.2 Stepped Impedance Lowpass 
The stepped-impedance lowpass in Section 14.1.3 is designed using an 
exact method with cascaded UEs. The resulting commensurate filter has 
characteristic impedances that are not as extreme as can be realized, thus 
degrading the stopband. In this section, the stepped-impedance lowpass is 
designed using approximate methods that result in TLEs with extreme, 
user-selectable TLE characteristic impedance. 

184 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 14.16 Series TLE and shorted-stub lowpass designed using approximate transforms. 

Distributed Lowpass Filters 
185 
 
Figure 14.17 Responses before optimization (left) and after optimization (right) of the 
microstrip series TLE and open-stub 2.4-GHz lowpass. 
 
Figure 14.18 Layout of the optimized series TLE and open-stub lowpass (2X scale). 
The design begins with the 2.4-GHz lumped element filter given in Fig. 
14.19a. The series inductors are converted to series TLEs using Lumped to 
Distributed Equivalents: Series L to TLine with a conversion frequency of 
2400 MHz and a characteristic impedance of 120 ohms. The shunt 
capacitors are converted using Lumped to Distributed Equivalents: Shunt 
C to TLine with a conversion frequency of 2400 MHz and a characteristic 
impedance of 20 ohms. Again, 50-ohm input and output lines are added. 
The electrical schematic is given in Fig. 14.19b and the schematic after 
conversion to microstrip on TMM6 is given in Fig. 14.19c. The layout is 
shown in Fig. 14.19d at approximately 2x actual size. 
Shown on the left in Fig. 14.20 are the responses of the stepped-
impedance 2.4-GHz lowpass with electrical TLE models and on the right 
after conversion to microstrip with discontinuities on 50-mil TMM6. 

186 
Filter Synthesis Using Genesys S/Filter 
L=3.22nH
L1
L=5.97nH
L2
L=3.22nH
L3
ZO=50Ω
ZO=50Ω
C=1.82pF
C1
C=1.82pF
C2
a
 
 
 
 
Figure 14.19 Transform history of the stepped-impedance 2.4-GHz lowpass design by 
converting an L-C form to distributed equivalents. The layout is given at the bottom (2X scale). 
 
Figure 14.20 Responses of the TLE stepped-impedance 2.4-GHz lowpass (left) and in 
microstrip including discontinuity models (right). 
The cutoff frequency is approximately 20% lower than desired. The 
microstrip filter is optimized to correct the cutoff and attempt to improve 
the stopband performance from 4800 to 9600 MHz. Symmetry is forced 

Distributed Lowpass Filters 
187 
using variables. Narrower lines would improve the stopbands, but the 
widths are at the desired minimum widths, so they are not optimized. It is 
anticipated that optimization would shorten the TLE lengths to increase the 
cutoff frequency and that it would widen TL2 and TL4 to improve the 
stopbands, and that is what happens. The optimized microstrip schematic 
is given in Fig. 14.21 and the optimized response in Fig. 14.22. 
 
 
Figure 14.21 Schematic of the microstrip optimized stepped-impedance 2.4-GHz lowpass. 
 
Figure 14.22 Responses of the optimized stepped-impedance microstrip filter. 
14.2.3 Generalized Lowpass 
In this section, the generalized lowpass filter designed with exact methods 
in Section 14.1.4 is designed using approximate methods. Liberated from 
the constraints of commensurate lengths, the approximate filter is 6% 
shorter and 33% less high. The design begins with a lumped-element filter 
with three TZs at infinity and one TZ at 3580 MHz. The resulting schematic 
is given in Fig. 14.23a. Next, the series inductors and shunt capacitors are 
transformed to TLEs using the Lumped to Distributed Equivalents: Series 
L to TLine and Shunt C to Open-Stub. 
 

188 
Filter Synthesis Using Genesys S/Filter 
C=1.32pF
C1
L=3.72nH
L1
L=3.72nH
L3
C=1.32pF
C3
L=1.29nH
L2
C=1.53pF
C2
ZO=50Ω
ZO=50Ω
a
 
 
c
L=5mm
W=0.18mm
TL2
L=3.29mm
W=7.33mm
TL6
L=1.65mm
W=0.18mm
TL5
L=5mm
W=0.18mm
TL3
ZO=50Ω
L=1.45mm
W=1.88mm
TL7
L=2.81mm
W=7.33mm
TL1
L=2.81mm
W=7.33mm
TL4
ZO=50Ω
L=1.45mm
W=1.88mm
TL8
 
L=1.45mm
W=1.88mm
TL7
L=1.45mm
W=1.88mm
TL8
L=4.6mm [L2]
W=0.18mm
TL3
L=4.6mm [L2]
W=0.18mm
TL2
L=1.55mm [L5]
W=0.18mm
TL5
L=4mm [L6]
W=5.3mm [W6]
TL6
L=4.32mm [L1]
W=5.3mm [W6]
TL4
L=4.32mm [L1]
W=5.3mm [W6]
TL1
ZO=50Ω
ZO=50Ω
d
 
Figure 14.23 Design steps for the generalized 2.4-GHz lowpass by approximate design. 

Distributed Lowpass Filters 
189 
Unfortunately, the transform routines in S/Filter do not include a 
transform for a shunt inductor that is not grounded. Therefore, the 
equations in Section 13.4 are used to manually convert L2 to a TLE. 
Likewise, C2 is converted to an open stub. The electrical schematic is given 
in Fig. 14.23b. This is converted to microstrip on 50-mil TMM6 using 
Convert Using Advanced TLine and short 50-ohm input and output lines 
are added. The schematic is given in Fig. 14.23c and the responses are given 
on the left in Fig. 14.24. 
 
 
Figure 14.24 Responses of the microstrip-generalized 2.4-GHz lowpass designed by 
approximate methods (left) and after optimization (right). 
The cutoff frequency is low and the passband return loss is poor. 
Optimization is used to correct the passband and to improve the stopband 
from 3600 to 9600 MHz. Symmetry is used to retain symmetry. The length 
of each TLE and the width of the wide stubs are optimized. The responses 
after optimization are given on the right in Fig. 14.24. The layout at 
approximately 2x actual size is given in Fig. 14.25. 
 
 
Figure 14.25 Layout of the microstrip-generalized 2.4-GHz lowpass designed by approximate 
methods after optimization (2X scale). 

190 
Filter Synthesis Using Genesys S/Filter 
14.3 Size Reduction by Penetration 
Box-mode suppression and PCB space conservation motivate the 
miniaturization of all filters. Reconsider the stepped-impedance lowpass in 
Section 14.2.2. The length of the low-impedance TLEs contribute to the 
structure length. These TLE provide capacitance to ground via their area. 
The area of these lines may be retained while the high-impedance series 
TLEs penetrate the area and meet near the middle of the low-impedance 
TLE. The geometry is envisioned by examining the final layout in Fig. 
14.28. Design begins with the lumped-element filter given in Fig. 14.19a. 
The following transforms are then applied: 
1) The series inductors are converted to 120-ohm TLE at 2400 MHz using 
Lumped to Distributed Equivalents: Series L to TLine. 
2) The shunt capacitors are converted to 20-ohm open-stubs at 2400 
MHz with Lumped to Distributed Equivalents: Shunt C to Open-Stub. 
3) Next, 0.54 long by 0.18 mm wide TLEs are manually added to the 
schematic between the series TLE and the open-stub TLE. 
4) Short 50-ohm input and output lines and discontinuity steps are 
manually added to the schematic. 
In essence, step two converted the stepped-impedance lowpass into a 
filter with two low-impedance stubs. This results in the schematic in Fig. 
14.26a. Convert Using Advanced TLine is then used to convert the 
electrical design to microstrip on 50-mil TMM6 substrate. The schematic is 
given in Fig. 14.26b. When the discontinuities are absorbed into the 
microstrip TLE, the line lengths of TL6 and TL9 are modified. They are 
manually returned to 0.54 mm in length. 
The resulting response is given on the left in Fig. 14.27. The cutoff 
frequency is too low. The length of the non-50-ohm TLE are optimized 
while forcing symmetry using variables to define the lengths. The 
stopbands are optimized to at least 30 dB from 4200 to 8700 MHz. The 
resulting dimensions are given in Fig. 14.26c and the responses are given 
on the right in Fig. 14.27. 
The layout is given in Fig. 14.28. The high-impedance lines do not 
simply cascade with the low-impedance stubs since the widths of the low-
impedance stubs do not contribute to the overall length of the filter. 
Consequently, the total length of this filter is 16 mm, as opposed to the 
29.7-mm length of the conventional stepped-impedance lowpass. An 
alternative approach that significantly reduces the height of the filter is to 
place both stubs on the same side of the high-impedance lines. In this case, 
the stubs almost contact at the sides. This is easily corrected by manually 
reducing the width of the stubs slightly before optimization of the filter. 
This filter is investigated further using EM simulation in Chapter 19. 

Distributed Lowpass Filters 
191 
 
 
 
 
Figure 14.26 Electrical TLE schematic of the penetrating double-stub 2.4-GHz lowpass filter. 

192 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.27 Penetrating stepped-impedance 2.4-GHz microstrip response before (left) and 
after (right) optimization of the line lengths. 
 
Figure 14.28 Layout of the penetrating stepped-impedance 2.4-GHz lowpass (2X scale). 
14.4 Radial Stub Lowpass 
This unique lowpass requires approximate and manual design methods, but 
the resulting filters are compact and effective. Radial stubs are fan-shaped, 
open-stub TLEs with the narrow end connected to the through path. Dual 
stubs on each side of the through path are referred to as butterfly radial 
stubs, or butterfly stubs. Radial stubs offer a well-defined reference plane 
and better stopband bandwidth than conventional stubs.  
Unfortunately, computing the input impedance of radial stubs requires 
a series in Bessel functions [1]. However, the Genesys simulator includes a 
radial stub model, so designing filters by tuning or optimizing of manually 
placed radial stubs is straightforward. Wide sweep angles, φ , for radial 
stubs generally improve performance, but to avoid higher order modes, the 
sweep angle is generally specified as 900 or less. 
 
 
 

Distributed Lowpass Filters 
193 
Again, design begins with the lumped-element filter given in Fig. 
14.19a. The following steps complete the design: 
1) The series inductors are converted to 120-ohm TLE at 2400 MHz using 
Lumped to Distributed Equivalents: Series L to TLine. 
2) The shunt capacitors are deleted and replaced with microstrip radial 
stubs (MRSs) above and below the intersection of the series microstrip 
TLEs. Each radial stub is specified with 
0
90
=
φ
and a length set by a 
variable. The Width parameter at the narrow end of the radial stubs is 
specified as the width of the series TLE. 
3) The radial stubs are connected to the series TLE using microstrip cross 
models. 
4) In this case, due to symmetry, all radial stubs are equal length, so there 
is one variable specified for each length. If the filter is higher order or 
is asymmetric, suitable variables are used for each pair and equal sets 
of radial stubs are substituted and tuned for best response before the 
next shunt capacitor is replaced. 
5) Input and output lines are added to interface to connectors. 
Optimization of both the radial stub lengths and the lengths of the 
series TLE is used to finalize the design. The schematic and layout of the 
fifth-degree 2.4-GHz lowpass with radial stubs is given in Fig. 14.29. The 
responses are given in Fig. 14.30. 
 
 
 
Figure 14.29 Schematic and layout (2X scale) of the microstrip radial stub 2.4-GHz lowpass. 

194 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.30 Responses of the microstrip radial stub 2.4-GHz lowpass. 
14.5 Hybrid Lowpass 
A motivation for the use of distributed filters is often the undesirability of 
lumped inductors. The size of lumped inductors must be limited to avoid 
destructive parasitic capacitance, but the small size limits the available 
unloaded Q. The tolerance of TLEs is often better than lumped inductors. 
However, this is generally more of an issue with bandpass filters because 
lowpass filters are less critical for tolerance. 
Some of the drawbacks associated with lumped inductors are less 
severe with capacitors. Modern ceramic chip capacitors are small and have 
excellent unloaded Q. Capacitors with low effective series resistance (ESR) 
have high unloaded Q. An effective filter solution for some applications is to 
use distributed inductors and lumped chip capacitors. These are referred to 
as hybrid filters since they employ a hybrid of lumped and TLEs.  
Consider the following 2.4-GHz hybrid lowpass filter. Again, design 
begins with a lumped-element filter, but a shunt-first extraction is used to 
minimize the quantity of distributed inductors, which reduces size and 
improves the stopbands. The schematic is given in Fig. 14.31. Then the 
series inductors are converted to 120-ohm TLE at 2400 MHz using Lumped 
to Distributed Equivalents: Series L to TLine. Convert Using Advanced 
TLine converts the electrical schematic elements to microstrip on 50-mil 
TMM6 substrate. Footprints of size 0603 are used for the chip capacitors. 
Microstrip steps are manually added between the series TLE elements and 
the input and output lines. The end capacitors are shifted so their metal lies 
on the input and output lines. The footprint metal of middle capacitor adds 

Distributed Lowpass Filters 
195 
extra capacitance that is ignored for this simulation. The responses are 
given on the left in Fig. 14.32.  
Next, the length of the series TLE and the values of the lumped 
capacitors is optimized, the capacitors are then fixed at the nearest 
standard values, and a final optimization of the length of the series TLE is 
completed. The final microstrip schematic and layout are given in Fig. 
14.31. The optimized response is given on the right in Fig. 14.32. 
 
L=4.55nH
L1
L=4.55nH
L2
C=1.29pF
C1
C=2.39pF
C2
C=1.29pF
C3
ZO=50Ω
ZO=50Ω
 
C=1.29pF
C1
K=1
L=12.1mm
Z=120Ω
TL1
C=2.39pF
C2
K=1
L=12.1mm
Z=120Ω
TL2
C=1.29pF
C3
ZO=50Ω
ZO=50Ω
 
ZO=50Ω
L=1.45mm
W=1.88mm
TL3
STP1
L=1.45mm
W=1.88mm
TL4
ZO=50Ω
STP2
C=1.1pF [C1]
C3
C=2pF [C2]
C2
L=6.06mm [L1]
W=0.18mm
TL1
L=6.06mm [L1]
W=0.18mm
TL2
C=1.1pF [C1]
C1
 
 
Figure 14.31 Electrical and microstrip schematics and layout (2X scale) of the hybrid 2.4-GHz 
lowpass. 
This hybrid lowpass has small size and the good stopband performance. 
The excellent stopband performance results partly from the absence of 
reentrance modes in the lumped capacitors. 
Further size reduction is possible by folding the series TLEs. Given in 
Fig. 14.33 is the microstrip schematic resulting from manually folding the 
series TLE and adding chamfered corners. An EMPower EM of the 

196 
Filter Synthesis Using Genesys S/Filter 
compact hybrid lowpass is then used to consider the effects of the footprint 
metal. The lumped elements are then optimized for the best response. The 
results given in Fig. 14.34 illustrate the difficulty in maintaining stopband 
performance beyond a few multiples of the cutoff frequency, even using a 
hybrid approach. Electromagnetic simulation is described in detail in 
Chapter 19. 
 
 
Figure 14.32 Responses of the 2.4-GHz hybrid lowpass before (left) and after (right) 
optimization. 
14.6 Distributed Lowpass Summary 
The design of multiple forms of a fifth-degree 2.4-GHz lowpass illustrates 
design using both exact and approximate direct synthesis. Continuing the 
design through realization in coax or microstrip with layout illustrates that 
practical issues significantly modify results, and strict adherence to exact-
only methods is overly restrictive. The path to a final filter is not unique, 
and the methods described in this chapter are chosen to help the reader 
understand potential techniques. The choices of minimum and maximum 
line impedance vary widely with manufacturing process. An ability to 
maintain tight tolerance on very narrow lines is an advantage for the best 
stopband performance. Small physical size is an important parameter that 
drove the evolution of examples in this chapter. The designer should 
consider unusual topologies, such as radial stub and hybrid lowpass. 
 

Distributed Lowpass Filters 
197 
 
 
Figure 14.33 Microstrip schematic and layout (2X scale) of the compact hybrid lowpass with 
lumped capacitors and folded series TLE. 

198 
Filter Synthesis Using Genesys S/Filter 
 
Figure 14.34 Electromagnetic cosimulation responses of the compact hybrid lowpass. 
Reference 
 [1] F. Giannini, M. Ruggieri, and J. Vrba, “Shunt-Connected Microstrip Radial 
Stubs,” IEEE Trans. Microwave Theory and Techniques, Vol. MTT-34, No. 3, 
December 1986. 
 

 
199 
 
15 Distributed Bandstop Filters 
Examination of the responses on the left in Fig. 14.10 reveals that 
reentrance modes cause lowpass filters synthesized using the Richards 
transform to also possess bandstop responses centered on the ¼ Wave 
Freq (fq). Unfortunately, many bandstop filters require narrow stopbands. 
This causes unrealizable TLE characteristic impedance. This chapter 
includes techniques for managing this problem.  
In this chapter, bandstop filters centered at 5 GHz are designed. The 
higher frequency is best implemented on thinner substrate, so 25-mil-thick 
Rogers TMM6 with half-ounce copper is used for each example. 
15.1 All-Pole with Stubs and Contributing UEs 
This filter type is illustrated using three bandwidths to illustrate three 
different sets of problems and solutions. These designs are concerned with 
performance up to a maximum frequency of 10 GHz. A Lowpass type is 
selected in the Specification tab. 
15.1.1 Wide Bandwidth Bandstop 
Consider a bandstop with passbands from DC to 2 GHz and 8 to 10 GHz. 
This is about the maximum bandwidth for this type of filter. Wider 
bandwidth results in extreme characteristic impedance. In the Specification 
tab, a Distributed filter process with a Cutoff of 2000 MHz, a Ripple of 
0.0432 dB, and fq of 5000 MHz are entered. Two TZs at infinity and three 
UEs are specified. In the Extraction tab, a shunt element first and the 
extraction sequence ∞ UE ∞ UE ∞ are chosen. In the Transform tab, 50-
ohm input and output lines of 1 mm in length are added using Basic 
Operations: Insert Element: Transmission Line. Because the characteristic 
impedance of these inserted TLEs equal the termination resistance, they 
have no influence on the response. They offer metal to attach the first and 
last stubs, and the input and output connectors. The resulting electrical 
schematic is given in Fig. 15.1a and the responses are given on the left in 
Fig. 15.2. The responses reveal symmetry about fq, thus providing a 
bandstop response with approximately 48 dB of rejection from 4 to 6 GHz. 
Greater attenuation or a wider stopband bandwidth is achieved using a 
higher passband ripple or higher order. 

200 
Filter Synthesis Using Genesys S/Filter 
  
L=0.48mm
W=0.93mm
TL1
L=6.83mm
W=1.48mm
TL2
b
L=7.79mm
W=0.12mm
TL3
L=6.49mm
W=3.39mm
TL4
L=7.79mm
W=0.12mm
TL5
L=6.83mm
W=1.48mm
TL6
L=0.48mm
W=0.93mm
TL7
ZO=50Ω
ZO=50Ω
 
L=0.48mm
W=0.93mm
TL1
c
L=0.48mm
W=0.93mm
TL7
ZO=50Ω
ZO=50Ω
L=7.79mm [L3]
W=0.12mm [W3]
TL3
L=7.79mm [L3]
W=0.12mm [W3]
TL5
L=6.83mm [L2]
W=1.48mm [W2]
TL2
L=.12mm
W=.12mm
TL8
L=6.49mm [L4]
W=3.39mm [W4]
TL4
L=6.83mm [L2]
W=1.48mm [W2]
TL6
L=.12mm
W=.12mm
TL9
L=.12mm
W=.12mm
TL10
 
L=0.48mm
W=0.93mm
TL1
d
L=0.48mm
W=0.93mm
TL7
ZO=50Ω
ZO=50Ω
L=7.76mm [L3]
W=0.12mm [W3]
TL3
L=7.76mm [L3]
W=0.12mm [W3]
TL5
L=6.46mm [L2]
W=1.39mm [W2]
TL2
L=.12mm
W=.12mm
TL8
L=6.27mm [L4]
W=3.21mm [W4]
TL4
L=6.46mm [L2]
W=1.39mm [W2]
TL6
L=.12mm
W=.12mm
TL9
L=.12mm
W=.12mm
TL10
 
Figure 15.1 Design steps for the wide-bandwidth 2.4-GHz bandstop filter with three TLE open 
stubs and two contributing UEs. 

Distributed Bandstop Filters 
201 
 
Figure 15.2 Responses of the electrical (left) and microstrip (right) forms of the wide-
bandwidth bandstop filter. 
Next, the filter is converted to microstrip using Convert Using 
Advanced TLine with the resulting schematic in Fig. 15.1b. The responses 
are given on the right in Fig. 15.2. The stopband is shifted higher in 
frequency and the upper passband is significantly perturbed. This is 
primarily caused by the microstrip tee discontinuities associated with 
connecting the stubs to the UEs. The low impedance of the open-stubs 
causes a significant length increase in the throughpath (UEs) of the filter. 
Optimization of filter dimensions to correct these effects is unsuccessful. 
The electrical schematic models this connection as occurring at a point. 
The next step modifies the filter layout to approximate a point connection. 
This is accomplished by adding narrow short TLE between the UEs and the 
TLE open stubs as shown in Fig. 15.1c. These 0.12- by 0.12-mm TLEs are so 
narrow and short as to approximate a point connection. The resulting 
responses are shown on the left in Fig. 15.3. The perturbation is much less 
severe, and optimization recovers the responses relatively well as shown on 
the right in Fig. 15.3. The passband return loss is improved over the original 
but there is a slight loss of attenuation just below 6 GHz. The layout at 
approximately four times actual size is shown in Fig. 15.4. The input and 
output lines are increased to 2 mm in length to provide clearance of the 
TLE open stubs from the sidewall of the housing. 

202 
Filter Synthesis Using Genesys S/Filter 
 
Figure 15.3 Responses of the wide-bandwidth bandstop filter modified to reduce the effects of 
the microstrip tee discontinuities (left) and after optimization to improve the responses (right). 
 
Figure 15.4 Layout of the wide-bandwidth bandstop filter (4X scale). 
15.1.2 Moderate Bandwidth Bandstop 
 This moderate bandwidth bandstop has a lower passband from DC to 3.5 
GHz and an upper passband of 6.5 to 13.5 GHz. The design begins similarly 
to the wide bandwidth filter except the cutoff is specified as 3.5 GHz. The 
electrical schematic is given in Fig. 15.5a. As the bandwidth is decreased, 
the series UEs moderate downward in characteristic impedance and the 
TLE open stubs increase in impedance. This narrower bandwidth results in 
TLE open stubs near the desired maximum characteristic impedance of 120 
ohms. 
The microstrip schematic after Convert Using Advanced TLine is given 
in Fig. 15.5b and the responses are given on the left in Fig. 15.6. The higher 
TLE open stub impedance results in narrower line width and therefore 
smaller microstrip tees. The resulting responses suffer only moderate 
perturbation, so the connection jumpers used in the previous example are 

Distributed Bandstop Filters 
203 
not necessary. The results after optimization of dimensions are given on the 
right in Fig. 15.6.  
 
L=7.63mm [L2]
W=0.13mm
TL2
L=1mm
W=0.93mm
TL1
b
L=7.41mm [L3]
W=0.58mm [W3]
TL3
L=7.19mm [L4]
W=0.59mm [W4]
TL4
L=7.41mm [L3]
W=0.58mm [W3]
TL5
L=7.63mm [L2]
W=0.13mm
TL6
L=1mm
W=0.93mm
TL7
ZO=50Ω
ZO=50Ω
 
L=7.69mm [L2]
W=0.13mm
TL2
L=1mm
W=0.93mm
TL1
L=7.18mm [L3]
W=0.56mm [W3]
TL3
L=7.4mm [L4]
W=0.59mm [W4]
TL4
L=7.18mm [L3]
W=0.56mm [W3]
TL5
L=7.69mm [L2]
W=0.13mm
TL6
L=1mm
W=0.93mm
TL7
ZO=50Ω
ZO=50Ω
c
 
Figure 15.5 Design steps for the moderate bandwidth bandstop filter. 

204 
Filter Synthesis Using Genesys S/Filter 
 
Figure 15.6 Responses of moderate bandwidth microstrip bandstop filter before (left) and 
after optimization (right). 
15.1.3 Narrow Bandstop with Ikeno Transforms 
In this example, the cutoff frequency is increased to 4.5 GHz, resulting in 
an upper passband beginning at 5.5 GHz. In the Specification tab, two TZs 
at infinity and three UEs are specified with the Series Element First option. 
The 30-dB rejection bandwidth is approximately 50 MHz centered at 5 
GHz. The electrical schematic is given in Fig. 15.7a. A 50-ohm, 1 mm long 
UE is added at the input and output to interface with connectors. The 
characteristic impedance of the series UEs moderate toward the 
termination impedance as the bandwidth is narrowed. However, the TLE 
open stub characteristic impedance is 490 ohms. This difficulty is resolved 
by using the Ikeno transform described in Section 13.3.4. It replaces a 
series UE and a TLE open stub with a commensurate length parallel-
coupled TLE and a TLE open stub of moderate characteristic impedance. 
Applying the transform Coupled Lines: Ikeno Lines: Open, Open Stub 
on TL2 displays the prompt for Zc1 with a minimum value of 75.0052 and a 
maximum value of 113.449 ohms. The entered value is the even-mode 
characteristic impedance of the coupled line section. In this case, 85 ohms 
is entered. S/Filter then prompts for a value for n between 1.0001 and 
1000. The transform is exact for the displayed default value of n of 1.98, 
which is accepted in this case. The characteristic impedance of the resulting 
open stub is inversely proportional to n. The even- and odd-mode 
characteristic impedances of the coupled line section are not influenced by 
n. Finally, S/Filter prompts for the relative dielectric constant of the even 
and odd modes that are used to compute the physical line lengths. In this 
case, 1 is entered for each and the circuit is converted to microstrip in a 

Distributed Bandstop Filters 
205 
later step. The resulting electrical schematic, after applying the Ikeno 
transforms to TL1 and TL5 and adding short 50-ohm TLEs at the input and 
output, is given in Fig. 15.7b. The resulting responses are shown on the left 
in Fig. 15.8. 
The resulting microstrip schematic after Convert Using Advanced 
TLine is given in Fig. 15.7c. As expected, the microstrip discontinuities 
disturb the response. Because the open stubs are narrower than those in 
lowpass filters, the tees connecting the open stubs to the through path are 
less destructive. Nevertheless, optimization is used to correct the cutoff and 
center frequencies of this bandstop filter. Because the width of the center 
TLE and coupled lines are similar, they are set equal, and variables are used 
to force symmetry during optimization. Because the automatic DisCos for 
the corners may pick either adjacent line width, microstrip corner 
discontinuities were added and set equal to the width of the coupled lines. 
Unfortunately, this width does not equal the width of the narrow open 
stubs so the corner discontinuities are geometrically incorrect. This is best 
dealt with by electromagnetic simulation as described in Chapter 19. The 
microstrip schematic after optimization is shown in Fig. 15.7d and the 
responses are shown on the right in Fig. 15.8. The layout is shown in Fig. 
15.9. The maximum stopband attenuation is limited by losses in the 
microstrip realization of the filter. Folding the open stubs back toward the 
filter input and output would reduce the physical height of the filter. 
15.2 Generalized Narrowband Bandstop 
This section describes a generalized, 20-dB return loss passband, fifth-
degree bandstop with 30-dB minimum attenuation in the stopband 
centered on 5 GHz. The cutoff corners are 4 and 6 GHz and the minimum 
attenuation stopband extends from 4.89 to 5.11 GHz. Design begins with 
the specifications of a distributed lowpass with a cutoff of 4.5 GHz, fq of 5 
GHz, ripple of 0.0432 dB, and one TZ at infinity, two UEs, and a FTZ at 
4.827 GHz. The selected extraction is a shunt element first with the 
sequence UE 4827 UE ∞. The resulting responses are given on the left in 
Fig. 15.10 and the schematic is given in Fig. 15.11a.  

206 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 15.7 Design steps for the narrow-bandwidth bandstop filter. 

Distributed Bandstop Filters 
207 
 
Figure 15.8 Electrical schematic responses of the narrow bandstop (left) and the microstrip 
responses after optimization (right). 
 
Figure 15.9 Microstrip layout of the narrow bandstop with optimized dimensions (4X scale). 
The resulting geometry and TLE characteristic impedances are 
unrealizable. To correct these issues, the following transforms are then 
applied: 
1) A Kuroda Wire Line Transfer: Full: Series Shorted Right is applied to 
TL1. This results in Fig. 15.11b. Later transforms will correct 
unrealizable TLE characteristic impedances. 
2) A Basic Operations: Half Angle transform is applied to each of the 
original TLE. Each TLE is now one-half the original length. The half 
angle transform must be applied to each TLE to retain commensurate 
length for later transforms. These five transforms create the schematic 
shown in Fig. 15.11c. 
 

208 
Filter Synthesis Using Genesys S/Filter 
 
Figure 15.10 Responses of the synthesized generalized narrowband bandstop filter (left) and 
the microstrip form after modifications and optimization (right). 
 
3) A Coupled Lines: Ikeno Lines transform is applied to each of the four 
UEs and its paired finite-zero stub. The first transform is the 
Grounded Stub, Open form applied to TL3 with TL1 and TL2. The 
transform prompts for a value of n. The value for n displayed in the 
title bar, 2.21815, results in a symmetric parallel-coupled TLE, and this 
value is advised. 
4) The second transform is the Open, Grounded Stub form applied to TL4 
with TL5 and TL6. The resulting schematic after all four Ikeno 
transforms are applied is given in Fig. 15.11d. 
The physical layout for the schematic in Fig. 15.10d is unrealizable 
because the adjacent edges of TL4 and TL6 would contact. In addition, the 
corner discontinuities are unsymmetric. The following manual steps resolve 
these issues and aid physical realization of this filter. 
1) The orientations of the second and fourth open-stub TLE are shifted 
upward. This prevents edge contact of the second and third open 
stubs. 
2) The width of all four coupled lines is set to 0.8 mm. 
3) Four 0.2-mm-long TLEs of width 0.8 mm are added between each 
open-stub TLE and the coupled line to which it connects. These 
additional lengths of line shift the stopband downward a small 
percentage. A step Disco is added between each short TLE and the 
open-stub TLE. 
4) 1.6-mm-long TLEs are added to interface the filter input and output. 

Distributed Bandstop Filters 
209 
 
 
 
 
Figure 15.11 Design steps for the generalized narrowband bandstop. 

210 
Filter Synthesis Using Genesys S/Filter 
The resulting schematic, after optimization of the responses to correct 
the effects of the discontinuities and added lines is given in Fig. 15.12. The 
responses after optimization are given on the right in Fig. 15.10. The layout 
at 4x scale is shown in Fig. 15.13, which illustrates the need to alternate the 
open-stub TLEs. 
 
Figure 15.12 Generalized narrowband bandstop filter layout after modifications and 
optimization. 
 
Figure 15.13 Layout of the generalized narrowband bandstop (4X scale). 

 
211 
 
16 Distributed Bandpass Filters 
The bandpass filter is a mainstay of electronic systems. As with 
lumped-element filters, the distributed bandpass filter often requires a 
clever solution to avoid extreme parameter values, particularly with wide or 
narrow passbands. This chapter includes a variety of bandpass topologies 
to address these unique challenges. 
16.1 Tutorials of Bandpass by Synthesis 
As mentioned in Chapter 13, which introduced distributed filters, the 
Microwave Filter program automates the design of many distributed 
topologies. These topologies are historically very successful. Design of these 
popular topologies by synthesis requires repeated application of many 
transforms. The resulting filters are identical in form to filters 
automatically designed in Microwave Filter. Given the additional effort 
required by numerous transforms, direct synthesis of these filters is 
primarily of academic interest. Therefore, for educational reasons, this 
chapter begins with the direct synthesis of two popular distributed 
bandpass topologies. The latter portion of this chapter covers structures 
that are not designed by classic techniques and that solve important filter 
problems, such as reduced size and custom placement of FTZs. 
16.1.1 Edge-Coupled Using Richards Transform 
This example is a three-resonator edge-coupled bandpass with a passband 
from 4.5 to 5.5 GHz. Richards transform mirrors the highpass passband 
around fq, which is specified as 5 GHz. A distributed, 0.0432-dB equiripple 
highpass synthesis is specified a cutoff of 4.5 GHz. The procedure begins 
with one TZ at DC and N+1 unit elements, where N is the quantity of 
resonators. The Specification tab is given in Fig. 16.1. 

212 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.1 Specification tab for the five-section edge-coupled bandpass. 
A Series Element First extraction with the sequence UE UE DC UE UE 
results in the schematic given in Fig. 16.2a. The responses are given on the 
left in Fig. 16.3. This topology is symmetric and the transformer is a 
consequence of limited computer precision and the extreme values. Later 
transforms that moderate characteristic impedances eliminate the 
transformer. 
The following transforms are applied: 
1) Basic Operations: Split Series Element is applied to TL3. 
2) Kuroda Wire Line Transfers: Equal: Series Open Right is applied to 
TL2 and then TL1. 
3) Kuroda Wire Line Transfers: Equal: Series Open Left is applied to the 
two TLEs on the right. 
4) Remove Transformer is applied. The result is given in Fig. 16.2b. 
5) The middle three series open TLE are split using Basic Operations: 
Split Series Element: Two Equal Pieces. The result is given in Fig. 
16.2c. 
6) Coupled Lines: Interdigital Lines: Open, Open: Symmetric PCL is 
applied to each UE. The result is given in Fig. 16.2d. 
 

Distributed Bandpass Filters 
213 
 
 
 
 
 
Figure 16.2 Design steps for the three-section edge-coupled bandpass. 

214 
Filter Synthesis Using Genesys S/Filter 
The even- and odd-mode characteristic impedances are excessively 
high. To resolve this, the Source and Load termination resistance in the 
Specification tab are iterated downward until reasonable even- and odd-
mode characteristic impedances are obtained. In this case, a termination 
resistance of 12 ohms is selected. To transform the termination resistance 
back up to 50 ohms, quarter-wavelength, 5-GHz TLEs are added at the 
input and output to serve as impedance transformers. Their characteristic 
impedance is 
5.
24
50
12
=
×
 ohms. The resulting schematic is given in Fig. 
16.2e and the responses are given on the right in Fig. 16.3. The quarter-
wavelength TLEs transform the termination impedance exactly at only 5 
GHz, resulting in a degradation in the return loss near the passband edges. 
 
 
Figure 16.3 Response of the three-section edge-coupled 5-GHz bandpass (left) and with 
quarter- wavelength transformers to moderate even- and odd-mode impedance (right). 
The top of Fig. 16.4 shows the microstrip schematic after applying 
Convert Using Advanced TLine and optimization to recover the return loss. 
The bottom of Fig. 16.4 shows the layout at approximately 2x scale. The 
responses after optimization are given in Fig. 16.5. 
Each resonator is electrically a quarter-wavelength long at 5 GHz, 
resulting in the first reentrant passband at three times 5 GHz or, 15 GHz. 
However, in microstrip the even- and odd-mode propagation velocities are 
slightly different. This results in a spurious passband centered near two 
times 5 GHz. This lower reentrance does not occur in pure TEM mode 
media such as stripline. 

Distributed Bandpass Filters 
215 
 
 
Figure 16.4 Optimized edge-coupled 5-GHz bandpass microstrip schematic (top) and layout 
at bottom (2X scale). 
 
Figure 16.5 Responses of the optimized microstrip edge-coupled 5-GHz bandpass. 
 
 
 

216 
Filter Synthesis Using Genesys S/Filter 
16.1.2 Edge-Coupled Using Inverters 
The previous example uses exact synthesis techniques up to the point 
where input and output quarter-wavelength transformers are used to 
moderate the characteristic impedances. In this example of that filter, 
inverters are used that are approximate, but the resulting characteristic 
impedances are more moderate and the resulting structure is shorter 
because quarter-wavelength transformers are not required. 
Design begins as a lumped element bandpass with N transmission 
zeros at DC and N at infinity. The resulting filter is given in Fig. 16.6a. The 
following transforms are then applied: 
1) Inverters: Replace Element(s) with Inverter(s) is applied to each 
series L-C network. This replaces the series L-C with a cascade of an 
inverter, a shunt parallel L-C, an inverter, and a transformer. After 
both transforms, a Simplify Circuit removes the transformers. 
2) Each of the shunt parallel L-C networks is converted to a 50-ohm TLE 
using Lumped to Distributed Equivalents: Parallel LC in Shunt to 
Half Wavelength TLine. The resulting schematic is given in Fig. 16.6b. 
3) Each of the series TLE is split into two equal length TLEs using Basic 
Operations: Split Series Element. A Kuroda Wire Line Transfers: 
Equal: Series Open Left is applied to the two TLEs on the right. Next a 
series 50-ohm TLE of length 15.075 mm is added at the input and 
output. The left half of the resulting symmetric circuit is given in Fig. 
16.6c. 
4) Each inverter with TLEs on its left and right is replaced with a coupled 
TLE using Coupled Lines: Interdigital Lines: Open, Open. A 
conversion frequency just below the upper displayed limited is 
selected that results in the most moderatly valued coupled lines. In 
this case, fo of 4974.9 is entered. The resulting schematic is given in 
Fig. 16.6d. 
The response of this edge-coupled bandpass is shown on the left in Fig. 
16.7. Because inverter transforms are approximate, the return loss is better 
than the expected 20 dB and the bandwidth is narrower than expected. 
Convert Using Advanced TLine transforms the schematic to 
microstrip. After optimization, the microstrip schematic is given in Fig. 
16.6e and the resulting responses are given on the right in Fig. 16.7. As with 
the previous example, the differential even- and odd-mode propagation 
velocities results in a spurious passband near 2x the desired passband. 
Comparing the microstrip responses in Fig. 16.5 and 16.7 reveals that the 
input and output quarter-wavelength transforms required in the first 
example provide some additional selectivity. 

Distributed Bandpass Filters 
217 
*
L=6.78nH
L3
C=3.5114pF
C2
L=0.2915nH
L2
C=0.151pF
C3
ZO=50Ω
L=6.78nH
L1
C=0.151pF
C1
ZO=50Ω
a
 
 
 
 
e
L=7.28mm [L1]
S=0.18mm [S1]
W=0.31mm [W1]
TL1
L=7.28mm [L1]
S=0.18mm [S1]
W=0.31mm [W1]
TL4
L=7.09mm [L2]
S=0.22mm [S2]
W=0.65mm [W2]
TL2
L=7.09mm [L2]
S=0.22mm [S2]
W=0.65mm [W2]
TL3
 
Figure 16.6 Design steps for the edge-coupled bandpass designed using inverters. 
 
 

218 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.7 Responses of the electrical edge-coupled bandpass (left) and in microstrip after 
optimization (right). 
After adding short 50-ohm TLEs at the input and output, the layout at 
approximately 2x scale is given in Fig. 16.8. The coupled-line widths are 
somewhat wider in this version of the filter resulting in somewhat less 
insertion loss in the passband. 
 
 
Figure 16.8 Layout of the 5-GHz edge-coupled bandpass designed using inverters (2X scale). 
16.1.3 Interdigital Using Inverters 
The example illustrates the synthesis of a 4.5- to 5.5-GHz interdigital 
bandpass filter with five quarter-wavelength resonators. As with the edge-
coupled bandpass, design uses Richards transform and a passband 
mirrored about fq with highpass synthesis. One TZ at DC and N-1 unit 
elements are specified, where N is the desired quantity of resonators. The 
Specification tab is given in Fig. 16.9. External coupling is via an additional 
coupled line section at the input and output, which is referred to as 
transformer coupling. These sections are added as inverters and 
transforms, thus creating seven parallel quarter-wavelength lines. This 
facilitates changing the internal filter impedance level if required. 
The extraction sequence UE UE UE UE DC results in the schematic of 
Fig. 16.10a. The unrealizable TLE characteristic impedance and 

Distributed Bandpass Filters 
219 
transformer are resolved as transforms are applied to the filter. The initial 
responses are given on the left in Fig. 16.11. 
 
 
Figure 16.9 Specification tab for the five resonator interdigital bandpass mirrored about fq of a 
highpass synthesis. 
The transforms are: 
1) Kuroda Wireline Transfers: Equal: Shunt Grounded Right is applied 
in sequence to TL4 and each UE to the left. After Simplify Schematic, 
the schematic in Fig. 16.10b results. 
2) Inverters: Scale Source and Load by Inserting Inverters. After 
Simplify Schematic, the resulting left half is given in Fig. 16.10c. The 
lack of precise symmetry is reduced in the next step. 
3) The structure developed by the previous steps is not symmetric. 
Asymmetry is reduced by a repeated applications of Kuroda Wireline 
Transfers: Specify Transformer: Shunt Shorted Left (or Right). The 
goal is all equal shunt-shorted TLEs. This is achieved by applying the 
above transform to the series TLE that has the largest variation in the 
shunt-shorted TLEs. In this case, six transform applications result in 
shunt-shorted TLE characteristic impedance within 1% of each other. 
More precision is unnecessary because a later optimization is required 
for other reasons. The transformer turns ratio is near unity. 
4) Next, the transform Coupled Lines: Interdigital Lines: Both Lines 
Grounded is applied to each series TLE individually and in turn. The 
resulting interdigital lines even- and odd-mode impedance are 
recorded, the transform is deleted and the transform is applied to the 
next series TLE in turn, and results are again recorded. During this 
transform, the option Symmetric PCL (parallel-coupled line) option is 
selected. 

220 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
 
Figure 16.10 Initial extraction and transform sequence of the interdigital bandpass. 

Distributed Bandpass Filters 
221 
 
Figure 16.11 Responses of the synthesized interdigital filter (left) and after optimization of the 
multiple-coupled-line model (right). 
The resulting interdigital filter with even- and odd-mode impedance, 
and Z0 and kw for each PCL is given in Fig. 16.12a. The characteristic 
impedance and wireline coupling coefficients are found using Eqs. 13.6 and 
13.8. 
This structure is then replaced with the Agilent Genesys multiple-
coupled-line model based on parallel-connected wireline models. This 
model requires equal characteristic impedance of each section. The 
significantly different coupling of the external transformer sections 
compromises this assumption. Therefore, an intermediate characteristic 
impedance is used, and it and the coupling coefficients are optimized to 
obtain the best responses. This optimization also forces symmetry and the 
removal of the transformer. The final optimized characteristic impedance 
and coupling coefficients are given in Fig. 16.12b, and the resulting 
responses are given in Fig. 16.11b. 
Given in Fig. 16.13a is the microstrip interdigital bandpass with open-
end and via hole discontinuities after Convert Using Advanced TLine is 
applied on TMM6 25-mil substrate. The responses are given on the left in 
Fig. 16.14. 
 
 
 
 
 
 
 
 

222 
Filter Synthesis Using Genesys S/Filter 
 
 
Figure 16.12 Multiple-coupled-line model of the interdigital filter. 
The discontinuities result in poor return loss and wider than desired 
bandwidth. This is corrected by the optimization of the line widths, 
spacings, and the length. The results are given on the right in Fig. 16.14. 
The optimized dimensions are given in Fig. 16.13b. The responses are 
improved with dimensions near the initial values, but the best responses 
require extensive optimization with significantly wider lines. This results in 
closer line spacing, and the increased open-end capacitance reduces the 
required line lengths. 
 

Distributed Bandpass Filters 
223 
a
ZO=50Ω
ZO=50Ω
7
6
5
4
3
2
1
L=6.9288mm
S3=0.8827mm
S2=0.7131mm
S1=0.1544mm
W=0.4626mm
 
b
ZO=50Ω
ZO=50Ω
7
6
5
4
3
2
1
L=6.3393mm [L]
S3=0.6113mm [S3]
S2=0.4111mm [S2]
S1=0.1mm [S1]
W=1.8676mm [W]
 
Figure 16.13 Microstrip form of the interdigital filter created using (a) Advanced TLine and (b) 
after optimization. 
 
Figure 16.14 Microstrip form of the interdigital bandpass with initial dimension (left) and after 
optimization (right). 

224 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.15 Layout of the 5-GHz transformer-coupled interdigital bandpass (2X scale). 
16.2 Unique Bandpass Designs 
The remainder of this chapter deals with distributed bandpass structures 
not available using classic techniques. 
16.2.1 Combline with Capacitive External Coupling 
As the bandwidth is decreased, the characteristic impedance of the 
resonators in a combline becomes lower. In this example, a capacitive 
transformer is used to couple the filter to the loads. This allows the 
specification of the resonator characteristic impedance. Design of this three 
resonator 950- to 1050-MHz bandpass begins with a specification of one TZ 
at DC and 
1
2
−
N
 TZs at infinity. The Specification tab is given in Fig. 16.16. 
The resulting schematic for the extraction sequence  ∞ ∞ ∞ DC ∞ ∞ is 
given in Fig. 16.18a and the resulting responses are given on the left in Fig. 
16.17. 
 
 
Figure 16.16 Specification tab for the three-section, capacitive-coupled combline bandpass. 

Distributed Bandpass Filters 
225 
 
Figure 16.17 Responses of the synthesized combline (left) and after transforms with 
capacitors (right). 
The following transforms are then applied. 
1) Compound Operations: Equate All Shunt Ls or Shorted Stubs creates 
two additional shunt-shorted TLE. The resulting schematic is given in 
Fig. 16.18b. 
2) Transformer Operations: Absorb in Rload removes the transformer, 
which has a near-unity turns ratio. Distributed to Lumped 
Equivalents: Open Stub to Shunt C replaces the open stubs with 
loading capacitance. Finally, Inverters: Scale Source and Load by 
Inserting Inverters prepares for the addition of external-capacitive 
coupling. The result is given in Fig. 16.18c. 
3) Inverters: Replace Inverter with: End Inverters to: Capacitive L adds 
the coupling capacitors. Simplify Schematic, then Basic Operations: 
Swap Element and Coupled Lines: Comblines: Both Lines Grounded 
replaces the series-shorted wireline and adjacent shorted stubs with a 
combline section as shown in Fig. 16.18d. 
It is unnecessary to transform the second series-shorted wireline since 
the result is identical to the first transform. The combline filter derived 
from this schematic is manually added to Genesys. The schematic is given 
at the top of Fig. 16.19 and the responses are given on the right in Fig. 16.17. 
 

226 
Filter Synthesis Using Genesys S/Filter 
 
 
 
C=1.5061pF
C1
C=1.9159pF
C2
LENGTH=37.500mm
ZOO=42.3471Ω
ZOE=60Ω
TL1
C=3.6679pF
C3
L=37.5mm
Z=287.8653Ω
TL2
C=1.9166pF
C4
C=1.507pF
C5
L=37.5mm
Z=60Ω
TL3
d
 
Figure 16.18 Initial extraction and transform sequences for the external-capacitance-coupled 
combline bandpass. 

Distributed Bandpass Filters 
227 
3
2
1
LEN=37.5mm
K2=3.474e-3 [k1]
K1=3.474e-3 [k1]
ZO=50.4Ω [Zo]
C=1.51pF [C1]
C1
C=1.92pF [C2]
C2
C=3.67pF [C3]
C3
C=1.51pF [C1]
C5
C=1.92pF [C2]
C4
 
C=1.2742pF [C1]
C1
C=2.1314pF [C2]
C2
C=3.2309pF [C3]
C3
C=1.2742pF [C1]
C5
3
2
1
L=17.42mm [L]
S1=0.9092mm [S]
W=0.882mm [W]
C=2.1314pF [C2]
C4
 
Figure 16.19 Combline form of the bandpass as transformed (top) and after conversion to 
microstrip and optimization (bottom). 
The schematic after conversion to microstrip on 25-mil-thick Rogers 
TMM6 with half-ounce copper is given on the bottom in Fig. 16.19. The 
values are after optimization of the responses. The responses are given in 
Fig. 16.20. This filter is investigated further using EM simulation in 
Chapter 19. 

228 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.20 Responses of the optimized combline bandpass in microstrip. 
16.2.2 Miniature Bandpass with Contributing UEs 
This example uses an equal number of TZs at DC and infinity, and 
contributing UEs, with user-selectable commensurate line lengths. This 
2250- to 2750-MHz bandpass uses three TZs at DC and infinity, and four 
unit elements. Miniature refers to the fact that the selected line lengths are 
less than one-eighth wavelength, in this case 37.50 at band center. The 
Specification tab is given in Fig. 16.21. The extraction sequence UE UE DC 
∞ DC ∞ DC ∞ UE UE results in the schematic given in Fig. 16.22a. This 
filter is symmetric and the transformer does not have a unity turns ratio 
because of computer precision during synthesis. The transformer is 
absorbed into the load resistance in a later step. 
The designators referred to in the following description of transforms 
are the designators before the application of the transform. The transform 
may change designators, and the next transform description uses the new 
designators. Because of symmetry, each transform is applied first at the left 
and then the right side of the filter. The transforms are: 
1) Basic Operations: Swap Element to TL3 and TL4 
2) Kuroda Wireline Transfer: Full: Shunt Open Right to TL2 
3) Kuroda Wireline Transfer: Full: Shunt Open Right to TL1. This shifts 
the shunt-open stub to the far left. The same transforms are applied on 
the right side of the filter. 
 

Distributed Bandpass Filters 
229 
 
Figure 16.21 Specification tab for the 2250- to 2750-MHz miniature bandpass. 
4) Kuroda Wireline Transfer: Full: Shunt Grounded Right to TL3. This 
transform is mirrored on the right side. 
5) Transformer Operations: Combine All Transformers. 
6) Basic Operations: Split Series Element is applied with two-equal 
pieces to the open wireline TL6. 
7) Basic Operations: Swap Element is applied to TL6 and TL7. The result 
of these transforms is given in Fig. 16.22b. 
8) Kuroda Wireline Transfer: Full: Series Shorted Right to TL4 and the 
mirror element TL8. 
9) Basic Operations: Split Series Element is applied with two-equal 
pieces to TL6. 
10) Kuroda Wireline Transfers: Pi: Pi Shunt Right is applied to TL2 and 
the mirror to TL12. 
11) Transformer Operations: Combine All Transformers. The results are 
given in Fig. 16.22c. 
12) Coupled Lines: Comblines: Both Lines Grounded is applied to TL3 
and the mirror to TL10 with the Symmetric PCL (parallel-coupled line) 
option. 
13) Kuroda Wireline Transfer: Full: Series Open Right is applied to TL4 
and the mirror to TL7. 
14) Transformer Operations: Combine All Transformers. 

230 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
 
Figure 16.22 Transformation steps for the 2250- to 2750-MHz symmetric miniature bandpass. 

Distributed Bandpass Filters 
231 
15) Kuroda Wireline Transfer: Equal: Series Open Right is applied to 
TL3 and the mirror to TL9. 
16) Transformer Operations: Combine All Transformers. The results are 
given in Fig. 16.22d. 
17) Coupled Lines: Interdigital Lines: Open, Open is applied to TL4 and 
the mirror to TL7 with the Symmetric PCL (parallel-coupled line) 
option. 
18) Transformer Operations: Absorb in Rload removes the transformer 
while changing the load resistance an insignificant amount.  
19) Inverters: Scale Source and Load by Inserting Inverters. Enter an 
inverter parameter of 40. 
20) Inverters: Replace Inverter with: Quarter Wavelength TLine is 
applied to each inverter with a quarter-wavelength frequency of 2500 
MHz. The result is given in Fig. 16.22e. 
The quarter-wavelength lines act as impedance transformers to 
moderate the characteristic impedance of the TLE elements. The optimum 
transform ratio is a function of the filter bandwidth and is determined 
iteratively near the completion of the filter. These transformers are exact 
only at band center. The schematic after minor optimization is given at the 
top of Fig. 16.23 and the responses are given on the left in Fig. 16.24. 
 
 
Figure 16.23 Electrical schematic of the optimized miniature bandpass (top) and microstrip 
schematic after optimization (bottom). 

232 
Filter Synthesis Using Genesys S/Filter 
The schematic is converted to microstrip on 25-mil-thick TMM6 with 
Convert Using Advanced TLine, and it is again optimized to correct for the 
effects of the discontinuities. The dimensions after optimization are given 
in the bottom schematic in Fig. 16.23 and the responses are given on the 
right in Fig. 16.24. 
 
 
Figure 16.24 Miniature 2250- to 2750-MHz bandpass responses of the optimized electrical 
schematic (left) and the optimized microstrip filter (right). 
TL1 and TL10 are quarter-wavelength lines and TL5 and TL6 cascaded 
are 750 in length. These longer length lines are folded to reduce the overall 
length of the filter. A layout at 2x scale with folded lines is given in Fig. 
16.25. 
 
Figure 16.25 Microstrip layout of the miniature 2250- to 2750-MHz bandpass with folded lines 
to conserve space (2X scale). 
The responses of this folded filter, after minor optimization to correct 
for bends inserted during the folding is given in Fig. 16.26. The frequency 
sweep to 10 GHz illustrates the excellent stopband performance of this 
structure. The short elements not only reduce the size of the filter but they 
also significantly improve the stopband performance. The use of both 

Distributed Bandpass Filters 
233 
interdigital and combline parallel-coupled lines also contribute to the 
excellent stopbands. However, responses in Fig. 16.25 are computed by 
circuit-theory simulation and do not include the effects of radiation, 
surface, or box modes. This level of stopband performance is difficult to 
achieve in practice. This is addressed in Chapter 19. 
 
 
Figure 16.26 Responses of the folded miniature bandpass through 10 GHz. 
16.2.3 Narrow Bandwidth with UEs and an FTZ 
This type of filter begins with a commensurate-highpass synthesis utilizing 
one TZ at DC, FTZs, and a quantity of UEs greater than the quantity of 
FTZs. Synthesis using Richards transform results in a bandpass response 
mirrored about fq. Physical symmetry is achieved if the quantity of either 
FTZs or UEs is even and the other is odd. Subsequent half-angle transforms 
reduce the length of internal lines to one-eighth wavelength. The input and 
output impedance transforming lines remain one-quarter wavelength. The 
reentrant passband occurs at 3x fq.  
This 2400- to 2600-MHz passband example utilizes one TZ at DC, one 
FTZ and two UEs for a fifth-degree bandpass with fq of 2500 MHz. The FTZ 
is manually adjusted to achieve a minimum stopband attenuation of 
approximately 40 dB. Line characteristic impedance is often unreasonable 
so inverters are included for later adjustment. The Specification tab is given 
in Fig. 16.27. 
Fig. 16.28a shows the synthesized bandpass with a series element first 
and the extraction sequence UE 2320 DC UE. The turns ratio is near unity, 
so the transformer is eliminated by absorbing it into the load. 
 

234 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.27 Specification tab for the narrow bandpass with one FTZ. 
The transformations are: 
1) Transformer Operations: Absorb in Rload. 
2) Inverters: Scale Source and Load by Inserting Inverters. 
3) Inverters: Replace Inverter With: Quarter Wavelength TLine is 
applied to the input and output inverters. An inverter parameter of 50 
ohms does not change the response. This is adjusted later to achieve 
realizable characteristic impedance. 
4) Kuroda Wireline Transfer: Equal: Series Open Right is applied to TL2 
and then TL1. These transforms are also applied on the right side. 
Apply Simplify Schematic. The result is given in Fig. 16.28b. 
5) Basic Operations: Split Series Element with the Two-Equal Pieces 
option is applied to TL3 and then TL11. 
6) Coupled Lines: Interdigital Lines: Open, Open with the Symmetric 
PCL option is applied to TL2 and each similar set of TLEs. The result 
after Simplify Schematic is given in Fig. 16.28c. 
7) Basic Operations: Half Angle is applied to TL2 and then TL9. 
8) Coupled Lines: Comblines: Open, Open with the Symmetric PCL 
option is applied to TL4 and then TL9. 
9)  Basic Operations: Half Angle is applied to TL5 and TL6. 
10) Tlines: Stepped Resonators: Finite Zero to Two Step Stub is applied 
to TL5 and TL6, and then TL7 and TL8.  

Distributed Bandpass Filters 
235 
11) The inverters added in step are re-edited for the most reasonable set 
of characteristic impedance for the filter. In this case K=85 is chosen. 
The result is given in Fig. 16.28d. 
In the final layout, one two-step stub is oriented up and the other is 
oriented down. The responses after transformations are given on the right 
in Fig. 16.29. The quarter-wave impedance transformers are approximate, 
but the performance degradation is small because of the narrow bandwidth 
of this filter. 
The filter is converted to microstrip on Roger TMM6 50-mil substrate 
using Convert Using Advanced TLine. The schematic after optimization is 
shown in Fig. 16.30. The narrow 8% bandwidth and FTZs near the 
passband result in high-sensitivity to line parameters. The shunt stubs are 
low impedance and are wide. To avoid the disturbance of a tee 
discontinuity with a wide through line, very short and narrow lines are 
added between these stubs and the through lines. Optimization requires 
close user monitoring to avoid divergence. To avoid divergence, portions of 
the circuit are converted using Convert Using Advanced TLine and are then 
optimized before additional portions are converted. The resulting layout 
approximately to scale is given in Fig. 16.31. The gap created by adding the 
0.2- by 0.2-mm lines result is barely visible in the layout. The final 
optimized responses are given in Fig. 16.32. 

236 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 16.28 Transform sequence for the narrow bandpass with one FTZ. 

Distributed Bandpass Filters 
237 
 
Figure 16.29 Initial responses (left) and after transforms (right) of the narrow bandpass with 
one FTZ. 
 
Figure 16.30 Microstrip schematic of the 2400- to 2600-MHz bandpass with one-finite FTZ. 

238 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.31 Layout of the narrow bandpass (to scale). 
 
Figure 16.32 Responses of the microstrip narrow bandpass with FTZ after optimization. 
16.2.4 Penetrating Combline 
This bandpass is a progression from combline, to miniaturized stepped-
impedance resonators, and then a penetrating geometry. It offers the 
compactness of the combline but does not require lumped-loading 
capacitors. This progression is illustrated in Fig. 16.33. 
Fig. 16.33a depicts a conventional combline bandpass filter with 
capacitive loading. Resonance is achieved with an electrical line length, θ , 
less than 900 by using lumped-capacitance loading. Line lengths of 300 to 
600 are typical. This forms a very compact structure. The capacitors replace 
much of the electrostatic capacitance of the TLE open ends and the 
corresponding capacitive coupling. Coupling is primarily magnetic. 
 

Distributed Bandpass Filters 
239 
 
Figure 16.33 Progression of the (a) combline bandpass to (b) stepped-impedance combline 
(c) to penetrating combline. 
A conventional quarter wavelength transmission line consists of 
continuously distributed inductance and capacitance. The inductance is 
predominant at the grounded end where the current is high, and the 
capacitance is predominant at the open end where the electrostatic-field is 
high. If the grounded end is constructed with a narrower line and the open 
end is constructed with a wider line, both the inductance and capacitance 
are increased, and the resonant frequency is lowered. Such a stepped 
impedance resonator is physically shorter than a uniform line and the need 
for loading capacitance is eliminated [1],[2]. 
If the characteristic impedance of the high-impedance section is Z1 and 
the low-impedance section is Z2, then 
1
2
Z
Z
K =
                                                                 (16.1) 
and resonance is achieved when 
0
tan
tan
2
1
=
−K
θ
θ
                                                    (16.2) 
where 
1
θ  and 
2
θ  are the electrical lengths of the high and low-impedance 
sections respectively. The total length, as a fraction of the uniform-
impedance length, is given by 

240 
Filter Synthesis Using Genesys S/Filter 
(
)
K
l fraction
1
tan
4
−
= π
                                                  (16.3) 
For example, with a characteristic-impedance ratio of 0.167, the length 
of a stepped-impedance resonator is 49.4% of the length of a uniform-
impedance resonator. 
Depicted in Fig. 16.33b is a coupled filter with stepped-impedance 
resonators. The end-capacitance of the wide transmission-line open ends 
further reduces the required physical length. The narrow high-impedance 
sections and the close-proximity low-impedance sections reduce the 
magnetic and increase the capacitive coupling. While the loading capacitors 
are eliminated, the wider sections increase the width of the filter. 
As depicted in Fig. 16.33c, the height of the filter is reduced by 
penetrating the high-impedance lines into the low-impedance sections. 
Each resonator is formed by loading each high-impedance section with two 
low-impedance lines in parallel, thus effectively creating a very-low 
impedance section. The pair of short lines that connect each high-
impedance section to the two low-impedance sections is dealt with 
manually as a final optimization. 
This filter structure is designed in S/Filter using a commensurate-
length bandpass synthesis. The Specification tab for a 950- to 1050-MHz 
bandpass is shown in Fig. 16.34. 
 
 
Figure 16.34 Specification tab for the 950- to 1050-MHz penetrating combline bandpass. 
Each line is only half the length of the shortened resonators, so fq is 
several times the passband center frequency. In this case, fq is specified at 
3750 MHz. This results in excellent stopband performance for the filter. 

Distributed Bandpass Filters 
241 
One TZ at infinity and 
1
2
−
N
 TZs at DC are specified for this topology. The 
initial synthesized filter with a shunt element first and the extraction 
sequence DC DC DC ∞ DC DC DC is given in Fig. 16.35a and the responses 
are given on the left in Fig. 16.36. 
The follow transforms are applied: 
1) Compound Operations: Equate All Shunt Cs or Open Stubs. This adds 
a shunt-open stub in parallel with each shunt-shorted stub, and 
equates all the open stubs. 
2) Basic Operations: Split Shunt Element with the option Two Equal 
Pieces is applied to TL5. 
3) Basic Operations: Swap Element is applied to TL4. This prepares TL2, 
TL3 and the new TL4 for conversion to a combline PCL. The result is 
given in Fig. 16.35b. 
4) The same operations are applied to the other internal shorted and 
open-stub pair, in this case TL8 and TL9. 
5) Coupled Lines: Comb Lines, Open, Open with the Symmetric PCL 
option is applied to each series-open line. 
6) Transformer Operations: Absorb in Rload is applied to the near-unity 
ratio transformer. The result is given in Fig. 16.35c. 
7) The characteristic-impedance values are unrealizable. Inverters: Scale 
Source and Load by Inserting Inverters with a parameter of 130 ohms 
is applied. 
8) Inverters: Replace Inverter with Quarter Wavelength TLine at 1000 
MHz is applied to each inverter.  
The resulting schematic is given in Fig. 16.35d, and the responses are 
given on the right in Fig. 16.36. 
 
 
 
 
 
 
 
 
 
 

242 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 16.35 Transform sequence for the 950- to 1050-MHz penetrating combline filter. 

Distributed Bandpass Filters 
243 
 
Figure 16.36 Initial synthesized responses of the penetrating combline filter (left) and after the 
addition of the quarter-wavelength transformers (right). 
The electrical schematic is converted to microstrip on Roger TMM6 50-
mil substrate using Convert Using Advanced TLine. The structure is 
unsuitable for realization of the compact form depicted in Fig. 16.33c 
because the shunt-shorted stubs and the combline PCL occupy the same 
PCB area. This is resolved by adding short-narrow lines between each stub 
and PCL. In addition, so that the corners are symmetric, short-narrow lines 
are placed in series with the PCL. The left half of the symmetric microstrip 
schematic after addition of these lines, and after optimization of the 
responses, is given in Fig. 16.37. Symmetry is forced, and all line lengths 
and narrow line widths are forced equal, by using variables to define 
parameters. After a few trial optimization runs, the width of the narrow 
lines is fixed at 0.3 mm and the line lengths at 11 mm. 
The responses after optimization are given in Fig. 16.38 and the layout 
is given in Fig. 16.39. The long and narrow quarter-wavelength 
transmission-line  transformers are 38.9-mm long and extend beyond the 
figure. A final design could meander these lines. This is an extremely 
compact structure for a bandpass filter with a 1-GHz center frequency 
without lumped-loading capacitors. An alternative solution to meandering 
the impedance transformers could be using lumped capacitors for 
impedance transforming. This is covered in Section 16.3.1. 

244 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.37 Left half of the symmetric penetrating combline 950- to 1050-MHz bandpass. 
 
Figure 16.38 Responses of the optimized microstrip 950- to 1050-MHz penetrating-combline 
bandpass. 

Distributed Bandpass Filters 
245 
 
Figure 16.39 Layout of the penetrating-combline bandpass (2X scale). The quarter 
wavelength transformer lines extend well beyond the figure (see text). 
16.2.5 Minnis Class-D Bandpass 
A moderately compact filter topology suitable for narrow bandwidth is the 
Minnis type-D bandpass [3]. This example is a 975- to 1025-MHz bandpass 
with four resonators. The resonators are coupled via combline-type PCL. 
When the number of resonators is even, the center-coupling element is an 
interdigital-type PCL. 
Design begins with one TZ at DC, N TZs at infinity, and N-1 UEs, where 
N is the quantity of resonators. The initial synthesized filter with an 
extraction sequence ∞ UE DC ∞ UE ∞ UE ∞ and the Series Element First 
option is given in Fig. 16.41a. The responses are given on the left in Fig. 
16.40. 
 
 
Figure 16.40 Minnis type-D narrow bandpass filter ideal response (left) and in microstrip after 
optimization (right). 

246 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
 
Figure 16.41 Transform steps for the narrowband Minnis Class-D bandpass. 
 
 
 

Distributed Bandpass Filters 
247 
The following transforms are then applied: 
1) Kuroda Wireline Transfers: Equal: Series Open Left is applied to TL5 
followed by Transformer Operations: Shift Rightmost to the new 
transformer. 
2) Basic Operations: Swap Element is applied to TL3. 
3) Kuroda Wireline Transfers: Full: Series Open Right applied to TL2 
and Transformer Operations: Shift Rightmost again to the new 
transformer. All transformers are then combined with Transformer 
Operations: Combine All Transformers. 
4) Basic Operations: Insert Element is used to insert a 50-ohm quarter-
wavelength line at the input. This line has no effect because the source 
resistance is 50 ohms. The resulting schematic is given in Fig. 16.41b. 
5) Kuroda Wireline Transfers: Minnis: Kuroda-Minnis CD Right is 
applied to the new TL1 with a parameter of 0.45. By iterative trial and 
error, this value is found to offer a good compromise of the line 
impedances throughout the filter. The resulting transformer is shifted 
to the far right. 
6) Kuroda Wireline Transfers: Full: Series Open Left is applied to TL6 
and the resulting transformer is shifted right. 
7) Kuroda Wireline Transfers: Minnis: Kuroda-Minnis CD Right is 
applied to the new TL5 with a parameter of 0.45. The resulting 
transformer is shifted to the far right and Transformer Operations: 
Combine All Transformers is applied. The resulting schematic is given 
in Fig. 16.41c. 
8) The resulting topology is symmetric about TL10. The mirror of the 
above transforms are applied from the load end of the filter. If a 
transformer remains, its turns ratio is near unity and it is deleted. 
9) Coupled Lines: Combline: Open, Open is applied to TL1, TL2, and TL3 
with the Symmetric PCL option. The same transform is applied to the 
remaining three similar line sets. 
10) Coupled Lines: Interdigital: Open, Open is applied to TL5, TL6, and 
TL7 with the Symmetric PCL option. The final schematic is given in 
Fig. 16.41d. 
The narrow bandwidth of this filter increases the sensitivity of the 
responses to discontinuities and to the differential velocity of the even and 
odd modes of propagation in the coupled lines. The ideal schematic in Fig. 
16.41d is converted to microstrip on Rogers TMM6 50-mil substrate using 
Convert Using Advanced TLine. Conversion results in a significant 
perturbation of the responses, and the large quantity of variables results in 
unsuccessful recovery by optimization. Therefore, the circuit is converted 
by one symmetric pair of elements at a time, followed by optimization 
before the next pair is converted. Symmetry is forced by the use of 
variables. The resulting left portion of the symmetric schematic is given in 

248 
Filter Synthesis Using Genesys S/Filter 
Fig. 14.61e. The optimization is unconstrained except the spacing of the 
first and last PCLs is set at a minimum of 0.1 mm. The resulting layout is 
given in Fig. 16.42. The microstrip responses are given on the right in Fig. 
16.40. The first reentrant passband is wide and begins at approximately 2 
GHz. The stopbands can be extended by specification of higher fq. This also 
reduces filter size but line impedances become difficult to realize. 
 
 
Figure 16.42 Microstrip layout of the narrowband 1-GHz Minnis type-D bandpass (to scale).  
16.3 Hybrid Bandpass 
Lumped shunt inductors, series inductors, and shunt capacitors have 
equivalent distributed transmission line equivalents. Conspicuously absent 
is a distributed form of a series capacitor. Strip-type structures require an 
extremely narrow gap to develop significant capacitance. Interdigital 
fingers and broadside-coupled structures have capacitance to ground in 
addition to their series capacitance. In many instances, combining lumped 
capacitors with TLEs is a better solution than fighting the problem. Modern 
chip capacitors offer high unloaded Q and good tolerance, generally much 
better than is obtainable from chip or wire wound inductors. The 
remainder of this chapter offers hybrid solutions containing both TLEs and 
lumped capacitors. 
16.3.1 Penetrating Combline with Capacitors 
This example substitutes lumped-capacitor termination coupling for 
quarter-wavelength transmission-line impedance transformers used in 
Section 16.2.4. Because the internal structure of this filter uses 240 line 
lengths, the quarter-wavelength lines add significant size to an otherwise 
very compact filter. The Q and tolerance for coupling elements are not as 
critical as resonating elements, so lumped capacitors function well for this 
application. Design proceeds as in Section 16.2.4 through transform step 6.  
 
 
 
 

Distributed Bandpass Filters 
249 
The following transforms are then applied: 
1) Basic Operations: Swap Element is applied to TL1 so that the open 
stub is the first element. The same transform is applied at the output. 
2) Distributed to Lumped Equivalents: Open Stub to Shunt C is applied 
to the open stubs adjacent to the input and output. 
3) Termination Coupling: Source: Shunt C to Series C is applied at the 
input with parameters Choose Theta equal to 240 and fo equal to 1000 
MHz. The mirror transform is applied at the load. 
4) Lumped to Distributed Equivalents: Shunt C to Open Stub is applied 
to both shunt capacitors. The transformers are removed by Simplify 
Circuit. The resulting schematic is shown in Fig. 16.40. 
The microstrip layout is completed using the techniques described in 
Section 16.2.4. 
 
Figure 16.43 950- to 1050-MHz penetrating combline bandpass coupling capacitors. 
16.3.2 Generalized Combline Hybrid 
This bandpass utilizes the typical capacitive-loaded resonators of combline 
filters, as well as interresonator capacitors to create FTZs and capacitor-
termination transformers. This example is a narrow 975 to 1025 MHz four-
resonator bandpass with 0.0432-dB ripple and fq = 2000 MHz. The initial 
synthesis specifies one TZ at DC, one TZ at infinity, and a total of N-1 FTZs, 
where N is the quantity of resonators. In this case, a FTZ is tuned to 881 
MHz and two FTZs are tuned to 1071 MHz to produce 50-dB Amin. An 
extraction sequence 1071 881 1071 ∞ DC, with the application of the 
transform Compound Operations: Equate All Shunt Ls or Shorted Stubs, 
results in the symmetric schematic shown in Fig. 16.44a. The responses are 
given on the left in Fig. 16.45. If a transformer results during synthesis, it is 
essentially unity ratio and is deleted. The initial termination resistance is 
adjusted to 600 ohms to realize a moderate value of impedance for the 
shunt-grounded stub.  

250 
Filter Synthesis Using Genesys S/Filter 
The following transforms in S/Filter continue the design process: 
1) Distributed to Lumped Equivalents: Open Stub to Shunt C with a 
conversion frequency of 1000 MHz is applied to each shunt-open stub. 
2) Distributed to Lumped Equivalents: Wireline/Stub to Single L or C 
with the option SC Stub and conversion frequencies of 975 and 1025 
MHz is applied to each of the three series open/shorted wireline pairs. 
This replaces the open wireline with a capacitor while leaving the 
shorted wireline. 
3) TL1 and C1 are swapped using Basic Operations: Swap Element to 
place C1 adjacent to the input. Termination Coupling: Source: Shunt C 
to Series C is applied to C1 with n=0.288675 (
600
/
50
=
). The mirror 
transform is applied to the load with n=3.464103. 
4) Transformer Operations: Absorb into Rsource is applied to the input 
transformer and the mirror transform is applied to the output 
transformer. This sets the termination resistances to 50 ohms. 
This completes the transforms applied in S/Filter. 
With a 1000-MHz passband band center and fq=2000 MHz, the 
commensurate electrical lengths are 450. Replacement of TLEs over 300 in 
length with series and shunt lumped capacitors results in significant 
distortion of the responses. At this point, a partial correction is 
implemented by retuning the FTZs to recover Amin to -50 dB. After tuning, 
the new FTZ frequencies are 891 MHz and two at 1099 MHz. The responses 
are given on the right in Fig. 16.45. This correction is only approximate and 
the return loss is not equal ripple. Later conversion steps to combline 
distort the response again, and optimization is used then to improve the 
responses. 
The next design step is conversion to combline. The form of TL1, TL2, 
and TL3 is used to convert the filter to combline even- and odd-mode 
impedances using Eqs. 13.54 and 13.55. This step is completed manually 
because the presence of C3 voids S/Filter’s recognition of three-combline 
forming elements. A four-line coupled-line element is placed in a new 
schematic, and the characteristic impedance and coupling coefficients are 
found using Eqs. 13.6 and 13.8 applied to each three-element shunt-stub 
and series wireline set in Fig 16.44b. The lumped capacitors are copied and 
placed in the new schematic. The resulting schematic is given in Fig. 
16.46a. After optimization, the resulting schematic is given in Fig. 16.46b. 
The quantity of parameters involved in the combline description result in a 
nonunique solution. Therefore, the characteristic impedance is fixed while 
other parameters are optimized. The resulting responses are given on the 
left in Fig. 16.47. 

Distributed Bandpass Filters 
251 
 
 
 
 
Figure 16.44 Transform steps for the generalized combline hybrid filter. 

252 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.45 Response of the ideal generalized combline hybrid (left) and after transforms 
and retuning of the FTZ (right). 
Finally, the electrical-model schematic is converted to microstrip on 
Rogers TMM6 50-mil substrate with Convert Using Advanced TLine. The 
length is fixed at 18 mm, and after optimization, the dimensions are 
rounded to two-significant digits and the series-lumped capacitors are 
placed on standard values. Because of the narrow bandwidth of this filter, it 
is necessary to tune the resonating capacitors in production. The resulting 
schematic is given in Fig. 16.46c and the responses are given on the right in 
Fig. 16.47. 
16.3.3 Direct-Coupled Bandpass with Capacitors 
Wideband bandpass filters often require impractically close-spaced coupled 
lines. One solution that avoids coupled lines is the bandpass with quarter 
wavelength shorted stubs and quarter-wavelength connecting lines [4]. A 
similar but more compact commensurate structure with wider stopbands is 
described in this section. In this octave-bandwidth example, open-stubs are 
replaced with lumped capacitors, which further extends the stopbands. 
Design of this 1000- to 2000-MHz four-resonator, eight-degree 
bandpass begins with the Specification tab given in Fig. 16.48. There is 1 TZ 
at DC, N TZs at infinity, and N-1 UEs, where N is the number of resonators. 
With fq = 3500 MHz, the commensurate line lengths are 38.570. Shorter 
lines improve the stopband bandwidth, but element values become 
unreasonable. The responses are given on the left in Fig. 16.49. 

Distributed Bandpass Filters 
253 
 
 
Figure 16.46 (a) Original combline form of the generalized bandpass, (b) after optimization of 
parameters, and (c) after conversion to microstrip and another optimization. 
 
 

254 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.47 Responses of the optimized electrical-model combline (left) and after conversion 
to microstrip and optimization (right). 
 
 
Figure 16.48 Specification tab for the 1000- to 2000-MHz hybrid direct-coupled bandpass. 

Distributed Bandpass Filters 
255 
 
Figure 16.49 Ideal responses of the 1000- to 2000-MHz hybrid direct-coupled bandpass (left) 
and after the transforms with quarter-wave transformers and lumped capacitors (right). 
The initial schematic with a shunt element first and the extraction 
sequence  ∞ UE DC ∞ UE ∞ UE ∞ is given in Fig. 16.50a. The following 
transform steps are then applied: 
1) TL3 is split using Basic Operations: Split Shunt Element and the right 
element is swapped with the open stub using Basic Operations: Swap 
Element. 
2) Kuroda Wireline Transfers: Specify Transformer: Shunt Sorted Left 
is applied to TL6 with the parameter option n=1.846 which is the 
inverse of the existing transformer turns ratio. After Simply Circuit is 
applied, the transformer is eliminated and the structure is symmetric 
as illustrated in Fig. 16.50b. 
3) Compound Operations: Equate All Shunt Ls or Shorted Stubs 
produces the schematic in Fig. 16.50c. 
4) Inverters: Scale Source and Load by Inserting Inverters with an 
impedance parameter of 40 is applied to improve element values. 
5) Each inverter is replaced with a quarter-wavelength line using 
Inverters: Replace Inverter With: Quarter Wavelength TLine. The 
center frequency of 1500 MHz is specified. 
6) Each shunt-open stub is replaced with a lumped capacitor using 
Distributed to Lumped Elements: Open Stub to Shunt C. The resulting 
schematic is given in Fig. 16.50d. 
 

256 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 16.50 Transform steps for the 1000- to 2000-MHz hybrid direct-coupled bandpass. 
 

Distributed Bandpass Filters 
257 
These transforms result in the responses given on the right in Fig. 
16.49. Most of the transforms are exact, but the quarter-wavelength 
transformers and the open-stub to shunt capacitor transforms are 
approximate. The wide bandwidth reduces the quality of these transforms. 
The return loss is degraded, and the bandwidth is somewhat wide. 
However, the lumped-shunt capacitors improve the stopband bandwidth 
and significantly reduce the size. 
Next, the electrical models for the TLEs are converted to microstrip on 
Rogers TMM6 50-mil substrate with Convert Using Advanced TLine. The 
resulting schematic is given at the top in Fig. 16.51. Prior to the conversion, 
very short lines are manually added between the lumped capacitors and the 
junction of the shunt and series lines. This facilitates adding the 
discontinuity models at this junction. The values given in the schematic are 
after optimization of the line widths and capacitor values to recover the 
response. Optimization reveals that the quarter wavelength transformers 
tend to be higher in value, suggesting that less transformation is required. 
Therefore, their length is manually reduced to the commensurate length to 
reduce the size of the final filter, and optimization is restarted. The 
responses after optimization are given in Fig. 16.52. The layout is given at 
the bottom of Fig. 16.51 at approximately 2x actual size. 
 
 
Figure 16.51 Hybrid 1000- to 2000-MHz bandpass microstrip schematic at top and layout at 
bottom (2X scale). 

258 
Filter Synthesis Using Genesys S/Filter 
 
Figure 16.52 Optimized responses of the microstrip hybrid 1000- to 2000-MHz bandpass. 
References 
[1] S. Yamashita and M. Makimoto, “Miniaturized Coaxial Resonator Partially 
Loaded with High-Dielectric-Constant Microwave Ceramics,” Trans. MTT-31, 
September 1983, p. 697. 
[2] R. Rhea, HF Filter Design and Computer Simulation, SciTech Publishing, 
Raleigh, NC, 1994. 
[3] B. Minnis, Designing Microwave Circuits by Exact Synthesis, Artech House, 
Norwood, MA, 1996. 
[4] G. Matthaei, L. Young, and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Norwood, MA, 1980. 
 

 
259 
 
17 Distributed Highpass Filters 
The L-C form of highpass filters is shunt inductors alternating with 
series capacitors. The series capacitor is difficult to realize in distributed 
form. Therefore, the highpass filter is often realized in distributed form by 
utilizing the lower transition region of a bandpass filter and accepting a 
finite limit to the upper passband frequency. An alternative approach is 
using shunt stubs to realize the shunt inductors and using lumped 
capacitors, or semilumped elements such as overlaid strips in multilayer 
structures. Because of TLE reentrance modes, these hybrid highpass filters 
also have a finite passband bandwidth. This chapter considers both 
approaches with filters on Rogers TMM6 50-mil-thick substrate material. 
17.1 The Hybrid Highpass 
This section covers realization of the series capacitance using lumped 
capacitors. Because chip capacitors are small and have high unloaded Q, 
this is an advantage when the manufacturing process supports lumped 
elements. Not only are chip capacitors smaller than distributed structures, 
they do not possess reentrance modes. 
Two basic approaches are used. The highpass is originally designed as 
lumped, and the shunt inductors are replaced with shorted stubs, or the 
original highpass is synthesized as distributed, and the resulting series-
open wirelines are replaced with lumped capacitors. 
17.1.1 The All-Pole Hybrid: Distributed Synthesis 
This example starts with a highpass synthesized as a distributed filter, 
extracted with a shunt element first. The Specification tab is given in Fig. 
17.1. Because all TZs are at DC, there is only one unique extraction 
sequence. Two extraction sequences are listed in the S/Filter table because 
the first listed is always the selected sequence. The fq is iteratively increased 
until the highest shunt-shorted TLE characteristic impedance reaches the 
maximum value that is desired for manufacture. In this case, fq equal to 
3870 MHz results in a maximum characteristic impedance of 119.78 ohms. 
The resulting schematic is given in Fig. 17.2a and the resulting response 
is given on the left in Fig. 17.3. Next, the transform Distributed to Lumped 
Equivalents: Wireline/Stub to Single L or C is applied to TL2 and TL4 with 

260 
Filter Synthesis Using Genesys S/Filter 
a transform frequency equal to the cutoff frequency, 1000 MHz. The 
resulting schematic is given in Fig. 17.2b. 
 
 
Figure 17.1 Specification tab for the highpass synthesized initially as a distributed filter. 
a
L=19.38mm
Z=119.78Ω
TL1
L=19.38mm
Z=29.48Ω
TL2
L=19.38mm
Z=64.59Ω
TL3
L=19.38mm
Z=29.48Ω
TL4
ZO=50Ω
L=19.38mm
Z=119.78Ω
TL5
ZO=50Ω
 
C=2.32pF
C2
L=19.38mm
Z=119.78Ω
TL1
L=19.38mm
Z=64.59Ω
TL2
L=19.38mm
Z=119.78Ω
TL3
C=2.32pF
C1
b
 
Figure 17.2 (a) Initial distributed highpass and (b) after transform of the series-open wirelines 
to lumped capacitors. 

Distributed Highpass Filters 
261 
The response of the hybrid highpass is given on the right in Fig. 17.3. 
The passband degradation above approximately 2500 MHz is caused by 
reentrance modes of the shunt TLEs. Synthesis produced commensurate 
shunt TLE. Consequently, with the first and last TLE at the maximum 
desired 120 ohms, the middle TLE characteristic impedance is more 
moderate. 
Extreme 
characteristic 
impedance 
improves 
passband 
bandwidth. Therefore, the alternative approach of starting with a lumped 
design is considered next. 
 
Figure 17.3 Responses of the initial synthesized distributed highpass (left) and after transform 
of the series-open wirelines to lumped capacitors (right). 
17.1.2 The All-Pole Hybrid Highpass: Lumped Synthesis 
In this case, the synthesis setup is the same except that the Process is 
specified as Lumped. The resulting schematic is given in Fig. 17.4a. The 
transform Lumped to Distributed Equivalents: Grounded L to Grounded 
Stub is applied to L1, L2, and L3. The Choose Theta option is selected, and a 
θ  of 240 at 1000 MHz is entered for L1 and L3. A θ  of 140 at 1000 MHz is 
entered for L2. An advantage of starting with a lumped synthesis is during 
the transform of the shunt inductors to TLE, the shortest possible length 
can be used for each transform. The lengths are not necessarily 
commensurate. The resulting responses are shown on the right in Fig. 17.5. 
The initial distributed synthesis results in a 20-dB return-loss passband to 
approximately 2700 MHz, while the transform from an initial lumped-
element design results in a passband to approximately 3300 MHz. 

262 
Filter Synthesis Using Genesys S/Filter 
L=8.19nH
L1
C=2.32pF
C1
L=4.42nH
L2
C=2.32pF
C2
L=8.19nH
L3
S=1
P=1
T1
a
ZO=50Ω
ZO=50Ω
 
C=2.32pF
C1
C=2.32pF
C2
L=19.99mm
Z=115.62Ω
TL1
L=11.66mm
Z=111.33Ω
TL2
L=19.99mm
Z=115.62Ω
TL3
b
 
C=2.32pF
C1
C=2.32pF
C2
c
L=9.05mm
W=0.21mm
TL1
L=4.73mm
W=0.24mm
TL2
L=9.05mm
W=0.21mm
TL3
 
 
Figure 17.4 (a) The initial lumped highpass, (b) after shunt inductors transformed to TLE, (c) 
after conversion of the TLE from electrical to physical, and (d) the final layout at 2X scale.  

Distributed Highpass Filters 
263 
 
Figure 17.5 Responses of the initial lumped highpass (left) and after transform of the shunt 
inductors to TLEs (right). 
17.1.3 The Hybrid Highpass with UEs 
In this example, UEs are added to the highpass illustrated in Section 17.1.1. 
This adds length to the filter, but improves the selectivity and the stopband 
performance. Synthesis begins with extracting a shunt element first, an odd 
quantity of TZs at DC, and N-1 UEs, where N is the quantity of TZs at DC. 
The extraction sequence that places a UE on each side of a series-open 
wireline is selected. To obtain the best stopband performance, fq is 
increased until the maximum TLE characteristic impedance approaches the 
maximum value it is desired to manufacture. In this case, fq is specified as 
3650 MHz. The resulting synthesized schematic for N equal to five is given 
in Fig. 17.6a and the resulting responses are given on the left in Fig. 17.7. 
Next, the series-open wirelines are converted to lumped capacitors at 
1000 MHz using the transform Distributed to Lumped Equivalents: 
Wireline Stub to Single L or C. The resulting schematic is given in Fig. 
17.6b and the responses are given on the right in Fig. 17.7. 

264 
Filter Synthesis Using Genesys S/Filter 
 
 
 
 
Figure 17.6 (a) Initial synthesized highpass with UEs, (b) after replacing the wirelines with 
lumped capacitors, and (c) values after optimization. (d) Further optimization allowing shorter 
TL2 through TL6 further improved the passband bandwidth. 

Distributed Highpass Filters 
265 
 
Figure 17.7 Initial response of the distributed highpass with UEs (left) and after transforming 
the series-open TLE to capacitors (right). 
The transform has significantly degraded the passband bandwidth. 
This is recovered by optimization of the capacitor values, and the 
characteristic impedance of the TLEs TL2 through TL6. During the initial 
optimization, it was noted that TL1 and TL7 tended to be higher than the 
desired maximum TLE characteristic impedance, so these lines are fixed at 
120 ohms and removed from the optimized variables. Symmetry is forced 
by using variables during optimization. The result is given on the left in Fig. 
17.8 and the final values in Fig. 17.6c. 
The moderate characteristic impedance of TL2 through TL6 suggests 
that more extreme impedances with shorter TLE lengths might extend the 
passband bandwidth. Therefore, the lengths of these TLEs are added to the 
optimized variables. The result is successful in extending the passband to 
3500 MHz, as given on the right in Fig. 17.8, and is the widest passband of 
the highpass filters designed so far. The final values are given in Fig. 17.6d. 
 

266 
Filter Synthesis Using Genesys S/Filter 
 
Figure 17.8 Responses after optimization of the commensurate-hybrid highpass filter (left), 
and extended passband bandwidth by optimization with shorter TL2 through TL6  (right). 
17.1.4 The Hybrid Highpass with an FTZ 
This example uses three TZ at DC and a FTZ at 665 MHz. Design begins 
with a lumped synthesis, a shunt element first, and the extraction sequence 
DC 665 DC DC. The schematic is given in Fig. 17.9a and the responses are 
given on the left in Fig. 17.10. 
The shunt inductors L1 and L3 are transformed to shorted TLE stubs 
using Lumped to Distributed Equivalents: Grounded L to Grounded Stub 
with the Choose Z0 option. A maximum TLE characteristic impedance of 
120 ohms is chosen to obtain the shortest feasible TLE length. Because of 
the presence of C2, S/Filter does not recognize L2 as a grounded inductor. 
Therefore, L2 is manually replaced with a TLE using Eq. 13.56. Again, a 
characteristic impedance of 120 ohms is used. The TLE lengths and 
capacitor values are then optimized to recover the response. The resulting 
schematic and values are given in Fig. 17.9b and the responses are given on 
the right in Fig. 17.10. This hybrid highpass is compact and has the best 
passband bandwidth of the hybrid highpass filters previously considered. 

Distributed Highpass Filters 
267 
L=8.13nH
L1
C=2.83pF
C1
C=2.83pF
C3
L=8.13nH
L3
a
L=6.89nH
L2
ZO=50Ω
C=8.31pF
C2
ZO=50Ω
 
C=3.04pF [C1]
C1
C=3.04pF [C1]
C3
C=8.05pF [C2]
C2
b
L=16.71mm [L1]
Z=120Ω
TL1
L=15.94mm [L3]
Z=120Ω
TL3
L=16.71mm [L1]
Z=120Ω
TL2
 
Figure 17.9 Initial schematic and transformed hybrid highpass with a FTZ. 
 
Figure 17.10 Initial responses of the 1000-MHz cutoff lumped highpass filter (left) and after 
transformation of the inductors to TLEs (right). 

268 
Filter Synthesis Using Genesys S/Filter 
17.2 Purely Distributed Highpass 
The highpass filters in this section are designed as purely distributed 
structures without the use of lumped capacitors. 
17.2.1 Highpass with Three TZs at DC and a UE 
Consider the Specification tab in Fig. 17.11. The initial schematic is given in 
Fig. 17.12a and the initial responses are given on the left in Fig. 17.13. The 
required transformations are then: 
1) Kuroda Wireline Transfers: Equal: Series Open Right is applied to 
TL2. 
2) Simplify Schematic removes the transformer. 
3) Coupled Lines: Interdigital Lines: Open, Open is applied to TL3 with 
the Symmetric PCL option. The result is given in Fig. 17.2b. 
4) The transformer, if present, is near unity ratio and is deleted. 
 
 
Figure 17.11 Specification tab for the 1000-MHz highpass with three TZs at DC and one UE. 

Distributed Highpass Filters 
269 
L=31.25mm
Z=72.3222Ω
TL1
ZO=50Ω
L=31.25mm
Z=74.2723Ω
TL2
L=31.25mm
Z=125.8251Ω
TL3
L=31.25mm
Z=194.8436Ω
TL4
S=0.6091
P=1
T1
ZO=50Ω
a
 
 
 
Figure 17.12 Transformations of the 1000-MHz highpass with three TZs at DC and one UE. 

270 
Filter Synthesis Using Genesys S/Filter 
 
Figure 17.13 Initial responses of the 1000-MHz highpass with three TZs at DC and one UE 
(left) and after optimization of the microstrip form (right). 
17.2.2 Highpass with Three TZs at DC and Four UEs 
In this example, the selectivity of the previous highpass filter is increased 
by increasing the quantity of UEs to four. Design begins with the extraction 
sequence DC UE UE DC UE UE DC with a series element first. The 
responses are given in Fig. 17.14. During the application of the following 
transforms, if a transformer appears with a near-unity turns ratio, that 
transformer is deleted. Pairs of nonunity ratio transformers are eliminated 
using the Simplify Circuit transform. The initial schematic is given in Fig. 
17.15a. The following transforms are applied. 
1) Kuroda Wireline Transfers: Equal: Series Open Left is applied to TL2. 
2) Kuroda Wireline Transfers: Equal: Series Open Right is applied to 
TL7. 
3) Simplify Schematic removes the transformers. 
4) Basic Operations: Split Shunt Element is applied to TL5 with equal 
elements. 
5) Kuroda Wireline Transfers: Equal: Shunt Grounded Right is applied 
to TL4. 
6) Kuroda Wireline Transfers: Equal: Shunt Grounded Left is applied to 
TL8. 
7) Simplify Schematic removes the transformers. 
8) Coupled Lines: Interdigital Lines: Open, Open is applied to TL2 and 
then TL8 with the Symmetric PCL option. 
The transformer, if present, is near unity ratio and is deleted. 

Distributed Highpass Filters 
271 
 
Figure 17.14 Responses of highpass with three TZs at DC and four UEs. 
 
Figure 17.15 (a) Initial schematic of the highpass with three TZs at DC and four UEs and (b) 
after transforms that eliminate the series-open wirelines. 

272 
Filter Synthesis Using Genesys S/Filter 
17.3 The Highpass Synthesized as a Bandpass 
Consider the response of the octave bandwidth bandpass filter in Fig. 16.52. 
Through 2000 MHz, the response is highpass and the filter may be used as 
such. For bandpass filters, increasing the quarter wavelength frequency, fq, 
of the elements extends the upper stopband bandwidth. This is not 
necessary for highpass filters, and this provides a degree of freedom. A wide 
bandpass may therefore serve as a highpass filter up to a certain frequency. 
The filter design resulting in Fig 16.52 places only one TZ at DC, which 
reduces the low side selectivity and the usefulness of this structure for a 
highpass filter. The ideal bandpass used as a highpass places more TZs at 
DC. These are the factors impacting the design of highpass filters as wide 
bandpass filters. 
17.3.1 Hybrid Highpass from an Eighth-Degree Bandpass 
Consider the Specification tab in Fig. 17.16. Synthesis begins with a 
distributed bandpass with four TZs at DC, two TZs at infinity, and two UEs. 
A wide passband is specified to increase the upper highpass passband 
frequency limit. The fq is selected as 4000 MHz to moderate the values of 
the realizable TLEs. The extraction sequence, UE DC UE DC  ∞ ∞ DC DC, 
results in a unity turns-ratio transformer and is selected. After deleting the 
transformer, the initial schematic is given in Fig. 17.17a and the responses 
are given on the left in Fig. 17.18. Notice that the frequency span is 
increased from the previous examples to 6000 MHz. This example has 
excellent passband bandwidth. 
 
 
Figure 17.16 Specification tab for the highpass filter synthesized as an eighth-degree 
bandpass. 

Distributed Highpass Filters 
273 
Unrealizable TLE such as series wirelines are generally dealt with in 
distributed design by transformation to coupled-line elements. However, 
with the wide bandwidth desired for highpass filter design, excessively tight 
coupling values are encountered. For this example, a hybrid approach is 
used by replacing the series-open wirelines with lumped capacitors. The 
characteristic impedance of TL6 is excessively high, but this is managed 
later. 
 
 
 
 
Figure 17.17 Transformation steps for the hybrid highpass designed as an eighth-degree 
bandpass. 
 
 

274 
Filter Synthesis Using Genesys S/Filter 
The series-open wirelines are transformed to lumped capacitors using 
Distributed to Lumped Equivalents: Wireline/Stub to Single L or C. The 
series-shorted wireline is transformed to a series TLE using TLines: 
Shorted Wireline to TLine with a chosen characteristic impedance of 60 
ohms. This value is arbitrary and is chosen close to the characteristic 
impedance of the adjacent TL3. The characteristic impedance of TL6 is too 
high to realize. Therefore, this element is first transformed to a shunt 
capacitor using Distributed to Lumped Equivalents: Open Stub to Shunt C, 
and this capacitor is then converted to an open stub with a characteristic 
impedance of 60 ohms. The resulting responses are given on the left in Fig. 
17.19. Although the transforms have significantly degraded the return loss, 
the 10-dB return loss to 5000 MHz suggests this filter could potentially 
have excellent passband bandwidth. 
 
 
Figure 17.18 Initial responses of the hybrid highpass designed as an eighth-degree 
bandpass. 
Therefore, the characteristic impedance of the commensurate length 
TLEs, the length of the 60-ohm TLEs, and the capacitor values are 
optimized to recover the responses. The results given on the right in Fig. 
17.19 reveal excellent passband bandwidth. 
 

Distributed Highpass Filters 
275 
 
Figure 17.19 Responses of the eighth-degree highpass after transformation of the wireline 
TLEs (left) and optimization (right). 
17.3.2 Hybrid Highpass from a 10th-Degree Bandpass 
The previous example results in the widest passband of any of the highpass 
filters considered thus far. However, the selectivity below the cutoff is 
rather poor. To increase selectivity, a 10th-degree filter is designed. The 
Specification tab is similar to the previous example except the quantity of 
TZs at DC is increased to six, the upper cutoff is increased to 4000 MHz, 
and fq is increased to 5000 MHz. The selected extraction is a shunt element 
first with the sequence UE DC  ∞ DC DC UE ∞ DC DC DC. The resulting 
schematic is given in Fig. 17.20a and the initial responses are given on the 
left in Fig. 17.21. 
The transformer turns ratio is 0.99, so close to unity that the 
transformer is deleted, and the slight degradation of the responses is 
recovered by the final optimization. As with the previous example, the 
series-open wirelines are transformed to series-lumped capacitors, and the 
series-shorted wirelines are transformed to 60-ohm series TLEs. The 
results are given in Fig. 17.20b. The resulting responses appear to have the 
potential for an extremely wide passband, so the optimization goals are set 
for a passband to 6000 MHz. Although unconventional, the resulting  
highpass has good selectivity and has the best passband bandwidth of the 
example filters in this chapter. 
 

276 
Filter Synthesis Using Genesys S/Filter 
L=15mm
Z=104.37Ω
TL2
L=15mm
Z=21Ω
TL4
L=15mm
Z=60.4Ω
TL5
L=15mm
Z=17.29Ω
TL7
L=15mm
Z=35.51Ω
TL8
L=15mm
Z=17.94Ω
TL10
L=15mm
Z=11.8Ω
TL3
L=15mm
Z=35.56Ω
TL6
L=15mm
Z=115.77Ω
TL9
L=15mm
Z=37.36Ω
TL1
a
ZO=50Ω
S=0.99
P=1
T1
ZO=50Ω
 
 
 
Figure 17.20 Transformation steps for the 10th-degree hybrid highpass filter. 
 
Figure 17.21 Initial responses (left) and after transformation and optimization (right) of the 
10th-degree hybrid highpass filter.

 
277 
 
18 Multiplexers 
Multiplexers as considered in this chapter are three or more port 
devices that route signals to alternate ports based on frequency. They are 
used to either split signals and divert them to a given port, or to combine 
signals from alternate ports at a single port. A three-port device is referred 
to as a diplexer. Devices with four or more ports are referred to as 
multiplexers. Multiplexers differ from splitters and combiners in that with 
ideal elements, the signal loss is zero. Whereas with splitters, the responses 
are broadband, but signal power is divided among output ports [1]. 
Passive linear filters are reciprocal so design concepts are the same 
whether the multiplexer is used to split or to combine signals. The 
individual filters are a combination of lowpass and/or highpass filters, with 
any quantity of bandpass filters. Therefore, there are an infinite variety of 
multiplexers. Multiplexers are created in Genesys by designing the 
individual filters and pasting them into a common schematic. All of the 
features of the simulator are available, such as statistical, tuning, 
optimization, and electromagnetic analysis. 
18.1 Contiguous Multiplexers 
There are two classes of multiplexers. The cutoffs of contiguous 
multiplexers share a common 3.01-dB frequency. The cutoff frequencies of 
noncontiguous multiplexers are separated by a guard band, and the 
attenuation at the crossover frequency is greater than 3.01 dB, typically 
much so. The design procedure and the performance in the crossover 
frequency range are different for these two classes of multiplexers. The 
contiguous multiplexer is considered first. 
18.1.1 Contiguous Lowpass-Highpass Diplexer 
Consider the basic lowpass-highpass diplexer in Fig. 18.1. The individual 
fourth-degree lowpass and highpass filters are designed using the Passive 
Filter module of Genesys and pasted into a new schematic. Other than 
connecting the filters at the common port and numbering the ports, no 
other modifications are necessary. It is critical that each filter presents a 
series element to the common port. The stopband of each filter is in the 
frequency range of the passband of the other filter. A series element causes 
a high impedance in the stopband of one filter to be presented to the 
passband of the other filter, thus avoiding interaction and destruction of 
the passbands. If these two filters are connected at the ports with shunt 

278 
Filter Synthesis Using Genesys S/Filter 
elements, L3 shunts the passband of the lowpass, and C1 shunts the 
passband of the highpass. In the case of bandpass sections, a series L-C 
resonator must connect to the common port. 
 
 
Figure 18.1 Basic lowpass-highpass diplexer. 
The transmission amplitude responses of the basic diplexer are given in 
Fig. 18.2. The selected transfer approximation for each filter is Butterworth, 
with a 3.01-dB cutoff of 100 MHz for each filter. The isolation of ports two 
and three degrade to 6.02 dB at the cutoff frequency. 
The individual filters are designed as singly terminated, where the 
transfer function is realized with a finite termination resistance at one port 
and a zero impedance at the common port. Singly terminated filters do not 
present zero ohms to this port. When used individually, singly terminated 
filters are mismatched and deliver only current or voltage to the load, but 
not power. But when two singly terminated Butterworth filters are parallel 
connected and share a 3.01-dB cutoff frequency, the filters are said to be 
complementary, and the input impedance at the common port is matched 
at all frequencies. S11 is not displayed in Fig. 18.2 because the return loss is 
infinite at all frequencies. S/Filter does not support singly terminated 
filters, so the Passive Filter module of Genesys must be used to design 
contiguous multiplexers. Only singly terminated Butterworth filters are 
truly complementary. However, as illustrated in the next example, singly 
terminated Chebyshev filters are approximately complementary. 
 

Multiplexers 
279 
 
Figure 18.2 Transmission amplitude responses of the basic lowpass-highpass diplexer. 
18.1.2 Contiguous LP/BP/HP Multiplexer 
This example is a Chebyshev contiguous multiplexer with a lowpass 
channel from DC to 3 MHz, a bandpass channel from 3 to 30 MHz, and a 
highpass channel above 30 MHz. Given in Fig. 18.3 are the individual, 
singly terminated filter schematics, and a schematic that assembles these 
filters. Reusing the schematics to assemble the diplexer in Genesys allows 
the user to modify the parameters of the individual filters without needing 
to repaste a new schematic into the diplexer schematic. 
Filters using Chebyshev transfer approximations are approximately 
complementary. The best wideband, common-port return loss is realized 
using a cutoff attenuation of approximately 3 dB. The reused schematic 
build illustrated in Fig. 18.3 supports iteratively adjusting the cutoff of each 
filter for the best wideband return loss. In this case, individual filter cutoff 
attenuations of 3.5 dB resulted in the best return loss. In this example, the 
individual filters are designed with a passband ripple of 0.25 dB, which 
would result in a passband return loss of 12.5 dB. However, due to the 
approximate complementary nature of this contiguous multiplexer, the 
worst-case return loss at the common port is approximately 22.5 dB, as 
illustrated in the multiplexer responses given in Fig. 18.4. 

280 
Filter Synthesis Using Genesys S/Filter 
C=844.69pF
C1
L=4049.7nH
L1
C=1958.68pF
C2
ZO=50Ω
L=3984.49nH
L2
ZO=0Ω
L=333.2nH
L1
C=69.5pF
C1
L=143.69nH
L2
C=70.64pF
C2
ZO=50Ω
ZO=0Ω
 
L=2998.77nH
L1
C=93.85pF
C1
L=449.97nH
L2
C=625.49pF
C2
L=1293.23nH
L3
C=217.63pF
C3
L=442.72nH
L4
C=635.72pF
C4
ZO=50Ω
ZO=0Ω
 
BP_Filter
ZO=50Ω
Port_3
ZO=50Ω
Port_4
HP_Filter
LP_Filter
ZO=50Ω
Port_2
ZO=50Ω
Port_1
 
Figure 18.3 Lowpass (top left), highpass (top right), and bandpass (middle) components of 
the multiplexer with the reused filters assembled into the multiplexer (bottom). 
 
 

Multiplexers 
281 
 
Figure 18.4 Responses of the contiguous lowpass/bandpass/highpass multiplexer. 
18.2 Noncontiguous Multiplexers 
In this section, the design of noncontiguous diplexers and multiplexers is 
illustrated. As with contiguous multiplexers, a series branch must connect 
the individual filters to the common port. However, the individual channel 
filters of noncontiguous multiplexers are synthesized as doubly terminated. 
Therefore, the unique advantages of S/Filter for synthesizing the individual 
filters is available for multiplexer design. Noncontiguous multiplexers 
forego excellent return loss in the crossover region, but have the advantage 
of better isolation between the noncommon ports. 
18.2.1 Noncontiguous LP/HP Diplexer with FTZ 
This example is a diplexer with a lowpass channel from DC to 30 MHz and 
a highpass channel for 50 MHz and above, resulting in a 20-MHz guard 
band. The individual filters are designed in S/Filter and are doubly 
terminated with a 0.1-dB ripple Chebyshev passband and one FTZ. The 
schematics are given in Fig. 18.5. 
The responses of the individual filters plotted on one graph grid are 
given on the left in Fig. 18.6. Each filter has approximately 16-dB return 
loss and a stopband minimum attenuation of 30 dB. The FTZ are 42.2 MHz 
for the lowpass and 35.5 MHz for the highpass. Given on the right in Fig. 
18.6 are the responses after the individual filters are parallel connected to 
form the diplexer. Interaction between the filters degrades the passband 

282 
Filter Synthesis Using Genesys S/Filter 
return loss to approximately 15 dB and has shifted the cutoffs by several 
megahertz. 
 
Figure 18.5 Schematic of the LP/HP 30-/50-MHz noncontiguous diplexer with doubly 
terminated channel filters. 
To recover the responses, the left three elements of each filter are 
optimized with goals of re-establishing the initial return losses and cutoffs. 
The optimization converges quickly to the responses given in Fig. 18.7. 
Unlike contiguous diplexers, the return loss is poor in the crossover region, 
but a minimum isolation of 35 dB is maintained. 

Multiplexers 
283 
 
Figure 18.6 Responses of the individual channel filters plotted on one graph (left), and 
responses after parallel connection of the filters to form the noncontiguous diplexer (right). 
 
Figure 18.7 Optimized responses of the LP/HP noncontiguous diplexer. 
 
 

284 
Filter Synthesis Using Genesys S/Filter 
18.2.2 Noncontiguous Distributed Combline Diplexer 
This example is a noncontiguous, distributed bandpass/bandpass diplexer. 
Design begins with individual, capacitor-loaded, combline bandpass filters. 
The lower bandpass covering 925 to 975 MHz is given in Fig. 18.8. This 
filter is designed in the Genesys Microwave Filter module and then 
optimized for the best responses, as shown on the left in the left graph of 
Fig. 18.9. 
Port_1
L=8.45mm [Llead]
W=1.7mm [WLead]
TL1
C=1.84pF [Cap1]
C1
C=1.77pF [Cap2]
C2
C=1.84pF [Cap1]
C3
Port_2
L=8.45mm [Llead]
W=1.7mm [WLead]
TL3
5
4
3
2
1
L=25mm [L1]
S4=0.61mm [S1]
S3=2.6mm [S2]
S2=2.6mm [S2]
S1=0.61mm [S1]
W=1.7mm
TL2
 
Figure 18.8 Combline sixth-degree 925- to 975-MHz bandpass filter. 
A upper bandpass covering 1025 to 1075 MHz is similarly designed in 
the Microwave Filter module and optimized. The responses are given on 
the right in the left figure of Fig. 18.9. These two comblines are then 
connected as shown in the schematic in Fig. 18.10. The responses are given 
on the right side of Fig. 18.9. Filter interaction has narrowed the lower 
channel passband, widened the upper channel passband, and significantly 
degraded the return loss of both channels. 
The coupled-line spacings and loading capacitors are then optimized to 
recover the responses using variables to force symmetry in the resulting 
values. The final values are given in the schematic of Fig. 18.10 and the 
resulting responses are given on the left in Fig. 18.11. The cutoff frequencies 
and return loss are recovered to approximately 20 dB. Nevertheless, 
interaction remains and is visible in the transition regions of the channel 
filters below approximately 25 dB of attenuation. 
 

Multiplexers 
285 
 
Figure 18.9 Individual responses of two combline bandpass filters plotted on the same graph 
(left) and responses after connection as a diplexer (right). 
Prior to optimization, a susceptance compensation network, in the 
form of a shorted stub approximately a quarter-wavelength long at the 
crossover frequency, is manually added at the common port of the diplexer. 
The length and width of this network is optimized simultaneously with the 
other variables. Susceptance networks, in the form of shorted quarter-
wavelength stubs or series L-C networks to ground, are often added to 
compensate for interaction effects in diplexers. 
Given on the right in Fig. 18.11 is the channel isolation. This is the 
amplitude transmission between ports two and three of the diplexer. 

286 
Filter Synthesis Using Genesys S/Filter 
 
Figure 18.10 Optimized schematic of the combline bandpass-bandpass diplexer. 

Multiplexers 
287 
 
Figure 18.11 Channel transmission amplitude and return-loss responses of the optimized 
combline diplexer (left) and the isolation from port two to port three (right). 
Reference 
[1] G. Matthaei, L. Young, and E.M.T. Jones, Microwave Filters, Impedance-
Matching Networks, and Coupling Structures, Artech House, Norwood, MA, 1980. 
 


 
289 
 
19 Electromagnetic Simulation 
In earlier chapters, simulation of the responses utilized closed-form, 
analytical models for both lumped and TLEs. The emphasis in this book is 
synthesis and transforms. Simulation is used to illustrate the success or 
failure of these processes. Other works by the author illustrate the practical 
aspects of filter realization [1-3] such as models, element (unloaded) Q, 
losses, parasitics, tolerance, tuning, and standard values. For lumped 
elements, the Genesys environment supports convenient substitution of 
user developed and commercial models.  
Distributed models in Genesys use refined and accurate industry-
published models. However, these models cannot consider a multitude of 
factors including box modes, radiation, coupling between discontinuities, 
and unusual geometries. These factors may significantly impact the 
accuracy of the circuit theory simulation. Electromagnetic (EM) simulation 
is a powerful tool for dealing with these issues. In this chapter, EM 
simulation is used to further refine a few of the filters synthesized in this 
book and to review a classic method of filter design newly enabled by EM 
simulation. 
19.1 Overview 
Circuit simulators rely on network theory applied to impedance and 
admittance models for individual elements. In the case of lumped elements, 
simple reactance models, or models using a small subcircuit of elements, 
are used. For TLEs, pure-TEM mode elements such as coax are modeled as 
simple trigonometric functions. Models for quasi-TEM mode elements, 
such as microstrip, are modeled by more complex functions that are based 
on curve-fits to numeric data. In isolation, these models are accurate. 
However, their accuracy is reduced by interactions, and models are often 
not available for unusual geometries. 
Rather than relying on network theory, EM simulators compute the 
currents and fields produced in the metal of a circuit. Fundamentally, these 
calculations rely on Maxwell’s equations, but to produce practical results, 
involved mathematical concepts and tricks are employed. These concepts 
vary among different commercial software programs. 
Two-dimensional (2-D) simulators analyze only problems that are 
infinitely continuous in one direction. Uniform transmission lines and 
waveguides are analyzed with great numeric efficiency using this technique. 

290 
Filter Synthesis Using Genesys S/Filter 
It is suitable for finding the characteristic impedance of unusual 
geometries. Execution speed is excellent, but flexibility is limited. 
2 ½-D simulators provide for arbitrary geometry in an x-y plane and 
are suitable for analyzing discontinuities such as tees, bends, crosses, and 
transmission line coupling. No currents are simulated in the z-direction. 
3-D planar simulators support arbitrary x-y currents, and they support 
some functionality for z-directed currents. This supports multiple planes 
and via hole currents connecting those planes. Via holes are simulated as a 
single current and must be small in diameter and short with respect to a 
wavelength. Fields are 3-D, so antenna patterns can be computed. 
Full 3-D simulators support arbitrary 3-D metal. They are truly flexible, 
but require significant computational resources. They are inefficient for 
solving 3-D planar problems. 
19.1.1 The EMPower Program 
Work began on EMPower at the Novosibirsk Electrical Engineering 
Institute in 1987. This led to the development of the program TAMIC in 
1991 with commercial use primarily in the Soviet Union. The principal 
contributor, Yuri Shlepnev, joined Eagleware and led the integration of 
EMPower into Genesys with the release of Version 6.5 in 1998. 
EMPower is a 3-D planar EM simulator. It uses the method of lines 
(MOL) technique. The initial planar 3-D geometry is reduced to a layered 2-
D problem by partial discretization of Maxwell’s equations in a grid 
domain. The resulting matrix relating grid currents and voltages is reduced 
to an immitance matrix of integral currents and voltages in ports. The 
method of simultaneous diagonalization extracts the scattering matrix. The 
MOL gives a self-regulating solution with only one variable: grid cell size. 
This approach offers good convergence and accuracy. The primary 
disadvantage is the requirement for a uniform grid. EMPower mitigates 
this disadvantage by a number of automatic techniques including thinning 
into groups of cells and detection of symmetry, which greatly reduces the 
numeric cost. The comparatives of EMPower are: 
1) Full integration into Genesys with automatic cosimulation. One 
schematic and layout are used for the linear, EM, harmonic balance, 
and time-domain simulators. This schematic is created either by a 
synthesis process or by the user. EMPower automatically removes 
discrete (lumped) elements, adds internal ports for the EM simulation, 
and re-installs the discrete elements for an integrated simulation. 
2) Fast and accurate simulation of metal patterns that can be placed on a 
grid, or that are small with respect to a wavelength. This requires 
discipline by the user to ensure that lines and metal patterns are a 
multiple of a user-selected size. The benefit is fast execution. However, 
the grid is a disadvantage for some structures, such as filters with wide 
lines but narrow gaps. 

Electromagnetic Simulation 
291 
3) Automatic detection of YZ, XZ, two-mirror and rotational symmetry. 
This substantially reduces the computational cost of symmetric 
structures common with distributed filters. 
4) Supports the decomposition of a circuit into blocks. These blocks are 
then connected with analytical transmission-line models. This 
technique takes advantage of the real-time speed of circuit theory 
simulation with the addition of EM simulation for those portions of 
the circuit where it is required. Although decomposition requires 
additional implementation steps, for large symmetric structures, like 
high-degree filters, it can save substantial execution time. 
5) Consideration of the effects of the housing. Box modes significantly 
impact the response characteristics of both active and passive circuits. 
6) Closed or open housing covers and antenna pattern plotting. However, 
for circuits with a non-conductive housing, or for more advanced 
planar antenna simulation, the program Momentum is a better choice. 
19.1.2 The Momentum Program 
Momentum is a 3-D planar EM simulator based on the method of moments 
(MOM). It was originally developed by Alphabit, a spin-off of the Belgium 
company IMEC, and was acquired by Agilent Technologies (then Hewlett-
Packard) in 1990.  
MOM is a numerical discretization technique used to solve Maxwell’s 
equations for planar metal structures that are embedded in a multilayer 
dielectric substrate. First the substrate Green’s functions are calculated, 
then the planar signal structures are meshed to form the MOM interaction 
matrix that is solved for the unknown surface electric and magnetic 
currents. S-parameters are then accurately derived from the solution after 
port calibration and de-embedding similar to making a network analyzer 
measurement. 
The comparatives of Momentum are: 
1) Full integration into Genesys with automatic cosimulation as described 
with EMPOWER. 
2) Advanced automatic and/or user-directed meshing techniques. 
Conforming the circuit to a grid is unnecessary. Efficient for solving 
circuits with combined wide-strips and narrow gaps common in filter 
applications. 
3) Adaptive frequency sampling for fast simulation. This is particularly 
useful when resonant or critical frequencies are initially unknown. 
4) Support for open (infinite-extent PCB), closed, and waveguide (two-
vertical conducting walls) environments. Accurate results for metal-
packaged, nonconducting packaged, and antenna circuits. 
5) Full-wave and quasistatic modes. Full-wave is appropriate for 
microwave integrated circuits (MICs) and monolithic-microwave 

292 
Filter Synthesis Using Genesys S/Filter 
integrated circuits (MMICs) with lengthy or resonant transmission 
lines such as filters. Quasistatic is efficient for large-scale circuits 
comprised of electrically short metal. 
6) 3-D display of currents in complex layered circuits with via holes and 
thick metal. 
19.1.3 The EMPro Program 
EMPro is a full 3-D metal EM simulator that operates in two modes; a 
frequency-domain finite element method (FEM), and a time-domain finite 
difference time domain (FDTD) method. FEM uses volumetric meshing 
where the geometry is divided into a large number of tetrahedral formed by 
four equilateral triangles. The FEM simulator includes both direct and 
iterative solvers with linear and quadratic basis functions. The FDTD solver 
uses meshes built from rectangular “Y” cells. The FDTD method updates 
field values while stepping time, following EM waves propagating through 
the structure. 
The EMPro FEM solver comparatives are as follows: 
1) Simulation of true 3-D metal and dielectric problems such as bond 
wires, connectors, RFIC packaging, dielectric objects, and 3-D RF 
elements. 
2) Full integration into the ADS environment and importation into 
Genesys using S-parameter data files. 
3) Handling of high-Q circuits. 
4) Best solution for smaller 3-D objects. 
5) Best solution for multiport problems. 
6) Multi-threading for support on multicore CPUs. 
The EMPro FDTD solver comparatives are: 
1) Simulation of true 3-D metal and dielectric problems such as bond 
wires, connectors, RFIC packaging, dielectric objects, and 3-D RF 
elements. 
2) Full integration into the ADS environment and importation into 
Genesys using S-parameter data files. 
3) Requires separate simulation for each port. 
4) Less memory intensive for larger problems. 
5) Highly multithreaded for support of multicore CPUs and large CPU 
cards. 
19.2 Box Modes 
The first example to illustrate EM simulation is a study of box modes. A 
conductive housing that encloses a filter is a cavity. At the frequencies of 

Electromagnetic Simulation 
293 
cavity resonance, TLE discontinuities such as open ends, bends, and steps 
easily couple energy into and out of the cavity, resulting in destruction of 
the stop bands. The frequency of resonance in a rectangular cavity is [4]  
2
2
2
2






+






+






=
c
n
b
m
a
l
v
f
r
r
lmn
ε
µ
                                    (19.1) 
where l, m, and n are the TElmn-mode subscripts related to the half-sinusoid 
number in the standing-wave pattern in the x, y, and z directions of the 
cavity, with corresponding dimensions a, b, and c. 
r
µ and 
r
ε are the relative 
permeability and permittivity of the cavity-filling material. For example, 
the dominant-mode TE101 resonance of a 4- by 6-cm rectangular air-filled 
cavity that is 1-cm high is 4.51 GHz. For the dominant mode, the smallest 
dimension, in this case the heigth b, does not influence the resonant 
frequency. 
Fig. 19.1 depicts a 4- by 6-cm rectangular cavity with 2-mm wide input 
and output microstrip lines on Rogers TMM6 ½ ounce electrodeposited 
copper with a 50-mil thick substrate of nominal relative dielectric constant 
6.0. This width line is approximately 50 ohms. The gap is far too wide to 
support significant transmission from the input to the output via gap 
capacitance. 
 
 
Figure 19.1 A 4- by 6-cm rectangular housing with microstrip input and output lines 
(approximately to scale). 
Given in Fig. 19.2 is the amplitude transmission of this system from the 
housing port on the left to the housing port on the right, computed using 
the EMPower electromagnetic simulator module of the Genesys suite. To 
resolve the narrow resonant modes, frequency steps every 20 MHz are 
used, thus requiring 400 frequency steps. The simulation is completed in a 
few minutes on a standard desktop PC with an Intel Core2 2.5-GHz CPU. 
The TE101-mode resonance occurs at approximately 4.3 GHz. The simulated 
resonant frequency is slightly lower than predicted by Eq. 13.1 because the 

294 
Filter Synthesis Using Genesys S/Filter 
50-mil thick TMM6 substrate loads about 13% of the height of the cavity. 
The presence of the microstrip metal pattern also loads the cavity. 
Radiation from the microstrip open ends and/or the standing-wave 
pattern on the microstrip TLE readily couples to the cavity resonances. The 
sweep through 10 GHz reveals three resonances as well as antiresonances, 
with degraded stopband performance between resonances. The cavity 
resonances are almost lossless, and the displayed loss of all three 
resonances is nearly zero when the number of frequency simulation points 
is sufficiently large. 
In this case, stopbands better than 40 dB are unavailable at frequencies 
above one half the lowest resonant frequency. Resonant frequencies scale 
directly with the housing size. It is clear that achieving good stopband 
performance at higher frequency requires a small housing. Cavity 
resonance is why small filter size is critical for good stopband performance. 
Given on the right in Fig. 19.2 is the response of the same layout but on 
an open PCB without a conductive housing, as computed by the Momentum 
EM simulator module of the Genesys suite. Resonances are avoided, thus 
improving the potential stopband performance of filters. Nevertheless, 
surface modes and edge reflections severely limit the ultimate stopband 
performance. 
 
 
Figure 19.2 Transmission amplitude response of the microstrip TLEs enclosed in a 4- by 6-cm 
housing computed by EMPower (left) and on an open 4- by 6-cm PCB computed by 
Momentum (right). 
EMPower is more efficient for solving the enclosed box-mode problem 
because the metal is easily placed on a grid, the problem is symmetric, and 
a large number of frequencies are required to simulate the narrow 
resonances of the box modes. Momentum is used to solve the open PCB 

Electromagnetic Simulation 
295 
case study because it more accurately supports open structures and the 
lower Q requires fewer frequency points. 
This case study also illustrates the author’s insistent preference 
throughout this book for smaller filter topologies. Smaller filters naturally 
require smaller housings, which increases the frequency of the first 
resonant mode, and therefore the stopband performance of the filter. 
19.3 EM Simulation of Distributed Circuits 
This section illustrates the use of EM simulation to improve the accuracy of 
predicted responses. Both the Agilent Technologies EM simulator 
Momentum and the simulator EMPower are used for these examples. 
19.3.1 EM Simulation of Penetrating Stepped-Z Lowpass 
Consider the penetrating, stepped-impedance 2.4-GHz lowpass filter 
described in Section 14.3. An Agilent Technologies Momentum simulation 
is added to the Genesys workspace tree and the general simulation 
properties illustrated in Fig. 19.3 are entered. The values of other 
parameters in the Momentum options tabs are left at default values, except 
the Use Box option is selected in the Simulation Options tab. 
The box size is set at 1.58-cm long by 1.20-cm wide. As with the original 
filter, the PCB material is Rogers TMM6 half-ounce copper on a 50-mil 
substrate. The height of the enclosure is 0.64 cm, with a conducting cover. 
The dominant mode resonance for this enclosure, if unloaded with a 
substrate, is 15.6 GHz. The mesh automatically generated by Momentum 
for EM simulation is visible as gray lines in the layout in Fig. 19.4. 
Responses for this lowpass are given in Fig. 19.5. The solid traces are 
computed by the linear circuit-theory simulator in Genesys. The dashed 
traces are the responses computed by the Momentum simulation The 
required tee models are small and of little consequence. However, the 
asymmetric step at the input/output lines, and the large steps associated 
with the high-impedance lines to the low-impedance stubs, are severe. 
Nevertheless, the excellent agreement of the cutoff frequency, and the 
return-loss responses through the cutoff frequency, suggests that the static 
model quality of the circuit theory simulator is good. A small error easily 
produces return-loss disagreements of 20 and 30 dB. 
 

296 
Filter Synthesis Using Genesys S/Filter 
 
Figure 19.3 General simulation properties for the penetrating, stepped-impedance 2.4-GHz 
lowpass filter. 
 
 
 

Electromagnetic Simulation 
297 
 
Figure 19.4 Layout of the original penetrating, stepped-impedance 2.4-GHz lowpass filter 
overlaid with the mesh automatically generated by the Momentum simulator (left), and after 
narrowing and lengthening the open stubs (right). 
 
Figure 19.5 Responses of the penetrating, stepped-impedance 2.4-GHz lowpass filter (right 
graph) by circuit theory simulation (solid) and Momentum EM simulation (dashed), and the 
responses after narrowing and lengthening the open stubs (right). 
Agreement of the EM and circuit-theory responses is fair up to 
approximately 8 GHz. EM simulation predicts a somewhat lower frequency 
of the transmission zeros, and interaction of the two resonances to produce 
different frequency zeros. This also produces a somewhat steeper 
transition. Cascaded stubs typically produce interactions of this form. The 
layout after narrowing the open stubs, and then lengthening them to return 
the capacitance, is given on the left in Fig. 19.4. The agreement is improved 
through 12 GHz. The resonance at 8400 MHz in the EM simulation of the 

298 
Filter Synthesis Using Genesys S/Filter 
original design is possibly caused by interaction of the closer-spaced open 
stubs of the original layout. 
The Momentum responses are similar when the thick metal option is 
selected, suggesting that the 0.02 mm thickness of the half-ounce copper is 
of little consequence in this circuit. 
In this case, circuit-theory simulation is adequate for design, but EM 
simulation improves the accuracy of the predicted responses. Of course, the 
final test is measured results, but experience shows that properly set up EM 
simulations are extremely accurate. 
19.3.2 EM Simulation of a Combline Bandpass 
Consider the 950- to 1050-MHz, three-resonator combline bandpass in 
Section 16.2.1. The layout for this filter is given in Fig. 19.6. The three larger 
footprint pads are for miniature trimmer capacitors to load and tune the 
filter. With 10% and less bandwidth, the tolerance of fixed capacitors is 
unlikely to be sufficient, and trimming is required. The smaller footprints 
near the input and output are for smaller, fixed-chip capacitors. Coupling-
capacitor values are less critical.  
Overlaid on the layout is the mesh created by the Momentum 
simulator. When all the filter resonators are loaded with capacitors to 
achieve resonance, the metal portion of the circuit is nonresonant. 
Consequently, the characteristics of the unloaded structure change slowly 
with frequency. In this case, few simulation frequencies are required. 
Resonance and the responses are realized when the capacitors are 
cosimulated with the metal. This saves EM simulation time. 
The responses of the combline computed by circuit-theory simulation 
are given as the light traces on the left graph of Fig. 19.7. The responses of 
the Momentum EM simulation are given as the heavy traces. Inspection of 
the layout reveals that the required trimmer and chip-capacitor pads add 
metal at the open ends of the combline, thus adding capacitance to ground. 
This additional capacitance lowers the passband of the filter. Optimization 
of capacitance values is used to recover the passband response as illustrated 
on the right in Fig. 19.7. Optimization reduces the coupling capacitors from 
1.27 to 1.21 pF, the end-resonator loading capacitors from 2.13 to 1.7 pF, 
and the center loading capacitor from 3.23 to 2.67 PF. The cosimulation 
environment of Genesys supports optimization of the lumped elements 
without requiring the EM simulation of the metal. 
 

Electromagnetic Simulation 
299 
 
Figure 19.6 Layout for the 950- to 1050-MHz combline bandpass overlaid with the mesh 
automatically created by the Momentum EM simulator. 
 
Figure 19.7 Responses of the 950- to 1050-MHz combline simulated with circuit-theory 
models (light traces) and by Momentum (heavy traces). The Momentum simulation with initial 
capacitor values is on the left and after optimization of the capacitors is on the right. 
 
 

300 
Filter Synthesis Using Genesys S/Filter 
The primary coupling of an ideal combline structure is inductive. The 
capacitor pads at the open end of this combline provide capacitive coupling 
between the resonators. This capacitive coupling in parallel with the 
coupled-line inductive coupling results in finite-transmission zeros above 
the passband, as observed in the responses in Fig. 19.7. 
19.3.3 EM Simulation of a Direct-Coupled Bandpass 
Consider the wideband direct-coupled bandpass in Section 16.3.3. In this 
section, the accuracy of the circuit-theory simulation for this 1000- to 
2000-MHz bandpass is tested by EM simulation and corrections to the 
design are applied, as required. In the original design as shown in Fig. 
16.51, the footprint pads of the chip capacitors are placed over the metal of 
the TLEs. This is done to minimize metal added to the layout that might 
impact the responses. However, EM simulation induced corrections to the 
responses modify the width of the series TLEs. This could cause the series 
TLE to short to the grounded portion of the chip-capacitor pads. Therefore, 
the chip-capacitor pads are placed at the end of narrow TLE connecting 
lines that are 0.6 mm long. When the automatic-connect feature in the 
Genesys layout module is used, these connecting lines are sufficiently long 
to avoid the series TLE contacting the capacitor pads. The modified layout 
is given in Fig. 19.8. 
 
 
Figure 19.8 Layout of the 1- to 2-GHz bandpass after modification of the placement of the 
chip-capacitor pads. 
The EM simulated responses of the 1- to 2-GHz bandpass after 
modifying the locations of the chip-capacitor pads but before tuning is 
given on the left in Fig. 19.9. The EMPower and Momentum EM simulators 
support optimization of the layout. By using the Connect Parts before 
Simulating option, as TLE dimensions are optimized, the elements remain 
connected. 
 

Electromagnetic Simulation 
301 
 
Figure 19.9 EM-simulated responses of the 1- to 2-GHz bandpass before (left) and after 
tuning to correct the responses (right). 
In order to correct the return loss, the center frequency, and the 
bandwidth of the filter, optimization must adjust several parameters of the 
filter. Because each pass is computationally expensive for EM simulation, 
and because of the requirement to adjust multiple parameters, optimization 
requires significant time. A difficulty with bandpass filters is the 
nonindependence of parameters. For example, increased line length might 
adjust the bandwidth, but it also reduces the resonant frequency. 
Therefore, to correct the responses, tuning rather than optimization is 
applied. Iterative actions by an intelligent user, while tedious and time 
consuming, is more effective than optimization in this case. If tuning is 
simply trial and error, it is ineffective. However, certain principles guide the 
tuning process. Principles common to many filter structures are: 
1) Lengthening lines shifts the passband down. 
2) Widening the spacing between coupled TLEs decreases the bandwidth. 
3) Increasing the characteristic impedance of connecting lines in direct-
coupled filters decreases the bandwidth. 
4) Adjusting the characteristic impedance of lines connecting to the 
terminations changes the return loss properties. 
5) Steps of one parameter at a time reveals behavior. 
Notice in the responses on the left in Fig. 19.9 that the filter bandwidth is 
too narrow and the center of the passband is too low. The author used 
principles 1), 3), 4) and 5) in this case to tune the responses. The resulting 
responses are given on the right in Fig. 19.9. The final tuned values are 
given in Fig. 19.10. 

302 
Filter Synthesis Using Genesys S/Filter 
 
Figure 19.10 Schematic of the 1- to 2-GHz bandpass with TLE dimensions after tuning to 
correct the responses. 
19.4 Classic Method of Bandpass Design 
The focus of this book is filter design using direct synthesis. As such, this 
section is off topic. However, a motivation for writing the book is the fact 
that direct synthesis is underutilized. Another underutilized filter design 
technique is the classic method of bandpass filter design, so a description 
and example are included here [5]. The classic technique is referred to by 
Puglia [6] as the general procedure because it enables the design of 
bandpass filters of almost any type. The classic method was used 
extensively before analytical models for microstrip and other quasi-TEM 
mode transmission lines were available and when the primary engineering 
computational tool was the slide rule.  
The classic technique requires building prototypes of a few select 
resonators and plotting certain measured data. From these plots, the filter 
dimensions are easily synthesized. Modern EM simulation breathes new 
life into this classic technique by eliminating the need to construct 
prototypes. Unusual resonators such as compact planar, MEMS, and 
multilayer structures are increasingly used to solve challenging design 
requirements, but they are poorly modeled by analytical formula. In 
addition, the prototype turnaround time for some of these processes is 
lengthy. The classic technique is particularly well suited for such structures. 
19.4.1 Classic Method Fundamentals 
This article emphasizes the application of EM to the procedure. Puglia [6] 
gives a comprehensive description of the general procedure. For 
completeness, the procedure is briefly reviewed here. 

Electromagnetic Simulation 
303 
Bandpass filters entail only three first principles: 1) resonators must 
exist, 2) the resonators must couple to each other, and 3) the structure 
must couple to the terminations. The classic method is based directly on 
these first principles. The designer selects a form of resonator. Essentially 
the only restrictions are resonator realizability, and some method of 
coupling must exist. Next, data is acquired that relates the degree of 
resonator coupling to a variable parameter. Finally, data is acquired that 
relates termination coupling to a variable parameter. From this data, the 
filter is synthesized using simple analytical expressions. 
Filter tables are usually published in the form of prototype g-values for 
a lowpass filter with 1-radian cutoff frequency and a source impedance of 1 
ohm. Many authors and Puglia provide a simple formula for finding 
Chebyshev prototype values for any passband ripple and order. 
Alternatively, S/Filter may be used to design a target lowpass with these 
terminations, cutoff, and passband ripple, and the resulting element values 
are the prototype g-values. For example, the values for a third-order 
0.0432-dB ripple Chebyshev are go=1, g1=0.8515, g2=1.1031, g3=0.8515, 
and g4=1. 
The normalized source termination is g0, and gN+1 is the normalized 
load termination. For odd order Chebyshev, g0 = gN+1. For even order, gN+1 
increases for increasing passband ripple. There are N reactive values for an 
Nth order prototype. 
The classic method utilizes k and q values rather than lowpass 
prototype g-values. k values relate to resonator couplings and q values 
relate to end resonator loaded Qs. k and q values are easily derived from 
lowpass prototype values. 
)1
(
1
1
1
1
,
−
=
×
=
+
+
N
to
n
for
g
g
k
n
n
n
n
                                     (19.2) 
1
0
1
g
g
q
×
=
                                                                 (19.3) 
odd
N
for
g
g
q
N
N
N
1
+
×
=
                                               (19.4) 
even
N
for
g
g
q
N
N
N
1
+
=
                                                   (19.5) 
For the example 0.0432-dB ripple Chebyshev, q1=q5=0.8515, and 
k12=k23=0.9393. These k and q values are normalized by the filter fractional 
bandwidth, bw , by 
0f
f
f
bw
lower
upper −
=
                                                       (19.6) 
where fupper is the passband upper cutoff frequency, flower is the passband 
lower cutoff frequency and  

304 
Filter Synthesis Using Genesys S/Filter 
2
0
lower
upper
f
f
f
+
=
                                                        (19.7) 
Then the actual filter couplings and loaded Qs are 
1
,
1
,
+
+
×
=
n
n
n
n
k
bw
K
                                                       (19.8) 
bw
q
Q
1
1 =
                                                                 (19.9) 
bw
q
Q
N
N =
                                                             (19.10) 
Capitalized symbols refer to actual couplings and loadings while 
noncapitalized symbols refer to normalized values. 
19.4.2 Example: Determining K Values 
On the left in Fig. 19.11 are two PCB resonators edge-coupled by their 
proximity. This design takes advantage of two signal layers in a multiplayer 
PCB. The top metal layer is depicted in the figure as the darker-gray 
objects. The wider, lighter-gray objects are metal on layer 2, separated from 
the top-metal layer by 15-mil-thick Rogers TMM6 substrate material. The 
objects on the two signal layers are connected by via holes at the top of the 
objects in the figure. The darker-gray objects that connect to ports on the 
wall of the enclosure are 50-ohm lines that loosely couple to the resonators 
by their proximity. 
 
Figure 19.11 Resonator pair for finding the resonator coupling (left) and tapped resonator for 
finding the external coupling (right). 
The resonators are stepped-impedance (stepped-Z) to reduce resonator 
length. Inductance predominates at the grounded end of a quarter-
wavelength, open-circuit transmission-line resonator, where the current is 
highest. At the open end, capacitance predominates where the electric field 
is greatest. By narrowing the line at the grounded end, and increasing the 

Electromagnetic Simulation 
305 
line width at the open end, both the inductance and capacitance are 
increased, thus lowering the resonant frequency. This supports a physically 
shortened resonator [1]. Using two metal layers allows the open-end 
portion of the resonator to be folded under the grounded end, thus halving 
the physical length and further reducing the size. The resulting resonator is 
very compact. 
This structure is used by EM simulation to find the coupling between 
resonators. In this case, the EMPower simulator is used because the 
problem is easily placed on a large grid, and the natural x-y symmetry 
results is fast simulation. The grid is 0.25 mm square. 
Given in Figure 19.12 is the resulting transmission amplitude response 
with a gap between resonators of four grid cells, or 1.o mm. The resonator-
coupling coefficient, K, is given by  
0f
f
f
K
lower
upper −
=
                                                   (19.11) 
where fupper and flower are the frequencies of the system transmission peaks, 
in this case 1802.8 and 1780 MHz, and f0 is the aritmetic mean of those 
frequencies. In this case, K=0.01273. The external coupling during this test 
should be light so as not to disturb the resonant frequencies of the pair. The 
coupling is sufficiently loose if the attenuation between the peaks exceeds 
20 dB. 
Table 19.1 shows the results for EMPower simulations of gap spacings 
0.25 to 1.0 mm. Ideally, the center frequency would be constant, but in this 
case, it increases approximately 2% with increasing gap spacing. Given as 
data points on the dashed trace in Fig. 19.13 are the K values. A line-fit 
through these points is used to find the necessary gap spacing for any 
required K in this range. A feature of the classic method is that K is typically 
a monotonic function of the variable parameter and a smooth curve is 
easily drawn through a small number of data points. 

306 
Filter Synthesis Using Genesys S/Filter 
 
Figure 19.12 Transmission amplitude response of the coupled resonators (left) and 
transmission amplitude response of the tapped resonator (right). 
Table 19.1 EM Simulation Data for Coupling of the Resonators Shown on the Left in Fig. 
19.11 
Gap (mm) 
upper
f
(MHz) 
lower
f
(MHz) 
0f (MHz) 
K  
0.25 
1844.00 
1666.00 
1755.00 
0.1014 
0.50 
1824.50 
1738.00 
1781.25 
0.0486 
0.75 
1811.25 
1766.25 
1788.75 
0.0252 
1.00 
1802.80 
1780.00 
1791.40 
0.0127 
 
 
Figure 19.13 EM-simulated resonator coupling, K, versus gap spacing (dashed line) and 
singly loaded Qext versus tap location (solid line). 

Electromagnetic Simulation 
307 
19.4.3 Example: Determining Q Values 
The next step is determining the termination loading of the filter as 
measured by the external Q. Consider the resonator on the right in Fig. 
19.11. The resonator is identical to the coupled resonators except the input 
and output are coupled to the resonator by tapping the high-impedance 
line. Any form of coupling is used that can be defined by a variable. In this 
case, the variable is the length of the grounded, high-impedance line from 
the center of the via hole to the bottom of the input and output tapping 
lines. The 1-mm-wide lines have a characteristic impedance of 
approximately 50 ohms. To better define the tap point, higher-impedance 
lines are used to tap the resonator. 
The amplitude transmission response of this system with a tap value of 
2.5 mm is given on the right in Fig. 19.12. This test resonator is doubly 
loaded: once by the input and once by the output. In the final filter, the 
resonators at the input and output are singly loaded. Therefore, the 
external-loaded Q of a singly terminated resonator is given by 
lower
upper
ext
f
f
f
Q
−
=
0
2
                                                   (19.12) 
In this case fupper=1944 MHz and flower=1657.5 MHz, so Qext=12.78. 
The classic method involves repeating this data for a few different tap 
values. The results with tap values from 1.0 to 3.0 mm are given in Table 
19.2. The data points on the solid trace in Fig. 19.13 are the EMPower 
simulated Qext for tap values from 1.0 to 3.0 mm. As is the case with K, Qext 
is typically a monotonic function of the variable parameter and a smooth 
curve is easily drawn through a small number of data points. We now have 
a plot of Qext for any tap value in this range. 
Table 19.2 EM Simulation Data for the Tapped Resonator Shown on the Right in Fig. 19.11 
Tap (mm) 
upper
f
(MHz) 
lower
f
(MHz) 
0f (MHz) 
ext
Q
 
1.0 
1837.50 
1783.5 
1813.00 
67.1 
1.5 
1854.25 
1744.5 
1807.25 
32.9 
2.0 
1891.00 
1705.0 
1814.50 
19.5 
2.5 
1944.00 
1657.5 
1829.50 
12.8 
3.0 
2009.00 
1599.0 
1847.00 
9.0 
 
The curves in Fig. 19.13 are sufficient for designing 1800-MHz 
bandpass filters within the data range of any bandwidth, order, and transfer 
approximation for which g-values are available. 
19.4.4 Filter Example Using the Classic Method 
In this section, a 1750- to 1850-MHz, three-resonator bandpass filter is 
designed using the EMPower data from the previous sections. A bandwidth 

308 
Filter Synthesis Using Genesys S/Filter 
of 100 MHz at 1800 MHz is a fractional bandwidth, bw, of 0.556. The 
resulting values are K12=K23=0.0573 and Q1=Q4=15.33. From Fig. 19.13 we 
find a gap spacing value of 0.44 mm and a tap location of 2.26 mm. 
Because the structure is symmetric and easily gridded, the EMPower 
EM simulator is used. To satisfy the required dimensions, the y-direction 
grid remains at 0.25 mm. To satisfy the gap-spacing requirement, the x-
direction grid is changed to 0.15 mm, and the spacing is set to 0.45. This 
requires the vertical narrow line width to be decreased from 0.5 to 0.45 
mm. The frequency shift caused by the narrower lines is compensated by 
adjusting the length of the wide lines. The resulting initial filter layout is 
given in Fig. 19.14 at a 4x scale.  
 
 
Figure 19.14 Initial layout of the 1800-MHz stepped-impedance bandpass filter designed 
using the classic method (4X scale). 
 
The initial responses computed by EMPower are given on the left in 
Fig. 19.15. The center frequency is approximately 5.5% low and the return 
loss is only 5 dB. Given that the center frequencies are different in the 
simulated K and Q values in the previous tables, and that the narrow line 
width is reduced by about 10%, errors in the center frequency and return 
loss are expected. 
Using the techniques described in Section 19.3.3, the dimensions of the 
filter are iterated and EMPower simulations are repeated. To increase the 
frequency, the length of the wide lines is reduced. This intelligence, and a 
lucky guess that the tap point should be reduced, led to rapid progress in 
the iterative process, and after a few steps the responses given on the right 
in Fig. 19.15 are obtained. To correct the return loss and fine-tune the 
frequency, small metal tips are added at the open ends of the wide lines, 
and the length of the center resonator is differentiated from the end 
resonators. The resulting schematic and layout are given in Figures 19.16 
and 19.17, respectively. 
 

Electromagnetic Simulation 
309 
 
Figure 19.15 Initial responses of the 1800-MHz bandpass computed by EMPower (left) and 
after tuning to correct the responses (right). 
 
Figure 19.16 Schematic of the 1800-MHz bandpass after tuning of dimensions. 

310 
Filter Synthesis Using Genesys S/Filter 
 
Figure 19.17 Final layout of the 1800-MHz bandpass after tuning (4X scale). 
Given in Fig. 19.18 is a wider sweep EMPower simulation of the final 
1800-MHz bandpass filter to illustrate the stopband performance. The 
compact size of the filter contributes to excellent stopband performance. 
The notch just above the passband is characteristic of stepped-impedance 
resonators and contributes to excellent selectivity above the passband. 
However, this characteristic complicates the design of wideband filters that 
use stepped-Z resonators. 
 
 
Figure 19.18 EM-simulated stopband performance of the 1800-MHz bandpass. 
References 
[1] R. Rhea, HF Filter Design and Computer Simulation, SciTech Publishing, 
Raleigh, NC, 1994. 

Electromagnetic Simulation 
311 
[2] R. Rhea, Filter Techniques: 3 DVD Set, SciTech Publishing, Raleigh, NC, 2003. 
[3] R. Rhea, Practical Issues in RF Design: 3 DVD Set, SciTech Publishing, Raleigh, 
NC, 2003. 
[4] T. Ishii, ed., Handbook of Microwave Technology, Vol. 1, Components and 
Devices, Academic Press, San Diego, 1995. 
[5] R. Rhea, “EM Enables Classic Filter Technique,” Microwave Journal, February, 
2007. 
[6] K.V. Puglia, “A General Design Procedure for Bandpass Filters Derived from 
Low Pass Prototype Elements,” Microwave Journal, Part I, December 2000, Part 
II, January 2001. 
 


 
 
313 
Appendix A: Example Summary 
This appendix is a listing of the example filters used throughout the 
book to illustrate  solutions to filter design problems. These tables are used 
to quickly find an example based on which filter design problem is being 
illustrated, or to find examples using a specific transform. To segment 
searching in these tables, they are categorized as lumped (including 
resonator based designs), distributed, hybrid using both lumped and 
distributed elements, and multiplexers. Not all occurrences of basic 
transforms such as split element, swap element, remove transformer, and 
simplify circuit are listed. The names of the transforms may be abbreviated. 
A.1 Lumped Examples 
Table A.1 List of Lumped-Element Examples 
Type 
Description 
Illustrates 
Transforms 
Page 
Lowpass 
All-pole and 
generalized 
Finding TZs by inspection None 
1 
Lowpass 
All-pole and 
generalized 
Influence of TZs on 
response  
None 
4 
Lowpass 
All-pole 
Dual extractions 
None 
9 
Lowpass 
All-pole 
Even-order terminations 
None 
10 
Lowpass 
Elliptic and 
generalized 
Custom FTZ placement 
None 
14 
Lowpass 
Generalized 
Symmetric element 
values 
None 
115 
Highpass All-pole 
Even-order terminations 
None 
11 
Bandpass All-pole and 
generalized 
Finding TZs by inspection None 
2 
Bandpass 100-MHz all-pole 
Effects of bandwidth 
None 
18 
Bandpass 100-MHz 
Alternate extractions 
None 
24 
Bandpass 3– to 30-MHz 
generalized 
Selecting extractions 
None 
29 
Bandpass 70-MHz generalized 
Inexact extraction 
None 
34 
Bandpass 70-MHz generalized 
Removing a transformer 
Norton series, 
Simplify circuit 
40 
Bandpass 70-MHz generalized 
Equalizing inductor values Norton shunt 
44 
Bandpass 100-MHz all-pole 
Resonator-based filters 
None 
47 
Bandpass 100-MHz all-pole 
Exact design with parallel 
resonators 
Norton series 
49 
Bandpass 100-MHz all-pole 
Termination coupling 
Termination coupling 
51 
Bandpass 100-MHz all-pole 
Dual topology 
Find dual 
53 
Bandpass 100-MHz all-pole 
Same-type coupling 
elements 
Norton series, 
Simplify circuit 
55 

314 
Filter Synthesis Using Genesys S/Filter 
Bandpass 100-MHz all-pole 
All equal inductors 
Equate all shunt Ls 
56 
Bandpass 100-MHz all-pole 
Improving inductor values Termination coupling 
57 
Bandpass 100-MHz all-pole 
Exact series resonators 
Norton shunt 
58 
Bandpass 100-MHz all-pole 
Reduced inductor values 
Termination coupling 
59 
Bandpass 100-MHz all-pole 
Tubular topology 
Split element, 
Tee to pi 
59 
Bandpass 100-MHz generalized Series resonator with 
FTZs 
Norton shunt 
61 
Bandpass 100-MHz tunable 
Multiband optimization 
None 
63 
Bandpass 900-MHz all-pole 
Coaxial resonators 
Norton series, 
Termination coupling, 
Parallel LC to grounded 
stub, 
Advanced TLine 
70 
Bandpass 975-MHz generalized Complete generalized 
ceramic filter design with 
one FTZ 
Norton series, 
Equate all shunt Ls, 
Termination coupling, 
Pi to tee, 
Par LC to grounded 
stub 
74 
Bandpass 975-MHz generalized Previous with two FTZs 
See previous 
78 
Bandpass 9.6-MHz crystal 
Quick approximate design Norton shunt 
86 
Bandpass 9.6-MHz crystal 
All equal crystals 
None 
88 
Bandpass 9.6-MHz crystal 
Nulling parallel resonance None 
90 
Bandpass 9.6-MHz crystal 
Lower sideband filter 
Termination coupling, 
Find dual, 
Norton shunt, 
Equate all Ls 
91 
Bandpass 9.6-MHz crystal 
Upper sideband filter 
Termination coupling, 
Norton series 
97 
Bandpass 9.6-MHz crystal 
Generalized 
Norton shunt,  
Norton series, 
Split element, 
Swap element, 
103 
Bandpass 9.6-MHz crystal 
Wideband generalized 
See previous 
107 
Bandpass 9.6-MHz crystal 
Very wideband 
generalized 
See previous 
108 
Bandpass 11.6-MHz ceramic 
piezoelectric 
Generalized 
See previous 
111 
Bandpass 455-kHz generalized Symmetric element 
values 
None 
117 
Bandpass 200-MHz all-pole 
Symmetric responses 
None 
119 
Bandpass 70-MHz generalized 
Symmetric responses 
Remove transformer 
120 
Bandpass 70-MHz generalized 
Symmetric by FTZ 
placement 
Remove transformer 
123 
Bandpass Matching network 
Matching by extraction 
sequence 
Remove transformer 
132 
Bandpass Matching network 
Bandwidth expansion to 
minimize element count 
None 
137 
Bandpass Matching network 
Power amplifier match 
None 
140 
Bandpass Matching network 
Broadband antenna 
match 
None 
142 
All-pass 
200-MHz equalizer 
Group-delay equalization None 
124 
 

Example Summary 
315 
A.2 Distributed Examples   
Table A.2 List of Distributed-Element Examples 
Type 
Description 
Illustrates 
Transforms Page 
Lowpass 2.4-GHz all-pole 
Redundant UEs, adding 
a layout 
Kuroda wireline 
169 
Lowpass 2.4-GHz all-pole 
Stubs, contributing UEs Split element 
175 
Lowpass 2.4-GHz all-pole 
Stepped-Z all UEs 
None 
176 
Lowpass 2.4-GHz 
generalized 
Lowpass with FTZ 
Kuroda wireline, 
Finite zero to two-step stub 
179 
Lowpass 2.4-GHz all-pole 
Advantages of 
approximate methods 
Open stub to shunt C, 
Split shunt element, 
Shunt C to open stub, 
Shorted wireline to TLine 
182 
Lowpass 2.4-GHz all-pole 
Advantages of 
approximate methods 
Series L to TLine, 
Shunt C to TLine 
183 
Lowpass 2.4-GHz 
generalized 
Advantages of 
approximate methods 
Series L to TLine, 
Shunt C to TLine 
187 
Lowpass 2.4-GHz all-pole 
Size reduction by 
penetration 
Previous 
190 
Lowpass 2.4-GHz all-pole 
Radial stubs, 
optimization 
Series L to TLine 
192 
Lowpass 2.4-GHz all-pole 
EM simulation 
None 
297 
Bandstop 5-GHz all-pole 
Wide bandstop using 
lowpass synthesis 
Insert element 
199 
Bandstop 5-GHz all-pole 
Effect of microstrip tees None 
201 
Bandstop 5-GHz all-pole 
Reducing high stub 
impedance 
Ikeno lines 
204 
Bandstop 5-GHz generalized Narrow bandstop with 
FTZ 
Kuroda wireline, 
Half angle, 
Ikeno lines 
205 
Bandpass 5-GHz all-pole 
Edge-coupled tutorial 
Split series element, 
Kuroda wireline, 
Interdigital lines 
211 
Bandpass 5-GHz all-pole 
Edge-coupled with 
inverters 
Replace with inverter, 
LC in shunt to half-wave line, 
Kuroda wireline, 
Split element, 
Interdigital lines 
216 
Bandpass 5-GHz all-pole 
Interdigital using 
inverters 
Kuroda wireline, 
Scale source and load by 
inserting inverters, 
Interdigital lines 
218 
Bandpass 1-GHz all-pole 
Combline with capacitor 
coupling 
Equate all shunt Ls, 
Absorb transformer in load, 
Scale source and load, 
End inverter to capacitive L, 
Comblines 
224 

316 
Filter Synthesis Using Genesys S/Filter 
Bandpass 2.5-GHz all-pole 
Miniaturization by short 
line lengths 
Kuroda wireline, 
Combine all transformers, 
Kuroda wireline, 
Comblines, 
Interdigital lines, 
Absorb transformer in load, 
Scale source and load, 
Replace inverter with quarter 
wave line 
228 
Bandpass 2.5-GHz 
generalized 
Narrowband with FTZ 
Absorb transformer in load, 
Scale source and load, 
Kuroda wireline, 
Interdigital lines, 
Half angle, 
Finite zero to two-step, stub 
233 
Bandpass 1-GHz all-pole 
Combline without 
capacitors 
Equate all shunt Cs, 
Comblines, 
Absorb transformer in load, 
Replace inverter with quarter 
wave line 
238 
Bandpass 1-GHz all-pole 
Minnis class-D 
miniature 
Kuroda wireline, 
Kuroda Minnis CD right, 
Comblines, 
Interdigital lines 
245 
Bandpass 1.8-GHz all-pole 
Folded, multilayer  
resonators, EM 
simulation 
None 
307 
Highpass 1-GHz all-pole 
Purely distributed 
highpass 
Kuroda wireline, 
Interdigital lines 
268 
Highpass 1-GHz all-pole 
Increased selectivity 
with additional UEs 
Kuroda wireline, 
Interdigital lines 
270 
 
A.3 Hybrid Examples 
Table A.3 List of Hybrid-Element Examples 
Type 
Description 
Illustrates 
Transforms Page 
Lowpass 
2.4-GHz all-pole 
Advantages of hybrid 
elements 
Series L to TLine 
194 
Bandpass 1-GHz all-pole 
Penetrating combline with 
capacitive coupling 
Open stub to shunt C, 
Shunt C to series C, 
Shunt C to open stub 
248 
Bandpass 1-GHz 
generalized 
Hybrid combline with FTZ Open stub to shunt C, 
Wireline to single C, 
Termination coupling, 
Absorb transformer in load 
249 
Bandpass 1.5-GHz all-pole 
Direct-coupled with 
capacitive loading 
Kuroda wireline, 
Equate all shorted stubs, 
Scale source and load, 
Replace inverter with 
quarter-wave line 
Open stub to shunt C 
252 
Bandpass 1-GHz all-pole 
EM cosimulation 
None 
298 
Bandpass 1.5-GHz all-pole 
EM cosimulation 
None 
300 

Example Summary 
317 
Highpass 1-GHz all-pole 
Distributed synthesis of 
hybrid highpass 
Wireline to single C 
259 
Highpass 1-GHz all-pole 
Lumped synthesis of 
hybrid highpass 
Grounded L to grounded 
stub 
261 
Highpass 1-GHz all-pole 
Increasing selectivity with 
UEs 
Wireline to single C 
263 
Highpass 1-GHz 
generalized 
Hybrid highpass with FTZ Grounded L to grounded 
stub 
266 
Highpass 1-GHz all-pole 
Bandpass used as 
highpass 
Wireline to single C, 
Shorted wireline to TLine, 
Open stub to shunt C 
272 
Highpass 1-GHz all-pole 
Increased selectivity 
See previous 
275 
 
A.4 Multiplexer Examples 
Table A.4 List of Multiplexer Examples 
Type 
Description 
Illustrates Page 
Contiguous 
Lowpass/highpass 
Butterworth complementary filters 
277 
Contiguous 
Lowpass/bandpass/highpass 
Chebyshev approximately 
complementary 
279 
Noncontiguous Lowpass/highpass 
Guard band, optimization 
281 
Noncontiguous Bandpass/bandpass 
Distributed diplexer 
284 


 
 
319 
Constants, Symbols, and Initialisms 
 
Note: Not all variables are listed. Variables defined locally for use only in 
nearby equations are not listed here. 
bw  
fractional bandwidth 
BW  absolute bandwidth 
c   
vacuum speed of light 
8
10
99792458
.2
×
 meters/s 
C   
value of capacitance 
0
C  
value of static capacitance 
m
C  
value of motional capacitance of a piezoelectric resonator 
CPU central processing unit of a digital computer 
DC 
zero hertz 
0
ε   
vacuum permittivity 
12
10
8542
.8
−
×
 farads/meter 
EM 
electromagnetic 
r
ε   
relative permittivity of a material 
ESR  effective series resistance of a capacitor 
FDTD finite difference time domain EM simulation technique 
FEM finite element method EM simulation technique 
lf   
lower cutoff frequency 
0f  
center frequency 
pf  
frequency of the parallel-resonant mode of a resonator 
qf  
frequency of the quarter-wavelength resonance of a TLE 
sf   
frequency of the series-resonant mode of a resonator 
FTZ finite-frequency transmission zero 
uf  
upper cutoff frequency 
g   
value of a lowpass prototype element 
HF 
high-frequency spectrum band 
IF  
intermediate frequency in a radio 
IL  
insertion loss 
IM 
intermodulation distortion product 

320 
Filter Synthesis Using Genesys S/Filter 
mn
k
 normalized coupling coefficient between resonators m and n 
mn
K
 absolute coupling coefficient between resonators m and n 
L   
value of inductance 
A
L  
insertion loss due to signal reflection 
L-C 
comprised of inductors and/or capacitors 
m
L  
value of motional inductance of a piezoelectric resonator 
len  
physical length 
MOL method of lines EM simulation technique 
MOM method of moments EM simulation technique 
0
µ  
vacuum permeability 
6
7
10
256637
.1
)
/(
10
4
−
−
×
=
⋅
⋅
×
m
A
s
V
π
H/m 
r
µ  
relative permeability of a material 
n   
transformer turns ratio (may be referred to as n  or N  in S/Filter 
dialogs) 
N   
Order of a filter, or the quantity of transmission zeros 
ω   
radian frequency, equal to 
f
π
2
 
Ω  
Richards transform variable 
PC 
personal computer 
PCL parallel-coupled transmission line 
π   
pi; 3.14159 
PCB printed-wiring board 
c
Q  
unloaded Q defined by conductor loss 
ext
Q
 external Q 
l
Q  
loaded Q 
N
q
 
normalized loaded Q caused by the load resistance 
N
Q
 absolute loaded Q caused by the load resistance 
1q   
normalized loaded Q caused by the source resistance 
1
Q  
absolute loaded Q caused by the source resistance 
u
Q  
unloaded (component) Q 
R   
value of resistance 
RFIC  radio-frequency integrated circuit 
n
ρ  
reflection coefficient at port n 
RL  
return loss 
m
R  
value of the motional resistance of a piezoelectric resonator 

Constants, Symbols, and Initialisms 
321 
mn
S
 scattering parameter with index m and n 
θ   
angle, or electrical length of a TLE 
TLE transmission line element 
TEM transverse-electric mode of propagation 
TRF, xfmr 
abbreviation for transformer 
UE 
unit element (series transmission line) 
VSWR  voltage standing-wave ratio 
X   
value of reactance 
Y   
value of admittance 
Z   
value of impedance 
0
Z  
characteristic impedance of a transmission line 
e
Z0  even-mode impedance of coupled transmission lines 
o
Z0  odd-mode impedance of coupled transmission lines 
 


 
 
323 
About the Author 
 
Randall W. Rhea was born to Noble (Bill) Rhea and Emma Jane Wright 
in 1947 in Findlay, Illinois. He was licensed as radio amateur WN9FFO in 
1962. He received a BSEE with honors from the University of Illinois, and 
married Marilynn Sue Thomas in 1969. He attended Seattle University and 
they both graduated from Arizona State University (ASU) in 1973. His 
MSEE thesis at ASU was the construction and operation of an earth station 
that received Unified S-Band communications from the Apollo 16 and 17 
Command Modules in lunar orbit.  
He worked at the Boeing Company, Goodyear Aerospace, and Scientific 
Atlanta, where he was conferred principal engineer. His engineering 
experience includes amplifiers, antennas, CATV equipment, earth stations, 
filters, 
modems, 
oscillators, 
radar, 
receivers, 
synthesizers, 
and 
management. In 1985, Marilynn and Randall founded Circuit Busters (later 
Eagleware-Elanix Corporation). He wrote the initial releases of the 
Eagleware circuit simulator and the filter, oscillator, and transmission line 
synthesis programs. In 1994, they founded Noble Publishing. He is the 
author of numerous technical papers on antennas, amplifiers, components, 
filters, matching, modeling, oscillators, simulation, synthesis, and the 
history of the microwave industry. He is the lecturer in numerous CD-ROM 
tutorials published by SciTech Publishing, and the author of the books 
Oscillator Design and Computer Simulation, first and second editions; HF 
Filter Design and Computer Simulation; Discrete Oscillator Design: 
Linear, Nonlinear, Transient and Noise Domains; Cable Television Signal 
Distribution; and Chapter 6 of the Handbook of Microwave Filter 
Technology. 
Eagleware-Elanix 
Corporation 
was 
sold 
to 
Agilent 
Technologies in 2005 and Noble Publishing was sold to SciTech Publishing 
in 2006. He has taught full-day seminars on filter and oscillator design to 
over a thousand engineers at trade shows, the Georgia Institute of 
Technology, and companies worldwide. 
Randall and Marilynn live at Susina, an antebellum plantation home 
near Thomasville, Georgia, where they entertain visits from two adult 
children, six grandchildren, family, and friends. In the summer of 2003, 
Randall toured 48 states by motorcycle. His current amateur radio license 
is N4HI and he has DXCC and first-place CW operating awards. Randall 
also enjoys technical writing, astronomy, and wine making. 
Randall may be reached at oscillatordesign@gmail.com for questions, 
comments, and the reporting of errata. From time to time, an errata sheet 
may be published and supplemental material may be available. 


 
 
325 
Index 
 
Add layout, 173 
Allow inexact, 34 
All-pass, 125 
All-pole, 1 
Antimetry, 17 
Bandpass, 2, 17 
Bandwidth 
absolute, 17 
fractional, 17 
wide or narrow, 19 
Blinchikoff, 119 
Box modes, 166 
Canonic, 4 
Cauer-Chebyshev, 13 
Cavity resonance, 299 
Ceramic piezoelectric, 111 
Chebyshev, 10 
Classic design method, 307 
example design, 317 
finding K by EM simulation, 313 
finding Q by EM simulation, 316 
fundamentals, 312 
k & q values, 312 
Coaxial ceramic loaded 
generalized, 74, 79 
Coaxial resonator 
from parallel L-C, 71 
unloaded Q, 73 
Combline 
capacitive coupled, 224 
diplexer, 284 
EM example, 307 
generalized hybrid, 249 
hybrid penetrating, 253 
penetrating, 243 
transform, 161 
Complementary multiplexers, 286 
Complex conjugate match, 130 
Compound transforms, 46 
Conventional bandpass, 17 
Convert Using Advanced TLine, 73, 168 
Coupled lines, 159 
Coupling coefficient, 152 
Customize 
permutation table, 30 
Degree, 4 
Diplexer. See Multiplexer 
Dipole transform, 94 
Distributed, 147 
combline transform, 164 
compare lumped and distributed, 147 
half-angle transform, 162 
Ikeno transforms, 155 
interdigital transform, 161 
introduction, 147 
Kuroda identities, 152 
Kuroda-Minnis transform, 157 
reentrance, 152 
Richards transform, 151 
TLEs, 151 
Distributed bandpass, 211 
combline capacitive coupled, 226 
combline hybrid, 249 
direct-coupled hybrid, 258 
edge-coupled tutorial, 214 
edge-coupled with inverters, 218 
generalized combline, 252 
generalized narrow, 238 
hybrid, 253 
interdigital tutorial, 221 
miniature with UEs, 228 
Minnis class D, 250 
unique, 229 
Distributed bandstop, 199 
generalized narrow, 206 
moderate bandwidth, 203 
narrow bandwidth, 205 
wide bandwidth, 199 
Distributed highpass, 259 
bandpass synthesis, 272 
distributed synthesis, 259 
generalized hybrid, 269 
high degree, 277 
hybrid, 259 
hybrid 10th degree, 283 
hybrid 8th degree, 279 
hybrid with UEs, 263 
lumped synthesis, 260 
purely distributed, 268 
Distributed lowpass, 169 
approximate, 180 
exact, 169 
generalized, 179 
hybrid, 194 
penetrating, 190 
radial stub, 192 

326 
Filter Synthesis Using Genesys S/Filter 
redundent UEs, 169 
stepped-Z, 176, 295 
stepped-Z approximate, 187 
stubs and contributing UEs, 175 
Dual topology, 9, 24, 53 
Edge-coupled distributed, 147, 211–218 
Electromagnetic simulation, 289 
box modes, 292–295 
combline example, 300 
direct coupled example, 300 
EMPower, 290 
EMPro, 292 
Momentum, 294 
overview, 289 
stepped Z example, 295 
surface modes, 294 
Elliptic, 1, 5 
Equal inductors 
by Norton, 42 
compound transform, 46 
Equalizers, 125 
Extraction 
inexact, 34 
partial, 33 
rules, 33, 34 
sequences, 23 
tab, 23 
Fano, 139 
Fractional bandwidth, 17 
FTZ. See TZ 
lowpass example, 13 
Generalized filters, 1 
Genesys, xiii, 7 
Group delay, 18 
Group delay equalization, 124 
Half-angle transform, 159 
Highpass, 1, 11 
History tab, 45 
Ikeno transforms, 155 
Impedance matching. See Match 
Inexact extraction, 34 
Insertion loss 
bandpass, 69 
lowpass, 69 
vs. bandwidth, 19 
vs. ripple, 8 
Interdigital 
transform, 161 
Interdigital distributed, 218 
Inverters, 164 
scaling impedance, 218 
k & q values, 304, 307 
Kuroda indentities, 152 
Kuroda-Minnis transform, 157 
Layout, 173 
Lowpass, 1 
Lumped/Distributed equivalents, 182 
Match 
antenna example, 142 
complex conjugate, 130 
complex terminations, 139 
exploiting resonators, 138 
exploiting sequences, 132 
Fano's limit, 139 
matchable resistance ratios, 135 
power amp example, 140 
two element networks, 96 
Matching, 129 
Minnis. See Kuroda-Minnis 
Minnis class-D distributed, 245 
Mutliplexers 
combline noncontiguous, 281, 284 
complementary, 279 
contiguous, 277 
generalized noncontiguous, 281 
LP/BP/HP contiguous, 279 
LP/HP contiguous, 281 
Norton transform, 39 
remove transformer, 40 
series, 39 
shunt, 43 
Order, 4 
Parallel coupled lines, 233 
Parametric filters, 18 
Partial extraction, 33 
Penetration 
combline, 238 
lowpass, 190 
Permutations 
goals, 27 
maximum displayed, 24 
quantity, 23 
specify, 25 
Piezoelectric, 83. See Quartz crystal 
Q 
loaded, 70 
unloaded (component), 18 
Q of load, 140 
Quarter-wave frequency, 8 
Quartz crystal, 83 
approximate filter design, 87 
calculating parameters, 86 
dipole, 94 
generalized filters, 104 
lower sideband filter, 92 
model, 83 
nulling static capacitance, 90 
response, 84 
upper sideband filter, 98 
wide bandwidth filter, 108, 109 
Radial parameters, 8 
Radial stub, 192 
Reflection coefficient, 7 
Resonator-based bandpass, 47 

Index 
327 
classic forms, 47 
coaxial, 70 
coaxial ceramic, 74, 79 
exact, 49 
generalized, 61, 79 
like-coupling elements, 55 
quartz crystal, 83 
series-type, 58 
TEM-mode, 69 
tubular, 59 
tunable, 63 
Return loss, 7 
Richards transform, 150 
Ripple, 7 
 
permutations 
customize table, 30 
Scattering parameters, 8 
Sequences, extraction, 23 
Series element first, 9 
Simplify Circuit, 42 
Singly terminated, 278 
Smith chart, 130 
Specification tab, 7 
Surface modes, 294 
Symmetry, 115 
all-pole, 120 
by FTZ placement, 123 
classification, 18 
generalized, 120 
group delay, 20 
group delay equalization, 124 
physical (element), 115 
response, 119 
zigzag, 122 
TEM-mode resonators, 69 
Transform tab, 39 
Transformer 
remove, 40 
turns ratio, 30 
Transforms 
combline, 161 
compound, 46 
dipole, 94 
equate all shunt Ls, 56 
find dual, 53 
half-angle, 159 
Ikeno, 155 
interdigital, 161 
Kuroda, 152 
Kuroda-Minnis, 157 
lumped to distributed, 162 
Parallel L-C to grounded stub, 72 
pi to tee, 77 
Richards, 152 
series Norton, 39 
shunt Norton, 43 
tab, 39 
termination coupling, 51, 54 
Transmission zero. See TZ 
Tubular bandpass, 59 
Tunable bandpass, 63 
TZ 
by inspection, 1 
definition, 1 
finite frequency, 1 
response, 4 
rules, 18, 33 
Unit Element (UE), 149 
VSWR, 8 
Wireline, 149 
Zigzag, 120 
 

