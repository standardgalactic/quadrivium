RADIO WAVE PROP GATION
AND PARABOLIC EQUATION
MODELING
A

IEEE Press
445 Hoes Lane
Piscataway, NJ 08854
IEEE Press Editorial Board
Tariq Samad, Editor in Chief
Giancarlo Fortino
Xiaoou Li
Ray Perez
Dmitry Goldgof
Andreas Molisch
Linda Shafer
Don Heirman
Saeid Nahavandi
Mohammad Shahidehpour
Ekram Hossain
Jeffrey Nanzer
Zidong Wang

RADIO WAVE PROP GATION
AND PARABOLIC EQUATION
MODELING
GÖKHAN APAYDIN
LEVENT SEVGI
A

Copyright © 2017 by The Institute of Electrical and Electronics Engineers, Inc.  All rights reserved.  
Published by John Wiley & Sons, Inc., Hoboken, New Jersey. 
Published simultaneously in Canada. 
No part of this publication may be reproduced, stored in a retrieval system, or transmitted in any form  
or by any means, electronic, mechanical, photocopying, recording, scanning, or otherwise, except as  
permitted under Section 107 or 108 of the 1976 United States Copyright Act, without either the prior  
written permission of the Publisher, or authorization through payment of the appropriate per-copy fee to 
the Copyright Clearance Center, Inc., 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400,  
fax (978) 750-4470, or on the web at www.copyright.com. Requests to the Publisher for permission should 
be addressed to the Permissions Department, John Wiley & Sons, Inc., 111 River Street, Hoboken, NJ  
07030, (201) 748-6011, fax (201) 748-6008, or online at http://www.wiley.com/go/permission. 
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in 
preparing this book, they make no representations or warranties with respect to the accuracy or  
completeness of the contents of this book and specifically disclaim any implied warranties of  
merchantability or fitness for a particular purpose.  No warranty may be created or extended by sales  
representatives or written sales materials.  The advice and strategies contained herein may not be  
suitable for your situation.  You should consult with a professional where appropriate.  Neither the  
publisher nor author shall be liable for any loss of profit or any other commercial damages, including  
but not limited to special, incidental, consequential, or other damages. 
For general information on our other products and services or for technical support, please contact  
our Customer Care Department within the United States at (800) 762-2974, outside the United States at  
(317) 572-3993 or fax (317) 572-4002. 
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may 
not be available in electronic formats. For more information about Wiley products, visit our web site at  
www.wiley.com. 
Library of Congress Cataloging-in-Publication Data is available.  
 
 
 
 
 
ISBN: 978-1-119-43211-1 
Printed in the United States of America.
10 9 8 7 6 5 4 3 2 1

Table of Contents
Preface
ix
Acronyms
xi
Matlab Codes
xiii
Chapter 1
INTRODUCTION
1
1.1
Electromagnetic Problems and Classiﬁcation
1
1.2
Maxwell Equations
3
1.3
Guided Waves and Transverse/Longitudinal Decomposition
4
1.4
Two Dimensional Helmholtz’s Equation
5
1.5
Validation, Veriﬁcation, and Calibration Procedure
6
1.6
Fourier Transform, DFT and FFT
7
Chapter 2
WAVE PROPAGATION OVER FLAT EARTH
15
2.1
Flat Earth and GO Two-Ray Model
15
2.2
Single Knife Edge Problem and Four-Ray Model
16
2.3
Vertical Linear Refractivity Proﬁle and Mode Summation
19
Chapter 3
PARABOLIC EQUATION MODELING
23
3.1
Introduction
23
3.2
Parabolic Wave Equation Form
24
3.3
Dirichlet, Neumann, and Cauchy Boundary Conditions
27
v

vi
TABLE OF CONTENTS
3.4
Antenna/Source Injection
28
3.5
Split-Step Parabolic Equation (SSPE) Model
29
3.5.1
Narrow-Angle and Wide-Angle SSPE
30
3.5.2
A MATLAB-Based Simple SSPE Code
30
3.6
FEM-Based Parabolic Equation Model
32
3.7
Atmospheric Refractivity Effects
40
Chapter 4
WAVE PROPAGATION AT SHORT RANGES
43
4.1
Introduction
43
4.2
Accurate Source Modeling
44
4.3
Wave Propagators in Two Dimensions
47
4.3.1
Flat Earth and Two-Ray Model
47
4.3.2
FEM-Based PE Wave Propagator
49
4.3.3
SSPE-Based PE Wave Propagator
49
4.3.4
Method of Moments Modeling
49
4.4
Knife Edge and Four Ray Model
49
4.5
Canonical Tests and Calibration
50
Chapter 5
PE AND TERRAIN MODELING
53
5.1
Irregular PEC Terrain
53
5.2
PE and Impedance Boundary Modeling
54
5.2.1
Discrete Mixed Fourier Transform (DMFT)
56
5.3
Numerical Results and Comparison
57
Chapter 6
ANALYTICAL EXACT AND APPROXIMATE MODELS
65
6.1
Wave Propagation in a Parallel Plate Waveguide
65
6.2
Green’s Function in Terms of Mode Summation
68
6.3
Mode Summation for a Tilted Gaussian Source
70
6.4
A Hybrid Ray + Image Method
71
6.5
Numerical Models
73
6.5.1
Parabolic Equation Models: SSPE and FEMPE
73
6.5.2
Method of Moments
75
Chapter 7
WAVE PROPAGATION INSIDE THREE-DIMENSIONAL
RECTANGULAR WAVEGUIDE
79
7.1
Introduction
79
7.2
Three-Dimensional Rectangular Waveguide Model
80
7.3
Three-Dimensional Parabolic Equation Models
81
7.3.1
SSPE Model
81
7.3.2
FEMPE Model
82
7.3.3
ADIPE Model
82
7.4
Tests and Calibration
83

TABLE OF CONTENTS
vii
Chapter 8
TWO WAY PE MODELS
89
8.1
Formulation of Two Way FEMPE Method
89
8.2
Formulation of Two Way SSPE Method
91
8.3
Flat Earth with Inﬁnite Wall
91
8.4
Flat Earth with Single and Double Knife Edges
91
8.5
Two Way Propagation Modeling in Waveguides
96
8.6
Three-Dimensional Split-Step- and Finite-Element-Based
Parabolic Equation Models
96
8.7
Tests and Calibration
97
Chapter 9
PETOOL VIRTUAL PROPAGATION PACKAGE
101
9.1
Introduction
101
9.2
PETOOL Software
103
9.3
Characteristic Examples
107
Chapter 10
FEMIX VIRTUAL PROPAGATION PACKAGE
113
10.1
Introduction
113
10.2
Analytical Surface-Wave Model
115
10.2.1
Path Loss
115
10.2.2
Norton’s Model
115
10.2.3
Wait’s Model
116
10.2.4
Millington’s Curve Fitting Approach
117
10.3
Numerical Surface-Wave Model
118
10.4
FEMIX Package
119
10.5
Characteristic Examples
122
References
127
Index
135

PREFACE
Wave propagation in and through complex environments has long been a hot topic.
One needs to understand/model/simulate electromagnetic wave propagation in order
to establish a reliable communication link, to early detect targets in radar systems, to
continuously cover an operational ground and air areas, etc. The same is also true for
underwater acoustic waves. Establishing a communication link between a ship and a
submarine, between two submarines, etc., and early detecting nuclear submarines in
deep as well as shallow waters, etc., is a challenge. These are also critical in optical
wave propagation through ﬁber cables and the atmosphere.
Realistic electromagnetic/acoustic/optical wave propagation models in and through
complex environments have long been investigated and developed. One of the ear-
liest and the most effective models, used in electromagnetic/acoustic/optical wave
propagation, is the parabolic equation method. This book is a continuation of book
Parabolic Equation Methods for Electromagnetic Wave Propagation written by Levy
in 2000 and presents the application of analytical and numerical methods for wave
propagation.
The powerful numerical methods are given with several scenarios
around us while considering the effects of environment on radio wave propagation.
This book is written for electrical, electronics, communication, computer engi-
neers in industry, as well as for university students, researchers, and professors. The
goal is to discuss fundamentals of electromagnetic wave propagation, especially on
radio wave propagation, groundwave propagation, maritime communication, inte-
ix

x
PREFACE
grated maritime surveillance systems, submarine communication, defense industry,
radar applications, etc. The topics listed in the contents are re-visited in terms of
radio wave engineering. The book also introduces some simple MATLAB scripts for
several well-known electromagnetic propagation problems.
The ﬁrst chapter introduces some fundamental concepts of electromagnetic prob-
lems. Maxwell equations, transverse electric and magnetic models in guided wave
representation, Fourier transform, validation, veriﬁcation, and calibration are re-
viewed brieﬂy. The second chapter presents the simplest propagation scenario used
in analytical modeling to investigate wave propagation over ﬂat Earth. The part is
important for validation, veriﬁcation, and calibration. Chapter 3 presents parabolic
equation modeling based on the Fourier split-step and the ﬁnite-element methods.
Simple MATLAB-based propagation tools are introduced. Systematic comparisons
on some canonical test scenarios are performed, and the propagation tools are cal-
ibrated against the mathematically exact solutions. Atmospheric refractivity effects
are also discussed at the end of this part. Accurate source modeling and validation,
veriﬁcation, and calibration of different propagators are discussed in Chapter 4. The
SSPE, FEMPE, and MoM propagators are validated and calibrated at short ranges
against the two-ray model over ﬂat Earth and the single knife edge problem with
the four-ray model. Irregular terrain modeling and impedance boundary modeling
are presented in Chapter 5. Wave propagation inside a simple canonical structure, a
parallel plate waveguide, is investigated in Chapter 6. Analytical solutions in terms
of mode summation as well as image method are discussed and simple MATLAB
scripts are developed. In Chapter 7, the classical rectangular waveguide problem
is chosen for three-dimensional parabolic equation propagation. Propagation inside
this waveguide can be exactly modeled in terms of modal summation and any given
source distribution can be analytically represented as accurately as desired. The al-
gorithms are developed, tested against analytically exact data, and calibrated here.
Chapter 8 improves parabolic equation modeling with backward propagation, con-
sidered as two-way parabolic equation modeling. Simple MATLAB-based propaga-
tion tools which use two-way parabolic equation are developed and tested. Chapter
9 presents a novel software tool (PETOOL), developed in MATLAB with graphi-
cal user interface (GUI), for the analysis and visualization of radio wave propaga-
tion through the homogeneous and inhomogeneous atmosphere, by incorporating
variable terrain effects with the aid of the two-way split-step algorithm employing
wide-angle propagator. The last chapter presents a novel MATLAB software tool
(FEMIX) for the analysis and visualization of surface-wave propagation over the ir-
regular Earth’s surface through a homogeneous and an inhomogeneous atmosphere.
Some of the contents of this book have been published in IEEE publications such
as IEEE Transactions on Antennas and Propagation, and IEEE Antennas and Prop-
agation Magazine for the last couple of years.
This book uses a MATLAB license under the MathWorks Book Program in de-
veloping book materials.
GÖKHAN APAYDIN, LEVENT SEVGI

ACRONYMS
ADIPE
alternate direction implicit parabolic equation
BC
boundary condition
CBC
Cauchy boundary condition
DBC
Dirichlet boundary condition
DCT
discrete cosine transform
DFT
discrete Fourier transform
DMFT
discrete mixed Fourier transform
DST
discrete sine transform
EM
electromagnetic
FDTD
ﬁnite-difference time domain
FEM
ﬁnite-element method
FEMIX
FEM-based PE algorithm with mixed paths
FEMPE
FEM-based parabolic equation
GO
geometric optics
GTD
geometric theory of diffraction
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
xi

xii
ACRONYMS
GUI
graphical user interface
HFA
high-frequency asymptotics
FFT
fast Fourier transform
IM
image method
ITU
International Telecommunication Union
LOS
line of sight
MODSIM
modeling and simulation
MoM
method of moments
NBC
Neumann boundary condition
PDE
partial differential equation
PE
parabolic equation
PEC
perfect electric conductor
PF
propagation factor
PL
path loss
PO
physical optics
PWE
parabolic wave equation
PTD
physical theory of diffraction
RCS
radar cross-section
SSPE
split-step parabolic equation
TE
transverse electric
TEM
transverse electromagnetic
TM
transverse magnetic
TLM
transmission line matrix
UTD
uniform theory of diffraction
VV&C
validation, veriﬁcation, and calibration
1D
one-dimensional
2D
two-dimensional
3D
three-dimensional

MATLAB CODES
Page
Code Name
Purpose
9
dft_sin.m
Computes discrete Fourier transform of two sinusoids
10
fft_sin.m
Computes fast Fourier transform of two sinusoids
12
Fseries.m
Computes Fourier series representation of a given function
14
fft_dst_dct.m
Compares discrete Fourier transform and discrete sine/cosine
transform of a Gaussian ﬁeld proﬁle
16
Ray2.m
Computes ﬁelds over 2D ﬂat ground using two-ray model
16
Ray2PF.m
Computes propagation factor over 2D ﬂat ground
19
Ray4.m
Computes propagation factor over 2D ﬂat ground
using four-ray model
22
Linear.m
Computes ﬁelds using mode summation over 2D ﬂat ground
for linearly decreasing refractivity
34
sspe.m
Computes ﬁelds over 2D ﬂat ground using SSPE model
34
fempe.m
Computes ﬁelds over 2D ﬂat ground using FEMPE model
48
Fearth1.m
Computes ﬁelds over 2D ﬂat Earth using two-ray model
with ray excitation coefﬁcients
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
xiii

xiv
MATLAB CODES
Page
Code Name
Purpose
49
Fearth2.m
Computes ﬁelds over 2D ﬂat Earth using FEMPE model
with ray excitation coefﬁcients
49
Fearth3.m
Computes ﬁelds over 2D ﬂat Earth using SSPE model
with ray excitation coefﬁcients
49
Fearth4.m
Computes ﬁelds over 2D ﬂat Earth using MoM model
with ray excitation coefﬁcients
50
Knife_SSPE4Ray.m
Computes ﬁelds over 2D ﬂat Earth using four-ray model
with ray excitation coefﬁcients
54
FEMPE.m
Computes ﬁelds over irregular terrain using FEMPE model
57
DMFTSSPE.m
Computes ﬁelds over irregular terrain using DMFT-SSPE
model
70
PPlate.m
Computes ﬁelds inside a parallel PEC plate waveguide with
mode summation using a line source
71
PPlate_Tilt.m
Computes ﬁelds inside a parallel PEC plate waveguide with
mode summation using a tilted Gaussian source
72
PPlate_Image.m
Computes ﬁelds inside a parallel PEC plate waveguide with
image method using a line source
73
PPlate_SSPE.m
Computes ﬁelds inside a parallel PEC plate waveguide with
SSPE method
73
PPlate_FEMPE.m
Computes ﬁelds inside a parallel PEC plate waveguide with
FEMPE method
78
PPlate_MoM.m
Computes ﬁelds inside a parallel PEC plate waveguide with
MoM method
78
PPlate_MoM2.m
Computes ﬁelds inside a parallel PEC plate waveguide with
hybrid image-MoM method
81
Rect_Waveguide.m
Computes ﬁelds inside a 3D rectangular waveguide using
modal summation
91
twowaype.m
Computes propagation factor over a PEC ground with a
vertically inﬁnite-extend wall
104
petool.m
Parabolic equation toolbox for radio wave propagation
118
femix.m
FEM-based parabolic equation toolbox with mixed paths

CHAPTER 1
INTRODUCTION
1.1
Electromagnetic Problems and Classiﬁcation
Electromagnetic (EM) problems are classiﬁed in terms of the equations describing
them. The equations could be differential or integral or both. Most EM problems
can be stated in terms of an operator equation
Lϕ = g
(1.1)
where L is an operator (differential, integral, or integro-differential), g is the known
excitation or source, and ϕ is the unknown function to be determined. A typical
example is an electrostatic problem involving Poisson’s equation
−∇2V = ρ
ε
(1.2)
where L = −∇2 is Laplacian operator, g = ρ/ε is source term, and ϕ = V . In
integral form, Poisson’s equation is of the form
V =

ρdv
(1.3)
4πεr2
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
1

2
INTRODUCTION
where L =

dv
4πr2 is Laplacian operator, g = V is source term, and ϕ = ρ/ε.
Electromagnetic problems involve linear, second-order differential equations. In
general, a second-order partial differential equation (PDE) is given by
a∂2ϕ
∂x2 + b ∂2ϕ
∂x∂y + c∂2ϕ
∂y2 + d∂ϕ
∂x + e∂ϕ
∂y + fϕ = g
(1.4)
where the differential operator is
L = a ∂2
∂x2 + b ∂2
∂x∂y + c ∂2
∂y2 + d ∂
∂x + e ∂
∂y + f.
(1.5)
The coefﬁcients, a, b, and c, in general are functions of x and y; they may also
depend on ϕ itself, in which case the PDE is said to be nonlinear. A PDE in which
g(x, y) equals zero is termed homogeneous; it is inhomogeneous if g(x, y) is not
equal to zero.
A PDE, in general, can have both boundary values and initial values. PDEs whose
boundary conditions (BCs) are speciﬁed are called steady-state equations. If only
initial values are speciﬁed, they are called transient equations.
Any linear second-order PDE can be classiﬁed as elliptic, hyperbolic, or parabolic
depending on the coefﬁcients a, b, and c. The terms hyperbolic, parabolic, and ellip-
tic are derived from the fact that the quadratic equation
ax2 + bxy + cy2 + dx + ey + f = 0
(1.6)
represents a hyperbola, parabola, or ellipse if b2 −4ac is positive, zero, or negative,
respectively.
In each of these categories, there are PDEs that model certain physical phenom-
ena. Such phenomena are not limited to electromagnetics but extend to almost all
areas of science and engineering. Thus the mathematical model speciﬁed here arises
in problems involving heat transfer, boundary-layer ﬂow, vibrations, elasticity, elec-
trostatic, wave propagation, and so on.
Elliptic PDEs are associated with steady-state phenomena, that is boundary-value
problems. Typical examples of this type of PDE include Laplace’s equation
∂2ϕ
∂x2 + ∂2ϕ
∂y2 = 0
(1.7)
and Poisson’s equation
∂2ϕ
∂x2 + ∂2ϕ
∂y2 = g(x, y)
(1.8)
where in both cases a = c = 1, b = 0. An elliptic PDE usually models an interior
problem, and hence the solution region is usually closed or bounded.
Hyperbolic PDEs arise in propagation problems. The solution region is usually
open so that a solution advances outward indeﬁnitely from initial conditions while
always satisfying speciﬁed BCs. A typical example of hyperbolic PDE is the wave
equation in one dimension
∂2ϕ
∂x2 = 1
v2
∂2ϕ
∂t2
(1.9)

MAXWELL EQUATIONS
3
where a = v2, b = 0, c = 1. If the time dependence is suppressed, the equation is
merely the steady-state solution.
Parabolic PDEs are generally associated with problems in which the quantity of
interest varies slowly in comparison with the random motions which produce the
variations. The most common parabolic PDE is the diffusion (or heat) equation in
one dimension
∂2ϕ
∂x2 = k ∂ϕ
∂t
(1.10)
where a = 1, b = c = 0.
In hyperbolic and parabolic PDEs, the solution region is usually open. The initial
conditions and BCs typically associated with parabolic equations resemble those for
hyperbolic problems except that only one initial condition at t = 0 is necessary since
the parabolic equation (PE) is only ﬁrst-order in time. Also, parabolic and hyperbolic
equations are solved using similar techniques, whereas elliptic equations are usually
more difﬁcult and require different techniques.
The type of problem represented by Lϕ = g is said to be deterministic, since the
quantity of interest can be determined directly. Another type of problem where the
quantity is found indirectly is called non-deterministic or eigenvalue. The standard
eigenproblem is of the form Lϕ = λϕ. A more general version is the generalized
eigenproblem having the form Lϕ = Mλϕ, where M, like L, is a linear operator for
EM problems. Here, only some particular values of λ called eigenvalues are permis-
sible; associated with these values are the corresponding solutions called eigenfunc-
tions. Eigenproblems are usually encountered in vibration and waveguide problems
where the eigenvalues λ correspond to physical quantities such as resonance and
cutoff frequencies, respectively.
Our problem consists of ﬁnding the unknown function ϕ of a PDE. In addition to
the fact that ϕ satisﬁes Lϕ = g within a prescribed solution region R, ϕ must satisfy
certain conditions on S, the boundary of R. Usually these BCs are
ϕ (r) = 0, r on S, (Dirichlet type)
(1.11)
∂ϕ (r)
∂n
= 0, r on S, (Neumann type).
(1.12)
Here the normal derivative ϕ vanishes on S for Neumann type. Where a boundary
has both, a mixed (Cauchy) boundary condition (CBC) is said to exist
∂ϕ (r)
∂n
+ h (r) ϕ (r) = 0, r on S
(1.13)
where h (r) is known function, ∂ϕ(r)
∂n
= n ∇ϕ (r) is the directional derivative of ϕ
along the outward normal to the boundary S, and n is a unit normal directed out of R.
Note that the Neumann BC is a special case of the mixed condition with h (r) = 0.
1.2
Maxwell Equations
The Maxwell equations are four differential equations which show classical prop-
erties of EM ﬁelds by using electric and magnetic ﬁelds. The equations are sum-

4
INTRODUCTION
marized in Table 1.1. Here, ρv is the electric volume charge density in C/m3, J is
the electric current density vector in A/m2, E and H show the electric and magnetic
ﬁeld intensity vectors in V/m and A/m, respectively, and, D and B show the electric
and magnetic ﬂux density vectors in C/m2 and Wb/m2, respectively. The ﬁrst two
equations are related to the divergence of vectors, and the others are related to the
curl operation of vectors. The relations between these vectors in simple medium are
D = εE, B = μH, J = σE, where ε, μ, and σ denote the permittivity (F/m), the
permeability (H/m), and the electric conductivity (S/m) of the medium.
Table 1.1
The Maxwell equations using differential form.
Name
Differential Form
Name
Differential Form
Gauss’s law
∇· D = ρv
Gauss’s law for magnetism
∇· B = 0
Faraday’s law
∇× E = −∂B
∂t
Maxwell–Ampere’s law
∇× H = J + ∂D
∂t
1.3
Guided Waves and Transverse/Longitudinal Decomposition
Guided wave propagation problems can be solved by using simpliﬁed equations ob-
tained from the longitudinal and transverse decomposition of Maxwell equations that
yield the transverse electric (TE), transverse magnetic (TM), and transverse electro-
magnetic (TEM) representations under different polarizations, such as perpendicu-
lar/parallel polarizations or horizontal/vertical polarizations in applications.
The open form of Maxwell curl operations of electric and magnetic ﬁelds for
rectangular coordinate system can be written as
∂Ez
∂y −∂Ey
∂z

ˆx +
∂Ex
∂z −∂Ez
∂x

ˆy +
∂Ey
∂x −∂Ex
∂y

ˆz
= −μ∂Hx
∂t ˆx −μ∂Hy
∂t ˆy −μ∂Hz
∂t ˆz
(1.14)
∂Hz
∂y −∂Hy
∂z

ˆx +
∂Hx
∂z −∂Hz
∂x

ˆy +
∂Hy
∂x −∂Hx
∂y

ˆz
=

Jx + ε∂Ex
∂t

ˆx +

Jy + ε∂Ey
∂t

ˆy +

Jz + ε∂Ez
∂t

ˆz.
(1.15)
A rectangular waveguide is a classical three-dimensional (3D) guiding structure. If
a rectangular waveguide is located longitudinally along z-axis, TE/TM cases are
deﬁned by assuming no electric/magnetic ﬁeld component in the direction of propa-
gation, therefore the governing equations are given in Table 1.2.
The boundary should also be taken into consideration to determine the polariza-
tion type [1]. First of all, let us deﬁne the plane of incidence as the plane containing
the normal to the boundary surface and the direction of propagation of the wave. For

TWO DIMENSIONAL HELMHOLTZ’S EQUATION
5
Table 1.2
The governing equations for rectangular waveguide along z-axis.
TE Polarization
TM Polarization
∂Ey
∂z
= μ∂Hx
∂t
∂Ey
∂z −∂Ez
∂y
= μ∂Hx
∂t
∂Ex
∂z
= −μ∂Hy
∂t
∂Ez
∂x −∂Ex
∂z
= μ∂Hy
∂t
∂Ex
∂y −∂Ey
∂x = μ∂Hz
∂t
∂Ey
∂x = ∂Ex
∂y
∂Hz
∂y −∂Hy
∂z
= Jx + ε∂Ex
∂t
∂Hy
∂z
= −Jx −ε∂Ex
∂t
∂Hx
∂z
−∂Hz
∂x = Jy + ε∂Ey
∂t
∂Hx
∂z
= Jy + ε∂Ey
∂t
∂Hy
∂x
= ∂Hx
∂y
∂Hy
∂x −∂Hx
∂y
= Jz + ε∂Ez
∂t
Figure 1.1
Perpendicular and parallel polarization on the zx-plane.
example, the plane of incidence is zx-plane in Fig. 1.1. Here, the electric ﬁeld is ei-
ther perpendicular to the plane of incidence for perpendicular polarization or parallel
to the plane of incidence for parallel polarization. The governing equations are given
in Table 1.3.
1.4
Two Dimensional Helmholtz’s Equation
The wave equations for the electric and magnetic ﬁelds can be obtained by using
Maxwell equations.
If the electric and magnetic ﬁelds are to be time harmonic

6
INTRODUCTION
Table 1.3
The governing equations for the plane of incidence on the zx-plane.
TE Polarization
TM Polarization
∂Ey
∂z
= μ∂Hx
∂t
∂Hy
∂x
= Jz + ε∂Ez
∂t
∂Ey
∂x = −μ∂Hz
∂t
∂Hy
∂z
= −Jx −ε∂Ex
∂t
∂Hx
∂z
−∂Hz
∂x = Jy + ε∂Ey
∂t
∂Ex
∂z −∂Ez
∂x = −μ∂Hy
∂t
with the time dependence exp (−iωt), the wave equations in a linear, homogeneous,
isotropic, source-free medium for each component of ﬁelds can be written as
∇2U −με∂2U
∂t2 = 0 (in time-domain)
(1.16)
∇2U + k2U = 0 (in frequency-domain)
(1.17)
where k = ω√με is the wavenumber, ω is the angular frequency, ∇2 is the Laplace
operator, and U shows the components of time harmonic either electric ﬁeld or mag-
netic ﬁeld. This is called homogeneous wave equation or Helmholtz’s equation, that
is the elliptic PDE. Assume an zx-plane as the two-dimensional (2D) environment,
the Helmholtz’s equation can be written as
∂2U
∂z2 + ∂2U
∂x2 + k2U = 0.
(1.18)
1.5
Validation, Veriﬁcation, and Calibration Procedure
Real-life engineering and EM problems can be handled via measurements or numeri-
cal simulations because only a limited number of problems with idealized geometries
have mathematical exact solutions. The challenge in solving real-life engineering
problems is therefore the reliability of the results. Reliability is achieved after a se-
ries of (model) validation, (data) veriﬁcation, and (code) calibration (VV&C) tests
[2].
Three fundamental building blocks of a simulation are the real-world problem
entity being simulated, the conceptual model representation of that entity, and the
computer implementation model. As illustrated in Fig. 1.2, engineers start with the
deﬁnition of the real-life problem at hand. Electromagnetic problems, in general, are
modeled with Maxwell equations and EM theory is well established by these equa-
tions. Maxwell equations are general and represent all linear EM problems. Once
the geometry of the problem at hand (i.e., BCs) is given, they represent a unique

FOURIER TRANSFORM, DFT AND FFT
7
Figure 1.2
Validation, veriﬁcation, and calibration procedure.
solution; the solution found by using Maxwell equations plus BC is the solution
we are looking for. Unfortunately, there are only a few real-life problems which
have mathematical exact solutions, therefore many different and approximate con-
ceptual models can be used. It is the process of conceptual validity which shows that
chosen conceptual model ﬁts into the real-life problem the best under the speciﬁed
initial and/or operational conditions. The next step is to develop a computer code
for the chosen conceptual model. It is only after code veriﬁcation via a computer
programming process applied to show that the developed code represents the chosen
conceptual model under given sets of conditions (accuracy, resolution, uncertainty,
etc.). Finally, the solution for the real-life problem is obtained with conﬁdence af-
ter numerical and/or physical experimentation; nothing but the operational validity
process [3].
For the parabolic wave equation (PWE) chosen in this book, the VV&C procedure
necessitates quantitatively and qualitatively answering these questions: (i) How pre-
cise is the PWE model? (ii) To what extent does the PWE correspond to the real-life
problem? (iii) Under what/which conditions do different numerical methods yield
reliable solutions? (iv) What is the accuracy of the numerical calculations?
1.6
Fourier Transform, DFT and FFT
The Fourier transform has been widely used in circuit analysis and synthesis, from
ﬁlter design to signal processing, image reconstruction, etc. The reader should keep
in mind that the time-domain and frequency-domain relations in electromagnetics are
very similar to the relations between spatial and wavenumber domains. A simplest
propagating (e.g., along z) plane wave is in the form of Φ (r, t) ∝e−i(ωt−kz) (where
k and z are the wavenumber and position, respectively) and exp (−iωt) are also
applicable to exp (ikz). Some characteristics are outlined as

8
INTRODUCTION
A rectangular time (frequency) window corresponds to a beam type (Sinc(·)
function) variation in frequency (time)-domain.
Similarly, a rectangular aperture (array) in spatial-domain corresponds to a
beam type (Sinc(·) function) variation in wavenumber domain.
The wider the antenna aperture the narrower the antenna beam; or, the narrower
the pulse in time-domain the wider the frequency band.
Therefore, Fourier transform has also been used in electromagnetics from an-
tenna analysis to imaging and non-destructive measurements, even in propagation
problems. For example, the split-step parabolic equation (SSPE) method (which
is nothing but the beam propagation method in optics) has been in use for several
decades and is based on sequential Fourier transform operations between the spatial
and wavenumber domains. Two- and three-dimensional propagation problems with
non-ﬂat realistic terrain proﬁles and inhomogeneous atmospheric variations above
have been solved with this method successfully [3–5].
The principle of a transform in engineering is to ﬁnd a different representation of
a signal under investigation. The Fourier transform is the most important transform
that is widely used in electrical engineering. The transformations between the time
and the frequency-domains are based on the Fourier transform and its inverse Fourier
transform. They are deﬁned via
S (f) =
 ∞
−∞
s (t) ei2πftdt, and s (t) =
 ∞
−∞
S (f) e−i2πftdf.
(1.19)
Here, s(t), S(f), and f are the time signal, the frequency signal, and the frequency,
respectively. We, the physicists and engineers, sometimes prefer to write the trans-
form in terms of angular frequency ω = 2πf, as
S (ω) =
 ∞
−∞
s (t) eiωtdt, and s (t) = 1
2π
 ∞
−∞
S (ω) e−iωtdω
(1.20)
which, however, destroys the symmetry. To restore the symmetry of the transforms,
the convention is to divide 1/(2π) term into two and use 1/
√
2π during both Fourier
transform and inverse Fourier transform. The Fourier transform is valid for real or
complex signals, and, in general, is a complex function of ω (or f).
The Fourier transform is valid for both periodic and non-periodic time signals
that satisfy certain conditions. Almost all real-world signals easily satisfy these re-
quirements. It should be noted that the Fourier series is a special case of the Fourier
transform. Mathematically, Fourier transform is deﬁned for continuous time sig-
nals and in order to go to the frequency-domain, the time signal must be observed
from an inﬁnite-extend time window. Under these conditions, the Fourier transform
deﬁned above yields frequency behavior of a time signal at every frequency, with
zero frequency resolution. Some functions and their Fourier transform are listed in
Table 1.4. To compute the Fourier transform numerically on a computer, discretiza-
tion plus numerical integration are required. This is an approximation of the true

FOURIER TRANSFORM, DFT AND FFT
9
Table 1.4
Some functions and their Fourier transforms.
Time Domain
Fourier Domain
Rectangular window
Sinc function
Sinc function
Rectangular window
Constant function
Dirac delta function
Dirac delta function
Constant function
Dirac comb (Dirac train)
Dirac comb (Dirac train)
Cosine function
Two real-even delta function
Sine function
Two imaginary-odd delta functions
Exponential function {exp (−iωt)}
One positive-real delta functions
Gaussian function
Gaussian function
(i.e., mathematical), analytically deﬁned Fourier transform in a synthetic (digital)
environment, and is called the discrete Fourier transform (DFT). There are three dif-
ﬁculties with the numerical computation of the Fourier transform.
Discretization (introduces periodicity in both time and frequency-domains),
Numerical integration (introduces approximation and numerical round off and
truncation errors),
Finite time duration (introduces maximum frequency and resolution limita-
tions).
The DFT of a continuous time signal sampled over a record period of T, with a
sampling rate of Δt can be given as
S (mΔf) = T
N
N−1

n=0
s (nΔt) ei2πmΔfnΔt
(1.21)
where Δf = 1/T, and, is valid at frequencies up to fmax = 1/(2Δt). A simple
MATLAB dft_sin.m ﬁle computes (1.21) for a time record s(t) of two sinusoids
whose frequencies are user speciﬁed. The record length and sampling time interval
are also supplied by the user and DFT of this record is calculated inside a simple
integration loop.
Let us plot two sinusoids with 10 Hz/1 V and 50 Hz/0.25 V both in time and
frequency-domains. Choose fmax = 200 Hz, Δf = 2 Hz, T = 0.5 s, and Δt =
2.5 ms. Note that these parameters may be chosen arbitrarily in DFT but frequency
resolution and maximum frequency will be Δf = 1/T and fmax = 1/(2Δt), re-
spectively. Results are shown in Fig. 1.3.
The DFT requires an excessive amount of computation time, particularly when
the number of samples N is high. The fast Fourier transform (FFT) is an algorithm
to speed up DFT computations. The FFT forces one further assumption that N is an

10
INTRODUCTION
0
50
100
150
200
0
0.05
0.1
0.15
0.2
0.25
0.3
The DFT of the sum of two sinusoids
Frequency [Hz]
Amplitude [V]
-200
-100
0
100
200
0
0.05
0.1
0.15
0.2
0.25
0.3
The FFT of the sum of two sinusoids
Frequency [Hz]
Amplitude [V]
0
0.1
0.2
0.3
0.4
-1.5
-1
-0.5
0
0.5
1
1.5
The sum of two sinusoids
Time [s]
Amplitude [V]
Figure 1.3
(Top) Time variations of two sinusoids, (bottom) frequency variations of two
sinusoids obtained with (left) DFT and (right) FFT.
integer multiple of 2. This allows certain symmetries to occur reducing the number
of calculations.
To write an FFT routine is not as simple as DFT routine, but there are many
internet addresses where one can supply FFT subroutines (including source codes)
in different programming languages, from Fortran to C++. Therefore, the reader does
not need to go into details, rather include them in their codes by simply using include
statements or call commands. In MATLAB, the calling command is fft(s,N) for the
FFT and ifft(S,N) for the inverse FFT, where s and S are the recorded N-element
time array and its Fourier transform, respectively. In order to do that one needs to
replace the loop for DFT with a line code Sf = fftshift(fft(st)*dt), that is included
in fft_sin.m ﬁle. Note that one needs to scale the results in the frequency-domain
(i.e., multiply the result by Δt) since MATLAB fft(s,N) command assumes Δt = 1;
also, swap the ﬁrst N/2 samples with the second half using the fftshift(s) command).
Figure 1.3 also shows the FFT of the same signal.
As stated above, performing Fourier transform in a discrete environment intro-
duces artiﬁcial effects. These are called aliasing effects, spectral leakage, and scal-
loping loss [3]. It should be kept in mind when dealing with DFT that

FOURIER TRANSFORM, DFT AND FFT
11
Multiplication in the time-domain corresponds to a convolution in the frequency-
domain.
The Fourier transform of an impulse train in the time-domain is also an impulse
train in the frequency-domain with the frequency samples separated by T0 =
1/f0.
The narrower the distance between impulses (T0) in the time-domain the wider
the distance between impulses (f0) in the frequency-domain (and vice versa).
The sampling rate must be greater than twice the highest frequency of the time
record, that is Δt ≥1/(2fmax) (Nyquist sampling criterion).
Since time–bandwidth product is constant, narrow transients in the time-domain
possess wide bandwidths in the frequency-domain.
In the limit, the frequency spectrum of an impulse is constant and covers the
whole frequency-domain (that is why an impulse response of a system is enough
to ﬁnd out the response of any arbitrary input).
If the sampling rate in the time-domain is lower than the Nyquist rate, aliasing
occurs [3]. Two signals are said to alias if the difference of their frequencies falls in
the frequency range of interest, which is always generated in the process of sampling
(aliasing is not always bad; it is called mixing or heterodyning in analog electronics
and is commonly used in tuning radios and TV channels). It should be noted that
although obeying Nyquist sampling criterion is sufﬁcient to avoid aliasing, it does
not give a high quality display in time-domain record. If a time signal sinusoid is
not bin-centered in the frequency-domain then spectral leakage occurs. In addition,
there is a reduction in coherent gain if the frequency of the sinusoid differs in value
from the frequency samples, which is termed scalloping loss.
Fourier transform is used for energy signal which contains ﬁnite energy. This
means
 ∞
−∞|s(t)|2 dt is ﬁnite. Periodic functions do not satisfy this property. Power
signals have ﬁnite power in one period (i.e., 1
P
 P/2
−P/2 |s(t)|2 dt is ﬁnite where P is
the period of the signal). Power signals are represented in terms of Fourier series. A
function f(x) is periodic, with period P, if
f (x) =
∞

n=1
f (x + nP) .
(1.22)
A periodic function f(x) can be approximated by using Fourier series expansion as
f (x) ≈A0
2 +
∞

n=1
An cos
2πnx
P

+ Bn sin
2πnx
P

(1.23)
where
A0 = 2
P
 P/2
−P/2
f (x) dx
(1.24)

12
INTRODUCTION
An = 2
P
 P/2
−P/2
f (x) cos
2πnx
P

dx
(1.25)
Bn = 2
P
 P/2
−P/2
f (x) sin
2πnx
P

dx.
(1.26)
Non-periodic functions may also be approximated by Fourier series inside a ﬁnite
region by assuming the ﬁnite region as the period of that function. In this case, it
should be remembered that the Fourier series representation no longer represents the
function outside the region. Equations (1.24)–(1.26) show that, one needs to multiply
the function with sine and cosine functions along the whole period and then integrate
in order to ﬁnd out Fourier coefﬁcients An and Bn.
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
Time [s]
f(t)
 n: 5,  An: 1.301e-19,  Bn: 0.032835
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
Time [s]
f(t)
 n: 10,  An: -0.018162,  Bn: 2.5153e-18
 
 
Function
FSeries
0
2
4
6
8
10
0
0.1
0.2
0.3
0.4
Time [s]
f(t)
 n: 30,  An: -3.2803e-05,  Bn: -2.5674e-17
Figure 1.4
Gaussian function and its Fourier series approximation with 5, 10, 30 terms.
Fseries.m lists a simple MATLAB code for the Fourier series representation of
a given function. A few examples plotted with this MATLAB code are given in
Fig. 1.4.
The Gaussian function used in this example is
f (t) = exp

−12.5(t −2.5)2
√
2π
(1.27)

FOURIER TRANSFORM, DFT AND FFT
13
0
2
4
6
8
10
0
0.5
1
1.5
Time [s]
f(t)
 n: 200,  An: 0,  Bn: 5.1945e-16
0
2
4
6
8
10
0
0.5
1
1.5
Time [s]
f(t)
 n: 30,  An: -2.9516e-16,  Bn: 1.3412e-16
 
 
Function
FSeries
0
2
4
6
8
10
0
0.5
1
1.5
Time [s]
f(t)
 n: 5,  An: 1.0998e-16,  Bn: 3.133e-17
Figure 1.5
Rectangular pulse and its Fourier series approximation with 5, 30, 200 terms.
and the interval (i.e., the period) is 0 ≤t ≤10. First, only the ﬁrst ﬁve terms
are used and the result is plotted in Fig. 1.4. The solid and dashed lines in the
ﬁgures correspond to the function and its Fourier series approximation, respectively.
Second ﬁgure corresponds to the same scenario but with the ﬁrst ten terms in the
series summation. Finally, the last ﬁgure belongs to the same comparisons with the
ﬁrst thirty terms. The agreement in curves in Fig. 1.4 shows that, thirty terms are
adequate for this function in this interval (period).
As shown above, any piecewise continuous function may be approximated by a
series summation of sine and cosine functions. The number of terms required in
the Fourier series representation depends on the smoothness of the function and the
speciﬁed accuracy. The degree of smoothness of the function determines the number
of terms in its Fourier representation. In addition, only sine or cosine terms contribute
the function if it is odd or even symmetric. Understanding digital communication
concepts, the frequency content of the rectangular pulse should be well analyzed. A
symmetric rectangular pulse is deﬁned as
Rect
 t
T

=
	
1
−T
2 ≤t ≤T
2
0
t >


 T
2


(1.28)

14
INTRODUCTION
0
50
100
150
200
0
0.005
0.01
0.015
0.02
0.025
0.03
x [m]
f(x)
 
 
DFT
DCT
0
50
100
150
200
0
0.005
0.01
0.015
0.02
0.025
0.03
x [m]
f(x)
 
 
DFT
DST
Figure 1.6
Comparison of DFT and DST/DCT analysis for the given Gaussian antenna
proﬁle: (left) DBC, (right) NBC.
and an inﬁnite number of terms is required to fully represent this function with the
Fourier series summation. The terms are called harmonics. It is interesting to visual-
ize term by term contributions in the Fourier series representation. This is illustrated
in Fig. 1.5 for a 4 s.-rectangular pulse between 3 s. and 7 s.
Fourier transform and Fourier series expansion are important procedures in en-
gineering [6]. The DFT and FFT are discrete tools to analyze time-domain signals.
One needs to know the problems caused because of the discretization and specify the
parameters accordingly to avoid non-physical and non-mathematical results. More-
over, extra attention should be paid when using built-in commands in different com-
puter languages (e.g., MATLAB). As pointed out above in the text, one needs to
multiply the results of the FFT taken using MATLAB’s fft(s,N) command with Δt in
order to obtain correct amplitude values.
Since the DFT cannot handle the BCs automatically in propagation problems, the
discrete sine transform (DST) and discrete cosine transform (DCT) can be used for
various BCs on Earth. Using DFT, to satisfy the BC over perfect electric conductor
(PEC) ground, the boundary is extended from [0, hmax] to [-hmax, hmax], and then,
in accordance with the image theory, the odd and even symmetric ﬁeld proﬁles are
constructed for Dirichlet boundary condition (DBC) and Neumann boundary condi-
tion (NBC), respectively, to be able to apply the DFT. Another option, to avoid the
height extension, is to reduce DFT to one-sided DST or DCT, for DBC and NBC,
respectively. A MATLAB code fft_dst_dct.m compares DFT and DST/DCT of a
Gaussian ﬁeld proﬁle. A 30 m height antenna with 0.1◦beamwidth at 3 GHz is used
in Fig. 1.6.
In addition, MATLAB functions for Fourier transforms are given below. Note that
the initial and end values of s are zero for DST.
DFT of ﬁeld
fftshift(fft(ifftshift(s)))
Inverse DFT of ﬁeld
fftshift(ifft(ifftshift(S)))
DST of ﬁeld
dst(s(2:end-1))
Inverse DST of ﬁeld
[0;idst(S);0]
DCT of ﬁeld
dct(s)
Inverse DCT of ﬁeld
idct(S)

CHAPTER 2
WAVE PROPAGATION OVER FLAT
EARTH
2.1
Flat Earth and GO Two-Ray Model
The simplest propagation scenario used in analytical modeling is the ﬂat Earth with
PEC surface under line-source excitation. Figure 2.1 shows the propagation envi-
ronment over PEC ﬂat Earth. The total ﬁeld at the observer is obtained via vector
addition of direct ray and ground-reﬂected ray. This model is called geometric op-
tics (GO) two-ray (2Ray) model [7]. Rays in two dimensions are attenuated by the
square root of the distance as they propagate away from the source, therefore the
total ﬁeld is
u (zo, xo) = H(1)
0
(kd1) + ΓH(1)
0
(kd2)
(2.1)
where z and x are the longitudinal and vertical coordinates, respectively; H(1)
0
is the
ﬁrst-kind Hankel function with order zero, k is the wavenumber, Γ is the reﬂection
coefﬁcient, d1 is the distance between the source at (zs, xs) and the observer at
(zo, xo) (direct ray), d2 is the distance between image source at (zs, −xs) and the
observer (ground-reﬂected ray), with
d1 =

d2 + (xs −xo)2, d2 =

d2 + (xs + xo)2
(2.2)
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
15

16
WAVE PROPAGATION OVER FLAT EARTH
Figure 2.1
Construction of two rays from the source to the observer.
and d is the longitudinal distance between the source and the observer.
The reﬂection coefﬁcient becomes Γ = −1 and Γ = 1 for the horizontal and
vertical polarizations, respectively, assuming PEC surface. u(z, x) represents the
electric and magnetic ﬁelds for the horizontal and vertical polarizations, respectively.
Here the electric/magnetic ﬁeld has only one nonzero component Ey/Hy for horizon-
tal/vertical polarization, respectively. The radiation condition applies along x →∞,
z →±∞and both the DBC and NBC are taken into consideration at the PEC surface
for horizontal and vertical polarizations, respectively.
If the observer is far away from the source, the exponential functions may also be
used instead of Hankel functions as
H(1)
0 (kd) ∼=

−2i
π
eikd
√
kd
.
(2.3)
Ray2.m is a short MATLAB code for 2Ray model. First, ﬁelds versus range/height
variations are mapped in color plots. Figure 2.2 shows 3D color maps for horizontal
and vertical polarizations, respectively. In this example, the frequency is 30 MHz.
The source is located 200 m above the ground. The longitudinal and transverse mesh
sizes are Δz = 100 m and Δx = 1 m, respectively.
Then, horizontal propagation factor (PF) at 100 m height and vertical PF at 300 m
and 600 m ranges are computed using Ray2PF.m in Fig. 2.2. The frequency is
30 MHz as above, but the source is located 150 m above the ground with vertical po-
larization. The longitudinal and transverse mesh sizes of this example are Δz = 1 m
and Δx = 0.1 m, respectively.
2.2
Single Knife Edge Problem and Four-Ray Model
On the single knife edge problem, the ray summation approach is based on the con-
struction of four different rays, related reﬂection, and diffraction coefﬁcients using
Fresnel integrals [8]. The single knife edge problem, the four-ray (4Ray) model,

SINGLE KNIFE EDGE PROBLEM AND FOUR-RAY MODEL
17
-30 -20 -10
0
10
0
50
100
150
Height [m]
PF [dB]
at z = 600 m
(a) 
(b) 
0
200
400
600
-30
-20
-10
0
10
Range [m]
PF [dB]
Propagation Factor over PEC flat Earth
DBC 
NBC 
-30 -20 -10
0
10
0
50
100
150
Height [m]
PF [dB]
at z = 300 m
Figure 2.2
(Top) Fields vs. range/height under line-source excitation over PEC ﬂat Earth:
(a) horizontal polarization, DBC, (b) vertical polarization, NBC. (Bottom) PF (left) at 100 m
height, (right) at 300 m and 600 m ranges.
and Fresnel integral representations can be used as an alternative model from which
reliable reference data can be generated. The scenario of this canonical problem
is pictured in Fig. 2.3. Here, ht, hr, and hw are the heights of the transmitter, re-
ceiver, and the knife edge obstacle; d1 and d2 are the distances from the source to
the obstacle and from the obstacle to the receiver, respectively.
Possible four rays are as follows: Ray 1 is the direct path between the transmitter
and the receiver. Ray 2 is considered as the ray from the transmitter reﬂected from
the right side of the knife edge obstacle. This ray reaches the receiver directly or tip
diffraction may occur. Ray 3 is considered as the ray from the transmitter reﬂected
from the left side of the knife edge obstacle. Same as before, this ray also reaches
the receiver directly or tip diffraction will occur. Ray 4 is considered as the ray from
the transmitter reﬂected from both the left side and the right side of the knife edge
obstacle.
The parameters of the Fresnel integrals are derived by using the image source and
receiver for the reﬂected waves. The Fresnel clearance, the height of the knife edge
above the line of sight (LOS) may be positive or negative [8]. When the direct ray

18
WAVE PROPAGATION OVER FLAT EARTH
Ray 1 
Ray 2 
Ray 3 
Ray 4 
h0<0 
ht 
hr 
ht 
-ht 
hr 
-hr 
d1
d2 
hw 
h0<0 
hrn=ht-hr 
D
htn=0 
hwn=ht+hr 
Figure 2.3
Geometry of ﬂat Earth for single knife edge: (left) possible four rays, (right)
construction of Ray 4 from source/receiver images.
between the transmitter and receiver intersects obstacle, h0 is taken as negative. The
Fresnel integrals C(v) and S(v) are evaluated, where v = h0
√
2 with h0 equal to
the ray clearance over the knife edge. The propagation factor (PF) is equal to
PF = E
E0
=
4

q=1
Eq exp(iψq)
(2.4)
where Eq = A(vq)Γq, Γ1 = 1, Γ2 = ΓR, Γ3 = ΓL, Γ4 = ΓLΓR, and ψq =
βq + (Rq −R1)k. Here,
A(vq) =

(C(vq) + 0.5)2 + (S(vq) + 0.5)2
2
(2.5)
for C(vq) =
 v
0 cos(v2
q)dv, S(vq) =
 v
0 sin(v2
q)dv; the distances of four rays are
Rq =
	
d2 + (ht −hr)2
for q = 1, q = 3

d2 + (ht + hr)2
for q = 2, q = 4
(2.6)
βq =
⎧
⎨
⎩
arctan

S(vq)+0.5
C(vq)+0.5

−π
4
if C(vq) ≥−0.5
arctan

S(vq)+0.5
C(vq)+0.5

+ 3π
4
if C(vq) < −0.5
(2.7)
and the complex reﬂection coefﬁcients, for the horizontal and vertical polarizations,
respectively, are
Γh = sin θ −
√
ε −cos2 θ
sin θ +
√
ε −cos2 θ
, Γv = ε sin θ −
√
ε −cos2 θ
ε sin θ +
√
ε −cos2 θ
(2.8)
where ε = εr + i60σgλ, σg is the conductivity of ground, and εr is the relative
permittivity of ground, θ is the angle of incidence. The ray clearances for the four

VERTICAL LINEAR REFRACTIVITY PROFILE AND MODE SUMMATION
19
rays are
h01 =

2d
λd1d2

−ht + (hr −ht)d1
d
−hw

(2.9)
h02 =

2d
λd1d2

−ht + (hr + ht)d1
d
−hw

(2.10)
h03 =

2d
λd1d2

ht + (−hr −ht)d1
d
−hw

(2.11)
h04 =

2d
λd1d2

−ht + (ht −hr)d1
d
−hw

.
(2.12)
Using MATLAB code Ray4.m, Fig. 2.4 shows 3D color maps for horizontal and
vertical polarizations, respectively. The scenario belongs to one-way propagation
over PEC ground with 75 m height-wall at 15 km range. The line source is at 15 m
height at z = 0. The frequency is 3 GHz. The longitudinal and transverse mesh
sizes are Δz = 100 m and Δx = 0.1 m, respectively. The PFs versus height in
front of and beyond the obstacle are also plotted in Fig. 2.4. Here, two vertical ﬁeld
proﬁles are obtained with the 4Ray model. The ﬁrst plot on the left belongs to the
interference region (before the obstacle); the other one is in the diffraction region
(beyond the obstacle).
-30 -20 -10
0
10
0
50
100
150
Height [m]
PF [dB]
at z = 20 km
(a) 
(b) 
-30 -20 -10
0
10
0
50
100
150
Height [m]
PF [dB]
at z = 10 km
Figure 2.4
(Left) PF vs. range/height using 4Ray model over PEC ﬂat Earth with single knife
edge: (a) horizontal polarization, DBC, (b) vertical polarization, NBC. (Right) PF vs. height
at 10 km and 20 km ranges, horizontal polarization (f = 3 GHz, source height is 15 m,
Δz = 100 m, Δx = 0.1 m, obstacle is 75 m height-wall at 15 km range).
2.3
Vertical Linear Refractivity Proﬁle and Mode Summation
Propagation with a linearly decreasing vertical refractivity proﬁle is
n2(x) = 1 −a0x
(2.13)

20
WAVE PROPAGATION OVER FLAT EARTH
where a0 > 0 is a refractivity parameter that controls the strength of the duct and the
PEC ﬂat Earth is a canonical structure to generate the reference solutions [7]. The
2D propagation scenario is completed by choosing the appropriate transverse and
longitudinal BC. This problem has analytical exact solutions in terms of Airy func-
tions for the range independent vertical refractive index. The modal series solution
can be expressed as
u(z, x) =
∞

q=1
cqψq(x)eiβqz
(2.14)
where cq are the modal excitation coefﬁcients, βq is the longitudinal propagation
constant for the related mode represented by index q. The new function ψq(x) satis-
ﬁes the one-dimensional (1D) wave equation in the transverse-domain
 d2
dx2 + k2
0n2(x) −β2
q

ψq(x) = 0.
(2.15)
Using k2
0n2(x) −β2
q = K1x + K2 and ρ = −K−2/3
1
(K1x + K2), the new variables
are obtained for a linearly decreasing vertical refractivity in (2.13) as K1 = −a0k2
0,
K2 = k2
0 −β2
q, ρ = (a0k2
0)1/3x −(a0k2
0)−2/3(k2
0 −β2
q); and the wave equation
becomes the Airy equation [8]
 d2
dρ2 −ρ

ψq(ρ) = 0.
(2.16)
Then, the exact modal solution of Airy equation in (2.16) can be written as [7]
u(z, x) =
N

q=1
cqAi

(a0k2
0)1/3x −σq

eiβqz
(2.17)
where Ai is the ﬁrst-kind of Airy function and the longitudinal propagation constant
for the related mode represented by index q is
βq = ±

k2
0 −(a0k2
0)2/3σq.
(2.18)
The BC at the surface is satisﬁed with Ai(−σq) = 0, Ai′(−σq) = 0 for the DBC
and NBC, respectively. Here, the prime denotes the derivative with respect to the
vertical coordinate. The problem is then reduced to ﬁnding the modal excitation
coefﬁcients from a given antenna pattern using orthonormality property from a given
source function as
cq =
 Xmax
0
g(x)Ai

(a0k2
0)1/3x −σq

dx
(2.19)
where
g(x) =
1
√
2πσ2 exp
(x −xs)2
2σ2

.
(2.20)

VERTICAL LINEAR REFRACTIVITY PROFILE AND MODE SUMMATION
21
Here, σ is the spatial width and xs is the height of the Gaussian source g(x). The
Gaussian source pattern is often used in applications since it represents various an-
tenna types (but any other source proﬁle may also be used). The Gaussian antenna
pattern can also be deﬁned in the vertical wavenumber domain as
g(kx) = exp

−k2
x ln 2
2k2
0 sin2(θbw/2)

.
(2.21)
The tilt (or elevation) angle (θelv) is introduced by shifting the antenna pattern, that is
g(kx) →g(kx−k0 sin θelv). The vertical ﬁeld in the spatial-domain is then obtained
by taking the inverse Fourier transform of (2.21).
The fundamental issue here is the construction of the reference data. An antenna
radiation pattern may be used for transmitter modeling which is mathematically
achieved by locating a vertical Gaussian pattern, g(x) = u(zs, x), on a speciﬁed
height. Then, the modal summation in (2.17) is used together with the orthonormal-
ity condition (2.19) and the number of modes and their excitation coefﬁcients are
derived numerically for a given error boundary.
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 30
-1
0
1
0
250
500
750
Height [m]
Imag(Field)
N = 30
-1
0
1
0
250
500
750
Height [m]
Real(Field)
N = 30
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 20
-1
0
1
0
250
500
750
Height [m]
Imag(Field)
N = 20
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 10
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 9
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 7
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 5
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 3
-1
0
1
0
250
500
750
Height [m]
|Field|
N = 1
-1
0
1
0
250
500
750
Height [m]
Real(Field)
N = 20
Figure 2.5
Contribution of modes to a given (top) untilted and (bottom) tilted 1◦
upward Gaussian antenna patterns under linearly decreasing refractivity proﬁle (horizontal
polarization, f = 300 MHz, xs = 250 m, θbw = 0.35◦, a0 = 1.2 × 10−6).

22
WAVE PROPAGATION OVER FLAT EARTH
(a) 
(b) 
Figure 2.6
Three-dimensional color plots of electric ﬁelds vs. range–height variations for
a given Gaussian antenna pattern (a) untilted, (b) tilted 1◦upward using mode summation
(horizontal polarization, f = 300 MHz, θbw = 0.5◦, a0 = 1.2 × 10−6, Nx = 256,
Nz = 1000).
Finally, vertical boundaries of the numerical integration during modal excitation
coefﬁcient extraction from the orthonormality property increase as the mode number
increases. The speciﬁcation of the number of numerical integration steps for the cal-
culation of modal excitation coefﬁcients is crucial. The code must adopt the number
of integration steps automatically as the mode index increases.
A novel MATLAB code Linear.m is developed for the calculation of mode sum-
mation over with a linearly decreasing vertical refractivity proﬁle.
Figure 2.5 shows the contribution of modes for untilted and tilted Gaussian an-
tenna patterns, respectively. Note that modal excitation coefﬁcients are real if the
antenna pattern has no vertical tilt (i.e., the antenna pattern is horizontal, parallel to
the ﬂat Earth). These modal excitation coefﬁcients become complex when upslope or
downslope tilt is introduced. Moreover, the modes are conﬁned between the Earth’s
surface and modal caustics which depend on the mode number; the higher the mode,
the higher the location of the caustic. Therefore, the number of modes used in the
superposition directly depends on the antenna height.
In Fig. 2.6, the 2D propagation space and propagation over the non-penetrable ﬂat
Earth is simulated with and without antenna tilt. The antenna has a sectoral vertical
radiation beam. The vertical, linearly decreasing refractivity proﬁle causes a surface
duct as observed in the ﬁgure. Although the beam is directed horizontally (Fig. 2.6a)
and upward (Fig. 2.6b), EM waves are pushed down as they propagate longitudinally,
hit the ground, and reﬂect upward. The ground-reﬂected waves and the interference
(between the incident and the ground-reﬂected waves) are clearly observed in this
ﬁgure.

CHAPTER 3
PARABOLIC EQUATION MODELING
3.1
Introduction
Radio engineers or site surveyors dream to have numerical propagation tools that cal-
culate the groundwave path loss (PL) between any two points marked on their digital
maps. This necessitates the solution of the EM wave equation in three dimensions
in a manner that takes into account various EM effects, such as, the irregular terrain
proﬁle, the vegetation, the Earth’s curvature, the atmospheric refractivity, the pres-
ence of buildings, cars, and other obstacles. Also, the solution must include all the
relevant scattering components (e.g., multiple reﬂections and refractions, edge/tip
diffractions, surface and/or leaky waves) that account for the PL [3, 4, 9]. Unfortu-
nately, this has been not yet in sight.
The current numerical strategy is to take the 2D projections between the trans-
mitter and the receiver and reduce the 3D problem in hand into 2D range–height
scenarios. Highly attractive 2D propagation prediction virtual tools have been de-
veloped for the last decade. These virtual tools are based on various techniques,
such as the PE [10], the method of moments (MoM) [11], PE and MoM [12], the
ﬁnite-difference time domain (FDTD) [13], the transmission line matrix (TLM) [14],
ray-mode summation [15,16], and ray tracing, ray shooting [17]. Among these, the
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
23

24
PARABOLIC EQUATION MODELING
PE-based propagation tools are speculated to be the most attractive and effective
ones.
Two of these virtual tools (i.e., [10] and [12]) are of special interest in terms of the
topic discussed in this area. The SSPE_GUI presented in [10] is a simple MATLAB-
based groundwave propagation package for the visualization of EM propagation over
irregular terrain through the non-homogeneous atmosphere, for waves radiated by a
horizontally oriented antenna over the ground. A MATLAB package which modiﬁes
the MoM by the application of the forward/backward spectral acceleration technique
[11] and integrates it with the SSPE method is introduced in [12]. With this, precise
SSPE vs. MoM comparisons are possible.
The PE was ﬁrst applied to the underwater acoustic propagation modeling by
Leontovich and Fock in the 1940s [18]. One major problem at that time was to
detect the nuclear submarines as early as possible, and this certainly necessitated a
good understanding of underwater acoustic propagation in deep as well as shallow
waters with variable densities, bottom proﬁles, streams, etc. Later, it has become
popular in EM wave propagation modeling through the Earth–troposphere waveg-
uides. Although Leontovich and Fock [18, 19] were the pioneers, the PE approach
becomes famous after the introduction of the Fourier SSPE algorithm [20]. Since
then, the PE technique has been improved, combined with many auxiliary tools, and
applied to a variety of complex propagation problems. The book by Levy [5] is a
good source which discusses the PE modeling in detail and gathers a huge list of PE
related studies. There are also several surveys on PE modeling such as the one in
[21].
The ﬁnite-element method (FEM) has also been used in developing PE-based
numerical propagation tools. Initially, the FEM-based PE models were also applied
in underwater acoustic propagation prediction problems (see [22]). A few FEM-
based PE models have also appeared in EM wave propagation modeling for the last
decade [23,24].
3.2
Parabolic Wave Equation Form
The problem of PWE is the 2D EM problem bounded by the Earth’s surface at the
bottom, and unbounded at the top, that is extending to inﬁnity. The problem is gov-
erned by the scalar Helmholtz’s equation
∂2U
∂z2 + ∂2U
∂x2 + k2
0n2U = 0
(3.1)
where k0 = 2π/λ is the free-space wavenumber (λ is the wavelength), n = n(z, x)
is the refractive index, z and x stand for the longitudinal (range) and transverse
(height above ground) coordinates, respectively. Furthermore, U(z, x) corresponds
to either electric or magnetic ﬁeld components for horizontal and vertical polariza-
tions. Note that some researchers use the terms perpendicular and parallel polariza-
tions, whereas others prefer horizontal or vertical polarizations. Here, we assume
zx-plane as the 2D environment. The TM (vertical polarization) and TE (horizon-

PARABOLIC WAVE EQUATION FORM
25
tal polarization) equations use (Ex, Hy, Ez) and (Hx, Ey, Hz), respectively [1].
Therefore, U is Hy and Ey for TM and TE polarizations, respectively.
By separating the rapidly varying phase term exp(ik0z) from the ﬁeld U(z, x) =
exp(ik0z)u(z, x) in (3.1) if the direction of wave propagation is predominantly along
the +z-axis (i.e., paraxial direction) the following two equations can be obtained:
 ∂2
∂z2 + ∂2
∂x2 + k2
0n2

exp(ik0z)u(z, x) = 0
(3.2)
exp(ik0z)
 ∂2
∂z2 + 2ik0
∂
∂z + ∂2
∂x2 + k2
0(n2 −1)

u = 0.
(3.3)
Since exp(ik0z) is not always zero for all z values, the PWE in terms of slowly
varying amplitude function u(z, x) in range reduces as follows:
 ∂2
∂z2 + 2ik0
∂
∂z + ∂2
∂x2 + k2
0(n2 −1)

u = 0
(3.4)
 ∂
∂z + ik0(1 −Q)
  ∂
∂z + ik0(1 + Q)

u = 0
(3.5)
where Q = (1+q)1/2 and q = k−2
0 ∂2/∂x2 +(n2 −1) if the refractive index is range
independent. Note that this assumption does not violate the applicability of PWE to
range dependent refractivity proﬁles because it is valid for each range step during
the split-step solution of the PWE, which will be clear in the sequel. The ﬁrst and
second parts of (3.5) correspond to the forward- and backward-propagating waves,
respectively. If the backward propagation is ignored, (3.5) reduces to
 ∂
∂z + ik0(1 −Q)

u = 0.
(3.6)
The formal solution of the forward propagation part in (3.6) can be expressed as
u(z + Δz, x) = exp (−ik0Δz(1 −Q)) u(z, x)
(3.7)
which is amenable to numerical solution by marching-type algorithms along the
range. For the square root approximation of
(1 + q)1/2 ≈a0 + a1q
b0 + b1q
(3.8)
(3.6) can be written as
⎧
⎪
⎨
⎪
⎩

b0 + b1

n2 −1
 ∂
∂z +

b1k−2
0

∂3
∂x2∂z
+ik0

(b0 −a0) + (b1 −a1)(n2 −1)

+ ik−1
0 (b1 −a1) ∂2
∂x2
⎫
⎪
⎬
⎪
⎭
u = 0.
(3.9)
Equation (3.9) can be generally considered

A0
∂
∂z + A1
∂3
∂x2∂z + A2 + A3
∂2
∂x2

u = 0
(3.10)

26
PARABOLIC EQUATION MODELING
where A0 = b0+b1(n2−1), A1 = b1k−2
0 , A2 = ik0

(b0 −a0) + (b1 −a1)(n2 −1)

,
A3 = ik−1
0 (b1 −a1). If the angle of propagation measured from paraxial direction is
less than 15◦, the standard PE is obtained with the help of ﬁrst-order Taylor expan-
sion (square root approximation) (1 + q)1/2 ≈1 + q/2; therefore a0 = 1, a1 = 0.5,
b0 = 1, b1 = 0 and A0 = 1, A1 = 0, A2 = −0.5ik0(n2 −1), and A3 = −0.5ik−1
0 ,
 ∂
∂z −0.5ik0(n2 −1) −0.5ik−1
0
∂2
∂x2

u = 0.
(3.11)
By multiplying 2ik0, the standard PE is derived as
∂2u
∂x2 + 2ik0
∂u
∂z + k2
0(n2 −1)u = 0.
(3.12)
The accuracy of the standard PE can be limited to propagation angles less than 15◦,
and the error in the approximation increases with sin4 θ, where θ is the propaga-
tion angle from the horizontal, due to the ﬁrst neglected term in Taylor’s expansion.
Hence, the standard PE is known as the narrow-angle approximation to the wave
equation. Since the propagation angles encountered in long-range propagation prob-
lems are usually less than a few degrees, the accuracy of the standard PE is adequate
for numerical modeling.
In problems involving large propagation angles more than 15◦(such as short-
range propagation problems or the problems exhibiting strong multipath effects),
a more accurate expansion of the operator Q is required. In such cases, the use
of higher-order polynomials for the operator causes instabilities in the numerical re-
sults. There are various convenient methods proposed in the literature to handle large
propagation angles such that the operator Q can be written as Q =
√
1 + A + B, and
approximated as Q ≈
√
1 + A+
√
1 + B−1 where A = ∂2/k2
0∂x2 and B = n2−1.
By making use of the operator identity
√
1 + A = 1+A
√
1 + A + 1
−1, the wide-
angle PE is given by [25,26]
∂u
∂z −
⎡
⎣ik−1
0
 
1 + 1
k2
0
∂2
∂x2 + 1
!−1
+ ik0(n −1)
⎤
⎦u = 0.
(3.13)
Claerbout equation can be also obtained by using the ﬁrst-order Pade approximation
(1 + q)1/2 ≈(1 + 0.75q)/(1 + 0.25q); therefore a0 = 1, a1 = 0.75, b0 = 1,
b1 = 0.25 and A0 = 1 + 0.25(n2 −1), A1 = 0.25k−2
0 , A2 = −0.5ik0(n2 −1),
A3 = −0.5ik−1
0
in (3.10) to satisfy the propagation angles up to 40◦[27] as

k2
0(n2 + 3) ∂
∂z +
∂3
∂x2∂z −2ik3
0(n2 −1) −2ik0
∂2
∂x2

u = 0.
(3.14)
Another alternative for wide-angle cases is to use Greene approximation to satisfy
propagation angles up to 40◦–45◦,
√1 + q ≈(0.99987 + 0.79624q)/(1 + 0.30102q)

,
therefore a0 = 0.99987, a1 = 0.79624, b0 = 1, b1 = 0.30102 and A0 = 1 +

DIRICHLET, NEUMANN, AND CAUCHY BOUNDARY CONDITIONS
27
0.30102(n2 −1), A1 = 0.30102k−2
0 , A2 = ik0

0.00013 −0.49522(n2 −1)

,
A3 = −0.49522ik−1
0
as [28]
⎧
⎪
⎨
⎪
⎩

1 + 0.30102

n2 −1
 ∂
∂z + 0.30102k−2
0
∂3
∂x2∂z
+ik0

0.00013e −0.49522(n2 −1)

−0.49522ik−1
0
∂2
∂x2
⎫
⎪
⎬
⎪
⎭
u = 0.
(3.15)
3.3
Dirichlet, Neumann, and Cauchy Boundary Conditions
The 2D propagation scenario is completed by choosing the appropriate transverse
and longitudinal BCs. Figure 3.1 shows the 2D projected propagation region. Here,
x and z are the height and range coordinates, respectively. The region is N-segments
vertically and M-segments longitudinally. The transverse BC over Earth’s surface is
expressed as

α1
∂
∂x + α2

u(z, x) = 0
(3.16)
where α1 and α2 are constants. In general, an impedance boundary condition (IBC)
or CBC (i.e., lossy Earth’s surface) is introduced via α1 = 1, α2 = ik0
√ε −1 and
α1 = 1, α2 = ik0
√ε −1/ε for horizontal and vertical polarization, respectively.
Here, ε = εr +i60σgλ is the complex relative dielectric constant in terms of relative
permittivity (εr) and conductivity (σg) of the lossy ground at range z [29].
z
x
Source
Receiver
z0
z0+ 'z
z0+ 2'z
z0+3 'z
z0+ M'z
. . . .
Vertical field 
profiles
Field at the
receiver
Antenna 
tilt
3'x
'x
5'x
N'x
z
x
Source
Receiver
z0
z0+ 'z
z0+ 2'z
z0+3 'z
z0+ M'z
. . . .
Vertical field 
profiles
Field at the
receiver
Antenna 
tilt
3'x
'x
5'x
N'x
Figure 3.1
The 2D projected propagation region.
For the PEC surface (σ →∞), impedance BC is replaced with either DBC or
NBC, corresponding to the horizontal and vertical polarizations, respectively. The
cases where α1 = 0 and α2 = 0 refer to DBC and NBC, respectively, over the PEC
surface.
Since the propagation problem involves a physical domain extending vertically to
the inﬁnity, an abrupt truncation is required at certain height, and therefore, the upper

28
PARABOLIC EQUATION MODELING
BC (in other words, free-space or open-region condition) must be satisﬁed to avoid
non-physical reﬂections. Such artiﬁcial reﬂections can be obviated by introducing
absorbing layers above the height of interest [5].
Since waves propagating upward either go to inﬁnity or bent down because of the
refractivity variations, a window function (i.e., Hanning, Hamming, or Tukey) can
be applied to the vertical ﬁeld proﬁle above the selected height at each range in order
to eliminate reﬂection effects.
The radiation BC along z is
 ∂
∂z −ik0

u(z, x)




z→±∞
→0.
(3.17)
Although the PE in 2D describes one-way propagation and cannot take the backscat-
tered waves into account, this is not a serious restriction in order to investigate waves
emanating from a transmitter and reaching a receiver. It should be noted that the
solution of (3.10) in 2D yields waves that are attenuated by the square root of the
distance as they propagate away from the transmitter (i.e., cylindrical waves spread
for an inﬁnite-length line source which allows the reduction of the 3D wave equation
into 2D). Therefore, the user should divide the ﬁeld strength results by the square root
of distance in order to obtain PL vs. range variations in a realistic 3D environment
[30].
3.4
Antenna/Source Injection
In most of the 2D propagation models, the source is modeled in a transmitting an-
tenna’s pattern that is located vertically at the initial range. This can be achieved by
using a vertical Gaussian ﬁeld proﬁle.
The initial vertical ﬁeld at the starting range position must be properly determined
in accordance with the parameters of the antenna’s pattern being modeled. The initial
ﬁeld can be computed by means of near-ﬁeld/far-ﬁeld transformation that relates the
aperture ﬁeld and beam pattern, along with the utilization of FFT. The height and
elevation angle of the antenna can be included by using Fourier shift theorems. The
antenna pattern g(kx) given in (2.21) is speciﬁed by three parameters: antenna height
xs, the 3 dB beamwidth θbw, and the tilt (or elevation) angle θelv. The ﬁrst step is to
specify Gaussian antenna pattern in the kx-domain via
$u(0, kx) = g(kx) exp(−ikxxs) + Γg∗(−kx) exp(ikxxs).
(3.18)
The tilt is introduced by replacing g(kx) with g(kx −k0 sin θelv). The initial ﬁeld
proﬁle is then obtained via inverse FFT of $u(0, kx). The initial ﬁeld in the spatial-
domain can also be represented as u(0, x) = us(0, x) + Γus(0, −x) using
us(0, x) = exp

ik0x sin θelv −(x −xs)2
w2

(3.19)
where w =
√
2 ln 2/(k0 sin(θbw/2)). The Gaussian antenna pattern is often used in
applications since it represents various antenna types (such as parabolic antennas).

SPLIT-STEP PARABOLIC EQUATION (SSPE) MODEL
29
3.5
Split-Step Parabolic Equation (SSPE) Model
The standard PE given in (3.12) turns out to be a ﬁrst-order ordinary differential
equation that can be solved directly if a Fourier transform from the x domain to
the spectral kx domain is applied. Although, in real problems, n can be a function
of height and/or range (i.e., n = n(z, x)), this approach is appropriate because the
equation is solved at each small-range step size, Δz, which is chosen small enough
so that within any Δz interval the refractive index can be assumed to be constant
with respect to z. The numerical SSPE solution for j = 1, 2, ..., M is given as [31]
u(zs + jΔz, x) =
exp
%
i k0
2 (n2 −1)Δz
&
×F −1 '
exp

−i k2
xΔz
2k0

F {u(zs + (j −1)Δz, x)}
(. (3.20)
This equation can be used to calculate u(z, x) along z with the steps of Δz, once
the initial ﬁeld distribution, u(zs, x), is given. A 1D array can be used to store
the transverse ﬁeld proﬁles at N vertical height points at M discrete ranges with
replacement. The standard SSPE procedure is as follows:
An antenna pattern representing the initial height proﬁle of the ﬁeld, u(zs, x), is
injected ﬁrst. The initial proﬁle is propagated longitudinally from zs to zs +Δz
for j = 1 via (3.20) and u(zs + Δz, x) is obtained. This new height proﬁle is
then used as the initial proﬁle for the next step and u(zs + 2Δz, x) is obtained
for j = 2 via (3.20). The procedure is applied repeatedly, and the vertical ﬁeld
proﬁles are stored at each range step until the desired range.
The SSPE sequentially operates between the x and kx-domains, which are the
Fourier transform pairs. Since the transforms are implemented numerically, the
domains are truncated at ±Xmax and ±kxmax. The transverse and longitudinal
step sizes Δx and Δz, respectively, and the maximum height, Xmax, are de-
termined from the source and/or observation requirements, as well as sampling
necessities and aliasing effects. Once Xmax is determined, kxmax is found from
the Nyquist sampling criteria, Xmax×kxmax = πL, with L being the transform
size. Note that kxmax = k0 sin θmax, where θmax is the maximum allowable
propagation angle. Since Δx = Xmax/L, the altitude increment should satisfy
Δx ≤λ/(2 sin θmax). Although the choice of Δx is quite critical in simula-
tions, the selection of the range increment Δz (taking the refractivity gradients
into account) is chosen by the user and can be much larger than the wavelength.
The SSPE cannot automatically handle the BCs at the surface.
It is satis-
ﬁed at the surface by extending the initial vertical proﬁle from [0 −Xmax] to
[−Xmax, Xmax] (odd and even symmetric for DBC and NBC, respectively).
The problem at hand has a vertically semi-open propagation region (x →∞);
therefore, an abrupt truncation is required at a certain height, which means that,
strong artiﬁcial reﬂections will occur if not taken care of. These non-physical
reﬂections can be removed by using artiﬁcial absorbing layers above the height

30
PARABOLIC EQUATION MODELING
of interest. This is achieved by adding a small imaginary part to the refractive
index (by making n complex) or by applying windowing functions (such as
Hanning, Hamming, Tukey) in order to eliminate reﬂection effects.
Irregular terrain is implemented within the SSPE algorithm via a terrain ﬁle and
a staircase approximation [10].
The PEC ground modeling is adequate for many applications (especially above
100–200 MHz), but a more accurate model is required below these frequencies.
The surface impedance implementation (i.e., CBC) involves additional modiﬁ-
cations but is not too difﬁcult. The discrete mixed Fourier transform (DMFT)
extends the SSPE algorithm to account for the ground losses [32–34].
In the FFT-based SSPE algorithm, to satisfy the BCs over the Earth’s surface, the
surface is removed by taking a mirror copy of the initial vertical ﬁeld proﬁle with
respect to the surface (odd/even symmetric for DBC/NBC, respectively). Another
choice is to use one-sided sine/cosine transforms (sinFFT/cosFFT) for DBC/NBC,
respectively.
3.5.1
Narrow-Angle and Wide-Angle SSPE
The numerical solution of the PE is achieved by the Fourier SSPE method, which is a
widely used and robust algorithm. The algorithm starts at a reference range (usually
at an antenna) and marches the solution in a range in such a way that, it obtains
the vertical ﬁeld proﬁle at a given range by using the ﬁeld at the previous range,
with appropriate BCs at the top and bottom boundaries of the domain. The split-step
solution of the narrow-angle PE in (3.12) is given by
u(z + Δz, x) =
exp
%
ik0(n2 −1) Δz
2
&
×F −1 '
exp

−ik2
x
Δz
2k0

F {u(z, x)}
(
(3.21)
where F indicates the Fourier transform and kx = k0 sin θ is the transform variable
(θ is the propagation angle from the horizontal).
The wide-angle split-step solution of (3.12) is given as [25,26]
u(z + Δz, x) =
exp [ik0(n −1)Δz ]
×F −1

exp

−ik2
x
Δz
k0+√
k2
0−k2
x

F {u(z, x)}
.
(3.22)
3.5.2
A MATLAB-Based Simple SSPE Code
A short MATLAB code is given below step by step with explanations in order to
understand SSPE model easily. This code calculates 3D color plots of ﬁeld vs. range–
height variations at 300 MHz. A given Gaussian antenna pattern of beamwidth θbw =
1◦is tilted θtilt = 1◦upward at 100 m height under horizontal polarization. The
refractivity parameter given in (2.13) is chosen a0 = 2.4 × 10−6 for the ducting
case. Figure 3.2 shows the results.

SPLIT-STEP PARABOLIC EQUATION (SSPE) MODEL
31
% WAVE PROPAGATION ANALYSIS OVER FLAT EARTH USING SSPE
clc, close all, clear all
%% STEP 1: Input parameters are specified
zmax = 50; xmax = 500; % Maximum range [km], Maximum height [m]
NZ = 501;
NX = 1001;
% Number of nodes on z and x dir.
% Gaussian antenna specifications
fr = 300; xs = 100;% Frequency [MHz], Antenna height [m]
bw = 1;
elv = 1; % Beamwidth angle [deg], Elevation angle [deg]
pol = 1;
% Polarization type: 1 for 'Horz.' or 0 for 'Vert.'
rf = [1.5 2];% filter coefficients applied to [rf1 rf2]*xmax
mdl = 'Narr';% 'Narr' or 'Wide' for Narrow−angle/Wide−angle SSPE
a0 = 2.4e−6; % refractivity parameter for n^2=1−a0x use Eq.(2.13)
%% STEP 2: Initialize parameters for SSPE analysis
% Using (2.13) refractive index squared function(n^2) is defined.
REFRSQ=@(x) 1−a0*x;
% Filter function is defined to eliminate reflection
FILFUN=@(x) (x<=rf(1)*xmax)+(x>rf(1)*xmax).*...
(1+cos(pi*(x−rf(1)*xmax)/((rf(2)−rf(1))*xmax)))/2;
% Using (3.19) Gaussian source function is defined.
k0=2*pi*fr*1e6/3e8; % wavenumber
ww=sqrt(2*log(2))/(k0*sind(bw/2));
ufs=@(x) exp(1i*k0*sind(elv)*x).*exp(−((x−xs)/ww).^2);
ufss=@(x) ufs(x)+(−1)^pol*ufs(−x);
% The nodal points and increments (dz,dx) are defined.
dz=1e3*zmax/(NZ−1); z=(0:dz:1e3*zmax).';
dx=xmax/(NX−1);
x=(−rf(2)*xmax:dx:rf(2)*xmax).';
% The initial field is obtained.
Field=ufss(x); % initial field
NXm=length(x); % number of nodes between −rf2*hmax and rf2*hmax
ind0hmax=find(x>=0&x<=xmax); % nodes between 0 and xmax
% filter function is obtained.
flt=FILFUN(abs(x));
% SSPE parameters are obtained.
kx=2*pi/(dx*NXm)*(−ceil((NXm−1)/2):NXm−1−ceil((NXm−1)/2));
if strcmp(mdl,'Narr'),
% Narrow−angle SSPE using Eq.(3.21)
CC1=exp(−1i*dz*kx.^2/(2*k0)).';
CC2=exp( 1i*dz*k0*(REFRSQ(abs(x))−1)/2);
elseif strcmp(mdl,'Wide'),
% Wide−angle SSPE using Eq.(3.22)
CC1=exp(−1i*dz*kx.^2./(sqrt(k0^2−kx.^2)+k0)).';
CC2=exp( 1i*dz*k0*(sqrt(REFRSQ(abs(x)))−1));
end

32
PARABOLIC EQUATION MODELING
%% STEP 3: Start SSPE analysis
u=zeros(NX,NZ); u(:,1)=Field(ind0hmax);
for n=2:NZ,
% FFT of u(z,:) is calculated and multipled by CC1
Field=CC1.*fftshift(fft(ifftshift(Field),NXm));
% inv.FFT is calculated,multiplied by CC2 and filter function
Field=CC2.*fftshift(ifft(ifftshift(Field),NXm)).*flt;
u(:,n)=Field(ind0hmax);% new fields are injected to u(z+dz,:)
end
%% STEP 4: Show 3D fields
x=x(ind0hmax); u=abs(u); u=u/max(u(:,1));
f=figure('Position',[20 80 700 300]);
axes('Parent',f,'LineWidth',2,'FontWeight','bold','FontSize',14);
hold on,box on,surf(z/1000,x,u);shading interp;view([0 90]),
ylim([0 xmax]);cmax=max(u(:));caxis([0 cmax/1.4]),
colorbar('FontWeight','bold','FontSize',14);
xlabel('Range [km]'); ylabel('Height [m]');
Figure 3.2
The result of MATLAB code.
3.6
FEM-Based Parabolic Equation Model
The initial phase of the FEM-based PE (FEMPE) procedure is to divide the trans-
verse domain between the ground and the user-deﬁned maximum height (Xmax)
into a number of elements. Next, starting from the initial ﬁeld at z = zs, the approx-
imated ﬁeld values at the selected discrete nodes in the vertical domain are propa-
gated longitudinally by applying the Crank–Nicolson approach. This is based on the

FEM-BASED PARABOLIC EQUATION MODEL
33
improved Euler method [35–37]. Although the Crank–Nicolson technique is inher-
ently fast, it requires that, both height and range step sizes, Δx and Δz, respectively,
should be chosen as small as necessary to overcome numerical oscillation problems,
which obviously decelerate the speed of the method.
Table 3.1
The coefﬁcients of (3.10) with respect to narrow and wide cases.
Coefﬁcients
Narrow
Wide Pade(1,1)
Wide (Greene)
A0
2ik0
k2
0(n2 + 3)
1 + 0.30102(n2 −1)
A1
0
1
0.30102k−2
0
A2
k2
0(n2 −1)
−2ik3
0(n2 −1)
ik0(0.00013 −0.49522(n2 −1))
A3
1
−2ik0
−0.49522ik−1
0
To formulate the FEMPE, we start with (3.10) whose coefﬁcients are chosen by
considering narrow- and wide-angle approximations given in Table 3.1. Note that
some coefﬁcients depend on x because of the refractive index, therefore the mid-
points of each segment have been taken into consideration for the matrix calculation.
However, the coefﬁcients are assumed to be constant for each element by ﬁnding the
value of the refractive index at the midpoint of each element. Multiplying (3.10) by a
smooth test function while considering the BC; integrating from x = 0 to x = Xmax,
it is obtained as [35]
ne

e=1
⎛
⎜
⎜
⎜
⎜
⎝
2

j=1
A0
∂ce
j
∂z
 xe
2
xe
1
Be
jBe
mdx −
2

j=1
A1
∂ce
j
∂z
 xe
2
xe
1
∂Be
j
∂x
∂Be
m
∂x dx
+
2

j=1
A2ce
j
 xe
2
xe
1
Be
jBe
mdx −
2

j=1
A3ce
j
 xe
2
xe
1
∂Be
j
∂x
∂Be
m
∂x dx
⎞
⎟
⎟
⎟
⎟
⎠
+A3α2δm,1c1
1 = 0
(3.23)
with Kronecker delta (δm,$
m = 0 for m ̸= $m, δm,$
m = 1 for m = $m). The idea of the
FEM is to divide the domain, here the vertical proﬁle [0 −Xmax], into subdomains
(called elements) in which the basis functions are generally formed with the help of
linear piecewise Lagrange polynomials as [35]
Be
1(x) = xe
2 −x
xe
2 −xe
1
, Be
2(x) = x −xe
1
xe
2 −xe
1
(3.24)
where e stands for the elements between nodes xe
1 and xe
2. The matrix form can then
be represented as
A∂c
∂z + Bc = 0
(3.25)
with A = A0M −A1K and B = A2M −A3K + A3BC or
%
A0M e
mj −A1Ke
mj
& ' ∂ce
j
∂z
(
+
%
A2M e
mj −A3Ke
mj + A3BCe
mj
& /
ce
j
0
= {0} for

34
PARABOLIC EQUATION MODELING
e = 1, ..., ne, m = 1, 2, and j = 1, 2 with
M e
mj =
 xe
2
xe
1
Be
mBe
jdx, Ke
mj =
 xe
2
xe
1
∂Be
m
∂x
∂Be
j
∂x dx.
(3.26)
The elemental matrices between nodes xe
1 and xe
2 for the linear piecewise Lagrange
polynomials are obtained as
[M e] = Δx
6
1
2
1
1
2
2
, [Ke] =
1
Δx
1
1
−1
−1
1
2
.
(3.27)
BCe
mj is taken into consideration with CBC as BC1
11 = α2 for each step in z,
z + Δz, .... The ground properties are incorporated into the FEM with the help of
matrix BC. On the PEC surface, matrix BC becomes zero. In addition, the initial
node is always zero for DBC at the surface and this is satisﬁed by eliminating the
ﬁrst column and row of the matrices.
Using Crank–Nicolson approximation based on the improved Euler method for
k = 2, ..., Nz [29] where M is the number of nodes in the horizontal domain, the
new coefﬁcients for the next step are obtained as
ck = ck−1 + Δz
2
∂ck
∂z + ∂ck−1
∂z

(3.28)
multiplying by A, and eliminating the derivative terms by using the differential equa-
tion (3.25), one obtains

A + BΔz
2

ck =

A −BΔz
2

ck−1
(3.29)
which yields an unconditionally stable system and accurate method with a discretiza-
tion error O

Δz2
. The coefﬁcients of the initial ﬁeld c1 at z = 0 can be generated
from the Gaussian antenna pattern speciﬁed by its height, 3 dB beamwidth angle,
and tilt angle. Although Crank–Nicolson provides a fast solution, it has some disad-
vantages since oscillation occurs for large Δz [35].
For example, for the linearly decreasing vertical refractivity (see Section 2.3 for
details) problem, the LINPE package is created to compare SSPE and FEMPE with
analytical mode summation representation. The ﬂow chart of the LINPE is given
in Fig. 3.3. The propagation tool has three subroutines (LIN_EXACT, SSPE, and
FEMPE) for the numerical calculations of the mathematical exact, the DFT/DST/DCT-
based PE, and the FEMPE solutions, respectively. MATLAB codes, sspe.m and
fempe.m, are used for calculations. First, the 2D propagation environment (the maxi-
mum range and height) is speciﬁed, the frequency is given, and the discretization pa-
rameters (Δx, Δz, the number of range Nz = M +1, and height points Nx = N +1,
etc.) are supplied. Then, the Gaussian antenna pattern (i.e., the antenna height, its
beamwidth, and vertical tilt) is given as the initial vertical ﬁeld proﬁle and then nor-
malized to unity for all simulation tests. Finally, the slope of the vertically decreasing
refractivity proﬁle is supplied.

FEM-BASED PARABOLIC EQUATION MODEL
35
Figure 3.3
The ﬂow chart of the MATLAB-based LINPE code. LINPE predicts the ﬁeld
strength value at a given range and height point using all three methods; analytical exact
representation, SSPE, and FEMPE.
LINPE propagation tool links to the mode summation subroutine once all opera-
tional parameters are set. The mode subroutine calculates the number of modes and
the modal excitation coefﬁcients that are necessary to construct the initial antenna
pattern for the given accuracy. These modes are then used for every height and range
points to calculate the mathematical solution that will be used as the reference.
LINPE calls all three subroutines one by one, does the numerical computations
and yields the output as the 2D and 3D ﬁeld strength variations. It yields not only
3D ﬁeld strength vs. range–height color plots for all the three methods but also the
2D and plots for their comparisons, ﬁeld strength vs. height variations are plotted at
three different ranges. Field strength vs. range variations is given at two different
heights.
The tests and comparisons belong to the scenario speciﬁed with the operational
parameters listed in Table 3.2.
Figure 3.4 presents 3D color plots of ﬁelds vs. range–height for a given Gaussian
antenna pattern without a tilt via the LIN_EXACT, SSPE, and FEMPE subroutines
for horizontal and vertical polarizations. The vertical, linearly decreasing refractiv-
ity proﬁle causes a surface duct as observed in the ﬁgure. Although the beam is

36
PARABOLIC EQUATION MODELING
Table 3.2
The operational parameters.
Operational Parameter
Value
Operational Parameter
Value
Maximum range [km]
100
Number of range [pts]
1000
Maximum height [m]
750
Number of height [pts]
256
Frequency [MHz]
300
Antenna height [m]
250
Vertical beamwidth [◦]
0.5
Antenna tilt [◦]
0/1
Refractivity slope (a0)
1.2 × 10−6
(a) 
LIN-EXACT 
SSPE 
FEMPE 
(b) 
(c) 
(a) 
(b) 
(c) 
LIN-EXACT 
SSPE 
FEMPE 
Figure 3.4
Three-dimensional color plots of ﬁelds vs. range–height variations for a given
Gaussian antenna pattern without a tilt obtained from (a) analytical, (b) SSPE, (c) FEMPE
representations: (left) horizontal polarization, (right) vertical polarization.
directed horizontally, EM waves are pushed down as they propagate longitudinally,
hit the ground, and reﬂect upward. The ground-reﬂected waves and the interference
(between the incident and the ground-reﬂected waves) are clearly observed in this
ﬁgure.
Unfortunately, these 3D color plots are mostly good for the visualization pur-
poses and are not good for the realistic comparisons and the calibration. The cali-
bration of such numerical propagation tools necessitates accurate comparisons. This
is achieved via two dimension range and/or height illustrations of EM ﬁelds as pre-
sented in Fig. 3.5. Here, the vertical ﬁeld variations computed via all three methods
at three different ranges are given for different polarizations. On the left, the initial
ﬁeld proﬁle (i.e., the antenna radiation pattern) is shown. The other two show the
vertical ﬁeld proﬁles at 25 km and 50 km ranges, respectively.

FEM-BASED PARABOLIC EQUATION MODEL
37
0 
0.5 
1 
0 
250 
500 
750 
Height [m] 
Field 
at z = 0 km 
0 
0.5 
1 
Field 
at z = 25 km 
0 
0.5 
1 
Field 
at z = 50 km 
0 
0.5 
1 
0 
250 
500 
750 
Height [m] 
Field 
at z = 0 km 
0 
0.5 
1 
Field 
at z = 25 km 
0 
0.5 
1 
Field 
at z = 50 km 
  
  
anal 
sspe 
fempe 
Figure 3.5
Fields vs. height at three speciﬁed ranges; (solid) analytical representations,
(dashed) SSPE, (dashed-dotted) FEMPE, (left) horizontal polarization, (right) vertical
polarization.
0 10 20 30 40 50 60 70 80 90 100 
0 
0.5 
1 
Range [km] 
Field at x = 50 m 
0 
0.5 
1 
Field at x = 100 m 
0 
0.5 
1 
Field at x = 100 m 
0 10 20 30 40 50 60 70 80 90 100 
0 
0.5 
1 
Range [km] 
Field at x = 50 m 
  
  
anal 
sspe 
fempe 
Figure 3.6
Fields vs. range at two speciﬁed heights; (solid) analytical representations,
(dashed) SSPE, (dashed-dotted) FEMPE, (left) horizontal polarization, (right) vertical
polarization.
Figure 3.6 shows the same comparison for different polarizations among these
three methods as ﬁeld strengths vs. ranges at two different heights, 50 m and 100 m,
respectively.
In the second test, the 2D propagation space and propagation over the ﬂat non-
penetrable ground is simulated with an antenna tilt. Different linearly decreasing
refractivity proﬁles are used. Although the beam is directed upward, EM waves are
pushed down again as they propagate longitudinally, hit the ground, and reﬂect up-
ward in Fig. 3.7. The ground-reﬂected waves and the interference (between the inci-
dent and the ground-reﬂected waves) are clearly observed in this ﬁgure. As observed

38
PARABOLIC EQUATION MODELING
(a) 
LIN-EXACT 
SSPE 
FEMPE 
(b) 
(c) 
(a) 
(b) 
(c) 
LIN-EXACT 
SSPE 
FEMPE 
Figure 3.7
Three-dimensional color plots of ﬁelds vs. range–height variations for a given
Gaussian antenna pattern tilted 1◦upward obtained from (a) analytical, (b) SSPE, (c) FEMPE
representations, horizontal polarization, (left) a0 = 1.2 × 10−6, (right) a0 = 3.6 × 10−6.
(b) 
(a) 
LIN-EXACT 
SSPE 
0 
0.5 
1 
0 
200 
400 
600 
800 
1000 
Height [m] 
Field 
at z = 20 km 
0 
0.5 
1 
Field 
at z = 40 km 
anal 
sspe 
fempe 
Figure 3.8
(a) SSPE and analytic propagators with tilted waves at 200 m and 400 m
with −0.5◦, 0.5◦tilts, respectively, (b) vertical ﬁeld proﬁles at two different ranges (a0 =
1.2 × 10−6).
from these three ﬁgures, the agreement between the SSPE and FEMPE numerical
propagation tools and their match with the analytical exact solutions are impressive.
The analytical calculations are much faster if the antenna beamwidth is wide (i.e.,
the number of modes is less). The narrower the vertical antenna pattern the higher

FEM-BASED PARABOLIC EQUATION MODEL
39
the number of modes used to reconstruct this pattern, therefore the longer the com-
putation time. Note that the tilt of the antenna in analytical exact representations is
satisﬁed by introducing the complex modal excitation coefﬁcients.
The tests performed here and comparisons against the analytical exact solution
which may be accepted as reference calibrate both SSPE and FEMPE propagation
tools.
In Fig. 3.8a, 3D visualization of both analytical and numerical solutions is pre-
sented where the transmitter contains two Gaussian patterns of 1◦beamwidth (i.e.,
two antennas) at 200 m and 400 m, with 0.5◦downward and 0.5◦upward, respec-
tively. In Fig. 3.8b, vertical ﬁeld proﬁles at two different ranges obtained with all
three (analytical, SSPE, and FEMPE) codes are shown. Excellent agreement illus-
trates the success and completeness of numerical methods.
Important aspects of these tests, comparisons, and calibration may be listed as
follows:
The modes of the analytical exact solution are conﬁned between the ground and
their (modal) caustics for the linearly decreasing vertical refractivity proﬁle.
The height of the caustics increases as the number of modes increases, there-
fore the construction of the initial ﬁeld proﬁle necessitates the contributions of
higher-order modes for higher antenna heights. But, as the antenna height in-
creases, the contributions of the lower-order modes become negligible, so the
best way to reconstruct the antenna pattern in terms of the modal summation
is to use modes from M1 to M2 which are the lowest and the highest mode
numbers to be determined from operational parameters.
The modal excitation coefﬁcients are found from the given antenna pattern us-
ing the orthonormality property. These coefﬁcients are real for the antenna
pattern without tilt but become complex if a tilt is used. The complex excitation
coefﬁcients are obtained from a numerical complex integration.
An antenna pattern may be reconstructed with a number of modes for a given
set of operational parameters. But, one should take higher-order modes into
account (although they might not be necessary to construct antenna pattern) if
the antenna is tilted upward.
The analytical solution is exact, therefore is a reference when an inﬁnite number
of modes is taken into account and if accurately computed numerically. On the
other hand, the analytical solutions with a ﬁnite number of modes should be
accurate enough to be a reference!
SSPE solves the PE in the transverse-domain so it is not as sensitive as FEMPE
to the vertical discretization. On the other hand, special attention is required for
the vertical boundary treatments.
FEMPE uses discretization on the vertical-domain and solves the discrete Crank–
Nicolson system horizontally. The computation burden mostly comes from the

40
PARABOLIC EQUATION MODELING
selection of this tridiagonal system. The computation time increases with Nz in
range but N 2
x in height.
The aim in this chapter is to (i) review both the SSPE and FEMPE propagation ap-
proaches and introduce MATLAB-based simple routines; (ii) present canonical test
cases and do systematic comparisons between the SSPE and FEMPE methods; (iii)
calibrate both the SSPE and FEMPE tools against analytical exact (reference) solu-
tions. The canonical tests and comparisons are given. Both the SSPE and FEMPE
tools are also calibrated against the analytical exact solutions.
The PE method is capable of simulating one-way, forward-scatter propagation
problems within the paraxial approximation. It takes into account all types of BCs at
the ground, as well as the atmospheric refractivity variations. Widely applied numer-
ical routines are based on either the discrete Fourier split-step solution or the FEM
solution. Here, two numerical propagation tools based on the Fourier split-step and
the FEM are discussed. Simple MATLAB-based propagation tools (LIN_EXACT,
SSPE, and FEMPE) are introduced. The systematic comparisons on some canoni-
cal test scenarios are performed and the propagation tools are calibrated against the
mathematical exact solutions. Both SSPE and FEMPE can take any type of refrac-
tivity variations into account.
3.7
Atmospheric Refractivity Effects
The lower troposphere affects radio wave propagation in numerous ways. Especially,
its non-uniform nature causes EM waves to be bent or refracted. Refraction of EM
waves is due to the variation of the velocity of propagation with altitude. It is known
that index of refraction or refraction index (n) is the ratio of the velocity in free space
to the velocity in the medium of interest (atmosphere in our case), and is caused by
pressure, temperature, and water vapor variations in both space and time. The air
can be considered as a non-dispersive medium and represented by its refractive index
(n = √εr). The refractivity of the propagation medium should be well understood
since non-ﬂat terrain and/or Earth’s curvature can be implemented via refractivity in
most of the analytical and numerical approaches. Refractive index of the air is very
close to unity (typically about 1.0003), therefore it is customary to use refractivity
N = (n −1) × 106
(3.30)
where N is dimensionless but is measured in N units for convenience. The refrac-
tivity depends on the pressure P (mbar), the absolute temperature T (◦K), and the
partial pressure of water vapor e (mbar)
N = 77.6P
T + 3.73 × 105 e
T 2
(3.31)
which is valid in Earth–troposphere waveguides and can be used in radio wave prop-
agation modeling. If the refractive index is constant, radio waves would propagate

ATMOSPHERIC REFRACTIVITY EFFECTS
41
in straight lines. Since n decreases with height, radio waves are bent downward to-
ward the Earth, so that the radio horizon lies further away than the optical horizon.
It should be noted that the radio horizon effect is taken into account either by using
N with the effective Earth radius or by introducing a ﬁctitious medium where N is
replaced by the modiﬁed refractivity M, which is also dimensionless but is measured
in M units
M = N + x
ae
× 106 = N + 157x
(3.32)
with the height above surface (x) given in km and the effective Earth’s radius, that
is, ae = 6, 378 km. It is conventional to deﬁne modiﬁed refractivity, which takes the
Earth’s curvature into account, as follows
M = (n + x/ae −1) × 106.
(3.33)
The variations of the vertical gradient dM/dx of the modiﬁed refractivity determine
four types of atmospheric conditions.
Sub-refraction (dM/dx >117 M units/km),
Standard (dM/dx = 117 M units/km),
Super-refraction (dM/dx <117 M units/km), and
Ducting (dM/dx <0).
Non-standard atmospheric conditions cause anomalous propagation because rays
bend upward in sub-refraction, and downward to the Earth’s surface in super-refraction
and ducting conditions, in a way different from the standard atmosphere.
Especially, atmospheric ducts (i.e., wave trapping layers) are of special interest
because the negative vertical gradient leads to the capture of energy within the duct,
and the trapped energy can propagate to ranges beyond the normal horizon what
would be expected with a standard atmosphere. Such conditions signiﬁcantly affect
the radio communication links and radar performance. There are basically four types
of ducting conditions
surface duct,
surface-based duct,
elevated duct,
evaporation duct (which is indeed a type of surface duct occurring over water
due to water vapor evaporated from the sea).
For the standard atmosphere (i.e., for a vertical linearly decreasing refractive in-
dex), N decreases by about 40 N units/km while M increases by about 117 N unit-
s/km. Sub-refraction (super-refraction) occurs when the rate of change in N with
respect to height (i.e., dN/dx) is less (more) than 40 N units/km.

42
PARABOLIC EQUATION MODELING
A linearly decreasing (increasing) vertical refractive index variation forces a wave
trap near (diverge from) the Earth’s surface while propagating. Similar effects are
also caused by concave and convex surfaces. Therefore, there is an analogy between
refractive index and surface geometry in terms of propagation effects. By using
this analogy, the Earth’s curvature effect is included into the refractive index of the
air. The Earth’s curvature effect is equivalent to a vertical refractivity gradient of
157 N units/km (i.e., linear vertical increasing refractivity proﬁle). As stated, the
standard atmosphere, together with the Earth’s curvature, is represented by a vertical
refractivity gradient of 117 N units/km.

CHAPTER 4
WAVE PROPAGATION AT SHORT
RANGES
4.1
Introduction
Propagation above the Earth has long been modeled in two dimensions, where ground
losses and irregularities and atmospheric variations have been taken into account, but
lateral effects are neglected (see [3,5,38–43]). Many propagation virtual tools have
been introduced over the last decade. Analytical models for relatively simple scenar-
ios are mostly based on mode and ray summation [9,15,16]. Powerful time-domain
models are based on both the FDTD [13] and the TLM [14] methods. The frequency-
domain models include simulators based on the SSPE [5, 10, 34], the FEMPE [44],
and the MoM [2, 12, 45]. There are also tools for comparisons of the SSPE and the
MoM [31], or of the SSPE and the FEMPE [46].
One of the important issues in these 2D propagation simulation studies is the
process of VV&C [8,45]. The VV&C procedure necessitate reliable reference data.
Reliable data are best obtained via measurements. Unfortunately, this is extremely
expensive, complex, and time consuming. Hence, one has to generate reference
data from analytical models (only after accurate numerical computations), which are
available for only a few idealized, simpliﬁed canonical propagation problems.
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
43

44
WAVE PROPAGATION AT SHORT RANGES
Analytical models are mostly based on mode and ray summations and require
eigenmode and/or eigenray extraction. Modes are global wave objects in guiding en-
vironments and can be used in representing any kind of excitation. They are conﬁned
transversely and propagate longitudinally. Modes and their propagation constants are
also called eigenfunctions and eigenvalues, respectively. On the other hand, rays are
local wave objects and are source–observer dependent. Numerical computation of
mode and/or ray summation for different excitations might be a challenge.
Another challenge is accurate source modeling. Different models use different
excitations such as a line source, a vertical short dipole, or a directional transmitter
(e.g., a vertical Gaussian beam). Vertical (upward/downward) tilt may also be given
in the last source model.
Accurate source modeling and VV&C of different 2D propagators are discussed
in this chapter. The SSPE, FEMPE [45], and MoM propagators are validated and
calibrated against the 2Ray model over ﬂat Earth and the single knife edge problem
with the 4Ray model [8].
4.2
Accurate Source Modeling
In most of the 2D propagation models, the source is modeled as a transmitting an-
tenna’s pattern. This is achieved in PE propagators by using a vertical Gaussian-
shaped input ﬁeld proﬁle (see Fig. 4.1). The vertical beamwidth and beam tilt can
also be adjusted. On the other hand, most of the analytical solutions (i.e., mode/ray
models) that may serve as a reference use line-source excitation. In order to com-
pare these two and perform VV&C, the excitations must be identical. Hence, source
adaptation is crucial.
(b) 
(a) 
  0.5
  1
30
210
60
240
90
270
120
300
150
330
180
0
  0.5
  1
30
210
60
240
90
270
120
300
150
330
180
0
0
0.5
1
-80
-60
-40
-20
0
20
40
60
80
T [deg]
W(T)
Excitation Coefficients
0
0.5
1
-80
-60
-40
-20
0
20
40
60
80
T [deg]
W(T)
Excitation Coefficients
Figure 4.1
Ray excitation coefﬁcients and polar antenna patterns of vertical Gaussian beams
with different tilts and their wavenumber equivalents: (a) untilted case: (solid) θbw = 10◦,
(dashed) θbw = 20◦, (dashed-dotted) θbw = 30◦; (b) tilted case with θbw = 20◦(solid)
θelv = 0◦, (dashed) θelv = 10◦, (dashed-dotted) θelv = −15◦.
As observed in Fig. 4.1, using a Gaussian function for the vertical source proﬁle
gives a smooth beam without any side lobes and back lobes. In practice, vertical

ACCURATE SOURCE MODELING
45
(e) 
(d) 
(a) 
(b) 
(c) 
0
0.5
1
-80
-60
-40
-20
0
20
40
60
80
T [deg]
W (T)
Excitation Coefficients
0
0.5
1
-80
-60
-40
-20
0
20
40
60
80
T [deg]
W (T)
Excitation Coefficients
Figure 4.2
(a) A vertical (2 × 5) planar array, (b) untilted, (c) 30◦down-tilted beam (the
angular distribution is characterized by a Sinc function), and the ray excitation coefﬁcients
(d) without tilt: (solid) θbw = 10◦, (dashed) θbw = 20◦, (dashed-dotted) θbw = 30◦; (e)
θbw = 20◦with tilt: (solid) θelv = 0◦, (dashed) θelv = 10◦, (dashed-dotted), θelv = −15◦.
arrays, either linear or planar, are used in communication and/or radar systems. A
more realistic vertical source model is shown in Fig. 4.2. Here, a 2 × 5 planar array
is shown. The inter-array element distances are 0.5 m and 0.25 m, in the vertical
and horizontal directions, respectively. At a frequency of 300 MHz, these distances
correspond to half and quarter wavelengths, respectively. The source is 100 m above
the ground. The vertical extent of this source is 2 m. The beamwidth is around 30◦
(using θbw ≈λ/D radian with λ = 1 m and D = 2 m, the beamwidth is found to be
28.6◦). Note that both untilted and tilted beams have side lobes and back lobes, and
the side lobes have to be taken into account in realistic excitations. The ray excitation
coefﬁcients corresponding to the planar array are shown in Fig. 4.2.
The beamwidth is controlled by the number of transverse elements in the array.
The tilt is controlled by element phasing (i.e., electronic beamforming and beam
steering). Note that the smooth Gaussian beams presented in Fig. 4.1 can also be
produced with the vertical planar array pictured in Fig. 4.2. This could be achieved
by controlling/changing element feed voltages. For example, using a binomial feed

46
WAVE PROPAGATION AT SHORT RANGES
voltage distribution in Fig. 4.2 will produce exactly the same Gaussian beams given
in Fig. 4.1 (instead of using 1 V, 1 V, 1 V, 1 V, 1 V for the ﬁve elements in Fig. 4.2, a
binomial excitation uses 1 V, 4 V, 6 V, 4 V, 1 V).
The numerical propagators (SSPE, FEMPE) directly use either a Gaussian beam
or an actual planar array distribution as an initial ﬁeld (antenna) proﬁle. If the en-
vironmental refractivity variations and/or physical transverse boundaries allow EM
wave trapping/guiding, one can use a mode summation approach as an analytical
model. Accurate source modeling in this case only necessitates the computation of
modal excitation coefﬁcients from orthonormality relations [2, 45]. Unfortunately,
this is not the case for the simple ﬂat Earth scenario which is not a guided wave
problem; mode summation is therefore not possible.
The simplest solution approach for the ﬂat Earth problem is to apply a ray sum-
mation model. As described in Chapter 2, the total ﬁeld at the observation point
is obtained via the addition of the contributions of the direct and ground-reﬂected
waves. This may also be achieved by the image method. An image source is located
beneath the ground and the ground is removed. The addition of the contributions of
both the source and its image yields the solution. The polarity of the image source
is chosen depending on the polarization of the source. The MoM solution is also a
ray-based model; accurate source modeling for the 2Ray model is therefore directly
applicable to the MoM.
Accurate source modeling in ray-based models under a tilted Gaussian beam (see
Fig. 4.1) and/or vertical planar array (see Fig. 4.2) is as follows:
Choose the vertical ﬁeld distribution u(zs, x) for the PE models (for both SSPE
and FEMPE). In general, this is a vertically tilted beam and zs = 0.
Make the source unit power by using the normalization constant obtained from
cx =
 ∞
x=0
u2(zs, x)dx
−1/2
.
(4.1)
Apply the FFT between the vertical spatial, x, and vertical wavenumber, kx =
k0 sin θ, domains for free space. This gives the angular distribution of the exci-
tation, U(zs, kx) or U(zs, θ).
Add the ray excitation coefﬁcients W(θ) to the ray with respect to the departure
angles. Note that W(θ) must also be unit power: that is, cθ must satisfy

π
2
θ=−π
2
c2
θW 2(θ)dθ = 1.
(4.2)
The source model can be operated between the x and kx-domains (as mentioned
above) which are the Fourier transform pairs. The domains are determined with re-
spect to their maximum heights and wavenumbers, which are between [0, Xmax] and
[−kxmax, kxmax]. The discretization with respect to mesh spacing is determined to
be dx×dkx = 2π/N where N is the transform size. The antenna pattern, U(zs, kx),

WAVE PROPAGATORS IN TWO DIMENSIONS
47
is speciﬁed in the transverse wavenumber domain in (3.18), where f(kx) is either a
Gaussian (see Fig. 4.1)
f(kx) = exp

−
k2
x ln 2
2k2
0 sin2(θbw/2)

(4.3)
or planar (see Fig. 4.2)
f(kx) = sinc
kxD
2

(4.4)
where D = 2sinc−1(1/
√
2)/(k0 sin(θbw/2)) is the planar array width. The tilt angle
(θelv) is introduced by replacing f(kx) with f(kx−k0 sin θelv). The initial ﬁeld pro-
ﬁle, u(zs, x), is then obtained via the inverse FFT of U(zs, kx). The corresponding
ray excitation coefﬁcients are then approximated as
W(θ) ≈exp
 
−[sin θ −sin θelv]2 ln 2
2 sin2(θbw/2)
!
(4.5)
W(θ) ≈sinc

π [sin θ −sin θelv] D
λ

(4.6)
for every ray, using their departure angles, θ, and these coefﬁcients are used in the
ray summation model for the antenna pattern. Note that the excitation coefﬁcients
are multiplied with the normalization constant, cθ, which satisﬁes (4.2).
4.3
Wave Propagators in Two Dimensions
Wave propagation has long been modeled in two dimensions. Here, the problem
is handled in transverse–longitudinal (i.e., height–range) coordinates. The source
is located at the initial range (usually, zs = 0) at a speciﬁed height (xs = ht).
The receiver is located at the ﬁnal range (zo = d) at a speciﬁed height (xo = hr).
Figure 4.3 shows the simplest 2D propagation environment; ﬂat Earth with PEC
ground. The environment is open longitudinally (z →±∞) and semi-open trans-
versely (x →∞). The top and bottom plots show the same scenario with the line
source and directive antenna (tilted-beam) excitations, respectively.
4.3.1
Flat Earth and Two-Ray Model
The simplest propagation scenario used in analytical modeling is the ﬂat Earth with
PEC surface under a line source as excitation (see the scenario in Fig. 4.3).
A line source (aligned with the y-axis) allows the reduction of the 3D wave equa-
tion into two dimensions. In this case, cylindrical-wave spread is of interest. As
pictured in the ﬁgure, the total ﬁeld at the observer is obtained via vector addition
of direct and ground-reﬂected rays. This model is called 2Ray model. Rays in two

48
WAVE PROPAGATION AT SHORT RANGES
Figure 4.3
A ﬂat Earth with a PEC boundary.
dimensions are attenuated by the square root of the distance as they propagate away
from the source. The total ﬁeld is therefore
u(zo, xo) ≈W(θ1)exp(ik0d1)
√d1
+ W(θ2)Γh,v
exp(ik0d2)
√d2
(4.7)
where W(θ1) and W(θ2) are the ray excitation coefﬁcients to the direct and ground-
reﬂected rays, (zo = d, xo = hr) are the observer coordinates, and
d1 =

d2 + (ht −hr)2, d2 =

d2 + (ht + hr)2
(4.8)
where d is the longitudinal distance between the source and the observer, and the
complex reﬂection coefﬁcient, Γh,v, for the horizontal and vertical polarizations is
given in (2.8). The departure angles of the two rays are
θ1 = tan−1 [(hr −ht)/d] , θ2 = −tan−1 [(hr + ht)/d] .
(4.9)
Assuming inﬁnite conductivity (i.e., a PEC surface), Γh →−1 and Γv →1.
Note that the ray excitation coefﬁcients are necessary if a directive antenna with a
given vertical beamwidth and vertical tilt is used as pictured at the bottom of Fig. 4.3.
A MATLAB code Fearth1.m uses 2Ray model with ray excitation coefﬁcients.

KNIFE EDGE AND FOUR RAY MODEL
49
4.3.2
FEM-Based PE Wave Propagator
A ﬁnite-element PE is a one-way, forward propagation model, valid under the parax-
ial (+z direction) approximation. The FEMPE is based on the division of the vertical
proﬁle between lower and upper boundaries into nodes. A vertical antenna proﬁle,
u(zs, x), is located at the selected discrete nodes and propagated longitudinally using
the Crank–Nicolson method, based on improved Euler approach [44]. A widely used
antenna pattern is the normalized, tilted Gaussian pattern. See Section 3.6 for details.
A MATLAB code Fearth2.m uses FEMPE model with ray excitation coefﬁcients.
4.3.3
SSPE-Based PE Wave Propagator
The SSPE model has long been used in groundwave propagation modeling. It models
EM wave scattering above irregular, lossy Earth through a non-homogeneous atmo-
sphere. It takes into account only one-way (forward) scattering effects in the paraxial
region (i.e., for near-axial angles). The FFT-based PE solution uses a longitudinal
marching procedure. First, an antenna pattern representing the initial height proﬁle
is injected. The initial ﬁeld is then propagated longitudinally from zs to zs + Δz,
and the transverse ﬁeld proﬁle at the next range is obtained. This new height proﬁle
is then used as the initial proﬁle for the next step, and the procedure goes on until the
propagator reaches the desired range. See Section 3.5 for details. A MATLAB code
Fearth3.m uses SSPE model with ray excitation coefﬁcients.
4.3.4
Method of Moments Modeling
The MoM technique can be used to ﬁnd the propagation of horizontally and vertically
polarized waves by using the electric ﬁeld integral equation and the magnetic ﬁeld
integral equation, respectively. Open-region propagation over the irregular ground
and/or rough surfaces has been successfully modeled with the MoM. In the classical
MoM, the integral equation is converted to the corresponding matrix equation via the
discretization of the ground/surface. An N × N system of equations, [V ] = [Z] [I],
is then constructed, and numerically solved. Here, [I] contains the unknown segment
currents, [V ] contains segment voltages excited by the source, and [Z] is the N × N
impedance matrix of the ground/surface. A solution of this system yields the un-
known segment currents. Superposition of the contributions of the segment currents
via Green’s function of the problem yields the ground scattered ﬁeld. Finally, the
total ﬁeld is obtained by adding the incident ﬁeld [47]. A MATLAB code Fearth4.m
uses MoM model with ray excitation coefﬁcients, that is compared with the 2Ray
model for accurate source modeling.
4.4
Knife Edge and Four Ray Model
The single knife edge problem is a canonical structure where reference data can
be generated for VV&C procedures. The ray summation approach is based on the

50
WAVE PROPAGATION AT SHORT RANGES
construction of four different rays, and related reﬂection and diffraction coefﬁcients;
Fresnel integrals are also used (See Section 2.2 for details).
The total ﬁeld for 4Ray model with ray excitation coefﬁcients is obtained as
F =
4

q=1
W(θq)Γq
1 −i
2
exp (ikRq) {(0.5 + C(vq)) + i (0.5 + S(vq))}
(4.10)
where W(θq) is the ray excitation coefﬁcient to be determined from the antenna
pattern; other parameters are deﬁned in Section 2.2. The departure angles of the four
rays are θ1 = θ4 = tan−1 [(hr −ht)/d] and θ2 = θ3 = −tan−1 [(hr + ht)/d].
A MATLAB code Knife_SSPE4Ray.m uses the 4Ray model with ray excitation
coefﬁcients for source modeling.
4.5
Canonical Tests and Calibration
First, ﬁelds vs. range/height variations are mapped in color plots. Figure 4.4 shows
3D color maps for untilted and tilted beams. The frequency is 30 MHz and the
vertical beamwidth is 30◦. The source is located 200 m above the ground. The
longitudinal and transverse mesh sizes are Δz = 1 m and Δx = 5 m, respectively.
(a) 
SSPE 
2RAY 
MoM 
(b) 
(c) 
(a) 
(b) 
(c) 
SSPE 
2RAY 
MoM 
Figure 4.4
Fields vs. range/height for a given (left) untilted (right) −15◦-tilted Gaussian
source: (a) SSPE, (b) 2Ray, (c) MoM (one-way propagation, DBC, f = 30 MHz, source
height is 200 m, θbw = 30◦, Δz = 1 m, Δx = 5 m).

CANONICAL TESTS AND CALIBRATION
51
0
200
400
600
800
1000
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
Range [m]
|Field|
 
 
MoM
2Ray
PE
0
200
400
600
800
1000
0
0.02
0.04
0.06
0.08
Range [m]
|Field|
Figure 4.5
Fields vs. range for a given untilted Gaussian source (at 200 m height, observer
height is (left) 200 m and (right) 100 m, θbw = 30◦, f = 30 MHz, Δz = 1 m, Δx = 5 m).
0
200
400
600
800
1000
0
0.05
0.1
0.15
Range [m]
|Field|
 
 
MoM
2Ray
PE
0
200
400
600
800
1000
0
0.05
0.1
0.15
Range [m]
|Field|
Figure 4.6
Fields vs. range for a given tilted (left) Gaussian source and (right) planar array (at
200 m height, observer height is 100 m, θbw = 20◦, θelv = −15◦, f = 30 MHz, Δz = 1 m,
Δx = 5 m).
In order to observe the degree of the matching of the results of the models, 2D
variations in ﬁelds vs. range are plotted in Fig. 4.5. As observed, very good agree-
ment is obtained among the models without any normalization at the observer point.
Figure 4.6 shows ﬁelds vs. range variations for both a tilted Gaussian source and
a planar array. The effects of the excitations in these plots are clearly observed.
The ﬂat Earth scenario obviously is the simplest propagation scenario for the an-
alytical ray model. Unfortunately, even this simplest scenario may be challenging in
terms of numerical modeling.
Both SSPE and FEMPE are restricted with the paraxial propagation. Their
narrow- and wide-angle versions can handle waves propagating with vertical
angles up to ±15◦and ±45◦, respectively. This means that, depending on the

52
WAVE PROPAGATION AT SHORT RANGES
0
500
1000
1500
0
0.02
0.04
0.06
0.08
0.1
0.12
0.14
Range [m]
|Field|
Knife-Edge Problem: 4Ray vs. PEM
 
 
SSPE
4Ray
(a) 
SSPE 
4RAY 
(b) 
Figure 4.7
(Left) Fields vs. range/height, (right) ﬁelds vs. range at 80 m height for a
given tilted Gaussian source using (a) SSPE, (b) 4Ray model (one-way propagation, DBC,
f = 30 MHz, with 100 m high knife edge at 800 m range, source height is 200 m, θbw = 30◦,
θelv = −15◦, Δz = 1 m, Δx = 5 m).
source height, they are invalid at short ranges. The restrictions may become
more serious if vertically tilted beams are used (|θelv + θbw/2| ≤45◦).
The MoM suffers abrupt longitudinal truncation of the segments at both ends.
Although the propagation medium extends to inﬁnity horizontally, regions (i.e.,
segments) before the ﬁrst segment and after the last segment are neglected. Be-
cause of this, the MoM results near the source and near the observer will be
erroneous. If results near the source and observer are important, then one needs
to use a number of additional segments on both ends (a few wavelength exten-
sion would be enough).
Nevertheless, simulations are repeated for the knife edge problem with similar
scenarios. The second scenario belongs to a PEC surface and a knife edge illumi-
nated by a Gaussian source through the homogeneous atmosphere at 30 MHz. Fig-
ure 4.7 plots 3D ﬁeld maps generated via SSPE and 4Ray packages. The scenario
belongs to one-way propagation for horizontal polarization. The heights of the knife
edge obstacle at 800 m range are 100 m. The Gaussian source is at 200 m height.
The excellent visual agreement shows the power of the accurate source modeling.

CHAPTER 5
PE AND TERRAIN MODELING
5.1
Irregular PEC Terrain
Irregular terrain modeling can be implemented in the PE via several different math-
ematical approaches and it is possible for the user to choose the appropriate one for
his/her problem [2,31,48,49].
The staircase approximation of the range dependent terrain proﬁle is the best and
easiest in order to handle DBC since neither analytical terrain function nor slope
values are required; only the terrain height at each range step is needed. In this ap-
proach, on each segment of the constant height, the vertical ﬁeld proﬁle is calculated
in the usual way, applying the desired BCs on the ground surface, and then, the ﬁeld
values are simply set to zero inside the terrain. This approach provides satisfactory
results in the approximate sense because the BCs on sloping facets are not properly
taken into account, and also, the corner diffraction is ignored. Figure 5.1 shows
the staircase approximation of irregular terrain. By choosing small Δz and Δx, the
model approaches to the exact irregular terrain.
There are more accurate approaches in the literature to the modeling of sloping
facets by representing the terrain as a sequence of piecewise linear functions, or
by employing coordinate transformations, which achieve conformal mappings over
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
53

54
PE AND TERRAIN MODELING
irregular terrain 
z 
z 
Height 
Height 
Range 
Range 
irregular terrain 
irregular terrain 
Height 
Fixed height and increments 
z 
z 
x 
x 
Adaptive height and increments 
Xmax 
Xmax 
x 
Figure 5.1
(Left) Field calculation of irregular terrain using (right-top) coordinate
transformation, (right-bottom) staircase approximation.
terrain curvature. Neumann and Cauchy BCs necessitate the use of coordinate trans-
formation which is nothing but a simple coordinate transform z′ →z, x′ →x−t(z)
where t(z) is the longitudinal terrain function along the propagation direction. Coor-
dinate transformation is used to handle irregular terrain effects. Irregular terrain can
be introduced either via a terrain height function t(z) or a terrain ﬁle which contains
range–height data pairs.
For the implementation of PE, the second-order derivative of terrain function,
t′′(z), is included in the refractive index. Note that only forward scattering effects
are taken into account in PE with this implementation. Simply, the second normal
derivative of the terrain function is added to the refractive index term to obtain irreg-
ular terrain effects.
When the coordinate transformation is used, the calculated ﬁelds are always above
ground, therefore the ﬁelds above maximum height should be eliminated. If the
staircase approximation is used, the calculated ﬁelds are above x = 0 (see Fig. 5.1
for details).
A MATLAB code FEMPE.m uses FEM over irregular terrain. Both the stair-
case approximation and coordinate transformation are taken into account. Here, the
ﬁelds inside terrain are set to zero for staircase approximation. On the other hand,
the second-order derivative of terrain function (ddfxter in TerFEMPE function) is
added to the refractivity function and x′ →x −t(z) is considered for coordinate
transformation.
5.2
PE and Impedance Boundary Modeling
Surface-wave propagation along multi-mixed propagation paths including irregu-
lar terrain proﬁles has long been a challenging wave propagation prediction prob-
lem. Early analytical models, such as the Norton (ray-optical) [50] and Wait (nor-
mal mode) [51] formulations are valid for homogeneous propagation paths over a

PE AND IMPEDANCE BOUNDARY MODELING
55
smooth spherical Earth with an impedance (Cauchy-type) BC. Propagation effects
over multi-mixed smooth paths (e.g., sea–land transitions without taking land irreg-
ularities into account) can be predicted via the Millington approach [52]. These
have been revisited, well investigated, and well documented because of novel dig-
ital communication, radar, and radio systems [3, 4, 9, 15, 16, 53]. Unfortunately,
these analytical and numerical models are not capable of handling irregular mixed
path effects. There have been a few attempts for non-smooth mixed paths such as
bluffs [54], Gaussian-shaped hilly islands [55], but realistic models and systematic
predictions have still been missing. Previous studies discussed either mixed (but
smooth) path effects or irregular (but homogeneous) terrain modeling. However,
none of them included both. (Note that irregular terrain refers to the change of
land’s height above Earth’s surface along the propagation direction, with a homoge-
neous impedance boundary, like the land or sea. On the other hand, inhomogeneous
terrain means the impedance BC changes with the range, as in a land–sea transition.)
For example, Marcus investigated the effects of irregular terrain and an inhomoge-
neous atmosphere on groundwave propagation in [56]. All of his examples were on
a homogeneous but irregular surface. Janaswamy modeled only irregular terrain ef-
fects without mixed paths in [57], and irregular and inhomogeneous terrain in [58].
However, he only presented examples for irregular terrain (e.g., a lossy Gaussian
hill). There was no inhomogeneous (mixed path) modeling. In [59], Hviid and his
friends modeled only irregular terrain effects. Although Levy’s book includes al-
most all groundwave propagation problems, there are only two examples for mixed
paths (see Figs. 9.5 and 9.7 on pages 159 and 161 in [5]), mixed path modeling
with irregular islands was missing. These are all because surface-wave modeling at
LF/MF/HF bands (i.e., from a few 100 kHz up to 30 MHz) along multi-mixed paths
with irregular land proﬁles is extremely challenging, especially in terms of numerical
difﬁculties [34].
A highly attractive and effective model for the prediction of EM wave propagation
effects above Earth’s surface is the SSPE method. The PE models a one-way, forward
propagation problem. It can be numerically discretized and solved via step-by-step
iterative marching representations from source to receiver, using the ﬁnite-difference,
FEM, or MoM approaches as well as DFT algorithms. The SSPE has been widely
used for wave propagation modeling above an irregular Earth’s surface, through an
inhomogeneous atmosphere. It has been used at upper VHF and above (i.e., 100–
150 MHz and above), especially at microwave frequencies, where DBC and/or NBC
are appropriate [5,18,60,61]. On the other hand, surface-wave propagation modeling
along multi-mixed paths at LF/MF/HF necessitates the use of an impedance BC. The
DMFT has been added to the SSPE for this purpose [62]. The SSPE has then been
extended to general irregular terrain problems [32], accelerated [63], and instabilities
removed [33]. The PE method has also been used to represent two-way propagation
problems [64–68].
The most challenging problem that still needs to be further investigated in two
dimensions is the prediction of EM wave propagation and PL variations for surface-
waves above the Earth’s surface along multi-mixed (i.e., inhomogeneous) and non-
smooth (i.e., having an irregular terrain proﬁle) paths. This has been addressed lately

56
PE AND TERRAIN MODELING
and powerful numerical simulators have been introduced [31,44,48]. First, a system-
atic investigation with characteristic applications and reliable comparisons against
SSPE was given in [31]. There, a numerical propagator based on the FEM was
developed, tested and calibrated against analytical exact (reference) data as well as
against available SSPE propagators. FEM-based surface-wave propagation package
was then introduced [44], which accounts for the signal attenuation along multi-
mixed propagation paths through a homogeneous (standard) atmosphere. This pack-
age was also tested against International Telecommunication Union (ITU) curves as
well as against the Millington curve ﬁtting method [52]. Finally, surface-wave at-
tenuation in the LF/MF/HF bands, due to successively isolated islands aligned along
sea/ocean propagation paths, was discussed in [48].
The DMFT-based SSPE algorithm, which accounts for mixed paths with impedance
BCs, is combined with the coordinate-transformation-based irregular terrain algo-
rithm in [34]. Sea–land–sea paths with irregular land pieces are numerically mod-
eled. A MATLAB-based numerical propagator is developed for this purpose. The
surface-wave attenuation due to hilly islands along multi-mixed propagation paths is
precisely predicted. Tests are done, and comparisons against the Millington package
[15] and the FEMPE algorithm with mixed paths (FEMIX) [44, 48] are given (see
Chapter 10 for Millington and FEMIX packages).
5.2.1
Discrete Mixed Fourier Transform (DMFT)
The DMFT approach is applied to the discretized vertical ﬁeld u(z, mΔx) for m =
0, ..., N. A patch is added to the SSPE algorithm to satisfy the impedance BC at the
surface [59]
U(z, 0) = A
N

m=0
rmu(z, mΔx)
(5.1)
U(z, lΔkx) = A
N

m=0
⎡
⎢⎢⎣
α2(z) sin
πlm
N

−1
Δx sin
πl
N

cos
πlm
N

⎤
⎥⎥⎦u(z, mΔx)
(5.2)
U(z, NΔkx) = A
N

m=0
(−r)N−mu(z, mΔx)
(5.3)
for l = 1, ..., N −1, where A = 2(1 −r2)/

(1 + r2)(1 −r2N)

; Δkx is the step
size to satisfy ΔkxΔx = π/N; r and −1/r are the roots of the quadratic equation,
r2 +2rα2(z)Δx−1 = 0, for vertical and horizontal polarizations, respectively. The
summations in (5.1)–(5.3) use weighted factor of 0.5 for the initial and last terms
(m = 0, m = N). The DMFT of the ﬁeld at the next range step (z + Δz) is then
obtained using
U(z + Δz, 0) = exp
 
iΔz
2k0
log r
Δx
2!
U(z, 0)
(5.4)

NUMERICAL RESULTS AND COMPARISON
57
U(z + Δz, lΔkx) = exp

iΔz

k2
0 −(lΔkx)2 −k0

U(z, lΔkx)
(5.5)
U(z + Δz, NΔkx) = exp
 
iΔz
2k0
log(−r)
Δx
2!
U(z, NΔkx)
(5.6)
for l = 1, ..., N −1. Finally, the ﬁeld u(z + Δz, mΔx) for m = 0, ..., N at the next
range step is calculated by using the inverse DMFT
u(z + Δz, mΔx) = U(z + Δz, 0)rm + U(z + Δz, NΔkx)(−r)N−m
+ 2
N
N

i=0
 
U(z + Δz, lΔkx)α2(z) sin
 πlm
N

−
1
Δx sin
 πl
N

cos
 πlm
N

α2
2(z) +
1
Δx2 sin2  πl
N

!
(5.7)
for m = 0, ..., N. Note that it is possible to eliminate (5.2) and simplify the method
by using the DST of a newly deﬁned function in terms of u(z, mΔx) and α2(z) [5].
The PE represents an initial-value problem, and a Gaussian antenna pattern with
the initial ﬁeld’s height proﬁle u(zs, x) is injected.
The ﬂowchart of the DMFT-SSPE algorithm is given in Fig. 5.2. The implementa-
tion of the DMFT-SSPE algorithm with the coordinate transformation is as follows:
The initial ﬁeld proﬁle u(zs, mΔx) is injected.
The coordinate transformation is applied to implement irregular terrain proﬁles
within the SSPE algorithm, using a terrain ﬁle.
The second derivative of the terrain function is added to the refractive index
term.
The DMFT is applied via (5.1)–(5.3) using α2(z) and U(z) is obtained.
At the next range step, U(z + Δz) is obtained from U(z) via (5.4)–(5.6).
Finally, the ﬁeld at the next range, u(z + Δz), is obtained via the application of
the inverse DMFT using (5.7).
MATLAB codes, DMFTSSPE.m and FEMPE.m, use DMFT-SSPE and FEMPE
over irregular terrain, respectively.
Here, function deterslp determines the ﬁrst-
and second-order derivatives of terrain functions of Gaussian- and irregular terrain-
shaped islands. The DMFT algorithm is available in SSPE function and the input
speciﬁcation is in PEINP.DAT ﬁle.
5.3
Numerical Results and Comparison
Both SSPE and FEMPE can handle propagation problems above the PEC or lossy
irregular terrain proﬁles through the variable atmosphere.
First scenario presented in Figs. 5.3 and 5.4 belong to the tests and comparisons
over different user speciﬁed irregular PEC terrain proﬁles through the atmosphere

58
PE AND TERRAIN MODELING
Figure 5.2
The ﬂowchart of the DMFT-SSPE algorithm.
with piecewise bilinear and trilinear vertical refractivity variations under horizontal
polarization. The maximum range on the left side of Fig. 5.3 is 60 km, the frequency
is 100 MHz, the source height is 700 m, the tilt angle is 2◦downward, and the
beamwidth is 1◦. The refractivity is bilinear, the refractivity slope is 2100 M unit-
s/km and linearly increasing up to 700 m, and then decreasing with the same slope.
The elevated duct is clearly observed. Secondly, the maximum range on the right
side of Fig. 5.3 is 50 km, the frequency is 100 MHz, the source height is 250 m, the
tilt angle is 2◦upward, and the beamwidth is 1◦. The refractivity at this time is tri-
linear, the refractivity slope is 5000 M units/km and linearly decreasing up to 400 m,

NUMERICAL RESULTS AND COMPARISON
59
Range [km] 
Range [km] 
SSPE 
FEMPE 
SSPE 
FEMPE 
Figure 5.3
3D ﬁelds vs. range/height variations through (left) bilinear, (right) trilinear
atmosphere over an irregular PEC terrain (top) SSPE, (bottom) FEMPE results (staircase
approximation, horizontal polarization).
0 
0.5 
1 
0 
500 
1000 
1500 
Field Profile 
at z = 0        
Height Above Ground [m] 
  
  
0 
0.5 
1 
Field Profile 
at z = 25 km    
0 
0.5 
Field Profile 
at z = 50 km    
0 
0.5 
1 
Field Profile 
at x = 1200 m   
  
  
SSPE 
FEM 
0 
10 
20 
30 
40 
50 
0 
0.5 
1 
Field Profile 
at x = 250 m    
Range [km] 
Figure 5.4
(Left) Vertical ﬁelds vs. height at three speciﬁed ranges, (right) horizontal ﬁelds
vs. range at two speciﬁed heights through a trilinear atmosphere over an irregular PEC terrain;
(solid) SSPE, (dashed) FEMPE.
linearly increasing between 400 m and 800 m, and then linearly decreasing with the
same slope. Figure 5.4 shows 2D vertical and horizontal ﬁeld proﬁles through a
trilinear atmosphere for comparison.
For the comparison of polarization, the SSPE propagator is used to investigate
various complex propagation problems. Various PEC irregular terrain paths are gen-
erated and propagation above irregular terrain through the standard atmosphere (in-
cluding the Earth’s curvature) is simulated under both horizontal polarization and
vertical polarization. 3D ﬁelds vs. range/height plot at 300 MHz through a standard
atmosphere is pictured in Figs. 5.5 and 5.6. Only, the SSPE map is shown but the
FEMPE map is also the same. The maximum range is 100 km, the source height
is 400 m, the tilt angle is 0.5◦downward, and the beamwidth is 0.5◦. As observed,

60
PE AND TERRAIN MODELING
Range [km] 
Range [km] 
Horizontal Polarization 
Vertical Polarization 
Horizontal Polarization 
Vertical Polarization 
Figure 5.5
Three-dimensional ﬁelds vs. range/height variations produced with SSPE at
300 MHz through a standard atmosphere over different irregular PEC terrains: (top) horizontal
polarization, (bottom) vertical polarization (coordinate transformation).
Range [km] 
Range [km] 
Horizontal Polarization 
Vertical Polarization 
Horizontal Polarization 
Vertical Polarization 
Figure 5.6
Three-dimensional ﬁelds vs. range/height variations produced with SSPE at
300 MHz through a standard atmosphere over different irregular PEC terrains: (top) horizontal
polarization, (bottom) vertical polarization (coordinate transformation).
down the propagation of the beam, reﬂection from the terrain and interference be-
tween the direct and terrain-reﬂected waves are clearly observed.
Related to the lossy irregular terrain, Fig. 5.7 belongs to a 40 km homogeneous
path with sea surface parameters σ = 5 S/m, εr = 80 having a 10 km long, 250 m
high hills. Fields vs. range/height plot at 10 MHz are produced with FEMPE. Here,
the surface-wave energy accumulates in the front slope of the hill and the signal
strength increases. The example using a full sinusoidal hill represents a tsunami wave
on the sea/ocean with these electrical parameters, or a mountain on a propagation
path over land if electrical parameters are changed to land values. Figure 5.7 shows
how energy accumulates in the front slope of the hill. It requires concave/convex

NUMERICAL RESULTS AND COMPARISON
61
Range [km] 
(c) 
(b) 
(a) 
Figure 5.7
Three-dimensional ﬁelds vs. range/height produced with FEMPE at 10 MHz
through a standard atmosphere over different irregular lossy terrains with vertical polarization;
(a) Gaussian-shaped hill, (b) half sinusoidal hill, (c) full sinusoidal hill (the hills are 10 km
long and 250 m high with surface parameter σ = 5 S/m and εr = 80).
irregularity in general to accumulate energy. Observe that half sinusoidal hill is fully
convex and the full sinusoidal hill is partially concave/convex at both sides so the
surface-wave energy accumulates in the front slope of the hill.
The next scenario belongs to triple tests performed among the SSPE package,
the Millington package [15] (prepared according to ITU Recommendations), and
FEMIX package [44, 48] (see Chapter 10 for details). PL vs. range along a three-
segment 40 km long mixed path, predicted via the three packages, is given in Fig. 5.8.
In this scenario, there is a 10 km long ﬂat island 15 km away from the transmitter
on the left side. On the top, 3D ﬁelds vs. range/height at 5 MHz, produced with
the SSPE package, is given. At the bottom, PL vs. range at different frequencies
is plotted. The surface parameters are σ = 0.002 S/m, εr = 10 for island and
σ = 5 S/m, εr = 80 for sea. As observed, the surface-wave detaches from the
surface as it propagates because of the Earth’s curvature. A small portion follows
the surface as the surface-wave. The sea–land discontinuity causes an extra sharp
detachment (energy tilt up). This tilt up explains the sharp attenuation ﬁrst mentioned
by Millington. Signal recovery also occurs at the land–sea discontinuity. The right
side of Fig. 5.8 belongs to the same scenario with a 250 m high Gaussian-shaped
hilly island. Observe that both the SSPE and FEMIX computations account for the

62
PE AND TERRAIN MODELING
Range [km] 
Range [km] 
Figure 5.8
(Top) 3D ﬁelds vs. range/height produced with SSPE, (bottom) PL vs. range
over a three-segment 40 km mixed path, a 10 km long, (left) ﬂat, (right) 250 m high Gaussian-
shaped, island is 15 km away from the transmitter with vertical polarization, (solid) FEMIX;
(dashed) DMFT-SSPE; (dots) Millington.
attenuation of the surface-wave along the ﬁrst sea path, the sharp increase in the
attenuation at the sea–land discontinuity, signal recovery in the front slope of the
island, the additional signal attenuation at the back slope of the island, and ﬁnally
the signal recovery at the land–sea discontinuity.
Range [km] 
Range [km] 
Figure 5.9
(Left) PL vs. range through a standard atmosphere over a three-segment
30 km mixed path (Gaussian-shaped islands with different heights are 15 km away from
the transmitter) at 10 MHz with vertical polarization, (solid) FEMIX; (dashed) DMFT-SSPE;
(dots) Millington-ﬂat island), (right) 3D signal vs. range/height produced with FEMPE.

NUMERICAL RESULTS AND COMPARISON
63
Range [km] 
Figure 5.10
Three-dimensional ﬁelds vs. range/height produced with SSPE and FEMPE at
10 MHz with vertical polarization through a standard atmosphere along three-segment 40 km
mixed path (a 10 km long, 250 m high Gaussian-shaped island is 15 km away from the source).
Figure 5.9 compares the effect of island height over Gaussian-shaped land. PL
vs. range over the same scenario at 10 MHz for different island heights is given.
As observed, energy accumulation in the front slope and deep signal loss at the back
slope of the island hill increase with the hill’s height. 3D ﬁelds along a three-segment
40 km mixed path are also given, that assists to explain visually the physical phe-
nomenon occurring there. Observe surface-wave propagation, energy detachment
because of the Earth’s curvature, energy tilt-up at the sea–land discontinuity, and
energy accumulation in the front slope of the island.
The next example in Fig. 5.10 belongs to wave propagation over a three-section
mixed path (sea–land–sea) with a Gaussian-shaped hilly island at 10 MHz. Here,
an elevated antenna is used (a Gaussian antenna pattern with 5◦vertical beamwidth,
tilted 2◦downward, located 500 m above the sea surface) is used to excite surface-
waves. As observed, waves hit the sea surface around 5 km; energy couples to the
surface and propagates thereafter.
The ﬁnal example in Fig. 5.11 belongs to an island with an irregular terrain proﬁle.
The SSPE is compared against FEMIX for a three-segment 40 km long mixed path
at 10 MHz. Excellent agreement between the SSPE and FEMIX results is clearly
obtained for PL vs. range.
Although examples presented here are for less than 100 km, ranges for surface-
wave propagation in the MF/HF bands extend up to 300–400 km. This could cer-
tainly be achievable but would require highly effective absorbing boundary termina-
tion in the DMFT-SSPE algorithm with coordinate transformation above the heights
of interest.

64
PE AND TERRAIN MODELING
Range [km] 
Figure 5.11
(Top) 3D ﬁelds vs. range/height produced with SSPE, (bottom) PL vs. range
over a three-segment 40 km mixed path through a standard atmosphere over an irregular lossy
terrain, a 25 km long arbitrary-shaped island is 10 km away from the transmitter with vertical
polarization, (solid) FEMIX; (dashed) DMFT-SSPE; (dots) Millington.
Roughly speaking, the computational time of the DMFT-SSPE algorithm with co-
ordinate transformation is at least 8–10 times longer compared to the standard SSPE.
Several improvements, such as matrix memory pre-allocation, a vectorization proce-
dure, and efﬁcient memory allocation are used in MATLAB coding to maximize the
performance. Some acceleration commands and procedures are also used and the
difference in computation times is reduced to less than a factor of three.
The DMFT-SSPE algorithm with the coordinate transformation modeling requires
optimization of the discretization parameters according to the frequency and the ter-
rain proﬁle. The maximum height is critical in eliminating reﬂections from the top
boundary and in reducing the computations. Second, the range step should be opti-
mized. Large steps cause phase errors and introduce non-physical oscillations; small
steps increase the computation burden. The optimum parameters used here are Δx
between 5 m and 20 m, Δz between 5 m and 40 m for various terrain structures and
frequencies.

CHAPTER 6
ANALYTICAL EXACT AND
APPROXIMATE MODELS
6.1
Wave Propagation in a Parallel Plate Waveguide
Electromagnetic problems (from nanoscale to kilometer-wide systems) are complex
in nature but the theory is well established with Maxwell equations (a few of many
classical EM books may be listed as [69–71]). The strategies for the solution of
such problems may be grouped into three; analytical modeling, numerical simula-
tions, and measurements. Measurements in EM are time consuming, expensive, and,
in most cases, extremely difﬁcult to do. A limited number of analytical solutions
are available only for a few, highly idealized problems, therefore numerical sim-
ulation becomes the only mean for almost all real-life EM engineering problems.
This is why EM modeling and simulation (EM-MODSIM) has made a signiﬁcant
progress for the last couple of decades. EM-MODSIM has been taught for sometime
worldwide in many universities. A few books about EM-MODSIM may be listed as
[3, 72–76]. EM-MODSIM approaches may be divided into two; analytical-model-
based and numerical-model-based approaches. The critical issue in EM-MODSIM
is the (model) validation, (data) veriﬁcation, and (code) calibration [2]. The best
VV&C method is to compare numerical models with accurately computed analytical
models. In this content, high-frequency asymptotics (HFA) plays an essential role in
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
65

66
ANALYTICAL EXACT AND APPROXIMATE MODELS
generating reference data [19, 77–80]. HFA models such as GO, geometric theory
of diffraction (GTD), physical optics (PO), physical theory of diffraction (PTD), and
uniform theory of diffraction (UTD), with their advantages/disadvantages and re-
gions of validity not only yield reference data, but also give physical insight into un-
derstanding EM wave scattering pieces. The two HFA tutorials published in [81,82]
review fundamental diffraction models.
In terms of solution approaches, EM problems may be grouped into three: (i)
radiation/antenna problems, (ii) scattering and radar cross-section (RCS) modeling,
and (iii) waveguiding structures. These all start with Maxwell equations and the
deﬁnition of BCs. For (i), it is better to deﬁne auxiliary scalar and vector potential
functions and to solve the equations that contain these auxiliary functions. This is
better because components of the vector potential ﬁt in practical excitations. The
scattered ﬁeld representation is used for RCS modeling in (ii) because the excitation
(i.e., the incident ﬁeld) is elsewhere. Finally, Maxwell equations are decomposed
into transverse and longitudinal components for guided wave problems in (iii). This
not only yields decomposed ﬁelds but also scalarizes and solves the problem. Eigen-
functions and eigenvalues are derived from transverse components; excitation coef-
ﬁcients are obtained from longitudinal components. Completeness and orthonormal-
ization relate these two via the well known Sturm–Liouville equation [83]. Most
EM-MODSIM studies, commercial or educational, are based on one of the listed
models.
The MoM discretizes the object under investigation into N pieces, called seg-
ments or patches, and constructs an N × N system of equations using Green’s
function of the problem [84]. This approach is closed form and stable but suf-
fers from a lack of large memory and high-speed computers.
The PE method, based on either FEM or SSPE discretization, is widely used in
complex propagation modeling [5].
The FDTD method discretizes the physical environment into small cells by re-
placing partial derivatives with their ﬁnite-difference equivalents [85–87]. It is
open form and iterative therefore suffers from stability.
The TLM method uses the circuit equivalent of Maxwell equations [88, 89].
This is also open form and iterative with similar stability problems.
This chapter reviews fundamental EM-MODSIM concepts and the widely used nu-
merical (PE and MoM) models through a reliable VV&C procedure. The philosophy
is to keep it as simple as possible so that it can be used as a basic computational elec-
tromagnetics note and to supply simple MATLAB codes so that, even beginners can
use them. In order to achieve these tasks, one of the most simple and widely used
structures is chosen as the EM-MODSIM scenario: propagation inside a parallel
plate waveguide with PEC boundaries in two dimensions [90, 91]. The same can
also be applied to a wedge waveguide [92].
Propagation inside a parallel plate waveguide is an interesting EM problem where
both analytical and numerical models can be tested one against the others.

WAVE PROPAGATION IN A PARALLEL PLATE WAVEGUIDE
67
First of all, the structure in two dimensions is non-physical; and acts as a low-
pass ﬁlter.
Green’s function solution (i.e., the EM response of a line source) is exact but
requires an inﬁnite number of eigenfunction (mode) summations [90]. This is
a numerical challenge especially in the near vicinity of the line source, but it is
excellent for the analysis of truncation errors.
Eigenfunctions (modes) are grouped into two types; propagating modes with
real eigenvalues and evanescent modes with imaginary eigenvalues. The num-
ber of propagating modes depends on the frequency and the width of the waveg-
uide.
A tilted directional antenna can also be located inside and can be modeled in
terms of modes, but the modal excitation coefﬁcients are now complex. This is
another numerical challenge, especially at high frequencies when the number
of propagating modes is high.
The modes (eigenfunctions) are global, therefore they do not suffer from local
problems, but extraction of modal excitation coefﬁcients is crucial when gener-
ating reference solutions.
An analytical exact solution can also be constructed in terms of rays which are
local wave pieces; again an inﬁnite number of ray summation is required for the
line-source excitation. This may be achieved via either eigenray speciﬁcation
or ray shooting. The solution of eigenray equations is difﬁcult especially for
rays with a high number of reﬂections from upper and lower boundaries [90].
Ray shooting is very time consuming and is highly sensitive to source/observer
locations. Their computer implementations are both numerical challenges.
Another ray-based analytical solution is the image method (IM). The IM over-
comes the numerical difﬁculties of both eigenray extraction and ray shooting
approaches but a very high number of images are required for accurate ﬁeld
computations.
One-way, FEM and/or FFT-based PE models have been used in propagation
modeling in waveguiding environments [2, 31, 93]. The PE models can han-
dle tilted and directed excitation antennas easily. However, one needs to use
wide-angle PE models since narrow-angle models suffer paraxial propagation
restriction (i.e., it is valid up to 10◦–12◦vertical propagation angles).
The two powerful time-domain (FDTD and TLM) methods may also be used
in modeling propagation inside a parallel plate waveguide. This is possible
even for very long ranges by using sliding window approaches [13, 14]. Both
line source and short dipoles can be used in wave excitation in these models,
but special care is essential for modeling a tilted and directional transmitting
antenna.

68
ANALYTICAL EXACT AND APPROXIMATE MODELS
Finally, the MoM can be used in propagation modeling inside a parallel plate
waveguide. This also requires a special treatment because the MoM has rarely
been used in resonating structures (a novel approach, called Mi-MoM, is in-
troduced in [46]). The MoM is based on the solution of an N × N system of
equations that yields currents induced on the segments. The procedure is ﬁrst
applied and currents induced by the source are obtained. Consecutive applica-
tions yield segment currents induced by other segment currents. This has to be
continued until their contributions diminish.
A hybrid, MoM plus image method (MoM-IM) increases both accuracy and
computation time. In this case, an N × N system of equations is solved once
for segment currents induced by the source. The rest is handled via the IM.
Figure 6.1
A parallel plate waveguide and source–observer locations.
The 2D parallel plate waveguide is pictured in Fig. 6.1. Here, x and z are the
transverse and longitudinal coordinates, respectively. The structure is inﬁnite along
the y-direction. The height of the waveguide is a. The PEC boundaries are assumed
for DBCs for the TEz (transverse electric with respect to z) problem and for NBCs
for the TMz (transverse magnetic with respect to z) problem (see [1] for TE/TM
discussions).
6.2
Green’s Function in Terms of Mode Summation
Green’s function problem associated with both the TEz set and the TMz set is deﬁned
by the equation
 ∂2
∂x2 + ∂2
∂z2 + k2
0

g (x, z; x′, z′) = −δ(x −x′)δ(z −z′)
(6.1)
with BCs
g(x, z; x′, z′) = 0 at x = 0, a (TEz)
(6.2)

GREEN’S FUNCTION IN TERMS OF MODE SUMMATION
69
Range [km] 
Field 
Field 
Figure 6.2
(Top) Magnetic ﬁelds vs. range, (bottom) magnetic ﬁelds vs. height with Green’s
function: TMz polarization, a = 1 m, z′ = 0, x′ = 0.3 m, k0a = 50, (solid) only propagating
modes (15 modes), (dashed) 100 modes.
∂
∂xg(x, z; x′, z′) = 0 at x = 0, a (TMz)
(6.3)
g(x, z; x′, z′) = 0 as z →±∞.
(6.4)
Here, (x′, z′) and (x, z) specify the source and observation points, respectively, δ(x)
and δ(z) are the Dirac delta functions. Green’s function g(x, z; x′, z′) can be ob-
tained as
g(x, z; x′, z′) = $g(z; z′) −2
a
∞

m=1
exp(ikzm |z −z′|)
2ikzm
B(kxmx)B(kxmx′)
(6.5)
$g(z; z′) = 0, B(x) = sin(x) (TEz)
(6.6)
$g(z; z′) = −1
a
exp(ik0 |z −z′|)
2ik0
, B(x) = cos(x) (TMz)
(6.7)
where kxm = mπ/a, kzm =

k2
0 −k2xm. The line-source-excited ﬁelds are then
given by either Ey = −iωμ0g or Hy = −iωε0g for TEz case and TMz case, respec-
tively.

70
ANALYTICAL EXACT AND APPROXIMATE MODELS
A short MATLAB code, PPlate.m, is prepared for the calculation of the ﬁeld
distribution inside the parallel plate waveguide in terms of mode summation for both
polarizations. An example is shown in Fig. 6.2. Here, ﬁelds vs. range inside a
1 m wide plate at 0.5 m is pictured. The source is at 0.3 m height. The number of
propagating modes for the sets of parameters listed in the ﬁgure is 15. The two curves
belong to 15 mode and 100 mode summations. As observed, at a distance beyond
0.6 m (i.e., after ﬁve wavelengths in distance), only propagating modes contribute.
Figure 6.2 also displays ﬁelds vs. height at two different distances inside the same
plate. As observed, the contribution of only propagating modes at a distance of three
wavelengths is not enough to build the correct ﬁeld.
6.3
Mode Summation for a Tilted Gaussian Source
A directive antenna is used in many propagation applications. This is modeled by
using a vertical, tilted Gaussian function in analytical and numerical simulations.
This tilted Gaussian source inside a PEC parallel plate waveguide at z = z′ may be
represented in terms of a modal summation as
f(x, z′) =
M

m=m0
cm(z′)vmB(kxmx)
(6.8)
where M is the highest mode that should be included for the speciﬁed excitation, vm
is the normalization constant
vm =
 a
x=0
B2(kxmx)dx
−1/2
(6.9)
and cm(z′) is the modal excitation coefﬁcient, numerically derived from the vertical
orthonormality condition as
cm(z′) = vm
 a
0
f(x, z′)B(kxmx)dx.
(6.10)
The initial ﬁeld proﬁle f(x, z′) at z′ = 0 is generated from a tilted Gaussian pattern
f(x, 0) = exp

ik0x sin θelv −(x −x′)2
w2

(6.11)
where w =
√
2 ln 2/(k0 sin(θbw/2)). The tilted Gaussian antenna pattern is speci-
ﬁed by its vertical position (x′), beamwidth (θbw), and tilt (elevation) angle (θelv).
Note that B again shows either a sine or cosine function behavior, starting from
either m0 = 1 or m0 = 0 for horizontal (TEz) and vertical (TMz) polarizations,
respectively. The number of modes would be ﬁnite for numerical computation. It
is common to choose a vertically extending Gaussian function with the arbitrary lo-
cation, having a vertical elevation angle in the range of ±90◦. Note that the modal

A HYBRID RAY + IMAGE METHOD
71
Range [km] 
Field 
Field 
Figure 6.3
(Top) Electric ﬁelds vs. range, (bottom) electric ﬁelds vs. height with the mode
summation (M = 40) for a tilted Gaussian source: TEz polarization, a = 1 m, z′ = 0,
x′ = 0.3 m, k0a = 50, θbw = 40◦, θelv = −10◦.
excitation coefﬁcient cm is real for a real source function without any tilt, and be-
comes complex if there is a tilted source.
A MATLAB code, PPlate_Tilt.m, is prepared for the calculation of the ﬁeld dis-
tribution inside the parallel plate waveguide in terms of mode summation for a tilted
Gaussian source. An example for horizontal polarization is shown in Fig. 6.3. Here,
ﬁelds vs. range inside a 1 m wide plate at 0.3 m is pictured. The source is at 0.3 m
height. The number of modes to create Gaussian source at the initial range is 40.
Figure 6.3 also displays ﬁelds vs. height at two different distances inside the same
plate.
6.4
A Hybrid Ray + Image Method
The image method can be used to satisfy an inﬁnite number of reﬂections with an
inﬁnite number of images between two plates. The images are placed with respect to
the position of the plates. The unit ﬁeld (Ey for TEz case; Hy for TMz case) can be

72
ANALYTICAL EXACT AND APPROXIMATE MODELS
created by an incident line source at (z′, x′) as
Fi = exp(ik0r)
√k0r
(6.12)
where r =

(x −x′)2 + (z −z′)2. Note that (6.12) is suitable for far-ﬁeld region.
If near-ﬁeld region is signiﬁcant, Hankel function can be used instead of exponential
function. The ﬁrst image sources appear at (z′, −x′) with respect to x = 0 plate, and
at (z′, 2a −x′) with respect to x = a plate.
Range [km] 
Figure 6.4
(Top) Electric ﬁelds vs. range (TEz case), (bottom) magnetic ﬁelds vs. range
(TMz case) with (solid) Green’s function (100 modes), (dashed) image method (20 images):
a = 1 m, z′ = 0, x′ = 0.4 m, k0a = 50.
A short MATLAB script, PPlate_Image.m, is for the calculation of the ﬁelds in-
side the parallel plate waveguide in terms of image method. A comparison among
mode summation with Green’s function and image method for the line-source ex-
citation is done and the results are given in Fig. 6.4 for horizontal and vertical po-
larizations, respectively. The ﬁgures show ﬁelds vs. range for speciﬁed source and
observer heights. Here, 100 modes are used in mode summation and 20 images are
used in the image method. As observed, the agreement among the results is very
impressive.

NUMERICAL MODELS
73
6.5
Numerical Models
It is shown in the previous part that analytical reference data can be generated using
any of the two models, mode summations or image method.
6.5.1
Parabolic Equation Models: SSPE and FEMPE
The PE wave propagator for a parallel plate waveguide ﬁlled with air uses the PE
and represents one-way, forward propagation under the paraxial approximation (i.e.,
near-axial propagation).
The SSPE solution uses a longitudinally marching procedure with the use of DFT.
First, an antenna pattern is injected as the initial vertical ﬁeld proﬁle. Then, this
initial ﬁeld is propagated longitudinally and the transverse ﬁeld proﬁle at the next
range is obtained for n = 1
u(z + Δz, x) = F −1 {C(kx)F {u(z, k)}}
(6.13)
where C(k) = exp

−ik2Δz/

k0 +

k2
0 −ck2

. Here, F refers to the discrete
sine/cosine transform (DST/DCT) while considering (TEz/TMz) BCs, and kx is the
spectral variable. The parameter c is 0 (1) for the narrow (wide)-angle model. The
new proﬁle u(z +Δz, x) is then used in (6.13) as the initial proﬁle and the procedure
is repeated; the proﬁle u(z + 2Δz, x) at the next range is obtained. The procedure
is repeated continuously until the propagator reaches the desired range. A MATLAB
module, PPlate_SSPE.m, is available for the calculation of ﬁelds vs. range or height
at a given height or range using the SSPE method.
A FEMPE is based on the division of the vertical proﬁle between lower plate at
x = 0 and upper plate at x = a into nodes. A vertical antenna pattern is propa-
gated longitudinally using the Crank–Nicolson method. See Section 3.6 for details.
A MATLAB module, PPlate_FEMPE.m, is available for the calculation of ﬁelds
vs. range or height at a given height or range using the FEMPE method.
Fields vs. range/height simulated via narrow- and wide-angle SSPE models are
shown in Fig. 6.5 for horizontal and vertical polarizations, respectively. A downward
tilted Gaussian beam hits the lower plate ﬁrst and it then bounces back and hits
the upper plate. As observed, there is a signiﬁcant difference between these two
plots. In order to see which is accurate, the same ﬁelds vs. range/height plot is
produced and reference data is generated via the mode summation model for a tilted
Gaussian source. As observed, the agreement between wide-angle SSPE and the
reference data is impressive. Two vertical cuts are taken from these plots and are
shown separately in Fig. 6.6 as ﬁelds vs. height at a constant range. These plots
show that the agreement between the analytical reference solution and the wide-
angle SSPE is better and that there is disagreement with the narrow-angle SSPE.
Assuming a horizontally polarized Gaussian source at 1 GHz with 3 dB beamwidth
of 7◦, located at mid-height and tilted 30◦downward, inside a 8 m wide parallel plate
PEC waveguide, the performances of narrow- and wide-angle PE tools with respect
to the analytical result are illustrated in Fig. 6.7 by means of 3D ﬁeld maps. The

74
ANALYTICAL EXACT AND APPROXIMATE MODELS
Range [km] 
Range [km] 
Range [km] 
(c) 
(c) 
(b) 
(b) 
(a) 
(a) 
Figure 6.5
Fields vs. range/height for a tilted Gaussian beam, (a) narrow SSPE, (b) wide
SSPE, (c) Green’s function (41 modes): (Left) TEz case (horizontal polarization), (right)
TMz case (vertical polarization), a = 1 m, z′ = 0, x′ = 0.3 m, k0a = 50, θbw = 40◦,
θelv = −15◦.
Field 
Field 
Field 
Field 
Figure 6.6
Fields vs. height for a tilted Gaussian beam, (left) horizontal polarization, (right)
vertical polarization, a = 1 m, z′ = 0, x′ = 0.3 m, k0a = 50, θbw = 40◦, θelv = −15◦
at z = 3λ, and at z = 15λ, (solid) Green’s function (41 modes), (dashed) narrow SSPE,
(dashed-dotted) wide SSPE.
two ﬁeld maps generated with the narrow-angle FEMPE and SSPE tools seem to be
logical and physical. A down-tilted Gaussian beam is bouncing up and down while
longitudinally propagating with the interference patterns exactly alike shown there.
On the other hand, the true 3D wave patterns are shown on the right side of Fig. 6.7.
The analytical exact solution is exactly the same as the FEMPE and SSPE results

NUMERICAL MODELS
75
Range [km] 
Range [km] 
(c) 
(c) 
(b) 
(b) 
(a) 
(a) 
Figure 6.7
Electric ﬁelds vs. range/height for a tilted Gaussian beam, (left) narrow case,
(right) wide case, (a) FEMPE, (b) SSPE, (c) Green’s function (49 modes): TEz polarization,
a = 8 m, z′ = 0, x′ = 4 m, k0a = 168, θbw = 7◦, θelv = −30◦.
and is not shown here. Hence, these results validate the accuracy of the wide-angle
FEMPE and SSPE, and show that the narrow-angle FEMPE and SSPE cannot handle
large tilt angles. To validate the narrow-angle model, the angle must be constrained
to be less than 10◦–15◦while considering both beamwidth and tilt angles. Figure 6.8
shows vertical ﬁeld proﬁles computed via analytical, FEMPE, and SSPE models in
a highly oscillatory region at z = 100λ. The results computed via narrow-angle
FEMPE and SSPE tools are compared against the reference solution. As observed,
FEMPE and SSPE agree very well but they both disagree with the reference (analyt-
ical) solution. This is an interesting example since it shows that both FEMPE and
SSPE pass the veriﬁcation test but fail the (model) validity test.
6.5.2
Method of Moments
The MoM [84] is one of the oldest numerical EM methods. In this method, a dis-
crete model of the object under investigation is ﬁrst created from small (compared
to wavelength) pieces, called segments or patches, and then an N × N system of
equations is built with N unknown segment/patch currents, N known segment volt-
ages calculated from Green’s function of the problem, and known (analytically, but
requires numerical computation) N × N segment/patch impedances (it requires N 3
operations). The model is closed form and stable but necessitates large memory and
high-speed computers especially for high-frequency applications. Also, it requires
the derivation of Green’s function of the problem.

76
ANALYTICAL EXACT AND APPROXIMATE MODELS
Range [km] 
Range [km] 
Figure6.8
Electricﬁeldsvs. heightat z = 100λ for a tiltedGaussianbeam, TEz polarization,
a = 8 m, z′ = 0, x′ = 4 m, k0a = 168, θbw = 7◦, θelv = −30◦(left) narrow case, (right)
wide case, (solid) Green’s function (49 modes), (dashed) SSPE, (dashed-dotted) FEMPE.
x
z
Source
Observation
point
)
,
(
x
z
)
,
(
x
z
c
c
0
 
x
a
x  
Source
point
m
n
mn
m
nˆ
z
'
Figure 6.9
A parallel plate waveguide and the source/observer for the MoM (ρm: source
segment, ρn: observer segment).
The MoM can be used to ﬁnd the propagation of horizontally (TEz case) and ver-
tically (TMz case) polarized waves by using the electric ﬁeld integral equation and
the magnetic ﬁeld integral equation, respectively. Unfortunately, the MoM suffers
from resonances in waveguiding structures [94], therefore its direct application is a
challenge. Recently, a novel multiple MoM model (Mi-MoM) is introduced for this
purpose [46]. In this method, the integral equation is converted to the corresponding
matrix equation via the discretization of the plates at x = 0 and x = a (see Fig. 6.9).
The lengths of the line segments on the plates are chosen to be less than one-tenth of
the wavelength to satisfy the surface current constant at each line segment. Then, an

NUMERICAL MODELS
77
N ×N system of equations is constructed with the unknowns of N segment currents
and the system is solved numerically.
The point-matching MoM technique [84,95] with the closed form matrix equation
[V ] = [Z] [I] where [I] contains the unknown segment currents, [V ] corresponds to
excitation voltage matrix using the incident ﬁeld evaluated at the midpoints of each
line segment, [Z] is the N × N impedance matrix for the PEC plate. Using segment
currents, the scattered ﬁelds are obtained. Finally, ﬁelds at a speciﬁed observation
point are calculated in terms of the incident ﬁeld and scattered ﬁelds caused by the
source-induced segment currents on plates.
The Mi-MoM procedure for propagation modeling inside resonating structures is
based on taking into account multiple induced segment currents and may be outlined
as follows [46]:
First, discretize the upper and lower boundaries. Use N/2 segments for the
lower boundary and N/2 segments for the upper boundary. Label all segments
from 1 to N.
Calculate segment currents [I] from [I] = [Z]−1 [V ] and calculate the scat-
tered and total ﬁelds using either Einc
y
or Hinc
y
for TEz and TMz polarizations,
respectively.
For a given source point, calculate the distances to all segments and all segment
voltages, using either Einc
y
or Hinc
y
for TEz and TMz polarizations, respec-
tively. This will yield [V ].
Calculate the impedance matrix Zmn.
The segment currents induced by the external source on the upper plate excite
ﬁelds on segments on the lower plate and vice versa. For the ﬁrst segment of the
lower plate, calculate the distances to all segments on the upper plate and the
segment voltages, using either Einc
y
or Hinc
y
for the TEz and TMz polarizations,
respectively. Repeat this for all segments on the lower plate and ﬁnd the voltages
on the upper plate caused by the segments on the lower plate.
Do the same for the segments on the upper plate and ﬁnd the voltages on the
lower plate caused by the segments on the upper plate. This will yield second
round [V ].
Use the same impedance matrix Zmn and calculate second round segment cur-
rents [I] from [I] = [Z]−1 [V ] and scattered and total ﬁelds for TEz and TMz
polarizations, respectively.
Repeat the procedure and ﬁnd third round segment currents and scattered and
total ﬁelds caused by these currents.
Repeat the whole procedure until the desired accuracy is reached.
An alternative way is to ﬁnd the ﬁrst round segment currents and then use the
image method. First, all segment currents of the upper and lower plates are obtained.

78
ANALYTICAL EXACT AND APPROXIMATE MODELS
Then, the boundaries are removed and image segments are added with respect to the
upper and lower plates. Finally, the ﬁeld contributions from the currents of the seg-
ments and image segments are superposed at the receiver. A short MATLAB script,
PPlate_MoM.m, for the Mi-MoM calculation of ﬁelds vs. range/height at a given
height/range point is prepared. The classical MoM can also be used together with the
IM in hybrid form. This is achieved by ﬁnding segment currents once and then using
images of all segments on both sides of the boundaries. A short MATLAB script,
PPlate_MoM2.m, for the hybrid MoM+IM calculation of ﬁelds vs. range/height at a
given height/range is also available.
An example of the Mi-MoM procedure with 40 iterations is given in Fig. 6.10.
The result is compared to mode summation with 42 modes. As shown, very good
agreement is obtained.
Range [km] 
Figure 6.10
Fields vs. range/height (TEz case): (top) mode sum with 42 modes, (bottom)
Mi-MoM with 40 iterations: a = 1 m, z′ = 0, x′ = 0.3 m, k0a = 50, dz = dx = 0.01 m,
θbw = 45◦, no tilt.

CHAPTER 7
WAVE PROPAGATION INSIDE
THREE-DIMENSIONAL RECTANGULAR
WAVEGUIDE
7.1
Introduction
Parabolic equation models have been widely used in solving both underwater acous-
tic and tropospheric EM wave propagation problems since its ﬁrst introduction of
the PE method [18]. The PE models one-way, forward EM propagation over a non-
ﬂat, lossy Earth’s surface through a non-homogeneous atmosphere. It is simple to
understand, code, and apply, and highly effective in complex wave environments. It
is impossible to include all contributions in this area; the list would always be in-
complete. The book by Levy [5] might be a good source for the PE model and early
studies on propagation modeling. A few simple but highly effective propagation vir-
tual tools have also been introduced [10,12,96]. There are also two-way PE models
[2, 27, 43, 67, 68], which have been effectively used in propagation problems where
backward scattering is non-negligible.
The growth of mobile communication systems in recent years necessitates re-
alistic 3D propagation modeling in urban regions as well as in tunnels. The PE
method has also been used for this purpose. The 3D calibration of various PE mod-
els/codes is therefore essential before their applications in complex realistic envi-
ronments (as done in two dimensions, see [2, 27, 31]). The calibration should be
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
79

80
WAVE PROPAGATION INSIDE THREE-DIMENSIONALRECTANGULAR WAVEGUIDE
performed against available analytically exact models, which should be accurately
numerically computed. The classical rectangular waveguide problem is chosen for
this purpose. Rectangular and/or circular waveguides may also be chosen, but this
structure is chosen to eliminate the discretization errors (in fact, the waveguide may
have an arbitrary cross-section in the PE models, but in that case, an analytical ref-
erence solution is not available). Propagation inside this waveguide can be exactly
modeled in terms of modal summation and any given source distribution can be ana-
lytically represented as accurately as desired. Source tilt can also be included which
makes modal excitation coefﬁcients complex.
In this chapter, the 3D SSPE, FEMPE, and alternate direction implicit parabolic
equation (ADIPE) algorithms are developed, tested against analytically exact data,
and calibrated. The 3D rectangular waveguide is used as the canonical structure and
its solutions are used as the reference.
7.2
Three-Dimensional Rectangular Waveguide Model
Consider 3D propagation inside a rectangular cross-section waveguide with non-
penetrable boundaries, located longitudinally along the z-direction (see Fig. 7.1).
Figure 7.1
The 3D rectangular waveguide, the coordinates, and a tilted source distribution.
This waveguide acts as a high-pass ﬁlter and the cutoff frequency is determined by
the width (a) and height (b) of the waveguide (0 < x < a, 0 < y < b). The rectangu-
lar waveguide is a canonical EM structure and both Green’s function (source-driven)
and eigenvalue (source-free) solutions for the TE and TM cases are well established.
Any given initial source distribution inside a rectangular waveguide can be repre-
sented in terms of a modal summation as [97]
ψ(x, y, z) =
N1

p=p1
N2

q=q1
cpqB
pπ
a x

B
qπ
b y

exp(iβpqz)
(7.1)
where βpq =

k2
0 −(pπ/a)2 −(qπ/b)2 is the longitudinal propagation constant,
N1 and N2 are the total number of modes of the directions x and y; k0 is the free-

THREE-DIMENSIONAL PARABOLIC EQUATION MODELS
81
space wavenumber, and cpq is the modal excitation coefﬁcient derived from the or-
thonormality condition as
cpq = vpq
 a
x=0
 b
y=0
uin(x, y)B
pπ
a x

B
qπ
b y

dxdy
(7.2)
vpq is the normalization constant
vpq =
  a
x=0
 b
y=0
B2 pπ
a x

B2 qπ
b y

dxdy
!−1
(7.3)
and uin(x, y) is the initial ﬁeld proﬁle, which is generated from a Gaussian antenna
pattern
uin(x, y)
= exp

ik0x sin θelvx −(k0 sin(θbwx/2)(x−xs))2
2 ln 2

× exp

ik0y sin θelvy −(k0 sin(θbwy/2)(y−ys))2
2 ln 2

(7.4)
speciﬁed by its position (xs, ys), beamwidth (θbwx,bwy), and tilt (elevation) angle
(θelvx,elvy). Note that B shows either a sine or a cosine function starting from either
p1 = q1 = 1 or p1 = 1, 0; q1 = 0, 1 for horizontal and vertical polarizations,
respectively.
A short MATLAB script, Rect_Waveguide.m, that calculates ﬁeld variations inside
a 3D rectangular waveguide using the modal summation approach for a speciﬁed
accuracy, is written to serve as the analytical reference data.
7.3
Three-Dimensional Parabolic Equation Models
The 3D PE wave propagator for rectangular waveguides ﬁlled with air uses the stan-
dard PE
 ∂2
∂x2 + ∂2
∂y2 + 2ik0
∂
∂z

u(x, y, z) = 0
(7.5)
representing one-way, forward propagation under the paraxial approximation (i.e.,
near-axial propagation). Here, x and y stand for the transverse coordinates, and
z is the longitudinal coordinate. Since the direction of wave propagation is pre-
dominantly along the z-axis, the reduced function u(x, y, z) is used by separating
the rapidly varying phase term from ψ(x, y, z) = exp(ik0z)u(x, y, z) which corre-
sponds to either electric or magnetic ﬁelds for the horizontal (TM) and vertical (TE)
polarizations, respectively.
7.3.1
SSPE Model
The standard SSPE uses a longitudinally marching procedure [5] with the use of the
DFT. First, an antenna pattern representing the initial 2D ﬁeld proﬁle is injected (the
source proﬁle may be given in either the spatial or transverse wavenumber domains).

82
WAVE PROPAGATION INSIDE THREE-DIMENSIONALRECTANGULAR WAVEGUIDE
This initial ﬁeld, given in (7.4), is then longitudinally propagated, and the transverse
ﬁeld proﬁle at the next range is obtained. This new proﬁle is then used as the initial
proﬁle for the next step and the procedure is repeated until the propagator reaches
the desired range given as [97]
u(x, y, z + Δz) = F −1 {C(kx)C(ky)F {u(x, y, z)}}
(7.6)
where C(k) = exp

−ik2Δz/

k0 +

k2
0 −con × k2

, F refers to DST/DCT
while considering BCs, kx and ky are the spectral variables. The parameter con is
either 0 or 1 for the narrow- and wide-angle cases, respectively. The 2D transverse
ﬁelds are obtained along z at each range step of Δz. Dirichlet BC and Neumann BC
(DBC/NBC) are considered for horizontal and vertical polarizations, respectively
(for the PEC case) [31].
7.3.2
FEMPE Model
The idea of FEMPE model is ﬁrst to divide the 2D transverse-domain into subdo-
mains. Using the initial ﬁeld proﬁle, which is generated from a Gaussian antenna
pattern given in (7.4); the approximated ﬁeld values at discrete nodes in domain are
uap(x, y, z) =
N

e=1
2

j=1
ce
j(x, y)Be
j(z)
(7.7)
where N is the number of elements, ce
j(x, y) indicates the coefﬁcients of the un-
known function, and Be
j(z) are the piecewise linear Lagrange basis functions. The
approximated ﬁelds are then longitudinally propagated by the application of Crank–
Nicolson approach, which is based on the improved Euler method with DBC and
NBC at each range for horizontal and vertical polarizations, respectively (PEC case)
[31,44,97].
7.3.3
ADIPE Model
The ADIPE is a ﬁnite-difference method introduced for the solution of 2D or 3D
complex EM propagation problems with the following second-order derivative and
central-difference approximation [97,98]
un
m,l + rx

un
m+1,l −2un
m,l + un
m−1,l

+ ry

un
m,l+1 −2un
m,l + un
m,l−1

= un+1
m,l −rx

un+1
m+1,l −2un+1
m,l + un+1
m−1,l

−ry

un+1
m,l+1 −2un+1
m,l + un+1
m,l−1

(7.8)
where rx = Δz/

4ik0Δx2
, ry = Δz/

4ik0Δy2
. The equations have a relatively
simpler structure and two 1D problems are solved at each range step for the 2D PE.
First, one direction is kept ﬁxed; and then the other. In this way, both equations can

TESTS AND CALIBRATION
83
be written in tridiagonal matrix forms. The 2D ADIPE model [98] uses the following
difference equations for 1 < n < Nz
−ry

un+1/2
m,l−1 + un+1/2
m,l+1

+ (1 + 2ry) un+1/2
m,l
= rx

un
m−1,l + un
m+1,l

+ (1 −2rx) un
m,l
, for 1 < m < Nx
(7.9)
−rx

un+1
m−1,l + un+1
m+1,l

+ (1 + 2rx) un+1
m,l
= ry

un+1/2
m,l−1 + un+1/2
m,l+1

+ (1 −2ry) un+1/2
m,l
, for 1 < l < Ny
(7.10)
where Nx, Ny, Nz are the node numbers on the x-, y-, and z-axes. The ADIPE
model is easier to solve than the traditional Crank–Nicolson approach.
7.4
Tests and Calibration
Field distributions inside square, rectangular, and circular cross-section waveguides
are well known. All PE-based techniques (SSPE, FEMPE, and ADIPE) manage to
give cross-sectional ﬁeld distributions as long as the operating frequency is good
above the cutoff frequency of the dominant mode. Consider the dominant mode
(TE10) inside a rectangular waveguide; the transverse ﬁeld distribution is half-sine
as illustrated in Fig. 7.2. The sine function represents a standing wave and can be
decomposed into two exponential functions (i.e., two transverse traveling waves).
The wave vectors of these traveling waves are shown with thick black block arrows.
Three cases are shown in Fig. 7.2. The wave vectors are almost vertical (horizontal)
if the frequency is very close to (far from) the cutoff frequency. The red arrows
show the validity region (angular spectrum) of the PE models. The angular validity
range is approximately ±15◦to 20◦for narrow-angle PE models and ±40◦to 45◦for
wide-angle PE models, therefore any transverse ﬁeld contribution with wave vectors
beyond these angles cannot be handled with the PE models.
Figure 7.2
The transverse ﬁeld distribution of the dominant TE10 mode and the two wave
vectors for three different frequency ranges (fc is the cutoff frequency).

84
WAVE PROPAGATION INSIDE THREE-DIMENSIONALRECTANGULAR WAVEGUIDE
Figure 7.3
Three-dimensional color plots of ﬁelds vs. range–height variations inside a
parallel plate PEC waveguide: (top) exact, (middle) SSPE narrow-angle propagator, (bottom)
SSPE wide-angle propagator (Δx = 2.5 mm, Δz = 5 mm) [96].
The performance of narrow- and wide-angle SSPE tools with respect to the an-
alytical result is illustrated in Fig. 7.3 [96]. Here, a 1 m wide parallel PEC plate
waveguide is taken into account. A horizontally polarized Gaussian beam, tilted
down 45◦at 3 GHz with 3 dB beamwidth of 30◦is excited by a source located at the
mid-height of the waveguide. As observed, the wide-angle SSPE agrees very well
with the analytically exact (reference) solution. On the other hand, while it visually
seems to be physical and correct, the narrow-angle SSPE is incorrect.
A square waveguide with dimensions of 4 m × 4 m, having a cutoff frequency of
37.5 MHz is considered in Fig. 7.4. These dimensions are selected as appropriate for
the size of a typical tunnel. The frequency is 3 GHz, which means the propagation
inside the waveguide is good above the cutoff frequency. Horizontally polarized
waves (TM) are taken into account. The transverse discretization values are Δx =
0.8λ and Δy = 0.8λ, that means the waveguide is modeled using 50 × 50 cells in
the transverse-domain. The longitudinal step is Δz = 10λ. A 2D, untilted, centrally
located Gaussian spatial source is used with a beamwidth of θbw = 4.34◦. This
untilted source is represented in terms of modes of the structure and the number of
modes in the transverse-domain is 19 in the x and y directions, within a relative
maximum error of 1e-7. The relative maximum error is deﬁned as the maximum
difference in the absolute values of the Gaussian ﬁeld and the modal solution divided
by the maximum absolute value of the Gaussian ﬁeld. The modal solution is assumed
as the reference.
Propagation inside the waveguide is computed with the SSPE, FEMPE, and ADIPE
simulators. Figure 7.4 shows the cross-sectional ﬁeld distributions of the untilted and
tilted sources at three different ranges. The rows correspond to the reference, SSPE,

TESTS AND CALIBRATION
85
Figure 7.4
Two-dimensional cross-sectional ﬁeld distributions of untilted and tilted sources:
From top to bottom, the rows are for the reference, SSPE, FEMPE, and ADIPE simulations.
From left to right, the columns are for 50 m, 100 m, and 200 m ranges, respectively. Source
position:(xs, ys, zs) = (20λ, 20λ, 0); f = 3 GHz, θbw = 4.34◦, (left) θelvx,elvy = (0, 0),
(right) θelvx,elvy = (−0.5◦, 0.5◦), TM Polarization, Δx = Δy = 0.8λ, Δz = 10λ.
FEMPE, and ADIPE solutions; the columns belong to ranges of 50 m, 100 m, and
200 m, respectively. According to the results in these ﬁgures, the SSPE and FEMPE
are more accurate than the ADIPE for the same discretization parameters [97].
When the source position is not centrally located inside the waveguide, the wide-
angle SSPE model gives the best approximation among the models/simulators. Fig-
ure 7.5 shows 2D cross-sectional ﬁeld distribution for the source position (xs, ys) =
(20λ, 20λ) and tilt angles of θelvx,elvy = (3◦, 4◦) by using the wide-angle SSPE
model. At this time, the number of modes in the transverse-domain is (N1, N2) =
(47, 49) in the x and y directions, respectively, within a relative maximum error of
1e-7. Figure 7.5 also shows ﬁeld distribution on a 2D plane cut longitudinally (i.e.,
on the zy-plane) at x = 20λ for the set of parameters, obtained by using the modal
solution and the wide-angle SSPE model. As observed, the agreement between the
two models is impressive.
Two-dimensional ﬁeld distributions for different ranges are mostly good for vi-
sualization purposes and are not good for precise comparisons. Comparisons are
performed by using either 1D ﬁeld variations or the root mean square (rms) error
with respect to the modal solution. The rms error is deﬁned as the square root of the
sum of the squares of the differences between the approximated ﬁeld and the modal
solution, divided by the number of nodes (Nx × Ny). Longitudinal ﬁeld variations
at the center of the waveguide computed with four different approaches are plotted
in Fig. 7.6. As observed, there is a very good agreement among the reference, SSPE,
and FEMPE solutions. The ADIPE solution also agrees with the reference data,

86
WAVE PROPAGATION INSIDE THREE-DIMENSIONALRECTANGULAR WAVEGUIDE
(a) 
(b) 
Figure 7.5
Two-dimensional cross-sectional ﬁeld distributions. (Left) The ﬁrst row is the
reference solution and the second row is the wide-angle SSPE simulation. From left to right,
the columns are 50 m, 100 m, and 200 m ranges. (Right) Fields at x = 20λ. Source position
is xs = 20λ, ys = 20λ, zs = 0; f = 3 GHz, θbw = 4.34◦, θelvx,elvy = (3◦, 4◦), TM
polarization, Δx = 0.8λ, Δy = 0.8λ, Δz = 10λ. The rms error at 50 m is 0.96%; at 100 m,
3.80%; at 200 m, 7.44%.
Figure 7.6
Longitudinal ﬁeld variations at the center of the rectangular waveguide. Source
position is xs = 20λ, ys = 20λ, zs = 0; f = 3 GHz, θbw = 4.34◦; TM polarization;
Δx = 0.8λ, Δy = 0.8λ, Δz = 10λ.
but not as well as the other two solutions for the set of discrete parameters used.
Moreover, transverse ﬁeld variations at y = 20λ of an untilted source are taken into
consideration. All numerical methods are compared with the modal solutions at three
different ranges. As observed, the SSPE and FEMPE models agree very well with
the reference solution. This agreement is obtained in Fig. 7.7, which shows the ver-
tical ﬁeld proﬁle with respect to the x-axis at the z = 0, z = 100 m, and z = 200 m
ranges [97].
Moreover, standard PE models cannot show the effects of the interaction between
the forward and backward waves, especially if there are obstacles inside waveguides.

TESTS AND CALIBRATION
87
Figure 7.7
Transverse ﬁeld variations (y = 20λ) of an untilted source at different ranges:
(a) z = 0 m, (b) z = 100 m, (c) z = 200 m using the reference, SSPE, FEMPE, and ADIPE
simulations; source position is xs = 20λ, ys = 20λ, zs = 0; f = 3 GHz, θbw = 4.34◦;
θelvx,elvy = (0, 0); TM polarization; Δx = 0.8λ, Δy = 0.8λ, Δz = 10λ.
In the presence of such obstacles, the effects of forward and backward waves must
be considered in order to get more accurate results [93]. At this time, the forward PE
model computes as the previous model. Then, the total ﬁeld is obtained by super-
posing the forward and backward ﬁelds. The backward ﬁelds can be found by taking
the tangential ﬁelds of the obstacle to be zero while considering the same algorithm
of the forward PE model. Figure 7.8 shows 2D cross-sectional ﬁeld distributions for
various ranges inside a rectangular waveguide terminated at 200 m range. As ob-
served, good agreement is obtained by using the two-way 3D PE models. Note that
the fastest method is the SSPE; roughly speaking, the ADIPE simulations take twice
the time of the SSPE simulations, and the FEMPE is the slowest method (nearly
a factor of two slower for the sets of parameters used in the simulations). This is
because
The SSPE uses the 2D DST (TM) or DCT (TE) at each range step.
The ADIPE solves two tridiagonal matrices (for the x and y directions) at each
range step.
The FEMPE solves N × N matrices (N = Nx × Ny) at each range step.

88
WAVE PROPAGATION INSIDE THREE-DIMENSIONALRECTANGULAR WAVEGUIDE
Figure 7.8
Two-dimensional cross-sectional ﬁeld distributions inside a rectangular
waveguide terminated at 200 m range. From top to bottom, the rows show the reference
solution, SSPE, and FEMPE simulations. From left to right, the columns are 50 m, 100 m, and
150 m ranges. Source position is xs = 20λ, ys = 20λ, zs = 0; f = 3 GHz, θbw = 4.34◦;
θelvx,elvy = (0, 0); TM polarization; Δx = 0.8λ, Δy = 0.8λ, Δz = 10λ.
For PEC boundaries, both the ADIPE and FEMPE matrices are range indepen-
dent, therefore they can be calculated once.
The SSPE range steps can be chosen to be much larger than the ADIPE and
FEMPE.
The range step sizes of the ADIPE and FEMPE are similar because they are
both based longitudinally on the ﬁnite-difference approach.
The transverse discretization is similar for all three methods.
It should be noted that the priorities would change in realistic tunnel environments
with lossy (CBC) irregular walls and non-ﬂat bottom irregularities, therefore one
may suggest the use of
The SSPE for PEC walls and irregularities; this would be the fastest and most
accurate.
The ADIPE and FEMPE for CBC walls and irregularities; ADIPE would be
faster, but FEMPE would be more accurate. They both would be a few orders
slower than the SSPE.
The SSPE with the DMFT for CBC walls and irregularities.

CHAPTER 8
TWO-WAY PE MODELS
8.1
Formulation of Two Way FEMPE Method
The standard PE method is a one-way, forward propagation model, because of ignor-
ing the backward propagation term. The standard PE model cannot reﬂect the effect
of the interaction between the forward and backward waves, especially if there are
valleys or hills with steep slopes along the propagation path. In the presence of such
obstacles, the effects of not only forward but also backward-reﬂected, refracted, and
diffracted waves must be very well predicted to be able to get reliable results.
The algorithm can be applied to a variable terrain by using staircase approxima-
tions, as illustrated in Fig. 8.1. Two-way PE algorithm is as follows:
Step 1: The ﬁelds inside terrain are set to zero for staircase approximation. If
the vertical ﬁeld meets a vertical terrain facet, it is split into two components
propagating in forward and backward directions.
Step 2: The forward ﬁeld continues in the usual way after setting it to zero on
the vertical terrain facet (see Fig. 8.1). In other words, the ﬁelds (at z + Δz)
obtained from the previous vertical ﬁeld (at z) are set to zero inside the terrain
between x = 0 and x = xter(z + Δz).
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
89

90
TWO WAY PE MODELS
Figure 8.1
(Top) Two-way PE propagation model with forward (right arrows) and backward
(left arrows) propagating waves generated from terrain reﬂections, (bottom) the vertical ﬁelds
split into forward and backward ﬁelds.
Step 3: The ﬁeld must be partially reﬂected from the terrain facet, therefore
ﬁrst the initial ﬁeld of the backward ﬁeld is obtained by imposing the BCs at
the facet (i.e., the tangential ﬁeld must be zero on the PEC facet), and then this
initial ﬁeld is marched back in the −z direction by reversing the signs of k0
and Δz. Namely, the backward-propagating waves are initiated from the waves
between x = xter(z) and x = xter(z + Δz), and then, propagated in the
reverse direction (see Fig. 8.1).
Step 4: The same form of the PE is derived, as expected, for the reduced
function in the backward propagation, but the original ﬁeld is expressed as
ψb(z, x) = ub(z, x) exp(−ik0z).
The two-way FEMPE (2W-FEMPE) approach is the iterative implementation of the
one-way FEMPE (1W-FEMPE) algorithm by simply rotating the direction of prop-
agation in a forward–backward manner to estimate the multiple-reﬂection effects.
Both forward and backward ﬁelds continue to march out in their own propagation
directions. Each time the wave hits a terrain facet, it is again split into forward and
backward components. The total ﬁeld inside the domain is then determined by the
superposition of the backward and forward ﬁelds at each range step. It is useful to
note that the convergence of the algorithm is achieved because, as the iterations are
carried out, the ﬁeld contributions of the multiple reﬂections decrease with regard to

FORMULATION OF TWO WAY SSPE METHOD
91
the 1/√r term in 2D Green’s function. The convergence of the algorithm is checked
against a certain threshold criterion, which compares the total ﬁelds at each iteration.
8.2
Formulation of Two Way SSPE Method
The two-way SSPE (2W-SSPE) algorithm is basically the iterative implementation
of the one-way SSPE (1W-SSPE) by simply switching the direction of propagation
in a forward–backward manner to estimate the multiple-reﬂection effects. During
forward propagation, the split-step solution is employed to march the solution. How-
ever, it is evident with regard to the physics of the problem, the ﬁeld must be partially
reﬂected from the terrain facet. As 2W-FEMPE, this is achieved in the two-way al-
gorithm in such a way that ﬁrst the initial ﬁeld of the backward ﬁeld is obtained
by imposing the BCs at the facet (i.e., the tangential ﬁeld must be zero on the PEC
facet), and then this initial ﬁeld is marched back in the −z direction by reversing the
signs of k0 and Δz.
8.3
Flat Earth with Inﬁnite Wall
Calibration tests are performed both 2W-FEMPE and 2W-SSPE codes over ﬂat Earth
with the inﬁnite wall against data generated via image method as well as GO+UTD
solutions. In all scenarios, the frequency is set to 3 GHz.
A MATLAB code, twowaype.m, is available for the calculation of PF over a PEC
ground with a vertically inﬁnite-extend wall. Here, 2W-SSPE, 2W-FEMPE, and
image methods are taken into consideration. A vertically inﬁnite-extent wall at range
40 km is described over the ﬂat Earth with PEC boundaries in Fig. 8.2. The source is
at 50 m. Excellent agreement among the results shows the effectiveness of both 2W-
SSPE and 2W-FEMPE algorithms. Also note that FEMPE necessitates smaller range
steps as compared with the SSPE method. The SSPE requires smaller height steps
for vertical polarization as compared to the horizontal polarization calculations. On
the other hand, FEMPE gives the same accuracy with larger height step size for the
vertical polarization, but still slower than the SSPE because of longitudinal marching
with much smaller range steps.
8.4
Flat Earth with Single and Double Knife Edges
The 2W-FEMPE model is validated and veriﬁed against analytical approximate mod-
els as well as the 2W-SSPE model. In the ﬁrst two scenarios, the tests are performed
against the GO+UTD results, assuming that the frequency is 3 GHz and the polar-
ization is horizontal, therefore DBC has been taken into consideration at the surface.
It is worthwhile to note that the calibration by GO+UTD is possible only at high
frequencies where the GO interpretation is valid. The ﬁrst scenario belongs to a sin-
gle PEC wall of ﬁnite height (i.e., a knife edge), illuminated by a line source over

92
TWO WAY PE MODELS
Range [km] 
Propagation Factor [dB] 
at z = 25 km 
Range [km] 
Hor. Pol. 
Ver. Pol. 
at x = 150 m 
at x = 100 m 
Figure 8.2
(Left/right-top) PF vs. range/height with horizontal polarization, (right-bottom)
ﬁelds vs. height at z = 25 km with different polarizations. (SSPE: Δz = 100 m, FEMPE:
Δz = 12.5 m).
a PEC ground and in the free space. The approximate solution of this well known
and canonical problem in the ﬁeld of diffraction theory is available by combining
the GO technique with some special diffraction methods such as non-uniform GTD
[99], UTD [78], PTD [79]. In the GO method, the reﬂected waves from the ground
and the wall are determined by employing the principles of image theory.
Figure 8.3 presents some of the possible GO+UTD components that must be taken
into account in the GO+UTD computations. Note that double diffractions have not
been included in the GO+UTD calculations. The total ﬁeld is determined by sum-
ming the direct ray, the reﬂected rays emanating from image sources, and the rays
diffracted from the tip of the wall. Note also that these ray contributions are added
to the total ﬁeld only if the LOS condition between each source and the observation
point is satisﬁed.
The ﬁrst simulation results are presented in Fig. 8.4, assuming that the line source
is 250 m above the ground at range zs = 0. The height of the wall is 150 m, the wall
is positioned at 40 km range, and the polarization is horizontal, therefore DBC is sat-
isﬁed at the surface of the wall and the ground. The region between the source and
the wall is within the interference region where forward-, ground-, and backward-
reﬂected waves interfere. Beyond the wall, only diffracted waves appear for heights
below the source height (i.e., in the shadow region), and forward propagated and

FLAT EARTH WITH SINGLE AND DOUBLE KNIFE EDGES
93
Figure 8.3
GO+UTD modeling and some possible direct, reﬂected, and diffracted ﬁeld
components.
Range [km] 
Propagation Factor [dB] 
at z = 25 km 
at z = 35 km 
Figure 8.4
PF vs. range/height over ﬂat Earth with single knife edge (150 m height-wall at
40 km range) with horizontal polarization: (left-top) GO+UTD, (left-bottom) FEMPE, (right)
PF vs. height at two speciﬁed ranges; f = 3 GHz, Δx = 0.33 m, Δz = 12.5 m.
diffracted waves exist if the receiver height is above the source height. The LOS and
reﬂection boundaries and transitional regions around these boundaries are clearly ob-
served in both maps. Note that in the 2W-FEMPE implementation, the ﬁeld bounces
from the wall only once. Namely, only a single forward–backward ﬁeld pair is gen-
erated without resorting to any iterative scheme. Two vertical slices at 25 km and
35 km (in the interference region) extracted from this 3D ﬁeld map are presented.
The result of the recently introduced 2W-SSPE model is also included in this ﬁgure.
As observed, an excellent agreement has been obtained from all three models.
The second scenario deals with two walls, one of which is ﬁnite and the other
one is inﬁnite in height. The ﬁnite-height (150 m) wall is located at 40 km, and the
inﬁnite-height wall is at 60 km. Figure 8.5 presents the test results (as a 3D ﬁeld map

94
TWO WAY PE MODELS
Range [km] 
Propagation Factor [dB] 
at z = 35 km 
at z = 50 km 
Figure 8.5
PF vs. range/height over ﬂat Earth with two edges (150 m height-wall at 40 km
range and an inﬁnite-height wall at 60 km) with horizontal polarization: (left-top) GO+UTD,
(left-bottom) FEMPE, (right) PF vs. height at two speciﬁed ranges; f = 3 GHz, Δx = 0.33 m,
Δz = 12.5 m.
vs. range/height). The line source is at 250 m above the ground, and the polarization
is horizontal. Same as before, DBC is used at the surface of the walls and the ground.
Note that the region between the walls exhibits multiple reﬂections and diffractions
from the walls and/or ground. In the 2W-FEMPE realization, the ﬁeld in this re-
gion bounces from both of the walls several times until the contribution becomes
negligible (for a given accuracy limit). PF vs. height at 35 km and 50 km ranges of
this scenario is plotted. At 35 km range, forward-propagating waves interfere with
the backward-reﬂected waves (from the knife edge wall) and edge-diffracted waves
(from the top of the knife edge wall). Since the forward-propagated and backward-
reﬂected contributions are stronger than the edge-diffracted contributions, excellent
agreement among the three models is obtained. It is observed that multiple reﬂec-
tions (almost resonance behavior) occur in the region between the walls. It is known
that the GTD is a HFA method; whereas the FEMPE and SSPE approaches can ac-
count for the diffraction effects up to a certain extent. In comparing the 2W-FEMPE
with the GO+UTD approach, the contribution of the waves hitting the walls up to
three times is superposed. To have fair comparisons up to third degree of reﬂections,
the GO+UTD code is developed to account for 35 types of rays bouncing from the
walls and the ground, in accordance with the LOS criteria. These rays include the
reﬂected waves up to a third degree, as well as the diffracted waves from the ﬁnite-
height wall. Excellent agreement among the results veriﬁes the performance of the
2W-FEMPE with respect to GO+UTD approach. However, the multiple bouncing
of the diffracted ﬁelds from the walls and the ground is ignored in the GO+UTD
code due their negligible effects compared to strong reﬂections. Therefore, a little
discrepancy among the results appears there, as expected.

FLAT EARTH WITH SINGLE AND DOUBLE KNIFE EDGES
95
Range [km] 
Propagation Factor [dB] 
at z = 15 km 
at z = 35 km 
Figure 8.6
PF vs. range/height over ﬂat Earth with double knife edges (100 m height-wall at
20 km range and 150 m height-wall at 40 km range) with horizontal polarization: (Left: from
top to bottom) 1W-SSPE, 2W-SSPE, GO+UTD, (right) PF vs. height at two speciﬁed ranges;
f = 3 GHz, Δx = 0.29 m, Δz = 200 m.
The scenario presented in Fig. 8.6 involves two ﬁnite-height walls along the prop-
agation path (100 m height wall at 20 km range and 150 m height wall at 40 km
range) illuminated by a line source at 5 m (i.e., multiple-wedge problem). The walls
and the ground satisfy DBC. The three ﬁeld maps (from top to bottom) belong to
1W-SSPE, 2W-SSPE, and GO+UTD results. The boundaries of both incident (i.e.,
LOS) and reﬂected ﬁelds are observed in both 2W-SSPE and GO+UTD maps. The
artiﬁcial effects around these boundaries are also clearly observed in the GO+UTD
map (this is not observed in the SSPE maps). The two plots on the right side belong
to PF vs. height at two different ranges showing the comparison among the three
models. As observed from 2W-SSPE and GO+UTD results, a good agreement is
obtained in the ﬁrst region (at 15 km, i.e., in the interference region), but a slight dis-
crepancy is observed in the shadow region (at 35 km, i.e., in the shadow/diffraction
region). This discrepancy can be eliminated by taking into account the slope diffrac-
tion coefﬁcient in the GO+UTD model, whose accuracy decreases in deep-shadow
regions. Furthermore, this discrepancy might be due to ignoring some of the less
contributing components (such as double diffractions), and due to the limitation of
the SSPE within the paraxial regions, therefore further investigation is required in
order to speculate about this discrepancy.

96
TWO WAY PE MODELS
8.5
Two Way Propagation Modeling in Waveguides
Parabolic equation models, since their ﬁrst introduction [18] have long been used in
propagation through complex environments. They are based on the assumption of
slow longitudinal variations and are derived from the wave equation that yields one-
way, forward marching solutions. A reference list is never complete because of the
size of the literature on PE, but [3–5] might be a good start. Some of the recent stud-
ies and references therein may also be useful [31, 34, 48]. Finite-difference, ﬁnite-
element, and FFT-based algorithms have been used in 2D (range–height) space, and
the effects of ground losses/irregularities and environmental/atmospheric inhomo-
geneities have been successfully modeled.
3D PE algorithms have also been introduced and applied in propagation modeling
through open and closed environments [98,100–102]. Moreover, two-way PE mod-
els have been developed for the propagation problems where backward scattering is
signiﬁcant [27,67,68,97].
The 2W-SSPE and 2W-FEMPE algorithms, which were developed, tested, and
calibrated for the groundwave propagation in the presence of knife edge obstacles
[27] as well as arbitrary-shaped, irregular terrain proﬁles, are modiﬁed and used
in modeling propagation inside rectangular waveguides having obstacles at various
ranges. The novel 2W-SSPE and 2W-FEMPE algorithms are compared to each other
as well as calibrated against analytical reference data.
Consider 3D propagation inside a rectangular waveguide determined by its width
(a), height (b), and located longitudinally along the z-direction. The initial source
distribution inside a rectangular waveguide can be represented in terms of modal
summation (see Chapter 7 for details).
Terminating the waveguide completely at any range along z-direction yields total
reﬂections inside and two-way interference can be modeled by using image method
in order to test numerical PE models. This procedure works by removing the obstacle
at range zt and putting an image source at range 2zt.
8.6
Three-Dimensional Split-Step- and Finite-Element-Based Parabolic
Equation Models
The 3D PWE for rectangular waveguides homogeneously ﬁlled with air uses the
standard PE given as
 ∂2
∂x2 + ∂2
∂y2 + 2ik0
∂
∂z

u(x, y, z) = 0
(8.1)
where x and y stand for the transverse coordinates, z is the longitudinal coordinate,
and u(x, y, z) = exp(−ik0z)ψ(x, y, z) is the reduced function since the direction of
wave propagation is predominantly along the z-axis.
The idea of SSPE model is to solve (8.1) in the transverse kx and ky spectral-
domains. In the numerical computations, this is achieved by using FFT. The BCs are

TESTS AND CALIBRATION
97
imposed manually. The choice of discrete step size (Δx, Δy, and Δz), the injection
of transmitting antenna, implementation of boundary losses as well as irregularities
are well known and can be found in many sources (e.g., see [3,5,31,97]).
The idea of FEMPE model is to divide the 2D transverse-domain into subdo-
mains ﬁrst. Then, the initial ﬁeld proﬁle, generated from a Gaussian antenna pattern,
is injected. The approximated ﬁeld values at discrete nodes are then propagated
longitudinally by using the Crank–Nicolson approach, which is based on improved
Euler method with DBC (NBC) at each range for horizontal (vertical) polarization,
respectively [31,97].
The modiﬁed PE models can handle two-way propagation effects. The modiﬁ-
cation is based on the generation of backward-reﬂected waves when an obstacle is
met. In other words, the wave is marched out in the forward direction until it hits an
obstacle and is separated into two components; forward propagating and backward
propagating, by imposing the appropriate BCs.
The forward wave continues after setting the ﬁeld proﬁle of obstacle region zero.
Then, the backward ﬁeld is obtained by providing the BCs for the obstacle. Since the
total tangential ﬁeld must be zero for PEC case, the backward function can be found
as ub(x, y, z) = exp(ik0z)ψb(x, y, z). Finally, the total ﬁeld is obtained by super-
posing both ﬁelds at each range. For multiple obstacles and when resonances occur,
multi-forward and multi-backward generation is applied. The number of reﬂections
in both directions is then determined from the stated accuracy.
8.7
Tests and Calibration
The ﬁrst test belongs to a square waveguide (4 m × 4 m) terminated at 200 m range.
The wave function inside the PEC waveguide with TM waves is represented in terms
of modal superposition. The frequency is chosen as 3 GHz (well above the cutoff
frequency). The transverse discretization values are Δx = 0.8λ and Δy = 0.8λ,
and the longitudinal step size is Δz = 10λ. A 2D Gaussian tilted antenna with an
elevation of θ(elvx,elvy) = (1◦, 2◦) and beamwidth of θbw = 4.34◦is used. The
source position is xs = 2 m, ys = 2 m, and zs = 0. The number of modes in
the transverse-domain are Nx = 21 and Ny = 22 along x and y directions (for a
relative maximum error of 1e-7). Note that the relative maximum error is deﬁned
as the maximum difference in absolute values of the Gaussian ﬁeld and the modal
summation divided by the maximum absolute value of the Gaussian ﬁeld. Perfect
agreement is obtained among three models. Figure 8.7 shows 2D cross-sectional
ﬁeld distributions for this case. Very good agreements are clearly obtained. Fields
vs. range at point xr = 2 m, yr = 1 m for tilted and untilted sources are also plotted.
As observed, there is a very good agreement among the modal solution, SSPE, and
FEMPE solutions. Note that SSPE, compared to FEMPE, gives better results because
of the match of the DST and sinusoidal functions of modal summation.
Using the same parameters above, the second test belongs to one 4 m × 2 m ob-
stacle at 100 m range. The region up to 100 m exhibits forward-propagating waves
interfering with backward waves. Figure 8.8 shows the cross-sectional ﬁeld distri-

98
TWO WAY PE MODELS
z [m] 
Figure 8.7
(Left) 2D cross-sectional ﬁeld distributions inside PEC rectangular waveguide
terminated at 200 m range.
Rows: modal summation, FEMPE, and SSPE simulations.
Columns: 50 m, 100 m, and 150 m ranges, respectively.
(Right) 1D longitudinal ﬁeld
distributions at xr = 2 m, yr = 1 m: (top) untilted, (bottom) tilted: θ(elvx,elvy) = (1◦, 2◦).
butions of two methods at three different ranges. The rows correspond to 1W-SSPE,
2W-SSPE, and 2W-FEMPE; the columns belong to ranges of 80 m, 90 m, and 150 m,
respectively. The difference between one-way and two-way models is clearly seen,
and both numerical techniques give similar results. Note that the ﬁeld distributions
at 150 m range are similar because only forward waves contribute in this region. The
transmitted power is obtained as 48.4% and 48.3% for SSPE and FEMPE methods,
respectively. Fields vs. range at point xr = 2 m, yr = 1 m for one-way and two-
way FEMPE and SSPE results are also given. As observed, the difference between
one-way and two-way propagators is signiﬁcant before the obstacle. Beyond that
ﬁeld distributions are exactly the same because only forward waves contribute in this
region.
Finally, Figs. 8.9 and 8.10 belong to arbitrary terrain proﬁles which do not have
any analytical exact or approximate solution that might serve as a reference, where
only FEMPE model can be compared with the SSPE model for horizontal polariza-
tion. Figure 8.9 shows the comparison of narrow- and wide-angle FEMPE results
through homogeneous standard atmosphere. Two Gaussian antennas having eleva-
tions of 25◦and 5◦downward are at 150 m and 200 m heights, respectively. The
beamwidth is the same for both as θbw = 1◦, and the frequency is 600 MHz. The
transverse discretization is Δx = 0.42 m and the longitudinal step size is Δz = 1 m.
As observed, narrow-angle FEMPE cannot accurately account for the reﬂections
which change the true ﬁeld map considerably.
3D ﬁeld maps vs. range/height of another scenario through inhomogeneous atmo-
sphere produced with the 2W-FEMPE and 2W-SSPE models are given in Fig. 8.10.
The source is at 400 m height with a beamwidth of 0.5◦and an elevation of 0.5◦

TESTS AND CALIBRATION
99
z [m] 
Figure 8.8
(Left) 2D cross-sectional ﬁeld distributions of untilted source inside PEC
rectangular waveguide with one 4 m × 2 m obstacle at 100 m range. Rows: 1W-SSPE, 2W-
SSPE, and 2W-FEMPE simulations. Columns: 80 m, 90 m, and 150 m ranges, respectively.
(Right) 1D longitudinal ﬁeld distributions at xr = 2 m, yr = 1 m: (top) FEMPE, (bottom)
SSPE.
downward at 300 MHz. The inhomogeneous atmosphere has a refractivity slope of
−200 M units/km between 300 m and 400 m (ducting case). The transverse dis-
cretization is Δx = 1 m and the longitudinal step size is Δz = 200 m. Note that
Fig. 8.10 needs further comparisons against another full wave (e.g., the MoM-based
[11,42,103] and/or the time-domain propagation [13,14,104,105]) models in order
to complete the VV&C tests. This is because both SSPE and FEMPE approaches
start with the same PE model and equally inherit all modeling incapabilities (e.g.,
the paraxial approximation). Yet, analytical exact solutions have not appeared for
the irregular terrain models. The asymptotic GO+UTD model is not applicable (in
its current form) to problems containing irregular terrains.
The FEMPE model needs much smaller range steps than the SSPE model, there-
fore necessitates longer computation times when long-range propagation is of inter-
est. According to the calculations, the computation time of the FEMPE is at least
14 times longer as compared to that of SSPE. As a result, the number of nodes
used in the transverse and range coordinates should be optimized with respect to
the following parameters: the operating frequency, the irregular terrain structure, in-
homogeneous atmosphere, and the selection of the initial Gaussian antenna pattern
speciﬁed by its height, beamwidth, and tilt. Moreover, the line-source excitation is
a serious problem in the FEMPE model, but this might be overcome by construct-
ing the initial ﬁeld proﬁle at a few wavelengths away from the line source by using
some other models such as the SSPE or GO, or using smooth, such as Gaussian type,
source patterns. On the other hand, FEMPE model handles all kinds of BC at the
surface much more easily when compared with the SSPE model.

100
TWO WAY PE MODELS
Range [km] 
Figure 8.9
PF vs. range/height over arbitrary terrains through homogeneous standard
atmosphere.
Range [km] 
Figure 8.10
PF vs. range/height over arbitrary terrains through inhomogeneous atmosphere.

CHAPTER 9
PETOOL VIRTUAL PROPAGATION
PACKAGE
9.1
Introduction
Radio wave propagation over the Earth’s surface and in an inhomogeneous atmo-
sphere is affected by several scattering phenomena, such as reﬂection, refraction, and
diffraction. Understanding the effects of varying conditions on radio wave propaga-
tion is, therefore, essential for designing reliable radar and communication systems.
Especially, tropospheric waves may play a dominant role in communications because
they can propagate over the horizon and increase the coverage area, and hence, they
may disrupt the communication links due to the interference that is not normally
there. Such waves are propagated by bending or refraction due to the abrupt change
in the refractive index in the troposphere and cause so-called anomalous propagation.
If the refractive gradient exceeds some certain limits, the radio waves may be trapped
in a duct and guided over distances far greater than the normal range. In addition to
tropospheric effects, irregular terrain surfaces have considerable inﬂuence on radio
wave propagation because they reﬂect and diffract the EM waves in a complex way.
Hence, the design of an effective radar or communication system can be achieved by
using a model that can properly incorporate the refractivity and terrain factors.
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
101

102
PETOOL VIRTUAL PROPAGATION PACKAGE
The rigorous analytical and numerical modeling of radio wave propagation in
such environments is a challenging task and has attracted the attention of researchers
for many decades. The difﬁculty stems from the vast variability of the properties
of the medium and also the surfaces and obstacles that re-direct the propagating
energy, making the radio propagation somewhat unpredictable. Initially, analytical
techniques (such as ray tracing methods, diffraction methods, and waveguide mode
theory) have been employed to predict the radio propagation [39,78,80,91,99,106].
However, they require the geometry to be represented as a member of a set of some
canonical geometries and suffer from the presence of the vertically varying refrac-
tivity proﬁle in the troposphere. With the advances in computers, some numerical
techniques have been devised to easily handle the above-mentioned difﬁculties. PE
model has been widely used in propagation modeling to predict the wave behav-
ior between a transmitter and a receiver over the 2D Earth’s surface, because of its
high capability in modeling both horizontally and vertically varying atmospheric re-
fraction (especially ducting) effects. The standard PE is derived from Helmholtz’s
equation in such a way that the rapidly varying phase term is discarded to obtain a
reduced function having slow variation in range for propagating angles close to the
paraxial direction. Helmholtz’s equation is approximated by two differential equa-
tions, corresponding to forward- and backward-propagating waves, each of which
is in the form of a parabolic PDE. The standard PE method takes only the forward
part into account, namely, it is a one-way, forward scatter model, valid in the parax-
ial region. Although the initial introduction of the PE method has been credited to
[18], its wide-spread usage has become possible after the development of Fourier
split-step algorithm by [107]. The SSPE is, in general, an initial-value problem
starting from a reference range (typically from an antenna), and marching out in
range by obtaining the ﬁeld along the vertical direction at each range step, through
the use of step-by-step Fourier transformations [3, 5, 10, 60, 62, 108]. Apart from
the Fourier split-step algorithm, the solution of the PE has also been achieved by the
ﬁnite-difference-based [56,109,110] and ﬁnite element (FE)-based [22,27,31,44,48]
algorithms. The Fourier split-step algorithm is more robust since it provides the
use of larger range increments and a faster solution for long-range propagation sce-
narios. Apart from these studies, there exist several computer software programs,
most of which have been developed for military purposes, for predicting radar cov-
erage under the effect of environmental factors that inﬂuence refractivity. These
are IREPS (Integrated Refraction Effects Prediction System), EREPS (Engineer’s
Refractive Effects Prediction System), TESS (Tactical Electronic Support System),
AREPS (Advanced Refractive Effects Prediction System), TEMPER (Tropospheric
Electromagnetic Parabolic Equation Routine), and TPEM (Terrain Parabolic Equa-
tion Model). These programs implement the ray optics or one-way PE techniques,
or a hybrid model combining these methods.
In this chapter, a novel software tool (PETOOL), which is developed in MATLAB
with graphical user interface (GUI), is introduced for the analysis and visualization of
radio wave propagation through the homogeneous and inhomogeneous atmosphere,
by incorporating variable terrain effects with the aid of the two-way split-step algo-
rithm employing wide-angle propagator. The reason to develop another PE-based

PETOOL SOFTWARE
103
program for radio wave propagation is twofold: The ﬁrst is that, PETOOL is a free
open-source program, and has been designed with a user-friendly GUI, to serve as
a research/educational tool for propagation engineers/instructors to investigate the
phenomenon in an illustrative manner, and/or to achieve the analysis/design/plan-
ning of reliable communication systems. It displays the propagation factor/loss on
a range/height scale and enables the user to easily visualize, enter, and save all re-
lated input/output parameters. More importantly, the user can easily create arbitrary
terrain and refractivity proﬁles. The second reason is that PETOOL is indeed the
ﬁrst software package implementing both 1W-SSPE and 2W-SSPE algorithms, the
latter of which incorporates the multipath effects into the PE solution of the radio
wave propagation through a recursive forward–backward algorithm. The standard
one-way PE method, in spite of its wide-spread usage, suffers from two major draw-
backs.
The PE method handles only the forward-propagating waves and neglects the
backscattered waves. The forward waves provide almost accurate results for
typical long-range propagation problems, only if there does not exist obstacles
that redirect the incoming wave in the form of reﬂections and diffractions. How-
ever, the accurate estimation of the multipath effects, occurring during propa-
gation over terrain, requires the correct treatment of backward waves as well.
Moreover, the PE method takes the diffraction effects into account within the
paraxial approximation, degrading the accuracy of the approach in deep-shadow
regions where the diffracted ﬁelds dominate. There are a number of studies in
the literature to overcome such difﬁculties [63,64,67,111–115]. A two-way PE
algorithms have also been proposed (see Chapter 8 and [68,116]).
The second drawback is that the standard PE is a narrow-angle approximation,
which consequently restricts the accuracy to propagation angles up to 10◦−15◦
from the paraxial direction. A typical long-range propagation encounters prop-
agation angles that are usually less than a few degrees, whereas the short-range
propagation problems, as well as the problems involving multiple reﬂections
and diffractions because of hills and valleys with steep slopes, can only be
solved by a PE model that is effective for larger propagation angles. To handle
propagation angles up to 40◦−45◦, wide-angle propagators have been intro-
duced [25,26,65,117–119]. PETOOL implements the two-way algorithm pro-
posed in [68], with the exception that narrow-angle propagators are replaced by
wide-angle propagators to handle larger propagation angles.
9.2
PETOOL Software
PETOOL software package [96] has been developed in MATLAB with a user-friendly
GUI for the analysis and visualization of radio wave propagation. The GUI has been
designed so as to meet the following goals:

104
PETOOL VIRTUAL PROPAGATION PACKAGE
Figure 9.1
PETOOL main window and 2D graphics windows obtained by right-clicking the
mouse on the 3D map.
The user should be able to easily visualize, load, and save the propagation fac-
tor/loss on a range/height scale in radio wave propagation problems over vari-
able terrain and through the homogeneous and inhomogeneous atmosphere.
The user should be able to deﬁne her/his own input parameters, and to load/save
them if desired. The user should be warned if s/he enters inappropriate input
values.
The user should be able to easily deﬁne an arbitrarily shaped terrain proﬁle by
just locating a number of points on the graph through left-clicking the mouse.
The user should be able to load/save the terrain parameters from/in a user-
deﬁned ﬁle.
The user should be able to easily specify range dependent or range independent
refractivity proﬁles by just selecting from a list of various types of atmosphere
proﬁles.
The main m-ﬁle to run the program is petool.m. The main window of the program
is depicted in Fig. 9.1. The window is basically divided into four panels. The left
and right panels are located on a large gray background, whereas the top and bottom
panels are located on thin blue backgrounds. These panels are deﬁned in detail below.

PETOOL SOFTWARE
105
The top blue panel is reserved for ﬁve operational push buttons (load, save, exit,
run, about). The load and save buttons are used for all input parameters of the simu-
lation. Once clicked, a modal dialog box is opened to select or specify a ﬁle the user
wants to create or save. While exiting PETOOL, the user is also warned whether or
not s/he wants to save the parameters.
The bottom blue panel is used to show warning text messages whenever needed,
especially in the case of inappropriate input entrance.
On the left panel, there are six subpanels (domain, analysis, antenna, surface,
atmosphere, terrain), where the input parameters are deﬁned by the user. The input
parameters are summarized in Table 9.1.
Figure 9.2
Windows for specifying atmosphere types: (a) standard atmosphere, (b) surface
duct, (c) surface-based duct, (d) elevated duct, (e) evaporation duct, (f) user-deﬁned duct.
In specifying a refractivity proﬁle, the user selects an atmosphere type from
a menu list, and a new window is opened accordingly, enabling the user to
enter the modiﬁed refractivity (M) values for the speciﬁed atmosphere type.
The available atmosphere proﬁles are the standard atmosphere, surface duct,
surface-based duct, elevated duct, evaporation duct, and user-deﬁned duct, whose
windows are illustrated in Fig. 9.2. If the range dependent refractivity proﬁle is
to be deﬁned, the above-mentioned selection is performed for each range value.
The proﬁles lying between two consecutive range values are computed automat-
ically through linear interpolation. It is useful to note that the user can load/save
the atmosphere parameters separately. In addition, the user can easily modify or

106
PETOOL VIRTUAL PROPAGATION PACKAGE
Table 9.1
Input parameters of PETOOL.
Domain Parameters:
• Maximum range [km]
• Maximum height [m]
Antenna Parameters:
• Polarization (horizontal or vertical)
• 3 dB beamwidth [degree]
• Antenna height [m]
• Elevation angle [degree]
• Frequency [MHz] (must be >30 MHz)
Analysis Parameters:
• Range step [m]: horizontal step size
• Height step [m]: vertical step size
• One way or two way
(which algorithm is to be performed)
Surface Parameters:
• PEC or impedance surface
If the user-deﬁned ground is chosen:
If impedance surface is chosen:
• Dielectric constant
Type: Sea, fresh water, wet ground,
• Conductivity [S/m]
medium dry ground, very dry ground,
user-deﬁned ground.
Atmosphere Parameters:
• Range independent or
range dependent refractivity
If range independent refractivity is chosen:
If range dependent refractivity is chosen:
Type: standard atmosphere, surface duct,
Refractivity type for each range value
surface-based duct, elevated duct, evaporation
deﬁned in list boxes
duct, and user-deﬁned duct.
Terrain Parameters:
• None (ﬂat surface) or terrain
If terrain is chosen:
• Interpolation type (none, linear, cubic spline)
• Number of points: number of points
• Range and height values for terrain points
to be placed on top graphics to deﬁne
deﬁned in list boxes
the terrain proﬁle
delete the parameters in the proﬁle and range lists, by means of a special dialog
box that is opened when the user clicks an item from the list.
In specifying a terrain proﬁle, the user has three options: (i) s/he can locate a
number of points on the top graphics of the right plane by clicking Locate Points
button, (ii) s/he can deﬁne the terrain points manually by entering the values
into the range–height list boxes, or (iii) s/he can load a user-generated text ﬁle
including the terrain parameters. In all cases, the user can save/load/clear/plot

CHARACTERISTIC EXAMPLES
107
the terrain proﬁle. If the user prefers to create her/his own terrain by locating
points on the graphics, the values of the selected points are automatically placed
into the range and height list boxes. Hence, it is possible to store the graphically
generated terrain proﬁles in ﬁles, as well as to modify or delete the parameters
in the list boxes. Once the terrain points are speciﬁed by using one of the above-
mentioned ways, the overall terrain proﬁle is created by performing a kind of
interpolation (linear or cubic spline) between two consecutive terrain points
along the range. If the interpolation method is chosen to be none, the terrain
proﬁle appears as a collection of knife edges. After deﬁning the terrain proﬁle,
the user must click on the run button to see the analysis results of the new
geometry. It is useful to note that the program does not allow the terrain to
extend below zero level.
On the right panel, there are two graphics (top graphics where the terrain is spec-
iﬁed, and the bottom graphics showing the colored 3D map of the propagation fac-
tor/loss), together with ﬁve sub-panels (plot type, current point, 2D graphics, color-
bar, save result) related to the visualization or storage of output parameters. After
the user clicks on the run button, the code performs the 1W-SSPE or 2W-SSPE algo-
rithm, and then, plots the 3D PF map on the bottom graphics. Although the default
is PF, the user can switch to PL map by clicking the appropriate button in the plot
type panel. Whenever the user moves the mouse over the bottom graphics, the val-
ues (range, height, PF/PL) automatically appear in the current point panel. The user
can plot the 2D graphics (PF/PL vs. range for ﬁxed height, or PF/PL vs. height for
ﬁxed range) either by entering the values into the boxes in 2D graphics panel, or
by right-clicking the mouse on the desired point of the 3D map (see Fig. 9.1). The
colorbar panel is used to adjust the colorbar scale of the 3D map for better visualiza-
tion. Finally, the save result panel is used to store the PF/PL maps in the form of a
MATLAB ﬁle (.mat) or a picture ﬁle (.tif). We also note that 2D graphics in Fig. 9.1
can be saved in text ﬁles by using the save button.
9.3
Characteristic Examples
It might be difﬁcult to produce numerical reference data for the VV&C tests. A
convenient way of testing narrow- and wide-angle SSPE models is to tilt up or
down the pattern up to 40◦−45◦. In the ﬁrst scenario, ﬁve Gaussian antennas
located at the same place (1000 m height) with 3 dB beamwidth of 0.5◦each, and
10◦−20◦−30◦−40◦−50◦tilt angles illuminate the PEC ground in a standard
atmosphere, assuming that the frequency is 1 GHz, the polarization is horizontal,
the range and height increments are Δz = 10 m and Δx = 0.13 m, respectively.
Three-dimensional PF maps, corresponding to narrow- and wide-angle SSPE are il-
lustrated in Fig. 9.3. Although there is an almost exact match between the desired
specular reﬂection points and those found by the wide-angle SSPE, the results of the
narrow-angle SSPE start to deteriorate as the tilt angle increases.
Next, the performance of the 1W-SSPE is demonstrated against AREPS, which
simulates only the one-way propagation with narrow-angle SSPE. As shown in Fig. 9.4,

108
PETOOL VIRTUAL PROPAGATION PACKAGE
Range [km] 
Figure 9.3
PF maps for ﬁve Gaussian antennas with different tilt angles illuminating PEC
ground: (top) narrow-angle, (bottom) wide-angle.
an untilted Gaussian antenna at 50 m height with 3 dB beamwidth of 3◦illuminates
a variable terrain inside a surface duct, which is modeled by the modiﬁed refractivity
proﬁle M. The frequency is 3 GHz. The discretization parameters are Δz = 200 m
and Δx = 0.29 m. As illustrated by the PF maps, a good agreement is obtained be-
tween PETOOL and AREPS in the narrow-angle case. The good agreement among
the results illustrates the success and completeness of the VV&C process for the
1W-SSPE.
In the following two scenarios, the calibration is done against the GO+UTD re-
sults, assuming that the frequency is 3 GHz. It is useful to note that the calibration via
GO+UTD is feasible only for sufﬁciently high frequencies such that the ray-optics
interpretation is valid.
The ﬁrst scenario involves two walls, one of which is ﬁnite (also known as a knife
edge) and the other one is inﬁnite in height. In Fig. 9.5, the ﬁnite-height (50 m) wall
is located at 50 km; the inﬁnite-height wall is at 60 km; the line source is at 250 m,
and the polarization is vertical. The discretization parameters are Δz = 200 m and
Δx = 0.29 m. This is one of the classical structures in the ﬁeld of diffraction theory,
and its approximate solution can be computed by using ray-optic techniques, com-
bined with special diffraction methods. In the implementation of the GO method,
the reﬂected waves from the ground and the wall can simply be calculated by em-
ploying the principles of image theory that replaces the original problem with the
equivalent problem represented by image sources with respect to the BCs that must
be satisﬁed on the boundaries depending on the polarization. The total ﬁeld is ob-
tained by the sum of the direct ray, reﬂected rays emanating from image sources,
and the diffracted rays from the tip of the wall, by also checking the LOS conditions
between the source(s) and the observation point. As shown, multiple reﬂections
(almost resonance behavior) occur especially in the region between the walls. In

CHARACTERISTIC EXAMPLES
109
Figure 9.4
(Upper-left) Main window with PF map, (upper-right) modiﬁed refractivity
proﬁle for surface duct, (lower-left) PF vs. range at 50 m height, (lower-right) PF vs. height at
120 km range.
comparing the 2W-SSPE with the GO+UTD approach, the contribution of the waves
hitting the walls up to three times is superposed. To achieve fair comparisons up to
third degree of reﬂections, the GO+UTD code accounts for 35 types of rays bouncing
from the walls and the ground. In addition to reﬂected waves, the diffracted waves
from the ﬁnite-height wall are also computed. However, the multiple bouncing of
the diffracted ﬁelds from the walls and the ground is ignored due to their negligi-
ble effects compared to strong reﬂections. The good agreements among the results
illustrate the success of the 2W-SSPE with respect to GO+UTD approach.
The next scenario in Fig. 9.6 illustrates the comparison between 1W-SSPE and
2W-SSPE models with narrow- and wide-angle propagators over a variable terrain
and in an elevated duct environment. A Gaussian antenna with 2◦tilt angle is located
at 50 m height. The frequency is 3 GHz, and the polarization is horizontal. The
discretization parameters are Δz = 200 m and Δx = 0.29 m. Referring to the
descriptions in Fig. 9.2, the elevated duct is deﬁned as follows: M0 = 300, M1 =
330, M2 = 310, M3 = 350, x1 = 100 m, x2 = 150 m, x2 = 300 m. These
examples help us to visualize the importance of the correct representation of large
propagation angles, as well as the backward-propagating waves.
As emphasized in the introduction part, PETOOL has been designed for research/e-
ducational purposes. Hence, propagation engineers/instructors can simulate different
propagation scenarios to investigate the radio wave propagation and/or to design re-
liable communication links. In order to demonstrate what engineer/instructors can

110
PETOOL VIRTUAL PROPAGATION PACKAGE
Range [km] 
(c) 
at range 55 km 
(a) 
Range [km] 
 
(b) 
PF [dB] 
at x = 50 m        
Figure 9.5
(a) PF maps, (b) PF vs. height at 55 km range, (c) PF vs. range at 50 m height.
do with PETOOL, we have shown various scenarios at 3 GHz in Figs. 9.7 and 9.8.
The discretization parameters are Δz = 200 m and Δx = 0.29 m. In Fig. 9.7, a
Gaussian antenna, which is located at 10 m height, radiates into the surface duct and
surface-based duct environments. Referring to the descriptions in Fig. 9.2, the sur-
face duct is deﬁned as follows: M0 = 350, M1 = 300, M2 = 350, x1 = 200 m,
x2 = 300 m. The surface-based duct is deﬁned as follows: M0 = 340, M1 = 356,
M2 = 340, M3 = 358, x1 = 135 m, x2 = 150 m, x2 = 300 m. Polarization is
horizontal, and the ground is PEC. Note that the computation times are dependent
on the number of iterations in the 2W-SSPE, which in turn depend on the amount of
the wave interactions (multiple reﬂections) between the hills.
In Fig. 9.8, different ground parameters are simulated assuming that a Gaussian
antenna is located at 5 m height and radiates into a standard atmosphere. On the

CHARACTERISTIC EXAMPLES
111
Range [km] 
Range [km] 
Figure 9.6
PF maps for a variable terrain in an elevated-duct environment: (left) 1W-SSPE,
(right) 2W-SSPE, (top) narrow-angle, (bottom) wide-angle.
Figure 9.7
PF maps for a PEC terrain illuminated by a Gaussian antenna at 10 m assuming
different refractivity proﬁles: (left) surface duct, (right) surface-based duct, (top) 1W-SSPE,
(bottom) 2W-SSPE.
left side, the surface is PEC, on the right side the surface is very dry ground with
dielectric constant εr = 3 and conductivity σg = 1e −4 Siemens/m. The discretiza-
tion parameters are Δz = 100 m and Δx = 10 m. Polarization is vertical and the
frequency is 100 MHz.

112
PETOOL VIRTUAL PROPAGATION PACKAGE
Figure 9.8
PF maps for a variable terrain illuminated by a Gaussian antenna at 5 m assuming
different ground surface parameters in standard atmosphere: (left) PEC surface, (right) very
dry ground, (top) 1W-SSPE, (bottom) 2W-SSPE.

CHAPTER 10
FEMIX VIRTUAL PROPAGATION
PACKAGE
10.1
Introduction
The ITU regulates EM groundwave propagation prediction [120,121]. Recommen-
dation P-368-7 [121] fully covers both homogeneous and mixed path groundwave
propagation problems. It gives a set of curves of predicted ﬁeld strength as a func-
tion of distance for vertically polarized EM waves in the medium-frequency (MF)
and high-frequency (HF) bands for a variety of ground conductivity (σg) and rel-
ative permittivity (εr) values [9].
These curves are valid for a certain range of
antenna heights for a homogeneous atmosphere up to heights h = 1.2σ1/2
g
λ3/2 if
εr ≪60σgλ. They are also valid for non-ﬂat longitudinal paths with obstacles not
higher than a wavelength and not closer than 8–10 km to either the transmitter or the
receiver [9]. Systems such as Digital Radio Mondiale (DRM) and/or high-frequency
surface-wave radars (HFSWRs) [122,123] necessitate revisiting groundwave propa-
gation modeling and the mixed path problem. Among available numerical packages,
GRWAVE and DRMix [15] are worthwhile mentioning. These packages use Nor-
ton’s [50] and Wait’s [51] models, as well as Millington’s curve ﬁtting approach [52].
All these models can handle only smooth spherical Earth problems. [3,4,9,16,124]
should be referred for a summary of most of these early analytical studies. Note that
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
113

114
FEMIX VIRTUAL PROPAGATION PACKAGE
surface-wave propagation along inhomogeneous paths can be signiﬁcantly affected
by the surface losses between 30 kHz and 30 MHz (LF/MF/HF).
Surface-wave PL vs. range have been predicted via EM wave propagation mod-
eling along homogeneous/inhomogeneous propagation paths over irregular terrain.
An irregular terrain means a change of land irregularities above Earth’s surface.
A homogeneous propagation path means the use of the same impedance BC at the
Earth’s surface (lake, sea, dry land, wet land, etc.). An inhomogeneous propagation
path means having different impedance BCs on the surface along the range (e.g.,
sea–land–sea, land–lake–land, transitions).
The groundwave propagation problem over a non-smooth spherical Earth with
an impedance BC and a radially dependent atmosphere, excited by a vertical elec-
tric dipole located near the Earth’s surface, requires the solution of a 3D EM wave
equation in spherical coordinates. Unfortunately, a 3D solution in terms of known
numerically computable mathematical functions has not appeared yet. All avail-
able analytical solutions are in 2D transverse–longitudinal space, assume azimuthal
asymmetry, and are based on either ray or mode summation methods [124].
A novel FEMPE-based software tool (FEMIX) is introduced for the analysis and
visualization of surface-wave propagation over the irregular Earth’s surface through
a homogeneous and an inhomogeneous atmosphere. A typical scenario is pictured in
Fig. 10.1. Here, z and x represent the range and height coordinates, Δz and Δx are
the range and height step sizes, respectively. The 2D environment is open along z
(i.e., −∞< z < +∞) and semi-open along x (i.e., 0 < x < +∞). The propagation
problem is postulated via 2D Helmholtz’s equation, together with the appropriate
termination conditions (i.e., an impedance BC at x = 0 and radiation condition for
z →±∞and x →+∞).
Figure 10.1
The 2D radio wave propagation scenario over irregular terrain. The next vertical
ﬁeld is obtained from the previous ﬁeld via step-by-step iterative marching procedure.

ANALYTICAL SURFACE-WAVE MODEL
115
10.2
Analytical Surface-Wave Model
The analytical surface-wave model over inhomogeneous smooth spherical Earth’s
surface paths, recommended by the ITU, uses a ray-optical Norton’s surface-wave
[50] and Wait’s surface-guided mode [51] models for the LOS and the shadow re-
gions, respectively; and the Millington curve ﬁtting method [52].
10.2.1
Path Loss
The PL is the ratio between the power radiated by the transmitting antenna (Pt) and
the power available at a point in space (Pr) [121]
PL(d) = 10 log Pr(zs + d)
Pt(zs)
(10.1)
which is calculated at a given distance d as
PL(d) = 142 + 20 log(fMHz) + 20 log(EμV/m)
(10.2)
by taking the received power Pr = E2
rλ2/(Z04π) where Er is the received ﬁeld
strength at distance z = zs + d, λ is the wavelength, Z0 = 120π is the free-space
wave impedance, and Pt = 1 kW at the initial range.
10.2.2
Norton’s Model
Under the standard atmosphere and spherical-smooth Earth assumptions, Norton’s
model uses the ray-optical asymptotic approximation from a wavenumber spectral
integral representation [50]. Considering the close placement of the source (ht) and
the receiver (hr) to the ground (at short and medium ranges, where ﬂat Earth as-
sumption can be made), the normal and tangential electric ﬁeld components of the
surface-wave are
En = (1 −Rv)E0(1 −u2 + u4 cos2 ψ)F(κ)
(10.3)
Et = (1 −Rv)E0(1 −u2 cos2 ψ)1/2(1 + 0.5 sin2 ψ)F(κ)
(10.4)
where E0 = ik0Z0M0 exp(ik0d)/(4πd), ψ = tan−1((ht+hr)/d), M0 = 5λ/2π Am
is the dipole moment for a short electric dipole [121], u2 = 1/εg, εg = ε + i60σgλ
is the relative dielectric constant of the surface, and
Rv = εg sin ψ −

εg −cos2 ψ
εg sin ψ +

εg −cos2 ψ
(10.5)
is the reﬂection coefﬁcient for vertical polarization. The attenuation function is
F(κ) = 1 −i√κπ exp(−κ)erfc(i√κ)
(10.6)

116
FEMIX VIRTUAL PROPAGATION PACKAGE
erfc(i√κ) =
2
√π
 ∞
i√κ
exp(−t2)dt
(10.7)
κ = −ik0d
2 u2(1 −u2 cos2 ψ)
 
1 +
sin ψ
u

1 −u2 cos2 ψ
!
(10.8)
where erfc(i√κ) is the complementary error function. Norton’s model is good within
the LOS region.
10.2.3
Wait’s Model
Wait’s model uses the spectral integral as a series of normal modes propagating
along a spherical Earth’s surface [51, 121]. Under the ﬂattened-Earth assumption
(i.e., when the Earth’s curvature is modeled with the effective radius), the normal
component of the electric ﬁeld is
En = E0F(x, x′; z)
(10.9)
with the attenuation function
F(x, x′; z) = πz
2
∞

s=1
exp(iβsz)
βs −q2
W(βs −x)
W(βs)
W(βs −x′)
W(βs)
(10.10)
where x′ and x are the source and observation heights, q = imn0Zs/Z0, m =
(k0ae/2)1/3, n0 is the refractive index at the Earth’s surface, ae is the Earth’s radius,
and the surface impedance is
Zs = Z0

1
ε −i60σgλ
1/2 
1 +
1
ε −i60σgλ
1/2
.
(10.11)
For the standard atmosphere including the Earth’s curvature, the transverse mode
functions are the solutions of Airy’s equation [3],
W(β) = √π (Bi(β) −iAi(β))
(10.12)
which satisfy the following BC on the surface
 d
dβ W(β) −qW(β)

β=βs
= 0
(10.13)
and the radiation condition as x goes to inﬁnity. Since the tangential component in
(10.4) is negligible for a vertically polarized short dipole, only the normal component
of the ﬁeld can be considered in calculations.

ANALYTICAL SURFACE-WAVE MODEL
117
10.2.4
Millington’s Curve Fitting Approach
The Millington curve ﬁtting method takes inhomogeneous path variations into ac-
count with the following recursive equations [52,121] (see Fig. 10.2):
ED =
N

k=1
Ek(sk) −
N

k=2
Ek(sk−1)
(10.14)
Figure 10.2
(a) A typical mixed path scenario on a 2D spherical Earth, (b) segments and
related parameters.
sk =
k

n=1
dn = d1 + d2 + d3 + ... + dk
(10.15)
ER =
N

k=1
EN−k+1(rk) −
N−1

k=1
EN−k(rk)
(10.16)
rk =
k

n=1
dN−n+1 = dN + dN−1 + dN−2 + ... + dN−k+1
(10.17)
where ED and ER are the direct ﬁelds using the paths sk from the source to the
receiver, and the reverse ﬁelds using the paths rk from the receiver to the source,
respectively (see Fig. 10.2). These ﬁelds are used to calculate the total ﬁeld along
the inhomogeneous propagation path as ET = (ED + ER)/2.
The recursive equations in (10.14)–(10.17) reduce to
ED = E1(d1) −E2(d1) + E2(d1 + d2)
(10.18)

118
FEMIX VIRTUAL PROPAGATION PACKAGE
ER = E2(d2) −E1(d2) + E1(d2 + d1)
(10.19)
for a two-segment propagation path, where the ﬁeld values E1(d1), E1(d2), E2(d1),
E2(d2), E1(d2 + d1), and E2(d1 + d2) are deﬁned as follows:
E1(d1) is the ﬁeld strength at a distance d1 over homogeneous Medium I
E1(d2) is the ﬁeld strength at a distance d2 over homogeneous Medium I
E2(d1) is the ﬁeld strength at a distance d1 over homogeneous Medium II
E2(d2) is the ﬁeld strength at a distance d2 over homogeneous Medium II
E1(d2 + d1) is the ﬁeld strength at a distance d1 + d2 over homogeneous
Medium I
E2(d1 + d2) is the ﬁeld strength at a distance d1 + d2 over homogeneous
Medium II
Similarly, they are given as
ED = E1(d1)−E2(d1)+E2(d1 +d2)−E3(d1 +d2)+E3(d1 +d2 +d3) (10.20)
ER = E3(d3) −E2(d3 + d2) −E1(d3 + d2) + E1(d3 + d2 + d1)
(10.21)
for a three-segment propagation path.
10.3
Numerical Surface-Wave Model
The FEMIX propagator uses the FEM-based standard PE. The accuracy of the nu-
merical computations depends on the discretization. Several parameters, such as the
frequency, source beamwidth, source tilt, source height, terrain proﬁle, refractivity
variations, need to be considered.
The FEMPE procedure of the FEMIX tool is applied as follows [44,48]:
An initial vertical ﬁeld proﬁle is injected into the FEMPE algorithm.
An artiﬁcial lossy layer is used, and the vertical region is doubled to eliminate
reﬂected waves coming from the top. In addition, a Tukey (tapered cosine)
window is used for this purpose.
The vertical ﬁeld is propagated longitudinally by using the Crank–Nicolson ap-
proach.
The new vertical ﬁeld proﬁle is taken as the initial ﬁeld proﬁle at the next range
step.
The procedure is repeated until the propagator reaches the desired range.

FEMIX PACKAGE
119
After calculating the ﬁeld inside the entire computational domain, the PL can be
obtained from [121]
PL = −20 log |u| + 20 log(4π) + 10 log x −30 log λ.
(10.22)
An inhomogeneous atmosphere is introduced through refractivity variations [3, 4].
Vertical refractivity variations (n = n(x)) may cause surface and/or elevated ducts.
These are all implemented in the FEMIX model. Also, the Earth’s curvature is in-
cluded by replacing n = n(x) with n(x)+x/ae, where ae = 6, 478 km is the Earth’s
radius. It is customary to use the refractivity,

N = (n(x) −1) × 106
, or the mod-
iﬁed refractivity, (M = N + 157x), with the height, x, given in kilometers. N is
dimensionless but is measured in N units for convenience [4]. For the standard atmo-
sphere, N decreases by about 40 N units/km, while M increases by about 117 N unit-
s/km (although the standard atmosphere deﬁnes an exponentially decreasing refrac-
tive index, this could be approximated as being linear for low heights) [44]. In other
words, variations of the vertical gradient dM/dx of the modiﬁed refractivity are de-
termined as atmospheric conditions as sub-refraction (dM/dx > 117 M units/km),
standard (dM/dx = 117 M units/km), super-refraction (dM/dx < 117 M unit-
s/km), and ducting (dM/dx < 0).
A mathematical representation of all these cases can be achieved via
n(x) = n0
⎧
⎪
⎨
⎪
⎩
1 + a0x
x ≤H1
1 + a0H1 + b0x
H1 < x ≤H2
1 + a0H1 + b0H2 + c0x
x > H2
(10.23)
where n0 is the refractivity at the surface. The user may form any kind of refractivity
by specifying the ﬁrst and second heights (in meters), H1 and H2, respectively, and
the slopes a0, b0, and c0 of the modiﬁed refractivity (supplied values are therefore
multiplied by 10−9, a0 →a0 × 10−9). For example, a vertically linear decreasing
refractivity up to 1 km height (i.e., a surface duct) can be speciﬁed in various ways:
by giving (i) H1 = 0 and H2 = 1000, and a0 = 0, b0 < 0, c0 is arbitrary; or (ii)
H1 = 1000 and H2 = 10000, and a0 < 0, b0, and c0 are arbitrary. Similarly, a
bilinear refractivity up to 1 km (elevated duct) with a duct height at 600 m can be
given by (i) H1 = 600 and H2 = 1000, and a0 > 0, b0 < 0, c0 is arbitrary or, (ii)
H1 = 0 and H2 = 600, and a0 is arbitrary, b0 > 0, c0 < 0, etc.
10.4
FEMIX Package
The FEMIX package [125] is developed using MATLAB for the analysis and visual-
ization of PL vs. range/height variations. The ﬂow chart of the FEMIX model/pack-
age is given in Figs. 10.3 and 10.4. Note that the core FEMIX algorithms were all
tested and validated before [2,31,34,44,48].
FEMIX has been designed in a way that the user may
Visualize, load, and save terrain proﬁles over a maximum of six various paths.

120
FEMIX VIRTUAL PROPAGATION PACKAGE
Figure 10.3
A ﬂowchart of the FEMIX (Millington+FEMPE) GUI algorithm.
Supply their input parameters.
Be warned if inappropriate input values are entered.
Plot an irregular terrain proﬁle by locating a number of points and clicking the
mouse, or the terrain proﬁle may be supplied as an input ﬁle.
Specify the terrain parameters such as permittivity, conductivity, and their lengths.
Specify different refractivity proﬁles.
In order to simplify the use of the program, θBW , maximum height, and height
step size are automatically speciﬁed with respect to the frequencies.
The main executable ﬁle of the package is FEMIX.EXE. Table 10.1 shows the
input parameters of the package. The front panel is displayed in Fig. 10.5. The panel

FEMIX PACKAGE
121
Figure 10.4
A ﬂowchart of the Millington and FEMPE algorithms.
is mainly divided into two parts. The right part in Fig. 10.5 belongs to plot the PL
calculations. The left part is for choosing the input parameters and the controls.
The left part is divided into three panels. The source frequency in mega hertz
is supplied from the top panel. The range increment in kilometers for the horizon-
tal grid width and range norm in kilometers for the calibration between numerical
(FEM) and analytical (Millington) methods for a ﬂat Earth are also entered here.
The user may select one of the two methods or both. Plotting multiple PL results is
also possible. The four operational pushbuttons (RUN, CLEAR, CLOSE, and INFO)
are reserved for normal operations. Figures may be saved by ticking the Output TIFF
box before running operation.
The middle panel is for the atmospheric refractivity. Three different linear refrac-
tivities may be selected by giving their heights (H1 and H2) and refractivity slopes
(a0, b0, and c0). The bottom panel is related to the terrain properties. The LOAD and
SAVE buttons are used to load and record the irregular terrain data. By pressing the
Locate Points button, new irregular terrain data are deﬁned for each path on the bot-
tom ﬁgure of the right part by using the number of points, range, and height values.

122
FEMIX VIRTUAL PROPAGATION PACKAGE
Figure 10.5
The front panel of the FEMIX GUI MATLAB package.
Table 10.1
User speciﬁed operational parameters of the FEMIX GUI package.
Operational Parameters
Explanation
Frequency [MHz]
Operating frequency
Range increment [m]
Range step on horizontal proﬁle
Range norm [km]
Calibration range between Millington
and FEMPE on horizontal proﬁle
1st height [m]
Height of the ﬁrst layer above terrain
2nd height [m]
Height of the second layer above terrain
1st slope [M/km]
Refractivity slope of the ﬁrst layer
2nd slope [M/km]
Refractivity slope of the second layer
3rd slope [M/km]
Refractivity slope of the third layer
Number of points
Number of points to get terrain proﬁle
Number of paths
Number of different paths
Length [km]
Path length of each path
Relative permittivity
Relative permittivity of each path
Conductivity [S/m]
Conductivity of each path
The electrical parameters of each path are also supplied by giving the conductivity
and dielectric constant.
The top ﬁgure on the right side shows a mixed path scenario. PL vs. range results
are displayed on the bottom plot. A 3D color ﬁeld map showing ﬁelds vs. range–
height is also plotted in a separate ﬁgure.
10.5
Characteristic Examples
Typical results obtained with the FEMIX package are presented in this part. The
example given in Fig. 10.6 belongs to a three-path (sea–land–sea) 40 km ﬂat Earth

CHARACTERISTIC EXAMPLES
123
propagation scenario at three different frequencies (5 MHz, 10 MHz, and 20 MHz).
A standard atmosphere is assumed. The electrical parameters of the sea (Path 1 and
Path 3) and an island (Path 2) are σg = 5 S/m, εr = 80, and σg = 0.01 S/m, εr = 15,
respectively. Both the scenario and parameters used in the simulations are shown in
the ﬁgure. As seen, good agreement between the analytical model and FEM-based
numerical model is obtained and PL increases while increasing frequency.
Figure 10.6
A three-path propagation scenario at 5 MHz, 10 MHz, and 20 MHz.
Figure 10.7
Fields vs. range/height as a 3D map at 20 MHz.
The ﬁelds vs. range/height are given as a 3D ﬁeld map in Fig. 10.7, calculated via
FEMIX at 20 MHz. Here, the effect of sea–land–sea transition is clearly observed.
A second example, given in Figs. 10.8–10.10, belongs to a three-path (sea–land–
sea) propagation scenario for various frequencies. Again, a standard atmosphere is
assumed. Here, FEMIX is compared with the Millington approach. The example
belongs to PL vs. range variations over a three-segment 30 km mixed path. A 10 km
long irregular terrain is 15 km away from the transmitter at three different frequen-
cies. The electrical parameters of the sea (Path 1 and Path 3) and land path (Path 2)
are σg = 5 S/m, εr = 80, and σg = 0.01 S/m, εr = 15, respectively. A user-plotted
terrain proﬁle is shown in Fig. 10.8.
Figure 10.9 shows PL vs. range for the scenario given in Fig. 10.8. The solid
and dashed lines belong to the Millington and FEMPE models, respectively. As ob-

124
FEMIX VIRTUAL PROPAGATION PACKAGE
Figure 10.8
A three-path irregular propagation scenario.
Figure 10.9
PL vs. range variations for 5 MHz, 10 MHz, and 15 MHz frequencies.
served, the PL increases with the frequency. Figure 10.10 shows ﬁelds vs. range/height
obtained via FEMPE model for 5 MHz, 10 MHz, and 15 MHz, respectively. As seen,
the energy tilt-up at the sea–land discontinuity and energy accumulation for different
frequencies exist in front of the island. Note that in order to obtain a good resolution
for the 3D map, the height increment is taken to be 10 m.
The third example, given in Figs. 10.11–10.13, belongs to a four-path (sea–land–
sea–land) propagation scenario. The total length is 50 km. The electrical parameters
of the sea (Path 1 and Path 3) and land paths (Path 2 and Path 4) are σg = 5 S/m,
εr = 80, and σg = 0.01 S/m, εr = 15, respectively. Figure 10.11 shows the scenario
and parameters used in the simulations. A user-plotted terrain proﬁle is also shown.
Figure 10.12 shows PL vs. range for the scenario given in Fig. 10.11. The solid
line belongs to the Millington model for the same four-path scenario (but without
the irregular terrain) through a homogeneous atmosphere. The dashed line belongs
to the FEMPE method, which takes both irregular terrain and atmospheric variations
speciﬁed in Fig. 10.11 into account. Finally, Fig. 10.13 shows ﬁelds vs. range/height
obtained via the FEMPE model.

CHARACTERISTIC EXAMPLES
125
Range [km] 
Figure 10.10
Three-dimensional ﬁelds vs. range/height map for 5 MHz, 10 MHz, and
15 MHz.
Figure 10.11
A four-path irregular propagation scenario.
Note that the physical and mathematical parameters are optimized in the FEMIX
package for MF/LF/HF bands. The range step size is controlled by the user to con-
sider the irregular terrain and the frequency. Although the large step size can affect
the phase errors; the small steps increase the computation cost.

126
FEMIX VIRTUAL PROPAGATION PACKAGE
Figure 10.12
PL vs. range variations for the scenario in Fig. 10.11.
Figure 10.13
Three-dimensional ﬁelds vs. range/height map for the scenario in Fig. 10.12.

REFERENCES
1. L. Sevgi, “Guided waves and transverse ﬁelds: Transverse to what?,” IEEE Antennas
and Propagation Magazine, vol. 50, no. 6, pp. 221–225, Dec. 2008.
2. G. Apaydin and L. Sevgi, “Validation, veriﬁcation and calibration in applied compu-
tational electromagnetics,” Applied Computational Electromagnetics Society Journal,
vol. 25, no. 12, pp. 1026–1035, Dec. 2010.
3. L. Sevgi, Complex Electromagnetic Problems and Numerical Simulation Approaches.
John Wiley & Sons, 2003.
4. L. Sevgi, F. Akleman, and L. B. Felsen, “Groundwave propagation modeling: Problem-
matched analytical formulations and direct numerical techniques,” IEEE Antennas and
Propagation Magazine, vol. 44, no. 1, pp. 55–75, Feb. 2002.
5. M. Levy, Parabolic Equation Methods for Electromagnetic Wave Propagation. IET,
2000.
6. L. Sevgi, “Numerical fourier transforms: Dft and fft,” IEEE Antennas and Propagation
Magazine, vol. 49, no. 3, pp. 238–243, Jun. 2007.
7. L. Sevgi, Electromagnetic Modeling and Simulation. John Wiley & Sons, 2014.
8. M. L. Meeks, “Radar propagation at low altitudes,” NASA STI/Recon Technical Report
A, vol. 83, p. 24897, 1982.
9. L. Sevgi, “Groundwave modeling and simulation strategies and path loss prediction vir-
tual tools,” IEEE Transactions on Antennas and Propagation, vol. 55, no. 6, pp. 1591–
1598, Jun. 2007.
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.
127

128
REFERENCES
10. L. Sevgi, C. Uluisik, and F. Akleman, “A matlab-based two-dimensional parabolic
equation radiowave propagation package,” IEEE Antennas and Propagation Magazine,
vol. 47, no. 4, pp. 164–175, Aug. 2005.
11. C. A. Tunc, F. Akleman, V. B. Erturk, A. Altintas, and L. Sevgi, “Fast integral equation
solutions: Application to mixed path terrain proﬁles and comparisons with parabolic
equation method,” in Complex Computing-Networks, Springer, 2006, pp. 55-63.
12. F. Akleman and L. Sevgi, “A novel mom- and sspe-based groundwave-propagation
ﬁeld-strength prediction simulator,” IEEE Antennas and Propagation Magazine,
vol. 49, no. 5, pp. 69–82, Oct. 2007.
13. F. Akleman and L. Sevgi, “A novel ﬁnite-difference time-domain wave propagator,”
IEEE Transactions on Antennas and Propagation, vol. 48, no. 5, pp. 839–841, May
2000.
14. M. O. Ozyalcin, F. Akleman, and L. Sevgi, “A novel tlm-based time-domain wave
propagator,” IEEE Transactions on Antennas and Propagation, vol. 51, no. 7, pp. 1679–
1680, Jul. 2003.
15. L. Sevgi, “A mixed-path groundwave ﬁeld-strength prediction virtual tool for digital
radio broadcast systems in medium and short wave bands,” IEEE Antennas and Propa-
gation Magazine, vol. 48, no. 4, pp. 19–27, Aug. 2006.
16. L. Sevgi and L. B. Felsen, “A new algorithm for ground wave propagation based on a
hybrid ray-mode approach,” International Journal of Numerical Modelling: Electronic
Networks, Devices and Fields, vol. 11, no. 2, pp. 87–103, Mar. 1998.
17. L. Sevgi, “A ray-shooting visualization matlab package for 2d ground-wave propaga-
tion simulations,” IEEE Antennas and Propagation Magazine, vol. 46, no. 4, pp. 140–
145, Aug. 2004.
18. M. A. Leontovich and V. A. Fock, “Solution of the problem of propagation of elec-
tromagnetic waves along the earth’s surface by the method of parabolic equation,”
Academy of Sciences of the USSR: Journal of Physics, vol. 10, pp. 13–23, 1946.
19. V. A. Fock, Electromagnetic Diffraction and Propagation Problems. Pergamon, 1965.
20. F. D. Tappert, “The parabolic approximation method,” in Wave Propagation and Un-
derwater Acoustics, Springer, 1977, pp. 224-287.
21. I. Sirkova and M. Mikhalev, “Parabolic wave equation method applied to the tropo-
spheric ducting propagation problem: A survey,” Electromagnetics, vol. 26, no. 2,
pp. 155–173, 2006.
22. D. H. Huang, “Finite-element solution to the parabolic wave-equation,” Journal of the
Acoustical Society of America, vol. 84, no. 4, pp. 1405–1413, Oct. 1988.
23. V. M. Deshpande and M. D. Deshpande, “Study of electromagnetic wave propagation
through dielectric slab doped randomly with thin metallic wires using ﬁnite element
method,” IEEE Microwave and Wireless Components Letters, vol. 15, no. 5, pp. 306–
308, May 2005.
24. K. Arshad and F. Katsriku, “An investigation of tropospheric wave propagation using
ﬁnite elements,” WSEAS Transactions on Communications, vol. 4, no. 11, pp. 1186–
1192, 2005.
25. M. D. Feit and J. A. Fleck, “Light propagation in graded-index optical ﬁbers,” Applied
Optics, vol. 17, no. 24, pp. 3990–3998, 1978.

REFERENCES
129
26. D. J. Thomson and N. R. Chapman, “A wide-angle split-step algorithm for the parabolic
equation,” Journal of the Acoustical Society of America, vol. 74, no. 6, pp. 1848–1854,
1983.
27. G. Apaydin, O. Ozgun, M. Kuzuoglu, and L. Sevgi, “A novel two-way ﬁnite-element
parabolic equation groundwave propagation tool: Tests with canonical structures and
calibration,” IEEE Transactions on Geoscience and Remote Sensing, vol. 49, no. 8,
pp. 2887–2899, Aug. 2011.
28. B. M. Hannah, Modelling and Simulation of GPS Multipath Propagation. PhD thesis,
Queensland University of Technology, 2001.
29. J. R. Wait, “The scope of impedance boundary-conditions in radio propagation,” IEEE
Transactions on Geoscience and Remote Sensing, vol. 28, no. 4, pp. 721–723, Jul.
1990.
30. M. F. Levy, “Horizontal parabolic equation solution of radiowave propagation problems
on large domains,” IEEE Transactions on Antennas and Propagation, vol. 43, no. 2,
pp. 137–144, Feb. 1995.
31. G. Apaydin and L. Sevgi, “The split-step-fourier and ﬁnite-element-based parabolic-
equation propagation-prediction tools: Canonical tests, systematic comparisons, and
calibration,” IEEE Antennas and Propagation Magazine, vol. 52, no. 3, pp. 66–79, Jun.
2010.
32. G. D. Dockery and J. R. Kuttler, “An improved impedance-boundary algorithm for
fourier split-step solutions of the parabolic wave equation,” IEEE Transactions on An-
tennas and Propagation, vol. 44, no. 12, pp. 1592–1599, Dec. 1996.
33. J. R. Kuttler and R. Janaswamy, “Improved fourier transform methods for solving the
parabolic wave equation,” Radio Science, vol. 37, no. 2, pp. 1–11, 2002.
34. G. Apaydin and L. Sevgi, “A novel split-step parabolic-equation package for surface-
wave propagation prediction along multiple mixed irregular-terrain paths,” IEEE An-
tennas and Propagation Magazine, vol. 52, no. 4, pp. 90–97, Aug. 2010.
35. J.-M. Jin, The Finite Element Method in Electromagnetics. John Wiley & Sons, 2015.
36. J. L. Volakis, A. Chatterjee, and L. C. Kempel, Finite Element Method Electromagnet-
ics: Antennas, Microwave Circuits, and Scattering Applications, vol. 6. John Wiley &
Sons, 1998.
37. W. Y. Yang, W. Cao, T.-S. Chung, and J. Morris, Applied Numerical Methods Using
MATLAB. John Wiley & Sons, 2005.
38. L. Barclay, Propagation of Radiowaves. IET, 2003.
39. D. E. Kerr, Propagation of Short Radio Waves. IET, 1951.
40. R. J. Luebbers, “Propagation prediction for hilly terrain using gtd wedge diffraction,”
IEEE Transactions on Antennas and Propagation, vol. 32, no. 9, pp. 951–955, Sep.
1984.
41. J. H. Whitteker, “Fresnel-kirchhoff theory applied to terrain diffraction problems,” Ra-
dio Science, vol. 25, no. 5, pp. 837–851, 1990.
42. C. A. Tunc, A. Altintas, and V. B. Erturk, “Examination of existent propagation models
over large inhomogeneous terrain proﬁles using fast integral equation solution,” IEEE
Transactions on Antennas and Propagation, vol. 53, no. 9, pp. 3080–3083, Sep. 2005.

130
REFERENCES
43. H. Oraizi and S. Hosseinzadeh, “Radio-wave-propagation modeling in the presence of
multiple knife edges by the bidirectional parabolic-equation method,” IEEE Transac-
tions on Vehicular Technology, vol. 56, no. 3, pp. 1033–1040, May 2007.
44. G. Apaydin and L. Sevgi, “Fem-based surface wave multimixed-path propagator
and path loss predictions,” IEEE Antennas and Wireless Propagation Letters, vol. 8,
pp. 1010–1013, 2009.
45. G. Apaydin and L. Sevgi, “A canonical test problem for computational electromagnet-
ics (cem): Propagation in a parallel-plate waveguide,” IEEE Antennas and Propagation
Magazine, vol. 54, no. 4, pp. 290–315, Aug. 2012.
46. G. Apaydin and L. Sevgi, “Method of moment (mom) modeling for resonating struc-
tures: Propagation inside a parallel plate waveguide,” Applied Computational Electro-
magnetics Society Journal, vol. 27, no. 10, pp. 842–849, Oct. 2012.
47. G. Apaydin and L. Sevgi, “Groundwave propagation at short ranges and accurate source
modeling,” IEEE Antennas and Propagation Magazine, vol. 55, no. 3, pp. 244–262,
Jun. 2013.
48. G. Apaydin and L. Sevgi, “Numerical investigations of and path loss predictions for
surface wave propagation over sea paths including hilly island transitions,” IEEE Trans-
actions on Antennas and Propagation, vol. 58, no. 4, pp. 1302–1314, Apr. 2010.
49. G. Apaydin and L. Sevgi, “Propagation modeling and path loss prediction tools for
high frequency surface wave radars,” Turkish Journal of Electrical Engineering and
Computer Sciences, vol. 18, no. 3, pp. 469–484, 2010.
50. K. A. Norton, “The propagation of radio waves over the surface of the earth and in the
upper atmosphere,” Proceedings of the Institute of Radio Engineers, vol. 24, no. 10,
pp. 1367–1387, Oct. 1936.
51. J. R. Wait, Electromagnetic Waves in Stratiﬁed Media: Revised Edition Including Sup-
plemented Material. Elsevier, 2013.
52. G. Millington, “Ground-wave propagation over an inhomogeneous smooth earth,” Pro-
ceedings of the IEE-Part III: Radio and Communication Engineering, vol. 96, no. 39,
pp. 53–64, Jan. 1949.
53. L. Sevgi, “A numerical millington propagation package for medium and short wave drm
systems ﬁeld strength predictions,” IEEE Broadcast Technology Society Newsletter,
vol. 14, no. 3, pp. 9–11, 2006.
54. K. Furutsu, “A systematic theory of wave propagation over irregular terrain,” Radio
Science, vol. 17, no. 5, pp. 1037–1050, 1982.
55. R. Ott, “A new method for predicting hf ground wave attenuation over inhomogeneous,
irregular terrain,” DTIC Document, 1971.
56. S. W. Marcus, “A hybrid (ﬁnite difference-surface green’s function) method for com-
puting transmission losses in an inhomogeneous atmosphere over irregular terrain,”
IEEE Transactions on Antennas and Propagation, vol. 40, no. 12, pp. 1451–1458, Dec.
1992.
57. R. Janaswamy, “A fredholm integral equation method for propagation predictions over
small terrain irregularities,” IEEE Transactions on Antennas and Propagation, vol. 40,
no. 11, pp. 1416–1422, Nov. 1992.

REFERENCES
131
58. R. Janaswamy, “A fast ﬁnite difference method for propagation predictions over irregu-
lar, inhomogeneous terrain,” IEEE Transactions on Antennas and Propagation, vol. 42,
no. 9, pp. 1257–1267, Sep. 1994.
59. J. T. Hviid, J. B. Andersen, J. Toftgard, and J. Bojer, “Terrain-based propagation model
for rural area-an integral equation approach,” IEEE Transactions on Antennas and
Propagation, vol. 43, no. 1, pp. 41–46, Jan. 1995.
60. K. H. Craig, “Propagation modelling in the troposphere: Parabolic equation method,”
Electronics Letters, vol. 24, no. 18, pp. 1136–1139, 1988.
61. A. E. Barrios, “Parabolic equation modeling in horizontally inhomogeneous environ-
ments,” IEEE Transactions on Antennas and Propagation, vol. 40, no. 7, pp. 791–797,
Jul. 1992.
62. J. R. Kuttler and G. D. Dockery, “Theoretical description of the parabolic approxima-
tion/fourier split-step method of representing electromagnetic propagation in the tropo-
sphere,” Radio Science, vol. 26, no. 2, pp. 381–393, 1991.
63. D. J. Donohue and J. R. Kuttler, “Propagation modeling over terrain using the parabolic
wave equation,” IEEE Transactions on Antennas and Propagation, vol. 48, no. 2,
pp. 260–277, Feb. 2000.
64. M. D. Collins and R. B. Evans, “A two-way parabolic equation for acoustic backscatter-
ing in the ocean,” Journal of the Acoustical Society of America, vol. 91, no. 3, pp. 1357–
1368, 1992.
65. M. D. Collins, “A two-way parabolic equation for elastic media,” Journal of the Acous-
tical Society of America, vol. 93, no. 4, pp. 1815–1825, 1993.
66. J. F. Lingevitch, M. D. Collins, M. J. Mills, and R. B. Evans, “A two-way parabolic
equation that accounts for multiple scattering,” Journal of the Acoustical Society of
America, vol. 112, no. 2, pp. 476–480, 2002.
67. M. J. Mills, M. D. Collins, and J. F. Lingevitch, “Two-way parabolic equation tech-
niques for diffraction and scattering problems,” Wave Motion, vol. 31, no. 2, pp. 173–
180, 2000.
68. O. Ozgun, “Recursive two-way parabolic equation approach for modeling terrain ef-
fects in tropospheric propagation,” IEEE Transactions on Antennas and Propagation,
vol. 57, no. 9, pp. 2706–2714, Sep. 2009.
69. C. A. Balanis, Advanced Engineering Electromagnetics. John Wiley & Sons, 2012.
70. L. B. Felsen and N. Marcuvitz, Radiation and Scattering of Waves, vol. 31. John Wiley
& Sons, 1994.
71. D. G. Dudley, Mathematical Foundations for Electromagnetic Theory. IEEE Press,
1994.
72. M. N. O. Sadiku, Numerical Techniques in Electromagnetics with MATLAB.
CRC
Press, 2011.
73. T. Rylander, P. Ingelstrom, and A. Bondeson, Computational Electromagnetics. New
York: Springer, 2013.
74. A. F. Peterson, S. L. Ray, and R. Mittra, Computational Methods for Electromagnetics,
vol. 2. New York: IEEE Press, 1998.
75. J.-M. Jin, Theory and Computation of Electromagnetic Fields. John Wiley & Sons,
2011.

132
REFERENCES
76. R. Garg, Analytical and Computational Methods in Electromagnetics. Artech House,
2008.
77. R. C. Hansen, Geometric Theory of Diffraction. IEEE Press, 1981.
78. R. G. Kouyoumjian and P. H. Pathak, “A uniform geometrical theory of diffraction for
an edge in a perfectly conducting surface,” Proceedings of the IEEE, vol. 62, no. 11,
pp. 1448–1461, Nov. 1974.
79. P. Y. Uﬁmtsev, Fundamentals of the Physical Theory of Diffraction. Hoboken, NJ: John
Wiley & Sons, Inc., 2014.
80. P. Y. Uﬁmtsev, Theory of Edge Diffraction in Electromagnetics. Origination and Vali-
dation of the Physical Theory of Diffraction. Raleigh, NC: Revised printing, SciTech
Publishing Inc., 2009.
81. F. Hacivelioglu, L. Sevgi, and P. Y. Uﬁmtsev, “Electromagnetic wave scattering from a
wedge with perfectly reﬂecting boundaries: Analysis of asymptotic techniques,” IEEE
Antennas and Propagation Magazine, vol. 53, no. 3, pp. 232–253, Jun. 2011.
82. F. Hacivelioglu, M. A. Uslu, and L. Sevgi, “A matlab-based virtual tool for the elec-
tromagnetic wave scattering from a perfectly reﬂecting wedge,” IEEE Antennas and
Propagation Magazine, vol. 53, no. 6, pp. 234–243, Dec. 2011.
83. L. Sevgi, “Sturm-liouville equation: The bridge between eigenvalue and green’s func-
tion problems,” Turkish Journal of Electrical Engineering and Computer Sciences,
vol. 14, no. 2, pp. 293–311, 2006.
84. R. F. Harrington and J. L. Harrington, Field Computation by Moment Methods. Oxford
University Press, 1996.
85. K. S. Kunz and R. J. Luebbers, The Finite Difference Time Domain Method for Elec-
tromagnetics. CRC Press, 1993.
86. D. M. Sullivan, Electromagnetic Simulation Using the FDTD Method. John Wiley &
Sons, 2013.
87. A. Taﬂove and S. C. Hagness, Computational Electrodynamics. Artech House, 2005.
88. C. Christopoulos, The Transmission-Line Modeling Method. Oxford Press, 1995.
89. P. Russer, Electromagnetics, Microwave Circuit and Antenna Design for Communica-
tions Engineering. Artech House, 2003.
90. L. Felsen and A. Kamel, “Hybrid ray-mode formulation of parallel plane waveguide
green’s functions,” IEEE Transactions on Antennas and Propagation, vol. 29, no. 4,
pp. 637–649, Jul. 1981.
91. L. B. Felsen, F. Akleman, and L. Sevgi, “Wave propagation inside a two-dimensional
perfectly conducting parallel-plate waveguide: Hybrid ray-mode techniques and their
visualizations,” IEEE Antennas and Propagation Magazine, vol. 46, no. 6, pp. 69–89,
Dec. 2004.
92. L. Sevgi, F. Akleman, and L. B. Felsen, “Visualizations of wave dynamics in a wedge
waveguide with non-penetrable boundaries: Normal-, adiabatic-, and intrinsic-mode
representations,” IEEE Antennas and Propagation Magazine, vol. 49, no. 3, pp. 76–94,
Jun. 2007.
93. G. Apaydin and L. Sevgi, “Two-way propagation modeling in waveguides with three-
dimensional ﬁnite-element and split-step fourier-based pe approaches,” IEEE Antennas
and Wireless Propagation Letters, vol. 10, pp. 975–978, 2011.

REFERENCES
133
94. R. Ding, L. Tsang, and H. Braunisch, “Wave propagation in a randomly rough parallel-
plate waveguide,” IEEE Transactions on Microwave Theory and Techniques, vol. 57,
no. 5, pp. 1216–1223, May 2009.
95. E. Arvas and L. Sevgi, “A tutorial on the method of moments,” IEEE Antennas and
Propagation Magazine, vol. 54, no. 3, pp. 260–275, Jun. 2012.
96. O. Ozgun, G. Apaydin, M. Kuzuoglu, and L. Sevgi, “Petool: Matlab-based one-way
and two-way split-step parabolic equation tool for radiowave propagation over variable
terrain,” Computer Physics Communications, vol. 182, no. 12, pp. 2638–2654, 2011.
97. G. Apaydin and L. Sevgi, “Calibration of three-dimensional parabolic-equation propa-
gation models with the rectangular waveguide problem,” IEEE Antennas and Propaga-
tion Magazine, vol. 54, no. 6, pp. 102–116, Dec. 2012.
98. R. Martelly and R. Janaswamy, “An adi-pe approach for modeling radio transmis-
sion loss in tunnels,” IEEE Transactions on Antennas and Propagation, vol. 57, no.
6, pp. 1759–1770, Jun. 2009.
99. J. B. Keller, “Geometrical theory of diffraction,” Journal of the Optical Society of Amer-
ica, vol. 52, pp. 116–130, 1962.
100. C. A. Zelley and C. C. Constantinou, “A three-dimensional parabolic equation ap-
plied to vhf/uhf propagation over irregular terrain,” IEEE Transactions on Antennas
and Propagation, vol. 47, no. 10, pp. 1586–1596, Oct. 1999.
101. A. V. Popov and N. Y. Zhu, “Modeling radio wave propagation in tunnels with a vecto-
rial parabolic equation,” IEEE Transactions on Antennas and Propagation, vol. 48, no.
9, pp. 1403–1412, Sep. 2000.
102. R. Martelly and R. Janaswamy, “Modeling radio transmission loss in curved, branched
and rough-walled tunnels with the adi-pe method,” IEEE Transactions on Antennas and
Propagation, vol. 58, no. 6, pp. 2037–2045, Jun. 2010.
103. A. Yagbasan, C. A. Tunc, V. B. Erturk, A. Altintas, and R. Mittra, “Characteristic basis
function method for solving electromagnetic scattering problems over rough terrain
proﬁles,” IEEE Transactions on Antennas and Propagation, vol. 58, no. 5, pp. 1579–
1589, May 2010.
104. F. Akleman and L. Sevgi, “Time and frequency domain wave propagators,” Applied
Computational Electromagnetics Society Journal, vol. 15, no. 3, pp. 186–208, 2000.
105. F. Akleman and L. Sevgi, “Realistic surface modeling for a ﬁnite-difference time-
domain wave propagator,” IEEE Transactions on Antennas and Propagation, vol. 51,
no. 7, pp. 1675–1679, Jul. 2003.
106. K. G. Budden, The Waveguide Mode Theory of Wave Propagation. London: Logos
Press, 1961.
107. R. H. Hardin and F. D. Tappert, “Applications of the split-step fourier method to the
numerical solution of nonlinear and variable coefﬁcient wave equations,” Society for
Industrial and Applied Mathematics Review, vol. 15, no. 2, p. 423, 1973.
108. G. D. Dockery, “Modeling electromagnetic wave propagation in the troposphere using
the parabolic equation,” IEEE Transactions on Antennas and Propagation, vol. 36, no.
10, pp. 1464–1470, Oct. 1988.
109. P. D. Holm, “Wide-angle shift-map pe for a piecewise linear terrain-a ﬁnite-difference
approach,” IEEE Transactions on Antennas and Propagation, vol. 55, no. 10, pp. 2773–
2789, Oct. 2007.

134
REFERENCES
110. C. Mias, “Fast computation of the nonlocal boundary condition in ﬁnite difference
parabolic equation radiowave propagation simulations,” IEEE Transactions on Anten-
nas and Propagation, vol. 56, no. 6, pp. 1699–1705, Jun. 2008.
111. M. F. Levy, “Parabolic equation modelling of propagation over irregular terrain,” Elec-
tronics Letters, vol. 26, no. 15, pp. 1153–1155, Jul. 1990.
112. A. E. Barrios, “A terrain parabolic equation model for propagation in the troposphere,”
IEEE Transactions on Antennas and Propagation, vol. 42, no. 1, pp. 90–98, Jan. 1994.
113. R. Janaswamy, “A curvilinear coordinate-based split-step parabolic equation method
for propagation predictions over terrain,” IEEE Transactions on Antennas and Propa-
gation, vol. 46, no. 7, pp. 1089–1097, Jul. 1998.
114. T.-K. Tsay, B. A. Ebersole, and P. L.-F. Liu, “Numerical modelling of wave propa-
gation using parabolic approximation with a boundary-ﬁtted co-ordinate system,” In-
ternational Journal for Numerical Methods in Engineering, vol. 27, no. 1, pp. 37–55,
1989.
115. M. F. Levy and A. A. Zaporozhets, “Parabolic equation techniques for scattering,” Wave
Motion, vol. 31, no. 2, pp. 147–156, 2000.
116. O. Ozgun, G. Apaydin, M. Kuzuoglu, and L. Sevgi, “Two-way fourier split step al-
gorithm over variable terrain with narrow and wide angle propagators,” in 2010 IEEE
Antennas and Propagation Society International Symposium, pp. 1–4, Jul. 2010.
117. M. F. Levy, “Diffraction studies in urban environment with wide-angle parabolic equa-
tion method,” Electronics Letters, vol. 28, no. 16, pp. 1491–1492, Jul. 1992.
118. J. R. Kuttler, “Differences between the narrow-angle and wide-angle propagators in
the split-step fourier solution of the parabolic wave equation,” IEEE Transactions on
Antennas and Propagation, vol. 47, no. 7, pp. 1131–1140, Jul. 1999.
119. J. F. Claerbout, Fundamentals of Geophysical Data Processing with Application to
Petroleum Prospect. New York: McGraw-Hill, 1976.
120. ITU-R, “Planning parameters for digital sound broadcasting at frequencies below 30
mhz,” International Telecommunications Union-Radiocommunication Recommenda-
tion BS.1615, Jun. 2003.
121. ITU-R, “Groundwave propagation curves for frequencies between 10 khz and 30
mhz,” International Telecommunications Union-Radiocommunication Recommenda-
tion P.368-9, Feb. 2007.
122. L. Sevgi, A. Ponsford, and H. C. Chan, “An integrated maritime surveillance system
based on high-frequency surface-wave radars. 1. Theoretical background and numerical
simulations,” IEEE Antennas and Propagation Magazine, vol. 43, no. 4, pp. 28–43,
Aug. 2001.
123. A. M. Ponsford, L. Sevgi, and H. C. Chan, “An integrated maritime surveillance system
based on high-frequency surface-wave radars. 2. Operational status and system perfor-
mance,” IEEE Antennas and Propagation Magazine, vol. 43, no. 5, pp. 52–63, Oct.
2001.
124. L. Sevgi, “Novel digital broadcast/communication systems and groundwave propaga-
tion prediction requirements,” in 2006 First European Conference on Antennas and
Propagation, pp. 1–5, Nov. 2006.
125. G. Apaydin and L. Sevgi, “Matlab-based fem-parabolic-equation tool for path-loss cal-
culations along multi-mixed-terrain paths,” IEEE Antennas and Propagation Magazine,
vol. 56, no. 3, pp. 221–236, Jun. 2014.

Index
ADIPE model, 82
Airy equation, 20
aliasing, 10, 11, 29
atmospheric conditions
ducting, 41, 119
standard, 41, 119
sub-refraction, 41, 119
super-refraction, 41, 119
boundary conditions, 3, 27
Cauchy BC, 3
Dirichlet BC, 3
Neumann BC, 3
radiation BC, 28
Claerbout equation, 26
coordinate transformation, 54
Crank-Nicolson, 34
curl, 4
ducting
elevated duct, 41
evaporation duct, 41
surface duct, 41
surface-based duct, 41
effective Earth radius, 41
eigenproblem, 3
eigenvalue, 67
excitation coefﬁcient, 20, 22, 39,
45–48, 50, 67, 70, 81
FEMIX, 119
FEMPE model, 32, 49, 73, 82
two-way, 89, 90, 96
four-ray model, 16, 49
Fourier series, 11, 12
Fourier transform, 7, 8
DFT, 9, 10
DMFT, 56
135
Radio Wave Propagation and Parabolic Equation Modeling, First Edition. By Gökhan Apaydin, Levent Sevgi 
© 2017 by the Institute of Electrical and Electronic Engineers, Inc. Published 2017 by John Wiley & Sons, Inc.

DST/DCT, 14
FFT, 10
Gaussian antenna pattern, 21, 28, 44,
47, 70, 81
Gaussian function, 12, 20
GO+UTD model, 92
Green’s function, 68, 69
Greene approximation, 27
Hankel function, 16
Helmholtz’s Equation, 5
inhomogeneous terrain, 55
irregular terrain, 55, 114
Laplace’s equation, 2
Maxwell Equations, 3
Millington’s curve ﬁtting approach,
117
mode summation, 19, 20, 22, 68–70,
80
modiﬁed refractivity, 41
MoM model, 49, 75
Norton’s model, 115
Nyquist sampling criterion, 11, 29
parabolic equation
standard PE, 26
wide-angle PE, 26
parabolic wave equation, 24
parallel plate waveguide, 65
partial differential equations, 2
elliptic PDE, 6
hyperbolic PDE, 3
parabolic PDE, 3
path loss, 115
PETOOL, 103
Poisson’s equation, 1, 2
polarization
horizontal/vertical, 25
parallel/perpendicular, 5
TE/TM, 5, 25
propagation factor, 18
rectangular pulse, 13
rectangular waveguide, 80, 96
reﬂection coefﬁcient, 18
refractive index, 20, 40, 42, 101, 119
refractivity, 40
scalloping loss, 11
spectral leakage, 11
SSPE model, 29, 49, 73, 81
narrow-angle PE, 30
two-way, 91, 96
wide-angle PE, 30
staircase approximation, 53
two-ray model, 15, 47
validation, veriﬁcation, and
calibration, 6, 7, 43
Wait’s model, 116
136
INDEX

